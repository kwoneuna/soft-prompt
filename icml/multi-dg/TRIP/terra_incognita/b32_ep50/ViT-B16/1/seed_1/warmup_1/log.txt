Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ---------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_38', 'location_43', 'location_46']
Target     ['location_100']
# classes  10
# train_x  13,713
# val      5,876
# test     4,741
---------  ---------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/428] time 0.105 (0.158) data 0.000 (0.041) loss 2.5139 (2.4784) ce_loss 2.5117 (2.4744) loss_zs_kd 0.0003 (0.0001) loss_oracle -0.0001 (-0.0002) acc 31.2500 (23.5938) kd_loss 0.0021 (0.0040) lr 1.0000e-05 eta 0:56:23
epoch [1/50] batch [40/428] time 0.107 (0.131) data 0.000 (0.020) loss 2.5016 (2.4039) ce_loss 2.5000 (2.4012) loss_zs_kd 0.0017 (0.0004) loss_oracle -0.0001 (-0.0001) acc 18.7500 (25.8594) kd_loss 0.0008 (0.0025) lr 1.0000e-05 eta 0:46:39
epoch [1/50] batch [60/428] time 0.089 (0.122) data 0.000 (0.014) loss 2.5760 (2.3812) ce_loss 2.5723 (2.3787) loss_zs_kd 0.0042 (0.0012) loss_oracle -0.0002 (-0.0001) acc 28.1250 (26.3021) kd_loss 0.0018 (0.0020) lr 1.0000e-05 eta 0:43:16
epoch [1/50] batch [80/428] time 0.112 (0.116) data 0.000 (0.010) loss 2.2824 (2.3595) ce_loss 2.2773 (2.3565) loss_zs_kd 0.0072 (0.0026) loss_oracle -0.0002 (-0.0001) acc 31.2500 (26.6406) kd_loss 0.0016 (0.0018) lr 1.0000e-05 eta 0:41:22
epoch [1/50] batch [100/428] time 0.186 (0.114) data 0.000 (0.008) loss 2.3567 (2.3379) ce_loss 2.3496 (2.3340) loss_zs_kd 0.0117 (0.0044) loss_oracle -0.0001 (-0.0001) acc 28.1250 (27.0625) kd_loss 0.0013 (0.0018) lr 1.0000e-05 eta 0:40:19
epoch [1/50] batch [120/428] time 0.169 (0.116) data 0.000 (0.007) loss 2.2961 (2.3175) ce_loss 2.2832 (2.3126) loss_zs_kd 0.0228 (0.0065) loss_oracle -0.0002 (-0.0001) acc 37.5000 (27.7344) kd_loss 0.0016 (0.0017) lr 1.0000e-05 eta 0:41:00
epoch [1/50] batch [140/428] time 0.099 (0.116) data 0.000 (0.006) loss 2.2434 (2.3169) ce_loss 2.2266 (2.3107) loss_zs_kd 0.0303 (0.0091) loss_oracle -0.0001 (-0.0001) acc 21.8750 (27.7455) kd_loss 0.0018 (0.0016) lr 1.0000e-05 eta 0:41:07
epoch [1/50] batch [160/428] time 0.105 (0.114) data 0.000 (0.005) loss 2.1430 (2.2936) ce_loss 2.1211 (2.2854) loss_zs_kd 0.0384 (0.0131) loss_oracle 0.0004 (-0.0001) acc 37.5000 (28.1445) kd_loss 0.0025 (0.0017) lr 1.0000e-05 eta 0:40:30
epoch [1/50] batch [180/428] time 0.109 (0.113) data 0.000 (0.005) loss 2.4296 (2.2691) ce_loss 2.3848 (2.2575) loss_zs_kd 0.0793 (0.0196) loss_oracle 0.0005 (-0.0000) acc 25.0000 (28.7500) kd_loss 0.0050 (0.0019) lr 1.0000e-05 eta 0:40:03
epoch [1/50] batch [200/428] time 0.103 (0.112) data 0.000 (0.004) loss 2.0288 (2.2520) ce_loss 1.9736 (2.2366) loss_zs_kd 0.0969 (0.0262) loss_oracle 0.0006 (0.0000) acc 37.5000 (29.2344) kd_loss 0.0064 (0.0023) lr 1.0000e-05 eta 0:39:43
epoch [1/50] batch [220/428] time 0.097 (0.112) data 0.000 (0.004) loss 2.5326 (2.2401) ce_loss 2.4688 (2.2199) loss_zs_kd 0.1025 (0.0345) loss_oracle 0.0008 (0.0001) acc 34.3750 (29.6875) kd_loss 0.0122 (0.0029) lr 1.0000e-05 eta 0:39:22
epoch [1/50] batch [240/428] time 0.097 (0.111) data 0.000 (0.004) loss 2.1922 (2.2325) ce_loss 2.0820 (2.2064) loss_zs_kd 0.1723 (0.0441) loss_oracle 0.0025 (0.0004) acc 31.2500 (29.9089) kd_loss 0.0227 (0.0038) lr 1.0000e-05 eta 0:39:06
epoch [1/50] batch [260/428] time 0.093 (0.110) data 0.000 (0.003) loss 2.6030 (2.2223) ce_loss 2.5254 (2.1910) loss_zs_kd 0.1240 (0.0520) loss_oracle 0.0015 (0.0006) acc 34.3750 (30.2043) kd_loss 0.0148 (0.0050) lr 1.0000e-05 eta 0:38:49
epoch [1/50] batch [280/428] time 0.098 (0.109) data 0.000 (0.003) loss 1.8138 (2.2094) ce_loss 1.6494 (2.1707) loss_zs_kd 0.3021 (0.0628) loss_oracle 0.0012 (0.0016) acc 50.0000 (30.6473) kd_loss 0.0128 (0.0065) lr 1.0000e-05 eta 0:38:31
epoch [1/50] batch [300/428] time 0.090 (0.109) data 0.000 (0.003) loss 2.4729 (2.1984) ce_loss 2.3125 (2.1540) loss_zs_kd 0.2352 (0.0703) loss_oracle 0.0048 (0.0022) acc 25.0000 (31.1250) kd_loss 0.0404 (0.0081) lr 1.0000e-05 eta 0:38:20
epoch [1/50] batch [320/428] time 0.177 (0.109) data 0.000 (0.003) loss 1.9011 (2.1873) ce_loss 1.7725 (2.1375) loss_zs_kd 0.1846 (0.0783) loss_oracle 0.0017 (0.0023) acc 40.6250 (31.5234) kd_loss 0.0355 (0.0095) lr 1.0000e-05 eta 0:38:07
epoch [1/50] batch [340/428] time 0.147 (0.109) data 0.000 (0.003) loss 2.0485 (2.1771) ce_loss 1.9268 (2.1223) loss_zs_kd 0.1883 (0.0860) loss_oracle 0.0024 (0.0023) acc 37.5000 (31.8107) kd_loss 0.0263 (0.0106) lr 1.0000e-05 eta 0:38:13
epoch [1/50] batch [360/428] time 0.107 (0.110) data 0.000 (0.003) loss 1.8954 (2.1673) ce_loss 1.7529 (2.1081) loss_zs_kd 0.2455 (0.0930) loss_oracle 0.0009 (0.0022) acc 50.0000 (32.1094) kd_loss 0.0193 (0.0115) lr 1.0000e-05 eta 0:38:28
epoch [1/50] batch [380/428] time 0.107 (0.109) data 0.000 (0.002) loss 2.3691 (2.1639) ce_loss 2.1992 (2.1008) loss_zs_kd 0.2690 (0.0995) loss_oracle 0.0004 (0.0021) acc 25.0000 (32.1957) kd_loss 0.0352 (0.0123) lr 1.0000e-05 eta 0:38:20
epoch [1/50] batch [400/428] time 0.103 (0.109) data 0.000 (0.002) loss 1.9492 (2.1569) ce_loss 1.8193 (2.0905) loss_zs_kd 0.2286 (0.1051) loss_oracle 0.0003 (0.0020) acc 43.7500 (32.3594) kd_loss 0.0154 (0.0128) lr 1.0000e-05 eta 0:38:11
epoch [1/50] batch [420/428] time 0.104 (0.109) data 0.000 (0.002) loss 2.2727 (2.1474) ce_loss 2.1152 (2.0779) loss_zs_kd 0.2828 (0.1106) loss_oracle 0.0009 (0.0019) acc 34.3750 (32.6339) kd_loss 0.0155 (0.0132) lr 1.0000e-05 eta 0:38:02
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,284
* accuracy: 38.9%
* error: 61.1%
* macro_f1: 26.9%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,612
* accuracy: 55.1%
* error: 44.9%
* macro_f1: 28.5%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 1 best val acc:      38.9%, epoch: 1 *******
******* Domain 1 best val test acc: 55.1%, epoch: 1 *******
******* Domain 1 best test acc:     55.1%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/ana
epoch [2/50] batch [20/428] time 0.100 (0.139) data 0.000 (0.028) loss 2.4658 (2.1647) ce_loss 1.6826 (1.8549) loss_zs_kd 0.2580 (0.2037) loss_oracle 0.3129 (0.1190) acc 34.3750 (36.7188) kd_loss 0.4977 (0.1484) lr 2.0000e-03 eta 0:48:27
epoch [2/50] batch [40/428] time 0.098 (0.120) data 0.000 (0.014) loss 2.5357 (2.2824) ce_loss 1.6855 (1.7549) loss_zs_kd 0.3237 (0.2544) loss_oracle 0.3862 (0.2237) acc 50.0000 (38.6719) kd_loss 0.4953 (0.2884) lr 2.0000e-03 eta 0:41:45
epoch [2/50] batch [60/428] time 0.106 (0.114) data 0.001 (0.010) loss 2.7462 (2.3899) ce_loss 1.6348 (1.7097) loss_zs_kd 0.3659 (0.2774) loss_oracle 0.5802 (0.3107) acc 46.8750 (39.8438) kd_loss 0.6384 (0.3862) lr 2.0000e-03 eta 0:39:49
epoch [2/50] batch [80/428] time 0.103 (0.111) data 0.000 (0.007) loss 2.7642 (2.4525) ce_loss 1.6289 (1.6537) loss_zs_kd 0.3348 (0.2915) loss_oracle 0.5607 (0.3966) acc 34.3750 (41.8750) kd_loss 0.6876 (0.4548) lr 2.0000e-03 eta 0:38:38
epoch [2/50] batch [100/428] time 0.105 (0.109) data 0.000 (0.006) loss 2.7213 (2.5008) ce_loss 1.3916 (1.6141) loss_zs_kd 0.3770 (0.3054) loss_oracle 0.6604 (0.4344) acc 50.0000 (43.2812) kd_loss 0.8110 (0.5169) lr 2.0000e-03 eta 0:37:51
epoch [2/50] batch [120/428] time 0.086 (0.107) data 0.000 (0.005) loss 2.8596 (2.5403) ce_loss 1.8359 (1.5986) loss_zs_kd 0.3576 (0.3130) loss_oracle 0.3046 (0.4412) acc 31.2500 (43.5938) kd_loss 0.6926 (0.5645) lr 2.0000e-03 eta 0:37:09
epoch [2/50] batch [140/428] time 0.083 (0.111) data 0.000 (0.004) loss 2.4176 (2.5517) ce_loss 1.3242 (1.5759) loss_zs_kd 0.3499 (0.3158) loss_oracle 0.3508 (0.4248) acc 50.0000 (44.3973) kd_loss 0.7430 (0.6056) lr 2.0000e-03 eta 0:38:36
epoch [2/50] batch [160/428] time 0.082 (0.113) data 0.000 (0.004) loss 2.7670 (2.5567) ce_loss 1.4805 (1.5532) loss_zs_kd 0.3940 (0.3299) loss_oracle 0.2542 (0.4095) acc 46.8750 (45.1367) kd_loss 0.9624 (0.6338) lr 2.0000e-03 eta 0:39:15
epoch [2/50] batch [180/428] time 0.104 (0.112) data 0.000 (0.003) loss 2.5666 (2.5657) ce_loss 1.4004 (1.5415) loss_zs_kd 0.3796 (0.3391) loss_oracle 0.3726 (0.4001) acc 50.0000 (45.3472) kd_loss 0.7901 (0.6546) lr 2.0000e-03 eta 0:38:39
epoch [2/50] batch [200/428] time 0.101 (0.111) data 0.000 (0.003) loss 2.7652 (2.5763) ce_loss 1.5215 (1.5338) loss_zs_kd 0.3375 (0.3470) loss_oracle 0.3997 (0.4005) acc 46.8750 (45.7031) kd_loss 0.8751 (0.6688) lr 2.0000e-03 eta 0:38:23
epoch [2/50] batch [220/428] time 0.094 (0.110) data 0.000 (0.003) loss 2.6013 (2.5694) ce_loss 1.3564 (1.5127) loss_zs_kd 0.3714 (0.3521) loss_oracle 0.4208 (0.4019) acc 43.7500 (46.3068) kd_loss 0.8488 (0.6797) lr 2.0000e-03 eta 0:38:03
epoch [2/50] batch [240/428] time 0.097 (0.109) data 0.000 (0.003) loss 2.5136 (2.5702) ce_loss 1.3350 (1.5010) loss_zs_kd 0.3173 (0.3545) loss_oracle 0.4198 (0.4045) acc 40.6250 (46.5885) kd_loss 0.8100 (0.6897) lr 2.0000e-03 eta 0:37:48
epoch [2/50] batch [260/428] time 0.092 (0.109) data 0.000 (0.002) loss 2.3150 (2.5710) ce_loss 1.0859 (1.4893) loss_zs_kd 0.3292 (0.3581) loss_oracle 0.5087 (0.4086) acc 59.3750 (47.0673) kd_loss 0.8101 (0.6984) lr 2.0000e-03 eta 0:37:35
epoch [2/50] batch [280/428] time 0.093 (0.108) data 0.000 (0.002) loss 2.4944 (2.5844) ce_loss 1.2275 (1.4868) loss_zs_kd 0.4575 (0.3646) loss_oracle 0.4292 (0.4109) acc 62.5000 (47.3438) kd_loss 0.8235 (0.7098) lr 2.0000e-03 eta 0:37:23
epoch [2/50] batch [300/428] time 0.109 (0.108) data 0.000 (0.002) loss 2.8333 (2.5894) ce_loss 1.5918 (1.4804) loss_zs_kd 0.3995 (0.3677) loss_oracle 0.3520 (0.4108) acc 50.0000 (47.5000) kd_loss 0.8658 (0.7197) lr 2.0000e-03 eta 0:37:12
epoch [2/50] batch [320/428] time 0.113 (0.108) data 0.000 (0.002) loss 2.6240 (2.5906) ce_loss 1.4180 (1.4716) loss_zs_kd 0.3875 (0.3697) loss_oracle 0.3712 (0.4082) acc 43.7500 (47.8613) kd_loss 0.8266 (0.7300) lr 2.0000e-03 eta 0:37:01
epoch [2/50] batch [340/428] time 0.083 (0.107) data 0.000 (0.002) loss 2.5515 (2.5944) ce_loss 1.1631 (1.4631) loss_zs_kd 0.4171 (0.3755) loss_oracle 0.3320 (0.4059) acc 62.5000 (48.1618) kd_loss 1.0139 (0.7405) lr 2.0000e-03 eta 0:36:47
epoch [2/50] batch [360/428] time 0.166 (0.108) data 0.001 (0.002) loss 2.3192 (2.5959) ce_loss 1.0244 (1.4543) loss_zs_kd 0.3877 (0.3782) loss_oracle 0.3439 (0.4050) acc 59.3750 (48.4809) kd_loss 0.9289 (0.7501) lr 2.0000e-03 eta 0:37:11
epoch [2/50] batch [380/428] time 0.159 (0.109) data 0.000 (0.002) loss 2.5191 (2.6024) ce_loss 1.0723 (1.4508) loss_zs_kd 0.5146 (0.3802) loss_oracle 0.4713 (0.4052) acc 62.5000 (48.4868) kd_loss 0.9538 (0.7589) lr 2.0000e-03 eta 0:37:20
epoch [2/50] batch [400/428] time 0.110 (0.108) data 0.000 (0.002) loss 2.7261 (2.6098) ce_loss 1.4131 (1.4488) loss_zs_kd 0.3864 (0.3814) loss_oracle 0.4640 (0.4058) acc 50.0000 (48.7031) kd_loss 0.8878 (0.7674) lr 2.0000e-03 eta 0:37:06
epoch [2/50] batch [420/428] time 0.094 (0.108) data 0.000 (0.002) loss 2.4911 (2.6131) ce_loss 1.1582 (1.4431) loss_zs_kd 0.4194 (0.3829) loss_oracle 0.4486 (0.4062) acc 62.5000 (48.8616) kd_loss 0.8989 (0.7755) lr 2.0000e-03 eta 0:36:54
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,150
* accuracy: 53.6%
* error: 46.4%
* macro_f1: 39.2%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,449
* accuracy: 51.7%
* error: 48.3%
* macro_f1: 31.6%
******* Domain 1 best val acc:      53.6%, epoch: 2 *******
******* Domain 1 best val test acc: 51.7%, epoch: 2 *******
******* Domain 1 best test acc:     55.1%, epoch: 1 *******
epoch [3/50] batch [20/428] time 0.087 (0.128) data 0.000 (0.040) loss 2.8189 (2.7040) ce_loss 1.3867 (1.3406) loss_zs_kd 0.3952 (0.4232) loss_oracle 0.5037 (0.4171) acc 40.6250 (53.4375) kd_loss 0.9827 (0.9432) lr 1.9980e-03 eta 0:43:52
epoch [3/50] batch [40/428] time 0.103 (0.114) data 0.000 (0.020) loss 2.6350 (2.7050) ce_loss 1.3105 (1.3511) loss_zs_kd 0.4333 (0.4049) loss_oracle 0.4291 (0.4419) acc 53.1250 (52.9688) kd_loss 0.8933 (0.9305) lr 1.9980e-03 eta 0:39:04
epoch [3/50] batch [60/428] time 0.093 (0.109) data 0.000 (0.014) loss 2.8816 (2.7168) ce_loss 1.5244 (1.3474) loss_zs_kd 0.2956 (0.4163) loss_oracle 0.5037 (0.4593) acc 43.7500 (53.2292) kd_loss 0.9575 (0.9315) lr 1.9980e-03 eta 0:37:07
epoch [3/50] batch [80/428] time 0.105 (0.106) data 0.000 (0.010) loss 2.7184 (2.7185) ce_loss 1.3633 (1.3507) loss_zs_kd 0.4512 (0.4171) loss_oracle 0.3325 (0.4501) acc 53.1250 (53.1250) kd_loss 0.9633 (0.9342) lr 1.9980e-03 eta 0:36:13
epoch [3/50] batch [100/428] time 0.098 (0.106) data 0.000 (0.008) loss 2.9921 (2.7152) ce_loss 1.6846 (1.3545) loss_zs_kd 0.3695 (0.4123) loss_oracle 0.3714 (0.4353) acc 50.0000 (52.7500) kd_loss 0.9370 (0.9369) lr 1.9980e-03 eta 0:35:59
epoch [3/50] batch [120/428] time 0.102 (0.105) data 0.000 (0.007) loss 2.9134 (2.7088) ce_loss 1.4404 (1.3463) loss_zs_kd 0.4415 (0.4149) loss_oracle 0.4539 (0.4315) acc 43.7500 (52.7604) kd_loss 1.0253 (0.9393) lr 1.9980e-03 eta 0:35:36
epoch [3/50] batch [140/428] time 0.096 (0.104) data 0.000 (0.006) loss 2.7313 (2.7113) ce_loss 1.2373 (1.3418) loss_zs_kd 0.4832 (0.4166) loss_oracle 0.5079 (0.4410) acc 50.0000 (52.5893) kd_loss 0.9984 (0.9406) lr 1.9980e-03 eta 0:35:29
epoch [3/50] batch [160/428] time 0.104 (0.104) data 0.000 (0.005) loss 2.6129 (2.7198) ce_loss 1.2793 (1.3409) loss_zs_kd 0.3930 (0.4167) loss_oracle 0.4756 (0.4539) acc 50.0000 (52.6172) kd_loss 0.8993 (0.9436) lr 1.9980e-03 eta 0:35:21
epoch [3/50] batch [180/428] time 0.182 (0.104) data 0.000 (0.005) loss 2.5421 (2.7198) ce_loss 1.1553 (1.3383) loss_zs_kd 0.4577 (0.4177) loss_oracle 0.3998 (0.4528) acc 59.3750 (52.3785) kd_loss 0.9580 (0.9463) lr 1.9980e-03 eta 0:35:22
epoch [3/50] batch [200/428] time 0.069 (0.104) data 0.001 (0.004) loss 2.7689 (2.7256) ce_loss 1.3818 (1.3443) loss_zs_kd 0.3572 (0.4204) loss_oracle 0.4692 (0.4437) acc 56.2500 (52.1875) kd_loss 0.9739 (0.9493) lr 1.9980e-03 eta 0:35:25
epoch [3/50] batch [220/428] time 0.068 (0.106) data 0.000 (0.004) loss 2.8950 (2.7287) ce_loss 1.4424 (1.3437) loss_zs_kd 0.4847 (0.4219) loss_oracle 0.4152 (0.4433) acc 50.0000 (52.0881) kd_loss 1.0026 (0.9523) lr 1.9980e-03 eta 0:35:49
epoch [3/50] batch [240/428] time 0.094 (0.104) data 0.000 (0.004) loss 2.5786 (2.7249) ce_loss 1.0947 (1.3390) loss_zs_kd 0.5057 (0.4222) loss_oracle 0.3890 (0.4402) acc 62.5000 (52.3177) kd_loss 1.0366 (0.9547) lr 1.9980e-03 eta 0:35:20
epoch [3/50] batch [260/428] time 0.107 (0.104) data 0.001 (0.003) loss 3.0811 (2.7235) ce_loss 1.6182 (1.3335) loss_zs_kd 0.4280 (0.4256) loss_oracle 0.4731 (0.4374) acc 43.7500 (52.6082) kd_loss 1.0124 (0.9585) lr 1.9980e-03 eta 0:35:10
epoch [3/50] batch [280/428] time 0.098 (0.104) data 0.000 (0.003) loss 2.6907 (2.7260) ce_loss 1.2578 (1.3345) loss_zs_kd 0.4979 (0.4251) loss_oracle 0.4288 (0.4372) acc 50.0000 (52.5223) kd_loss 0.9696 (0.9604) lr 1.9980e-03 eta 0:34:57
epoch [3/50] batch [300/428] time 0.096 (0.103) data 0.000 (0.003) loss 2.7062 (2.7284) ce_loss 1.2842 (1.3323) loss_zs_kd 0.4155 (0.4262) loss_oracle 0.4970 (0.4410) acc 56.2500 (52.7188) kd_loss 0.9657 (0.9625) lr 1.9980e-03 eta 0:34:48
epoch [3/50] batch [320/428] time 0.088 (0.103) data 0.000 (0.003) loss 2.5313 (2.7303) ce_loss 1.0547 (1.3277) loss_zs_kd 0.4677 (0.4273) loss_oracle 0.4877 (0.4473) acc 59.3750 (52.8125) kd_loss 0.9990 (0.9654) lr 1.9980e-03 eta 0:34:42
epoch [3/50] batch [340/428] time 0.112 (0.103) data 0.000 (0.003) loss 2.7950 (2.7312) ce_loss 1.4199 (1.3254) loss_zs_kd 0.3814 (0.4289) loss_oracle 0.4611 (0.4487) acc 53.1250 (52.9136) kd_loss 0.9538 (0.9671) lr 1.9980e-03 eta 0:34:38
epoch [3/50] batch [360/428] time 0.098 (0.103) data 0.000 (0.002) loss 2.8123 (2.7317) ce_loss 1.3799 (1.3233) loss_zs_kd 0.3927 (0.4286) loss_oracle 0.5382 (0.4502) acc 50.0000 (53.0469) kd_loss 0.9669 (0.9690) lr 1.9980e-03 eta 0:34:34
epoch [3/50] batch [380/428] time 0.108 (0.103) data 0.000 (0.002) loss 3.0705 (2.7315) ce_loss 1.5479 (1.3218) loss_zs_kd 0.4574 (0.4287) loss_oracle 0.5472 (0.4507) acc 53.1250 (52.9688) kd_loss 1.0203 (0.9700) lr 1.9980e-03 eta 0:34:31
epoch [3/50] batch [400/428] time 0.077 (0.102) data 0.000 (0.002) loss 2.8910 (2.7348) ce_loss 1.3281 (1.3216) loss_zs_kd 0.5419 (0.4299) loss_oracle 0.5388 (0.4534) acc 53.1250 (53.0547) kd_loss 1.0225 (0.9715) lr 1.9980e-03 eta 0:34:23
epoch [3/50] batch [420/428] time 0.173 (0.104) data 0.000 (0.002) loss 2.8889 (2.7326) ce_loss 1.3115 (1.3178) loss_zs_kd 0.5582 (0.4305) loss_oracle 0.4087 (0.4527) acc 50.0000 (53.2217) kd_loss 1.0939 (0.9732) lr 1.9980e-03 eta 0:34:43
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,360
* accuracy: 57.2%
* error: 42.8%
* macro_f1: 43.9%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,639
* accuracy: 55.7%
* error: 44.3%
* macro_f1: 35.0%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 1 best val acc:      57.2%, epoch: 3 *******
******* Domain 1 best val test acc: 55.7%, epoch: 3 *******
******* Domain 1 best test acc:     55.7%, epoch: 3 *******
epoch [4/50] batch [20/428] time 0.158 (0.135) data 0.000 (0.044) loss 3.0696 (2.7489) ce_loss 1.5117 (1.2891) loss_zs_kd 0.4754 (0.4500) loss_oracle 0.5554 (0.4701) acc 50.0000 (54.3750) kd_loss 1.0425 (0.9998) lr 1.9921e-03 eta 0:45:13
epoch [4/50] batch [40/428] time 0.077 (0.117) data 0.000 (0.022) loss 2.8525 (2.7939) ce_loss 1.3965 (1.3255) loss_zs_kd 0.4255 (0.4447) loss_oracle 0.4586 (0.4966) acc 53.1250 (53.9844) kd_loss 1.0140 (0.9977) lr 1.9921e-03 eta 0:39:15
epoch [4/50] batch [60/428] time 0.096 (0.111) data 0.000 (0.015) loss 2.7802 (2.7724) ce_loss 1.3848 (1.3166) loss_zs_kd 0.4249 (0.4472) loss_oracle 0.5486 (0.4924) acc 53.1250 (54.4271) kd_loss 0.9087 (0.9860) lr 1.9921e-03 eta 0:37:04
epoch [4/50] batch [80/428] time 0.090 (0.107) data 0.000 (0.011) loss 2.7990 (2.7572) ce_loss 1.5039 (1.3257) loss_zs_kd 0.3422 (0.4345) loss_oracle 0.3944 (0.4722) acc 50.0000 (53.8281) kd_loss 0.9268 (0.9781) lr 1.9921e-03 eta 0:35:40
epoch [4/50] batch [100/428] time 0.114 (0.106) data 0.001 (0.009) loss 2.6788 (2.7539) ce_loss 1.1963 (1.3271) loss_zs_kd 0.4700 (0.4411) loss_oracle 0.4586 (0.4628) acc 53.1250 (53.5000) kd_loss 1.0182 (0.9748) lr 1.9921e-03 eta 0:35:15
epoch [4/50] batch [120/428] time 0.099 (0.105) data 0.000 (0.008) loss 2.7057 (2.7361) ce_loss 1.3311 (1.3156) loss_zs_kd 0.4548 (0.4395) loss_oracle 0.4457 (0.4598) acc 43.7500 (54.4010) kd_loss 0.9243 (0.9708) lr 1.9921e-03 eta 0:34:52
epoch [4/50] batch [140/428] time 0.093 (0.104) data 0.000 (0.006) loss 2.6258 (2.7225) ce_loss 1.2666 (1.3074) loss_zs_kd 0.4203 (0.4388) loss_oracle 0.4619 (0.4565) acc 65.6250 (54.8438) kd_loss 0.9182 (0.9674) lr 1.9921e-03 eta 0:34:42
epoch [4/50] batch [160/428] time 0.095 (0.104) data 0.000 (0.006) loss 2.6636 (2.7281) ce_loss 1.3545 (1.3154) loss_zs_kd 0.3621 (0.4391) loss_oracle 0.4750 (0.4540) acc 56.2500 (54.4922) kd_loss 0.8906 (0.9661) lr 1.9921e-03 eta 0:34:33
epoch [4/50] batch [180/428] time 0.091 (0.104) data 0.000 (0.005) loss 2.8862 (2.7204) ce_loss 1.5244 (1.3136) loss_zs_kd 0.3507 (0.4340) loss_oracle 0.4087 (0.4540) acc 40.6250 (54.4097) kd_loss 0.9821 (0.9627) lr 1.9921e-03 eta 0:34:25
epoch [4/50] batch [200/428] time 0.113 (0.103) data 0.000 (0.005) loss 2.6389 (2.7145) ce_loss 1.3037 (1.3103) loss_zs_kd 0.4038 (0.4317) loss_oracle 0.4343 (0.4513) acc 56.2500 (54.4219) kd_loss 0.9161 (0.9627) lr 1.9921e-03 eta 0:34:21
epoch [4/50] batch [220/428] time 0.080 (0.102) data 0.000 (0.004) loss 2.6515 (2.7199) ce_loss 1.3398 (1.3171) loss_zs_kd 0.4408 (0.4325) loss_oracle 0.4224 (0.4507) acc 53.1250 (53.9205) kd_loss 0.8800 (0.9613) lr 1.9921e-03 eta 0:33:50
epoch [4/50] batch [240/428] time 0.076 (0.105) data 0.000 (0.004) loss 2.6714 (2.7158) ce_loss 1.2500 (1.3108) loss_zs_kd 0.4040 (0.4349) loss_oracle 0.4928 (0.4494) acc 56.2500 (54.0104) kd_loss 0.9730 (0.9628) lr 1.9921e-03 eta 0:34:38
epoch [4/50] batch [260/428] time 0.168 (0.104) data 0.001 (0.004) loss 2.9797 (2.7162) ce_loss 1.4932 (1.3058) loss_zs_kd 0.4705 (0.4364) loss_oracle 0.5326 (0.4540) acc 43.7500 (53.9784) kd_loss 0.9849 (0.9652) lr 1.9921e-03 eta 0:34:32
epoch [4/50] batch [280/428] time 0.092 (0.105) data 0.000 (0.003) loss 2.8179 (2.7151) ce_loss 1.3867 (1.3008) loss_zs_kd 0.4508 (0.4362) loss_oracle 0.4040 (0.4594) acc 56.2500 (54.1853) kd_loss 1.0038 (0.9666) lr 1.9921e-03 eta 0:34:36
epoch [4/50] batch [300/428] time 0.110 (0.104) data 0.000 (0.003) loss 2.6710 (2.7173) ce_loss 1.2998 (1.3013) loss_zs_kd 0.4208 (0.4389) loss_oracle 0.3989 (0.4566) acc 62.5000 (54.1875) kd_loss 0.9614 (0.9683) lr 1.9921e-03 eta 0:34:24
epoch [4/50] batch [320/428] time 0.110 (0.104) data 0.000 (0.003) loss 2.8165 (2.7132) ce_loss 1.4258 (1.2987) loss_zs_kd 0.5166 (0.4397) loss_oracle 0.4184 (0.4526) acc 53.1250 (54.2285) kd_loss 0.9232 (0.9684) lr 1.9921e-03 eta 0:34:20
epoch [4/50] batch [340/428] time 0.272 (0.104) data 0.000 (0.003) loss 2.9029 (2.7126) ce_loss 1.4492 (1.2967) loss_zs_kd 0.5133 (0.4403) loss_oracle 0.4728 (0.4531) acc 56.2500 (54.2555) kd_loss 0.9606 (0.9691) lr 1.9921e-03 eta 0:34:24
epoch [4/50] batch [360/428] time 0.099 (0.104) data 0.000 (0.003) loss 2.8699 (2.7150) ce_loss 1.4365 (1.2975) loss_zs_kd 0.3658 (0.4407) loss_oracle 0.5203 (0.4557) acc 46.8750 (54.1927) kd_loss 0.9903 (0.9694) lr 1.9921e-03 eta 0:34:18
epoch [4/50] batch [380/428] time 0.108 (0.104) data 0.000 (0.003) loss 2.7063 (2.7147) ce_loss 1.2627 (1.2950) loss_zs_kd 0.5361 (0.4412) loss_oracle 0.4678 (0.4582) acc 50.0000 (54.3010) kd_loss 0.9417 (0.9700) lr 1.9921e-03 eta 0:34:15
epoch [4/50] batch [400/428] time 0.101 (0.104) data 0.000 (0.002) loss 2.9638 (2.7172) ce_loss 1.6104 (1.2956) loss_zs_kd 0.3576 (0.4416) loss_oracle 0.4420 (0.4597) acc 37.5000 (54.3047) kd_loss 0.9536 (0.9709) lr 1.9921e-03 eta 0:34:10
epoch [4/50] batch [420/428] time 0.095 (0.104) data 0.000 (0.002) loss 2.5190 (2.7163) ce_loss 1.1035 (1.2959) loss_zs_kd 0.4179 (0.4412) loss_oracle 0.4376 (0.4566) acc 65.6250 (54.3676) kd_loss 0.9878 (0.9715) lr 1.9921e-03 eta 0:34:04
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,392
* accuracy: 57.7%
* error: 42.3%
* macro_f1: 44.1%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,518
* accuracy: 53.1%
* error: 46.9%
* macro_f1: 31.3%
******* Domain 1 best val acc:      57.7%, epoch: 4 *******
******* Domain 1 best val test acc: 53.1%, epoch: 4 *******
******* Domain 1 best test acc:     55.7%, epoch: 3 *******
epoch [5/50] batch [20/428] time 0.100 (0.158) data 0.000 (0.055) loss 2.5812 (2.7079) ce_loss 1.1768 (1.2627) loss_zs_kd 0.3674 (0.4493) loss_oracle 0.4468 (0.4627) acc 59.3750 (57.0312) kd_loss 0.9973 (0.9892) lr 1.9823e-03 eta 0:51:42
epoch [5/50] batch [40/428] time 0.076 (0.124) data 0.000 (0.028) loss 2.9143 (2.6795) ce_loss 1.4619 (1.2554) loss_zs_kd 0.4309 (0.4368) loss_oracle 0.4659 (0.4376) acc 50.0000 (56.9531) kd_loss 1.0040 (0.9869) lr 1.9823e-03 eta 0:40:38
epoch [5/50] batch [60/428] time 0.164 (0.125) data 0.000 (0.019) loss 2.6612 (2.6838) ce_loss 1.2568 (1.2433) loss_zs_kd 0.4019 (0.4529) loss_oracle 0.4922 (0.4537) acc 46.8750 (57.1354) kd_loss 0.9574 (0.9873) lr 1.9823e-03 eta 0:40:55
epoch [5/50] batch [80/428] time 0.172 (0.122) data 0.000 (0.014) loss 2.9964 (2.7159) ce_loss 1.5400 (1.2689) loss_zs_kd 0.4964 (0.4455) loss_oracle 0.5523 (0.4904) acc 46.8750 (55.3125) kd_loss 0.9320 (0.9790) lr 1.9823e-03 eta 0:39:52
epoch [5/50] batch [100/428] time 0.093 (0.117) data 0.000 (0.011) loss 2.6289 (2.7384) ce_loss 1.1670 (1.2825) loss_zs_kd 0.4417 (0.4427) loss_oracle 0.5374 (0.5112) acc 75.0000 (54.7188) kd_loss 0.9724 (0.9788) lr 1.9823e-03 eta 0:38:07
epoch [5/50] batch [120/428] time 0.102 (0.114) data 0.000 (0.009) loss 3.0757 (2.7378) ce_loss 1.6133 (1.2855) loss_zs_kd 0.5073 (0.4365) loss_oracle 0.5122 (0.5159) acc 37.5000 (54.7135) kd_loss 0.9527 (0.9761) lr 1.9823e-03 eta 0:37:08
epoch [5/50] batch [140/428] time 0.101 (0.112) data 0.000 (0.008) loss 2.5276 (2.7278) ce_loss 1.2070 (1.2810) loss_zs_kd 0.3255 (0.4341) loss_oracle 0.4475 (0.5119) acc 53.1250 (55.0000) kd_loss 0.9341 (0.9738) lr 1.9823e-03 eta 0:36:24
epoch [5/50] batch [160/428] time 0.105 (0.110) data 0.000 (0.007) loss 2.9085 (2.7421) ce_loss 1.4502 (1.2942) loss_zs_kd 0.3933 (0.4334) loss_oracle 0.5683 (0.5148) acc 40.6250 (54.3750) kd_loss 0.9775 (0.9738) lr 1.9823e-03 eta 0:35:55
epoch [5/50] batch [180/428] time 0.102 (0.109) data 0.000 (0.006) loss 2.7223 (2.7415) ce_loss 1.1523 (1.2914) loss_zs_kd 0.4711 (0.4347) loss_oracle 0.6448 (0.5177) acc 53.1250 (54.5660) kd_loss 1.0120 (0.9739) lr 1.9823e-03 eta 0:35:32
epoch [5/50] batch [200/428] time 0.095 (0.109) data 0.000 (0.006) loss 2.7347 (2.7434) ce_loss 1.2188 (1.2885) loss_zs_kd 0.2984 (0.4348) loss_oracle 0.7483 (0.5259) acc 65.6250 (54.6406) kd_loss 0.9926 (0.9746) lr 1.9823e-03 eta 0:35:20
epoch [5/50] batch [220/428] time 0.110 (0.108) data 0.000 (0.005) loss 2.7285 (2.7455) ce_loss 1.2373 (1.2889) loss_zs_kd 0.4351 (0.4338) loss_oracle 0.5913 (0.5343) acc 59.3750 (54.5739) kd_loss 0.9780 (0.9726) lr 1.9823e-03 eta 0:35:09
epoch [5/50] batch [240/428] time 0.101 (0.108) data 0.000 (0.005) loss 2.8761 (2.7461) ce_loss 1.4268 (1.2865) loss_zs_kd 0.5512 (0.4382) loss_oracle 0.5483 (0.5393) acc 50.0000 (54.8047) kd_loss 0.8996 (0.9709) lr 1.9823e-03 eta 0:34:57
epoch [5/50] batch [260/428] time 0.099 (0.107) data 0.000 (0.004) loss 2.6459 (2.7422) ce_loss 1.1924 (1.2842) loss_zs_kd 0.5073 (0.4387) loss_oracle 0.4969 (0.5364) acc 62.5000 (54.8558) kd_loss 0.9514 (0.9704) lr 1.9823e-03 eta 0:34:45
epoch [5/50] batch [280/428] time 0.088 (0.106) data 0.000 (0.004) loss 2.3366 (2.7359) ce_loss 0.9956 (1.2822) loss_zs_kd 0.3290 (0.4360) loss_oracle 0.4336 (0.5319) acc 68.7500 (54.8884) kd_loss 0.9597 (0.9698) lr 1.9823e-03 eta 0:34:15
epoch [5/50] batch [300/428] time 0.075 (0.108) data 0.000 (0.004) loss 2.8059 (2.7297) ce_loss 1.3545 (1.2801) loss_zs_kd 0.5131 (0.4362) loss_oracle 0.4499 (0.5261) acc 53.1250 (54.8646) kd_loss 0.9699 (0.9684) lr 1.9823e-03 eta 0:34:46
epoch [5/50] batch [320/428] time 0.166 (0.108) data 0.000 (0.004) loss 2.7542 (2.7261) ce_loss 1.3447 (1.2797) loss_zs_kd 0.4708 (0.4363) loss_oracle 0.4207 (0.5217) acc 50.0000 (54.8047) kd_loss 0.9637 (0.9673) lr 1.9823e-03 eta 0:34:53
epoch [5/50] batch [340/428] time 0.096 (0.107) data 0.000 (0.004) loss 2.5221 (2.7209) ce_loss 1.1562 (1.2786) loss_zs_kd 0.3730 (0.4375) loss_oracle 0.4364 (0.5160) acc 62.5000 (54.9449) kd_loss 0.9612 (0.9656) lr 1.9823e-03 eta 0:34:32
epoch [5/50] batch [360/428] time 0.086 (0.107) data 0.000 (0.003) loss 2.3208 (2.7174) ce_loss 0.9282 (1.2767) loss_zs_kd 0.4190 (0.4386) loss_oracle 0.5238 (0.5154) acc 71.8750 (54.9826) kd_loss 0.9211 (0.9637) lr 1.9823e-03 eta 0:34:23
epoch [5/50] batch [380/428] time 0.105 (0.106) data 0.000 (0.003) loss 2.8360 (2.7140) ce_loss 1.3887 (1.2723) loss_zs_kd 0.5792 (0.4426) loss_oracle 0.5521 (0.5141) acc 56.2500 (55.0905) kd_loss 0.8817 (0.9634) lr 1.9823e-03 eta 0:34:14
epoch [5/50] batch [400/428] time 0.102 (0.106) data 0.000 (0.003) loss 2.5966 (2.7146) ce_loss 1.2256 (1.2733) loss_zs_kd 0.2981 (0.4416) loss_oracle 0.6213 (0.5181) acc 50.0000 (55.0703) kd_loss 0.9113 (0.9615) lr 1.9823e-03 eta 0:34:08
epoch [5/50] batch [420/428] time 0.097 (0.106) data 0.000 (0.003) loss 2.4997 (2.7114) ce_loss 1.1016 (1.2715) loss_zs_kd 0.4108 (0.4403) loss_oracle 0.4423 (0.5185) acc 59.3750 (55.1562) kd_loss 0.9716 (0.9605) lr 1.9823e-03 eta 0:34:01
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,414
* accuracy: 58.1%
* error: 41.9%
* macro_f1: 43.5%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,647
* accuracy: 55.8%
* error: 44.2%
* macro_f1: 32.7%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 1 best val acc:      58.1%, epoch: 5 *******
******* Domain 1 best val test acc: 55.8%, epoch: 5 *******
******* Domain 1 best test acc:     55.8%, epoch: 5 *******
epoch [6/50] batch [20/428] time 0.114 (0.151) data 0.000 (0.046) loss 2.9574 (2.6213) ce_loss 1.4561 (1.2491) loss_zs_kd 0.5077 (0.4260) loss_oracle 0.5233 (0.4729) acc 59.3750 (57.0312) kd_loss 0.9858 (0.9227) lr 1.9686e-03 eta 0:48:30
epoch [6/50] batch [40/428] time 0.093 (0.126) data 0.000 (0.023) loss 2.5926 (2.6381) ce_loss 1.1514 (1.2519) loss_zs_kd 0.5004 (0.4369) loss_oracle 0.4275 (0.4864) acc 59.3750 (56.0938) kd_loss 0.9772 (0.9245) lr 1.9686e-03 eta 0:40:26
epoch [6/50] batch [60/428] time 0.096 (0.118) data 0.000 (0.016) loss 2.7828 (2.6646) ce_loss 1.3730 (1.2720) loss_zs_kd 0.4463 (0.4396) loss_oracle 0.4425 (0.4886) acc 50.0000 (55.5208) kd_loss 0.9654 (0.9286) lr 1.9686e-03 eta 0:37:44
epoch [6/50] batch [80/428] time 0.100 (0.114) data 0.000 (0.012) loss 2.7015 (2.6715) ce_loss 1.2910 (1.2883) loss_zs_kd 0.4913 (0.4362) loss_oracle 0.4220 (0.4715) acc 46.8750 (54.7266) kd_loss 0.9538 (0.9294) lr 1.9686e-03 eta 0:36:29
epoch [6/50] batch [100/428] time 0.082 (0.110) data 0.000 (0.010) loss 2.4638 (2.6585) ce_loss 1.1309 (1.2827) loss_zs_kd 0.4860 (0.4352) loss_oracle 0.3865 (0.4648) acc 50.0000 (54.5938) kd_loss 0.8967 (0.9257) lr 1.9686e-03 eta 0:35:01
epoch [6/50] batch [120/428] time 0.155 (0.113) data 0.000 (0.008) loss 2.7534 (2.6486) ce_loss 1.3613 (1.2708) loss_zs_kd 0.4634 (0.4413) loss_oracle 0.5583 (0.4639) acc 65.6250 (55.3646) kd_loss 0.8812 (0.9252) lr 1.9686e-03 eta 0:35:59
epoch [6/50] batch [140/428] time 0.171 (0.111) data 0.000 (0.007) loss 2.6382 (2.6460) ce_loss 1.2686 (1.2707) loss_zs_kd 0.4185 (0.4411) loss_oracle 0.4330 (0.4606) acc 53.1250 (55.3795) kd_loss 0.9439 (0.9245) lr 1.9686e-03 eta 0:35:18
epoch [6/50] batch [160/428] time 0.098 (0.111) data 0.000 (0.006) loss 2.9654 (2.6487) ce_loss 1.6641 (1.2763) loss_zs_kd 0.4712 (0.4437) loss_oracle 0.3977 (0.4556) acc 40.6250 (55.1367) kd_loss 0.8669 (0.9227) lr 1.9686e-03 eta 0:35:24
epoch [6/50] batch [180/428] time 0.104 (0.110) data 0.000 (0.005) loss 2.5334 (2.6517) ce_loss 1.0889 (1.2780) loss_zs_kd 0.4436 (0.4478) loss_oracle 0.4732 (0.4560) acc 71.8750 (55.2083) kd_loss 0.9861 (0.9218) lr 1.9686e-03 eta 0:35:00
epoch [6/50] batch [200/428] time 0.091 (0.109) data 0.000 (0.005) loss 2.5487 (2.6510) ce_loss 1.0430 (1.2757) loss_zs_kd 0.4570 (0.4473) loss_oracle 0.5348 (0.4591) acc 62.5000 (55.3594) kd_loss 1.0098 (0.9221) lr 1.9686e-03 eta 0:34:42
epoch [6/50] batch [220/428] time 0.106 (0.109) data 0.000 (0.004) loss 2.8402 (2.6496) ce_loss 1.5186 (1.2742) loss_zs_kd 0.3729 (0.4452) loss_oracle 0.4095 (0.4613) acc 46.8750 (55.4545) kd_loss 0.9305 (0.9222) lr 1.9686e-03 eta 0:34:30
epoch [6/50] batch [240/428] time 0.105 (0.108) data 0.000 (0.004) loss 2.5779 (2.6476) ce_loss 1.1270 (1.2698) loss_zs_kd 0.5096 (0.4465) loss_oracle 0.5384 (0.4641) acc 65.6250 (55.6771) kd_loss 0.9269 (0.9225) lr 1.9686e-03 eta 0:34:20
epoch [6/50] batch [260/428] time 0.104 (0.108) data 0.000 (0.004) loss 2.6626 (2.6487) ce_loss 1.3613 (1.2696) loss_zs_kd 0.4175 (0.4450) loss_oracle 0.4167 (0.4689) acc 53.1250 (55.5889) kd_loss 0.8842 (0.9221) lr 1.9686e-03 eta 0:34:11
epoch [6/50] batch [280/428] time 0.117 (0.108) data 0.000 (0.004) loss 2.4521 (2.6519) ce_loss 1.0918 (1.2722) loss_zs_kd 0.4011 (0.4458) loss_oracle 0.3406 (0.4693) acc 56.2500 (55.4799) kd_loss 0.9894 (0.9222) lr 1.9686e-03 eta 0:34:05
epoch [6/50] batch [300/428] time 0.105 (0.107) data 0.000 (0.003) loss 2.7130 (2.6498) ce_loss 1.3398 (1.2710) loss_zs_kd 0.4488 (0.4454) loss_oracle 0.4868 (0.4694) acc 50.0000 (55.5312) kd_loss 0.9054 (0.9213) lr 1.9686e-03 eta 0:33:56
epoch [6/50] batch [320/428] time 0.106 (0.107) data 0.000 (0.003) loss 3.0526 (2.6519) ce_loss 1.7285 (1.2742) loss_zs_kd 0.4228 (0.4454) loss_oracle 0.4200 (0.4695) acc 37.5000 (55.4297) kd_loss 0.9027 (0.9202) lr 1.9686e-03 eta 0:33:47
epoch [6/50] batch [340/428] time 0.085 (0.106) data 0.000 (0.003) loss 2.4676 (2.6495) ce_loss 1.0986 (1.2716) loss_zs_kd 0.4112 (0.4436) loss_oracle 0.4904 (0.4717) acc 62.5000 (55.4963) kd_loss 0.9181 (0.9203) lr 1.9686e-03 eta 0:33:30
epoch [6/50] batch [360/428] time 0.135 (0.108) data 0.000 (0.003) loss 2.5255 (2.6515) ce_loss 1.1006 (1.2719) loss_zs_kd 0.4221 (0.4440) loss_oracle 0.5225 (0.4745) acc 59.3750 (55.4948) kd_loss 0.9526 (0.9203) lr 1.9686e-03 eta 0:33:57
epoch [6/50] batch [380/428] time 0.170 (0.108) data 0.000 (0.003) loss 2.9158 (2.6522) ce_loss 1.4170 (1.2709) loss_zs_kd 0.4893 (0.4456) loss_oracle 0.5570 (0.4764) acc 53.1250 (55.5592) kd_loss 0.9757 (0.9204) lr 1.9686e-03 eta 0:33:49
epoch [6/50] batch [400/428] time 0.080 (0.107) data 0.000 (0.003) loss 2.4765 (2.6481) ce_loss 1.1162 (1.2643) loss_zs_kd 0.3533 (0.4469) loss_oracle 0.6481 (0.4788) acc 62.5000 (55.8281) kd_loss 0.8596 (0.9210) lr 1.9686e-03 eta 0:33:43
epoch [6/50] batch [420/428] time 0.090 (0.107) data 0.000 (0.003) loss 2.5264 (2.6508) ce_loss 1.1357 (1.2649) loss_zs_kd 0.4667 (0.4478) loss_oracle 0.5565 (0.4817) acc 53.1250 (55.7366) kd_loss 0.8790 (0.9211) lr 1.9686e-03 eta 0:33:31
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,430
* accuracy: 58.4%
* error: 41.6%
* macro_f1: 43.8%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,616
* accuracy: 55.2%
* error: 44.8%
* macro_f1: 32.8%
******* Domain 1 best val acc:      58.4%, epoch: 6 *******
******* Domain 1 best val test acc: 55.2%, epoch: 6 *******
******* Domain 1 best test acc:     55.8%, epoch: 5 *******
epoch [7/50] batch [20/428] time 0.121 (0.163) data 0.000 (0.060) loss 2.7437 (2.6350) ce_loss 1.3379 (1.2038) loss_zs_kd 0.4819 (0.4652) loss_oracle 0.5342 (0.5580) acc 59.3750 (55.7812) kd_loss 0.8978 (0.9195) lr 1.9511e-03 eta 0:51:02
epoch [7/50] batch [40/428] time 0.106 (0.131) data 0.000 (0.030) loss 2.5220 (2.6545) ce_loss 1.1680 (1.2394) loss_zs_kd 0.4093 (0.4479) loss_oracle 0.5686 (0.5607) acc 59.3750 (55.4688) kd_loss 0.8651 (0.9109) lr 1.9511e-03 eta 0:41:10
epoch [7/50] batch [60/428] time 0.100 (0.121) data 0.000 (0.020) loss 2.7117 (2.6466) ce_loss 1.2764 (1.2413) loss_zs_kd 0.4334 (0.4489) loss_oracle 0.5560 (0.5607) acc 62.5000 (55.9896) kd_loss 0.9407 (0.9005) lr 1.9511e-03 eta 0:37:54
epoch [7/50] batch [80/428] time 0.113 (0.116) data 0.000 (0.015) loss 2.7405 (2.6418) ce_loss 1.2891 (1.2426) loss_zs_kd 0.4605 (0.4446) loss_oracle 0.4989 (0.5541) acc 59.3750 (56.6016) kd_loss 0.9718 (0.9000) lr 1.9511e-03 eta 0:36:23
epoch [7/50] batch [100/428] time 0.101 (0.113) data 0.000 (0.012) loss 2.3542 (2.6323) ce_loss 0.9502 (1.2414) loss_zs_kd 0.4747 (0.4504) loss_oracle 0.4434 (0.5351) acc 75.0000 (56.7812) kd_loss 0.9449 (0.8981) lr 1.9511e-03 eta 0:35:25
epoch [7/50] batch [120/428] time 0.109 (0.111) data 0.000 (0.010) loss 2.8194 (2.6183) ce_loss 1.3867 (1.2366) loss_zs_kd 0.4851 (0.4449) loss_oracle 0.4505 (0.5233) acc 43.7500 (56.5104) kd_loss 0.9649 (0.8976) lr 1.9511e-03 eta 0:34:41
epoch [7/50] batch [140/428] time 0.101 (0.110) data 0.000 (0.009) loss 3.1435 (2.6276) ce_loss 1.7412 (1.2513) loss_zs_kd 0.4565 (0.4450) loss_oracle 0.5904 (0.5213) acc 34.3750 (56.0268) kd_loss 0.8788 (0.8932) lr 1.9511e-03 eta 0:34:16
epoch [7/50] batch [160/428] time 0.092 (0.108) data 0.000 (0.008) loss 2.6064 (2.6232) ce_loss 1.1621 (1.2461) loss_zs_kd 0.5050 (0.4484) loss_oracle 0.4879 (0.5232) acc 59.3750 (56.3867) kd_loss 0.9478 (0.8913) lr 1.9511e-03 eta 0:33:41
epoch [7/50] batch [180/428] time 0.083 (0.105) data 0.000 (0.007) loss 2.5022 (2.6184) ce_loss 1.2412 (1.2491) loss_zs_kd 0.3937 (0.4449) loss_oracle 0.4817 (0.5243) acc 56.2500 (55.8854) kd_loss 0.8233 (0.8847) lr 1.9511e-03 eta 0:32:47
epoch [7/50] batch [200/428] time 0.166 (0.107) data 0.000 (0.006) loss 2.3604 (2.6112) ce_loss 0.9790 (1.2499) loss_zs_kd 0.5028 (0.4421) loss_oracle 0.5240 (0.5182) acc 75.0000 (56.1875) kd_loss 0.8680 (0.8812) lr 1.9511e-03 eta 0:33:11
epoch [7/50] batch [220/428] time 0.080 (0.105) data 0.000 (0.006) loss 2.5946 (2.6078) ce_loss 1.3652 (1.2507) loss_zs_kd 0.4382 (0.4406) loss_oracle 0.5590 (0.5177) acc 50.0000 (55.9233) kd_loss 0.7308 (0.8779) lr 1.9511e-03 eta 0:32:40
epoch [7/50] batch [240/428] time 0.071 (0.107) data 0.000 (0.005) loss 2.6587 (2.6067) ce_loss 1.4180 (1.2512) loss_zs_kd 0.5223 (0.4430) loss_oracle 0.4094 (0.5109) acc 50.0000 (56.1458) kd_loss 0.7749 (0.8786) lr 1.9511e-03 eta 0:33:02
epoch [7/50] batch [260/428] time 0.108 (0.105) data 0.000 (0.005) loss 2.4978 (2.6056) ce_loss 1.1377 (1.2548) loss_zs_kd 0.5397 (0.4418) loss_oracle 0.3988 (0.5047) acc 59.3750 (55.9736) kd_loss 0.8908 (0.8776) lr 1.9511e-03 eta 0:32:23
epoch [7/50] batch [280/428] time 0.096 (0.104) data 0.000 (0.005) loss 2.9293 (2.6040) ce_loss 1.4775 (1.2542) loss_zs_kd 0.5266 (0.4441) loss_oracle 0.5120 (0.5009) acc 50.0000 (55.8482) kd_loss 0.9325 (0.8773) lr 1.9511e-03 eta 0:32:06
epoch [7/50] batch [300/428] time 0.087 (0.103) data 0.000 (0.004) loss 2.3866 (2.6024) ce_loss 1.0361 (1.2519) loss_zs_kd 0.3724 (0.4459) loss_oracle 0.5230 (0.4997) acc 68.7500 (55.9167) kd_loss 0.9028 (0.8776) lr 1.9511e-03 eta 0:31:49
epoch [7/50] batch [320/428] time 0.094 (0.103) data 0.000 (0.004) loss 2.6169 (2.6002) ce_loss 1.3262 (1.2498) loss_zs_kd 0.4379 (0.4478) loss_oracle 0.4718 (0.4973) acc 59.3750 (56.0547) kd_loss 0.8359 (0.8778) lr 1.9511e-03 eta 0:31:43
epoch [7/50] batch [340/428] time 0.095 (0.103) data 0.000 (0.004) loss 2.6567 (2.5978) ce_loss 1.3262 (1.2511) loss_zs_kd 0.5014 (0.4464) loss_oracle 0.4412 (0.4944) acc 46.8750 (55.9559) kd_loss 0.8592 (0.8764) lr 1.9511e-03 eta 0:31:39
epoch [7/50] batch [360/428] time 0.100 (0.103) data 0.000 (0.004) loss 2.5503 (2.5960) ce_loss 1.2012 (1.2510) loss_zs_kd 0.3762 (0.4461) loss_oracle 0.4987 (0.4921) acc 50.0000 (55.9983) kd_loss 0.9117 (0.8759) lr 1.9511e-03 eta 0:31:35
epoch [7/50] batch [380/428] time 0.097 (0.103) data 0.000 (0.003) loss 2.3815 (2.5922) ce_loss 1.0479 (1.2475) loss_zs_kd 0.4041 (0.4474) loss_oracle 0.5012 (0.4913) acc 62.5000 (56.1184) kd_loss 0.8810 (0.8754) lr 1.9511e-03 eta 0:31:31
epoch [7/50] batch [400/428] time 0.112 (0.103) data 0.000 (0.003) loss 3.0453 (2.5927) ce_loss 1.7236 (1.2469) loss_zs_kd 0.4609 (0.4489) loss_oracle 0.5443 (0.4927) acc 25.0000 (56.1562) kd_loss 0.8191 (0.8751) lr 1.9511e-03 eta 0:31:34
epoch [7/50] batch [420/428] time 0.090 (0.102) data 0.000 (0.003) loss 2.3324 (2.5898) ce_loss 1.0361 (1.2445) loss_zs_kd 0.4251 (0.4496) loss_oracle 0.4662 (0.4905) acc 59.3750 (56.2054) kd_loss 0.8506 (0.8753) lr 1.9511e-03 eta 0:31:26
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,305
* accuracy: 56.2%
* error: 43.8%
* macro_f1: 42.6%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,598
* accuracy: 54.8%
* error: 45.2%
* macro_f1: 29.9%
******* Domain 1 best val acc:      58.4%, epoch: 6 *******
******* Domain 1 best val test acc: 55.2%, epoch: 6 *******
******* Domain 1 best test acc:     55.8%, epoch: 5 *******
epoch [8/50] batch [20/428] time 0.098 (0.168) data 0.000 (0.063) loss 2.4277 (2.5506) ce_loss 1.1377 (1.2245) loss_zs_kd 0.3288 (0.4241) loss_oracle 0.4482 (0.5039) acc 65.6250 (57.5000) kd_loss 0.9015 (0.8621) lr 1.9298e-03 eta 0:51:26
epoch [8/50] batch [40/428] time 0.096 (0.136) data 0.000 (0.032) loss 2.5071 (2.5628) ce_loss 1.2744 (1.2446) loss_zs_kd 0.4493 (0.4365) loss_oracle 0.4900 (0.4825) acc 56.2500 (55.5469) kd_loss 0.7630 (0.8587) lr 1.9298e-03 eta 0:41:28
epoch [8/50] batch [60/428] time 0.081 (0.121) data 0.000 (0.021) loss 2.3446 (2.5754) ce_loss 1.0635 (1.2619) loss_zs_kd 0.4081 (0.4270) loss_oracle 0.4821 (0.4833) acc 68.7500 (54.9479) kd_loss 0.8360 (0.8583) lr 1.9298e-03 eta 0:37:07
epoch [8/50] batch [80/428] time 0.080 (0.124) data 0.000 (0.016) loss 2.8927 (2.5809) ce_loss 1.5566 (1.2684) loss_zs_kd 0.4743 (0.4326) loss_oracle 0.4938 (0.4802) acc 50.0000 (55.0391) kd_loss 0.8520 (0.8560) lr 1.9298e-03 eta 0:37:58
epoch [8/50] batch [100/428] time 0.087 (0.116) data 0.000 (0.013) loss 2.6452 (2.5894) ce_loss 1.3311 (1.2749) loss_zs_kd 0.5202 (0.4374) loss_oracle 0.3743 (0.4760) acc 62.5000 (55.1250) kd_loss 0.8669 (0.8578) lr 1.9298e-03 eta 0:35:29
epoch [8/50] batch [120/428] time 0.081 (0.118) data 0.000 (0.011) loss 2.4401 (2.5787) ce_loss 1.0801 (1.2619) loss_zs_kd 0.3506 (0.4386) loss_oracle 0.5025 (0.4699) acc 68.7500 (55.6250) kd_loss 0.9335 (0.8625) lr 1.9298e-03 eta 0:35:51
epoch [8/50] batch [140/428] time 0.098 (0.115) data 0.000 (0.009) loss 2.6649 (2.5761) ce_loss 1.4043 (1.2590) loss_zs_kd 0.4733 (0.4397) loss_oracle 0.4359 (0.4661) acc 40.6250 (55.8705) kd_loss 0.8059 (0.8642) lr 1.9298e-03 eta 0:34:59
epoch [8/50] batch [160/428] time 0.095 (0.113) data 0.000 (0.008) loss 2.6281 (2.5706) ce_loss 1.2686 (1.2545) loss_zs_kd 0.4714 (0.4433) loss_oracle 0.4454 (0.4603) acc 59.3750 (55.8789) kd_loss 0.9012 (0.8643) lr 1.9298e-03 eta 0:34:24
epoch [8/50] batch [180/428] time 0.109 (0.111) data 0.000 (0.007) loss 2.7297 (2.5724) ce_loss 1.4141 (1.2555) loss_zs_kd 0.3769 (0.4434) loss_oracle 0.5534 (0.4649) acc 50.0000 (55.7986) kd_loss 0.8505 (0.8628) lr 1.9298e-03 eta 0:33:51
epoch [8/50] batch [200/428] time 0.105 (0.110) data 0.000 (0.007) loss 2.7546 (2.5700) ce_loss 1.4590 (1.2528) loss_zs_kd 0.3858 (0.4455) loss_oracle 0.5336 (0.4654) acc 46.8750 (55.8750) kd_loss 0.8358 (0.8617) lr 1.9298e-03 eta 0:33:27
epoch [8/50] batch [220/428] time 0.106 (0.110) data 0.000 (0.006) loss 2.6467 (2.5683) ce_loss 1.3125 (1.2496) loss_zs_kd 0.4989 (0.4493) loss_oracle 0.5238 (0.4670) acc 59.3750 (55.7955) kd_loss 0.8229 (0.8605) lr 1.9298e-03 eta 0:33:11
epoch [8/50] batch [240/428] time 0.102 (0.109) data 0.000 (0.005) loss 2.4484 (2.5645) ce_loss 1.1592 (1.2462) loss_zs_kd 0.4575 (0.4488) loss_oracle 0.5093 (0.4698) acc 68.7500 (56.0286) kd_loss 0.8058 (0.8589) lr 1.9298e-03 eta 0:32:57
epoch [8/50] batch [260/428] time 0.106 (0.108) data 0.000 (0.005) loss 2.5074 (2.5641) ce_loss 1.1396 (1.2423) loss_zs_kd 0.4254 (0.4494) loss_oracle 0.5726 (0.4731) acc 56.2500 (56.1538) kd_loss 0.8687 (0.8605) lr 1.9298e-03 eta 0:32:44
epoch [8/50] batch [280/428] time 0.095 (0.108) data 0.000 (0.005) loss 2.5233 (2.5640) ce_loss 1.1680 (1.2412) loss_zs_kd 0.3853 (0.4483) loss_oracle 0.5746 (0.4782) acc 62.5000 (56.2388) kd_loss 0.8753 (0.8595) lr 1.9298e-03 eta 0:32:31
epoch [8/50] batch [300/428] time 0.093 (0.107) data 0.000 (0.004) loss 2.5844 (2.5660) ce_loss 1.3184 (1.2421) loss_zs_kd 0.4337 (0.4475) loss_oracle 0.5593 (0.4838) acc 50.0000 (56.1771) kd_loss 0.7695 (0.8582) lr 1.9298e-03 eta 0:32:12
epoch [8/50] batch [320/428] time 0.079 (0.105) data 0.000 (0.004) loss 2.6196 (2.5692) ce_loss 1.2129 (1.2417) loss_zs_kd 0.5154 (0.4477) loss_oracle 0.6079 (0.4909) acc 56.2500 (56.2109) kd_loss 0.8451 (0.8581) lr 1.9298e-03 eta 0:31:44
epoch [8/50] batch [340/428] time 0.093 (0.107) data 0.001 (0.004) loss 2.4129 (2.5711) ce_loss 1.0293 (1.2422) loss_zs_kd 0.6000 (0.4489) loss_oracle 0.5173 (0.4947) acc 59.3750 (56.1397) kd_loss 0.8250 (0.8571) lr 1.9298e-03 eta 0:32:11
epoch [8/50] batch [360/428] time 0.172 (0.107) data 0.000 (0.004) loss 2.5250 (2.5713) ce_loss 1.1758 (1.2400) loss_zs_kd 0.3951 (0.4509) loss_oracle 0.6619 (0.4990) acc 62.5000 (56.2066) kd_loss 0.8207 (0.8563) lr 1.9298e-03 eta 0:32:02
epoch [8/50] batch [380/428] time 0.082 (0.106) data 0.000 (0.004) loss 2.4427 (2.5722) ce_loss 1.1719 (1.2385) loss_zs_kd 0.4163 (0.4509) loss_oracle 0.5260 (0.5040) acc 62.5000 (56.3734) kd_loss 0.7996 (0.8562) lr 1.9298e-03 eta 0:31:57
epoch [8/50] batch [400/428] time 0.098 (0.106) data 0.000 (0.003) loss 2.2519 (2.5720) ce_loss 0.8413 (1.2374) loss_zs_kd 0.4794 (0.4513) loss_oracle 0.4683 (0.5036) acc 75.0000 (56.2812) kd_loss 0.9367 (0.8572) lr 1.9298e-03 eta 0:31:50
epoch [8/50] batch [420/428] time 0.096 (0.106) data 0.000 (0.003) loss 2.7522 (2.5736) ce_loss 1.3799 (1.2364) loss_zs_kd 0.3334 (0.4505) loss_oracle 0.6535 (0.5063) acc 56.2500 (56.3616) kd_loss 0.8789 (0.8587) lr 1.9298e-03 eta 0:31:40
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,367
* accuracy: 57.3%
* error: 42.7%
* macro_f1: 44.9%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,649
* accuracy: 55.9%
* error: 44.1%
* macro_f1: 32.6%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 1 best val acc:      58.4%, epoch: 6 *******
******* Domain 1 best val test acc: 55.2%, epoch: 6 *******
******* Domain 1 best test acc:     55.9%, epoch: 8 *******
epoch [9/50] batch [20/428] time 0.093 (0.166) data 0.000 (0.063) loss 2.3596 (2.5773) ce_loss 1.0615 (1.2061) loss_zs_kd 0.4732 (0.4377) loss_oracle 0.5326 (0.5474) acc 62.5000 (57.0312) kd_loss 0.7951 (0.8787) lr 1.9048e-03 eta 0:49:46
epoch [9/50] batch [40/428] time 0.102 (0.134) data 0.000 (0.032) loss 2.7551 (2.5803) ce_loss 1.4023 (1.2192) loss_zs_kd 0.4015 (0.4315) loss_oracle 0.4863 (0.5378) acc 56.2500 (55.9375) kd_loss 0.9088 (0.8765) lr 1.9048e-03 eta 0:40:10
epoch [9/50] batch [60/428] time 0.114 (0.124) data 0.000 (0.021) loss 2.3596 (2.5814) ce_loss 1.0254 (1.2257) loss_zs_kd 0.4042 (0.4269) loss_oracle 0.5116 (0.5357) acc 68.7500 (56.0938) kd_loss 0.8763 (0.8744) lr 1.9048e-03 eta 0:36:56
epoch [9/50] batch [80/428] time 0.114 (0.119) data 0.000 (0.016) loss 2.5134 (2.5627) ce_loss 1.2158 (1.2149) loss_zs_kd 0.5153 (0.4369) loss_oracle 0.5137 (0.5176) acc 59.3750 (57.0703) kd_loss 0.7830 (0.8706) lr 1.9048e-03 eta 0:35:22
epoch [9/50] batch [100/428] time 0.103 (0.115) data 0.000 (0.013) loss 2.5762 (2.5712) ce_loss 1.2295 (1.2197) loss_zs_kd 0.3869 (0.4412) loss_oracle 0.5880 (0.5170) acc 62.5000 (57.0625) kd_loss 0.8593 (0.8724) lr 1.9048e-03 eta 0:34:22
epoch [9/50] batch [120/428] time 0.105 (0.113) data 0.000 (0.011) loss 2.5594 (2.5713) ce_loss 1.3105 (1.2180) loss_zs_kd 0.4348 (0.4438) loss_oracle 0.4286 (0.5161) acc 50.0000 (57.1615) kd_loss 0.8172 (0.8733) lr 1.9048e-03 eta 0:33:42
epoch [9/50] batch [140/428] time 0.101 (0.112) data 0.000 (0.009) loss 2.6878 (2.5685) ce_loss 1.3750 (1.2175) loss_zs_kd 0.4571 (0.4474) loss_oracle 0.4209 (0.5101) acc 50.0000 (57.0759) kd_loss 0.8738 (0.8724) lr 1.9048e-03 eta 0:33:08
epoch [9/50] batch [160/428] time 0.091 (0.110) data 0.000 (0.008) loss 2.7075 (2.5678) ce_loss 1.3750 (1.2161) loss_zs_kd 0.4576 (0.4512) loss_oracle 0.5148 (0.5078) acc 40.6250 (57.1484) kd_loss 0.8463 (0.8722) lr 1.9048e-03 eta 0:32:33
epoch [9/50] batch [180/428] time 0.164 (0.109) data 0.000 (0.007) loss 2.8805 (2.5723) ce_loss 1.4482 (1.2193) loss_zs_kd 0.5171 (0.4500) loss_oracle 0.5632 (0.5147) acc 53.1250 (56.9618) kd_loss 0.8921 (0.8707) lr 1.9048e-03 eta 0:32:15
epoch [9/50] batch [200/428] time 0.084 (0.109) data 0.000 (0.007) loss 2.4400 (2.5790) ce_loss 1.1924 (1.2241) loss_zs_kd 0.4235 (0.4525) loss_oracle 0.4461 (0.5175) acc 68.7500 (56.8906) kd_loss 0.8128 (0.8698) lr 1.9048e-03 eta 0:32:25
epoch [9/50] batch [220/428] time 0.074 (0.111) data 0.000 (0.006) loss 2.5890 (2.5803) ce_loss 1.1611 (1.2228) loss_zs_kd 0.5932 (0.4527) loss_oracle 0.5712 (0.5202) acc 56.2500 (56.9460) kd_loss 0.8457 (0.8711) lr 1.9048e-03 eta 0:32:48
epoch [9/50] batch [240/428] time 0.113 (0.109) data 0.000 (0.006) loss 2.6397 (2.5801) ce_loss 1.2256 (1.2224) loss_zs_kd 0.4606 (0.4520) loss_oracle 0.5600 (0.5222) acc 65.6250 (56.9531) kd_loss 0.9038 (0.8706) lr 1.9048e-03 eta 0:32:14
epoch [9/50] batch [260/428] time 0.098 (0.108) data 0.000 (0.005) loss 2.7760 (2.5828) ce_loss 1.4307 (1.2265) loss_zs_kd 0.5404 (0.4522) loss_oracle 0.4966 (0.5202) acc 50.0000 (56.6827) kd_loss 0.8268 (0.8701) lr 1.9048e-03 eta 0:32:01
epoch [9/50] batch [280/428] time 0.099 (0.108) data 0.000 (0.005) loss 2.4645 (2.5797) ce_loss 1.1025 (1.2236) loss_zs_kd 0.4738 (0.4546) loss_oracle 0.5280 (0.5186) acc 62.5000 (56.9196) kd_loss 0.8610 (0.8696) lr 1.9048e-03 eta 0:31:49
epoch [9/50] batch [300/428] time 0.101 (0.107) data 0.000 (0.004) loss 2.6146 (2.5788) ce_loss 1.2695 (1.2226) loss_zs_kd 0.5606 (0.4561) loss_oracle 0.4518 (0.5174) acc 59.3750 (56.9896) kd_loss 0.8388 (0.8695) lr 1.9048e-03 eta 0:31:39
epoch [9/50] batch [320/428] time 0.093 (0.107) data 0.000 (0.004) loss 2.6897 (2.5716) ce_loss 1.3496 (1.2172) loss_zs_kd 0.3830 (0.4546) loss_oracle 0.5381 (0.5145) acc 46.8750 (57.1387) kd_loss 0.8795 (0.8699) lr 1.9048e-03 eta 0:31:30
epoch [9/50] batch [340/428] time 0.093 (0.107) data 0.000 (0.004) loss 2.6065 (2.5731) ce_loss 1.3281 (1.2196) loss_zs_kd 0.3589 (0.4539) loss_oracle 0.4974 (0.5130) acc 46.8750 (57.0496) kd_loss 0.8503 (0.8700) lr 1.9048e-03 eta 0:31:22
epoch [9/50] batch [360/428] time 0.107 (0.106) data 0.000 (0.004) loss 2.5030 (2.5726) ce_loss 1.2002 (1.2204) loss_zs_kd 0.5139 (0.4523) loss_oracle 0.4556 (0.5117) acc 46.8750 (56.9705) kd_loss 0.8180 (0.8703) lr 1.9048e-03 eta 0:31:13
epoch [9/50] batch [380/428] time 0.093 (0.106) data 0.000 (0.004) loss 2.6831 (2.5766) ce_loss 1.3125 (1.2252) loss_zs_kd 0.3914 (0.4527) loss_oracle 0.4813 (0.5103) acc 43.7500 (56.8586) kd_loss 0.9342 (0.8699) lr 1.9048e-03 eta 0:31:06
epoch [9/50] batch [400/428] time 0.100 (0.106) data 0.000 (0.003) loss 2.8636 (2.5815) ce_loss 1.5020 (1.2301) loss_zs_kd 0.5041 (0.4526) loss_oracle 0.4787 (0.5090) acc 40.6250 (56.7422) kd_loss 0.8703 (0.8706) lr 1.9048e-03 eta 0:30:59
epoch [9/50] batch [420/428] time 0.073 (0.105) data 0.000 (0.003) loss 2.3062 (2.5792) ce_loss 1.0488 (1.2300) loss_zs_kd 0.3519 (0.4518) loss_oracle 0.4714 (0.5066) acc 62.5000 (56.8080) kd_loss 0.8457 (0.8700) lr 1.9048e-03 eta 0:30:41
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,421
* accuracy: 58.2%
* error: 41.8%
* macro_f1: 44.5%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,616
* accuracy: 55.2%
* error: 44.8%
* macro_f1: 33.2%
******* Domain 1 best val acc:      58.4%, epoch: 6 *******
******* Domain 1 best val test acc: 55.2%, epoch: 6 *******
******* Domain 1 best test acc:     55.9%, epoch: 8 *******
epoch [10/50] batch [20/428] time 0.089 (0.154) data 0.000 (0.056) loss 2.6760 (2.5912) ce_loss 1.3574 (1.2521) loss_zs_kd 0.4920 (0.4628) loss_oracle 0.4501 (0.4630) acc 43.7500 (55.1562) kd_loss 0.8475 (0.8762) lr 1.8763e-03 eta 0:44:58
epoch [10/50] batch [40/428] time 0.080 (0.119) data 0.000 (0.028) loss 2.2861 (2.5904) ce_loss 0.9556 (1.2528) loss_zs_kd 0.4448 (0.4674) loss_oracle 0.3925 (0.4577) acc 65.6250 (54.4531) kd_loss 0.9118 (0.8751) lr 1.8763e-03 eta 0:34:50
epoch [10/50] batch [60/428] time 0.172 (0.121) data 0.000 (0.019) loss 2.5593 (2.5587) ce_loss 1.2529 (1.2392) loss_zs_kd 0.4177 (0.4473) loss_oracle 0.5470 (0.4575) acc 53.1250 (56.5104) kd_loss 0.8241 (0.8671) lr 1.8763e-03 eta 0:35:17
epoch [10/50] batch [80/428] time 0.077 (0.113) data 0.000 (0.014) loss 2.6087 (2.5680) ce_loss 1.2842 (1.2419) loss_zs_kd 0.4482 (0.4572) loss_oracle 0.4424 (0.4590) acc 59.3750 (56.5625) kd_loss 0.8792 (0.8679) lr 1.8763e-03 eta 0:32:54
epoch [10/50] batch [100/428] time 0.079 (0.116) data 0.000 (0.011) loss 2.4318 (2.5680) ce_loss 1.0967 (1.2422) loss_zs_kd 0.4579 (0.4566) loss_oracle 0.4426 (0.4700) acc 56.2500 (56.0625) kd_loss 0.8848 (0.8625) lr 1.8763e-03 eta 0:33:37
epoch [10/50] batch [120/428] time 0.076 (0.110) data 0.000 (0.010) loss 2.6304 (2.5732) ce_loss 1.3350 (1.2443) loss_zs_kd 0.5007 (0.4587) loss_oracle 0.4176 (0.4772) acc 59.3750 (56.0156) kd_loss 0.8363 (0.8610) lr 1.8763e-03 eta 0:32:03
epoch [10/50] batch [140/428] time 0.105 (0.109) data 0.000 (0.008) loss 2.5851 (2.5730) ce_loss 1.1992 (1.2423) loss_zs_kd 0.4503 (0.4616) loss_oracle 0.5054 (0.4788) acc 53.1250 (56.2277) kd_loss 0.9081 (0.8605) lr 1.8763e-03 eta 0:31:35
epoch [10/50] batch [160/428] time 0.107 (0.108) data 0.000 (0.007) loss 2.4229 (2.5736) ce_loss 1.1309 (1.2407) loss_zs_kd 0.3754 (0.4622) loss_oracle 0.5392 (0.4837) acc 50.0000 (56.3086) kd_loss 0.8347 (0.8600) lr 1.8763e-03 eta 0:31:18
epoch [10/50] batch [180/428] time 0.098 (0.107) data 0.000 (0.006) loss 2.6226 (2.5764) ce_loss 1.2021 (1.2434) loss_zs_kd 0.4720 (0.4620) loss_oracle 0.5486 (0.4873) acc 65.6250 (56.4583) kd_loss 0.9102 (0.8583) lr 1.8763e-03 eta 0:31:06
epoch [10/50] batch [200/428] time 0.102 (0.107) data 0.000 (0.006) loss 2.6987 (2.5740) ce_loss 1.3096 (1.2436) loss_zs_kd 0.3437 (0.4562) loss_oracle 0.5048 (0.4886) acc 53.1250 (56.3281) kd_loss 0.9649 (0.8580) lr 1.8763e-03 eta 0:30:57
epoch [10/50] batch [220/428] time 0.100 (0.107) data 0.000 (0.005) loss 2.5309 (2.5740) ce_loss 1.1201 (1.2483) loss_zs_kd 0.4708 (0.4526) loss_oracle 0.5011 (0.4851) acc 56.2500 (56.2358) kd_loss 0.9249 (0.8569) lr 1.8763e-03 eta 0:30:47
epoch [10/50] batch [240/428] time 0.108 (0.106) data 0.000 (0.005) loss 2.8076 (2.5717) ce_loss 1.5801 (1.2505) loss_zs_kd 0.4983 (0.4523) loss_oracle 0.3762 (0.4769) acc 50.0000 (56.1198) kd_loss 0.7902 (0.8565) lr 1.8763e-03 eta 0:30:39
epoch [10/50] batch [260/428] time 0.086 (0.106) data 0.000 (0.005) loss 2.5814 (2.5690) ce_loss 1.2314 (1.2475) loss_zs_kd 0.5122 (0.4542) loss_oracle 0.4157 (0.4734) acc 65.6250 (56.3582) kd_loss 0.8860 (0.8577) lr 1.8763e-03 eta 0:30:27
epoch [10/50] batch [280/428] time 0.100 (0.105) data 0.000 (0.004) loss 2.5266 (2.5645) ce_loss 1.2188 (1.2431) loss_zs_kd 0.4005 (0.4555) loss_oracle 0.4235 (0.4698) acc 53.1250 (56.3728) kd_loss 0.8958 (0.8587) lr 1.8763e-03 eta 0:30:18
epoch [10/50] batch [300/428] time 0.073 (0.104) data 0.000 (0.004) loss 2.2584 (2.5621) ce_loss 0.9160 (1.2394) loss_zs_kd 0.3965 (0.4583) loss_oracle 0.4344 (0.4659) acc 75.0000 (56.5208) kd_loss 0.9270 (0.8606) lr 1.8763e-03 eta 0:29:51
epoch [10/50] batch [320/428] time 0.162 (0.104) data 0.000 (0.004) loss 2.1608 (2.5567) ce_loss 0.8442 (1.2333) loss_zs_kd 0.4234 (0.4567) loss_oracle 0.5116 (0.4648) acc 71.8750 (56.7969) kd_loss 0.8491 (0.8627) lr 1.8763e-03 eta 0:29:59
epoch [10/50] batch [340/428] time 0.084 (0.104) data 0.000 (0.004) loss 2.9063 (2.5603) ce_loss 1.6250 (1.2358) loss_zs_kd 0.4052 (0.4584) loss_oracle 0.4135 (0.4628) acc 50.0000 (56.6820) kd_loss 0.8720 (0.8639) lr 1.8763e-03 eta 0:29:48
epoch [10/50] batch [360/428] time 0.078 (0.105) data 0.000 (0.003) loss 2.3760 (2.5586) ce_loss 1.1035 (1.2333) loss_zs_kd 0.4006 (0.4594) loss_oracle 0.3877 (0.4610) acc 65.6250 (56.9878) kd_loss 0.8783 (0.8651) lr 1.8763e-03 eta 0:30:07
epoch [10/50] batch [380/428] time 0.098 (0.104) data 0.000 (0.003) loss 2.9031 (2.5578) ce_loss 1.5801 (1.2307) loss_zs_kd 0.4237 (0.4585) loss_oracle 0.5038 (0.4636) acc 46.8750 (57.0888) kd_loss 0.8592 (0.8661) lr 1.8763e-03 eta 0:29:47
epoch [10/50] batch [400/428] time 0.094 (0.104) data 0.000 (0.003) loss 2.7654 (2.5597) ce_loss 1.3037 (1.2289) loss_zs_kd 0.5125 (0.4585) loss_oracle 0.4662 (0.4690) acc 43.7500 (57.0938) kd_loss 0.9723 (0.8671) lr 1.8763e-03 eta 0:29:43
epoch [10/50] batch [420/428] time 0.094 (0.104) data 0.000 (0.003) loss 2.6194 (2.5606) ce_loss 1.2051 (1.2310) loss_zs_kd 0.4289 (0.4566) loss_oracle 0.4591 (0.4667) acc 68.7500 (57.1057) kd_loss 0.9703 (0.8679) lr 1.8763e-03 eta 0:29:38
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,471
* accuracy: 59.1%
* error: 40.9%
* macro_f1: 44.7%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,542
* accuracy: 53.6%
* error: 46.4%
* macro_f1: 32.1%
******* Domain 1 best val acc:      59.1%, epoch: 10 *******
******* Domain 1 best val test acc: 53.6%, epoch: 10 *******
******* Domain 1 best test acc:     55.9%, epoch: 8 *******
epoch [11/50] batch [20/428] time 0.104 (0.174) data 0.000 (0.071) loss 2.6416 (2.6076) ce_loss 1.2754 (1.2562) loss_zs_kd 0.4536 (0.4238) loss_oracle 0.5220 (0.5058) acc 56.2500 (57.8125) kd_loss 0.8784 (0.8866) lr 1.8443e-03 eta 0:49:26
epoch [11/50] batch [40/428] time 0.105 (0.137) data 0.000 (0.036) loss 2.8289 (2.5804) ce_loss 1.3984 (1.2149) loss_zs_kd 0.4586 (0.4497) loss_oracle 0.4984 (0.4922) acc 53.1250 (58.4375) kd_loss 0.9519 (0.8946) lr 1.8443e-03 eta 0:39:03
epoch [11/50] batch [60/428] time 0.099 (0.126) data 0.000 (0.024) loss 2.4714 (2.5778) ce_loss 1.0752 (1.2157) loss_zs_kd 0.5926 (0.4517) loss_oracle 0.4601 (0.4846) acc 59.3750 (57.8125) kd_loss 0.8698 (0.8939) lr 1.8443e-03 eta 0:35:45
epoch [11/50] batch [80/428] time 0.102 (0.119) data 0.000 (0.018) loss 2.6059 (2.5695) ce_loss 1.2734 (1.2116) loss_zs_kd 0.4083 (0.4447) loss_oracle 0.4659 (0.4734) acc 50.0000 (57.5781) kd_loss 0.8953 (0.8989) lr 1.8443e-03 eta 0:33:49
epoch [11/50] batch [100/428] time 0.098 (0.116) data 0.000 (0.014) loss 2.2996 (2.5727) ce_loss 0.9966 (1.2120) loss_zs_kd 0.4968 (0.4461) loss_oracle 0.4562 (0.4665) acc 62.5000 (57.5625) kd_loss 0.8266 (0.9044) lr 1.8443e-03 eta 0:32:52
epoch [11/50] batch [120/428] time 0.099 (0.113) data 0.000 (0.012) loss 2.7523 (2.5749) ce_loss 1.2920 (1.2093) loss_zs_kd 0.4374 (0.4453) loss_oracle 0.4642 (0.4632) acc 43.7500 (57.8906) kd_loss 1.0095 (0.9114) lr 1.8443e-03 eta 0:32:05
epoch [11/50] batch [140/428] time 0.082 (0.110) data 0.000 (0.010) loss 2.8749 (2.5848) ce_loss 1.4502 (1.2166) loss_zs_kd 0.5040 (0.4445) loss_oracle 0.4210 (0.4603) acc 50.0000 (57.2768) kd_loss 0.9622 (0.9157) lr 1.8443e-03 eta 0:31:10
epoch [11/50] batch [160/428] time 0.161 (0.108) data 0.000 (0.009) loss 2.7552 (2.5902) ce_loss 1.4424 (1.2175) loss_zs_kd 0.4399 (0.4496) loss_oracle 0.5020 (0.4636) acc 53.1250 (57.3633) kd_loss 0.8418 (0.9161) lr 1.8443e-03 eta 0:30:36
epoch [11/50] batch [180/428] time 0.075 (0.109) data 0.000 (0.008) loss 2.5697 (2.5965) ce_loss 1.2080 (1.2216) loss_zs_kd 0.5076 (0.4486) loss_oracle 0.5052 (0.4679) acc 56.2500 (57.0660) kd_loss 0.8553 (0.9167) lr 1.8443e-03 eta 0:30:47
epoch [11/50] batch [200/428] time 0.172 (0.110) data 0.000 (0.007) loss 2.7826 (2.6060) ce_loss 1.3838 (1.2261) loss_zs_kd 0.4116 (0.4497) loss_oracle 0.4809 (0.4731) acc 56.2500 (56.8906) kd_loss 0.9526 (0.9185) lr 1.8443e-03 eta 0:31:03
epoch [11/50] batch [220/428] time 0.081 (0.108) data 0.000 (0.007) loss 2.7092 (2.6104) ce_loss 1.2354 (1.2278) loss_zs_kd 0.3882 (0.4507) loss_oracle 0.5491 (0.4754) acc 50.0000 (56.7756) kd_loss 1.0052 (0.9196) lr 1.8443e-03 eta 0:30:32
epoch [11/50] batch [240/428] time 0.106 (0.108) data 0.000 (0.006) loss 2.7974 (2.6091) ce_loss 1.3125 (1.2236) loss_zs_kd 0.5614 (0.4528) loss_oracle 0.4543 (0.4743) acc 53.1250 (56.9792) kd_loss 0.9771 (0.9219) lr 1.8443e-03 eta 0:30:18
epoch [11/50] batch [260/428] time 0.091 (0.107) data 0.000 (0.006) loss 2.7177 (2.6155) ce_loss 1.3105 (1.2288) loss_zs_kd 0.4619 (0.4537) loss_oracle 0.5068 (0.4717) acc 56.2500 (56.7788) kd_loss 0.9228 (0.9240) lr 1.8443e-03 eta 0:30:09
epoch [11/50] batch [280/428] time 0.099 (0.107) data 0.000 (0.005) loss 2.6128 (2.6146) ce_loss 1.0859 (1.2270) loss_zs_kd 0.5412 (0.4547) loss_oracle 0.5183 (0.4723) acc 65.6250 (56.8973) kd_loss 0.9971 (0.9241) lr 1.8443e-03 eta 0:30:01
epoch [11/50] batch [300/428] time 0.115 (0.107) data 0.000 (0.005) loss 2.6020 (2.6160) ce_loss 1.3623 (1.2290) loss_zs_kd 0.4856 (0.4554) loss_oracle 0.3894 (0.4723) acc 56.2500 (56.9479) kd_loss 0.8022 (0.9232) lr 1.8443e-03 eta 0:29:53
epoch [11/50] batch [320/428] time 0.097 (0.107) data 0.000 (0.005) loss 2.5355 (2.6148) ce_loss 1.1279 (1.2293) loss_zs_kd 0.4733 (0.4553) loss_oracle 0.3677 (0.4676) acc 53.1250 (57.0410) kd_loss 0.9871 (0.9240) lr 1.8443e-03 eta 0:29:53
epoch [11/50] batch [340/428] time 0.110 (0.107) data 0.000 (0.004) loss 2.6250 (2.6097) ce_loss 1.3203 (1.2257) loss_zs_kd 0.4004 (0.4548) loss_oracle 0.3149 (0.4628) acc 59.3750 (57.2702) kd_loss 0.9470 (0.9251) lr 1.8443e-03 eta 0:29:47
epoch [11/50] batch [360/428] time 0.103 (0.106) data 0.000 (0.004) loss 2.6062 (2.6089) ce_loss 1.2256 (1.2249) loss_zs_kd 0.4282 (0.4556) loss_oracle 0.3870 (0.4605) acc 56.2500 (57.2569) kd_loss 0.9730 (0.9260) lr 1.8443e-03 eta 0:29:39
epoch [11/50] batch [380/428] time 0.100 (0.106) data 0.000 (0.004) loss 2.7100 (2.6094) ce_loss 1.2588 (1.2263) loss_zs_kd 0.4990 (0.4545) loss_oracle 0.4293 (0.4578) acc 53.1250 (57.1053) kd_loss 0.9871 (0.9270) lr 1.8443e-03 eta 0:29:31
epoch [11/50] batch [400/428] time 0.094 (0.105) data 0.000 (0.004) loss 2.4751 (2.6105) ce_loss 1.1631 (1.2280) loss_zs_kd 0.5086 (0.4539) loss_oracle 0.3866 (0.4551) acc 56.2500 (56.9453) kd_loss 0.8644 (0.9280) lr 1.8443e-03 eta 0:29:09
epoch [11/50] batch [420/428] time 0.172 (0.105) data 0.000 (0.004) loss 2.5576 (2.6078) ce_loss 1.1953 (1.2272) loss_zs_kd 0.4763 (0.4537) loss_oracle 0.3740 (0.4516) acc 59.3750 (57.0387) kd_loss 0.9372 (0.9280) lr 1.8443e-03 eta 0:29:13
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,489
* accuracy: 59.4%
* error: 40.6%
* macro_f1: 45.6%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,567
* accuracy: 54.1%
* error: 45.9%
* macro_f1: 32.1%
******* Domain 1 best val acc:      59.4%, epoch: 11 *******
******* Domain 1 best val test acc: 54.1%, epoch: 11 *******
******* Domain 1 best test acc:     55.9%, epoch: 8 *******
epoch [12/50] batch [20/428] time 0.088 (0.167) data 0.001 (0.081) loss 2.5149 (2.6074) ce_loss 1.0801 (1.1958) loss_zs_kd 0.4436 (0.4723) loss_oracle 0.5337 (0.4576) acc 62.5000 (59.3750) kd_loss 0.9462 (0.9467) lr 1.8090e-03 eta 0:46:27
epoch [12/50] batch [40/428] time 0.076 (0.149) data 0.000 (0.040) loss 2.6494 (2.6083) ce_loss 1.2568 (1.1933) loss_zs_kd 0.5711 (0.4698) loss_oracle 0.4717 (0.4609) acc 50.0000 (58.9062) kd_loss 0.8712 (0.9497) lr 1.8090e-03 eta 0:41:25
epoch [12/50] batch [60/428] time 0.090 (0.126) data 0.000 (0.027) loss 2.6781 (2.6158) ce_loss 1.2598 (1.2085) loss_zs_kd 0.3965 (0.4653) loss_oracle 0.5183 (0.4618) acc 50.0000 (57.9167) kd_loss 0.9609 (0.9437) lr 1.8090e-03 eta 0:34:57
epoch [12/50] batch [80/428] time 0.077 (0.125) data 0.000 (0.020) loss 2.5761 (2.6213) ce_loss 1.0801 (1.2097) loss_zs_kd 0.5101 (0.4626) loss_oracle 0.4397 (0.4669) acc 65.6250 (58.0859) kd_loss 1.0211 (0.9469) lr 1.8090e-03 eta 0:34:39
epoch [12/50] batch [100/428] time 0.104 (0.118) data 0.000 (0.016) loss 2.7696 (2.6263) ce_loss 1.4141 (1.2178) loss_zs_kd 0.4816 (0.4583) loss_oracle 0.5367 (0.4647) acc 53.1250 (57.6875) kd_loss 0.8464 (0.9470) lr 1.8090e-03 eta 0:32:42
epoch [12/50] batch [120/428] time 0.100 (0.115) data 0.000 (0.014) loss 2.4997 (2.6316) ce_loss 1.1025 (1.2251) loss_zs_kd 0.4164 (0.4601) loss_oracle 0.4831 (0.4626) acc 53.1250 (57.4479) kd_loss 0.9475 (0.9451) lr 1.8090e-03 eta 0:31:41
epoch [12/50] batch [140/428] time 0.107 (0.112) data 0.000 (0.012) loss 2.5070 (2.6265) ce_loss 1.1367 (1.2230) loss_zs_kd 0.3508 (0.4553) loss_oracle 0.4681 (0.4619) acc 59.3750 (57.3438) kd_loss 0.9608 (0.9449) lr 1.8090e-03 eta 0:30:59
epoch [12/50] batch [160/428] time 0.109 (0.111) data 0.000 (0.010) loss 2.5849 (2.6282) ce_loss 1.1543 (1.2272) loss_zs_kd 0.5502 (0.4552) loss_oracle 0.3767 (0.4585) acc 56.2500 (57.3047) kd_loss 0.9671 (0.9442) lr 1.8090e-03 eta 0:30:32
epoch [12/50] batch [180/428] time 0.122 (0.111) data 0.000 (0.009) loss 2.4854 (2.6213) ce_loss 1.0312 (1.2221) loss_zs_kd 0.3978 (0.4585) loss_oracle 0.5590 (0.4538) acc 71.8750 (57.7604) kd_loss 0.9757 (0.9430) lr 1.8090e-03 eta 0:30:26
epoch [12/50] batch [200/428] time 0.099 (0.109) data 0.000 (0.008) loss 2.6940 (2.6208) ce_loss 1.1826 (1.2208) loss_zs_kd 0.5160 (0.4606) loss_oracle 0.3987 (0.4535) acc 56.2500 (57.8125) kd_loss 1.0540 (0.9430) lr 1.8090e-03 eta 0:30:03
epoch [12/50] batch [220/428] time 0.094 (0.108) data 0.000 (0.008) loss 2.4716 (2.6213) ce_loss 1.1348 (1.2229) loss_zs_kd 0.3402 (0.4583) loss_oracle 0.3773 (0.4533) acc 53.1250 (57.6278) kd_loss 0.9780 (0.9426) lr 1.8090e-03 eta 0:29:45
epoch [12/50] batch [240/428] time 0.103 (0.108) data 0.000 (0.007) loss 2.6044 (2.6210) ce_loss 1.3145 (1.2265) loss_zs_kd 0.3697 (0.4561) loss_oracle 0.4104 (0.4508) acc 56.2500 (57.4740) kd_loss 0.8999 (0.9411) lr 1.8090e-03 eta 0:29:34
epoch [12/50] batch [260/428] time 0.075 (0.106) data 0.000 (0.006) loss 2.3961 (2.6183) ce_loss 0.9414 (1.2253) loss_zs_kd 0.3654 (0.4579) loss_oracle 0.3546 (0.4479) acc 62.5000 (57.5601) kd_loss 1.0947 (0.9401) lr 1.8090e-03 eta 0:29:08
epoch [12/50] batch [280/428] time 0.152 (0.105) data 0.000 (0.006) loss 2.5394 (2.6176) ce_loss 1.1641 (1.2261) loss_zs_kd 0.4788 (0.4581) loss_oracle 0.3686 (0.4443) acc 65.6250 (57.6228) kd_loss 0.9516 (0.9403) lr 1.8090e-03 eta 0:28:50
epoch [12/50] batch [300/428] time 0.102 (0.107) data 0.000 (0.006) loss 2.5044 (2.6146) ce_loss 1.1113 (1.2248) loss_zs_kd 0.5705 (0.4587) loss_oracle 0.3769 (0.4419) acc 62.5000 (57.6875) kd_loss 0.9194 (0.9395) lr 1.8090e-03 eta 0:29:14
epoch [12/50] batch [320/428] time 0.144 (0.106) data 0.000 (0.005) loss 2.3313 (2.6115) ce_loss 1.0684 (1.2238) loss_zs_kd 0.4181 (0.4594) loss_oracle 0.3901 (0.4380) acc 59.3750 (57.6074) kd_loss 0.8589 (0.9389) lr 1.8090e-03 eta 0:28:52
epoch [12/50] batch [340/428] time 0.088 (0.107) data 0.000 (0.005) loss 3.0439 (2.6103) ce_loss 1.6143 (1.2236) loss_zs_kd 0.4113 (0.4581) loss_oracle 0.5132 (0.4368) acc 53.1250 (57.7022) kd_loss 0.9673 (0.9392) lr 1.8090e-03 eta 0:29:04
epoch [12/50] batch [360/428] time 0.101 (0.106) data 0.000 (0.005) loss 2.3715 (2.6072) ce_loss 0.9326 (1.2196) loss_zs_kd 0.4811 (0.4570) loss_oracle 0.5684 (0.4382) acc 62.5000 (57.8125) kd_loss 0.9142 (0.9400) lr 1.8090e-03 eta 0:28:49
epoch [12/50] batch [380/428] time 0.108 (0.106) data 0.000 (0.004) loss 2.9273 (2.6071) ce_loss 1.5234 (1.2196) loss_zs_kd 0.3596 (0.4560) loss_oracle 0.4198 (0.4398) acc 37.5000 (57.6480) kd_loss 1.0142 (0.9397) lr 1.8090e-03 eta 0:28:52
epoch [12/50] batch [400/428] time 0.105 (0.106) data 0.000 (0.004) loss 2.4765 (2.6064) ce_loss 1.0527 (1.2185) loss_zs_kd 0.4647 (0.4563) loss_oracle 0.4407 (0.4410) acc 65.6250 (57.7109) kd_loss 0.9711 (0.9392) lr 1.8090e-03 eta 0:28:46
epoch [12/50] batch [420/428] time 0.096 (0.106) data 0.000 (0.004) loss 2.7364 (2.6114) ce_loss 1.4092 (1.2219) loss_zs_kd 0.4033 (0.4573) loss_oracle 0.5380 (0.4428) acc 50.0000 (57.5446) kd_loss 0.8565 (0.9394) lr 1.8090e-03 eta 0:28:39
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,493
* accuracy: 59.4%
* error: 40.6%
* macro_f1: 46.3%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,513
* accuracy: 53.0%
* error: 47.0%
* macro_f1: 32.9%
******* Domain 1 best val acc:      59.4%, epoch: 12 *******
******* Domain 1 best val test acc: 53.0%, epoch: 12 *******
******* Domain 1 best test acc:     55.9%, epoch: 8 *******
epoch [13/50] batch [20/428] time 0.092 (0.181) data 0.000 (0.080) loss 2.6696 (2.7240) ce_loss 1.2090 (1.2618) loss_zs_kd 0.5436 (0.5168) loss_oracle 0.3998 (0.4803) acc 68.7500 (56.2500) kd_loss 0.9889 (0.9636) lr 1.7705e-03 eta 0:49:04
epoch [13/50] batch [40/428] time 0.101 (0.143) data 0.000 (0.040) loss 2.7929 (2.7045) ce_loss 1.3594 (1.2544) loss_zs_kd 0.4672 (0.4992) loss_oracle 0.4685 (0.4785) acc 68.7500 (58.3594) kd_loss 0.9657 (0.9612) lr 1.7705e-03 eta 0:38:35
epoch [13/50] batch [60/428] time 0.097 (0.130) data 0.000 (0.027) loss 2.6712 (2.6641) ce_loss 1.2598 (1.2267) loss_zs_kd 0.4448 (0.4730) loss_oracle 0.3888 (0.4714) acc 56.2500 (58.1771) kd_loss 0.9946 (0.9653) lr 1.7705e-03 eta 0:35:07
epoch [13/50] batch [80/428] time 0.090 (0.123) data 0.001 (0.020) loss 2.6114 (2.6683) ce_loss 1.1836 (1.2344) loss_zs_kd 0.4535 (0.4677) loss_oracle 0.4533 (0.4649) acc 59.3750 (57.4219) kd_loss 0.9743 (0.9676) lr 1.7705e-03 eta 0:33:12
epoch [13/50] batch [100/428] time 0.104 (0.119) data 0.000 (0.016) loss 2.6166 (2.6623) ce_loss 1.1729 (1.2325) loss_zs_kd 0.4923 (0.4646) loss_oracle 0.4764 (0.4620) acc 53.1250 (57.4375) kd_loss 0.9594 (0.9666) lr 1.7705e-03 eta 0:32:04
epoch [13/50] batch [120/428] time 0.096 (0.116) data 0.000 (0.013) loss 2.4643 (2.6531) ce_loss 1.1191 (1.2314) loss_zs_kd 0.3805 (0.4627) loss_oracle 0.4490 (0.4560) acc 71.8750 (57.6042) kd_loss 0.9305 (0.9624) lr 1.7705e-03 eta 0:31:09
epoch [13/50] batch [140/428] time 0.093 (0.111) data 0.000 (0.012) loss 2.4482 (2.6397) ce_loss 1.0850 (1.2223) loss_zs_kd 0.4310 (0.4646) loss_oracle 0.4062 (0.4506) acc 65.6250 (57.9688) kd_loss 0.9446 (0.9598) lr 1.7705e-03 eta 0:29:52
epoch [13/50] batch [160/428] time 0.162 (0.114) data 0.000 (0.010) loss 2.6391 (2.6423) ce_loss 1.2178 (1.2312) loss_zs_kd 0.4330 (0.4617) loss_oracle 0.4303 (0.4457) acc 59.3750 (57.8516) kd_loss 0.9896 (0.9575) lr 1.7705e-03 eta 0:30:36
epoch [13/50] batch [180/428] time 0.077 (0.110) data 0.000 (0.009) loss 2.4408 (2.6325) ce_loss 0.9761 (1.2191) loss_zs_kd 0.5334 (0.4669) loss_oracle 0.4769 (0.4456) acc 75.0000 (58.3160) kd_loss 0.9596 (0.9572) lr 1.7705e-03 eta 0:29:35
epoch [13/50] batch [200/428] time 0.158 (0.111) data 0.000 (0.008) loss 2.5489 (2.6239) ce_loss 1.1182 (1.2140) loss_zs_kd 0.4948 (0.4655) loss_oracle 0.3939 (0.4431) acc 56.2500 (58.3594) kd_loss 0.9864 (0.9556) lr 1.7705e-03 eta 0:29:40
epoch [13/50] batch [220/428] time 0.086 (0.109) data 0.000 (0.008) loss 2.6808 (2.6204) ce_loss 1.1836 (1.2101) loss_zs_kd 0.4506 (0.4660) loss_oracle 0.4434 (0.4413) acc 65.6250 (58.6222) kd_loss 1.0502 (0.9566) lr 1.7705e-03 eta 0:29:08
epoch [13/50] batch [240/428] time 0.102 (0.108) data 0.000 (0.007) loss 2.6292 (2.6174) ce_loss 1.2119 (1.2064) loss_zs_kd 0.5050 (0.4662) loss_oracle 0.3002 (0.4397) acc 65.6250 (58.5807) kd_loss 1.0147 (0.9580) lr 1.7705e-03 eta 0:28:52
epoch [13/50] batch [260/428] time 0.103 (0.108) data 0.000 (0.006) loss 2.8017 (2.6184) ce_loss 1.4043 (1.2088) loss_zs_kd 0.3640 (0.4649) loss_oracle 0.3854 (0.4347) acc 46.8750 (58.4255) kd_loss 1.0227 (0.9598) lr 1.7705e-03 eta 0:28:44
epoch [13/50] batch [280/428] time 0.101 (0.107) data 0.000 (0.006) loss 2.6963 (2.6172) ce_loss 1.2871 (1.2099) loss_zs_kd 0.3742 (0.4637) loss_oracle 0.4222 (0.4292) acc 46.8750 (58.2812) kd_loss 1.0110 (0.9608) lr 1.7705e-03 eta 0:28:38
epoch [13/50] batch [300/428] time 0.093 (0.107) data 0.000 (0.006) loss 2.7259 (2.6185) ce_loss 1.3018 (1.2127) loss_zs_kd 0.5312 (0.4629) loss_oracle 0.4542 (0.4266) acc 40.6250 (58.1146) kd_loss 0.9315 (0.9611) lr 1.7705e-03 eta 0:28:31
epoch [13/50] batch [320/428] time 0.107 (0.107) data 0.000 (0.005) loss 2.5871 (2.6154) ce_loss 1.2500 (1.2103) loss_zs_kd 0.4365 (0.4645) loss_oracle 0.3665 (0.4243) acc 65.6250 (58.2715) kd_loss 0.9356 (0.9607) lr 1.7705e-03 eta 0:28:25
epoch [13/50] batch [340/428] time 0.104 (0.107) data 0.000 (0.005) loss 2.4651 (2.6183) ce_loss 1.0742 (1.2137) loss_zs_kd 0.5163 (0.4658) loss_oracle 0.3688 (0.4234) acc 65.6250 (58.2077) kd_loss 0.9483 (0.9600) lr 1.7705e-03 eta 0:28:20
epoch [13/50] batch [360/428] time 0.107 (0.107) data 0.000 (0.005) loss 2.7906 (2.6162) ce_loss 1.4072 (1.2130) loss_zs_kd 0.4088 (0.4653) loss_oracle 0.3607 (0.4202) acc 43.7500 (58.0382) kd_loss 0.9986 (0.9605) lr 1.7705e-03 eta 0:28:14
epoch [13/50] batch [380/428] time 0.105 (0.106) data 0.000 (0.004) loss 2.6371 (2.6151) ce_loss 1.2861 (1.2140) loss_zs_kd 0.4725 (0.4667) loss_oracle 0.3567 (0.4172) acc 56.2500 (58.0428) kd_loss 0.9364 (0.9591) lr 1.7705e-03 eta 0:28:09
epoch [13/50] batch [400/428] time 0.093 (0.106) data 0.000 (0.004) loss 2.7714 (2.6106) ce_loss 1.3506 (1.2121) loss_zs_kd 0.4996 (0.4662) loss_oracle 0.3711 (0.4132) acc 59.3750 (58.0625) kd_loss 0.9854 (0.9588) lr 1.7705e-03 eta 0:27:59
epoch [13/50] batch [420/428] time 0.071 (0.105) data 0.000 (0.004) loss 2.6475 (2.6086) ce_loss 1.2969 (1.2123) loss_zs_kd 0.3536 (0.4660) loss_oracle 0.3654 (0.4107) acc 56.2500 (58.0952) kd_loss 0.9911 (0.9579) lr 1.7705e-03 eta 0:27:38
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,548
* accuracy: 60.4%
* error: 39.6%
* macro_f1: 46.9%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,600
* accuracy: 54.8%
* error: 45.2%
* macro_f1: 31.3%
******* Domain 1 best val acc:      60.4%, epoch: 13 *******
******* Domain 1 best val test acc: 54.8%, epoch: 13 *******
******* Domain 1 best test acc:     55.9%, epoch: 8 *******
epoch [14/50] batch [20/428] time 0.084 (0.183) data 0.000 (0.091) loss 2.7481 (2.6738) ce_loss 1.2900 (1.2835) loss_zs_kd 0.4903 (0.4795) loss_oracle 0.3270 (0.3848) acc 62.5000 (53.9062) kd_loss 1.0494 (0.9582) lr 1.7290e-03 eta 0:48:13
epoch [14/50] batch [40/428] time 0.173 (0.139) data 0.000 (0.046) loss 2.8049 (2.5970) ce_loss 1.4180 (1.2222) loss_zs_kd 0.4600 (0.4597) loss_oracle 0.3657 (0.3753) acc 50.0000 (57.1094) kd_loss 0.9741 (0.9573) lr 1.7290e-03 eta 0:36:37
epoch [14/50] batch [60/428] time 0.080 (0.130) data 0.000 (0.030) loss 2.3466 (2.5816) ce_loss 0.9155 (1.2068) loss_zs_kd 0.4958 (0.4565) loss_oracle 0.4324 (0.3733) acc 65.6250 (58.0208) kd_loss 0.9670 (0.9598) lr 1.7290e-03 eta 0:34:15
epoch [14/50] batch [80/428] time 0.163 (0.121) data 0.000 (0.023) loss 2.1540 (2.5820) ce_loss 0.8296 (1.1994) loss_zs_kd 0.3590 (0.4625) loss_oracle 0.4758 (0.3826) acc 81.2500 (58.3984) kd_loss 0.9070 (0.9601) lr 1.7290e-03 eta 0:31:53
epoch [14/50] batch [100/428] time 0.081 (0.120) data 0.000 (0.018) loss 2.7737 (2.5861) ce_loss 1.3877 (1.1998) loss_zs_kd 0.3922 (0.4633) loss_oracle 0.4720 (0.3882) acc 43.7500 (58.4062) kd_loss 0.9540 (0.9606) lr 1.7290e-03 eta 0:31:23
epoch [14/50] batch [120/428] time 0.105 (0.115) data 0.000 (0.015) loss 2.4191 (2.5870) ce_loss 1.0176 (1.1932) loss_zs_kd 0.4705 (0.4708) loss_oracle 0.4105 (0.3952) acc 65.6250 (58.7240) kd_loss 0.9610 (0.9608) lr 1.7290e-03 eta 0:30:08
epoch [14/50] batch [140/428] time 0.105 (0.113) data 0.000 (0.013) loss 2.5384 (2.5836) ce_loss 1.1104 (1.1971) loss_zs_kd 0.4817 (0.4622) loss_oracle 0.3745 (0.3927) acc 62.5000 (58.4375) kd_loss 0.9999 (0.9591) lr 1.7290e-03 eta 0:29:36
epoch [14/50] batch [160/428] time 0.106 (0.112) data 0.000 (0.012) loss 2.4980 (2.5822) ce_loss 1.0127 (1.1895) loss_zs_kd 0.5620 (0.4666) loss_oracle 0.4746 (0.3971) acc 65.6250 (58.7109) kd_loss 0.9670 (0.9608) lr 1.7290e-03 eta 0:29:12
epoch [14/50] batch [180/428] time 0.100 (0.111) data 0.000 (0.010) loss 2.6211 (2.5874) ce_loss 1.2393 (1.1971) loss_zs_kd 0.4193 (0.4627) loss_oracle 0.4344 (0.4021) acc 56.2500 (58.1944) kd_loss 0.9550 (0.9579) lr 1.7290e-03 eta 0:28:53
epoch [14/50] batch [200/428] time 0.104 (0.110) data 0.000 (0.009) loss 2.7888 (2.5905) ce_loss 1.3203 (1.1974) loss_zs_kd 0.4715 (0.4661) loss_oracle 0.4182 (0.4016) acc 56.2500 (58.5312) kd_loss 1.0236 (0.9593) lr 1.7290e-03 eta 0:28:41
epoch [14/50] batch [220/428] time 0.103 (0.109) data 0.000 (0.009) loss 2.5899 (2.5980) ce_loss 1.2012 (1.2050) loss_zs_kd 0.4422 (0.4645) loss_oracle 0.4206 (0.4040) acc 68.7500 (58.3523) kd_loss 0.9573 (0.9587) lr 1.7290e-03 eta 0:28:27
epoch [14/50] batch [240/428] time 0.113 (0.109) data 0.000 (0.008) loss 2.3430 (2.5965) ce_loss 0.9941 (1.2023) loss_zs_kd 0.3715 (0.4647) loss_oracle 0.4640 (0.4063) acc 78.1250 (58.5547) kd_loss 0.9311 (0.9587) lr 1.7290e-03 eta 0:28:16
epoch [14/50] batch [260/428] time 0.101 (0.108) data 0.000 (0.007) loss 2.5206 (2.5978) ce_loss 1.0234 (1.2029) loss_zs_kd 0.4120 (0.4628) loss_oracle 0.5191 (0.4095) acc 62.5000 (58.4615) kd_loss 1.0316 (0.9588) lr 1.7290e-03 eta 0:28:06
epoch [14/50] batch [280/428] time 0.084 (0.108) data 0.000 (0.007) loss 2.5484 (2.5974) ce_loss 1.1621 (1.2005) loss_zs_kd 0.4426 (0.4632) loss_oracle 0.3945 (0.4123) acc 65.6250 (58.6161) kd_loss 0.9677 (0.9591) lr 1.7290e-03 eta 0:27:55
epoch [14/50] batch [300/428] time 0.090 (0.106) data 0.000 (0.006) loss 2.6793 (2.6010) ce_loss 1.2754 (1.2025) loss_zs_kd 0.4809 (0.4640) loss_oracle 0.4337 (0.4148) acc 50.0000 (58.4583) kd_loss 0.9466 (0.9591) lr 1.7290e-03 eta 0:27:31
epoch [14/50] batch [320/428] time 0.082 (0.108) data 0.000 (0.006) loss 2.4738 (2.6041) ce_loss 1.0967 (1.2077) loss_zs_kd 0.3755 (0.4602) loss_oracle 0.3275 (0.4136) acc 62.5000 (58.2227) kd_loss 1.0257 (0.9595) lr 1.7290e-03 eta 0:27:56
epoch [14/50] batch [340/428] time 0.085 (0.107) data 0.000 (0.006) loss 2.4015 (2.6023) ce_loss 1.0469 (1.2058) loss_zs_kd 0.4625 (0.4632) loss_oracle 0.4333 (0.4116) acc 65.6250 (58.3272) kd_loss 0.9067 (0.9592) lr 1.7290e-03 eta 0:27:31
epoch [14/50] batch [360/428] time 0.090 (0.108) data 0.000 (0.005) loss 2.7120 (2.6041) ce_loss 1.2725 (1.2071) loss_zs_kd 0.4800 (0.4627) loss_oracle 0.4036 (0.4115) acc 59.3750 (58.1337) kd_loss 0.9978 (0.9599) lr 1.7290e-03 eta 0:27:47
epoch [14/50] batch [380/428] time 0.090 (0.107) data 0.000 (0.005) loss 3.0108 (2.6043) ce_loss 1.5957 (1.2058) loss_zs_kd 0.4303 (0.4649) loss_oracle 0.3869 (0.4129) acc 34.3750 (58.2730) kd_loss 1.0065 (0.9595) lr 1.7290e-03 eta 0:27:26
epoch [14/50] batch [400/428] time 0.096 (0.106) data 0.000 (0.005) loss 2.8386 (2.6073) ce_loss 1.3438 (1.2082) loss_zs_kd 0.4865 (0.4627) loss_oracle 0.5144 (0.4156) acc 46.8750 (58.1016) kd_loss 0.9944 (0.9600) lr 1.7290e-03 eta 0:27:16
epoch [14/50] batch [420/428] time 0.090 (0.105) data 0.000 (0.005) loss 3.0502 (2.6137) ce_loss 1.5557 (1.2119) loss_zs_kd 0.5887 (0.4636) loss_oracle 0.5651 (0.4198) acc 28.1250 (57.9167) kd_loss 0.9176 (0.9601) lr 1.7290e-03 eta 0:27:05
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,390
* accuracy: 57.7%
* error: 42.3%
* macro_f1: 45.8%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,654
* accuracy: 56.0%
* error: 44.0%
* macro_f1: 31.7%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 1 best val acc:      60.4%, epoch: 13 *******
******* Domain 1 best val test acc: 54.8%, epoch: 13 *******
******* Domain 1 best test acc:     56.0%, epoch: 14 *******
epoch [15/50] batch [20/428] time 0.091 (0.201) data 0.000 (0.101) loss 2.5016 (2.6282) ce_loss 1.0957 (1.1863) loss_zs_kd 0.3699 (0.4665) loss_oracle 0.4347 (0.4885) acc 56.2500 (58.4375) kd_loss 1.0036 (0.9644) lr 1.6845e-03 eta 0:51:28
epoch [15/50] batch [40/428] time 0.108 (0.150) data 0.000 (0.051) loss 2.6040 (2.6327) ce_loss 1.1436 (1.2187) loss_zs_kd 0.6049 (0.4424) loss_oracle 0.6014 (0.4784) acc 56.2500 (57.4219) kd_loss 0.8572 (0.9536) lr 1.6845e-03 eta 0:38:24
epoch [15/50] batch [60/428] time 0.091 (0.132) data 0.000 (0.034) loss 2.8405 (2.6553) ce_loss 1.4326 (1.2445) loss_zs_kd 0.5134 (0.4449) loss_oracle 0.4732 (0.4695) acc 40.6250 (56.0417) kd_loss 0.9145 (0.9536) lr 1.6845e-03 eta 0:33:49
epoch [15/50] batch [80/428] time 0.102 (0.124) data 0.000 (0.025) loss 2.7126 (2.6354) ce_loss 1.3271 (1.2282) loss_zs_kd 0.5115 (0.4514) loss_oracle 0.4362 (0.4592) acc 53.1250 (56.9531) kd_loss 0.9116 (0.9520) lr 1.6845e-03 eta 0:31:33
epoch [15/50] batch [100/428] time 0.094 (0.119) data 0.000 (0.020) loss 2.7249 (2.6377) ce_loss 1.3535 (1.2252) loss_zs_kd 0.5805 (0.4629) loss_oracle 0.4036 (0.4571) acc 46.8750 (57.6562) kd_loss 0.8793 (0.9525) lr 1.6845e-03 eta 0:30:14
epoch [15/50] batch [120/428] time 0.085 (0.116) data 0.000 (0.017) loss 2.5253 (2.6283) ce_loss 1.2852 (1.2231) loss_zs_kd 0.3401 (0.4644) loss_oracle 0.4041 (0.4504) acc 65.6250 (57.9688) kd_loss 0.8680 (0.9478) lr 1.6845e-03 eta 0:29:27
epoch [15/50] batch [140/428] time 0.098 (0.114) data 0.000 (0.015) loss 2.5954 (2.6245) ce_loss 1.2109 (1.2246) loss_zs_kd 0.5416 (0.4597) loss_oracle 0.4519 (0.4490) acc 56.2500 (57.8795) kd_loss 0.8878 (0.9455) lr 1.6845e-03 eta 0:28:58
epoch [15/50] batch [160/428] time 0.095 (0.112) data 0.000 (0.013) loss 2.6417 (2.6238) ce_loss 1.2158 (1.2208) loss_zs_kd 0.5448 (0.4661) loss_oracle 0.4886 (0.4449) acc 62.5000 (57.8125) kd_loss 0.9092 (0.9475) lr 1.6845e-03 eta 0:28:28
epoch [15/50] batch [180/428] time 0.083 (0.108) data 0.000 (0.011) loss 2.7642 (2.6204) ce_loss 1.3877 (1.2204) loss_zs_kd 0.5324 (0.4660) loss_oracle 0.3480 (0.4394) acc 56.2500 (57.8646) kd_loss 0.9363 (0.9473) lr 1.6845e-03 eta 0:27:30
epoch [15/50] batch [200/428] time 0.171 (0.109) data 0.000 (0.010) loss 2.4002 (2.6164) ce_loss 0.9800 (1.2168) loss_zs_kd 0.4901 (0.4688) loss_oracle 0.4165 (0.4328) acc 65.6250 (57.7031) kd_loss 0.9669 (0.9489) lr 1.6845e-03 eta 0:27:31
epoch [15/50] batch [220/428] time 0.074 (0.107) data 0.000 (0.009) loss 2.6964 (2.6169) ce_loss 1.3486 (1.2169) loss_zs_kd 0.4656 (0.4708) loss_oracle 0.4544 (0.4312) acc 59.3750 (57.8551) kd_loss 0.8877 (0.9489) lr 1.6845e-03 eta 0:27:09
epoch [15/50] batch [240/428] time 0.066 (0.105) data 0.000 (0.009) loss 2.8246 (2.6127) ce_loss 1.3135 (1.2146) loss_zs_kd 0.4609 (0.4706) loss_oracle 0.4302 (0.4292) acc 59.3750 (58.0078) kd_loss 1.0656 (0.9482) lr 1.6845e-03 eta 0:26:27
epoch [15/50] batch [260/428] time 0.077 (0.106) data 0.000 (0.008) loss 2.8411 (2.6101) ce_loss 1.3506 (1.2102) loss_zs_kd 0.4815 (0.4709) loss_oracle 0.4924 (0.4317) acc 50.0000 (58.2212) kd_loss 1.0035 (0.9486) lr 1.6845e-03 eta 0:26:43
epoch [15/50] batch [280/428] time 0.105 (0.104) data 0.000 (0.007) loss 2.7111 (2.6081) ce_loss 1.3525 (1.2074) loss_zs_kd 0.4673 (0.4705) loss_oracle 0.3920 (0.4336) acc 56.2500 (58.3259) kd_loss 0.9289 (0.9487) lr 1.6845e-03 eta 0:26:16
epoch [15/50] batch [300/428] time 0.094 (0.104) data 0.000 (0.007) loss 2.6743 (2.6074) ce_loss 1.2725 (1.2051) loss_zs_kd 0.3671 (0.4700) loss_oracle 0.4968 (0.4373) acc 50.0000 (58.3333) kd_loss 0.9698 (0.9488) lr 1.6845e-03 eta 0:26:11
epoch [15/50] batch [320/428] time 0.100 (0.104) data 0.000 (0.007) loss 2.8914 (2.6091) ce_loss 1.5303 (1.2075) loss_zs_kd 0.5243 (0.4698) loss_oracle 0.4770 (0.4388) acc 46.8750 (58.0469) kd_loss 0.8604 (0.9472) lr 1.6845e-03 eta 0:26:04
epoch [15/50] batch [340/428] time 0.104 (0.103) data 0.000 (0.006) loss 2.6811 (2.6136) ce_loss 1.2559 (1.2106) loss_zs_kd 0.3928 (0.4705) loss_oracle 0.5135 (0.4382) acc 46.8750 (57.9044) kd_loss 0.9720 (0.9487) lr 1.6845e-03 eta 0:25:57
epoch [15/50] batch [360/428] time 0.109 (0.103) data 0.000 (0.006) loss 2.6279 (2.6143) ce_loss 1.3125 (1.2118) loss_zs_kd 0.4610 (0.4718) loss_oracle 0.3027 (0.4355) acc 53.1250 (57.9080) kd_loss 0.9336 (0.9488) lr 1.6845e-03 eta 0:25:55
epoch [15/50] batch [380/428] time 0.104 (0.103) data 0.000 (0.006) loss 2.7481 (2.6131) ce_loss 1.3848 (1.2112) loss_zs_kd 0.4720 (0.4719) loss_oracle 0.3689 (0.4335) acc 46.8750 (57.8947) kd_loss 0.9429 (0.9491) lr 1.6845e-03 eta 0:25:50
epoch [15/50] batch [400/428] time 0.084 (0.103) data 0.000 (0.005) loss 2.6709 (2.6125) ce_loss 1.2842 (1.2112) loss_zs_kd 0.4771 (0.4704) loss_oracle 0.3887 (0.4332) acc 50.0000 (57.8750) kd_loss 0.9538 (0.9494) lr 1.6845e-03 eta 0:25:41
epoch [15/50] batch [420/428] time 0.097 (0.102) data 0.000 (0.005) loss 2.4807 (2.6123) ce_loss 1.1553 (1.2112) loss_zs_kd 0.3434 (0.4673) loss_oracle 0.4414 (0.4339) acc 56.2500 (57.7381) kd_loss 0.9330 (0.9506) lr 1.6845e-03 eta 0:25:33
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,370
* accuracy: 57.4%
* error: 42.6%
* macro_f1: 43.5%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,306
* accuracy: 48.6%
* error: 51.4%
* macro_f1: 29.7%
******* Domain 1 best val acc:      60.4%, epoch: 13 *******
******* Domain 1 best val test acc: 54.8%, epoch: 13 *******
******* Domain 1 best test acc:     56.0%, epoch: 14 *******
epoch [16/50] batch [20/428] time 0.108 (0.181) data 0.000 (0.077) loss 3.0700 (2.6543) ce_loss 1.5654 (1.2196) loss_zs_kd 0.5282 (0.4680) loss_oracle 0.4759 (0.4564) acc 34.3750 (57.9688) kd_loss 1.0025 (0.9724) lr 1.6374e-03 eta 0:45:14
epoch [16/50] batch [40/428] time 0.111 (0.144) data 0.000 (0.039) loss 2.7003 (2.6610) ce_loss 1.3018 (1.2228) loss_zs_kd 0.4259 (0.4734) loss_oracle 0.3827 (0.4438) acc 50.0000 (57.1875) kd_loss 0.9942 (0.9796) lr 1.6374e-03 eta 0:35:44
epoch [16/50] batch [60/428] time 0.102 (0.130) data 0.000 (0.026) loss 2.8737 (2.6687) ce_loss 1.4609 (1.2360) loss_zs_kd 0.4502 (0.4646) loss_oracle 0.3815 (0.4461) acc 37.5000 (56.6146) kd_loss 0.9969 (0.9773) lr 1.6374e-03 eta 0:32:23
epoch [16/50] batch [80/428] time 0.077 (0.118) data 0.000 (0.019) loss 2.5135 (2.6563) ce_loss 1.1367 (1.2228) loss_zs_kd 0.3395 (0.4724) loss_oracle 0.3899 (0.4351) acc 56.2500 (57.3047) kd_loss 1.0121 (0.9797) lr 1.6374e-03 eta 0:29:21
epoch [16/50] batch [100/428] time 0.155 (0.119) data 0.000 (0.016) loss 2.9275 (2.6505) ce_loss 1.3848 (1.2188) loss_zs_kd 0.6207 (0.4692) loss_oracle 0.4599 (0.4330) acc 62.5000 (57.7812) kd_loss 1.0024 (0.9806) lr 1.6374e-03 eta 0:29:33
epoch [16/50] batch [120/428] time 0.084 (0.116) data 0.000 (0.013) loss 2.5911 (2.6523) ce_loss 1.1914 (1.2203) loss_zs_kd 0.4376 (0.4701) loss_oracle 0.3869 (0.4313) acc 59.3750 (57.8385) kd_loss 0.9875 (0.9812) lr 1.6374e-03 eta 0:28:44
epoch [16/50] batch [140/428] time 0.159 (0.115) data 0.000 (0.011) loss 2.4410 (2.6394) ce_loss 1.0615 (1.2100) loss_zs_kd 0.5477 (0.4683) loss_oracle 0.3559 (0.4278) acc 65.6250 (58.1920) kd_loss 0.9277 (0.9813) lr 1.6374e-03 eta 0:28:28
epoch [16/50] batch [160/428] time 0.092 (0.113) data 0.000 (0.010) loss 2.6194 (2.6336) ce_loss 1.1602 (1.2037) loss_zs_kd 0.4786 (0.4741) loss_oracle 0.4967 (0.4254) acc 59.3750 (58.6914) kd_loss 0.9716 (0.9801) lr 1.6374e-03 eta 0:28:01
epoch [16/50] batch [180/428] time 0.101 (0.111) data 0.000 (0.009) loss 2.5152 (2.6328) ce_loss 1.1113 (1.2058) loss_zs_kd 0.4536 (0.4708) loss_oracle 0.3692 (0.4229) acc 62.5000 (58.7847) kd_loss 0.9925 (0.9801) lr 1.6374e-03 eta 0:27:20
epoch [16/50] batch [200/428] time 0.098 (0.110) data 0.000 (0.008) loss 2.3618 (2.6372) ce_loss 0.8706 (1.2106) loss_zs_kd 0.5470 (0.4739) loss_oracle 0.4978 (0.4249) acc 65.6250 (58.5781) kd_loss 0.9687 (0.9772) lr 1.6374e-03 eta 0:27:05
epoch [16/50] batch [220/428] time 0.095 (0.109) data 0.000 (0.007) loss 2.5160 (2.6365) ce_loss 1.0488 (1.2116) loss_zs_kd 0.4618 (0.4731) loss_oracle 0.4409 (0.4279) acc 65.6250 (58.6222) kd_loss 1.0158 (0.9744) lr 1.6374e-03 eta 0:26:51
epoch [16/50] batch [240/428] time 0.099 (0.109) data 0.000 (0.007) loss 2.6840 (2.6336) ce_loss 1.1973 (1.2099) loss_zs_kd 0.4769 (0.4722) loss_oracle 0.5155 (0.4321) acc 53.1250 (58.6979) kd_loss 0.9905 (0.9716) lr 1.6374e-03 eta 0:26:40
epoch [16/50] batch [260/428] time 0.097 (0.108) data 0.000 (0.006) loss 2.8033 (2.6342) ce_loss 1.4287 (1.2107) loss_zs_kd 0.3981 (0.4742) loss_oracle 0.5048 (0.4356) acc 43.7500 (58.6298) kd_loss 0.9232 (0.9687) lr 1.6374e-03 eta 0:26:32
epoch [16/50] batch [280/428] time 0.107 (0.108) data 0.000 (0.006) loss 2.7819 (2.6346) ce_loss 1.4629 (1.2129) loss_zs_kd 0.4625 (0.4739) loss_oracle 0.3983 (0.4388) acc 37.5000 (58.4152) kd_loss 0.8886 (0.9653) lr 1.6374e-03 eta 0:26:23
epoch [16/50] batch [300/428] time 0.093 (0.107) data 0.000 (0.005) loss 2.6888 (2.6334) ce_loss 1.2568 (1.2126) loss_zs_kd 0.4267 (0.4737) loss_oracle 0.4265 (0.4404) acc 65.6250 (58.5208) kd_loss 1.0054 (0.9638) lr 1.6374e-03 eta 0:26:16
epoch [16/50] batch [320/428] time 0.108 (0.107) data 0.000 (0.005) loss 2.6374 (2.6318) ce_loss 1.2715 (1.2147) loss_zs_kd 0.4460 (0.4722) loss_oracle 0.4190 (0.4402) acc 53.1250 (58.2520) kd_loss 0.9335 (0.9610) lr 1.6374e-03 eta 0:26:08
epoch [16/50] batch [340/428] time 0.098 (0.107) data 0.000 (0.005) loss 2.6315 (2.6303) ce_loss 1.1641 (1.2135) loss_zs_kd 0.4713 (0.4715) loss_oracle 0.4445 (0.4416) acc 56.2500 (58.1434) kd_loss 1.0096 (0.9603) lr 1.6374e-03 eta 0:26:00
epoch [16/50] batch [360/428] time 0.083 (0.105) data 0.000 (0.005) loss 2.6279 (2.6261) ce_loss 1.2803 (1.2125) loss_zs_kd 0.4794 (0.4691) loss_oracle 0.4465 (0.4415) acc 56.2500 (58.1424) kd_loss 0.8847 (0.9582) lr 1.6374e-03 eta 0:25:40
epoch [16/50] batch [380/428] time 0.077 (0.104) data 0.000 (0.004) loss 2.5256 (2.6266) ce_loss 1.1152 (1.2131) loss_zs_kd 0.4883 (0.4687) loss_oracle 0.4545 (0.4418) acc 65.6250 (57.9934) kd_loss 0.9389 (0.9582) lr 1.6374e-03 eta 0:25:18
epoch [16/50] batch [400/428] time 0.086 (0.105) data 0.000 (0.004) loss 2.4976 (2.6253) ce_loss 1.1895 (1.2130) loss_zs_kd 0.4081 (0.4679) loss_oracle 0.4758 (0.4419) acc 53.1250 (57.9375) kd_loss 0.8662 (0.9574) lr 1.6374e-03 eta 0:25:37
epoch [16/50] batch [420/428] time 0.077 (0.104) data 0.000 (0.004) loss 2.5696 (2.6257) ce_loss 1.1631 (1.2146) loss_zs_kd 0.5098 (0.4667) loss_oracle 0.4324 (0.4430) acc 68.7500 (57.8274) kd_loss 0.9355 (0.9563) lr 1.6374e-03 eta 0:25:19
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,554
* accuracy: 60.5%
* error: 39.5%
* macro_f1: 47.4%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,576
* accuracy: 54.3%
* error: 45.7%
* macro_f1: 32.9%
******* Domain 1 best val acc:      60.5%, epoch: 16 *******
******* Domain 1 best val test acc: 54.3%, epoch: 16 *******
******* Domain 1 best test acc:     56.0%, epoch: 14 *******
epoch [17/50] batch [20/428] time 0.077 (0.202) data 0.000 (0.099) loss 2.6115 (2.5971) ce_loss 1.1270 (1.1690) loss_zs_kd 0.4815 (0.4667) loss_oracle 0.4843 (0.4924) acc 65.6250 (57.5000) kd_loss 1.0017 (0.9485) lr 1.5878e-03 eta 0:48:58
epoch [17/50] batch [40/428] time 0.081 (0.140) data 0.000 (0.049) loss 2.6755 (2.6122) ce_loss 1.2070 (1.1874) loss_zs_kd 0.4450 (0.4684) loss_oracle 0.5224 (0.4902) acc 56.2500 (57.8906) kd_loss 0.9848 (0.9455) lr 1.5878e-03 eta 0:33:44
epoch [17/50] batch [60/428] time 0.093 (0.135) data 0.000 (0.033) loss 2.4892 (2.5961) ce_loss 1.1211 (1.1792) loss_zs_kd 0.4215 (0.4627) loss_oracle 0.4535 (0.4869) acc 56.2500 (59.0625) kd_loss 0.9306 (0.9421) lr 1.5878e-03 eta 0:32:29
epoch [17/50] batch [80/428] time 0.088 (0.122) data 0.000 (0.025) loss 2.6158 (2.5927) ce_loss 1.2969 (1.1829) loss_zs_kd 0.4106 (0.4649) loss_oracle 0.4582 (0.4842) acc 43.7500 (58.8281) kd_loss 0.8845 (0.9353) lr 1.5878e-03 eta 0:29:19
epoch [17/50] batch [100/428] time 0.100 (0.117) data 0.000 (0.020) loss 2.5430 (2.5920) ce_loss 1.0518 (1.1796) loss_zs_kd 0.5419 (0.4702) loss_oracle 0.4983 (0.4836) acc 62.5000 (59.3125) kd_loss 0.9711 (0.9356) lr 1.5878e-03 eta 0:28:13
epoch [17/50] batch [120/428] time 0.104 (0.115) data 0.000 (0.017) loss 2.8430 (2.6011) ce_loss 1.3027 (1.1900) loss_zs_kd 0.5800 (0.4690) loss_oracle 0.5024 (0.4851) acc 50.0000 (58.7760) kd_loss 0.9991 (0.9341) lr 1.5878e-03 eta 0:27:40
epoch [17/50] batch [140/428] time 0.106 (0.113) data 0.000 (0.014) loss 2.6749 (2.6008) ce_loss 1.2344 (1.1868) loss_zs_kd 0.4911 (0.4659) loss_oracle 0.5437 (0.4927) acc 53.1250 (58.7500) kd_loss 0.9231 (0.9347) lr 1.5878e-03 eta 0:27:07
epoch [17/50] batch [160/428] time 0.092 (0.112) data 0.000 (0.013) loss 2.9641 (2.6071) ce_loss 1.5293 (1.1918) loss_zs_kd 0.5218 (0.4652) loss_oracle 0.4448 (0.4921) acc 46.8750 (58.2227) kd_loss 0.9515 (0.9366) lr 1.5878e-03 eta 0:26:48
epoch [17/50] batch [180/428] time 0.102 (0.111) data 0.000 (0.011) loss 2.6889 (2.6156) ce_loss 1.3311 (1.2000) loss_zs_kd 0.3975 (0.4676) loss_oracle 0.4397 (0.4860) acc 56.2500 (57.8993) kd_loss 0.9393 (0.9388) lr 1.5878e-03 eta 0:26:30
epoch [17/50] batch [200/428] time 0.098 (0.110) data 0.000 (0.010) loss 2.2777 (2.6109) ce_loss 0.9355 (1.1979) loss_zs_kd 0.4632 (0.4692) loss_oracle 0.4099 (0.4799) acc 68.7500 (58.0156) kd_loss 0.9056 (0.9384) lr 1.5878e-03 eta 0:26:16
epoch [17/50] batch [220/428] time 0.101 (0.109) data 0.000 (0.009) loss 2.6296 (2.6074) ce_loss 1.2246 (1.1956) loss_zs_kd 0.5399 (0.4718) loss_oracle 0.3955 (0.4744) acc 59.3750 (58.1250) kd_loss 0.9373 (0.9387) lr 1.5878e-03 eta 0:26:04
epoch [17/50] batch [240/428] time 0.095 (0.109) data 0.000 (0.008) loss 2.5187 (2.6081) ce_loss 1.1396 (1.2005) loss_zs_kd 0.4925 (0.4688) loss_oracle 0.3900 (0.4695) acc 56.2500 (57.9036) kd_loss 0.9378 (0.9384) lr 1.5878e-03 eta 0:25:56
epoch [17/50] batch [260/428] time 0.084 (0.108) data 0.000 (0.008) loss 2.6451 (2.6076) ce_loss 1.2500 (1.2034) loss_zs_kd 0.4788 (0.4692) loss_oracle 0.4405 (0.4653) acc 53.1250 (57.7284) kd_loss 0.9355 (0.9369) lr 1.5878e-03 eta 0:25:36
epoch [17/50] batch [280/428] time 0.092 (0.106) data 0.000 (0.007) loss 2.6260 (2.6071) ce_loss 1.1191 (1.2040) loss_zs_kd 0.5546 (0.4699) loss_oracle 0.5904 (0.4651) acc 53.1250 (57.6897) kd_loss 0.9344 (0.9356) lr 1.5878e-03 eta 0:25:10
epoch [17/50] batch [300/428] time 0.073 (0.108) data 0.000 (0.007) loss 2.5647 (2.6079) ce_loss 1.1094 (1.2031) loss_zs_kd 0.6565 (0.4725) loss_oracle 0.4501 (0.4665) acc 46.8750 (57.6667) kd_loss 0.9021 (0.9353) lr 1.5878e-03 eta 0:25:34
epoch [17/50] batch [320/428] time 0.080 (0.106) data 0.000 (0.006) loss 2.8164 (2.6059) ce_loss 1.4482 (1.2001) loss_zs_kd 0.5322 (0.4728) loss_oracle 0.5234 (0.4676) acc 50.0000 (57.8223) kd_loss 0.8404 (0.9357) lr 1.5878e-03 eta 0:25:07
epoch [17/50] batch [340/428] time 0.180 (0.107) data 0.000 (0.006) loss 2.3674 (2.6055) ce_loss 1.0283 (1.2015) loss_zs_kd 0.4938 (0.4718) loss_oracle 0.4131 (0.4676) acc 62.5000 (57.7114) kd_loss 0.8856 (0.9343) lr 1.5878e-03 eta 0:25:15
epoch [17/50] batch [360/428] time 0.076 (0.106) data 0.000 (0.006) loss 2.6284 (2.6082) ce_loss 1.2441 (1.2052) loss_zs_kd 0.4227 (0.4715) loss_oracle 0.4076 (0.4659) acc 50.0000 (57.5955) kd_loss 0.9691 (0.9343) lr 1.5878e-03 eta 0:25:01
epoch [17/50] batch [380/428] time 0.107 (0.105) data 0.000 (0.005) loss 2.4073 (2.6070) ce_loss 1.0049 (1.2050) loss_zs_kd 0.5078 (0.4710) loss_oracle 0.5578 (0.4640) acc 71.8750 (57.6727) kd_loss 0.8697 (0.9345) lr 1.5878e-03 eta 0:24:45
epoch [17/50] batch [400/428] time 0.091 (0.105) data 0.000 (0.005) loss 2.6118 (2.6076) ce_loss 1.1807 (1.2063) loss_zs_kd 0.4982 (0.4703) loss_oracle 0.5423 (0.4634) acc 65.6250 (57.6562) kd_loss 0.9110 (0.9345) lr 1.5878e-03 eta 0:24:43
epoch [17/50] batch [420/428] time 0.098 (0.105) data 0.000 (0.005) loss 2.4434 (2.6100) ce_loss 1.0166 (1.2081) loss_zs_kd 0.4966 (0.4706) loss_oracle 0.4858 (0.4640) acc 75.0000 (57.6562) kd_loss 0.9356 (0.9345) lr 1.5878e-03 eta 0:24:37
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,515
* accuracy: 59.8%
* error: 40.2%
* macro_f1: 47.4%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,650
* accuracy: 55.9%
* error: 44.1%
* macro_f1: 33.7%
******* Domain 1 best val acc:      60.5%, epoch: 16 *******
******* Domain 1 best val test acc: 54.3%, epoch: 16 *******
******* Domain 1 best test acc:     56.0%, epoch: 14 *******
epoch [18/50] batch [20/428] time 0.097 (0.218) data 0.000 (0.108) loss 2.4501 (2.5089) ce_loss 1.1426 (1.1027) loss_zs_kd 0.3671 (0.5017) loss_oracle 0.4724 (0.4528) acc 56.2500 (61.2500) kd_loss 0.8878 (0.9290) lr 1.5358e-03 eta 0:51:10
epoch [18/50] batch [40/428] time 0.100 (0.161) data 0.000 (0.054) loss 2.5033 (2.5648) ce_loss 1.0068 (1.1607) loss_zs_kd 0.4631 (0.4833) loss_oracle 0.5557 (0.4772) acc 68.7500 (60.0781) kd_loss 0.9870 (0.9239) lr 1.5358e-03 eta 0:37:44
epoch [18/50] batch [60/428] time 0.114 (0.141) data 0.000 (0.036) loss 2.9137 (2.5793) ce_loss 1.4746 (1.1599) loss_zs_kd 0.5372 (0.4926) loss_oracle 0.3874 (0.4768) acc 43.7500 (60.4167) kd_loss 0.9768 (0.9348) lr 1.5358e-03 eta 0:32:56
epoch [18/50] batch [80/428] time 0.103 (0.129) data 0.000 (0.027) loss 2.8910 (2.5983) ce_loss 1.5752 (1.1831) loss_zs_kd 0.3802 (0.4910) loss_oracle 0.4047 (0.4691) acc 43.7500 (59.5312) kd_loss 0.9233 (0.9352) lr 1.5358e-03 eta 0:30:17
epoch [18/50] batch [100/428] time 0.104 (0.124) data 0.000 (0.022) loss 2.2897 (2.5931) ce_loss 0.8662 (1.1918) loss_zs_kd 0.4591 (0.4782) loss_oracle 0.4067 (0.4616) acc 75.0000 (58.7812) kd_loss 0.9906 (0.9315) lr 1.5358e-03 eta 0:29:00
epoch [18/50] batch [120/428] time 0.106 (0.121) data 0.000 (0.018) loss 2.5342 (2.5892) ce_loss 1.2568 (1.1961) loss_zs_kd 0.4216 (0.4735) loss_oracle 0.4139 (0.4542) acc 56.2500 (58.4635) kd_loss 0.8597 (0.9292) lr 1.5358e-03 eta 0:28:10
epoch [18/50] batch [140/428] time 0.107 (0.118) data 0.000 (0.016) loss 2.3773 (2.5892) ce_loss 1.0293 (1.1994) loss_zs_kd 0.4203 (0.4724) loss_oracle 0.4730 (0.4527) acc 56.2500 (58.0134) kd_loss 0.9014 (0.9272) lr 1.5358e-03 eta 0:27:35
epoch [18/50] batch [160/428] time 0.080 (0.115) data 0.000 (0.014) loss 2.6101 (2.5842) ce_loss 1.2637 (1.1976) loss_zs_kd 0.4358 (0.4713) loss_oracle 0.4671 (0.4478) acc 53.1250 (58.3984) kd_loss 0.8950 (0.9270) lr 1.5358e-03 eta 0:26:49
epoch [18/50] batch [180/428] time 0.071 (0.112) data 0.000 (0.012) loss 2.5971 (2.5779) ce_loss 1.3506 (1.1975) loss_zs_kd 0.4411 (0.4689) loss_oracle 0.3420 (0.4407) acc 50.0000 (58.2812) kd_loss 0.8550 (0.9256) lr 1.5358e-03 eta 0:25:57
epoch [18/50] batch [200/428] time 0.196 (0.112) data 0.000 (0.011) loss 2.2580 (2.5691) ce_loss 0.9565 (1.1936) loss_zs_kd 0.3859 (0.4651) loss_oracle 0.4059 (0.4357) acc 65.6250 (58.3750) kd_loss 0.9055 (0.9250) lr 1.5358e-03 eta 0:26:03
epoch [18/50] batch [220/428] time 0.079 (0.110) data 0.000 (0.010) loss 2.6720 (2.5723) ce_loss 1.2510 (1.1980) loss_zs_kd 0.5271 (0.4683) loss_oracle 0.3757 (0.4326) acc 59.3750 (58.2528) kd_loss 0.9696 (0.9239) lr 1.5358e-03 eta 0:25:32
epoch [18/50] batch [240/428] time 0.159 (0.109) data 0.000 (0.009) loss 2.4574 (2.5738) ce_loss 1.1621 (1.2026) loss_zs_kd 0.3505 (0.4694) loss_oracle 0.3900 (0.4284) acc 62.5000 (57.9948) kd_loss 0.9250 (0.9224) lr 1.5358e-03 eta 0:25:12
epoch [18/50] batch [260/428] time 0.085 (0.109) data 0.000 (0.009) loss 2.9613 (2.5718) ce_loss 1.6309 (1.2025) loss_zs_kd 0.4522 (0.4698) loss_oracle 0.3797 (0.4249) acc 53.1250 (58.1611) kd_loss 0.9145 (0.9219) lr 1.5358e-03 eta 0:25:11
epoch [18/50] batch [280/428] time 0.101 (0.107) data 0.000 (0.008) loss 2.4273 (2.5696) ce_loss 1.0391 (1.1992) loss_zs_kd 0.4845 (0.4692) loss_oracle 0.4837 (0.4235) acc 59.3750 (58.2031) kd_loss 0.9042 (0.9240) lr 1.5358e-03 eta 0:24:45
epoch [18/50] batch [300/428] time 0.108 (0.107) data 0.000 (0.007) loss 2.5606 (2.5732) ce_loss 1.0986 (1.2009) loss_zs_kd 0.5344 (0.4714) loss_oracle 0.4338 (0.4238) acc 62.5000 (58.0625) kd_loss 0.9778 (0.9246) lr 1.5358e-03 eta 0:24:37
epoch [18/50] batch [320/428] time 0.091 (0.107) data 0.000 (0.007) loss 2.6701 (2.5769) ce_loss 1.2676 (1.2020) loss_zs_kd 0.4089 (0.4728) loss_oracle 0.4737 (0.4238) acc 68.7500 (58.0566) kd_loss 0.9612 (0.9265) lr 1.5358e-03 eta 0:24:32
epoch [18/50] batch [340/428] time 0.092 (0.106) data 0.000 (0.007) loss 2.5270 (2.5813) ce_loss 1.1221 (1.2039) loss_zs_kd 0.4808 (0.4733) loss_oracle 0.4598 (0.4252) acc 50.0000 (57.9596) kd_loss 0.9346 (0.9281) lr 1.5358e-03 eta 0:24:26
epoch [18/50] batch [360/428] time 0.093 (0.106) data 0.000 (0.006) loss 2.5985 (2.5826) ce_loss 1.2012 (1.2039) loss_zs_kd 0.4111 (0.4725) loss_oracle 0.5360 (0.4266) acc 56.2500 (58.0208) kd_loss 0.9238 (0.9292) lr 1.5358e-03 eta 0:24:20
epoch [18/50] batch [380/428] time 0.109 (0.106) data 0.000 (0.006) loss 2.8959 (2.5863) ce_loss 1.4062 (1.2049) loss_zs_kd 0.4545 (0.4720) loss_oracle 0.4344 (0.4292) acc 43.7500 (58.0345) kd_loss 1.0452 (0.9308) lr 1.5358e-03 eta 0:24:15
epoch [18/50] batch [400/428] time 0.098 (0.106) data 0.000 (0.006) loss 2.4854 (2.5877) ce_loss 1.0645 (1.2045) loss_zs_kd 0.4466 (0.4708) loss_oracle 0.4682 (0.4317) acc 75.0000 (58.0859) kd_loss 0.9635 (0.9319) lr 1.5358e-03 eta 0:24:10
epoch [18/50] batch [420/428] time 0.100 (0.105) data 0.000 (0.005) loss 2.8312 (2.5902) ce_loss 1.3525 (1.2041) loss_zs_kd 0.4657 (0.4711) loss_oracle 0.5623 (0.4337) acc 53.1250 (58.2217) kd_loss 0.9646 (0.9337) lr 1.5358e-03 eta 0:24:04
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,514
* accuracy: 59.8%
* error: 40.2%
* macro_f1: 47.8%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,606
* accuracy: 55.0%
* error: 45.0%
* macro_f1: 32.4%
******* Domain 1 best val acc:      60.5%, epoch: 16 *******
******* Domain 1 best val test acc: 54.3%, epoch: 16 *******
******* Domain 1 best test acc:     56.0%, epoch: 14 *******
epoch [19/50] batch [20/428] time 0.102 (0.223) data 0.000 (0.123) loss 2.4456 (2.5993) ce_loss 0.9741 (1.1818) loss_zs_kd 0.5710 (0.5036) loss_oracle 0.4435 (0.4638) acc 75.0000 (60.7812) kd_loss 0.9642 (0.9338) lr 1.4818e-03 eta 0:50:44
epoch [19/50] batch [40/428] time 0.111 (0.163) data 0.000 (0.062) loss 2.5708 (2.6247) ce_loss 1.1455 (1.2110) loss_zs_kd 0.4043 (0.4856) loss_oracle 0.4663 (0.4625) acc 65.6250 (58.5156) kd_loss 0.9900 (0.9396) lr 1.4818e-03 eta 0:36:59
epoch [19/50] batch [60/428] time 0.090 (0.142) data 0.000 (0.041) loss 2.4796 (2.6379) ce_loss 1.1309 (1.2234) loss_zs_kd 0.4489 (0.4834) loss_oracle 0.4186 (0.4678) acc 65.6250 (57.1875) kd_loss 0.9150 (0.9388) lr 1.4818e-03 eta 0:32:20
epoch [19/50] batch [80/428] time 0.080 (0.129) data 0.000 (0.031) loss 2.5397 (2.6160) ce_loss 1.0977 (1.2035) loss_zs_kd 0.4963 (0.4819) loss_oracle 0.4341 (0.4606) acc 62.5000 (57.6172) kd_loss 0.9768 (0.9412) lr 1.4818e-03 eta 0:29:14
epoch [19/50] batch [100/428] time 0.065 (0.119) data 0.000 (0.025) loss 2.5502 (2.6061) ce_loss 1.1035 (1.1991) loss_zs_kd 0.4924 (0.4853) loss_oracle 0.5090 (0.4580) acc 56.2500 (57.9062) kd_loss 0.9460 (0.9353) lr 1.4818e-03 eta 0:26:59
epoch [19/50] batch [120/428] time 0.078 (0.121) data 0.000 (0.021) loss 2.7309 (2.5960) ce_loss 1.2334 (1.1900) loss_zs_kd 0.5821 (0.4855) loss_oracle 0.4263 (0.4578) acc 46.8750 (58.4635) kd_loss 0.9934 (0.9344) lr 1.4818e-03 eta 0:27:20
epoch [19/50] batch [140/428] time 0.090 (0.115) data 0.000 (0.018) loss 2.3446 (2.5951) ce_loss 0.9897 (1.1912) loss_zs_kd 0.4149 (0.4863) loss_oracle 0.4014 (0.4574) acc 78.1250 (58.8839) kd_loss 0.9467 (0.9320) lr 1.4818e-03 eta 0:26:01
epoch [19/50] batch [160/428] time 0.098 (0.117) data 0.000 (0.016) loss 2.8572 (2.5990) ce_loss 1.4355 (1.1957) loss_zs_kd 0.4442 (0.4804) loss_oracle 0.4694 (0.4597) acc 43.7500 (58.7305) kd_loss 0.9649 (0.9333) lr 1.4818e-03 eta 0:26:17
epoch [19/50] batch [180/428] time 0.091 (0.113) data 0.000 (0.014) loss 2.4344 (2.5983) ce_loss 1.0293 (1.1927) loss_zs_kd 0.4736 (0.4802) loss_oracle 0.5180 (0.4608) acc 68.7500 (58.5243) kd_loss 0.9093 (0.9350) lr 1.4818e-03 eta 0:25:26
epoch [19/50] batch [200/428] time 0.098 (0.111) data 0.000 (0.013) loss 2.4829 (2.6015) ce_loss 0.9736 (1.1957) loss_zs_kd 0.5391 (0.4784) loss_oracle 0.4596 (0.4586) acc 65.6250 (58.6719) kd_loss 1.0099 (0.9373) lr 1.4818e-03 eta 0:24:53
epoch [19/50] batch [220/428] time 0.120 (0.110) data 0.000 (0.011) loss 2.4571 (2.6055) ce_loss 1.0391 (1.1998) loss_zs_kd 0.5033 (0.4764) loss_oracle 0.4401 (0.4579) acc 68.7500 (58.6790) kd_loss 0.9463 (0.9385) lr 1.4818e-03 eta 0:24:39
epoch [19/50] batch [240/428] time 0.098 (0.109) data 0.000 (0.011) loss 2.5366 (2.6024) ce_loss 1.1807 (1.1966) loss_zs_kd 0.4855 (0.4761) loss_oracle 0.3230 (0.4554) acc 56.2500 (58.6979) kd_loss 0.9517 (0.9400) lr 1.4818e-03 eta 0:24:26
epoch [19/50] batch [260/428] time 0.100 (0.109) data 0.000 (0.010) loss 2.7917 (2.6014) ce_loss 1.3096 (1.1965) loss_zs_kd 0.4620 (0.4725) loss_oracle 0.4877 (0.4564) acc 53.1250 (58.5216) kd_loss 1.0073 (0.9405) lr 1.4818e-03 eta 0:24:18
epoch [19/50] batch [280/428] time 0.097 (0.108) data 0.000 (0.009) loss 2.7522 (2.6020) ce_loss 1.2461 (1.1957) loss_zs_kd 0.5251 (0.4723) loss_oracle 0.5265 (0.4587) acc 46.8750 (58.4375) kd_loss 0.9803 (0.9408) lr 1.4818e-03 eta 0:24:08
epoch [19/50] batch [300/428] time 0.110 (0.108) data 0.000 (0.008) loss 2.4107 (2.6061) ce_loss 1.0117 (1.1991) loss_zs_kd 0.4037 (0.4716) loss_oracle 0.4890 (0.4620) acc 68.7500 (58.3958) kd_loss 0.9527 (0.9401) lr 1.4818e-03 eta 0:24:02
epoch [19/50] batch [320/428] time 0.099 (0.108) data 0.000 (0.008) loss 2.5422 (2.6084) ce_loss 1.0967 (1.2005) loss_zs_kd 0.4914 (0.4717) loss_oracle 0.4149 (0.4639) acc 71.8750 (58.4180) kd_loss 0.9924 (0.9400) lr 1.4818e-03 eta 0:23:59
epoch [19/50] batch [340/428] time 0.096 (0.107) data 0.000 (0.007) loss 2.8706 (2.6093) ce_loss 1.4541 (1.2001) loss_zs_kd 0.5090 (0.4709) loss_oracle 0.4660 (0.4672) acc 43.7500 (58.4559) kd_loss 0.9289 (0.9402) lr 1.4818e-03 eta 0:23:51
epoch [19/50] batch [360/428] time 0.099 (0.107) data 0.000 (0.007) loss 2.6308 (2.6115) ce_loss 1.2002 (1.2007) loss_zs_kd 0.3993 (0.4713) loss_oracle 0.5239 (0.4707) acc 50.0000 (58.3247) kd_loss 0.9690 (0.9397) lr 1.4818e-03 eta 0:23:43
epoch [19/50] batch [380/428] time 0.087 (0.106) data 0.000 (0.007) loss 2.6461 (2.6108) ce_loss 1.2773 (1.2009) loss_zs_kd 0.5230 (0.4708) loss_oracle 0.4291 (0.4708) acc 59.3750 (58.3224) kd_loss 0.8928 (0.9390) lr 1.4818e-03 eta 0:23:25
epoch [19/50] batch [400/428] time 0.181 (0.105) data 0.000 (0.006) loss 2.5691 (2.6101) ce_loss 1.1006 (1.2015) loss_zs_kd 0.4555 (0.4692) loss_oracle 0.4803 (0.4707) acc 62.5000 (58.2266) kd_loss 1.0006 (0.9387) lr 1.4818e-03 eta 0:23:18
epoch [19/50] batch [420/428] time 0.070 (0.106) data 0.000 (0.006) loss 2.5193 (2.6085) ce_loss 1.2051 (1.2015) loss_zs_kd 0.4068 (0.4688) loss_oracle 0.5056 (0.4710) acc 59.3750 (58.1845) kd_loss 0.8581 (0.9372) lr 1.4818e-03 eta 0:23:20
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,412
* accuracy: 58.1%
* error: 41.9%
* macro_f1: 46.0%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,724
* accuracy: 57.5%
* error: 42.5%
* macro_f1: 32.5%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 1 best val acc:      60.5%, epoch: 16 *******
******* Domain 1 best val test acc: 54.3%, epoch: 16 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [20/50] batch [20/428] time 0.086 (0.232) data 0.000 (0.130) loss 2.4915 (2.5815) ce_loss 1.0537 (1.1555) loss_zs_kd 0.3563 (0.4472) loss_oracle 0.4752 (0.5278) acc 65.6250 (61.5625) kd_loss 1.0221 (0.9385) lr 1.4258e-03 eta 0:51:14
epoch [20/50] batch [40/428] time 0.159 (0.166) data 0.000 (0.065) loss 2.6577 (2.5829) ce_loss 1.2041 (1.1664) loss_zs_kd 0.4849 (0.4447) loss_oracle 0.5438 (0.5131) acc 46.8750 (59.5312) kd_loss 0.9393 (0.9376) lr 1.4258e-03 eta 0:36:32
epoch [20/50] batch [60/428] time 0.076 (0.147) data 0.000 (0.043) loss 2.2747 (2.5908) ce_loss 0.7974 (1.1589) loss_zs_kd 0.4989 (0.4662) loss_oracle 0.5815 (0.5069) acc 81.2500 (59.8438) kd_loss 0.9371 (0.9452) lr 1.4258e-03 eta 0:32:20
epoch [20/50] batch [80/428] time 0.092 (0.132) data 0.000 (0.033) loss 2.6335 (2.5926) ce_loss 1.3447 (1.1645) loss_zs_kd 0.5046 (0.4698) loss_oracle 0.4341 (0.4972) acc 50.0000 (60.1172) kd_loss 0.8194 (0.9446) lr 1.4258e-03 eta 0:29:02
epoch [20/50] batch [100/428] time 0.090 (0.125) data 0.000 (0.026) loss 2.6997 (2.6020) ce_loss 1.2812 (1.1762) loss_zs_kd 0.5094 (0.4696) loss_oracle 0.4705 (0.4939) acc 59.3750 (59.4688) kd_loss 0.9285 (0.9440) lr 1.4258e-03 eta 0:27:30
epoch [20/50] batch [120/428] time 0.117 (0.121) data 0.000 (0.022) loss 2.4318 (2.6071) ce_loss 1.0068 (1.1764) loss_zs_kd 0.4569 (0.4714) loss_oracle 0.4694 (0.4947) acc 65.6250 (59.8958) kd_loss 0.9619 (0.9477) lr 1.4258e-03 eta 0:26:31
epoch [20/50] batch [140/428] time 0.104 (0.119) data 0.000 (0.019) loss 2.6693 (2.6110) ce_loss 1.1738 (1.1799) loss_zs_kd 0.5776 (0.4721) loss_oracle 0.5158 (0.4935) acc 75.0000 (59.6652) kd_loss 0.9488 (0.9483) lr 1.4258e-03 eta 0:25:58
epoch [20/50] batch [160/428] time 0.101 (0.117) data 0.000 (0.016) loss 2.6179 (2.6002) ce_loss 1.1377 (1.1713) loss_zs_kd 0.5531 (0.4720) loss_oracle 0.4968 (0.4918) acc 59.3750 (59.6094) kd_loss 0.9553 (0.9470) lr 1.4258e-03 eta 0:25:28
epoch [20/50] batch [180/428] time 0.098 (0.115) data 0.000 (0.015) loss 2.7485 (2.6085) ce_loss 1.3857 (1.1815) loss_zs_kd 0.4486 (0.4694) loss_oracle 0.4388 (0.4898) acc 43.7500 (58.9757) kd_loss 0.9190 (0.9475) lr 1.4258e-03 eta 0:25:06
epoch [20/50] batch [200/428] time 0.087 (0.114) data 0.000 (0.013) loss 2.5637 (2.6094) ce_loss 1.2441 (1.1837) loss_zs_kd 0.3441 (0.4679) loss_oracle 0.4597 (0.4889) acc 53.1250 (58.7812) kd_loss 0.9176 (0.9473) lr 1.4258e-03 eta 0:24:44
epoch [20/50] batch [220/428] time 0.106 (0.113) data 0.000 (0.012) loss 2.5855 (2.6108) ce_loss 1.1055 (1.1847) loss_zs_kd 0.5739 (0.4692) loss_oracle 0.4948 (0.4886) acc 59.3750 (58.9489) kd_loss 0.9456 (0.9472) lr 1.4258e-03 eta 0:24:29
epoch [20/50] batch [240/428] time 0.098 (0.112) data 0.000 (0.011) loss 3.0420 (2.6189) ce_loss 1.5693 (1.1911) loss_zs_kd 0.4069 (0.4675) loss_oracle 0.4968 (0.4907) acc 28.1250 (58.5938) kd_loss 1.0208 (0.9487) lr 1.4258e-03 eta 0:24:17
epoch [20/50] batch [260/428] time 0.080 (0.110) data 0.000 (0.010) loss 2.8187 (2.6205) ce_loss 1.4512 (1.1922) loss_zs_kd 0.4676 (0.4693) loss_oracle 0.5061 (0.4893) acc 43.7500 (58.5577) kd_loss 0.8807 (0.9490) lr 1.4258e-03 eta 0:23:51
epoch [20/50] batch [280/428] time 0.081 (0.108) data 0.000 (0.010) loss 2.6504 (2.6196) ce_loss 1.2432 (1.1911) loss_zs_kd 0.4427 (0.4702) loss_oracle 0.4174 (0.4894) acc 50.0000 (58.6272) kd_loss 0.9772 (0.9487) lr 1.4258e-03 eta 0:23:19
epoch [20/50] batch [300/428] time 0.163 (0.109) data 0.000 (0.009) loss 2.6941 (2.6191) ce_loss 1.3027 (1.1929) loss_zs_kd 0.5230 (0.4707) loss_oracle 0.4484 (0.4875) acc 62.5000 (58.5521) kd_loss 0.9056 (0.9471) lr 1.4258e-03 eta 0:23:31
epoch [20/50] batch [320/428] time 0.072 (0.107) data 0.000 (0.008) loss 2.4690 (2.6174) ce_loss 1.0879 (1.1947) loss_zs_kd 0.4468 (0.4694) loss_oracle 0.4388 (0.4852) acc 62.5000 (58.5156) kd_loss 0.9383 (0.9454) lr 1.4258e-03 eta 0:23:09
epoch [20/50] batch [340/428] time 0.080 (0.106) data 0.000 (0.008) loss 2.6904 (2.6142) ce_loss 1.1885 (1.1944) loss_zs_kd 0.4822 (0.4672) loss_oracle 0.4957 (0.4844) acc 56.2500 (58.5570) kd_loss 1.0130 (0.9440) lr 1.4258e-03 eta 0:22:47
epoch [20/50] batch [360/428] time 0.095 (0.107) data 0.000 (0.007) loss 2.6050 (2.6148) ce_loss 1.2285 (1.1958) loss_zs_kd 0.4338 (0.4680) loss_oracle 0.4646 (0.4842) acc 53.1250 (58.3767) kd_loss 0.9273 (0.9429) lr 1.4258e-03 eta 0:23:01
epoch [20/50] batch [380/428] time 0.081 (0.106) data 0.000 (0.007) loss 2.5354 (2.6179) ce_loss 1.1670 (1.1995) loss_zs_kd 0.4005 (0.4678) loss_oracle 0.5347 (0.4856) acc 53.1250 (58.2237) kd_loss 0.9008 (0.9417) lr 1.4258e-03 eta 0:22:41
epoch [20/50] batch [400/428] time 0.080 (0.105) data 0.000 (0.007) loss 2.3517 (2.6175) ce_loss 1.0762 (1.2005) loss_zs_kd 0.4284 (0.4670) loss_oracle 0.3802 (0.4853) acc 62.5000 (58.2266) kd_loss 0.8713 (0.9408) lr 1.4258e-03 eta 0:22:25
epoch [20/50] batch [420/428] time 0.074 (0.103) data 0.000 (0.006) loss 2.5133 (2.6173) ce_loss 1.1514 (1.2012) loss_zs_kd 0.4340 (0.4664) loss_oracle 0.5077 (0.4860) acc 59.3750 (58.3185) kd_loss 0.8911 (0.9399) lr 1.4258e-03 eta 0:22:09
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,609
* accuracy: 61.4%
* error: 38.6%
* macro_f1: 49.6%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,662
* accuracy: 56.1%
* error: 43.9%
* macro_f1: 33.6%
******* Domain 1 best val acc:      61.4%, epoch: 20 *******
******* Domain 1 best val test acc: 56.1%, epoch: 20 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [21/50] batch [20/428] time 0.113 (0.207) data 0.000 (0.101) loss 2.7301 (2.6422) ce_loss 1.3428 (1.2617) loss_zs_kd 0.4851 (0.4536) loss_oracle 0.4385 (0.4584) acc 46.8750 (55.1562) kd_loss 0.9255 (0.9245) lr 1.3681e-03 eta 0:44:10
epoch [21/50] batch [40/428] time 0.109 (0.153) data 0.000 (0.051) loss 2.4535 (2.5801) ce_loss 0.9966 (1.1990) loss_zs_kd 0.6181 (0.4684) loss_oracle 0.3731 (0.4501) acc 71.8750 (58.4375) kd_loss 0.9613 (0.9219) lr 1.3681e-03 eta 0:32:33
epoch [21/50] batch [60/428] time 0.100 (0.136) data 0.000 (0.034) loss 2.5768 (2.5842) ce_loss 1.2256 (1.1960) loss_zs_kd 0.4617 (0.4698) loss_oracle 0.3914 (0.4484) acc 56.2500 (58.2812) kd_loss 0.9246 (0.9291) lr 1.3681e-03 eta 0:28:57
epoch [21/50] batch [80/428] time 0.103 (0.128) data 0.000 (0.025) loss 2.2765 (2.5861) ce_loss 0.9189 (1.1914) loss_zs_kd 0.4582 (0.4746) loss_oracle 0.4401 (0.4481) acc 65.6250 (58.6719) kd_loss 0.9084 (0.9333) lr 1.3681e-03 eta 0:27:08
epoch [21/50] batch [100/428] time 0.106 (0.122) data 0.000 (0.020) loss 2.5947 (2.5942) ce_loss 1.2197 (1.1960) loss_zs_kd 0.5224 (0.4754) loss_oracle 0.4587 (0.4458) acc 59.3750 (58.2188) kd_loss 0.8844 (0.9376) lr 1.3681e-03 eta 0:25:56
epoch [21/50] batch [120/428] time 0.085 (0.121) data 0.000 (0.017) loss 2.6335 (2.6003) ce_loss 1.2656 (1.1984) loss_zs_kd 0.5461 (0.4775) loss_oracle 0.4477 (0.4438) acc 50.0000 (58.4115) kd_loss 0.8710 (0.9413) lr 1.3681e-03 eta 0:25:44
epoch [21/50] batch [140/428] time 0.096 (0.123) data 0.000 (0.015) loss 2.6184 (2.5991) ce_loss 1.1562 (1.1962) loss_zs_kd 0.4448 (0.4735) loss_oracle 0.4195 (0.4441) acc 50.0000 (58.5045) kd_loss 1.0300 (0.9441) lr 1.3681e-03 eta 0:25:57
epoch [21/50] batch [160/428] time 0.113 (0.121) data 0.000 (0.013) loss 2.4652 (2.5912) ce_loss 0.9507 (1.1888) loss_zs_kd 0.4918 (0.4717) loss_oracle 0.5197 (0.4461) acc 71.8750 (58.8281) kd_loss 1.0088 (0.9435) lr 1.3681e-03 eta 0:25:29
epoch [21/50] batch [180/428] time 0.096 (0.119) data 0.000 (0.011) loss 2.6954 (2.5961) ce_loss 1.1396 (1.1911) loss_zs_kd 0.5541 (0.4735) loss_oracle 0.4747 (0.4477) acc 59.3750 (58.7674) kd_loss 1.0413 (0.9444) lr 1.3681e-03 eta 0:25:06
epoch [21/50] batch [200/428] time 0.105 (0.118) data 0.000 (0.010) loss 2.2969 (2.5913) ce_loss 0.8960 (1.1874) loss_zs_kd 0.4515 (0.4714) loss_oracle 0.4028 (0.4471) acc 75.0000 (58.9531) kd_loss 0.9737 (0.9446) lr 1.3681e-03 eta 0:24:51
epoch [21/50] batch [220/428] time 0.112 (0.117) data 0.000 (0.009) loss 2.4850 (2.5859) ce_loss 1.1270 (1.1824) loss_zs_kd 0.3894 (0.4707) loss_oracle 0.4257 (0.4492) acc 50.0000 (58.9915) kd_loss 0.9505 (0.9436) lr 1.3681e-03 eta 0:24:33
epoch [21/50] batch [240/428] time 0.101 (0.116) data 0.000 (0.009) loss 2.5759 (2.5903) ce_loss 1.2129 (1.1887) loss_zs_kd 0.4412 (0.4713) loss_oracle 0.4412 (0.4492) acc 53.1250 (58.6589) kd_loss 0.9218 (0.9414) lr 1.3681e-03 eta 0:24:17
epoch [21/50] batch [260/428] time 0.105 (0.114) data 0.000 (0.008) loss 2.4860 (2.5891) ce_loss 1.0508 (1.1853) loss_zs_kd 0.4679 (0.4714) loss_oracle 0.5327 (0.4519) acc 62.5000 (58.9303) kd_loss 0.9350 (0.9421) lr 1.3681e-03 eta 0:23:59
epoch [21/50] batch [280/428] time 0.103 (0.114) data 0.000 (0.007) loss 2.7502 (2.5949) ce_loss 1.2920 (1.1878) loss_zs_kd 0.4870 (0.4721) loss_oracle 0.4193 (0.4538) acc 62.5000 (58.7835) kd_loss 1.0050 (0.9441) lr 1.3681e-03 eta 0:23:46
epoch [21/50] batch [300/428] time 0.099 (0.113) data 0.000 (0.007) loss 2.5353 (2.6002) ce_loss 1.1328 (1.1891) loss_zs_kd 0.5257 (0.4725) loss_oracle 0.4629 (0.4563) acc 62.5000 (58.5417) kd_loss 0.9081 (0.9467) lr 1.3681e-03 eta 0:23:34
epoch [21/50] batch [320/428] time 0.161 (0.112) data 0.000 (0.007) loss 2.5696 (2.6015) ce_loss 1.1084 (1.1888) loss_zs_kd 0.4612 (0.4720) loss_oracle 0.4689 (0.4569) acc 65.6250 (58.5254) kd_loss 0.9962 (0.9482) lr 1.3681e-03 eta 0:23:22
epoch [21/50] batch [340/428] time 0.171 (0.113) data 0.000 (0.006) loss 2.8382 (2.6062) ce_loss 1.3477 (1.1920) loss_zs_kd 0.5433 (0.4720) loss_oracle 0.4453 (0.4564) acc 56.2500 (58.3824) kd_loss 0.9962 (0.9500) lr 1.3681e-03 eta 0:23:36
epoch [21/50] batch [360/428] time 0.099 (0.114) data 0.000 (0.006) loss 2.5793 (2.6101) ce_loss 1.2305 (1.1951) loss_zs_kd 0.3344 (0.4727) loss_oracle 0.3654 (0.4538) acc 46.8750 (58.2205) kd_loss 0.9989 (0.9518) lr 1.3681e-03 eta 0:23:37
epoch [21/50] batch [380/428] time 0.104 (0.113) data 0.000 (0.006) loss 2.6155 (2.6113) ce_loss 1.2305 (1.1963) loss_zs_kd 0.5714 (0.4728) loss_oracle 0.4545 (0.4535) acc 56.2500 (58.1579) kd_loss 0.8721 (0.9518) lr 1.3681e-03 eta 0:23:25
epoch [21/50] batch [400/428] time 0.100 (0.112) data 0.000 (0.005) loss 2.5716 (2.6124) ce_loss 1.2129 (1.1964) loss_zs_kd 0.4309 (0.4750) loss_oracle 0.4362 (0.4547) acc 56.2500 (58.0625) kd_loss 0.9252 (0.9512) lr 1.3681e-03 eta 0:23:15
epoch [21/50] batch [420/428] time 0.094 (0.112) data 0.000 (0.005) loss 2.9547 (2.6097) ce_loss 1.4951 (1.1942) loss_zs_kd 0.4317 (0.4736) loss_oracle 0.5316 (0.4566) acc 50.0000 (58.0134) kd_loss 0.9778 (0.9503) lr 1.3681e-03 eta 0:23:05
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,495
* accuracy: 59.5%
* error: 40.5%
* macro_f1: 47.8%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,665
* accuracy: 56.2%
* error: 43.8%
* macro_f1: 32.8%
******* Domain 1 best val acc:      61.4%, epoch: 20 *******
******* Domain 1 best val test acc: 56.1%, epoch: 20 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [22/50] batch [20/428] time 0.095 (0.213) data 0.000 (0.113) loss 2.3429 (2.5982) ce_loss 0.9321 (1.1923) loss_zs_kd 0.4204 (0.4504) loss_oracle 0.4643 (0.4796) acc 53.1250 (61.5625) kd_loss 0.9684 (0.9409) lr 1.3090e-03 eta 0:44:05
epoch [22/50] batch [40/428] time 0.084 (0.155) data 0.000 (0.057) loss 2.5177 (2.5839) ce_loss 1.0957 (1.1806) loss_zs_kd 0.5318 (0.4690) loss_oracle 0.4935 (0.4706) acc 65.6250 (60.7031) kd_loss 0.9093 (0.9334) lr 1.3090e-03 eta 0:32:03
epoch [22/50] batch [60/428] time 0.079 (0.147) data 0.000 (0.038) loss 2.5850 (2.6226) ce_loss 1.1572 (1.2130) loss_zs_kd 0.5358 (0.4731) loss_oracle 0.4756 (0.4708) acc 65.6250 (58.5938) kd_loss 0.9220 (0.9377) lr 1.3090e-03 eta 0:30:10
epoch [22/50] batch [80/428] time 0.087 (0.145) data 0.000 (0.028) loss 2.5464 (2.6215) ce_loss 1.2090 (1.2130) loss_zs_kd 0.4906 (0.4743) loss_oracle 0.4251 (0.4739) acc 65.6250 (58.8672) kd_loss 0.8796 (0.9344) lr 1.3090e-03 eta 0:29:44
epoch [22/50] batch [100/428] time 0.093 (0.135) data 0.000 (0.023) loss 2.3836 (2.6116) ce_loss 0.9160 (1.1985) loss_zs_kd 0.5224 (0.4787) loss_oracle 0.4576 (0.4777) acc 81.2500 (59.4375) kd_loss 0.9775 (0.9349) lr 1.3090e-03 eta 0:27:41
epoch [22/50] batch [120/428] time 0.095 (0.129) data 0.000 (0.019) loss 2.5290 (2.6185) ce_loss 1.1279 (1.2032) loss_zs_kd 0.4321 (0.4786) loss_oracle 0.5042 (0.4792) acc 59.3750 (59.6354) kd_loss 0.9330 (0.9364) lr 1.3090e-03 eta 0:26:28
epoch [22/50] batch [140/428] time 0.117 (0.126) data 0.000 (0.016) loss 2.6581 (2.6062) ce_loss 1.2090 (1.1950) loss_zs_kd 0.4786 (0.4792) loss_oracle 0.4905 (0.4758) acc 53.1250 (59.7098) kd_loss 0.9645 (0.9337) lr 1.3090e-03 eta 0:25:44
epoch [22/50] batch [160/428] time 0.099 (0.123) data 0.000 (0.014) loss 2.5286 (2.5970) ce_loss 1.1104 (1.1848) loss_zs_kd 0.5191 (0.4813) loss_oracle 0.4280 (0.4711) acc 56.2500 (60.2734) kd_loss 0.9446 (0.9360) lr 1.3090e-03 eta 0:25:09
epoch [22/50] batch [180/428] time 0.098 (0.121) data 0.000 (0.013) loss 2.9837 (2.5992) ce_loss 1.5020 (1.1854) loss_zs_kd 0.5961 (0.4849) loss_oracle 0.3971 (0.4727) acc 50.0000 (60.1736) kd_loss 0.9851 (0.9351) lr 1.3090e-03 eta 0:24:37
epoch [22/50] batch [200/428] time 0.099 (0.119) data 0.000 (0.012) loss 2.6004 (2.6013) ce_loss 1.0928 (1.1865) loss_zs_kd 0.5548 (0.4837) loss_oracle 0.5254 (0.4759) acc 59.3750 (59.7969) kd_loss 0.9675 (0.9351) lr 1.3090e-03 eta 0:24:10
epoch [22/50] batch [220/428] time 0.093 (0.117) data 0.000 (0.011) loss 2.7868 (2.6004) ce_loss 1.3594 (1.1861) loss_zs_kd 0.3918 (0.4823) loss_oracle 0.5186 (0.4776) acc 56.2500 (59.7301) kd_loss 0.9722 (0.9343) lr 1.3090e-03 eta 0:23:48
epoch [22/50] batch [240/428] time 0.104 (0.116) data 0.000 (0.010) loss 2.7210 (2.5982) ce_loss 1.3916 (1.1859) loss_zs_kd 0.3911 (0.4799) loss_oracle 0.5016 (0.4789) acc 40.6250 (59.7005) kd_loss 0.8831 (0.9330) lr 1.3090e-03 eta 0:23:29
epoch [22/50] batch [260/428] time 0.084 (0.114) data 0.000 (0.009) loss 2.4806 (2.6006) ce_loss 1.1348 (1.1891) loss_zs_kd 0.4308 (0.4786) loss_oracle 0.4220 (0.4789) acc 62.5000 (59.4471) kd_loss 0.9195 (0.9327) lr 1.3090e-03 eta 0:23:05
epoch [22/50] batch [280/428] time 0.087 (0.115) data 0.000 (0.008) loss 2.5885 (2.6026) ce_loss 1.1094 (1.1912) loss_zs_kd 0.5954 (0.4792) loss_oracle 0.4458 (0.4785) acc 50.0000 (59.2522) kd_loss 0.9586 (0.9326) lr 1.3090e-03 eta 0:23:17
epoch [22/50] batch [300/428] time 0.153 (0.116) data 0.000 (0.008) loss 2.6555 (2.6019) ce_loss 1.2100 (1.1911) loss_zs_kd 0.6083 (0.4781) loss_oracle 0.4755 (0.4773) acc 53.1250 (59.2917) kd_loss 0.9036 (0.9330) lr 1.3090e-03 eta 0:23:25
epoch [22/50] batch [320/428] time 0.088 (0.114) data 0.000 (0.007) loss 2.4398 (2.5984) ce_loss 1.0264 (1.1879) loss_zs_kd 0.5083 (0.4779) loss_oracle 0.4200 (0.4741) acc 62.5000 (59.3652) kd_loss 0.9493 (0.9345) lr 1.3090e-03 eta 0:23:02
epoch [22/50] batch [340/428] time 0.104 (0.113) data 0.000 (0.007) loss 2.5315 (2.5976) ce_loss 1.0938 (1.1876) loss_zs_kd 0.4936 (0.4772) loss_oracle 0.3882 (0.4729) acc 62.5000 (59.3382) kd_loss 0.9968 (0.9349) lr 1.3090e-03 eta 0:22:50
epoch [22/50] batch [360/428] time 0.108 (0.113) data 0.000 (0.007) loss 2.5240 (2.5966) ce_loss 1.1328 (1.1880) loss_zs_kd 0.4967 (0.4748) loss_oracle 0.4869 (0.4712) acc 56.2500 (59.1233) kd_loss 0.8994 (0.9356) lr 1.3090e-03 eta 0:22:40
epoch [22/50] batch [380/428] time 0.097 (0.112) data 0.000 (0.006) loss 2.5842 (2.5956) ce_loss 1.1953 (1.1876) loss_zs_kd 0.4310 (0.4739) loss_oracle 0.4653 (0.4694) acc 65.6250 (59.0378) kd_loss 0.9407 (0.9362) lr 1.3090e-03 eta 0:22:29
epoch [22/50] batch [400/428] time 0.113 (0.112) data 0.000 (0.006) loss 2.6311 (2.5981) ce_loss 1.2715 (1.1910) loss_zs_kd 0.4850 (0.4732) loss_oracle 0.5408 (0.4686) acc 50.0000 (58.8594) kd_loss 0.8467 (0.9362) lr 1.3090e-03 eta 0:22:20
epoch [22/50] batch [420/428] time 0.098 (0.111) data 0.000 (0.006) loss 2.5820 (2.5984) ce_loss 1.1396 (1.1900) loss_zs_kd 0.5294 (0.4731) loss_oracle 0.5119 (0.4692) acc 59.3750 (58.8765) kd_loss 0.9217 (0.9372) lr 1.3090e-03 eta 0:22:11
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,538
* accuracy: 60.2%
* error: 39.8%
* macro_f1: 48.0%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,683
* accuracy: 56.6%
* error: 43.4%
* macro_f1: 33.6%
******* Domain 1 best val acc:      61.4%, epoch: 20 *******
******* Domain 1 best val test acc: 56.1%, epoch: 20 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [23/50] batch [20/428] time 0.072 (0.247) data 0.000 (0.147) loss 2.6253 (2.5998) ce_loss 1.2080 (1.1770) loss_zs_kd 0.4911 (0.4444) loss_oracle 0.4645 (0.4962) acc 56.2500 (59.2188) kd_loss 0.9395 (0.9525) lr 1.2487e-03 eta 0:49:09
epoch [23/50] batch [40/428] time 0.102 (0.189) data 0.000 (0.074) loss 2.4359 (2.6118) ce_loss 1.0195 (1.1862) loss_zs_kd 0.4784 (0.4519) loss_oracle 0.4780 (0.4892) acc 68.7500 (59.0625) kd_loss 0.9381 (0.9550) lr 1.2487e-03 eta 0:37:33
epoch [23/50] batch [60/428] time 0.087 (0.159) data 0.000 (0.049) loss 2.6953 (2.6084) ce_loss 1.3135 (1.1830) loss_zs_kd 0.3999 (0.4711) loss_oracle 0.4228 (0.4772) acc 56.2500 (59.2708) kd_loss 0.9705 (0.9513) lr 1.2487e-03 eta 0:31:41
epoch [23/50] batch [80/428] time 0.123 (0.145) data 0.000 (0.037) loss 2.8512 (2.6314) ce_loss 1.4414 (1.2127) loss_zs_kd 0.4282 (0.4666) loss_oracle 0.4165 (0.4639) acc 40.6250 (58.0078) kd_loss 0.9875 (0.9534) lr 1.2487e-03 eta 0:28:41
epoch [23/50] batch [100/428] time 0.091 (0.136) data 0.000 (0.030) loss 2.7371 (2.6300) ce_loss 1.3154 (1.2168) loss_zs_kd 0.4124 (0.4687) loss_oracle 0.4184 (0.4544) acc 62.5000 (58.1250) kd_loss 1.0062 (0.9516) lr 1.2487e-03 eta 0:26:59
epoch [23/50] batch [120/428] time 0.088 (0.130) data 0.000 (0.025) loss 2.4780 (2.6216) ce_loss 1.2100 (1.2156) loss_zs_kd 0.4469 (0.4675) loss_oracle 0.4090 (0.4465) acc 65.6250 (58.0208) kd_loss 0.8401 (0.9490) lr 1.2487e-03 eta 0:25:43
epoch [23/50] batch [140/428] time 0.097 (0.126) data 0.000 (0.021) loss 2.7662 (2.6182) ce_loss 1.4932 (1.2172) loss_zs_kd 0.4206 (0.4663) loss_oracle 0.3945 (0.4384) acc 40.6250 (57.8125) kd_loss 0.8655 (0.9487) lr 1.2487e-03 eta 0:24:47
epoch [23/50] batch [160/428] time 0.104 (0.123) data 0.000 (0.019) loss 2.3853 (2.6119) ce_loss 1.1123 (1.2127) loss_zs_kd 0.4177 (0.4687) loss_oracle 0.3727 (0.4354) acc 59.3750 (57.8711) kd_loss 0.8778 (0.9471) lr 1.2487e-03 eta 0:24:10
epoch [23/50] batch [180/428] time 0.106 (0.120) data 0.000 (0.017) loss 2.2677 (2.6032) ce_loss 0.9277 (1.2044) loss_zs_kd 0.5122 (0.4671) loss_oracle 0.3935 (0.4346) acc 78.1250 (58.3160) kd_loss 0.8871 (0.9479) lr 1.2487e-03 eta 0:23:37
epoch [23/50] batch [200/428] time 0.095 (0.118) data 0.000 (0.015) loss 2.5325 (2.5969) ce_loss 1.1123 (1.1958) loss_zs_kd 0.4603 (0.4720) loss_oracle 0.4518 (0.4351) acc 65.6250 (58.6094) kd_loss 0.9641 (0.9475) lr 1.2487e-03 eta 0:23:12
epoch [23/50] batch [220/428] time 0.165 (0.117) data 0.000 (0.014) loss 2.5678 (2.5968) ce_loss 1.2588 (1.1979) loss_zs_kd 0.4224 (0.4681) loss_oracle 0.4753 (0.4361) acc 53.1250 (58.4091) kd_loss 0.8602 (0.9468) lr 1.2487e-03 eta 0:22:59
epoch [23/50] batch [240/428] time 0.087 (0.117) data 0.001 (0.013) loss 2.7130 (2.5915) ce_loss 1.3447 (1.1946) loss_zs_kd 0.4813 (0.4681) loss_oracle 0.3645 (0.4363) acc 53.1250 (58.4245) kd_loss 0.9454 (0.9447) lr 1.2487e-03 eta 0:22:52
epoch [23/50] batch [260/428] time 0.080 (0.118) data 0.000 (0.012) loss 2.6418 (2.5922) ce_loss 1.3486 (1.1969) loss_zs_kd 0.4525 (0.4680) loss_oracle 0.3432 (0.4352) acc 46.8750 (58.3413) kd_loss 0.8953 (0.9436) lr 1.2487e-03 eta 0:23:04
epoch [23/50] batch [280/428] time 0.109 (0.117) data 0.000 (0.011) loss 2.1990 (2.5882) ce_loss 0.9004 (1.1928) loss_zs_kd 0.4026 (0.4683) loss_oracle 0.4250 (0.4354) acc 65.6250 (58.5045) kd_loss 0.8848 (0.9435) lr 1.2487e-03 eta 0:22:45
epoch [23/50] batch [300/428] time 0.110 (0.116) data 0.000 (0.010) loss 2.5184 (2.5885) ce_loss 1.0107 (1.1921) loss_zs_kd 0.5384 (0.4674) loss_oracle 0.4827 (0.4371) acc 68.7500 (58.4375) kd_loss 0.9971 (0.9442) lr 1.2487e-03 eta 0:22:30
epoch [23/50] batch [320/428] time 0.089 (0.115) data 0.000 (0.009) loss 2.7068 (2.5910) ce_loss 1.2822 (1.1920) loss_zs_kd 0.4847 (0.4684) loss_oracle 0.4181 (0.4374) acc 56.2500 (58.5547) kd_loss 0.9732 (0.9461) lr 1.2487e-03 eta 0:22:16
epoch [23/50] batch [340/428] time 0.093 (0.113) data 0.000 (0.009) loss 2.6278 (2.5904) ce_loss 1.2451 (1.1903) loss_zs_kd 0.4146 (0.4681) loss_oracle 0.4555 (0.4389) acc 53.1250 (58.6305) kd_loss 0.9476 (0.9466) lr 1.2487e-03 eta 0:22:00
epoch [23/50] batch [360/428] time 0.118 (0.113) data 0.000 (0.008) loss 2.7833 (2.5890) ce_loss 1.4863 (1.1865) loss_zs_kd 0.4194 (0.4707) loss_oracle 0.3820 (0.4405) acc 43.7500 (58.7500) kd_loss 0.8963 (0.9469) lr 1.2487e-03 eta 0:21:51
epoch [23/50] batch [380/428] time 0.096 (0.112) data 0.000 (0.008) loss 2.3627 (2.5863) ce_loss 1.0283 (1.1830) loss_zs_kd 0.3676 (0.4693) loss_oracle 0.5106 (0.4410) acc 71.8750 (58.9556) kd_loss 0.8953 (0.9482) lr 1.2487e-03 eta 0:21:42
epoch [23/50] batch [400/428] time 0.121 (0.112) data 0.000 (0.008) loss 2.5214 (2.5862) ce_loss 1.0449 (1.1817) loss_zs_kd 0.4075 (0.4700) loss_oracle 0.5128 (0.4423) acc 65.6250 (59.0000) kd_loss 1.0164 (0.9484) lr 1.2487e-03 eta 0:21:35
epoch [23/50] batch [420/428] time 0.089 (0.111) data 0.000 (0.007) loss 2.4437 (2.5886) ce_loss 1.0820 (1.1833) loss_zs_kd 0.4226 (0.4691) loss_oracle 0.4867 (0.4437) acc 65.6250 (58.9732) kd_loss 0.9070 (0.9489) lr 1.2487e-03 eta 0:21:26
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,539
* accuracy: 60.2%
* error: 39.8%
* macro_f1: 48.4%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,478
* accuracy: 52.3%
* error: 47.7%
* macro_f1: 30.6%
******* Domain 1 best val acc:      61.4%, epoch: 20 *******
******* Domain 1 best val test acc: 56.1%, epoch: 20 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [24/50] batch [20/428] time 0.121 (0.286) data 0.000 (0.186) loss 2.7981 (2.6149) ce_loss 1.1621 (1.1791) loss_zs_kd 0.5756 (0.4712) loss_oracle 0.4681 (0.4320) acc 59.3750 (59.3750) kd_loss 1.1142 (0.9843) lr 1.1874e-03 eta 0:55:01
epoch [24/50] batch [40/428] time 0.117 (0.196) data 0.000 (0.093) loss 2.6532 (2.6083) ce_loss 1.2197 (1.1595) loss_zs_kd 0.4268 (0.4737) loss_oracle 0.4725 (0.4547) acc 59.3750 (60.5469) kd_loss 0.9839 (0.9846) lr 1.1874e-03 eta 0:37:42
epoch [24/50] batch [60/428] time 0.108 (0.166) data 0.000 (0.062) loss 2.9504 (2.6081) ce_loss 1.4932 (1.1521) loss_zs_kd 0.4278 (0.4691) loss_oracle 0.4239 (0.4599) acc 46.8750 (60.8333) kd_loss 1.0314 (0.9914) lr 1.1874e-03 eta 0:31:50
epoch [24/50] batch [80/428] time 0.105 (0.150) data 0.000 (0.047) loss 2.9713 (2.6138) ce_loss 1.4639 (1.1594) loss_zs_kd 0.5134 (0.4695) loss_oracle 0.4975 (0.4565) acc 43.7500 (61.3281) kd_loss 1.0020 (0.9914) lr 1.1874e-03 eta 0:28:44
epoch [24/50] batch [100/428] time 0.098 (0.142) data 0.000 (0.037) loss 2.5429 (2.6122) ce_loss 1.0674 (1.1553) loss_zs_kd 0.4756 (0.4705) loss_oracle 0.4365 (0.4577) acc 62.5000 (61.1875) kd_loss 1.0195 (0.9928) lr 1.1874e-03 eta 0:27:01
epoch [24/50] batch [120/428] time 0.095 (0.135) data 0.000 (0.031) loss 2.6275 (2.6230) ce_loss 1.1982 (1.1671) loss_zs_kd 0.4123 (0.4735) loss_oracle 0.4545 (0.4531) acc 59.3750 (60.9896) kd_loss 0.9959 (0.9926) lr 1.1874e-03 eta 0:25:48
epoch [24/50] batch [140/428] time 0.111 (0.131) data 0.000 (0.027) loss 2.5973 (2.6288) ce_loss 1.2021 (1.1757) loss_zs_kd 0.5063 (0.4720) loss_oracle 0.4326 (0.4558) acc 62.5000 (60.2902) kd_loss 0.9257 (0.9893) lr 1.1874e-03 eta 0:24:53
epoch [24/50] batch [160/428] time 0.101 (0.127) data 0.000 (0.023) loss 2.4948 (2.6219) ce_loss 0.9897 (1.1719) loss_zs_kd 0.4864 (0.4709) loss_oracle 0.4682 (0.4562) acc 71.8750 (60.3516) kd_loss 1.0277 (0.9865) lr 1.1874e-03 eta 0:24:10
epoch [24/50] batch [180/428] time 0.074 (0.124) data 0.000 (0.021) loss 2.7006 (2.6234) ce_loss 1.2246 (1.1741) loss_zs_kd 0.5542 (0.4760) loss_oracle 0.4544 (0.4536) acc 59.3750 (60.1215) kd_loss 0.9717 (0.9845) lr 1.1874e-03 eta 0:23:31
epoch [24/50] batch [200/428] time 0.188 (0.122) data 0.000 (0.019) loss 2.6701 (2.6256) ce_loss 1.1562 (1.1767) loss_zs_kd 0.4590 (0.4758) loss_oracle 0.5110 (0.4538) acc 65.6250 (60.0000) kd_loss 1.0288 (0.9842) lr 1.1874e-03 eta 0:23:02
epoch [24/50] batch [220/428] time 0.085 (0.121) data 0.001 (0.017) loss 2.6901 (2.6263) ce_loss 1.3730 (1.1822) loss_zs_kd 0.3225 (0.4748) loss_oracle 0.4708 (0.4535) acc 43.7500 (59.6165) kd_loss 0.9204 (0.9800) lr 1.1874e-03 eta 0:22:47
epoch [24/50] batch [240/428] time 0.083 (0.121) data 0.000 (0.016) loss 2.7183 (2.6307) ce_loss 1.3789 (1.1901) loss_zs_kd 0.4845 (0.4736) loss_oracle 0.4206 (0.4540) acc 50.0000 (59.2188) kd_loss 0.8869 (0.9768) lr 1.1874e-03 eta 0:22:54
epoch [24/50] batch [260/428] time 0.105 (0.119) data 0.000 (0.015) loss 2.8182 (2.6276) ce_loss 1.4150 (1.1902) loss_zs_kd 0.4165 (0.4753) loss_oracle 0.4709 (0.4530) acc 50.0000 (59.2308) kd_loss 0.9595 (0.9733) lr 1.1874e-03 eta 0:22:27
epoch [24/50] batch [280/428] time 0.087 (0.118) data 0.000 (0.014) loss 2.7019 (2.6277) ce_loss 1.2637 (1.1940) loss_zs_kd 0.4610 (0.4743) loss_oracle 0.4661 (0.4529) acc 50.0000 (59.1295) kd_loss 0.9747 (0.9702) lr 1.1874e-03 eta 0:22:07
epoch [24/50] batch [300/428] time 0.113 (0.116) data 0.000 (0.013) loss 2.3532 (2.6224) ce_loss 1.0039 (1.1943) loss_zs_kd 0.4295 (0.4739) loss_oracle 0.4686 (0.4529) acc 71.8750 (58.9896) kd_loss 0.9003 (0.9647) lr 1.1874e-03 eta 0:21:50
epoch [24/50] batch [320/428] time 0.109 (0.116) data 0.000 (0.012) loss 2.4918 (2.6196) ce_loss 1.1113 (1.1955) loss_zs_kd 0.4156 (0.4733) loss_oracle 0.4966 (0.4547) acc 53.1250 (58.8086) kd_loss 0.9243 (0.9601) lr 1.1874e-03 eta 0:21:39
epoch [24/50] batch [340/428] time 0.108 (0.115) data 0.000 (0.011) loss 2.4413 (2.6145) ce_loss 1.0674 (1.1928) loss_zs_kd 0.4331 (0.4723) loss_oracle 0.5337 (0.4566) acc 59.3750 (58.8051) kd_loss 0.8905 (0.9572) lr 1.1874e-03 eta 0:21:27
epoch [24/50] batch [360/428] time 0.098 (0.114) data 0.000 (0.011) loss 2.3912 (2.6138) ce_loss 1.0508 (1.1935) loss_zs_kd 0.4139 (0.4727) loss_oracle 0.4768 (0.4595) acc 59.3750 (58.7413) kd_loss 0.8950 (0.9542) lr 1.1874e-03 eta 0:21:17
epoch [24/50] batch [380/428] time 0.106 (0.113) data 0.000 (0.010) loss 2.6072 (2.6086) ce_loss 1.1689 (1.1893) loss_zs_kd 0.5128 (0.4737) loss_oracle 0.4613 (0.4615) acc 65.6250 (58.9474) kd_loss 0.9512 (0.9517) lr 1.1874e-03 eta 0:21:06
epoch [24/50] batch [400/428] time 0.112 (0.113) data 0.000 (0.010) loss 2.5303 (2.6062) ce_loss 1.1172 (1.1894) loss_zs_kd 0.4271 (0.4730) loss_oracle 0.5026 (0.4621) acc 56.2500 (58.9688) kd_loss 0.9482 (0.9492) lr 1.1874e-03 eta 0:20:56
epoch [24/50] batch [420/428] time 0.072 (0.111) data 0.000 (0.009) loss 2.4988 (2.6056) ce_loss 1.1367 (1.1900) loss_zs_kd 0.4266 (0.4732) loss_oracle 0.3800 (0.4628) acc 53.1250 (58.9658) kd_loss 0.9588 (0.9476) lr 1.1874e-03 eta 0:20:39
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,665
* accuracy: 62.4%
* error: 37.6%
* macro_f1: 50.3%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,535
* accuracy: 53.5%
* error: 46.5%
* macro_f1: 32.6%
******* Domain 1 best val acc:      62.4%, epoch: 24 *******
******* Domain 1 best val test acc: 53.5%, epoch: 24 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [25/50] batch [20/428] time 0.101 (0.258) data 0.000 (0.163) loss 3.0098 (2.5877) ce_loss 1.5557 (1.2234) loss_zs_kd 0.5905 (0.4764) loss_oracle 0.4493 (0.4491) acc 50.0000 (57.3438) kd_loss 0.9342 (0.9016) lr 1.1253e-03 eta 0:47:45
epoch [25/50] batch [40/428] time 0.099 (0.181) data 0.000 (0.082) loss 2.6606 (2.5669) ce_loss 1.2393 (1.1948) loss_zs_kd 0.5026 (0.4791) loss_oracle 0.4920 (0.4533) acc 59.3750 (60.0000) kd_loss 0.9240 (0.9059) lr 1.1253e-03 eta 0:33:30
epoch [25/50] batch [60/428] time 0.103 (0.155) data 0.000 (0.055) loss 2.5797 (2.5755) ce_loss 1.2598 (1.2026) loss_zs_kd 0.4154 (0.4782) loss_oracle 0.4024 (0.4495) acc 59.3750 (58.9583) kd_loss 0.9111 (0.9090) lr 1.1253e-03 eta 0:28:35
epoch [25/50] batch [80/428] time 0.107 (0.141) data 0.000 (0.041) loss 2.4186 (2.5763) ce_loss 0.9946 (1.1992) loss_zs_kd 0.5794 (0.4838) loss_oracle 0.4464 (0.4477) acc 75.0000 (59.0625) kd_loss 0.9111 (0.9113) lr 1.1253e-03 eta 0:26:00
epoch [25/50] batch [100/428] time 0.107 (0.133) data 0.000 (0.033) loss 2.5399 (2.5795) ce_loss 1.2266 (1.1997) loss_zs_kd 0.4969 (0.4877) loss_oracle 0.4272 (0.4453) acc 65.6250 (58.8125) kd_loss 0.8513 (0.9133) lr 1.1253e-03 eta 0:24:31
epoch [25/50] batch [120/428] time 0.095 (0.128) data 0.000 (0.027) loss 2.7343 (2.5718) ce_loss 1.2695 (1.1902) loss_zs_kd 0.4683 (0.4867) loss_oracle 0.4227 (0.4450) acc 50.0000 (59.3750) kd_loss 1.0193 (0.9158) lr 1.1253e-03 eta 0:23:32
epoch [25/50] batch [140/428] time 0.093 (0.125) data 0.000 (0.024) loss 3.0412 (2.5713) ce_loss 1.6318 (1.1887) loss_zs_kd 0.5189 (0.4865) loss_oracle 0.4634 (0.4451) acc 43.7500 (59.4420) kd_loss 0.9182 (0.9168) lr 1.1253e-03 eta 0:22:52
epoch [25/50] batch [160/428] time 0.097 (0.122) data 0.000 (0.021) loss 2.5072 (2.5714) ce_loss 1.1416 (1.1863) loss_zs_kd 0.4909 (0.4853) loss_oracle 0.4496 (0.4495) acc 65.6250 (59.6875) kd_loss 0.8954 (0.9177) lr 1.1253e-03 eta 0:22:19
epoch [25/50] batch [180/428] time 0.083 (0.119) data 0.000 (0.018) loss 2.4386 (2.5701) ce_loss 1.0439 (1.1852) loss_zs_kd 0.5548 (0.4814) loss_oracle 0.4646 (0.4504) acc 71.8750 (59.7743) kd_loss 0.8849 (0.9191) lr 1.1253e-03 eta 0:21:44
epoch [25/50] batch [200/428] time 0.160 (0.120) data 0.000 (0.017) loss 2.7562 (2.5785) ce_loss 1.3359 (1.1906) loss_zs_kd 0.5141 (0.4807) loss_oracle 0.5063 (0.4520) acc 43.7500 (59.5156) kd_loss 0.9101 (0.9215) lr 1.1253e-03 eta 0:21:48
epoch [25/50] batch [220/428] time 0.183 (0.118) data 0.000 (0.015) loss 2.3048 (2.5783) ce_loss 0.8970 (1.1887) loss_zs_kd 0.5835 (0.4806) loss_oracle 0.4150 (0.4502) acc 81.2500 (59.5739) kd_loss 0.9086 (0.9243) lr 1.1253e-03 eta 0:21:23
epoch [25/50] batch [240/428] time 0.086 (0.118) data 0.000 (0.014) loss 2.4877 (2.5800) ce_loss 1.0879 (1.1888) loss_zs_kd 0.4374 (0.4799) loss_oracle 0.3926 (0.4491) acc 56.2500 (59.4922) kd_loss 0.9847 (0.9268) lr 1.1253e-03 eta 0:21:24
epoch [25/50] batch [260/428] time 0.090 (0.117) data 0.000 (0.013) loss 2.3549 (2.5788) ce_loss 0.9453 (1.1875) loss_zs_kd 0.4540 (0.4792) loss_oracle 0.5240 (0.4481) acc 78.1250 (59.4832) kd_loss 0.9206 (0.9276) lr 1.1253e-03 eta 0:21:07
epoch [25/50] batch [280/428] time 0.102 (0.115) data 0.000 (0.012) loss 2.6504 (2.5824) ce_loss 1.3164 (1.1895) loss_zs_kd 0.3905 (0.4795) loss_oracle 0.4003 (0.4491) acc 43.7500 (59.3973) kd_loss 0.9386 (0.9286) lr 1.1253e-03 eta 0:20:52
epoch [25/50] batch [300/428] time 0.108 (0.115) data 0.000 (0.011) loss 2.4296 (2.5804) ce_loss 1.0801 (1.1877) loss_zs_kd 0.4871 (0.4787) loss_oracle 0.4485 (0.4505) acc 65.6250 (59.4375) kd_loss 0.8818 (0.9281) lr 1.1253e-03 eta 0:20:40
epoch [25/50] batch [320/428] time 0.106 (0.114) data 0.000 (0.010) loss 2.6110 (2.5805) ce_loss 1.2295 (1.1874) loss_zs_kd 0.3808 (0.4772) loss_oracle 0.5701 (0.4524) acc 59.3750 (59.3359) kd_loss 0.9061 (0.9282) lr 1.1253e-03 eta 0:20:30
epoch [25/50] batch [340/428] time 0.107 (0.113) data 0.000 (0.010) loss 2.3549 (2.5796) ce_loss 0.9009 (1.1851) loss_zs_kd 0.5264 (0.4777) loss_oracle 0.4672 (0.4540) acc 68.7500 (59.4301) kd_loss 0.9573 (0.9286) lr 1.1253e-03 eta 0:20:21
epoch [25/50] batch [360/428] time 0.097 (0.113) data 0.000 (0.009) loss 2.3416 (2.5800) ce_loss 0.9839 (1.1847) loss_zs_kd 0.3583 (0.4767) loss_oracle 0.4646 (0.4563) acc 62.5000 (59.2795) kd_loss 0.9463 (0.9287) lr 1.1253e-03 eta 0:20:14
epoch [25/50] batch [380/428] time 0.108 (0.112) data 0.000 (0.009) loss 2.5171 (2.5821) ce_loss 1.1855 (1.1856) loss_zs_kd 0.4099 (0.4760) loss_oracle 0.4648 (0.4575) acc 65.6250 (59.1612) kd_loss 0.8942 (0.9298) lr 1.1253e-03 eta 0:20:06
epoch [25/50] batch [400/428] time 0.106 (0.112) data 0.000 (0.008) loss 2.5715 (2.5810) ce_loss 1.1748 (1.1826) loss_zs_kd 0.4532 (0.4771) loss_oracle 0.4226 (0.4577) acc 59.3750 (59.2422) kd_loss 0.9588 (0.9309) lr 1.1253e-03 eta 0:19:59
epoch [25/50] batch [420/428] time 0.074 (0.111) data 0.000 (0.008) loss 2.7287 (2.5806) ce_loss 1.3877 (1.1826) loss_zs_kd 0.3970 (0.4764) loss_oracle 0.4704 (0.4576) acc 59.3750 (59.3899) kd_loss 0.9073 (0.9310) lr 1.1253e-03 eta 0:19:43
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,641
* accuracy: 62.0%
* error: 38.0%
* macro_f1: 48.3%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,423
* accuracy: 51.1%
* error: 48.9%
* macro_f1: 30.5%
******* Domain 1 best val acc:      62.4%, epoch: 24 *******
******* Domain 1 best val test acc: 53.5%, epoch: 24 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [26/50] batch [20/428] time 0.092 (0.262) data 0.000 (0.163) loss 2.6885 (2.5588) ce_loss 1.3252 (1.1836) loss_zs_kd 0.5207 (0.4963) loss_oracle 0.4148 (0.4101) acc 56.2500 (59.6875) kd_loss 0.8956 (0.9220) lr 1.0628e-03 eta 0:46:32
epoch [26/50] batch [40/428] time 0.100 (0.180) data 0.000 (0.082) loss 2.3627 (2.5613) ce_loss 1.0859 (1.1916) loss_zs_kd 0.4792 (0.4898) loss_oracle 0.4123 (0.4183) acc 68.7500 (60.1562) kd_loss 0.8310 (0.9156) lr 1.0628e-03 eta 0:31:56
epoch [26/50] batch [60/428] time 0.085 (0.153) data 0.000 (0.055) loss 2.6607 (2.5572) ce_loss 1.2666 (1.1839) loss_zs_kd 0.4533 (0.4897) loss_oracle 0.3875 (0.4165) acc 53.1250 (60.1042) kd_loss 0.9737 (0.9202) lr 1.0628e-03 eta 0:27:02
epoch [26/50] batch [80/428] time 0.092 (0.139) data 0.000 (0.041) loss 2.6876 (2.5759) ce_loss 1.1621 (1.1875) loss_zs_kd 0.4833 (0.4885) loss_oracle 0.5113 (0.4238) acc 56.2500 (60.0000) kd_loss 1.0282 (0.9322) lr 1.0628e-03 eta 0:24:31
epoch [26/50] batch [100/428] time 0.103 (0.131) data 0.000 (0.033) loss 2.2667 (2.5657) ce_loss 0.8701 (1.1785) loss_zs_kd 0.4603 (0.4821) loss_oracle 0.4328 (0.4290) acc 71.8750 (60.3438) kd_loss 0.9500 (0.9317) lr 1.0628e-03 eta 0:23:08
epoch [26/50] batch [120/428] time 0.094 (0.126) data 0.000 (0.027) loss 2.4436 (2.5594) ce_loss 1.0459 (1.1727) loss_zs_kd 0.4257 (0.4804) loss_oracle 0.5016 (0.4344) acc 65.6250 (60.6250) kd_loss 0.9341 (0.9292) lr 1.0628e-03 eta 0:22:13
epoch [26/50] batch [140/428] time 0.104 (0.123) data 0.000 (0.024) loss 2.7886 (2.5638) ce_loss 1.2598 (1.1721) loss_zs_kd 0.5068 (0.4809) loss_oracle 0.5194 (0.4386) acc 56.2500 (60.7366) kd_loss 1.0158 (0.9319) lr 1.0628e-03 eta 0:21:38
epoch [26/50] batch [160/428] time 0.106 (0.121) data 0.000 (0.021) loss 2.5204 (2.5602) ce_loss 1.1406 (1.1692) loss_zs_kd 0.4899 (0.4791) loss_oracle 0.4632 (0.4398) acc 59.3750 (60.8398) kd_loss 0.9032 (0.9315) lr 1.0628e-03 eta 0:21:11
epoch [26/50] batch [180/428] time 0.078 (0.118) data 0.000 (0.018) loss 2.5946 (2.5622) ce_loss 1.2529 (1.1721) loss_zs_kd 0.4241 (0.4808) loss_oracle 0.4133 (0.4390) acc 53.1250 (60.3819) kd_loss 0.9230 (0.9301) lr 1.0628e-03 eta 0:20:38
epoch [26/50] batch [200/428] time 0.200 (0.118) data 0.000 (0.017) loss 2.9182 (2.5705) ce_loss 1.5684 (1.1816) loss_zs_kd 0.3290 (0.4787) loss_oracle 0.4960 (0.4400) acc 37.5000 (59.6406) kd_loss 0.9374 (0.9296) lr 1.0628e-03 eta 0:20:35
epoch [26/50] batch [220/428] time 0.095 (0.116) data 0.000 (0.015) loss 2.4294 (2.5798) ce_loss 1.1270 (1.1921) loss_zs_kd 0.4365 (0.4772) loss_oracle 0.3909 (0.4413) acc 65.6250 (59.3466) kd_loss 0.8888 (0.9285) lr 1.0628e-03 eta 0:20:17
epoch [26/50] batch [240/428] time 0.076 (0.117) data 0.000 (0.014) loss 2.6540 (2.5799) ce_loss 1.1904 (1.1908) loss_zs_kd 0.5337 (0.4749) loss_oracle 0.4448 (0.4430) acc 53.1250 (59.2708) kd_loss 0.9744 (0.9302) lr 1.0628e-03 eta 0:20:28
epoch [26/50] batch [260/428] time 0.098 (0.115) data 0.000 (0.013) loss 2.8484 (2.5786) ce_loss 1.3760 (1.1880) loss_zs_kd 0.4418 (0.4762) loss_oracle 0.5085 (0.4455) acc 50.0000 (59.5072) kd_loss 0.9972 (0.9298) lr 1.0628e-03 eta 0:20:02
epoch [26/50] batch [280/428] time 0.092 (0.114) data 0.000 (0.012) loss 2.4515 (2.5760) ce_loss 1.0898 (1.1874) loss_zs_kd 0.4693 (0.4728) loss_oracle 0.4856 (0.4466) acc 62.5000 (59.2634) kd_loss 0.8842 (0.9289) lr 1.0628e-03 eta 0:19:47
epoch [26/50] batch [300/428] time 0.100 (0.113) data 0.000 (0.011) loss 2.5241 (2.5731) ce_loss 1.1270 (1.1842) loss_zs_kd 0.4477 (0.4743) loss_oracle 0.4367 (0.4464) acc 65.6250 (59.4167) kd_loss 0.9550 (0.9286) lr 1.0628e-03 eta 0:19:35
epoch [26/50] batch [320/428] time 0.100 (0.112) data 0.000 (0.010) loss 2.3793 (2.5714) ce_loss 1.0332 (1.1832) loss_zs_kd 0.4749 (0.4736) loss_oracle 0.4519 (0.4471) acc 59.3750 (59.5312) kd_loss 0.8827 (0.9278) lr 1.0628e-03 eta 0:19:27
epoch [26/50] batch [340/428] time 0.096 (0.112) data 0.000 (0.010) loss 2.7924 (2.5738) ce_loss 1.4375 (1.1865) loss_zs_kd 0.5282 (0.4735) loss_oracle 0.4722 (0.4472) acc 59.3750 (59.4761) kd_loss 0.8548 (0.9269) lr 1.0628e-03 eta 0:19:16
epoch [26/50] batch [360/428] time 0.098 (0.111) data 0.000 (0.009) loss 2.6180 (2.5726) ce_loss 1.2676 (1.1863) loss_zs_kd 0.5196 (0.4738) loss_oracle 0.4491 (0.4481) acc 50.0000 (59.4792) kd_loss 0.8661 (0.9254) lr 1.0628e-03 eta 0:19:08
epoch [26/50] batch [380/428] time 0.112 (0.111) data 0.000 (0.009) loss 2.7094 (2.5745) ce_loss 1.3662 (1.1890) loss_zs_kd 0.4722 (0.4739) loss_oracle 0.4193 (0.4479) acc 59.3750 (59.3257) kd_loss 0.8974 (0.9247) lr 1.0628e-03 eta 0:19:01
epoch [26/50] batch [400/428] time 0.102 (0.110) data 0.000 (0.008) loss 2.5853 (2.5732) ce_loss 1.1738 (1.1881) loss_zs_kd 0.5085 (0.4749) loss_oracle 0.4816 (0.4473) acc 59.3750 (59.3906) kd_loss 0.9164 (0.9240) lr 1.0628e-03 eta 0:18:55
epoch [26/50] batch [420/428] time 0.071 (0.109) data 0.000 (0.008) loss 2.3257 (2.5704) ce_loss 1.0068 (1.1877) loss_zs_kd 0.4491 (0.4749) loss_oracle 0.3824 (0.4466) acc 62.5000 (59.3899) kd_loss 0.9030 (0.9219) lr 1.0628e-03 eta 0:18:39
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,628
* accuracy: 61.7%
* error: 38.3%
* macro_f1: 48.0%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,459
* accuracy: 51.9%
* error: 48.1%
* macro_f1: 31.0%
******* Domain 1 best val acc:      62.4%, epoch: 24 *******
******* Domain 1 best val test acc: 53.5%, epoch: 24 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [27/50] batch [20/428] time 0.096 (0.265) data 0.000 (0.170) loss 2.6226 (2.5062) ce_loss 1.3008 (1.2130) loss_zs_kd 0.4985 (0.4661) loss_oracle 0.4179 (0.3949) acc 50.0000 (59.2188) kd_loss 0.8636 (0.8626) lr 1.0000e-03 eta 0:45:14
epoch [27/50] batch [40/428] time 0.107 (0.183) data 0.000 (0.085) loss 2.7697 (2.4965) ce_loss 1.5146 (1.1929) loss_zs_kd 0.4148 (0.4699) loss_oracle 0.4442 (0.4113) acc 53.1250 (58.2812) kd_loss 0.8255 (0.8631) lr 1.0000e-03 eta 0:31:12
epoch [27/50] batch [60/428] time 0.097 (0.154) data 0.000 (0.057) loss 2.5972 (2.4899) ce_loss 1.2900 (1.1778) loss_zs_kd 0.4716 (0.4650) loss_oracle 0.4391 (0.4187) acc 56.2500 (60.0000) kd_loss 0.8518 (0.8702) lr 1.0000e-03 eta 0:26:08
epoch [27/50] batch [80/428] time 0.110 (0.141) data 0.000 (0.043) loss 2.6544 (2.4891) ce_loss 1.3994 (1.1836) loss_zs_kd 0.4034 (0.4692) loss_oracle 0.3934 (0.4152) acc 50.0000 (59.2969) kd_loss 0.8566 (0.8632) lr 1.0000e-03 eta 0:23:54
epoch [27/50] batch [100/428] time 0.108 (0.133) data 0.000 (0.034) loss 2.5399 (2.4861) ce_loss 1.2168 (1.1822) loss_zs_kd 0.4134 (0.4655) loss_oracle 0.4305 (0.4181) acc 68.7500 (59.8125) kd_loss 0.9011 (0.8621) lr 1.0000e-03 eta 0:22:31
epoch [27/50] batch [120/428] time 0.106 (0.127) data 0.000 (0.029) loss 2.5064 (2.4774) ce_loss 1.1523 (1.1749) loss_zs_kd 0.5146 (0.4628) loss_oracle 0.3933 (0.4198) acc 56.2500 (59.5312) kd_loss 0.9001 (0.8612) lr 1.0000e-03 eta 0:21:32
epoch [27/50] batch [140/428] time 0.092 (0.123) data 0.000 (0.025) loss 2.4449 (2.4720) ce_loss 1.0986 (1.1678) loss_zs_kd 0.3725 (0.4661) loss_oracle 0.4336 (0.4194) acc 62.5000 (59.6429) kd_loss 0.9432 (0.8615) lr 1.0000e-03 eta 0:20:51
epoch [27/50] batch [160/428] time 0.114 (0.121) data 0.000 (0.022) loss 2.4290 (2.4726) ce_loss 1.0596 (1.1655) loss_zs_kd 0.5789 (0.4671) loss_oracle 0.4121 (0.4200) acc 71.8750 (59.9219) kd_loss 0.8740 (0.8636) lr 1.0000e-03 eta 0:20:22
epoch [27/50] batch [180/428] time 0.078 (0.118) data 0.000 (0.019) loss 2.5248 (2.4791) ce_loss 1.1738 (1.1667) loss_zs_kd 0.4675 (0.4714) loss_oracle 0.4175 (0.4208) acc 71.8750 (60.0868) kd_loss 0.9085 (0.8663) lr 1.0000e-03 eta 0:19:48
epoch [27/50] batch [200/428] time 0.163 (0.116) data 0.000 (0.017) loss 2.3810 (2.4804) ce_loss 1.0312 (1.1694) loss_zs_kd 0.3297 (0.4674) loss_oracle 0.4883 (0.4207) acc 50.0000 (59.8438) kd_loss 0.9407 (0.8670) lr 1.0000e-03 eta 0:19:23
epoch [27/50] batch [220/428] time 0.060 (0.115) data 0.000 (0.016) loss 2.7057 (2.4910) ce_loss 1.3428 (1.1768) loss_zs_kd 0.4299 (0.4685) loss_oracle 0.3876 (0.4191) acc 53.1250 (59.5312) kd_loss 0.9542 (0.8704) lr 1.0000e-03 eta 0:19:14
epoch [27/50] batch [240/428] time 0.178 (0.115) data 0.000 (0.014) loss 2.6479 (2.4933) ce_loss 1.3311 (1.1782) loss_zs_kd 0.4795 (0.4682) loss_oracle 0.3174 (0.4160) acc 50.0000 (59.3620) kd_loss 0.9184 (0.8730) lr 1.0000e-03 eta 0:19:10
epoch [27/50] batch [260/428] time 0.086 (0.113) data 0.000 (0.013) loss 2.5502 (2.4962) ce_loss 1.0938 (1.1784) loss_zs_kd 0.5695 (0.4690) loss_oracle 0.3410 (0.4144) acc 71.8750 (59.3630) kd_loss 1.0012 (0.8761) lr 1.0000e-03 eta 0:18:49
epoch [27/50] batch [280/428] time 0.099 (0.112) data 0.000 (0.012) loss 2.4979 (2.4986) ce_loss 1.2041 (1.1791) loss_zs_kd 0.4671 (0.4697) loss_oracle 0.4515 (0.4139) acc 56.2500 (59.5424) kd_loss 0.8345 (0.8777) lr 1.0000e-03 eta 0:18:35
epoch [27/50] batch [300/428] time 0.089 (0.110) data 0.000 (0.012) loss 2.5107 (2.5004) ce_loss 1.1475 (1.1793) loss_zs_kd 0.5240 (0.4700) loss_oracle 0.3882 (0.4138) acc 65.6250 (59.4896) kd_loss 0.9072 (0.8792) lr 1.0000e-03 eta 0:18:21
epoch [27/50] batch [320/428] time 0.084 (0.110) data 0.000 (0.011) loss 2.7258 (2.5020) ce_loss 1.2920 (1.1782) loss_zs_kd 0.5003 (0.4718) loss_oracle 0.3913 (0.4107) acc 62.5000 (59.4824) kd_loss 0.9880 (0.8825) lr 1.0000e-03 eta 0:18:11
epoch [27/50] batch [340/428] time 0.107 (0.109) data 0.000 (0.010) loss 2.5724 (2.5053) ce_loss 1.1533 (1.1804) loss_zs_kd 0.5161 (0.4717) loss_oracle 0.4547 (0.4098) acc 62.5000 (59.5129) kd_loss 0.9337 (0.8841) lr 1.0000e-03 eta 0:18:02
epoch [27/50] batch [360/428] time 0.116 (0.109) data 0.000 (0.010) loss 2.5540 (2.5074) ce_loss 1.1650 (1.1813) loss_zs_kd 0.5342 (0.4711) loss_oracle 0.5073 (0.4099) acc 59.3750 (59.4358) kd_loss 0.8683 (0.8856) lr 1.0000e-03 eta 0:17:55
epoch [27/50] batch [380/428] time 0.097 (0.108) data 0.000 (0.009) loss 2.5379 (2.5079) ce_loss 1.2041 (1.1804) loss_zs_kd 0.4561 (0.4699) loss_oracle 0.4099 (0.4111) acc 62.5000 (59.5230) kd_loss 0.9007 (0.8870) lr 1.0000e-03 eta 0:17:50
epoch [27/50] batch [400/428] time 0.068 (0.108) data 0.000 (0.009) loss 2.8210 (2.5100) ce_loss 1.4492 (1.1803) loss_zs_kd 0.4909 (0.4703) loss_oracle 0.3767 (0.4108) acc 46.8750 (59.4375) kd_loss 0.9380 (0.8892) lr 1.0000e-03 eta 0:17:43
epoch [27/50] batch [420/428] time 0.094 (0.107) data 0.000 (0.008) loss 2.6818 (2.5108) ce_loss 1.3242 (1.1801) loss_zs_kd 0.3682 (0.4696) loss_oracle 0.4193 (0.4106) acc 53.1250 (59.4717) kd_loss 0.9639 (0.8906) lr 1.0000e-03 eta 0:17:35
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,678
* accuracy: 62.6%
* error: 37.4%
* macro_f1: 49.0%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,535
* accuracy: 53.5%
* error: 46.5%
* macro_f1: 31.2%
******* Domain 1 best val acc:      62.6%, epoch: 27 *******
******* Domain 1 best val test acc: 53.5%, epoch: 27 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [28/50] batch [20/428] time 0.087 (0.267) data 0.000 (0.173) loss 2.6956 (2.4677) ce_loss 1.3105 (1.1294) loss_zs_kd 0.5042 (0.4925) loss_oracle 0.4124 (0.4092) acc 59.3750 (61.8750) kd_loss 0.9267 (0.8874) lr 9.3721e-04 eta 0:43:42
epoch [28/50] batch [40/428] time 0.093 (0.181) data 0.000 (0.087) loss 2.8565 (2.5351) ce_loss 1.4756 (1.1801) loss_zs_kd 0.5316 (0.4780) loss_oracle 0.4010 (0.4135) acc 53.1250 (60.9375) kd_loss 0.9147 (0.9092) lr 9.3721e-04 eta 0:29:36
epoch [28/50] batch [60/428] time 0.093 (0.151) data 0.000 (0.058) loss 2.5140 (2.5312) ce_loss 1.1221 (1.1762) loss_zs_kd 0.4631 (0.4795) loss_oracle 0.4685 (0.4134) acc 59.3750 (60.4167) kd_loss 0.9261 (0.9085) lr 9.3721e-04 eta 0:24:36
epoch [28/50] batch [80/428] time 0.093 (0.136) data 0.000 (0.043) loss 2.2395 (2.5047) ce_loss 0.9897 (1.1641) loss_zs_kd 0.4164 (0.4694) loss_oracle 0.3754 (0.4114) acc 71.8750 (60.4297) kd_loss 0.8538 (0.9002) lr 9.3721e-04 eta 0:22:11
epoch [28/50] batch [100/428] time 0.078 (0.127) data 0.000 (0.035) loss 2.4364 (2.5009) ce_loss 1.1377 (1.1714) loss_zs_kd 0.4541 (0.4699) loss_oracle 0.3305 (0.4036) acc 65.6250 (60.1875) kd_loss 0.9064 (0.8928) lr 9.3721e-04 eta 0:20:38
epoch [28/50] batch [120/428] time 0.089 (0.124) data 0.000 (0.029) loss 2.6565 (2.5051) ce_loss 1.4150 (1.1769) loss_zs_kd 0.4125 (0.4705) loss_oracle 0.3902 (0.4000) acc 43.7500 (59.6875) kd_loss 0.8401 (0.8930) lr 9.3721e-04 eta 0:20:02
epoch [28/50] batch [140/428] time 0.125 (0.120) data 0.000 (0.025) loss 2.4623 (2.5055) ce_loss 1.0586 (1.1786) loss_zs_kd 0.5641 (0.4698) loss_oracle 0.3885 (0.3968) acc 62.5000 (59.5759) kd_loss 0.9274 (0.8936) lr 9.3721e-04 eta 0:19:26
epoch [28/50] batch [160/428] time 0.100 (0.118) data 0.000 (0.022) loss 2.3227 (2.5090) ce_loss 1.0996 (1.1825) loss_zs_kd 0.4632 (0.4717) loss_oracle 0.3345 (0.3944) acc 50.0000 (59.4531) kd_loss 0.8242 (0.8934) lr 9.3721e-04 eta 0:19:01
epoch [28/50] batch [180/428] time 0.108 (0.116) data 0.000 (0.019) loss 2.3792 (2.5016) ce_loss 1.0869 (1.1778) loss_zs_kd 0.5778 (0.4720) loss_oracle 0.3972 (0.3942) acc 56.2500 (59.3924) kd_loss 0.8048 (0.8907) lr 9.3721e-04 eta 0:18:44
epoch [28/50] batch [200/428] time 0.088 (0.113) data 0.000 (0.018) loss 2.5417 (2.5031) ce_loss 1.2061 (1.1776) loss_zs_kd 0.4393 (0.4733) loss_oracle 0.3907 (0.3935) acc 59.3750 (59.3281) kd_loss 0.9206 (0.8922) lr 9.3721e-04 eta 0:18:07
epoch [28/50] batch [220/428] time 0.081 (0.115) data 0.000 (0.016) loss 2.8914 (2.5101) ce_loss 1.5605 (1.1846) loss_zs_kd 0.4702 (0.4712) loss_oracle 0.4284 (0.3945) acc 53.1250 (59.1193) kd_loss 0.8815 (0.8927) lr 9.3721e-04 eta 0:18:23
epoch [28/50] batch [240/428] time 0.186 (0.113) data 0.000 (0.015) loss 2.3286 (2.5054) ce_loss 0.9517 (1.1787) loss_zs_kd 0.5438 (0.4737) loss_oracle 0.3717 (0.3957) acc 62.5000 (59.2448) kd_loss 0.9192 (0.8920) lr 9.3721e-04 eta 0:18:04
epoch [28/50] batch [260/428] time 0.081 (0.113) data 0.000 (0.014) loss 2.4665 (2.5019) ce_loss 1.2119 (1.1726) loss_zs_kd 0.4248 (0.4739) loss_oracle 0.4322 (0.3963) acc 56.2500 (59.3630) kd_loss 0.8261 (0.8942) lr 9.3721e-04 eta 0:18:05
epoch [28/50] batch [280/428] time 0.106 (0.112) data 0.000 (0.013) loss 2.6021 (2.5027) ce_loss 1.3760 (1.1731) loss_zs_kd 0.4910 (0.4733) loss_oracle 0.3549 (0.3969) acc 46.8750 (59.3638) kd_loss 0.8031 (0.8945) lr 9.3721e-04 eta 0:17:50
epoch [28/50] batch [300/428] time 0.111 (0.111) data 0.000 (0.012) loss 2.3975 (2.5026) ce_loss 1.0586 (1.1715) loss_zs_kd 0.5187 (0.4756) loss_oracle 0.4294 (0.3978) acc 68.7500 (59.5000) kd_loss 0.8649 (0.8943) lr 9.3721e-04 eta 0:17:43
epoch [28/50] batch [320/428] time 0.097 (0.111) data 0.000 (0.011) loss 2.5684 (2.5072) ce_loss 1.1953 (1.1738) loss_zs_kd 0.4487 (0.4758) loss_oracle 0.4094 (0.3989) acc 62.5000 (59.5117) kd_loss 0.9441 (0.8960) lr 9.3721e-04 eta 0:17:35
epoch [28/50] batch [340/428] time 0.101 (0.110) data 0.000 (0.010) loss 2.3979 (2.5100) ce_loss 1.1123 (1.1740) loss_zs_kd 0.4499 (0.4768) loss_oracle 0.3710 (0.4002) acc 68.7500 (59.6140) kd_loss 0.8751 (0.8975) lr 9.3721e-04 eta 0:17:29
epoch [28/50] batch [360/428] time 0.109 (0.110) data 0.000 (0.010) loss 2.1147 (2.5144) ce_loss 0.8174 (1.1757) loss_zs_kd 0.3682 (0.4761) loss_oracle 0.4428 (0.4006) acc 78.1250 (59.6267) kd_loss 0.8918 (0.9004) lr 9.3721e-04 eta 0:17:25
epoch [28/50] batch [380/428] time 0.098 (0.110) data 0.000 (0.009) loss 2.4516 (2.5157) ce_loss 1.0654 (1.1750) loss_zs_kd 0.5074 (0.4742) loss_oracle 0.3473 (0.4012) acc 59.3750 (59.5395) kd_loss 0.9588 (0.9031) lr 9.3721e-04 eta 0:17:19
epoch [28/50] batch [400/428] time 0.105 (0.110) data 0.000 (0.009) loss 2.8447 (2.5184) ce_loss 1.5469 (1.1759) loss_zs_kd 0.4639 (0.4739) loss_oracle 0.3486 (0.3999) acc 50.0000 (59.5703) kd_loss 0.8916 (0.9056) lr 9.3721e-04 eta 0:17:15
epoch [28/50] batch [420/428] time 0.100 (0.109) data 0.000 (0.009) loss 2.3499 (2.5198) ce_loss 1.0264 (1.1768) loss_zs_kd 0.5032 (0.4732) loss_oracle 0.4231 (0.3997) acc 68.7500 (59.5610) kd_loss 0.8604 (0.9065) lr 9.3721e-04 eta 0:17:09
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,598
* accuracy: 61.2%
* error: 38.8%
* macro_f1: 48.3%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,532
* accuracy: 53.4%
* error: 46.6%
* macro_f1: 31.4%
******* Domain 1 best val acc:      62.6%, epoch: 27 *******
******* Domain 1 best val test acc: 53.5%, epoch: 27 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [29/50] batch [20/428] time 0.183 (0.268) data 0.000 (0.172) loss 2.5788 (2.6046) ce_loss 1.1650 (1.2107) loss_zs_kd 0.5185 (0.4749) loss_oracle 0.4497 (0.4215) acc 59.3750 (55.7812) kd_loss 0.9297 (0.9457) lr 8.7467e-04 eta 0:42:02
epoch [29/50] batch [40/428] time 0.070 (0.191) data 0.000 (0.086) loss 2.5546 (2.5694) ce_loss 1.2129 (1.1766) loss_zs_kd 0.3692 (0.4708) loss_oracle 0.4097 (0.4234) acc 59.3750 (58.3594) kd_loss 0.9523 (0.9457) lr 8.7467e-04 eta 0:29:52
epoch [29/50] batch [60/428] time 0.097 (0.160) data 0.000 (0.057) loss 2.6568 (2.5546) ce_loss 1.3594 (1.1677) loss_zs_kd 0.3533 (0.4630) loss_oracle 0.3673 (0.4213) acc 43.7500 (59.5312) kd_loss 0.9371 (0.9447) lr 8.7467e-04 eta 0:24:53
epoch [29/50] batch [80/428] time 0.114 (0.146) data 0.000 (0.043) loss 2.3820 (2.5442) ce_loss 0.9927 (1.1673) loss_zs_kd 0.6336 (0.4713) loss_oracle 0.3541 (0.4140) acc 71.8750 (59.2578) kd_loss 0.8955 (0.9343) lr 8.7467e-04 eta 0:22:38
epoch [29/50] batch [100/428] time 0.100 (0.136) data 0.000 (0.035) loss 2.3774 (2.5308) ce_loss 1.0127 (1.1601) loss_zs_kd 0.4847 (0.4781) loss_oracle 0.4387 (0.4102) acc 59.3750 (59.5938) kd_loss 0.9030 (0.9266) lr 8.7467e-04 eta 0:21:06
epoch [29/50] batch [120/428] time 0.109 (0.131) data 0.000 (0.029) loss 2.5683 (2.5354) ce_loss 1.1816 (1.1676) loss_zs_kd 0.4914 (0.4803) loss_oracle 0.3481 (0.4107) acc 59.3750 (59.4792) kd_loss 0.9670 (0.9223) lr 8.7467e-04 eta 0:20:13
epoch [29/50] batch [140/428] time 0.093 (0.126) data 0.000 (0.025) loss 2.4484 (2.5361) ce_loss 1.0801 (1.1692) loss_zs_kd 0.4555 (0.4794) loss_oracle 0.3750 (0.4118) acc 65.6250 (59.5982) kd_loss 0.9531 (0.9213) lr 8.7467e-04 eta 0:19:28
epoch [29/50] batch [160/428] time 0.096 (0.122) data 0.000 (0.022) loss 2.5387 (2.5403) ce_loss 1.1768 (1.1762) loss_zs_kd 0.5899 (0.4783) loss_oracle 0.4197 (0.4132) acc 53.1250 (59.1992) kd_loss 0.8571 (0.9184) lr 8.7467e-04 eta 0:18:53
epoch [29/50] batch [180/428] time 0.091 (0.120) data 0.000 (0.019) loss 2.3699 (2.5388) ce_loss 0.9609 (1.1763) loss_zs_kd 0.5434 (0.4768) loss_oracle 0.4037 (0.4144) acc 71.8750 (59.1840) kd_loss 0.9354 (0.9169) lr 8.7467e-04 eta 0:18:28
epoch [29/50] batch [200/428] time 0.095 (0.118) data 0.000 (0.017) loss 2.4755 (2.5337) ce_loss 1.0547 (1.1726) loss_zs_kd 0.3604 (0.4771) loss_oracle 0.4531 (0.4141) acc 75.0000 (59.6406) kd_loss 1.0141 (0.9156) lr 8.7467e-04 eta 0:18:07
epoch [29/50] batch [220/428] time 0.093 (0.115) data 0.000 (0.016) loss 2.5409 (2.5289) ce_loss 1.2002 (1.1709) loss_zs_kd 0.5577 (0.4732) loss_oracle 0.4105 (0.4147) acc 56.2500 (59.7443) kd_loss 0.8566 (0.9141) lr 8.7467e-04 eta 0:17:40
epoch [29/50] batch [240/428] time 0.148 (0.116) data 0.001 (0.015) loss 2.5557 (2.5265) ce_loss 1.1738 (1.1719) loss_zs_kd 0.4917 (0.4718) loss_oracle 0.4291 (0.4144) acc 56.2500 (59.6354) kd_loss 0.9215 (0.9115) lr 8.7467e-04 eta 0:17:44
epoch [29/50] batch [260/428] time 0.092 (0.114) data 0.000 (0.013) loss 2.5101 (2.5283) ce_loss 1.0713 (1.1722) loss_zs_kd 0.4191 (0.4724) loss_oracle 0.4243 (0.4144) acc 65.6250 (59.5793) kd_loss 1.0171 (0.9127) lr 8.7467e-04 eta 0:17:22
epoch [29/50] batch [280/428] time 0.083 (0.115) data 0.000 (0.013) loss 2.7146 (2.5322) ce_loss 1.3408 (1.1754) loss_zs_kd 0.4315 (0.4717) loss_oracle 0.4029 (0.4167) acc 53.1250 (59.4754) kd_loss 0.9565 (0.9126) lr 8.7467e-04 eta 0:17:33
epoch [29/50] batch [300/428] time 0.110 (0.114) data 0.000 (0.012) loss 2.6537 (2.5306) ce_loss 1.3359 (1.1762) loss_zs_kd 0.5769 (0.4713) loss_oracle 0.3825 (0.4173) acc 53.1250 (59.4792) kd_loss 0.8381 (0.9101) lr 8.7467e-04 eta 0:17:14
epoch [29/50] batch [320/428] time 0.090 (0.113) data 0.000 (0.011) loss 2.3236 (2.5298) ce_loss 1.0479 (1.1762) loss_zs_kd 0.4546 (0.4707) loss_oracle 0.4189 (0.4175) acc 56.2500 (59.5117) kd_loss 0.8390 (0.9095) lr 8.7467e-04 eta 0:17:04
epoch [29/50] batch [340/428] time 0.100 (0.112) data 0.000 (0.010) loss 2.2400 (2.5279) ce_loss 0.9741 (1.1750) loss_zs_kd 0.4935 (0.4706) loss_oracle 0.4688 (0.4180) acc 71.8750 (59.5680) kd_loss 0.7847 (0.9086) lr 8.7467e-04 eta 0:16:56
epoch [29/50] batch [360/428] time 0.101 (0.111) data 0.000 (0.010) loss 2.5630 (2.5288) ce_loss 1.1162 (1.1766) loss_zs_kd 0.4905 (0.4708) loss_oracle 0.4894 (0.4188) acc 68.7500 (59.4358) kd_loss 0.9569 (0.9074) lr 8.7467e-04 eta 0:16:48
epoch [29/50] batch [380/428] time 0.115 (0.111) data 0.000 (0.009) loss 2.4877 (2.5295) ce_loss 1.2529 (1.1771) loss_zs_kd 0.3804 (0.4703) loss_oracle 0.4234 (0.4188) acc 59.3750 (59.5148) kd_loss 0.8328 (0.9078) lr 8.7467e-04 eta 0:16:40
epoch [29/50] batch [400/428] time 0.101 (0.110) data 0.000 (0.009) loss 2.5000 (2.5337) ce_loss 1.1426 (1.1789) loss_zs_kd 0.4539 (0.4708) loss_oracle 0.4280 (0.4191) acc 68.7500 (59.5078) kd_loss 0.9165 (0.9098) lr 8.7467e-04 eta 0:16:33
epoch [29/50] batch [420/428] time 0.095 (0.110) data 0.000 (0.008) loss 2.6662 (2.5356) ce_loss 1.1377 (1.1794) loss_zs_kd 0.5590 (0.4707) loss_oracle 0.4274 (0.4194) acc 68.7500 (59.4643) kd_loss 1.0354 (0.9111) lr 8.7467e-04 eta 0:16:26
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,684
* accuracy: 62.7%
* error: 37.3%
* macro_f1: 48.6%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,345
* accuracy: 49.5%
* error: 50.5%
* macro_f1: 29.6%
******* Domain 1 best val acc:      62.7%, epoch: 29 *******
******* Domain 1 best val test acc: 49.5%, epoch: 29 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [30/50] batch [20/428] time 0.082 (0.272) data 0.000 (0.188) loss 2.5542 (2.5808) ce_loss 1.1406 (1.1971) loss_zs_kd 0.4399 (0.4810) loss_oracle 0.4394 (0.4304) acc 59.3750 (58.2812) kd_loss 0.9739 (0.9280) lr 8.1262e-04 eta 0:40:36
epoch [30/50] batch [40/428] time 0.081 (0.200) data 0.000 (0.094) loss 2.7217 (2.5952) ce_loss 1.3574 (1.2052) loss_zs_kd 0.5240 (0.4723) loss_oracle 0.3578 (0.4247) acc 59.3750 (57.6562) kd_loss 0.9233 (0.9414) lr 8.1262e-04 eta 0:29:50
epoch [30/50] batch [60/428] time 0.079 (0.160) data 0.001 (0.063) loss 2.7000 (2.5794) ce_loss 1.3125 (1.2032) loss_zs_kd 0.4105 (0.4635) loss_oracle 0.4713 (0.4209) acc 53.1250 (58.4896) kd_loss 0.9466 (0.9340) lr 8.1262e-04 eta 0:23:45
epoch [30/50] batch [80/428] time 0.109 (0.145) data 0.000 (0.047) loss 2.4641 (2.5806) ce_loss 1.0645 (1.2000) loss_zs_kd 0.4633 (0.4723) loss_oracle 0.4739 (0.4217) acc 56.2500 (59.1016) kd_loss 0.9311 (0.9336) lr 8.1262e-04 eta 0:21:28
epoch [30/50] batch [100/428] time 0.108 (0.136) data 0.000 (0.038) loss 2.6670 (2.5854) ce_loss 1.2520 (1.2026) loss_zs_kd 0.4920 (0.4732) loss_oracle 0.4321 (0.4209) acc 53.1250 (59.2812) kd_loss 0.9530 (0.9357) lr 8.1262e-04 eta 0:20:07
epoch [30/50] batch [120/428] time 0.098 (0.130) data 0.000 (0.031) loss 2.1910 (2.5762) ce_loss 0.8657 (1.1978) loss_zs_kd 0.5314 (0.4731) loss_oracle 0.4099 (0.4199) acc 75.0000 (59.1146) kd_loss 0.8547 (0.9319) lr 8.1262e-04 eta 0:19:12
epoch [30/50] batch [140/428] time 0.115 (0.126) data 0.000 (0.027) loss 2.5620 (2.5653) ce_loss 1.2012 (1.1889) loss_zs_kd 0.5430 (0.4752) loss_oracle 0.3254 (0.4187) acc 62.5000 (59.3750) kd_loss 0.9267 (0.9296) lr 8.1262e-04 eta 0:18:35
epoch [30/50] batch [160/428] time 0.089 (0.123) data 0.000 (0.024) loss 2.6694 (2.5696) ce_loss 1.3066 (1.1916) loss_zs_kd 0.4058 (0.4714) loss_oracle 0.3573 (0.4179) acc 53.1250 (59.1211) kd_loss 0.9812 (0.9333) lr 8.1262e-04 eta 0:18:04
epoch [30/50] batch [180/428] time 0.101 (0.121) data 0.000 (0.021) loss 2.5226 (2.5691) ce_loss 1.1543 (1.1899) loss_zs_kd 0.3754 (0.4749) loss_oracle 0.4482 (0.4175) acc 53.1250 (59.1493) kd_loss 0.9566 (0.9330) lr 8.1262e-04 eta 0:17:41
epoch [30/50] batch [200/428] time 0.109 (0.119) data 0.000 (0.019) loss 2.5927 (2.5687) ce_loss 1.2588 (1.1895) loss_zs_kd 0.5407 (0.4771) loss_oracle 0.4394 (0.4153) acc 50.0000 (59.0625) kd_loss 0.8439 (0.9330) lr 8.1262e-04 eta 0:17:22
epoch [30/50] batch [220/428] time 0.111 (0.117) data 0.000 (0.017) loss 2.5042 (2.5614) ce_loss 1.1162 (1.1804) loss_zs_kd 0.5589 (0.4799) loss_oracle 0.4271 (0.4158) acc 62.5000 (59.4602) kd_loss 0.8950 (0.9331) lr 8.1262e-04 eta 0:17:05
epoch [30/50] batch [240/428] time 0.085 (0.114) data 0.000 (0.016) loss 2.6080 (2.5651) ce_loss 1.1934 (1.1854) loss_zs_kd 0.4692 (0.4792) loss_oracle 0.4464 (0.4169) acc 59.3750 (59.3099) kd_loss 0.9568 (0.9316) lr 8.1262e-04 eta 0:16:39
epoch [30/50] batch [260/428] time 0.157 (0.114) data 0.001 (0.015) loss 2.1815 (2.5557) ce_loss 0.9375 (1.1794) loss_zs_kd 0.4193 (0.4773) loss_oracle 0.3863 (0.4183) acc 68.7500 (59.4712) kd_loss 0.8412 (0.9285) lr 8.1262e-04 eta 0:16:31
epoch [30/50] batch [280/428] time 0.087 (0.114) data 0.000 (0.014) loss 2.4831 (2.5511) ce_loss 1.1602 (1.1776) loss_zs_kd 0.4348 (0.4783) loss_oracle 0.4188 (0.4190) acc 68.7500 (59.5424) kd_loss 0.8962 (0.9248) lr 8.1262e-04 eta 0:16:29
epoch [30/50] batch [300/428] time 0.169 (0.113) data 0.000 (0.013) loss 2.3081 (2.5482) ce_loss 1.0215 (1.1781) loss_zs_kd 0.4527 (0.4770) loss_oracle 0.3274 (0.4182) acc 68.7500 (59.6354) kd_loss 0.8966 (0.9225) lr 8.1262e-04 eta 0:16:23
epoch [30/50] batch [320/428] time 0.064 (0.112) data 0.000 (0.012) loss 2.4544 (2.5467) ce_loss 1.1279 (1.1803) loss_zs_kd 0.5587 (0.4760) loss_oracle 0.4247 (0.4174) acc 62.5000 (59.5996) kd_loss 0.8348 (0.9196) lr 8.1262e-04 eta 0:16:10
epoch [30/50] batch [340/428] time 0.088 (0.110) data 0.000 (0.011) loss 2.3821 (2.5442) ce_loss 1.1533 (1.1807) loss_zs_kd 0.4965 (0.4745) loss_oracle 0.4245 (0.4175) acc 53.1250 (59.5588) kd_loss 0.7683 (0.9174) lr 8.1262e-04 eta 0:15:48
epoch [30/50] batch [360/428] time 0.093 (0.108) data 0.000 (0.011) loss 2.5070 (2.5440) ce_loss 1.0977 (1.1826) loss_zs_kd 0.4814 (0.4742) loss_oracle 0.4887 (0.4184) acc 65.6250 (59.5139) kd_loss 0.9243 (0.9151) lr 8.1262e-04 eta 0:15:36
epoch [30/50] batch [380/428] time 0.086 (0.107) data 0.000 (0.010) loss 2.5645 (2.5425) ce_loss 1.1484 (1.1821) loss_zs_kd 0.5189 (0.4747) loss_oracle 0.4640 (0.4201) acc 59.3750 (59.4819) kd_loss 0.9246 (0.9129) lr 8.1262e-04 eta 0:15:24
epoch [30/50] batch [400/428] time 0.089 (0.107) data 0.000 (0.010) loss 2.4165 (2.5399) ce_loss 1.0840 (1.1813) loss_zs_kd 0.3604 (0.4737) loss_oracle 0.5200 (0.4224) acc 59.3750 (59.4297) kd_loss 0.8923 (0.9105) lr 8.1262e-04 eta 0:15:14
epoch [30/50] batch [420/428] time 0.092 (0.106) data 0.000 (0.009) loss 2.4851 (2.5412) ce_loss 1.2314 (1.1834) loss_zs_kd 0.3667 (0.4737) loss_oracle 0.4137 (0.4239) acc 65.6250 (59.2932) kd_loss 0.8634 (0.9090) lr 8.1262e-04 eta 0:15:05
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,569
* accuracy: 60.7%
* error: 39.3%
* macro_f1: 49.0%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,599
* accuracy: 54.8%
* error: 45.2%
* macro_f1: 31.6%
******* Domain 1 best val acc:      62.7%, epoch: 29 *******
******* Domain 1 best val test acc: 49.5%, epoch: 29 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [31/50] batch [20/428] time 0.101 (0.243) data 0.000 (0.140) loss 2.7553 (2.5991) ce_loss 1.3828 (1.2441) loss_zs_kd 0.5236 (0.4632) loss_oracle 0.4619 (0.4655) acc 53.1250 (55.7812) kd_loss 0.8797 (0.8906) lr 7.5131e-04 eta 0:34:34
epoch [31/50] batch [40/428] time 0.097 (0.173) data 0.000 (0.070) loss 2.4523 (2.5593) ce_loss 1.1875 (1.2103) loss_zs_kd 0.4143 (0.4760) loss_oracle 0.4128 (0.4514) acc 65.6250 (58.1250) kd_loss 0.8513 (0.8853) lr 7.5131e-04 eta 0:24:31
epoch [31/50] batch [60/428] time 0.091 (0.145) data 0.001 (0.047) loss 2.5182 (2.5540) ce_loss 1.1143 (1.2094) loss_zs_kd 0.4867 (0.4661) loss_oracle 0.4022 (0.4457) acc 56.2500 (56.9792) kd_loss 0.9596 (0.8887) lr 7.5131e-04 eta 0:20:31
epoch [31/50] batch [80/428] time 0.088 (0.130) data 0.000 (0.035) loss 2.4483 (2.5505) ce_loss 1.1504 (1.2139) loss_zs_kd 0.3967 (0.4633) loss_oracle 0.4559 (0.4442) acc 53.1250 (57.3828) kd_loss 0.8716 (0.8828) lr 7.5131e-04 eta 0:18:21
epoch [31/50] batch [100/428] time 0.085 (0.121) data 0.000 (0.028) loss 2.6617 (2.5556) ce_loss 1.2988 (1.2194) loss_zs_kd 0.5084 (0.4624) loss_oracle 0.4424 (0.4453) acc 59.3750 (56.9375) kd_loss 0.8874 (0.8824) lr 7.5131e-04 eta 0:17:03
epoch [31/50] batch [120/428] time 0.087 (0.114) data 0.000 (0.024) loss 2.2965 (2.5384) ce_loss 0.9331 (1.2011) loss_zs_kd 0.4796 (0.4625) loss_oracle 0.5071 (0.4504) acc 62.5000 (57.6302) kd_loss 0.8700 (0.8809) lr 7.5131e-04 eta 0:16:04
epoch [31/50] batch [140/428] time 0.088 (0.110) data 0.000 (0.020) loss 2.3293 (2.5369) ce_loss 1.0098 (1.1968) loss_zs_kd 0.3709 (0.4650) loss_oracle 0.4768 (0.4526) acc 62.5000 (57.7679) kd_loss 0.8957 (0.8813) lr 7.5131e-04 eta 0:15:28
epoch [31/50] batch [160/428] time 0.083 (0.107) data 0.000 (0.018) loss 2.5414 (2.5372) ce_loss 1.1436 (1.1909) loss_zs_kd 0.4793 (0.4654) loss_oracle 0.5395 (0.4538) acc 68.7500 (58.1250) kd_loss 0.8885 (0.8866) lr 7.5131e-04 eta 0:15:01
epoch [31/50] batch [180/428] time 0.082 (0.105) data 0.000 (0.016) loss 2.5509 (2.5332) ce_loss 1.1562 (1.1852) loss_zs_kd 0.4858 (0.4652) loss_oracle 0.4124 (0.4526) acc 68.7500 (58.5243) kd_loss 0.9456 (0.8891) lr 7.5131e-04 eta 0:14:38
epoch [31/50] batch [200/428] time 0.118 (0.104) data 0.000 (0.014) loss 2.6794 (2.5394) ce_loss 1.3291 (1.1881) loss_zs_kd 0.4252 (0.4675) loss_oracle 0.4808 (0.4512) acc 50.0000 (58.5000) kd_loss 0.8973 (0.8919) lr 7.5131e-04 eta 0:14:27
epoch [31/50] batch [220/428] time 0.097 (0.103) data 0.000 (0.013) loss 2.6615 (2.5383) ce_loss 1.2812 (1.1841) loss_zs_kd 0.4814 (0.4723) loss_oracle 0.4453 (0.4498) acc 56.2500 (58.6932) kd_loss 0.9169 (0.8932) lr 7.5131e-04 eta 0:14:20
epoch [31/50] batch [240/428] time 0.081 (0.101) data 0.000 (0.012) loss 2.4482 (2.5415) ce_loss 1.0283 (1.1832) loss_zs_kd 0.6271 (0.4731) loss_oracle 0.4476 (0.4485) acc 65.6250 (58.7240) kd_loss 0.8825 (0.8975) lr 7.5131e-04 eta 0:14:03
epoch [31/50] batch [260/428] time 0.080 (0.100) data 0.000 (0.011) loss 2.2785 (2.5435) ce_loss 0.9995 (1.1846) loss_zs_kd 0.3997 (0.4735) loss_oracle 0.4889 (0.4478) acc 68.7500 (58.7861) kd_loss 0.8347 (0.8982) lr 7.5131e-04 eta 0:13:47
epoch [31/50] batch [280/428] time 0.088 (0.099) data 0.000 (0.010) loss 2.6439 (2.5458) ce_loss 1.2646 (1.1877) loss_zs_kd 0.4724 (0.4721) loss_oracle 0.4544 (0.4483) acc 50.0000 (58.6607) kd_loss 0.9159 (0.8979) lr 7.5131e-04 eta 0:13:36
epoch [31/50] batch [300/428] time 0.099 (0.098) data 0.000 (0.010) loss 2.2395 (2.5406) ce_loss 0.9292 (1.1817) loss_zs_kd 0.4892 (0.4744) loss_oracle 0.4108 (0.4465) acc 75.0000 (58.9688) kd_loss 0.8602 (0.8985) lr 7.5131e-04 eta 0:13:28
epoch [31/50] batch [320/428] time 0.093 (0.098) data 0.000 (0.009) loss 2.5644 (2.5388) ce_loss 1.1318 (1.1795) loss_zs_kd 0.5370 (0.4760) loss_oracle 0.4730 (0.4452) acc 71.8750 (59.1309) kd_loss 0.9276 (0.8987) lr 7.5131e-04 eta 0:13:28
epoch [31/50] batch [340/428] time 0.113 (0.098) data 0.000 (0.008) loss 2.4650 (2.5372) ce_loss 1.1211 (1.1794) loss_zs_kd 0.5648 (0.4743) loss_oracle 0.4652 (0.4455) acc 62.5000 (59.0533) kd_loss 0.8289 (0.8979) lr 7.5131e-04 eta 0:13:27
epoch [31/50] batch [360/428] time 0.097 (0.098) data 0.000 (0.008) loss 2.4057 (2.5355) ce_loss 1.0889 (1.1789) loss_zs_kd 0.3854 (0.4736) loss_oracle 0.4097 (0.4462) acc 62.5000 (59.1146) kd_loss 0.9193 (0.8968) lr 7.5131e-04 eta 0:13:27
epoch [31/50] batch [380/428] time 0.095 (0.099) data 0.000 (0.008) loss 2.7031 (2.5340) ce_loss 1.4365 (1.1785) loss_zs_kd 0.5499 (0.4737) loss_oracle 0.4695 (0.4464) acc 53.1250 (59.1283) kd_loss 0.7569 (0.8954) lr 7.5131e-04 eta 0:13:25
epoch [31/50] batch [400/428] time 0.100 (0.099) data 0.000 (0.007) loss 2.3886 (2.5305) ce_loss 0.9619 (1.1757) loss_zs_kd 0.5778 (0.4745) loss_oracle 0.5078 (0.4471) acc 68.7500 (59.2578) kd_loss 0.8839 (0.8940) lr 7.5131e-04 eta 0:13:24
epoch [31/50] batch [420/428] time 0.092 (0.099) data 0.000 (0.007) loss 2.6544 (2.5274) ce_loss 1.3955 (1.1737) loss_zs_kd 0.4796 (0.4753) loss_oracle 0.4455 (0.4470) acc 50.0000 (59.3601) kd_loss 0.7963 (0.8926) lr 7.5131e-04 eta 0:13:23
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,548
* accuracy: 60.4%
* error: 39.6%
* macro_f1: 48.5%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,634
* accuracy: 55.6%
* error: 44.4%
* macro_f1: 31.7%
******* Domain 1 best val acc:      62.7%, epoch: 29 *******
******* Domain 1 best val test acc: 49.5%, epoch: 29 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [32/50] batch [20/428] time 0.070 (0.320) data 0.000 (0.188) loss 2.0962 (2.4874) ce_loss 0.8003 (1.1799) loss_zs_kd 0.3689 (0.4529) loss_oracle 0.4043 (0.4335) acc 78.1250 (60.1562) kd_loss 0.9093 (0.8643) lr 6.9098e-04 eta 0:43:16
epoch [32/50] batch [40/428] time 0.070 (0.218) data 0.000 (0.094) loss 2.6277 (2.4786) ce_loss 1.2822 (1.1743) loss_zs_kd 0.5247 (0.4673) loss_oracle 0.4127 (0.4262) acc 50.0000 (59.0625) kd_loss 0.8767 (0.8576) lr 6.9098e-04 eta 0:29:24
epoch [32/50] batch [60/428] time 0.105 (0.176) data 0.000 (0.063) loss 2.3943 (2.4638) ce_loss 1.0801 (1.1518) loss_zs_kd 0.4283 (0.4764) loss_oracle 0.5141 (0.4306) acc 65.6250 (59.8438) kd_loss 0.8430 (0.8584) lr 6.9098e-04 eta 0:23:40
epoch [32/50] batch [80/428] time 0.091 (0.156) data 0.000 (0.047) loss 2.3847 (2.4596) ce_loss 1.0859 (1.1516) loss_zs_kd 0.4970 (0.4722) loss_oracle 0.4523 (0.4290) acc 62.5000 (60.2734) kd_loss 0.8241 (0.8574) lr 6.9098e-04 eta 0:20:56
epoch [32/50] batch [100/428] time 0.113 (0.144) data 0.000 (0.038) loss 2.6061 (2.4634) ce_loss 1.2568 (1.1566) loss_zs_kd 0.5108 (0.4682) loss_oracle 0.4672 (0.4333) acc 65.6250 (60.1875) kd_loss 0.8602 (0.8560) lr 6.9098e-04 eta 0:19:19
epoch [32/50] batch [120/428] time 0.083 (0.136) data 0.000 (0.032) loss 2.4257 (2.4742) ce_loss 1.2256 (1.1679) loss_zs_kd 0.3678 (0.4628) loss_oracle 0.4879 (0.4397) acc 62.5000 (59.2188) kd_loss 0.7723 (0.8550) lr 6.9098e-04 eta 0:18:11
epoch [32/50] batch [140/428] time 0.096 (0.131) data 0.001 (0.027) loss 2.4273 (2.4761) ce_loss 1.0938 (1.1672) loss_zs_kd 0.5023 (0.4647) loss_oracle 0.4459 (0.4437) acc 56.2500 (59.3304) kd_loss 0.8594 (0.8547) lr 6.9098e-04 eta 0:17:27
epoch [32/50] batch [160/428] time 0.097 (0.127) data 0.000 (0.024) loss 2.2964 (2.4784) ce_loss 0.9570 (1.1737) loss_zs_kd 0.4330 (0.4627) loss_oracle 0.4062 (0.4437) acc 65.6250 (59.0430) kd_loss 0.9198 (0.8515) lr 6.9098e-04 eta 0:16:51
epoch [32/50] batch [180/428] time 0.094 (0.125) data 0.000 (0.021) loss 2.4654 (2.4804) ce_loss 1.1670 (1.1753) loss_zs_kd 0.4885 (0.4647) loss_oracle 0.3829 (0.4401) acc 62.5000 (59.0799) kd_loss 0.8628 (0.8527) lr 6.9098e-04 eta 0:16:31
epoch [32/50] batch [200/428] time 0.095 (0.122) data 0.000 (0.019) loss 2.3624 (2.4838) ce_loss 0.9497 (1.1782) loss_zs_kd 0.5226 (0.4650) loss_oracle 0.3579 (0.4374) acc 53.1250 (58.9688) kd_loss 0.9724 (0.8545) lr 6.9098e-04 eta 0:16:07
epoch [32/50] batch [220/428] time 0.093 (0.120) data 0.000 (0.017) loss 2.6374 (2.4821) ce_loss 1.2432 (1.1772) loss_zs_kd 0.4415 (0.4675) loss_oracle 0.3805 (0.4355) acc 50.0000 (59.0199) kd_loss 0.9832 (0.8533) lr 6.9098e-04 eta 0:15:48
epoch [32/50] batch [240/428] time 0.174 (0.119) data 0.000 (0.016) loss 2.6920 (2.4810) ce_loss 1.3311 (1.1751) loss_zs_kd 0.5158 (0.4697) loss_oracle 0.4338 (0.4345) acc 62.5000 (59.1797) kd_loss 0.8861 (0.8538) lr 6.9098e-04 eta 0:15:38
epoch [32/50] batch [260/428] time 0.071 (0.118) data 0.000 (0.015) loss 2.2636 (2.4836) ce_loss 0.9717 (1.1781) loss_zs_kd 0.4411 (0.4709) loss_oracle 0.4368 (0.4333) acc 62.5000 (59.0385) kd_loss 0.8530 (0.8534) lr 6.9098e-04 eta 0:15:32
epoch [32/50] batch [280/428] time 0.090 (0.118) data 0.000 (0.014) loss 2.9207 (2.4851) ce_loss 1.6396 (1.1779) loss_zs_kd 0.3664 (0.4706) loss_oracle 0.4468 (0.4340) acc 46.8750 (59.0179) kd_loss 0.8744 (0.8549) lr 6.9098e-04 eta 0:15:26
epoch [32/50] batch [300/428] time 0.080 (0.116) data 0.000 (0.013) loss 2.4777 (2.4831) ce_loss 1.1475 (1.1773) loss_zs_kd 0.4370 (0.4697) loss_oracle 0.4429 (0.4331) acc 53.1250 (59.0104) kd_loss 0.8903 (0.8544) lr 6.9098e-04 eta 0:15:09
epoch [32/50] batch [320/428] time 0.102 (0.115) data 0.000 (0.012) loss 2.5713 (2.4815) ce_loss 1.2988 (1.1749) loss_zs_kd 0.4635 (0.4706) loss_oracle 0.3620 (0.4315) acc 50.0000 (59.1699) kd_loss 0.8597 (0.8556) lr 6.9098e-04 eta 0:14:54
epoch [32/50] batch [340/428] time 0.091 (0.113) data 0.000 (0.011) loss 2.2528 (2.4794) ce_loss 1.0244 (1.1728) loss_zs_kd 0.4076 (0.4718) loss_oracle 0.3597 (0.4289) acc 59.3750 (59.3107) kd_loss 0.8447 (0.8563) lr 6.9098e-04 eta 0:14:41
epoch [32/50] batch [360/428] time 0.085 (0.112) data 0.000 (0.011) loss 2.4902 (2.4811) ce_loss 1.1650 (1.1736) loss_zs_kd 0.4525 (0.4711) loss_oracle 0.3950 (0.4272) acc 56.2500 (59.3490) kd_loss 0.9014 (0.8584) lr 6.9098e-04 eta 0:14:29
epoch [32/50] batch [380/428] time 0.082 (0.110) data 0.000 (0.010) loss 2.6073 (2.4825) ce_loss 1.2979 (1.1743) loss_zs_kd 0.3557 (0.4718) loss_oracle 0.4345 (0.4254) acc 43.7500 (59.3421) kd_loss 0.9144 (0.8596) lr 6.9098e-04 eta 0:14:16
epoch [32/50] batch [400/428] time 0.088 (0.109) data 0.000 (0.010) loss 2.2739 (2.4819) ce_loss 1.0684 (1.1721) loss_zs_kd 0.4969 (0.4736) loss_oracle 0.4864 (0.4251) acc 59.3750 (59.3750) kd_loss 0.7139 (0.8605) lr 6.9098e-04 eta 0:14:03
epoch [32/50] batch [420/428] time 0.093 (0.108) data 0.000 (0.009) loss 2.5349 (2.4854) ce_loss 1.1533 (1.1742) loss_zs_kd 0.4333 (0.4737) loss_oracle 0.3828 (0.4237) acc 59.3750 (59.2932) kd_loss 0.9736 (0.8625) lr 6.9098e-04 eta 0:13:51
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,637
* accuracy: 61.9%
* error: 38.1%
* macro_f1: 48.6%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,522
* accuracy: 53.2%
* error: 46.8%
* macro_f1: 30.3%
******* Domain 1 best val acc:      62.7%, epoch: 29 *******
******* Domain 1 best val test acc: 49.5%, epoch: 29 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [33/50] batch [20/428] time 0.103 (0.310) data 0.000 (0.202) loss 2.4331 (2.5086) ce_loss 1.1084 (1.1696) loss_zs_kd 0.3632 (0.4407) loss_oracle 0.3770 (0.3851) acc 62.5000 (59.3750) kd_loss 0.9546 (0.9261) lr 6.3188e-04 eta 0:39:42
epoch [33/50] batch [40/428] time 0.105 (0.205) data 0.000 (0.101) loss 2.4371 (2.5245) ce_loss 1.0967 (1.1748) loss_zs_kd 0.4725 (0.4614) loss_oracle 0.4226 (0.3884) acc 62.5000 (58.7500) kd_loss 0.8929 (0.9248) lr 6.3188e-04 eta 0:26:08
epoch [33/50] batch [60/428] time 0.100 (0.171) data 0.000 (0.068) loss 2.6600 (2.5202) ce_loss 1.2705 (1.1617) loss_zs_kd 0.4171 (0.4688) loss_oracle 0.4890 (0.4050) acc 50.0000 (59.8438) kd_loss 0.9364 (0.9216) lr 6.3188e-04 eta 0:21:43
epoch [33/50] batch [80/428] time 0.095 (0.153) data 0.000 (0.051) loss 2.2733 (2.5307) ce_loss 1.0029 (1.1703) loss_zs_kd 0.3846 (0.4674) loss_oracle 0.4310 (0.4115) acc 62.5000 (59.6094) kd_loss 0.8626 (0.9210) lr 6.3188e-04 eta 0:19:24
epoch [33/50] batch [100/428] time 0.102 (0.143) data 0.000 (0.041) loss 2.7953 (2.5400) ce_loss 1.3975 (1.1768) loss_zs_kd 0.4473 (0.4694) loss_oracle 0.4179 (0.4132) acc 43.7500 (59.2500) kd_loss 0.9653 (0.9219) lr 6.3188e-04 eta 0:18:08
epoch [33/50] batch [120/428] time 0.123 (0.136) data 0.000 (0.034) loss 2.4447 (2.5450) ce_loss 1.1387 (1.1812) loss_zs_kd 0.4032 (0.4704) loss_oracle 0.4720 (0.4150) acc 65.6250 (58.9583) kd_loss 0.8684 (0.9211) lr 6.3188e-04 eta 0:17:14
epoch [33/50] batch [140/428] time 0.109 (0.131) data 0.000 (0.029) loss 2.3867 (2.5403) ce_loss 1.0859 (1.1774) loss_zs_kd 0.4040 (0.4670) loss_oracle 0.4612 (0.4176) acc 65.6250 (59.2188) kd_loss 0.8681 (0.9206) lr 6.3188e-04 eta 0:16:32
epoch [33/50] batch [160/428] time 0.109 (0.128) data 0.000 (0.025) loss 2.4880 (2.5358) ce_loss 1.0518 (1.1706) loss_zs_kd 0.4323 (0.4639) loss_oracle 0.4658 (0.4194) acc 62.5000 (59.5898) kd_loss 0.9871 (0.9236) lr 6.3188e-04 eta 0:16:03
epoch [33/50] batch [180/428] time 0.089 (0.124) data 0.000 (0.023) loss 2.9721 (2.5457) ce_loss 1.4678 (1.1797) loss_zs_kd 0.4973 (0.4618) loss_oracle 0.4250 (0.4218) acc 46.8750 (59.0799) kd_loss 1.0431 (0.9241) lr 6.3188e-04 eta 0:15:35
epoch [33/50] batch [200/428] time 0.087 (0.121) data 0.000 (0.020) loss 2.6465 (2.5452) ce_loss 1.2148 (1.1748) loss_zs_kd 0.5034 (0.4639) loss_oracle 0.4211 (0.4240) acc 59.3750 (59.2031) kd_loss 0.9694 (0.9264) lr 6.3188e-04 eta 0:15:06
epoch [33/50] batch [220/428] time 0.082 (0.122) data 0.000 (0.019) loss 2.5741 (2.5457) ce_loss 1.1846 (1.1721) loss_zs_kd 0.4856 (0.4652) loss_oracle 0.4131 (0.4241) acc 56.2500 (59.3892) kd_loss 0.9402 (0.9289) lr 6.3188e-04 eta 0:15:14
epoch [33/50] batch [240/428] time 0.061 (0.122) data 0.000 (0.017) loss 2.6351 (2.5456) ce_loss 1.1768 (1.1690) loss_zs_kd 0.5311 (0.4661) loss_oracle 0.4006 (0.4226) acc 50.0000 (59.5573) kd_loss 0.9925 (0.9323) lr 6.3188e-04 eta 0:15:07
epoch [33/50] batch [260/428] time 0.093 (0.119) data 0.000 (0.016) loss 2.3708 (2.5434) ce_loss 0.9731 (1.1657) loss_zs_kd 0.4119 (0.4672) loss_oracle 0.4716 (0.4228) acc 62.5000 (59.6875) kd_loss 0.9559 (0.9327) lr 6.3188e-04 eta 0:14:48
epoch [33/50] batch [280/428] time 0.098 (0.118) data 0.000 (0.015) loss 2.6192 (2.5475) ce_loss 1.1943 (1.1687) loss_zs_kd 0.4666 (0.4672) loss_oracle 0.3987 (0.4233) acc 56.2500 (59.5201) kd_loss 0.9922 (0.9335) lr 6.3188e-04 eta 0:14:34
epoch [33/50] batch [300/428] time 0.092 (0.117) data 0.000 (0.014) loss 2.7282 (2.5481) ce_loss 1.3301 (1.1669) loss_zs_kd 0.4746 (0.4687) loss_oracle 0.4211 (0.4235) acc 46.8750 (59.7083) kd_loss 0.9503 (0.9351) lr 6.3188e-04 eta 0:14:23
epoch [33/50] batch [320/428] time 0.094 (0.116) data 0.000 (0.013) loss 2.7824 (2.5495) ce_loss 1.2480 (1.1668) loss_zs_kd 0.4972 (0.4701) loss_oracle 0.3593 (0.4222) acc 46.8750 (59.7754) kd_loss 1.1061 (0.9365) lr 6.3188e-04 eta 0:14:13
epoch [33/50] batch [340/428] time 0.098 (0.115) data 0.000 (0.012) loss 2.4815 (2.5536) ce_loss 1.0615 (1.1699) loss_zs_kd 0.4705 (0.4686) loss_oracle 0.4558 (0.4205) acc 65.6250 (59.6691) kd_loss 0.9568 (0.9392) lr 6.3188e-04 eta 0:14:03
epoch [33/50] batch [360/428] time 0.108 (0.114) data 0.000 (0.011) loss 2.4296 (2.5549) ce_loss 1.0078 (1.1700) loss_zs_kd 0.5387 (0.4693) loss_oracle 0.4127 (0.4192) acc 59.3750 (59.6094) kd_loss 0.9461 (0.9406) lr 6.3188e-04 eta 0:13:54
epoch [33/50] batch [380/428] time 0.096 (0.113) data 0.000 (0.011) loss 2.6081 (2.5559) ce_loss 1.1006 (1.1698) loss_zs_kd 0.4745 (0.4693) loss_oracle 0.4514 (0.4178) acc 62.5000 (59.6382) kd_loss 1.0446 (0.9426) lr 6.3188e-04 eta 0:13:46
epoch [33/50] batch [400/428] time 0.094 (0.112) data 0.000 (0.010) loss 2.6148 (2.5549) ce_loss 1.2275 (1.1690) loss_zs_kd 0.5185 (0.4703) loss_oracle 0.4354 (0.4166) acc 65.6250 (59.5938) kd_loss 0.9103 (0.9425) lr 6.3188e-04 eta 0:13:38
epoch [33/50] batch [420/428] time 0.100 (0.111) data 0.000 (0.010) loss 2.5277 (2.5533) ce_loss 1.0342 (1.1662) loss_zs_kd 0.5172 (0.4713) loss_oracle 0.3897 (0.4159) acc 62.5000 (59.7545) kd_loss 1.0401 (0.9435) lr 6.3188e-04 eta 0:13:31
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,612
* accuracy: 61.5%
* error: 38.5%
* macro_f1: 48.0%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,478
* accuracy: 52.3%
* error: 47.7%
* macro_f1: 31.4%
******* Domain 1 best val acc:      62.7%, epoch: 29 *******
******* Domain 1 best val test acc: 49.5%, epoch: 29 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [34/50] batch [20/428] time 0.100 (0.316) data 0.000 (0.204) loss 2.4682 (2.5358) ce_loss 0.9580 (1.1320) loss_zs_kd 0.4812 (0.4755) loss_oracle 0.3807 (0.4177) acc 65.6250 (61.7188) kd_loss 1.0793 (0.9573) lr 5.7422e-04 eta 0:38:13
epoch [34/50] batch [40/428] time 0.097 (0.209) data 0.000 (0.102) loss 2.6397 (2.5640) ce_loss 1.0908 (1.1574) loss_zs_kd 0.5195 (0.4767) loss_oracle 0.4519 (0.4111) acc 65.6250 (61.2500) kd_loss 1.0631 (0.9627) lr 5.7422e-04 eta 0:25:11
epoch [34/50] batch [60/428] time 0.097 (0.174) data 0.000 (0.068) loss 2.5514 (2.5661) ce_loss 1.0908 (1.1521) loss_zs_kd 0.4491 (0.4737) loss_oracle 0.4260 (0.4080) acc 62.5000 (61.1979) kd_loss 1.0231 (0.9732) lr 5.7422e-04 eta 0:20:52
epoch [34/50] batch [80/428] time 0.097 (0.155) data 0.000 (0.051) loss 2.6652 (2.5663) ce_loss 1.2363 (1.1521) loss_zs_kd 0.5390 (0.4758) loss_oracle 0.4124 (0.4087) acc 50.0000 (60.4297) kd_loss 0.9532 (0.9719) lr 5.7422e-04 eta 0:18:36
epoch [34/50] batch [100/428] time 0.112 (0.144) data 0.000 (0.041) loss 2.7308 (2.5626) ce_loss 1.2939 (1.1469) loss_zs_kd 0.4976 (0.4801) loss_oracle 0.3379 (0.4083) acc 50.0000 (60.9062) kd_loss 1.0191 (0.9715) lr 5.7422e-04 eta 0:17:15
epoch [34/50] batch [120/428] time 0.096 (0.137) data 0.000 (0.034) loss 2.8845 (2.5720) ce_loss 1.4092 (1.1617) loss_zs_kd 0.4442 (0.4741) loss_oracle 0.4639 (0.4106) acc 37.5000 (60.0000) kd_loss 1.0213 (0.9680) lr 5.7422e-04 eta 0:16:19
epoch [34/50] batch [140/428] time 0.094 (0.132) data 0.000 (0.029) loss 2.5777 (2.5817) ce_loss 1.1846 (1.1729) loss_zs_kd 0.4710 (0.4758) loss_oracle 0.4283 (0.4142) acc 65.6250 (59.6875) kd_loss 0.9435 (0.9638) lr 5.7422e-04 eta 0:15:39
epoch [34/50] batch [160/428] time 0.081 (0.126) data 0.000 (0.026) loss 2.6027 (2.5850) ce_loss 1.2705 (1.1743) loss_zs_kd 0.4099 (0.4788) loss_oracle 0.4377 (0.4160) acc 56.2500 (59.4531) kd_loss 0.9083 (0.9634) lr 5.7422e-04 eta 0:14:56
epoch [34/50] batch [180/428] time 0.152 (0.126) data 0.000 (0.023) loss 2.4587 (2.5891) ce_loss 1.0303 (1.1803) loss_zs_kd 0.4810 (0.4779) loss_oracle 0.4163 (0.4182) acc 59.3750 (59.3924) kd_loss 0.9797 (0.9608) lr 5.7422e-04 eta 0:14:55
epoch [34/50] batch [200/428] time 0.087 (0.122) data 0.000 (0.021) loss 2.5684 (2.5869) ce_loss 1.2412 (1.1802) loss_zs_kd 0.4648 (0.4792) loss_oracle 0.4046 (0.4176) acc 53.1250 (59.1719) kd_loss 0.8924 (0.9583) lr 5.7422e-04 eta 0:14:23
epoch [34/50] batch [220/428] time 0.086 (0.121) data 0.000 (0.019) loss 2.7448 (2.5833) ce_loss 1.3770 (1.1802) loss_zs_kd 0.5982 (0.4794) loss_oracle 0.3975 (0.4177) acc 46.8750 (59.2614) kd_loss 0.8700 (0.9545) lr 5.7422e-04 eta 0:14:16
epoch [34/50] batch [240/428] time 0.100 (0.120) data 0.000 (0.017) loss 2.6438 (2.5785) ce_loss 1.2129 (1.1776) loss_zs_kd 0.4650 (0.4787) loss_oracle 0.4712 (0.4190) acc 53.1250 (59.2969) kd_loss 0.9628 (0.9520) lr 5.7422e-04 eta 0:14:04
epoch [34/50] batch [260/428] time 0.098 (0.118) data 0.000 (0.016) loss 2.3571 (2.5781) ce_loss 0.9814 (1.1775) loss_zs_kd 0.4123 (0.4794) loss_oracle 0.4343 (0.4211) acc 59.3750 (59.3870) kd_loss 0.9523 (0.9504) lr 5.7422e-04 eta 0:13:50
epoch [34/50] batch [280/428] time 0.105 (0.117) data 0.000 (0.015) loss 2.6180 (2.5794) ce_loss 1.3545 (1.1806) loss_zs_kd 0.3718 (0.4784) loss_oracle 0.4180 (0.4204) acc 62.5000 (59.2299) kd_loss 0.8686 (0.9494) lr 5.7422e-04 eta 0:13:41
epoch [34/50] batch [300/428] time 0.100 (0.116) data 0.000 (0.014) loss 2.5246 (2.5765) ce_loss 1.0967 (1.1794) loss_zs_kd 0.4440 (0.4768) loss_oracle 0.4532 (0.4207) acc 59.3750 (59.2292) kd_loss 0.9793 (0.9484) lr 5.7422e-04 eta 0:13:32
epoch [34/50] batch [320/428] time 0.102 (0.116) data 0.000 (0.013) loss 2.4980 (2.5743) ce_loss 1.1250 (1.1785) loss_zs_kd 0.4509 (0.4760) loss_oracle 0.4519 (0.4206) acc 46.8750 (59.2969) kd_loss 0.9216 (0.9475) lr 5.7422e-04 eta 0:13:24
epoch [34/50] batch [340/428] time 0.104 (0.115) data 0.000 (0.012) loss 2.7244 (2.5712) ce_loss 1.2842 (1.1760) loss_zs_kd 0.4468 (0.4768) loss_oracle 0.4381 (0.4207) acc 56.2500 (59.3382) kd_loss 0.9978 (0.9464) lr 5.7422e-04 eta 0:13:20
epoch [34/50] batch [360/428] time 0.104 (0.115) data 0.000 (0.012) loss 2.2843 (2.5667) ce_loss 1.0791 (1.1741) loss_zs_kd 0.4004 (0.4758) loss_oracle 0.4031 (0.4206) acc 62.5000 (59.4010) kd_loss 0.8034 (0.9443) lr 5.7422e-04 eta 0:13:12
epoch [34/50] batch [380/428] time 0.103 (0.114) data 0.001 (0.011) loss 2.6274 (2.5642) ce_loss 1.2139 (1.1740) loss_zs_kd 0.4622 (0.4740) loss_oracle 0.4114 (0.4213) acc 62.5000 (59.4737) kd_loss 0.9767 (0.9425) lr 5.7422e-04 eta 0:13:06
epoch [34/50] batch [400/428] time 0.079 (0.113) data 0.000 (0.010) loss 2.4197 (2.5594) ce_loss 1.1592 (1.1711) loss_zs_kd 0.4815 (0.4729) loss_oracle 0.4077 (0.4211) acc 62.5000 (59.6250) kd_loss 0.8159 (0.9413) lr 5.7422e-04 eta 0:12:58
epoch [34/50] batch [420/428] time 0.163 (0.114) data 0.000 (0.010) loss 2.2333 (2.5593) ce_loss 0.8794 (1.1717) loss_zs_kd 0.3837 (0.4717) loss_oracle 0.4896 (0.4212) acc 75.0000 (59.6354) kd_loss 0.9172 (0.9411) lr 5.7422e-04 eta 0:12:58
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,589
* accuracy: 61.1%
* error: 38.9%
* macro_f1: 48.7%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,652
* accuracy: 55.9%
* error: 44.1%
* macro_f1: 32.2%
******* Domain 1 best val acc:      62.7%, epoch: 29 *******
******* Domain 1 best val test acc: 49.5%, epoch: 29 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [35/50] batch [20/428] time 0.095 (0.310) data 0.000 (0.204) loss 2.2965 (2.5418) ce_loss 1.0840 (1.1995) loss_zs_kd 0.3991 (0.4536) loss_oracle 0.3791 (0.4186) acc 65.6250 (56.5625) kd_loss 0.8234 (0.9062) lr 5.1825e-04 eta 0:35:15
epoch [35/50] batch [40/428] time 0.112 (0.206) data 0.000 (0.102) loss 2.3272 (2.5538) ce_loss 1.0400 (1.2073) loss_zs_kd 0.5035 (0.4594) loss_oracle 0.3723 (0.4315) acc 68.7500 (56.8750) kd_loss 0.8493 (0.9010) lr 5.1825e-04 eta 0:23:24
epoch [35/50] batch [60/428] time 0.107 (0.171) data 0.000 (0.068) loss 2.5948 (2.5308) ce_loss 1.2490 (1.1724) loss_zs_kd 0.4822 (0.4671) loss_oracle 0.3980 (0.4255) acc 59.3750 (58.9583) kd_loss 0.9056 (0.9121) lr 5.1825e-04 eta 0:19:22
epoch [35/50] batch [80/428] time 0.101 (0.154) data 0.000 (0.051) loss 2.6544 (2.5257) ce_loss 1.2051 (1.1629) loss_zs_kd 0.5889 (0.4739) loss_oracle 0.3756 (0.4248) acc 62.5000 (59.8438) kd_loss 0.9670 (0.9134) lr 5.1825e-04 eta 0:17:22
epoch [35/50] batch [100/428] time 0.098 (0.143) data 0.000 (0.041) loss 2.4830 (2.5247) ce_loss 1.1455 (1.1647) loss_zs_kd 0.3682 (0.4737) loss_oracle 0.4619 (0.4224) acc 56.2500 (59.5625) kd_loss 0.9225 (0.9120) lr 5.1825e-04 eta 0:16:03
epoch [35/50] batch [120/428] time 0.121 (0.136) data 0.000 (0.034) loss 2.7324 (2.5099) ce_loss 1.3789 (1.1500) loss_zs_kd 0.5460 (0.4735) loss_oracle 0.3972 (0.4240) acc 43.7500 (60.4948) kd_loss 0.8819 (0.9112) lr 5.1825e-04 eta 0:15:14
epoch [35/50] batch [140/428] time 0.168 (0.131) data 0.000 (0.029) loss 2.3798 (2.5106) ce_loss 0.9780 (1.1538) loss_zs_kd 0.4473 (0.4750) loss_oracle 0.4524 (0.4218) acc 71.8750 (60.0000) kd_loss 0.9519 (0.9084) lr 5.1825e-04 eta 0:14:37
epoch [35/50] batch [160/428] time 0.082 (0.129) data 0.000 (0.026) loss 2.3691 (2.5098) ce_loss 1.0498 (1.1543) loss_zs_kd 0.4206 (0.4737) loss_oracle 0.4041 (0.4223) acc 65.6250 (60.1367) kd_loss 0.9070 (0.9074) lr 5.1825e-04 eta 0:14:19
epoch [35/50] batch [180/428] time 0.078 (0.127) data 0.000 (0.023) loss 2.4795 (2.5075) ce_loss 1.2051 (1.1551) loss_zs_kd 0.5723 (0.4720) loss_oracle 0.5011 (0.4205) acc 62.5000 (60.2431) kd_loss 0.7377 (0.9061) lr 5.1825e-04 eta 0:14:09
epoch [35/50] batch [200/428] time 0.105 (0.124) data 0.000 (0.021) loss 2.4053 (2.5049) ce_loss 1.1025 (1.1574) loss_zs_kd 0.4728 (0.4746) loss_oracle 0.3708 (0.4193) acc 50.0000 (60.3125) kd_loss 0.8810 (0.9007) lr 5.1825e-04 eta 0:13:43
epoch [35/50] batch [220/428] time 0.105 (0.122) data 0.000 (0.019) loss 2.3419 (2.5124) ce_loss 1.0293 (1.1660) loss_zs_kd 0.5276 (0.4747) loss_oracle 0.3645 (0.4182) acc 68.7500 (60.0000) kd_loss 0.8666 (0.8999) lr 5.1825e-04 eta 0:13:26
epoch [35/50] batch [240/428] time 0.101 (0.120) data 0.000 (0.017) loss 2.8996 (2.5129) ce_loss 1.5439 (1.1690) loss_zs_kd 0.5371 (0.4755) loss_oracle 0.4064 (0.4162) acc 46.8750 (59.8047) kd_loss 0.8839 (0.8981) lr 5.1825e-04 eta 0:13:14
epoch [35/50] batch [260/428] time 0.106 (0.119) data 0.000 (0.016) loss 2.2670 (2.5072) ce_loss 1.0479 (1.1671) loss_zs_kd 0.4488 (0.4721) loss_oracle 0.4286 (0.4160) acc 62.5000 (59.8197) kd_loss 0.7804 (0.8960) lr 5.1825e-04 eta 0:13:02
epoch [35/50] batch [280/428] time 0.104 (0.117) data 0.000 (0.015) loss 2.3506 (2.5012) ce_loss 0.9404 (1.1630) loss_zs_kd 0.5487 (0.4747) loss_oracle 0.4394 (0.4150) acc 68.7500 (60.0335) kd_loss 0.9161 (0.8934) lr 5.1825e-04 eta 0:12:50
epoch [35/50] batch [300/428] time 0.117 (0.116) data 0.000 (0.014) loss 2.2928 (2.5014) ce_loss 1.0049 (1.1645) loss_zs_kd 0.4558 (0.4763) loss_oracle 0.4348 (0.4140) acc 68.7500 (59.9062) kd_loss 0.8427 (0.8917) lr 5.1825e-04 eta 0:12:41
epoch [35/50] batch [320/428] time 0.103 (0.115) data 0.000 (0.013) loss 2.5515 (2.5022) ce_loss 1.2939 (1.1656) loss_zs_kd 0.4180 (0.4780) loss_oracle 0.4067 (0.4130) acc 53.1250 (59.9316) kd_loss 0.8452 (0.8911) lr 5.1825e-04 eta 0:12:33
epoch [35/50] batch [340/428] time 0.095 (0.114) data 0.000 (0.012) loss 2.6171 (2.5008) ce_loss 1.3174 (1.1663) loss_zs_kd 0.4764 (0.4763) loss_oracle 0.4304 (0.4128) acc 59.3750 (59.8529) kd_loss 0.8463 (0.8900) lr 5.1825e-04 eta 0:12:24
epoch [35/50] batch [360/428] time 0.100 (0.114) data 0.000 (0.012) loss 2.5453 (2.5004) ce_loss 1.2090 (1.1679) loss_zs_kd 0.5263 (0.4756) loss_oracle 0.4592 (0.4127) acc 53.1250 (59.7656) kd_loss 0.8436 (0.8883) lr 5.1825e-04 eta 0:12:17
epoch [35/50] batch [380/428] time 0.087 (0.112) data 0.000 (0.011) loss 2.4804 (2.4964) ce_loss 1.1016 (1.1657) loss_zs_kd 0.4928 (0.4743) loss_oracle 0.3955 (0.4119) acc 56.2500 (59.8026) kd_loss 0.9347 (0.8876) lr 5.1825e-04 eta 0:12:05
epoch [35/50] batch [400/428] time 0.085 (0.114) data 0.000 (0.010) loss 2.2973 (2.4974) ce_loss 0.9517 (1.1662) loss_zs_kd 0.4688 (0.4745) loss_oracle 0.3836 (0.4107) acc 68.7500 (59.8125) kd_loss 0.9194 (0.8886) lr 5.1825e-04 eta 0:12:12
epoch [35/50] batch [420/428] time 0.074 (0.114) data 0.000 (0.010) loss 2.3514 (2.4976) ce_loss 1.1318 (1.1672) loss_zs_kd 0.4528 (0.4738) loss_oracle 0.4230 (0.4094) acc 62.5000 (59.7024) kd_loss 0.7817 (0.8888) lr 5.1825e-04 eta 0:12:11
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,610
* accuracy: 61.4%
* error: 38.6%
* macro_f1: 49.0%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,621
* accuracy: 55.3%
* error: 44.7%
* macro_f1: 31.8%
******* Domain 1 best val acc:      62.7%, epoch: 29 *******
******* Domain 1 best val test acc: 49.5%, epoch: 29 *******
******* Domain 1 best test acc:     57.5%, epoch: 19 *******
epoch [36/50] batch [20/428] time 0.103 (0.303) data 0.000 (0.202) loss 2.4843 (2.4536) ce_loss 1.1846 (1.1546) loss_zs_kd 0.4560 (0.4552) loss_oracle 0.3495 (0.3914) acc 59.3750 (63.1250) kd_loss 0.8969 (0.8757) lr 4.6417e-04 eta 0:32:21
epoch [36/50] batch [40/428] time 0.100 (0.204) data 0.000 (0.101) loss 2.3203 (2.4832) ce_loss 1.0488 (1.1730) loss_zs_kd 0.4262 (0.4557) loss_oracle 0.3374 (0.4009) acc 62.5000 (60.7031) kd_loss 0.8897 (0.8819) lr 4.6417e-04 eta 0:21:44
epoch [36/50] batch [60/428] time 0.097 (0.172) data 0.001 (0.068) loss 2.7380 (2.4798) ce_loss 1.4023 (1.1663) loss_zs_kd 0.4543 (0.4602) loss_oracle 0.4183 (0.4017) acc 50.0000 (60.0521) kd_loss 0.8993 (0.8825) lr 4.6417e-04 eta 0:18:11
epoch [36/50] batch [80/428] time 0.116 (0.159) data 0.000 (0.051) loss 2.7200 (2.4755) ce_loss 1.3027 (1.1599) loss_zs_kd 0.6329 (0.4639) loss_oracle 0.3548 (0.4017) acc 53.1250 (59.9609) kd_loss 0.9233 (0.8828) lr 4.6417e-04 eta 0:16:51
epoch [36/50] batch [100/428] time 0.101 (0.147) data 0.001 (0.041) loss 2.3965 (2.4761) ce_loss 1.0137 (1.1552) loss_zs_kd 0.4650 (0.4634) loss_oracle 0.3960 (0.4085) acc 68.7500 (59.9062) kd_loss 0.9523 (0.8849) lr 4.6417e-04 eta 0:15:30
