Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_100', 'location_38', 'location_43']
Target     ['location_46']
# classes  10
# train_x  12,912
# val      5,535
# test     5,883
---------  ----------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/403] time 0.118 (0.157) data 0.000 (0.038) loss 2.2086 (2.1851) ce_loss 2.2070 (2.1820) loss_zs_kd 0.0003 (0.0001) loss_oracle -0.0001 (-0.0001) acc 34.3750 (32.3438) kd_loss 0.0014 (0.0031) lr 1.0000e-05 eta 0:52:44
epoch [1/50] batch [40/403] time 0.102 (0.129) data 0.000 (0.019) loss 2.4317 (2.2323) ce_loss 2.4297 (2.2301) loss_zs_kd 0.0025 (0.0007) loss_oracle -0.0002 (-0.0001) acc 31.2500 (31.7188) kd_loss 0.0008 (0.0019) lr 1.0000e-05 eta 0:43:06
epoch [1/50] batch [60/403] time 0.108 (0.120) data 0.000 (0.013) loss 2.3344 (2.2098) ce_loss 2.3301 (2.2073) loss_zs_kd 0.0074 (0.0019) loss_oracle -0.0002 (-0.0001) acc 18.7500 (32.5521) kd_loss 0.0007 (0.0016) lr 1.0000e-05 eta 0:40:12
epoch [1/50] batch [80/403] time 0.098 (0.116) data 0.000 (0.010) loss 2.4906 (2.1809) ce_loss 2.4824 (2.1776) loss_zs_kd 0.0156 (0.0040) loss_oracle -0.0001 (-0.0001) acc 31.2500 (33.0859) kd_loss 0.0004 (0.0014) lr 1.0000e-05 eta 0:38:54
epoch [1/50] batch [100/403] time 0.106 (0.114) data 0.000 (0.008) loss 2.5251 (2.1779) ce_loss 2.5117 (2.1732) loss_zs_kd 0.0253 (0.0071) loss_oracle -0.0000 (-0.0001) acc 25.0000 (33.0938) kd_loss 0.0007 (0.0012) lr 1.0000e-05 eta 0:38:06
epoch [1/50] batch [120/403] time 0.104 (0.112) data 0.000 (0.006) loss 2.3708 (2.1649) ce_loss 2.3496 (2.1581) loss_zs_kd 0.0397 (0.0113) loss_oracle -0.0001 (-0.0001) acc 28.1250 (33.3854) kd_loss 0.0014 (0.0012) lr 1.0000e-05 eta 0:37:17
epoch [1/50] batch [140/403] time 0.078 (0.109) data 0.000 (0.006) loss 1.6298 (2.1302) ce_loss 1.6045 (2.1204) loss_zs_kd 0.0479 (0.0173) loss_oracle 0.0002 (-0.0001) acc 56.2500 (34.0848) kd_loss 0.0013 (0.0012) lr 1.0000e-05 eta 0:36:23
epoch [1/50] batch [160/403] time 0.087 (0.111) data 0.000 (0.005) loss 2.4313 (2.1015) ce_loss 2.3750 (2.0875) loss_zs_kd 0.1083 (0.0256) loss_oracle 0.0004 (0.0000) acc 28.1250 (34.8047) kd_loss 0.0020 (0.0012) lr 1.0000e-05 eta 0:37:07
epoch [1/50] batch [180/403] time 0.198 (0.115) data 0.000 (0.004) loss 1.7666 (2.0812) ce_loss 1.6309 (2.0595) loss_zs_kd 0.2429 (0.0400) loss_oracle 0.0100 (0.0005) acc 40.6250 (35.2951) kd_loss 0.0093 (0.0015) lr 1.0000e-05 eta 0:38:15
epoch [1/50] batch [200/403] time 0.091 (0.114) data 0.000 (0.004) loss 1.9793 (2.0645) ce_loss 1.8867 (2.0347) loss_zs_kd 0.1759 (0.0550) loss_oracle 0.0011 (0.0005) acc 43.7500 (35.7500) kd_loss 0.0040 (0.0020) lr 1.0000e-05 eta 0:37:46
epoch [1/50] batch [220/403] time 0.099 (0.112) data 0.000 (0.004) loss 1.7968 (2.0402) ce_loss 1.6660 (2.0022) loss_zs_kd 0.2323 (0.0699) loss_oracle 0.0012 (0.0006) acc 40.6250 (36.2500) kd_loss 0.0140 (0.0027) lr 1.0000e-05 eta 0:37:20
epoch [1/50] batch [240/403] time 0.093 (0.111) data 0.000 (0.003) loss 1.8351 (2.0259) ce_loss 1.6602 (1.9801) loss_zs_kd 0.3198 (0.0839) loss_oracle 0.0006 (0.0006) acc 43.7500 (36.7578) kd_loss 0.0147 (0.0035) lr 1.0000e-05 eta 0:36:53
epoch [1/50] batch [260/403] time 0.099 (0.110) data 0.000 (0.003) loss 2.2387 (2.0105) ce_loss 2.0625 (1.9585) loss_zs_kd 0.3024 (0.0938) loss_oracle 0.0035 (0.0006) acc 28.1250 (37.0913) kd_loss 0.0233 (0.0048) lr 1.0000e-05 eta 0:36:29
epoch [1/50] batch [280/403] time 0.107 (0.110) data 0.000 (0.003) loss 1.9043 (2.0035) ce_loss 1.7383 (1.9449) loss_zs_kd 0.2956 (0.1046) loss_oracle 0.0002 (0.0006) acc 40.6250 (37.4107) kd_loss 0.0181 (0.0060) lr 1.0000e-05 eta 0:36:17
epoch [1/50] batch [300/403] time 0.094 (0.109) data 0.000 (0.003) loss 2.0812 (1.9927) ce_loss 1.9414 (1.9284) loss_zs_kd 0.2447 (0.1134) loss_oracle 0.0011 (0.0006) acc 34.3750 (37.8750) kd_loss 0.0170 (0.0073) lr 1.0000e-05 eta 0:36:00
epoch [1/50] batch [320/403] time 0.106 (0.109) data 0.000 (0.003) loss 1.9530 (1.9917) ce_loss 1.8018 (1.9228) loss_zs_kd 0.2419 (0.1198) loss_oracle 0.0006 (0.0006) acc 40.6250 (38.0078) kd_loss 0.0300 (0.0087) lr 1.0000e-05 eta 0:35:53
epoch [1/50] batch [340/403] time 0.096 (0.108) data 0.000 (0.002) loss 1.5473 (1.9835) ce_loss 1.4053 (1.9100) loss_zs_kd 0.2180 (0.1265) loss_oracle 0.0003 (0.0006) acc 50.0000 (38.3548) kd_loss 0.0328 (0.0100) lr 1.0000e-05 eta 0:35:45
epoch [1/50] batch [360/403] time 0.169 (0.108) data 0.000 (0.002) loss 1.6497 (1.9810) ce_loss 1.5039 (1.9034) loss_zs_kd 0.2266 (0.1329) loss_oracle 0.0006 (0.0006) acc 46.8750 (38.5156) kd_loss 0.0321 (0.0108) lr 1.0000e-05 eta 0:35:34
epoch [1/50] batch [380/403] time 0.081 (0.108) data 0.000 (0.002) loss 1.8815 (1.9776) ce_loss 1.7256 (1.8963) loss_zs_kd 0.2401 (0.1387) loss_oracle 0.0003 (0.0006) acc 40.6250 (38.5609) kd_loss 0.0357 (0.0117) lr 1.0000e-05 eta 0:35:34
epoch [1/50] batch [400/403] time 0.070 (0.110) data 0.000 (0.002) loss 2.1865 (1.9723) ce_loss 1.9980 (1.8879) loss_zs_kd 0.3160 (0.1434) loss_oracle 0.0008 (0.0006) acc 25.0000 (38.7266) kd_loss 0.0301 (0.0124) lr 1.0000e-05 eta 0:36:14
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 2,487
* accuracy: 44.9%
* error: 55.1%
* macro_f1: 30.7%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 1,877
* accuracy: 31.9%
* error: 68.1%
* macro_f1: 21.5%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      44.9%, epoch: 1 *******
******* Domain 4 best val test acc: 31.9%, epoch: 1 *******
******* Domain 4 best test acc:     31.9%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/ana
epoch [2/50] batch [20/403] time 0.094 (0.156) data 0.000 (0.033) loss 2.0331 (1.9791) ce_loss 1.7939 (1.8282) loss_zs_kd 0.3416 (0.2266) loss_oracle 0.0755 (0.0207) acc 37.5000 (39.3750) kd_loss 0.0306 (0.0273) lr 2.0000e-03 eta 0:51:25
epoch [2/50] batch [40/403] time 0.103 (0.132) data 0.000 (0.017) loss 2.2089 (2.0577) ce_loss 1.4980 (1.6917) loss_zs_kd 0.3086 (0.2615) loss_oracle 0.4722 (0.2080) acc 46.8750 (42.5000) kd_loss 0.3204 (0.1312) lr 2.0000e-03 eta 0:43:28
epoch [2/50] batch [60/403] time 0.099 (0.122) data 0.000 (0.011) loss 2.2043 (2.1259) ce_loss 1.2656 (1.6216) loss_zs_kd 0.2727 (0.2696) loss_oracle 0.4926 (0.2901) acc 50.0000 (43.2292) kd_loss 0.5560 (0.2244) lr 2.0000e-03 eta 0:40:00
epoch [2/50] batch [80/403] time 0.100 (0.116) data 0.000 (0.009) loss 2.7397 (2.2648) ce_loss 1.5391 (1.5960) loss_zs_kd 0.2674 (0.2859) loss_oracle 0.4289 (0.3423) acc 37.5000 (44.1406) kd_loss 0.8525 (0.3547) lr 2.0000e-03 eta 0:37:58
epoch [2/50] batch [100/403] time 0.106 (0.113) data 0.000 (0.007) loss 3.4054 (2.3487) ce_loss 2.1699 (1.5599) loss_zs_kd 0.4092 (0.3011) loss_oracle 0.4047 (0.3570) acc 25.0000 (45.3125) kd_loss 0.8285 (0.4598) lr 2.0000e-03 eta 0:36:59
epoch [2/50] batch [120/403] time 0.088 (0.111) data 0.000 (0.006) loss 2.6637 (2.3872) ce_loss 1.4551 (1.5181) loss_zs_kd 0.3434 (0.3061) loss_oracle 0.4395 (0.3714) acc 50.0000 (47.0052) kd_loss 0.8172 (0.5303) lr 2.0000e-03 eta 0:36:23
epoch [2/50] batch [140/403] time 0.094 (0.110) data 0.000 (0.005) loss 2.5033 (2.4108) ce_loss 1.2969 (1.4921) loss_zs_kd 0.3482 (0.3171) loss_oracle 0.3926 (0.3729) acc 56.2500 (47.8571) kd_loss 0.8360 (0.5736) lr 2.0000e-03 eta 0:35:51
epoch [2/50] batch [160/403] time 0.111 (0.108) data 0.000 (0.004) loss 2.0542 (2.4094) ce_loss 1.0332 (1.4693) loss_zs_kd 0.4203 (0.3199) loss_oracle 0.2192 (0.3594) acc 68.7500 (48.4766) kd_loss 0.7013 (0.6004) lr 2.0000e-03 eta 0:35:15
epoch [2/50] batch [180/403] time 0.149 (0.108) data 0.000 (0.004) loss 2.2531 (2.4047) ce_loss 1.2266 (1.4479) loss_zs_kd 0.3088 (0.3247) loss_oracle 0.2888 (0.3546) acc 50.0000 (49.1840) kd_loss 0.7278 (0.6171) lr 2.0000e-03 eta 0:35:08
epoch [2/50] batch [200/403] time 0.146 (0.109) data 0.000 (0.004) loss 2.7069 (2.4069) ce_loss 1.4287 (1.4301) loss_zs_kd 0.5545 (0.3347) loss_oracle 0.3457 (0.3536) acc 53.1250 (49.7656) kd_loss 0.8280 (0.6327) lr 2.0000e-03 eta 0:35:36
epoch [2/50] batch [220/403] time 0.082 (0.112) data 0.000 (0.003) loss 2.3865 (2.4029) ce_loss 1.2637 (1.4123) loss_zs_kd 0.4084 (0.3384) loss_oracle 0.2594 (0.3517) acc 59.3750 (50.4119) kd_loss 0.7890 (0.6456) lr 2.0000e-03 eta 0:36:22
epoch [2/50] batch [240/403] time 0.103 (0.110) data 0.000 (0.003) loss 2.4836 (2.4031) ce_loss 1.3174 (1.4011) loss_zs_kd 0.3246 (0.3390) loss_oracle 0.3298 (0.3465) acc 53.1250 (50.5859) kd_loss 0.8390 (0.6593) lr 2.0000e-03 eta 0:35:49
epoch [2/50] batch [260/403] time 0.093 (0.110) data 0.000 (0.003) loss 2.2788 (2.4088) ce_loss 1.1836 (1.3961) loss_zs_kd 0.3715 (0.3409) loss_oracle 0.3224 (0.3478) acc 53.1250 (50.6851) kd_loss 0.7483 (0.6683) lr 2.0000e-03 eta 0:35:45
epoch [2/50] batch [280/403] time 0.089 (0.109) data 0.000 (0.003) loss 2.4302 (2.4171) ce_loss 1.1699 (1.3888) loss_zs_kd 0.4094 (0.3454) loss_oracle 0.3207 (0.3509) acc 50.0000 (50.9375) kd_loss 0.8952 (0.6802) lr 2.0000e-03 eta 0:35:16
epoch [2/50] batch [300/403] time 0.084 (0.107) data 0.000 (0.002) loss 2.3597 (2.4167) ce_loss 1.1279 (1.3782) loss_zs_kd 0.4365 (0.3496) loss_oracle 0.3588 (0.3467) acc 68.7500 (51.3958) kd_loss 0.8341 (0.6903) lr 2.0000e-03 eta 0:34:47
epoch [2/50] batch [320/403] time 0.091 (0.107) data 0.000 (0.002) loss 2.8110 (2.4160) ce_loss 1.5371 (1.3689) loss_zs_kd 0.4658 (0.3519) loss_oracle 0.4423 (0.3478) acc 46.8750 (51.7676) kd_loss 0.8199 (0.6972) lr 2.0000e-03 eta 0:34:29
epoch [2/50] batch [340/403] time 0.104 (0.106) data 0.001 (0.002) loss 2.6925 (2.4157) ce_loss 1.5654 (1.3609) loss_zs_kd 0.3313 (0.3547) loss_oracle 0.4243 (0.3508) acc 40.6250 (52.0129) kd_loss 0.7492 (0.7020) lr 2.0000e-03 eta 0:34:20
epoch [2/50] batch [360/403] time 0.101 (0.106) data 0.000 (0.002) loss 2.2429 (2.4171) ce_loss 1.1689 (1.3578) loss_zs_kd 0.2789 (0.3572) loss_oracle 0.3097 (0.3511) acc 53.1250 (52.1267) kd_loss 0.7797 (0.7051) lr 2.0000e-03 eta 0:34:15
epoch [2/50] batch [380/403] time 0.106 (0.106) data 0.000 (0.002) loss 2.4381 (2.4172) ce_loss 1.1680 (1.3518) loss_zs_kd 0.4103 (0.3597) loss_oracle 0.4264 (0.3508) acc 53.1250 (52.3438) kd_loss 0.8518 (0.7102) lr 2.0000e-03 eta 0:34:12
epoch [2/50] batch [400/403] time 0.165 (0.106) data 0.000 (0.002) loss 2.5194 (2.4197) ce_loss 1.4189 (1.3453) loss_zs_kd 0.3246 (0.3619) loss_oracle 0.3628 (0.3539) acc 53.1250 (52.5703) kd_loss 0.7567 (0.7165) lr 2.0000e-03 eta 0:34:10
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,340
* accuracy: 60.3%
* error: 39.7%
* macro_f1: 43.6%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,222
* accuracy: 37.8%
* error: 62.2%
* macro_f1: 27.2%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      60.3%, epoch: 2 *******
******* Domain 4 best val test acc: 37.8%, epoch: 2 *******
******* Domain 4 best test acc:     37.8%, epoch: 2 *******
epoch [3/50] batch [20/403] time 0.083 (0.151) data 0.000 (0.040) loss 2.5544 (2.4481) ce_loss 1.2891 (1.1972) loss_zs_kd 0.5011 (0.4393) loss_oracle 0.2587 (0.3410) acc 59.3750 (57.6562) kd_loss 0.8854 (0.8607) lr 1.9980e-03 eta 0:48:40
epoch [3/50] batch [40/403] time 0.082 (0.152) data 0.000 (0.020) loss 2.4033 (2.4234) ce_loss 1.2344 (1.2013) loss_zs_kd 0.4186 (0.4293) loss_oracle 0.2542 (0.3004) acc 56.2500 (57.4219) kd_loss 0.8325 (0.8572) lr 1.9980e-03 eta 0:48:47
epoch [3/50] batch [60/403] time 0.094 (0.134) data 0.001 (0.013) loss 1.9403 (2.3879) ce_loss 0.8252 (1.1756) loss_zs_kd 0.3195 (0.4302) loss_oracle 0.2402 (0.2836) acc 78.1250 (58.8021) kd_loss 0.8353 (0.8554) lr 1.9980e-03 eta 0:42:57
epoch [3/50] batch [80/403] time 0.099 (0.124) data 0.000 (0.010) loss 2.4731 (2.3674) ce_loss 1.3438 (1.1671) loss_zs_kd 0.3646 (0.4248) loss_oracle 0.2265 (0.2687) acc 50.0000 (58.8672) kd_loss 0.8338 (0.8535) lr 1.9980e-03 eta 0:39:54
epoch [3/50] batch [100/403] time 0.096 (0.118) data 0.000 (0.008) loss 2.0102 (2.3614) ce_loss 0.9072 (1.1676) loss_zs_kd 0.3432 (0.4282) loss_oracle 0.2603 (0.2637) acc 78.1250 (59.3438) kd_loss 0.8012 (0.8479) lr 1.9980e-03 eta 0:37:48
epoch [3/50] batch [120/403] time 0.083 (0.114) data 0.000 (0.007) loss 2.1629 (2.3630) ce_loss 1.0527 (1.1799) loss_zs_kd 0.4083 (0.4238) loss_oracle 0.1922 (0.2568) acc 68.7500 (58.6458) kd_loss 0.8099 (0.8428) lr 1.9980e-03 eta 0:36:40
epoch [3/50] batch [140/403] time 0.084 (0.111) data 0.000 (0.006) loss 2.0029 (2.3448) ce_loss 0.9658 (1.1723) loss_zs_kd 0.3864 (0.4265) loss_oracle 0.1637 (0.2500) acc 68.7500 (59.0848) kd_loss 0.7621 (0.8342) lr 1.9980e-03 eta 0:35:33
epoch [3/50] batch [160/403] time 0.103 (0.109) data 0.000 (0.005) loss 2.4346 (2.3411) ce_loss 1.3379 (1.1772) loss_zs_kd 0.4405 (0.4256) loss_oracle 0.2392 (0.2505) acc 65.6250 (59.1992) kd_loss 0.7569 (0.8259) lr 1.9980e-03 eta 0:34:52
epoch [3/50] batch [180/403] time 0.105 (0.108) data 0.000 (0.005) loss 2.3488 (2.3268) ce_loss 1.2471 (1.1703) loss_zs_kd 0.4440 (0.4295) loss_oracle 0.2264 (0.2458) acc 50.0000 (59.4792) kd_loss 0.7665 (0.8188) lr 1.9980e-03 eta 0:34:24
epoch [3/50] batch [200/403] time 0.090 (0.107) data 0.000 (0.004) loss 2.6305 (2.3254) ce_loss 1.5098 (1.1745) loss_zs_kd 0.3813 (0.4290) loss_oracle 0.3454 (0.2497) acc 50.0000 (59.4531) kd_loss 0.7574 (0.8115) lr 1.9980e-03 eta 0:34:09
epoch [3/50] batch [220/403] time 0.130 (0.105) data 0.000 (0.004) loss 1.9658 (2.3254) ce_loss 0.9600 (1.1824) loss_zs_kd 0.3893 (0.4261) loss_oracle 0.2324 (0.2522) acc 62.5000 (58.9347) kd_loss 0.6950 (0.8039) lr 1.9980e-03 eta 0:33:36
epoch [3/50] batch [240/403] time 0.088 (0.107) data 0.000 (0.004) loss 2.2960 (2.3180) ce_loss 1.2812 (1.1861) loss_zs_kd 0.4709 (0.4247) loss_oracle 0.2027 (0.2468) acc 62.5000 (58.8802) kd_loss 0.6780 (0.7962) lr 1.9980e-03 eta 0:34:05
epoch [3/50] batch [260/403] time 0.183 (0.110) data 0.000 (0.003) loss 2.4111 (2.3096) ce_loss 1.4092 (1.1853) loss_zs_kd 0.3729 (0.4225) loss_oracle 0.2823 (0.2474) acc 43.7500 (58.8341) kd_loss 0.6744 (0.7893) lr 1.9980e-03 eta 0:35:06
epoch [3/50] batch [280/403] time 0.090 (0.110) data 0.000 (0.003) loss 1.8211 (2.2970) ce_loss 0.7036 (1.1771) loss_zs_kd 0.4416 (0.4226) loss_oracle 0.3784 (0.2509) acc 78.1250 (59.2076) kd_loss 0.7075 (0.7831) lr 1.9980e-03 eta 0:34:48
epoch [3/50] batch [300/403] time 0.102 (0.109) data 0.000 (0.003) loss 2.2093 (2.2912) ce_loss 1.1377 (1.1752) loss_zs_kd 0.4863 (0.4234) loss_oracle 0.3313 (0.2534) acc 62.5000 (59.1562) kd_loss 0.6628 (0.7776) lr 1.9980e-03 eta 0:34:35
epoch [3/50] batch [320/403] time 0.094 (0.109) data 0.000 (0.003) loss 2.0284 (2.2877) ce_loss 1.0977 (1.1781) loss_zs_kd 0.3143 (0.4226) loss_oracle 0.2918 (0.2553) acc 56.2500 (59.0137) kd_loss 0.6276 (0.7706) lr 1.9980e-03 eta 0:34:25
epoch [3/50] batch [340/403] time 0.093 (0.108) data 0.000 (0.003) loss 2.1402 (2.2805) ce_loss 1.1318 (1.1755) loss_zs_kd 0.4304 (0.4235) loss_oracle 0.2955 (0.2571) acc 56.2500 (59.1728) kd_loss 0.6454 (0.7647) lr 1.9980e-03 eta 0:34:08
epoch [3/50] batch [360/403] time 0.097 (0.107) data 0.000 (0.002) loss 2.1592 (2.2732) ce_loss 1.1504 (1.1728) loss_zs_kd 0.4754 (0.4241) loss_oracle 0.2408 (0.2597) acc 53.1250 (59.2969) kd_loss 0.6507 (0.7585) lr 1.9980e-03 eta 0:33:55
epoch [3/50] batch [380/403] time 0.108 (0.107) data 0.000 (0.002) loss 2.1592 (2.2636) ce_loss 1.1982 (1.1696) loss_zs_kd 0.3994 (0.4243) loss_oracle 0.2781 (0.2603) acc 59.3750 (59.3586) kd_loss 0.6222 (0.7517) lr 1.9980e-03 eta 0:33:48
epoch [3/50] batch [400/403] time 0.088 (0.106) data 0.000 (0.002) loss 2.3524 (2.2557) ce_loss 1.4160 (1.1686) loss_zs_kd 0.4424 (0.4235) loss_oracle 0.1916 (0.2596) acc 53.1250 (59.4688) kd_loss 0.6194 (0.7456) lr 1.9980e-03 eta 0:33:34
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,351
* accuracy: 60.5%
* error: 39.5%
* macro_f1: 44.3%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 1,989
* accuracy: 33.8%
* error: 66.2%
* macro_f1: 23.8%
******* Domain 4 best val acc:      60.5%, epoch: 3 *******
******* Domain 4 best val test acc: 33.8%, epoch: 3 *******
******* Domain 4 best test acc:     37.8%, epoch: 2 *******
epoch [4/50] batch [20/403] time 0.110 (0.148) data 0.000 (0.042) loss 2.0561 (2.0706) ce_loss 1.0762 (1.1158) loss_zs_kd 0.3854 (0.4067) loss_oracle 0.2936 (0.2718) acc 50.0000 (61.7188) kd_loss 0.6405 (0.6156) lr 1.9921e-03 eta 0:46:33
epoch [4/50] batch [40/403] time 0.094 (0.118) data 0.000 (0.021) loss 2.0602 (2.0688) ce_loss 1.1670 (1.1251) loss_zs_kd 0.3803 (0.4085) loss_oracle 0.2337 (0.2576) acc 59.3750 (61.3281) kd_loss 0.5862 (0.6107) lr 1.9921e-03 eta 0:37:19
epoch [4/50] batch [60/403] time 0.105 (0.123) data 0.000 (0.014) loss 2.1508 (2.0873) ce_loss 1.2363 (1.1409) loss_zs_kd 0.3894 (0.4148) loss_oracle 0.2432 (0.2588) acc 59.3750 (60.7292) kd_loss 0.5982 (0.6096) lr 1.9921e-03 eta 0:38:33
epoch [4/50] batch [80/403] time 0.150 (0.118) data 0.000 (0.011) loss 1.8920 (2.0811) ce_loss 0.8809 (1.1400) loss_zs_kd 0.5124 (0.4155) loss_oracle 0.2760 (0.2564) acc 71.8750 (60.6641) kd_loss 0.6169 (0.6051) lr 1.9921e-03 eta 0:37:01
epoch [4/50] batch [100/403] time 0.076 (0.119) data 0.000 (0.009) loss 2.4229 (2.0894) ce_loss 1.4932 (1.1550) loss_zs_kd 0.3808 (0.4102) loss_oracle 0.2829 (0.2560) acc 40.6250 (60.0000) kd_loss 0.5979 (0.6013) lr 1.9921e-03 eta 0:37:25
epoch [4/50] batch [120/403] time 0.108 (0.116) data 0.000 (0.007) loss 2.3334 (2.0824) ce_loss 1.3779 (1.1490) loss_zs_kd 0.4114 (0.4124) loss_oracle 0.2811 (0.2568) acc 53.1250 (60.3906) kd_loss 0.6092 (0.5988) lr 1.9921e-03 eta 0:36:13
epoch [4/50] batch [140/403] time 0.100 (0.113) data 0.000 (0.006) loss 2.0628 (2.0745) ce_loss 1.1465 (1.1456) loss_zs_kd 0.4406 (0.4162) loss_oracle 0.2288 (0.2517) acc 68.7500 (60.6920) kd_loss 0.5816 (0.5950) lr 1.9921e-03 eta 0:35:28
epoch [4/50] batch [160/403] time 0.096 (0.112) data 0.000 (0.005) loss 2.1071 (2.0731) ce_loss 1.2744 (1.1463) loss_zs_kd 0.2886 (0.4159) loss_oracle 0.2631 (0.2527) acc 56.2500 (60.6836) kd_loss 0.5568 (0.5926) lr 1.9921e-03 eta 0:34:54
epoch [4/50] batch [180/403] time 0.101 (0.110) data 0.000 (0.005) loss 1.9887 (2.0769) ce_loss 1.0127 (1.1497) loss_zs_kd 0.4585 (0.4188) loss_oracle 0.2877 (0.2559) acc 65.6250 (60.4514) kd_loss 0.6029 (0.5898) lr 1.9921e-03 eta 0:34:24
epoch [4/50] batch [200/403] time 0.096 (0.109) data 0.000 (0.004) loss 2.0235 (2.0735) ce_loss 1.1592 (1.1484) loss_zs_kd 0.3835 (0.4189) loss_oracle 0.2408 (0.2558) acc 53.1250 (60.6094) kd_loss 0.5522 (0.5877) lr 1.9921e-03 eta 0:34:05
epoch [4/50] batch [220/403] time 0.100 (0.108) data 0.000 (0.004) loss 1.9345 (2.0644) ce_loss 0.9106 (1.1420) loss_zs_kd 0.5204 (0.4180) loss_oracle 0.2866 (0.2547) acc 68.7500 (60.7244) kd_loss 0.6204 (0.5861) lr 1.9921e-03 eta 0:33:44
epoch [4/50] batch [240/403] time 0.093 (0.107) data 0.000 (0.004) loss 2.1808 (2.0665) ce_loss 1.2090 (1.1447) loss_zs_kd 0.4938 (0.4177) loss_oracle 0.3115 (0.2557) acc 59.3750 (60.4557) kd_loss 0.5692 (0.5851) lr 1.9921e-03 eta 0:33:27
epoch [4/50] batch [260/403] time 0.092 (0.107) data 0.000 (0.003) loss 1.8007 (2.0597) ce_loss 0.8296 (1.1376) loss_zs_kd 0.5468 (0.4198) loss_oracle 0.2608 (0.2566) acc 71.8750 (60.7692) kd_loss 0.5673 (0.5839) lr 1.9921e-03 eta 0:33:10
epoch [4/50] batch [280/403] time 0.163 (0.106) data 0.000 (0.003) loss 2.3346 (2.0524) ce_loss 1.4326 (1.1320) loss_zs_kd 0.4649 (0.4205) loss_oracle 0.1823 (0.2556) acc 59.3750 (61.1161) kd_loss 0.5784 (0.5823) lr 1.9921e-03 eta 0:32:55
epoch [4/50] batch [300/403] time 0.089 (0.106) data 0.000 (0.003) loss 2.2160 (2.0495) ce_loss 1.3799 (1.1303) loss_zs_kd 0.3048 (0.4198) loss_oracle 0.2162 (0.2542) acc 46.8750 (61.1458) kd_loss 0.5756 (0.5823) lr 1.9921e-03 eta 0:32:56
epoch [4/50] batch [320/403] time 0.080 (0.109) data 0.000 (0.003) loss 1.9752 (2.0497) ce_loss 1.0518 (1.1315) loss_zs_kd 0.3580 (0.4196) loss_oracle 0.1989 (0.2539) acc 68.7500 (61.1230) kd_loss 0.6450 (0.5815) lr 1.9921e-03 eta 0:33:42
epoch [4/50] batch [340/403] time 0.095 (0.107) data 0.000 (0.003) loss 2.2296 (2.0505) ce_loss 1.3262 (1.1331) loss_zs_kd 0.4698 (0.4204) loss_oracle 0.2639 (0.2525) acc 59.3750 (61.0018) kd_loss 0.5365 (0.5809) lr 1.9921e-03 eta 0:33:17
epoch [4/50] batch [360/403] time 0.105 (0.107) data 0.000 (0.003) loss 2.2431 (2.0448) ce_loss 1.3291 (1.1287) loss_zs_kd 0.4403 (0.4206) loss_oracle 0.2050 (0.2513) acc 59.3750 (61.1719) kd_loss 0.5913 (0.5802) lr 1.9921e-03 eta 0:33:00
epoch [4/50] batch [380/403] time 0.078 (0.106) data 0.000 (0.002) loss 2.1052 (2.0457) ce_loss 1.1035 (1.1293) loss_zs_kd 0.5964 (0.4221) loss_oracle 0.2642 (0.2519) acc 50.0000 (61.1431) kd_loss 0.5714 (0.5794) lr 1.9921e-03 eta 0:32:52
epoch [4/50] batch [400/403] time 0.082 (0.105) data 0.000 (0.002) loss 2.4746 (2.0437) ce_loss 1.6465 (1.1279) loss_zs_kd 0.3170 (0.4204) loss_oracle 0.2294 (0.2528) acc 50.0000 (61.2188) kd_loss 0.5549 (0.5792) lr 1.9921e-03 eta 0:32:35
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,425
* accuracy: 61.9%
* error: 38.1%
* macro_f1: 47.6%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,104
* accuracy: 35.8%
* error: 64.2%
* macro_f1: 25.6%
******* Domain 4 best val acc:      61.9%, epoch: 4 *******
******* Domain 4 best val test acc: 35.8%, epoch: 4 *******
******* Domain 4 best test acc:     37.8%, epoch: 2 *******
epoch [5/50] batch [20/403] time 0.097 (0.164) data 0.000 (0.062) loss 2.2050 (2.0438) ce_loss 1.2588 (1.1416) loss_zs_kd 0.4552 (0.3980) loss_oracle 0.2307 (0.2418) acc 59.3750 (59.8438) kd_loss 0.6033 (0.5823) lr 1.9823e-03 eta 0:50:33
epoch [5/50] batch [40/403] time 0.094 (0.130) data 0.000 (0.031) loss 2.2539 (2.0247) ce_loss 1.3799 (1.1124) loss_zs_kd 0.4255 (0.4102) loss_oracle 0.2372 (0.2404) acc 59.3750 (61.0938) kd_loss 0.5427 (0.5870) lr 1.9823e-03 eta 0:39:58
epoch [5/50] batch [60/403] time 0.118 (0.123) data 0.001 (0.021) loss 1.9267 (2.0212) ce_loss 1.0371 (1.0960) loss_zs_kd 0.3941 (0.4250) loss_oracle 0.2073 (0.2451) acc 62.5000 (61.6667) kd_loss 0.5889 (0.5902) lr 1.9823e-03 eta 0:37:52
epoch [5/50] batch [80/403] time 0.082 (0.113) data 0.000 (0.016) loss 1.9239 (2.0285) ce_loss 1.0674 (1.0942) loss_zs_kd 0.4593 (0.4200) loss_oracle 0.2479 (0.2489) acc 62.5000 (62.2656) kd_loss 0.5029 (0.5999) lr 1.9823e-03 eta 0:34:54
epoch [5/50] batch [100/403] time 0.078 (0.117) data 0.001 (0.013) loss 1.9289 (2.0376) ce_loss 0.9033 (1.0948) loss_zs_kd 0.5287 (0.4249) loss_oracle 0.2365 (0.2504) acc 78.1250 (62.1250) kd_loss 0.6430 (0.6051) lr 1.9823e-03 eta 0:35:51
epoch [5/50] batch [120/403] time 0.154 (0.112) data 0.000 (0.011) loss 2.1000 (2.0368) ce_loss 1.2783 (1.0936) loss_zs_kd 0.3747 (0.4276) loss_oracle 0.2143 (0.2511) acc 59.3750 (62.4740) kd_loss 0.5271 (0.6038) lr 1.9823e-03 eta 0:34:22
epoch [5/50] batch [140/403] time 0.072 (0.116) data 0.000 (0.009) loss 2.1485 (2.0473) ce_loss 1.2002 (1.0978) loss_zs_kd 0.4566 (0.4252) loss_oracle 0.2668 (0.2517) acc 53.1250 (62.3884) kd_loss 0.5866 (0.6110) lr 1.9823e-03 eta 0:35:36
epoch [5/50] batch [160/403] time 0.098 (0.112) data 0.000 (0.008) loss 2.3337 (2.0598) ce_loss 1.3262 (1.1032) loss_zs_kd 0.4357 (0.4273) loss_oracle 0.2197 (0.2520) acc 50.0000 (62.1484) kd_loss 0.6799 (0.6169) lr 1.9823e-03 eta 0:34:22
epoch [5/50] batch [180/403] time 0.107 (0.111) data 0.000 (0.007) loss 1.7536 (2.0634) ce_loss 0.7334 (1.0991) loss_zs_kd 0.3600 (0.4253) loss_oracle 0.2762 (0.2535) acc 78.1250 (62.1354) kd_loss 0.7021 (0.6249) lr 1.9823e-03 eta 0:33:51
epoch [5/50] batch [200/403] time 0.093 (0.109) data 0.000 (0.006) loss 2.2647 (2.0728) ce_loss 1.1064 (1.0988) loss_zs_kd 0.3663 (0.4252) loss_oracle 0.3141 (0.2558) acc 65.6250 (62.2031) kd_loss 0.8181 (0.6334) lr 1.9823e-03 eta 0:33:18
epoch [5/50] batch [220/403] time 0.109 (0.108) data 0.000 (0.006) loss 2.1621 (2.0824) ce_loss 1.0459 (1.0985) loss_zs_kd 0.4096 (0.4273) loss_oracle 0.2839 (0.2586) acc 65.6250 (62.4290) kd_loss 0.7694 (0.6409) lr 1.9823e-03 eta 0:32:53
epoch [5/50] batch [240/403] time 0.084 (0.107) data 0.000 (0.005) loss 2.0339 (2.0917) ce_loss 1.0059 (1.1011) loss_zs_kd 0.3712 (0.4266) loss_oracle 0.2668 (0.2617) acc 68.7500 (62.2656) kd_loss 0.7091 (0.6466) lr 1.9823e-03 eta 0:32:44
epoch [5/50] batch [260/403] time 0.111 (0.107) data 0.000 (0.005) loss 1.9979 (2.0917) ce_loss 1.0273 (1.0997) loss_zs_kd 0.4136 (0.4240) loss_oracle 0.2228 (0.2609) acc 62.5000 (62.3317) kd_loss 0.6524 (0.6495) lr 1.9823e-03 eta 0:32:30
epoch [5/50] batch [280/403] time 0.095 (0.106) data 0.000 (0.005) loss 1.9476 (2.0954) ce_loss 0.8838 (1.1024) loss_zs_kd 0.4754 (0.4245) loss_oracle 0.2513 (0.2609) acc 71.8750 (62.2768) kd_loss 0.7005 (0.6503) lr 1.9823e-03 eta 0:32:12
epoch [5/50] batch [300/403] time 0.087 (0.105) data 0.000 (0.004) loss 2.0365 (2.0951) ce_loss 1.0566 (1.0998) loss_zs_kd 0.4741 (0.4248) loss_oracle 0.2432 (0.2602) acc 65.6250 (62.4167) kd_loss 0.6212 (0.6528) lr 1.9823e-03 eta 0:32:00
epoch [5/50] batch [320/403] time 0.081 (0.104) data 0.000 (0.004) loss 2.2539 (2.0924) ce_loss 1.2383 (1.0983) loss_zs_kd 0.5080 (0.4262) loss_oracle 0.2206 (0.2597) acc 56.2500 (62.4609) kd_loss 0.6513 (0.6513) lr 1.9823e-03 eta 0:31:35
epoch [5/50] batch [340/403] time 0.075 (0.106) data 0.000 (0.004) loss 1.7871 (2.0879) ce_loss 0.8203 (1.0986) loss_zs_kd 0.3956 (0.4252) loss_oracle 0.2696 (0.2576) acc 81.2500 (62.4540) kd_loss 0.6342 (0.6479) lr 1.9823e-03 eta 0:32:01
epoch [5/50] batch [360/403] time 0.165 (0.105) data 0.000 (0.004) loss 2.1285 (2.0811) ce_loss 1.2158 (1.0951) loss_zs_kd 0.3776 (0.4242) loss_oracle 0.2568 (0.2579) acc 59.3750 (62.6562) kd_loss 0.5955 (0.6450) lr 1.9823e-03 eta 0:31:54
epoch [5/50] batch [380/403] time 0.098 (0.107) data 0.000 (0.004) loss 1.8893 (2.0781) ce_loss 1.0518 (1.0947) loss_zs_kd 0.4090 (0.4246) loss_oracle 0.2428 (0.2579) acc 62.5000 (62.5987) kd_loss 0.5116 (0.6421) lr 1.9823e-03 eta 0:32:21
epoch [5/50] batch [400/403] time 0.094 (0.106) data 0.000 (0.003) loss 2.1221 (2.0768) ce_loss 1.1963 (1.0972) loss_zs_kd 0.5021 (0.4240) loss_oracle 0.1842 (0.2561) acc 56.2500 (62.4062) kd_loss 0.5826 (0.6396) lr 1.9823e-03 eta 0:32:05
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,612
* accuracy: 65.3%
* error: 34.7%
* macro_f1: 49.8%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,299
* accuracy: 39.1%
* error: 60.9%
* macro_f1: 29.3%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      65.3%, epoch: 5 *******
******* Domain 4 best val test acc: 39.1%, epoch: 5 *******
******* Domain 4 best test acc:     39.1%, epoch: 5 *******
epoch [6/50] batch [20/403] time 0.092 (0.152) data 0.000 (0.056) loss 2.0244 (2.0923) ce_loss 0.9819 (1.0894) loss_zs_kd 0.4547 (0.4399) loss_oracle 0.2584 (0.2379) acc 65.6250 (62.1875) kd_loss 0.6859 (0.6640) lr 1.9686e-03 eta 0:46:01
epoch [6/50] batch [40/403] time 0.098 (0.123) data 0.000 (0.028) loss 2.1631 (2.1177) ce_loss 1.1133 (1.0934) loss_zs_kd 0.4552 (0.4266) loss_oracle 0.1919 (0.2404) acc 62.5000 (62.2656) kd_loss 0.7262 (0.6908) lr 1.9686e-03 eta 0:37:04
epoch [6/50] batch [60/403] time 0.094 (0.113) data 0.000 (0.019) loss 2.4326 (2.1357) ce_loss 1.3926 (1.0916) loss_zs_kd 0.3515 (0.4310) loss_oracle 0.2460 (0.2431) acc 56.2500 (62.1354) kd_loss 0.7413 (0.7070) lr 1.9686e-03 eta 0:34:05
epoch [6/50] batch [80/403] time 0.097 (0.109) data 0.000 (0.014) loss 2.1119 (2.1410) ce_loss 1.1611 (1.0788) loss_zs_kd 0.3131 (0.4330) loss_oracle 0.2357 (0.2441) acc 65.6250 (63.0469) kd_loss 0.6763 (0.7236) lr 1.9686e-03 eta 0:32:41
epoch [6/50] batch [100/403] time 0.101 (0.107) data 0.000 (0.011) loss 2.2225 (2.1600) ce_loss 1.0068 (1.0870) loss_zs_kd 0.4435 (0.4375) loss_oracle 0.2546 (0.2486) acc 68.7500 (62.5000) kd_loss 0.8665 (0.7299) lr 1.9686e-03 eta 0:32:02
epoch [6/50] batch [120/403] time 0.091 (0.105) data 0.000 (0.009) loss 2.1796 (2.1728) ce_loss 1.0352 (1.0890) loss_zs_kd 0.3929 (0.4419) loss_oracle 0.2536 (0.2514) acc 65.6250 (62.5260) kd_loss 0.8212 (0.7372) lr 1.9686e-03 eta 0:31:22
epoch [6/50] batch [140/403] time 0.091 (0.103) data 0.000 (0.008) loss 2.2185 (2.1646) ce_loss 1.0234 (1.0781) loss_zs_kd 0.3906 (0.4366) loss_oracle 0.3241 (0.2516) acc 59.3750 (62.9464) kd_loss 0.8377 (0.7424) lr 1.9686e-03 eta 0:30:55
epoch [6/50] batch [160/403] time 0.079 (0.100) data 0.000 (0.007) loss 2.5029 (2.1713) ce_loss 1.2324 (1.0763) loss_zs_kd 0.5162 (0.4382) loss_oracle 0.3054 (0.2556) acc 46.8750 (62.9297) kd_loss 0.8597 (0.7482) lr 1.9686e-03 eta 0:30:02
epoch [6/50] batch [180/403] time 0.160 (0.103) data 0.000 (0.006) loss 2.4692 (2.1786) ce_loss 1.3301 (1.0760) loss_zs_kd 0.4408 (0.4391) loss_oracle 0.2544 (0.2598) acc 53.1250 (62.9514) kd_loss 0.7915 (0.7532) lr 1.9686e-03 eta 0:30:47
epoch [6/50] batch [200/403] time 0.162 (0.102) data 0.000 (0.006) loss 2.4099 (2.1792) ce_loss 1.1660 (1.0742) loss_zs_kd 0.5183 (0.4362) loss_oracle 0.2733 (0.2590) acc 62.5000 (63.0156) kd_loss 0.8481 (0.7574) lr 1.9686e-03 eta 0:30:21
epoch [6/50] batch [220/403] time 0.073 (0.105) data 0.000 (0.005) loss 2.0080 (2.1785) ce_loss 0.9878 (1.0772) loss_zs_kd 0.3939 (0.4364) loss_oracle 0.2553 (0.2600) acc 62.5000 (62.9545) kd_loss 0.6956 (0.7531) lr 1.9686e-03 eta 0:31:17
epoch [6/50] batch [240/403] time 0.096 (0.104) data 0.000 (0.005) loss 2.3137 (2.1771) ce_loss 1.2070 (1.0807) loss_zs_kd 0.3857 (0.4361) loss_oracle 0.2585 (0.2607) acc 50.0000 (62.7604) kd_loss 0.7846 (0.7481) lr 1.9686e-03 eta 0:30:55
epoch [6/50] batch [260/403] time 0.116 (0.104) data 0.000 (0.005) loss 2.4098 (2.1817) ce_loss 1.3604 (1.0868) loss_zs_kd 0.4216 (0.4353) loss_oracle 0.3045 (0.2618) acc 62.5000 (62.5841) kd_loss 0.6864 (0.7463) lr 1.9686e-03 eta 0:30:52
epoch [6/50] batch [280/403] time 0.095 (0.103) data 0.000 (0.004) loss 2.4075 (2.1798) ce_loss 1.2646 (1.0875) loss_zs_kd 0.4131 (0.4349) loss_oracle 0.2780 (0.2621) acc 43.7500 (62.3996) kd_loss 0.7972 (0.7439) lr 1.9686e-03 eta 0:30:45
epoch [6/50] batch [300/403] time 0.096 (0.103) data 0.000 (0.004) loss 2.0650 (2.1784) ce_loss 1.0957 (1.0867) loss_zs_kd 0.4511 (0.4343) loss_oracle 0.3343 (0.2629) acc 59.3750 (62.5000) kd_loss 0.5767 (0.7432) lr 1.9686e-03 eta 0:30:37
epoch [6/50] batch [320/403] time 0.092 (0.102) data 0.000 (0.004) loss 1.9729 (2.1813) ce_loss 0.9780 (1.0875) loss_zs_kd 0.3772 (0.4325) loss_oracle 0.2755 (0.2637) acc 62.5000 (62.4707) kd_loss 0.6686 (0.7457) lr 1.9686e-03 eta 0:30:25
epoch [6/50] batch [340/403] time 0.109 (0.102) data 0.000 (0.004) loss 1.8143 (2.1798) ce_loss 0.6689 (1.0869) loss_zs_kd 0.3510 (0.4311) loss_oracle 0.2198 (0.2628) acc 84.3750 (62.4724) kd_loss 0.8599 (0.7460) lr 1.9686e-03 eta 0:30:21
epoch [6/50] batch [360/403] time 0.112 (0.102) data 0.000 (0.003) loss 2.6566 (2.1823) ce_loss 1.4189 (1.0890) loss_zs_kd 0.6071 (0.4319) loss_oracle 0.2124 (0.2622) acc 53.1250 (62.3351) kd_loss 0.8279 (0.7463) lr 1.9686e-03 eta 0:30:17
epoch [6/50] batch [380/403] time 0.069 (0.102) data 0.000 (0.003) loss 2.2318 (2.1795) ce_loss 1.2051 (1.0891) loss_zs_kd 0.4028 (0.4307) loss_oracle 0.2911 (0.2625) acc 68.7500 (62.4260) kd_loss 0.6798 (0.7437) lr 1.9686e-03 eta 0:30:11
epoch [6/50] batch [400/403] time 0.170 (0.102) data 0.000 (0.003) loss 2.1842 (2.1814) ce_loss 0.9404 (1.0895) loss_zs_kd 0.4657 (0.4308) loss_oracle 0.3316 (0.2641) acc 68.7500 (62.4844) kd_loss 0.8452 (0.7444) lr 1.9686e-03 eta 0:30:15
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,572
* accuracy: 64.5%
* error: 35.5%
* macro_f1: 49.7%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,081
* accuracy: 35.4%
* error: 64.6%
* macro_f1: 26.5%
******* Domain 4 best val acc:      65.3%, epoch: 5 *******
******* Domain 4 best val test acc: 39.1%, epoch: 5 *******
******* Domain 4 best test acc:     39.1%, epoch: 5 *******
epoch [7/50] batch [20/403] time 0.093 (0.135) data 0.000 (0.056) loss 2.0469 (2.1364) ce_loss 0.9736 (1.0705) loss_zs_kd 0.4645 (0.4155) loss_oracle 0.2761 (0.2622) acc 65.6250 (62.9688) kd_loss 0.7029 (0.7270) lr 1.9511e-03 eta 0:39:46
epoch [7/50] batch [40/403] time 0.076 (0.130) data 0.000 (0.028) loss 2.1055 (2.1300) ce_loss 1.0107 (1.0660) loss_zs_kd 0.4720 (0.4231) loss_oracle 0.2625 (0.2569) acc 65.6250 (64.8438) kd_loss 0.7275 (0.7241) lr 1.9511e-03 eta 0:38:21
epoch [7/50] batch [60/403] time 0.171 (0.127) data 0.000 (0.019) loss 2.2090 (2.1344) ce_loss 1.1279 (1.0608) loss_zs_kd 0.3751 (0.4304) loss_oracle 0.2670 (0.2514) acc 59.3750 (65.2604) kd_loss 0.7600 (0.7326) lr 1.9511e-03 eta 0:37:18
epoch [7/50] batch [80/403] time 0.083 (0.121) data 0.000 (0.014) loss 2.0893 (2.1571) ce_loss 1.0283 (1.0677) loss_zs_kd 0.4389 (0.4278) loss_oracle 0.2678 (0.2508) acc 59.3750 (64.6875) kd_loss 0.7076 (0.7501) lr 1.9511e-03 eta 0:35:43
epoch [7/50] batch [100/403] time 0.090 (0.115) data 0.000 (0.011) loss 2.3131 (2.1645) ce_loss 1.3008 (1.0630) loss_zs_kd 0.5905 (0.4269) loss_oracle 0.2734 (0.2563) acc 62.5000 (65.1250) kd_loss 0.5803 (0.7599) lr 1.9511e-03 eta 0:33:46
epoch [7/50] batch [120/403] time 0.097 (0.111) data 0.000 (0.010) loss 2.2459 (2.1805) ce_loss 1.2158 (1.0693) loss_zs_kd 0.4187 (0.4314) loss_oracle 0.2346 (0.2556) acc 59.3750 (64.9219) kd_loss 0.7034 (0.7677) lr 1.9511e-03 eta 0:32:34
epoch [7/50] batch [140/403] time 0.100 (0.110) data 0.000 (0.008) loss 2.3087 (2.1895) ce_loss 1.0938 (1.0709) loss_zs_kd 0.4933 (0.4290) loss_oracle 0.2417 (0.2569) acc 62.5000 (64.7545) kd_loss 0.8474 (0.7757) lr 1.9511e-03 eta 0:32:06
epoch [7/50] batch [160/403] time 0.104 (0.108) data 0.000 (0.007) loss 1.8551 (2.1868) ce_loss 0.7466 (1.0608) loss_zs_kd 0.4508 (0.4258) loss_oracle 0.3006 (0.2569) acc 75.0000 (64.8438) kd_loss 0.7328 (0.7846) lr 1.9511e-03 eta 0:31:37
epoch [7/50] batch [180/403] time 0.111 (0.107) data 0.000 (0.006) loss 2.1687 (2.1937) ce_loss 1.0166 (1.0615) loss_zs_kd 0.4477 (0.4234) loss_oracle 0.2707 (0.2571) acc 62.5000 (64.3924) kd_loss 0.7929 (0.7919) lr 1.9511e-03 eta 0:31:16
epoch [7/50] batch [200/403] time 0.089 (0.106) data 0.000 (0.006) loss 1.8768 (2.2032) ce_loss 0.6323 (1.0633) loss_zs_kd 0.3692 (0.4225) loss_oracle 0.1644 (0.2542) acc 71.8750 (64.2656) kd_loss 0.9777 (0.8016) lr 1.9511e-03 eta 0:31:06
epoch [7/50] batch [220/403] time 0.105 (0.106) data 0.000 (0.005) loss 2.2939 (2.2122) ce_loss 1.0391 (1.0631) loss_zs_kd 0.5364 (0.4273) loss_oracle 0.1837 (0.2512) acc 68.7500 (64.0767) kd_loss 0.8948 (0.8099) lr 1.9511e-03 eta 0:30:58
epoch [7/50] batch [240/403] time 0.093 (0.105) data 0.000 (0.005) loss 2.4543 (2.2278) ce_loss 1.0928 (1.0682) loss_zs_kd 0.5483 (0.4271) loss_oracle 0.2225 (0.2497) acc 56.2500 (63.9844) kd_loss 0.9762 (0.8212) lr 1.9511e-03 eta 0:30:44
epoch [7/50] batch [260/403] time 0.155 (0.104) data 0.000 (0.005) loss 2.4944 (2.2392) ce_loss 1.0674 (1.0702) loss_zs_kd 0.4219 (0.4258) loss_oracle 0.1971 (0.2491) acc 53.1250 (63.7260) kd_loss 1.1175 (0.8316) lr 1.9511e-03 eta 0:30:11
epoch [7/50] batch [280/403] time 0.085 (0.105) data 0.000 (0.004) loss 2.2460 (2.2458) ce_loss 1.0342 (1.0678) loss_zs_kd 0.3843 (0.4266) loss_oracle 0.2733 (0.2491) acc 65.6250 (63.7946) kd_loss 0.8830 (0.8401) lr 1.9511e-03 eta 0:30:33
epoch [7/50] batch [300/403] time 0.194 (0.108) data 0.000 (0.004) loss 2.1670 (2.2522) ce_loss 0.9717 (1.0704) loss_zs_kd 0.4094 (0.4292) loss_oracle 0.2097 (0.2502) acc 65.6250 (63.6979) kd_loss 0.8858 (0.8421) lr 1.9511e-03 eta 0:31:17
epoch [7/50] batch [320/403] time 0.111 (0.107) data 0.000 (0.004) loss 2.1655 (2.2521) ce_loss 1.0410 (1.0685) loss_zs_kd 0.4733 (0.4322) loss_oracle 0.2095 (0.2500) acc 59.3750 (63.7500) kd_loss 0.7832 (0.8425) lr 1.9511e-03 eta 0:30:58
epoch [7/50] batch [340/403] time 0.089 (0.106) data 0.000 (0.004) loss 2.1202 (2.2499) ce_loss 0.8813 (1.0663) loss_zs_kd 0.4242 (0.4317) loss_oracle 0.2100 (0.2506) acc 71.8750 (63.8971) kd_loss 0.9218 (0.8425) lr 1.9511e-03 eta 0:30:45
epoch [7/50] batch [360/403] time 0.100 (0.106) data 0.000 (0.003) loss 2.6613 (2.2531) ce_loss 1.3408 (1.0688) loss_zs_kd 0.3924 (0.4330) loss_oracle 0.2817 (0.2504) acc 50.0000 (63.7500) kd_loss 0.9834 (0.8426) lr 1.9511e-03 eta 0:30:37
epoch [7/50] batch [380/403] time 0.092 (0.106) data 0.000 (0.003) loss 2.3623 (2.2561) ce_loss 1.2158 (1.0700) loss_zs_kd 0.4075 (0.4342) loss_oracle 0.2531 (0.2503) acc 59.3750 (63.5855) kd_loss 0.8162 (0.8438) lr 1.9511e-03 eta 0:30:34
epoch [7/50] batch [400/403] time 0.099 (0.105) data 0.000 (0.003) loss 2.3573 (2.2594) ce_loss 1.2764 (1.0723) loss_zs_kd 0.4494 (0.4342) loss_oracle 0.2373 (0.2498) acc 53.1250 (63.4922) kd_loss 0.7376 (0.8451) lr 1.9511e-03 eta 0:30:22
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,673
* accuracy: 66.4%
* error: 33.6%
* macro_f1: 51.3%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,162
* accuracy: 36.7%
* error: 63.3%
* macro_f1: 27.6%
******* Domain 4 best val acc:      66.4%, epoch: 7 *******
******* Domain 4 best val test acc: 36.7%, epoch: 7 *******
******* Domain 4 best test acc:     39.1%, epoch: 5 *******
epoch [8/50] batch [20/403] time 0.109 (0.155) data 0.000 (0.053) loss 2.4103 (2.2875) ce_loss 1.1201 (1.1061) loss_zs_kd 0.5261 (0.4233) loss_oracle 0.2464 (0.2377) acc 59.3750 (63.7500) kd_loss 0.9040 (0.8509) lr 1.9298e-03 eta 0:44:44
epoch [8/50] batch [40/403] time 0.094 (0.126) data 0.000 (0.026) loss 2.2891 (2.3400) ce_loss 1.0029 (1.1223) loss_zs_kd 0.4397 (0.4461) loss_oracle 0.3371 (0.2485) acc 53.1250 (61.8750) kd_loss 0.8978 (0.8703) lr 1.9298e-03 eta 0:36:11
epoch [8/50] batch [60/403] time 0.118 (0.117) data 0.000 (0.018) loss 2.7148 (2.3286) ce_loss 1.4814 (1.1096) loss_zs_kd 0.4344 (0.4327) loss_oracle 0.2316 (0.2548) acc 46.8750 (62.6562) kd_loss 0.9003 (0.8753) lr 1.9298e-03 eta 0:33:46
epoch [8/50] batch [80/403] time 0.085 (0.113) data 0.000 (0.013) loss 2.5239 (2.3379) ce_loss 1.3672 (1.1098) loss_zs_kd 0.4360 (0.4353) loss_oracle 0.2202 (0.2555) acc 46.8750 (62.5391) kd_loss 0.8286 (0.8827) lr 1.9298e-03 eta 0:32:26
epoch [8/50] batch [100/403] time 0.073 (0.108) data 0.000 (0.011) loss 2.4259 (2.3353) ce_loss 1.1875 (1.1019) loss_zs_kd 0.4909 (0.4405) loss_oracle 0.2717 (0.2550) acc 68.7500 (62.8750) kd_loss 0.8571 (0.8856) lr 1.9298e-03 eta 0:31:00
epoch [8/50] batch [120/403] time 0.168 (0.105) data 0.000 (0.009) loss 2.2333 (2.3264) ce_loss 0.9565 (1.0951) loss_zs_kd 0.3711 (0.4386) loss_oracle 0.2169 (0.2534) acc 65.6250 (62.8125) kd_loss 0.9828 (0.8854) lr 1.9298e-03 eta 0:30:06
epoch [8/50] batch [140/403] time 0.075 (0.106) data 0.000 (0.008) loss 2.0676 (2.3118) ce_loss 0.7734 (1.0859) loss_zs_kd 0.4741 (0.4348) loss_oracle 0.2981 (0.2566) acc 84.3750 (63.2366) kd_loss 0.9080 (0.8803) lr 1.9298e-03 eta 0:30:25
epoch [8/50] batch [160/403] time 0.170 (0.108) data 0.000 (0.007) loss 2.1491 (2.3091) ce_loss 0.9229 (1.0815) loss_zs_kd 0.4372 (0.4377) loss_oracle 0.2617 (0.2593) acc 68.7500 (63.3398) kd_loss 0.8768 (0.8791) lr 1.9298e-03 eta 0:31:00
epoch [8/50] batch [180/403] time 0.082 (0.107) data 0.000 (0.006) loss 2.1100 (2.3028) ce_loss 0.8081 (1.0771) loss_zs_kd 0.4165 (0.4369) loss_oracle 0.2566 (0.2606) acc 78.1250 (63.5069) kd_loss 0.9654 (0.8769) lr 1.9298e-03 eta 0:30:42
epoch [8/50] batch [200/403] time 0.090 (0.106) data 0.000 (0.006) loss 2.1543 (2.2997) ce_loss 1.0400 (1.0732) loss_zs_kd 0.3272 (0.4382) loss_oracle 0.2398 (0.2612) acc 65.6250 (63.6250) kd_loss 0.8308 (0.8767) lr 1.9298e-03 eta 0:30:12
epoch [8/50] batch [220/403] time 0.098 (0.105) data 0.000 (0.005) loss 2.4649 (2.3046) ce_loss 1.2178 (1.0741) loss_zs_kd 0.4712 (0.4348) loss_oracle 0.2878 (0.2632) acc 46.8750 (63.6364) kd_loss 0.8676 (0.8815) lr 1.9298e-03 eta 0:29:58
epoch [8/50] batch [240/403] time 0.079 (0.104) data 0.000 (0.005) loss 2.0688 (2.3089) ce_loss 0.9233 (1.0734) loss_zs_kd 0.4610 (0.4362) loss_oracle 0.2349 (0.2644) acc 65.6250 (63.7109) kd_loss 0.7975 (0.8852) lr 1.9298e-03 eta 0:29:34
epoch [8/50] batch [260/403] time 0.084 (0.102) data 0.000 (0.004) loss 2.5192 (2.3131) ce_loss 1.1387 (1.0753) loss_zs_kd 0.5185 (0.4345) loss_oracle 0.2571 (0.2651) acc 71.8750 (63.7019) kd_loss 0.9927 (0.8880) lr 1.9298e-03 eta 0:29:07
epoch [8/50] batch [280/403] time 0.094 (0.102) data 0.000 (0.004) loss 2.2407 (2.3130) ce_loss 0.9424 (1.0726) loss_zs_kd 0.5328 (0.4355) loss_oracle 0.3073 (0.2644) acc 68.7500 (63.7835) kd_loss 0.8782 (0.8905) lr 1.9298e-03 eta 0:28:50
epoch [8/50] batch [300/403] time 0.090 (0.101) data 0.000 (0.004) loss 2.3087 (2.3139) ce_loss 1.1074 (1.0718) loss_zs_kd 0.4443 (0.4383) loss_oracle 0.2375 (0.2640) acc 65.6250 (63.7604) kd_loss 0.8604 (0.8910) lr 1.9298e-03 eta 0:28:32
epoch [8/50] batch [320/403] time 0.118 (0.100) data 0.000 (0.004) loss 2.3834 (2.3129) ce_loss 1.1797 (1.0688) loss_zs_kd 0.4519 (0.4366) loss_oracle 0.3032 (0.2639) acc 68.7500 (63.8379) kd_loss 0.8261 (0.8938) lr 1.9298e-03 eta 0:28:24
epoch [8/50] batch [340/403] time 0.057 (0.099) data 0.000 (0.003) loss 2.1915 (2.3132) ce_loss 0.7886 (1.0669) loss_zs_kd 0.4202 (0.4375) loss_oracle 0.2730 (0.2637) acc 75.0000 (63.8787) kd_loss 1.0563 (0.8957) lr 1.9298e-03 eta 0:28:06
epoch [8/50] batch [360/403] time 0.172 (0.101) data 0.000 (0.003) loss 2.3310 (2.3150) ce_loss 1.0957 (1.0670) loss_zs_kd 0.5403 (0.4376) loss_oracle 0.2966 (0.2655) acc 56.2500 (63.8368) kd_loss 0.8168 (0.8964) lr 1.9298e-03 eta 0:28:28
epoch [8/50] batch [380/403] time 0.156 (0.100) data 0.000 (0.003) loss 2.2971 (2.3137) ce_loss 1.1455 (1.0657) loss_zs_kd 0.4199 (0.4368) loss_oracle 0.2602 (0.2661) acc 62.5000 (63.8240) kd_loss 0.8116 (0.8966) lr 1.9298e-03 eta 0:28:17
epoch [8/50] batch [400/403] time 0.070 (0.102) data 0.000 (0.003) loss 1.9660 (2.3131) ce_loss 0.8008 (1.0632) loss_zs_kd 0.3605 (0.4378) loss_oracle 0.2549 (0.2665) acc 75.0000 (63.9453) kd_loss 0.8575 (0.8977) lr 1.9298e-03 eta 0:28:53
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,541
* accuracy: 64.0%
* error: 36.0%
* macro_f1: 50.9%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,201
* accuracy: 37.4%
* error: 62.6%
* macro_f1: 27.6%
******* Domain 4 best val acc:      66.4%, epoch: 7 *******
******* Domain 4 best val test acc: 36.7%, epoch: 7 *******
******* Domain 4 best test acc:     39.1%, epoch: 5 *******
epoch [9/50] batch [20/403] time 0.079 (0.173) data 0.000 (0.057) loss 1.9838 (2.3127) ce_loss 0.8076 (1.0059) loss_zs_kd 0.3783 (0.4645) loss_oracle 0.2927 (0.2710) acc 78.1250 (67.6562) kd_loss 0.8406 (0.9390) lr 1.9048e-03 eta 0:48:38
epoch [9/50] batch [40/403] time 0.097 (0.131) data 0.000 (0.028) loss 2.4172 (2.3156) ce_loss 1.1904 (1.0368) loss_zs_kd 0.4592 (0.4453) loss_oracle 0.2722 (0.2745) acc 56.2500 (66.2500) kd_loss 0.8610 (0.9189) lr 1.9048e-03 eta 0:36:52
epoch [9/50] batch [60/403] time 0.090 (0.119) data 0.000 (0.019) loss 2.1684 (2.3234) ce_loss 0.9385 (1.0309) loss_zs_kd 0.4878 (0.4493) loss_oracle 0.3041 (0.2805) acc 62.5000 (65.8854) kd_loss 0.8340 (0.9277) lr 1.9048e-03 eta 0:33:32
epoch [9/50] batch [80/403] time 0.112 (0.114) data 0.000 (0.014) loss 2.1972 (2.3289) ce_loss 0.8999 (1.0308) loss_zs_kd 0.5419 (0.4490) loss_oracle 0.2785 (0.2832) acc 71.8750 (65.5078) kd_loss 0.8870 (0.9319) lr 1.9048e-03 eta 0:32:07
epoch [9/50] batch [100/403] time 0.109 (0.111) data 0.000 (0.012) loss 2.3042 (2.3419) ce_loss 0.9443 (1.0367) loss_zs_kd 0.5052 (0.4529) loss_oracle 0.2743 (0.2838) acc 65.6250 (64.6250) kd_loss 0.9701 (0.9368) lr 1.9048e-03 eta 0:31:09
epoch [9/50] batch [120/403] time 0.093 (0.109) data 0.000 (0.010) loss 2.4129 (2.3554) ce_loss 0.9844 (1.0496) loss_zs_kd 0.4197 (0.4457) loss_oracle 0.2973 (0.2848) acc 75.0000 (64.2708) kd_loss 1.0700 (0.9405) lr 1.9048e-03 eta 0:30:24
epoch [9/50] batch [140/403] time 0.088 (0.107) data 0.000 (0.008) loss 2.3313 (2.3564) ce_loss 1.0547 (1.0544) loss_zs_kd 0.4325 (0.4473) loss_oracle 0.2626 (0.2813) acc 75.0000 (64.3973) kd_loss 0.9290 (0.9377) lr 1.9048e-03 eta 0:29:53
epoch [9/50] batch [160/403] time 0.092 (0.106) data 0.000 (0.007) loss 2.4103 (2.3570) ce_loss 1.1045 (1.0601) loss_zs_kd 0.5049 (0.4452) loss_oracle 0.2958 (0.2782) acc 62.5000 (64.1406) kd_loss 0.9055 (0.9353) lr 1.9048e-03 eta 0:29:37
epoch [9/50] batch [180/403] time 0.088 (0.105) data 0.000 (0.007) loss 2.2594 (2.3512) ce_loss 0.9204 (1.0536) loss_zs_kd 0.3822 (0.4498) loss_oracle 0.2732 (0.2773) acc 65.6250 (64.5660) kd_loss 1.0113 (0.9341) lr 1.9048e-03 eta 0:29:14
epoch [9/50] batch [200/403] time 0.067 (0.103) data 0.000 (0.006) loss 2.3845 (2.3565) ce_loss 1.1885 (1.0622) loss_zs_kd 0.3990 (0.4476) loss_oracle 0.2862 (0.2750) acc 53.1250 (64.0000) kd_loss 0.8535 (0.9330) lr 1.9048e-03 eta 0:28:39
epoch [9/50] batch [220/403] time 0.074 (0.105) data 0.000 (0.005) loss 2.2008 (2.3561) ce_loss 1.0137 (1.0635) loss_zs_kd 0.4463 (0.4490) loss_oracle 0.2877 (0.2736) acc 71.8750 (64.0483) kd_loss 0.8201 (0.9314) lr 1.9048e-03 eta 0:29:08
epoch [9/50] batch [240/403] time 0.178 (0.102) data 0.000 (0.005) loss 2.0502 (2.3534) ce_loss 0.8257 (1.0656) loss_zs_kd 0.3440 (0.4495) loss_oracle 0.2231 (0.2724) acc 71.8750 (64.0104) kd_loss 0.9410 (0.9269) lr 1.9048e-03 eta 0:28:29
epoch [9/50] batch [260/403] time 0.080 (0.106) data 0.000 (0.005) loss 2.7486 (2.3513) ce_loss 1.2998 (1.0633) loss_zs_kd 0.4669 (0.4511) loss_oracle 0.2635 (0.2712) acc 50.0000 (64.1587) kd_loss 1.0835 (0.9268) lr 1.9048e-03 eta 0:29:18
epoch [9/50] batch [280/403] time 0.105 (0.104) data 0.000 (0.004) loss 2.0678 (2.3540) ce_loss 0.8672 (1.0689) loss_zs_kd 0.4273 (0.4493) loss_oracle 0.2749 (0.2709) acc 62.5000 (64.0402) kd_loss 0.8495 (0.9250) lr 1.9048e-03 eta 0:28:54
epoch [9/50] batch [300/403] time 0.099 (0.104) data 0.000 (0.004) loss 2.2626 (2.3550) ce_loss 1.0537 (1.0692) loss_zs_kd 0.4550 (0.4488) loss_oracle 0.2207 (0.2706) acc 62.5000 (63.8229) kd_loss 0.8710 (0.9261) lr 1.9048e-03 eta 0:28:48
epoch [9/50] batch [320/403] time 0.098 (0.104) data 0.000 (0.004) loss 2.2760 (2.3532) ce_loss 1.0215 (1.0670) loss_zs_kd 0.4665 (0.4478) loss_oracle 0.2773 (0.2704) acc 65.6250 (63.9062) kd_loss 0.8826 (0.9270) lr 1.9048e-03 eta 0:28:43
epoch [9/50] batch [340/403] time 0.102 (0.104) data 0.000 (0.004) loss 2.2529 (2.3516) ce_loss 0.9355 (1.0646) loss_zs_kd 0.4787 (0.4468) loss_oracle 0.2657 (0.2708) acc 65.6250 (64.0625) kd_loss 0.9452 (0.9282) lr 1.9048e-03 eta 0:28:38
epoch [9/50] batch [360/403] time 0.101 (0.103) data 0.000 (0.003) loss 2.2811 (2.3518) ce_loss 0.9180 (1.0616) loss_zs_kd 0.4045 (0.4465) loss_oracle 0.2657 (0.2709) acc 65.6250 (64.1840) kd_loss 1.0280 (0.9314) lr 1.9048e-03 eta 0:28:33
epoch [9/50] batch [380/403] time 0.093 (0.103) data 0.000 (0.003) loss 2.0675 (2.3548) ce_loss 0.8867 (1.0631) loss_zs_kd 0.3923 (0.4464) loss_oracle 0.2404 (0.2697) acc 78.1250 (64.0789) kd_loss 0.8645 (0.9336) lr 1.9048e-03 eta 0:28:29
epoch [9/50] batch [400/403] time 0.093 (0.103) data 0.000 (0.003) loss 2.3660 (2.3548) ce_loss 1.0693 (1.0629) loss_zs_kd 0.5040 (0.4444) loss_oracle 0.3050 (0.2685) acc 65.6250 (64.0625) kd_loss 0.8921 (0.9355) lr 1.9048e-03 eta 0:28:20
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,637
* accuracy: 65.7%
* error: 34.3%
* macro_f1: 50.2%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,331
* accuracy: 39.6%
* error: 60.4%
* macro_f1: 29.0%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      66.4%, epoch: 7 *******
******* Domain 4 best val test acc: 36.7%, epoch: 7 *******
******* Domain 4 best test acc:     39.6%, epoch: 9 *******
epoch [10/50] batch [20/403] time 0.093 (0.161) data 0.000 (0.062) loss 2.5134 (2.4369) ce_loss 1.0654 (1.0987) loss_zs_kd 0.4387 (0.4527) loss_oracle 0.2552 (0.2604) acc 65.6250 (63.5938) kd_loss 1.1011 (0.9817) lr 1.8763e-03 eta 0:44:10
epoch [10/50] batch [40/403] time 0.098 (0.129) data 0.000 (0.031) loss 2.4429 (2.3989) ce_loss 1.1143 (1.0681) loss_zs_kd 0.4611 (0.4414) loss_oracle 0.2347 (0.2603) acc 56.2500 (64.5312) kd_loss 0.9807 (0.9799) lr 1.8763e-03 eta 0:35:34
epoch [10/50] batch [60/403] time 0.081 (0.117) data 0.000 (0.021) loss 2.2068 (2.3868) ce_loss 0.9116 (1.0600) loss_zs_kd 0.5144 (0.4428) loss_oracle 0.2809 (0.2636) acc 62.5000 (64.4792) kd_loss 0.8975 (0.9736) lr 1.8763e-03 eta 0:32:14
epoch [10/50] batch [80/403] time 0.197 (0.114) data 0.000 (0.016) loss 2.6632 (2.3901) ce_loss 1.3340 (1.0659) loss_zs_kd 0.3936 (0.4457) loss_oracle 0.2473 (0.2665) acc 50.0000 (63.9062) kd_loss 1.0088 (0.9682) lr 1.8763e-03 eta 0:31:16
epoch [10/50] batch [100/403] time 0.097 (0.112) data 0.000 (0.013) loss 2.2471 (2.3776) ce_loss 0.9150 (1.0522) loss_zs_kd 0.4939 (0.4447) loss_oracle 0.2513 (0.2654) acc 65.6250 (64.3438) kd_loss 0.9595 (0.9703) lr 1.8763e-03 eta 0:30:41
epoch [10/50] batch [120/403] time 0.144 (0.116) data 0.000 (0.011) loss 2.4437 (2.3954) ce_loss 0.9893 (1.0641) loss_zs_kd 0.4843 (0.4444) loss_oracle 0.2802 (0.2617) acc 71.8750 (63.8281) kd_loss 1.0722 (0.9781) lr 1.8763e-03 eta 0:31:35
epoch [10/50] batch [140/403] time 0.083 (0.113) data 0.000 (0.009) loss 2.4270 (2.4080) ce_loss 1.0830 (1.0746) loss_zs_kd 0.4113 (0.4446) loss_oracle 0.2902 (0.2621) acc 62.5000 (63.4598) kd_loss 0.9932 (0.9801) lr 1.8763e-03 eta 0:30:58
epoch [10/50] batch [160/403] time 0.113 (0.111) data 0.000 (0.008) loss 2.5317 (2.4067) ce_loss 1.0469 (1.0750) loss_zs_kd 0.5797 (0.4453) loss_oracle 0.2950 (0.2597) acc 59.3750 (63.4961) kd_loss 1.0474 (0.9792) lr 1.8763e-03 eta 0:30:14
epoch [10/50] batch [180/403] time 0.107 (0.110) data 0.000 (0.007) loss 2.8670 (2.4060) ce_loss 1.4785 (1.0762) loss_zs_kd 0.5161 (0.4457) loss_oracle 0.2881 (0.2583) acc 50.0000 (63.5069) kd_loss 0.9864 (0.9778) lr 1.8763e-03 eta 0:29:56
epoch [10/50] batch [200/403] time 0.080 (0.108) data 0.000 (0.006) loss 2.2776 (2.3986) ce_loss 1.0088 (1.0697) loss_zs_kd 0.3572 (0.4427) loss_oracle 0.2301 (0.2589) acc 62.5000 (63.6719) kd_loss 0.9752 (0.9781) lr 1.8763e-03 eta 0:29:17
epoch [10/50] batch [220/403] time 0.103 (0.106) data 0.000 (0.006) loss 2.1619 (2.3963) ce_loss 1.0430 (1.0679) loss_zs_kd 0.3631 (0.4443) loss_oracle 0.2457 (0.2585) acc 62.5000 (63.7642) kd_loss 0.8146 (0.9770) lr 1.8763e-03 eta 0:28:49
epoch [10/50] batch [240/403] time 0.106 (0.106) data 0.000 (0.005) loss 2.5940 (2.3949) ce_loss 1.2617 (1.0683) loss_zs_kd 0.4753 (0.4421) loss_oracle 0.3064 (0.2580) acc 59.3750 (63.6849) kd_loss 0.9415 (0.9765) lr 1.8763e-03 eta 0:28:44
epoch [10/50] batch [260/403] time 0.093 (0.105) data 0.000 (0.005) loss 2.2119 (2.3898) ce_loss 0.9038 (1.0640) loss_zs_kd 0.4461 (0.4422) loss_oracle 0.2614 (0.2600) acc 68.7500 (63.8582) kd_loss 0.9543 (0.9747) lr 1.8763e-03 eta 0:28:35
epoch [10/50] batch [280/403] time 0.099 (0.105) data 0.000 (0.005) loss 2.4566 (2.3875) ce_loss 1.0957 (1.0630) loss_zs_kd 0.5443 (0.4434) loss_oracle 0.2959 (0.2607) acc 62.5000 (63.8951) kd_loss 0.9408 (0.9724) lr 1.8763e-03 eta 0:28:21
epoch [10/50] batch [300/403] time 0.086 (0.104) data 0.000 (0.004) loss 2.3105 (2.3857) ce_loss 1.0801 (1.0656) loss_zs_kd 0.4079 (0.4431) loss_oracle 0.2547 (0.2616) acc 62.5000 (63.7396) kd_loss 0.8991 (0.9678) lr 1.8763e-03 eta 0:28:10
epoch [10/50] batch [320/403] time 0.081 (0.103) data 0.000 (0.004) loss 2.1476 (2.3850) ce_loss 0.8584 (1.0667) loss_zs_kd 0.4382 (0.4433) loss_oracle 0.2617 (0.2622) acc 71.8750 (63.7695) kd_loss 0.9393 (0.9656) lr 1.8763e-03 eta 0:27:46
epoch [10/50] batch [340/403] time 0.074 (0.104) data 0.001 (0.004) loss 2.5404 (2.3851) ce_loss 1.2471 (1.0685) loss_zs_kd 0.4185 (0.4422) loss_oracle 0.2667 (0.2631) acc 56.2500 (63.4835) kd_loss 0.9507 (0.9639) lr 1.8763e-03 eta 0:28:07
epoch [10/50] batch [360/403] time 0.082 (0.103) data 0.000 (0.004) loss 2.7159 (2.3811) ce_loss 1.3789 (1.0652) loss_zs_kd 0.6067 (0.4413) loss_oracle 0.2766 (0.2637) acc 50.0000 (63.5590) kd_loss 0.8953 (0.9634) lr 1.8763e-03 eta 0:27:46
epoch [10/50] batch [380/403] time 0.064 (0.105) data 0.000 (0.004) loss 2.3604 (2.3783) ce_loss 1.0342 (1.0637) loss_zs_kd 0.4590 (0.4410) loss_oracle 0.3078 (0.2645) acc 68.7500 (63.6102) kd_loss 0.9429 (0.9618) lr 1.8763e-03 eta 0:28:21
epoch [10/50] batch [400/403] time 0.072 (0.104) data 0.000 (0.003) loss 2.4201 (2.3797) ce_loss 1.1504 (1.0633) loss_zs_kd 0.4796 (0.4414) loss_oracle 0.2043 (0.2653) acc 59.3750 (63.6484) kd_loss 0.9277 (0.9631) lr 1.8763e-03 eta 0:27:50
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,688
* accuracy: 66.6%
* error: 33.4%
* macro_f1: 51.1%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,206
* accuracy: 37.5%
* error: 62.5%
* macro_f1: 28.4%
******* Domain 4 best val acc:      66.6%, epoch: 10 *******
******* Domain 4 best val test acc: 37.5%, epoch: 10 *******
******* Domain 4 best test acc:     39.6%, epoch: 9 *******
epoch [11/50] batch [20/403] time 0.085 (0.175) data 0.000 (0.084) loss 2.4730 (2.3793) ce_loss 1.1768 (1.0609) loss_zs_kd 0.4191 (0.4407) loss_oracle 0.2900 (0.2776) acc 62.5000 (64.3750) kd_loss 0.9417 (0.9593) lr 1.8443e-03 eta 0:46:53
epoch [11/50] batch [40/403] time 0.090 (0.131) data 0.000 (0.042) loss 2.3492 (2.4069) ce_loss 0.9717 (1.0778) loss_zs_kd 0.5147 (0.4420) loss_oracle 0.2858 (0.2780) acc 65.6250 (63.0469) kd_loss 0.9772 (0.9692) lr 1.8443e-03 eta 0:35:09
epoch [11/50] batch [60/403] time 0.087 (0.120) data 0.000 (0.028) loss 2.3207 (2.3797) ce_loss 0.9805 (1.0600) loss_zs_kd 0.4174 (0.4423) loss_oracle 0.2633 (0.2793) acc 78.1250 (63.8021) kd_loss 0.9999 (0.9588) lr 1.8443e-03 eta 0:32:00
epoch [11/50] batch [80/403] time 0.081 (0.111) data 0.000 (0.021) loss 2.3383 (2.3597) ce_loss 1.0723 (1.0476) loss_zs_kd 0.4867 (0.4399) loss_oracle 0.3466 (0.2802) acc 68.7500 (64.6094) kd_loss 0.8494 (0.9521) lr 1.8443e-03 eta 0:29:45
epoch [11/50] batch [100/403] time 0.099 (0.106) data 0.000 (0.017) loss 2.2895 (2.3726) ce_loss 0.9604 (1.0568) loss_zs_kd 0.3897 (0.4483) loss_oracle 0.2816 (0.2825) acc 68.7500 (64.0000) kd_loss 0.9933 (0.9504) lr 1.8443e-03 eta 0:28:25
epoch [11/50] batch [120/403] time 0.093 (0.104) data 0.000 (0.014) loss 2.3730 (2.3611) ce_loss 0.9878 (1.0524) loss_zs_kd 0.4955 (0.4427) loss_oracle 0.3431 (0.2852) acc 65.6250 (64.1406) kd_loss 0.9659 (0.9448) lr 1.8443e-03 eta 0:27:39
epoch [11/50] batch [140/403] time 0.083 (0.101) data 0.000 (0.012) loss 2.2573 (2.3566) ce_loss 0.8203 (1.0501) loss_zs_kd 0.5745 (0.4419) loss_oracle 0.3225 (0.2875) acc 81.2500 (64.1295) kd_loss 0.9885 (0.9418) lr 1.8443e-03 eta 0:26:55
epoch [11/50] batch [160/403] time 0.062 (0.099) data 0.000 (0.011) loss 2.3774 (2.3568) ce_loss 1.0000 (1.0468) loss_zs_kd 0.6398 (0.4479) loss_oracle 0.2864 (0.2882) acc 68.7500 (64.2578) kd_loss 0.9143 (0.9420) lr 1.8443e-03 eta 0:26:17
epoch [11/50] batch [180/403] time 0.078 (0.097) data 0.000 (0.010) loss 2.4571 (2.3589) ce_loss 0.9985 (1.0457) loss_zs_kd 0.4438 (0.4493) loss_oracle 0.2789 (0.2874) acc 59.3750 (64.0278) kd_loss 1.0972 (0.9449) lr 1.8443e-03 eta 0:25:38
epoch [11/50] batch [200/403] time 0.080 (0.099) data 0.000 (0.009) loss 2.3538 (2.3574) ce_loss 1.0205 (1.0440) loss_zs_kd 0.5548 (0.4505) loss_oracle 0.3265 (0.2886) acc 78.1250 (64.3125) kd_loss 0.8926 (0.9438) lr 1.8443e-03 eta 0:26:22
epoch [11/50] batch [220/403] time 0.083 (0.098) data 0.000 (0.008) loss 2.3450 (2.3671) ce_loss 1.1670 (1.0510) loss_zs_kd 0.3428 (0.4496) loss_oracle 0.2394 (0.2881) acc 59.3750 (64.1477) kd_loss 0.8869 (0.9473) lr 1.8443e-03 eta 0:25:53
epoch [11/50] batch [240/403] time 0.161 (0.102) data 0.000 (0.007) loss 2.6345 (2.3683) ce_loss 1.3057 (1.0530) loss_zs_kd 0.4962 (0.4471) loss_oracle 0.3002 (0.2868) acc 43.7500 (64.0755) kd_loss 0.9307 (0.9484) lr 1.8443e-03 eta 0:26:56
epoch [11/50] batch [260/403] time 0.090 (0.101) data 0.000 (0.007) loss 2.3168 (2.3676) ce_loss 0.9521 (1.0513) loss_zs_kd 0.4561 (0.4455) loss_oracle 0.3132 (0.2872) acc 71.8750 (64.1827) kd_loss 0.9800 (0.9500) lr 1.8443e-03 eta 0:26:37
epoch [11/50] batch [280/403] time 0.088 (0.100) data 0.000 (0.006) loss 2.1640 (2.3695) ce_loss 0.7769 (1.0526) loss_zs_kd 0.5214 (0.4485) loss_oracle 0.3018 (0.2862) acc 81.2500 (64.1741) kd_loss 0.9755 (0.9495) lr 1.8443e-03 eta 0:26:31
epoch [11/50] batch [300/403] time 0.094 (0.100) data 0.000 (0.006) loss 2.0581 (2.3718) ce_loss 0.8545 (1.0531) loss_zs_kd 0.3026 (0.4488) loss_oracle 0.2103 (0.2846) acc 62.5000 (64.1146) kd_loss 0.9472 (0.9521) lr 1.8443e-03 eta 0:26:27
epoch [11/50] batch [320/403] time 0.092 (0.100) data 0.000 (0.006) loss 2.5716 (2.3720) ce_loss 1.1572 (1.0536) loss_zs_kd 0.4686 (0.4477) loss_oracle 0.2232 (0.2834) acc 53.1250 (64.1699) kd_loss 1.0685 (0.9529) lr 1.8443e-03 eta 0:26:19
epoch [11/50] batch [340/403] time 0.109 (0.100) data 0.000 (0.005) loss 2.4340 (2.3725) ce_loss 1.0879 (1.0561) loss_zs_kd 0.5175 (0.4483) loss_oracle 0.2684 (0.2814) acc 53.1250 (64.0901) kd_loss 0.9531 (0.9515) lr 1.8443e-03 eta 0:26:14
epoch [11/50] batch [360/403] time 0.099 (0.100) data 0.000 (0.005) loss 2.5390 (2.3725) ce_loss 1.0225 (1.0555) loss_zs_kd 0.5207 (0.4486) loss_oracle 0.2668 (0.2808) acc 65.6250 (64.0191) kd_loss 1.1227 (0.9523) lr 1.8443e-03 eta 0:26:09
epoch [11/50] batch [380/403] time 0.089 (0.099) data 0.000 (0.005) loss 2.6009 (2.3728) ce_loss 1.1895 (1.0539) loss_zs_kd 0.4840 (0.4491) loss_oracle 0.2697 (0.2804) acc 50.0000 (64.0872) kd_loss 1.0346 (0.9541) lr 1.8443e-03 eta 0:26:01
epoch [11/50] batch [400/403] time 0.092 (0.099) data 0.000 (0.004) loss 2.4097 (2.3756) ce_loss 0.9756 (1.0551) loss_zs_kd 0.5054 (0.4499) loss_oracle 0.2655 (0.2795) acc 68.7500 (64.0625) kd_loss 1.0487 (0.9558) lr 1.8443e-03 eta 0:25:57
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,711
* accuracy: 67.0%
* error: 33.0%
* macro_f1: 51.3%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,366
* accuracy: 40.2%
* error: 59.8%
* macro_f1: 29.4%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      67.0%, epoch: 11 *******
******* Domain 4 best val test acc: 40.2%, epoch: 11 *******
******* Domain 4 best test acc:     40.2%, epoch: 11 *******
epoch [12/50] batch [20/403] time 0.113 (0.200) data 0.000 (0.096) loss 2.4257 (2.3750) ce_loss 1.1045 (1.0630) loss_zs_kd 0.4679 (0.4397) loss_oracle 0.2215 (0.2563) acc 59.3750 (63.7500) kd_loss 0.9765 (0.9640) lr 1.8090e-03 eta 0:52:15
epoch [12/50] batch [40/403] time 0.083 (0.144) data 0.000 (0.048) loss 2.8825 (2.3989) ce_loss 1.5654 (1.0800) loss_zs_kd 0.5131 (0.4444) loss_oracle 0.2507 (0.2651) acc 40.6250 (63.2031) kd_loss 0.9351 (0.9642) lr 1.8090e-03 eta 0:37:30
epoch [12/50] batch [60/403] time 0.170 (0.133) data 0.000 (0.032) loss 2.5411 (2.3933) ce_loss 1.1729 (1.0648) loss_zs_kd 0.3913 (0.4493) loss_oracle 0.2619 (0.2703) acc 59.3750 (62.9688) kd_loss 1.0416 (0.9687) lr 1.8090e-03 eta 0:34:35
epoch [12/50] batch [80/403] time 0.063 (0.122) data 0.000 (0.024) loss 2.6690 (2.3915) ce_loss 1.2910 (1.0573) loss_zs_kd 0.4826 (0.4518) loss_oracle 0.3063 (0.2782) acc 59.3750 (63.2812) kd_loss 0.9835 (0.9692) lr 1.8090e-03 eta 0:31:45
epoch [12/50] batch [100/403] time 0.076 (0.111) data 0.000 (0.019) loss 2.0003 (2.3875) ce_loss 0.8086 (1.0513) loss_zs_kd 0.4828 (0.4487) loss_oracle 0.2828 (0.2803) acc 78.1250 (63.6562) kd_loss 0.8089 (0.9718) lr 1.8090e-03 eta 0:29:00
epoch [12/50] batch [120/403] time 0.061 (0.117) data 0.000 (0.016) loss 2.7132 (2.3887) ce_loss 1.2617 (1.0484) loss_zs_kd 0.5846 (0.4544) loss_oracle 0.2439 (0.2785) acc 56.2500 (63.6719) kd_loss 1.0373 (0.9739) lr 1.8090e-03 eta 0:30:28
epoch [12/50] batch [140/403] time 0.101 (0.111) data 0.000 (0.014) loss 2.4384 (2.3914) ce_loss 1.0479 (1.0482) loss_zs_kd 0.4716 (0.4573) loss_oracle 0.2407 (0.2763) acc 71.8750 (63.6607) kd_loss 1.0343 (0.9765) lr 1.8090e-03 eta 0:28:55
epoch [12/50] batch [160/403] time 0.092 (0.109) data 0.000 (0.012) loss 2.4841 (2.3964) ce_loss 1.1406 (1.0523) loss_zs_kd 0.4042 (0.4573) loss_oracle 0.3188 (0.2764) acc 50.0000 (63.7305) kd_loss 0.9819 (0.9773) lr 1.8090e-03 eta 0:28:19
epoch [12/50] batch [180/403] time 0.099 (0.108) data 0.000 (0.011) loss 2.7863 (2.4036) ce_loss 1.3594 (1.0609) loss_zs_kd 0.5596 (0.4533) loss_oracle 0.2957 (0.2766) acc 46.8750 (63.2986) kd_loss 0.9992 (0.9777) lr 1.8090e-03 eta 0:27:57
epoch [12/50] batch [200/403] time 0.104 (0.108) data 0.000 (0.010) loss 2.3285 (2.4026) ce_loss 0.9775 (1.0579) loss_zs_kd 0.4407 (0.4526) loss_oracle 0.2769 (0.2764) acc 56.2500 (63.3125) kd_loss 0.9922 (0.9802) lr 1.8090e-03 eta 0:27:48
epoch [12/50] batch [220/403] time 0.093 (0.107) data 0.000 (0.009) loss 2.3465 (2.3999) ce_loss 0.8823 (1.0510) loss_zs_kd 0.4897 (0.4546) loss_oracle 0.3176 (0.2774) acc 71.8750 (63.6932) kd_loss 1.0605 (0.9829) lr 1.8090e-03 eta 0:27:41
epoch [12/50] batch [240/403] time 0.100 (0.107) data 0.000 (0.008) loss 2.3739 (2.3992) ce_loss 0.9897 (1.0527) loss_zs_kd 0.5007 (0.4542) loss_oracle 0.2534 (0.2767) acc 59.3750 (63.5807) kd_loss 1.0071 (0.9810) lr 1.8090e-03 eta 0:27:30
epoch [12/50] batch [260/403] time 0.104 (0.106) data 0.000 (0.008) loss 2.4619 (2.3994) ce_loss 1.1299 (1.0541) loss_zs_kd 0.3828 (0.4530) loss_oracle 0.3085 (0.2786) acc 68.7500 (63.6659) kd_loss 0.9864 (0.9795) lr 1.8090e-03 eta 0:27:18
epoch [12/50] batch [280/403] time 0.106 (0.106) data 0.000 (0.007) loss 2.2330 (2.3954) ce_loss 0.8652 (1.0509) loss_zs_kd 0.4573 (0.4524) loss_oracle 0.3269 (0.2817) acc 68.7500 (63.9286) kd_loss 0.9757 (0.9775) lr 1.8090e-03 eta 0:27:12
epoch [12/50] batch [300/403] time 0.080 (0.105) data 0.000 (0.007) loss 2.5100 (2.3969) ce_loss 1.0918 (1.0521) loss_zs_kd 0.4574 (0.4511) loss_oracle 0.3500 (0.2860) acc 59.3750 (63.8750) kd_loss 1.0145 (0.9762) lr 1.8090e-03 eta 0:26:56
epoch [12/50] batch [320/403] time 0.174 (0.104) data 0.000 (0.006) loss 2.2386 (2.3996) ce_loss 0.8638 (1.0516) loss_zs_kd 0.5950 (0.4531) loss_oracle 0.2991 (0.2885) acc 75.0000 (64.0039) kd_loss 0.9278 (0.9772) lr 1.8090e-03 eta 0:26:41
epoch [12/50] batch [340/403] time 0.080 (0.105) data 0.000 (0.006) loss 2.6339 (2.4040) ce_loss 1.1289 (1.0534) loss_zs_kd 0.4939 (0.4535) loss_oracle 0.3354 (0.2906) acc 59.3750 (64.0625) kd_loss 1.0903 (0.9785) lr 1.8090e-03 eta 0:26:52
epoch [12/50] batch [360/403] time 0.163 (0.106) data 0.000 (0.006) loss 2.2641 (2.4033) ce_loss 1.0908 (1.0527) loss_zs_kd 0.3649 (0.4539) loss_oracle 0.2875 (0.2918) acc 62.5000 (64.1840) kd_loss 0.8471 (0.9778) lr 1.8090e-03 eta 0:27:02
epoch [12/50] batch [380/403] time 0.078 (0.106) data 0.000 (0.005) loss 2.6884 (2.4036) ce_loss 1.1836 (1.0521) loss_zs_kd 0.5895 (0.4543) loss_oracle 0.3653 (0.2922) acc 62.5000 (64.3010) kd_loss 1.0274 (0.9783) lr 1.8090e-03 eta 0:27:02
epoch [12/50] batch [400/403] time 0.088 (0.105) data 0.000 (0.005) loss 2.7670 (2.4019) ce_loss 1.4141 (1.0524) loss_zs_kd 0.3274 (0.4527) loss_oracle 0.3313 (0.2934) acc 56.2500 (64.2734) kd_loss 1.0236 (0.9765) lr 1.8090e-03 eta 0:26:44
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,649
* accuracy: 65.9%
* error: 34.1%
* macro_f1: 50.5%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,367
* accuracy: 40.2%
* error: 59.8%
* macro_f1: 29.5%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      67.0%, epoch: 11 *******
******* Domain 4 best val test acc: 40.2%, epoch: 11 *******
******* Domain 4 best test acc:     40.2%, epoch: 12 *******
epoch [13/50] batch [20/403] time 0.098 (0.191) data 0.000 (0.084) loss 2.4916 (2.3463) ce_loss 1.0068 (1.0519) loss_zs_kd 0.4330 (0.4288) loss_oracle 0.3174 (0.2941) acc 62.5000 (64.8438) kd_loss 1.1096 (0.9329) lr 1.7705e-03 eta 0:48:37
epoch [13/50] batch [40/403] time 0.108 (0.143) data 0.000 (0.042) loss 2.4249 (2.3678) ce_loss 0.9878 (1.0402) loss_zs_kd 0.4806 (0.4554) loss_oracle 0.2818 (0.2917) acc 68.7500 (66.2500) kd_loss 1.0559 (0.9540) lr 1.7705e-03 eta 0:36:27
epoch [13/50] batch [60/403] time 0.094 (0.127) data 0.000 (0.028) loss 2.9250 (2.3851) ce_loss 1.4531 (1.0465) loss_zs_kd 0.5453 (0.4446) loss_oracle 0.3086 (0.2954) acc 50.0000 (65.0521) kd_loss 1.0449 (0.9686) lr 1.7705e-03 eta 0:32:17
epoch [13/50] batch [80/403] time 0.107 (0.120) data 0.000 (0.021) loss 2.4056 (2.3850) ce_loss 1.0635 (1.0493) loss_zs_kd 0.4657 (0.4469) loss_oracle 0.2253 (0.2983) acc 62.5000 (65.0391) kd_loss 0.9966 (0.9631) lr 1.7705e-03 eta 0:30:33
epoch [13/50] batch [100/403] time 0.093 (0.116) data 0.000 (0.017) loss 2.4567 (2.4059) ce_loss 1.2588 (1.0631) loss_zs_kd 0.3989 (0.4508) loss_oracle 0.3506 (0.2975) acc 46.8750 (64.6562) kd_loss 0.8231 (0.9686) lr 1.7705e-03 eta 0:29:17
epoch [13/50] batch [120/403] time 0.098 (0.112) data 0.000 (0.014) loss 2.5641 (2.4095) ce_loss 1.2246 (1.0666) loss_zs_kd 0.4233 (0.4528) loss_oracle 0.2524 (0.2960) acc 53.1250 (64.3490) kd_loss 1.0017 (0.9685) lr 1.7705e-03 eta 0:28:27
epoch [13/50] batch [140/403] time 0.093 (0.110) data 0.000 (0.012) loss 2.1833 (2.4059) ce_loss 0.9023 (1.0636) loss_zs_kd 0.3823 (0.4547) loss_oracle 0.2894 (0.2961) acc 71.8750 (64.5312) kd_loss 0.9451 (0.9669) lr 1.7705e-03 eta 0:27:44
epoch [13/50] batch [160/403] time 0.070 (0.107) data 0.000 (0.011) loss 2.2965 (2.3959) ce_loss 0.8501 (1.0597) loss_zs_kd 0.5067 (0.4515) loss_oracle 0.2565 (0.2945) acc 78.1250 (64.7266) kd_loss 1.0647 (0.9632) lr 1.7705e-03 eta 0:27:04
epoch [13/50] batch [180/403] time 0.085 (0.104) data 0.000 (0.010) loss 2.3116 (2.3939) ce_loss 0.8867 (1.0555) loss_zs_kd 0.4188 (0.4516) loss_oracle 0.3094 (0.2951) acc 78.1250 (65.1042) kd_loss 1.0607 (0.9650) lr 1.7705e-03 eta 0:26:14
epoch [13/50] batch [200/403] time 0.079 (0.106) data 0.000 (0.009) loss 2.3641 (2.4024) ce_loss 1.0039 (1.0591) loss_zs_kd 0.4101 (0.4485) loss_oracle 0.3355 (0.2977) acc 71.8750 (64.7188) kd_loss 0.9874 (0.9702) lr 1.7705e-03 eta 0:26:47
epoch [13/50] batch [220/403] time 0.152 (0.105) data 0.000 (0.008) loss 2.6038 (2.4077) ce_loss 1.2129 (1.0604) loss_zs_kd 0.4167 (0.4486) loss_oracle 0.2915 (0.2993) acc 59.3750 (64.4886) kd_loss 1.0368 (0.9734) lr 1.7705e-03 eta 0:26:28
epoch [13/50] batch [240/403] time 0.091 (0.108) data 0.000 (0.007) loss 2.1588 (2.4136) ce_loss 0.8926 (1.0631) loss_zs_kd 0.4109 (0.4492) loss_oracle 0.3500 (0.3022) acc 62.5000 (64.3880) kd_loss 0.8858 (0.9748) lr 1.7705e-03 eta 0:27:08
epoch [13/50] batch [260/403] time 0.116 (0.107) data 0.000 (0.007) loss 2.0415 (2.4101) ce_loss 0.8394 (1.0580) loss_zs_kd 0.4019 (0.4485) loss_oracle 0.3431 (0.3038) acc 65.6250 (64.5433) kd_loss 0.8296 (0.9760) lr 1.7705e-03 eta 0:26:46
epoch [13/50] batch [280/403] time 0.092 (0.106) data 0.000 (0.006) loss 2.5459 (2.4127) ce_loss 1.0801 (1.0560) loss_zs_kd 0.5306 (0.4485) loss_oracle 0.2475 (0.3035) acc 59.3750 (64.6205) kd_loss 1.0768 (0.9806) lr 1.7705e-03 eta 0:26:32
epoch [13/50] batch [300/403] time 0.095 (0.105) data 0.000 (0.006) loss 2.3529 (2.4122) ce_loss 0.9878 (1.0553) loss_zs_kd 0.3509 (0.4478) loss_oracle 0.2385 (0.3007) acc 62.5000 (64.5625) kd_loss 1.0704 (0.9827) lr 1.7705e-03 eta 0:26:22
epoch [13/50] batch [320/403] time 0.107 (0.105) data 0.000 (0.006) loss 2.4805 (2.4173) ce_loss 1.0752 (1.0596) loss_zs_kd 0.3487 (0.4463) loss_oracle 0.3159 (0.3002) acc 62.5000 (64.3750) kd_loss 1.0730 (0.9844) lr 1.7705e-03 eta 0:26:13
epoch [13/50] batch [340/403] time 0.110 (0.105) data 0.000 (0.005) loss 2.2708 (2.4156) ce_loss 0.8042 (1.0540) loss_zs_kd 0.4956 (0.4476) loss_oracle 0.2643 (0.2997) acc 68.7500 (64.6507) kd_loss 1.0867 (0.9880) lr 1.7705e-03 eta 0:26:05
epoch [13/50] batch [360/403] time 0.094 (0.104) data 0.000 (0.005) loss 2.4043 (2.4182) ce_loss 1.1582 (1.0533) loss_zs_kd 0.3792 (0.4492) loss_oracle 0.3086 (0.2997) acc 59.3750 (64.6528) kd_loss 0.9021 (0.9905) lr 1.7705e-03 eta 0:25:59
epoch [13/50] batch [380/403] time 0.104 (0.104) data 0.000 (0.005) loss 2.4770 (2.4209) ce_loss 1.1572 (1.0522) loss_zs_kd 0.4315 (0.4496) loss_oracle 0.2376 (0.2990) acc 65.6250 (64.7039) kd_loss 0.9852 (0.9944) lr 1.7705e-03 eta 0:25:53
epoch [13/50] batch [400/403] time 0.091 (0.104) data 0.000 (0.004) loss 2.7636 (2.4211) ce_loss 1.1895 (1.0508) loss_zs_kd 0.4514 (0.4494) loss_oracle 0.3457 (0.2980) acc 62.5000 (64.7109) kd_loss 1.1756 (0.9965) lr 1.7705e-03 eta 0:25:47
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,738
* accuracy: 67.5%
* error: 32.5%
* macro_f1: 52.3%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,437
* accuracy: 41.4%
* error: 58.6%
* macro_f1: 32.2%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      67.5%, epoch: 13 *******
******* Domain 4 best val test acc: 41.4%, epoch: 13 *******
******* Domain 4 best test acc:     41.4%, epoch: 13 *******
epoch [14/50] batch [20/403] time 0.105 (0.210) data 0.000 (0.105) loss 2.4433 (2.5280) ce_loss 1.0859 (1.0755) loss_zs_kd 0.3233 (0.4663) loss_oracle 0.2980 (0.3020) acc 71.8750 (63.9062) kd_loss 1.0467 (1.0684) lr 1.7290e-03 eta 0:52:00
epoch [14/50] batch [40/403] time 0.075 (0.145) data 0.000 (0.053) loss 2.2331 (2.5346) ce_loss 0.7222 (1.0888) loss_zs_kd 0.5316 (0.4583) loss_oracle 0.3231 (0.3041) acc 84.3750 (64.2969) kd_loss 1.0836 (1.0646) lr 1.7290e-03 eta 0:35:50
epoch [14/50] batch [60/403] time 0.176 (0.136) data 0.000 (0.035) loss 2.6436 (2.5369) ce_loss 1.1309 (1.0874) loss_zs_kd 0.4615 (0.4553) loss_oracle 0.3001 (0.3005) acc 62.5000 (64.4271) kd_loss 1.1320 (1.0716) lr 1.7290e-03 eta 0:33:45
epoch [14/50] batch [80/403] time 0.081 (0.125) data 0.000 (0.027) loss 2.4400 (2.5482) ce_loss 0.9492 (1.1014) loss_zs_kd 0.6023 (0.4641) loss_oracle 0.2606 (0.3012) acc 75.0000 (63.6328) kd_loss 1.0593 (1.0642) lr 1.7290e-03 eta 0:30:51
epoch [14/50] batch [100/403] time 0.155 (0.125) data 0.000 (0.021) loss 2.5438 (2.5330) ce_loss 1.1562 (1.0923) loss_zs_kd 0.4201 (0.4646) loss_oracle 0.2698 (0.2966) acc 53.1250 (64.0312) kd_loss 1.0426 (1.0602) lr 1.7290e-03 eta 0:30:55
epoch [14/50] batch [120/403] time 0.085 (0.121) data 0.000 (0.018) loss 2.3721 (2.5188) ce_loss 1.0068 (1.0869) loss_zs_kd 0.4570 (0.4640) loss_oracle 0.3090 (0.2958) acc 56.2500 (63.9844) kd_loss 0.9823 (1.0520) lr 1.7290e-03 eta 0:29:52
epoch [14/50] batch [140/403] time 0.101 (0.117) data 0.000 (0.015) loss 2.4734 (2.5065) ce_loss 0.9395 (1.0763) loss_zs_kd 0.5447 (0.4674) loss_oracle 0.3228 (0.2979) acc 68.7500 (64.3304) kd_loss 1.1002 (1.0476) lr 1.7290e-03 eta 0:28:46
epoch [14/50] batch [160/403] time 0.093 (0.114) data 0.000 (0.013) loss 2.6120 (2.5028) ce_loss 1.1758 (1.0736) loss_zs_kd 0.4947 (0.4670) loss_oracle 0.3339 (0.2982) acc 53.1250 (64.2188) kd_loss 1.0219 (1.0466) lr 1.7290e-03 eta 0:28:04
epoch [14/50] batch [180/403] time 0.097 (0.113) data 0.000 (0.012) loss 2.3459 (2.4961) ce_loss 1.0127 (1.0657) loss_zs_kd 0.3221 (0.4637) loss_oracle 0.2756 (0.2998) acc 68.7500 (64.4965) kd_loss 1.0344 (1.0487) lr 1.7290e-03 eta 0:27:38
epoch [14/50] batch [200/403] time 0.109 (0.111) data 0.000 (0.011) loss 2.4438 (2.5002) ce_loss 1.0938 (1.0692) loss_zs_kd 0.4273 (0.4621) loss_oracle 0.2864 (0.3015) acc 65.6250 (64.2031) kd_loss 0.9932 (1.0492) lr 1.7290e-03 eta 0:27:18
epoch [14/50] batch [220/403] time 0.112 (0.110) data 0.000 (0.010) loss 2.4376 (2.5035) ce_loss 1.2158 (1.0698) loss_zs_kd 0.4723 (0.4620) loss_oracle 0.2534 (0.3017) acc 65.6250 (64.2330) kd_loss 0.8590 (1.0519) lr 1.7290e-03 eta 0:26:54
epoch [14/50] batch [240/403] time 0.092 (0.109) data 0.000 (0.009) loss 2.7247 (2.5001) ce_loss 1.3154 (1.0654) loss_zs_kd 0.3618 (0.4639) loss_oracle 0.3199 (0.3037) acc 56.2500 (64.4661) kd_loss 1.0684 (1.0509) lr 1.7290e-03 eta 0:26:34
epoch [14/50] batch [260/403] time 0.098 (0.108) data 0.000 (0.008) loss 2.7403 (2.4969) ce_loss 1.2812 (1.0640) loss_zs_kd 0.4985 (0.4620) loss_oracle 0.3497 (0.3045) acc 46.8750 (64.3149) kd_loss 1.0350 (1.0496) lr 1.7290e-03 eta 0:26:17
epoch [14/50] batch [280/403] time 0.097 (0.107) data 0.000 (0.008) loss 2.4475 (2.4942) ce_loss 0.9321 (1.0624) loss_zs_kd 0.4789 (0.4595) loss_oracle 0.3486 (0.3051) acc 71.8750 (64.4531) kd_loss 1.1016 (1.0495) lr 1.7290e-03 eta 0:26:05
epoch [14/50] batch [300/403] time 0.074 (0.105) data 0.000 (0.007) loss 2.6042 (2.4916) ce_loss 1.1436 (1.0617) loss_zs_kd 0.4077 (0.4583) loss_oracle 0.3589 (0.3061) acc 50.0000 (64.2917) kd_loss 1.0774 (1.0477) lr 1.7290e-03 eta 0:25:36
epoch [14/50] batch [320/403] time 0.090 (0.103) data 0.000 (0.007) loss 3.0618 (2.4870) ce_loss 1.3037 (1.0578) loss_zs_kd 0.5722 (0.4592) loss_oracle 0.3546 (0.3078) acc 56.2500 (64.3555) kd_loss 1.2946 (1.0456) lr 1.7290e-03 eta 0:25:08
epoch [14/50] batch [340/403] time 0.085 (0.105) data 0.000 (0.006) loss 2.2774 (2.4830) ce_loss 0.9141 (1.0560) loss_zs_kd 0.5625 (0.4580) loss_oracle 0.3096 (0.3085) acc 71.8750 (64.3382) kd_loss 0.9273 (1.0438) lr 1.7290e-03 eta 0:25:23
epoch [14/50] batch [360/403] time 0.083 (0.103) data 0.000 (0.006) loss 2.7575 (2.4788) ce_loss 1.2451 (1.0556) loss_zs_kd 0.4778 (0.4570) loss_oracle 0.2547 (0.3074) acc 56.2500 (64.3316) kd_loss 1.1461 (1.0411) lr 1.7290e-03 eta 0:25:01
epoch [14/50] batch [380/403] time 0.079 (0.106) data 0.001 (0.006) loss 2.4929 (2.4747) ce_loss 1.0996 (1.0538) loss_zs_kd 0.3908 (0.4575) loss_oracle 0.2571 (0.3063) acc 56.2500 (64.3339) kd_loss 1.0693 (1.0390) lr 1.7290e-03 eta 0:25:34
epoch [14/50] batch [400/403] time 0.067 (0.104) data 0.000 (0.006) loss 2.6221 (2.4683) ce_loss 1.1201 (1.0500) loss_zs_kd 0.4189 (0.4578) loss_oracle 0.2673 (0.3055) acc 59.3750 (64.4219) kd_loss 1.1588 (1.0367) lr 1.7290e-03 eta 0:25:10
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,709
* accuracy: 67.0%
* error: 33.0%
* macro_f1: 52.9%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,369
* accuracy: 40.3%
* error: 59.7%
* macro_f1: 30.8%
******* Domain 4 best val acc:      67.5%, epoch: 13 *******
******* Domain 4 best val test acc: 41.4%, epoch: 13 *******
******* Domain 4 best test acc:     41.4%, epoch: 13 *******
epoch [15/50] batch [20/403] time 0.076 (0.175) data 0.000 (0.085) loss 2.7713 (2.4890) ce_loss 1.1494 (1.0827) loss_zs_kd 0.5442 (0.4452) loss_oracle 0.3041 (0.2969) acc 56.2500 (61.0938) kd_loss 1.1977 (1.0352) lr 1.6845e-03 eta 0:42:17
epoch [15/50] batch [40/403] time 0.097 (0.132) data 0.000 (0.042) loss 2.5808 (2.4833) ce_loss 1.1514 (1.0759) loss_zs_kd 0.4773 (0.4600) loss_oracle 0.2901 (0.3070) acc 59.3750 (63.2031) kd_loss 1.0458 (1.0239) lr 1.6845e-03 eta 0:31:53
epoch [15/50] batch [60/403] time 0.095 (0.121) data 0.000 (0.028) loss 2.2855 (2.4578) ce_loss 0.9209 (1.0605) loss_zs_kd 0.4509 (0.4596) loss_oracle 0.3337 (0.3075) acc 75.0000 (64.9479) kd_loss 0.9723 (1.0137) lr 1.6845e-03 eta 0:29:05
epoch [15/50] batch [80/403] time 0.100 (0.115) data 0.000 (0.021) loss 2.2997 (2.4585) ce_loss 1.0381 (1.0604) loss_zs_kd 0.3890 (0.4599) loss_oracle 0.2851 (0.3054) acc 59.3750 (64.8047) kd_loss 0.9245 (1.0153) lr 1.6845e-03 eta 0:27:45
epoch [15/50] batch [100/403] time 0.120 (0.113) data 0.000 (0.017) loss 2.6240 (2.4667) ce_loss 1.2402 (1.0659) loss_zs_kd 0.4816 (0.4619) loss_oracle 0.2921 (0.3113) acc 59.3750 (65.0625) kd_loss 0.9969 (1.0143) lr 1.6845e-03 eta 0:27:00
epoch [15/50] batch [120/403] time 0.092 (0.109) data 0.000 (0.014) loss 2.2873 (2.4572) ce_loss 0.9746 (1.0561) loss_zs_kd 0.3663 (0.4564) loss_oracle 0.2570 (0.3115) acc 68.7500 (65.2083) kd_loss 1.0011 (1.0171) lr 1.6845e-03 eta 0:26:14
epoch [15/50] batch [140/403] time 0.102 (0.107) data 0.000 (0.012) loss 2.8139 (2.4602) ce_loss 1.3340 (1.0571) loss_zs_kd 0.4128 (0.4584) loss_oracle 0.2659 (0.3102) acc 46.8750 (65.0000) kd_loss 1.1405 (1.0188) lr 1.6845e-03 eta 0:25:37
epoch [15/50] batch [160/403] time 0.097 (0.106) data 0.000 (0.011) loss 2.2417 (2.4545) ce_loss 0.8994 (1.0525) loss_zs_kd 0.3485 (0.4605) loss_oracle 0.2492 (0.3056) acc 78.1250 (65.1953) kd_loss 1.0435 (1.0190) lr 1.6845e-03 eta 0:25:24
epoch [15/50] batch [180/403] time 0.095 (0.106) data 0.000 (0.010) loss 2.4084 (2.4559) ce_loss 1.0566 (1.0516) loss_zs_kd 0.4647 (0.4615) loss_oracle 0.2896 (0.3048) acc 71.8750 (65.0000) kd_loss 0.9746 (1.0211) lr 1.6845e-03 eta 0:25:12
epoch [15/50] batch [200/403] time 0.086 (0.103) data 0.000 (0.009) loss 2.2928 (2.4578) ce_loss 0.8618 (1.0504) loss_zs_kd 0.5063 (0.4589) loss_oracle 0.3705 (0.3045) acc 71.8750 (64.9844) kd_loss 0.9926 (1.0257) lr 1.6845e-03 eta 0:24:38
epoch [15/50] batch [220/403] time 0.078 (0.102) data 0.000 (0.008) loss 2.5428 (2.4662) ce_loss 1.1240 (1.0524) loss_zs_kd 0.4287 (0.4618) loss_oracle 0.3172 (0.3040) acc 56.2500 (64.8722) kd_loss 1.0458 (1.0310) lr 1.6845e-03 eta 0:24:12
epoch [15/50] batch [240/403] time 0.085 (0.104) data 0.000 (0.007) loss 2.2520 (2.4659) ce_loss 0.9067 (1.0495) loss_zs_kd 0.3819 (0.4593) loss_oracle 0.3001 (0.3051) acc 71.8750 (65.0651) kd_loss 1.0042 (1.0342) lr 1.6845e-03 eta 0:24:41
epoch [15/50] batch [260/403] time 0.081 (0.102) data 0.000 (0.007) loss 2.7412 (2.4627) ce_loss 1.2031 (1.0460) loss_zs_kd 0.4880 (0.4567) loss_oracle 0.2399 (0.3045) acc 59.3750 (65.0841) kd_loss 1.1742 (1.0361) lr 1.6845e-03 eta 0:24:18
epoch [15/50] batch [280/403] time 0.075 (0.106) data 0.000 (0.006) loss 2.1371 (2.4598) ce_loss 0.7588 (1.0427) loss_zs_kd 0.4583 (0.4576) loss_oracle 0.2894 (0.3034) acc 78.1250 (65.2455) kd_loss 1.0045 (1.0366) lr 1.6845e-03 eta 0:25:04
epoch [15/50] batch [300/403] time 0.079 (0.104) data 0.000 (0.006) loss 2.7123 (2.4659) ce_loss 1.2559 (1.0483) loss_zs_kd 0.4332 (0.4570) loss_oracle 0.2683 (0.3032) acc 59.3750 (65.0208) kd_loss 1.1057 (1.0374) lr 1.6845e-03 eta 0:24:38
epoch [15/50] batch [320/403] time 0.103 (0.104) data 0.000 (0.006) loss 2.7316 (2.4683) ce_loss 1.2334 (1.0481) loss_zs_kd 0.3980 (0.4562) loss_oracle 0.3110 (0.3024) acc 50.0000 (64.9707) kd_loss 1.1438 (1.0408) lr 1.6845e-03 eta 0:24:29
epoch [15/50] batch [340/403] time 0.085 (0.103) data 0.000 (0.005) loss 2.5786 (2.4703) ce_loss 1.0957 (1.0489) loss_zs_kd 0.4269 (0.4557) loss_oracle 0.2730 (0.3010) acc 56.2500 (64.9540) kd_loss 1.1330 (1.0430) lr 1.6845e-03 eta 0:24:21
epoch [15/50] batch [360/403] time 0.097 (0.103) data 0.000 (0.005) loss 2.2465 (2.4703) ce_loss 0.8447 (1.0471) loss_zs_kd 0.3875 (0.4560) loss_oracle 0.2795 (0.3001) acc 78.1250 (65.0694) kd_loss 1.0683 (1.0452) lr 1.6845e-03 eta 0:24:12
epoch [15/50] batch [380/403] time 0.094 (0.102) data 0.000 (0.005) loss 2.6266 (2.4754) ce_loss 1.0752 (1.0487) loss_zs_kd 0.4212 (0.4569) loss_oracle 0.2823 (0.2989) acc 59.3750 (64.9589) kd_loss 1.1996 (1.0488) lr 1.6845e-03 eta 0:24:02
epoch [15/50] batch [400/403] time 0.091 (0.102) data 0.000 (0.004) loss 2.4722 (2.4764) ce_loss 0.9785 (1.0471) loss_zs_kd 0.4789 (0.4561) loss_oracle 0.3498 (0.2980) acc 65.6250 (65.2031) kd_loss 1.0793 (1.0523) lr 1.6845e-03 eta 0:23:55
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,716
* accuracy: 67.1%
* error: 32.9%
* macro_f1: 52.2%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,416
* accuracy: 41.1%
* error: 58.9%
* macro_f1: 31.6%
******* Domain 4 best val acc:      67.5%, epoch: 13 *******
******* Domain 4 best val test acc: 41.4%, epoch: 13 *******
******* Domain 4 best test acc:     41.4%, epoch: 13 *******
epoch [16/50] batch [20/403] time 0.093 (0.186) data 0.000 (0.083) loss 2.5521 (2.5446) ce_loss 0.9736 (1.0838) loss_zs_kd 0.3839 (0.4242) loss_oracle 0.2674 (0.2661) acc 68.7500 (62.9688) kd_loss 1.2528 (1.1156) lr 1.6374e-03 eta 0:43:35
epoch [16/50] batch [40/403] time 0.096 (0.142) data 0.000 (0.042) loss 2.0953 (2.5592) ce_loss 0.7793 (1.0822) loss_zs_kd 0.3593 (0.4505) loss_oracle 0.2270 (0.2685) acc 81.2500 (64.1406) kd_loss 1.0228 (1.1176) lr 1.6374e-03 eta 0:33:14
epoch [16/50] batch [60/403] time 0.116 (0.128) data 0.000 (0.028) loss 2.5662 (2.5053) ce_loss 1.0947 (1.0364) loss_zs_kd 0.5060 (0.4524) loss_oracle 0.3030 (0.2780) acc 62.5000 (66.6146) kd_loss 1.0670 (1.1036) lr 1.6374e-03 eta 0:29:51
epoch [16/50] batch [80/403] time 0.086 (0.119) data 0.000 (0.021) loss 2.2118 (2.4962) ce_loss 0.9238 (1.0322) loss_zs_kd 0.4105 (0.4424) loss_oracle 0.2645 (0.2795) acc 75.0000 (66.5234) kd_loss 0.9504 (1.1030) lr 1.6374e-03 eta 0:27:51
epoch [16/50] batch [100/403] time 0.073 (0.112) data 0.000 (0.017) loss 2.6818 (2.4927) ce_loss 1.1182 (1.0270) loss_zs_kd 0.4948 (0.4449) loss_oracle 0.2952 (0.2800) acc 56.2500 (66.2500) kd_loss 1.1687 (1.1033) lr 1.6374e-03 eta 0:26:01
epoch [16/50] batch [120/403] time 0.080 (0.114) data 0.000 (0.014) loss 2.4015 (2.5017) ce_loss 1.0410 (1.0329) loss_zs_kd 0.3412 (0.4461) loss_oracle 0.2183 (0.2774) acc 59.3750 (65.5990) kd_loss 1.0808 (1.1070) lr 1.6374e-03 eta 0:26:41
epoch [16/50] batch [140/403] time 0.083 (0.109) data 0.000 (0.012) loss 2.3846 (2.4942) ce_loss 1.1416 (1.0349) loss_zs_kd 0.4146 (0.4442) loss_oracle 0.2942 (0.2769) acc 65.6250 (65.5134) kd_loss 0.8885 (1.0988) lr 1.6374e-03 eta 0:25:25
epoch [16/50] batch [160/403] time 0.185 (0.113) data 0.000 (0.011) loss 2.5083 (2.4889) ce_loss 1.2461 (1.0359) loss_zs_kd 0.4309 (0.4434) loss_oracle 0.3323 (0.2770) acc 62.5000 (65.2539) kd_loss 0.8806 (1.0928) lr 1.6374e-03 eta 0:26:11
epoch [16/50] batch [180/403] time 0.084 (0.111) data 0.000 (0.009) loss 2.6084 (2.4869) ce_loss 1.1855 (1.0357) loss_zs_kd 0.4514 (0.4427) loss_oracle 0.2991 (0.2772) acc 50.0000 (65.2083) kd_loss 1.0476 (1.0913) lr 1.6374e-03 eta 0:25:48
epoch [16/50] batch [200/403] time 0.104 (0.109) data 0.000 (0.009) loss 2.6748 (2.4880) ce_loss 1.1670 (1.0334) loss_zs_kd 0.5492 (0.4480) loss_oracle 0.2999 (0.2779) acc 56.2500 (65.4688) kd_loss 1.0833 (1.0916) lr 1.6374e-03 eta 0:25:18
epoch [16/50] batch [220/403] time 0.105 (0.109) data 0.000 (0.008) loss 2.4018 (2.4913) ce_loss 0.9814 (1.0360) loss_zs_kd 0.3713 (0.4465) loss_oracle 0.2255 (0.2784) acc 68.7500 (65.2983) kd_loss 1.1220 (1.0929) lr 1.6374e-03 eta 0:25:07
epoch [16/50] batch [240/403] time 0.100 (0.108) data 0.000 (0.007) loss 2.0515 (2.4915) ce_loss 0.6641 (1.0304) loss_zs_kd 0.4529 (0.4490) loss_oracle 0.2812 (0.2769) acc 84.3750 (65.3125) kd_loss 1.0204 (1.0981) lr 1.6374e-03 eta 0:24:56
epoch [16/50] batch [260/403] time 0.108 (0.107) data 0.000 (0.007) loss 2.3343 (2.4983) ce_loss 0.8320 (1.0333) loss_zs_kd 0.3790 (0.4510) loss_oracle 0.2884 (0.2784) acc 71.8750 (65.2885) kd_loss 1.1686 (1.1003) lr 1.6374e-03 eta 0:24:46
epoch [16/50] batch [280/403] time 0.107 (0.107) data 0.000 (0.006) loss 2.6975 (2.5004) ce_loss 1.0928 (1.0351) loss_zs_kd 0.5826 (0.4536) loss_oracle 0.3159 (0.2792) acc 65.6250 (65.1116) kd_loss 1.1555 (1.0989) lr 1.6374e-03 eta 0:24:37
epoch [16/50] batch [300/403] time 0.089 (0.107) data 0.000 (0.006) loss 2.5852 (2.4967) ce_loss 1.1758 (1.0327) loss_zs_kd 0.4606 (0.4539) loss_oracle 0.2651 (0.2792) acc 56.2500 (65.0833) kd_loss 1.0465 (1.0975) lr 1.6374e-03 eta 0:24:30
epoch [16/50] batch [320/403] time 0.112 (0.106) data 0.000 (0.005) loss 2.3030 (2.4947) ce_loss 0.9307 (1.0316) loss_zs_kd 0.4202 (0.4534) loss_oracle 0.2694 (0.2791) acc 68.7500 (65.0977) kd_loss 1.0276 (1.0969) lr 1.6374e-03 eta 0:24:25
epoch [16/50] batch [340/403] time 0.091 (0.106) data 0.000 (0.005) loss 2.7310 (2.4921) ce_loss 1.0986 (1.0317) loss_zs_kd 0.4323 (0.4536) loss_oracle 0.3300 (0.2800) acc 62.5000 (65.1287) kd_loss 1.2512 (1.0936) lr 1.6374e-03 eta 0:24:19
epoch [16/50] batch [360/403] time 0.075 (0.105) data 0.000 (0.005) loss 2.8022 (2.4872) ce_loss 1.4590 (1.0322) loss_zs_kd 0.4089 (0.4539) loss_oracle 0.3131 (0.2811) acc 50.0000 (65.0347) kd_loss 0.9822 (1.0875) lr 1.6374e-03 eta 0:24:04
epoch [16/50] batch [380/403] time 0.089 (0.104) data 0.000 (0.005) loss 2.2669 (2.4847) ce_loss 0.8101 (1.0321) loss_zs_kd 0.4461 (0.4551) loss_oracle 0.2856 (0.2816) acc 68.7500 (65.0987) kd_loss 1.0910 (1.0842) lr 1.6374e-03 eta 0:23:46
epoch [16/50] batch [400/403] time 0.068 (0.105) data 0.000 (0.004) loss 2.4147 (2.4818) ce_loss 0.9355 (1.0318) loss_zs_kd 0.5042 (0.4557) loss_oracle 0.2750 (0.2816) acc 68.7500 (65.1250) kd_loss 1.0895 (1.0813) lr 1.6374e-03 eta 0:23:56
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,763
* accuracy: 68.0%
* error: 32.0%
* macro_f1: 53.1%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,341
* accuracy: 39.8%
* error: 60.2%
* macro_f1: 30.4%
******* Domain 4 best val acc:      68.0%, epoch: 16 *******
******* Domain 4 best val test acc: 39.8%, epoch: 16 *******
******* Domain 4 best test acc:     41.4%, epoch: 13 *******
epoch [17/50] batch [20/403] time 0.159 (0.183) data 0.000 (0.086) loss 2.4541 (2.3727) ce_loss 0.9780 (0.9773) loss_zs_kd 0.4299 (0.4504) loss_oracle 0.2552 (0.2822) acc 68.7500 (65.9375) kd_loss 1.1335 (1.0291) lr 1.5878e-03 eta 0:41:47
epoch [17/50] batch [40/403] time 0.083 (0.160) data 0.000 (0.043) loss 2.9888 (2.4448) ce_loss 1.4639 (1.0306) loss_zs_kd 0.5330 (0.4452) loss_oracle 0.3489 (0.2935) acc 46.8750 (63.9844) kd_loss 1.0840 (1.0448) lr 1.5878e-03 eta 0:36:22
epoch [17/50] batch [60/403] time 0.076 (0.133) data 0.000 (0.029) loss 2.2428 (2.4189) ce_loss 0.8643 (1.0021) loss_zs_kd 0.4004 (0.4579) loss_oracle 0.3044 (0.2945) acc 65.6250 (64.6354) kd_loss 1.0262 (1.0407) lr 1.5878e-03 eta 0:30:16
epoch [17/50] batch [80/403] time 0.095 (0.123) data 0.000 (0.022) loss 3.0317 (2.4335) ce_loss 1.4316 (1.0152) loss_zs_kd 0.3830 (0.4537) loss_oracle 0.3460 (0.2991) acc 40.6250 (64.2188) kd_loss 1.2355 (1.0419) lr 1.5878e-03 eta 0:27:54
epoch [17/50] batch [100/403] time 0.096 (0.118) data 0.000 (0.017) loss 2.4954 (2.4351) ce_loss 1.0566 (1.0193) loss_zs_kd 0.4652 (0.4565) loss_oracle 0.3002 (0.2995) acc 65.6250 (64.3438) kd_loss 1.0560 (1.0378) lr 1.5878e-03 eta 0:26:50
epoch [17/50] batch [120/403] time 0.097 (0.115) data 0.000 (0.015) loss 2.4055 (2.4366) ce_loss 1.0107 (1.0187) loss_zs_kd 0.3218 (0.4589) loss_oracle 0.2681 (0.2981) acc 56.2500 (64.3490) kd_loss 1.0998 (1.0393) lr 1.5878e-03 eta 0:25:58
epoch [17/50] batch [140/403] time 0.105 (0.112) data 0.000 (0.013) loss 2.3909 (2.4364) ce_loss 0.9399 (1.0178) loss_zs_kd 0.3399 (0.4624) loss_oracle 0.2758 (0.2959) acc 68.7500 (64.7991) kd_loss 1.1432 (1.0396) lr 1.5878e-03 eta 0:25:24
epoch [17/50] batch [160/403] time 0.100 (0.111) data 0.000 (0.011) loss 2.3289 (2.4394) ce_loss 0.8218 (1.0164) loss_zs_kd 0.4924 (0.4600) loss_oracle 0.2887 (0.2944) acc 68.7500 (64.9609) kd_loss 1.1166 (1.0458) lr 1.5878e-03 eta 0:24:59
epoch [17/50] batch [180/403] time 0.117 (0.109) data 0.000 (0.010) loss 2.5844 (2.4405) ce_loss 1.1748 (1.0169) loss_zs_kd 0.3989 (0.4569) loss_oracle 0.2863 (0.2947) acc 53.1250 (64.9826) kd_loss 1.0670 (1.0478) lr 1.5878e-03 eta 0:24:36
epoch [17/50] batch [200/403] time 0.103 (0.108) data 0.000 (0.009) loss 2.3268 (2.4364) ce_loss 0.9375 (1.0167) loss_zs_kd 0.4611 (0.4563) loss_oracle 0.3066 (0.2935) acc 65.6250 (64.9531) kd_loss 1.0055 (1.0448) lr 1.5878e-03 eta 0:24:20
epoch [17/50] batch [220/403] time 0.089 (0.107) data 0.000 (0.008) loss 2.4102 (2.4405) ce_loss 1.0557 (1.0198) loss_zs_kd 0.4440 (0.4570) loss_oracle 0.2762 (0.2921) acc 56.2500 (64.8438) kd_loss 0.9944 (1.0461) lr 1.5878e-03 eta 0:23:58
epoch [17/50] batch [240/403] time 0.084 (0.104) data 0.000 (0.007) loss 2.2727 (2.4438) ce_loss 0.8384 (1.0204) loss_zs_kd 0.4169 (0.4564) loss_oracle 0.3055 (0.2912) acc 75.0000 (64.9219) kd_loss 1.0731 (1.0496) lr 1.5878e-03 eta 0:23:24
epoch [17/50] batch [260/403] time 0.166 (0.104) data 0.000 (0.007) loss 2.2008 (2.4472) ce_loss 0.7627 (1.0231) loss_zs_kd 0.4443 (0.4558) loss_oracle 0.2811 (0.2909) acc 78.1250 (64.8197) kd_loss 1.0754 (1.0507) lr 1.5878e-03 eta 0:23:13
epoch [17/50] batch [280/403] time 0.079 (0.104) data 0.000 (0.006) loss 2.4910 (2.4489) ce_loss 1.1230 (1.0224) loss_zs_kd 0.4050 (0.4545) loss_oracle 0.3183 (0.2907) acc 59.3750 (64.8326) kd_loss 1.0062 (1.0539) lr 1.5878e-03 eta 0:23:18
epoch [17/50] batch [300/403] time 0.136 (0.103) data 0.000 (0.006) loss 2.4078 (2.4513) ce_loss 0.9531 (1.0253) loss_zs_kd 0.4590 (0.4538) loss_oracle 0.2374 (0.2903) acc 68.7500 (64.8125) kd_loss 1.1065 (1.0540) lr 1.5878e-03 eta 0:23:01
epoch [17/50] batch [320/403] time 0.075 (0.106) data 0.000 (0.006) loss 2.3408 (2.4504) ce_loss 1.1016 (1.0246) loss_zs_kd 0.4590 (0.4541) loss_oracle 0.3106 (0.2903) acc 68.7500 (64.8730) kd_loss 0.8544 (1.0536) lr 1.5878e-03 eta 0:23:32
epoch [17/50] batch [340/403] time 0.075 (0.104) data 0.000 (0.005) loss 2.5299 (2.4500) ce_loss 1.1025 (1.0248) loss_zs_kd 0.4238 (0.4548) loss_oracle 0.2911 (0.2894) acc 65.6250 (65.0184) kd_loss 1.0700 (1.0531) lr 1.5878e-03 eta 0:23:07
epoch [17/50] batch [360/403] time 0.105 (0.104) data 0.000 (0.005) loss 2.3547 (2.4467) ce_loss 0.9897 (1.0239) loss_zs_kd 0.4512 (0.4551) loss_oracle 0.2796 (0.2885) acc 59.3750 (65.1042) kd_loss 0.9996 (1.0510) lr 1.5878e-03 eta 0:23:01
epoch [17/50] batch [380/403] time 0.099 (0.103) data 0.000 (0.005) loss 2.5372 (2.4464) ce_loss 1.1455 (1.0235) loss_zs_kd 0.4311 (0.4547) loss_oracle 0.2766 (0.2890) acc 59.3750 (65.1398) kd_loss 1.0379 (1.0511) lr 1.5878e-03 eta 0:22:53
epoch [17/50] batch [400/403] time 0.092 (0.103) data 0.000 (0.005) loss 2.5602 (2.4516) ce_loss 1.2266 (1.0282) loss_zs_kd 0.5076 (0.4554) loss_oracle 0.2762 (0.2895) acc 59.3750 (64.9922) kd_loss 0.9417 (1.0510) lr 1.5878e-03 eta 0:22:46
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,776
* accuracy: 68.2%
* error: 31.8%
* macro_f1: 54.2%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,294
* accuracy: 39.0%
* error: 61.0%
* macro_f1: 29.1%
******* Domain 4 best val acc:      68.2%, epoch: 17 *******
******* Domain 4 best val test acc: 39.0%, epoch: 17 *******
******* Domain 4 best test acc:     41.4%, epoch: 13 *******
epoch [18/50] batch [20/403] time 0.102 (0.207) data 0.000 (0.110) loss 2.2057 (2.4651) ce_loss 0.9883 (1.0649) loss_zs_kd 0.3647 (0.4398) loss_oracle 0.2250 (0.2685) acc 53.1250 (63.1250) kd_loss 0.9225 (1.0461) lr 1.5358e-03 eta 0:45:47
epoch [18/50] batch [40/403] time 0.102 (0.150) data 0.000 (0.055) loss 2.3686 (2.4689) ce_loss 1.0439 (1.0708) loss_zs_kd 0.4767 (0.4488) loss_oracle 0.3010 (0.2742) acc 59.3750 (61.9531) kd_loss 0.9358 (1.0366) lr 1.5358e-03 eta 0:33:12
epoch [18/50] batch [60/403] time 0.091 (0.133) data 0.000 (0.037) loss 2.5188 (2.4710) ce_loss 1.1338 (1.0673) loss_zs_kd 0.3479 (0.4476) loss_oracle 0.2659 (0.2781) acc 59.3750 (63.3854) kd_loss 1.0781 (1.0409) lr 1.5358e-03 eta 0:29:20
epoch [18/50] batch [80/403] time 0.090 (0.124) data 0.000 (0.028) loss 2.5481 (2.4661) ce_loss 1.0488 (1.0613) loss_zs_kd 0.4304 (0.4427) loss_oracle 0.2768 (0.2803) acc 62.5000 (63.5938) kd_loss 1.1457 (1.0433) lr 1.5358e-03 eta 0:27:24
epoch [18/50] batch [100/403] time 0.082 (0.115) data 0.000 (0.022) loss 2.3962 (2.4643) ce_loss 0.9590 (1.0563) loss_zs_kd 0.5961 (0.4466) loss_oracle 0.3265 (0.2855) acc 65.6250 (63.7812) kd_loss 0.9759 (1.0419) lr 1.5358e-03 eta 0:25:20
epoch [18/50] batch [120/403] time 0.156 (0.115) data 0.000 (0.019) loss 2.1816 (2.4570) ce_loss 0.7744 (1.0428) loss_zs_kd 0.4800 (0.4534) loss_oracle 0.3201 (0.2889) acc 84.3750 (64.3229) kd_loss 1.0072 (1.0430) lr 1.5358e-03 eta 0:25:10
epoch [18/50] batch [140/403] time 0.078 (0.112) data 0.000 (0.016) loss 2.3584 (2.4590) ce_loss 1.0117 (1.0415) loss_zs_kd 0.3654 (0.4488) loss_oracle 0.2947 (0.2910) acc 71.8750 (64.2634) kd_loss 1.0166 (1.0476) lr 1.5358e-03 eta 0:24:39
epoch [18/50] batch [160/403] time 0.176 (0.111) data 0.000 (0.014) loss 2.6779 (2.4626) ce_loss 1.1631 (1.0447) loss_zs_kd 0.4828 (0.4560) loss_oracle 0.3506 (0.2919) acc 56.2500 (64.1016) kd_loss 1.0981 (1.0439) lr 1.5358e-03 eta 0:24:18
epoch [18/50] batch [180/403] time 0.094 (0.114) data 0.000 (0.012) loss 2.5598 (2.4613) ce_loss 1.1562 (1.0446) loss_zs_kd 0.4965 (0.4556) loss_oracle 0.3402 (0.2935) acc 65.6250 (64.2188) kd_loss 0.9852 (1.0421) lr 1.5358e-03 eta 0:24:50
epoch [18/50] batch [200/403] time 0.094 (0.111) data 0.000 (0.011) loss 2.3242 (2.4640) ce_loss 0.7305 (1.0478) loss_zs_kd 0.4798 (0.4556) loss_oracle 0.2635 (0.2945) acc 78.1250 (64.0938) kd_loss 1.2221 (1.0412) lr 1.5358e-03 eta 0:24:11
epoch [18/50] batch [220/403] time 0.118 (0.110) data 0.000 (0.010) loss 2.3936 (2.4627) ce_loss 0.9673 (1.0459) loss_zs_kd 0.4442 (0.4555) loss_oracle 0.3080 (0.2959) acc 65.6250 (64.1193) kd_loss 1.0502 (1.0410) lr 1.5358e-03 eta 0:23:58
epoch [18/50] batch [240/403] time 0.090 (0.109) data 0.000 (0.009) loss 2.2165 (2.4589) ce_loss 0.8491 (1.0410) loss_zs_kd 0.4125 (0.4544) loss_oracle 0.3298 (0.2973) acc 68.7500 (64.3490) kd_loss 0.9962 (1.0421) lr 1.5358e-03 eta 0:23:46
epoch [18/50] batch [260/403] time 0.108 (0.108) data 0.000 (0.009) loss 2.3871 (2.4655) ce_loss 0.9956 (1.0465) loss_zs_kd 0.4481 (0.4534) loss_oracle 0.2999 (0.2977) acc 68.7500 (64.3870) kd_loss 1.0175 (1.0435) lr 1.5358e-03 eta 0:23:28
epoch [18/50] batch [280/403] time 0.099 (0.108) data 0.000 (0.008) loss 2.3551 (2.4628) ce_loss 0.9165 (1.0403) loss_zs_kd 0.3912 (0.4535) loss_oracle 0.3294 (0.2988) acc 65.6250 (64.7545) kd_loss 1.0783 (1.0464) lr 1.5358e-03 eta 0:23:20
epoch [18/50] batch [300/403] time 0.092 (0.107) data 0.000 (0.008) loss 2.5408 (2.4668) ce_loss 1.0186 (1.0391) loss_zs_kd 0.4278 (0.4537) loss_oracle 0.3369 (0.2986) acc 75.0000 (64.7708) kd_loss 1.1399 (1.0516) lr 1.5358e-03 eta 0:23:11
epoch [18/50] batch [320/403] time 0.100 (0.106) data 0.000 (0.007) loss 2.8151 (2.4760) ce_loss 1.2686 (1.0438) loss_zs_kd 0.4219 (0.4538) loss_oracle 0.2830 (0.2994) acc 53.1250 (64.4629) kd_loss 1.1941 (1.0556) lr 1.5358e-03 eta 0:23:01
epoch [18/50] batch [340/403] time 0.091 (0.106) data 0.000 (0.007) loss 2.8406 (2.4759) ce_loss 1.3750 (1.0411) loss_zs_kd 0.4703 (0.4540) loss_oracle 0.3167 (0.3000) acc 56.2500 (64.5864) kd_loss 1.0721 (1.0577) lr 1.5358e-03 eta 0:22:53
epoch [18/50] batch [360/403] time 0.084 (0.105) data 0.000 (0.006) loss 2.7968 (2.4728) ce_loss 1.2012 (1.0376) loss_zs_kd 0.5271 (0.4538) loss_oracle 0.3313 (0.3017) acc 62.5000 (64.7396) kd_loss 1.1665 (1.0575) lr 1.5358e-03 eta 0:22:42
epoch [18/50] batch [380/403] time 0.092 (0.104) data 0.000 (0.006) loss 2.4166 (2.4750) ce_loss 0.9863 (1.0389) loss_zs_kd 0.4492 (0.4549) loss_oracle 0.3504 (0.3021) acc 62.5000 (64.6793) kd_loss 1.0305 (1.0576) lr 1.5358e-03 eta 0:22:25
epoch [18/50] batch [400/403] time 0.170 (0.105) data 0.000 (0.006) loss 2.4576 (2.4730) ce_loss 1.0938 (1.0364) loss_zs_kd 0.4571 (0.4552) loss_oracle 0.3124 (0.3017) acc 68.7500 (64.8516) kd_loss 0.9791 (1.0581) lr 1.5358e-03 eta 0:22:37
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,763
* accuracy: 68.0%
* error: 32.0%
* macro_f1: 54.3%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,373
* accuracy: 40.3%
* error: 59.7%
* macro_f1: 30.4%
******* Domain 4 best val acc:      68.2%, epoch: 17 *******
******* Domain 4 best val test acc: 39.0%, epoch: 17 *******
******* Domain 4 best test acc:     41.4%, epoch: 13 *******
epoch [19/50] batch [20/403] time 0.084 (0.202) data 0.000 (0.118) loss 2.3612 (2.5026) ce_loss 1.0938 (1.0811) loss_zs_kd 0.4324 (0.4520) loss_oracle 0.3355 (0.2914) acc 71.8750 (65.0000) kd_loss 0.8835 (1.0498) lr 1.4818e-03 eta 0:43:14
epoch [19/50] batch [40/403] time 0.163 (0.174) data 0.000 (0.059) loss 2.4805 (2.4821) ce_loss 1.0244 (1.0640) loss_zs_kd 0.4521 (0.4612) loss_oracle 0.2670 (0.2869) acc 75.0000 (65.5469) kd_loss 1.0966 (1.0440) lr 1.4818e-03 eta 0:37:17
epoch [19/50] batch [60/403] time 0.073 (0.142) data 0.000 (0.039) loss 2.4593 (2.4601) ce_loss 0.8623 (1.0352) loss_zs_kd 0.4955 (0.4582) loss_oracle 0.2985 (0.2938) acc 71.8750 (65.9896) kd_loss 1.2000 (1.0489) lr 1.4818e-03 eta 0:30:17
epoch [19/50] batch [80/403] time 0.094 (0.130) data 0.000 (0.030) loss 2.1602 (2.4402) ce_loss 0.9146 (1.0201) loss_zs_kd 0.3726 (0.4641) loss_oracle 0.3165 (0.2933) acc 78.1250 (66.1719) kd_loss 0.9012 (1.0414) lr 1.4818e-03 eta 0:27:43
epoch [19/50] batch [100/403] time 0.101 (0.124) data 0.000 (0.024) loss 2.5102 (2.4508) ce_loss 1.0264 (1.0321) loss_zs_kd 0.5499 (0.4633) loss_oracle 0.2756 (0.2891) acc 65.6250 (65.5312) kd_loss 1.0710 (1.0425) lr 1.4818e-03 eta 0:26:23
epoch [19/50] batch [120/403] time 0.107 (0.120) data 0.000 (0.020) loss 2.3758 (2.4522) ce_loss 0.9727 (1.0323) loss_zs_kd 0.5532 (0.4657) loss_oracle 0.2752 (0.2876) acc 75.0000 (65.5208) kd_loss 0.9889 (1.0432) lr 1.4818e-03 eta 0:25:32
epoch [19/50] batch [140/403] time 0.098 (0.117) data 0.000 (0.017) loss 2.9240 (2.4498) ce_loss 1.2695 (1.0326) loss_zs_kd 0.5374 (0.4571) loss_oracle 0.2972 (0.2842) acc 43.7500 (65.3571) kd_loss 1.2371 (1.0466) lr 1.4818e-03 eta 0:24:50
epoch [19/50] batch [160/403] time 0.097 (0.114) data 0.000 (0.015) loss 2.4338 (2.4414) ce_loss 1.0234 (1.0242) loss_zs_kd 0.3588 (0.4557) loss_oracle 0.2173 (0.2836) acc 62.5000 (65.7422) kd_loss 1.1223 (1.0476) lr 1.4818e-03 eta 0:24:12
epoch [19/50] batch [180/403] time 0.093 (0.112) data 0.000 (0.013) loss 2.5196 (2.4342) ce_loss 1.1621 (1.0177) loss_zs_kd 0.3807 (0.4534) loss_oracle 0.2646 (0.2841) acc 62.5000 (65.9549) kd_loss 1.0348 (1.0478) lr 1.4818e-03 eta 0:23:49
epoch [19/50] batch [200/403] time 0.098 (0.111) data 0.000 (0.012) loss 2.5678 (2.4357) ce_loss 1.0225 (1.0193) loss_zs_kd 0.5045 (0.4531) loss_oracle 0.2537 (0.2837) acc 59.3750 (65.8125) kd_loss 1.1663 (1.0480) lr 1.4818e-03 eta 0:23:27
epoch [19/50] batch [220/403] time 0.089 (0.109) data 0.000 (0.011) loss 2.2979 (2.4317) ce_loss 0.9536 (1.0106) loss_zs_kd 0.4676 (0.4552) loss_oracle 0.3174 (0.2840) acc 68.7500 (65.9517) kd_loss 0.9517 (1.0516) lr 1.4818e-03 eta 0:23:05
epoch [19/50] batch [240/403] time 0.083 (0.107) data 0.000 (0.010) loss 2.3985 (2.4456) ce_loss 1.0371 (1.0176) loss_zs_kd 0.5010 (0.4547) loss_oracle 0.2621 (0.2842) acc 71.8750 (65.8464) kd_loss 0.9798 (1.0586) lr 1.4818e-03 eta 0:22:38
epoch [19/50] batch [260/403] time 0.170 (0.107) data 0.000 (0.009) loss 2.6452 (2.4554) ce_loss 1.1006 (1.0243) loss_zs_kd 0.6162 (0.4546) loss_oracle 0.1949 (0.2835) acc 65.6250 (65.7812) kd_loss 1.1391 (1.0620) lr 1.4818e-03 eta 0:22:34
epoch [19/50] batch [280/403] time 0.079 (0.107) data 0.000 (0.009) loss 2.4162 (2.4581) ce_loss 0.9487 (1.0243) loss_zs_kd 0.3146 (0.4539) loss_oracle 0.2292 (0.2824) acc 65.6250 (65.7589) kd_loss 1.1955 (1.0657) lr 1.4818e-03 eta 0:22:29
epoch [19/50] batch [300/403] time 0.164 (0.107) data 0.000 (0.008) loss 2.3742 (2.4536) ce_loss 0.7861 (1.0195) loss_zs_kd 0.4945 (0.4550) loss_oracle 0.2616 (0.2820) acc 81.2500 (65.8229) kd_loss 1.2100 (1.0656) lr 1.4818e-03 eta 0:22:21
epoch [19/50] batch [320/403] time 0.082 (0.108) data 0.000 (0.008) loss 2.6005 (2.4569) ce_loss 0.9932 (1.0232) loss_zs_kd 0.4738 (0.4539) loss_oracle 0.2733 (0.2824) acc 71.8750 (65.7129) kd_loss 1.2338 (1.0656) lr 1.4818e-03 eta 0:22:38
epoch [19/50] batch [340/403] time 0.110 (0.107) data 0.000 (0.007) loss 2.5733 (2.4571) ce_loss 1.0703 (1.0256) loss_zs_kd 0.3962 (0.4529) loss_oracle 0.2599 (0.2822) acc 62.5000 (65.4688) kd_loss 1.1749 (1.0639) lr 1.4818e-03 eta 0:22:23
epoch [19/50] batch [360/403] time 0.098 (0.107) data 0.000 (0.007) loss 2.4176 (2.4563) ce_loss 0.9141 (1.0246) loss_zs_kd 0.4913 (0.4532) loss_oracle 0.3295 (0.2829) acc 75.0000 (65.4861) kd_loss 1.0931 (1.0636) lr 1.4818e-03 eta 0:22:17
epoch [19/50] batch [380/403] time 0.098 (0.106) data 0.000 (0.006) loss 2.5079 (2.4575) ce_loss 1.0117 (1.0254) loss_zs_kd 0.4568 (0.4512) loss_oracle 0.2956 (0.2829) acc 59.3750 (65.3701) kd_loss 1.1200 (1.0650) lr 1.4818e-03 eta 0:22:10
epoch [19/50] batch [400/403] time 0.094 (0.106) data 0.000 (0.006) loss 2.5644 (2.4595) ce_loss 1.1914 (1.0252) loss_zs_kd 0.5268 (0.4528) loss_oracle 0.2650 (0.2824) acc 68.7500 (65.4531) kd_loss 0.9770 (1.0667) lr 1.4818e-03 eta 0:22:04
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,756
* accuracy: 67.9%
* error: 32.1%
* macro_f1: 52.1%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,289
* accuracy: 38.9%
* error: 61.1%
* macro_f1: 29.1%
******* Domain 4 best val acc:      68.2%, epoch: 17 *******
******* Domain 4 best val test acc: 39.0%, epoch: 17 *******
******* Domain 4 best test acc:     41.4%, epoch: 13 *******
epoch [20/50] batch [20/403] time 0.082 (0.217) data 0.000 (0.125) loss 2.5763 (2.4732) ce_loss 1.1543 (1.0640) loss_zs_kd 0.5255 (0.4498) loss_oracle 0.3247 (0.2933) acc 59.3750 (65.0000) kd_loss 0.9969 (1.0376) lr 1.4258e-03 eta 0:45:02
epoch [20/50] batch [40/403] time 0.072 (0.148) data 0.000 (0.063) loss 2.3200 (2.4355) ce_loss 0.8047 (1.0001) loss_zs_kd 0.3277 (0.4568) loss_oracle 0.3283 (0.2963) acc 71.8750 (66.8750) kd_loss 1.1874 (1.0589) lr 1.4258e-03 eta 0:30:46
epoch [20/50] batch [60/403] time 0.083 (0.126) data 0.000 (0.042) loss 2.3286 (2.4309) ce_loss 0.9326 (1.0004) loss_zs_kd 0.4549 (0.4502) loss_oracle 0.2634 (0.2972) acc 71.8750 (66.4583) kd_loss 1.0369 (1.0568) lr 1.4258e-03 eta 0:26:08
epoch [20/50] batch [80/403] time 0.083 (0.115) data 0.000 (0.032) loss 2.5053 (2.4231) ce_loss 0.9531 (0.9873) loss_zs_kd 0.4288 (0.4536) loss_oracle 0.3010 (0.2979) acc 65.6250 (66.8359) kd_loss 1.1873 (1.0601) lr 1.4258e-03 eta 0:23:42
epoch [20/50] batch [100/403] time 0.102 (0.108) data 0.000 (0.025) loss 2.5905 (2.4417) ce_loss 1.0645 (1.0037) loss_zs_kd 0.5379 (0.4542) loss_oracle 0.3088 (0.2989) acc 59.3750 (66.2500) kd_loss 1.1027 (1.0615) lr 1.4258e-03 eta 0:22:14
epoch [20/50] batch [120/403] time 0.159 (0.114) data 0.000 (0.021) loss 2.4514 (2.4388) ce_loss 1.0898 (1.0056) loss_zs_kd 0.4680 (0.4526) loss_oracle 0.3183 (0.2968) acc 62.5000 (66.2760) kd_loss 0.9684 (1.0586) lr 1.4258e-03 eta 0:23:28
epoch [20/50] batch [140/403] time 0.157 (0.120) data 0.000 (0.018) loss 2.6493 (2.4411) ce_loss 1.1367 (1.0097) loss_zs_kd 0.5939 (0.4537) loss_oracle 0.2754 (0.2940) acc 68.7500 (66.2723) kd_loss 1.0780 (1.0576) lr 1.4258e-03 eta 0:24:43
epoch [20/50] batch [160/403] time 0.098 (0.121) data 0.000 (0.016) loss 2.8946 (2.4462) ce_loss 1.3008 (1.0148) loss_zs_kd 0.5375 (0.4526) loss_oracle 0.3487 (0.2935) acc 40.6250 (65.8398) kd_loss 1.1507 (1.0584) lr 1.4258e-03 eta 0:24:55
epoch [20/50] batch [180/403] time 0.089 (0.121) data 0.000 (0.014) loss 2.1921 (2.4506) ce_loss 0.8262 (1.0180) loss_zs_kd 0.4059 (0.4540) loss_oracle 0.2937 (0.2948) acc 81.2500 (65.9201) kd_loss 1.0161 (1.0582) lr 1.4258e-03 eta 0:24:45
epoch [20/50] batch [200/403] time 0.140 (0.121) data 0.000 (0.013) loss 2.3014 (2.4512) ce_loss 0.8521 (1.0173) loss_zs_kd 0.5792 (0.4547) loss_oracle 0.3398 (0.2958) acc 75.0000 (65.8906) kd_loss 0.9899 (1.0587) lr 1.4258e-03 eta 0:24:47
epoch [20/50] batch [220/403] time 0.147 (0.121) data 0.000 (0.012) loss 2.6020 (2.4532) ce_loss 1.2139 (1.0199) loss_zs_kd 0.4243 (0.4508) loss_oracle 0.3440 (0.2951) acc 65.6250 (65.6960) kd_loss 1.0040 (1.0604) lr 1.4258e-03 eta 0:24:47
epoch [20/50] batch [240/403] time 0.117 (0.122) data 0.000 (0.011) loss 2.4737 (2.4575) ce_loss 1.0068 (1.0228) loss_zs_kd 0.5668 (0.4530) loss_oracle 0.2908 (0.2933) acc 62.5000 (65.6250) kd_loss 1.0381 (1.0615) lr 1.4258e-03 eta 0:24:49
epoch [20/50] batch [260/403] time 0.158 (0.123) data 0.000 (0.010) loss 2.4640 (2.4599) ce_loss 1.0137 (1.0248) loss_zs_kd 0.3330 (0.4524) loss_oracle 0.3160 (0.2942) acc 65.6250 (65.5769) kd_loss 1.1259 (1.0617) lr 1.4258e-03 eta 0:25:05
epoch [20/50] batch [280/403] time 0.148 (0.125) data 0.000 (0.009) loss 2.6341 (2.4609) ce_loss 1.0947 (1.0254) loss_zs_kd 0.5248 (0.4515) loss_oracle 0.2953 (0.2942) acc 62.5000 (65.6138) kd_loss 1.1293 (1.0627) lr 1.4258e-03 eta 0:25:27
epoch [20/50] batch [300/403] time 0.157 (0.127) data 0.000 (0.009) loss 2.3705 (2.4609) ce_loss 0.9199 (1.0246) loss_zs_kd 0.5640 (0.4568) loss_oracle 0.3235 (0.2949) acc 71.8750 (65.6354) kd_loss 1.0068 (1.0604) lr 1.4258e-03 eta 0:25:47
epoch [20/50] batch [320/403] time 0.157 (0.129) data 0.000 (0.008) loss 2.3673 (2.4567) ce_loss 0.9097 (1.0212) loss_zs_kd 0.3958 (0.4563) loss_oracle 0.2642 (0.2959) acc 68.7500 (65.8398) kd_loss 1.1276 (1.0594) lr 1.4258e-03 eta 0:26:04
epoch [20/50] batch [340/403] time 0.141 (0.130) data 0.000 (0.008) loss 2.3590 (2.4576) ce_loss 0.9878 (1.0215) loss_zs_kd 0.4765 (0.4594) loss_oracle 0.3205 (0.2959) acc 65.6250 (65.7904) kd_loss 0.9728 (1.0584) lr 1.4258e-03 eta 0:26:18
epoch [20/50] batch [360/403] time 0.150 (0.131) data 0.000 (0.007) loss 2.4147 (2.4536) ce_loss 1.0039 (1.0202) loss_zs_kd 0.3979 (0.4586) loss_oracle 0.3224 (0.2959) acc 62.5000 (65.8247) kd_loss 1.0506 (1.0561) lr 1.4258e-03 eta 0:26:30
epoch [20/50] batch [380/403] time 0.161 (0.132) data 0.000 (0.007) loss 2.3941 (2.4505) ce_loss 1.0742 (1.0187) loss_zs_kd 0.3360 (0.4583) loss_oracle 0.2602 (0.2967) acc 68.7500 (65.7730) kd_loss 1.0218 (1.0543) lr 1.4258e-03 eta 0:26:42
epoch [20/50] batch [400/403] time 0.168 (0.133) data 0.000 (0.007) loss 2.4181 (2.4514) ce_loss 0.9458 (1.0202) loss_zs_kd 0.5237 (0.4584) loss_oracle 0.2462 (0.2970) acc 78.1250 (65.7266) kd_loss 1.0874 (1.0536) lr 1.4258e-03 eta 0:26:46
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,790
* accuracy: 68.5%
* error: 31.5%
* macro_f1: 54.5%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,422
* accuracy: 41.2%
* error: 58.8%
* macro_f1: 31.9%
******* Domain 4 best val acc:      68.5%, epoch: 20 *******
******* Domain 4 best val test acc: 41.2%, epoch: 20 *******
******* Domain 4 best test acc:     41.4%, epoch: 13 *******
epoch [21/50] batch [20/403] time 0.139 (0.277) data 0.000 (0.127) loss 2.3368 (2.4738) ce_loss 0.8906 (1.0161) loss_zs_kd 0.5086 (0.4503) loss_oracle 0.2722 (0.3047) acc 68.7500 (63.2812) kd_loss 1.0558 (1.0802) lr 1.3681e-03 eta 0:55:48
epoch [21/50] batch [40/403] time 0.093 (0.197) data 0.000 (0.064) loss 2.8275 (2.5181) ce_loss 1.3770 (1.0512) loss_zs_kd 0.4499 (0.4633) loss_oracle 0.3469 (0.3096) acc 56.2500 (62.8906) kd_loss 1.0522 (1.0804) lr 1.3681e-03 eta 0:39:33
epoch [21/50] batch [60/403] time 0.114 (0.172) data 0.000 (0.043) loss 2.5903 (2.5395) ce_loss 1.0605 (1.0646) loss_zs_kd 0.4864 (0.4619) loss_oracle 0.3291 (0.2994) acc 59.3750 (63.0208) kd_loss 1.1221 (1.0943) lr 1.3681e-03 eta 0:34:24
epoch [21/50] batch [80/403] time 0.084 (0.158) data 0.000 (0.032) loss 2.4164 (2.5137) ce_loss 0.8945 (1.0406) loss_zs_kd 0.5004 (0.4615) loss_oracle 0.3404 (0.3019) acc 71.8750 (64.3359) kd_loss 1.1015 (1.0914) lr 1.3681e-03 eta 0:31:36
epoch [21/50] batch [100/403] time 0.085 (0.149) data 0.000 (0.026) loss 2.1572 (2.5153) ce_loss 0.7793 (1.0422) loss_zs_kd 0.3712 (0.4625) loss_oracle 0.2733 (0.3009) acc 71.8750 (64.3125) kd_loss 1.0556 (1.0914) lr 1.3681e-03 eta 0:29:47
epoch [21/50] batch [120/403] time 0.145 (0.144) data 0.000 (0.021) loss 2.5445 (2.5152) ce_loss 1.1123 (1.0401) loss_zs_kd 0.4306 (0.4587) loss_oracle 0.4044 (0.3007) acc 62.5000 (64.5312) kd_loss 1.0147 (1.0955) lr 1.3681e-03 eta 0:28:45
epoch [21/50] batch [140/403] time 0.146 (0.141) data 0.000 (0.018) loss 2.2949 (2.5293) ce_loss 1.0195 (1.0527) loss_zs_kd 0.3761 (0.4580) loss_oracle 0.2756 (0.2987) acc 65.6250 (64.1071) kd_loss 0.9495 (1.0983) lr 1.3681e-03 eta 0:28:01
epoch [21/50] batch [160/403] time 0.142 (0.138) data 0.000 (0.016) loss 2.6596 (2.5258) ce_loss 1.1172 (1.0486) loss_zs_kd 0.4104 (0.4580) loss_oracle 0.3124 (0.2975) acc 56.2500 (64.4531) kd_loss 1.1810 (1.0994) lr 1.3681e-03 eta 0:27:20
epoch [21/50] batch [180/403] time 0.135 (0.135) data 0.000 (0.014) loss 2.7327 (2.5210) ce_loss 1.0869 (1.0453) loss_zs_kd 0.4915 (0.4560) loss_oracle 0.2397 (0.2972) acc 50.0000 (64.5139) kd_loss 1.2802 (1.0991) lr 1.3681e-03 eta 0:26:45
epoch [21/50] batch [200/403] time 0.091 (0.132) data 0.000 (0.013) loss 2.5059 (2.5081) ce_loss 0.9048 (1.0337) loss_zs_kd 0.4014 (0.4590) loss_oracle 0.3291 (0.2969) acc 65.6250 (65.0625) kd_loss 1.2359 (1.0964) lr 1.3681e-03 eta 0:26:05
epoch [21/50] batch [220/403] time 0.097 (0.130) data 0.000 (0.012) loss 2.5147 (2.5019) ce_loss 0.9023 (1.0276) loss_zs_kd 0.4408 (0.4598) loss_oracle 0.3144 (0.2972) acc 71.8750 (65.2557) kd_loss 1.2347 (1.0958) lr 1.3681e-03 eta 0:25:39
epoch [21/50] batch [240/403] time 0.190 (0.129) data 0.000 (0.011) loss 2.4369 (2.4990) ce_loss 1.0586 (1.0283) loss_zs_kd 0.4799 (0.4591) loss_oracle 0.2838 (0.2966) acc 62.5000 (65.4036) kd_loss 0.9964 (1.0929) lr 1.3681e-03 eta 0:25:33
epoch [21/50] batch [260/403] time 0.077 (0.130) data 0.000 (0.010) loss 2.0879 (2.4939) ce_loss 0.7056 (1.0281) loss_zs_kd 0.5197 (0.4596) loss_oracle 0.2824 (0.2966) acc 81.2500 (65.3486) kd_loss 0.9813 (1.0877) lr 1.3681e-03 eta 0:25:39
epoch [21/50] batch [280/403] time 0.189 (0.131) data 0.000 (0.009) loss 2.5007 (2.4921) ce_loss 1.0430 (1.0291) loss_zs_kd 0.3508 (0.4574) loss_oracle 0.3093 (0.2970) acc 53.1250 (65.1116) kd_loss 1.1277 (1.0857) lr 1.3681e-03 eta 0:25:47
epoch [21/50] batch [300/403] time 0.137 (0.129) data 0.000 (0.009) loss 2.7671 (2.4908) ce_loss 1.1133 (1.0257) loss_zs_kd 0.4965 (0.4574) loss_oracle 0.3256 (0.2974) acc 62.5000 (65.1771) kd_loss 1.2428 (1.0876) lr 1.3681e-03 eta 0:25:22
epoch [21/50] batch [320/403] time 0.142 (0.128) data 0.000 (0.008) loss 2.3684 (2.4893) ce_loss 0.8877 (1.0257) loss_zs_kd 0.4783 (0.4556) loss_oracle 0.2647 (0.2978) acc 62.5000 (65.2051) kd_loss 1.1092 (1.0870) lr 1.3681e-03 eta 0:25:09
epoch [21/50] batch [340/403] time 0.084 (0.128) data 0.000 (0.008) loss 2.8155 (2.4915) ce_loss 1.1758 (1.0258) loss_zs_kd 0.5086 (0.4565) loss_oracle 0.3688 (0.2979) acc 53.1250 (65.1103) kd_loss 1.2010 (1.0885) lr 1.3681e-03 eta 0:25:00
epoch [21/50] batch [360/403] time 0.092 (0.126) data 0.000 (0.007) loss 2.4403 (2.4911) ce_loss 1.0596 (1.0246) loss_zs_kd 0.4363 (0.4564) loss_oracle 0.2848 (0.2979) acc 71.8750 (65.1910) kd_loss 1.0202 (1.0894) lr 1.3681e-03 eta 0:24:43
epoch [21/50] batch [380/403] time 0.127 (0.125) data 0.000 (0.007) loss 2.6492 (2.4954) ce_loss 1.2314 (1.0267) loss_zs_kd 0.5130 (0.4592) loss_oracle 0.2884 (0.2981) acc 59.3750 (65.2632) kd_loss 1.0171 (1.0900) lr 1.3681e-03 eta 0:24:25
epoch [21/50] batch [400/403] time 0.095 (0.124) data 0.000 (0.007) loss 2.7580 (2.4972) ce_loss 1.0908 (1.0268) loss_zs_kd 0.5316 (0.4583) loss_oracle 0.3148 (0.2977) acc 56.2500 (65.4219) kd_loss 1.2440 (1.0924) lr 1.3681e-03 eta 0:24:11
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,792
* accuracy: 68.5%
* error: 31.5%
* macro_f1: 53.6%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,351
* accuracy: 40.0%
* error: 60.0%
* macro_f1: 30.4%
******* Domain 4 best val acc:      68.5%, epoch: 21 *******
******* Domain 4 best val test acc: 40.0%, epoch: 21 *******
******* Domain 4 best test acc:     41.4%, epoch: 13 *******
epoch [22/50] batch [20/403] time 0.160 (0.285) data 0.000 (0.134) loss 2.6177 (2.5264) ce_loss 1.1162 (1.0227) loss_zs_kd 0.4886 (0.4610) loss_oracle 0.2516 (0.2862) acc 62.5000 (65.7812) kd_loss 1.1314 (1.1301) lr 1.3090e-03 eta 0:55:28
epoch [22/50] batch [40/403] time 0.190 (0.202) data 0.000 (0.067) loss 2.6970 (2.5203) ce_loss 1.2549 (1.0137) loss_zs_kd 0.4976 (0.4788) loss_oracle 0.3212 (0.2948) acc 50.0000 (66.0938) kd_loss 1.0328 (1.1198) lr 1.3090e-03 eta 0:39:07
epoch [22/50] batch [60/403] time 0.075 (0.186) data 0.000 (0.045) loss 2.7174 (2.5595) ce_loss 1.1455 (1.0493) loss_zs_kd 0.5550 (0.4682) loss_oracle 0.3722 (0.3041) acc 59.3750 (65.1042) kd_loss 1.1083 (1.1241) lr 1.3090e-03 eta 0:36:05
epoch [22/50] batch [80/403] time 0.183 (0.172) data 0.000 (0.034) loss 2.7807 (2.5768) ce_loss 1.1133 (1.0527) loss_zs_kd 0.4000 (0.4670) loss_oracle 0.3118 (0.3080) acc 56.2500 (64.3750) kd_loss 1.3115 (1.1366) lr 1.3090e-03 eta 0:33:15
epoch [22/50] batch [100/403] time 0.101 (0.159) data 0.000 (0.027) loss 2.3574 (2.5591) ce_loss 0.9756 (1.0375) loss_zs_kd 0.5206 (0.4630) loss_oracle 0.3270 (0.3093) acc 62.5000 (64.6562) kd_loss 0.9580 (1.1354) lr 1.3090e-03 eta 0:30:40
epoch [22/50] batch [120/403] time 0.126 (0.152) data 0.000 (0.023) loss 2.4927 (2.5431) ce_loss 1.0488 (1.0222) loss_zs_kd 0.4672 (0.4651) loss_oracle 0.3209 (0.3136) acc 59.3750 (65.3646) kd_loss 1.0498 (1.1315) lr 1.3090e-03 eta 0:29:18
epoch [22/50] batch [140/403] time 0.092 (0.147) data 0.000 (0.019) loss 2.6642 (2.5419) ce_loss 1.2432 (1.0226) loss_zs_kd 0.4447 (0.4653) loss_oracle 0.3168 (0.3143) acc 62.5000 (65.2232) kd_loss 1.0403 (1.1295) lr 1.3090e-03 eta 0:28:14
epoch [22/50] batch [160/403] time 0.133 (0.143) data 0.000 (0.017) loss 2.2776 (2.5320) ce_loss 0.6968 (1.0152) loss_zs_kd 0.4549 (0.4636) loss_oracle 0.3020 (0.3174) acc 75.0000 (65.4297) kd_loss 1.2024 (1.1263) lr 1.3090e-03 eta 0:27:32
epoch [22/50] batch [180/403] time 0.146 (0.141) data 0.000 (0.015) loss 2.7424 (2.5310) ce_loss 1.2070 (1.0157) loss_zs_kd 0.4082 (0.4648) loss_oracle 0.2741 (0.3162) acc 65.6250 (65.5035) kd_loss 1.1943 (1.1248) lr 1.3090e-03 eta 0:26:59
epoch [22/50] batch [200/403] time 0.109 (0.138) data 0.000 (0.014) loss 2.7722 (2.5328) ce_loss 1.2266 (1.0167) loss_zs_kd 0.5192 (0.4665) loss_oracle 0.2476 (0.3138) acc 56.2500 (65.4844) kd_loss 1.1622 (1.1260) lr 1.3090e-03 eta 0:26:26
epoch [22/50] batch [220/403] time 0.143 (0.136) data 0.000 (0.012) loss 2.5740 (2.5313) ce_loss 1.1113 (1.0150) loss_zs_kd 0.4047 (0.4686) loss_oracle 0.2702 (0.3135) acc 59.3750 (65.6250) kd_loss 1.1251 (1.1253) lr 1.3090e-03 eta 0:26:04
epoch [22/50] batch [240/403] time 0.105 (0.134) data 0.000 (0.011) loss 2.4348 (2.5311) ce_loss 0.9023 (1.0151) loss_zs_kd 0.4836 (0.4660) loss_oracle 0.4101 (0.3130) acc 71.8750 (65.5599) kd_loss 1.0856 (1.1265) lr 1.3090e-03 eta 0:25:35
epoch [22/50] batch [260/403] time 0.129 (0.133) data 0.000 (0.011) loss 2.2649 (2.5279) ce_loss 0.7627 (1.0106) loss_zs_kd 0.4319 (0.4669) loss_oracle 0.2387 (0.3125) acc 65.6250 (65.8053) kd_loss 1.1669 (1.1276) lr 1.3090e-03 eta 0:25:15
epoch [22/50] batch [280/403] time 0.147 (0.133) data 0.000 (0.010) loss 2.5145 (2.5267) ce_loss 1.0449 (1.0122) loss_zs_kd 0.5001 (0.4662) loss_oracle 0.3081 (0.3124) acc 56.2500 (65.7254) kd_loss 1.0655 (1.1251) lr 1.3090e-03 eta 0:25:13
epoch [22/50] batch [300/403] time 0.141 (0.133) data 0.000 (0.009) loss 2.2094 (2.5214) ce_loss 0.7256 (1.0112) loss_zs_kd 0.4789 (0.4648) loss_oracle 0.3364 (0.3126) acc 84.3750 (65.8646) kd_loss 1.0762 (1.1215) lr 1.3090e-03 eta 0:25:19
epoch [22/50] batch [320/403] time 0.129 (0.133) data 0.000 (0.009) loss 2.3240 (2.5155) ce_loss 0.9077 (1.0115) loss_zs_kd 0.4625 (0.4624) loss_oracle 0.3470 (0.3124) acc 68.7500 (65.8887) kd_loss 1.0115 (1.1166) lr 1.3090e-03 eta 0:25:10
epoch [22/50] batch [340/403] time 0.150 (0.133) data 0.000 (0.008) loss 2.6043 (2.5164) ce_loss 1.1748 (1.0140) loss_zs_kd 0.4352 (0.4626) loss_oracle 0.3537 (0.3127) acc 68.7500 (65.8364) kd_loss 1.0351 (1.1147) lr 1.3090e-03 eta 0:25:09
epoch [22/50] batch [360/403] time 0.144 (0.133) data 0.000 (0.008) loss 2.5508 (2.5198) ce_loss 0.9941 (1.0195) loss_zs_kd 0.5248 (0.4611) loss_oracle 0.3028 (0.3126) acc 65.6250 (65.6597) kd_loss 1.1428 (1.1134) lr 1.3090e-03 eta 0:25:06
epoch [22/50] batch [380/403] time 0.142 (0.132) data 0.000 (0.007) loss 2.1898 (2.5211) ce_loss 0.7856 (1.0221) loss_zs_kd 0.4460 (0.4612) loss_oracle 0.2955 (0.3124) acc 71.8750 (65.5016) kd_loss 1.0334 (1.1122) lr 1.3090e-03 eta 0:24:55
epoch [22/50] batch [400/403] time 0.086 (0.131) data 0.000 (0.007) loss 2.2368 (2.5199) ce_loss 0.7324 (1.0232) loss_zs_kd 0.5290 (0.4600) loss_oracle 0.3078 (0.3122) acc 81.2500 (65.5703) kd_loss 1.0860 (1.1106) lr 1.3090e-03 eta 0:24:38
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,745
* accuracy: 67.7%
* error: 32.3%
* macro_f1: 53.7%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,322
* accuracy: 39.5%
* error: 60.5%
* macro_f1: 29.5%
******* Domain 4 best val acc:      68.5%, epoch: 21 *******
******* Domain 4 best val test acc: 40.0%, epoch: 21 *******
******* Domain 4 best test acc:     41.4%, epoch: 13 *******
epoch [23/50] batch [20/403] time 0.085 (0.239) data 0.000 (0.132) loss 2.1524 (2.4977) ce_loss 0.7930 (1.0141) loss_zs_kd 0.4549 (0.4610) loss_oracle 0.3044 (0.3040) acc 75.0000 (66.8750) kd_loss 0.9797 (1.1012) lr 1.2487e-03 eta 0:44:56
epoch [23/50] batch [40/403] time 0.082 (0.177) data 0.000 (0.066) loss 2.2346 (2.5144) ce_loss 0.7886 (1.0279) loss_zs_kd 0.5423 (0.4718) loss_oracle 0.3595 (0.3058) acc 71.8750 (65.0781) kd_loss 0.9952 (1.0977) lr 1.2487e-03 eta 0:33:06
epoch [23/50] batch [60/403] time 0.110 (0.161) data 0.000 (0.044) loss 2.5390 (2.5147) ce_loss 1.0703 (1.0268) loss_zs_kd 0.3907 (0.4661) loss_oracle 0.2892 (0.3121) acc 68.7500 (65.8333) kd_loss 1.1287 (1.0988) lr 1.2487e-03 eta 0:30:06
epoch [23/50] batch [80/403] time 0.110 (0.149) data 0.000 (0.033) loss 2.5973 (2.5075) ce_loss 1.0928 (1.0188) loss_zs_kd 0.4422 (0.4720) loss_oracle 0.3127 (0.3102) acc 59.3750 (65.8594) kd_loss 1.1271 (1.0976) lr 1.2487e-03 eta 0:27:54
epoch [23/50] batch [100/403] time 0.092 (0.140) data 0.000 (0.027) loss 2.2204 (2.5111) ce_loss 0.7891 (1.0216) loss_zs_kd 0.4887 (0.4705) loss_oracle 0.2873 (0.3072) acc 78.1250 (65.8438) kd_loss 1.0433 (1.1007) lr 1.2487e-03 eta 0:26:05
epoch [23/50] batch [120/403] time 0.092 (0.135) data 0.000 (0.022) loss 2.5254 (2.5118) ce_loss 1.0830 (1.0222) loss_zs_kd 0.4189 (0.4718) loss_oracle 0.2637 (0.3041) acc 68.7500 (65.4948) kd_loss 1.1010 (1.1017) lr 1.2487e-03 eta 0:25:07
epoch [23/50] batch [140/403] time 0.083 (0.132) data 0.000 (0.019) loss 2.5630 (2.5237) ce_loss 1.0859 (1.0307) loss_zs_kd 0.4943 (0.4665) loss_oracle 0.3185 (0.3043) acc 59.3750 (65.0223) kd_loss 1.0706 (1.1076) lr 1.2487e-03 eta 0:24:27
epoch [23/50] batch [160/403] time 0.147 (0.131) data 0.000 (0.017) loss 2.3127 (2.5240) ce_loss 0.6929 (1.0267) loss_zs_kd 0.4815 (0.4658) loss_oracle 0.2667 (0.3050) acc 78.1250 (65.4102) kd_loss 1.2458 (1.1119) lr 1.2487e-03 eta 0:24:14
epoch [23/50] batch [180/403] time 0.141 (0.132) data 0.000 (0.015) loss 2.5654 (2.5315) ce_loss 0.9380 (1.0281) loss_zs_kd 0.5828 (0.4621) loss_oracle 0.3274 (0.3071) acc 65.6250 (65.3993) kd_loss 1.1723 (1.1188) lr 1.2487e-03 eta 0:24:22
epoch [23/50] batch [200/403] time 0.090 (0.133) data 0.000 (0.013) loss 2.4709 (2.5292) ce_loss 0.8477 (1.0228) loss_zs_kd 0.5528 (0.4632) loss_oracle 0.3378 (0.3088) acc 75.0000 (65.6250) kd_loss 1.1779 (1.1204) lr 1.2487e-03 eta 0:24:31
epoch [23/50] batch [220/403] time 0.092 (0.132) data 0.000 (0.012) loss 2.4390 (2.5309) ce_loss 1.1299 (1.0245) loss_zs_kd 0.5131 (0.4609) loss_oracle 0.2501 (0.3089) acc 53.1250 (65.4545) kd_loss 0.9276 (1.1214) lr 1.2487e-03 eta 0:24:21
epoch [23/50] batch [240/403] time 0.093 (0.131) data 0.000 (0.011) loss 2.3507 (2.5237) ce_loss 0.8521 (1.0175) loss_zs_kd 0.4830 (0.4609) loss_oracle 0.3315 (0.3091) acc 71.8750 (65.8203) kd_loss 1.0915 (1.1212) lr 1.2487e-03 eta 0:24:03
epoch [23/50] batch [260/403] time 0.113 (0.129) data 0.000 (0.010) loss 2.4155 (2.5231) ce_loss 0.9331 (1.0155) loss_zs_kd 0.3876 (0.4619) loss_oracle 0.3043 (0.3110) acc 71.8750 (65.7692) kd_loss 1.1364 (1.1211) lr 1.2487e-03 eta 0:23:43
epoch [23/50] batch [280/403] time 0.079 (0.130) data 0.000 (0.010) loss 2.4472 (2.5248) ce_loss 1.1035 (1.0175) loss_zs_kd 0.4637 (0.4625) loss_oracle 0.3274 (0.3124) acc 59.3750 (65.6585) kd_loss 0.9482 (1.1199) lr 1.2487e-03 eta 0:23:45
epoch [23/50] batch [300/403] time 0.186 (0.130) data 0.000 (0.009) loss 2.3633 (2.5206) ce_loss 0.8369 (1.0170) loss_zs_kd 0.5772 (0.4627) loss_oracle 0.3295 (0.3123) acc 75.0000 (65.5521) kd_loss 1.0731 (1.1160) lr 1.2487e-03 eta 0:23:51
epoch [23/50] batch [320/403] time 0.096 (0.130) data 0.000 (0.008) loss 2.7218 (2.5170) ce_loss 1.2129 (1.0145) loss_zs_kd 0.4180 (0.4633) loss_oracle 0.3122 (0.3126) acc 56.2500 (65.6445) kd_loss 1.1438 (1.1145) lr 1.2487e-03 eta 0:23:47
epoch [23/50] batch [340/403] time 0.062 (0.131) data 0.000 (0.008) loss 2.4384 (2.5177) ce_loss 1.0039 (1.0173) loss_zs_kd 0.5319 (0.4651) loss_oracle 0.4101 (0.3149) acc 59.3750 (65.5974) kd_loss 0.9635 (1.1103) lr 1.2487e-03 eta 0:23:55
epoch [23/50] batch [360/403] time 0.091 (0.129) data 0.000 (0.008) loss 2.2516 (2.5134) ce_loss 0.7554 (1.0172) loss_zs_kd 0.4604 (0.4643) loss_oracle 0.3698 (0.3155) acc 75.0000 (65.5816) kd_loss 1.0811 (1.1063) lr 1.2487e-03 eta 0:23:30
epoch [23/50] batch [380/403] time 0.101 (0.128) data 0.000 (0.007) loss 2.3627 (2.5095) ce_loss 0.9609 (1.0183) loss_zs_kd 0.4372 (0.4626) loss_oracle 0.2768 (0.3148) acc 62.5000 (65.5428) kd_loss 1.0447 (1.1024) lr 1.2487e-03 eta 0:23:20
epoch [23/50] batch [400/403] time 0.080 (0.127) data 0.000 (0.007) loss 2.4451 (2.5070) ce_loss 1.0938 (1.0211) loss_zs_kd 0.5522 (0.4613) loss_oracle 0.3180 (0.3144) acc 75.0000 (65.4297) kd_loss 0.9163 (1.0980) lr 1.2487e-03 eta 0:23:06
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,788
* accuracy: 68.4%
* error: 31.6%
* macro_f1: 54.2%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,428
* accuracy: 41.3%
* error: 58.7%
* macro_f1: 31.7%
******* Domain 4 best val acc:      68.5%, epoch: 21 *******
******* Domain 4 best val test acc: 40.0%, epoch: 21 *******
******* Domain 4 best test acc:     41.4%, epoch: 13 *******
epoch [24/50] batch [20/403] time 0.152 (0.285) data 0.000 (0.144) loss 2.3996 (2.4269) ce_loss 0.9102 (1.0350) loss_zs_kd 0.5665 (0.4624) loss_oracle 0.3618 (0.3038) acc 71.8750 (63.5938) kd_loss 1.0253 (1.0088) lr 1.1874e-03 eta 0:51:37
epoch [24/50] batch [40/403] time 0.073 (0.217) data 0.000 (0.072) loss 2.1722 (2.4045) ce_loss 0.7852 (1.0183) loss_zs_kd 0.4002 (0.4339) loss_oracle 0.3349 (0.3028) acc 75.0000 (65.5469) kd_loss 1.0195 (1.0179) lr 1.1874e-03 eta 0:39:09
epoch [24/50] batch [60/403] time 0.234 (0.195) data 0.001 (0.048) loss 2.3681 (2.4121) ce_loss 0.9634 (1.0128) loss_zs_kd 0.3882 (0.4504) loss_oracle 0.3240 (0.3065) acc 59.3750 (65.8333) kd_loss 1.0487 (1.0209) lr 1.1874e-03 eta 0:35:06
epoch [24/50] batch [80/403] time 0.086 (0.177) data 0.000 (0.036) loss 2.9498 (2.4291) ce_loss 1.4648 (1.0263) loss_zs_kd 0.5031 (0.4583) loss_oracle 0.3026 (0.3022) acc 43.7500 (65.3516) kd_loss 1.0821 (1.0225) lr 1.1874e-03 eta 0:31:52
epoch [24/50] batch [100/403] time 0.067 (0.171) data 0.000 (0.029) loss 2.3165 (2.4279) ce_loss 0.8760 (1.0275) loss_zs_kd 0.4433 (0.4518) loss_oracle 0.3005 (0.3031) acc 75.0000 (65.7500) kd_loss 1.0686 (1.0230) lr 1.1874e-03 eta 0:30:43
epoch [24/50] batch [120/403] time 0.144 (0.158) data 0.000 (0.024) loss 2.3175 (2.4315) ce_loss 0.8833 (1.0291) loss_zs_kd 0.4664 (0.4498) loss_oracle 0.2376 (0.3026) acc 62.5000 (65.2865) kd_loss 1.0821 (1.0262) lr 1.1874e-03 eta 0:28:19
epoch [24/50] batch [140/403] time 0.108 (0.152) data 0.000 (0.021) loss 2.6140 (2.4328) ce_loss 1.0361 (1.0260) loss_zs_kd 0.6547 (0.4577) loss_oracle 0.3133 (0.3037) acc 68.7500 (65.6027) kd_loss 1.0939 (1.0260) lr 1.1874e-03 eta 0:27:15
epoch [24/50] batch [160/403] time 0.127 (0.148) data 0.000 (0.018) loss 2.7059 (2.4338) ce_loss 1.2451 (1.0208) loss_zs_kd 0.4939 (0.4601) loss_oracle 0.2804 (0.3048) acc 50.0000 (65.8984) kd_loss 1.0736 (1.0306) lr 1.1874e-03 eta 0:26:23
epoch [24/50] batch [180/403] time 0.148 (0.145) data 0.000 (0.016) loss 2.6916 (2.4443) ce_loss 1.1816 (1.0287) loss_zs_kd 0.5064 (0.4602) loss_oracle 0.3381 (0.3066) acc 68.7500 (65.6771) kd_loss 1.0877 (1.0322) lr 1.1874e-03 eta 0:25:55
epoch [24/50] batch [200/403] time 0.157 (0.146) data 0.000 (0.015) loss 2.4128 (2.4357) ce_loss 0.9336 (1.0186) loss_zs_kd 0.5651 (0.4626) loss_oracle 0.3105 (0.3064) acc 68.7500 (66.0312) kd_loss 1.0414 (1.0326) lr 1.1874e-03 eta 0:26:00
epoch [24/50] batch [220/403] time 0.159 (0.146) data 0.003 (0.013) loss 2.4243 (2.4453) ce_loss 1.0010 (1.0271) loss_zs_kd 0.5158 (0.4622) loss_oracle 0.2530 (0.3054) acc 62.5000 (65.7244) kd_loss 1.0389 (1.0345) lr 1.1874e-03 eta 0:25:56
epoch [24/50] batch [240/403] time 0.139 (0.146) data 0.000 (0.012) loss 2.0360 (2.4445) ce_loss 0.7163 (1.0228) loss_zs_kd 0.3232 (0.4624) loss_oracle 0.3105 (0.3067) acc 84.3750 (65.8984) kd_loss 1.0028 (1.0371) lr 1.1874e-03 eta 0:25:58
epoch [24/50] batch [260/403] time 0.151 (0.145) data 0.000 (0.011) loss 2.6632 (2.4447) ce_loss 1.2100 (1.0213) loss_zs_kd 0.5120 (0.4622) loss_oracle 0.2453 (0.3061) acc 53.1250 (65.9615) kd_loss 1.0745 (1.0393) lr 1.1874e-03 eta 0:25:36
epoch [24/50] batch [280/403] time 0.157 (0.143) data 0.000 (0.011) loss 2.4919 (2.4467) ce_loss 1.0029 (1.0248) loss_zs_kd 0.4921 (0.4605) loss_oracle 0.3095 (0.3042) acc 62.5000 (65.8705) kd_loss 1.0882 (1.0396) lr 1.1874e-03 eta 0:25:19
epoch [24/50] batch [300/403] time 0.080 (0.142) data 0.000 (0.010) loss 2.4671 (2.4529) ce_loss 0.9761 (1.0289) loss_zs_kd 0.4045 (0.4621) loss_oracle 0.3270 (0.3026) acc 62.5000 (65.7917) kd_loss 1.1253 (1.0417) lr 1.1874e-03 eta 0:25:07
epoch [24/50] batch [320/403] time 0.097 (0.141) data 0.000 (0.009) loss 3.0133 (2.4531) ce_loss 1.4287 (1.0290) loss_zs_kd 0.5553 (0.4628) loss_oracle 0.3100 (0.3017) acc 56.2500 (65.7812) kd_loss 1.1519 (1.0419) lr 1.1874e-03 eta 0:24:54
epoch [24/50] batch [340/403] time 0.078 (0.140) data 0.000 (0.009) loss 2.3797 (2.4552) ce_loss 1.0205 (1.0289) loss_zs_kd 0.5475 (0.4647) loss_oracle 0.2812 (0.3017) acc 62.5000 (65.7812) kd_loss 0.9448 (1.0431) lr 1.1874e-03 eta 0:24:37
epoch [24/50] batch [360/403] time 0.101 (0.139) data 0.000 (0.008) loss 2.3918 (2.4569) ce_loss 0.9360 (1.0302) loss_zs_kd 0.4121 (0.4636) loss_oracle 0.2888 (0.3013) acc 71.8750 (65.7465) kd_loss 1.1053 (1.0442) lr 1.1874e-03 eta 0:24:19
epoch [24/50] batch [380/403] time 0.136 (0.137) data 0.000 (0.008) loss 2.3519 (2.4578) ce_loss 1.0527 (1.0299) loss_zs_kd 0.4622 (0.4635) loss_oracle 0.3387 (0.3006) acc 59.3750 (65.7155) kd_loss 0.8988 (1.0458) lr 1.1874e-03 eta 0:24:02
epoch [24/50] batch [400/403] time 0.081 (0.136) data 0.000 (0.007) loss 2.4146 (2.4615) ce_loss 0.9585 (1.0307) loss_zs_kd 0.3420 (0.4639) loss_oracle 0.2744 (0.3011) acc 65.6250 (65.6875) kd_loss 1.1480 (1.0482) lr 1.1874e-03 eta 0:23:43
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,721
* accuracy: 67.2%
* error: 32.8%
* macro_f1: 52.4%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,252
* accuracy: 38.3%
* error: 61.7%
* macro_f1: 28.5%
******* Domain 4 best val acc:      68.5%, epoch: 21 *******
******* Domain 4 best val test acc: 40.0%, epoch: 21 *******
******* Domain 4 best test acc:     41.4%, epoch: 13 *******
epoch [25/50] batch [20/403] time 0.103 (0.216) data 0.000 (0.112) loss 2.5972 (2.4399) ce_loss 1.1025 (1.0101) loss_zs_kd 0.4632 (0.4585) loss_oracle 0.3923 (0.3381) acc 59.3750 (66.5625) kd_loss 1.0669 (1.0315) lr 1.1253e-03 eta 0:37:36
epoch [25/50] batch [40/403] time 0.096 (0.157) data 0.000 (0.056) loss 2.3015 (2.4755) ce_loss 0.8638 (1.0423) loss_zs_kd 0.3739 (0.4495) loss_oracle 0.3557 (0.3309) acc 62.5000 (64.6094) kd_loss 1.0729 (1.0430) lr 1.1253e-03 eta 0:27:16
epoch [25/50] batch [60/403] time 0.107 (0.138) data 0.000 (0.038) loss 2.6587 (2.4631) ce_loss 1.2422 (1.0363) loss_zs_kd 0.5051 (0.4586) loss_oracle 0.3745 (0.3231) acc 53.1250 (65.0000) kd_loss 0.9766 (1.0359) lr 1.1253e-03 eta 0:23:56
epoch [25/50] batch [80/403] time 0.088 (0.125) data 0.000 (0.028) loss 2.3675 (2.4661) ce_loss 1.0400 (1.0343) loss_zs_kd 0.3329 (0.4658) loss_oracle 0.2564 (0.3183) acc 62.5000 (65.0391) kd_loss 1.0329 (1.0398) lr 1.1253e-03 eta 0:21:44
epoch [25/50] batch [100/403] time 0.074 (0.119) data 0.000 (0.023) loss 2.0974 (2.4608) ce_loss 0.8540 (1.0349) loss_zs_kd 0.4576 (0.4714) loss_oracle 0.2415 (0.3144) acc 75.0000 (64.6875) kd_loss 0.8938 (1.0329) lr 1.1253e-03 eta 0:20:36
epoch [25/50] batch [120/403] time 0.099 (0.116) data 0.000 (0.019) loss 2.2605 (2.4432) ce_loss 0.9106 (1.0212) loss_zs_kd 0.4886 (0.4728) loss_oracle 0.3353 (0.3145) acc 71.8750 (65.2604) kd_loss 0.9379 (1.0284) lr 1.1253e-03 eta 0:19:58
epoch [25/50] batch [140/403] time 0.078 (0.113) data 0.000 (0.016) loss 2.2977 (2.4396) ce_loss 0.9609 (1.0189) loss_zs_kd 0.4853 (0.4741) loss_oracle 0.2969 (0.3123) acc 59.3750 (65.0000) kd_loss 0.9456 (1.0275) lr 1.1253e-03 eta 0:19:29
epoch [25/50] batch [160/403] time 0.079 (0.110) data 0.000 (0.014) loss 2.4314 (2.4383) ce_loss 1.0234 (1.0194) loss_zs_kd 0.3969 (0.4712) loss_oracle 0.2658 (0.3096) acc 65.6250 (65.0195) kd_loss 1.0766 (1.0284) lr 1.1253e-03 eta 0:18:56
epoch [25/50] batch [180/403] time 0.105 (0.108) data 0.000 (0.013) loss 2.3263 (2.4411) ce_loss 1.0186 (1.0205) loss_zs_kd 0.4573 (0.4679) loss_oracle 0.3586 (0.3090) acc 59.3750 (64.8264) kd_loss 0.8998 (1.0321) lr 1.1253e-03 eta 0:18:32
epoch [25/50] batch [200/403] time 0.074 (0.106) data 0.000 (0.011) loss 2.0894 (2.4420) ce_loss 0.6787 (1.0202) loss_zs_kd 0.4414 (0.4673) loss_oracle 0.2779 (0.3085) acc 84.3750 (64.9062) kd_loss 1.0511 (1.0339) lr 1.1253e-03 eta 0:18:09
epoch [25/50] batch [220/403] time 0.082 (0.104) data 0.000 (0.010) loss 3.1577 (2.4490) ce_loss 1.7051 (1.0254) loss_zs_kd 0.4401 (0.4674) loss_oracle 0.3073 (0.3078) acc 34.3750 (64.8438) kd_loss 1.0789 (1.0360) lr 1.1253e-03 eta 0:17:51
epoch [25/50] batch [240/403] time 0.073 (0.103) data 0.000 (0.010) loss 2.3152 (2.4524) ce_loss 0.9453 (1.0250) loss_zs_kd 0.3822 (0.4661) loss_oracle 0.2717 (0.3084) acc 65.6250 (64.8958) kd_loss 1.0430 (1.0402) lr 1.1253e-03 eta 0:17:36
epoch [25/50] batch [260/403] time 0.147 (0.103) data 0.000 (0.009) loss 2.5353 (2.4542) ce_loss 0.9873 (1.0220) loss_zs_kd 0.4790 (0.4663) loss_oracle 0.3035 (0.3113) acc 62.5000 (65.1562) kd_loss 1.1568 (1.0435) lr 1.1253e-03 eta 0:17:36
epoch [25/50] batch [280/403] time 0.105 (0.104) data 0.000 (0.008) loss 2.5838 (2.4580) ce_loss 1.1670 (1.0220) loss_zs_kd 0.4482 (0.4673) loss_oracle 0.3173 (0.3126) acc 56.2500 (65.1339) kd_loss 1.0341 (1.0460) lr 1.1253e-03 eta 0:17:36
epoch [25/50] batch [300/403] time 0.079 (0.104) data 0.000 (0.008) loss 2.6965 (2.4615) ce_loss 1.1670 (1.0230) loss_zs_kd 0.4564 (0.4687) loss_oracle 0.2933 (0.3124) acc 50.0000 (65.1771) kd_loss 1.1546 (1.0480) lr 1.1253e-03 eta 0:17:34
epoch [25/50] batch [320/403] time 0.098 (0.103) data 0.000 (0.007) loss 2.3152 (2.4646) ce_loss 0.8770 (1.0226) loss_zs_kd 0.3324 (0.4671) loss_oracle 0.2169 (0.3117) acc 75.0000 (65.2051) kd_loss 1.1636 (1.0526) lr 1.1253e-03 eta 0:17:29
epoch [25/50] batch [340/403] time 0.160 (0.104) data 0.000 (0.007) loss 2.4874 (2.4665) ce_loss 1.0049 (1.0228) loss_zs_kd 0.4969 (0.4676) loss_oracle 0.2947 (0.3107) acc 65.6250 (65.2941) kd_loss 1.0867 (1.0546) lr 1.1253e-03 eta 0:17:38
epoch [25/50] batch [360/403] time 0.151 (0.107) data 0.000 (0.006) loss 2.4465 (2.4676) ce_loss 0.9341 (1.0216) loss_zs_kd 0.6125 (0.4683) loss_oracle 0.2950 (0.3106) acc 68.7500 (65.4514) kd_loss 1.0587 (1.0566) lr 1.1253e-03 eta 0:18:04
epoch [25/50] batch [380/403] time 0.064 (0.108) data 0.000 (0.006) loss 2.4519 (2.4708) ce_loss 1.0273 (1.0217) loss_zs_kd 0.4524 (0.4675) loss_oracle 0.3029 (0.3107) acc 65.6250 (65.4441) kd_loss 1.0469 (1.0600) lr 1.1253e-03 eta 0:18:06
epoch [25/50] batch [400/403] time 0.172 (0.108) data 0.000 (0.006) loss 2.5501 (2.4738) ce_loss 0.9561 (1.0220) loss_zs_kd 0.5601 (0.4679) loss_oracle 0.3331 (0.3109) acc 68.7500 (65.4141) kd_loss 1.1475 (1.0624) lr 1.1253e-03 eta 0:18:10
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,702
* accuracy: 66.9%
* error: 33.1%
* macro_f1: 53.7%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,366
* accuracy: 40.2%
* error: 59.8%
* macro_f1: 30.6%
******* Domain 4 best val acc:      68.5%, epoch: 21 *******
******* Domain 4 best val test acc: 40.0%, epoch: 21 *******
******* Domain 4 best test acc:     41.4%, epoch: 13 *******
epoch [26/50] batch [20/403] time 0.143 (0.267) data 0.000 (0.139) loss 2.6973 (2.6077) ce_loss 1.1025 (1.0919) loss_zs_kd 0.5618 (0.4661) loss_oracle 0.2651 (0.3344) acc 62.5000 (64.5312) kd_loss 1.1814 (1.1156) lr 1.0628e-03 eta 0:44:49
epoch [26/50] batch [40/403] time 0.152 (0.195) data 0.000 (0.070) loss 2.3897 (2.5805) ce_loss 0.7622 (1.0584) loss_zs_kd 0.4409 (0.4609) loss_oracle 0.2962 (0.3300) acc 75.0000 (65.3906) kd_loss 1.2589 (1.1267) lr 1.0628e-03 eta 0:32:33
epoch [26/50] batch [60/403] time 0.142 (0.169) data 0.001 (0.047) loss 2.4808 (2.5865) ce_loss 0.8999 (1.0555) loss_zs_kd 0.4733 (0.4708) loss_oracle 0.2992 (0.3281) acc 75.0000 (64.8958) kd_loss 1.1947 (1.1315) lr 1.0628e-03 eta 0:28:09
epoch [26/50] batch [80/403] time 0.096 (0.153) data 0.000 (0.035) loss 2.4220 (2.5786) ce_loss 0.9160 (1.0501) loss_zs_kd 0.5058 (0.4694) loss_oracle 0.3413 (0.3254) acc 71.8750 (65.5078) kd_loss 1.0825 (1.1311) lr 1.0628e-03 eta 0:25:32
epoch [26/50] batch [100/403] time 0.084 (0.147) data 0.000 (0.028) loss 2.6281 (2.5782) ce_loss 1.0459 (1.0424) loss_zs_kd 0.3801 (0.4710) loss_oracle 0.3436 (0.3229) acc 56.2500 (65.9062) kd_loss 1.2204 (1.1388) lr 1.0628e-03 eta 0:24:23
epoch [26/50] batch [120/403] time 0.131 (0.141) data 0.000 (0.023) loss 3.1658 (2.5860) ce_loss 1.4229 (1.0451) loss_zs_kd 0.5203 (0.4715) loss_oracle 0.3754 (0.3247) acc 43.7500 (65.4427) kd_loss 1.2951 (1.1428) lr 1.0628e-03 eta 0:23:24
epoch [26/50] batch [140/403] time 0.153 (0.142) data 0.001 (0.020) loss 2.4334 (2.5804) ce_loss 0.8535 (1.0392) loss_zs_kd 0.5183 (0.4672) loss_oracle 0.3724 (0.3282) acc 81.2500 (65.5357) kd_loss 1.1345 (1.1434) lr 1.0628e-03 eta 0:23:32
epoch [26/50] batch [160/403] time 0.136 (0.141) data 0.000 (0.018) loss 2.7097 (2.5784) ce_loss 1.1182 (1.0375) loss_zs_kd 0.4601 (0.4697) loss_oracle 0.2904 (0.3280) acc 53.1250 (65.4688) kd_loss 1.2163 (1.1421) lr 1.0628e-03 eta 0:23:21
epoch [26/50] batch [180/403] time 0.077 (0.138) data 0.000 (0.016) loss 2.5394 (2.5706) ce_loss 0.9897 (1.0339) loss_zs_kd 0.4241 (0.4672) loss_oracle 0.3566 (0.3289) acc 65.6250 (65.6597) kd_loss 1.1593 (1.1387) lr 1.0628e-03 eta 0:22:47
epoch [26/50] batch [200/403] time 0.067 (0.135) data 0.000 (0.014) loss 2.3812 (2.5601) ce_loss 0.9194 (1.0271) loss_zs_kd 0.3809 (0.4692) loss_oracle 0.3280 (0.3301) acc 65.6250 (65.9688) kd_loss 1.1073 (1.1333) lr 1.0628e-03 eta 0:22:14
epoch [26/50] batch [220/403] time 0.193 (0.132) data 0.000 (0.013) loss 2.3119 (2.5566) ce_loss 0.8486 (1.0270) loss_zs_kd 0.5663 (0.4701) loss_oracle 0.2793 (0.3299) acc 75.0000 (65.8665) kd_loss 1.0405 (1.1297) lr 1.0628e-03 eta 0:21:37
epoch [26/50] batch [240/403] time 0.077 (0.135) data 0.000 (0.012) loss 2.5047 (2.5493) ce_loss 1.0117 (1.0252) loss_zs_kd 0.4614 (0.4724) loss_oracle 0.3329 (0.3294) acc 65.6250 (65.9635) kd_loss 1.0958 (1.1232) lr 1.0628e-03 eta 0:22:05
epoch [26/50] batch [260/403] time 0.147 (0.131) data 0.000 (0.011) loss 2.6599 (2.5490) ce_loss 1.1572 (1.0290) loss_zs_kd 0.4187 (0.4717) loss_oracle 0.3507 (0.3295) acc 59.3750 (65.6971) kd_loss 1.1179 (1.1194) lr 1.0628e-03 eta 0:21:22
epoch [26/50] batch [280/403] time 0.086 (0.131) data 0.000 (0.010) loss 2.2778 (2.5425) ce_loss 0.8535 (1.0270) loss_zs_kd 0.4452 (0.4705) loss_oracle 0.3197 (0.3302) acc 68.7500 (65.7812) kd_loss 1.0418 (1.1151) lr 1.0628e-03 eta 0:21:27
epoch [26/50] batch [300/403] time 0.143 (0.129) data 0.000 (0.009) loss 2.4050 (2.5404) ce_loss 0.9204 (1.0282) loss_zs_kd 0.4508 (0.4711) loss_oracle 0.3432 (0.3298) acc 71.8750 (65.7708) kd_loss 1.0876 (1.1118) lr 1.0628e-03 eta 0:21:02
epoch [26/50] batch [320/403] time 0.096 (0.127) data 0.000 (0.009) loss 2.4806 (2.5329) ce_loss 1.0459 (1.0247) loss_zs_kd 0.4001 (0.4719) loss_oracle 0.3317 (0.3308) acc 59.3750 (65.8496) kd_loss 1.0688 (1.1069) lr 1.0628e-03 eta 0:20:41
epoch [26/50] batch [340/403] time 0.097 (0.126) data 0.000 (0.008) loss 2.3740 (2.5298) ce_loss 0.9775 (1.0248) loss_zs_kd 0.4637 (0.4711) loss_oracle 0.3451 (0.3320) acc 75.0000 (65.7996) kd_loss 0.9920 (1.1034) lr 1.0628e-03 eta 0:20:24
epoch [26/50] batch [360/403] time 0.077 (0.125) data 0.000 (0.008) loss 2.6914 (2.5297) ce_loss 1.1924 (1.0278) loss_zs_kd 0.5359 (0.4723) loss_oracle 0.3454 (0.3323) acc 56.2500 (65.6771) kd_loss 1.0583 (1.0996) lr 1.0628e-03 eta 0:20:12
epoch [26/50] batch [380/403] time 0.137 (0.124) data 0.000 (0.008) loss 2.5092 (2.5254) ce_loss 1.1074 (1.0296) loss_zs_kd 0.4013 (0.4706) loss_oracle 0.3596 (0.3317) acc 65.6250 (65.6743) kd_loss 1.0213 (1.0946) lr 1.0628e-03 eta 0:20:04
epoch [26/50] batch [400/403] time 0.082 (0.123) data 0.000 (0.007) loss 2.5942 (2.5225) ce_loss 1.1904 (1.0307) loss_zs_kd 0.5056 (0.4702) loss_oracle 0.2900 (0.3312) acc 62.5000 (65.6250) kd_loss 1.0060 (1.0911) lr 1.0628e-03 eta 0:19:53
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,716
* accuracy: 67.1%
* error: 32.9%
* macro_f1: 52.4%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,386
* accuracy: 40.6%
* error: 59.4%
* macro_f1: 30.0%
******* Domain 4 best val acc:      68.5%, epoch: 21 *******
******* Domain 4 best val test acc: 40.0%, epoch: 21 *******
******* Domain 4 best test acc:     41.4%, epoch: 13 *******
epoch [27/50] batch [20/403] time 0.075 (0.370) data 0.000 (0.173) loss 2.6379 (2.4905) ce_loss 1.2402 (1.0755) loss_zs_kd 0.4398 (0.4782) loss_oracle 0.3039 (0.3284) acc 53.1250 (63.2812) kd_loss 1.0259 (1.0117) lr 1.0000e-03 eta 0:59:28
epoch [27/50] batch [40/403] time 0.207 (0.243) data 0.000 (0.087) loss 2.3667 (2.4588) ce_loss 0.9561 (1.0440) loss_zs_kd 0.5152 (0.4700) loss_oracle 0.2736 (0.3244) acc 78.1250 (65.7031) kd_loss 1.0162 (1.0176) lr 1.0000e-03 eta 0:39:05
epoch [27/50] batch [60/403] time 0.086 (0.201) data 0.000 (0.058) loss 2.4340 (2.4648) ce_loss 0.9956 (1.0332) loss_zs_kd 0.4286 (0.4857) loss_oracle 0.3710 (0.3348) acc 71.8750 (66.0938) kd_loss 1.0386 (1.0214) lr 1.0000e-03 eta 0:32:08
epoch [27/50] batch [80/403] time 0.102 (0.177) data 0.000 (0.043) loss 2.7747 (2.4536) ce_loss 1.3291 (1.0242) loss_zs_kd 0.5746 (0.4791) loss_oracle 0.2904 (0.3372) acc 53.1250 (66.0156) kd_loss 1.0131 (1.0212) lr 1.0000e-03 eta 0:28:14
epoch [27/50] batch [100/403] time 0.150 (0.165) data 0.001 (0.035) loss 2.6488 (2.4529) ce_loss 1.1387 (1.0235) loss_zs_kd 0.4518 (0.4783) loss_oracle 0.3721 (0.3367) acc 53.1250 (66.1250) kd_loss 1.0982 (1.0219) lr 1.0000e-03 eta 0:26:20
epoch [27/50] batch [120/403] time 0.141 (0.160) data 0.000 (0.029) loss 2.5394 (2.4554) ce_loss 1.1289 (1.0237) loss_zs_kd 0.5322 (0.4808) loss_oracle 0.3211 (0.3345) acc 62.5000 (66.3021) kd_loss 0.9838 (1.0241) lr 1.0000e-03 eta 0:25:27
epoch [27/50] batch [140/403] time 0.102 (0.158) data 0.000 (0.025) loss 2.6764 (2.4639) ce_loss 1.1719 (1.0311) loss_zs_kd 0.4728 (0.4810) loss_oracle 0.3814 (0.3361) acc 59.3750 (65.8482) kd_loss 1.0774 (1.0242) lr 1.0000e-03 eta 0:25:02
epoch [27/50] batch [160/403] time 0.130 (0.152) data 0.000 (0.022) loss 2.4646 (2.4614) ce_loss 1.1982 (1.0311) loss_zs_kd 0.4414 (0.4788) loss_oracle 0.3038 (0.3350) acc 62.5000 (65.7422) kd_loss 0.8938 (1.0234) lr 1.0000e-03 eta 0:24:05
epoch [27/50] batch [180/403] time 0.153 (0.150) data 0.000 (0.019) loss 2.9011 (2.4606) ce_loss 1.3799 (1.0298) loss_zs_kd 0.4673 (0.4779) loss_oracle 0.3541 (0.3379) acc 56.2500 (65.9201) kd_loss 1.1105 (1.0230) lr 1.0000e-03 eta 0:23:44
epoch [27/50] batch [200/403] time 0.170 (0.151) data 0.000 (0.018) loss 2.5048 (2.4612) ce_loss 1.0195 (1.0285) loss_zs_kd 0.4864 (0.4824) loss_oracle 0.4168 (0.3380) acc 65.6250 (65.8438) kd_loss 1.0337 (1.0225) lr 1.0000e-03 eta 0:23:46
epoch [27/50] batch [220/403] time 0.087 (0.148) data 0.000 (0.016) loss 2.4267 (2.4715) ce_loss 0.9648 (1.0360) loss_zs_kd 0.3927 (0.4823) loss_oracle 0.3622 (0.3383) acc 71.8750 (65.4830) kd_loss 1.0844 (1.0252) lr 1.0000e-03 eta 0:23:19
epoch [27/50] batch [240/403] time 0.082 (0.145) data 0.000 (0.015) loss 2.6445 (2.4736) ce_loss 1.2705 (1.0375) loss_zs_kd 0.4030 (0.4794) loss_oracle 0.2863 (0.3393) acc 59.3750 (65.4036) kd_loss 1.0293 (1.0268) lr 1.0000e-03 eta 0:22:49
epoch [27/50] batch [260/403] time 0.142 (0.143) data 0.000 (0.014) loss 2.4875 (2.4753) ce_loss 1.1182 (1.0400) loss_zs_kd 0.3531 (0.4787) loss_oracle 0.3239 (0.3384) acc 62.5000 (65.3365) kd_loss 1.0308 (1.0267) lr 1.0000e-03 eta 0:22:24
epoch [27/50] batch [280/403] time 0.111 (0.141) data 0.000 (0.013) loss 2.5203 (2.4744) ce_loss 1.0752 (1.0395) loss_zs_kd 0.5041 (0.4786) loss_oracle 0.3567 (0.3363) acc 62.5000 (65.3460) kd_loss 1.0147 (1.0275) lr 1.0000e-03 eta 0:22:03
epoch [27/50] batch [300/403] time 0.119 (0.139) data 0.000 (0.012) loss 2.3383 (2.4742) ce_loss 0.9395 (1.0402) loss_zs_kd 0.3854 (0.4764) loss_oracle 0.2812 (0.3362) acc 59.3750 (65.1562) kd_loss 1.0656 (1.0278) lr 1.0000e-03 eta 0:21:46
epoch [27/50] batch [320/403] time 0.116 (0.138) data 0.000 (0.011) loss 2.4076 (2.4719) ce_loss 0.9951 (1.0380) loss_zs_kd 0.4657 (0.4746) loss_oracle 0.3306 (0.3369) acc 62.5000 (65.0977) kd_loss 1.0143 (1.0282) lr 1.0000e-03 eta 0:21:30
epoch [27/50] batch [340/403] time 0.156 (0.138) data 0.000 (0.010) loss 2.7472 (2.4769) ce_loss 1.2031 (1.0421) loss_zs_kd 0.4621 (0.4744) loss_oracle 0.3043 (0.3362) acc 71.8750 (64.8989) kd_loss 1.1609 (1.0295) lr 1.0000e-03 eta 0:21:24
epoch [27/50] batch [360/403] time 0.152 (0.137) data 0.000 (0.010) loss 2.7403 (2.4755) ce_loss 1.2432 (1.0400) loss_zs_kd 0.5503 (0.4758) loss_oracle 0.3588 (0.3355) acc 53.1250 (65.0347) kd_loss 1.0426 (1.0298) lr 1.0000e-03 eta 0:21:16
epoch [27/50] batch [380/403] time 0.082 (0.137) data 0.000 (0.009) loss 2.4450 (2.4738) ce_loss 0.9546 (1.0390) loss_zs_kd 0.4952 (0.4755) loss_oracle 0.3611 (0.3363) acc 65.6250 (65.1398) kd_loss 1.0622 (1.0289) lr 1.0000e-03 eta 0:21:09
epoch [27/50] batch [400/403] time 0.082 (0.135) data 0.000 (0.009) loss 2.4057 (2.4746) ce_loss 1.0166 (1.0396) loss_zs_kd 0.5707 (0.4750) loss_oracle 0.3384 (0.3364) acc 71.8750 (65.0938) kd_loss 0.9346 (1.0293) lr 1.0000e-03 eta 0:20:53
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,797
* accuracy: 68.6%
* error: 31.4%
* macro_f1: 53.6%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,539
* accuracy: 43.2%
* error: 56.8%
* macro_f1: 33.2%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      68.6%, epoch: 27 *******
******* Domain 4 best val test acc: 43.2%, epoch: 27 *******
******* Domain 4 best test acc:     43.2%, epoch: 27 *******
epoch [28/50] batch [20/403] time 0.148 (0.290) data 0.000 (0.159) loss 2.6944 (2.4783) ce_loss 1.0879 (1.0291) loss_zs_kd 0.5501 (0.4796) loss_oracle 0.3185 (0.3455) acc 59.3750 (63.5938) kd_loss 1.1723 (1.0367) lr 9.3721e-04 eta 0:44:40
epoch [28/50] batch [40/403] time 0.140 (0.221) data 0.000 (0.080) loss 2.5266 (2.4805) ce_loss 1.0928 (1.0297) loss_zs_kd 0.4461 (0.4723) loss_oracle 0.3003 (0.3338) acc 59.3750 (64.6875) kd_loss 1.0606 (1.0477) lr 9.3721e-04 eta 0:34:02
epoch [28/50] batch [60/403] time 0.151 (0.199) data 0.000 (0.053) loss 2.6951 (2.5109) ce_loss 1.1172 (1.0546) loss_zs_kd 0.5332 (0.4715) loss_oracle 0.2739 (0.3387) acc 65.6250 (64.0104) kd_loss 1.1743 (1.0512) lr 9.3721e-04 eta 0:30:29
epoch [28/50] batch [80/403] time 0.145 (0.184) data 0.000 (0.040) loss 2.3895 (2.4845) ce_loss 0.9932 (1.0300) loss_zs_kd 0.4725 (0.4733) loss_oracle 0.2825 (0.3386) acc 65.6250 (65.5078) kd_loss 1.0188 (1.0485) lr 9.3721e-04 eta 0:28:12
epoch [28/50] batch [100/403] time 0.084 (0.170) data 0.000 (0.032) loss 2.6322 (2.4922) ce_loss 1.1553 (1.0378) loss_zs_kd 0.3895 (0.4707) loss_oracle 0.4207 (0.3413) acc 56.2500 (65.3125) kd_loss 1.0718 (1.0485) lr 9.3721e-04 eta 0:26:01
epoch [28/50] batch [120/403] time 0.142 (0.162) data 0.000 (0.027) loss 2.6247 (2.4852) ce_loss 1.2314 (1.0292) loss_zs_kd 0.4278 (0.4766) loss_oracle 0.3540 (0.3442) acc 53.1250 (65.6250) kd_loss 1.0024 (1.0456) lr 9.3721e-04 eta 0:24:41
epoch [28/50] batch [140/403] time 0.122 (0.155) data 0.000 (0.023) loss 2.4373 (2.4748) ce_loss 1.0635 (1.0214) loss_zs_kd 0.4897 (0.4792) loss_oracle 0.3771 (0.3427) acc 65.6250 (66.0491) kd_loss 0.9405 (1.0424) lr 9.3721e-04 eta 0:23:31
epoch [28/50] batch [160/403] time 0.095 (0.150) data 0.000 (0.020) loss 2.1627 (2.4786) ce_loss 0.7646 (1.0275) loss_zs_kd 0.4580 (0.4815) loss_oracle 0.3469 (0.3422) acc 75.0000 (65.6641) kd_loss 0.9956 (1.0392) lr 9.3721e-04 eta 0:22:41
epoch [28/50] batch [180/403] time 0.095 (0.146) data 0.000 (0.018) loss 2.4314 (2.4732) ce_loss 1.0654 (1.0245) loss_zs_kd 0.4436 (0.4827) loss_oracle 0.2999 (0.3432) acc 53.1250 (65.5035) kd_loss 0.9942 (1.0357) lr 9.3721e-04 eta 0:22:07
epoch [28/50] batch [200/403] time 0.069 (0.142) data 0.000 (0.016) loss 2.3393 (2.4662) ce_loss 0.9033 (1.0211) loss_zs_kd 0.4500 (0.4814) loss_oracle 0.2699 (0.3426) acc 75.0000 (65.5156) kd_loss 1.0760 (1.0332) lr 9.3721e-04 eta 0:21:24
epoch [28/50] batch [220/403] time 0.187 (0.138) data 0.000 (0.015) loss 2.6228 (2.4678) ce_loss 1.1514 (1.0253) loss_zs_kd 0.5562 (0.4808) loss_oracle 0.3659 (0.3428) acc 59.3750 (65.3835) kd_loss 1.0104 (1.0307) lr 9.3721e-04 eta 0:20:45
epoch [28/50] batch [240/403] time 0.068 (0.140) data 0.000 (0.013) loss 2.3246 (2.4700) ce_loss 0.9302 (1.0297) loss_zs_kd 0.4469 (0.4778) loss_oracle 0.3574 (0.3418) acc 68.7500 (65.1823) kd_loss 0.9923 (1.0306) lr 9.3721e-04 eta 0:21:04
epoch [28/50] batch [260/403] time 0.196 (0.138) data 0.000 (0.012) loss 2.4160 (2.4696) ce_loss 0.9712 (1.0307) loss_zs_kd 0.3651 (0.4756) loss_oracle 0.3733 (0.3430) acc 65.6250 (65.3606) kd_loss 1.0755 (1.0296) lr 9.3721e-04 eta 0:20:42
epoch [28/50] batch [280/403] time 0.075 (0.136) data 0.000 (0.012) loss 2.1727 (2.4667) ce_loss 0.7368 (1.0286) loss_zs_kd 0.5565 (0.4751) loss_oracle 0.3221 (0.3445) acc 75.0000 (65.5580) kd_loss 0.9966 (1.0283) lr 9.3721e-04 eta 0:20:22
epoch [28/50] batch [300/403] time 0.092 (0.134) data 0.000 (0.011) loss 2.4106 (2.4620) ce_loss 1.0127 (1.0262) loss_zs_kd 0.4705 (0.4763) loss_oracle 0.3265 (0.3429) acc 65.6250 (65.5208) kd_loss 0.9994 (1.0262) lr 9.3721e-04 eta 0:20:02
epoch [28/50] batch [320/403] time 0.101 (0.133) data 0.000 (0.010) loss 2.2091 (2.4611) ce_loss 0.9116 (1.0278) loss_zs_kd 0.3670 (0.4751) loss_oracle 0.2998 (0.3423) acc 68.7500 (65.4492) kd_loss 0.9641 (1.0246) lr 9.3721e-04 eta 0:19:47
epoch [28/50] batch [340/403] time 0.142 (0.132) data 0.000 (0.010) loss 2.1978 (2.4582) ce_loss 0.8579 (1.0270) loss_zs_kd 0.4006 (0.4752) loss_oracle 0.3269 (0.3414) acc 75.0000 (65.5055) kd_loss 0.9761 (1.0229) lr 9.3721e-04 eta 0:19:35
epoch [28/50] batch [360/403] time 0.114 (0.131) data 0.000 (0.009) loss 2.3033 (2.4557) ce_loss 0.9048 (1.0269) loss_zs_kd 0.3837 (0.4730) loss_oracle 0.3644 (0.3410) acc 68.7500 (65.5556) kd_loss 1.0244 (1.0218) lr 9.3721e-04 eta 0:19:24
epoch [28/50] batch [380/403] time 0.151 (0.130) data 0.000 (0.009) loss 2.1853 (2.4537) ce_loss 0.8618 (1.0266) loss_zs_kd 0.4287 (0.4716) loss_oracle 0.2948 (0.3407) acc 65.6250 (65.5428) kd_loss 0.9618 (1.0209) lr 9.3721e-04 eta 0:19:14
epoch [28/50] batch [400/403] time 0.082 (0.129) data 0.000 (0.008) loss 2.5305 (2.4541) ce_loss 1.1514 (1.0278) loss_zs_kd 0.4524 (0.4721) loss_oracle 0.3261 (0.3413) acc 71.8750 (65.5625) kd_loss 0.9899 (1.0196) lr 9.3721e-04 eta 0:19:00
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,769
* accuracy: 68.1%
* error: 31.9%
* macro_f1: 53.3%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,497
* accuracy: 42.4%
* error: 57.6%
* macro_f1: 32.2%
******* Domain 4 best val acc:      68.6%, epoch: 27 *******
******* Domain 4 best val test acc: 43.2%, epoch: 27 *******
******* Domain 4 best test acc:     43.2%, epoch: 27 *******
epoch [29/50] batch [20/403] time 0.188 (0.333) data 0.000 (0.150) loss 2.2698 (2.4515) ce_loss 0.8882 (1.0384) loss_zs_kd 0.4304 (0.5103) loss_oracle 0.3269 (0.3575) acc 75.0000 (66.8750) kd_loss 1.0029 (0.9792) lr 8.7467e-04 eta 0:49:05
epoch [29/50] batch [40/403] time 0.090 (0.208) data 0.000 (0.075) loss 2.2806 (2.4409) ce_loss 0.9863 (1.0278) loss_zs_kd 0.3679 (0.4910) loss_oracle 0.2892 (0.3483) acc 68.7500 (66.3281) kd_loss 0.9658 (0.9934) lr 8.7467e-04 eta 0:30:34
epoch [29/50] batch [60/403] time 0.073 (0.188) data 0.000 (0.050) loss 2.5055 (2.4357) ce_loss 1.0137 (1.0254) loss_zs_kd 0.4802 (0.4737) loss_oracle 0.3677 (0.3385) acc 71.8750 (65.7292) kd_loss 1.0679 (1.0042) lr 8.7467e-04 eta 0:27:37
epoch [29/50] batch [80/403] time 0.141 (0.164) data 0.000 (0.038) loss 2.6895 (2.4362) ce_loss 1.3154 (1.0253) loss_zs_kd 0.5048 (0.4724) loss_oracle 0.3206 (0.3355) acc 59.3750 (65.9766) kd_loss 0.9614 (1.0068) lr 8.7467e-04 eta 0:24:00
epoch [29/50] batch [100/403] time 0.090 (0.153) data 0.000 (0.030) loss 2.4731 (2.4413) ce_loss 0.9927 (1.0272) loss_zs_kd 0.4519 (0.4635) loss_oracle 0.3141 (0.3405) acc 65.6250 (66.2188) kd_loss 1.0974 (1.0121) lr 8.7467e-04 eta 0:22:18
epoch [29/50] batch [120/403] time 0.129 (0.151) data 0.000 (0.025) loss 2.2765 (2.4540) ce_loss 0.9019 (1.0397) loss_zs_kd 0.4173 (0.4660) loss_oracle 0.3235 (0.3386) acc 65.6250 (65.4948) kd_loss 1.0043 (1.0120) lr 8.7467e-04 eta 0:22:01
epoch [29/50] batch [140/403] time 0.129 (0.148) data 0.000 (0.022) loss 2.5855 (2.4553) ce_loss 1.0752 (1.0366) loss_zs_kd 0.5501 (0.4657) loss_oracle 0.4286 (0.3408) acc 65.6250 (65.4911) kd_loss 1.0209 (1.0155) lr 8.7467e-04 eta 0:21:31
epoch [29/50] batch [160/403] time 0.111 (0.143) data 0.000 (0.019) loss 2.2971 (2.4514) ce_loss 0.8013 (1.0337) loss_zs_kd 0.5439 (0.4667) loss_oracle 0.3537 (0.3402) acc 78.1250 (65.7227) kd_loss 1.0469 (1.0142) lr 8.7467e-04 eta 0:20:45
epoch [29/50] batch [180/403] time 0.137 (0.139) data 0.000 (0.017) loss 2.0990 (2.4520) ce_loss 0.7104 (1.0327) loss_zs_kd 0.4923 (0.4699) loss_oracle 0.3585 (0.3405) acc 81.2500 (65.8507) kd_loss 0.9631 (1.0141) lr 8.7467e-04 eta 0:20:10
epoch [29/50] batch [200/403] time 0.075 (0.136) data 0.000 (0.015) loss 2.3778 (2.4514) ce_loss 0.8530 (1.0310) loss_zs_kd 0.6148 (0.4738) loss_oracle 0.3943 (0.3413) acc 71.8750 (66.0156) kd_loss 1.0202 (1.0128) lr 8.7467e-04 eta 0:19:42
epoch [29/50] batch [220/403] time 0.083 (0.134) data 0.000 (0.014) loss 2.4252 (2.4487) ce_loss 0.9546 (1.0280) loss_zs_kd 0.5291 (0.4729) loss_oracle 0.3068 (0.3417) acc 65.6250 (66.0795) kd_loss 1.0526 (1.0134) lr 8.7467e-04 eta 0:19:18
epoch [29/50] batch [240/403] time 0.085 (0.132) data 0.000 (0.013) loss 2.9196 (2.4491) ce_loss 1.3906 (1.0276) loss_zs_kd 0.5342 (0.4730) loss_oracle 0.3463 (0.3415) acc 46.8750 (65.9505) kd_loss 1.0887 (1.0143) lr 8.7467e-04 eta 0:19:00
epoch [29/50] batch [260/403] time 0.122 (0.131) data 0.000 (0.012) loss 2.4205 (2.4521) ce_loss 1.0098 (1.0290) loss_zs_kd 0.4372 (0.4744) loss_oracle 0.3369 (0.3413) acc 65.6250 (65.8053) kd_loss 1.0237 (1.0152) lr 8.7467e-04 eta 0:18:45
epoch [29/50] batch [280/403] time 0.114 (0.128) data 0.000 (0.011) loss 2.3596 (2.4537) ce_loss 0.8711 (1.0295) loss_zs_kd 0.5694 (0.4744) loss_oracle 0.3265 (0.3400) acc 68.7500 (65.6920) kd_loss 1.0406 (1.0169) lr 8.7467e-04 eta 0:18:21
epoch [29/50] batch [300/403] time 0.117 (0.126) data 0.000 (0.010) loss 2.6752 (2.4541) ce_loss 1.2227 (1.0296) loss_zs_kd 0.4933 (0.4744) loss_oracle 0.3498 (0.3409) acc 62.5000 (65.7083) kd_loss 1.0310 (1.0169) lr 8.7467e-04 eta 0:18:00
epoch [29/50] batch [320/403] time 0.081 (0.124) data 0.000 (0.010) loss 2.5533 (2.4538) ce_loss 1.1445 (1.0291) loss_zs_kd 0.5118 (0.4752) loss_oracle 0.3689 (0.3416) acc 62.5000 (65.5957) kd_loss 0.9684 (1.0163) lr 8.7467e-04 eta 0:17:40
epoch [29/50] batch [340/403] time 0.083 (0.123) data 0.000 (0.009) loss 2.6627 (2.4548) ce_loss 1.2305 (1.0309) loss_zs_kd 0.4725 (0.4742) loss_oracle 0.3549 (0.3432) acc 53.1250 (65.4504) kd_loss 1.0185 (1.0151) lr 8.7467e-04 eta 0:17:28
epoch [29/50] batch [360/403] time 0.118 (0.122) data 0.000 (0.009) loss 2.7532 (2.4534) ce_loss 1.4600 (1.0298) loss_zs_kd 0.4667 (0.4747) loss_oracle 0.3760 (0.3444) acc 50.0000 (65.4601) kd_loss 0.8719 (1.0141) lr 8.7467e-04 eta 0:17:20
epoch [29/50] batch [380/403] time 0.121 (0.122) data 0.000 (0.008) loss 2.3969 (2.4581) ce_loss 1.0127 (1.0351) loss_zs_kd 0.5032 (0.4743) loss_oracle 0.3363 (0.3446) acc 59.3750 (65.3207) kd_loss 0.9645 (1.0135) lr 8.7467e-04 eta 0:17:13
epoch [29/50] batch [400/403] time 0.113 (0.121) data 0.000 (0.008) loss 2.5051 (2.4578) ce_loss 1.0684 (1.0353) loss_zs_kd 0.4402 (0.4731) loss_oracle 0.3995 (0.3457) acc 68.7500 (65.4688) kd_loss 1.0168 (1.0131) lr 8.7467e-04 eta 0:17:04
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,706
* accuracy: 67.0%
* error: 33.0%
* macro_f1: 53.2%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,381
* accuracy: 40.5%
* error: 59.5%
* macro_f1: 31.0%
******* Domain 4 best val acc:      68.6%, epoch: 27 *******
******* Domain 4 best val test acc: 43.2%, epoch: 27 *******
******* Domain 4 best test acc:     43.2%, epoch: 27 *******
epoch [30/50] batch [20/403] time 0.156 (0.274) data 0.000 (0.130) loss 2.3466 (2.4690) ce_loss 0.9336 (1.0409) loss_zs_kd 0.4038 (0.4790) loss_oracle 0.3780 (0.3544) acc 65.6250 (62.9688) kd_loss 1.0221 (1.0115) lr 8.1262e-04 eta 0:38:33
epoch [30/50] batch [40/403] time 0.156 (0.214) data 0.000 (0.065) loss 2.1920 (2.4660) ce_loss 0.8706 (1.0385) loss_zs_kd 0.4504 (0.4760) loss_oracle 0.3758 (0.3478) acc 68.7500 (64.4531) kd_loss 0.9083 (1.0156) lr 8.1262e-04 eta 0:30:04
epoch [30/50] batch [60/403] time 0.154 (0.194) data 0.000 (0.044) loss 2.3166 (2.4580) ce_loss 0.9800 (1.0379) loss_zs_kd 0.4572 (0.4741) loss_oracle 0.3015 (0.3436) acc 71.8750 (64.5833) kd_loss 0.9572 (1.0112) lr 8.1262e-04 eta 0:27:09
epoch [30/50] batch [80/403] time 0.154 (0.184) data 0.000 (0.033) loss 2.3633 (2.4462) ce_loss 0.9746 (1.0246) loss_zs_kd 0.4003 (0.4713) loss_oracle 0.2922 (0.3453) acc 56.2500 (65.4297) kd_loss 1.0424 (1.0133) lr 8.1262e-04 eta 0:25:41
epoch [30/50] batch [100/403] time 0.152 (0.178) data 0.000 (0.026) loss 2.3349 (2.4405) ce_loss 0.8604 (1.0161) loss_zs_kd 0.5320 (0.4765) loss_oracle 0.3266 (0.3419) acc 71.8750 (65.5625) kd_loss 1.0452 (1.0152) lr 8.1262e-04 eta 0:24:46
epoch [30/50] batch [120/403] time 0.157 (0.174) data 0.000 (0.022) loss 2.5536 (2.4343) ce_loss 1.2119 (1.0104) loss_zs_kd 0.4530 (0.4799) loss_oracle 0.3562 (0.3399) acc 46.8750 (65.8333) kd_loss 0.9371 (1.0140) lr 8.1262e-04 eta 0:24:10
epoch [30/50] batch [140/403] time 0.156 (0.171) data 0.000 (0.019) loss 2.2679 (2.4314) ce_loss 0.8701 (1.0075) loss_zs_kd 0.4236 (0.4784) loss_oracle 0.3351 (0.3414) acc 78.1250 (65.8482) kd_loss 1.0185 (1.0140) lr 8.1262e-04 eta 0:23:42
epoch [30/50] batch [160/403] time 0.155 (0.169) data 0.000 (0.016) loss 2.5115 (2.4354) ce_loss 1.0234 (1.0095) loss_zs_kd 0.5122 (0.4792) loss_oracle 0.3941 (0.3407) acc 71.8750 (65.8203) kd_loss 1.0350 (1.0160) lr 8.1262e-04 eta 0:23:21
epoch [30/50] batch [180/403] time 0.102 (0.163) data 0.000 (0.015) loss 2.3066 (2.4387) ce_loss 0.9165 (1.0137) loss_zs_kd 0.4131 (0.4796) loss_oracle 0.3247 (0.3378) acc 75.0000 (65.9028) kd_loss 1.0212 (1.0163) lr 8.1262e-04 eta 0:22:30
epoch [30/50] batch [200/403] time 0.090 (0.158) data 0.000 (0.013) loss 2.3966 (2.4410) ce_loss 0.9731 (1.0146) loss_zs_kd 0.4160 (0.4764) loss_oracle 0.2366 (0.3365) acc 56.2500 (65.5938) kd_loss 1.0972 (1.0199) lr 8.1262e-04 eta 0:21:47
epoch [30/50] batch [220/403] time 0.096 (0.154) data 0.000 (0.012) loss 2.4900 (2.4452) ce_loss 1.0674 (1.0167) loss_zs_kd 0.5062 (0.4779) loss_oracle 0.3092 (0.3368) acc 62.5000 (65.5540) kd_loss 1.0149 (1.0212) lr 8.1262e-04 eta 0:21:07
epoch [30/50] batch [240/403] time 0.116 (0.150) data 0.000 (0.011) loss 2.6933 (2.4547) ce_loss 1.2031 (1.0233) loss_zs_kd 0.4814 (0.4773) loss_oracle 0.3690 (0.3395) acc 62.5000 (65.4557) kd_loss 1.0649 (1.0229) lr 8.1262e-04 eta 0:20:32
epoch [30/50] batch [260/403] time 0.121 (0.147) data 0.000 (0.010) loss 2.3518 (2.4542) ce_loss 0.9731 (1.0223) loss_zs_kd 0.4558 (0.4772) loss_oracle 0.3277 (0.3401) acc 75.0000 (65.5529) kd_loss 0.9869 (1.0232) lr 8.1262e-04 eta 0:20:05
epoch [30/50] batch [280/403] time 0.071 (0.143) data 0.000 (0.009) loss 2.7911 (2.4601) ce_loss 1.3164 (1.0261) loss_zs_kd 0.4986 (0.4780) loss_oracle 0.3510 (0.3409) acc 46.8750 (65.5692) kd_loss 1.0499 (1.0245) lr 8.1262e-04 eta 0:19:30
epoch [30/50] batch [300/403] time 0.190 (0.140) data 0.000 (0.009) loss 2.5835 (2.4654) ce_loss 1.2012 (1.0308) loss_zs_kd 0.5005 (0.4777) loss_oracle 0.2753 (0.3413) acc 56.2500 (65.5000) kd_loss 0.9944 (1.0251) lr 8.1262e-04 eta 0:19:05
epoch [30/50] batch [320/403] time 0.070 (0.141) data 0.000 (0.008) loss 2.7487 (2.4627) ce_loss 1.3506 (1.0292) loss_zs_kd 0.4858 (0.4761) loss_oracle 0.3341 (0.3400) acc 40.6250 (65.5469) kd_loss 0.9881 (1.0254) lr 8.1262e-04 eta 0:19:11
epoch [30/50] batch [340/403] time 0.094 (0.138) data 0.000 (0.008) loss 2.3314 (2.4660) ce_loss 0.8501 (1.0320) loss_zs_kd 0.4711 (0.4748) loss_oracle 0.3460 (0.3401) acc 68.7500 (65.4504) kd_loss 1.0727 (1.0266) lr 8.1262e-04 eta 0:18:37
epoch [30/50] batch [360/403] time 0.072 (0.138) data 0.000 (0.007) loss 2.5520 (2.4643) ce_loss 1.0703 (1.0310) loss_zs_kd 0.4853 (0.4758) loss_oracle 0.4311 (0.3398) acc 65.6250 (65.4167) kd_loss 1.0235 (1.0255) lr 8.1262e-04 eta 0:18:36
epoch [30/50] batch [380/403] time 0.134 (0.135) data 0.000 (0.007) loss 2.2487 (2.4649) ce_loss 0.9053 (1.0313) loss_zs_kd 0.3717 (0.4756) loss_oracle 0.2905 (0.3400) acc 81.2500 (65.4030) kd_loss 1.0124 (1.0257) lr 8.1262e-04 eta 0:18:13
epoch [30/50] batch [400/403] time 0.101 (0.133) data 0.000 (0.007) loss 2.2813 (2.4629) ce_loss 0.8896 (1.0299) loss_zs_kd 0.5738 (0.4753) loss_oracle 0.3696 (0.3406) acc 68.7500 (65.4219) kd_loss 0.9200 (1.0250) lr 8.1262e-04 eta 0:17:55
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,738
* accuracy: 67.5%
* error: 32.5%
* macro_f1: 53.5%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,478
* accuracy: 42.1%
* error: 57.9%
* macro_f1: 32.9%
******* Domain 4 best val acc:      68.6%, epoch: 27 *******
******* Domain 4 best val test acc: 43.2%, epoch: 27 *******
******* Domain 4 best test acc:     43.2%, epoch: 27 *******
epoch [31/50] batch [20/403] time 0.159 (0.289) data 0.000 (0.140) loss 2.3580 (2.4601) ce_loss 1.0059 (1.0317) loss_zs_kd 0.3569 (0.4626) loss_oracle 0.3153 (0.3547) acc 62.5000 (66.0938) kd_loss 1.0160 (1.0197) lr 7.5131e-04 eta 0:38:45
epoch [31/50] batch [40/403] time 0.158 (0.220) data 0.000 (0.070) loss 2.3930 (2.4671) ce_loss 1.0215 (1.0441) loss_zs_kd 0.4705 (0.4711) loss_oracle 0.3597 (0.3531) acc 68.7500 (65.8594) kd_loss 0.9564 (1.0109) lr 7.5131e-04 eta 0:29:27
epoch [31/50] batch [60/403] time 0.079 (0.176) data 0.000 (0.047) loss 2.2818 (2.4610) ce_loss 0.9556 (1.0361) loss_zs_kd 0.4757 (0.4776) loss_oracle 0.3658 (0.3486) acc 71.8750 (65.0000) kd_loss 0.9055 (1.0118) lr 7.5131e-04 eta 0:23:24
epoch [31/50] batch [80/403] time 0.188 (0.168) data 0.000 (0.035) loss 2.4806 (2.4611) ce_loss 1.1729 (1.0343) loss_zs_kd 0.3965 (0.4735) loss_oracle 0.3270 (0.3471) acc 62.5000 (64.4141) kd_loss 0.9460 (1.0165) lr 7.5131e-04 eta 0:22:20
epoch [31/50] batch [100/403] time 0.074 (0.158) data 0.000 (0.028) loss 2.4078 (2.4657) ce_loss 0.9683 (1.0374) loss_zs_kd 0.4270 (0.4716) loss_oracle 0.2946 (0.3450) acc 75.0000 (64.5312) kd_loss 1.0787 (1.0200) lr 7.5131e-04 eta 0:20:58
epoch [31/50] batch [120/403] time 0.188 (0.148) data 0.000 (0.024) loss 2.1877 (2.4579) ce_loss 0.8057 (1.0300) loss_zs_kd 0.5410 (0.4752) loss_oracle 0.3282 (0.3432) acc 71.8750 (64.9479) kd_loss 0.9474 (1.0187) lr 7.5131e-04 eta 0:19:36
epoch [31/50] batch [140/403] time 0.081 (0.146) data 0.000 (0.020) loss 2.6661 (2.4547) ce_loss 1.2725 (1.0308) loss_zs_kd 0.4171 (0.4767) loss_oracle 0.3234 (0.3424) acc 53.1250 (65.1786) kd_loss 1.0234 (1.0143) lr 7.5131e-04 eta 0:19:19
epoch [31/50] batch [160/403] time 0.152 (0.142) data 0.000 (0.018) loss 2.4787 (2.4586) ce_loss 1.0820 (1.0382) loss_zs_kd 0.4121 (0.4788) loss_oracle 0.3330 (0.3414) acc 62.5000 (64.9023) kd_loss 1.0241 (1.0103) lr 7.5131e-04 eta 0:18:44
epoch [31/50] batch [180/403] time 0.138 (0.140) data 0.000 (0.016) loss 2.6507 (2.4568) ce_loss 1.1338 (1.0377) loss_zs_kd 0.4969 (0.4746) loss_oracle 0.3645 (0.3433) acc 65.6250 (64.8611) kd_loss 1.0862 (1.0102) lr 7.5131e-04 eta 0:18:21
epoch [31/50] batch [200/403] time 0.151 (0.139) data 0.000 (0.014) loss 2.6242 (2.4523) ce_loss 1.1709 (1.0335) loss_zs_kd 0.4535 (0.4787) loss_oracle 0.4001 (0.3440) acc 56.2500 (65.0469) kd_loss 1.0265 (1.0074) lr 7.5131e-04 eta 0:18:14
epoch [31/50] batch [220/403] time 0.106 (0.137) data 0.000 (0.013) loss 2.4544 (2.4479) ce_loss 0.9829 (1.0294) loss_zs_kd 0.4738 (0.4783) loss_oracle 0.3331 (0.3446) acc 62.5000 (65.1136) kd_loss 1.0680 (1.0071) lr 7.5131e-04 eta 0:17:57
epoch [31/50] batch [240/403] time 0.144 (0.136) data 0.000 (0.012) loss 2.2105 (2.4471) ce_loss 0.7188 (1.0288) loss_zs_kd 0.5516 (0.4775) loss_oracle 0.3492 (0.3464) acc 75.0000 (65.1042) kd_loss 1.0413 (1.0063) lr 7.5131e-04 eta 0:17:42
epoch [31/50] batch [260/403] time 0.145 (0.136) data 0.000 (0.011) loss 2.2044 (2.4467) ce_loss 0.7837 (1.0286) loss_zs_kd 0.5574 (0.4767) loss_oracle 0.3642 (0.3468) acc 87.5000 (65.1322) kd_loss 0.9599 (1.0063) lr 7.5131e-04 eta 0:17:37
epoch [31/50] batch [280/403] time 0.153 (0.135) data 0.000 (0.010) loss 2.3827 (2.4468) ce_loss 1.0557 (1.0299) loss_zs_kd 0.4371 (0.4772) loss_oracle 0.3428 (0.3464) acc 56.2500 (65.1451) kd_loss 0.9370 (1.0052) lr 7.5131e-04 eta 0:17:32
epoch [31/50] batch [300/403] time 0.136 (0.135) data 0.000 (0.010) loss 2.4904 (2.4489) ce_loss 1.1094 (1.0309) loss_zs_kd 0.5560 (0.4774) loss_oracle 0.3701 (0.3475) acc 65.6250 (65.0417) kd_loss 0.9180 (1.0055) lr 7.5131e-04 eta 0:17:28
epoch [31/50] batch [320/403] time 0.100 (0.134) data 0.000 (0.009) loss 2.5275 (2.4471) ce_loss 0.9980 (1.0287) loss_zs_kd 0.5250 (0.4752) loss_oracle 0.3373 (0.3476) acc 65.6250 (65.2051) kd_loss 1.0983 (1.0071) lr 7.5131e-04 eta 0:17:16
epoch [31/50] batch [340/403] time 0.153 (0.134) data 0.000 (0.008) loss 2.2376 (2.4441) ce_loss 0.8486 (1.0267) loss_zs_kd 0.5325 (0.4754) loss_oracle 0.2472 (0.3456) acc 71.8750 (65.2022) kd_loss 0.9991 (1.0069) lr 7.5131e-04 eta 0:17:13
epoch [31/50] batch [360/403] time 0.090 (0.134) data 0.000 (0.008) loss 2.6049 (2.4467) ce_loss 1.1201 (1.0285) loss_zs_kd 0.5392 (0.4767) loss_oracle 0.2921 (0.3442) acc 56.2500 (65.0608) kd_loss 1.0692 (1.0077) lr 7.5131e-04 eta 0:17:11
epoch [31/50] batch [380/403] time 0.151 (0.133) data 0.000 (0.008) loss 2.4492 (2.4474) ce_loss 1.0605 (1.0294) loss_zs_kd 0.4667 (0.4764) loss_oracle 0.3574 (0.3441) acc 59.3750 (65.1809) kd_loss 0.9766 (1.0076) lr 7.5131e-04 eta 0:17:01
epoch [31/50] batch [400/403] time 0.090 (0.132) data 0.000 (0.007) loss 2.7766 (2.4497) ce_loss 1.2988 (1.0305) loss_zs_kd 0.5275 (0.4773) loss_oracle 0.4009 (0.3445) acc 56.2500 (65.1719) kd_loss 1.0135 (1.0084) lr 7.5131e-04 eta 0:16:48
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,796
* accuracy: 68.6%
* error: 31.4%
* macro_f1: 53.5%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,524
* accuracy: 42.9%
* error: 57.1%
* macro_f1: 32.5%
******* Domain 4 best val acc:      68.6%, epoch: 27 *******
******* Domain 4 best val test acc: 43.2%, epoch: 27 *******
******* Domain 4 best test acc:     43.2%, epoch: 27 *******
epoch [32/50] batch [20/403] time 0.101 (0.315) data 0.000 (0.191) loss 2.3686 (2.4528) ce_loss 0.9204 (1.0168) loss_zs_kd 0.4475 (0.4812) loss_oracle 0.3924 (0.3467) acc 68.7500 (66.2500) kd_loss 1.0283 (1.0220) lr 6.9098e-04 eta 0:40:04
epoch [32/50] batch [40/403] time 0.151 (0.234) data 0.000 (0.095) loss 2.4068 (2.4450) ce_loss 0.9092 (1.0184) loss_zs_kd 0.5641 (0.4673) loss_oracle 0.3555 (0.3488) acc 75.0000 (66.0156) kd_loss 1.0378 (1.0185) lr 6.9098e-04 eta 0:29:39
epoch [32/50] batch [60/403] time 0.163 (0.200) data 0.000 (0.064) loss 2.3791 (2.4644) ce_loss 0.9429 (1.0343) loss_zs_kd 0.5254 (0.4792) loss_oracle 0.3805 (0.3531) acc 78.1250 (65.1042) kd_loss 0.9833 (1.0140) lr 6.9098e-04 eta 0:25:17
epoch [32/50] batch [80/403] time 0.156 (0.188) data 0.000 (0.048) loss 2.3797 (2.4587) ce_loss 1.0498 (1.0321) loss_zs_kd 0.3960 (0.4749) loss_oracle 0.3013 (0.3512) acc 65.6250 (65.3516) kd_loss 0.9813 (1.0136) lr 6.9098e-04 eta 0:23:45
epoch [32/50] batch [100/403] time 0.142 (0.174) data 0.000 (0.038) loss 2.1480 (2.4624) ce_loss 0.8027 (1.0347) loss_zs_kd 0.3907 (0.4768) loss_oracle 0.3115 (0.3526) acc 81.2500 (65.6250) kd_loss 0.9941 (1.0130) lr 6.9098e-04 eta 0:21:52
epoch [32/50] batch [120/403] time 0.095 (0.164) data 0.000 (0.032) loss 2.6199 (2.4607) ce_loss 1.2109 (1.0367) loss_zs_kd 0.5291 (0.4752) loss_oracle 0.3214 (0.3514) acc 65.6250 (65.2865) kd_loss 0.9838 (1.0107) lr 6.9098e-04 eta 0:20:38
epoch [32/50] batch [140/403] time 0.095 (0.157) data 0.000 (0.027) loss 2.3850 (2.4551) ce_loss 0.9971 (1.0306) loss_zs_kd 0.4197 (0.4788) loss_oracle 0.3558 (0.3533) acc 65.6250 (65.4018) kd_loss 1.0001 (1.0085) lr 6.9098e-04 eta 0:19:39
epoch [32/50] batch [160/403] time 0.142 (0.152) data 0.000 (0.024) loss 2.5974 (2.4539) ce_loss 1.1006 (1.0320) loss_zs_kd 0.5087 (0.4764) loss_oracle 0.4277 (0.3528) acc 53.1250 (65.1758) kd_loss 1.0286 (1.0074) lr 6.9098e-04 eta 0:18:57
epoch [32/50] batch [180/403] time 0.111 (0.148) data 0.000 (0.021) loss 2.2501 (2.4544) ce_loss 0.9302 (1.0376) loss_zs_kd 0.3606 (0.4722) loss_oracle 0.3137 (0.3508) acc 71.8750 (65.0000) kd_loss 0.9828 (1.0053) lr 6.9098e-04 eta 0:18:29
epoch [32/50] batch [200/403] time 0.129 (0.145) data 0.000 (0.019) loss 2.2732 (2.4558) ce_loss 0.9707 (1.0401) loss_zs_kd 0.4863 (0.4738) loss_oracle 0.3266 (0.3492) acc 65.6250 (64.9219) kd_loss 0.8960 (1.0041) lr 6.9098e-04 eta 0:18:01
epoch [32/50] batch [220/403] time 0.142 (0.142) data 0.000 (0.018) loss 2.3524 (2.4503) ce_loss 0.9546 (1.0342) loss_zs_kd 0.4905 (0.4766) loss_oracle 0.3893 (0.3493) acc 71.8750 (65.2557) kd_loss 0.9579 (1.0032) lr 6.9098e-04 eta 0:17:37
epoch [32/50] batch [240/403] time 0.107 (0.140) data 0.000 (0.016) loss 2.3857 (2.4531) ce_loss 1.0088 (1.0373) loss_zs_kd 0.3990 (0.4760) loss_oracle 0.3657 (0.3497) acc 62.5000 (65.0521) kd_loss 0.9946 (1.0030) lr 6.9098e-04 eta 0:17:17
epoch [32/50] batch [260/403] time 0.144 (0.138) data 0.000 (0.015) loss 2.5062 (2.4525) ce_loss 1.0889 (1.0387) loss_zs_kd 0.5270 (0.4775) loss_oracle 0.3695 (0.3478) acc 68.7500 (64.9519) kd_loss 0.9690 (1.0012) lr 6.9098e-04 eta 0:17:00
epoch [32/50] batch [280/403] time 0.129 (0.137) data 0.000 (0.014) loss 2.6270 (2.4483) ce_loss 1.1855 (1.0358) loss_zs_kd 0.4738 (0.4776) loss_oracle 0.3961 (0.3479) acc 56.2500 (65.2232) kd_loss 1.0065 (0.9998) lr 6.9098e-04 eta 0:16:47
epoch [32/50] batch [300/403] time 0.157 (0.136) data 0.000 (0.013) loss 2.6264 (2.4419) ce_loss 1.2529 (1.0315) loss_zs_kd 0.4281 (0.4776) loss_oracle 0.3436 (0.3476) acc 59.3750 (65.4688) kd_loss 0.9876 (0.9978) lr 6.9098e-04 eta 0:16:39
epoch [32/50] batch [320/403] time 0.079 (0.134) data 0.000 (0.012) loss 2.5368 (2.4411) ce_loss 1.2139 (1.0306) loss_zs_kd 0.3750 (0.4766) loss_oracle 0.3389 (0.3473) acc 59.3750 (65.4590) kd_loss 0.9659 (0.9985) lr 6.9098e-04 eta 0:16:22
epoch [32/50] batch [340/403] time 0.162 (0.131) data 0.000 (0.011) loss 2.3097 (2.4394) ce_loss 1.0234 (1.0299) loss_zs_kd 0.3836 (0.4760) loss_oracle 0.3154 (0.3467) acc 62.5000 (65.4779) kd_loss 0.9368 (0.9981) lr 6.9098e-04 eta 0:15:59
epoch [32/50] batch [360/403] time 0.069 (0.134) data 0.000 (0.011) loss 2.5194 (2.4379) ce_loss 1.0645 (1.0300) loss_zs_kd 0.5001 (0.4765) loss_oracle 0.3738 (0.3453) acc 59.3750 (65.4253) kd_loss 1.0181 (0.9970) lr 6.9098e-04 eta 0:16:16
epoch [32/50] batch [380/403] time 0.076 (0.131) data 0.000 (0.010) loss 2.2899 (2.4384) ce_loss 0.9697 (1.0315) loss_zs_kd 0.3917 (0.4766) loss_oracle 0.3254 (0.3451) acc 71.8750 (65.3536) kd_loss 0.9617 (0.9961) lr 6.9098e-04 eta 0:15:54
epoch [32/50] batch [400/403] time 0.073 (0.132) data 0.000 (0.010) loss 2.6971 (2.4381) ce_loss 1.2051 (1.0299) loss_zs_kd 0.5018 (0.4764) loss_oracle 0.4397 (0.3463) acc 59.3750 (65.3906) kd_loss 1.0213 (0.9969) lr 6.9098e-04 eta 0:15:57
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,750
* accuracy: 67.8%
* error: 32.2%
* macro_f1: 53.3%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,243
* accuracy: 38.1%
* error: 61.9%
* macro_f1: 29.5%
******* Domain 4 best val acc:      68.6%, epoch: 27 *******
******* Domain 4 best val test acc: 43.2%, epoch: 27 *******
******* Domain 4 best test acc:     43.2%, epoch: 27 *******
epoch [33/50] batch [20/403] time 0.160 (0.338) data 0.000 (0.187) loss 2.4201 (2.4340) ce_loss 1.0527 (1.0462) loss_zs_kd 0.4388 (0.4577) loss_oracle 0.3630 (0.3532) acc 68.7500 (66.5625) kd_loss 0.9664 (0.9824) lr 6.3188e-04 eta 0:40:44
epoch [33/50] batch [40/403] time 0.159 (0.245) data 0.000 (0.094) loss 2.5283 (2.4354) ce_loss 1.0361 (1.0315) loss_zs_kd 0.5273 (0.4709) loss_oracle 0.3795 (0.3589) acc 65.6250 (65.8594) kd_loss 1.0388 (0.9890) lr 6.3188e-04 eta 0:29:27
epoch [33/50] batch [60/403] time 0.073 (0.207) data 0.000 (0.063) loss 2.2478 (2.4305) ce_loss 0.8818 (1.0285) loss_zs_kd 0.3545 (0.4718) loss_oracle 0.3354 (0.3513) acc 62.5000 (65.3125) kd_loss 1.0211 (0.9904) lr 6.3188e-04 eta 0:24:47
epoch [33/50] batch [80/403] time 0.087 (0.176) data 0.000 (0.047) loss 2.6593 (2.4452) ce_loss 1.0908 (1.0430) loss_zs_kd 0.5531 (0.4756) loss_oracle 0.4254 (0.3534) acc 68.7500 (65.1172) kd_loss 1.0792 (0.9878) lr 6.3188e-04 eta 0:21:01
epoch [33/50] batch [100/403] time 0.222 (0.174) data 0.000 (0.038) loss 2.6787 (2.4373) ce_loss 1.3301 (1.0391) loss_zs_kd 0.5688 (0.4770) loss_oracle 0.2857 (0.3507) acc 56.2500 (65.1562) kd_loss 0.9214 (0.9844) lr 6.3188e-04 eta 0:20:46
epoch [33/50] batch [120/403] time 0.078 (0.163) data 0.000 (0.031) loss 2.4090 (2.4302) ce_loss 0.9692 (1.0369) loss_zs_kd 0.5299 (0.4713) loss_oracle 0.3974 (0.3529) acc 65.6250 (65.2865) kd_loss 0.9761 (0.9812) lr 6.3188e-04 eta 0:19:20
epoch [33/50] batch [140/403] time 0.202 (0.160) data 0.000 (0.027) loss 1.9796 (2.4209) ce_loss 0.6001 (1.0219) loss_zs_kd 0.4369 (0.4777) loss_oracle 0.3893 (0.3568) acc 81.2500 (66.1384) kd_loss 0.9664 (0.9817) lr 6.3188e-04 eta 0:18:57
epoch [33/50] batch [160/403] time 0.097 (0.152) data 0.000 (0.024) loss 2.4030 (2.4268) ce_loss 1.0312 (1.0329) loss_zs_kd 0.4421 (0.4722) loss_oracle 0.3474 (0.3564) acc 59.3750 (65.6445) kd_loss 0.9770 (0.9796) lr 6.3188e-04 eta 0:17:56
epoch [33/50] batch [180/403] time 0.078 (0.145) data 0.000 (0.021) loss 2.5489 (2.4321) ce_loss 1.1338 (1.0347) loss_zs_kd 0.5153 (0.4733) loss_oracle 0.3608 (0.3577) acc 68.7500 (65.5729) kd_loss 0.9771 (0.9819) lr 6.3188e-04 eta 0:17:06
epoch [33/50] batch [200/403] time 0.102 (0.140) data 0.000 (0.019) loss 2.3648 (2.4303) ce_loss 0.9917 (1.0319) loss_zs_kd 0.4871 (0.4731) loss_oracle 0.4042 (0.3567) acc 75.0000 (65.7344) kd_loss 0.9275 (0.9835) lr 6.3188e-04 eta 0:16:29
epoch [33/50] batch [220/403] time 0.097 (0.137) data 0.000 (0.017) loss 2.2998 (2.4314) ce_loss 0.9819 (1.0338) loss_zs_kd 0.4412 (0.4712) loss_oracle 0.3226 (0.3572) acc 65.6250 (65.6676) kd_loss 0.9360 (0.9834) lr 6.3188e-04 eta 0:16:01
epoch [33/50] batch [240/403] time 0.087 (0.134) data 0.000 (0.016) loss 2.5234 (2.4324) ce_loss 1.0176 (1.0335) loss_zs_kd 0.4843 (0.4725) loss_oracle 0.3873 (0.3578) acc 65.6250 (65.7422) kd_loss 1.0701 (0.9838) lr 6.3188e-04 eta 0:15:40
epoch [33/50] batch [260/403] time 0.157 (0.135) data 0.000 (0.015) loss 2.3232 (2.4328) ce_loss 0.9458 (1.0337) loss_zs_kd 0.3996 (0.4743) loss_oracle 0.3170 (0.3567) acc 62.5000 (65.7091) kd_loss 1.0191 (0.9835) lr 6.3188e-04 eta 0:15:44
