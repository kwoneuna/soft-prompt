Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_100', 'location_43', 'location_46']
Target     ['location_38']
# classes  10
# train_x  10,216
# val      4,378
# test     9,736
---------  ----------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/319] time 0.105 (0.162) data 0.000 (0.034) loss 1.2536 (2.0189) ce_loss 1.2529 (2.0156) loss_zs_kd 0.0002 (0.0001) loss_oracle -0.0002 (-0.0001) acc 59.3750 (37.0312) kd_loss 0.0007 (0.0033) lr 1.0000e-05 eta 0:42:55
epoch [1/50] batch [40/319] time 0.123 (0.137) data 0.000 (0.017) loss 1.5778 (1.9149) ce_loss 1.5752 (1.9122) loss_zs_kd 0.0015 (0.0003) loss_oracle -0.0002 (-0.0001) acc 56.2500 (39.8438) kd_loss 0.0020 (0.0026) lr 1.0000e-05 eta 0:36:14
epoch [1/50] batch [60/319] time 0.092 (0.127) data 0.000 (0.011) loss 2.1740 (1.9429) ce_loss 2.1719 (1.9405) loss_zs_kd 0.0025 (0.0007) loss_oracle -0.0001 (-0.0001) acc 31.2500 (39.2708) kd_loss 0.0009 (0.0022) lr 1.0000e-05 eta 0:33:32
epoch [1/50] batch [80/319] time 0.084 (0.115) data 0.000 (0.009) loss 1.9707 (1.9246) ce_loss 1.9678 (1.9221) loss_zs_kd 0.0034 (0.0013) loss_oracle -0.0000 (-0.0001) acc 43.7500 (38.8281) kd_loss 0.0013 (0.0019) lr 1.0000e-05 eta 0:30:31
epoch [1/50] batch [100/319] time 0.094 (0.119) data 0.000 (0.007) loss 2.1783 (1.8866) ce_loss 2.1738 (1.8837) loss_zs_kd 0.0064 (0.0021) loss_oracle -0.0001 (-0.0001) acc 25.0000 (39.4375) kd_loss 0.0013 (0.0018) lr 1.0000e-05 eta 0:31:27
epoch [1/50] batch [120/319] time 0.136 (0.113) data 0.000 (0.006) loss 1.8800 (1.8854) ce_loss 1.8750 (1.8822) loss_zs_kd 0.0052 (0.0029) loss_oracle -0.0001 (-0.0001) acc 40.6250 (39.5312) kd_loss 0.0024 (0.0018) lr 1.0000e-05 eta 0:29:48
epoch [1/50] batch [140/319] time 0.085 (0.113) data 0.000 (0.005) loss 2.0682 (1.8864) ce_loss 2.0605 (1.8826) loss_zs_kd 0.0082 (0.0037) loss_oracle -0.0001 (-0.0001) acc 37.5000 (39.4643) kd_loss 0.0036 (0.0019) lr 1.0000e-05 eta 0:29:48
epoch [1/50] batch [160/319] time 0.105 (0.111) data 0.000 (0.004) loss 1.8456 (1.8837) ce_loss 1.8379 (1.8793) loss_zs_kd 0.0108 (0.0047) loss_oracle -0.0001 (-0.0001) acc 34.3750 (39.5898) kd_loss 0.0023 (0.0021) lr 1.0000e-05 eta 0:29:11
epoch [1/50] batch [180/319] time 0.102 (0.110) data 0.000 (0.004) loss 2.2017 (1.8814) ce_loss 2.1895 (1.8765) loss_zs_kd 0.0176 (0.0058) loss_oracle -0.0001 (-0.0001) acc 28.1250 (39.4965) kd_loss 0.0035 (0.0021) lr 1.0000e-05 eta 0:28:55
epoch [1/50] batch [200/319] time 0.081 (0.109) data 0.000 (0.004) loss 2.0102 (1.8783) ce_loss 1.9961 (1.8726) loss_zs_kd 0.0183 (0.0069) loss_oracle -0.0001 (-0.0001) acc 31.2500 (39.5000) kd_loss 0.0050 (0.0023) lr 1.0000e-05 eta 0:28:39
epoch [1/50] batch [220/319] time 0.101 (0.108) data 0.000 (0.003) loss 1.7614 (1.8858) ce_loss 1.7441 (1.8792) loss_zs_kd 0.0222 (0.0081) loss_oracle -0.0001 (-0.0001) acc 40.6250 (39.1193) kd_loss 0.0062 (0.0026) lr 1.0000e-05 eta 0:28:25
epoch [1/50] batch [240/319] time 0.103 (0.108) data 0.000 (0.003) loss 1.9671 (1.8940) ce_loss 1.9453 (1.8864) loss_zs_kd 0.0293 (0.0093) loss_oracle -0.0000 (-0.0001) acc 28.1250 (38.8021) kd_loss 0.0072 (0.0030) lr 1.0000e-05 eta 0:28:16
epoch [1/50] batch [260/319] time 0.105 (0.107) data 0.000 (0.003) loss 1.9895 (1.8932) ce_loss 1.9717 (1.8847) loss_zs_kd 0.0248 (0.0105) loss_oracle -0.0000 (-0.0001) acc 37.5000 (38.6779) kd_loss 0.0054 (0.0034) lr 1.0000e-05 eta 0:28:03
epoch [1/50] batch [280/319] time 0.095 (0.107) data 0.000 (0.003) loss 2.0983 (1.8915) ce_loss 2.0703 (1.8819) loss_zs_kd 0.0327 (0.0117) loss_oracle 0.0000 (-0.0001) acc 34.3750 (38.6942) kd_loss 0.0117 (0.0038) lr 1.0000e-05 eta 0:27:50
epoch [1/50] batch [300/319] time 0.108 (0.106) data 0.000 (0.002) loss 2.3472 (1.8895) ce_loss 2.3242 (1.8787) loss_zs_kd 0.0311 (0.0129) loss_oracle 0.0000 (-0.0000) acc 28.1250 (38.6250) kd_loss 0.0074 (0.0044) lr 1.0000e-05 eta 0:27:42
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 1,748
* accuracy: 39.9%
* error: 60.1%
* macro_f1: 24.3%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 2,808
* accuracy: 28.8%
* error: 71.2%
* macro_f1: 11.2%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      39.9%, epoch: 1 *******
******* Domain 2 best val test acc: 28.8%, epoch: 1 *******
******* Domain 2 best test acc:     28.8%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/ana
epoch [2/50] batch [20/319] time 0.105 (0.134) data 0.000 (0.032) loss 1.9114 (1.7506) ce_loss 1.7363 (1.6528) loss_zs_kd 0.1540 (0.1322) loss_oracle 0.0462 (0.0152) acc 43.7500 (40.3125) kd_loss 0.0750 (0.0241) lr 2.0000e-03 eta 0:34:50
epoch [2/50] batch [40/319] time 0.076 (0.113) data 0.000 (0.016) loss 2.6637 (1.8608) ce_loss 2.0840 (1.6235) loss_zs_kd 0.1645 (0.1461) loss_oracle 0.2016 (0.0750) acc 28.1250 (42.1094) kd_loss 0.3967 (0.1267) lr 2.0000e-03 eta 0:29:17
epoch [2/50] batch [60/319] time 0.173 (0.105) data 0.001 (0.011) loss 2.5237 (2.0191) ce_loss 1.5225 (1.5887) loss_zs_kd 0.1267 (0.1487) loss_oracle 0.3456 (0.1189) acc 34.3750 (42.5521) kd_loss 0.7652 (0.2966) lr 2.0000e-03 eta 0:27:09
epoch [2/50] batch [80/319] time 0.084 (0.110) data 0.000 (0.008) loss 2.4510 (2.1094) ce_loss 1.4785 (1.5548) loss_zs_kd 0.1889 (0.1532) loss_oracle 0.3205 (0.1706) acc 37.5000 (43.3984) kd_loss 0.7178 (0.3927) lr 2.0000e-03 eta 0:28:22
epoch [2/50] batch [100/319] time 0.124 (0.111) data 0.000 (0.007) loss 2.2940 (2.1582) ce_loss 1.5762 (1.5390) loss_zs_kd 0.1755 (0.1668) loss_oracle 0.2162 (0.2062) acc 40.6250 (43.4375) kd_loss 0.5220 (0.4327) lr 2.0000e-03 eta 0:28:47
epoch [2/50] batch [120/319] time 0.097 (0.107) data 0.000 (0.006) loss 2.0620 (2.1770) ce_loss 1.1484 (1.5193) loss_zs_kd 0.2223 (0.1778) loss_oracle 0.3973 (0.2316) acc 62.5000 (43.7760) kd_loss 0.6037 (0.4530) lr 2.0000e-03 eta 0:27:32
epoch [2/50] batch [140/319] time 0.103 (0.106) data 0.000 (0.005) loss 2.5515 (2.1878) ce_loss 1.7119 (1.5052) loss_zs_kd 0.2693 (0.1858) loss_oracle 0.1447 (0.2337) acc 37.5000 (44.1518) kd_loss 0.6326 (0.4729) lr 2.0000e-03 eta 0:27:18
epoch [2/50] batch [160/319] time 0.099 (0.105) data 0.000 (0.004) loss 2.2253 (2.1902) ce_loss 1.3027 (1.4883) loss_zs_kd 0.2144 (0.1887) loss_oracle 0.2470 (0.2321) acc 59.3750 (44.8438) kd_loss 0.6919 (0.4916) lr 2.0000e-03 eta 0:26:57
epoch [2/50] batch [180/319] time 0.098 (0.104) data 0.000 (0.004) loss 2.2834 (2.1945) ce_loss 1.5020 (1.4825) loss_zs_kd 0.2503 (0.1896) loss_oracle 0.2420 (0.2280) acc 37.5000 (45.0000) kd_loss 0.5353 (0.5032) lr 2.0000e-03 eta 0:26:44
epoch [2/50] batch [200/319] time 0.103 (0.103) data 0.000 (0.003) loss 2.1948 (2.1984) ce_loss 1.3652 (1.4757) loss_zs_kd 0.2188 (0.1940) loss_oracle 0.1936 (0.2272) acc 43.7500 (45.0000) kd_loss 0.6234 (0.5121) lr 2.0000e-03 eta 0:26:29
epoch [2/50] batch [220/319] time 0.100 (0.103) data 0.000 (0.003) loss 2.5893 (2.2026) ce_loss 1.7344 (1.4701) loss_zs_kd 0.2106 (0.1985) loss_oracle 0.2172 (0.2262) acc 25.0000 (44.7443) kd_loss 0.6410 (0.5202) lr 2.0000e-03 eta 0:26:22
epoch [2/50] batch [240/319] time 0.103 (0.102) data 0.000 (0.003) loss 2.0834 (2.2051) ce_loss 1.1348 (1.4586) loss_zs_kd 0.2615 (0.2026) loss_oracle 0.2290 (0.2282) acc 50.0000 (45.1172) kd_loss 0.7034 (0.5311) lr 2.0000e-03 eta 0:26:17
epoch [2/50] batch [260/319] time 0.101 (0.102) data 0.000 (0.003) loss 2.2717 (2.2071) ce_loss 1.2646 (1.4408) loss_zs_kd 0.2261 (0.2065) loss_oracle 0.1815 (0.2298) acc 50.0000 (45.5889) kd_loss 0.8032 (0.5481) lr 2.0000e-03 eta 0:26:11
epoch [2/50] batch [280/319] time 0.099 (0.102) data 0.000 (0.003) loss 2.2151 (2.2161) ce_loss 1.3105 (1.4375) loss_zs_kd 0.2130 (0.2077) loss_oracle 0.1497 (0.2254) acc 43.7500 (45.5580) kd_loss 0.7232 (0.5621) lr 2.0000e-03 eta 0:26:05
epoch [2/50] batch [300/319] time 0.087 (0.101) data 0.000 (0.002) loss 2.3775 (2.2304) ce_loss 1.2949 (1.4361) loss_zs_kd 0.2577 (0.2112) loss_oracle 0.2638 (0.2239) acc 46.8750 (45.5625) kd_loss 0.8218 (0.5768) lr 2.0000e-03 eta 0:25:53
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,150
* accuracy: 49.1%
* error: 50.9%
* macro_f1: 36.6%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,750
* accuracy: 38.5%
* error: 61.5%
* macro_f1: 18.5%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      49.1%, epoch: 2 *******
******* Domain 2 best val test acc: 38.5%, epoch: 2 *******
******* Domain 2 best test acc:     38.5%, epoch: 2 *******
epoch [3/50] batch [20/319] time 0.087 (0.120) data 0.000 (0.040) loss 2.0753 (2.2997) ce_loss 1.0479 (1.2547) loss_zs_kd 0.1986 (0.2743) loss_oracle 0.2208 (0.1950) acc 56.2500 (50.6250) kd_loss 0.8178 (0.8103) lr 1.9980e-03 eta 0:30:30
epoch [3/50] batch [40/319] time 0.081 (0.123) data 0.000 (0.020) loss 2.5054 (2.3781) ce_loss 1.2988 (1.3004) loss_zs_kd 0.2505 (0.2634) loss_oracle 0.2406 (0.2162) acc 56.2500 (48.9844) kd_loss 0.9611 (0.8379) lr 1.9980e-03 eta 0:31:20
epoch [3/50] batch [60/319] time 0.188 (0.111) data 0.001 (0.013) loss 2.2640 (2.4068) ce_loss 0.9922 (1.2994) loss_zs_kd 0.2398 (0.2638) loss_oracle 0.3426 (0.2376) acc 68.7500 (49.7396) kd_loss 0.9806 (0.8567) lr 1.9980e-03 eta 0:28:07
epoch [3/50] batch [80/319] time 0.085 (0.111) data 0.000 (0.010) loss 2.4374 (2.4389) ce_loss 1.2295 (1.3119) loss_zs_kd 0.2210 (0.2624) loss_oracle 0.2622 (0.2599) acc 50.0000 (48.8672) kd_loss 0.9663 (0.8659) lr 1.9980e-03 eta 0:28:05
epoch [3/50] batch [100/319] time 0.111 (0.107) data 0.000 (0.008) loss 2.4125 (2.4418) ce_loss 1.2637 (1.3140) loss_zs_kd 0.3279 (0.2622) loss_oracle 0.2225 (0.2577) acc 53.1250 (49.2500) kd_loss 0.8736 (0.8679) lr 1.9980e-03 eta 0:27:14
epoch [3/50] batch [120/319] time 0.096 (0.107) data 0.000 (0.007) loss 2.4742 (2.4355) ce_loss 1.4141 (1.3129) loss_zs_kd 0.2379 (0.2623) loss_oracle 0.1742 (0.2472) acc 40.6250 (49.3229) kd_loss 0.8541 (0.8679) lr 1.9980e-03 eta 0:27:00
epoch [3/50] batch [140/319] time 0.099 (0.106) data 0.000 (0.006) loss 2.1543 (2.4247) ce_loss 1.0938 (1.3112) loss_zs_kd 0.2500 (0.2597) loss_oracle 0.2094 (0.2433) acc 59.3750 (49.4196) kd_loss 0.8308 (0.8619) lr 1.9980e-03 eta 0:26:46
epoch [3/50] batch [160/319] time 0.095 (0.105) data 0.000 (0.005) loss 2.3000 (2.4194) ce_loss 1.1807 (1.3077) loss_zs_kd 0.3051 (0.2671) loss_oracle 0.2241 (0.2419) acc 59.3750 (49.5703) kd_loss 0.8547 (0.8571) lr 1.9980e-03 eta 0:26:31
epoch [3/50] batch [180/319] time 0.103 (0.105) data 0.000 (0.005) loss 2.4919 (2.4236) ce_loss 1.3760 (1.3117) loss_zs_kd 0.2510 (0.2697) loss_oracle 0.1964 (0.2433) acc 50.0000 (49.4444) kd_loss 0.8922 (0.8555) lr 1.9980e-03 eta 0:26:21
epoch [3/50] batch [200/319] time 0.100 (0.104) data 0.000 (0.004) loss 2.4591 (2.4195) ce_loss 1.3535 (1.3111) loss_zs_kd 0.3094 (0.2689) loss_oracle 0.2346 (0.2460) acc 50.0000 (49.6250) kd_loss 0.8336 (0.8509) lr 1.9980e-03 eta 0:26:10
epoch [3/50] batch [220/319] time 0.098 (0.103) data 0.000 (0.004) loss 2.3523 (2.4181) ce_loss 1.3115 (1.3133) loss_zs_kd 0.2478 (0.2697) loss_oracle 0.2200 (0.2488) acc 37.5000 (49.6023) kd_loss 0.8068 (0.8455) lr 1.9980e-03 eta 0:26:01
epoch [3/50] batch [240/319] time 0.112 (0.103) data 0.000 (0.004) loss 2.7064 (2.4133) ce_loss 1.6592 (1.3107) loss_zs_kd 0.3332 (0.2708) loss_oracle 0.3278 (0.2510) acc 37.5000 (49.8698) kd_loss 0.7167 (0.8417) lr 1.9980e-03 eta 0:25:57
epoch [3/50] batch [260/319] time 0.086 (0.103) data 0.000 (0.003) loss 2.4629 (2.4146) ce_loss 1.3711 (1.3142) loss_zs_kd 0.2487 (0.2709) loss_oracle 0.2989 (0.2561) acc 46.8750 (49.8077) kd_loss 0.8180 (0.8368) lr 1.9980e-03 eta 0:25:48
epoch [3/50] batch [280/319] time 0.081 (0.101) data 0.000 (0.003) loss 2.3569 (2.4105) ce_loss 1.3018 (1.3106) loss_zs_kd 0.1877 (0.2723) loss_oracle 0.2961 (0.2585) acc 53.1250 (49.9219) kd_loss 0.8132 (0.8345) lr 1.9980e-03 eta 0:25:23
epoch [3/50] batch [300/319] time 0.140 (0.104) data 0.000 (0.003) loss 2.1336 (2.4097) ce_loss 1.0811 (1.3109) loss_zs_kd 0.1940 (0.2733) loss_oracle 0.3099 (0.2606) acc 56.2500 (50.0104) kd_loss 0.8006 (0.8318) lr 1.9980e-03 eta 0:25:55
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,221
* accuracy: 50.7%
* error: 49.3%
* macro_f1: 38.2%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,254
* accuracy: 43.7%
* error: 56.3%
* macro_f1: 18.2%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      50.7%, epoch: 3 *******
******* Domain 2 best val test acc: 43.7%, epoch: 3 *******
******* Domain 2 best test acc:     43.7%, epoch: 3 *******
epoch [4/50] batch [20/319] time 0.081 (0.123) data 0.000 (0.039) loss 2.3756 (2.3441) ce_loss 1.3418 (1.3069) loss_zs_kd 0.2777 (0.2574) loss_oracle 0.2705 (0.2858) acc 56.2500 (48.7500) kd_loss 0.7597 (0.7656) lr 1.9921e-03 eta 0:30:44
epoch [4/50] batch [40/319] time 0.084 (0.121) data 0.000 (0.019) loss 2.1660 (2.3118) ce_loss 1.1885 (1.2876) loss_zs_kd 0.2603 (0.2605) loss_oracle 0.2159 (0.2681) acc 53.1250 (49.0625) kd_loss 0.7394 (0.7599) lr 1.9921e-03 eta 0:30:02
epoch [4/50] batch [60/319] time 0.098 (0.112) data 0.001 (0.013) loss 2.5334 (2.3053) ce_loss 1.4932 (1.2779) loss_zs_kd 0.3013 (0.2638) loss_oracle 0.3101 (0.2740) acc 46.8750 (50.4167) kd_loss 0.7345 (0.7585) lr 1.9921e-03 eta 0:27:47
epoch [4/50] batch [80/319] time 0.105 (0.109) data 0.000 (0.010) loss 2.3207 (2.3114) ce_loss 1.3086 (1.2849) loss_zs_kd 0.2900 (0.2749) loss_oracle 0.2326 (0.2747) acc 59.3750 (50.6250) kd_loss 0.7508 (0.7516) lr 1.9921e-03 eta 0:27:09
epoch [4/50] batch [100/319] time 0.113 (0.108) data 0.000 (0.008) loss 2.2835 (2.3120) ce_loss 1.2500 (1.2885) loss_zs_kd 0.2710 (0.2786) loss_oracle 0.3723 (0.2813) acc 53.1250 (50.2188) kd_loss 0.7118 (0.7435) lr 1.9921e-03 eta 0:26:47
epoch [4/50] batch [120/319] time 0.103 (0.107) data 0.000 (0.007) loss 2.3446 (2.3081) ce_loss 1.2764 (1.2878) loss_zs_kd 0.3010 (0.2813) loss_oracle 0.3424 (0.2834) acc 62.5000 (50.2083) kd_loss 0.7465 (0.7379) lr 1.9921e-03 eta 0:26:32
epoch [4/50] batch [140/319] time 0.098 (0.106) data 0.000 (0.006) loss 2.4787 (2.3075) ce_loss 1.5059 (1.2875) loss_zs_kd 0.2869 (0.2840) loss_oracle 0.2636 (0.2890) acc 50.0000 (50.6696) kd_loss 0.6976 (0.7335) lr 1.9921e-03 eta 0:26:18
epoch [4/50] batch [160/319] time 0.101 (0.105) data 0.000 (0.005) loss 2.8418 (2.3005) ce_loss 1.8096 (1.2881) loss_zs_kd 0.3152 (0.2806) loss_oracle 0.2965 (0.2904) acc 28.1250 (50.8008) kd_loss 0.7263 (0.7269) lr 1.9921e-03 eta 0:26:04
epoch [4/50] batch [180/319] time 0.112 (0.105) data 0.001 (0.005) loss 2.2348 (2.2978) ce_loss 1.3359 (1.2865) loss_zs_kd 0.2343 (0.2819) loss_oracle 0.3016 (0.2913) acc 50.0000 (50.7465) kd_loss 0.6309 (0.7246) lr 1.9921e-03 eta 0:25:56
epoch [4/50] batch [200/319] time 0.109 (0.104) data 0.000 (0.004) loss 2.1745 (2.2860) ce_loss 1.2100 (1.2818) loss_zs_kd 0.2835 (0.2806) loss_oracle 0.2425 (0.2897) acc 40.6250 (51.1094) kd_loss 0.7015 (0.7190) lr 1.9921e-03 eta 0:25:40
epoch [4/50] batch [220/319] time 0.101 (0.104) data 0.000 (0.004) loss 2.1870 (2.2756) ce_loss 1.2617 (1.2765) loss_zs_kd 0.3042 (0.2821) loss_oracle 0.2314 (0.2893) acc 46.8750 (51.1932) kd_loss 0.6575 (0.7133) lr 1.9921e-03 eta 0:25:32
epoch [4/50] batch [240/319] time 0.085 (0.102) data 0.000 (0.003) loss 2.1464 (2.2712) ce_loss 1.2549 (1.2776) loss_zs_kd 0.2714 (0.2817) loss_oracle 0.2638 (0.2872) acc 56.2500 (51.1979) kd_loss 0.6239 (0.7091) lr 1.9921e-03 eta 0:25:10
epoch [4/50] batch [260/319] time 0.138 (0.101) data 0.001 (0.003) loss 2.3245 (2.2688) ce_loss 1.3496 (1.2783) loss_zs_kd 0.3931 (0.2852) loss_oracle 0.2896 (0.2860) acc 37.5000 (51.3462) kd_loss 0.6336 (0.7049) lr 1.9921e-03 eta 0:24:51
epoch [4/50] batch [280/319] time 0.066 (0.103) data 0.000 (0.003) loss 2.1840 (2.2580) ce_loss 1.2246 (1.2727) loss_zs_kd 0.2779 (0.2843) loss_oracle 0.2210 (0.2853) acc 50.0000 (51.5848) kd_loss 0.7099 (0.7005) lr 1.9921e-03 eta 0:25:13
epoch [4/50] batch [300/319] time 0.128 (0.102) data 0.001 (0.003) loss 2.1929 (2.2515) ce_loss 1.1680 (1.2699) loss_zs_kd 0.3177 (0.2836) loss_oracle 0.3599 (0.2872) acc 59.3750 (51.7396) kd_loss 0.6861 (0.6963) lr 1.9921e-03 eta 0:24:54
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,483
* accuracy: 56.7%
* error: 43.3%
* macro_f1: 44.3%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,627
* accuracy: 47.5%
* error: 52.5%
* macro_f1: 19.3%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      56.7%, epoch: 4 *******
******* Domain 2 best val test acc: 47.5%, epoch: 4 *******
******* Domain 2 best test acc:     47.5%, epoch: 4 *******
epoch [5/50] batch [20/319] time 0.067 (0.150) data 0.000 (0.044) loss 2.2169 (2.2228) ce_loss 1.2344 (1.2566) loss_zs_kd 0.2470 (0.2757) loss_oracle 0.3448 (0.3768) acc 50.0000 (50.9375) kd_loss 0.6866 (0.6400) lr 1.9823e-03 eta 0:36:44
epoch [5/50] batch [40/319] time 0.086 (0.115) data 0.000 (0.022) loss 1.9825 (2.2274) ce_loss 1.0254 (1.2548) loss_zs_kd 0.3451 (0.2945) loss_oracle 0.3878 (0.3844) acc 62.5000 (51.6406) kd_loss 0.5906 (0.6332) lr 1.9823e-03 eta 0:28:00
epoch [5/50] batch [60/319] time 0.100 (0.109) data 0.000 (0.015) loss 2.1266 (2.2264) ce_loss 1.1553 (1.2560) loss_zs_kd 0.3443 (0.2965) loss_oracle 0.4362 (0.3799) acc 62.5000 (51.5625) kd_loss 0.5811 (0.6322) lr 1.9823e-03 eta 0:26:27
epoch [5/50] batch [80/319] time 0.086 (0.106) data 0.000 (0.011) loss 1.8979 (2.2102) ce_loss 1.0127 (1.2450) loss_zs_kd 0.2053 (0.2896) loss_oracle 0.2704 (0.3764) acc 68.7500 (51.7969) kd_loss 0.6473 (0.6322) lr 1.9823e-03 eta 0:25:40
epoch [5/50] batch [100/319] time 0.094 (0.104) data 0.000 (0.009) loss 2.4007 (2.1952) ce_loss 1.3877 (1.2378) loss_zs_kd 0.3074 (0.2890) loss_oracle 0.3301 (0.3646) acc 46.8750 (52.2812) kd_loss 0.6943 (0.6307) lr 1.9823e-03 eta 0:25:09
epoch [5/50] batch [120/319] time 0.095 (0.103) data 0.000 (0.008) loss 2.0385 (2.1974) ce_loss 1.1807 (1.2452) loss_zs_kd 0.2835 (0.2884) loss_oracle 0.3249 (0.3612) acc 50.0000 (51.6406) kd_loss 0.5536 (0.6273) lr 1.9823e-03 eta 0:24:54
epoch [5/50] batch [140/319] time 0.094 (0.102) data 0.000 (0.007) loss 2.3539 (2.1924) ce_loss 1.4248 (1.2394) loss_zs_kd 0.2391 (0.2932) loss_oracle 0.4282 (0.3595) acc 46.8750 (52.1429) kd_loss 0.5954 (0.6267) lr 1.9823e-03 eta 0:24:39
epoch [5/50] batch [160/319] time 0.095 (0.102) data 0.000 (0.006) loss 2.4262 (2.1911) ce_loss 1.3291 (1.2384) loss_zs_kd 0.2846 (0.2906) loss_oracle 0.4555 (0.3605) acc 50.0000 (52.2461) kd_loss 0.7270 (0.6272) lr 1.9823e-03 eta 0:24:33
epoch [5/50] batch [180/319] time 0.096 (0.102) data 0.000 (0.005) loss 1.9668 (2.1878) ce_loss 0.9312 (1.2318) loss_zs_kd 0.2906 (0.2904) loss_oracle 0.4552 (0.3689) acc 62.5000 (52.6389) kd_loss 0.6628 (0.6263) lr 1.9823e-03 eta 0:24:32
epoch [5/50] batch [200/319] time 0.101 (0.101) data 0.000 (0.005) loss 2.1034 (2.1850) ce_loss 1.2090 (1.2300) loss_zs_kd 0.3687 (0.2877) loss_oracle 0.3773 (0.3734) acc 59.3750 (52.9062) kd_loss 0.5214 (0.6245) lr 1.9823e-03 eta 0:24:25
epoch [5/50] batch [220/319] time 0.095 (0.101) data 0.000 (0.004) loss 1.9068 (2.1883) ce_loss 1.0400 (1.2301) loss_zs_kd 0.1857 (0.2873) loss_oracle 0.3864 (0.3773) acc 50.0000 (52.8267) kd_loss 0.5807 (0.6260) lr 1.9823e-03 eta 0:24:15
epoch [5/50] batch [240/319] time 0.069 (0.099) data 0.000 (0.004) loss 1.9798 (2.1962) ce_loss 1.0410 (1.2352) loss_zs_kd 0.2533 (0.2858) loss_oracle 0.3997 (0.3825) acc 62.5000 (52.5781) kd_loss 0.6123 (0.6269) lr 1.9823e-03 eta 0:23:45
epoch [5/50] batch [260/319] time 0.168 (0.101) data 0.000 (0.004) loss 2.4198 (2.1989) ce_loss 1.3848 (1.2356) loss_zs_kd 0.3548 (0.2869) loss_oracle 0.4075 (0.3832) acc 50.0000 (52.5721) kd_loss 0.6538 (0.6282) lr 1.9823e-03 eta 0:24:11
epoch [5/50] batch [280/319] time 0.084 (0.100) data 0.000 (0.003) loss 1.7009 (2.1962) ce_loss 0.8374 (1.2330) loss_zs_kd 0.1566 (0.2868) loss_oracle 0.3292 (0.3825) acc 62.5000 (52.7902) kd_loss 0.6206 (0.6286) lr 1.9823e-03 eta 0:23:58
epoch [5/50] batch [300/319] time 0.068 (0.101) data 0.000 (0.003) loss 2.2735 (2.1955) ce_loss 1.2705 (1.2323) loss_zs_kd 0.2809 (0.2882) loss_oracle 0.4339 (0.3818) acc 43.7500 (52.7917) kd_loss 0.6455 (0.6282) lr 1.9823e-03 eta 0:24:12
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,447
* accuracy: 55.9%
* error: 44.1%
* macro_f1: 44.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,487
* accuracy: 46.1%
* error: 53.9%
* macro_f1: 20.3%
******* Domain 2 best val acc:      56.7%, epoch: 4 *******
******* Domain 2 best val test acc: 47.5%, epoch: 4 *******
******* Domain 2 best test acc:     47.5%, epoch: 4 *******
epoch [6/50] batch [20/319] time 0.110 (0.134) data 0.000 (0.051) loss 2.4204 (2.1297) ce_loss 1.5420 (1.1759) loss_zs_kd 0.3082 (0.3004) loss_oracle 0.3751 (0.3627) acc 31.2500 (55.7812) kd_loss 0.5367 (0.6223) lr 1.9686e-03 eta 0:31:59
epoch [6/50] batch [40/319] time 0.105 (0.117) data 0.000 (0.026) loss 2.2811 (2.1144) ce_loss 1.2949 (1.1705) loss_zs_kd 0.2646 (0.3000) loss_oracle 0.3476 (0.3565) acc 46.8750 (56.1719) kd_loss 0.6801 (0.6156) lr 1.9686e-03 eta 0:27:55
epoch [6/50] batch [60/319] time 0.103 (0.112) data 0.001 (0.017) loss 2.4186 (2.1470) ce_loss 1.3516 (1.1919) loss_zs_kd 0.3022 (0.2904) loss_oracle 0.4490 (0.3790) acc 43.7500 (54.4271) kd_loss 0.6914 (0.6205) lr 1.9686e-03 eta 0:26:46
epoch [6/50] batch [80/319] time 0.093 (0.109) data 0.000 (0.013) loss 2.1177 (2.1542) ce_loss 1.2900 (1.1973) loss_zs_kd 0.2482 (0.2927) loss_oracle 0.3479 (0.3815) acc 56.2500 (54.0625) kd_loss 0.5295 (0.6198) lr 1.9686e-03 eta 0:26:03
epoch [6/50] batch [100/319] time 0.100 (0.108) data 0.000 (0.010) loss 1.9419 (2.1644) ce_loss 1.0889 (1.2131) loss_zs_kd 0.3068 (0.2875) loss_oracle 0.3804 (0.3702) acc 65.6250 (53.3438) kd_loss 0.5094 (0.6225) lr 1.9686e-03 eta 0:25:33
epoch [6/50] batch [120/319] time 0.095 (0.107) data 0.000 (0.009) loss 2.1723 (2.1622) ce_loss 1.2070 (1.2111) loss_zs_kd 0.3322 (0.2865) loss_oracle 0.3089 (0.3660) acc 59.3750 (53.9062) kd_loss 0.6447 (0.6248) lr 1.9686e-03 eta 0:25:19
epoch [6/50] batch [140/319] time 0.115 (0.106) data 0.000 (0.007) loss 2.2548 (2.1617) ce_loss 1.3604 (1.2078) loss_zs_kd 0.2943 (0.2869) loss_oracle 0.2777 (0.3600) acc 50.0000 (54.2411) kd_loss 0.6084 (0.6304) lr 1.9686e-03 eta 0:25:08
epoch [6/50] batch [160/319] time 0.113 (0.106) data 0.000 (0.007) loss 2.0140 (2.1645) ce_loss 1.1387 (1.2084) loss_zs_kd 0.2110 (0.2885) loss_oracle 0.2965 (0.3562) acc 56.2500 (54.3359) kd_loss 0.6216 (0.6338) lr 1.9686e-03 eta 0:25:02
epoch [6/50] batch [180/319] time 0.097 (0.105) data 0.000 (0.006) loss 2.3148 (2.1681) ce_loss 1.3818 (1.2130) loss_zs_kd 0.2979 (0.2891) loss_oracle 0.3868 (0.3513) acc 43.7500 (54.0799) kd_loss 0.5906 (0.6349) lr 1.9686e-03 eta 0:24:48
epoch [6/50] batch [200/319] time 0.077 (0.104) data 0.000 (0.005) loss 2.0815 (2.1633) ce_loss 1.1484 (1.2105) loss_zs_kd 0.2846 (0.2863) loss_oracle 0.4053 (0.3484) acc 53.1250 (54.3125) kd_loss 0.5881 (0.6354) lr 1.9686e-03 eta 0:24:26
epoch [6/50] batch [220/319] time 0.076 (0.102) data 0.000 (0.005) loss 2.0019 (2.1637) ce_loss 1.1670 (1.2097) loss_zs_kd 0.2484 (0.2890) loss_oracle 0.3014 (0.3474) acc 59.3750 (54.3892) kd_loss 0.5600 (0.6358) lr 1.9686e-03 eta 0:23:54
epoch [6/50] batch [240/319] time 0.165 (0.103) data 0.000 (0.004) loss 2.3586 (2.1643) ce_loss 1.3779 (1.2128) loss_zs_kd 0.3221 (0.2886) loss_oracle 0.3819 (0.3459) acc 46.8750 (54.1927) kd_loss 0.6286 (0.6343) lr 1.9686e-03 eta 0:24:19
epoch [6/50] batch [260/319] time 0.077 (0.102) data 0.000 (0.004) loss 2.0473 (2.1660) ce_loss 1.0098 (1.2141) loss_zs_kd 0.3722 (0.2901) loss_oracle 0.3668 (0.3472) acc 59.3750 (54.1587) kd_loss 0.6680 (0.6333) lr 1.9686e-03 eta 0:24:00
epoch [6/50] batch [280/319] time 0.153 (0.102) data 0.000 (0.004) loss 2.0604 (2.1665) ce_loss 1.1670 (1.2145) loss_zs_kd 0.2453 (0.2914) loss_oracle 0.3733 (0.3482) acc 53.1250 (54.0179) kd_loss 0.5841 (0.6323) lr 1.9686e-03 eta 0:24:01
epoch [6/50] batch [300/319] time 0.074 (0.101) data 0.000 (0.004) loss 2.1431 (2.1681) ce_loss 1.2568 (1.2162) loss_zs_kd 0.3146 (0.2903) loss_oracle 0.2801 (0.3472) acc 56.2500 (54.0625) kd_loss 0.5889 (0.6331) lr 1.9686e-03 eta 0:23:46
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,481
* accuracy: 56.7%
* error: 43.3%
* macro_f1: 46.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,379
* accuracy: 45.0%
* error: 55.0%
* macro_f1: 20.4%
******* Domain 2 best val acc:      56.7%, epoch: 4 *******
******* Domain 2 best val test acc: 47.5%, epoch: 4 *******
******* Domain 2 best test acc:     47.5%, epoch: 4 *******
epoch [7/50] batch [20/319] time 0.090 (0.163) data 0.000 (0.058) loss 1.7910 (2.0990) ce_loss 0.8594 (1.1738) loss_zs_kd 0.2945 (0.2777) loss_oracle 0.2264 (0.2641) acc 65.6250 (57.8125) kd_loss 0.6712 (0.6543) lr 1.9511e-03 eta 0:38:00
epoch [7/50] batch [40/319] time 0.096 (0.130) data 0.000 (0.029) loss 2.4188 (2.1547) ce_loss 1.5049 (1.2129) loss_zs_kd 0.3016 (0.2772) loss_oracle 0.3224 (0.2803) acc 62.5000 (55.6250) kd_loss 0.6019 (0.6630) lr 1.9511e-03 eta 0:30:21
epoch [7/50] batch [60/319] time 0.099 (0.122) data 0.000 (0.019) loss 2.1981 (2.1484) ce_loss 1.1611 (1.1951) loss_zs_kd 0.2940 (0.2763) loss_oracle 0.3900 (0.3018) acc 59.3750 (55.8854) kd_loss 0.6950 (0.6642) lr 1.9511e-03 eta 0:28:21
epoch [7/50] batch [80/319] time 0.096 (0.116) data 0.000 (0.015) loss 2.1114 (2.1684) ce_loss 1.1299 (1.2092) loss_zs_kd 0.2856 (0.2748) loss_oracle 0.3125 (0.3097) acc 62.5000 (55.6250) kd_loss 0.6825 (0.6669) lr 1.9511e-03 eta 0:26:54
epoch [7/50] batch [100/319] time 0.099 (0.112) data 0.000 (0.012) loss 2.2139 (2.1893) ce_loss 1.2090 (1.2213) loss_zs_kd 0.2952 (0.2791) loss_oracle 0.2569 (0.3106) acc 53.1250 (54.6875) kd_loss 0.7288 (0.6732) lr 1.9511e-03 eta 0:25:55
epoch [7/50] batch [120/319] time 0.090 (0.109) data 0.000 (0.010) loss 2.3734 (2.1897) ce_loss 1.4922 (1.2177) loss_zs_kd 0.2767 (0.2858) loss_oracle 0.2470 (0.3058) acc 46.8750 (54.3490) kd_loss 0.6193 (0.6762) lr 1.9511e-03 eta 0:25:22
epoch [7/50] batch [140/319] time 0.095 (0.108) data 0.000 (0.008) loss 2.1730 (2.1957) ce_loss 1.0938 (1.2148) loss_zs_kd 0.3036 (0.2871) loss_oracle 0.3611 (0.3089) acc 50.0000 (54.1071) kd_loss 0.7469 (0.6829) lr 1.9511e-03 eta 0:24:55
epoch [7/50] batch [160/319] time 0.082 (0.106) data 0.000 (0.007) loss 2.0814 (2.2014) ce_loss 1.0713 (1.2147) loss_zs_kd 0.2284 (0.2871) loss_oracle 0.3172 (0.3110) acc 62.5000 (54.0430) kd_loss 0.7373 (0.6876) lr 1.9511e-03 eta 0:24:35
epoch [7/50] batch [180/319] time 0.082 (0.104) data 0.000 (0.007) loss 2.3323 (2.2104) ce_loss 1.2578 (1.2178) loss_zs_kd 0.3012 (0.2898) loss_oracle 0.4229 (0.3141) acc 53.1250 (53.7847) kd_loss 0.7124 (0.6906) lr 1.9511e-03 eta 0:23:57
epoch [7/50] batch [200/319] time 0.178 (0.104) data 0.000 (0.006) loss 2.4892 (2.2093) ce_loss 1.4863 (1.2121) loss_zs_kd 0.4306 (0.2927) loss_oracle 0.2997 (0.3142) acc 56.2500 (53.9219) kd_loss 0.6377 (0.6938) lr 1.9511e-03 eta 0:23:59
epoch [7/50] batch [220/319] time 0.084 (0.105) data 0.000 (0.005) loss 2.2357 (2.2029) ce_loss 1.2246 (1.2045) loss_zs_kd 0.3452 (0.2927) loss_oracle 0.3592 (0.3138) acc 53.1250 (54.1335) kd_loss 0.6589 (0.6951) lr 1.9511e-03 eta 0:24:06
epoch [7/50] batch [240/319] time 0.158 (0.103) data 0.000 (0.005) loss 2.2476 (2.2029) ce_loss 1.3086 (1.2047) loss_zs_kd 0.2665 (0.2922) loss_oracle 0.2557 (0.3137) acc 50.0000 (54.0885) kd_loss 0.6780 (0.6953) lr 1.9511e-03 eta 0:23:46
epoch [7/50] batch [260/319] time 0.088 (0.104) data 0.000 (0.005) loss 2.1045 (2.2067) ce_loss 1.0928 (1.2076) loss_zs_kd 0.2687 (0.2920) loss_oracle 0.4598 (0.3176) acc 62.5000 (54.0865) kd_loss 0.6475 (0.6943) lr 1.9511e-03 eta 0:23:46
epoch [7/50] batch [280/319] time 0.105 (0.103) data 0.000 (0.004) loss 2.0763 (2.2050) ce_loss 1.0469 (1.2065) loss_zs_kd 0.3226 (0.2919) loss_oracle 0.3361 (0.3228) acc 68.7500 (54.1741) kd_loss 0.7001 (0.6911) lr 1.9511e-03 eta 0:23:33
epoch [7/50] batch [300/319] time 0.105 (0.103) data 0.000 (0.004) loss 2.2882 (2.2026) ce_loss 1.3320 (1.2050) loss_zs_kd 0.3602 (0.2915) loss_oracle 0.2852 (0.3253) acc 43.7500 (54.1562) kd_loss 0.6335 (0.6893) lr 1.9511e-03 eta 0:23:29
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,660
* accuracy: 60.8%
* error: 39.2%
* macro_f1: 51.1%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,952
* accuracy: 50.9%
* error: 49.1%
* macro_f1: 22.2%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      60.8%, epoch: 7 *******
******* Domain 2 best val test acc: 50.9%, epoch: 7 *******
******* Domain 2 best test acc:     50.9%, epoch: 7 *******
epoch [8/50] batch [20/319] time 0.096 (0.152) data 0.000 (0.048) loss 2.3558 (2.2728) ce_loss 1.4883 (1.2558) loss_zs_kd 0.2843 (0.2675) loss_oracle 0.3821 (0.3615) acc 40.6250 (52.0312) kd_loss 0.5343 (0.7026) lr 1.9298e-03 eta 0:34:39
epoch [8/50] batch [40/319] time 0.102 (0.126) data 0.000 (0.024) loss 2.1118 (2.2600) ce_loss 1.0693 (1.2165) loss_zs_kd 0.2796 (0.2859) loss_oracle 0.3662 (0.3750) acc 53.1250 (53.8281) kd_loss 0.7195 (0.7131) lr 1.9298e-03 eta 0:28:41
epoch [8/50] batch [60/319] time 0.102 (0.119) data 0.000 (0.016) loss 2.1137 (2.2367) ce_loss 1.1992 (1.2007) loss_zs_kd 0.2945 (0.2878) loss_oracle 0.3144 (0.3712) acc 59.3750 (54.6875) kd_loss 0.6100 (0.7065) lr 1.9298e-03 eta 0:27:01
epoch [8/50] batch [80/319] time 0.095 (0.114) data 0.000 (0.012) loss 2.0873 (2.2034) ce_loss 1.1250 (1.1849) loss_zs_kd 0.2304 (0.2855) loss_oracle 0.3296 (0.3561) acc 62.5000 (55.7031) kd_loss 0.6822 (0.6978) lr 1.9298e-03 eta 0:25:55
epoch [8/50] batch [100/319] time 0.098 (0.112) data 0.000 (0.010) loss 2.1780 (2.2054) ce_loss 1.0791 (1.1915) loss_zs_kd 0.3455 (0.2912) loss_oracle 0.3603 (0.3526) acc 62.5000 (55.6250) kd_loss 0.7460 (0.6921) lr 1.9298e-03 eta 0:25:18
epoch [8/50] batch [120/319] time 0.107 (0.110) data 0.000 (0.008) loss 2.5763 (2.1995) ce_loss 1.3857 (1.1819) loss_zs_kd 0.3966 (0.2929) loss_oracle 0.4180 (0.3539) acc 59.3750 (56.1979) kd_loss 0.7833 (0.6941) lr 1.9298e-03 eta 0:24:56
epoch [8/50] batch [140/319] time 0.083 (0.109) data 0.000 (0.007) loss 2.4015 (2.2010) ce_loss 1.2549 (1.1868) loss_zs_kd 0.3911 (0.2925) loss_oracle 0.4458 (0.3566) acc 59.3750 (55.9598) kd_loss 0.7281 (0.6897) lr 1.9298e-03 eta 0:24:34
epoch [8/50] batch [160/319] time 0.074 (0.105) data 0.000 (0.006) loss 2.2229 (2.2061) ce_loss 1.2129 (1.1914) loss_zs_kd 0.2708 (0.2915) loss_oracle 0.3971 (0.3599) acc 50.0000 (55.8008) kd_loss 0.6761 (0.6890) lr 1.9298e-03 eta 0:23:43
epoch [8/50] batch [180/319] time 0.193 (0.108) data 0.001 (0.006) loss 2.4772 (2.2132) ce_loss 1.3906 (1.1958) loss_zs_kd 0.2621 (0.2939) loss_oracle 0.3462 (0.3617) acc 46.8750 (55.7118) kd_loss 0.7824 (0.6895) lr 1.9298e-03 eta 0:24:22
epoch [8/50] batch [200/319] time 0.082 (0.106) data 0.000 (0.005) loss 2.2176 (2.2101) ce_loss 1.2432 (1.1916) loss_zs_kd 0.3395 (0.2935) loss_oracle 0.3870 (0.3646) acc 53.1250 (55.5938) kd_loss 0.6112 (0.6895) lr 1.9298e-03 eta 0:23:49
epoch [8/50] batch [220/319] time 0.195 (0.107) data 0.000 (0.005) loss 2.0630 (2.2092) ce_loss 0.9160 (1.1919) loss_zs_kd 0.3253 (0.2937) loss_oracle 0.3203 (0.3606) acc 62.5000 (55.5114) kd_loss 0.8242 (0.6901) lr 1.9298e-03 eta 0:24:02
epoch [8/50] batch [240/319] time 0.083 (0.104) data 0.000 (0.004) loss 2.4077 (2.2066) ce_loss 1.3418 (1.1888) loss_zs_kd 0.2675 (0.2936) loss_oracle 0.3376 (0.3621) acc 53.1250 (55.6641) kd_loss 0.7633 (0.6899) lr 1.9298e-03 eta 0:23:28
epoch [8/50] batch [260/319] time 0.108 (0.104) data 0.000 (0.004) loss 2.4220 (2.2105) ce_loss 1.4229 (1.1890) loss_zs_kd 0.3628 (0.2940) loss_oracle 0.3341 (0.3631) acc 43.7500 (55.5168) kd_loss 0.6507 (0.6930) lr 1.9298e-03 eta 0:23:17
epoch [8/50] batch [280/319] time 0.105 (0.104) data 0.000 (0.004) loss 2.3975 (2.2107) ce_loss 1.3193 (1.1842) loss_zs_kd 0.2221 (0.2941) loss_oracle 0.3658 (0.3639) acc 40.6250 (55.5692) kd_loss 0.7842 (0.6975) lr 1.9298e-03 eta 0:23:15
epoch [8/50] batch [300/319] time 0.097 (0.104) data 0.000 (0.003) loss 2.3338 (2.2157) ce_loss 1.3662 (1.1892) loss_zs_kd 0.2343 (0.2936) loss_oracle 0.3604 (0.3638) acc 43.7500 (55.3958) kd_loss 0.6703 (0.6978) lr 1.9298e-03 eta 0:23:09
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,623
* accuracy: 59.9%
* error: 40.1%
* macro_f1: 49.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,071
* accuracy: 52.1%
* error: 47.9%
* macro_f1: 21.9%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      60.8%, epoch: 7 *******
******* Domain 2 best val test acc: 50.9%, epoch: 7 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [9/50] batch [20/319] time 0.102 (0.161) data 0.000 (0.055) loss 2.1518 (2.1667) ce_loss 1.0762 (1.1225) loss_zs_kd 0.3434 (0.3242) loss_oracle 0.3754 (0.4066) acc 50.0000 (57.0312) kd_loss 0.7163 (0.6788) lr 1.9048e-03 eta 0:35:55
epoch [9/50] batch [40/319] time 0.103 (0.132) data 0.000 (0.027) loss 2.0837 (2.1720) ce_loss 1.0498 (1.1124) loss_zs_kd 0.3657 (0.3219) loss_oracle 0.3843 (0.3896) acc 56.2500 (57.1094) kd_loss 0.6589 (0.7039) lr 1.9048e-03 eta 0:29:23
epoch [9/50] batch [60/319] time 0.101 (0.122) data 0.001 (0.018) loss 2.3337 (2.1966) ce_loss 1.3447 (1.1477) loss_zs_kd 0.2812 (0.3077) loss_oracle 0.3601 (0.3891) acc 53.1250 (56.3542) kd_loss 0.6684 (0.7005) lr 1.9048e-03 eta 0:27:04
epoch [9/50] batch [80/319] time 0.095 (0.117) data 0.000 (0.014) loss 2.4073 (2.2052) ce_loss 1.1494 (1.1644) loss_zs_kd 0.2745 (0.3044) loss_oracle 0.4641 (0.3838) acc 62.5000 (56.0938) kd_loss 0.8886 (0.6967) lr 1.9048e-03 eta 0:25:55
epoch [9/50] batch [100/319] time 0.106 (0.114) data 0.000 (0.011) loss 2.3284 (2.1983) ce_loss 1.3652 (1.1641) loss_zs_kd 0.2457 (0.2992) loss_oracle 0.3351 (0.3798) acc 50.0000 (56.5000) kd_loss 0.6727 (0.6947) lr 1.9048e-03 eta 0:25:11
epoch [9/50] batch [120/319] time 0.098 (0.111) data 0.000 (0.009) loss 2.1831 (2.2055) ce_loss 1.2334 (1.1770) loss_zs_kd 0.2254 (0.2948) loss_oracle 0.3118 (0.3743) acc 59.3750 (56.0417) kd_loss 0.6811 (0.6940) lr 1.9048e-03 eta 0:24:30
epoch [9/50] batch [140/319] time 0.092 (0.107) data 0.000 (0.008) loss 2.4605 (2.2139) ce_loss 1.5508 (1.1863) loss_zs_kd 0.2989 (0.2967) loss_oracle 0.3925 (0.3731) acc 43.7500 (55.8482) kd_loss 0.5640 (0.6928) lr 1.9048e-03 eta 0:23:38
epoch [9/50] batch [160/319] time 0.180 (0.107) data 0.000 (0.007) loss 2.0616 (2.2052) ce_loss 1.2051 (1.1793) loss_zs_kd 0.3388 (0.3009) loss_oracle 0.2762 (0.3671) acc 62.5000 (56.1523) kd_loss 0.5490 (0.6919) lr 1.9048e-03 eta 0:23:30
epoch [9/50] batch [180/319] time 0.079 (0.108) data 0.000 (0.006) loss 2.2263 (2.1996) ce_loss 1.1650 (1.1762) loss_zs_kd 0.3233 (0.3022) loss_oracle 0.3476 (0.3609) acc 56.2500 (56.2847) kd_loss 0.7258 (0.6918) lr 1.9048e-03 eta 0:23:46
epoch [9/50] batch [200/319] time 0.147 (0.106) data 0.000 (0.006) loss 2.0089 (2.2008) ce_loss 1.1631 (1.1774) loss_zs_kd 0.2346 (0.3032) loss_oracle 0.3228 (0.3585) acc 53.1250 (56.1719) kd_loss 0.5672 (0.6925) lr 1.9048e-03 eta 0:23:22
epoch [9/50] batch [220/319] time 0.083 (0.107) data 0.000 (0.005) loss 2.0068 (2.1955) ce_loss 1.0889 (1.1762) loss_zs_kd 0.2131 (0.3007) loss_oracle 0.3684 (0.3567) acc 53.1250 (55.9943) kd_loss 0.6271 (0.6906) lr 1.9048e-03 eta 0:23:26
epoch [9/50] batch [240/319] time 0.100 (0.105) data 0.000 (0.005) loss 2.1828 (2.1907) ce_loss 1.2178 (1.1754) loss_zs_kd 0.3489 (0.3000) loss_oracle 0.3352 (0.3560) acc 50.0000 (55.9635) kd_loss 0.6229 (0.6872) lr 1.9048e-03 eta 0:23:01
epoch [9/50] batch [260/319] time 0.095 (0.105) data 0.000 (0.004) loss 2.3082 (2.1867) ce_loss 1.2793 (1.1748) loss_zs_kd 0.2791 (0.3000) loss_oracle 0.3932 (0.3549) acc 46.8750 (55.8413) kd_loss 0.6928 (0.6846) lr 1.9048e-03 eta 0:22:57
epoch [9/50] batch [280/319] time 0.113 (0.105) data 0.000 (0.004) loss 2.0402 (2.1901) ce_loss 0.9746 (1.1808) loss_zs_kd 0.3582 (0.2990) loss_oracle 0.3133 (0.3555) acc 68.7500 (55.6027) kd_loss 0.7299 (0.6820) lr 1.9048e-03 eta 0:22:53
epoch [9/50] batch [300/319] time 0.103 (0.104) data 0.000 (0.004) loss 2.4522 (2.1909) ce_loss 1.4160 (1.1804) loss_zs_kd 0.3099 (0.2991) loss_oracle 0.3837 (0.3548) acc 46.8750 (55.5521) kd_loss 0.6893 (0.6835) lr 1.9048e-03 eta 0:22:48
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,689
* accuracy: 61.4%
* error: 38.6%
* macro_f1: 50.8%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,003
* accuracy: 51.4%
* error: 48.6%
* macro_f1: 23.7%
******* Domain 2 best val acc:      61.4%, epoch: 9 *******
******* Domain 2 best val test acc: 51.4%, epoch: 9 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [10/50] batch [20/319] time 0.115 (0.159) data 0.000 (0.056) loss 2.4516 (2.1919) ce_loss 1.4033 (1.2045) loss_zs_kd 0.3212 (0.3004) loss_oracle 0.3278 (0.3171) acc 40.6250 (55.4688) kd_loss 0.7237 (0.6786) lr 1.8763e-03 eta 0:34:33
epoch [10/50] batch [40/319] time 0.098 (0.130) data 0.000 (0.028) loss 2.2667 (2.1968) ce_loss 1.2754 (1.2065) loss_zs_kd 0.2620 (0.2937) loss_oracle 0.3112 (0.3214) acc 50.0000 (54.2969) kd_loss 0.7047 (0.6827) lr 1.8763e-03 eta 0:28:17
epoch [10/50] batch [60/319] time 0.096 (0.121) data 0.000 (0.019) loss 2.2848 (2.1715) ce_loss 1.3945 (1.1923) loss_zs_kd 0.2663 (0.2874) loss_oracle 0.2866 (0.3164) acc 43.7500 (54.5833) kd_loss 0.6138 (0.6773) lr 1.8763e-03 eta 0:26:18
epoch [10/50] batch [80/319] time 0.110 (0.116) data 0.000 (0.014) loss 1.8715 (2.1610) ce_loss 0.9248 (1.1924) loss_zs_kd 0.2716 (0.2860) loss_oracle 0.3207 (0.3139) acc 65.6250 (54.5703) kd_loss 0.6505 (0.6686) lr 1.8763e-03 eta 0:25:10
epoch [10/50] batch [100/319] time 0.106 (0.113) data 0.000 (0.011) loss 1.8362 (2.1599) ce_loss 0.9116 (1.2017) loss_zs_kd 0.2364 (0.2888) loss_oracle 0.3303 (0.3091) acc 71.8750 (54.2188) kd_loss 0.6412 (0.6593) lr 1.8763e-03 eta 0:24:31
epoch [10/50] batch [120/319] time 0.095 (0.111) data 0.000 (0.010) loss 2.1362 (2.1534) ce_loss 1.1094 (1.1978) loss_zs_kd 0.3158 (0.2924) loss_oracle 0.3311 (0.3101) acc 56.2500 (54.4010) kd_loss 0.7034 (0.6543) lr 1.8763e-03 eta 0:23:55
epoch [10/50] batch [140/319] time 0.091 (0.106) data 0.000 (0.008) loss 2.1342 (2.1458) ce_loss 1.0996 (1.1881) loss_zs_kd 0.3085 (0.2930) loss_oracle 0.3951 (0.3111) acc 62.5000 (55.0670) kd_loss 0.6828 (0.6557) lr 1.8763e-03 eta 0:22:56
epoch [10/50] batch [160/319] time 0.084 (0.103) data 0.000 (0.007) loss 2.1059 (2.1407) ce_loss 1.3369 (1.1827) loss_zs_kd 0.2912 (0.2914) loss_oracle 0.2752 (0.3123) acc 43.7500 (55.4102) kd_loss 0.4858 (0.6562) lr 1.8763e-03 eta 0:22:06
epoch [10/50] batch [180/319] time 0.077 (0.106) data 0.000 (0.006) loss 2.1771 (2.1455) ce_loss 1.1895 (1.1900) loss_zs_kd 0.2355 (0.2934) loss_oracle 0.3254 (0.3093) acc 59.3750 (55.2951) kd_loss 0.7072 (0.6543) lr 1.8763e-03 eta 0:22:50
epoch [10/50] batch [200/319] time 0.095 (0.104) data 0.001 (0.006) loss 1.8421 (2.1393) ce_loss 0.8022 (1.1881) loss_zs_kd 0.2815 (0.2910) loss_oracle 0.3207 (0.3097) acc 75.0000 (55.2656) kd_loss 0.7387 (0.6508) lr 1.8763e-03 eta 0:22:24
epoch [10/50] batch [220/319] time 0.085 (0.106) data 0.000 (0.005) loss 1.8439 (2.1377) ce_loss 1.0752 (1.1876) loss_zs_kd 0.2686 (0.2927) loss_oracle 0.3148 (0.3125) acc 53.1250 (55.4261) kd_loss 0.4769 (0.6475) lr 1.8763e-03 eta 0:22:37
epoch [10/50] batch [240/319] time 0.081 (0.104) data 0.000 (0.005) loss 2.1593 (2.1417) ce_loss 1.1660 (1.1927) loss_zs_kd 0.3074 (0.2939) loss_oracle 0.3549 (0.3158) acc 56.2500 (55.0521) kd_loss 0.6621 (0.6441) lr 1.8763e-03 eta 0:22:12
epoch [10/50] batch [260/319] time 0.106 (0.103) data 0.000 (0.005) loss 2.1302 (2.1430) ce_loss 1.2188 (1.1944) loss_zs_kd 0.2836 (0.2937) loss_oracle 0.2845 (0.3185) acc 50.0000 (54.8077) kd_loss 0.6274 (0.6425) lr 1.8763e-03 eta 0:22:04
epoch [10/50] batch [280/319] time 0.104 (0.103) data 0.000 (0.004) loss 2.2184 (2.1423) ce_loss 1.2334 (1.1893) loss_zs_kd 0.3659 (0.2956) loss_oracle 0.3737 (0.3218) acc 46.8750 (54.9442) kd_loss 0.6153 (0.6444) lr 1.8763e-03 eta 0:22:00
epoch [10/50] batch [300/319] time 0.103 (0.103) data 0.000 (0.004) loss 2.2146 (2.1389) ce_loss 1.3506 (1.1880) loss_zs_kd 0.2933 (0.2957) loss_oracle 0.2554 (0.3227) acc 50.0000 (54.9896) kd_loss 0.5897 (0.6418) lr 1.8763e-03 eta 0:21:55
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,651
* accuracy: 60.6%
* error: 39.4%
* macro_f1: 51.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,997
* accuracy: 51.3%
* error: 48.7%
* macro_f1: 21.8%
******* Domain 2 best val acc:      61.4%, epoch: 9 *******
******* Domain 2 best val test acc: 51.4%, epoch: 9 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [11/50] batch [20/319] time 0.087 (0.171) data 0.000 (0.068) loss 2.0760 (2.1042) ce_loss 1.0947 (1.1542) loss_zs_kd 0.2772 (0.2732) loss_oracle 0.3788 (0.3422) acc 62.5000 (55.7812) kd_loss 0.6533 (0.6423) lr 1.8443e-03 eta 0:36:18
epoch [11/50] batch [40/319] time 0.097 (0.137) data 0.000 (0.034) loss 1.9352 (2.1062) ce_loss 0.9800 (1.1494) loss_zs_kd 0.2521 (0.2899) loss_oracle 0.3197 (0.3440) acc 65.6250 (55.8594) kd_loss 0.6693 (0.6398) lr 1.8443e-03 eta 0:29:02
epoch [11/50] batch [60/319] time 0.094 (0.125) data 0.000 (0.023) loss 2.3692 (2.1247) ce_loss 1.2451 (1.1559) loss_zs_kd 0.4308 (0.2998) loss_oracle 0.2783 (0.3340) acc 56.2500 (55.9896) kd_loss 0.7696 (0.6519) lr 1.8443e-03 eta 0:26:28
epoch [11/50] batch [80/319] time 0.097 (0.119) data 0.000 (0.017) loss 2.2884 (2.1281) ce_loss 1.3779 (1.1622) loss_zs_kd 0.3537 (0.3025) loss_oracle 0.3261 (0.3286) acc 53.1250 (56.2109) kd_loss 0.5706 (0.6503) lr 1.8443e-03 eta 0:25:05
epoch [11/50] batch [100/319] time 0.092 (0.114) data 0.000 (0.014) loss 1.8812 (2.1308) ce_loss 1.0176 (1.1706) loss_zs_kd 0.2227 (0.2976) loss_oracle 0.3154 (0.3267) acc 75.0000 (55.9062) kd_loss 0.5945 (0.6480) lr 1.8443e-03 eta 0:24:09
epoch [11/50] batch [120/319] time 0.103 (0.112) data 0.000 (0.012) loss 2.1543 (2.1389) ce_loss 1.2041 (1.1780) loss_zs_kd 0.2889 (0.2992) loss_oracle 0.3517 (0.3283) acc 59.3750 (55.7552) kd_loss 0.6299 (0.6472) lr 1.8443e-03 eta 0:23:36
epoch [11/50] batch [140/319] time 0.073 (0.108) data 0.000 (0.010) loss 2.5550 (2.1397) ce_loss 1.5293 (1.1755) loss_zs_kd 0.3480 (0.3014) loss_oracle 0.3229 (0.3277) acc 43.7500 (55.9821) kd_loss 0.6902 (0.6496) lr 1.8443e-03 eta 0:22:45
epoch [11/50] batch [160/319] time 0.095 (0.105) data 0.000 (0.009) loss 1.7469 (2.1452) ce_loss 0.8125 (1.1797) loss_zs_kd 0.2719 (0.3031) loss_oracle 0.3224 (0.3330) acc 65.6250 (55.9375) kd_loss 0.6373 (0.6474) lr 1.8443e-03 eta 0:22:09
epoch [11/50] batch [180/319] time 0.076 (0.109) data 0.000 (0.008) loss 2.2612 (2.1504) ce_loss 1.2266 (1.1780) loss_zs_kd 0.2773 (0.3023) loss_oracle 0.4118 (0.3385) acc 59.3750 (56.1806) kd_loss 0.6901 (0.6520) lr 1.8443e-03 eta 0:22:52
epoch [11/50] batch [200/319] time 0.087 (0.106) data 0.000 (0.007) loss 2.2619 (2.1522) ce_loss 1.1943 (1.1745) loss_zs_kd 0.3547 (0.3044) loss_oracle 0.3649 (0.3417) acc 53.1250 (56.4375) kd_loss 0.7078 (0.6546) lr 1.8443e-03 eta 0:22:15
epoch [11/50] batch [220/319] time 0.130 (0.107) data 0.000 (0.006) loss 2.2554 (2.1503) ce_loss 1.2793 (1.1702) loss_zs_kd 0.3366 (0.3026) loss_oracle 0.3771 (0.3444) acc 56.2500 (56.5625) kd_loss 0.6192 (0.6567) lr 1.8443e-03 eta 0:22:23
epoch [11/50] batch [240/319] time 0.085 (0.105) data 0.000 (0.006) loss 2.1623 (2.1470) ce_loss 1.1318 (1.1632) loss_zs_kd 0.2674 (0.3017) loss_oracle 0.3612 (0.3445) acc 59.3750 (56.8359) kd_loss 0.7161 (0.6607) lr 1.8443e-03 eta 0:21:50
epoch [11/50] batch [260/319] time 0.098 (0.104) data 0.000 (0.005) loss 2.0231 (2.1463) ce_loss 1.0752 (1.1615) loss_zs_kd 0.3803 (0.3034) loss_oracle 0.3088 (0.3426) acc 56.2500 (56.7428) kd_loss 0.6034 (0.6617) lr 1.8443e-03 eta 0:21:33
epoch [11/50] batch [280/319] time 0.102 (0.104) data 0.000 (0.005) loss 2.2618 (2.1427) ce_loss 1.3105 (1.1589) loss_zs_kd 0.2951 (0.3030) loss_oracle 0.4074 (0.3411) acc 43.7500 (56.8750) kd_loss 0.6001 (0.6617) lr 1.8443e-03 eta 0:21:31
epoch [11/50] batch [300/319] time 0.096 (0.103) data 0.000 (0.005) loss 2.7148 (2.1486) ce_loss 1.6660 (1.1624) loss_zs_kd 0.3047 (0.3018) loss_oracle 0.3686 (0.3426) acc 40.6250 (56.8438) kd_loss 0.7121 (0.6640) lr 1.8443e-03 eta 0:21:28
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,604
* accuracy: 59.5%
* error: 40.5%
* macro_f1: 49.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,481
* accuracy: 46.0%
* error: 54.0%
* macro_f1: 21.2%
******* Domain 2 best val acc:      61.4%, epoch: 9 *******
******* Domain 2 best val test acc: 51.4%, epoch: 9 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [12/50] batch [20/319] time 0.093 (0.170) data 0.000 (0.069) loss 2.0581 (2.1636) ce_loss 1.0967 (1.1761) loss_zs_kd 0.2589 (0.2862) loss_oracle 0.3225 (0.3188) acc 59.3750 (54.3750) kd_loss 0.6707 (0.6850) lr 1.8090e-03 eta 0:35:16
epoch [12/50] batch [40/319] time 0.100 (0.136) data 0.000 (0.035) loss 2.0787 (2.1766) ce_loss 0.9546 (1.1805) loss_zs_kd 0.3284 (0.2864) loss_oracle 0.3229 (0.3148) acc 71.8750 (54.6875) kd_loss 0.7985 (0.6955) lr 1.8090e-03 eta 0:28:00
epoch [12/50] batch [60/319] time 0.100 (0.124) data 0.000 (0.023) loss 2.1116 (2.1918) ce_loss 1.2295 (1.1941) loss_zs_kd 0.2996 (0.2983) loss_oracle 0.2751 (0.3209) acc 59.3750 (54.8438) kd_loss 0.5947 (0.6881) lr 1.8090e-03 eta 0:25:31
epoch [12/50] batch [80/319] time 0.111 (0.118) data 0.000 (0.017) loss 1.9502 (2.1731) ce_loss 0.9873 (1.1824) loss_zs_kd 0.2521 (0.3027) loss_oracle 0.3243 (0.3206) acc 59.3750 (55.0781) kd_loss 0.6747 (0.6791) lr 1.8090e-03 eta 0:24:22
epoch [12/50] batch [100/319] time 0.115 (0.115) data 0.000 (0.014) loss 2.2903 (2.1725) ce_loss 1.2852 (1.1920) loss_zs_kd 0.3524 (0.2961) loss_oracle 0.3195 (0.3198) acc 50.0000 (54.9688) kd_loss 0.6692 (0.6725) lr 1.8090e-03 eta 0:23:34
epoch [12/50] batch [120/319] time 0.095 (0.112) data 0.000 (0.012) loss 2.0792 (2.1680) ce_loss 1.2256 (1.1944) loss_zs_kd 0.2869 (0.2949) loss_oracle 0.3354 (0.3231) acc 56.2500 (55.0781) kd_loss 0.5425 (0.6646) lr 1.8090e-03 eta 0:23:05
epoch [12/50] batch [140/319] time 0.078 (0.109) data 0.000 (0.010) loss 2.1282 (2.1518) ce_loss 1.1465 (1.1802) loss_zs_kd 0.3361 (0.2962) loss_oracle 0.2946 (0.3200) acc 65.6250 (55.7589) kd_loss 0.6664 (0.6635) lr 1.8090e-03 eta 0:22:26
epoch [12/50] batch [160/319] time 0.086 (0.106) data 0.000 (0.009) loss 2.3251 (2.1494) ce_loss 1.2510 (1.1749) loss_zs_kd 0.3659 (0.2968) loss_oracle 0.2812 (0.3183) acc 53.1250 (56.0547) kd_loss 0.7505 (0.6669) lr 1.8090e-03 eta 0:21:47
epoch [12/50] batch [180/319] time 0.121 (0.109) data 0.000 (0.008) loss 2.1465 (2.1500) ce_loss 1.1826 (1.1705) loss_zs_kd 0.2826 (0.2994) loss_oracle 0.4039 (0.3203) acc 46.8750 (56.1979) kd_loss 0.6206 (0.6696) lr 1.8090e-03 eta 0:22:10
epoch [12/50] batch [200/319] time 0.082 (0.107) data 0.000 (0.007) loss 2.3183 (2.1490) ce_loss 1.2607 (1.1659) loss_zs_kd 0.2838 (0.2993) loss_oracle 0.3711 (0.3220) acc 40.6250 (55.9688) kd_loss 0.7301 (0.6724) lr 1.8090e-03 eta 0:21:45
epoch [12/50] batch [220/319] time 0.087 (0.105) data 0.000 (0.006) loss 1.8518 (2.1491) ce_loss 0.9604 (1.1600) loss_zs_kd 0.2535 (0.3044) loss_oracle 0.3111 (0.3236) acc 56.2500 (56.2216) kd_loss 0.6091 (0.6750) lr 1.8090e-03 eta 0:21:23
epoch [12/50] batch [240/319] time 0.084 (0.106) data 0.000 (0.006) loss 2.3596 (2.1554) ce_loss 1.1445 (1.1598) loss_zs_kd 0.3469 (0.3049) loss_oracle 0.3944 (0.3246) acc 56.2500 (56.1589) kd_loss 0.8444 (0.6809) lr 1.8090e-03 eta 0:21:27
epoch [12/50] batch [260/319] time 0.087 (0.104) data 0.000 (0.006) loss 2.0803 (2.1530) ce_loss 1.1260 (1.1540) loss_zs_kd 0.2758 (0.3037) loss_oracle 0.3212 (0.3231) acc 59.3750 (56.4183) kd_loss 0.6558 (0.6856) lr 1.8090e-03 eta 0:21:00
epoch [12/50] batch [280/319] time 0.102 (0.103) data 0.000 (0.005) loss 1.8478 (2.1514) ce_loss 0.9146 (1.1530) loss_zs_kd 0.2852 (0.3031) loss_oracle 0.2860 (0.3228) acc 65.6250 (56.4509) kd_loss 0.6477 (0.6855) lr 1.8090e-03 eta 0:20:53
epoch [12/50] batch [300/319] time 0.096 (0.103) data 0.000 (0.005) loss 2.3310 (2.1495) ce_loss 1.2188 (1.1508) loss_zs_kd 0.3149 (0.3029) loss_oracle 0.3527 (0.3238) acc 53.1250 (56.4688) kd_loss 0.7785 (0.6853) lr 1.8090e-03 eta 0:20:50
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,515
* accuracy: 57.4%
* error: 42.6%
* macro_f1: 49.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,065
* accuracy: 41.8%
* error: 58.2%
* macro_f1: 21.8%
******* Domain 2 best val acc:      61.4%, epoch: 9 *******
******* Domain 2 best val test acc: 51.4%, epoch: 9 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [13/50] batch [20/319] time 0.106 (0.186) data 0.000 (0.083) loss 2.0561 (2.1879) ce_loss 1.0596 (1.2174) loss_zs_kd 0.3386 (0.3231) loss_oracle 0.3231 (0.3151) acc 56.2500 (53.5938) kd_loss 0.6657 (0.6514) lr 1.7705e-03 eta 0:37:36
epoch [13/50] batch [40/319] time 0.108 (0.142) data 0.000 (0.042) loss 2.5428 (2.1366) ce_loss 1.4932 (1.1563) loss_zs_kd 0.2923 (0.3085) loss_oracle 0.3259 (0.3157) acc 46.8750 (55.5469) kd_loss 0.7405 (0.6682) lr 1.7705e-03 eta 0:28:37
epoch [13/50] batch [60/319] time 0.108 (0.129) data 0.000 (0.028) loss 2.5740 (2.1559) ce_loss 1.4639 (1.1681) loss_zs_kd 0.3260 (0.3039) loss_oracle 0.3176 (0.3151) acc 50.0000 (55.1042) kd_loss 0.7883 (0.6783) lr 1.7705e-03 eta 0:25:57
epoch [13/50] batch [80/319] time 0.104 (0.122) data 0.000 (0.021) loss 1.9703 (2.1753) ce_loss 0.9561 (1.1717) loss_zs_kd 0.2559 (0.3068) loss_oracle 0.3136 (0.3189) acc 65.6250 (55.1172) kd_loss 0.7295 (0.6907) lr 1.7705e-03 eta 0:24:29
epoch [13/50] batch [100/319] time 0.114 (0.118) data 0.000 (0.017) loss 2.2656 (2.1828) ce_loss 1.2744 (1.1692) loss_zs_kd 0.2767 (0.3059) loss_oracle 0.2990 (0.3196) acc 53.1250 (55.1250) kd_loss 0.7034 (0.7008) lr 1.7705e-03 eta 0:23:41
epoch [13/50] batch [120/319] time 0.099 (0.115) data 0.000 (0.014) loss 2.2879 (2.1879) ce_loss 1.2100 (1.1621) loss_zs_kd 0.2473 (0.3081) loss_oracle 0.3079 (0.3218) acc 43.7500 (55.7292) kd_loss 0.8003 (0.7108) lr 1.7705e-03 eta 0:23:06
epoch [13/50] batch [140/319] time 0.112 (0.114) data 0.001 (0.012) loss 2.3398 (2.1919) ce_loss 1.3652 (1.1636) loss_zs_kd 0.3443 (0.3071) loss_oracle 0.3210 (0.3213) acc 56.2500 (55.6696) kd_loss 0.6419 (0.7141) lr 1.7705e-03 eta 0:22:40
epoch [13/50] batch [160/319] time 0.096 (0.112) data 0.000 (0.011) loss 2.2130 (2.1893) ce_loss 1.2217 (1.1638) loss_zs_kd 0.3282 (0.3065) loss_oracle 0.2876 (0.3188) acc 56.2500 (55.6836) kd_loss 0.6834 (0.7128) lr 1.7705e-03 eta 0:22:16
epoch [13/50] batch [180/319] time 0.088 (0.109) data 0.000 (0.009) loss 1.9328 (2.1937) ce_loss 1.0879 (1.1690) loss_zs_kd 0.2860 (0.3066) loss_oracle 0.3484 (0.3175) acc 62.5000 (55.7986) kd_loss 0.5278 (0.7126) lr 1.7705e-03 eta 0:21:42
epoch [13/50] batch [200/319] time 0.087 (0.106) data 0.000 (0.009) loss 2.2628 (2.1956) ce_loss 1.3525 (1.1738) loss_zs_kd 0.2716 (0.3060) loss_oracle 0.2891 (0.3160) acc 46.8750 (55.7656) kd_loss 0.6300 (0.7108) lr 1.7705e-03 eta 0:21:08
epoch [13/50] batch [220/319] time 0.066 (0.109) data 0.000 (0.008) loss 2.3787 (2.1898) ce_loss 1.3418 (1.1702) loss_zs_kd 0.3257 (0.3065) loss_oracle 0.2459 (0.3151) acc 50.0000 (55.7386) kd_loss 0.7511 (0.7088) lr 1.7705e-03 eta 0:21:36
epoch [13/50] batch [240/319] time 0.073 (0.106) data 0.000 (0.007) loss 2.2049 (2.1896) ce_loss 1.0732 (1.1717) loss_zs_kd 0.2692 (0.3076) loss_oracle 0.3618 (0.3155) acc 62.5000 (55.6641) kd_loss 0.8161 (0.7064) lr 1.7705e-03 eta 0:21:04
epoch [13/50] batch [260/319] time 0.176 (0.106) data 0.000 (0.007) loss 2.3049 (2.1900) ce_loss 1.1738 (1.1710) loss_zs_kd 0.3279 (0.3078) loss_oracle 0.3014 (0.3164) acc 53.1250 (55.6370) kd_loss 0.8164 (0.7069) lr 1.7705e-03 eta 0:21:00
epoch [13/50] batch [280/319] time 0.083 (0.105) data 0.000 (0.006) loss 2.1682 (2.1866) ce_loss 1.1855 (1.1708) loss_zs_kd 0.3256 (0.3050) loss_oracle 0.3281 (0.3187) acc 53.1250 (55.7143) kd_loss 0.6558 (0.7040) lr 1.7705e-03 eta 0:20:41
epoch [13/50] batch [300/319] time 0.108 (0.104) data 0.000 (0.006) loss 2.0092 (2.1782) ce_loss 1.0908 (1.1670) loss_zs_kd 0.3428 (0.3050) loss_oracle 0.2910 (0.3177) acc 62.5000 (55.8438) kd_loss 0.6015 (0.6999) lr 1.7705e-03 eta 0:20:28
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,586
* accuracy: 59.1%
* error: 40.9%
* macro_f1: 49.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,598
* accuracy: 47.2%
* error: 52.8%
* macro_f1: 23.2%
******* Domain 2 best val acc:      61.4%, epoch: 9 *******
******* Domain 2 best val test acc: 51.4%, epoch: 9 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [14/50] batch [20/319] time 0.103 (0.186) data 0.000 (0.080) loss 1.9628 (2.1304) ce_loss 1.0117 (1.1667) loss_zs_kd 0.3685 (0.2916) loss_oracle 0.2955 (0.3131) acc 71.8750 (55.6250) kd_loss 0.6191 (0.6614) lr 1.7290e-03 eta 0:36:33
epoch [14/50] batch [40/319] time 0.090 (0.143) data 0.000 (0.040) loss 2.1021 (2.1334) ce_loss 1.1143 (1.1571) loss_zs_kd 0.2625 (0.3003) loss_oracle 0.3397 (0.3269) acc 56.2500 (56.0938) kd_loss 0.6867 (0.6626) lr 1.7290e-03 eta 0:28:05
epoch [14/50] batch [60/319] time 0.100 (0.129) data 0.001 (0.027) loss 2.2201 (2.1535) ce_loss 1.1162 (1.1636) loss_zs_kd 0.3986 (0.3017) loss_oracle 0.3920 (0.3363) acc 53.1250 (56.0938) kd_loss 0.7086 (0.6710) lr 1.7290e-03 eta 0:25:19
epoch [14/50] batch [80/319] time 0.100 (0.123) data 0.000 (0.020) loss 2.4262 (2.1551) ce_loss 1.3760 (1.1638) loss_zs_kd 0.3180 (0.3027) loss_oracle 0.3611 (0.3355) acc 50.0000 (55.2344) kd_loss 0.7107 (0.6722) lr 1.7290e-03 eta 0:23:57
epoch [14/50] batch [100/319] time 0.097 (0.118) data 0.000 (0.016) loss 1.8360 (2.1507) ce_loss 0.9517 (1.1658) loss_zs_kd 0.3019 (0.3071) loss_oracle 0.3264 (0.3326) acc 68.7500 (55.2188) kd_loss 0.5702 (0.6649) lr 1.7290e-03 eta 0:23:04
epoch [14/50] batch [120/319] time 0.100 (0.115) data 0.000 (0.014) loss 2.1499 (2.1538) ce_loss 0.9863 (1.1615) loss_zs_kd 0.3444 (0.3101) loss_oracle 0.3587 (0.3316) acc 68.7500 (55.6250) kd_loss 0.8121 (0.6714) lr 1.7290e-03 eta 0:22:25
epoch [14/50] batch [140/319] time 0.090 (0.113) data 0.000 (0.012) loss 2.3582 (2.1585) ce_loss 1.3955 (1.1653) loss_zs_kd 0.3014 (0.3084) loss_oracle 0.3039 (0.3310) acc 56.2500 (55.0000) kd_loss 0.6601 (0.6735) lr 1.7290e-03 eta 0:22:01
epoch [14/50] batch [160/319] time 0.106 (0.112) data 0.000 (0.010) loss 2.2765 (2.1666) ce_loss 1.2734 (1.1709) loss_zs_kd 0.2822 (0.3084) loss_oracle 0.2941 (0.3311) acc 50.0000 (54.9609) kd_loss 0.7149 (0.6759) lr 1.7290e-03 eta 0:21:44
epoch [14/50] batch [180/319] time 0.084 (0.110) data 0.000 (0.009) loss 2.1889 (2.1714) ce_loss 1.1016 (1.1672) loss_zs_kd 0.3144 (0.3099) loss_oracle 0.3185 (0.3300) acc 56.2500 (55.4340) kd_loss 0.7709 (0.6843) lr 1.7290e-03 eta 0:21:20
epoch [14/50] batch [200/319] time 0.080 (0.107) data 0.000 (0.008) loss 2.1891 (2.1751) ce_loss 1.0869 (1.1616) loss_zs_kd 0.3557 (0.3102) loss_oracle 0.3465 (0.3304) acc 62.5000 (55.8281) kd_loss 0.7510 (0.6932) lr 1.7290e-03 eta 0:20:47
epoch [14/50] batch [220/319] time 0.153 (0.108) data 0.000 (0.008) loss 2.1820 (2.1799) ce_loss 1.0840 (1.1615) loss_zs_kd 0.3010 (0.3088) loss_oracle 0.3188 (0.3302) acc 68.7500 (56.0369) kd_loss 0.7881 (0.6990) lr 1.7290e-03 eta 0:20:53
epoch [14/50] batch [240/319] time 0.088 (0.107) data 0.000 (0.007) loss 2.2858 (2.1830) ce_loss 1.2227 (1.1593) loss_zs_kd 0.3336 (0.3082) loss_oracle 0.4139 (0.3301) acc 56.2500 (56.0677) kd_loss 0.6894 (0.7046) lr 1.7290e-03 eta 0:20:42
epoch [14/50] batch [260/319] time 0.082 (0.105) data 0.000 (0.006) loss 2.1890 (2.1844) ce_loss 1.0576 (1.1574) loss_zs_kd 0.2888 (0.3069) loss_oracle 0.3003 (0.3292) acc 59.3750 (56.1779) kd_loss 0.8368 (0.7090) lr 1.7290e-03 eta 0:20:16
epoch [14/50] batch [280/319] time 0.089 (0.106) data 0.000 (0.006) loss 2.2787 (2.1847) ce_loss 1.1514 (1.1547) loss_zs_kd 0.2808 (0.3076) loss_oracle 0.4196 (0.3291) acc 56.2500 (56.3393) kd_loss 0.7771 (0.7117) lr 1.7290e-03 eta 0:20:26
epoch [14/50] batch [300/319] time 0.076 (0.105) data 0.000 (0.006) loss 2.3071 (2.1852) ce_loss 1.2002 (1.1528) loss_zs_kd 0.2914 (0.3069) loss_oracle 0.3106 (0.3300) acc 53.1250 (56.4479) kd_loss 0.8059 (0.7139) lr 1.7290e-03 eta 0:20:07
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,623
* accuracy: 59.9%
* error: 40.1%
* macro_f1: 51.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,940
* accuracy: 50.7%
* error: 49.3%
* macro_f1: 22.1%
******* Domain 2 best val acc:      61.4%, epoch: 9 *******
******* Domain 2 best val test acc: 51.4%, epoch: 9 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [15/50] batch [20/319] time 0.108 (0.176) data 0.000 (0.072) loss 2.5528 (2.2384) ce_loss 1.3799 (1.1801) loss_zs_kd 0.2835 (0.3040) loss_oracle 0.3647 (0.3184) acc 50.0000 (56.7188) kd_loss 0.8488 (0.7471) lr 1.6845e-03 eta 0:33:42
epoch [15/50] batch [40/319] time 0.104 (0.138) data 0.000 (0.036) loss 2.2481 (2.2241) ce_loss 1.0488 (1.1621) loss_zs_kd 0.2701 (0.3172) loss_oracle 0.3463 (0.3208) acc 59.3750 (56.3281) kd_loss 0.8911 (0.7430) lr 1.6845e-03 eta 0:26:23
epoch [15/50] batch [60/319] time 0.110 (0.127) data 0.000 (0.024) loss 2.1453 (2.2102) ce_loss 1.2080 (1.1576) loss_zs_kd 0.3696 (0.3249) loss_oracle 0.3460 (0.3252) acc 50.0000 (55.9896) kd_loss 0.5795 (0.7275) lr 1.6845e-03 eta 0:24:07
epoch [15/50] batch [80/319] time 0.102 (0.120) data 0.000 (0.018) loss 2.0116 (2.2050) ce_loss 0.9712 (1.1532) loss_zs_kd 0.2918 (0.3242) loss_oracle 0.3232 (0.3280) acc 62.5000 (56.3672) kd_loss 0.7329 (0.7258) lr 1.6845e-03 eta 0:22:50
epoch [15/50] batch [100/319] time 0.108 (0.116) data 0.000 (0.015) loss 1.8477 (2.1965) ce_loss 0.9971 (1.1518) loss_zs_kd 0.2380 (0.3195) loss_oracle 0.3335 (0.3305) acc 65.6250 (56.8438) kd_loss 0.5649 (0.7197) lr 1.6845e-03 eta 0:22:04
epoch [15/50] batch [120/319] time 0.112 (0.114) data 0.000 (0.012) loss 1.9648 (2.1894) ce_loss 0.9609 (1.1546) loss_zs_kd 0.3161 (0.3177) loss_oracle 0.3209 (0.3291) acc 71.8750 (56.7448) kd_loss 0.6854 (0.7114) lr 1.6845e-03 eta 0:21:37
epoch [15/50] batch [140/319] time 0.097 (0.112) data 0.000 (0.010) loss 2.4914 (2.1850) ce_loss 1.2637 (1.1546) loss_zs_kd 0.4064 (0.3172) loss_oracle 0.4252 (0.3314) acc 46.8750 (56.8527) kd_loss 0.8119 (0.7060) lr 1.6845e-03 eta 0:21:14
epoch [15/50] batch [160/319] time 0.103 (0.111) data 0.000 (0.009) loss 1.9892 (2.1771) ce_loss 0.9287 (1.1460) loss_zs_kd 0.2673 (0.3155) loss_oracle 0.3867 (0.3318) acc 81.2500 (57.0508) kd_loss 0.7334 (0.7074) lr 1.6845e-03 eta 0:20:56
epoch [15/50] batch [180/319] time 0.090 (0.109) data 0.000 (0.008) loss 2.1062 (2.1627) ce_loss 1.1406 (1.1340) loss_zs_kd 0.2482 (0.3147) loss_oracle 0.3690 (0.3301) acc 56.2500 (57.5174) kd_loss 0.6570 (0.7064) lr 1.6845e-03 eta 0:20:29
epoch [15/50] batch [200/319] time 0.083 (0.106) data 0.000 (0.007) loss 2.4183 (2.1794) ce_loss 1.3818 (1.1450) loss_zs_kd 0.2719 (0.3169) loss_oracle 0.3796 (0.3312) acc 46.8750 (57.0469) kd_loss 0.7107 (0.7104) lr 1.6845e-03 eta 0:19:55
epoch [15/50] batch [220/319] time 0.160 (0.108) data 0.000 (0.007) loss 2.2488 (2.1817) ce_loss 1.2510 (1.1490) loss_zs_kd 0.2959 (0.3162) loss_oracle 0.3035 (0.3327) acc 56.2500 (56.9602) kd_loss 0.6981 (0.7083) lr 1.6845e-03 eta 0:20:17
epoch [15/50] batch [240/319] time 0.085 (0.106) data 0.000 (0.006) loss 2.2735 (2.1834) ce_loss 1.0469 (1.1473) loss_zs_kd 0.3374 (0.3157) loss_oracle 0.3963 (0.3333) acc 56.2500 (56.9661) kd_loss 0.8598 (0.7116) lr 1.6845e-03 eta 0:19:49
epoch [15/50] batch [260/319] time 0.209 (0.106) data 0.001 (0.006) loss 2.1995 (2.1937) ce_loss 1.1201 (1.1527) loss_zs_kd 0.2692 (0.3154) loss_oracle 0.3187 (0.3338) acc 46.8750 (56.6466) kd_loss 0.7854 (0.7164) lr 1.6845e-03 eta 0:19:54
epoch [15/50] batch [280/319] time 0.084 (0.105) data 0.000 (0.005) loss 2.3038 (2.2022) ce_loss 1.0449 (1.1558) loss_zs_kd 0.3055 (0.3152) loss_oracle 0.3597 (0.3337) acc 65.6250 (56.6183) kd_loss 0.9263 (0.7220) lr 1.6845e-03 eta 0:19:39
epoch [15/50] batch [300/319] time 0.105 (0.104) data 0.000 (0.005) loss 2.3359 (2.2042) ce_loss 1.3252 (1.1533) loss_zs_kd 0.2926 (0.3132) loss_oracle 0.3292 (0.3336) acc 40.6250 (56.7292) kd_loss 0.6998 (0.7276) lr 1.6845e-03 eta 0:19:22
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,571
* accuracy: 58.7%
* error: 41.3%
* macro_f1: 50.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,601
* accuracy: 47.3%
* error: 52.7%
* macro_f1: 22.5%
******* Domain 2 best val acc:      61.4%, epoch: 9 *******
******* Domain 2 best val test acc: 51.4%, epoch: 9 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [16/50] batch [20/319] time 0.097 (0.182) data 0.000 (0.083) loss 1.9510 (2.2241) ce_loss 0.9053 (1.1614) loss_zs_kd 0.2977 (0.2975) loss_oracle 0.3045 (0.3218) acc 62.5000 (56.5625) kd_loss 0.7447 (0.7531) lr 1.6374e-03 eta 0:33:53
epoch [16/50] batch [40/319] time 0.095 (0.141) data 0.000 (0.041) loss 2.3882 (2.2337) ce_loss 1.4229 (1.1485) loss_zs_kd 0.3011 (0.3027) loss_oracle 0.2731 (0.3293) acc 46.8750 (58.0469) kd_loss 0.6783 (0.7692) lr 1.6374e-03 eta 0:26:08
epoch [16/50] batch [60/319] time 0.107 (0.128) data 0.000 (0.028) loss 1.8999 (2.2479) ce_loss 0.8809 (1.1436) loss_zs_kd 0.3090 (0.3093) loss_oracle 0.2875 (0.3372) acc 71.8750 (58.2812) kd_loss 0.7207 (0.7811) lr 1.6374e-03 eta 0:23:40
epoch [16/50] batch [80/319] time 0.099 (0.121) data 0.000 (0.021) loss 2.0122 (2.2407) ce_loss 1.0869 (1.1409) loss_zs_kd 0.3137 (0.3078) loss_oracle 0.3524 (0.3398) acc 50.0000 (58.1250) kd_loss 0.5923 (0.7760) lr 1.6374e-03 eta 0:22:22
epoch [16/50] batch [100/319] time 0.106 (0.117) data 0.000 (0.017) loss 2.1505 (2.2511) ce_loss 1.1748 (1.1515) loss_zs_kd 0.2190 (0.3082) loss_oracle 0.4165 (0.3414) acc 53.1250 (57.3438) kd_loss 0.6580 (0.7748) lr 1.6374e-03 eta 0:21:34
epoch [16/50] batch [120/319] time 0.107 (0.114) data 0.000 (0.014) loss 2.2816 (2.2401) ce_loss 1.0762 (1.1400) loss_zs_kd 0.3374 (0.3065) loss_oracle 0.3440 (0.3425) acc 59.3750 (57.8125) kd_loss 0.8647 (0.7756) lr 1.6374e-03 eta 0:20:59
epoch [16/50] batch [140/319] time 0.110 (0.112) data 0.000 (0.012) loss 2.0803 (2.2514) ce_loss 0.9790 (1.1513) loss_zs_kd 0.3680 (0.3077) loss_oracle 0.2620 (0.3414) acc 71.8750 (57.3214) kd_loss 0.7864 (0.7756) lr 1.6374e-03 eta 0:20:39
epoch [16/50] batch [160/319] time 0.105 (0.111) data 0.000 (0.011) loss 2.1280 (2.2654) ce_loss 0.9653 (1.1585) loss_zs_kd 0.3510 (0.3111) loss_oracle 0.2496 (0.3423) acc 68.7500 (57.1484) kd_loss 0.8624 (0.7802) lr 1.6374e-03 eta 0:20:25
epoch [16/50] batch [180/319] time 0.079 (0.110) data 0.000 (0.009) loss 2.2592 (2.2653) ce_loss 1.0947 (1.1520) loss_zs_kd 0.2916 (0.3105) loss_oracle 0.3894 (0.3448) acc 56.2500 (57.2222) kd_loss 0.8240 (0.7857) lr 1.6374e-03 eta 0:20:06
epoch [16/50] batch [200/319] time 0.076 (0.107) data 0.000 (0.009) loss 2.3265 (2.2709) ce_loss 1.1201 (1.1531) loss_zs_kd 0.2370 (0.3090) loss_oracle 0.3546 (0.3442) acc 65.6250 (57.0156) kd_loss 0.9106 (0.7913) lr 1.6374e-03 eta 0:19:34
epoch [16/50] batch [220/319] time 0.089 (0.105) data 0.000 (0.008) loss 2.1632 (2.2704) ce_loss 1.0625 (1.1537) loss_zs_kd 0.2796 (0.3083) loss_oracle 0.3414 (0.3430) acc 53.1250 (56.7614) kd_loss 0.7902 (0.7911) lr 1.6374e-03 eta 0:19:09
epoch [16/50] batch [240/319] time 0.076 (0.107) data 0.000 (0.007) loss 2.2190 (2.2745) ce_loss 1.1406 (1.1555) loss_zs_kd 0.3930 (0.3106) loss_oracle 0.3140 (0.3417) acc 65.6250 (56.8359) kd_loss 0.7249 (0.7929) lr 1.6374e-03 eta 0:19:31
epoch [16/50] batch [260/319] time 0.085 (0.105) data 0.000 (0.007) loss 2.0681 (2.2759) ce_loss 0.9253 (1.1565) loss_zs_kd 0.2932 (0.3095) loss_oracle 0.2772 (0.3401) acc 59.3750 (56.7188) kd_loss 0.8577 (0.7946) lr 1.6374e-03 eta 0:19:07
epoch [16/50] batch [280/319] time 0.162 (0.106) data 0.000 (0.006) loss 2.5974 (2.2832) ce_loss 1.3369 (1.1583) loss_zs_kd 0.3079 (0.3097) loss_oracle 0.3390 (0.3383) acc 50.0000 (56.7634) kd_loss 0.9370 (0.8008) lr 1.6374e-03 eta 0:19:11
epoch [16/50] batch [300/319] time 0.085 (0.104) data 0.000 (0.006) loss 2.3077 (2.2871) ce_loss 1.1455 (1.1560) loss_zs_kd 0.3501 (0.3109) loss_oracle 0.3520 (0.3380) acc 65.6250 (56.9375) kd_loss 0.8112 (0.8067) lr 1.6374e-03 eta 0:18:55
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,532
* accuracy: 57.8%
* error: 42.2%
* macro_f1: 48.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,489
* accuracy: 46.1%
* error: 53.9%
* macro_f1: 20.8%
******* Domain 2 best val acc:      61.4%, epoch: 9 *******
******* Domain 2 best val test acc: 51.4%, epoch: 9 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [17/50] batch [20/319] time 0.069 (0.168) data 0.000 (0.078) loss 2.1820 (2.2965) ce_loss 0.9995 (1.1225) loss_zs_kd 0.4507 (0.2983) loss_oracle 0.2873 (0.3450) acc 68.7500 (57.5000) kd_loss 0.8135 (0.8523) lr 1.5878e-03 eta 0:30:17
epoch [17/50] batch [40/319] time 0.065 (0.118) data 0.000 (0.039) loss 2.2966 (2.3076) ce_loss 1.1611 (1.1291) loss_zs_kd 0.3188 (0.3205) loss_oracle 0.2981 (0.3384) acc 53.1250 (58.5156) kd_loss 0.8271 (0.8490) lr 1.5878e-03 eta 0:21:13
epoch [17/50] batch [60/319] time 0.095 (0.100) data 0.000 (0.026) loss 2.4319 (2.2944) ce_loss 1.4365 (1.1392) loss_zs_kd 0.2679 (0.3149) loss_oracle 0.3072 (0.3334) acc 46.8750 (57.8125) kd_loss 0.7078 (0.8310) lr 1.5878e-03 eta 0:17:58
epoch [17/50] batch [80/319] time 0.099 (0.100) data 0.000 (0.020) loss 2.2195 (2.2682) ce_loss 0.9585 (1.1290) loss_zs_kd 0.3410 (0.3094) loss_oracle 0.3038 (0.3301) acc 62.5000 (57.9688) kd_loss 0.9386 (0.8195) lr 1.5878e-03 eta 0:18:01
epoch [17/50] batch [100/319] time 0.102 (0.101) data 0.000 (0.016) loss 2.3716 (2.2656) ce_loss 1.1826 (1.1386) loss_zs_kd 0.3867 (0.3070) loss_oracle 0.3391 (0.3278) acc 56.2500 (57.6250) kd_loss 0.8261 (0.8096) lr 1.5878e-03 eta 0:18:01
epoch [17/50] batch [120/319] time 0.106 (0.101) data 0.000 (0.013) loss 2.1635 (2.2668) ce_loss 1.0947 (1.1504) loss_zs_kd 0.3292 (0.3030) loss_oracle 0.3289 (0.3268) acc 53.1250 (57.1354) kd_loss 0.7397 (0.8015) lr 1.5878e-03 eta 0:18:00
epoch [17/50] batch [140/319] time 0.100 (0.100) data 0.000 (0.011) loss 2.3577 (2.2614) ce_loss 1.2637 (1.1549) loss_zs_kd 0.3613 (0.3039) loss_oracle 0.3139 (0.3264) acc 53.1250 (56.9643) kd_loss 0.7565 (0.7914) lr 1.5878e-03 eta 0:17:54
epoch [17/50] batch [160/319] time 0.091 (0.100) data 0.000 (0.010) loss 1.9584 (2.2519) ce_loss 0.9043 (1.1538) loss_zs_kd 0.2931 (0.3061) loss_oracle 0.2804 (0.3250) acc 65.6250 (56.9922) kd_loss 0.7674 (0.7825) lr 1.5878e-03 eta 0:17:51
epoch [17/50] batch [180/319] time 0.089 (0.101) data 0.000 (0.009) loss 2.0272 (2.2432) ce_loss 1.0098 (1.1526) loss_zs_kd 0.3306 (0.3099) loss_oracle 0.3969 (0.3268) acc 62.5000 (57.1181) kd_loss 0.6537 (0.7722) lr 1.5878e-03 eta 0:17:57
epoch [17/50] batch [200/319] time 0.093 (0.101) data 0.000 (0.008) loss 1.9766 (2.2372) ce_loss 0.8853 (1.1546) loss_zs_kd 0.3116 (0.3102) loss_oracle 0.3348 (0.3269) acc 68.7500 (57.0312) kd_loss 0.7682 (0.7640) lr 1.5878e-03 eta 0:17:50
epoch [17/50] batch [220/319] time 0.089 (0.100) data 0.000 (0.007) loss 2.0762 (2.2433) ce_loss 1.0889 (1.1617) loss_zs_kd 0.4024 (0.3104) loss_oracle 0.3404 (0.3295) acc 62.5000 (56.7614) kd_loss 0.6159 (0.7616) lr 1.5878e-03 eta 0:17:47
epoch [17/50] batch [240/319] time 0.074 (0.100) data 0.000 (0.007) loss 2.3113 (2.2445) ce_loss 1.2188 (1.1607) loss_zs_kd 0.3925 (0.3109) loss_oracle 0.2927 (0.3299) acc 53.1250 (56.7188) kd_loss 0.7499 (0.7633) lr 1.5878e-03 eta 0:17:35
epoch [17/50] batch [260/319] time 0.086 (0.098) data 0.000 (0.006) loss 2.4317 (2.2434) ce_loss 1.2588 (1.1609) loss_zs_kd 0.3265 (0.3124) loss_oracle 0.3115 (0.3297) acc 46.8750 (56.6106) kd_loss 0.8539 (0.7615) lr 1.5878e-03 eta 0:17:21
epoch [17/50] batch [280/319] time 0.178 (0.100) data 0.000 (0.006) loss 2.1257 (2.2450) ce_loss 0.8584 (1.1582) loss_zs_kd 0.3422 (0.3112) loss_oracle 0.4475 (0.3298) acc 65.6250 (56.5067) kd_loss 0.8725 (0.7663) lr 1.5878e-03 eta 0:17:32
epoch [17/50] batch [300/319] time 0.080 (0.100) data 0.000 (0.005) loss 2.1991 (2.2450) ce_loss 1.1689 (1.1573) loss_zs_kd 0.3621 (0.3124) loss_oracle 0.3539 (0.3294) acc 53.1250 (56.6562) kd_loss 0.6722 (0.7668) lr 1.5878e-03 eta 0:17:32
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,620
* accuracy: 59.8%
* error: 40.2%
* macro_f1: 50.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,642
* accuracy: 47.7%
* error: 52.3%
* macro_f1: 23.0%
******* Domain 2 best val acc:      61.4%, epoch: 9 *******
******* Domain 2 best val test acc: 51.4%, epoch: 9 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [18/50] batch [20/319] time 0.069 (0.169) data 0.000 (0.084) loss 2.2614 (2.2119) ce_loss 1.0771 (1.1146) loss_zs_kd 0.2685 (0.3036) loss_oracle 0.2746 (0.3038) acc 59.3750 (59.0625) kd_loss 0.9127 (0.7936) lr 1.5358e-03 eta 0:29:40
epoch [18/50] batch [40/319] time 0.100 (0.129) data 0.000 (0.042) loss 1.8961 (2.2134) ce_loss 0.9604 (1.1193) loss_zs_kd 0.3343 (0.3044) loss_oracle 0.2931 (0.3013) acc 56.2500 (57.9688) kd_loss 0.6220 (0.7912) lr 1.5358e-03 eta 0:22:37
epoch [18/50] batch [60/319] time 0.100 (0.120) data 0.000 (0.028) loss 2.3987 (2.2029) ce_loss 1.1729 (1.1165) loss_zs_kd 0.3365 (0.3073) loss_oracle 0.2559 (0.2963) acc 53.1250 (58.2812) kd_loss 0.9297 (0.7845) lr 1.5358e-03 eta 0:20:55
epoch [18/50] batch [80/319] time 0.100 (0.115) data 0.000 (0.021) loss 2.0926 (2.2158) ce_loss 1.0820 (1.1277) loss_zs_kd 0.3520 (0.3109) loss_oracle 0.3417 (0.2972) acc 62.5000 (57.8516) kd_loss 0.6637 (0.7840) lr 1.5358e-03 eta 0:19:57
epoch [18/50] batch [100/319] time 0.096 (0.112) data 0.000 (0.017) loss 2.0883 (2.2361) ce_loss 0.8340 (1.1276) loss_zs_kd 0.2858 (0.3103) loss_oracle 0.3185 (0.3054) acc 75.0000 (58.0625) kd_loss 0.9522 (0.8007) lr 1.5358e-03 eta 0:19:28
epoch [18/50] batch [120/319] time 0.082 (0.110) data 0.000 (0.014) loss 2.4691 (2.2566) ce_loss 1.2432 (1.1375) loss_zs_kd 0.4663 (0.3139) loss_oracle 0.3580 (0.3103) acc 53.1250 (57.6302) kd_loss 0.8137 (0.8070) lr 1.5358e-03 eta 0:19:02
epoch [18/50] batch [140/319] time 0.094 (0.106) data 0.000 (0.012) loss 2.2720 (2.2606) ce_loss 1.0488 (1.1346) loss_zs_kd 0.3414 (0.3149) loss_oracle 0.3572 (0.3122) acc 62.5000 (57.9241) kd_loss 0.8739 (0.8125) lr 1.5358e-03 eta 0:18:25
epoch [18/50] batch [160/319] time 0.083 (0.108) data 0.000 (0.011) loss 2.4585 (2.2743) ce_loss 1.2930 (1.1407) loss_zs_kd 0.3184 (0.3122) loss_oracle 0.2886 (0.3148) acc 59.3750 (57.4609) kd_loss 0.8620 (0.8201) lr 1.5358e-03 eta 0:18:38
epoch [18/50] batch [180/319] time 0.151 (0.111) data 0.000 (0.010) loss 2.3945 (2.2789) ce_loss 1.1592 (1.1411) loss_zs_kd 0.3423 (0.3136) loss_oracle 0.3721 (0.3156) acc 59.3750 (57.5000) kd_loss 0.8781 (0.8232) lr 1.5358e-03 eta 0:19:12
epoch [18/50] batch [200/319] time 0.091 (0.111) data 0.000 (0.009) loss 2.3502 (2.2825) ce_loss 1.1533 (1.1426) loss_zs_kd 0.3079 (0.3135) loss_oracle 0.2595 (0.3166) acc 56.2500 (57.3125) kd_loss 0.9132 (0.8249) lr 1.5358e-03 eta 0:19:06
epoch [18/50] batch [220/319] time 0.095 (0.110) data 0.000 (0.008) loss 2.6432 (2.2907) ce_loss 1.2773 (1.1460) loss_zs_kd 0.2957 (0.3138) loss_oracle 0.3119 (0.3176) acc 46.8750 (57.1449) kd_loss 1.0621 (0.8290) lr 1.5358e-03 eta 0:18:52
epoch [18/50] batch [240/319] time 0.094 (0.109) data 0.000 (0.007) loss 2.3682 (2.2930) ce_loss 1.1191 (1.1451) loss_zs_kd 0.2743 (0.3129) loss_oracle 0.3614 (0.3190) acc 53.1250 (57.0573) kd_loss 0.9312 (0.8320) lr 1.5358e-03 eta 0:18:39
epoch [18/50] batch [260/319] time 0.096 (0.108) data 0.000 (0.007) loss 2.4637 (2.2985) ce_loss 1.2129 (1.1451) loss_zs_kd 0.3688 (0.3145) loss_oracle 0.3863 (0.3223) acc 43.7500 (56.8389) kd_loss 0.8733 (0.8350) lr 1.5358e-03 eta 0:18:25
epoch [18/50] batch [280/319] time 0.097 (0.107) data 0.000 (0.006) loss 2.3029 (2.3033) ce_loss 1.2266 (1.1480) loss_zs_kd 0.3083 (0.3157) loss_oracle 0.3328 (0.3226) acc 62.5000 (56.6964) kd_loss 0.7558 (0.8361) lr 1.5358e-03 eta 0:18:16
epoch [18/50] batch [300/319] time 0.069 (0.106) data 0.000 (0.006) loss 2.2556 (2.3096) ce_loss 1.0127 (1.1506) loss_zs_kd 0.3807 (0.3164) loss_oracle 0.3583 (0.3237) acc 62.5000 (56.6042) kd_loss 0.8734 (0.8389) lr 1.5358e-03 eta 0:18:03
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,646
* accuracy: 60.4%
* error: 39.6%
* macro_f1: 51.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,867
* accuracy: 50.0%
* error: 50.0%
* macro_f1: 22.3%
******* Domain 2 best val acc:      61.4%, epoch: 9 *******
******* Domain 2 best val test acc: 51.4%, epoch: 9 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [19/50] batch [20/319] time 0.101 (0.205) data 0.000 (0.103) loss 2.1383 (2.3928) ce_loss 0.9429 (1.1247) loss_zs_kd 0.2979 (0.3202) loss_oracle 0.2960 (0.3229) acc 62.5000 (57.1875) kd_loss 0.8985 (0.9466) lr 1.4818e-03 eta 0:34:43
epoch [19/50] batch [40/319] time 0.113 (0.153) data 0.001 (0.052) loss 2.4000 (2.4357) ce_loss 1.1191 (1.1298) loss_zs_kd 0.3142 (0.3183) loss_oracle 0.3742 (0.3360) acc 50.0000 (57.6562) kd_loss 0.9366 (0.9788) lr 1.4818e-03 eta 0:25:52
epoch [19/50] batch [60/319] time 0.094 (0.135) data 0.000 (0.034) loss 2.3823 (2.4751) ce_loss 0.9717 (1.1321) loss_zs_kd 0.2340 (0.3237) loss_oracle 0.3673 (0.3369) acc 68.7500 (57.5521) kd_loss 1.1099 (1.0127) lr 1.4818e-03 eta 0:22:51
epoch [19/50] batch [80/319] time 0.102 (0.126) data 0.000 (0.026) loss 2.7643 (2.4976) ce_loss 1.2422 (1.1375) loss_zs_kd 0.3622 (0.3144) loss_oracle 0.3771 (0.3345) acc 50.0000 (57.1875) kd_loss 1.1524 (1.0357) lr 1.4818e-03 eta 0:21:18
epoch [19/50] batch [100/319] time 0.104 (0.121) data 0.000 (0.021) loss 2.5493 (2.5131) ce_loss 1.1650 (1.1435) loss_zs_kd 0.3278 (0.3174) loss_oracle 0.3619 (0.3324) acc 53.1250 (57.1875) kd_loss 1.0394 (1.0446) lr 1.4818e-03 eta 0:20:23
epoch [19/50] batch [120/319] time 0.102 (0.118) data 0.000 (0.017) loss 2.5654 (2.5086) ce_loss 1.4229 (1.1427) loss_zs_kd 0.2350 (0.3153) loss_oracle 0.3775 (0.3339) acc 40.6250 (57.0833) kd_loss 0.8363 (1.0413) lr 1.4818e-03 eta 0:19:50
epoch [19/50] batch [140/319] time 0.164 (0.116) data 0.000 (0.015) loss 2.3727 (2.5036) ce_loss 1.0518 (1.1428) loss_zs_kd 0.2935 (0.3147) loss_oracle 0.3754 (0.3349) acc 56.2500 (57.0089) kd_loss 0.9864 (1.0360) lr 1.4818e-03 eta 0:19:24
epoch [19/50] batch [160/319] time 0.153 (0.116) data 0.000 (0.013) loss 2.4444 (2.4908) ce_loss 1.2822 (1.1385) loss_zs_kd 0.2888 (0.3159) loss_oracle 0.3689 (0.3348) acc 43.7500 (57.4219) kd_loss 0.8334 (1.0269) lr 1.4818e-03 eta 0:19:28
epoch [19/50] batch [180/319] time 0.063 (0.120) data 0.000 (0.012) loss 2.3318 (2.4742) ce_loss 0.9336 (1.1322) loss_zs_kd 0.2818 (0.3165) loss_oracle 0.3592 (0.3373) acc 62.5000 (57.7257) kd_loss 1.0777 (1.0151) lr 1.4818e-03 eta 0:19:58
epoch [19/50] batch [200/319] time 0.106 (0.117) data 0.000 (0.011) loss 2.2466 (2.4623) ce_loss 1.0908 (1.1315) loss_zs_kd 0.2976 (0.3175) loss_oracle 0.3583 (0.3391) acc 59.3750 (57.8281) kd_loss 0.8278 (1.0025) lr 1.4818e-03 eta 0:19:34
epoch [19/50] batch [220/319] time 0.104 (0.116) data 0.000 (0.010) loss 2.3021 (2.4467) ce_loss 1.1660 (1.1273) loss_zs_kd 0.2805 (0.3176) loss_oracle 0.3636 (0.3389) acc 56.2500 (58.0398) kd_loss 0.8140 (0.9912) lr 1.4818e-03 eta 0:19:15
epoch [19/50] batch [240/319] time 0.102 (0.114) data 0.000 (0.009) loss 2.4865 (2.4401) ce_loss 1.2539 (1.1292) loss_zs_kd 0.2989 (0.3163) loss_oracle 0.3671 (0.3374) acc 46.8750 (58.1510) kd_loss 0.8996 (0.9840) lr 1.4818e-03 eta 0:18:59
epoch [19/50] batch [260/319] time 0.096 (0.113) data 0.000 (0.008) loss 2.4543 (2.4297) ce_loss 1.2939 (1.1309) loss_zs_kd 0.2780 (0.3158) loss_oracle 0.3186 (0.3366) acc 59.3750 (58.1010) kd_loss 0.8620 (0.9726) lr 1.4818e-03 eta 0:18:44
epoch [19/50] batch [280/319] time 0.101 (0.112) data 0.000 (0.008) loss 2.0419 (2.4208) ce_loss 1.0469 (1.1316) loss_zs_kd 0.2955 (0.3155) loss_oracle 0.2660 (0.3362) acc 56.2500 (57.9464) kd_loss 0.7143 (0.9634) lr 1.4818e-03 eta 0:18:33
epoch [19/50] batch [300/319] time 0.099 (0.111) data 0.000 (0.007) loss 2.4172 (2.4091) ce_loss 1.2598 (1.1326) loss_zs_kd 0.3201 (0.3152) loss_oracle 0.3332 (0.3361) acc 50.0000 (57.8229) kd_loss 0.8308 (0.9509) lr 1.4818e-03 eta 0:18:20
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,716
* accuracy: 62.0%
* error: 38.0%
* macro_f1: 53.3%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,922
* accuracy: 50.6%
* error: 49.4%
* macro_f1: 22.3%
******* Domain 2 best val acc:      62.0%, epoch: 19 *******
******* Domain 2 best val test acc: 50.6%, epoch: 19 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [20/50] batch [20/319] time 0.094 (0.224) data 0.000 (0.121) loss 2.3062 (2.2716) ce_loss 1.1436 (1.1475) loss_zs_kd 0.2858 (0.3250) loss_oracle 0.2899 (0.3299) acc 53.1250 (58.1250) kd_loss 0.8748 (0.7967) lr 1.4258e-03 eta 0:36:54
epoch [20/50] batch [40/319] time 0.093 (0.160) data 0.000 (0.060) loss 2.2779 (2.3000) ce_loss 1.0254 (1.1292) loss_zs_kd 0.2894 (0.3170) loss_oracle 0.3105 (0.3356) acc 53.1250 (57.7344) kd_loss 0.9525 (0.8445) lr 1.4258e-03 eta 0:26:16
epoch [20/50] batch [60/319] time 0.094 (0.139) data 0.000 (0.040) loss 2.0736 (2.3355) ce_loss 0.8584 (1.1557) loss_zs_kd 0.2100 (0.3101) loss_oracle 0.2667 (0.3285) acc 68.7500 (56.5104) kd_loss 0.9769 (0.8604) lr 1.4258e-03 eta 0:22:49
epoch [20/50] batch [80/319] time 0.107 (0.129) data 0.000 (0.030) loss 2.2387 (2.3433) ce_loss 1.0947 (1.1479) loss_zs_kd 0.3888 (0.3108) loss_oracle 0.3317 (0.3267) acc 62.5000 (57.2656) kd_loss 0.7837 (0.8766) lr 1.4258e-03 eta 0:21:09
epoch [20/50] batch [100/319] time 0.092 (0.123) data 0.000 (0.024) loss 2.3569 (2.3462) ce_loss 1.1123 (1.1371) loss_zs_kd 0.2796 (0.3151) loss_oracle 0.3389 (0.3280) acc 53.1250 (57.8438) kd_loss 0.9353 (0.8876) lr 1.4258e-03 eta 0:20:01
epoch [20/50] batch [120/319] time 0.080 (0.123) data 0.000 (0.020) loss 2.3479 (2.3416) ce_loss 1.1396 (1.1289) loss_zs_kd 0.3017 (0.3145) loss_oracle 0.3181 (0.3271) acc 46.8750 (57.9167) kd_loss 0.8983 (0.8918) lr 1.4258e-03 eta 0:19:59
epoch [20/50] batch [140/319] time 0.156 (0.122) data 0.000 (0.017) loss 2.2042 (2.3409) ce_loss 0.9717 (1.1258) loss_zs_kd 0.2851 (0.3182) loss_oracle 0.2794 (0.3249) acc 62.5000 (58.1250) kd_loss 0.9503 (0.8935) lr 1.4258e-03 eta 0:19:44
epoch [20/50] batch [160/319] time 0.084 (0.123) data 0.000 (0.015) loss 2.3406 (2.3505) ce_loss 1.0713 (1.1257) loss_zs_kd 0.3576 (0.3172) loss_oracle 0.3374 (0.3266) acc 65.6250 (57.8906) kd_loss 0.9218 (0.9029) lr 1.4258e-03 eta 0:19:52
epoch [20/50] batch [180/319] time 0.106 (0.120) data 0.000 (0.014) loss 2.4786 (2.3635) ce_loss 1.3135 (1.1338) loss_zs_kd 0.3500 (0.3162) loss_oracle 0.3085 (0.3259) acc 46.8750 (57.2917) kd_loss 0.8359 (0.9086) lr 1.4258e-03 eta 0:19:26
epoch [20/50] batch [200/319] time 0.094 (0.118) data 0.000 (0.012) loss 2.5999 (2.3704) ce_loss 1.2549 (1.1348) loss_zs_kd 0.4102 (0.3159) loss_oracle 0.3223 (0.3264) acc 59.3750 (57.0156) kd_loss 0.9788 (0.9144) lr 1.4258e-03 eta 0:19:07
epoch [20/50] batch [220/319] time 0.093 (0.117) data 0.000 (0.011) loss 2.3703 (2.3690) ce_loss 1.1191 (1.1319) loss_zs_kd 0.2868 (0.3173) loss_oracle 0.3251 (0.3250) acc 78.1250 (57.3295) kd_loss 0.9452 (0.9160) lr 1.4258e-03 eta 0:18:48
epoch [20/50] batch [240/319] time 0.099 (0.116) data 0.000 (0.010) loss 2.3491 (2.3746) ce_loss 1.0801 (1.1356) loss_zs_kd 0.2992 (0.3167) loss_oracle 0.2826 (0.3250) acc 65.6250 (57.1354) kd_loss 0.9781 (0.9181) lr 1.4258e-03 eta 0:18:34
epoch [20/50] batch [260/319] time 0.110 (0.114) data 0.000 (0.010) loss 2.4202 (2.3775) ce_loss 1.1025 (1.1319) loss_zs_kd 0.2460 (0.3161) loss_oracle 0.3662 (0.3257) acc 56.2500 (57.3558) kd_loss 1.0116 (0.9248) lr 1.4258e-03 eta 0:18:20
epoch [20/50] batch [280/319] time 0.105 (0.113) data 0.000 (0.009) loss 2.4654 (2.3852) ce_loss 1.1328 (1.1335) loss_zs_kd 0.3203 (0.3156) loss_oracle 0.3065 (0.3262) acc 75.0000 (57.4107) kd_loss 1.0192 (0.9308) lr 1.4258e-03 eta 0:18:10
epoch [20/50] batch [300/319] time 0.080 (0.112) data 0.000 (0.008) loss 2.3115 (2.3892) ce_loss 1.0938 (1.1342) loss_zs_kd 0.3537 (0.3146) loss_oracle 0.3958 (0.3270) acc 56.2500 (57.4271) kd_loss 0.8430 (0.9343) lr 1.4258e-03 eta 0:17:54
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,723
* accuracy: 62.2%
* error: 37.8%
* macro_f1: 52.6%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,844
* accuracy: 49.8%
* error: 50.2%
* macro_f1: 22.6%
******* Domain 2 best val acc:      62.2%, epoch: 20 *******
******* Domain 2 best val test acc: 49.8%, epoch: 20 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [21/50] batch [20/319] time 0.092 (0.226) data 0.000 (0.119) loss 2.4538 (2.3659) ce_loss 1.1709 (1.1024) loss_zs_kd 0.3614 (0.3526) loss_oracle 0.3144 (0.3295) acc 43.7500 (57.8125) kd_loss 0.9450 (0.9225) lr 1.3681e-03 eta 0:35:53
epoch [21/50] batch [40/319] time 0.107 (0.164) data 0.000 (0.060) loss 2.4711 (2.4115) ce_loss 1.2139 (1.1244) loss_zs_kd 0.2706 (0.3430) loss_oracle 0.3223 (0.3268) acc 59.3750 (57.3438) kd_loss 0.9608 (0.9522) lr 1.3681e-03 eta 0:25:58
epoch [21/50] batch [60/319] time 0.106 (0.142) data 0.000 (0.040) loss 2.2574 (2.4111) ce_loss 0.9854 (1.1237) loss_zs_kd 0.4407 (0.3411) loss_oracle 0.3598 (0.3322) acc 59.3750 (57.1354) kd_loss 0.8718 (0.9508) lr 1.3681e-03 eta 0:22:33
epoch [21/50] batch [80/319] time 0.096 (0.132) data 0.000 (0.030) loss 2.0368 (2.4050) ce_loss 0.8984 (1.1257) loss_zs_kd 0.2503 (0.3346) loss_oracle 0.3464 (0.3377) acc 78.1250 (56.7969) kd_loss 0.8401 (0.9432) lr 1.3681e-03 eta 0:20:53
epoch [21/50] batch [100/319] time 0.176 (0.123) data 0.000 (0.024) loss 2.3814 (2.3996) ce_loss 1.1006 (1.1310) loss_zs_kd 0.2943 (0.3268) loss_oracle 0.3040 (0.3352) acc 62.5000 (56.6250) kd_loss 0.9817 (0.9376) lr 1.3681e-03 eta 0:19:27
epoch [21/50] batch [120/319] time 0.084 (0.122) data 0.000 (0.020) loss 2.0890 (2.3829) ce_loss 0.9883 (1.1252) loss_zs_kd 0.3292 (0.3292) loss_oracle 0.2855 (0.3324) acc 62.5000 (57.1094) kd_loss 0.7933 (0.9269) lr 1.3681e-03 eta 0:19:10
epoch [21/50] batch [140/319] time 0.165 (0.128) data 0.000 (0.017) loss 2.5900 (2.3711) ce_loss 1.3027 (1.1185) loss_zs_kd 0.3822 (0.3275) loss_oracle 0.3418 (0.3326) acc 46.8750 (57.5446) kd_loss 0.9252 (0.9225) lr 1.3681e-03 eta 0:20:08
epoch [21/50] batch [160/319] time 0.107 (0.124) data 0.000 (0.015) loss 2.2838 (2.3653) ce_loss 1.0625 (1.1205) loss_zs_kd 0.2918 (0.3242) loss_oracle 0.3320 (0.3327) acc 65.6250 (57.7930) kd_loss 0.9094 (0.9163) lr 1.3681e-03 eta 0:19:25
epoch [21/50] batch [180/319] time 0.107 (0.122) data 0.000 (0.014) loss 2.4893 (2.3574) ce_loss 1.2295 (1.1202) loss_zs_kd 0.3048 (0.3213) loss_oracle 0.4177 (0.3326) acc 53.1250 (57.7951) kd_loss 0.8986 (0.9103) lr 1.3681e-03 eta 0:19:03
epoch [21/50] batch [200/319] time 0.108 (0.120) data 0.000 (0.012) loss 2.7428 (2.3588) ce_loss 1.4863 (1.1263) loss_zs_kd 0.3671 (0.3207) loss_oracle 0.4082 (0.3333) acc 59.3750 (57.6875) kd_loss 0.8688 (0.9055) lr 1.3681e-03 eta 0:18:43
epoch [21/50] batch [220/319] time 0.111 (0.118) data 0.000 (0.011) loss 2.3570 (2.3507) ce_loss 1.1211 (1.1238) loss_zs_kd 0.2737 (0.3214) loss_oracle 0.3498 (0.3365) acc 56.2500 (57.8977) kd_loss 0.9241 (0.8979) lr 1.3681e-03 eta 0:18:27
epoch [21/50] batch [240/319] time 0.101 (0.117) data 0.000 (0.010) loss 2.2309 (2.3473) ce_loss 0.9683 (1.1221) loss_zs_kd 0.3217 (0.3210) loss_oracle 0.3442 (0.3369) acc 53.1250 (57.9036) kd_loss 0.9297 (0.8962) lr 1.3681e-03 eta 0:18:14
epoch [21/50] batch [260/319] time 0.110 (0.116) data 0.000 (0.009) loss 2.4478 (2.3535) ce_loss 1.2129 (1.1302) loss_zs_kd 0.3563 (0.3206) loss_oracle 0.3381 (0.3369) acc 56.2500 (57.5601) kd_loss 0.8877 (0.8945) lr 1.3681e-03 eta 0:18:01
epoch [21/50] batch [280/319] time 0.092 (0.115) data 0.000 (0.009) loss 2.3497 (2.3540) ce_loss 1.1143 (1.1330) loss_zs_kd 0.2824 (0.3199) loss_oracle 0.3316 (0.3377) acc 56.2500 (57.2321) kd_loss 0.9284 (0.8922) lr 1.3681e-03 eta 0:17:44
epoch [21/50] batch [300/319] time 0.116 (0.114) data 0.000 (0.008) loss 2.3710 (2.3552) ce_loss 0.9746 (1.1300) loss_zs_kd 0.3323 (0.3194) loss_oracle 0.3596 (0.3372) acc 59.3750 (57.4271) kd_loss 1.0504 (0.8969) lr 1.3681e-03 eta 0:17:37
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,735
* accuracy: 62.5%
* error: 37.5%
* macro_f1: 52.5%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,832
* accuracy: 49.6%
* error: 50.4%
* macro_f1: 22.3%
******* Domain 2 best val acc:      62.5%, epoch: 21 *******
******* Domain 2 best val test acc: 49.6%, epoch: 21 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [22/50] batch [20/319] time 0.082 (0.215) data 0.000 (0.128) loss 2.0034 (2.3733) ce_loss 1.0439 (1.0774) loss_zs_kd 0.4523 (0.3399) loss_oracle 0.3615 (0.3321) acc 59.3750 (61.2500) kd_loss 0.5526 (0.9600) lr 1.3090e-03 eta 0:33:03
epoch [22/50] batch [40/319] time 0.103 (0.153) data 0.000 (0.064) loss 2.3454 (2.3611) ce_loss 1.0771 (1.0818) loss_zs_kd 0.3814 (0.3348) loss_oracle 0.2704 (0.3292) acc 59.3750 (60.6250) kd_loss 0.9424 (0.9473) lr 1.3090e-03 eta 0:23:26
epoch [22/50] batch [60/319] time 0.097 (0.135) data 0.000 (0.043) loss 2.3971 (2.3738) ce_loss 1.0479 (1.1036) loss_zs_kd 0.2999 (0.3257) loss_oracle 0.3470 (0.3263) acc 53.1250 (59.2708) kd_loss 1.0258 (0.9441) lr 1.3090e-03 eta 0:20:38
epoch [22/50] batch [80/319] time 0.095 (0.126) data 0.000 (0.032) loss 2.6043 (2.3649) ce_loss 1.4785 (1.1037) loss_zs_kd 0.3296 (0.3240) loss_oracle 0.3264 (0.3258) acc 40.6250 (59.2969) kd_loss 0.7977 (0.9363) lr 1.3090e-03 eta 0:19:11
epoch [22/50] batch [100/319] time 0.093 (0.119) data 0.000 (0.026) loss 2.1719 (2.3518) ce_loss 0.9751 (1.1091) loss_zs_kd 0.3048 (0.3203) loss_oracle 0.3399 (0.3250) acc 56.2500 (58.7188) kd_loss 0.8745 (0.9202) lr 1.3090e-03 eta 0:18:04
epoch [22/50] batch [120/319] time 0.077 (0.118) data 0.000 (0.021) loss 2.7293 (2.3448) ce_loss 1.4600 (1.1074) loss_zs_kd 0.3138 (0.3209) loss_oracle 0.3473 (0.3263) acc 43.7500 (58.7500) kd_loss 0.9388 (0.9138) lr 1.3090e-03 eta 0:17:59
epoch [22/50] batch [140/319] time 0.175 (0.123) data 0.000 (0.018) loss 2.3923 (2.3459) ce_loss 1.1758 (1.1128) loss_zs_kd 0.2688 (0.3264) loss_oracle 0.2792 (0.3259) acc 62.5000 (58.6607) kd_loss 0.9425 (0.9070) lr 1.3090e-03 eta 0:18:45
epoch [22/50] batch [160/319] time 0.108 (0.120) data 0.000 (0.016) loss 2.2944 (2.3547) ce_loss 1.2061 (1.1161) loss_zs_kd 0.2446 (0.3240) loss_oracle 0.3118 (0.3258) acc 56.2500 (58.7500) kd_loss 0.8101 (0.9137) lr 1.3090e-03 eta 0:18:12
epoch [22/50] batch [180/319] time 0.104 (0.119) data 0.000 (0.014) loss 2.8895 (2.3605) ce_loss 1.3936 (1.1111) loss_zs_kd 0.3500 (0.3235) loss_oracle 0.3892 (0.3267) acc 56.2500 (59.0104) kd_loss 1.1264 (0.9244) lr 1.3090e-03 eta 0:17:55
epoch [22/50] batch [200/319] time 0.109 (0.117) data 0.000 (0.013) loss 2.4681 (2.3707) ce_loss 1.1465 (1.1141) loss_zs_kd 0.2927 (0.3228) loss_oracle 0.2877 (0.3268) acc 62.5000 (58.8594) kd_loss 1.0314 (0.9318) lr 1.3090e-03 eta 0:17:40
epoch [22/50] batch [220/319] time 0.119 (0.116) data 0.000 (0.012) loss 2.2138 (2.3789) ce_loss 0.9077 (1.1176) loss_zs_kd 0.2817 (0.3202) loss_oracle 0.3607 (0.3274) acc 75.0000 (58.5511) kd_loss 0.9849 (0.9374) lr 1.3090e-03 eta 0:17:27
epoch [22/50] batch [240/319] time 0.096 (0.115) data 0.000 (0.011) loss 2.6651 (2.3795) ce_loss 1.3320 (1.1159) loss_zs_kd 0.3292 (0.3202) loss_oracle 0.3606 (0.3284) acc 50.0000 (58.5677) kd_loss 0.9882 (0.9392) lr 1.3090e-03 eta 0:17:15
epoch [22/50] batch [260/319] time 0.100 (0.114) data 0.000 (0.010) loss 2.5378 (2.3865) ce_loss 1.1748 (1.1208) loss_zs_kd 0.3093 (0.3211) loss_oracle 0.3679 (0.3293) acc 46.8750 (58.3173) kd_loss 1.0244 (0.9406) lr 1.3090e-03 eta 0:17:05
epoch [22/50] batch [280/319] time 0.105 (0.113) data 0.000 (0.009) loss 2.1316 (2.3890) ce_loss 0.8174 (1.1190) loss_zs_kd 0.3106 (0.3203) loss_oracle 0.2731 (0.3285) acc 75.0000 (58.3929) kd_loss 1.0224 (0.9456) lr 1.3090e-03 eta 0:16:55
epoch [22/50] batch [300/319] time 0.160 (0.113) data 0.000 (0.009) loss 2.4716 (2.3983) ce_loss 1.1133 (1.1208) loss_zs_kd 0.3776 (0.3214) loss_oracle 0.3051 (0.3271) acc 56.2500 (58.2604) kd_loss 1.0170 (0.9533) lr 1.3090e-03 eta 0:16:49
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,635
* accuracy: 60.2%
* error: 39.8%
* macro_f1: 50.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,637
* accuracy: 47.6%
* error: 52.4%
* macro_f1: 23.6%
******* Domain 2 best val acc:      62.5%, epoch: 21 *******
******* Domain 2 best val test acc: 49.6%, epoch: 21 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [23/50] batch [20/319] time 0.106 (0.234) data 0.000 (0.129) loss 2.5554 (2.4637) ce_loss 1.3506 (1.1199) loss_zs_kd 0.2720 (0.3128) loss_oracle 0.2727 (0.3304) acc 43.7500 (58.1250) kd_loss 0.9324 (1.0222) lr 1.2487e-03 eta 0:34:47
epoch [23/50] batch [40/319] time 0.112 (0.168) data 0.000 (0.065) loss 2.5890 (2.4880) ce_loss 1.0801 (1.1315) loss_zs_kd 0.3548 (0.2946) loss_oracle 0.3213 (0.3282) acc 59.3750 (57.5781) kd_loss 1.1709 (1.0451) lr 1.2487e-03 eta 0:24:52
epoch [23/50] batch [60/319] time 0.103 (0.145) data 0.000 (0.043) loss 2.4236 (2.4654) ce_loss 1.1602 (1.1079) loss_zs_kd 0.3383 (0.3091) loss_oracle 0.3557 (0.3296) acc 53.1250 (58.6979) kd_loss 0.9165 (1.0382) lr 1.2487e-03 eta 0:21:29
epoch [23/50] batch [80/319] time 0.085 (0.133) data 0.000 (0.032) loss 2.3266 (2.4554) ce_loss 1.0410 (1.1093) loss_zs_kd 0.3298 (0.3153) loss_oracle 0.3236 (0.3269) acc 62.5000 (58.9844) kd_loss 0.9589 (1.0250) lr 1.2487e-03 eta 0:19:39
epoch [23/50] batch [100/319] time 0.180 (0.129) data 0.000 (0.026) loss 2.5975 (2.4624) ce_loss 1.0723 (1.1165) loss_zs_kd 0.3430 (0.3148) loss_oracle 0.3067 (0.3233) acc 71.8750 (58.8750) kd_loss 1.2004 (1.0268) lr 1.2487e-03 eta 0:18:58
epoch [23/50] batch [120/319] time 0.190 (0.125) data 0.000 (0.022) loss 2.3353 (2.4491) ce_loss 1.0645 (1.1101) loss_zs_kd 0.3130 (0.3141) loss_oracle 0.3072 (0.3245) acc 53.1250 (59.0104) kd_loss 0.9607 (1.0196) lr 1.2487e-03 eta 0:18:19
epoch [23/50] batch [140/319] time 0.066 (0.129) data 0.000 (0.019) loss 2.3720 (2.4522) ce_loss 0.9785 (1.1110) loss_zs_kd 0.3019 (0.3180) loss_oracle 0.3353 (0.3234) acc 65.6250 (59.2188) kd_loss 1.0748 (1.0206) lr 1.2487e-03 eta 0:18:51
epoch [23/50] batch [160/319] time 0.088 (0.121) data 0.000 (0.016) loss 2.3492 (2.4573) ce_loss 0.9741 (1.1146) loss_zs_kd 0.3371 (0.3197) loss_oracle 0.3209 (0.3246) acc 62.5000 (59.0625) kd_loss 1.0461 (1.0206) lr 1.2487e-03 eta 0:17:40
epoch [23/50] batch [180/319] time 0.068 (0.116) data 0.000 (0.015) loss 2.4934 (2.4616) ce_loss 1.2383 (1.1161) loss_zs_kd 0.2896 (0.3213) loss_oracle 0.3442 (0.3254) acc 46.8750 (58.9757) kd_loss 0.9382 (1.0222) lr 1.2487e-03 eta 0:16:58
epoch [23/50] batch [200/319] time 0.087 (0.113) data 0.000 (0.013) loss 2.0336 (2.4591) ce_loss 0.7495 (1.1163) loss_zs_kd 0.2272 (0.3218) loss_oracle 0.3216 (0.3257) acc 71.8750 (58.8750) kd_loss 1.0097 (1.0190) lr 1.2487e-03 eta 0:16:25
epoch [23/50] batch [220/319] time 0.085 (0.110) data 0.000 (0.012) loss 2.7225 (2.4552) ce_loss 1.3057 (1.1177) loss_zs_kd 0.3990 (0.3233) loss_oracle 0.2673 (0.3248) acc 56.2500 (58.7642) kd_loss 1.0837 (1.0135) lr 1.2487e-03 eta 0:15:57
epoch [23/50] batch [240/319] time 0.067 (0.107) data 0.000 (0.011) loss 2.4890 (2.4572) ce_loss 1.1592 (1.1257) loss_zs_kd 0.3084 (0.3210) loss_oracle 0.2963 (0.3243) acc 56.2500 (58.5286) kd_loss 1.0275 (1.0088) lr 1.2487e-03 eta 0:15:33
epoch [23/50] batch [260/319] time 0.082 (0.105) data 0.000 (0.010) loss 2.5694 (2.4584) ce_loss 1.1621 (1.1271) loss_zs_kd 0.3246 (0.3217) loss_oracle 0.3445 (0.3245) acc 59.3750 (58.3293) kd_loss 1.0728 (1.0082) lr 1.2487e-03 eta 0:15:14
epoch [23/50] batch [280/319] time 0.087 (0.104) data 0.000 (0.009) loss 2.2687 (2.4557) ce_loss 0.9209 (1.1268) loss_zs_kd 0.3834 (0.3228) loss_oracle 0.3565 (0.3253) acc 71.8750 (58.3705) kd_loss 0.9779 (1.0048) lr 1.2487e-03 eta 0:14:57
epoch [23/50] batch [300/319] time 0.088 (0.102) data 0.000 (0.009) loss 2.4633 (2.4512) ce_loss 1.2031 (1.1274) loss_zs_kd 0.3086 (0.3219) loss_oracle 0.3115 (0.3257) acc 56.2500 (58.2396) kd_loss 0.9501 (1.0000) lr 1.2487e-03 eta 0:14:41
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,632
* accuracy: 60.1%
* error: 39.9%
* macro_f1: 52.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,660
* accuracy: 47.9%
* error: 52.1%
* macro_f1: 23.1%
******* Domain 2 best val acc:      62.5%, epoch: 21 *******
******* Domain 2 best val test acc: 49.6%, epoch: 21 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [24/50] batch [20/319] time 0.109 (0.219) data 0.000 (0.113) loss 2.4342 (2.5136) ce_loss 1.0547 (1.1665) loss_zs_kd 0.3572 (0.3278) loss_oracle 0.3416 (0.3249) acc 50.0000 (54.6875) kd_loss 1.0301 (1.0208) lr 1.1874e-03 eta 0:31:25
epoch [24/50] batch [40/319] time 0.114 (0.166) data 0.000 (0.057) loss 2.7558 (2.5068) ce_loss 1.3975 (1.1451) loss_zs_kd 0.2967 (0.3215) loss_oracle 0.3528 (0.3240) acc 46.8750 (57.1875) kd_loss 1.0336 (1.0390) lr 1.1874e-03 eta 0:23:39
epoch [24/50] batch [60/319] time 0.097 (0.145) data 0.000 (0.038) loss 2.6084 (2.5194) ce_loss 1.2480 (1.1607) loss_zs_kd 0.3852 (0.3211) loss_oracle 0.3027 (0.3165) acc 46.8750 (57.5521) kd_loss 1.0164 (1.0399) lr 1.1874e-03 eta 0:20:44
epoch [24/50] batch [80/319] time 0.086 (0.134) data 0.000 (0.028) loss 2.5089 (2.5224) ce_loss 1.2500 (1.1533) loss_zs_kd 0.4043 (0.3181) loss_oracle 0.3085 (0.3157) acc 53.1250 (57.4219) kd_loss 0.9025 (1.0522) lr 1.1874e-03 eta 0:18:59
epoch [24/50] batch [100/319] time 0.112 (0.126) data 0.000 (0.023) loss 2.8589 (2.5250) ce_loss 1.4980 (1.1481) loss_zs_kd 0.3890 (0.3201) loss_oracle 0.3845 (0.3167) acc 40.6250 (57.5312) kd_loss 0.9741 (1.0585) lr 1.1874e-03 eta 0:17:52
epoch [24/50] batch [120/319] time 0.092 (0.121) data 0.000 (0.019) loss 2.5991 (2.5355) ce_loss 1.1504 (1.1523) loss_zs_kd 0.3224 (0.3199) loss_oracle 0.3630 (0.3168) acc 53.1250 (57.0833) kd_loss 1.1060 (1.0649) lr 1.1874e-03 eta 0:17:06
epoch [24/50] batch [140/319] time 0.162 (0.117) data 0.000 (0.016) loss 2.4962 (2.5341) ce_loss 1.0049 (1.1483) loss_zs_kd 0.3962 (0.3172) loss_oracle 0.2602 (0.3159) acc 71.8750 (57.3438) kd_loss 1.1631 (1.0692) lr 1.1874e-03 eta 0:16:34
epoch [24/50] batch [160/319] time 0.075 (0.115) data 0.000 (0.014) loss 2.6084 (2.5308) ce_loss 1.2676 (1.1415) loss_zs_kd 0.2436 (0.3153) loss_oracle 0.3297 (0.3168) acc 46.8750 (57.5781) kd_loss 1.0542 (1.0733) lr 1.1874e-03 eta 0:16:14
epoch [24/50] batch [180/319] time 0.169 (0.118) data 0.000 (0.013) loss 2.6201 (2.5395) ce_loss 1.3535 (1.1438) loss_zs_kd 0.2833 (0.3185) loss_oracle 0.3471 (0.3181) acc 56.2500 (57.6389) kd_loss 0.9514 (1.0774) lr 1.1874e-03 eta 0:16:34
epoch [24/50] batch [200/319] time 0.069 (0.116) data 0.000 (0.012) loss 2.5374 (2.5380) ce_loss 1.0830 (1.1420) loss_zs_kd 0.3082 (0.3176) loss_oracle 0.2980 (0.3183) acc 65.6250 (57.6094) kd_loss 1.1513 (1.0781) lr 1.1874e-03 eta 0:16:18
epoch [24/50] batch [220/319] time 0.095 (0.114) data 0.001 (0.011) loss 2.5656 (2.5362) ce_loss 1.1611 (1.1408) loss_zs_kd 0.3278 (0.3162) loss_oracle 0.3609 (0.3193) acc 62.5000 (57.5568) kd_loss 1.0601 (1.0777) lr 1.1874e-03 eta 0:15:56
epoch [24/50] batch [240/319] time 0.097 (0.112) data 0.000 (0.010) loss 2.8636 (2.5358) ce_loss 1.3613 (1.1369) loss_zs_kd 0.3670 (0.3174) loss_oracle 0.3319 (0.3205) acc 40.6250 (57.5260) kd_loss 1.1528 (1.0798) lr 1.1874e-03 eta 0:15:38
epoch [24/50] batch [260/319] time 0.111 (0.111) data 0.000 (0.009) loss 2.7446 (2.5406) ce_loss 1.3760 (1.1379) loss_zs_kd 0.2516 (0.3182) loss_oracle 0.3714 (0.3212) acc 50.0000 (57.6202) kd_loss 1.0572 (1.0830) lr 1.1874e-03 eta 0:15:27
epoch [24/50] batch [280/319] time 0.089 (0.110) data 0.000 (0.008) loss 2.8182 (2.5449) ce_loss 1.2695 (1.1392) loss_zs_kd 0.2860 (0.3183) loss_oracle 0.3590 (0.3226) acc 40.6250 (57.5446) kd_loss 1.2262 (1.0853) lr 1.1874e-03 eta 0:15:18
epoch [24/50] batch [300/319] time 0.082 (0.109) data 0.000 (0.008) loss 2.6083 (2.5455) ce_loss 0.9834 (1.1369) loss_zs_kd 0.3559 (0.3180) loss_oracle 0.4000 (0.3240) acc 62.5000 (57.6458) kd_loss 1.2470 (1.0876) lr 1.1874e-03 eta 0:15:05
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,651
* accuracy: 60.6%
* error: 39.4%
* macro_f1: 50.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,503
* accuracy: 46.3%
* error: 53.7%
* macro_f1: 21.4%
******* Domain 2 best val acc:      62.5%, epoch: 21 *******
******* Domain 2 best val test acc: 49.6%, epoch: 21 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [25/50] batch [20/319] time 0.088 (0.252) data 0.000 (0.132) loss 2.5634 (2.5528) ce_loss 1.1396 (1.1531) loss_zs_kd 0.2946 (0.3019) loss_oracle 0.3443 (0.3556) acc 62.5000 (56.5625) kd_loss 1.1043 (1.0710) lr 1.1253e-03 eta 0:34:42
epoch [25/50] batch [40/319] time 0.103 (0.174) data 0.000 (0.066) loss 2.8076 (2.5392) ce_loss 1.2676 (1.1577) loss_zs_kd 0.2696 (0.3042) loss_oracle 0.3714 (0.3548) acc 53.1250 (56.7969) kd_loss 1.2195 (1.0521) lr 1.1253e-03 eta 0:23:54
epoch [25/50] batch [60/319] time 0.105 (0.150) data 0.000 (0.044) loss 2.7257 (2.5161) ce_loss 1.3418 (1.1510) loss_zs_kd 0.3652 (0.3054) loss_oracle 0.3424 (0.3501) acc 56.2500 (56.4583) kd_loss 1.0301 (1.0373) lr 1.1253e-03 eta 0:20:39
epoch [25/50] batch [80/319] time 0.107 (0.138) data 0.000 (0.033) loss 2.3756 (2.4959) ce_loss 0.9858 (1.1481) loss_zs_kd 0.3169 (0.3086) loss_oracle 0.2881 (0.3466) acc 59.3750 (56.6406) kd_loss 1.0873 (1.0203) lr 1.1253e-03 eta 0:18:56
epoch [25/50] batch [100/319] time 0.111 (0.131) data 0.000 (0.027) loss 2.5582 (2.4810) ce_loss 1.3506 (1.1364) loss_zs_kd 0.3146 (0.3097) loss_oracle 0.3473 (0.3462) acc 43.7500 (57.3750) kd_loss 0.8767 (1.0166) lr 1.1253e-03 eta 0:17:54
epoch [25/50] batch [120/319] time 0.108 (0.126) data 0.000 (0.022) loss 2.3768 (2.4765) ce_loss 1.0898 (1.1396) loss_zs_kd 0.3907 (0.3097) loss_oracle 0.3294 (0.3453) acc 68.7500 (57.6562) kd_loss 0.9269 (1.0095) lr 1.1253e-03 eta 0:17:10
epoch [25/50] batch [140/319] time 0.109 (0.123) data 0.000 (0.019) loss 2.3652 (2.4708) ce_loss 1.0586 (1.1341) loss_zs_kd 0.3737 (0.3106) loss_oracle 0.2730 (0.3431) acc 56.2500 (57.7679) kd_loss 0.9833 (1.0099) lr 1.1253e-03 eta 0:16:39
epoch [25/50] batch [160/319] time 0.080 (0.119) data 0.000 (0.017) loss 2.6206 (2.4793) ce_loss 1.1348 (1.1370) loss_zs_kd 0.3595 (0.3109) loss_oracle 0.3317 (0.3433) acc 62.5000 (57.6562) kd_loss 1.1403 (1.0151) lr 1.1253e-03 eta 0:16:08
epoch [25/50] batch [180/319] time 0.146 (0.119) data 0.000 (0.015) loss 2.4550 (2.4789) ce_loss 1.0801 (1.1325) loss_zs_kd 0.2981 (0.3134) loss_oracle 0.2837 (0.3411) acc 53.1250 (57.9340) kd_loss 1.0840 (1.0191) lr 1.1253e-03 eta 0:16:05
epoch [25/50] batch [200/319] time 0.140 (0.116) data 0.001 (0.013) loss 2.7551 (2.4813) ce_loss 1.2422 (1.1293) loss_zs_kd 0.3420 (0.3168) loss_oracle 0.3061 (0.3395) acc 46.8750 (58.0938) kd_loss 1.1889 (1.0238) lr 1.1253e-03 eta 0:15:39
epoch [25/50] batch [220/319] time 0.080 (0.120) data 0.000 (0.012) loss 2.5333 (2.4905) ce_loss 1.0693 (1.1327) loss_zs_kd 0.3343 (0.3171) loss_oracle 0.2752 (0.3380) acc 50.0000 (58.0256) kd_loss 1.1592 (1.0302) lr 1.1253e-03 eta 0:16:11
epoch [25/50] batch [240/319] time 0.098 (0.118) data 0.000 (0.011) loss 2.6764 (2.4911) ce_loss 1.3037 (1.1267) loss_zs_kd 0.3574 (0.3181) loss_oracle 0.3474 (0.3375) acc 40.6250 (58.0599) kd_loss 1.0203 (1.0366) lr 1.1253e-03 eta 0:15:48
epoch [25/50] batch [260/319] time 0.102 (0.116) data 0.000 (0.010) loss 2.6463 (2.4977) ce_loss 1.2451 (1.1282) loss_zs_kd 0.3283 (0.3202) loss_oracle 0.3489 (0.3367) acc 46.8750 (58.0048) kd_loss 1.0625 (1.0411) lr 1.1253e-03 eta 0:15:35
epoch [25/50] batch [280/319] time 0.103 (0.115) data 0.000 (0.010) loss 2.6540 (2.5003) ce_loss 1.2305 (1.1280) loss_zs_kd 0.2978 (0.3199) loss_oracle 0.3761 (0.3366) acc 50.0000 (58.0246) kd_loss 1.0866 (1.0440) lr 1.1253e-03 eta 0:15:25
epoch [25/50] batch [300/319] time 0.102 (0.115) data 0.000 (0.009) loss 2.5051 (2.5050) ce_loss 1.1650 (1.1303) loss_zs_kd 0.2590 (0.3174) loss_oracle 0.3774 (0.3375) acc 59.3750 (57.8750) kd_loss 1.0218 (1.0472) lr 1.1253e-03 eta 0:15:16
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,720
* accuracy: 62.1%
* error: 37.9%
* macro_f1: 53.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,757
* accuracy: 48.9%
* error: 51.1%
* macro_f1: 22.4%
******* Domain 2 best val acc:      62.5%, epoch: 21 *******
******* Domain 2 best val test acc: 49.6%, epoch: 21 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [26/50] batch [20/319] time 0.164 (0.239) data 0.000 (0.123) loss 2.5808 (2.5241) ce_loss 1.2031 (1.1781) loss_zs_kd 0.2558 (0.3332) loss_oracle 0.3613 (0.3267) acc 53.1250 (55.1562) kd_loss 1.0691 (1.0160) lr 1.0628e-03 eta 0:31:37
epoch [26/50] batch [40/319] time 0.075 (0.184) data 0.000 (0.062) loss 2.5389 (2.5234) ce_loss 1.0039 (1.1556) loss_zs_kd 0.3534 (0.3234) loss_oracle 0.3508 (0.3283) acc 65.6250 (56.0938) kd_loss 1.1829 (1.0420) lr 1.0628e-03 eta 0:24:21
epoch [26/50] batch [60/319] time 0.106 (0.153) data 0.000 (0.041) loss 2.6320 (2.5220) ce_loss 1.1426 (1.1315) loss_zs_kd 0.2853 (0.3262) loss_oracle 0.3333 (0.3255) acc 43.7500 (57.8646) kd_loss 1.1801 (1.0647) lr 1.0628e-03 eta 0:20:13
epoch [26/50] batch [80/319] time 0.099 (0.141) data 0.000 (0.031) loss 2.4968 (2.5313) ce_loss 1.1465 (1.1346) loss_zs_kd 0.4139 (0.3280) loss_oracle 0.4041 (0.3279) acc 71.8750 (57.9297) kd_loss 0.9413 (1.0688) lr 1.0628e-03 eta 0:18:29
epoch [26/50] batch [100/319] time 0.109 (0.132) data 0.000 (0.025) loss 2.4243 (2.5280) ce_loss 1.1064 (1.1338) loss_zs_kd 0.2985 (0.3279) loss_oracle 0.2820 (0.3289) acc 53.1250 (58.0000) kd_loss 1.0276 (1.0658) lr 1.0628e-03 eta 0:17:22
epoch [26/50] batch [120/319] time 0.110 (0.128) data 0.000 (0.021) loss 2.5914 (2.5248) ce_loss 1.2432 (1.1262) loss_zs_kd 0.3143 (0.3297) loss_oracle 0.3599 (0.3325) acc 40.6250 (58.2031) kd_loss 1.0111 (1.0676) lr 1.0628e-03 eta 0:16:44
epoch [26/50] batch [140/319] time 0.095 (0.124) data 0.000 (0.018) loss 2.6429 (2.5307) ce_loss 1.1787 (1.1225) loss_zs_kd 0.3063 (0.3271) loss_oracle 0.3445 (0.3320) acc 56.2500 (58.1920) kd_loss 1.1388 (1.0786) lr 1.0628e-03 eta 0:16:07
epoch [26/50] batch [160/319] time 0.095 (0.121) data 0.000 (0.016) loss 2.5374 (2.5276) ce_loss 0.9619 (1.1177) loss_zs_kd 0.3158 (0.3239) loss_oracle 0.3002 (0.3327) acc 62.5000 (58.1445) kd_loss 1.2675 (1.0816) lr 1.0628e-03 eta 0:15:43
epoch [26/50] batch [180/319] time 0.097 (0.118) data 0.000 (0.014) loss 2.3359 (2.5270) ce_loss 0.9453 (1.1185) loss_zs_kd 0.3241 (0.3240) loss_oracle 0.3787 (0.3335) acc 71.8750 (58.0382) kd_loss 1.0392 (1.0797) lr 1.0628e-03 eta 0:15:20
epoch [26/50] batch [200/319] time 0.077 (0.114) data 0.000 (0.013) loss 2.7443 (2.5267) ce_loss 1.3672 (1.1183) loss_zs_kd 0.3030 (0.3235) loss_oracle 0.3333 (0.3341) acc 50.0000 (57.8750) kd_loss 1.0589 (1.0795) lr 1.0628e-03 eta 0:14:49
epoch [26/50] batch [220/319] time 0.081 (0.115) data 0.000 (0.011) loss 2.2886 (2.5277) ce_loss 0.8364 (1.1203) loss_zs_kd 0.2259 (0.3246) loss_oracle 0.3524 (0.3345) acc 65.6250 (57.7699) kd_loss 1.1630 (1.0779) lr 1.0628e-03 eta 0:14:48
epoch [26/50] batch [240/319] time 0.166 (0.113) data 0.000 (0.011) loss 2.6067 (2.5290) ce_loss 1.0830 (1.1224) loss_zs_kd 0.2934 (0.3219) loss_oracle 0.3430 (0.3348) acc 71.8750 (57.6693) kd_loss 1.2055 (1.0783) lr 1.0628e-03 eta 0:14:36
epoch [26/50] batch [260/319] time 0.083 (0.116) data 0.000 (0.010) loss 2.6055 (2.5290) ce_loss 1.0449 (1.1207) loss_zs_kd 0.2859 (0.3217) loss_oracle 0.4006 (0.3355) acc 62.5000 (57.8726) kd_loss 1.2174 (1.0797) lr 1.0628e-03 eta 0:14:54
epoch [26/50] batch [280/319] time 0.097 (0.114) data 0.000 (0.009) loss 2.5518 (2.5355) ce_loss 0.9683 (1.1236) loss_zs_kd 0.2716 (0.3220) loss_oracle 0.3310 (0.3359) acc 62.5000 (57.7790) kd_loss 1.2822 (1.0830) lr 1.0628e-03 eta 0:14:40
epoch [26/50] batch [300/319] time 0.106 (0.114) data 0.000 (0.008) loss 2.9373 (2.5402) ce_loss 1.6279 (1.1279) loss_zs_kd 0.3489 (0.3212) loss_oracle 0.3693 (0.3364) acc 31.2500 (57.4479) kd_loss 0.9503 (1.0835) lr 1.0628e-03 eta 0:14:32
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,708
* accuracy: 61.9%
* error: 38.1%
* macro_f1: 52.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,728
* accuracy: 48.6%
* error: 51.4%
* macro_f1: 21.2%
******* Domain 2 best val acc:      62.5%, epoch: 21 *******
******* Domain 2 best val test acc: 49.6%, epoch: 21 *******
******* Domain 2 best test acc:     52.1%, epoch: 8 *******
epoch [27/50] batch [20/319] time 0.082 (0.264) data 0.000 (0.139) loss 2.3437 (2.5620) ce_loss 1.0029 (1.1412) loss_zs_kd 0.2176 (0.3049) loss_oracle 0.3173 (0.3153) acc 59.3750 (56.7188) kd_loss 1.0733 (1.1106) lr 1.0000e-03 eta 0:33:37
epoch [27/50] batch [40/319] time 0.192 (0.199) data 0.000 (0.070) loss 2.3532 (2.5457) ce_loss 0.9556 (1.1339) loss_zs_kd 0.3908 (0.3077) loss_oracle 0.3299 (0.3277) acc 62.5000 (57.0312) kd_loss 1.0373 (1.0940) lr 1.0000e-03 eta 0:25:18
epoch [27/50] batch [60/319] time 0.082 (0.170) data 0.000 (0.047) loss 2.6443 (2.5050) ce_loss 1.0312 (1.1081) loss_zs_kd 0.3669 (0.3096) loss_oracle 0.3920 (0.3247) acc 75.0000 (59.0625) kd_loss 1.2336 (1.0798) lr 1.0000e-03 eta 0:21:28
epoch [27/50] batch [80/319] time 0.089 (0.150) data 0.000 (0.035) loss 2.6420 (2.4908) ce_loss 1.3252 (1.1010) loss_zs_kd 0.3352 (0.3092) loss_oracle 0.3126 (0.3288) acc 53.1250 (59.4531) kd_loss 0.9929 (1.0708) lr 1.0000e-03 eta 0:18:52
epoch [27/50] batch [100/319] time 0.094 (0.140) data 0.000 (0.028) loss 2.2639 (2.4769) ce_loss 1.0459 (1.0992) loss_zs_kd 0.3372 (0.3123) loss_oracle 0.3640 (0.3294) acc 56.2500 (59.4062) kd_loss 0.8674 (1.0569) lr 1.0000e-03 eta 0:17:39
epoch [27/50] batch [120/319] time 0.109 (0.134) data 0.000 (0.023) loss 2.4294 (2.4848) ce_loss 1.0107 (1.1065) loss_zs_kd 0.3514 (0.3153) loss_oracle 0.3713 (0.3306) acc 62.5000 (59.0104) kd_loss 1.0573 (1.0554) lr 1.0000e-03 eta 0:16:52
epoch [27/50] batch [140/319] time 0.098 (0.130) data 0.000 (0.020) loss 2.3998 (2.4828) ce_loss 1.0576 (1.1090) loss_zs_kd 0.2837 (0.3150) loss_oracle 0.3289 (0.3331) acc 53.1250 (58.9286) kd_loss 1.0359 (1.0498) lr 1.0000e-03 eta 0:16:14
epoch [27/50] batch [160/319] time 0.102 (0.126) data 0.000 (0.018) loss 2.3979 (2.4762) ce_loss 0.9067 (1.1065) loss_zs_kd 0.2968 (0.3186) loss_oracle 0.3867 (0.3342) acc 59.3750 (59.0820) kd_loss 1.1495 (1.0433) lr 1.0000e-03 eta 0:15:45
epoch [27/50] batch [180/319] time 0.099 (0.123) data 0.000 (0.016) loss 2.3089 (2.4768) ce_loss 0.8936 (1.1084) loss_zs_kd 0.3077 (0.3192) loss_oracle 0.3404 (0.3354) acc 68.7500 (58.9236) kd_loss 1.0913 (1.0411) lr 1.0000e-03 eta 0:15:23
epoch [27/50] batch [200/319] time 0.084 (0.121) data 0.000 (0.014) loss 2.4054 (2.4801) ce_loss 0.9424 (1.1106) loss_zs_kd 0.3891 (0.3206) loss_oracle 0.3220 (0.3364) acc 65.6250 (58.8750) kd_loss 1.1074 (1.0410) lr 1.0000e-03 eta 0:15:01
epoch [27/50] batch [220/319] time 0.069 (0.118) data 0.000 (0.013) loss 2.4716 (2.4848) ce_loss 1.1504 (1.1123) loss_zs_kd 0.3247 (0.3215) loss_oracle 0.3139 (0.3370) acc 56.2500 (58.7216) kd_loss 1.0020 (1.0433) lr 1.0000e-03 eta 0:14:34
epoch [27/50] batch [240/319] time 0.092 (0.118) data 0.000 (0.012) loss 2.5718 (2.4883) ce_loss 1.2354 (1.1156) loss_zs_kd 0.3147 (0.3222) loss_oracle 0.3581 (0.3373) acc 46.8750 (58.6719) kd_loss 1.0001 (1.0429) lr 1.0000e-03 eta 0:14:33
epoch [27/50] batch [260/319] time 0.160 (0.119) data 0.000 (0.011) loss 2.5824 (2.4924) ce_loss 0.9980 (1.1158) loss_zs_kd 0.3655 (0.3221) loss_oracle 0.3675 (0.3386) acc 68.7500 (58.7260) kd_loss 1.2179 (1.0463) lr 1.0000e-03 eta 0:14:38
epoch [27/50] batch [280/319] time 0.077 (0.118) data 0.000 (0.010) loss 2.8681 (2.4946) ce_loss 1.3525 (1.1183) loss_zs_kd 0.3945 (0.3226) loss_oracle 0.3509 (0.3394) acc 43.7500 (58.7388) kd_loss 1.1428 (1.0453) lr 1.0000e-03 eta 0:14:32
epoch [27/50] batch [300/319] time 0.113 (0.117) data 0.000 (0.010) loss 2.7670 (2.4944) ce_loss 1.4854 (1.1174) loss_zs_kd 0.4178 (0.3220) loss_oracle 0.3115 (0.3394) acc 40.6250 (58.5833) kd_loss 0.9170 (1.0463) lr 1.0000e-03 eta 0:14:20
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,735
* accuracy: 62.5%
* error: 37.5%
* macro_f1: 53.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,143
* accuracy: 52.8%
* error: 47.2%
* macro_f1: 24.1%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      62.5%, epoch: 21 *******
******* Domain 2 best val test acc: 49.6%, epoch: 21 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [28/50] batch [20/319] time 0.072 (0.279) data 0.000 (0.151) loss 2.4603 (2.5079) ce_loss 1.0684 (1.0932) loss_zs_kd 0.3634 (0.3212) loss_oracle 0.3299 (0.3411) acc 59.3750 (60.0000) kd_loss 1.0453 (1.0836) lr 9.3721e-04 eta 0:34:03
epoch [28/50] batch [40/319] time 0.110 (0.182) data 0.000 (0.075) loss 2.6264 (2.4849) ce_loss 1.2031 (1.0933) loss_zs_kd 0.3909 (0.3176) loss_oracle 0.3550 (0.3427) acc 56.2500 (59.9219) kd_loss 1.0503 (1.0615) lr 9.3721e-04 eta 0:22:09
epoch [28/50] batch [60/319] time 0.137 (0.173) data 0.000 (0.050) loss 2.4222 (2.5033) ce_loss 1.0342 (1.1214) loss_zs_kd 0.3200 (0.3237) loss_oracle 0.3270 (0.3452) acc 78.1250 (58.6979) kd_loss 1.0645 (1.0474) lr 9.3721e-04 eta 0:20:59
epoch [28/50] batch [80/319] time 0.081 (0.149) data 0.000 (0.038) loss 2.4508 (2.4858) ce_loss 1.2021 (1.1086) loss_zs_kd 0.2833 (0.3189) loss_oracle 0.3008 (0.3423) acc 37.5000 (58.4375) kd_loss 0.9566 (1.0466) lr 9.3721e-04 eta 0:17:59
epoch [28/50] batch [100/319] time 0.102 (0.139) data 0.000 (0.030) loss 2.5426 (2.4974) ce_loss 1.1338 (1.1133) loss_zs_kd 0.3430 (0.3232) loss_oracle 0.2786 (0.3440) acc 62.5000 (58.5312) kd_loss 1.0980 (1.0505) lr 9.3721e-04 eta 0:16:42
epoch [28/50] batch [120/319] time 0.090 (0.132) data 0.000 (0.025) loss 2.3227 (2.4966) ce_loss 1.1406 (1.1090) loss_zs_kd 0.3597 (0.3232) loss_oracle 0.3664 (0.3426) acc 50.0000 (58.4896) kd_loss 0.8190 (1.0547) lr 9.3721e-04 eta 0:15:50
epoch [28/50] batch [140/319] time 0.107 (0.127) data 0.000 (0.022) loss 2.6202 (2.5091) ce_loss 1.1064 (1.1153) loss_zs_kd 0.3418 (0.3222) loss_oracle 0.3115 (0.3409) acc 56.2500 (58.3705) kd_loss 1.1871 (1.0624) lr 9.3721e-04 eta 0:15:17
epoch [28/50] batch [160/319] time 0.112 (0.124) data 0.000 (0.019) loss 2.2617 (2.5026) ce_loss 0.8833 (1.1142) loss_zs_kd 0.3933 (0.3199) loss_oracle 0.3537 (0.3397) acc 71.8750 (58.3203) kd_loss 1.0049 (1.0586) lr 9.3721e-04 eta 0:14:51
epoch [28/50] batch [180/319] time 0.107 (0.122) data 0.000 (0.017) loss 2.4576 (2.4949) ce_loss 1.0791 (1.1045) loss_zs_kd 0.2598 (0.3202) loss_oracle 0.3437 (0.3407) acc 56.2500 (58.5417) kd_loss 1.0767 (1.0600) lr 9.3721e-04 eta 0:14:32
epoch [28/50] batch [200/319] time 0.090 (0.120) data 0.000 (0.015) loss 2.6656 (2.4961) ce_loss 1.3174 (1.1073) loss_zs_kd 0.3015 (0.3198) loss_oracle 0.3190 (0.3396) acc 43.7500 (58.6719) kd_loss 1.0380 (1.0591) lr 9.3721e-04 eta 0:14:16
epoch [28/50] batch [220/319] time 0.088 (0.117) data 0.000 (0.014) loss 2.5336 (2.4996) ce_loss 1.1768 (1.1112) loss_zs_kd 0.3265 (0.3206) loss_oracle 0.2887 (0.3381) acc 46.8750 (58.5369) kd_loss 1.0493 (1.0590) lr 9.3721e-04 eta 0:13:51
epoch [28/50] batch [240/319] time 0.167 (0.117) data 0.000 (0.013) loss 2.3836 (2.4990) ce_loss 1.0566 (1.1104) loss_zs_kd 0.3220 (0.3228) loss_oracle 0.3615 (0.3385) acc 62.5000 (58.5677) kd_loss 0.9852 (1.0578) lr 9.3721e-04 eta 0:13:47
epoch [28/50] batch [260/319] time 0.089 (0.114) data 0.000 (0.012) loss 2.4045 (2.4981) ce_loss 0.9639 (1.1087) loss_zs_kd 0.3551 (0.3236) loss_oracle 0.3759 (0.3390) acc 68.7500 (58.8101) kd_loss 1.0751 (1.0581) lr 9.3721e-04 eta 0:13:28
epoch [28/50] batch [280/319] time 0.169 (0.117) data 0.000 (0.011) loss 2.3126 (2.4976) ce_loss 1.0713 (1.1090) loss_zs_kd 0.3372 (0.3235) loss_oracle 0.3209 (0.3400) acc 59.3750 (58.7500) kd_loss 0.9123 (1.0569) lr 9.3721e-04 eta 0:13:42
epoch [28/50] batch [300/319] time 0.086 (0.115) data 0.000 (0.010) loss 2.5111 (2.4983) ce_loss 1.2139 (1.1095) loss_zs_kd 0.2841 (0.3236) loss_oracle 0.3849 (0.3409) acc 56.2500 (58.8125) kd_loss 0.9627 (1.0566) lr 9.3721e-04 eta 0:13:29
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,717
* accuracy: 62.1%
* error: 37.9%
* macro_f1: 54.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,632
* accuracy: 47.6%
* error: 52.4%
* macro_f1: 22.9%
******* Domain 2 best val acc:      62.5%, epoch: 21 *******
******* Domain 2 best val test acc: 49.6%, epoch: 21 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [29/50] batch [20/319] time 0.097 (0.230) data 0.000 (0.136) loss 2.6215 (2.4322) ce_loss 1.3574 (1.0918) loss_zs_kd 0.3263 (0.3126) loss_oracle 0.3377 (0.3336) acc 43.7500 (62.0312) kd_loss 0.9321 (1.0173) lr 8.7467e-04 eta 0:26:52
epoch [29/50] batch [40/319] time 0.067 (0.152) data 0.000 (0.068) loss 2.4131 (2.4423) ce_loss 1.1338 (1.1057) loss_zs_kd 0.2853 (0.3159) loss_oracle 0.3616 (0.3393) acc 68.7500 (60.0000) kd_loss 0.9558 (1.0090) lr 8.7467e-04 eta 0:17:42
epoch [29/50] batch [60/319] time 0.076 (0.141) data 0.000 (0.046) loss 2.1508 (2.4644) ce_loss 0.9458 (1.1111) loss_zs_kd 0.3096 (0.3231) loss_oracle 0.3058 (0.3409) acc 68.7500 (59.7917) kd_loss 0.8973 (1.0213) lr 8.7467e-04 eta 0:16:22
epoch [29/50] batch [80/319] time 0.079 (0.126) data 0.000 (0.034) loss 2.5409 (2.4711) ce_loss 1.0635 (1.1147) loss_zs_kd 0.3300 (0.3214) loss_oracle 0.3558 (0.3424) acc 59.3750 (59.5703) kd_loss 1.1345 (1.0245) lr 8.7467e-04 eta 0:14:36
epoch [29/50] batch [100/319] time 0.074 (0.134) data 0.000 (0.027) loss 2.8365 (2.4784) ce_loss 1.2451 (1.1159) loss_zs_kd 0.3785 (0.3210) loss_oracle 0.2636 (0.3386) acc 56.2500 (59.0312) kd_loss 1.2703 (1.0327) lr 8.7467e-04 eta 0:15:28
epoch [29/50] batch [120/319] time 0.102 (0.126) data 0.000 (0.023) loss 2.3897 (2.4825) ce_loss 1.0703 (1.1119) loss_zs_kd 0.2575 (0.3194) loss_oracle 0.2842 (0.3381) acc 59.3750 (59.1406) kd_loss 1.0485 (1.0419) lr 8.7467e-04 eta 0:14:27
epoch [29/50] batch [140/319] time 0.096 (0.122) data 0.000 (0.020) loss 2.8922 (2.4843) ce_loss 1.3096 (1.1070) loss_zs_kd 0.3460 (0.3201) loss_oracle 0.3406 (0.3370) acc 50.0000 (59.3304) kd_loss 1.2393 (1.0487) lr 8.7467e-04 eta 0:13:59
epoch [29/50] batch [160/319] time 0.090 (0.119) data 0.000 (0.017) loss 2.6009 (2.4970) ce_loss 1.1494 (1.1121) loss_zs_kd 0.2979 (0.3235) loss_oracle 0.3275 (0.3353) acc 68.7500 (59.1211) kd_loss 1.1388 (1.0555) lr 8.7467e-04 eta 0:13:37
epoch [29/50] batch [180/319] time 0.097 (0.117) data 0.000 (0.015) loss 2.5369 (2.5021) ce_loss 1.1924 (1.1131) loss_zs_kd 0.2489 (0.3249) loss_oracle 0.2918 (0.3349) acc 62.5000 (59.2882) kd_loss 1.0741 (1.0591) lr 8.7467e-04 eta 0:13:21
epoch [29/50] batch [200/319] time 0.107 (0.115) data 0.000 (0.014) loss 2.6998 (2.5131) ce_loss 1.2314 (1.1186) loss_zs_kd 0.3534 (0.3260) loss_oracle 0.3073 (0.3343) acc 50.0000 (59.1875) kd_loss 1.1381 (1.0644) lr 8.7467e-04 eta 0:13:06
epoch [29/50] batch [220/319] time 0.098 (0.114) data 0.000 (0.013) loss 2.7661 (2.5139) ce_loss 1.4775 (1.1180) loss_zs_kd 0.3288 (0.3238) loss_oracle 0.3063 (0.3351) acc 46.8750 (59.0483) kd_loss 0.9710 (1.0665) lr 8.7467e-04 eta 0:12:55
epoch [29/50] batch [240/319] time 0.108 (0.113) data 0.000 (0.012) loss 2.5756 (2.5139) ce_loss 1.1494 (1.1170) loss_zs_kd 0.3976 (0.3272) loss_oracle 0.3690 (0.3367) acc 62.5000 (59.2188) kd_loss 1.0429 (1.0650) lr 8.7467e-04 eta 0:12:45
epoch [29/50] batch [260/319] time 0.081 (0.111) data 0.000 (0.011) loss 2.3479 (2.5180) ce_loss 1.0264 (1.1193) loss_zs_kd 0.3696 (0.3282) loss_oracle 0.3452 (0.3361) acc 68.7500 (59.0264) kd_loss 0.9641 (1.0666) lr 8.7467e-04 eta 0:12:29
epoch [29/50] batch [280/319] time 0.172 (0.110) data 0.000 (0.010) loss 2.4829 (2.5187) ce_loss 1.1445 (1.1201) loss_zs_kd 0.3257 (0.3286) loss_oracle 0.3717 (0.3368) acc 62.5000 (59.0179) kd_loss 0.9897 (1.0660) lr 8.7467e-04 eta 0:12:21
epoch [29/50] batch [300/319] time 0.089 (0.109) data 0.000 (0.009) loss 2.5719 (2.5203) ce_loss 1.2139 (1.1211) loss_zs_kd 0.3609 (0.3276) loss_oracle 0.3579 (0.3379) acc 56.2500 (59.0104) kd_loss 0.9986 (1.0665) lr 8.7467e-04 eta 0:12:14
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,654
* accuracy: 60.6%
* error: 39.4%
* macro_f1: 52.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,529
* accuracy: 46.5%
* error: 53.5%
* macro_f1: 22.3%
******* Domain 2 best val acc:      62.5%, epoch: 21 *******
******* Domain 2 best val test acc: 49.6%, epoch: 21 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [30/50] batch [20/319] time 0.096 (0.247) data 0.000 (0.143) loss 2.4243 (2.5723) ce_loss 0.9526 (1.1634) loss_zs_kd 0.2990 (0.3224) loss_oracle 0.3478 (0.3515) acc 56.2500 (57.8125) kd_loss 1.1483 (1.0720) lr 8.1262e-04 eta 0:27:31
epoch [30/50] batch [40/319] time 0.115 (0.174) data 0.000 (0.072) loss 2.4029 (2.5695) ce_loss 1.0713 (1.1546) loss_zs_kd 0.3399 (0.3332) loss_oracle 0.3253 (0.3548) acc 68.7500 (57.6562) kd_loss 0.9989 (1.0709) lr 8.1262e-04 eta 0:19:16
epoch [30/50] batch [60/319] time 0.093 (0.149) data 0.000 (0.048) loss 2.5215 (2.5588) ce_loss 1.0723 (1.1465) loss_zs_kd 0.3458 (0.3324) loss_oracle 0.3883 (0.3523) acc 56.2500 (57.1354) kd_loss 1.0822 (1.0700) lr 8.1262e-04 eta 0:16:29
epoch [30/50] batch [80/319] time 0.088 (0.133) data 0.001 (0.036) loss 2.5214 (2.5528) ce_loss 1.2285 (1.1432) loss_zs_kd 0.2717 (0.3317) loss_oracle 0.3425 (0.3528) acc 50.0000 (57.7734) kd_loss 0.9858 (1.0674) lr 8.1262e-04 eta 0:14:39
epoch [30/50] batch [100/319] time 0.147 (0.129) data 0.000 (0.029) loss 2.4901 (2.5531) ce_loss 1.0381 (1.1416) loss_zs_kd 0.3611 (0.3298) loss_oracle 0.3376 (0.3503) acc 68.7500 (57.9688) kd_loss 1.1027 (1.0715) lr 8.1262e-04 eta 0:14:13
epoch [30/50] batch [120/319] time 0.087 (0.122) data 0.000 (0.024) loss 2.4546 (2.5605) ce_loss 1.1484 (1.1460) loss_zs_kd 0.3004 (0.3286) loss_oracle 0.3627 (0.3516) acc 56.2500 (57.7083) kd_loss 0.9747 (1.0744) lr 8.1262e-04 eta 0:13:22
epoch [30/50] batch [140/319] time 0.166 (0.125) data 0.000 (0.021) loss 2.2644 (2.5430) ce_loss 0.8521 (1.1351) loss_zs_kd 0.3168 (0.3275) loss_oracle 0.3404 (0.3523) acc 62.5000 (58.1473) kd_loss 1.0837 (1.0680) lr 8.1262e-04 eta 0:13:39
epoch [30/50] batch [160/319] time 0.080 (0.122) data 0.000 (0.018) loss 2.5186 (2.5368) ce_loss 1.1650 (1.1309) loss_zs_kd 0.2293 (0.3245) loss_oracle 0.3833 (0.3525) acc 53.1250 (58.2812) kd_loss 1.0473 (1.0674) lr 8.1262e-04 eta 0:13:18
epoch [30/50] batch [180/319] time 0.093 (0.119) data 0.001 (0.016) loss 2.3601 (2.5303) ce_loss 1.1045 (1.1279) loss_zs_kd 0.3363 (0.3217) loss_oracle 0.3807 (0.3524) acc 59.3750 (58.2465) kd_loss 0.8971 (1.0653) lr 8.1262e-04 eta 0:12:55
epoch [30/50] batch [200/319] time 0.099 (0.117) data 0.000 (0.015) loss 2.5458 (2.5222) ce_loss 1.1357 (1.1216) loss_zs_kd 0.3279 (0.3217) loss_oracle 0.3667 (0.3524) acc 53.1250 (58.5156) kd_loss 1.0628 (1.0635) lr 8.1262e-04 eta 0:12:40
epoch [30/50] batch [220/319] time 0.097 (0.116) data 0.000 (0.013) loss 2.2463 (2.5209) ce_loss 0.9526 (1.1200) loss_zs_kd 0.3119 (0.3247) loss_oracle 0.4039 (0.3527) acc 71.8750 (58.7926) kd_loss 0.9357 (1.0622) lr 8.1262e-04 eta 0:12:28
epoch [30/50] batch [240/319] time 0.094 (0.114) data 0.000 (0.012) loss 2.5009 (2.5281) ce_loss 0.9893 (1.1255) loss_zs_kd 0.3450 (0.3255) loss_oracle 0.3742 (0.3525) acc 65.6250 (58.4766) kd_loss 1.1521 (1.0637) lr 8.1262e-04 eta 0:12:19
epoch [30/50] batch [260/319] time 0.093 (0.113) data 0.000 (0.011) loss 2.6478 (2.5263) ce_loss 1.2051 (1.1245) loss_zs_kd 0.3020 (0.3254) loss_oracle 0.3825 (0.3533) acc 43.7500 (58.4014) kd_loss 1.1005 (1.0624) lr 8.1262e-04 eta 0:12:08
epoch [30/50] batch [280/319] time 0.097 (0.112) data 0.000 (0.010) loss 2.4188 (2.5203) ce_loss 1.1045 (1.1204) loss_zs_kd 0.3066 (0.3242) loss_oracle 0.3941 (0.3529) acc 62.5000 (58.6161) kd_loss 0.9640 (1.0614) lr 8.1262e-04 eta 0:12:01
epoch [30/50] batch [300/319] time 0.078 (0.111) data 0.000 (0.010) loss 2.7807 (2.5155) ce_loss 1.3975 (1.1179) loss_zs_kd 0.3214 (0.3237) loss_oracle 0.3588 (0.3525) acc 50.0000 (58.8229) kd_loss 1.0431 (1.0595) lr 8.1262e-04 eta 0:11:50
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,741
* accuracy: 62.6%
* error: 37.4%
* macro_f1: 54.4%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,651
* accuracy: 47.8%
* error: 52.2%
* macro_f1: 22.4%
******* Domain 2 best val acc:      62.6%, epoch: 30 *******
******* Domain 2 best val test acc: 47.8%, epoch: 30 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [31/50] batch [20/319] time 0.092 (0.206) data 0.000 (0.114) loss 2.2565 (2.4229) ce_loss 1.0449 (1.0580) loss_zs_kd 0.3190 (0.3220) loss_oracle 0.3076 (0.3433) acc 62.5000 (61.2500) kd_loss 0.8983 (1.0322) lr 7.5131e-04 eta 0:21:50
epoch [31/50] batch [40/319] time 0.100 (0.153) data 0.000 (0.057) loss 2.5604 (2.4644) ce_loss 1.1240 (1.0827) loss_zs_kd 0.2942 (0.3266) loss_oracle 0.3849 (0.3412) acc 59.3750 (60.1562) kd_loss 1.0968 (1.0477) lr 7.5131e-04 eta 0:16:10
epoch [31/50] batch [60/319] time 0.099 (0.136) data 0.000 (0.038) loss 2.4742 (2.4819) ce_loss 1.0391 (1.1008) loss_zs_kd 0.3055 (0.3242) loss_oracle 0.3804 (0.3423) acc 62.5000 (59.4792) kd_loss 1.0922 (1.0479) lr 7.5131e-04 eta 0:14:19
epoch [31/50] batch [80/319] time 0.099 (0.127) data 0.000 (0.029) loss 2.6479 (2.4824) ce_loss 1.2158 (1.1061) loss_zs_kd 0.3233 (0.3244) loss_oracle 0.3235 (0.3439) acc 46.8750 (59.2188) kd_loss 1.1087 (1.0421) lr 7.5131e-04 eta 0:13:20
epoch [31/50] batch [100/319] time 0.100 (0.122) data 0.001 (0.023) loss 2.6258 (2.4755) ce_loss 1.2568 (1.1023) loss_zs_kd 0.3603 (0.3290) loss_oracle 0.3197 (0.3430) acc 50.0000 (59.1875) kd_loss 1.0289 (1.0371) lr 7.5131e-04 eta 0:12:46
epoch [31/50] batch [120/319] time 0.099 (0.119) data 0.001 (0.019) loss 2.4717 (2.4723) ce_loss 1.0498 (1.1085) loss_zs_kd 0.2705 (0.3261) loss_oracle 0.3560 (0.3432) acc 53.1250 (58.3073) kd_loss 1.1087 (1.0292) lr 7.5131e-04 eta 0:12:22
epoch [31/50] batch [140/319] time 0.094 (0.116) data 0.000 (0.017) loss 2.5799 (2.4744) ce_loss 1.1172 (1.1139) loss_zs_kd 0.3067 (0.3268) loss_oracle 0.4357 (0.3460) acc 56.2500 (57.9688) kd_loss 1.0915 (1.0241) lr 7.5131e-04 eta 0:12:05
epoch [31/50] batch [160/319] time 0.085 (0.113) data 0.000 (0.015) loss 2.6080 (2.4699) ce_loss 1.2451 (1.1133) loss_zs_kd 0.3232 (0.3309) loss_oracle 0.3256 (0.3460) acc 50.0000 (58.0469) kd_loss 1.0385 (1.0181) lr 7.5131e-04 eta 0:11:43
epoch [31/50] batch [180/319] time 0.158 (0.113) data 0.000 (0.013) loss 2.8384 (2.4773) ce_loss 1.4180 (1.1201) loss_zs_kd 0.2888 (0.3293) loss_oracle 0.3397 (0.3474) acc 46.8750 (58.0035) kd_loss 1.1061 (1.0188) lr 7.5131e-04 eta 0:11:39
epoch [31/50] batch [200/319] time 0.076 (0.110) data 0.000 (0.012) loss 2.5121 (2.4824) ce_loss 1.1934 (1.1239) loss_zs_kd 0.3763 (0.3310) loss_oracle 0.3707 (0.3484) acc 53.1250 (57.9219) kd_loss 0.9452 (1.0188) lr 7.5131e-04 eta 0:11:20
epoch [31/50] batch [220/319] time 0.160 (0.109) data 0.000 (0.011) loss 2.1926 (2.4792) ce_loss 0.8770 (1.1214) loss_zs_kd 0.4262 (0.3318) loss_oracle 0.4116 (0.3508) acc 71.8750 (58.1534) kd_loss 0.8968 (1.0165) lr 7.5131e-04 eta 0:11:10
epoch [31/50] batch [240/319] time 0.060 (0.111) data 0.000 (0.010) loss 2.2918 (2.4763) ce_loss 1.0957 (1.1214) loss_zs_kd 0.2669 (0.3313) loss_oracle 0.3499 (0.3522) acc 59.3750 (58.1771) kd_loss 0.8877 (1.0132) lr 7.5131e-04 eta 0:11:23
epoch [31/50] batch [260/319] time 0.069 (0.108) data 0.000 (0.009) loss 2.5787 (2.4690) ce_loss 1.1533 (1.1183) loss_zs_kd 0.3238 (0.3309) loss_oracle 0.3915 (0.3536) acc 59.3750 (58.3173) kd_loss 1.0677 (1.0084) lr 7.5131e-04 eta 0:11:00
epoch [31/50] batch [280/319] time 0.086 (0.106) data 0.000 (0.008) loss 2.4012 (2.4717) ce_loss 1.0508 (1.1243) loss_zs_kd 0.3537 (0.3313) loss_oracle 0.3860 (0.3530) acc 46.8750 (57.8348) kd_loss 0.9806 (1.0053) lr 7.5131e-04 eta 0:10:46
epoch [31/50] batch [300/319] time 0.110 (0.105) data 0.000 (0.008) loss 2.2114 (2.4751) ce_loss 0.9175 (1.1266) loss_zs_kd 0.3038 (0.3320) loss_oracle 0.3871 (0.3532) acc 75.0000 (57.8438) kd_loss 0.9485 (1.0059) lr 7.5131e-04 eta 0:10:39
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,665
* accuracy: 60.9%
* error: 39.1%
* macro_f1: 52.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,769
* accuracy: 49.0%
* error: 51.0%
* macro_f1: 22.4%
******* Domain 2 best val acc:      62.6%, epoch: 30 *******
******* Domain 2 best val test acc: 47.8%, epoch: 30 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [32/50] batch [20/319] time 0.170 (0.276) data 0.000 (0.156) loss 2.4237 (2.5299) ce_loss 1.0957 (1.1439) loss_zs_kd 0.4091 (0.3484) loss_oracle 0.3645 (0.3713) acc 46.8750 (55.1562) kd_loss 0.9412 (1.0262) lr 6.9098e-04 eta 0:27:46
epoch [32/50] batch [40/319] time 0.078 (0.201) data 0.000 (0.078) loss 2.7624 (2.4987) ce_loss 1.2461 (1.1362) loss_zs_kd 0.3191 (0.3383) loss_oracle 0.3157 (0.3634) acc 50.0000 (56.9531) kd_loss 1.1989 (1.0117) lr 6.9098e-04 eta 0:20:09
epoch [32/50] batch [60/319] time 0.106 (0.164) data 0.000 (0.052) loss 2.3801 (2.4971) ce_loss 1.0029 (1.1261) loss_zs_kd 0.2634 (0.3384) loss_oracle 0.3218 (0.3602) acc 62.5000 (57.9688) kd_loss 1.0845 (1.0217) lr 6.9098e-04 eta 0:16:24
epoch [32/50] batch [80/319] time 0.104 (0.148) data 0.000 (0.039) loss 2.5068 (2.4949) ce_loss 1.0225 (1.1215) loss_zs_kd 0.3159 (0.3371) loss_oracle 0.3434 (0.3555) acc 62.5000 (58.1250) kd_loss 1.1547 (1.0271) lr 6.9098e-04 eta 0:14:43
epoch [32/50] batch [100/319] time 0.105 (0.139) data 0.000 (0.031) loss 2.3547 (2.5075) ce_loss 0.9746 (1.1348) loss_zs_kd 0.2756 (0.3321) loss_oracle 0.3172 (0.3539) acc 62.5000 (57.5938) kd_loss 1.0837 (1.0296) lr 6.9098e-04 eta 0:13:47
epoch [32/50] batch [120/319] time 0.102 (0.132) data 0.000 (0.026) loss 2.6457 (2.4998) ce_loss 1.1084 (1.1254) loss_zs_kd 0.3567 (0.3297) loss_oracle 0.3324 (0.3526) acc 65.6250 (57.8646) kd_loss 1.1928 (1.0332) lr 6.9098e-04 eta 0:13:04
epoch [32/50] batch [140/319] time 0.106 (0.127) data 0.000 (0.022) loss 2.5276 (2.5032) ce_loss 1.1602 (1.1255) loss_zs_kd 0.3751 (0.3297) loss_oracle 0.3826 (0.3521) acc 56.2500 (57.6562) kd_loss 0.9886 (1.0367) lr 6.9098e-04 eta 0:12:34
epoch [32/50] batch [160/319] time 0.094 (0.124) data 0.000 (0.020) loss 2.6218 (2.5061) ce_loss 1.2070 (1.1292) loss_zs_kd 0.2993 (0.3275) loss_oracle 0.3611 (0.3513) acc 53.1250 (57.5000) kd_loss 1.0846 (1.0375) lr 6.9098e-04 eta 0:12:13
epoch [32/50] batch [180/319] time 0.086 (0.121) data 0.001 (0.018) loss 2.5834 (2.5081) ce_loss 1.2617 (1.1256) loss_zs_kd 0.2966 (0.3281) loss_oracle 0.3017 (0.3495) acc 46.8750 (57.7778) kd_loss 1.0225 (1.0437) lr 6.9098e-04 eta 0:11:52
epoch [32/50] batch [200/319] time 0.075 (0.116) data 0.000 (0.016) loss 2.6414 (2.5071) ce_loss 1.1309 (1.1227) loss_zs_kd 0.3022 (0.3279) loss_oracle 0.3166 (0.3505) acc 56.2500 (58.1094) kd_loss 1.2012 (1.0452) lr 6.9098e-04 eta 0:11:21
epoch [32/50] batch [220/319] time 0.085 (0.117) data 0.000 (0.014) loss 2.4646 (2.5011) ce_loss 1.0186 (1.1171) loss_zs_kd 0.2685 (0.3270) loss_oracle 0.3476 (0.3517) acc 59.3750 (58.2386) kd_loss 1.1380 (1.0447) lr 6.9098e-04 eta 0:11:20
epoch [32/50] batch [240/319] time 0.089 (0.114) data 0.000 (0.013) loss 2.3795 (2.5026) ce_loss 0.8784 (1.1185) loss_zs_kd 0.2897 (0.3267) loss_oracle 0.3440 (0.3514) acc 65.6250 (58.3984) kd_loss 1.1843 (1.0450) lr 6.9098e-04 eta 0:11:03
epoch [32/50] batch [260/319] time 0.075 (0.118) data 0.000 (0.012) loss 2.5222 (2.5027) ce_loss 1.0771 (1.1213) loss_zs_kd 0.2956 (0.3267) loss_oracle 0.3511 (0.3519) acc 59.3750 (58.1611) kd_loss 1.1217 (1.0421) lr 6.9098e-04 eta 0:11:23
epoch [32/50] batch [280/319] time 0.080 (0.115) data 0.000 (0.011) loss 2.3652 (2.4994) ce_loss 1.2119 (1.1234) loss_zs_kd 0.3253 (0.3265) loss_oracle 0.3196 (0.3536) acc 59.3750 (58.0692) kd_loss 0.8308 (1.0359) lr 6.9098e-04 eta 0:11:06
epoch [32/50] batch [300/319] time 0.104 (0.114) data 0.000 (0.011) loss 2.2446 (2.4913) ce_loss 1.0820 (1.1205) loss_zs_kd 0.2645 (0.3288) loss_oracle 0.3916 (0.3548) acc 62.5000 (58.0938) kd_loss 0.8346 (1.0290) lr 6.9098e-04 eta 0:10:57
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,671
* accuracy: 61.0%
* error: 39.0%
* macro_f1: 52.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,693
* accuracy: 48.2%
* error: 51.8%
* macro_f1: 22.5%
******* Domain 2 best val acc:      62.6%, epoch: 30 *******
******* Domain 2 best val test acc: 47.8%, epoch: 30 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [33/50] batch [20/319] time 0.096 (0.227) data 0.000 (0.126) loss 2.7241 (2.3999) ce_loss 1.3760 (1.1100) loss_zs_kd 0.3061 (0.3412) loss_oracle 0.3728 (0.3657) acc 50.0000 (58.7500) kd_loss 1.0087 (0.9364) lr 6.3188e-04 eta 0:21:36
epoch [33/50] batch [40/319] time 0.078 (0.156) data 0.000 (0.063) loss 2.3901 (2.4198) ce_loss 1.0625 (1.1125) loss_zs_kd 0.4051 (0.3333) loss_oracle 0.3353 (0.3634) acc 59.3750 (60.0781) kd_loss 0.9574 (0.9590) lr 6.3188e-04 eta 0:14:49
epoch [33/50] batch [60/319] time 0.160 (0.135) data 0.000 (0.042) loss 2.0252 (2.4259) ce_loss 0.8003 (1.1106) loss_zs_kd 0.2683 (0.3303) loss_oracle 0.3606 (0.3557) acc 65.6250 (59.9479) kd_loss 0.9105 (0.9723) lr 6.3188e-04 eta 0:12:47
epoch [33/50] batch [80/319] time 0.082 (0.128) data 0.000 (0.032) loss 2.3088 (2.4373) ce_loss 1.0186 (1.1028) loss_zs_kd 0.3825 (0.3368) loss_oracle 0.3340 (0.3523) acc 62.5000 (60.5469) kd_loss 0.9320 (0.9900) lr 6.3188e-04 eta 0:12:04
epoch [33/50] batch [100/319] time 0.161 (0.124) data 0.000 (0.025) loss 2.6092 (2.4386) ce_loss 1.2627 (1.1067) loss_zs_kd 0.2937 (0.3334) loss_oracle 0.3860 (0.3524) acc 56.2500 (60.0625) kd_loss 1.0066 (0.9890) lr 6.3188e-04 eta 0:11:41
epoch [33/50] batch [120/319] time 0.076 (0.125) data 0.000 (0.021) loss 2.6977 (2.4389) ce_loss 1.3438 (1.1060) loss_zs_kd 0.2992 (0.3318) loss_oracle 0.3243 (0.3505) acc 50.0000 (59.9740) kd_loss 1.0421 (0.9917) lr 6.3188e-04 eta 0:11:45
epoch [33/50] batch [140/319] time 0.081 (0.119) data 0.000 (0.018) loss 2.3645 (2.4408) ce_loss 1.0381 (1.1054) loss_zs_kd 0.3557 (0.3306) loss_oracle 0.3369 (0.3513) acc 62.5000 (59.6205) kd_loss 0.9801 (0.9945) lr 6.3188e-04 eta 0:11:08
epoch [33/50] batch [160/319] time 0.110 (0.117) data 0.001 (0.016) loss 2.0985 (2.4424) ce_loss 0.7930 (1.1074) loss_zs_kd 0.3164 (0.3326) loss_oracle 0.3818 (0.3514) acc 75.0000 (59.4336) kd_loss 0.9564 (0.9930) lr 6.3188e-04 eta 0:10:51
epoch [33/50] batch [180/319] time 0.111 (0.115) data 0.000 (0.014) loss 2.6343 (2.4530) ce_loss 1.2207 (1.1194) loss_zs_kd 0.4512 (0.3315) loss_oracle 0.3636 (0.3522) acc 53.1250 (58.7153) kd_loss 1.0062 (0.9917) lr 6.3188e-04 eta 0:10:40
epoch [33/50] batch [200/319] time 0.094 (0.114) data 0.000 (0.013) loss 2.2323 (2.4505) ce_loss 0.9141 (1.1192) loss_zs_kd 0.4264 (0.3322) loss_oracle 0.4022 (0.3534) acc 65.6250 (58.6406) kd_loss 0.9039 (0.9885) lr 6.3188e-04 eta 0:10:31
epoch [33/50] batch [220/319] time 0.102 (0.113) data 0.000 (0.012) loss 2.2298 (2.4453) ce_loss 0.8462 (1.1147) loss_zs_kd 0.3140 (0.3305) loss_oracle 0.3512 (0.3538) acc 62.5000 (58.8210) kd_loss 1.0510 (0.9885) lr 6.3188e-04 eta 0:10:22
epoch [33/50] batch [240/319] time 0.105 (0.112) data 0.000 (0.011) loss 2.4364 (2.4436) ce_loss 1.1182 (1.1155) loss_zs_kd 0.3958 (0.3316) loss_oracle 0.3592 (0.3543) acc 50.0000 (58.7109) kd_loss 0.9407 (0.9852) lr 6.3188e-04 eta 0:10:14
epoch [33/50] batch [260/319] time 0.097 (0.111) data 0.000 (0.010) loss 2.3085 (2.4404) ce_loss 1.2393 (1.1196) loss_zs_kd 0.2980 (0.3311) loss_oracle 0.4121 (0.3546) acc 46.8750 (58.3894) kd_loss 0.7142 (0.9779) lr 6.3188e-04 eta 0:10:07
epoch [33/50] batch [280/319] time 0.073 (0.109) data 0.000 (0.009) loss 2.2254 (2.4309) ce_loss 0.9316 (1.1170) loss_zs_kd 0.2742 (0.3303) loss_oracle 0.3231 (0.3540) acc 71.8750 (58.4152) kd_loss 0.9951 (0.9717) lr 6.3188e-04 eta 0:09:54
epoch [33/50] batch [300/319] time 0.084 (0.107) data 0.000 (0.009) loss 2.1150 (2.4274) ce_loss 0.8740 (1.1191) loss_zs_kd 0.2961 (0.3292) loss_oracle 0.3116 (0.3531) acc 71.8750 (58.2500) kd_loss 0.9371 (0.9671) lr 6.3188e-04 eta 0:09:42
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,716
* accuracy: 62.0%
* error: 38.0%
* macro_f1: 54.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,613
* accuracy: 47.4%
* error: 52.6%
* macro_f1: 22.8%
******* Domain 2 best val acc:      62.6%, epoch: 30 *******
******* Domain 2 best val test acc: 47.8%, epoch: 30 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [34/50] batch [20/319] time 0.092 (0.258) data 0.000 (0.157) loss 2.4492 (2.4083) ce_loss 1.3525 (1.1281) loss_zs_kd 0.3502 (0.3318) loss_oracle 0.3560 (0.3502) acc 56.2500 (59.5312) kd_loss 0.7436 (0.9392) lr 5.7422e-04 eta 0:23:14
epoch [34/50] batch [40/319] time 0.095 (0.180) data 0.000 (0.079) loss 2.3555 (2.4123) ce_loss 1.0723 (1.1252) loss_zs_kd 0.2641 (0.3342) loss_oracle 0.3905 (0.3583) acc 56.2500 (58.8281) kd_loss 0.9559 (0.9409) lr 5.7422e-04 eta 0:16:06
epoch [34/50] batch [60/319] time 0.091 (0.153) data 0.000 (0.053) loss 2.5118 (2.4035) ce_loss 1.2422 (1.1054) loss_zs_kd 0.2991 (0.3307) loss_oracle 0.3445 (0.3553) acc 50.0000 (59.4271) kd_loss 0.9478 (0.9552) lr 5.7422e-04 eta 0:13:39
epoch [34/50] batch [80/319] time 0.102 (0.140) data 0.000 (0.039) loss 2.4703 (2.3935) ce_loss 1.2695 (1.1012) loss_zs_kd 0.3522 (0.3271) loss_oracle 0.3381 (0.3518) acc 59.3750 (59.3750) kd_loss 0.8556 (0.9528) lr 5.7422e-04 eta 0:12:26
epoch [34/50] batch [100/319] time 0.091 (0.132) data 0.000 (0.032) loss 2.3107 (2.4028) ce_loss 1.0645 (1.1030) loss_zs_kd 0.3086 (0.3301) loss_oracle 0.3436 (0.3508) acc 71.8750 (59.3750) kd_loss 0.9202 (0.9594) lr 5.7422e-04 eta 0:11:40
epoch [34/50] batch [120/319] time 0.087 (0.124) data 0.000 (0.026) loss 2.2856 (2.3922) ce_loss 1.1328 (1.0926) loss_zs_kd 0.3416 (0.3287) loss_oracle 0.2737 (0.3483) acc 62.5000 (59.2969) kd_loss 0.8451 (0.9611) lr 5.7422e-04 eta 0:10:58
epoch [34/50] batch [140/319] time 0.079 (0.119) data 0.000 (0.023) loss 2.4750 (2.3999) ce_loss 1.2852 (1.0977) loss_zs_kd 0.2790 (0.3274) loss_oracle 0.3688 (0.3484) acc 53.1250 (58.9509) kd_loss 0.8659 (0.9643) lr 5.7422e-04 eta 0:10:26
epoch [34/50] batch [160/319] time 0.081 (0.118) data 0.000 (0.020) loss 2.5001 (2.4049) ce_loss 1.1436 (1.1034) loss_zs_kd 0.3456 (0.3274) loss_oracle 0.3266 (0.3488) acc 46.8750 (58.9648) kd_loss 1.0204 (0.9634) lr 5.7422e-04 eta 0:10:23
epoch [34/50] batch [180/319] time 0.085 (0.115) data 0.000 (0.018) loss 2.4417 (2.4094) ce_loss 1.0967 (1.1070) loss_zs_kd 0.4193 (0.3278) loss_oracle 0.3417 (0.3485) acc 56.2500 (58.8021) kd_loss 0.9645 (0.9642) lr 5.7422e-04 eta 0:10:01
epoch [34/50] batch [200/319] time 0.167 (0.118) data 0.000 (0.016) loss 2.1408 (2.4104) ce_loss 1.0439 (1.1141) loss_zs_kd 0.2244 (0.3250) loss_oracle 0.3073 (0.3472) acc 65.6250 (58.6094) kd_loss 0.8310 (0.9603) lr 5.7422e-04 eta 0:10:17
epoch [34/50] batch [220/319] time 0.085 (0.116) data 0.000 (0.015) loss 2.1561 (2.4069) ce_loss 0.8115 (1.1140) loss_zs_kd 0.4058 (0.3257) loss_oracle 0.3629 (0.3478) acc 68.7500 (58.4659) kd_loss 0.9603 (0.9561) lr 5.7422e-04 eta 0:10:03
epoch [34/50] batch [240/319] time 0.118 (0.114) data 0.000 (0.013) loss 2.4097 (2.4026) ce_loss 1.1396 (1.1113) loss_zs_kd 0.3558 (0.3268) loss_oracle 0.3262 (0.3474) acc 59.3750 (58.8281) kd_loss 0.9290 (0.9543) lr 5.7422e-04 eta 0:09:50
epoch [34/50] batch [260/319] time 0.106 (0.113) data 0.000 (0.012) loss 2.2136 (2.4001) ce_loss 0.8916 (1.1061) loss_zs_kd 0.3383 (0.3263) loss_oracle 0.3204 (0.3472) acc 65.6250 (58.9784) kd_loss 0.9927 (0.9572) lr 5.7422e-04 eta 0:09:43
epoch [34/50] batch [280/319] time 0.106 (0.112) data 0.000 (0.011) loss 2.1346 (2.3990) ce_loss 0.8765 (1.1045) loss_zs_kd 0.3682 (0.3274) loss_oracle 0.3628 (0.3478) acc 75.0000 (59.0067) kd_loss 0.8926 (0.9569) lr 5.7422e-04 eta 0:09:37
epoch [34/50] batch [300/319] time 0.102 (0.112) data 0.000 (0.011) loss 2.3704 (2.4027) ce_loss 1.2090 (1.1069) loss_zs_kd 0.3351 (0.3275) loss_oracle 0.3568 (0.3482) acc 59.3750 (58.9688) kd_loss 0.8154 (0.9579) lr 5.7422e-04 eta 0:09:31
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,702
* accuracy: 61.7%
* error: 38.3%
* macro_f1: 54.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,738
* accuracy: 48.7%
* error: 51.3%
* macro_f1: 23.0%
******* Domain 2 best val acc:      62.6%, epoch: 30 *******
******* Domain 2 best val test acc: 47.8%, epoch: 30 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [35/50] batch [20/319] time 0.165 (0.278) data 0.000 (0.168) loss 2.4767 (2.4295) ce_loss 1.2295 (1.0824) loss_zs_kd 0.3176 (0.3188) loss_oracle 0.3660 (0.3531) acc 53.1250 (62.1875) kd_loss 0.9053 (1.0111) lr 5.1825e-04 eta 0:23:30
epoch [35/50] batch [40/319] time 0.086 (0.211) data 0.000 (0.084) loss 2.4328 (2.4486) ce_loss 1.0254 (1.0837) loss_zs_kd 0.3984 (0.3291) loss_oracle 0.3387 (0.3456) acc 65.6250 (61.0156) kd_loss 1.0389 (1.0275) lr 5.1825e-04 eta 0:17:47
epoch [35/50] batch [60/319] time 0.092 (0.168) data 0.000 (0.056) loss 2.4501 (2.4705) ce_loss 1.1172 (1.1039) loss_zs_kd 0.3417 (0.3239) loss_oracle 0.3425 (0.3482) acc 56.2500 (59.9479) kd_loss 0.9908 (1.0305) lr 5.1825e-04 eta 0:14:06
epoch [35/50] batch [80/319] time 0.110 (0.150) data 0.000 (0.042) loss 2.7082 (2.4577) ce_loss 1.1660 (1.0957) loss_zs_kd 0.3099 (0.3245) loss_oracle 0.3532 (0.3488) acc 62.5000 (60.1562) kd_loss 1.2107 (1.0254) lr 5.1825e-04 eta 0:12:35
epoch [35/50] batch [100/319] time 0.101 (0.140) data 0.000 (0.034) loss 2.4653 (2.4493) ce_loss 1.1738 (1.0886) loss_zs_kd 0.3966 (0.3270) loss_oracle 0.3425 (0.3481) acc 65.6250 (60.2812) kd_loss 0.9219 (1.0231) lr 5.1825e-04 eta 0:11:39
epoch [35/50] batch [120/319] time 0.098 (0.133) data 0.000 (0.028) loss 2.3943 (2.4513) ce_loss 1.1299 (1.0914) loss_zs_kd 0.3690 (0.3292) loss_oracle 0.3765 (0.3466) acc 62.5000 (60.2865) kd_loss 0.8917 (1.0220) lr 5.1825e-04 eta 0:11:03
epoch [35/50] batch [140/319] time 0.109 (0.129) data 0.000 (0.024) loss 2.5211 (2.4426) ce_loss 1.0859 (1.0841) loss_zs_kd 0.3049 (0.3297) loss_oracle 0.3603 (0.3479) acc 65.6250 (60.6696) kd_loss 1.1026 (1.0197) lr 5.1825e-04 eta 0:10:38
epoch [35/50] batch [160/319] time 0.096 (0.125) data 0.000 (0.021) loss 2.6453 (2.4482) ce_loss 1.1934 (1.0896) loss_zs_kd 0.3639 (0.3318) loss_oracle 0.3534 (0.3472) acc 53.1250 (60.1172) kd_loss 1.0933 (1.0191) lr 5.1825e-04 eta 0:10:15
epoch [35/50] batch [180/319] time 0.095 (0.122) data 0.000 (0.019) loss 2.4731 (2.4570) ce_loss 1.2480 (1.0990) loss_zs_kd 0.2887 (0.3328) loss_oracle 0.3790 (0.3457) acc 50.0000 (59.5486) kd_loss 0.8912 (1.0187) lr 5.1825e-04 eta 0:09:59
epoch [35/50] batch [200/319] time 0.075 (0.118) data 0.000 (0.017) loss 2.4601 (2.4614) ce_loss 1.1543 (1.1071) loss_zs_kd 0.2475 (0.3330) loss_oracle 0.2887 (0.3446) acc 56.2500 (59.2500) kd_loss 1.0377 (1.0155) lr 5.1825e-04 eta 0:09:39
epoch [35/50] batch [220/319] time 0.096 (0.115) data 0.000 (0.015) loss 2.5473 (2.4559) ce_loss 1.3008 (1.1026) loss_zs_kd 0.3175 (0.3329) loss_oracle 0.2952 (0.3442) acc 50.0000 (59.4318) kd_loss 0.9402 (1.0147) lr 5.1825e-04 eta 0:09:20
epoch [35/50] batch [240/319] time 0.077 (0.112) data 0.000 (0.014) loss 2.4740 (2.4602) ce_loss 1.1143 (1.1051) loss_zs_kd 0.3589 (0.3325) loss_oracle 0.3267 (0.3437) acc 50.0000 (59.3359) kd_loss 1.0169 (1.0170) lr 5.1825e-04 eta 0:09:03
epoch [35/50] batch [260/319] time 0.076 (0.110) data 0.000 (0.013) loss 2.2481 (2.4586) ce_loss 0.7603 (1.1021) loss_zs_kd 0.3710 (0.3327) loss_oracle 0.3358 (0.3439) acc 84.3750 (59.3389) kd_loss 1.1344 (1.0182) lr 5.1825e-04 eta 0:08:51
epoch [35/50] batch [280/319] time 0.071 (0.108) data 0.000 (0.012) loss 2.6148 (2.4610) ce_loss 1.2500 (1.1056) loss_zs_kd 0.3467 (0.3340) loss_oracle 0.3454 (0.3444) acc 53.1250 (59.2969) kd_loss 1.0188 (1.0162) lr 5.1825e-04 eta 0:08:39
epoch [35/50] batch [300/319] time 0.080 (0.106) data 0.000 (0.011) loss 2.4180 (2.4600) ce_loss 0.9819 (1.1042) loss_zs_kd 0.3307 (0.3342) loss_oracle 0.3638 (0.3449) acc 56.2500 (59.3542) kd_loss 1.0888 (1.0162) lr 5.1825e-04 eta 0:08:29
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,801
* accuracy: 64.0%
* error: 36.0%
* macro_f1: 55.6%
Checkpoint saved to icml/multi-dg/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,045
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 22.4%
******* Domain 2 best val acc:      64.0%, epoch: 35 *******
******* Domain 2 best val test acc: 51.8%, epoch: 35 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [36/50] batch [20/319] time 0.091 (0.268) data 0.000 (0.148) loss 2.4044 (2.4331) ce_loss 1.0898 (1.1247) loss_zs_kd 0.2378 (0.3384) loss_oracle 0.3486 (0.3390) acc 56.2500 (57.3438) kd_loss 1.0214 (0.9697) lr 4.6417e-04 eta 0:21:16
epoch [36/50] batch [40/319] time 0.109 (0.192) data 0.000 (0.074) loss 2.4866 (2.4480) ce_loss 1.1240 (1.1411) loss_zs_kd 0.3201 (0.3416) loss_oracle 0.3097 (0.3377) acc 59.3750 (56.6406) kd_loss 1.0476 (0.9672) lr 4.6417e-04 eta 0:15:11
epoch [36/50] batch [60/319] time 0.108 (0.163) data 0.000 (0.050) loss 2.5236 (2.4257) ce_loss 1.0889 (1.1203) loss_zs_kd 0.4206 (0.3411) loss_oracle 0.3071 (0.3389) acc 59.3750 (58.0208) kd_loss 1.0708 (0.9654) lr 4.6417e-04 eta 0:12:51
epoch [36/50] batch [80/319] time 0.105 (0.149) data 0.000 (0.037) loss 2.3545 (2.4362) ce_loss 1.0723 (1.1324) loss_zs_kd 0.3587 (0.3321) loss_oracle 0.3874 (0.3383) acc 59.3750 (57.3438) kd_loss 0.9091 (0.9687) lr 4.6417e-04 eta 0:11:40
epoch [36/50] batch [100/319] time 0.100 (0.141) data 0.000 (0.030) loss 2.2771 (2.4273) ce_loss 1.0596 (1.1246) loss_zs_kd 0.4072 (0.3298) loss_oracle 0.3162 (0.3403) acc 62.5000 (57.5625) kd_loss 0.8558 (0.9676) lr 4.6417e-04 eta 0:11:00
epoch [36/50] batch [120/319] time 0.105 (0.135) data 0.000 (0.025) loss 2.6073 (2.4270) ce_loss 1.0596 (1.1182) loss_zs_kd 0.3090 (0.3291) loss_oracle 0.3592 (0.3409) acc 56.2500 (57.9688) kd_loss 1.2137 (0.9738) lr 4.6417e-04 eta 0:10:28
epoch [36/50] batch [140/319] time 0.109 (0.130) data 0.000 (0.021) loss 2.5880 (2.4301) ce_loss 1.0771 (1.1167) loss_zs_kd 0.2794 (0.3292) loss_oracle 0.3798 (0.3420) acc 59.3750 (58.0580) kd_loss 1.1813 (0.9777) lr 4.6417e-04 eta 0:10:04
epoch [36/50] batch [160/319] time 0.096 (0.127) data 0.000 (0.019) loss 2.4869 (2.4279) ce_loss 1.0713 (1.1136) loss_zs_kd 0.2759 (0.3299) loss_oracle 0.3766 (0.3432) acc 62.5000 (58.2812) kd_loss 1.0894 (0.9777) lr 4.6417e-04 eta 0:09:46
epoch [36/50] batch [180/319] time 0.096 (0.124) data 0.000 (0.017) loss 2.7002 (2.4285) ce_loss 1.3154 (1.1112) loss_zs_kd 0.3350 (0.3289) loss_oracle 0.3877 (0.3434) acc 46.8750 (58.5069) kd_loss 1.0235 (0.9811) lr 4.6417e-04 eta 0:09:31
epoch [36/50] batch [200/319] time 0.106 (0.122) data 0.000 (0.015) loss 2.2913 (2.4315) ce_loss 0.9839 (1.1097) loss_zs_kd 0.3239 (0.3314) loss_oracle 0.3231 (0.3426) acc 62.5000 (58.6406) kd_loss 0.9839 (0.9848) lr 4.6417e-04 eta 0:09:18
epoch [36/50] batch [220/319] time 0.097 (0.120) data 0.000 (0.014) loss 2.5818 (2.4372) ce_loss 1.0225 (1.1106) loss_zs_kd 0.3579 (0.3340) loss_oracle 0.3918 (0.3433) acc 59.3750 (58.4659) kd_loss 1.1845 (0.9879) lr 4.6417e-04 eta 0:09:06
epoch [36/50] batch [240/319] time 0.087 (0.118) data 0.000 (0.013) loss 2.4835 (2.4437) ce_loss 1.1230 (1.1128) loss_zs_kd 0.4380 (0.3366) loss_oracle 0.3415 (0.3437) acc 53.1250 (58.5026) kd_loss 0.9707 (0.9908) lr 4.6417e-04 eta 0:08:55
epoch [36/50] batch [260/319] time 0.078 (0.119) data 0.000 (0.012) loss 2.5356 (2.4471) ce_loss 1.2178 (1.1138) loss_zs_kd 0.2873 (0.3372) loss_oracle 0.2967 (0.3436) acc 50.0000 (58.2572) kd_loss 1.0258 (0.9929) lr 4.6417e-04 eta 0:08:59
epoch [36/50] batch [280/319] time 0.075 (0.119) data 0.000 (0.011) loss 2.6063 (2.4524) ce_loss 1.2637 (1.1141) loss_zs_kd 0.3058 (0.3367) loss_oracle 0.3295 (0.3433) acc 56.2500 (58.2031) kd_loss 1.0249 (0.9983) lr 4.6417e-04 eta 0:08:54
epoch [36/50] batch [300/319] time 0.096 (0.117) data 0.000 (0.010) loss 2.4526 (2.4541) ce_loss 1.2686 (1.1137) loss_zs_kd 0.3577 (0.3376) loss_oracle 0.3557 (0.3436) acc 46.8750 (58.3854) kd_loss 0.8274 (0.9998) lr 4.6417e-04 eta 0:08:44
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,670
* accuracy: 61.0%
* error: 39.0%
* macro_f1: 53.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,930
* accuracy: 50.6%
* error: 49.4%
* macro_f1: 23.8%
******* Domain 2 best val acc:      64.0%, epoch: 35 *******
******* Domain 2 best val test acc: 51.8%, epoch: 35 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [37/50] batch [20/319] time 0.093 (0.247) data 0.000 (0.143) loss 2.4448 (2.4574) ce_loss 1.0547 (1.0701) loss_zs_kd 0.4390 (0.3429) loss_oracle 0.3982 (0.3423) acc 62.5000 (60.9375) kd_loss 0.9716 (1.0447) lr 4.1221e-04 eta 0:18:17
epoch [37/50] batch [40/319] time 0.098 (0.174) data 0.000 (0.072) loss 2.7059 (2.4475) ce_loss 1.2373 (1.0658) loss_zs_kd 0.2865 (0.3379) loss_oracle 0.3928 (0.3401) acc 53.1250 (60.6250) kd_loss 1.1290 (1.0427) lr 4.1221e-04 eta 0:12:48
epoch [37/50] batch [60/319] time 0.109 (0.148) data 0.000 (0.048) loss 2.4021 (2.4737) ce_loss 1.0176 (1.0837) loss_zs_kd 0.4005 (0.3366) loss_oracle 0.3347 (0.3369) acc 68.7500 (59.7917) kd_loss 1.0169 (1.0533) lr 4.1221e-04 eta 0:10:53
epoch [37/50] batch [80/319] time 0.076 (0.133) data 0.000 (0.036) loss 2.7083 (2.5067) ce_loss 1.3340 (1.1045) loss_zs_kd 0.3054 (0.3381) loss_oracle 0.3395 (0.3377) acc 46.8750 (59.3750) kd_loss 1.0518 (1.0642) lr 4.1221e-04 eta 0:09:43
epoch [37/50] batch [100/319] time 0.081 (0.135) data 0.000 (0.029) loss 2.7319 (2.5118) ce_loss 1.2471 (1.1029) loss_zs_kd 0.3568 (0.3380) loss_oracle 0.3190 (0.3384) acc 50.0000 (59.2812) kd_loss 1.1469 (1.0707) lr 4.1221e-04 eta 0:09:50
epoch [37/50] batch [120/319] time 0.167 (0.129) data 0.000 (0.024) loss 2.6523 (2.5160) ce_loss 1.3047 (1.1051) loss_zs_kd 0.4092 (0.3394) loss_oracle 0.3142 (0.3373) acc 56.2500 (59.3750) kd_loss 0.9859 (1.0726) lr 4.1221e-04 eta 0:09:20
epoch [37/50] batch [140/319] time 0.092 (0.125) data 0.000 (0.021) loss 2.3950 (2.5223) ce_loss 0.9375 (1.1073) loss_zs_kd 0.3316 (0.3399) loss_oracle 0.3567 (0.3376) acc 62.5000 (58.8170) kd_loss 1.1133 (1.0763) lr 4.1221e-04 eta 0:09:02
epoch [37/50] batch [160/319] time 0.094 (0.122) data 0.000 (0.018) loss 2.7136 (2.5305) ce_loss 1.2148 (1.1103) loss_zs_kd 0.3076 (0.3390) loss_oracle 0.4117 (0.3373) acc 56.2500 (58.8672) kd_loss 1.1391 (1.0821) lr 4.1221e-04 eta 0:08:45
epoch [37/50] batch [180/319] time 0.101 (0.119) data 0.000 (0.016) loss 2.5128 (2.5314) ce_loss 1.1865 (1.1122) loss_zs_kd 0.3703 (0.3389) loss_oracle 0.4096 (0.3382) acc 62.5000 (58.8715) kd_loss 0.9363 (1.0807) lr 4.1221e-04 eta 0:08:31
epoch [37/50] batch [200/319] time 0.098 (0.118) data 0.000 (0.015) loss 2.3608 (2.5225) ce_loss 1.1035 (1.1079) loss_zs_kd 0.3271 (0.3382) loss_oracle 0.3031 (0.3378) acc 62.5000 (59.0000) kd_loss 0.9422 (1.0766) lr 4.1221e-04 eta 0:08:21
epoch [37/50] batch [220/319] time 0.098 (0.116) data 0.000 (0.013) loss 2.5001 (2.5234) ce_loss 1.2412 (1.1050) loss_zs_kd 0.3126 (0.3358) loss_oracle 0.3164 (0.3366) acc 56.2500 (59.2330) kd_loss 0.9444 (1.0823) lr 4.1221e-04 eta 0:08:12
epoch [37/50] batch [240/319] time 0.101 (0.114) data 0.000 (0.012) loss 2.3836 (2.5264) ce_loss 1.0781 (1.1011) loss_zs_kd 0.3973 (0.3362) loss_oracle 0.3027 (0.3370) acc 59.3750 (59.2578) kd_loss 0.9555 (1.0887) lr 4.1221e-04 eta 0:08:03
epoch [37/50] batch [260/319] time 0.101 (0.113) data 0.000 (0.011) loss 2.7822 (2.5380) ce_loss 1.3486 (1.1091) loss_zs_kd 0.3056 (0.3371) loss_oracle 0.3117 (0.3378) acc 40.6250 (58.8822) kd_loss 1.1249 (1.0914) lr 4.1221e-04 eta 0:07:55
epoch [37/50] batch [280/319] time 0.103 (0.112) data 0.000 (0.010) loss 2.6370 (2.5432) ce_loss 1.1221 (1.1101) loss_zs_kd 0.2835 (0.3365) loss_oracle 0.3229 (0.3382) acc 56.2500 (58.9286) kd_loss 1.2117 (1.0958) lr 4.1221e-04 eta 0:07:47
epoch [37/50] batch [300/319] time 0.096 (0.111) data 0.000 (0.010) loss 2.5855 (2.5425) ce_loss 1.1289 (1.1066) loss_zs_kd 0.3183 (0.3368) loss_oracle 0.3635 (0.3387) acc 53.1250 (58.9479) kd_loss 1.1156 (1.0982) lr 4.1221e-04 eta 0:07:42
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,737
* accuracy: 62.5%
* error: 37.5%
* macro_f1: 53.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,746
* accuracy: 48.7%
* error: 51.3%
* macro_f1: 21.9%
******* Domain 2 best val acc:      64.0%, epoch: 35 *******
******* Domain 2 best val test acc: 51.8%, epoch: 35 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [38/50] batch [20/319] time 0.103 (0.245) data 0.000 (0.139) loss 2.5318 (2.5745) ce_loss 1.0186 (1.1270) loss_zs_kd 0.3764 (0.3205) loss_oracle 0.3680 (0.3420) acc 65.6250 (57.8125) kd_loss 1.1411 (1.1162) lr 3.6258e-04 eta 0:16:50
epoch [38/50] batch [40/319] time 0.097 (0.174) data 0.000 (0.070) loss 2.5362 (2.5501) ce_loss 1.1768 (1.1110) loss_zs_kd 0.2645 (0.3199) loss_oracle 0.3078 (0.3417) acc 56.2500 (59.0625) kd_loss 1.0733 (1.1082) lr 3.6258e-04 eta 0:11:53
epoch [38/50] batch [60/319] time 0.093 (0.151) data 0.000 (0.047) loss 2.6548 (2.5940) ce_loss 1.2939 (1.1413) loss_zs_kd 0.3431 (0.3213) loss_oracle 0.3837 (0.3441) acc 65.6250 (58.8021) kd_loss 0.9975 (1.1201) lr 3.6258e-04 eta 0:10:15
epoch [38/50] batch [80/319] time 0.108 (0.138) data 0.000 (0.035) loss 2.7168 (2.5860) ce_loss 1.2861 (1.1242) loss_zs_kd 0.4683 (0.3257) loss_oracle 0.4107 (0.3475) acc 43.7500 (59.3750) kd_loss 0.9912 (1.1252) lr 3.6258e-04 eta 0:09:22
epoch [38/50] batch [100/319] time 0.109 (0.130) data 0.000 (0.028) loss 2.5635 (2.5786) ce_loss 1.0566 (1.1159) loss_zs_kd 0.3465 (0.3327) loss_oracle 0.3817 (0.3461) acc 62.5000 (59.6875) kd_loss 1.1427 (1.1233) lr 3.6258e-04 eta 0:08:48
epoch [38/50] batch [120/319] time 0.093 (0.125) data 0.000 (0.023) loss 2.5234 (2.5828) ce_loss 0.9663 (1.1152) loss_zs_kd 0.3430 (0.3304) loss_oracle 0.3759 (0.3442) acc 65.6250 (59.6875) kd_loss 1.1977 (1.1303) lr 3.6258e-04 eta 0:08:24
epoch [38/50] batch [140/319] time 0.100 (0.122) data 0.000 (0.020) loss 2.6778 (2.5963) ce_loss 1.2246 (1.1205) loss_zs_kd 0.3046 (0.3304) loss_oracle 0.3558 (0.3424) acc 59.3750 (59.1071) kd_loss 1.1230 (1.1395) lr 3.6258e-04 eta 0:08:09
epoch [38/50] batch [160/319] time 0.086 (0.119) data 0.000 (0.018) loss 2.5147 (2.5961) ce_loss 1.0723 (1.1198) loss_zs_kd 0.2685 (0.3292) loss_oracle 0.2905 (0.3429) acc 59.3750 (58.9648) kd_loss 1.1629 (1.1402) lr 3.6258e-04 eta 0:07:52
epoch [38/50] batch [180/319] time 0.086 (0.116) data 0.000 (0.016) loss 2.6433 (2.6082) ce_loss 1.0840 (1.1229) loss_zs_kd 0.3453 (0.3284) loss_oracle 0.2640 (0.3438) acc 56.2500 (58.5590) kd_loss 1.2546 (1.1491) lr 3.6258e-04 eta 0:07:39
epoch [38/50] batch [200/319] time 0.172 (0.114) data 0.000 (0.014) loss 2.4688 (2.6110) ce_loss 1.1152 (1.1264) loss_zs_kd 0.3766 (0.3313) loss_oracle 0.2995 (0.3431) acc 50.0000 (58.4375) kd_loss 1.0155 (1.1475) lr 3.6258e-04 eta 0:07:29
epoch [38/50] batch [220/319] time 0.072 (0.115) data 0.000 (0.013) loss 2.6530 (2.6093) ce_loss 1.1523 (1.1223) loss_zs_kd 0.3064 (0.3311) loss_oracle 0.3440 (0.3426) acc 62.5000 (58.3949) kd_loss 1.1755 (1.1502) lr 3.6258e-04 eta 0:07:30
epoch [38/50] batch [240/319] time 0.076 (0.114) data 0.000 (0.012) loss 2.4074 (2.6065) ce_loss 0.9102 (1.1170) loss_zs_kd 0.2679 (0.3320) loss_oracle 0.3711 (0.3427) acc 65.6250 (58.5417) kd_loss 1.1777 (1.1522) lr 3.6258e-04 eta 0:07:26
epoch [38/50] batch [260/319] time 0.095 (0.113) data 0.000 (0.011) loss 2.8644 (2.6041) ce_loss 1.4521 (1.1179) loss_zs_kd 0.4100 (0.3320) loss_oracle 0.3933 (0.3431) acc 46.8750 (58.5216) kd_loss 1.0106 (1.1486) lr 3.6258e-04 eta 0:07:17
epoch [38/50] batch [280/319] time 0.095 (0.112) data 0.000 (0.010) loss 2.4122 (2.5984) ce_loss 0.9175 (1.1169) loss_zs_kd 0.3339 (0.3328) loss_oracle 0.3585 (0.3435) acc 68.7500 (58.5268) kd_loss 1.1485 (1.1433) lr 3.6258e-04 eta 0:07:13
epoch [38/50] batch [300/319] time 0.116 (0.111) data 0.000 (0.010) loss 2.6140 (2.5981) ce_loss 1.3779 (1.1187) loss_zs_kd 0.3736 (0.3337) loss_oracle 0.3570 (0.3443) acc 56.2500 (58.3646) kd_loss 0.8708 (1.1405) lr 3.6258e-04 eta 0:07:07
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,770
* accuracy: 63.3%
* error: 36.7%
* macro_f1: 54.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,950
* accuracy: 50.8%
* error: 49.2%
* macro_f1: 22.4%
******* Domain 2 best val acc:      64.0%, epoch: 35 *******
******* Domain 2 best val test acc: 51.8%, epoch: 35 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [39/50] batch [20/319] time 0.096 (0.263) data 0.000 (0.160) loss 2.4325 (2.5319) ce_loss 0.9990 (1.0762) loss_zs_kd 0.3639 (0.3363) loss_oracle 0.3899 (0.3397) acc 59.3750 (62.9688) kd_loss 1.0566 (1.1177) lr 3.1545e-04 eta 0:16:39
epoch [39/50] batch [40/319] time 0.104 (0.182) data 0.000 (0.080) loss 2.7242 (2.5342) ce_loss 1.2832 (1.0817) loss_zs_kd 0.2839 (0.3398) loss_oracle 0.4008 (0.3462) acc 53.1250 (60.7812) kd_loss 1.0986 (1.1095) lr 3.1545e-04 eta 0:11:28
epoch [39/50] batch [60/319] time 0.077 (0.154) data 0.000 (0.053) loss 2.5286 (2.5412) ce_loss 0.9604 (1.0912) loss_zs_kd 0.2828 (0.3328) loss_oracle 0.2971 (0.3440) acc 56.2500 (59.7917) kd_loss 1.2782 (1.1115) lr 3.1545e-04 eta 0:09:38
epoch [39/50] batch [80/319] time 0.188 (0.146) data 0.000 (0.040) loss 2.7124 (2.5396) ce_loss 1.2500 (1.0935) loss_zs_kd 0.4024 (0.3356) loss_oracle 0.3314 (0.3463) acc 65.6250 (59.3359) kd_loss 1.0955 (1.1052) lr 3.1545e-04 eta 0:09:09
epoch [39/50] batch [100/319] time 0.084 (0.137) data 0.000 (0.032) loss 2.8585 (2.5368) ce_loss 1.4023 (1.0999) loss_zs_kd 0.3524 (0.3326) loss_oracle 0.3123 (0.3452) acc 53.1250 (58.8125) kd_loss 1.1238 (1.0979) lr 3.1545e-04 eta 0:08:30
epoch [39/50] batch [120/319] time 0.083 (0.133) data 0.000 (0.027) loss 2.6555 (2.5194) ce_loss 1.2031 (1.0918) loss_zs_kd 0.2827 (0.3316) loss_oracle 0.3601 (0.3439) acc 65.6250 (59.2448) kd_loss 1.1310 (1.0899) lr 3.1545e-04 eta 0:08:13
epoch [39/50] batch [140/319] time 0.093 (0.128) data 0.000 (0.023) loss 2.4025 (2.5155) ce_loss 0.9019 (1.0910) loss_zs_kd 0.3986 (0.3320) loss_oracle 0.3867 (0.3420) acc 78.1250 (59.7991) kd_loss 1.1079 (1.0875) lr 3.1545e-04 eta 0:07:51
epoch [39/50] batch [160/319] time 0.106 (0.124) data 0.000 (0.020) loss 2.4139 (2.5116) ce_loss 1.0742 (1.0879) loss_zs_kd 0.3957 (0.3321) loss_oracle 0.3883 (0.3420) acc 56.2500 (59.8438) kd_loss 0.9477 (1.0867) lr 3.1545e-04 eta 0:07:35
epoch [39/50] batch [180/319] time 0.111 (0.121) data 0.000 (0.018) loss 2.3085 (2.5118) ce_loss 0.9985 (1.0907) loss_zs_kd 0.3812 (0.3311) loss_oracle 0.3315 (0.3415) acc 71.8750 (59.6007) kd_loss 0.9536 (1.0847) lr 3.1545e-04 eta 0:07:22
epoch [39/50] batch [200/319] time 0.104 (0.119) data 0.000 (0.016) loss 2.3327 (2.5100) ce_loss 0.9692 (1.0894) loss_zs_kd 0.2584 (0.3304) loss_oracle 0.2851 (0.3417) acc 65.6250 (59.4688) kd_loss 1.0917 (1.0845) lr 3.1545e-04 eta 0:07:12
epoch [39/50] batch [220/319] time 0.103 (0.117) data 0.001 (0.015) loss 2.2455 (2.5089) ce_loss 0.9873 (1.0881) loss_zs_kd 0.3900 (0.3318) loss_oracle 0.3163 (0.3417) acc 65.6250 (59.5312) kd_loss 0.9051 (1.0840) lr 3.1545e-04 eta 0:07:03
epoch [39/50] batch [240/319] time 0.101 (0.116) data 0.000 (0.014) loss 2.5963 (2.5089) ce_loss 1.3623 (1.0926) loss_zs_kd 0.3727 (0.3335) loss_oracle 0.3436 (0.3421) acc 43.7500 (59.3620) kd_loss 0.8758 (1.0786) lr 3.1545e-04 eta 0:06:56
epoch [39/50] batch [260/319] time 0.097 (0.114) data 0.000 (0.013) loss 2.2907 (2.5052) ce_loss 0.9897 (1.0920) loss_zs_kd 0.2848 (0.3335) loss_oracle 0.3602 (0.3415) acc 65.6250 (59.3750) kd_loss 0.9784 (1.0757) lr 3.1545e-04 eta 0:06:48
epoch [39/50] batch [280/319] time 0.102 (0.113) data 0.000 (0.012) loss 2.6791 (2.5093) ce_loss 1.4336 (1.0974) loss_zs_kd 0.3146 (0.3329) loss_oracle 0.3577 (0.3427) acc 53.1250 (59.1853) kd_loss 0.9093 (1.0741) lr 3.1545e-04 eta 0:06:42
epoch [39/50] batch [300/319] time 0.091 (0.112) data 0.000 (0.011) loss 2.6485 (2.5106) ce_loss 1.1260 (1.0999) loss_zs_kd 0.4232 (0.3335) loss_oracle 0.3538 (0.3426) acc 56.2500 (59.0521) kd_loss 1.1340 (1.0726) lr 3.1545e-04 eta 0:06:36
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,674
* accuracy: 61.1%
* error: 38.9%
* macro_f1: 53.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,705
* accuracy: 48.3%
* error: 51.7%
* macro_f1: 23.4%
******* Domain 2 best val acc:      64.0%, epoch: 35 *******
******* Domain 2 best val test acc: 51.8%, epoch: 35 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [40/50] batch [20/319] time 0.098 (0.266) data 0.000 (0.164) loss 2.6550 (2.4638) ce_loss 1.1543 (1.0553) loss_zs_kd 0.2549 (0.3151) loss_oracle 0.3264 (0.3485) acc 59.3750 (63.9062) kd_loss 1.2100 (1.0767) lr 2.7103e-04 eta 0:15:28
epoch [40/50] batch [40/319] time 0.105 (0.184) data 0.000 (0.082) loss 2.3844 (2.4964) ce_loss 1.0332 (1.1095) loss_zs_kd 0.2916 (0.3249) loss_oracle 0.3420 (0.3533) acc 65.6250 (60.7031) kd_loss 1.0344 (1.0477) lr 2.7103e-04 eta 0:10:38
epoch [40/50] batch [60/319] time 0.102 (0.156) data 0.000 (0.055) loss 2.4907 (2.4877) ce_loss 1.1074 (1.1080) loss_zs_kd 0.3749 (0.3360) loss_oracle 0.3822 (0.3537) acc 50.0000 (60.8854) kd_loss 1.0047 (1.0349) lr 2.7103e-04 eta 0:08:58
epoch [40/50] batch [80/319] time 0.095 (0.141) data 0.000 (0.041) loss 2.3856 (2.4624) ce_loss 1.0137 (1.0874) loss_zs_kd 0.3064 (0.3387) loss_oracle 0.3374 (0.3525) acc 56.2500 (61.3672) kd_loss 1.0501 (1.0295) lr 2.7103e-04 eta 0:08:04
epoch [40/50] batch [100/319] time 0.099 (0.133) data 0.000 (0.033) loss 2.3451 (2.4456) ce_loss 0.9521 (1.0874) loss_zs_kd 0.2697 (0.3348) loss_oracle 0.3032 (0.3515) acc 71.8750 (60.5312) kd_loss 1.1064 (1.0151) lr 2.7103e-04 eta 0:07:34
epoch [40/50] batch [120/319] time 0.107 (0.128) data 0.000 (0.028) loss 2.1391 (2.4352) ce_loss 0.9639 (1.0821) loss_zs_kd 0.3979 (0.3370) loss_oracle 0.3336 (0.3518) acc 62.5000 (60.2344) kd_loss 0.8095 (1.0088) lr 2.7103e-04 eta 0:07:12
epoch [40/50] batch [140/319] time 0.095 (0.124) data 0.000 (0.024) loss 2.5135 (2.4375) ce_loss 1.1348 (1.0913) loss_zs_kd 0.3194 (0.3333) loss_oracle 0.3930 (0.3527) acc 50.0000 (59.6875) kd_loss 1.0225 (1.0032) lr 2.7103e-04 eta 0:06:57
epoch [40/50] batch [160/319] time 0.099 (0.121) data 0.000 (0.021) loss 2.3275 (2.4283) ce_loss 1.1006 (1.0881) loss_zs_kd 0.3528 (0.3362) loss_oracle 0.4104 (0.3504) acc 59.3750 (59.6875) kd_loss 0.8454 (0.9969) lr 2.7103e-04 eta 0:06:46
epoch [40/50] batch [180/319] time 0.098 (0.119) data 0.000 (0.019) loss 2.5778 (2.4270) ce_loss 1.4102 (1.0919) loss_zs_kd 0.3322 (0.3360) loss_oracle 0.3142 (0.3489) acc 53.1250 (59.3924) kd_loss 0.8444 (0.9926) lr 2.7103e-04 eta 0:06:36
epoch [40/50] batch [200/319] time 0.101 (0.118) data 0.000 (0.017) loss 2.4088 (2.4331) ce_loss 1.1641 (1.1039) loss_zs_kd 0.3076 (0.3349) loss_oracle 0.3733 (0.3480) acc 59.3750 (58.9531) kd_loss 0.9042 (0.9878) lr 2.7103e-04 eta 0:06:28
epoch [40/50] batch [220/319] time 0.174 (0.115) data 0.000 (0.015) loss 2.5504 (2.4354) ce_loss 1.2686 (1.1109) loss_zs_kd 0.3556 (0.3344) loss_oracle 0.3162 (0.3477) acc 46.8750 (58.6364) kd_loss 0.9460 (0.9835) lr 2.7103e-04 eta 0:06:18
epoch [40/50] batch [240/319] time 0.079 (0.116) data 0.000 (0.014) loss 2.5408 (2.4273) ce_loss 1.2236 (1.1076) loss_zs_kd 0.3245 (0.3352) loss_oracle 0.3499 (0.3488) acc 56.2500 (58.7891) kd_loss 0.9800 (0.9777) lr 2.7103e-04 eta 0:06:20
epoch [40/50] batch [260/319] time 0.148 (0.116) data 0.000 (0.013) loss 2.6001 (2.4240) ce_loss 1.1885 (1.1087) loss_zs_kd 0.3415 (0.3350) loss_oracle 0.3637 (0.3492) acc 50.0000 (58.6899) kd_loss 1.0590 (0.9732) lr 2.7103e-04 eta 0:06:15
epoch [40/50] batch [280/319] time 0.106 (0.114) data 0.000 (0.012) loss 2.3683 (2.4233) ce_loss 1.1582 (1.1119) loss_zs_kd 0.2641 (0.3343) loss_oracle 0.3701 (0.3500) acc 62.5000 (58.6161) kd_loss 0.8930 (0.9693) lr 2.7103e-04 eta 0:06:07
epoch [40/50] batch [300/319] time 0.104 (0.113) data 0.000 (0.011) loss 2.4897 (2.4213) ce_loss 1.2109 (1.1150) loss_zs_kd 0.3145 (0.3336) loss_oracle 0.3434 (0.3506) acc 53.1250 (58.5417) kd_loss 0.9498 (0.9642) lr 2.7103e-04 eta 0:06:02
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,718
* accuracy: 62.1%
* error: 37.9%
* macro_f1: 54.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,702
* accuracy: 48.3%
* error: 51.7%
* macro_f1: 22.8%
******* Domain 2 best val acc:      64.0%, epoch: 35 *******
******* Domain 2 best val test acc: 51.8%, epoch: 35 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [41/50] batch [20/319] time 0.099 (0.283) data 0.000 (0.179) loss 2.2879 (2.3615) ce_loss 1.0693 (1.1135) loss_zs_kd 0.3707 (0.3476) loss_oracle 0.3295 (0.3467) acc 53.1250 (56.8750) kd_loss 0.8685 (0.9009) lr 2.2949e-04 eta 0:14:58
epoch [41/50] batch [40/319] time 0.100 (0.190) data 0.000 (0.090) loss 2.4890 (2.3674) ce_loss 1.1836 (1.1184) loss_zs_kd 0.4541 (0.3548) loss_oracle 0.3723 (0.3469) acc 62.5000 (57.9688) kd_loss 0.8922 (0.8982) lr 2.2949e-04 eta 0:09:59
epoch [41/50] batch [60/319] time 0.074 (0.155) data 0.000 (0.060) loss 2.3867 (2.3754) ce_loss 1.1865 (1.1278) loss_zs_kd 0.3073 (0.3484) loss_oracle 0.2938 (0.3472) acc 62.5000 (57.9167) kd_loss 0.8996 (0.8999) lr 2.2949e-04 eta 0:08:06
epoch [41/50] batch [80/319] time 0.162 (0.147) data 0.000 (0.045) loss 2.5315 (2.3798) ce_loss 1.1416 (1.1240) loss_zs_kd 0.3788 (0.3515) loss_oracle 0.3870 (0.3509) acc 50.0000 (57.4609) kd_loss 1.0070 (0.9046) lr 2.2949e-04 eta 0:07:37
epoch [41/50] batch [100/319] time 0.079 (0.137) data 0.000 (0.036) loss 2.2637 (2.3817) ce_loss 0.9697 (1.1246) loss_zs_kd 0.3319 (0.3508) loss_oracle 0.3541 (0.3515) acc 71.8750 (57.8750) kd_loss 0.9510 (0.9059) lr 2.2949e-04 eta 0:07:04
epoch [41/50] batch [120/319] time 0.078 (0.132) data 0.000 (0.030) loss 2.2309 (2.3841) ce_loss 0.9609 (1.1247) loss_zs_kd 0.2773 (0.3472) loss_oracle 0.3439 (0.3523) acc 71.8750 (57.8906) kd_loss 0.9593 (0.9096) lr 2.2949e-04 eta 0:06:46
epoch [41/50] batch [140/319] time 0.097 (0.127) data 0.001 (0.026) loss 2.3045 (2.3819) ce_loss 0.9497 (1.1184) loss_zs_kd 0.2837 (0.3441) loss_oracle 0.3229 (0.3511) acc 59.3750 (58.5491) kd_loss 1.0515 (0.9159) lr 2.2949e-04 eta 0:06:27
epoch [41/50] batch [160/319] time 0.108 (0.124) data 0.000 (0.023) loss 2.3550 (2.3816) ce_loss 1.2119 (1.1178) loss_zs_kd 0.3263 (0.3407) loss_oracle 0.3808 (0.3521) acc 56.2500 (58.6133) kd_loss 0.7895 (0.9174) lr 2.2949e-04 eta 0:06:15
epoch [41/50] batch [180/319] time 0.098 (0.121) data 0.000 (0.020) loss 2.4530 (2.3851) ce_loss 1.1230 (1.1167) loss_zs_kd 0.3393 (0.3398) loss_oracle 0.3269 (0.3520) acc 53.1250 (58.6111) kd_loss 0.9968 (0.9224) lr 2.2949e-04 eta 0:06:03
epoch [41/50] batch [200/319] time 0.084 (0.118) data 0.000 (0.018) loss 2.3531 (2.3814) ce_loss 0.9858 (1.1113) loss_zs_kd 0.3378 (0.3380) loss_oracle 0.3305 (0.3519) acc 56.2500 (58.8125) kd_loss 1.0331 (0.9252) lr 2.2949e-04 eta 0:05:52
epoch [41/50] batch [220/319] time 0.098 (0.116) data 0.000 (0.017) loss 2.3499 (2.3764) ce_loss 1.2627 (1.1098) loss_zs_kd 0.3398 (0.3371) loss_oracle 0.3605 (0.3516) acc 43.7500 (58.6790) kd_loss 0.7371 (0.9222) lr 2.2949e-04 eta 0:05:45
epoch [41/50] batch [240/319] time 0.093 (0.115) data 0.000 (0.015) loss 2.3435 (2.3758) ce_loss 1.1377 (1.1082) loss_zs_kd 0.3042 (0.3369) loss_oracle 0.3560 (0.3516) acc 53.1250 (58.6719) kd_loss 0.8757 (0.9234) lr 2.2949e-04 eta 0:05:37
epoch [41/50] batch [260/319] time 0.090 (0.114) data 0.000 (0.014) loss 2.5019 (2.3758) ce_loss 1.1143 (1.1094) loss_zs_kd 0.3224 (0.3364) loss_oracle 0.3395 (0.3511) acc 53.1250 (58.6899) kd_loss 1.0567 (0.9226) lr 2.2949e-04 eta 0:05:33
epoch [41/50] batch [280/319] time 0.100 (0.114) data 0.000 (0.013) loss 2.1273 (2.3741) ce_loss 0.9692 (1.1097) loss_zs_kd 0.2832 (0.3362) loss_oracle 0.3090 (0.3506) acc 68.7500 (58.6161) kd_loss 0.8619 (0.9210) lr 2.2949e-04 eta 0:05:30
epoch [41/50] batch [300/319] time 0.108 (0.113) data 0.000 (0.012) loss 2.3231 (2.3711) ce_loss 0.9878 (1.1075) loss_zs_kd 0.2940 (0.3351) loss_oracle 0.3594 (0.3514) acc 59.3750 (58.6146) kd_loss 1.0086 (0.9204) lr 2.2949e-04 eta 0:05:25
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,704
* accuracy: 61.8%
* error: 38.2%
* macro_f1: 52.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,650
* accuracy: 47.8%
* error: 52.2%
* macro_f1: 21.9%
******* Domain 2 best val acc:      64.0%, epoch: 35 *******
******* Domain 2 best val test acc: 51.8%, epoch: 35 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [42/50] batch [20/319] time 0.107 (0.233) data 0.000 (0.154) loss 2.6265 (2.3852) ce_loss 1.3369 (1.1554) loss_zs_kd 0.3708 (0.3023) loss_oracle 0.3357 (0.3348) acc 46.8750 (55.3125) kd_loss 0.9363 (0.9113) lr 1.9098e-04 eta 0:11:04
epoch [42/50] batch [40/319] time 0.079 (0.160) data 0.000 (0.077) loss 2.1532 (2.3907) ce_loss 0.8760 (1.1370) loss_zs_kd 0.2949 (0.3104) loss_oracle 0.3588 (0.3481) acc 71.8750 (56.6406) kd_loss 0.9504 (0.9244) lr 1.9098e-04 eta 0:07:33
epoch [42/50] batch [60/319] time 0.086 (0.137) data 0.000 (0.052) loss 2.5668 (2.3912) ce_loss 1.1904 (1.1362) loss_zs_kd 0.2724 (0.3115) loss_oracle 0.3681 (0.3536) acc 59.3750 (56.9271) kd_loss 1.0562 (0.9225) lr 1.9098e-04 eta 0:06:23
epoch [42/50] batch [80/319] time 0.094 (0.125) data 0.000 (0.039) loss 2.4722 (2.3859) ce_loss 1.1768 (1.1375) loss_zs_kd 0.2971 (0.3153) loss_oracle 0.3708 (0.3552) acc 43.7500 (56.6016) kd_loss 0.9615 (0.9131) lr 1.9098e-04 eta 0:05:48
epoch [42/50] batch [100/319] time 0.098 (0.120) data 0.000 (0.031) loss 2.6982 (2.3922) ce_loss 1.4268 (1.1446) loss_zs_kd 0.3795 (0.3208) loss_oracle 0.3115 (0.3552) acc 46.8750 (56.1250) kd_loss 0.9260 (0.9096) lr 1.9098e-04 eta 0:05:31
epoch [42/50] batch [120/319] time 0.095 (0.116) data 0.000 (0.026) loss 2.3429 (2.3840) ce_loss 1.2041 (1.1301) loss_zs_kd 0.3641 (0.3256) loss_oracle 0.3608 (0.3544) acc 50.0000 (57.1094) kd_loss 0.7763 (0.9139) lr 1.9098e-04 eta 0:05:20
epoch [42/50] batch [140/319] time 0.100 (0.114) data 0.000 (0.022) loss 1.9083 (2.3816) ce_loss 0.7378 (1.1284) loss_zs_kd 0.3870 (0.3273) loss_oracle 0.3073 (0.3514) acc 78.1250 (57.2768) kd_loss 0.8233 (0.9138) lr 1.9098e-04 eta 0:05:11
epoch [42/50] batch [160/319] time 0.099 (0.112) data 0.000 (0.020) loss 2.7081 (2.3783) ce_loss 1.2295 (1.1248) loss_zs_kd 0.3965 (0.3277) loss_oracle 0.3495 (0.3517) acc 56.2500 (57.7539) kd_loss 1.1056 (0.9137) lr 1.9098e-04 eta 0:05:04
epoch [42/50] batch [180/319] time 0.105 (0.111) data 0.000 (0.017) loss 2.2843 (2.3749) ce_loss 1.0430 (1.1265) loss_zs_kd 0.3122 (0.3296) loss_oracle 0.2882 (0.3504) acc 68.7500 (57.9514) kd_loss 0.9410 (0.9084) lr 1.9098e-04 eta 0:04:59
epoch [42/50] batch [200/319] time 0.112 (0.110) data 0.000 (0.016) loss 2.3841 (2.3674) ce_loss 1.0723 (1.1208) loss_zs_kd 0.2736 (0.3291) loss_oracle 0.3570 (0.3508) acc 56.2500 (57.9062) kd_loss 0.9965 (0.9066) lr 1.9098e-04 eta 0:04:53
epoch [42/50] batch [220/319] time 0.083 (0.108) data 0.000 (0.014) loss 2.4339 (2.3636) ce_loss 1.1445 (1.1155) loss_zs_kd 0.2673 (0.3310) loss_oracle 0.3666 (0.3500) acc 65.6250 (58.0824) kd_loss 0.9724 (0.9076) lr 1.9098e-04 eta 0:04:46
epoch [42/50] batch [240/319] time 0.153 (0.110) data 0.000 (0.013) loss 2.4438 (2.3627) ce_loss 1.2217 (1.1139) loss_zs_kd 0.3340 (0.3313) loss_oracle 0.3361 (0.3498) acc 46.8750 (58.1771) kd_loss 0.8870 (0.9081) lr 1.9098e-04 eta 0:04:48
epoch [42/50] batch [260/319] time 0.084 (0.108) data 0.000 (0.012) loss 2.6024 (2.3592) ce_loss 1.2725 (1.1123) loss_zs_kd 0.4042 (0.3317) loss_oracle 0.2794 (0.3501) acc 56.2500 (58.2452) kd_loss 0.9881 (0.9060) lr 1.9098e-04 eta 0:04:43
epoch [42/50] batch [280/319] time 0.084 (0.108) data 0.000 (0.011) loss 2.3035 (2.3572) ce_loss 1.0947 (1.1113) loss_zs_kd 0.3110 (0.3336) loss_oracle 0.3025 (0.3496) acc 65.6250 (58.3817) kd_loss 0.9021 (0.9043) lr 1.9098e-04 eta 0:04:41
epoch [42/50] batch [300/319] time 0.108 (0.108) data 0.000 (0.011) loss 2.3200 (2.3605) ce_loss 1.0430 (1.1125) loss_zs_kd 0.3845 (0.3350) loss_oracle 0.2963 (0.3495) acc 62.5000 (58.4479) kd_loss 0.9366 (0.9058) lr 1.9098e-04 eta 0:04:36
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,755
* accuracy: 62.9%
* error: 37.1%
* macro_f1: 53.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,785
* accuracy: 49.1%
* error: 50.9%
* macro_f1: 22.2%
******* Domain 2 best val acc:      64.0%, epoch: 35 *******
******* Domain 2 best val test acc: 51.8%, epoch: 35 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [43/50] batch [20/319] time 0.092 (0.272) data 0.000 (0.164) loss 2.2878 (2.3747) ce_loss 1.0449 (1.0896) loss_zs_kd 0.4238 (0.3423) loss_oracle 0.4313 (0.3462) acc 56.2500 (58.9062) kd_loss 0.8153 (0.9408) lr 1.5567e-04 eta 0:11:28
epoch [43/50] batch [40/319] time 0.113 (0.186) data 0.000 (0.082) loss 2.6357 (2.3942) ce_loss 1.3750 (1.1156) loss_zs_kd 0.3481 (0.3355) loss_oracle 0.3703 (0.3464) acc 46.8750 (56.7969) kd_loss 0.9015 (0.9376) lr 1.5567e-04 eta 0:07:47
epoch [43/50] batch [60/319] time 0.097 (0.158) data 0.000 (0.055) loss 2.6327 (2.3925) ce_loss 1.2715 (1.1062) loss_zs_kd 0.3615 (0.3367) loss_oracle 0.3509 (0.3481) acc 56.2500 (57.5521) kd_loss 1.0050 (0.9439) lr 1.5567e-04 eta 0:06:32
epoch [43/50] batch [80/319] time 0.090 (0.143) data 0.000 (0.041) loss 2.2280 (2.3980) ce_loss 0.9653 (1.1128) loss_zs_kd 0.3574 (0.3384) loss_oracle 0.3939 (0.3509) acc 81.2500 (58.2031) kd_loss 0.8870 (0.9406) lr 1.5567e-04 eta 0:05:52
epoch [43/50] batch [100/319] time 0.083 (0.131) data 0.000 (0.033) loss 2.2842 (2.3912) ce_loss 1.0400 (1.1069) loss_zs_kd 0.3180 (0.3385) loss_oracle 0.2949 (0.3484) acc 59.3750 (58.5000) kd_loss 0.9377 (0.9409) lr 1.5567e-04 eta 0:05:20
epoch [43/50] batch [120/319] time 0.170 (0.131) data 0.000 (0.028) loss 2.4548 (2.3988) ce_loss 1.0605 (1.1070) loss_zs_kd 0.3239 (0.3375) loss_oracle 0.3346 (0.3497) acc 50.0000 (58.3854) kd_loss 1.0650 (0.9481) lr 1.5567e-04 eta 0:05:19
epoch [43/50] batch [140/319] time 0.082 (0.124) data 0.000 (0.024) loss 2.6873 (2.4001) ce_loss 1.3613 (1.1103) loss_zs_kd 0.2945 (0.3396) loss_oracle 0.3437 (0.3484) acc 46.8750 (57.9688) kd_loss 1.0069 (0.9457) lr 1.5567e-04 eta 0:05:00
epoch [43/50] batch [160/319] time 0.080 (0.123) data 0.000 (0.021) loss 2.4027 (2.3972) ce_loss 1.0615 (1.1037) loss_zs_kd 0.3522 (0.3414) loss_oracle 0.3824 (0.3474) acc 56.2500 (58.2422) kd_loss 0.9739 (0.9491) lr 1.5567e-04 eta 0:04:53
epoch [43/50] batch [180/319] time 0.098 (0.119) data 0.000 (0.018) loss 2.3533 (2.4062) ce_loss 1.0947 (1.1080) loss_zs_kd 0.2986 (0.3403) loss_oracle 0.4361 (0.3484) acc 62.5000 (58.3507) kd_loss 0.8912 (0.9538) lr 1.5567e-04 eta 0:04:42
epoch [43/50] batch [200/319] time 0.109 (0.117) data 0.000 (0.017) loss 2.3781 (2.4076) ce_loss 1.1494 (1.1079) loss_zs_kd 0.3042 (0.3400) loss_oracle 0.3575 (0.3481) acc 50.0000 (58.4062) kd_loss 0.8978 (0.9556) lr 1.5567e-04 eta 0:04:35
epoch [43/50] batch [220/319] time 0.097 (0.115) data 0.000 (0.015) loss 2.4127 (2.4139) ce_loss 1.2090 (1.1130) loss_zs_kd 0.3537 (0.3377) loss_oracle 0.3546 (0.3468) acc 53.1250 (58.1818) kd_loss 0.8496 (0.9587) lr 1.5567e-04 eta 0:04:29
epoch [43/50] batch [240/319] time 0.102 (0.114) data 0.000 (0.014) loss 2.3538 (2.4105) ce_loss 1.1064 (1.1106) loss_zs_kd 0.3937 (0.3375) loss_oracle 0.3752 (0.3469) acc 53.1250 (58.1380) kd_loss 0.8629 (0.9577) lr 1.5567e-04 eta 0:04:23
epoch [43/50] batch [260/319] time 0.102 (0.113) data 0.000 (0.013) loss 2.4133 (2.4142) ce_loss 0.9834 (1.1091) loss_zs_kd 0.4262 (0.3373) loss_oracle 0.2675 (0.3468) acc 62.5000 (58.2572) kd_loss 1.0830 (0.9630) lr 1.5567e-04 eta 0:04:18
epoch [43/50] batch [280/319] time 0.105 (0.112) data 0.000 (0.012) loss 2.3679 (2.4105) ce_loss 1.0977 (1.1067) loss_zs_kd 0.3154 (0.3374) loss_oracle 0.3854 (0.3471) acc 56.2500 (58.4487) kd_loss 0.9198 (0.9616) lr 1.5567e-04 eta 0:04:14
epoch [43/50] batch [300/319] time 0.102 (0.111) data 0.000 (0.011) loss 2.6074 (2.4104) ce_loss 1.1709 (1.1044) loss_zs_kd 0.2751 (0.3378) loss_oracle 0.3106 (0.3467) acc 59.3750 (58.6562) kd_loss 1.1437 (0.9638) lr 1.5567e-04 eta 0:04:09
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,739
* accuracy: 62.6%
* error: 37.4%
* macro_f1: 54.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,811
* accuracy: 49.4%
* error: 50.6%
* macro_f1: 22.4%
******* Domain 2 best val acc:      64.0%, epoch: 35 *******
******* Domain 2 best val test acc: 51.8%, epoch: 35 *******
******* Domain 2 best test acc:     52.8%, epoch: 27 *******
epoch [44/50] batch [20/319] time 0.178 (0.287) data 0.000 (0.158) loss 2.4749 (2.3972) ce_loss 1.2812 (1.0792) loss_zs_kd 0.3293 (0.3442) loss_oracle 0.4183 (0.3509) acc 62.5000 (60.6250) kd_loss 0.8199 (0.9704) lr 1.2369e-04 eta 0:10:35
epoch [44/50] batch [40/319] time 0.095 (0.190) data 0.000 (0.079) loss 2.4949 (2.4253) ce_loss 1.2637 (1.1088) loss_zs_kd 0.2513 (0.3434) loss_oracle 0.3201 (0.3437) acc 56.2500 (58.5156) kd_loss 0.9455 (0.9729) lr 1.2369e-04 eta 0:06:57
epoch [44/50] batch [60/319] time 0.061 (0.162) data 0.000 (0.053) loss 2.1705 (2.4020) ce_loss 0.8804 (1.1001) loss_zs_kd 0.3265 (0.3362) loss_oracle 0.3511 (0.3442) acc 62.5000 (58.3854) kd_loss 0.9514 (0.9617) lr 1.2369e-04 eta 0:05:50
epoch [44/50] batch [80/319] time 0.099 (0.146) data 0.000 (0.040) loss 2.3887 (2.3826) ce_loss 1.1963 (1.0940) loss_zs_kd 0.3348 (0.3364) loss_oracle 0.3372 (0.3447) acc 56.2500 (59.0625) kd_loss 0.8565 (0.9480) lr 1.2369e-04 eta 0:05:13
epoch [44/50] batch [100/319] time 0.097 (0.136) data 0.000 (0.032) loss 2.4023 (2.3816) ce_loss 1.1162 (1.0994) loss_zs_kd 0.2958 (0.3369) loss_oracle 0.3313 (0.3420) acc 62.5000 (59.0625) kd_loss 0.9725 (0.9428) lr 1.2369e-04 eta 0:04:49
epoch [44/50] batch [120/319] time 0.094 (0.129) data 0.000 (0.027) loss 2.2972 (2.3873) ce_loss 1.2021 (1.1145) loss_zs_kd 0.3179 (0.3331) loss_oracle 0.3247 (0.3442) acc 59.3750 (58.4635) kd_loss 0.7737 (0.9341) lr 1.2369e-04 eta 0:04:33
epoch [44/50] batch [140/319] time 0.101 (0.125) data 0.000 (0.023) loss 2.3443 (2.3838) ce_loss 1.2021 (1.1185) loss_zs_kd 0.3222 (0.3313) loss_oracle 0.3721 (0.3427) acc 50.0000 (58.2812) kd_loss 0.7950 (0.9283) lr 1.2369e-04 eta 0:04:21
epoch [44/50] batch [160/319] time 0.095 (0.122) data 0.000 (0.020) loss 2.3171 (2.3847) ce_loss 1.1123 (1.1190) loss_zs_kd 0.2995 (0.3324) loss_oracle 0.3285 (0.3428) acc 56.2500 (58.3789) kd_loss 0.8908 (0.9281) lr 1.2369e-04 eta 0:04:12
epoch [44/50] batch [180/319] time 0.095 (0.118) data 0.000 (0.018) loss 2.5203 (2.3870) ce_loss 1.2393 (1.1226) loss_zs_kd 0.2595 (0.3316) loss_oracle 0.3314 (0.3430) acc 53.1250 (57.8299) kd_loss 0.9856 (0.9272) lr 1.2369e-04 eta 0:04:03
epoch [44/50] batch [200/319] time 0.092 (0.116) data 0.000 (0.016) loss 1.9556 (2.3829) ce_loss 0.7153 (1.1193) loss_zs_kd 0.2951 (0.3337) loss_oracle 0.3291 (0.3449) acc 68.7500 (57.7969) kd_loss 0.9281 (0.9243) lr 1.2369e-04 eta 0:03:56
epoch [44/50] batch [220/319] time 0.091 (0.114) data 0.000 (0.015) loss 2.1833 (2.3784) ce_loss 1.0459 (1.1172) loss_zs_kd 0.3571 (0.3360) loss_oracle 0.3157 (0.3456) acc 62.5000 (57.7131) kd_loss 0.8011 (0.9204) lr 1.2369e-04 eta 0:03:50
epoch [44/50] batch [240/319] time 0.095 (0.113) data 0.001 (0.013) loss 2.5586 (2.3741) ce_loss 1.2080 (1.1129) loss_zs_kd 0.4772 (0.3370) loss_oracle 0.3840 (0.3464) acc 65.6250 (58.0859) kd_loss 0.9201 (0.9196) lr 1.2369e-04 eta 0:03:45
epoch [44/50] batch [260/319] time 0.091 (0.112) data 0.000 (0.012) loss 2.3456 (2.3732) ce_loss 1.1641 (1.1106) loss_zs_kd 0.3482 (0.3372) loss_oracle 0.3077 (0.3458) acc 56.2500 (58.1370) kd_loss 0.8535 (0.9211) lr 1.2369e-04 eta 0:03:40
epoch [44/50] batch [280/319] time 0.078 (0.110) data 0.000 (0.012) loss 2.5609 (2.3685) ce_loss 1.3057 (1.1090) loss_zs_kd 0.3168 (0.3368) loss_oracle 0.2841 (0.3451) acc 40.6250 (58.1920) kd_loss 0.9548 (0.9186) lr 1.2369e-04 eta 0:03:34
epoch [44/50] batch [300/319] time 0.148 (0.109) data 0.000 (0.011) loss 2.3322 (2.3704) ce_loss 1.1670 (1.1107) loss_zs_kd 0.3064 (0.3362) loss_oracle 0.3666 (0.3459) acc 53.1250 (58.0312) kd_loss 0.8287 (0.9186) lr 1.2369e-04 eta 0:03:31
Evaluate on the *val* set
