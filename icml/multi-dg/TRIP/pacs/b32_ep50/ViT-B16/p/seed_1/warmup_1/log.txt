Loading trainer: TRIP
Loading dataset: SPG_PACS
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------------------------------------
Dataset    SPG_PACS
Source     ['art_painting', 'cartoon', 'sketch']
Target     ['photo']
# classes  7
# train_x  5,823
# val      2,497
# test     1,670
---------  -------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/181] time 0.099 (0.132) data 0.000 (0.024) loss 0.6411 (0.5748) ce_loss 0.6401 (0.5724) loss_zs_kd 0.0002 (0.0000) loss_oracle -0.0001 (-0.0001) acc 71.8750 (79.0625) kd_loss 0.0009 (0.0024) lr 1.0000e-05 eta 0:19:52
epoch [1/50] batch [40/181] time 0.091 (0.115) data 0.000 (0.012) loss 0.8252 (0.5712) ce_loss 0.8242 (0.5696) loss_zs_kd 0.0012 (0.0002) loss_oracle -0.0002 (-0.0001) acc 75.0000 (79.6875) kd_loss 0.0005 (0.0016) lr 1.0000e-05 eta 0:17:18
epoch [1/50] batch [60/181] time 0.113 (0.110) data 0.000 (0.008) loss 0.7333 (0.5615) ce_loss 0.7310 (0.5599) loss_zs_kd 0.0029 (0.0006) loss_oracle -0.0001 (-0.0001) acc 78.1250 (80.2083) kd_loss 0.0010 (0.0014) lr 1.0000e-05 eta 0:16:27
epoch [1/50] batch [80/181] time 0.118 (0.107) data 0.000 (0.006) loss 0.4354 (0.5538) ce_loss 0.4319 (0.5519) loss_zs_kd 0.0042 (0.0012) loss_oracle -0.0002 (-0.0001) acc 87.5000 (80.4297) kd_loss 0.0015 (0.0014) lr 1.0000e-05 eta 0:16:03
epoch [1/50] batch [100/181] time 0.099 (0.106) data 0.000 (0.005) loss 0.4771 (0.5430) ce_loss 0.4727 (0.5406) loss_zs_kd 0.0057 (0.0019) loss_oracle -0.0001 (-0.0001) acc 87.5000 (80.7500) kd_loss 0.0016 (0.0015) lr 1.0000e-05 eta 0:15:47
epoch [1/50] batch [120/181] time 0.095 (0.107) data 0.000 (0.004) loss 0.5688 (0.5272) ce_loss 0.5620 (0.5243) loss_zs_kd 0.0071 (0.0026) loss_oracle -0.0002 (-0.0001) acc 81.2500 (81.6667) kd_loss 0.0033 (0.0016) lr 1.0000e-05 eta 0:15:52
epoch [1/50] batch [140/181] time 0.063 (0.105) data 0.000 (0.004) loss 0.3343 (0.5231) ce_loss 0.3276 (0.5197) loss_zs_kd 0.0074 (0.0034) loss_oracle -0.0002 (-0.0001) acc 84.3750 (81.9196) kd_loss 0.0031 (0.0019) lr 1.0000e-05 eta 0:15:35
epoch [1/50] batch [160/181] time 0.093 (0.102) data 0.000 (0.003) loss 0.3586 (0.5144) ce_loss 0.3489 (0.5102) loss_zs_kd 0.0094 (0.0041) loss_oracle -0.0001 (-0.0001) acc 90.6250 (82.2070) kd_loss 0.0050 (0.0022) lr 1.0000e-05 eta 0:15:08
epoch [1/50] batch [180/181] time 0.069 (0.099) data 0.000 (0.003) loss 0.6282 (0.5144) ce_loss 0.6157 (0.5093) loss_zs_kd 0.0142 (0.0049) loss_oracle -0.0002 (-0.0001) acc 81.2500 (82.2396) kd_loss 0.0054 (0.0027) lr 1.0000e-05 eta 0:14:38
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,366
* accuracy: 94.8%
* error: 5.2%
* macro_f1: 95.4%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,669
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain p best val acc:      94.8%, epoch: 1 *******
******* Domain p best val test acc: 99.9%, epoch: 1 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/ana
epoch [2/50] batch [20/181] time 0.106 (0.143) data 0.000 (0.021) loss 0.4775 (0.5655) ce_loss 0.4460 (0.5286) loss_zs_kd 0.0505 (0.0611) loss_oracle -0.0000 (-0.0001) acc 87.5000 (82.9688) kd_loss 0.0062 (0.0064) lr 2.0000e-03 eta 0:21:06
epoch [2/50] batch [40/181] time 0.085 (0.119) data 0.000 (0.011) loss 0.3314 (0.4993) ce_loss 0.3057 (0.4665) loss_zs_kd 0.0403 (0.0533) loss_oracle 0.0000 (0.0000) acc 93.7500 (84.5312) kd_loss 0.0056 (0.0061) lr 2.0000e-03 eta 0:17:32
epoch [2/50] batch [60/181] time 0.082 (0.108) data 0.000 (0.007) loss 0.4555 (0.4950) ce_loss 0.4065 (0.4613) loss_zs_kd 0.0886 (0.0543) loss_oracle 0.0001 (0.0000) acc 90.6250 (84.1667) kd_loss 0.0047 (0.0065) lr 2.0000e-03 eta 0:15:47
epoch [2/50] batch [80/181] time 0.123 (0.106) data 0.000 (0.006) loss 0.5340 (0.4921) ce_loss 0.4968 (0.4587) loss_zs_kd 0.0570 (0.0531) loss_oracle 0.0004 (0.0001) acc 81.2500 (84.0625) kd_loss 0.0084 (0.0069) lr 2.0000e-03 eta 0:15:33
epoch [2/50] batch [100/181] time 0.078 (0.106) data 0.000 (0.005) loss 0.2978 (0.4871) ce_loss 0.2708 (0.4533) loss_zs_kd 0.0299 (0.0517) loss_oracle 0.0003 (0.0002) acc 93.7500 (84.1875) kd_loss 0.0120 (0.0078) lr 2.0000e-03 eta 0:15:33
epoch [2/50] batch [120/181] time 0.081 (0.106) data 0.000 (0.004) loss 0.3453 (0.4841) ce_loss 0.3057 (0.4492) loss_zs_kd 0.0468 (0.0523) loss_oracle 0.0007 (0.0002) acc 93.7500 (84.2448) kd_loss 0.0159 (0.0087) lr 2.0000e-03 eta 0:15:23
epoch [2/50] batch [140/181] time 0.082 (0.106) data 0.000 (0.003) loss 0.7379 (0.4811) ce_loss 0.6802 (0.4432) loss_zs_kd 0.0726 (0.0552) loss_oracle 0.0004 (0.0003) acc 68.7500 (84.5089) kd_loss 0.0213 (0.0102) lr 2.0000e-03 eta 0:15:26
epoch [2/50] batch [160/181] time 0.086 (0.104) data 0.000 (0.003) loss 0.4004 (0.4876) ce_loss 0.3096 (0.4463) loss_zs_kd 0.0820 (0.0573) loss_oracle 0.0018 (0.0004) acc 93.7500 (84.3945) kd_loss 0.0490 (0.0125) lr 2.0000e-03 eta 0:15:05
epoch [2/50] batch [180/181] time 0.069 (0.101) data 0.000 (0.003) loss 0.4124 (0.4906) ce_loss 0.3274 (0.4461) loss_zs_kd 0.0560 (0.0568) loss_oracle 0.0004 (0.0004) acc 90.6250 (84.2014) kd_loss 0.0567 (0.0160) lr 2.0000e-03 eta 0:14:35
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,390
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.3%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,669
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.7%, epoch: 2 *******
******* Domain p best val test acc: 99.9%, epoch: 2 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [3/50] batch [20/181] time 0.092 (0.124) data 0.001 (0.024) loss 0.4393 (0.4576) ce_loss 0.3733 (0.3801) loss_zs_kd 0.0424 (0.0612) loss_oracle 0.0008 (0.0005) acc 87.5000 (85.7812) kd_loss 0.0444 (0.0467) lr 1.9980e-03 eta 0:17:51
epoch [3/50] batch [40/181] time 0.104 (0.110) data 0.000 (0.012) loss 0.5145 (0.4695) ce_loss 0.4448 (0.3931) loss_zs_kd 0.0514 (0.0523) loss_oracle 0.0027 (0.0009) acc 84.3750 (86.0938) kd_loss 0.0427 (0.0498) lr 1.9980e-03 eta 0:15:50
epoch [3/50] batch [60/181] time 0.088 (0.106) data 0.001 (0.008) loss 0.6366 (0.4926) ce_loss 0.5249 (0.4088) loss_zs_kd 0.0922 (0.0572) loss_oracle 0.0012 (0.0014) acc 87.5000 (85.3125) kd_loss 0.0650 (0.0545) lr 1.9980e-03 eta 0:15:12
epoch [3/50] batch [80/181] time 0.095 (0.104) data 0.000 (0.006) loss 0.5827 (0.4982) ce_loss 0.4973 (0.4116) loss_zs_kd 0.0390 (0.0586) loss_oracle 0.0039 (0.0016) acc 75.0000 (85.1562) kd_loss 0.0640 (0.0565) lr 1.9980e-03 eta 0:14:51
epoch [3/50] batch [100/181] time 0.097 (0.103) data 0.000 (0.005) loss 0.2807 (0.5046) ce_loss 0.1470 (0.4090) loss_zs_kd 0.0437 (0.0593) loss_oracle 0.0012 (0.0016) acc 96.8750 (85.0312) kd_loss 0.1113 (0.0652) lr 1.9980e-03 eta 0:14:42
epoch [3/50] batch [120/181] time 0.111 (0.102) data 0.000 (0.004) loss 0.5296 (0.5114) ce_loss 0.4194 (0.4114) loss_zs_kd 0.0574 (0.0603) loss_oracle 0.0010 (0.0015) acc 84.3750 (85.2083) kd_loss 0.0810 (0.0692) lr 1.9980e-03 eta 0:14:37
epoch [3/50] batch [140/181] time 0.094 (0.102) data 0.000 (0.004) loss 0.4993 (0.5173) ce_loss 0.3816 (0.4153) loss_zs_kd 0.0565 (0.0608) loss_oracle 0.0017 (0.0014) acc 84.3750 (84.9777) kd_loss 0.0886 (0.0709) lr 1.9980e-03 eta 0:14:35
epoch [3/50] batch [160/181] time 0.098 (0.102) data 0.000 (0.003) loss 0.5633 (0.5182) ce_loss 0.4336 (0.4148) loss_zs_kd 0.0581 (0.0617) loss_oracle 0.0033 (0.0015) acc 78.1250 (84.9609) kd_loss 0.0990 (0.0719) lr 1.9980e-03 eta 0:14:29
epoch [3/50] batch [180/181] time 0.093 (0.101) data 0.000 (0.003) loss 0.4882 (0.5248) ce_loss 0.3342 (0.4176) loss_zs_kd 0.0831 (0.0615) loss_oracle 0.0033 (0.0017) acc 84.3750 (84.7222) kd_loss 0.1108 (0.0755) lr 1.9980e-03 eta 0:14:17
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,394
* accuracy: 95.9%
* error: 4.1%
* macro_f1: 96.4%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.9%, epoch: 3 *******
******* Domain p best val test acc: 99.9%, epoch: 3 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [4/50] batch [20/181] time 0.091 (0.123) data 0.000 (0.026) loss 0.2819 (0.5489) ce_loss 0.1619 (0.3987) loss_zs_kd 0.0327 (0.0626) loss_oracle 0.0016 (0.0024) acc 96.8750 (84.6875) kd_loss 0.1028 (0.1177) lr 1.9921e-03 eta 0:17:24
epoch [4/50] batch [40/181] time 0.094 (0.109) data 0.000 (0.013) loss 0.8222 (0.5871) ce_loss 0.6030 (0.4260) loss_zs_kd 0.0611 (0.0605) loss_oracle 0.0031 (0.0027) acc 78.1250 (84.0625) kd_loss 0.1871 (0.1295) lr 1.9921e-03 eta 0:15:22
epoch [4/50] batch [60/181] time 0.094 (0.106) data 0.000 (0.009) loss 0.6880 (0.5858) ce_loss 0.4932 (0.4219) loss_zs_kd 0.0652 (0.0609) loss_oracle 0.0030 (0.0025) acc 81.2500 (84.3750) kd_loss 0.1607 (0.1322) lr 1.9921e-03 eta 0:14:57
epoch [4/50] batch [80/181] time 0.096 (0.104) data 0.000 (0.007) loss 0.4437 (0.5769) ce_loss 0.3511 (0.4188) loss_zs_kd 0.0264 (0.0595) loss_oracle 0.0028 (0.0027) acc 90.6250 (84.6875) kd_loss 0.0780 (0.1270) lr 1.9921e-03 eta 0:14:38
epoch [4/50] batch [100/181] time 0.097 (0.103) data 0.000 (0.005) loss 0.6746 (0.5793) ce_loss 0.5078 (0.4263) loss_zs_kd 0.1161 (0.0615) loss_oracle 0.0061 (0.0031) acc 78.1250 (84.4062) kd_loss 0.1057 (0.1207) lr 1.9921e-03 eta 0:14:22
epoch [4/50] batch [120/181] time 0.096 (0.102) data 0.000 (0.005) loss 0.5113 (0.5883) ce_loss 0.3623 (0.4379) loss_zs_kd 0.0669 (0.0648) loss_oracle 0.0028 (0.0030) acc 81.2500 (83.6979) kd_loss 0.1142 (0.1165) lr 1.9921e-03 eta 0:14:14
epoch [4/50] batch [140/181] time 0.090 (0.101) data 0.000 (0.004) loss 0.5653 (0.5763) ce_loss 0.4072 (0.4290) loss_zs_kd 0.0577 (0.0630) loss_oracle 0.0015 (0.0028) acc 84.3750 (83.8839) kd_loss 0.1285 (0.1144) lr 1.9921e-03 eta 0:14:02
epoch [4/50] batch [160/181] time 0.084 (0.098) data 0.000 (0.004) loss 0.4650 (0.5714) ce_loss 0.3547 (0.4254) loss_zs_kd 0.0551 (0.0642) loss_oracle 0.0036 (0.0028) acc 87.5000 (84.1211) kd_loss 0.0809 (0.1125) lr 1.9921e-03 eta 0:13:41
epoch [4/50] batch [180/181] time 0.069 (0.096) data 0.000 (0.003) loss 0.7651 (0.5689) ce_loss 0.6040 (0.4240) loss_zs_kd 0.0797 (0.0649) loss_oracle 0.0033 (0.0028) acc 87.5000 (84.2014) kd_loss 0.1195 (0.1111) lr 1.9921e-03 eta 0:13:17
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,395
* accuracy: 95.9%
* error: 4.1%
* macro_f1: 96.4%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      95.9%, epoch: 4 *******
******* Domain p best val test acc: 99.8%, epoch: 4 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [5/50] batch [20/181] time 0.069 (0.141) data 0.000 (0.032) loss 0.4599 (0.5872) ce_loss 0.2949 (0.4443) loss_zs_kd 0.0554 (0.0643) loss_oracle 0.0021 (0.0026) acc 90.6250 (83.4375) kd_loss 0.1362 (0.1094) lr 1.9823e-03 eta 0:19:32
epoch [5/50] batch [40/181] time 0.074 (0.119) data 0.000 (0.016) loss 0.5910 (0.5607) ce_loss 0.4241 (0.4064) loss_zs_kd 0.0846 (0.0685) loss_oracle 0.0016 (0.0022) acc 81.2500 (85.3906) kd_loss 0.1238 (0.1190) lr 1.9823e-03 eta 0:16:25
epoch [5/50] batch [60/181] time 0.071 (0.105) data 0.000 (0.011) loss 0.4401 (0.5750) ce_loss 0.2886 (0.4182) loss_zs_kd 0.0745 (0.0727) loss_oracle 0.0021 (0.0020) acc 87.5000 (84.9479) kd_loss 0.1132 (0.1194) lr 1.9823e-03 eta 0:14:30
epoch [5/50] batch [80/181] time 0.066 (0.098) data 0.000 (0.008) loss 0.6186 (0.5778) ce_loss 0.4331 (0.4168) loss_zs_kd 0.0578 (0.0708) loss_oracle 0.0032 (0.0021) acc 81.2500 (84.9609) kd_loss 0.1550 (0.1246) lr 1.9823e-03 eta 0:13:28
epoch [5/50] batch [100/181] time 0.085 (0.092) data 0.000 (0.007) loss 0.5575 (0.5897) ce_loss 0.3494 (0.4197) loss_zs_kd 0.0609 (0.0704) loss_oracle 0.0018 (0.0021) acc 84.3750 (84.7500) kd_loss 0.1768 (0.1337) lr 1.9823e-03 eta 0:12:36
epoch [5/50] batch [120/181] time 0.077 (0.093) data 0.000 (0.006) loss 0.6148 (0.6044) ce_loss 0.3835 (0.4228) loss_zs_kd 0.0473 (0.0696) loss_oracle 0.0015 (0.0020) acc 84.3750 (84.4271) kd_loss 0.2069 (0.1458) lr 1.9823e-03 eta 0:12:45
epoch [5/50] batch [140/181] time 0.083 (0.094) data 0.000 (0.005) loss 0.5451 (0.6166) ce_loss 0.3181 (0.4241) loss_zs_kd 0.0663 (0.0699) loss_oracle 0.0024 (0.0020) acc 90.6250 (84.5982) kd_loss 0.1926 (0.1565) lr 1.9823e-03 eta 0:12:47
epoch [5/50] batch [160/181] time 0.083 (0.096) data 0.000 (0.004) loss 0.5183 (0.6271) ce_loss 0.2776 (0.4249) loss_zs_kd 0.0506 (0.0687) loss_oracle 0.0043 (0.0022) acc 87.5000 (84.5703) kd_loss 0.2133 (0.1668) lr 1.9823e-03 eta 0:13:06
epoch [5/50] batch [180/181] time 0.070 (0.097) data 0.000 (0.004) loss 0.5729 (0.6303) ce_loss 0.3503 (0.4235) loss_zs_kd 0.0634 (0.0666) loss_oracle 0.0063 (0.0026) acc 84.3750 (84.7917) kd_loss 0.1877 (0.1722) lr 1.9823e-03 eta 0:13:12
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,397
* accuracy: 96.0%
* error: 4.0%
* macro_f1: 96.5%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.0%, epoch: 5 *******
******* Domain p best val test acc: 99.9%, epoch: 5 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [6/50] batch [20/181] time 0.101 (0.123) data 0.000 (0.025) loss 0.5438 (0.6163) ce_loss 0.3274 (0.3929) loss_zs_kd 0.0701 (0.0645) loss_oracle 0.0104 (0.0067) acc 93.7500 (86.0938) kd_loss 0.1762 (0.1877) lr 1.9686e-03 eta 0:16:41
epoch [6/50] batch [40/181] time 0.094 (0.110) data 0.000 (0.013) loss 0.4525 (0.5769) ce_loss 0.2190 (0.3675) loss_zs_kd 0.0548 (0.0700) loss_oracle 0.0037 (0.0080) acc 90.6250 (86.5625) kd_loss 0.2042 (0.1704) lr 1.9686e-03 eta 0:14:51
epoch [6/50] batch [60/181] time 0.100 (0.104) data 0.000 (0.009) loss 0.6104 (0.5686) ce_loss 0.4312 (0.3701) loss_zs_kd 0.0509 (0.0669) loss_oracle 0.0030 (0.0066) acc 81.2500 (86.7188) kd_loss 0.1523 (0.1618) lr 1.9686e-03 eta 0:14:02
epoch [6/50] batch [80/181] time 0.127 (0.104) data 0.000 (0.006) loss 0.6408 (0.5668) ce_loss 0.4326 (0.3699) loss_zs_kd 0.0856 (0.0670) loss_oracle 0.0053 (0.0060) acc 84.3750 (86.8359) kd_loss 0.1627 (0.1605) lr 1.9686e-03 eta 0:14:01
epoch [6/50] batch [100/181] time 0.093 (0.104) data 0.000 (0.005) loss 0.8038 (0.5784) ce_loss 0.5771 (0.3766) loss_zs_kd 0.0723 (0.0688) loss_oracle 0.0048 (0.0058) acc 75.0000 (86.5938) kd_loss 0.1881 (0.1646) lr 1.9686e-03 eta 0:13:58
epoch [6/50] batch [120/181] time 0.094 (0.103) data 0.000 (0.004) loss 0.8909 (0.5912) ce_loss 0.6309 (0.3806) loss_zs_kd 0.0687 (0.0678) loss_oracle 0.0052 (0.0056) acc 78.1250 (86.4583) kd_loss 0.2230 (0.1739) lr 1.9686e-03 eta 0:13:46
epoch [6/50] batch [140/181] time 0.100 (0.102) data 0.000 (0.004) loss 0.7286 (0.6117) ce_loss 0.4268 (0.3931) loss_zs_kd 0.1272 (0.0679) loss_oracle 0.0050 (0.0056) acc 84.3750 (85.9152) kd_loss 0.2357 (0.1819) lr 1.9686e-03 eta 0:13:37
epoch [6/50] batch [160/181] time 0.097 (0.102) data 0.000 (0.003) loss 0.5807 (0.6185) ce_loss 0.3608 (0.3972) loss_zs_kd 0.0465 (0.0678) loss_oracle 0.0089 (0.0060) acc 81.2500 (85.8594) kd_loss 0.1921 (0.1844) lr 1.9686e-03 eta 0:13:33
epoch [6/50] batch [180/181] time 0.092 (0.101) data 0.000 (0.003) loss 0.5165 (0.6222) ce_loss 0.3362 (0.3999) loss_zs_kd 0.0512 (0.0681) loss_oracle 0.0079 (0.0063) acc 87.5000 (85.7465) kd_loss 0.1508 (0.1851) lr 1.9686e-03 eta 0:13:25
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,397
* accuracy: 96.0%
* error: 4.0%
* macro_f1: 96.5%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.0%, epoch: 5 *******
******* Domain p best val test acc: 99.9%, epoch: 5 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [7/50] batch [20/181] time 0.100 (0.127) data 0.000 (0.031) loss 0.6336 (0.6600) ce_loss 0.3494 (0.4065) loss_zs_kd 0.0727 (0.0789) loss_oracle 0.0067 (0.0083) acc 90.6250 (84.6875) kd_loss 0.2446 (0.2099) lr 1.9511e-03 eta 0:16:52
epoch [7/50] batch [40/181] time 0.094 (0.110) data 0.000 (0.015) loss 0.6213 (0.6584) ce_loss 0.3196 (0.4033) loss_zs_kd 0.0687 (0.0764) loss_oracle 0.0033 (0.0064) acc 87.5000 (84.2969) kd_loss 0.2657 (0.2137) lr 1.9511e-03 eta 0:14:31
epoch [7/50] batch [60/181] time 0.096 (0.106) data 0.000 (0.010) loss 0.7746 (0.6510) ce_loss 0.5176 (0.3966) loss_zs_kd 0.0825 (0.0758) loss_oracle 0.0046 (0.0056) acc 71.8750 (84.7917) kd_loss 0.2135 (0.2137) lr 1.9511e-03 eta 0:14:01
epoch [7/50] batch [80/181] time 0.105 (0.105) data 0.000 (0.008) loss 0.5894 (0.6472) ce_loss 0.3291 (0.3904) loss_zs_kd 0.0737 (0.0743) loss_oracle 0.0049 (0.0058) acc 87.5000 (85.3906) kd_loss 0.2209 (0.2168) lr 1.9511e-03 eta 0:13:45
epoch [7/50] batch [100/181] time 0.097 (0.104) data 0.000 (0.006) loss 0.7905 (0.6444) ce_loss 0.5586 (0.3851) loss_zs_kd 0.0620 (0.0737) loss_oracle 0.0064 (0.0061) acc 81.2500 (85.7812) kd_loss 0.1977 (0.2194) lr 1.9511e-03 eta 0:13:34
epoch [7/50] batch [120/181] time 0.089 (0.103) data 0.000 (0.005) loss 0.5798 (0.6464) ce_loss 0.3481 (0.3873) loss_zs_kd 0.0697 (0.0738) loss_oracle 0.0067 (0.0060) acc 90.6250 (85.6510) kd_loss 0.1934 (0.2192) lr 1.9511e-03 eta 0:13:25
epoch [7/50] batch [140/181] time 0.102 (0.102) data 0.001 (0.005) loss 0.8096 (0.6525) ce_loss 0.5093 (0.3902) loss_zs_kd 0.0674 (0.0738) loss_oracle 0.0280 (0.0071) acc 71.8750 (85.2455) kd_loss 0.2526 (0.2219) lr 1.9511e-03 eta 0:13:18
epoch [7/50] batch [160/181] time 0.104 (0.102) data 0.000 (0.004) loss 0.5574 (0.6579) ce_loss 0.2917 (0.3896) loss_zs_kd 0.0723 (0.0740) loss_oracle 0.0284 (0.0097) acc 90.6250 (85.3125) kd_loss 0.2153 (0.2265) lr 1.9511e-03 eta 0:13:12
epoch [7/50] batch [180/181] time 0.101 (0.101) data 0.000 (0.004) loss 0.5917 (0.6646) ce_loss 0.3000 (0.3885) loss_zs_kd 0.0388 (0.0734) loss_oracle 0.0188 (0.0111) acc 87.5000 (85.2431) kd_loss 0.2629 (0.2338) lr 1.9511e-03 eta 0:13:05
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,396
* accuracy: 96.0%
* error: 4.0%
* macro_f1: 96.5%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.0%, epoch: 5 *******
******* Domain p best val test acc: 99.9%, epoch: 5 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [8/50] batch [20/181] time 0.074 (0.123) data 0.000 (0.028) loss 0.8596 (0.7695) ce_loss 0.5366 (0.4167) loss_zs_kd 0.0544 (0.0786) loss_oracle 0.0172 (0.0222) acc 87.5000 (85.9375) kd_loss 0.2871 (0.3024) lr 1.9298e-03 eta 0:15:53
epoch [8/50] batch [40/181] time 0.074 (0.116) data 0.000 (0.014) loss 0.6163 (0.7401) ce_loss 0.2374 (0.3987) loss_zs_kd 0.0744 (0.0755) loss_oracle 0.0210 (0.0219) acc 93.7500 (85.6250) kd_loss 0.3311 (0.2927) lr 1.9298e-03 eta 0:14:57
epoch [8/50] batch [60/181] time 0.078 (0.109) data 0.001 (0.010) loss 0.6765 (0.7564) ce_loss 0.3916 (0.4183) loss_zs_kd 0.0605 (0.0748) loss_oracle 0.0141 (0.0189) acc 87.5000 (84.2708) kd_loss 0.2475 (0.2912) lr 1.9298e-03 eta 0:14:04
epoch [8/50] batch [80/181] time 0.163 (0.107) data 0.000 (0.007) loss 0.7446 (0.7365) ce_loss 0.3965 (0.4070) loss_zs_kd 0.0463 (0.0730) loss_oracle 0.0133 (0.0171) acc 81.2500 (84.5312) kd_loss 0.3183 (0.2844) lr 1.9298e-03 eta 0:13:48
epoch [8/50] batch [100/181] time 0.085 (0.107) data 0.000 (0.006) loss 0.7803 (0.7185) ce_loss 0.5796 (0.4022) loss_zs_kd 0.0429 (0.0737) loss_oracle 0.0087 (0.0159) acc 78.1250 (84.8750) kd_loss 0.1749 (0.2716) lr 1.9298e-03 eta 0:13:45
epoch [8/50] batch [120/181] time 0.094 (0.103) data 0.000 (0.005) loss 0.7833 (0.6999) ce_loss 0.4829 (0.3952) loss_zs_kd 0.0724 (0.0708) loss_oracle 0.0107 (0.0145) acc 84.3750 (85.3385) kd_loss 0.2588 (0.2620) lr 1.9298e-03 eta 0:13:10
epoch [8/50] batch [140/181] time 0.084 (0.100) data 0.000 (0.004) loss 0.6525 (0.6936) ce_loss 0.3452 (0.3930) loss_zs_kd 0.0662 (0.0711) loss_oracle 0.0104 (0.0137) acc 84.3750 (85.4241) kd_loss 0.2689 (0.2583) lr 1.9298e-03 eta 0:12:44
epoch [8/50] batch [160/181] time 0.091 (0.098) data 0.000 (0.004) loss 0.9668 (0.6951) ce_loss 0.6313 (0.3945) loss_zs_kd 0.1232 (0.0719) loss_oracle 0.0121 (0.0134) acc 84.3750 (85.3906) kd_loss 0.2678 (0.2579) lr 1.9298e-03 eta 0:12:28
epoch [8/50] batch [180/181] time 0.068 (0.100) data 0.000 (0.003) loss 0.6290 (0.6997) ce_loss 0.3877 (0.4013) loss_zs_kd 0.0500 (0.0721) loss_oracle 0.0055 (0.0127) acc 90.6250 (85.1042) kd_loss 0.2136 (0.2560) lr 1.9298e-03 eta 0:12:37
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,397
* accuracy: 96.0%
* error: 4.0%
* macro_f1: 96.5%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,665
* accuracy: 99.7%
* error: 0.3%
* macro_f1: 99.7%
******* Domain p best val acc:      96.0%, epoch: 5 *******
******* Domain p best val test acc: 99.9%, epoch: 5 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [9/50] batch [20/181] time 0.087 (0.127) data 0.000 (0.038) loss 0.6628 (0.6971) ce_loss 0.4106 (0.4118) loss_zs_kd 0.1553 (0.0910) loss_oracle 0.0069 (0.0080) acc 87.5000 (84.0625) kd_loss 0.1710 (0.2358) lr 1.9048e-03 eta 0:16:05
epoch [9/50] batch [40/181] time 0.110 (0.114) data 0.000 (0.019) loss 0.6880 (0.7020) ce_loss 0.3894 (0.4130) loss_zs_kd 0.0707 (0.0893) loss_oracle 0.0209 (0.0126) acc 81.2500 (84.0625) kd_loss 0.2528 (0.2381) lr 1.9048e-03 eta 0:14:23
epoch [9/50] batch [60/181] time 0.104 (0.110) data 0.000 (0.013) loss 0.6077 (0.7057) ce_loss 0.3379 (0.4184) loss_zs_kd 0.0671 (0.0809) loss_oracle 0.0169 (0.0140) acc 87.5000 (83.9062) kd_loss 0.2278 (0.2399) lr 1.9048e-03 eta 0:13:48
epoch [9/50] batch [80/181] time 0.098 (0.108) data 0.000 (0.010) loss 0.5941 (0.7015) ce_loss 0.3384 (0.4158) loss_zs_kd 0.0523 (0.0777) loss_oracle 0.0164 (0.0147) acc 90.6250 (84.2188) kd_loss 0.2214 (0.2394) lr 1.9048e-03 eta 0:13:32
epoch [9/50] batch [100/181] time 0.103 (0.107) data 0.000 (0.008) loss 0.5188 (0.6903) ce_loss 0.2629 (0.4118) loss_zs_kd 0.0405 (0.0759) loss_oracle 0.0163 (0.0156) acc 87.5000 (84.2812) kd_loss 0.2274 (0.2328) lr 1.9048e-03 eta 0:13:20
epoch [9/50] batch [120/181] time 0.105 (0.106) data 0.000 (0.007) loss 0.7057 (0.6870) ce_loss 0.4023 (0.4122) loss_zs_kd 0.0767 (0.0770) loss_oracle 0.0248 (0.0161) acc 87.5000 (84.3750) kd_loss 0.2525 (0.2283) lr 1.9048e-03 eta 0:13:10
epoch [9/50] batch [140/181] time 0.101 (0.104) data 0.000 (0.006) loss 0.5928 (0.6946) ce_loss 0.3096 (0.4176) loss_zs_kd 0.0593 (0.0754) loss_oracle 0.0105 (0.0158) acc 90.6250 (84.2634) kd_loss 0.2484 (0.2315) lr 1.9048e-03 eta 0:12:57
epoch [9/50] batch [160/181] time 0.102 (0.104) data 0.000 (0.005) loss 0.7453 (0.6996) ce_loss 0.4326 (0.4163) loss_zs_kd 0.0734 (0.0756) loss_oracle 0.0148 (0.0155) acc 84.3750 (84.4336) kd_loss 0.2686 (0.2377) lr 1.9048e-03 eta 0:12:51
epoch [9/50] batch [180/181] time 0.093 (0.103) data 0.000 (0.004) loss 0.9104 (0.6962) ce_loss 0.4800 (0.4071) loss_zs_kd 0.1403 (0.0759) loss_oracle 0.0203 (0.0160) acc 78.1250 (84.8264) kd_loss 0.3502 (0.2432) lr 1.9048e-03 eta 0:12:41
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,398
* accuracy: 96.0%
* error: 4.0%
* macro_f1: 96.6%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.0%, epoch: 9 *******
******* Domain p best val test acc: 99.9%, epoch: 9 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [10/50] batch [20/181] time 0.098 (0.129) data 0.000 (0.037) loss 0.6823 (0.7711) ce_loss 0.3325 (0.4375) loss_zs_kd 0.0703 (0.0758) loss_oracle 0.0178 (0.0187) acc 87.5000 (83.1250) kd_loss 0.3057 (0.2863) lr 1.8763e-03 eta 0:15:53
epoch [10/50] batch [40/181] time 0.099 (0.115) data 0.000 (0.019) loss 0.5811 (0.7403) ce_loss 0.2981 (0.4073) loss_zs_kd 0.0622 (0.0719) loss_oracle 0.0097 (0.0159) acc 90.6250 (85.2344) kd_loss 0.2470 (0.2891) lr 1.8763e-03 eta 0:14:07
epoch [10/50] batch [60/181] time 0.100 (0.111) data 0.000 (0.013) loss 0.6679 (0.7155) ce_loss 0.3418 (0.3961) loss_zs_kd 0.0775 (0.0693) loss_oracle 0.0123 (0.0144) acc 90.6250 (85.3646) kd_loss 0.2812 (0.2776) lr 1.8763e-03 eta 0:13:33
epoch [10/50] batch [80/181] time 0.108 (0.108) data 0.000 (0.009) loss 0.5225 (0.7211) ce_loss 0.2271 (0.4040) loss_zs_kd 0.0871 (0.0701) loss_oracle 0.0085 (0.0143) acc 93.7500 (85.3516) kd_loss 0.2477 (0.2748) lr 1.8763e-03 eta 0:13:10
epoch [10/50] batch [100/181] time 0.098 (0.106) data 0.000 (0.008) loss 0.9299 (0.7291) ce_loss 0.5254 (0.4073) loss_zs_kd 0.1099 (0.0716) loss_oracle 0.0183 (0.0143) acc 81.2500 (85.4688) kd_loss 0.3404 (0.2788) lr 1.8763e-03 eta 0:12:58
epoch [10/50] batch [120/181] time 0.112 (0.107) data 0.000 (0.006) loss 0.6668 (0.7330) ce_loss 0.3857 (0.4109) loss_zs_kd 0.0837 (0.0718) loss_oracle 0.0232 (0.0147) acc 84.3750 (85.1823) kd_loss 0.2277 (0.2789) lr 1.8763e-03 eta 0:12:58
epoch [10/50] batch [140/181] time 0.106 (0.106) data 0.000 (0.006) loss 0.7590 (0.7308) ce_loss 0.4351 (0.4130) loss_zs_kd 0.0946 (0.0723) loss_oracle 0.0178 (0.0154) acc 84.3750 (85.2009) kd_loss 0.2678 (0.2740) lr 1.8763e-03 eta 0:12:51
epoch [10/50] batch [160/181] time 0.094 (0.106) data 0.000 (0.005) loss 0.8155 (0.7252) ce_loss 0.4827 (0.4057) loss_zs_kd 0.0656 (0.0730) loss_oracle 0.0203 (0.0166) acc 78.1250 (85.3906) kd_loss 0.2899 (0.2746) lr 1.8763e-03 eta 0:12:47
epoch [10/50] batch [180/181] time 0.101 (0.105) data 0.000 (0.004) loss 0.8036 (0.7273) ce_loss 0.3257 (0.4020) loss_zs_kd 0.0768 (0.0732) loss_oracle 0.0189 (0.0176) acc 87.5000 (85.4688) kd_loss 0.4300 (0.2799) lr 1.8763e-03 eta 0:12:40
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,398
* accuracy: 96.0%
* error: 4.0%
* macro_f1: 96.5%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,666
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.0%, epoch: 9 *******
******* Domain p best val test acc: 99.9%, epoch: 9 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [11/50] batch [20/181] time 0.086 (0.123) data 0.000 (0.039) loss 0.9366 (0.7475) ce_loss 0.5898 (0.3825) loss_zs_kd 0.1108 (0.0840) loss_oracle 0.0148 (0.0177) acc 81.2500 (86.0938) kd_loss 0.2840 (0.3142) lr 1.8443e-03 eta 0:14:50
epoch [11/50] batch [40/181] time 0.060 (0.108) data 0.000 (0.020) loss 0.6600 (0.7386) ce_loss 0.2976 (0.3852) loss_zs_kd 0.0767 (0.0748) loss_oracle 0.0119 (0.0147) acc 84.3750 (86.3281) kd_loss 0.3181 (0.3086) lr 1.8443e-03 eta 0:12:54
epoch [11/50] batch [60/181] time 0.133 (0.105) data 0.000 (0.013) loss 0.8069 (0.7450) ce_loss 0.5342 (0.4027) loss_zs_kd 0.0308 (0.0767) loss_oracle 0.0279 (0.0153) acc 78.1250 (85.6771) kd_loss 0.2434 (0.2963) lr 1.8443e-03 eta 0:12:32
epoch [11/50] batch [80/181] time 0.063 (0.100) data 0.000 (0.010) loss 0.8013 (0.7337) ce_loss 0.4993 (0.3945) loss_zs_kd 0.0573 (0.0739) loss_oracle 0.0467 (0.0213) acc 87.5000 (86.0547) kd_loss 0.2501 (0.2916) lr 1.8443e-03 eta 0:11:54
epoch [11/50] batch [100/181] time 0.114 (0.100) data 0.000 (0.008) loss 0.5827 (0.7258) ce_loss 0.2598 (0.3829) loss_zs_kd 0.0477 (0.0734) loss_oracle 0.0417 (0.0272) acc 93.7500 (86.5312) kd_loss 0.2783 (0.2927) lr 1.8443e-03 eta 0:11:51
epoch [11/50] batch [120/181] time 0.058 (0.097) data 0.000 (0.007) loss 0.8138 (0.7264) ce_loss 0.4182 (0.3776) loss_zs_kd 0.0975 (0.0734) loss_oracle 0.0531 (0.0338) acc 87.5000 (86.5625) kd_loss 0.3203 (0.2952) lr 1.8443e-03 eta 0:11:30
epoch [11/50] batch [140/181] time 0.086 (0.093) data 0.000 (0.006) loss 0.8822 (0.7372) ce_loss 0.5327 (0.3806) loss_zs_kd 0.0792 (0.0741) loss_oracle 0.0453 (0.0364) acc 81.2500 (86.4732) kd_loss 0.2872 (0.3013) lr 1.8443e-03 eta 0:10:59
epoch [11/50] batch [160/181] time 0.076 (0.091) data 0.000 (0.005) loss 0.7058 (0.7410) ce_loss 0.2593 (0.3817) loss_zs_kd 0.0910 (0.0727) loss_oracle 0.0464 (0.0373) acc 96.8750 (86.4648) kd_loss 0.3778 (0.3043) lr 1.8443e-03 eta 0:10:44
epoch [11/50] batch [180/181] time 0.074 (0.089) data 0.000 (0.005) loss 0.8690 (0.7502) ce_loss 0.4480 (0.3856) loss_zs_kd 0.0510 (0.0736) loss_oracle 0.0475 (0.0380) acc 81.2500 (86.4062) kd_loss 0.3718 (0.3088) lr 1.8443e-03 eta 0:10:30
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,398
* accuracy: 96.0%
* error: 4.0%
* macro_f1: 96.5%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.0%, epoch: 9 *******
******* Domain p best val test acc: 99.9%, epoch: 9 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [12/50] batch [20/181] time 0.096 (0.113) data 0.000 (0.042) loss 0.8006 (0.8444) ce_loss 0.4060 (0.4151) loss_zs_kd 0.0757 (0.0701) loss_oracle 0.0299 (0.0267) acc 78.1250 (82.9688) kd_loss 0.3418 (0.3810) lr 1.8090e-03 eta 0:13:12
epoch [12/50] batch [40/181] time 0.084 (0.100) data 0.000 (0.021) loss 1.0104 (0.8013) ce_loss 0.5679 (0.3817) loss_zs_kd 0.0678 (0.0707) loss_oracle 0.0348 (0.0278) acc 81.2500 (85.7812) kd_loss 0.3912 (0.3704) lr 1.8090e-03 eta 0:11:43
epoch [12/50] batch [60/181] time 0.094 (0.096) data 0.001 (0.014) loss 0.8710 (0.8085) ce_loss 0.4131 (0.3829) loss_zs_kd 0.0969 (0.0713) loss_oracle 0.0185 (0.0275) acc 84.3750 (85.4688) kd_loss 0.4003 (0.3762) lr 1.8090e-03 eta 0:11:13
epoch [12/50] batch [80/181] time 0.113 (0.097) data 0.000 (0.011) loss 0.7249 (0.8088) ce_loss 0.3152 (0.3887) loss_zs_kd 0.1101 (0.0737) loss_oracle 0.0179 (0.0256) acc 87.5000 (85.2344) kd_loss 0.3457 (0.3704) lr 1.8090e-03 eta 0:11:19
epoch [12/50] batch [100/181] time 0.110 (0.098) data 0.000 (0.009) loss 0.7480 (0.8060) ce_loss 0.2788 (0.3873) loss_zs_kd 0.0776 (0.0762) loss_oracle 0.0172 (0.0250) acc 93.7500 (84.9688) kd_loss 0.4218 (0.3681) lr 1.8090e-03 eta 0:11:23
epoch [12/50] batch [120/181] time 0.101 (0.099) data 0.000 (0.007) loss 0.6985 (0.8068) ce_loss 0.3755 (0.3933) loss_zs_kd 0.0751 (0.0754) loss_oracle 0.0227 (0.0241) acc 87.5000 (84.9740) kd_loss 0.2741 (0.3637) lr 1.8090e-03 eta 0:11:25
epoch [12/50] batch [140/181] time 0.098 (0.099) data 0.000 (0.006) loss 0.7127 (0.8068) ce_loss 0.3762 (0.3949) loss_zs_kd 0.0648 (0.0751) loss_oracle 0.0176 (0.0242) acc 81.2500 (84.8884) kd_loss 0.2953 (0.3623) lr 1.8090e-03 eta 0:11:26
epoch [12/50] batch [160/181] time 0.100 (0.099) data 0.000 (0.005) loss 0.8653 (0.8019) ce_loss 0.4863 (0.3912) loss_zs_kd 0.0513 (0.0744) loss_oracle 0.0202 (0.0241) acc 84.3750 (85.0977) kd_loss 0.3432 (0.3615) lr 1.8090e-03 eta 0:11:23
epoch [12/50] batch [180/181] time 0.073 (0.099) data 0.000 (0.005) loss 0.7942 (0.8014) ce_loss 0.3972 (0.3911) loss_zs_kd 0.0668 (0.0743) loss_oracle 0.0281 (0.0244) acc 84.3750 (85.0521) kd_loss 0.3495 (0.3610) lr 1.8090e-03 eta 0:11:19
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,401
* accuracy: 96.2%
* error: 3.8%
* macro_f1: 96.7%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,666
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.2%, epoch: 12 *******
******* Domain p best val test acc: 99.8%, epoch: 12 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [13/50] batch [20/181] time 0.098 (0.141) data 0.000 (0.043) loss 0.6304 (0.8560) ce_loss 0.2625 (0.4083) loss_zs_kd 0.0818 (0.0873) loss_oracle 0.0209 (0.0289) acc 96.8750 (85.1562) kd_loss 0.3165 (0.3897) lr 1.7705e-03 eta 0:16:04
epoch [13/50] batch [40/181] time 0.103 (0.119) data 0.000 (0.021) loss 0.6402 (0.8261) ce_loss 0.2720 (0.3788) loss_zs_kd 0.0478 (0.0791) loss_oracle 0.0314 (0.0308) acc 93.7500 (86.2500) kd_loss 0.3287 (0.3923) lr 1.7705e-03 eta 0:13:37
epoch [13/50] batch [60/181] time 0.107 (0.114) data 0.000 (0.014) loss 0.9235 (0.8334) ce_loss 0.4399 (0.3799) loss_zs_kd 0.0494 (0.0786) loss_oracle 0.0422 (0.0313) acc 84.3750 (86.3542) kd_loss 0.4378 (0.3985) lr 1.7705e-03 eta 0:12:55
epoch [13/50] batch [80/181] time 0.095 (0.110) data 0.000 (0.011) loss 1.1977 (0.8569) ce_loss 0.5410 (0.3802) loss_zs_kd 0.0525 (0.0762) loss_oracle 0.0469 (0.0340) acc 84.3750 (86.4844) kd_loss 0.6070 (0.4216) lr 1.7705e-03 eta 0:12:28
epoch [13/50] batch [100/181] time 0.108 (0.108) data 0.000 (0.009) loss 0.8153 (0.8749) ce_loss 0.3630 (0.3837) loss_zs_kd 0.0902 (0.0762) loss_oracle 0.0287 (0.0337) acc 87.5000 (86.2188) kd_loss 0.3928 (0.4363) lr 1.7705e-03 eta 0:12:13
epoch [13/50] batch [120/181] time 0.101 (0.107) data 0.000 (0.007) loss 0.5736 (0.8745) ce_loss 0.1863 (0.3835) loss_zs_kd 0.0596 (0.0754) loss_oracle 0.0477 (0.0356) acc 96.8750 (86.2240) kd_loss 0.3337 (0.4355) lr 1.7705e-03 eta 0:12:02
epoch [13/50] batch [140/181] time 0.100 (0.106) data 0.000 (0.006) loss 0.5782 (0.8794) ce_loss 0.1915 (0.3910) loss_zs_kd 0.0595 (0.0765) loss_oracle 0.0419 (0.0371) acc 90.6250 (85.7589) kd_loss 0.3360 (0.4317) lr 1.7705e-03 eta 0:11:52
epoch [13/50] batch [160/181] time 0.096 (0.105) data 0.000 (0.006) loss 1.0126 (0.8719) ce_loss 0.4734 (0.3832) loss_zs_kd 0.0554 (0.0741) loss_oracle 0.0621 (0.0393) acc 81.2500 (85.8984) kd_loss 0.4805 (0.4320) lr 1.7705e-03 eta 0:11:44
epoch [13/50] batch [180/181] time 0.093 (0.104) data 0.000 (0.005) loss 1.0225 (0.8775) ce_loss 0.4316 (0.3802) loss_zs_kd 0.1322 (0.0754) loss_oracle 0.0650 (0.0402) acc 90.6250 (85.9549) kd_loss 0.4922 (0.4395) lr 1.7705e-03 eta 0:11:33
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,398
* accuracy: 96.0%
* error: 4.0%
* macro_f1: 96.5%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,665
* accuracy: 99.7%
* error: 0.3%
* macro_f1: 99.7%
******* Domain p best val acc:      96.2%, epoch: 12 *******
******* Domain p best val test acc: 99.8%, epoch: 12 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [14/50] batch [20/181] time 0.083 (0.134) data 0.000 (0.046) loss 0.8612 (0.9436) ce_loss 0.3464 (0.3972) loss_zs_kd 0.0301 (0.0714) loss_oracle 0.0358 (0.0543) acc 84.3750 (85.4688) kd_loss 0.4818 (0.4836) lr 1.7290e-03 eta 0:14:57
epoch [14/50] batch [40/181] time 0.085 (0.111) data 0.000 (0.023) loss 0.5856 (0.9187) ce_loss 0.1260 (0.3869) loss_zs_kd 0.0745 (0.0755) loss_oracle 0.0409 (0.0487) acc 96.8750 (86.2500) kd_loss 0.4019 (0.4698) lr 1.7290e-03 eta 0:12:17
epoch [14/50] batch [60/181] time 0.095 (0.103) data 0.000 (0.016) loss 0.7247 (0.9186) ce_loss 0.2437 (0.3899) loss_zs_kd 0.0606 (0.0749) loss_oracle 0.0480 (0.0486) acc 93.7500 (86.3021) kd_loss 0.4267 (0.4670) lr 1.7290e-03 eta 0:11:20
epoch [14/50] batch [80/181] time 0.174 (0.103) data 0.000 (0.012) loss 0.9400 (0.9113) ce_loss 0.4653 (0.3927) loss_zs_kd 0.0861 (0.0772) loss_oracle 0.0593 (0.0504) acc 84.3750 (85.8203) kd_loss 0.4020 (0.4547) lr 1.7290e-03 eta 0:11:22
epoch [14/50] batch [100/181] time 0.156 (0.107) data 0.000 (0.009) loss 0.9629 (0.8976) ce_loss 0.4341 (0.3869) loss_zs_kd 0.0422 (0.0750) loss_oracle 0.0375 (0.0483) acc 81.2500 (85.9375) kd_loss 0.4890 (0.4490) lr 1.7290e-03 eta 0:11:44
epoch [14/50] batch [120/181] time 0.074 (0.108) data 0.000 (0.008) loss 0.7907 (0.8872) ce_loss 0.3826 (0.3842) loss_zs_kd 0.0596 (0.0752) loss_oracle 0.0574 (0.0475) acc 87.5000 (86.0677) kd_loss 0.3496 (0.4416) lr 1.7290e-03 eta 0:11:49
epoch [14/50] batch [140/181] time 0.082 (0.108) data 0.000 (0.007) loss 0.9973 (0.8844) ce_loss 0.5679 (0.3859) loss_zs_kd 0.0987 (0.0755) loss_oracle 0.0715 (0.0492) acc 78.1250 (86.0491) kd_loss 0.3443 (0.4361) lr 1.7290e-03 eta 0:11:48
epoch [14/50] batch [160/181] time 0.080 (0.105) data 0.000 (0.006) loss 0.8821 (0.8855) ce_loss 0.3269 (0.3896) loss_zs_kd 0.0602 (0.0746) loss_oracle 0.0559 (0.0498) acc 90.6250 (85.7422) kd_loss 0.4971 (0.4337) lr 1.7290e-03 eta 0:11:26
epoch [14/50] batch [180/181] time 0.071 (0.102) data 0.000 (0.005) loss 0.8724 (0.8819) ce_loss 0.3926 (0.3862) loss_zs_kd 0.0542 (0.0740) loss_oracle 0.0454 (0.0487) acc 84.3750 (85.7812) kd_loss 0.4300 (0.4344) lr 1.7290e-03 eta 0:11:04
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,406
* accuracy: 96.4%
* error: 3.6%
* macro_f1: 96.8%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.4%, epoch: 14 *******
******* Domain p best val test acc: 99.9%, epoch: 14 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [15/50] batch [20/181] time 0.116 (0.153) data 0.000 (0.048) loss 0.8377 (0.8645) ce_loss 0.4656 (0.3911) loss_zs_kd 0.0808 (0.0813) loss_oracle 0.0451 (0.0347) acc 81.2500 (85.9375) kd_loss 0.3092 (0.4154) lr 1.6845e-03 eta 0:16:35
epoch [15/50] batch [40/181] time 0.083 (0.118) data 0.000 (0.024) loss 0.8982 (0.9002) ce_loss 0.3623 (0.3994) loss_zs_kd 0.0729 (0.0833) loss_oracle 0.0525 (0.0414) acc 84.3750 (85.4688) kd_loss 0.4732 (0.4385) lr 1.6845e-03 eta 0:12:44
epoch [15/50] batch [60/181] time 0.078 (0.106) data 0.001 (0.016) loss 0.7651 (0.8911) ce_loss 0.3083 (0.3868) loss_zs_kd 0.0729 (0.0786) loss_oracle 0.0474 (0.0429) acc 81.2500 (85.3125) kd_loss 0.3966 (0.4435) lr 1.6845e-03 eta 0:11:25
epoch [15/50] batch [80/181] time 0.102 (0.101) data 0.000 (0.012) loss 1.0680 (0.9062) ce_loss 0.3982 (0.3835) loss_zs_kd 0.0721 (0.0763) loss_oracle 0.0825 (0.0464) acc 81.2500 (85.3516) kd_loss 0.5925 (0.4613) lr 1.6845e-03 eta 0:10:49
epoch [15/50] batch [100/181] time 0.099 (0.101) data 0.000 (0.010) loss 0.8560 (0.9247) ce_loss 0.2097 (0.3787) loss_zs_kd 0.0607 (0.0752) loss_oracle 0.0898 (0.0530) acc 96.8750 (85.6250) kd_loss 0.5710 (0.4819) lr 1.6845e-03 eta 0:10:47
epoch [15/50] batch [120/181] time 0.078 (0.100) data 0.001 (0.008) loss 1.0592 (0.9342) ce_loss 0.5049 (0.3684) loss_zs_kd 0.0792 (0.0740) loss_oracle 0.0626 (0.0546) acc 81.2500 (86.1458) kd_loss 0.4834 (0.5015) lr 1.6845e-03 eta 0:10:39
epoch [15/50] batch [140/181] time 0.105 (0.100) data 0.000 (0.007) loss 1.0299 (0.9445) ce_loss 0.3799 (0.3676) loss_zs_kd 0.0683 (0.0729) loss_oracle 0.0308 (0.0537) acc 87.5000 (86.1384) kd_loss 0.6005 (0.5136) lr 1.6845e-03 eta 0:10:37
epoch [15/50] batch [160/181] time 0.109 (0.100) data 0.001 (0.006) loss 1.0062 (0.9537) ce_loss 0.4009 (0.3706) loss_zs_kd 0.0634 (0.0712) loss_oracle 0.0281 (0.0508) acc 84.3750 (85.9766) kd_loss 0.5596 (0.5221) lr 1.6845e-03 eta 0:10:34
epoch [15/50] batch [180/181] time 0.098 (0.100) data 0.000 (0.006) loss 1.3839 (0.9629) ce_loss 0.6665 (0.3727) loss_zs_kd 0.1267 (0.0721) loss_oracle 0.0426 (0.0504) acc 75.0000 (85.9722) kd_loss 0.6327 (0.5290) lr 1.6845e-03 eta 0:10:30
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,407
* accuracy: 96.4%
* error: 3.6%
* macro_f1: 96.9%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [16/50] batch [20/181] time 0.081 (0.134) data 0.000 (0.047) loss 1.2527 (1.0910) ce_loss 0.5273 (0.4017) loss_zs_kd 0.1027 (0.0871) loss_oracle 0.0449 (0.0568) acc 78.1250 (84.6875) kd_loss 0.6515 (0.6174) lr 1.6374e-03 eta 0:14:06
epoch [16/50] batch [40/181] time 0.082 (0.108) data 0.000 (0.024) loss 1.0552 (1.0814) ce_loss 0.4478 (0.4093) loss_zs_kd 0.0806 (0.0806) loss_oracle 0.0533 (0.0540) acc 78.1250 (83.7500) kd_loss 0.5405 (0.6048) lr 1.6374e-03 eta 0:11:22
epoch [16/50] batch [60/181] time 0.085 (0.099) data 0.001 (0.016) loss 0.8459 (1.0418) ce_loss 0.2820 (0.3974) loss_zs_kd 0.0594 (0.0805) loss_oracle 0.0468 (0.0502) acc 93.7500 (84.7917) kd_loss 0.5109 (0.5790) lr 1.6374e-03 eta 0:10:23
epoch [16/50] batch [80/181] time 0.087 (0.096) data 0.000 (0.012) loss 1.0262 (1.0151) ce_loss 0.4148 (0.3942) loss_zs_kd 0.0978 (0.0782) loss_oracle 0.0671 (0.0479) acc 81.2500 (85.1172) kd_loss 0.5290 (0.5579) lr 1.6374e-03 eta 0:10:01
epoch [16/50] batch [100/181] time 0.088 (0.094) data 0.000 (0.010) loss 0.9236 (1.0195) ce_loss 0.3647 (0.4057) loss_zs_kd 0.0607 (0.0777) loss_oracle 0.0228 (0.0454) acc 84.3750 (84.5625) kd_loss 0.5171 (0.5523) lr 1.6374e-03 eta 0:09:47
epoch [16/50] batch [120/181] time 0.090 (0.093) data 0.001 (0.008) loss 1.0665 (1.0168) ce_loss 0.5347 (0.4052) loss_zs_kd 0.0922 (0.0786) loss_oracle 0.0325 (0.0435) acc 78.1250 (84.7396) kd_loss 0.4694 (0.5505) lr 1.6374e-03 eta 0:09:37
epoch [16/50] batch [140/181] time 0.090 (0.092) data 0.000 (0.007) loss 1.1027 (1.0137) ce_loss 0.3650 (0.3982) loss_zs_kd 0.0697 (0.0784) loss_oracle 0.0774 (0.0447) acc 87.5000 (84.9777) kd_loss 0.6641 (0.5539) lr 1.6374e-03 eta 0:09:31
epoch [16/50] batch [160/181] time 0.091 (0.091) data 0.000 (0.006) loss 1.0378 (1.0220) ce_loss 0.3115 (0.3972) loss_zs_kd 0.1252 (0.0804) loss_oracle 0.0906 (0.0487) acc 90.6250 (85.1367) kd_loss 0.6184 (0.5602) lr 1.6374e-03 eta 0:09:24
epoch [16/50] batch [180/181] time 0.068 (0.090) data 0.000 (0.005) loss 0.8201 (1.0241) ce_loss 0.2240 (0.3936) loss_zs_kd 0.0673 (0.0799) loss_oracle 0.0787 (0.0523) acc 90.6250 (85.3646) kd_loss 0.5231 (0.5643) lr 1.6374e-03 eta 0:09:11
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,406
* accuracy: 96.4%
* error: 3.6%
* macro_f1: 96.8%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [17/50] batch [20/181] time 0.117 (0.167) data 0.001 (0.056) loss 1.1434 (1.0764) ce_loss 0.4617 (0.3966) loss_zs_kd 0.0780 (0.0864) loss_oracle 0.0866 (0.0739) acc 87.5000 (85.4688) kd_loss 0.5994 (0.5996) lr 1.5878e-03 eta 0:17:02
epoch [17/50] batch [40/181] time 0.088 (0.123) data 0.000 (0.028) loss 1.1149 (1.0750) ce_loss 0.3435 (0.3802) loss_zs_kd 0.0548 (0.0803) loss_oracle 0.0696 (0.0769) acc 90.6250 (86.2500) kd_loss 0.7092 (0.6162) lr 1.5878e-03 eta 0:12:33
epoch [17/50] batch [60/181] time 0.087 (0.112) data 0.001 (0.019) loss 0.9190 (1.0784) ce_loss 0.2092 (0.3742) loss_zs_kd 0.0565 (0.0792) loss_oracle 0.0706 (0.0734) acc 90.6250 (86.0938) kd_loss 0.6462 (0.6279) lr 1.5878e-03 eta 0:11:21
epoch [17/50] batch [80/181] time 0.100 (0.105) data 0.000 (0.014) loss 0.8567 (1.0833) ce_loss 0.3062 (0.3782) loss_zs_kd 0.0749 (0.0810) loss_oracle 0.0244 (0.0649) acc 90.6250 (86.1719) kd_loss 0.5009 (0.6322) lr 1.5878e-03 eta 0:10:35
epoch [17/50] batch [100/181] time 0.135 (0.101) data 0.001 (0.012) loss 0.9967 (1.0668) ce_loss 0.3860 (0.3738) loss_zs_kd 0.0569 (0.0773) loss_oracle 0.0522 (0.0600) acc 87.5000 (86.3438) kd_loss 0.5562 (0.6243) lr 1.5878e-03 eta 0:10:12
epoch [17/50] batch [120/181] time 0.098 (0.099) data 0.000 (0.010) loss 1.0737 (1.0522) ce_loss 0.2686 (0.3698) loss_zs_kd 0.0776 (0.0764) loss_oracle 0.0710 (0.0572) acc 87.5000 (86.4062) kd_loss 0.7308 (0.6156) lr 1.5878e-03 eta 0:09:58
epoch [17/50] batch [140/181] time 0.093 (0.100) data 0.000 (0.008) loss 1.2141 (1.0610) ce_loss 0.5410 (0.3800) loss_zs_kd 0.1191 (0.0771) loss_oracle 0.0896 (0.0563) acc 81.2500 (85.8482) kd_loss 0.5687 (0.6143) lr 1.5878e-03 eta 0:10:03
epoch [17/50] batch [160/181] time 0.098 (0.102) data 0.000 (0.007) loss 1.1638 (1.0611) ce_loss 0.4712 (0.3815) loss_zs_kd 0.0997 (0.0781) loss_oracle 0.1009 (0.0576) acc 84.3750 (85.7422) kd_loss 0.5923 (0.6117) lr 1.5878e-03 eta 0:10:09
epoch [17/50] batch [180/181] time 0.082 (0.102) data 0.000 (0.007) loss 1.1052 (1.0575) ce_loss 0.3945 (0.3814) loss_zs_kd 0.1024 (0.0787) loss_oracle 0.0623 (0.0597) acc 84.3750 (85.7639) kd_loss 0.6284 (0.6068) lr 1.5878e-03 eta 0:10:07
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,403
* accuracy: 96.2%
* error: 3.8%
* macro_f1: 96.7%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [18/50] batch [20/181] time 0.105 (0.168) data 0.000 (0.062) loss 1.1360 (1.0848) ce_loss 0.4751 (0.4019) loss_zs_kd 0.0789 (0.0799) loss_oracle 0.0476 (0.0625) acc 81.2500 (83.5938) kd_loss 0.5976 (0.6117) lr 1.5358e-03 eta 0:16:37
epoch [18/50] batch [40/181] time 0.102 (0.135) data 0.000 (0.031) loss 1.1453 (1.0923) ce_loss 0.4033 (0.3999) loss_zs_kd 0.1220 (0.0813) loss_oracle 0.0577 (0.0549) acc 84.3750 (84.3750) kd_loss 0.6521 (0.6243) lr 1.5358e-03 eta 0:13:23
epoch [18/50] batch [60/181] time 0.098 (0.123) data 0.001 (0.021) loss 1.0266 (1.1009) ce_loss 0.2769 (0.3954) loss_zs_kd 0.0840 (0.0836) loss_oracle 0.0759 (0.0541) acc 93.7500 (84.5833) kd_loss 0.6698 (0.6367) lr 1.5358e-03 eta 0:12:07
epoch [18/50] batch [80/181] time 0.104 (0.118) data 0.000 (0.016) loss 1.5603 (1.1054) ce_loss 0.7158 (0.3909) loss_zs_kd 0.1210 (0.0848) loss_oracle 0.0894 (0.0578) acc 71.8750 (84.9609) kd_loss 0.7392 (0.6432) lr 1.5358e-03 eta 0:11:35
epoch [18/50] batch [100/181] time 0.100 (0.115) data 0.000 (0.013) loss 1.1231 (1.1108) ce_loss 0.3496 (0.3884) loss_zs_kd 0.0572 (0.0845) loss_oracle 0.0930 (0.0627) acc 87.5000 (85.4062) kd_loss 0.6985 (0.6489) lr 1.5358e-03 eta 0:11:13
epoch [18/50] batch [120/181] time 0.095 (0.112) data 0.000 (0.011) loss 1.4134 (1.1197) ce_loss 0.5684 (0.3914) loss_zs_kd 0.0722 (0.0833) loss_oracle 0.0587 (0.0627) acc 78.1250 (85.2604) kd_loss 0.7796 (0.6553) lr 1.5358e-03 eta 0:10:55
epoch [18/50] batch [140/181] time 0.108 (0.110) data 0.000 (0.009) loss 1.3888 (1.1187) ce_loss 0.4998 (0.3837) loss_zs_kd 0.1070 (0.0819) loss_oracle 0.0593 (0.0622) acc 78.1250 (85.6920) kd_loss 0.8059 (0.6630) lr 1.5358e-03 eta 0:10:42
epoch [18/50] batch [160/181] time 0.101 (0.109) data 0.000 (0.008) loss 1.0219 (1.1219) ce_loss 0.2864 (0.3839) loss_zs_kd 0.0363 (0.0813) loss_oracle 0.1125 (0.0648) acc 87.5000 (85.7422) kd_loss 0.6612 (0.6649) lr 1.5358e-03 eta 0:10:32
epoch [18/50] batch [180/181] time 0.064 (0.106) data 0.000 (0.007) loss 1.2265 (1.1270) ce_loss 0.5098 (0.3843) loss_zs_kd 0.0331 (0.0807) loss_oracle 0.1152 (0.0702) acc 81.2500 (85.6944) kd_loss 0.6426 (0.6673) lr 1.5358e-03 eta 0:10:13
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,404
* accuracy: 96.3%
* error: 3.7%
* macro_f1: 96.7%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [19/50] batch [20/181] time 0.075 (0.169) data 0.000 (0.066) loss 1.1446 (1.1354) ce_loss 0.3779 (0.3333) loss_zs_kd 0.0726 (0.0780) loss_oracle 0.1882 (0.1440) acc 84.3750 (88.2812) kd_loss 0.6362 (0.6911) lr 1.4818e-03 eta 0:16:16
epoch [19/50] batch [40/181] time 0.095 (0.142) data 0.000 (0.033) loss 0.9947 (1.1358) ce_loss 0.2166 (0.3518) loss_zs_kd 0.0697 (0.0794) loss_oracle 0.0731 (0.1293) acc 90.6250 (86.5625) kd_loss 0.7068 (0.6797) lr 1.4818e-03 eta 0:13:37
epoch [19/50] batch [60/181] time 0.143 (0.134) data 0.000 (0.022) loss 1.0364 (1.1404) ce_loss 0.3081 (0.3696) loss_zs_kd 0.0669 (0.0765) loss_oracle 0.0689 (0.1152) acc 90.6250 (86.0938) kd_loss 0.6604 (0.6750) lr 1.4818e-03 eta 0:12:48
epoch [19/50] batch [80/181] time 0.082 (0.127) data 0.000 (0.017) loss 1.1010 (1.1292) ce_loss 0.3630 (0.3691) loss_zs_kd 0.0687 (0.0775) loss_oracle 0.1011 (0.1112) acc 90.6250 (86.3672) kd_loss 0.6530 (0.6658) lr 1.4818e-03 eta 0:12:07
epoch [19/50] batch [100/181] time 0.152 (0.122) data 0.000 (0.014) loss 1.1017 (1.1367) ce_loss 0.3567 (0.3843) loss_zs_kd 0.0728 (0.0799) loss_oracle 0.0595 (0.1061) acc 87.5000 (85.6875) kd_loss 0.6789 (0.6595) lr 1.4818e-03 eta 0:11:33
epoch [19/50] batch [120/181] time 0.084 (0.119) data 0.000 (0.011) loss 1.1263 (1.1422) ce_loss 0.4177 (0.3914) loss_zs_kd 0.0480 (0.0807) loss_oracle 0.0506 (0.1009) acc 84.3750 (85.3906) kd_loss 0.6593 (0.6600) lr 1.4818e-03 eta 0:11:12
epoch [19/50] batch [140/181] time 0.085 (0.118) data 0.000 (0.010) loss 1.2412 (1.1421) ce_loss 0.4785 (0.3892) loss_zs_kd 0.0454 (0.0801) loss_oracle 0.0677 (0.0967) acc 87.5000 (85.4688) kd_loss 0.7061 (0.6644) lr 1.4818e-03 eta 0:11:04
epoch [19/50] batch [160/181] time 0.097 (0.114) data 0.000 (0.009) loss 1.1990 (1.1496) ce_loss 0.3857 (0.3909) loss_zs_kd 0.0778 (0.0802) loss_oracle 0.1097 (0.0930) acc 87.5000 (85.4297) kd_loss 0.7196 (0.6721) lr 1.4818e-03 eta 0:10:44
epoch [19/50] batch [180/181] time 0.097 (0.113) data 0.000 (0.008) loss 1.3013 (1.1523) ce_loss 0.5405 (0.3897) loss_zs_kd 0.0751 (0.0785) loss_oracle 0.0689 (0.0909) acc 78.1250 (85.5382) kd_loss 0.6887 (0.6779) lr 1.4818e-03 eta 0:10:31
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,399
* accuracy: 96.1%
* error: 3.9%
* macro_f1: 96.6%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [20/50] batch [20/181] time 0.098 (0.160) data 0.000 (0.060) loss 1.2392 (1.1501) ce_loss 0.4978 (0.3842) loss_zs_kd 0.0688 (0.0764) loss_oracle 0.0719 (0.0738) acc 84.3750 (86.4062) kd_loss 0.6711 (0.6909) lr 1.4258e-03 eta 0:14:52
epoch [20/50] batch [40/181] time 0.097 (0.128) data 0.000 (0.030) loss 0.9392 (1.1153) ce_loss 0.2175 (0.3538) loss_zs_kd 0.0529 (0.0780) loss_oracle 0.0625 (0.0663) acc 93.7500 (87.1094) kd_loss 0.6640 (0.6894) lr 1.4258e-03 eta 0:11:53
epoch [20/50] batch [60/181] time 0.096 (0.118) data 0.000 (0.020) loss 0.9676 (1.1189) ce_loss 0.4058 (0.3649) loss_zs_kd 0.0629 (0.0755) loss_oracle 0.0506 (0.0616) acc 78.1250 (86.8229) kd_loss 0.5051 (0.6855) lr 1.4258e-03 eta 0:10:54
epoch [20/50] batch [80/181] time 0.253 (0.115) data 0.000 (0.015) loss 0.9909 (1.1184) ce_loss 0.2242 (0.3607) loss_zs_kd 0.0621 (0.0768) loss_oracle 0.0593 (0.0622) acc 87.5000 (87.1875) kd_loss 0.7060 (0.6882) lr 1.4258e-03 eta 0:10:35
epoch [20/50] batch [100/181] time 0.097 (0.112) data 0.000 (0.012) loss 1.4449 (1.1232) ce_loss 0.6152 (0.3590) loss_zs_kd 0.1074 (0.0795) loss_oracle 0.0822 (0.0658) acc 78.1250 (87.0938) kd_loss 0.7349 (0.6916) lr 1.4258e-03 eta 0:10:15
epoch [20/50] batch [120/181] time 0.103 (0.110) data 0.000 (0.010) loss 1.0511 (1.1316) ce_loss 0.2318 (0.3625) loss_zs_kd 0.0622 (0.0788) loss_oracle 0.0786 (0.0664) acc 90.6250 (86.8229) kd_loss 0.7489 (0.6965) lr 1.4258e-03 eta 0:10:02
epoch [20/50] batch [140/181] time 0.098 (0.108) data 0.000 (0.009) loss 1.0768 (1.1465) ce_loss 0.3218 (0.3743) loss_zs_kd 0.0773 (0.0782) loss_oracle 0.0977 (0.0684) acc 87.5000 (86.5402) kd_loss 0.6676 (0.6989) lr 1.4258e-03 eta 0:09:53
epoch [20/50] batch [160/181] time 0.102 (0.107) data 0.000 (0.008) loss 0.9697 (1.1526) ce_loss 0.3550 (0.3811) loss_zs_kd 0.0802 (0.0782) loss_oracle 0.0542 (0.0717) acc 87.5000 (86.2891) kd_loss 0.5475 (0.6966) lr 1.4258e-03 eta 0:09:43
epoch [20/50] batch [180/181] time 0.089 (0.106) data 0.000 (0.007) loss 1.1399 (1.1520) ce_loss 0.3367 (0.3771) loss_zs_kd 0.0869 (0.0769) loss_oracle 0.1066 (0.0754) acc 84.3750 (86.4236) kd_loss 0.7065 (0.6987) lr 1.4258e-03 eta 0:09:33
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,404
* accuracy: 96.3%
* error: 3.7%
* macro_f1: 96.8%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [21/50] batch [20/181] time 0.082 (0.153) data 0.000 (0.061) loss 1.1265 (1.1697) ce_loss 0.3367 (0.3742) loss_zs_kd 0.0422 (0.0685) loss_oracle 0.1237 (0.1056) acc 84.3750 (87.5000) kd_loss 0.7068 (0.7085) lr 1.3681e-03 eta 0:13:48
epoch [21/50] batch [40/181] time 0.080 (0.117) data 0.000 (0.031) loss 1.1317 (1.1727) ce_loss 0.4341 (0.3886) loss_zs_kd 0.0593 (0.0754) loss_oracle 0.0984 (0.1047) acc 81.2500 (86.4062) kd_loss 0.6187 (0.6941) lr 1.3681e-03 eta 0:10:29
epoch [21/50] batch [60/181] time 0.070 (0.114) data 0.000 (0.020) loss 1.0201 (1.1497) ce_loss 0.2844 (0.3731) loss_zs_kd 0.0665 (0.0786) loss_oracle 0.0685 (0.1035) acc 90.6250 (86.8229) kd_loss 0.6682 (0.6856) lr 1.3681e-03 eta 0:10:13
epoch [21/50] batch [80/181] time 0.080 (0.113) data 0.000 (0.015) loss 1.0860 (1.1462) ce_loss 0.3164 (0.3761) loss_zs_kd 0.1340 (0.0763) loss_oracle 0.0560 (0.0940) acc 93.7500 (86.6406) kd_loss 0.6746 (0.6850) lr 1.3681e-03 eta 0:10:03
epoch [21/50] batch [100/181] time 0.134 (0.114) data 0.000 (0.012) loss 1.2266 (1.1504) ce_loss 0.4102 (0.3805) loss_zs_kd 0.0839 (0.0785) loss_oracle 0.0903 (0.0918) acc 84.3750 (86.3125) kd_loss 0.7294 (0.6847) lr 1.3681e-03 eta 0:10:06
epoch [21/50] batch [120/181] time 0.079 (0.112) data 0.000 (0.010) loss 1.0077 (1.1537) ce_loss 0.2739 (0.3817) loss_zs_kd 0.0495 (0.0764) loss_oracle 0.0728 (0.0895) acc 93.7500 (86.4583) kd_loss 0.6727 (0.6891) lr 1.3681e-03 eta 0:09:56
epoch [21/50] batch [140/181] time 0.074 (0.112) data 0.000 (0.009) loss 1.2523 (1.1634) ce_loss 0.4224 (0.3902) loss_zs_kd 0.0854 (0.0755) loss_oracle 0.0565 (0.0872) acc 84.3750 (86.0268) kd_loss 0.7590 (0.6918) lr 1.3681e-03 eta 0:09:52
epoch [21/50] batch [160/181] time 0.071 (0.112) data 0.000 (0.008) loss 1.2153 (1.1652) ce_loss 0.4148 (0.3888) loss_zs_kd 0.0507 (0.0766) loss_oracle 0.0645 (0.0854) acc 81.2500 (86.0352) kd_loss 0.7429 (0.6953) lr 1.3681e-03 eta 0:09:48
epoch [21/50] batch [180/181] time 0.069 (0.108) data 0.000 (0.007) loss 1.0883 (1.1675) ce_loss 0.3560 (0.3903) loss_zs_kd 0.0654 (0.0766) loss_oracle 0.0728 (0.0844) acc 87.5000 (85.9375) kd_loss 0.6633 (0.6967) lr 1.3681e-03 eta 0:09:25
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,403
* accuracy: 96.2%
* error: 3.8%
* macro_f1: 96.7%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [22/50] batch [20/181] time 0.098 (0.165) data 0.000 (0.067) loss 1.2188 (1.1314) ce_loss 0.4402 (0.3662) loss_zs_kd 0.0616 (0.0750) loss_oracle 0.0749 (0.0826) acc 81.2500 (86.8750) kd_loss 0.7104 (0.6864) lr 1.3090e-03 eta 0:14:22
epoch [22/50] batch [40/181] time 0.082 (0.129) data 0.000 (0.033) loss 1.1766 (1.1565) ce_loss 0.3652 (0.3850) loss_zs_kd 0.0800 (0.0813) loss_oracle 0.1172 (0.0853) acc 84.3750 (85.3906) kd_loss 0.7127 (0.6883) lr 1.3090e-03 eta 0:11:13
epoch [22/50] batch [60/181] time 0.094 (0.119) data 0.000 (0.022) loss 0.9859 (1.1375) ce_loss 0.2266 (0.3695) loss_zs_kd 0.0473 (0.0790) loss_oracle 0.0982 (0.0837) acc 93.7500 (86.4583) kd_loss 0.6867 (0.6867) lr 1.3090e-03 eta 0:10:15
epoch [22/50] batch [80/181] time 0.099 (0.114) data 0.000 (0.017) loss 1.0630 (1.1306) ce_loss 0.3933 (0.3705) loss_zs_kd 0.0758 (0.0772) loss_oracle 0.0871 (0.0837) acc 84.3750 (86.3672) kd_loss 0.5882 (0.6796) lr 1.3090e-03 eta 0:09:49
epoch [22/50] batch [100/181] time 0.093 (0.111) data 0.000 (0.014) loss 0.9529 (1.1193) ce_loss 0.2896 (0.3634) loss_zs_kd 0.0744 (0.0783) loss_oracle 0.0990 (0.0861) acc 87.5000 (86.6250) kd_loss 0.5766 (0.6737) lr 1.3090e-03 eta 0:09:32
epoch [22/50] batch [120/181] time 0.096 (0.109) data 0.000 (0.011) loss 1.0837 (1.1240) ce_loss 0.3608 (0.3657) loss_zs_kd 0.0351 (0.0791) loss_oracle 0.1229 (0.0896) acc 87.5000 (86.5365) kd_loss 0.6439 (0.6739) lr 1.3090e-03 eta 0:09:18
epoch [22/50] batch [140/181] time 0.097 (0.108) data 0.000 (0.010) loss 1.2771 (1.1265) ce_loss 0.4878 (0.3608) loss_zs_kd 0.0934 (0.0797) loss_oracle 0.1131 (0.0945) acc 81.2500 (86.6295) kd_loss 0.6860 (0.6785) lr 1.3090e-03 eta 0:09:10
epoch [22/50] batch [160/181] time 0.104 (0.107) data 0.000 (0.009) loss 1.0372 (1.1378) ce_loss 0.3025 (0.3659) loss_zs_kd 0.0696 (0.0804) loss_oracle 0.0847 (0.0967) acc 90.6250 (86.3867) kd_loss 0.6575 (0.6834) lr 1.3090e-03 eta 0:09:03
epoch [22/50] batch [180/181] time 0.091 (0.105) data 0.000 (0.008) loss 1.3425 (1.1463) ce_loss 0.4326 (0.3685) loss_zs_kd 0.0731 (0.0796) loss_oracle 0.1114 (0.0968) acc 81.2500 (86.3368) kd_loss 0.8176 (0.6895) lr 1.3090e-03 eta 0:08:53
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,405
* accuracy: 96.3%
* error: 3.7%
* macro_f1: 96.8%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [23/50] batch [20/181] time 0.086 (0.163) data 0.000 (0.072) loss 1.4504 (1.2620) ce_loss 0.6821 (0.4257) loss_zs_kd 0.0861 (0.0836) loss_oracle 0.1179 (0.1010) acc 71.8750 (84.2188) kd_loss 0.6663 (0.7440) lr 1.2487e-03 eta 0:13:42
epoch [23/50] batch [40/181] time 0.063 (0.134) data 0.000 (0.036) loss 1.3233 (1.2891) ce_loss 0.4065 (0.4190) loss_zs_kd 0.0669 (0.0806) loss_oracle 0.0745 (0.1065) acc 87.5000 (84.6875) kd_loss 0.8461 (0.7766) lr 1.2487e-03 eta 0:11:12
epoch [23/50] batch [60/181] time 0.075 (0.118) data 0.000 (0.024) loss 1.1453 (1.2870) ce_loss 0.2428 (0.3947) loss_zs_kd 0.0978 (0.0825) loss_oracle 0.1557 (0.1155) acc 90.6250 (85.6250) kd_loss 0.7757 (0.7932) lr 1.2487e-03 eta 0:09:48
epoch [23/50] batch [80/181] time 0.089 (0.107) data 0.000 (0.018) loss 1.2507 (1.3059) ce_loss 0.2462 (0.3869) loss_zs_kd 0.0542 (0.0823) loss_oracle 0.0788 (0.1106) acc 90.6250 (85.8594) kd_loss 0.9380 (0.8225) lr 1.2487e-03 eta 0:08:52
epoch [23/50] batch [100/181] time 0.065 (0.106) data 0.000 (0.015) loss 1.3184 (1.3093) ce_loss 0.3645 (0.3850) loss_zs_kd 0.0791 (0.0811) loss_oracle 0.0870 (0.1063) acc 87.5000 (85.7500) kd_loss 0.8709 (0.8305) lr 1.2487e-03 eta 0:08:48
epoch [23/50] batch [120/181] time 0.072 (0.106) data 0.000 (0.012) loss 1.2640 (1.3089) ce_loss 0.2803 (0.3810) loss_zs_kd 0.0854 (0.0814) loss_oracle 0.0914 (0.1081) acc 90.6250 (86.0156) kd_loss 0.8954 (0.8332) lr 1.2487e-03 eta 0:08:45
epoch [23/50] batch [140/181] time 0.074 (0.106) data 0.000 (0.011) loss 1.2985 (1.3130) ce_loss 0.3088 (0.3833) loss_zs_kd 0.0592 (0.0822) loss_oracle 0.1468 (0.1127) acc 84.3750 (85.9375) kd_loss 0.8866 (0.8323) lr 1.2487e-03 eta 0:08:43
epoch [23/50] batch [160/181] time 0.148 (0.106) data 0.000 (0.009) loss 1.2533 (1.3179) ce_loss 0.3494 (0.3887) loss_zs_kd 0.0877 (0.0826) loss_oracle 0.1192 (0.1185) acc 81.2500 (85.5273) kd_loss 0.8005 (0.8286) lr 1.2487e-03 eta 0:08:40
epoch [23/50] batch [180/181] time 0.137 (0.104) data 0.000 (0.008) loss 1.2811 (1.3070) ce_loss 0.4685 (0.3828) loss_zs_kd 0.0627 (0.0828) loss_oracle 0.1343 (0.1236) acc 75.0000 (85.5556) kd_loss 0.7141 (0.8210) lr 1.2487e-03 eta 0:08:29
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,405
* accuracy: 96.3%
* error: 3.7%
* macro_f1: 96.8%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [24/50] batch [20/181] time 0.098 (0.178) data 0.000 (0.076) loss 1.2809 (1.1307) ce_loss 0.4507 (0.3342) loss_zs_kd 0.0734 (0.0763) loss_oracle 0.1091 (0.1163) acc 78.1250 (87.9688) kd_loss 0.7390 (0.7002) lr 1.1874e-03 eta 0:14:27
epoch [24/50] batch [40/181] time 0.103 (0.140) data 0.000 (0.038) loss 1.2748 (1.2035) ce_loss 0.4475 (0.3844) loss_zs_kd 0.0958 (0.0809) loss_oracle 0.1540 (0.1405) acc 78.1250 (85.8594) kd_loss 0.7024 (0.7083) lr 1.1874e-03 eta 0:11:17
epoch [24/50] batch [60/181] time 0.097 (0.128) data 0.000 (0.025) loss 1.3279 (1.2037) ce_loss 0.5713 (0.3842) loss_zs_kd 0.0642 (0.0818) loss_oracle 0.1380 (0.1410) acc 81.2500 (85.8333) kd_loss 0.6555 (0.7080) lr 1.1874e-03 eta 0:10:16
epoch [24/50] batch [80/181] time 0.106 (0.121) data 0.000 (0.019) loss 1.2421 (1.2093) ce_loss 0.3237 (0.3857) loss_zs_kd 0.1139 (0.0820) loss_oracle 0.1030 (0.1397) acc 93.7500 (85.9766) kd_loss 0.8099 (0.7128) lr 1.1874e-03 eta 0:09:42
epoch [24/50] batch [100/181] time 0.105 (0.117) data 0.000 (0.015) loss 1.0370 (1.2171) ce_loss 0.2041 (0.3895) loss_zs_kd 0.0645 (0.0825) loss_oracle 0.1180 (0.1400) acc 93.7500 (85.7812) kd_loss 0.7417 (0.7164) lr 1.1874e-03 eta 0:09:19
epoch [24/50] batch [120/181] time 0.107 (0.114) data 0.000 (0.013) loss 1.1986 (1.2112) ce_loss 0.3958 (0.3808) loss_zs_kd 0.1009 (0.0821) loss_oracle 0.1255 (0.1382) acc 90.6250 (85.9635) kd_loss 0.6897 (0.7203) lr 1.1874e-03 eta 0:09:04
epoch [24/50] batch [140/181] time 0.087 (0.112) data 0.000 (0.011) loss 1.0921 (1.2145) ce_loss 0.2883 (0.3844) loss_zs_kd 0.0358 (0.0813) loss_oracle 0.1730 (0.1371) acc 87.5000 (85.8482) kd_loss 0.6993 (0.7208) lr 1.1874e-03 eta 0:08:50
epoch [24/50] batch [160/181] time 0.103 (0.110) data 0.000 (0.010) loss 1.2617 (1.2116) ce_loss 0.3784 (0.3791) loss_zs_kd 0.0963 (0.0797) loss_oracle 0.1534 (0.1368) acc 84.3750 (86.0938) kd_loss 0.7585 (0.7241) lr 1.1874e-03 eta 0:08:40
epoch [24/50] batch [180/181] time 0.091 (0.109) data 0.000 (0.009) loss 1.2402 (1.2169) ce_loss 0.3831 (0.3796) loss_zs_kd 0.0977 (0.0803) loss_oracle 0.1373 (0.1393) acc 87.5000 (86.1285) kd_loss 0.7397 (0.7275) lr 1.1874e-03 eta 0:08:31
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,402
* accuracy: 96.2%
* error: 3.8%
* macro_f1: 96.7%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [25/50] batch [20/181] time 0.071 (0.172) data 0.000 (0.074) loss 1.2395 (1.3163) ce_loss 0.3335 (0.4376) loss_zs_kd 0.0737 (0.0807) loss_oracle 0.1786 (0.1325) acc 87.5000 (85.1562) kd_loss 0.7798 (0.7721) lr 1.1253e-03 eta 0:13:24
epoch [25/50] batch [40/181] time 0.166 (0.139) data 0.000 (0.037) loss 1.1264 (1.2976) ce_loss 0.1714 (0.3962) loss_zs_kd 0.1433 (0.0839) loss_oracle 0.1584 (0.1522) acc 93.7500 (85.7031) kd_loss 0.8041 (0.7833) lr 1.1253e-03 eta 0:10:46
epoch [25/50] batch [60/181] time 0.159 (0.129) data 0.000 (0.025) loss 1.5098 (1.2883) ce_loss 0.6416 (0.3836) loss_zs_kd 0.1263 (0.0855) loss_oracle 0.2152 (0.1601) acc 71.8750 (86.1979) kd_loss 0.6975 (0.7820) lr 1.1253e-03 eta 0:09:58
epoch [25/50] batch [80/181] time 0.080 (0.119) data 0.000 (0.019) loss 1.2241 (1.2756) ce_loss 0.3821 (0.3736) loss_zs_kd 0.0828 (0.0884) loss_oracle 0.0897 (0.1594) acc 87.5000 (86.5234) kd_loss 0.7558 (0.7781) lr 1.1253e-03 eta 0:09:09
epoch [25/50] batch [100/181] time 0.150 (0.113) data 0.000 (0.015) loss 1.2432 (1.2715) ce_loss 0.3613 (0.3758) loss_zs_kd 0.0984 (0.0871) loss_oracle 0.0841 (0.1474) acc 84.3750 (86.3750) kd_loss 0.7906 (0.7785) lr 1.1253e-03 eta 0:08:41
epoch [25/50] batch [120/181] time 0.071 (0.111) data 0.000 (0.013) loss 1.2419 (1.2704) ce_loss 0.3953 (0.3834) loss_zs_kd 0.0610 (0.0868) loss_oracle 0.0944 (0.1370) acc 87.5000 (86.2240) kd_loss 0.7689 (0.7752) lr 1.1253e-03 eta 0:08:29
epoch [25/50] batch [140/181] time 0.071 (0.111) data 0.000 (0.011) loss 1.2830 (1.2596) ce_loss 0.3777 (0.3786) loss_zs_kd 0.0584 (0.0853) loss_oracle 0.1189 (0.1311) acc 81.2500 (86.3839) kd_loss 0.8167 (0.7728) lr 1.1253e-03 eta 0:08:25
epoch [25/50] batch [160/181] time 0.065 (0.110) data 0.000 (0.009) loss 1.0386 (1.2566) ce_loss 0.2300 (0.3813) loss_zs_kd 0.0413 (0.0834) loss_oracle 0.1416 (0.1283) acc 93.7500 (86.4062) kd_loss 0.7172 (0.7694) lr 1.1253e-03 eta 0:08:20
epoch [25/50] batch [180/181] time 0.066 (0.108) data 0.000 (0.008) loss 1.1484 (1.2467) ce_loss 0.3984 (0.3776) loss_zs_kd 0.0335 (0.0820) loss_oracle 0.1058 (0.1256) acc 84.3750 (86.5104) kd_loss 0.6803 (0.7653) lr 1.1253e-03 eta 0:08:07
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,401
* accuracy: 96.2%
* error: 3.8%
* macro_f1: 96.7%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [26/50] batch [20/181] time 0.094 (0.170) data 0.000 (0.073) loss 1.2767 (1.2024) ce_loss 0.5078 (0.3809) loss_zs_kd 0.1061 (0.0745) loss_oracle 0.0833 (0.0910) acc 84.3750 (86.0938) kd_loss 0.6742 (0.7387) lr 1.0628e-03 eta 0:12:46
epoch [26/50] batch [40/181] time 0.094 (0.133) data 0.000 (0.037) loss 0.9843 (1.2051) ce_loss 0.2035 (0.3842) loss_zs_kd 0.0519 (0.0813) loss_oracle 0.1076 (0.1025) acc 93.7500 (85.5469) kd_loss 0.7011 (0.7290) lr 1.0628e-03 eta 0:09:56
epoch [26/50] batch [60/181] time 0.102 (0.121) data 0.000 (0.025) loss 1.1428 (1.2014) ce_loss 0.3384 (0.3901) loss_zs_kd 0.0614 (0.0821) loss_oracle 0.1346 (0.1092) acc 84.3750 (85.0521) kd_loss 0.7064 (0.7157) lr 1.0628e-03 eta 0:08:59
epoch [26/50] batch [80/181] time 0.084 (0.115) data 0.000 (0.019) loss 1.2406 (1.1875) ce_loss 0.4639 (0.3822) loss_zs_kd 0.0758 (0.0813) loss_oracle 0.1298 (0.1083) acc 84.3750 (85.3516) kd_loss 0.6740 (0.7105) lr 1.0628e-03 eta 0:08:31
epoch [26/50] batch [100/181] time 0.088 (0.111) data 0.000 (0.015) loss 1.0184 (1.1982) ce_loss 0.1927 (0.3932) loss_zs_kd 0.0714 (0.0855) loss_oracle 0.0642 (0.1047) acc 93.7500 (84.9375) kd_loss 0.7578 (0.7098) lr 1.0628e-03 eta 0:08:13
epoch [26/50] batch [120/181] time 0.101 (0.109) data 0.000 (0.012) loss 1.1048 (1.1915) ce_loss 0.3235 (0.3869) loss_zs_kd 0.0795 (0.0870) loss_oracle 0.0900 (0.1022) acc 93.7500 (85.3906) kd_loss 0.6966 (0.7100) lr 1.0628e-03 eta 0:08:01
epoch [26/50] batch [140/181] time 0.100 (0.108) data 0.000 (0.011) loss 1.3261 (1.1934) ce_loss 0.4473 (0.3902) loss_zs_kd 0.1351 (0.0856) loss_oracle 0.0756 (0.0989) acc 87.5000 (85.2679) kd_loss 0.7735 (0.7109) lr 1.0628e-03 eta 0:07:54
epoch [26/50] batch [160/181] time 0.096 (0.107) data 0.000 (0.009) loss 1.1193 (1.1879) ce_loss 0.3142 (0.3867) loss_zs_kd 0.0493 (0.0840) loss_oracle 0.1082 (0.0964) acc 93.7500 (85.5078) kd_loss 0.7264 (0.7111) lr 1.0628e-03 eta 0:07:47
epoch [26/50] batch [180/181] time 0.088 (0.106) data 0.000 (0.008) loss 1.1031 (1.1840) ce_loss 0.2507 (0.3806) loss_zs_kd 0.0632 (0.0826) loss_oracle 0.1040 (0.0956) acc 87.5000 (85.6597) kd_loss 0.7688 (0.7143) lr 1.0628e-03 eta 0:07:38
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,403
* accuracy: 96.2%
* error: 3.8%
* macro_f1: 96.8%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [27/50] batch [20/181] time 0.168 (0.167) data 0.000 (0.078) loss 1.1495 (1.1784) ce_loss 0.4001 (0.3538) loss_zs_kd 0.0545 (0.0758) loss_oracle 0.0785 (0.1037) acc 84.3750 (86.2500) kd_loss 0.6829 (0.7349) lr 1.0000e-03 eta 0:12:02
epoch [27/50] batch [40/181] time 0.157 (0.141) data 0.000 (0.039) loss 1.3142 (1.2094) ce_loss 0.4609 (0.3758) loss_zs_kd 0.0955 (0.0812) loss_oracle 0.1010 (0.1033) acc 84.3750 (85.9375) kd_loss 0.7551 (0.7413) lr 1.0000e-03 eta 0:10:05
epoch [27/50] batch [60/181] time 0.072 (0.129) data 0.001 (0.026) loss 1.2219 (1.2209) ce_loss 0.3440 (0.3780) loss_zs_kd 0.1052 (0.0854) loss_oracle 0.0766 (0.1017) acc 87.5000 (86.1458) kd_loss 0.7870 (0.7493) lr 1.0000e-03 eta 0:09:11
epoch [27/50] batch [80/181] time 0.096 (0.122) data 0.000 (0.020) loss 1.3218 (1.2156) ce_loss 0.4470 (0.3756) loss_zs_kd 0.0841 (0.0843) loss_oracle 0.1010 (0.1053) acc 90.6250 (86.4062) kd_loss 0.7823 (0.7452) lr 1.0000e-03 eta 0:08:38
epoch [27/50] batch [100/181] time 0.085 (0.115) data 0.000 (0.016) loss 1.1931 (1.2257) ce_loss 0.3237 (0.3815) loss_zs_kd 0.0688 (0.0841) loss_oracle 0.1521 (0.1137) acc 87.5000 (86.4062) kd_loss 0.7589 (0.7453) lr 1.0000e-03 eta 0:08:07
epoch [27/50] batch [120/181] time 0.079 (0.112) data 0.000 (0.013) loss 1.1459 (1.2202) ce_loss 0.2484 (0.3715) loss_zs_kd 0.0534 (0.0829) loss_oracle 0.1612 (0.1204) acc 90.6250 (86.5885) kd_loss 0.7902 (0.7471) lr 1.0000e-03 eta 0:07:52
epoch [27/50] batch [140/181] time 0.081 (0.110) data 0.000 (0.011) loss 1.2442 (1.2243) ce_loss 0.4185 (0.3733) loss_zs_kd 0.0625 (0.0806) loss_oracle 0.1046 (0.1209) acc 81.2500 (86.4509) kd_loss 0.7422 (0.7502) lr 1.0000e-03 eta 0:07:41
epoch [27/50] batch [160/181] time 0.081 (0.108) data 0.000 (0.010) loss 1.4929 (1.2184) ce_loss 0.4839 (0.3670) loss_zs_kd 0.0956 (0.0803) loss_oracle 0.1689 (0.1234) acc 81.2500 (86.7578) kd_loss 0.8768 (0.7496) lr 1.0000e-03 eta 0:07:32
epoch [27/50] batch [180/181] time 0.073 (0.108) data 0.000 (0.009) loss 1.1339 (1.2201) ce_loss 0.2362 (0.3669) loss_zs_kd 0.1603 (0.0819) loss_oracle 0.1776 (0.1294) acc 93.7500 (86.7188) kd_loss 0.7287 (0.7475) lr 1.0000e-03 eta 0:07:30
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,406
* accuracy: 96.4%
* error: 3.6%
* macro_f1: 96.8%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [28/50] batch [20/181] time 0.099 (0.184) data 0.000 (0.084) loss 1.3721 (1.1763) ce_loss 0.4707 (0.3035) loss_zs_kd 0.0735 (0.0735) loss_oracle 0.1165 (0.1484) acc 81.2500 (87.8125) kd_loss 0.8064 (0.7618) lr 9.3721e-04 eta 0:12:43
epoch [28/50] batch [40/181] time 0.093 (0.143) data 0.000 (0.042) loss 1.2007 (1.2087) ce_loss 0.3164 (0.3302) loss_zs_kd 0.1004 (0.0792) loss_oracle 0.1084 (0.1444) acc 87.5000 (87.3438) kd_loss 0.7799 (0.7667) lr 9.3721e-04 eta 0:09:50
epoch [28/50] batch [60/181] time 0.102 (0.129) data 0.000 (0.028) loss 1.3006 (1.1971) ce_loss 0.4062 (0.3296) loss_zs_kd 0.1111 (0.0853) loss_oracle 0.1294 (0.1342) acc 87.5000 (87.6562) kd_loss 0.7741 (0.7578) lr 9.3721e-04 eta 0:08:50
epoch [28/50] batch [80/181] time 0.102 (0.122) data 0.000 (0.021) loss 1.3424 (1.2115) ce_loss 0.4500 (0.3426) loss_zs_kd 0.0796 (0.0839) loss_oracle 0.1494 (0.1320) acc 81.2500 (86.9922) kd_loss 0.7779 (0.7609) lr 9.3721e-04 eta 0:08:18
epoch [28/50] batch [100/181] time 0.105 (0.118) data 0.000 (0.017) loss 1.5954 (1.2175) ce_loss 0.6836 (0.3447) loss_zs_kd 0.0903 (0.0842) loss_oracle 0.1440 (0.1351) acc 87.5000 (87.5000) kd_loss 0.7946 (0.7632) lr 9.3721e-04 eta 0:07:59
epoch [28/50] batch [120/181] time 0.103 (0.115) data 0.000 (0.014) loss 1.2574 (1.2346) ce_loss 0.4119 (0.3525) loss_zs_kd 0.0799 (0.0850) loss_oracle 0.0863 (0.1306) acc 81.2500 (87.1094) kd_loss 0.7624 (0.7743) lr 9.3721e-04 eta 0:07:46
epoch [28/50] batch [140/181] time 0.107 (0.114) data 0.000 (0.012) loss 1.2171 (1.2439) ce_loss 0.2275 (0.3506) loss_zs_kd 0.0603 (0.0850) loss_oracle 0.1338 (0.1266) acc 93.7500 (87.3438) kd_loss 0.8925 (0.7875) lr 9.3721e-04 eta 0:07:37
epoch [28/50] batch [160/181] time 0.102 (0.112) data 0.000 (0.011) loss 1.2641 (1.2583) ce_loss 0.3430 (0.3580) loss_zs_kd 0.0971 (0.0844) loss_oracle 0.0984 (0.1227) acc 87.5000 (87.0508) kd_loss 0.8233 (0.7967) lr 9.3721e-04 eta 0:07:28
epoch [28/50] batch [180/181] time 0.091 (0.110) data 0.000 (0.010) loss 1.5102 (1.2640) ce_loss 0.4875 (0.3601) loss_zs_kd 0.0792 (0.0825) loss_oracle 0.1058 (0.1190) acc 78.1250 (87.1528) kd_loss 0.9301 (0.8032) lr 9.3721e-04 eta 0:07:18
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,404
* accuracy: 96.3%
* error: 3.7%
* macro_f1: 96.8%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [29/50] batch [20/181] time 0.082 (0.169) data 0.000 (0.081) loss 1.3580 (1.2985) ce_loss 0.4377 (0.3793) loss_zs_kd 0.0635 (0.0874) loss_oracle 0.0826 (0.0844) acc 87.5000 (85.7812) kd_loss 0.8472 (0.8333) lr 8.7467e-04 eta 0:11:08
epoch [29/50] batch [40/181] time 0.089 (0.127) data 0.000 (0.041) loss 1.5315 (1.3117) ce_loss 0.5688 (0.3811) loss_zs_kd 0.0955 (0.0886) loss_oracle 0.1108 (0.0919) acc 84.3750 (86.4844) kd_loss 0.8595 (0.8403) lr 8.7467e-04 eta 0:08:20
epoch [29/50] batch [60/181] time 0.081 (0.123) data 0.000 (0.027) loss 1.4473 (1.3090) ce_loss 0.4358 (0.3737) loss_zs_kd 0.0677 (0.0851) loss_oracle 0.1383 (0.1017) acc 81.2500 (86.4583) kd_loss 0.9085 (0.8419) lr 8.7467e-04 eta 0:08:01
epoch [29/50] batch [80/181] time 0.085 (0.120) data 0.000 (0.021) loss 1.2117 (1.3039) ce_loss 0.2170 (0.3653) loss_zs_kd 0.0891 (0.0856) loss_oracle 0.1219 (0.1122) acc 93.7500 (86.9141) kd_loss 0.8892 (0.8397) lr 8.7467e-04 eta 0:07:47
epoch [29/50] batch [100/181] time 0.084 (0.114) data 0.000 (0.016) loss 1.4693 (1.3041) ce_loss 0.4788 (0.3619) loss_zs_kd 0.1209 (0.0857) loss_oracle 0.1394 (0.1169) acc 84.3750 (86.8750) kd_loss 0.8604 (0.8409) lr 8.7467e-04 eta 0:07:23
epoch [29/50] batch [120/181] time 0.081 (0.110) data 0.000 (0.014) loss 1.4224 (1.3028) ce_loss 0.3914 (0.3592) loss_zs_kd 0.1489 (0.0867) loss_oracle 0.1011 (0.1181) acc 84.3750 (86.9531) kd_loss 0.9060 (0.8412) lr 8.7467e-04 eta 0:07:03
epoch [29/50] batch [140/181] time 0.156 (0.109) data 0.000 (0.012) loss 1.6258 (1.3049) ce_loss 0.6689 (0.3606) loss_zs_kd 0.1217 (0.0876) loss_oracle 0.1606 (0.1194) acc 65.6250 (86.6741) kd_loss 0.8157 (0.8408) lr 8.7467e-04 eta 0:06:59
epoch [29/50] batch [160/181] time 0.074 (0.108) data 0.000 (0.010) loss 1.0611 (1.3045) ce_loss 0.1356 (0.3603) loss_zs_kd 0.0650 (0.0869) loss_oracle 0.1558 (0.1230) acc 96.8750 (86.7773) kd_loss 0.8151 (0.8392) lr 8.7467e-04 eta 0:06:51
epoch [29/50] batch [180/181] time 0.158 (0.107) data 0.000 (0.009) loss 1.4537 (1.3070) ce_loss 0.5522 (0.3587) loss_zs_kd 0.0793 (0.0851) loss_oracle 0.1198 (0.1253) acc 71.8750 (86.8056) kd_loss 0.8019 (0.8432) lr 8.7467e-04 eta 0:06:46
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,402
* accuracy: 96.2%
* error: 3.8%
* macro_f1: 96.7%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [30/50] batch [20/181] time 0.108 (0.183) data 0.000 (0.090) loss 1.2908 (1.2736) ce_loss 0.3799 (0.3491) loss_zs_kd 0.1021 (0.0773) loss_oracle 0.1092 (0.1203) acc 90.6250 (87.5000) kd_loss 0.8053 (0.8257) lr 8.1262e-04 eta 0:11:32
epoch [30/50] batch [40/181] time 0.098 (0.140) data 0.001 (0.045) loss 1.1949 (1.2968) ce_loss 0.2365 (0.3667) loss_zs_kd 0.0999 (0.0838) loss_oracle 0.0988 (0.1140) acc 93.7500 (87.1875) kd_loss 0.8591 (0.8312) lr 8.1262e-04 eta 0:08:46
epoch [30/50] batch [60/181] time 0.105 (0.125) data 0.000 (0.030) loss 1.2272 (1.3099) ce_loss 0.2910 (0.3759) loss_zs_kd 0.0794 (0.0831) loss_oracle 0.0988 (0.1164) acc 90.6250 (86.3021) kd_loss 0.8471 (0.8343) lr 8.1262e-04 eta 0:07:49
epoch [30/50] batch [80/181] time 0.106 (0.118) data 0.000 (0.023) loss 1.4176 (1.3069) ce_loss 0.4958 (0.3713) loss_zs_kd 0.0478 (0.0838) loss_oracle 0.0898 (0.1142) acc 81.2500 (86.4844) kd_loss 0.8530 (0.8366) lr 8.1262e-04 eta 0:07:20
epoch [30/50] batch [100/181] time 0.094 (0.114) data 0.000 (0.018) loss 1.1820 (1.3114) ce_loss 0.3396 (0.3769) loss_zs_kd 0.0764 (0.0843) loss_oracle 0.1325 (0.1130) acc 87.5000 (86.2812) kd_loss 0.7379 (0.8358) lr 8.1262e-04 eta 0:07:01
epoch [30/50] batch [120/181] time 0.096 (0.111) data 0.000 (0.015) loss 1.2514 (1.3057) ce_loss 0.3831 (0.3737) loss_zs_kd 0.0601 (0.0856) loss_oracle 0.1082 (0.1129) acc 87.5000 (86.3021) kd_loss 0.7842 (0.8328) lr 8.1262e-04 eta 0:06:49
epoch [30/50] batch [140/181] time 0.095 (0.109) data 0.000 (0.013) loss 1.0675 (1.2977) ce_loss 0.1200 (0.3703) loss_zs_kd 0.0460 (0.0859) loss_oracle 0.1362 (0.1166) acc 96.8750 (86.3616) kd_loss 0.8564 (0.8261) lr 8.1262e-04 eta 0:06:39
epoch [30/50] batch [160/181] time 0.095 (0.108) data 0.000 (0.011) loss 1.2250 (1.2962) ce_loss 0.2468 (0.3704) loss_zs_kd 0.0853 (0.0854) loss_oracle 0.1156 (0.1189) acc 93.7500 (86.4258) kd_loss 0.8777 (0.8236) lr 8.1262e-04 eta 0:06:31
epoch [30/50] batch [180/181] time 0.094 (0.106) data 0.000 (0.010) loss 1.4757 (1.2940) ce_loss 0.4351 (0.3657) loss_zs_kd 0.1094 (0.0867) loss_oracle 0.2329 (0.1250) acc 84.3750 (86.7361) kd_loss 0.8694 (0.8225) lr 8.1262e-04 eta 0:06:22
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,404
* accuracy: 96.3%
* error: 3.7%
* macro_f1: 96.8%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,666
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [31/50] batch [20/181] time 0.108 (0.188) data 0.000 (0.091) loss 1.3907 (1.2588) ce_loss 0.4236 (0.3246) loss_zs_kd 0.1114 (0.0890) loss_oracle 0.1265 (0.1686) acc 81.2500 (87.3438) kd_loss 0.8481 (0.8054) lr 7.5131e-04 eta 0:11:15
epoch [31/50] batch [40/181] time 0.087 (0.144) data 0.000 (0.046) loss 1.1805 (1.2979) ce_loss 0.3145 (0.3661) loss_zs_kd 0.0739 (0.0877) loss_oracle 0.1697 (0.1602) acc 90.6250 (86.7969) kd_loss 0.7443 (0.8078) lr 7.5131e-04 eta 0:08:35
epoch [31/50] batch [60/181] time 0.080 (0.126) data 0.000 (0.030) loss 1.1695 (1.3012) ce_loss 0.3560 (0.3665) loss_zs_kd 0.0658 (0.0867) loss_oracle 0.1270 (0.1558) acc 90.6250 (86.7188) kd_loss 0.7171 (0.8135) lr 7.5131e-04 eta 0:07:27
epoch [31/50] batch [80/181] time 0.097 (0.120) data 0.000 (0.023) loss 1.1172 (1.2825) ce_loss 0.3052 (0.3546) loss_zs_kd 0.0469 (0.0822) loss_oracle 0.1003 (0.1486) acc 87.5000 (87.0703) kd_loss 0.7384 (0.8125) lr 7.5131e-04 eta 0:07:03
epoch [31/50] batch [100/181] time 0.075 (0.115) data 0.000 (0.018) loss 1.0910 (1.2785) ce_loss 0.1327 (0.3479) loss_zs_kd 0.0562 (0.0842) loss_oracle 0.0999 (0.1446) acc 96.8750 (87.2188) kd_loss 0.8802 (0.8162) lr 7.5131e-04 eta 0:06:45
epoch [31/50] batch [120/181] time 0.171 (0.115) data 0.000 (0.015) loss 1.0766 (1.2864) ce_loss 0.1406 (0.3528) loss_zs_kd 0.0377 (0.0835) loss_oracle 0.1002 (0.1406) acc 93.7500 (86.9271) kd_loss 0.8671 (0.8215) lr 7.5131e-04 eta 0:06:40
epoch [31/50] batch [140/181] time 0.079 (0.113) data 0.000 (0.013) loss 1.0899 (1.2912) ce_loss 0.2098 (0.3569) loss_zs_kd 0.0733 (0.0843) loss_oracle 0.1333 (0.1418) acc 93.7500 (86.9420) kd_loss 0.7767 (0.8212) lr 7.5131e-04 eta 0:06:33
epoch [31/50] batch [160/181] time 0.062 (0.108) data 0.000 (0.012) loss 1.3374 (1.2925) ce_loss 0.4092 (0.3562) loss_zs_kd 0.0999 (0.0852) loss_oracle 0.1237 (0.1439) acc 87.5000 (87.0312) kd_loss 0.8164 (0.8218) lr 7.5131e-04 eta 0:06:13
epoch [31/50] batch [180/181] time 0.060 (0.105) data 0.000 (0.010) loss 1.2545 (1.2893) ce_loss 0.3760 (0.3536) loss_zs_kd 0.0681 (0.0847) loss_oracle 0.1642 (0.1480) acc 87.5000 (87.1007) kd_loss 0.7624 (0.8194) lr 7.5131e-04 eta 0:06:00
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,406
* accuracy: 96.4%
* error: 3.6%
* macro_f1: 96.9%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.4%, epoch: 15 *******
******* Domain p best val test acc: 99.9%, epoch: 15 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [32/50] batch [20/181] time 0.080 (0.184) data 0.000 (0.086) loss 1.2125 (1.3060) ce_loss 0.3181 (0.3630) loss_zs_kd 0.0640 (0.0763) loss_oracle 0.1504 (0.1705) acc 87.5000 (87.1875) kd_loss 0.7872 (0.8195) lr 6.9098e-04 eta 0:10:27
epoch [32/50] batch [40/181] time 0.102 (0.136) data 0.000 (0.043) loss 1.1431 (1.2976) ce_loss 0.1873 (0.3718) loss_zs_kd 0.0831 (0.0788) loss_oracle 0.1465 (0.1583) acc 93.7500 (86.4062) kd_loss 0.8411 (0.8073) lr 6.9098e-04 eta 0:07:43
epoch [32/50] batch [60/181] time 0.085 (0.124) data 0.000 (0.029) loss 1.4853 (1.2961) ce_loss 0.5586 (0.3769) loss_zs_kd 0.1008 (0.0805) loss_oracle 0.1517 (0.1489) acc 84.3750 (86.4062) kd_loss 0.8004 (0.8046) lr 6.9098e-04 eta 0:06:59
epoch [32/50] batch [80/181] time 0.062 (0.114) data 0.000 (0.022) loss 1.1643 (1.2822) ce_loss 0.2878 (0.3718) loss_zs_kd 0.0799 (0.0824) loss_oracle 0.1503 (0.1438) acc 87.5000 (86.6797) kd_loss 0.7613 (0.7973) lr 6.9098e-04 eta 0:06:22
epoch [32/50] batch [100/181] time 0.099 (0.108) data 0.000 (0.017) loss 1.0690 (1.2789) ce_loss 0.2206 (0.3723) loss_zs_kd 0.1075 (0.0847) loss_oracle 0.1169 (0.1419) acc 87.5000 (86.7812) kd_loss 0.7362 (0.7933) lr 6.9098e-04 eta 0:05:59
epoch [32/50] batch [120/181] time 0.105 (0.106) data 0.000 (0.015) loss 1.2664 (1.2734) ce_loss 0.3826 (0.3715) loss_zs_kd 0.0693 (0.0837) loss_oracle 0.1772 (0.1417) acc 87.5000 (86.8750) kd_loss 0.7606 (0.7892) lr 6.9098e-04 eta 0:05:53
epoch [32/50] batch [140/181] time 0.104 (0.106) data 0.000 (0.012) loss 1.2071 (1.2672) ce_loss 0.2903 (0.3658) loss_zs_kd 0.0969 (0.0840) loss_oracle 0.1748 (0.1415) acc 90.6250 (87.1205) kd_loss 0.7810 (0.7887) lr 6.9098e-04 eta 0:05:48
epoch [32/50] batch [160/181] time 0.099 (0.105) data 0.000 (0.011) loss 1.3845 (1.2617) ce_loss 0.4824 (0.3609) loss_zs_kd 0.0988 (0.0832) loss_oracle 0.1437 (0.1428) acc 78.1250 (87.4219) kd_loss 0.7809 (0.7878) lr 6.9098e-04 eta 0:05:43
epoch [32/50] batch [180/181] time 0.080 (0.103) data 0.000 (0.010) loss 1.0002 (1.2644) ce_loss 0.1488 (0.3639) loss_zs_kd 0.0592 (0.0835) loss_oracle 0.1215 (0.1442) acc 93.7500 (87.1354) kd_loss 0.7610 (0.7865) lr 6.9098e-04 eta 0:05:34
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,413
* accuracy: 96.6%
* error: 3.4%
* macro_f1: 97.1%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [33/50] batch [20/181] time 0.121 (0.196) data 0.000 (0.092) loss 1.1901 (1.2371) ce_loss 0.2917 (0.3565) loss_zs_kd 0.0986 (0.0879) loss_oracle 0.1365 (0.1416) acc 90.6250 (87.6562) kd_loss 0.7808 (0.7658) lr 6.3188e-04 eta 0:10:34
epoch [33/50] batch [40/181] time 0.107 (0.148) data 0.000 (0.046) loss 1.2171 (1.2370) ce_loss 0.4197 (0.3635) loss_zs_kd 0.0731 (0.0831) loss_oracle 0.1184 (0.1403) acc 87.5000 (87.4219) kd_loss 0.7016 (0.7618) lr 6.3188e-04 eta 0:07:57
epoch [33/50] batch [60/181] time 0.096 (0.132) data 0.000 (0.031) loss 1.2020 (1.2738) ce_loss 0.3440 (0.3940) loss_zs_kd 0.1097 (0.0821) loss_oracle 0.1827 (0.1419) acc 87.5000 (86.1458) kd_loss 0.7117 (0.7678) lr 6.3188e-04 eta 0:07:01
epoch [33/50] batch [80/181] time 0.078 (0.121) data 0.001 (0.023) loss 1.1795 (1.2716) ce_loss 0.2505 (0.3931) loss_zs_kd 0.0827 (0.0839) loss_oracle 0.1548 (0.1443) acc 96.8750 (86.0156) kd_loss 0.8103 (0.7643) lr 6.3188e-04 eta 0:06:25
epoch [33/50] batch [100/181] time 0.100 (0.114) data 0.001 (0.019) loss 1.0877 (1.2756) ce_loss 0.2435 (0.3954) loss_zs_kd 0.0503 (0.0865) loss_oracle 0.1555 (0.1466) acc 90.6250 (86.0625) kd_loss 0.7413 (0.7637) lr 6.3188e-04 eta 0:06:00
epoch [33/50] batch [120/181] time 0.168 (0.114) data 0.000 (0.016) loss 1.4407 (1.2707) ce_loss 0.4915 (0.3886) loss_zs_kd 0.1207 (0.0861) loss_oracle 0.1646 (0.1521) acc 81.2500 (86.2760) kd_loss 0.8066 (0.7630) lr 6.3188e-04 eta 0:05:58
epoch [33/50] batch [140/181] time 0.083 (0.112) data 0.000 (0.013) loss 0.9795 (1.2740) ce_loss 0.0978 (0.3902) loss_zs_kd 0.0469 (0.0872) loss_oracle 0.1458 (0.1526) acc 96.8750 (86.0268) kd_loss 0.7854 (0.7639) lr 6.3188e-04 eta 0:05:49
epoch [33/50] batch [160/181] time 0.095 (0.111) data 0.000 (0.012) loss 1.0359 (1.2599) ce_loss 0.1886 (0.3787) loss_zs_kd 0.0653 (0.0859) loss_oracle 0.1420 (0.1514) acc 96.8750 (86.6406) kd_loss 0.7436 (0.7625) lr 6.3188e-04 eta 0:05:42
epoch [33/50] batch [180/181] time 0.069 (0.109) data 0.000 (0.011) loss 1.3060 (1.2604) ce_loss 0.3560 (0.3779) loss_zs_kd 0.1134 (0.0865) loss_oracle 0.2135 (0.1526) acc 87.5000 (86.6146) kd_loss 0.7866 (0.7629) lr 6.3188e-04 eta 0:05:35
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,407
* accuracy: 96.4%
* error: 3.6%
* macro_f1: 96.9%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [34/50] batch [20/181] time 0.073 (0.211) data 0.000 (0.097) loss 1.1831 (1.2815) ce_loss 0.2277 (0.3763) loss_zs_kd 0.0916 (0.0775) loss_oracle 0.1736 (0.1711) acc 90.6250 (86.0938) kd_loss 0.8229 (0.7810) lr 5.7422e-04 eta 0:10:45
epoch [34/50] batch [40/181] time 0.074 (0.152) data 0.000 (0.048) loss 1.1515 (1.2966) ce_loss 0.3203 (0.3857) loss_zs_kd 0.0618 (0.0845) loss_oracle 0.1490 (0.1589) acc 87.5000 (85.5469) kd_loss 0.7258 (0.7891) lr 5.7422e-04 eta 0:07:42
epoch [34/50] batch [60/181] time 0.102 (0.128) data 0.000 (0.032) loss 1.2600 (1.2953) ce_loss 0.2917 (0.3732) loss_zs_kd 0.0981 (0.0884) loss_oracle 0.1647 (0.1588) acc 90.6250 (86.2500) kd_loss 0.8369 (0.7985) lr 5.7422e-04 eta 0:06:24
epoch [34/50] batch [80/181] time 0.096 (0.121) data 0.000 (0.024) loss 1.3598 (1.3031) ce_loss 0.3289 (0.3784) loss_zs_kd 0.0604 (0.0873) loss_oracle 0.1844 (0.1606) acc 87.5000 (85.9375) kd_loss 0.9085 (0.8006) lr 5.7422e-04 eta 0:06:01
epoch [34/50] batch [100/181] time 0.103 (0.117) data 0.000 (0.020) loss 1.1260 (1.3153) ce_loss 0.1578 (0.3807) loss_zs_kd 0.0571 (0.0856) loss_oracle 0.1762 (0.1641) acc 96.8750 (85.8125) kd_loss 0.8515 (0.8097) lr 5.7422e-04 eta 0:05:49
epoch [34/50] batch [120/181] time 0.100 (0.115) data 0.000 (0.016) loss 1.2467 (1.3101) ce_loss 0.2375 (0.3689) loss_zs_kd 0.0855 (0.0836) loss_oracle 0.2072 (0.1677) acc 90.6250 (86.2760) kd_loss 0.8628 (0.8155) lr 5.7422e-04 eta 0:05:38
epoch [34/50] batch [140/181] time 0.114 (0.113) data 0.000 (0.014) loss 1.4368 (1.3068) ce_loss 0.4915 (0.3615) loss_zs_kd 0.0944 (0.0835) loss_oracle 0.2033 (0.1691) acc 87.5000 (86.6295) kd_loss 0.7965 (0.8190) lr 5.7422e-04 eta 0:05:31
epoch [34/50] batch [160/181] time 0.096 (0.111) data 0.000 (0.012) loss 1.4646 (1.3117) ce_loss 0.4409 (0.3630) loss_zs_kd 0.0948 (0.0821) loss_oracle 0.1776 (0.1699) acc 81.2500 (86.6797) kd_loss 0.8875 (0.8227) lr 5.7422e-04 eta 0:05:24
epoch [34/50] batch [180/181] time 0.090 (0.109) data 0.001 (0.011) loss 1.2248 (1.3084) ce_loss 0.3303 (0.3599) loss_zs_kd 0.0545 (0.0813) loss_oracle 0.1675 (0.1694) acc 87.5000 (86.8403) kd_loss 0.7834 (0.8232) lr 5.7422e-04 eta 0:05:16
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,408
* accuracy: 96.4%
* error: 3.6%
* macro_f1: 96.9%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [35/50] batch [20/181] time 0.094 (0.193) data 0.000 (0.092) loss 1.4684 (1.2876) ce_loss 0.5508 (0.3338) loss_zs_kd 0.0628 (0.0811) loss_oracle 0.1258 (0.1425) acc 78.1250 (88.1250) kd_loss 0.8233 (0.8420) lr 5.1825e-04 eta 0:09:14
epoch [35/50] batch [40/181] time 0.099 (0.147) data 0.000 (0.046) loss 1.6149 (1.3399) ce_loss 0.5581 (0.3749) loss_zs_kd 0.0786 (0.0898) loss_oracle 0.1575 (0.1461) acc 81.2500 (86.6406) kd_loss 0.9388 (0.8470) lr 5.1825e-04 eta 0:07:00
epoch [35/50] batch [60/181] time 0.109 (0.133) data 0.000 (0.031) loss 1.6601 (1.3343) ce_loss 0.7007 (0.3671) loss_zs_kd 0.0854 (0.0931) loss_oracle 0.1112 (0.1440) acc 75.0000 (87.0833) kd_loss 0.8611 (0.8486) lr 5.1825e-04 eta 0:06:15
epoch [35/50] batch [80/181] time 0.106 (0.125) data 0.000 (0.023) loss 1.2821 (1.3414) ce_loss 0.3396 (0.3730) loss_zs_kd 0.1289 (0.0923) loss_oracle 0.1676 (0.1509) acc 87.5000 (86.6016) kd_loss 0.7942 (0.8468) lr 5.1825e-04 eta 0:05:50
epoch [35/50] batch [100/181] time 0.068 (0.117) data 0.000 (0.019) loss 1.2757 (1.3271) ce_loss 0.3369 (0.3632) loss_zs_kd 0.0937 (0.0881) loss_oracle 0.1383 (0.1567) acc 87.5000 (86.8438) kd_loss 0.8228 (0.8416) lr 5.1825e-04 eta 0:05:26
epoch [35/50] batch [120/181] time 0.080 (0.109) data 0.000 (0.016) loss 1.1073 (1.3212) ce_loss 0.1638 (0.3608) loss_zs_kd 0.0267 (0.0854) loss_oracle 0.1549 (0.1568) acc 96.8750 (87.0833) kd_loss 0.8527 (0.8392) lr 5.1825e-04 eta 0:05:01
epoch [35/50] batch [140/181] time 0.060 (0.108) data 0.000 (0.013) loss 1.2615 (1.3220) ce_loss 0.3687 (0.3658) loss_zs_kd 0.0803 (0.0859) loss_oracle 0.0990 (0.1543) acc 87.5000 (86.8304) kd_loss 0.8032 (0.8362) lr 5.1825e-04 eta 0:04:57
epoch [35/50] batch [160/181] time 0.073 (0.107) data 0.000 (0.012) loss 1.1535 (1.3171) ce_loss 0.2620 (0.3604) loss_zs_kd 0.0654 (0.0850) loss_oracle 0.1199 (0.1541) acc 87.5000 (86.9922) kd_loss 0.7989 (0.8372) lr 5.1825e-04 eta 0:04:52
epoch [35/50] batch [180/181] time 0.067 (0.106) data 0.000 (0.010) loss 1.4486 (1.3166) ce_loss 0.4292 (0.3611) loss_zs_kd 0.0891 (0.0842) loss_oracle 0.1435 (0.1533) acc 78.1250 (86.9271) kd_loss 0.9031 (0.8367) lr 5.1825e-04 eta 0:04:47
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,406
* accuracy: 96.4%
* error: 3.6%
* macro_f1: 96.8%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [36/50] batch [20/181] time 0.085 (0.205) data 0.000 (0.094) loss 1.1504 (1.3245) ce_loss 0.2781 (0.3927) loss_zs_kd 0.0706 (0.0886) loss_oracle 0.1424 (0.1385) acc 90.6250 (85.6250) kd_loss 0.7658 (0.8183) lr 4.6417e-04 eta 0:09:11
epoch [36/50] batch [40/181] time 0.081 (0.154) data 0.000 (0.047) loss 1.3395 (1.3320) ce_loss 0.4028 (0.3924) loss_zs_kd 0.0572 (0.0841) loss_oracle 0.1529 (0.1446) acc 81.2500 (86.0156) kd_loss 0.8316 (0.8254) lr 4.6417e-04 eta 0:06:51
epoch [36/50] batch [60/181] time 0.096 (0.133) data 0.000 (0.031) loss 1.3720 (1.3220) ce_loss 0.4424 (0.3753) loss_zs_kd 0.0872 (0.0824) loss_oracle 0.1674 (0.1538) acc 87.5000 (86.4583) kd_loss 0.8023 (0.8286) lr 4.6417e-04 eta 0:05:52
epoch [36/50] batch [80/181] time 0.103 (0.125) data 0.000 (0.024) loss 1.1626 (1.3122) ce_loss 0.2546 (0.3624) loss_zs_kd 0.1036 (0.0829) loss_oracle 0.1779 (0.1540) acc 90.6250 (86.9922) kd_loss 0.7673 (0.8314) lr 4.6417e-04 eta 0:05:29
epoch [36/50] batch [100/181] time 0.095 (0.120) data 0.000 (0.019) loss 1.5224 (1.3064) ce_loss 0.5107 (0.3546) loss_zs_kd 0.1084 (0.0840) loss_oracle 0.1355 (0.1547) acc 87.5000 (87.3750) kd_loss 0.8897 (0.8324) lr 4.6417e-04 eta 0:05:14
epoch [36/50] batch [120/181] time 0.101 (0.117) data 0.000 (0.016) loss 1.3253 (1.3081) ce_loss 0.3340 (0.3512) loss_zs_kd 0.1344 (0.0846) loss_oracle 0.1730 (0.1565) acc 87.5000 (87.3698) kd_loss 0.8376 (0.8364) lr 4.6417e-04 eta 0:05:04
epoch [36/50] batch [140/181] time 0.102 (0.115) data 0.000 (0.014) loss 1.1969 (1.3129) ce_loss 0.2313 (0.3515) loss_zs_kd 0.0917 (0.0864) loss_oracle 0.1460 (0.1570) acc 96.8750 (87.3884) kd_loss 0.8468 (0.8397) lr 4.6417e-04 eta 0:04:56
epoch [36/50] batch [160/181] time 0.106 (0.113) data 0.000 (0.012) loss 1.2631 (1.3079) ce_loss 0.3159 (0.3469) loss_zs_kd 0.0548 (0.0854) loss_oracle 0.1365 (0.1554) acc 84.3750 (87.5586) kd_loss 0.8515 (0.8406) lr 4.6417e-04 eta 0:04:49
epoch [36/50] batch [180/181] time 0.094 (0.111) data 0.000 (0.011) loss 1.3837 (1.3081) ce_loss 0.4871 (0.3489) loss_zs_kd 0.1108 (0.0845) loss_oracle 0.1332 (0.1539) acc 81.2500 (87.5000) kd_loss 0.7746 (0.8400) lr 4.6417e-04 eta 0:04:42
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,411
* accuracy: 96.6%
* error: 3.4%
* macro_f1: 97.0%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [37/50] batch [20/181] time 0.094 (0.198) data 0.000 (0.096) loss 1.2408 (1.3250) ce_loss 0.2424 (0.3561) loss_zs_kd 0.0639 (0.0865) loss_oracle 0.1777 (0.1583) acc 90.6250 (87.3438) kd_loss 0.8776 (0.8466) lr 4.1221e-04 eta 0:08:18
epoch [37/50] batch [40/181] time 0.099 (0.150) data 0.000 (0.048) loss 1.3428 (1.3517) ce_loss 0.3335 (0.3694) loss_zs_kd 0.0594 (0.0909) loss_oracle 0.1947 (0.1676) acc 87.5000 (86.8750) kd_loss 0.8822 (0.8530) lr 4.1221e-04 eta 0:06:12
epoch [37/50] batch [60/181] time 0.091 (0.132) data 0.001 (0.032) loss 1.3372 (1.3597) ce_loss 0.3242 (0.3803) loss_zs_kd 0.0817 (0.0888) loss_oracle 0.1824 (0.1763) acc 90.6250 (86.6146) kd_loss 0.8810 (0.8468) lr 4.1221e-04 eta 0:05:26
epoch [37/50] batch [80/181] time 0.096 (0.123) data 0.001 (0.024) loss 1.3148 (1.3483) ce_loss 0.3540 (0.3772) loss_zs_kd 0.0713 (0.0899) loss_oracle 0.2054 (0.1817) acc 81.2500 (86.4062) kd_loss 0.8225 (0.8354) lr 4.1221e-04 eta 0:05:01
epoch [37/50] batch [100/181] time 0.090 (0.116) data 0.000 (0.020) loss 1.4929 (1.3460) ce_loss 0.5166 (0.3788) loss_zs_kd 0.1620 (0.0908) loss_oracle 0.2104 (0.1863) acc 81.2500 (86.3438) kd_loss 0.7902 (0.8287) lr 4.1221e-04 eta 0:04:42
epoch [37/50] batch [120/181] time 0.089 (0.113) data 0.000 (0.016) loss 1.2713 (1.3413) ce_loss 0.2959 (0.3791) loss_zs_kd 0.0961 (0.0914) loss_oracle 0.1885 (0.1876) acc 87.5000 (86.2760) kd_loss 0.8332 (0.8226) lr 4.1221e-04 eta 0:04:32
epoch [37/50] batch [140/181] time 0.126 (0.113) data 0.000 (0.014) loss 1.5432 (1.3411) ce_loss 0.5513 (0.3778) loss_zs_kd 0.1016 (0.0904) loss_oracle 0.2027 (0.1922) acc 84.3750 (86.4286) kd_loss 0.8398 (0.8220) lr 4.1221e-04 eta 0:04:29
epoch [37/50] batch [160/181] time 0.072 (0.111) data 0.000 (0.012) loss 1.4734 (1.3395) ce_loss 0.4438 (0.3764) loss_zs_kd 0.0920 (0.0887) loss_oracle 0.1985 (0.1935) acc 84.3750 (86.4453) kd_loss 0.8843 (0.8220) lr 4.1221e-04 eta 0:04:23
epoch [37/50] batch [180/181] time 0.063 (0.110) data 0.000 (0.011) loss 1.4396 (1.3337) ce_loss 0.4883 (0.3742) loss_zs_kd 0.0867 (0.0884) loss_oracle 0.1619 (0.1922) acc 81.2500 (86.5278) kd_loss 0.8270 (0.8192) lr 4.1221e-04 eta 0:04:18
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,411
* accuracy: 96.6%
* error: 3.4%
* macro_f1: 97.0%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [38/50] batch [20/181] time 0.148 (0.216) data 0.000 (0.102) loss 1.2982 (1.2980) ce_loss 0.3845 (0.3633) loss_zs_kd 0.0549 (0.0767) loss_oracle 0.1956 (0.1937) acc 87.5000 (87.3438) kd_loss 0.7884 (0.7995) lr 3.6258e-04 eta 0:08:22
epoch [38/50] batch [40/181] time 0.083 (0.156) data 0.000 (0.051) loss 1.3429 (1.3061) ce_loss 0.4038 (0.3731) loss_zs_kd 0.0405 (0.0756) loss_oracle 0.2466 (0.1937) acc 84.3750 (86.7969) kd_loss 0.7955 (0.7984) lr 3.6258e-04 eta 0:06:00
epoch [38/50] batch [60/181] time 0.096 (0.134) data 0.000 (0.034) loss 1.1614 (1.3005) ce_loss 0.2551 (0.3644) loss_zs_kd 0.0688 (0.0769) loss_oracle 0.1490 (0.1887) acc 93.7500 (86.9792) kd_loss 0.7974 (0.8033) lr 3.6258e-04 eta 0:05:07
epoch [38/50] batch [80/181] time 0.105 (0.126) data 0.000 (0.026) loss 1.5281 (1.3089) ce_loss 0.4929 (0.3652) loss_zs_kd 0.1100 (0.0789) loss_oracle 0.1799 (0.1842) acc 81.2500 (87.0312) kd_loss 0.8903 (0.8121) lr 3.6258e-04 eta 0:04:46
epoch [38/50] batch [100/181] time 0.090 (0.122) data 0.000 (0.021) loss 1.7165 (1.3160) ce_loss 0.7349 (0.3722) loss_zs_kd 0.0996 (0.0810) loss_oracle 0.2061 (0.1815) acc 65.6250 (86.4062) kd_loss 0.8287 (0.8125) lr 3.6258e-04 eta 0:04:33
epoch [38/50] batch [120/181] time 0.104 (0.118) data 0.000 (0.017) loss 1.4557 (1.3166) ce_loss 0.4146 (0.3735) loss_zs_kd 0.0794 (0.0831) loss_oracle 0.1652 (0.1778) acc 84.3750 (86.4844) kd_loss 0.9189 (0.8126) lr 3.6258e-04 eta 0:04:23
epoch [38/50] batch [140/181] time 0.098 (0.115) data 0.000 (0.015) loss 1.1933 (1.3112) ce_loss 0.2603 (0.3697) loss_zs_kd 0.0423 (0.0825) loss_oracle 0.1554 (0.1754) acc 90.6250 (86.7634) kd_loss 0.8342 (0.8125) lr 3.6258e-04 eta 0:04:14
epoch [38/50] batch [160/181] time 0.107 (0.113) data 0.000 (0.013) loss 1.2118 (1.3169) ce_loss 0.3188 (0.3741) loss_zs_kd 0.0786 (0.0839) loss_oracle 0.1530 (0.1749) acc 90.6250 (86.5039) kd_loss 0.7772 (0.8133) lr 3.6258e-04 eta 0:04:07
epoch [38/50] batch [180/181] time 0.094 (0.111) data 0.000 (0.012) loss 1.0081 (1.3095) ce_loss 0.1847 (0.3681) loss_zs_kd 0.0471 (0.0829) loss_oracle 0.1889 (0.1750) acc 96.8750 (86.8056) kd_loss 0.7054 (0.8125) lr 3.6258e-04 eta 0:04:01
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,404
* accuracy: 96.3%
* error: 3.7%
* macro_f1: 96.8%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [39/50] batch [20/181] time 0.104 (0.213) data 0.000 (0.109) loss 1.3908 (1.2937) ce_loss 0.3479 (0.3004) loss_zs_kd 0.1133 (0.0785) loss_oracle 0.2270 (0.1967) acc 90.6250 (90.1562) kd_loss 0.8727 (0.8557) lr 3.1545e-04 eta 0:07:38
epoch [39/50] batch [40/181] time 0.098 (0.158) data 0.000 (0.055) loss 1.4168 (1.3126) ce_loss 0.3967 (0.3531) loss_zs_kd 0.1099 (0.0758) loss_oracle 0.2187 (0.1965) acc 84.3750 (88.2812) kd_loss 0.8558 (0.8233) lr 3.1545e-04 eta 0:05:36
epoch [39/50] batch [60/181] time 0.105 (0.139) data 0.000 (0.036) loss 1.4515 (1.3149) ce_loss 0.4414 (0.3619) loss_zs_kd 0.0904 (0.0785) loss_oracle 0.2188 (0.1953) acc 81.2500 (87.0833) kd_loss 0.8555 (0.8162) lr 3.1545e-04 eta 0:04:53
epoch [39/50] batch [80/181] time 0.085 (0.126) data 0.000 (0.027) loss 1.1957 (1.3287) ce_loss 0.2227 (0.3734) loss_zs_kd 0.0686 (0.0827) loss_oracle 0.1780 (0.1918) acc 93.7500 (86.3672) kd_loss 0.8498 (0.8180) lr 3.1545e-04 eta 0:04:24
epoch [39/50] batch [100/181] time 0.083 (0.118) data 0.000 (0.022) loss 1.4134 (1.3283) ce_loss 0.4341 (0.3717) loss_zs_kd 0.1040 (0.0843) loss_oracle 0.1579 (0.1897) acc 78.1250 (86.3125) kd_loss 0.8484 (0.8197) lr 3.1545e-04 eta 0:04:04
epoch [39/50] batch [120/181] time 0.084 (0.117) data 0.000 (0.018) loss 1.2267 (1.3262) ce_loss 0.2617 (0.3699) loss_zs_kd 0.0720 (0.0850) loss_oracle 0.1829 (0.1887) acc 93.7500 (86.5365) kd_loss 0.8375 (0.8194) lr 3.1545e-04 eta 0:04:00
epoch [39/50] batch [140/181] time 0.086 (0.115) data 0.000 (0.016) loss 1.5453 (1.3296) ce_loss 0.4854 (0.3720) loss_zs_kd 0.1023 (0.0857) loss_oracle 0.2125 (0.1896) acc 81.2500 (86.5402) kd_loss 0.9025 (0.8200) lr 3.1545e-04 eta 0:03:53
epoch [39/50] batch [160/181] time 0.176 (0.115) data 0.000 (0.014) loss 1.3345 (1.3293) ce_loss 0.3635 (0.3701) loss_zs_kd 0.1050 (0.0858) loss_oracle 0.1768 (0.1930) acc 84.3750 (86.7578) kd_loss 0.8301 (0.8198) lr 3.1545e-04 eta 0:03:51
epoch [39/50] batch [180/181] time 0.071 (0.111) data 0.000 (0.012) loss 1.2396 (1.3298) ce_loss 0.1373 (0.3680) loss_zs_kd 0.0339 (0.0854) loss_oracle 0.1854 (0.1941) acc 93.7500 (86.8056) kd_loss 0.9926 (0.8220) lr 3.1545e-04 eta 0:03:40
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,410
* accuracy: 96.5%
* error: 3.5%
* macro_f1: 97.0%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [40/50] batch [20/181] time 0.082 (0.221) data 0.000 (0.110) loss 1.1322 (1.3527) ce_loss 0.1395 (0.3798) loss_zs_kd 0.0732 (0.0808) loss_oracle 0.1769 (0.2119) acc 93.7500 (86.4062) kd_loss 0.8677 (0.8265) lr 2.7103e-04 eta 0:07:15
epoch [40/50] batch [40/181] time 0.086 (0.159) data 0.000 (0.055) loss 1.3505 (1.3543) ce_loss 0.3953 (0.3882) loss_zs_kd 0.0920 (0.0914) loss_oracle 0.1876 (0.1969) acc 81.2500 (85.7812) kd_loss 0.8155 (0.8219) lr 2.7103e-04 eta 0:05:10
epoch [40/50] batch [60/181] time 0.093 (0.138) data 0.000 (0.037) loss 1.1480 (1.3273) ce_loss 0.2566 (0.3688) loss_zs_kd 0.0598 (0.0866) loss_oracle 0.1380 (0.1921) acc 93.7500 (86.7188) kd_loss 0.7925 (0.8191) lr 2.7103e-04 eta 0:04:26
epoch [40/50] batch [80/181] time 0.098 (0.128) data 0.000 (0.028) loss 1.3861 (1.3322) ce_loss 0.4492 (0.3704) loss_zs_kd 0.0859 (0.0877) loss_oracle 0.1717 (0.1880) acc 84.3750 (86.8750) kd_loss 0.8081 (0.8240) lr 2.7103e-04 eta 0:04:05
epoch [40/50] batch [100/181] time 0.105 (0.123) data 0.000 (0.022) loss 1.5375 (1.3234) ce_loss 0.5537 (0.3617) loss_zs_kd 0.0678 (0.0872) loss_oracle 0.1858 (0.1846) acc 78.1250 (87.2500) kd_loss 0.8570 (0.8258) lr 2.7103e-04 eta 0:03:52
epoch [40/50] batch [120/181] time 0.096 (0.119) data 0.000 (0.019) loss 1.3603 (1.3178) ce_loss 0.3352 (0.3538) loss_zs_kd 0.1093 (0.0873) loss_oracle 0.1767 (0.1809) acc 93.7500 (87.4219) kd_loss 0.8821 (0.8300) lr 2.7103e-04 eta 0:03:41
epoch [40/50] batch [140/181] time 0.098 (0.116) data 0.000 (0.016) loss 1.4279 (1.3168) ce_loss 0.4895 (0.3536) loss_zs_kd 0.0709 (0.0875) loss_oracle 0.1868 (0.1785) acc 75.0000 (87.4330) kd_loss 0.8096 (0.8302) lr 2.7103e-04 eta 0:03:34
epoch [40/50] batch [160/181] time 0.108 (0.114) data 0.000 (0.014) loss 1.4982 (1.3144) ce_loss 0.5786 (0.3550) loss_zs_kd 0.0986 (0.0867) loss_oracle 0.1943 (0.1770) acc 81.2500 (87.3242) kd_loss 0.7731 (0.8275) lr 2.7103e-04 eta 0:03:28
epoch [40/50] batch [180/181] time 0.093 (0.112) data 0.000 (0.012) loss 1.2743 (1.3192) ce_loss 0.3796 (0.3588) loss_zs_kd 0.0659 (0.0867) loss_oracle 0.2083 (0.1772) acc 87.5000 (87.1181) kd_loss 0.7576 (0.8284) lr 2.7103e-04 eta 0:03:23
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,410
* accuracy: 96.5%
* error: 3.5%
* macro_f1: 97.0%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [41/50] batch [20/181] time 0.114 (0.221) data 0.001 (0.116) loss 1.4220 (1.2956) ce_loss 0.5415 (0.3705) loss_zs_kd 0.0921 (0.0819) loss_oracle 0.1518 (0.1669) acc 78.1250 (86.0938) kd_loss 0.7586 (0.8007) lr 2.2949e-04 eta 0:06:35
epoch [41/50] batch [40/181] time 0.100 (0.161) data 0.000 (0.058) loss 1.3151 (1.2935) ce_loss 0.3738 (0.3573) loss_zs_kd 0.0792 (0.0832) loss_oracle 0.1835 (0.1648) acc 84.3750 (86.4844) kd_loss 0.8099 (0.8122) lr 2.2949e-04 eta 0:04:44
epoch [41/50] batch [60/181] time 0.085 (0.137) data 0.000 (0.039) loss 1.2607 (1.2915) ce_loss 0.3159 (0.3472) loss_zs_kd 0.1964 (0.0867) loss_oracle 0.1573 (0.1669) acc 96.8750 (87.2396) kd_loss 0.7679 (0.8176) lr 2.2949e-04 eta 0:04:00
epoch [41/50] batch [80/181] time 0.082 (0.125) data 0.000 (0.029) loss 1.2071 (1.2855) ce_loss 0.2500 (0.3427) loss_zs_kd 0.0810 (0.0850) loss_oracle 0.1793 (0.1698) acc 96.8750 (87.4219) kd_loss 0.8269 (0.8154) lr 2.2949e-04 eta 0:03:36
epoch [41/50] batch [100/181] time 0.074 (0.123) data 0.000 (0.023) loss 1.4360 (1.2969) ce_loss 0.4587 (0.3518) loss_zs_kd 0.0859 (0.0855) loss_oracle 0.1773 (0.1677) acc 84.3750 (86.9375) kd_loss 0.8457 (0.8185) lr 2.2949e-04 eta 0:03:30
epoch [41/50] batch [120/181] time 0.074 (0.122) data 0.000 (0.020) loss 1.4560 (1.3053) ce_loss 0.4409 (0.3560) loss_zs_kd 0.0731 (0.0848) loss_oracle 0.2082 (0.1671) acc 93.7500 (86.8229) kd_loss 0.8745 (0.8234) lr 2.2949e-04 eta 0:03:25
epoch [41/50] batch [140/181] time 0.074 (0.119) data 0.000 (0.017) loss 1.3060 (1.3106) ce_loss 0.2891 (0.3583) loss_zs_kd 0.1054 (0.0847) loss_oracle 0.1439 (0.1648) acc 87.5000 (86.6964) kd_loss 0.8923 (0.8276) lr 2.2949e-04 eta 0:03:19
epoch [41/50] batch [160/181] time 0.079 (0.115) data 0.000 (0.015) loss 1.4919 (1.3191) ce_loss 0.4399 (0.3614) loss_zs_kd 0.1154 (0.0858) loss_oracle 0.1558 (0.1638) acc 81.2500 (86.6211) kd_loss 0.9164 (0.8329) lr 2.2949e-04 eta 0:03:09
epoch [41/50] batch [180/181] time 0.073 (0.112) data 0.000 (0.013) loss 1.3315 (1.3227) ce_loss 0.4170 (0.3610) loss_zs_kd 0.0682 (0.0869) loss_oracle 0.1628 (0.1638) acc 87.5000 (86.7188) kd_loss 0.7990 (0.8364) lr 2.2949e-04 eta 0:03:03
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,412
* accuracy: 96.6%
* error: 3.4%
* macro_f1: 97.0%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [42/50] batch [20/181] time 0.106 (0.212) data 0.000 (0.122) loss 1.1026 (1.3432) ce_loss 0.0656 (0.3235) loss_zs_kd 0.0484 (0.0830) loss_oracle 0.1918 (0.1672) acc 100.0000 (88.4375) kd_loss 0.9170 (0.8946) lr 1.9098e-04 eta 0:05:41
epoch [42/50] batch [40/181] time 0.104 (0.156) data 0.000 (0.061) loss 1.2480 (1.3455) ce_loss 0.2228 (0.3460) loss_zs_kd 0.0844 (0.0834) loss_oracle 0.1662 (0.1701) acc 93.7500 (87.4219) kd_loss 0.8999 (0.8728) lr 1.9098e-04 eta 0:04:08
epoch [42/50] batch [60/181] time 0.100 (0.137) data 0.000 (0.041) loss 1.6882 (1.3717) ce_loss 0.6743 (0.3706) loss_zs_kd 0.0955 (0.0819) loss_oracle 0.2032 (0.1676) acc 75.0000 (86.4583) kd_loss 0.8645 (0.8764) lr 1.9098e-04 eta 0:03:35
epoch [42/50] batch [80/181] time 0.094 (0.128) data 0.000 (0.031) loss 1.2691 (1.3529) ce_loss 0.3289 (0.3577) loss_zs_kd 0.0831 (0.0827) loss_oracle 0.1536 (0.1666) acc 90.6250 (86.9922) kd_loss 0.8219 (0.8706) lr 1.9098e-04 eta 0:03:18
epoch [42/50] batch [100/181] time 0.098 (0.123) data 0.000 (0.025) loss 1.2678 (1.3498) ce_loss 0.2998 (0.3585) loss_zs_kd 0.0658 (0.0833) loss_oracle 0.1813 (0.1663) acc 87.5000 (87.0625) kd_loss 0.8444 (0.8664) lr 1.9098e-04 eta 0:03:08
epoch [42/50] batch [120/181] time 0.098 (0.120) data 0.000 (0.021) loss 1.4519 (1.3432) ce_loss 0.3989 (0.3533) loss_zs_kd 0.0991 (0.0832) loss_oracle 0.1651 (0.1664) acc 87.5000 (87.4219) kd_loss 0.9209 (0.8651) lr 1.9098e-04 eta 0:03:00
epoch [42/50] batch [140/181] time 0.110 (0.117) data 0.000 (0.018) loss 1.3572 (1.3501) ce_loss 0.3054 (0.3593) loss_zs_kd 0.0830 (0.0836) loss_oracle 0.1858 (0.1660) acc 87.5000 (87.1652) kd_loss 0.9174 (0.8660) lr 1.9098e-04 eta 0:02:54
epoch [42/50] batch [160/181] time 0.104 (0.115) data 0.000 (0.016) loss 1.3790 (1.3493) ce_loss 0.3916 (0.3580) loss_zs_kd 0.0841 (0.0836) loss_oracle 0.1913 (0.1675) acc 84.3750 (87.0898) kd_loss 0.8497 (0.8658) lr 1.9098e-04 eta 0:02:49
epoch [42/50] batch [180/181] time 0.095 (0.113) data 0.000 (0.014) loss 1.4822 (1.3527) ce_loss 0.3794 (0.3582) loss_zs_kd 0.0534 (0.0841) loss_oracle 0.1929 (0.1686) acc 81.2500 (86.9792) kd_loss 0.9796 (0.8682) lr 1.9098e-04 eta 0:02:44
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,413
* accuracy: 96.6%
* error: 3.4%
* macro_f1: 97.1%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [43/50] batch [20/181] time 0.089 (0.206) data 0.000 (0.109) loss 1.4818 (1.3883) ce_loss 0.3848 (0.3416) loss_zs_kd 0.1065 (0.0852) loss_oracle 0.1646 (0.1719) acc 84.3750 (87.5000) kd_loss 0.9615 (0.9182) lr 1.5567e-04 eta 0:04:53
epoch [43/50] batch [40/181] time 0.091 (0.147) data 0.000 (0.055) loss 1.4683 (1.3645) ce_loss 0.3972 (0.3417) loss_zs_kd 0.0955 (0.0823) loss_oracle 0.2103 (0.1733) acc 90.6250 (87.5781) kd_loss 0.9182 (0.8950) lr 1.5567e-04 eta 0:03:26
epoch [43/50] batch [60/181] time 0.096 (0.128) data 0.000 (0.037) loss 1.4181 (1.3691) ce_loss 0.4570 (0.3486) loss_zs_kd 0.1023 (0.0853) loss_oracle 0.1883 (0.1761) acc 84.3750 (87.1354) kd_loss 0.8158 (0.8899) lr 1.5567e-04 eta 0:02:57
epoch [43/50] batch [80/181] time 0.172 (0.123) data 0.000 (0.028) loss 1.2805 (1.3531) ce_loss 0.2340 (0.3387) loss_zs_kd 0.0839 (0.0865) loss_oracle 0.1740 (0.1758) acc 96.8750 (87.7734) kd_loss 0.9176 (0.8832) lr 1.5567e-04 eta 0:02:48
epoch [43/50] batch [100/181] time 0.131 (0.121) data 0.000 (0.022) loss 1.2342 (1.3582) ce_loss 0.2585 (0.3446) loss_zs_kd 0.0850 (0.0862) loss_oracle 0.1634 (0.1749) acc 93.7500 (87.4688) kd_loss 0.8515 (0.8830) lr 1.5567e-04 eta 0:02:43
epoch [43/50] batch [120/181] time 0.179 (0.117) data 0.000 (0.018) loss 1.1253 (1.3626) ce_loss 0.2556 (0.3520) loss_zs_kd 0.0856 (0.0853) loss_oracle 0.1781 (0.1756) acc 90.6250 (87.1354) kd_loss 0.7378 (0.8801) lr 1.5567e-04 eta 0:02:35
epoch [43/50] batch [140/181] time 0.088 (0.112) data 0.001 (0.016) loss 1.1942 (1.3632) ce_loss 0.2186 (0.3512) loss_zs_kd 0.0900 (0.0871) loss_oracle 0.1764 (0.1773) acc 90.6250 (87.0759) kd_loss 0.8424 (0.8798) lr 1.5567e-04 eta 0:02:26
epoch [43/50] batch [160/181] time 0.087 (0.110) data 0.000 (0.014) loss 1.2956 (1.3685) ce_loss 0.3315 (0.3561) loss_zs_kd 0.0933 (0.0882) loss_oracle 0.1873 (0.1780) acc 87.5000 (86.9922) kd_loss 0.8237 (0.8793) lr 1.5567e-04 eta 0:02:22
epoch [43/50] batch [180/181] time 0.072 (0.110) data 0.000 (0.012) loss 1.3215 (1.3697) ce_loss 0.2566 (0.3579) loss_zs_kd 0.0881 (0.0878) loss_oracle 0.2189 (0.1771) acc 87.5000 (86.8576) kd_loss 0.9114 (0.8793) lr 1.5567e-04 eta 0:02:19
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,408
* accuracy: 96.4%
* error: 3.6%
* macro_f1: 96.9%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [44/50] batch [20/181] time 0.108 (0.219) data 0.000 (0.115) loss 1.4229 (1.3475) ce_loss 0.4036 (0.3424) loss_zs_kd 0.1177 (0.0913) loss_oracle 0.2002 (0.1647) acc 87.5000 (87.8125) kd_loss 0.8603 (0.8771) lr 1.2369e-04 eta 0:04:32
epoch [44/50] batch [40/181] time 0.105 (0.160) data 0.000 (0.058) loss 1.3492 (1.3739) ce_loss 0.3020 (0.3542) loss_zs_kd 0.0863 (0.0930) loss_oracle 0.1654 (0.1710) acc 90.6250 (87.0312) kd_loss 0.9214 (0.8877) lr 1.2369e-04 eta 0:03:15
epoch [44/50] batch [60/181] time 0.099 (0.140) data 0.000 (0.038) loss 1.3415 (1.3741) ce_loss 0.3357 (0.3535) loss_zs_kd 0.0811 (0.0900) loss_oracle 0.1941 (0.1747) acc 90.6250 (86.8229) kd_loss 0.8682 (0.8882) lr 1.2369e-04 eta 0:02:49
epoch [44/50] batch [80/181] time 0.096 (0.129) data 0.000 (0.029) loss 1.5685 (1.3723) ce_loss 0.5176 (0.3483) loss_zs_kd 0.1225 (0.0896) loss_oracle 0.1540 (0.1750) acc 78.1250 (86.9922) kd_loss 0.9127 (0.8916) lr 1.2369e-04 eta 0:02:33
epoch [44/50] batch [100/181] time 0.100 (0.123) data 0.000 (0.023) loss 1.1595 (1.3721) ce_loss 0.1904 (0.3508) loss_zs_kd 0.0804 (0.0896) loss_oracle 0.1626 (0.1746) acc 87.5000 (86.9375) kd_loss 0.8476 (0.8891) lr 1.2369e-04 eta 0:02:23
epoch [44/50] batch [120/181] time 0.095 (0.118) data 0.000 (0.019) loss 1.6729 (1.3757) ce_loss 0.6016 (0.3571) loss_zs_kd 0.0843 (0.0878) loss_oracle 0.1861 (0.1744) acc 78.1250 (86.6667) kd_loss 0.9361 (0.8874) lr 1.2369e-04 eta 0:02:15
epoch [44/50] batch [140/181] time 0.107 (0.116) data 0.000 (0.017) loss 1.3753 (1.3817) ce_loss 0.3276 (0.3620) loss_zs_kd 0.0717 (0.0880) loss_oracle 0.2006 (0.1752) acc 90.6250 (86.5179) kd_loss 0.9115 (0.8881) lr 1.2369e-04 eta 0:02:10
epoch [44/50] batch [160/181] time 0.097 (0.114) data 0.001 (0.015) loss 1.6743 (1.3850) ce_loss 0.5488 (0.3638) loss_zs_kd 0.1682 (0.0887) loss_oracle 0.1368 (0.1765) acc 78.1250 (86.5820) kd_loss 0.9729 (0.8886) lr 1.2369e-04 eta 0:02:06
epoch [44/50] batch [180/181] time 0.089 (0.111) data 0.000 (0.013) loss 1.3294 (1.3794) ce_loss 0.2396 (0.3555) loss_zs_kd 0.0919 (0.0882) loss_oracle 0.1907 (0.1769) acc 96.8750 (86.8924) kd_loss 0.9485 (0.8914) lr 1.2369e-04 eta 0:02:01
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,411
* accuracy: 96.6%
* error: 3.4%
* macro_f1: 97.0%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [45/50] batch [20/181] time 0.101 (0.223) data 0.000 (0.126) loss 1.2356 (1.3993) ce_loss 0.1742 (0.3431) loss_zs_kd 0.0753 (0.0892) loss_oracle 0.2194 (0.1861) acc 93.7500 (87.9688) kd_loss 0.9141 (0.9185) lr 9.5173e-05 eta 0:03:57
epoch [45/50] batch [40/181] time 0.083 (0.155) data 0.001 (0.063) loss 1.3206 (1.3787) ce_loss 0.3391 (0.3292) loss_zs_kd 0.1301 (0.0928) loss_oracle 0.1963 (0.1817) acc 87.5000 (88.8281) kd_loss 0.8183 (0.9122) lr 9.5173e-05 eta 0:02:41
epoch [45/50] batch [60/181] time 0.095 (0.136) data 0.000 (0.042) loss 1.4991 (1.4003) ce_loss 0.4553 (0.3488) loss_zs_kd 0.1551 (0.0935) loss_oracle 0.1870 (0.1805) acc 81.2500 (88.1250) kd_loss 0.8728 (0.9146) lr 9.5173e-05 eta 0:02:20
epoch [45/50] batch [80/181] time 0.156 (0.130) data 0.000 (0.032) loss 1.3612 (1.3957) ce_loss 0.3062 (0.3436) loss_zs_kd 0.0893 (0.0895) loss_oracle 0.1911 (0.1815) acc 87.5000 (88.0859) kd_loss 0.9148 (0.9166) lr 9.5173e-05 eta 0:02:10
epoch [45/50] batch [100/181] time 0.158 (0.126) data 0.000 (0.025) loss 1.4232 (1.3979) ce_loss 0.3550 (0.3464) loss_zs_kd 0.0712 (0.0886) loss_oracle 0.2405 (0.1803) acc 87.5000 (87.8438) kd_loss 0.9123 (0.9170) lr 9.5173e-05 eta 0:02:04
epoch [45/50] batch [120/181] time 0.077 (0.120) data 0.000 (0.021) loss 1.3166 (1.3975) ce_loss 0.2815 (0.3455) loss_zs_kd 0.0806 (0.0882) loss_oracle 0.2134 (0.1785) acc 90.6250 (87.8906) kd_loss 0.8881 (0.9187) lr 9.5173e-05 eta 0:01:55
epoch [45/50] batch [140/181] time 0.073 (0.115) data 0.000 (0.018) loss 1.4004 (1.4033) ce_loss 0.3149 (0.3524) loss_zs_kd 0.1161 (0.0896) loss_oracle 0.1701 (0.1781) acc 90.6250 (87.5000) kd_loss 0.9423 (0.9170) lr 9.5173e-05 eta 0:01:48
epoch [45/50] batch [160/181] time 0.083 (0.112) data 0.000 (0.016) loss 1.4669 (1.4039) ce_loss 0.4062 (0.3516) loss_zs_kd 0.1050 (0.0895) loss_oracle 0.1757 (0.1773) acc 81.2500 (87.4414) kd_loss 0.9203 (0.9189) lr 9.5173e-05 eta 0:01:44
epoch [45/50] batch [180/181] time 0.070 (0.112) data 0.000 (0.014) loss 1.3343 (1.4106) ce_loss 0.2976 (0.3584) loss_zs_kd 0.0777 (0.0899) loss_oracle 0.1815 (0.1766) acc 87.5000 (87.0833) kd_loss 0.9072 (0.9190) lr 9.5173e-05 eta 0:01:41
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,412
* accuracy: 96.6%
* error: 3.4%
* macro_f1: 97.1%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [46/50] batch [20/181] time 0.098 (0.224) data 0.000 (0.120) loss 1.2952 (1.3643) ce_loss 0.2695 (0.3065) loss_zs_kd 0.0810 (0.0785) loss_oracle 0.1861 (0.1646) acc 87.5000 (89.2188) kd_loss 0.8922 (0.9363) lr 7.0224e-05 eta 0:03:18
epoch [46/50] batch [40/181] time 0.101 (0.159) data 0.000 (0.060) loss 1.4411 (1.3774) ce_loss 0.4299 (0.3378) loss_zs_kd 0.0697 (0.0840) loss_oracle 0.1753 (0.1653) acc 84.3750 (87.3438) kd_loss 0.8886 (0.9149) lr 7.0224e-05 eta 0:02:17
epoch [46/50] batch [60/181] time 0.088 (0.137) data 0.000 (0.040) loss 1.3170 (1.3847) ce_loss 0.3105 (0.3496) loss_zs_kd 0.0586 (0.0848) loss_oracle 0.1701 (0.1661) acc 84.3750 (86.7708) kd_loss 0.8921 (0.9097) lr 7.0224e-05 eta 0:01:55
epoch [46/50] batch [80/181] time 0.088 (0.126) data 0.000 (0.030) loss 1.3459 (1.3889) ce_loss 0.3184 (0.3539) loss_zs_kd 0.1096 (0.0864) loss_oracle 0.2026 (0.1681) acc 90.6250 (86.6016) kd_loss 0.8715 (0.9078) lr 7.0224e-05 eta 0:01:44
epoch [46/50] batch [100/181] time 0.082 (0.119) data 0.000 (0.024) loss 1.2639 (1.3800) ce_loss 0.2688 (0.3443) loss_zs_kd 0.0573 (0.0864) loss_oracle 0.2040 (0.1692) acc 90.6250 (87.2188) kd_loss 0.8644 (0.9079) lr 7.0224e-05 eta 0:01:35
epoch [46/50] batch [120/181] time 0.105 (0.112) data 0.000 (0.020) loss 1.4568 (1.3888) ce_loss 0.4607 (0.3504) loss_zs_kd 0.0717 (0.0878) loss_oracle 0.1946 (0.1708) acc 87.5000 (86.9010) kd_loss 0.8630 (0.9091) lr 7.0224e-05 eta 0:01:27
epoch [46/50] batch [140/181] time 0.098 (0.110) data 0.000 (0.017) loss 1.3235 (1.3880) ce_loss 0.2939 (0.3473) loss_zs_kd 0.0882 (0.0889) loss_oracle 0.1452 (0.1715) acc 90.6250 (87.1429) kd_loss 0.9129 (0.9104) lr 7.0224e-05 eta 0:01:23
epoch [46/50] batch [160/181] time 0.104 (0.109) data 0.000 (0.015) loss 1.3908 (1.3882) ce_loss 0.3875 (0.3469) loss_zs_kd 0.1148 (0.0904) loss_oracle 0.1537 (0.1715) acc 84.3750 (87.2852) kd_loss 0.8691 (0.9104) lr 7.0224e-05 eta 0:01:20
epoch [46/50] batch [180/181] time 0.090 (0.107) data 0.000 (0.014) loss 1.2948 (1.3855) ce_loss 0.2891 (0.3453) loss_zs_kd 0.0779 (0.0896) loss_oracle 0.2018 (0.1733) acc 90.6250 (87.3611) kd_loss 0.8659 (0.9088) lr 7.0224e-05 eta 0:01:17
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,412
* accuracy: 96.6%
* error: 3.4%
* macro_f1: 97.0%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [47/50] batch [20/181] time 0.092 (0.216) data 0.000 (0.120) loss 1.5064 (1.4350) ce_loss 0.4006 (0.3947) loss_zs_kd 0.0653 (0.0867) loss_oracle 0.1646 (0.1812) acc 81.2500 (84.5312) kd_loss 0.9908 (0.9064) lr 4.8943e-05 eta 0:02:32
epoch [47/50] batch [40/181] time 0.087 (0.148) data 0.000 (0.060) loss 1.5835 (1.4104) ce_loss 0.4641 (0.3729) loss_zs_kd 0.1111 (0.0855) loss_oracle 0.1670 (0.1801) acc 84.3750 (85.6250) kd_loss 0.9804 (0.9047) lr 4.8943e-05 eta 0:01:41
epoch [47/50] batch [60/181] time 0.154 (0.128) data 0.000 (0.040) loss 1.3363 (1.4051) ce_loss 0.3494 (0.3677) loss_zs_kd 0.0624 (0.0843) loss_oracle 0.1593 (0.1835) acc 87.5000 (86.4583) kd_loss 0.8760 (0.9035) lr 4.8943e-05 eta 0:01:24
epoch [47/50] batch [80/181] time 0.074 (0.124) data 0.000 (0.030) loss 1.2595 (1.3901) ce_loss 0.1925 (0.3518) loss_zs_kd 0.0613 (0.0840) loss_oracle 0.1775 (0.1799) acc 96.8750 (87.1875) kd_loss 0.9476 (0.9063) lr 4.8943e-05 eta 0:01:19
epoch [47/50] batch [100/181] time 0.167 (0.121) data 0.000 (0.024) loss 1.4866 (1.3993) ce_loss 0.3726 (0.3567) loss_zs_kd 0.0681 (0.0840) loss_oracle 0.2233 (0.1815) acc 87.5000 (87.0625) kd_loss 0.9684 (0.9099) lr 4.8943e-05 eta 0:01:15
epoch [47/50] batch [120/181] time 0.085 (0.119) data 0.000 (0.020) loss 1.3441 (1.4061) ce_loss 0.2788 (0.3584) loss_zs_kd 0.1282 (0.0859) loss_oracle 0.1991 (0.1840) acc 96.8750 (87.0573) kd_loss 0.9017 (0.9127) lr 4.8943e-05 eta 0:01:11
epoch [47/50] batch [140/181] time 0.079 (0.114) data 0.000 (0.017) loss 1.3225 (1.4016) ce_loss 0.2086 (0.3527) loss_zs_kd 0.0655 (0.0860) loss_oracle 0.1728 (0.1831) acc 90.6250 (87.3438) kd_loss 0.9947 (0.9144) lr 4.8943e-05 eta 0:01:06
epoch [47/50] batch [160/181] time 0.092 (0.112) data 0.000 (0.015) loss 1.2187 (1.4040) ce_loss 0.1307 (0.3551) loss_zs_kd 0.0372 (0.0859) loss_oracle 0.2084 (0.1832) acc 100.0000 (87.2266) kd_loss 0.9652 (0.9143) lr 4.8943e-05 eta 0:01:02
epoch [47/50] batch [180/181] time 0.086 (0.111) data 0.000 (0.014) loss 1.1786 (1.3962) ce_loss 0.1633 (0.3486) loss_zs_kd 0.0633 (0.0856) loss_oracle 0.1347 (0.1815) acc 93.7500 (87.4653) kd_loss 0.9162 (0.9141) lr 4.8943e-05 eta 0:01:00
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,413
* accuracy: 96.6%
* error: 3.4%
* macro_f1: 97.1%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [48/50] batch [20/181] time 0.097 (0.222) data 0.000 (0.125) loss 1.1553 (1.3850) ce_loss 0.1366 (0.3430) loss_zs_kd 0.0592 (0.0959) loss_oracle 0.2217 (0.1870) acc 96.8750 (88.2812) kd_loss 0.8783 (0.9006) lr 3.1417e-05 eta 0:01:55
epoch [48/50] batch [40/181] time 0.103 (0.160) data 0.000 (0.063) loss 1.5193 (1.3881) ce_loss 0.4885 (0.3461) loss_zs_kd 0.0912 (0.0894) loss_oracle 0.2263 (0.1827) acc 84.3750 (87.8906) kd_loss 0.8720 (0.9060) lr 3.1417e-05 eta 0:01:20
epoch [48/50] batch [60/181] time 0.095 (0.139) data 0.000 (0.042) loss 1.3540 (1.3876) ce_loss 0.3494 (0.3517) loss_zs_kd 0.1522 (0.0896) loss_oracle 0.1643 (0.1788) acc 81.2500 (87.6562) kd_loss 0.8464 (0.9017) lr 3.1417e-05 eta 0:01:07
epoch [48/50] batch [80/181] time 0.097 (0.130) data 0.000 (0.031) loss 1.4121 (1.3917) ce_loss 0.3918 (0.3596) loss_zs_kd 0.1034 (0.0882) loss_oracle 0.1802 (0.1808) acc 81.2500 (87.2656) kd_loss 0.8785 (0.8976) lr 3.1417e-05 eta 0:01:00
epoch [48/50] batch [100/181] time 0.100 (0.123) data 0.000 (0.025) loss 1.1417 (1.3924) ce_loss 0.1265 (0.3561) loss_zs_kd 0.0548 (0.0877) loss_oracle 0.1726 (0.1799) acc 96.8750 (87.2812) kd_loss 0.9016 (0.9025) lr 3.1417e-05 eta 0:00:54
epoch [48/50] batch [120/181] time 0.099 (0.119) data 0.000 (0.021) loss 1.3873 (1.3897) ce_loss 0.4116 (0.3551) loss_zs_kd 0.0672 (0.0878) loss_oracle 0.1617 (0.1793) acc 84.3750 (87.2917) kd_loss 0.8613 (0.9010) lr 3.1417e-05 eta 0:00:50
epoch [48/50] batch [140/181] time 0.098 (0.117) data 0.000 (0.018) loss 1.5547 (1.3903) ce_loss 0.4795 (0.3545) loss_zs_kd 0.0672 (0.0886) loss_oracle 0.1960 (0.1804) acc 81.2500 (87.3214) kd_loss 0.9436 (0.9013) lr 3.1417e-05 eta 0:00:47
epoch [48/50] batch [160/181] time 0.102 (0.115) data 0.000 (0.016) loss 1.5633 (1.3940) ce_loss 0.4873 (0.3566) loss_zs_kd 0.0667 (0.0897) loss_oracle 0.1623 (0.1806) acc 81.2500 (87.1484) kd_loss 0.9614 (0.9022) lr 3.1417e-05 eta 0:00:44
epoch [48/50] batch [180/181] time 0.090 (0.113) data 0.000 (0.014) loss 1.4944 (1.3937) ce_loss 0.4524 (0.3566) loss_zs_kd 0.0809 (0.0891) loss_oracle 0.1655 (0.1801) acc 84.3750 (87.2396) kd_loss 0.9188 (0.9026) lr 3.1417e-05 eta 0:00:41
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,413
* accuracy: 96.6%
* error: 3.4%
* macro_f1: 97.1%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [49/50] batch [20/181] time 0.064 (0.196) data 0.000 (0.122) loss 1.3885 (1.3711) ce_loss 0.3379 (0.3275) loss_zs_kd 0.0717 (0.0769) loss_oracle 0.1664 (0.1773) acc 90.6250 (87.6562) kd_loss 0.9315 (0.9165) lr 1.7713e-05 eta 0:01:07
epoch [49/50] batch [40/181] time 0.084 (0.141) data 0.000 (0.061) loss 1.5874 (1.3867) ce_loss 0.4868 (0.3349) loss_zs_kd 0.0893 (0.0857) loss_oracle 0.1525 (0.1739) acc 78.1250 (87.1875) kd_loss 0.9797 (0.9221) lr 1.7713e-05 eta 0:00:45
epoch [49/50] batch [60/181] time 0.070 (0.131) data 0.000 (0.041) loss 1.6423 (1.4057) ce_loss 0.4941 (0.3533) loss_zs_kd 0.1190 (0.0872) loss_oracle 0.1910 (0.1790) acc 81.2500 (86.7188) kd_loss 0.9931 (0.9193) lr 1.7713e-05 eta 0:00:39
epoch [49/50] batch [80/181] time 0.143 (0.127) data 0.000 (0.031) loss 1.3653 (1.4044) ce_loss 0.2917 (0.3529) loss_zs_kd 0.0911 (0.0883) loss_oracle 0.1698 (0.1770) acc 87.5000 (86.8750) kd_loss 0.9432 (0.9189) lr 1.7713e-05 eta 0:00:35
epoch [49/50] batch [100/181] time 0.087 (0.122) data 0.000 (0.025) loss 1.5693 (1.4133) ce_loss 0.5190 (0.3639) loss_zs_kd 0.1332 (0.0902) loss_oracle 0.1452 (0.1786) acc 78.1250 (86.5000) kd_loss 0.9111 (0.9151) lr 1.7713e-05 eta 0:00:31
epoch [49/50] batch [120/181] time 0.085 (0.115) data 0.000 (0.021) loss 1.3614 (1.4064) ce_loss 0.2729 (0.3602) loss_zs_kd 0.0612 (0.0878) loss_oracle 0.1716 (0.1803) acc 90.6250 (86.9792) kd_loss 0.9720 (0.9120) lr 1.7713e-05 eta 0:00:27
epoch [49/50] batch [140/181] time 0.163 (0.113) data 0.000 (0.018) loss 1.6296 (1.4052) ce_loss 0.5557 (0.3587) loss_zs_kd 0.0610 (0.0886) loss_oracle 0.1793 (0.1801) acc 71.8750 (87.0536) kd_loss 0.9538 (0.9121) lr 1.7713e-05 eta 0:00:25
epoch [49/50] batch [160/181] time 0.136 (0.112) data 0.000 (0.015) loss 1.6511 (1.4087) ce_loss 0.5352 (0.3614) loss_zs_kd 0.0934 (0.0881) loss_oracle 0.1920 (0.1794) acc 78.1250 (86.7773) kd_loss 0.9733 (0.9136) lr 1.7713e-05 eta 0:00:22
epoch [49/50] batch [180/181] time 0.067 (0.111) data 0.000 (0.014) loss 1.3415 (1.4033) ce_loss 0.3450 (0.3561) loss_zs_kd 0.0737 (0.0887) loss_oracle 0.1717 (0.1795) acc 90.6250 (87.1007) kd_loss 0.8739 (0.9131) lr 1.7713e-05 eta 0:00:20
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,412
* accuracy: 96.6%
* error: 3.4%
* macro_f1: 97.1%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [50/50] batch [20/181] time 0.094 (0.251) data 0.000 (0.151) loss 1.5631 (1.3991) ce_loss 0.4800 (0.3279) loss_zs_kd 0.1377 (0.0868) loss_oracle 0.1979 (0.1728) acc 84.3750 (87.9688) kd_loss 0.9153 (0.9413) lr 7.8853e-06 eta 0:00:40
epoch [50/50] batch [40/181] time 0.087 (0.176) data 0.000 (0.076) loss 1.5241 (1.4053) ce_loss 0.5093 (0.3430) loss_zs_kd 0.1267 (0.0852) loss_oracle 0.1782 (0.1732) acc 81.2500 (87.6562) kd_loss 0.8624 (0.9331) lr 7.8853e-06 eta 0:00:24
epoch [50/50] batch [60/181] time 0.106 (0.151) data 0.000 (0.051) loss 1.4088 (1.4010) ce_loss 0.4802 (0.3470) loss_zs_kd 0.0619 (0.0864) loss_oracle 0.1926 (0.1755) acc 84.3750 (87.7083) kd_loss 0.8014 (0.9231) lr 7.8853e-06 eta 0:00:18
epoch [50/50] batch [80/181] time 0.101 (0.138) data 0.000 (0.038) loss 1.4604 (1.4097) ce_loss 0.3630 (0.3574) loss_zs_kd 0.0891 (0.0877) loss_oracle 0.2061 (0.1764) acc 87.5000 (87.3828) kd_loss 0.9497 (0.9202) lr 7.8853e-06 eta 0:00:13
epoch [50/50] batch [100/181] time 0.095 (0.130) data 0.000 (0.030) loss 1.4399 (1.4182) ce_loss 0.3242 (0.3630) loss_zs_kd 0.1033 (0.0878) loss_oracle 0.1554 (0.1771) acc 90.6250 (87.1562) kd_loss 0.9864 (0.9228) lr 7.8853e-06 eta 0:00:10
epoch [50/50] batch [120/181] time 0.100 (0.125) data 0.000 (0.025) loss 1.2184 (1.4162) ce_loss 0.1123 (0.3604) loss_zs_kd 0.0705 (0.0884) loss_oracle 0.1645 (0.1767) acc 100.0000 (87.5000) kd_loss 0.9886 (0.9233) lr 7.8853e-06 eta 0:00:07
epoch [50/50] batch [140/181] time 0.102 (0.122) data 0.000 (0.022) loss 1.2796 (1.4144) ce_loss 0.2006 (0.3581) loss_zs_kd 0.0766 (0.0879) loss_oracle 0.1645 (0.1762) acc 93.7500 (87.7232) kd_loss 0.9585 (0.9243) lr 7.8853e-06 eta 0:00:04
epoch [50/50] batch [160/181] time 0.092 (0.119) data 0.000 (0.019) loss 1.3742 (1.4102) ce_loss 0.3330 (0.3555) loss_zs_kd 0.0891 (0.0868) loss_oracle 0.1653 (0.1772) acc 87.5000 (87.5781) kd_loss 0.9140 (0.9228) lr 7.8853e-06 eta 0:00:02
epoch [50/50] batch [180/181] time 0.091 (0.116) data 0.000 (0.017) loss 1.6027 (1.4081) ce_loss 0.4854 (0.3535) loss_zs_kd 0.0809 (0.0863) loss_oracle 0.2126 (0.1773) acc 78.1250 (87.6389) kd_loss 0.9706 (0.9227) lr 7.8853e-06 eta 0:00:00
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,412
* accuracy: 96.6%
* error: 3.4%
* macro_f1: 97.0%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.6%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:22:53
