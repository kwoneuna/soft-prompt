Loading trainer: TRIP
Loading dataset: SPG_PACS
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ------------------------------------
Dataset    SPG_PACS
Source     ['art_painting', 'cartoon', 'photo']
Target     ['sketch']
# classes  7
# train_x  4,241
# val      1,821
# test     3,928
---------  ------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/132] time 0.108 (0.149) data 0.000 (0.025) loss 0.1701 (0.2729) ce_loss 0.1694 (0.2716) loss_zs_kd 0.0000 (0.0000) loss_oracle -0.0000 (-0.0002) acc 96.8750 (90.0000) kd_loss 0.0007 (0.0014) lr 1.0000e-05 eta 0:16:23
epoch [1/50] batch [40/132] time 0.099 (0.125) data 0.000 (0.012) loss 0.2084 (0.2606) ce_loss 0.2074 (0.2595) loss_zs_kd 0.0001 (0.0000) loss_oracle -0.0001 (-0.0001) acc 93.7500 (90.9375) kd_loss 0.0011 (0.0011) lr 1.0000e-05 eta 0:13:39
epoch [1/50] batch [60/132] time 0.102 (0.117) data 0.000 (0.008) loss 0.4287 (0.2512) ce_loss 0.4272 (0.2501) loss_zs_kd 0.0004 (0.0001) loss_oracle -0.0001 (-0.0001) acc 81.2500 (91.3021) kd_loss 0.0014 (0.0011) lr 1.0000e-05 eta 0:12:42
epoch [1/50] batch [80/132] time 0.103 (0.112) data 0.000 (0.006) loss 0.3857 (0.2526) ce_loss 0.3840 (0.2514) loss_zs_kd 0.0004 (0.0001) loss_oracle -0.0001 (-0.0001) acc 84.3750 (91.4062) kd_loss 0.0016 (0.0012) lr 1.0000e-05 eta 0:12:12
epoch [1/50] batch [100/132] time 0.095 (0.110) data 0.000 (0.005) loss 0.1760 (0.2593) ce_loss 0.1742 (0.2581) loss_zs_kd 0.0005 (0.0002) loss_oracle -0.0001 (-0.0001) acc 90.6250 (91.4062) kd_loss 0.0016 (0.0012) lr 1.0000e-05 eta 0:11:55
epoch [1/50] batch [120/132] time 0.094 (0.110) data 0.000 (0.004) loss 0.3625 (0.2589) ce_loss 0.3601 (0.2575) loss_zs_kd 0.0002 (0.0002) loss_oracle -0.0002 (-0.0001) acc 87.5000 (91.4323) kd_loss 0.0024 (0.0013) lr 1.0000e-05 eta 0:11:51
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,800
* accuracy: 98.8%
* error: 1.2%
* macro_f1: 98.9%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,472
* accuracy: 88.4%
* error: 11.6%
* macro_f1: 90.7%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain s best val acc:      98.8%, epoch: 1 *******
******* Domain s best val test acc: 88.4%, epoch: 1 *******
******* Domain s best test acc:     88.4%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/ana
epoch [2/50] batch [20/132] time 0.086 (0.113) data 0.000 (0.019) loss 0.1098 (0.2582) ce_loss 0.1006 (0.2433) loss_zs_kd 0.0106 (0.0229) loss_oracle -0.0000 (-0.0000) acc 96.8750 (92.0312) kd_loss 0.0039 (0.0034) lr 2.0000e-03 eta 0:12:11
epoch [2/50] batch [40/132] time 0.089 (0.105) data 0.000 (0.010) loss 0.4234 (0.2405) ce_loss 0.4077 (0.2253) loss_zs_kd 0.0217 (0.0225) loss_oracle 0.0003 (0.0000) acc 90.6250 (92.7344) kd_loss 0.0047 (0.0039) lr 2.0000e-03 eta 0:11:16
epoch [2/50] batch [60/132] time 0.100 (0.101) data 0.000 (0.007) loss 0.3506 (0.2356) ce_loss 0.3218 (0.2181) loss_zs_kd 0.0384 (0.0250) loss_oracle 0.0002 (0.0001) acc 87.5000 (93.0208) kd_loss 0.0095 (0.0049) lr 2.0000e-03 eta 0:10:49
epoch [2/50] batch [80/132] time 0.096 (0.099) data 0.000 (0.005) loss 0.1457 (0.2338) ce_loss 0.1199 (0.2138) loss_zs_kd 0.0340 (0.0275) loss_oracle 0.0005 (0.0001) acc 96.8750 (93.0078) kd_loss 0.0085 (0.0063) lr 2.0000e-03 eta 0:10:32
epoch [2/50] batch [100/132] time 0.100 (0.100) data 0.000 (0.004) loss 0.2637 (0.2333) ce_loss 0.2361 (0.2111) loss_zs_kd 0.0319 (0.0301) loss_oracle 0.0017 (0.0003) acc 93.7500 (93.1250) kd_loss 0.0109 (0.0069) lr 2.0000e-03 eta 0:10:34
epoch [2/50] batch [120/132] time 0.094 (0.099) data 0.000 (0.003) loss 0.2168 (0.2322) ce_loss 0.1913 (0.2091) loss_zs_kd 0.0208 (0.0297) loss_oracle 0.0045 (0.0010) acc 90.6250 (93.1250) kd_loss 0.0128 (0.0077) lr 2.0000e-03 eta 0:10:25
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,805
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.0%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,539
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.4%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain s best val acc:      99.1%, epoch: 2 *******
******* Domain s best val test acc: 90.1%, epoch: 2 *******
******* Domain s best test acc:     90.1%, epoch: 2 *******
epoch [3/50] batch [20/132] time 0.066 (0.093) data 0.000 (0.019) loss 0.4224 (0.2224) ce_loss 0.3828 (0.1880) loss_zs_kd 0.0352 (0.0313) loss_oracle 0.0022 (0.0025) acc 87.5000 (94.5312) kd_loss 0.0209 (0.0175) lr 1.9980e-03 eta 0:09:46
epoch [3/50] batch [40/132] time 0.075 (0.084) data 0.000 (0.010) loss 0.3142 (0.2455) ce_loss 0.2651 (0.2047) loss_zs_kd 0.0358 (0.0377) loss_oracle 0.0101 (0.0039) acc 93.7500 (93.6719) kd_loss 0.0261 (0.0200) lr 1.9980e-03 eta 0:08:46
epoch [3/50] batch [60/132] time 0.063 (0.087) data 0.000 (0.007) loss 0.2410 (0.2443) ce_loss 0.1891 (0.2019) loss_zs_kd 0.0262 (0.0356) loss_oracle 0.0016 (0.0042) acc 90.6250 (93.6979) kd_loss 0.0381 (0.0225) lr 1.9980e-03 eta 0:09:06
epoch [3/50] batch [80/132] time 0.076 (0.092) data 0.000 (0.005) loss 0.3150 (0.2454) ce_loss 0.2495 (0.1984) loss_zs_kd 0.0390 (0.0369) loss_oracle 0.0048 (0.0043) acc 93.7500 (93.7500) kd_loss 0.0436 (0.0264) lr 1.9980e-03 eta 0:09:37
epoch [3/50] batch [100/132] time 0.078 (0.096) data 0.000 (0.004) loss 0.1975 (0.2524) ce_loss 0.1179 (0.2001) loss_zs_kd 0.0172 (0.0360) loss_oracle 0.0087 (0.0050) acc 96.8750 (93.5625) kd_loss 0.0666 (0.0319) lr 1.9980e-03 eta 0:09:57
epoch [3/50] batch [120/132] time 0.147 (0.099) data 0.000 (0.003) loss 0.2627 (0.2597) ce_loss 0.1887 (0.1992) loss_zs_kd 0.0246 (0.0350) loss_oracle 0.0055 (0.0054) acc 96.8750 (93.6719) kd_loss 0.0589 (0.0404) lr 1.9980e-03 eta 0:10:13
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,804
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.0%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,552
* accuracy: 90.4%
* error: 9.6%
* macro_f1: 92.7%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain s best val acc:      99.1%, epoch: 2 *******
******* Domain s best val test acc: 90.1%, epoch: 2 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [4/50] batch [20/132] time 0.106 (0.122) data 0.000 (0.023) loss 0.2956 (0.3304) ce_loss 0.1757 (0.2010) loss_zs_kd 0.0212 (0.0390) loss_oracle 0.0106 (0.0124) acc 96.8750 (93.4375) kd_loss 0.1040 (0.1037) lr 1.9921e-03 eta 0:12:32
epoch [4/50] batch [40/132] time 0.107 (0.111) data 0.000 (0.011) loss 0.6138 (0.3594) ce_loss 0.4358 (0.2126) loss_zs_kd 0.0332 (0.0369) loss_oracle 0.0785 (0.0322) acc 93.7500 (93.0469) kd_loss 0.1221 (0.1123) lr 1.9921e-03 eta 0:11:22
epoch [4/50] batch [60/132] time 0.078 (0.105) data 0.000 (0.008) loss 0.4404 (0.3585) ce_loss 0.1914 (0.2035) loss_zs_kd 0.0329 (0.0347) loss_oracle 0.0155 (0.0328) acc 93.7500 (93.5938) kd_loss 0.2248 (0.1213) lr 1.9921e-03 eta 0:10:45
epoch [4/50] batch [80/132] time 0.106 (0.103) data 0.000 (0.006) loss 0.3108 (0.3548) ce_loss 0.1658 (0.1978) loss_zs_kd 0.0128 (0.0324) loss_oracle 0.0212 (0.0299) acc 93.7500 (93.6719) kd_loss 0.1281 (0.1258) lr 1.9921e-03 eta 0:10:30
epoch [4/50] batch [100/132] time 0.102 (0.102) data 0.000 (0.005) loss 0.4949 (0.3636) ce_loss 0.3274 (0.2048) loss_zs_kd 0.0552 (0.0317) loss_oracle 0.0130 (0.0269) acc 87.5000 (93.2812) kd_loss 0.1334 (0.1295) lr 1.9921e-03 eta 0:10:25
epoch [4/50] batch [120/132] time 0.098 (0.102) data 0.000 (0.004) loss 0.5082 (0.3703) ce_loss 0.3167 (0.2059) loss_zs_kd 0.0546 (0.0330) loss_oracle 0.0152 (0.0248) acc 87.5000 (93.3333) kd_loss 0.1566 (0.1355) lr 1.9921e-03 eta 0:10:19
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,804
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.0%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,527
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 92.1%
******* Domain s best val acc:      99.1%, epoch: 2 *******
******* Domain s best val test acc: 90.1%, epoch: 2 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [5/50] batch [20/132] time 0.098 (0.122) data 0.000 (0.022) loss 0.4190 (0.4258) ce_loss 0.1970 (0.2119) loss_zs_kd 0.0276 (0.0322) loss_oracle 0.0071 (0.0103) acc 93.7500 (93.1250) kd_loss 0.2046 (0.1926) lr 1.9823e-03 eta 0:12:17
epoch [5/50] batch [40/132] time 0.102 (0.111) data 0.000 (0.011) loss 0.4599 (0.4190) ce_loss 0.2651 (0.2083) loss_zs_kd 0.0256 (0.0362) loss_oracle 0.0076 (0.0090) acc 90.6250 (93.1250) kd_loss 0.1782 (0.1881) lr 1.9823e-03 eta 0:11:08
epoch [5/50] batch [60/132] time 0.097 (0.107) data 0.001 (0.007) loss 0.5216 (0.4214) ce_loss 0.2876 (0.2083) loss_zs_kd 0.0330 (0.0353) loss_oracle 0.0101 (0.0086) acc 90.6250 (93.0208) kd_loss 0.2124 (0.1911) lr 1.9823e-03 eta 0:10:43
epoch [5/50] batch [80/132] time 0.097 (0.105) data 0.000 (0.006) loss 0.5302 (0.4075) ce_loss 0.3645 (0.2040) loss_zs_kd 0.0273 (0.0344) loss_oracle 0.0135 (0.0092) acc 87.5000 (93.2031) kd_loss 0.1453 (0.1818) lr 1.9823e-03 eta 0:10:27
epoch [5/50] batch [100/132] time 0.102 (0.104) data 0.000 (0.005) loss 0.2212 (0.4030) ce_loss 0.0553 (0.2086) loss_zs_kd 0.0207 (0.0339) loss_oracle 0.0125 (0.0099) acc 100.0000 (93.1562) kd_loss 0.1493 (0.1724) lr 1.9823e-03 eta 0:10:18
epoch [5/50] batch [120/132] time 0.093 (0.102) data 0.000 (0.004) loss 0.3745 (0.3941) ce_loss 0.2085 (0.2070) loss_zs_kd 0.0258 (0.0354) loss_oracle 0.0153 (0.0111) acc 93.7500 (93.2292) kd_loss 0.1455 (0.1639) lr 1.9823e-03 eta 0:10:04
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,803
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.0%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,543
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 92.3%
******* Domain s best val acc:      99.1%, epoch: 2 *******
******* Domain s best val test acc: 90.1%, epoch: 2 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [6/50] batch [20/132] time 0.072 (0.131) data 0.000 (0.024) loss 0.2526 (0.3695) ce_loss 0.0389 (0.1977) loss_zs_kd 0.0471 (0.0351) loss_oracle 0.0048 (0.0095) acc 100.0000 (93.2812) kd_loss 0.1877 (0.1495) lr 1.9686e-03 eta 0:12:52
epoch [6/50] batch [40/132] time 0.082 (0.114) data 0.000 (0.012) loss 0.5285 (0.3526) ce_loss 0.2991 (0.1839) loss_zs_kd 0.0790 (0.0353) loss_oracle 0.0047 (0.0071) acc 87.5000 (94.0625) kd_loss 0.1875 (0.1475) lr 1.9686e-03 eta 0:11:10
epoch [6/50] batch [60/132] time 0.080 (0.105) data 0.000 (0.008) loss 0.2550 (0.3531) ce_loss 0.1315 (0.1861) loss_zs_kd 0.0202 (0.0350) loss_oracle 0.0098 (0.0070) acc 96.8750 (93.9583) kd_loss 0.1086 (0.1460) lr 1.9686e-03 eta 0:10:16
epoch [6/50] batch [80/132] time 0.074 (0.102) data 0.000 (0.006) loss 0.5228 (0.3714) ce_loss 0.2529 (0.2021) loss_zs_kd 0.0823 (0.0372) loss_oracle 0.0322 (0.0088) acc 90.6250 (93.3594) kd_loss 0.2126 (0.1463) lr 1.9686e-03 eta 0:09:58
epoch [6/50] batch [100/132] time 0.074 (0.101) data 0.000 (0.005) loss 0.3978 (0.3783) ce_loss 0.1685 (0.2002) loss_zs_kd 0.0337 (0.0374) loss_oracle 0.0186 (0.0125) acc 93.7500 (93.4062) kd_loss 0.2031 (0.1532) lr 1.9686e-03 eta 0:09:51
epoch [6/50] batch [120/132] time 0.069 (0.103) data 0.000 (0.004) loss 0.5875 (0.3796) ce_loss 0.3286 (0.1934) loss_zs_kd 0.0309 (0.0368) loss_oracle 0.0292 (0.0150) acc 87.5000 (93.5417) kd_loss 0.2288 (0.1603) lr 1.9686e-03 eta 0:10:01
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,807
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.2%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,532
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 92.3%
******* Domain s best val acc:      99.2%, epoch: 6 *******
******* Domain s best val test acc: 89.9%, epoch: 6 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [7/50] batch [20/132] time 0.079 (0.103) data 0.000 (0.021) loss 0.5918 (0.4921) ce_loss 0.4067 (0.2571) loss_zs_kd 0.0390 (0.0421) loss_oracle 0.0151 (0.0214) acc 87.5000 (90.9375) kd_loss 0.1580 (0.2031) lr 1.9511e-03 eta 0:09:56
epoch [7/50] batch [40/132] time 0.098 (0.093) data 0.000 (0.011) loss 0.2183 (0.4555) ce_loss 0.0219 (0.2235) loss_zs_kd 0.0213 (0.0400) loss_oracle 0.0038 (0.0155) acc 100.0000 (91.8750) kd_loss 0.1839 (0.2043) lr 1.9511e-03 eta 0:08:55
epoch [7/50] batch [60/132] time 0.113 (0.095) data 0.001 (0.007) loss 0.3713 (0.4360) ce_loss 0.1842 (0.2047) loss_zs_kd 0.0522 (0.0381) loss_oracle 0.0049 (0.0118) acc 93.7500 (92.6562) kd_loss 0.1586 (0.2064) lr 1.9511e-03 eta 0:09:06
epoch [7/50] batch [80/132] time 0.089 (0.095) data 0.000 (0.005) loss 0.4319 (0.4308) ce_loss 0.2358 (0.1999) loss_zs_kd 0.0263 (0.0367) loss_oracle 0.0048 (0.0103) acc 93.7500 (93.1250) kd_loss 0.1805 (0.2073) lr 1.9511e-03 eta 0:09:03
epoch [7/50] batch [100/132] time 0.097 (0.095) data 0.000 (0.004) loss 0.2907 (0.4376) ce_loss 0.0748 (0.2030) loss_zs_kd 0.0265 (0.0365) loss_oracle 0.0098 (0.0099) acc 96.8750 (93.0312) kd_loss 0.1977 (0.2114) lr 1.9511e-03 eta 0:09:04
epoch [7/50] batch [120/132] time 0.090 (0.096) data 0.000 (0.004) loss 0.5005 (0.4443) ce_loss 0.2434 (0.2047) loss_zs_kd 0.0284 (0.0367) loss_oracle 0.0082 (0.0098) acc 90.6250 (93.0208) kd_loss 0.2388 (0.2163) lr 1.9511e-03 eta 0:09:06
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.2%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,530
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 92.1%
******* Domain s best val acc:      99.3%, epoch: 7 *******
******* Domain s best val test acc: 89.9%, epoch: 7 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [8/50] batch [20/132] time 0.108 (0.134) data 0.000 (0.030) loss 0.3866 (0.4148) ce_loss 0.1790 (0.1688) loss_zs_kd 0.0349 (0.0410) loss_oracle 0.0179 (0.0115) acc 90.6250 (95.1562) kd_loss 0.1813 (0.2198) lr 1.9298e-03 eta 0:12:39
epoch [8/50] batch [40/132] time 0.091 (0.116) data 0.000 (0.015) loss 0.3626 (0.4307) ce_loss 0.0625 (0.1774) loss_zs_kd 0.0294 (0.0395) loss_oracle 0.0116 (0.0131) acc 96.8750 (94.4531) kd_loss 0.2797 (0.2271) lr 1.9298e-03 eta 0:10:56
epoch [8/50] batch [60/132] time 0.110 (0.111) data 0.000 (0.010) loss 0.4588 (0.4447) ce_loss 0.1460 (0.1793) loss_zs_kd 0.0247 (0.0419) loss_oracle 0.0197 (0.0135) acc 96.8750 (94.4792) kd_loss 0.2905 (0.2377) lr 1.9298e-03 eta 0:10:24
epoch [8/50] batch [80/132] time 0.099 (0.109) data 0.000 (0.008) loss 0.5324 (0.4530) ce_loss 0.2029 (0.1808) loss_zs_kd 0.0448 (0.0397) loss_oracle 0.0266 (0.0153) acc 93.7500 (94.2578) kd_loss 0.2938 (0.2447) lr 1.9298e-03 eta 0:10:07
epoch [8/50] batch [100/132] time 0.100 (0.108) data 0.000 (0.006) loss 0.5801 (0.4706) ce_loss 0.1115 (0.1777) loss_zs_kd 0.0414 (0.0400) loss_oracle 0.0274 (0.0173) acc 96.8750 (94.3438) kd_loss 0.4342 (0.2642) lr 1.9298e-03 eta 0:10:01
epoch [8/50] batch [120/132] time 0.089 (0.106) data 0.000 (0.005) loss 0.5531 (0.4923) ce_loss 0.1514 (0.1799) loss_zs_kd 0.0492 (0.0394) loss_oracle 0.0108 (0.0166) acc 93.7500 (94.2708) kd_loss 0.3717 (0.2845) lr 1.9298e-03 eta 0:09:49
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,805
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,528
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 91.9%
******* Domain s best val acc:      99.3%, epoch: 7 *******
******* Domain s best val test acc: 89.9%, epoch: 7 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [9/50] batch [20/132] time 0.139 (0.134) data 0.000 (0.033) loss 0.6043 (0.5590) ce_loss 0.2032 (0.1907) loss_zs_kd 0.0533 (0.0409) loss_oracle 0.0067 (0.0138) acc 93.7500 (93.5938) kd_loss 0.3711 (0.3410) lr 1.9048e-03 eta 0:12:20
epoch [9/50] batch [40/132] time 0.064 (0.117) data 0.000 (0.016) loss 0.5213 (0.5462) ce_loss 0.2300 (0.2021) loss_zs_kd 0.0231 (0.0397) loss_oracle 0.0095 (0.0109) acc 90.6250 (93.0469) kd_loss 0.2750 (0.3187) lr 1.9048e-03 eta 0:10:43
epoch [9/50] batch [60/132] time 0.088 (0.111) data 0.000 (0.011) loss 0.5864 (0.5382) ce_loss 0.3247 (0.2133) loss_zs_kd 0.0293 (0.0377) loss_oracle 0.0055 (0.0097) acc 84.3750 (92.6042) kd_loss 0.2443 (0.3011) lr 1.9048e-03 eta 0:10:08
epoch [9/50] batch [80/132] time 0.080 (0.103) data 0.000 (0.008) loss 0.7118 (0.5395) ce_loss 0.3232 (0.2198) loss_zs_kd 0.0938 (0.0386) loss_oracle 0.0163 (0.0102) acc 84.3750 (92.1875) kd_loss 0.3336 (0.2953) lr 1.9048e-03 eta 0:09:24
epoch [9/50] batch [100/132] time 0.081 (0.102) data 0.000 (0.007) loss 0.4191 (0.5220) ce_loss 0.2556 (0.2112) loss_zs_kd 0.0281 (0.0378) loss_oracle 0.0142 (0.0116) acc 90.6250 (92.4375) kd_loss 0.1424 (0.2861) lr 1.9048e-03 eta 0:09:16
epoch [9/50] batch [120/132] time 0.167 (0.101) data 0.000 (0.006) loss 0.7659 (0.5318) ce_loss 0.3628 (0.2215) loss_zs_kd 0.0958 (0.0393) loss_oracle 0.0167 (0.0130) acc 87.5000 (92.1615) kd_loss 0.3469 (0.2841) lr 1.9048e-03 eta 0:09:09
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,810
* accuracy: 99.4%
* error: 0.6%
* macro_f1: 99.3%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,515
* accuracy: 89.5%
* error: 10.5%
* macro_f1: 91.9%
******* Domain s best val acc:      99.4%, epoch: 9 *******
******* Domain s best val test acc: 89.5%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [10/50] batch [20/132] time 0.093 (0.127) data 0.000 (0.031) loss 0.5912 (0.5460) ce_loss 0.2800 (0.2365) loss_zs_kd 0.0567 (0.0417) loss_oracle 0.0108 (0.0140) acc 90.6250 (91.8750) kd_loss 0.2774 (0.2817) lr 1.8763e-03 eta 0:11:25
epoch [10/50] batch [40/132] time 0.084 (0.106) data 0.000 (0.016) loss 0.4521 (0.4958) ce_loss 0.1774 (0.1875) loss_zs_kd 0.0457 (0.0450) loss_oracle 0.0154 (0.0156) acc 90.6250 (93.6719) kd_loss 0.2442 (0.2780) lr 1.8763e-03 eta 0:09:29
epoch [10/50] batch [60/132] time 0.102 (0.103) data 0.000 (0.011) loss 0.5423 (0.5055) ce_loss 0.2233 (0.1854) loss_zs_kd 0.0443 (0.0435) loss_oracle 0.0121 (0.0160) acc 93.7500 (93.6979) kd_loss 0.2909 (0.2904) lr 1.8763e-03 eta 0:09:11
epoch [10/50] batch [80/132] time 0.106 (0.103) data 0.000 (0.008) loss 0.5914 (0.5044) ce_loss 0.2200 (0.1773) loss_zs_kd 0.0337 (0.0439) loss_oracle 0.0163 (0.0165) acc 93.7500 (94.1797) kd_loss 0.3464 (0.2969) lr 1.8763e-03 eta 0:09:07
epoch [10/50] batch [100/132] time 0.097 (0.102) data 0.000 (0.006) loss 0.6720 (0.5197) ce_loss 0.3093 (0.1853) loss_zs_kd 0.0267 (0.0447) loss_oracle 0.0256 (0.0170) acc 87.5000 (93.8125) kd_loss 0.3365 (0.3036) lr 1.8763e-03 eta 0:09:03
epoch [10/50] batch [120/132] time 0.098 (0.102) data 0.000 (0.005) loss 0.7983 (0.5308) ce_loss 0.3579 (0.1899) loss_zs_kd 0.0626 (0.0456) loss_oracle 0.0207 (0.0181) acc 87.5000 (93.5417) kd_loss 0.3987 (0.3090) lr 1.8763e-03 eta 0:08:58
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,805
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,529
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 92.0%
******* Domain s best val acc:      99.4%, epoch: 9 *******
******* Domain s best val test acc: 89.5%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [11/50] batch [20/132] time 0.109 (0.142) data 0.000 (0.039) loss 0.6338 (0.6082) ce_loss 0.2041 (0.1891) loss_zs_kd 0.0482 (0.0412) loss_oracle 0.0172 (0.0205) acc 93.7500 (93.7500) kd_loss 0.3970 (0.3883) lr 1.8443e-03 eta 0:12:29
epoch [11/50] batch [40/132] time 0.095 (0.123) data 0.000 (0.019) loss 0.6736 (0.6187) ce_loss 0.1831 (0.1855) loss_zs_kd 0.0360 (0.0433) loss_oracle 0.0351 (0.0218) acc 90.6250 (93.6719) kd_loss 0.4550 (0.4007) lr 1.8443e-03 eta 0:10:41
epoch [11/50] batch [60/132] time 0.101 (0.116) data 0.000 (0.013) loss 0.6862 (0.6249) ce_loss 0.2817 (0.1865) loss_zs_kd 0.0368 (0.0438) loss_oracle 0.0244 (0.0224) acc 87.5000 (93.8542) kd_loss 0.3738 (0.4053) lr 1.8443e-03 eta 0:10:05
epoch [11/50] batch [80/132] time 0.109 (0.113) data 0.001 (0.010) loss 0.5724 (0.6228) ce_loss 0.0578 (0.1803) loss_zs_kd 0.0750 (0.0441) loss_oracle 0.0217 (0.0239) acc 100.0000 (94.1016) kd_loss 0.4662 (0.4085) lr 1.8443e-03 eta 0:09:49
epoch [11/50] batch [100/132] time 0.084 (0.111) data 0.000 (0.008) loss 0.6482 (0.6283) ce_loss 0.2119 (0.1881) loss_zs_kd 0.0243 (0.0423) loss_oracle 0.0197 (0.0242) acc 90.6250 (93.6875) kd_loss 0.4142 (0.4069) lr 1.8443e-03 eta 0:09:32
epoch [11/50] batch [120/132] time 0.094 (0.109) data 0.001 (0.007) loss 0.6096 (0.6292) ce_loss 0.2520 (0.1915) loss_zs_kd 0.0616 (0.0430) loss_oracle 0.0328 (0.0244) acc 96.8750 (93.5938) kd_loss 0.3105 (0.4039) lr 1.8443e-03 eta 0:09:20
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.2%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,518
* accuracy: 89.6%
* error: 10.4%
* macro_f1: 92.0%
******* Domain s best val acc:      99.4%, epoch: 9 *******
******* Domain s best val test acc: 89.5%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [12/50] batch [20/132] time 0.169 (0.145) data 0.000 (0.034) loss 0.6194 (0.5605) ce_loss 0.2042 (0.1718) loss_zs_kd 0.0283 (0.0327) loss_oracle 0.0432 (0.0536) acc 93.7500 (94.0625) kd_loss 0.3794 (0.3455) lr 1.8090e-03 eta 0:12:23
epoch [12/50] batch [40/132] time 0.082 (0.126) data 0.000 (0.017) loss 0.5782 (0.5545) ce_loss 0.2488 (0.1895) loss_zs_kd 0.0419 (0.0360) loss_oracle 0.0336 (0.0442) acc 93.7500 (93.1250) kd_loss 0.2917 (0.3249) lr 1.8090e-03 eta 0:10:41
epoch [12/50] batch [60/132] time 0.075 (0.121) data 0.000 (0.012) loss 0.7785 (0.5552) ce_loss 0.4075 (0.2026) loss_zs_kd 0.0648 (0.0387) loss_oracle 0.0440 (0.0412) acc 84.3750 (92.8646) kd_loss 0.3166 (0.3127) lr 1.8090e-03 eta 0:10:13
epoch [12/50] batch [80/132] time 0.077 (0.110) data 0.000 (0.009) loss 0.4343 (0.5440) ce_loss 0.1624 (0.1987) loss_zs_kd 0.0442 (0.0388) loss_oracle 0.0252 (0.0385) acc 96.8750 (93.1250) kd_loss 0.2372 (0.3066) lr 1.8090e-03 eta 0:09:15
epoch [12/50] batch [100/132] time 0.078 (0.104) data 0.000 (0.007) loss 0.5415 (0.5445) ce_loss 0.1802 (0.1998) loss_zs_kd 0.0454 (0.0393) loss_oracle 0.0350 (0.0358) acc 93.7500 (93.0312) kd_loss 0.3211 (0.3072) lr 1.8090e-03 eta 0:08:47
epoch [12/50] batch [120/132] time 0.162 (0.106) data 0.000 (0.006) loss 0.4960 (0.5455) ce_loss 0.1110 (0.1973) loss_zs_kd 0.0690 (0.0401) loss_oracle 0.0319 (0.0357) acc 96.8750 (93.3073) kd_loss 0.3345 (0.3103) lr 1.8090e-03 eta 0:08:51
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,809
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,529
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 92.1%
******* Domain s best val acc:      99.4%, epoch: 9 *******
******* Domain s best val test acc: 89.5%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [13/50] batch [20/132] time 0.067 (0.141) data 0.000 (0.038) loss 0.6665 (0.6463) ce_loss 0.2469 (0.2104) loss_zs_kd 0.0334 (0.0296) loss_oracle 0.0454 (0.0334) acc 93.7500 (93.9062) kd_loss 0.3802 (0.4044) lr 1.7705e-03 eta 0:11:44
epoch [13/50] batch [40/132] time 0.090 (0.109) data 0.000 (0.019) loss 0.5783 (0.6579) ce_loss 0.2052 (0.2027) loss_zs_kd 0.0646 (0.0394) loss_oracle 0.0324 (0.0346) acc 90.6250 (93.6719) kd_loss 0.3246 (0.4182) lr 1.7705e-03 eta 0:09:04
epoch [13/50] batch [60/132] time 0.104 (0.104) data 0.000 (0.013) loss 0.7069 (0.6608) ce_loss 0.1918 (0.2036) loss_zs_kd 0.0435 (0.0416) loss_oracle 0.0311 (0.0357) acc 93.7500 (93.2812) kd_loss 0.4778 (0.4184) lr 1.7705e-03 eta 0:08:35
epoch [13/50] batch [80/132] time 0.097 (0.103) data 0.000 (0.010) loss 0.7540 (0.6472) ce_loss 0.2379 (0.1966) loss_zs_kd 0.0484 (0.0412) loss_oracle 0.0341 (0.0364) acc 90.6250 (93.5156) kd_loss 0.4748 (0.4118) lr 1.7705e-03 eta 0:08:28
epoch [13/50] batch [100/132] time 0.097 (0.102) data 0.000 (0.008) loss 0.5064 (0.6464) ce_loss 0.1320 (0.1983) loss_zs_kd 0.0407 (0.0403) loss_oracle 0.0292 (0.0358) acc 96.8750 (93.4688) kd_loss 0.3395 (0.4102) lr 1.7705e-03 eta 0:08:21
epoch [13/50] batch [120/132] time 0.093 (0.102) data 0.000 (0.007) loss 0.5185 (0.6443) ce_loss 0.0870 (0.1971) loss_zs_kd 0.0322 (0.0406) loss_oracle 0.0265 (0.0340) acc 96.8750 (93.3854) kd_loss 0.4021 (0.4099) lr 1.7705e-03 eta 0:08:17
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,810
* accuracy: 99.4%
* error: 0.6%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,536
* accuracy: 90.0%
* error: 10.0%
* macro_f1: 92.3%
******* Domain s best val acc:      99.4%, epoch: 9 *******
******* Domain s best val test acc: 89.5%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [14/50] batch [20/132] time 0.095 (0.145) data 0.000 (0.044) loss 0.6823 (0.7005) ce_loss 0.2482 (0.2389) loss_zs_kd 0.0519 (0.0399) loss_oracle 0.0262 (0.0315) acc 90.6250 (92.0312) kd_loss 0.3951 (0.4260) lr 1.7290e-03 eta 0:11:45
epoch [14/50] batch [40/132] time 0.112 (0.124) data 0.000 (0.022) loss 0.5677 (0.6688) ce_loss 0.0614 (0.1989) loss_zs_kd 0.0160 (0.0413) loss_oracle 0.0308 (0.0306) acc 100.0000 (93.5938) kd_loss 0.4829 (0.4339) lr 1.7290e-03 eta 0:10:02
epoch [14/50] batch [60/132] time 0.107 (0.118) data 0.000 (0.015) loss 0.6385 (0.6478) ce_loss 0.1591 (0.1852) loss_zs_kd 0.0368 (0.0421) loss_oracle 0.0369 (0.0306) acc 90.6250 (93.9583) kd_loss 0.4425 (0.4263) lr 1.7290e-03 eta 0:09:27
epoch [14/50] batch [80/132] time 0.107 (0.114) data 0.000 (0.011) loss 0.6128 (0.6485) ce_loss 0.1331 (0.1880) loss_zs_kd 0.0530 (0.0431) loss_oracle 0.0548 (0.0336) acc 96.8750 (93.7500) kd_loss 0.4259 (0.4221) lr 1.7290e-03 eta 0:09:09
epoch [14/50] batch [100/132] time 0.101 (0.112) data 0.000 (0.009) loss 0.5720 (0.6396) ce_loss 0.1517 (0.1806) loss_zs_kd 0.0511 (0.0429) loss_oracle 0.0536 (0.0361) acc 93.7500 (94.0625) kd_loss 0.3679 (0.4194) lr 1.7290e-03 eta 0:08:57
epoch [14/50] batch [120/132] time 0.097 (0.110) data 0.000 (0.008) loss 0.5704 (0.6435) ce_loss 0.2034 (0.1822) loss_zs_kd 0.0232 (0.0432) loss_oracle 0.0395 (0.0382) acc 90.6250 (93.9062) kd_loss 0.3357 (0.4206) lr 1.7290e-03 eta 0:08:45
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,809
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,527
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 92.2%
******* Domain s best val acc:      99.4%, epoch: 9 *******
******* Domain s best val test acc: 89.5%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [15/50] batch [20/132] time 0.070 (0.138) data 0.000 (0.043) loss 0.7286 (0.5924) ce_loss 0.3633 (0.1764) loss_zs_kd 0.0550 (0.0428) loss_oracle 0.0311 (0.0262) acc 87.5000 (94.0625) kd_loss 0.3223 (0.3815) lr 1.6845e-03 eta 0:10:53
epoch [15/50] batch [40/132] time 0.063 (0.117) data 0.000 (0.022) loss 0.5526 (0.6196) ce_loss 0.0783 (0.2004) loss_zs_kd 0.0257 (0.0437) loss_oracle 0.0251 (0.0301) acc 100.0000 (93.1250) kd_loss 0.4489 (0.3823) lr 1.6845e-03 eta 0:09:12
epoch [15/50] batch [60/132] time 0.156 (0.110) data 0.000 (0.015) loss 0.5488 (0.6025) ce_loss 0.1304 (0.1892) loss_zs_kd 0.0372 (0.0429) loss_oracle 0.0687 (0.0343) acc 96.8750 (93.6979) kd_loss 0.3655 (0.3748) lr 1.6845e-03 eta 0:08:38
epoch [15/50] batch [80/132] time 0.088 (0.106) data 0.000 (0.011) loss 0.5490 (0.6054) ce_loss 0.1220 (0.1871) loss_zs_kd 0.0645 (0.0421) loss_oracle 0.0566 (0.0428) acc 96.8750 (93.5938) kd_loss 0.3664 (0.3759) lr 1.6845e-03 eta 0:08:13
epoch [15/50] batch [100/132] time 0.083 (0.101) data 0.000 (0.009) loss 0.7705 (0.6071) ce_loss 0.2573 (0.1814) loss_zs_kd 0.0328 (0.0410) loss_oracle 0.0626 (0.0454) acc 90.6250 (93.8750) kd_loss 0.4655 (0.3825) lr 1.6845e-03 eta 0:07:50
epoch [15/50] batch [120/132] time 0.157 (0.102) data 0.000 (0.007) loss 0.7959 (0.6172) ce_loss 0.1903 (0.1787) loss_zs_kd 0.0316 (0.0408) loss_oracle 0.1218 (0.0511) acc 93.7500 (93.8802) kd_loss 0.5289 (0.3925) lr 1.6845e-03 eta 0:07:53
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,520
* accuracy: 89.6%
* error: 10.4%
* macro_f1: 92.0%
******* Domain s best val acc:      99.4%, epoch: 9 *******
******* Domain s best val test acc: 89.5%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [16/50] batch [20/132] time 0.068 (0.148) data 0.000 (0.041) loss 0.6902 (0.8201) ce_loss 0.1095 (0.2239) loss_zs_kd 0.0449 (0.0363) loss_oracle 0.0738 (0.0919) acc 100.0000 (91.7188) kd_loss 0.5214 (0.5321) lr 1.6374e-03 eta 0:11:18
epoch [16/50] batch [40/132] time 0.082 (0.114) data 0.000 (0.021) loss 0.6999 (0.7868) ce_loss 0.0696 (0.1942) loss_zs_kd 0.0246 (0.0369) loss_oracle 0.0677 (0.0778) acc 96.8750 (93.2031) kd_loss 0.5841 (0.5353) lr 1.6374e-03 eta 0:08:43
epoch [16/50] batch [60/132] time 0.110 (0.106) data 0.001 (0.014) loss 0.8700 (0.7899) ce_loss 0.2247 (0.1950) loss_zs_kd 0.0804 (0.0413) loss_oracle 0.0723 (0.0738) acc 90.6250 (93.4375) kd_loss 0.5690 (0.5373) lr 1.6374e-03 eta 0:08:04
epoch [16/50] batch [80/132] time 0.100 (0.105) data 0.000 (0.010) loss 0.8109 (0.7793) ce_loss 0.1797 (0.1966) loss_zs_kd 0.0352 (0.0422) loss_oracle 0.0460 (0.0689) acc 93.7500 (93.5156) kd_loss 0.5906 (0.5272) lr 1.6374e-03 eta 0:07:57
epoch [16/50] batch [100/132] time 0.102 (0.105) data 0.000 (0.008) loss 0.8101 (0.7685) ce_loss 0.1716 (0.1979) loss_zs_kd 0.0484 (0.0420) loss_oracle 0.0362 (0.0628) acc 96.8750 (93.5312) kd_loss 0.5962 (0.5182) lr 1.6374e-03 eta 0:07:52
epoch [16/50] batch [120/132] time 0.272 (0.105) data 0.000 (0.007) loss 0.5778 (0.7500) ce_loss 0.1477 (0.1992) loss_zs_kd 0.0329 (0.0419) loss_oracle 0.0439 (0.0585) acc 93.7500 (93.3333) kd_loss 0.3917 (0.5006) lr 1.6374e-03 eta 0:07:53
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,807
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.2%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,525
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 92.2%
******* Domain s best val acc:      99.4%, epoch: 9 *******
******* Domain s best val test acc: 89.5%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [17/50] batch [20/132] time 0.100 (0.134) data 0.000 (0.042) loss 0.5240 (0.6488) ce_loss 0.0486 (0.1848) loss_zs_kd 0.0285 (0.0305) loss_oracle 0.0616 (0.0463) acc 100.0000 (93.7500) kd_loss 0.4303 (0.4255) lr 1.5878e-03 eta 0:09:58
epoch [17/50] batch [40/132] time 0.084 (0.115) data 0.000 (0.021) loss 0.7717 (0.6833) ce_loss 0.2200 (0.2034) loss_zs_kd 0.0414 (0.0386) loss_oracle 0.0412 (0.0496) acc 90.6250 (92.8125) kd_loss 0.5105 (0.4358) lr 1.5878e-03 eta 0:08:31
epoch [17/50] batch [60/132] time 0.097 (0.109) data 0.000 (0.014) loss 0.6323 (0.6892) ce_loss 0.1353 (0.2037) loss_zs_kd 0.0352 (0.0380) loss_oracle 0.0603 (0.0493) acc 93.7500 (92.8125) kd_loss 0.4494 (0.4419) lr 1.5878e-03 eta 0:08:02
epoch [17/50] batch [80/132] time 0.080 (0.106) data 0.000 (0.011) loss 0.5050 (0.6864) ce_loss 0.0679 (0.1974) loss_zs_kd 0.0171 (0.0393) loss_oracle 0.0432 (0.0478) acc 93.7500 (93.0859) kd_loss 0.4070 (0.4454) lr 1.5878e-03 eta 0:07:45
epoch [17/50] batch [100/132] time 0.095 (0.103) data 0.000 (0.009) loss 0.6270 (0.6810) ce_loss 0.1852 (0.1974) loss_zs_kd 0.0390 (0.0402) loss_oracle 0.0545 (0.0473) acc 93.7500 (93.2500) kd_loss 0.3951 (0.4398) lr 1.5878e-03 eta 0:07:31
epoch [17/50] batch [120/132] time 0.097 (0.101) data 0.000 (0.007) loss 0.5564 (0.6712) ce_loss 0.0792 (0.1920) loss_zs_kd 0.0425 (0.0391) loss_oracle 0.0681 (0.0492) acc 96.8750 (93.4635) kd_loss 0.4219 (0.4351) lr 1.5878e-03 eta 0:07:22
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,807
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.2%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,518
* accuracy: 89.6%
* error: 10.4%
* macro_f1: 92.0%
******* Domain s best val acc:      99.4%, epoch: 9 *******
******* Domain s best val test acc: 89.5%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [18/50] batch [20/132] time 0.087 (0.138) data 0.000 (0.043) loss 0.6388 (0.6792) ce_loss 0.1724 (0.2055) loss_zs_kd 0.0375 (0.0469) loss_oracle 0.0519 (0.0696) acc 93.7500 (93.5938) kd_loss 0.4217 (0.4154) lr 1.5358e-03 eta 0:10:00
epoch [18/50] batch [40/132] time 0.084 (0.112) data 0.000 (0.022) loss 0.6031 (0.6646) ce_loss 0.2952 (0.1897) loss_zs_kd 0.0606 (0.0445) loss_oracle 0.0559 (0.0691) acc 87.5000 (93.9062) kd_loss 0.2497 (0.4180) lr 1.5358e-03 eta 0:08:05
epoch [18/50] batch [60/132] time 0.095 (0.104) data 0.001 (0.015) loss 0.4422 (0.6528) ce_loss 0.0304 (0.1813) loss_zs_kd 0.0137 (0.0426) loss_oracle 0.0915 (0.0690) acc 100.0000 (94.2188) kd_loss 0.3592 (0.4157) lr 1.5358e-03 eta 0:07:26
epoch [18/50] batch [80/132] time 0.087 (0.106) data 0.000 (0.011) loss 0.7390 (0.6624) ce_loss 0.2155 (0.1921) loss_zs_kd 0.0374 (0.0424) loss_oracle 0.0654 (0.0687) acc 96.8750 (93.8281) kd_loss 0.4722 (0.4148) lr 1.5358e-03 eta 0:07:34
epoch [18/50] batch [100/132] time 0.104 (0.107) data 0.000 (0.009) loss 0.5031 (0.6513) ce_loss 0.0677 (0.1834) loss_zs_kd 0.0274 (0.0425) loss_oracle 0.0594 (0.0675) acc 100.0000 (94.1875) kd_loss 0.3920 (0.4129) lr 1.5358e-03 eta 0:07:36
epoch [18/50] batch [120/132] time 0.167 (0.109) data 0.000 (0.007) loss 0.6187 (0.6496) ce_loss 0.1604 (0.1846) loss_zs_kd 0.0348 (0.0432) loss_oracle 0.0820 (0.0668) acc 93.7500 (94.0365) kd_loss 0.3999 (0.4101) lr 1.5358e-03 eta 0:07:41
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,807
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.2%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,516
* accuracy: 89.5%
* error: 10.5%
* macro_f1: 92.0%
******* Domain s best val acc:      99.4%, epoch: 9 *******
******* Domain s best val test acc: 89.5%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [19/50] batch [20/132] time 0.085 (0.141) data 0.000 (0.046) loss 0.7761 (0.6910) ce_loss 0.2661 (0.2083) loss_zs_kd 0.0591 (0.0431) loss_oracle 0.0705 (0.0675) acc 90.6250 (93.2812) kd_loss 0.4452 (0.4275) lr 1.4818e-03 eta 0:09:53
epoch [19/50] batch [40/132] time 0.101 (0.114) data 0.000 (0.023) loss 0.3980 (0.6793) ce_loss 0.0143 (0.1783) loss_zs_kd 0.0126 (0.0418) loss_oracle 0.0837 (0.0767) acc 100.0000 (94.0625) kd_loss 0.3356 (0.4418) lr 1.4818e-03 eta 0:07:55
epoch [19/50] batch [60/132] time 0.068 (0.107) data 0.000 (0.016) loss 0.6659 (0.6780) ce_loss 0.2476 (0.1829) loss_zs_kd 0.0376 (0.0427) loss_oracle 0.0703 (0.0747) acc 90.6250 (93.8021) kd_loss 0.3643 (0.4364) lr 1.4818e-03 eta 0:07:24
epoch [19/50] batch [80/132] time 0.094 (0.102) data 0.000 (0.012) loss 0.5831 (0.6718) ce_loss 0.0713 (0.1751) loss_zs_kd 0.0362 (0.0422) loss_oracle 0.0614 (0.0717) acc 96.8750 (94.1797) kd_loss 0.4630 (0.4397) lr 1.4818e-03 eta 0:07:02
epoch [19/50] batch [100/132] time 0.096 (0.101) data 0.000 (0.009) loss 0.8856 (0.6738) ce_loss 0.3523 (0.1795) loss_zs_kd 0.0578 (0.0411) loss_oracle 0.1090 (0.0721) acc 90.6250 (94.1562) kd_loss 0.4499 (0.4378) lr 1.4818e-03 eta 0:06:54
epoch [19/50] batch [120/132] time 0.086 (0.100) data 0.000 (0.008) loss 0.8186 (0.6761) ce_loss 0.3269 (0.1843) loss_zs_kd 0.0584 (0.0422) loss_oracle 0.0817 (0.0736) acc 90.6250 (94.1406) kd_loss 0.4217 (0.4339) lr 1.4818e-03 eta 0:06:51
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,810
* accuracy: 99.4%
* error: 0.6%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,533
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 92.3%
******* Domain s best val acc:      99.4%, epoch: 9 *******
******* Domain s best val test acc: 89.5%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [20/50] batch [20/132] time 0.077 (0.136) data 0.000 (0.050) loss 0.4558 (0.6531) ce_loss 0.0325 (0.1735) loss_zs_kd 0.0264 (0.0385) loss_oracle 0.0477 (0.0600) acc 100.0000 (93.7500) kd_loss 0.3862 (0.4304) lr 1.4258e-03 eta 0:09:15
epoch [20/50] batch [40/132] time 0.085 (0.110) data 0.000 (0.025) loss 0.5971 (0.6364) ce_loss 0.1520 (0.1706) loss_zs_kd 0.0330 (0.0401) loss_oracle 0.0541 (0.0525) acc 93.7500 (94.3750) kd_loss 0.4016 (0.4195) lr 1.4258e-03 eta 0:07:25
epoch [20/50] batch [60/132] time 0.064 (0.100) data 0.000 (0.017) loss 0.7617 (0.6408) ce_loss 0.1780 (0.1658) loss_zs_kd 0.0659 (0.0416) loss_oracle 0.0559 (0.0503) acc 93.7500 (94.7917) kd_loss 0.5229 (0.4291) lr 1.4258e-03 eta 0:06:42
epoch [20/50] batch [80/132] time 0.069 (0.096) data 0.000 (0.013) loss 0.7116 (0.6456) ce_loss 0.2695 (0.1635) loss_zs_kd 0.0234 (0.0414) loss_oracle 0.0528 (0.0496) acc 90.6250 (94.8438) kd_loss 0.4039 (0.4366) lr 1.4258e-03 eta 0:06:23
epoch [20/50] batch [100/132] time 0.088 (0.094) data 0.000 (0.010) loss 0.8171 (0.6583) ce_loss 0.2494 (0.1686) loss_zs_kd 0.0398 (0.0420) loss_oracle 0.0320 (0.0478) acc 87.5000 (94.4688) kd_loss 0.5318 (0.4449) lr 1.4258e-03 eta 0:06:14
epoch [20/50] batch [120/132] time 0.085 (0.094) data 0.000 (0.009) loss 0.6269 (0.6659) ce_loss 0.0905 (0.1719) loss_zs_kd 0.0596 (0.0417) loss_oracle 0.0488 (0.0466) acc 96.8750 (94.3490) kd_loss 0.4822 (0.4499) lr 1.4258e-03 eta 0:06:12
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,810
* accuracy: 99.4%
* error: 0.6%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,535
* accuracy: 90.0%
* error: 10.0%
* macro_f1: 92.3%
******* Domain s best val acc:      99.4%, epoch: 9 *******
******* Domain s best val test acc: 89.5%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [21/50] batch [20/132] time 0.084 (0.137) data 0.000 (0.053) loss 0.8781 (0.7350) ce_loss 0.1986 (0.2034) loss_zs_kd 0.0401 (0.0488) loss_oracle 0.0639 (0.0592) acc 90.6250 (92.9688) kd_loss 0.6275 (0.4776) lr 1.3681e-03 eta 0:09:00
epoch [21/50] batch [40/132] time 0.084 (0.111) data 0.000 (0.026) loss 0.5753 (0.7170) ce_loss 0.0690 (0.1858) loss_zs_kd 0.0367 (0.0476) loss_oracle 0.0665 (0.0612) acc 100.0000 (93.4375) kd_loss 0.4547 (0.4769) lr 1.3681e-03 eta 0:07:13
epoch [21/50] batch [60/132] time 0.078 (0.111) data 0.000 (0.018) loss 0.6744 (0.7181) ce_loss 0.1876 (0.1862) loss_zs_kd 0.0538 (0.0464) loss_oracle 0.0453 (0.0605) acc 96.8750 (93.4896) kd_loss 0.4373 (0.4786) lr 1.3681e-03 eta 0:07:14
epoch [21/50] batch [80/132] time 0.079 (0.113) data 0.000 (0.013) loss 0.8950 (0.7057) ce_loss 0.3940 (0.1838) loss_zs_kd 0.0519 (0.0455) loss_oracle 0.0449 (0.0560) acc 87.5000 (93.7109) kd_loss 0.4526 (0.4712) lr 1.3681e-03 eta 0:07:17
epoch [21/50] batch [100/132] time 0.094 (0.113) data 0.000 (0.011) loss 0.8180 (0.7108) ce_loss 0.2676 (0.1896) loss_zs_kd 0.0513 (0.0471) loss_oracle 0.0389 (0.0528) acc 90.6250 (93.4688) kd_loss 0.5053 (0.4713) lr 1.3681e-03 eta 0:07:17
epoch [21/50] batch [120/132] time 0.073 (0.114) data 0.000 (0.009) loss 0.7059 (0.7083) ce_loss 0.1907 (0.1902) loss_zs_kd 0.0342 (0.0467) loss_oracle 0.0461 (0.0517) acc 93.7500 (93.4115) kd_loss 0.4751 (0.4689) lr 1.3681e-03 eta 0:07:17
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,811
* accuracy: 99.5%
* error: 0.5%
* macro_f1: 99.4%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,523
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 92.2%
******* Domain s best val acc:      99.5%, epoch: 21 *******
******* Domain s best val test acc: 89.7%, epoch: 21 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [22/50] batch [20/132] time 0.094 (0.155) data 0.000 (0.054) loss 0.9030 (0.6622) ce_loss 0.3687 (0.1664) loss_zs_kd 0.0239 (0.0466) loss_oracle 0.0473 (0.0448) acc 87.5000 (94.5312) kd_loss 0.4987 (0.4501) lr 1.3090e-03 eta 0:09:51
epoch [22/50] batch [40/132] time 0.096 (0.127) data 0.000 (0.027) loss 0.6576 (0.6538) ce_loss 0.2209 (0.1744) loss_zs_kd 0.0515 (0.0425) loss_oracle 0.0316 (0.0414) acc 90.6250 (94.3750) kd_loss 0.3952 (0.4374) lr 1.3090e-03 eta 0:07:59
epoch [22/50] batch [60/132] time 0.099 (0.118) data 0.000 (0.018) loss 0.5316 (0.6504) ce_loss 0.0799 (0.1757) loss_zs_kd 0.0247 (0.0444) loss_oracle 0.0404 (0.0389) acc 93.7500 (94.3750) kd_loss 0.4191 (0.4331) lr 1.3090e-03 eta 0:07:25
epoch [22/50] batch [80/132] time 0.096 (0.114) data 0.000 (0.014) loss 0.6416 (0.6623) ce_loss 0.1821 (0.1759) loss_zs_kd 0.0470 (0.0423) loss_oracle 0.0448 (0.0399) acc 93.7500 (94.1406) kd_loss 0.4136 (0.4453) lr 1.3090e-03 eta 0:07:08
epoch [22/50] batch [100/132] time 0.097 (0.112) data 0.000 (0.011) loss 0.5303 (0.6610) ce_loss 0.0326 (0.1691) loss_zs_kd 0.0704 (0.0426) loss_oracle 0.0375 (0.0406) acc 100.0000 (94.4062) kd_loss 0.4438 (0.4503) lr 1.3090e-03 eta 0:06:55
epoch [22/50] batch [120/132] time 0.093 (0.110) data 0.000 (0.009) loss 0.7400 (0.6678) ce_loss 0.2585 (0.1700) loss_zs_kd 0.0411 (0.0430) loss_oracle 0.0473 (0.0426) acc 90.6250 (94.3750) kd_loss 0.4372 (0.4550) lr 1.3090e-03 eta 0:06:47
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,811
* accuracy: 99.5%
* error: 0.5%
* macro_f1: 99.4%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,519
* accuracy: 89.6%
* error: 10.4%
* macro_f1: 92.0%
******* Domain s best val acc:      99.5%, epoch: 21 *******
******* Domain s best val test acc: 89.7%, epoch: 21 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [23/50] batch [20/132] time 0.111 (0.156) data 0.000 (0.052) loss 1.0018 (0.7684) ce_loss 0.4021 (0.2024) loss_zs_kd 0.0273 (0.0426) loss_oracle 0.0629 (0.0604) acc 84.3750 (92.3438) kd_loss 0.5546 (0.5146) lr 1.2487e-03 eta 0:09:33
epoch [23/50] batch [40/132] time 0.097 (0.129) data 0.000 (0.026) loss 0.8023 (0.7663) ce_loss 0.1375 (0.1975) loss_zs_kd 0.0267 (0.0375) loss_oracle 0.0482 (0.0586) acc 96.8750 (92.8906) kd_loss 0.6274 (0.5207) lr 1.2487e-03 eta 0:07:50
epoch [23/50] batch [60/132] time 0.101 (0.121) data 0.000 (0.018) loss 0.6754 (0.7643) ce_loss 0.0786 (0.1863) loss_zs_kd 0.0319 (0.0355) loss_oracle 0.0439 (0.0555) acc 96.8750 (93.4896) kd_loss 0.5590 (0.5324) lr 1.2487e-03 eta 0:07:18
epoch [23/50] batch [80/132] time 0.096 (0.116) data 0.000 (0.013) loss 0.7103 (0.7796) ce_loss 0.1129 (0.1913) loss_zs_kd 0.0325 (0.0379) loss_oracle 0.0378 (0.0521) acc 96.8750 (93.5547) kd_loss 0.5622 (0.5433) lr 1.2487e-03 eta 0:06:57
epoch [23/50] batch [100/132] time 0.087 (0.109) data 0.000 (0.011) loss 0.5829 (0.7691) ce_loss 0.0235 (0.1882) loss_zs_kd 0.0214 (0.0379) loss_oracle 0.0395 (0.0482) acc 100.0000 (93.5938) kd_loss 0.5289 (0.5379) lr 1.2487e-03 eta 0:06:31
epoch [23/50] batch [120/132] time 0.074 (0.105) data 0.000 (0.009) loss 0.6131 (0.7692) ce_loss 0.1229 (0.1906) loss_zs_kd 0.0390 (0.0398) loss_oracle 0.0344 (0.0469) acc 93.7500 (93.5677) kd_loss 0.4536 (0.5353) lr 1.2487e-03 eta 0:06:14
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,810
* accuracy: 99.4%
* error: 0.6%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,522
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 92.1%
******* Domain s best val acc:      99.5%, epoch: 21 *******
******* Domain s best val test acc: 89.7%, epoch: 21 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [24/50] batch [20/132] time 0.080 (0.166) data 0.000 (0.059) loss 0.6525 (0.7014) ce_loss 0.1775 (0.1898) loss_zs_kd 0.0925 (0.0458) loss_oracle 0.0456 (0.0401) acc 96.8750 (93.2812) kd_loss 0.4059 (0.4687) lr 1.1874e-03 eta 0:09:47
epoch [24/50] batch [40/132] time 0.072 (0.140) data 0.000 (0.030) loss 0.6400 (0.7013) ce_loss 0.1021 (0.1874) loss_zs_kd 0.0360 (0.0471) loss_oracle 0.0338 (0.0409) acc 93.7500 (93.3594) kd_loss 0.5030 (0.4699) lr 1.1874e-03 eta 0:08:12
epoch [24/50] batch [60/132] time 0.082 (0.132) data 0.001 (0.020) loss 0.8768 (0.7080) ce_loss 0.3264 (0.1863) loss_zs_kd 0.0220 (0.0476) loss_oracle 0.0594 (0.0399) acc 90.6250 (93.5938) kd_loss 0.5097 (0.4779) lr 1.1874e-03 eta 0:07:41
epoch [24/50] batch [80/132] time 0.162 (0.128) data 0.000 (0.015) loss 0.6682 (0.7175) ce_loss 0.1268 (0.1884) loss_zs_kd 0.0423 (0.0482) loss_oracle 0.0530 (0.0405) acc 96.8750 (93.5156) kd_loss 0.4937 (0.4848) lr 1.1874e-03 eta 0:07:27
epoch [24/50] batch [100/132] time 0.093 (0.125) data 0.000 (0.012) loss 0.7944 (0.7178) ce_loss 0.2942 (0.1790) loss_zs_kd 0.0604 (0.0492) loss_oracle 0.0555 (0.0423) acc 93.7500 (93.9375) kd_loss 0.4423 (0.4930) lr 1.1874e-03 eta 0:07:13
epoch [24/50] batch [120/132] time 0.072 (0.123) data 0.000 (0.010) loss 0.8331 (0.7251) ce_loss 0.1439 (0.1753) loss_zs_kd 0.0777 (0.0468) loss_oracle 0.0708 (0.0456) acc 93.7500 (94.0104) kd_loss 0.6149 (0.5036) lr 1.1874e-03 eta 0:07:05
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,809
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,507
* accuracy: 89.3%
* error: 10.7%
* macro_f1: 91.7%
******* Domain s best val acc:      99.5%, epoch: 21 *******
******* Domain s best val test acc: 89.7%, epoch: 21 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [25/50] batch [20/132] time 0.100 (0.156) data 0.000 (0.054) loss 0.6932 (0.7629) ce_loss 0.1385 (0.1615) loss_zs_kd 0.0390 (0.0371) loss_oracle 0.0458 (0.0595) acc 100.0000 (95.3125) kd_loss 0.5123 (0.5532) lr 1.1253e-03 eta 0:08:51
epoch [25/50] batch [40/132] time 0.102 (0.129) data 0.000 (0.027) loss 0.7558 (0.7411) ce_loss 0.2360 (0.1693) loss_zs_kd 0.0252 (0.0371) loss_oracle 0.0688 (0.0572) acc 90.6250 (94.6875) kd_loss 0.4728 (0.5246) lr 1.1253e-03 eta 0:07:17
epoch [25/50] batch [60/132] time 0.097 (0.120) data 0.001 (0.018) loss 0.8622 (0.7334) ce_loss 0.2852 (0.1674) loss_zs_kd 0.0648 (0.0399) loss_oracle 0.0957 (0.0616) acc 87.5000 (94.7917) kd_loss 0.4968 (0.5152) lr 1.1253e-03 eta 0:06:44
epoch [25/50] batch [80/132] time 0.103 (0.115) data 0.000 (0.014) loss 0.6530 (0.7313) ce_loss 0.1233 (0.1697) loss_zs_kd 0.0462 (0.0393) loss_oracle 0.0523 (0.0619) acc 96.8750 (94.6094) kd_loss 0.4804 (0.5110) lr 1.1253e-03 eta 0:06:26
epoch [25/50] batch [100/132] time 0.102 (0.112) data 0.000 (0.011) loss 0.6623 (0.7333) ce_loss 0.1210 (0.1695) loss_zs_kd 0.0605 (0.0404) loss_oracle 0.0608 (0.0614) acc 93.7500 (94.6250) kd_loss 0.4806 (0.5129) lr 1.1253e-03 eta 0:06:14
epoch [25/50] batch [120/132] time 0.093 (0.110) data 0.000 (0.009) loss 0.7719 (0.7323) ce_loss 0.2064 (0.1724) loss_zs_kd 0.0394 (0.0415) loss_oracle 0.0633 (0.0609) acc 93.7500 (94.4531) kd_loss 0.5141 (0.5088) lr 1.1253e-03 eta 0:06:04
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,809
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,508
* accuracy: 89.3%
* error: 10.7%
* macro_f1: 91.7%
******* Domain s best val acc:      99.5%, epoch: 21 *******
******* Domain s best val test acc: 89.7%, epoch: 21 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [26/50] batch [20/132] time 0.100 (0.158) data 0.000 (0.054) loss 0.7233 (0.6461) ce_loss 0.1299 (0.1415) loss_zs_kd 0.0300 (0.0366) loss_oracle 0.0528 (0.0580) acc 93.7500 (95.3125) kd_loss 0.5520 (0.4573) lr 1.0628e-03 eta 0:08:38
epoch [26/50] batch [40/132] time 0.097 (0.129) data 0.001 (0.027) loss 0.8909 (0.7067) ce_loss 0.3806 (0.1858) loss_zs_kd 0.0436 (0.0397) loss_oracle 0.0512 (0.0575) acc 87.5000 (93.9062) kd_loss 0.4629 (0.4723) lr 1.0628e-03 eta 0:07:01
epoch [26/50] batch [60/132] time 0.089 (0.117) data 0.000 (0.018) loss 0.6896 (0.7143) ce_loss 0.2150 (0.1972) loss_zs_kd 0.0361 (0.0404) loss_oracle 0.0610 (0.0589) acc 93.7500 (93.4375) kd_loss 0.4261 (0.4674) lr 1.0628e-03 eta 0:06:19
epoch [26/50] batch [80/132] time 0.085 (0.110) data 0.000 (0.014) loss 0.7423 (0.7167) ce_loss 0.1104 (0.1977) loss_zs_kd 0.0725 (0.0430) loss_oracle 0.0537 (0.0586) acc 96.8750 (93.3594) kd_loss 0.5688 (0.4683) lr 1.0628e-03 eta 0:05:55
epoch [26/50] batch [100/132] time 0.080 (0.105) data 0.000 (0.011) loss 0.6167 (0.7213) ce_loss 0.1168 (0.1978) loss_zs_kd 0.0213 (0.0421) loss_oracle 0.0552 (0.0574) acc 93.7500 (93.4062) kd_loss 0.4617 (0.4738) lr 1.0628e-03 eta 0:05:36
epoch [26/50] batch [120/132] time 0.075 (0.107) data 0.000 (0.009) loss 0.5907 (0.7216) ce_loss 0.1021 (0.1963) loss_zs_kd 0.0197 (0.0414) loss_oracle 0.0527 (0.0558) acc 100.0000 (93.3854) kd_loss 0.4524 (0.4767) lr 1.0628e-03 eta 0:05:39
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,813
* accuracy: 99.6%
* error: 0.4%
* macro_f1: 99.5%
Checkpoint saved to icml/multi-dg/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,506
* accuracy: 89.3%
* error: 10.7%
* macro_f1: 91.8%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [27/50] batch [20/132] time 0.074 (0.166) data 0.000 (0.056) loss 0.6625 (0.7388) ce_loss 0.1510 (0.1910) loss_zs_kd 0.0154 (0.0418) loss_oracle 0.0490 (0.0469) acc 96.8750 (92.9688) kd_loss 0.4793 (0.5034) lr 1.0000e-03 eta 0:08:44
epoch [27/50] batch [40/132] time 0.079 (0.140) data 0.000 (0.028) loss 0.5619 (0.7395) ce_loss 0.0971 (0.1813) loss_zs_kd 0.0248 (0.0423) loss_oracle 0.0696 (0.0514) acc 96.8750 (93.6719) kd_loss 0.4176 (0.5114) lr 1.0000e-03 eta 0:07:18
epoch [27/50] batch [60/132] time 0.064 (0.131) data 0.000 (0.019) loss 0.6963 (0.7485) ce_loss 0.0386 (0.1817) loss_zs_kd 0.0439 (0.0420) loss_oracle 0.0652 (0.0538) acc 100.0000 (93.6979) kd_loss 0.6031 (0.5190) lr 1.0000e-03 eta 0:06:47
epoch [27/50] batch [80/132] time 0.076 (0.123) data 0.000 (0.014) loss 0.6563 (0.7486) ce_loss 0.1136 (0.1765) loss_zs_kd 0.0704 (0.0426) loss_oracle 0.0579 (0.0520) acc 96.8750 (93.7891) kd_loss 0.4786 (0.5248) lr 1.0000e-03 eta 0:06:19
epoch [27/50] batch [100/132] time 0.164 (0.119) data 0.000 (0.011) loss 0.7941 (0.7592) ce_loss 0.2069 (0.1827) loss_zs_kd 0.0174 (0.0420) loss_oracle 0.0661 (0.0533) acc 90.6250 (93.5938) kd_loss 0.5454 (0.5288) lr 1.0000e-03 eta 0:06:03
epoch [27/50] batch [120/132] time 0.060 (0.110) data 0.000 (0.010) loss 0.7216 (0.7608) ce_loss 0.1160 (0.1818) loss_zs_kd 0.0408 (0.0416) loss_oracle 0.0576 (0.0551) acc 96.8750 (93.8021) kd_loss 0.5564 (0.5306) lr 1.0000e-03 eta 0:05:35
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,812
* accuracy: 99.5%
* error: 0.5%
* macro_f1: 99.4%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,522
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 92.1%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [28/50] batch [20/132] time 0.094 (0.166) data 0.000 (0.066) loss 0.7626 (0.7535) ce_loss 0.1259 (0.1682) loss_zs_kd 0.0531 (0.0453) loss_oracle 0.0292 (0.0518) acc 96.8750 (94.8438) kd_loss 0.5956 (0.5367) lr 9.3721e-04 eta 0:08:20
epoch [28/50] batch [40/132] time 0.112 (0.133) data 0.000 (0.033) loss 0.8899 (0.7859) ce_loss 0.2283 (0.1779) loss_zs_kd 0.0875 (0.0475) loss_oracle 0.0491 (0.0532) acc 90.6250 (94.2969) kd_loss 0.5933 (0.5576) lr 9.3721e-04 eta 0:06:39
epoch [28/50] batch [60/132] time 0.101 (0.123) data 0.000 (0.022) loss 0.5861 (0.7959) ce_loss 0.0284 (0.1799) loss_zs_kd 0.0220 (0.0460) loss_oracle 0.0529 (0.0540) acc 100.0000 (94.0625) kd_loss 0.5203 (0.5661) lr 9.3721e-04 eta 0:06:06
epoch [28/50] batch [80/132] time 0.099 (0.118) data 0.000 (0.017) loss 1.1640 (0.7960) ce_loss 0.5151 (0.1817) loss_zs_kd 0.0593 (0.0451) loss_oracle 0.0887 (0.0558) acc 81.2500 (93.9453) kd_loss 0.5748 (0.5638) lr 9.3721e-04 eta 0:05:49
epoch [28/50] batch [100/132] time 0.103 (0.115) data 0.000 (0.013) loss 0.7430 (0.7815) ce_loss 0.1284 (0.1719) loss_zs_kd 0.0578 (0.0452) loss_oracle 0.0492 (0.0588) acc 96.8750 (94.4688) kd_loss 0.5611 (0.5577) lr 9.3721e-04 eta 0:05:36
epoch [28/50] batch [120/132] time 0.094 (0.112) data 0.000 (0.011) loss 0.7919 (0.7777) ce_loss 0.1610 (0.1720) loss_zs_kd 0.0456 (0.0449) loss_oracle 0.0564 (0.0614) acc 93.7500 (94.4531) kd_loss 0.5799 (0.5525) lr 9.3721e-04 eta 0:05:27
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,810
* accuracy: 99.4%
* error: 0.6%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,518
* accuracy: 89.6%
* error: 10.4%
* macro_f1: 92.0%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [29/50] batch [20/132] time 0.095 (0.157) data 0.000 (0.061) loss 0.7905 (0.7922) ce_loss 0.1746 (0.1743) loss_zs_kd 0.0289 (0.0381) loss_oracle 0.0782 (0.0688) acc 90.6250 (93.9062) kd_loss 0.5624 (0.5644) lr 8.7467e-04 eta 0:07:33
epoch [29/50] batch [40/132] time 0.091 (0.126) data 0.003 (0.031) loss 0.6408 (0.8223) ce_loss 0.0634 (0.2044) loss_zs_kd 0.0533 (0.0404) loss_oracle 0.0659 (0.0691) acc 96.8750 (93.2031) kd_loss 0.5179 (0.5631) lr 8.7467e-04 eta 0:06:01
epoch [29/50] batch [60/132] time 0.089 (0.114) data 0.000 (0.021) loss 0.9978 (0.8068) ce_loss 0.2869 (0.1864) loss_zs_kd 0.0391 (0.0416) loss_oracle 0.0732 (0.0702) acc 87.5000 (93.6458) kd_loss 0.6548 (0.5645) lr 8.7467e-04 eta 0:05:24
epoch [29/50] batch [80/132] time 0.089 (0.107) data 0.000 (0.016) loss 0.7260 (0.8069) ce_loss 0.0462 (0.1827) loss_zs_kd 0.0523 (0.0444) loss_oracle 0.0990 (0.0727) acc 100.0000 (93.9062) kd_loss 0.6041 (0.5656) lr 8.7467e-04 eta 0:05:01
epoch [29/50] batch [100/132] time 0.068 (0.103) data 0.000 (0.013) loss 0.8145 (0.8041) ce_loss 0.2386 (0.1810) loss_zs_kd 0.0476 (0.0439) loss_oracle 0.0749 (0.0757) acc 93.7500 (93.8438) kd_loss 0.5146 (0.5632) lr 8.7467e-04 eta 0:04:48
epoch [29/50] batch [120/132] time 0.067 (0.102) data 0.000 (0.011) loss 0.8235 (0.8040) ce_loss 0.2323 (0.1795) loss_zs_kd 0.0300 (0.0429) loss_oracle 0.0819 (0.0771) acc 93.7500 (94.0625) kd_loss 0.5353 (0.5645) lr 8.7467e-04 eta 0:04:43
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,811
* accuracy: 99.5%
* error: 0.5%
* macro_f1: 99.4%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,516
* accuracy: 89.5%
* error: 10.5%
* macro_f1: 92.0%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [30/50] batch [20/132] time 0.119 (0.162) data 0.000 (0.066) loss 0.7660 (0.8116) ce_loss 0.1017 (0.1663) loss_zs_kd 0.0419 (0.0463) loss_oracle 0.0783 (0.0789) acc 96.8750 (95.1562) kd_loss 0.6042 (0.5827) lr 8.1262e-04 eta 0:07:26
epoch [30/50] batch [40/132] time 0.157 (0.140) data 0.000 (0.033) loss 0.6008 (0.8312) ce_loss 0.0351 (0.1791) loss_zs_kd 0.0450 (0.0465) loss_oracle 0.0883 (0.0811) acc 100.0000 (94.2969) kd_loss 0.4991 (0.5883) lr 8.1262e-04 eta 0:06:22
epoch [30/50] batch [60/132] time 0.148 (0.130) data 0.000 (0.022) loss 1.0413 (0.8451) ce_loss 0.2954 (0.1877) loss_zs_kd 0.0636 (0.0488) loss_oracle 0.1031 (0.0801) acc 90.6250 (93.8021) kd_loss 0.6625 (0.5929) lr 8.1262e-04 eta 0:05:51
epoch [30/50] batch [80/132] time 0.147 (0.126) data 0.000 (0.017) loss 0.8428 (0.8411) ce_loss 0.2051 (0.1877) loss_zs_kd 0.0433 (0.0481) loss_oracle 0.0724 (0.0808) acc 90.6250 (93.7500) kd_loss 0.5799 (0.5890) lr 8.1262e-04 eta 0:05:39
epoch [30/50] batch [100/132] time 0.150 (0.122) data 0.000 (0.013) loss 0.8609 (0.8305) ce_loss 0.3208 (0.1828) loss_zs_kd 0.0230 (0.0475) loss_oracle 0.0849 (0.0799) acc 90.6250 (94.0938) kd_loss 0.4861 (0.5840) lr 8.1262e-04 eta 0:05:27
epoch [30/50] batch [120/132] time 0.073 (0.115) data 0.000 (0.011) loss 0.6976 (0.8271) ce_loss 0.1960 (0.1846) loss_zs_kd 0.0413 (0.0472) loss_oracle 0.0827 (0.0784) acc 93.7500 (93.9062) kd_loss 0.4395 (0.5797) lr 8.1262e-04 eta 0:05:04
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,809
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,531
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 92.3%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [31/50] batch [20/132] time 0.092 (0.162) data 0.000 (0.063) loss 0.9194 (0.7963) ce_loss 0.2512 (0.1965) loss_zs_kd 0.0309 (0.0471) loss_oracle 0.0830 (0.0844) acc 93.7500 (93.9062) kd_loss 0.6113 (0.5340) lr 7.5131e-04 eta 0:07:04
epoch [31/50] batch [40/132] time 0.092 (0.129) data 0.000 (0.032) loss 0.8719 (0.7957) ce_loss 0.1749 (0.1936) loss_zs_kd 0.0402 (0.0458) loss_oracle 0.1025 (0.0836) acc 93.7500 (93.6719) kd_loss 0.6257 (0.5374) lr 7.5131e-04 eta 0:05:35
epoch [31/50] batch [60/132] time 0.102 (0.118) data 0.000 (0.021) loss 0.9210 (0.7979) ce_loss 0.3289 (0.1909) loss_zs_kd 0.0360 (0.0468) loss_oracle 0.1199 (0.0955) acc 87.5000 (93.6458) kd_loss 0.5143 (0.5358) lr 7.5131e-04 eta 0:05:04
epoch [31/50] batch [80/132] time 0.094 (0.114) data 0.000 (0.016) loss 0.7906 (0.7946) ce_loss 0.0995 (0.1828) loss_zs_kd 0.0199 (0.0444) loss_oracle 0.1291 (0.0986) acc 93.7500 (93.7891) kd_loss 0.6165 (0.5403) lr 7.5131e-04 eta 0:04:51
epoch [31/50] batch [100/132] time 0.105 (0.112) data 0.000 (0.013) loss 0.6950 (0.7980) ce_loss 0.0624 (0.1808) loss_zs_kd 0.0258 (0.0443) loss_oracle 0.0680 (0.0978) acc 96.8750 (93.8438) kd_loss 0.5857 (0.5461) lr 7.5131e-04 eta 0:04:44
epoch [31/50] batch [120/132] time 0.096 (0.110) data 0.000 (0.011) loss 0.8578 (0.8021) ce_loss 0.2717 (0.1812) loss_zs_kd 0.0231 (0.0445) loss_oracle 0.0670 (0.0934) acc 93.7500 (93.9062) kd_loss 0.5410 (0.5520) lr 7.5131e-04 eta 0:04:36
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,809
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,529
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 92.3%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [32/50] batch [20/132] time 0.078 (0.161) data 0.000 (0.067) loss 0.7574 (0.7654) ce_loss 0.1066 (0.1662) loss_zs_kd 0.0392 (0.0478) loss_oracle 0.0783 (0.0733) acc 96.8750 (94.2188) kd_loss 0.5920 (0.5386) lr 6.9098e-04 eta 0:06:40
epoch [32/50] batch [40/132] time 0.082 (0.122) data 0.000 (0.034) loss 0.8595 (0.8010) ce_loss 0.1930 (0.1787) loss_zs_kd 0.0478 (0.0462) loss_oracle 0.0743 (0.0793) acc 93.7500 (93.9844) kd_loss 0.6055 (0.5596) lr 6.9098e-04 eta 0:05:02
epoch [32/50] batch [60/132] time 0.090 (0.111) data 0.000 (0.023) loss 0.7238 (0.8085) ce_loss 0.0807 (0.1800) loss_zs_kd 0.0319 (0.0452) loss_oracle 0.0874 (0.0822) acc 100.0000 (94.0104) kd_loss 0.5835 (0.5648) lr 6.9098e-04 eta 0:04:31
epoch [32/50] batch [80/132] time 0.078 (0.110) data 0.000 (0.017) loss 0.9712 (0.8109) ce_loss 0.2500 (0.1770) loss_zs_kd 0.0786 (0.0454) loss_oracle 0.0715 (0.0846) acc 90.6250 (94.1016) kd_loss 0.6462 (0.5689) lr 6.9098e-04 eta 0:04:26
epoch [32/50] batch [100/132] time 0.082 (0.108) data 0.000 (0.014) loss 0.8563 (0.8233) ce_loss 0.1720 (0.1818) loss_zs_kd 0.0831 (0.0465) loss_oracle 0.0866 (0.0858) acc 93.7500 (94.0000) kd_loss 0.5994 (0.5754) lr 6.9098e-04 eta 0:04:20
epoch [32/50] batch [120/132] time 0.069 (0.109) data 0.000 (0.011) loss 0.5993 (0.8310) ce_loss 0.0390 (0.1872) loss_zs_kd 0.0411 (0.0466) loss_oracle 0.0540 (0.0848) acc 100.0000 (93.6719) kd_loss 0.5127 (0.5781) lr 6.9098e-04 eta 0:04:19
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,811
* accuracy: 99.5%
* error: 0.5%
* macro_f1: 99.4%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,518
* accuracy: 89.6%
* error: 10.4%
* macro_f1: 92.1%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [33/50] batch [20/132] time 0.071 (0.180) data 0.000 (0.067) loss 0.7668 (0.8335) ce_loss 0.1388 (0.1822) loss_zs_kd 0.0169 (0.0541) loss_oracle 0.1110 (0.0809) acc 93.7500 (93.4375) kd_loss 0.5641 (0.5838) lr 6.3188e-04 eta 0:07:03
epoch [33/50] batch [40/132] time 0.165 (0.141) data 0.000 (0.034) loss 0.6916 (0.8349) ce_loss 0.1409 (0.1764) loss_zs_kd 0.0287 (0.0510) loss_oracle 0.1073 (0.0804) acc 93.7500 (93.6719) kd_loss 0.4827 (0.5927) lr 6.3188e-04 eta 0:05:29
epoch [33/50] batch [60/132] time 0.158 (0.130) data 0.000 (0.023) loss 0.8933 (0.8373) ce_loss 0.1946 (0.1732) loss_zs_kd 0.0547 (0.0487) loss_oracle 0.1038 (0.0821) acc 93.7500 (93.9583) kd_loss 0.6195 (0.5986) lr 6.3188e-04 eta 0:05:02
epoch [33/50] batch [80/132] time 0.064 (0.117) data 0.000 (0.017) loss 0.8834 (0.8341) ce_loss 0.2092 (0.1651) loss_zs_kd 0.0473 (0.0481) loss_oracle 0.0577 (0.0853) acc 90.6250 (94.4141) kd_loss 0.6217 (0.6022) lr 6.3188e-04 eta 0:04:29
epoch [33/50] batch [100/132] time 0.085 (0.109) data 0.000 (0.014) loss 0.8072 (0.8408) ce_loss 0.1603 (0.1721) loss_zs_kd 0.0403 (0.0482) loss_oracle 0.1174 (0.0882) acc 93.7500 (94.2188) kd_loss 0.5680 (0.6005) lr 6.3188e-04 eta 0:04:08
epoch [33/50] batch [120/132] time 0.082 (0.106) data 0.000 (0.011) loss 0.8340 (0.8436) ce_loss 0.1936 (0.1775) loss_zs_kd 0.0349 (0.0473) loss_oracle 0.0751 (0.0880) acc 93.7500 (93.9844) kd_loss 0.5854 (0.5984) lr 6.3188e-04 eta 0:03:58
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,812
* accuracy: 99.5%
* error: 0.5%
* macro_f1: 99.4%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,505
* accuracy: 89.2%
* error: 10.8%
* macro_f1: 91.9%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [34/50] batch [20/132] time 0.097 (0.164) data 0.000 (0.065) loss 0.9487 (0.8293) ce_loss 0.2003 (0.1554) loss_zs_kd 0.0280 (0.0457) loss_oracle 0.0607 (0.0591) acc 90.6250 (94.8438) kd_loss 0.7041 (0.6216) lr 5.7422e-04 eta 0:06:05
epoch [34/50] batch [40/132] time 0.100 (0.132) data 0.000 (0.032) loss 0.9123 (0.8277) ce_loss 0.2622 (0.1577) loss_zs_kd 0.0357 (0.0475) loss_oracle 0.0723 (0.0593) acc 87.5000 (94.8438) kd_loss 0.5961 (0.6166) lr 5.7422e-04 eta 0:04:50
epoch [34/50] batch [60/132] time 0.105 (0.121) data 0.000 (0.022) loss 0.8480 (0.8188) ce_loss 0.1738 (0.1510) loss_zs_kd 0.0208 (0.0465) loss_oracle 0.0679 (0.0591) acc 93.7500 (95.1042) kd_loss 0.6298 (0.6150) lr 5.7422e-04 eta 0:04:25
epoch [34/50] batch [80/132] time 0.093 (0.116) data 0.000 (0.016) loss 0.7176 (0.8289) ce_loss 0.0471 (0.1595) loss_zs_kd 0.0438 (0.0463) loss_oracle 0.0787 (0.0608) acc 100.0000 (94.8047) kd_loss 0.6092 (0.6159) lr 5.7422e-04 eta 0:04:10
epoch [34/50] batch [100/132] time 0.099 (0.113) data 0.000 (0.013) loss 1.1266 (0.8409) ce_loss 0.3618 (0.1668) loss_zs_kd 0.0263 (0.0459) loss_oracle 0.0630 (0.0639) acc 87.5000 (94.4375) kd_loss 0.7202 (0.6192) lr 5.7422e-04 eta 0:04:02
epoch [34/50] batch [120/132] time 0.097 (0.111) data 0.000 (0.011) loss 0.9682 (0.8450) ce_loss 0.2440 (0.1709) loss_zs_kd 0.0605 (0.0462) loss_oracle 0.0538 (0.0648) acc 93.7500 (94.3750) kd_loss 0.6670 (0.6186) lr 5.7422e-04 eta 0:03:54
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,812
* accuracy: 99.5%
* error: 0.5%
* macro_f1: 99.5%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,521
* accuracy: 89.6%
* error: 10.4%
* macro_f1: 92.2%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [35/50] batch [20/132] time 0.136 (0.149) data 0.000 (0.061) loss 1.0996 (0.8517) ce_loss 0.4038 (0.1815) loss_zs_kd 0.0412 (0.0398) loss_oracle 0.0968 (0.0744) acc 84.3750 (93.7500) kd_loss 0.6268 (0.6131) lr 5.1825e-04 eta 0:05:11
epoch [35/50] batch [40/132] time 0.148 (0.134) data 0.000 (0.031) loss 0.9343 (0.8632) ce_loss 0.1177 (0.1726) loss_zs_kd 0.0663 (0.0395) loss_oracle 0.1168 (0.0755) acc 100.0000 (94.6875) kd_loss 0.7250 (0.6331) lr 5.1825e-04 eta 0:04:37
epoch [35/50] batch [60/132] time 0.155 (0.127) data 0.000 (0.021) loss 0.8514 (0.8775) ce_loss 0.1503 (0.1772) loss_zs_kd 0.0442 (0.0395) loss_oracle 0.0662 (0.0772) acc 93.7500 (94.4271) kd_loss 0.6459 (0.6419) lr 5.1825e-04 eta 0:04:21
epoch [35/50] batch [80/132] time 0.077 (0.119) data 0.000 (0.015) loss 0.8988 (0.8753) ce_loss 0.1725 (0.1741) loss_zs_kd 0.0387 (0.0407) loss_oracle 0.0835 (0.0782) acc 93.7500 (94.4922) kd_loss 0.6652 (0.6418) lr 5.1825e-04 eta 0:04:01
epoch [35/50] batch [100/132] time 0.063 (0.109) data 0.000 (0.012) loss 0.8109 (0.8685) ce_loss 0.1216 (0.1693) loss_zs_kd 0.0337 (0.0416) loss_oracle 0.0728 (0.0770) acc 96.8750 (94.4688) kd_loss 0.6361 (0.6399) lr 5.1825e-04 eta 0:03:39
epoch [35/50] batch [120/132] time 0.078 (0.103) data 0.000 (0.010) loss 0.8533 (0.8625) ce_loss 0.2092 (0.1683) loss_zs_kd 0.0649 (0.0419) loss_oracle 0.0776 (0.0772) acc 90.6250 (94.3750) kd_loss 0.5728 (0.6347) lr 5.1825e-04 eta 0:03:25
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,811
* accuracy: 99.5%
* error: 0.5%
* macro_f1: 99.4%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,533
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 92.4%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [36/50] batch [20/132] time 0.075 (0.185) data 0.000 (0.072) loss 0.8662 (0.8486) ce_loss 0.1692 (0.1665) loss_zs_kd 0.0451 (0.0463) loss_oracle 0.0733 (0.0822) acc 90.6250 (94.2188) kd_loss 0.6378 (0.6179) lr 4.6417e-04 eta 0:06:01
epoch [36/50] batch [40/132] time 0.084 (0.141) data 0.000 (0.036) loss 0.8657 (0.8556) ce_loss 0.0916 (0.1629) loss_zs_kd 0.0496 (0.0447) loss_oracle 0.0986 (0.0942) acc 96.8750 (94.2188) kd_loss 0.7000 (0.6232) lr 4.6417e-04 eta 0:04:33
epoch [36/50] batch [60/132] time 0.082 (0.122) data 0.000 (0.024) loss 0.8516 (0.8517) ce_loss 0.1649 (0.1659) loss_zs_kd 0.0371 (0.0443) loss_oracle 0.1118 (0.0976) acc 93.7500 (94.0104) kd_loss 0.6122 (0.6149) lr 4.6417e-04 eta 0:03:53
epoch [36/50] batch [80/132] time 0.110 (0.116) data 0.000 (0.018) loss 0.6322 (0.8468) ce_loss 0.0385 (0.1644) loss_zs_kd 0.0312 (0.0435) loss_oracle 0.1172 (0.0989) acc 100.0000 (94.1797) kd_loss 0.5195 (0.6113) lr 4.6417e-04 eta 0:03:40
epoch [36/50] batch [100/132] time 0.095 (0.113) data 0.000 (0.015) loss 0.9713 (0.8494) ce_loss 0.3230 (0.1667) loss_zs_kd 0.0639 (0.0434) loss_oracle 0.0737 (0.0968) acc 90.6250 (94.1562) kd_loss 0.5795 (0.6127) lr 4.6417e-04 eta 0:03:31
epoch [36/50] batch [120/132] time 0.092 (0.111) data 0.000 (0.012) loss 0.8599 (0.8515) ce_loss 0.1494 (0.1680) loss_zs_kd 0.0319 (0.0448) loss_oracle 0.1195 (0.0961) acc 93.7500 (94.1146) kd_loss 0.6347 (0.6131) lr 4.6417e-04 eta 0:03:26
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,811
* accuracy: 99.5%
* error: 0.5%
* macro_f1: 99.4%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,533
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 92.4%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [37/50] batch [20/132] time 0.117 (0.168) data 0.000 (0.069) loss 1.2271 (0.8843) ce_loss 0.4768 (0.1962) loss_zs_kd 0.0859 (0.0450) loss_oracle 0.0827 (0.0761) acc 81.2500 (93.1250) kd_loss 0.6660 (0.6275) lr 4.1221e-04 eta 0:05:07
epoch [37/50] batch [40/132] time 0.098 (0.134) data 0.000 (0.035) loss 0.8355 (0.8858) ce_loss 0.1309 (0.1951) loss_zs_kd 0.0261 (0.0442) loss_oracle 0.0991 (0.0793) acc 96.8750 (93.4375) kd_loss 0.6420 (0.6289) lr 4.1221e-04 eta 0:04:02
epoch [37/50] batch [60/132] time 0.100 (0.123) data 0.000 (0.023) loss 0.7971 (0.8875) ce_loss 0.0888 (0.1861) loss_zs_kd 0.0343 (0.0446) loss_oracle 0.0856 (0.0811) acc 96.8750 (93.8542) kd_loss 0.6483 (0.6385) lr 4.1221e-04 eta 0:03:39
epoch [37/50] batch [80/132] time 0.106 (0.116) data 0.000 (0.017) loss 0.8595 (0.8903) ce_loss 0.0828 (0.1845) loss_zs_kd 0.0676 (0.0453) loss_oracle 0.1109 (0.0845) acc 100.0000 (93.9844) kd_loss 0.6874 (0.6409) lr 4.1221e-04 eta 0:03:25
epoch [37/50] batch [100/132] time 0.096 (0.113) data 0.000 (0.014) loss 1.0648 (0.8913) ce_loss 0.2688 (0.1848) loss_zs_kd 0.0311 (0.0445) loss_oracle 0.1051 (0.0859) acc 93.7500 (94.0312) kd_loss 0.7279 (0.6414) lr 4.1221e-04 eta 0:03:17
epoch [37/50] batch [120/132] time 0.094 (0.111) data 0.000 (0.012) loss 0.8867 (0.8930) ce_loss 0.0598 (0.1819) loss_zs_kd 0.0375 (0.0451) loss_oracle 0.1061 (0.0865) acc 100.0000 (94.0365) kd_loss 0.7550 (0.6453) lr 4.1221e-04 eta 0:03:11
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,811
* accuracy: 99.5%
* error: 0.5%
* macro_f1: 99.4%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,514
* accuracy: 89.5%
* error: 10.5%
* macro_f1: 92.0%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [38/50] batch [20/132] time 0.080 (0.177) data 0.000 (0.087) loss 1.0119 (0.9113) ce_loss 0.3442 (0.1770) loss_zs_kd 0.0599 (0.0415) loss_oracle 0.1024 (0.0872) acc 84.3750 (93.7500) kd_loss 0.5865 (0.6700) lr 3.6258e-04 eta 0:05:00
epoch [38/50] batch [40/132] time 0.084 (0.131) data 0.000 (0.044) loss 0.8704 (0.9255) ce_loss 0.1534 (0.1921) loss_zs_kd 0.0258 (0.0427) loss_oracle 0.0791 (0.0847) acc 93.7500 (92.8906) kd_loss 0.6645 (0.6697) lr 3.6258e-04 eta 0:03:39
epoch [38/50] batch [60/132] time 0.075 (0.115) data 0.001 (0.029) loss 0.8196 (0.9084) ce_loss 0.1643 (0.1832) loss_zs_kd 0.0698 (0.0418) loss_oracle 0.0958 (0.0867) acc 96.8750 (93.3854) kd_loss 0.5725 (0.6610) lr 3.6258e-04 eta 0:03:10
epoch [38/50] batch [80/132] time 0.082 (0.110) data 0.000 (0.022) loss 0.7444 (0.9049) ce_loss 0.0938 (0.1816) loss_zs_kd 0.0274 (0.0426) loss_oracle 0.0839 (0.0872) acc 96.8750 (93.4375) kd_loss 0.5949 (0.6584) lr 3.6258e-04 eta 0:03:00
epoch [38/50] batch [100/132] time 0.077 (0.111) data 0.000 (0.018) loss 0.7932 (0.8985) ce_loss 0.1120 (0.1791) loss_zs_kd 0.0409 (0.0430) loss_oracle 0.0898 (0.0868) acc 96.8750 (93.5938) kd_loss 0.6158 (0.6545) lr 3.6258e-04 eta 0:02:59
epoch [38/50] batch [120/132] time 0.126 (0.112) data 0.000 (0.015) loss 0.9795 (0.8990) ce_loss 0.1805 (0.1771) loss_zs_kd 0.0741 (0.0436) loss_oracle 0.0882 (0.0858) acc 93.7500 (93.8281) kd_loss 0.7178 (0.6572) lr 3.6258e-04 eta 0:02:58
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,812
* accuracy: 99.5%
* error: 0.5%
* macro_f1: 99.5%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,520
* accuracy: 89.6%
* error: 10.4%
* macro_f1: 92.1%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [39/50] batch [20/132] time 0.095 (0.181) data 0.000 (0.079) loss 0.9263 (0.8355) ce_loss 0.1869 (0.1448) loss_zs_kd 0.0433 (0.0400) loss_oracle 0.0769 (0.0716) acc 93.7500 (95.0000) kd_loss 0.6793 (0.6349) lr 3.1545e-04 eta 0:04:42
epoch [39/50] batch [40/132] time 0.102 (0.141) data 0.000 (0.040) loss 0.9990 (0.8675) ce_loss 0.2396 (0.1635) loss_zs_kd 0.0534 (0.0440) loss_oracle 0.0733 (0.0772) acc 87.5000 (94.2188) kd_loss 0.6960 (0.6434) lr 3.1545e-04 eta 0:03:37
epoch [39/50] batch [60/132] time 0.102 (0.128) data 0.000 (0.027) loss 0.8391 (0.8864) ce_loss 0.1487 (0.1758) loss_zs_kd 0.0557 (0.0479) loss_oracle 0.0767 (0.0790) acc 93.7500 (93.6979) kd_loss 0.6242 (0.6472) lr 3.1545e-04 eta 0:03:14
epoch [39/50] batch [80/132] time 0.111 (0.124) data 0.000 (0.020) loss 0.8177 (0.8933) ce_loss 0.0536 (0.1747) loss_zs_kd 0.0356 (0.0460) loss_oracle 0.0840 (0.0800) acc 100.0000 (93.9453) kd_loss 0.7043 (0.6556) lr 3.1545e-04 eta 0:03:05
epoch [39/50] batch [100/132] time 0.109 (0.119) data 0.000 (0.016) loss 0.8510 (0.8973) ce_loss 0.2345 (0.1746) loss_zs_kd 0.0492 (0.0442) loss_oracle 0.0721 (0.0820) acc 96.8750 (94.0938) kd_loss 0.5558 (0.6596) lr 3.1545e-04 eta 0:02:57
epoch [39/50] batch [120/132] time 0.097 (0.116) data 0.000 (0.013) loss 0.9237 (0.9026) ce_loss 0.1366 (0.1713) loss_zs_kd 0.0317 (0.0442) loss_oracle 0.0700 (0.0826) acc 96.8750 (94.1667) kd_loss 0.7363 (0.6679) lr 3.1545e-04 eta 0:02:49
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,812
* accuracy: 99.5%
* error: 0.5%
* macro_f1: 99.5%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,516
* accuracy: 89.5%
* error: 10.5%
* macro_f1: 92.0%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [40/50] batch [20/132] time 0.097 (0.178) data 0.000 (0.084) loss 0.9822 (0.9450) ce_loss 0.1649 (0.1838) loss_zs_kd 0.0458 (0.0415) loss_oracle 0.0907 (0.0909) acc 93.7500 (94.3750) kd_loss 0.7491 (0.6950) lr 2.7103e-04 eta 0:04:15
epoch [40/50] batch [40/132] time 0.108 (0.138) data 0.000 (0.042) loss 0.9407 (0.9375) ce_loss 0.1774 (0.1731) loss_zs_kd 0.0579 (0.0425) loss_oracle 0.0844 (0.0911) acc 90.6250 (94.3750) kd_loss 0.6922 (0.6976) lr 2.7103e-04 eta 0:03:14
epoch [40/50] batch [60/132] time 0.082 (0.121) data 0.000 (0.028) loss 0.9374 (0.9240) ce_loss 0.2281 (0.1636) loss_zs_kd 0.0496 (0.0436) loss_oracle 0.1023 (0.0923) acc 90.6250 (94.8958) kd_loss 0.6333 (0.6925) lr 2.7103e-04 eta 0:02:48
epoch [40/50] batch [80/132] time 0.079 (0.111) data 0.001 (0.021) loss 1.0140 (0.9295) ce_loss 0.1473 (0.1668) loss_zs_kd 0.0459 (0.0443) loss_oracle 0.1035 (0.0925) acc 93.7500 (94.7266) kd_loss 0.7919 (0.6943) lr 2.7103e-04 eta 0:02:31
epoch [40/50] batch [100/132] time 0.075 (0.104) data 0.000 (0.017) loss 1.0567 (0.9348) ce_loss 0.2205 (0.1688) loss_zs_kd 0.0342 (0.0429) loss_oracle 0.1010 (0.0933) acc 93.7500 (94.5938) kd_loss 0.7686 (0.6979) lr 2.7103e-04 eta 0:02:20
epoch [40/50] batch [120/132] time 0.132 (0.100) data 0.000 (0.014) loss 0.8881 (0.9300) ce_loss 0.0912 (0.1666) loss_zs_kd 0.0381 (0.0425) loss_oracle 0.0836 (0.0936) acc 96.8750 (94.7135) kd_loss 0.7361 (0.6953) lr 2.7103e-04 eta 0:02:12
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,812
* accuracy: 99.5%
* error: 0.5%
* macro_f1: 99.5%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,504
* accuracy: 89.2%
* error: 10.8%
* macro_f1: 91.8%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [41/50] batch [20/132] time 0.161 (0.176) data 0.000 (0.064) loss 0.9882 (0.9789) ce_loss 0.2031 (0.2089) loss_zs_kd 0.0541 (0.0435) loss_oracle 0.0896 (0.0974) acc 87.5000 (91.7188) kd_loss 0.7132 (0.6996) lr 2.2949e-04 eta 0:03:48
epoch [41/50] batch [40/132] time 0.159 (0.143) data 0.000 (0.032) loss 1.2424 (0.9632) ce_loss 0.3882 (0.1920) loss_zs_kd 0.0561 (0.0423) loss_oracle 0.0746 (0.0969) acc 81.2500 (92.9688) kd_loss 0.7889 (0.7016) lr 2.2949e-04 eta 0:03:03
epoch [41/50] batch [60/132] time 0.081 (0.132) data 0.000 (0.022) loss 1.0653 (0.9684) ce_loss 0.3064 (0.1869) loss_zs_kd 0.0504 (0.0429) loss_oracle 0.0883 (0.0955) acc 93.7500 (93.0729) kd_loss 0.6895 (0.7124) lr 2.2949e-04 eta 0:02:46
epoch [41/50] batch [80/132] time 0.167 (0.127) data 0.000 (0.016) loss 0.8758 (0.9689) ce_loss 0.0548 (0.1815) loss_zs_kd 0.0329 (0.0447) loss_oracle 0.0967 (0.0953) acc 100.0000 (93.6328) kd_loss 0.7562 (0.7174) lr 2.2949e-04 eta 0:02:36
epoch [41/50] batch [100/132] time 0.167 (0.123) data 0.000 (0.013) loss 0.9366 (0.9733) ce_loss 0.1702 (0.1850) loss_zs_kd 0.0455 (0.0447) loss_oracle 0.0765 (0.0942) acc 96.8750 (93.5625) kd_loss 0.7054 (0.7189) lr 2.2949e-04 eta 0:02:30
epoch [41/50] batch [120/132] time 0.065 (0.119) data 0.000 (0.011) loss 0.9086 (0.9701) ce_loss 0.0975 (0.1810) loss_zs_kd 0.0386 (0.0445) loss_oracle 0.0948 (0.0942) acc 96.8750 (93.8021) kd_loss 0.7443 (0.7197) lr 2.2949e-04 eta 0:02:22
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,813
* accuracy: 99.6%
* error: 0.4%
* macro_f1: 99.5%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,512
* accuracy: 89.4%
* error: 10.6%
* macro_f1: 92.0%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [42/50] batch [20/132] time 0.097 (0.165) data 0.000 (0.065) loss 0.9746 (0.9714) ce_loss 0.1428 (0.1909) loss_zs_kd 0.0434 (0.0390) loss_oracle 0.0861 (0.1011) acc 96.8750 (94.2188) kd_loss 0.7671 (0.7105) lr 1.9098e-04 eta 0:03:12
epoch [42/50] batch [40/132] time 0.089 (0.132) data 0.000 (0.033) loss 0.8278 (0.9527) ce_loss 0.0446 (0.1723) loss_zs_kd 0.0420 (0.0406) loss_oracle 0.0912 (0.1004) acc 100.0000 (94.9219) kd_loss 0.7165 (0.7100) lr 1.9098e-04 eta 0:02:31
epoch [42/50] batch [60/132] time 0.097 (0.121) data 0.000 (0.022) loss 0.8872 (0.9625) ce_loss 0.1639 (0.1761) loss_zs_kd 0.0413 (0.0442) loss_oracle 0.0691 (0.0991) acc 93.7500 (94.4271) kd_loss 0.6680 (0.7148) lr 1.9098e-04 eta 0:02:16
epoch [42/50] batch [80/132] time 0.108 (0.115) data 0.000 (0.017) loss 0.9639 (0.9540) ce_loss 0.1615 (0.1686) loss_zs_kd 0.0440 (0.0440) loss_oracle 0.0768 (0.0974) acc 93.7500 (94.4922) kd_loss 0.7421 (0.7147) lr 1.9098e-04 eta 0:02:07
epoch [42/50] batch [100/132] time 0.109 (0.112) data 0.000 (0.013) loss 0.8451 (0.9538) ce_loss 0.1633 (0.1710) loss_zs_kd 0.0472 (0.0441) loss_oracle 0.1075 (0.0961) acc 93.7500 (94.5000) kd_loss 0.6045 (0.7128) lr 1.9098e-04 eta 0:02:02
epoch [42/50] batch [120/132] time 0.100 (0.110) data 0.000 (0.011) loss 0.9410 (0.9507) ce_loss 0.1479 (0.1719) loss_zs_kd 0.0535 (0.0449) loss_oracle 0.1073 (0.0947) acc 96.8750 (94.4531) kd_loss 0.7126 (0.7090) lr 1.9098e-04 eta 0:01:57
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,813
* accuracy: 99.6%
* error: 0.4%
* macro_f1: 99.5%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,511
* accuracy: 89.4%
* error: 10.6%
* macro_f1: 91.9%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [43/50] batch [20/132] time 0.090 (0.181) data 0.000 (0.079) loss 0.8610 (0.9963) ce_loss 0.1685 (0.2047) loss_zs_kd 0.0337 (0.0472) loss_oracle 0.0936 (0.0975) acc 90.6250 (92.3438) kd_loss 0.6289 (0.7192) lr 1.5567e-04 eta 0:03:07
epoch [43/50] batch [40/132] time 0.091 (0.137) data 0.000 (0.040) loss 0.8926 (0.9552) ce_loss 0.1787 (0.1805) loss_zs_kd 0.0761 (0.0432) loss_oracle 0.0965 (0.0968) acc 96.8750 (94.0625) kd_loss 0.6276 (0.7047) lr 1.5567e-04 eta 0:02:18
epoch [43/50] batch [60/132] time 0.084 (0.120) data 0.000 (0.027) loss 1.0458 (0.9544) ce_loss 0.2874 (0.1868) loss_zs_kd 0.0553 (0.0439) loss_oracle 0.0858 (0.0992) acc 90.6250 (93.6979) kd_loss 0.6879 (0.6960) lr 1.5567e-04 eta 0:01:59
epoch [43/50] batch [80/132] time 0.089 (0.112) data 0.000 (0.020) loss 0.8304 (0.9473) ce_loss 0.0811 (0.1827) loss_zs_kd 0.0304 (0.0460) loss_oracle 0.1114 (0.0995) acc 96.8750 (93.8281) kd_loss 0.6784 (0.6919) lr 1.5567e-04 eta 0:01:49
epoch [43/50] batch [100/132] time 0.160 (0.112) data 0.000 (0.016) loss 1.1034 (0.9513) ce_loss 0.1909 (0.1839) loss_zs_kd 0.0353 (0.0461) loss_oracle 0.1252 (0.0995) acc 93.7500 (93.9062) kd_loss 0.8322 (0.6946) lr 1.5567e-04 eta 0:01:47
epoch [43/50] batch [120/132] time 0.169 (0.113) data 0.000 (0.013) loss 0.8656 (0.9521) ce_loss 0.1185 (0.1830) loss_zs_kd 0.0487 (0.0465) loss_oracle 0.1010 (0.0987) acc 96.8750 (93.8021) kd_loss 0.6723 (0.6965) lr 1.5567e-04 eta 0:01:45
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,813
* accuracy: 99.6%
* error: 0.4%
* macro_f1: 99.5%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,522
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 92.2%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [44/50] batch [20/132] time 0.093 (0.219) data 0.000 (0.103) loss 1.1033 (0.9474) ce_loss 0.2279 (0.1563) loss_zs_kd 0.0429 (0.0485) loss_oracle 0.1123 (0.0931) acc 90.6250 (95.1562) kd_loss 0.7978 (0.7203) lr 1.2369e-04 eta 0:03:17
epoch [44/50] batch [40/132] time 0.074 (0.161) data 0.000 (0.052) loss 0.8509 (0.9669) ce_loss 0.0602 (0.1639) loss_zs_kd 0.0429 (0.0484) loss_oracle 0.1461 (0.1013) acc 100.0000 (94.8438) kd_loss 0.6963 (0.7281) lr 1.2369e-04 eta 0:02:22
epoch [44/50] batch [60/132] time 0.080 (0.143) data 0.000 (0.034) loss 0.9927 (0.9790) ce_loss 0.1647 (0.1765) loss_zs_kd 0.0448 (0.0480) loss_oracle 0.0808 (0.1036) acc 96.8750 (94.2708) kd_loss 0.7652 (0.7267) lr 1.2369e-04 eta 0:02:03
epoch [44/50] batch [80/132] time 0.083 (0.131) data 0.000 (0.026) loss 1.0659 (0.9796) ce_loss 0.1400 (0.1738) loss_zs_kd 0.0454 (0.0481) loss_oracle 0.1144 (0.1046) acc 96.8750 (94.4922) kd_loss 0.8460 (0.7295) lr 1.2369e-04 eta 0:01:50
epoch [44/50] batch [100/132] time 0.088 (0.122) data 0.001 (0.021) loss 0.9840 (0.9744) ce_loss 0.1569 (0.1708) loss_zs_kd 0.0543 (0.0475) loss_oracle 0.1196 (0.1059) acc 93.7500 (94.5625) kd_loss 0.7402 (0.7269) lr 1.2369e-04 eta 0:01:40
epoch [44/50] batch [120/132] time 0.092 (0.118) data 0.000 (0.017) loss 1.1351 (0.9812) ce_loss 0.4182 (0.1734) loss_zs_kd 0.0402 (0.0475) loss_oracle 0.1124 (0.1051) acc 90.6250 (94.4271) kd_loss 0.6406 (0.7316) lr 1.2369e-04 eta 0:01:34
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,813
* accuracy: 99.6%
* error: 0.4%
* macro_f1: 99.5%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,524
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 92.2%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [45/50] batch [20/132] time 0.097 (0.190) data 0.000 (0.090) loss 1.0374 (0.9844) ce_loss 0.1769 (0.1777) loss_zs_kd 0.0577 (0.0502) loss_oracle 0.0978 (0.1046) acc 93.7500 (94.2188) kd_loss 0.7827 (0.7293) lr 9.5173e-05 eta 0:02:26
epoch [45/50] batch [40/132] time 0.108 (0.146) data 0.000 (0.045) loss 0.9679 (0.9801) ce_loss 0.1608 (0.1605) loss_zs_kd 0.0791 (0.0493) loss_oracle 0.1181 (0.1039) acc 96.8750 (95.1562) kd_loss 0.7085 (0.7431) lr 9.5173e-05 eta 0:01:49
epoch [45/50] batch [60/132] time 0.111 (0.131) data 0.000 (0.030) loss 0.8024 (0.9792) ce_loss 0.0093 (0.1668) loss_zs_kd 0.0430 (0.0477) loss_oracle 0.1123 (0.1046) acc 100.0000 (95.0000) kd_loss 0.7155 (0.7362) lr 9.5173e-05 eta 0:01:35
epoch [45/50] batch [80/132] time 0.098 (0.123) data 0.000 (0.023) loss 0.8317 (0.9913) ce_loss 0.0421 (0.1752) loss_zs_kd 0.0558 (0.0499) loss_oracle 0.0825 (0.1027) acc 100.0000 (94.4531) kd_loss 0.7204 (0.7399) lr 9.5173e-05 eta 0:01:27
epoch [45/50] batch [100/132] time 0.098 (0.118) data 0.000 (0.018) loss 0.9232 (0.9947) ce_loss 0.1307 (0.1771) loss_zs_kd 0.0163 (0.0497) loss_oracle 0.1015 (0.1025) acc 96.8750 (94.2188) kd_loss 0.7335 (0.7414) lr 9.5173e-05 eta 0:01:21
epoch [45/50] batch [120/132] time 0.091 (0.114) data 0.000 (0.015) loss 0.8571 (0.9933) ce_loss 0.1160 (0.1787) loss_zs_kd 0.0494 (0.0509) loss_oracle 0.1143 (0.1040) acc 96.8750 (94.1406) kd_loss 0.6592 (0.7371) lr 9.5173e-05 eta 0:01:16
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,813
* accuracy: 99.6%
* error: 0.4%
* macro_f1: 99.5%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,526
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 92.2%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [46/50] batch [20/132] time 0.084 (0.170) data 0.000 (0.083) loss 0.9914 (0.9771) ce_loss 0.0919 (0.1594) loss_zs_kd 0.0338 (0.0506) loss_oracle 0.1271 (0.1021) acc 96.8750 (95.0000) kd_loss 0.8190 (0.7413) lr 7.0224e-05 eta 0:01:48
epoch [46/50] batch [40/132] time 0.071 (0.138) data 0.000 (0.041) loss 1.2008 (0.9900) ce_loss 0.2947 (0.1659) loss_zs_kd 0.0768 (0.0475) loss_oracle 0.1164 (0.1042) acc 84.3750 (94.3750) kd_loss 0.8095 (0.7483) lr 7.0224e-05 eta 0:01:25
epoch [46/50] batch [60/132] time 0.086 (0.123) data 0.000 (0.028) loss 0.7490 (0.9864) ce_loss 0.0563 (0.1708) loss_zs_kd 0.0201 (0.0468) loss_oracle 0.0973 (0.1059) acc 100.0000 (94.1146) kd_loss 0.6341 (0.7393) lr 7.0224e-05 eta 0:01:13
epoch [46/50] batch [80/132] time 0.080 (0.114) data 0.000 (0.021) loss 0.9686 (0.9836) ce_loss 0.1946 (0.1693) loss_zs_kd 0.0215 (0.0469) loss_oracle 0.0856 (0.1068) acc 96.8750 (94.1016) kd_loss 0.7205 (0.7374) lr 7.0224e-05 eta 0:01:06
epoch [46/50] batch [100/132] time 0.073 (0.109) data 0.000 (0.017) loss 0.8610 (0.9749) ce_loss 0.0900 (0.1648) loss_zs_kd 0.0268 (0.0458) loss_oracle 0.1097 (0.1065) acc 96.8750 (94.1875) kd_loss 0.7027 (0.7340) lr 7.0224e-05 eta 0:01:00
epoch [46/50] batch [120/132] time 0.138 (0.108) data 0.000 (0.014) loss 0.9794 (0.9795) ce_loss 0.1909 (0.1687) loss_zs_kd 0.0216 (0.0459) loss_oracle 0.1281 (0.1072) acc 93.7500 (94.0625) kd_loss 0.7137 (0.7342) lr 7.0224e-05 eta 0:00:58
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,813
* accuracy: 99.6%
* error: 0.4%
* macro_f1: 99.5%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,523
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 92.2%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [47/50] batch [20/132] time 0.083 (0.174) data 0.000 (0.088) loss 0.9455 (0.9969) ce_loss 0.0894 (0.1738) loss_zs_kd 0.0271 (0.0446) loss_oracle 0.1102 (0.1073) acc 100.0000 (94.3750) kd_loss 0.7875 (0.7471) lr 4.8943e-05 eta 0:01:28
epoch [47/50] batch [40/132] time 0.104 (0.135) data 0.000 (0.044) loss 0.8017 (1.0144) ce_loss 0.0670 (0.1868) loss_zs_kd 0.0227 (0.0473) loss_oracle 0.1082 (0.1077) acc 100.0000 (93.2031) kd_loss 0.6693 (0.7502) lr 4.8943e-05 eta 0:01:05
epoch [47/50] batch [60/132] time 0.104 (0.123) data 0.000 (0.030) loss 0.9287 (1.0173) ce_loss 0.0554 (0.1895) loss_zs_kd 0.0477 (0.0468) loss_oracle 0.0845 (0.1073) acc 100.0000 (93.4375) kd_loss 0.8072 (0.7507) lr 4.8943e-05 eta 0:00:57
epoch [47/50] batch [80/132] time 0.100 (0.117) data 0.000 (0.022) loss 1.3099 (1.0179) ce_loss 0.5044 (0.1879) loss_zs_kd 0.0432 (0.0472) loss_oracle 0.1017 (0.1084) acc 84.3750 (93.5938) kd_loss 0.7331 (0.7523) lr 4.8943e-05 eta 0:00:52
epoch [47/50] batch [100/132] time 0.106 (0.114) data 0.000 (0.018) loss 1.1048 (1.0077) ce_loss 0.2732 (0.1850) loss_zs_kd 0.0766 (0.0465) loss_oracle 0.0934 (0.1081) acc 90.6250 (93.6250) kd_loss 0.7466 (0.7454) lr 4.8943e-05 eta 0:00:48
epoch [47/50] batch [120/132] time 0.092 (0.111) data 0.000 (0.015) loss 1.1411 (1.0031) ce_loss 0.2433 (0.1802) loss_zs_kd 0.0463 (0.0476) loss_oracle 0.1031 (0.1085) acc 93.7500 (93.7760) kd_loss 0.8231 (0.7448) lr 4.8943e-05 eta 0:00:45
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,813
* accuracy: 99.6%
* error: 0.4%
* macro_f1: 99.5%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,523
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 92.2%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [48/50] batch [20/132] time 0.107 (0.204) data 0.000 (0.099) loss 0.8645 (0.9797) ce_loss 0.0563 (0.1744) loss_zs_kd 0.0468 (0.0484) loss_oracle 0.1133 (0.1040) acc 100.0000 (93.5938) kd_loss 0.7281 (0.7291) lr 3.1417e-05 eta 0:01:16
epoch [48/50] batch [40/132] time 0.089 (0.152) data 0.000 (0.049) loss 1.2464 (0.9633) ce_loss 0.3901 (0.1601) loss_zs_kd 0.0726 (0.0489) loss_oracle 0.0859 (0.1070) acc 84.3750 (94.4531) kd_loss 0.7770 (0.7253) lr 3.1417e-05 eta 0:00:54
epoch [48/50] batch [60/132] time 0.099 (0.134) data 0.000 (0.033) loss 0.9847 (0.9584) ce_loss 0.1445 (0.1595) loss_zs_kd 0.0281 (0.0468) loss_oracle 0.0922 (0.1053) acc 93.7500 (94.4271) kd_loss 0.7800 (0.7229) lr 3.1417e-05 eta 0:00:44
epoch [48/50] batch [80/132] time 0.098 (0.125) data 0.000 (0.025) loss 0.8170 (0.9653) ce_loss 0.1089 (0.1667) loss_zs_kd 0.0201 (0.0464) loss_oracle 0.1022 (0.1079) acc 96.8750 (94.3359) kd_loss 0.6470 (0.7215) lr 3.1417e-05 eta 0:00:39
epoch [48/50] batch [100/132] time 0.078 (0.117) data 0.000 (0.020) loss 0.9733 (0.9664) ce_loss 0.1783 (0.1692) loss_zs_kd 0.0406 (0.0462) loss_oracle 0.0801 (0.1076) acc 93.7500 (94.3750) kd_loss 0.7346 (0.7203) lr 3.1417e-05 eta 0:00:34
epoch [48/50] batch [120/132] time 0.071 (0.111) data 0.000 (0.017) loss 0.9264 (0.9740) ce_loss 0.0813 (0.1752) loss_zs_kd 0.0424 (0.0462) loss_oracle 0.1291 (0.1078) acc 100.0000 (94.1667) kd_loss 0.7594 (0.7218) lr 3.1417e-05 eta 0:00:30
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,813
* accuracy: 99.6%
* error: 0.4%
* macro_f1: 99.5%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,524
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 92.2%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [49/50] batch [20/132] time 0.090 (0.164) data 0.000 (0.079) loss 1.0988 (0.9942) ce_loss 0.2874 (0.1845) loss_zs_kd 0.0455 (0.0407) loss_oracle 0.1008 (0.1104) acc 90.6250 (93.9062) kd_loss 0.7383 (0.7342) lr 1.7713e-05 eta 0:00:40
epoch [49/50] batch [40/132] time 0.166 (0.142) data 0.000 (0.039) loss 1.0826 (0.9926) ce_loss 0.2515 (0.1898) loss_zs_kd 0.0291 (0.0446) loss_oracle 0.1252 (0.1086) acc 90.6250 (93.2031) kd_loss 0.7539 (0.7262) lr 1.7713e-05 eta 0:00:31
epoch [49/50] batch [60/132] time 0.148 (0.138) data 0.000 (0.026) loss 1.0561 (0.9925) ce_loss 0.2744 (0.1895) loss_zs_kd 0.0628 (0.0434) loss_oracle 0.1280 (0.1087) acc 90.6250 (93.2292) kd_loss 0.6863 (0.7270) lr 1.7713e-05 eta 0:00:28
epoch [49/50] batch [80/132] time 0.092 (0.132) data 0.000 (0.020) loss 0.9462 (0.9835) ce_loss 0.1437 (0.1828) loss_zs_kd 0.0316 (0.0443) loss_oracle 0.0820 (0.1073) acc 93.7500 (93.4375) kd_loss 0.7458 (0.7249) lr 1.7713e-05 eta 0:00:24
epoch [49/50] batch [100/132] time 0.182 (0.128) data 0.000 (0.016) loss 0.9367 (0.9912) ce_loss 0.1376 (0.1875) loss_zs_kd 0.0564 (0.0458) loss_oracle 0.1091 (0.1090) acc 96.8750 (93.4688) kd_loss 0.7163 (0.7264) lr 1.7713e-05 eta 0:00:20
epoch [49/50] batch [120/132] time 0.148 (0.126) data 0.000 (0.013) loss 0.7395 (0.9903) ce_loss 0.0638 (0.1831) loss_zs_kd 0.0263 (0.0451) loss_oracle 0.1212 (0.1089) acc 100.0000 (93.6458) kd_loss 0.6020 (0.7302) lr 1.7713e-05 eta 0:00:18
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,813
* accuracy: 99.6%
* error: 0.4%
* macro_f1: 99.5%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,523
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 92.2%
******* Domain s best val acc:      99.6%, epoch: 26 *******
******* Domain s best val test acc: 89.3%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 3 *******
epoch [50/50] batch [20/132] time 0.087 (0.182) data 0.000 (0.082) loss 1.2926 (0.9885) ce_loss 0.5381 (0.1739) loss_zs_kd 0.0470 (0.0529) loss_oracle 0.1124 (0.1088) acc 81.2500 (93.7500) kd_loss 0.6748 (0.7338) lr 7.8853e-06 eta 0:00:20
epoch [50/50] batch [40/132] time 0.094 (0.140) data 0.000 (0.041) loss 0.9484 (0.9744) ce_loss 0.0809 (0.1428) loss_zs_kd 0.0269 (0.0471) loss_oracle 0.1067 (0.1091) acc 100.0000 (95.3125) kd_loss 0.8007 (0.7535) lr 7.8853e-06 eta 0:00:12
epoch [50/50] batch [60/132] time 0.108 (0.127) data 0.000 (0.027) loss 0.8892 (0.9837) ce_loss 0.0369 (0.1548) loss_zs_kd 0.0530 (0.0467) loss_oracle 0.1230 (0.1094) acc 100.0000 (94.5833) kd_loss 0.7643 (0.7508) lr 7.8853e-06 eta 0:00:09
epoch [50/50] batch [80/132] time 0.103 (0.120) data 0.000 (0.021) loss 0.9306 (0.9895) ce_loss 0.1215 (0.1595) loss_zs_kd 0.0572 (0.0470) loss_oracle 0.0940 (0.1057) acc 96.8750 (94.2578) kd_loss 0.7335 (0.7536) lr 7.8853e-06 eta 0:00:06
epoch [50/50] batch [100/132] time 0.080 (0.116) data 0.000 (0.017) loss 0.9806 (0.9876) ce_loss 0.0981 (0.1636) loss_zs_kd 0.0595 (0.0466) loss_oracle 0.1145 (0.1054) acc 96.8750 (94.3125) kd_loss 0.7955 (0.7479) lr 7.8853e-06 eta 0:00:03
epoch [50/50] batch [120/132] time 0.092 (0.113) data 0.000 (0.014) loss 0.8483 (0.9830) ce_loss 0.0631 (0.1636) loss_zs_kd 0.0302 (0.0470) loss_oracle 0.1005 (0.1055) acc 100.0000 (94.4010) kd_loss 0.7199 (0.7432) lr 7.8853e-06 eta 0:00:01
Evaluate on the *val* set
