Loading trainer: TRIP
Loading dataset: SPG_VLCS
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------
Dataset    SPG_VLCS
Source     ['caltech', 'pascal', 'sun']
Target     ['labelme']
# classes  5
# train_x  5,651
# val      2,422
# test     2,656
---------  ----------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/176] time 0.110 (0.144) data 0.000 (0.025) loss 0.3732 (0.5088) ce_loss 0.3728 (0.5074) loss_zs_kd 0.0000 (0.0000) loss_oracle -0.0002 (-0.0002) acc 81.2500 (80.9375) kd_loss 0.0005 (0.0015) lr 1.0000e-05 eta 0:20:59
epoch [1/50] batch [40/176] time 0.094 (0.127) data 0.001 (0.013) loss 0.5283 (0.5280) ce_loss 0.5278 (0.5272) loss_zs_kd 0.0000 (0.0000) loss_oracle -0.0001 (-0.0002) acc 81.2500 (80.7812) kd_loss 0.0005 (0.0009) lr 1.0000e-05 eta 0:18:29
epoch [1/50] batch [60/176] time 0.073 (0.116) data 0.000 (0.008) loss 0.5252 (0.5312) ce_loss 0.5239 (0.5304) loss_zs_kd 0.0001 (0.0000) loss_oracle -0.0002 (-0.0002) acc 78.1250 (81.1458) kd_loss 0.0013 (0.0009) lr 1.0000e-05 eta 0:16:56
epoch [1/50] batch [80/176] time 0.101 (0.112) data 0.000 (0.006) loss 0.4569 (0.5291) ce_loss 0.4556 (0.5281) loss_zs_kd 0.0001 (0.0001) loss_oracle -0.0002 (-0.0002) acc 87.5000 (81.6016) kd_loss 0.0013 (0.0010) lr 1.0000e-05 eta 0:16:18
epoch [1/50] batch [100/176] time 0.092 (0.108) data 0.000 (0.005) loss 0.3668 (0.5210) ce_loss 0.3657 (0.5200) loss_zs_kd 0.0003 (0.0001) loss_oracle -0.0002 (-0.0002) acc 87.5000 (82.0000) kd_loss 0.0010 (0.0011) lr 1.0000e-05 eta 0:15:42
epoch [1/50] batch [120/176] time 0.100 (0.106) data 0.000 (0.004) loss 0.2453 (0.5196) ce_loss 0.2440 (0.5185) loss_zs_kd 0.0003 (0.0001) loss_oracle -0.0001 (-0.0002) acc 93.7500 (81.9792) kd_loss 0.0012 (0.0011) lr 1.0000e-05 eta 0:15:22
epoch [1/50] batch [140/176] time 0.080 (0.106) data 0.000 (0.004) loss 0.6497 (0.5310) ce_loss 0.6479 (0.5298) loss_zs_kd 0.0005 (0.0002) loss_oracle -0.0002 (-0.0001) acc 78.1250 (81.5625) kd_loss 0.0015 (0.0012) lr 1.0000e-05 eta 0:15:17
epoch [1/50] batch [160/176] time 0.106 (0.103) data 0.000 (0.003) loss 0.3244 (0.5295) ce_loss 0.3215 (0.5282) loss_zs_kd 0.0003 (0.0002) loss_oracle -0.0000 (-0.0001) acc 87.5000 (81.4062) kd_loss 0.0027 (0.0012) lr 1.0000e-05 eta 0:14:53
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,071
* accuracy: 85.5%
* error: 14.5%
* macro_f1: 87.9%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,830
* accuracy: 68.9%
* error: 31.1%
* macro_f1: 61.5%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain l best val acc:      85.5%, epoch: 1 *******
******* Domain l best val test acc: 68.9%, epoch: 1 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/ana
epoch [2/50] batch [20/176] time 0.093 (0.117) data 0.000 (0.019) loss 0.5590 (0.5491) ce_loss 0.5200 (0.5220) loss_zs_kd 0.0687 (0.0475) loss_oracle 0.0008 (0.0003) acc 81.2500 (80.1562) kd_loss 0.0042 (0.0032) lr 2.0000e-03 eta 0:16:47
epoch [2/50] batch [40/176] time 0.088 (0.106) data 0.000 (0.010) loss 0.5482 (0.5204) ce_loss 0.5063 (0.4866) loss_zs_kd 0.0637 (0.0557) loss_oracle 0.0081 (0.0040) acc 78.1250 (82.0312) kd_loss 0.0059 (0.0039) lr 2.0000e-03 eta 0:15:11
epoch [2/50] batch [60/176] time 0.093 (0.102) data 0.000 (0.006) loss 0.4833 (0.5176) ce_loss 0.4324 (0.4758) loss_zs_kd 0.0621 (0.0644) loss_oracle 0.0141 (0.0070) acc 87.5000 (82.9688) kd_loss 0.0128 (0.0061) lr 2.0000e-03 eta 0:14:35
epoch [2/50] batch [80/176] time 0.099 (0.101) data 0.000 (0.005) loss 0.8208 (0.5193) ce_loss 0.6523 (0.4628) loss_zs_kd 0.0778 (0.0658) loss_oracle 0.0543 (0.0183) acc 81.2500 (83.1641) kd_loss 0.1023 (0.0146) lr 2.0000e-03 eta 0:14:23
epoch [2/50] batch [100/176] time 0.108 (0.100) data 0.000 (0.004) loss 1.0929 (0.5543) ce_loss 0.8101 (0.4619) loss_zs_kd 0.0752 (0.0686) loss_oracle 0.0524 (0.0233) acc 75.0000 (83.1562) kd_loss 0.2190 (0.0465) lr 2.0000e-03 eta 0:14:15
epoch [2/50] batch [120/176] time 0.102 (0.099) data 0.000 (0.003) loss 0.7596 (0.5903) ce_loss 0.4004 (0.4558) loss_zs_kd 0.0766 (0.0680) loss_oracle 0.1230 (0.0394) acc 87.5000 (83.4896) kd_loss 0.2595 (0.0809) lr 2.0000e-03 eta 0:14:01
epoch [2/50] batch [140/176] time 0.096 (0.098) data 0.000 (0.003) loss 0.5809 (0.6212) ce_loss 0.2369 (0.4484) loss_zs_kd 0.0417 (0.0702) loss_oracle 0.0703 (0.0446) acc 90.6250 (83.9509) kd_loss 0.2879 (0.1153) lr 2.0000e-03 eta 0:13:54
epoch [2/50] batch [160/176] time 0.107 (0.098) data 0.000 (0.003) loss 0.7941 (0.6548) ce_loss 0.2786 (0.4418) loss_zs_kd 0.0260 (0.0721) loss_oracle 0.1343 (0.0552) acc 93.7500 (84.1602) kd_loss 0.4354 (0.1493) lr 2.0000e-03 eta 0:13:50
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,168
* accuracy: 89.5%
* error: 10.5%
* macro_f1: 91.5%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,659
* accuracy: 62.5%
* error: 37.5%
* macro_f1: 59.5%
******* Domain l best val acc:      89.5%, epoch: 2 *******
******* Domain l best val test acc: 62.5%, epoch: 2 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [3/50] batch [20/176] time 0.061 (0.104) data 0.000 (0.019) loss 1.5110 (1.0434) ce_loss 0.7109 (0.4283) loss_zs_kd 0.1409 (0.0767) loss_oracle 0.1773 (0.1085) acc 68.7500 (83.9062) kd_loss 0.6410 (0.5225) lr 1.9980e-03 eta 0:14:39
epoch [3/50] batch [40/176] time 0.069 (0.106) data 0.000 (0.010) loss 1.1219 (1.0931) ce_loss 0.3240 (0.4214) loss_zs_kd 0.0823 (0.0750) loss_oracle 0.0770 (0.1345) acc 81.2500 (84.5312) kd_loss 0.7183 (0.5670) lr 1.9980e-03 eta 0:14:52
epoch [3/50] batch [60/176] time 0.077 (0.107) data 0.000 (0.007) loss 1.2629 (1.0864) ce_loss 0.5957 (0.3986) loss_zs_kd 0.0882 (0.0796) loss_oracle 0.0876 (0.1107) acc 81.2500 (85.9896) kd_loss 0.5793 (0.5927) lr 1.9980e-03 eta 0:15:01
epoch [3/50] batch [80/176] time 0.072 (0.108) data 0.000 (0.005) loss 0.9019 (1.0705) ce_loss 0.2571 (0.3866) loss_zs_kd 0.0577 (0.0790) loss_oracle 0.0451 (0.0957) acc 87.5000 (86.6797) kd_loss 0.5934 (0.5965) lr 1.9980e-03 eta 0:15:00
epoch [3/50] batch [100/176] time 0.070 (0.104) data 0.000 (0.004) loss 0.9397 (1.0773) ce_loss 0.3176 (0.3922) loss_zs_kd 0.0921 (0.0802) loss_oracle 0.0618 (0.0905) acc 90.6250 (86.5000) kd_loss 0.5451 (0.5997) lr 1.9980e-03 eta 0:14:27
epoch [3/50] batch [120/176] time 0.078 (0.103) data 0.000 (0.003) loss 1.0053 (1.0838) ce_loss 0.3247 (0.3924) loss_zs_kd 0.0956 (0.0791) loss_oracle 0.1081 (0.0952) acc 87.5000 (86.3281) kd_loss 0.5787 (0.6043) lr 1.9980e-03 eta 0:14:18
epoch [3/50] batch [140/176] time 0.084 (0.103) data 0.000 (0.003) loss 1.0077 (1.0884) ce_loss 0.2473 (0.3896) loss_zs_kd 0.0840 (0.0795) loss_oracle 0.1447 (0.0938) acc 93.7500 (86.3616) kd_loss 0.6460 (0.6121) lr 1.9980e-03 eta 0:14:19
epoch [3/50] batch [160/176] time 0.078 (0.103) data 0.000 (0.003) loss 1.1329 (1.1087) ce_loss 0.2993 (0.3939) loss_zs_kd 0.0902 (0.0814) loss_oracle 0.1086 (0.0985) acc 84.3750 (86.2305) kd_loss 0.7342 (0.6249) lr 1.9980e-03 eta 0:14:16
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,175
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 91.7%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,740
* accuracy: 65.5%
* error: 34.5%
* macro_f1: 60.4%
******* Domain l best val acc:      89.8%, epoch: 3 *******
******* Domain l best val test acc: 65.5%, epoch: 3 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [4/50] batch [20/176] time 0.097 (0.118) data 0.000 (0.022) loss 1.1543 (1.1905) ce_loss 0.2925 (0.4094) loss_zs_kd 0.0967 (0.0872) loss_oracle 0.0905 (0.0756) acc 93.7500 (86.2500) kd_loss 0.7682 (0.6997) lr 1.9921e-03 eta 0:16:15
epoch [4/50] batch [40/176] time 0.087 (0.106) data 0.000 (0.011) loss 1.1722 (1.1906) ce_loss 0.3428 (0.3870) loss_zs_kd 0.0750 (0.0822) loss_oracle 0.1380 (0.0988) acc 90.6250 (86.6406) kd_loss 0.7229 (0.7131) lr 1.9921e-03 eta 0:14:35
epoch [4/50] batch [60/176] time 0.109 (0.103) data 0.000 (0.007) loss 1.1796 (1.2104) ce_loss 0.3984 (0.3917) loss_zs_kd 0.0709 (0.0807) loss_oracle 0.1224 (0.1261) acc 78.1250 (86.2500) kd_loss 0.6845 (0.7152) lr 1.9921e-03 eta 0:14:04
epoch [4/50] batch [80/176] time 0.106 (0.102) data 0.000 (0.005) loss 1.2715 (1.2111) ce_loss 0.4436 (0.3897) loss_zs_kd 0.1175 (0.0804) loss_oracle 0.1207 (0.1200) acc 78.1250 (86.2109) kd_loss 0.7088 (0.7212) lr 1.9921e-03 eta 0:13:57
epoch [4/50] batch [100/176] time 0.083 (0.101) data 0.000 (0.004) loss 1.0001 (1.2238) ce_loss 0.2278 (0.3926) loss_zs_kd 0.0666 (0.0803) loss_oracle 0.1641 (0.1210) acc 90.6250 (85.8125) kd_loss 0.6569 (0.7305) lr 1.9921e-03 eta 0:13:47
epoch [4/50] batch [120/176] time 0.105 (0.100) data 0.000 (0.004) loss 1.1111 (1.2351) ce_loss 0.2040 (0.3972) loss_zs_kd 0.1151 (0.0843) loss_oracle 0.1869 (0.1274) acc 96.8750 (85.7812) kd_loss 0.7562 (0.7320) lr 1.9921e-03 eta 0:13:36
epoch [4/50] batch [140/176] time 0.090 (0.100) data 0.000 (0.003) loss 1.3807 (1.2407) ce_loss 0.5840 (0.3984) loss_zs_kd 0.1035 (0.0879) loss_oracle 0.1216 (0.1309) acc 81.2500 (85.7143) kd_loss 0.6842 (0.7330) lr 1.9921e-03 eta 0:13:30
epoch [4/50] batch [160/176] time 0.095 (0.099) data 0.000 (0.003) loss 1.0256 (1.2355) ce_loss 0.2659 (0.3958) loss_zs_kd 0.0867 (0.0871) loss_oracle 0.1299 (0.1265) acc 93.7500 (86.0156) kd_loss 0.6515 (0.7330) lr 1.9921e-03 eta 0:13:23
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,177
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 91.8%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,777
* accuracy: 66.9%
* error: 33.1%
* macro_f1: 61.2%
******* Domain l best val acc:      89.9%, epoch: 4 *******
******* Domain l best val test acc: 66.9%, epoch: 4 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [5/50] batch [20/176] time 0.097 (0.116) data 0.000 (0.023) loss 1.1183 (1.1807) ce_loss 0.2866 (0.3652) loss_zs_kd 0.0992 (0.0951) loss_oracle 0.1222 (0.1285) acc 87.5000 (85.3125) kd_loss 0.7210 (0.7036) lr 1.9823e-03 eta 0:15:38
epoch [5/50] batch [40/176] time 0.093 (0.105) data 0.000 (0.011) loss 1.1786 (1.1932) ce_loss 0.3252 (0.3756) loss_zs_kd 0.0916 (0.0906) loss_oracle 0.1728 (0.1408) acc 93.7500 (86.2500) kd_loss 0.7212 (0.7019) lr 1.9823e-03 eta 0:14:04
epoch [5/50] batch [60/176] time 0.095 (0.102) data 0.000 (0.008) loss 1.0388 (1.1816) ce_loss 0.1761 (0.3559) loss_zs_kd 0.0715 (0.0850) loss_oracle 0.2111 (0.1560) acc 96.8750 (87.8125) kd_loss 0.7213 (0.7052) lr 1.9823e-03 eta 0:13:36
epoch [5/50] batch [80/176] time 0.097 (0.099) data 0.000 (0.006) loss 1.1903 (1.2097) ce_loss 0.4126 (0.3782) loss_zs_kd 0.0938 (0.0846) loss_oracle 0.2103 (0.1723) acc 84.3750 (87.1875) kd_loss 0.6256 (0.7031) lr 1.9823e-03 eta 0:13:16
epoch [5/50] batch [100/176] time 0.102 (0.099) data 0.000 (0.005) loss 1.1014 (1.2094) ce_loss 0.3167 (0.3800) loss_zs_kd 0.0796 (0.0862) loss_oracle 0.1693 (0.1707) acc 87.5000 (87.1875) kd_loss 0.6603 (0.7010) lr 1.9823e-03 eta 0:13:11
epoch [5/50] batch [120/176] time 0.102 (0.099) data 0.000 (0.004) loss 1.2225 (1.2180) ce_loss 0.3877 (0.3852) loss_zs_kd 0.0696 (0.0874) loss_oracle 0.1265 (0.1650) acc 81.2500 (86.9792) kd_loss 0.7368 (0.7066) lr 1.9823e-03 eta 0:13:07
epoch [5/50] batch [140/176] time 0.096 (0.098) data 0.000 (0.003) loss 1.0592 (1.2208) ce_loss 0.2003 (0.3856) loss_zs_kd 0.0699 (0.0872) loss_oracle 0.2079 (0.1654) acc 100.0000 (87.0536) kd_loss 0.7200 (0.7090) lr 1.9823e-03 eta 0:13:03
epoch [5/50] batch [160/176] time 0.100 (0.098) data 0.000 (0.003) loss 1.1006 (1.2268) ce_loss 0.2700 (0.3874) loss_zs_kd 0.0810 (0.0881) loss_oracle 0.1717 (0.1680) acc 87.5000 (86.6992) kd_loss 0.7043 (0.7114) lr 1.9823e-03 eta 0:12:57
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,177
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 91.8%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,753
* accuracy: 66.0%
* error: 34.0%
* macro_f1: 60.1%
******* Domain l best val acc:      89.9%, epoch: 4 *******
******* Domain l best val test acc: 66.9%, epoch: 4 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [6/50] batch [20/176] time 0.070 (0.133) data 0.000 (0.025) loss 1.0169 (1.2167) ce_loss 0.1808 (0.3655) loss_zs_kd 0.0653 (0.0733) loss_oracle 0.1779 (0.1817) acc 93.7500 (86.8750) kd_loss 0.7145 (0.7237) lr 1.9686e-03 eta 0:17:32
epoch [6/50] batch [40/176] time 0.081 (0.107) data 0.000 (0.012) loss 1.1062 (1.2528) ce_loss 0.3406 (0.3848) loss_zs_kd 0.0627 (0.0841) loss_oracle 0.1714 (0.1737) acc 84.3750 (85.8594) kd_loss 0.6486 (0.7391) lr 1.9686e-03 eta 0:14:02
epoch [6/50] batch [60/176] time 0.143 (0.105) data 0.000 (0.008) loss 1.1185 (1.2514) ce_loss 0.2354 (0.3875) loss_zs_kd 0.0755 (0.0853) loss_oracle 0.1458 (0.1588) acc 96.8750 (86.0417) kd_loss 0.7725 (0.7418) lr 1.9686e-03 eta 0:13:46
epoch [6/50] batch [80/176] time 0.110 (0.107) data 0.000 (0.006) loss 1.1362 (1.2470) ce_loss 0.2201 (0.3740) loss_zs_kd 0.0774 (0.0890) loss_oracle 0.1493 (0.1555) acc 93.7500 (86.7969) kd_loss 0.8028 (0.7508) lr 1.9686e-03 eta 0:13:55
epoch [6/50] batch [100/176] time 0.082 (0.105) data 0.000 (0.005) loss 1.4138 (1.2524) ce_loss 0.4592 (0.3805) loss_zs_kd 0.1127 (0.0907) loss_oracle 0.1503 (0.1512) acc 81.2500 (86.5000) kd_loss 0.8230 (0.7509) lr 1.9686e-03 eta 0:13:44
epoch [6/50] batch [120/176] time 0.093 (0.101) data 0.000 (0.004) loss 1.4062 (1.2545) ce_loss 0.5151 (0.3822) loss_zs_kd 0.0721 (0.0921) loss_oracle 0.1787 (0.1517) acc 78.1250 (86.3021) kd_loss 0.7657 (0.7505) lr 1.9686e-03 eta 0:13:10
epoch [6/50] batch [140/176] time 0.099 (0.101) data 0.000 (0.004) loss 1.3241 (1.2527) ce_loss 0.4536 (0.3825) loss_zs_kd 0.0976 (0.0913) loss_oracle 0.2486 (0.1581) acc 81.2500 (86.4732) kd_loss 0.6974 (0.7456) lr 1.9686e-03 eta 0:13:03
epoch [6/50] batch [160/176] time 0.097 (0.100) data 0.000 (0.003) loss 1.2603 (1.2566) ce_loss 0.4490 (0.3848) loss_zs_kd 0.1160 (0.0908) loss_oracle 0.1678 (0.1662) acc 84.3750 (86.1523) kd_loss 0.6694 (0.7432) lr 1.9686e-03 eta 0:12:59
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,176
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 91.8%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,674
* accuracy: 63.0%
* error: 37.0%
* macro_f1: 58.2%
******* Domain l best val acc:      89.9%, epoch: 4 *******
******* Domain l best val test acc: 66.9%, epoch: 4 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [7/50] batch [20/176] time 0.092 (0.125) data 0.000 (0.030) loss 1.3481 (1.2773) ce_loss 0.3948 (0.3614) loss_zs_kd 0.0741 (0.0772) loss_oracle 0.2045 (0.2135) acc 87.5000 (88.5938) kd_loss 0.8140 (0.7705) lr 1.9511e-03 eta 0:16:02
epoch [7/50] batch [40/176] time 0.095 (0.110) data 0.000 (0.015) loss 1.2564 (1.2897) ce_loss 0.2866 (0.3611) loss_zs_kd 0.1209 (0.0795) loss_oracle 0.2652 (0.2220) acc 87.5000 (87.5000) kd_loss 0.7767 (0.7778) lr 1.9511e-03 eta 0:14:07
epoch [7/50] batch [60/176] time 0.088 (0.105) data 0.000 (0.010) loss 1.2647 (1.3389) ce_loss 0.3284 (0.3953) loss_zs_kd 0.0719 (0.0823) loss_oracle 0.1891 (0.2287) acc 87.5000 (85.9375) kd_loss 0.8059 (0.7882) lr 1.9511e-03 eta 0:13:27
epoch [7/50] batch [80/176] time 0.092 (0.102) data 0.000 (0.008) loss 0.9878 (1.3389) ce_loss 0.1356 (0.3958) loss_zs_kd 0.1025 (0.0837) loss_oracle 0.1126 (0.2142) acc 93.7500 (85.4688) kd_loss 0.7446 (0.7941) lr 1.9511e-03 eta 0:12:59
epoch [7/50] batch [100/176] time 0.092 (0.100) data 0.001 (0.006) loss 1.3323 (1.3229) ce_loss 0.4514 (0.3867) loss_zs_kd 0.1085 (0.0860) loss_oracle 0.1089 (0.1954) acc 81.2500 (85.9062) kd_loss 0.7721 (0.7954) lr 1.9511e-03 eta 0:12:47
epoch [7/50] batch [120/176] time 0.091 (0.100) data 0.000 (0.005) loss 1.6929 (1.3215) ce_loss 0.6323 (0.3889) loss_zs_kd 0.0440 (0.0850) loss_oracle 0.1943 (0.1850) acc 75.0000 (86.0417) kd_loss 0.9414 (0.7976) lr 1.9511e-03 eta 0:12:43
epoch [7/50] batch [140/176] time 0.086 (0.100) data 0.000 (0.004) loss 1.5660 (1.3287) ce_loss 0.5293 (0.3928) loss_zs_kd 0.0822 (0.0847) loss_oracle 0.1600 (0.1834) acc 84.3750 (86.0045) kd_loss 0.9157 (0.8019) lr 1.9511e-03 eta 0:12:39
epoch [7/50] batch [160/176] time 0.098 (0.100) data 0.000 (0.004) loss 1.5197 (1.3332) ce_loss 0.5684 (0.3919) loss_zs_kd 0.0858 (0.0866) loss_oracle 0.2285 (0.1855) acc 78.1250 (86.0156) kd_loss 0.7942 (0.8052) lr 1.9511e-03 eta 0:12:38
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,179
* accuracy: 90.0%
* error: 10.0%
* macro_f1: 91.8%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,740
* accuracy: 65.5%
* error: 34.5%
* macro_f1: 59.4%
******* Domain l best val acc:      90.0%, epoch: 7 *******
******* Domain l best val test acc: 65.5%, epoch: 7 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [8/50] batch [20/176] time 0.111 (0.138) data 0.000 (0.035) loss 1.2217 (1.3255) ce_loss 0.2542 (0.3504) loss_zs_kd 0.0714 (0.1026) loss_oracle 0.1740 (0.1938) acc 90.6250 (88.1250) kd_loss 0.8448 (0.8269) lr 1.9298e-03 eta 0:17:20
epoch [8/50] batch [40/176] time 0.103 (0.118) data 0.001 (0.017) loss 1.1759 (1.3221) ce_loss 0.3157 (0.3645) loss_zs_kd 0.0653 (0.0931) loss_oracle 0.2089 (0.1830) acc 90.6250 (87.2656) kd_loss 0.7231 (0.8195) lr 1.9298e-03 eta 0:14:51
epoch [8/50] batch [60/176] time 0.094 (0.112) data 0.000 (0.012) loss 1.4018 (1.3358) ce_loss 0.3633 (0.3689) loss_zs_kd 0.1042 (0.0910) loss_oracle 0.2744 (0.2006) acc 90.6250 (86.8750) kd_loss 0.8492 (0.8212) lr 1.9298e-03 eta 0:14:00
epoch [8/50] batch [80/176] time 0.097 (0.108) data 0.000 (0.009) loss 1.3171 (1.3349) ce_loss 0.3008 (0.3685) loss_zs_kd 0.0607 (0.0908) loss_oracle 0.2253 (0.2086) acc 90.6250 (87.2266) kd_loss 0.8734 (0.8167) lr 1.9298e-03 eta 0:13:31
epoch [8/50] batch [100/176] time 0.090 (0.105) data 0.000 (0.007) loss 1.1855 (1.3360) ce_loss 0.3037 (0.3692) loss_zs_kd 0.0769 (0.0906) loss_oracle 0.1711 (0.2068) acc 87.5000 (87.0312) kd_loss 0.7578 (0.8181) lr 1.9298e-03 eta 0:13:02
epoch [8/50] batch [120/176] time 0.169 (0.102) data 0.000 (0.006) loss 1.4422 (1.3334) ce_loss 0.4407 (0.3718) loss_zs_kd 0.1030 (0.0900) loss_oracle 0.2376 (0.2033) acc 78.1250 (86.8229) kd_loss 0.8312 (0.8149) lr 1.9298e-03 eta 0:12:43
epoch [8/50] batch [140/176] time 0.073 (0.102) data 0.000 (0.005) loss 1.1952 (1.3252) ce_loss 0.3579 (0.3727) loss_zs_kd 0.0749 (0.0899) loss_oracle 0.2109 (0.2009) acc 81.2500 (86.7634) kd_loss 0.6944 (0.8071) lr 1.9298e-03 eta 0:12:40
epoch [8/50] batch [160/176] time 0.122 (0.103) data 0.000 (0.005) loss 1.3732 (1.3193) ce_loss 0.4358 (0.3750) loss_zs_kd 0.1233 (0.0919) loss_oracle 0.2264 (0.1996) acc 84.3750 (86.7773) kd_loss 0.7625 (0.7986) lr 1.9298e-03 eta 0:12:39
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,169
* accuracy: 89.6%
* error: 10.4%
* macro_f1: 91.7%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,630
* accuracy: 61.4%
* error: 38.6%
* macro_f1: 57.8%
******* Domain l best val acc:      90.0%, epoch: 7 *******
******* Domain l best val test acc: 65.5%, epoch: 7 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [9/50] batch [20/176] time 0.077 (0.149) data 0.000 (0.036) loss 1.2867 (1.2917) ce_loss 0.3606 (0.3921) loss_zs_kd 0.1251 (0.0878) loss_oracle 0.2261 (0.2416) acc 87.5000 (85.4688) kd_loss 0.7505 (0.7348) lr 1.9048e-03 eta 0:18:18
epoch [9/50] batch [40/176] time 0.081 (0.128) data 0.000 (0.018) loss 1.5319 (1.3116) ce_loss 0.6377 (0.4154) loss_zs_kd 0.0747 (0.0817) loss_oracle 0.1590 (0.2221) acc 71.8750 (85.0781) kd_loss 0.7773 (0.7443) lr 1.9048e-03 eta 0:15:40
epoch [9/50] batch [60/176] time 0.074 (0.111) data 0.000 (0.012) loss 1.1610 (1.2911) ce_loss 0.3362 (0.3953) loss_zs_kd 0.0950 (0.0862) loss_oracle 0.2043 (0.2152) acc 87.5000 (85.9375) kd_loss 0.6751 (0.7451) lr 1.9048e-03 eta 0:13:36
epoch [9/50] batch [80/176] time 0.079 (0.103) data 0.000 (0.009) loss 1.3676 (1.2834) ce_loss 0.3838 (0.3951) loss_zs_kd 0.1293 (0.0897) loss_oracle 0.1886 (0.2016) acc 87.5000 (86.3672) kd_loss 0.8248 (0.7426) lr 1.9048e-03 eta 0:12:31
epoch [9/50] batch [100/176] time 0.086 (0.098) data 0.000 (0.007) loss 1.1614 (1.2720) ce_loss 0.3005 (0.3924) loss_zs_kd 0.1074 (0.0890) loss_oracle 0.2372 (0.1968) acc 93.7500 (86.8125) kd_loss 0.6886 (0.7367) lr 1.9048e-03 eta 0:11:58
epoch [9/50] batch [120/176] time 0.077 (0.094) data 0.000 (0.006) loss 1.4891 (1.2779) ce_loss 0.5503 (0.3979) loss_zs_kd 0.1180 (0.0903) loss_oracle 0.2476 (0.2043) acc 84.3750 (86.6406) kd_loss 0.7560 (0.7327) lr 1.9048e-03 eta 0:11:26
epoch [9/50] batch [140/176] time 0.068 (0.091) data 0.000 (0.005) loss 1.1626 (1.2701) ce_loss 0.2383 (0.3905) loss_zs_kd 0.0831 (0.0901) loss_oracle 0.1786 (0.2055) acc 93.7500 (86.8973) kd_loss 0.7935 (0.7317) lr 1.9048e-03 eta 0:11:02
epoch [9/50] batch [160/176] time 0.076 (0.089) data 0.000 (0.005) loss 1.2449 (1.2742) ce_loss 0.4258 (0.3931) loss_zs_kd 0.0817 (0.0899) loss_oracle 0.2285 (0.2064) acc 87.5000 (86.5625) kd_loss 0.6641 (0.7329) lr 1.9048e-03 eta 0:10:41
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,185
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 92.1%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,644
* accuracy: 61.9%
* error: 38.1%
* macro_f1: 57.7%
******* Domain l best val acc:      90.2%, epoch: 9 *******
******* Domain l best val test acc: 61.9%, epoch: 9 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [10/50] batch [20/176] time 0.071 (0.116) data 0.000 (0.037) loss 1.3838 (1.2735) ce_loss 0.4829 (0.3984) loss_zs_kd 0.0971 (0.0988) loss_oracle 0.1648 (0.1884) acc 81.2500 (84.6875) kd_loss 0.7700 (0.7315) lr 1.8763e-03 eta 0:13:56
epoch [10/50] batch [40/176] time 0.070 (0.095) data 0.000 (0.019) loss 1.1760 (1.2333) ce_loss 0.3794 (0.3649) loss_zs_kd 0.0713 (0.0993) loss_oracle 0.1771 (0.1815) acc 81.2500 (86.0156) kd_loss 0.6724 (0.7281) lr 1.8763e-03 eta 0:11:22
epoch [10/50] batch [60/176] time 0.100 (0.092) data 0.000 (0.013) loss 1.2650 (1.2363) ce_loss 0.3687 (0.3691) loss_zs_kd 0.1391 (0.0993) loss_oracle 0.2030 (0.1784) acc 90.6250 (86.4583) kd_loss 0.7252 (0.7284) lr 1.8763e-03 eta 0:10:59
epoch [10/50] batch [80/176] time 0.091 (0.093) data 0.000 (0.009) loss 1.3570 (1.2370) ce_loss 0.4717 (0.3700) loss_zs_kd 0.0755 (0.0987) loss_oracle 0.2387 (0.1843) acc 84.3750 (86.2891) kd_loss 0.7282 (0.7255) lr 1.8763e-03 eta 0:11:02
epoch [10/50] batch [100/176] time 0.083 (0.093) data 0.000 (0.008) loss 1.3217 (1.2532) ce_loss 0.4985 (0.3802) loss_zs_kd 0.1320 (0.0975) loss_oracle 0.1561 (0.1876) acc 87.5000 (86.2500) kd_loss 0.6791 (0.7305) lr 1.8763e-03 eta 0:11:01
epoch [10/50] batch [120/176] time 0.097 (0.093) data 0.000 (0.006) loss 1.3312 (1.2469) ce_loss 0.5830 (0.3796) loss_zs_kd 0.0630 (0.0954) loss_oracle 0.2048 (0.1857) acc 78.1250 (86.2500) kd_loss 0.6143 (0.7268) lr 1.8763e-03 eta 0:11:01
epoch [10/50] batch [140/176] time 0.081 (0.092) data 0.000 (0.006) loss 1.2972 (1.2505) ce_loss 0.3718 (0.3808) loss_zs_kd 0.0989 (0.0962) loss_oracle 0.1612 (0.1859) acc 87.5000 (86.1830) kd_loss 0.7953 (0.7286) lr 1.8763e-03 eta 0:10:50
epoch [10/50] batch [160/176] time 0.097 (0.092) data 0.000 (0.005) loss 1.2300 (1.2530) ce_loss 0.3093 (0.3816) loss_zs_kd 0.0575 (0.0950) loss_oracle 0.2124 (0.1850) acc 93.7500 (86.1523) kd_loss 0.7858 (0.7314) lr 1.8763e-03 eta 0:10:45
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,176
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 91.8%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,664
* accuracy: 62.7%
* error: 37.3%
* macro_f1: 58.2%
******* Domain l best val acc:      90.2%, epoch: 9 *******
******* Domain l best val test acc: 61.9%, epoch: 9 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [11/50] batch [20/176] time 0.066 (0.134) data 0.000 (0.035) loss 1.4309 (1.3310) ce_loss 0.4392 (0.4114) loss_zs_kd 0.1536 (0.1100) loss_oracle 0.1698 (0.2107) acc 90.6250 (85.4688) kd_loss 0.8300 (0.7593) lr 1.8443e-03 eta 0:15:39
epoch [11/50] batch [40/176] time 0.096 (0.115) data 0.000 (0.018) loss 1.2971 (1.2992) ce_loss 0.4250 (0.3860) loss_zs_kd 0.0945 (0.1002) loss_oracle 0.1640 (0.1891) acc 81.2500 (86.6406) kd_loss 0.7429 (0.7686) lr 1.8443e-03 eta 0:13:25
epoch [11/50] batch [60/176] time 0.096 (0.109) data 0.000 (0.012) loss 1.4003 (1.3069) ce_loss 0.4543 (0.3939) loss_zs_kd 0.1441 (0.1013) loss_oracle 0.2268 (0.1840) acc 84.3750 (86.4062) kd_loss 0.7605 (0.7704) lr 1.8443e-03 eta 0:12:39
epoch [11/50] batch [80/176] time 0.075 (0.103) data 0.000 (0.009) loss 1.4531 (1.3164) ce_loss 0.5239 (0.3963) loss_zs_kd 0.0740 (0.0968) loss_oracle 0.2660 (0.1984) acc 87.5000 (86.2109) kd_loss 0.7591 (0.7725) lr 1.8443e-03 eta 0:11:58
epoch [11/50] batch [100/176] time 0.123 (0.100) data 0.000 (0.007) loss 1.3280 (1.3087) ce_loss 0.4094 (0.3793) loss_zs_kd 0.0546 (0.0931) loss_oracle 0.2169 (0.2024) acc 81.2500 (86.9688) kd_loss 0.7828 (0.7817) lr 1.8443e-03 eta 0:11:31
epoch [11/50] batch [120/176] time 0.074 (0.101) data 0.000 (0.006) loss 1.3394 (1.3127) ce_loss 0.2639 (0.3793) loss_zs_kd 0.0866 (0.0928) loss_oracle 0.2094 (0.2056) acc 90.6250 (86.9010) kd_loss 0.9275 (0.7842) lr 1.8443e-03 eta 0:11:38
epoch [11/50] batch [140/176] time 0.079 (0.102) data 0.000 (0.005) loss 1.4695 (1.3211) ce_loss 0.4260 (0.3826) loss_zs_kd 0.0940 (0.0924) loss_oracle 0.2948 (0.2109) acc 87.5000 (86.8080) kd_loss 0.8491 (0.7869) lr 1.8443e-03 eta 0:11:44
epoch [11/50] batch [160/176] time 0.149 (0.103) data 0.000 (0.005) loss 1.1989 (1.3355) ce_loss 0.2556 (0.3865) loss_zs_kd 0.1076 (0.0934) loss_oracle 0.2241 (0.2185) acc 96.8750 (86.6992) kd_loss 0.7774 (0.7930) lr 1.8443e-03 eta 0:11:51
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,184
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,775
* accuracy: 66.8%
* error: 33.2%
* macro_f1: 61.1%
******* Domain l best val acc:      90.2%, epoch: 9 *******
******* Domain l best val test acc: 61.9%, epoch: 9 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [12/50] batch [20/176] time 0.088 (0.125) data 0.000 (0.040) loss 1.1451 (1.3123) ce_loss 0.2673 (0.3760) loss_zs_kd 0.0638 (0.0941) loss_oracle 0.1699 (0.1705) acc 93.7500 (86.4062) kd_loss 0.7609 (0.8040) lr 1.8090e-03 eta 0:14:12
epoch [12/50] batch [40/176] time 0.097 (0.111) data 0.000 (0.020) loss 1.4223 (1.3179) ce_loss 0.5288 (0.3815) loss_zs_kd 0.0688 (0.0913) loss_oracle 0.2812 (0.1883) acc 84.3750 (86.0938) kd_loss 0.7185 (0.7966) lr 1.8090e-03 eta 0:12:39
epoch [12/50] batch [60/176] time 0.095 (0.106) data 0.000 (0.013) loss 1.5458 (1.3164) ce_loss 0.5854 (0.3805) loss_zs_kd 0.1025 (0.0975) loss_oracle 0.2090 (0.1934) acc 81.2500 (86.3021) kd_loss 0.8046 (0.7905) lr 1.8090e-03 eta 0:12:04
epoch [12/50] batch [80/176] time 0.100 (0.104) data 0.000 (0.010) loss 1.2294 (1.3136) ce_loss 0.2864 (0.3765) loss_zs_kd 0.0987 (0.0939) loss_oracle 0.1925 (0.1913) acc 93.7500 (86.9531) kd_loss 0.7974 (0.7944) lr 1.8090e-03 eta 0:11:45
epoch [12/50] batch [100/176] time 0.104 (0.102) data 0.000 (0.008) loss 1.1588 (1.3110) ce_loss 0.2622 (0.3783) loss_zs_kd 0.0521 (0.0946) loss_oracle 0.1915 (0.1900) acc 90.6250 (86.8125) kd_loss 0.7748 (0.7904) lr 1.8090e-03 eta 0:11:30
epoch [12/50] batch [120/176] time 0.097 (0.101) data 0.000 (0.007) loss 1.1910 (1.3066) ce_loss 0.2258 (0.3736) loss_zs_kd 0.0497 (0.0942) loss_oracle 0.1838 (0.1887) acc 93.7500 (86.9010) kd_loss 0.8484 (0.7915) lr 1.8090e-03 eta 0:11:19
epoch [12/50] batch [140/176] time 0.095 (0.100) data 0.000 (0.006) loss 1.5527 (1.3063) ce_loss 0.5806 (0.3724) loss_zs_kd 0.0786 (0.0940) loss_oracle 0.1762 (0.1877) acc 78.1250 (86.9643) kd_loss 0.8447 (0.7930) lr 1.8090e-03 eta 0:11:15
epoch [12/50] batch [160/176] time 0.089 (0.100) data 0.000 (0.005) loss 1.4893 (1.3097) ce_loss 0.4392 (0.3747) loss_zs_kd 0.0793 (0.0933) loss_oracle 0.2041 (0.1884) acc 84.3750 (86.9336) kd_loss 0.9083 (0.7942) lr 1.8090e-03 eta 0:11:10
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,179
* accuracy: 90.0%
* error: 10.0%
* macro_f1: 91.9%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,672
* accuracy: 63.0%
* error: 37.0%
* macro_f1: 58.6%
******* Domain l best val acc:      90.2%, epoch: 9 *******
******* Domain l best val test acc: 61.9%, epoch: 9 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [13/50] batch [20/176] time 0.092 (0.135) data 0.000 (0.039) loss 1.5082 (1.3242) ce_loss 0.5845 (0.4103) loss_zs_kd 0.0578 (0.0817) loss_oracle 0.1614 (0.1662) acc 78.1250 (86.4062) kd_loss 0.8141 (0.7899) lr 1.7705e-03 eta 0:14:57
epoch [13/50] batch [40/176] time 0.085 (0.113) data 0.000 (0.019) loss 1.2447 (1.2797) ce_loss 0.3047 (0.3821) loss_zs_kd 0.0797 (0.0818) loss_oracle 0.1392 (0.1596) acc 84.3750 (87.2656) kd_loss 0.8306 (0.7769) lr 1.7705e-03 eta 0:12:31
epoch [13/50] batch [60/176] time 0.079 (0.104) data 0.000 (0.013) loss 1.1036 (1.2656) ce_loss 0.2396 (0.3767) loss_zs_kd 0.0868 (0.0871) loss_oracle 0.1081 (0.1527) acc 90.6250 (87.2917) kd_loss 0.7665 (0.7690) lr 1.7705e-03 eta 0:11:31
epoch [13/50] batch [80/176] time 0.081 (0.100) data 0.000 (0.010) loss 1.1704 (1.2802) ce_loss 0.2935 (0.3937) loss_zs_kd 0.0876 (0.0890) loss_oracle 0.1130 (0.1428) acc 87.5000 (86.5625) kd_loss 0.7766 (0.7706) lr 1.7705e-03 eta 0:11:00
epoch [13/50] batch [100/176] time 0.097 (0.099) data 0.000 (0.008) loss 1.0065 (1.2726) ce_loss 0.1597 (0.3899) loss_zs_kd 0.1152 (0.0901) loss_oracle 0.1052 (0.1397) acc 96.8750 (86.5938) kd_loss 0.7366 (0.7678) lr 1.7705e-03 eta 0:10:49
epoch [13/50] batch [120/176] time 0.092 (0.098) data 0.000 (0.007) loss 1.2749 (1.2598) ce_loss 0.3735 (0.3824) loss_zs_kd 0.0832 (0.0907) loss_oracle 0.1274 (0.1357) acc 84.3750 (87.0573) kd_loss 0.7961 (0.7643) lr 1.7705e-03 eta 0:10:42
epoch [13/50] batch [140/176] time 0.116 (0.097) data 0.000 (0.006) loss 1.2613 (1.2609) ce_loss 0.3533 (0.3823) loss_zs_kd 0.0784 (0.0936) loss_oracle 0.1817 (0.1364) acc 81.2500 (87.0089) kd_loss 0.7779 (0.7636) lr 1.7705e-03 eta 0:10:38
epoch [13/50] batch [160/176] time 0.090 (0.097) data 0.000 (0.005) loss 1.2930 (1.2548) ce_loss 0.4421 (0.3778) loss_zs_kd 0.0686 (0.0927) loss_oracle 0.1114 (0.1349) acc 78.1250 (87.0898) kd_loss 0.7608 (0.7633) lr 1.7705e-03 eta 0:10:32
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,190
* accuracy: 90.4%
* error: 9.6%
* macro_f1: 92.3%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,743
* accuracy: 65.6%
* error: 34.4%
* macro_f1: 60.3%
******* Domain l best val acc:      90.4%, epoch: 13 *******
******* Domain l best val test acc: 65.6%, epoch: 13 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [14/50] batch [20/176] time 0.065 (0.126) data 0.000 (0.041) loss 1.1865 (1.2437) ce_loss 0.3762 (0.3696) loss_zs_kd 0.0938 (0.1045) loss_oracle 0.1217 (0.1357) acc 93.7500 (88.5938) kd_loss 0.7025 (0.7540) lr 1.7290e-03 eta 0:13:35
epoch [14/50] batch [40/176] time 0.152 (0.106) data 0.000 (0.021) loss 1.3349 (1.2591) ce_loss 0.3662 (0.3820) loss_zs_kd 0.1303 (0.1015) loss_oracle 0.1483 (0.1367) acc 87.5000 (87.4219) kd_loss 0.8294 (0.7580) lr 1.7290e-03 eta 0:11:29
epoch [14/50] batch [60/176] time 0.088 (0.098) data 0.000 (0.014) loss 1.3862 (1.2658) ce_loss 0.5298 (0.3799) loss_zs_kd 0.1347 (0.0986) loss_oracle 0.1257 (0.1457) acc 75.0000 (87.2917) kd_loss 0.7262 (0.7637) lr 1.7290e-03 eta 0:10:31
epoch [14/50] batch [80/176] time 0.082 (0.094) data 0.001 (0.011) loss 1.3076 (1.2833) ce_loss 0.4480 (0.3906) loss_zs_kd 0.0888 (0.0958) loss_oracle 0.1536 (0.1444) acc 87.5000 (86.7578) kd_loss 0.7384 (0.7726) lr 1.7290e-03 eta 0:10:06
epoch [14/50] batch [100/176] time 0.112 (0.097) data 0.000 (0.008) loss 1.2068 (1.2892) ce_loss 0.1954 (0.3832) loss_zs_kd 0.1176 (0.0956) loss_oracle 0.1419 (0.1440) acc 93.7500 (86.8438) kd_loss 0.8816 (0.7862) lr 1.7290e-03 eta 0:10:21
epoch [14/50] batch [120/176] time 0.122 (0.100) data 0.000 (0.007) loss 1.2013 (1.2924) ce_loss 0.2559 (0.3825) loss_zs_kd 0.0760 (0.0963) loss_oracle 0.1480 (0.1430) acc 90.6250 (86.6406) kd_loss 0.8335 (0.7903) lr 1.7290e-03 eta 0:10:38
epoch [14/50] batch [140/176] time 0.082 (0.099) data 0.000 (0.006) loss 1.0419 (1.2928) ce_loss 0.1709 (0.3815) loss_zs_kd 0.0950 (0.0969) loss_oracle 0.1455 (0.1436) acc 96.8750 (86.6741) kd_loss 0.7507 (0.7910) lr 1.7290e-03 eta 0:10:30
epoch [14/50] batch [160/176] time 0.089 (0.098) data 0.000 (0.005) loss 1.1844 (1.2903) ce_loss 0.2603 (0.3810) loss_zs_kd 0.0912 (0.0964) loss_oracle 0.1263 (0.1420) acc 96.8750 (86.7773) kd_loss 0.8154 (0.7901) lr 1.7290e-03 eta 0:10:22
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,181
* accuracy: 90.0%
* error: 10.0%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,639
* accuracy: 61.7%
* error: 38.3%
* macro_f1: 57.7%
******* Domain l best val acc:      90.4%, epoch: 13 *******
******* Domain l best val test acc: 65.6%, epoch: 13 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [15/50] batch [20/176] time 0.086 (0.131) data 0.000 (0.044) loss 1.2224 (1.2814) ce_loss 0.4077 (0.3908) loss_zs_kd 0.0865 (0.0917) loss_oracle 0.1251 (0.1317) acc 81.2500 (86.0938) kd_loss 0.7089 (0.7789) lr 1.6845e-03 eta 0:13:46
epoch [15/50] batch [40/176] time 0.107 (0.112) data 0.000 (0.022) loss 1.3442 (1.2705) ce_loss 0.3357 (0.3695) loss_zs_kd 0.1749 (0.0965) loss_oracle 0.1606 (0.1277) acc 87.5000 (86.5625) kd_loss 0.8407 (0.7889) lr 1.6845e-03 eta 0:11:47
epoch [15/50] batch [60/176] time 0.085 (0.105) data 0.000 (0.015) loss 1.0428 (1.2645) ce_loss 0.2507 (0.3659) loss_zs_kd 0.0780 (0.0954) loss_oracle 0.1434 (0.1285) acc 90.6250 (86.8750) kd_loss 0.6814 (0.7867) lr 1.6845e-03 eta 0:10:56
epoch [15/50] batch [80/176] time 0.090 (0.101) data 0.000 (0.011) loss 1.2183 (1.2794) ce_loss 0.3574 (0.3726) loss_zs_kd 0.0610 (0.0993) loss_oracle 0.1175 (0.1317) acc 90.6250 (86.5234) kd_loss 0.7716 (0.7913) lr 1.6845e-03 eta 0:10:34
epoch [15/50] batch [100/176] time 0.086 (0.100) data 0.000 (0.009) loss 1.2354 (1.2728) ce_loss 0.4082 (0.3694) loss_zs_kd 0.1008 (0.1012) loss_oracle 0.1221 (0.1306) acc 87.5000 (86.6875) kd_loss 0.7157 (0.7875) lr 1.6845e-03 eta 0:10:21
epoch [15/50] batch [120/176] time 0.088 (0.099) data 0.000 (0.007) loss 1.1745 (1.2686) ce_loss 0.2732 (0.3676) loss_zs_kd 0.1355 (0.1001) loss_oracle 0.1327 (0.1299) acc 90.6250 (86.7969) kd_loss 0.7672 (0.7861) lr 1.6845e-03 eta 0:10:14
epoch [15/50] batch [140/176] time 0.097 (0.098) data 0.000 (0.006) loss 1.2592 (1.2655) ce_loss 0.3586 (0.3661) loss_zs_kd 0.0596 (0.0987) loss_oracle 0.1531 (0.1309) acc 84.3750 (86.9866) kd_loss 0.7941 (0.7846) lr 1.6845e-03 eta 0:10:07
epoch [15/50] batch [160/176] time 0.103 (0.098) data 0.000 (0.006) loss 1.3163 (1.2661) ce_loss 0.4126 (0.3663) loss_zs_kd 0.0914 (0.0974) loss_oracle 0.1100 (0.1321) acc 78.1250 (86.9141) kd_loss 0.8030 (0.7851) lr 1.6845e-03 eta 0:10:07
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,195
* accuracy: 90.6%
* error: 9.4%
* macro_f1: 92.4%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,696
* accuracy: 63.9%
* error: 36.1%
* macro_f1: 58.2%
******* Domain l best val acc:      90.6%, epoch: 15 *******
******* Domain l best val test acc: 63.9%, epoch: 15 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [16/50] batch [20/176] time 0.103 (0.148) data 0.000 (0.048) loss 1.5149 (1.2817) ce_loss 0.5933 (0.3833) loss_zs_kd 0.1228 (0.0998) loss_oracle 0.1201 (0.1345) acc 78.1250 (85.4688) kd_loss 0.8002 (0.7812) lr 1.6374e-03 eta 0:15:10
epoch [16/50] batch [40/176] time 0.094 (0.124) data 0.000 (0.024) loss 1.2533 (1.2703) ce_loss 0.3713 (0.3691) loss_zs_kd 0.1288 (0.0994) loss_oracle 0.1789 (0.1465) acc 90.6250 (86.6406) kd_loss 0.7281 (0.7782) lr 1.6374e-03 eta 0:12:40
epoch [16/50] batch [60/176] time 0.099 (0.116) data 0.001 (0.016) loss 1.1628 (1.2828) ce_loss 0.2480 (0.3750) loss_zs_kd 0.1031 (0.1010) loss_oracle 0.2350 (0.1563) acc 93.7500 (86.5625) kd_loss 0.7457 (0.7792) lr 1.6374e-03 eta 0:11:48
epoch [16/50] batch [80/176] time 0.081 (0.110) data 0.000 (0.012) loss 1.3762 (1.2923) ce_loss 0.4919 (0.3807) loss_zs_kd 0.0827 (0.1034) loss_oracle 0.1338 (0.1559) acc 78.1250 (86.2891) kd_loss 0.7760 (0.7819) lr 1.6374e-03 eta 0:11:09
epoch [16/50] batch [100/176] time 0.127 (0.106) data 0.000 (0.010) loss 1.2474 (1.2905) ce_loss 0.3516 (0.3791) loss_zs_kd 0.0380 (0.1018) loss_oracle 0.1094 (0.1478) acc 84.3750 (86.3125) kd_loss 0.8221 (0.7867) lr 1.6374e-03 eta 0:10:41
epoch [16/50] batch [120/176] time 0.122 (0.107) data 0.000 (0.008) loss 1.2773 (1.2847) ce_loss 0.2915 (0.3763) loss_zs_kd 0.1281 (0.1000) loss_oracle 0.0946 (0.1396) acc 90.6250 (86.2240) kd_loss 0.8744 (0.7887) lr 1.6374e-03 eta 0:10:45
epoch [16/50] batch [140/176] time 0.080 (0.108) data 0.000 (0.007) loss 1.2497 (1.2704) ce_loss 0.3118 (0.3659) loss_zs_kd 0.0965 (0.0990) loss_oracle 0.0967 (0.1351) acc 84.3750 (86.8750) kd_loss 0.8413 (0.7875) lr 1.6374e-03 eta 0:10:48
epoch [16/50] batch [160/176] time 0.134 (0.108) data 0.000 (0.006) loss 1.2330 (1.2713) ce_loss 0.3477 (0.3660) loss_zs_kd 0.0702 (0.0985) loss_oracle 0.1395 (0.1334) acc 87.5000 (86.9727) kd_loss 0.7804 (0.7893) lr 1.6374e-03 eta 0:10:50
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,187
* accuracy: 90.3%
* error: 9.7%
* macro_f1: 92.2%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,704
* accuracy: 64.2%
* error: 35.8%
* macro_f1: 58.9%
******* Domain l best val acc:      90.6%, epoch: 15 *******
******* Domain l best val test acc: 63.9%, epoch: 15 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [17/50] batch [20/176] time 0.095 (0.140) data 0.000 (0.048) loss 1.2562 (1.3119) ce_loss 0.2903 (0.3990) loss_zs_kd 0.1041 (0.0953) loss_oracle 0.1962 (0.1448) acc 90.6250 (86.7188) kd_loss 0.8157 (0.7928) lr 1.5878e-03 eta 0:13:56
epoch [17/50] batch [40/176] time 0.098 (0.119) data 0.000 (0.024) loss 1.1008 (1.3046) ce_loss 0.2010 (0.3797) loss_zs_kd 0.0895 (0.0926) loss_oracle 0.1417 (0.1513) acc 96.8750 (86.9531) kd_loss 0.7841 (0.8030) lr 1.5878e-03 eta 0:11:49
epoch [17/50] batch [60/176] time 0.102 (0.113) data 0.000 (0.016) loss 1.3162 (1.3123) ce_loss 0.3860 (0.3852) loss_zs_kd 0.0685 (0.0959) loss_oracle 0.1572 (0.1527) acc 84.3750 (86.9271) kd_loss 0.8174 (0.8029) lr 1.5878e-03 eta 0:11:09
epoch [17/50] batch [80/176] time 0.094 (0.110) data 0.000 (0.012) loss 1.2868 (1.3174) ce_loss 0.3367 (0.3858) loss_zs_kd 0.1155 (0.0970) loss_oracle 0.1551 (0.1536) acc 87.5000 (87.0703) kd_loss 0.8149 (0.8064) lr 1.5878e-03 eta 0:10:48
epoch [17/50] batch [100/176] time 0.093 (0.108) data 0.000 (0.010) loss 1.2756 (1.3251) ce_loss 0.3059 (0.3859) loss_zs_kd 0.1088 (0.0977) loss_oracle 0.1907 (0.1664) acc 87.5000 (87.2188) kd_loss 0.8200 (0.8070) lr 1.5878e-03 eta 0:10:32
epoch [17/50] batch [120/176] time 0.090 (0.106) data 0.000 (0.008) loss 1.2778 (1.3231) ce_loss 0.3406 (0.3856) loss_zs_kd 0.0980 (0.0964) loss_oracle 0.1663 (0.1681) acc 90.6250 (86.9531) kd_loss 0.8051 (0.8053) lr 1.5878e-03 eta 0:10:20
epoch [17/50] batch [140/176] time 0.092 (0.104) data 0.000 (0.007) loss 1.3376 (1.3172) ce_loss 0.3772 (0.3835) loss_zs_kd 0.1309 (0.0957) loss_oracle 0.1351 (0.1663) acc 87.5000 (86.9643) kd_loss 0.8274 (0.8026) lr 1.5878e-03 eta 0:10:08
epoch [17/50] batch [160/176] time 0.095 (0.103) data 0.000 (0.006) loss 1.3123 (1.3108) ce_loss 0.3379 (0.3779) loss_zs_kd 0.1078 (0.0958) loss_oracle 0.1507 (0.1671) acc 84.3750 (86.9922) kd_loss 0.8452 (0.8015) lr 1.5878e-03 eta 0:10:02
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,191
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 92.3%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,720
* accuracy: 64.8%
* error: 35.2%
* macro_f1: 59.6%
******* Domain l best val acc:      90.6%, epoch: 15 *******
******* Domain l best val test acc: 63.9%, epoch: 15 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [18/50] batch [20/176] time 0.095 (0.141) data 0.000 (0.047) loss 1.2329 (1.2770) ce_loss 0.2949 (0.3547) loss_zs_kd 0.0956 (0.1058) loss_oracle 0.1541 (0.1611) acc 93.7500 (88.4375) kd_loss 0.8131 (0.7889) lr 1.5358e-03 eta 0:13:37
epoch [18/50] batch [40/176] time 0.100 (0.119) data 0.000 (0.024) loss 1.4322 (1.2603) ce_loss 0.4619 (0.3439) loss_zs_kd 0.1188 (0.1089) loss_oracle 0.1710 (0.1621) acc 84.3750 (88.5938) kd_loss 0.8253 (0.7810) lr 1.5358e-03 eta 0:11:27
epoch [18/50] batch [60/176] time 0.094 (0.112) data 0.000 (0.016) loss 1.2870 (1.2877) ce_loss 0.3188 (0.3745) loss_zs_kd 0.1567 (0.1094) loss_oracle 0.2097 (0.1700) acc 90.6250 (86.9271) kd_loss 0.7850 (0.7734) lr 1.5358e-03 eta 0:10:43
epoch [18/50] batch [80/176] time 0.102 (0.107) data 0.000 (0.012) loss 1.2066 (1.2907) ce_loss 0.3208 (0.3815) loss_zs_kd 0.0618 (0.1050) loss_oracle 0.1730 (0.1710) acc 90.6250 (86.7188) kd_loss 0.7684 (0.7712) lr 1.5358e-03 eta 0:10:14
epoch [18/50] batch [100/176] time 0.081 (0.105) data 0.000 (0.010) loss 1.1816 (1.2822) ce_loss 0.3489 (0.3787) loss_zs_kd 0.1069 (0.1030) loss_oracle 0.1795 (0.1726) acc 84.3750 (86.7812) kd_loss 0.6895 (0.7658) lr 1.5358e-03 eta 0:09:57
epoch [18/50] batch [120/176] time 0.081 (0.103) data 0.000 (0.008) loss 1.2315 (1.2763) ce_loss 0.4031 (0.3761) loss_zs_kd 0.0754 (0.1021) loss_oracle 0.1523 (0.1707) acc 90.6250 (87.1875) kd_loss 0.7145 (0.7638) lr 1.5358e-03 eta 0:09:44
epoch [18/50] batch [140/176] time 0.079 (0.102) data 0.000 (0.007) loss 1.1204 (1.2672) ce_loss 0.2228 (0.3698) loss_zs_kd 0.0984 (0.0992) loss_oracle 0.1884 (0.1698) acc 93.7500 (87.5670) kd_loss 0.7543 (0.7628) lr 1.5358e-03 eta 0:09:36
epoch [18/50] batch [160/176] time 0.104 (0.102) data 0.000 (0.006) loss 1.3282 (1.2714) ce_loss 0.3943 (0.3696) loss_zs_kd 0.1175 (0.0998) loss_oracle 0.2297 (0.1759) acc 87.5000 (87.6953) kd_loss 0.7603 (0.7640) lr 1.5358e-03 eta 0:09:34
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,195
* accuracy: 90.6%
* error: 9.4%
* macro_f1: 92.4%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,736
* accuracy: 65.4%
* error: 34.6%
* macro_f1: 60.0%
******* Domain l best val acc:      90.6%, epoch: 15 *******
******* Domain l best val test acc: 63.9%, epoch: 15 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [19/50] batch [20/176] time 0.156 (0.161) data 0.000 (0.048) loss 1.5217 (1.3109) ce_loss 0.6558 (0.3966) loss_zs_kd 0.1106 (0.0923) loss_oracle 0.1410 (0.1926) acc 78.1250 (84.5312) kd_loss 0.7402 (0.7719) lr 1.4818e-03 eta 0:15:04
epoch [19/50] batch [40/176] time 0.109 (0.132) data 0.000 (0.024) loss 1.0987 (1.2811) ce_loss 0.2299 (0.3923) loss_zs_kd 0.0874 (0.0969) loss_oracle 0.1173 (0.1608) acc 93.7500 (85.4688) kd_loss 0.7665 (0.7600) lr 1.4818e-03 eta 0:12:18
epoch [19/50] batch [60/176] time 0.133 (0.124) data 0.000 (0.016) loss 1.2042 (1.2777) ce_loss 0.2883 (0.3912) loss_zs_kd 0.0873 (0.0939) loss_oracle 0.1690 (0.1549) acc 93.7500 (85.4688) kd_loss 0.7877 (0.7622) lr 1.4818e-03 eta 0:11:30
epoch [19/50] batch [80/176] time 0.083 (0.117) data 0.000 (0.012) loss 1.3067 (1.2734) ce_loss 0.3503 (0.3761) loss_zs_kd 0.0804 (0.0953) loss_oracle 0.1979 (0.1622) acc 84.3750 (86.5234) kd_loss 0.8172 (0.7685) lr 1.4818e-03 eta 0:10:52
epoch [19/50] batch [100/176] time 0.084 (0.111) data 0.000 (0.010) loss 1.2991 (1.2809) ce_loss 0.5059 (0.3773) loss_zs_kd 0.0729 (0.0960) loss_oracle 0.1979 (0.1691) acc 78.1250 (86.7188) kd_loss 0.6578 (0.7711) lr 1.4818e-03 eta 0:10:12
epoch [19/50] batch [120/176] time 0.074 (0.109) data 0.000 (0.008) loss 1.3577 (1.2860) ce_loss 0.4512 (0.3750) loss_zs_kd 0.1010 (0.0954) loss_oracle 0.2201 (0.1784) acc 81.2500 (87.0573) kd_loss 0.7460 (0.7741) lr 1.4818e-03 eta 0:09:58
epoch [19/50] batch [140/176] time 0.139 (0.108) data 0.000 (0.007) loss 1.2257 (1.2838) ce_loss 0.3040 (0.3712) loss_zs_kd 0.1099 (0.0965) loss_oracle 0.1889 (0.1791) acc 93.7500 (87.2768) kd_loss 0.7724 (0.7748) lr 1.4818e-03 eta 0:09:53
epoch [19/50] batch [160/176] time 0.081 (0.107) data 0.000 (0.006) loss 1.4798 (1.2772) ce_loss 0.4929 (0.3628) loss_zs_kd 0.1401 (0.0977) loss_oracle 0.2001 (0.1798) acc 81.2500 (87.5781) kd_loss 0.8167 (0.7756) lr 1.4818e-03 eta 0:09:46
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,177
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 91.9%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,664
* accuracy: 62.7%
* error: 37.3%
* macro_f1: 58.7%
******* Domain l best val acc:      90.6%, epoch: 15 *******
******* Domain l best val test acc: 63.9%, epoch: 15 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [20/50] batch [20/176] time 0.096 (0.143) data 0.000 (0.050) loss 1.2314 (1.2585) ce_loss 0.3083 (0.3466) loss_zs_kd 0.1217 (0.1009) loss_oracle 0.1365 (0.1464) acc 87.5000 (88.9062) kd_loss 0.7939 (0.7883) lr 1.4258e-03 eta 0:12:54
epoch [20/50] batch [40/176] time 0.093 (0.118) data 0.000 (0.025) loss 1.1176 (1.2565) ce_loss 0.1962 (0.3412) loss_zs_kd 0.0548 (0.0995) loss_oracle 0.1805 (0.1582) acc 90.6250 (88.4375) kd_loss 0.8038 (0.7865) lr 1.4258e-03 eta 0:10:41
epoch [20/50] batch [60/176] time 0.099 (0.110) data 0.000 (0.017) loss 1.2028 (1.2550) ce_loss 0.3757 (0.3461) loss_zs_kd 0.0951 (0.1028) loss_oracle 0.1692 (0.1599) acc 90.6250 (88.0208) kd_loss 0.6949 (0.7776) lr 1.4258e-03 eta 0:09:54
epoch [20/50] batch [80/176] time 0.101 (0.107) data 0.000 (0.013) loss 1.2449 (1.2648) ce_loss 0.3528 (0.3513) loss_zs_kd 0.0857 (0.1005) loss_oracle 0.1953 (0.1690) acc 90.6250 (88.0469) kd_loss 0.7516 (0.7787) lr 1.4258e-03 eta 0:09:34
epoch [20/50] batch [100/176] time 0.094 (0.106) data 0.000 (0.010) loss 1.2740 (1.2682) ce_loss 0.3860 (0.3555) loss_zs_kd 0.0568 (0.0978) loss_oracle 0.2132 (0.1732) acc 84.3750 (87.9062) kd_loss 0.7530 (0.7771) lr 1.4258e-03 eta 0:09:26
epoch [20/50] batch [120/176] time 0.097 (0.105) data 0.000 (0.009) loss 1.3758 (1.2724) ce_loss 0.3838 (0.3564) loss_zs_kd 0.1244 (0.0992) loss_oracle 0.2246 (0.1756) acc 90.6250 (87.8646) kd_loss 0.8176 (0.7786) lr 1.4258e-03 eta 0:09:18
epoch [20/50] batch [140/176] time 0.099 (0.104) data 0.000 (0.007) loss 1.4760 (1.2747) ce_loss 0.4343 (0.3565) loss_zs_kd 0.1618 (0.0995) loss_oracle 0.2305 (0.1798) acc 81.2500 (87.7679) kd_loss 0.8455 (0.7785) lr 1.4258e-03 eta 0:09:12
epoch [20/50] batch [160/176] time 0.103 (0.103) data 0.001 (0.007) loss 1.1580 (1.2829) ce_loss 0.2754 (0.3603) loss_zs_kd 0.0851 (0.0997) loss_oracle 0.1627 (0.1824) acc 93.7500 (87.6367) kd_loss 0.7587 (0.7815) lr 1.4258e-03 eta 0:09:07
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,190
* accuracy: 90.4%
* error: 9.6%
* macro_f1: 92.2%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,748
* accuracy: 65.8%
* error: 34.2%
* macro_f1: 60.1%
******* Domain l best val acc:      90.6%, epoch: 15 *******
******* Domain l best val test acc: 63.9%, epoch: 15 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [21/50] batch [20/176] time 0.103 (0.160) data 0.000 (0.061) loss 1.1099 (1.2903) ce_loss 0.2407 (0.3744) loss_zs_kd 0.0909 (0.0987) loss_oracle 0.1343 (0.1649) acc 93.7500 (88.1250) kd_loss 0.7565 (0.7841) lr 1.3681e-03 eta 0:14:02
epoch [21/50] batch [40/176] time 0.093 (0.128) data 0.000 (0.031) loss 1.0747 (1.2754) ce_loss 0.2000 (0.3520) loss_zs_kd 0.0807 (0.0946) loss_oracle 0.1378 (0.1645) acc 93.7500 (88.3594) kd_loss 0.7656 (0.7939) lr 1.3681e-03 eta 0:11:10
epoch [21/50] batch [60/176] time 0.101 (0.117) data 0.000 (0.021) loss 1.3470 (1.2744) ce_loss 0.3420 (0.3581) loss_zs_kd 0.1245 (0.0961) loss_oracle 0.1537 (0.1586) acc 93.7500 (88.0208) kd_loss 0.8659 (0.7889) lr 1.3681e-03 eta 0:10:09
epoch [21/50] batch [80/176] time 0.103 (0.112) data 0.000 (0.015) loss 1.2880 (1.2763) ce_loss 0.4131 (0.3642) loss_zs_kd 0.1121 (0.0962) loss_oracle 0.1519 (0.1564) acc 93.7500 (87.7734) kd_loss 0.7429 (0.7858) lr 1.3681e-03 eta 0:09:43
epoch [21/50] batch [100/176] time 0.110 (0.110) data 0.000 (0.012) loss 1.2144 (1.2800) ce_loss 0.2615 (0.3673) loss_zs_kd 0.1286 (0.0951) loss_oracle 0.1548 (0.1571) acc 93.7500 (87.5625) kd_loss 0.8112 (0.7866) lr 1.3681e-03 eta 0:09:28
epoch [21/50] batch [120/176] time 0.099 (0.107) data 0.000 (0.010) loss 1.4508 (1.2889) ce_loss 0.5132 (0.3759) loss_zs_kd 0.0597 (0.0948) loss_oracle 0.1784 (0.1569) acc 81.2500 (87.0833) kd_loss 0.8185 (0.7870) lr 1.3681e-03 eta 0:09:13
epoch [21/50] batch [140/176] time 0.076 (0.104) data 0.000 (0.009) loss 1.0544 (1.2816) ce_loss 0.1953 (0.3702) loss_zs_kd 0.0840 (0.0951) loss_oracle 0.1271 (0.1562) acc 93.7500 (87.2098) kd_loss 0.7536 (0.7856) lr 1.3681e-03 eta 0:08:54
epoch [21/50] batch [160/176] time 0.081 (0.102) data 0.000 (0.008) loss 1.1894 (1.2767) ce_loss 0.2678 (0.3697) loss_zs_kd 0.1013 (0.0943) loss_oracle 0.1612 (0.1534) acc 87.5000 (86.9531) kd_loss 0.7903 (0.7832) lr 1.3681e-03 eta 0:08:41
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,195
* accuracy: 90.6%
* error: 9.4%
* macro_f1: 92.4%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,688
* accuracy: 63.6%
* error: 36.4%
* macro_f1: 58.7%
******* Domain l best val acc:      90.6%, epoch: 15 *******
******* Domain l best val test acc: 63.9%, epoch: 15 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [22/50] batch [20/176] time 0.161 (0.171) data 0.000 (0.063) loss 1.3101 (1.2871) ce_loss 0.3611 (0.3751) loss_zs_kd 0.0711 (0.1058) loss_oracle 0.1484 (0.1367) acc 84.3750 (86.2500) kd_loss 0.8393 (0.7907) lr 1.3090e-03 eta 0:14:30
epoch [22/50] batch [40/176] time 0.136 (0.135) data 0.000 (0.032) loss 1.2930 (1.2801) ce_loss 0.4485 (0.3733) loss_zs_kd 0.0625 (0.1019) loss_oracle 0.1293 (0.1449) acc 81.2500 (86.1719) kd_loss 0.7485 (0.7833) lr 1.3090e-03 eta 0:11:23
epoch [22/50] batch [60/176] time 0.081 (0.124) data 0.001 (0.021) loss 1.2287 (1.2648) ce_loss 0.2905 (0.3718) loss_zs_kd 0.1115 (0.0975) loss_oracle 0.2088 (0.1464) acc 84.3750 (86.3021) kd_loss 0.7780 (0.7710) lr 1.3090e-03 eta 0:10:23
epoch [22/50] batch [80/176] time 0.092 (0.114) data 0.000 (0.016) loss 1.2709 (1.2717) ce_loss 0.3337 (0.3698) loss_zs_kd 0.0826 (0.0976) loss_oracle 0.1854 (0.1484) acc 93.7500 (86.5625) kd_loss 0.8031 (0.7789) lr 1.3090e-03 eta 0:09:35
epoch [22/50] batch [100/176] time 0.099 (0.111) data 0.000 (0.013) loss 1.3072 (1.2844) ce_loss 0.3306 (0.3758) loss_zs_kd 0.1009 (0.0975) loss_oracle 0.1526 (0.1520) acc 90.6250 (86.5938) kd_loss 0.8499 (0.7839) lr 1.3090e-03 eta 0:09:16
epoch [22/50] batch [120/176] time 0.102 (0.109) data 0.000 (0.011) loss 1.4969 (1.2856) ce_loss 0.6016 (0.3757) loss_zs_kd 0.1315 (0.0980) loss_oracle 0.1723 (0.1519) acc 84.3750 (86.4583) kd_loss 0.7434 (0.7850) lr 1.3090e-03 eta 0:09:04
epoch [22/50] batch [140/176] time 0.084 (0.108) data 0.000 (0.009) loss 1.2914 (1.2819) ce_loss 0.2676 (0.3703) loss_zs_kd 0.0882 (0.0963) loss_oracle 0.1416 (0.1512) acc 93.7500 (86.7634) kd_loss 0.9090 (0.7878) lr 1.3090e-03 eta 0:08:54
epoch [22/50] batch [160/176] time 0.094 (0.107) data 0.000 (0.008) loss 1.4090 (1.2846) ce_loss 0.4111 (0.3726) loss_zs_kd 0.0859 (0.0950) loss_oracle 0.1597 (0.1512) acc 81.2500 (86.7578) kd_loss 0.8750 (0.7890) lr 1.3090e-03 eta 0:08:47
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,201
* accuracy: 90.9%
* error: 9.1%
* macro_f1: 92.6%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,745
* accuracy: 65.7%
* error: 34.3%
* macro_f1: 60.3%
******* Domain l best val acc:      90.9%, epoch: 22 *******
******* Domain l best val test acc: 65.7%, epoch: 22 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [23/50] batch [20/176] time 0.094 (0.153) data 0.000 (0.056) loss 1.2920 (1.3046) ce_loss 0.4043 (0.3906) loss_zs_kd 0.0803 (0.0851) loss_oracle 0.1315 (0.1576) acc 90.6250 (85.7812) kd_loss 0.7818 (0.7927) lr 1.2487e-03 eta 0:12:32
epoch [23/50] batch [40/176] time 0.089 (0.123) data 0.000 (0.028) loss 1.2535 (1.2861) ce_loss 0.3989 (0.3641) loss_zs_kd 0.0911 (0.0952) loss_oracle 0.1426 (0.1597) acc 81.2500 (87.0312) kd_loss 0.7378 (0.7946) lr 1.2487e-03 eta 0:10:00
epoch [23/50] batch [60/176] time 0.096 (0.113) data 0.000 (0.019) loss 1.3175 (1.3023) ce_loss 0.4043 (0.3726) loss_zs_kd 0.0674 (0.0958) loss_oracle 0.1247 (0.1570) acc 84.3750 (86.8229) kd_loss 0.8172 (0.8032) lr 1.2487e-03 eta 0:09:10
epoch [23/50] batch [80/176] time 0.092 (0.108) data 0.000 (0.014) loss 1.3597 (1.3006) ce_loss 0.5117 (0.3768) loss_zs_kd 0.0785 (0.0956) loss_oracle 0.1477 (0.1550) acc 78.1250 (86.8359) kd_loss 0.7349 (0.7985) lr 1.2487e-03 eta 0:08:44
epoch [23/50] batch [100/176] time 0.094 (0.105) data 0.000 (0.011) loss 1.4564 (1.2926) ce_loss 0.5068 (0.3700) loss_zs_kd 0.1038 (0.0953) loss_oracle 0.1126 (0.1504) acc 75.0000 (87.0000) kd_loss 0.8414 (0.7998) lr 1.2487e-03 eta 0:08:25
epoch [23/50] batch [120/176] time 0.084 (0.102) data 0.000 (0.009) loss 1.0220 (1.2944) ce_loss 0.1997 (0.3699) loss_zs_kd 0.0764 (0.0956) loss_oracle 0.1421 (0.1462) acc 93.7500 (87.1615) kd_loss 0.7131 (0.8035) lr 1.2487e-03 eta 0:08:11
epoch [23/50] batch [140/176] time 0.084 (0.101) data 0.000 (0.008) loss 1.2323 (1.2915) ce_loss 0.3259 (0.3715) loss_zs_kd 0.1030 (0.0959) loss_oracle 0.1292 (0.1426) acc 90.6250 (87.2545) kd_loss 0.7903 (0.8008) lr 1.2487e-03 eta 0:08:03
epoch [23/50] batch [160/176] time 0.096 (0.100) data 0.000 (0.007) loss 1.2320 (1.2854) ce_loss 0.2788 (0.3655) loss_zs_kd 0.1088 (0.0958) loss_oracle 0.1673 (0.1416) acc 96.8750 (87.5391) kd_loss 0.8152 (0.8012) lr 1.2487e-03 eta 0:07:56
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,179
* accuracy: 90.0%
* error: 10.0%
* macro_f1: 91.9%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,647
* accuracy: 62.0%
* error: 38.0%
* macro_f1: 58.0%
******* Domain l best val acc:      90.9%, epoch: 22 *******
******* Domain l best val test acc: 65.7%, epoch: 22 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [24/50] batch [20/176] time 0.076 (0.137) data 0.000 (0.056) loss 1.2462 (1.2690) ce_loss 0.3066 (0.3357) loss_zs_kd 0.1459 (0.1121) loss_oracle 0.1075 (0.1339) acc 93.7500 (88.9062) kd_loss 0.8128 (0.8103) lr 1.1874e-03 eta 0:10:49
epoch [24/50] batch [40/176] time 0.067 (0.117) data 0.000 (0.028) loss 1.2629 (1.2681) ce_loss 0.2495 (0.3337) loss_zs_kd 0.1078 (0.1033) loss_oracle 0.1442 (0.1306) acc 93.7500 (88.2812) kd_loss 0.8874 (0.8175) lr 1.1874e-03 eta 0:09:09
epoch [24/50] batch [60/176] time 0.083 (0.113) data 0.000 (0.019) loss 1.2028 (1.2927) ce_loss 0.3298 (0.3588) loss_zs_kd 0.0800 (0.1058) loss_oracle 0.1141 (0.1323) acc 87.5000 (87.5000) kd_loss 0.7759 (0.8149) lr 1.1874e-03 eta 0:08:48
epoch [24/50] batch [80/176] time 0.071 (0.108) data 0.000 (0.014) loss 1.2287 (1.2941) ce_loss 0.2854 (0.3607) loss_zs_kd 0.0588 (0.1016) loss_oracle 0.1333 (0.1327) acc 87.5000 (87.1875) kd_loss 0.8473 (0.8163) lr 1.1874e-03 eta 0:08:25
epoch [24/50] batch [100/176] time 0.152 (0.107) data 0.000 (0.011) loss 1.1206 (1.2891) ce_loss 0.1726 (0.3589) loss_zs_kd 0.0504 (0.1009) loss_oracle 0.1368 (0.1345) acc 96.8750 (87.4688) kd_loss 0.8544 (0.8125) lr 1.1874e-03 eta 0:08:18
epoch [24/50] batch [120/176] time 0.083 (0.106) data 0.000 (0.010) loss 1.2385 (1.2878) ce_loss 0.2761 (0.3575) loss_zs_kd 0.0753 (0.0993) loss_oracle 0.1625 (0.1353) acc 87.5000 (87.4479) kd_loss 0.8435 (0.8130) lr 1.1874e-03 eta 0:08:11
epoch [24/50] batch [140/176] time 0.100 (0.103) data 0.000 (0.008) loss 1.1716 (1.2837) ce_loss 0.2922 (0.3525) loss_zs_kd 0.0944 (0.0990) loss_oracle 0.1673 (0.1349) acc 90.6250 (87.5670) kd_loss 0.7486 (0.8142) lr 1.1874e-03 eta 0:07:57
epoch [24/50] batch [160/176] time 0.072 (0.104) data 0.000 (0.007) loss 1.4156 (1.2922) ce_loss 0.4480 (0.3576) loss_zs_kd 0.0734 (0.1009) loss_oracle 0.1530 (0.1360) acc 84.3750 (87.3047) kd_loss 0.8544 (0.8162) lr 1.1874e-03 eta 0:07:59
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,191
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 92.3%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,693
* accuracy: 63.7%
* error: 36.3%
* macro_f1: 59.1%
******* Domain l best val acc:      90.9%, epoch: 22 *******
******* Domain l best val test acc: 65.7%, epoch: 22 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [25/50] batch [20/176] time 0.089 (0.163) data 0.000 (0.075) loss 1.4239 (1.3035) ce_loss 0.3994 (0.3599) loss_zs_kd 0.0947 (0.0885) loss_oracle 0.1247 (0.1411) acc 87.5000 (87.1875) kd_loss 0.9148 (0.8289) lr 1.1253e-03 eta 0:12:21
epoch [25/50] batch [40/176] time 0.074 (0.125) data 0.000 (0.038) loss 1.2706 (1.3062) ce_loss 0.3328 (0.3590) loss_zs_kd 0.0942 (0.0891) loss_oracle 0.1466 (0.1475) acc 90.6250 (87.6562) kd_loss 0.8174 (0.8289) lr 1.1253e-03 eta 0:09:25
epoch [25/50] batch [60/176] time 0.069 (0.111) data 0.000 (0.025) loss 1.3623 (1.2928) ce_loss 0.3799 (0.3512) loss_zs_kd 0.1020 (0.0926) loss_oracle 0.1810 (0.1545) acc 90.6250 (88.0208) kd_loss 0.8410 (0.8180) lr 1.1253e-03 eta 0:08:19
epoch [25/50] batch [80/176] time 0.085 (0.104) data 0.001 (0.019) loss 1.2819 (1.2887) ce_loss 0.2905 (0.3505) loss_zs_kd 0.1007 (0.0947) loss_oracle 0.1336 (0.1573) acc 87.5000 (87.8516) kd_loss 0.8742 (0.8122) lr 1.1253e-03 eta 0:07:49
epoch [25/50] batch [100/176] time 0.085 (0.100) data 0.000 (0.015) loss 1.2885 (1.2973) ce_loss 0.3494 (0.3567) loss_zs_kd 0.0872 (0.0952) loss_oracle 0.1968 (0.1591) acc 93.7500 (87.5312) kd_loss 0.7972 (0.8134) lr 1.1253e-03 eta 0:07:27
epoch [25/50] batch [120/176] time 0.095 (0.098) data 0.000 (0.013) loss 1.5793 (1.3014) ce_loss 0.6050 (0.3643) loss_zs_kd 0.0631 (0.0962) loss_oracle 0.1714 (0.1593) acc 78.1250 (87.3698) kd_loss 0.8571 (0.8094) lr 1.1253e-03 eta 0:07:17
epoch [25/50] batch [140/176] time 0.106 (0.098) data 0.000 (0.011) loss 1.1870 (1.3088) ce_loss 0.2515 (0.3688) loss_zs_kd 0.0599 (0.0966) loss_oracle 0.1784 (0.1612) acc 87.5000 (87.2321) kd_loss 0.8164 (0.8111) lr 1.1253e-03 eta 0:07:13
epoch [25/50] batch [160/176] time 0.089 (0.097) data 0.000 (0.010) loss 1.3763 (1.3112) ce_loss 0.4536 (0.3692) loss_zs_kd 0.0911 (0.0976) loss_oracle 0.1664 (0.1615) acc 87.5000 (87.2852) kd_loss 0.7940 (0.8124) lr 1.1253e-03 eta 0:07:07
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,190
* accuracy: 90.4%
* error: 9.6%
* macro_f1: 92.3%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,666
* accuracy: 62.7%
* error: 37.3%
* macro_f1: 58.6%
******* Domain l best val acc:      90.9%, epoch: 22 *******
******* Domain l best val test acc: 65.7%, epoch: 22 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [26/50] batch [20/176] time 0.072 (0.146) data 0.000 (0.063) loss 1.4116 (1.2643) ce_loss 0.4805 (0.3444) loss_zs_kd 0.1002 (0.1075) loss_oracle 0.1523 (0.1599) acc 84.3750 (89.2188) kd_loss 0.8049 (0.7861) lr 1.0628e-03 eta 0:10:38
epoch [26/50] batch [40/176] time 0.090 (0.114) data 0.000 (0.032) loss 1.4302 (1.2960) ce_loss 0.5264 (0.3798) loss_zs_kd 0.1072 (0.1036) loss_oracle 0.1417 (0.1547) acc 78.1250 (87.5000) kd_loss 0.7794 (0.7870) lr 1.0628e-03 eta 0:08:15
epoch [26/50] batch [60/176] time 0.092 (0.103) data 0.000 (0.021) loss 1.2743 (1.3032) ce_loss 0.3804 (0.3823) loss_zs_kd 0.0769 (0.1006) loss_oracle 0.1658 (0.1575) acc 84.3750 (87.1354) kd_loss 0.7726 (0.7918) lr 1.0628e-03 eta 0:07:27
epoch [26/50] batch [80/176] time 0.073 (0.098) data 0.000 (0.016) loss 1.4120 (1.3121) ce_loss 0.3042 (0.3811) loss_zs_kd 0.1074 (0.1033) loss_oracle 0.2080 (0.1585) acc 84.3750 (86.9922) kd_loss 0.9501 (0.8001) lr 1.0628e-03 eta 0:07:01
epoch [26/50] batch [100/176] time 0.096 (0.094) data 0.000 (0.013) loss 1.1253 (1.3182) ce_loss 0.2883 (0.3858) loss_zs_kd 0.1463 (0.1020) loss_oracle 0.1609 (0.1601) acc 87.5000 (86.5312) kd_loss 0.6833 (0.8013) lr 1.0628e-03 eta 0:06:44
epoch [26/50] batch [120/176] time 0.092 (0.091) data 0.000 (0.011) loss 1.2087 (1.3107) ce_loss 0.2266 (0.3787) loss_zs_kd 0.0651 (0.0991) loss_oracle 0.2008 (0.1633) acc 93.7500 (86.9271) kd_loss 0.8492 (0.8008) lr 1.0628e-03 eta 0:06:31
epoch [26/50] batch [140/176] time 0.069 (0.090) data 0.000 (0.009) loss 1.3734 (1.3063) ce_loss 0.4287 (0.3741) loss_zs_kd 0.1445 (0.0985) loss_oracle 0.1248 (0.1608) acc 84.3750 (87.0759) kd_loss 0.8100 (0.8025) lr 1.0628e-03 eta 0:06:24
epoch [26/50] batch [160/176] time 0.088 (0.089) data 0.000 (0.008) loss 1.1853 (1.3010) ce_loss 0.2076 (0.3690) loss_zs_kd 0.0778 (0.0982) loss_oracle 0.2213 (0.1606) acc 93.7500 (87.2266) kd_loss 0.8281 (0.8026) lr 1.0628e-03 eta 0:06:16
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,187
* accuracy: 90.3%
* error: 9.7%
* macro_f1: 92.2%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,674
* accuracy: 63.0%
* error: 37.0%
* macro_f1: 58.8%
******* Domain l best val acc:      90.9%, epoch: 22 *******
******* Domain l best val test acc: 65.7%, epoch: 22 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [27/50] batch [20/176] time 0.156 (0.174) data 0.000 (0.065) loss 1.1163 (1.2989) ce_loss 0.1902 (0.3400) loss_zs_kd 0.1277 (0.1062) loss_oracle 0.1705 (0.1670) acc 90.6250 (88.7500) kd_loss 0.7770 (0.8223) lr 1.0000e-03 eta 0:12:10
epoch [27/50] batch [40/176] time 0.103 (0.140) data 0.000 (0.033) loss 1.0828 (1.2800) ce_loss 0.1117 (0.3276) loss_zs_kd 0.0580 (0.1026) loss_oracle 0.1515 (0.1657) acc 100.0000 (89.0625) kd_loss 0.8663 (0.8183) lr 1.0000e-03 eta 0:09:44
epoch [27/50] batch [60/176] time 0.079 (0.129) data 0.000 (0.022) loss 1.4046 (1.2932) ce_loss 0.3508 (0.3441) loss_zs_kd 0.1464 (0.1025) loss_oracle 0.1910 (0.1637) acc 84.3750 (88.1771) kd_loss 0.8850 (0.8160) lr 1.0000e-03 eta 0:08:55
epoch [27/50] batch [80/176] time 0.081 (0.117) data 0.000 (0.016) loss 1.2314 (1.2974) ce_loss 0.2620 (0.3456) loss_zs_kd 0.1574 (0.1043) loss_oracle 0.1802 (0.1681) acc 96.8750 (88.2422) kd_loss 0.8007 (0.8157) lr 1.0000e-03 eta 0:08:06
epoch [27/50] batch [100/176] time 0.096 (0.112) data 0.000 (0.013) loss 1.3331 (1.2994) ce_loss 0.3069 (0.3445) loss_zs_kd 0.1036 (0.1042) loss_oracle 0.1619 (0.1707) acc 87.5000 (88.0938) kd_loss 0.8935 (0.8175) lr 1.0000e-03 eta 0:07:41
epoch [27/50] batch [120/176] time 0.085 (0.109) data 0.000 (0.011) loss 1.3495 (1.3012) ce_loss 0.3369 (0.3447) loss_zs_kd 0.1407 (0.1058) loss_oracle 0.1724 (0.1692) acc 84.3750 (87.9167) kd_loss 0.8560 (0.8191) lr 1.0000e-03 eta 0:07:25
epoch [27/50] batch [140/176] time 0.093 (0.106) data 0.000 (0.010) loss 1.1632 (1.3072) ce_loss 0.2375 (0.3527) loss_zs_kd 0.0749 (0.1040) loss_oracle 0.2063 (0.1672) acc 90.6250 (87.4107) kd_loss 0.7851 (0.8190) lr 1.0000e-03 eta 0:07:14
epoch [27/50] batch [160/176] time 0.087 (0.104) data 0.000 (0.008) loss 1.3990 (1.3139) ce_loss 0.5195 (0.3588) loss_zs_kd 0.1059 (0.1036) loss_oracle 0.1600 (0.1684) acc 90.6250 (87.0898) kd_loss 0.7466 (0.8191) lr 1.0000e-03 eta 0:07:04
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,197
* accuracy: 90.7%
* error: 9.3%
* macro_f1: 92.5%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,644
* accuracy: 61.9%
* error: 38.1%
* macro_f1: 57.5%
******* Domain l best val acc:      90.9%, epoch: 22 *******
******* Domain l best val test acc: 65.7%, epoch: 22 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [28/50] batch [20/176] time 0.099 (0.175) data 0.000 (0.073) loss 1.3343 (1.2941) ce_loss 0.2676 (0.3368) loss_zs_kd 0.0979 (0.1023) loss_oracle 0.2064 (0.1590) acc 90.6250 (88.9062) kd_loss 0.9146 (0.8266) lr 9.3721e-04 eta 0:11:43
epoch [28/50] batch [40/176] time 0.108 (0.138) data 0.000 (0.037) loss 1.0800 (1.3129) ce_loss 0.2064 (0.3533) loss_zs_kd 0.0830 (0.0999) loss_oracle 0.1701 (0.1591) acc 90.6250 (87.5000) kd_loss 0.7470 (0.8301) lr 9.3721e-04 eta 0:09:11
epoch [28/50] batch [60/176] time 0.095 (0.125) data 0.000 (0.025) loss 1.5841 (1.3225) ce_loss 0.5649 (0.3612) loss_zs_kd 0.1071 (0.0978) loss_oracle 0.1515 (0.1611) acc 81.2500 (86.9792) kd_loss 0.8898 (0.8318) lr 9.3721e-04 eta 0:08:16
epoch [28/50] batch [80/176] time 0.103 (0.118) data 0.000 (0.019) loss 1.2213 (1.3184) ce_loss 0.2710 (0.3582) loss_zs_kd 0.0823 (0.0971) loss_oracle 0.1393 (0.1608) acc 87.5000 (86.8359) kd_loss 0.8395 (0.8312) lr 9.3721e-04 eta 0:07:49
epoch [28/50] batch [100/176] time 0.094 (0.114) data 0.000 (0.015) loss 1.1231 (1.3183) ce_loss 0.1769 (0.3566) loss_zs_kd 0.0986 (0.0988) loss_oracle 0.1302 (0.1602) acc 96.8750 (87.0625) kd_loss 0.8318 (0.8322) lr 9.3721e-04 eta 0:07:31
epoch [28/50] batch [120/176] time 0.090 (0.112) data 0.000 (0.012) loss 1.4471 (1.3252) ce_loss 0.5044 (0.3612) loss_zs_kd 0.1186 (0.1009) loss_oracle 0.1340 (0.1588) acc 87.5000 (87.0573) kd_loss 0.8164 (0.8342) lr 9.3721e-04 eta 0:07:18
epoch [28/50] batch [140/176] time 0.093 (0.109) data 0.000 (0.011) loss 1.3831 (1.3214) ce_loss 0.3638 (0.3582) loss_zs_kd 0.1199 (0.1002) loss_oracle 0.1417 (0.1554) acc 81.2500 (87.1205) kd_loss 0.8885 (0.8354) lr 9.3721e-04 eta 0:07:06
epoch [28/50] batch [160/176] time 0.102 (0.107) data 0.000 (0.009) loss 1.1662 (1.3174) ce_loss 0.2781 (0.3581) loss_zs_kd 0.0760 (0.0993) loss_oracle 0.1468 (0.1532) acc 87.5000 (87.2852) kd_loss 0.7767 (0.8331) lr 9.3721e-04 eta 0:06:57
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,199
* accuracy: 90.8%
* error: 9.2%
* macro_f1: 92.6%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,700
* accuracy: 64.0%
* error: 36.0%
* macro_f1: 59.4%
******* Domain l best val acc:      90.9%, epoch: 22 *******
******* Domain l best val test acc: 65.7%, epoch: 22 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [29/50] batch [20/176] time 0.083 (0.137) data 0.000 (0.067) loss 1.2138 (1.3170) ce_loss 0.3884 (0.3747) loss_zs_kd 0.1065 (0.0963) loss_oracle 0.1543 (0.1406) acc 90.6250 (87.0312) kd_loss 0.6950 (0.8238) lr 8.7467e-04 eta 0:08:46
epoch [29/50] batch [40/176] time 0.068 (0.122) data 0.000 (0.034) loss 1.2907 (1.3077) ce_loss 0.3022 (0.3694) loss_zs_kd 0.0977 (0.0977) loss_oracle 0.1680 (0.1419) acc 87.5000 (87.1875) kd_loss 0.8556 (0.8184) lr 8.7467e-04 eta 0:07:46
epoch [29/50] batch [60/176] time 0.074 (0.118) data 0.000 (0.023) loss 1.5468 (1.3064) ce_loss 0.6108 (0.3728) loss_zs_kd 0.1273 (0.0986) loss_oracle 0.1509 (0.1431) acc 78.1250 (87.2396) kd_loss 0.7968 (0.8128) lr 8.7467e-04 eta 0:07:31
epoch [29/50] batch [80/176] time 0.079 (0.116) data 0.000 (0.017) loss 1.3387 (1.3056) ce_loss 0.3928 (0.3719) loss_zs_kd 0.0674 (0.0962) loss_oracle 0.1828 (0.1447) acc 81.2500 (87.2656) kd_loss 0.8208 (0.8132) lr 8.7467e-04 eta 0:07:21
epoch [29/50] batch [100/176] time 0.085 (0.113) data 0.000 (0.014) loss 1.4351 (1.3071) ce_loss 0.5459 (0.3772) loss_zs_kd 0.0651 (0.0955) loss_oracle 0.1232 (0.1441) acc 81.2500 (87.0938) kd_loss 0.7950 (0.8101) lr 8.7467e-04 eta 0:07:07
epoch [29/50] batch [120/176] time 0.087 (0.108) data 0.000 (0.011) loss 1.2297 (1.3010) ce_loss 0.2739 (0.3720) loss_zs_kd 0.1317 (0.0975) loss_oracle 0.1251 (0.1432) acc 96.8750 (87.2396) kd_loss 0.8273 (0.8087) lr 8.7467e-04 eta 0:06:46
epoch [29/50] batch [140/176] time 0.081 (0.107) data 0.000 (0.010) loss 1.2271 (1.2962) ce_loss 0.4041 (0.3699) loss_zs_kd 0.0996 (0.0966) loss_oracle 0.1036 (0.1435) acc 87.5000 (87.2321) kd_loss 0.7214 (0.8062) lr 8.7467e-04 eta 0:06:39
epoch [29/50] batch [160/176] time 0.084 (0.108) data 0.000 (0.009) loss 1.2772 (1.2988) ce_loss 0.2817 (0.3666) loss_zs_kd 0.1426 (0.0982) loss_oracle 0.1551 (0.1430) acc 93.7500 (87.5195) kd_loss 0.8466 (0.8116) lr 8.7467e-04 eta 0:06:40
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,202
* accuracy: 90.9%
* error: 9.1%
* macro_f1: 92.6%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,748
* accuracy: 65.8%
* error: 34.2%
* macro_f1: 59.9%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [30/50] batch [20/176] time 0.096 (0.169) data 0.000 (0.073) loss 1.1400 (1.2653) ce_loss 0.2776 (0.3587) loss_zs_kd 0.0620 (0.0912) loss_oracle 0.1422 (0.1410) acc 90.6250 (87.8125) kd_loss 0.7603 (0.7905) lr 8.1262e-04 eta 0:10:22
epoch [30/50] batch [40/176] time 0.093 (0.132) data 0.000 (0.037) loss 1.2584 (1.2606) ce_loss 0.3037 (0.3504) loss_zs_kd 0.0898 (0.0928) loss_oracle 0.1620 (0.1469) acc 90.6250 (87.8125) kd_loss 0.8288 (0.7903) lr 8.1262e-04 eta 0:08:02
epoch [30/50] batch [60/176] time 0.098 (0.121) data 0.000 (0.025) loss 1.2595 (1.2710) ce_loss 0.2678 (0.3537) loss_zs_kd 0.0868 (0.0931) loss_oracle 0.1544 (0.1559) acc 93.7500 (87.8125) kd_loss 0.8710 (0.7928) lr 8.1262e-04 eta 0:07:19
epoch [30/50] batch [80/176] time 0.099 (0.115) data 0.000 (0.019) loss 1.2400 (1.2876) ce_loss 0.4172 (0.3624) loss_zs_kd 0.0810 (0.0950) loss_oracle 0.1515 (0.1551) acc 81.2500 (87.4609) kd_loss 0.7065 (0.8001) lr 8.1262e-04 eta 0:06:57
epoch [30/50] batch [100/176] time 0.097 (0.111) data 0.000 (0.015) loss 1.2780 (1.2947) ce_loss 0.2781 (0.3693) loss_zs_kd 0.0928 (0.0983) loss_oracle 0.1390 (0.1540) acc 93.7500 (87.0938) kd_loss 0.8840 (0.7992) lr 8.1262e-04 eta 0:06:39
epoch [30/50] batch [120/176] time 0.102 (0.108) data 0.000 (0.012) loss 1.3801 (1.2943) ce_loss 0.3765 (0.3687) loss_zs_kd 0.0989 (0.0994) loss_oracle 0.1640 (0.1534) acc 87.5000 (86.9792) kd_loss 0.8722 (0.7993) lr 8.1262e-04 eta 0:06:27
epoch [30/50] batch [140/176] time 0.094 (0.107) data 0.000 (0.011) loss 1.3045 (1.2929) ce_loss 0.3301 (0.3687) loss_zs_kd 0.0765 (0.0999) loss_oracle 0.2103 (0.1540) acc 84.3750 (87.0312) kd_loss 0.8310 (0.7973) lr 8.1262e-04 eta 0:06:19
epoch [30/50] batch [160/176] time 0.097 (0.105) data 0.000 (0.009) loss 1.1069 (1.2860) ce_loss 0.1747 (0.3629) loss_zs_kd 0.1350 (0.0992) loss_oracle 0.1633 (0.1548) acc 96.8750 (87.2266) kd_loss 0.7831 (0.7962) lr 8.1262e-04 eta 0:06:11
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,191
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 92.3%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,681
* accuracy: 63.3%
* error: 36.7%
* macro_f1: 59.4%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [31/50] batch [20/176] time 0.087 (0.164) data 0.000 (0.071) loss 1.2627 (1.2391) ce_loss 0.1837 (0.3227) loss_zs_kd 0.1270 (0.0951) loss_oracle 0.1826 (0.1683) acc 96.8750 (88.5938) kd_loss 0.9242 (0.7847) lr 7.5131e-04 eta 0:09:34
epoch [31/50] batch [40/176] time 0.095 (0.128) data 0.000 (0.036) loss 1.4049 (1.2703) ce_loss 0.4150 (0.3452) loss_zs_kd 0.0900 (0.1001) loss_oracle 0.1976 (0.1727) acc 87.5000 (88.4375) kd_loss 0.8460 (0.7888) lr 7.5131e-04 eta 0:07:25
epoch [31/50] batch [60/176] time 0.095 (0.115) data 0.000 (0.024) loss 1.5446 (1.2775) ce_loss 0.5132 (0.3600) loss_zs_kd 0.1200 (0.1003) loss_oracle 0.1878 (0.1664) acc 75.0000 (87.5000) kd_loss 0.8775 (0.7842) lr 7.5131e-04 eta 0:06:38
epoch [31/50] batch [80/176] time 0.081 (0.108) data 0.000 (0.018) loss 1.1658 (1.2841) ce_loss 0.3245 (0.3650) loss_zs_kd 0.1438 (0.0979) loss_oracle 0.1278 (0.1665) acc 87.5000 (87.0703) kd_loss 0.7055 (0.7869) lr 7.5131e-04 eta 0:06:12
epoch [31/50] batch [100/176] time 0.083 (0.105) data 0.000 (0.014) loss 1.4602 (1.2848) ce_loss 0.4570 (0.3625) loss_zs_kd 0.1333 (0.0981) loss_oracle 0.1602 (0.1670) acc 81.2500 (87.2500) kd_loss 0.8564 (0.7897) lr 7.5131e-04 eta 0:05:59
epoch [31/50] batch [120/176] time 0.070 (0.101) data 0.000 (0.012) loss 1.1254 (1.2819) ce_loss 0.2688 (0.3593) loss_zs_kd 0.0701 (0.0974) loss_oracle 0.1545 (0.1677) acc 87.5000 (87.3958) kd_loss 0.7443 (0.7901) lr 7.5131e-04 eta 0:05:42
epoch [31/50] batch [140/176] time 0.073 (0.100) data 0.000 (0.010) loss 0.9867 (1.2802) ce_loss 0.1296 (0.3576) loss_zs_kd 0.0599 (0.0979) loss_oracle 0.1821 (0.1703) acc 100.0000 (87.5223) kd_loss 0.7361 (0.7884) lr 7.5131e-04 eta 0:05:37
epoch [31/50] batch [160/176] time 0.079 (0.100) data 0.000 (0.009) loss 1.2860 (1.2831) ce_loss 0.4282 (0.3583) loss_zs_kd 0.1043 (0.0989) loss_oracle 0.2177 (0.1719) acc 93.7500 (87.5586) kd_loss 0.6968 (0.7894) lr 7.5131e-04 eta 0:05:36
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,187
* accuracy: 90.3%
* error: 9.7%
* macro_f1: 92.2%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,682
* accuracy: 63.3%
* error: 36.7%
* macro_f1: 59.1%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [32/50] batch [20/176] time 0.142 (0.174) data 0.000 (0.071) loss 1.3003 (1.3111) ce_loss 0.2952 (0.3820) loss_zs_kd 0.0739 (0.1073) loss_oracle 0.1920 (0.1684) acc 87.5000 (87.3438) kd_loss 0.8722 (0.7913) lr 6.9098e-04 eta 0:09:38
epoch [32/50] batch [40/176] time 0.081 (0.134) data 0.000 (0.036) loss 1.1867 (1.3034) ce_loss 0.2197 (0.3700) loss_zs_kd 0.1005 (0.1063) loss_oracle 0.1259 (0.1669) acc 90.6250 (87.5000) kd_loss 0.8538 (0.7968) lr 6.9098e-04 eta 0:07:22
epoch [32/50] batch [60/176] time 0.092 (0.118) data 0.000 (0.024) loss 1.6779 (1.3054) ce_loss 0.7305 (0.3750) loss_zs_kd 0.0928 (0.1074) loss_oracle 0.1976 (0.1656) acc 81.2500 (87.1875) kd_loss 0.8022 (0.7939) lr 6.9098e-04 eta 0:06:27
epoch [32/50] batch [80/176] time 0.106 (0.112) data 0.000 (0.018) loss 1.4435 (1.2962) ce_loss 0.5664 (0.3654) loss_zs_kd 0.0837 (0.1050) loss_oracle 0.1725 (0.1668) acc 78.1250 (87.5391) kd_loss 0.7490 (0.7949) lr 6.9098e-04 eta 0:06:05
epoch [32/50] batch [100/176] time 0.102 (0.109) data 0.000 (0.015) loss 1.3553 (1.3051) ce_loss 0.5332 (0.3705) loss_zs_kd 0.0921 (0.1047) loss_oracle 0.1264 (0.1666) acc 65.6250 (87.1562) kd_loss 0.7128 (0.7990) lr 6.9098e-04 eta 0:05:54
epoch [32/50] batch [120/176] time 0.097 (0.107) data 0.000 (0.012) loss 1.4478 (1.2978) ce_loss 0.4565 (0.3650) loss_zs_kd 0.1470 (0.1033) loss_oracle 0.1846 (0.1664) acc 78.1250 (87.2396) kd_loss 0.8255 (0.7979) lr 6.9098e-04 eta 0:05:45
epoch [32/50] batch [140/176] time 0.097 (0.106) data 0.000 (0.010) loss 1.1623 (1.2936) ce_loss 0.2581 (0.3606) loss_zs_kd 0.0687 (0.1021) loss_oracle 0.1357 (0.1689) acc 90.6250 (87.5000) kd_loss 0.8021 (0.7975) lr 6.9098e-04 eta 0:05:39
epoch [32/50] batch [160/176] time 0.098 (0.105) data 0.000 (0.009) loss 1.1864 (1.2931) ce_loss 0.2866 (0.3612) loss_zs_kd 0.0881 (0.1019) loss_oracle 0.1203 (0.1682) acc 84.3750 (87.3633) kd_loss 0.7956 (0.7969) lr 6.9098e-04 eta 0:05:34
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,192
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 92.3%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,732
* accuracy: 65.2%
* error: 34.8%
* macro_f1: 60.0%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [33/50] batch [20/176] time 0.100 (0.187) data 0.000 (0.084) loss 1.2301 (1.2883) ce_loss 0.4375 (0.3687) loss_zs_kd 0.0650 (0.0935) loss_oracle 0.1292 (0.1634) acc 90.6250 (87.3438) kd_loss 0.6955 (0.7911) lr 6.3188e-04 eta 0:09:48
epoch [33/50] batch [40/176] time 0.098 (0.143) data 0.000 (0.042) loss 1.2853 (1.2925) ce_loss 0.3206 (0.3693) loss_zs_kd 0.1067 (0.0949) loss_oracle 0.1500 (0.1656) acc 90.6250 (87.4219) kd_loss 0.8364 (0.7930) lr 6.3188e-04 eta 0:07:26
epoch [33/50] batch [60/176] time 0.092 (0.127) data 0.000 (0.028) loss 1.1776 (1.2877) ce_loss 0.2544 (0.3617) loss_zs_kd 0.0806 (0.0960) loss_oracle 0.1553 (0.1626) acc 90.6250 (87.7083) kd_loss 0.8053 (0.7966) lr 6.3188e-04 eta 0:06:35
epoch [33/50] batch [80/176] time 0.101 (0.121) data 0.000 (0.021) loss 1.2895 (1.2962) ce_loss 0.3499 (0.3743) loss_zs_kd 0.1208 (0.0976) loss_oracle 0.1925 (0.1619) acc 90.6250 (87.3828) kd_loss 0.7831 (0.7922) lr 6.3188e-04 eta 0:06:12
epoch [33/50] batch [100/176] time 0.092 (0.116) data 0.000 (0.017) loss 1.1963 (1.2985) ce_loss 0.2141 (0.3718) loss_zs_kd 0.0953 (0.0971) loss_oracle 0.1474 (0.1631) acc 90.6250 (87.3125) kd_loss 0.8608 (0.7966) lr 6.3188e-04 eta 0:05:55
epoch [33/50] batch [120/176] time 0.095 (0.113) data 0.000 (0.014) loss 1.2046 (1.3030) ce_loss 0.2793 (0.3735) loss_zs_kd 0.0907 (0.0975) loss_oracle 0.1507 (0.1646) acc 90.6250 (87.2135) kd_loss 0.8046 (0.7984) lr 6.3188e-04 eta 0:05:43
epoch [33/50] batch [140/176] time 0.103 (0.111) data 0.001 (0.012) loss 1.1787 (1.2974) ce_loss 0.1919 (0.3667) loss_zs_kd 0.0857 (0.0975) loss_oracle 0.1558 (0.1642) acc 93.7500 (87.5223) kd_loss 0.8661 (0.7998) lr 6.3188e-04 eta 0:05:36
epoch [33/50] batch [160/176] time 0.097 (0.109) data 0.000 (0.011) loss 1.4304 (1.2989) ce_loss 0.4841 (0.3681) loss_zs_kd 0.1164 (0.0977) loss_oracle 0.1667 (0.1632) acc 78.1250 (87.1875) kd_loss 0.8047 (0.8003) lr 6.3188e-04 eta 0:05:29
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,178
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 91.9%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,665
* accuracy: 62.7%
* error: 37.3%
* macro_f1: 59.0%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [34/50] batch [20/176] time 0.079 (0.179) data 0.000 (0.073) loss 1.3314 (1.2973) ce_loss 0.2830 (0.3548) loss_zs_kd 0.1060 (0.1092) loss_oracle 0.1825 (0.1473) acc 93.7500 (86.5625) kd_loss 0.9042 (0.8143) lr 5.7422e-04 eta 0:08:51
epoch [34/50] batch [40/176] time 0.064 (0.143) data 0.000 (0.037) loss 1.4326 (1.2907) ce_loss 0.4707 (0.3628) loss_zs_kd 0.0540 (0.1027) loss_oracle 0.1427 (0.1483) acc 75.0000 (86.7969) kd_loss 0.8635 (0.8023) lr 5.7422e-04 eta 0:07:02
epoch [34/50] batch [60/176] time 0.076 (0.130) data 0.000 (0.025) loss 1.3205 (1.2766) ce_loss 0.3237 (0.3435) loss_zs_kd 0.1128 (0.1029) loss_oracle 0.1418 (0.1563) acc 90.6250 (87.8125) kd_loss 0.8695 (0.8035) lr 5.7422e-04 eta 0:06:21
epoch [34/50] batch [80/176] time 0.068 (0.123) data 0.000 (0.018) loss 1.3581 (1.2839) ce_loss 0.3928 (0.3564) loss_zs_kd 0.1476 (0.1036) loss_oracle 0.1416 (0.1559) acc 81.2500 (87.1875) kd_loss 0.8207 (0.7978) lr 5.7422e-04 eta 0:05:57
epoch [34/50] batch [100/176] time 0.080 (0.114) data 0.000 (0.015) loss 1.5168 (1.2905) ce_loss 0.4817 (0.3574) loss_zs_kd 0.1174 (0.1039) loss_oracle 0.1450 (0.1553) acc 81.2500 (87.2188) kd_loss 0.9039 (0.8035) lr 5.7422e-04 eta 0:05:30
epoch [34/50] batch [120/176] time 0.086 (0.110) data 0.000 (0.012) loss 1.3260 (1.2953) ce_loss 0.4072 (0.3614) loss_zs_kd 0.0706 (0.1026) loss_oracle 0.1785 (0.1553) acc 84.3750 (87.0052) kd_loss 0.7943 (0.8050) lr 5.7422e-04 eta 0:05:14
epoch [34/50] batch [140/176] time 0.067 (0.109) data 0.000 (0.011) loss 1.2742 (1.2916) ce_loss 0.2605 (0.3584) loss_zs_kd 0.1035 (0.1020) loss_oracle 0.1378 (0.1563) acc 96.8750 (87.0536) kd_loss 0.8931 (0.8041) lr 5.7422e-04 eta 0:05:11
epoch [34/50] batch [160/176] time 0.088 (0.108) data 0.000 (0.009) loss 1.4434 (1.2954) ce_loss 0.5005 (0.3607) loss_zs_kd 0.0647 (0.1020) loss_oracle 0.1424 (0.1580) acc 78.1250 (87.0117) kd_loss 0.8394 (0.8047) lr 5.7422e-04 eta 0:05:05
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,198
* accuracy: 90.8%
* error: 9.2%
* macro_f1: 92.5%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,746
* accuracy: 65.7%
* error: 34.3%
* macro_f1: 60.4%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [35/50] batch [20/176] time 0.089 (0.186) data 0.000 (0.086) loss 1.4298 (1.2421) ce_loss 0.5059 (0.3346) loss_zs_kd 0.1121 (0.1051) loss_oracle 0.1361 (0.1566) acc 78.1250 (88.5938) kd_loss 0.7999 (0.7767) lr 5.1825e-04 eta 0:08:40
epoch [35/50] batch [40/176] time 0.085 (0.139) data 0.000 (0.043) loss 1.3539 (1.2702) ce_loss 0.3572 (0.3460) loss_zs_kd 0.0792 (0.1053) loss_oracle 0.1323 (0.1598) acc 87.5000 (88.5938) kd_loss 0.8910 (0.7916) lr 5.1825e-04 eta 0:06:26
epoch [35/50] batch [60/176] time 0.089 (0.124) data 0.000 (0.029) loss 1.0000 (1.2648) ce_loss 0.1333 (0.3380) loss_zs_kd 0.1082 (0.1047) loss_oracle 0.1265 (0.1546) acc 100.0000 (89.0625) kd_loss 0.7494 (0.7971) lr 5.1825e-04 eta 0:05:40
epoch [35/50] batch [80/176] time 0.097 (0.116) data 0.000 (0.022) loss 1.4307 (1.2748) ce_loss 0.3962 (0.3391) loss_zs_kd 0.1376 (0.1038) loss_oracle 0.1297 (0.1549) acc 93.7500 (88.7891) kd_loss 0.9008 (0.8063) lr 5.1825e-04 eta 0:05:16
epoch [35/50] batch [100/176] time 0.091 (0.112) data 0.000 (0.017) loss 1.1681 (1.2804) ce_loss 0.2350 (0.3414) loss_zs_kd 0.0566 (0.1051) loss_oracle 0.1364 (0.1553) acc 87.5000 (88.3750) kd_loss 0.8366 (0.8088) lr 5.1825e-04 eta 0:05:04
epoch [35/50] batch [120/176] time 0.092 (0.109) data 0.000 (0.014) loss 1.3280 (1.2819) ce_loss 0.3823 (0.3449) loss_zs_kd 0.0887 (0.1032) loss_oracle 0.1792 (0.1566) acc 84.3750 (88.2292) kd_loss 0.8117 (0.8070) lr 5.1825e-04 eta 0:04:54
epoch [35/50] batch [140/176] time 0.093 (0.107) data 0.000 (0.012) loss 1.2723 (1.2918) ce_loss 0.3821 (0.3558) loss_zs_kd 0.1160 (0.1026) loss_oracle 0.1130 (0.1563) acc 87.5000 (87.9241) kd_loss 0.7757 (0.8065) lr 5.1825e-04 eta 0:04:47
epoch [35/50] batch [160/176] time 0.088 (0.105) data 0.000 (0.011) loss 1.3553 (1.3002) ce_loss 0.4497 (0.3611) loss_zs_kd 0.1299 (0.1028) loss_oracle 0.2173 (0.1602) acc 81.2500 (87.7344) kd_loss 0.7320 (0.8076) lr 5.1825e-04 eta 0:04:39
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,191
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 92.3%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,706
* accuracy: 64.2%
* error: 35.8%
* macro_f1: 59.6%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [36/50] batch [20/176] time 0.106 (0.176) data 0.000 (0.076) loss 1.3644 (1.3110) ce_loss 0.3660 (0.3588) loss_zs_kd 0.1202 (0.1170) loss_oracle 0.1770 (0.1611) acc 90.6250 (88.2812) kd_loss 0.8498 (0.8131) lr 4.6417e-04 eta 0:07:40
epoch [36/50] batch [40/176] time 0.095 (0.136) data 0.000 (0.038) loss 1.2595 (1.2878) ce_loss 0.2493 (0.3451) loss_zs_kd 0.1011 (0.1066) loss_oracle 0.1344 (0.1569) acc 87.5000 (89.4531) kd_loss 0.8925 (0.8109) lr 4.6417e-04 eta 0:05:54
epoch [36/50] batch [60/176] time 0.096 (0.124) data 0.000 (0.025) loss 1.4209 (1.2858) ce_loss 0.4595 (0.3510) loss_zs_kd 0.1169 (0.1057) loss_oracle 0.1480 (0.1544) acc 90.6250 (89.0625) kd_loss 0.8290 (0.8048) lr 4.6417e-04 eta 0:05:19
epoch [36/50] batch [80/176] time 0.096 (0.117) data 0.000 (0.019) loss 1.5987 (1.2974) ce_loss 0.6680 (0.3611) loss_zs_kd 0.0856 (0.1059) loss_oracle 0.1675 (0.1552) acc 81.2500 (88.2422) kd_loss 0.8042 (0.8057) lr 4.6417e-04 eta 0:04:58
epoch [36/50] batch [100/176] time 0.097 (0.113) data 0.000 (0.015) loss 1.1964 (1.2860) ce_loss 0.2913 (0.3544) loss_zs_kd 0.0879 (0.1040) loss_oracle 0.1604 (0.1573) acc 87.5000 (88.2812) kd_loss 0.7809 (0.8010) lr 4.6417e-04 eta 0:04:46
epoch [36/50] batch [120/176] time 0.090 (0.108) data 0.000 (0.013) loss 1.1921 (1.2906) ce_loss 0.3044 (0.3551) loss_zs_kd 0.0576 (0.1029) loss_oracle 0.1929 (0.1560) acc 87.5000 (88.2031) kd_loss 0.7625 (0.8061) lr 4.6417e-04 eta 0:04:33
epoch [36/50] batch [140/176] time 0.116 (0.106) data 0.000 (0.011) loss 1.4183 (1.2881) ce_loss 0.4453 (0.3500) loss_zs_kd 0.0956 (0.1027) loss_oracle 0.1237 (0.1541) acc 84.3750 (88.4152) kd_loss 0.8633 (0.8097) lr 4.6417e-04 eta 0:04:24
epoch [36/50] batch [160/176] time 0.163 (0.107) data 0.000 (0.010) loss 1.3049 (1.2881) ce_loss 0.3135 (0.3518) loss_zs_kd 0.0648 (0.1016) loss_oracle 0.1494 (0.1531) acc 90.6250 (88.1836) kd_loss 0.8843 (0.8090) lr 4.6417e-04 eta 0:04:25
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,193
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 92.3%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,690
* accuracy: 63.6%
* error: 36.4%
* macro_f1: 58.9%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [37/50] batch [20/176] time 0.167 (0.194) data 0.000 (0.080) loss 1.3353 (1.2433) ce_loss 0.3708 (0.3232) loss_zs_kd 0.1428 (0.1069) loss_oracle 0.1675 (0.1526) acc 84.3750 (88.4375) kd_loss 0.8093 (0.7904) lr 4.1221e-04 eta 0:07:52
epoch [37/50] batch [40/176] time 0.167 (0.154) data 0.000 (0.040) loss 1.2882 (1.2604) ce_loss 0.3960 (0.3431) loss_zs_kd 0.1224 (0.1032) loss_oracle 0.1489 (0.1552) acc 81.2500 (88.3594) kd_loss 0.7566 (0.7880) lr 4.1221e-04 eta 0:06:13
epoch [37/50] batch [60/176] time 0.092 (0.128) data 0.000 (0.027) loss 1.2212 (1.2637) ce_loss 0.2491 (0.3512) loss_zs_kd 0.0830 (0.0993) loss_oracle 0.1735 (0.1552) acc 90.6250 (88.2292) kd_loss 0.8439 (0.7852) lr 4.1221e-04 eta 0:05:07
epoch [37/50] batch [80/176] time 0.113 (0.120) data 0.000 (0.020) loss 1.2763 (1.2791) ce_loss 0.3093 (0.3563) loss_zs_kd 0.0939 (0.1012) loss_oracle 0.2224 (0.1586) acc 87.5000 (87.8125) kd_loss 0.8088 (0.7930) lr 4.1221e-04 eta 0:04:45
epoch [37/50] batch [100/176] time 0.103 (0.116) data 0.000 (0.016) loss 1.5112 (1.2892) ce_loss 0.5366 (0.3627) loss_zs_kd 0.0991 (0.0988) loss_oracle 0.2167 (0.1659) acc 78.1250 (87.3438) kd_loss 0.8167 (0.7941) lr 4.1221e-04 eta 0:04:34
epoch [37/50] batch [120/176] time 0.103 (0.114) data 0.001 (0.014) loss 1.2169 (1.2962) ce_loss 0.3062 (0.3660) loss_zs_kd 0.0744 (0.0990) loss_oracle 0.1708 (0.1698) acc 90.6250 (87.1875) kd_loss 0.7882 (0.7957) lr 4.1221e-04 eta 0:04:26
epoch [37/50] batch [140/176] time 0.100 (0.112) data 0.000 (0.012) loss 1.1366 (1.3053) ce_loss 0.3303 (0.3700) loss_zs_kd 0.1091 (0.1007) loss_oracle 0.1837 (0.1741) acc 84.3750 (86.9196) kd_loss 0.6599 (0.7978) lr 4.1221e-04 eta 0:04:19
epoch [37/50] batch [160/176] time 0.106 (0.110) data 0.000 (0.010) loss 1.2637 (1.3024) ce_loss 0.2576 (0.3664) loss_zs_kd 0.1026 (0.0999) loss_oracle 0.2154 (0.1760) acc 93.7500 (87.1484) kd_loss 0.8472 (0.7981) lr 4.1221e-04 eta 0:04:13
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,199
* accuracy: 90.8%
* error: 9.2%
* macro_f1: 92.5%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,713
* accuracy: 64.5%
* error: 35.5%
* macro_f1: 59.8%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [38/50] batch [20/176] time 0.094 (0.194) data 0.000 (0.092) loss 1.4600 (1.3456) ce_loss 0.4373 (0.3775) loss_zs_kd 0.1218 (0.1196) loss_oracle 0.1417 (0.1718) acc 81.2500 (87.3438) kd_loss 0.8910 (0.8223) lr 3.6258e-04 eta 0:07:19
epoch [38/50] batch [40/176] time 0.095 (0.147) data 0.000 (0.046) loss 1.1430 (1.3344) ce_loss 0.2764 (0.3768) loss_zs_kd 0.0735 (0.1100) loss_oracle 0.1641 (0.1760) acc 93.7500 (87.1875) kd_loss 0.7479 (0.8146) lr 3.6258e-04 eta 0:05:30
epoch [38/50] batch [60/176] time 0.097 (0.131) data 0.000 (0.031) loss 1.4595 (1.3042) ce_loss 0.4358 (0.3460) loss_zs_kd 0.1103 (0.1050) loss_oracle 0.2248 (0.1753) acc 75.0000 (88.1250) kd_loss 0.8561 (0.8180) lr 3.6258e-04 eta 0:04:52
epoch [38/50] batch [80/176] time 0.092 (0.123) data 0.000 (0.023) loss 1.2214 (1.2991) ce_loss 0.3188 (0.3473) loss_zs_kd 0.1064 (0.1039) loss_oracle 0.1734 (0.1752) acc 84.3750 (87.9688) kd_loss 0.7627 (0.8122) lr 3.6258e-04 eta 0:04:31
epoch [38/50] batch [100/176] time 0.093 (0.117) data 0.000 (0.019) loss 1.4415 (1.3038) ce_loss 0.5586 (0.3560) loss_zs_kd 0.0894 (0.1027) loss_oracle 0.1696 (0.1720) acc 78.1250 (87.4062) kd_loss 0.7534 (0.8105) lr 3.6258e-04 eta 0:04:16
epoch [38/50] batch [120/176] time 0.096 (0.114) data 0.000 (0.016) loss 1.4663 (1.2930) ce_loss 0.5146 (0.3486) loss_zs_kd 0.1080 (0.1012) loss_oracle 0.1786 (0.1696) acc 87.5000 (87.8385) kd_loss 0.8084 (0.8089) lr 3.6258e-04 eta 0:04:07
epoch [38/50] batch [140/176] time 0.106 (0.112) data 0.000 (0.013) loss 1.3703 (1.2928) ce_loss 0.4421 (0.3490) loss_zs_kd 0.1023 (0.1014) loss_oracle 0.1691 (0.1668) acc 87.5000 (87.9241) kd_loss 0.7924 (0.8096) lr 3.6258e-04 eta 0:04:00
epoch [38/50] batch [160/176] time 0.091 (0.110) data 0.000 (0.012) loss 1.5167 (1.2950) ce_loss 0.4907 (0.3526) loss_zs_kd 0.1261 (0.1012) loss_oracle 0.1338 (0.1648) acc 78.1250 (87.8320) kd_loss 0.8961 (0.8095) lr 3.6258e-04 eta 0:03:54
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,192
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 92.3%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,729
* accuracy: 65.1%
* error: 34.9%
* macro_f1: 60.0%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [39/50] batch [20/176] time 0.157 (0.206) data 0.000 (0.092) loss 1.2209 (1.2786) ce_loss 0.4138 (0.3336) loss_zs_kd 0.1089 (0.1055) loss_oracle 0.1606 (0.1505) acc 84.3750 (89.2188) kd_loss 0.6723 (0.8171) lr 3.1545e-04 eta 0:07:10
epoch [39/50] batch [40/176] time 0.139 (0.155) data 0.001 (0.046) loss 1.1906 (1.2841) ce_loss 0.1880 (0.3444) loss_zs_kd 0.0785 (0.0993) loss_oracle 0.1456 (0.1497) acc 96.8750 (88.2812) kd_loss 0.8906 (0.8152) lr 3.1545e-04 eta 0:05:20
epoch [39/50] batch [60/176] time 0.159 (0.142) data 0.001 (0.031) loss 1.2743 (1.2893) ce_loss 0.3213 (0.3419) loss_zs_kd 0.0868 (0.1021) loss_oracle 0.1529 (0.1491) acc 87.5000 (88.6979) kd_loss 0.8331 (0.8218) lr 3.1545e-04 eta 0:04:51
epoch [39/50] batch [80/176] time 0.074 (0.127) data 0.000 (0.023) loss 1.0581 (1.2992) ce_loss 0.1830 (0.3585) loss_zs_kd 0.1111 (0.1018) loss_oracle 0.1202 (0.1474) acc 93.7500 (87.5391) kd_loss 0.7595 (0.8162) lr 3.1545e-04 eta 0:04:17
epoch [39/50] batch [100/176] time 0.118 (0.119) data 0.000 (0.019) loss 0.9832 (1.2914) ce_loss 0.2251 (0.3580) loss_zs_kd 0.0720 (0.1025) loss_oracle 0.1406 (0.1460) acc 90.6250 (87.5625) kd_loss 0.6518 (0.8091) lr 3.1545e-04 eta 0:03:58
epoch [39/50] batch [120/176] time 0.166 (0.118) data 0.000 (0.016) loss 1.2638 (1.2911) ce_loss 0.3953 (0.3560) loss_zs_kd 0.1144 (0.1029) loss_oracle 0.1397 (0.1471) acc 87.5000 (87.6823) kd_loss 0.7414 (0.8100) lr 3.1545e-04 eta 0:03:54
epoch [39/50] batch [140/176] time 0.157 (0.116) data 0.000 (0.013) loss 1.3933 (1.2864) ce_loss 0.4966 (0.3583) loss_zs_kd 0.1084 (0.1024) loss_oracle 0.1147 (0.1468) acc 84.3750 (87.7009) kd_loss 0.7852 (0.8035) lr 3.1545e-04 eta 0:03:49
epoch [39/50] batch [160/176] time 0.088 (0.114) data 0.000 (0.012) loss 1.3113 (1.2896) ce_loss 0.3506 (0.3598) loss_zs_kd 0.1026 (0.1031) loss_oracle 0.1945 (0.1489) acc 87.5000 (87.4805) kd_loss 0.8122 (0.8038) lr 3.1545e-04 eta 0:03:43
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,184
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,670
* accuracy: 62.9%
* error: 37.1%
* macro_f1: 58.5%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [40/50] batch [20/176] time 0.088 (0.184) data 0.000 (0.090) loss 1.0482 (1.2639) ce_loss 0.1825 (0.3405) loss_zs_kd 0.0744 (0.1046) loss_oracle 0.1363 (0.1508) acc 96.8750 (87.8125) kd_loss 0.7603 (0.7956) lr 2.7103e-04 eta 0:05:52
epoch [40/50] batch [40/176] time 0.088 (0.135) data 0.000 (0.045) loss 1.3190 (1.2983) ce_loss 0.4492 (0.3722) loss_zs_kd 0.0810 (0.1055) loss_oracle 0.1138 (0.1484) acc 78.1250 (86.1719) kd_loss 0.7724 (0.7993) lr 2.7103e-04 eta 0:04:16
epoch [40/50] batch [60/176] time 0.092 (0.121) data 0.000 (0.030) loss 1.3673 (1.3107) ce_loss 0.4592 (0.3848) loss_zs_kd 0.1112 (0.1045) loss_oracle 0.1337 (0.1462) acc 84.3750 (86.0938) kd_loss 0.7856 (0.8006) lr 2.7103e-04 eta 0:03:47
epoch [40/50] batch [80/176] time 0.101 (0.115) data 0.000 (0.023) loss 1.0825 (1.3084) ce_loss 0.2290 (0.3804) loss_zs_kd 0.0787 (0.1045) loss_oracle 0.1437 (0.1461) acc 93.7500 (86.2500) kd_loss 0.7423 (0.8027) lr 2.7103e-04 eta 0:03:33
epoch [40/50] batch [100/176] time 0.085 (0.112) data 0.000 (0.018) loss 1.0871 (1.2954) ce_loss 0.2423 (0.3666) loss_zs_kd 0.0993 (0.1028) loss_oracle 0.1528 (0.1466) acc 87.5000 (87.2188) kd_loss 0.7187 (0.8041) lr 2.7103e-04 eta 0:03:24
epoch [40/50] batch [120/176] time 0.113 (0.110) data 0.000 (0.015) loss 1.2330 (1.2841) ce_loss 0.3130 (0.3583) loss_zs_kd 0.0632 (0.1010) loss_oracle 0.1357 (0.1471) acc 87.5000 (87.4219) kd_loss 0.8206 (0.8017) lr 2.7103e-04 eta 0:03:19
epoch [40/50] batch [140/176] time 0.086 (0.108) data 0.000 (0.013) loss 1.3343 (1.2825) ce_loss 0.3503 (0.3570) loss_zs_kd 0.0971 (0.1010) loss_oracle 0.1725 (0.1471) acc 87.5000 (87.7455) kd_loss 0.8492 (0.8015) lr 2.7103e-04 eta 0:03:13
epoch [40/50] batch [160/176] time 0.094 (0.105) data 0.000 (0.011) loss 1.3120 (1.2861) ce_loss 0.3149 (0.3594) loss_zs_kd 0.0881 (0.1003) loss_oracle 0.1302 (0.1462) acc 90.6250 (87.6367) kd_loss 0.8879 (0.8034) lr 2.7103e-04 eta 0:03:07
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,186
* accuracy: 90.3%
* error: 9.7%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,701
* accuracy: 64.0%
* error: 36.0%
* macro_f1: 59.1%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [41/50] batch [20/176] time 0.093 (0.183) data 0.000 (0.091) loss 1.4888 (1.2847) ce_loss 0.5532 (0.3595) loss_zs_kd 0.1137 (0.0862) loss_oracle 0.1366 (0.1387) acc 78.1250 (88.4375) kd_loss 0.8104 (0.8128) lr 2.2949e-04 eta 0:05:18
epoch [41/50] batch [40/176] time 0.083 (0.138) data 0.000 (0.045) loss 1.2897 (1.2794) ce_loss 0.4751 (0.3470) loss_zs_kd 0.0816 (0.0934) loss_oracle 0.1497 (0.1435) acc 75.0000 (88.0469) kd_loss 0.6990 (0.8140) lr 2.2949e-04 eta 0:03:57
epoch [41/50] batch [60/176] time 0.081 (0.123) data 0.000 (0.030) loss 1.2940 (1.2866) ce_loss 0.3582 (0.3475) loss_zs_kd 0.1002 (0.0956) loss_oracle 0.1378 (0.1461) acc 90.6250 (87.8646) kd_loss 0.8168 (0.8183) lr 2.2949e-04 eta 0:03:29
epoch [41/50] batch [80/176] time 0.071 (0.112) data 0.000 (0.023) loss 1.1863 (1.2874) ce_loss 0.3086 (0.3474) loss_zs_kd 0.0615 (0.0947) loss_oracle 0.1250 (0.1460) acc 87.5000 (88.0469) kd_loss 0.7844 (0.8196) lr 2.2949e-04 eta 0:03:08
epoch [41/50] batch [100/176] time 0.080 (0.105) data 0.000 (0.018) loss 1.2545 (1.2830) ce_loss 0.2954 (0.3433) loss_zs_kd 0.0826 (0.0956) loss_oracle 0.1242 (0.1468) acc 87.5000 (88.0312) kd_loss 0.8557 (0.8185) lr 2.2949e-04 eta 0:02:54
epoch [41/50] batch [120/176] time 0.130 (0.104) data 0.000 (0.015) loss 1.3317 (1.2898) ce_loss 0.3093 (0.3471) loss_zs_kd 0.1206 (0.0976) loss_oracle 0.1644 (0.1466) acc 87.5000 (87.6302) kd_loss 0.8799 (0.8206) lr 2.2949e-04 eta 0:02:51
epoch [41/50] batch [140/176] time 0.084 (0.104) data 0.000 (0.013) loss 1.3114 (1.2905) ce_loss 0.2717 (0.3488) loss_zs_kd 0.1441 (0.0985) loss_oracle 0.1496 (0.1484) acc 93.7500 (87.5446) kd_loss 0.8928 (0.8183) lr 2.2949e-04 eta 0:02:47
epoch [41/50] batch [160/176] time 0.110 (0.105) data 0.000 (0.012) loss 1.4200 (1.2944) ce_loss 0.4326 (0.3549) loss_zs_kd 0.0871 (0.0982) loss_oracle 0.1537 (0.1502) acc 84.3750 (87.3242) kd_loss 0.8670 (0.8152) lr 2.2949e-04 eta 0:02:47
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,182
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,691
* accuracy: 63.7%
* error: 36.3%
* macro_f1: 59.1%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [42/50] batch [20/176] time 0.089 (0.182) data 0.000 (0.096) loss 1.4321 (1.2895) ce_loss 0.3948 (0.3413) loss_zs_kd 0.1154 (0.1079) loss_oracle 0.1640 (0.1436) acc 87.5000 (89.2188) kd_loss 0.8976 (0.8224) lr 1.9098e-04 eta 0:04:44
epoch [42/50] batch [40/176] time 0.096 (0.134) data 0.000 (0.048) loss 1.1333 (1.2668) ce_loss 0.2225 (0.3289) loss_zs_kd 0.0793 (0.1042) loss_oracle 0.1690 (0.1458) acc 90.6250 (89.2969) kd_loss 0.7866 (0.8129) lr 1.9098e-04 eta 0:03:26
epoch [42/50] batch [60/176] time 0.104 (0.122) data 0.000 (0.032) loss 1.3783 (1.2761) ce_loss 0.4360 (0.3444) loss_zs_kd 0.0736 (0.1019) loss_oracle 0.1282 (0.1456) acc 84.3750 (88.1771) kd_loss 0.8414 (0.8080) lr 1.9098e-04 eta 0:03:06
epoch [42/50] batch [80/176] time 0.095 (0.115) data 0.000 (0.024) loss 1.1739 (1.2742) ce_loss 0.1725 (0.3400) loss_zs_kd 0.1109 (0.1013) loss_oracle 0.1479 (0.1478) acc 96.8750 (88.4375) kd_loss 0.8720 (0.8096) lr 1.9098e-04 eta 0:02:53
epoch [42/50] batch [100/176] time 0.108 (0.112) data 0.001 (0.019) loss 1.4397 (1.2796) ce_loss 0.5308 (0.3475) loss_zs_kd 0.0952 (0.0999) loss_oracle 0.1438 (0.1455) acc 75.0000 (88.2812) kd_loss 0.7894 (0.8094) lr 1.9098e-04 eta 0:02:46
epoch [42/50] batch [120/176] time 0.103 (0.110) data 0.000 (0.016) loss 1.3408 (1.2828) ce_loss 0.4717 (0.3473) loss_zs_kd 0.1050 (0.1011) loss_oracle 0.1472 (0.1452) acc 87.5000 (88.3333) kd_loss 0.7430 (0.8123) lr 1.9098e-04 eta 0:02:40
epoch [42/50] batch [140/176] time 0.104 (0.108) data 0.000 (0.014) loss 1.3893 (1.2915) ce_loss 0.4111 (0.3557) loss_zs_kd 0.1439 (0.1001) loss_oracle 0.1723 (0.1465) acc 87.5000 (88.0357) kd_loss 0.8201 (0.8126) lr 1.9098e-04 eta 0:02:35
epoch [42/50] batch [160/176] time 0.100 (0.106) data 0.000 (0.012) loss 1.2684 (1.2894) ce_loss 0.2942 (0.3534) loss_zs_kd 0.1469 (0.0998) loss_oracle 0.1304 (0.1477) acc 87.5000 (88.1836) kd_loss 0.8356 (0.8122) lr 1.9098e-04 eta 0:02:31
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,188
* accuracy: 90.3%
* error: 9.7%
* macro_f1: 92.2%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,689
* accuracy: 63.6%
* error: 36.4%
* macro_f1: 59.0%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [43/50] batch [20/176] time 0.089 (0.190) data 0.000 (0.092) loss 1.1636 (1.2829) ce_loss 0.3000 (0.3510) loss_zs_kd 0.0826 (0.1095) loss_oracle 0.1476 (0.1489) acc 90.6250 (86.4062) kd_loss 0.7485 (0.8027) lr 1.5567e-04 eta 0:04:23
epoch [43/50] batch [40/176] time 0.100 (0.144) data 0.000 (0.046) loss 1.0351 (1.2624) ce_loss 0.2732 (0.3364) loss_zs_kd 0.0965 (0.1032) loss_oracle 0.1401 (0.1493) acc 90.6250 (87.5781) kd_loss 0.6436 (0.7998) lr 1.5567e-04 eta 0:03:16
epoch [43/50] batch [60/176] time 0.089 (0.125) data 0.000 (0.031) loss 1.3776 (1.2746) ce_loss 0.4167 (0.3445) loss_zs_kd 0.0804 (0.1007) loss_oracle 0.1136 (0.1489) acc 84.3750 (87.8125) kd_loss 0.8639 (0.8054) lr 1.5567e-04 eta 0:02:49
epoch [43/50] batch [80/176] time 0.079 (0.115) data 0.000 (0.023) loss 0.9984 (1.2641) ce_loss 0.2118 (0.3376) loss_zs_kd 0.0936 (0.1004) loss_oracle 0.1719 (0.1500) acc 93.7500 (88.0469) kd_loss 0.6539 (0.8013) lr 1.5567e-04 eta 0:02:32
epoch [43/50] batch [100/176] time 0.099 (0.110) data 0.000 (0.019) loss 1.0979 (1.2678) ce_loss 0.2576 (0.3392) loss_zs_kd 0.1445 (0.1021) loss_oracle 0.1303 (0.1494) acc 93.7500 (88.0000) kd_loss 0.7029 (0.8028) lr 1.5567e-04 eta 0:02:23
epoch [43/50] batch [120/176] time 0.094 (0.107) data 0.000 (0.016) loss 1.2601 (1.2744) ce_loss 0.2979 (0.3469) loss_zs_kd 0.1137 (0.1011) loss_oracle 0.1440 (0.1485) acc 93.7500 (87.7865) kd_loss 0.8334 (0.8027) lr 1.5567e-04 eta 0:02:18
epoch [43/50] batch [140/176] time 0.089 (0.107) data 0.000 (0.013) loss 1.5672 (1.2808) ce_loss 0.5679 (0.3500) loss_zs_kd 0.1238 (0.1005) loss_oracle 0.1335 (0.1474) acc 78.1250 (87.6562) kd_loss 0.8707 (0.8069) lr 1.5567e-04 eta 0:02:15
epoch [43/50] batch [160/176] time 0.096 (0.105) data 0.000 (0.012) loss 1.3711 (1.2905) ce_loss 0.3674 (0.3575) loss_zs_kd 0.1537 (0.1017) loss_oracle 0.1267 (0.1466) acc 90.6250 (87.4805) kd_loss 0.8635 (0.8089) lr 1.5567e-04 eta 0:02:11
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,181
* accuracy: 90.0%
* error: 10.0%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,681
* accuracy: 63.3%
* error: 36.7%
* macro_f1: 58.8%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [44/50] batch [20/176] time 0.076 (0.185) data 0.000 (0.095) loss 1.2649 (1.2553) ce_loss 0.3193 (0.3275) loss_zs_kd 0.0924 (0.1061) loss_oracle 0.1643 (0.1455) acc 87.5000 (88.7500) kd_loss 0.8172 (0.8020) lr 1.2369e-04 eta 0:03:44
epoch [44/50] batch [40/176] time 0.087 (0.141) data 0.000 (0.047) loss 1.2462 (1.2873) ce_loss 0.4026 (0.3472) loss_zs_kd 0.1214 (0.1039) loss_oracle 0.1268 (0.1463) acc 87.5000 (87.2656) kd_loss 0.7195 (0.8150) lr 1.2369e-04 eta 0:02:47
epoch [44/50] batch [60/176] time 0.087 (0.122) data 0.000 (0.032) loss 1.1031 (1.2765) ce_loss 0.2661 (0.3428) loss_zs_kd 0.0544 (0.1011) loss_oracle 0.1722 (0.1482) acc 87.5000 (87.6562) kd_loss 0.7236 (0.8091) lr 1.2369e-04 eta 0:02:22
epoch [44/50] batch [80/176] time 0.164 (0.115) data 0.000 (0.024) loss 1.3651 (1.2765) ce_loss 0.4246 (0.3479) loss_zs_kd 0.0994 (0.1019) loss_oracle 0.1416 (0.1475) acc 84.3750 (88.0859) kd_loss 0.8200 (0.8038) lr 1.2369e-04 eta 0:02:12
epoch [44/50] batch [100/176] time 0.162 (0.116) data 0.000 (0.019) loss 1.2254 (1.2821) ce_loss 0.2401 (0.3519) loss_zs_kd 0.1117 (0.1017) loss_oracle 0.1616 (0.1484) acc 93.7500 (87.9688) kd_loss 0.8487 (0.8052) lr 1.2369e-04 eta 0:02:11
epoch [44/50] batch [120/176] time 0.162 (0.115) data 0.000 (0.016) loss 1.2541 (1.2835) ce_loss 0.3367 (0.3553) loss_zs_kd 0.1144 (0.1011) loss_oracle 0.1486 (0.1484) acc 90.6250 (87.9167) kd_loss 0.7859 (0.8034) lr 1.2369e-04 eta 0:02:07
epoch [44/50] batch [140/176] time 0.082 (0.111) data 0.000 (0.014) loss 1.0677 (1.2882) ce_loss 0.2314 (0.3585) loss_zs_kd 0.0656 (0.0999) loss_oracle 0.1588 (0.1497) acc 93.7500 (87.7232) kd_loss 0.7241 (0.8048) lr 1.2369e-04 eta 0:02:01
epoch [44/50] batch [160/176] time 0.093 (0.109) data 0.000 (0.012) loss 1.2316 (1.2908) ce_loss 0.2211 (0.3579) loss_zs_kd 0.2235 (0.1003) loss_oracle 0.1722 (0.1505) acc 93.7500 (87.7734) kd_loss 0.8126 (0.8075) lr 1.2369e-04 eta 0:01:56
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,192
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 92.3%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,709
* accuracy: 64.3%
* error: 35.7%
* macro_f1: 59.6%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [45/50] batch [20/176] time 0.087 (0.199) data 0.000 (0.104) loss 1.4647 (1.3174) ce_loss 0.4788 (0.3853) loss_zs_kd 0.1147 (0.0959) loss_oracle 0.1903 (0.1551) acc 75.0000 (84.8438) kd_loss 0.8334 (0.8066) lr 9.5173e-05 eta 0:03:26
epoch [45/50] batch [40/176] time 0.092 (0.147) data 0.000 (0.052) loss 1.1890 (1.3012) ce_loss 0.2859 (0.3618) loss_zs_kd 0.1041 (0.0944) loss_oracle 0.1557 (0.1574) acc 90.6250 (86.9531) kd_loss 0.7732 (0.8135) lr 9.5173e-05 eta 0:02:29
epoch [45/50] batch [60/176] time 0.100 (0.131) data 0.000 (0.035) loss 1.2764 (1.2936) ce_loss 0.3359 (0.3594) loss_zs_kd 0.1206 (0.0953) loss_oracle 0.1791 (0.1571) acc 87.5000 (87.6042) kd_loss 0.7907 (0.8081) lr 9.5173e-05 eta 0:02:10
epoch [45/50] batch [80/176] time 0.099 (0.122) data 0.000 (0.026) loss 1.4641 (1.3121) ce_loss 0.4702 (0.3727) loss_zs_kd 0.1018 (0.1008) loss_oracle 0.1504 (0.1566) acc 90.6250 (86.9141) kd_loss 0.8678 (0.8106) lr 9.5173e-05 eta 0:01:59
epoch [45/50] batch [100/176] time 0.098 (0.117) data 0.000 (0.021) loss 1.2130 (1.3037) ce_loss 0.3857 (0.3650) loss_zs_kd 0.0768 (0.0994) loss_oracle 0.1393 (0.1560) acc 84.3750 (87.1250) kd_loss 0.7192 (0.8110) lr 9.5173e-05 eta 0:01:51
epoch [45/50] batch [120/176] time 0.110 (0.114) data 0.000 (0.017) loss 1.0262 (1.3037) ce_loss 0.2639 (0.3630) loss_zs_kd 0.0778 (0.1003) loss_oracle 0.1805 (0.1571) acc 90.6250 (87.3177) kd_loss 0.6331 (0.8120) lr 9.5173e-05 eta 0:01:46
epoch [45/50] batch [140/176] time 0.087 (0.111) data 0.000 (0.015) loss 1.3300 (1.2979) ce_loss 0.4270 (0.3597) loss_zs_kd 0.0742 (0.0999) loss_oracle 0.1474 (0.1563) acc 84.3750 (87.3884) kd_loss 0.7922 (0.8100) lr 9.5173e-05 eta 0:01:42
epoch [45/50] batch [160/176] time 0.086 (0.110) data 0.000 (0.013) loss 1.8104 (1.2996) ce_loss 0.8018 (0.3634) loss_zs_kd 0.0993 (0.0994) loss_oracle 0.1479 (0.1555) acc 68.7500 (87.3242) kd_loss 0.8851 (0.8087) lr 9.5173e-05 eta 0:01:38
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,191
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 92.3%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,702
* accuracy: 64.1%
* error: 35.9%
* macro_f1: 59.5%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [46/50] batch [20/176] time 0.080 (0.194) data 0.000 (0.106) loss 1.5835 (1.2743) ce_loss 0.5088 (0.3492) loss_zs_kd 0.1418 (0.1090) loss_oracle 0.1636 (0.1606) acc 84.3750 (87.1875) kd_loss 0.9220 (0.7902) lr 7.0224e-05 eta 0:02:46
epoch [46/50] batch [40/176] time 0.071 (0.137) data 0.000 (0.053) loss 1.2835 (1.2718) ce_loss 0.3909 (0.3489) loss_zs_kd 0.0858 (0.1008) loss_oracle 0.1783 (0.1563) acc 84.3750 (87.8125) kd_loss 0.7606 (0.7943) lr 7.0224e-05 eta 0:01:55
epoch [46/50] batch [60/176] time 0.080 (0.118) data 0.000 (0.036) loss 1.0542 (1.2634) ce_loss 0.2321 (0.3456) loss_zs_kd 0.0688 (0.0967) loss_oracle 0.1483 (0.1553) acc 90.6250 (88.0729) kd_loss 0.7135 (0.7918) lr 7.0224e-05 eta 0:01:36
epoch [46/50] batch [80/176] time 0.164 (0.114) data 0.000 (0.027) loss 1.2826 (1.2608) ce_loss 0.2942 (0.3380) loss_zs_kd 0.1279 (0.0974) loss_oracle 0.1180 (0.1560) acc 96.8750 (88.4375) kd_loss 0.8655 (0.7961) lr 7.0224e-05 eta 0:01:31
epoch [46/50] batch [100/176] time 0.107 (0.112) data 0.001 (0.021) loss 1.1747 (1.2556) ce_loss 0.2578 (0.3322) loss_zs_kd 0.0740 (0.0966) loss_oracle 0.1644 (0.1550) acc 87.5000 (88.6875) kd_loss 0.7977 (0.7976) lr 7.0224e-05 eta 0:01:27
epoch [46/50] batch [120/176] time 0.070 (0.112) data 0.000 (0.018) loss 1.2496 (1.2609) ce_loss 0.3086 (0.3386) loss_zs_kd 0.0989 (0.0951) loss_oracle 0.1512 (0.1539) acc 90.6250 (88.4115) kd_loss 0.8160 (0.7979) lr 7.0224e-05 eta 0:01:25
epoch [46/50] batch [140/176] time 0.087 (0.112) data 0.000 (0.015) loss 1.2071 (1.2633) ce_loss 0.2839 (0.3384) loss_zs_kd 0.0993 (0.0969) loss_oracle 0.1448 (0.1543) acc 90.6250 (88.5268) kd_loss 0.8011 (0.7993) lr 7.0224e-05 eta 0:01:23
epoch [46/50] batch [160/176] time 0.092 (0.109) data 0.000 (0.014) loss 1.3983 (1.2668) ce_loss 0.3782 (0.3390) loss_zs_kd 0.1049 (0.0977) loss_oracle 0.1150 (0.1537) acc 84.3750 (88.3203) kd_loss 0.9102 (0.8022) lr 7.0224e-05 eta 0:01:18
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,192
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 92.3%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,697
* accuracy: 63.9%
* error: 36.1%
* macro_f1: 59.3%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [47/50] batch [20/176] time 0.095 (0.192) data 0.000 (0.101) loss 1.1523 (1.3176) ce_loss 0.3259 (0.3967) loss_zs_kd 0.1017 (0.0974) loss_oracle 0.1850 (0.1494) acc 90.6250 (87.0312) kd_loss 0.6831 (0.7975) lr 4.8943e-05 eta 0:02:11
epoch [47/50] batch [40/176] time 0.097 (0.144) data 0.000 (0.051) loss 1.3330 (1.3270) ce_loss 0.3984 (0.3906) loss_zs_kd 0.1121 (0.0980) loss_oracle 0.1846 (0.1515) acc 87.5000 (86.7969) kd_loss 0.7862 (0.8116) lr 4.8943e-05 eta 0:01:35
epoch [47/50] batch [60/176] time 0.092 (0.128) data 0.000 (0.034) loss 1.3066 (1.3058) ce_loss 0.3179 (0.3745) loss_zs_kd 0.1072 (0.0974) loss_oracle 0.1746 (0.1526) acc 87.5000 (87.2917) kd_loss 0.8479 (0.8064) lr 4.8943e-05 eta 0:01:22
epoch [47/50] batch [80/176] time 0.092 (0.120) data 0.000 (0.025) loss 1.4165 (1.3077) ce_loss 0.5981 (0.3779) loss_zs_kd 0.0999 (0.0961) loss_oracle 0.1524 (0.1547) acc 78.1250 (86.8359) kd_loss 0.6922 (0.8044) lr 4.8943e-05 eta 0:01:14
epoch [47/50] batch [100/176] time 0.102 (0.115) data 0.000 (0.020) loss 1.3143 (1.3001) ce_loss 0.3203 (0.3645) loss_zs_kd 0.1004 (0.0972) loss_oracle 0.1364 (0.1548) acc 93.7500 (87.3125) kd_loss 0.8756 (0.8096) lr 4.8943e-05 eta 0:01:09
epoch [47/50] batch [120/176] time 0.104 (0.112) data 0.000 (0.017) loss 1.3432 (1.2963) ce_loss 0.3030 (0.3593) loss_zs_kd 0.1241 (0.0987) loss_oracle 0.1561 (0.1540) acc 87.5000 (87.5781) kd_loss 0.9001 (0.8107) lr 4.8943e-05 eta 0:01:05
epoch [47/50] batch [140/176] time 0.095 (0.110) data 0.000 (0.015) loss 1.1816 (1.2894) ce_loss 0.1940 (0.3553) loss_zs_kd 0.0986 (0.1003) loss_oracle 0.1436 (0.1532) acc 93.7500 (87.7232) kd_loss 0.8665 (0.8073) lr 4.8943e-05 eta 0:01:02
epoch [47/50] batch [160/176] time 0.103 (0.109) data 0.000 (0.013) loss 1.1043 (1.2861) ce_loss 0.2386 (0.3527) loss_zs_kd 0.0933 (0.0998) loss_oracle 0.1832 (0.1528) acc 93.7500 (87.6758) kd_loss 0.7274 (0.8072) lr 4.8943e-05 eta 0:00:59
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,192
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 92.3%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,697
* accuracy: 63.9%
* error: 36.1%
* macro_f1: 59.3%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [48/50] batch [20/176] time 0.095 (0.195) data 0.000 (0.097) loss 1.2906 (1.3035) ce_loss 0.3364 (0.3877) loss_zs_kd 0.1280 (0.1010) loss_oracle 0.1546 (0.1537) acc 87.5000 (85.1562) kd_loss 0.8129 (0.7885) lr 3.1417e-05 eta 0:01:39
epoch [48/50] batch [40/176] time 0.100 (0.145) data 0.000 (0.049) loss 1.3357 (1.3163) ce_loss 0.3770 (0.3842) loss_zs_kd 0.1150 (0.1013) loss_oracle 0.1485 (0.1562) acc 90.6250 (85.9375) kd_loss 0.8271 (0.8033) lr 3.1417e-05 eta 0:01:10
epoch [48/50] batch [60/176] time 0.089 (0.129) data 0.000 (0.033) loss 1.4798 (1.3124) ce_loss 0.5171 (0.3734) loss_zs_kd 0.1443 (0.1060) loss_oracle 0.1677 (0.1559) acc 81.2500 (86.4062) kd_loss 0.8067 (0.8081) lr 3.1417e-05 eta 0:01:00
epoch [48/50] batch [80/176] time 0.100 (0.122) data 0.000 (0.025) loss 1.2244 (1.3227) ce_loss 0.3210 (0.3810) loss_zs_kd 0.0832 (0.1048) loss_oracle 0.1577 (0.1530) acc 90.6250 (86.6406) kd_loss 0.7829 (0.8128) lr 3.1417e-05 eta 0:00:54
epoch [48/50] batch [100/176] time 0.085 (0.117) data 0.000 (0.020) loss 1.3699 (1.3160) ce_loss 0.3247 (0.3769) loss_zs_kd 0.1706 (0.1045) loss_oracle 0.1472 (0.1536) acc 93.7500 (86.8750) kd_loss 0.8863 (0.8101) lr 3.1417e-05 eta 0:00:49
epoch [48/50] batch [120/176] time 0.095 (0.114) data 0.001 (0.016) loss 1.2392 (1.3119) ce_loss 0.2861 (0.3763) loss_zs_kd 0.0950 (0.1034) loss_oracle 0.1905 (0.1529) acc 87.5000 (87.0312) kd_loss 0.8103 (0.8074) lr 3.1417e-05 eta 0:00:46
epoch [48/50] batch [140/176] time 0.102 (0.112) data 0.000 (0.014) loss 1.3251 (1.3094) ce_loss 0.4080 (0.3749) loss_zs_kd 0.0674 (0.1023) loss_oracle 0.1884 (0.1531) acc 87.5000 (86.9420) kd_loss 0.7892 (0.8068) lr 3.1417e-05 eta 0:00:43
epoch [48/50] batch [160/176] time 0.078 (0.109) data 0.000 (0.012) loss 1.2982 (1.3060) ce_loss 0.3303 (0.3738) loss_zs_kd 0.0996 (0.1012) loss_oracle 0.1516 (0.1521) acc 87.5000 (86.9531) kd_loss 0.8423 (0.8056) lr 3.1417e-05 eta 0:00:40
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,193
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 92.4%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,696
* accuracy: 63.9%
* error: 36.1%
* macro_f1: 59.3%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [49/50] batch [20/176] time 0.149 (0.194) data 0.000 (0.102) loss 1.2621 (1.2146) ce_loss 0.3237 (0.2884) loss_zs_kd 0.0806 (0.0879) loss_oracle 0.1314 (0.1641) acc 87.5000 (90.7812) kd_loss 0.8324 (0.8002) lr 1.7713e-05 eta 0:01:04
epoch [49/50] batch [40/176] time 0.171 (0.149) data 0.000 (0.051) loss 1.2453 (1.2569) ce_loss 0.3035 (0.3155) loss_zs_kd 0.1230 (0.1000) loss_oracle 0.1915 (0.1569) acc 90.6250 (89.2969) kd_loss 0.7846 (0.8129) lr 1.7713e-05 eta 0:00:46
epoch [49/50] batch [60/176] time 0.172 (0.137) data 0.000 (0.034) loss 1.3199 (1.2811) ce_loss 0.4756 (0.3345) loss_zs_kd 0.0869 (0.1005) loss_oracle 0.1383 (0.1568) acc 75.0000 (88.3333) kd_loss 0.7318 (0.8179) lr 1.7713e-05 eta 0:00:40
epoch [49/50] batch [80/176] time 0.089 (0.126) data 0.000 (0.026) loss 1.0624 (1.2729) ce_loss 0.2185 (0.3341) loss_zs_kd 0.0643 (0.0996) loss_oracle 0.1533 (0.1561) acc 93.7500 (88.5156) kd_loss 0.7351 (0.8110) lr 1.7713e-05 eta 0:00:34
epoch [49/50] batch [100/176] time 0.107 (0.119) data 0.000 (0.021) loss 1.1079 (1.2752) ce_loss 0.1495 (0.3334) loss_zs_kd 0.1149 (0.1005) loss_oracle 0.1354 (0.1540) acc 100.0000 (88.5312) kd_loss 0.8332 (0.8145) lr 1.7713e-05 eta 0:00:30
epoch [49/50] batch [120/176] time 0.094 (0.115) data 0.000 (0.017) loss 1.1967 (1.2794) ce_loss 0.2908 (0.3385) loss_zs_kd 0.0921 (0.0998) loss_oracle 0.1644 (0.1530) acc 90.6250 (88.3073) kd_loss 0.7776 (0.8145) lr 1.7713e-05 eta 0:00:26
epoch [49/50] batch [140/176] time 0.099 (0.113) data 0.000 (0.015) loss 1.3072 (1.2794) ce_loss 0.4685 (0.3447) loss_zs_kd 0.1109 (0.1010) loss_oracle 0.1296 (0.1536) acc 81.2500 (88.0580) kd_loss 0.7185 (0.8074) lr 1.7713e-05 eta 0:00:24
epoch [49/50] batch [160/176] time 0.089 (0.112) data 0.000 (0.013) loss 1.2786 (1.2805) ce_loss 0.3999 (0.3447) loss_zs_kd 0.1013 (0.1022) loss_oracle 0.1501 (0.1539) acc 93.7500 (87.9492) kd_loss 0.7530 (0.8078) lr 1.7713e-05 eta 0:00:21
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,192
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 92.4%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,699
* accuracy: 64.0%
* error: 36.0%
* macro_f1: 59.4%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
epoch [50/50] batch [20/176] time 0.110 (0.195) data 0.001 (0.100) loss 1.2183 (1.2456) ce_loss 0.2230 (0.3154) loss_zs_kd 0.0868 (0.1013) loss_oracle 0.1824 (0.1536) acc 93.7500 (88.5938) kd_loss 0.8607 (0.8027) lr 7.8853e-06 eta 0:00:30
epoch [50/50] batch [40/176] time 0.079 (0.145) data 0.000 (0.050) loss 1.3741 (1.2525) ce_loss 0.4429 (0.3301) loss_zs_kd 0.0878 (0.1022) loss_oracle 0.1403 (0.1512) acc 84.3750 (87.8906) kd_loss 0.8171 (0.7957) lr 7.8853e-06 eta 0:00:19
epoch [50/50] batch [60/176] time 0.110 (0.129) data 0.000 (0.034) loss 1.2573 (1.2558) ce_loss 0.3486 (0.3289) loss_zs_kd 0.0912 (0.1008) loss_oracle 0.1700 (0.1509) acc 87.5000 (87.9167) kd_loss 0.7780 (0.8011) lr 7.8853e-06 eta 0:00:14
epoch [50/50] batch [80/176] time 0.102 (0.122) data 0.000 (0.025) loss 1.3068 (1.2740) ce_loss 0.4543 (0.3414) loss_zs_kd 0.0807 (0.1004) loss_oracle 0.1151 (0.1517) acc 84.3750 (87.8125) kd_loss 0.7546 (0.8066) lr 7.8853e-06 eta 0:00:11
epoch [50/50] batch [100/176] time 0.095 (0.117) data 0.000 (0.020) loss 1.2060 (1.2724) ce_loss 0.2964 (0.3406) loss_zs_kd 0.0783 (0.1002) loss_oracle 0.1020 (0.1517) acc 87.5000 (87.9375) kd_loss 0.8194 (0.8058) lr 7.8853e-06 eta 0:00:08
epoch [50/50] batch [120/176] time 0.109 (0.114) data 0.000 (0.017) loss 1.3800 (1.2841) ce_loss 0.4229 (0.3483) loss_zs_kd 0.1026 (0.1028) loss_oracle 0.1993 (0.1539) acc 90.6250 (87.7604) kd_loss 0.8062 (0.8074) lr 7.8853e-06 eta 0:00:06
epoch [50/50] batch [140/176] time 0.087 (0.111) data 0.000 (0.015) loss 1.3009 (1.2912) ce_loss 0.3062 (0.3567) loss_zs_kd 0.0893 (0.1022) loss_oracle 0.1511 (0.1548) acc 90.6250 (87.5893) kd_loss 0.8745 (0.8060) lr 7.8853e-06 eta 0:00:03
epoch [50/50] batch [160/176] time 0.100 (0.108) data 0.000 (0.013) loss 1.1122 (1.2882) ce_loss 0.2820 (0.3546) loss_zs_kd 0.0982 (0.1015) loss_oracle 0.1706 (0.1542) acc 90.6250 (87.7539) kd_loss 0.6958 (0.8058) lr 7.8853e-06 eta 0:00:01
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,192
* accuracy: 90.5%
* error: 9.5%
* macro_f1: 92.4%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,698
* accuracy: 63.9%
* error: 36.1%
* macro_f1: 59.4%
******* Domain l best val acc:      90.9%, epoch: 29 *******
******* Domain l best val test acc: 65.8%, epoch: 29 *******
******* Domain l best test acc:     68.9%, epoch: 1 *******
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:21:55
