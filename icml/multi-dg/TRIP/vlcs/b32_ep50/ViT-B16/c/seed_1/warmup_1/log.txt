Loading trainer: TRIP
Loading dataset: SPG_VLCS
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------
Dataset    SPG_VLCS
Source     ['labelme', 'pascal', 'sun']
Target     ['caltech']
# classes  5
# train_x  6,519
# val      2,795
# test     1,415
---------  ----------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/203] time 0.077 (0.109) data 0.000 (0.020) loss 0.6230 (0.7945) ce_loss 0.6221 (0.7935) loss_zs_kd 0.0002 (0.0001) loss_oracle -0.0002 (-0.0002) acc 68.7500 (71.0938) kd_loss 0.0009 (0.0010) lr 1.0000e-05 eta 0:18:26
epoch [1/50] batch [40/203] time 0.113 (0.100) data 0.000 (0.010) loss 0.7861 (0.7602) ce_loss 0.7852 (0.7593) loss_zs_kd 0.0010 (0.0004) loss_oracle -0.0002 (-0.0002) acc 75.0000 (72.4219) kd_loss 0.0006 (0.0008) lr 1.0000e-05 eta 0:16:48
epoch [1/50] batch [60/203] time 0.071 (0.099) data 0.000 (0.007) loss 0.7834 (0.7583) ce_loss 0.7812 (0.7572) loss_zs_kd 0.0031 (0.0009) loss_oracle -0.0001 (-0.0001) acc 75.0000 (73.3333) kd_loss 0.0006 (0.0007) lr 1.0000e-05 eta 0:16:42
epoch [1/50] batch [80/203] time 0.071 (0.099) data 0.000 (0.005) loss 0.6883 (0.7292) ce_loss 0.6841 (0.7277) loss_zs_kd 0.0044 (0.0016) loss_oracle -0.0001 (-0.0001) acc 71.8750 (74.2188) kd_loss 0.0021 (0.0007) lr 1.0000e-05 eta 0:16:39
epoch [1/50] batch [100/203] time 0.166 (0.101) data 0.000 (0.004) loss 0.8862 (0.7355) ce_loss 0.8809 (0.7334) loss_zs_kd 0.0065 (0.0024) loss_oracle -0.0001 (-0.0001) acc 71.8750 (74.0000) kd_loss 0.0022 (0.0010) lr 1.0000e-05 eta 0:16:58
epoch [1/50] batch [120/203] time 0.161 (0.103) data 0.000 (0.004) loss 0.8677 (0.7351) ce_loss 0.8618 (0.7325) loss_zs_kd 0.0079 (0.0032) loss_oracle -0.0001 (-0.0001) acc 65.6250 (73.4635) kd_loss 0.0020 (0.0012) lr 1.0000e-05 eta 0:17:15
epoch [1/50] batch [140/203] time 0.077 (0.104) data 0.000 (0.003) loss 0.5985 (0.7297) ce_loss 0.5913 (0.7266) loss_zs_kd 0.0082 (0.0039) loss_oracle -0.0001 (-0.0001) acc 78.1250 (73.7723) kd_loss 0.0032 (0.0013) lr 1.0000e-05 eta 0:17:19
epoch [1/50] batch [160/203] time 0.070 (0.105) data 0.000 (0.003) loss 0.6220 (0.7292) ce_loss 0.6157 (0.7255) loss_zs_kd 0.0063 (0.0045) loss_oracle -0.0001 (-0.0001) acc 78.1250 (73.9062) kd_loss 0.0032 (0.0016) lr 1.0000e-05 eta 0:17:26
epoch [1/50] batch [180/203] time 0.064 (0.104) data 0.000 (0.002) loss 0.8714 (0.7375) ce_loss 0.8652 (0.7334) loss_zs_kd 0.0084 (0.0049) loss_oracle -0.0002 (-0.0001) acc 65.6250 (73.7500) kd_loss 0.0021 (0.0017) lr 1.0000e-05 eta 0:17:21
epoch [1/50] batch [200/203] time 0.066 (0.101) data 0.000 (0.002) loss 0.6587 (0.7301) ce_loss 0.6494 (0.7256) loss_zs_kd 0.0120 (0.0053) loss_oracle -0.0002 (-0.0001) acc 75.0000 (73.9531) kd_loss 0.0033 (0.0019) lr 1.0000e-05 eta 0:16:44
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,213
* accuracy: 79.2%
* error: 20.8%
* macro_f1: 82.8%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain c best val acc:      79.2%, epoch: 1 *******
******* Domain c best val test acc: 100.0%, epoch: 1 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/ana
epoch [2/50] batch [20/203] time 0.095 (0.119) data 0.000 (0.017) loss 0.8818 (0.7077) ce_loss 0.8374 (0.6734) loss_zs_kd 0.0377 (0.0527) loss_oracle 0.0349 (0.0040) acc 71.8750 (76.5625) kd_loss 0.0081 (0.0061) lr 2.0000e-03 eta 0:19:38
epoch [2/50] batch [40/203] time 0.090 (0.112) data 0.000 (0.009) loss 0.8172 (0.7897) ce_loss 0.4026 (0.6262) loss_zs_kd 0.0613 (0.0696) loss_oracle 0.1308 (0.0657) acc 84.3750 (77.6562) kd_loss 0.3185 (0.0958) lr 2.0000e-03 eta 0:18:30
epoch [2/50] batch [60/203] time 0.109 (0.111) data 0.000 (0.006) loss 1.1805 (0.9249) ce_loss 0.4766 (0.6234) loss_zs_kd 0.0856 (0.0702) loss_oracle 0.1679 (0.1022) acc 71.8750 (77.1875) kd_loss 0.5772 (0.2153) lr 2.0000e-03 eta 0:18:13
epoch [2/50] batch [80/203] time 0.104 (0.109) data 0.000 (0.005) loss 1.2470 (0.9822) ce_loss 0.6743 (0.6080) loss_zs_kd 0.0727 (0.0719) loss_oracle 0.2487 (0.1226) acc 71.8750 (77.3438) kd_loss 0.4120 (0.2769) lr 2.0000e-03 eta 0:17:54
epoch [2/50] batch [100/203] time 0.103 (0.107) data 0.000 (0.004) loss 1.0686 (1.0350) ce_loss 0.4573 (0.6087) loss_zs_kd 0.0633 (0.0737) loss_oracle 0.3012 (0.1558) acc 87.5000 (77.3125) kd_loss 0.4291 (0.3115) lr 2.0000e-03 eta 0:17:30
epoch [2/50] batch [120/203] time 0.106 (0.106) data 0.000 (0.003) loss 1.3490 (1.0891) ce_loss 0.4927 (0.6082) loss_zs_kd 0.0665 (0.0747) loss_oracle 0.2638 (0.1794) acc 84.3750 (77.6562) kd_loss 0.6912 (0.3538) lr 2.0000e-03 eta 0:17:21
epoch [2/50] batch [140/203] time 0.099 (0.104) data 0.000 (0.003) loss 1.7160 (1.1408) ce_loss 0.9146 (0.6089) loss_zs_kd 0.0902 (0.0755) loss_oracle 0.2909 (0.1924) acc 71.8750 (77.9464) kd_loss 0.6109 (0.3980) lr 2.0000e-03 eta 0:17:04
epoch [2/50] batch [160/203] time 0.103 (0.104) data 0.000 (0.002) loss 1.3687 (1.1869) ce_loss 0.4783 (0.6077) loss_zs_kd 0.1088 (0.0779) loss_oracle 0.3067 (0.2125) acc 78.1250 (77.7734) kd_loss 0.6827 (0.4340) lr 2.0000e-03 eta 0:16:57
epoch [2/50] batch [180/203] time 0.092 (0.103) data 0.000 (0.002) loss 1.4130 (1.2167) ce_loss 0.4646 (0.5992) loss_zs_kd 0.0641 (0.0796) loss_oracle 0.1895 (0.2123) acc 84.3750 (77.9167) kd_loss 0.8216 (0.4715) lr 2.0000e-03 eta 0:16:49
epoch [2/50] batch [200/203] time 0.085 (0.102) data 0.000 (0.002) loss 1.9202 (1.2495) ce_loss 0.9521 (0.6004) loss_zs_kd 0.1362 (0.0810) loss_oracle 0.1828 (0.2160) acc 65.6250 (77.8438) kd_loss 0.8085 (0.5006) lr 2.0000e-03 eta 0:16:32
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,307
* accuracy: 82.5%
* error: 17.5%
* macro_f1: 86.0%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      82.5%, epoch: 2 *******
******* Domain c best val test acc: 100.0%, epoch: 2 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [3/50] batch [20/203] time 0.094 (0.121) data 0.000 (0.020) loss 1.7302 (1.4520) ce_loss 0.7554 (0.4952) loss_zs_kd 0.1582 (0.1072) loss_oracle 0.2515 (0.2240) acc 65.6250 (82.1875) kd_loss 0.7700 (0.7911) lr 1.9980e-03 eta 0:19:34
epoch [3/50] batch [40/203] time 0.081 (0.105) data 0.000 (0.010) loss 1.6224 (1.5239) ce_loss 0.6343 (0.5329) loss_zs_kd 0.1535 (0.1026) loss_oracle 0.1425 (0.2452) acc 78.1250 (80.0000) kd_loss 0.8401 (0.8171) lr 1.9980e-03 eta 0:17:02
epoch [3/50] batch [60/203] time 0.087 (0.099) data 0.000 (0.007) loss 1.3466 (1.5141) ce_loss 0.4565 (0.5312) loss_zs_kd 0.0892 (0.1033) loss_oracle 0.1467 (0.2110) acc 78.1250 (80.0000) kd_loss 0.7721 (0.8257) lr 1.9980e-03 eta 0:15:59
epoch [3/50] batch [80/203] time 0.084 (0.095) data 0.000 (0.005) loss 1.6463 (1.5064) ce_loss 0.6724 (0.5386) loss_zs_kd 0.1014 (0.1007) loss_oracle 0.1492 (0.1924) acc 75.0000 (79.2578) kd_loss 0.8487 (0.8213) lr 1.9980e-03 eta 0:15:22
epoch [3/50] batch [100/203] time 0.156 (0.098) data 0.000 (0.004) loss 1.6162 (1.5118) ce_loss 0.6074 (0.5424) loss_zs_kd 0.1535 (0.1017) loss_oracle 0.2564 (0.1954) acc 71.8750 (79.4062) kd_loss 0.8039 (0.8209) lr 1.9980e-03 eta 0:15:45
epoch [3/50] batch [120/203] time 0.145 (0.099) data 0.000 (0.004) loss 1.5979 (1.5142) ce_loss 0.6992 (0.5491) loss_zs_kd 0.0924 (0.1028) loss_oracle 0.2222 (0.1946) acc 78.1250 (79.3750) kd_loss 0.7414 (0.8164) lr 1.9980e-03 eta 0:15:57
epoch [3/50] batch [140/203] time 0.086 (0.101) data 0.000 (0.003) loss 1.3570 (1.5089) ce_loss 0.3955 (0.5534) loss_zs_kd 0.0509 (0.1013) loss_oracle 0.1728 (0.1871) acc 78.1250 (79.2634) kd_loss 0.8496 (0.8113) lr 1.9980e-03 eta 0:16:13
epoch [3/50] batch [160/203] time 0.060 (0.099) data 0.000 (0.003) loss 1.7785 (1.5110) ce_loss 0.8438 (0.5594) loss_zs_kd 0.0662 (0.1008) loss_oracle 0.1585 (0.1839) acc 65.6250 (79.0039) kd_loss 0.8224 (0.8093) lr 1.9980e-03 eta 0:15:47
epoch [3/50] batch [180/203] time 0.079 (0.097) data 0.000 (0.003) loss 1.2794 (1.5079) ce_loss 0.2800 (0.5583) loss_zs_kd 0.1201 (0.0998) loss_oracle 0.2013 (0.1837) acc 93.7500 (79.0972) kd_loss 0.8386 (0.8078) lr 1.9980e-03 eta 0:15:27
epoch [3/50] batch [200/203] time 0.067 (0.095) data 0.000 (0.002) loss 1.5654 (1.5049) ce_loss 0.5024 (0.5553) loss_zs_kd 0.1359 (0.0999) loss_oracle 0.1988 (0.1869) acc 81.2500 (79.2188) kd_loss 0.8957 (0.8062) lr 1.9980e-03 eta 0:15:02
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,324
* accuracy: 83.1%
* error: 16.9%
* macro_f1: 86.8%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.1%, epoch: 3 *******
******* Domain c best val test acc: 100.0%, epoch: 3 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [4/50] batch [20/203] time 0.086 (0.128) data 0.000 (0.023) loss 1.4005 (1.5058) ce_loss 0.4939 (0.5944) loss_zs_kd 0.1130 (0.0949) loss_oracle 0.1709 (0.1893) acc 81.2500 (78.4375) kd_loss 0.7646 (0.7692) lr 1.9921e-03 eta 0:20:17
epoch [4/50] batch [40/203] time 0.140 (0.111) data 0.000 (0.012) loss 1.1627 (1.4834) ce_loss 0.3030 (0.5581) loss_zs_kd 0.0678 (0.0998) loss_oracle 0.1804 (0.1967) acc 90.6250 (80.0000) kd_loss 0.7356 (0.7771) lr 1.9921e-03 eta 0:17:35
epoch [4/50] batch [60/203] time 0.084 (0.109) data 0.001 (0.008) loss 1.5351 (1.4763) ce_loss 0.6226 (0.5450) loss_zs_kd 0.1269 (0.1054) loss_oracle 0.2279 (0.2047) acc 78.1250 (80.2604) kd_loss 0.7352 (0.7762) lr 1.9921e-03 eta 0:17:10
epoch [4/50] batch [80/203] time 0.072 (0.106) data 0.001 (0.006) loss 1.4002 (1.4736) ce_loss 0.4907 (0.5411) loss_zs_kd 0.0969 (0.1079) loss_oracle 0.1923 (0.2091) acc 81.2500 (80.5078) kd_loss 0.7649 (0.7740) lr 1.9921e-03 eta 0:16:46
epoch [4/50] batch [100/203] time 0.087 (0.103) data 0.000 (0.005) loss 1.4651 (1.4691) ce_loss 0.5884 (0.5473) loss_zs_kd 0.1279 (0.1074) loss_oracle 0.1345 (0.1993) acc 75.0000 (80.2812) kd_loss 0.7456 (0.7685) lr 1.9921e-03 eta 0:16:10
epoch [4/50] batch [120/203] time 0.091 (0.100) data 0.000 (0.004) loss 1.4213 (1.4675) ce_loss 0.6021 (0.5560) loss_zs_kd 0.0753 (0.1051) loss_oracle 0.1536 (0.1916) acc 81.2500 (79.5573) kd_loss 0.7048 (0.7632) lr 1.9921e-03 eta 0:15:41
epoch [4/50] batch [140/203] time 0.096 (0.099) data 0.000 (0.004) loss 1.3602 (1.4514) ce_loss 0.5674 (0.5482) loss_zs_kd 0.0570 (0.1041) loss_oracle 0.1530 (0.1873) acc 81.2500 (79.8661) kd_loss 0.6878 (0.7575) lr 1.9921e-03 eta 0:15:30
epoch [4/50] batch [160/203] time 0.104 (0.099) data 0.000 (0.003) loss 1.4834 (1.4390) ce_loss 0.6523 (0.5431) loss_zs_kd 0.0978 (0.1053) loss_oracle 0.1919 (0.1830) acc 81.2500 (79.8242) kd_loss 0.6862 (0.7517) lr 1.9921e-03 eta 0:15:28
epoch [4/50] batch [180/203] time 0.100 (0.099) data 0.000 (0.003) loss 1.1658 (1.4309) ce_loss 0.3513 (0.5402) loss_zs_kd 0.1059 (0.1040) loss_oracle 0.1898 (0.1834) acc 84.3750 (79.8785) kd_loss 0.6666 (0.7470) lr 1.9921e-03 eta 0:15:26
epoch [4/50] batch [200/203] time 0.089 (0.098) data 0.000 (0.003) loss 1.5775 (1.4255) ce_loss 0.7471 (0.5405) loss_zs_kd 0.1314 (0.1041) loss_oracle 0.1888 (0.1825) acc 75.0000 (79.9219) kd_loss 0.6703 (0.7416) lr 1.9921e-03 eta 0:15:18
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,325
* accuracy: 83.2%
* error: 16.8%
* macro_f1: 86.7%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.2%, epoch: 4 *******
******* Domain c best val test acc: 100.0%, epoch: 4 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [5/50] batch [20/203] time 0.094 (0.127) data 0.000 (0.027) loss 1.2491 (1.4130) ce_loss 0.4111 (0.5623) loss_zs_kd 0.0901 (0.0998) loss_oracle 0.1574 (0.1882) acc 81.2500 (80.1562) kd_loss 0.7143 (0.7068) lr 1.9823e-03 eta 0:19:44
epoch [5/50] batch [40/203] time 0.094 (0.113) data 0.001 (0.013) loss 1.3417 (1.3708) ce_loss 0.5591 (0.5434) loss_zs_kd 0.0987 (0.1004) loss_oracle 0.1491 (0.1667) acc 81.2500 (81.0156) kd_loss 0.6587 (0.6938) lr 1.9823e-03 eta 0:17:28
epoch [5/50] batch [60/203] time 0.093 (0.106) data 0.000 (0.009) loss 1.2372 (1.3740) ce_loss 0.5254 (0.5398) loss_zs_kd 0.0734 (0.0998) loss_oracle 0.1696 (0.1667) acc 81.2500 (81.0417) kd_loss 0.5903 (0.7009) lr 1.9823e-03 eta 0:16:22
epoch [5/50] batch [80/203] time 0.095 (0.104) data 0.000 (0.007) loss 1.2796 (1.3673) ce_loss 0.4978 (0.5374) loss_zs_kd 0.1224 (0.0994) loss_oracle 0.1868 (0.1739) acc 75.0000 (80.9766) kd_loss 0.6272 (0.6932) lr 1.9823e-03 eta 0:16:02
epoch [5/50] batch [100/203] time 0.088 (0.101) data 0.000 (0.006) loss 1.1468 (1.3726) ce_loss 0.2559 (0.5414) loss_zs_kd 0.0833 (0.1012) loss_oracle 0.2247 (0.1850) acc 93.7500 (80.8125) kd_loss 0.7369 (0.6882) lr 1.9823e-03 eta 0:15:33
epoch [5/50] batch [120/203] time 0.093 (0.100) data 0.000 (0.005) loss 1.1085 (1.3795) ce_loss 0.4038 (0.5490) loss_zs_kd 0.1103 (0.1012) loss_oracle 0.2169 (0.1909) acc 87.5000 (80.5469) kd_loss 0.5411 (0.6844) lr 1.9823e-03 eta 0:15:23
epoch [5/50] batch [140/203] time 0.093 (0.100) data 0.000 (0.004) loss 1.2411 (1.3727) ce_loss 0.4014 (0.5463) loss_zs_kd 0.1548 (0.1019) loss_oracle 0.1689 (0.1899) acc 87.5000 (80.3348) kd_loss 0.6779 (0.6806) lr 1.9823e-03 eta 0:15:18
epoch [5/50] batch [160/203] time 0.099 (0.099) data 0.000 (0.004) loss 1.0755 (1.3660) ce_loss 0.3625 (0.5453) loss_zs_kd 0.0516 (0.1016) loss_oracle 0.1772 (0.1876) acc 90.6250 (80.5078) kd_loss 0.5985 (0.6760) lr 1.9823e-03 eta 0:15:11
epoch [5/50] batch [180/203] time 0.097 (0.099) data 0.000 (0.003) loss 1.1287 (1.3590) ce_loss 0.3467 (0.5398) loss_zs_kd 0.0885 (0.1014) loss_oracle 0.1887 (0.1865) acc 87.5000 (80.6250) kd_loss 0.6434 (0.6753) lr 1.9823e-03 eta 0:15:07
epoch [5/50] batch [200/203] time 0.072 (0.098) data 0.000 (0.003) loss 1.2157 (1.3605) ce_loss 0.2976 (0.5402) loss_zs_kd 0.1011 (0.1010) loss_oracle 0.2032 (0.1878) acc 93.7500 (80.6406) kd_loss 0.7660 (0.6759) lr 1.9823e-03 eta 0:14:53
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,336
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 87.0%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.6%, epoch: 5 *******
******* Domain c best val test acc: 100.0%, epoch: 5 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [6/50] batch [20/203] time 0.097 (0.124) data 0.000 (0.026) loss 1.3400 (1.3019) ce_loss 0.5620 (0.5045) loss_zs_kd 0.0497 (0.1069) loss_oracle 0.1599 (0.1707) acc 75.0000 (81.0938) kd_loss 0.6732 (0.6586) lr 1.9686e-03 eta 0:18:49
epoch [6/50] batch [40/203] time 0.079 (0.121) data 0.000 (0.013) loss 1.1684 (1.3462) ce_loss 0.4111 (0.5367) loss_zs_kd 0.0901 (0.1015) loss_oracle 0.1658 (0.1791) acc 84.3750 (78.8281) kd_loss 0.6293 (0.6692) lr 1.9686e-03 eta 0:18:24
epoch [6/50] batch [60/203] time 0.080 (0.110) data 0.000 (0.009) loss 1.3362 (1.3439) ce_loss 0.4553 (0.5252) loss_zs_kd 0.1288 (0.1056) loss_oracle 0.1521 (0.1754) acc 81.2500 (80.0000) kd_loss 0.7405 (0.6781) lr 1.9686e-03 eta 0:16:42
epoch [6/50] batch [80/203] time 0.085 (0.105) data 0.000 (0.007) loss 1.3993 (1.3501) ce_loss 0.4280 (0.5252) loss_zs_kd 0.1035 (0.1054) loss_oracle 0.2769 (0.1791) acc 84.3750 (80.1172) kd_loss 0.7811 (0.6826) lr 1.9686e-03 eta 0:15:46
epoch [6/50] batch [100/203] time 0.138 (0.102) data 0.000 (0.005) loss 1.4840 (1.3547) ce_loss 0.6201 (0.5295) loss_zs_kd 0.0894 (0.1044) loss_oracle 0.2430 (0.1855) acc 71.8750 (80.4375) kd_loss 0.6977 (0.6803) lr 1.9686e-03 eta 0:15:23
epoch [6/50] batch [120/203] time 0.091 (0.103) data 0.000 (0.005) loss 1.3831 (1.3624) ce_loss 0.6084 (0.5321) loss_zs_kd 0.0919 (0.1036) loss_oracle 0.1738 (0.1895) acc 71.8750 (80.4688) kd_loss 0.6419 (0.6838) lr 1.9686e-03 eta 0:15:25
epoch [6/50] batch [140/203] time 0.152 (0.104) data 0.000 (0.004) loss 1.4683 (1.3709) ce_loss 0.5781 (0.5364) loss_zs_kd 0.0997 (0.1032) loss_oracle 0.2226 (0.1909) acc 71.8750 (80.3571) kd_loss 0.7290 (0.6875) lr 1.9686e-03 eta 0:15:38
epoch [6/50] batch [160/203] time 0.076 (0.105) data 0.000 (0.004) loss 1.6858 (1.3731) ce_loss 0.7773 (0.5368) loss_zs_kd 0.0725 (0.1039) loss_oracle 0.2356 (0.1927) acc 78.1250 (80.4492) kd_loss 0.7544 (0.6880) lr 1.9686e-03 eta 0:15:44
epoch [6/50] batch [180/203] time 0.091 (0.105) data 0.000 (0.003) loss 1.1714 (1.3753) ce_loss 0.4099 (0.5354) loss_zs_kd 0.0855 (0.1051) loss_oracle 0.2247 (0.1943) acc 90.6250 (80.4167) kd_loss 0.6064 (0.6902) lr 1.9686e-03 eta 0:15:41
epoch [6/50] batch [200/203] time 0.126 (0.104) data 0.000 (0.003) loss 1.4670 (1.3836) ce_loss 0.5640 (0.5404) loss_zs_kd 0.0765 (0.1047) loss_oracle 0.2236 (0.1953) acc 71.8750 (80.2500) kd_loss 0.7530 (0.6932) lr 1.9686e-03 eta 0:15:32
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,331
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 87.0%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.6%, epoch: 5 *******
******* Domain c best val test acc: 100.0%, epoch: 5 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [7/50] batch [20/203] time 0.088 (0.127) data 0.000 (0.029) loss 1.3451 (1.4131) ce_loss 0.4067 (0.5438) loss_zs_kd 0.0799 (0.1100) loss_oracle 0.2010 (0.1901) acc 87.5000 (79.3750) kd_loss 0.7979 (0.7192) lr 1.9511e-03 eta 0:18:48
epoch [7/50] batch [40/203] time 0.088 (0.111) data 0.000 (0.015) loss 1.0897 (1.3936) ce_loss 0.2952 (0.5178) loss_zs_kd 0.1234 (0.1095) loss_oracle 0.2151 (0.1967) acc 90.6250 (80.5469) kd_loss 0.6253 (0.7227) lr 1.9511e-03 eta 0:16:27
epoch [7/50] batch [60/203] time 0.101 (0.107) data 0.000 (0.010) loss 1.5487 (1.4136) ce_loss 0.5684 (0.5256) loss_zs_kd 0.1469 (0.1120) loss_oracle 0.2543 (0.2052) acc 81.2500 (80.4688) kd_loss 0.7797 (0.7294) lr 1.9511e-03 eta 0:15:45
epoch [7/50] batch [80/203] time 0.080 (0.103) data 0.000 (0.007) loss 1.3315 (1.4151) ce_loss 0.4729 (0.5276) loss_zs_kd 0.1341 (0.1086) loss_oracle 0.1452 (0.2017) acc 84.3750 (80.2734) kd_loss 0.7189 (0.7323) lr 1.9511e-03 eta 0:15:09
epoch [7/50] batch [100/203] time 0.099 (0.101) data 0.000 (0.006) loss 1.3538 (1.4123) ce_loss 0.4075 (0.5274) loss_zs_kd 0.0967 (0.1087) loss_oracle 0.2685 (0.2026) acc 75.0000 (80.2812) kd_loss 0.7638 (0.7292) lr 1.9511e-03 eta 0:14:55
epoch [7/50] batch [120/203] time 0.090 (0.099) data 0.000 (0.005) loss 1.4501 (1.4086) ce_loss 0.5435 (0.5239) loss_zs_kd 0.0856 (0.1083) loss_oracle 0.2650 (0.2057) acc 75.0000 (80.2083) kd_loss 0.7313 (0.7277) lr 1.9511e-03 eta 0:14:35
epoch [7/50] batch [140/203] time 0.093 (0.098) data 0.000 (0.004) loss 1.3575 (1.4067) ce_loss 0.4460 (0.5167) loss_zs_kd 0.1263 (0.1091) loss_oracle 0.2752 (0.2099) acc 84.3750 (80.4911) kd_loss 0.7107 (0.7306) lr 1.9511e-03 eta 0:14:22
epoch [7/50] batch [160/203] time 0.080 (0.097) data 0.000 (0.004) loss 1.8333 (1.4180) ce_loss 0.8989 (0.5210) loss_zs_kd 0.1180 (0.1096) loss_oracle 0.2161 (0.2163) acc 68.7500 (80.3320) kd_loss 0.7673 (0.7341) lr 1.9511e-03 eta 0:14:13
epoch [7/50] batch [180/203] time 0.093 (0.096) data 0.000 (0.003) loss 1.5231 (1.4226) ce_loss 0.6294 (0.5188) loss_zs_kd 0.1036 (0.1101) loss_oracle 0.1679 (0.2167) acc 75.0000 (80.4514) kd_loss 0.7579 (0.7404) lr 1.9511e-03 eta 0:14:04
epoch [7/50] batch [200/203] time 0.088 (0.096) data 0.000 (0.003) loss 1.3787 (1.4290) ce_loss 0.5132 (0.5200) loss_zs_kd 0.0867 (0.1100) loss_oracle 0.2008 (0.2186) acc 75.0000 (80.3750) kd_loss 0.7218 (0.7447) lr 1.9511e-03 eta 0:13:54
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,340
* accuracy: 83.7%
* error: 16.3%
* macro_f1: 87.1%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.7%, epoch: 7 *******
******* Domain c best val test acc: 100.0%, epoch: 7 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [8/50] batch [20/203] time 0.122 (0.137) data 0.000 (0.034) loss 1.5507 (1.4513) ce_loss 0.6611 (0.5132) loss_zs_kd 0.1163 (0.0937) loss_oracle 0.2102 (0.2206) acc 75.0000 (82.1875) kd_loss 0.7263 (0.7809) lr 1.9298e-03 eta 0:19:56
epoch [8/50] batch [40/203] time 0.105 (0.123) data 0.000 (0.017) loss 1.4680 (1.4545) ce_loss 0.3752 (0.5296) loss_zs_kd 0.1285 (0.1017) loss_oracle 0.2422 (0.2165) acc 78.1250 (80.7031) kd_loss 0.9074 (0.7659) lr 1.9298e-03 eta 0:17:48
epoch [8/50] batch [60/203] time 0.103 (0.116) data 0.001 (0.011) loss 1.1806 (1.4703) ce_loss 0.4092 (0.5466) loss_zs_kd 0.0930 (0.1082) loss_oracle 0.1812 (0.2066) acc 84.3750 (79.6875) kd_loss 0.6343 (0.7663) lr 1.9298e-03 eta 0:16:43
epoch [8/50] batch [80/203] time 0.082 (0.107) data 0.000 (0.009) loss 1.5196 (1.4583) ce_loss 0.6787 (0.5446) loss_zs_kd 0.1125 (0.1075) loss_oracle 0.1837 (0.2006) acc 71.8750 (79.8438) kd_loss 0.6928 (0.7597) lr 1.9298e-03 eta 0:15:23
epoch [8/50] batch [100/203] time 0.074 (0.101) data 0.000 (0.007) loss 1.1863 (1.4358) ce_loss 0.3638 (0.5319) loss_zs_kd 0.1253 (0.1073) loss_oracle 0.1836 (0.1978) acc 78.1250 (80.2500) kd_loss 0.6680 (0.7514) lr 1.9298e-03 eta 0:14:29
epoch [8/50] batch [120/203] time 0.079 (0.098) data 0.000 (0.006) loss 1.3855 (1.4283) ce_loss 0.4250 (0.5268) loss_zs_kd 0.1204 (0.1095) loss_oracle 0.2484 (0.2000) acc 87.5000 (80.4948) kd_loss 0.7761 (0.7467) lr 1.9298e-03 eta 0:13:59
epoch [8/50] batch [140/203] time 0.099 (0.097) data 0.000 (0.005) loss 1.4810 (1.4326) ce_loss 0.6333 (0.5273) loss_zs_kd 0.0864 (0.1091) loss_oracle 0.1773 (0.2044) acc 75.0000 (80.2679) kd_loss 0.7158 (0.7486) lr 1.9298e-03 eta 0:13:52
epoch [8/50] batch [160/203] time 0.076 (0.097) data 0.000 (0.004) loss 1.5339 (1.4275) ce_loss 0.6987 (0.5234) loss_zs_kd 0.0879 (0.1084) loss_oracle 0.1734 (0.2035) acc 65.6250 (80.4102) kd_loss 0.7044 (0.7481) lr 1.9298e-03 eta 0:13:50
epoch [8/50] batch [180/203] time 0.065 (0.098) data 0.000 (0.004) loss 1.4215 (1.4283) ce_loss 0.5137 (0.5226) loss_zs_kd 0.0937 (0.1085) loss_oracle 0.1831 (0.2050) acc 87.5000 (80.5556) kd_loss 0.7695 (0.7490) lr 1.9298e-03 eta 0:13:55
epoch [8/50] batch [200/203] time 0.064 (0.096) data 0.000 (0.004) loss 1.3391 (1.4276) ce_loss 0.4653 (0.5217) loss_zs_kd 0.0861 (0.1085) loss_oracle 0.1399 (0.2035) acc 81.2500 (80.6719) kd_loss 0.7608 (0.7499) lr 1.9298e-03 eta 0:13:39
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,344
* accuracy: 83.9%
* error: 16.1%
* macro_f1: 87.2%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.9%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [9/50] batch [20/203] time 0.066 (0.138) data 0.000 (0.038) loss 1.5146 (1.4834) ce_loss 0.6880 (0.5460) loss_zs_kd 0.1420 (0.1099) loss_oracle 0.2096 (0.2109) acc 78.1250 (79.0625) kd_loss 0.6508 (0.7769) lr 1.9048e-03 eta 0:19:35
epoch [9/50] batch [40/203] time 0.162 (0.122) data 0.000 (0.019) loss 1.5155 (1.4633) ce_loss 0.6777 (0.5399) loss_zs_kd 0.1101 (0.1093) loss_oracle 0.1526 (0.2034) acc 71.8750 (79.6094) kd_loss 0.7065 (0.7670) lr 1.9048e-03 eta 0:17:14
epoch [9/50] batch [60/203] time 0.150 (0.115) data 0.000 (0.013) loss 1.7196 (1.4595) ce_loss 0.7520 (0.5368) loss_zs_kd 0.1422 (0.1098) loss_oracle 0.1649 (0.1974) acc 65.6250 (80.4688) kd_loss 0.8140 (0.7691) lr 1.9048e-03 eta 0:16:15
epoch [9/50] batch [80/203] time 0.136 (0.113) data 0.001 (0.010) loss 1.3890 (1.4519) ce_loss 0.4944 (0.5345) loss_zs_kd 0.1123 (0.1076) loss_oracle 0.1769 (0.1951) acc 81.2500 (80.2344) kd_loss 0.7500 (0.7660) lr 1.9048e-03 eta 0:15:56
epoch [9/50] batch [100/203] time 0.075 (0.112) data 0.000 (0.008) loss 1.5234 (1.4657) ce_loss 0.5547 (0.5378) loss_zs_kd 0.1041 (0.1108) loss_oracle 0.1747 (0.1975) acc 81.2500 (80.0000) kd_loss 0.8293 (0.7738) lr 1.9048e-03 eta 0:15:41
epoch [9/50] batch [120/203] time 0.079 (0.107) data 0.000 (0.007) loss 1.3602 (1.4608) ce_loss 0.3965 (0.5289) loss_zs_kd 0.1206 (0.1101) loss_oracle 0.1646 (0.1982) acc 87.5000 (80.5990) kd_loss 0.8211 (0.7777) lr 1.9048e-03 eta 0:14:59
epoch [9/50] batch [140/203] time 0.083 (0.104) data 0.000 (0.006) loss 1.7716 (1.4681) ce_loss 0.7900 (0.5321) loss_zs_kd 0.0820 (0.1098) loss_oracle 0.2120 (0.1964) acc 65.6250 (80.3795) kd_loss 0.8345 (0.7829) lr 1.9048e-03 eta 0:14:33
epoch [9/50] batch [160/203] time 0.092 (0.103) data 0.000 (0.005) loss 1.0703 (1.4710) ce_loss 0.1997 (0.5331) loss_zs_kd 0.1126 (0.1088) loss_oracle 0.1512 (0.1950) acc 93.7500 (80.1367) kd_loss 0.7387 (0.7861) lr 1.9048e-03 eta 0:14:21
epoch [9/50] batch [180/203] time 0.099 (0.102) data 0.000 (0.005) loss 1.8275 (1.4797) ce_loss 0.8599 (0.5344) loss_zs_kd 0.0975 (0.1101) loss_oracle 0.2340 (0.1966) acc 65.6250 (80.0000) kd_loss 0.8019 (0.7919) lr 1.9048e-03 eta 0:14:14
epoch [9/50] batch [200/203] time 0.081 (0.101) data 0.000 (0.004) loss 1.3999 (1.4790) ce_loss 0.5308 (0.5292) loss_zs_kd 0.0905 (0.1092) loss_oracle 0.1313 (0.1984) acc 78.1250 (80.3594) kd_loss 0.7582 (0.7960) lr 1.9048e-03 eta 0:14:01
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,345
* accuracy: 83.9%
* error: 16.1%
* macro_f1: 87.2%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.9%, epoch: 9 *******
******* Domain c best val test acc: 100.0%, epoch: 9 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [10/50] batch [20/203] time 0.109 (0.140) data 0.000 (0.040) loss 1.3073 (1.5283) ce_loss 0.2839 (0.5278) loss_zs_kd 0.0791 (0.1060) loss_oracle 0.2597 (0.2471) acc 96.8750 (79.3750) kd_loss 0.8540 (0.8239) lr 1.8763e-03 eta 0:19:26
epoch [10/50] batch [40/203] time 0.106 (0.119) data 0.000 (0.020) loss 1.6032 (1.5358) ce_loss 0.5186 (0.5246) loss_zs_kd 0.1483 (0.1077) loss_oracle 0.2439 (0.2328) acc 84.3750 (80.3906) kd_loss 0.8886 (0.8410) lr 1.8763e-03 eta 0:16:22
epoch [10/50] batch [60/203] time 0.100 (0.112) data 0.000 (0.014) loss 1.7179 (1.5187) ce_loss 0.5513 (0.5123) loss_zs_kd 0.1181 (0.1151) loss_oracle 0.2256 (0.2264) acc 81.2500 (80.6250) kd_loss 0.9948 (0.8357) lr 1.8763e-03 eta 0:15:27
epoch [10/50] batch [80/203] time 0.099 (0.109) data 0.000 (0.010) loss 1.4867 (1.5054) ce_loss 0.4468 (0.5039) loss_zs_kd 0.1083 (0.1138) loss_oracle 0.1619 (0.2123) acc 90.6250 (81.0156) kd_loss 0.9049 (0.8384) lr 1.8763e-03 eta 0:14:59
epoch [10/50] batch [100/203] time 0.099 (0.107) data 0.000 (0.008) loss 2.0972 (1.5051) ce_loss 1.1191 (0.5081) loss_zs_kd 0.1450 (0.1157) loss_oracle 0.2208 (0.2040) acc 62.5000 (80.5625) kd_loss 0.7952 (0.8372) lr 1.8763e-03 eta 0:14:41
epoch [10/50] batch [120/203] time 0.106 (0.106) data 0.000 (0.007) loss 1.5830 (1.5090) ce_loss 0.5376 (0.5136) loss_zs_kd 0.1449 (0.1160) loss_oracle 0.1831 (0.2010) acc 81.2500 (80.3385) kd_loss 0.8814 (0.8369) lr 1.8763e-03 eta 0:14:28
epoch [10/50] batch [140/203] time 0.100 (0.105) data 0.000 (0.006) loss 1.5971 (1.5130) ce_loss 0.6504 (0.5247) loss_zs_kd 0.0919 (0.1157) loss_oracle 0.1665 (0.1962) acc 75.0000 (80.2232) kd_loss 0.8175 (0.8324) lr 1.8763e-03 eta 0:14:15
epoch [10/50] batch [160/203] time 0.099 (0.104) data 0.000 (0.005) loss 1.4152 (1.5132) ce_loss 0.4268 (0.5276) loss_zs_kd 0.0725 (0.1156) loss_oracle 0.1683 (0.1942) acc 84.3750 (80.1367) kd_loss 0.8681 (0.8306) lr 1.8763e-03 eta 0:14:08
epoch [10/50] batch [180/203] time 0.100 (0.103) data 0.001 (0.005) loss 1.4861 (1.5159) ce_loss 0.5127 (0.5297) loss_zs_kd 0.0959 (0.1151) loss_oracle 0.2118 (0.1943) acc 87.5000 (80.0347) kd_loss 0.8196 (0.8315) lr 1.8763e-03 eta 0:14:01
epoch [10/50] batch [200/203] time 0.067 (0.102) data 0.000 (0.004) loss 1.6689 (1.5145) ce_loss 0.6650 (0.5264) loss_zs_kd 0.1212 (0.1152) loss_oracle 0.1602 (0.1929) acc 81.2500 (80.2969) kd_loss 0.8632 (0.8341) lr 1.8763e-03 eta 0:13:50
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,351
* accuracy: 84.1%
* error: 15.9%
* macro_f1: 87.5%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      84.1%, epoch: 10 *******
******* Domain c best val test acc: 100.0%, epoch: 10 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [11/50] batch [20/203] time 0.077 (0.148) data 0.000 (0.042) loss 1.4909 (1.5507) ce_loss 0.6206 (0.5491) loss_zs_kd 0.1200 (0.1109) loss_oracle 0.1594 (0.1835) acc 71.8750 (79.3750) kd_loss 0.7306 (0.8544) lr 1.8443e-03 eta 0:19:58
epoch [11/50] batch [40/203] time 0.079 (0.118) data 0.000 (0.021) loss 1.5560 (1.5511) ce_loss 0.5601 (0.5422) loss_zs_kd 0.1577 (0.1116) loss_oracle 0.2058 (0.1955) acc 75.0000 (79.8438) kd_loss 0.8142 (0.8553) lr 1.8443e-03 eta 0:15:54
epoch [11/50] batch [60/203] time 0.088 (0.105) data 0.000 (0.014) loss 1.6774 (1.5382) ce_loss 0.6680 (0.5272) loss_zs_kd 0.1040 (0.1100) loss_oracle 0.2450 (0.1968) acc 71.8750 (80.5208) kd_loss 0.8350 (0.8576) lr 1.8443e-03 eta 0:14:10
epoch [11/50] batch [80/203] time 0.085 (0.100) data 0.001 (0.011) loss 1.4452 (1.5235) ce_loss 0.3894 (0.5182) loss_zs_kd 0.1120 (0.1116) loss_oracle 0.1902 (0.2000) acc 84.3750 (80.5078) kd_loss 0.9047 (0.8495) lr 1.8443e-03 eta 0:13:20
epoch [11/50] batch [100/203] time 0.165 (0.098) data 0.000 (0.009) loss 1.3445 (1.5185) ce_loss 0.4258 (0.5173) loss_zs_kd 0.0885 (0.1114) loss_oracle 0.1610 (0.1993) acc 90.6250 (80.4688) kd_loss 0.7940 (0.8459) lr 1.8443e-03 eta 0:13:09
epoch [11/50] batch [120/203] time 0.074 (0.099) data 0.000 (0.007) loss 1.4683 (1.5200) ce_loss 0.4185 (0.5205) loss_zs_kd 0.0789 (0.1105) loss_oracle 0.2115 (0.1995) acc 84.3750 (80.3906) kd_loss 0.9047 (0.8445) lr 1.8443e-03 eta 0:13:08
epoch [11/50] batch [140/203] time 0.066 (0.100) data 0.000 (0.006) loss 1.4619 (1.5154) ce_loss 0.4683 (0.5160) loss_zs_kd 0.1439 (0.1102) loss_oracle 0.2303 (0.2029) acc 84.3750 (80.6696) kd_loss 0.8066 (0.8428) lr 1.8443e-03 eta 0:13:17
epoch [11/50] batch [160/203] time 0.090 (0.099) data 0.000 (0.005) loss 1.3538 (1.5105) ce_loss 0.3994 (0.5144) loss_zs_kd 0.1172 (0.1100) loss_oracle 0.2089 (0.2038) acc 84.3750 (80.8789) kd_loss 0.7914 (0.8391) lr 1.8443e-03 eta 0:13:11
epoch [11/50] batch [180/203] time 0.081 (0.101) data 0.000 (0.005) loss 1.5316 (1.5059) ce_loss 0.4741 (0.5097) loss_zs_kd 0.0813 (0.1093) loss_oracle 0.2004 (0.2032) acc 84.3750 (81.1632) kd_loss 0.9167 (0.8399) lr 1.8443e-03 eta 0:13:19
epoch [11/50] batch [200/203] time 0.088 (0.101) data 0.000 (0.004) loss 1.6133 (1.5115) ce_loss 0.5303 (0.5124) loss_zs_kd 0.0780 (0.1102) loss_oracle 0.1768 (0.2020) acc 81.2500 (80.8438) kd_loss 0.9557 (0.8429) lr 1.8443e-03 eta 0:13:20
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,353
* accuracy: 84.2%
* error: 15.8%
* macro_f1: 87.5%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      84.2%, epoch: 11 *******
******* Domain c best val test acc: 100.0%, epoch: 11 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [12/50] batch [20/203] time 0.109 (0.144) data 0.000 (0.045) loss 1.6123 (1.5381) ce_loss 0.5894 (0.5436) loss_zs_kd 0.0809 (0.1033) loss_oracle 0.1737 (0.1791) acc 78.1250 (80.1562) kd_loss 0.8957 (0.8534) lr 1.8090e-03 eta 0:18:57
epoch [12/50] batch [40/203] time 0.085 (0.122) data 0.000 (0.023) loss 1.3332 (1.5090) ce_loss 0.3396 (0.5117) loss_zs_kd 0.1719 (0.1049) loss_oracle 0.2505 (0.1914) acc 90.6250 (80.7812) kd_loss 0.7824 (0.8492) lr 1.8090e-03 eta 0:15:57
epoch [12/50] batch [60/203] time 0.110 (0.113) data 0.000 (0.015) loss 1.4813 (1.5127) ce_loss 0.5439 (0.5103) loss_zs_kd 0.1340 (0.1094) loss_oracle 0.2059 (0.1923) acc 84.3750 (80.6250) kd_loss 0.7675 (0.8516) lr 1.8090e-03 eta 0:14:51
epoch [12/50] batch [80/203] time 0.096 (0.109) data 0.000 (0.011) loss 1.7423 (1.5140) ce_loss 0.7202 (0.5151) loss_zs_kd 0.0965 (0.1110) loss_oracle 0.1945 (0.1899) acc 68.7500 (80.2344) kd_loss 0.8766 (0.8484) lr 1.8090e-03 eta 0:14:16
epoch [12/50] batch [100/203] time 0.080 (0.107) data 0.000 (0.009) loss 1.5475 (1.5180) ce_loss 0.6123 (0.5164) loss_zs_kd 0.1182 (0.1122) loss_oracle 0.1822 (0.1882) acc 81.2500 (80.5625) kd_loss 0.7850 (0.8514) lr 1.8090e-03 eta 0:13:58
epoch [12/50] batch [120/203] time 0.098 (0.106) data 0.000 (0.008) loss 1.7492 (1.5189) ce_loss 0.7441 (0.5214) loss_zs_kd 0.0566 (0.1112) loss_oracle 0.2370 (0.1873) acc 75.0000 (80.4688) kd_loss 0.8583 (0.8482) lr 1.8090e-03 eta 0:13:44
epoch [12/50] batch [140/203] time 0.105 (0.105) data 0.000 (0.007) loss 1.3677 (1.5083) ce_loss 0.3828 (0.5113) loss_zs_kd 0.1543 (0.1101) loss_oracle 0.1920 (0.1884) acc 87.5000 (81.0714) kd_loss 0.8117 (0.8477) lr 1.8090e-03 eta 0:13:36
epoch [12/50] batch [160/203] time 0.101 (0.105) data 0.000 (0.006) loss 1.2650 (1.4981) ce_loss 0.3203 (0.5027) loss_zs_kd 0.0987 (0.1104) loss_oracle 0.2270 (0.1908) acc 87.5000 (81.3281) kd_loss 0.7818 (0.8448) lr 1.8090e-03 eta 0:13:32
epoch [12/50] batch [180/203] time 0.106 (0.104) data 0.000 (0.005) loss 1.4812 (1.5039) ce_loss 0.4705 (0.5047) loss_zs_kd 0.1398 (0.1109) loss_oracle 0.2598 (0.1935) acc 84.3750 (81.2500) kd_loss 0.8110 (0.8470) lr 1.8090e-03 eta 0:13:28
epoch [12/50] batch [200/203] time 0.095 (0.103) data 0.000 (0.005) loss 1.6987 (1.5118) ce_loss 0.6680 (0.5118) loss_zs_kd 0.1289 (0.1117) loss_oracle 0.1952 (0.1943) acc 71.8750 (80.8906) kd_loss 0.8686 (0.8470) lr 1.8090e-03 eta 0:13:16
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,362
* accuracy: 84.5%
* error: 15.5%
* macro_f1: 87.9%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      84.5%, epoch: 12 *******
******* Domain c best val test acc: 100.0%, epoch: 12 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [13/50] batch [20/203] time 0.115 (0.150) data 0.000 (0.048) loss 1.5520 (1.5552) ce_loss 0.6035 (0.5294) loss_zs_kd 0.1069 (0.1096) loss_oracle 0.2082 (0.1921) acc 78.1250 (80.4688) kd_loss 0.7909 (0.8749) lr 1.7705e-03 eta 0:19:12
epoch [13/50] batch [40/203] time 0.091 (0.119) data 0.000 (0.024) loss 1.7377 (1.5343) ce_loss 0.5859 (0.5064) loss_zs_kd 0.0772 (0.1075) loss_oracle 0.2169 (0.1967) acc 75.0000 (81.2500) kd_loss 1.0048 (0.8757) lr 1.7705e-03 eta 0:15:15
epoch [13/50] batch [60/203] time 0.071 (0.104) data 0.000 (0.016) loss 1.3311 (1.5475) ce_loss 0.3335 (0.5152) loss_zs_kd 0.0749 (0.1080) loss_oracle 0.2320 (0.2097) acc 87.5000 (81.1979) kd_loss 0.8442 (0.8735) lr 1.7705e-03 eta 0:13:18
epoch [13/50] batch [80/203] time 0.083 (0.098) data 0.000 (0.012) loss 1.5964 (1.5571) ce_loss 0.5479 (0.5206) loss_zs_kd 0.1457 (0.1092) loss_oracle 0.2732 (0.2115) acc 78.1250 (81.1328) kd_loss 0.8391 (0.8761) lr 1.7705e-03 eta 0:12:29
epoch [13/50] batch [100/203] time 0.089 (0.096) data 0.000 (0.010) loss 1.3838 (1.5509) ce_loss 0.4478 (0.5180) loss_zs_kd 0.1032 (0.1087) loss_oracle 0.2101 (0.2114) acc 78.1250 (80.8750) kd_loss 0.7794 (0.8728) lr 1.7705e-03 eta 0:12:11
epoch [13/50] batch [120/203] time 0.164 (0.098) data 0.000 (0.008) loss 1.5898 (1.5502) ce_loss 0.5640 (0.5199) loss_zs_kd 0.1283 (0.1093) loss_oracle 0.2347 (0.2122) acc 75.0000 (80.9635) kd_loss 0.8443 (0.8696) lr 1.7705e-03 eta 0:12:26
epoch [13/50] batch [140/203] time 0.084 (0.100) data 0.000 (0.007) loss 1.6635 (1.5464) ce_loss 0.6167 (0.5151) loss_zs_kd 0.1521 (0.1097) loss_oracle 0.3012 (0.2154) acc 81.2500 (81.1607) kd_loss 0.8201 (0.8688) lr 1.7705e-03 eta 0:12:34
epoch [13/50] batch [160/203] time 0.077 (0.101) data 0.000 (0.006) loss 1.8131 (1.5515) ce_loss 0.8389 (0.5194) loss_zs_kd 0.0832 (0.1109) loss_oracle 0.2494 (0.2201) acc 71.8750 (80.9961) kd_loss 0.8079 (0.8665) lr 1.7705e-03 eta 0:12:41
epoch [13/50] batch [180/203] time 0.070 (0.099) data 0.000 (0.006) loss 1.7564 (1.5548) ce_loss 0.7021 (0.5219) loss_zs_kd 0.1195 (0.1107) loss_oracle 0.2987 (0.2213) acc 71.8750 (80.7639) kd_loss 0.8451 (0.8669) lr 1.7705e-03 eta 0:12:23
epoch [13/50] batch [200/203] time 0.072 (0.096) data 0.000 (0.005) loss 1.3304 (1.5537) ce_loss 0.2917 (0.5203) loss_zs_kd 0.1046 (0.1114) loss_oracle 0.2258 (0.2221) acc 93.7500 (80.9219) kd_loss 0.8734 (0.8667) lr 1.7705e-03 eta 0:12:02
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,352
* accuracy: 84.2%
* error: 15.8%
* macro_f1: 87.4%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      84.5%, epoch: 12 *******
******* Domain c best val test acc: 100.0%, epoch: 12 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [14/50] batch [20/203] time 0.069 (0.139) data 0.000 (0.044) loss 1.5503 (1.5806) ce_loss 0.5884 (0.5316) loss_zs_kd 0.0917 (0.1373) loss_oracle 0.2180 (0.2298) acc 81.2500 (80.4688) kd_loss 0.8071 (0.8655) lr 1.7290e-03 eta 0:17:21
epoch [14/50] batch [40/203] time 0.076 (0.124) data 0.000 (0.022) loss 1.4126 (1.5714) ce_loss 0.3206 (0.5284) loss_zs_kd 0.1216 (0.1281) loss_oracle 0.2263 (0.2255) acc 90.6250 (81.1719) kd_loss 0.9181 (0.8663) lr 1.7290e-03 eta 0:15:27
epoch [14/50] batch [60/203] time 0.110 (0.113) data 0.000 (0.015) loss 1.2556 (1.5374) ce_loss 0.3057 (0.5158) loss_zs_kd 0.1194 (0.1198) loss_oracle 0.2379 (0.2232) acc 90.6250 (81.6667) kd_loss 0.7713 (0.8502) lr 1.7290e-03 eta 0:13:59
epoch [14/50] batch [80/203] time 0.059 (0.111) data 0.000 (0.011) loss 1.4859 (1.5421) ce_loss 0.4536 (0.5196) loss_zs_kd 0.1078 (0.1223) loss_oracle 0.2696 (0.2262) acc 81.2500 (80.9766) kd_loss 0.8436 (0.8482) lr 1.7290e-03 eta 0:13:44
epoch [14/50] batch [100/203] time 0.082 (0.106) data 0.000 (0.009) loss 1.4590 (1.5379) ce_loss 0.4514 (0.5169) loss_zs_kd 0.1183 (0.1199) loss_oracle 0.2286 (0.2315) acc 84.3750 (80.9062) kd_loss 0.8341 (0.8453) lr 1.7290e-03 eta 0:13:04
epoch [14/50] batch [120/203] time 0.063 (0.101) data 0.000 (0.008) loss 1.6191 (1.5406) ce_loss 0.5181 (0.5156) loss_zs_kd 0.1335 (0.1211) loss_oracle 0.2906 (0.2350) acc 78.1250 (80.8333) kd_loss 0.8889 (0.8469) lr 1.7290e-03 eta 0:12:22
epoch [14/50] batch [140/203] time 0.056 (0.097) data 0.000 (0.007) loss 1.4012 (1.5447) ce_loss 0.5381 (0.5185) loss_zs_kd 0.0838 (0.1187) loss_oracle 0.2361 (0.2341) acc 78.1250 (80.7589) kd_loss 0.7031 (0.8497) lr 1.7290e-03 eta 0:11:53
epoch [14/50] batch [160/203] time 0.091 (0.095) data 0.000 (0.006) loss 1.6039 (1.5500) ce_loss 0.5894 (0.5164) loss_zs_kd 0.1257 (0.1171) loss_oracle 0.2096 (0.2371) acc 75.0000 (80.8203) kd_loss 0.8469 (0.8564) lr 1.7290e-03 eta 0:11:35
epoch [14/50] batch [180/203] time 0.091 (0.095) data 0.000 (0.005) loss 1.6150 (1.5511) ce_loss 0.4504 (0.5144) loss_zs_kd 0.1077 (0.1165) loss_oracle 0.2632 (0.2365) acc 84.3750 (80.9201) kd_loss 0.9791 (0.8601) lr 1.7290e-03 eta 0:11:34
epoch [14/50] batch [200/203] time 0.089 (0.094) data 0.000 (0.005) loss 1.3667 (1.5603) ce_loss 0.3267 (0.5204) loss_zs_kd 0.1078 (0.1160) loss_oracle 0.2543 (0.2372) acc 90.6250 (80.8281) kd_loss 0.8590 (0.8633) lr 1.7290e-03 eta 0:11:29
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,352
* accuracy: 84.2%
* error: 15.8%
* macro_f1: 87.3%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      84.5%, epoch: 12 *******
******* Domain c best val test acc: 100.0%, epoch: 12 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [15/50] batch [20/203] time 0.093 (0.142) data 0.000 (0.048) loss 1.6302 (1.5362) ce_loss 0.6089 (0.4634) loss_zs_kd 0.0929 (0.1104) loss_oracle 0.1981 (0.2397) acc 75.0000 (82.8125) kd_loss 0.8758 (0.8977) lr 1.6845e-03 eta 0:17:13
epoch [15/50] batch [40/203] time 0.082 (0.118) data 0.000 (0.024) loss 1.8186 (1.5817) ce_loss 0.8154 (0.5063) loss_zs_kd 0.1515 (0.1204) loss_oracle 0.2131 (0.2544) acc 71.8750 (81.3281) kd_loss 0.8209 (0.8880) lr 1.6845e-03 eta 0:14:16
epoch [15/50] batch [60/203] time 0.092 (0.110) data 0.000 (0.016) loss 1.6276 (1.5953) ce_loss 0.4690 (0.5092) loss_zs_kd 0.1088 (0.1238) loss_oracle 0.2603 (0.2602) acc 78.1250 (81.1458) kd_loss 0.9741 (0.8941) lr 1.6845e-03 eta 0:13:13
epoch [15/50] batch [80/203] time 0.101 (0.106) data 0.000 (0.012) loss 1.5028 (1.5923) ce_loss 0.4341 (0.5068) loss_zs_kd 0.1169 (0.1218) loss_oracle 0.2303 (0.2603) acc 87.5000 (81.2891) kd_loss 0.8951 (0.8944) lr 1.6845e-03 eta 0:12:44
epoch [15/50] batch [100/203] time 0.087 (0.104) data 0.001 (0.010) loss 1.6551 (1.5956) ce_loss 0.6313 (0.5044) loss_zs_kd 0.1468 (0.1199) loss_oracle 0.2279 (0.2605) acc 81.2500 (81.2812) kd_loss 0.8364 (0.9010) lr 1.6845e-03 eta 0:12:27
epoch [15/50] batch [120/203] time 0.098 (0.102) data 0.000 (0.008) loss 1.6057 (1.5959) ce_loss 0.5957 (0.5071) loss_zs_kd 0.1134 (0.1185) loss_oracle 0.2821 (0.2594) acc 68.7500 (81.1198) kd_loss 0.8123 (0.8998) lr 1.6845e-03 eta 0:12:13
epoch [15/50] batch [140/203] time 0.091 (0.100) data 0.000 (0.007) loss 1.7539 (1.5951) ce_loss 0.6431 (0.5073) loss_zs_kd 0.1051 (0.1182) loss_oracle 0.2563 (0.2583) acc 75.0000 (81.3170) kd_loss 0.9302 (0.8995) lr 1.6845e-03 eta 0:11:57
epoch [15/50] batch [160/203] time 0.092 (0.099) data 0.000 (0.006) loss 1.7954 (1.5910) ce_loss 0.8267 (0.5084) loss_zs_kd 0.1167 (0.1180) loss_oracle 0.2102 (0.2570) acc 59.3750 (81.2109) kd_loss 0.8053 (0.8951) lr 1.6845e-03 eta 0:11:49
epoch [15/50] batch [180/203] time 0.099 (0.099) data 0.000 (0.006) loss 1.6818 (1.5909) ce_loss 0.5542 (0.5088) loss_zs_kd 0.1335 (0.1169) loss_oracle 0.2514 (0.2571) acc 78.1250 (81.4236) kd_loss 0.9352 (0.8951) lr 1.6845e-03 eta 0:11:45
epoch [15/50] batch [200/203] time 0.089 (0.098) data 0.000 (0.005) loss 1.3830 (1.5894) ce_loss 0.4692 (0.5109) loss_zs_kd 0.0797 (0.1167) loss_oracle 0.2647 (0.2549) acc 75.0000 (81.2656) kd_loss 0.7415 (0.8927) lr 1.6845e-03 eta 0:11:35
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,350
* accuracy: 84.1%
* error: 15.9%
* macro_f1: 87.5%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      84.5%, epoch: 12 *******
******* Domain c best val test acc: 100.0%, epoch: 12 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [16/50] batch [20/203] time 0.107 (0.174) data 0.000 (0.062) loss 1.7906 (1.6203) ce_loss 0.6450 (0.5748) loss_zs_kd 0.0911 (0.1041) loss_oracle 0.2598 (0.2433) acc 81.2500 (78.9062) kd_loss 0.9702 (0.8719) lr 1.6374e-03 eta 0:20:35
epoch [16/50] batch [40/203] time 0.169 (0.139) data 0.000 (0.031) loss 1.6000 (1.5789) ce_loss 0.6787 (0.5459) loss_zs_kd 0.0754 (0.1062) loss_oracle 0.1930 (0.2380) acc 71.8750 (80.0000) kd_loss 0.7870 (0.8609) lr 1.6374e-03 eta 0:16:19
epoch [16/50] batch [60/203] time 0.082 (0.123) data 0.000 (0.021) loss 1.5245 (1.5745) ce_loss 0.5488 (0.5317) loss_zs_kd 0.1242 (0.1128) loss_oracle 0.3147 (0.2446) acc 84.3750 (80.5208) kd_loss 0.7562 (0.8641) lr 1.6374e-03 eta 0:14:25
epoch [16/50] batch [80/203] time 0.083 (0.113) data 0.000 (0.016) loss 1.6294 (1.5689) ce_loss 0.5737 (0.5252) loss_zs_kd 0.1359 (0.1111) loss_oracle 0.1903 (0.2405) acc 84.3750 (80.9375) kd_loss 0.8926 (0.8679) lr 1.6374e-03 eta 0:13:16
epoch [16/50] batch [100/203] time 0.084 (0.107) data 0.000 (0.013) loss 1.3217 (1.5710) ce_loss 0.3330 (0.5244) loss_zs_kd 0.1576 (0.1140) loss_oracle 0.2576 (0.2414) acc 90.6250 (80.8125) kd_loss 0.7810 (0.8689) lr 1.6374e-03 eta 0:12:32
epoch [16/50] batch [120/203] time 0.077 (0.106) data 0.001 (0.011) loss 1.5185 (1.5694) ce_loss 0.5459 (0.5210) loss_zs_kd 0.1102 (0.1173) loss_oracle 0.1917 (0.2384) acc 81.2500 (81.0938) kd_loss 0.8217 (0.8706) lr 1.6374e-03 eta 0:12:18
epoch [16/50] batch [140/203] time 0.116 (0.107) data 0.000 (0.009) loss 1.6053 (1.5655) ce_loss 0.5581 (0.5142) loss_zs_kd 0.1358 (0.1177) loss_oracle 0.2024 (0.2369) acc 81.2500 (81.1161) kd_loss 0.8781 (0.8740) lr 1.6374e-03 eta 0:12:22
epoch [16/50] batch [160/203] time 0.104 (0.105) data 0.000 (0.008) loss 1.3982 (1.5648) ce_loss 0.3323 (0.5151) loss_zs_kd 0.1002 (0.1182) loss_oracle 0.2462 (0.2365) acc 90.6250 (80.8203) kd_loss 0.8927 (0.8724) lr 1.6374e-03 eta 0:12:11
epoch [16/50] batch [180/203] time 0.113 (0.105) data 0.000 (0.007) loss 1.5643 (1.5654) ce_loss 0.4001 (0.5145) loss_zs_kd 0.1002 (0.1172) loss_oracle 0.2818 (0.2377) acc 84.3750 (80.8507) kd_loss 0.9732 (0.8734) lr 1.6374e-03 eta 0:12:03
epoch [16/50] batch [200/203] time 0.068 (0.104) data 0.000 (0.006) loss 1.6030 (1.5656) ce_loss 0.5117 (0.5120) loss_zs_kd 0.1255 (0.1177) loss_oracle 0.2730 (0.2385) acc 81.2500 (80.9531) kd_loss 0.8921 (0.8755) lr 1.6374e-03 eta 0:11:58
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,358
* accuracy: 84.4%
* error: 15.6%
* macro_f1: 87.4%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      84.5%, epoch: 12 *******
******* Domain c best val test acc: 100.0%, epoch: 12 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [17/50] batch [20/203] time 0.091 (0.155) data 0.000 (0.062) loss 1.5525 (1.5794) ce_loss 0.4294 (0.5085) loss_zs_kd 0.1189 (0.1208) loss_oracle 0.2688 (0.2489) acc 87.5000 (81.7188) kd_loss 0.9292 (0.8861) lr 1.5878e-03 eta 0:17:45
epoch [17/50] batch [40/203] time 0.097 (0.121) data 0.000 (0.031) loss 1.8020 (1.5673) ce_loss 0.6855 (0.4964) loss_zs_kd 0.1735 (0.1213) loss_oracle 0.3010 (0.2492) acc 75.0000 (82.2656) kd_loss 0.8792 (0.8856) lr 1.5878e-03 eta 0:13:49
epoch [17/50] batch [60/203] time 0.101 (0.111) data 0.001 (0.021) loss 1.5195 (1.5632) ce_loss 0.5522 (0.5023) loss_zs_kd 0.1143 (0.1190) loss_oracle 0.2096 (0.2499) acc 65.6250 (81.9792) kd_loss 0.8053 (0.8764) lr 1.5878e-03 eta 0:12:41
epoch [17/50] batch [80/203] time 0.091 (0.108) data 0.000 (0.016) loss 1.5074 (1.5637) ce_loss 0.5332 (0.5039) loss_zs_kd 0.1111 (0.1186) loss_oracle 0.2733 (0.2494) acc 75.0000 (81.8750) kd_loss 0.7820 (0.8758) lr 1.5878e-03 eta 0:12:19
epoch [17/50] batch [100/203] time 0.095 (0.106) data 0.000 (0.013) loss 1.6348 (1.5693) ce_loss 0.5117 (0.5059) loss_zs_kd 0.1233 (0.1184) loss_oracle 0.2993 (0.2494) acc 81.2500 (81.7812) kd_loss 0.9117 (0.8796) lr 1.5878e-03 eta 0:12:03
epoch [17/50] batch [120/203] time 0.104 (0.105) data 0.000 (0.011) loss 1.5944 (1.5650) ce_loss 0.3950 (0.5028) loss_zs_kd 0.1031 (0.1170) loss_oracle 0.2630 (0.2489) acc 84.3750 (82.0833) kd_loss 1.0163 (0.8792) lr 1.5878e-03 eta 0:11:54
epoch [17/50] batch [140/203] time 0.099 (0.105) data 0.000 (0.009) loss 1.8025 (1.5624) ce_loss 0.6860 (0.5007) loss_zs_kd 0.1073 (0.1164) loss_oracle 0.3208 (0.2540) acc 75.0000 (82.0759) kd_loss 0.9024 (0.8764) lr 1.5878e-03 eta 0:11:46
epoch [17/50] batch [160/203] time 0.096 (0.104) data 0.000 (0.008) loss 1.7070 (1.5770) ce_loss 0.6064 (0.5114) loss_zs_kd 0.1440 (0.1148) loss_oracle 0.2531 (0.2570) acc 78.1250 (81.6016) kd_loss 0.9020 (0.8798) lr 1.5878e-03 eta 0:11:40
epoch [17/50] batch [180/203] time 0.098 (0.103) data 0.000 (0.007) loss 1.6873 (1.5784) ce_loss 0.4609 (0.5104) loss_zs_kd 0.1778 (0.1147) loss_oracle 0.2332 (0.2586) acc 81.2500 (81.5972) kd_loss 1.0209 (0.8813) lr 1.5878e-03 eta 0:11:33
epoch [17/50] batch [200/203] time 0.086 (0.102) data 0.000 (0.006) loss 1.6389 (1.5811) ce_loss 0.5581 (0.5107) loss_zs_kd 0.1002 (0.1164) loss_oracle 0.2806 (0.2582) acc 78.1250 (81.5625) kd_loss 0.8904 (0.8831) lr 1.5878e-03 eta 0:11:23
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,360
* accuracy: 84.4%
* error: 15.6%
* macro_f1: 87.7%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      84.5%, epoch: 12 *******
******* Domain c best val test acc: 100.0%, epoch: 12 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [18/50] batch [20/203] time 0.092 (0.146) data 0.000 (0.054) loss 1.6999 (1.5699) ce_loss 0.6201 (0.4956) loss_zs_kd 0.1143 (0.1154) loss_oracle 0.2390 (0.2521) acc 71.8750 (82.0312) kd_loss 0.9032 (0.8904) lr 1.5358e-03 eta 0:16:15
epoch [18/50] batch [40/203] time 0.063 (0.115) data 0.001 (0.027) loss 1.4250 (1.5922) ce_loss 0.4006 (0.5160) loss_zs_kd 0.0728 (0.1147) loss_oracle 0.2850 (0.2513) acc 90.6250 (80.3906) kd_loss 0.8455 (0.8932) lr 1.5358e-03 eta 0:12:49
epoch [18/50] batch [60/203] time 0.081 (0.101) data 0.000 (0.018) loss 1.3443 (1.6087) ce_loss 0.3596 (0.5180) loss_zs_kd 0.1393 (0.1142) loss_oracle 0.2492 (0.2564) acc 87.5000 (80.5729) kd_loss 0.7904 (0.9054) lr 1.5358e-03 eta 0:11:09
epoch [18/50] batch [80/203] time 0.086 (0.097) data 0.000 (0.014) loss 1.6617 (1.6177) ce_loss 0.6113 (0.5218) loss_zs_kd 0.1205 (0.1157) loss_oracle 0.2337 (0.2563) acc 75.0000 (80.5078) kd_loss 0.8733 (0.9099) lr 1.5358e-03 eta 0:10:42
epoch [18/50] batch [100/203] time 0.132 (0.096) data 0.000 (0.011) loss 1.4940 (1.6035) ce_loss 0.4036 (0.5089) loss_zs_kd 0.0954 (0.1139) loss_oracle 0.3066 (0.2546) acc 75.0000 (81.0625) kd_loss 0.8894 (0.9104) lr 1.5358e-03 eta 0:10:32
epoch [18/50] batch [120/203] time 0.068 (0.098) data 0.000 (0.009) loss 1.6156 (1.6075) ce_loss 0.5161 (0.5156) loss_zs_kd 0.1154 (0.1143) loss_oracle 0.2461 (0.2511) acc 78.1250 (80.7552) kd_loss 0.9188 (0.9092) lr 1.5358e-03 eta 0:10:44
epoch [18/50] batch [140/203] time 0.164 (0.099) data 0.000 (0.008) loss 1.7108 (1.6079) ce_loss 0.7124 (0.5199) loss_zs_kd 0.1054 (0.1135) loss_oracle 0.2346 (0.2525) acc 65.6250 (80.4241) kd_loss 0.8284 (0.9049) lr 1.5358e-03 eta 0:10:51
epoch [18/50] batch [160/203] time 0.080 (0.100) data 0.000 (0.007) loss 1.5392 (1.6057) ce_loss 0.5049 (0.5195) loss_zs_kd 0.1645 (0.1141) loss_oracle 0.2678 (0.2548) acc 84.3750 (80.3906) kd_loss 0.8181 (0.9017) lr 1.5358e-03 eta 0:10:51
epoch [18/50] batch [180/203] time 0.084 (0.099) data 0.000 (0.006) loss 1.6777 (1.6046) ce_loss 0.5371 (0.5185) loss_zs_kd 0.1646 (0.1148) loss_oracle 0.2406 (0.2559) acc 71.8750 (80.6076) kd_loss 0.9380 (0.9007) lr 1.5358e-03 eta 0:10:45
epoch [18/50] batch [200/203] time 0.067 (0.096) data 0.000 (0.006) loss 1.5239 (1.6027) ce_loss 0.4565 (0.5186) loss_zs_kd 0.1207 (0.1158) loss_oracle 0.2656 (0.2570) acc 84.3750 (80.7188) kd_loss 0.8741 (0.8976) lr 1.5358e-03 eta 0:10:26
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,350
* accuracy: 84.1%
* error: 15.9%
* macro_f1: 87.6%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      84.5%, epoch: 12 *******
******* Domain c best val test acc: 100.0%, epoch: 12 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [19/50] batch [20/203] time 0.073 (0.164) data 0.000 (0.063) loss 1.7403 (1.5596) ce_loss 0.7227 (0.4946) loss_zs_kd 0.1627 (0.1203) loss_oracle 0.2650 (0.2849) acc 71.8750 (82.0312) kd_loss 0.8038 (0.8624) lr 1.4818e-03 eta 0:17:43
epoch [19/50] batch [40/203] time 0.078 (0.127) data 0.000 (0.032) loss 1.6044 (1.5506) ce_loss 0.5239 (0.4887) loss_zs_kd 0.1346 (0.1207) loss_oracle 0.3192 (0.2750) acc 81.2500 (82.1094) kd_loss 0.8536 (0.8641) lr 1.4818e-03 eta 0:13:39
epoch [19/50] batch [60/203] time 0.092 (0.122) data 0.001 (0.021) loss 1.6988 (1.5494) ce_loss 0.5483 (0.4868) loss_zs_kd 0.1575 (0.1204) loss_oracle 0.3074 (0.2699) acc 81.2500 (82.1354) kd_loss 0.9180 (0.8675) lr 1.4818e-03 eta 0:13:02
epoch [19/50] batch [80/203] time 0.083 (0.116) data 0.001 (0.016) loss 1.5740 (1.5584) ce_loss 0.5527 (0.4906) loss_zs_kd 0.1007 (0.1212) loss_oracle 0.2942 (0.2702) acc 81.2500 (82.3438) kd_loss 0.8238 (0.8721) lr 1.4818e-03 eta 0:12:24
epoch [19/50] batch [100/203] time 0.075 (0.110) data 0.000 (0.013) loss 1.5703 (1.5720) ce_loss 0.5273 (0.5026) loss_zs_kd 0.1321 (0.1214) loss_oracle 0.2744 (0.2757) acc 78.1250 (81.6562) kd_loss 0.8398 (0.8708) lr 1.4818e-03 eta 0:11:41
epoch [19/50] batch [120/203] time 0.100 (0.105) data 0.000 (0.011) loss 1.7275 (1.5696) ce_loss 0.6836 (0.5032) loss_zs_kd 0.1329 (0.1199) loss_oracle 0.3020 (0.2749) acc 78.1250 (81.5365) kd_loss 0.8264 (0.8690) lr 1.4818e-03 eta 0:11:11
epoch [19/50] batch [140/203] time 0.098 (0.104) data 0.000 (0.009) loss 1.5177 (1.5668) ce_loss 0.3989 (0.5038) loss_zs_kd 0.1558 (0.1188) loss_oracle 0.2071 (0.2734) acc 90.6250 (81.8080) kd_loss 0.9373 (0.8669) lr 1.4818e-03 eta 0:11:02
epoch [19/50] batch [160/203] time 0.097 (0.103) data 0.000 (0.008) loss 1.4988 (1.5662) ce_loss 0.3704 (0.5056) loss_zs_kd 0.1287 (0.1187) loss_oracle 0.2951 (0.2748) acc 84.3750 (81.6016) kd_loss 0.9165 (0.8639) lr 1.4818e-03 eta 0:10:54
epoch [19/50] batch [180/203] time 0.097 (0.103) data 0.000 (0.007) loss 1.6128 (1.5735) ce_loss 0.4990 (0.5102) loss_zs_kd 0.1059 (0.1187) loss_oracle 0.2877 (0.2781) acc 81.2500 (81.4931) kd_loss 0.9170 (0.8649) lr 1.4818e-03 eta 0:10:49
epoch [19/50] batch [200/203] time 0.092 (0.102) data 0.000 (0.007) loss 1.7510 (1.5766) ce_loss 0.6709 (0.5098) loss_zs_kd 0.0789 (0.1188) loss_oracle 0.3622 (0.2834) acc 78.1250 (81.3750) kd_loss 0.8596 (0.8657) lr 1.4818e-03 eta 0:10:41
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,361
* accuracy: 84.5%
* error: 15.5%
* macro_f1: 87.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      84.5%, epoch: 12 *******
******* Domain c best val test acc: 100.0%, epoch: 12 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [20/50] batch [20/203] time 0.106 (0.173) data 0.000 (0.071) loss 1.7053 (1.5286) ce_loss 0.6133 (0.4537) loss_zs_kd 0.0874 (0.1039) loss_oracle 0.3394 (0.3330) acc 78.1250 (84.0625) kd_loss 0.8787 (0.8565) lr 1.4258e-03 eta 0:18:04
epoch [20/50] batch [40/203] time 0.095 (0.136) data 0.000 (0.036) loss 1.5855 (1.5631) ce_loss 0.5161 (0.4884) loss_zs_kd 0.0955 (0.1096) loss_oracle 0.3195 (0.3398) acc 71.8750 (83.3594) kd_loss 0.8618 (0.8500) lr 1.4258e-03 eta 0:14:09
epoch [20/50] batch [60/203] time 0.101 (0.123) data 0.000 (0.024) loss 1.5149 (1.5663) ce_loss 0.4487 (0.4911) loss_zs_kd 0.1378 (0.1114) loss_oracle 0.3025 (0.3277) acc 84.3750 (83.0208) kd_loss 0.8460 (0.8557) lr 1.4258e-03 eta 0:12:48
epoch [20/50] batch [80/203] time 0.109 (0.117) data 0.001 (0.018) loss 1.3606 (1.5692) ce_loss 0.4177 (0.4924) loss_zs_kd 0.1665 (0.1150) loss_oracle 0.2640 (0.3259) acc 71.8750 (82.7734) kd_loss 0.7276 (0.8564) lr 1.4258e-03 eta 0:12:07
epoch [20/50] batch [100/203] time 0.092 (0.113) data 0.000 (0.014) loss 1.1994 (1.5647) ce_loss 0.2590 (0.4937) loss_zs_kd 0.0779 (0.1155) loss_oracle 0.2806 (0.3191) acc 90.6250 (82.1250) kd_loss 0.7611 (0.8536) lr 1.4258e-03 eta 0:11:40
epoch [20/50] batch [120/203] time 0.099 (0.111) data 0.000 (0.012) loss 1.2866 (1.5694) ce_loss 0.2430 (0.5029) loss_zs_kd 0.1218 (0.1178) loss_oracle 0.2820 (0.3088) acc 93.7500 (81.9271) kd_loss 0.8417 (0.8532) lr 1.4258e-03 eta 0:11:22
epoch [20/50] batch [140/203] time 0.085 (0.108) data 0.000 (0.010) loss 1.4793 (1.5733) ce_loss 0.4458 (0.5056) loss_zs_kd 0.1670 (0.1194) loss_oracle 0.2256 (0.3015) acc 84.3750 (81.7411) kd_loss 0.8371 (0.8572) lr 1.4258e-03 eta 0:11:02
epoch [20/50] batch [160/203] time 0.086 (0.105) data 0.000 (0.009) loss 1.3464 (1.5773) ce_loss 0.3982 (0.5125) loss_zs_kd 0.1020 (0.1197) loss_oracle 0.2269 (0.2961) acc 87.5000 (81.4062) kd_loss 0.7838 (0.8569) lr 1.4258e-03 eta 0:10:43
epoch [20/50] batch [180/203] time 0.070 (0.102) data 0.000 (0.008) loss 1.4554 (1.5758) ce_loss 0.4146 (0.5116) loss_zs_kd 0.0921 (0.1186) loss_oracle 0.2092 (0.2930) acc 87.5000 (81.4062) kd_loss 0.8901 (0.8584) lr 1.4258e-03 eta 0:10:21
epoch [20/50] batch [200/203] time 0.068 (0.098) data 0.000 (0.007) loss 1.7815 (1.5797) ce_loss 0.7612 (0.5140) loss_zs_kd 0.1248 (0.1184) loss_oracle 0.2951 (0.2932) acc 65.6250 (81.3438) kd_loss 0.8103 (0.8599) lr 1.4258e-03 eta 0:09:59
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,360
* accuracy: 84.4%
* error: 15.6%
* macro_f1: 87.6%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      84.5%, epoch: 12 *******
******* Domain c best val test acc: 100.0%, epoch: 12 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [21/50] batch [20/203] time 0.086 (0.146) data 0.000 (0.061) loss 1.3962 (1.5181) ce_loss 0.3088 (0.4567) loss_zs_kd 0.1241 (0.1281) loss_oracle 0.2871 (0.2901) acc 90.6250 (83.7500) kd_loss 0.8818 (0.8523) lr 1.3681e-03 eta 0:14:44
epoch [21/50] batch [40/203] time 0.144 (0.123) data 0.000 (0.031) loss 1.6403 (1.5348) ce_loss 0.5020 (0.4710) loss_zs_kd 0.1934 (0.1328) loss_oracle 0.2634 (0.2902) acc 71.8750 (82.1875) kd_loss 0.9099 (0.8523) lr 1.3681e-03 eta 0:12:23
epoch [21/50] batch [60/203] time 0.139 (0.118) data 0.001 (0.021) loss 1.5020 (1.5470) ce_loss 0.4568 (0.4889) loss_zs_kd 0.1073 (0.1295) loss_oracle 0.3781 (0.2946) acc 84.3750 (81.5104) kd_loss 0.8025 (0.8461) lr 1.3681e-03 eta 0:11:49
epoch [21/50] batch [80/203] time 0.153 (0.114) data 0.000 (0.016) loss 1.4079 (1.5464) ce_loss 0.3652 (0.4898) loss_zs_kd 0.1246 (0.1284) loss_oracle 0.2962 (0.2948) acc 87.5000 (81.4062) kd_loss 0.8322 (0.8450) lr 1.3681e-03 eta 0:11:27
epoch [21/50] batch [100/203] time 0.148 (0.112) data 0.000 (0.013) loss 1.7109 (1.5518) ce_loss 0.7231 (0.4973) loss_zs_kd 0.1167 (0.1280) loss_oracle 0.2876 (0.2957) acc 78.1250 (81.5625) kd_loss 0.7857 (0.8426) lr 1.3681e-03 eta 0:11:11
epoch [21/50] batch [120/203] time 0.078 (0.111) data 0.000 (0.010) loss 1.3523 (1.5542) ce_loss 0.2615 (0.4975) loss_zs_kd 0.1242 (0.1251) loss_oracle 0.2951 (0.2979) acc 93.7500 (81.4844) kd_loss 0.8811 (0.8453) lr 1.3681e-03 eta 0:11:05
epoch [21/50] batch [140/203] time 0.082 (0.112) data 0.000 (0.009) loss 1.4940 (1.5654) ce_loss 0.3743 (0.5059) loss_zs_kd 0.0969 (0.1241) loss_oracle 0.3500 (0.3023) acc 84.3750 (81.2500) kd_loss 0.8963 (0.8464) lr 1.3681e-03 eta 0:11:04
epoch [21/50] batch [160/203] time 0.077 (0.112) data 0.000 (0.008) loss 1.5243 (1.5670) ce_loss 0.3997 (0.5022) loss_zs_kd 0.1427 (0.1235) loss_oracle 0.3524 (0.3082) acc 90.6250 (81.3867) kd_loss 0.8771 (0.8489) lr 1.3681e-03 eta 0:11:02
epoch [21/50] batch [180/203] time 0.081 (0.109) data 0.000 (0.007) loss 1.5743 (1.5704) ce_loss 0.5698 (0.5033) loss_zs_kd 0.1025 (0.1239) loss_oracle 0.3162 (0.3100) acc 68.7500 (81.2674) kd_loss 0.7952 (0.8501) lr 1.3681e-03 eta 0:10:46
epoch [21/50] batch [200/203] time 0.066 (0.106) data 0.000 (0.006) loss 1.5663 (1.5721) ce_loss 0.4197 (0.5041) loss_zs_kd 0.0893 (0.1216) loss_oracle 0.3211 (0.3108) acc 84.3750 (81.0312) kd_loss 0.9415 (0.8518) lr 1.3681e-03 eta 0:10:23
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,360
* accuracy: 84.4%
* error: 15.6%
* macro_f1: 87.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      84.5%, epoch: 12 *******
******* Domain c best val test acc: 100.0%, epoch: 12 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [22/50] batch [20/203] time 0.100 (0.163) data 0.000 (0.065) loss 1.5889 (1.6044) ce_loss 0.4468 (0.5400) loss_zs_kd 0.1291 (0.1294) loss_oracle 0.3280 (0.3162) acc 90.6250 (80.3125) kd_loss 0.9136 (0.8416) lr 1.3090e-03 eta 0:15:58
epoch [22/50] batch [40/203] time 0.099 (0.130) data 0.000 (0.032) loss 1.6893 (1.6052) ce_loss 0.5215 (0.5301) loss_zs_kd 0.0981 (0.1225) loss_oracle 0.3484 (0.3255) acc 75.0000 (80.6250) kd_loss 0.9446 (0.8511) lr 1.3090e-03 eta 0:12:40
epoch [22/50] batch [60/203] time 0.095 (0.119) data 0.000 (0.022) loss 1.6567 (1.6139) ce_loss 0.5425 (0.5315) loss_zs_kd 0.1224 (0.1205) loss_oracle 0.2974 (0.3344) acc 87.5000 (80.5208) kd_loss 0.9043 (0.8549) lr 1.3090e-03 eta 0:11:34
epoch [22/50] batch [80/203] time 0.094 (0.114) data 0.000 (0.016) loss 1.7641 (1.6093) ce_loss 0.6455 (0.5202) loss_zs_kd 0.1250 (0.1224) loss_oracle 0.3958 (0.3402) acc 78.1250 (81.0938) kd_loss 0.8582 (0.8578) lr 1.3090e-03 eta 0:11:00
epoch [22/50] batch [100/203] time 0.093 (0.110) data 0.000 (0.013) loss 1.7023 (1.6076) ce_loss 0.6509 (0.5151) loss_zs_kd 0.1163 (0.1222) loss_oracle 0.4049 (0.3447) acc 71.8750 (80.8750) kd_loss 0.7908 (0.8591) lr 1.3090e-03 eta 0:10:36
epoch [22/50] batch [120/203] time 0.092 (0.108) data 0.000 (0.011) loss 1.6903 (1.6096) ce_loss 0.5103 (0.5118) loss_zs_kd 0.1110 (0.1201) loss_oracle 0.3884 (0.3490) acc 78.1250 (80.9896) kd_loss 0.9303 (0.8633) lr 1.3090e-03 eta 0:10:21
epoch [22/50] batch [140/203] time 0.102 (0.106) data 0.000 (0.009) loss 1.7355 (1.6171) ce_loss 0.6797 (0.5191) loss_zs_kd 0.1490 (0.1214) loss_oracle 0.3328 (0.3497) acc 87.5000 (80.9152) kd_loss 0.8149 (0.8625) lr 1.3090e-03 eta 0:10:10
epoch [22/50] batch [160/203] time 0.100 (0.105) data 0.000 (0.008) loss 1.3289 (1.6108) ce_loss 0.3201 (0.5151) loss_zs_kd 0.0954 (0.1196) loss_oracle 0.2965 (0.3486) acc 84.3750 (81.1523) kd_loss 0.8129 (0.8617) lr 1.3090e-03 eta 0:10:00
epoch [22/50] batch [180/203] time 0.100 (0.104) data 0.000 (0.007) loss 1.2797 (1.6098) ce_loss 0.2859 (0.5184) loss_zs_kd 0.0893 (0.1178) loss_oracle 0.3408 (0.3445) acc 90.6250 (81.0938) kd_loss 0.7788 (0.8603) lr 1.3090e-03 eta 0:09:54
epoch [22/50] batch [200/203] time 0.088 (0.103) data 0.000 (0.007) loss 1.6998 (1.6066) ce_loss 0.6226 (0.5171) loss_zs_kd 0.1973 (0.1173) loss_oracle 0.2766 (0.3416) acc 78.1250 (81.2188) kd_loss 0.8402 (0.8601) lr 1.3090e-03 eta 0:09:44
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,370
* accuracy: 84.8%
* error: 15.2%
* macro_f1: 88.0%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      84.8%, epoch: 22 *******
******* Domain c best val test acc: 100.0%, epoch: 22 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [23/50] batch [20/203] time 0.070 (0.147) data 0.000 (0.060) loss 1.6338 (1.5676) ce_loss 0.6201 (0.5116) loss_zs_kd 0.1154 (0.1094) loss_oracle 0.3165 (0.3338) acc 87.5000 (82.0312) kd_loss 0.7977 (0.8344) lr 1.2487e-03 eta 0:13:55
epoch [23/50] batch [40/203] time 0.085 (0.114) data 0.000 (0.030) loss 1.6660 (1.5914) ce_loss 0.5547 (0.5261) loss_zs_kd 0.1309 (0.1175) loss_oracle 0.3721 (0.3359) acc 84.3750 (80.7031) kd_loss 0.8598 (0.8386) lr 1.2487e-03 eta 0:10:45
epoch [23/50] batch [60/203] time 0.081 (0.107) data 0.000 (0.020) loss 1.5477 (1.5764) ce_loss 0.4050 (0.4994) loss_zs_kd 0.1454 (0.1230) loss_oracle 0.3489 (0.3373) acc 87.5000 (81.5104) kd_loss 0.8955 (0.8468) lr 1.2487e-03 eta 0:10:04
epoch [23/50] batch [80/203] time 0.084 (0.102) data 0.000 (0.015) loss 1.6321 (1.5843) ce_loss 0.5156 (0.5011) loss_zs_kd 0.1259 (0.1221) loss_oracle 0.3522 (0.3431) acc 87.5000 (81.6797) kd_loss 0.8775 (0.8506) lr 1.2487e-03 eta 0:09:29
epoch [23/50] batch [100/203] time 0.092 (0.098) data 0.000 (0.012) loss 1.6230 (1.5893) ce_loss 0.5229 (0.5094) loss_zs_kd 0.0968 (0.1205) loss_oracle 0.3391 (0.3389) acc 84.3750 (81.4688) kd_loss 0.8821 (0.8502) lr 1.2487e-03 eta 0:09:09
epoch [23/50] batch [120/203] time 0.083 (0.096) data 0.000 (0.010) loss 1.8117 (1.5920) ce_loss 0.6680 (0.5169) loss_zs_kd 0.1424 (0.1194) loss_oracle 0.3297 (0.3340) acc 81.2500 (81.3021) kd_loss 0.9077 (0.8483) lr 1.2487e-03 eta 0:08:53
epoch [23/50] batch [140/203] time 0.087 (0.095) data 0.000 (0.009) loss 1.6518 (1.5876) ce_loss 0.5444 (0.5151) loss_zs_kd 0.0887 (0.1184) loss_oracle 0.3446 (0.3315) acc 81.2500 (81.3393) kd_loss 0.8907 (0.8476) lr 1.2487e-03 eta 0:08:44
epoch [23/50] batch [160/203] time 0.084 (0.094) data 0.000 (0.008) loss 1.6698 (1.5861) ce_loss 0.7207 (0.5147) loss_zs_kd 0.1303 (0.1199) loss_oracle 0.2676 (0.3289) acc 68.7500 (81.4062) kd_loss 0.7501 (0.8470) lr 1.2487e-03 eta 0:08:36
epoch [23/50] batch [180/203] time 0.092 (0.093) data 0.000 (0.007) loss 1.5933 (1.5895) ce_loss 0.4172 (0.5149) loss_zs_kd 0.1296 (0.1199) loss_oracle 0.3081 (0.3284) acc 93.7500 (81.5451) kd_loss 0.9572 (0.8504) lr 1.2487e-03 eta 0:08:30
epoch [23/50] batch [200/203] time 0.067 (0.091) data 0.000 (0.006) loss 1.3683 (1.5890) ce_loss 0.4351 (0.5146) loss_zs_kd 0.0935 (0.1199) loss_oracle 0.2643 (0.3283) acc 78.1250 (81.4844) kd_loss 0.7543 (0.8502) lr 1.2487e-03 eta 0:08:19
Evaluate on the *val* set
