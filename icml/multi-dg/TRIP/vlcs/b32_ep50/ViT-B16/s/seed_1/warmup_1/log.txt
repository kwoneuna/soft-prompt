Loading trainer: TRIP
Loading dataset: SPG_VLCS
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  --------------------------------
Dataset    SPG_VLCS
Source     ['caltech', 'labelme', 'pascal']
Target     ['sun']
# classes  5
# train_x  5,213
# val      2,234
# test     3,282
---------  --------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/162] time 0.074 (0.117) data 0.000 (0.022) loss 1.0012 (0.6236) ce_loss 1.0000 (0.6217) loss_zs_kd 0.0004 (0.0001) loss_oracle -0.0001 (-0.0002) acc 65.6250 (78.9062) kd_loss 0.0011 (0.0019) lr 1.0000e-05 eta 0:15:44
epoch [1/50] batch [40/162] time 0.083 (0.099) data 0.000 (0.011) loss 0.9342 (0.6323) ce_loss 0.9321 (0.6306) loss_zs_kd 0.0019 (0.0007) loss_oracle -0.0002 (-0.0002) acc 68.7500 (78.9062) kd_loss 0.0012 (0.0014) lr 1.0000e-05 eta 0:13:14
epoch [1/50] batch [60/162] time 0.090 (0.092) data 0.000 (0.007) loss 0.5813 (0.6272) ce_loss 0.5762 (0.6250) loss_zs_kd 0.0057 (0.0018) loss_oracle -0.0002 (-0.0001) acc 84.3750 (78.6458) kd_loss 0.0024 (0.0014) lr 1.0000e-05 eta 0:12:22
epoch [1/50] batch [80/162] time 0.072 (0.090) data 0.000 (0.006) loss 0.6361 (0.6192) ce_loss 0.6304 (0.6163) loss_zs_kd 0.0088 (0.0032) loss_oracle -0.0001 (-0.0001) acc 75.0000 (78.9062) kd_loss 0.0013 (0.0013) lr 1.0000e-05 eta 0:11:58
epoch [1/50] batch [100/162] time 0.064 (0.086) data 0.000 (0.005) loss 0.4974 (0.6125) ce_loss 0.4932 (0.6090) loss_zs_kd 0.0069 (0.0045) loss_oracle -0.0002 (-0.0001) acc 84.3750 (79.2188) kd_loss 0.0009 (0.0013) lr 1.0000e-05 eta 0:11:31
epoch [1/50] batch [120/162] time 0.070 (0.083) data 0.000 (0.004) loss 0.8225 (0.5969) ce_loss 0.8174 (0.5929) loss_zs_kd 0.0072 (0.0054) loss_oracle -0.0002 (-0.0001) acc 65.6250 (79.5052) kd_loss 0.0016 (0.0013) lr 1.0000e-05 eta 0:11:02
epoch [1/50] batch [140/162] time 0.082 (0.081) data 0.001 (0.003) loss 0.3585 (0.5890) ce_loss 0.3499 (0.5845) loss_zs_kd 0.0148 (0.0063) loss_oracle -0.0001 (-0.0001) acc 87.5000 (79.9554) kd_loss 0.0013 (0.0014) lr 1.0000e-05 eta 0:10:46
epoch [1/50] batch [160/162] time 0.066 (0.080) data 0.000 (0.003) loss 0.3442 (0.5945) ce_loss 0.3354 (0.5894) loss_zs_kd 0.0135 (0.0074) loss_oracle -0.0001 (-0.0001) acc 84.3750 (79.6484) kd_loss 0.0021 (0.0015) lr 1.0000e-05 eta 0:10:38
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,900
* accuracy: 85.0%
* error: 15.0%
* macro_f1: 87.1%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,374
* accuracy: 72.3%
* error: 27.7%
* macro_f1: 67.0%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain s best val acc:      85.0%, epoch: 1 *******
******* Domain s best val test acc: 72.3%, epoch: 1 *******
******* Domain s best test acc:     72.3%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/ana
epoch [2/50] batch [20/162] time 0.116 (0.115) data 0.001 (0.020) loss 0.6551 (0.5945) ce_loss 0.6353 (0.5706) loss_zs_kd 0.0343 (0.0428) loss_oracle -0.0001 (-0.0001) acc 81.2500 (81.2500) kd_loss 0.0027 (0.0025) lr 2.0000e-03 eta 0:15:12
epoch [2/50] batch [40/162] time 0.092 (0.101) data 0.000 (0.010) loss 0.5309 (0.5599) ce_loss 0.4878 (0.5317) loss_zs_kd 0.0794 (0.0505) loss_oracle 0.0007 (0.0001) acc 78.1250 (82.1875) kd_loss 0.0030 (0.0028) lr 2.0000e-03 eta 0:13:15
epoch [2/50] batch [60/162] time 0.093 (0.099) data 0.000 (0.007) loss 0.5280 (0.5636) ce_loss 0.4612 (0.5331) loss_zs_kd 0.1169 (0.0526) loss_oracle 0.0021 (0.0006) acc 81.2500 (82.0312) kd_loss 0.0073 (0.0039) lr 2.0000e-03 eta 0:13:01
epoch [2/50] batch [80/162] time 0.107 (0.100) data 0.000 (0.005) loss 0.4544 (0.5496) ce_loss 0.3843 (0.5153) loss_zs_kd 0.0946 (0.0547) loss_oracle 0.0021 (0.0009) acc 84.3750 (82.5000) kd_loss 0.0218 (0.0064) lr 2.0000e-03 eta 0:13:06
epoch [2/50] batch [100/162] time 0.105 (0.101) data 0.001 (0.004) loss 0.5444 (0.5526) ce_loss 0.4714 (0.5131) loss_zs_kd 0.0976 (0.0585) loss_oracle 0.0199 (0.0033) acc 87.5000 (82.3125) kd_loss 0.0142 (0.0086) lr 2.0000e-03 eta 0:13:12
epoch [2/50] batch [120/162] time 0.103 (0.101) data 0.000 (0.003) loss 0.7270 (0.5592) ce_loss 0.5889 (0.5110) loss_zs_kd 0.0412 (0.0598) loss_oracle 0.0217 (0.0076) acc 81.2500 (82.0833) kd_loss 0.1066 (0.0145) lr 2.0000e-03 eta 0:13:08
epoch [2/50] batch [140/162] time 0.096 (0.101) data 0.000 (0.003) loss 0.6436 (0.5784) ce_loss 0.3584 (0.5032) loss_zs_kd 0.0727 (0.0610) loss_oracle 0.0171 (0.0100) acc 93.7500 (82.2768) kd_loss 0.2403 (0.0396) lr 2.0000e-03 eta 0:13:06
epoch [2/50] batch [160/162] time 0.086 (0.100) data 0.000 (0.003) loss 0.7778 (0.6096) ce_loss 0.3748 (0.5007) loss_zs_kd 0.1285 (0.0641) loss_oracle 0.0463 (0.0125) acc 87.5000 (82.1875) kd_loss 0.3157 (0.0706) lr 2.0000e-03 eta 0:12:58
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,950
* accuracy: 87.3%
* error: 12.7%
* macro_f1: 88.8%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,444
* accuracy: 74.5%
* error: 25.5%
* macro_f1: 73.1%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain s best val acc:      87.3%, epoch: 2 *******
******* Domain s best val test acc: 74.5%, epoch: 2 *******
******* Domain s best test acc:     74.5%, epoch: 2 *******
epoch [3/50] batch [20/162] time 0.084 (0.108) data 0.000 (0.017) loss 1.1637 (1.0663) ce_loss 0.4763 (0.4851) loss_zs_kd 0.0434 (0.0621) loss_oracle 0.0467 (0.0829) acc 84.3750 (81.7188) kd_loss 0.6423 (0.5086) lr 1.9980e-03 eta 0:13:58
epoch [3/50] batch [40/162] time 0.094 (0.100) data 0.000 (0.008) loss 1.4652 (1.1500) ce_loss 0.6328 (0.4943) loss_zs_kd 0.0608 (0.0678) loss_oracle 0.0424 (0.0633) acc 75.0000 (81.8750) kd_loss 0.7808 (0.5901) lr 1.9980e-03 eta 0:12:53
epoch [3/50] batch [60/162] time 0.107 (0.098) data 0.001 (0.006) loss 1.2936 (1.2246) ce_loss 0.3958 (0.5070) loss_zs_kd 0.0975 (0.0692) loss_oracle 0.0561 (0.0610) acc 84.3750 (81.8229) kd_loss 0.8211 (0.6525) lr 1.9980e-03 eta 0:12:39
epoch [3/50] batch [80/162] time 0.099 (0.098) data 0.000 (0.004) loss 1.2711 (1.2630) ce_loss 0.4365 (0.4972) loss_zs_kd 0.0573 (0.0693) loss_oracle 0.0148 (0.0544) acc 78.1250 (81.5234) kd_loss 0.7985 (0.7040) lr 1.9980e-03 eta 0:12:37
epoch [3/50] batch [100/162] time 0.092 (0.097) data 0.000 (0.004) loss 1.0838 (1.2853) ce_loss 0.2181 (0.4946) loss_zs_kd 0.0552 (0.0693) loss_oracle 0.0084 (0.0457) acc 93.7500 (81.9688) kd_loss 0.8338 (0.7332) lr 1.9980e-03 eta 0:12:27
epoch [3/50] batch [120/162] time 0.095 (0.097) data 0.000 (0.003) loss 1.3336 (1.2894) ce_loss 0.4646 (0.4864) loss_zs_kd 0.0899 (0.0716) loss_oracle 0.0149 (0.0402) acc 84.3750 (82.3698) kd_loss 0.8166 (0.7471) lr 1.9980e-03 eta 0:12:26
epoch [3/50] batch [140/162] time 0.107 (0.099) data 0.000 (0.003) loss 1.1272 (1.2859) ce_loss 0.3774 (0.4807) loss_zs_kd 0.0556 (0.0711) loss_oracle 0.0202 (0.0364) acc 87.5000 (82.3884) kd_loss 0.7118 (0.7514) lr 1.9980e-03 eta 0:12:34
epoch [3/50] batch [160/162] time 0.091 (0.098) data 0.000 (0.002) loss 1.0428 (1.2844) ce_loss 0.2683 (0.4769) loss_zs_kd 0.0603 (0.0703) loss_oracle 0.0169 (0.0344) acc 90.6250 (82.6758) kd_loss 0.7359 (0.7551) lr 1.9980e-03 eta 0:12:28
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,954
* accuracy: 87.5%
* error: 12.5%
* macro_f1: 89.2%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,532
* accuracy: 77.1%
* error: 22.9%
* macro_f1: 73.9%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain s best val acc:      87.5%, epoch: 3 *******
******* Domain s best val test acc: 77.1%, epoch: 3 *******
******* Domain s best test acc:     77.1%, epoch: 3 *******
epoch [4/50] batch [20/162] time 0.068 (0.125) data 0.000 (0.024) loss 1.3969 (1.2405) ce_loss 0.5952 (0.4411) loss_zs_kd 0.1215 (0.0746) loss_oracle 0.0121 (0.0146) acc 78.1250 (83.9062) kd_loss 0.7349 (0.7549) lr 1.9921e-03 eta 0:15:48
epoch [4/50] batch [40/162] time 0.135 (0.116) data 0.000 (0.012) loss 1.0703 (1.2179) ce_loss 0.4187 (0.4450) loss_zs_kd 0.0456 (0.0796) loss_oracle 0.0172 (0.0149) acc 87.5000 (84.6094) kd_loss 0.6202 (0.7256) lr 1.9921e-03 eta 0:14:38
epoch [4/50] batch [60/162] time 0.068 (0.110) data 0.000 (0.008) loss 1.0522 (1.2172) ce_loss 0.3533 (0.4590) loss_zs_kd 0.0536 (0.0734) loss_oracle 0.0182 (0.0175) acc 90.6250 (84.0625) kd_loss 0.6631 (0.7127) lr 1.9921e-03 eta 0:13:48
epoch [4/50] batch [80/162] time 0.123 (0.109) data 0.000 (0.006) loss 1.1278 (1.1902) ce_loss 0.4424 (0.4493) loss_zs_kd 0.0659 (0.0699) loss_oracle 0.0215 (0.0177) acc 81.2500 (84.2969) kd_loss 0.6417 (0.6971) lr 1.9921e-03 eta 0:13:43
epoch [4/50] batch [100/162] time 0.078 (0.104) data 0.000 (0.005) loss 1.0342 (1.1759) ce_loss 0.3975 (0.4575) loss_zs_kd 0.0621 (0.0750) loss_oracle 0.0224 (0.0215) acc 84.3750 (83.5312) kd_loss 0.5944 (0.6701) lr 1.9921e-03 eta 0:12:59
epoch [4/50] batch [120/162] time 0.080 (0.103) data 0.000 (0.004) loss 1.2735 (1.1521) ce_loss 0.7056 (0.4623) loss_zs_kd 0.0998 (0.0763) loss_oracle 0.0163 (0.0206) acc 71.8750 (83.2031) kd_loss 0.5099 (0.6413) lr 1.9921e-03 eta 0:12:48
epoch [4/50] batch [140/162] time 0.067 (0.104) data 0.000 (0.004) loss 1.0587 (1.1296) ce_loss 0.4399 (0.4624) loss_zs_kd 0.0381 (0.0754) loss_oracle 0.0202 (0.0202) acc 81.2500 (83.2143) kd_loss 0.5895 (0.6194) lr 1.9921e-03 eta 0:12:54
epoch [4/50] batch [160/162] time 0.133 (0.102) data 0.000 (0.003) loss 1.3156 (1.1222) ce_loss 0.8042 (0.4720) loss_zs_kd 0.0676 (0.0742) loss_oracle 0.0763 (0.0224) acc 75.0000 (82.6367) kd_loss 0.4395 (0.6018) lr 1.9921e-03 eta 0:12:43
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,917
* accuracy: 85.8%
* error: 14.2%
* macro_f1: 88.5%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,681
* accuracy: 81.7%
* error: 18.3%
* macro_f1: 75.2%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain s best val acc:      87.5%, epoch: 3 *******
******* Domain s best val test acc: 77.1%, epoch: 3 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [5/50] batch [20/162] time 0.083 (0.129) data 0.000 (0.023) loss 1.0295 (1.0104) ce_loss 0.5244 (0.5094) loss_zs_kd 0.0523 (0.0595) loss_oracle 0.0478 (0.0600) acc 81.2500 (80.7812) kd_loss 0.4551 (0.4412) lr 1.9823e-03 eta 0:15:58
epoch [5/50] batch [40/162] time 0.066 (0.107) data 0.000 (0.012) loss 0.9083 (0.9383) ce_loss 0.4514 (0.4478) loss_zs_kd 0.0535 (0.0700) loss_oracle 0.0257 (0.0456) acc 84.3750 (83.5156) kd_loss 0.4173 (0.4327) lr 1.9823e-03 eta 0:13:12
epoch [5/50] batch [60/162] time 0.093 (0.104) data 0.000 (0.008) loss 0.6810 (0.9319) ce_loss 0.2605 (0.4547) loss_zs_kd 0.0474 (0.0702) loss_oracle 0.0489 (0.0413) acc 90.6250 (83.6979) kd_loss 0.3724 (0.4214) lr 1.9823e-03 eta 0:12:47
epoch [5/50] batch [80/162] time 0.096 (0.100) data 0.000 (0.006) loss 1.1002 (0.9200) ce_loss 0.6143 (0.4532) loss_zs_kd 0.0826 (0.0730) loss_oracle 0.0361 (0.0433) acc 78.1250 (83.5156) kd_loss 0.4266 (0.4086) lr 1.9823e-03 eta 0:12:19
epoch [5/50] batch [100/162] time 0.099 (0.097) data 0.000 (0.005) loss 0.9533 (0.9169) ce_loss 0.4888 (0.4553) loss_zs_kd 0.1090 (0.0744) loss_oracle 0.0715 (0.0447) acc 81.2500 (83.0312) kd_loss 0.3742 (0.4021) lr 1.9823e-03 eta 0:11:52
epoch [5/50] batch [120/162] time 0.076 (0.095) data 0.000 (0.004) loss 1.0024 (0.9115) ce_loss 0.6147 (0.4560) loss_zs_kd 0.0737 (0.0744) loss_oracle 0.0401 (0.0448) acc 84.3750 (83.0990) kd_loss 0.3307 (0.3959) lr 1.9823e-03 eta 0:11:35
epoch [5/50] batch [140/162] time 0.090 (0.094) data 0.000 (0.004) loss 0.6474 (0.9126) ce_loss 0.2539 (0.4582) loss_zs_kd 0.0637 (0.0751) loss_oracle 0.0194 (0.0434) acc 87.5000 (83.2812) kd_loss 0.3519 (0.3952) lr 1.9823e-03 eta 0:11:25
epoch [5/50] batch [160/162] time 0.075 (0.093) data 0.000 (0.003) loss 0.6994 (0.9095) ce_loss 0.3093 (0.4570) loss_zs_kd 0.0367 (0.0749) loss_oracle 0.0431 (0.0411) acc 93.7500 (83.3008) kd_loss 0.3502 (0.3944) lr 1.9823e-03 eta 0:11:15
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,952
* accuracy: 87.4%
* error: 12.6%
* macro_f1: 89.0%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,533
* accuracy: 77.2%
* error: 22.8%
* macro_f1: 73.6%
******* Domain s best val acc:      87.5%, epoch: 3 *******
******* Domain s best val test acc: 77.1%, epoch: 3 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [6/50] batch [20/162] time 0.096 (0.124) data 0.000 (0.025) loss 1.0061 (0.9838) ce_loss 0.5352 (0.4970) loss_zs_kd 0.0539 (0.0633) loss_oracle 0.0567 (0.0360) acc 84.3750 (80.9375) kd_loss 0.4156 (0.4371) lr 1.9686e-03 eta 0:15:00
epoch [6/50] batch [40/162] time 0.099 (0.109) data 0.000 (0.013) loss 0.7821 (0.9343) ce_loss 0.3040 (0.4455) loss_zs_kd 0.0624 (0.0654) loss_oracle 0.0399 (0.0376) acc 87.5000 (82.8906) kd_loss 0.4270 (0.4372) lr 1.9686e-03 eta 0:13:09
epoch [6/50] batch [60/162] time 0.091 (0.103) data 0.000 (0.008) loss 0.9119 (0.9570) ce_loss 0.3745 (0.4479) loss_zs_kd 0.0528 (0.0671) loss_oracle 0.0527 (0.0413) acc 90.6250 (82.7604) kd_loss 0.4847 (0.4549) lr 1.9686e-03 eta 0:12:23
epoch [6/50] batch [80/162] time 0.109 (0.100) data 0.000 (0.006) loss 0.8729 (0.9631) ce_loss 0.3994 (0.4500) loss_zs_kd 0.0588 (0.0694) loss_oracle 0.0747 (0.0487) acc 87.5000 (83.2031) kd_loss 0.4067 (0.4541) lr 1.9686e-03 eta 0:12:00
epoch [6/50] batch [100/162] time 0.094 (0.100) data 0.000 (0.005) loss 0.9208 (0.9591) ce_loss 0.3611 (0.4459) loss_zs_kd 0.1062 (0.0706) loss_oracle 0.0796 (0.0526) acc 81.2500 (83.2188) kd_loss 0.4668 (0.4516) lr 1.9686e-03 eta 0:11:57
epoch [6/50] batch [120/162] time 0.087 (0.099) data 0.000 (0.004) loss 0.9002 (0.9644) ce_loss 0.3628 (0.4499) loss_zs_kd 0.0517 (0.0751) loss_oracle 0.0887 (0.0557) acc 87.5000 (83.2292) kd_loss 0.4672 (0.4491) lr 1.9686e-03 eta 0:11:52
epoch [6/50] batch [140/162] time 0.123 (0.100) data 0.001 (0.004) loss 1.5150 (0.9746) ce_loss 0.9380 (0.4544) loss_zs_kd 0.0856 (0.0756) loss_oracle 0.1240 (0.0626) acc 71.8750 (83.0804) kd_loss 0.4722 (0.4511) lr 1.9686e-03 eta 0:11:55
epoch [6/50] batch [160/162] time 0.108 (0.100) data 0.000 (0.003) loss 1.0184 (0.9797) ce_loss 0.4653 (0.4588) loss_zs_kd 0.1169 (0.0774) loss_oracle 0.0712 (0.0647) acc 81.2500 (82.9297) kd_loss 0.4590 (0.4499) lr 1.9686e-03 eta 0:11:55
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,947
* accuracy: 87.2%
* error: 12.8%
* macro_f1: 88.9%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,527
* accuracy: 77.0%
* error: 23.0%
* macro_f1: 75.2%
******* Domain s best val acc:      87.5%, epoch: 3 *******
******* Domain s best val test acc: 77.1%, epoch: 3 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [7/50] batch [20/162] time 0.156 (0.134) data 0.000 (0.025) loss 1.1446 (0.9349) ce_loss 0.5654 (0.4184) loss_zs_kd 0.0875 (0.0636) loss_oracle 0.0739 (0.0576) acc 78.1250 (84.2188) kd_loss 0.4984 (0.4558) lr 1.9511e-03 eta 0:15:51
epoch [7/50] batch [40/162] time 0.070 (0.111) data 0.000 (0.013) loss 0.7285 (0.9437) ce_loss 0.2671 (0.4308) loss_zs_kd 0.0473 (0.0676) loss_oracle 0.0819 (0.0639) acc 90.6250 (83.7500) kd_loss 0.3968 (0.4472) lr 1.9511e-03 eta 0:13:04
epoch [7/50] batch [60/162] time 0.118 (0.106) data 0.000 (0.009) loss 1.1628 (0.9632) ce_loss 0.6904 (0.4549) loss_zs_kd 0.0958 (0.0701) loss_oracle 0.0847 (0.0658) acc 71.8750 (83.0208) kd_loss 0.3821 (0.4403) lr 1.9511e-03 eta 0:12:30
epoch [7/50] batch [80/162] time 0.081 (0.098) data 0.000 (0.006) loss 0.9676 (0.9616) ce_loss 0.5513 (0.4544) loss_zs_kd 0.0831 (0.0705) loss_oracle 0.0980 (0.0704) acc 75.0000 (83.1641) kd_loss 0.3258 (0.4368) lr 1.9511e-03 eta 0:11:31
epoch [7/50] batch [100/162] time 0.064 (0.097) data 0.000 (0.005) loss 0.9213 (0.9505) ce_loss 0.5054 (0.4455) loss_zs_kd 0.0949 (0.0713) loss_oracle 0.0420 (0.0724) acc 71.8750 (83.4688) kd_loss 0.3475 (0.4331) lr 1.9511e-03 eta 0:11:24
epoch [7/50] batch [120/162] time 0.075 (0.098) data 0.000 (0.004) loss 1.1006 (0.9541) ce_loss 0.5986 (0.4492) loss_zs_kd 0.1074 (0.0756) loss_oracle 0.0772 (0.0709) acc 78.1250 (83.3854) kd_loss 0.4097 (0.4316) lr 1.9511e-03 eta 0:11:30
epoch [7/50] batch [140/162] time 0.072 (0.099) data 0.000 (0.004) loss 0.9114 (0.9554) ce_loss 0.3691 (0.4500) loss_zs_kd 0.1094 (0.0763) loss_oracle 0.0801 (0.0707) acc 81.2500 (83.3705) kd_loss 0.4475 (0.4319) lr 1.9511e-03 eta 0:11:34
epoch [7/50] batch [160/162] time 0.111 (0.098) data 0.000 (0.003) loss 0.9209 (0.9571) ce_loss 0.3613 (0.4494) loss_zs_kd 0.0909 (0.0766) loss_oracle 0.1017 (0.0725) acc 87.5000 (83.3398) kd_loss 0.4632 (0.4332) lr 1.9511e-03 eta 0:11:25
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,956
* accuracy: 87.6%
* error: 12.4%
* macro_f1: 89.3%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,475
* accuracy: 75.4%
* error: 24.6%
* macro_f1: 72.8%
******* Domain s best val acc:      87.6%, epoch: 7 *******
******* Domain s best val test acc: 75.4%, epoch: 7 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [8/50] batch [20/162] time 0.101 (0.123) data 0.000 (0.026) loss 0.9969 (0.9891) ce_loss 0.4653 (0.4574) loss_zs_kd 0.0411 (0.0746) loss_oracle 0.1267 (0.0910) acc 81.2500 (81.7188) kd_loss 0.4477 (0.4489) lr 1.9298e-03 eta 0:14:11
epoch [8/50] batch [40/162] time 0.087 (0.107) data 0.000 (0.013) loss 1.1288 (1.0049) ce_loss 0.5908 (0.4798) loss_zs_kd 0.1077 (0.0891) loss_oracle 0.1078 (0.0834) acc 78.1250 (81.6406) kd_loss 0.4302 (0.4388) lr 1.9298e-03 eta 0:12:22
epoch [8/50] batch [60/162] time 0.109 (0.105) data 0.000 (0.009) loss 1.0818 (0.9798) ce_loss 0.5742 (0.4522) loss_zs_kd 0.0783 (0.0862) loss_oracle 0.0772 (0.0815) acc 75.0000 (82.3438) kd_loss 0.4298 (0.4437) lr 1.9298e-03 eta 0:12:04
epoch [8/50] batch [80/162] time 0.094 (0.105) data 0.000 (0.007) loss 1.3378 (0.9859) ce_loss 0.7842 (0.4517) loss_zs_kd 0.0622 (0.0818) loss_oracle 0.0990 (0.0842) acc 78.1250 (82.7344) kd_loss 0.4730 (0.4513) lr 1.9298e-03 eta 0:12:01
epoch [8/50] batch [100/162] time 0.108 (0.102) data 0.000 (0.005) loss 1.2020 (0.9924) ce_loss 0.6333 (0.4514) loss_zs_kd 0.0809 (0.0816) loss_oracle 0.1260 (0.0872) acc 75.0000 (83.0000) kd_loss 0.4653 (0.4565) lr 1.9298e-03 eta 0:11:40
epoch [8/50] batch [120/162] time 0.095 (0.101) data 0.000 (0.005) loss 1.3431 (1.0035) ce_loss 0.7344 (0.4552) loss_zs_kd 0.1012 (0.0819) loss_oracle 0.1318 (0.0903) acc 75.0000 (82.8906) kd_loss 0.4922 (0.4622) lr 1.9298e-03 eta 0:11:29
epoch [8/50] batch [140/162] time 0.094 (0.100) data 0.000 (0.004) loss 0.9657 (1.0059) ce_loss 0.4136 (0.4546) loss_zs_kd 0.0503 (0.0802) loss_oracle 0.1201 (0.0942) acc 87.5000 (82.8571) kd_loss 0.4670 (0.4641) lr 1.9298e-03 eta 0:11:25
epoch [8/50] batch [160/162] time 0.088 (0.099) data 0.000 (0.003) loss 1.2838 (1.0039) ce_loss 0.6372 (0.4490) loss_zs_kd 0.0634 (0.0813) loss_oracle 0.0924 (0.0964) acc 71.8750 (82.9297) kd_loss 0.5687 (0.4661) lr 1.9298e-03 eta 0:11:17
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,960
* accuracy: 87.7%
* error: 12.3%
* macro_f1: 89.8%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,619
* accuracy: 79.8%
* error: 20.2%
* macro_f1: 76.2%
******* Domain s best val acc:      87.7%, epoch: 8 *******
******* Domain s best val test acc: 79.8%, epoch: 8 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [9/50] batch [20/162] time 0.083 (0.119) data 0.000 (0.029) loss 1.2076 (1.0543) ce_loss 0.5962 (0.4809) loss_zs_kd 0.1295 (0.0850) loss_oracle 0.0928 (0.0966) acc 84.3750 (81.5625) kd_loss 0.5003 (0.4826) lr 1.9048e-03 eta 0:13:24
epoch [9/50] batch [40/162] time 0.096 (0.105) data 0.000 (0.015) loss 0.9916 (1.0320) ce_loss 0.4570 (0.4598) loss_zs_kd 0.0592 (0.0863) loss_oracle 0.0871 (0.0930) acc 84.3750 (82.8906) kd_loss 0.4614 (0.4825) lr 1.9048e-03 eta 0:11:48
epoch [9/50] batch [60/162] time 0.085 (0.101) data 0.000 (0.010) loss 0.9988 (1.0167) ce_loss 0.4236 (0.4530) loss_zs_kd 0.0750 (0.0829) loss_oracle 0.0988 (0.0855) acc 90.6250 (83.2292) kd_loss 0.4883 (0.4795) lr 1.9048e-03 eta 0:11:23
epoch [9/50] batch [80/162] time 0.092 (0.099) data 0.000 (0.007) loss 1.1249 (1.0184) ce_loss 0.5776 (0.4566) loss_zs_kd 0.0618 (0.0821) loss_oracle 0.1494 (0.0891) acc 78.1250 (83.1250) kd_loss 0.4417 (0.4761) lr 1.9048e-03 eta 0:11:04
epoch [9/50] batch [100/162] time 0.067 (0.097) data 0.000 (0.006) loss 0.8698 (1.0188) ce_loss 0.3481 (0.4540) loss_zs_kd 0.0651 (0.0822) loss_oracle 0.0992 (0.0928) acc 81.2500 (82.9688) kd_loss 0.4395 (0.4774) lr 1.9048e-03 eta 0:10:51
epoch [9/50] batch [120/162] time 0.093 (0.096) data 0.000 (0.005) loss 0.8778 (1.0218) ce_loss 0.3516 (0.4509) loss_zs_kd 0.0484 (0.0834) loss_oracle 0.1403 (0.0963) acc 90.6250 (83.2292) kd_loss 0.4319 (0.4811) lr 1.9048e-03 eta 0:10:40
epoch [9/50] batch [140/162] time 0.089 (0.095) data 0.000 (0.004) loss 0.9803 (1.0256) ce_loss 0.3738 (0.4493) loss_zs_kd 0.0634 (0.0844) loss_oracle 0.1377 (0.1007) acc 81.2500 (83.4598) kd_loss 0.5060 (0.4837) lr 1.9048e-03 eta 0:10:34
epoch [9/50] batch [160/162] time 0.062 (0.092) data 0.000 (0.004) loss 1.1587 (1.0256) ce_loss 0.5488 (0.4457) loss_zs_kd 0.0958 (0.0851) loss_oracle 0.0659 (0.1019) acc 71.8750 (83.4961) kd_loss 0.5290 (0.4864) lr 1.9048e-03 eta 0:10:13
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,961
* accuracy: 87.8%
* error: 12.2%
* macro_f1: 89.8%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,620
* accuracy: 79.8%
* error: 20.2%
* macro_f1: 76.4%
******* Domain s best val acc:      87.8%, epoch: 9 *******
******* Domain s best val test acc: 79.8%, epoch: 9 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [10/50] batch [20/162] time 0.068 (0.127) data 0.000 (0.029) loss 1.3256 (1.0530) ce_loss 0.7583 (0.4812) loss_zs_kd 0.1017 (0.0993) loss_oracle 0.0951 (0.0892) acc 62.5000 (81.0938) kd_loss 0.4689 (0.4776) lr 1.8763e-03 eta 0:13:57
epoch [10/50] batch [40/162] time 0.078 (0.107) data 0.000 (0.015) loss 0.9875 (1.0334) ce_loss 0.3933 (0.4592) loss_zs_kd 0.0697 (0.0930) loss_oracle 0.0915 (0.0922) acc 81.2500 (82.3438) kd_loss 0.5135 (0.4816) lr 1.8763e-03 eta 0:11:46
epoch [10/50] batch [60/162] time 0.082 (0.104) data 0.000 (0.010) loss 1.0041 (1.0237) ce_loss 0.4802 (0.4452) loss_zs_kd 0.0814 (0.0903) loss_oracle 0.1058 (0.0965) acc 78.1250 (83.2292) kd_loss 0.4303 (0.4851) lr 1.8763e-03 eta 0:11:26
epoch [10/50] batch [80/162] time 0.085 (0.108) data 0.000 (0.008) loss 0.9532 (1.0281) ce_loss 0.3225 (0.4453) loss_zs_kd 0.1147 (0.0857) loss_oracle 0.1074 (0.0991) acc 87.5000 (83.1641) kd_loss 0.5196 (0.4904) lr 1.8763e-03 eta 0:11:51
epoch [10/50] batch [100/162] time 0.086 (0.110) data 0.000 (0.006) loss 1.2856 (1.0281) ce_loss 0.6514 (0.4477) loss_zs_kd 0.0998 (0.0862) loss_oracle 0.0785 (0.0950) acc 78.1250 (83.1250) kd_loss 0.5451 (0.4897) lr 1.8763e-03 eta 0:11:57
epoch [10/50] batch [120/162] time 0.075 (0.108) data 0.000 (0.005) loss 1.1457 (1.0308) ce_loss 0.5928 (0.4481) loss_zs_kd 0.0803 (0.0883) loss_oracle 0.0671 (0.0927) acc 71.8750 (83.4115) kd_loss 0.4792 (0.4921) lr 1.8763e-03 eta 0:11:43
epoch [10/50] batch [140/162] time 0.102 (0.105) data 0.000 (0.004) loss 1.1305 (1.0335) ce_loss 0.5479 (0.4497) loss_zs_kd 0.0907 (0.0862) loss_oracle 0.0792 (0.0893) acc 78.1250 (83.3929) kd_loss 0.4977 (0.4960) lr 1.8763e-03 eta 0:11:22
epoch [10/50] batch [160/162] time 0.091 (0.103) data 0.000 (0.004) loss 0.9153 (1.0265) ce_loss 0.3923 (0.4466) loss_zs_kd 0.1072 (0.0858) loss_oracle 0.0639 (0.0860) acc 78.1250 (83.4180) kd_loss 0.4374 (0.4940) lr 1.8763e-03 eta 0:11:09
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,961
* accuracy: 87.8%
* error: 12.2%
* macro_f1: 89.7%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,557
* accuracy: 77.9%
* error: 22.1%
* macro_f1: 74.8%
******* Domain s best val acc:      87.8%, epoch: 9 *******
******* Domain s best val test acc: 79.8%, epoch: 9 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [11/50] batch [20/162] time 0.103 (0.135) data 0.000 (0.037) loss 0.9802 (0.9670) ce_loss 0.2795 (0.3835) loss_zs_kd 0.1018 (0.0863) loss_oracle 0.0677 (0.0571) acc 93.7500 (87.0312) kd_loss 0.6159 (0.5118) lr 1.8443e-03 eta 0:14:33
epoch [11/50] batch [40/162] time 0.104 (0.117) data 0.001 (0.019) loss 0.9258 (0.9729) ce_loss 0.2622 (0.3878) loss_zs_kd 0.1176 (0.0913) loss_oracle 0.0536 (0.0582) acc 96.8750 (86.1719) kd_loss 0.5780 (0.5104) lr 1.8443e-03 eta 0:12:36
epoch [11/50] batch [60/162] time 0.093 (0.111) data 0.000 (0.012) loss 1.0927 (0.9958) ce_loss 0.4949 (0.4055) loss_zs_kd 0.1159 (0.0901) loss_oracle 0.0594 (0.0607) acc 84.3750 (85.6771) kd_loss 0.5101 (0.5149) lr 1.8443e-03 eta 0:11:55
epoch [11/50] batch [80/162] time 0.092 (0.108) data 0.000 (0.009) loss 1.0814 (1.0173) ce_loss 0.3267 (0.4153) loss_zs_kd 0.0985 (0.0898) loss_oracle 0.0892 (0.0649) acc 90.6250 (85.2734) kd_loss 0.6608 (0.5246) lr 1.8443e-03 eta 0:11:30
epoch [11/50] batch [100/162] time 0.097 (0.106) data 0.000 (0.008) loss 1.0838 (1.0329) ce_loss 0.4531 (0.4312) loss_zs_kd 0.0540 (0.0863) loss_oracle 0.1139 (0.0681) acc 81.2500 (84.6250) kd_loss 0.5468 (0.5245) lr 1.8443e-03 eta 0:11:16
epoch [11/50] batch [120/162] time 0.097 (0.105) data 0.000 (0.006) loss 0.9217 (1.0341) ce_loss 0.2688 (0.4311) loss_zs_kd 0.0797 (0.0845) loss_oracle 0.0955 (0.0721) acc 87.5000 (84.5833) kd_loss 0.5653 (0.5247) lr 1.8443e-03 eta 0:11:04
epoch [11/50] batch [140/162] time 0.097 (0.104) data 0.000 (0.005) loss 0.9381 (1.0424) ce_loss 0.3237 (0.4340) loss_zs_kd 0.0669 (0.0863) loss_oracle 0.0776 (0.0736) acc 93.7500 (84.3973) kd_loss 0.5421 (0.5285) lr 1.8443e-03 eta 0:10:57
epoch [11/50] batch [160/162] time 0.090 (0.102) data 0.000 (0.005) loss 0.8355 (1.0461) ce_loss 0.2233 (0.4352) loss_zs_kd 0.0873 (0.0842) loss_oracle 0.0641 (0.0745) acc 93.7500 (84.2773) kd_loss 0.5366 (0.5315) lr 1.8443e-03 eta 0:10:45
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,955
* accuracy: 87.5%
* error: 12.5%
* macro_f1: 89.3%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,519
* accuracy: 76.8%
* error: 23.2%
* macro_f1: 73.5%
******* Domain s best val acc:      87.8%, epoch: 9 *******
******* Domain s best val test acc: 79.8%, epoch: 9 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [12/50] batch [20/162] time 0.087 (0.131) data 0.000 (0.038) loss 0.9956 (1.1072) ce_loss 0.3904 (0.4697) loss_zs_kd 0.0548 (0.0886) loss_oracle 0.0825 (0.0911) acc 84.3750 (82.0312) kd_loss 0.5365 (0.5477) lr 1.8090e-03 eta 0:13:46
epoch [12/50] batch [40/162] time 0.109 (0.114) data 0.000 (0.019) loss 1.0880 (1.1130) ce_loss 0.4504 (0.4719) loss_zs_kd 0.1105 (0.0945) loss_oracle 0.0786 (0.1009) acc 78.1250 (81.9531) kd_loss 0.5431 (0.5433) lr 1.8090e-03 eta 0:11:57
epoch [12/50] batch [60/162] time 0.098 (0.106) data 0.000 (0.013) loss 1.3333 (1.1056) ce_loss 0.6709 (0.4663) loss_zs_kd 0.1099 (0.0973) loss_oracle 0.1145 (0.0982) acc 71.8750 (82.4479) kd_loss 0.5502 (0.5415) lr 1.8090e-03 eta 0:11:00
epoch [12/50] batch [80/162] time 0.070 (0.100) data 0.000 (0.010) loss 0.9330 (1.0907) ce_loss 0.4211 (0.4583) loss_zs_kd 0.0789 (0.0925) loss_oracle 0.0638 (0.0931) acc 84.3750 (83.0078) kd_loss 0.4405 (0.5395) lr 1.8090e-03 eta 0:10:22
epoch [12/50] batch [100/162] time 0.065 (0.092) data 0.000 (0.008) loss 1.0681 (1.0885) ce_loss 0.4392 (0.4593) loss_zs_kd 0.0994 (0.0902) loss_oracle 0.0848 (0.0897) acc 84.3750 (83.0625) kd_loss 0.5368 (0.5393) lr 1.8090e-03 eta 0:09:33
epoch [12/50] batch [120/162] time 0.088 (0.092) data 0.000 (0.007) loss 0.9466 (1.0780) ce_loss 0.3618 (0.4498) loss_zs_kd 0.0429 (0.0882) loss_oracle 0.0700 (0.0884) acc 84.3750 (83.6198) kd_loss 0.5283 (0.5399) lr 1.8090e-03 eta 0:09:29
epoch [12/50] batch [140/162] time 0.072 (0.091) data 0.000 (0.006) loss 0.9948 (1.0819) ce_loss 0.3469 (0.4514) loss_zs_kd 0.0801 (0.0882) loss_oracle 0.1092 (0.0890) acc 84.3750 (83.4821) kd_loss 0.5533 (0.5419) lr 1.8090e-03 eta 0:09:19
epoch [12/50] batch [160/162] time 0.066 (0.089) data 0.000 (0.005) loss 1.2883 (1.0728) ce_loss 0.6797 (0.4421) loss_zs_kd 0.1102 (0.0885) loss_oracle 0.1118 (0.0912) acc 75.0000 (83.8672) kd_loss 0.4976 (0.5408) lr 1.8090e-03 eta 0:09:09
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,963
* accuracy: 87.9%
* error: 12.1%
* macro_f1: 89.6%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,539
* accuracy: 77.4%
* error: 22.6%
* macro_f1: 73.9%
******* Domain s best val acc:      87.9%, epoch: 12 *******
******* Domain s best val test acc: 77.4%, epoch: 12 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [13/50] batch [20/162] time 0.070 (0.147) data 0.000 (0.042) loss 1.0064 (1.0705) ce_loss 0.4028 (0.4548) loss_zs_kd 0.0813 (0.0790) loss_oracle 0.1104 (0.1157) acc 90.6250 (83.4375) kd_loss 0.5076 (0.5184) lr 1.7705e-03 eta 0:15:00
epoch [13/50] batch [40/162] time 0.071 (0.126) data 0.000 (0.021) loss 1.2349 (1.0995) ce_loss 0.5337 (0.4552) loss_zs_kd 0.1090 (0.0824) loss_oracle 0.1670 (0.1413) acc 81.2500 (83.9062) kd_loss 0.5632 (0.5325) lr 1.7705e-03 eta 0:12:49
epoch [13/50] batch [60/162] time 0.088 (0.117) data 0.000 (0.014) loss 1.1492 (1.0910) ce_loss 0.5464 (0.4420) loss_zs_kd 0.0909 (0.0822) loss_oracle 0.1198 (0.1435) acc 84.3750 (84.3229) kd_loss 0.4974 (0.5361) lr 1.7705e-03 eta 0:11:55
epoch [13/50] batch [80/162] time 0.094 (0.110) data 0.001 (0.011) loss 1.4883 (1.0999) ce_loss 0.9092 (0.4513) loss_zs_kd 0.0885 (0.0835) loss_oracle 0.0950 (0.1387) acc 75.0000 (83.8281) kd_loss 0.4874 (0.5375) lr 1.7705e-03 eta 0:11:06
epoch [13/50] batch [100/162] time 0.092 (0.105) data 0.000 (0.009) loss 0.9149 (1.0908) ce_loss 0.3071 (0.4404) loss_zs_kd 0.1027 (0.0834) loss_oracle 0.1083 (0.1340) acc 90.6250 (84.0938) kd_loss 0.5023 (0.5416) lr 1.7705e-03 eta 0:10:35
epoch [13/50] batch [120/162] time 0.109 (0.104) data 0.000 (0.007) loss 0.9950 (1.0860) ce_loss 0.4167 (0.4411) loss_zs_kd 0.0591 (0.0818) loss_oracle 0.0958 (0.1286) acc 81.2500 (83.8542) kd_loss 0.5008 (0.5397) lr 1.7705e-03 eta 0:10:25
epoch [13/50] batch [140/162] time 0.080 (0.100) data 0.000 (0.006) loss 0.9010 (1.0800) ce_loss 0.3230 (0.4371) loss_zs_kd 0.1107 (0.0844) loss_oracle 0.1345 (0.1256) acc 87.5000 (84.2188) kd_loss 0.4554 (0.5379) lr 1.7705e-03 eta 0:10:03
epoch [13/50] batch [160/162] time 0.068 (0.097) data 0.000 (0.005) loss 0.8963 (1.0797) ce_loss 0.2720 (0.4378) loss_zs_kd 0.0747 (0.0852) loss_oracle 0.1050 (0.1245) acc 93.7500 (84.0625) kd_loss 0.5345 (0.5372) lr 1.7705e-03 eta 0:09:41
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,970
* accuracy: 88.2%
* error: 11.8%
* macro_f1: 90.0%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,602
* accuracy: 79.3%
* error: 20.7%
* macro_f1: 75.4%
******* Domain s best val acc:      88.2%, epoch: 13 *******
******* Domain s best val test acc: 79.3%, epoch: 13 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [14/50] batch [20/162] time 0.093 (0.139) data 0.000 (0.042) loss 1.1106 (1.0598) ce_loss 0.5332 (0.4294) loss_zs_kd 0.0684 (0.0983) loss_oracle 0.1037 (0.1139) acc 84.3750 (83.9062) kd_loss 0.4913 (0.5243) lr 1.7290e-03 eta 0:13:53
epoch [14/50] batch [40/162] time 0.095 (0.118) data 0.000 (0.021) loss 1.0989 (1.0607) ce_loss 0.4714 (0.4378) loss_zs_kd 0.0645 (0.0839) loss_oracle 0.1523 (0.1217) acc 81.2500 (83.4375) kd_loss 0.5190 (0.5201) lr 1.7290e-03 eta 0:11:43
epoch [14/50] batch [60/162] time 0.098 (0.110) data 0.000 (0.014) loss 1.1325 (1.0680) ce_loss 0.4338 (0.4390) loss_zs_kd 0.1073 (0.0883) loss_oracle 0.0913 (0.1224) acc 81.2500 (83.3854) kd_loss 0.5993 (0.5236) lr 1.7290e-03 eta 0:10:51
epoch [14/50] batch [80/162] time 0.095 (0.107) data 0.000 (0.011) loss 0.9694 (1.0750) ce_loss 0.4141 (0.4491) loss_zs_kd 0.0676 (0.0869) loss_oracle 0.1401 (0.1236) acc 90.6250 (83.3594) kd_loss 0.4514 (0.5207) lr 1.7290e-03 eta 0:10:30
epoch [14/50] batch [100/162] time 0.099 (0.105) data 0.000 (0.009) loss 1.1721 (1.0751) ce_loss 0.5366 (0.4466) loss_zs_kd 0.1044 (0.0878) loss_oracle 0.1198 (0.1267) acc 78.1250 (83.4688) kd_loss 0.5234 (0.5213) lr 1.7290e-03 eta 0:10:18
epoch [14/50] batch [120/162] time 0.102 (0.104) data 0.000 (0.007) loss 0.8451 (1.0631) ce_loss 0.2407 (0.4378) loss_zs_kd 0.0589 (0.0875) loss_oracle 0.0909 (0.1231) acc 90.6250 (83.7760) kd_loss 0.5295 (0.5200) lr 1.7290e-03 eta 0:10:09
epoch [14/50] batch [140/162] time 0.092 (0.103) data 0.000 (0.006) loss 1.0430 (1.0630) ce_loss 0.3745 (0.4371) loss_zs_kd 0.1138 (0.0867) loss_oracle 0.0674 (0.1179) acc 90.6250 (84.0402) kd_loss 0.5780 (0.5236) lr 1.7290e-03 eta 0:10:00
epoch [14/50] batch [160/162] time 0.087 (0.101) data 0.000 (0.006) loss 1.2305 (1.0650) ce_loss 0.5923 (0.4413) loss_zs_kd 0.1176 (0.0861) loss_oracle 0.0845 (0.1143) acc 75.0000 (83.8086) kd_loss 0.5371 (0.5235) lr 1.7290e-03 eta 0:09:51
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,971
* accuracy: 88.2%
* error: 11.8%
* macro_f1: 90.0%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,610
* accuracy: 79.5%
* error: 20.5%
* macro_f1: 74.7%
******* Domain s best val acc:      88.2%, epoch: 14 *******
******* Domain s best val test acc: 79.5%, epoch: 14 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [15/50] batch [20/162] time 0.081 (0.137) data 0.000 (0.046) loss 1.3134 (1.0383) ce_loss 0.6641 (0.4153) loss_zs_kd 0.0627 (0.0789) loss_oracle 0.1077 (0.1094) acc 75.0000 (85.4688) kd_loss 0.5641 (0.5289) lr 1.6845e-03 eta 0:13:18
epoch [15/50] batch [40/162] time 0.087 (0.111) data 0.000 (0.023) loss 1.0729 (1.0379) ce_loss 0.3750 (0.4074) loss_zs_kd 0.0837 (0.0768) loss_oracle 0.1674 (0.1145) acc 84.3750 (85.0781) kd_loss 0.5724 (0.5349) lr 1.6845e-03 eta 0:10:40
epoch [15/50] batch [60/162] time 0.058 (0.106) data 0.000 (0.015) loss 0.9240 (1.0605) ce_loss 0.2847 (0.4195) loss_zs_kd 0.0635 (0.0918) loss_oracle 0.1576 (0.1192) acc 90.6250 (84.4271) kd_loss 0.5287 (0.5355) lr 1.6845e-03 eta 0:10:10
epoch [15/50] batch [80/162] time 0.124 (0.104) data 0.000 (0.012) loss 1.1652 (1.0619) ce_loss 0.5757 (0.4226) loss_zs_kd 0.0828 (0.0924) loss_oracle 0.0683 (0.1121) acc 78.1250 (84.3750) kd_loss 0.5139 (0.5370) lr 1.6845e-03 eta 0:09:56
epoch [15/50] batch [100/162] time 0.119 (0.104) data 0.000 (0.009) loss 1.0198 (1.0683) ce_loss 0.3640 (0.4338) loss_zs_kd 0.0676 (0.0901) loss_oracle 0.1108 (0.1093) acc 84.3750 (84.2500) kd_loss 0.5666 (0.5348) lr 1.6845e-03 eta 0:09:57
epoch [15/50] batch [120/162] time 0.155 (0.103) data 0.000 (0.008) loss 1.2697 (1.0713) ce_loss 0.6333 (0.4350) loss_zs_kd 0.1032 (0.0914) loss_oracle 0.0937 (0.1093) acc 87.5000 (84.1927) kd_loss 0.5380 (0.5359) lr 1.6845e-03 eta 0:09:48
epoch [15/50] batch [140/162] time 0.078 (0.100) data 0.000 (0.007) loss 0.9770 (1.0689) ce_loss 0.3582 (0.4366) loss_zs_kd 0.0685 (0.0902) loss_oracle 0.0658 (0.1079) acc 75.0000 (84.1518) kd_loss 0.5517 (0.5333) lr 1.6845e-03 eta 0:09:27
epoch [15/50] batch [160/162] time 0.065 (0.096) data 0.000 (0.006) loss 0.9988 (1.0590) ce_loss 0.3889 (0.4282) loss_zs_kd 0.0701 (0.0889) loss_oracle 0.1117 (0.1069) acc 93.7500 (84.3945) kd_loss 0.5190 (0.5329) lr 1.6845e-03 eta 0:09:04
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,965
* accuracy: 88.0%
* error: 12.0%
* macro_f1: 89.9%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,614
* accuracy: 79.6%
* error: 20.4%
* macro_f1: 75.2%
******* Domain s best val acc:      88.2%, epoch: 14 *******
******* Domain s best val test acc: 79.5%, epoch: 14 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [16/50] batch [20/162] time 0.094 (0.134) data 0.000 (0.045) loss 1.0925 (1.0910) ce_loss 0.4219 (0.4566) loss_zs_kd 0.0882 (0.0780) loss_oracle 0.1310 (0.1050) acc 81.2500 (82.3438) kd_loss 0.5610 (0.5429) lr 1.6374e-03 eta 0:12:37
epoch [16/50] batch [40/162] time 0.089 (0.114) data 0.000 (0.023) loss 0.8305 (1.0927) ce_loss 0.1965 (0.4485) loss_zs_kd 0.0594 (0.0840) loss_oracle 0.1260 (0.1090) acc 96.8750 (82.5000) kd_loss 0.5412 (0.5477) lr 1.6374e-03 eta 0:10:43
epoch [16/50] batch [60/162] time 0.098 (0.107) data 0.000 (0.015) loss 1.2021 (1.1033) ce_loss 0.4817 (0.4602) loss_zs_kd 0.1676 (0.0834) loss_oracle 0.1145 (0.1095) acc 81.2500 (81.8229) kd_loss 0.5793 (0.5466) lr 1.6374e-03 eta 0:10:02
epoch [16/50] batch [80/162] time 0.096 (0.104) data 0.000 (0.011) loss 1.2411 (1.0902) ce_loss 0.6450 (0.4450) loss_zs_kd 0.0940 (0.0853) loss_oracle 0.1376 (0.1203) acc 78.1250 (83.0469) kd_loss 0.4803 (0.5425) lr 1.6374e-03 eta 0:09:41
epoch [16/50] batch [100/162] time 0.099 (0.102) data 0.000 (0.009) loss 1.2084 (1.0880) ce_loss 0.5698 (0.4453) loss_zs_kd 0.0867 (0.0863) loss_oracle 0.1025 (0.1208) acc 84.3750 (83.2500) kd_loss 0.5440 (0.5392) lr 1.6374e-03 eta 0:09:30
epoch [16/50] batch [120/162] time 0.105 (0.102) data 0.000 (0.008) loss 1.1305 (1.0941) ce_loss 0.4375 (0.4525) loss_zs_kd 0.0832 (0.0870) loss_oracle 0.1335 (0.1195) acc 84.3750 (83.0729) kd_loss 0.5847 (0.5383) lr 1.6374e-03 eta 0:09:23
epoch [16/50] batch [140/162] time 0.089 (0.101) data 0.000 (0.007) loss 0.9061 (1.0792) ce_loss 0.2111 (0.4366) loss_zs_kd 0.0747 (0.0884) loss_oracle 0.0711 (0.1167) acc 96.8750 (83.9955) kd_loss 0.6222 (0.5400) lr 1.6374e-03 eta 0:09:16
epoch [16/50] batch [160/162] time 0.085 (0.099) data 0.000 (0.006) loss 1.1152 (1.0745) ce_loss 0.4209 (0.4352) loss_zs_kd 0.1352 (0.0886) loss_oracle 0.1068 (0.1145) acc 84.3750 (84.0039) kd_loss 0.5733 (0.5377) lr 1.6374e-03 eta 0:09:06
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,967
* accuracy: 88.0%
* error: 12.0%
* macro_f1: 89.8%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,614
* accuracy: 79.6%
* error: 20.4%
* macro_f1: 75.6%
******* Domain s best val acc:      88.2%, epoch: 14 *******
******* Domain s best val test acc: 79.5%, epoch: 14 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [17/50] batch [20/162] time 0.097 (0.136) data 0.000 (0.044) loss 1.1149 (1.0227) ce_loss 0.4902 (0.3985) loss_zs_kd 0.0633 (0.0882) loss_oracle 0.1442 (0.1156) acc 81.2500 (86.5625) kd_loss 0.5209 (0.5223) lr 1.5878e-03 eta 0:12:28
epoch [17/50] batch [40/162] time 0.098 (0.113) data 0.000 (0.022) loss 1.0159 (1.0151) ce_loss 0.4150 (0.3846) loss_zs_kd 0.1217 (0.0875) loss_oracle 0.1471 (0.1243) acc 81.2500 (85.6250) kd_loss 0.4665 (0.5246) lr 1.5878e-03 eta 0:10:20
epoch [17/50] batch [60/162] time 0.097 (0.107) data 0.000 (0.015) loss 0.9732 (1.0329) ce_loss 0.3940 (0.4025) loss_zs_kd 0.0818 (0.0868) loss_oracle 0.1836 (0.1295) acc 81.2500 (84.9479) kd_loss 0.4465 (0.5222) lr 1.5878e-03 eta 0:09:42
epoch [17/50] batch [80/162] time 0.091 (0.104) data 0.000 (0.011) loss 0.9885 (1.0576) ce_loss 0.4224 (0.4172) loss_zs_kd 0.0597 (0.0861) loss_oracle 0.1288 (0.1396) acc 78.1250 (84.3750) kd_loss 0.4719 (0.5275) lr 1.5878e-03 eta 0:09:22
epoch [17/50] batch [100/162] time 0.097 (0.102) data 0.000 (0.009) loss 1.1181 (1.0751) ce_loss 0.4968 (0.4338) loss_zs_kd 0.0928 (0.0862) loss_oracle 0.1245 (0.1363) acc 78.1250 (83.7188) kd_loss 0.5126 (0.5301) lr 1.5878e-03 eta 0:09:09
epoch [17/50] batch [120/162] time 0.092 (0.100) data 0.000 (0.008) loss 0.9055 (1.0735) ce_loss 0.2693 (0.4300) loss_zs_kd 0.0662 (0.0860) loss_oracle 0.1383 (0.1352) acc 90.6250 (83.9062) kd_loss 0.5340 (0.5330) lr 1.5878e-03 eta 0:08:58
epoch [17/50] batch [140/162] time 0.063 (0.099) data 0.000 (0.007) loss 0.8041 (1.0747) ce_loss 0.2139 (0.4302) loss_zs_kd 0.0704 (0.0872) loss_oracle 0.1378 (0.1346) acc 93.7500 (83.7723) kd_loss 0.4861 (0.5336) lr 1.5878e-03 eta 0:08:49
epoch [17/50] batch [160/162] time 0.082 (0.096) data 0.000 (0.006) loss 0.9919 (1.0756) ce_loss 0.3516 (0.4293) loss_zs_kd 0.0917 (0.0879) loss_oracle 0.1659 (0.1365) acc 84.3750 (83.8281) kd_loss 0.5115 (0.5341) lr 1.5878e-03 eta 0:08:33
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,963
* accuracy: 87.9%
* error: 12.1%
* macro_f1: 89.7%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,590
* accuracy: 78.9%
* error: 21.1%
* macro_f1: 74.3%
******* Domain s best val acc:      88.2%, epoch: 14 *******
******* Domain s best val test acc: 79.5%, epoch: 14 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [18/50] batch [20/162] time 0.147 (0.160) data 0.000 (0.049) loss 0.9626 (1.1050) ce_loss 0.2461 (0.4294) loss_zs_kd 0.0832 (0.0773) loss_oracle 0.1610 (0.1627) acc 90.6250 (83.2812) kd_loss 0.5943 (0.5556) lr 1.5358e-03 eta 0:14:10
epoch [18/50] batch [40/162] time 0.072 (0.133) data 0.000 (0.025) loss 1.0541 (1.1067) ce_loss 0.3564 (0.4251) loss_zs_kd 0.0566 (0.0796) loss_oracle 0.2044 (0.1651) acc 87.5000 (84.1406) kd_loss 0.5672 (0.5593) lr 1.5358e-03 eta 0:11:47
epoch [18/50] batch [60/162] time 0.082 (0.118) data 0.000 (0.017) loss 1.1079 (1.0980) ce_loss 0.4263 (0.4175) loss_zs_kd 0.1212 (0.0846) loss_oracle 0.1132 (0.1592) acc 75.0000 (84.3229) kd_loss 0.5645 (0.5586) lr 1.5358e-03 eta 0:10:21
epoch [18/50] batch [80/162] time 0.079 (0.114) data 0.000 (0.013) loss 1.1102 (1.1064) ce_loss 0.4180 (0.4237) loss_zs_kd 0.0837 (0.0890) loss_oracle 0.1321 (0.1542) acc 84.3750 (84.1406) kd_loss 0.5843 (0.5611) lr 1.5358e-03 eta 0:09:59
epoch [18/50] batch [100/162] time 0.084 (0.112) data 0.000 (0.010) loss 1.1626 (1.1132) ce_loss 0.4722 (0.4296) loss_zs_kd 0.0961 (0.0896) loss_oracle 0.0932 (0.1500) acc 78.1250 (83.7812) kd_loss 0.5958 (0.5639) lr 1.5358e-03 eta 0:09:48
epoch [18/50] batch [120/162] time 0.150 (0.112) data 0.000 (0.008) loss 1.4277 (1.1050) ce_loss 0.7729 (0.4245) loss_zs_kd 0.0909 (0.0863) loss_oracle 0.0722 (0.1438) acc 71.8750 (83.8281) kd_loss 0.5732 (0.5655) lr 1.5358e-03 eta 0:09:45
epoch [18/50] batch [140/162] time 0.144 (0.112) data 0.000 (0.007) loss 0.9016 (1.1084) ce_loss 0.1907 (0.4278) loss_zs_kd 0.0532 (0.0853) loss_oracle 0.1627 (0.1411) acc 96.8750 (83.9955) kd_loss 0.6031 (0.5674) lr 1.5358e-03 eta 0:09:40
epoch [18/50] batch [160/162] time 0.069 (0.107) data 0.001 (0.006) loss 0.8982 (1.1214) ce_loss 0.2466 (0.4381) loss_zs_kd 0.0756 (0.0862) loss_oracle 0.2304 (0.1432) acc 93.7500 (83.6719) kd_loss 0.4986 (0.5686) lr 1.5358e-03 eta 0:09:17
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,965
* accuracy: 88.0%
* error: 12.0%
* macro_f1: 89.7%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,626
* accuracy: 80.0%
* error: 20.0%
* macro_f1: 75.0%
******* Domain s best val acc:      88.2%, epoch: 14 *******
******* Domain s best val test acc: 79.5%, epoch: 14 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [19/50] batch [20/162] time 0.086 (0.149) data 0.000 (0.050) loss 1.4910 (1.1124) ce_loss 0.7349 (0.4148) loss_zs_kd 0.1312 (0.0891) loss_oracle 0.2069 (0.1684) acc 68.7500 (85.0000) kd_loss 0.5871 (0.5688) lr 1.4818e-03 eta 0:12:49
epoch [19/50] batch [40/162] time 0.106 (0.121) data 0.000 (0.025) loss 1.1438 (1.1274) ce_loss 0.4495 (0.4347) loss_zs_kd 0.0543 (0.0947) loss_oracle 0.1352 (0.1512) acc 81.2500 (84.2188) kd_loss 0.5996 (0.5698) lr 1.4818e-03 eta 0:10:22
epoch [19/50] batch [60/162] time 0.090 (0.114) data 0.000 (0.017) loss 1.2297 (1.1202) ce_loss 0.4614 (0.4297) loss_zs_kd 0.0821 (0.0995) loss_oracle 0.1867 (0.1447) acc 81.2500 (84.0625) kd_loss 0.6339 (0.5683) lr 1.4818e-03 eta 0:09:42
epoch [19/50] batch [80/162] time 0.105 (0.110) data 0.000 (0.013) loss 1.0779 (1.1137) ce_loss 0.4172 (0.4238) loss_zs_kd 0.0934 (0.0965) loss_oracle 0.1484 (0.1444) acc 87.5000 (84.4922) kd_loss 0.5398 (0.5694) lr 1.4818e-03 eta 0:09:19
epoch [19/50] batch [100/162] time 0.083 (0.107) data 0.000 (0.010) loss 1.0597 (1.1162) ce_loss 0.4248 (0.4304) loss_zs_kd 0.1095 (0.0973) loss_oracle 0.0877 (0.1432) acc 81.2500 (84.3125) kd_loss 0.5363 (0.5655) lr 1.4818e-03 eta 0:09:02
epoch [19/50] batch [120/162] time 0.102 (0.105) data 0.001 (0.009) loss 0.9928 (1.1098) ce_loss 0.2800 (0.4262) loss_zs_kd 0.0936 (0.0933) loss_oracle 0.1503 (0.1427) acc 90.6250 (84.4792) kd_loss 0.5909 (0.5656) lr 1.4818e-03 eta 0:08:51
epoch [19/50] batch [140/162] time 0.087 (0.104) data 0.000 (0.007) loss 1.0106 (1.1097) ce_loss 0.3242 (0.4287) loss_zs_kd 0.1140 (0.0917) loss_oracle 0.1049 (0.1399) acc 87.5000 (84.3527) kd_loss 0.5770 (0.5652) lr 1.4818e-03 eta 0:08:42
epoch [19/50] batch [160/162] time 0.087 (0.102) data 0.000 (0.007) loss 0.9559 (1.1115) ce_loss 0.2820 (0.4324) loss_zs_kd 0.0827 (0.0896) loss_oracle 0.1341 (0.1380) acc 93.7500 (84.3164) kd_loss 0.5655 (0.5652) lr 1.4818e-03 eta 0:08:32
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,962
* accuracy: 87.8%
* error: 12.2%
* macro_f1: 89.6%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,608
* accuracy: 79.5%
* error: 20.5%
* macro_f1: 74.4%
******* Domain s best val acc:      88.2%, epoch: 14 *******
******* Domain s best val test acc: 79.5%, epoch: 14 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [20/50] batch [20/162] time 0.100 (0.143) data 0.000 (0.051) loss 1.1834 (1.1260) ce_loss 0.4785 (0.4429) loss_zs_kd 0.1310 (0.0944) loss_oracle 0.1596 (0.1289) acc 78.1250 (83.2812) kd_loss 0.5596 (0.5715) lr 1.4258e-03 eta 0:11:52
epoch [20/50] batch [40/162] time 0.094 (0.118) data 0.000 (0.025) loss 1.0580 (1.1076) ce_loss 0.3425 (0.4336) loss_zs_kd 0.0790 (0.0933) loss_oracle 0.1211 (0.1256) acc 90.6250 (84.5312) kd_loss 0.6154 (0.5645) lr 1.4258e-03 eta 0:09:47
epoch [20/50] batch [60/162] time 0.072 (0.108) data 0.000 (0.017) loss 0.9752 (1.1191) ce_loss 0.3098 (0.4504) loss_zs_kd 0.0701 (0.0869) loss_oracle 0.1144 (0.1234) acc 84.3750 (83.4375) kd_loss 0.5731 (0.5637) lr 1.4258e-03 eta 0:08:56
epoch [20/50] batch [80/162] time 0.098 (0.106) data 0.000 (0.013) loss 1.1084 (1.1075) ce_loss 0.4600 (0.4373) loss_zs_kd 0.0989 (0.0894) loss_oracle 0.1768 (0.1308) acc 78.1250 (83.9062) kd_loss 0.5105 (0.5601) lr 1.4258e-03 eta 0:08:42
epoch [20/50] batch [100/162] time 0.070 (0.102) data 0.000 (0.010) loss 1.0105 (1.1055) ce_loss 0.3748 (0.4361) loss_zs_kd 0.0822 (0.0884) loss_oracle 0.1512 (0.1351) acc 84.3750 (83.8125) kd_loss 0.5190 (0.5576) lr 1.4258e-03 eta 0:08:20
epoch [20/50] batch [120/162] time 0.084 (0.099) data 0.000 (0.009) loss 0.9047 (1.1016) ce_loss 0.2722 (0.4325) loss_zs_kd 0.0514 (0.0863) loss_oracle 0.1172 (0.1396) acc 93.7500 (84.1667) kd_loss 0.5482 (0.5562) lr 1.4258e-03 eta 0:08:04
epoch [20/50] batch [140/162] time 0.065 (0.099) data 0.001 (0.007) loss 1.2181 (1.1014) ce_loss 0.5278 (0.4290) loss_zs_kd 0.1035 (0.0859) loss_oracle 0.2067 (0.1423) acc 84.3750 (84.3973) kd_loss 0.5352 (0.5582) lr 1.4258e-03 eta 0:08:04
epoch [20/50] batch [160/162] time 0.112 (0.099) data 0.000 (0.007) loss 1.0384 (1.1027) ce_loss 0.3091 (0.4294) loss_zs_kd 0.0799 (0.0862) loss_oracle 0.1688 (0.1462) acc 93.7500 (84.3555) kd_loss 0.6050 (0.5571) lr 1.4258e-03 eta 0:08:00
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,966
* accuracy: 88.0%
* error: 12.0%
* macro_f1: 89.8%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,554
* accuracy: 77.8%
* error: 22.2%
* macro_f1: 74.1%
******* Domain s best val acc:      88.2%, epoch: 14 *******
******* Domain s best val test acc: 79.5%, epoch: 14 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [21/50] batch [20/162] time 0.159 (0.164) data 0.000 (0.060) loss 1.1868 (1.1384) ce_loss 0.4641 (0.4299) loss_zs_kd 0.0978 (0.0836) loss_oracle 0.1507 (0.1656) acc 81.2500 (84.2188) kd_loss 0.5985 (0.5839) lr 1.3681e-03 eta 0:13:11
epoch [21/50] batch [40/162] time 0.161 (0.134) data 0.000 (0.030) loss 1.1986 (1.1199) ce_loss 0.5083 (0.4198) loss_zs_kd 0.0721 (0.0814) loss_oracle 0.1649 (0.1632) acc 75.0000 (84.3750) kd_loss 0.5718 (0.5778) lr 1.3681e-03 eta 0:10:47
epoch [21/50] batch [60/162] time 0.078 (0.117) data 0.000 (0.020) loss 1.0394 (1.1293) ce_loss 0.3040 (0.4197) loss_zs_kd 0.1104 (0.0838) loss_oracle 0.1706 (0.1704) acc 87.5000 (84.2188) kd_loss 0.5950 (0.5825) lr 1.3681e-03 eta 0:09:20
epoch [21/50] batch [80/162] time 0.101 (0.111) data 0.000 (0.015) loss 1.3077 (1.1395) ce_loss 0.5708 (0.4304) loss_zs_kd 0.0747 (0.0838) loss_oracle 0.2393 (0.1700) acc 78.1250 (83.9844) kd_loss 0.5799 (0.5823) lr 1.3681e-03 eta 0:08:51
epoch [21/50] batch [100/162] time 0.098 (0.108) data 0.000 (0.012) loss 1.5625 (1.1440) ce_loss 0.8237 (0.4335) loss_zs_kd 0.1021 (0.0866) loss_oracle 0.1451 (0.1675) acc 68.7500 (83.9688) kd_loss 0.6152 (0.5834) lr 1.3681e-03 eta 0:08:36
epoch [21/50] batch [120/162] time 0.098 (0.107) data 0.000 (0.010) loss 1.1826 (1.1471) ce_loss 0.4890 (0.4365) loss_zs_kd 0.0775 (0.0848) loss_oracle 0.1630 (0.1668) acc 78.1250 (84.0625) kd_loss 0.5734 (0.5848) lr 1.3681e-03 eta 0:08:25
epoch [21/50] batch [140/162] time 0.093 (0.105) data 0.000 (0.009) loss 1.1330 (1.1531) ce_loss 0.3271 (0.4382) loss_zs_kd 0.0778 (0.0859) loss_oracle 0.2026 (0.1677) acc 90.6250 (83.8170) kd_loss 0.6656 (0.5881) lr 1.3681e-03 eta 0:08:17
epoch [21/50] batch [160/162] time 0.086 (0.104) data 0.000 (0.008) loss 1.0315 (1.1498) ce_loss 0.2981 (0.4348) loss_zs_kd 0.0725 (0.0852) loss_oracle 0.2131 (0.1676) acc 87.5000 (83.9453) kd_loss 0.5906 (0.5886) lr 1.3681e-03 eta 0:08:07
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,963
* accuracy: 87.9%
* error: 12.1%
* macro_f1: 89.7%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,566
* accuracy: 78.2%
* error: 21.8%
* macro_f1: 74.6%
******* Domain s best val acc:      88.2%, epoch: 14 *******
******* Domain s best val test acc: 79.5%, epoch: 14 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [22/50] batch [20/162] time 0.092 (0.135) data 0.000 (0.051) loss 1.1013 (1.0976) ce_loss 0.3848 (0.3706) loss_zs_kd 0.1263 (0.1051) loss_oracle 0.1222 (0.1550) acc 81.2500 (87.1875) kd_loss 0.5922 (0.5969) lr 1.3090e-03 eta 0:10:29
epoch [22/50] batch [40/162] time 0.080 (0.105) data 0.000 (0.026) loss 1.1218 (1.1196) ce_loss 0.3743 (0.3999) loss_zs_kd 0.0793 (0.1006) loss_oracle 0.1991 (0.1612) acc 84.3750 (85.9375) kd_loss 0.6083 (0.5888) lr 1.3090e-03 eta 0:08:08
epoch [22/50] batch [60/162] time 0.073 (0.097) data 0.000 (0.017) loss 1.2703 (1.1346) ce_loss 0.5244 (0.4204) loss_zs_kd 0.0787 (0.0951) loss_oracle 0.1485 (0.1621) acc 75.0000 (84.6354) kd_loss 0.6323 (0.5857) lr 1.3090e-03 eta 0:07:28
epoch [22/50] batch [80/162] time 0.087 (0.092) data 0.000 (0.013) loss 1.1048 (1.1293) ce_loss 0.4783 (0.4177) loss_zs_kd 0.0895 (0.0936) loss_oracle 0.1305 (0.1633) acc 87.5000 (84.4922) kd_loss 0.5165 (0.5831) lr 1.3090e-03 eta 0:07:06
epoch [22/50] batch [100/162] time 0.092 (0.089) data 0.000 (0.010) loss 0.9858 (1.1234) ce_loss 0.2698 (0.4140) loss_zs_kd 0.1134 (0.0940) loss_oracle 0.1498 (0.1638) acc 87.5000 (84.6562) kd_loss 0.5844 (0.5805) lr 1.3090e-03 eta 0:06:50
epoch [22/50] batch [120/162] time 0.094 (0.089) data 0.000 (0.009) loss 1.0663 (1.1253) ce_loss 0.4185 (0.4181) loss_zs_kd 0.0947 (0.0926) loss_oracle 0.1233 (0.1629) acc 87.5000 (84.2188) kd_loss 0.5388 (0.5794) lr 1.3090e-03 eta 0:06:47
epoch [22/50] batch [140/162] time 0.093 (0.089) data 0.000 (0.008) loss 1.0866 (1.1296) ce_loss 0.4160 (0.4254) loss_zs_kd 0.0514 (0.0905) loss_oracle 0.1531 (0.1604) acc 81.2500 (83.9955) kd_loss 0.5684 (0.5787) lr 1.3090e-03 eta 0:06:45
epoch [22/50] batch [160/162] time 0.067 (0.089) data 0.000 (0.007) loss 0.9572 (1.1341) ce_loss 0.2954 (0.4306) loss_zs_kd 0.0964 (0.0898) loss_oracle 0.1360 (0.1577) acc 87.5000 (83.9453) kd_loss 0.5456 (0.5797) lr 1.3090e-03 eta 0:06:41
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,957
* accuracy: 87.6%
* error: 12.4%
* macro_f1: 89.3%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,574
* accuracy: 78.4%
* error: 21.6%
* macro_f1: 75.1%
******* Domain s best val acc:      88.2%, epoch: 14 *******
******* Domain s best val test acc: 79.5%, epoch: 14 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [23/50] batch [20/162] time 0.095 (0.141) data 0.000 (0.059) loss 1.1675 (1.1630) ce_loss 0.4866 (0.4543) loss_zs_kd 0.1110 (0.1014) loss_oracle 0.1542 (0.1946) acc 78.1250 (82.5000) kd_loss 0.5483 (0.5607) lr 1.2487e-03 eta 0:10:36
epoch [23/50] batch [40/162] time 0.164 (0.123) data 0.000 (0.030) loss 0.8936 (1.1252) ce_loss 0.2462 (0.4212) loss_zs_kd 0.0727 (0.1019) loss_oracle 0.1560 (0.1902) acc 90.6250 (83.4375) kd_loss 0.5330 (0.5580) lr 1.2487e-03 eta 0:09:14
epoch [23/50] batch [60/162] time 0.078 (0.116) data 0.000 (0.020) loss 1.2777 (1.1134) ce_loss 0.5610 (0.4122) loss_zs_kd 0.0847 (0.0987) loss_oracle 0.1734 (0.1842) acc 75.0000 (83.9583) kd_loss 0.5876 (0.5598) lr 1.2487e-03 eta 0:08:39
epoch [23/50] batch [80/162] time 0.072 (0.114) data 0.000 (0.015) loss 1.1375 (1.1192) ce_loss 0.4280 (0.4170) loss_zs_kd 0.1091 (0.0986) loss_oracle 0.1525 (0.1852) acc 93.7500 (84.1797) kd_loss 0.5787 (0.5603) lr 1.2487e-03 eta 0:08:26
epoch [23/50] batch [100/162] time 0.078 (0.111) data 0.000 (0.012) loss 1.0857 (1.1337) ce_loss 0.4565 (0.4285) loss_zs_kd 0.0834 (0.0966) loss_oracle 0.2147 (0.1902) acc 84.3750 (83.6875) kd_loss 0.4802 (0.5618) lr 1.2487e-03 eta 0:08:14
epoch [23/50] batch [120/162] time 0.092 (0.107) data 0.000 (0.010) loss 1.0933 (1.1322) ce_loss 0.3459 (0.4267) loss_zs_kd 0.0650 (0.0932) loss_oracle 0.2692 (0.1903) acc 90.6250 (84.0104) kd_loss 0.5803 (0.5638) lr 1.2487e-03 eta 0:07:50
epoch [23/50] batch [140/162] time 0.075 (0.105) data 0.000 (0.009) loss 1.3319 (1.1310) ce_loss 0.5942 (0.4244) loss_zs_kd 0.1199 (0.0909) loss_oracle 0.1754 (0.1933) acc 78.1250 (83.9062) kd_loss 0.5900 (0.5645) lr 1.2487e-03 eta 0:07:42
epoch [23/50] batch [160/162] time 0.066 (0.105) data 0.000 (0.008) loss 0.9881 (1.1401) ce_loss 0.3306 (0.4314) loss_zs_kd 0.0422 (0.0897) loss_oracle 0.1666 (0.1941) acc 93.7500 (83.8281) kd_loss 0.5531 (0.5669) lr 1.2487e-03 eta 0:07:41
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,956
* accuracy: 87.6%
* error: 12.4%
* macro_f1: 89.5%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,667
* accuracy: 81.3%
* error: 18.7%
* macro_f1: 76.2%
******* Domain s best val acc:      88.2%, epoch: 14 *******
******* Domain s best val test acc: 79.5%, epoch: 14 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [24/50] batch [20/162] time 0.096 (0.157) data 0.000 (0.060) loss 1.2436 (1.1232) ce_loss 0.5347 (0.4208) loss_zs_kd 0.0959 (0.0931) loss_oracle 0.1689 (0.1546) acc 87.5000 (85.1562) kd_loss 0.5766 (0.5786) lr 1.1874e-03 eta 0:11:21
epoch [24/50] batch [40/162] time 0.103 (0.124) data 0.000 (0.030) loss 0.9088 (1.1207) ce_loss 0.3262 (0.4259) loss_zs_kd 0.0723 (0.0931) loss_oracle 0.1037 (0.1508) acc 93.7500 (84.5312) kd_loss 0.4946 (0.5728) lr 1.1874e-03 eta 0:08:58
epoch [24/50] batch [60/162] time 0.099 (0.114) data 0.001 (0.020) loss 1.3406 (1.1131) ce_loss 0.6255 (0.4186) loss_zs_kd 0.0724 (0.0906) loss_oracle 0.1735 (0.1506) acc 78.1250 (84.3750) kd_loss 0.5922 (0.5739) lr 1.1874e-03 eta 0:08:13
epoch [24/50] batch [80/162] time 0.097 (0.110) data 0.000 (0.015) loss 1.3155 (1.1162) ce_loss 0.5869 (0.4257) loss_zs_kd 0.0807 (0.0888) loss_oracle 0.1151 (0.1455) acc 78.1250 (84.1797) kd_loss 0.6307 (0.5733) lr 1.1874e-03 eta 0:07:53
epoch [24/50] batch [100/162] time 0.099 (0.108) data 0.000 (0.012) loss 1.0582 (1.1236) ce_loss 0.3875 (0.4333) loss_zs_kd 0.0745 (0.0887) loss_oracle 0.2219 (0.1477) acc 87.5000 (83.8438) kd_loss 0.5226 (0.5722) lr 1.1874e-03 eta 0:07:39
epoch [24/50] batch [120/162] time 0.102 (0.105) data 0.000 (0.010) loss 1.1617 (1.1171) ce_loss 0.4182 (0.4249) loss_zs_kd 0.1312 (0.0899) loss_oracle 0.1872 (0.1520) acc 87.5000 (84.2969) kd_loss 0.5843 (0.5713) lr 1.1874e-03 eta 0:07:28
epoch [24/50] batch [140/162] time 0.084 (0.104) data 0.000 (0.009) loss 1.0647 (1.1175) ce_loss 0.3723 (0.4244) loss_zs_kd 0.1282 (0.0914) loss_oracle 0.1379 (0.1528) acc 90.6250 (84.1964) kd_loss 0.5593 (0.5710) lr 1.1874e-03 eta 0:07:19
epoch [24/50] batch [160/162] time 0.086 (0.102) data 0.000 (0.008) loss 1.2042 (1.1175) ce_loss 0.5283 (0.4240) loss_zs_kd 0.0901 (0.0908) loss_oracle 0.1174 (0.1544) acc 78.1250 (84.2188) kd_loss 0.5721 (0.5708) lr 1.1874e-03 eta 0:07:09
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,969
* accuracy: 88.1%
* error: 11.9%
* macro_f1: 89.8%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,631
* accuracy: 80.2%
* error: 19.8%
* macro_f1: 75.4%
******* Domain s best val acc:      88.2%, epoch: 14 *******
******* Domain s best val test acc: 79.5%, epoch: 14 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [25/50] batch [20/162] time 0.098 (0.162) data 0.001 (0.060) loss 1.1042 (1.2171) ce_loss 0.3572 (0.4860) loss_zs_kd 0.0785 (0.0947) loss_oracle 0.2082 (0.1877) acc 87.5000 (81.2500) kd_loss 0.6037 (0.5899) lr 1.1253e-03 eta 0:11:17
epoch [25/50] batch [40/162] time 0.091 (0.129) data 0.000 (0.030) loss 1.0204 (1.1666) ce_loss 0.3459 (0.4423) loss_zs_kd 0.0624 (0.0941) loss_oracle 0.2102 (0.1872) acc 84.3750 (82.9688) kd_loss 0.5381 (0.5836) lr 1.1253e-03 eta 0:08:56
epoch [25/50] batch [60/162] time 0.097 (0.117) data 0.000 (0.020) loss 1.0256 (1.1454) ce_loss 0.3394 (0.4304) loss_zs_kd 0.1053 (0.0914) loss_oracle 0.1429 (0.1772) acc 87.5000 (83.5938) kd_loss 0.5621 (0.5808) lr 1.1253e-03 eta 0:08:07
epoch [25/50] batch [80/162] time 0.090 (0.112) data 0.000 (0.015) loss 0.9060 (1.1332) ce_loss 0.3264 (0.4237) loss_zs_kd 0.0606 (0.0922) loss_oracle 0.1505 (0.1741) acc 90.6250 (83.7109) kd_loss 0.4740 (0.5763) lr 1.1253e-03 eta 0:07:42
epoch [25/50] batch [100/162] time 0.093 (0.109) data 0.000 (0.012) loss 1.0456 (1.1207) ce_loss 0.3352 (0.4204) loss_zs_kd 0.0721 (0.0883) loss_oracle 0.1193 (0.1648) acc 87.5000 (83.7500) kd_loss 0.6147 (0.5737) lr 1.1253e-03 eta 0:07:27
epoch [25/50] batch [120/162] time 0.105 (0.107) data 0.000 (0.010) loss 1.1461 (1.1239) ce_loss 0.5249 (0.4237) loss_zs_kd 0.0788 (0.0917) loss_oracle 0.1615 (0.1640) acc 81.2500 (83.5156) kd_loss 0.5010 (0.5724) lr 1.1253e-03 eta 0:07:16
epoch [25/50] batch [140/162] time 0.080 (0.104) data 0.000 (0.009) loss 1.0082 (1.1211) ce_loss 0.2566 (0.4240) loss_zs_kd 0.0531 (0.0900) loss_oracle 0.2151 (0.1648) acc 93.7500 (83.6161) kd_loss 0.6176 (0.5697) lr 1.1253e-03 eta 0:07:05
epoch [25/50] batch [160/162] time 0.068 (0.100) data 0.000 (0.008) loss 1.0640 (1.1214) ce_loss 0.3770 (0.4256) loss_zs_kd 0.0586 (0.0900) loss_oracle 0.2436 (0.1645) acc 81.2500 (83.5156) kd_loss 0.5359 (0.5686) lr 1.1253e-03 eta 0:06:47
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,962
* accuracy: 87.8%
* error: 12.2%
* macro_f1: 89.5%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,637
* accuracy: 80.3%
* error: 19.7%
* macro_f1: 75.8%
******* Domain s best val acc:      88.2%, epoch: 14 *******
******* Domain s best val test acc: 79.5%, epoch: 14 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [26/50] batch [20/162] time 0.074 (0.166) data 0.000 (0.068) loss 1.0733 (1.1041) ce_loss 0.3521 (0.4178) loss_zs_kd 0.1244 (0.0992) loss_oracle 0.1550 (0.1572) acc 87.5000 (84.5312) kd_loss 0.5815 (0.5581) lr 1.0628e-03 eta 0:11:09
epoch [26/50] batch [40/162] time 0.142 (0.135) data 0.000 (0.034) loss 1.1633 (1.1229) ce_loss 0.3940 (0.4351) loss_zs_kd 0.0986 (0.0923) loss_oracle 0.1827 (0.1567) acc 84.3750 (83.2812) kd_loss 0.6286 (0.5634) lr 1.0628e-03 eta 0:09:02
epoch [26/50] batch [60/162] time 0.166 (0.129) data 0.000 (0.023) loss 1.0206 (1.1250) ce_loss 0.2617 (0.4301) loss_zs_kd 0.1179 (0.0952) loss_oracle 0.2440 (0.1638) acc 90.6250 (83.4896) kd_loss 0.5780 (0.5653) lr 1.0628e-03 eta 0:08:32
epoch [26/50] batch [80/162] time 0.135 (0.122) data 0.000 (0.017) loss 1.0831 (1.1346) ce_loss 0.3779 (0.4373) loss_zs_kd 0.0573 (0.0899) loss_oracle 0.1771 (0.1694) acc 84.3750 (83.3203) kd_loss 0.5880 (0.5677) lr 1.0628e-03 eta 0:08:05
epoch [26/50] batch [100/162] time 0.086 (0.116) data 0.000 (0.014) loss 1.1853 (1.1338) ce_loss 0.4441 (0.4338) loss_zs_kd 0.1259 (0.0892) loss_oracle 0.1883 (0.1715) acc 90.6250 (83.5938) kd_loss 0.5841 (0.5696) lr 1.0628e-03 eta 0:07:39
epoch [26/50] batch [120/162] time 0.094 (0.113) data 0.000 (0.012) loss 1.0995 (1.1326) ce_loss 0.3538 (0.4322) loss_zs_kd 0.0742 (0.0912) loss_oracle 0.2278 (0.1716) acc 87.5000 (83.6198) kd_loss 0.5947 (0.5691) lr 1.0628e-03 eta 0:07:22
epoch [26/50] batch [140/162] time 0.104 (0.110) data 0.000 (0.010) loss 0.9050 (1.1210) ce_loss 0.2817 (0.4240) loss_zs_kd 0.1071 (0.0902) loss_oracle 0.1276 (0.1708) acc 96.8750 (83.9509) kd_loss 0.5060 (0.5665) lr 1.0628e-03 eta 0:07:11
epoch [26/50] batch [160/162] time 0.088 (0.108) data 0.000 (0.009) loss 1.0938 (1.1219) ce_loss 0.4543 (0.4240) loss_zs_kd 0.0578 (0.0907) loss_oracle 0.1597 (0.1737) acc 84.3750 (83.9062) kd_loss 0.5307 (0.5657) lr 1.0628e-03 eta 0:06:59
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,962
* accuracy: 87.8%
* error: 12.2%
* macro_f1: 89.6%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,670
* accuracy: 81.4%
* error: 18.6%
* macro_f1: 76.8%
******* Domain s best val acc:      88.2%, epoch: 14 *******
******* Domain s best val test acc: 79.5%, epoch: 14 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [27/50] batch [20/162] time 0.103 (0.156) data 0.000 (0.067) loss 1.1024 (1.1404) ce_loss 0.3857 (0.4309) loss_zs_kd 0.1195 (0.0861) loss_oracle 0.1759 (0.1802) acc 75.0000 (82.1875) kd_loss 0.5690 (0.5763) lr 1.0000e-03 eta 0:10:05
epoch [27/50] batch [40/162] time 0.104 (0.124) data 0.000 (0.034) loss 1.0008 (1.1419) ce_loss 0.2795 (0.4409) loss_zs_kd 0.0669 (0.0889) loss_oracle 0.1402 (0.1648) acc 90.6250 (82.7344) kd_loss 0.6178 (0.5741) lr 1.0000e-03 eta 0:07:58
epoch [27/50] batch [60/162] time 0.086 (0.114) data 0.000 (0.023) loss 0.9060 (1.1374) ce_loss 0.3018 (0.4400) loss_zs_kd 0.0838 (0.0878) loss_oracle 0.1272 (0.1690) acc 90.6250 (82.9167) kd_loss 0.4987 (0.5690) lr 1.0000e-03 eta 0:07:16
epoch [27/50] batch [80/162] time 0.113 (0.110) data 0.000 (0.017) loss 1.3892 (1.1387) ce_loss 0.6069 (0.4376) loss_zs_kd 0.0924 (0.0889) loss_oracle 0.1948 (0.1736) acc 84.3750 (83.0469) kd_loss 0.6387 (0.5698) lr 1.0000e-03 eta 0:06:57
epoch [27/50] batch [100/162] time 0.097 (0.107) data 0.000 (0.014) loss 1.0057 (1.1246) ce_loss 0.2878 (0.4238) loss_zs_kd 0.0634 (0.0886) loss_oracle 0.1667 (0.1757) acc 90.6250 (83.9688) kd_loss 0.6028 (0.5686) lr 1.0000e-03 eta 0:06:45
epoch [27/50] batch [120/162] time 0.098 (0.105) data 0.000 (0.011) loss 1.1248 (1.1189) ce_loss 0.4509 (0.4168) loss_zs_kd 0.0762 (0.0886) loss_oracle 0.2318 (0.1798) acc 87.5000 (84.2448) kd_loss 0.5199 (0.5680) lr 1.0000e-03 eta 0:06:36
epoch [27/50] batch [140/162] time 0.097 (0.104) data 0.001 (0.010) loss 1.0127 (1.1216) ce_loss 0.3513 (0.4204) loss_zs_kd 0.0583 (0.0889) loss_oracle 0.1816 (0.1807) acc 87.5000 (83.7500) kd_loss 0.5415 (0.5664) lr 1.0000e-03 eta 0:06:28
epoch [27/50] batch [160/162] time 0.095 (0.102) data 0.000 (0.009) loss 0.9377 (1.1179) ce_loss 0.2410 (0.4165) loss_zs_kd 0.0643 (0.0888) loss_oracle 0.1654 (0.1804) acc 87.5000 (83.9258) kd_loss 0.5819 (0.5668) lr 1.0000e-03 eta 0:06:21
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,964
* accuracy: 87.9%
* error: 12.1%
* macro_f1: 89.7%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,584
* accuracy: 78.7%
* error: 21.3%
* macro_f1: 74.9%
******* Domain s best val acc:      88.2%, epoch: 14 *******
******* Domain s best val test acc: 79.5%, epoch: 14 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [28/50] batch [20/162] time 0.067 (0.136) data 0.000 (0.067) loss 1.2652 (1.1921) ce_loss 0.5107 (0.4468) loss_zs_kd 0.1101 (0.0990) loss_oracle 0.2622 (0.2124) acc 71.8750 (82.9688) kd_loss 0.5683 (0.5896) lr 9.3721e-04 eta 0:08:25
epoch [28/50] batch [40/162] time 0.059 (0.101) data 0.001 (0.034) loss 1.4653 (1.2217) ce_loss 0.6558 (0.4709) loss_zs_kd 0.1067 (0.0900) loss_oracle 0.2610 (0.2264) acc 84.3750 (82.2656) kd_loss 0.6257 (0.5925) lr 9.3721e-04 eta 0:06:11
epoch [28/50] batch [60/162] time 0.082 (0.096) data 0.000 (0.023) loss 1.1192 (1.2072) ce_loss 0.3965 (0.4554) loss_zs_kd 0.0775 (0.0841) loss_oracle 0.2248 (0.2305) acc 81.2500 (83.0208) kd_loss 0.5716 (0.5945) lr 9.3721e-04 eta 0:05:53
epoch [28/50] batch [80/162] time 0.060 (0.095) data 0.000 (0.017) loss 1.1146 (1.2006) ce_loss 0.3638 (0.4467) loss_zs_kd 0.0602 (0.0871) loss_oracle 0.1695 (0.2242) acc 81.2500 (83.1641) kd_loss 0.6360 (0.5982) lr 9.3721e-04 eta 0:05:46
epoch [28/50] batch [100/162] time 0.081 (0.097) data 0.000 (0.014) loss 1.3163 (1.1831) ce_loss 0.5620 (0.4269) loss_zs_kd 0.1225 (0.0889) loss_oracle 0.1869 (0.2189) acc 84.3750 (84.0312) kd_loss 0.5995 (0.6022) lr 9.3721e-04 eta 0:05:51
epoch [28/50] batch [120/162] time 0.066 (0.099) data 0.000 (0.011) loss 1.4678 (1.1806) ce_loss 0.7246 (0.4215) loss_zs_kd 0.0886 (0.0902) loss_oracle 0.2132 (0.2176) acc 71.8750 (84.4792) kd_loss 0.5923 (0.6053) lr 9.3721e-04 eta 0:05:56
epoch [28/50] batch [140/162] time 0.093 (0.098) data 0.000 (0.010) loss 1.4365 (1.1883) ce_loss 0.6929 (0.4247) loss_zs_kd 0.0679 (0.0889) loss_oracle 0.1974 (0.2200) acc 75.0000 (84.5536) kd_loss 0.6110 (0.6091) lr 9.3721e-04 eta 0:05:50
epoch [28/50] batch [160/162] time 0.067 (0.095) data 0.000 (0.009) loss 1.2073 (1.1884) ce_loss 0.4102 (0.4202) loss_zs_kd 0.0487 (0.0872) loss_oracle 0.1792 (0.2192) acc 90.6250 (84.7852) kd_loss 0.6832 (0.6150) lr 9.3721e-04 eta 0:05:39
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,967
* accuracy: 88.0%
* error: 12.0%
* macro_f1: 89.8%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,581
* accuracy: 78.6%
* error: 21.4%
* macro_f1: 74.7%
******* Domain s best val acc:      88.2%, epoch: 14 *******
******* Domain s best val test acc: 79.5%, epoch: 14 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [29/50] batch [20/162] time 0.087 (0.160) data 0.000 (0.072) loss 1.2901 (1.2396) ce_loss 0.4905 (0.4061) loss_zs_kd 0.0697 (0.0978) loss_oracle 0.2432 (0.2246) acc 84.3750 (84.8438) kd_loss 0.6432 (0.6723) lr 8.7467e-04 eta 0:09:26
epoch [29/50] batch [40/162] time 0.089 (0.123) data 0.000 (0.036) loss 1.4349 (1.2537) ce_loss 0.6611 (0.4311) loss_zs_kd 0.0607 (0.0961) loss_oracle 0.1580 (0.2090) acc 71.8750 (83.5156) kd_loss 0.6644 (0.6701) lr 8.7467e-04 eta 0:07:12
epoch [29/50] batch [60/162] time 0.090 (0.110) data 0.000 (0.024) loss 1.0984 (1.2317) ce_loss 0.3022 (0.4222) loss_zs_kd 0.0971 (0.0910) loss_oracle 0.2206 (0.2055) acc 90.6250 (83.8021) kd_loss 0.6373 (0.6613) lr 8.7467e-04 eta 0:06:25
epoch [29/50] batch [80/162] time 0.083 (0.104) data 0.000 (0.018) loss 1.2449 (1.2272) ce_loss 0.2993 (0.4156) loss_zs_kd 0.0632 (0.0886) loss_oracle 0.2666 (0.2143) acc 87.5000 (84.1406) kd_loss 0.7807 (0.6602) lr 8.7467e-04 eta 0:06:01
epoch [29/50] batch [100/162] time 0.112 (0.101) data 0.000 (0.015) loss 1.1315 (1.2295) ce_loss 0.3530 (0.4157) loss_zs_kd 0.0807 (0.0911) loss_oracle 0.2800 (0.2202) acc 93.7500 (84.5625) kd_loss 0.5981 (0.6581) lr 8.7467e-04 eta 0:05:49
epoch [29/50] batch [120/162] time 0.083 (0.099) data 0.000 (0.012) loss 1.4191 (1.2357) ce_loss 0.5439 (0.4250) loss_zs_kd 0.0841 (0.0916) loss_oracle 0.2718 (0.2198) acc 78.1250 (84.1667) kd_loss 0.6973 (0.6550) lr 8.7467e-04 eta 0:05:40
epoch [29/50] batch [140/162] time 0.086 (0.098) data 0.000 (0.010) loss 1.1653 (1.2318) ce_loss 0.3145 (0.4251) loss_zs_kd 0.0647 (0.0912) loss_oracle 0.2766 (0.2194) acc 93.7500 (84.3304) kd_loss 0.6801 (0.6514) lr 8.7467e-04 eta 0:05:34
epoch [29/50] batch [160/162] time 0.081 (0.096) data 0.000 (0.009) loss 1.2118 (1.2227) ce_loss 0.4863 (0.4196) loss_zs_kd 0.0702 (0.0893) loss_oracle 0.2345 (0.2208) acc 78.1250 (84.4336) kd_loss 0.5731 (0.6481) lr 8.7467e-04 eta 0:05:26
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,972
* accuracy: 88.3%
* error: 11.7%
* macro_f1: 90.1%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,615
* accuracy: 79.7%
* error: 20.3%
* macro_f1: 74.4%
******* Domain s best val acc:      88.3%, epoch: 29 *******
******* Domain s best val test acc: 79.7%, epoch: 29 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [30/50] batch [20/162] time 0.099 (0.166) data 0.000 (0.075) loss 1.0731 (1.1917) ce_loss 0.2690 (0.4231) loss_zs_kd 0.0906 (0.0791) loss_oracle 0.1971 (0.2185) acc 90.6250 (83.5938) kd_loss 0.6602 (0.6198) lr 8.1262e-04 eta 0:09:19
epoch [30/50] batch [40/162] time 0.094 (0.132) data 0.000 (0.037) loss 0.9543 (1.1726) ce_loss 0.1737 (0.3992) loss_zs_kd 0.1258 (0.0830) loss_oracle 0.1827 (0.2087) acc 96.8750 (85.6250) kd_loss 0.6263 (0.6275) lr 8.1262e-04 eta 0:07:23
epoch [30/50] batch [60/162] time 0.098 (0.120) data 0.000 (0.025) loss 1.2147 (1.1900) ce_loss 0.4583 (0.4125) loss_zs_kd 0.1701 (0.0880) loss_oracle 0.1903 (0.2096) acc 81.2500 (84.7396) kd_loss 0.5762 (0.6287) lr 8.1262e-04 eta 0:06:40
epoch [30/50] batch [80/162] time 0.102 (0.114) data 0.000 (0.019) loss 1.3043 (1.2080) ce_loss 0.6123 (0.4297) loss_zs_kd 0.0991 (0.0867) loss_oracle 0.1490 (0.2089) acc 81.2500 (84.2188) kd_loss 0.5680 (0.6306) lr 8.1262e-04 eta 0:06:18
epoch [30/50] batch [100/162] time 0.089 (0.109) data 0.000 (0.015) loss 1.1011 (1.1965) ce_loss 0.3032 (0.4194) loss_zs_kd 0.0779 (0.0860) loss_oracle 0.2219 (0.2087) acc 87.5000 (84.4688) kd_loss 0.6480 (0.6298) lr 8.1262e-04 eta 0:06:00
epoch [30/50] batch [120/162] time 0.081 (0.105) data 0.000 (0.013) loss 1.0909 (1.1891) ce_loss 0.3750 (0.4131) loss_zs_kd 0.0853 (0.0875) loss_oracle 0.1526 (0.2068) acc 87.5000 (84.6354) kd_loss 0.5970 (0.6289) lr 8.1262e-04 eta 0:05:44
epoch [30/50] batch [140/162] time 0.090 (0.102) data 0.000 (0.011) loss 1.1915 (1.1953) ce_loss 0.4429 (0.4176) loss_zs_kd 0.1066 (0.0890) loss_oracle 0.1673 (0.2092) acc 87.5000 (84.4866) kd_loss 0.6117 (0.6286) lr 8.1262e-04 eta 0:05:34
epoch [30/50] batch [160/162] time 0.063 (0.099) data 0.000 (0.009) loss 1.1489 (1.2011) ce_loss 0.2908 (0.4191) loss_zs_kd 0.0937 (0.0893) loss_oracle 0.2821 (0.2132) acc 84.3750 (84.1797) kd_loss 0.6703 (0.6307) lr 8.1262e-04 eta 0:05:21
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,961
* accuracy: 87.8%
* error: 12.2%
* macro_f1: 89.7%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,605
* accuracy: 79.4%
* error: 20.6%
* macro_f1: 74.9%
******* Domain s best val acc:      88.3%, epoch: 29 *******
******* Domain s best val test acc: 79.7%, epoch: 29 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [31/50] batch [20/162] time 0.072 (0.147) data 0.000 (0.070) loss 1.4499 (1.2477) ce_loss 0.5811 (0.4566) loss_zs_kd 0.0933 (0.0841) loss_oracle 0.2472 (0.2329) acc 81.2500 (84.0625) kd_loss 0.6985 (0.6326) lr 7.5131e-04 eta 0:07:54
epoch [31/50] batch [40/162] time 0.126 (0.124) data 0.000 (0.035) loss 1.0900 (1.2370) ce_loss 0.2336 (0.4191) loss_zs_kd 0.0718 (0.0930) loss_oracle 0.2651 (0.2460) acc 100.0000 (85.1562) kd_loss 0.6879 (0.6484) lr 7.5131e-04 eta 0:06:35
epoch [31/50] batch [60/162] time 0.131 (0.115) data 0.001 (0.024) loss 0.9113 (1.2303) ce_loss 0.1489 (0.4123) loss_zs_kd 0.0583 (0.0890) loss_oracle 0.2276 (0.2384) acc 96.8750 (85.0521) kd_loss 0.6195 (0.6543) lr 7.5131e-04 eta 0:06:06
epoch [31/50] batch [80/162] time 0.072 (0.112) data 0.000 (0.018) loss 1.1344 (1.2214) ce_loss 0.3027 (0.4144) loss_zs_kd 0.1484 (0.0890) loss_oracle 0.2073 (0.2252) acc 87.5000 (84.4922) kd_loss 0.6538 (0.6499) lr 7.5131e-04 eta 0:05:52
epoch [31/50] batch [100/162] time 0.093 (0.110) data 0.000 (0.014) loss 1.1315 (1.2163) ce_loss 0.3621 (0.4152) loss_zs_kd 0.0685 (0.0908) loss_oracle 0.2586 (0.2202) acc 84.3750 (84.6250) kd_loss 0.6059 (0.6457) lr 7.5131e-04 eta 0:05:44
epoch [31/50] batch [120/162] time 0.084 (0.105) data 0.000 (0.012) loss 0.9946 (1.2114) ce_loss 0.2810 (0.4155) loss_zs_kd 0.0677 (0.0896) loss_oracle 0.1400 (0.2183) acc 90.6250 (84.4271) kd_loss 0.6097 (0.6419) lr 7.5131e-04 eta 0:05:29
epoch [31/50] batch [140/162] time 0.101 (0.103) data 0.000 (0.010) loss 1.2689 (1.2051) ce_loss 0.4705 (0.4151) loss_zs_kd 0.0943 (0.0891) loss_oracle 0.2613 (0.2178) acc 84.3750 (84.5089) kd_loss 0.6207 (0.6365) lr 7.5131e-04 eta 0:05:19
epoch [31/50] batch [160/162] time 0.089 (0.101) data 0.000 (0.009) loss 1.2775 (1.1986) ce_loss 0.4912 (0.4111) loss_zs_kd 0.1219 (0.0890) loss_oracle 0.1745 (0.2172) acc 81.2500 (84.6875) kd_loss 0.6381 (0.6344) lr 7.5131e-04 eta 0:05:11
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,973
* accuracy: 88.3%
* error: 11.7%
* macro_f1: 90.1%
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,634
* accuracy: 80.3%
* error: 19.7%
* macro_f1: 75.2%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [32/50] batch [20/162] time 0.094 (0.163) data 0.000 (0.069) loss 1.1740 (1.1862) ce_loss 0.4456 (0.4139) loss_zs_kd 0.0962 (0.0823) loss_oracle 0.1747 (0.1990) acc 81.2500 (84.5312) kd_loss 0.5930 (0.6317) lr 6.9098e-04 eta 0:08:18
epoch [32/50] batch [40/162] time 0.089 (0.127) data 0.000 (0.034) loss 1.2314 (1.1951) ce_loss 0.3672 (0.4195) loss_zs_kd 0.0872 (0.0824) loss_oracle 0.2493 (0.2045) acc 81.2500 (84.1406) kd_loss 0.6960 (0.6322) lr 6.9098e-04 eta 0:06:26
epoch [32/50] batch [60/162] time 0.081 (0.115) data 0.000 (0.023) loss 1.3227 (1.1914) ce_loss 0.6074 (0.4119) loss_zs_kd 0.0569 (0.0883) loss_oracle 0.1483 (0.2034) acc 78.1250 (84.3750) kd_loss 0.6127 (0.6336) lr 6.9098e-04 eta 0:05:47
epoch [32/50] batch [80/162] time 0.078 (0.110) data 0.000 (0.017) loss 1.0122 (1.1866) ce_loss 0.3240 (0.4064) loss_zs_kd 0.0506 (0.0882) loss_oracle 0.1795 (0.2004) acc 87.5000 (84.8047) kd_loss 0.5731 (0.6359) lr 6.9098e-04 eta 0:05:28
epoch [32/50] batch [100/162] time 0.079 (0.108) data 0.000 (0.014) loss 1.3464 (1.1820) ce_loss 0.5503 (0.4020) loss_zs_kd 0.0756 (0.0896) loss_oracle 0.2138 (0.1934) acc 81.2500 (84.9062) kd_loss 0.6514 (0.6385) lr 6.9098e-04 eta 0:05:20
epoch [32/50] batch [120/162] time 0.088 (0.106) data 0.000 (0.012) loss 1.1558 (1.1904) ce_loss 0.4133 (0.4121) loss_zs_kd 0.1011 (0.0894) loss_oracle 0.1585 (0.1928) acc 87.5000 (84.4792) kd_loss 0.6127 (0.6372) lr 6.9098e-04 eta 0:05:13
epoch [32/50] batch [140/162] time 0.097 (0.105) data 0.000 (0.010) loss 1.0518 (1.1908) ce_loss 0.2922 (0.4080) loss_zs_kd 0.0927 (0.0897) loss_oracle 0.2618 (0.1966) acc 87.5000 (84.5089) kd_loss 0.5823 (0.6397) lr 6.9098e-04 eta 0:05:07
epoch [32/50] batch [160/162] time 0.094 (0.102) data 0.000 (0.009) loss 1.5206 (1.1973) ce_loss 0.7085 (0.4091) loss_zs_kd 0.1046 (0.0914) loss_oracle 0.2050 (0.2002) acc 68.7500 (84.5312) kd_loss 0.6573 (0.6425) lr 6.9098e-04 eta 0:04:59
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,961
* accuracy: 87.8%
* error: 12.2%
* macro_f1: 89.7%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,557
* accuracy: 77.9%
* error: 22.1%
* macro_f1: 73.9%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [33/50] batch [20/162] time 0.082 (0.159) data 0.000 (0.072) loss 1.4848 (1.2593) ce_loss 0.6855 (0.4460) loss_zs_kd 0.0796 (0.1010) loss_oracle 0.1978 (0.2225) acc 71.8750 (82.8125) kd_loss 0.6605 (0.6515) lr 6.3188e-04 eta 0:07:39
epoch [33/50] batch [40/162] time 0.079 (0.121) data 0.000 (0.036) loss 1.4249 (1.2429) ce_loss 0.5571 (0.4290) loss_zs_kd 0.0541 (0.0945) loss_oracle 0.2112 (0.2230) acc 75.0000 (83.3594) kd_loss 0.7351 (0.6551) lr 6.3188e-04 eta 0:05:47
epoch [33/50] batch [60/162] time 0.084 (0.112) data 0.000 (0.024) loss 1.2110 (1.2301) ce_loss 0.3831 (0.4145) loss_zs_kd 0.0816 (0.0955) loss_oracle 0.2091 (0.2232) acc 87.5000 (84.0625) kd_loss 0.6826 (0.6562) lr 6.3188e-04 eta 0:05:19
epoch [33/50] batch [80/162] time 0.106 (0.109) data 0.000 (0.018) loss 1.2949 (1.2310) ce_loss 0.5420 (0.4143) loss_zs_kd 0.0725 (0.0951) loss_oracle 0.2146 (0.2236) acc 78.1250 (84.0234) kd_loss 0.6093 (0.6573) lr 6.3188e-04 eta 0:05:08
epoch [33/50] batch [100/162] time 0.137 (0.107) data 0.000 (0.015) loss 1.3347 (1.2333) ce_loss 0.4443 (0.4115) loss_zs_kd 0.1238 (0.0930) loss_oracle 0.2817 (0.2277) acc 84.3750 (84.4062) kd_loss 0.6876 (0.6614) lr 6.3188e-04 eta 0:05:02
epoch [33/50] batch [120/162] time 0.071 (0.106) data 0.000 (0.012) loss 1.3662 (1.2406) ce_loss 0.4780 (0.4131) loss_zs_kd 0.0647 (0.0915) loss_oracle 0.2269 (0.2326) acc 81.2500 (84.5312) kd_loss 0.7423 (0.6655) lr 6.3188e-04 eta 0:04:57
epoch [33/50] batch [140/162] time 0.084 (0.104) data 0.000 (0.010) loss 1.2455 (1.2481) ce_loss 0.3330 (0.4141) loss_zs_kd 0.1146 (0.0912) loss_oracle 0.2600 (0.2346) acc 87.5000 (84.5536) kd_loss 0.7252 (0.6711) lr 6.3188e-04 eta 0:04:48
epoch [33/50] batch [160/162] time 0.068 (0.101) data 0.000 (0.009) loss 1.0565 (1.2518) ce_loss 0.1431 (0.4114) loss_zs_kd 0.0667 (0.0913) loss_oracle 0.2939 (0.2379) acc 96.8750 (84.4727) kd_loss 0.7332 (0.6758) lr 6.3188e-04 eta 0:04:37
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,963
* accuracy: 87.9%
* error: 12.1%
* macro_f1: 89.8%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,638
* accuracy: 80.4%
* error: 19.6%
* macro_f1: 75.8%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [34/50] batch [20/162] time 0.105 (0.183) data 0.000 (0.087) loss 1.1233 (1.3210) ce_loss 0.2299 (0.4100) loss_zs_kd 0.0809 (0.0978) loss_oracle 0.2632 (0.2572) acc 96.8750 (86.4062) kd_loss 0.7214 (0.7335) lr 5.7422e-04 eta 0:08:20
epoch [34/50] batch [40/162] time 0.096 (0.139) data 0.000 (0.044) loss 1.1363 (1.2934) ce_loss 0.3347 (0.4099) loss_zs_kd 0.0826 (0.0918) loss_oracle 0.1879 (0.2453) acc 84.3750 (85.0781) kd_loss 0.6663 (0.7150) lr 5.7422e-04 eta 0:06:17
epoch [34/50] batch [60/162] time 0.090 (0.124) data 0.000 (0.029) loss 1.2765 (1.2808) ce_loss 0.4102 (0.4075) loss_zs_kd 0.1045 (0.0904) loss_oracle 0.1541 (0.2290) acc 81.2500 (84.7917) kd_loss 0.7371 (0.7137) lr 5.7422e-04 eta 0:05:33
epoch [34/50] batch [80/162] time 0.094 (0.116) data 0.000 (0.022) loss 1.2462 (1.2725) ce_loss 0.4426 (0.4056) loss_zs_kd 0.0940 (0.0914) loss_oracle 0.1796 (0.2230) acc 84.3750 (84.6484) kd_loss 0.6668 (0.7097) lr 5.7422e-04 eta 0:05:11
epoch [34/50] batch [100/162] time 0.100 (0.112) data 0.000 (0.018) loss 1.3205 (1.2638) ce_loss 0.4863 (0.4067) loss_zs_kd 0.0639 (0.0915) loss_oracle 0.2069 (0.2170) acc 81.2500 (84.8438) kd_loss 0.6988 (0.7028) lr 5.7422e-04 eta 0:04:57
epoch [34/50] batch [120/162] time 0.100 (0.109) data 0.000 (0.015) loss 1.2752 (1.2593) ce_loss 0.3882 (0.4058) loss_zs_kd 0.0979 (0.0920) loss_oracle 0.2034 (0.2144) acc 87.5000 (85.0781) kd_loss 0.7364 (0.7003) lr 5.7422e-04 eta 0:04:48
epoch [34/50] batch [140/162] time 0.103 (0.107) data 0.000 (0.013) loss 1.2774 (1.2579) ce_loss 0.4539 (0.4080) loss_zs_kd 0.0848 (0.0921) loss_oracle 0.2254 (0.2142) acc 90.6250 (85.0893) kd_loss 0.6685 (0.6967) lr 5.7422e-04 eta 0:04:40
epoch [34/50] batch [160/162] time 0.087 (0.105) data 0.000 (0.011) loss 1.0726 (1.2520) ce_loss 0.2773 (0.4073) loss_zs_kd 0.0967 (0.0919) loss_oracle 0.1952 (0.2147) acc 87.5000 (85.0195) kd_loss 0.6493 (0.6914) lr 5.7422e-04 eta 0:04:32
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,966
* accuracy: 88.0%
* error: 12.0%
* macro_f1: 89.7%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,581
* accuracy: 78.6%
* error: 21.4%
* macro_f1: 74.6%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [35/50] batch [20/162] time 0.100 (0.174) data 0.000 (0.076) loss 1.0792 (1.2291) ce_loss 0.2720 (0.4220) loss_zs_kd 0.0912 (0.0951) loss_oracle 0.2820 (0.2285) acc 87.5000 (85.6250) kd_loss 0.6207 (0.6453) lr 5.1825e-04 eta 0:07:27
epoch [35/50] batch [40/162] time 0.098 (0.136) data 0.000 (0.038) loss 1.1087 (1.2534) ce_loss 0.2695 (0.4324) loss_zs_kd 0.0910 (0.0885) loss_oracle 0.2410 (0.2327) acc 87.5000 (84.6094) kd_loss 0.6731 (0.6603) lr 5.1825e-04 eta 0:05:47
epoch [35/50] batch [60/162] time 0.102 (0.123) data 0.000 (0.025) loss 1.4365 (1.2566) ce_loss 0.5977 (0.4245) loss_zs_kd 0.0999 (0.0891) loss_oracle 0.2024 (0.2364) acc 81.2500 (84.4792) kd_loss 0.6877 (0.6693) lr 5.1825e-04 eta 0:05:11
epoch [35/50] batch [80/162] time 0.099 (0.116) data 0.000 (0.019) loss 1.3220 (1.2642) ce_loss 0.4236 (0.4253) loss_zs_kd 0.0910 (0.0951) loss_oracle 0.3004 (0.2347) acc 78.1250 (84.4922) kd_loss 0.7028 (0.6740) lr 5.1825e-04 eta 0:04:50
epoch [35/50] batch [100/162] time 0.099 (0.112) data 0.000 (0.015) loss 1.1905 (1.2689) ce_loss 0.3586 (0.4282) loss_zs_kd 0.0898 (0.0956) loss_oracle 0.2100 (0.2320) acc 87.5000 (84.2188) kd_loss 0.6819 (0.6769) lr 5.1825e-04 eta 0:04:38
epoch [35/50] batch [120/162] time 0.095 (0.109) data 0.000 (0.013) loss 1.0557 (1.2724) ce_loss 0.2493 (0.4265) loss_zs_kd 0.0637 (0.0955) loss_oracle 0.2619 (0.2310) acc 90.6250 (84.2708) kd_loss 0.6436 (0.6826) lr 5.1825e-04 eta 0:04:30
epoch [35/50] batch [140/162] time 0.090 (0.108) data 0.000 (0.011) loss 1.1535 (1.2621) ce_loss 0.3015 (0.4178) loss_zs_kd 0.0699 (0.0946) loss_oracle 0.2004 (0.2278) acc 93.7500 (84.6429) kd_loss 0.7169 (0.6831) lr 5.1825e-04 eta 0:04:23
epoch [35/50] batch [160/162] time 0.065 (0.104) data 0.000 (0.010) loss 1.0884 (1.2564) ce_loss 0.3425 (0.4172) loss_zs_kd 0.1004 (0.0955) loss_oracle 0.1913 (0.2242) acc 84.3750 (84.8242) kd_loss 0.6000 (0.6793) lr 5.1825e-04 eta 0:04:13
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,971
* accuracy: 88.2%
* error: 11.8%
* macro_f1: 90.0%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,630
* accuracy: 80.1%
* error: 19.9%
* macro_f1: 75.7%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [36/50] batch [20/162] time 0.156 (0.185) data 0.000 (0.090) loss 1.0682 (1.2118) ce_loss 0.3369 (0.3761) loss_zs_kd 0.0627 (0.0867) loss_oracle 0.1594 (0.1856) acc 87.5000 (85.9375) kd_loss 0.6202 (0.6996) lr 4.6417e-04 eta 0:07:26
epoch [36/50] batch [40/162] time 0.159 (0.147) data 0.000 (0.045) loss 1.4658 (1.2290) ce_loss 0.6040 (0.3994) loss_zs_kd 0.1468 (0.0932) loss_oracle 0.1470 (0.1835) acc 71.8750 (84.1406) kd_loss 0.7148 (0.6912) lr 4.6417e-04 eta 0:05:51
epoch [36/50] batch [60/162] time 0.162 (0.136) data 0.000 (0.030) loss 1.1044 (1.2339) ce_loss 0.2664 (0.4027) loss_zs_kd 0.0691 (0.0930) loss_oracle 0.1967 (0.1820) acc 93.7500 (84.1667) kd_loss 0.7051 (0.6937) lr 4.6417e-04 eta 0:05:22
epoch [36/50] batch [80/162] time 0.069 (0.126) data 0.000 (0.023) loss 1.1353 (1.2328) ce_loss 0.3262 (0.4052) loss_zs_kd 0.1465 (0.0927) loss_oracle 0.1385 (0.1840) acc 87.5000 (84.3359) kd_loss 0.6666 (0.6892) lr 4.6417e-04 eta 0:04:56
epoch [36/50] batch [100/162] time 0.096 (0.120) data 0.000 (0.018) loss 1.3021 (1.2234) ce_loss 0.4329 (0.3952) loss_zs_kd 0.0682 (0.0930) loss_oracle 0.2739 (0.1913) acc 84.3750 (85.0312) kd_loss 0.6982 (0.6860) lr 4.6417e-04 eta 0:04:39
epoch [36/50] batch [120/162] time 0.082 (0.115) data 0.000 (0.015) loss 1.2033 (1.2368) ce_loss 0.4626 (0.4090) loss_zs_kd 0.0805 (0.0923) loss_oracle 0.2420 (0.1942) acc 87.5000 (84.6875) kd_loss 0.5794 (0.6845) lr 4.6417e-04 eta 0:04:24
epoch [36/50] batch [140/162] time 0.091 (0.110) data 0.000 (0.013) loss 1.4303 (1.2438) ce_loss 0.5483 (0.4118) loss_zs_kd 0.1293 (0.0939) loss_oracle 0.1961 (0.1975) acc 78.1250 (84.5536) kd_loss 0.7193 (0.6863) lr 4.6417e-04 eta 0:04:12
epoch [36/50] batch [160/162] time 0.086 (0.108) data 0.000 (0.011) loss 1.4105 (1.2515) ce_loss 0.5464 (0.4167) loss_zs_kd 0.1062 (0.0936) loss_oracle 0.2042 (0.1999) acc 75.0000 (84.2969) kd_loss 0.7090 (0.6880) lr 4.6417e-04 eta 0:04:05
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,958
* accuracy: 87.6%
* error: 12.4%
* macro_f1: 89.4%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,645
* accuracy: 80.6%
* error: 19.4%
* macro_f1: 76.3%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [37/50] batch [20/162] time 0.090 (0.177) data 0.000 (0.075) loss 1.1870 (1.3267) ce_loss 0.4094 (0.4665) loss_zs_kd 0.1013 (0.0836) loss_oracle 0.1773 (0.2380) acc 84.3750 (82.6562) kd_loss 0.6383 (0.6994) lr 4.1221e-04 eta 0:06:37
epoch [37/50] batch [40/162] time 0.114 (0.136) data 0.000 (0.038) loss 1.2603 (1.3028) ce_loss 0.5317 (0.4637) loss_zs_kd 0.1127 (0.0877) loss_oracle 0.1481 (0.2286) acc 81.2500 (82.1875) kd_loss 0.5981 (0.6810) lr 4.1221e-04 eta 0:05:03
epoch [37/50] batch [60/162] time 0.096 (0.125) data 0.001 (0.025) loss 1.1781 (1.2876) ce_loss 0.3604 (0.4410) loss_zs_kd 0.1097 (0.0906) loss_oracle 0.2267 (0.2291) acc 90.6250 (83.2292) kd_loss 0.6495 (0.6867) lr 4.1221e-04 eta 0:04:35
epoch [37/50] batch [80/162] time 0.097 (0.117) data 0.000 (0.019) loss 1.2297 (1.2705) ce_loss 0.3923 (0.4269) loss_zs_kd 0.0915 (0.0914) loss_oracle 0.1985 (0.2269) acc 78.1250 (83.9062) kd_loss 0.6924 (0.6845) lr 4.1221e-04 eta 0:04:16
epoch [37/50] batch [100/162] time 0.099 (0.112) data 0.000 (0.015) loss 1.4389 (1.2614) ce_loss 0.5557 (0.4206) loss_zs_kd 0.1124 (0.0920) loss_oracle 0.2276 (0.2248) acc 75.0000 (84.0938) kd_loss 0.7132 (0.6823) lr 4.1221e-04 eta 0:04:03
epoch [37/50] batch [120/162] time 0.092 (0.109) data 0.000 (0.013) loss 1.4827 (1.2669) ce_loss 0.6382 (0.4264) loss_zs_kd 0.0868 (0.0950) loss_oracle 0.2553 (0.2222) acc 78.1250 (84.0625) kd_loss 0.6735 (0.6820) lr 4.1221e-04 eta 0:03:55
epoch [37/50] batch [140/162] time 0.099 (0.108) data 0.000 (0.011) loss 1.2770 (1.2670) ce_loss 0.4182 (0.4217) loss_zs_kd 0.0617 (0.0935) loss_oracle 0.1946 (0.2227) acc 84.3750 (84.1964) kd_loss 0.7306 (0.6871) lr 4.1221e-04 eta 0:03:48
epoch [37/50] batch [160/162] time 0.088 (0.106) data 0.000 (0.010) loss 1.1456 (1.2671) ce_loss 0.3428 (0.4209) loss_zs_kd 0.0881 (0.0942) loss_oracle 0.2329 (0.2233) acc 87.5000 (84.2578) kd_loss 0.6423 (0.6874) lr 4.1221e-04 eta 0:03:43
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,969
* accuracy: 88.1%
* error: 11.9%
* macro_f1: 90.0%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,620
* accuracy: 79.8%
* error: 20.2%
* macro_f1: 75.4%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [38/50] batch [20/162] time 0.076 (0.159) data 0.000 (0.078) loss 1.2315 (1.2911) ce_loss 0.3770 (0.4426) loss_zs_kd 0.0707 (0.1011) loss_oracle 0.2263 (0.2246) acc 87.5000 (83.4375) kd_loss 0.7060 (0.6856) lr 3.6258e-04 eta 0:05:32
epoch [38/50] batch [40/162] time 0.166 (0.126) data 0.000 (0.039) loss 1.2535 (1.2853) ce_loss 0.3997 (0.4371) loss_zs_kd 0.0585 (0.0931) loss_oracle 0.1773 (0.2287) acc 90.6250 (84.2188) kd_loss 0.7359 (0.6873) lr 3.6258e-04 eta 0:04:20
epoch [38/50] batch [60/162] time 0.079 (0.118) data 0.000 (0.026) loss 1.1834 (1.2930) ce_loss 0.3560 (0.4418) loss_zs_kd 0.0906 (0.0910) loss_oracle 0.1779 (0.2285) acc 84.3750 (84.2188) kd_loss 0.6932 (0.6915) lr 3.6258e-04 eta 0:04:00
epoch [38/50] batch [80/162] time 0.093 (0.112) data 0.001 (0.020) loss 1.1851 (1.2814) ce_loss 0.3484 (0.4255) loss_zs_kd 0.0704 (0.0920) loss_oracle 0.2007 (0.2263) acc 90.6250 (84.9219) kd_loss 0.7012 (0.6968) lr 3.6258e-04 eta 0:03:45
epoch [38/50] batch [100/162] time 0.073 (0.111) data 0.000 (0.016) loss 1.2820 (1.2893) ce_loss 0.2842 (0.4247) loss_zs_kd 0.0912 (0.0921) loss_oracle 0.2175 (0.2252) acc 90.6250 (84.8750) kd_loss 0.8435 (0.7059) lr 3.6258e-04 eta 0:03:43
epoch [38/50] batch [120/162] time 0.074 (0.110) data 0.000 (0.013) loss 1.4897 (1.2880) ce_loss 0.5933 (0.4206) loss_zs_kd 0.1247 (0.0916) loss_oracle 0.1979 (0.2240) acc 75.0000 (84.9479) kd_loss 0.7352 (0.7096) lr 3.6258e-04 eta 0:03:38
epoch [38/50] batch [140/162] time 0.084 (0.106) data 0.000 (0.011) loss 1.1100 (1.2895) ce_loss 0.3152 (0.4192) loss_zs_kd 0.1012 (0.0934) loss_oracle 0.1364 (0.2234) acc 87.5000 (84.9107) kd_loss 0.6760 (0.7119) lr 3.6258e-04 eta 0:03:28
epoch [38/50] batch [160/162] time 0.142 (0.104) data 0.000 (0.010) loss 1.4765 (1.2915) ce_loss 0.5386 (0.4216) loss_zs_kd 0.0843 (0.0937) loss_oracle 0.2083 (0.2207) acc 75.0000 (84.6484) kd_loss 0.7916 (0.7128) lr 3.6258e-04 eta 0:03:22
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,968
* accuracy: 88.1%
* error: 11.9%
* macro_f1: 89.9%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,612
* accuracy: 79.6%
* error: 20.4%
* macro_f1: 75.3%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [39/50] batch [20/162] time 0.097 (0.180) data 0.000 (0.081) loss 1.2453 (1.2710) ce_loss 0.4316 (0.3962) loss_zs_kd 0.1256 (0.1033) loss_oracle 0.2416 (0.2175) acc 90.6250 (84.3750) kd_loss 0.6301 (0.7144) lr 3.1545e-04 eta 0:05:46
epoch [39/50] batch [40/162] time 0.096 (0.138) data 0.000 (0.041) loss 1.5867 (1.2890) ce_loss 0.6230 (0.4151) loss_zs_kd 0.1213 (0.1034) loss_oracle 0.2386 (0.2077) acc 71.8750 (84.2188) kd_loss 0.7837 (0.7183) lr 3.1545e-04 eta 0:04:21
epoch [39/50] batch [60/162] time 0.102 (0.124) data 0.000 (0.027) loss 1.2603 (1.3023) ce_loss 0.3677 (0.4173) loss_zs_kd 0.0717 (0.0987) loss_oracle 0.2813 (0.2113) acc 84.3750 (83.6458) kd_loss 0.7161 (0.7299) lr 3.1545e-04 eta 0:03:53
epoch [39/50] batch [80/162] time 0.107 (0.119) data 0.000 (0.020) loss 1.6081 (1.3046) ce_loss 0.6855 (0.4231) loss_zs_kd 0.0709 (0.0954) loss_oracle 0.2336 (0.2132) acc 68.7500 (83.6719) kd_loss 0.7703 (0.7271) lr 3.1545e-04 eta 0:03:41
epoch [39/50] batch [100/162] time 0.090 (0.113) data 0.000 (0.016) loss 1.4289 (1.3086) ce_loss 0.5776 (0.4251) loss_zs_kd 0.0901 (0.0956) loss_oracle 0.2033 (0.2126) acc 78.1250 (83.6250) kd_loss 0.7045 (0.7293) lr 3.1545e-04 eta 0:03:28
epoch [39/50] batch [120/162] time 0.105 (0.110) data 0.000 (0.014) loss 1.4928 (1.3068) ce_loss 0.6079 (0.4199) loss_zs_kd 0.0730 (0.0949) loss_oracle 0.1820 (0.2118) acc 78.1250 (83.9583) kd_loss 0.7573 (0.7336) lr 3.1545e-04 eta 0:03:21
epoch [39/50] batch [140/162] time 0.098 (0.109) data 0.000 (0.012) loss 1.2390 (1.2989) ce_loss 0.4255 (0.4130) loss_zs_kd 0.1356 (0.0964) loss_oracle 0.2076 (0.2108) acc 90.6250 (84.3973) kd_loss 0.6419 (0.7324) lr 3.1545e-04 eta 0:03:16
epoch [39/50] batch [160/162] time 0.095 (0.107) data 0.000 (0.010) loss 1.3587 (1.3016) ce_loss 0.3669 (0.4156) loss_zs_kd 0.1098 (0.0969) loss_oracle 0.2287 (0.2110) acc 87.5000 (84.3945) kd_loss 0.8225 (0.7321) lr 3.1545e-04 eta 0:03:10
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,962
* accuracy: 87.8%
* error: 12.2%
* macro_f1: 89.7%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,604
* accuracy: 79.3%
* error: 20.7%
* macro_f1: 75.1%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [40/50] batch [20/162] time 0.077 (0.173) data 0.000 (0.081) loss 1.3166 (1.2805) ce_loss 0.3523 (0.4100) loss_zs_kd 0.0944 (0.0988) loss_oracle 0.2282 (0.2089) acc 81.2500 (85.4688) kd_loss 0.8030 (0.7166) lr 2.7103e-04 eta 0:05:04
epoch [40/50] batch [40/162] time 0.084 (0.134) data 0.000 (0.040) loss 1.2690 (1.3051) ce_loss 0.4722 (0.4158) loss_zs_kd 0.1028 (0.1001) loss_oracle 0.1627 (0.2087) acc 75.0000 (84.5312) kd_loss 0.6640 (0.7349) lr 2.7103e-04 eta 0:03:53
epoch [40/50] batch [60/162] time 0.105 (0.121) data 0.000 (0.027) loss 1.4049 (1.3100) ce_loss 0.4758 (0.4219) loss_zs_kd 0.0689 (0.0991) loss_oracle 0.2204 (0.2074) acc 81.2500 (85.0521) kd_loss 0.7844 (0.7349) lr 2.7103e-04 eta 0:03:27
epoch [40/50] batch [80/162] time 0.090 (0.114) data 0.000 (0.020) loss 1.3039 (1.3159) ce_loss 0.4307 (0.4342) loss_zs_kd 0.0925 (0.1001) loss_oracle 0.2418 (0.2065) acc 84.3750 (84.2969) kd_loss 0.7061 (0.7284) lr 2.7103e-04 eta 0:03:13
epoch [40/50] batch [100/162] time 0.079 (0.110) data 0.000 (0.016) loss 1.2953 (1.3098) ce_loss 0.2720 (0.4259) loss_zs_kd 0.0558 (0.0979) loss_oracle 0.2846 (0.2076) acc 87.5000 (84.5625) kd_loss 0.8531 (0.7312) lr 2.7103e-04 eta 0:03:04
epoch [40/50] batch [120/162] time 0.080 (0.104) data 0.000 (0.014) loss 1.4261 (1.3114) ce_loss 0.5264 (0.4273) loss_zs_kd 0.0975 (0.0965) loss_oracle 0.2240 (0.2088) acc 84.3750 (84.3750) kd_loss 0.7390 (0.7315) lr 2.7103e-04 eta 0:02:52
epoch [40/50] batch [140/162] time 0.117 (0.101) data 0.000 (0.012) loss 1.1508 (1.3083) ce_loss 0.2898 (0.4259) loss_zs_kd 0.0985 (0.0964) loss_oracle 0.1853 (0.2087) acc 90.6250 (84.4866) kd_loss 0.7191 (0.7298) lr 2.7103e-04 eta 0:02:45
epoch [40/50] batch [160/162] time 0.158 (0.101) data 0.000 (0.010) loss 1.1043 (1.3058) ce_loss 0.2026 (0.4218) loss_zs_kd 0.0901 (0.0962) loss_oracle 0.2538 (0.2096) acc 93.7500 (84.6484) kd_loss 0.7296 (0.7311) lr 2.7103e-04 eta 0:02:43
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,968
* accuracy: 88.1%
* error: 11.9%
* macro_f1: 89.8%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,629
* accuracy: 80.1%
* error: 19.9%
* macro_f1: 76.0%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [41/50] batch [20/162] time 0.128 (0.198) data 0.000 (0.084) loss 1.5455 (1.2995) ce_loss 0.5562 (0.3996) loss_zs_kd 0.1349 (0.0951) loss_oracle 0.1979 (0.2062) acc 81.2500 (84.0625) kd_loss 0.8229 (0.7492) lr 2.2949e-04 eta 0:05:17
epoch [41/50] batch [40/162] time 0.068 (0.154) data 0.000 (0.042) loss 1.3310 (1.3140) ce_loss 0.3748 (0.4148) loss_zs_kd 0.1419 (0.0974) loss_oracle 0.2265 (0.2028) acc 84.3750 (84.7656) kd_loss 0.7720 (0.7490) lr 2.2949e-04 eta 0:04:03
epoch [41/50] batch [60/162] time 0.071 (0.136) data 0.000 (0.028) loss 1.7360 (1.3145) ce_loss 0.9312 (0.4240) loss_zs_kd 0.1324 (0.0985) loss_oracle 0.2313 (0.2047) acc 62.5000 (84.2188) kd_loss 0.6231 (0.7389) lr 2.2949e-04 eta 0:03:31
epoch [41/50] batch [80/162] time 0.068 (0.122) data 0.000 (0.021) loss 1.3059 (1.2972) ce_loss 0.5063 (0.4098) loss_zs_kd 0.0665 (0.0999) loss_oracle 0.1875 (0.2043) acc 84.3750 (84.7266) kd_loss 0.6726 (0.7353) lr 2.2949e-04 eta 0:03:08
epoch [41/50] batch [100/162] time 0.102 (0.118) data 0.000 (0.017) loss 1.1277 (1.3001) ce_loss 0.3528 (0.4130) loss_zs_kd 0.0786 (0.1006) loss_oracle 0.1901 (0.2025) acc 84.3750 (84.8750) kd_loss 0.6406 (0.7356) lr 2.2949e-04 eta 0:02:58
epoch [41/50] batch [120/162] time 0.096 (0.114) data 0.000 (0.014) loss 1.3194 (1.3019) ce_loss 0.4087 (0.4173) loss_zs_kd 0.1105 (0.0992) loss_oracle 0.2302 (0.2033) acc 87.5000 (84.7135) kd_loss 0.7404 (0.7334) lr 2.2949e-04 eta 0:02:50
epoch [41/50] batch [140/162] time 0.104 (0.111) data 0.000 (0.012) loss 1.3386 (1.2979) ce_loss 0.5073 (0.4153) loss_zs_kd 0.0618 (0.0989) loss_oracle 0.1826 (0.2038) acc 84.3750 (84.7768) kd_loss 0.7091 (0.7312) lr 2.2949e-04 eta 0:02:43
epoch [41/50] batch [160/162] time 0.077 (0.108) data 0.000 (0.011) loss 1.1282 (1.2938) ce_loss 0.2766 (0.4145) loss_zs_kd 0.0700 (0.0973) loss_oracle 0.1990 (0.2035) acc 96.8750 (84.8242) kd_loss 0.7171 (0.7289) lr 2.2949e-04 eta 0:02:37
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,969
* accuracy: 88.1%
* error: 11.9%
* macro_f1: 89.9%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,606
* accuracy: 79.4%
* error: 20.6%
* macro_f1: 74.8%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [42/50] batch [20/162] time 0.096 (0.179) data 0.000 (0.082) loss 1.4769 (1.2586) ce_loss 0.5825 (0.4101) loss_zs_kd 0.0986 (0.0910) loss_oracle 0.1544 (0.1933) acc 84.3750 (84.0625) kd_loss 0.7679 (0.7064) lr 1.9098e-04 eta 0:04:17
epoch [42/50] batch [40/162] time 0.115 (0.141) data 0.000 (0.041) loss 1.3951 (1.2584) ce_loss 0.4897 (0.3949) loss_zs_kd 0.0746 (0.0924) loss_oracle 0.2254 (0.1923) acc 78.1250 (84.6875) kd_loss 0.7554 (0.7211) lr 1.9098e-04 eta 0:03:19
epoch [42/50] batch [60/162] time 0.099 (0.127) data 0.000 (0.028) loss 1.1819 (1.2676) ce_loss 0.3306 (0.4075) loss_zs_kd 0.0931 (0.0904) loss_oracle 0.2496 (0.1938) acc 84.3750 (84.3750) kd_loss 0.6800 (0.7179) lr 1.9098e-04 eta 0:02:57
epoch [42/50] batch [80/162] time 0.110 (0.121) data 0.000 (0.021) loss 1.3741 (1.2703) ce_loss 0.5479 (0.4112) loss_zs_kd 0.0842 (0.0930) loss_oracle 0.1782 (0.1949) acc 81.2500 (84.3750) kd_loss 0.6950 (0.7152) lr 1.9098e-04 eta 0:02:46
epoch [42/50] batch [100/162] time 0.087 (0.116) data 0.000 (0.017) loss 1.2613 (1.2623) ce_loss 0.4619 (0.4070) loss_zs_kd 0.1222 (0.0916) loss_oracle 0.1980 (0.1939) acc 68.7500 (84.2188) kd_loss 0.6393 (0.7125) lr 1.9098e-04 eta 0:02:38
epoch [42/50] batch [120/162] time 0.102 (0.113) data 0.000 (0.014) loss 1.3559 (1.2705) ce_loss 0.5073 (0.4113) loss_zs_kd 0.0658 (0.0921) loss_oracle 0.1969 (0.1977) acc 78.1250 (84.1667) kd_loss 0.7172 (0.7143) lr 1.9098e-04 eta 0:02:31
epoch [42/50] batch [140/162] time 0.115 (0.112) data 0.001 (0.012) loss 1.3787 (1.2696) ce_loss 0.5254 (0.4103) loss_zs_kd 0.1154 (0.0936) loss_oracle 0.2000 (0.1984) acc 75.0000 (84.3973) kd_loss 0.6956 (0.7134) lr 1.9098e-04 eta 0:02:27
epoch [42/50] batch [160/162] time 0.076 (0.109) data 0.000 (0.011) loss 1.1696 (1.2771) ce_loss 0.3052 (0.4172) loss_zs_kd 0.1208 (0.0941) loss_oracle 0.1675 (0.1992) acc 90.6250 (84.1211) kd_loss 0.7203 (0.7132) lr 1.9098e-04 eta 0:02:22
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,973
* accuracy: 88.3%
* error: 11.7%
* macro_f1: 90.0%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,620
* accuracy: 79.8%
* error: 20.2%
* macro_f1: 75.1%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [43/50] batch [20/162] time 0.141 (0.198) data 0.000 (0.092) loss 1.1403 (1.2798) ce_loss 0.3726 (0.4260) loss_zs_kd 0.1042 (0.0896) loss_oracle 0.2011 (0.2098) acc 93.7500 (83.7500) kd_loss 0.6151 (0.7041) lr 1.5567e-04 eta 0:04:13
epoch [43/50] batch [40/162] time 0.082 (0.146) data 0.000 (0.046) loss 1.3223 (1.2864) ce_loss 0.4661 (0.4368) loss_zs_kd 0.0747 (0.0875) loss_oracle 0.2710 (0.2079) acc 81.2500 (83.1250) kd_loss 0.6834 (0.7020) lr 1.5567e-04 eta 0:03:03
epoch [43/50] batch [60/162] time 0.153 (0.131) data 0.000 (0.031) loss 1.6900 (1.2705) ce_loss 0.7441 (0.4219) loss_zs_kd 0.1395 (0.0903) loss_oracle 0.2860 (0.2065) acc 68.7500 (83.8021) kd_loss 0.7332 (0.7001) lr 1.5567e-04 eta 0:02:41
epoch [43/50] batch [80/162] time 0.079 (0.119) data 0.000 (0.023) loss 1.3548 (1.2626) ce_loss 0.4973 (0.4119) loss_zs_kd 0.0802 (0.0900) loss_oracle 0.1999 (0.2041) acc 81.2500 (83.9062) kd_loss 0.7174 (0.7037) lr 1.5567e-04 eta 0:02:25
epoch [43/50] batch [100/162] time 0.084 (0.113) data 0.000 (0.019) loss 1.2439 (1.2586) ce_loss 0.3198 (0.4100) loss_zs_kd 0.0681 (0.0899) loss_oracle 0.2003 (0.2063) acc 93.7500 (84.1875) kd_loss 0.7899 (0.7005) lr 1.5567e-04 eta 0:02:14
epoch [43/50] batch [120/162] time 0.145 (0.109) data 0.000 (0.016) loss 1.2827 (1.2665) ce_loss 0.5259 (0.4159) loss_zs_kd 0.1016 (0.0911) loss_oracle 0.2027 (0.2087) acc 75.0000 (84.1667) kd_loss 0.6046 (0.7006) lr 1.5567e-04 eta 0:02:08
epoch [43/50] batch [140/162] time 0.137 (0.108) data 0.000 (0.013) loss 1.2262 (1.2599) ce_loss 0.4214 (0.4109) loss_zs_kd 0.1049 (0.0925) loss_oracle 0.1742 (0.2058) acc 84.3750 (84.5089) kd_loss 0.6653 (0.6999) lr 1.5567e-04 eta 0:02:04
epoch [43/50] batch [160/162] time 0.161 (0.109) data 0.000 (0.012) loss 1.1850 (1.2600) ce_loss 0.3284 (0.4106) loss_zs_kd 0.0913 (0.0921) loss_oracle 0.1828 (0.2050) acc 87.5000 (84.4727) kd_loss 0.7196 (0.7009) lr 1.5567e-04 eta 0:02:04
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,970
* accuracy: 88.2%
* error: 11.8%
* macro_f1: 89.9%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,612
* accuracy: 79.6%
* error: 20.4%
* macro_f1: 74.5%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [44/50] batch [20/162] time 0.106 (0.185) data 0.000 (0.093) loss 1.3366 (1.2255) ce_loss 0.4619 (0.3859) loss_zs_kd 0.1162 (0.0909) loss_oracle 0.1589 (0.1981) acc 78.1250 (85.3125) kd_loss 0.7371 (0.6951) lr 1.2369e-04 eta 0:03:26
epoch [44/50] batch [40/162] time 0.098 (0.140) data 0.000 (0.046) loss 1.2000 (1.2331) ce_loss 0.3430 (0.3840) loss_zs_kd 0.0699 (0.0903) loss_oracle 0.1955 (0.1992) acc 84.3750 (85.4688) kd_loss 0.7243 (0.7043) lr 1.2369e-04 eta 0:02:32
epoch [44/50] batch [60/162] time 0.097 (0.125) data 0.000 (0.031) loss 1.1414 (1.2623) ce_loss 0.2849 (0.4057) loss_zs_kd 0.1082 (0.0899) loss_oracle 0.2158 (0.2027) acc 90.6250 (84.9479) kd_loss 0.6945 (0.7104) lr 1.2369e-04 eta 0:02:14
epoch [44/50] batch [80/162] time 0.103 (0.118) data 0.000 (0.023) loss 1.1776 (1.2747) ce_loss 0.3787 (0.4146) loss_zs_kd 0.0636 (0.0911) loss_oracle 0.1855 (0.2015) acc 84.3750 (84.5703) kd_loss 0.6744 (0.7138) lr 1.2369e-04 eta 0:02:04
epoch [44/50] batch [100/162] time 0.084 (0.114) data 0.000 (0.019) loss 1.2745 (1.2677) ce_loss 0.4026 (0.4056) loss_zs_kd 0.1124 (0.0904) loss_oracle 0.2430 (0.2056) acc 78.1250 (84.7500) kd_loss 0.6942 (0.7142) lr 1.2369e-04 eta 0:01:58
epoch [44/50] batch [120/162] time 0.095 (0.111) data 0.000 (0.016) loss 1.3548 (1.2683) ce_loss 0.4333 (0.4061) loss_zs_kd 0.1071 (0.0913) loss_oracle 0.1801 (0.2041) acc 87.5000 (85.2604) kd_loss 0.7778 (0.7145) lr 1.2369e-04 eta 0:01:52
epoch [44/50] batch [140/162] time 0.095 (0.109) data 0.000 (0.013) loss 1.4113 (1.2785) ce_loss 0.5044 (0.4163) loss_zs_kd 0.0783 (0.0912) loss_oracle 0.2220 (0.2035) acc 81.2500 (84.5759) kd_loss 0.7568 (0.7148) lr 1.2369e-04 eta 0:01:48
epoch [44/50] batch [160/162] time 0.089 (0.107) data 0.000 (0.012) loss 1.5879 (1.2788) ce_loss 0.8052 (0.4180) loss_zs_kd 0.1024 (0.0920) loss_oracle 0.2173 (0.2026) acc 65.6250 (84.5117) kd_loss 0.6229 (0.7135) lr 1.2369e-04 eta 0:01:44
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,965
* accuracy: 88.0%
* error: 12.0%
* macro_f1: 89.8%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,609
* accuracy: 79.5%
* error: 20.5%
* macro_f1: 75.2%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [45/50] batch [20/162] time 0.076 (0.168) data 0.000 (0.075) loss 1.3968 (1.2395) ce_loss 0.5913 (0.4054) loss_zs_kd 0.0956 (0.1009) loss_oracle 0.2440 (0.1906) acc 81.2500 (85.1562) kd_loss 0.6357 (0.6884) lr 9.5173e-05 eta 0:02:39
epoch [45/50] batch [40/162] time 0.093 (0.131) data 0.000 (0.038) loss 1.3323 (1.2783) ce_loss 0.4319 (0.4243) loss_zs_kd 0.0583 (0.0963) loss_oracle 0.2761 (0.2025) acc 90.6250 (84.0625) kd_loss 0.7333 (0.7046) lr 9.5173e-05 eta 0:02:01
epoch [45/50] batch [60/162] time 0.101 (0.118) data 0.000 (0.025) loss 1.0300 (1.2596) ce_loss 0.1559 (0.4035) loss_zs_kd 0.0939 (0.0960) loss_oracle 0.2041 (0.1984) acc 93.7500 (84.8438) kd_loss 0.7251 (0.7089) lr 9.5173e-05 eta 0:01:47
epoch [45/50] batch [80/162] time 0.081 (0.109) data 0.000 (0.019) loss 1.1678 (1.2579) ce_loss 0.2771 (0.3959) loss_zs_kd 0.0756 (0.0966) loss_oracle 0.2426 (0.2008) acc 87.5000 (85.2344) kd_loss 0.7316 (0.7133) lr 9.5173e-05 eta 0:01:37
epoch [45/50] batch [100/162] time 0.075 (0.104) data 0.000 (0.015) loss 1.1750 (1.2571) ce_loss 0.2900 (0.3963) loss_zs_kd 0.1013 (0.0958) loss_oracle 0.2061 (0.2035) acc 93.7500 (84.9062) kd_loss 0.7313 (0.7111) lr 9.5173e-05 eta 0:01:30
epoch [45/50] batch [120/162] time 0.084 (0.103) data 0.001 (0.013) loss 1.2226 (1.2638) ce_loss 0.3120 (0.4017) loss_zs_kd 0.0736 (0.0957) loss_oracle 0.2236 (0.2053) acc 93.7500 (85.0000) kd_loss 0.7620 (0.7117) lr 9.5173e-05 eta 0:01:27
epoch [45/50] batch [140/162] time 0.082 (0.104) data 0.000 (0.011) loss 1.1705 (1.2661) ce_loss 0.2854 (0.4030) loss_zs_kd 0.1070 (0.0963) loss_oracle 0.2151 (0.2049) acc 90.6250 (85.0000) kd_loss 0.7240 (0.7125) lr 9.5173e-05 eta 0:01:26
epoch [45/50] batch [160/162] time 0.069 (0.105) data 0.000 (0.010) loss 1.4500 (1.2706) ce_loss 0.5562 (0.4061) loss_zs_kd 0.1059 (0.0956) loss_oracle 0.2125 (0.2054) acc 78.1250 (84.7852) kd_loss 0.7346 (0.7140) lr 9.5173e-05 eta 0:01:24
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,969
* accuracy: 88.1%
* error: 11.9%
* macro_f1: 89.9%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,623
* accuracy: 79.9%
* error: 20.1%
* macro_f1: 75.2%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [46/50] batch [20/162] time 0.066 (0.175) data 0.000 (0.077) loss 1.3273 (1.3345) ce_loss 0.3772 (0.4527) loss_zs_kd 0.0569 (0.0925) loss_oracle 0.2366 (0.2096) acc 84.3750 (83.9062) kd_loss 0.8034 (0.7308) lr 7.0224e-05 eta 0:02:18
epoch [46/50] batch [40/162] time 0.073 (0.140) data 0.000 (0.039) loss 1.3992 (1.3182) ce_loss 0.5405 (0.4364) loss_zs_kd 0.1215 (0.0952) loss_oracle 0.2109 (0.2028) acc 78.1250 (84.4531) kd_loss 0.6924 (0.7327) lr 7.0224e-05 eta 0:01:47
epoch [46/50] batch [60/162] time 0.069 (0.118) data 0.000 (0.026) loss 1.3890 (1.3007) ce_loss 0.3787 (0.4244) loss_zs_kd 0.0822 (0.0977) loss_oracle 0.2527 (0.2027) acc 84.3750 (84.6875) kd_loss 0.8429 (0.7261) lr 7.0224e-05 eta 0:01:28
epoch [46/50] batch [80/162] time 0.090 (0.107) data 0.000 (0.019) loss 1.2937 (1.2822) ce_loss 0.3706 (0.4080) loss_zs_kd 0.0678 (0.0968) loss_oracle 0.2733 (0.2020) acc 90.6250 (85.4688) kd_loss 0.7525 (0.7249) lr 7.0224e-05 eta 0:01:18
epoch [46/50] batch [100/162] time 0.087 (0.104) data 0.000 (0.016) loss 1.2139 (1.2754) ce_loss 0.4148 (0.4056) loss_zs_kd 0.1196 (0.0943) loss_oracle 0.1655 (0.1993) acc 81.2500 (85.4062) kd_loss 0.6565 (0.7229) lr 7.0224e-05 eta 0:01:14
epoch [46/50] batch [120/162] time 0.097 (0.103) data 0.000 (0.013) loss 1.1853 (1.2846) ce_loss 0.3384 (0.4150) loss_zs_kd 0.0934 (0.0942) loss_oracle 0.1982 (0.2025) acc 87.5000 (85.0000) kd_loss 0.7011 (0.7212) lr 7.0224e-05 eta 0:01:10
epoch [46/50] batch [140/162] time 0.083 (0.100) data 0.000 (0.011) loss 1.2668 (1.2816) ce_loss 0.4370 (0.4145) loss_zs_kd 0.0795 (0.0948) loss_oracle 0.2009 (0.2028) acc 81.2500 (84.6875) kd_loss 0.6896 (0.7183) lr 7.0224e-05 eta 0:01:07
epoch [46/50] batch [160/162] time 0.090 (0.099) data 0.000 (0.010) loss 1.2353 (1.2853) ce_loss 0.4099 (0.4152) loss_zs_kd 0.0974 (0.0938) loss_oracle 0.2199 (0.2028) acc 81.2500 (84.6289) kd_loss 0.6667 (0.7218) lr 7.0224e-05 eta 0:01:04
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,970
* accuracy: 88.2%
* error: 11.8%
* macro_f1: 89.9%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,619
* accuracy: 79.8%
* error: 20.2%
* macro_f1: 75.1%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [47/50] batch [20/162] time 0.103 (0.176) data 0.000 (0.076) loss 1.1551 (1.2444) ce_loss 0.2793 (0.3811) loss_zs_kd 0.1032 (0.0946) loss_oracle 0.2104 (0.1979) acc 87.5000 (85.6250) kd_loss 0.7190 (0.7170) lr 4.8943e-05 eta 0:01:50
epoch [47/50] batch [40/162] time 0.099 (0.140) data 0.001 (0.038) loss 1.4120 (1.2580) ce_loss 0.5186 (0.3919) loss_zs_kd 0.1802 (0.0964) loss_oracle 0.2019 (0.1959) acc 84.3750 (84.9219) kd_loss 0.7024 (0.7200) lr 4.8943e-05 eta 0:01:24
epoch [47/50] batch [60/162] time 0.098 (0.129) data 0.000 (0.025) loss 1.4112 (1.2981) ce_loss 0.5513 (0.4288) loss_zs_kd 0.0834 (0.0957) loss_oracle 0.2146 (0.1966) acc 81.2500 (83.6458) kd_loss 0.7109 (0.7231) lr 4.8943e-05 eta 0:01:15
epoch [47/50] batch [80/162] time 0.106 (0.122) data 0.000 (0.019) loss 1.1649 (1.2860) ce_loss 0.3718 (0.4163) loss_zs_kd 0.1020 (0.0956) loss_oracle 0.1519 (0.2009) acc 84.3750 (84.2969) kd_loss 0.6661 (0.7215) lr 4.8943e-05 eta 0:01:09
epoch [47/50] batch [100/162] time 0.101 (0.118) data 0.000 (0.015) loss 1.3681 (1.2829) ce_loss 0.4629 (0.4106) loss_zs_kd 0.0794 (0.0956) loss_oracle 0.1483 (0.1994) acc 78.1250 (84.5938) kd_loss 0.7913 (0.7248) lr 4.8943e-05 eta 0:01:04
epoch [47/50] batch [120/162] time 0.101 (0.114) data 0.000 (0.013) loss 1.1151 (1.2850) ce_loss 0.2834 (0.4113) loss_zs_kd 0.1030 (0.0957) loss_oracle 0.2126 (0.2009) acc 93.7500 (84.7135) kd_loss 0.6739 (0.7254) lr 4.8943e-05 eta 0:01:00
epoch [47/50] batch [140/162] time 0.100 (0.112) data 0.000 (0.011) loss 1.2445 (1.2819) ce_loss 0.4890 (0.4118) loss_zs_kd 0.1492 (0.0958) loss_oracle 0.1751 (0.2002) acc 81.2500 (84.5982) kd_loss 0.5934 (0.7221) lr 4.8943e-05 eta 0:00:56
epoch [47/50] batch [160/162] time 0.093 (0.110) data 0.000 (0.010) loss 1.3406 (1.2830) ce_loss 0.4080 (0.4115) loss_zs_kd 0.0958 (0.0954) loss_oracle 0.1813 (0.2010) acc 84.3750 (84.7070) kd_loss 0.7941 (0.7232) lr 4.8943e-05 eta 0:00:53
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,972
* accuracy: 88.3%
* error: 11.7%
* macro_f1: 90.0%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,618
* accuracy: 79.8%
* error: 20.2%
* macro_f1: 75.4%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [48/50] batch [20/162] time 0.123 (0.190) data 0.000 (0.077) loss 1.1514 (1.2742) ce_loss 0.3406 (0.4021) loss_zs_kd 0.0777 (0.0983) loss_oracle 0.2252 (0.1984) acc 87.5000 (84.0625) kd_loss 0.6594 (0.7237) lr 3.1417e-05 eta 0:01:28
epoch [48/50] batch [40/162] time 0.089 (0.149) data 0.000 (0.039) loss 1.2354 (1.2612) ce_loss 0.4187 (0.3842) loss_zs_kd 0.0609 (0.0962) loss_oracle 0.1417 (0.1923) acc 90.6250 (84.6875) kd_loss 0.7154 (0.7327) lr 3.1417e-05 eta 0:01:06
epoch [48/50] batch [60/162] time 0.077 (0.130) data 0.000 (0.026) loss 1.3564 (1.2744) ce_loss 0.5366 (0.3948) loss_zs_kd 0.0831 (0.0936) loss_oracle 0.1881 (0.2005) acc 78.1250 (84.7396) kd_loss 0.6842 (0.7326) lr 3.1417e-05 eta 0:00:55
epoch [48/50] batch [80/162] time 0.082 (0.118) data 0.000 (0.020) loss 1.2386 (1.2830) ce_loss 0.3992 (0.4064) loss_zs_kd 0.0952 (0.0944) loss_oracle 0.1989 (0.1997) acc 84.3750 (84.0625) kd_loss 0.6923 (0.7296) lr 3.1417e-05 eta 0:00:47
epoch [48/50] batch [100/162] time 0.091 (0.111) data 0.000 (0.016) loss 1.4851 (1.2882) ce_loss 0.6016 (0.4112) loss_zs_kd 0.1062 (0.0951) loss_oracle 0.2084 (0.1973) acc 78.1250 (84.0938) kd_loss 0.7262 (0.7309) lr 3.1417e-05 eta 0:00:42
epoch [48/50] batch [120/162] time 0.153 (0.111) data 0.000 (0.013) loss 1.2317 (1.2894) ce_loss 0.3733 (0.4177) loss_zs_kd 0.0773 (0.0950) loss_oracle 0.1691 (0.1973) acc 90.6250 (84.1667) kd_loss 0.7352 (0.7256) lr 3.1417e-05 eta 0:00:40
epoch [48/50] batch [140/162] time 0.073 (0.112) data 0.000 (0.011) loss 1.2290 (1.2849) ce_loss 0.3660 (0.4119) loss_zs_kd 0.0685 (0.0946) loss_oracle 0.2401 (0.1982) acc 87.5000 (84.5536) kd_loss 0.7088 (0.7266) lr 3.1417e-05 eta 0:00:38
epoch [48/50] batch [160/162] time 0.067 (0.111) data 0.000 (0.010) loss 1.0545 (1.2881) ce_loss 0.2556 (0.4162) loss_zs_kd 0.1030 (0.0953) loss_oracle 0.1707 (0.1984) acc 93.7500 (84.4922) kd_loss 0.6620 (0.7251) lr 3.1417e-05 eta 0:00:36
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,969
* accuracy: 88.1%
* error: 11.9%
* macro_f1: 89.9%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,624
* accuracy: 80.0%
* error: 20.0%
* macro_f1: 75.5%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [49/50] batch [20/162] time 0.095 (0.176) data 0.000 (0.078) loss 1.1653 (1.2958) ce_loss 0.2727 (0.4428) loss_zs_kd 0.1168 (0.0984) loss_oracle 0.2399 (0.1942) acc 93.7500 (82.5000) kd_loss 0.7142 (0.7067) lr 1.7713e-05 eta 0:00:53
epoch [49/50] batch [40/162] time 0.099 (0.138) data 0.000 (0.039) loss 1.3116 (1.2928) ce_loss 0.4436 (0.4244) loss_zs_kd 0.0832 (0.0947) loss_oracle 0.1900 (0.1957) acc 78.1250 (84.2969) kd_loss 0.7314 (0.7232) lr 1.7713e-05 eta 0:00:39
epoch [49/50] batch [60/162] time 0.104 (0.125) data 0.000 (0.026) loss 1.2365 (1.2906) ce_loss 0.4031 (0.4169) loss_zs_kd 0.0769 (0.0940) loss_oracle 0.2379 (0.2001) acc 84.3750 (84.5312) kd_loss 0.6760 (0.7266) lr 1.7713e-05 eta 0:00:33
epoch [49/50] batch [80/162] time 0.095 (0.118) data 0.000 (0.020) loss 1.3460 (1.2907) ce_loss 0.4934 (0.4181) loss_zs_kd 0.1355 (0.0937) loss_oracle 0.1392 (0.1985) acc 81.2500 (84.8047) kd_loss 0.7153 (0.7265) lr 1.7713e-05 eta 0:00:28
epoch [49/50] batch [100/162] time 0.091 (0.114) data 0.000 (0.016) loss 1.4462 (1.2893) ce_loss 0.5649 (0.4148) loss_zs_kd 0.1013 (0.0944) loss_oracle 0.2309 (0.1987) acc 78.1250 (85.0000) kd_loss 0.7152 (0.7280) lr 1.7713e-05 eta 0:00:25
epoch [49/50] batch [120/162] time 0.092 (0.111) data 0.000 (0.013) loss 1.3075 (1.2948) ce_loss 0.3608 (0.4184) loss_zs_kd 0.1081 (0.0955) loss_oracle 0.2037 (0.1991) acc 90.6250 (84.6615) kd_loss 0.7908 (0.7291) lr 1.7713e-05 eta 0:00:22
epoch [49/50] batch [140/162] time 0.103 (0.109) data 0.000 (0.011) loss 1.3210 (1.2927) ce_loss 0.4136 (0.4132) loss_zs_kd 0.0938 (0.0953) loss_oracle 0.2361 (0.2018) acc 81.2500 (84.6205) kd_loss 0.7425 (0.7309) lr 1.7713e-05 eta 0:00:20
epoch [49/50] batch [160/162] time 0.092 (0.107) data 0.000 (0.010) loss 1.4544 (1.2981) ce_loss 0.6108 (0.4205) loss_zs_kd 0.0803 (0.0965) loss_oracle 0.1737 (0.2009) acc 78.1250 (84.4141) kd_loss 0.7165 (0.7289) lr 1.7713e-05 eta 0:00:17
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,970
* accuracy: 88.2%
* error: 11.8%
* macro_f1: 89.9%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,620
* accuracy: 79.8%
* error: 20.2%
* macro_f1: 75.4%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
epoch [50/50] batch [20/162] time 0.093 (0.181) data 0.000 (0.082) loss 1.3939 (1.2578) ce_loss 0.5078 (0.3786) loss_zs_kd 0.1182 (0.1008) loss_oracle 0.1825 (0.1903) acc 75.0000 (86.4062) kd_loss 0.7357 (0.7336) lr 7.8853e-06 eta 0:00:25
epoch [50/50] batch [40/162] time 0.110 (0.140) data 0.000 (0.041) loss 1.4084 (1.2872) ce_loss 0.4517 (0.4104) loss_zs_kd 0.0874 (0.0992) loss_oracle 0.2766 (0.1921) acc 81.2500 (84.8438) kd_loss 0.7748 (0.7311) lr 7.8853e-06 eta 0:00:17
epoch [50/50] batch [60/162] time 0.096 (0.126) data 0.000 (0.028) loss 1.1412 (1.2660) ce_loss 0.3098 (0.3953) loss_zs_kd 0.0865 (0.0964) loss_oracle 0.1829 (0.1898) acc 84.3750 (85.6250) kd_loss 0.6967 (0.7276) lr 7.8853e-06 eta 0:00:12
epoch [50/50] batch [80/162] time 0.068 (0.114) data 0.000 (0.021) loss 1.4059 (1.2704) ce_loss 0.4541 (0.3982) loss_zs_kd 0.1101 (0.0968) loss_oracle 0.1866 (0.1920) acc 84.3750 (85.5469) kd_loss 0.8034 (0.7278) lr 7.8853e-06 eta 0:00:09
epoch [50/50] batch [100/162] time 0.083 (0.108) data 0.000 (0.017) loss 1.4641 (1.2782) ce_loss 0.5854 (0.4024) loss_zs_kd 0.1544 (0.0974) loss_oracle 0.1715 (0.1941) acc 71.8750 (85.3438) kd_loss 0.7158 (0.7301) lr 7.8853e-06 eta 0:00:06
epoch [50/50] batch [120/162] time 0.080 (0.105) data 0.000 (0.014) loss 1.3026 (1.2824) ce_loss 0.3992 (0.4029) loss_zs_kd 0.0759 (0.0966) loss_oracle 0.1951 (0.1969) acc 81.2500 (85.1302) kd_loss 0.7679 (0.7328) lr 7.8853e-06 eta 0:00:04
epoch [50/50] batch [140/162] time 0.146 (0.105) data 0.000 (0.012) loss 1.6950 (1.2881) ce_loss 0.8374 (0.4068) loss_zs_kd 0.0830 (0.0961) loss_oracle 0.1297 (0.1966) acc 75.0000 (85.2455) kd_loss 0.7512 (0.7350) lr 7.8853e-06 eta 0:00:02
epoch [50/50] batch [160/162] time 0.144 (0.102) data 0.000 (0.010) loss 1.2674 (1.2886) ce_loss 0.3901 (0.4066) loss_zs_kd 0.0949 (0.0959) loss_oracle 0.2102 (0.1983) acc 90.6250 (85.2930) kd_loss 0.7248 (0.7348) lr 7.8853e-06 eta 0:00:00
Evaluate on the *val* set
=> result
* total: 2,234
* correct: 1,969
* accuracy: 88.1%
* error: 11.9%
* macro_f1: 89.9%
Evaluate on the *test* set
=> result
* total: 3,282
* correct: 2,621
* accuracy: 79.9%
* error: 20.1%
* macro_f1: 75.5%
******* Domain s best val acc:      88.3%, epoch: 31 *******
******* Domain s best val test acc: 80.3%, epoch: 31 *******
******* Domain s best test acc:     81.7%, epoch: 4 *******
Checkpoint saved to icml/multi-dg/TRIP/vlcs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:20:50
