Loading trainer: TRIP
Loading dataset: SPG_VLCS
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------
Dataset    SPG_VLCS
Source     ['labelme', 'pascal', 'sun']
Target     ['caltech']
# classes  5
# train_x  6,519
# val      2,795
# test     1,415
---------  ----------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/oracle/02_no_ce/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/203] time 0.075 (0.123) data 0.000 (0.020) loss 0.6218 (0.7938) ce_loss 0.6216 (0.7934) teacher_loss 0.6214 (0.7935) loss_zs_kd 0.0002 (0.0001) loss_oracle 0.0003 (0.0003) acc 68.7500 (70.9375) kd_loss 0.0009 (0.0010) lr 1.0000e-05 eta 0:20:43
epoch [1/50] batch [40/203] time 0.086 (0.100) data 0.000 (0.010) loss 0.7850 (0.7596) ce_loss 0.7837 (0.7591) teacher_loss 0.7843 (0.7592) loss_zs_kd 0.0011 (0.0004) loss_oracle 0.0002 (0.0002) acc 75.0000 (72.2656) kd_loss 0.0006 (0.0008) lr 1.0000e-05 eta 0:16:48
epoch [1/50] batch [60/203] time 0.074 (0.093) data 0.000 (0.007) loss 0.7827 (0.7578) ce_loss 0.7817 (0.7571) teacher_loss 0.7810 (0.7571) loss_zs_kd 0.0030 (0.0009) loss_oracle 0.0002 (0.0002) acc 75.0000 (73.2292) kd_loss 0.0007 (0.0007) lr 1.0000e-05 eta 0:15:42
epoch [1/50] batch [80/203] time 0.083 (0.090) data 0.000 (0.005) loss 0.6878 (0.7287) ce_loss 0.6855 (0.7276) teacher_loss 0.6849 (0.7277) loss_zs_kd 0.0045 (0.0016) loss_oracle 0.0007 (0.0002) acc 71.8750 (74.1016) kd_loss 0.0021 (0.0008) lr 1.0000e-05 eta 0:15:11
epoch [1/50] batch [100/203] time 0.082 (0.089) data 0.000 (0.004) loss 0.8856 (0.7349) ce_loss 0.8823 (0.7333) teacher_loss 0.8819 (0.7334) loss_zs_kd 0.0062 (0.0024) loss_oracle 0.0007 (0.0003) acc 71.8750 (73.8750) kd_loss 0.0024 (0.0010) lr 1.0000e-05 eta 0:14:57
epoch [1/50] batch [120/203] time 0.081 (0.088) data 0.000 (0.004) loss 0.8658 (0.7344) ce_loss 0.8608 (0.7325) teacher_loss 0.8613 (0.7325) loss_zs_kd 0.0078 (0.0031) loss_oracle 0.0006 (0.0004) acc 65.6250 (73.3854) kd_loss 0.0022 (0.0012) lr 1.0000e-05 eta 0:14:45
epoch [1/50] batch [140/203] time 0.083 (0.088) data 0.000 (0.003) loss 0.5954 (0.7288) ce_loss 0.5908 (0.7265) teacher_loss 0.5906 (0.7265) loss_zs_kd 0.0080 (0.0038) loss_oracle 0.0008 (0.0004) acc 78.1250 (73.7054) kd_loss 0.0030 (0.0013) lr 1.0000e-05 eta 0:14:38
epoch [1/50] batch [160/203] time 0.083 (0.088) data 0.000 (0.003) loss 0.6195 (0.7282) ce_loss 0.6162 (0.7255) teacher_loss 0.6154 (0.7255) loss_zs_kd 0.0063 (0.0044) loss_oracle 0.0010 (0.0005) acc 78.1250 (73.8477) kd_loss 0.0035 (0.0016) lr 1.0000e-05 eta 0:14:34
epoch [1/50] batch [180/203] time 0.083 (0.087) data 0.000 (0.002) loss 0.8695 (0.7363) ce_loss 0.8643 (0.7334) teacher_loss 0.8645 (0.7333) loss_zs_kd 0.0087 (0.0049) loss_oracle 0.0007 (0.0005) acc 65.6250 (73.6979) kd_loss 0.0020 (0.0018) lr 1.0000e-05 eta 0:14:28
epoch [1/50] batch [200/203] time 0.069 (0.086) data 0.000 (0.002) loss 0.6561 (0.7287) ce_loss 0.6494 (0.7256) teacher_loss 0.6489 (0.7256) loss_zs_kd 0.0122 (0.0052) loss_oracle 0.0011 (0.0006) acc 75.0000 (73.9062) kd_loss 0.0037 (0.0020) lr 1.0000e-05 eta 0:14:14
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,212
* accuracy: 79.1%
* error: 20.9%
* macro_f1: 82.8%
Checkpoint saved to icml/multi-dg/oracle/02_no_ce/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
Checkpoint saved to icml/multi-dg/oracle/02_no_ce/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain c best val acc:      79.1%, epoch: 1 *******
******* Domain c best val test acc: 100.0%, epoch: 1 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/oracle/02_no_ce/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/ana
epoch [2/50] batch [20/203] time 0.088 (0.110) data 0.000 (0.025) loss 0.9040 (0.7222) ce_loss 0.8315 (0.6728) teacher_loss 0.8251 (0.6729) loss_zs_kd 0.0574 (0.0556) loss_oracle 0.0503 (0.0215) acc 68.7500 (75.4688) kd_loss 0.0558 (0.0154) lr 2.0000e-03 eta 0:18:15
epoch [2/50] batch [40/203] time 0.086 (0.098) data 0.000 (0.013) loss 0.5743 (0.6946) ce_loss 0.4526 (0.6301) teacher_loss 0.4224 (0.6233) loss_zs_kd 0.0909 (0.0699) loss_oracle 0.1064 (0.0364) acc 81.2500 (77.5000) kd_loss 0.1399 (0.0541) lr 2.0000e-03 eta 0:16:12
epoch [2/50] batch [60/203] time 0.070 (0.092) data 0.000 (0.009) loss 0.7326 (0.7163) ce_loss 0.5264 (0.6260) teacher_loss 0.4645 (0.6120) loss_zs_kd 0.1514 (0.0754) loss_oracle 0.1923 (0.0666) acc 71.8750 (77.0833) kd_loss 0.3058 (0.0982) lr 2.0000e-03 eta 0:15:07
epoch [2/50] batch [80/203] time 0.086 (0.089) data 0.000 (0.006) loss 0.8400 (0.7278) ce_loss 0.6802 (0.6133) teacher_loss 0.5550 (0.5906) loss_zs_kd 0.1012 (0.0786) loss_oracle 0.2344 (0.0979) acc 68.7500 (77.1484) kd_loss 0.6450 (0.1845) lr 2.0000e-03 eta 0:14:37
epoch [2/50] batch [100/203] time 0.085 (0.087) data 0.000 (0.005) loss 0.7111 (0.7587) ce_loss 0.5327 (0.6201) teacher_loss 0.5032 (0.5950) loss_zs_kd 0.0418 (0.0766) loss_oracle 0.1870 (0.1253) acc 84.3750 (76.7500) kd_loss 0.9085 (0.3154) lr 2.0000e-03 eta 0:14:20
epoch [2/50] batch [120/203] time 0.070 (0.085) data 0.000 (0.004) loss 0.6675 (0.7763) ce_loss 0.5264 (0.6273) teacher_loss 0.4738 (0.5994) loss_zs_kd 0.0443 (0.0709) loss_oracle 0.1715 (0.1414) acc 81.2500 (76.8229) kd_loss 0.9958 (0.4247) lr 2.0000e-03 eta 0:13:54
epoch [2/50] batch [140/203] time 0.087 (0.084) data 0.000 (0.004) loss 1.0570 (0.7748) ce_loss 1.0078 (0.6317) teacher_loss 0.8552 (0.5982) loss_zs_kd 0.0876 (0.0687) loss_oracle 0.1580 (0.1423) acc 68.7500 (77.0089) kd_loss 1.0109 (0.5046) lr 2.0000e-03 eta 0:13:41
epoch [2/50] batch [160/203] time 0.061 (0.082) data 0.000 (0.003) loss 0.5805 (0.7697) ce_loss 0.4841 (0.6352) teacher_loss 0.4560 (0.5956) loss_zs_kd 0.0624 (0.0680) loss_oracle 0.0933 (0.1401) acc 78.1250 (76.8359) kd_loss 0.8366 (0.5610) lr 2.0000e-03 eta 0:13:24
epoch [2/50] batch [180/203] time 0.079 (0.081) data 0.000 (0.003) loss 0.5670 (0.7590) ce_loss 0.5024 (0.6290) teacher_loss 0.4330 (0.5865) loss_zs_kd 0.0354 (0.0667) loss_oracle 0.1164 (0.1392) acc 84.3750 (76.9965) kd_loss 0.8633 (0.5986) lr 2.0000e-03 eta 0:13:13
epoch [2/50] batch [200/203] time 0.072 (0.080) data 0.000 (0.003) loss 1.1120 (0.7614) ce_loss 1.0107 (0.6329) teacher_loss 0.8872 (0.5866) loss_zs_kd 0.0910 (0.0672) loss_oracle 0.1793 (0.1413) acc 65.6250 (76.7656) kd_loss 0.8235 (0.6217) lr 2.0000e-03 eta 0:12:56
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,298
* accuracy: 82.2%
* error: 17.8%
* macro_f1: 85.8%
Checkpoint saved to icml/multi-dg/oracle/02_no_ce/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      82.2%, epoch: 2 *******
******* Domain c best val test acc: 100.0%, epoch: 2 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [3/50] batch [20/203] time 0.080 (0.096) data 0.000 (0.015) loss 0.9530 (0.7073) ce_loss 0.7969 (0.5283) teacher_loss 0.6332 (0.4508) loss_zs_kd 0.1820 (0.1016) loss_oracle 0.2288 (0.2057) acc 71.8750 (80.6250) kd_loss 0.7738 (0.7838) lr 1.9980e-03 eta 0:15:32
epoch [3/50] batch [40/203] time 0.077 (0.088) data 0.000 (0.008) loss 0.8451 (0.7523) ce_loss 0.6460 (0.5677) teacher_loss 0.5219 (0.4680) loss_zs_kd 0.1579 (0.1086) loss_oracle 0.2442 (0.2300) acc 78.1250 (79.1406) kd_loss 0.7866 (0.7848) lr 1.9980e-03 eta 0:14:12
epoch [3/50] batch [60/203] time 0.073 (0.082) data 0.000 (0.005) loss 0.6415 (0.7494) ce_loss 0.4565 (0.5632) teacher_loss 0.3535 (0.4610) loss_zs_kd 0.1133 (0.1110) loss_oracle 0.2313 (0.2330) acc 81.2500 (79.3229) kd_loss 0.8063 (0.7943) lr 1.9980e-03 eta 0:13:16
epoch [3/50] batch [80/203] time 0.080 (0.080) data 0.000 (0.004) loss 0.8808 (0.7578) ce_loss 0.7617 (0.5710) teacher_loss 0.5399 (0.4614) loss_zs_kd 0.1042 (0.1131) loss_oracle 0.2889 (0.2399) acc 68.7500 (78.3594) kd_loss 0.8605 (0.7986) lr 1.9980e-03 eta 0:12:54
epoch [3/50] batch [100/203] time 0.066 (0.078) data 0.000 (0.003) loss 0.9875 (0.7697) ce_loss 0.6279 (0.5772) teacher_loss 0.5922 (0.4646) loss_zs_kd 0.1342 (0.1142) loss_oracle 0.3282 (0.2481) acc 75.0000 (78.1875) kd_loss 0.8376 (0.8003) lr 1.9980e-03 eta 0:12:32
epoch [3/50] batch [120/203] time 0.090 (0.078) data 0.000 (0.003) loss 0.9186 (0.7814) ce_loss 0.7842 (0.5846) teacher_loss 0.5396 (0.4649) loss_zs_kd 0.1268 (0.1201) loss_oracle 0.3156 (0.2564) acc 71.8750 (77.7083) kd_loss 0.8489 (0.8029) lr 1.9980e-03 eta 0:12:27
epoch [3/50] batch [140/203] time 0.074 (0.077) data 0.000 (0.002) loss 0.7169 (0.7925) ce_loss 0.4087 (0.5883) teacher_loss 0.3641 (0.4660) loss_zs_kd 0.0804 (0.1205) loss_oracle 0.3127 (0.2663) acc 75.0000 (77.6116) kd_loss 0.7517 (0.8049) lr 1.9980e-03 eta 0:12:20
epoch [3/50] batch [160/203] time 0.064 (0.076) data 0.000 (0.002) loss 1.0010 (0.8016) ce_loss 0.9360 (0.5938) teacher_loss 0.6580 (0.4662) loss_zs_kd 0.1078 (0.1237) loss_oracle 0.2891 (0.2736) acc 62.5000 (77.3047) kd_loss 0.9600 (0.8121) lr 1.9980e-03 eta 0:12:07
epoch [3/50] batch [180/203] time 0.064 (0.075) data 0.000 (0.002) loss 0.7561 (0.8054) ce_loss 0.2922 (0.5911) teacher_loss 0.2476 (0.4612) loss_zs_kd 0.1653 (0.1254) loss_oracle 0.4258 (0.2815) acc 90.6250 (77.5347) kd_loss 0.9063 (0.8188) lr 1.9980e-03 eta 0:11:57
epoch [3/50] batch [200/203] time 0.061 (0.075) data 0.000 (0.002) loss 0.8998 (0.8050) ce_loss 0.5200 (0.5883) teacher_loss 0.3904 (0.4499) loss_zs_kd 0.1834 (0.1288) loss_oracle 0.4177 (0.2907) acc 84.3750 (77.6875) kd_loss 0.8917 (0.8238) lr 1.9980e-03 eta 0:11:51
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,317
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 86.6%
Checkpoint saved to icml/multi-dg/oracle/02_no_ce/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      82.9%, epoch: 3 *******
******* Domain c best val test acc: 100.0%, epoch: 3 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [4/50] batch [20/203] time 0.066 (0.095) data 0.000 (0.014) loss 0.8265 (0.9065) ce_loss 0.5469 (0.6292) teacher_loss 0.3952 (0.4461) loss_zs_kd 0.1517 (0.1538) loss_oracle 0.3554 (0.3835) acc 78.1250 (77.3438) kd_loss 0.8964 (0.8805) lr 1.9921e-03 eta 0:15:05
epoch [4/50] batch [40/203] time 0.082 (0.086) data 0.000 (0.007) loss 0.7289 (0.8724) ce_loss 0.3445 (0.5965) teacher_loss 0.1640 (0.3885) loss_zs_kd 0.1330 (0.1643) loss_oracle 0.4983 (0.4017) acc 90.6250 (78.9844) kd_loss 0.8991 (0.8910) lr 1.9921e-03 eta 0:13:36
epoch [4/50] batch [60/203] time 0.061 (0.081) data 0.001 (0.005) loss 0.8997 (0.8647) ce_loss 0.6670 (0.5887) teacher_loss 0.4563 (0.3688) loss_zs_kd 0.1838 (0.1768) loss_oracle 0.3515 (0.4075) acc 75.0000 (78.9062) kd_loss 0.9196 (0.8987) lr 1.9921e-03 eta 0:12:49
epoch [4/50] batch [80/203] time 0.072 (0.078) data 0.000 (0.004) loss 0.8106 (0.8570) ce_loss 0.4963 (0.5886) teacher_loss 0.3454 (0.3646) loss_zs_kd 0.1404 (0.1747) loss_oracle 0.3950 (0.4050) acc 84.3750 (78.9453) kd_loss 0.9699 (0.8994) lr 1.9921e-03 eta 0:12:14
epoch [4/50] batch [100/203] time 0.062 (0.076) data 0.000 (0.003) loss 0.8400 (0.8562) ce_loss 0.6343 (0.5916) teacher_loss 0.2762 (0.3537) loss_zs_kd 0.2825 (0.1796) loss_oracle 0.4226 (0.4127) acc 71.8750 (78.6250) kd_loss 0.9282 (0.9010) lr 1.9921e-03 eta 0:11:57
epoch [4/50] batch [120/203] time 0.077 (0.075) data 0.000 (0.003) loss 0.8603 (0.8632) ce_loss 0.6919 (0.5982) teacher_loss 0.3603 (0.3553) loss_zs_kd 0.1661 (0.1819) loss_oracle 0.4170 (0.4169) acc 81.2500 (78.2552) kd_loss 0.9095 (0.9049) lr 1.9921e-03 eta 0:11:46
epoch [4/50] batch [140/203] time 0.075 (0.075) data 0.001 (0.002) loss 0.7673 (0.8618) ce_loss 0.6035 (0.5907) teacher_loss 0.3727 (0.3502) loss_zs_kd 0.1097 (0.1817) loss_oracle 0.3397 (0.4208) acc 81.2500 (78.4152) kd_loss 0.9091 (0.9082) lr 1.9921e-03 eta 0:11:43
epoch [4/50] batch [160/203] time 0.096 (0.076) data 0.001 (0.002) loss 1.0011 (0.8596) ce_loss 0.7046 (0.5860) teacher_loss 0.5145 (0.3462) loss_zs_kd 0.1744 (0.1813) loss_oracle 0.3994 (0.4227) acc 81.2500 (78.4766) kd_loss 0.8804 (0.9094) lr 1.9921e-03 eta 0:11:48
epoch [4/50] batch [180/203] time 0.064 (0.075) data 0.000 (0.002) loss 0.8768 (0.8597) ce_loss 0.4006 (0.5822) teacher_loss 0.3005 (0.3452) loss_zs_kd 0.1525 (0.1796) loss_oracle 0.5000 (0.4247) acc 84.3750 (78.5764) kd_loss 0.8834 (0.9107) lr 1.9921e-03 eta 0:11:46
epoch [4/50] batch [200/203] time 0.065 (0.075) data 0.000 (0.002) loss 1.1314 (0.8631) ce_loss 0.7891 (0.5844) teacher_loss 0.5988 (0.3456) loss_zs_kd 0.2104 (0.1794) loss_oracle 0.4274 (0.4278) acc 75.0000 (78.5000) kd_loss 0.9061 (0.9124) lr 1.9921e-03 eta 0:11:36
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,307
* accuracy: 82.5%
* error: 17.5%
* macro_f1: 86.1%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      82.9%, epoch: 3 *******
******* Domain c best val test acc: 100.0%, epoch: 3 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [5/50] batch [20/203] time 0.066 (0.094) data 0.000 (0.016) loss 0.7500 (0.8720) ce_loss 0.4832 (0.6022) teacher_loss 0.1955 (0.3547) loss_zs_kd 0.2073 (0.1695) loss_oracle 0.4508 (0.4326) acc 81.2500 (76.7188) kd_loss 0.9561 (0.9224) lr 1.9823e-03 eta 0:14:40
epoch [5/50] batch [40/203] time 0.085 (0.088) data 0.000 (0.008) loss 0.9737 (0.8736) ce_loss 0.5986 (0.5915) teacher_loss 0.3956 (0.3420) loss_zs_kd 0.1732 (0.1767) loss_oracle 0.4915 (0.4433) acc 75.0000 (78.2812) kd_loss 0.9597 (0.9219) lr 1.9823e-03 eta 0:13:34
epoch [5/50] batch [60/203] time 0.088 (0.086) data 0.001 (0.006) loss 0.7813 (0.8754) ce_loss 0.5356 (0.5889) teacher_loss 0.3234 (0.3450) loss_zs_kd 0.1192 (0.1734) loss_oracle 0.3983 (0.4437) acc 78.1250 (78.4896) kd_loss 0.9351 (0.9296) lr 1.9823e-03 eta 0:13:17
epoch [5/50] batch [80/203] time 0.090 (0.086) data 0.000 (0.004) loss 0.8484 (0.8788) ce_loss 0.5820 (0.5821) teacher_loss 0.3243 (0.3469) loss_zs_kd 0.1933 (0.1695) loss_oracle 0.4274 (0.4472) acc 75.0000 (78.6719) kd_loss 0.9175 (0.9307) lr 1.9823e-03 eta 0:13:14
epoch [5/50] batch [100/203] time 0.100 (0.086) data 0.000 (0.003) loss 0.6548 (0.8814) ce_loss 0.2576 (0.5868) teacher_loss 0.1876 (0.3501) loss_zs_kd 0.1141 (0.1678) loss_oracle 0.4101 (0.4474) acc 93.7500 (78.7500) kd_loss 0.8807 (0.9293) lr 1.9823e-03 eta 0:13:16
epoch [5/50] batch [120/203] time 0.088 (0.086) data 0.000 (0.003) loss 0.7610 (0.8906) ce_loss 0.3623 (0.5978) teacher_loss 0.2397 (0.3548) loss_zs_kd 0.1410 (0.1704) loss_oracle 0.4508 (0.4506) acc 87.5000 (78.4896) kd_loss 0.9212 (0.9295) lr 1.9823e-03 eta 0:13:11
epoch [5/50] batch [140/203] time 0.081 (0.085) data 0.000 (0.003) loss 0.8073 (0.8945) ce_loss 0.4583 (0.5937) teacher_loss 0.1773 (0.3526) loss_zs_kd 0.2442 (0.1729) loss_oracle 0.5079 (0.4554) acc 87.5000 (78.3929) kd_loss 0.9753 (0.9317) lr 1.9823e-03 eta 0:13:05
epoch [5/50] batch [160/203] time 0.087 (0.085) data 0.000 (0.002) loss 0.7494 (0.8962) ce_loss 0.3240 (0.5911) teacher_loss 0.2656 (0.3576) loss_zs_kd 0.1163 (0.1690) loss_oracle 0.4257 (0.4541) acc 90.6250 (78.4570) kd_loss 0.8706 (0.9312) lr 1.9823e-03 eta 0:13:01
epoch [5/50] batch [180/203] time 0.084 (0.085) data 0.000 (0.002) loss 0.7961 (0.8953) ce_loss 0.3940 (0.5865) teacher_loss 0.2240 (0.3549) loss_zs_kd 0.1468 (0.1678) loss_oracle 0.4987 (0.4565) acc 90.6250 (78.6458) kd_loss 0.9353 (0.9321) lr 1.9823e-03 eta 0:13:02
epoch [5/50] batch [200/203] time 0.070 (0.085) data 0.000 (0.002) loss 0.7444 (0.8972) ce_loss 0.3137 (0.5879) teacher_loss 0.1705 (0.3562) loss_zs_kd 0.1757 (0.1669) loss_oracle 0.4860 (0.4576) acc 84.3750 (78.7656) kd_loss 0.9040 (0.9331) lr 1.9823e-03 eta 0:12:53
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,313
* accuracy: 82.8%
* error: 17.2%
* macro_f1: 86.3%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      82.9%, epoch: 3 *******
******* Domain c best val test acc: 100.0%, epoch: 3 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [6/50] batch [20/203] time 0.078 (0.100) data 0.000 (0.015) loss 0.8813 (0.9009) ce_loss 0.5972 (0.5571) teacher_loss 0.4307 (0.3438) loss_zs_kd 0.1262 (0.1704) loss_oracle 0.3875 (0.4720) acc 81.2500 (79.2188) kd_loss 0.9422 (0.9376) lr 1.9686e-03 eta 0:15:07
epoch [6/50] batch [40/203] time 0.069 (0.089) data 0.000 (0.007) loss 0.7560 (0.9089) ce_loss 0.4590 (0.5879) teacher_loss 0.2450 (0.3548) loss_zs_kd 0.1755 (0.1750) loss_oracle 0.4233 (0.4666) acc 84.3750 (78.0469) kd_loss 0.9223 (0.9425) lr 1.9686e-03 eta 0:13:28
epoch [6/50] batch [60/203] time 0.077 (0.084) data 0.000 (0.005) loss 0.8305 (0.8970) ce_loss 0.4880 (0.5753) teacher_loss 0.3126 (0.3487) loss_zs_kd 0.1856 (0.1739) loss_oracle 0.4251 (0.4613) acc 81.2500 (79.2188) kd_loss 0.8677 (0.9399) lr 1.9686e-03 eta 0:12:46
epoch [6/50] batch [80/203] time 0.062 (0.081) data 0.000 (0.004) loss 0.8106 (0.9027) ce_loss 0.5405 (0.5796) teacher_loss 0.2532 (0.3497) loss_zs_kd 0.1697 (0.1719) loss_oracle 0.4725 (0.4670) acc 81.2500 (78.9062) kd_loss 0.9574 (0.9390) lr 1.9686e-03 eta 0:12:09
epoch [6/50] batch [100/203] time 0.086 (0.081) data 0.000 (0.003) loss 0.8809 (0.9056) ce_loss 0.6841 (0.5829) teacher_loss 0.3869 (0.3496) loss_zs_kd 0.1683 (0.1739) loss_oracle 0.4099 (0.4691) acc 71.8750 (79.1250) kd_loss 0.8829 (0.9372) lr 1.9686e-03 eta 0:12:10
epoch [6/50] batch [120/203] time 0.083 (0.081) data 0.001 (0.003) loss 0.9708 (0.9075) ce_loss 0.6602 (0.5865) teacher_loss 0.4443 (0.3555) loss_zs_kd 0.1571 (0.1716) loss_oracle 0.4480 (0.4661) acc 68.7500 (79.1146) kd_loss 0.9964 (0.9374) lr 1.9686e-03 eta 0:12:11
epoch [6/50] batch [140/203] time 0.087 (0.082) data 0.000 (0.002) loss 1.0911 (0.9108) ce_loss 0.6143 (0.5891) teacher_loss 0.4303 (0.3618) loss_zs_kd 0.1644 (0.1709) loss_oracle 0.5786 (0.4635) acc 71.8750 (78.9732) kd_loss 0.9543 (0.9353) lr 1.9686e-03 eta 0:12:14
epoch [6/50] batch [160/203] time 0.085 (0.082) data 0.000 (0.002) loss 1.0875 (0.9118) ce_loss 0.8486 (0.5905) teacher_loss 0.5365 (0.3639) loss_zs_kd 0.1148 (0.1701) loss_oracle 0.4936 (0.4628) acc 78.1250 (79.0234) kd_loss 0.9674 (0.9333) lr 1.9686e-03 eta 0:12:16
epoch [6/50] batch [180/203] time 0.081 (0.082) data 0.000 (0.002) loss 0.8196 (0.9128) ce_loss 0.4502 (0.5888) teacher_loss 0.2821 (0.3648) loss_zs_kd 0.1282 (0.1690) loss_oracle 0.4734 (0.4635) acc 84.3750 (78.9931) kd_loss 0.9111 (0.9313) lr 1.9686e-03 eta 0:12:15
epoch [6/50] batch [200/203] time 0.071 (0.082) data 0.000 (0.002) loss 0.9851 (0.9173) ce_loss 0.6050 (0.5947) teacher_loss 0.3984 (0.3693) loss_zs_kd 0.1808 (0.1686) loss_oracle 0.4962 (0.4637) acc 75.0000 (78.7969) kd_loss 0.9097 (0.9323) lr 1.9686e-03 eta 0:12:09
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,306
* accuracy: 82.5%
* error: 17.5%
* macro_f1: 86.1%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      82.9%, epoch: 3 *******
******* Domain c best val test acc: 100.0%, epoch: 3 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [7/50] batch [20/203] time 0.092 (0.103) data 0.000 (0.016) loss 0.7453 (0.9191) ce_loss 0.4138 (0.5955) teacher_loss 0.2719 (0.3821) loss_zs_kd 0.1501 (0.1658) loss_oracle 0.3983 (0.4540) acc 90.6250 (77.1875) kd_loss 0.8827 (0.9221) lr 1.9511e-03 eta 0:15:13
epoch [7/50] batch [40/203] time 0.096 (0.093) data 0.001 (0.008) loss 0.7299 (0.8953) ce_loss 0.3630 (0.5730) teacher_loss 0.2201 (0.3593) loss_zs_kd 0.1528 (0.1642) loss_oracle 0.4334 (0.4539) acc 90.6250 (77.9688) kd_loss 0.8779 (0.9270) lr 1.9511e-03 eta 0:13:50
epoch [7/50] batch [60/203] time 0.078 (0.090) data 0.000 (0.006) loss 0.8641 (0.8996) ce_loss 0.6143 (0.5745) teacher_loss 0.3490 (0.3679) loss_zs_kd 0.1796 (0.1641) loss_oracle 0.4253 (0.4496) acc 84.3750 (78.6979) kd_loss 0.9392 (0.9283) lr 1.9511e-03 eta 0:13:22
epoch [7/50] batch [80/203] time 0.080 (0.089) data 0.000 (0.004) loss 0.9055 (0.9030) ce_loss 0.5005 (0.5769) teacher_loss 0.3553 (0.3691) loss_zs_kd 0.1737 (0.1653) loss_oracle 0.4634 (0.4512) acc 78.1250 (78.4375) kd_loss 0.9655 (0.9275) lr 1.9511e-03 eta 0:13:06
epoch [7/50] batch [100/203] time 0.080 (0.088) data 0.000 (0.003) loss 0.7989 (0.9008) ce_loss 0.4292 (0.5741) teacher_loss 0.3403 (0.3733) loss_zs_kd 0.1343 (0.1641) loss_oracle 0.3915 (0.4454) acc 75.0000 (78.7188) kd_loss 0.9342 (0.9277) lr 1.9511e-03 eta 0:12:58
epoch [7/50] batch [120/203] time 0.078 (0.087) data 0.000 (0.003) loss 0.9186 (0.8938) ce_loss 0.5991 (0.5711) teacher_loss 0.3692 (0.3695) loss_zs_kd 0.1341 (0.1647) loss_oracle 0.4824 (0.4419) acc 81.2500 (78.8542) kd_loss 0.9595 (0.9290) lr 1.9511e-03 eta 0:12:49
epoch [7/50] batch [140/203] time 0.082 (0.086) data 0.000 (0.003) loss 0.8889 (0.8869) ce_loss 0.5063 (0.5653) teacher_loss 0.2647 (0.3604) loss_zs_kd 0.1762 (0.1669) loss_oracle 0.5361 (0.4431) acc 84.3750 (79.0848) kd_loss 0.9766 (0.9304) lr 1.9511e-03 eta 0:12:38
epoch [7/50] batch [160/203] time 0.078 (0.086) data 0.000 (0.002) loss 1.2300 (0.8907) ce_loss 1.0322 (0.5711) teacher_loss 0.6890 (0.3666) loss_zs_kd 0.1743 (0.1663) loss_oracle 0.4538 (0.4409) acc 68.7500 (78.8867) kd_loss 0.9581 (0.9332) lr 1.9511e-03 eta 0:12:34
epoch [7/50] batch [180/203] time 0.081 (0.086) data 0.000 (0.002) loss 1.0656 (0.8897) ce_loss 0.7466 (0.5678) teacher_loss 0.4688 (0.3650) loss_zs_kd 0.1440 (0.1670) loss_oracle 0.5247 (0.4411) acc 75.0000 (78.9757) kd_loss 0.9624 (0.9327) lr 1.9511e-03 eta 0:12:29
epoch [7/50] batch [200/203] time 0.071 (0.085) data 0.000 (0.002) loss 0.8849 (0.8900) ce_loss 0.5527 (0.5678) teacher_loss 0.3458 (0.3669) loss_zs_kd 0.1820 (0.1668) loss_oracle 0.4481 (0.4398) acc 75.0000 (78.9062) kd_loss 0.9105 (0.9316) lr 1.9511e-03 eta 0:12:20
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,318
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 86.4%
Checkpoint saved to icml/multi-dg/oracle/02_no_ce/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      82.9%, epoch: 7 *******
******* Domain c best val test acc: 100.0%, epoch: 7 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [8/50] batch [20/203] time 0.091 (0.092) data 0.000 (0.012) loss 0.8694 (0.8453) ce_loss 0.7095 (0.5598) teacher_loss 0.4270 (0.3558) loss_zs_kd 0.1674 (0.1466) loss_oracle 0.3587 (0.4162) acc 75.0000 (79.5312) kd_loss 0.8721 (0.9339) lr 1.9298e-03 eta 0:13:23
epoch [8/50] batch [40/203] time 0.084 (0.088) data 0.000 (0.006) loss 0.8655 (0.8690) ce_loss 0.3630 (0.5804) teacher_loss 0.3004 (0.3616) loss_zs_kd 0.1715 (0.1606) loss_oracle 0.4794 (0.4271) acc 84.3750 (78.7500) kd_loss 0.9596 (0.9457) lr 1.9298e-03 eta 0:12:45
epoch [8/50] batch [60/203] time 0.082 (0.087) data 0.000 (0.004) loss 0.7914 (0.8903) ce_loss 0.4263 (0.6015) teacher_loss 0.3673 (0.3707) loss_zs_kd 0.1491 (0.1717) loss_oracle 0.3495 (0.4337) acc 84.3750 (77.7604) kd_loss 0.8657 (0.9456) lr 1.9298e-03 eta 0:12:30
epoch [8/50] batch [80/203] time 0.091 (0.086) data 0.001 (0.003) loss 0.9650 (0.8830) ce_loss 0.7783 (0.5990) teacher_loss 0.4303 (0.3665) loss_zs_kd 0.2166 (0.1715) loss_oracle 0.4263 (0.4308) acc 68.7500 (77.9688) kd_loss 1.0058 (0.9480) lr 1.9298e-03 eta 0:12:24
epoch [8/50] batch [100/203] time 0.083 (0.085) data 0.000 (0.003) loss 0.8036 (0.8712) ce_loss 0.4482 (0.5890) teacher_loss 0.2096 (0.3547) loss_zs_kd 0.2053 (0.1714) loss_oracle 0.4913 (0.4308) acc 81.2500 (78.5312) kd_loss 0.9750 (0.9480) lr 1.9298e-03 eta 0:12:15
epoch [8/50] batch [120/203] time 0.086 (0.085) data 0.000 (0.002) loss 0.8623 (0.8633) ce_loss 0.4502 (0.5812) teacher_loss 0.4175 (0.3518) loss_zs_kd 0.1703 (0.1736) loss_oracle 0.3595 (0.4247) acc 90.6250 (78.8281) kd_loss 0.9284 (0.9431) lr 1.9298e-03 eta 0:12:14
epoch [8/50] batch [140/203] time 0.086 (0.085) data 0.000 (0.002) loss 0.9665 (0.8622) ce_loss 0.7017 (0.5815) teacher_loss 0.4919 (0.3514) loss_zs_kd 0.1988 (0.1737) loss_oracle 0.3753 (0.4240) acc 75.0000 (78.6161) kd_loss 0.8487 (0.9448) lr 1.9298e-03 eta 0:12:12
epoch [8/50] batch [160/203] time 0.093 (0.085) data 0.000 (0.002) loss 0.8789 (0.8567) ce_loss 0.7661 (0.5769) teacher_loss 0.4185 (0.3506) loss_zs_kd 0.1402 (0.1728) loss_oracle 0.3904 (0.4197) acc 71.8750 (78.7695) kd_loss 0.9402 (0.9449) lr 1.9298e-03 eta 0:12:10
epoch [8/50] batch [180/203] time 0.082 (0.085) data 0.000 (0.002) loss 0.7623 (0.8553) ce_loss 0.5469 (0.5758) teacher_loss 0.2893 (0.3508) loss_zs_kd 0.1623 (0.1726) loss_oracle 0.3918 (0.4182) acc 87.5000 (78.9757) kd_loss 1.0264 (0.9447) lr 1.9298e-03 eta 0:12:10
epoch [8/50] batch [200/203] time 0.071 (0.085) data 0.000 (0.001) loss 0.7857 (0.8520) ce_loss 0.5151 (0.5753) teacher_loss 0.3391 (0.3506) loss_zs_kd 0.1678 (0.1714) loss_oracle 0.3627 (0.4157) acc 84.3750 (78.9531) kd_loss 0.9621 (0.9457) lr 1.9298e-03 eta 0:12:01
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,328
* accuracy: 83.3%
* error: 16.7%
* macro_f1: 86.6%
Checkpoint saved to icml/multi-dg/oracle/02_no_ce/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.3%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [9/50] batch [20/203] time 0.070 (0.095) data 0.000 (0.016) loss 1.1018 (0.8601) ce_loss 0.7471 (0.5977) teacher_loss 0.4533 (0.3468) loss_zs_kd 0.2083 (0.1838) loss_oracle 0.5443 (0.4214) acc 75.0000 (77.9688) kd_loss 1.0498 (0.9599) lr 1.9048e-03 eta 0:13:27
epoch [9/50] batch [40/203] time 0.089 (0.087) data 0.000 (0.008) loss 1.1362 (0.8541) ce_loss 0.7090 (0.5975) teacher_loss 0.4954 (0.3399) loss_zs_kd 0.2132 (0.1831) loss_oracle 0.5342 (0.4226) acc 71.8750 (77.8906) kd_loss 0.9905 (0.9602) lr 1.9048e-03 eta 0:12:14
epoch [9/50] batch [60/203] time 0.068 (0.083) data 0.000 (0.005) loss 0.9237 (0.8577) ce_loss 0.7598 (0.5924) teacher_loss 0.4163 (0.3360) loss_zs_kd 0.2184 (0.1818) loss_oracle 0.3982 (0.4308) acc 71.8750 (78.6458) kd_loss 1.0024 (0.9563) lr 1.9048e-03 eta 0:11:46
epoch [9/50] batch [80/203] time 0.083 (0.082) data 0.000 (0.004) loss 0.9542 (0.8623) ce_loss 0.4656 (0.5927) teacher_loss 0.4392 (0.3372) loss_zs_kd 0.1894 (0.1803) loss_oracle 0.4203 (0.4349) acc 87.5000 (78.8281) kd_loss 0.9452 (0.9547) lr 1.9048e-03 eta 0:11:35
epoch [9/50] batch [100/203] time 0.091 (0.083) data 0.000 (0.003) loss 0.7535 (0.8661) ce_loss 0.6069 (0.5956) teacher_loss 0.2704 (0.3422) loss_zs_kd 0.2017 (0.1796) loss_oracle 0.3823 (0.4342) acc 71.8750 (78.6875) kd_loss 0.9846 (0.9530) lr 1.9048e-03 eta 0:11:36
epoch [9/50] batch [120/203] time 0.087 (0.083) data 0.000 (0.003) loss 0.6532 (0.8559) ce_loss 0.4722 (0.5858) teacher_loss 0.2143 (0.3354) loss_zs_kd 0.1547 (0.1803) loss_oracle 0.3615 (0.4304) acc 84.3750 (78.9583) kd_loss 0.9105 (0.9544) lr 1.9048e-03 eta 0:11:37
epoch [9/50] batch [140/203] time 0.080 (0.083) data 0.000 (0.002) loss 0.9607 (0.8555) ce_loss 0.8228 (0.5865) teacher_loss 0.4301 (0.3378) loss_zs_kd 0.1558 (0.1801) loss_oracle 0.4527 (0.4276) acc 62.5000 (78.9062) kd_loss 0.9475 (0.9535) lr 1.9048e-03 eta 0:11:38
epoch [9/50] batch [160/203] time 0.081 (0.083) data 0.000 (0.002) loss 0.6498 (0.8566) ce_loss 0.1908 (0.5882) teacher_loss 0.0977 (0.3381) loss_zs_kd 0.1910 (0.1794) loss_oracle 0.4565 (0.4287) acc 100.0000 (78.6328) kd_loss 0.8946 (0.9517) lr 1.9048e-03 eta 0:11:35
epoch [9/50] batch [180/203] time 0.075 (0.083) data 0.000 (0.002) loss 1.1170 (0.8623) ce_loss 1.0020 (0.5890) teacher_loss 0.6505 (0.3417) loss_zs_kd 0.1776 (0.1808) loss_oracle 0.3777 (0.4302) acc 65.6250 (78.5938) kd_loss 0.9364 (0.9501) lr 1.9048e-03 eta 0:11:30
epoch [9/50] batch [200/203] time 0.065 (0.082) data 0.000 (0.002) loss 0.8121 (0.8585) ce_loss 0.5537 (0.5820) teacher_loss 0.3504 (0.3400) loss_zs_kd 0.1375 (0.1791) loss_oracle 0.3929 (0.4290) acc 84.3750 (79.0938) kd_loss 0.8310 (0.9480) lr 1.9048e-03 eta 0:11:19
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,324
* accuracy: 83.1%
* error: 16.9%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.3%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [10/50] batch [20/203] time 0.087 (0.098) data 0.000 (0.013) loss 0.6786 (0.8664) ce_loss 0.2722 (0.5880) teacher_loss 0.1434 (0.3244) loss_zs_kd 0.1611 (0.1919) loss_oracle 0.4547 (0.4460) acc 93.7500 (78.2812) kd_loss 0.9094 (0.9367) lr 1.8763e-03 eta 0:13:35
epoch [10/50] batch [40/203] time 0.078 (0.092) data 0.000 (0.007) loss 0.9698 (0.8689) ce_loss 0.5859 (0.5793) teacher_loss 0.3931 (0.3347) loss_zs_kd 0.2342 (0.1856) loss_oracle 0.4596 (0.4414) acc 78.1250 (79.2969) kd_loss 0.9538 (0.9382) lr 1.8763e-03 eta 0:12:41
epoch [10/50] batch [60/203] time 0.082 (0.090) data 0.000 (0.005) loss 0.8518 (0.8705) ce_loss 0.5811 (0.5671) teacher_loss 0.2963 (0.3228) loss_zs_kd 0.1970 (0.1894) loss_oracle 0.4570 (0.4530) acc 84.3750 (79.5312) kd_loss 1.0167 (0.9353) lr 1.8763e-03 eta 0:12:27
epoch [10/50] batch [80/203] time 0.090 (0.090) data 0.000 (0.004) loss 0.7576 (0.8603) ce_loss 0.4709 (0.5573) teacher_loss 0.3145 (0.3175) loss_zs_kd 0.1697 (0.1861) loss_oracle 0.3583 (0.4498) acc 87.5000 (79.9609) kd_loss 0.8638 (0.9343) lr 1.8763e-03 eta 0:12:20
epoch [10/50] batch [100/203] time 0.093 (0.090) data 0.000 (0.003) loss 1.3559 (0.8628) ce_loss 1.2549 (0.5637) teacher_loss 0.7475 (0.3179) loss_zs_kd 0.2177 (0.1864) loss_oracle 0.4996 (0.4517) acc 56.2500 (79.7188) kd_loss 0.9291 (0.9345) lr 1.8763e-03 eta 0:12:16
epoch [10/50] batch [120/203] time 0.093 (0.089) data 0.000 (0.003) loss 0.8309 (0.8632) ce_loss 0.5449 (0.5719) teacher_loss 0.3171 (0.3182) loss_zs_kd 0.2051 (0.1884) loss_oracle 0.4112 (0.4508) acc 78.1250 (79.3750) kd_loss 0.9000 (0.9368) lr 1.8763e-03 eta 0:12:09
epoch [10/50] batch [140/203] time 0.094 (0.088) data 0.000 (0.002) loss 0.9685 (0.8702) ce_loss 0.6870 (0.5834) teacher_loss 0.3957 (0.3233) loss_zs_kd 0.1874 (0.1913) loss_oracle 0.4792 (0.4512) acc 71.8750 (79.1518) kd_loss 0.8522 (0.9378) lr 1.8763e-03 eta 0:12:02
epoch [10/50] batch [160/203] time 0.086 (0.088) data 0.001 (0.002) loss 0.7421 (0.8662) ce_loss 0.4688 (0.5862) teacher_loss 0.2081 (0.3228) loss_zs_kd 0.1589 (0.1917) loss_oracle 0.4546 (0.4476) acc 81.2500 (78.9258) kd_loss 0.9599 (0.9354) lr 1.8763e-03 eta 0:12:00
epoch [10/50] batch [180/203] time 0.089 (0.088) data 0.000 (0.002) loss 0.8998 (0.8668) ce_loss 0.4978 (0.5875) teacher_loss 0.3450 (0.3238) loss_zs_kd 0.1848 (0.1909) loss_oracle 0.4624 (0.4476) acc 84.3750 (78.9410) kd_loss 0.9356 (0.9360) lr 1.8763e-03 eta 0:11:55
epoch [10/50] batch [200/203] time 0.079 (0.087) data 0.000 (0.002) loss 1.0045 (0.8635) ce_loss 0.6812 (0.5846) teacher_loss 0.4149 (0.3206) loss_zs_kd 0.2053 (0.1916) loss_oracle 0.4870 (0.4472) acc 81.2500 (79.1406) kd_loss 0.9023 (0.9344) lr 1.8763e-03 eta 0:11:47
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,313
* accuracy: 82.8%
* error: 17.2%
* macro_f1: 86.5%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.3%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [11/50] batch [20/203] time 0.084 (0.107) data 0.000 (0.021) loss 0.9390 (0.8773) ce_loss 0.7798 (0.6121) teacher_loss 0.2850 (0.3313) loss_zs_kd 0.2371 (0.1958) loss_oracle 0.5355 (0.4481) acc 62.5000 (77.0312) kd_loss 0.9926 (0.9456) lr 1.8443e-03 eta 0:14:24
epoch [11/50] batch [40/203] time 0.096 (0.095) data 0.001 (0.010) loss 0.9216 (0.8832) ce_loss 0.6426 (0.6087) teacher_loss 0.3054 (0.3299) loss_zs_kd 0.2259 (0.1885) loss_oracle 0.5032 (0.4591) acc 75.0000 (77.6562) kd_loss 0.9950 (0.9411) lr 1.8443e-03 eta 0:12:50
epoch [11/50] batch [60/203] time 0.089 (0.093) data 0.001 (0.007) loss 1.0255 (0.8733) ce_loss 0.7900 (0.5892) teacher_loss 0.4234 (0.3241) loss_zs_kd 0.1488 (0.1857) loss_oracle 0.5277 (0.4563) acc 68.7500 (78.7500) kd_loss 0.9412 (0.9358) lr 1.8443e-03 eta 0:12:27
epoch [11/50] batch [80/203] time 0.085 (0.090) data 0.000 (0.005) loss 0.7313 (0.8652) ce_loss 0.4729 (0.5796) teacher_loss 0.1989 (0.3180) loss_zs_kd 0.1816 (0.1850) loss_oracle 0.4416 (0.4547) acc 84.3750 (78.9062) kd_loss 0.9531 (0.9355) lr 1.8443e-03 eta 0:12:06
epoch [11/50] batch [100/203] time 0.076 (0.089) data 0.000 (0.004) loss 0.7178 (0.8640) ce_loss 0.4800 (0.5780) teacher_loss 0.2241 (0.3219) loss_zs_kd 0.1669 (0.1823) loss_oracle 0.4103 (0.4510) acc 87.5000 (79.4375) kd_loss 0.8570 (0.9348) lr 1.8443e-03 eta 0:11:57
epoch [11/50] batch [120/203] time 0.080 (0.089) data 0.000 (0.004) loss 0.6873 (0.8613) ce_loss 0.4021 (0.5788) teacher_loss 0.2179 (0.3224) loss_zs_kd 0.1370 (0.1816) loss_oracle 0.4009 (0.4482) acc 87.5000 (79.4010) kd_loss 0.8293 (0.9357) lr 1.8443e-03 eta 0:11:49
epoch [11/50] batch [140/203] time 0.081 (0.088) data 0.000 (0.003) loss 0.8230 (0.8526) ce_loss 0.5034 (0.5735) teacher_loss 0.2438 (0.3207) loss_zs_kd 0.2251 (0.1798) loss_oracle 0.4667 (0.4420) acc 84.3750 (79.5982) kd_loss 0.9879 (0.9359) lr 1.8443e-03 eta 0:11:38
epoch [11/50] batch [160/203] time 0.082 (0.087) data 0.000 (0.003) loss 0.8265 (0.8497) ce_loss 0.5435 (0.5726) teacher_loss 0.3107 (0.3188) loss_zs_kd 0.2245 (0.1816) loss_oracle 0.4035 (0.4402) acc 71.8750 (79.5703) kd_loss 0.9949 (0.9352) lr 1.8443e-03 eta 0:11:30
epoch [11/50] batch [180/203] time 0.093 (0.086) data 0.000 (0.003) loss 0.7491 (0.8445) ce_loss 0.5581 (0.5672) teacher_loss 0.2544 (0.3125) loss_zs_kd 0.1610 (0.1814) loss_oracle 0.4141 (0.4414) acc 81.2500 (79.6701) kd_loss 0.9952 (0.9372) lr 1.8443e-03 eta 0:11:22
epoch [11/50] batch [200/203] time 0.072 (0.085) data 0.000 (0.002) loss 0.8066 (0.8469) ce_loss 0.5713 (0.5698) teacher_loss 0.3083 (0.3164) loss_zs_kd 0.1323 (0.1807) loss_oracle 0.4322 (0.4402) acc 84.3750 (79.5156) kd_loss 0.9150 (0.9368) lr 1.8443e-03 eta 0:11:13
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,325
* accuracy: 83.2%
* error: 16.8%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.3%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [12/50] batch [20/203] time 0.076 (0.094) data 0.000 (0.017) loss 0.8687 (0.8551) ce_loss 0.6245 (0.5921) teacher_loss 0.3759 (0.3513) loss_zs_kd 0.1851 (0.1772) loss_oracle 0.4003 (0.4152) acc 78.1250 (77.6562) kd_loss 0.9371 (0.9292) lr 1.8090e-03 eta 0:12:21
epoch [12/50] batch [40/203] time 0.083 (0.085) data 0.000 (0.009) loss 0.8144 (0.8337) ce_loss 0.4138 (0.5603) teacher_loss 0.2265 (0.3285) loss_zs_kd 0.2172 (0.1753) loss_oracle 0.4794 (0.4175) acc 81.2500 (78.5938) kd_loss 0.9196 (0.9314) lr 1.8090e-03 eta 0:11:09
epoch [12/50] batch [60/203] time 0.087 (0.084) data 0.001 (0.006) loss 0.8781 (0.8291) ce_loss 0.6089 (0.5598) teacher_loss 0.3686 (0.3225) loss_zs_kd 0.1934 (0.1764) loss_oracle 0.4127 (0.4184) acc 78.1250 (78.7500) kd_loss 0.9676 (0.9362) lr 1.8090e-03 eta 0:10:56
epoch [12/50] batch [80/203] time 0.072 (0.081) data 0.000 (0.005) loss 0.8776 (0.8338) ce_loss 0.8501 (0.5695) teacher_loss 0.3865 (0.3177) loss_zs_kd 0.1825 (0.1803) loss_oracle 0.3998 (0.4259) acc 65.6250 (78.5156) kd_loss 0.9601 (0.9400) lr 1.8090e-03 eta 0:10:38
epoch [12/50] batch [100/203] time 0.080 (0.080) data 0.000 (0.004) loss 0.8650 (0.8415) ce_loss 0.6489 (0.5728) teacher_loss 0.3125 (0.3155) loss_zs_kd 0.1973 (0.1847) loss_oracle 0.4539 (0.4337) acc 81.2500 (78.7500) kd_loss 0.9212 (0.9382) lr 1.8090e-03 eta 0:10:27
epoch [12/50] batch [120/203] time 0.083 (0.080) data 0.000 (0.003) loss 0.9682 (0.8468) ce_loss 0.8398 (0.5782) teacher_loss 0.5097 (0.3174) loss_zs_kd 0.1563 (0.1847) loss_oracle 0.3804 (0.4371) acc 71.8750 (78.8281) kd_loss 0.8434 (0.9374) lr 1.8090e-03 eta 0:10:20
epoch [12/50] batch [140/203] time 0.081 (0.079) data 0.000 (0.003) loss 0.7621 (0.8404) ce_loss 0.5283 (0.5672) teacher_loss 0.1603 (0.3082) loss_zs_kd 0.2240 (0.1869) loss_oracle 0.4897 (0.4388) acc 87.5000 (79.5089) kd_loss 0.9162 (0.9361) lr 1.8090e-03 eta 0:10:14
epoch [12/50] batch [160/203] time 0.080 (0.079) data 0.000 (0.002) loss 0.8147 (0.8347) ce_loss 0.3831 (0.5579) teacher_loss 0.1839 (0.3022) loss_zs_kd 0.1748 (0.1856) loss_oracle 0.5434 (0.4398) acc 87.5000 (79.8047) kd_loss 0.9502 (0.9355) lr 1.8090e-03 eta 0:10:13
epoch [12/50] batch [180/203] time 0.084 (0.079) data 0.000 (0.002) loss 0.7938 (0.8389) ce_loss 0.5576 (0.5607) teacher_loss 0.2124 (0.3041) loss_zs_kd 0.2059 (0.1852) loss_oracle 0.4784 (0.4422) acc 81.2500 (79.7222) kd_loss 0.8879 (0.9369) lr 1.8090e-03 eta 0:10:14
epoch [12/50] batch [200/203] time 0.071 (0.079) data 0.000 (0.002) loss 1.0250 (0.8452) ce_loss 0.7021 (0.5684) teacher_loss 0.4906 (0.3088) loss_zs_kd 0.1648 (0.1864) loss_oracle 0.4520 (0.4432) acc 78.1250 (79.4844) kd_loss 0.9007 (0.9364) lr 1.8090e-03 eta 0:10:06
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,318
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 86.6%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.3%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [13/50] batch [20/203] time 0.095 (0.105) data 0.000 (0.020) loss 1.0119 (0.8940) ce_loss 0.7007 (0.5749) teacher_loss 0.4817 (0.3456) loss_zs_kd 0.1850 (0.1833) loss_oracle 0.4377 (0.4567) acc 78.1250 (79.5312) kd_loss 0.9383 (0.9322) lr 1.7705e-03 eta 0:13:28
epoch [13/50] batch [40/203] time 0.087 (0.094) data 0.000 (0.010) loss 0.9490 (0.8722) ce_loss 0.6191 (0.5519) teacher_loss 0.4361 (0.3188) loss_zs_kd 0.1687 (0.1836) loss_oracle 0.4285 (0.4616) acc 78.1250 (80.7031) kd_loss 0.9231 (0.9429) lr 1.7705e-03 eta 0:12:03
epoch [13/50] batch [60/203] time 0.074 (0.090) data 0.000 (0.007) loss 0.7101 (0.8770) ce_loss 0.3765 (0.5605) teacher_loss 0.2251 (0.3243) loss_zs_kd 0.1387 (0.1874) loss_oracle 0.4156 (0.4590) acc 81.2500 (80.3125) kd_loss 0.8689 (0.9398) lr 1.7705e-03 eta 0:11:31
epoch [13/50] batch [80/203] time 0.085 (0.088) data 0.000 (0.005) loss 0.7474 (0.8828) ce_loss 0.6182 (0.5687) teacher_loss 0.2390 (0.3316) loss_zs_kd 0.2361 (0.1890) loss_oracle 0.3903 (0.4568) acc 75.0000 (80.0000) kd_loss 0.9005 (0.9388) lr 1.7705e-03 eta 0:11:14
epoch [13/50] batch [100/203] time 0.068 (0.084) data 0.000 (0.004) loss 0.7878 (0.8790) ce_loss 0.5479 (0.5683) teacher_loss 0.2121 (0.3300) loss_zs_kd 0.1825 (0.1880) loss_oracle 0.4844 (0.4550) acc 75.0000 (80.0000) kd_loss 0.8935 (0.9368) lr 1.7705e-03 eta 0:10:42
epoch [13/50] batch [120/203] time 0.083 (0.082) data 0.000 (0.004) loss 0.9461 (0.8800) ce_loss 0.6475 (0.5700) teacher_loss 0.3696 (0.3351) loss_zs_kd 0.2158 (0.1880) loss_oracle 0.4686 (0.4510) acc 71.8750 (79.8698) kd_loss 0.9873 (0.9347) lr 1.7705e-03 eta 0:10:19
epoch [13/50] batch [140/203] time 0.074 (0.080) data 0.000 (0.003) loss 0.9967 (0.8779) ce_loss 0.6597 (0.5667) teacher_loss 0.4435 (0.3354) loss_zs_kd 0.2332 (0.1851) loss_oracle 0.4366 (0.4500) acc 75.0000 (79.9777) kd_loss 0.9655 (0.9333) lr 1.7705e-03 eta 0:10:02
epoch [13/50] batch [160/203] time 0.084 (0.078) data 0.000 (0.003) loss 1.1088 (0.8853) ce_loss 0.8955 (0.5721) teacher_loss 0.6010 (0.3455) loss_zs_kd 0.1521 (0.1852) loss_oracle 0.4318 (0.4473) acc 71.8750 (79.7656) kd_loss 0.9775 (0.9347) lr 1.7705e-03 eta 0:09:52
epoch [13/50] batch [180/203] time 0.080 (0.078) data 0.000 (0.002) loss 1.1501 (0.8854) ce_loss 0.7915 (0.5738) teacher_loss 0.6053 (0.3511) loss_zs_kd 0.1670 (0.1825) loss_oracle 0.4614 (0.4430) acc 68.7500 (79.4097) kd_loss 0.9351 (0.9353) lr 1.7705e-03 eta 0:09:47
epoch [13/50] batch [200/203] time 0.071 (0.078) data 0.000 (0.002) loss 0.5404 (0.8842) ce_loss 0.3113 (0.5722) teacher_loss 0.1724 (0.3556) loss_zs_kd 0.1387 (0.1808) loss_oracle 0.2986 (0.4382) acc 93.7500 (79.5938) kd_loss 1.0297 (0.9358) lr 1.7705e-03 eta 0:09:43
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,320
* accuracy: 83.0%
* error: 17.0%
* macro_f1: 86.6%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.3%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [14/50] batch [20/203] time 0.086 (0.096) data 0.000 (0.018) loss 0.9685 (0.9240) ce_loss 0.6504 (0.5745) teacher_loss 0.4241 (0.4286) loss_zs_kd 0.1310 (0.1831) loss_oracle 0.4789 (0.4038) acc 78.1250 (79.6875) kd_loss 0.8808 (0.9259) lr 1.7290e-03 eta 0:12:01
epoch [14/50] batch [40/203] time 0.079 (0.088) data 0.000 (0.009) loss 0.6772 (0.9213) ce_loss 0.3425 (0.5679) teacher_loss 0.2955 (0.4382) loss_zs_kd 0.1391 (0.1630) loss_oracle 0.3122 (0.4016) acc 90.6250 (79.4531) kd_loss 0.8480 (0.9284) lr 1.7290e-03 eta 0:10:57
epoch [14/50] batch [60/203] time 0.085 (0.086) data 0.000 (0.006) loss 0.6993 (0.8954) ce_loss 0.3066 (0.5570) teacher_loss 0.2620 (0.4307) loss_zs_kd 0.1520 (0.1524) loss_oracle 0.3613 (0.3885) acc 93.7500 (79.7917) kd_loss 0.9945 (0.9301) lr 1.7290e-03 eta 0:10:37
epoch [14/50] batch [80/203] time 0.086 (0.084) data 0.000 (0.005) loss 0.7207 (0.8918) ce_loss 0.4739 (0.5620) teacher_loss 0.3701 (0.4388) loss_zs_kd 0.1158 (0.1517) loss_oracle 0.2927 (0.3772) acc 81.2500 (79.2969) kd_loss 0.8864 (0.9292) lr 1.7290e-03 eta 0:10:23
epoch [14/50] batch [100/203] time 0.084 (0.084) data 0.000 (0.004) loss 0.7684 (0.8842) ce_loss 0.5098 (0.5605) teacher_loss 0.3917 (0.4390) loss_zs_kd 0.1366 (0.1482) loss_oracle 0.3085 (0.3711) acc 78.1250 (79.1250) kd_loss 0.9658 (0.9294) lr 1.7290e-03 eta 0:10:25
epoch [14/50] batch [120/203] time 0.093 (0.084) data 0.000 (0.003) loss 0.8843 (0.8828) ce_loss 0.5703 (0.5588) teacher_loss 0.4325 (0.4443) loss_zs_kd 0.1439 (0.1451) loss_oracle 0.3798 (0.3659) acc 78.1250 (79.2969) kd_loss 0.9853 (0.9330) lr 1.7290e-03 eta 0:10:21
epoch [14/50] batch [140/203] time 0.077 (0.084) data 0.000 (0.003) loss 0.9063 (0.8844) ce_loss 0.5654 (0.5613) teacher_loss 0.4873 (0.4508) loss_zs_kd 0.1117 (0.1415) loss_oracle 0.3631 (0.3628) acc 81.2500 (79.1741) kd_loss 0.9416 (0.9370) lr 1.7290e-03 eta 0:10:17
epoch [14/50] batch [160/203] time 0.094 (0.084) data 0.000 (0.002) loss 0.9530 (0.8804) ce_loss 0.6182 (0.5577) teacher_loss 0.5562 (0.4506) loss_zs_kd 0.1445 (0.1382) loss_oracle 0.3245 (0.3607) acc 68.7500 (79.4141) kd_loss 0.8654 (0.9383) lr 1.7290e-03 eta 0:10:20
epoch [14/50] batch [180/203] time 0.079 (0.084) data 0.000 (0.002) loss 0.8363 (0.8776) ce_loss 0.4631 (0.5569) teacher_loss 0.4315 (0.4536) loss_zs_kd 0.1082 (0.1349) loss_oracle 0.3507 (0.3566) acc 84.3750 (79.5486) kd_loss 0.9225 (0.9383) lr 1.7290e-03 eta 0:10:18
epoch [14/50] batch [200/203] time 0.079 (0.084) data 0.000 (0.002) loss 0.6196 (0.8819) ce_loss 0.3735 (0.5629) teacher_loss 0.2822 (0.4627) loss_zs_kd 0.1011 (0.1318) loss_oracle 0.2868 (0.3533) acc 90.6250 (79.3594) kd_loss 0.9724 (0.9382) lr 1.7290e-03 eta 0:10:13
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,322
* accuracy: 83.1%
* error: 16.9%
* macro_f1: 86.5%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.3%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [15/50] batch [20/203] time 0.091 (0.104) data 0.000 (0.015) loss 0.8722 (0.7759) ce_loss 0.6553 (0.5023) teacher_loss 0.5517 (0.4217) loss_zs_kd 0.0766 (0.1031) loss_oracle 0.2823 (0.3027) acc 78.1250 (82.9688) kd_loss 0.9726 (0.9487) lr 1.6845e-03 eta 0:12:39
epoch [15/50] batch [40/203] time 0.101 (0.093) data 0.000 (0.008) loss 1.1570 (0.8367) ce_loss 0.9004 (0.5546) teacher_loss 0.8252 (0.4666) loss_zs_kd 0.1595 (0.1136) loss_oracle 0.2520 (0.3133) acc 65.6250 (80.5469) kd_loss 0.8540 (0.9453) lr 1.6845e-03 eta 0:11:15
epoch [15/50] batch [60/203] time 0.080 (0.088) data 0.000 (0.005) loss 0.7608 (0.8397) ce_loss 0.5200 (0.5622) teacher_loss 0.4193 (0.4719) loss_zs_kd 0.1029 (0.1144) loss_oracle 0.2900 (0.3106) acc 81.2500 (79.7917) kd_loss 0.9628 (0.9468) lr 1.6845e-03 eta 0:10:40
epoch [15/50] batch [80/203] time 0.062 (0.084) data 0.000 (0.004) loss 0.7620 (0.8347) ce_loss 0.4399 (0.5587) teacher_loss 0.4092 (0.4675) loss_zs_kd 0.1115 (0.1127) loss_oracle 0.2970 (0.3108) acc 90.6250 (79.8438) kd_loss 0.9411 (0.9449) lr 1.6845e-03 eta 0:10:10
epoch [15/50] batch [100/203] time 0.065 (0.084) data 0.000 (0.003) loss 0.9471 (0.8301) ce_loss 0.7388 (0.5557) teacher_loss 0.5846 (0.4666) loss_zs_kd 0.1201 (0.1110) loss_oracle 0.3024 (0.3080) acc 71.8750 (79.6562) kd_loss 0.9513 (0.9423) lr 1.6845e-03 eta 0:10:03
epoch [15/50] batch [120/203] time 0.073 (0.082) data 0.000 (0.003) loss 0.8302 (0.8282) ce_loss 0.6567 (0.5587) teacher_loss 0.4893 (0.4685) loss_zs_kd 0.1298 (0.1115) loss_oracle 0.2760 (0.3039) acc 71.8750 (79.4792) kd_loss 0.8867 (0.9389) lr 1.6845e-03 eta 0:09:48
epoch [15/50] batch [140/203] time 0.083 (0.082) data 0.000 (0.002) loss 0.9000 (0.8278) ce_loss 0.7461 (0.5594) teacher_loss 0.5660 (0.4679) loss_zs_kd 0.1133 (0.1120) loss_oracle 0.2774 (0.3039) acc 71.8750 (79.5982) kd_loss 0.8673 (0.9374) lr 1.6845e-03 eta 0:09:45
epoch [15/50] batch [160/203] time 0.073 (0.081) data 0.000 (0.002) loss 1.1226 (0.8263) ce_loss 0.8799 (0.5611) teacher_loss 0.8062 (0.4678) loss_zs_kd 0.1095 (0.1117) loss_oracle 0.2616 (0.3027) acc 62.5000 (79.5508) kd_loss 0.9603 (0.9348) lr 1.6845e-03 eta 0:09:40
epoch [15/50] batch [180/203] time 0.082 (0.082) data 0.000 (0.002) loss 0.8468 (0.8220) ce_loss 0.5894 (0.5619) teacher_loss 0.4979 (0.4676) loss_zs_kd 0.1239 (0.1098) loss_oracle 0.2869 (0.2995) acc 78.1250 (79.7917) kd_loss 0.9345 (0.9360) lr 1.6845e-03 eta 0:09:42
epoch [15/50] batch [200/203] time 0.067 (0.081) data 0.000 (0.002) loss 0.7284 (0.8184) ce_loss 0.4741 (0.5640) teacher_loss 0.4544 (0.4683) loss_zs_kd 0.0843 (0.1091) loss_oracle 0.2319 (0.2955) acc 75.0000 (79.5625) kd_loss 0.8559 (0.9338) lr 1.6845e-03 eta 0:09:37
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,322
* accuracy: 83.1%
* error: 16.9%
* macro_f1: 86.3%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.3%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [16/50] batch [20/203] time 0.080 (0.095) data 0.000 (0.017) loss 0.9404 (0.8526) ce_loss 0.6558 (0.6322) teacher_loss 0.6230 (0.5120) loss_zs_kd 0.0949 (0.1025) loss_oracle 0.2700 (0.2893) acc 81.2500 (77.1875) kd_loss 0.8897 (0.9221) lr 1.6374e-03 eta 0:11:12
epoch [16/50] batch [40/203] time 0.071 (0.085) data 0.000 (0.009) loss 0.8702 (0.8391) ce_loss 0.7607 (0.6096) teacher_loss 0.5549 (0.4950) loss_zs_kd 0.0891 (0.1037) loss_oracle 0.2708 (0.2923) acc 71.8750 (77.6562) kd_loss 0.9196 (0.9122) lr 1.6374e-03 eta 0:10:00
epoch [16/50] batch [60/203] time 0.082 (0.082) data 0.000 (0.006) loss 0.7440 (0.8242) ce_loss 0.6841 (0.5959) teacher_loss 0.4516 (0.4810) loss_zs_kd 0.1040 (0.1061) loss_oracle 0.2404 (0.2902) acc 81.2500 (78.5938) kd_loss 0.8321 (0.9211) lr 1.6374e-03 eta 0:09:34
epoch [16/50] batch [80/203] time 0.067 (0.080) data 0.000 (0.004) loss 0.8763 (0.8102) ce_loss 0.6270 (0.5882) teacher_loss 0.5584 (0.4736) loss_zs_kd 0.1336 (0.1042) loss_oracle 0.2511 (0.2845) acc 78.1250 (78.7500) kd_loss 0.9312 (0.9190) lr 1.6374e-03 eta 0:09:23
epoch [16/50] batch [100/203] time 0.081 (0.080) data 0.000 (0.004) loss 0.6638 (0.8116) ce_loss 0.3621 (0.5856) teacher_loss 0.2962 (0.4728) loss_zs_kd 0.1347 (0.1057) loss_oracle 0.3001 (0.2860) acc 93.7500 (78.8438) kd_loss 0.9226 (0.9163) lr 1.6374e-03 eta 0:09:17
epoch [16/50] batch [120/203] time 0.069 (0.079) data 0.000 (0.003) loss 0.8100 (0.8096) ce_loss 0.6431 (0.5822) teacher_loss 0.4949 (0.4700) loss_zs_kd 0.0907 (0.1075) loss_oracle 0.2697 (0.2858) acc 81.2500 (78.9323) kd_loss 0.9577 (0.9128) lr 1.6374e-03 eta 0:09:10
epoch [16/50] batch [140/203] time 0.082 (0.079) data 0.000 (0.003) loss 0.8637 (0.8018) ce_loss 0.6919 (0.5758) teacher_loss 0.5388 (0.4633) loss_zs_kd 0.1171 (0.1072) loss_oracle 0.2664 (0.2849) acc 65.6250 (79.0402) kd_loss 0.9561 (0.9127) lr 1.6374e-03 eta 0:09:07
epoch [16/50] batch [160/203] time 0.069 (0.078) data 0.000 (0.002) loss 0.6272 (0.8015) ce_loss 0.3577 (0.5776) teacher_loss 0.2982 (0.4620) loss_zs_kd 0.0947 (0.1080) loss_oracle 0.2817 (0.2854) acc 87.5000 (78.7695) kd_loss 0.9054 (0.9115) lr 1.6374e-03 eta 0:09:04
epoch [16/50] batch [180/203] time 0.076 (0.078) data 0.000 (0.002) loss 0.6119 (0.7990) ce_loss 0.4958 (0.5759) teacher_loss 0.3342 (0.4619) loss_zs_kd 0.0978 (0.1071) loss_oracle 0.2288 (0.2835) acc 81.2500 (78.8889) kd_loss 0.9985 (0.9097) lr 1.6374e-03 eta 0:09:03
epoch [16/50] batch [200/203] time 0.072 (0.078) data 0.000 (0.002) loss 0.7554 (0.7962) ce_loss 0.6079 (0.5744) teacher_loss 0.4725 (0.4581) loss_zs_kd 0.1063 (0.1073) loss_oracle 0.2298 (0.2845) acc 71.8750 (79.0000) kd_loss 0.8676 (0.9090) lr 1.6374e-03 eta 0:08:59
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,333
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.8%
Checkpoint saved to icml/multi-dg/oracle/02_no_ce/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.5%, epoch: 16 *******
******* Domain c best val test acc: 100.0%, epoch: 16 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [17/50] batch [20/203] time 0.067 (0.092) data 0.000 (0.018) loss 0.7357 (0.7932) ce_loss 0.4895 (0.5855) teacher_loss 0.3831 (0.4432) loss_zs_kd 0.0920 (0.1110) loss_oracle 0.3066 (0.2945) acc 87.5000 (78.7500) kd_loss 0.9694 (0.8977) lr 1.5878e-03 eta 0:10:34
epoch [17/50] batch [40/203] time 0.068 (0.080) data 0.000 (0.009) loss 1.0374 (0.7914) ce_loss 0.7222 (0.5694) teacher_loss 0.6191 (0.4310) loss_zs_kd 0.1635 (0.1107) loss_oracle 0.3365 (0.3050) acc 68.7500 (79.3750) kd_loss 0.8433 (0.8941) lr 1.5878e-03 eta 0:09:10
epoch [17/50] batch [60/203] time 0.084 (0.077) data 0.000 (0.006) loss 0.8323 (0.7932) ce_loss 0.5742 (0.5704) teacher_loss 0.4647 (0.4337) loss_zs_kd 0.1039 (0.1101) loss_oracle 0.3156 (0.3045) acc 68.7500 (79.3229) kd_loss 0.8510 (0.8912) lr 1.5878e-03 eta 0:08:47
epoch [17/50] batch [80/203] time 0.071 (0.076) data 0.000 (0.005) loss 0.7904 (0.7902) ce_loss 0.5605 (0.5704) teacher_loss 0.4667 (0.4380) loss_zs_kd 0.1164 (0.1109) loss_oracle 0.2655 (0.2967) acc 75.0000 (79.5312) kd_loss 0.9158 (0.8923) lr 1.5878e-03 eta 0:08:37
epoch [17/50] batch [100/203] time 0.079 (0.075) data 0.000 (0.004) loss 0.7724 (0.7935) ce_loss 0.5137 (0.5700) teacher_loss 0.4470 (0.4383) loss_zs_kd 0.1215 (0.1107) loss_oracle 0.2646 (0.2999) acc 78.1250 (79.3750) kd_loss 0.8962 (0.8972) lr 1.5878e-03 eta 0:08:31
epoch [17/50] batch [120/203] time 0.078 (0.077) data 0.000 (0.003) loss 0.6986 (0.7892) ce_loss 0.4514 (0.5629) teacher_loss 0.2926 (0.4339) loss_zs_kd 0.0964 (0.1097) loss_oracle 0.3578 (0.3005) acc 81.2500 (79.5833) kd_loss 0.9755 (0.8985) lr 1.5878e-03 eta 0:08:39
epoch [17/50] batch [140/203] time 0.083 (0.077) data 0.000 (0.003) loss 0.9724 (0.7863) ce_loss 0.7646 (0.5598) teacher_loss 0.5870 (0.4316) loss_zs_kd 0.1192 (0.1101) loss_oracle 0.3258 (0.2996) acc 78.1250 (79.8884) kd_loss 0.8174 (0.8951) lr 1.5878e-03 eta 0:08:42
epoch [17/50] batch [160/203] time 0.080 (0.078) data 0.000 (0.003) loss 0.8983 (0.7941) ce_loss 0.6504 (0.5705) teacher_loss 0.5064 (0.4406) loss_zs_kd 0.1454 (0.1103) loss_oracle 0.3191 (0.2983) acc 71.8750 (79.4922) kd_loss 1.0120 (0.8974) lr 1.5878e-03 eta 0:08:47
epoch [17/50] batch [180/203] time 0.085 (0.079) data 0.000 (0.002) loss 0.7607 (0.7906) ce_loss 0.5347 (0.5708) teacher_loss 0.4241 (0.4390) loss_zs_kd 0.1479 (0.1106) loss_oracle 0.2627 (0.2963) acc 75.0000 (79.5660) kd_loss 0.9515 (0.8966) lr 1.5878e-03 eta 0:08:51
epoch [17/50] batch [200/203] time 0.076 (0.079) data 0.000 (0.002) loss 0.8241 (0.7872) ce_loss 0.6333 (0.5714) teacher_loss 0.5287 (0.4369) loss_zs_kd 0.1032 (0.1132) loss_oracle 0.2439 (0.2937) acc 81.2500 (79.5156) kd_loss 0.9042 (0.8963) lr 1.5878e-03 eta 0:08:51
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,326
* accuracy: 83.2%
* error: 16.8%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.5%, epoch: 16 *******
******* Domain c best val test acc: 100.0%, epoch: 16 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [18/50] batch [20/203] time 0.085 (0.104) data 0.000 (0.017) loss 0.8374 (0.7523) ce_loss 0.7085 (0.5633) teacher_loss 0.5016 (0.4167) loss_zs_kd 0.1296 (0.1170) loss_oracle 0.2710 (0.2771) acc 75.0000 (80.7812) kd_loss 0.9262 (0.8815) lr 1.5358e-03 eta 0:11:35
epoch [18/50] batch [40/203] time 0.066 (0.090) data 0.000 (0.009) loss 0.7211 (0.7741) ce_loss 0.4856 (0.5801) teacher_loss 0.3583 (0.4412) loss_zs_kd 0.0648 (0.1136) loss_oracle 0.3304 (0.2761) acc 75.0000 (79.2969) kd_loss 0.9122 (0.8883) lr 1.5358e-03 eta 0:09:59
epoch [18/50] batch [60/203] time 0.074 (0.083) data 0.000 (0.006) loss 0.5981 (0.7726) ce_loss 0.4070 (0.5857) teacher_loss 0.3189 (0.4400) loss_zs_kd 0.1043 (0.1111) loss_oracle 0.2271 (0.2771) acc 93.7500 (79.3229) kd_loss 0.8509 (0.8884) lr 1.5358e-03 eta 0:09:10
epoch [18/50] batch [80/203] time 0.068 (0.080) data 0.000 (0.005) loss 0.8727 (0.7727) ce_loss 0.6899 (0.5860) teacher_loss 0.5163 (0.4437) loss_zs_kd 0.1177 (0.1122) loss_oracle 0.2975 (0.2730) acc 71.8750 (79.1797) kd_loss 0.8892 (0.8863) lr 1.5358e-03 eta 0:08:47
epoch [18/50] batch [100/203] time 0.085 (0.079) data 0.000 (0.004) loss 0.6919 (0.7627) ce_loss 0.4780 (0.5719) teacher_loss 0.3548 (0.4339) loss_zs_kd 0.0873 (0.1104) loss_oracle 0.2934 (0.2736) acc 75.0000 (79.6875) kd_loss 0.9281 (0.8859) lr 1.5358e-03 eta 0:08:44
epoch [18/50] batch [120/203] time 0.066 (0.079) data 0.000 (0.003) loss 0.7582 (0.7692) ce_loss 0.5474 (0.5777) teacher_loss 0.4741 (0.4432) loss_zs_kd 0.0993 (0.1087) loss_oracle 0.2344 (0.2716) acc 81.2500 (79.2708) kd_loss 0.9293 (0.8896) lr 1.5358e-03 eta 0:08:41
epoch [18/50] batch [140/203] time 0.080 (0.079) data 0.000 (0.003) loss 0.8861 (0.7686) ce_loss 0.8203 (0.5826) teacher_loss 0.6040 (0.4468) loss_zs_kd 0.1079 (0.1078) loss_oracle 0.2281 (0.2679) acc 71.8750 (79.0625) kd_loss 0.8223 (0.8882) lr 1.5358e-03 eta 0:08:37
epoch [18/50] batch [160/203] time 0.084 (0.079) data 0.000 (0.002) loss 0.8209 (0.7662) ce_loss 0.5942 (0.5813) teacher_loss 0.4699 (0.4451) loss_zs_kd 0.1572 (0.1091) loss_oracle 0.2724 (0.2665) acc 78.1250 (79.1406) kd_loss 0.8986 (0.8854) lr 1.5358e-03 eta 0:08:37
epoch [18/50] batch [180/203] time 0.081 (0.079) data 0.000 (0.002) loss 0.7636 (0.7634) ce_loss 0.6431 (0.5804) teacher_loss 0.4864 (0.4444) loss_zs_kd 0.1320 (0.1089) loss_oracle 0.2111 (0.2646) acc 68.7500 (79.2014) kd_loss 0.9342 (0.8841) lr 1.5358e-03 eta 0:08:34
epoch [18/50] batch [200/203] time 0.076 (0.079) data 0.001 (0.002) loss 0.6501 (0.7612) ce_loss 0.4673 (0.5818) teacher_loss 0.3676 (0.4428) loss_zs_kd 0.1210 (0.1097) loss_oracle 0.2220 (0.2636) acc 81.2500 (79.3594) kd_loss 0.8910 (0.8819) lr 1.5358e-03 eta 0:08:34
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,330
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.5%, epoch: 16 *******
******* Domain c best val test acc: 100.0%, epoch: 16 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [19/50] batch [20/203] time 0.079 (0.103) data 0.000 (0.018) loss 0.8535 (0.7354) ce_loss 0.8169 (0.5608) teacher_loss 0.6017 (0.4111) loss_zs_kd 0.1389 (0.1147) loss_oracle 0.1823 (0.2669) acc 65.6250 (79.3750) kd_loss 0.8077 (0.8825) lr 1.4818e-03 eta 0:11:08
epoch [19/50] batch [40/203] time 0.081 (0.091) data 0.000 (0.009) loss 0.7172 (0.7326) ce_loss 0.5566 (0.5502) teacher_loss 0.4459 (0.4099) loss_zs_kd 0.1144 (0.1140) loss_oracle 0.2141 (0.2656) acc 78.1250 (79.9219) kd_loss 0.7998 (0.8783) lr 1.4818e-03 eta 0:09:48
epoch [19/50] batch [60/203] time 0.088 (0.087) data 0.000 (0.006) loss 0.7741 (0.7269) ce_loss 0.5864 (0.5539) teacher_loss 0.4356 (0.4091) loss_zs_kd 0.1632 (0.1126) loss_oracle 0.2570 (0.2616) acc 75.0000 (79.5312) kd_loss 0.8788 (0.8781) lr 1.4818e-03 eta 0:09:23
epoch [19/50] batch [80/203] time 0.082 (0.086) data 0.000 (0.005) loss 0.7670 (0.7300) ce_loss 0.5879 (0.5575) teacher_loss 0.4881 (0.4143) loss_zs_kd 0.0968 (0.1124) loss_oracle 0.2305 (0.2595) acc 78.1250 (79.7266) kd_loss 0.8749 (0.8792) lr 1.4818e-03 eta 0:09:14
epoch [19/50] batch [100/203] time 0.082 (0.085) data 0.000 (0.004) loss 0.7680 (0.7418) ce_loss 0.5938 (0.5713) teacher_loss 0.4209 (0.4241) loss_zs_kd 0.1092 (0.1132) loss_oracle 0.2926 (0.2611) acc 75.0000 (79.4062) kd_loss 0.8915 (0.8783) lr 1.4818e-03 eta 0:09:06
epoch [19/50] batch [120/203] time 0.083 (0.085) data 0.000 (0.003) loss 0.9189 (0.7430) ce_loss 0.7886 (0.5708) teacher_loss 0.5836 (0.4267) loss_zs_kd 0.1311 (0.1108) loss_oracle 0.2698 (0.2609) acc 68.7500 (79.3490) kd_loss 0.9089 (0.8791) lr 1.4818e-03 eta 0:09:01
epoch [19/50] batch [140/203] time 0.085 (0.085) data 0.000 (0.003) loss 0.7804 (0.7449) ce_loss 0.4380 (0.5709) teacher_loss 0.4075 (0.4267) loss_zs_kd 0.1511 (0.1108) loss_oracle 0.2973 (0.2628) acc 81.2500 (79.4643) kd_loss 0.8486 (0.8777) lr 1.4818e-03 eta 0:08:57
epoch [19/50] batch [160/203] time 0.075 (0.084) data 0.000 (0.002) loss 0.6044 (0.7468) ce_loss 0.4033 (0.5736) teacher_loss 0.3025 (0.4271) loss_zs_kd 0.1219 (0.1114) loss_oracle 0.2410 (0.2641) acc 87.5000 (79.3555) kd_loss 0.8233 (0.8782) lr 1.4818e-03 eta 0:08:51
epoch [19/50] batch [180/203] time 0.085 (0.083) data 0.000 (0.002) loss 0.6474 (0.7512) ce_loss 0.5806 (0.5772) teacher_loss 0.3971 (0.4320) loss_zs_kd 0.0980 (0.1111) loss_oracle 0.2012 (0.2636) acc 78.1250 (79.2361) kd_loss 0.8242 (0.8775) lr 1.4818e-03 eta 0:08:46
epoch [19/50] batch [200/203] time 0.072 (0.082) data 0.000 (0.002) loss 1.0355 (0.7510) ce_loss 0.6904 (0.5766) teacher_loss 0.6543 (0.4324) loss_zs_kd 0.0769 (0.1106) loss_oracle 0.3427 (0.2633) acc 84.3750 (79.2656) kd_loss 0.9352 (0.8780) lr 1.4818e-03 eta 0:08:38
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,324
* accuracy: 83.1%
* error: 16.9%
* macro_f1: 86.5%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.5%, epoch: 16 *******
******* Domain c best val test acc: 100.0%, epoch: 16 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [20/50] batch [20/203] time 0.085 (0.100) data 0.000 (0.015) loss 0.8267 (0.7068) ce_loss 0.6401 (0.5152) teacher_loss 0.5215 (0.3834) loss_zs_kd 0.0873 (0.1000) loss_oracle 0.2615 (0.2734) acc 75.0000 (81.2500) kd_loss 0.9092 (0.8793) lr 1.4258e-03 eta 0:10:25
epoch [20/50] batch [40/203] time 0.092 (0.094) data 0.001 (0.008) loss 0.6957 (0.7332) ce_loss 0.5576 (0.5511) teacher_loss 0.3908 (0.4121) loss_zs_kd 0.1073 (0.1055) loss_oracle 0.2512 (0.2684) acc 71.8750 (80.6250) kd_loss 0.8548 (0.8726) lr 1.4258e-03 eta 0:09:50
epoch [20/50] batch [60/203] time 0.095 (0.093) data 0.000 (0.005) loss 0.7606 (0.7349) ce_loss 0.4854 (0.5524) teacher_loss 0.3971 (0.4124) loss_zs_kd 0.1335 (0.1063) loss_oracle 0.2967 (0.2693) acc 87.5000 (80.4167) kd_loss 0.8445 (0.8654) lr 1.4258e-03 eta 0:09:42
epoch [20/50] batch [80/203] time 0.086 (0.092) data 0.000 (0.004) loss 0.7287 (0.7320) ce_loss 0.4622 (0.5562) teacher_loss 0.4472 (0.4120) loss_zs_kd 0.1525 (0.1089) loss_oracle 0.2053 (0.2656) acc 84.3750 (80.1172) kd_loss 0.7717 (0.8660) lr 1.4258e-03 eta 0:09:29
epoch [20/50] batch [100/203] time 0.092 (0.091) data 0.000 (0.003) loss 0.5498 (0.7342) ce_loss 0.2686 (0.5555) teacher_loss 0.2218 (0.4113) loss_zs_kd 0.0876 (0.1110) loss_oracle 0.2841 (0.2673) acc 90.6250 (79.8750) kd_loss 0.8337 (0.8664) lr 1.4258e-03 eta 0:09:21
epoch [20/50] batch [120/203] time 0.083 (0.090) data 0.000 (0.003) loss 0.5130 (0.7445) ce_loss 0.3047 (0.5646) teacher_loss 0.1649 (0.4195) loss_zs_kd 0.1119 (0.1137) loss_oracle 0.2922 (0.2682) acc 90.6250 (79.5833) kd_loss 0.8963 (0.8657) lr 1.4258e-03 eta 0:09:15
epoch [20/50] batch [140/203] time 0.085 (0.090) data 0.000 (0.003) loss 0.6783 (0.7476) ce_loss 0.5293 (0.5669) teacher_loss 0.3305 (0.4197) loss_zs_kd 0.1434 (0.1154) loss_oracle 0.2761 (0.2702) acc 84.3750 (79.5089) kd_loss 0.8485 (0.8669) lr 1.4258e-03 eta 0:09:12
epoch [20/50] batch [160/203] time 0.084 (0.090) data 0.000 (0.002) loss 0.5778 (0.7508) ce_loss 0.4739 (0.5742) teacher_loss 0.2907 (0.4245) loss_zs_kd 0.1005 (0.1158) loss_oracle 0.2368 (0.2685) acc 84.3750 (79.2188) kd_loss 0.8458 (0.8670) lr 1.4258e-03 eta 0:09:09
epoch [20/50] batch [180/203] time 0.084 (0.089) data 0.000 (0.002) loss 0.6783 (0.7476) ce_loss 0.4631 (0.5734) teacher_loss 0.3204 (0.4222) loss_zs_kd 0.1063 (0.1151) loss_oracle 0.3048 (0.2678) acc 84.3750 (79.2708) kd_loss 0.8513 (0.8661) lr 1.4258e-03 eta 0:09:04
epoch [20/50] batch [200/203] time 0.071 (0.088) data 0.000 (0.002) loss 0.8890 (0.7477) ce_loss 0.9165 (0.5767) teacher_loss 0.5528 (0.4240) loss_zs_kd 0.1225 (0.1157) loss_oracle 0.2749 (0.2658) acc 62.5000 (79.2500) kd_loss 0.8881 (0.8648) lr 1.4258e-03 eta 0:08:57
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,332
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.5%, epoch: 16 *******
******* Domain c best val test acc: 100.0%, epoch: 16 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [21/50] batch [20/203] time 0.080 (0.109) data 0.000 (0.022) loss 0.4746 (0.7030) ce_loss 0.3738 (0.5141) teacher_loss 0.2447 (0.3623) loss_zs_kd 0.1127 (0.1309) loss_oracle 0.1735 (0.2753) acc 90.6250 (82.9688) kd_loss 0.8249 (0.8503) lr 1.3681e-03 eta 0:11:03
epoch [21/50] batch [40/203] time 0.089 (0.096) data 0.000 (0.011) loss 0.8369 (0.7131) ce_loss 0.5786 (0.5357) teacher_loss 0.3989 (0.3730) loss_zs_kd 0.1703 (0.1331) loss_oracle 0.3528 (0.2736) acc 68.7500 (80.9375) kd_loss 0.8675 (0.8596) lr 1.3681e-03 eta 0:09:42
epoch [21/50] batch [60/203] time 0.096 (0.093) data 0.001 (0.008) loss 0.6507 (0.7400) ce_loss 0.5723 (0.5598) teacher_loss 0.3698 (0.3967) loss_zs_kd 0.1016 (0.1243) loss_oracle 0.2301 (0.2811) acc 78.1250 (80.1042) kd_loss 0.7872 (0.8539) lr 1.3681e-03 eta 0:09:19
epoch [21/50] batch [80/203] time 0.089 (0.092) data 0.000 (0.006) loss 0.6135 (0.7415) ce_loss 0.4084 (0.5600) teacher_loss 0.2204 (0.3927) loss_zs_kd 0.1525 (0.1233) loss_oracle 0.3168 (0.2871) acc 78.1250 (79.9219) kd_loss 0.8805 (0.8552) lr 1.3681e-03 eta 0:09:13
epoch [21/50] batch [100/203] time 0.075 (0.091) data 0.000 (0.005) loss 0.8995 (0.7500) ce_loss 0.7524 (0.5657) teacher_loss 0.5351 (0.4045) loss_zs_kd 0.1117 (0.1225) loss_oracle 0.3086 (0.2843) acc 75.0000 (79.8438) kd_loss 0.8601 (0.8531) lr 1.3681e-03 eta 0:09:04
epoch [21/50] batch [120/203] time 0.083 (0.089) data 0.000 (0.004) loss 0.5916 (0.7487) ce_loss 0.2571 (0.5621) teacher_loss 0.1968 (0.4080) loss_zs_kd 0.1036 (0.1202) loss_oracle 0.3430 (0.2806) acc 96.8750 (80.0260) kd_loss 0.9422 (0.8538) lr 1.3681e-03 eta 0:08:50
epoch [21/50] batch [140/203] time 0.079 (0.087) data 0.000 (0.003) loss 0.6148 (0.7511) ce_loss 0.4192 (0.5708) teacher_loss 0.3345 (0.4154) loss_zs_kd 0.0773 (0.1203) loss_oracle 0.2417 (0.2755) acc 84.3750 (79.4866) kd_loss 0.8615 (0.8542) lr 1.3681e-03 eta 0:08:38
epoch [21/50] batch [160/203] time 0.082 (0.086) data 0.001 (0.003) loss 0.6295 (0.7462) ce_loss 0.4753 (0.5659) teacher_loss 0.3416 (0.4119) loss_zs_kd 0.1177 (0.1194) loss_oracle 0.2290 (0.2746) acc 87.5000 (79.6094) kd_loss 0.9211 (0.8555) lr 1.3681e-03 eta 0:08:32
epoch [21/50] batch [180/203] time 0.079 (0.085) data 0.000 (0.003) loss 0.8303 (0.7483) ce_loss 0.6426 (0.5657) teacher_loss 0.4905 (0.4154) loss_zs_kd 0.0934 (0.1187) loss_oracle 0.2931 (0.2735) acc 78.1250 (79.4965) kd_loss 0.8363 (0.8567) lr 1.3681e-03 eta 0:08:19
epoch [21/50] batch [200/203] time 0.071 (0.084) data 0.000 (0.003) loss 0.6596 (0.7471) ce_loss 0.4780 (0.5671) teacher_loss 0.3055 (0.4158) loss_zs_kd 0.1032 (0.1162) loss_oracle 0.3025 (0.2732) acc 84.3750 (79.3594) kd_loss 0.9191 (0.8568) lr 1.3681e-03 eta 0:08:15
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,332
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 87.0%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.5%, epoch: 16 *******
******* Domain c best val test acc: 100.0%, epoch: 16 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [22/50] batch [20/203] time 0.077 (0.097) data 0.000 (0.017) loss 0.7574 (0.7866) ce_loss 0.4919 (0.6146) teacher_loss 0.4000 (0.4623) loss_zs_kd 0.1115 (0.1157) loss_oracle 0.3016 (0.2664) acc 90.6250 (78.5938) kd_loss 0.8621 (0.8584) lr 1.3090e-03 eta 0:09:26
epoch [22/50] batch [40/203] time 0.083 (0.088) data 0.000 (0.009) loss 0.6593 (0.7604) ce_loss 0.6079 (0.6009) teacher_loss 0.3823 (0.4457) loss_zs_kd 0.1036 (0.1144) loss_oracle 0.2252 (0.2574) acc 81.2500 (79.5312) kd_loss 0.7870 (0.8507) lr 1.3090e-03 eta 0:08:36
epoch [22/50] batch [60/203] time 0.080 (0.086) data 0.000 (0.006) loss 0.8621 (0.7675) ce_loss 0.5850 (0.6000) teacher_loss 0.5221 (0.4457) loss_zs_kd 0.1128 (0.1117) loss_oracle 0.2836 (0.2660) acc 81.2500 (79.0104) kd_loss 0.9248 (0.8555) lr 1.3090e-03 eta 0:08:23
epoch [22/50] batch [80/203] time 0.072 (0.085) data 0.000 (0.005) loss 0.9188 (0.7608) ce_loss 0.6812 (0.5876) teacher_loss 0.6029 (0.4331) loss_zs_kd 0.1067 (0.1150) loss_oracle 0.2625 (0.2702) acc 75.0000 (79.4141) kd_loss 0.8508 (0.8586) lr 1.3090e-03 eta 0:08:11
epoch [22/50] batch [100/203] time 0.079 (0.083) data 0.000 (0.004) loss 0.8158 (0.7580) ce_loss 0.7178 (0.5792) teacher_loss 0.5254 (0.4296) loss_zs_kd 0.1277 (0.1146) loss_oracle 0.2265 (0.2711) acc 75.0000 (79.2812) kd_loss 0.7792 (0.8562) lr 1.3090e-03 eta 0:08:01
epoch [22/50] batch [120/203] time 0.072 (0.082) data 0.000 (0.003) loss 0.7436 (0.7583) ce_loss 0.6216 (0.5735) teacher_loss 0.4261 (0.4272) loss_zs_kd 0.0946 (0.1132) loss_oracle 0.2702 (0.2745) acc 75.0000 (79.3490) kd_loss 0.8648 (0.8582) lr 1.3090e-03 eta 0:07:51
epoch [22/50] batch [140/203] time 0.063 (0.081) data 0.000 (0.003) loss 1.0037 (0.7667) ce_loss 0.7573 (0.5829) teacher_loss 0.6223 (0.4346) loss_zs_kd 0.1417 (0.1133) loss_oracle 0.3106 (0.2755) acc 81.2500 (78.8839) kd_loss 0.8527 (0.8556) lr 1.3090e-03 eta 0:07:44
epoch [22/50] batch [160/203] time 0.079 (0.080) data 0.000 (0.002) loss 0.6033 (0.7642) ce_loss 0.3306 (0.5759) teacher_loss 0.2787 (0.4308) loss_zs_kd 0.0763 (0.1128) loss_oracle 0.2864 (0.2770) acc 87.5000 (79.2773) kd_loss 0.8274 (0.8558) lr 1.3090e-03 eta 0:07:38
epoch [22/50] batch [180/203] time 0.078 (0.080) data 0.000 (0.002) loss 0.6023 (0.7658) ce_loss 0.2808 (0.5782) teacher_loss 0.2119 (0.4339) loss_zs_kd 0.0946 (0.1110) loss_oracle 0.3431 (0.2764) acc 93.7500 (79.3924) kd_loss 0.8800 (0.8544) lr 1.3090e-03 eta 0:07:35
epoch [22/50] batch [200/203] time 0.071 (0.079) data 0.000 (0.002) loss 0.8289 (0.7648) ce_loss 0.7202 (0.5761) teacher_loss 0.4544 (0.4326) loss_zs_kd 0.1742 (0.1104) loss_oracle 0.2874 (0.2770) acc 71.8750 (79.4688) kd_loss 0.8339 (0.8541) lr 1.3090e-03 eta 0:07:31
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,325
* accuracy: 83.2%
* error: 16.8%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.5%, epoch: 16 *******
******* Domain c best val test acc: 100.0%, epoch: 16 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [23/50] batch [20/203] time 0.074 (0.098) data 0.000 (0.017) loss 0.8839 (0.7473) ce_loss 0.7231 (0.5614) teacher_loss 0.5927 (0.4119) loss_zs_kd 0.1088 (0.1119) loss_oracle 0.2367 (0.2795) acc 75.0000 (80.4688) kd_loss 0.8823 (0.8433) lr 1.2487e-03 eta 0:09:13
epoch [23/50] batch [40/203] time 0.084 (0.090) data 0.000 (0.009) loss 0.7479 (0.7580) ce_loss 0.6118 (0.5806) teacher_loss 0.4321 (0.4222) loss_zs_kd 0.1384 (0.1167) loss_oracle 0.2466 (0.2775) acc 78.1250 (79.2969) kd_loss 0.8434 (0.8352) lr 1.2487e-03 eta 0:08:27
epoch [23/50] batch [60/203] time 0.082 (0.089) data 0.001 (0.006) loss 0.6377 (0.7423) ce_loss 0.5122 (0.5527) teacher_loss 0.3359 (0.3988) loss_zs_kd 0.1429 (0.1216) loss_oracle 0.2303 (0.2826) acc 78.1250 (79.6875) kd_loss 0.8310 (0.8373) lr 1.2487e-03 eta 0:08:17
epoch [23/50] batch [80/203] time 0.084 (0.089) data 0.000 (0.004) loss 0.7634 (0.7493) ce_loss 0.5483 (0.5530) teacher_loss 0.4150 (0.3994) loss_zs_kd 0.1147 (0.1210) loss_oracle 0.2910 (0.2894) acc 75.0000 (79.8828) kd_loss 0.8853 (0.8437) lr 1.2487e-03 eta 0:08:16
epoch [23/50] batch [100/203] time 0.090 (0.089) data 0.000 (0.004) loss 0.8040 (0.7588) ce_loss 0.5454 (0.5595) teacher_loss 0.4665 (0.4101) loss_zs_kd 0.1025 (0.1191) loss_oracle 0.2863 (0.2892) acc 81.2500 (79.7812) kd_loss 0.8647 (0.8453) lr 1.2487e-03 eta 0:08:15
epoch [23/50] batch [120/203] time 0.086 (0.088) data 0.000 (0.003) loss 0.8776 (0.7621) ce_loss 0.6978 (0.5693) teacher_loss 0.4946 (0.4163) loss_zs_kd 0.1414 (0.1183) loss_oracle 0.3123 (0.2867) acc 81.2500 (79.5833) kd_loss 0.8231 (0.8424) lr 1.2487e-03 eta 0:08:11
epoch [23/50] batch [140/203] time 0.089 (0.088) data 0.000 (0.003) loss 0.7820 (0.7594) ce_loss 0.5884 (0.5679) teacher_loss 0.3953 (0.4144) loss_zs_kd 0.1168 (0.1190) loss_oracle 0.3282 (0.2855) acc 81.2500 (79.5982) kd_loss 0.8822 (0.8396) lr 1.2487e-03 eta 0:08:09
epoch [23/50] batch [160/203] time 0.083 (0.089) data 0.000 (0.002) loss 0.8155 (0.7589) ce_loss 0.8794 (0.5690) teacher_loss 0.4878 (0.4131) loss_zs_kd 0.1186 (0.1206) loss_oracle 0.2683 (0.2855) acc 68.7500 (79.4336) kd_loss 0.8283 (0.8421) lr 1.2487e-03 eta 0:08:09
epoch [23/50] batch [180/203] time 0.088 (0.089) data 0.000 (0.002) loss 0.8231 (0.7627) ce_loss 0.4382 (0.5694) teacher_loss 0.3478 (0.4146) loss_zs_kd 0.1330 (0.1206) loss_oracle 0.4089 (0.2878) acc 87.5000 (79.3750) kd_loss 0.8842 (0.8438) lr 1.2487e-03 eta 0:08:07
epoch [23/50] batch [200/203] time 0.079 (0.088) data 0.000 (0.002) loss 0.7285 (0.7623) ce_loss 0.5029 (0.5695) teacher_loss 0.3721 (0.4136) loss_zs_kd 0.1172 (0.1213) loss_oracle 0.2978 (0.2880) acc 75.0000 (79.2656) kd_loss 0.8340 (0.8432) lr 1.2487e-03 eta 0:08:02
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,338
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 87.0%
Checkpoint saved to icml/multi-dg/oracle/02_no_ce/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.6%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [24/50] batch [20/203] time 0.086 (0.094) data 0.000 (0.015) loss 0.7843 (0.7701) ce_loss 0.4766 (0.5938) teacher_loss 0.4231 (0.4184) loss_zs_kd 0.1084 (0.1319) loss_oracle 0.3070 (0.2858) acc 81.2500 (80.0000) kd_loss 0.8675 (0.8379) lr 1.1874e-03 eta 0:08:30
epoch [24/50] batch [40/203] time 0.087 (0.085) data 0.001 (0.007) loss 0.8056 (0.7780) ce_loss 0.5972 (0.6037) teacher_loss 0.4358 (0.4363) loss_zs_kd 0.1358 (0.1252) loss_oracle 0.3019 (0.2790) acc 90.6250 (79.6875) kd_loss 0.8173 (0.8407) lr 1.1874e-03 eta 0:07:44
epoch [24/50] batch [60/203] time 0.065 (0.081) data 0.000 (0.005) loss 0.7221 (0.7790) ce_loss 0.5552 (0.6000) teacher_loss 0.3046 (0.4276) loss_zs_kd 0.1567 (0.1264) loss_oracle 0.3391 (0.2881) acc 78.1250 (79.4271) kd_loss 0.9194 (0.8481) lr 1.1874e-03 eta 0:07:20
epoch [24/50] batch [80/203] time 0.082 (0.079) data 0.000 (0.004) loss 0.8307 (0.7819) ce_loss 0.6211 (0.5998) teacher_loss 0.5108 (0.4300) loss_zs_kd 0.1173 (0.1282) loss_oracle 0.2612 (0.2878) acc 81.2500 (78.7109) kd_loss 0.8057 (0.8451) lr 1.1874e-03 eta 0:07:05
epoch [24/50] batch [100/203] time 0.077 (0.077) data 0.000 (0.003) loss 0.9283 (0.7787) ce_loss 0.5654 (0.5894) teacher_loss 0.5302 (0.4273) loss_zs_kd 0.1285 (0.1270) loss_oracle 0.3338 (0.2879) acc 81.2500 (78.8438) kd_loss 0.8790 (0.8409) lr 1.1874e-03 eta 0:06:54
epoch [24/50] batch [120/203] time 0.079 (0.077) data 0.000 (0.003) loss 0.6239 (0.7805) ce_loss 0.5176 (0.5882) teacher_loss 0.3239 (0.4254) loss_zs_kd 0.1091 (0.1263) loss_oracle 0.2455 (0.2920) acc 81.2500 (78.7240) kd_loss 0.8393 (0.8415) lr 1.1874e-03 eta 0:06:55
epoch [24/50] batch [140/203] time 0.076 (0.078) data 0.000 (0.002) loss 0.5974 (0.7714) ce_loss 0.3625 (0.5744) teacher_loss 0.2412 (0.4145) loss_zs_kd 0.1035 (0.1266) loss_oracle 0.3045 (0.2936) acc 84.3750 (79.3080) kd_loss 0.8134 (0.8418) lr 1.1874e-03 eta 0:06:54
epoch [24/50] batch [160/203] time 0.078 (0.079) data 0.000 (0.002) loss 0.7443 (0.7640) ce_loss 0.6216 (0.5665) teacher_loss 0.3997 (0.4074) loss_zs_kd 0.1309 (0.1264) loss_oracle 0.2791 (0.2934) acc 78.1250 (79.6484) kd_loss 0.8197 (0.8418) lr 1.1874e-03 eta 0:06:57
epoch [24/50] batch [180/203] time 0.082 (0.079) data 0.000 (0.002) loss 0.9704 (0.7634) ce_loss 0.9395 (0.5675) teacher_loss 0.6586 (0.4080) loss_zs_kd 0.1106 (0.1272) loss_oracle 0.2565 (0.2918) acc 68.7500 (79.5833) kd_loss 0.7945 (0.8411) lr 1.1874e-03 eta 0:06:58
epoch [24/50] batch [200/203] time 0.071 (0.078) data 0.000 (0.002) loss 0.5977 (0.7628) ce_loss 0.4128 (0.5673) teacher_loss 0.2692 (0.4075) loss_zs_kd 0.1440 (0.1272) loss_oracle 0.2565 (0.2917) acc 90.6250 (79.6562) kd_loss 0.7678 (0.8403) lr 1.1874e-03 eta 0:06:54
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,330
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.6%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [25/50] batch [20/203] time 0.082 (0.094) data 0.000 (0.013) loss 0.5699 (0.8043) ce_loss 0.4160 (0.5586) teacher_loss 0.2557 (0.4199) loss_zs_kd 0.1387 (0.1252) loss_oracle 0.2448 (0.3218) acc 87.5000 (80.6250) kd_loss 0.7698 (0.8540) lr 1.1253e-03 eta 0:08:14
epoch [25/50] batch [40/203] time 0.081 (0.088) data 0.000 (0.006) loss 1.0676 (0.7818) ce_loss 0.8652 (0.5523) teacher_loss 0.6202 (0.3927) loss_zs_kd 0.1398 (0.1256) loss_oracle 0.3776 (0.3262) acc 68.7500 (80.0000) kd_loss 0.8842 (0.8477) lr 1.1253e-03 eta 0:07:39
epoch [25/50] batch [60/203] time 0.084 (0.086) data 0.000 (0.004) loss 0.7786 (0.7632) ce_loss 0.5522 (0.5349) teacher_loss 0.4525 (0.3793) loss_zs_kd 0.1585 (0.1279) loss_oracle 0.2469 (0.3201) acc 81.2500 (80.3125) kd_loss 0.8625 (0.8466) lr 1.1253e-03 eta 0:07:30
epoch [25/50] batch [80/203] time 0.098 (0.087) data 0.000 (0.003) loss 0.9821 (0.7630) ce_loss 0.8384 (0.5406) teacher_loss 0.5983 (0.3823) loss_zs_kd 0.1487 (0.1271) loss_oracle 0.3094 (0.3170) acc 71.8750 (80.5859) kd_loss 0.8389 (0.8451) lr 1.1253e-03 eta 0:07:30
epoch [25/50] batch [100/203] time 0.086 (0.086) data 0.000 (0.003) loss 0.7545 (0.7684) ce_loss 0.5527 (0.5474) teacher_loss 0.3702 (0.3861) loss_zs_kd 0.1094 (0.1298) loss_oracle 0.3296 (0.3174) acc 78.1250 (80.1250) kd_loss 0.8136 (0.8442) lr 1.1253e-03 eta 0:07:27
epoch [25/50] batch [120/203] time 0.097 (0.086) data 0.000 (0.002) loss 0.6117 (0.7694) ce_loss 0.4382 (0.5547) teacher_loss 0.2150 (0.3885) loss_zs_kd 0.1526 (0.1325) loss_oracle 0.3204 (0.3147) acc 87.5000 (79.8438) kd_loss 0.8620 (0.8434) lr 1.1253e-03 eta 0:07:25
epoch [25/50] batch [140/203] time 0.093 (0.086) data 0.000 (0.002) loss 0.7917 (0.7756) ce_loss 0.6167 (0.5617) teacher_loss 0.3924 (0.3948) loss_zs_kd 0.1276 (0.1336) loss_oracle 0.3355 (0.3139) acc 81.2500 (79.8214) kd_loss 0.8728 (0.8440) lr 1.1253e-03 eta 0:07:23
epoch [25/50] batch [160/203] time 0.090 (0.086) data 0.000 (0.002) loss 0.7447 (0.7716) ce_loss 0.5664 (0.5611) teacher_loss 0.3383 (0.3900) loss_zs_kd 0.1577 (0.1344) loss_oracle 0.3275 (0.3143) acc 75.0000 (79.7070) kd_loss 0.8986 (0.8462) lr 1.1253e-03 eta 0:07:20
epoch [25/50] batch [180/203] time 0.082 (0.086) data 0.000 (0.002) loss 0.6592 (0.7721) ce_loss 0.3586 (0.5599) teacher_loss 0.1720 (0.3885) loss_zs_kd 0.1394 (0.1348) loss_oracle 0.4174 (0.3162) acc 90.6250 (79.8785) kd_loss 0.9449 (0.8472) lr 1.1253e-03 eta 0:07:17
epoch [25/50] batch [200/203] time 0.079 (0.085) data 0.000 (0.002) loss 0.7474 (0.7700) ce_loss 0.6221 (0.5585) teacher_loss 0.3161 (0.3852) loss_zs_kd 0.1631 (0.1356) loss_oracle 0.3497 (0.3170) acc 78.1250 (79.8125) kd_loss 0.8690 (0.8477) lr 1.1253e-03 eta 0:07:14
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,335
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.6%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [26/50] batch [20/203] time 0.084 (0.102) data 0.000 (0.018) loss 0.8894 (0.7751) ce_loss 0.5684 (0.5380) teacher_loss 0.4339 (0.3730) loss_zs_kd 0.1747 (0.1470) loss_oracle 0.3682 (0.3286) acc 87.5000 (80.9375) kd_loss 0.8115 (0.8440) lr 1.0628e-03 eta 0:08:36
epoch [26/50] batch [40/203] time 0.082 (0.093) data 0.000 (0.009) loss 0.9429 (0.7549) ce_loss 0.7710 (0.5247) teacher_loss 0.6136 (0.3622) loss_zs_kd 0.1686 (0.1375) loss_oracle 0.2450 (0.3240) acc 71.8750 (80.7812) kd_loss 0.8543 (0.8511) lr 1.0628e-03 eta 0:07:46
epoch [26/50] batch [60/203] time 0.090 (0.090) data 0.000 (0.006) loss 0.7750 (0.7614) ce_loss 0.5576 (0.5495) teacher_loss 0.3793 (0.3721) loss_zs_kd 0.1574 (0.1418) loss_oracle 0.3170 (0.3184) acc 87.5000 (79.4792) kd_loss 0.8656 (0.8434) lr 1.0628e-03 eta 0:07:30
epoch [26/50] batch [80/203] time 0.084 (0.089) data 0.000 (0.005) loss 0.9440 (0.7669) ce_loss 0.6987 (0.5568) teacher_loss 0.5269 (0.3752) loss_zs_kd 0.1933 (0.1461) loss_oracle 0.3204 (0.3187) acc 75.0000 (79.2188) kd_loss 0.8341 (0.8456) lr 1.0628e-03 eta 0:07:22
epoch [26/50] batch [100/203] time 0.081 (0.088) data 0.000 (0.004) loss 0.8190 (0.7656) ce_loss 0.5278 (0.5577) teacher_loss 0.4298 (0.3716) loss_zs_kd 0.1599 (0.1478) loss_oracle 0.3092 (0.3202) acc 81.2500 (79.0938) kd_loss 0.8318 (0.8465) lr 1.0628e-03 eta 0:07:18
epoch [26/50] batch [120/203] time 0.083 (0.088) data 0.000 (0.003) loss 0.6718 (0.7638) ce_loss 0.3872 (0.5601) teacher_loss 0.2667 (0.3680) loss_zs_kd 0.1501 (0.1503) loss_oracle 0.3300 (0.3206) acc 84.3750 (79.3750) kd_loss 0.9213 (0.8488) lr 1.0628e-03 eta 0:07:15
epoch [26/50] batch [140/203] time 0.087 (0.087) data 0.000 (0.003) loss 0.7607 (0.7666) ce_loss 0.4641 (0.5666) teacher_loss 0.3534 (0.3728) loss_zs_kd 0.1627 (0.1507) loss_oracle 0.3259 (0.3185) acc 90.6250 (79.2188) kd_loss 0.8569 (0.8493) lr 1.0628e-03 eta 0:07:11
epoch [26/50] batch [160/203] time 0.093 (0.087) data 0.000 (0.003) loss 0.6885 (0.7716) ce_loss 0.3416 (0.5625) teacher_loss 0.2507 (0.3756) loss_zs_kd 0.1026 (0.1489) loss_oracle 0.3864 (0.3216) acc 84.3750 (79.1797) kd_loss 0.8289 (0.8490) lr 1.0628e-03 eta 0:07:08
epoch [26/50] batch [180/203] time 0.084 (0.087) data 0.000 (0.002) loss 0.6517 (0.7701) ce_loss 0.3606 (0.5614) teacher_loss 0.1866 (0.3732) loss_zs_kd 0.1168 (0.1481) loss_oracle 0.4068 (0.3228) acc 87.5000 (79.4097) kd_loss 0.9436 (0.8504) lr 1.0628e-03 eta 0:07:07
epoch [26/50] batch [200/203] time 0.078 (0.087) data 0.000 (0.002) loss 1.0779 (0.7721) ce_loss 0.9409 (0.5634) teacher_loss 0.7185 (0.3748) loss_zs_kd 0.1850 (0.1495) loss_oracle 0.2669 (0.3226) acc 71.8750 (79.3594) kd_loss 0.8160 (0.8508) lr 1.0628e-03 eta 0:07:02
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,331
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.6%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [27/50] batch [20/203] time 0.084 (0.103) data 0.000 (0.016) loss 0.8628 (0.7259) ce_loss 0.4661 (0.5141) teacher_loss 0.4436 (0.3167) loss_zs_kd 0.1511 (0.1546) loss_oracle 0.3437 (0.3319) acc 87.5000 (81.7188) kd_loss 0.8749 (0.8632) lr 1.0000e-03 eta 0:08:20
epoch [27/50] batch [40/203] time 0.085 (0.094) data 0.000 (0.008) loss 0.6827 (0.7447) ce_loss 0.4031 (0.5311) teacher_loss 0.2559 (0.3328) loss_zs_kd 0.1694 (0.1531) loss_oracle 0.3421 (0.3354) acc 81.2500 (80.7812) kd_loss 0.8114 (0.8556) lr 1.0000e-03 eta 0:07:31
epoch [27/50] batch [60/203] time 0.082 (0.090) data 0.001 (0.005) loss 0.7248 (0.7476) ce_loss 0.4062 (0.5222) teacher_loss 0.2654 (0.3245) loss_zs_kd 0.1996 (0.1595) loss_oracle 0.3595 (0.3433) acc 84.3750 (81.1458) kd_loss 0.8143 (0.8587) lr 1.0000e-03 eta 0:07:14
epoch [27/50] batch [80/203] time 0.089 (0.090) data 0.000 (0.004) loss 1.2158 (0.7769) ce_loss 1.0322 (0.5463) teacher_loss 0.7537 (0.3502) loss_zs_kd 0.1233 (0.1579) loss_oracle 0.4004 (0.3478) acc 59.3750 (79.6484) kd_loss 0.8465 (0.8617) lr 1.0000e-03 eta 0:07:09
epoch [27/50] batch [100/203] time 0.099 (0.089) data 0.000 (0.003) loss 0.7652 (0.7888) ce_loss 0.3406 (0.5559) teacher_loss 0.2759 (0.3608) loss_zs_kd 0.1229 (0.1559) loss_oracle 0.4278 (0.3501) acc 87.5000 (78.9688) kd_loss 0.8702 (0.8618) lr 1.0000e-03 eta 0:07:06
epoch [27/50] batch [120/203] time 0.089 (0.089) data 0.000 (0.003) loss 0.6649 (0.8039) ce_loss 0.2502 (0.5612) teacher_loss 0.1671 (0.3732) loss_zs_kd 0.1249 (0.1550) loss_oracle 0.4353 (0.3532) acc 96.8750 (78.9062) kd_loss 0.8415 (0.8638) lr 1.0000e-03 eta 0:07:00
epoch [27/50] batch [140/203] time 0.081 (0.088) data 0.000 (0.003) loss 0.9306 (0.8092) ce_loss 0.7153 (0.5590) teacher_loss 0.5283 (0.3782) loss_zs_kd 0.1207 (0.1543) loss_oracle 0.3419 (0.3539) acc 81.2500 (79.0625) kd_loss 0.8383 (0.8667) lr 1.0000e-03 eta 0:06:57
epoch [27/50] batch [160/203] time 0.084 (0.088) data 0.000 (0.002) loss 0.8949 (0.8022) ce_loss 0.7622 (0.5507) teacher_loss 0.4826 (0.3715) loss_zs_kd 0.1715 (0.1518) loss_oracle 0.3265 (0.3548) acc 75.0000 (79.4531) kd_loss 0.8549 (0.8688) lr 1.0000e-03 eta 0:06:55
epoch [27/50] batch [180/203] time 0.090 (0.088) data 0.000 (0.002) loss 1.0372 (0.8064) ce_loss 0.8052 (0.5507) teacher_loss 0.6061 (0.3749) loss_zs_kd 0.1896 (0.1522) loss_oracle 0.3362 (0.3554) acc 71.8750 (79.4271) kd_loss 0.8454 (0.8693) lr 1.0000e-03 eta 0:06:53
epoch [27/50] batch [200/203] time 0.079 (0.087) data 0.000 (0.002) loss 0.6252 (0.8049) ce_loss 0.3711 (0.5481) teacher_loss 0.1702 (0.3727) loss_zs_kd 0.1570 (0.1517) loss_oracle 0.3765 (0.3563) acc 93.7500 (79.5938) kd_loss 0.8413 (0.8695) lr 1.0000e-03 eta 0:06:46
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,333
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.6%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [28/50] batch [20/203] time 0.077 (0.091) data 0.000 (0.013) loss 0.8244 (0.7811) ce_loss 0.7500 (0.5576) teacher_loss 0.4695 (0.3529) loss_zs_kd 0.1668 (0.1659) loss_oracle 0.2715 (0.3453) acc 78.1250 (79.2188) kd_loss 0.8289 (0.8748) lr 9.3721e-04 eta 0:07:01
epoch [28/50] batch [40/203] time 0.079 (0.085) data 0.000 (0.006) loss 0.8178 (0.7743) ce_loss 0.4976 (0.5372) teacher_loss 0.3368 (0.3405) loss_zs_kd 0.1280 (0.1611) loss_oracle 0.4170 (0.3533) acc 81.2500 (80.5469) kd_loss 0.8378 (0.8762) lr 9.3721e-04 eta 0:06:35
epoch [28/50] batch [60/203] time 0.084 (0.085) data 0.000 (0.004) loss 0.7376 (0.7791) ce_loss 0.5166 (0.5510) teacher_loss 0.3424 (0.3461) loss_zs_kd 0.2026 (0.1622) loss_oracle 0.2939 (0.3519) acc 78.1250 (79.4271) kd_loss 0.8417 (0.8686) lr 9.3721e-04 eta 0:06:31
epoch [28/50] batch [80/203] time 0.086 (0.085) data 0.000 (0.003) loss 0.9380 (0.7873) ce_loss 0.7891 (0.5555) teacher_loss 0.5206 (0.3497) loss_zs_kd 0.2257 (0.1645) loss_oracle 0.3045 (0.3553) acc 75.0000 (79.3750) kd_loss 0.8545 (0.8713) lr 9.3721e-04 eta 0:06:29
epoch [28/50] batch [100/203] time 0.089 (0.085) data 0.000 (0.003) loss 0.5996 (0.7813) ce_loss 0.3721 (0.5411) teacher_loss 0.1968 (0.3427) loss_zs_kd 0.1430 (0.1610) loss_oracle 0.3314 (0.3581) acc 84.3750 (79.7188) kd_loss 0.8834 (0.8708) lr 9.3721e-04 eta 0:06:27
epoch [28/50] batch [120/203] time 0.070 (0.084) data 0.000 (0.002) loss 0.7890 (0.7789) ce_loss 0.5229 (0.5345) teacher_loss 0.3053 (0.3371) loss_zs_kd 0.1564 (0.1623) loss_oracle 0.4055 (0.3607) acc 75.0000 (79.8958) kd_loss 0.9092 (0.8709) lr 9.3721e-04 eta 0:06:21
epoch [28/50] batch [140/203] time 0.092 (0.084) data 0.000 (0.002) loss 0.6808 (0.7829) ce_loss 0.4480 (0.5366) teacher_loss 0.2613 (0.3408) loss_zs_kd 0.1406 (0.1619) loss_oracle 0.3492 (0.3612) acc 81.2500 (79.8661) kd_loss 0.8814 (0.8729) lr 9.3721e-04 eta 0:06:21
epoch [28/50] batch [160/203] time 0.083 (0.084) data 0.000 (0.002) loss 0.8931 (0.7841) ce_loss 0.8252 (0.5408) teacher_loss 0.5191 (0.3431) loss_zs_kd 0.1399 (0.1608) loss_oracle 0.3040 (0.3606) acc 84.3750 (79.8047) kd_loss 0.8372 (0.8720) lr 9.3721e-04 eta 0:06:18
epoch [28/50] batch [180/203] time 0.090 (0.084) data 0.000 (0.002) loss 0.6523 (0.7910) ce_loss 0.3069 (0.5459) teacher_loss 0.2269 (0.3482) loss_zs_kd 0.1292 (0.1613) loss_oracle 0.3608 (0.3622) acc 96.8750 (79.7222) kd_loss 0.8442 (0.8719) lr 9.3721e-04 eta 0:06:17
epoch [28/50] batch [200/203] time 0.074 (0.084) data 0.000 (0.002) loss 1.0962 (0.7933) ce_loss 0.9624 (0.5507) teacher_loss 0.6554 (0.3508) loss_zs_kd 0.2203 (0.1616) loss_oracle 0.3306 (0.3618) acc 65.6250 (79.6562) kd_loss 0.8622 (0.8718) lr 9.3721e-04 eta 0:06:16
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,332
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.6%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [29/50] batch [20/203] time 0.092 (0.109) data 0.002 (0.019) loss 0.7893 (0.7363) ce_loss 0.6099 (0.4721) teacher_loss 0.3667 (0.2941) loss_zs_kd 0.1616 (0.1628) loss_oracle 0.3418 (0.3607) acc 75.0000 (82.8125) kd_loss 0.9243 (0.8662) lr 8.7467e-04 eta 0:08:03
epoch [29/50] batch [40/203] time 0.082 (0.097) data 0.000 (0.010) loss 0.7514 (0.7903) ce_loss 0.5391 (0.5430) teacher_loss 0.3289 (0.3396) loss_zs_kd 0.1700 (0.1665) loss_oracle 0.3375 (0.3675) acc 78.1250 (80.4688) kd_loss 0.8468 (0.8796) lr 8.7467e-04 eta 0:07:09
epoch [29/50] batch [60/203] time 0.083 (0.092) data 0.000 (0.007) loss 0.8164 (0.7922) ce_loss 0.6621 (0.5516) teacher_loss 0.3434 (0.3404) loss_zs_kd 0.1865 (0.1702) loss_oracle 0.3798 (0.3667) acc 68.7500 (80.2083) kd_loss 0.9472 (0.8789) lr 8.7467e-04 eta 0:06:47
epoch [29/50] batch [80/203] time 0.090 (0.091) data 0.000 (0.005) loss 0.7366 (0.7784) ce_loss 0.4556 (0.5415) teacher_loss 0.3865 (0.3312) loss_zs_kd 0.1419 (0.1713) loss_oracle 0.2792 (0.3616) acc 78.1250 (80.6641) kd_loss 0.8873 (0.8740) lr 8.7467e-04 eta 0:06:38
epoch [29/50] batch [100/203] time 0.085 (0.090) data 0.000 (0.004) loss 0.6367 (0.7686) ce_loss 0.4580 (0.5350) teacher_loss 0.2597 (0.3240) loss_zs_kd 0.1828 (0.1707) loss_oracle 0.2856 (0.3592) acc 78.1250 (80.8125) kd_loss 0.8879 (0.8756) lr 8.7467e-04 eta 0:06:32
epoch [29/50] batch [120/203] time 0.086 (0.089) data 0.001 (0.003) loss 0.7605 (0.7801) ce_loss 0.4902 (0.5452) teacher_loss 0.2650 (0.3320) loss_zs_kd 0.1504 (0.1709) loss_oracle 0.4203 (0.3626) acc 81.2500 (80.5469) kd_loss 0.9184 (0.8814) lr 8.7467e-04 eta 0:06:28
epoch [29/50] batch [140/203] time 0.082 (0.089) data 0.000 (0.003) loss 0.7861 (0.7782) ce_loss 0.6484 (0.5457) teacher_loss 0.3766 (0.3328) loss_zs_kd 0.2107 (0.1696) loss_oracle 0.3042 (0.3606) acc 75.0000 (80.4911) kd_loss 0.8968 (0.8805) lr 8.7467e-04 eta 0:06:25
epoch [29/50] batch [160/203] time 0.078 (0.088) data 0.000 (0.003) loss 0.8705 (0.7778) ce_loss 0.4028 (0.5474) teacher_loss 0.2896 (0.3331) loss_zs_kd 0.1485 (0.1712) loss_oracle 0.5066 (0.3592) acc 87.5000 (80.4297) kd_loss 0.9239 (0.8780) lr 8.7467e-04 eta 0:06:20
epoch [29/50] batch [180/203] time 0.077 (0.088) data 0.000 (0.002) loss 1.0398 (0.7757) ce_loss 0.7920 (0.5478) teacher_loss 0.5868 (0.3331) loss_zs_kd 0.2088 (0.1700) loss_oracle 0.3487 (0.3576) acc 59.3750 (80.3819) kd_loss 0.8856 (0.8770) lr 8.7467e-04 eta 0:06:16
epoch [29/50] batch [200/203] time 0.072 (0.087) data 0.000 (0.002) loss 0.6531 (0.7771) ce_loss 0.4697 (0.5493) teacher_loss 0.2704 (0.3356) loss_zs_kd 0.1308 (0.1690) loss_oracle 0.3173 (0.3570) acc 87.5000 (80.4062) kd_loss 0.8918 (0.8776) lr 8.7467e-04 eta 0:06:10
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,332
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.6%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [30/50] batch [20/203] time 0.083 (0.101) data 0.000 (0.015) loss 0.8764 (0.7884) ce_loss 0.6689 (0.5575) teacher_loss 0.4021 (0.3277) loss_zs_kd 0.2161 (0.1668) loss_oracle 0.3663 (0.3773) acc 68.7500 (78.4375) kd_loss 0.9074 (0.9011) lr 8.1262e-04 eta 0:07:09
epoch [30/50] batch [40/203] time 0.084 (0.092) data 0.000 (0.008) loss 0.7318 (0.7925) ce_loss 0.3223 (0.5641) teacher_loss 0.2313 (0.3262) loss_zs_kd 0.1486 (0.1762) loss_oracle 0.4262 (0.3782) acc 87.5000 (78.5156) kd_loss 0.8460 (0.8997) lr 8.1262e-04 eta 0:06:28
epoch [30/50] batch [60/203] time 0.090 (0.088) data 0.000 (0.005) loss 0.7010 (0.7971) ce_loss 0.4875 (0.5596) teacher_loss 0.2591 (0.3356) loss_zs_kd 0.1608 (0.1732) loss_oracle 0.3615 (0.3749) acc 81.2500 (78.8021) kd_loss 0.8874 (0.8958) lr 8.1262e-04 eta 0:06:11
epoch [30/50] batch [80/203] time 0.089 (0.087) data 0.000 (0.004) loss 0.7662 (0.7955) ce_loss 0.5620 (0.5574) teacher_loss 0.3855 (0.3408) loss_zs_kd 0.1599 (0.1704) loss_oracle 0.3007 (0.3695) acc 81.2500 (78.8672) kd_loss 0.8346 (0.8945) lr 8.1262e-04 eta 0:06:05
epoch [30/50] batch [100/203] time 0.074 (0.086) data 0.000 (0.003) loss 0.7102 (0.7969) ce_loss 0.5684 (0.5600) teacher_loss 0.2912 (0.3400) loss_zs_kd 0.1639 (0.1714) loss_oracle 0.3371 (0.3712) acc 78.1250 (78.9062) kd_loss 0.8777 (0.8920) lr 8.1262e-04 eta 0:06:00
epoch [30/50] batch [120/203] time 0.080 (0.086) data 0.000 (0.003) loss 0.9097 (0.7972) ce_loss 0.7739 (0.5551) teacher_loss 0.4617 (0.3389) loss_zs_kd 0.1806 (0.1714) loss_oracle 0.3577 (0.3726) acc 62.5000 (79.2188) kd_loss 0.8981 (0.8923) lr 8.1262e-04 eta 0:05:56
epoch [30/50] batch [140/203] time 0.073 (0.085) data 0.000 (0.002) loss 0.7443 (0.7960) ce_loss 0.6118 (0.5567) teacher_loss 0.4285 (0.3409) loss_zs_kd 0.1344 (0.1699) loss_oracle 0.2486 (0.3702) acc 78.1250 (79.2857) kd_loss 0.8479 (0.8886) lr 8.1262e-04 eta 0:05:52
epoch [30/50] batch [160/203] time 0.081 (0.085) data 0.000 (0.002) loss 0.6103 (0.7936) ce_loss 0.3921 (0.5587) teacher_loss 0.2401 (0.3374) loss_zs_kd 0.1277 (0.1714) loss_oracle 0.3063 (0.3705) acc 84.3750 (79.1797) kd_loss 0.8476 (0.8881) lr 8.1262e-04 eta 0:05:49
epoch [30/50] batch [180/203] time 0.079 (0.085) data 0.000 (0.002) loss 0.6673 (0.7903) ce_loss 0.4744 (0.5537) teacher_loss 0.2196 (0.3317) loss_zs_kd 0.1847 (0.1706) loss_oracle 0.3553 (0.3732) acc 84.3750 (79.4618) kd_loss 0.8607 (0.8882) lr 8.1262e-04 eta 0:05:47
epoch [30/50] batch [200/203] time 0.071 (0.084) data 0.000 (0.002) loss 0.7881 (0.7936) ce_loss 0.3772 (0.5555) teacher_loss 0.1939 (0.3325) loss_zs_kd 0.1538 (0.1702) loss_oracle 0.5172 (0.3760) acc 90.6250 (79.5781) kd_loss 0.9241 (0.8880) lr 8.1262e-04 eta 0:05:43
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,333
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.6%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [31/50] batch [20/203] time 0.085 (0.101) data 0.001 (0.018) loss 0.8496 (0.8242) ce_loss 0.6860 (0.5587) teacher_loss 0.3979 (0.3373) loss_zs_kd 0.1646 (0.1692) loss_oracle 0.3694 (0.4023) acc 78.1250 (79.0625) kd_loss 0.9017 (0.9105) lr 7.5131e-04 eta 0:06:47
epoch [31/50] batch [40/203] time 0.082 (0.092) data 0.000 (0.009) loss 0.8489 (0.8148) ce_loss 0.5078 (0.5611) teacher_loss 0.3778 (0.3289) loss_zs_kd 0.1690 (0.1815) loss_oracle 0.3866 (0.3951) acc 81.2500 (78.7500) kd_loss 0.8956 (0.9084) lr 7.5131e-04 eta 0:06:09
epoch [31/50] batch [60/203] time 0.077 (0.088) data 0.000 (0.006) loss 0.7833 (0.8077) ce_loss 0.6567 (0.5672) teacher_loss 0.3603 (0.3211) loss_zs_kd 0.1845 (0.1847) loss_oracle 0.3307 (0.3942) acc 78.1250 (79.1146) kd_loss 0.9115 (0.9077) lr 7.5131e-04 eta 0:05:53
epoch [31/50] batch [80/203] time 0.084 (0.087) data 0.000 (0.005) loss 0.6556 (0.7877) ce_loss 0.5049 (0.5555) teacher_loss 0.1927 (0.3076) loss_zs_kd 0.2004 (0.1834) loss_oracle 0.3628 (0.3884) acc 81.2500 (79.6094) kd_loss 0.8790 (0.9020) lr 7.5131e-04 eta 0:05:46
epoch [31/50] batch [100/203] time 0.079 (0.086) data 0.000 (0.004) loss 0.6738 (0.7881) ce_loss 0.5225 (0.5541) teacher_loss 0.2903 (0.3113) loss_zs_kd 0.1483 (0.1813) loss_oracle 0.3094 (0.3861) acc 75.0000 (79.6250) kd_loss 0.8614 (0.9004) lr 7.5131e-04 eta 0:05:42
epoch [31/50] batch [120/203] time 0.084 (0.086) data 0.000 (0.003) loss 0.7577 (0.7842) ce_loss 0.4954 (0.5574) teacher_loss 0.2615 (0.3115) loss_zs_kd 0.1748 (0.1818) loss_oracle 0.4088 (0.3818) acc 87.5000 (79.6094) kd_loss 0.9076 (0.8976) lr 7.5131e-04 eta 0:05:39
epoch [31/50] batch [140/203] time 0.090 (0.086) data 0.000 (0.003) loss 0.6501 (0.7820) ce_loss 0.4392 (0.5559) teacher_loss 0.1674 (0.3128) loss_zs_kd 0.1868 (0.1818) loss_oracle 0.3893 (0.3782) acc 87.5000 (79.7991) kd_loss 0.8789 (0.8956) lr 7.5131e-04 eta 0:05:37
epoch [31/50] batch [160/203] time 0.083 (0.086) data 0.000 (0.003) loss 0.7473 (0.7799) ce_loss 0.4822 (0.5515) teacher_loss 0.2530 (0.3122) loss_zs_kd 0.1652 (0.1777) loss_oracle 0.4117 (0.3788) acc 78.1250 (79.9414) kd_loss 0.8810 (0.8948) lr 7.5131e-04 eta 0:05:33
epoch [31/50] batch [180/203] time 0.078 (0.085) data 0.000 (0.002) loss 0.8237 (0.7835) ce_loss 0.6665 (0.5510) teacher_loss 0.3666 (0.3135) loss_zs_kd 0.1880 (0.1774) loss_oracle 0.3631 (0.3813) acc 62.5000 (79.8611) kd_loss 0.9019 (0.8940) lr 7.5131e-04 eta 0:05:31
epoch [31/50] batch [200/203] time 0.073 (0.084) data 0.000 (0.002) loss 0.7769 (0.7851) ce_loss 0.5703 (0.5522) teacher_loss 0.3524 (0.3187) loss_zs_kd 0.1366 (0.1747) loss_oracle 0.3563 (0.3790) acc 81.2500 (79.7656) kd_loss 0.8297 (0.8930) lr 7.5131e-04 eta 0:05:25
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,331
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,414
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain c best val acc:      83.6%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [32/50] batch [20/203] time 0.083 (0.101) data 0.000 (0.015) loss 0.7006 (0.8052) ce_loss 0.3223 (0.5768) teacher_loss 0.2606 (0.3460) loss_zs_kd 0.1646 (0.1678) loss_oracle 0.3577 (0.3754) acc 90.6250 (79.8438) kd_loss 0.8838 (0.8872) lr 6.9098e-04 eta 0:06:29
epoch [32/50] batch [40/203] time 0.076 (0.092) data 0.000 (0.007) loss 0.6888 (0.7960) ce_loss 0.4749 (0.5887) teacher_loss 0.3400 (0.3547) loss_zs_kd 0.1374 (0.1662) loss_oracle 0.2801 (0.3582) acc 81.2500 (78.6719) kd_loss 0.8764 (0.8792) lr 6.9098e-04 eta 0:05:51
epoch [32/50] batch [60/203] time 0.091 (0.090) data 0.001 (0.005) loss 0.8088 (0.7836) ce_loss 0.5024 (0.5670) teacher_loss 0.3260 (0.3399) loss_zs_kd 0.1427 (0.1628) loss_oracle 0.4115 (0.3623) acc 81.2500 (79.2188) kd_loss 0.9095 (0.8796) lr 6.9098e-04 eta 0:05:40
epoch [32/50] batch [80/203] time 0.079 (0.089) data 0.000 (0.004) loss 0.9182 (0.7760) ce_loss 0.7212 (0.5536) teacher_loss 0.5182 (0.3307) loss_zs_kd 0.1432 (0.1659) loss_oracle 0.3284 (0.3623) acc 75.0000 (79.5703) kd_loss 0.8450 (0.8795) lr 6.9098e-04 eta 0:05:34
epoch [32/50] batch [100/203] time 0.087 (0.088) data 0.000 (0.003) loss 0.8688 (0.7811) ce_loss 0.7676 (0.5538) teacher_loss 0.4785 (0.3349) loss_zs_kd 0.1897 (0.1653) loss_oracle 0.2955 (0.3635) acc 62.5000 (79.4688) kd_loss 0.8249 (0.8761) lr 6.9098e-04 eta 0:05:30
epoch [32/50] batch [120/203] time 0.084 (0.087) data 0.000 (0.003) loss 0.8178 (0.7900) ce_loss 0.6152 (0.5598) teacher_loss 0.4332 (0.3418) loss_zs_kd 0.1443 (0.1654) loss_oracle 0.3124 (0.3655) acc 78.1250 (79.4531) kd_loss 0.8330 (0.8739) lr 6.9098e-04 eta 0:05:25
epoch [32/50] batch [140/203] time 0.083 (0.087) data 0.000 (0.002) loss 0.6896 (0.7926) ce_loss 0.3989 (0.5589) teacher_loss 0.2120 (0.3431) loss_zs_kd 0.1445 (0.1649) loss_oracle 0.4054 (0.3671) acc 90.6250 (79.3973) kd_loss 0.9111 (0.8744) lr 6.9098e-04 eta 0:05:22
epoch [32/50] batch [160/203] time 0.076 (0.086) data 0.000 (0.002) loss 0.8557 (0.8013) ce_loss 0.6333 (0.5624) teacher_loss 0.3869 (0.3494) loss_zs_kd 0.1655 (0.1645) loss_oracle 0.3861 (0.3697) acc 75.0000 (79.5312) kd_loss 0.9254 (0.8744) lr 6.9098e-04 eta 0:05:19
epoch [32/50] batch [180/203] time 0.080 (0.086) data 0.000 (0.002) loss 0.7546 (0.8002) ce_loss 0.4573 (0.5590) teacher_loss 0.2830 (0.3457) loss_zs_kd 0.1838 (0.1642) loss_oracle 0.3797 (0.3724) acc 71.8750 (79.4792) kd_loss 0.9108 (0.8763) lr 6.9098e-04 eta 0:05:15
epoch [32/50] batch [200/203] time 0.072 (0.085) data 0.000 (0.002) loss 0.9228 (0.8014) ce_loss 0.7085 (0.5619) teacher_loss 0.3659 (0.3459) loss_zs_kd 0.2296 (0.1659) loss_oracle 0.4420 (0.3725) acc 71.8750 (79.4062) kd_loss 0.9156 (0.8779) lr 6.9098e-04 eta 0:05:09
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,334
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.6%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [33/50] batch [20/203] time 0.081 (0.100) data 0.000 (0.019) loss 0.9058 (0.8288) ce_loss 0.7646 (0.5781) teacher_loss 0.4477 (0.3410) loss_zs_kd 0.2083 (0.1822) loss_oracle 0.3539 (0.3966) acc 71.8750 (78.7500) kd_loss 0.8817 (0.8818) lr 6.3188e-04 eta 0:06:02
epoch [33/50] batch [40/203] time 0.101 (0.092) data 0.000 (0.010) loss 0.5728 (0.8149) ce_loss 0.3516 (0.5836) teacher_loss 0.1839 (0.3398) loss_zs_kd 0.1680 (0.1763) loss_oracle 0.3050 (0.3870) acc 84.3750 (78.0469) kd_loss 0.8133 (0.8798) lr 6.3188e-04 eta 0:05:31
epoch [33/50] batch [60/203] time 0.091 (0.090) data 0.001 (0.007) loss 0.7711 (0.8039) ce_loss 0.6304 (0.5629) teacher_loss 0.3292 (0.3311) loss_zs_kd 0.1993 (0.1774) loss_oracle 0.3423 (0.3842) acc 65.6250 (79.1146) kd_loss 0.8841 (0.8803) lr 6.3188e-04 eta 0:05:22
epoch [33/50] batch [80/203] time 0.074 (0.088) data 0.000 (0.005) loss 0.5814 (0.7926) ce_loss 0.4670 (0.5576) teacher_loss 0.2579 (0.3250) loss_zs_kd 0.1296 (0.1795) loss_oracle 0.2586 (0.3778) acc 75.0000 (79.4141) kd_loss 0.7926 (0.8814) lr 6.3188e-04 eta 0:05:14
epoch [33/50] batch [100/203] time 0.084 (0.087) data 0.000 (0.004) loss 0.7352 (0.7842) ce_loss 0.6050 (0.5442) teacher_loss 0.2781 (0.3174) loss_zs_kd 0.2000 (0.1762) loss_oracle 0.3571 (0.3788) acc 87.5000 (80.1875) kd_loss 0.8969 (0.8815) lr 6.3188e-04 eta 0:05:10
epoch [33/50] batch [120/203] time 0.073 (0.087) data 0.000 (0.003) loss 0.5491 (0.7876) ce_loss 0.3264 (0.5460) teacher_loss 0.1417 (0.3218) loss_zs_kd 0.1663 (0.1736) loss_oracle 0.3243 (0.3790) acc 90.6250 (80.6250) kd_loss 0.8297 (0.8809) lr 6.3188e-04 eta 0:05:07
epoch [33/50] batch [140/203] time 0.084 (0.087) data 0.000 (0.003) loss 0.7927 (0.7921) ce_loss 0.4026 (0.5446) teacher_loss 0.3116 (0.3247) loss_zs_kd 0.1464 (0.1714) loss_oracle 0.4079 (0.3818) acc 81.2500 (80.6696) kd_loss 0.9307 (0.8823) lr 6.3188e-04 eta 0:05:04
epoch [33/50] batch [160/203] time 0.085 (0.086) data 0.000 (0.003) loss 0.9458 (0.7964) ce_loss 0.6084 (0.5477) teacher_loss 0.5032 (0.3282) loss_zs_kd 0.1483 (0.1707) loss_oracle 0.3685 (0.3828) acc 81.2500 (80.7227) kd_loss 0.7798 (0.8816) lr 6.3188e-04 eta 0:05:01
epoch [33/50] batch [180/203] time 0.091 (0.086) data 0.000 (0.002) loss 0.7937 (0.7990) ce_loss 0.5879 (0.5493) teacher_loss 0.3406 (0.3316) loss_zs_kd 0.1539 (0.1695) loss_oracle 0.3762 (0.3827) acc 68.7500 (80.3125) kd_loss 0.9045 (0.8809) lr 6.3188e-04 eta 0:05:00
epoch [33/50] batch [200/203] time 0.076 (0.086) data 0.000 (0.002) loss 0.9591 (0.7996) ce_loss 0.6250 (0.5507) teacher_loss 0.3711 (0.3329) loss_zs_kd 0.2248 (0.1691) loss_oracle 0.4756 (0.3821) acc 68.7500 (80.0625) kd_loss 0.8586 (0.8801) lr 6.3188e-04 eta 0:04:55
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,321
* accuracy: 83.0%
* error: 17.0%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,414
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain c best val acc:      83.6%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [34/50] batch [20/203] time 0.084 (0.101) data 0.000 (0.019) loss 0.7761 (0.7952) ce_loss 0.5234 (0.5144) teacher_loss 0.2908 (0.3026) loss_zs_kd 0.1542 (0.1756) loss_oracle 0.4082 (0.4048) acc 90.6250 (82.6562) kd_loss 0.9015 (0.8795) lr 5.7422e-04 eta 0:05:46
epoch [34/50] batch [40/203] time 0.083 (0.091) data 0.000 (0.010) loss 0.8449 (0.7867) ce_loss 0.5312 (0.5270) teacher_loss 0.3970 (0.3130) loss_zs_kd 0.1586 (0.1756) loss_oracle 0.3686 (0.3859) acc 84.3750 (80.9375) kd_loss 0.9420 (0.8847) lr 5.7422e-04 eta 0:05:10
epoch [34/50] batch [60/203] time 0.081 (0.088) data 0.000 (0.006) loss 0.6514 (0.7815) ce_loss 0.3301 (0.5260) teacher_loss 0.2066 (0.3125) loss_zs_kd 0.1913 (0.1749) loss_oracle 0.3491 (0.3816) acc 93.7500 (81.3542) kd_loss 0.8415 (0.8808) lr 5.7422e-04 eta 0:04:58
epoch [34/50] batch [80/203] time 0.087 (0.087) data 0.000 (0.005) loss 0.7742 (0.7776) ce_loss 0.4778 (0.5347) teacher_loss 0.2663 (0.3180) loss_zs_kd 0.1909 (0.1703) loss_oracle 0.4125 (0.3744) acc 78.1250 (81.2500) kd_loss 0.9460 (0.8782) lr 5.7422e-04 eta 0:04:53
epoch [34/50] batch [100/203] time 0.084 (0.087) data 0.000 (0.004) loss 0.9604 (0.7817) ce_loss 0.7559 (0.5343) teacher_loss 0.4844 (0.3199) loss_zs_kd 0.1916 (0.1731) loss_oracle 0.3802 (0.3753) acc 75.0000 (81.4062) kd_loss 0.8899 (0.8811) lr 5.7422e-04 eta 0:04:50
epoch [34/50] batch [120/203] time 0.087 (0.086) data 0.000 (0.003) loss 0.7600 (0.7941) ce_loss 0.6523 (0.5523) teacher_loss 0.3470 (0.3316) loss_zs_kd 0.1753 (0.1734) loss_oracle 0.3254 (0.3757) acc 75.0000 (80.3906) kd_loss 0.9044 (0.8811) lr 5.7422e-04 eta 0:04:47
epoch [34/50] batch [140/203] time 0.082 (0.086) data 0.000 (0.003) loss 0.7660 (0.7944) ce_loss 0.5117 (0.5488) teacher_loss 0.2743 (0.3293) loss_zs_kd 0.1433 (0.1729) loss_oracle 0.4200 (0.3786) acc 84.3750 (80.3795) kd_loss 0.8229 (0.8814) lr 5.7422e-04 eta 0:04:44
epoch [34/50] batch [160/203] time 0.079 (0.086) data 0.000 (0.003) loss 0.8149 (0.8011) ce_loss 0.6719 (0.5588) teacher_loss 0.4209 (0.3368) loss_zs_kd 0.1598 (0.1716) loss_oracle 0.3141 (0.3785) acc 78.1250 (80.0391) kd_loss 0.9377 (0.8827) lr 5.7422e-04 eta 0:04:43
epoch [34/50] batch [180/203] time 0.083 (0.086) data 0.000 (0.002) loss 0.6398 (0.8017) ce_loss 0.2749 (0.5562) teacher_loss 0.1549 (0.3355) loss_zs_kd 0.1541 (0.1710) loss_oracle 0.4079 (0.3808) acc 87.5000 (80.0174) kd_loss 0.8647 (0.8822) lr 5.7422e-04 eta 0:04:40
epoch [34/50] batch [200/203] time 0.072 (0.085) data 0.000 (0.002) loss 0.7231 (0.8024) ce_loss 0.4465 (0.5537) teacher_loss 0.2945 (0.3357) loss_zs_kd 0.1573 (0.1704) loss_oracle 0.3499 (0.3814) acc 81.2500 (80.0469) kd_loss 0.8375 (0.8818) lr 5.7422e-04 eta 0:04:36
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,331
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.6%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [35/50] batch [20/203] time 0.083 (0.103) data 0.000 (0.018) loss 0.7504 (0.8373) ce_loss 0.4631 (0.5707) teacher_loss 0.3055 (0.3542) loss_zs_kd 0.1491 (0.1792) loss_oracle 0.3704 (0.3934) acc 84.3750 (79.0625) kd_loss 0.9243 (0.8787) lr 5.1825e-04 eta 0:05:31
epoch [35/50] batch [40/203] time 0.083 (0.091) data 0.000 (0.009) loss 0.6491 (0.8361) ce_loss 0.4495 (0.5716) teacher_loss 0.2097 (0.3482) loss_zs_kd 0.1709 (0.1788) loss_oracle 0.3539 (0.3986) acc 87.5000 (79.6094) kd_loss 0.8933 (0.8755) lr 5.1825e-04 eta 0:04:53
epoch [35/50] batch [60/203] time 0.097 (0.089) data 0.001 (0.006) loss 0.9288 (0.8282) ce_loss 0.6470 (0.5750) teacher_loss 0.3899 (0.3506) loss_zs_kd 0.2117 (0.1776) loss_oracle 0.4331 (0.3888) acc 75.0000 (79.2188) kd_loss 0.8926 (0.8803) lr 5.1825e-04 eta 0:04:42
epoch [35/50] batch [80/203] time 0.105 (0.089) data 0.001 (0.005) loss 0.9194 (0.8096) ce_loss 0.7964 (0.5703) teacher_loss 0.5048 (0.3429) loss_zs_kd 0.2018 (0.1743) loss_oracle 0.3137 (0.3796) acc 75.0000 (79.0625) kd_loss 0.9005 (0.8806) lr 5.1825e-04 eta 0:04:41
epoch [35/50] batch [100/203] time 0.084 (0.088) data 0.000 (0.004) loss 0.8290 (0.8051) ce_loss 0.5532 (0.5585) teacher_loss 0.4027 (0.3397) loss_zs_kd 0.1520 (0.1704) loss_oracle 0.3503 (0.3802) acc 81.2500 (79.5625) kd_loss 0.9036 (0.8795) lr 5.1825e-04 eta 0:04:38
epoch [35/50] batch [120/203] time 0.087 (0.088) data 0.000 (0.003) loss 0.7132 (0.8008) ce_loss 0.4199 (0.5532) teacher_loss 0.2288 (0.3412) loss_zs_kd 0.1584 (0.1663) loss_oracle 0.4051 (0.3765) acc 84.3750 (80.1042) kd_loss 0.8913 (0.8783) lr 5.1825e-04 eta 0:04:34
epoch [35/50] batch [140/203] time 0.085 (0.088) data 0.000 (0.003) loss 0.6178 (0.7941) ce_loss 0.3909 (0.5524) teacher_loss 0.2016 (0.3376) loss_zs_kd 0.1290 (0.1677) loss_oracle 0.3517 (0.3726) acc 81.2500 (80.0000) kd_loss 0.8860 (0.8792) lr 5.1825e-04 eta 0:04:32
epoch [35/50] batch [160/203] time 0.096 (0.088) data 0.001 (0.003) loss 0.7756 (0.7951) ce_loss 0.5288 (0.5583) teacher_loss 0.3799 (0.3412) loss_zs_kd 0.1613 (0.1672) loss_oracle 0.3151 (0.3703) acc 81.2500 (79.4336) kd_loss 0.9010 (0.8773) lr 5.1825e-04 eta 0:04:31
epoch [35/50] batch [180/203] time 0.083 (0.088) data 0.000 (0.002) loss 0.8815 (0.7945) ce_loss 0.9331 (0.5626) teacher_loss 0.4919 (0.3429) loss_zs_kd 0.1893 (0.1678) loss_oracle 0.2950 (0.3677) acc 71.8750 (79.6181) kd_loss 0.8695 (0.8772) lr 5.1825e-04 eta 0:04:29
epoch [35/50] batch [200/203] time 0.074 (0.087) data 0.000 (0.002) loss 0.5891 (0.7904) ce_loss 0.3396 (0.5585) teacher_loss 0.2291 (0.3391) loss_zs_kd 0.1240 (0.1681) loss_oracle 0.2981 (0.3672) acc 93.7500 (79.8594) kd_loss 0.8931 (0.8787) lr 5.1825e-04 eta 0:04:24
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,343
* accuracy: 83.8%
* error: 16.2%
* macro_f1: 87.2%
Checkpoint saved to icml/multi-dg/oracle/02_no_ce/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [36/50] batch [20/203] time 0.083 (0.099) data 0.000 (0.015) loss 0.6318 (0.7855) ce_loss 0.3459 (0.5576) teacher_loss 0.1792 (0.3277) loss_zs_kd 0.1424 (0.1756) loss_oracle 0.3814 (0.3700) acc 87.5000 (80.3125) kd_loss 0.9450 (0.8889) lr 4.6417e-04 eta 0:05:00
epoch [36/50] batch [40/203] time 0.085 (0.093) data 0.000 (0.008) loss 0.5609 (0.7927) ce_loss 0.4678 (0.5539) teacher_loss 0.2446 (0.3379) loss_zs_kd 0.1585 (0.1740) loss_oracle 0.2370 (0.3678) acc 81.2500 (80.0000) kd_loss 0.9028 (0.8801) lr 4.6417e-04 eta 0:04:40
epoch [36/50] batch [60/203] time 0.091 (0.091) data 0.001 (0.005) loss 0.9978 (0.7899) ce_loss 0.8921 (0.5570) teacher_loss 0.6110 (0.3385) loss_zs_kd 0.1502 (0.1709) loss_oracle 0.3117 (0.3660) acc 65.6250 (79.7917) kd_loss 0.8420 (0.8829) lr 4.6417e-04 eta 0:04:32
epoch [36/50] batch [80/203] time 0.090 (0.091) data 0.000 (0.004) loss 0.9552 (0.7834) ce_loss 0.6157 (0.5444) teacher_loss 0.4315 (0.3287) loss_zs_kd 0.1710 (0.1687) loss_oracle 0.4382 (0.3703) acc 78.1250 (80.3125) kd_loss 0.8677 (0.8791) lr 4.6417e-04 eta 0:04:28
epoch [36/50] batch [100/203] time 0.089 (0.090) data 0.001 (0.003) loss 0.8943 (0.7741) ce_loss 0.7021 (0.5333) teacher_loss 0.5176 (0.3222) loss_zs_kd 0.1695 (0.1690) loss_oracle 0.2920 (0.3674) acc 71.8750 (80.7812) kd_loss 0.8581 (0.8789) lr 4.6417e-04 eta 0:04:25
epoch [36/50] batch [120/203] time 0.095 (0.090) data 0.001 (0.003) loss 0.8792 (0.7790) ce_loss 0.6812 (0.5402) teacher_loss 0.3876 (0.3264) loss_zs_kd 0.1667 (0.1701) loss_oracle 0.4082 (0.3676) acc 81.2500 (80.7031) kd_loss 0.8784 (0.8806) lr 4.6417e-04 eta 0:04:23
epoch [36/50] batch [140/203] time 0.095 (0.090) data 0.000 (0.003) loss 0.7800 (0.7801) ce_loss 0.6045 (0.5381) teacher_loss 0.3097 (0.3260) loss_zs_kd 0.1758 (0.1697) loss_oracle 0.3824 (0.3692) acc 62.5000 (80.8929) kd_loss 0.8945 (0.8801) lr 4.6417e-04 eta 0:04:22
epoch [36/50] batch [160/203] time 0.088 (0.090) data 0.001 (0.002) loss 0.6806 (0.7832) ce_loss 0.4702 (0.5376) teacher_loss 0.2034 (0.3264) loss_zs_kd 0.1697 (0.1694) loss_oracle 0.3922 (0.3720) acc 90.6250 (80.8203) kd_loss 0.8710 (0.8824) lr 4.6417e-04 eta 0:04:19
epoch [36/50] batch [180/203] time 0.086 (0.090) data 0.000 (0.002) loss 0.7421 (0.7811) ce_loss 0.5483 (0.5372) teacher_loss 0.3047 (0.3261) loss_zs_kd 0.1629 (0.1678) loss_oracle 0.3560 (0.3710) acc 84.3750 (80.8681) kd_loss 0.8438 (0.8808) lr 4.6417e-04 eta 0:04:17
epoch [36/50] batch [200/203] time 0.078 (0.089) data 0.000 (0.002) loss 0.9102 (0.7880) ce_loss 0.6123 (0.5419) teacher_loss 0.3586 (0.3299) loss_zs_kd 0.1852 (0.1681) loss_oracle 0.4591 (0.3741) acc 71.8750 (80.5938) kd_loss 0.9680 (0.8808) lr 4.6417e-04 eta 0:04:13
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,338
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 87.1%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [37/50] batch [20/203] time 0.080 (0.100) data 0.000 (0.017) loss 0.7260 (0.7890) ce_loss 0.5322 (0.4957) teacher_loss 0.3427 (0.3249) loss_zs_kd 0.1517 (0.1540) loss_oracle 0.3074 (0.3871) acc 81.2500 (81.8750) kd_loss 0.8829 (0.8814) lr 4.1221e-04 eta 0:04:40
epoch [37/50] batch [40/203] time 0.082 (0.092) data 0.000 (0.009) loss 1.2458 (0.8005) ce_loss 1.0566 (0.5265) teacher_loss 0.7761 (0.3350) loss_zs_kd 0.2071 (0.1627) loss_oracle 0.3661 (0.3842) acc 65.6250 (80.2344) kd_loss 0.9093 (0.8865) lr 4.1221e-04 eta 0:04:17
epoch [37/50] batch [60/203] time 0.088 (0.090) data 0.000 (0.006) loss 0.8969 (0.7967) ce_loss 0.5850 (0.5293) teacher_loss 0.4288 (0.3307) loss_zs_kd 0.1516 (0.1640) loss_oracle 0.3924 (0.3840) acc 75.0000 (80.3125) kd_loss 0.8730 (0.8846) lr 4.1221e-04 eta 0:04:11
epoch [37/50] batch [80/203] time 0.084 (0.089) data 0.000 (0.005) loss 0.7532 (0.8002) ce_loss 0.3569 (0.5335) teacher_loss 0.2357 (0.3283) loss_zs_kd 0.1497 (0.1663) loss_oracle 0.4426 (0.3888) acc 87.5000 (80.5469) kd_loss 0.8742 (0.8857) lr 4.1221e-04 eta 0:04:05
epoch [37/50] batch [100/203] time 0.085 (0.089) data 0.000 (0.004) loss 0.8148 (0.8079) ce_loss 0.6479 (0.5422) teacher_loss 0.3490 (0.3290) loss_zs_kd 0.1637 (0.1719) loss_oracle 0.3839 (0.3929) acc 75.0000 (79.6875) kd_loss 0.8571 (0.8855) lr 4.1221e-04 eta 0:04:02
epoch [37/50] batch [120/203] time 0.085 (0.088) data 0.000 (0.003) loss 0.7735 (0.8176) ce_loss 0.6240 (0.5481) teacher_loss 0.3424 (0.3374) loss_zs_kd 0.2028 (0.1720) loss_oracle 0.3297 (0.3942) acc 75.0000 (79.8438) kd_loss 0.7972 (0.8870) lr 4.1221e-04 eta 0:03:59
epoch [37/50] batch [140/203] time 0.067 (0.086) data 0.000 (0.003) loss 0.7146 (0.8163) ce_loss 0.4570 (0.5488) teacher_loss 0.2911 (0.3386) loss_zs_kd 0.1755 (0.1709) loss_oracle 0.3358 (0.3922) acc 87.5000 (79.8884) kd_loss 0.8904 (0.8848) lr 4.1221e-04 eta 0:03:53
epoch [37/50] batch [160/203] time 0.078 (0.085) data 0.000 (0.002) loss 0.9658 (0.8137) ce_loss 0.6255 (0.5504) teacher_loss 0.4596 (0.3379) loss_zs_kd 0.2294 (0.1724) loss_oracle 0.3915 (0.3896) acc 75.0000 (79.8047) kd_loss 0.9256 (0.8868) lr 4.1221e-04 eta 0:03:49
epoch [37/50] batch [180/203] time 0.070 (0.085) data 0.000 (0.002) loss 0.9451 (0.8230) ce_loss 0.6880 (0.5591) teacher_loss 0.3729 (0.3436) loss_zs_kd 0.2161 (0.1721) loss_oracle 0.4641 (0.3934) acc 75.0000 (79.6875) kd_loss 0.9479 (0.8876) lr 4.1221e-04 eta 0:03:45
epoch [37/50] batch [200/203] time 0.071 (0.083) data 0.000 (0.002) loss 0.8714 (0.8191) ce_loss 0.5645 (0.5533) teacher_loss 0.3635 (0.3374) loss_zs_kd 0.1946 (0.1732) loss_oracle 0.4106 (0.3951) acc 84.3750 (79.8750) kd_loss 0.9066 (0.8887) lr 4.1221e-04 eta 0:03:40
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,333
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [38/50] batch [20/203] time 0.088 (0.097) data 0.001 (0.014) loss 0.6934 (0.8023) ce_loss 0.4043 (0.5518) teacher_loss 0.2461 (0.3229) loss_zs_kd 0.1301 (0.1805) loss_oracle 0.3822 (0.3892) acc 81.2500 (78.7500) kd_loss 0.8738 (0.8847) lr 3.6258e-04 eta 0:04:14
epoch [38/50] batch [40/203] time 0.080 (0.089) data 0.000 (0.007) loss 0.9040 (0.7904) ce_loss 0.7090 (0.5353) teacher_loss 0.3806 (0.3126) loss_zs_kd 0.2074 (0.1800) loss_oracle 0.4197 (0.3878) acc 71.8750 (79.2969) kd_loss 0.8485 (0.8855) lr 3.6258e-04 eta 0:03:51
epoch [38/50] batch [60/203] time 0.081 (0.088) data 0.001 (0.005) loss 0.7185 (0.7901) ce_loss 0.3713 (0.5397) teacher_loss 0.1988 (0.3182) loss_zs_kd 0.1578 (0.1766) loss_oracle 0.4408 (0.3836) acc 78.1250 (79.4271) kd_loss 0.9623 (0.8869) lr 3.6258e-04 eta 0:03:45
epoch [38/50] batch [80/203] time 0.087 (0.087) data 0.000 (0.004) loss 0.7630 (0.7969) ce_loss 0.4873 (0.5484) teacher_loss 0.2931 (0.3264) loss_zs_kd 0.1548 (0.1739) loss_oracle 0.3925 (0.3835) acc 87.5000 (79.6484) kd_loss 0.8885 (0.8851) lr 3.6258e-04 eta 0:03:41
epoch [38/50] batch [100/203] time 0.084 (0.086) data 0.000 (0.003) loss 0.9579 (0.8001) ce_loss 0.8765 (0.5539) teacher_loss 0.5577 (0.3271) loss_zs_kd 0.1330 (0.1735) loss_oracle 0.3337 (0.3863) acc 59.3750 (79.3125) kd_loss 0.8886 (0.8872) lr 3.6258e-04 eta 0:03:39
epoch [38/50] batch [120/203] time 0.081 (0.086) data 0.000 (0.003) loss 0.9151 (0.8023) ce_loss 0.6255 (0.5510) teacher_loss 0.4287 (0.3252) loss_zs_kd 0.1692 (0.1737) loss_oracle 0.4018 (0.3903) acc 78.1250 (79.4792) kd_loss 0.8525 (0.8862) lr 3.6258e-04 eta 0:03:36
epoch [38/50] batch [140/203] time 0.088 (0.086) data 0.000 (0.002) loss 0.9568 (0.7996) ce_loss 0.4573 (0.5401) teacher_loss 0.3638 (0.3208) loss_zs_kd 0.1621 (0.1727) loss_oracle 0.5120 (0.3924) acc 81.2500 (80.0670) kd_loss 0.9274 (0.8868) lr 3.6258e-04 eta 0:03:34
epoch [38/50] batch [160/203] time 0.085 (0.086) data 0.000 (0.002) loss 0.8620 (0.8075) ce_loss 0.5508 (0.5457) teacher_loss 0.3560 (0.3262) loss_zs_kd 0.1211 (0.1730) loss_oracle 0.4454 (0.3948) acc 81.2500 (79.9219) kd_loss 0.9088 (0.8867) lr 3.6258e-04 eta 0:03:33
epoch [38/50] batch [180/203] time 0.092 (0.086) data 0.000 (0.002) loss 0.5975 (0.8044) ce_loss 0.4060 (0.5448) teacher_loss 0.1970 (0.3257) loss_zs_kd 0.1320 (0.1722) loss_oracle 0.3345 (0.3926) acc 81.2500 (80.0000) kd_loss 0.8504 (0.8857) lr 3.6258e-04 eta 0:03:31
epoch [38/50] batch [200/203] time 0.069 (0.085) data 0.000 (0.002) loss 0.8142 (0.8067) ce_loss 0.5029 (0.5455) teacher_loss 0.3181 (0.3270) loss_zs_kd 0.1945 (0.1718) loss_oracle 0.3988 (0.3938) acc 81.2500 (80.0156) kd_loss 0.9054 (0.8857) lr 3.6258e-04 eta 0:03:27
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,336
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [39/50] batch [20/203] time 0.098 (0.102) data 0.000 (0.019) loss 0.6783 (0.8131) ce_loss 0.3875 (0.5455) teacher_loss 0.1608 (0.3441) loss_zs_kd 0.1662 (0.1650) loss_oracle 0.4344 (0.3865) acc 84.3750 (79.2188) kd_loss 0.9216 (0.8836) lr 3.1545e-04 eta 0:04:05
epoch [39/50] batch [40/203] time 0.086 (0.093) data 0.000 (0.010) loss 0.6575 (0.8049) ce_loss 0.3574 (0.5347) teacher_loss 0.1841 (0.3301) loss_zs_kd 0.1536 (0.1672) loss_oracle 0.3966 (0.3912) acc 90.6250 (80.6250) kd_loss 0.8639 (0.8882) lr 3.1545e-04 eta 0:03:42
epoch [39/50] batch [60/203] time 0.078 (0.089) data 0.000 (0.007) loss 0.5830 (0.8073) ce_loss 0.2023 (0.5385) teacher_loss 0.0963 (0.3297) loss_zs_kd 0.1433 (0.1676) loss_oracle 0.4151 (0.3938) acc 96.8750 (80.7812) kd_loss 0.9364 (0.8860) lr 3.1545e-04 eta 0:03:30
epoch [39/50] batch [80/203] time 0.085 (0.087) data 0.000 (0.005) loss 0.8011 (0.8049) ce_loss 0.5093 (0.5317) teacher_loss 0.3744 (0.3264) loss_zs_kd 0.1572 (0.1701) loss_oracle 0.3481 (0.3934) acc 81.2500 (81.0156) kd_loss 0.8737 (0.8842) lr 3.1545e-04 eta 0:03:24
epoch [39/50] batch [100/203] time 0.078 (0.086) data 0.000 (0.004) loss 0.6728 (0.8007) ce_loss 0.5239 (0.5257) teacher_loss 0.2461 (0.3222) loss_zs_kd 0.1693 (0.1693) loss_oracle 0.3420 (0.3938) acc 78.1250 (80.9062) kd_loss 0.9326 (0.8847) lr 3.1545e-04 eta 0:03:21
epoch [39/50] batch [120/203] time 0.079 (0.086) data 0.000 (0.004) loss 1.0864 (0.8050) ce_loss 0.8633 (0.5288) teacher_loss 0.6959 (0.3255) loss_zs_kd 0.1713 (0.1696) loss_oracle 0.3049 (0.3947) acc 68.7500 (80.8594) kd_loss 0.8647 (0.8852) lr 3.1545e-04 eta 0:03:18
epoch [39/50] batch [140/203] time 0.074 (0.085) data 0.000 (0.003) loss 0.9204 (0.8049) ce_loss 0.5635 (0.5311) teacher_loss 0.3974 (0.3248) loss_zs_kd 0.2040 (0.1694) loss_oracle 0.4210 (0.3954) acc 78.1250 (80.8482) kd_loss 0.8718 (0.8858) lr 3.1545e-04 eta 0:03:15
epoch [39/50] batch [160/203] time 0.082 (0.085) data 0.000 (0.003) loss 0.6761 (0.8088) ce_loss 0.5815 (0.5409) teacher_loss 0.2757 (0.3283) loss_zs_kd 0.1800 (0.1715) loss_oracle 0.3104 (0.3948) acc 78.1250 (80.4883) kd_loss 0.8907 (0.8851) lr 3.1545e-04 eta 0:03:13
epoch [39/50] batch [180/203] time 0.085 (0.085) data 0.000 (0.002) loss 0.8160 (0.8093) ce_loss 0.6475 (0.5425) teacher_loss 0.3959 (0.3291) loss_zs_kd 0.1709 (0.1727) loss_oracle 0.3347 (0.3938) acc 71.8750 (80.3993) kd_loss 0.8939 (0.8850) lr 3.1545e-04 eta 0:03:11
epoch [39/50] batch [200/203] time 0.070 (0.084) data 0.000 (0.002) loss 0.8918 (0.8093) ce_loss 0.5156 (0.5420) teacher_loss 0.3534 (0.3284) loss_zs_kd 0.1810 (0.1721) loss_oracle 0.4479 (0.3949) acc 78.1250 (80.3594) kd_loss 0.9111 (0.8861) lr 3.1545e-04 eta 0:03:07
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,335
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [40/50] batch [20/203] time 0.081 (0.101) data 0.000 (0.016) loss 0.8687 (0.8222) ce_loss 0.6333 (0.5552) teacher_loss 0.3110 (0.3253) loss_zs_kd 0.1925 (0.1786) loss_oracle 0.4615 (0.4076) acc 81.2500 (80.4688) kd_loss 0.9420 (0.8882) lr 2.7103e-04 eta 0:03:42
epoch [40/50] batch [40/203] time 0.085 (0.092) data 0.000 (0.008) loss 0.7988 (0.8184) ce_loss 0.5889 (0.5352) teacher_loss 0.4142 (0.3265) loss_zs_kd 0.1327 (0.1696) loss_oracle 0.3183 (0.4071) acc 75.0000 (81.1719) kd_loss 0.9085 (0.8901) lr 2.7103e-04 eta 0:03:20
epoch [40/50] batch [60/203] time 0.089 (0.089) data 0.001 (0.006) loss 0.9283 (0.8287) ce_loss 0.5605 (0.5434) teacher_loss 0.4481 (0.3320) loss_zs_kd 0.1589 (0.1700) loss_oracle 0.4008 (0.4117) acc 78.1250 (80.6250) kd_loss 0.9135 (0.8949) lr 2.7103e-04 eta 0:03:13
epoch [40/50] batch [80/203] time 0.087 (0.089) data 0.000 (0.004) loss 0.8183 (0.8164) ce_loss 0.5444 (0.5347) teacher_loss 0.3957 (0.3281) loss_zs_kd 0.1448 (0.1694) loss_oracle 0.3503 (0.4036) acc 75.0000 (80.8594) kd_loss 0.8346 (0.8885) lr 2.7103e-04 eta 0:03:11
epoch [40/50] batch [100/203] time 0.089 (0.088) data 0.000 (0.003) loss 0.7392 (0.8138) ce_loss 0.4802 (0.5363) teacher_loss 0.1892 (0.3279) loss_zs_kd 0.2010 (0.1668) loss_oracle 0.4495 (0.4025) acc 84.3750 (80.8438) kd_loss 0.8748 (0.8881) lr 2.7103e-04 eta 0:03:08
epoch [40/50] batch [120/203] time 0.086 (0.088) data 0.000 (0.003) loss 0.7810 (0.8066) ce_loss 0.4727 (0.5350) teacher_loss 0.2676 (0.3215) loss_zs_kd 0.1610 (0.1687) loss_oracle 0.4329 (0.4007) acc 75.0000 (80.8073) kd_loss 0.9373 (0.8893) lr 2.7103e-04 eta 0:03:06
epoch [40/50] batch [140/203] time 0.089 (0.088) data 0.000 (0.003) loss 0.8084 (0.8010) ce_loss 0.5039 (0.5307) teacher_loss 0.3010 (0.3195) loss_zs_kd 0.1623 (0.1679) loss_oracle 0.4263 (0.3976) acc 75.0000 (80.8482) kd_loss 0.8976 (0.8897) lr 2.7103e-04 eta 0:03:03
epoch [40/50] batch [160/203] time 0.097 (0.088) data 0.001 (0.002) loss 1.0650 (0.8012) ce_loss 0.6382 (0.5329) teacher_loss 0.5412 (0.3215) loss_zs_kd 0.1366 (0.1678) loss_oracle 0.4555 (0.3958) acc 81.2500 (80.9766) kd_loss 0.8707 (0.8883) lr 2.7103e-04 eta 0:03:02
epoch [40/50] batch [180/203] time 0.083 (0.088) data 0.000 (0.002) loss 0.8695 (0.8004) ce_loss 0.5586 (0.5359) teacher_loss 0.3653 (0.3215) loss_zs_kd 0.2285 (0.1689) loss_oracle 0.3899 (0.3944) acc 81.2500 (80.7986) kd_loss 0.9238 (0.8897) lr 2.7103e-04 eta 0:03:00
epoch [40/50] batch [200/203] time 0.072 (0.087) data 0.000 (0.002) loss 0.8062 (0.8078) ce_loss 0.4109 (0.5408) teacher_loss 0.2865 (0.3275) loss_zs_kd 0.1766 (0.1696) loss_oracle 0.4314 (0.3955) acc 93.7500 (80.7656) kd_loss 0.9135 (0.8901) lr 2.7103e-04 eta 0:02:56
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,330
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [41/50] batch [20/203] time 0.078 (0.105) data 0.000 (0.020) loss 0.7914 (0.8014) ce_loss 0.5547 (0.5141) teacher_loss 0.2955 (0.3076) loss_zs_kd 0.1643 (0.1697) loss_oracle 0.4138 (0.4089) acc 71.8750 (81.7188) kd_loss 0.9587 (0.9015) lr 2.2949e-04 eta 0:03:30
epoch [41/50] batch [40/203] time 0.095 (0.094) data 0.001 (0.010) loss 0.6854 (0.7943) ce_loss 0.3506 (0.5205) teacher_loss 0.1473 (0.3033) loss_zs_kd 0.1637 (0.1695) loss_oracle 0.4563 (0.4063) acc 84.3750 (80.5469) kd_loss 0.8986 (0.8915) lr 2.2949e-04 eta 0:03:06
epoch [41/50] batch [60/203] time 0.086 (0.090) data 0.001 (0.007) loss 0.9287 (0.7900) ce_loss 0.6958 (0.5266) teacher_loss 0.4742 (0.3097) loss_zs_kd 0.1865 (0.1716) loss_oracle 0.3613 (0.3944) acc 81.2500 (80.8854) kd_loss 0.8307 (0.8903) lr 2.2949e-04 eta 0:02:57
epoch [41/50] batch [80/203] time 0.083 (0.088) data 0.000 (0.005) loss 0.7056 (0.7894) ce_loss 0.4026 (0.5287) teacher_loss 0.1903 (0.3077) loss_zs_kd 0.1635 (0.1728) loss_oracle 0.4336 (0.3953) acc 81.2500 (80.4297) kd_loss 0.8737 (0.8880) lr 2.2949e-04 eta 0:02:51
epoch [41/50] batch [100/203] time 0.093 (0.087) data 0.000 (0.004) loss 0.6768 (0.8007) ce_loss 0.3657 (0.5320) teacher_loss 0.2039 (0.3164) loss_zs_kd 0.1475 (0.1720) loss_oracle 0.3991 (0.3983) acc 87.5000 (79.9375) kd_loss 0.8636 (0.8871) lr 2.2949e-04 eta 0:02:47
epoch [41/50] batch [120/203] time 0.090 (0.086) data 0.000 (0.004) loss 0.6734 (0.8079) ce_loss 0.4854 (0.5352) teacher_loss 0.2852 (0.3202) loss_zs_kd 0.1421 (0.1731) loss_oracle 0.3171 (0.4012) acc 81.2500 (79.8958) kd_loss 0.8367 (0.8893) lr 2.2949e-04 eta 0:02:43
epoch [41/50] batch [140/203] time 0.079 (0.085) data 0.000 (0.003) loss 0.7859 (0.7979) ce_loss 0.5098 (0.5302) teacher_loss 0.3130 (0.3144) loss_zs_kd 0.1797 (0.1729) loss_oracle 0.3830 (0.3971) acc 84.3750 (80.3571) kd_loss 0.8654 (0.8906) lr 2.2949e-04 eta 0:02:40
epoch [41/50] batch [160/203] time 0.087 (0.085) data 0.000 (0.003) loss 0.8952 (0.8000) ce_loss 0.6084 (0.5345) teacher_loss 0.3836 (0.3170) loss_zs_kd 0.2231 (0.1741) loss_oracle 0.4001 (0.3959) acc 81.2500 (80.2148) kd_loss 0.7951 (0.8896) lr 2.2949e-04 eta 0:02:38
epoch [41/50] batch [180/203] time 0.078 (0.084) data 0.000 (0.003) loss 0.7790 (0.7984) ce_loss 0.4451 (0.5343) teacher_loss 0.2630 (0.3170) loss_zs_kd 0.1687 (0.1741) loss_oracle 0.4316 (0.3944) acc 84.3750 (80.2778) kd_loss 0.9401 (0.8906) lr 2.2949e-04 eta 0:02:36
epoch [41/50] batch [200/203] time 0.075 (0.084) data 0.001 (0.002) loss 0.7129 (0.8027) ce_loss 0.6284 (0.5391) teacher_loss 0.3324 (0.3224) loss_zs_kd 0.1800 (0.1734) loss_oracle 0.2905 (0.3936) acc 81.2500 (80.2344) kd_loss 0.8527 (0.8899) lr 2.2949e-04 eta 0:02:32
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,333
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [42/50] batch [20/203] time 0.072 (0.103) data 0.000 (0.018) loss 0.8532 (0.7775) ce_loss 0.6079 (0.5136) teacher_loss 0.3267 (0.2925) loss_zs_kd 0.1744 (0.1827) loss_oracle 0.4393 (0.3937) acc 78.1250 (81.2500) kd_loss 0.8696 (0.8931) lr 1.9098e-04 eta 0:03:05
epoch [42/50] batch [40/203] time 0.089 (0.093) data 0.000 (0.009) loss 0.7262 (0.8111) ce_loss 0.4390 (0.5562) teacher_loss 0.2972 (0.3260) loss_zs_kd 0.1534 (0.1811) loss_oracle 0.3524 (0.3946) acc 87.5000 (79.4531) kd_loss 0.7869 (0.8967) lr 1.9098e-04 eta 0:02:46
epoch [42/50] batch [60/203] time 0.076 (0.091) data 0.001 (0.006) loss 0.5284 (0.7985) ce_loss 0.2783 (0.5414) teacher_loss 0.1630 (0.3167) loss_zs_kd 0.1121 (0.1752) loss_oracle 0.3094 (0.3942) acc 93.7500 (80.4688) kd_loss 0.8967 (0.8965) lr 1.9098e-04 eta 0:02:40
epoch [42/50] batch [80/203] time 0.082 (0.089) data 0.000 (0.005) loss 0.7933 (0.7932) ce_loss 0.5581 (0.5347) teacher_loss 0.4276 (0.3149) loss_zs_kd 0.1268 (0.1745) loss_oracle 0.3023 (0.3909) acc 78.1250 (80.8203) kd_loss 0.9062 (0.8944) lr 1.9098e-04 eta 0:02:35
epoch [42/50] batch [100/203] time 0.091 (0.089) data 0.000 (0.004) loss 0.9038 (0.7979) ce_loss 0.6479 (0.5383) teacher_loss 0.4195 (0.3168) loss_zs_kd 0.1638 (0.1732) loss_oracle 0.4024 (0.3945) acc 65.6250 (80.8125) kd_loss 0.8988 (0.8952) lr 1.9098e-04 eta 0:02:32
epoch [42/50] batch [120/203] time 0.091 (0.088) data 0.000 (0.003) loss 0.7107 (0.7937) ce_loss 0.5981 (0.5385) teacher_loss 0.3140 (0.3132) loss_zs_kd 0.1868 (0.1734) loss_oracle 0.3033 (0.3937) acc 75.0000 (80.8073) kd_loss 0.8689 (0.8929) lr 1.9098e-04 eta 0:02:30
epoch [42/50] batch [140/203] time 0.070 (0.088) data 0.000 (0.003) loss 0.9541 (0.7954) ce_loss 0.6660 (0.5442) teacher_loss 0.5550 (0.3164) loss_zs_kd 0.1660 (0.1740) loss_oracle 0.3161 (0.3921) acc 81.2500 (80.4241) kd_loss 0.9019 (0.8927) lr 1.9098e-04 eta 0:02:27
epoch [42/50] batch [160/203] time 0.084 (0.087) data 0.000 (0.002) loss 0.7064 (0.7982) ce_loss 0.4580 (0.5445) teacher_loss 0.2985 (0.3181) loss_zs_kd 0.1682 (0.1748) loss_oracle 0.3238 (0.3926) acc 81.2500 (80.4297) kd_loss 0.9454 (0.8947) lr 1.9098e-04 eta 0:02:25
epoch [42/50] batch [180/203] time 0.072 (0.086) data 0.000 (0.002) loss 1.0002 (0.7998) ce_loss 0.8657 (0.5450) teacher_loss 0.4376 (0.3193) loss_zs_kd 0.2430 (0.1746) loss_oracle 0.4411 (0.3932) acc 65.6250 (80.5729) kd_loss 0.8783 (0.8922) lr 1.9098e-04 eta 0:02:22
epoch [42/50] batch [200/203] time 0.071 (0.085) data 0.000 (0.002) loss 0.9125 (0.8006) ce_loss 0.6406 (0.5461) teacher_loss 0.4657 (0.3220) loss_zs_kd 0.1589 (0.1742) loss_oracle 0.3674 (0.3915) acc 78.1250 (80.5469) kd_loss 0.9225 (0.8925) lr 1.9098e-04 eta 0:02:18
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,335
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [43/50] batch [20/203] time 0.080 (0.101) data 0.000 (0.017) loss 0.8492 (0.8880) ce_loss 0.5874 (0.6194) teacher_loss 0.4092 (0.3971) loss_zs_kd 0.1670 (0.1646) loss_oracle 0.3566 (0.4087) acc 81.2500 (77.8125) kd_loss 0.8255 (0.9004) lr 1.5567e-04 eta 0:02:41
epoch [43/50] batch [40/203] time 0.082 (0.092) data 0.000 (0.008) loss 0.7157 (0.8574) ce_loss 0.3474 (0.5794) teacher_loss 0.1803 (0.3744) loss_zs_kd 0.1404 (0.1618) loss_oracle 0.4652 (0.4021) acc 87.5000 (80.3125) kd_loss 0.8492 (0.8914) lr 1.5567e-04 eta 0:02:25
epoch [43/50] batch [60/203] time 0.089 (0.090) data 0.000 (0.006) loss 0.7459 (0.8446) ce_loss 0.4216 (0.5699) teacher_loss 0.2277 (0.3623) loss_zs_kd 0.1686 (0.1633) loss_oracle 0.4339 (0.4006) acc 90.6250 (80.5208) kd_loss 0.9208 (0.8871) lr 1.5567e-04 eta 0:02:20
epoch [43/50] batch [80/203] time 0.088 (0.088) data 0.000 (0.004) loss 0.6623 (0.8316) ce_loss 0.3179 (0.5545) teacher_loss 0.1926 (0.3497) loss_zs_kd 0.1416 (0.1629) loss_oracle 0.3988 (0.4005) acc 90.6250 (80.7031) kd_loss 0.9277 (0.8898) lr 1.5567e-04 eta 0:02:16
epoch [43/50] batch [100/203] time 0.087 (0.087) data 0.000 (0.004) loss 0.7720 (0.8302) ce_loss 0.4878 (0.5588) teacher_loss 0.2749 (0.3498) loss_zs_kd 0.1847 (0.1649) loss_oracle 0.4048 (0.3980) acc 84.3750 (80.3750) kd_loss 0.8683 (0.8915) lr 1.5567e-04 eta 0:02:13
epoch [43/50] batch [120/203] time 0.091 (0.087) data 0.000 (0.003) loss 0.7418 (0.8242) ce_loss 0.3247 (0.5501) teacher_loss 0.1770 (0.3402) loss_zs_kd 0.1312 (0.1660) loss_oracle 0.4992 (0.4010) acc 87.5000 (80.7292) kd_loss 0.9130 (0.8924) lr 1.5567e-04 eta 0:02:10
epoch [43/50] batch [140/203] time 0.083 (0.087) data 0.000 (0.003) loss 0.8513 (0.8285) ce_loss 0.6533 (0.5616) teacher_loss 0.4192 (0.3443) loss_zs_kd 0.1753 (0.1661) loss_oracle 0.3445 (0.4011) acc 78.1250 (80.3125) kd_loss 0.9130 (0.8927) lr 1.5567e-04 eta 0:02:08
epoch [43/50] batch [160/203] time 0.085 (0.087) data 0.000 (0.002) loss 0.7172 (0.8292) ce_loss 0.4072 (0.5618) teacher_loss 0.2576 (0.3429) loss_zs_kd 0.1533 (0.1684) loss_oracle 0.3830 (0.4021) acc 93.7500 (80.1562) kd_loss 0.8703 (0.8916) lr 1.5567e-04 eta 0:02:06
epoch [43/50] batch [180/203] time 0.082 (0.086) data 0.000 (0.002) loss 0.7580 (0.8233) ce_loss 0.5327 (0.5598) teacher_loss 0.2940 (0.3391) loss_zs_kd 0.1798 (0.1689) loss_oracle 0.3741 (0.3997) acc 81.2500 (79.9653) kd_loss 0.9208 (0.8928) lr 1.5567e-04 eta 0:02:04
epoch [43/50] batch [200/203] time 0.072 (0.085) data 0.000 (0.002) loss 0.8295 (0.8246) ce_loss 0.5132 (0.5614) teacher_loss 0.3103 (0.3411) loss_zs_kd 0.1655 (0.1697) loss_oracle 0.4365 (0.3987) acc 78.1250 (79.7812) kd_loss 0.9078 (0.8916) lr 1.5567e-04 eta 0:02:01
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,336
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 87.0%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [44/50] batch [20/203] time 0.078 (0.098) data 0.000 (0.015) loss 0.7883 (0.8011) ce_loss 0.6763 (0.5426) teacher_loss 0.3319 (0.3216) loss_zs_kd 0.2479 (0.1707) loss_oracle 0.3324 (0.3941) acc 75.0000 (81.5625) kd_loss 0.8910 (0.8741) lr 1.2369e-04 eta 0:02:16
epoch [44/50] batch [40/203] time 0.089 (0.091) data 0.000 (0.007) loss 0.7032 (0.8103) ce_loss 0.3584 (0.5373) teacher_loss 0.2056 (0.3203) loss_zs_kd 0.1965 (0.1750) loss_oracle 0.3994 (0.4025) acc 90.6250 (81.4844) kd_loss 0.8647 (0.8828) lr 1.2369e-04 eta 0:02:05
epoch [44/50] batch [60/203] time 0.094 (0.090) data 0.001 (0.005) loss 0.6726 (0.8071) ce_loss 0.4111 (0.5296) teacher_loss 0.2718 (0.3187) loss_zs_kd 0.1206 (0.1730) loss_oracle 0.3405 (0.4019) acc 87.5000 (81.7708) kd_loss 0.9133 (0.8893) lr 1.2369e-04 eta 0:02:02
epoch [44/50] batch [80/203] time 0.081 (0.089) data 0.000 (0.004) loss 0.6944 (0.8183) ce_loss 0.3813 (0.5351) teacher_loss 0.1930 (0.3295) loss_zs_kd 0.1686 (0.1717) loss_oracle 0.4171 (0.4030) acc 87.5000 (81.3672) kd_loss 0.9706 (0.8893) lr 1.2369e-04 eta 0:01:59
epoch [44/50] batch [100/203] time 0.083 (0.088) data 0.000 (0.003) loss 0.7689 (0.8227) ce_loss 0.4778 (0.5390) teacher_loss 0.2695 (0.3367) loss_zs_kd 0.1456 (0.1680) loss_oracle 0.4267 (0.4020) acc 90.6250 (81.0312) kd_loss 0.9111 (0.8889) lr 1.2369e-04 eta 0:01:56
epoch [44/50] batch [120/203] time 0.087 (0.088) data 0.000 (0.003) loss 0.7360 (0.8217) ce_loss 0.3433 (0.5377) teacher_loss 0.2102 (0.3358) loss_zs_kd 0.1616 (0.1678) loss_oracle 0.4450 (0.4020) acc 87.5000 (80.8333) kd_loss 0.9566 (0.8909) lr 1.2369e-04 eta 0:01:54
epoch [44/50] batch [140/203] time 0.089 (0.088) data 0.000 (0.002) loss 0.8111 (0.8258) ce_loss 0.5249 (0.5451) teacher_loss 0.3371 (0.3388) loss_zs_kd 0.1681 (0.1686) loss_oracle 0.3900 (0.4027) acc 84.3750 (80.4688) kd_loss 0.9379 (0.8913) lr 1.2369e-04 eta 0:01:52
epoch [44/50] batch [160/203] time 0.094 (0.088) data 0.001 (0.002) loss 0.7159 (0.8232) ce_loss 0.3059 (0.5373) teacher_loss 0.2201 (0.3339) loss_zs_kd 0.1365 (0.1686) loss_oracle 0.4276 (0.4050) acc 93.7500 (80.7812) kd_loss 0.8488 (0.8918) lr 1.2369e-04 eta 0:01:51
epoch [44/50] batch [180/203] time 0.088 (0.088) data 0.000 (0.002) loss 1.0696 (0.8251) ce_loss 0.7158 (0.5408) teacher_loss 0.5790 (0.3350) loss_zs_kd 0.1836 (0.1688) loss_oracle 0.3989 (0.4057) acc 78.1250 (80.5556) kd_loss 0.9152 (0.8907) lr 1.2369e-04 eta 0:01:49
epoch [44/50] batch [200/203] time 0.070 (0.087) data 0.000 (0.002) loss 0.9561 (0.8252) ce_loss 0.6196 (0.5429) teacher_loss 0.3926 (0.3354) loss_zs_kd 0.1910 (0.1699) loss_oracle 0.4680 (0.4049) acc 78.1250 (80.2656) kd_loss 0.9329 (0.8909) lr 1.2369e-04 eta 0:01:46
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,336
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [45/50] batch [20/203] time 0.080 (0.094) data 0.000 (0.013) loss 0.6691 (0.7907) ce_loss 0.2722 (0.4858) teacher_loss 0.1092 (0.2976) loss_zs_kd 0.1523 (0.1710) loss_oracle 0.4838 (0.4075) acc 96.8750 (81.2500) kd_loss 0.8887 (0.8779) lr 9.5173e-05 eta 0:01:52
epoch [45/50] batch [40/203] time 0.083 (0.088) data 0.000 (0.007) loss 0.9997 (0.8077) ce_loss 0.7373 (0.5221) teacher_loss 0.5594 (0.3264) loss_zs_kd 0.1865 (0.1637) loss_oracle 0.3471 (0.3994) acc 71.8750 (80.7031) kd_loss 0.9135 (0.8818) lr 9.5173e-05 eta 0:01:43
epoch [45/50] batch [60/203] time 0.087 (0.087) data 0.001 (0.004) loss 0.7140 (0.8155) ce_loss 0.4680 (0.5294) teacher_loss 0.1821 (0.3306) loss_zs_kd 0.1989 (0.1643) loss_oracle 0.4324 (0.4027) acc 87.5000 (80.6250) kd_loss 0.8983 (0.8801) lr 9.5173e-05 eta 0:01:41
epoch [45/50] batch [80/203] time 0.083 (0.086) data 0.000 (0.003) loss 0.8612 (0.8189) ce_loss 0.4851 (0.5389) teacher_loss 0.3811 (0.3384) loss_zs_kd 0.1622 (0.1656) loss_oracle 0.3990 (0.3977) acc 84.3750 (80.0781) kd_loss 0.9203 (0.8766) lr 9.5173e-05 eta 0:01:38
epoch [45/50] batch [100/203] time 0.090 (0.086) data 0.001 (0.003) loss 1.1422 (0.8193) ce_loss 0.9170 (0.5442) teacher_loss 0.5109 (0.3356) loss_zs_kd 0.1959 (0.1659) loss_oracle 0.5333 (0.4007) acc 65.6250 (79.7500) kd_loss 1.0083 (0.8804) lr 9.5173e-05 eta 0:01:36
epoch [45/50] batch [120/203] time 0.094 (0.086) data 0.001 (0.002) loss 0.6490 (0.8162) ce_loss 0.2003 (0.5385) teacher_loss 0.0979 (0.3313) loss_zs_kd 0.1874 (0.1665) loss_oracle 0.4574 (0.4017) acc 100.0000 (79.8438) kd_loss 0.8895 (0.8794) lr 9.5173e-05 eta 0:01:34
epoch [45/50] batch [140/203] time 0.082 (0.087) data 0.000 (0.002) loss 0.7985 (0.8114) ce_loss 0.6050 (0.5417) teacher_loss 0.3594 (0.3297) loss_zs_kd 0.1587 (0.1663) loss_oracle 0.3597 (0.3986) acc 78.1250 (79.8438) kd_loss 0.8756 (0.8806) lr 9.5173e-05 eta 0:01:33
epoch [45/50] batch [160/203] time 0.081 (0.087) data 0.000 (0.002) loss 0.9928 (0.8137) ce_loss 0.8096 (0.5430) teacher_loss 0.5500 (0.3313) loss_zs_kd 0.1437 (0.1659) loss_oracle 0.3710 (0.3995) acc 75.0000 (80.1172) kd_loss 0.8638 (0.8825) lr 9.5173e-05 eta 0:01:31
epoch [45/50] batch [180/203] time 0.088 (0.087) data 0.000 (0.002) loss 0.8381 (0.8121) ce_loss 0.4641 (0.5428) teacher_loss 0.2702 (0.3307) loss_zs_kd 0.1725 (0.1661) loss_oracle 0.4816 (0.3983) acc 84.3750 (79.9826) kd_loss 0.8269 (0.8828) lr 9.5173e-05 eta 0:01:29
epoch [45/50] batch [200/203] time 0.074 (0.086) data 0.000 (0.002) loss 1.0971 (0.8149) ce_loss 0.8477 (0.5479) teacher_loss 0.6866 (0.3335) loss_zs_kd 0.1781 (0.1676) loss_oracle 0.3215 (0.3976) acc 62.5000 (79.6406) kd_loss 0.8616 (0.8843) lr 9.5173e-05 eta 0:01:27
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,338
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 87.0%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [46/50] batch [20/203] time 0.081 (0.099) data 0.000 (0.015) loss 0.6675 (0.7825) ce_loss 0.2937 (0.5317) teacher_loss 0.1552 (0.2994) loss_zs_kd 0.1928 (0.1812) loss_oracle 0.4159 (0.3925) acc 93.7500 (81.8750) kd_loss 0.8185 (0.8949) lr 7.0224e-05 eta 0:01:38
epoch [46/50] batch [40/203] time 0.078 (0.090) data 0.000 (0.008) loss 0.6837 (0.7974) ce_loss 0.6504 (0.5504) teacher_loss 0.2832 (0.3209) loss_zs_kd 0.1935 (0.1780) loss_oracle 0.3037 (0.3875) acc 71.8750 (80.8594) kd_loss 0.8151 (0.8866) lr 7.0224e-05 eta 0:01:27
epoch [46/50] batch [60/203] time 0.082 (0.089) data 0.001 (0.005) loss 0.9414 (0.7970) ce_loss 0.7944 (0.5441) teacher_loss 0.4359 (0.3197) loss_zs_kd 0.2139 (0.1755) loss_oracle 0.3985 (0.3896) acc 78.1250 (80.8854) kd_loss 0.8840 (0.8865) lr 7.0224e-05 eta 0:01:25
epoch [46/50] batch [80/203] time 0.084 (0.088) data 0.000 (0.004) loss 0.6440 (0.7960) ce_loss 0.3433 (0.5353) teacher_loss 0.1740 (0.3190) loss_zs_kd 0.1578 (0.1738) loss_oracle 0.3911 (0.3902) acc 87.5000 (81.0547) kd_loss 0.8789 (0.8865) lr 7.0224e-05 eta 0:01:22
epoch [46/50] batch [100/203] time 0.085 (0.087) data 0.000 (0.003) loss 0.6465 (0.7926) ce_loss 0.4912 (0.5304) teacher_loss 0.1995 (0.3167) loss_zs_kd 0.1747 (0.1729) loss_oracle 0.3597 (0.3894) acc 78.1250 (81.2500) kd_loss 0.8699 (0.8838) lr 7.0224e-05 eta 0:01:19
epoch [46/50] batch [120/203] time 0.081 (0.087) data 0.000 (0.003) loss 0.7778 (0.7964) ce_loss 0.5244 (0.5340) teacher_loss 0.2967 (0.3188) loss_zs_kd 0.1353 (0.1747) loss_oracle 0.4135 (0.3903) acc 81.2500 (81.3281) kd_loss 0.9296 (0.8861) lr 7.0224e-05 eta 0:01:17
epoch [46/50] batch [140/203] time 0.088 (0.087) data 0.000 (0.002) loss 0.8982 (0.8003) ce_loss 0.7998 (0.5362) teacher_loss 0.5131 (0.3215) loss_zs_kd 0.1710 (0.1736) loss_oracle 0.2996 (0.3920) acc 59.3750 (81.2054) kd_loss 0.8687 (0.8869) lr 7.0224e-05 eta 0:01:15
epoch [46/50] batch [160/203] time 0.091 (0.086) data 0.000 (0.002) loss 0.6400 (0.8007) ce_loss 0.3247 (0.5328) teacher_loss 0.1271 (0.3195) loss_zs_kd 0.1836 (0.1729) loss_oracle 0.4211 (0.3948) acc 87.5000 (81.3086) kd_loss 0.9496 (0.8863) lr 7.0224e-05 eta 0:01:13
epoch [46/50] batch [180/203] time 0.074 (0.086) data 0.000 (0.002) loss 0.8314 (0.8030) ce_loss 0.6294 (0.5361) teacher_loss 0.3851 (0.3217) loss_zs_kd 0.1445 (0.1724) loss_oracle 0.3740 (0.3951) acc 87.5000 (81.1632) kd_loss 0.9266 (0.8868) lr 7.0224e-05 eta 0:01:11
epoch [46/50] batch [200/203] time 0.076 (0.085) data 0.000 (0.002) loss 0.8493 (0.8072) ce_loss 0.5439 (0.5383) teacher_loss 0.3341 (0.3225) loss_zs_kd 0.2020 (0.1729) loss_oracle 0.4142 (0.3982) acc 81.2500 (81.0000) kd_loss 0.9431 (0.8883) lr 7.0224e-05 eta 0:01:09
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,335
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [47/50] batch [20/203] time 0.083 (0.102) data 0.000 (0.017) loss 0.6583 (0.8122) ce_loss 0.5029 (0.5909) teacher_loss 0.1865 (0.3436) loss_zs_kd 0.1842 (0.1703) loss_oracle 0.3796 (0.3834) acc 81.2500 (78.4375) kd_loss 0.9226 (0.8742) lr 4.8943e-05 eta 0:01:20
epoch [47/50] batch [40/203] time 0.089 (0.093) data 0.000 (0.009) loss 0.7043 (0.8064) ce_loss 0.4788 (0.5552) teacher_loss 0.2131 (0.3224) loss_zs_kd 0.1896 (0.1690) loss_oracle 0.3965 (0.3995) acc 90.6250 (79.9219) kd_loss 0.8594 (0.8780) lr 4.8943e-05 eta 0:01:11
epoch [47/50] batch [60/203] time 0.084 (0.089) data 0.001 (0.006) loss 0.9563 (0.8051) ce_loss 0.7812 (0.5402) teacher_loss 0.4464 (0.3159) loss_zs_kd 0.1914 (0.1682) loss_oracle 0.4142 (0.4051) acc 75.0000 (80.4688) kd_loss 0.8980 (0.8816) lr 4.8943e-05 eta 0:01:06
epoch [47/50] batch [80/203] time 0.075 (0.087) data 0.000 (0.004) loss 0.9422 (0.8070) ce_loss 0.8042 (0.5430) teacher_loss 0.4388 (0.3189) loss_zs_kd 0.1462 (0.1672) loss_oracle 0.4303 (0.4045) acc 71.8750 (80.7031) kd_loss 0.8634 (0.8828) lr 4.8943e-05 eta 0:01:03
epoch [47/50] batch [100/203] time 0.090 (0.086) data 0.000 (0.004) loss 0.8719 (0.8043) ce_loss 0.6172 (0.5473) teacher_loss 0.4134 (0.3209) loss_zs_kd 0.1835 (0.1666) loss_oracle 0.3667 (0.4002) acc 78.1250 (80.6562) kd_loss 0.8378 (0.8845) lr 4.8943e-05 eta 0:01:01
epoch [47/50] batch [120/203] time 0.068 (0.085) data 0.000 (0.003) loss 0.8150 (0.8073) ce_loss 0.5581 (0.5502) teacher_loss 0.3368 (0.3252) loss_zs_kd 0.1826 (0.1679) loss_oracle 0.3868 (0.3981) acc 78.1250 (80.3385) kd_loss 0.8995 (0.8839) lr 4.8943e-05 eta 0:00:59
epoch [47/50] batch [140/203] time 0.089 (0.085) data 0.000 (0.003) loss 0.9223 (0.8124) ce_loss 0.5557 (0.5506) teacher_loss 0.4376 (0.3291) loss_zs_kd 0.1276 (0.1681) loss_oracle 0.4209 (0.3994) acc 87.5000 (80.2455) kd_loss 0.8679 (0.8846) lr 4.8943e-05 eta 0:00:56
epoch [47/50] batch [160/203] time 0.097 (0.085) data 0.000 (0.002) loss 0.9127 (0.8095) ce_loss 0.7944 (0.5450) teacher_loss 0.4005 (0.3269) loss_zs_kd 0.1895 (0.1684) loss_oracle 0.4175 (0.3985) acc 68.7500 (80.5273) kd_loss 0.8641 (0.8853) lr 4.8943e-05 eta 0:00:55
epoch [47/50] batch [180/203] time 0.065 (0.083) data 0.000 (0.002) loss 0.8607 (0.8076) ce_loss 0.4895 (0.5442) teacher_loss 0.3652 (0.3255) loss_zs_kd 0.1538 (0.1685) loss_oracle 0.4187 (0.3979) acc 81.2500 (80.3472) kd_loss 0.8716 (0.8859) lr 4.8943e-05 eta 0:00:52
epoch [47/50] batch [200/203] time 0.072 (0.081) data 0.000 (0.002) loss 0.7968 (0.8115) ce_loss 0.5405 (0.5487) teacher_loss 0.3279 (0.3295) loss_zs_kd 0.1921 (0.1688) loss_oracle 0.3728 (0.3976) acc 81.2500 (79.9531) kd_loss 0.9024 (0.8874) lr 4.8943e-05 eta 0:00:49
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,337
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 87.0%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [48/50] batch [20/203] time 0.094 (0.100) data 0.001 (0.016) loss 0.7659 (0.7742) ce_loss 0.5117 (0.5152) teacher_loss 0.2926 (0.2854) loss_zs_kd 0.1353 (0.1813) loss_oracle 0.4056 (0.3982) acc 75.0000 (78.9062) kd_loss 0.9136 (0.8804) lr 3.1417e-05 eta 0:00:58
epoch [48/50] batch [40/203] time 0.080 (0.092) data 0.000 (0.008) loss 1.1403 (0.8212) ce_loss 0.8765 (0.5618) teacher_loss 0.6551 (0.3283) loss_zs_kd 0.1924 (0.1760) loss_oracle 0.3889 (0.4048) acc 59.3750 (78.0469) kd_loss 0.9196 (0.8844) lr 3.1417e-05 eta 0:00:52
epoch [48/50] batch [60/203] time 0.089 (0.089) data 0.000 (0.005) loss 1.2501 (0.8255) ce_loss 1.0225 (0.5621) teacher_loss 0.6462 (0.3381) loss_zs_kd 0.1595 (0.1740) loss_oracle 0.5242 (0.4003) acc 75.0000 (78.1771) kd_loss 0.9013 (0.8825) lr 3.1417e-05 eta 0:00:48
epoch [48/50] batch [80/203] time 0.079 (0.087) data 0.000 (0.004) loss 0.8465 (0.8242) ce_loss 0.4817 (0.5579) teacher_loss 0.2537 (0.3356) loss_zs_kd 0.1563 (0.1740) loss_oracle 0.5146 (0.4016) acc 78.1250 (78.8672) kd_loss 0.9007 (0.8824) lr 3.1417e-05 eta 0:00:46
epoch [48/50] batch [100/203] time 0.084 (0.086) data 0.000 (0.003) loss 0.8268 (0.8309) ce_loss 0.4814 (0.5569) teacher_loss 0.3512 (0.3421) loss_zs_kd 0.1589 (0.1719) loss_oracle 0.3961 (0.4029) acc 81.2500 (78.8750) kd_loss 0.9468 (0.8842) lr 3.1417e-05 eta 0:00:43
epoch [48/50] batch [120/203] time 0.084 (0.085) data 0.001 (0.003) loss 0.9041 (0.8329) ce_loss 0.5278 (0.5622) teacher_loss 0.4439 (0.3465) loss_zs_kd 0.1534 (0.1719) loss_oracle 0.3835 (0.4005) acc 81.2500 (78.8281) kd_loss 0.8444 (0.8836) lr 3.1417e-05 eta 0:00:41
epoch [48/50] batch [140/203] time 0.085 (0.085) data 0.000 (0.002) loss 0.6823 (0.8276) ce_loss 0.3489 (0.5552) teacher_loss 0.1717 (0.3402) loss_zs_kd 0.1522 (0.1731) loss_oracle 0.4345 (0.4008) acc 87.5000 (79.0848) kd_loss 0.9366 (0.8843) lr 3.1417e-05 eta 0:00:39
epoch [48/50] batch [160/203] time 0.083 (0.085) data 0.000 (0.002) loss 0.7144 (0.8247) ce_loss 0.4541 (0.5504) teacher_loss 0.1946 (0.3366) loss_zs_kd 0.2019 (0.1726) loss_oracle 0.4188 (0.4018) acc 78.1250 (79.4141) kd_loss 0.9592 (0.8859) lr 3.1417e-05 eta 0:00:38
epoch [48/50] batch [180/203] time 0.088 (0.085) data 0.000 (0.002) loss 1.0897 (0.8222) ce_loss 0.8955 (0.5482) teacher_loss 0.6390 (0.3363) loss_zs_kd 0.1556 (0.1709) loss_oracle 0.3729 (0.4004) acc 59.3750 (79.6354) kd_loss 0.9220 (0.8858) lr 3.1417e-05 eta 0:00:36
epoch [48/50] batch [200/203] time 0.078 (0.085) data 0.000 (0.002) loss 0.7506 (0.8170) ce_loss 0.6309 (0.5471) teacher_loss 0.2831 (0.3333) loss_zs_kd 0.1795 (0.1705) loss_oracle 0.3779 (0.3985) acc 78.1250 (79.7656) kd_loss 0.8442 (0.8860) lr 3.1417e-05 eta 0:00:34
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,335
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [49/50] batch [20/203] time 0.091 (0.099) data 0.000 (0.015) loss 1.1255 (0.8343) ce_loss 0.7095 (0.5481) teacher_loss 0.5896 (0.3413) loss_zs_kd 0.1769 (0.1622) loss_oracle 0.4475 (0.4119) acc 71.8750 (79.3750) kd_loss 0.7979 (0.8817) lr 1.7713e-05 eta 0:00:38
epoch [49/50] batch [40/203] time 0.093 (0.091) data 0.001 (0.008) loss 0.7648 (0.8068) ce_loss 0.3965 (0.5359) teacher_loss 0.2855 (0.3251) loss_zs_kd 0.1525 (0.1678) loss_oracle 0.4030 (0.3978) acc 75.0000 (80.4688) kd_loss 0.9060 (0.8810) lr 1.7713e-05 eta 0:00:33
epoch [49/50] batch [60/203] time 0.088 (0.089) data 0.001 (0.005) loss 0.9176 (0.8168) ce_loss 0.6187 (0.5457) teacher_loss 0.4122 (0.3352) loss_zs_kd 0.2061 (0.1686) loss_oracle 0.4023 (0.3974) acc 81.2500 (80.1562) kd_loss 0.9100 (0.8840) lr 1.7713e-05 eta 0:00:30
epoch [49/50] batch [80/203] time 0.087 (0.088) data 0.000 (0.004) loss 0.8178 (0.8136) ce_loss 0.5688 (0.5544) teacher_loss 0.3608 (0.3406) loss_zs_kd 0.1663 (0.1693) loss_oracle 0.3739 (0.3884) acc 81.2500 (79.9609) kd_loss 0.8241 (0.8841) lr 1.7713e-05 eta 0:00:28
epoch [49/50] batch [100/203] time 0.081 (0.087) data 0.000 (0.003) loss 1.0093 (0.8174) ce_loss 0.6284 (0.5624) teacher_loss 0.4737 (0.3421) loss_zs_kd 0.1323 (0.1706) loss_oracle 0.4695 (0.3901) acc 75.0000 (79.4688) kd_loss 0.9305 (0.8875) lr 1.7713e-05 eta 0:00:26
epoch [49/50] batch [120/203] time 0.081 (0.087) data 0.000 (0.003) loss 0.9067 (0.8172) ce_loss 0.6626 (0.5585) teacher_loss 0.3732 (0.3408) loss_zs_kd 0.2256 (0.1717) loss_oracle 0.4207 (0.3905) acc 78.1250 (79.5833) kd_loss 0.9369 (0.8881) lr 1.7713e-05 eta 0:00:24
epoch [49/50] batch [140/203] time 0.085 (0.087) data 0.000 (0.002) loss 1.0365 (0.8158) ce_loss 0.8140 (0.5536) teacher_loss 0.4937 (0.3368) loss_zs_kd 0.1943 (0.1717) loss_oracle 0.4456 (0.3932) acc 87.5000 (79.7321) kd_loss 0.9609 (0.8890) lr 1.7713e-05 eta 0:00:23
epoch [49/50] batch [160/203] time 0.084 (0.086) data 0.000 (0.002) loss 1.0368 (0.8108) ce_loss 0.7617 (0.5466) teacher_loss 0.5654 (0.3328) loss_zs_kd 0.1739 (0.1707) loss_oracle 0.3844 (0.3927) acc 75.0000 (79.9805) kd_loss 0.8658 (0.8877) lr 1.7713e-05 eta 0:00:21
epoch [49/50] batch [180/203] time 0.098 (0.086) data 0.001 (0.002) loss 0.6805 (0.8139) ce_loss 0.4280 (0.5472) teacher_loss 0.2174 (0.3339) loss_zs_kd 0.1883 (0.1705) loss_oracle 0.3690 (0.3947) acc 81.2500 (80.0000) kd_loss 0.9188 (0.8868) lr 1.7713e-05 eta 0:00:19
epoch [49/50] batch [200/203] time 0.071 (0.086) data 0.000 (0.002) loss 0.8319 (0.8125) ce_loss 0.4175 (0.5462) teacher_loss 0.3720 (0.3327) loss_zs_kd 0.1218 (0.1710) loss_oracle 0.3990 (0.3942) acc 87.5000 (80.2500) kd_loss 0.8451 (0.8854) lr 1.7713e-05 eta 0:00:17
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,335
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [50/50] batch [20/203] time 0.079 (0.102) data 0.000 (0.018) loss 1.1276 (0.8486) ce_loss 0.7910 (0.5546) teacher_loss 0.5019 (0.3499) loss_zs_kd 0.2208 (0.1693) loss_oracle 0.5152 (0.4141) acc 68.7500 (79.8438) kd_loss 0.9072 (0.8804) lr 7.8853e-06 eta 0:00:18
epoch [50/50] batch [40/203] time 0.081 (0.090) data 0.000 (0.009) loss 0.8681 (0.8294) ce_loss 0.7109 (0.5483) teacher_loss 0.3645 (0.3376) loss_zs_kd 0.2012 (0.1709) loss_oracle 0.4030 (0.4064) acc 65.6250 (79.8438) kd_loss 0.8629 (0.8854) lr 7.8853e-06 eta 0:00:14
epoch [50/50] batch [60/203] time 0.070 (0.086) data 0.000 (0.006) loss 0.8845 (0.8260) ce_loss 0.6138 (0.5551) teacher_loss 0.4350 (0.3417) loss_zs_kd 0.1656 (0.1695) loss_oracle 0.3668 (0.3996) acc 78.1250 (79.4792) kd_loss 0.8449 (0.8781) lr 7.8853e-06 eta 0:00:12
epoch [50/50] batch [80/203] time 0.079 (0.085) data 0.000 (0.005) loss 0.7580 (0.8199) ce_loss 0.4495 (0.5463) teacher_loss 0.2619 (0.3342) loss_zs_kd 0.1773 (0.1711) loss_oracle 0.4074 (0.4001) acc 81.2500 (79.9609) kd_loss 0.8843 (0.8790) lr 7.8853e-06 eta 0:00:10
epoch [50/50] batch [100/203] time 0.091 (0.085) data 0.000 (0.004) loss 0.8205 (0.8134) ce_loss 0.5542 (0.5367) teacher_loss 0.3651 (0.3285) loss_zs_kd 0.2052 (0.1702) loss_oracle 0.3528 (0.3998) acc 84.3750 (80.3750) kd_loss 0.8688 (0.8809) lr 7.8853e-06 eta 0:00:08
epoch [50/50] batch [120/203] time 0.090 (0.085) data 0.000 (0.003) loss 0.6684 (0.8175) ce_loss 0.4106 (0.5422) teacher_loss 0.2443 (0.3325) loss_zs_kd 0.1618 (0.1702) loss_oracle 0.3432 (0.3999) acc 90.6250 (80.2865) kd_loss 0.9006 (0.8832) lr 7.8853e-06 eta 0:00:07
epoch [50/50] batch [140/203] time 0.087 (0.085) data 0.000 (0.003) loss 0.6649 (0.8167) ce_loss 0.3853 (0.5431) teacher_loss 0.2221 (0.3321) loss_zs_kd 0.1535 (0.1707) loss_oracle 0.3660 (0.3992) acc 93.7500 (80.1562) kd_loss 0.7879 (0.8817) lr 7.8853e-06 eta 0:00:05
epoch [50/50] batch [160/203] time 0.079 (0.084) data 0.000 (0.003) loss 1.0375 (0.8164) ce_loss 0.8203 (0.5463) teacher_loss 0.5831 (0.3335) loss_zs_kd 0.1533 (0.1707) loss_oracle 0.3777 (0.3975) acc 75.0000 (80.0781) kd_loss 0.7993 (0.8804) lr 7.8853e-06 eta 0:00:03
epoch [50/50] batch [180/203] time 0.084 (0.084) data 0.000 (0.002) loss 0.8863 (0.8100) ce_loss 0.5303 (0.5404) teacher_loss 0.3984 (0.3296) loss_zs_kd 0.1708 (0.1700) loss_oracle 0.4025 (0.3954) acc 81.2500 (80.3819) kd_loss 0.8101 (0.8812) lr 7.8853e-06 eta 0:00:01
epoch [50/50] batch [200/203] time 0.071 (0.084) data 0.000 (0.002) loss 0.8581 (0.8132) ce_loss 0.5781 (0.5445) teacher_loss 0.3495 (0.3320) loss_zs_kd 0.1840 (0.1707) loss_oracle 0.4166 (0.3958) acc 75.0000 (80.1875) kd_loss 0.9041 (0.8819) lr 7.8853e-06 eta 0:00:00
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,335
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
Checkpoint saved to icml/multi-dg/oracle/02_no_ce/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:17:46
