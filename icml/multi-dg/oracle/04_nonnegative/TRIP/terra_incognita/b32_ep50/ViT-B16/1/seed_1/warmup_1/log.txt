Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ---------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_38', 'location_43', 'location_46']
Target     ['location_100']
# classes  10
# train_x  13,713
# val      5,876
# test     4,741
---------  ---------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/428] time 0.103 (0.161) data 0.000 (0.034) loss 2.5099 (2.4758) ce_loss 2.5078 (2.4749) teacher_loss 2.5092 (2.4747) loss_zs_kd 0.0003 (0.0001) loss_oracle 0.0006 (0.0010) acc 31.2500 (23.4375) kd_loss 0.0021 (0.0040) lr 1.0000e-05 eta 0:57:21
epoch [1/50] batch [40/428] time 0.092 (0.130) data 0.000 (0.017) loss 2.4998 (2.4023) ce_loss 2.4980 (2.4014) teacher_loss 2.4987 (2.4015) loss_zs_kd 0.0016 (0.0004) loss_oracle 0.0002 (0.0007) acc 18.7500 (25.7031) kd_loss 0.0008 (0.0025) lr 1.0000e-05 eta 0:46:17
epoch [1/50] batch [60/428] time 0.107 (0.121) data 0.000 (0.012) loss 2.5742 (2.3800) ce_loss 2.5723 (2.3789) teacher_loss 2.5715 (2.3789) loss_zs_kd 0.0042 (0.0013) loss_oracle 0.0006 (0.0005) acc 28.1250 (26.2500) kd_loss 0.0018 (0.0019) lr 1.0000e-05 eta 0:42:55
epoch [1/50] batch [80/428] time 0.093 (0.116) data 0.000 (0.009) loss 2.2820 (2.3582) ce_loss 2.2773 (2.3565) teacher_loss 2.2779 (2.3564) loss_zs_kd 0.0071 (0.0026) loss_oracle 0.0005 (0.0005) acc 31.2500 (26.5625) kd_loss 0.0016 (0.0018) lr 1.0000e-05 eta 0:41:20
epoch [1/50] batch [100/428] time 0.111 (0.114) data 0.000 (0.007) loss 2.3547 (2.3365) ce_loss 2.3496 (2.3340) teacher_loss 2.3485 (2.3338) loss_zs_kd 0.0114 (0.0044) loss_oracle 0.0005 (0.0005) acc 28.1250 (27.0312) kd_loss 0.0014 (0.0018) lr 1.0000e-05 eta 0:40:17
epoch [1/50] batch [120/428] time 0.109 (0.112) data 0.000 (0.006) loss 2.2949 (2.3163) ce_loss 2.2812 (2.3126) teacher_loss 2.2827 (2.3125) loss_zs_kd 0.0228 (0.0065) loss_oracle 0.0009 (0.0005) acc 37.5000 (27.7083) kd_loss 0.0021 (0.0017) lr 1.0000e-05 eta 0:39:47
epoch [1/50] batch [140/428] time 0.109 (0.111) data 0.000 (0.005) loss 2.2429 (2.3157) ce_loss 2.2266 (2.3107) teacher_loss 2.2264 (2.3105) loss_zs_kd 0.0307 (0.0091) loss_oracle 0.0011 (0.0006) acc 21.8750 (27.7455) kd_loss 0.0027 (0.0018) lr 1.0000e-05 eta 0:39:16
epoch [1/50] batch [160/428] time 0.102 (0.110) data 0.000 (0.005) loss 2.1419 (2.2925) ce_loss 2.1211 (2.2856) teacher_loss 2.1207 (2.2853) loss_zs_kd 0.0389 (0.0130) loss_oracle 0.0018 (0.0006) acc 37.5000 (28.1641) kd_loss 0.0044 (0.0019) lr 1.0000e-05 eta 0:38:59
epoch [1/50] batch [180/428] time 0.081 (0.109) data 0.000 (0.004) loss 2.4260 (2.2679) ce_loss 2.3828 (2.2576) teacher_loss 2.3834 (2.2574) loss_zs_kd 0.0804 (0.0196) loss_oracle 0.0024 (0.0008) acc 25.0000 (28.7674) kd_loss 0.0049 (0.0021) lr 1.0000e-05 eta 0:38:26
epoch [1/50] batch [200/428] time 0.140 (0.107) data 0.000 (0.004) loss 2.0249 (2.2505) ce_loss 1.9717 (2.2367) teacher_loss 1.9708 (2.2363) loss_zs_kd 0.1001 (0.0263) loss_oracle 0.0041 (0.0010) acc 37.5000 (29.2500) kd_loss 0.0070 (0.0026) lr 1.0000e-05 eta 0:37:41
epoch [1/50] batch [220/428] time 0.089 (0.106) data 0.000 (0.003) loss 2.5380 (2.2389) ce_loss 2.4766 (2.2199) teacher_loss 2.4742 (2.2192) loss_zs_kd 0.1035 (0.0350) loss_oracle 0.0120 (0.0022) acc 34.3750 (29.7159) kd_loss 0.0238 (0.0042) lr 1.0000e-05 eta 0:37:29
epoch [1/50] batch [240/428] time 0.095 (0.105) data 0.000 (0.003) loss 2.2212 (2.2332) ce_loss 2.0918 (2.2063) teacher_loss 2.0933 (2.2054) loss_zs_kd 0.1581 (0.0448) loss_oracle 0.0488 (0.0054) acc 31.2500 (29.9349) kd_loss 0.1168 (0.0093) lr 1.0000e-05 eta 0:37:11
epoch [1/50] batch [260/428] time 0.121 (0.105) data 0.000 (0.003) loss 2.6540 (2.2268) ce_loss 2.5215 (2.1911) teacher_loss 2.5310 (2.1901) loss_zs_kd 0.1275 (0.0530) loss_oracle 0.0593 (0.0102) acc 34.3750 (30.2284) kd_loss 0.1398 (0.0210) lr 1.0000e-05 eta 0:37:09
epoch [1/50] batch [280/428] time 0.079 (0.104) data 0.000 (0.003) loss 1.8915 (2.2166) ce_loss 1.6846 (2.1706) teacher_loss 1.6585 (2.1691) loss_zs_kd 0.2246 (0.0638) loss_oracle 0.1207 (0.0155) acc 53.1250 (30.6473) kd_loss 0.2328 (0.0351) lr 1.0000e-05 eta 0:36:38
epoch [1/50] batch [300/428] time 0.080 (0.103) data 0.000 (0.003) loss 2.6285 (2.2120) ce_loss 2.2852 (2.1536) teacher_loss 2.2188 (2.1493) loss_zs_kd 0.3041 (0.0728) loss_oracle 0.2576 (0.0263) acc 25.0000 (31.1667) kd_loss 0.2953 (0.0513) lr 1.0000e-05 eta 0:36:18
epoch [1/50] batch [320/428] time 0.180 (0.103) data 0.000 (0.002) loss 2.1982 (2.2121) ce_loss 1.7949 (2.1368) teacher_loss 1.6602 (2.1279) loss_zs_kd 0.2718 (0.0837) loss_oracle 0.4020 (0.0424) acc 40.6250 (31.5625) kd_loss 0.5819 (0.0757) lr 1.0000e-05 eta 0:36:16
epoch [1/50] batch [340/428] time 0.081 (0.104) data 0.000 (0.002) loss 2.5028 (2.2172) ce_loss 2.0254 (2.1227) teacher_loss 1.7900 (2.1067) loss_zs_kd 0.2863 (0.0934) loss_oracle 0.5697 (0.0638) acc 34.3750 (31.8290) kd_loss 0.6962 (0.1050) lr 1.0000e-05 eta 0:36:24
epoch [1/50] batch [360/428] time 0.214 (0.104) data 0.000 (0.002) loss 2.2200 (2.2241) ce_loss 1.8154 (2.1107) teacher_loss 1.5775 (2.0851) loss_zs_kd 0.2994 (0.1032) loss_oracle 0.4929 (0.0874) acc 56.2500 (32.0139) kd_loss 0.7165 (0.1391) lr 1.0000e-05 eta 0:36:37
epoch [1/50] batch [380/428] time 0.182 (0.105) data 0.001 (0.002) loss 2.6287 (2.2325) ce_loss 2.2715 (2.1056) teacher_loss 1.9392 (2.0681) loss_zs_kd 0.3838 (0.1129) loss_oracle 0.4976 (0.1080) acc 25.0000 (32.0559) kd_loss 0.7462 (0.1695) lr 1.0000e-05 eta 0:36:37
epoch [1/50] batch [400/428] time 0.105 (0.104) data 0.000 (0.002) loss 2.2214 (2.2342) ce_loss 1.8486 (2.0977) teacher_loss 1.5084 (2.0486) loss_zs_kd 0.4043 (0.1222) loss_oracle 0.5109 (0.1244) acc 34.3750 (32.1641) kd_loss 0.8087 (0.1976) lr 1.0000e-05 eta 0:36:23
epoch [1/50] batch [420/428] time 0.098 (0.104) data 0.000 (0.002) loss 2.4360 (2.2305) ce_loss 2.1504 (2.0878) teacher_loss 1.8138 (2.0247) loss_zs_kd 0.4220 (0.1310) loss_oracle 0.4111 (0.1403) acc 31.2500 (32.3214) kd_loss 0.7154 (0.2247) lr 1.0000e-05 eta 0:36:17
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,122
* accuracy: 36.1%
* error: 63.9%
* macro_f1: 24.8%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,652
* accuracy: 55.9%
* error: 44.1%
* macro_f1: 26.3%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 1 best val acc:      36.1%, epoch: 1 *******
******* Domain 1 best val test acc: 55.9%, epoch: 1 *******
******* Domain 1 best test acc:     55.9%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/ana
epoch [2/50] batch [20/428] time 0.107 (0.134) data 0.000 (0.030) loss 1.9324 (2.0698) ce_loss 1.8779 (1.9254) teacher_loss 1.4376 (1.5670) loss_zs_kd 0.3723 (0.2825) loss_oracle 0.3087 (0.3616) acc 28.1250 (33.1250) kd_loss 0.8436 (0.8098) lr 2.0000e-03 eta 0:46:37
epoch [2/50] batch [40/428] time 0.105 (0.118) data 0.000 (0.015) loss 1.9128 (1.9877) ce_loss 1.7539 (1.8598) teacher_loss 1.4808 (1.4919) loss_zs_kd 0.3179 (0.3131) loss_oracle 0.2730 (0.3392) acc 43.7500 (34.7656) kd_loss 0.7533 (0.8184) lr 2.0000e-03 eta 0:41:19
epoch [2/50] batch [60/428] time 0.102 (0.113) data 0.000 (0.010) loss 1.9775 (1.9546) ce_loss 2.0156 (1.8338) teacher_loss 1.4093 (1.4568) loss_zs_kd 0.3628 (0.3225) loss_oracle 0.3868 (0.3365) acc 28.1250 (34.7917) kd_loss 0.8598 (0.8161) lr 2.0000e-03 eta 0:39:32
epoch [2/50] batch [80/428] time 0.104 (0.111) data 0.000 (0.008) loss 1.9369 (1.9212) ce_loss 1.7861 (1.7883) teacher_loss 1.4017 (1.4092) loss_zs_kd 0.3379 (0.3271) loss_oracle 0.3663 (0.3485) acc 25.0000 (36.3672) kd_loss 0.7890 (0.8206) lr 2.0000e-03 eta 0:38:40
epoch [2/50] batch [100/428] time 0.100 (0.110) data 0.000 (0.006) loss 1.7441 (1.9055) ce_loss 1.6914 (1.7648) teacher_loss 1.0844 (1.3746) loss_zs_kd 0.3995 (0.3333) loss_oracle 0.4600 (0.3642) acc 25.0000 (36.2812) kd_loss 0.9111 (0.8270) lr 2.0000e-03 eta 0:38:05
epoch [2/50] batch [120/428] time 0.100 (0.109) data 0.000 (0.005) loss 2.0785 (1.8955) ce_loss 1.8320 (1.7565) teacher_loss 1.5903 (1.3566) loss_zs_kd 0.4012 (0.3443) loss_oracle 0.2875 (0.3667) acc 37.5000 (36.3281) kd_loss 0.7174 (0.8275) lr 2.0000e-03 eta 0:37:45
epoch [2/50] batch [140/428] time 0.108 (0.108) data 0.000 (0.004) loss 1.6277 (1.8637) ce_loss 1.5166 (1.7394) teacher_loss 0.9159 (1.3253) loss_zs_kd 0.3912 (0.3465) loss_oracle 0.5162 (0.3651) acc 40.6250 (36.6741) kd_loss 0.8888 (0.8357) lr 2.0000e-03 eta 0:37:26
epoch [2/50] batch [160/428] time 0.101 (0.107) data 0.001 (0.004) loss 1.7427 (1.8509) ce_loss 1.6279 (1.7249) teacher_loss 1.0590 (1.2966) loss_zs_kd 0.4761 (0.3593) loss_oracle 0.4457 (0.3746) acc 40.6250 (37.1289) kd_loss 0.9747 (0.8429) lr 2.0000e-03 eta 0:37:13
epoch [2/50] batch [180/428] time 0.097 (0.106) data 0.000 (0.003) loss 1.7497 (1.8457) ce_loss 1.7529 (1.7240) teacher_loss 0.9389 (1.2775) loss_zs_kd 0.3920 (0.3672) loss_oracle 0.6148 (0.3847) acc 31.2500 (36.8750) kd_loss 0.9090 (0.8488) lr 2.0000e-03 eta 0:36:54
epoch [2/50] batch [200/428] time 0.076 (0.104) data 0.000 (0.003) loss 1.9249 (1.8475) ce_loss 1.9883 (1.7237) teacher_loss 1.1143 (1.2630) loss_zs_kd 0.3820 (0.3713) loss_oracle 0.6195 (0.3988) acc 37.5000 (36.8750) kd_loss 0.9695 (0.8536) lr 2.0000e-03 eta 0:35:50
epoch [2/50] batch [220/428] time 0.073 (0.104) data 0.000 (0.003) loss 1.8470 (1.8400) ce_loss 1.6465 (1.7079) teacher_loss 1.1542 (1.2405) loss_zs_kd 0.3103 (0.3740) loss_oracle 0.5376 (0.4125) acc 28.1250 (37.3580) kd_loss 0.9337 (0.8597) lr 2.0000e-03 eta 0:36:06
epoch [2/50] batch [240/428] time 0.096 (0.106) data 0.000 (0.003) loss 1.8448 (1.8353) ce_loss 1.6250 (1.7008) teacher_loss 1.1607 (1.2250) loss_zs_kd 0.4015 (0.3763) loss_oracle 0.4834 (0.4221) acc 34.3750 (37.4870) kd_loss 0.9342 (0.8654) lr 2.0000e-03 eta 0:36:28
epoch [2/50] batch [260/428] time 0.134 (0.106) data 0.000 (0.002) loss 1.5735 (1.8338) ce_loss 1.3604 (1.6950) teacher_loss 0.7884 (1.2095) loss_zs_kd 0.3636 (0.3812) loss_oracle 0.6033 (0.4336) acc 50.0000 (37.7163) kd_loss 1.0383 (0.8719) lr 2.0000e-03 eta 0:36:37
epoch [2/50] batch [280/428] time 0.080 (0.105) data 0.000 (0.002) loss 1.7653 (1.8420) ce_loss 1.4180 (1.6988) teacher_loss 1.0384 (1.2066) loss_zs_kd 0.4690 (0.3857) loss_oracle 0.4925 (0.4426) acc 53.1250 (37.5000) kd_loss 0.9207 (0.8770) lr 2.0000e-03 eta 0:36:13
epoch [2/50] batch [300/428] time 0.154 (0.105) data 0.000 (0.002) loss 1.9336 (1.8412) ce_loss 1.7334 (1.6971) teacher_loss 1.2462 (1.1985) loss_zs_kd 0.3783 (0.3870) loss_oracle 0.4983 (0.4491) acc 40.6250 (37.3958) kd_loss 0.9087 (0.8819) lr 2.0000e-03 eta 0:36:11
epoch [2/50] batch [320/428] time 0.075 (0.105) data 0.000 (0.002) loss 1.8880 (1.8359) ce_loss 1.7637 (1.6933) teacher_loss 1.0037 (1.1891) loss_zs_kd 0.4226 (0.3863) loss_oracle 0.6730 (0.4537) acc 40.6250 (37.6074) kd_loss 0.9797 (0.8864) lr 2.0000e-03 eta 0:36:16
epoch [2/50] batch [340/428] time 0.150 (0.106) data 0.000 (0.002) loss 1.7090 (1.8375) ce_loss 1.4053 (1.6887) teacher_loss 0.9282 (1.1780) loss_zs_kd 0.4303 (0.3913) loss_oracle 0.5656 (0.4638) acc 50.0000 (37.7022) kd_loss 0.9180 (0.8909) lr 2.0000e-03 eta 0:36:28
epoch [2/50] batch [360/428] time 0.078 (0.107) data 0.000 (0.002) loss 1.5734 (1.8374) ce_loss 1.2695 (1.6824) teacher_loss 0.8606 (1.1688) loss_zs_kd 0.3110 (0.3925) loss_oracle 0.5574 (0.4723) acc 46.8750 (37.8472) kd_loss 0.9885 (0.8940) lr 2.0000e-03 eta 0:36:36
epoch [2/50] batch [380/428] time 0.100 (0.106) data 0.000 (0.002) loss 1.8091 (1.8423) ce_loss 1.4268 (1.6801) teacher_loss 0.8611 (1.1662) loss_zs_kd 0.4373 (0.3925) loss_oracle 0.7293 (0.4799) acc 50.0000 (37.7714) kd_loss 0.9977 (0.8970) lr 2.0000e-03 eta 0:36:23
epoch [2/50] batch [400/428] time 0.107 (0.106) data 0.000 (0.002) loss 1.9881 (1.8474) ce_loss 1.6035 (1.6802) teacher_loss 1.1745 (1.1641) loss_zs_kd 0.4125 (0.3921) loss_oracle 0.6073 (0.4872) acc 34.3750 (37.6953) kd_loss 0.9418 (0.9000) lr 2.0000e-03 eta 0:36:19
epoch [2/50] batch [420/428] time 0.096 (0.106) data 0.000 (0.002) loss 1.8485 (1.8503) ce_loss 1.5205 (1.6767) teacher_loss 1.0142 (1.1585) loss_zs_kd 0.3625 (0.3932) loss_oracle 0.6530 (0.4952) acc 43.7500 (37.8720) kd_loss 0.9212 (0.9026) lr 2.0000e-03 eta 0:36:11
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,569
* accuracy: 43.7%
* error: 56.3%
* macro_f1: 31.2%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,692
* accuracy: 56.8%
* error: 43.2%
* macro_f1: 27.9%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 1 best val acc:      43.7%, epoch: 2 *******
******* Domain 1 best val test acc: 56.8%, epoch: 2 *******
******* Domain 1 best test acc:     56.8%, epoch: 2 *******
epoch [3/50] batch [20/428] time 0.089 (0.118) data 0.000 (0.027) loss 1.9107 (1.9149) ce_loss 1.7754 (1.5867) teacher_loss 1.1350 (1.0872) loss_zs_kd 0.3429 (0.4057) loss_oracle 0.6042 (0.6249) acc 21.8750 (41.5625) kd_loss 0.9163 (0.9448) lr 1.9980e-03 eta 0:40:21
epoch [3/50] batch [40/428] time 0.093 (0.101) data 0.000 (0.014) loss 1.7630 (1.9127) ce_loss 1.6758 (1.6136) teacher_loss 1.0458 (1.0904) loss_zs_kd 0.3928 (0.3980) loss_oracle 0.5208 (0.6233) acc 43.7500 (41.0938) kd_loss 0.8424 (0.9365) lr 1.9980e-03 eta 0:34:40
epoch [3/50] batch [60/428] time 0.112 (0.099) data 0.001 (0.009) loss 2.0374 (1.9118) ce_loss 1.8008 (1.6275) teacher_loss 1.2125 (1.1082) loss_zs_kd 0.3455 (0.3960) loss_oracle 0.6521 (0.6056) acc 37.5000 (40.2604) kd_loss 0.9090 (0.9292) lr 1.9980e-03 eta 0:33:52
epoch [3/50] batch [80/428] time 0.105 (0.101) data 0.000 (0.007) loss 1.8118 (1.9062) ce_loss 1.7686 (1.6355) teacher_loss 1.0661 (1.1076) loss_zs_kd 0.4046 (0.3949) loss_oracle 0.5434 (0.6011) acc 31.2500 (39.9219) kd_loss 0.8730 (0.9212) lr 1.9980e-03 eta 0:34:18
epoch [3/50] batch [100/428] time 0.102 (0.101) data 0.000 (0.006) loss 2.2820 (1.9016) ce_loss 1.9834 (1.6343) teacher_loss 1.5102 (1.1135) loss_zs_kd 0.3930 (0.3878) loss_oracle 0.5753 (0.5942) acc 31.2500 (39.6250) kd_loss 0.8645 (0.9115) lr 1.9980e-03 eta 0:34:29
epoch [3/50] batch [120/428] time 0.096 (0.102) data 0.000 (0.005) loss 1.9682 (1.8838) ce_loss 1.8984 (1.6283) teacher_loss 1.1944 (1.0979) loss_zs_kd 0.4047 (0.3925) loss_oracle 0.5715 (0.5896) acc 25.0000 (39.3229) kd_loss 0.8956 (0.9070) lr 1.9980e-03 eta 0:34:35
epoch [3/50] batch [140/428] time 0.096 (0.102) data 0.000 (0.004) loss 1.7912 (1.8633) ce_loss 1.5166 (1.6251) teacher_loss 0.8975 (1.0840) loss_zs_kd 0.5149 (0.3976) loss_oracle 0.6363 (0.5805) acc 40.6250 (39.0848) kd_loss 0.8382 (0.9023) lr 1.9980e-03 eta 0:34:34
epoch [3/50] batch [160/428] time 0.090 (0.100) data 0.000 (0.004) loss 1.8423 (1.8577) ce_loss 1.4863 (1.6230) teacher_loss 1.0389 (1.0785) loss_zs_kd 0.5071 (0.4033) loss_oracle 0.5498 (0.5776) acc 46.8750 (38.8281) kd_loss 0.8730 (0.8978) lr 1.9980e-03 eta 0:33:48
epoch [3/50] batch [180/428] time 0.077 (0.101) data 0.000 (0.003) loss 1.7841 (1.8491) ce_loss 1.4229 (1.6192) teacher_loss 0.9090 (1.0666) loss_zs_kd 0.4639 (0.4108) loss_oracle 0.6432 (0.5771) acc 46.8750 (38.5764) kd_loss 0.9511 (0.8970) lr 1.9980e-03 eta 0:34:12
epoch [3/50] batch [200/428] time 0.090 (0.101) data 0.000 (0.003) loss 1.9181 (1.8557) ce_loss 1.6904 (1.6234) teacher_loss 1.0476 (1.0673) loss_zs_kd 0.3968 (0.4171) loss_oracle 0.6722 (0.5798) acc 40.6250 (38.6094) kd_loss 0.9139 (0.8948) lr 1.9980e-03 eta 0:34:18
epoch [3/50] batch [220/428] time 0.082 (0.102) data 0.000 (0.003) loss 1.8765 (1.8550) ce_loss 1.8633 (1.6240) teacher_loss 0.9749 (1.0613) loss_zs_kd 0.4986 (0.4212) loss_oracle 0.6522 (0.5830) acc 37.5000 (38.6364) kd_loss 0.9228 (0.8928) lr 1.9980e-03 eta 0:34:41
epoch [3/50] batch [240/428] time 0.074 (0.103) data 0.000 (0.003) loss 1.6499 (1.8509) ce_loss 1.5264 (1.6198) teacher_loss 0.6814 (1.0517) loss_zs_kd 0.5437 (0.4250) loss_oracle 0.6966 (0.5867) acc 40.6250 (38.8151) kd_loss 0.8939 (0.8929) lr 1.9980e-03 eta 0:34:43
epoch [3/50] batch [260/428] time 0.074 (0.102) data 0.000 (0.002) loss 1.9955 (1.8473) ce_loss 1.8877 (1.6154) teacher_loss 1.1970 (1.0436) loss_zs_kd 0.4633 (0.4284) loss_oracle 0.5669 (0.5895) acc 34.3750 (39.1226) kd_loss 0.8826 (0.8918) lr 1.9980e-03 eta 0:34:32
epoch [3/50] batch [280/428] time 0.083 (0.103) data 0.000 (0.002) loss 1.7523 (1.8504) ce_loss 1.5684 (1.6153) teacher_loss 0.8889 (1.0422) loss_zs_kd 0.5371 (0.4293) loss_oracle 0.5949 (0.5935) acc 40.6250 (39.1964) kd_loss 0.8555 (0.8908) lr 1.9980e-03 eta 0:34:41
epoch [3/50] batch [300/428] time 0.167 (0.104) data 0.000 (0.002) loss 1.7688 (1.8459) ce_loss 1.4346 (1.6121) teacher_loss 0.8741 (1.0347) loss_zs_kd 0.5291 (0.4315) loss_oracle 0.6301 (0.5955) acc 56.2500 (39.3958) kd_loss 0.8757 (0.8898) lr 1.9980e-03 eta 0:34:59
epoch [3/50] batch [320/428] time 0.187 (0.105) data 0.000 (0.002) loss 1.4019 (1.8416) ce_loss 1.2295 (1.6092) teacher_loss 0.6664 (1.0283) loss_zs_kd 0.4437 (0.4328) loss_oracle 0.5137 (0.5969) acc 50.0000 (39.3945) kd_loss 0.9295 (0.8892) lr 1.9980e-03 eta 0:35:15
epoch [3/50] batch [340/428] time 0.105 (0.104) data 0.000 (0.002) loss 1.8324 (1.8376) ce_loss 1.6260 (1.6088) teacher_loss 1.0718 (1.0262) loss_zs_kd 0.4417 (0.4328) loss_oracle 0.5397 (0.5950) acc 43.7500 (39.4210) kd_loss 0.8268 (0.8880) lr 1.9980e-03 eta 0:35:03
epoch [3/50] batch [360/428] time 0.105 (0.104) data 0.000 (0.002) loss 1.8688 (1.8355) ce_loss 1.6855 (1.6081) teacher_loss 1.1492 (1.0239) loss_zs_kd 0.3742 (0.4324) loss_oracle 0.5326 (0.5954) acc 34.3750 (39.5486) kd_loss 0.8041 (0.8870) lr 1.9980e-03 eta 0:35:01
epoch [3/50] batch [380/428] time 0.092 (0.104) data 0.000 (0.002) loss 2.0333 (1.8340) ce_loss 1.8555 (1.6064) teacher_loss 1.2299 (1.0247) loss_zs_kd 0.4282 (0.4310) loss_oracle 0.5892 (0.5938) acc 40.6250 (39.6053) kd_loss 0.8240 (0.8846) lr 1.9980e-03 eta 0:35:02
epoch [3/50] batch [400/428] time 0.103 (0.104) data 0.000 (0.002) loss 1.7098 (1.8334) ce_loss 1.6094 (1.6073) teacher_loss 1.0741 (1.0269) loss_zs_kd 0.4552 (0.4312) loss_oracle 0.4081 (0.5909) acc 43.7500 (39.6484) kd_loss 0.7924 (0.8822) lr 1.9980e-03 eta 0:34:57
epoch [3/50] batch [420/428] time 0.095 (0.104) data 0.000 (0.002) loss 1.8688 (1.8282) ce_loss 1.6533 (1.6031) teacher_loss 1.0496 (1.0251) loss_zs_kd 0.5479 (0.4307) loss_oracle 0.5453 (0.5878) acc 37.5000 (39.7396) kd_loss 0.8967 (0.8801) lr 1.9980e-03 eta 0:34:53
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,714
* accuracy: 46.2%
* error: 53.8%
* macro_f1: 33.5%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,678
* accuracy: 56.5%
* error: 43.5%
* macro_f1: 28.6%
******* Domain 1 best val acc:      46.2%, epoch: 3 *******
******* Domain 1 best val test acc: 56.5%, epoch: 3 *******
******* Domain 1 best test acc:     56.8%, epoch: 2 *******
epoch [4/50] batch [20/428] time 0.107 (0.131) data 0.000 (0.025) loss 2.0076 (1.8001) ce_loss 1.8066 (1.5723) teacher_loss 1.3059 (1.0761) loss_zs_kd 0.3956 (0.3997) loss_oracle 0.5039 (0.5242) acc 43.7500 (39.8438) kd_loss 0.7399 (0.8105) lr 1.9921e-03 eta 0:43:53
epoch [4/50] batch [40/428] time 0.110 (0.117) data 0.000 (0.013) loss 2.0134 (1.8478) ce_loss 1.5664 (1.6127) teacher_loss 1.2889 (1.1290) loss_zs_kd 0.3871 (0.3859) loss_oracle 0.5309 (0.5259) acc 43.7500 (38.5156) kd_loss 0.8053 (0.8048) lr 1.9921e-03 eta 0:39:06
epoch [4/50] batch [60/428] time 0.110 (0.113) data 0.000 (0.009) loss 1.8876 (1.8339) ce_loss 1.6953 (1.5947) teacher_loss 1.2526 (1.1296) loss_zs_kd 0.3537 (0.3816) loss_oracle 0.4582 (0.5134) acc 37.5000 (40.2604) kd_loss 0.8404 (0.8032) lr 1.9921e-03 eta 0:37:39
epoch [4/50] batch [80/428] time 0.100 (0.111) data 0.000 (0.007) loss 1.8621 (1.8342) ce_loss 1.6641 (1.5979) teacher_loss 1.2225 (1.1422) loss_zs_kd 0.3416 (0.3735) loss_oracle 0.4689 (0.5053) acc 34.3750 (39.8828) kd_loss 0.8165 (0.8064) lr 1.9921e-03 eta 0:36:56
epoch [4/50] batch [100/428] time 0.105 (0.109) data 0.000 (0.005) loss 1.7391 (1.8361) ce_loss 1.5010 (1.5960) teacher_loss 1.0369 (1.1478) loss_zs_kd 0.3840 (0.3786) loss_oracle 0.5101 (0.4991) acc 46.8750 (40.3125) kd_loss 0.8261 (0.8081) lr 1.9921e-03 eta 0:36:29
epoch [4/50] batch [120/428] time 0.088 (0.108) data 0.000 (0.004) loss 1.8999 (1.8222) ce_loss 1.4873 (1.5781) teacher_loss 1.2342 (1.1297) loss_zs_kd 0.3870 (0.3799) loss_oracle 0.4721 (0.5025) acc 43.7500 (41.0677) kd_loss 0.7891 (0.8143) lr 1.9921e-03 eta 0:35:55
epoch [4/50] batch [140/428] time 0.150 (0.106) data 0.000 (0.004) loss 1.6462 (1.8137) ce_loss 1.4004 (1.5668) teacher_loss 1.0132 (1.1163) loss_zs_kd 0.3749 (0.3814) loss_oracle 0.4455 (0.5067) acc 56.2500 (41.4062) kd_loss 0.7940 (0.8176) lr 1.9921e-03 eta 0:35:15
epoch [4/50] batch [160/428] time 0.073 (0.106) data 0.000 (0.003) loss 1.8258 (1.8170) ce_loss 1.5977 (1.5721) teacher_loss 1.0488 (1.1117) loss_zs_kd 0.3165 (0.3861) loss_oracle 0.6188 (0.5123) acc 46.8750 (41.3672) kd_loss 0.8683 (0.8249) lr 1.9921e-03 eta 0:35:12
epoch [4/50] batch [180/428] time 0.085 (0.105) data 0.000 (0.003) loss 2.0233 (1.8169) ce_loss 1.6816 (1.5671) teacher_loss 1.2103 (1.1052) loss_zs_kd 0.4139 (0.3871) loss_oracle 0.6061 (0.5182) acc 37.5000 (41.6493) kd_loss 0.8882 (0.8317) lr 1.9921e-03 eta 0:34:45
epoch [4/50] batch [200/428] time 0.079 (0.105) data 0.000 (0.003) loss 1.7253 (1.8095) ce_loss 1.4473 (1.5627) teacher_loss 1.0532 (1.0941) loss_zs_kd 0.3913 (0.3882) loss_oracle 0.4765 (0.5213) acc 40.6250 (41.9531) kd_loss 0.7775 (0.8345) lr 1.9921e-03 eta 0:34:52
epoch [4/50] batch [220/428] time 0.088 (0.105) data 0.000 (0.003) loss 1.8666 (1.8120) ce_loss 1.5322 (1.5695) teacher_loss 1.2010 (1.0897) loss_zs_kd 0.4332 (0.3945) loss_oracle 0.4490 (0.5250) acc 46.8750 (41.4489) kd_loss 0.7614 (0.8377) lr 1.9921e-03 eta 0:34:46
epoch [4/50] batch [240/428] time 0.080 (0.104) data 0.000 (0.002) loss 1.8337 (1.8058) ce_loss 1.5078 (1.5632) teacher_loss 1.0285 (1.0750) loss_zs_kd 0.5214 (0.4006) loss_oracle 0.5445 (0.5305) acc 43.7500 (41.8099) kd_loss 0.8936 (0.8459) lr 1.9921e-03 eta 0:34:35
epoch [4/50] batch [260/428] time 0.175 (0.104) data 0.000 (0.002) loss 1.9231 (1.7958) ce_loss 1.7705 (1.5621) teacher_loss 1.1986 (1.0623) loss_zs_kd 0.4995 (0.4047) loss_oracle 0.4748 (0.5312) acc 37.5000 (41.8990) kd_loss 0.8589 (0.8524) lr 1.9921e-03 eta 0:34:34
epoch [4/50] batch [280/428] time 0.150 (0.106) data 0.000 (0.002) loss 1.7519 (1.7856) ce_loss 1.5713 (1.5567) teacher_loss 0.9196 (1.0504) loss_zs_kd 0.5320 (0.4076) loss_oracle 0.5663 (0.5314) acc 53.1250 (42.3438) kd_loss 0.8965 (0.8566) lr 1.9921e-03 eta 0:34:59
epoch [4/50] batch [300/428] time 0.072 (0.107) data 0.000 (0.002) loss 1.6774 (1.7845) ce_loss 1.5576 (1.5577) teacher_loss 0.7666 (1.0446) loss_zs_kd 0.4847 (0.4120) loss_oracle 0.6685 (0.5339) acc 46.8750 (42.4375) kd_loss 0.9083 (0.8585) lr 1.9921e-03 eta 0:35:11
epoch [4/50] batch [320/428] time 0.098 (0.105) data 0.000 (0.002) loss 1.7877 (1.7804) ce_loss 1.6621 (1.5548) teacher_loss 0.9835 (1.0372) loss_zs_kd 0.5215 (0.4158) loss_oracle 0.5435 (0.5353) acc 37.5000 (42.4609) kd_loss 0.8437 (0.8577) lr 1.9921e-03 eta 0:34:46
epoch [4/50] batch [340/428] time 0.105 (0.105) data 0.000 (0.002) loss 1.8960 (1.7787) ce_loss 1.7773 (1.5534) teacher_loss 0.9907 (1.0319) loss_zs_kd 0.5104 (0.4184) loss_oracle 0.6501 (0.5377) acc 40.6250 (42.5092) kd_loss 0.8351 (0.8568) lr 1.9921e-03 eta 0:34:43
epoch [4/50] batch [360/428] time 0.106 (0.105) data 0.000 (0.002) loss 1.8205 (1.7793) ce_loss 1.5107 (1.5504) teacher_loss 1.1088 (1.0336) loss_zs_kd 0.3901 (0.4189) loss_oracle 0.5165 (0.5363) acc 34.3750 (42.6302) kd_loss 0.8045 (0.8534) lr 1.9921e-03 eta 0:34:41
epoch [4/50] batch [380/428] time 0.101 (0.105) data 0.000 (0.002) loss 1.6198 (1.7775) ce_loss 1.4873 (1.5442) teacher_loss 0.9575 (1.0330) loss_zs_kd 0.4798 (0.4201) loss_oracle 0.4224 (0.5344) acc 46.8750 (42.8372) kd_loss 0.7895 (0.8505) lr 1.9921e-03 eta 0:34:37
epoch [4/50] batch [400/428] time 0.113 (0.105) data 0.000 (0.002) loss 1.9531 (1.7773) ce_loss 1.7617 (1.5416) teacher_loss 1.2798 (1.0349) loss_zs_kd 0.4064 (0.4205) loss_oracle 0.4701 (0.5322) acc 28.1250 (43.0547) kd_loss 0.8616 (0.8488) lr 1.9921e-03 eta 0:34:29
epoch [4/50] batch [420/428] time 0.096 (0.105) data 0.000 (0.002) loss 1.5199 (1.7756) ce_loss 1.2676 (1.5366) teacher_loss 0.8541 (1.0352) loss_zs_kd 0.4056 (0.4215) loss_oracle 0.4631 (0.5296) acc 56.2500 (43.3110) kd_loss 0.8589 (0.8482) lr 1.9921e-03 eta 0:34:24
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,920
* accuracy: 49.7%
* error: 50.3%
* macro_f1: 34.9%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,403
* accuracy: 50.7%
* error: 49.3%
* macro_f1: 31.2%
******* Domain 1 best val acc:      49.7%, epoch: 4 *******
******* Domain 1 best val test acc: 50.7%, epoch: 4 *******
******* Domain 1 best test acc:     56.8%, epoch: 2 *******
epoch [5/50] batch [20/428] time 0.107 (0.133) data 0.000 (0.026) loss 1.5457 (1.7420) ce_loss 1.3516 (1.4089) teacher_loss 0.8949 (1.0131) loss_zs_kd 0.3536 (0.4511) loss_oracle 0.4739 (0.5033) acc 56.2500 (49.8438) kd_loss 0.8171 (0.8403) lr 1.9823e-03 eta 0:43:39
epoch [5/50] batch [40/428] time 0.103 (0.119) data 0.000 (0.013) loss 1.8408 (1.7281) ce_loss 1.6963 (1.4014) teacher_loss 1.2219 (1.0105) loss_zs_kd 0.4208 (0.4397) loss_oracle 0.4085 (0.4977) acc 40.6250 (48.9062) kd_loss 0.7582 (0.8372) lr 1.9823e-03 eta 0:38:58
epoch [5/50] batch [60/428] time 0.108 (0.115) data 0.000 (0.009) loss 1.6472 (1.7153) ce_loss 1.3975 (1.3983) teacher_loss 0.9729 (1.0023) loss_zs_kd 0.4152 (0.4395) loss_oracle 0.4667 (0.4932) acc 46.8750 (49.2708) kd_loss 0.8028 (0.8314) lr 1.9823e-03 eta 0:37:34
epoch [5/50] batch [80/428] time 0.116 (0.113) data 0.000 (0.007) loss 1.9126 (1.7379) ce_loss 1.7686 (1.4231) teacher_loss 1.2225 (1.0305) loss_zs_kd 0.4165 (0.4293) loss_oracle 0.4819 (0.4928) acc 34.3750 (48.1641) kd_loss 0.7768 (0.8275) lr 1.9823e-03 eta 0:36:46
epoch [5/50] batch [100/428] time 0.084 (0.110) data 0.000 (0.005) loss 1.6552 (1.7491) ce_loss 1.3906 (1.4416) teacher_loss 0.9766 (1.0508) loss_zs_kd 0.3756 (0.4196) loss_oracle 0.4908 (0.4885) acc 56.2500 (47.1250) kd_loss 0.8248 (0.8211) lr 1.9823e-03 eta 0:35:50
epoch [5/50] batch [120/428] time 0.082 (0.106) data 0.000 (0.005) loss 1.9816 (1.7477) ce_loss 1.7383 (1.4452) teacher_loss 1.2795 (1.0491) loss_zs_kd 0.4473 (0.4142) loss_oracle 0.4784 (0.4915) acc 31.2500 (47.0833) kd_loss 0.8096 (0.8142) lr 1.9823e-03 eta 0:34:33
epoch [5/50] batch [140/428] time 0.102 (0.107) data 0.000 (0.004) loss 1.6219 (1.7422) ce_loss 1.3105 (1.4377) teacher_loss 1.0199 (1.0504) loss_zs_kd 0.3160 (0.4072) loss_oracle 0.4440 (0.4882) acc 53.1250 (47.1875) kd_loss 0.7160 (0.8090) lr 1.9823e-03 eta 0:35:00
epoch [5/50] batch [160/428] time 0.158 (0.108) data 0.000 (0.004) loss 1.9015 (1.7598) ce_loss 1.7021 (1.4547) teacher_loss 1.2043 (1.0709) loss_zs_kd 0.3260 (0.4014) loss_oracle 0.5342 (0.4882) acc 37.5000 (46.5430) kd_loss 0.7781 (0.8006) lr 1.9823e-03 eta 0:35:18
epoch [5/50] batch [180/428] time 0.072 (0.109) data 0.000 (0.003) loss 1.5792 (1.7585) ce_loss 1.3154 (1.4554) teacher_loss 1.0093 (1.0776) loss_zs_kd 0.3468 (0.3964) loss_oracle 0.3965 (0.4827) acc 50.0000 (46.8229) kd_loss 0.7190 (0.7922) lr 1.9823e-03 eta 0:35:23
epoch [5/50] batch [200/428] time 0.083 (0.107) data 0.000 (0.003) loss 1.6439 (1.7562) ce_loss 1.2900 (1.4570) teacher_loss 1.0780 (1.0856) loss_zs_kd 0.2839 (0.3899) loss_oracle 0.4240 (0.4756) acc 65.6250 (46.8281) kd_loss 0.6930 (0.7851) lr 1.9823e-03 eta 0:34:50
epoch [5/50] batch [220/428] time 0.187 (0.107) data 0.000 (0.003) loss 1.6557 (1.7566) ce_loss 1.4170 (1.4594) teacher_loss 1.0449 (1.0936) loss_zs_kd 0.4082 (0.3843) loss_oracle 0.4067 (0.4709) acc 46.8750 (46.6193) kd_loss 0.7097 (0.7798) lr 1.9823e-03 eta 0:34:46
epoch [5/50] batch [240/428] time 0.175 (0.108) data 0.000 (0.002) loss 1.9116 (1.7556) ce_loss 1.7949 (1.4635) teacher_loss 1.2700 (1.0969) loss_zs_kd 0.3886 (0.3832) loss_oracle 0.4472 (0.4672) acc 31.2500 (46.7318) kd_loss 0.7149 (0.7749) lr 1.9823e-03 eta 0:34:53
epoch [5/50] batch [260/428] time 0.173 (0.108) data 0.000 (0.002) loss 1.6950 (1.7526) ce_loss 1.3545 (1.4628) teacher_loss 1.0922 (1.0989) loss_zs_kd 0.3737 (0.3805) loss_oracle 0.4159 (0.4634) acc 53.1250 (46.6707) kd_loss 0.6647 (0.7708) lr 1.9823e-03 eta 0:35:07
epoch [5/50] batch [280/428] time 0.067 (0.108) data 0.000 (0.002) loss 1.4200 (1.7460) ce_loss 1.1201 (1.4618) teacher_loss 0.8794 (1.0986) loss_zs_kd 0.2756 (0.3776) loss_oracle 0.4028 (0.4586) acc 71.8750 (46.9085) kd_loss 0.7530 (0.7679) lr 1.9823e-03 eta 0:34:57
epoch [5/50] batch [300/428] time 0.105 (0.107) data 0.000 (0.002) loss 1.8090 (1.7421) ce_loss 1.4766 (1.4614) teacher_loss 1.2438 (1.0983) loss_zs_kd 0.3958 (0.3753) loss_oracle 0.3674 (0.4561) acc 59.3750 (46.8333) kd_loss 0.6665 (0.7654) lr 1.9823e-03 eta 0:34:41
epoch [5/50] batch [320/428] time 0.092 (0.107) data 0.000 (0.002) loss 1.8704 (1.7412) ce_loss 1.7383 (1.4631) teacher_loss 1.2125 (1.1011) loss_zs_kd 0.3505 (0.3739) loss_oracle 0.4826 (0.4532) acc 25.0000 (46.6602) kd_loss 0.6970 (0.7614) lr 1.9823e-03 eta 0:34:31
epoch [5/50] batch [340/428] time 0.101 (0.107) data 0.000 (0.002) loss 1.6055 (1.7409) ce_loss 1.3516 (1.4633) teacher_loss 1.0821 (1.1037) loss_zs_kd 0.2871 (0.3726) loss_oracle 0.3799 (0.4509) acc 53.1250 (46.7739) kd_loss 0.7625 (0.7587) lr 1.9823e-03 eta 0:34:22
epoch [5/50] batch [360/428] time 0.099 (0.106) data 0.000 (0.002) loss 1.2022 (1.7352) ce_loss 1.0596 (1.4614) teacher_loss 0.7808 (1.1035) loss_zs_kd 0.2854 (0.3721) loss_oracle 0.2787 (0.4457) acc 65.6250 (46.9097) kd_loss 0.6625 (0.7551) lr 1.9823e-03 eta 0:34:11
epoch [5/50] batch [380/428] time 0.105 (0.106) data 0.000 (0.002) loss 1.8906 (1.7284) ce_loss 1.6182 (1.4600) teacher_loss 1.3199 (1.1015) loss_zs_kd 0.4202 (0.3722) loss_oracle 0.3607 (0.4407) acc 40.6250 (46.8092) kd_loss 0.6490 (0.7518) lr 1.9823e-03 eta 0:34:07
epoch [5/50] batch [400/428] time 0.097 (0.106) data 0.000 (0.002) loss 1.5617 (1.7255) ce_loss 1.3633 (1.4608) teacher_loss 1.0145 (1.1031) loss_zs_kd 0.2869 (0.3710) loss_oracle 0.4037 (0.4369) acc 40.6250 (46.8047) kd_loss 0.7334 (0.7500) lr 1.9823e-03 eta 0:34:02
epoch [5/50] batch [420/428] time 0.095 (0.106) data 0.000 (0.001) loss 1.5036 (1.7201) ce_loss 1.3447 (1.4601) teacher_loss 1.0391 (1.1032) loss_zs_kd 0.3164 (0.3690) loss_oracle 0.3062 (0.4324) acc 46.8750 (46.8452) kd_loss 0.6877 (0.7478) lr 1.9823e-03 eta 0:33:56
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,917
* accuracy: 49.6%
* error: 50.4%
* macro_f1: 35.2%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,451
* accuracy: 51.7%
* error: 48.3%
* macro_f1: 30.2%
******* Domain 1 best val acc:      49.7%, epoch: 4 *******
******* Domain 1 best val test acc: 50.7%, epoch: 4 *******
******* Domain 1 best test acc:     56.8%, epoch: 2 *******
epoch [6/50] batch [20/428] time 0.102 (0.135) data 0.000 (0.031) loss 1.8789 (1.6473) ce_loss 1.6855 (1.3976) teacher_loss 1.1939 (1.0549) loss_zs_kd 0.4121 (0.3943) loss_oracle 0.4790 (0.3953) acc 50.0000 (48.1250) kd_loss 0.7054 (0.7207) lr 1.9686e-03 eta 0:43:16
epoch [6/50] batch [40/428] time 0.106 (0.119) data 0.000 (0.015) loss 1.5331 (1.6505) ce_loss 1.4404 (1.3996) teacher_loss 0.8733 (1.0603) loss_zs_kd 0.4555 (0.3951) loss_oracle 0.4321 (0.3926) acc 37.5000 (48.3594) kd_loss 0.7170 (0.7141) lr 1.9686e-03 eta 0:38:01
epoch [6/50] batch [60/428] time 0.102 (0.114) data 0.000 (0.010) loss 1.8330 (1.6700) ce_loss 1.5879 (1.4189) teacher_loss 1.1037 (1.0726) loss_zs_kd 0.3940 (0.3999) loss_oracle 0.5324 (0.3974) acc 46.8750 (47.6562) kd_loss 0.8608 (0.7278) lr 1.9686e-03 eta 0:36:27
epoch [6/50] batch [80/428] time 0.099 (0.111) data 0.000 (0.008) loss 1.6442 (1.6822) ce_loss 1.4375 (1.4313) teacher_loss 1.0277 (1.0823) loss_zs_kd 0.4769 (0.4044) loss_oracle 0.3781 (0.3977) acc 37.5000 (46.9922) kd_loss 0.7365 (0.7318) lr 1.9686e-03 eta 0:35:34
epoch [6/50] batch [100/428] time 0.084 (0.107) data 0.000 (0.006) loss 1.5647 (1.6753) ce_loss 1.2305 (1.4292) teacher_loss 0.9398 (1.0711) loss_zs_kd 0.4900 (0.4082) loss_oracle 0.3799 (0.4001) acc 50.0000 (47.1875) kd_loss 0.6912 (0.7384) lr 1.9686e-03 eta 0:34:05
epoch [6/50] batch [120/428] time 0.079 (0.106) data 0.000 (0.005) loss 1.6995 (1.6654) ce_loss 1.4766 (1.4152) teacher_loss 1.0696 (1.0572) loss_zs_kd 0.4671 (0.4144) loss_oracle 0.3964 (0.4010) acc 53.1250 (48.2292) kd_loss 0.7549 (0.7388) lr 1.9686e-03 eta 0:33:40
epoch [6/50] batch [140/428] time 0.083 (0.107) data 0.000 (0.005) loss 1.7284 (1.6680) ce_loss 1.3691 (1.4139) teacher_loss 0.9878 (1.0515) loss_zs_kd 0.4594 (0.4202) loss_oracle 0.5109 (0.4064) acc 37.5000 (48.3259) kd_loss 0.7929 (0.7402) lr 1.9686e-03 eta 0:33:59
epoch [6/50] batch [160/428] time 0.089 (0.106) data 0.000 (0.004) loss 2.0063 (1.6746) ce_loss 1.9307 (1.4230) teacher_loss 1.2922 (1.0491) loss_zs_kd 0.4794 (0.4247) loss_oracle 0.4744 (0.4131) acc 18.7500 (48.0078) kd_loss 0.7311 (0.7441) lr 1.9686e-03 eta 0:33:39
epoch [6/50] batch [180/428] time 0.187 (0.106) data 0.000 (0.004) loss 1.5387 (1.6790) ce_loss 1.2129 (1.4262) teacher_loss 0.8663 (1.0411) loss_zs_kd 0.4500 (0.4330) loss_oracle 0.4474 (0.4214) acc 65.6250 (47.9688) kd_loss 0.7384 (0.7480) lr 1.9686e-03 eta 0:33:45
epoch [6/50] batch [200/428] time 0.081 (0.105) data 0.000 (0.003) loss 1.4961 (1.6767) ce_loss 1.1367 (1.4229) teacher_loss 0.8101 (1.0377) loss_zs_kd 0.4536 (0.4334) loss_oracle 0.4592 (0.4223) acc 59.3750 (48.1719) kd_loss 0.7128 (0.7467) lr 1.9686e-03 eta 0:33:29
epoch [6/50] batch [220/428] time 0.080 (0.105) data 0.000 (0.003) loss 1.9044 (1.6815) ce_loss 1.7129 (1.4211) teacher_loss 1.1846 (1.0369) loss_zs_kd 0.3979 (0.4324) loss_oracle 0.5209 (0.4284) acc 50.0000 (48.4091) kd_loss 0.7321 (0.7472) lr 1.9686e-03 eta 0:33:16
epoch [6/50] batch [240/428] time 0.079 (0.104) data 0.000 (0.003) loss 1.7498 (1.6872) ce_loss 1.3125 (1.4183) teacher_loss 0.9594 (1.0335) loss_zs_kd 0.4747 (0.4331) loss_oracle 0.5530 (0.4372) acc 62.5000 (48.6979) kd_loss 0.7658 (0.7515) lr 1.9686e-03 eta 0:32:57
epoch [6/50] batch [260/428] time 0.072 (0.105) data 0.000 (0.003) loss 1.8609 (1.6938) ce_loss 1.5645 (1.4193) teacher_loss 1.0677 (1.0315) loss_zs_kd 0.4137 (0.4329) loss_oracle 0.5864 (0.4459) acc 50.0000 (48.6058) kd_loss 0.8657 (0.7570) lr 1.9686e-03 eta 0:33:07
epoch [6/50] batch [280/428] time 0.072 (0.105) data 0.000 (0.002) loss 1.5717 (1.6999) ce_loss 1.3223 (1.4233) teacher_loss 0.8261 (1.0277) loss_zs_kd 0.4255 (0.4365) loss_oracle 0.5328 (0.4540) acc 56.2500 (48.5714) kd_loss 0.8580 (0.7620) lr 1.9686e-03 eta 0:33:13
epoch [6/50] batch [300/428] time 0.084 (0.105) data 0.000 (0.002) loss 1.8202 (1.7030) ce_loss 1.6016 (1.4249) teacher_loss 1.0014 (1.0215) loss_zs_kd 0.4846 (0.4384) loss_oracle 0.5765 (0.4623) acc 46.8750 (48.5312) kd_loss 0.8372 (0.7678) lr 1.9686e-03 eta 0:33:05
epoch [6/50] batch [320/428] time 0.116 (0.105) data 0.000 (0.002) loss 2.3506 (1.7104) ce_loss 1.9072 (1.4280) teacher_loss 1.5338 (1.0195) loss_zs_kd 0.4407 (0.4404) loss_oracle 0.5965 (0.4708) acc 37.5000 (48.4668) kd_loss 0.8437 (0.7742) lr 1.9686e-03 eta 0:33:03
epoch [6/50] batch [340/428] time 0.101 (0.105) data 0.000 (0.002) loss 1.6497 (1.7095) ce_loss 1.2676 (1.4277) teacher_loss 0.8480 (1.0130) loss_zs_kd 0.4019 (0.4402) loss_oracle 0.6007 (0.4764) acc 56.2500 (48.5110) kd_loss 0.8949 (0.7789) lr 1.9686e-03 eta 0:33:00
epoch [6/50] batch [360/428] time 0.106 (0.105) data 0.000 (0.002) loss 1.5944 (1.7135) ce_loss 1.2422 (1.4312) teacher_loss 0.7889 (1.0094) loss_zs_kd 0.4409 (0.4416) loss_oracle 0.5851 (0.4833) acc 59.3750 (48.3854) kd_loss 0.8624 (0.7841) lr 1.9686e-03 eta 0:32:59
epoch [6/50] batch [380/428] time 0.099 (0.105) data 0.000 (0.002) loss 1.8245 (1.7151) ce_loss 1.6318 (1.4335) teacher_loss 1.1523 (1.0070) loss_zs_kd 0.4494 (0.4426) loss_oracle 0.4475 (0.4868) acc 37.5000 (48.4128) kd_loss 0.8435 (0.7877) lr 1.9686e-03 eta 0:32:55
epoch [6/50] batch [400/428] time 0.114 (0.105) data 0.000 (0.002) loss 1.6496 (1.7127) ce_loss 1.3467 (1.4292) teacher_loss 0.8133 (0.9993) loss_zs_kd 0.3971 (0.4439) loss_oracle 0.6378 (0.4915) acc 56.2500 (48.4766) kd_loss 0.8850 (0.7917) lr 1.9686e-03 eta 0:32:53
epoch [6/50] batch [420/428] time 0.098 (0.105) data 0.000 (0.002) loss 1.4648 (1.7157) ce_loss 1.3467 (1.4333) teacher_loss 0.7709 (0.9980) loss_zs_kd 0.4735 (0.4445) loss_oracle 0.4572 (0.4955) acc 43.7500 (48.3036) kd_loss 0.7763 (0.7947) lr 1.9686e-03 eta 0:32:50
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,905
* accuracy: 49.4%
* error: 50.6%
* macro_f1: 34.8%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,582
* accuracy: 54.5%
* error: 45.5%
* macro_f1: 31.9%
******* Domain 1 best val acc:      49.7%, epoch: 4 *******
******* Domain 1 best val test acc: 50.7%, epoch: 4 *******
******* Domain 1 best test acc:     56.8%, epoch: 2 *******
epoch [7/50] batch [20/428] time 0.109 (0.138) data 0.000 (0.029) loss 1.8579 (1.7376) ce_loss 1.4756 (1.3589) teacher_loss 1.0280 (0.9241) loss_zs_kd 0.5196 (0.4642) loss_oracle 0.5701 (0.5814) acc 50.0000 (49.8438) kd_loss 0.9034 (0.8579) lr 1.9511e-03 eta 0:43:13
epoch [7/50] batch [40/428] time 0.109 (0.122) data 0.001 (0.014) loss 1.6340 (1.7696) ce_loss 1.2891 (1.3877) teacher_loss 0.7901 (0.9491) loss_zs_kd 0.4522 (0.4547) loss_oracle 0.6178 (0.5932) acc 59.3750 (50.0000) kd_loss 0.8265 (0.8517) lr 1.9511e-03 eta 0:38:07
epoch [7/50] batch [60/428] time 0.103 (0.116) data 0.000 (0.010) loss 1.7976 (1.7607) ce_loss 1.4561 (1.3878) teacher_loss 1.0364 (0.9473) loss_zs_kd 0.4668 (0.4522) loss_oracle 0.5278 (0.5872) acc 46.8750 (50.1562) kd_loss 0.8180 (0.8489) lr 1.9511e-03 eta 0:36:14
epoch [7/50] batch [80/428] time 0.103 (0.113) data 0.000 (0.007) loss 1.7423 (1.7635) ce_loss 1.4121 (1.3847) teacher_loss 1.0152 (0.9517) loss_zs_kd 0.4568 (0.4532) loss_oracle 0.4987 (0.5852) acc 56.2500 (50.7422) kd_loss 0.7965 (0.8456) lr 1.9511e-03 eta 0:35:24
epoch [7/50] batch [100/428] time 0.096 (0.111) data 0.000 (0.006) loss 1.3837 (1.7546) ce_loss 1.0762 (1.3817) teacher_loss 0.7402 (0.9597) loss_zs_kd 0.4302 (0.4516) loss_oracle 0.4283 (0.5691) acc 62.5000 (50.9375) kd_loss 0.8091 (0.8356) lr 1.9511e-03 eta 0:34:39
epoch [7/50] batch [120/428] time 0.139 (0.107) data 0.000 (0.005) loss 1.7712 (1.7530) ce_loss 1.4863 (1.3745) teacher_loss 1.1222 (0.9680) loss_zs_kd 0.4420 (0.4440) loss_oracle 0.4280 (0.5630) acc 37.5000 (50.6510) kd_loss 0.7162 (0.8299) lr 1.9511e-03 eta 0:33:18
epoch [7/50] batch [140/428] time 0.187 (0.109) data 0.000 (0.004) loss 2.4794 (1.7717) ce_loss 1.9717 (1.3899) teacher_loss 1.6258 (0.9880) loss_zs_kd 0.4682 (0.4432) loss_oracle 0.6195 (0.5621) acc 25.0000 (50.0223) kd_loss 0.8227 (0.8274) lr 1.9511e-03 eta 0:33:53
epoch [7/50] batch [160/428] time 0.148 (0.109) data 0.000 (0.004) loss 1.7774 (1.7730) ce_loss 1.3828 (1.3838) teacher_loss 0.9847 (0.9868) loss_zs_kd 0.4473 (0.4461) loss_oracle 0.5691 (0.5632) acc 40.6250 (50.2734) kd_loss 0.7694 (0.8277) lr 1.9511e-03 eta 0:34:02
epoch [7/50] batch [180/428] time 0.148 (0.109) data 0.001 (0.003) loss 2.0094 (1.7807) ce_loss 1.3018 (1.3836) teacher_loss 1.1292 (0.9918) loss_zs_kd 0.4309 (0.4457) loss_oracle 0.6648 (0.5661) acc 62.5000 (50.0000) kd_loss 0.8552 (0.8272) lr 1.9511e-03 eta 0:33:59
epoch [7/50] batch [200/428] time 0.134 (0.108) data 0.000 (0.003) loss 1.6943 (1.7883) ce_loss 1.1074 (1.3853) teacher_loss 0.8833 (0.9983) loss_zs_kd 0.4464 (0.4434) loss_oracle 0.5878 (0.5683) acc 68.7500 (50.2500) kd_loss 0.7840 (0.8263) lr 1.9511e-03 eta 0:33:28
epoch [7/50] batch [220/428] time 0.074 (0.108) data 0.001 (0.003) loss 1.9050 (1.7924) ce_loss 1.6162 (1.3869) teacher_loss 1.0288 (1.0001) loss_zs_kd 0.4984 (0.4440) loss_oracle 0.6271 (0.5703) acc 40.6250 (50.1278) kd_loss 0.7994 (0.8265) lr 1.9511e-03 eta 0:33:39
epoch [7/50] batch [240/428] time 0.077 (0.109) data 0.000 (0.003) loss 2.3294 (1.8027) ce_loss 1.6543 (1.3912) teacher_loss 1.3163 (1.0029) loss_zs_kd 0.5706 (0.4478) loss_oracle 0.7278 (0.5759) acc 46.8750 (49.8438) kd_loss 0.8671 (0.8297) lr 1.9511e-03 eta 0:33:48
epoch [7/50] batch [260/428] time 0.161 (0.109) data 0.000 (0.002) loss 1.7468 (1.8127) ce_loss 1.3379 (1.3977) teacher_loss 0.8584 (1.0088) loss_zs_kd 0.5078 (0.4463) loss_oracle 0.6346 (0.5807) acc 46.8750 (49.5192) kd_loss 0.8788 (0.8305) lr 1.9511e-03 eta 0:33:43
epoch [7/50] batch [280/428] time 0.081 (0.109) data 0.000 (0.002) loss 2.1236 (1.8192) ce_loss 1.7744 (1.4031) teacher_loss 1.2266 (1.0090) loss_zs_kd 0.5129 (0.4488) loss_oracle 0.6406 (0.5857) acc 37.5000 (49.1741) kd_loss 0.9082 (0.8320) lr 1.9511e-03 eta 0:33:37
epoch [7/50] batch [300/428] time 0.096 (0.108) data 0.000 (0.002) loss 1.6248 (1.8241) ce_loss 1.1025 (1.4049) teacher_loss 0.8102 (1.0083) loss_zs_kd 0.3610 (0.4492) loss_oracle 0.6341 (0.5912) acc 62.5000 (49.0625) kd_loss 0.8841 (0.8337) lr 1.9511e-03 eta 0:33:20
epoch [7/50] batch [320/428] time 0.111 (0.108) data 0.000 (0.002) loss 1.9705 (1.8281) ce_loss 1.7031 (1.4114) teacher_loss 1.0833 (1.0077) loss_zs_kd 0.4096 (0.4486) loss_oracle 0.6824 (0.5961) acc 50.0000 (48.8867) kd_loss 0.8124 (0.8346) lr 1.9511e-03 eta 0:33:15
epoch [7/50] batch [340/428] time 0.111 (0.108) data 0.000 (0.002) loss 1.9039 (1.8325) ce_loss 1.5479 (1.4162) teacher_loss 1.0270 (1.0097) loss_zs_kd 0.4699 (0.4460) loss_oracle 0.6420 (0.5998) acc 46.8750 (48.6489) kd_loss 0.8437 (0.8352) lr 1.9511e-03 eta 0:33:10
epoch [7/50] batch [360/428] time 0.113 (0.107) data 0.000 (0.002) loss 1.8427 (1.8374) ce_loss 1.4941 (1.4203) teacher_loss 0.9618 (1.0107) loss_zs_kd 0.3848 (0.4442) loss_oracle 0.6885 (0.6046) acc 43.7500 (48.3507) kd_loss 0.8588 (0.8356) lr 1.9511e-03 eta 0:33:04
epoch [7/50] batch [380/428] time 0.103 (0.107) data 0.000 (0.002) loss 1.7131 (1.8396) ce_loss 1.4268 (1.4220) teacher_loss 0.8261 (1.0100) loss_zs_kd 0.3837 (0.4425) loss_oracle 0.6952 (0.6083) acc 50.0000 (48.1743) kd_loss 0.8786 (0.8360) lr 1.9511e-03 eta 0:33:00
epoch [7/50] batch [400/428] time 0.095 (0.107) data 0.000 (0.002) loss 2.2575 (1.8445) ce_loss 1.9375 (1.4260) teacher_loss 1.3750 (1.0122) loss_zs_kd 0.3858 (0.4410) loss_oracle 0.6897 (0.6118) acc 28.1250 (47.9766) kd_loss 0.8565 (0.8367) lr 1.9511e-03 eta 0:32:55
epoch [7/50] batch [420/428] time 0.097 (0.107) data 0.000 (0.002) loss 1.6162 (1.8457) ce_loss 1.1914 (1.4292) teacher_loss 0.7715 (1.0105) loss_zs_kd 0.4130 (0.4387) loss_oracle 0.6382 (0.6159) acc 56.2500 (47.7381) kd_loss 0.8374 (0.8373) lr 1.9511e-03 eta 0:32:49
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,439
* accuracy: 41.5%
* error: 58.5%
* macro_f1: 31.1%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,588
* accuracy: 54.6%
* error: 45.4%
* macro_f1: 28.2%
******* Domain 1 best val acc:      49.7%, epoch: 4 *******
******* Domain 1 best val test acc: 50.7%, epoch: 4 *******
******* Domain 1 best test acc:     56.8%, epoch: 2 *******
epoch [8/50] batch [20/428] time 0.070 (0.124) data 0.000 (0.031) loss 1.7046 (1.8910) ce_loss 1.2979 (1.5137) teacher_loss 0.8445 (1.0361) loss_zs_kd 0.3590 (0.3698) loss_oracle 0.6806 (0.6699) acc 43.7500 (41.4062) kd_loss 0.8398 (0.8332) lr 1.9298e-03 eta 0:37:56
epoch [8/50] batch [40/428] time 0.067 (0.104) data 0.000 (0.015) loss 1.9129 (1.9010) ce_loss 1.5127 (1.5063) teacher_loss 1.1421 (1.0590) loss_zs_kd 0.3597 (0.3635) loss_oracle 0.5909 (0.6602) acc 40.6250 (42.2656) kd_loss 0.8298 (0.8329) lr 1.9298e-03 eta 0:31:43
epoch [8/50] batch [60/428] time 0.085 (0.097) data 0.000 (0.010) loss 1.7239 (1.9020) ce_loss 1.3301 (1.5209) teacher_loss 0.8923 (1.0730) loss_zs_kd 0.3442 (0.3640) loss_oracle 0.6595 (0.6470) acc 50.0000 (42.5000) kd_loss 0.8297 (0.8308) lr 1.9298e-03 eta 0:29:33
epoch [8/50] batch [80/428] time 0.083 (0.094) data 0.000 (0.008) loss 2.2568 (1.9236) ce_loss 1.8564 (1.5347) teacher_loss 1.3780 (1.0847) loss_zs_kd 0.3657 (0.3683) loss_oracle 0.6959 (0.6547) acc 40.6250 (42.8125) kd_loss 0.8331 (0.8327) lr 1.9298e-03 eta 0:28:36
epoch [8/50] batch [100/428] time 0.100 (0.093) data 0.000 (0.006) loss 2.1294 (1.9298) ce_loss 1.8857 (1.5505) teacher_loss 1.1990 (1.0864) loss_zs_kd 0.4060 (0.3674) loss_oracle 0.7273 (0.6597) acc 31.2500 (42.0625) kd_loss 0.8043 (0.8324) lr 1.9298e-03 eta 0:28:15
epoch [8/50] batch [120/428] time 0.087 (0.091) data 0.000 (0.005) loss 1.6619 (1.9254) ce_loss 1.3525 (1.5379) teacher_loss 0.8226 (1.0789) loss_zs_kd 0.3294 (0.3655) loss_oracle 0.6746 (0.6638) acc 50.0000 (42.4479) kd_loss 0.8367 (0.8306) lr 1.9298e-03 eta 0:27:44
epoch [8/50] batch [140/428] time 0.189 (0.093) data 0.000 (0.005) loss 2.2293 (1.9275) ce_loss 1.7617 (1.5446) teacher_loss 1.3580 (1.0820) loss_zs_kd 0.3423 (0.3617) loss_oracle 0.7002 (0.6646) acc 34.3750 (42.1429) kd_loss 0.8100 (0.8267) lr 1.9298e-03 eta 0:28:21
epoch [8/50] batch [160/428] time 0.071 (0.094) data 0.000 (0.004) loss 2.0610 (1.9248) ce_loss 1.6611 (1.5451) teacher_loss 1.1131 (1.0744) loss_zs_kd 0.3941 (0.3650) loss_oracle 0.7509 (0.6679) acc 53.1250 (41.9531) kd_loss 0.8532 (0.8249) lr 1.9298e-03 eta 0:28:26
epoch [8/50] batch [180/428] time 0.071 (0.095) data 0.000 (0.004) loss 1.8428 (1.9223) ce_loss 1.6318 (1.5431) teacher_loss 1.0622 (1.0714) loss_zs_kd 0.3441 (0.3649) loss_oracle 0.6086 (0.6683) acc 37.5000 (41.9618) kd_loss 0.7515 (0.8209) lr 1.9298e-03 eta 0:28:59
epoch [8/50] batch [200/428] time 0.071 (0.096) data 0.000 (0.003) loss 1.8973 (1.9171) ce_loss 1.6855 (1.5353) teacher_loss 1.1068 (1.0669) loss_zs_kd 0.4039 (0.3679) loss_oracle 0.5885 (0.6662) acc 37.5000 (42.1719) kd_loss 0.8157 (0.8170) lr 1.9298e-03 eta 0:29:03
epoch [8/50] batch [220/428] time 0.078 (0.094) data 0.000 (0.003) loss 1.9286 (1.9125) ce_loss 1.5850 (1.5294) teacher_loss 1.1278 (1.0642) loss_zs_kd 0.4134 (0.3714) loss_oracle 0.5940 (0.6626) acc 40.6250 (42.3153) kd_loss 0.7557 (0.8123) lr 1.9298e-03 eta 0:28:37
epoch [8/50] batch [240/428] time 0.079 (0.095) data 0.000 (0.003) loss 1.8168 (1.9077) ce_loss 1.3145 (1.5200) teacher_loss 0.9762 (1.0614) loss_zs_kd 0.4001 (0.3735) loss_oracle 0.6406 (0.6596) acc 65.6250 (42.7734) kd_loss 0.7806 (0.8075) lr 1.9298e-03 eta 0:28:52
epoch [8/50] batch [260/428] time 0.171 (0.097) data 0.000 (0.003) loss 1.7132 (1.8991) ce_loss 1.3799 (1.5110) teacher_loss 0.9512 (1.0551) loss_zs_kd 0.3925 (0.3759) loss_oracle 0.5657 (0.6561) acc 50.0000 (43.0409) kd_loss 0.7476 (0.8038) lr 1.9298e-03 eta 0:29:18
epoch [8/50] batch [280/428] time 0.077 (0.097) data 0.000 (0.002) loss 1.8627 (1.8922) ce_loss 1.5137 (1.5038) teacher_loss 1.0337 (1.0498) loss_zs_kd 0.3823 (0.3785) loss_oracle 0.6379 (0.6532) acc 43.7500 (43.4375) kd_loss 0.7615 (0.8005) lr 1.9298e-03 eta 0:29:15
epoch [8/50] batch [300/428] time 0.197 (0.099) data 0.000 (0.002) loss 1.8739 (1.8902) ce_loss 1.3896 (1.4987) teacher_loss 1.0584 (1.0493) loss_zs_kd 0.4219 (0.3813) loss_oracle 0.6045 (0.6503) acc 53.1250 (43.7396) kd_loss 0.7323 (0.7965) lr 1.9298e-03 eta 0:29:43
epoch [8/50] batch [320/428] time 0.095 (0.098) data 0.000 (0.002) loss 1.7682 (1.8811) ce_loss 1.4209 (1.4936) teacher_loss 0.8888 (1.0415) loss_zs_kd 0.5090 (0.3852) loss_oracle 0.6249 (0.6470) acc 50.0000 (43.9355) kd_loss 0.7365 (0.7951) lr 1.9298e-03 eta 0:29:31
epoch [8/50] batch [340/428] time 0.085 (0.098) data 0.000 (0.002) loss 1.5643 (1.8747) ce_loss 1.2305 (1.4906) teacher_loss 0.6991 (1.0359) loss_zs_kd 0.5754 (0.3903) loss_oracle 0.5775 (0.6437) acc 56.2500 (44.0625) kd_loss 0.7668 (0.7943) lr 1.9298e-03 eta 0:29:24
epoch [8/50] batch [360/428] time 0.095 (0.097) data 0.000 (0.002) loss 1.6679 (1.8662) ce_loss 1.4023 (1.4837) teacher_loss 0.8234 (1.0277) loss_zs_kd 0.4169 (0.3955) loss_oracle 0.6361 (0.6407) acc 53.1250 (44.4097) kd_loss 0.7706 (0.7935) lr 1.9298e-03 eta 0:29:16
epoch [8/50] batch [380/428] time 0.091 (0.097) data 0.000 (0.002) loss 1.6515 (1.8563) ce_loss 1.3340 (1.4788) teacher_loss 0.9390 (1.0206) loss_zs_kd 0.4449 (0.3993) loss_oracle 0.4900 (0.6360) acc 43.7500 (44.7122) kd_loss 0.7753 (0.7933) lr 1.9298e-03 eta 0:29:13
epoch [8/50] batch [400/428] time 0.114 (0.097) data 0.000 (0.002) loss 1.3312 (1.8477) ce_loss 0.9385 (1.4751) teacher_loss 0.5117 (1.0157) loss_zs_kd 0.4768 (0.4025) loss_oracle 0.5811 (0.6308) acc 65.6250 (44.8125) kd_loss 0.8225 (0.7936) lr 1.9298e-03 eta 0:29:15
epoch [8/50] batch [420/428] time 0.092 (0.098) data 0.000 (0.002) loss 1.6804 (1.8391) ce_loss 1.5264 (1.4710) teacher_loss 1.0238 (1.0119) loss_zs_kd 0.3674 (0.4051) loss_oracle 0.4729 (0.6247) acc 50.0000 (45.0372) kd_loss 0.7685 (0.7938) lr 1.9298e-03 eta 0:29:15
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,854
* accuracy: 48.6%
* error: 51.4%
* macro_f1: 36.5%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,633
* accuracy: 55.5%
* error: 44.5%
* macro_f1: 30.2%
******* Domain 1 best val acc:      49.7%, epoch: 4 *******
******* Domain 1 best val test acc: 50.7%, epoch: 4 *******
******* Domain 1 best test acc:     56.8%, epoch: 2 *******
epoch [9/50] batch [20/428] time 0.109 (0.131) data 0.000 (0.028) loss 1.4595 (1.6555) ce_loss 1.1914 (1.3763) teacher_loss 0.7003 (0.9280) loss_zs_kd 0.5002 (0.4561) loss_oracle 0.5091 (0.4994) acc 53.1250 (50.7812) kd_loss 0.7663 (0.7777) lr 1.9048e-03 eta 0:39:12
epoch [9/50] batch [40/428] time 0.105 (0.117) data 0.000 (0.014) loss 1.7079 (1.6522) ce_loss 1.5488 (1.4036) teacher_loss 0.9597 (0.9328) loss_zs_kd 0.4667 (0.4547) loss_oracle 0.5149 (0.4920) acc 43.7500 (48.7500) kd_loss 0.7696 (0.7870) lr 1.9048e-03 eta 0:34:54
epoch [9/50] batch [60/428] time 0.095 (0.112) data 0.000 (0.009) loss 1.5519 (1.6618) ce_loss 1.1328 (1.4088) teacher_loss 0.8416 (0.9451) loss_zs_kd 0.4449 (0.4515) loss_oracle 0.4879 (0.4909) acc 59.3750 (48.6979) kd_loss 0.8654 (0.7954) lr 1.9048e-03 eta 0:33:23
epoch [9/50] batch [80/428] time 0.102 (0.110) data 0.000 (0.007) loss 1.6637 (1.6534) ce_loss 1.3643 (1.3967) teacher_loss 0.9499 (0.9465) loss_zs_kd 0.4968 (0.4540) loss_oracle 0.4653 (0.4799) acc 56.2500 (49.4922) kd_loss 0.8621 (0.8008) lr 1.9048e-03 eta 0:32:44
epoch [9/50] batch [100/428] time 0.099 (0.108) data 0.000 (0.006) loss 1.6107 (1.6541) ce_loss 1.5205 (1.3999) teacher_loss 0.9160 (0.9537) loss_zs_kd 0.4375 (0.4569) loss_oracle 0.4759 (0.4720) acc 43.7500 (49.3750) kd_loss 0.8884 (0.8050) lr 1.9048e-03 eta 0:32:04
epoch [9/50] batch [120/428] time 0.155 (0.105) data 0.000 (0.005) loss 1.5759 (1.6487) ce_loss 1.4346 (1.3961) teacher_loss 0.9725 (0.9471) loss_zs_kd 0.4861 (0.4618) loss_oracle 0.3603 (0.4707) acc 43.7500 (49.6615) kd_loss 0.8568 (0.8164) lr 1.9048e-03 eta 0:31:07
epoch [9/50] batch [140/428] time 0.170 (0.106) data 0.000 (0.004) loss 1.7725 (1.6459) ce_loss 1.5801 (1.3998) teacher_loss 1.0649 (0.9426) loss_zs_kd 0.5032 (0.4670) loss_oracle 0.4560 (0.4698) acc 43.7500 (49.6429) kd_loss 0.9721 (0.8255) lr 1.9048e-03 eta 0:31:27
epoch [9/50] batch [160/428] time 0.080 (0.106) data 0.000 (0.004) loss 1.8438 (1.6461) ce_loss 1.6982 (1.4058) teacher_loss 1.1747 (0.9406) loss_zs_kd 0.4766 (0.4721) loss_oracle 0.4308 (0.4695) acc 40.6250 (49.5898) kd_loss 1.0767 (0.8371) lr 1.9048e-03 eta 0:31:28
epoch [9/50] batch [180/428] time 0.078 (0.107) data 0.000 (0.003) loss 1.8797 (1.6508) ce_loss 1.6904 (1.4092) teacher_loss 1.1400 (0.9453) loss_zs_kd 0.4899 (0.4717) loss_oracle 0.4947 (0.4697) acc 50.0000 (49.7049) kd_loss 1.0157 (0.8448) lr 1.9048e-03 eta 0:31:42
epoch [9/50] batch [200/428] time 0.081 (0.107) data 0.000 (0.003) loss 1.5761 (1.6523) ce_loss 1.3838 (1.4185) teacher_loss 0.9033 (0.9461) loss_zs_kd 0.4513 (0.4759) loss_oracle 0.4471 (0.4683) acc 62.5000 (49.5156) kd_loss 1.0108 (0.8503) lr 1.9048e-03 eta 0:31:39
epoch [9/50] batch [220/428] time 0.084 (0.106) data 0.000 (0.003) loss 1.7097 (1.6498) ce_loss 1.3096 (1.4197) teacher_loss 0.9551 (0.9472) loss_zs_kd 0.5580 (0.4743) loss_oracle 0.4755 (0.4654) acc 53.1250 (49.5455) kd_loss 0.8382 (0.8564) lr 1.9048e-03 eta 0:31:28
epoch [9/50] batch [240/428] time 0.177 (0.107) data 0.000 (0.003) loss 1.7076 (1.6463) ce_loss 1.4424 (1.4235) teacher_loss 0.9111 (0.9448) loss_zs_kd 0.4643 (0.4752) loss_oracle 0.5643 (0.4638) acc 59.3750 (49.5312) kd_loss 0.9943 (0.8628) lr 1.9048e-03 eta 0:31:34
epoch [9/50] batch [260/428] time 0.093 (0.108) data 0.000 (0.002) loss 1.7738 (1.6484) ce_loss 1.7129 (1.4324) teacher_loss 1.0175 (0.9494) loss_zs_kd 0.5530 (0.4744) loss_oracle 0.4798 (0.4618) acc 43.7500 (49.1346) kd_loss 0.8707 (0.8696) lr 1.9048e-03 eta 0:31:44
epoch [9/50] batch [280/428] time 0.077 (0.108) data 0.000 (0.002) loss 1.4870 (1.6466) ce_loss 1.3594 (1.4329) teacher_loss 0.8482 (0.9469) loss_zs_kd 0.4447 (0.4764) loss_oracle 0.4164 (0.4615) acc 50.0000 (49.2299) kd_loss 0.9602 (0.8744) lr 1.9048e-03 eta 0:31:47
epoch [9/50] batch [300/428] time 0.109 (0.107) data 0.000 (0.002) loss 1.6911 (1.6453) ce_loss 1.5459 (1.4342) teacher_loss 0.9518 (0.9455) loss_zs_kd 0.5456 (0.4774) loss_oracle 0.4665 (0.4611) acc 40.6250 (49.1562) kd_loss 0.9174 (0.8772) lr 1.9048e-03 eta 0:31:32
epoch [9/50] batch [320/428] time 0.096 (0.107) data 0.000 (0.002) loss 1.6916 (1.6404) ce_loss 1.6025 (1.4347) teacher_loss 0.9377 (0.9385) loss_zs_kd 0.4373 (0.4764) loss_oracle 0.5352 (0.4637) acc 40.6250 (49.2285) kd_loss 0.9073 (0.8807) lr 1.9048e-03 eta 0:31:24
epoch [9/50] batch [340/428] time 0.106 (0.107) data 0.000 (0.002) loss 1.6609 (1.6419) ce_loss 1.5068 (1.4405) teacher_loss 1.1001 (0.9415) loss_zs_kd 0.3860 (0.4736) loss_oracle 0.3677 (0.4636) acc 43.7500 (48.9522) kd_loss 0.8893 (0.8800) lr 1.9048e-03 eta 0:31:18
epoch [9/50] batch [360/428] time 0.104 (0.106) data 0.000 (0.002) loss 1.6726 (1.6426) ce_loss 1.3730 (1.4426) teacher_loss 0.9616 (0.9422) loss_zs_kd 0.4638 (0.4720) loss_oracle 0.4791 (0.4644) acc 40.6250 (48.9236) kd_loss 0.8275 (0.8793) lr 1.9048e-03 eta 0:31:11
epoch [9/50] batch [380/428] time 0.095 (0.106) data 0.000 (0.002) loss 1.7439 (1.6466) ce_loss 1.5547 (1.4496) teacher_loss 1.0913 (0.9460) loss_zs_kd 0.4271 (0.4707) loss_oracle 0.4390 (0.4652) acc 43.7500 (48.7089) kd_loss 0.8546 (0.8788) lr 1.9048e-03 eta 0:31:06
epoch [9/50] batch [400/428] time 0.090 (0.106) data 0.000 (0.002) loss 1.9024 (1.6511) ce_loss 1.7754 (1.4578) teacher_loss 1.0943 (0.9488) loss_zs_kd 0.5228 (0.4701) loss_oracle 0.5467 (0.4672) acc 40.6250 (48.3594) kd_loss 0.9126 (0.8785) lr 1.9048e-03 eta 0:31:01
epoch [9/50] batch [420/428] time 0.096 (0.106) data 0.000 (0.002) loss 1.4638 (1.6509) ce_loss 1.2949 (1.4578) teacher_loss 0.7601 (0.9482) loss_zs_kd 0.4012 (0.4695) loss_oracle 0.5031 (0.4679) acc 46.8750 (48.2664) kd_loss 0.7664 (0.8765) lr 1.9048e-03 eta 0:30:54
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,667
* accuracy: 45.4%
* error: 54.6%
* macro_f1: 33.8%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,747
* accuracy: 57.9%
* error: 42.1%
* macro_f1: 30.4%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 1 best val acc:      49.7%, epoch: 4 *******
******* Domain 1 best val test acc: 50.7%, epoch: 4 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [10/50] batch [20/428] time 0.090 (0.132) data 0.000 (0.025) loss 1.7568 (1.6905) ce_loss 1.6104 (1.5269) teacher_loss 1.0135 (0.9594) loss_zs_kd 0.5060 (0.4525) loss_oracle 0.4903 (0.5048) acc 34.3750 (44.6875) kd_loss 0.8527 (0.8222) lr 1.8763e-03 eta 0:38:31
epoch [10/50] batch [40/428] time 0.084 (0.117) data 0.000 (0.013) loss 1.5382 (1.7234) ce_loss 1.2246 (1.5163) teacher_loss 0.7772 (0.9848) loss_zs_kd 0.4053 (0.4428) loss_oracle 0.5584 (0.5173) acc 56.2500 (45.3125) kd_loss 0.7755 (0.8181) lr 1.8763e-03 eta 0:34:03
epoch [10/50] batch [60/428] time 0.087 (0.109) data 0.000 (0.009) loss 1.7180 (1.7109) ce_loss 1.4121 (1.4931) teacher_loss 1.0526 (0.9762) loss_zs_kd 0.3745 (0.4288) loss_oracle 0.4781 (0.5203) acc 43.7500 (47.2396) kd_loss 0.7746 (0.8123) lr 1.8763e-03 eta 0:31:45
epoch [10/50] batch [80/428] time 0.095 (0.104) data 0.000 (0.007) loss 1.8813 (1.7116) ce_loss 1.4805 (1.4977) teacher_loss 1.0297 (0.9706) loss_zs_kd 0.5268 (0.4382) loss_oracle 0.5882 (0.5218) acc 53.1250 (47.0703) kd_loss 0.8388 (0.8117) lr 1.8763e-03 eta 0:30:15
epoch [10/50] batch [100/428] time 0.148 (0.105) data 0.000 (0.005) loss 1.5720 (1.7135) ce_loss 1.4062 (1.5018) teacher_loss 0.8482 (0.9730) loss_zs_kd 0.4307 (0.4384) loss_oracle 0.5085 (0.5213) acc 43.7500 (46.5000) kd_loss 0.8632 (0.8068) lr 1.8763e-03 eta 0:30:40
epoch [10/50] batch [120/428] time 0.073 (0.107) data 0.000 (0.004) loss 1.7810 (1.7105) ce_loss 1.3711 (1.5103) teacher_loss 1.0083 (0.9676) loss_zs_kd 0.5099 (0.4410) loss_oracle 0.5178 (0.5223) acc 56.2500 (46.0417) kd_loss 0.7474 (0.8074) lr 1.8763e-03 eta 0:31:01
epoch [10/50] batch [140/428] time 0.157 (0.106) data 0.000 (0.004) loss 1.5738 (1.7040) ce_loss 1.4180 (1.5086) teacher_loss 0.9547 (0.9574) loss_zs_kd 0.4055 (0.4428) loss_oracle 0.4164 (0.5251) acc 40.6250 (46.0938) kd_loss 0.8311 (0.8059) lr 1.8763e-03 eta 0:30:49
epoch [10/50] batch [160/428] time 0.160 (0.107) data 0.000 (0.003) loss 1.4985 (1.7026) ce_loss 1.2754 (1.5045) teacher_loss 0.8524 (0.9549) loss_zs_kd 0.3654 (0.4435) loss_oracle 0.4634 (0.5259) acc 53.1250 (46.2500) kd_loss 0.8371 (0.8050) lr 1.8763e-03 eta 0:31:00
epoch [10/50] batch [180/428] time 0.087 (0.104) data 0.000 (0.003) loss 1.7004 (1.7044) ce_loss 1.4844 (1.5067) teacher_loss 0.9437 (0.9559) loss_zs_kd 0.4284 (0.4455) loss_oracle 0.5426 (0.5257) acc 59.3750 (46.5278) kd_loss 0.8216 (0.8044) lr 1.8763e-03 eta 0:30:09
epoch [10/50] batch [200/428] time 0.067 (0.105) data 0.000 (0.003) loss 1.5725 (1.6964) ce_loss 1.5020 (1.5034) teacher_loss 0.8098 (0.9498) loss_zs_kd 0.4246 (0.4421) loss_oracle 0.5504 (0.5256) acc 34.3750 (46.5156) kd_loss 0.8316 (0.8049) lr 1.8763e-03 eta 0:30:27
epoch [10/50] batch [220/428] time 0.142 (0.107) data 0.000 (0.003) loss 1.5061 (1.6926) ce_loss 1.4531 (1.5088) teacher_loss 0.7110 (0.9428) loss_zs_kd 0.5072 (0.4444) loss_oracle 0.5414 (0.5276) acc 43.7500 (46.3210) kd_loss 0.8764 (0.8054) lr 1.8763e-03 eta 0:30:45
epoch [10/50] batch [240/428] time 0.158 (0.108) data 0.000 (0.002) loss 1.9357 (1.6933) ce_loss 1.9092 (1.5112) teacher_loss 1.1062 (0.9398) loss_zs_kd 0.5135 (0.4469) loss_oracle 0.5728 (0.5301) acc 31.2500 (46.0938) kd_loss 0.8355 (0.8054) lr 1.8763e-03 eta 0:31:00
epoch [10/50] batch [260/428] time 0.079 (0.107) data 0.000 (0.002) loss 1.7487 (1.6887) ce_loss 1.6670 (1.5112) teacher_loss 0.8592 (0.9309) loss_zs_kd 0.5790 (0.4503) loss_oracle 0.6001 (0.5326) acc 43.7500 (46.1659) kd_loss 0.8642 (0.8062) lr 1.8763e-03 eta 0:30:45
epoch [10/50] batch [280/428] time 0.096 (0.106) data 0.000 (0.002) loss 1.5288 (1.6832) ce_loss 1.6738 (1.5075) teacher_loss 0.7517 (0.9209) loss_zs_kd 0.4067 (0.4531) loss_oracle 0.5738 (0.5358) acc 46.8750 (46.2612) kd_loss 0.8348 (0.8072) lr 1.8763e-03 eta 0:30:34
epoch [10/50] batch [300/428] time 0.112 (0.106) data 0.000 (0.002) loss 1.3354 (1.6790) ce_loss 1.1133 (1.5074) teacher_loss 0.5677 (0.9145) loss_zs_kd 0.4615 (0.4551) loss_oracle 0.5370 (0.5369) acc 62.5000 (46.2500) kd_loss 0.7614 (0.8088) lr 1.8763e-03 eta 0:30:22
epoch [10/50] batch [320/428] time 0.099 (0.105) data 0.000 (0.002) loss 1.3810 (1.6731) ce_loss 1.0781 (1.4993) teacher_loss 0.6591 (0.9077) loss_zs_kd 0.4595 (0.4567) loss_oracle 0.4921 (0.5371) acc 62.5000 (46.4258) kd_loss 0.8453 (0.8100) lr 1.8763e-03 eta 0:30:16
epoch [10/50] batch [340/428] time 0.109 (0.105) data 0.000 (0.002) loss 2.1015 (1.6763) ce_loss 1.7148 (1.5018) teacher_loss 1.3063 (0.9083) loss_zs_kd 0.4869 (0.4602) loss_oracle 0.5517 (0.5379) acc 46.8750 (46.2868) kd_loss 0.7983 (0.8111) lr 1.8763e-03 eta 0:30:13
epoch [10/50] batch [360/428] time 0.102 (0.105) data 0.000 (0.002) loss 1.5570 (1.6744) ce_loss 1.4443 (1.4976) teacher_loss 0.7416 (0.9040) loss_zs_kd 0.4773 (0.4633) loss_oracle 0.5767 (0.5388) acc 43.7500 (46.3889) kd_loss 0.7877 (0.8122) lr 1.8763e-03 eta 0:30:10
epoch [10/50] batch [380/428] time 0.099 (0.105) data 0.000 (0.002) loss 2.1276 (1.6726) ce_loss 2.0195 (1.4927) teacher_loss 1.2995 (0.9003) loss_zs_kd 0.4656 (0.4649) loss_oracle 0.5954 (0.5398) acc 34.3750 (46.5707) kd_loss 0.7535 (0.8118) lr 1.8763e-03 eta 0:30:06
epoch [10/50] batch [400/428] time 0.100 (0.105) data 0.000 (0.002) loss 1.7125 (1.6709) ce_loss 1.7783 (1.4923) teacher_loss 0.8594 (0.8972) loss_zs_kd 0.5502 (0.4660) loss_oracle 0.5779 (0.5406) acc 25.0000 (46.5000) kd_loss 0.8227 (0.8116) lr 1.8763e-03 eta 0:30:04
epoch [10/50] batch [420/428] time 0.094 (0.105) data 0.000 (0.001) loss 1.6580 (1.6721) ce_loss 1.5615 (1.4937) teacher_loss 0.8673 (0.8976) loss_zs_kd 0.4589 (0.4656) loss_oracle 0.5612 (0.5417) acc 46.8750 (46.4062) kd_loss 0.8076 (0.8125) lr 1.8763e-03 eta 0:29:59
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,767
* accuracy: 47.1%
* error: 52.9%
* macro_f1: 34.2%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,686
* accuracy: 56.7%
* error: 43.3%
* macro_f1: 30.9%
******* Domain 1 best val acc:      49.7%, epoch: 4 *******
******* Domain 1 best val test acc: 50.7%, epoch: 4 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [11/50] batch [20/428] time 0.118 (0.134) data 0.000 (0.029) loss 1.7026 (1.6607) ce_loss 1.6182 (1.4618) teacher_loss 0.8214 (0.8536) loss_zs_kd 0.5199 (0.4842) loss_oracle 0.6212 (0.5650) acc 43.7500 (47.1875) kd_loss 0.8318 (0.8038) lr 1.8443e-03 eta 0:38:08
epoch [11/50] batch [40/428] time 0.100 (0.120) data 0.000 (0.015) loss 1.7101 (1.6184) ce_loss 1.6699 (1.4411) teacher_loss 0.8991 (0.8181) loss_zs_kd 0.5031 (0.4859) loss_oracle 0.5594 (0.5574) acc 40.6250 (48.4375) kd_loss 0.8109 (0.8117) lr 1.8443e-03 eta 0:34:01
epoch [11/50] batch [60/428] time 0.106 (0.114) data 0.000 (0.010) loss 1.6044 (1.6158) ce_loss 1.2773 (1.4582) teacher_loss 0.7752 (0.8149) loss_zs_kd 0.5447 (0.4905) loss_oracle 0.5568 (0.5556) acc 43.7500 (47.5521) kd_loss 0.7735 (0.8162) lr 1.8443e-03 eta 0:32:31
epoch [11/50] batch [80/428] time 0.082 (0.107) data 0.000 (0.007) loss 1.6961 (1.6103) ce_loss 1.4805 (1.4673) teacher_loss 0.9135 (0.8126) loss_zs_kd 0.4467 (0.4810) loss_oracle 0.5592 (0.5572) acc 46.8750 (47.0312) kd_loss 0.7240 (0.8154) lr 1.8443e-03 eta 0:30:29
epoch [11/50] batch [100/428] time 0.092 (0.106) data 0.000 (0.006) loss 1.4192 (1.6173) ce_loss 1.2988 (1.4764) teacher_loss 0.6541 (0.8209) loss_zs_kd 0.4982 (0.4791) loss_oracle 0.5161 (0.5569) acc 56.2500 (46.4062) kd_loss 0.7877 (0.8147) lr 1.8443e-03 eta 0:29:58
epoch [11/50] batch [120/428] time 0.151 (0.105) data 0.000 (0.005) loss 1.6588 (1.6129) ce_loss 1.6104 (1.4837) teacher_loss 0.8549 (0.8188) loss_zs_kd 0.4829 (0.4751) loss_oracle 0.5625 (0.5566) acc 43.7500 (46.3021) kd_loss 0.8566 (0.8181) lr 1.8443e-03 eta 0:29:50
epoch [11/50] batch [140/428] time 0.155 (0.107) data 0.000 (0.004) loss 1.8582 (1.6185) ce_loss 1.7812 (1.4920) teacher_loss 0.9935 (0.8235) loss_zs_kd 0.5350 (0.4759) loss_oracle 0.5972 (0.5570) acc 43.7500 (46.0268) kd_loss 0.7544 (0.8168) lr 1.8443e-03 eta 0:30:09
epoch [11/50] batch [160/428] time 0.080 (0.107) data 0.000 (0.004) loss 1.7727 (1.6225) ce_loss 1.7725 (1.4997) teacher_loss 0.9975 (0.8263) loss_zs_kd 0.4754 (0.4788) loss_oracle 0.5375 (0.5569) acc 40.6250 (45.7812) kd_loss 0.8748 (0.8191) lr 1.8443e-03 eta 0:30:13
epoch [11/50] batch [180/428] time 0.079 (0.105) data 0.000 (0.003) loss 1.6651 (1.6238) ce_loss 1.3857 (1.5009) teacher_loss 0.8421 (0.8285) loss_zs_kd 0.5233 (0.4789) loss_oracle 0.5614 (0.5558) acc 43.7500 (45.5556) kd_loss 0.7891 (0.8169) lr 1.8443e-03 eta 0:29:38
epoch [11/50] batch [200/428] time 0.072 (0.106) data 0.000 (0.003) loss 1.5955 (1.6257) ce_loss 1.6875 (1.5061) teacher_loss 0.8118 (0.8297) loss_zs_kd 0.4560 (0.4793) loss_oracle 0.5557 (0.5564) acc 53.1250 (45.4844) kd_loss 0.8371 (0.8187) lr 1.8443e-03 eta 0:29:50
epoch [11/50] batch [220/428] time 0.092 (0.105) data 0.000 (0.003) loss 1.5981 (1.6250) ce_loss 1.4746 (1.5094) teacher_loss 0.8155 (0.8289) loss_zs_kd 0.4728 (0.4808) loss_oracle 0.5462 (0.5557) acc 46.8750 (45.4119) kd_loss 0.7968 (0.8200) lr 1.8443e-03 eta 0:29:40
epoch [11/50] batch [240/428] time 0.081 (0.106) data 0.000 (0.003) loss 1.7027 (1.6261) ce_loss 1.7881 (1.5104) teacher_loss 0.8035 (0.8277) loss_zs_kd 0.5434 (0.4811) loss_oracle 0.6275 (0.5579) acc 34.3750 (45.5078) kd_loss 0.8274 (0.8220) lr 1.8443e-03 eta 0:29:52
epoch [11/50] batch [260/428] time 0.079 (0.107) data 0.000 (0.002) loss 1.7303 (1.6298) ce_loss 1.5303 (1.5176) teacher_loss 0.9308 (0.8324) loss_zs_kd 0.4927 (0.4806) loss_oracle 0.5531 (0.5571) acc 46.8750 (45.2404) kd_loss 0.7893 (0.8218) lr 1.8443e-03 eta 0:30:01
epoch [11/50] batch [280/428] time 0.101 (0.106) data 0.000 (0.002) loss 1.5537 (1.6283) ce_loss 1.3311 (1.5167) teacher_loss 0.7551 (0.8325) loss_zs_kd 0.5426 (0.4802) loss_oracle 0.5273 (0.5557) acc 50.0000 (45.4799) kd_loss 0.7939 (0.8213) lr 1.8443e-03 eta 0:29:46
epoch [11/50] batch [300/428] time 0.101 (0.106) data 0.000 (0.002) loss 1.7870 (1.6295) ce_loss 1.6348 (1.5213) teacher_loss 1.0413 (0.8354) loss_zs_kd 0.4598 (0.4790) loss_oracle 0.5159 (0.5546) acc 43.7500 (45.4271) kd_loss 0.8060 (0.8209) lr 1.8443e-03 eta 0:29:39
epoch [11/50] batch [320/428] time 0.116 (0.106) data 0.000 (0.002) loss 1.5916 (1.6298) ce_loss 1.4365 (1.5223) teacher_loss 0.8008 (0.8375) loss_zs_kd 0.5077 (0.4779) loss_oracle 0.5370 (0.5534) acc 50.0000 (45.4590) kd_loss 0.8102 (0.8207) lr 1.8443e-03 eta 0:29:33
epoch [11/50] batch [340/428] time 0.100 (0.106) data 0.000 (0.002) loss 1.5726 (1.6276) ce_loss 1.7051 (1.5197) teacher_loss 0.8083 (0.8357) loss_zs_kd 0.4483 (0.4770) loss_oracle 0.5401 (0.5534) acc 34.3750 (45.6526) kd_loss 0.9113 (0.8205) lr 1.8443e-03 eta 0:29:30
epoch [11/50] batch [360/428] time 0.096 (0.105) data 0.000 (0.002) loss 1.5372 (1.6260) ce_loss 1.5850 (1.5195) teacher_loss 0.8237 (0.8353) loss_zs_kd 0.4546 (0.4770) loss_oracle 0.4862 (0.5522) acc 34.3750 (45.6771) kd_loss 0.9140 (0.8205) lr 1.8443e-03 eta 0:29:19
epoch [11/50] batch [380/428] time 0.100 (0.105) data 0.000 (0.002) loss 1.7127 (1.6258) ce_loss 1.5000 (1.5189) teacher_loss 0.9098 (0.8390) loss_zs_kd 0.4861 (0.4748) loss_oracle 0.5599 (0.5494) acc 50.0000 (45.7812) kd_loss 0.7883 (0.8203) lr 1.8443e-03 eta 0:29:12
epoch [11/50] batch [400/428] time 0.113 (0.105) data 0.000 (0.002) loss 1.6276 (1.6285) ce_loss 1.3271 (1.5198) teacher_loss 0.8563 (0.8440) loss_zs_kd 0.4853 (0.4723) loss_oracle 0.5287 (0.5484) acc 56.2500 (45.7734) kd_loss 0.7301 (0.8187) lr 1.8443e-03 eta 0:29:12
epoch [11/50] batch [420/428] time 0.101 (0.105) data 0.000 (0.002) loss 1.6484 (1.6289) ce_loss 1.2969 (1.5196) teacher_loss 0.9195 (0.8460) loss_zs_kd 0.4197 (0.4704) loss_oracle 0.5191 (0.5477) acc 50.0000 (45.8259) kd_loss 0.7459 (0.8186) lr 1.8443e-03 eta 0:29:09
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,806
* accuracy: 47.8%
* error: 52.2%
* macro_f1: 33.4%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,451
* accuracy: 51.7%
* error: 48.3%
* macro_f1: 30.7%
******* Domain 1 best val acc:      49.7%, epoch: 4 *******
******* Domain 1 best val test acc: 50.7%, epoch: 4 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [12/50] batch [20/428] time 0.114 (0.132) data 0.000 (0.024) loss 1.5487 (1.6322) ce_loss 1.2090 (1.5302) teacher_loss 0.8391 (0.8959) loss_zs_kd 0.4196 (0.4379) loss_oracle 0.4998 (0.5173) acc 62.5000 (47.9688) kd_loss 0.7414 (0.8341) lr 1.8090e-03 eta 0:36:45
epoch [12/50] batch [40/428] time 0.106 (0.119) data 0.000 (0.012) loss 1.5889 (1.6302) ce_loss 1.8975 (1.5374) teacher_loss 0.8189 (0.9081) loss_zs_kd 0.5029 (0.4321) loss_oracle 0.5185 (0.5060) acc 31.2500 (46.7188) kd_loss 0.8945 (0.8634) lr 1.8090e-03 eta 0:32:58
epoch [12/50] batch [60/428] time 0.112 (0.114) data 0.000 (0.008) loss 1.7378 (1.6516) ce_loss 1.6709 (1.5246) teacher_loss 1.0214 (0.9343) loss_zs_kd 0.3566 (0.4285) loss_oracle 0.5381 (0.5030) acc 31.2500 (46.3542) kd_loss 0.9809 (0.8655) lr 1.8090e-03 eta 0:31:30
epoch [12/50] batch [80/428] time 0.078 (0.107) data 0.000 (0.006) loss 1.5914 (1.6691) ce_loss 1.2979 (1.5148) teacher_loss 0.8255 (0.9483) loss_zs_kd 0.4614 (0.4242) loss_oracle 0.5352 (0.5087) acc 59.3750 (46.8750) kd_loss 0.8597 (0.8702) lr 1.8090e-03 eta 0:29:42
epoch [12/50] batch [100/428] time 0.100 (0.106) data 0.001 (0.005) loss 1.9480 (1.6792) ce_loss 1.6523 (1.5175) teacher_loss 1.2375 (0.9616) loss_zs_kd 0.4213 (0.4215) loss_oracle 0.4999 (0.5069) acc 43.7500 (46.7812) kd_loss 0.8382 (0.8797) lr 1.8090e-03 eta 0:29:26
epoch [12/50] batch [120/428] time 0.170 (0.108) data 0.000 (0.004) loss 1.6495 (1.6886) ce_loss 1.2529 (1.5325) teacher_loss 0.9738 (0.9736) loss_zs_kd 0.3799 (0.4201) loss_oracle 0.4858 (0.5050) acc 50.0000 (46.6406) kd_loss 0.8083 (0.8869) lr 1.8090e-03 eta 0:29:44
epoch [12/50] batch [140/428] time 0.078 (0.109) data 0.000 (0.004) loss 1.5852 (1.6896) ce_loss 1.4023 (1.5204) teacher_loss 0.9105 (0.9805) loss_zs_kd 0.3510 (0.4152) loss_oracle 0.4991 (0.5015) acc 59.3750 (46.9866) kd_loss 0.9879 (0.8946) lr 1.8090e-03 eta 0:30:06
epoch [12/50] batch [160/428] time 0.080 (0.109) data 0.000 (0.003) loss 1.7794 (1.7019) ce_loss 1.5391 (1.5165) teacher_loss 0.9833 (0.9913) loss_zs_kd 0.4372 (0.4126) loss_oracle 0.5775 (0.5044) acc 43.7500 (47.1875) kd_loss 1.0003 (0.9011) lr 1.8090e-03 eta 0:30:05
epoch [12/50] batch [180/428] time 0.082 (0.106) data 0.000 (0.003) loss 1.5348 (1.7079) ce_loss 1.1826 (1.5112) teacher_loss 0.8899 (0.9917) loss_zs_kd 0.3821 (0.4153) loss_oracle 0.4539 (0.5086) acc 59.3750 (47.5000) kd_loss 1.0088 (0.9106) lr 1.8090e-03 eta 0:29:16
epoch [12/50] batch [200/428] time 0.060 (0.107) data 0.000 (0.003) loss 1.8203 (1.7149) ce_loss 1.4941 (1.5088) teacher_loss 1.1126 (0.9957) loss_zs_kd 0.4391 (0.4163) loss_oracle 0.4882 (0.5110) acc 50.0000 (47.6875) kd_loss 0.9881 (0.9192) lr 1.8090e-03 eta 0:29:22
epoch [12/50] batch [220/428] time 0.074 (0.108) data 0.000 (0.002) loss 1.6701 (1.7214) ce_loss 1.3438 (1.5099) teacher_loss 1.0540 (1.0034) loss_zs_kd 0.3270 (0.4134) loss_oracle 0.4526 (0.5113) acc 43.7500 (47.4716) kd_loss 1.0618 (0.9305) lr 1.8090e-03 eta 0:29:32
epoch [12/50] batch [240/428] time 0.081 (0.108) data 0.000 (0.002) loss 1.8605 (1.7275) ce_loss 1.6875 (1.5118) teacher_loss 1.2165 (1.0142) loss_zs_kd 0.3274 (0.4102) loss_oracle 0.4803 (0.5082) acc 46.8750 (47.3958) kd_loss 1.0602 (0.9409) lr 1.8090e-03 eta 0:29:41
epoch [12/50] batch [260/428] time 0.099 (0.108) data 0.000 (0.002) loss 1.4566 (1.7302) ce_loss 1.2197 (1.5120) teacher_loss 0.8229 (1.0192) loss_zs_kd 0.3402 (0.4094) loss_oracle 0.4636 (0.5063) acc 62.5000 (47.5601) kd_loss 1.1328 (0.9503) lr 1.8090e-03 eta 0:29:32
epoch [12/50] batch [280/428] time 0.105 (0.108) data 0.000 (0.002) loss 1.7475 (1.7324) ce_loss 1.5225 (1.5155) teacher_loss 0.9904 (1.0257) loss_zs_kd 0.4252 (0.4081) loss_oracle 0.5445 (0.5026) acc 46.8750 (47.4330) kd_loss 1.0309 (0.9571) lr 1.8090e-03 eta 0:29:29
epoch [12/50] batch [300/428] time 0.104 (0.108) data 0.000 (0.002) loss 1.6935 (1.7348) ce_loss 1.4150 (1.5122) teacher_loss 0.8953 (1.0297) loss_zs_kd 0.4816 (0.4067) loss_oracle 0.5573 (0.5017) acc 53.1250 (47.5521) kd_loss 1.0666 (0.9630) lr 1.8090e-03 eta 0:29:24
epoch [12/50] batch [320/428] time 0.106 (0.107) data 0.000 (0.002) loss 1.6137 (1.7350) ce_loss 1.3154 (1.5114) teacher_loss 0.9067 (1.0324) loss_zs_kd 0.3772 (0.4065) loss_oracle 0.5185 (0.4993) acc 65.6250 (47.4707) kd_loss 1.0818 (0.9697) lr 1.8090e-03 eta 0:29:16
epoch [12/50] batch [340/428] time 0.117 (0.107) data 0.000 (0.002) loss 1.9480 (1.7339) ce_loss 1.7959 (1.5091) teacher_loss 1.4547 (1.0365) loss_zs_kd 0.3060 (0.4033) loss_oracle 0.3403 (0.4957) acc 43.7500 (47.5735) kd_loss 0.9867 (0.9744) lr 1.8090e-03 eta 0:29:11
epoch [12/50] batch [360/428] time 0.110 (0.107) data 0.000 (0.002) loss 1.4801 (1.7305) ce_loss 1.0615 (1.5042) teacher_loss 0.7895 (1.0360) loss_zs_kd 0.3925 (0.4018) loss_oracle 0.4943 (0.4937) acc 59.3750 (47.8038) kd_loss 1.1268 (0.9781) lr 1.8090e-03 eta 0:29:06
epoch [12/50] batch [380/428] time 0.103 (0.107) data 0.000 (0.002) loss 1.8746 (1.7292) ce_loss 1.6826 (1.5034) teacher_loss 1.1996 (1.0381) loss_zs_kd 0.3494 (0.4005) loss_oracle 0.5003 (0.4909) acc 31.2500 (47.6480) kd_loss 0.8892 (0.9800) lr 1.8090e-03 eta 0:29:00
epoch [12/50] batch [400/428] time 0.103 (0.107) data 0.000 (0.001) loss 1.4510 (1.7295) ce_loss 1.4346 (1.5029) teacher_loss 0.8464 (1.0399) loss_zs_kd 0.3905 (0.4007) loss_oracle 0.4094 (0.4893) acc 50.0000 (47.6016) kd_loss 1.1378 (0.9827) lr 1.8090e-03 eta 0:28:56
epoch [12/50] batch [420/428] time 0.101 (0.106) data 0.000 (0.001) loss 1.7813 (1.7320) ce_loss 1.5938 (1.5062) teacher_loss 1.1941 (1.0435) loss_zs_kd 0.3301 (0.4006) loss_oracle 0.4222 (0.4883) acc 40.6250 (47.4777) kd_loss 1.0956 (0.9845) lr 1.8090e-03 eta 0:28:52
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,764
* accuracy: 47.0%
* error: 53.0%
* macro_f1: 30.3%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,388
* accuracy: 50.4%
* error: 49.6%
* macro_f1: 26.8%
******* Domain 1 best val acc:      49.7%, epoch: 4 *******
******* Domain 1 best val test acc: 50.7%, epoch: 4 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [13/50] batch [20/428] time 0.104 (0.131) data 0.000 (0.027) loss 1.6140 (1.7616) ce_loss 1.3311 (1.6271) teacher_loss 0.9660 (1.0830) loss_zs_kd 0.4890 (0.4361) loss_oracle 0.4035 (0.4605) acc 59.3750 (44.5312) kd_loss 0.9869 (1.0378) lr 1.7705e-03 eta 0:35:26
epoch [13/50] batch [40/428] time 0.099 (0.118) data 0.000 (0.014) loss 1.9045 (1.7565) ce_loss 1.7012 (1.5677) teacher_loss 1.1546 (1.0884) loss_zs_kd 0.4093 (0.4314) loss_oracle 0.5453 (0.4525) acc 46.8750 (46.7969) kd_loss 1.1061 (1.0448) lr 1.7705e-03 eta 0:31:59
epoch [13/50] batch [60/428] time 0.086 (0.110) data 0.000 (0.009) loss 1.7860 (1.7194) ce_loss 1.4658 (1.5387) teacher_loss 1.2058 (1.0675) loss_zs_kd 0.3705 (0.4107) loss_oracle 0.3950 (0.4466) acc 46.8750 (47.0312) kd_loss 0.9965 (1.0460) lr 1.7705e-03 eta 0:29:34
epoch [13/50] batch [80/428] time 0.073 (0.106) data 0.000 (0.007) loss 1.6922 (1.7199) ce_loss 1.5732 (1.5409) teacher_loss 1.0986 (1.0722) loss_zs_kd 0.3404 (0.4059) loss_oracle 0.4234 (0.4447) acc 40.6250 (46.5234) kd_loss 1.0204 (1.0468) lr 1.7705e-03 eta 0:28:39
epoch [13/50] batch [100/428] time 0.186 (0.105) data 0.000 (0.006) loss 1.6634 (1.7142) ce_loss 1.4561 (1.5325) teacher_loss 1.0815 (1.0687) loss_zs_kd 0.4461 (0.4037) loss_oracle 0.3589 (0.4436) acc 37.5000 (46.5312) kd_loss 1.0038 (1.0392) lr 1.7705e-03 eta 0:28:10
epoch [13/50] batch [120/428] time 0.176 (0.107) data 0.000 (0.005) loss 1.6126 (1.7147) ce_loss 1.3418 (1.5305) teacher_loss 1.0230 (1.0727) loss_zs_kd 0.3349 (0.4006) loss_oracle 0.4222 (0.4417) acc 59.3750 (46.6406) kd_loss 0.9684 (1.0327) lr 1.7705e-03 eta 0:28:52
epoch [13/50] batch [140/428] time 0.165 (0.108) data 0.000 (0.004) loss 1.5752 (1.7057) ce_loss 1.2988 (1.5146) teacher_loss 0.8818 (1.0637) loss_zs_kd 0.3908 (0.4011) loss_oracle 0.4981 (0.4415) acc 56.2500 (47.2545) kd_loss 1.1669 (1.0282) lr 1.7705e-03 eta 0:28:57
epoch [13/50] batch [160/428] time 0.084 (0.105) data 0.000 (0.004) loss 1.5764 (1.7086) ce_loss 1.2734 (1.5237) teacher_loss 0.9240 (1.0679) loss_zs_kd 0.3734 (0.3973) loss_oracle 0.4658 (0.4420) acc 50.0000 (46.9141) kd_loss 1.0769 (1.0232) lr 1.7705e-03 eta 0:28:07
epoch [13/50] batch [180/428] time 0.178 (0.106) data 0.000 (0.003) loss 1.5108 (1.6993) ce_loss 1.2363 (1.5134) teacher_loss 0.7817 (1.0547) loss_zs_kd 0.4604 (0.4012) loss_oracle 0.4990 (0.4440) acc 71.8750 (47.3438) kd_loss 0.9966 (1.0194) lr 1.7705e-03 eta 0:28:24
epoch [13/50] batch [200/428] time 0.154 (0.107) data 0.000 (0.003) loss 1.4963 (1.6969) ce_loss 1.4170 (1.5086) teacher_loss 0.7835 (1.0481) loss_zs_kd 0.4311 (0.4008) loss_oracle 0.4973 (0.4484) acc 50.0000 (47.2344) kd_loss 0.9805 (1.0143) lr 1.7705e-03 eta 0:28:34
epoch [13/50] batch [220/428] time 0.088 (0.107) data 0.000 (0.003) loss 1.7064 (1.6940) ce_loss 1.4619 (1.5058) teacher_loss 1.0130 (1.0446) loss_zs_kd 0.3895 (0.4004) loss_oracle 0.4987 (0.4492) acc 56.2500 (47.4148) kd_loss 1.0271 (1.0103) lr 1.7705e-03 eta 0:28:41
epoch [13/50] batch [240/428] time 0.076 (0.107) data 0.000 (0.003) loss 1.5219 (1.6885) ce_loss 1.2480 (1.4993) teacher_loss 0.7800 (1.0388) loss_zs_kd 0.4927 (0.3990) loss_oracle 0.4955 (0.4502) acc 59.3750 (47.4479) kd_loss 0.8898 (1.0062) lr 1.7705e-03 eta 0:28:31
epoch [13/50] batch [260/428] time 0.102 (0.106) data 0.000 (0.002) loss 1.7925 (1.6898) ce_loss 2.0527 (1.5014) teacher_loss 1.1736 (1.0394) loss_zs_kd 0.3250 (0.3991) loss_oracle 0.4565 (0.4509) acc 37.5000 (47.3558) kd_loss 1.0214 (1.0010) lr 1.7705e-03 eta 0:28:23
epoch [13/50] batch [280/428] time 0.115 (0.106) data 0.000 (0.002) loss 1.8281 (1.6890) ce_loss 1.7764 (1.5038) teacher_loss 1.1819 (1.0382) loss_zs_kd 0.3118 (0.3973) loss_oracle 0.4903 (0.4521) acc 37.5000 (47.2210) kd_loss 0.9409 (0.9955) lr 1.7705e-03 eta 0:28:19
epoch [13/50] batch [300/428] time 0.097 (0.106) data 0.000 (0.002) loss 1.7254 (1.6901) ce_loss 1.7578 (1.5055) teacher_loss 0.9454 (1.0368) loss_zs_kd 0.4470 (0.3971) loss_oracle 0.5565 (0.4547) acc 31.2500 (47.0104) kd_loss 0.9426 (0.9907) lr 1.7705e-03 eta 0:28:14
epoch [13/50] batch [320/428] time 0.103 (0.106) data 0.000 (0.002) loss 1.8497 (1.6870) ce_loss 1.3721 (1.5032) teacher_loss 1.1395 (1.0324) loss_zs_kd 0.4132 (0.3979) loss_oracle 0.5035 (0.4556) acc 53.1250 (47.0410) kd_loss 0.9085 (0.9855) lr 1.7705e-03 eta 0:28:10
epoch [13/50] batch [340/428] time 0.098 (0.106) data 0.000 (0.002) loss 1.6110 (1.6888) ce_loss 1.3018 (1.5057) teacher_loss 0.8788 (1.0323) loss_zs_kd 0.4354 (0.3991) loss_oracle 0.5146 (0.4569) acc 56.2500 (46.9301) kd_loss 0.8998 (0.9799) lr 1.7705e-03 eta 0:28:07
epoch [13/50] batch [360/428] time 0.100 (0.106) data 0.000 (0.002) loss 1.8075 (1.6890) ce_loss 1.7344 (1.5055) teacher_loss 1.0625 (1.0297) loss_zs_kd 0.3504 (0.3985) loss_oracle 0.5698 (0.4600) acc 40.6250 (46.8056) kd_loss 0.8721 (0.9742) lr 1.7705e-03 eta 0:28:03
epoch [13/50] batch [380/428] time 0.110 (0.106) data 0.000 (0.002) loss 1.8054 (1.6902) ce_loss 1.5488 (1.5058) teacher_loss 1.0069 (1.0281) loss_zs_kd 0.4116 (0.3992) loss_oracle 0.5927 (0.4624) acc 46.8750 (46.8092) kd_loss 0.8952 (0.9693) lr 1.7705e-03 eta 0:27:59
epoch [13/50] batch [400/428] time 0.114 (0.106) data 0.000 (0.002) loss 1.8574 (1.6868) ce_loss 1.6348 (1.5034) teacher_loss 1.1307 (1.0245) loss_zs_kd 0.3859 (0.3980) loss_oracle 0.5337 (0.4632) acc 43.7500 (46.8750) kd_loss 0.9088 (0.9636) lr 1.7705e-03 eta 0:27:56
epoch [13/50] batch [420/428] time 0.098 (0.106) data 0.000 (0.002) loss 1.7836 (1.6870) ce_loss 1.6318 (1.5037) teacher_loss 1.0701 (1.0222) loss_zs_kd 0.3461 (0.3982) loss_oracle 0.5404 (0.4658) acc 31.2500 (46.8527) kd_loss 0.8346 (0.9582) lr 1.7705e-03 eta 0:27:51
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,533
* accuracy: 43.1%
* error: 56.9%
* macro_f1: 31.8%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,731
* accuracy: 57.6%
* error: 42.4%
* macro_f1: 28.5%
******* Domain 1 best val acc:      49.7%, epoch: 4 *******
******* Domain 1 best val test acc: 50.7%, epoch: 4 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [14/50] batch [20/428] time 0.107 (0.129) data 0.000 (0.025) loss 1.8227 (1.7520) ce_loss 1.3311 (1.5618) teacher_loss 1.0444 (1.0197) loss_zs_kd 0.4304 (0.4088) loss_oracle 0.5630 (0.5278) acc 59.3750 (44.8438) kd_loss 0.8645 (0.8655) lr 1.7290e-03 eta 0:34:02
epoch [14/50] batch [40/428] time 0.077 (0.112) data 0.000 (0.013) loss 1.7950 (1.6893) ce_loss 1.6846 (1.4826) teacher_loss 1.1553 (0.9731) loss_zs_kd 0.4519 (0.3967) loss_oracle 0.4138 (0.5179) acc 40.6250 (47.5000) kd_loss 0.7774 (0.8710) lr 1.7290e-03 eta 0:29:36
epoch [14/50] batch [60/428] time 0.082 (0.104) data 0.000 (0.008) loss 1.5335 (1.6718) ce_loss 1.2852 (1.4751) teacher_loss 0.7425 (0.9577) loss_zs_kd 0.3699 (0.3949) loss_oracle 0.6060 (0.5166) acc 56.2500 (47.1875) kd_loss 0.8403 (0.8685) lr 1.7290e-03 eta 0:27:15
epoch [14/50] batch [80/428] time 0.084 (0.106) data 0.000 (0.006) loss 1.3617 (1.6689) ce_loss 0.9956 (1.4782) teacher_loss 0.6855 (0.9533) loss_zs_kd 0.3489 (0.4010) loss_oracle 0.5018 (0.5152) acc 75.0000 (47.5391) kd_loss 0.8443 (0.8705) lr 1.7290e-03 eta 0:27:47
epoch [14/50] batch [100/428] time 0.171 (0.109) data 0.000 (0.005) loss 1.7347 (1.6685) ce_loss 1.6445 (1.4765) teacher_loss 1.0111 (0.9480) loss_zs_kd 0.4055 (0.4090) loss_oracle 0.5208 (0.5161) acc 37.5000 (47.6562) kd_loss 0.9445 (0.8786) lr 1.7290e-03 eta 0:28:30
epoch [14/50] batch [120/428] time 0.091 (0.108) data 0.000 (0.004) loss 1.5565 (1.6659) ce_loss 1.2344 (1.4713) teacher_loss 0.7121 (0.9415) loss_zs_kd 0.4947 (0.4201) loss_oracle 0.5971 (0.5144) acc 46.8750 (47.7865) kd_loss 1.0541 (0.8875) lr 1.7290e-03 eta 0:28:14
epoch [14/50] batch [140/428] time 0.085 (0.106) data 0.000 (0.004) loss 1.5455 (1.6669) ce_loss 1.3340 (1.4681) teacher_loss 0.8435 (0.9471) loss_zs_kd 0.4561 (0.4200) loss_oracle 0.4740 (0.5098) acc 53.1250 (47.7009) kd_loss 0.8328 (0.8891) lr 1.7290e-03 eta 0:27:39
epoch [14/50] batch [160/428] time 0.086 (0.104) data 0.000 (0.003) loss 1.5280 (1.6653) ce_loss 1.2012 (1.4573) teacher_loss 0.8446 (0.9414) loss_zs_kd 0.4937 (0.4267) loss_oracle 0.4366 (0.5105) acc 56.2500 (47.9297) kd_loss 0.9209 (0.8949) lr 1.7290e-03 eta 0:27:15
epoch [14/50] batch [180/428] time 0.083 (0.105) data 0.000 (0.003) loss 1.8281 (1.6696) ce_loss 1.4209 (1.4543) teacher_loss 0.9679 (0.9424) loss_zs_kd 0.4563 (0.4335) loss_oracle 0.6321 (0.5105) acc 53.1250 (48.0208) kd_loss 1.0104 (0.9004) lr 1.7290e-03 eta 0:27:26
epoch [14/50] batch [200/428] time 0.154 (0.107) data 0.000 (0.003) loss 1.6615 (1.6805) ce_loss 1.5586 (1.4496) teacher_loss 0.8779 (0.9447) loss_zs_kd 0.4932 (0.4389) loss_oracle 0.5370 (0.5163) acc 34.3750 (48.2656) kd_loss 0.9488 (0.9067) lr 1.7290e-03 eta 0:27:46
epoch [14/50] batch [220/428] time 0.077 (0.107) data 0.000 (0.003) loss 1.7973 (1.6899) ce_loss 1.5059 (1.4508) teacher_loss 1.0120 (0.9493) loss_zs_kd 0.4781 (0.4433) loss_oracle 0.5462 (0.5190) acc 50.0000 (48.0966) kd_loss 0.8638 (0.9053) lr 1.7290e-03 eta 0:27:44
epoch [14/50] batch [240/428] time 0.077 (0.105) data 0.000 (0.002) loss 1.4512 (1.6924) ce_loss 1.1250 (1.4419) teacher_loss 0.7116 (0.9461) loss_zs_kd 0.4170 (0.4461) loss_oracle 0.5310 (0.5232) acc 59.3750 (48.3203) kd_loss 0.8810 (0.9059) lr 1.7290e-03 eta 0:27:10
epoch [14/50] batch [260/428] time 0.074 (0.102) data 0.000 (0.002) loss 1.6572 (1.6936) ce_loss 1.1094 (1.4379) teacher_loss 0.8636 (0.9436) loss_zs_kd 0.4415 (0.4475) loss_oracle 0.5729 (0.5262) acc 65.6250 (48.3293) kd_loss 0.9102 (0.9083) lr 1.7290e-03 eta 0:26:36
epoch [14/50] batch [280/428] time 0.081 (0.101) data 0.000 (0.002) loss 1.6045 (1.6912) ce_loss 1.3037 (1.4332) teacher_loss 0.8187 (0.9358) loss_zs_kd 0.4902 (0.4522) loss_oracle 0.5407 (0.5293) acc 56.2500 (48.3259) kd_loss 0.9130 (0.9111) lr 1.7290e-03 eta 0:26:06
epoch [14/50] batch [300/428] time 0.089 (0.099) data 0.000 (0.002) loss 1.8243 (1.6972) ce_loss 1.3398 (1.4332) teacher_loss 0.9466 (0.9363) loss_zs_kd 0.5497 (0.4541) loss_oracle 0.6028 (0.5338) acc 43.7500 (48.1771) kd_loss 0.9136 (0.9111) lr 1.7290e-03 eta 0:25:42
epoch [14/50] batch [320/428] time 0.074 (0.098) data 0.000 (0.002) loss 1.6252 (1.7017) ce_loss 1.1963 (1.4361) teacher_loss 0.7764 (0.9375) loss_zs_kd 0.4142 (0.4543) loss_oracle 0.6417 (0.5371) acc 59.3750 (47.9395) kd_loss 1.0065 (0.9112) lr 1.7290e-03 eta 0:25:17
epoch [14/50] batch [340/428] time 0.092 (0.097) data 0.000 (0.002) loss 1.5729 (1.7051) ce_loss 1.2500 (1.4325) teacher_loss 0.7625 (0.9344) loss_zs_kd 0.4475 (0.4581) loss_oracle 0.5867 (0.5417) acc 53.1250 (47.9412) kd_loss 0.9097 (0.9123) lr 1.7290e-03 eta 0:25:07
epoch [14/50] batch [360/428] time 0.088 (0.097) data 0.000 (0.002) loss 1.8258 (1.7086) ce_loss 1.4639 (1.4328) teacher_loss 1.0148 (0.9348) loss_zs_kd 0.4358 (0.4583) loss_oracle 0.5930 (0.5447) acc 50.0000 (47.8212) kd_loss 0.8887 (0.9113) lr 1.7290e-03 eta 0:25:05
epoch [14/50] batch [380/428] time 0.104 (0.097) data 0.000 (0.002) loss 1.9583 (1.7107) ce_loss 1.8350 (1.4314) teacher_loss 1.1476 (0.9329) loss_zs_kd 0.4631 (0.4594) loss_oracle 0.5791 (0.5481) acc 28.1250 (47.9112) kd_loss 0.8577 (0.9086) lr 1.7290e-03 eta 0:25:06
epoch [14/50] batch [400/428] time 0.102 (0.098) data 0.000 (0.002) loss 1.9318 (1.7126) ce_loss 1.4580 (1.4322) teacher_loss 1.0789 (0.9326) loss_zs_kd 0.4840 (0.4585) loss_oracle 0.6110 (0.5507) acc 50.0000 (47.7734) kd_loss 0.8602 (0.9074) lr 1.7290e-03 eta 0:25:09
epoch [14/50] batch [420/428] time 0.097 (0.098) data 0.000 (0.001) loss 1.9420 (1.7171) ce_loss 1.7666 (1.4361) teacher_loss 1.1492 (0.9338) loss_zs_kd 0.5374 (0.4597) loss_oracle 0.5240 (0.5534) acc 37.5000 (47.5670) kd_loss 0.7315 (0.9044) lr 1.7290e-03 eta 0:25:11
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,723
* accuracy: 46.3%
* error: 53.7%
* macro_f1: 35.3%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,674
* accuracy: 56.4%
* error: 43.6%
* macro_f1: 29.0%
******* Domain 1 best val acc:      49.7%, epoch: 4 *******
******* Domain 1 best val test acc: 50.7%, epoch: 4 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [15/50] batch [20/428] time 0.097 (0.129) data 0.000 (0.032) loss 1.5263 (1.7170) ce_loss 1.3564 (1.3915) teacher_loss 0.7125 (0.8693) loss_zs_kd 0.4337 (0.4659) loss_oracle 0.5970 (0.6148) acc 50.0000 (49.5312) kd_loss 0.8051 (0.8396) lr 1.6845e-03 eta 0:33:11
epoch [15/50] batch [40/428] time 0.100 (0.116) data 0.000 (0.016) loss 1.8265 (1.7150) ce_loss 1.2051 (1.4336) teacher_loss 0.9517 (0.8777) loss_zs_kd 0.5270 (0.4621) loss_oracle 0.6113 (0.6063) acc 62.5000 (47.5781) kd_loss 0.7636 (0.8438) lr 1.6845e-03 eta 0:29:46
epoch [15/50] batch [60/428] time 0.101 (0.112) data 0.001 (0.011) loss 1.8277 (1.7316) ce_loss 1.6621 (1.4585) teacher_loss 0.9653 (0.8980) loss_zs_kd 0.5423 (0.4623) loss_oracle 0.5913 (0.6025) acc 34.3750 (45.5729) kd_loss 0.8168 (0.8421) lr 1.6845e-03 eta 0:28:36
epoch [15/50] batch [80/428] time 0.107 (0.110) data 0.000 (0.008) loss 1.9353 (1.7290) ce_loss 1.6455 (1.4408) teacher_loss 1.0792 (0.8956) loss_zs_kd 0.4605 (0.4612) loss_oracle 0.6259 (0.6029) acc 40.6250 (46.7188) kd_loss 0.7834 (0.8369) lr 1.6845e-03 eta 0:28:09
epoch [15/50] batch [100/428] time 0.102 (0.109) data 0.000 (0.007) loss 1.9182 (1.7324) ce_loss 1.5479 (1.4388) teacher_loss 1.0385 (0.9000) loss_zs_kd 0.5532 (0.4627) loss_oracle 0.6031 (0.6010) acc 37.5000 (47.2500) kd_loss 0.8291 (0.8282) lr 1.6845e-03 eta 0:27:50
epoch [15/50] batch [120/428] time 0.099 (0.108) data 0.000 (0.006) loss 1.9268 (1.7336) ce_loss 1.4102 (1.4338) teacher_loss 1.1909 (0.9048) loss_zs_kd 0.3865 (0.4615) loss_oracle 0.5427 (0.5980) acc 37.5000 (47.4740) kd_loss 0.6958 (0.8215) lr 1.6845e-03 eta 0:27:33
epoch [15/50] batch [140/428] time 0.079 (0.107) data 0.000 (0.005) loss 1.8628 (1.7302) ce_loss 1.4863 (1.4364) teacher_loss 1.0059 (0.9071) loss_zs_kd 0.4697 (0.4568) loss_oracle 0.6221 (0.5947) acc 53.1250 (47.3661) kd_loss 0.7670 (0.8175) lr 1.6845e-03 eta 0:27:11
epoch [15/50] batch [160/428] time 0.092 (0.104) data 0.000 (0.004) loss 1.6983 (1.7317) ce_loss 1.4756 (1.4368) teacher_loss 0.8902 (0.9080) loss_zs_kd 0.4663 (0.4577) loss_oracle 0.5749 (0.5949) acc 53.1250 (47.5000) kd_loss 0.8236 (0.8140) lr 1.6845e-03 eta 0:26:26
epoch [15/50] batch [180/428] time 0.138 (0.107) data 0.000 (0.004) loss 1.7850 (1.7305) ce_loss 1.7461 (1.4360) teacher_loss 1.0439 (0.9100) loss_zs_kd 0.4683 (0.4568) loss_oracle 0.5069 (0.5920) acc 31.2500 (47.6389) kd_loss 0.7892 (0.8093) lr 1.6845e-03 eta 0:27:05
epoch [15/50] batch [200/428] time 0.168 (0.106) data 0.000 (0.004) loss 1.4146 (1.7248) ce_loss 1.2295 (1.4345) teacher_loss 0.6615 (0.9083) loss_zs_kd 0.4703 (0.4554) loss_oracle 0.5179 (0.5888) acc 56.2500 (47.7812) kd_loss 0.7863 (0.8074) lr 1.6845e-03 eta 0:26:59
epoch [15/50] batch [220/428] time 0.089 (0.107) data 0.000 (0.003) loss 1.8349 (1.7245) ce_loss 1.5205 (1.4336) teacher_loss 1.0554 (0.9095) loss_zs_kd 0.4599 (0.4565) loss_oracle 0.5496 (0.5867) acc 50.0000 (47.8835) kd_loss 0.7681 (0.8044) lr 1.6845e-03 eta 0:27:00
epoch [15/50] batch [240/428] time 0.067 (0.105) data 0.000 (0.003) loss 1.7149 (1.7212) ce_loss 1.6143 (1.4288) teacher_loss 0.8536 (0.9080) loss_zs_kd 0.4968 (0.4567) loss_oracle 0.6130 (0.5849) acc 37.5000 (48.1250) kd_loss 0.8095 (0.8013) lr 1.6845e-03 eta 0:26:36
epoch [15/50] batch [260/428] time 0.073 (0.104) data 0.000 (0.003) loss 1.7528 (1.7186) ce_loss 1.6084 (1.4250) teacher_loss 0.9393 (0.9062) loss_zs_kd 0.5274 (0.4562) loss_oracle 0.5498 (0.5844) acc 37.5000 (48.1731) kd_loss 0.7950 (0.7989) lr 1.6845e-03 eta 0:26:17
epoch [15/50] batch [280/428] time 0.082 (0.105) data 0.001 (0.003) loss 1.8469 (1.7161) ce_loss 1.4346 (1.4212) teacher_loss 1.0469 (0.9049) loss_zs_kd 0.4821 (0.4571) loss_oracle 0.5590 (0.5826) acc 56.2500 (48.4040) kd_loss 0.7620 (0.7972) lr 1.6845e-03 eta 0:26:24
epoch [15/50] batch [300/428] time 0.067 (0.105) data 0.000 (0.002) loss 1.6635 (1.7127) ce_loss 1.4980 (1.4180) teacher_loss 0.9673 (0.9030) loss_zs_kd 0.3808 (0.4572) loss_oracle 0.5058 (0.5810) acc 43.7500 (48.3438) kd_loss 0.7721 (0.7958) lr 1.6845e-03 eta 0:26:29
epoch [15/50] batch [320/428] time 0.085 (0.104) data 0.000 (0.002) loss 2.0385 (1.7140) ce_loss 1.7646 (1.4198) teacher_loss 1.2483 (0.9061) loss_zs_kd 0.4923 (0.4574) loss_oracle 0.5441 (0.5792) acc 37.5000 (48.1641) kd_loss 0.6474 (0.7928) lr 1.6845e-03 eta 0:26:14
epoch [15/50] batch [340/428] time 0.109 (0.104) data 0.000 (0.002) loss 1.6437 (1.7162) ce_loss 1.3096 (1.4220) teacher_loss 0.8962 (0.9088) loss_zs_kd 0.4305 (0.4589) loss_oracle 0.5322 (0.5780) acc 46.8750 (48.0607) kd_loss 0.7665 (0.7911) lr 1.6845e-03 eta 0:26:08
epoch [15/50] batch [360/428] time 0.104 (0.104) data 0.000 (0.002) loss 1.8248 (1.7164) ce_loss 1.5996 (1.4239) teacher_loss 1.0183 (0.9098) loss_zs_kd 0.4660 (0.4597) loss_oracle 0.5735 (0.5767) acc 40.6250 (47.9861) kd_loss 0.7623 (0.7890) lr 1.6845e-03 eta 0:26:02
epoch [15/50] batch [380/428] time 0.087 (0.104) data 0.000 (0.002) loss 1.7894 (1.7146) ce_loss 1.5498 (1.4222) teacher_loss 0.9875 (0.9091) loss_zs_kd 0.4764 (0.4600) loss_oracle 0.5637 (0.5755) acc 40.6250 (48.0181) kd_loss 0.8062 (0.7881) lr 1.6845e-03 eta 0:25:56
epoch [15/50] batch [400/428] time 0.090 (0.103) data 0.000 (0.002) loss 1.8427 (1.7132) ce_loss 1.5205 (1.4212) teacher_loss 1.0850 (0.9094) loss_zs_kd 0.4483 (0.4592) loss_oracle 0.5335 (0.5742) acc 43.7500 (48.0703) kd_loss 0.6887 (0.7859) lr 1.6845e-03 eta 0:25:52
epoch [15/50] batch [420/428] time 0.098 (0.103) data 0.000 (0.002) loss 1.6672 (1.7119) ce_loss 1.2471 (1.4197) teacher_loss 0.9800 (0.9107) loss_zs_kd 0.3767 (0.4573) loss_oracle 0.4989 (0.5726) acc 53.1250 (48.1176) kd_loss 0.7170 (0.7846) lr 1.6845e-03 eta 0:25:49
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,793
* accuracy: 47.5%
* error: 52.5%
* macro_f1: 33.4%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,501
* accuracy: 52.8%
* error: 47.2%
* macro_f1: 28.4%
******* Domain 1 best val acc:      49.7%, epoch: 4 *******
******* Domain 1 best val test acc: 50.7%, epoch: 4 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [16/50] batch [20/428] time 0.108 (0.127) data 0.000 (0.025) loss 1.9021 (1.7026) ce_loss 1.9902 (1.4193) teacher_loss 1.1618 (0.9370) loss_zs_kd 0.5004 (0.4579) loss_oracle 0.4901 (0.5367) acc 28.1250 (47.0312) kd_loss 0.7709 (0.7541) lr 1.6374e-03 eta 0:31:33
epoch [16/50] batch [40/428] time 0.103 (0.116) data 0.000 (0.013) loss 1.6485 (1.7038) ce_loss 1.4512 (1.4222) teacher_loss 0.8556 (0.9341) loss_zs_kd 0.4208 (0.4581) loss_oracle 0.5825 (0.5407) acc 43.7500 (47.1875) kd_loss 0.7422 (0.7459) lr 1.6374e-03 eta 0:28:50
epoch [16/50] batch [60/428] time 0.113 (0.112) data 0.001 (0.009) loss 1.8395 (1.7023) ce_loss 1.6445 (1.4341) teacher_loss 1.0591 (0.9291) loss_zs_kd 0.4830 (0.4597) loss_oracle 0.5389 (0.5434) acc 43.7500 (46.6146) kd_loss 0.7670 (0.7551) lr 1.6374e-03 eta 0:27:54
epoch [16/50] batch [80/428] time 0.104 (0.111) data 0.000 (0.007) loss 1.5312 (1.6929) ce_loss 1.3271 (1.4139) teacher_loss 0.7939 (0.9110) loss_zs_kd 0.4222 (0.4751) loss_oracle 0.5262 (0.5444) acc 46.8750 (47.6172) kd_loss 0.8311 (0.7619) lr 1.6374e-03 eta 0:27:28
epoch [16/50] batch [100/428] time 0.104 (0.110) data 0.000 (0.005) loss 1.9787 (1.6909) ce_loss 1.5693 (1.4079) teacher_loss 1.0950 (0.9084) loss_zs_kd 0.5578 (0.4724) loss_oracle 0.6047 (0.5463) acc 53.1250 (47.8125) kd_loss 0.7002 (0.7611) lr 1.6374e-03 eta 0:27:12
epoch [16/50] batch [120/428] time 0.097 (0.109) data 0.000 (0.004) loss 1.7297 (1.6922) ce_loss 1.3477 (1.4131) teacher_loss 0.9987 (0.9161) loss_zs_kd 0.4281 (0.4676) loss_oracle 0.5170 (0.5423) acc 50.0000 (47.5521) kd_loss 0.7879 (0.7597) lr 1.6374e-03 eta 0:26:59
epoch [16/50] batch [140/428] time 0.086 (0.108) data 0.000 (0.004) loss 1.4772 (1.6803) ce_loss 1.2598 (1.3988) teacher_loss 0.6937 (0.9074) loss_zs_kd 0.5541 (0.4679) loss_oracle 0.5065 (0.5390) acc 46.8750 (48.2589) kd_loss 0.6344 (0.7600) lr 1.6374e-03 eta 0:26:42
epoch [16/50] batch [160/428] time 0.102 (0.106) data 0.000 (0.003) loss 1.6401 (1.6782) ce_loss 1.2686 (1.3915) teacher_loss 0.9352 (0.9066) loss_zs_kd 0.4537 (0.4692) loss_oracle 0.4781 (0.5370) acc 53.1250 (48.6328) kd_loss 0.7455 (0.7574) lr 1.6374e-03 eta 0:26:07
epoch [16/50] batch [180/428] time 0.077 (0.106) data 0.000 (0.003) loss 1.5178 (1.6764) ce_loss 1.3594 (1.3923) teacher_loss 0.7059 (0.9045) loss_zs_kd 0.4950 (0.4677) loss_oracle 0.5645 (0.5381) acc 50.0000 (48.5243) kd_loss 0.7903 (0.7569) lr 1.6374e-03 eta 0:26:13
epoch [16/50] batch [200/428] time 0.076 (0.106) data 0.000 (0.003) loss 1.3571 (1.6821) ce_loss 1.0898 (1.4004) teacher_loss 0.5949 (0.9111) loss_zs_kd 0.4612 (0.4673) loss_oracle 0.5316 (0.5374) acc 56.2500 (48.1094) kd_loss 0.7696 (0.7558) lr 1.6374e-03 eta 0:26:12
epoch [16/50] batch [220/428] time 0.066 (0.106) data 0.000 (0.003) loss 1.5610 (1.6841) ce_loss 1.2920 (1.4011) teacher_loss 0.7969 (0.9142) loss_zs_kd 0.4417 (0.4651) loss_oracle 0.5433 (0.5374) acc 56.2500 (48.0824) kd_loss 0.7327 (0.7543) lr 1.6374e-03 eta 0:26:09
epoch [16/50] batch [240/428] time 0.076 (0.106) data 0.000 (0.002) loss 1.6628 (1.6820) ce_loss 1.3154 (1.3966) teacher_loss 0.9418 (0.9139) loss_zs_kd 0.4228 (0.4635) loss_oracle 0.5097 (0.5364) acc 46.8750 (48.3724) kd_loss 0.5873 (0.7522) lr 1.6374e-03 eta 0:25:55
epoch [16/50] batch [260/428] time 0.113 (0.104) data 0.000 (0.002) loss 1.8136 (1.6837) ce_loss 1.5518 (1.3969) teacher_loss 1.1269 (0.9168) loss_zs_kd 0.3818 (0.4625) loss_oracle 0.4958 (0.5356) acc 28.1250 (48.4375) kd_loss 0.7021 (0.7522) lr 1.6374e-03 eta 0:25:33
epoch [16/50] batch [280/428] time 0.164 (0.105) data 0.000 (0.002) loss 1.9034 (1.6861) ce_loss 1.7432 (1.3969) teacher_loss 1.1576 (0.9214) loss_zs_kd 0.4679 (0.4616) loss_oracle 0.5119 (0.5339) acc 28.1250 (48.4375) kd_loss 0.8428 (0.7509) lr 1.6374e-03 eta 0:25:40
epoch [16/50] batch [300/428] time 0.087 (0.105) data 0.000 (0.002) loss 1.7683 (1.6862) ce_loss 1.4023 (1.3931) teacher_loss 1.0961 (0.9236) loss_zs_kd 0.4234 (0.4615) loss_oracle 0.4605 (0.5318) acc 50.0000 (48.6250) kd_loss 0.7666 (0.7499) lr 1.6374e-03 eta 0:25:36
epoch [16/50] batch [320/428] time 0.072 (0.104) data 0.000 (0.002) loss 1.8345 (1.6884) ce_loss 1.4531 (1.3949) teacher_loss 1.0806 (0.9287) loss_zs_kd 0.4431 (0.4593) loss_oracle 0.5323 (0.5301) acc 46.8750 (48.6328) kd_loss 0.7259 (0.7508) lr 1.6374e-03 eta 0:25:31
epoch [16/50] batch [340/428] time 0.110 (0.104) data 0.000 (0.002) loss 1.7081 (1.6862) ce_loss 1.2168 (1.3929) teacher_loss 0.9651 (0.9278) loss_zs_kd 0.4644 (0.4578) loss_oracle 0.5108 (0.5295) acc 62.5000 (48.6029) kd_loss 0.6892 (0.7512) lr 1.6374e-03 eta 0:25:17
epoch [16/50] batch [360/428] time 0.096 (0.104) data 0.000 (0.002) loss 1.7965 (1.6878) ce_loss 1.4160 (1.3899) teacher_loss 1.0466 (0.9310) loss_zs_kd 0.4795 (0.4551) loss_oracle 0.5102 (0.5293) acc 56.2500 (48.8715) kd_loss 0.7596 (0.7510) lr 1.6374e-03 eta 0:25:15
epoch [16/50] batch [380/428] time 0.070 (0.104) data 0.000 (0.002) loss 1.6497 (1.6885) ce_loss 1.3818 (1.3903) teacher_loss 0.8574 (0.9327) loss_zs_kd 0.4578 (0.4541) loss_oracle 0.5633 (0.5287) acc 50.0000 (48.8158) kd_loss 0.8096 (0.7531) lr 1.6374e-03 eta 0:25:12
epoch [16/50] batch [400/428] time 0.087 (0.104) data 0.000 (0.002) loss 1.7442 (1.6887) ce_loss 1.3643 (1.3877) teacher_loss 0.9512 (0.9336) loss_zs_kd 0.4306 (0.4533) loss_oracle 0.5776 (0.5285) acc 50.0000 (48.9297) kd_loss 0.9024 (0.7547) lr 1.6374e-03 eta 0:25:10
epoch [16/50] batch [420/428] time 0.100 (0.104) data 0.000 (0.001) loss 1.7203 (1.6914) ce_loss 1.3203 (1.3887) teacher_loss 0.9110 (0.9367) loss_zs_kd 0.5407 (0.4525) loss_oracle 0.5389 (0.5284) acc 56.2500 (48.8988) kd_loss 0.8217 (0.7566) lr 1.6374e-03 eta 0:25:08
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,894
* accuracy: 49.3%
* error: 50.7%
* macro_f1: 37.4%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,706
* accuracy: 57.1%
* error: 42.9%
* macro_f1: 32.8%
******* Domain 1 best val acc:      49.7%, epoch: 4 *******
******* Domain 1 best val test acc: 50.7%, epoch: 4 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [17/50] batch [20/428] time 0.111 (0.130) data 0.000 (0.027) loss 1.5569 (1.6871) ce_loss 1.2773 (1.3269) teacher_loss 0.7822 (0.9388) loss_zs_kd 0.4825 (0.4427) loss_oracle 0.5334 (0.5270) acc 56.2500 (50.1562) kd_loss 0.8039 (0.7943) lr 1.5878e-03 eta 0:31:23
epoch [17/50] batch [40/428] time 0.099 (0.117) data 0.000 (0.014) loss 1.6221 (1.7074) ce_loss 1.2588 (1.3533) teacher_loss 0.9754 (0.9550) loss_zs_kd 0.4203 (0.4368) loss_oracle 0.4366 (0.5340) acc 56.2500 (49.5312) kd_loss 0.7129 (0.8012) lr 1.5878e-03 eta 0:28:14
epoch [17/50] batch [60/428] time 0.111 (0.113) data 0.001 (0.009) loss 1.7340 (1.6960) ce_loss 1.3389 (1.3491) teacher_loss 0.9493 (0.9450) loss_zs_kd 0.4119 (0.4263) loss_oracle 0.5787 (0.5378) acc 50.0000 (49.3750) kd_loss 0.8602 (0.8083) lr 1.5878e-03 eta 0:27:11
epoch [17/50] batch [80/428] time 0.106 (0.110) data 0.000 (0.007) loss 1.6594 (1.6950) ce_loss 1.3926 (1.3542) teacher_loss 1.0159 (0.9462) loss_zs_kd 0.3798 (0.4267) loss_oracle 0.4536 (0.5355) acc 43.7500 (49.6484) kd_loss 0.7267 (0.8032) lr 1.5878e-03 eta 0:26:35
epoch [17/50] batch [100/428] time 0.097 (0.109) data 0.000 (0.006) loss 1.5794 (1.6902) ce_loss 1.3193 (1.3542) teacher_loss 0.7847 (0.9404) loss_zs_kd 0.4777 (0.4303) loss_oracle 0.5558 (0.5346) acc 50.0000 (49.6875) kd_loss 0.8405 (0.8032) lr 1.5878e-03 eta 0:26:19
epoch [17/50] batch [120/428] time 0.104 (0.108) data 0.000 (0.005) loss 1.8095 (1.6916) ce_loss 1.5762 (1.3714) teacher_loss 1.0314 (0.9411) loss_zs_kd 0.4814 (0.4337) loss_oracle 0.5374 (0.5336) acc 34.3750 (49.2188) kd_loss 0.8672 (0.8042) lr 1.5878e-03 eta 0:26:02
epoch [17/50] batch [140/428] time 0.098 (0.108) data 0.000 (0.004) loss 1.6368 (1.6801) ce_loss 1.5557 (1.3699) teacher_loss 0.8344 (0.9316) loss_zs_kd 0.4943 (0.4317) loss_oracle 0.5553 (0.5326) acc 40.6250 (49.3750) kd_loss 0.8152 (0.8017) lr 1.5878e-03 eta 0:25:49
epoch [17/50] batch [160/428] time 0.112 (0.107) data 0.000 (0.004) loss 2.0227 (1.6821) ce_loss 1.7168 (1.3741) teacher_loss 1.2790 (0.9326) loss_zs_kd 0.5081 (0.4349) loss_oracle 0.4897 (0.5321) acc 34.3750 (49.2969) kd_loss 0.7297 (0.7996) lr 1.5878e-03 eta 0:25:33
epoch [17/50] batch [180/428] time 0.086 (0.104) data 0.000 (0.003) loss 1.6483 (1.6865) ce_loss 1.5850 (1.3840) teacher_loss 0.9023 (0.9332) loss_zs_kd 0.4100 (0.4390) loss_oracle 0.5410 (0.5338) acc 37.5000 (48.8194) kd_loss 0.8429 (0.7947) lr 1.5878e-03 eta 0:24:53
epoch [17/50] batch [200/428] time 0.147 (0.105) data 0.000 (0.003) loss 1.4235 (1.6835) ce_loss 1.1738 (1.3823) teacher_loss 0.6573 (0.9292) loss_zs_kd 0.4544 (0.4422) loss_oracle 0.5390 (0.5332) acc 59.3750 (48.7812) kd_loss 0.7168 (0.7890) lr 1.5878e-03 eta 0:25:04
epoch [17/50] batch [220/428] time 0.076 (0.106) data 0.000 (0.003) loss 1.7451 (1.6819) ce_loss 1.4463 (1.3830) teacher_loss 0.9332 (0.9251) loss_zs_kd 0.4592 (0.4428) loss_oracle 0.5823 (0.5354) acc 50.0000 (48.8352) kd_loss 0.8422 (0.7848) lr 1.5878e-03 eta 0:25:16
epoch [17/50] batch [240/428] time 0.189 (0.106) data 0.000 (0.003) loss 1.5958 (1.6823) ce_loss 1.2988 (1.3876) teacher_loss 0.8237 (0.9276) loss_zs_kd 0.4909 (0.4405) loss_oracle 0.5267 (0.5345) acc 56.2500 (48.6328) kd_loss 0.7642 (0.7809) lr 1.5878e-03 eta 0:25:17
epoch [17/50] batch [260/428] time 0.076 (0.106) data 0.000 (0.002) loss 1.7963 (1.6834) ce_loss 1.5029 (1.3932) teacher_loss 0.9919 (0.9291) loss_zs_kd 0.4530 (0.4396) loss_oracle 0.5779 (0.5345) acc 40.6250 (48.4255) kd_loss 0.7529 (0.7775) lr 1.5878e-03 eta 0:25:18
epoch [17/50] batch [280/428] time 0.171 (0.105) data 0.000 (0.002) loss 1.7021 (1.6850) ce_loss 1.4473 (1.3975) teacher_loss 0.9420 (0.9300) loss_zs_kd 0.4612 (0.4402) loss_oracle 0.5295 (0.5349) acc 40.6250 (48.2589) kd_loss 0.8062 (0.7748) lr 1.5878e-03 eta 0:25:00
epoch [17/50] batch [300/428] time 0.179 (0.106) data 0.000 (0.002) loss 1.6909 (1.6834) ce_loss 1.3564 (1.3976) teacher_loss 0.8075 (0.9281) loss_zs_kd 0.5520 (0.4406) loss_oracle 0.6074 (0.5350) acc 43.7500 (48.2500) kd_loss 0.7636 (0.7719) lr 1.5878e-03 eta 0:25:04
epoch [17/50] batch [320/428] time 0.072 (0.106) data 0.000 (0.002) loss 1.8396 (1.6796) ce_loss 1.6279 (1.3929) teacher_loss 1.0976 (0.9248) loss_zs_kd 0.4439 (0.4409) loss_oracle 0.5200 (0.5344) acc 43.7500 (48.5449) kd_loss 0.6815 (0.7683) lr 1.5878e-03 eta 0:25:01
epoch [17/50] batch [340/428] time 0.068 (0.106) data 0.000 (0.002) loss 1.5072 (1.6807) ce_loss 1.1729 (1.3932) teacher_loss 0.7728 (0.9273) loss_zs_kd 0.4247 (0.4394) loss_oracle 0.5221 (0.5338) acc 62.5000 (48.4007) kd_loss 0.7266 (0.7637) lr 1.5878e-03 eta 0:25:00
epoch [17/50] batch [360/428] time 0.081 (0.105) data 0.000 (0.002) loss 1.7508 (1.6835) ce_loss 1.3027 (1.3954) teacher_loss 1.0360 (0.9304) loss_zs_kd 0.3955 (0.4391) loss_oracle 0.5170 (0.5336) acc 53.1250 (48.3681) kd_loss 0.6608 (0.7611) lr 1.5878e-03 eta 0:24:50
epoch [17/50] batch [380/428] time 0.105 (0.105) data 0.000 (0.002) loss 1.5760 (1.6826) ce_loss 1.2119 (1.3958) teacher_loss 0.8199 (0.9298) loss_zs_kd 0.4413 (0.4382) loss_oracle 0.5355 (0.5337) acc 56.2500 (48.4046) kd_loss 0.7582 (0.7593) lr 1.5878e-03 eta 0:24:46
epoch [17/50] batch [400/428] time 0.103 (0.105) data 0.000 (0.002) loss 1.6903 (1.6846) ce_loss 1.4121 (1.3957) teacher_loss 0.9392 (0.9319) loss_zs_kd 0.4325 (0.4374) loss_oracle 0.5349 (0.5340) acc 56.2500 (48.5078) kd_loss 0.7914 (0.7564) lr 1.5878e-03 eta 0:24:42
epoch [17/50] batch [420/428] time 0.096 (0.105) data 0.000 (0.002) loss 1.6488 (1.6862) ce_loss 1.1709 (1.3977) teacher_loss 0.7902 (0.9335) loss_zs_kd 0.4494 (0.4373) loss_oracle 0.6339 (0.5341) acc 59.3750 (48.4821) kd_loss 0.8274 (0.7547) lr 1.5878e-03 eta 0:24:37
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,913
* accuracy: 49.6%
* error: 50.4%
* macro_f1: 36.9%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,621
* accuracy: 55.3%
* error: 44.7%
* macro_f1: 29.8%
******* Domain 1 best val acc:      49.7%, epoch: 4 *******
******* Domain 1 best val test acc: 50.7%, epoch: 4 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [18/50] batch [20/428] time 0.107 (0.136) data 0.000 (0.027) loss 1.5796 (1.5911) ce_loss 1.3037 (1.2998) teacher_loss 0.8746 (0.8198) loss_zs_kd 0.3539 (0.4488) loss_oracle 0.5281 (0.5470) acc 53.1250 (52.5000) kd_loss 0.6691 (0.7003) lr 1.5358e-03 eta 0:32:01
epoch [18/50] batch [40/428] time 0.098 (0.120) data 0.000 (0.013) loss 1.5459 (1.6358) ce_loss 1.1523 (1.3536) teacher_loss 0.8042 (0.8780) loss_zs_kd 0.4281 (0.4379) loss_oracle 0.5277 (0.5388) acc 56.2500 (50.6250) kd_loss 0.7219 (0.7108) lr 1.5358e-03 eta 0:28:07
epoch [18/50] batch [60/428] time 0.102 (0.114) data 0.001 (0.009) loss 1.8842 (1.6421) ce_loss 1.7988 (1.3544) teacher_loss 1.1512 (0.8858) loss_zs_kd 0.4657 (0.4419) loss_oracle 0.5001 (0.5353) acc 43.7500 (50.9375) kd_loss 0.7144 (0.7076) lr 1.5358e-03 eta 0:26:48
epoch [18/50] batch [80/428] time 0.092 (0.112) data 0.000 (0.007) loss 1.8837 (1.6595) ce_loss 1.8311 (1.3732) teacher_loss 1.1990 (0.9041) loss_zs_kd 0.3895 (0.4422) loss_oracle 0.4900 (0.5343) acc 43.7500 (50.0000) kd_loss 0.7330 (0.7112) lr 1.5358e-03 eta 0:26:13
epoch [18/50] batch [100/428] time 0.095 (0.111) data 0.000 (0.006) loss 1.2922 (1.6593) ce_loss 1.0283 (1.3768) teacher_loss 0.5891 (0.9102) loss_zs_kd 0.3896 (0.4351) loss_oracle 0.5083 (0.5315) acc 62.5000 (49.4688) kd_loss 0.7233 (0.7103) lr 1.5358e-03 eta 0:25:51
epoch [18/50] batch [120/428] time 0.116 (0.110) data 0.000 (0.005) loss 1.6301 (1.6586) ce_loss 1.4160 (1.3732) teacher_loss 0.9392 (0.9142) loss_zs_kd 0.3838 (0.4313) loss_oracle 0.4990 (0.5287) acc 46.8750 (49.8698) kd_loss 0.6935 (0.7097) lr 1.5358e-03 eta 0:25:36
epoch [18/50] batch [140/428] time 0.096 (0.109) data 0.001 (0.004) loss 1.4281 (1.6599) ce_loss 1.1475 (1.3756) teacher_loss 0.7620 (0.9158) loss_zs_kd 0.3902 (0.4303) loss_oracle 0.4710 (0.5289) acc 56.2500 (49.8884) kd_loss 0.7837 (0.7125) lr 1.5358e-03 eta 0:25:21
epoch [18/50] batch [160/428] time 0.095 (0.108) data 0.000 (0.004) loss 1.5790 (1.6596) ce_loss 1.4111 (1.3735) teacher_loss 0.8439 (0.9156) loss_zs_kd 0.4000 (0.4309) loss_oracle 0.5351 (0.5286) acc 50.0000 (50.2344) kd_loss 0.7451 (0.7111) lr 1.5358e-03 eta 0:25:12
epoch [18/50] batch [180/428] time 0.083 (0.107) data 0.000 (0.003) loss 1.7438 (1.6598) ce_loss 1.5098 (1.3725) teacher_loss 1.0185 (0.9141) loss_zs_kd 0.3845 (0.4309) loss_oracle 0.5330 (0.5302) acc 46.8750 (50.2951) kd_loss 0.6874 (0.7140) lr 1.5358e-03 eta 0:24:50
epoch [18/50] batch [200/428] time 0.091 (0.106) data 0.000 (0.003) loss 1.4821 (1.6532) ce_loss 1.1514 (1.3709) teacher_loss 0.7483 (0.9094) loss_zs_kd 0.3913 (0.4282) loss_oracle 0.5382 (0.5297) acc 59.3750 (50.3125) kd_loss 0.6484 (0.7166) lr 1.5358e-03 eta 0:24:40
epoch [18/50] batch [220/428] time 0.068 (0.105) data 0.000 (0.003) loss 1.8494 (1.6563) ce_loss 1.5078 (1.3745) teacher_loss 1.0299 (0.9102) loss_zs_kd 0.4712 (0.4318) loss_oracle 0.5839 (0.5302) acc 46.8750 (50.2699) kd_loss 0.7632 (0.7175) lr 1.5358e-03 eta 0:24:20
epoch [18/50] batch [240/428] time 0.064 (0.104) data 0.000 (0.002) loss 1.5159 (1.6603) ce_loss 1.3271 (1.3813) teacher_loss 0.7712 (0.9150) loss_zs_kd 0.3799 (0.4316) loss_oracle 0.5547 (0.5295) acc 56.2500 (49.9740) kd_loss 0.7620 (0.7161) lr 1.5358e-03 eta 0:24:02
epoch [18/50] batch [260/428] time 0.114 (0.103) data 0.000 (0.002) loss 2.0229 (1.6591) ce_loss 1.8242 (1.3821) teacher_loss 1.2497 (0.9131) loss_zs_kd 0.4193 (0.4305) loss_oracle 0.5636 (0.5307) acc 37.5000 (49.9399) kd_loss 0.6930 (0.7178) lr 1.5358e-03 eta 0:23:46
epoch [18/50] batch [280/428] time 0.127 (0.103) data 0.000 (0.002) loss 1.5352 (1.6528) ce_loss 1.3652 (1.3821) teacher_loss 0.7282 (0.9064) loss_zs_kd 0.4563 (0.4304) loss_oracle 0.5789 (0.5312) acc 53.1250 (49.9330) kd_loss 0.7916 (0.7203) lr 1.5358e-03 eta 0:23:49
epoch [18/50] batch [300/428] time 0.087 (0.103) data 0.000 (0.002) loss 1.5539 (1.6547) ce_loss 1.2412 (1.3845) teacher_loss 0.8428 (0.9073) loss_zs_kd 0.4670 (0.4322) loss_oracle 0.4777 (0.5313) acc 50.0000 (49.7292) kd_loss 0.7235 (0.7207) lr 1.5358e-03 eta 0:23:45
epoch [18/50] batch [320/428] time 0.072 (0.103) data 0.000 (0.002) loss 1.6592 (1.6556) ce_loss 1.3896 (1.3860) teacher_loss 0.9675 (0.9070) loss_zs_kd 0.3884 (0.4340) loss_oracle 0.4974 (0.5316) acc 56.2500 (49.5801) kd_loss 0.6434 (0.7220) lr 1.5358e-03 eta 0:23:38
epoch [18/50] batch [340/428] time 0.094 (0.103) data 0.000 (0.002) loss 1.5063 (1.6561) ce_loss 1.2295 (1.3858) teacher_loss 0.8249 (0.9076) loss_zs_kd 0.4073 (0.4353) loss_oracle 0.4777 (0.5308) acc 53.1250 (49.5312) kd_loss 0.6982 (0.7210) lr 1.5358e-03 eta 0:23:40
epoch [18/50] batch [360/428] time 0.081 (0.104) data 0.000 (0.002) loss 1.5186 (1.6538) ce_loss 1.4092 (1.3846) teacher_loss 0.8325 (0.9064) loss_zs_kd 0.3857 (0.4348) loss_oracle 0.4932 (0.5300) acc 50.0000 (49.6354) kd_loss 0.7976 (0.7230) lr 1.5358e-03 eta 0:23:48
epoch [18/50] batch [380/428] time 0.082 (0.104) data 0.000 (0.002) loss 1.7506 (1.6534) ce_loss 1.6133 (1.3858) teacher_loss 1.0299 (0.9054) loss_zs_kd 0.4068 (0.4357) loss_oracle 0.5172 (0.5302) acc 34.3750 (49.6464) kd_loss 0.7934 (0.7259) lr 1.5358e-03 eta 0:23:45
epoch [18/50] batch [400/428] time 0.101 (0.104) data 0.000 (0.002) loss 1.5108 (1.6528) ce_loss 1.2461 (1.3859) teacher_loss 0.7365 (0.9056) loss_zs_kd 0.3902 (0.4354) loss_oracle 0.5792 (0.5295) acc 53.1250 (49.5391) kd_loss 0.7611 (0.7267) lr 1.5358e-03 eta 0:23:44
epoch [18/50] batch [420/428] time 0.100 (0.104) data 0.001 (0.002) loss 1.6853 (1.6513) ce_loss 1.5771 (1.3857) teacher_loss 0.9892 (0.9050) loss_zs_kd 0.3993 (0.4346) loss_oracle 0.4964 (0.5290) acc 43.7500 (49.6949) kd_loss 0.7898 (0.7284) lr 1.5358e-03 eta 0:23:40
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,901
* accuracy: 49.4%
* error: 50.6%
* macro_f1: 37.1%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,697
* accuracy: 56.9%
* error: 43.1%
* macro_f1: 31.7%
******* Domain 1 best val acc:      49.7%, epoch: 4 *******
******* Domain 1 best val test acc: 50.7%, epoch: 4 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [19/50] batch [20/428] time 0.098 (0.134) data 0.000 (0.027) loss 1.5144 (1.6639) ce_loss 1.2324 (1.3738) teacher_loss 0.7032 (0.9079) loss_zs_kd 0.4834 (0.4525) loss_oracle 0.5695 (0.5297) acc 62.5000 (50.6250) kd_loss 0.8167 (0.7497) lr 1.4818e-03 eta 0:30:31
epoch [19/50] batch [40/428] time 0.104 (0.120) data 0.000 (0.014) loss 1.5306 (1.6874) ce_loss 1.3174 (1.4076) teacher_loss 0.8191 (0.9295) loss_zs_kd 0.3848 (0.4498) loss_oracle 0.5192 (0.5330) acc 50.0000 (48.3594) kd_loss 0.6713 (0.7559) lr 1.4818e-03 eta 0:27:19
epoch [19/50] batch [60/428] time 0.104 (0.115) data 0.001 (0.009) loss 1.5967 (1.6976) ce_loss 1.3174 (1.4183) teacher_loss 0.9289 (0.9440) loss_zs_kd 0.3972 (0.4518) loss_oracle 0.4692 (0.5277) acc 50.0000 (47.5521) kd_loss 0.6710 (0.7531) lr 1.4818e-03 eta 0:26:12
epoch [19/50] batch [80/428] time 0.099 (0.113) data 0.000 (0.007) loss 1.5800 (1.6771) ce_loss 1.2969 (1.3939) teacher_loss 0.8298 (0.9239) loss_zs_kd 0.4453 (0.4519) loss_oracle 0.5276 (0.5272) acc 50.0000 (48.3984) kd_loss 0.7009 (0.7534) lr 1.4818e-03 eta 0:25:34
epoch [19/50] batch [100/428] time 0.107 (0.111) data 0.000 (0.006) loss 1.7499 (1.6779) ce_loss 1.2686 (1.3938) teacher_loss 1.0498 (0.9213) loss_zs_kd 0.4466 (0.4523) loss_oracle 0.4768 (0.5305) acc 53.1250 (48.3438) kd_loss 0.6938 (0.7560) lr 1.4818e-03 eta 0:25:12
epoch [19/50] batch [120/428] time 0.094 (0.110) data 0.000 (0.005) loss 1.6518 (1.6673) ce_loss 1.4150 (1.3815) teacher_loss 0.8164 (0.9122) loss_zs_kd 0.5373 (0.4518) loss_oracle 0.5667 (0.5292) acc 43.7500 (48.9062) kd_loss 0.7676 (0.7536) lr 1.4818e-03 eta 0:24:53
epoch [19/50] batch [140/428] time 0.106 (0.109) data 0.000 (0.004) loss 1.5305 (1.6660) ce_loss 1.0615 (1.3793) teacher_loss 0.8125 (0.9127) loss_zs_kd 0.4369 (0.4526) loss_oracle 0.4995 (0.5270) acc 68.7500 (49.5312) kd_loss 0.6699 (0.7491) lr 1.4818e-03 eta 0:24:41
epoch [19/50] batch [160/428] time 0.100 (0.109) data 0.000 (0.004) loss 1.7818 (1.6621) ce_loss 1.6367 (1.3829) teacher_loss 1.0305 (0.9122) loss_zs_kd 0.4360 (0.4491) loss_oracle 0.5333 (0.5253) acc 37.5000 (49.4141) kd_loss 0.8909 (0.7494) lr 1.4818e-03 eta 0:24:32
epoch [19/50] batch [180/428] time 0.101 (0.108) data 0.000 (0.003) loss 1.4748 (1.6581) ce_loss 1.1631 (1.3791) teacher_loss 0.7831 (0.9097) loss_zs_kd 0.4246 (0.4495) loss_oracle 0.4794 (0.5236) acc 53.1250 (49.1840) kd_loss 0.6257 (0.7501) lr 1.4818e-03 eta 0:24:23
epoch [19/50] batch [200/428] time 0.099 (0.108) data 0.000 (0.003) loss 1.5152 (1.6609) ce_loss 1.1357 (1.3783) teacher_loss 0.7617 (0.9149) loss_zs_kd 0.4601 (0.4486) loss_oracle 0.5234 (0.5217) acc 56.2500 (49.4062) kd_loss 0.7638 (0.7498) lr 1.4818e-03 eta 0:24:15
epoch [19/50] batch [220/428] time 0.086 (0.106) data 0.000 (0.003) loss 1.5040 (1.6660) ce_loss 1.2227 (1.3823) teacher_loss 0.7732 (0.9220) loss_zs_kd 0.4192 (0.4462) loss_oracle 0.5212 (0.5209) acc 53.1250 (49.3324) kd_loss 0.6529 (0.7462) lr 1.4818e-03 eta 0:23:50
epoch [19/50] batch [240/428] time 0.073 (0.106) data 0.000 (0.002) loss 1.5936 (1.6621) ce_loss 1.2344 (1.3773) teacher_loss 0.8995 (0.9189) loss_zs_kd 0.4287 (0.4465) loss_oracle 0.4798 (0.5200) acc 53.1250 (49.3490) kd_loss 0.7106 (0.7443) lr 1.4818e-03 eta 0:23:40
epoch [19/50] batch [260/428] time 0.076 (0.106) data 0.000 (0.002) loss 1.7533 (1.6603) ce_loss 1.5908 (1.3746) teacher_loss 1.0161 (0.9188) loss_zs_kd 0.4630 (0.4468) loss_oracle 0.5057 (0.5181) acc 37.5000 (49.4952) kd_loss 0.7083 (0.7419) lr 1.4818e-03 eta 0:23:45
epoch [19/50] batch [280/428] time 0.174 (0.106) data 0.000 (0.002) loss 1.7076 (1.6589) ce_loss 1.4756 (1.3747) teacher_loss 0.9698 (0.9162) loss_zs_kd 0.4984 (0.4484) loss_oracle 0.4887 (0.5184) acc 40.6250 (49.3192) kd_loss 0.7573 (0.7429) lr 1.4818e-03 eta 0:23:48
epoch [19/50] batch [300/428] time 0.080 (0.107) data 0.000 (0.002) loss 1.2756 (1.6591) ce_loss 1.2217 (1.3761) teacher_loss 0.5797 (0.9170) loss_zs_kd 0.4382 (0.4493) loss_oracle 0.4768 (0.5175) acc 56.2500 (49.4062) kd_loss 0.7457 (0.7403) lr 1.4818e-03 eta 0:23:53
epoch [19/50] batch [320/428] time 0.077 (0.106) data 0.000 (0.002) loss 1.5888 (1.6594) ce_loss 1.3184 (1.3763) teacher_loss 0.8587 (0.9184) loss_zs_kd 0.4471 (0.4501) loss_oracle 0.5066 (0.5160) acc 56.2500 (49.3848) kd_loss 0.8209 (0.7384) lr 1.4818e-03 eta 0:23:36
epoch [19/50] batch [340/428] time 0.169 (0.106) data 0.000 (0.002) loss 1.9303 (1.6569) ce_loss 1.6504 (1.3750) teacher_loss 1.0722 (0.9154) loss_zs_kd 0.5210 (0.4514) loss_oracle 0.5976 (0.5157) acc 34.3750 (49.4853) kd_loss 0.7506 (0.7401) lr 1.4818e-03 eta 0:23:40
epoch [19/50] batch [360/428] time 0.162 (0.107) data 0.000 (0.002) loss 1.5937 (1.6566) ce_loss 1.3086 (1.3760) teacher_loss 0.8856 (0.9142) loss_zs_kd 0.4328 (0.4536) loss_oracle 0.4917 (0.5157) acc 43.7500 (49.4531) kd_loss 0.7635 (0.7410) lr 1.4818e-03 eta 0:23:42
epoch [19/50] batch [380/428] time 0.173 (0.107) data 0.000 (0.002) loss 1.7794 (1.6558) ce_loss 1.4736 (1.3755) teacher_loss 0.9821 (0.9130) loss_zs_kd 0.5547 (0.4553) loss_oracle 0.5199 (0.5152) acc 40.6250 (49.3832) kd_loss 0.8338 (0.7424) lr 1.4818e-03 eta 0:23:43
epoch [19/50] batch [400/428] time 0.101 (0.107) data 0.000 (0.002) loss 1.4475 (1.6546) ce_loss 1.2861 (1.3747) teacher_loss 0.7615 (0.9122) loss_zs_kd 0.4218 (0.4555) loss_oracle 0.4751 (0.5147) acc 53.1250 (49.4531) kd_loss 0.8527 (0.7450) lr 1.4818e-03 eta 0:23:36
epoch [19/50] batch [420/428] time 0.098 (0.106) data 0.000 (0.002) loss 1.6056 (1.6529) ce_loss 1.3350 (1.3737) teacher_loss 0.9417 (0.9106) loss_zs_kd 0.4742 (0.4568) loss_oracle 0.4267 (0.5140) acc 43.7500 (49.5164) kd_loss 0.6972 (0.7464) lr 1.4818e-03 eta 0:23:32
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,794
* accuracy: 47.5%
* error: 52.5%
* macro_f1: 36.1%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,744
* accuracy: 57.9%
* error: 42.1%
* macro_f1: 32.0%
******* Domain 1 best val acc:      49.7%, epoch: 4 *******
******* Domain 1 best val test acc: 50.7%, epoch: 4 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [20/50] batch [20/428] time 0.112 (0.130) data 0.000 (0.026) loss 1.4659 (1.5994) ce_loss 1.1748 (1.3411) teacher_loss 0.8152 (0.8523) loss_zs_kd 0.4327 (0.4645) loss_oracle 0.4343 (0.5148) acc 56.2500 (52.3438) kd_loss 0.6409 (0.7793) lr 1.4258e-03 eta 0:28:47
epoch [20/50] batch [40/428] time 0.105 (0.118) data 0.000 (0.013) loss 1.6393 (1.5870) ce_loss 1.4219 (1.3533) teacher_loss 0.7677 (0.8394) loss_zs_kd 0.5545 (0.4708) loss_oracle 0.5943 (0.5123) acc 46.8750 (50.1562) kd_loss 0.9582 (0.7845) lr 1.4258e-03 eta 0:26:01
epoch [20/50] batch [60/428] time 0.111 (0.114) data 0.001 (0.009) loss 1.3539 (1.5851) ce_loss 1.0420 (1.3518) teacher_loss 0.6148 (0.8316) loss_zs_kd 0.4779 (0.4867) loss_oracle 0.5002 (0.5101) acc 65.6250 (49.5312) kd_loss 0.6482 (0.7773) lr 1.4258e-03 eta 0:25:07
epoch [20/50] batch [80/428] time 0.091 (0.112) data 0.000 (0.007) loss 1.8548 (1.5938) ce_loss 1.3838 (1.3514) teacher_loss 1.0898 (0.8372) loss_zs_kd 0.5058 (0.4923) loss_oracle 0.5121 (0.5105) acc 40.6250 (50.0000) kd_loss 0.7404 (0.7776) lr 1.4258e-03 eta 0:24:38
epoch [20/50] batch [100/428] time 0.102 (0.111) data 0.000 (0.006) loss 1.6845 (1.5950) ce_loss 1.4766 (1.3664) teacher_loss 0.8742 (0.8371) loss_zs_kd 0.5652 (0.4932) loss_oracle 0.5277 (0.5114) acc 46.8750 (49.6562) kd_loss 0.8094 (0.7852) lr 1.4258e-03 eta 0:24:17
epoch [20/50] batch [120/428] time 0.115 (0.110) data 0.000 (0.005) loss 1.4780 (1.5907) ce_loss 1.1436 (1.3685) teacher_loss 0.6834 (0.8309) loss_zs_kd 0.4783 (0.4929) loss_oracle 0.5554 (0.5134) acc 59.3750 (49.6354) kd_loss 0.8289 (0.7871) lr 1.4258e-03 eta 0:24:04
epoch [20/50] batch [140/428] time 0.103 (0.109) data 0.000 (0.004) loss 1.7251 (1.5936) ce_loss 1.3018 (1.3758) teacher_loss 0.8403 (0.8295) loss_zs_kd 0.6367 (0.4961) loss_oracle 0.5664 (0.5160) acc 56.2500 (49.3080) kd_loss 0.7136 (0.7881) lr 1.4258e-03 eta 0:23:53
epoch [20/50] batch [160/428] time 0.106 (0.109) data 0.000 (0.004) loss 1.5462 (1.5891) ce_loss 1.4463 (1.3666) teacher_loss 0.8031 (0.8234) loss_zs_kd 0.4985 (0.4988) loss_oracle 0.4939 (0.5163) acc 46.8750 (49.5703) kd_loss 0.7507 (0.7839) lr 1.4258e-03 eta 0:23:46
epoch [20/50] batch [180/428] time 0.110 (0.108) data 0.000 (0.003) loss 1.7817 (1.5954) ce_loss 1.5518 (1.3764) teacher_loss 1.0216 (0.8326) loss_zs_kd 0.5357 (0.4956) loss_oracle 0.4922 (0.5150) acc 31.2500 (49.2361) kd_loss 0.7254 (0.7814) lr 1.4258e-03 eta 0:23:37
epoch [20/50] batch [200/428] time 0.116 (0.108) data 0.000 (0.003) loss 1.5643 (1.5972) ce_loss 1.3506 (1.3766) teacher_loss 0.8756 (0.8359) loss_zs_kd 0.3683 (0.4930) loss_oracle 0.5046 (0.5147) acc 43.7500 (49.2031) kd_loss 0.7270 (0.7776) lr 1.4258e-03 eta 0:23:33
epoch [20/50] batch [220/428] time 0.080 (0.107) data 0.000 (0.003) loss 1.5767 (1.5969) ce_loss 1.3096 (1.3777) teacher_loss 0.8398 (0.8369) loss_zs_kd 0.4980 (0.4935) loss_oracle 0.4879 (0.5132) acc 50.0000 (49.2472) kd_loss 0.7183 (0.7739) lr 1.4258e-03 eta 0:23:21
epoch [20/50] batch [240/428] time 0.173 (0.106) data 0.000 (0.002) loss 1.9537 (1.6030) ce_loss 1.6699 (1.3820) teacher_loss 1.2398 (0.8465) loss_zs_kd 0.4586 (0.4887) loss_oracle 0.4846 (0.5121) acc 28.1250 (49.1146) kd_loss 0.6109 (0.7700) lr 1.4258e-03 eta 0:23:03
epoch [20/50] batch [260/428] time 0.078 (0.106) data 0.000 (0.002) loss 1.9252 (1.6049) ce_loss 1.6221 (1.3839) teacher_loss 1.2223 (0.8488) loss_zs_kd 0.4856 (0.4888) loss_oracle 0.4601 (0.5117) acc 46.8750 (48.9303) kd_loss 0.6502 (0.7668) lr 1.4258e-03 eta 0:23:00
epoch [20/50] batch [280/428] time 0.174 (0.106) data 0.000 (0.002) loss 1.5357 (1.6040) ce_loss 1.3613 (1.3819) teacher_loss 0.8533 (0.8480) loss_zs_kd 0.4088 (0.4890) loss_oracle 0.4780 (0.5115) acc 50.0000 (48.9509) kd_loss 0.7567 (0.7657) lr 1.4258e-03 eta 0:23:01
epoch [20/50] batch [300/428] time 0.164 (0.107) data 0.000 (0.002) loss 1.6655 (1.6059) ce_loss 1.4922 (1.3833) teacher_loss 0.8803 (0.8512) loss_zs_kd 0.5181 (0.4880) loss_oracle 0.5262 (0.5107) acc 50.0000 (49.0208) kd_loss 0.8536 (0.7637) lr 1.4258e-03 eta 0:23:08
epoch [20/50] batch [320/428] time 0.080 (0.107) data 0.000 (0.002) loss 1.5731 (1.6068) ce_loss 1.1982 (1.3849) teacher_loss 0.8385 (0.8544) loss_zs_kd 0.4642 (0.4853) loss_oracle 0.5025 (0.5097) acc 56.2500 (48.9746) kd_loss 0.7029 (0.7619) lr 1.4258e-03 eta 0:23:03
epoch [20/50] batch [340/428] time 0.084 (0.106) data 0.000 (0.002) loss 1.5867 (1.6042) ce_loss 1.4326 (1.3849) teacher_loss 0.8314 (0.8541) loss_zs_kd 0.4585 (0.4825) loss_oracle 0.5261 (0.5089) acc 40.6250 (48.9798) kd_loss 0.8102 (0.7619) lr 1.4258e-03 eta 0:22:45
epoch [20/50] batch [360/428] time 0.150 (0.106) data 0.000 (0.002) loss 1.5246 (1.6039) ce_loss 1.4570 (1.3859) teacher_loss 0.8791 (0.8546) loss_zs_kd 0.4053 (0.4820) loss_oracle 0.4429 (0.5083) acc 43.7500 (49.0017) kd_loss 0.7164 (0.7613) lr 1.4258e-03 eta 0:22:52
epoch [20/50] batch [380/428] time 0.146 (0.107) data 0.000 (0.002) loss 1.4231 (1.6051) ce_loss 1.3398 (1.3896) teacher_loss 0.6912 (0.8560) loss_zs_kd 0.4737 (0.4824) loss_oracle 0.4951 (0.5079) acc 50.0000 (48.8158) kd_loss 0.7215 (0.7602) lr 1.4258e-03 eta 0:22:56
epoch [20/50] batch [400/428] time 0.103 (0.107) data 0.000 (0.002) loss 1.4155 (1.6078) ce_loss 1.1943 (1.3887) teacher_loss 0.7443 (0.8595) loss_zs_kd 0.4231 (0.4813) loss_oracle 0.4596 (0.5077) acc 50.0000 (48.8594) kd_loss 0.7374 (0.7579) lr 1.4258e-03 eta 0:22:53
epoch [20/50] batch [420/428] time 0.092 (0.106) data 0.000 (0.002) loss 1.5302 (1.6090) ce_loss 1.2549 (1.3888) teacher_loss 0.7914 (0.8618) loss_zs_kd 0.4508 (0.4794) loss_oracle 0.5134 (0.5075) acc 53.1250 (48.8914) kd_loss 0.7406 (0.7564) lr 1.4258e-03 eta 0:22:45
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,964
* accuracy: 50.4%
* error: 49.6%
* macro_f1: 38.5%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,703
* accuracy: 57.0%
* error: 43.0%
* macro_f1: 32.6%
******* Domain 1 best val acc:      50.4%, epoch: 20 *******
******* Domain 1 best val test acc: 57.0%, epoch: 20 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [21/50] batch [20/428] time 0.101 (0.135) data 0.000 (0.029) loss 1.7132 (1.6585) ce_loss 1.5928 (1.4533) teacher_loss 0.9829 (0.9304) loss_zs_kd 0.5184 (0.4687) loss_oracle 0.4711 (0.4937) acc 37.5000 (47.3438) kd_loss 0.7987 (0.7775) lr 1.3681e-03 eta 0:28:51
epoch [21/50] batch [40/428] time 0.108 (0.121) data 0.000 (0.015) loss 1.4743 (1.6056) ce_loss 1.3672 (1.3973) teacher_loss 0.6788 (0.8737) loss_zs_kd 0.5160 (0.4626) loss_oracle 0.5375 (0.5006) acc 46.8750 (49.2969) kd_loss 0.7466 (0.7545) lr 1.3681e-03 eta 0:25:44
epoch [21/50] batch [60/428] time 0.113 (0.115) data 0.001 (0.010) loss 1.6751 (1.6077) ce_loss 1.4336 (1.3918) teacher_loss 0.9713 (0.8732) loss_zs_kd 0.4024 (0.4621) loss_oracle 0.5026 (0.5034) acc 50.0000 (49.7917) kd_loss 0.7421 (0.7435) lr 1.3681e-03 eta 0:24:35
epoch [21/50] batch [80/428] time 0.101 (0.113) data 0.000 (0.007) loss 1.4317 (1.6096) ce_loss 1.1055 (1.3870) teacher_loss 0.6523 (0.8744) loss_zs_kd 0.4454 (0.4621) loss_oracle 0.5567 (0.5042) acc 56.2500 (49.2578) kd_loss 0.7311 (0.7361) lr 1.3681e-03 eta 0:23:56
epoch [21/50] batch [100/428] time 0.096 (0.111) data 0.000 (0.006) loss 1.6492 (1.6178) ce_loss 1.3008 (1.3901) teacher_loss 0.9435 (0.8821) loss_zs_kd 0.4842 (0.4614) loss_oracle 0.4636 (0.5050) acc 56.2500 (48.9062) kd_loss 0.7657 (0.7410) lr 1.3681e-03 eta 0:23:30
epoch [21/50] batch [120/428] time 0.105 (0.109) data 0.000 (0.005) loss 1.6528 (1.6167) ce_loss 1.4229 (1.3921) teacher_loss 0.8895 (0.8809) loss_zs_kd 0.5491 (0.4646) loss_oracle 0.4887 (0.5035) acc 43.7500 (48.5938) kd_loss 0.7649 (0.7459) lr 1.3681e-03 eta 0:23:03
epoch [21/50] batch [140/428] time 0.104 (0.108) data 0.001 (0.004) loss 1.5918 (1.6158) ce_loss 1.3027 (1.3849) teacher_loss 0.8812 (0.8797) loss_zs_kd 0.4348 (0.4627) loss_oracle 0.4932 (0.5048) acc 50.0000 (48.5491) kd_loss 0.5537 (0.7447) lr 1.3681e-03 eta 0:22:54
epoch [21/50] batch [160/428] time 0.106 (0.108) data 0.000 (0.004) loss 1.4636 (1.6158) ce_loss 1.0635 (1.3707) teacher_loss 0.6726 (0.8786) loss_zs_kd 0.4944 (0.4598) loss_oracle 0.5438 (0.5073) acc 59.3750 (49.2188) kd_loss 0.7293 (0.7424) lr 1.3681e-03 eta 0:22:46
epoch [21/50] batch [180/428] time 0.105 (0.108) data 0.000 (0.003) loss 1.5026 (1.6220) ce_loss 1.3701 (1.3724) teacher_loss 0.7521 (0.8827) loss_zs_kd 0.4894 (0.4603) loss_oracle 0.5058 (0.5092) acc 50.0000 (49.3056) kd_loss 0.7661 (0.7436) lr 1.3681e-03 eta 0:22:41
epoch [21/50] batch [200/428] time 0.097 (0.107) data 0.000 (0.003) loss 1.2832 (1.6193) ce_loss 1.1094 (1.3685) teacher_loss 0.5878 (0.8786) loss_zs_kd 0.4278 (0.4586) loss_oracle 0.4815 (0.5115) acc 59.3750 (49.5156) kd_loss 0.7137 (0.7450) lr 1.3681e-03 eta 0:22:33
epoch [21/50] batch [220/428] time 0.075 (0.105) data 0.000 (0.003) loss 1.5367 (1.6179) ce_loss 1.2959 (1.3619) teacher_loss 0.8280 (0.8761) loss_zs_kd 0.3907 (0.4562) loss_oracle 0.5133 (0.5137) acc 53.1250 (49.7585) kd_loss 0.8268 (0.7463) lr 1.3681e-03 eta 0:22:08
epoch [21/50] batch [240/428] time 0.164 (0.105) data 0.000 (0.003) loss 1.7597 (1.6257) ce_loss 1.3838 (1.3681) teacher_loss 1.0062 (0.8822) loss_zs_kd 0.4547 (0.4563) loss_oracle 0.5262 (0.5154) acc 50.0000 (49.3490) kd_loss 0.6780 (0.7472) lr 1.3681e-03 eta 0:21:56
epoch [21/50] batch [260/428] time 0.073 (0.104) data 0.000 (0.002) loss 1.5055 (1.6244) ce_loss 1.2539 (1.3644) teacher_loss 0.7898 (0.8809) loss_zs_kd 0.4115 (0.4561) loss_oracle 0.5100 (0.5155) acc 40.6250 (49.3870) kd_loss 0.6422 (0.7451) lr 1.3681e-03 eta 0:21:50
epoch [21/50] batch [280/428] time 0.097 (0.105) data 0.000 (0.002) loss 1.8262 (1.6301) ce_loss 1.3516 (1.3674) teacher_loss 1.0822 (0.8867) loss_zs_kd 0.4629 (0.4554) loss_oracle 0.5125 (0.5157) acc 56.2500 (49.3862) kd_loss 0.8050 (0.7446) lr 1.3681e-03 eta 0:21:53
epoch [21/50] batch [300/428] time 0.110 (0.105) data 0.000 (0.002) loss 1.6014 (1.6312) ce_loss 1.2354 (1.3701) teacher_loss 0.9401 (0.8878) loss_zs_kd 0.4429 (0.4538) loss_oracle 0.4398 (0.5164) acc 65.6250 (49.1979) kd_loss 0.6609 (0.7467) lr 1.3681e-03 eta 0:22:01
epoch [21/50] batch [320/428] time 0.078 (0.105) data 0.000 (0.002) loss 1.4687 (1.6323) ce_loss 1.3271 (1.3698) teacher_loss 0.6876 (0.8876) loss_zs_kd 0.4737 (0.4534) loss_oracle 0.5442 (0.5180) acc 46.8750 (49.2090) kd_loss 0.9677 (0.7508) lr 1.3681e-03 eta 0:21:55
epoch [21/50] batch [340/428] time 0.089 (0.105) data 0.000 (0.002) loss 1.7335 (1.6356) ce_loss 1.6191 (1.3744) teacher_loss 1.0675 (0.8906) loss_zs_kd 0.4492 (0.4533) loss_oracle 0.4413 (0.5184) acc 40.6250 (49.0349) kd_loss 0.7108 (0.7519) lr 1.3681e-03 eta 0:21:58
epoch [21/50] batch [360/428] time 0.073 (0.106) data 0.000 (0.002) loss 1.5345 (1.6385) ce_loss 1.3213 (1.3770) teacher_loss 0.9275 (0.8946) loss_zs_kd 0.3592 (0.4527) loss_oracle 0.4273 (0.5175) acc 43.7500 (48.7934) kd_loss 0.7734 (0.7523) lr 1.3681e-03 eta 0:22:05
epoch [21/50] batch [380/428] time 0.081 (0.107) data 0.000 (0.002) loss 1.7239 (1.6402) ce_loss 1.4287 (1.3779) teacher_loss 0.9707 (0.8969) loss_zs_kd 0.5293 (0.4525) loss_oracle 0.4885 (0.5170) acc 46.8750 (48.7993) kd_loss 0.8366 (0.7523) lr 1.3681e-03 eta 0:22:10
epoch [21/50] batch [400/428] time 0.096 (0.106) data 0.000 (0.002) loss 1.6666 (1.6405) ce_loss 1.3369 (1.3782) teacher_loss 0.8443 (0.8957) loss_zs_kd 0.4775 (0.4543) loss_oracle 0.5835 (0.5176) acc 46.8750 (48.7969) kd_loss 0.8608 (0.7541) lr 1.3681e-03 eta 0:22:03
epoch [21/50] batch [420/428] time 0.099 (0.106) data 0.000 (0.002) loss 1.7967 (1.6378) ce_loss 1.6299 (1.3751) teacher_loss 1.1275 (0.8931) loss_zs_kd 0.4456 (0.4547) loss_oracle 0.4463 (0.5173) acc 50.0000 (48.9955) kd_loss 0.8169 (0.7564) lr 1.3681e-03 eta 0:21:58
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,959
* accuracy: 50.4%
* error: 49.6%
* macro_f1: 37.8%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,647
* accuracy: 55.8%
* error: 44.2%
* macro_f1: 30.6%
******* Domain 1 best val acc:      50.4%, epoch: 20 *******
******* Domain 1 best val test acc: 57.0%, epoch: 20 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [22/50] batch [20/428] time 0.105 (0.131) data 0.000 (0.026) loss 1.3824 (1.6207) ce_loss 1.1611 (1.3645) teacher_loss 0.6319 (0.8863) loss_zs_kd 0.4206 (0.4471) loss_oracle 0.5403 (0.5108) acc 43.7500 (51.8750) kd_loss 0.7735 (0.7642) lr 1.3090e-03 eta 0:27:03
epoch [22/50] batch [40/428] time 0.107 (0.118) data 0.000 (0.013) loss 1.7522 (1.6334) ce_loss 1.2920 (1.3482) teacher_loss 0.8642 (0.8832) loss_zs_kd 0.5216 (0.4582) loss_oracle 0.6273 (0.5212) acc 56.2500 (51.0938) kd_loss 0.8047 (0.7740) lr 1.3090e-03 eta 0:24:14
epoch [22/50] batch [60/428] time 0.111 (0.113) data 0.000 (0.009) loss 1.7324 (1.6641) ce_loss 1.2891 (1.3914) teacher_loss 0.8866 (0.9083) loss_zs_kd 0.5468 (0.4627) loss_oracle 0.5723 (0.5245) acc 50.0000 (49.1146) kd_loss 0.8229 (0.7796) lr 1.3090e-03 eta 0:23:18
epoch [22/50] batch [80/428] time 0.108 (0.111) data 0.000 (0.007) loss 1.6818 (1.6564) ce_loss 1.3848 (1.3931) teacher_loss 0.9083 (0.9019) loss_zs_kd 0.4615 (0.4621) loss_oracle 0.5428 (0.5235) acc 56.2500 (49.3750) kd_loss 0.7363 (0.7752) lr 1.3090e-03 eta 0:22:49
epoch [22/50] batch [100/428] time 0.109 (0.110) data 0.000 (0.005) loss 1.4043 (1.6440) ce_loss 1.2051 (1.3876) teacher_loss 0.5955 (0.8877) loss_zs_kd 0.5062 (0.4628) loss_oracle 0.5557 (0.5249) acc 59.3750 (49.6875) kd_loss 0.7552 (0.7748) lr 1.3090e-03 eta 0:22:31
epoch [22/50] batch [120/428] time 0.109 (0.109) data 0.000 (0.005) loss 1.3916 (1.6510) ce_loss 1.3721 (1.3932) teacher_loss 0.6908 (0.8958) loss_zs_kd 0.4343 (0.4596) loss_oracle 0.4836 (0.5255) acc 50.0000 (49.5312) kd_loss 0.8138 (0.7731) lr 1.3090e-03 eta 0:22:19
epoch [22/50] batch [140/428] time 0.101 (0.108) data 0.000 (0.004) loss 1.5618 (1.6390) ce_loss 1.3672 (1.3815) teacher_loss 0.8588 (0.8837) loss_zs_kd 0.4761 (0.4604) loss_oracle 0.4649 (0.5252) acc 46.8750 (49.9777) kd_loss 0.7756 (0.7723) lr 1.3090e-03 eta 0:22:08
epoch [22/50] batch [160/428] time 0.120 (0.108) data 0.000 (0.003) loss 1.4822 (1.6309) ce_loss 1.3350 (1.3696) teacher_loss 0.7817 (0.8743) loss_zs_kd 0.4467 (0.4620) loss_oracle 0.4771 (0.5256) acc 43.7500 (50.3516) kd_loss 0.6287 (0.7687) lr 1.3090e-03 eta 0:21:59
epoch [22/50] batch [180/428] time 0.100 (0.107) data 0.000 (0.003) loss 1.8336 (1.6323) ce_loss 1.7549 (1.3702) teacher_loss 1.0495 (0.8748) loss_zs_kd 0.5288 (0.4617) loss_oracle 0.5197 (0.5267) acc 40.6250 (50.3993) kd_loss 0.7737 (0.7710) lr 1.3090e-03 eta 0:21:53
epoch [22/50] batch [200/428] time 0.108 (0.107) data 0.000 (0.003) loss 1.5639 (1.6323) ce_loss 1.3350 (1.3712) teacher_loss 0.8115 (0.8745) loss_zs_kd 0.4971 (0.4619) loss_oracle 0.5039 (0.5268) acc 37.5000 (50.2969) kd_loss 0.7717 (0.7688) lr 1.3090e-03 eta 0:21:46
epoch [22/50] batch [220/428] time 0.084 (0.105) data 0.000 (0.003) loss 1.7224 (1.6277) ce_loss 1.5020 (1.3709) teacher_loss 1.0194 (0.8717) loss_zs_kd 0.3932 (0.4607) loss_oracle 0.5063 (0.5256) acc 37.5000 (50.2415) kd_loss 0.7978 (0.7705) lr 1.3090e-03 eta 0:21:24
epoch [22/50] batch [240/428] time 0.159 (0.106) data 0.000 (0.002) loss 1.7286 (1.6267) ce_loss 1.5117 (1.3704) teacher_loss 1.0144 (0.8729) loss_zs_kd 0.4217 (0.4588) loss_oracle 0.5033 (0.5243) acc 37.5000 (50.1823) kd_loss 0.7425 (0.7708) lr 1.3090e-03 eta 0:21:27
epoch [22/50] batch [260/428] time 0.076 (0.106) data 0.000 (0.002) loss 1.5891 (1.6319) ce_loss 1.3213 (1.3734) teacher_loss 0.8385 (0.8792) loss_zs_kd 0.4392 (0.4575) loss_oracle 0.5311 (0.5239) acc 56.2500 (50.0841) kd_loss 0.7806 (0.7680) lr 1.3090e-03 eta 0:21:24
epoch [22/50] batch [280/428] time 0.165 (0.106) data 0.000 (0.002) loss 1.8310 (1.6362) ce_loss 1.3467 (1.3771) teacher_loss 0.9570 (0.8852) loss_zs_kd 0.4910 (0.4561) loss_oracle 0.6285 (0.5229) acc 50.0000 (49.8103) kd_loss 0.7501 (0.7648) lr 1.3090e-03 eta 0:21:26
epoch [22/50] batch [300/428] time 0.075 (0.107) data 0.000 (0.002) loss 1.6133 (1.6366) ce_loss 1.4727 (1.3744) teacher_loss 0.8166 (0.8873) loss_zs_kd 0.5114 (0.4538) loss_oracle 0.5410 (0.5224) acc 34.3750 (49.9479) kd_loss 0.7375 (0.7605) lr 1.3090e-03 eta 0:21:34
epoch [22/50] batch [320/428] time 0.150 (0.106) data 0.000 (0.002) loss 1.4098 (1.6322) ce_loss 1.2080 (1.3700) teacher_loss 0.6861 (0.8852) loss_zs_kd 0.4364 (0.4519) loss_oracle 0.5055 (0.5210) acc 56.2500 (50.0488) kd_loss 0.7721 (0.7571) lr 1.3090e-03 eta 0:21:16
epoch [22/50] batch [340/428] time 0.189 (0.106) data 0.000 (0.002) loss 1.6301 (1.6331) ce_loss 1.1982 (1.3707) teacher_loss 0.8990 (0.8875) loss_zs_kd 0.4050 (0.4501) loss_oracle 0.5286 (0.5206) acc 59.3750 (50.0276) kd_loss 0.6917 (0.7540) lr 1.3090e-03 eta 0:21:20
epoch [22/50] batch [360/428] time 0.074 (0.106) data 0.000 (0.002) loss 1.5580 (1.6345) ce_loss 1.3271 (1.3707) teacher_loss 0.8543 (0.8901) loss_zs_kd 0.4171 (0.4478) loss_oracle 0.4951 (0.5205) acc 40.6250 (49.9479) kd_loss 0.6440 (0.7514) lr 1.3090e-03 eta 0:21:17
epoch [22/50] batch [380/428] time 0.074 (0.106) data 0.000 (0.002) loss 1.5701 (1.6340) ce_loss 1.3848 (1.3701) teacher_loss 0.9091 (0.8910) loss_zs_kd 0.3767 (0.4462) loss_oracle 0.4726 (0.5199) acc 43.7500 (49.9342) kd_loss 0.6995 (0.7472) lr 1.3090e-03 eta 0:21:17
epoch [22/50] batch [400/428] time 0.105 (0.105) data 0.000 (0.002) loss 1.6808 (1.6388) ce_loss 1.4033 (1.3726) teacher_loss 0.9840 (0.8960) loss_zs_kd 0.4426 (0.4454) loss_oracle 0.4755 (0.5201) acc 43.7500 (49.8281) kd_loss 0.7050 (0.7445) lr 1.3090e-03 eta 0:21:06
epoch [22/50] batch [420/428] time 0.094 (0.105) data 0.000 (0.001) loss 1.6578 (1.6388) ce_loss 1.2617 (1.3719) teacher_loss 0.8795 (0.8964) loss_zs_kd 0.5132 (0.4448) loss_oracle 0.5216 (0.5199) acc 46.8750 (49.8735) kd_loss 0.7155 (0.7421) lr 1.3090e-03 eta 0:21:01
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,944
* accuracy: 50.1%
* error: 49.9%
* macro_f1: 36.7%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,688
* accuracy: 56.7%
* error: 43.3%
* macro_f1: 28.6%
******* Domain 1 best val acc:      50.4%, epoch: 20 *******
******* Domain 1 best val test acc: 57.0%, epoch: 20 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [23/50] batch [20/428] time 0.113 (0.129) data 0.000 (0.024) loss 1.6830 (1.6553) ce_loss 1.3154 (1.3350) teacher_loss 0.9237 (0.9325) loss_zs_kd 0.4567 (0.4087) loss_oracle 0.5310 (0.5184) acc 53.1250 (52.1875) kd_loss 0.6838 (0.7060) lr 1.2487e-03 eta 0:25:48
epoch [23/50] batch [40/428] time 0.105 (0.117) data 0.000 (0.012) loss 1.4305 (1.6466) ce_loss 1.2314 (1.3600) teacher_loss 0.7475 (0.9273) loss_zs_kd 0.4347 (0.4171) loss_oracle 0.4657 (0.5107) acc 59.3750 (51.7969) kd_loss 0.7555 (0.7176) lr 1.2487e-03 eta 0:23:18
epoch [23/50] batch [60/428] time 0.108 (0.113) data 0.000 (0.008) loss 1.6591 (1.6448) ce_loss 1.5518 (1.3572) teacher_loss 0.8915 (0.9188) loss_zs_kd 0.3965 (0.4333) loss_oracle 0.5693 (0.5093) acc 50.0000 (52.0312) kd_loss 0.7551 (0.7155) lr 1.2487e-03 eta 0:22:25
epoch [23/50] batch [80/428] time 0.107 (0.111) data 0.000 (0.006) loss 1.9532 (1.6662) ce_loss 1.5732 (1.3879) teacher_loss 1.2328 (0.9413) loss_zs_kd 0.4310 (0.4325) loss_oracle 0.5049 (0.5087) acc 34.3750 (50.3906) kd_loss 0.7010 (0.7152) lr 1.2487e-03 eta 0:22:00
epoch [23/50] batch [100/428] time 0.100 (0.110) data 0.000 (0.005) loss 1.6951 (1.6710) ce_loss 1.3740 (1.3908) teacher_loss 0.9187 (0.9403) loss_zs_kd 0.4648 (0.4340) loss_oracle 0.5440 (0.5137) acc 56.2500 (50.0312) kd_loss 0.7333 (0.7218) lr 1.2487e-03 eta 0:21:41
epoch [23/50] batch [120/428] time 0.096 (0.107) data 0.000 (0.004) loss 1.6382 (1.6690) ce_loss 1.4160 (1.3902) teacher_loss 0.8783 (0.9377) loss_zs_kd 0.4408 (0.4350) loss_oracle 0.5396 (0.5139) acc 53.1250 (49.8177) kd_loss 0.8124 (0.7239) lr 1.2487e-03 eta 0:21:05
epoch [23/50] batch [140/428] time 0.088 (0.104) data 0.000 (0.004) loss 2.0106 (1.6669) ce_loss 1.5234 (1.3893) teacher_loss 1.2997 (0.9350) loss_zs_kd 0.4322 (0.4356) loss_oracle 0.4948 (0.5141) acc 43.7500 (49.3973) kd_loss 0.6108 (0.7258) lr 1.2487e-03 eta 0:20:31
epoch [23/50] batch [160/428] time 0.085 (0.102) data 0.000 (0.003) loss 1.6026 (1.6653) ce_loss 1.3105 (1.3867) teacher_loss 0.9043 (0.9306) loss_zs_kd 0.4228 (0.4383) loss_oracle 0.4868 (0.5155) acc 56.2500 (49.4531) kd_loss 0.6903 (0.7245) lr 1.2487e-03 eta 0:20:03
epoch [23/50] batch [180/428] time 0.102 (0.102) data 0.000 (0.003) loss 1.4427 (1.6567) ce_loss 1.0742 (1.3810) teacher_loss 0.7385 (0.9211) loss_zs_kd 0.4023 (0.4385) loss_oracle 0.5030 (0.5164) acc 59.3750 (49.4792) kd_loss 0.6082 (0.7232) lr 1.2487e-03 eta 0:20:00
epoch [23/50] batch [200/428] time 0.112 (0.102) data 0.000 (0.003) loss 1.5555 (1.6498) ce_loss 1.2227 (1.3737) teacher_loss 0.8384 (0.9134) loss_zs_kd 0.4530 (0.4404) loss_oracle 0.4907 (0.5161) acc 62.5000 (49.6875) kd_loss 0.6404 (0.7210) lr 1.2487e-03 eta 0:20:01
epoch [23/50] batch [220/428] time 0.109 (0.101) data 0.000 (0.002) loss 1.6327 (1.6508) ce_loss 1.3838 (1.3752) teacher_loss 0.9803 (0.9152) loss_zs_kd 0.3761 (0.4370) loss_oracle 0.4643 (0.5171) acc 53.1250 (49.6733) kd_loss 0.6092 (0.7218) lr 1.2487e-03 eta 0:19:52
epoch [23/50] batch [240/428] time 0.087 (0.100) data 0.001 (0.002) loss 1.7342 (1.6476) ce_loss 1.6084 (1.3711) teacher_loss 0.9756 (0.9112) loss_zs_kd 0.4773 (0.4380) loss_oracle 0.5200 (0.5173) acc 40.6250 (49.7526) kd_loss 0.6805 (0.7210) lr 1.2487e-03 eta 0:19:38
epoch [23/50] batch [260/428] time 0.086 (0.100) data 0.000 (0.002) loss 1.8168 (1.6484) ce_loss 1.5273 (1.3728) teacher_loss 1.0895 (0.9129) loss_zs_kd 0.4338 (0.4376) loss_oracle 0.5103 (0.5166) acc 31.2500 (49.6154) kd_loss 0.7744 (0.7186) lr 1.2487e-03 eta 0:19:35
epoch [23/50] batch [280/428] time 0.091 (0.102) data 0.000 (0.002) loss 1.3573 (1.6448) ce_loss 1.1455 (1.3684) teacher_loss 0.6112 (0.9103) loss_zs_kd 0.3921 (0.4368) loss_oracle 0.5500 (0.5161) acc 62.5000 (49.7768) kd_loss 0.8119 (0.7186) lr 1.2487e-03 eta 0:19:48
epoch [23/50] batch [300/428] time 0.179 (0.103) data 0.000 (0.002) loss 1.4825 (1.6426) ce_loss 1.2080 (1.3684) teacher_loss 0.7398 (0.9102) loss_zs_kd 0.4847 (0.4355) loss_oracle 0.5003 (0.5146) acc 53.1250 (49.7708) kd_loss 0.6906 (0.7180) lr 1.2487e-03 eta 0:20:03
epoch [23/50] batch [320/428] time 0.083 (0.104) data 0.000 (0.002) loss 1.8022 (1.6438) ce_loss 1.5107 (1.3696) teacher_loss 1.0205 (0.9120) loss_zs_kd 0.4676 (0.4365) loss_oracle 0.5479 (0.5136) acc 34.3750 (49.7461) kd_loss 0.8078 (0.7177) lr 1.2487e-03 eta 0:20:09
epoch [23/50] batch [340/428] time 0.165 (0.103) data 0.000 (0.002) loss 1.5777 (1.6401) ce_loss 1.4580 (1.3697) teacher_loss 0.8819 (0.9089) loss_zs_kd 0.4091 (0.4368) loss_oracle 0.4912 (0.5129) acc 56.2500 (49.7426) kd_loss 0.7644 (0.7192) lr 1.2487e-03 eta 0:19:59
epoch [23/50] batch [360/428] time 0.080 (0.104) data 0.000 (0.002) loss 1.8908 (1.6395) ce_loss 1.6543 (1.3659) teacher_loss 1.0837 (0.9068) loss_zs_kd 0.4229 (0.4385) loss_oracle 0.5956 (0.5134) acc 28.1250 (49.8177) kd_loss 0.8617 (0.7194) lr 1.2487e-03 eta 0:20:10
epoch [23/50] batch [380/428] time 0.096 (0.105) data 0.000 (0.002) loss 1.3983 (1.6359) ce_loss 1.1289 (1.3623) teacher_loss 0.7288 (0.9037) loss_zs_kd 0.3512 (0.4376) loss_oracle 0.4939 (0.5134) acc 56.2500 (49.9753) kd_loss 0.6982 (0.7204) lr 1.2487e-03 eta 0:20:13
epoch [23/50] batch [400/428] time 0.077 (0.104) data 0.000 (0.001) loss 1.3187 (1.6344) ce_loss 1.2236 (1.3606) teacher_loss 0.6370 (0.9021) loss_zs_kd 0.3988 (0.4382) loss_oracle 0.4823 (0.5131) acc 65.6250 (50.0312) kd_loss 0.8178 (0.7233) lr 1.2487e-03 eta 0:20:06
epoch [23/50] batch [420/428] time 0.098 (0.104) data 0.000 (0.001) loss 1.6220 (1.6356) ce_loss 1.1826 (1.3624) teacher_loss 0.8222 (0.9037) loss_zs_kd 0.4079 (0.4379) loss_oracle 0.5959 (0.5130) acc 56.2500 (50.0149) kd_loss 0.8768 (0.7244) lr 1.2487e-03 eta 0:20:01
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,968
* accuracy: 50.5%
* error: 49.5%
* macro_f1: 37.6%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,606
* accuracy: 55.0%
* error: 45.0%
* macro_f1: 29.1%
******* Domain 1 best val acc:      50.5%, epoch: 23 *******
******* Domain 1 best val test acc: 55.0%, epoch: 23 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [24/50] batch [20/428] time 0.095 (0.133) data 0.000 (0.028) loss 1.5703 (1.6049) ce_loss 1.2656 (1.3432) teacher_loss 0.7883 (0.8606) loss_zs_kd 0.4838 (0.4552) loss_oracle 0.5401 (0.5167) acc 53.1250 (50.9375) kd_loss 0.7087 (0.7519) lr 1.1874e-03 eta 0:25:31
epoch [24/50] batch [40/428] time 0.112 (0.119) data 0.000 (0.014) loss 1.7187 (1.6064) ce_loss 1.4814 (1.3311) teacher_loss 0.9947 (0.8691) loss_zs_kd 0.4153 (0.4463) loss_oracle 0.5163 (0.5142) acc 43.7500 (50.7812) kd_loss 0.7875 (0.7518) lr 1.1874e-03 eta 0:22:51
epoch [24/50] batch [60/428] time 0.102 (0.114) data 0.000 (0.009) loss 1.9577 (1.6095) ce_loss 1.6748 (1.3320) teacher_loss 1.1871 (0.8688) loss_zs_kd 0.4121 (0.4390) loss_oracle 0.5645 (0.5212) acc 31.2500 (50.6250) kd_loss 0.7599 (0.7530) lr 1.1874e-03 eta 0:21:49
epoch [24/50] batch [80/428] time 0.095 (0.112) data 0.000 (0.007) loss 1.9990 (1.6178) ce_loss 1.6523 (1.3390) teacher_loss 1.2322 (0.8757) loss_zs_kd 0.4867 (0.4402) loss_oracle 0.5234 (0.5220) acc 37.5000 (50.2344) kd_loss 0.7387 (0.7536) lr 1.1874e-03 eta 0:21:20
epoch [24/50] batch [100/428] time 0.096 (0.110) data 0.000 (0.006) loss 1.4727 (1.6138) ce_loss 1.3291 (1.3330) teacher_loss 0.7568 (0.8700) loss_zs_kd 0.4049 (0.4396) loss_oracle 0.5134 (0.5240) acc 43.7500 (50.3438) kd_loss 0.8013 (0.7529) lr 1.1874e-03 eta 0:21:02
epoch [24/50] batch [120/428] time 0.106 (0.109) data 0.000 (0.005) loss 1.5883 (1.6261) ce_loss 1.4180 (1.3470) teacher_loss 0.8271 (0.8808) loss_zs_kd 0.4117 (0.4393) loss_oracle 0.5553 (0.5257) acc 46.8750 (49.5833) kd_loss 0.7832 (0.7489) lr 1.1874e-03 eta 0:20:49
epoch [24/50] batch [140/428] time 0.109 (0.109) data 0.000 (0.004) loss 1.8594 (1.6379) ce_loss 1.4209 (1.3494) teacher_loss 1.1091 (0.8903) loss_zs_kd 0.4859 (0.4420) loss_oracle 0.5073 (0.5266) acc 43.7500 (49.3750) kd_loss 0.7586 (0.7434) lr 1.1874e-03 eta 0:20:39
epoch [24/50] batch [160/428] time 0.099 (0.108) data 0.000 (0.004) loss 1.4374 (1.6331) ce_loss 1.1680 (1.3464) teacher_loss 0.6564 (0.8892) loss_zs_kd 0.4391 (0.4383) loss_oracle 0.5614 (0.5247) acc 53.1250 (49.4531) kd_loss 0.7151 (0.7400) lr 1.1874e-03 eta 0:20:30
epoch [24/50] batch [180/428] time 0.103 (0.108) data 0.000 (0.003) loss 1.6676 (1.6354) ce_loss 1.3281 (1.3522) teacher_loss 0.8475 (0.8910) loss_zs_kd 0.5267 (0.4396) loss_oracle 0.5568 (0.5246) acc 53.1250 (49.3056) kd_loss 0.7371 (0.7401) lr 1.1874e-03 eta 0:20:23
epoch [24/50] batch [200/428] time 0.109 (0.107) data 0.000 (0.003) loss 1.5754 (1.6381) ce_loss 1.3750 (1.3559) teacher_loss 0.8695 (0.8918) loss_zs_kd 0.4489 (0.4399) loss_oracle 0.4814 (0.5264) acc 50.0000 (49.4062) kd_loss 0.7462 (0.7429) lr 1.1874e-03 eta 0:20:17
epoch [24/50] batch [220/428] time 0.075 (0.106) data 0.000 (0.003) loss 1.7565 (1.6427) ce_loss 1.4463 (1.3610) teacher_loss 1.1170 (0.8961) loss_zs_kd 0.3623 (0.4394) loss_oracle 0.4583 (0.5268) acc 50.0000 (49.3750) kd_loss 0.6765 (0.7441) lr 1.1874e-03 eta 0:20:02
epoch [24/50] batch [240/428] time 0.087 (0.105) data 0.000 (0.003) loss 1.7476 (1.6473) ce_loss 1.6143 (1.3706) teacher_loss 1.0584 (0.9029) loss_zs_kd 0.4317 (0.4382) loss_oracle 0.4733 (0.5254) acc 46.8750 (48.9323) kd_loss 0.7288 (0.7459) lr 1.1874e-03 eta 0:19:47
epoch [24/50] batch [260/428] time 0.077 (0.105) data 0.000 (0.002) loss 1.8483 (1.6450) ce_loss 1.5459 (1.3684) teacher_loss 1.1115 (0.9012) loss_zs_kd 0.4366 (0.4399) loss_oracle 0.5185 (0.5239) acc 34.3750 (48.8341) kd_loss 0.7548 (0.7444) lr 1.1874e-03 eta 0:19:51
epoch [24/50] batch [280/428] time 0.151 (0.106) data 0.000 (0.002) loss 1.6629 (1.6467) ce_loss 1.5107 (1.3717) teacher_loss 0.8836 (0.9019) loss_zs_kd 0.4883 (0.4414) loss_oracle 0.5351 (0.5241) acc 43.7500 (48.7500) kd_loss 0.7605 (0.7457) lr 1.1874e-03 eta 0:19:50
epoch [24/50] batch [300/428] time 0.179 (0.106) data 0.000 (0.002) loss 1.4488 (1.6464) ce_loss 1.1953 (1.3738) teacher_loss 0.7266 (0.9024) loss_zs_kd 0.4271 (0.4407) loss_oracle 0.5087 (0.5236) acc 59.3750 (48.6979) kd_loss 0.7201 (0.7471) lr 1.1874e-03 eta 0:19:58
epoch [24/50] batch [320/428] time 0.086 (0.106) data 0.000 (0.002) loss 1.5018 (1.6485) ce_loss 1.2910 (1.3750) teacher_loss 0.7725 (0.9035) loss_zs_kd 0.4327 (0.4417) loss_oracle 0.5130 (0.5241) acc 59.3750 (48.8477) kd_loss 0.6858 (0.7474) lr 1.1874e-03 eta 0:19:49
epoch [24/50] batch [340/428] time 0.170 (0.106) data 0.000 (0.002) loss 1.5536 (1.6450) ce_loss 1.3467 (1.3744) teacher_loss 0.8470 (0.8993) loss_zs_kd 0.4104 (0.4416) loss_oracle 0.5014 (0.5249) acc 50.0000 (48.8695) kd_loss 0.5816 (0.7489) lr 1.1874e-03 eta 0:19:53
epoch [24/50] batch [360/428] time 0.083 (0.107) data 0.000 (0.002) loss 1.4045 (1.6457) ce_loss 1.1416 (1.3774) teacher_loss 0.7192 (0.8990) loss_zs_kd 0.4145 (0.4420) loss_oracle 0.4781 (0.5257) acc 56.2500 (48.7934) kd_loss 0.6482 (0.7504) lr 1.1874e-03 eta 0:20:01
epoch [24/50] batch [380/428] time 0.076 (0.108) data 0.000 (0.002) loss 1.6409 (1.6420) ce_loss 1.4453 (1.3744) teacher_loss 0.8663 (0.8942) loss_zs_kd 0.4704 (0.4435) loss_oracle 0.5395 (0.5261) acc 46.8750 (49.0049) kd_loss 0.7422 (0.7505) lr 1.1874e-03 eta 0:20:02
epoch [24/50] batch [400/428] time 0.092 (0.107) data 0.000 (0.002) loss 1.6267 (1.6429) ce_loss 1.3291 (1.3738) teacher_loss 0.8578 (0.8948) loss_zs_kd 0.4140 (0.4434) loss_oracle 0.5619 (0.5265) acc 46.8750 (49.0078) kd_loss 0.7211 (0.7493) lr 1.1874e-03 eta 0:19:52
epoch [24/50] batch [420/428] time 0.098 (0.107) data 0.000 (0.002) loss 1.5156 (1.6428) ce_loss 1.3018 (1.3752) teacher_loss 0.7241 (0.8949) loss_zs_kd 0.4133 (0.4430) loss_oracle 0.5848 (0.5264) acc 46.8750 (48.8765) kd_loss 0.8225 (0.7477) lr 1.1874e-03 eta 0:19:47
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,039
* accuracy: 51.7%
* error: 48.3%
* macro_f1: 38.7%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,484
* accuracy: 52.4%
* error: 47.6%
* macro_f1: 28.4%
******* Domain 1 best val acc:      51.7%, epoch: 24 *******
******* Domain 1 best val test acc: 52.4%, epoch: 24 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [25/50] batch [20/428] time 0.106 (0.130) data 0.000 (0.024) loss 2.2056 (1.6806) ce_loss 1.9072 (1.4151) teacher_loss 1.3532 (0.9595) loss_zs_kd 0.5323 (0.4282) loss_oracle 0.5862 (0.5070) acc 34.3750 (47.0312) kd_loss 0.6956 (0.6993) lr 1.1253e-03 eta 0:24:08
epoch [25/50] batch [40/428] time 0.103 (0.117) data 0.000 (0.012) loss 1.6199 (1.6540) ce_loss 1.4150 (1.3953) teacher_loss 0.8400 (0.9139) loss_zs_kd 0.4937 (0.4386) loss_oracle 0.5330 (0.5208) acc 50.0000 (49.5312) kd_loss 0.7159 (0.7219) lr 1.1253e-03 eta 0:21:41
epoch [25/50] batch [60/428] time 0.133 (0.113) data 0.001 (0.008) loss 1.6932 (1.6555) ce_loss 1.3574 (1.3920) teacher_loss 1.0409 (0.9131) loss_zs_kd 0.4026 (0.4459) loss_oracle 0.4510 (0.5194) acc 50.0000 (49.4792) kd_loss 0.6886 (0.7288) lr 1.1253e-03 eta 0:20:54
epoch [25/50] batch [80/428] time 0.096 (0.111) data 0.000 (0.006) loss 1.5115 (1.6554) ce_loss 1.2490 (1.3941) teacher_loss 0.7437 (0.9064) loss_zs_kd 0.4746 (0.4509) loss_oracle 0.5306 (0.5235) acc 59.3750 (48.9062) kd_loss 0.7751 (0.7389) lr 1.1253e-03 eta 0:20:21
epoch [25/50] batch [100/428] time 0.102 (0.109) data 0.000 (0.005) loss 1.7442 (1.6517) ce_loss 1.3633 (1.3946) teacher_loss 0.9521 (0.8989) loss_zs_kd 0.5205 (0.4577) loss_oracle 0.5319 (0.5240) acc 46.8750 (49.2188) kd_loss 0.8110 (0.7461) lr 1.1253e-03 eta 0:20:04
epoch [25/50] batch [120/428] time 0.102 (0.108) data 0.000 (0.004) loss 1.7012 (1.6444) ce_loss 1.4219 (1.3872) teacher_loss 0.9669 (0.8904) loss_zs_kd 0.4163 (0.4584) loss_oracle 0.5262 (0.5248) acc 43.7500 (49.2708) kd_loss 0.8910 (0.7521) lr 1.1253e-03 eta 0:19:44
epoch [25/50] batch [140/428] time 0.099 (0.107) data 0.000 (0.004) loss 1.9562 (1.6383) ce_loss 1.9570 (1.3904) teacher_loss 1.2196 (0.8802) loss_zs_kd 0.4855 (0.4619) loss_oracle 0.4938 (0.5271) acc 31.2500 (49.0625) kd_loss 0.8012 (0.7594) lr 1.1253e-03 eta 0:19:37
epoch [25/50] batch [160/428] time 0.102 (0.107) data 0.000 (0.003) loss 1.4742 (1.6365) ce_loss 1.3232 (1.3853) teacher_loss 0.7307 (0.8797) loss_zs_kd 0.4271 (0.4588) loss_oracle 0.5299 (0.5274) acc 56.2500 (49.4727) kd_loss 0.8826 (0.7578) lr 1.1253e-03 eta 0:19:31
epoch [25/50] batch [180/428] time 0.101 (0.107) data 0.000 (0.003) loss 1.4796 (1.6351) ce_loss 1.2490 (1.3803) teacher_loss 0.7221 (0.8817) loss_zs_kd 0.4684 (0.4543) loss_oracle 0.5233 (0.5262) acc 65.6250 (49.8611) kd_loss 0.8629 (0.7555) lr 1.1253e-03 eta 0:19:27
epoch [25/50] batch [200/428] time 0.105 (0.106) data 0.000 (0.003) loss 1.7686 (1.6390) ce_loss 1.5049 (1.3873) teacher_loss 1.0236 (0.8874) loss_zs_kd 0.4704 (0.4533) loss_oracle 0.5098 (0.5250) acc 37.5000 (49.6406) kd_loss 0.7642 (0.7567) lr 1.1253e-03 eta 0:19:19
epoch [25/50] batch [220/428] time 0.126 (0.105) data 0.000 (0.002) loss 1.4883 (1.6395) ce_loss 1.0664 (1.3851) teacher_loss 0.7483 (0.8882) loss_zs_kd 0.5025 (0.4539) loss_oracle 0.4887 (0.5244) acc 65.6250 (49.7301) kd_loss 0.7017 (0.7584) lr 1.1253e-03 eta 0:19:00
epoch [25/50] batch [240/428] time 0.091 (0.105) data 0.000 (0.002) loss 1.4924 (1.6393) ce_loss 1.3125 (1.3848) teacher_loss 0.6913 (0.8888) loss_zs_kd 0.3992 (0.4524) loss_oracle 0.6015 (0.5243) acc 50.0000 (49.6354) kd_loss 0.9053 (0.7589) lr 1.1253e-03 eta 0:19:05
epoch [25/50] batch [260/428] time 0.074 (0.104) data 0.000 (0.002) loss 1.4267 (1.6392) ce_loss 1.1182 (1.3822) teacher_loss 0.7252 (0.8896) loss_zs_kd 0.4185 (0.4517) loss_oracle 0.4922 (0.5237) acc 59.3750 (49.6995) kd_loss 0.7688 (0.7594) lr 1.1253e-03 eta 0:18:53
epoch [25/50] batch [280/428] time 0.137 (0.105) data 0.000 (0.002) loss 1.5985 (1.6402) ce_loss 1.5312 (1.3843) teacher_loss 0.8490 (0.8918) loss_zs_kd 0.4251 (0.4515) loss_oracle 0.5369 (0.5226) acc 34.3750 (49.5647) kd_loss 0.9275 (0.7590) lr 1.1253e-03 eta 0:18:58
epoch [25/50] batch [300/428] time 0.085 (0.106) data 0.000 (0.002) loss 1.5877 (1.6392) ce_loss 1.2471 (1.3811) teacher_loss 0.8825 (0.8913) loss_zs_kd 0.4943 (0.4508) loss_oracle 0.4581 (0.5224) acc 65.6250 (49.8438) kd_loss 0.6949 (0.7588) lr 1.1253e-03 eta 0:19:03
epoch [25/50] batch [320/428] time 0.156 (0.104) data 0.000 (0.002) loss 1.6334 (1.6373) ce_loss 1.3945 (1.3784) teacher_loss 0.9530 (0.8906) loss_zs_kd 0.3782 (0.4500) loss_oracle 0.4914 (0.5217) acc 46.8750 (49.9121) kd_loss 0.7485 (0.7586) lr 1.1253e-03 eta 0:18:47
epoch [25/50] batch [340/428] time 0.178 (0.105) data 0.000 (0.002) loss 1.4769 (1.6358) ce_loss 1.2051 (1.3773) teacher_loss 0.6850 (0.8886) loss_zs_kd 0.4464 (0.4504) loss_oracle 0.5687 (0.5220) acc 59.3750 (50.0092) kd_loss 0.7528 (0.7588) lr 1.1253e-03 eta 0:18:52
epoch [25/50] batch [360/428] time 0.147 (0.105) data 0.000 (0.002) loss 1.2894 (1.6341) ce_loss 1.2109 (1.3770) teacher_loss 0.6618 (0.8868) loss_zs_kd 0.3839 (0.4504) loss_oracle 0.4357 (0.5221) acc 56.2500 (50.0781) kd_loss 0.7973 (0.7593) lr 1.1253e-03 eta 0:18:51
epoch [25/50] batch [380/428] time 0.073 (0.105) data 0.000 (0.002) loss 1.6307 (1.6342) ce_loss 1.3770 (1.3787) teacher_loss 0.9695 (0.8877) loss_zs_kd 0.3792 (0.4497) loss_oracle 0.4716 (0.5217) acc 53.1250 (49.9013) kd_loss 0.7309 (0.7612) lr 1.1253e-03 eta 0:18:49
epoch [25/50] batch [400/428] time 0.106 (0.105) data 0.000 (0.001) loss 1.5657 (1.6323) ce_loss 1.2246 (1.3768) teacher_loss 0.8999 (0.8859) loss_zs_kd 0.4383 (0.4499) loss_oracle 0.4466 (0.5215) acc 56.2500 (50.0000) kd_loss 0.6784 (0.7611) lr 1.1253e-03 eta 0:18:43
epoch [25/50] batch [420/428] time 0.095 (0.105) data 0.000 (0.001) loss 1.8093 (1.6323) ce_loss 1.4336 (1.3762) teacher_loss 1.0853 (0.8864) loss_zs_kd 0.4003 (0.4495) loss_oracle 0.5239 (0.5212) acc 46.8750 (50.0595) kd_loss 0.5685 (0.7597) lr 1.1253e-03 eta 0:18:41
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,009
* accuracy: 51.2%
* error: 48.8%
* macro_f1: 38.1%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,563
* accuracy: 54.1%
* error: 45.9%
* macro_f1: 30.3%
******* Domain 1 best val acc:      51.7%, epoch: 24 *******
******* Domain 1 best val test acc: 52.4%, epoch: 24 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [26/50] batch [20/428] time 0.103 (0.133) data 0.000 (0.030) loss 1.6938 (1.6303) ce_loss 1.5342 (1.3778) teacher_loss 0.9296 (0.8724) loss_zs_kd 0.4961 (0.4718) loss_oracle 0.5162 (0.5220) acc 40.6250 (47.5000) kd_loss 0.7398 (0.7383) lr 1.0628e-03 eta 0:23:40
epoch [26/50] batch [40/428] time 0.100 (0.119) data 0.000 (0.015) loss 1.6337 (1.6375) ce_loss 1.2402 (1.3875) teacher_loss 0.9302 (0.8888) loss_zs_kd 0.4401 (0.4582) loss_oracle 0.4835 (0.5196) acc 46.8750 (48.6719) kd_loss 0.7217 (0.7443) lr 1.0628e-03 eta 0:21:03
epoch [26/50] batch [60/428] time 0.110 (0.114) data 0.001 (0.010) loss 1.9484 (1.6297) ce_loss 1.4033 (1.3781) teacher_loss 1.1851 (0.8883) loss_zs_kd 0.4353 (0.4571) loss_oracle 0.5456 (0.5129) acc 50.0000 (49.4271) kd_loss 0.7228 (0.7466) lr 1.0628e-03 eta 0:20:14
epoch [26/50] batch [80/428] time 0.096 (0.110) data 0.000 (0.008) loss 1.5879 (1.6447) ce_loss 1.4043 (1.3788) teacher_loss 0.8095 (0.9016) loss_zs_kd 0.4610 (0.4560) loss_oracle 0.5480 (0.5152) acc 43.7500 (49.4141) kd_loss 0.7477 (0.7394) lr 1.0628e-03 eta 0:19:29
epoch [26/50] batch [100/428] time 0.091 (0.109) data 0.000 (0.006) loss 1.3430 (1.6334) ce_loss 1.0840 (1.3669) teacher_loss 0.6435 (0.8948) loss_zs_kd 0.4154 (0.4480) loss_oracle 0.4918 (0.5146) acc 56.2500 (49.5938) kd_loss 0.6868 (0.7370) lr 1.0628e-03 eta 0:19:10
epoch [26/50] batch [120/428] time 0.103 (0.108) data 0.000 (0.005) loss 1.5389 (1.6266) ce_loss 1.2959 (1.3580) teacher_loss 0.7376 (0.8879) loss_zs_kd 0.4319 (0.4474) loss_oracle 0.5853 (0.5150) acc 53.1250 (49.9740) kd_loss 0.9043 (0.7348) lr 1.0628e-03 eta 0:19:01
epoch [26/50] batch [140/428] time 0.091 (0.107) data 0.000 (0.005) loss 1.6811 (1.6262) ce_loss 1.5693 (1.3561) teacher_loss 0.8865 (0.8901) loss_zs_kd 0.4595 (0.4464) loss_oracle 0.5649 (0.5129) acc 43.7500 (49.9330) kd_loss 0.8103 (0.7317) lr 1.0628e-03 eta 0:18:49
epoch [26/50] batch [160/428] time 0.107 (0.107) data 0.000 (0.004) loss 1.6042 (1.6193) ce_loss 1.2207 (1.3517) teacher_loss 0.8900 (0.8835) loss_zs_kd 0.4782 (0.4455) loss_oracle 0.4751 (0.5131) acc 50.0000 (50.4688) kd_loss 0.6414 (0.7343) lr 1.0628e-03 eta 0:18:44
epoch [26/50] batch [180/428] time 0.088 (0.106) data 0.000 (0.004) loss 1.6628 (1.6230) ce_loss 1.4102 (1.3517) teacher_loss 0.9352 (0.8863) loss_zs_kd 0.4105 (0.4476) loss_oracle 0.5223 (0.5129) acc 43.7500 (50.3646) kd_loss 0.7700 (0.7349) lr 1.0628e-03 eta 0:18:37
epoch [26/50] batch [200/428] time 0.090 (0.105) data 0.000 (0.003) loss 1.8193 (1.6281) ce_loss 1.7383 (1.3603) teacher_loss 1.1628 (0.8904) loss_zs_kd 0.3684 (0.4480) loss_oracle 0.4724 (0.5136) acc 28.1250 (49.7344) kd_loss 0.7416 (0.7390) lr 1.0628e-03 eta 0:18:22
epoch [26/50] batch [220/428] time 0.149 (0.105) data 0.000 (0.003) loss 1.5241 (1.6354) ce_loss 1.2373 (1.3706) teacher_loss 0.7981 (0.8980) loss_zs_kd 0.4242 (0.4483) loss_oracle 0.5139 (0.5133) acc 56.2500 (49.4602) kd_loss 0.6862 (0.7412) lr 1.0628e-03 eta 0:18:20
epoch [26/50] batch [240/428] time 0.093 (0.105) data 0.000 (0.003) loss 1.6828 (1.6337) ce_loss 1.2900 (1.3686) teacher_loss 0.9010 (0.8976) loss_zs_kd 0.5046 (0.4475) loss_oracle 0.5296 (0.5124) acc 46.8750 (49.6094) kd_loss 0.6605 (0.7420) lr 1.0628e-03 eta 0:18:20
epoch [26/50] batch [260/428] time 0.066 (0.105) data 0.000 (0.003) loss 1.8294 (1.6299) ce_loss 1.5674 (1.3660) teacher_loss 1.1086 (0.8928) loss_zs_kd 0.4805 (0.4494) loss_oracle 0.4806 (0.5124) acc 40.6250 (49.8077) kd_loss 0.8076 (0.7436) lr 1.0628e-03 eta 0:18:19
epoch [26/50] batch [280/428] time 0.088 (0.106) data 0.000 (0.002) loss 1.4397 (1.6259) ce_loss 1.2949 (1.3639) teacher_loss 0.6990 (0.8894) loss_zs_kd 0.4461 (0.4487) loss_oracle 0.5176 (0.5121) acc 56.2500 (49.8438) kd_loss 0.7661 (0.7456) lr 1.0628e-03 eta 0:18:23
epoch [26/50] batch [300/428] time 0.187 (0.105) data 0.000 (0.002) loss 1.5755 (1.6230) ce_loss 1.3418 (1.3603) teacher_loss 0.7550 (0.8859) loss_zs_kd 0.4453 (0.4499) loss_oracle 0.5978 (0.5122) acc 59.3750 (49.9583) kd_loss 0.6991 (0.7460) lr 1.0628e-03 eta 0:18:09
epoch [26/50] batch [320/428] time 0.082 (0.105) data 0.000 (0.002) loss 1.6076 (1.6211) ce_loss 1.1846 (1.3607) teacher_loss 0.8871 (0.8827) loss_zs_kd 0.4386 (0.4514) loss_oracle 0.5012 (0.5127) acc 56.2500 (50.1172) kd_loss 0.7756 (0.7472) lr 1.0628e-03 eta 0:18:10
epoch [26/50] batch [340/428] time 0.085 (0.105) data 0.000 (0.002) loss 1.8366 (1.6263) ce_loss 1.6797 (1.3648) teacher_loss 1.0875 (0.8873) loss_zs_kd 0.4875 (0.4524) loss_oracle 0.5054 (0.5128) acc 34.3750 (50.1287) kd_loss 0.7732 (0.7478) lr 1.0628e-03 eta 0:18:04
epoch [26/50] batch [360/428] time 0.068 (0.105) data 0.000 (0.002) loss 1.7838 (1.6257) ce_loss 1.4775 (1.3637) teacher_loss 1.0061 (0.8872) loss_zs_kd 0.5144 (0.4520) loss_oracle 0.5205 (0.5124) acc 46.8750 (50.3472) kd_loss 0.6594 (0.7477) lr 1.0628e-03 eta 0:18:10
epoch [26/50] batch [380/428] time 0.089 (0.105) data 0.000 (0.002) loss 1.6601 (1.6273) ce_loss 1.4990 (1.3664) teacher_loss 0.9665 (0.8883) loss_zs_kd 0.4532 (0.4532) loss_oracle 0.4670 (0.5124) acc 50.0000 (50.3043) kd_loss 0.6997 (0.7504) lr 1.0628e-03 eta 0:18:03
epoch [26/50] batch [400/428] time 0.087 (0.104) data 0.000 (0.002) loss 1.6762 (1.6275) ce_loss 1.4541 (1.3653) teacher_loss 0.7811 (0.8886) loss_zs_kd 0.4901 (0.4542) loss_oracle 0.6500 (0.5118) acc 40.6250 (50.3203) kd_loss 0.8625 (0.7499) lr 1.0628e-03 eta 0:17:56
epoch [26/50] batch [420/428] time 0.097 (0.104) data 0.000 (0.002) loss 1.4687 (1.6270) ce_loss 1.1738 (1.3649) teacher_loss 0.7869 (0.8883) loss_zs_kd 0.4396 (0.4545) loss_oracle 0.4620 (0.5115) acc 59.3750 (50.3646) kd_loss 0.6731 (0.7494) lr 1.0628e-03 eta 0:17:47
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,999
* accuracy: 51.0%
* error: 49.0%
* macro_f1: 38.5%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,568
* accuracy: 54.2%
* error: 45.8%
* macro_f1: 30.5%
******* Domain 1 best val acc:      51.7%, epoch: 24 *******
******* Domain 1 best val test acc: 52.4%, epoch: 24 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [27/50] batch [20/428] time 0.111 (0.136) data 0.000 (0.029) loss 1.7000 (1.6651) ce_loss 1.5312 (1.3732) teacher_loss 0.9378 (0.9290) loss_zs_kd 0.4670 (0.4678) loss_oracle 0.5287 (0.5022) acc 46.8750 (52.1875) kd_loss 0.7141 (0.7152) lr 1.0000e-03 eta 0:23:16
epoch [27/50] batch [40/428] time 0.097 (0.120) data 0.000 (0.015) loss 1.9827 (1.6494) ce_loss 1.6338 (1.3445) teacher_loss 1.2665 (0.9149) loss_zs_kd 0.4151 (0.4633) loss_oracle 0.5086 (0.5028) acc 53.1250 (52.2656) kd_loss 0.7309 (0.7281) lr 1.0000e-03 eta 0:20:31
epoch [27/50] batch [60/428] time 0.105 (0.115) data 0.001 (0.010) loss 1.7853 (1.6325) ce_loss 1.3691 (1.3420) teacher_loss 1.0737 (0.8989) loss_zs_kd 0.4441 (0.4552) loss_oracle 0.4896 (0.5060) acc 46.8750 (51.6667) kd_loss 0.5453 (0.7284) lr 1.0000e-03 eta 0:19:39
epoch [27/50] batch [80/428] time 0.114 (0.113) data 0.000 (0.008) loss 1.6856 (1.6374) ce_loss 1.5410 (1.3439) teacher_loss 0.9947 (0.9038) loss_zs_kd 0.4255 (0.4568) loss_oracle 0.4782 (0.5052) acc 40.6250 (51.4453) kd_loss 0.7483 (0.7315) lr 1.0000e-03 eta 0:19:11
epoch [27/50] batch [100/428] time 0.103 (0.111) data 0.000 (0.006) loss 1.6717 (1.6357) ce_loss 1.3359 (1.3405) teacher_loss 0.9683 (0.9071) loss_zs_kd 0.4239 (0.4539) loss_oracle 0.4915 (0.5016) acc 53.1250 (51.1562) kd_loss 0.6254 (0.7247) lr 1.0000e-03 eta 0:18:51
epoch [27/50] batch [120/428] time 0.115 (0.110) data 0.000 (0.005) loss 1.6522 (1.6250) ce_loss 1.2070 (1.3310) teacher_loss 0.8978 (0.8999) loss_zs_kd 0.5000 (0.4520) loss_oracle 0.5043 (0.4990) acc 56.2500 (51.3802) kd_loss 0.7105 (0.7208) lr 1.0000e-03 eta 0:18:38
epoch [27/50] batch [140/428] time 0.093 (0.110) data 0.000 (0.004) loss 1.5287 (1.6182) ce_loss 1.2158 (1.3236) teacher_loss 0.8046 (0.8926) loss_zs_kd 0.4170 (0.4558) loss_oracle 0.5156 (0.4977) acc 53.1250 (51.8080) kd_loss 0.7917 (0.7187) lr 1.0000e-03 eta 0:18:30
epoch [27/50] batch [160/428] time 0.111 (0.109) data 0.000 (0.004) loss 1.4878 (1.6149) ce_loss 1.2773 (1.3255) teacher_loss 0.7240 (0.8905) loss_zs_kd 0.5251 (0.4556) loss_oracle 0.5013 (0.4966) acc 59.3750 (51.9141) kd_loss 0.8180 (0.7186) lr 1.0000e-03 eta 0:18:24
epoch [27/50] batch [180/428] time 0.108 (0.109) data 0.000 (0.004) loss 1.5785 (1.6134) ce_loss 1.3115 (1.3277) teacher_loss 0.8410 (0.8885) loss_zs_kd 0.4412 (0.4581) loss_oracle 0.5169 (0.4959) acc 59.3750 (51.9271) kd_loss 0.7333 (0.7179) lr 1.0000e-03 eta 0:18:17
epoch [27/50] batch [200/428] time 0.084 (0.107) data 0.000 (0.003) loss 1.4367 (1.6143) ce_loss 1.0586 (1.3281) teacher_loss 0.7586 (0.8920) loss_zs_kd 0.3578 (0.4563) loss_oracle 0.4992 (0.4941) acc 56.2500 (51.7344) kd_loss 0.6148 (0.7170) lr 1.0000e-03 eta 0:17:55
epoch [27/50] batch [220/428] time 0.099 (0.106) data 0.000 (0.003) loss 1.6639 (1.6192) ce_loss 1.6289 (1.3363) teacher_loss 0.9595 (0.8968) loss_zs_kd 0.4458 (0.4582) loss_oracle 0.4815 (0.4933) acc 43.7500 (51.5767) kd_loss 0.7404 (0.7161) lr 1.0000e-03 eta 0:17:46
epoch [27/50] batch [240/428] time 0.153 (0.107) data 0.000 (0.003) loss 1.7347 (1.6195) ce_loss 1.5537 (1.3380) teacher_loss 0.9887 (0.8966) loss_zs_kd 0.4857 (0.4592) loss_oracle 0.5031 (0.4934) acc 46.8750 (51.3932) kd_loss 0.7499 (0.7177) lr 1.0000e-03 eta 0:17:54
epoch [27/50] batch [260/428] time 0.176 (0.108) data 0.000 (0.003) loss 1.6470 (1.6214) ce_loss 1.2246 (1.3385) teacher_loss 0.9507 (0.8984) loss_zs_kd 0.5085 (0.4604) loss_oracle 0.4421 (0.4928) acc 65.6250 (51.3221) kd_loss 0.7696 (0.7180) lr 1.0000e-03 eta 0:18:01
epoch [27/50] batch [280/428] time 0.074 (0.108) data 0.000 (0.002) loss 1.6609 (1.6224) ce_loss 1.3936 (1.3389) teacher_loss 0.9657 (0.8996) loss_zs_kd 0.4620 (0.4596) loss_oracle 0.4642 (0.4930) acc 53.1250 (51.4844) kd_loss 0.7296 (0.7164) lr 1.0000e-03 eta 0:18:01
epoch [27/50] batch [300/428] time 0.157 (0.107) data 0.000 (0.002) loss 1.5930 (1.6223) ce_loss 1.4141 (1.3389) teacher_loss 0.8564 (0.9008) loss_zs_kd 0.4604 (0.4586) loss_oracle 0.5065 (0.4921) acc 46.8750 (51.5312) kd_loss 0.6688 (0.7144) lr 1.0000e-03 eta 0:17:50
epoch [27/50] batch [320/428] time 0.094 (0.108) data 0.000 (0.002) loss 1.6936 (1.6221) ce_loss 1.5352 (1.3383) teacher_loss 0.9510 (0.9008) loss_zs_kd 0.5079 (0.4592) loss_oracle 0.4887 (0.4917) acc 50.0000 (51.5820) kd_loss 0.7241 (0.7151) lr 1.0000e-03 eta 0:17:56
epoch [27/50] batch [340/428] time 0.090 (0.109) data 0.000 (0.002) loss 1.6590 (1.6235) ce_loss 1.3770 (1.3409) teacher_loss 0.9632 (0.9035) loss_zs_kd 0.4583 (0.4595) loss_oracle 0.4666 (0.4902) acc 50.0000 (51.5165) kd_loss 0.7200 (0.7147) lr 1.0000e-03 eta 0:17:59
epoch [27/50] batch [360/428] time 0.117 (0.108) data 0.000 (0.002) loss 1.6581 (1.6245) ce_loss 1.3916 (1.3429) teacher_loss 0.9343 (0.9055) loss_zs_kd 0.4774 (0.4589) loss_oracle 0.4851 (0.4895) acc 59.3750 (51.4844) kd_loss 0.6597 (0.7137) lr 1.0000e-03 eta 0:17:52
epoch [27/50] batch [380/428] time 0.089 (0.108) data 0.000 (0.002) loss 1.6552 (1.6233) ce_loss 1.2090 (1.3426) teacher_loss 1.0076 (0.9054) loss_zs_kd 0.4379 (0.4579) loss_oracle 0.4287 (0.4889) acc 43.7500 (51.4474) kd_loss 0.6195 (0.7142) lr 1.0000e-03 eta 0:17:48
epoch [27/50] batch [400/428] time 0.103 (0.108) data 0.000 (0.002) loss 1.7464 (1.6252) ce_loss 1.6523 (1.3412) teacher_loss 1.0227 (0.9074) loss_zs_kd 0.4840 (0.4579) loss_oracle 0.4817 (0.4889) acc 37.5000 (51.5156) kd_loss 0.8568 (0.7143) lr 1.0000e-03 eta 0:17:44
epoch [27/50] batch [420/428] time 0.096 (0.108) data 0.000 (0.002) loss 1.5773 (1.6242) ce_loss 1.5010 (1.3405) teacher_loss 0.9673 (0.9080) loss_zs_kd 0.3608 (0.4574) loss_oracle 0.4296 (0.4874) acc 46.8750 (51.6741) kd_loss 0.7585 (0.7132) lr 1.0000e-03 eta 0:17:39
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,140
* accuracy: 53.4%
* error: 46.6%
* macro_f1: 38.9%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,460
* accuracy: 51.9%
* error: 48.1%
* macro_f1: 27.6%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [28/50] batch [20/428] time 0.110 (0.136) data 0.000 (0.029) loss 1.8107 (1.5935) ce_loss 1.4395 (1.2862) teacher_loss 1.1380 (0.8671) loss_zs_kd 0.4332 (0.4784) loss_oracle 0.4561 (0.4871) acc 53.1250 (53.5938) kd_loss 0.6864 (0.7019) lr 9.3721e-04 eta 0:22:12
epoch [28/50] batch [40/428] time 0.099 (0.120) data 0.000 (0.015) loss 1.8764 (1.6331) ce_loss 1.5840 (1.3313) teacher_loss 1.2383 (0.9252) loss_zs_kd 0.4485 (0.4571) loss_oracle 0.4138 (0.4794) acc 46.8750 (52.0312) kd_loss 0.7301 (0.6948) lr 9.3721e-04 eta 0:19:36
epoch [28/50] batch [60/428] time 0.110 (0.115) data 0.000 (0.010) loss 1.6394 (1.6346) ce_loss 1.3564 (1.3234) teacher_loss 0.9116 (0.9232) loss_zs_kd 0.4760 (0.4562) loss_oracle 0.4898 (0.4833) acc 53.1250 (52.3958) kd_loss 0.7403 (0.6917) lr 9.3721e-04 eta 0:18:47
epoch [28/50] batch [80/428] time 0.115 (0.113) data 0.000 (0.008) loss 1.5390 (1.6204) ce_loss 1.1035 (1.3102) teacher_loss 0.8179 (0.9118) loss_zs_kd 0.4413 (0.4510) loss_oracle 0.5005 (0.4831) acc 59.3750 (52.7734) kd_loss 0.6480 (0.6929) lr 9.3721e-04 eta 0:18:22
epoch [28/50] batch [100/428] time 0.113 (0.111) data 0.000 (0.006) loss 1.4841 (1.6276) ce_loss 1.2617 (1.3156) teacher_loss 0.7564 (0.9191) loss_zs_kd 0.4579 (0.4510) loss_oracle 0.4988 (0.4830) acc 56.2500 (52.6562) kd_loss 0.7626 (0.6932) lr 9.3721e-04 eta 0:18:06
epoch [28/50] batch [120/428] time 0.108 (0.110) data 0.000 (0.005) loss 1.8400 (1.6383) ce_loss 1.5635 (1.3240) teacher_loss 1.1292 (0.9303) loss_zs_kd 0.3988 (0.4471) loss_oracle 0.5113 (0.4845) acc 43.7500 (52.1615) kd_loss 0.6865 (0.6934) lr 9.3721e-04 eta 0:17:53
epoch [28/50] batch [140/428] time 0.108 (0.110) data 0.000 (0.004) loss 1.5716 (1.6393) ce_loss 1.2266 (1.3266) teacher_loss 0.8470 (0.9321) loss_zs_kd 0.4976 (0.4453) loss_oracle 0.4757 (0.4846) acc 59.3750 (51.8973) kd_loss 0.7653 (0.6932) lr 9.3721e-04 eta 0:17:44
epoch [28/50] batch [160/428] time 0.100 (0.109) data 0.000 (0.004) loss 1.5823 (1.6424) ce_loss 1.2148 (1.3309) teacher_loss 0.8075 (0.9326) loss_zs_kd 0.4769 (0.4474) loss_oracle 0.5363 (0.4860) acc 56.2500 (51.7188) kd_loss 0.7927 (0.6980) lr 9.3721e-04 eta 0:17:37
epoch [28/50] batch [180/428] time 0.095 (0.109) data 0.000 (0.004) loss 1.6174 (1.6418) ce_loss 1.1104 (1.3272) teacher_loss 0.9179 (0.9293) loss_zs_kd 0.5574 (0.4500) loss_oracle 0.4208 (0.4875) acc 53.1250 (51.5625) kd_loss 0.6859 (0.7013) lr 9.3721e-04 eta 0:17:28
epoch [28/50] batch [200/428] time 0.090 (0.106) data 0.000 (0.003) loss 1.6492 (1.6415) ce_loss 1.3682 (1.3266) teacher_loss 0.9217 (0.9267) loss_zs_kd 0.4218 (0.4515) loss_oracle 0.5165 (0.4890) acc 40.6250 (51.4688) kd_loss 0.7065 (0.7050) lr 9.3721e-04 eta 0:17:03
epoch [28/50] batch [220/428] time 0.162 (0.107) data 0.000 (0.003) loss 2.1080 (1.6472) ce_loss 1.7168 (1.3357) teacher_loss 1.3478 (0.9316) loss_zs_kd 0.4631 (0.4509) loss_oracle 0.5287 (0.4902) acc 43.7500 (51.3636) kd_loss 0.6939 (0.7104) lr 9.3721e-04 eta 0:17:12
epoch [28/50] batch [240/428] time 0.078 (0.107) data 0.000 (0.003) loss 1.4958 (1.6420) ce_loss 1.0986 (1.3297) teacher_loss 0.7326 (0.9251) loss_zs_kd 0.4897 (0.4534) loss_oracle 0.5184 (0.4901) acc 56.2500 (51.6146) kd_loss 0.6514 (0.7129) lr 9.3721e-04 eta 0:17:11
epoch [28/50] batch [260/428] time 0.143 (0.108) data 0.000 (0.003) loss 1.7008 (1.6388) ce_loss 1.4131 (1.3241) teacher_loss 0.9906 (0.9194) loss_zs_kd 0.4318 (0.4549) loss_oracle 0.4942 (0.4919) acc 46.8750 (51.6947) kd_loss 0.7217 (0.7172) lr 9.3721e-04 eta 0:17:17
epoch [28/50] batch [280/428] time 0.082 (0.108) data 0.000 (0.002) loss 1.8041 (1.6364) ce_loss 1.5391 (1.3256) teacher_loss 1.0512 (0.9161) loss_zs_kd 0.4515 (0.4556) loss_oracle 0.5272 (0.4925) acc 37.5000 (51.6518) kd_loss 0.6923 (0.7219) lr 9.3721e-04 eta 0:17:08
epoch [28/50] batch [300/428] time 0.082 (0.107) data 0.000 (0.002) loss 1.5398 (1.6368) ce_loss 1.0752 (1.3261) teacher_loss 0.8236 (0.9149) loss_zs_kd 0.5068 (0.4574) loss_oracle 0.4628 (0.4932) acc 62.5000 (51.6042) kd_loss 0.6490 (0.7248) lr 9.3721e-04 eta 0:17:02
epoch [28/50] batch [320/428] time 0.078 (0.108) data 0.000 (0.002) loss 1.5954 (1.6370) ce_loss 1.2461 (1.3291) teacher_loss 0.8650 (0.9140) loss_zs_kd 0.4627 (0.4591) loss_oracle 0.4990 (0.4935) acc 62.5000 (51.6113) kd_loss 0.8605 (0.7314) lr 9.3721e-04 eta 0:17:04
epoch [28/50] batch [340/428] time 0.165 (0.108) data 0.000 (0.002) loss 1.4905 (1.6378) ce_loss 1.2568 (1.3308) teacher_loss 0.7991 (0.9133) loss_zs_kd 0.4292 (0.4612) loss_oracle 0.4768 (0.4939) acc 53.1250 (51.4614) kd_loss 0.8554 (0.7379) lr 9.3721e-04 eta 0:17:09
epoch [28/50] batch [360/428] time 0.107 (0.108) data 0.000 (0.002) loss 1.2678 (1.6378) ce_loss 0.8306 (1.3324) teacher_loss 0.6083 (0.9126) loss_zs_kd 0.3815 (0.4621) loss_oracle 0.4688 (0.4941) acc 68.7500 (51.4931) kd_loss 0.6882 (0.7412) lr 9.3721e-04 eta 0:17:05
epoch [28/50] batch [380/428] time 0.109 (0.108) data 0.000 (0.002) loss 1.4739 (1.6358) ce_loss 1.2217 (1.3325) teacher_loss 0.7024 (0.9103) loss_zs_kd 0.5217 (0.4620) loss_oracle 0.5106 (0.4944) acc 59.3750 (51.4967) kd_loss 0.8993 (0.7463) lr 9.3721e-04 eta 0:17:01
epoch [28/50] batch [400/428] time 0.107 (0.108) data 0.000 (0.002) loss 1.9905 (1.6367) ce_loss 1.7695 (1.3331) teacher_loss 1.2066 (0.9103) loss_zs_kd 0.4378 (0.4627) loss_oracle 0.5650 (0.4951) acc 46.8750 (51.4922) kd_loss 0.9141 (0.7498) lr 9.3721e-04 eta 0:16:57
epoch [28/50] batch [420/428] time 0.095 (0.107) data 0.000 (0.002) loss 1.6792 (1.6379) ce_loss 1.1787 (1.3355) teacher_loss 0.9450 (0.9103) loss_zs_kd 0.4892 (0.4628) loss_oracle 0.4896 (0.4962) acc 50.0000 (51.4658) kd_loss 0.7347 (0.7547) lr 9.3721e-04 eta 0:16:52
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,990
* accuracy: 50.9%
* error: 49.1%
* macro_f1: 37.1%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,445
* accuracy: 51.6%
* error: 48.4%
* macro_f1: 30.7%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [29/50] batch [20/428] time 0.105 (0.135) data 0.000 (0.027) loss 1.7351 (1.6767) ce_loss 1.2715 (1.3758) teacher_loss 1.0617 (0.9318) loss_zs_kd 0.4609 (0.4915) loss_oracle 0.4430 (0.4992) acc 56.2500 (49.3750) kd_loss 0.7327 (0.8058) lr 8.7467e-04 eta 0:21:04
epoch [29/50] batch [40/428] time 0.102 (0.119) data 0.000 (0.014) loss 1.5567 (1.6321) ce_loss 1.3770 (1.3422) teacher_loss 0.9125 (0.8923) loss_zs_kd 0.4246 (0.4884) loss_oracle 0.4319 (0.4955) acc 46.8750 (50.0000) kd_loss 0.7855 (0.8250) lr 8.7467e-04 eta 0:18:39
epoch [29/50] batch [60/428] time 0.110 (0.115) data 0.001 (0.009) loss 1.6139 (1.6293) ce_loss 1.6299 (1.3305) teacher_loss 0.9365 (0.8975) loss_zs_kd 0.3866 (0.4738) loss_oracle 0.4842 (0.4949) acc 34.3750 (51.8750) kd_loss 0.9232 (0.8194) lr 8.7467e-04 eta 0:17:57
epoch [29/50] batch [80/428] time 0.106 (0.113) data 0.000 (0.007) loss 1.5657 (1.6282) ce_loss 1.2754 (1.3394) teacher_loss 0.6831 (0.8898) loss_zs_kd 0.6016 (0.4796) loss_oracle 0.5819 (0.4986) acc 53.1250 (51.6406) kd_loss 0.9006 (0.8283) lr 8.7467e-04 eta 0:17:33
epoch [29/50] batch [100/428] time 0.102 (0.111) data 0.000 (0.006) loss 1.5584 (1.6205) ce_loss 1.2275 (1.3282) teacher_loss 0.7542 (0.8839) loss_zs_kd 0.4842 (0.4820) loss_oracle 0.5621 (0.4957) acc 46.8750 (51.6250) kd_loss 0.8815 (0.8291) lr 8.7467e-04 eta 0:17:17
epoch [29/50] batch [120/428] time 0.108 (0.110) data 0.000 (0.005) loss 1.6399 (1.6294) ce_loss 1.4355 (1.3440) teacher_loss 0.9055 (0.8901) loss_zs_kd 0.5139 (0.4840) loss_oracle 0.4775 (0.4972) acc 56.2500 (51.1458) kd_loss 0.7126 (0.8326) lr 8.7467e-04 eta 0:17:06
epoch [29/50] batch [140/428] time 0.109 (0.110) data 0.000 (0.004) loss 1.5168 (1.6300) ce_loss 1.2432 (1.3489) teacher_loss 0.7685 (0.8885) loss_zs_kd 0.4467 (0.4846) loss_oracle 0.5250 (0.4992) acc 59.3750 (50.9375) kd_loss 0.7980 (0.8355) lr 8.7467e-04 eta 0:16:56
epoch [29/50] batch [160/428] time 0.108 (0.109) data 0.000 (0.004) loss 1.7027 (1.6321) ce_loss 1.4727 (1.3596) teacher_loss 0.9415 (0.8923) loss_zs_kd 0.5108 (0.4842) loss_oracle 0.5059 (0.4978) acc 40.6250 (50.6055) kd_loss 0.9658 (0.8432) lr 8.7467e-04 eta 0:16:50
epoch [29/50] batch [180/428] time 0.079 (0.107) data 0.000 (0.003) loss 1.3726 (1.6311) ce_loss 1.1729 (1.3609) teacher_loss 0.6341 (0.8906) loss_zs_kd 0.4989 (0.4839) loss_oracle 0.4891 (0.4985) acc 53.1250 (50.5208) kd_loss 0.8914 (0.8456) lr 8.7467e-04 eta 0:16:25
epoch [29/50] batch [200/428] time 0.086 (0.106) data 0.000 (0.003) loss 1.5339 (1.6267) ce_loss 1.2266 (1.3551) teacher_loss 0.7873 (0.8865) loss_zs_kd 0.4162 (0.4837) loss_oracle 0.5386 (0.4984) acc 62.5000 (51.0000) kd_loss 0.9021 (0.8427) lr 8.7467e-04 eta 0:16:17
epoch [29/50] batch [220/428] time 0.075 (0.107) data 0.000 (0.003) loss 1.6958 (1.6246) ce_loss 1.3633 (1.3505) teacher_loss 0.8967 (0.8854) loss_zs_kd 0.5422 (0.4806) loss_oracle 0.5280 (0.4990) acc 46.8750 (51.1080) kd_loss 0.8263 (0.8396) lr 8.7467e-04 eta 0:16:22
epoch [29/50] batch [240/428] time 0.075 (0.107) data 0.000 (0.002) loss 1.6283 (1.6260) ce_loss 1.4688 (1.3497) teacher_loss 0.8506 (0.8860) loss_zs_kd 0.4507 (0.4784) loss_oracle 0.5523 (0.5008) acc 43.7500 (51.0417) kd_loss 0.8041 (0.8370) lr 8.7467e-04 eta 0:16:25
epoch [29/50] batch [260/428] time 0.153 (0.108) data 0.000 (0.002) loss 1.4605 (1.6263) ce_loss 1.2188 (1.3530) teacher_loss 0.7241 (0.8851) loss_zs_kd 0.4434 (0.4777) loss_oracle 0.5147 (0.5024) acc 53.1250 (50.8774) kd_loss 0.8601 (0.8365) lr 8.7467e-04 eta 0:16:29
epoch [29/50] batch [280/428] time 0.088 (0.106) data 0.000 (0.002) loss 1.8212 (1.6293) ce_loss 1.6035 (1.3570) teacher_loss 1.0420 (0.8881) loss_zs_kd 0.4586 (0.4769) loss_oracle 0.5500 (0.5027) acc 43.7500 (50.7589) kd_loss 0.8187 (0.8331) lr 8.7467e-04 eta 0:16:09
epoch [29/50] batch [300/428] time 0.152 (0.107) data 0.000 (0.002) loss 1.7995 (1.6316) ce_loss 1.7080 (1.3584) teacher_loss 0.9375 (0.8884) loss_zs_kd 0.5730 (0.4770) loss_oracle 0.5755 (0.5047) acc 31.2500 (50.6042) kd_loss 0.8668 (0.8313) lr 8.7467e-04 eta 0:16:14
epoch [29/50] batch [320/428] time 0.143 (0.107) data 0.000 (0.002) loss 1.4148 (1.6293) ce_loss 1.1289 (1.3572) teacher_loss 0.6441 (0.8859) loss_zs_kd 0.4847 (0.4765) loss_oracle 0.5284 (0.5052) acc 56.2500 (50.6934) kd_loss 0.8717 (0.8307) lr 8.7467e-04 eta 0:16:16
epoch [29/50] batch [340/428] time 0.100 (0.108) data 0.000 (0.002) loss 1.5095 (1.6286) ce_loss 1.1348 (1.3563) teacher_loss 0.7648 (0.8843) loss_zs_kd 0.4631 (0.4761) loss_oracle 0.5132 (0.5063) acc 59.3750 (50.7169) kd_loss 0.8225 (0.8303) lr 8.7467e-04 eta 0:16:16
epoch [29/50] batch [360/428] time 0.101 (0.107) data 0.000 (0.002) loss 1.5743 (1.6326) ce_loss 1.3154 (1.3593) teacher_loss 0.7828 (0.8875) loss_zs_kd 0.4512 (0.4755) loss_oracle 0.5659 (0.5074) acc 53.1250 (50.5903) kd_loss 0.9402 (0.8311) lr 8.7467e-04 eta 0:16:12
epoch [29/50] batch [380/428] time 0.099 (0.107) data 0.000 (0.002) loss 1.5991 (1.6341) ce_loss 1.4141 (1.3595) teacher_loss 0.8955 (0.8890) loss_zs_kd 0.4046 (0.4749) loss_oracle 0.5013 (0.5077) acc 46.8750 (50.6250) kd_loss 0.8476 (0.8304) lr 8.7467e-04 eta 0:16:09
epoch [29/50] batch [400/428] time 0.100 (0.107) data 0.000 (0.002) loss 1.6831 (1.6366) ce_loss 1.2217 (1.3620) teacher_loss 0.9945 (0.8908) loss_zs_kd 0.4438 (0.4746) loss_oracle 0.4667 (0.5085) acc 62.5000 (50.6406) kd_loss 0.7101 (0.8319) lr 8.7467e-04 eta 0:16:06
epoch [29/50] batch [420/428] time 0.096 (0.107) data 0.000 (0.002) loss 1.6309 (1.6368) ce_loss 1.4316 (1.3635) teacher_loss 0.8310 (0.8904) loss_zs_kd 0.4761 (0.4738) loss_oracle 0.5619 (0.5095) acc 40.6250 (50.4762) kd_loss 0.9239 (0.8336) lr 8.7467e-04 eta 0:16:02
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,070
* accuracy: 52.2%
* error: 47.8%
* macro_f1: 37.3%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,269
* accuracy: 47.9%
* error: 52.1%
* macro_f1: 30.0%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [30/50] batch [20/428] time 0.104 (0.133) data 0.000 (0.028) loss 1.4877 (1.6688) ce_loss 1.4316 (1.4016) teacher_loss 0.7156 (0.9266) loss_zs_kd 0.4436 (0.4701) loss_oracle 0.5503 (0.5071) acc 40.6250 (48.9062) kd_loss 0.9319 (0.8481) lr 8.1262e-04 eta 0:19:56
epoch [30/50] batch [40/428] time 0.100 (0.119) data 0.000 (0.014) loss 1.7955 (1.6698) ce_loss 1.5146 (1.3939) teacher_loss 1.0373 (0.9326) loss_zs_kd 0.5256 (0.4676) loss_oracle 0.4955 (0.5034) acc 46.8750 (49.6094) kd_loss 0.7529 (0.8585) lr 8.1262e-04 eta 0:17:46
epoch [30/50] batch [60/428] time 0.109 (0.115) data 0.001 (0.009) loss 1.7327 (1.6587) ce_loss 1.5820 (1.3863) teacher_loss 0.9944 (0.9296) loss_zs_kd 0.3984 (0.4606) loss_oracle 0.5391 (0.4988) acc 50.0000 (50.3646) kd_loss 0.8987 (0.8451) lr 8.1262e-04 eta 0:17:06
epoch [30/50] batch [80/428] time 0.115 (0.112) data 0.000 (0.007) loss 1.4352 (1.6572) ce_loss 1.2500 (1.3770) teacher_loss 0.7272 (0.9262) loss_zs_kd 0.4374 (0.4635) loss_oracle 0.4893 (0.4992) acc 59.3750 (51.0156) kd_loss 0.8925 (0.8344) lr 8.1262e-04 eta 0:16:41
epoch [30/50] batch [100/428] time 0.110 (0.111) data 0.000 (0.006) loss 1.6252 (1.6594) ce_loss 1.4043 (1.3826) teacher_loss 0.9047 (0.9240) loss_zs_kd 0.4765 (0.4652) loss_oracle 0.4823 (0.5028) acc 46.8750 (51.1875) kd_loss 0.8200 (0.8335) lr 8.1262e-04 eta 0:16:26
epoch [30/50] batch [120/428] time 0.100 (0.110) data 0.000 (0.005) loss 1.2462 (1.6527) ce_loss 1.1143 (1.3825) teacher_loss 0.5602 (0.9157) loss_zs_kd 0.4566 (0.4661) loss_oracle 0.4577 (0.5039) acc 68.7500 (51.1198) kd_loss 0.7355 (0.8302) lr 8.1262e-04 eta 0:16:15
epoch [30/50] batch [140/428] time 0.105 (0.109) data 0.000 (0.004) loss 1.5549 (1.6416) ce_loss 1.2773 (1.3721) teacher_loss 0.8519 (0.9054) loss_zs_kd 0.4920 (0.4656) loss_oracle 0.4570 (0.5034) acc 50.0000 (51.4062) kd_loss 0.7784 (0.8273) lr 8.1262e-04 eta 0:16:06
epoch [30/50] batch [160/428] time 0.104 (0.108) data 0.000 (0.004) loss 1.7420 (1.6414) ce_loss 1.5674 (1.3772) teacher_loss 1.0345 (0.9059) loss_zs_kd 0.3791 (0.4625) loss_oracle 0.5179 (0.5042) acc 43.7500 (50.9766) kd_loss 0.7601 (0.8285) lr 8.1262e-04 eta 0:15:57
epoch [30/50] batch [180/428] time 0.080 (0.106) data 0.000 (0.003) loss 1.4943 (1.6403) ce_loss 1.4121 (1.3755) teacher_loss 0.6974 (0.9006) loss_zs_kd 0.3993 (0.4652) loss_oracle 0.5973 (0.5071) acc 59.3750 (51.1285) kd_loss 0.8918 (0.8275) lr 8.1262e-04 eta 0:15:35
epoch [30/50] batch [200/428] time 0.074 (0.107) data 0.000 (0.003) loss 1.7465 (1.6398) ce_loss 1.4893 (1.3764) teacher_loss 0.8810 (0.8977) loss_zs_kd 0.5389 (0.4673) loss_oracle 0.5960 (0.5085) acc 34.3750 (50.9844) kd_loss 0.9081 (0.8281) lr 8.1262e-04 eta 0:15:38
epoch [30/50] batch [220/428] time 0.075 (0.107) data 0.000 (0.003) loss 1.5091 (1.6327) ce_loss 1.2930 (1.3674) teacher_loss 0.7426 (0.8891) loss_zs_kd 0.5364 (0.4683) loss_oracle 0.4982 (0.5095) acc 40.6250 (51.0653) kd_loss 0.8549 (0.8256) lr 8.1262e-04 eta 0:15:39
epoch [30/50] batch [240/428] time 0.077 (0.108) data 0.000 (0.003) loss 1.5819 (1.6381) ce_loss 1.4873 (1.3729) teacher_loss 0.8024 (0.8927) loss_zs_kd 0.4744 (0.4684) loss_oracle 0.5423 (0.5112) acc 40.6250 (50.9896) kd_loss 0.7881 (0.8249) lr 8.1262e-04 eta 0:15:42
epoch [30/50] batch [260/428] time 0.085 (0.107) data 0.000 (0.002) loss 1.3847 (1.6324) ce_loss 1.1914 (1.3661) teacher_loss 0.7543 (0.8876) loss_zs_kd 0.4027 (0.4666) loss_oracle 0.4291 (0.5115) acc 56.2500 (51.1058) kd_loss 0.6341 (0.8220) lr 8.1262e-04 eta 0:15:36
epoch [30/50] batch [280/428] time 0.077 (0.107) data 0.000 (0.002) loss 1.6552 (1.6322) ce_loss 1.1211 (1.3646) teacher_loss 0.9808 (0.8883) loss_zs_kd 0.4289 (0.4659) loss_oracle 0.4600 (0.5110) acc 65.6250 (51.0826) kd_loss 0.5778 (0.8194) lr 8.1262e-04 eta 0:15:30
epoch [30/50] batch [300/428] time 0.087 (0.107) data 0.000 (0.002) loss 1.4634 (1.6321) ce_loss 1.0723 (1.3654) teacher_loss 0.8357 (0.8883) loss_zs_kd 0.4204 (0.4645) loss_oracle 0.4174 (0.5115) acc 62.5000 (51.1875) kd_loss 0.6335 (0.8179) lr 8.1262e-04 eta 0:15:31
epoch [30/50] batch [320/428] time 0.126 (0.108) data 0.000 (0.002) loss 1.6207 (1.6319) ce_loss 1.2744 (1.3666) teacher_loss 0.8096 (0.8892) loss_zs_kd 0.5249 (0.4635) loss_oracle 0.5487 (0.5110) acc 59.3750 (51.1719) kd_loss 0.8753 (0.8163) lr 8.1262e-04 eta 0:15:36
epoch [30/50] batch [340/428] time 0.108 (0.108) data 0.000 (0.002) loss 1.4847 (1.6312) ce_loss 1.4189 (1.3671) teacher_loss 0.7144 (0.8887) loss_zs_kd 0.4871 (0.4625) loss_oracle 0.5267 (0.5113) acc 56.2500 (51.2408) kd_loss 0.8208 (0.8155) lr 8.1262e-04 eta 0:15:30
epoch [30/50] batch [360/428] time 0.104 (0.107) data 0.000 (0.002) loss 1.5227 (1.6345) ce_loss 1.3076 (1.3689) teacher_loss 0.8224 (0.8911) loss_zs_kd 0.4732 (0.4628) loss_oracle 0.4637 (0.5120) acc 43.7500 (51.2240) kd_loss 0.8704 (0.8145) lr 8.1262e-04 eta 0:15:26
epoch [30/50] batch [380/428] time 0.104 (0.107) data 0.000 (0.002) loss 1.6533 (1.6338) ce_loss 1.3066 (1.3685) teacher_loss 0.9644 (0.8903) loss_zs_kd 0.4943 (0.4627) loss_oracle 0.4418 (0.5121) acc 56.2500 (51.2582) kd_loss 0.7446 (0.8136) lr 8.1262e-04 eta 0:15:22
epoch [30/50] batch [400/428] time 0.107 (0.107) data 0.000 (0.002) loss 1.4933 (1.6317) ce_loss 1.3057 (1.3659) teacher_loss 0.7688 (0.8888) loss_zs_kd 0.3730 (0.4625) loss_oracle 0.5380 (0.5117) acc 53.1250 (51.3047) kd_loss 0.8663 (0.8108) lr 8.1262e-04 eta 0:15:19
epoch [30/50] batch [420/428] time 0.102 (0.107) data 0.000 (0.002) loss 1.7442 (1.6344) ce_loss 1.5020 (1.3683) teacher_loss 1.0540 (0.8903) loss_zs_kd 0.3471 (0.4620) loss_oracle 0.5167 (0.5131) acc 46.8750 (51.2054) kd_loss 0.7542 (0.8091) lr 8.1262e-04 eta 0:15:15
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,947
* accuracy: 50.2%
* error: 49.8%
* macro_f1: 37.7%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,630
* accuracy: 55.5%
* error: 44.5%
* macro_f1: 32.3%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [31/50] batch [20/428] time 0.102 (0.132) data 0.000 (0.029) loss 1.9023 (1.6937) ce_loss 1.5459 (1.4314) teacher_loss 1.1122 (0.9513) loss_zs_kd 0.5144 (0.4632) loss_oracle 0.5329 (0.5108) acc 43.7500 (47.5000) kd_loss 0.7716 (0.7865) lr 7.5131e-04 eta 0:18:44
epoch [31/50] batch [40/428] time 0.095 (0.118) data 0.000 (0.015) loss 1.4608 (1.6639) ce_loss 1.3262 (1.3969) teacher_loss 0.7335 (0.9206) loss_zs_kd 0.4521 (0.4689) loss_oracle 0.5013 (0.5089) acc 50.0000 (49.5312) kd_loss 0.7726 (0.7907) lr 7.5131e-04 eta 0:16:45
epoch [31/50] batch [60/428] time 0.104 (0.114) data 0.001 (0.010) loss 1.5761 (1.6591) ce_loss 1.3760 (1.3955) teacher_loss 0.8341 (0.9143) loss_zs_kd 0.4813 (0.4631) loss_oracle 0.5013 (0.5133) acc 43.7500 (48.9583) kd_loss 0.9323 (0.8020) lr 7.5131e-04 eta 0:16:06
epoch [31/50] batch [80/428] time 0.102 (0.111) data 0.000 (0.008) loss 1.6321 (1.6634) ce_loss 1.3721 (1.3904) teacher_loss 0.9342 (0.9215) loss_zs_kd 0.3860 (0.4653) loss_oracle 0.5048 (0.5093) acc 43.7500 (49.3750) kd_loss 0.8133 (0.7929) lr 7.5131e-04 eta 0:15:38
epoch [31/50] batch [100/428] time 0.102 (0.109) data 0.000 (0.006) loss 1.6650 (1.6670) ce_loss 1.5703 (1.3973) teacher_loss 0.9174 (0.9240) loss_zs_kd 0.4890 (0.4670) loss_oracle 0.5030 (0.5095) acc 40.6250 (49.1875) kd_loss 0.9262 (0.7927) lr 7.5131e-04 eta 0:15:25
epoch [31/50] batch [120/428] time 0.097 (0.108) data 0.000 (0.005) loss 1.4852 (1.6511) ce_loss 1.2178 (1.3796) teacher_loss 0.6586 (0.9098) loss_zs_kd 0.5005 (0.4671) loss_oracle 0.5763 (0.5078) acc 50.0000 (50.3385) kd_loss 0.8913 (0.7912) lr 7.5131e-04 eta 0:15:11
epoch [31/50] batch [140/428] time 0.091 (0.107) data 0.000 (0.004) loss 1.5039 (1.6485) ce_loss 1.2275 (1.3742) teacher_loss 0.7382 (0.9049) loss_zs_kd 0.4505 (0.4738) loss_oracle 0.5404 (0.5067) acc 56.2500 (50.6027) kd_loss 0.9060 (0.7929) lr 7.5131e-04 eta 0:15:04
epoch [31/50] batch [160/428] time 0.076 (0.105) data 0.000 (0.004) loss 1.7021 (1.6430) ce_loss 1.2480 (1.3681) teacher_loss 0.9533 (0.8983) loss_zs_kd 0.4973 (0.4759) loss_oracle 0.5001 (0.5067) acc 53.1250 (50.7227) kd_loss 0.6856 (0.7884) lr 7.5131e-04 eta 0:14:45
epoch [31/50] batch [180/428] time 0.172 (0.106) data 0.000 (0.004) loss 1.6202 (1.6371) ce_loss 1.4023 (1.3596) teacher_loss 0.8619 (0.8956) loss_zs_kd 0.4595 (0.4751) loss_oracle 0.5286 (0.5040) acc 50.0000 (50.8854) kd_loss 0.7160 (0.7818) lr 7.5131e-04 eta 0:14:50
epoch [31/50] batch [200/428] time 0.075 (0.105) data 0.000 (0.003) loss 1.6704 (1.6357) ce_loss 1.5000 (1.3650) teacher_loss 0.9147 (0.8929) loss_zs_kd 0.4705 (0.4782) loss_oracle 0.5204 (0.5037) acc 53.1250 (50.8594) kd_loss 0.7651 (0.7789) lr 7.5131e-04 eta 0:14:41
epoch [31/50] batch [220/428] time 0.106 (0.106) data 0.000 (0.003) loss 1.6994 (1.6308) ce_loss 1.4531 (1.3616) teacher_loss 1.0074 (0.8882) loss_zs_kd 0.4766 (0.4814) loss_oracle 0.4537 (0.5019) acc 50.0000 (50.9659) kd_loss 0.7030 (0.7748) lr 7.5131e-04 eta 0:14:44
epoch [31/50] batch [240/428] time 0.087 (0.107) data 0.000 (0.003) loss 1.5128 (1.6276) ce_loss 1.2812 (1.3605) teacher_loss 0.7060 (0.8846) loss_zs_kd 0.5756 (0.4831) loss_oracle 0.5190 (0.5015) acc 59.3750 (50.9115) kd_loss 0.8233 (0.7719) lr 7.5131e-04 eta 0:14:47
epoch [31/50] batch [260/428] time 0.082 (0.105) data 0.000 (0.003) loss 1.4679 (1.6280) ce_loss 1.0605 (1.3611) teacher_loss 0.7945 (0.8838) loss_zs_kd 0.4437 (0.4854) loss_oracle 0.4516 (0.5015) acc 65.6250 (51.0096) kd_loss 0.6837 (0.7712) lr 7.5131e-04 eta 0:14:31
epoch [31/50] batch [280/428] time 0.074 (0.106) data 0.000 (0.002) loss 1.5946 (1.6305) ce_loss 1.4521 (1.3641) teacher_loss 0.8239 (0.8858) loss_zs_kd 0.4942 (0.4845) loss_oracle 0.5237 (0.5025) acc 43.7500 (50.8147) kd_loss 0.7788 (0.7719) lr 7.5131e-04 eta 0:14:36
epoch [31/50] batch [300/428] time 0.086 (0.106) data 0.000 (0.002) loss 1.3149 (1.6248) ce_loss 1.0596 (1.3593) teacher_loss 0.5816 (0.8792) loss_zs_kd 0.4901 (0.4863) loss_oracle 0.4883 (0.5025) acc 68.7500 (51.0104) kd_loss 0.7904 (0.7706) lr 7.5131e-04 eta 0:14:39
epoch [31/50] batch [320/428] time 0.074 (0.107) data 0.000 (0.002) loss 1.6884 (1.6219) ce_loss 1.4219 (1.3584) teacher_loss 0.9785 (0.8768) loss_zs_kd 0.5199 (0.4868) loss_oracle 0.4499 (0.5018) acc 50.0000 (51.0352) kd_loss 0.6484 (0.7706) lr 7.5131e-04 eta 0:14:38
epoch [31/50] batch [340/428] time 0.107 (0.106) data 0.000 (0.002) loss 1.4688 (1.6208) ce_loss 1.2803 (1.3562) teacher_loss 0.7027 (0.8762) loss_zs_kd 0.5968 (0.4864) loss_oracle 0.4677 (0.5014) acc 53.1250 (51.0662) kd_loss 0.6959 (0.7683) lr 7.5131e-04 eta 0:14:33
epoch [31/50] batch [360/428] time 0.110 (0.106) data 0.000 (0.002) loss 1.4122 (1.6182) ce_loss 1.2979 (1.3552) teacher_loss 0.6816 (0.8732) loss_zs_kd 0.4267 (0.4863) loss_oracle 0.5172 (0.5019) acc 46.8750 (51.1458) kd_loss 0.8061 (0.7677) lr 7.5131e-04 eta 0:14:30
epoch [31/50] batch [380/428] time 0.098 (0.106) data 0.000 (0.002) loss 1.7482 (1.6162) ce_loss 1.6191 (1.3561) teacher_loss 1.0065 (0.8708) loss_zs_kd 0.5510 (0.4868) loss_oracle 0.4662 (0.5020) acc 50.0000 (51.0855) kd_loss 0.7071 (0.7676) lr 7.5131e-04 eta 0:14:27
epoch [31/50] batch [400/428] time 0.103 (0.106) data 0.001 (0.002) loss 1.3945 (1.6143) ce_loss 1.1348 (1.3531) teacher_loss 0.5860 (0.8683) loss_zs_kd 0.5807 (0.4873) loss_oracle 0.5181 (0.5023) acc 56.2500 (51.2031) kd_loss 0.7342 (0.7657) lr 7.5131e-04 eta 0:14:24
epoch [31/50] batch [420/428] time 0.098 (0.106) data 0.000 (0.002) loss 1.7680 (1.6135) ce_loss 1.5723 (1.3494) teacher_loss 1.0448 (0.8677) loss_zs_kd 0.5004 (0.4873) loss_oracle 0.4730 (0.5022) acc 50.0000 (51.3690) kd_loss 0.7748 (0.7637) lr 7.5131e-04 eta 0:14:20
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,065
* accuracy: 52.2%
* error: 47.8%
* macro_f1: 40.5%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,667
* accuracy: 56.3%
* error: 43.7%
* macro_f1: 32.3%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [32/50] batch [20/428] time 0.110 (0.129) data 0.000 (0.024) loss 1.2421 (1.5938) ce_loss 0.9570 (1.3542) teacher_loss 0.5644 (0.8474) loss_zs_kd 0.4011 (0.4870) loss_oracle 0.4771 (0.5029) acc 65.6250 (49.2188) kd_loss 0.7773 (0.7735) lr 6.9098e-04 eta 0:17:25
epoch [32/50] batch [40/428] time 0.114 (0.115) data 0.000 (0.012) loss 1.5930 (1.5884) ce_loss 1.3018 (1.3344) teacher_loss 0.8802 (0.8465) loss_zs_kd 0.5145 (0.4959) loss_oracle 0.4555 (0.4940) acc 50.0000 (50.0000) kd_loss 0.7719 (0.7558) lr 6.9098e-04 eta 0:15:34
epoch [32/50] batch [60/428] time 0.107 (0.112) data 0.001 (0.008) loss 1.4679 (1.5835) ce_loss 1.1973 (1.3120) teacher_loss 0.6920 (0.8350) loss_zs_kd 0.4974 (0.5020) loss_oracle 0.5272 (0.4975) acc 59.3750 (50.9375) kd_loss 0.7770 (0.7529) lr 6.9098e-04 eta 0:15:06
epoch [32/50] batch [80/428] time 0.096 (0.111) data 0.000 (0.006) loss 1.5209 (1.5754) ce_loss 1.1973 (1.3125) teacher_loss 0.7629 (0.8247) loss_zs_kd 0.5244 (0.5009) loss_oracle 0.4959 (0.5002) acc 65.6250 (51.4062) kd_loss 0.7420 (0.7555) lr 6.9098e-04 eta 0:14:50
epoch [32/50] batch [100/428] time 0.102 (0.109) data 0.000 (0.005) loss 1.5439 (1.5801) ce_loss 1.4141 (1.3232) teacher_loss 0.8333 (0.8304) loss_zs_kd 0.4957 (0.4981) loss_oracle 0.4628 (0.5007) acc 56.2500 (51.5312) kd_loss 0.7684 (0.7588) lr 6.9098e-04 eta 0:14:38
epoch [32/50] batch [120/428] time 0.105 (0.109) data 0.000 (0.004) loss 1.4257 (1.5861) ce_loss 1.4248 (1.3361) teacher_loss 0.7191 (0.8381) loss_zs_kd 0.4340 (0.4924) loss_oracle 0.4896 (0.5019) acc 46.8750 (51.0677) kd_loss 0.8804 (0.7547) lr 6.9098e-04 eta 0:14:34
epoch [32/50] batch [140/428] time 0.115 (0.109) data 0.000 (0.004) loss 1.5050 (1.5837) ce_loss 1.1162 (1.3363) teacher_loss 0.7682 (0.8367) loss_zs_kd 0.5537 (0.4922) loss_oracle 0.4599 (0.5009) acc 68.7500 (51.3170) kd_loss 0.6552 (0.7518) lr 6.9098e-04 eta 0:14:27
epoch [32/50] batch [160/428] time 0.091 (0.107) data 0.000 (0.003) loss 1.3629 (1.5908) ce_loss 1.2090 (1.3426) teacher_loss 0.5748 (0.8444) loss_zs_kd 0.4365 (0.4879) loss_oracle 0.5699 (0.5024) acc 50.0000 (50.8203) kd_loss 0.9364 (0.7504) lr 6.9098e-04 eta 0:14:09
epoch [32/50] batch [180/428] time 0.077 (0.106) data 0.000 (0.003) loss 1.5610 (1.5967) ce_loss 1.3613 (1.3452) teacher_loss 0.8166 (0.8511) loss_zs_kd 0.5063 (0.4873) loss_oracle 0.4913 (0.5019) acc 53.1250 (50.8507) kd_loss 0.6971 (0.7508) lr 6.9098e-04 eta 0:14:02
epoch [32/50] batch [200/428] time 0.081 (0.107) data 0.000 (0.003) loss 1.4074 (1.5994) ce_loss 0.9849 (1.3513) teacher_loss 0.6949 (0.8535) loss_zs_kd 0.5272 (0.4870) loss_oracle 0.4489 (0.5024) acc 62.5000 (50.8281) kd_loss 0.7305 (0.7522) lr 6.9098e-04 eta 0:14:06
epoch [32/50] batch [220/428] time 0.077 (0.107) data 0.000 (0.002) loss 1.5616 (1.6016) ce_loss 1.5332 (1.3517) teacher_loss 0.7990 (0.8553) loss_zs_kd 0.4593 (0.4862) loss_oracle 0.5330 (0.5032) acc 40.6250 (50.7670) kd_loss 0.9001 (0.7505) lr 6.9098e-04 eta 0:14:09
epoch [32/50] batch [240/428] time 0.085 (0.108) data 0.000 (0.002) loss 1.7238 (1.5978) ce_loss 1.6123 (1.3521) teacher_loss 0.9310 (0.8508) loss_zs_kd 0.5068 (0.4866) loss_oracle 0.5395 (0.5036) acc 53.1250 (50.8073) kd_loss 0.8632 (0.7523) lr 6.9098e-04 eta 0:14:12
epoch [32/50] batch [260/428] time 0.118 (0.107) data 0.000 (0.002) loss 1.3178 (1.5991) ce_loss 1.2598 (1.3557) teacher_loss 0.6326 (0.8522) loss_zs_kd 0.4473 (0.4875) loss_oracle 0.4616 (0.5031) acc 53.1250 (50.5889) kd_loss 0.8888 (0.7547) lr 6.9098e-04 eta 0:13:59
epoch [32/50] batch [280/428] time 0.166 (0.107) data 0.000 (0.002) loss 1.8967 (1.5980) ce_loss 1.7168 (1.3565) teacher_loss 1.2241 (0.8508) loss_zs_kd 0.4068 (0.4868) loss_oracle 0.4692 (0.5038) acc 50.0000 (50.6696) kd_loss 0.7545 (0.7555) lr 6.9098e-04 eta 0:14:03
epoch [32/50] batch [300/428] time 0.144 (0.108) data 0.000 (0.002) loss 1.5605 (1.5991) ce_loss 1.4600 (1.3566) teacher_loss 0.8352 (0.8513) loss_zs_kd 0.3990 (0.4850) loss_oracle 0.5258 (0.5053) acc 43.7500 (50.6146) kd_loss 0.8924 (0.7555) lr 6.9098e-04 eta 0:14:02
epoch [32/50] batch [320/428] time 0.100 (0.108) data 0.000 (0.002) loss 1.7240 (1.5979) ce_loss 1.4209 (1.3546) teacher_loss 1.0122 (0.8503) loss_zs_kd 0.4772 (0.4846) loss_oracle 0.4732 (0.5053) acc 46.8750 (50.7910) kd_loss 0.7300 (0.7559) lr 6.9098e-04 eta 0:14:01
epoch [32/50] batch [340/428] time 0.101 (0.107) data 0.000 (0.002) loss 1.3705 (1.5986) ce_loss 1.3555 (1.3537) teacher_loss 0.6878 (0.8514) loss_zs_kd 0.4128 (0.4839) loss_oracle 0.4763 (0.5052) acc 46.8750 (50.7996) kd_loss 0.7269 (0.7567) lr 6.9098e-04 eta 0:13:56
epoch [32/50] batch [360/428] time 0.108 (0.107) data 0.000 (0.002) loss 1.5526 (1.5994) ce_loss 1.4482 (1.3547) teacher_loss 0.8013 (0.8529) loss_zs_kd 0.4822 (0.4829) loss_oracle 0.5102 (0.5051) acc 46.8750 (50.8247) kd_loss 0.7422 (0.7565) lr 6.9098e-04 eta 0:13:52
epoch [32/50] batch [380/428] time 0.098 (0.107) data 0.000 (0.002) loss 1.5662 (1.6001) ce_loss 1.5283 (1.3575) teacher_loss 0.8463 (0.8534) loss_zs_kd 0.4392 (0.4830) loss_oracle 0.5003 (0.5052) acc 40.6250 (50.7155) kd_loss 0.9659 (0.7577) lr 6.9098e-04 eta 0:13:48
epoch [32/50] batch [400/428] time 0.101 (0.107) data 0.000 (0.001) loss 1.5001 (1.5999) ce_loss 1.1992 (1.3568) teacher_loss 0.8437 (0.8522) loss_zs_kd 0.4141 (0.4838) loss_oracle 0.4494 (0.5058) acc 65.6250 (50.8516) kd_loss 0.7515 (0.7596) lr 6.9098e-04 eta 0:13:45
epoch [32/50] batch [420/428] time 0.095 (0.107) data 0.000 (0.001) loss 1.5939 (1.6015) ce_loss 1.5312 (1.3590) teacher_loss 0.7181 (0.8540) loss_zs_kd 0.4929 (0.4832) loss_oracle 0.6294 (0.5060) acc 56.2500 (50.8408) kd_loss 1.0236 (0.7608) lr 6.9098e-04 eta 0:13:41
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,023
* accuracy: 51.4%
* error: 48.6%
* macro_f1: 39.0%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,542
* accuracy: 53.6%
* error: 46.4%
* macro_f1: 29.4%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [33/50] batch [20/428] time 0.114 (0.131) data 0.000 (0.025) loss 1.4911 (1.5936) ce_loss 1.2910 (1.3555) teacher_loss 0.8121 (0.8502) loss_zs_kd 0.3918 (0.4658) loss_oracle 0.4831 (0.5104) acc 56.2500 (49.2188) kd_loss 0.9632 (0.8237) lr 6.3188e-04 eta 0:16:47
epoch [33/50] batch [40/428] time 0.104 (0.118) data 0.000 (0.013) loss 1.5000 (1.6304) ce_loss 1.3008 (1.3719) teacher_loss 0.7915 (0.8865) loss_zs_kd 0.4746 (0.4687) loss_oracle 0.4713 (0.5096) acc 56.2500 (48.9844) kd_loss 0.8057 (0.7988) lr 6.3188e-04 eta 0:15:06
epoch [33/50] batch [60/428] time 0.103 (0.114) data 0.000 (0.009) loss 1.5420 (1.6214) ce_loss 1.5059 (1.3660) teacher_loss 0.8235 (0.8752) loss_zs_kd 0.4383 (0.4756) loss_oracle 0.4994 (0.5084) acc 50.0000 (49.8958) kd_loss 0.9165 (0.8114) lr 6.3188e-04 eta 0:14:32
epoch [33/50] batch [80/428] time 0.109 (0.112) data 0.000 (0.006) loss 1.5676 (1.6239) ce_loss 1.1123 (1.3686) teacher_loss 0.8972 (0.8839) loss_zs_kd 0.3647 (0.4725) loss_oracle 0.4881 (0.5037) acc 53.1250 (49.9219) kd_loss 0.7156 (0.8021) lr 6.3188e-04 eta 0:14:12
epoch [33/50] batch [100/428] time 0.105 (0.110) data 0.000 (0.005) loss 1.6486 (1.6246) ce_loss 1.4658 (1.3770) teacher_loss 0.9436 (0.8879) loss_zs_kd 0.4322 (0.4708) loss_oracle 0.4889 (0.5013) acc 46.8750 (49.5938) kd_loss 0.7827 (0.7954) lr 6.3188e-04 eta 0:13:59
epoch [33/50] batch [120/428] time 0.104 (0.109) data 0.000 (0.004) loss 1.6204 (1.6262) ce_loss 1.3105 (1.3744) teacher_loss 0.9567 (0.8925) loss_zs_kd 0.4203 (0.4711) loss_oracle 0.4536 (0.4982) acc 53.1250 (49.7656) kd_loss 0.6940 (0.7911) lr 6.3188e-04 eta 0:13:50
epoch [33/50] batch [140/428] time 0.082 (0.108) data 0.000 (0.004) loss 1.5624 (1.6180) ce_loss 1.1523 (1.3702) teacher_loss 0.8919 (0.8905) loss_zs_kd 0.4202 (0.4665) loss_oracle 0.4604 (0.4943) acc 62.5000 (49.7991) kd_loss 0.6365 (0.7905) lr 6.3188e-04 eta 0:13:34
epoch [33/50] batch [160/428] time 0.116 (0.105) data 0.000 (0.003) loss 1.4562 (1.6121) ce_loss 1.3350 (1.3608) teacher_loss 0.7360 (0.8851) loss_zs_kd 0.4327 (0.4651) loss_oracle 0.5039 (0.4944) acc 53.1250 (50.2930) kd_loss 0.7202 (0.7893) lr 6.3188e-04 eta 0:13:11
epoch [33/50] batch [180/428] time 0.156 (0.107) data 0.000 (0.003) loss 1.7489 (1.6163) ce_loss 1.7080 (1.3685) teacher_loss 1.0109 (0.8910) loss_zs_kd 0.4790 (0.4626) loss_oracle 0.4985 (0.4939) acc 34.3750 (50.0174) kd_loss 0.8654 (0.7865) lr 6.3188e-04 eta 0:13:24
epoch [33/50] batch [200/428] time 0.088 (0.107) data 0.000 (0.003) loss 1.7209 (1.6133) ce_loss 1.3311 (1.3662) teacher_loss 0.9731 (0.8874) loss_zs_kd 0.4971 (0.4619) loss_oracle 0.4992 (0.4950) acc 53.1250 (50.1250) kd_loss 0.8526 (0.7868) lr 6.3188e-04 eta 0:13:24
epoch [33/50] batch [220/428] time 0.086 (0.108) data 0.000 (0.003) loss 1.6854 (1.6124) ce_loss 1.3867 (1.3645) teacher_loss 0.9345 (0.8848) loss_zs_kd 0.4681 (0.4621) loss_oracle 0.5169 (0.4966) acc 46.8750 (50.2131) kd_loss 0.8347 (0.7859) lr 6.3188e-04 eta 0:13:30
epoch [33/50] batch [240/428] time 0.087 (0.107) data 0.000 (0.002) loss 1.8113 (1.6126) ce_loss 1.3574 (1.3629) teacher_loss 1.0354 (0.8842) loss_zs_kd 0.5080 (0.4606) loss_oracle 0.5219 (0.4981) acc 53.1250 (50.2344) kd_loss 0.6255 (0.7864) lr 6.3188e-04 eta 0:13:18
epoch [33/50] batch [260/428] time 0.163 (0.107) data 0.000 (0.002) loss 1.4799 (1.6108) ce_loss 1.1084 (1.3584) teacher_loss 0.7957 (0.8834) loss_zs_kd 0.3993 (0.4590) loss_oracle 0.4846 (0.4979) acc 56.2500 (50.4087) kd_loss 0.7540 (0.7858) lr 6.3188e-04 eta 0:13:17
epoch [33/50] batch [280/428] time 0.170 (0.107) data 0.000 (0.002) loss 1.5898 (1.6169) ce_loss 1.3096 (1.3598) teacher_loss 0.8723 (0.8897) loss_zs_kd 0.4699 (0.4587) loss_oracle 0.4827 (0.4979) acc 59.3750 (50.4464) kd_loss 0.7451 (0.7866) lr 6.3188e-04 eta 0:13:17
epoch [33/50] batch [300/428] time 0.162 (0.107) data 0.000 (0.002) loss 1.7169 (1.6188) ce_loss 1.5010 (1.3580) teacher_loss 0.9894 (0.8916) loss_zs_kd 0.4677 (0.4581) loss_oracle 0.4936 (0.4982) acc 40.6250 (50.4896) kd_loss 0.9016 (0.7869) lr 6.3188e-04 eta 0:13:14
epoch [33/50] batch [320/428] time 0.116 (0.107) data 0.000 (0.002) loss 1.6998 (1.6202) ce_loss 1.5078 (1.3581) teacher_loss 0.9568 (0.8931) loss_zs_kd 0.5043 (0.4583) loss_oracle 0.4908 (0.4979) acc 43.7500 (50.4297) kd_loss 0.7473 (0.7875) lr 6.3188e-04 eta 0:13:07
epoch [33/50] batch [340/428] time 0.099 (0.106) data 0.000 (0.002) loss 1.5215 (1.6232) ce_loss 1.1484 (1.3605) teacher_loss 0.7740 (0.8972) loss_zs_kd 0.4472 (0.4571) loss_oracle 0.5239 (0.4974) acc 62.5000 (50.3033) kd_loss 0.8319 (0.7870) lr 6.3188e-04 eta 0:13:02
epoch [33/50] batch [360/428] time 0.096 (0.106) data 0.000 (0.002) loss 1.4703 (1.6239) ce_loss 1.1865 (1.3615) teacher_loss 0.7659 (0.8989) loss_zs_kd 0.4842 (0.4562) loss_oracle 0.4623 (0.4969) acc 65.6250 (50.3038) kd_loss 0.6940 (0.7846) lr 6.3188e-04 eta 0:13:00
epoch [33/50] batch [380/428] time 0.105 (0.106) data 0.000 (0.002) loss 1.5342 (1.6255) ce_loss 1.2568 (1.3599) teacher_loss 0.8082 (0.9004) loss_zs_kd 0.4867 (0.4552) loss_oracle 0.4826 (0.4975) acc 59.3750 (50.3701) kd_loss 0.9097 (0.7854) lr 6.3188e-04 eta 0:12:57
epoch [33/50] batch [400/428] time 0.097 (0.106) data 0.000 (0.002) loss 1.7169 (1.6265) ce_loss 1.4346 (1.3595) teacher_loss 1.0250 (0.9020) loss_zs_kd 0.4552 (0.4552) loss_oracle 0.4643 (0.4970) acc 56.2500 (50.3125) kd_loss 0.7260 (0.7846) lr 6.3188e-04 eta 0:12:55
epoch [33/50] batch [420/428] time 0.093 (0.106) data 0.000 (0.001) loss 1.4720 (1.6247) ce_loss 1.1680 (1.3570) teacher_loss 0.6023 (0.9000) loss_zs_kd 0.4845 (0.4546) loss_oracle 0.6274 (0.4974) acc 59.3750 (50.5357) kd_loss 0.9409 (0.7851) lr 6.3188e-04 eta 0:12:51
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,968
* accuracy: 50.5%
* error: 49.5%
* macro_f1: 37.2%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,473
* accuracy: 52.2%
* error: 47.8%
* macro_f1: 28.3%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [34/50] batch [20/428] time 0.094 (0.133) data 0.000 (0.026) loss 1.5369 (1.6081) ce_loss 1.1055 (1.2674) teacher_loss 0.7295 (0.8865) loss_zs_kd 0.4697 (0.4531) loss_oracle 0.5726 (0.4951) acc 53.1250 (54.0625) kd_loss 0.8159 (0.7737) lr 5.7422e-04 eta 0:16:03
epoch [34/50] batch [40/428] time 0.112 (0.119) data 0.000 (0.013) loss 1.6377 (1.6302) ce_loss 1.2881 (1.3162) teacher_loss 0.8645 (0.9004) loss_zs_kd 0.4969 (0.4522) loss_oracle 0.5247 (0.5037) acc 53.1250 (52.3438) kd_loss 0.7286 (0.7916) lr 5.7422e-04 eta 0:14:24
epoch [34/50] batch [60/428] time 0.108 (0.115) data 0.000 (0.009) loss 1.4737 (1.6126) ce_loss 1.1982 (1.3276) teacher_loss 0.7772 (0.8851) loss_zs_kd 0.4398 (0.4484) loss_oracle 0.4766 (0.5033) acc 62.5000 (51.1458) kd_loss 0.8396 (0.7920) lr 5.7422e-04 eta 0:13:46
epoch [34/50] batch [80/428] time 0.108 (0.112) data 0.000 (0.007) loss 1.6303 (1.6127) ce_loss 1.3877 (1.3304) teacher_loss 0.9118 (0.8845) loss_zs_kd 0.4842 (0.4506) loss_oracle 0.4764 (0.5029) acc 46.8750 (51.0547) kd_loss 0.7339 (0.7918) lr 5.7422e-04 eta 0:13:27
epoch [34/50] batch [100/428] time 0.105 (0.111) data 0.000 (0.005) loss 1.8058 (1.6126) ce_loss 1.5293 (1.3252) teacher_loss 1.0655 (0.8820) loss_zs_kd 0.5052 (0.4559) loss_oracle 0.4877 (0.5027) acc 43.7500 (51.5625) kd_loss 0.9046 (0.8031) lr 5.7422e-04 eta 0:13:17
epoch [34/50] batch [120/428] time 0.102 (0.110) data 0.000 (0.005) loss 1.8333 (1.6228) ce_loss 1.5996 (1.3391) teacher_loss 1.0852 (0.8914) loss_zs_kd 0.4339 (0.4552) loss_oracle 0.5312 (0.5039) acc 46.8750 (50.8333) kd_loss 0.8227 (0.8051) lr 5.7422e-04 eta 0:13:08
epoch [34/50] batch [140/428] time 0.087 (0.109) data 0.000 (0.004) loss 1.6377 (1.6339) ce_loss 1.4238 (1.3515) teacher_loss 0.8672 (0.8987) loss_zs_kd 0.4654 (0.4571) loss_oracle 0.5378 (0.5066) acc 59.3750 (50.6250) kd_loss 0.9625 (0.8127) lr 5.7422e-04 eta 0:12:58
epoch [34/50] batch [160/428] time 0.090 (0.106) data 0.000 (0.003) loss 1.7335 (1.6360) ce_loss 1.3389 (1.3546) teacher_loss 0.9946 (0.8972) loss_zs_kd 0.4184 (0.4615) loss_oracle 0.5297 (0.5080) acc 50.0000 (50.2930) kd_loss 0.7854 (0.8152) lr 5.7422e-04 eta 0:12:31
epoch [34/50] batch [180/428] time 0.145 (0.107) data 0.000 (0.003) loss 1.4671 (1.6406) ce_loss 1.2803 (1.3650) teacher_loss 0.6982 (0.8981) loss_zs_kd 0.4886 (0.4629) loss_oracle 0.5246 (0.5111) acc 53.1250 (49.8090) kd_loss 0.9008 (0.8223) lr 5.7422e-04 eta 0:12:41
epoch [34/50] batch [200/428] time 0.092 (0.108) data 0.000 (0.003) loss 1.5999 (1.6416) ce_loss 1.4434 (1.3681) teacher_loss 0.8824 (0.8953) loss_zs_kd 0.4994 (0.4655) loss_oracle 0.4678 (0.5136) acc 50.0000 (49.5781) kd_loss 0.8995 (0.8275) lr 5.7422e-04 eta 0:12:43
epoch [34/50] batch [220/428] time 0.168 (0.108) data 0.000 (0.003) loss 1.8185 (1.6422) ce_loss 1.7373 (1.3700) teacher_loss 1.0608 (0.8940) loss_zs_kd 0.5183 (0.4662) loss_oracle 0.4986 (0.5151) acc 37.5000 (49.3324) kd_loss 0.8579 (0.8310) lr 5.7422e-04 eta 0:12:42
epoch [34/50] batch [240/428] time 0.080 (0.108) data 0.000 (0.002) loss 1.5593 (1.6393) ce_loss 1.3848 (1.3692) teacher_loss 0.8451 (0.8912) loss_zs_kd 0.4343 (0.4646) loss_oracle 0.4971 (0.5158) acc 53.1250 (49.5182) kd_loss 0.9373 (0.8350) lr 5.7422e-04 eta 0:12:39
epoch [34/50] batch [260/428] time 0.073 (0.106) data 0.000 (0.002) loss 1.3751 (1.6404) ce_loss 1.1152 (1.3708) teacher_loss 0.7370 (0.8903) loss_zs_kd 0.4196 (0.4660) loss_oracle 0.4282 (0.5170) acc 59.3750 (49.2909) kd_loss 0.8535 (0.8354) lr 5.7422e-04 eta 0:12:24
epoch [34/50] batch [280/428] time 0.138 (0.106) data 0.000 (0.002) loss 1.7073 (1.6426) ce_loss 1.4668 (1.3733) teacher_loss 1.0528 (0.8925) loss_zs_kd 0.3977 (0.4656) loss_oracle 0.4556 (0.5173) acc 53.1250 (49.2746) kd_loss 0.9101 (0.8365) lr 5.7422e-04 eta 0:12:20
epoch [34/50] batch [300/428] time 0.078 (0.105) data 0.000 (0.002) loss 1.6139 (1.6391) ce_loss 1.3047 (1.3746) teacher_loss 0.7666 (0.8883) loss_zs_kd 0.4480 (0.4652) loss_oracle 0.6234 (0.5181) acc 56.2500 (49.3333) kd_loss 0.9318 (0.8405) lr 5.7422e-04 eta 0:12:15
epoch [34/50] batch [320/428] time 0.146 (0.106) data 0.000 (0.002) loss 1.5711 (1.6379) ce_loss 1.3564 (1.3741) teacher_loss 0.8145 (0.8862) loss_zs_kd 0.4670 (0.4651) loss_oracle 0.5231 (0.5191) acc 37.5000 (49.3164) kd_loss 0.7951 (0.8415) lr 5.7422e-04 eta 0:12:13
epoch [34/50] batch [340/428] time 0.110 (0.105) data 0.000 (0.002) loss 1.7285 (1.6344) ce_loss 1.5264 (1.3743) teacher_loss 0.9241 (0.8814) loss_zs_kd 0.5044 (0.4663) loss_oracle 0.5522 (0.5199) acc 46.8750 (49.3107) kd_loss 0.8509 (0.8414) lr 5.7422e-04 eta 0:12:10
epoch [34/50] batch [360/428] time 0.090 (0.105) data 0.000 (0.002) loss 1.5153 (1.6325) ce_loss 1.3418 (1.3727) teacher_loss 0.7667 (0.8787) loss_zs_kd 0.4603 (0.4671) loss_oracle 0.5185 (0.5203) acc 50.0000 (49.3837) kd_loss 0.8415 (0.8435) lr 5.7422e-04 eta 0:12:05
epoch [34/50] batch [380/428] time 0.107 (0.105) data 0.000 (0.002) loss 1.5327 (1.6317) ce_loss 1.7363 (1.3709) teacher_loss 0.7774 (0.8790) loss_zs_kd 0.4489 (0.4663) loss_oracle 0.5308 (0.5196) acc 40.6250 (49.4737) kd_loss 0.8665 (0.8410) lr 5.7422e-04 eta 0:12:02
epoch [34/50] batch [400/428] time 0.103 (0.105) data 0.000 (0.002) loss 1.6448 (1.6282) ce_loss 1.3154 (1.3673) teacher_loss 0.8809 (0.8768) loss_zs_kd 0.4346 (0.4646) loss_oracle 0.5467 (0.5191) acc 59.3750 (49.6875) kd_loss 0.8391 (0.8402) lr 5.7422e-04 eta 0:11:59
epoch [34/50] batch [420/428] time 0.105 (0.105) data 0.000 (0.001) loss 1.4565 (1.6298) ce_loss 1.1055 (1.3689) teacher_loss 0.7258 (0.8786) loss_zs_kd 0.3979 (0.4633) loss_oracle 0.5316 (0.5195) acc 56.2500 (49.5982) kd_loss 0.8398 (0.8397) lr 5.7422e-04 eta 0:11:56
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,880
* accuracy: 49.0%
* error: 51.0%
* macro_f1: 36.6%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,649
* accuracy: 55.9%
* error: 44.1%
* macro_f1: 30.8%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [35/50] batch [20/428] time 0.098 (0.135) data 0.000 (0.032) loss 1.5098 (1.6354) ce_loss 1.2480 (1.4018) teacher_loss 0.7828 (0.8935) loss_zs_kd 0.4084 (0.4451) loss_oracle 0.5228 (0.5193) acc 59.3750 (46.7188) kd_loss 0.7791 (0.8258) lr 5.1825e-04 eta 0:15:23
epoch [35/50] batch [40/428] time 0.113 (0.120) data 0.000 (0.016) loss 1.5484 (1.6622) ce_loss 1.1836 (1.4129) teacher_loss 0.8062 (0.9185) loss_zs_kd 0.4316 (0.4411) loss_oracle 0.5263 (0.5231) acc 53.1250 (47.7344) kd_loss 0.7856 (0.8268) lr 5.1825e-04 eta 0:13:39
epoch [35/50] batch [60/428] time 0.103 (0.115) data 0.000 (0.011) loss 1.6651 (1.6306) ce_loss 1.5869 (1.3896) teacher_loss 0.8863 (0.8909) loss_zs_kd 0.4749 (0.4446) loss_oracle 0.5414 (0.5174) acc 40.6250 (48.8021) kd_loss 0.8066 (0.8237) lr 5.1825e-04 eta 0:13:01
epoch [35/50] batch [80/428] time 0.105 (0.112) data 0.000 (0.008) loss 1.5962 (1.6259) ce_loss 1.4463 (1.3813) teacher_loss 0.8752 (0.8813) loss_zs_kd 0.5547 (0.4535) loss_oracle 0.4437 (0.5178) acc 50.0000 (49.7266) kd_loss 0.9107 (0.8327) lr 5.1825e-04 eta 0:12:37
epoch [35/50] batch [100/428] time 0.095 (0.109) data 0.000 (0.007) loss 1.3845 (1.6218) ce_loss 1.4072 (1.3817) teacher_loss 0.7185 (0.8743) loss_zs_kd 0.3954 (0.4575) loss_oracle 0.4684 (0.5187) acc 46.8750 (49.5938) kd_loss 1.0227 (0.8363) lr 5.1825e-04 eta 0:12:15
epoch [35/50] batch [120/428] time 0.098 (0.107) data 0.000 (0.005) loss 1.8001 (1.6042) ce_loss 1.5811 (1.3633) teacher_loss 1.0481 (0.8575) loss_zs_kd 0.5043 (0.4573) loss_oracle 0.4999 (0.5182) acc 46.8750 (50.2344) kd_loss 0.9035 (0.8371) lr 5.1825e-04 eta 0:12:00
epoch [35/50] batch [140/428] time 0.093 (0.106) data 0.000 (0.005) loss 1.3866 (1.6060) ce_loss 1.2314 (1.3673) teacher_loss 0.6436 (0.8599) loss_zs_kd 0.4445 (0.4597) loss_oracle 0.5207 (0.5162) acc 53.1250 (50.1786) kd_loss 0.8596 (0.8390) lr 5.1825e-04 eta 0:11:50
epoch [35/50] batch [160/428] time 0.078 (0.103) data 0.000 (0.004) loss 1.5247 (1.6023) ce_loss 1.2031 (1.3661) teacher_loss 0.8412 (0.8591) loss_zs_kd 0.4113 (0.4592) loss_oracle 0.4779 (0.5136) acc 62.5000 (50.2148) kd_loss 0.7655 (0.8379) lr 5.1825e-04 eta 0:11:30
epoch [35/50] batch [180/428] time 0.080 (0.102) data 0.000 (0.004) loss 1.5249 (1.5997) ce_loss 1.4492 (1.3674) teacher_loss 0.8019 (0.8557) loss_zs_kd 0.5652 (0.4608) loss_oracle 0.4405 (0.5136) acc 50.0000 (50.3125) kd_loss 0.8492 (0.8389) lr 5.1825e-04 eta 0:11:19
epoch [35/50] batch [200/428] time 0.062 (0.100) data 0.000 (0.003) loss 1.4886 (1.6018) ce_loss 1.2461 (1.3686) teacher_loss 0.7775 (0.8566) loss_zs_kd 0.4675 (0.4650) loss_oracle 0.4774 (0.5127) acc 46.8750 (50.3281) kd_loss 0.7891 (0.8401) lr 5.1825e-04 eta 0:11:07
epoch [35/50] batch [220/428] time 0.070 (0.099) data 0.000 (0.003) loss 1.4620 (1.6068) ce_loss 1.3721 (1.3804) teacher_loss 0.5819 (0.8594) loss_zs_kd 0.5406 (0.4684) loss_oracle 0.6098 (0.5132) acc 50.0000 (50.0426) kd_loss 0.9349 (0.8423) lr 5.1825e-04 eta 0:10:57
epoch [35/50] batch [240/428] time 0.062 (0.100) data 0.000 (0.003) loss 1.8724 (1.6081) ce_loss 1.6631 (1.3850) teacher_loss 1.1448 (0.8584) loss_zs_kd 0.5663 (0.4716) loss_oracle 0.4444 (0.5139) acc 34.3750 (49.7396) kd_loss 0.7541 (0.8457) lr 5.1825e-04 eta 0:10:58
epoch [35/50] batch [260/428] time 0.074 (0.101) data 0.000 (0.003) loss 1.5197 (1.6042) ce_loss 1.2500 (1.3811) teacher_loss 0.8361 (0.8562) loss_zs_kd 0.4313 (0.4705) loss_oracle 0.4679 (0.5127) acc 53.1250 (49.9639) kd_loss 0.6675 (0.8452) lr 5.1825e-04 eta 0:11:03
epoch [35/50] batch [280/428] time 0.076 (0.100) data 0.000 (0.003) loss 1.3917 (1.6000) ce_loss 1.2314 (1.3777) teacher_loss 0.6451 (0.8521) loss_zs_kd 0.5035 (0.4720) loss_oracle 0.4948 (0.5119) acc 62.5000 (50.0446) kd_loss 0.9398 (0.8446) lr 5.1825e-04 eta 0:10:53
epoch [35/50] batch [300/428] time 0.077 (0.101) data 0.000 (0.002) loss 1.4611 (1.6024) ce_loss 1.2188 (1.3792) teacher_loss 0.7035 (0.8532) loss_zs_kd 0.4416 (0.4730) loss_oracle 0.5368 (0.5128) acc 59.3750 (50.0208) kd_loss 0.8549 (0.8460) lr 5.1825e-04 eta 0:10:59
epoch [35/50] batch [320/428] time 0.076 (0.102) data 0.000 (0.002) loss 1.5320 (1.6025) ce_loss 1.4736 (1.3788) teacher_loss 0.7896 (0.8532) loss_zs_kd 0.4840 (0.4746) loss_oracle 0.5004 (0.5120) acc 56.2500 (50.0781) kd_loss 0.8674 (0.8448) lr 5.1825e-04 eta 0:11:03
epoch [35/50] batch [340/428] time 0.083 (0.102) data 0.000 (0.002) loss 1.6611 (1.6031) ce_loss 1.4951 (1.3804) teacher_loss 0.9468 (0.8528) loss_zs_kd 0.4917 (0.4743) loss_oracle 0.4684 (0.5132) acc 50.0000 (49.9724) kd_loss 0.7427 (0.8442) lr 5.1825e-04 eta 0:11:04
epoch [35/50] batch [360/428] time 0.095 (0.102) data 0.000 (0.002) loss 1.6478 (1.6029) ce_loss 1.3926 (1.3815) teacher_loss 0.9633 (0.8535) loss_zs_kd 0.4732 (0.4736) loss_oracle 0.4480 (0.5126) acc 43.7500 (49.9219) kd_loss 0.7652 (0.8431) lr 5.1825e-04 eta 0:11:01
epoch [35/50] batch [380/428] time 0.110 (0.102) data 0.000 (0.002) loss 1.5504 (1.5979) ce_loss 1.3086 (1.3775) teacher_loss 0.7721 (0.8500) loss_zs_kd 0.4458 (0.4726) loss_oracle 0.5553 (0.5116) acc 62.5000 (50.1398) kd_loss 0.8046 (0.8399) lr 5.1825e-04 eta 0:11:00
epoch [35/50] batch [400/428] time 0.101 (0.102) data 0.000 (0.002) loss 1.3987 (1.5977) ce_loss 1.1436 (1.3805) teacher_loss 0.6683 (0.8484) loss_zs_kd 0.4784 (0.4734) loss_oracle 0.4912 (0.5126) acc 59.3750 (49.9375) kd_loss 0.9004 (0.8411) lr 5.1825e-04 eta 0:10:58
epoch [35/50] batch [420/428] time 0.098 (0.102) data 0.000 (0.002) loss 1.4354 (1.5974) ce_loss 1.4229 (1.3810) teacher_loss 0.7130 (0.8486) loss_zs_kd 0.4679 (0.4732) loss_oracle 0.4885 (0.5123) acc 46.8750 (49.8810) kd_loss 0.8246 (0.8390) lr 5.1825e-04 eta 0:10:56
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,884
* accuracy: 49.1%
* error: 50.9%
* macro_f1: 35.7%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,688
* accuracy: 56.7%
* error: 43.3%
* macro_f1: 31.5%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [36/50] batch [20/428] time 0.115 (0.132) data 0.000 (0.027) loss 1.5558 (1.5403) ce_loss 1.2793 (1.3687) teacher_loss 0.8723 (0.7999) loss_zs_kd 0.4529 (0.4590) loss_oracle 0.4570 (0.5108) acc 50.0000 (52.3438) kd_loss 0.7733 (0.8029) lr 4.6417e-04 eta 0:14:04
epoch [36/50] batch [40/428] time 0.109 (0.118) data 0.000 (0.014) loss 1.3732 (1.5665) ce_loss 1.3291 (1.4019) teacher_loss 0.6504 (0.8126) loss_zs_kd 0.4449 (0.4673) loss_oracle 0.5004 (0.5203) acc 43.7500 (49.7656) kd_loss 0.8350 (0.8206) lr 4.6417e-04 eta 0:12:34
epoch [36/50] batch [60/428] time 0.099 (0.114) data 0.001 (0.009) loss 1.8584 (1.5654) ce_loss 1.5283 (1.3911) teacher_loss 1.0554 (0.8126) loss_zs_kd 0.4936 (0.4683) loss_oracle 0.5562 (0.5186) acc 43.7500 (49.7917) kd_loss 0.8056 (0.8257) lr 4.6417e-04 eta 0:12:04
epoch [36/50] batch [80/428] time 0.102 (0.111) data 0.000 (0.007) loss 1.8658 (1.5638) ce_loss 1.6133 (1.3891) teacher_loss 0.9543 (0.8091) loss_zs_kd 0.5909 (0.4694) loss_oracle 0.6160 (0.5200) acc 40.6250 (49.4531) kd_loss 0.8236 (0.8213) lr 4.6417e-04 eta 0:11:45
epoch [36/50] batch [100/428] time 0.103 (0.110) data 0.000 (0.006) loss 1.4712 (1.5598) ce_loss 1.0723 (1.3860) teacher_loss 0.7594 (0.8040) loss_zs_kd 0.4532 (0.4701) loss_oracle 0.4852 (0.5208) acc 59.3750 (49.4688) kd_loss 0.6645 (0.8160) lr 4.6417e-04 eta 0:11:33
epoch [36/50] batch [120/428] time 0.114 (0.109) data 0.000 (0.005) loss 1.6281 (1.5618) ce_loss 1.5820 (1.3871) teacher_loss 0.8316 (0.8015) loss_zs_kd 0.5168 (0.4725) loss_oracle 0.5381 (0.5241) acc 37.5000 (49.2969) kd_loss 0.7815 (0.8169) lr 4.6417e-04 eta 0:11:26
epoch [36/50] batch [140/428] time 0.105 (0.109) data 0.000 (0.004) loss 2.0386 (1.5624) ce_loss 1.7734 (1.3829) teacher_loss 1.1030 (0.7990) loss_zs_kd 0.5123 (0.4745) loss_oracle 0.6795 (0.5262) acc 43.7500 (49.4643) kd_loss 0.9959 (0.8157) lr 4.6417e-04 eta 0:11:21
epoch [36/50] batch [160/428] time 0.089 (0.108) data 0.000 (0.004) loss 1.3598 (1.5586) ce_loss 1.1953 (1.3723) teacher_loss 0.5549 (0.7957) loss_zs_kd 0.5649 (0.4757) loss_oracle 0.5225 (0.5251) acc 59.3750 (50.0195) kd_loss 0.8317 (0.8120) lr 4.6417e-04 eta 0:11:14
epoch [36/50] batch [180/428] time 0.089 (0.106) data 0.000 (0.003) loss 1.3492 (1.5599) ce_loss 1.1084 (1.3751) teacher_loss 0.5880 (0.7974) loss_zs_kd 0.4753 (0.4759) loss_oracle 0.5236 (0.5245) acc 59.3750 (50.1215) kd_loss 0.7434 (0.8117) lr 4.6417e-04 eta 0:11:00
epoch [36/50] batch [200/428] time 0.176 (0.107) data 0.000 (0.003) loss 1.2768 (1.5594) ce_loss 1.0068 (1.3696) teacher_loss 0.5842 (0.7974) loss_zs_kd 0.4737 (0.4767) loss_oracle 0.4558 (0.5236) acc 59.3750 (50.5469) kd_loss 0.7425 (0.8091) lr 4.6417e-04 eta 0:11:02
epoch [36/50] batch [220/428] time 0.161 (0.108) data 0.000 (0.003) loss 1.7641 (1.5588) ce_loss 1.5059 (1.3705) teacher_loss 0.9717 (0.7973) loss_zs_kd 0.4952 (0.4747) loss_oracle 0.5448 (0.5242) acc 53.1250 (50.5114) kd_loss 0.9234 (0.8122) lr 4.6417e-04 eta 0:11:07
epoch [36/50] batch [240/428] time 0.081 (0.107) data 0.000 (0.003) loss 1.5472 (1.5631) ce_loss 1.1924 (1.3729) teacher_loss 0.7492 (0.8008) loss_zs_kd 0.4823 (0.4764) loss_oracle 0.5569 (0.5241) acc 40.6250 (50.3906) kd_loss 0.7567 (0.8099) lr 4.6417e-04 eta 0:11:01
epoch [36/50] batch [260/428] time 0.086 (0.108) data 0.000 (0.002) loss 1.7904 (1.5688) ce_loss 1.5479 (1.3806) teacher_loss 0.9648 (0.8050) loss_zs_kd 0.5035 (0.4790) loss_oracle 0.5739 (0.5244) acc 40.6250 (50.0721) kd_loss 0.7739 (0.8098) lr 4.6417e-04 eta 0:11:03
epoch [36/50] batch [280/428] time 0.081 (0.106) data 0.000 (0.002) loss 1.7354 (1.5662) ce_loss 1.5107 (1.3764) teacher_loss 0.9794 (0.8014) loss_zs_kd 0.4893 (0.4815) loss_oracle 0.5113 (0.5241) acc 53.1250 (50.1339) kd_loss 0.7153 (0.8086) lr 4.6417e-04 eta 0:10:51
epoch [36/50] batch [300/428] time 0.080 (0.106) data 0.000 (0.002) loss 1.8430 (1.5688) ce_loss 1.8457 (1.3805) teacher_loss 1.0173 (0.8048) loss_zs_kd 0.4646 (0.4810) loss_oracle 0.5934 (0.5235) acc 34.3750 (49.9479) kd_loss 0.9800 (0.8081) lr 4.6417e-04 eta 0:10:47
epoch [36/50] batch [320/428] time 0.180 (0.107) data 0.000 (0.002) loss 1.2535 (1.5678) ce_loss 0.8452 (1.3780) teacher_loss 0.4398 (0.8043) loss_zs_kd 0.5731 (0.4815) loss_oracle 0.5272 (0.5228) acc 78.1250 (49.9707) kd_loss 0.7886 (0.8083) lr 4.6417e-04 eta 0:10:50
epoch [36/50] batch [340/428] time 0.173 (0.107) data 0.000 (0.002) loss 1.5833 (1.5687) ce_loss 1.3955 (1.3795) teacher_loss 0.8566 (0.8049) loss_zs_kd 0.5643 (0.4824) loss_oracle 0.4445 (0.5226) acc 62.5000 (49.9540) kd_loss 0.6683 (0.8087) lr 4.6417e-04 eta 0:10:52
epoch [36/50] batch [360/428] time 0.117 (0.106) data 0.000 (0.002) loss 1.4127 (1.5678) ce_loss 1.3125 (1.3799) teacher_loss 0.6120 (0.8038) loss_zs_kd 0.5112 (0.4835) loss_oracle 0.5451 (0.5222) acc 59.3750 (50.0608) kd_loss 1.0635 (0.8104) lr 4.6417e-04 eta 0:10:44
epoch [36/50] batch [380/428] time 0.111 (0.106) data 0.000 (0.002) loss 1.6144 (1.5672) ce_loss 1.5615 (1.3818) teacher_loss 0.8919 (0.8032) loss_zs_kd 0.4667 (0.4838) loss_oracle 0.4891 (0.5221) acc 46.8750 (50.0658) kd_loss 0.8131 (0.8115) lr 4.6417e-04 eta 0:10:41
epoch [36/50] batch [400/428] time 0.109 (0.106) data 0.000 (0.002) loss 1.6316 (1.5671) ce_loss 1.4609 (1.3822) teacher_loss 0.8606 (0.8043) loss_zs_kd 0.4566 (0.4828) loss_oracle 0.5427 (0.5214) acc 53.1250 (50.1172) kd_loss 0.8687 (0.8109) lr 4.6417e-04 eta 0:10:38
epoch [36/50] batch [420/428] time 0.097 (0.106) data 0.000 (0.002) loss 1.6391 (1.5682) ce_loss 1.4756 (1.3828) teacher_loss 0.8427 (0.8050) loss_zs_kd 0.5129 (0.4829) loss_oracle 0.5399 (0.5217) acc 50.0000 (50.0967) kd_loss 0.9110 (0.8115) lr 4.6417e-04 eta 0:10:35
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,937
* accuracy: 50.0%
* error: 50.0%
* macro_f1: 37.1%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,662
* accuracy: 56.1%
* error: 43.9%
* macro_f1: 31.4%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [37/50] batch [20/428] time 0.098 (0.136) data 0.000 (0.034) loss 1.4632 (1.5809) ce_loss 1.5166 (1.4298) teacher_loss 0.6353 (0.8033) loss_zs_kd 0.5161 (0.4968) loss_oracle 0.5699 (0.5292) acc 43.7500 (45.7812) kd_loss 0.8363 (0.8256) lr 4.1221e-04 eta 0:13:31
epoch [37/50] batch [40/428] time 0.093 (0.120) data 0.000 (0.017) loss 1.5725 (1.6113) ce_loss 1.4873 (1.4546) teacher_loss 0.8276 (0.8421) loss_zs_kd 0.4379 (0.4944) loss_oracle 0.5260 (0.5220) acc 46.8750 (46.0156) kd_loss 0.8373 (0.8159) lr 4.1221e-04 eta 0:11:55
epoch [37/50] batch [60/428] time 0.092 (0.115) data 0.001 (0.011) loss 1.5380 (1.6069) ce_loss 1.6133 (1.4629) teacher_loss 0.7028 (0.8359) loss_zs_kd 0.5600 (0.4904) loss_oracle 0.5552 (0.5259) acc 28.1250 (46.0938) kd_loss 0.8915 (0.8180) lr 4.1221e-04 eta 0:11:22
epoch [37/50] batch [80/428] time 0.114 (0.112) data 0.000 (0.009) loss 1.8272 (1.6084) ce_loss 1.7109 (1.4550) teacher_loss 1.0390 (0.8395) loss_zs_kd 0.6007 (0.4896) loss_oracle 0.4879 (0.5242) acc 37.5000 (46.6016) kd_loss 0.7472 (0.8185) lr 4.1221e-04 eta 0:11:04
epoch [37/50] batch [100/428] time 0.103 (0.111) data 0.000 (0.007) loss 1.7181 (1.5978) ce_loss 1.6592 (1.4337) teacher_loss 0.9968 (0.8342) loss_zs_kd 0.5048 (0.4868) loss_oracle 0.4689 (0.5202) acc 43.7500 (47.4375) kd_loss 0.8745 (0.8124) lr 4.1221e-04 eta 0:10:51
epoch [37/50] batch [120/428] time 0.105 (0.109) data 0.000 (0.006) loss 1.7984 (1.5940) ce_loss 1.6768 (1.4246) teacher_loss 1.0373 (0.8334) loss_zs_kd 0.5355 (0.4827) loss_oracle 0.4934 (0.5192) acc 40.6250 (47.7344) kd_loss 0.7323 (0.8146) lr 4.1221e-04 eta 0:10:42
epoch [37/50] batch [140/428] time 0.109 (0.109) data 0.000 (0.005) loss 1.7345 (1.5954) ce_loss 1.5059 (1.4244) teacher_loss 0.9981 (0.8369) loss_zs_kd 0.4558 (0.4796) loss_oracle 0.5084 (0.5186) acc 43.7500 (47.7679) kd_loss 0.6919 (0.8165) lr 4.1221e-04 eta 0:10:36
epoch [37/50] batch [160/428] time 0.117 (0.108) data 0.000 (0.004) loss 1.4817 (1.5854) ce_loss 1.5098 (1.4161) teacher_loss 0.7291 (0.8274) loss_zs_kd 0.4618 (0.4794) loss_oracle 0.5216 (0.5183) acc 56.2500 (48.1250) kd_loss 0.8873 (0.8187) lr 4.1221e-04 eta 0:10:32
epoch [37/50] batch [180/428] time 0.084 (0.107) data 0.000 (0.004) loss 2.0889 (1.5852) ce_loss 1.7441 (1.4092) teacher_loss 1.3291 (0.8265) loss_zs_kd 0.5213 (0.4814) loss_oracle 0.4991 (0.5180) acc 34.3750 (48.5243) kd_loss 0.8107 (0.8158) lr 4.1221e-04 eta 0:10:19
epoch [37/50] batch [200/428] time 0.068 (0.106) data 0.000 (0.004) loss 1.3701 (1.5864) ce_loss 1.1318 (1.4063) teacher_loss 0.6050 (0.8268) loss_zs_kd 0.4676 (0.4826) loss_oracle 0.5312 (0.5183) acc 59.3750 (48.6719) kd_loss 0.7941 (0.8174) lr 4.1221e-04 eta 0:10:12
epoch [37/50] batch [220/428] time 0.159 (0.105) data 0.000 (0.003) loss 1.6281 (1.5840) ce_loss 1.3428 (1.4029) teacher_loss 0.7741 (0.8259) loss_zs_kd 0.5573 (0.4812) loss_oracle 0.5754 (0.5175) acc 53.1250 (48.8920) kd_loss 0.8545 (0.8164) lr 4.1221e-04 eta 0:10:06
epoch [37/50] batch [240/428] time 0.067 (0.105) data 0.000 (0.003) loss 1.5388 (1.5812) ce_loss 1.3203 (1.3985) teacher_loss 0.7357 (0.8230) loss_zs_kd 0.4384 (0.4809) loss_oracle 0.5839 (0.5178) acc 56.2500 (49.1536) kd_loss 0.8539 (0.8186) lr 4.1221e-04 eta 0:10:04
epoch [37/50] batch [260/428] time 0.085 (0.104) data 0.000 (0.003) loss 1.5400 (1.5752) ce_loss 1.4102 (1.3920) teacher_loss 0.8285 (0.8178) loss_zs_kd 0.3821 (0.4794) loss_oracle 0.5204 (0.5178) acc 53.1250 (49.2909) kd_loss 0.8552 (0.8196) lr 4.1221e-04 eta 0:09:54
epoch [37/50] batch [280/428] time 0.084 (0.104) data 0.000 (0.003) loss 1.5426 (1.5746) ce_loss 1.4922 (1.3891) teacher_loss 0.8088 (0.8179) loss_zs_kd 0.4843 (0.4804) loss_oracle 0.4916 (0.5165) acc 43.7500 (49.4196) kd_loss 0.8206 (0.8175) lr 4.1221e-04 eta 0:09:55
epoch [37/50] batch [300/428] time 0.065 (0.102) data 0.000 (0.003) loss 1.5214 (1.5731) ce_loss 1.3145 (1.3874) teacher_loss 0.7213 (0.8158) loss_zs_kd 0.4689 (0.4805) loss_oracle 0.5656 (0.5170) acc 56.2500 (49.6250) kd_loss 0.7991 (0.8193) lr 4.1221e-04 eta 0:09:42
epoch [37/50] batch [320/428] time 0.077 (0.101) data 0.000 (0.002) loss 1.4287 (1.5753) ce_loss 1.3721 (1.3892) teacher_loss 0.7277 (0.8177) loss_zs_kd 0.4429 (0.4811) loss_oracle 0.4795 (0.5170) acc 43.7500 (49.6680) kd_loss 0.7940 (0.8178) lr 4.1221e-04 eta 0:09:35
epoch [37/50] batch [340/428] time 0.062 (0.102) data 0.000 (0.002) loss 1.2810 (1.5758) ce_loss 1.0879 (1.3899) teacher_loss 0.5039 (0.8177) loss_zs_kd 0.5095 (0.4811) loss_oracle 0.5224 (0.5175) acc 62.5000 (49.6967) kd_loss 0.8248 (0.8187) lr 4.1221e-04 eta 0:09:34
epoch [37/50] batch [360/428] time 0.171 (0.102) data 0.000 (0.002) loss 1.5158 (1.5744) ce_loss 1.3877 (1.3879) teacher_loss 0.7635 (0.8167) loss_zs_kd 0.5121 (0.4813) loss_oracle 0.4963 (0.5171) acc 50.0000 (49.7049) kd_loss 0.9173 (0.8190) lr 4.1221e-04 eta 0:09:31
epoch [37/50] batch [380/428] time 0.066 (0.101) data 0.000 (0.002) loss 1.4599 (1.5778) ce_loss 1.1758 (1.3898) teacher_loss 0.7348 (0.8200) loss_zs_kd 0.4645 (0.4811) loss_oracle 0.4929 (0.5173) acc 62.5000 (49.6217) kd_loss 0.8967 (0.8195) lr 4.1221e-04 eta 0:09:27
epoch [37/50] batch [400/428] time 0.090 (0.100) data 0.000 (0.002) loss 1.4103 (1.5740) ce_loss 1.2764 (1.3850) teacher_loss 0.6717 (0.8165) loss_zs_kd 0.4321 (0.4805) loss_oracle 0.5226 (0.5173) acc 56.2500 (49.7891) kd_loss 0.8801 (0.8190) lr 4.1221e-04 eta 0:09:21
epoch [37/50] batch [420/428] time 0.096 (0.100) data 0.000 (0.002) loss 1.4872 (1.5738) ce_loss 1.4170 (1.3837) teacher_loss 0.7677 (0.8160) loss_zs_kd 0.4945 (0.4806) loss_oracle 0.4723 (0.5175) acc 40.6250 (49.9330) kd_loss 0.8532 (0.8197) lr 4.1221e-04 eta 0:09:17
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,883
* accuracy: 49.1%
* error: 50.9%
* macro_f1: 36.0%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,642
* accuracy: 55.7%
* error: 44.3%
* macro_f1: 30.4%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [38/50] batch [20/428] time 0.101 (0.122) data 0.000 (0.026) loss 1.6130 (1.5096) ce_loss 1.3545 (1.3273) teacher_loss 0.8925 (0.7717) loss_zs_kd 0.3914 (0.4537) loss_oracle 0.5248 (0.5111) acc 59.3750 (53.7500) kd_loss 0.9952 (0.8515) lr 3.6258e-04 eta 0:11:15
epoch [38/50] batch [40/428] time 0.097 (0.113) data 0.000 (0.013) loss 1.5514 (1.5180) ce_loss 1.3926 (1.3390) teacher_loss 0.8172 (0.7732) loss_zs_kd 0.4624 (0.4680) loss_oracle 0.5031 (0.5108) acc 43.7500 (51.8750) kd_loss 0.8054 (0.8292) lr 3.6258e-04 eta 0:10:24
epoch [38/50] batch [60/428] time 0.106 (0.110) data 0.000 (0.009) loss 1.6928 (1.5410) ce_loss 1.3359 (1.3482) teacher_loss 0.9495 (0.7958) loss_zs_kd 0.4962 (0.4701) loss_oracle 0.4952 (0.5102) acc 50.0000 (50.4688) kd_loss 0.8404 (0.8211) lr 3.6258e-04 eta 0:10:03
epoch [38/50] batch [80/428] time 0.103 (0.108) data 0.000 (0.007) loss 1.8175 (1.5416) ce_loss 1.6807 (1.3474) teacher_loss 1.0985 (0.7951) loss_zs_kd 0.4645 (0.4759) loss_oracle 0.4868 (0.5085) acc 25.0000 (50.7812) kd_loss 0.7852 (0.8183) lr 3.6258e-04 eta 0:09:53
epoch [38/50] batch [100/428] time 0.095 (0.107) data 0.000 (0.005) loss 1.3677 (1.5401) ce_loss 1.1846 (1.3479) teacher_loss 0.5675 (0.7939) loss_zs_kd 0.4664 (0.4760) loss_oracle 0.5670 (0.5083) acc 53.1250 (51.1875) kd_loss 0.7836 (0.8190) lr 3.6258e-04 eta 0:09:47
epoch [38/50] batch [120/428] time 0.112 (0.107) data 0.000 (0.004) loss 1.6021 (1.5424) ce_loss 1.4268 (1.3499) teacher_loss 0.7977 (0.7920) loss_zs_kd 0.4360 (0.4775) loss_oracle 0.5864 (0.5117) acc 46.8750 (51.0417) kd_loss 0.9130 (0.8217) lr 3.6258e-04 eta 0:09:41
epoch [38/50] batch [140/428] time 0.108 (0.106) data 0.000 (0.004) loss 1.4386 (1.5530) ce_loss 1.2451 (1.3564) teacher_loss 0.6692 (0.8003) loss_zs_kd 0.4814 (0.4792) loss_oracle 0.5287 (0.5131) acc 50.0000 (51.0045) kd_loss 0.9042 (0.8194) lr 3.6258e-04 eta 0:09:36
epoch [38/50] batch [160/428] time 0.104 (0.106) data 0.000 (0.003) loss 1.5173 (1.5554) ce_loss 1.4434 (1.3619) teacher_loss 0.7067 (0.8052) loss_zs_kd 0.5182 (0.4768) loss_oracle 0.5515 (0.5118) acc 50.0000 (50.8008) kd_loss 0.8376 (0.8181) lr 3.6258e-04 eta 0:09:33
epoch [38/50] batch [180/428] time 0.114 (0.106) data 0.000 (0.003) loss 1.4234 (1.5516) ce_loss 1.2676 (1.3576) teacher_loss 0.7441 (0.8011) loss_zs_kd 0.4670 (0.4762) loss_oracle 0.4458 (0.5124) acc 53.1250 (50.7812) kd_loss 0.6838 (0.8213) lr 3.6258e-04 eta 0:09:29
epoch [38/50] batch [200/428] time 0.094 (0.105) data 0.000 (0.003) loss 1.5815 (1.5570) ce_loss 1.4756 (1.3635) teacher_loss 0.8509 (0.8061) loss_zs_kd 0.4127 (0.4767) loss_oracle 0.5242 (0.5126) acc 59.3750 (50.7500) kd_loss 0.8340 (0.8211) lr 3.6258e-04 eta 0:09:23
epoch [38/50] batch [220/428] time 0.080 (0.103) data 0.000 (0.003) loss 1.5162 (1.5547) ce_loss 1.3809 (1.3623) teacher_loss 0.7308 (0.8017) loss_zs_kd 0.5281 (0.4786) loss_oracle 0.5214 (0.5137) acc 43.7500 (50.8523) kd_loss 0.8238 (0.8230) lr 3.6258e-04 eta 0:09:10
epoch [38/50] batch [240/428] time 0.169 (0.104) data 0.000 (0.002) loss 1.4857 (1.5573) ce_loss 1.4131 (1.3624) teacher_loss 0.7013 (0.8034) loss_zs_kd 0.4797 (0.4802) loss_oracle 0.5445 (0.5138) acc 59.3750 (50.8333) kd_loss 0.8396 (0.8197) lr 3.6258e-04 eta 0:09:11
epoch [38/50] batch [260/428] time 0.155 (0.105) data 0.000 (0.002) loss 1.6001 (1.5565) ce_loss 1.2646 (1.3609) teacher_loss 0.8651 (0.8031) loss_zs_kd 0.5469 (0.4807) loss_oracle 0.4615 (0.5131) acc 59.3750 (50.8053) kd_loss 0.6122 (0.8178) lr 3.6258e-04 eta 0:09:14
epoch [38/50] batch [280/428] time 0.139 (0.105) data 0.000 (0.002) loss 1.6816 (1.5599) ce_loss 1.4229 (1.3635) teacher_loss 0.9151 (0.8067) loss_zs_kd 0.4934 (0.4798) loss_oracle 0.5198 (0.5133) acc 40.6250 (50.6473) kd_loss 0.9175 (0.8154) lr 3.6258e-04 eta 0:09:16
epoch [38/50] batch [300/428] time 0.073 (0.105) data 0.000 (0.002) loss 1.4767 (1.5626) ce_loss 1.1738 (1.3659) teacher_loss 0.7421 (0.8097) loss_zs_kd 0.4234 (0.4788) loss_oracle 0.5230 (0.5135) acc 53.1250 (50.3750) kd_loss 0.6838 (0.8148) lr 3.6258e-04 eta 0:09:12
epoch [38/50] batch [320/428] time 0.144 (0.104) data 0.000 (0.002) loss 1.5942 (1.5623) ce_loss 1.5127 (1.3659) teacher_loss 0.8129 (0.8095) loss_zs_kd 0.4638 (0.4783) loss_oracle 0.5494 (0.5136) acc 37.5000 (50.4297) kd_loss 0.7980 (0.8152) lr 3.6258e-04 eta 0:09:04
epoch [38/50] batch [340/428] time 0.079 (0.104) data 0.000 (0.002) loss 1.7436 (1.5638) ce_loss 1.6816 (1.3682) teacher_loss 0.9852 (0.8106) loss_zs_kd 0.4551 (0.4787) loss_oracle 0.5308 (0.5139) acc 46.8750 (50.4320) kd_loss 0.8049 (0.8171) lr 3.6258e-04 eta 0:09:05
epoch [38/50] batch [360/428] time 0.153 (0.105) data 0.000 (0.002) loss 1.3232 (1.5638) ce_loss 1.2598 (1.3710) teacher_loss 0.6531 (0.8110) loss_zs_kd 0.4067 (0.4793) loss_oracle 0.4668 (0.5132) acc 53.1250 (50.2691) kd_loss 1.0168 (0.8186) lr 3.6258e-04 eta 0:09:06
epoch [38/50] batch [380/428] time 0.070 (0.105) data 0.000 (0.002) loss 1.5270 (1.5641) ce_loss 1.3057 (1.3727) teacher_loss 0.7932 (0.8109) loss_zs_kd 0.5292 (0.4807) loss_oracle 0.4692 (0.5128) acc 68.7500 (50.2385) kd_loss 0.8486 (0.8199) lr 3.6258e-04 eta 0:09:04
epoch [38/50] batch [400/428] time 0.099 (0.104) data 0.000 (0.002) loss 1.4424 (1.5668) ce_loss 1.2500 (1.3773) teacher_loss 0.6687 (0.8130) loss_zs_kd 0.4921 (0.4819) loss_oracle 0.5276 (0.5128) acc 53.1250 (50.1016) kd_loss 0.7540 (0.8200) lr 3.6258e-04 eta 0:08:59
epoch [38/50] batch [420/428] time 0.096 (0.104) data 0.000 (0.001) loss 1.3625 (1.5650) ce_loss 1.2490 (1.3751) teacher_loss 0.5892 (0.8110) loss_zs_kd 0.4640 (0.4817) loss_oracle 0.5413 (0.5131) acc 56.2500 (50.1860) kd_loss 0.8676 (0.8203) lr 3.6258e-04 eta 0:08:56
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,927
* accuracy: 49.8%
* error: 50.2%
* macro_f1: 36.7%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,597
* accuracy: 54.8%
* error: 45.2%
* macro_f1: 29.5%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [39/50] batch [20/428] time 0.101 (0.138) data 0.000 (0.036) loss 1.5876 (1.5098) ce_loss 1.4141 (1.3531) teacher_loss 0.8401 (0.7444) loss_zs_kd 0.5359 (0.4892) loss_oracle 0.4796 (0.5207) acc 43.7500 (49.3750) kd_loss 0.7369 (0.8313) lr 3.1545e-04 eta 0:11:48
epoch [39/50] batch [40/428] time 0.117 (0.122) data 0.000 (0.018) loss 1.6932 (1.5606) ce_loss 1.4883 (1.3917) teacher_loss 0.9806 (0.7993) loss_zs_kd 0.4669 (0.4883) loss_oracle 0.4791 (0.5171) acc 53.1250 (48.7500) kd_loss 0.7871 (0.8311) lr 3.1545e-04 eta 0:10:21
epoch [39/50] batch [60/428] time 0.105 (0.116) data 0.001 (0.012) loss 1.6978 (1.5661) ce_loss 1.4824 (1.3891) teacher_loss 0.8575 (0.8047) loss_zs_kd 0.5138 (0.4872) loss_oracle 0.5834 (0.5178) acc 50.0000 (48.3854) kd_loss 0.9664 (0.8262) lr 3.1545e-04 eta 0:09:47
epoch [39/50] batch [80/428] time 0.109 (0.113) data 0.000 (0.009) loss 1.7448 (1.5717) ce_loss 1.5762 (1.3909) teacher_loss 0.9943 (0.8125) loss_zs_kd 0.5072 (0.4886) loss_oracle 0.4969 (0.5149) acc 40.6250 (48.7500) kd_loss 0.8724 (0.8217) lr 3.1545e-04 eta 0:09:33
epoch [39/50] batch [100/428] time 0.102 (0.112) data 0.000 (0.007) loss 1.3705 (1.5649) ce_loss 1.1377 (1.3785) teacher_loss 0.6192 (0.8054) loss_zs_kd 0.4843 (0.4894) loss_oracle 0.5092 (0.5148) acc 59.3750 (49.3750) kd_loss 0.9117 (0.8237) lr 3.1545e-04 eta 0:09:22
epoch [39/50] batch [120/428] time 0.101 (0.111) data 0.000 (0.006) loss 1.4823 (1.5663) ce_loss 1.3906 (1.3808) teacher_loss 0.8064 (0.8068) loss_zs_kd 0.4742 (0.4917) loss_oracle 0.4387 (0.5137) acc 50.0000 (49.4531) kd_loss 0.7262 (0.8281) lr 3.1545e-04 eta 0:09:14
epoch [39/50] batch [140/428] time 0.103 (0.110) data 0.000 (0.005) loss 1.5755 (1.5642) ce_loss 1.4365 (1.3749) teacher_loss 0.8056 (0.8049) loss_zs_kd 0.4936 (0.4921) loss_oracle 0.5231 (0.5133) acc 43.7500 (49.8214) kd_loss 0.7932 (0.8271) lr 3.1545e-04 eta 0:09:08
epoch [39/50] batch [160/428] time 0.105 (0.109) data 0.000 (0.005) loss 1.6601 (1.5617) ce_loss 1.5811 (1.3727) teacher_loss 0.9629 (0.8017) loss_zs_kd 0.4166 (0.4922) loss_oracle 0.4890 (0.5139) acc 43.7500 (49.9805) kd_loss 0.8279 (0.8273) lr 3.1545e-04 eta 0:09:03
epoch [39/50] batch [180/428] time 0.107 (0.109) data 0.000 (0.004) loss 1.3316 (1.5597) ce_loss 1.1758 (1.3701) teacher_loss 0.6300 (0.7996) loss_zs_kd 0.4627 (0.4910) loss_oracle 0.4703 (0.5146) acc 56.2500 (49.9479) kd_loss 0.8762 (0.8294) lr 3.1545e-04 eta 0:08:58
epoch [39/50] batch [200/428] time 0.103 (0.108) data 0.000 (0.004) loss 1.7538 (1.5603) ce_loss 1.5664 (1.3698) teacher_loss 0.9199 (0.8004) loss_zs_kd 0.5754 (0.4913) loss_oracle 0.5461 (0.5142) acc 46.8750 (49.8906) kd_loss 0.8679 (0.8279) lr 3.1545e-04 eta 0:08:54
epoch [39/50] batch [220/428] time 0.091 (0.106) data 0.000 (0.004) loss 1.6019 (1.5645) ce_loss 1.4355 (1.3745) teacher_loss 0.8697 (0.8057) loss_zs_kd 0.4603 (0.4901) loss_oracle 0.5021 (0.5137) acc 50.0000 (49.7585) kd_loss 0.8540 (0.8281) lr 3.1545e-04 eta 0:08:41
epoch [39/50] batch [240/428] time 0.132 (0.106) data 0.000 (0.003) loss 1.8262 (1.5652) ce_loss 1.4619 (1.3722) teacher_loss 1.0634 (0.8080) loss_zs_kd 0.4547 (0.4895) loss_oracle 0.5354 (0.5124) acc 56.2500 (49.8177) kd_loss 0.7394 (0.8264) lr 3.1545e-04 eta 0:08:36
epoch [39/50] batch [260/428] time 0.140 (0.106) data 0.000 (0.003) loss 1.5112 (1.5621) ce_loss 1.3359 (1.3721) teacher_loss 0.8148 (0.8057) loss_zs_kd 0.4557 (0.4894) loss_oracle 0.4686 (0.5117) acc 50.0000 (49.8077) kd_loss 0.8052 (0.8295) lr 3.1545e-04 eta 0:08:36
epoch [39/50] batch [280/428] time 0.080 (0.106) data 0.000 (0.003) loss 1.7582 (1.5607) ce_loss 1.4814 (1.3719) teacher_loss 1.0679 (0.8058) loss_zs_kd 0.4444 (0.4888) loss_oracle 0.4680 (0.5105) acc 46.8750 (49.8214) kd_loss 0.7572 (0.8291) lr 3.1545e-04 eta 0:08:34
epoch [39/50] batch [300/428] time 0.078 (0.107) data 0.000 (0.003) loss 1.5188 (1.5636) ce_loss 1.4355 (1.3753) teacher_loss 0.7936 (0.8105) loss_zs_kd 0.4767 (0.4876) loss_oracle 0.4868 (0.5093) acc 50.0000 (49.7604) kd_loss 0.8290 (0.8279) lr 3.1545e-04 eta 0:08:35
epoch [39/50] batch [320/428] time 0.085 (0.105) data 0.000 (0.003) loss 1.4488 (1.5616) ce_loss 1.2559 (1.3721) teacher_loss 0.7433 (0.8092) loss_zs_kd 0.4132 (0.4868) loss_oracle 0.4989 (0.5091) acc 56.2500 (49.9414) kd_loss 0.8754 (0.8276) lr 3.1545e-04 eta 0:08:26
epoch [39/50] batch [340/428] time 0.156 (0.106) data 0.000 (0.002) loss 1.5692 (1.5629) ce_loss 1.3740 (1.3731) teacher_loss 0.8026 (0.8104) loss_zs_kd 0.5685 (0.4872) loss_oracle 0.4823 (0.5089) acc 50.0000 (49.8529) kd_loss 0.8318 (0.8256) lr 3.1545e-04 eta 0:08:26
epoch [39/50] batch [360/428] time 0.073 (0.106) data 0.000 (0.002) loss 1.6484 (1.5608) ce_loss 1.3418 (1.3713) teacher_loss 0.7874 (0.8072) loss_zs_kd 0.4914 (0.4873) loss_oracle 0.6153 (0.5099) acc 56.2500 (49.8698) kd_loss 0.9609 (0.8269) lr 3.1545e-04 eta 0:08:26
epoch [39/50] batch [380/428] time 0.080 (0.106) data 0.000 (0.002) loss 1.7021 (1.5624) ce_loss 1.4990 (1.3756) teacher_loss 0.9363 (0.8087) loss_zs_kd 0.5084 (0.4869) loss_oracle 0.5117 (0.5103) acc 43.7500 (49.8026) kd_loss 0.7714 (0.8280) lr 3.1545e-04 eta 0:08:25
epoch [39/50] batch [400/428] time 0.108 (0.106) data 0.000 (0.002) loss 1.8590 (1.5648) ce_loss 1.6855 (1.3783) teacher_loss 1.0383 (0.8119) loss_zs_kd 0.4750 (0.4861) loss_oracle 0.5832 (0.5099) acc 31.2500 (49.6953) kd_loss 0.8009 (0.8270) lr 3.1545e-04 eta 0:08:21
epoch [39/50] batch [420/428] time 0.099 (0.106) data 0.000 (0.002) loss 1.7643 (1.5656) ce_loss 1.6104 (1.3790) teacher_loss 1.0371 (0.8137) loss_zs_kd 0.4424 (0.4852) loss_oracle 0.5060 (0.5093) acc 50.0000 (49.7396) kd_loss 0.9487 (0.8266) lr 3.1545e-04 eta 0:08:18
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,876
* accuracy: 48.9%
* error: 51.1%
* macro_f1: 36.0%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,640
* accuracy: 55.7%
* error: 44.3%
* macro_f1: 29.8%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [40/50] batch [20/428] time 0.109 (0.132) data 0.000 (0.029) loss 1.6173 (1.5428) ce_loss 1.5908 (1.3486) teacher_loss 0.8591 (0.7892) loss_zs_kd 0.4525 (0.4737) loss_oracle 0.5320 (0.5167) acc 37.5000 (49.8438) kd_loss 0.9296 (0.8655) lr 2.7103e-04 eta 0:10:20
epoch [40/50] batch [40/428] time 0.113 (0.118) data 0.000 (0.015) loss 1.6639 (1.5486) ce_loss 1.5430 (1.3643) teacher_loss 0.9453 (0.7901) loss_zs_kd 0.4407 (0.4836) loss_oracle 0.4983 (0.5167) acc 31.2500 (49.0625) kd_loss 0.8145 (0.8451) lr 2.7103e-04 eta 0:09:11
epoch [40/50] batch [60/428] time 0.106 (0.113) data 0.000 (0.010) loss 1.4478 (1.5462) ce_loss 1.2158 (1.3657) teacher_loss 0.7809 (0.7953) loss_zs_kd 0.3905 (0.4822) loss_oracle 0.4717 (0.5098) acc 62.5000 (49.4792) kd_loss 0.9484 (0.8472) lr 2.7103e-04 eta 0:08:46
epoch [40/50] batch [80/428] time 0.096 (0.111) data 0.000 (0.007) loss 1.7756 (1.5420) ce_loss 1.6016 (1.3526) teacher_loss 0.9632 (0.7958) loss_zs_kd 0.4875 (0.4820) loss_oracle 0.5686 (0.5052) acc 46.8750 (50.5078) kd_loss 0.8213 (0.8380) lr 2.7103e-04 eta 0:08:33
epoch [40/50] batch [100/428] time 0.111 (0.109) data 0.000 (0.006) loss 1.4003 (1.5421) ce_loss 1.1602 (1.3546) teacher_loss 0.7294 (0.7965) loss_zs_kd 0.4453 (0.4788) loss_oracle 0.4482 (0.5062) acc 56.2500 (50.3125) kd_loss 0.8366 (0.8355) lr 2.7103e-04 eta 0:08:23
epoch [40/50] batch [120/428] time 0.117 (0.109) data 0.000 (0.005) loss 1.4813 (1.5419) ce_loss 1.2607 (1.3508) teacher_loss 0.7139 (0.7968) loss_zs_kd 0.4717 (0.4798) loss_oracle 0.5315 (0.5052) acc 59.3750 (50.5208) kd_loss 0.7896 (0.8359) lr 2.7103e-04 eta 0:08:17
epoch [40/50] batch [140/428] time 0.105 (0.108) data 0.000 (0.004) loss 1.5016 (1.5390) ce_loss 1.5420 (1.3474) teacher_loss 0.7515 (0.7950) loss_zs_kd 0.4548 (0.4793) loss_oracle 0.5227 (0.5044) acc 40.6250 (50.7143) kd_loss 0.9976 (0.8364) lr 2.7103e-04 eta 0:08:12
epoch [40/50] batch [160/428] time 0.109 (0.107) data 0.000 (0.004) loss 1.9664 (1.5450) ce_loss 2.0059 (1.3591) teacher_loss 1.2731 (0.8023) loss_zs_kd 0.4722 (0.4777) loss_oracle 0.4572 (0.5039) acc 28.1250 (50.6055) kd_loss 0.8329 (0.8352) lr 2.7103e-04 eta 0:08:08
epoch [40/50] batch [180/428] time 0.100 (0.107) data 0.000 (0.003) loss 1.6189 (1.5455) ce_loss 1.4268 (1.3614) teacher_loss 0.9356 (0.8028) loss_zs_kd 0.4457 (0.4795) loss_oracle 0.4605 (0.5030) acc 43.7500 (50.3125) kd_loss 0.8011 (0.8381) lr 2.7103e-04 eta 0:08:04
epoch [40/50] batch [200/428] time 0.104 (0.107) data 0.000 (0.003) loss 1.6190 (1.5472) ce_loss 1.4785 (1.3661) teacher_loss 0.9279 (0.8050) loss_zs_kd 0.5361 (0.4792) loss_oracle 0.4230 (0.5025) acc 59.3750 (50.1562) kd_loss 0.7472 (0.8356) lr 2.7103e-04 eta 0:08:00
epoch [40/50] batch [220/428] time 0.087 (0.106) data 0.000 (0.003) loss 1.4817 (1.5470) ce_loss 1.2559 (1.3677) teacher_loss 0.7460 (0.8042) loss_zs_kd 0.4826 (0.4801) loss_oracle 0.4944 (0.5027) acc 53.1250 (50.1847) kd_loss 0.7090 (0.8351) lr 2.7103e-04 eta 0:07:53
epoch [40/50] batch [240/428] time 0.078 (0.105) data 0.000 (0.003) loss 1.5059 (1.5451) ce_loss 1.3359 (1.3660) teacher_loss 0.7449 (0.8017) loss_zs_kd 0.4742 (0.4812) loss_oracle 0.5239 (0.5027) acc 40.6250 (50.2214) kd_loss 0.9387 (0.8358) lr 2.7103e-04 eta 0:07:49
epoch [40/50] batch [260/428] time 0.071 (0.106) data 0.000 (0.002) loss 1.4573 (1.5477) ce_loss 1.1807 (1.3675) teacher_loss 0.7514 (0.8031) loss_zs_kd 0.4053 (0.4831) loss_oracle 0.5032 (0.5031) acc 53.1250 (50.2284) kd_loss 0.8530 (0.8356) lr 2.7103e-04 eta 0:07:49
epoch [40/50] batch [280/428] time 0.074 (0.106) data 0.000 (0.002) loss 1.3634 (1.5498) ce_loss 1.2158 (1.3693) teacher_loss 0.6096 (0.8044) loss_zs_kd 0.5060 (0.4825) loss_oracle 0.5008 (0.5042) acc 53.1250 (50.0558) kd_loss 0.8954 (0.8378) lr 2.7103e-04 eta 0:07:47
epoch [40/50] batch [300/428] time 0.093 (0.106) data 0.000 (0.002) loss 1.5150 (1.5514) ce_loss 1.3867 (1.3727) teacher_loss 0.7448 (0.8047) loss_zs_kd 0.5021 (0.4824) loss_oracle 0.5191 (0.5055) acc 43.7500 (50.0417) kd_loss 0.9981 (0.8391) lr 2.7103e-04 eta 0:07:47
epoch [40/50] batch [320/428] time 0.082 (0.106) data 0.000 (0.002) loss 1.6069 (1.5515) ce_loss 1.3633 (1.3702) teacher_loss 0.8674 (0.8048) loss_zs_kd 0.4452 (0.4832) loss_oracle 0.5169 (0.5051) acc 50.0000 (50.2734) kd_loss 0.8172 (0.8384) lr 2.7103e-04 eta 0:07:42
epoch [40/50] batch [340/428] time 0.079 (0.106) data 0.000 (0.002) loss 1.6053 (1.5502) ce_loss 1.4336 (1.3702) teacher_loss 0.9043 (0.8038) loss_zs_kd 0.4641 (0.4830) loss_oracle 0.4689 (0.5049) acc 43.7500 (50.3033) kd_loss 0.7421 (0.8392) lr 2.7103e-04 eta 0:07:42
epoch [40/50] batch [360/428] time 0.076 (0.106) data 0.000 (0.002) loss 1.6940 (1.5524) ce_loss 1.4287 (1.3701) teacher_loss 0.8786 (0.8053) loss_zs_kd 0.4973 (0.4835) loss_oracle 0.5667 (0.5053) acc 43.7500 (50.2170) kd_loss 0.8320 (0.8375) lr 2.7103e-04 eta 0:07:42
epoch [40/50] batch [380/428] time 0.073 (0.107) data 0.000 (0.002) loss 1.7401 (1.5507) ce_loss 1.5420 (1.3683) teacher_loss 0.9196 (0.8034) loss_zs_kd 0.4922 (0.4832) loss_oracle 0.5744 (0.5058) acc 46.8750 (50.2632) kd_loss 0.8584 (0.8384) lr 2.7103e-04 eta 0:07:41
epoch [40/50] batch [400/428] time 0.103 (0.106) data 0.000 (0.002) loss 1.6105 (1.5524) ce_loss 1.4092 (1.3711) teacher_loss 0.8248 (0.8043) loss_zs_kd 0.4530 (0.4828) loss_oracle 0.5593 (0.5067) acc 53.1250 (50.2266) kd_loss 0.9898 (0.8395) lr 2.7103e-04 eta 0:07:36
epoch [40/50] batch [420/428] time 0.099 (0.106) data 0.000 (0.002) loss 1.6978 (1.5530) ce_loss 1.6768 (1.3728) teacher_loss 0.9489 (0.8042) loss_zs_kd 0.4864 (0.4836) loss_oracle 0.5057 (0.5070) acc 28.1250 (50.1488) kd_loss 0.9102 (0.8386) lr 2.7103e-04 eta 0:07:33
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,965
* accuracy: 50.5%
* error: 49.5%
* macro_f1: 36.7%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,588
* accuracy: 54.6%
* error: 45.4%
* macro_f1: 30.4%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [41/50] batch [20/428] time 0.101 (0.134) data 0.000 (0.030) loss 1.5383 (1.5543) ce_loss 1.1582 (1.3332) teacher_loss 0.7933 (0.8017) loss_zs_kd 0.4511 (0.4972) loss_oracle 0.5194 (0.5040) acc 62.5000 (51.0938) kd_loss 0.7950 (0.8272) lr 2.2949e-04 eta 0:09:31
epoch [41/50] batch [40/428] time 0.110 (0.119) data 0.000 (0.015) loss 1.4587 (1.5567) ce_loss 1.2598 (1.3727) teacher_loss 0.6900 (0.8011) loss_zs_kd 0.5228 (0.4984) loss_oracle 0.5073 (0.5064) acc 59.3750 (50.2344) kd_loss 0.7783 (0.8443) lr 2.2949e-04 eta 0:08:24
epoch [41/50] batch [60/428] time 0.109 (0.114) data 0.001 (0.010) loss 1.3673 (1.5764) ce_loss 1.1279 (1.3905) teacher_loss 0.6284 (0.8190) loss_zs_kd 0.4977 (0.5039) loss_oracle 0.4900 (0.5054) acc 56.2500 (48.5938) kd_loss 0.7477 (0.8418) lr 2.2949e-04 eta 0:07:59
epoch [41/50] batch [80/428] time 0.106 (0.111) data 0.000 (0.008) loss 1.6225 (1.5667) ce_loss 1.4990 (1.3933) teacher_loss 0.8066 (0.8111) loss_zs_kd 0.5049 (0.5031) loss_oracle 0.5635 (0.5041) acc 50.0000 (48.0469) kd_loss 0.9062 (0.8435) lr 2.2949e-04 eta 0:07:46
epoch [41/50] batch [100/428] time 0.099 (0.109) data 0.000 (0.006) loss 1.4902 (1.5615) ce_loss 1.4443 (1.3909) teacher_loss 0.7522 (0.8084) loss_zs_kd 0.4908 (0.5036) loss_oracle 0.4927 (0.5013) acc 46.8750 (48.3750) kd_loss 0.9100 (0.8409) lr 2.2949e-04 eta 0:07:37
epoch [41/50] batch [120/428] time 0.104 (0.108) data 0.000 (0.005) loss 1.3314 (1.5597) ce_loss 1.1699 (1.3902) teacher_loss 0.6509 (0.8079) loss_zs_kd 0.4467 (0.4999) loss_oracle 0.4571 (0.5018) acc 53.1250 (48.5156) kd_loss 0.7808 (0.8416) lr 2.2949e-04 eta 0:07:28
epoch [41/50] batch [140/428] time 0.104 (0.108) data 0.000 (0.004) loss 1.8416 (1.5593) ce_loss 1.6133 (1.3888) teacher_loss 1.0671 (0.8061) loss_zs_kd 0.5560 (0.4999) loss_oracle 0.4965 (0.5032) acc 37.5000 (48.6161) kd_loss 0.6537 (0.8369) lr 2.2949e-04 eta 0:07:25
epoch [41/50] batch [160/428] time 0.105 (0.107) data 0.000 (0.004) loss 1.5932 (1.5601) ce_loss 1.4365 (1.3883) teacher_loss 0.9031 (0.8086) loss_zs_kd 0.4314 (0.4972) loss_oracle 0.4744 (0.5029) acc 40.6250 (48.6523) kd_loss 0.8845 (0.8369) lr 2.2949e-04 eta 0:07:21
epoch [41/50] batch [180/428] time 0.092 (0.107) data 0.000 (0.004) loss 1.3722 (1.5590) ce_loss 1.3066 (1.3859) teacher_loss 0.6322 (0.8078) loss_zs_kd 0.4667 (0.4969) loss_oracle 0.5067 (0.5028) acc 59.3750 (49.1146) kd_loss 0.8380 (0.8370) lr 2.2949e-04 eta 0:07:17
epoch [41/50] batch [200/428] time 0.100 (0.106) data 0.000 (0.003) loss 1.4894 (1.5560) ce_loss 1.3389 (1.3810) teacher_loss 0.7311 (0.8052) loss_zs_kd 0.5285 (0.4946) loss_oracle 0.4941 (0.5035) acc 50.0000 (49.2656) kd_loss 0.8083 (0.8380) lr 2.2949e-04 eta 0:07:14
epoch [41/50] batch [220/428] time 0.083 (0.105) data 0.000 (0.003) loss 1.8695 (1.5576) ce_loss 1.4521 (1.3786) teacher_loss 1.1326 (0.8069) loss_zs_kd 0.4894 (0.4937) loss_oracle 0.4922 (0.5039) acc 50.0000 (49.2898) kd_loss 0.6627 (0.8373) lr 2.2949e-04 eta 0:07:04
epoch [41/50] batch [240/428] time 0.156 (0.104) data 0.000 (0.003) loss 1.4473 (1.5564) ce_loss 1.0977 (1.3754) teacher_loss 0.7583 (0.8057) loss_zs_kd 0.4236 (0.4927) loss_oracle 0.4773 (0.5043) acc 56.2500 (49.4141) kd_loss 0.7257 (0.8355) lr 2.2949e-04 eta 0:07:01
epoch [41/50] batch [260/428] time 0.077 (0.105) data 0.000 (0.003) loss 1.6971 (1.5572) ce_loss 1.3906 (1.3749) teacher_loss 0.9935 (0.8057) loss_zs_kd 0.4629 (0.4923) loss_oracle 0.4721 (0.5053) acc 40.6250 (49.3269) kd_loss 0.6217 (0.8333) lr 2.2949e-04 eta 0:07:01
epoch [41/50] batch [280/428] time 0.194 (0.105) data 0.000 (0.002) loss 1.5246 (1.5573) ce_loss 1.4043 (1.3738) teacher_loss 0.7767 (0.8059) loss_zs_kd 0.4544 (0.4904) loss_oracle 0.5206 (0.5062) acc 43.7500 (49.3638) kd_loss 0.8088 (0.8327) lr 2.2949e-04 eta 0:07:00
epoch [41/50] batch [300/428] time 0.211 (0.106) data 0.000 (0.002) loss 1.6301 (1.5547) ce_loss 1.3594 (1.3704) teacher_loss 0.8659 (0.8045) loss_zs_kd 0.5413 (0.4898) loss_oracle 0.4936 (0.5053) acc 43.7500 (49.4792) kd_loss 0.6465 (0.8299) lr 2.2949e-04 eta 0:07:03
epoch [41/50] batch [320/428] time 0.085 (0.105) data 0.000 (0.002) loss 1.4758 (1.5566) ce_loss 1.4053 (1.3749) teacher_loss 0.7006 (0.8075) loss_zs_kd 0.4889 (0.4877) loss_oracle 0.5307 (0.5052) acc 46.8750 (49.3164) kd_loss 0.8257 (0.8290) lr 2.2949e-04 eta 0:06:57
epoch [41/50] batch [340/428] time 0.174 (0.106) data 0.000 (0.002) loss 1.5345 (1.5571) ce_loss 1.3936 (1.3750) teacher_loss 0.7963 (0.8070) loss_zs_kd 0.4762 (0.4886) loss_oracle 0.5001 (0.5058) acc 53.1250 (49.4761) kd_loss 0.7423 (0.8274) lr 2.2949e-04 eta 0:06:55
epoch [41/50] batch [360/428] time 0.176 (0.106) data 0.000 (0.002) loss 1.3349 (1.5520) ce_loss 1.0723 (1.3695) teacher_loss 0.6093 (0.8025) loss_zs_kd 0.4226 (0.4882) loss_oracle 0.5143 (0.5054) acc 59.3750 (49.7222) kd_loss 0.8139 (0.8269) lr 2.2949e-04 eta 0:06:56
epoch [41/50] batch [380/428] time 0.078 (0.106) data 0.000 (0.002) loss 1.1716 (1.5519) ce_loss 1.0967 (1.3709) teacher_loss 0.4925 (0.8023) loss_zs_kd 0.3754 (0.4880) loss_oracle 0.4915 (0.5056) acc 53.1250 (49.6793) kd_loss 0.8682 (0.8271) lr 2.2949e-04 eta 0:06:53
epoch [41/50] batch [400/428] time 0.096 (0.106) data 0.000 (0.002) loss 1.4828 (1.5542) ce_loss 1.1201 (1.3727) teacher_loss 0.7325 (0.8051) loss_zs_kd 0.5010 (0.4875) loss_oracle 0.4998 (0.5053) acc 65.6250 (49.6016) kd_loss 0.8461 (0.8249) lr 2.2949e-04 eta 0:06:49
epoch [41/50] batch [420/428] time 0.098 (0.105) data 0.000 (0.002) loss 1.4441 (1.5580) ce_loss 1.2598 (1.3764) teacher_loss 0.7272 (0.8084) loss_zs_kd 0.4663 (0.4880) loss_oracle 0.4837 (0.5056) acc 53.1250 (49.4196) kd_loss 0.7561 (0.8241) lr 2.2949e-04 eta 0:06:46
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,937
* accuracy: 50.0%
* error: 50.0%
* macro_f1: 36.6%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,542
* accuracy: 53.6%
* error: 46.4%
* macro_f1: 29.6%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [42/50] batch [20/428] time 0.103 (0.132) data 0.000 (0.027) loss 1.4993 (1.5371) ce_loss 1.4443 (1.3455) teacher_loss 0.8375 (0.7930) loss_zs_kd 0.3746 (0.4838) loss_oracle 0.4745 (0.5021) acc 43.7500 (47.6562) kd_loss 0.8858 (0.8117) lr 1.9098e-04 eta 0:08:26
epoch [42/50] batch [40/428] time 0.099 (0.118) data 0.000 (0.014) loss 1.6323 (1.5734) ce_loss 1.6357 (1.3845) teacher_loss 0.8383 (0.8281) loss_zs_kd 0.5141 (0.4842) loss_oracle 0.5369 (0.5032) acc 37.5000 (48.5938) kd_loss 0.8238 (0.8205) lr 1.9098e-04 eta 0:07:29
epoch [42/50] batch [60/428] time 0.100 (0.113) data 0.001 (0.009) loss 1.7212 (1.5706) ce_loss 1.6777 (1.3783) teacher_loss 0.9518 (0.8294) loss_zs_kd 0.5180 (0.4820) loss_oracle 0.5105 (0.5002) acc 37.5000 (49.1146) kd_loss 0.9106 (0.8138) lr 1.9098e-04 eta 0:07:06
epoch [42/50] batch [80/428] time 0.101 (0.110) data 0.000 (0.007) loss 1.2025 (1.5620) ce_loss 1.0146 (1.3654) teacher_loss 0.5015 (0.8223) loss_zs_kd 0.4711 (0.4776) loss_oracle 0.4655 (0.5010) acc 62.5000 (49.6875) kd_loss 0.9692 (0.8114) lr 1.9098e-04 eta 0:06:56
epoch [42/50] batch [100/428] time 0.093 (0.108) data 0.000 (0.006) loss 1.6913 (1.5602) ce_loss 1.6416 (1.3660) teacher_loss 0.9461 (0.8189) loss_zs_kd 0.4416 (0.4789) loss_oracle 0.5244 (0.5018) acc 37.5000 (49.7188) kd_loss 1.0214 (0.8168) lr 1.9098e-04 eta 0:06:46
epoch [42/50] batch [120/428] time 0.092 (0.107) data 0.000 (0.005) loss 1.5692 (1.5611) ce_loss 1.4365 (1.3726) teacher_loss 0.8085 (0.8167) loss_zs_kd 0.4649 (0.4825) loss_oracle 0.5282 (0.5031) acc 50.0000 (49.8698) kd_loss 0.9896 (0.8222) lr 1.9098e-04 eta 0:06:38
epoch [42/50] batch [140/428] time 0.099 (0.105) data 0.000 (0.004) loss 1.7043 (1.5621) ce_loss 1.5830 (1.3741) teacher_loss 1.0198 (0.8173) loss_zs_kd 0.4512 (0.4825) loss_oracle 0.4589 (0.5035) acc 37.5000 (49.9554) kd_loss 0.8261 (0.8223) lr 1.9098e-04 eta 0:06:29
epoch [42/50] batch [160/428] time 0.095 (0.103) data 0.000 (0.004) loss 1.6626 (1.5624) ce_loss 1.4258 (1.3763) teacher_loss 0.8082 (0.8168) loss_zs_kd 0.5472 (0.4838) loss_oracle 0.5808 (0.5037) acc 46.8750 (49.8633) kd_loss 0.8715 (0.8269) lr 1.9098e-04 eta 0:06:22
epoch [42/50] batch [180/428] time 0.104 (0.103) data 0.000 (0.003) loss 1.7879 (1.5608) ce_loss 1.5713 (1.3809) teacher_loss 1.0455 (0.8137) loss_zs_kd 0.5066 (0.4857) loss_oracle 0.4891 (0.5043) acc 43.7500 (49.7222) kd_loss 0.6735 (0.8296) lr 1.9098e-04 eta 0:06:16
epoch [42/50] batch [200/428] time 0.081 (0.101) data 0.000 (0.003) loss 1.4273 (1.5533) ce_loss 1.2432 (1.3722) teacher_loss 0.5946 (0.8057) loss_zs_kd 0.4465 (0.4863) loss_oracle 0.6094 (0.5045) acc 56.2500 (50.1094) kd_loss 1.0179 (0.8294) lr 1.9098e-04 eta 0:06:10
epoch [42/50] batch [220/428] time 0.161 (0.102) data 0.000 (0.003) loss 1.4389 (1.5531) ce_loss 1.2041 (1.3739) teacher_loss 0.7417 (0.8040) loss_zs_kd 0.4879 (0.4882) loss_oracle 0.4532 (0.5050) acc 59.3750 (50.2415) kd_loss 0.7162 (0.8275) lr 1.9098e-04 eta 0:06:11
epoch [42/50] batch [240/428] time 0.139 (0.103) data 0.000 (0.003) loss 1.3991 (1.5544) ce_loss 1.3164 (1.3754) teacher_loss 0.6371 (0.8033) loss_zs_kd 0.4269 (0.4884) loss_oracle 0.5485 (0.5070) acc 53.1250 (50.1562) kd_loss 0.8610 (0.8278) lr 1.9098e-04 eta 0:06:12
epoch [42/50] batch [260/428] time 0.153 (0.105) data 0.000 (0.002) loss 1.6499 (1.5515) ce_loss 1.6455 (1.3695) teacher_loss 0.9280 (0.7994) loss_zs_kd 0.4766 (0.4888) loss_oracle 0.4836 (0.5078) acc 46.8750 (50.3606) kd_loss 0.8021 (0.8271) lr 1.9098e-04 eta 0:06:17
epoch [42/50] batch [280/428] time 0.069 (0.105) data 0.000 (0.002) loss 1.5741 (1.5545) ce_loss 1.5098 (1.3722) teacher_loss 0.8830 (0.8020) loss_zs_kd 0.4678 (0.4898) loss_oracle 0.4572 (0.5076) acc 40.6250 (50.2455) kd_loss 0.7477 (0.8259) lr 1.9098e-04 eta 0:06:13
epoch [42/50] batch [300/428] time 0.172 (0.104) data 0.000 (0.002) loss 1.3871 (1.5547) ce_loss 1.1279 (1.3698) teacher_loss 0.6370 (0.8031) loss_zs_kd 0.4774 (0.4894) loss_oracle 0.5115 (0.5069) acc 53.1250 (50.2604) kd_loss 0.8610 (0.8243) lr 1.9098e-04 eta 0:06:10
epoch [42/50] batch [320/428] time 0.089 (0.105) data 0.000 (0.002) loss 1.6831 (1.5560) ce_loss 1.4473 (1.3706) teacher_loss 0.8935 (0.8050) loss_zs_kd 0.5154 (0.4876) loss_oracle 0.5320 (0.5073) acc 46.8750 (50.1855) kd_loss 0.8646 (0.8246) lr 1.9098e-04 eta 0:06:11
epoch [42/50] batch [340/428] time 0.084 (0.105) data 0.000 (0.002) loss 1.5575 (1.5573) ce_loss 1.2764 (1.3723) teacher_loss 0.7927 (0.8061) loss_zs_kd 0.4996 (0.4875) loss_oracle 0.5150 (0.5075) acc 56.2500 (50.0460) kd_loss 0.8281 (0.8234) lr 1.9098e-04 eta 0:06:09
epoch [42/50] batch [360/428] time 0.116 (0.105) data 0.000 (0.002) loss 1.3452 (1.5562) ce_loss 1.0977 (1.3707) teacher_loss 0.5804 (0.8046) loss_zs_kd 0.5180 (0.4878) loss_oracle 0.5058 (0.5077) acc 59.3750 (50.1823) kd_loss 0.8737 (0.8245) lr 1.9098e-04 eta 0:06:06
epoch [42/50] batch [380/428] time 0.110 (0.104) data 0.000 (0.002) loss 1.5133 (1.5547) ce_loss 1.3105 (1.3661) teacher_loss 0.7655 (0.8038) loss_zs_kd 0.4672 (0.4867) loss_oracle 0.5142 (0.5076) acc 50.0000 (50.3454) kd_loss 0.7333 (0.8232) lr 1.9098e-04 eta 0:06:01
epoch [42/50] batch [400/428] time 0.099 (0.104) data 0.000 (0.002) loss 1.5969 (1.5547) ce_loss 1.3096 (1.3659) teacher_loss 0.8211 (0.8036) loss_zs_kd 0.5500 (0.4860) loss_oracle 0.5008 (0.5081) acc 56.2500 (50.3047) kd_loss 0.6981 (0.8220) lr 1.9098e-04 eta 0:05:58
epoch [42/50] batch [420/428] time 0.092 (0.104) data 0.000 (0.002) loss 1.3924 (1.5546) ce_loss 1.3105 (1.3643) teacher_loss 0.6537 (0.8040) loss_zs_kd 0.4649 (0.4854) loss_oracle 0.5063 (0.5079) acc 65.6250 (50.3795) kd_loss 0.9889 (0.8217) lr 1.9098e-04 eta 0:05:55
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,975
* accuracy: 50.6%
* error: 49.4%
* macro_f1: 37.6%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,568
* accuracy: 54.2%
* error: 45.8%
* macro_f1: 30.2%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [43/50] batch [20/428] time 0.106 (0.120) data 0.000 (0.025) loss 1.7087 (1.5869) ce_loss 1.4619 (1.3699) teacher_loss 0.9734 (0.8428) loss_zs_kd 0.5512 (0.4859) loss_oracle 0.4598 (0.5011) acc 37.5000 (50.9375) kd_loss 0.7622 (0.7860) lr 1.5567e-04 eta 0:06:48
epoch [43/50] batch [40/428] time 0.112 (0.112) data 0.000 (0.013) loss 1.7755 (1.5650) ce_loss 1.5322 (1.3625) teacher_loss 1.0678 (0.8286) loss_zs_kd 0.4608 (0.4779) loss_oracle 0.4774 (0.4975) acc 46.8750 (51.2500) kd_loss 0.7974 (0.7901) lr 1.5567e-04 eta 0:06:19
epoch [43/50] batch [60/428] time 0.116 (0.110) data 0.001 (0.009) loss 1.4696 (1.5354) ce_loss 1.3359 (1.3402) teacher_loss 0.7572 (0.7982) loss_zs_kd 0.4226 (0.4770) loss_oracle 0.5011 (0.4987) acc 50.0000 (51.5625) kd_loss 0.8032 (0.8038) lr 1.5567e-04 eta 0:06:09
epoch [43/50] batch [80/428] time 0.103 (0.108) data 0.000 (0.007) loss 1.6879 (1.5622) ce_loss 1.5742 (1.3703) teacher_loss 0.9031 (0.8173) loss_zs_kd 0.5345 (0.4828) loss_oracle 0.5176 (0.5034) acc 40.6250 (50.0000) kd_loss 0.7328 (0.8045) lr 1.5567e-04 eta 0:06:02
epoch [43/50] batch [100/428] time 0.111 (0.108) data 0.000 (0.005) loss 1.6568 (1.5632) ce_loss 1.6504 (1.3639) teacher_loss 0.9326 (0.8172) loss_zs_kd 0.4819 (0.4826) loss_oracle 0.4832 (0.5047) acc 37.5000 (50.2500) kd_loss 0.8270 (0.8012) lr 1.5567e-04 eta 0:05:57
epoch [43/50] batch [120/428] time 0.096 (0.107) data 0.000 (0.004) loss 1.6098 (1.5636) ce_loss 1.3320 (1.3622) teacher_loss 0.7898 (0.8190) loss_zs_kd 0.4600 (0.4838) loss_oracle 0.5900 (0.5028) acc 65.6250 (50.6510) kd_loss 0.9337 (0.8023) lr 1.5567e-04 eta 0:05:53
epoch [43/50] batch [140/428] time 0.105 (0.107) data 0.000 (0.004) loss 1.6608 (1.5636) ce_loss 1.3584 (1.3630) teacher_loss 0.8851 (0.8165) loss_zs_kd 0.5367 (0.4846) loss_oracle 0.5074 (0.5049) acc 50.0000 (50.6696) kd_loss 0.7602 (0.8060) lr 1.5567e-04 eta 0:05:50
epoch [43/50] batch [160/428] time 0.113 (0.107) data 0.000 (0.003) loss 1.5687 (1.5665) ce_loss 1.3320 (1.3658) teacher_loss 0.8336 (0.8215) loss_zs_kd 0.4158 (0.4831) loss_oracle 0.5271 (0.5035) acc 53.1250 (50.4102) kd_loss 0.7652 (0.8058) lr 1.5567e-04 eta 0:05:48
epoch [43/50] batch [180/428] time 0.076 (0.105) data 0.000 (0.003) loss 1.2425 (1.5669) ce_loss 1.0840 (1.3670) teacher_loss 0.5848 (0.8243) loss_zs_kd 0.4205 (0.4819) loss_oracle 0.4475 (0.5016) acc 62.5000 (50.4688) kd_loss 0.8458 (0.8080) lr 1.5567e-04 eta 0:05:41
epoch [43/50] batch [200/428] time 0.078 (0.104) data 0.000 (0.003) loss 1.5663 (1.5678) ce_loss 1.3848 (1.3704) teacher_loss 0.8618 (0.8242) loss_zs_kd 0.4678 (0.4816) loss_oracle 0.4706 (0.5028) acc 56.2500 (50.3906) kd_loss 0.8716 (0.8129) lr 1.5567e-04 eta 0:05:35
epoch [43/50] batch [220/428] time 0.069 (0.105) data 0.000 (0.003) loss 1.5574 (1.5687) ce_loss 1.5039 (1.3696) teacher_loss 0.8362 (0.8249) loss_zs_kd 0.4048 (0.4813) loss_oracle 0.5188 (0.5031) acc 40.6250 (50.5398) kd_loss 0.7478 (0.8129) lr 1.5567e-04 eta 0:05:35
epoch [43/50] batch [240/428] time 0.158 (0.106) data 0.000 (0.002) loss 1.5405 (1.5663) ce_loss 1.3818 (1.3676) teacher_loss 0.7256 (0.8225) loss_zs_kd 0.4499 (0.4816) loss_oracle 0.5899 (0.5030) acc 43.7500 (50.5990) kd_loss 0.8841 (0.8109) lr 1.5567e-04 eta 0:05:36
epoch [43/50] batch [260/428] time 0.159 (0.105) data 0.000 (0.002) loss 1.4052 (1.5681) ce_loss 1.3379 (1.3677) teacher_loss 0.7156 (0.8241) loss_zs_kd 0.4204 (0.4817) loss_oracle 0.4794 (0.5031) acc 50.0000 (50.6971) kd_loss 0.8765 (0.8095) lr 1.5567e-04 eta 0:05:33
epoch [43/50] batch [280/428] time 0.073 (0.103) data 0.000 (0.002) loss 1.5606 (1.5688) ce_loss 1.6416 (1.3702) teacher_loss 0.8314 (0.8263) loss_zs_kd 0.4167 (0.4807) loss_oracle 0.5209 (0.5021) acc 28.1250 (50.4464) kd_loss 0.9159 (0.8071) lr 1.5567e-04 eta 0:05:24
epoch [43/50] batch [300/428] time 0.173 (0.103) data 0.000 (0.002) loss 1.3260 (1.5679) ce_loss 1.1875 (1.3689) teacher_loss 0.6254 (0.8264) loss_zs_kd 0.5276 (0.4801) loss_oracle 0.4368 (0.5015) acc 59.3750 (50.4792) kd_loss 0.8023 (0.8064) lr 1.5567e-04 eta 0:05:20
epoch [43/50] batch [320/428] time 0.170 (0.103) data 0.000 (0.002) loss 1.4788 (1.5667) ce_loss 1.0713 (1.3688) teacher_loss 0.7717 (0.8254) loss_zs_kd 0.4186 (0.4798) loss_oracle 0.4978 (0.5014) acc 59.3750 (50.4102) kd_loss 0.8017 (0.8068) lr 1.5567e-04 eta 0:05:19
epoch [43/50] batch [340/428] time 0.144 (0.103) data 0.000 (0.002) loss 1.2780 (1.5622) ce_loss 1.0430 (1.3629) teacher_loss 0.5613 (0.8204) loss_zs_kd 0.4544 (0.4797) loss_oracle 0.4895 (0.5020) acc 56.2500 (50.6342) kd_loss 0.7127 (0.8084) lr 1.5567e-04 eta 0:05:19
epoch [43/50] batch [360/428] time 0.074 (0.103) data 0.000 (0.002) loss 1.6723 (1.5614) ce_loss 1.6250 (1.3643) teacher_loss 0.8990 (0.8190) loss_zs_kd 0.4542 (0.4794) loss_oracle 0.5462 (0.5027) acc 31.2500 (50.4080) kd_loss 0.8584 (0.8101) lr 1.5567e-04 eta 0:05:15
epoch [43/50] batch [380/428] time 0.101 (0.103) data 0.000 (0.002) loss 1.8338 (1.5619) ce_loss 1.4736 (1.3641) teacher_loss 1.1066 (0.8193) loss_zs_kd 0.4756 (0.4799) loss_oracle 0.4894 (0.5026) acc 40.6250 (50.5099) kd_loss 0.6309 (0.8102) lr 1.5567e-04 eta 0:05:12
epoch [43/50] batch [400/428] time 0.109 (0.102) data 0.000 (0.002) loss 1.3164 (1.5609) ce_loss 1.2725 (1.3637) teacher_loss 0.5757 (0.8180) loss_zs_kd 0.4339 (0.4796) loss_oracle 0.5238 (0.5031) acc 53.1250 (50.4297) kd_loss 1.0580 (0.8114) lr 1.5567e-04 eta 0:05:09
epoch [43/50] batch [420/428] time 0.100 (0.102) data 0.000 (0.001) loss 1.3997 (1.5591) ce_loss 1.1748 (1.3625) teacher_loss 0.6333 (0.8169) loss_zs_kd 0.5064 (0.4782) loss_oracle 0.5133 (0.5031) acc 62.5000 (50.4762) kd_loss 0.9057 (0.8118) lr 1.5567e-04 eta 0:05:07
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,957
* accuracy: 50.3%
* error: 49.7%
* macro_f1: 37.0%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,595
* accuracy: 54.7%
* error: 45.3%
* macro_f1: 30.0%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [44/50] batch [20/428] time 0.105 (0.140) data 0.000 (0.032) loss 1.7165 (1.5481) ce_loss 1.6270 (1.3546) teacher_loss 0.9920 (0.8186) loss_zs_kd 0.4542 (0.4852) loss_oracle 0.4974 (0.4870) acc 43.7500 (49.6875) kd_loss 0.8714 (0.7905) lr 1.2369e-04 eta 0:06:55
epoch [44/50] batch [40/428] time 0.108 (0.123) data 0.000 (0.016) loss 1.8685 (1.5541) ce_loss 1.6221 (1.3536) teacher_loss 0.9827 (0.8052) loss_zs_kd 0.5686 (0.4856) loss_oracle 0.6015 (0.5061) acc 43.7500 (49.1406) kd_loss 0.9000 (0.8009) lr 1.2369e-04 eta 0:06:04
epoch [44/50] batch [60/428] time 0.111 (0.116) data 0.001 (0.011) loss 1.5298 (1.5643) ce_loss 1.2930 (1.3559) teacher_loss 0.8147 (0.8140) loss_zs_kd 0.4243 (0.4866) loss_oracle 0.5029 (0.5070) acc 50.0000 (49.9479) kd_loss 0.6499 (0.7905) lr 1.2369e-04 eta 0:05:41
epoch [44/50] batch [80/428] time 0.101 (0.113) data 0.000 (0.008) loss 1.7815 (1.5677) ce_loss 1.5684 (1.3650) teacher_loss 1.0146 (0.8176) loss_zs_kd 0.4721 (0.4834) loss_oracle 0.5309 (0.5084) acc 37.5000 (49.4141) kd_loss 0.8471 (0.7887) lr 1.2369e-04 eta 0:05:30
epoch [44/50] batch [100/428] time 0.108 (0.112) data 0.000 (0.007) loss 1.5823 (1.5635) ce_loss 1.4277 (1.3641) teacher_loss 0.8958 (0.8166) loss_zs_kd 0.4187 (0.4805) loss_oracle 0.4771 (0.5067) acc 46.8750 (49.6562) kd_loss 0.7479 (0.7921) lr 1.2369e-04 eta 0:05:24
epoch [44/50] batch [120/428] time 0.112 (0.111) data 0.000 (0.006) loss 1.4023 (1.5614) ce_loss 1.1123 (1.3690) teacher_loss 0.6304 (0.8158) loss_zs_kd 0.4622 (0.4798) loss_oracle 0.5407 (0.5057) acc 56.2500 (49.7917) kd_loss 0.8392 (0.7971) lr 1.2369e-04 eta 0:05:19
epoch [44/50] batch [140/428] time 0.103 (0.110) data 0.000 (0.005) loss 1.3749 (1.5623) ce_loss 1.1885 (1.3695) teacher_loss 0.6312 (0.8155) loss_zs_kd 0.5131 (0.4803) loss_oracle 0.4872 (0.5066) acc 59.3750 (49.9554) kd_loss 0.8409 (0.8001) lr 1.2369e-04 eta 0:05:15
epoch [44/50] batch [160/428] time 0.110 (0.109) data 0.000 (0.004) loss 1.3715 (1.5588) ce_loss 1.0361 (1.3644) teacher_loss 0.7237 (0.8115) loss_zs_kd 0.4610 (0.4825) loss_oracle 0.4173 (0.5060) acc 68.7500 (49.9219) kd_loss 0.6975 (0.7979) lr 1.2369e-04 eta 0:05:10
epoch [44/50] batch [180/428] time 0.092 (0.107) data 0.000 (0.004) loss 1.5080 (1.5614) ce_loss 1.3359 (1.3691) teacher_loss 0.8031 (0.8138) loss_zs_kd 0.4943 (0.4842) loss_oracle 0.4577 (0.5054) acc 53.1250 (49.7396) kd_loss 0.9092 (0.8003) lr 1.2369e-04 eta 0:05:01
epoch [44/50] batch [200/428] time 0.181 (0.108) data 0.000 (0.003) loss 1.5158 (1.5605) ce_loss 1.3828 (1.3675) teacher_loss 0.8217 (0.8139) loss_zs_kd 0.4749 (0.4844) loss_oracle 0.4567 (0.5043) acc 50.0000 (49.8281) kd_loss 0.7624 (0.7987) lr 1.2369e-04 eta 0:05:00
epoch [44/50] batch [220/428] time 0.125 (0.108) data 0.000 (0.003) loss 1.3601 (1.5563) ce_loss 1.0293 (1.3611) teacher_loss 0.6080 (0.8100) loss_zs_kd 0.5014 (0.4847) loss_oracle 0.5014 (0.5040) acc 68.7500 (50.2983) kd_loss 0.8565 (0.8006) lr 1.2369e-04 eta 0:05:01
epoch [44/50] batch [240/428] time 0.079 (0.109) data 0.000 (0.003) loss 1.7404 (1.5543) ce_loss 1.3027 (1.3597) teacher_loss 0.9590 (0.8077) loss_zs_kd 0.4972 (0.4845) loss_oracle 0.5327 (0.5044) acc 43.7500 (50.1953) kd_loss 0.7286 (0.8001) lr 1.2369e-04 eta 0:05:00
epoch [44/50] batch [260/428] time 0.076 (0.109) data 0.000 (0.003) loss 1.5396 (1.5548) ce_loss 1.4160 (1.3610) teacher_loss 0.7748 (0.8084) loss_zs_kd 0.4438 (0.4837) loss_oracle 0.5429 (0.5046) acc 56.2500 (50.1683) kd_loss 0.9459 (0.8030) lr 1.2369e-04 eta 0:04:56
epoch [44/50] batch [280/428] time 0.083 (0.108) data 0.001 (0.003) loss 1.4157 (1.5563) ce_loss 1.0430 (1.3628) teacher_loss 0.7565 (0.8095) loss_zs_kd 0.4264 (0.4839) loss_oracle 0.4460 (0.5048) acc 62.5000 (50.1116) kd_loss 0.6747 (0.8034) lr 1.2369e-04 eta 0:04:53
epoch [44/50] batch [300/428] time 0.100 (0.109) data 0.000 (0.002) loss 1.5741 (1.5554) ce_loss 1.3525 (1.3626) teacher_loss 0.8630 (0.8088) loss_zs_kd 0.4491 (0.4830) loss_oracle 0.4866 (0.5051) acc 43.7500 (49.9583) kd_loss 0.7839 (0.8062) lr 1.2369e-04 eta 0:04:52
epoch [44/50] batch [320/428] time 0.082 (0.109) data 0.000 (0.002) loss 1.6143 (1.5558) ce_loss 1.3623 (1.3622) teacher_loss 0.9231 (0.8100) loss_zs_kd 0.4685 (0.4824) loss_oracle 0.4569 (0.5047) acc 62.5000 (50.1758) kd_loss 0.7692 (0.8059) lr 1.2369e-04 eta 0:04:51
epoch [44/50] batch [340/428] time 0.101 (0.109) data 0.000 (0.002) loss 1.5811 (1.5554) ce_loss 1.2627 (1.3619) teacher_loss 0.8484 (0.8099) loss_zs_kd 0.4522 (0.4823) loss_oracle 0.5066 (0.5044) acc 43.7500 (50.1379) kd_loss 0.6941 (0.8063) lr 1.2369e-04 eta 0:04:48
epoch [44/50] batch [360/428] time 0.110 (0.108) data 0.000 (0.002) loss 1.6573 (1.5572) ce_loss 1.4170 (1.3627) teacher_loss 0.8911 (0.8121) loss_zs_kd 0.4880 (0.4823) loss_oracle 0.5222 (0.5039) acc 50.0000 (50.1476) kd_loss 0.7765 (0.8065) lr 1.2369e-04 eta 0:04:45
epoch [44/50] batch [380/428] time 0.095 (0.108) data 0.000 (0.002) loss 1.3533 (1.5574) ce_loss 1.1572 (1.3628) teacher_loss 0.5730 (0.8120) loss_zs_kd 0.4600 (0.4819) loss_oracle 0.5503 (0.5045) acc 56.2500 (50.2796) kd_loss 0.8847 (0.8071) lr 1.2369e-04 eta 0:04:42
epoch [44/50] batch [400/428] time 0.102 (0.108) data 0.000 (0.002) loss 1.6303 (1.5542) ce_loss 1.6484 (1.3597) teacher_loss 0.9069 (0.8091) loss_zs_kd 0.4739 (0.4813) loss_oracle 0.4865 (0.5045) acc 46.8750 (50.3672) kd_loss 0.9796 (0.8071) lr 1.2369e-04 eta 0:04:40
epoch [44/50] batch [420/428] time 0.098 (0.108) data 0.000 (0.002) loss 1.3620 (1.5541) ce_loss 1.0918 (1.3571) teacher_loss 0.7076 (0.8090) loss_zs_kd 0.4587 (0.4814) loss_oracle 0.4250 (0.5044) acc 62.5000 (50.5952) kd_loss 0.7022 (0.8067) lr 1.2369e-04 eta 0:04:37
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,960
* accuracy: 50.4%
* error: 49.6%
* macro_f1: 36.7%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,589
* accuracy: 54.6%
* error: 45.4%
* macro_f1: 29.6%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [45/50] batch [20/428] time 0.101 (0.134) data 0.000 (0.028) loss 1.4639 (1.5522) ce_loss 1.3271 (1.3488) teacher_loss 0.7239 (0.8085) loss_zs_kd 0.4749 (0.4843) loss_oracle 0.5025 (0.5016) acc 59.3750 (52.6562) kd_loss 0.9397 (0.8039) lr 9.5173e-05 eta 0:05:40
epoch [45/50] batch [40/428] time 0.108 (0.119) data 0.000 (0.014) loss 1.4086 (1.5345) ce_loss 1.3271 (1.3370) teacher_loss 0.6725 (0.7985) loss_zs_kd 0.4624 (0.4760) loss_oracle 0.5049 (0.4980) acc 43.7500 (51.5625) kd_loss 0.8962 (0.8091) lr 9.5173e-05 eta 0:05:01
epoch [45/50] batch [60/428] time 0.112 (0.114) data 0.001 (0.009) loss 1.6558 (1.5550) ce_loss 1.3418 (1.3615) teacher_loss 0.9085 (0.8139) loss_zs_kd 0.5295 (0.4812) loss_oracle 0.4826 (0.5005) acc 46.8750 (50.4688) kd_loss 0.7554 (0.8065) lr 9.5173e-05 eta 0:04:46
epoch [45/50] batch [80/428] time 0.105 (0.112) data 0.000 (0.007) loss 1.4236 (1.5409) ce_loss 1.2021 (1.3454) teacher_loss 0.7222 (0.8021) loss_zs_kd 0.3930 (0.4807) loss_oracle 0.5048 (0.4984) acc 53.1250 (50.8984) kd_loss 0.8710 (0.8119) lr 9.5173e-05 eta 0:04:38
epoch [45/50] batch [100/428] time 0.094 (0.111) data 0.000 (0.006) loss 1.5549 (1.5405) ce_loss 1.5518 (1.3513) teacher_loss 0.7562 (0.7976) loss_zs_kd 0.5548 (0.4820) loss_oracle 0.5213 (0.5019) acc 40.6250 (51.3750) kd_loss 0.9760 (0.8217) lr 9.5173e-05 eta 0:04:33
epoch [45/50] batch [120/428] time 0.112 (0.110) data 0.000 (0.005) loss 1.5658 (1.5410) ce_loss 1.6006 (1.3577) teacher_loss 0.7506 (0.7957) loss_zs_kd 0.5038 (0.4836) loss_oracle 0.5633 (0.5034) acc 37.5000 (51.0677) kd_loss 0.8665 (0.8237) lr 9.5173e-05 eta 0:04:29
epoch [45/50] batch [140/428] time 0.099 (0.109) data 0.000 (0.004) loss 1.5049 (1.5446) ce_loss 1.3408 (1.3588) teacher_loss 0.7405 (0.7994) loss_zs_kd 0.5021 (0.4816) loss_oracle 0.5133 (0.5043) acc 50.0000 (51.0268) kd_loss 0.8367 (0.8187) lr 9.5173e-05 eta 0:04:25
epoch [45/50] batch [160/428] time 0.088 (0.106) data 0.000 (0.004) loss 1.5516 (1.5503) ce_loss 1.3994 (1.3685) teacher_loss 0.7918 (0.8061) loss_zs_kd 0.4949 (0.4808) loss_oracle 0.5124 (0.5038) acc 46.8750 (50.4883) kd_loss 0.8019 (0.8173) lr 9.5173e-05 eta 0:04:16
epoch [45/50] batch [180/428] time 0.087 (0.106) data 0.000 (0.003) loss 1.5321 (1.5526) ce_loss 1.3018 (1.3698) teacher_loss 0.7458 (0.8089) loss_zs_kd 0.4450 (0.4801) loss_oracle 0.5638 (0.5036) acc 50.0000 (50.2604) kd_loss 0.9608 (0.8208) lr 9.5173e-05 eta 0:04:11
epoch [45/50] batch [200/428] time 0.082 (0.106) data 0.000 (0.003) loss 1.4524 (1.5492) ce_loss 1.3330 (1.3633) teacher_loss 0.6659 (0.8060) loss_zs_kd 0.5191 (0.4792) loss_oracle 0.5270 (0.5036) acc 50.0000 (50.3750) kd_loss 0.8325 (0.8192) lr 9.5173e-05 eta 0:04:12
epoch [45/50] batch [220/428] time 0.171 (0.108) data 0.000 (0.003) loss 1.5084 (1.5478) ce_loss 1.2451 (1.3590) teacher_loss 0.8309 (0.8038) loss_zs_kd 0.4590 (0.4805) loss_oracle 0.4481 (0.5038) acc 53.1250 (50.3267) kd_loss 0.6394 (0.8189) lr 9.5173e-05 eta 0:04:12
epoch [45/50] batch [240/428] time 0.082 (0.108) data 0.000 (0.003) loss 1.4073 (1.5479) ce_loss 1.2734 (1.3623) teacher_loss 0.6475 (0.8035) loss_zs_kd 0.4745 (0.4802) loss_oracle 0.5225 (0.5043) acc 56.2500 (50.1953) kd_loss 0.8101 (0.8210) lr 9.5173e-05 eta 0:04:11
epoch [45/50] batch [260/428] time 0.078 (0.106) data 0.000 (0.002) loss 1.5169 (1.5508) ce_loss 1.4463 (1.3638) teacher_loss 0.7753 (0.8067) loss_zs_kd 0.4668 (0.4797) loss_oracle 0.5083 (0.5043) acc 56.2500 (50.0120) kd_loss 0.9393 (0.8202) lr 9.5173e-05 eta 0:04:05
epoch [45/50] batch [280/428] time 0.180 (0.107) data 0.000 (0.002) loss 1.4451 (1.5501) ce_loss 1.1484 (1.3598) teacher_loss 0.6888 (0.8062) loss_zs_kd 0.5221 (0.4793) loss_oracle 0.4952 (0.5043) acc 50.0000 (50.1004) kd_loss 0.7058 (0.8164) lr 9.5173e-05 eta 0:04:05
epoch [45/50] batch [300/428] time 0.165 (0.108) data 0.000 (0.002) loss 1.5945 (1.5501) ce_loss 1.3799 (1.3582) teacher_loss 0.7979 (0.8068) loss_zs_kd 0.4439 (0.4790) loss_oracle 0.5747 (0.5037) acc 43.7500 (50.1875) kd_loss 0.8591 (0.8135) lr 9.5173e-05 eta 0:04:05
epoch [45/50] batch [320/428] time 0.086 (0.108) data 0.000 (0.002) loss 1.4093 (1.5471) ce_loss 1.1982 (1.3576) teacher_loss 0.7132 (0.8037) loss_zs_kd 0.4251 (0.4800) loss_oracle 0.4835 (0.5034) acc 50.0000 (50.1562) kd_loss 0.8670 (0.8153) lr 9.5173e-05 eta 0:04:02
epoch [45/50] batch [340/428] time 0.103 (0.107) data 0.000 (0.002) loss 1.5834 (1.5488) ce_loss 1.4092 (1.3613) teacher_loss 0.8175 (0.8053) loss_zs_kd 0.5140 (0.4802) loss_oracle 0.5089 (0.5033) acc 59.3750 (50.0460) kd_loss 0.7869 (0.8154) lr 9.5173e-05 eta 0:03:59
epoch [45/50] batch [360/428] time 0.103 (0.107) data 0.000 (0.002) loss 1.4611 (1.5492) ce_loss 1.1514 (1.3602) teacher_loss 0.7439 (0.8059) loss_zs_kd 0.4299 (0.4799) loss_oracle 0.5022 (0.5033) acc 62.5000 (50.0608) kd_loss 0.7327 (0.8150) lr 9.5173e-05 eta 0:03:56
epoch [45/50] batch [380/428] time 0.115 (0.107) data 0.000 (0.002) loss 1.6034 (1.5497) ce_loss 1.4883 (1.3587) teacher_loss 0.9139 (0.8062) loss_zs_kd 0.4451 (0.4800) loss_oracle 0.4670 (0.5035) acc 46.8750 (50.0740) kd_loss 0.8388 (0.8144) lr 9.5173e-05 eta 0:03:54
epoch [45/50] batch [400/428] time 0.090 (0.107) data 0.000 (0.002) loss 1.5403 (1.5476) ce_loss 1.4268 (1.3565) teacher_loss 0.8265 (0.8043) loss_zs_kd 0.4739 (0.4799) loss_oracle 0.4768 (0.5033) acc 46.8750 (50.1562) kd_loss 0.8549 (0.8160) lr 9.5173e-05 eta 0:03:52
epoch [45/50] batch [420/428] time 0.097 (0.107) data 0.000 (0.002) loss 1.4437 (1.5492) ce_loss 1.2207 (1.3589) teacher_loss 0.6928 (0.8061) loss_zs_kd 0.4704 (0.4793) loss_oracle 0.5158 (0.5035) acc 56.2500 (50.1488) kd_loss 0.8234 (0.8159) lr 9.5173e-05 eta 0:03:49
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,953
* accuracy: 50.3%
* error: 49.7%
* macro_f1: 36.7%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,565
* accuracy: 54.1%
* error: 45.9%
* macro_f1: 29.5%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [46/50] batch [20/428] time 0.099 (0.136) data 0.000 (0.027) loss 1.5621 (1.5479) ce_loss 1.3574 (1.3974) teacher_loss 0.8334 (0.7907) loss_zs_kd 0.4493 (0.4958) loss_oracle 0.5041 (0.5093) acc 46.8750 (49.0625) kd_loss 0.8760 (0.8582) lr 7.0224e-05 eta 0:04:48
epoch [46/50] batch [40/428] time 0.093 (0.117) data 0.000 (0.013) loss 1.7666 (1.5619) ce_loss 1.5244 (1.3852) teacher_loss 0.9687 (0.8101) loss_zs_kd 0.5773 (0.5020) loss_oracle 0.5093 (0.5008) acc 50.0000 (49.1406) kd_loss 0.7937 (0.8411) lr 7.0224e-05 eta 0:04:06
epoch [46/50] batch [60/428] time 0.097 (0.109) data 0.001 (0.009) loss 1.4951 (1.5351) ce_loss 1.2832 (1.3545) teacher_loss 0.7484 (0.7848) loss_zs_kd 0.5106 (0.4952) loss_oracle 0.4914 (0.5027) acc 50.0000 (50.1562) kd_loss 0.7193 (0.8352) lr 7.0224e-05 eta 0:03:46
epoch [46/50] batch [80/428] time 0.104 (0.108) data 0.000 (0.007) loss 1.4364 (1.5417) ce_loss 1.4883 (1.3558) teacher_loss 0.6440 (0.7960) loss_zs_kd 0.4738 (0.4869) loss_oracle 0.5554 (0.5023) acc 50.0000 (50.0000) kd_loss 0.9068 (0.8306) lr 7.0224e-05 eta 0:03:42
epoch [46/50] batch [100/428] time 0.106 (0.108) data 0.000 (0.006) loss 1.4991 (1.5490) ce_loss 1.3936 (1.3615) teacher_loss 0.8135 (0.8026) loss_zs_kd 0.4695 (0.4862) loss_oracle 0.4508 (0.5032) acc 46.8750 (49.9688) kd_loss 0.7842 (0.8265) lr 7.0224e-05 eta 0:03:39
epoch [46/50] batch [120/428] time 0.103 (0.107) data 0.000 (0.005) loss 1.7330 (1.5534) ce_loss 1.4834 (1.3625) teacher_loss 0.9555 (0.8079) loss_zs_kd 0.5074 (0.4832) loss_oracle 0.5238 (0.5039) acc 43.7500 (50.2344) kd_loss 0.8482 (0.8240) lr 7.0224e-05 eta 0:03:36
epoch [46/50] batch [140/428] time 0.103 (0.107) data 0.000 (0.004) loss 1.5178 (1.5584) ce_loss 1.3613 (1.3716) teacher_loss 0.8162 (0.8119) loss_zs_kd 0.5081 (0.4847) loss_oracle 0.4476 (0.5041) acc 46.8750 (49.7098) kd_loss 0.8325 (0.8251) lr 7.0224e-05 eta 0:03:33
epoch [46/50] batch [160/428] time 0.080 (0.105) data 0.000 (0.004) loss 1.6900 (1.5611) ce_loss 1.5479 (1.3703) teacher_loss 0.9444 (0.8152) loss_zs_kd 0.4588 (0.4833) loss_oracle 0.5161 (0.5042) acc 56.2500 (49.8828) kd_loss 0.9136 (0.8244) lr 7.0224e-05 eta 0:03:27
epoch [46/50] batch [180/428] time 0.178 (0.105) data 0.001 (0.003) loss 1.7768 (1.5612) ce_loss 1.6279 (1.3738) teacher_loss 1.0651 (0.8161) loss_zs_kd 0.5370 (0.4842) loss_oracle 0.4432 (0.5031) acc 37.5000 (49.6354) kd_loss 0.8063 (0.8258) lr 7.0224e-05 eta 0:03:25
epoch [46/50] batch [200/428] time 0.151 (0.105) data 0.000 (0.003) loss 1.2598 (1.5665) ce_loss 0.9932 (1.3800) teacher_loss 0.5556 (0.8206) loss_zs_kd 0.4207 (0.4848) loss_oracle 0.4938 (0.5034) acc 65.6250 (49.5469) kd_loss 0.6901 (0.8255) lr 7.0224e-05 eta 0:03:24
epoch [46/50] batch [220/428] time 0.166 (0.106) data 0.000 (0.003) loss 1.8008 (1.5642) ce_loss 1.7188 (1.3815) teacher_loss 0.9699 (0.8180) loss_zs_kd 0.5081 (0.4839) loss_oracle 0.5768 (0.5042) acc 40.6250 (49.4176) kd_loss 0.9353 (0.8298) lr 7.0224e-05 eta 0:03:23
epoch [46/50] batch [240/428] time 0.154 (0.107) data 0.000 (0.003) loss 2.0426 (1.5655) ce_loss 1.9307 (1.3839) teacher_loss 1.3755 (0.8187) loss_zs_kd 0.4436 (0.4830) loss_oracle 0.4454 (0.5052) acc 37.5000 (49.4922) kd_loss 0.6299 (0.8311) lr 7.0224e-05 eta 0:03:22
epoch [46/50] batch [260/428] time 0.089 (0.105) data 0.000 (0.002) loss 1.6510 (1.5632) ce_loss 1.4707 (1.3796) teacher_loss 0.8287 (0.8176) loss_zs_kd 0.5335 (0.4829) loss_oracle 0.5556 (0.5042) acc 43.7500 (49.5913) kd_loss 0.8665 (0.8293) lr 7.0224e-05 eta 0:03:17
epoch [46/50] batch [280/428] time 0.077 (0.106) data 0.000 (0.002) loss 1.6683 (1.5615) ce_loss 1.6016 (1.3783) teacher_loss 0.8904 (0.8161) loss_zs_kd 0.4889 (0.4813) loss_oracle 0.5335 (0.5047) acc 46.8750 (49.5089) kd_loss 0.8947 (0.8299) lr 7.0224e-05 eta 0:03:16
epoch [46/50] batch [300/428] time 0.078 (0.106) data 0.000 (0.002) loss 1.3848 (1.5584) ce_loss 1.0742 (1.3757) teacher_loss 0.5904 (0.8141) loss_zs_kd 0.5021 (0.4806) loss_oracle 0.5434 (0.5041) acc 53.1250 (49.6250) kd_loss 0.8233 (0.8284) lr 7.0224e-05 eta 0:03:15
epoch [46/50] batch [320/428] time 0.081 (0.107) data 0.000 (0.002) loss 1.6786 (1.5585) ce_loss 1.4775 (1.3754) teacher_loss 0.9396 (0.8139) loss_zs_kd 0.3906 (0.4800) loss_oracle 0.5437 (0.5045) acc 50.0000 (49.6973) kd_loss 0.8461 (0.8276) lr 7.0224e-05 eta 0:03:14
epoch [46/50] batch [340/428] time 0.105 (0.106) data 0.000 (0.002) loss 1.5250 (1.5583) ce_loss 1.4814 (1.3727) teacher_loss 0.7612 (0.8138) loss_zs_kd 0.4926 (0.4806) loss_oracle 0.5174 (0.5042) acc 43.7500 (49.8346) kd_loss 0.8850 (0.8261) lr 7.0224e-05 eta 0:03:11
epoch [46/50] batch [360/428] time 0.108 (0.106) data 0.000 (0.002) loss 1.4328 (1.5584) ce_loss 1.1016 (1.3730) teacher_loss 0.7630 (0.8146) loss_zs_kd 0.4104 (0.4803) loss_oracle 0.4646 (0.5036) acc 59.3750 (49.8958) kd_loss 0.7365 (0.8256) lr 7.0224e-05 eta 0:03:09
epoch [46/50] batch [380/428] time 0.105 (0.106) data 0.000 (0.002) loss 1.5857 (1.5553) ce_loss 1.4131 (1.3690) teacher_loss 0.8185 (0.8113) loss_zs_kd 0.4755 (0.4804) loss_oracle 0.5294 (0.5038) acc 50.0000 (50.0905) kd_loss 0.8851 (0.8239) lr 7.0224e-05 eta 0:03:06
epoch [46/50] batch [400/428] time 0.106 (0.106) data 0.000 (0.002) loss 1.5944 (1.5555) ce_loss 1.2998 (1.3696) teacher_loss 0.8761 (0.8113) loss_zs_kd 0.4460 (0.4813) loss_oracle 0.4953 (0.5035) acc 53.1250 (50.0234) kd_loss 0.7752 (0.8226) lr 7.0224e-05 eta 0:03:04
epoch [46/50] batch [420/428] time 0.097 (0.106) data 0.000 (0.002) loss 1.3594 (1.5541) ce_loss 0.9995 (1.3678) teacher_loss 0.7531 (0.8092) loss_zs_kd 0.3728 (0.4818) loss_oracle 0.4198 (0.5040) acc 62.5000 (50.1414) kd_loss 0.7197 (0.8234) lr 7.0224e-05 eta 0:03:02
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,953
* accuracy: 50.3%
* error: 49.7%
* macro_f1: 36.5%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,567
* accuracy: 54.1%
* error: 45.9%
* macro_f1: 30.1%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [47/50] batch [20/428] time 0.109 (0.126) data 0.000 (0.024) loss 1.8590 (1.5953) ce_loss 1.5234 (1.4014) teacher_loss 1.0998 (0.8557) loss_zs_kd 0.5098 (0.4620) loss_oracle 0.5042 (0.5086) acc 40.6250 (49.0625) kd_loss 0.7958 (0.8206) lr 4.8943e-05 eta 0:03:32
epoch [47/50] batch [40/428] time 0.107 (0.115) data 0.000 (0.012) loss 1.7648 (1.5941) ce_loss 1.5098 (1.3937) teacher_loss 0.9143 (0.8473) loss_zs_kd 0.5065 (0.4736) loss_oracle 0.5973 (0.5100) acc 37.5000 (49.2969) kd_loss 0.8703 (0.8216) lr 4.8943e-05 eta 0:03:12
epoch [47/50] batch [60/428] time 0.104 (0.111) data 0.001 (0.008) loss 1.3516 (1.5870) ce_loss 1.0449 (1.3789) teacher_loss 0.6332 (0.8423) loss_zs_kd 0.3804 (0.4738) loss_oracle 0.5282 (0.5078) acc 59.3750 (50.0521) kd_loss 0.9307 (0.8254) lr 4.8943e-05 eta 0:03:03
epoch [47/50] batch [80/428] time 0.101 (0.110) data 0.000 (0.006) loss 1.6485 (1.5843) ce_loss 1.3809 (1.3782) teacher_loss 0.9380 (0.8378) loss_zs_kd 0.4844 (0.4818) loss_oracle 0.4684 (0.5056) acc 50.0000 (49.9609) kd_loss 0.7543 (0.8143) lr 4.8943e-05 eta 0:02:58
epoch [47/50] batch [100/428] time 0.103 (0.108) data 0.000 (0.005) loss 1.7805 (1.5745) ce_loss 1.7529 (1.3771) teacher_loss 0.9405 (0.8248) loss_zs_kd 0.4651 (0.4834) loss_oracle 0.6074 (0.5080) acc 40.6250 (49.9375) kd_loss 0.8829 (0.8222) lr 4.8943e-05 eta 0:02:54
epoch [47/50] batch [120/428] time 0.113 (0.108) data 0.000 (0.004) loss 1.4436 (1.5768) ce_loss 1.2598 (1.3813) teacher_loss 0.7230 (0.8284) loss_zs_kd 0.4520 (0.4835) loss_oracle 0.4946 (0.5066) acc 50.0000 (49.6094) kd_loss 0.7660 (0.8221) lr 4.8943e-05 eta 0:02:52
epoch [47/50] batch [140/428] time 0.096 (0.108) data 0.000 (0.004) loss 1.5237 (1.5650) ce_loss 1.3184 (1.3701) teacher_loss 0.7928 (0.8190) loss_zs_kd 0.4173 (0.4822) loss_oracle 0.5222 (0.5049) acc 46.8750 (50.2009) kd_loss 0.7816 (0.8240) lr 4.8943e-05 eta 0:02:49
epoch [47/50] batch [160/428] time 0.085 (0.105) data 0.000 (0.003) loss 1.6103 (1.5627) ce_loss 1.2949 (1.3669) teacher_loss 0.8553 (0.8155) loss_zs_kd 0.4548 (0.4820) loss_oracle 0.5276 (0.5062) acc 65.6250 (50.2539) kd_loss 0.8103 (0.8250) lr 4.8943e-05 eta 0:02:43
epoch [47/50] batch [180/428] time 0.157 (0.106) data 0.000 (0.003) loss 1.5209 (1.5568) ce_loss 1.3672 (1.3593) teacher_loss 0.7591 (0.8098) loss_zs_kd 0.4922 (0.4827) loss_oracle 0.5156 (0.5057) acc 53.1250 (50.5035) kd_loss 0.8453 (0.8257) lr 4.8943e-05 eta 0:02:41
epoch [47/50] batch [200/428] time 0.168 (0.107) data 0.000 (0.003) loss 1.5486 (1.5534) ce_loss 1.4980 (1.3574) teacher_loss 0.8508 (0.8071) loss_zs_kd 0.4794 (0.4827) loss_oracle 0.4581 (0.5050) acc 34.3750 (50.4531) kd_loss 0.9206 (0.8268) lr 4.8943e-05 eta 0:02:41
epoch [47/50] batch [220/428] time 0.153 (0.107) data 0.000 (0.002) loss 1.3899 (1.5505) ce_loss 1.1230 (1.3553) teacher_loss 0.6433 (0.8045) loss_zs_kd 0.5085 (0.4826) loss_oracle 0.4924 (0.5048) acc 56.2500 (50.4972) kd_loss 0.8435 (0.8261) lr 4.8943e-05 eta 0:02:39
epoch [47/50] batch [240/428] time 0.070 (0.107) data 0.000 (0.002) loss 1.6862 (1.5476) ce_loss 1.2285 (1.3535) teacher_loss 0.9072 (0.8017) loss_zs_kd 0.5224 (0.4824) loss_oracle 0.5179 (0.5047) acc 56.2500 (50.4688) kd_loss 0.6656 (0.8260) lr 4.8943e-05 eta 0:02:37
epoch [47/50] batch [260/428] time 0.163 (0.105) data 0.000 (0.002) loss 1.5908 (1.5487) ce_loss 1.5264 (1.3571) teacher_loss 0.8394 (0.8026) loss_zs_kd 0.5048 (0.4828) loss_oracle 0.4990 (0.5047) acc 37.5000 (50.2163) kd_loss 0.8290 (0.8284) lr 4.8943e-05 eta 0:02:33
epoch [47/50] batch [280/428] time 0.203 (0.106) data 0.000 (0.002) loss 1.5838 (1.5480) ce_loss 1.3682 (1.3552) teacher_loss 0.8346 (0.8011) loss_zs_kd 0.4681 (0.4841) loss_oracle 0.5152 (0.5049) acc 50.0000 (50.5134) kd_loss 0.7607 (0.8276) lr 4.8943e-05 eta 0:02:32
epoch [47/50] batch [300/428] time 0.146 (0.106) data 0.000 (0.002) loss 1.7632 (1.5459) ce_loss 1.8037 (1.3535) teacher_loss 1.0431 (0.7987) loss_zs_kd 0.4860 (0.4835) loss_oracle 0.4772 (0.5054) acc 34.3750 (50.5833) kd_loss 0.7989 (0.8285) lr 4.8943e-05 eta 0:02:30
epoch [47/50] batch [320/428] time 0.101 (0.107) data 0.000 (0.002) loss 1.4838 (1.5435) ce_loss 1.1045 (1.3530) teacher_loss 0.7859 (0.7952) loss_zs_kd 0.4479 (0.4849) loss_oracle 0.4740 (0.5059) acc 68.7500 (50.4883) kd_loss 0.8002 (0.8301) lr 4.8943e-05 eta 0:02:28
epoch [47/50] batch [340/428] time 0.114 (0.107) data 0.000 (0.002) loss 1.6248 (1.5454) ce_loss 1.3496 (1.3554) teacher_loss 0.8499 (0.7965) loss_zs_kd 0.5217 (0.4859) loss_oracle 0.5140 (0.5059) acc 37.5000 (50.3493) kd_loss 0.7302 (0.8287) lr 4.8943e-05 eta 0:02:26
epoch [47/50] batch [360/428] time 0.111 (0.107) data 0.000 (0.002) loss 1.4546 (1.5470) ce_loss 1.2354 (1.3577) teacher_loss 0.7128 (0.7989) loss_zs_kd 0.4354 (0.4846) loss_oracle 0.5241 (0.5059) acc 50.0000 (50.2257) kd_loss 0.8359 (0.8281) lr 4.8943e-05 eta 0:02:24
epoch [47/50] batch [380/428] time 0.117 (0.106) data 0.000 (0.002) loss 1.5725 (1.5448) ce_loss 1.3223 (1.3550) teacher_loss 0.7899 (0.7969) loss_zs_kd 0.5012 (0.4839) loss_oracle 0.5319 (0.5059) acc 53.1250 (50.4359) kd_loss 0.8536 (0.8291) lr 4.8943e-05 eta 0:02:21
epoch [47/50] batch [400/428] time 0.116 (0.106) data 0.000 (0.001) loss 1.4069 (1.5439) ce_loss 1.1436 (1.3544) teacher_loss 0.6704 (0.7959) loss_zs_kd 0.4849 (0.4840) loss_oracle 0.4940 (0.5060) acc 56.2500 (50.4141) kd_loss 0.7929 (0.8290) lr 4.8943e-05 eta 0:02:19
epoch [47/50] batch [420/428] time 0.099 (0.106) data 0.000 (0.001) loss 1.6674 (1.5457) ce_loss 1.4785 (1.3557) teacher_loss 0.8844 (0.7979) loss_zs_kd 0.5263 (0.4843) loss_oracle 0.5199 (0.5056) acc 40.6250 (50.3423) kd_loss 0.7622 (0.8282) lr 4.8943e-05 eta 0:02:17
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,956
* accuracy: 50.3%
* error: 49.7%
* macro_f1: 36.6%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,573
* accuracy: 54.3%
* error: 45.7%
* macro_f1: 30.1%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [48/50] batch [20/428] time 0.102 (0.132) data 0.000 (0.024) loss 1.4510 (1.4748) ce_loss 1.2871 (1.3023) teacher_loss 0.7855 (0.7401) loss_zs_kd 0.4015 (0.4764) loss_oracle 0.4648 (0.4965) acc 53.1250 (52.5000) kd_loss 0.7760 (0.8078) lr 3.1417e-05 eta 0:02:47
epoch [48/50] batch [40/428] time 0.101 (0.119) data 0.000 (0.012) loss 1.6112 (1.5501) ce_loss 1.3311 (1.3715) teacher_loss 0.8744 (0.8078) loss_zs_kd 0.4222 (0.4817) loss_oracle 0.5258 (0.5015) acc 40.6250 (49.2188) kd_loss 0.8717 (0.8113) lr 3.1417e-05 eta 0:02:27
epoch [48/50] batch [60/428] time 0.107 (0.114) data 0.001 (0.008) loss 1.5027 (1.5367) ce_loss 1.3105 (1.3605) teacher_loss 0.7437 (0.7974) loss_zs_kd 0.4602 (0.4814) loss_oracle 0.5289 (0.4985) acc 56.2500 (49.9479) kd_loss 0.8654 (0.8135) lr 3.1417e-05 eta 0:02:19
epoch [48/50] batch [80/428] time 0.105 (0.111) data 0.000 (0.006) loss 1.3556 (1.5282) ce_loss 1.4043 (1.3498) teacher_loss 0.7054 (0.7914) loss_zs_kd 0.3550 (0.4788) loss_oracle 0.4727 (0.4974) acc 46.8750 (50.5469) kd_loss 0.7628 (0.8109) lr 3.1417e-05 eta 0:02:13
epoch [48/50] batch [100/428] time 0.110 (0.110) data 0.000 (0.005) loss 1.4254 (1.5294) ce_loss 1.1885 (1.3413) teacher_loss 0.6759 (0.7973) loss_zs_kd 0.5138 (0.4751) loss_oracle 0.4926 (0.4945) acc 56.2500 (50.9375) kd_loss 0.8268 (0.8049) lr 3.1417e-05 eta 0:02:10
epoch [48/50] batch [120/428] time 0.111 (0.109) data 0.000 (0.004) loss 1.2892 (1.5363) ce_loss 1.0605 (1.3452) teacher_loss 0.5730 (0.8027) loss_zs_kd 0.4350 (0.4749) loss_oracle 0.4987 (0.4962) acc 59.3750 (51.0938) kd_loss 0.7670 (0.8054) lr 3.1417e-05 eta 0:02:07
epoch [48/50] batch [140/428] time 0.081 (0.108) data 0.000 (0.004) loss 1.5315 (1.5386) ce_loss 1.3174 (1.3515) teacher_loss 0.7505 (0.8046) loss_zs_kd 0.5558 (0.4765) loss_oracle 0.5031 (0.4957) acc 50.0000 (50.6920) kd_loss 0.7775 (0.8052) lr 3.1417e-05 eta 0:02:03
epoch [48/50] batch [160/428] time 0.082 (0.105) data 0.000 (0.003) loss 1.6116 (1.5357) ce_loss 1.3271 (1.3533) teacher_loss 0.8324 (0.8005) loss_zs_kd 0.5122 (0.4774) loss_oracle 0.5231 (0.4966) acc 62.5000 (50.8398) kd_loss 0.7730 (0.8082) lr 3.1417e-05 eta 0:01:57
epoch [48/50] batch [180/428] time 0.071 (0.105) data 0.000 (0.003) loss 1.4946 (1.5383) ce_loss 1.4102 (1.3577) teacher_loss 0.6625 (0.8029) loss_zs_kd 0.5713 (0.4781) loss_oracle 0.5464 (0.4963) acc 50.0000 (50.5903) kd_loss 0.8169 (0.8079) lr 3.1417e-05 eta 0:01:55
epoch [48/50] batch [200/428] time 0.071 (0.104) data 0.000 (0.003) loss 1.6017 (1.5396) ce_loss 1.3936 (1.3590) teacher_loss 0.8213 (0.8024) loss_zs_kd 0.5448 (0.4810) loss_oracle 0.5080 (0.4967) acc 56.2500 (50.4062) kd_loss 0.8387 (0.8068) lr 3.1417e-05 eta 0:01:52
epoch [48/50] batch [220/428] time 0.067 (0.104) data 0.000 (0.002) loss 1.5553 (1.5376) ce_loss 1.3369 (1.3600) teacher_loss 0.7457 (0.8006) loss_zs_kd 0.4631 (0.4800) loss_oracle 0.5781 (0.4970) acc 59.3750 (50.3267) kd_loss 0.7918 (0.8074) lr 3.1417e-05 eta 0:01:50
epoch [48/50] batch [240/428] time 0.075 (0.104) data 0.000 (0.002) loss 1.4654 (1.5431) ce_loss 1.2373 (1.3651) teacher_loss 0.6695 (0.8045) loss_zs_kd 0.5477 (0.4806) loss_oracle 0.5221 (0.4983) acc 65.6250 (50.1953) kd_loss 0.8389 (0.8089) lr 3.1417e-05 eta 0:01:48
epoch [48/50] batch [260/428] time 0.148 (0.102) data 0.000 (0.002) loss 1.7259 (1.5455) ce_loss 1.4092 (1.3680) teacher_loss 0.9727 (0.8068) loss_zs_kd 0.5817 (0.4801) loss_oracle 0.4623 (0.4987) acc 59.3750 (50.1202) kd_loss 0.8367 (0.8108) lr 3.1417e-05 eta 0:01:44
epoch [48/50] batch [280/428] time 0.057 (0.102) data 0.000 (0.002) loss 1.5946 (1.5482) ce_loss 1.4814 (1.3685) teacher_loss 0.8326 (0.8079) loss_zs_kd 0.4810 (0.4802) loss_oracle 0.5214 (0.5002) acc 50.0000 (50.0335) kd_loss 0.7724 (0.8129) lr 3.1417e-05 eta 0:01:42
epoch [48/50] batch [300/428] time 0.164 (0.101) data 0.000 (0.002) loss 1.4810 (1.5461) ce_loss 1.3301 (1.3631) teacher_loss 0.6706 (0.8061) loss_zs_kd 0.4993 (0.4800) loss_oracle 0.5607 (0.5000) acc 53.1250 (50.2188) kd_loss 0.8698 (0.8114) lr 3.1417e-05 eta 0:01:39
epoch [48/50] batch [320/428] time 0.126 (0.101) data 0.000 (0.002) loss 1.6274 (1.5468) ce_loss 1.3799 (1.3634) teacher_loss 0.7994 (0.8057) loss_zs_kd 0.5627 (0.4816) loss_oracle 0.5466 (0.5003) acc 40.6250 (50.2344) kd_loss 0.8368 (0.8109) lr 3.1417e-05 eta 0:01:36
epoch [48/50] batch [340/428] time 0.066 (0.099) data 0.000 (0.002) loss 1.6270 (1.5465) ce_loss 1.4072 (1.3634) teacher_loss 0.8950 (0.8044) loss_zs_kd 0.4857 (0.4817) loss_oracle 0.4892 (0.5012) acc 34.3750 (50.1562) kd_loss 0.7751 (0.8131) lr 3.1417e-05 eta 0:01:33
epoch [48/50] batch [360/428] time 0.088 (0.098) data 0.000 (0.002) loss 1.4026 (1.5460) ce_loss 1.2402 (1.3630) teacher_loss 0.6936 (0.8032) loss_zs_kd 0.4541 (0.4812) loss_oracle 0.4819 (0.5021) acc 46.8750 (50.1562) kd_loss 0.7166 (0.8135) lr 3.1417e-05 eta 0:01:30
epoch [48/50] batch [380/428] time 0.085 (0.098) data 0.000 (0.002) loss 1.8080 (1.5459) ce_loss 1.5625 (1.3612) teacher_loss 0.9737 (0.8032) loss_zs_kd 0.5114 (0.4812) loss_oracle 0.5786 (0.5022) acc 43.7500 (50.2632) kd_loss 0.8868 (0.8137) lr 3.1417e-05 eta 0:01:28
epoch [48/50] batch [400/428] time 0.099 (0.097) data 0.000 (0.001) loss 1.3019 (1.5467) ce_loss 1.0215 (1.3639) teacher_loss 0.5302 (0.8037) loss_zs_kd 0.5424 (0.4821) loss_oracle 0.5005 (0.5020) acc 62.5000 (50.0781) kd_loss 0.9018 (0.8149) lr 3.1417e-05 eta 0:01:26
epoch [48/50] batch [420/428] time 0.097 (0.098) data 0.000 (0.001) loss 1.6525 (1.5468) ce_loss 1.4277 (1.3661) teacher_loss 0.8504 (0.8035) loss_zs_kd 0.5096 (0.4822) loss_oracle 0.5473 (0.5022) acc 53.1250 (49.9777) kd_loss 0.8550 (0.8150) lr 3.1417e-05 eta 0:01:24
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,950
* accuracy: 50.2%
* error: 49.8%
* macro_f1: 36.4%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,570
* accuracy: 54.2%
* error: 45.8%
* macro_f1: 30.0%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [49/50] batch [20/428] time 0.100 (0.133) data 0.000 (0.028) loss 1.2649 (1.6236) ce_loss 1.0889 (1.4205) teacher_loss 0.5395 (0.8530) loss_zs_kd 0.4312 (0.4949) loss_oracle 0.5098 (0.5232) acc 53.1250 (49.2188) kd_loss 0.7063 (0.8227) lr 1.7713e-05 eta 0:01:50
epoch [49/50] batch [40/428] time 0.071 (0.114) data 0.000 (0.014) loss 1.3622 (1.5973) ce_loss 1.1924 (1.4043) teacher_loss 0.5107 (0.8396) loss_zs_kd 0.5444 (0.4914) loss_oracle 0.5793 (0.5120) acc 53.1250 (49.3750) kd_loss 1.0204 (0.8232) lr 1.7713e-05 eta 0:01:33
epoch [49/50] batch [60/428] time 0.079 (0.104) data 0.000 (0.009) loss 1.4797 (1.5904) ce_loss 1.1992 (1.3943) teacher_loss 0.7279 (0.8383) loss_zs_kd 0.4935 (0.4868) loss_oracle 0.5051 (0.5088) acc 62.5000 (49.5833) kd_loss 0.8493 (0.8220) lr 1.7713e-05 eta 0:01:22
epoch [49/50] batch [80/428] time 0.064 (0.097) data 0.000 (0.007) loss 1.6114 (1.5875) ce_loss 1.3643 (1.3895) teacher_loss 0.8625 (0.8402) loss_zs_kd 0.4945 (0.4830) loss_oracle 0.5016 (0.5058) acc 46.8750 (50.0000) kd_loss 0.8181 (0.8292) lr 1.7713e-05 eta 0:01:15
epoch [49/50] batch [100/428] time 0.075 (0.094) data 0.000 (0.006) loss 1.3775 (1.5837) ce_loss 1.1553 (1.3956) teacher_loss 0.6115 (0.8359) loss_zs_kd 0.4487 (0.4829) loss_oracle 0.5416 (0.5063) acc 56.2500 (49.6875) kd_loss 0.7406 (0.8312) lr 1.7713e-05 eta 0:01:11
epoch [49/50] batch [120/428] time 0.089 (0.093) data 0.000 (0.005) loss 1.7293 (1.5824) ce_loss 1.5303 (1.4024) teacher_loss 0.9472 (0.8377) loss_zs_kd 0.4698 (0.4790) loss_oracle 0.5472 (0.5053) acc 46.8750 (49.1667) kd_loss 0.8228 (0.8296) lr 1.7713e-05 eta 0:01:08
epoch [49/50] batch [140/428] time 0.088 (0.092) data 0.000 (0.004) loss 1.7152 (1.5860) ce_loss 1.6152 (1.4144) teacher_loss 0.9044 (0.8405) loss_zs_kd 0.5119 (0.4797) loss_oracle 0.5548 (0.5056) acc 40.6250 (48.7723) kd_loss 0.8318 (0.8295) lr 1.7713e-05 eta 0:01:05
epoch [49/50] batch [160/428] time 0.078 (0.091) data 0.000 (0.004) loss 1.5559 (1.5754) ce_loss 1.5137 (1.4022) teacher_loss 0.8306 (0.8302) loss_zs_kd 0.4882 (0.4796) loss_oracle 0.4812 (0.5054) acc 46.8750 (49.2578) kd_loss 0.7225 (0.8291) lr 1.7713e-05 eta 0:01:03
epoch [49/50] batch [180/428] time 0.089 (0.090) data 0.000 (0.003) loss 1.3701 (1.5753) ce_loss 1.0811 (1.3960) teacher_loss 0.6367 (0.8322) loss_zs_kd 0.4809 (0.4790) loss_oracle 0.4930 (0.5036) acc 65.6250 (49.5312) kd_loss 0.8137 (0.8278) lr 1.7713e-05 eta 0:01:00
epoch [49/50] batch [200/428] time 0.079 (0.091) data 0.000 (0.003) loss 1.4413 (1.5726) ce_loss 1.2744 (1.3883) teacher_loss 0.7561 (0.8288) loss_zs_kd 0.4306 (0.4786) loss_oracle 0.4699 (0.5045) acc 53.1250 (49.7344) kd_loss 0.8337 (0.8265) lr 1.7713e-05 eta 0:00:59
epoch [49/50] batch [220/428] time 0.158 (0.090) data 0.000 (0.003) loss 1.2741 (1.5622) ce_loss 0.8110 (1.3759) teacher_loss 0.5452 (0.8193) loss_zs_kd 0.5058 (0.4789) loss_oracle 0.4760 (0.5034) acc 68.7500 (50.2273) kd_loss 0.7136 (0.8285) lr 1.7713e-05 eta 0:00:57
epoch [49/50] batch [240/428] time 0.152 (0.092) data 0.000 (0.003) loss 1.6191 (1.5631) ce_loss 1.4258 (1.3737) teacher_loss 0.8144 (0.8191) loss_zs_kd 0.4644 (0.4790) loss_oracle 0.5725 (0.5045) acc 40.6250 (50.2865) kd_loss 0.9781 (0.8298) lr 1.7713e-05 eta 0:00:56
epoch [49/50] batch [260/428] time 0.080 (0.093) data 0.000 (0.002) loss 1.6187 (1.5622) ce_loss 1.5088 (1.3738) teacher_loss 0.8352 (0.8182) loss_zs_kd 0.5128 (0.4794) loss_oracle 0.5271 (0.5043) acc 46.8750 (50.1803) kd_loss 0.8649 (0.8288) lr 1.7713e-05 eta 0:00:55
epoch [49/50] batch [280/428] time 0.069 (0.094) data 0.000 (0.002) loss 1.4140 (1.5612) ce_loss 1.2119 (1.3740) teacher_loss 0.7195 (0.8160) loss_zs_kd 0.4454 (0.4807) loss_oracle 0.4717 (0.5049) acc 59.3750 (50.1228) kd_loss 0.8286 (0.8272) lr 1.7713e-05 eta 0:00:54
epoch [49/50] batch [300/428] time 0.069 (0.095) data 0.000 (0.002) loss 1.3832 (1.5559) ce_loss 1.2188 (1.3684) teacher_loss 0.6184 (0.8113) loss_zs_kd 0.4710 (0.4810) loss_oracle 0.5293 (0.5041) acc 53.1250 (50.2604) kd_loss 0.7958 (0.8259) lr 1.7713e-05 eta 0:00:52
epoch [49/50] batch [320/428] time 0.157 (0.095) data 0.000 (0.002) loss 1.4400 (1.5542) ce_loss 1.2393 (1.3686) teacher_loss 0.7534 (0.8098) loss_zs_kd 0.4891 (0.4813) loss_oracle 0.4420 (0.5038) acc 59.3750 (50.1660) kd_loss 0.7402 (0.8258) lr 1.7713e-05 eta 0:00:50
epoch [49/50] batch [340/428] time 0.157 (0.096) data 0.000 (0.002) loss 1.5284 (1.5545) ce_loss 1.5410 (1.3694) teacher_loss 0.6727 (0.8091) loss_zs_kd 0.5704 (0.4827) loss_oracle 0.5705 (0.5040) acc 46.8750 (50.1746) kd_loss 0.8055 (0.8264) lr 1.7713e-05 eta 0:00:49
epoch [49/50] batch [360/428] time 0.174 (0.097) data 0.000 (0.002) loss 1.3356 (1.5532) ce_loss 1.0674 (1.3672) teacher_loss 0.5288 (0.8072) loss_zs_kd 0.4743 (0.4826) loss_oracle 0.5696 (0.5048) acc 59.3750 (50.2431) kd_loss 0.8615 (0.8266) lr 1.7713e-05 eta 0:00:48
epoch [49/50] batch [380/428] time 0.105 (0.097) data 0.000 (0.002) loss 1.1924 (1.5537) ce_loss 0.8936 (1.3686) teacher_loss 0.5035 (0.8075) loss_zs_kd 0.4017 (0.4829) loss_oracle 0.4881 (0.5048) acc 71.8750 (50.1151) kd_loss 0.7438 (0.8270) lr 1.7713e-05 eta 0:00:46
epoch [49/50] batch [400/428] time 0.097 (0.098) data 0.000 (0.002) loss 1.5338 (1.5510) ce_loss 1.3457 (1.3655) teacher_loss 0.8189 (0.8047) loss_zs_kd 0.4654 (0.4830) loss_oracle 0.4822 (0.5047) acc 50.0000 (50.2344) kd_loss 0.7237 (0.8250) lr 1.7713e-05 eta 0:00:44
epoch [49/50] batch [420/428] time 0.101 (0.098) data 0.000 (0.002) loss 1.3626 (1.5513) ce_loss 1.2734 (1.3666) teacher_loss 0.6025 (0.8049) loss_zs_kd 0.5123 (0.4830) loss_oracle 0.5039 (0.5049) acc 53.1250 (50.2158) kd_loss 0.9135 (0.8252) lr 1.7713e-05 eta 0:00:42
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,958
* accuracy: 50.3%
* error: 49.7%
* macro_f1: 36.6%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,565
* accuracy: 54.1%
* error: 45.9%
* macro_f1: 30.2%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [50/50] batch [20/428] time 0.117 (0.128) data 0.000 (0.022) loss 1.5045 (1.5409) ce_loss 1.2119 (1.3254) teacher_loss 0.7616 (0.7863) loss_zs_kd 0.5141 (0.4772) loss_oracle 0.4858 (0.5160) acc 56.2500 (53.5938) kd_loss 0.7175 (0.8279) lr 7.8853e-06 eta 0:00:52
epoch [50/50] batch [40/428] time 0.108 (0.117) data 0.000 (0.011) loss 1.7184 (1.5413) ce_loss 1.5332 (1.3512) teacher_loss 0.9452 (0.7952) loss_zs_kd 0.5128 (0.4804) loss_oracle 0.5167 (0.5059) acc 40.6250 (50.6250) kd_loss 0.8094 (0.8290) lr 7.8853e-06 eta 0:00:45
epoch [50/50] batch [60/428] time 0.100 (0.113) data 0.001 (0.008) loss 1.5645 (1.5491) ce_loss 1.1768 (1.3512) teacher_loss 0.7981 (0.8016) loss_zs_kd 0.4372 (0.4835) loss_oracle 0.5477 (0.5058) acc 53.1250 (50.1562) kd_loss 0.8172 (0.8219) lr 7.8853e-06 eta 0:00:41
epoch [50/50] batch [80/428] time 0.115 (0.111) data 0.000 (0.006) loss 1.5976 (1.5609) ce_loss 1.4209 (1.3614) teacher_loss 0.7727 (0.8143) loss_zs_kd 0.5215 (0.4836) loss_oracle 0.5641 (0.5048) acc 50.0000 (49.8047) kd_loss 0.8858 (0.8141) lr 7.8853e-06 eta 0:00:38
epoch [50/50] batch [100/428] time 0.102 (0.110) data 0.000 (0.005) loss 1.7048 (1.5594) ce_loss 1.6240 (1.3540) teacher_loss 0.9491 (0.8122) loss_zs_kd 0.4947 (0.4845) loss_oracle 0.5084 (0.5049) acc 40.6250 (50.2812) kd_loss 0.7713 (0.8085) lr 7.8853e-06 eta 0:00:36
epoch [50/50] batch [120/428] time 0.111 (0.109) data 0.000 (0.004) loss 1.4275 (1.5510) ce_loss 1.4004 (1.3511) teacher_loss 0.6806 (0.8049) loss_zs_kd 0.5212 (0.4846) loss_oracle 0.4863 (0.5038) acc 43.7500 (50.0781) kd_loss 0.9763 (0.8082) lr 7.8853e-06 eta 0:00:33
epoch [50/50] batch [140/428] time 0.104 (0.109) data 0.000 (0.003) loss 1.7667 (1.5538) ce_loss 1.7637 (1.3546) teacher_loss 0.9394 (0.8098) loss_zs_kd 0.5227 (0.4846) loss_oracle 0.5659 (0.5016) acc 40.6250 (50.0223) kd_loss 0.9731 (0.8039) lr 7.8853e-06 eta 0:00:31
epoch [50/50] batch [160/428] time 0.103 (0.108) data 0.000 (0.003) loss 1.6354 (1.5577) ce_loss 1.3613 (1.3620) teacher_loss 0.8966 (0.8129) loss_zs_kd 0.5725 (0.4857) loss_oracle 0.4525 (0.5019) acc 53.1250 (50.0391) kd_loss 0.8690 (0.8082) lr 7.8853e-06 eta 0:00:29
epoch [50/50] batch [180/428] time 0.107 (0.108) data 0.000 (0.003) loss 1.7815 (1.5593) ce_loss 1.4600 (1.3649) teacher_loss 1.0263 (0.8152) loss_zs_kd 0.4263 (0.4845) loss_oracle 0.5420 (0.5019) acc 53.1250 (50.1042) kd_loss 0.7289 (0.8103) lr 7.8853e-06 eta 0:00:26
epoch [50/50] batch [200/428] time 0.102 (0.108) data 0.000 (0.002) loss 1.6691 (1.5561) ce_loss 1.4355 (1.3637) teacher_loss 0.8837 (0.8114) loss_zs_kd 0.5313 (0.4834) loss_oracle 0.5198 (0.5031) acc 40.6250 (50.2656) kd_loss 0.7148 (0.8110) lr 7.8853e-06 eta 0:00:24
epoch [50/50] batch [220/428] time 0.088 (0.106) data 0.000 (0.002) loss 1.3885 (1.5532) ce_loss 1.1553 (1.3631) teacher_loss 0.7319 (0.8100) loss_zs_kd 0.4174 (0.4827) loss_oracle 0.4479 (0.5019) acc 53.1250 (50.0852) kd_loss 0.6487 (0.8099) lr 7.8853e-06 eta 0:00:21
epoch [50/50] batch [240/428] time 0.180 (0.106) data 0.000 (0.002) loss 1.4814 (1.5534) ce_loss 1.3691 (1.3614) teacher_loss 0.7702 (0.8093) loss_zs_kd 0.4464 (0.4827) loss_oracle 0.4880 (0.5027) acc 43.7500 (50.1172) kd_loss 0.7250 (0.8114) lr 7.8853e-06 eta 0:00:19
epoch [50/50] batch [260/428] time 0.088 (0.106) data 0.000 (0.002) loss 1.4959 (1.5539) ce_loss 1.5332 (1.3649) teacher_loss 0.8015 (0.8118) loss_zs_kd 0.4708 (0.4820) loss_oracle 0.4591 (0.5012) acc 37.5000 (49.8798) kd_loss 0.8898 (0.8122) lr 7.8853e-06 eta 0:00:17
epoch [50/50] batch [280/428] time 0.075 (0.107) data 0.000 (0.002) loss 1.5763 (1.5517) ce_loss 1.4033 (1.3632) teacher_loss 0.7551 (0.8084) loss_zs_kd 0.5885 (0.4827) loss_oracle 0.5269 (0.5019) acc 43.7500 (49.9665) kd_loss 0.8675 (0.8145) lr 7.8853e-06 eta 0:00:15
epoch [50/50] batch [300/428] time 0.087 (0.107) data 0.000 (0.002) loss 1.6360 (1.5505) ce_loss 1.2852 (1.3595) teacher_loss 0.9798 (0.8086) loss_zs_kd 0.3868 (0.4822) loss_oracle 0.4627 (0.5009) acc 50.0000 (50.1146) kd_loss 0.7313 (0.8141) lr 7.8853e-06 eta 0:00:13
epoch [50/50] batch [320/428] time 0.153 (0.106) data 0.000 (0.002) loss 1.7662 (1.5513) ce_loss 1.4678 (1.3606) teacher_loss 1.0516 (0.8084) loss_zs_kd 0.4915 (0.4827) loss_oracle 0.4688 (0.5016) acc 43.7500 (50.0977) kd_loss 0.8454 (0.8156) lr 7.8853e-06 eta 0:00:11
epoch [50/50] batch [340/428] time 0.076 (0.107) data 0.000 (0.002) loss 1.6940 (1.5547) ce_loss 1.5693 (1.3644) teacher_loss 0.9616 (0.8124) loss_zs_kd 0.4749 (0.4826) loss_oracle 0.4949 (0.5010) acc 34.3750 (50.0184) kd_loss 0.9480 (0.8163) lr 7.8853e-06 eta 0:00:09
epoch [50/50] batch [360/428] time 0.078 (0.107) data 0.000 (0.002) loss 1.5016 (1.5563) ce_loss 1.2363 (1.3675) teacher_loss 0.7646 (0.8144) loss_zs_kd 0.4742 (0.4820) loss_oracle 0.5000 (0.5009) acc 62.5000 (49.9392) kd_loss 0.7182 (0.8161) lr 7.8853e-06 eta 0:00:07
epoch [50/50] batch [380/428] time 0.103 (0.107) data 0.000 (0.001) loss 1.4778 (1.5557) ce_loss 1.4160 (1.3675) teacher_loss 0.7818 (0.8132) loss_zs_kd 0.4505 (0.4823) loss_oracle 0.4707 (0.5014) acc 46.8750 (49.8766) kd_loss 0.9726 (0.8160) lr 7.8853e-06 eta 0:00:05
epoch [50/50] batch [400/428] time 0.119 (0.107) data 0.000 (0.001) loss 1.5907 (1.5515) ce_loss 1.4092 (1.3634) teacher_loss 0.8163 (0.8084) loss_zs_kd 0.5248 (0.4830) loss_oracle 0.5120 (0.5016) acc 40.6250 (49.9844) kd_loss 0.7146 (0.8176) lr 7.8853e-06 eta 0:00:02
epoch [50/50] batch [420/428] time 0.100 (0.107) data 0.000 (0.001) loss 1.3007 (1.5507) ce_loss 1.1533 (1.3633) teacher_loss 0.5843 (0.8074) loss_zs_kd 0.4998 (0.4828) loss_oracle 0.4665 (0.5018) acc 56.2500 (49.9628) kd_loss 1.0211 (0.8183) lr 7.8853e-06 eta 0:00:00
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,953
* accuracy: 50.3%
* error: 49.7%
* macro_f1: 36.5%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,574
* accuracy: 54.3%
* error: 45.7%
* macro_f1: 30.1%
******* Domain 1 best val acc:      53.4%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:52:41
