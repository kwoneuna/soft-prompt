Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_100', 'location_43', 'location_46']
Target     ['location_38']
# classes  10
# train_x  10,216
# val      4,378
# test     9,736
---------  ----------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/319] time 0.099 (0.158) data 0.000 (0.033) loss 1.2538 (2.0168) ce_loss 1.2539 (2.0159) teacher_loss 1.2535 (2.0159) loss_zs_kd 0.0002 (0.0001) loss_oracle 0.0002 (0.0008) acc 59.3750 (37.0312) kd_loss 0.0007 (0.0033) lr 1.0000e-05 eta 0:41:57
epoch [1/50] batch [40/319] time 0.104 (0.128) data 0.000 (0.017) loss 1.5753 (1.9132) ce_loss 1.5742 (1.9125) teacher_loss 1.5741 (1.9124) loss_zs_kd 0.0015 (0.0003) loss_oracle 0.0005 (0.0007) acc 56.2500 (39.7656) kd_loss 0.0020 (0.0026) lr 1.0000e-05 eta 0:33:51
epoch [1/50] batch [60/319] time 0.115 (0.120) data 0.000 (0.011) loss 2.1729 (1.9416) ce_loss 2.1719 (1.9406) teacher_loss 2.1714 (1.9407) loss_zs_kd 0.0024 (0.0007) loss_oracle 0.0003 (0.0006) acc 31.2500 (39.2188) kd_loss 0.0010 (0.0022) lr 1.0000e-05 eta 0:31:39
epoch [1/50] batch [80/319] time 0.105 (0.116) data 0.000 (0.008) loss 1.9736 (1.9235) ce_loss 1.9717 (1.9224) teacher_loss 1.9713 (1.9224) loss_zs_kd 0.0034 (0.0013) loss_oracle 0.0005 (0.0005) acc 43.7500 (38.7891) kd_loss 0.0015 (0.0019) lr 1.0000e-05 eta 0:30:34
epoch [1/50] batch [100/319] time 0.104 (0.113) data 0.000 (0.007) loss 2.1777 (1.8855) ce_loss 2.1758 (1.8839) teacher_loss 2.1739 (1.8839) loss_zs_kd 0.0065 (0.0022) loss_oracle 0.0005 (0.0005) acc 25.0000 (39.3438) kd_loss 0.0014 (0.0019) lr 1.0000e-05 eta 0:29:56
epoch [1/50] batch [120/319] time 0.084 (0.110) data 0.000 (0.006) loss 1.8792 (1.8842) ce_loss 1.8760 (1.8822) teacher_loss 1.8755 (1.8822) loss_zs_kd 0.0052 (0.0029) loss_oracle 0.0011 (0.0006) acc 40.6250 (39.5052) kd_loss 0.0035 (0.0019) lr 1.0000e-05 eta 0:28:59
epoch [1/50] batch [140/319] time 0.086 (0.108) data 0.000 (0.005) loss 2.0693 (1.8851) ce_loss 2.0625 (1.8828) teacher_loss 2.0633 (1.8826) loss_zs_kd 0.0082 (0.0037) loss_oracle 0.0018 (0.0007) acc 37.5000 (39.4420) kd_loss 0.0052 (0.0022) lr 1.0000e-05 eta 0:28:30
epoch [1/50] batch [160/319] time 0.171 (0.107) data 0.000 (0.004) loss 1.8444 (1.8824) ce_loss 1.8369 (1.8794) teacher_loss 1.8371 (1.8792) loss_zs_kd 0.0110 (0.0048) loss_oracle 0.0018 (0.0008) acc 34.3750 (39.5898) kd_loss 0.0038 (0.0025) lr 1.0000e-05 eta 0:28:15
epoch [1/50] batch [180/319] time 0.089 (0.107) data 0.000 (0.004) loss 2.1984 (1.8801) ce_loss 2.1875 (1.8765) teacher_loss 2.1873 (1.8763) loss_zs_kd 0.0177 (0.0058) loss_oracle 0.0023 (0.0009) acc 28.1250 (39.5139) kd_loss 0.0055 (0.0027) lr 1.0000e-05 eta 0:28:07
epoch [1/50] batch [200/319] time 0.074 (0.108) data 0.000 (0.004) loss 2.0065 (1.8770) ce_loss 1.9961 (1.8726) teacher_loss 1.9941 (1.8724) loss_zs_kd 0.0180 (0.0069) loss_oracle 0.0034 (0.0011) acc 31.2500 (39.5312) kd_loss 0.0087 (0.0032) lr 1.0000e-05 eta 0:28:15
epoch [1/50] batch [220/319] time 0.082 (0.107) data 0.000 (0.003) loss 1.7622 (1.8846) ce_loss 1.7480 (1.8793) teacher_loss 1.7459 (1.8790) loss_zs_kd 0.0215 (0.0082) loss_oracle 0.0055 (0.0014) acc 40.6250 (39.1477) kd_loss 0.0163 (0.0040) lr 1.0000e-05 eta 0:28:10
epoch [1/50] batch [240/319] time 0.076 (0.107) data 0.000 (0.003) loss 1.9692 (1.8928) ce_loss 1.9453 (1.8865) teacher_loss 1.9450 (1.8862) loss_zs_kd 0.0299 (0.0094) loss_oracle 0.0092 (0.0019) acc 25.0000 (38.8021) kd_loss 0.0259 (0.0052) lr 1.0000e-05 eta 0:27:53
epoch [1/50] batch [260/319] time 0.094 (0.106) data 0.000 (0.003) loss 1.9922 (1.8920) ce_loss 1.9727 (1.8847) teacher_loss 1.9694 (1.8842) loss_zs_kd 0.0258 (0.0106) loss_oracle 0.0099 (0.0025) acc 37.5000 (38.6779) kd_loss 0.0261 (0.0070) lr 1.0000e-05 eta 0:27:41
epoch [1/50] batch [280/319] time 0.073 (0.106) data 0.000 (0.003) loss 2.0999 (1.8905) ce_loss 2.0742 (1.8819) teacher_loss 2.0689 (1.8812) loss_zs_kd 0.0335 (0.0119) loss_oracle 0.0142 (0.0034) acc 31.2500 (38.6719) kd_loss 0.0406 (0.0094) lr 1.0000e-05 eta 0:27:48
epoch [1/50] batch [300/319] time 0.082 (0.107) data 0.000 (0.002) loss 2.3540 (1.8890) ce_loss 2.3223 (1.8786) teacher_loss 2.3162 (1.8777) loss_zs_kd 0.0331 (0.0132) loss_oracle 0.0213 (0.0046) acc 28.1250 (38.6146) kd_loss 0.0569 (0.0128) lr 1.0000e-05 eta 0:27:49
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 1,744
* accuracy: 39.8%
* error: 60.2%
* macro_f1: 24.2%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 2,836
* accuracy: 29.1%
* error: 70.9%
* macro_f1: 11.2%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      39.8%, epoch: 1 *******
******* Domain 2 best val test acc: 29.1%, epoch: 1 *******
******* Domain 2 best test acc:     29.1%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/ana
epoch [2/50] batch [20/319] time 0.117 (0.133) data 0.000 (0.031) loss 2.0055 (1.8018) ce_loss 1.7461 (1.6525) teacher_loss 1.6865 (1.6196) loss_zs_kd 0.1394 (0.1499) loss_oracle 0.2493 (0.1073) acc 37.5000 (39.8438) kd_loss 0.6011 (0.2518) lr 2.0000e-03 eta 0:34:32
epoch [2/50] batch [40/319] time 0.107 (0.116) data 0.000 (0.016) loss 2.4121 (1.8846) ce_loss 2.1445 (1.6451) teacher_loss 2.0597 (1.5962) loss_zs_kd 0.1412 (0.1560) loss_oracle 0.2818 (0.2103) acc 31.2500 (41.0156) kd_loss 0.7550 (0.5253) lr 2.0000e-03 eta 0:30:14
epoch [2/50] batch [60/319] time 0.092 (0.112) data 0.000 (0.011) loss 1.9769 (1.8851) ce_loss 1.7324 (1.6406) teacher_loss 1.4517 (1.5598) loss_zs_kd 0.1124 (0.1478) loss_oracle 0.4690 (0.2514) acc 34.3750 (41.4583) kd_loss 1.0235 (0.6568) lr 2.0000e-03 eta 0:29:03
epoch [2/50] batch [80/319] time 0.101 (0.110) data 0.000 (0.008) loss 1.9136 (1.8889) ce_loss 1.7119 (1.6393) teacher_loss 1.4840 (1.5333) loss_zs_kd 0.1141 (0.1414) loss_oracle 0.3726 (0.2849) acc 31.2500 (41.6406) kd_loss 1.0079 (0.7337) lr 2.0000e-03 eta 0:28:30
epoch [2/50] batch [100/319] time 0.101 (0.109) data 0.000 (0.006) loss 1.9317 (1.8916) ce_loss 1.7598 (1.6461) teacher_loss 1.4709 (1.5149) loss_zs_kd 0.1348 (0.1404) loss_oracle 0.3934 (0.3065) acc 37.5000 (41.7188) kd_loss 0.9785 (0.7827) lr 2.0000e-03 eta 0:28:06
epoch [2/50] batch [120/319] time 0.109 (0.108) data 0.000 (0.005) loss 1.6109 (1.8867) ce_loss 1.4053 (1.6452) teacher_loss 1.0506 (1.4881) loss_zs_kd 0.1458 (0.1419) loss_oracle 0.4874 (0.3276) acc 56.2500 (41.4583) kd_loss 1.0252 (0.8174) lr 2.0000e-03 eta 0:27:50
epoch [2/50] batch [140/319] time 0.110 (0.107) data 0.000 (0.005) loss 2.2316 (1.8975) ce_loss 1.8545 (1.6415) teacher_loss 1.6139 (1.4721) loss_zs_kd 0.1457 (0.1426) loss_oracle 0.5448 (0.3542) acc 46.8750 (41.2277) kd_loss 0.9018 (0.8399) lr 2.0000e-03 eta 0:27:37
epoch [2/50] batch [160/319] time 0.101 (0.106) data 0.000 (0.004) loss 1.8210 (1.9005) ce_loss 1.4092 (1.6314) teacher_loss 1.2495 (1.4508) loss_zs_kd 0.1353 (0.1446) loss_oracle 0.5039 (0.3774) acc 50.0000 (41.7969) kd_loss 0.9657 (0.8576) lr 2.0000e-03 eta 0:27:24
epoch [2/50] batch [180/319] time 0.077 (0.104) data 0.000 (0.004) loss 2.1273 (1.9049) ce_loss 1.6084 (1.6296) teacher_loss 1.5276 (1.4406) loss_zs_kd 0.2050 (0.1446) loss_oracle 0.4973 (0.3920) acc 46.8750 (41.7535) kd_loss 0.9863 (0.8691) lr 2.0000e-03 eta 0:26:47
epoch [2/50] batch [200/319] time 0.084 (0.104) data 0.000 (0.003) loss 1.8309 (1.9047) ce_loss 1.4219 (1.6281) teacher_loss 1.2839 (1.4295) loss_zs_kd 0.1566 (0.1455) loss_oracle 0.4686 (0.4024) acc 53.1250 (41.8438) kd_loss 0.9361 (0.8771) lr 2.0000e-03 eta 0:26:39
epoch [2/50] batch [220/319] time 0.167 (0.105) data 0.000 (0.003) loss 2.2136 (1.9072) ce_loss 1.8652 (1.6306) teacher_loss 1.5712 (1.4189) loss_zs_kd 0.1444 (0.1475) loss_oracle 0.5702 (0.4145) acc 25.0000 (41.4773) kd_loss 0.9493 (0.8839) lr 2.0000e-03 eta 0:26:51
epoch [2/50] batch [240/319] time 0.152 (0.105) data 0.000 (0.003) loss 1.7591 (1.9083) ce_loss 1.3359 (1.6251) teacher_loss 1.0823 (1.4063) loss_zs_kd 0.1671 (0.1484) loss_oracle 0.5932 (0.4278) acc 46.8750 (41.5495) kd_loss 0.9482 (0.8892) lr 2.0000e-03 eta 0:26:53
epoch [2/50] batch [260/319] time 0.157 (0.105) data 0.000 (0.003) loss 1.7925 (1.9011) ce_loss 1.5762 (1.6123) teacher_loss 1.1287 (1.3875) loss_zs_kd 0.1388 (0.1493) loss_oracle 0.5944 (0.4390) acc 43.7500 (41.9351) kd_loss 0.9720 (0.8924) lr 2.0000e-03 eta 0:26:55
epoch [2/50] batch [280/319] time 0.084 (0.104) data 0.000 (0.002) loss 1.7585 (1.9009) ce_loss 1.5518 (1.6096) teacher_loss 1.1706 (1.3799) loss_zs_kd 0.1423 (0.1508) loss_oracle 0.5167 (0.4456) acc 43.7500 (42.0647) kd_loss 0.8909 (0.8924) lr 2.0000e-03 eta 0:26:32
epoch [2/50] batch [300/319] time 0.072 (0.104) data 0.000 (0.002) loss 1.8468 (1.9022) ce_loss 1.4434 (1.6105) teacher_loss 1.2217 (1.3757) loss_zs_kd 0.2041 (0.1528) loss_oracle 0.5230 (0.4502) acc 40.6250 (41.9062) kd_loss 0.8257 (0.8916) lr 2.0000e-03 eta 0:26:39
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 1,901
* accuracy: 43.4%
* error: 56.6%
* macro_f1: 30.4%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 2,662
* accuracy: 27.3%
* error: 72.7%
* macro_f1: 13.7%
******* Domain 2 best val acc:      43.4%, epoch: 2 *******
******* Domain 2 best val test acc: 27.3%, epoch: 2 *******
******* Domain 2 best test acc:     29.1%, epoch: 1 *******
epoch [3/50] batch [20/319] time 0.112 (0.133) data 0.000 (0.027) loss 1.6302 (1.8705) ce_loss 1.2422 (1.4925) teacher_loss 0.9925 (1.1834) loss_zs_kd 0.1398 (0.1746) loss_oracle 0.5678 (0.5998) acc 50.0000 (42.1875) kd_loss 0.8746 (0.8775) lr 1.9980e-03 eta 0:33:51
epoch [3/50] batch [40/319] time 0.099 (0.118) data 0.000 (0.014) loss 1.7891 (1.8601) ce_loss 1.4717 (1.5143) teacher_loss 1.2327 (1.2044) loss_zs_kd 0.1591 (0.1790) loss_oracle 0.4769 (0.5663) acc 50.0000 (42.5781) kd_loss 0.8873 (0.8769) lr 1.9980e-03 eta 0:30:05
epoch [3/50] batch [60/319] time 0.096 (0.113) data 0.001 (0.009) loss 1.6389 (1.8398) ce_loss 1.2246 (1.5152) teacher_loss 1.0566 (1.2045) loss_zs_kd 0.1593 (0.1775) loss_oracle 0.5027 (0.5465) acc 59.3750 (43.5417) kd_loss 0.8789 (0.8757) lr 1.9980e-03 eta 0:28:49
epoch [3/50] batch [80/319] time 0.100 (0.111) data 0.000 (0.007) loss 1.7425 (1.8392) ce_loss 1.5244 (1.5290) teacher_loss 0.9833 (1.2080) loss_zs_kd 0.1825 (0.1811) loss_oracle 0.6680 (0.5407) acc 43.7500 (43.0469) kd_loss 0.9162 (0.8697) lr 1.9980e-03 eta 0:28:10
epoch [3/50] batch [100/319] time 0.098 (0.110) data 0.000 (0.006) loss 1.7287 (1.8356) ce_loss 1.3809 (1.5276) teacher_loss 1.2161 (1.2095) loss_zs_kd 0.2294 (0.1827) loss_oracle 0.3979 (0.5347) acc 50.0000 (43.2188) kd_loss 0.8290 (0.8631) lr 1.9980e-03 eta 0:27:48
epoch [3/50] batch [120/319] time 0.102 (0.109) data 0.000 (0.005) loss 1.8819 (1.8313) ce_loss 1.6191 (1.5247) teacher_loss 1.3678 (1.2101) loss_zs_kd 0.1692 (0.1816) loss_oracle 0.4294 (0.5304) acc 46.8750 (43.4896) kd_loss 0.8169 (0.8589) lr 1.9980e-03 eta 0:27:32
epoch [3/50] batch [140/319] time 0.093 (0.108) data 0.000 (0.004) loss 1.6405 (1.8267) ce_loss 1.3311 (1.5224) teacher_loss 0.9985 (1.2055) loss_zs_kd 0.1702 (0.1829) loss_oracle 0.5569 (0.5298) acc 56.2500 (43.5938) kd_loss 0.8658 (0.8567) lr 1.9980e-03 eta 0:27:19
epoch [3/50] batch [160/319] time 0.102 (0.108) data 0.000 (0.004) loss 1.6730 (1.8248) ce_loss 1.2676 (1.5235) teacher_loss 1.0205 (1.2010) loss_zs_kd 0.2055 (0.1849) loss_oracle 0.5497 (0.5314) acc 56.2500 (43.6328) kd_loss 0.8360 (0.8535) lr 1.9980e-03 eta 0:27:09
epoch [3/50] batch [180/319] time 0.107 (0.107) data 0.001 (0.003) loss 1.7845 (1.8252) ce_loss 1.4746 (1.5290) teacher_loss 1.2427 (1.1990) loss_zs_kd 0.2311 (0.1900) loss_oracle 0.4262 (0.5312) acc 46.8750 (43.3160) kd_loss 0.8463 (0.8523) lr 1.9980e-03 eta 0:27:02
epoch [3/50] batch [200/319] time 0.100 (0.107) data 0.000 (0.003) loss 1.7553 (1.8143) ce_loss 1.4570 (1.5243) teacher_loss 1.1847 (1.1924) loss_zs_kd 0.2546 (0.1938) loss_oracle 0.4432 (0.5250) acc 37.5000 (43.4219) kd_loss 0.8227 (0.8505) lr 1.9980e-03 eta 0:26:54
epoch [3/50] batch [220/319] time 0.102 (0.107) data 0.000 (0.003) loss 1.7984 (1.8110) ce_loss 1.7490 (1.5268) teacher_loss 1.1503 (1.1885) loss_zs_kd 0.1898 (0.1976) loss_oracle 0.5532 (0.5237) acc 34.3750 (43.3949) kd_loss 0.8443 (0.8483) lr 1.9980e-03 eta 0:26:48
epoch [3/50] batch [240/319] time 0.085 (0.105) data 0.000 (0.002) loss 2.1838 (1.8087) ce_loss 1.8740 (1.5229) teacher_loss 1.4474 (1.1808) loss_zs_kd 0.2815 (0.2022) loss_oracle 0.5956 (0.5268) acc 31.2500 (43.5677) kd_loss 0.7672 (0.8467) lr 1.9980e-03 eta 0:26:21
epoch [3/50] batch [260/319] time 0.087 (0.104) data 0.000 (0.002) loss 1.7358 (1.8108) ce_loss 1.6035 (1.5247) teacher_loss 1.0980 (1.1799) loss_zs_kd 0.2687 (0.2062) loss_oracle 0.5034 (0.5278) acc 40.6250 (43.5457) kd_loss 0.7979 (0.8442) lr 1.9980e-03 eta 0:26:07
epoch [3/50] batch [280/319] time 0.076 (0.103) data 0.000 (0.002) loss 1.7509 (1.8065) ce_loss 1.5293 (1.5188) teacher_loss 1.0649 (1.1717) loss_zs_kd 0.2674 (0.2100) loss_oracle 0.5522 (0.5297) acc 50.0000 (43.6719) kd_loss 0.7911 (0.8431) lr 1.9980e-03 eta 0:25:50
epoch [3/50] batch [300/319] time 0.165 (0.103) data 0.000 (0.002) loss 1.5746 (1.8057) ce_loss 1.3066 (1.5173) teacher_loss 0.8749 (1.1686) loss_zs_kd 0.2262 (0.2135) loss_oracle 0.5867 (0.5304) acc 53.1250 (43.7188) kd_loss 0.8560 (0.8417) lr 1.9980e-03 eta 0:25:47
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 1,961
* accuracy: 44.8%
* error: 55.2%
* macro_f1: 33.8%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,256
* accuracy: 33.4%
* error: 66.6%
* macro_f1: 16.1%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      44.8%, epoch: 3 *******
******* Domain 2 best val test acc: 33.4%, epoch: 3 *******
******* Domain 2 best test acc:     33.4%, epoch: 3 *******
epoch [4/50] batch [20/319] time 0.080 (0.108) data 0.000 (0.028) loss 1.7481 (1.7096) ce_loss 1.5684 (1.4620) teacher_loss 1.1151 (1.0635) loss_zs_kd 0.3032 (0.2800) loss_oracle 0.4814 (0.5061) acc 50.0000 (45.1562) kd_loss 0.7826 (0.8027) lr 1.9921e-03 eta 0:26:52
epoch [4/50] batch [40/319] time 0.102 (0.103) data 0.000 (0.014) loss 1.6049 (1.7064) ce_loss 1.2881 (1.4385) teacher_loss 1.0122 (1.0556) loss_zs_kd 0.2906 (0.2873) loss_oracle 0.4474 (0.5072) acc 43.7500 (44.8438) kd_loss 0.8019 (0.8072) lr 1.9921e-03 eta 0:25:35
epoch [4/50] batch [60/319] time 0.103 (0.103) data 0.000 (0.009) loss 2.0441 (1.6925) ce_loss 1.5498 (1.4139) teacher_loss 1.2449 (1.0429) loss_zs_kd 0.3098 (0.2875) loss_oracle 0.6443 (0.5058) acc 56.2500 (46.3021) kd_loss 0.8791 (0.8077) lr 1.9921e-03 eta 0:25:37
epoch [4/50] batch [80/319] time 0.105 (0.103) data 0.000 (0.007) loss 1.6619 (1.7035) ce_loss 1.4072 (1.4257) teacher_loss 1.0345 (1.0465) loss_zs_kd 0.3112 (0.2986) loss_oracle 0.4717 (0.5077) acc 53.1250 (45.7422) kd_loss 0.7487 (0.8075) lr 1.9921e-03 eta 0:25:41
epoch [4/50] batch [100/319] time 0.102 (0.104) data 0.000 (0.006) loss 1.6031 (1.7059) ce_loss 1.2373 (1.4278) teacher_loss 0.9659 (1.0501) loss_zs_kd 0.3086 (0.3027) loss_oracle 0.4829 (0.5045) acc 53.1250 (45.6562) kd_loss 0.8353 (0.8051) lr 1.9921e-03 eta 0:25:41
epoch [4/50] batch [120/319] time 0.096 (0.103) data 0.000 (0.005) loss 1.7140 (1.7051) ce_loss 1.4365 (1.4359) teacher_loss 0.9801 (1.0494) loss_zs_kd 0.3708 (0.3073) loss_oracle 0.5485 (0.5020) acc 43.7500 (45.0781) kd_loss 0.8980 (0.8045) lr 1.9921e-03 eta 0:25:36
epoch [4/50] batch [140/319] time 0.102 (0.103) data 0.000 (0.004) loss 1.9929 (1.7066) ce_loss 1.6289 (1.4329) teacher_loss 1.3242 (1.0472) loss_zs_kd 0.3215 (0.3122) loss_oracle 0.5079 (0.5033) acc 37.5000 (45.4241) kd_loss 0.7981 (0.8074) lr 1.9921e-03 eta 0:25:28
epoch [4/50] batch [160/319] time 0.100 (0.103) data 0.000 (0.004) loss 2.2377 (1.7089) ce_loss 2.0957 (1.4324) teacher_loss 1.4829 (1.0429) loss_zs_kd 0.3365 (0.3154) loss_oracle 0.5866 (0.5083) acc 25.0000 (45.5664) kd_loss 0.7737 (0.8093) lr 1.9921e-03 eta 0:25:29
epoch [4/50] batch [180/319] time 0.112 (0.103) data 0.000 (0.003) loss 1.7008 (1.7093) ce_loss 1.4980 (1.4324) teacher_loss 1.0828 (1.0412) loss_zs_kd 0.2733 (0.3183) loss_oracle 0.4814 (0.5090) acc 46.8750 (45.2604) kd_loss 0.7839 (0.8093) lr 1.9921e-03 eta 0:25:30
epoch [4/50] batch [200/319] time 0.114 (0.104) data 0.000 (0.003) loss 1.7872 (1.7115) ce_loss 1.4102 (1.4276) teacher_loss 1.0163 (1.0391) loss_zs_kd 0.2994 (0.3186) loss_oracle 0.6212 (0.5130) acc 37.5000 (45.5781) kd_loss 0.8092 (0.8085) lr 1.9921e-03 eta 0:25:31
epoch [4/50] batch [220/319] time 0.104 (0.104) data 0.000 (0.003) loss 1.9163 (1.7144) ce_loss 1.4121 (1.4234) teacher_loss 1.2288 (1.0376) loss_zs_kd 0.3272 (0.3189) loss_oracle 0.5239 (0.5174) acc 53.1250 (45.7244) kd_loss 0.8234 (0.8083) lr 1.9921e-03 eta 0:25:30
epoch [4/50] batch [240/319] time 0.108 (0.104) data 0.000 (0.003) loss 1.8463 (1.7186) ce_loss 1.4844 (1.4230) teacher_loss 1.0723 (1.0392) loss_zs_kd 0.3216 (0.3180) loss_oracle 0.6131 (0.5205) acc 50.0000 (45.7552) kd_loss 0.8380 (0.8084) lr 1.9921e-03 eta 0:25:29
epoch [4/50] batch [260/319] time 0.102 (0.104) data 0.000 (0.002) loss 1.8775 (1.7237) ce_loss 1.5625 (1.4246) teacher_loss 1.1763 (1.0418) loss_zs_kd 0.3659 (0.3204) loss_oracle 0.5182 (0.5216) acc 31.2500 (45.6490) kd_loss 0.8005 (0.8083) lr 1.9921e-03 eta 0:25:28
epoch [4/50] batch [280/319] time 0.103 (0.104) data 0.000 (0.002) loss 1.6336 (1.7212) ce_loss 1.3564 (1.4164) teacher_loss 0.8567 (1.0350) loss_zs_kd 0.3429 (0.3201) loss_oracle 0.6054 (0.5261) acc 50.0000 (45.9152) kd_loss 0.8975 (0.8120) lr 1.9921e-03 eta 0:25:27
epoch [4/50] batch [300/319] time 0.107 (0.104) data 0.000 (0.002) loss 1.7799 (1.7208) ce_loss 1.3594 (1.4124) teacher_loss 1.0342 (1.0311) loss_zs_kd 0.3995 (0.3200) loss_oracle 0.5459 (0.5298) acc 50.0000 (46.1250) kd_loss 0.8146 (0.8150) lr 1.9921e-03 eta 0:25:26
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,070
* accuracy: 47.3%
* error: 52.7%
* macro_f1: 37.7%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,036
* accuracy: 41.5%
* error: 58.5%
* macro_f1: 17.1%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      47.3%, epoch: 4 *******
******* Domain 2 best val test acc: 41.5%, epoch: 4 *******
******* Domain 2 best test acc:     41.5%, epoch: 4 *******
epoch [5/50] batch [20/319] time 0.103 (0.129) data 0.000 (0.026) loss 1.7012 (1.7173) ce_loss 1.4883 (1.4100) teacher_loss 1.0521 (1.0296) loss_zs_kd 0.2505 (0.3190) loss_oracle 0.5238 (0.5282) acc 53.1250 (45.1562) kd_loss 0.8694 (0.8137) lr 1.9823e-03 eta 0:31:26
epoch [5/50] batch [40/319] time 0.072 (0.108) data 0.000 (0.013) loss 1.6458 (1.7356) ce_loss 1.1562 (1.3988) teacher_loss 0.8239 (1.0258) loss_zs_kd 0.4122 (0.3308) loss_oracle 0.6158 (0.5444) acc 59.3750 (45.7031) kd_loss 0.8185 (0.8091) lr 1.9823e-03 eta 0:26:26
epoch [5/50] batch [60/319] time 0.088 (0.100) data 0.000 (0.009) loss 1.5564 (1.7352) ce_loss 1.2686 (1.4046) teacher_loss 0.9240 (1.0218) loss_zs_kd 0.3834 (0.3365) loss_oracle 0.4406 (0.5451) acc 53.1250 (45.4688) kd_loss 0.7921 (0.8050) lr 1.9823e-03 eta 0:24:15
epoch [5/50] batch [80/319] time 0.086 (0.095) data 0.000 (0.007) loss 1.4631 (1.7216) ce_loss 1.0996 (1.3917) teacher_loss 0.7506 (1.0020) loss_zs_kd 0.2815 (0.3391) loss_oracle 0.5717 (0.5500) acc 56.2500 (46.3672) kd_loss 0.8449 (0.8121) lr 1.9823e-03 eta 0:23:13
epoch [5/50] batch [100/319] time 0.077 (0.093) data 0.000 (0.005) loss 1.8549 (1.7118) ce_loss 1.3877 (1.3878) teacher_loss 1.0555 (0.9873) loss_zs_kd 0.4310 (0.3473) loss_oracle 0.5839 (0.5508) acc 46.8750 (46.5938) kd_loss 0.8718 (0.8180) lr 1.9823e-03 eta 0:22:32
epoch [5/50] batch [120/319] time 0.076 (0.092) data 0.000 (0.004) loss 1.5418 (1.7137) ce_loss 1.3076 (1.3999) teacher_loss 0.8077 (0.9774) loss_zs_kd 0.3813 (0.3542) loss_oracle 0.5434 (0.5591) acc 40.6250 (45.9635) kd_loss 0.8530 (0.8277) lr 1.9823e-03 eta 0:22:14
epoch [5/50] batch [140/319] time 0.116 (0.092) data 0.000 (0.004) loss 1.8674 (1.7096) ce_loss 1.4814 (1.4022) teacher_loss 1.0954 (0.9630) loss_zs_kd 0.4165 (0.3628) loss_oracle 0.5638 (0.5652) acc 46.8750 (46.2277) kd_loss 0.8478 (0.8325) lr 1.9823e-03 eta 0:22:20
epoch [5/50] batch [160/319] time 0.099 (0.094) data 0.000 (0.003) loss 1.7986 (1.7062) ce_loss 1.4697 (1.4019) teacher_loss 1.0326 (0.9597) loss_zs_kd 0.4306 (0.3613) loss_oracle 0.5507 (0.5658) acc 46.8750 (46.2891) kd_loss 0.8072 (0.8332) lr 1.9823e-03 eta 0:22:39
epoch [5/50] batch [180/319] time 0.100 (0.095) data 0.000 (0.003) loss 1.4905 (1.7021) ce_loss 1.1172 (1.3971) teacher_loss 0.7037 (0.9569) loss_zs_kd 0.3399 (0.3593) loss_oracle 0.6168 (0.5656) acc 56.2500 (46.5278) kd_loss 0.8782 (0.8320) lr 1.9823e-03 eta 0:22:53
epoch [5/50] batch [200/319] time 0.098 (0.095) data 0.000 (0.003) loss 1.6844 (1.7000) ce_loss 1.3330 (1.3953) teacher_loss 1.0196 (0.9587) loss_zs_kd 0.3636 (0.3556) loss_oracle 0.4830 (0.5635) acc 62.5000 (46.7969) kd_loss 0.7740 (0.8299) lr 1.9823e-03 eta 0:22:59
epoch [5/50] batch [220/319] time 0.101 (0.096) data 0.000 (0.003) loss 1.4420 (1.6996) ce_loss 1.2100 (1.3967) teacher_loss 0.8092 (0.9621) loss_zs_kd 0.2505 (0.3534) loss_oracle 0.5075 (0.5608) acc 50.0000 (46.8040) kd_loss 0.7820 (0.8274) lr 1.9823e-03 eta 0:23:09
epoch [5/50] batch [240/319] time 0.110 (0.097) data 0.000 (0.002) loss 1.4656 (1.7011) ce_loss 1.2197 (1.4031) teacher_loss 0.7174 (0.9656) loss_zs_kd 0.3418 (0.3509) loss_oracle 0.5774 (0.5601) acc 50.0000 (46.5625) kd_loss 0.7770 (0.8267) lr 1.9823e-03 eta 0:23:16
epoch [5/50] batch [260/319] time 0.112 (0.097) data 0.000 (0.002) loss 1.7816 (1.7027) ce_loss 1.5283 (1.4064) teacher_loss 1.0799 (0.9679) loss_zs_kd 0.3322 (0.3504) loss_oracle 0.5356 (0.5596) acc 40.6250 (46.4904) kd_loss 0.7958 (0.8248) lr 1.9823e-03 eta 0:23:24
epoch [5/50] batch [280/319] time 0.100 (0.098) data 0.000 (0.002) loss 1.2930 (1.7001) ce_loss 1.1045 (1.4039) teacher_loss 0.5918 (0.9678) loss_zs_kd 0.2137 (0.3483) loss_oracle 0.5944 (0.5581) acc 53.1250 (46.6183) kd_loss 0.8186 (0.8221) lr 1.9823e-03 eta 0:23:27
epoch [5/50] batch [300/319] time 0.101 (0.098) data 0.000 (0.002) loss 1.6902 (1.7015) ce_loss 1.2949 (1.4055) teacher_loss 1.1274 (0.9709) loss_zs_kd 0.2714 (0.3472) loss_oracle 0.4271 (0.5570) acc 34.3750 (46.5938) kd_loss 0.6842 (0.8187) lr 1.9823e-03 eta 0:23:30
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,119
* accuracy: 48.4%
* error: 51.6%
* macro_f1: 37.6%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,639
* accuracy: 37.4%
* error: 62.6%
* macro_f1: 18.2%
******* Domain 2 best val acc:      48.4%, epoch: 5 *******
******* Domain 2 best val test acc: 37.4%, epoch: 5 *******
******* Domain 2 best test acc:     41.5%, epoch: 4 *******
epoch [6/50] batch [20/319] time 0.100 (0.135) data 0.000 (0.029) loss 1.9973 (1.7097) ce_loss 1.6934 (1.3667) teacher_loss 1.3585 (1.0832) loss_zs_kd 0.2473 (0.2455) loss_oracle 0.5151 (0.5038) acc 31.2500 (49.2188) kd_loss 0.6569 (0.7080) lr 1.9686e-03 eta 0:32:15
epoch [6/50] batch [40/319] time 0.106 (0.120) data 0.000 (0.015) loss 1.8025 (1.6977) ce_loss 1.4814 (1.3432) teacher_loss 1.1365 (1.0731) loss_zs_kd 0.2539 (0.2449) loss_oracle 0.5390 (0.5022) acc 46.8750 (49.4531) kd_loss 0.6878 (0.6964) lr 1.9686e-03 eta 0:28:32
epoch [6/50] batch [60/319] time 0.107 (0.114) data 0.000 (0.010) loss 1.8033 (1.7156) ce_loss 1.4531 (1.3525) teacher_loss 1.2476 (1.0995) loss_zs_kd 0.2242 (0.2408) loss_oracle 0.4435 (0.4957) acc 37.5000 (49.2188) kd_loss 0.7080 (0.6952) lr 1.9686e-03 eta 0:27:10
epoch [6/50] batch [80/319] time 0.110 (0.111) data 0.000 (0.008) loss 1.8384 (1.7204) ce_loss 1.4102 (1.3587) teacher_loss 1.2691 (1.1118) loss_zs_kd 0.2271 (0.2364) loss_oracle 0.4557 (0.4904) acc 50.0000 (48.4766) kd_loss 0.6688 (0.6920) lr 1.9686e-03 eta 0:26:21
epoch [6/50] batch [100/319] time 0.099 (0.108) data 0.000 (0.006) loss 1.6355 (1.7371) ce_loss 1.2402 (1.3813) teacher_loss 1.0282 (1.1351) loss_zs_kd 0.2028 (0.2285) loss_oracle 0.5059 (0.4878) acc 59.3750 (47.6562) kd_loss 0.7081 (0.6916) lr 1.9686e-03 eta 0:25:43
epoch [6/50] batch [120/319] time 0.109 (0.108) data 0.000 (0.005) loss 1.8256 (1.7295) ce_loss 1.3760 (1.3797) teacher_loss 1.2256 (1.1337) loss_zs_kd 0.2506 (0.2264) loss_oracle 0.4747 (0.4826) acc 53.1250 (47.7344) kd_loss 0.6515 (0.6878) lr 1.9686e-03 eta 0:25:31
epoch [6/50] batch [140/319] time 0.097 (0.107) data 0.000 (0.004) loss 1.7877 (1.7270) ce_loss 1.3936 (1.3763) teacher_loss 1.2374 (1.1309) loss_zs_kd 0.2132 (0.2243) loss_oracle 0.4438 (0.4840) acc 46.8750 (48.2143) kd_loss 0.6725 (0.6869) lr 1.9686e-03 eta 0:25:15
epoch [6/50] batch [160/319] time 0.091 (0.106) data 0.000 (0.004) loss 1.5015 (1.7293) ce_loss 1.2432 (1.3762) teacher_loss 0.9778 (1.1334) loss_zs_kd 0.1558 (0.2242) loss_oracle 0.4458 (0.4838) acc 53.1250 (48.1836) kd_loss 0.6793 (0.6836) lr 1.9686e-03 eta 0:25:07
epoch [6/50] batch [180/319] time 0.103 (0.105) data 0.000 (0.003) loss 1.8424 (1.7298) ce_loss 1.4795 (1.3813) teacher_loss 1.3336 (1.1380) loss_zs_kd 0.2257 (0.2235) loss_oracle 0.3960 (0.4801) acc 50.0000 (48.0382) kd_loss 0.6178 (0.6824) lr 1.9686e-03 eta 0:24:54
epoch [6/50] batch [200/319] time 0.092 (0.105) data 0.000 (0.003) loss 1.5473 (1.7222) ce_loss 1.2480 (1.3764) teacher_loss 0.9964 (1.1364) loss_zs_kd 0.2135 (0.2213) loss_oracle 0.4441 (0.4752) acc 53.1250 (48.3750) kd_loss 0.6715 (0.6799) lr 1.9686e-03 eta 0:24:43
epoch [6/50] batch [220/319] time 0.101 (0.104) data 0.000 (0.003) loss 1.6504 (1.7167) ce_loss 1.2764 (1.3756) teacher_loss 1.1407 (1.1335) loss_zs_kd 0.2199 (0.2217) loss_oracle 0.3997 (0.4723) acc 53.1250 (48.2102) kd_loss 0.6150 (0.6795) lr 1.9686e-03 eta 0:24:36
epoch [6/50] batch [240/319] time 0.113 (0.104) data 0.000 (0.003) loss 1.8288 (1.7139) ce_loss 1.5283 (1.3796) teacher_loss 1.3137 (1.1360) loss_zs_kd 0.2489 (0.2219) loss_oracle 0.3907 (0.4669) acc 53.1250 (48.0729) kd_loss 0.6476 (0.6782) lr 1.9686e-03 eta 0:24:32
epoch [6/50] batch [260/319] time 0.101 (0.104) data 0.000 (0.002) loss 1.5428 (1.7109) ce_loss 1.2188 (1.3813) teacher_loss 0.9904 (1.1353) loss_zs_kd 0.2482 (0.2243) loss_oracle 0.4283 (0.4634) acc 50.0000 (47.9207) kd_loss 0.6900 (0.6774) lr 1.9686e-03 eta 0:24:28
epoch [6/50] batch [280/319] time 0.111 (0.104) data 0.000 (0.002) loss 1.5692 (1.7066) ce_loss 1.2832 (1.3791) teacher_loss 1.0212 (1.1309) loss_zs_kd 0.2311 (0.2282) loss_oracle 0.4325 (0.4616) acc 50.0000 (47.9129) kd_loss 0.7376 (0.6795) lr 1.9686e-03 eta 0:24:19
epoch [6/50] batch [300/319] time 0.093 (0.104) data 0.000 (0.002) loss 1.6344 (1.7041) ce_loss 1.4512 (1.3786) teacher_loss 1.0534 (1.1304) loss_zs_kd 0.2819 (0.2295) loss_oracle 0.4399 (0.4590) acc 46.8750 (48.0000) kd_loss 0.7733 (0.6809) lr 1.9686e-03 eta 0:24:17
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,227
* accuracy: 50.9%
* error: 49.1%
* macro_f1: 40.9%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,167
* accuracy: 42.8%
* error: 57.2%
* macro_f1: 17.6%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     42.8%, epoch: 6 *******
epoch [7/50] batch [20/319] time 0.167 (0.138) data 0.000 (0.034) loss 1.4040 (1.5841) ce_loss 1.0449 (1.2801) teacher_loss 0.7870 (1.0079) loss_zs_kd 0.3078 (0.3045) loss_oracle 0.4632 (0.4239) acc 59.3750 (50.9375) kd_loss 0.7649 (0.7579) lr 1.9511e-03 eta 0:32:20
epoch [7/50] batch [40/319] time 0.087 (0.121) data 0.000 (0.017) loss 1.8495 (1.6064) ce_loss 1.6074 (1.3152) teacher_loss 1.2523 (1.0184) loss_zs_kd 0.3373 (0.3178) loss_oracle 0.4286 (0.4292) acc 46.8750 (49.5312) kd_loss 0.8804 (0.7834) lr 1.9511e-03 eta 0:28:11
epoch [7/50] batch [60/319] time 0.080 (0.119) data 0.000 (0.012) loss 1.6306 (1.5858) ce_loss 1.3105 (1.3041) teacher_loss 1.0543 (0.9954) loss_zs_kd 0.3131 (0.3195) loss_oracle 0.4197 (0.4305) acc 53.1250 (50.5208) kd_loss 0.9170 (0.8098) lr 1.9511e-03 eta 0:27:40
epoch [7/50] batch [80/319] time 0.085 (0.113) data 0.000 (0.009) loss 1.5168 (1.5856) ce_loss 1.1553 (1.3212) teacher_loss 0.9555 (0.9906) loss_zs_kd 0.3589 (0.3259) loss_oracle 0.3818 (0.4320) acc 62.5000 (50.3516) kd_loss 0.7464 (0.8237) lr 1.9511e-03 eta 0:26:19
epoch [7/50] batch [100/319] time 0.106 (0.111) data 0.000 (0.007) loss 1.4474 (1.5871) ce_loss 1.3711 (1.3419) teacher_loss 0.8246 (0.9890) loss_zs_kd 0.3863 (0.3304) loss_oracle 0.4297 (0.4329) acc 50.0000 (49.5000) kd_loss 0.8880 (0.8255) lr 1.9511e-03 eta 0:25:48
epoch [7/50] batch [120/319] time 0.101 (0.110) data 0.000 (0.006) loss 1.7720 (1.5849) ce_loss 1.7686 (1.3477) teacher_loss 1.1136 (0.9798) loss_zs_kd 0.3498 (0.3385) loss_oracle 0.4835 (0.4359) acc 43.7500 (49.4792) kd_loss 0.8520 (0.8295) lr 1.9511e-03 eta 0:25:26
epoch [7/50] batch [140/319] time 0.106 (0.109) data 0.000 (0.005) loss 1.5219 (1.5796) ce_loss 1.3027 (1.3550) teacher_loss 0.8525 (0.9661) loss_zs_kd 0.3373 (0.3438) loss_oracle 0.5008 (0.4416) acc 46.8750 (49.0625) kd_loss 0.9116 (0.8379) lr 1.9511e-03 eta 0:25:14
epoch [7/50] batch [160/319] time 0.100 (0.108) data 0.000 (0.005) loss 1.4287 (1.5782) ce_loss 1.1855 (1.3554) teacher_loss 0.7803 (0.9587) loss_zs_kd 0.3240 (0.3462) loss_oracle 0.4864 (0.4464) acc 43.7500 (49.0039) kd_loss 0.8225 (0.8418) lr 1.9511e-03 eta 0:25:05
epoch [7/50] batch [180/319] time 0.102 (0.108) data 0.000 (0.004) loss 1.5621 (1.5824) ce_loss 1.4229 (1.3653) teacher_loss 0.9070 (0.9572) loss_zs_kd 0.3829 (0.3485) loss_oracle 0.4636 (0.4510) acc 46.8750 (48.6458) kd_loss 0.8836 (0.8469) lr 1.9511e-03 eta 0:24:57
epoch [7/50] batch [200/319] time 0.098 (0.108) data 0.000 (0.004) loss 1.9258 (1.5768) ce_loss 1.6055 (1.3621) teacher_loss 1.2351 (0.9493) loss_zs_kd 0.4441 (0.3498) loss_oracle 0.4687 (0.4526) acc 43.7500 (48.6562) kd_loss 0.7910 (0.8490) lr 1.9511e-03 eta 0:24:51
epoch [7/50] batch [220/319] time 0.109 (0.107) data 0.000 (0.003) loss 1.6895 (1.5707) ce_loss 1.3594 (1.3552) teacher_loss 0.9729 (0.9371) loss_zs_kd 0.3462 (0.3513) loss_oracle 0.5435 (0.4580) acc 43.7500 (49.0483) kd_loss 0.9224 (0.8554) lr 1.9511e-03 eta 0:24:44
epoch [7/50] batch [240/319] time 0.093 (0.107) data 0.000 (0.003) loss 1.6514 (1.5725) ce_loss 1.5312 (1.3574) teacher_loss 0.9782 (0.9328) loss_zs_kd 0.3660 (0.3537) loss_oracle 0.4902 (0.4629) acc 46.8750 (49.0495) kd_loss 0.8547 (0.8609) lr 1.9511e-03 eta 0:24:37
epoch [7/50] batch [260/319] time 0.101 (0.107) data 0.000 (0.003) loss 1.5439 (1.5782) ce_loss 1.3457 (1.3639) teacher_loss 0.8972 (0.9373) loss_zs_kd 0.3015 (0.3518) loss_oracle 0.4960 (0.4650) acc 56.2500 (49.0745) kd_loss 0.9651 (0.8670) lr 1.9511e-03 eta 0:24:33
epoch [7/50] batch [280/319] time 0.097 (0.107) data 0.000 (0.003) loss 1.5519 (1.5803) ce_loss 1.3564 (1.3642) teacher_loss 0.9297 (0.9388) loss_zs_kd 0.3089 (0.3502) loss_oracle 0.4678 (0.4664) acc 68.7500 (49.0625) kd_loss 0.9999 (0.8717) lr 1.9511e-03 eta 0:24:28
epoch [7/50] batch [300/319] time 0.099 (0.107) data 0.000 (0.003) loss 1.6510 (1.5831) ce_loss 1.7510 (1.3654) teacher_loss 0.9761 (0.9401) loss_zs_kd 0.3575 (0.3486) loss_oracle 0.4961 (0.4687) acc 25.0000 (48.9688) kd_loss 0.8804 (0.8758) lr 1.9511e-03 eta 0:24:24
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,145
* accuracy: 49.0%
* error: 51.0%
* macro_f1: 37.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,815
* accuracy: 39.2%
* error: 60.8%
* macro_f1: 15.4%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     42.8%, epoch: 6 *******
epoch [8/50] batch [20/319] time 0.082 (0.147) data 0.000 (0.033) loss 1.9421 (1.6701) ce_loss 1.6143 (1.4625) teacher_loss 1.3133 (1.0161) loss_zs_kd 0.3185 (0.3152) loss_oracle 0.4696 (0.4964) acc 37.5000 (44.3750) kd_loss 0.9457 (0.9545) lr 1.9298e-03 eta 0:33:33
epoch [8/50] batch [40/319] time 0.115 (0.126) data 0.000 (0.017) loss 1.3538 (1.6337) ce_loss 1.2822 (1.4316) teacher_loss 0.6312 (0.9684) loss_zs_kd 0.3249 (0.3251) loss_oracle 0.5602 (0.5027) acc 46.8750 (46.8750) kd_loss 0.8544 (0.9508) lr 1.9298e-03 eta 0:28:49
epoch [8/50] batch [60/319] time 0.071 (0.112) data 0.000 (0.011) loss 1.6544 (1.6063) ce_loss 1.4219 (1.4046) teacher_loss 0.9808 (0.9437) loss_zs_kd 0.3471 (0.3285) loss_oracle 0.5001 (0.4983) acc 40.6250 (47.7604) kd_loss 0.9090 (0.9429) lr 1.9298e-03 eta 0:25:32
epoch [8/50] batch [80/319] time 0.090 (0.105) data 0.000 (0.009) loss 1.6561 (1.5868) ce_loss 1.4014 (1.3906) teacher_loss 1.0204 (0.9263) loss_zs_kd 0.2931 (0.3249) loss_oracle 0.4891 (0.4981) acc 46.8750 (47.9688) kd_loss 0.8720 (0.9306) lr 1.9298e-03 eta 0:23:53
epoch [8/50] batch [100/319] time 0.161 (0.106) data 0.000 (0.007) loss 1.3855 (1.5926) ce_loss 1.3145 (1.4044) teacher_loss 0.8163 (0.9349) loss_zs_kd 0.3592 (0.3259) loss_oracle 0.3897 (0.4947) acc 53.1250 (47.6875) kd_loss 0.8411 (0.9262) lr 1.9298e-03 eta 0:24:00
epoch [8/50] batch [120/319] time 0.087 (0.108) data 0.000 (0.006) loss 1.7737 (1.5846) ce_loss 1.6572 (1.3972) teacher_loss 1.0471 (0.9246) loss_zs_kd 0.4260 (0.3295) loss_oracle 0.5136 (0.4952) acc 34.3750 (47.8646) kd_loss 0.8623 (0.9184) lr 1.9298e-03 eta 0:24:29
epoch [8/50] batch [140/319] time 0.068 (0.109) data 0.000 (0.005) loss 1.5851 (1.5888) ce_loss 1.6221 (1.3986) teacher_loss 0.8913 (0.9293) loss_zs_kd 0.3536 (0.3307) loss_oracle 0.5170 (0.4942) acc 37.5000 (47.9464) kd_loss 0.9396 (0.9098) lr 1.9298e-03 eta 0:24:36
epoch [8/50] batch [160/319] time 0.099 (0.107) data 0.000 (0.004) loss 1.7009 (1.5908) ce_loss 1.5332 (1.4026) teacher_loss 0.9536 (0.9335) loss_zs_kd 0.3576 (0.3297) loss_oracle 0.5685 (0.4925) acc 34.3750 (47.8906) kd_loss 0.9936 (0.9066) lr 1.9298e-03 eta 0:24:07
epoch [8/50] batch [180/319] time 0.112 (0.106) data 0.000 (0.004) loss 1.6418 (1.5973) ce_loss 1.5049 (1.4060) teacher_loss 1.0688 (0.9422) loss_zs_kd 0.3088 (0.3307) loss_oracle 0.4187 (0.4898) acc 50.0000 (47.7257) kd_loss 0.8853 (0.9067) lr 1.9298e-03 eta 0:23:57
epoch [8/50] batch [200/319] time 0.111 (0.106) data 0.000 (0.004) loss 1.6131 (1.5900) ce_loss 1.5596 (1.4007) teacher_loss 0.9338 (0.9386) loss_zs_kd 0.3855 (0.3276) loss_oracle 0.4866 (0.4875) acc 37.5000 (47.6406) kd_loss 0.8481 (0.9048) lr 1.9298e-03 eta 0:23:48
epoch [8/50] batch [220/319] time 0.106 (0.105) data 0.000 (0.003) loss 1.4459 (1.5919) ce_loss 1.1592 (1.4012) teacher_loss 0.7280 (0.9401) loss_zs_kd 0.3306 (0.3285) loss_oracle 0.5526 (0.4875) acc 62.5000 (47.6989) kd_loss 0.9477 (0.9009) lr 1.9298e-03 eta 0:23:42
epoch [8/50] batch [240/319] time 0.109 (0.105) data 0.000 (0.003) loss 1.7088 (1.5881) ce_loss 1.5371 (1.3963) teacher_loss 1.0302 (0.9381) loss_zs_kd 0.3015 (0.3275) loss_oracle 0.5278 (0.4862) acc 40.6250 (47.8255) kd_loss 0.9055 (0.8969) lr 1.9298e-03 eta 0:23:37
epoch [8/50] batch [260/319] time 0.102 (0.105) data 0.000 (0.003) loss 1.8850 (1.5874) ce_loss 1.6074 (1.3952) teacher_loss 1.1773 (0.9372) loss_zs_kd 0.4027 (0.3285) loss_oracle 0.5063 (0.4859) acc 37.5000 (47.9207) kd_loss 0.8676 (0.8952) lr 1.9298e-03 eta 0:23:32
epoch [8/50] batch [280/319] time 0.102 (0.105) data 0.000 (0.003) loss 1.6294 (1.5838) ce_loss 1.4102 (1.3900) teacher_loss 1.0346 (0.9347) loss_zs_kd 0.2660 (0.3288) loss_oracle 0.4618 (0.4847) acc 43.7500 (47.9464) kd_loss 0.7178 (0.8911) lr 1.9298e-03 eta 0:23:28
epoch [8/50] batch [300/319] time 0.100 (0.105) data 0.000 (0.002) loss 1.7057 (1.5880) ce_loss 1.5977 (1.3965) teacher_loss 1.0030 (0.9391) loss_zs_kd 0.3013 (0.3292) loss_oracle 0.5520 (0.4844) acc 37.5000 (47.7708) kd_loss 0.8555 (0.8887) lr 1.9298e-03 eta 0:23:25
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,121
* accuracy: 48.4%
* error: 51.6%
* macro_f1: 36.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,809
* accuracy: 39.1%
* error: 60.9%
* macro_f1: 16.0%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     42.8%, epoch: 6 *******
epoch [9/50] batch [20/319] time 0.102 (0.130) data 0.000 (0.025) loss 1.5220 (1.5607) ce_loss 1.2627 (1.3547) teacher_loss 0.9657 (0.9373) loss_zs_kd 0.2978 (0.3306) loss_oracle 0.4074 (0.4581) acc 46.8750 (47.6562) kd_loss 0.7302 (0.8193) lr 1.9048e-03 eta 0:28:55
epoch [9/50] batch [40/319] time 0.075 (0.113) data 0.000 (0.013) loss 1.6125 (1.5485) ce_loss 1.1807 (1.3391) teacher_loss 0.9908 (0.9211) loss_zs_kd 0.3447 (0.3242) loss_oracle 0.4493 (0.4652) acc 59.3750 (49.2969) kd_loss 0.7130 (0.8070) lr 1.9048e-03 eta 0:25:03
epoch [9/50] batch [60/319] time 0.181 (0.106) data 0.000 (0.008) loss 1.5958 (1.5603) ce_loss 1.4775 (1.3689) teacher_loss 1.0258 (0.9314) loss_zs_kd 0.3683 (0.3262) loss_oracle 0.3858 (0.4658) acc 43.7500 (48.2812) kd_loss 0.8230 (0.8091) lr 1.9048e-03 eta 0:23:38
epoch [9/50] batch [80/319] time 0.091 (0.107) data 0.000 (0.006) loss 1.6671 (1.5736) ce_loss 1.2646 (1.3832) teacher_loss 1.0921 (0.9438) loss_zs_kd 0.2978 (0.3268) loss_oracle 0.4260 (0.4664) acc 59.3750 (48.0078) kd_loss 0.8099 (0.8066) lr 1.9048e-03 eta 0:23:41
epoch [9/50] batch [100/319] time 0.081 (0.107) data 0.000 (0.005) loss 1.6853 (1.5720) ce_loss 1.5693 (1.3800) teacher_loss 1.0442 (0.9412) loss_zs_kd 0.2959 (0.3239) loss_oracle 0.4932 (0.4688) acc 46.8750 (48.5938) kd_loss 0.7689 (0.8027) lr 1.9048e-03 eta 0:23:37
epoch [9/50] batch [120/319] time 0.172 (0.108) data 0.000 (0.004) loss 1.5823 (1.5784) ce_loss 1.6201 (1.3952) teacher_loss 0.8347 (0.9449) loss_zs_kd 0.3023 (0.3243) loss_oracle 0.5964 (0.4713) acc 40.6250 (48.0469) kd_loss 0.9189 (0.8044) lr 1.9048e-03 eta 0:24:00
epoch [9/50] batch [140/319] time 0.082 (0.107) data 0.000 (0.004) loss 1.8882 (1.5854) ce_loss 1.7354 (1.4053) teacher_loss 1.2845 (0.9477) loss_zs_kd 0.3668 (0.3269) loss_oracle 0.4202 (0.4742) acc 34.3750 (47.6786) kd_loss 0.7952 (0.8047) lr 1.9048e-03 eta 0:23:37
epoch [9/50] batch [160/319] time 0.175 (0.106) data 0.000 (0.003) loss 1.5831 (1.5800) ce_loss 1.5332 (1.4000) teacher_loss 0.8666 (0.9394) loss_zs_kd 0.3551 (0.3321) loss_oracle 0.5390 (0.4745) acc 43.7500 (47.9688) kd_loss 0.8879 (0.8068) lr 1.9048e-03 eta 0:23:17
epoch [9/50] batch [180/319] time 0.176 (0.106) data 0.000 (0.003) loss 1.5582 (1.5751) ce_loss 1.4951 (1.3972) teacher_loss 0.9948 (0.9344) loss_zs_kd 0.3845 (0.3351) loss_oracle 0.3711 (0.4731) acc 46.8750 (47.9514) kd_loss 0.8122 (0.8088) lr 1.9048e-03 eta 0:23:16
epoch [9/50] batch [200/319] time 0.165 (0.106) data 0.000 (0.003) loss 1.4876 (1.5738) ce_loss 1.3105 (1.3962) teacher_loss 0.9029 (0.9339) loss_zs_kd 0.2827 (0.3359) loss_oracle 0.4434 (0.4720) acc 46.8750 (48.1406) kd_loss 0.8031 (0.8085) lr 1.9048e-03 eta 0:23:23
epoch [9/50] batch [220/319] time 0.072 (0.105) data 0.000 (0.003) loss 1.4489 (1.5715) ce_loss 1.1016 (1.3941) teacher_loss 0.9060 (0.9307) loss_zs_kd 0.3041 (0.3361) loss_oracle 0.3908 (0.4728) acc 56.2500 (48.2812) kd_loss 0.8088 (0.8084) lr 1.9048e-03 eta 0:23:02
epoch [9/50] batch [240/319] time 0.105 (0.104) data 0.000 (0.002) loss 1.6695 (1.5682) ce_loss 1.3633 (1.3886) teacher_loss 0.9285 (0.9262) loss_zs_kd 0.3897 (0.3359) loss_oracle 0.5462 (0.4740) acc 50.0000 (48.4375) kd_loss 0.8469 (0.8075) lr 1.9048e-03 eta 0:22:44
epoch [9/50] batch [260/319] time 0.100 (0.104) data 0.000 (0.002) loss 1.7000 (1.5660) ce_loss 1.4170 (1.3879) teacher_loss 1.0529 (0.9232) loss_zs_kd 0.3541 (0.3369) loss_oracle 0.4701 (0.4743) acc 50.0000 (48.4255) kd_loss 0.8735 (0.8089) lr 1.9048e-03 eta 0:22:41
epoch [9/50] batch [280/319] time 0.113 (0.103) data 0.000 (0.002) loss 1.4265 (1.5692) ce_loss 1.2246 (1.3945) teacher_loss 0.7978 (0.9265) loss_zs_kd 0.3861 (0.3385) loss_oracle 0.4357 (0.4735) acc 53.1250 (48.3371) kd_loss 0.8721 (0.8132) lr 1.9048e-03 eta 0:22:30
epoch [9/50] batch [300/319] time 0.103 (0.103) data 0.000 (0.002) loss 1.6937 (1.5669) ce_loss 1.7168 (1.3951) teacher_loss 0.9911 (0.9230) loss_zs_kd 0.3589 (0.3399) loss_oracle 0.5231 (0.4739) acc 43.7500 (48.2500) kd_loss 0.8876 (0.8169) lr 1.9048e-03 eta 0:22:29
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,218
* accuracy: 50.7%
* error: 49.3%
* macro_f1: 38.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,059
* accuracy: 41.7%
* error: 58.3%
* macro_f1: 16.1%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     42.8%, epoch: 6 *******
epoch [10/50] batch [20/319] time 0.097 (0.138) data 0.000 (0.033) loss 1.6813 (1.5232) ce_loss 1.6787 (1.4083) teacher_loss 0.9808 (0.8737) loss_zs_kd 0.4068 (0.3773) loss_oracle 0.4972 (0.4608) acc 37.5000 (47.3438) kd_loss 1.0277 (0.8949) lr 1.8763e-03 eta 0:29:57
epoch [10/50] batch [40/319] time 0.101 (0.121) data 0.000 (0.017) loss 1.5553 (1.5331) ce_loss 1.4941 (1.4047) teacher_loss 0.9626 (0.8789) loss_zs_kd 0.3412 (0.3729) loss_oracle 0.4221 (0.4677) acc 46.8750 (47.1875) kd_loss 0.9562 (0.9174) lr 1.8763e-03 eta 0:26:14
epoch [10/50] batch [60/319] time 0.102 (0.115) data 0.000 (0.011) loss 1.6270 (1.5286) ce_loss 1.6279 (1.3913) teacher_loss 0.9521 (0.8677) loss_zs_kd 0.3737 (0.3718) loss_oracle 0.4881 (0.4750) acc 46.8750 (48.0729) kd_loss 0.8992 (0.9219) lr 1.8763e-03 eta 0:25:00
epoch [10/50] batch [80/319] time 0.075 (0.110) data 0.000 (0.009) loss 1.3941 (1.5225) ce_loss 1.0898 (1.3810) teacher_loss 0.7534 (0.8675) loss_zs_kd 0.3377 (0.3691) loss_oracle 0.4719 (0.4704) acc 68.7500 (48.6719) kd_loss 0.9665 (0.9218) lr 1.8763e-03 eta 0:23:43
epoch [10/50] batch [100/319] time 0.073 (0.107) data 0.000 (0.007) loss 1.3394 (1.5321) ce_loss 0.9961 (1.3901) teacher_loss 0.6971 (0.8735) loss_zs_kd 0.3506 (0.3706) loss_oracle 0.4671 (0.4733) acc 65.6250 (48.2812) kd_loss 0.9764 (0.9287) lr 1.8763e-03 eta 0:23:08
epoch [10/50] batch [120/319] time 0.069 (0.108) data 0.000 (0.006) loss 1.4759 (1.5285) ce_loss 1.2930 (1.3875) teacher_loss 0.7889 (0.8664) loss_zs_kd 0.4162 (0.3770) loss_oracle 0.4790 (0.4735) acc 50.0000 (48.3594) kd_loss 0.9893 (0.9344) lr 1.8763e-03 eta 0:23:17
epoch [10/50] batch [140/319] time 0.072 (0.109) data 0.000 (0.005) loss 1.3816 (1.5217) ce_loss 1.2803 (1.3751) teacher_loss 0.6668 (0.8522) loss_zs_kd 0.4401 (0.3818) loss_oracle 0.4947 (0.4786) acc 46.8750 (48.8616) kd_loss 0.9005 (0.9447) lr 1.8763e-03 eta 0:23:31
epoch [10/50] batch [160/319] time 0.066 (0.109) data 0.000 (0.004) loss 1.6415 (1.5155) ce_loss 1.5850 (1.3678) teacher_loss 0.9558 (0.8450) loss_zs_kd 0.3885 (0.3824) loss_oracle 0.4915 (0.4794) acc 34.3750 (49.1797) kd_loss 1.0090 (0.9490) lr 1.8763e-03 eta 0:23:30
epoch [10/50] batch [180/319] time 0.082 (0.106) data 0.000 (0.004) loss 1.4628 (1.5221) ce_loss 1.1895 (1.3750) teacher_loss 0.9108 (0.8495) loss_zs_kd 0.3599 (0.3861) loss_oracle 0.3720 (0.4796) acc 53.1250 (49.0278) kd_loss 1.0400 (0.9543) lr 1.8763e-03 eta 0:22:49
epoch [10/50] batch [200/319] time 0.075 (0.106) data 0.000 (0.004) loss 1.2630 (1.5197) ce_loss 0.9263 (1.3738) teacher_loss 0.5565 (0.8442) loss_zs_kd 0.3969 (0.3874) loss_oracle 0.5081 (0.4818) acc 75.0000 (49.1250) kd_loss 1.0327 (0.9589) lr 1.8763e-03 eta 0:22:47
epoch [10/50] batch [220/319] time 0.146 (0.107) data 0.000 (0.003) loss 1.2761 (1.5230) ce_loss 1.2070 (1.3756) teacher_loss 0.6427 (0.8444) loss_zs_kd 0.3646 (0.3879) loss_oracle 0.4510 (0.4846) acc 43.7500 (48.9205) kd_loss 1.0114 (0.9634) lr 1.8763e-03 eta 0:22:58
epoch [10/50] batch [240/319] time 0.094 (0.108) data 0.000 (0.003) loss 1.6148 (1.5271) ce_loss 1.3662 (1.3831) teacher_loss 0.9585 (0.8493) loss_zs_kd 0.3637 (0.3884) loss_oracle 0.4744 (0.4837) acc 56.2500 (48.6198) kd_loss 0.9958 (0.9657) lr 1.8763e-03 eta 0:23:05
epoch [10/50] batch [260/319] time 0.106 (0.107) data 0.000 (0.003) loss 1.5251 (1.5271) ce_loss 1.4834 (1.3857) teacher_loss 0.7833 (0.8514) loss_zs_kd 0.4112 (0.3882) loss_oracle 0.5361 (0.4815) acc 50.0000 (48.4495) kd_loss 0.9917 (0.9674) lr 1.8763e-03 eta 0:22:48
epoch [10/50] batch [280/319] time 0.099 (0.107) data 0.000 (0.003) loss 1.5872 (1.5241) ce_loss 1.5596 (1.3841) teacher_loss 0.8172 (0.8511) loss_zs_kd 0.3968 (0.3871) loss_oracle 0.5716 (0.4794) acc 43.7500 (48.3929) kd_loss 0.9497 (0.9683) lr 1.8763e-03 eta 0:22:45
epoch [10/50] batch [300/319] time 0.105 (0.107) data 0.000 (0.003) loss 1.7474 (1.5237) ce_loss 1.6582 (1.3832) teacher_loss 1.0604 (0.8513) loss_zs_kd 0.3755 (0.3867) loss_oracle 0.4992 (0.4791) acc 37.5000 (48.3229) kd_loss 0.9766 (0.9665) lr 1.8763e-03 eta 0:22:41
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,099
* accuracy: 47.9%
* error: 52.1%
* macro_f1: 39.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,439
* accuracy: 45.6%
* error: 54.4%
* macro_f1: 17.3%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [11/50] batch [20/319] time 0.096 (0.136) data 0.000 (0.033) loss 1.3543 (1.4747) ce_loss 1.3643 (1.3522) teacher_loss 0.7766 (0.8074) loss_zs_kd 0.3477 (0.3837) loss_oracle 0.4039 (0.4754) acc 46.8750 (47.6562) kd_loss 0.9597 (0.9819) lr 1.8443e-03 eta 0:28:49
epoch [11/50] batch [40/319] time 0.117 (0.120) data 0.000 (0.017) loss 1.3595 (1.4880) ce_loss 1.1133 (1.3661) teacher_loss 0.7480 (0.8098) loss_zs_kd 0.3402 (0.3856) loss_oracle 0.4414 (0.4855) acc 62.5000 (47.3438) kd_loss 0.9149 (0.9722) lr 1.8443e-03 eta 0:25:27
epoch [11/50] batch [60/319] time 0.093 (0.115) data 0.000 (0.011) loss 1.6621 (1.5024) ce_loss 1.5449 (1.3751) teacher_loss 0.9009 (0.8274) loss_zs_kd 0.4628 (0.3900) loss_oracle 0.5298 (0.4801) acc 34.3750 (46.8229) kd_loss 1.0205 (0.9688) lr 1.8443e-03 eta 0:24:17
epoch [11/50] batch [80/319] time 0.117 (0.113) data 0.000 (0.008) loss 1.6892 (1.5001) ce_loss 1.5908 (1.3814) teacher_loss 1.0591 (0.8360) loss_zs_kd 0.4023 (0.3892) loss_oracle 0.4290 (0.4695) acc 43.7500 (47.0312) kd_loss 1.0064 (0.9668) lr 1.8443e-03 eta 0:23:49
epoch [11/50] batch [100/319] time 0.106 (0.111) data 0.000 (0.007) loss 1.3629 (1.5076) ce_loss 1.1631 (1.3888) teacher_loss 0.8049 (0.8474) loss_zs_kd 0.3333 (0.3848) loss_oracle 0.3913 (0.4677) acc 59.3750 (47.3750) kd_loss 0.8891 (0.9651) lr 1.8443e-03 eta 0:23:26
epoch [11/50] batch [120/319] time 0.085 (0.109) data 0.000 (0.006) loss 1.5374 (1.5153) ce_loss 1.3750 (1.3927) teacher_loss 0.8319 (0.8551) loss_zs_kd 0.3508 (0.3844) loss_oracle 0.5301 (0.4680) acc 50.0000 (47.5781) kd_loss 0.9387 (0.9712) lr 1.8443e-03 eta 0:23:00
epoch [11/50] batch [140/319] time 0.144 (0.107) data 0.000 (0.005) loss 1.7654 (1.5203) ce_loss 1.7549 (1.3909) teacher_loss 1.1217 (0.8599) loss_zs_kd 0.4178 (0.3833) loss_oracle 0.4348 (0.4688) acc 28.1250 (47.9688) kd_loss 1.0446 (0.9750) lr 1.8443e-03 eta 0:22:27
epoch [11/50] batch [160/319] time 0.081 (0.107) data 0.000 (0.004) loss 1.1994 (1.5263) ce_loss 1.0713 (1.3944) teacher_loss 0.6539 (0.8681) loss_zs_kd 0.3231 (0.3811) loss_oracle 0.3839 (0.4676) acc 53.1250 (47.6172) kd_loss 1.0525 (0.9777) lr 1.8443e-03 eta 0:22:29
epoch [11/50] batch [180/319] time 0.071 (0.108) data 0.000 (0.004) loss 1.6451 (1.5269) ce_loss 1.4873 (1.3936) teacher_loss 0.9126 (0.8695) loss_zs_kd 0.3336 (0.3796) loss_oracle 0.5657 (0.4677) acc 37.5000 (47.8299) kd_loss 1.1055 (0.9848) lr 1.8443e-03 eta 0:22:34
epoch [11/50] batch [200/319] time 0.078 (0.108) data 0.000 (0.004) loss 1.6060 (1.5244) ce_loss 1.4658 (1.3909) teacher_loss 0.9163 (0.8671) loss_zs_kd 0.3857 (0.3800) loss_oracle 0.4968 (0.4673) acc 40.6250 (48.0156) kd_loss 0.9643 (0.9881) lr 1.8443e-03 eta 0:22:41
epoch [11/50] batch [220/319] time 0.082 (0.108) data 0.000 (0.003) loss 1.6151 (1.5176) ce_loss 1.4512 (1.3859) teacher_loss 0.9963 (0.8633) loss_zs_kd 0.3864 (0.3767) loss_oracle 0.4256 (0.4660) acc 46.8750 (48.1250) kd_loss 0.9173 (0.9919) lr 1.8443e-03 eta 0:22:32
epoch [11/50] batch [240/319] time 0.097 (0.107) data 0.000 (0.003) loss 1.3174 (1.5124) ce_loss 1.2393 (1.3754) teacher_loss 0.7347 (0.8585) loss_zs_kd 0.3581 (0.3751) loss_oracle 0.4036 (0.4664) acc 53.1250 (48.6198) kd_loss 0.9775 (0.9944) lr 1.8443e-03 eta 0:22:21
epoch [11/50] batch [260/319] time 0.164 (0.109) data 0.000 (0.003) loss 1.4730 (1.5138) ce_loss 1.4287 (1.3760) teacher_loss 0.6932 (0.8586) loss_zs_kd 0.4568 (0.3754) loss_oracle 0.5514 (0.4675) acc 37.5000 (48.3774) kd_loss 0.9722 (0.9961) lr 1.8443e-03 eta 0:22:37
epoch [11/50] batch [280/319] time 0.177 (0.109) data 0.000 (0.003) loss 1.6026 (1.5117) ce_loss 1.6240 (1.3728) teacher_loss 1.0189 (0.8588) loss_zs_kd 0.3304 (0.3733) loss_oracle 0.4185 (0.4662) acc 40.6250 (48.4152) kd_loss 1.0151 (0.9964) lr 1.8443e-03 eta 0:22:40
epoch [11/50] batch [300/319] time 0.104 (0.108) data 0.000 (0.002) loss 1.9055 (1.5146) ce_loss 1.7676 (1.3759) teacher_loss 1.3180 (0.8635) loss_zs_kd 0.3667 (0.3713) loss_oracle 0.4042 (0.4655) acc 31.2500 (48.3125) kd_loss 0.9790 (0.9984) lr 1.8443e-03 eta 0:22:27
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,081
* accuracy: 47.5%
* error: 52.5%
* macro_f1: 34.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,642
* accuracy: 37.4%
* error: 62.6%
* macro_f1: 15.1%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [12/50] batch [20/319] time 0.116 (0.146) data 0.000 (0.037) loss 1.3837 (1.4998) ce_loss 1.2598 (1.3859) teacher_loss 0.7821 (0.8755) loss_zs_kd 0.3446 (0.3452) loss_oracle 0.4293 (0.4517) acc 50.0000 (48.4375) kd_loss 0.9414 (1.0089) lr 1.8090e-03 eta 0:30:15
epoch [12/50] batch [40/319] time 0.104 (0.125) data 0.000 (0.019) loss 1.3230 (1.5072) ce_loss 1.1445 (1.4014) teacher_loss 0.6689 (0.8699) loss_zs_kd 0.3876 (0.3562) loss_oracle 0.4603 (0.4591) acc 53.1250 (47.4219) kd_loss 1.0225 (1.0169) lr 1.8090e-03 eta 0:25:45
epoch [12/50] batch [60/319] time 0.107 (0.117) data 0.000 (0.012) loss 1.6419 (1.5324) ce_loss 1.5117 (1.4105) teacher_loss 1.0284 (0.8802) loss_zs_kd 0.3486 (0.3672) loss_oracle 0.4392 (0.4685) acc 53.1250 (47.3958) kd_loss 0.9888 (1.0122) lr 1.8090e-03 eta 0:24:11
epoch [12/50] batch [80/319] time 0.103 (0.113) data 0.000 (0.009) loss 1.2805 (1.5277) ce_loss 1.1709 (1.3984) teacher_loss 0.6975 (0.8708) loss_zs_kd 0.3233 (0.3680) loss_oracle 0.4213 (0.4729) acc 56.2500 (47.1484) kd_loss 0.9953 (1.0096) lr 1.8090e-03 eta 0:23:22
epoch [12/50] batch [100/319] time 0.099 (0.112) data 0.000 (0.008) loss 1.6115 (1.5400) ce_loss 1.5947 (1.4087) teacher_loss 0.8253 (0.8795) loss_zs_kd 0.3848 (0.3639) loss_oracle 0.5938 (0.4785) acc 46.8750 (46.7500) kd_loss 1.0040 (1.0095) lr 1.8090e-03 eta 0:22:58
epoch [12/50] batch [120/319] time 0.088 (0.110) data 0.000 (0.006) loss 1.7065 (1.5456) ce_loss 1.7480 (1.4150) teacher_loss 0.9522 (0.8867) loss_zs_kd 0.3223 (0.3596) loss_oracle 0.5931 (0.4791) acc 31.2500 (46.6667) kd_loss 1.1035 (1.0084) lr 1.8090e-03 eta 0:22:38
epoch [12/50] batch [140/319] time 0.095 (0.109) data 0.000 (0.005) loss 1.6474 (1.5382) ce_loss 1.5078 (1.4033) teacher_loss 0.9157 (0.8798) loss_zs_kd 0.3913 (0.3601) loss_oracle 0.5360 (0.4783) acc 43.7500 (47.2768) kd_loss 0.9979 (1.0048) lr 1.8090e-03 eta 0:22:20
epoch [12/50] batch [160/319] time 0.079 (0.108) data 0.000 (0.005) loss 1.7226 (1.5349) ce_loss 1.4941 (1.4026) teacher_loss 1.0075 (0.8781) loss_zs_kd 0.4220 (0.3590) loss_oracle 0.5040 (0.4773) acc 46.8750 (47.3242) kd_loss 0.9910 (1.0023) lr 1.8090e-03 eta 0:22:02
epoch [12/50] batch [180/319] time 0.090 (0.105) data 0.000 (0.004) loss 1.5195 (1.5369) ce_loss 1.5264 (1.4018) teacher_loss 0.8759 (0.8724) loss_zs_kd 0.3796 (0.3621) loss_oracle 0.4539 (0.4834) acc 31.2500 (47.0833) kd_loss 0.9129 (1.0044) lr 1.8090e-03 eta 0:21:24
epoch [12/50] batch [200/319] time 0.154 (0.106) data 0.000 (0.004) loss 1.6911 (1.5395) ce_loss 1.6621 (1.3995) teacher_loss 0.9710 (0.8739) loss_zs_kd 0.3010 (0.3610) loss_oracle 0.5696 (0.4851) acc 34.3750 (47.3125) kd_loss 0.9778 (1.0027) lr 1.8090e-03 eta 0:21:42
epoch [12/50] batch [220/319] time 0.154 (0.107) data 0.000 (0.004) loss 1.3942 (1.5436) ce_loss 1.1211 (1.3976) teacher_loss 0.7689 (0.8723) loss_zs_kd 0.3063 (0.3631) loss_oracle 0.4722 (0.4898) acc 53.1250 (46.9460) kd_loss 0.9891 (0.9988) lr 1.8090e-03 eta 0:21:44
epoch [12/50] batch [240/319] time 0.161 (0.108) data 0.000 (0.003) loss 1.5595 (1.5460) ce_loss 1.5205 (1.3958) teacher_loss 0.9316 (0.8764) loss_zs_kd 0.3666 (0.3613) loss_oracle 0.4446 (0.4889) acc 46.8750 (47.0833) kd_loss 0.9148 (0.9955) lr 1.8090e-03 eta 0:21:53
epoch [12/50] batch [260/319] time 0.085 (0.106) data 0.000 (0.003) loss 1.4326 (1.5446) ce_loss 1.2998 (1.3909) teacher_loss 0.8161 (0.8754) loss_zs_kd 0.2946 (0.3585) loss_oracle 0.4691 (0.4900) acc 50.0000 (47.1995) kd_loss 0.9050 (0.9943) lr 1.8090e-03 eta 0:21:37
epoch [12/50] batch [280/319] time 0.086 (0.107) data 0.000 (0.003) loss 1.3711 (1.5455) ce_loss 1.2354 (1.3891) teacher_loss 0.7399 (0.8784) loss_zs_kd 0.2929 (0.3549) loss_oracle 0.4848 (0.4896) acc 53.1250 (47.3326) kd_loss 0.9139 (0.9899) lr 1.8090e-03 eta 0:21:35
epoch [12/50] batch [300/319] time 0.154 (0.106) data 0.000 (0.003) loss 1.6170 (1.5449) ce_loss 1.4814 (1.3869) teacher_loss 0.9215 (0.8778) loss_zs_kd 0.4320 (0.3543) loss_oracle 0.4795 (0.4899) acc 50.0000 (47.4479) kd_loss 0.8364 (0.9848) lr 1.8090e-03 eta 0:21:28
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,108
* accuracy: 48.1%
* error: 51.9%
* macro_f1: 36.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,404
* accuracy: 35.0%
* error: 65.0%
* macro_f1: 14.6%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [13/50] batch [20/319] time 0.093 (0.106) data 0.000 (0.023) loss 1.3974 (1.5877) ce_loss 1.2959 (1.4917) teacher_loss 0.7047 (0.8932) loss_zs_kd 0.3765 (0.3624) loss_oracle 0.5045 (0.5133) acc 59.3750 (45.1562) kd_loss 0.9553 (0.9537) lr 1.7705e-03 eta 0:21:26
epoch [13/50] batch [40/319] time 0.108 (0.103) data 0.000 (0.011) loss 1.7998 (1.5270) ce_loss 1.5527 (1.3876) teacher_loss 1.0952 (0.8537) loss_zs_kd 0.3645 (0.3537) loss_oracle 0.5224 (0.4965) acc 46.8750 (48.3594) kd_loss 0.9707 (0.9491) lr 1.7705e-03 eta 0:20:48
epoch [13/50] batch [60/319] time 0.098 (0.103) data 0.000 (0.008) loss 1.8269 (1.5436) ce_loss 1.5996 (1.4056) teacher_loss 1.1471 (0.8786) loss_zs_kd 0.3820 (0.3525) loss_oracle 0.4887 (0.4887) acc 40.6250 (48.2292) kd_loss 0.9851 (0.9473) lr 1.7705e-03 eta 0:20:47
epoch [13/50] batch [80/319] time 0.112 (0.104) data 0.000 (0.006) loss 1.2662 (1.5458) ce_loss 1.2080 (1.4098) teacher_loss 0.7061 (0.8883) loss_zs_kd 0.2931 (0.3548) loss_oracle 0.4136 (0.4802) acc 50.0000 (47.1484) kd_loss 0.8866 (0.9539) lr 1.7705e-03 eta 0:20:46
epoch [13/50] batch [100/319] time 0.101 (0.104) data 0.000 (0.005) loss 1.5296 (1.5346) ce_loss 1.5342 (1.4069) teacher_loss 0.8738 (0.8855) loss_zs_kd 0.3709 (0.3549) loss_oracle 0.4704 (0.4716) acc 37.5000 (47.3438) kd_loss 0.9106 (0.9539) lr 1.7705e-03 eta 0:20:46
epoch [13/50] batch [120/319] time 0.099 (0.104) data 0.000 (0.004) loss 1.4780 (1.5274) ce_loss 1.5088 (1.4025) teacher_loss 0.8523 (0.8801) loss_zs_kd 0.3187 (0.3565) loss_oracle 0.4664 (0.4690) acc 43.7500 (47.7083) kd_loss 0.9700 (0.9575) lr 1.7705e-03 eta 0:20:46
epoch [13/50] batch [140/319] time 0.109 (0.104) data 0.000 (0.003) loss 1.7727 (1.5266) ce_loss 1.5225 (1.4076) teacher_loss 1.2029 (0.8818) loss_zs_kd 0.3788 (0.3548) loss_oracle 0.3804 (0.4674) acc 37.5000 (47.4777) kd_loss 0.9311 (0.9626) lr 1.7705e-03 eta 0:20:45
epoch [13/50] batch [160/319] time 0.114 (0.104) data 0.000 (0.003) loss 1.5575 (1.5243) ce_loss 1.5010 (1.4042) teacher_loss 0.9329 (0.8790) loss_zs_kd 0.4091 (0.3555) loss_oracle 0.4201 (0.4675) acc 46.8750 (47.5000) kd_loss 0.9664 (0.9627) lr 1.7705e-03 eta 0:20:44
epoch [13/50] batch [180/319] time 0.106 (0.104) data 0.000 (0.003) loss 1.3776 (1.5216) ce_loss 1.2744 (1.4064) teacher_loss 0.7599 (0.8798) loss_zs_kd 0.3138 (0.3564) loss_oracle 0.4608 (0.4637) acc 56.2500 (47.3090) kd_loss 1.0147 (0.9599) lr 1.7705e-03 eta 0:20:39
epoch [13/50] batch [200/319] time 0.103 (0.104) data 0.000 (0.003) loss 1.5458 (1.5217) ce_loss 1.5078 (1.4125) teacher_loss 0.9140 (0.8817) loss_zs_kd 0.3621 (0.3582) loss_oracle 0.4507 (0.4610) acc 50.0000 (47.1250) kd_loss 0.9439 (0.9588) lr 1.7705e-03 eta 0:20:36
epoch [13/50] batch [220/319] time 0.093 (0.104) data 0.000 (0.002) loss 1.6261 (1.5177) ce_loss 1.5723 (1.4082) teacher_loss 0.8853 (0.8763) loss_zs_kd 0.3991 (0.3594) loss_oracle 0.5412 (0.4618) acc 34.3750 (47.0739) kd_loss 1.0062 (0.9574) lr 1.7705e-03 eta 0:20:34
epoch [13/50] batch [240/319] time 0.075 (0.103) data 0.001 (0.002) loss 1.4018 (1.5190) ce_loss 1.2969 (1.4095) teacher_loss 0.8351 (0.8766) loss_zs_kd 0.3098 (0.3617) loss_oracle 0.4117 (0.4615) acc 59.3750 (46.8880) kd_loss 0.9521 (0.9577) lr 1.7705e-03 eta 0:20:21
epoch [13/50] batch [260/319] time 0.076 (0.102) data 0.000 (0.002) loss 1.5348 (1.5171) ce_loss 1.3135 (1.4081) teacher_loss 0.9767 (0.8767) loss_zs_kd 0.3963 (0.3618) loss_oracle 0.3599 (0.4595) acc 46.8750 (47.0072) kd_loss 0.9299 (0.9554) lr 1.7705e-03 eta 0:20:14
epoch [13/50] batch [280/319] time 0.082 (0.103) data 0.000 (0.002) loss 1.4061 (1.5150) ce_loss 1.5225 (1.4097) teacher_loss 0.7961 (0.8775) loss_zs_kd 0.3788 (0.3589) loss_oracle 0.4206 (0.4580) acc 28.1250 (46.8527) kd_loss 0.8211 (0.9548) lr 1.7705e-03 eta 0:20:20
epoch [13/50] batch [300/319] time 0.096 (0.103) data 0.000 (0.002) loss 1.4935 (1.5114) ce_loss 1.3047 (1.4079) teacher_loss 0.8909 (0.8738) loss_zs_kd 0.3710 (0.3589) loss_oracle 0.4171 (0.4581) acc 53.1250 (46.8542) kd_loss 0.8665 (0.9507) lr 1.7705e-03 eta 0:20:15
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,027
* accuracy: 46.3%
* error: 53.7%
* macro_f1: 34.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,411
* accuracy: 35.0%
* error: 65.0%
* macro_f1: 14.4%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [14/50] batch [20/319] time 0.102 (0.143) data 0.000 (0.036) loss 1.4525 (1.5148) ce_loss 1.3086 (1.4081) teacher_loss 0.8269 (0.8785) loss_zs_kd 0.3753 (0.3462) loss_oracle 0.4379 (0.4632) acc 50.0000 (46.7188) kd_loss 0.8690 (0.8791) lr 1.7290e-03 eta 0:28:08
epoch [14/50] batch [40/319] time 0.092 (0.124) data 0.000 (0.018) loss 1.3582 (1.5175) ce_loss 1.3125 (1.3994) teacher_loss 0.7692 (0.8868) loss_zs_kd 0.3103 (0.3427) loss_oracle 0.4338 (0.4594) acc 53.1250 (46.6406) kd_loss 0.8174 (0.8706) lr 1.7290e-03 eta 0:24:15
epoch [14/50] batch [60/319] time 0.117 (0.117) data 0.001 (0.012) loss 1.5614 (1.5212) ce_loss 1.3477 (1.4007) teacher_loss 0.9166 (0.8955) loss_zs_kd 0.4409 (0.3430) loss_oracle 0.4244 (0.4541) acc 46.8750 (46.3021) kd_loss 0.8466 (0.8655) lr 1.7290e-03 eta 0:22:57
epoch [14/50] batch [80/319] time 0.103 (0.114) data 0.000 (0.009) loss 1.6517 (1.5228) ce_loss 1.6758 (1.4099) teacher_loss 1.0310 (0.8950) loss_zs_kd 0.3656 (0.3434) loss_oracle 0.4380 (0.4561) acc 40.6250 (46.3672) kd_loss 0.7910 (0.8658) lr 1.7290e-03 eta 0:22:19
epoch [14/50] batch [100/319] time 0.106 (0.112) data 0.000 (0.007) loss 1.4199 (1.5339) ce_loss 1.3281 (1.4202) teacher_loss 0.7624 (0.8988) loss_zs_kd 0.3446 (0.3469) loss_oracle 0.4853 (0.4617) acc 43.7500 (46.0312) kd_loss 0.8896 (0.8681) lr 1.7290e-03 eta 0:21:54
epoch [14/50] batch [120/319] time 0.112 (0.111) data 0.000 (0.006) loss 1.4868 (1.5316) ce_loss 1.1406 (1.4131) teacher_loss 0.8443 (0.8941) loss_zs_kd 0.3508 (0.3501) loss_oracle 0.4671 (0.4624) acc 62.5000 (45.8073) kd_loss 0.9228 (0.8717) lr 1.7290e-03 eta 0:21:40
epoch [14/50] batch [140/319] time 0.105 (0.111) data 0.000 (0.005) loss 1.7615 (1.5305) ce_loss 1.5068 (1.4148) teacher_loss 1.0521 (0.8950) loss_zs_kd 0.3799 (0.3479) loss_oracle 0.5195 (0.4616) acc 46.8750 (45.6473) kd_loss 0.8686 (0.8701) lr 1.7290e-03 eta 0:21:29
epoch [14/50] batch [160/319] time 0.101 (0.110) data 0.000 (0.005) loss 1.6879 (1.5396) ce_loss 1.5859 (1.4263) teacher_loss 1.0824 (0.8988) loss_zs_kd 0.3217 (0.3509) loss_oracle 0.4446 (0.4654) acc 40.6250 (45.5469) kd_loss 0.8452 (0.8714) lr 1.7290e-03 eta 0:21:20
epoch [14/50] batch [180/319] time 0.100 (0.109) data 0.000 (0.004) loss 1.5363 (1.5359) ce_loss 1.3682 (1.4198) teacher_loss 0.9352 (0.8958) loss_zs_kd 0.3476 (0.3528) loss_oracle 0.4273 (0.4638) acc 46.8750 (46.0417) kd_loss 0.8539 (0.8728) lr 1.7290e-03 eta 0:21:12
epoch [14/50] batch [200/319] time 0.120 (0.109) data 0.001 (0.004) loss 1.4012 (1.5307) ce_loss 1.3076 (1.4114) teacher_loss 0.7030 (0.8888) loss_zs_kd 0.4223 (0.3534) loss_oracle 0.4870 (0.4651) acc 50.0000 (46.4844) kd_loss 0.8439 (0.8758) lr 1.7290e-03 eta 0:21:06
epoch [14/50] batch [220/319] time 0.103 (0.109) data 0.000 (0.004) loss 1.4591 (1.5283) ce_loss 1.4473 (1.4079) teacher_loss 0.7989 (0.8862) loss_zs_kd 0.3436 (0.3546) loss_oracle 0.4884 (0.4648) acc 53.1250 (46.8182) kd_loss 0.9007 (0.8765) lr 1.7290e-03 eta 0:21:00
epoch [14/50] batch [240/319] time 0.102 (0.108) data 0.000 (0.003) loss 1.5687 (1.5263) ce_loss 1.5400 (1.4027) teacher_loss 0.8768 (0.8842) loss_zs_kd 0.3868 (0.3549) loss_oracle 0.4985 (0.4647) acc 43.7500 (47.0833) kd_loss 0.9468 (0.8779) lr 1.7290e-03 eta 0:20:54
epoch [14/50] batch [260/319] time 0.093 (0.108) data 0.000 (0.003) loss 1.4690 (1.5249) ce_loss 1.3682 (1.4012) teacher_loss 0.7368 (0.8802) loss_zs_kd 0.3842 (0.3559) loss_oracle 0.5402 (0.4668) acc 50.0000 (47.2236) kd_loss 0.9514 (0.8802) lr 1.7290e-03 eta 0:20:48
epoch [14/50] batch [280/319] time 0.081 (0.107) data 0.000 (0.003) loss 1.4735 (1.5218) ce_loss 1.4150 (1.3981) teacher_loss 0.8338 (0.8764) loss_zs_kd 0.3483 (0.3575) loss_oracle 0.4656 (0.4667) acc 46.8750 (47.2768) kd_loss 0.8530 (0.8819) lr 1.7290e-03 eta 0:20:34
epoch [14/50] batch [300/319] time 0.166 (0.106) data 0.000 (0.003) loss 1.4757 (1.5200) ce_loss 1.3750 (1.3972) teacher_loss 0.9450 (0.8752) loss_zs_kd 0.3541 (0.3564) loss_oracle 0.3536 (0.4666) acc 43.7500 (47.2917) kd_loss 0.7800 (0.8816) lr 1.7290e-03 eta 0:20:23
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,107
* accuracy: 48.1%
* error: 51.9%
* macro_f1: 36.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,812
* accuracy: 39.2%
* error: 60.8%
* macro_f1: 15.4%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [15/50] batch [20/319] time 0.093 (0.126) data 0.000 (0.027) loss 1.6520 (1.5276) ce_loss 1.5859 (1.4310) teacher_loss 1.1007 (0.9050) loss_zs_kd 0.2989 (0.3515) loss_oracle 0.4019 (0.4468) acc 37.5000 (44.8438) kd_loss 0.8541 (0.8625) lr 1.6845e-03 eta 0:24:06
epoch [15/50] batch [40/319] time 0.094 (0.114) data 0.000 (0.014) loss 1.4609 (1.5236) ce_loss 1.3594 (1.4375) teacher_loss 0.8162 (0.8794) loss_zs_kd 0.3102 (0.3597) loss_oracle 0.4897 (0.4644) acc 43.7500 (44.2188) kd_loss 0.8615 (0.8771) lr 1.6845e-03 eta 0:21:39
epoch [15/50] batch [60/319] time 0.100 (0.110) data 0.000 (0.009) loss 1.7092 (1.5144) ce_loss 1.4238 (1.4218) teacher_loss 0.9895 (0.8661) loss_zs_kd 0.4347 (0.3716) loss_oracle 0.5023 (0.4625) acc 40.6250 (45.1042) kd_loss 0.8215 (0.8716) lr 1.6845e-03 eta 0:20:55
epoch [15/50] batch [80/319] time 0.102 (0.108) data 0.000 (0.007) loss 1.3783 (1.5138) ce_loss 1.1729 (1.4095) teacher_loss 0.7564 (0.8638) loss_zs_kd 0.3758 (0.3729) loss_oracle 0.4340 (0.4636) acc 59.3750 (45.8984) kd_loss 0.9254 (0.8765) lr 1.6845e-03 eta 0:20:31
epoch [15/50] batch [100/319] time 0.103 (0.107) data 0.000 (0.006) loss 1.2598 (1.5025) ce_loss 1.1377 (1.4061) teacher_loss 0.6838 (0.8543) loss_zs_kd 0.3477 (0.3750) loss_oracle 0.4021 (0.4606) acc 56.2500 (46.0938) kd_loss 0.8380 (0.8760) lr 1.6845e-03 eta 0:20:19
epoch [15/50] batch [120/319] time 0.109 (0.106) data 0.000 (0.005) loss 1.3927 (1.4982) ce_loss 1.2012 (1.3999) teacher_loss 0.7254 (0.8485) loss_zs_kd 0.3703 (0.3769) loss_oracle 0.4822 (0.4611) acc 56.2500 (46.4583) kd_loss 0.8761 (0.8769) lr 1.6845e-03 eta 0:20:08
epoch [15/50] batch [140/319] time 0.072 (0.106) data 0.000 (0.004) loss 1.6140 (1.4946) ce_loss 1.3965 (1.3963) teacher_loss 0.8530 (0.8457) loss_zs_kd 0.4794 (0.3770) loss_oracle 0.5213 (0.4605) acc 43.7500 (46.5625) kd_loss 1.0124 (0.8767) lr 1.6845e-03 eta 0:20:00
epoch [15/50] batch [160/319] time 0.100 (0.104) data 0.000 (0.004) loss 1.2258 (1.4865) ce_loss 1.0811 (1.3853) teacher_loss 0.6564 (0.8355) loss_zs_kd 0.3709 (0.3791) loss_oracle 0.3840 (0.4615) acc 68.7500 (46.9336) kd_loss 0.8296 (0.8779) lr 1.6845e-03 eta 0:19:34
epoch [15/50] batch [180/319] time 0.105 (0.103) data 0.000 (0.003) loss 1.3746 (1.4745) ce_loss 1.3066 (1.3704) teacher_loss 0.8202 (0.8246) loss_zs_kd 0.2987 (0.3810) loss_oracle 0.4050 (0.4594) acc 50.0000 (47.6042) kd_loss 0.8611 (0.8753) lr 1.6845e-03 eta 0:19:21
epoch [15/50] batch [200/319] time 0.099 (0.103) data 0.000 (0.003) loss 1.6190 (1.4847) ce_loss 1.5205 (1.3789) teacher_loss 1.0449 (0.8367) loss_zs_kd 0.3847 (0.3818) loss_oracle 0.3817 (0.4571) acc 43.7500 (47.5781) kd_loss 0.7782 (0.8747) lr 1.6845e-03 eta 0:19:18
epoch [15/50] batch [220/319] time 0.108 (0.103) data 0.000 (0.003) loss 1.5266 (1.4871) ce_loss 1.4941 (1.3801) teacher_loss 0.8671 (0.8409) loss_zs_kd 0.3600 (0.3824) loss_oracle 0.4795 (0.4550) acc 43.7500 (47.4858) kd_loss 0.9947 (0.8735) lr 1.6845e-03 eta 0:19:16
epoch [15/50] batch [240/319] time 0.098 (0.103) data 0.000 (0.002) loss 1.5334 (1.4868) ce_loss 1.2256 (1.3779) teacher_loss 0.8331 (0.8421) loss_zs_kd 0.4109 (0.3821) loss_oracle 0.4948 (0.4536) acc 46.8750 (47.3568) kd_loss 0.7988 (0.8700) lr 1.6845e-03 eta 0:19:13
epoch [15/50] batch [260/319] time 0.102 (0.103) data 0.000 (0.002) loss 1.4053 (1.4914) ce_loss 1.2686 (1.3822) teacher_loss 0.7652 (0.8477) loss_zs_kd 0.3842 (0.3833) loss_oracle 0.4480 (0.4521) acc 50.0000 (47.2596) kd_loss 0.9121 (0.8686) lr 1.6845e-03 eta 0:19:10
epoch [15/50] batch [280/319] time 0.093 (0.102) data 0.000 (0.002) loss 1.3826 (1.4933) ce_loss 1.3232 (1.3825) teacher_loss 0.7736 (0.8511) loss_zs_kd 0.3759 (0.3833) loss_oracle 0.4210 (0.4506) acc 43.7500 (47.3549) kd_loss 0.8325 (0.8668) lr 1.6845e-03 eta 0:19:05
epoch [15/50] batch [300/319] time 0.112 (0.102) data 0.000 (0.002) loss 1.6064 (1.4881) ce_loss 1.4414 (1.3774) teacher_loss 0.9925 (0.8494) loss_zs_kd 0.3633 (0.3814) loss_oracle 0.4323 (0.4480) acc 43.7500 (47.6979) kd_loss 0.8151 (0.8656) lr 1.6845e-03 eta 0:18:59
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,130
* accuracy: 48.7%
* error: 51.3%
* macro_f1: 38.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,762
* accuracy: 38.6%
* error: 61.4%
* macro_f1: 16.2%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [16/50] batch [20/319] time 0.077 (0.105) data 0.000 (0.022) loss 1.2691 (1.4595) ce_loss 1.0840 (1.3497) teacher_loss 0.6203 (0.8260) loss_zs_kd 0.4048 (0.4073) loss_oracle 0.4464 (0.4298) acc 56.2500 (48.7500) kd_loss 0.8475 (0.8511) lr 1.6374e-03 eta 0:19:30
epoch [16/50] batch [40/319] time 0.088 (0.093) data 0.000 (0.011) loss 1.7131 (1.4589) ce_loss 1.8369 (1.3499) teacher_loss 0.9850 (0.8296) loss_zs_kd 0.3687 (0.3964) loss_oracle 0.5438 (0.4311) acc 37.5000 (50.0000) kd_loss 0.8774 (0.8548) lr 1.6374e-03 eta 0:17:09
epoch [16/50] batch [60/319] time 0.083 (0.090) data 0.000 (0.007) loss 1.1685 (1.4470) ce_loss 1.0752 (1.3493) teacher_loss 0.5026 (0.8088) loss_zs_kd 0.4128 (0.3956) loss_oracle 0.4595 (0.4404) acc 56.2500 (48.9583) kd_loss 0.9078 (0.8623) lr 1.6374e-03 eta 0:16:35
epoch [16/50] batch [80/319] time 0.093 (0.088) data 0.000 (0.006) loss 1.4426 (1.4495) ce_loss 1.3867 (1.3523) teacher_loss 0.7602 (0.8033) loss_zs_kd 0.4432 (0.3982) loss_oracle 0.4608 (0.4471) acc 40.6250 (49.3750) kd_loss 0.8418 (0.8692) lr 1.6374e-03 eta 0:16:12
epoch [16/50] batch [100/319] time 0.083 (0.087) data 0.000 (0.005) loss 1.4591 (1.4569) ce_loss 1.3760 (1.3658) teacher_loss 0.8922 (0.8160) loss_zs_kd 0.3188 (0.3966) loss_oracle 0.4075 (0.4426) acc 50.0000 (48.8750) kd_loss 0.8134 (0.8716) lr 1.6374e-03 eta 0:16:07
epoch [16/50] batch [120/319] time 0.089 (0.087) data 0.000 (0.004) loss 1.4160 (1.4481) ce_loss 1.3770 (1.3535) teacher_loss 0.7840 (0.8097) loss_zs_kd 0.3710 (0.3951) loss_oracle 0.4465 (0.4409) acc 50.0000 (49.4271) kd_loss 0.8559 (0.8708) lr 1.6374e-03 eta 0:16:00
epoch [16/50] batch [140/319] time 0.086 (0.087) data 0.000 (0.003) loss 1.2838 (1.4589) ce_loss 1.1982 (1.3643) teacher_loss 0.5807 (0.8230) loss_zs_kd 0.4648 (0.3914) loss_oracle 0.4707 (0.4402) acc 50.0000 (48.8839) kd_loss 0.8021 (0.8679) lr 1.6374e-03 eta 0:15:56
epoch [16/50] batch [160/319] time 0.081 (0.087) data 0.000 (0.003) loss 1.2713 (1.4666) ce_loss 1.1797 (1.3730) teacher_loss 0.6332 (0.8279) loss_zs_kd 0.4155 (0.3959) loss_oracle 0.4303 (0.4408) acc 56.2500 (48.5547) kd_loss 0.9056 (0.8695) lr 1.6374e-03 eta 0:15:53
epoch [16/50] batch [180/319] time 0.084 (0.087) data 0.000 (0.003) loss 1.3785 (1.4610) ce_loss 1.3086 (1.3650) teacher_loss 0.7502 (0.8213) loss_zs_kd 0.3701 (0.3949) loss_oracle 0.4432 (0.4422) acc 50.0000 (48.9062) kd_loss 0.7928 (0.8709) lr 1.6374e-03 eta 0:15:50
epoch [16/50] batch [200/319] time 0.082 (0.087) data 0.000 (0.002) loss 1.3387 (1.4609) ce_loss 1.2520 (1.3662) teacher_loss 0.7140 (0.8207) loss_zs_kd 0.3535 (0.3943) loss_oracle 0.4480 (0.4430) acc 56.2500 (48.6719) kd_loss 0.8790 (0.8705) lr 1.6374e-03 eta 0:15:48
epoch [16/50] batch [220/319] time 0.091 (0.086) data 0.000 (0.002) loss 1.4061 (1.4620) ce_loss 1.2900 (1.3672) teacher_loss 0.8186 (0.8224) loss_zs_kd 0.3428 (0.3939) loss_oracle 0.4161 (0.4426) acc 50.0000 (48.5938) kd_loss 0.9566 (0.8703) lr 1.6374e-03 eta 0:15:42
epoch [16/50] batch [240/319] time 0.084 (0.085) data 0.000 (0.002) loss 1.4865 (1.4648) ce_loss 1.3799 (1.3694) teacher_loss 0.7358 (0.8216) loss_zs_kd 0.4318 (0.3967) loss_oracle 0.5348 (0.4449) acc 50.0000 (48.4245) kd_loss 0.8292 (0.8704) lr 1.6374e-03 eta 0:15:34
epoch [16/50] batch [260/319] time 0.078 (0.085) data 0.000 (0.002) loss 1.3739 (1.4658) ce_loss 1.2080 (1.3709) teacher_loss 0.6320 (0.8222) loss_zs_kd 0.4266 (0.3956) loss_oracle 0.5286 (0.4458) acc 53.1250 (48.3894) kd_loss 0.9701 (0.8699) lr 1.6374e-03 eta 0:15:29
epoch [16/50] batch [280/319] time 0.086 (0.085) data 0.000 (0.002) loss 1.6893 (1.4704) ce_loss 1.3740 (1.3707) teacher_loss 1.1084 (0.8263) loss_zs_kd 0.3969 (0.3954) loss_oracle 0.3825 (0.4464) acc 50.0000 (48.4821) kd_loss 0.8243 (0.8699) lr 1.6374e-03 eta 0:15:26
epoch [16/50] batch [300/319] time 0.079 (0.085) data 0.000 (0.002) loss 1.5297 (1.4698) ce_loss 1.4004 (1.3694) teacher_loss 0.7727 (0.8239) loss_zs_kd 0.4536 (0.3950) loss_oracle 0.5302 (0.4485) acc 50.0000 (48.4688) kd_loss 0.8340 (0.8696) lr 1.6374e-03 eta 0:15:24
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,056
* accuracy: 47.0%
* error: 53.0%
* macro_f1: 35.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,385
* accuracy: 34.8%
* error: 65.2%
* macro_f1: 14.5%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [17/50] batch [20/319] time 0.085 (0.121) data 0.001 (0.033) loss 1.5572 (1.4615) ce_loss 1.2529 (1.3429) teacher_loss 0.8272 (0.8147) loss_zs_kd 0.4721 (0.3809) loss_oracle 0.4940 (0.4564) acc 59.3750 (50.6250) kd_loss 0.9001 (0.8806) lr 1.5878e-03 eta 0:21:44
epoch [17/50] batch [40/319] time 0.083 (0.103) data 0.000 (0.017) loss 1.4618 (1.4819) ce_loss 1.3477 (1.3543) teacher_loss 0.8372 (0.8176) loss_zs_kd 0.3953 (0.4008) loss_oracle 0.4269 (0.4639) acc 50.0000 (50.3906) kd_loss 0.8443 (0.8821) lr 1.5878e-03 eta 0:18:33
epoch [17/50] batch [60/319] time 0.084 (0.098) data 0.000 (0.011) loss 1.7192 (1.4936) ce_loss 1.6250 (1.3466) teacher_loss 1.2080 (0.8256) loss_zs_kd 0.3527 (0.3990) loss_oracle 0.3349 (0.4684) acc 46.8750 (50.3125) kd_loss 0.7573 (0.8852) lr 1.5878e-03 eta 0:17:35
epoch [17/50] batch [80/319] time 0.081 (0.094) data 0.000 (0.009) loss 1.2292 (1.4767) ce_loss 1.0508 (1.3345) teacher_loss 0.7090 (0.8135) loss_zs_kd 0.4053 (0.3961) loss_oracle 0.3175 (0.4651) acc 62.5000 (50.8984) kd_loss 0.8332 (0.8837) lr 1.5878e-03 eta 0:16:56
epoch [17/50] batch [100/319] time 0.087 (0.093) data 0.000 (0.007) loss 1.5247 (1.4815) ce_loss 1.3877 (1.3422) teacher_loss 0.8722 (0.8209) loss_zs_kd 0.4340 (0.3905) loss_oracle 0.4355 (0.4653) acc 43.7500 (50.3438) kd_loss 0.8678 (0.8852) lr 1.5878e-03 eta 0:16:34
epoch [17/50] batch [120/319] time 0.084 (0.091) data 0.000 (0.006) loss 1.3593 (1.4895) ce_loss 1.3643 (1.3536) teacher_loss 0.7352 (0.8329) loss_zs_kd 0.3985 (0.3886) loss_oracle 0.4249 (0.4623) acc 40.6250 (50.0000) kd_loss 0.7884 (0.8869) lr 1.5878e-03 eta 0:16:13
epoch [17/50] batch [140/319] time 0.082 (0.090) data 0.000 (0.005) loss 1.6324 (1.4924) ce_loss 1.4268 (1.3619) teacher_loss 0.9264 (0.8292) loss_zs_kd 0.4846 (0.3950) loss_oracle 0.4637 (0.4656) acc 50.0000 (49.5759) kd_loss 1.0251 (0.8928) lr 1.5878e-03 eta 0:16:02
epoch [17/50] batch [160/319] time 0.086 (0.089) data 0.000 (0.004) loss 1.3503 (1.4926) ce_loss 1.1309 (1.3647) teacher_loss 0.6218 (0.8242) loss_zs_kd 0.3720 (0.3992) loss_oracle 0.5425 (0.4688) acc 46.8750 (49.3359) kd_loss 0.9392 (0.8973) lr 1.5878e-03 eta 0:15:53
epoch [17/50] batch [180/319] time 0.084 (0.089) data 0.000 (0.004) loss 1.3475 (1.4906) ce_loss 1.2031 (1.3620) teacher_loss 0.6195 (0.8201) loss_zs_kd 0.4181 (0.4045) loss_oracle 0.5189 (0.4682) acc 53.1250 (49.1840) kd_loss 0.9837 (0.9010) lr 1.5878e-03 eta 0:15:48
epoch [17/50] batch [200/319] time 0.079 (0.088) data 0.000 (0.004) loss 1.2385 (1.4903) ce_loss 1.0527 (1.3613) teacher_loss 0.5659 (0.8179) loss_zs_kd 0.4103 (0.4080) loss_oracle 0.4675 (0.4684) acc 65.6250 (49.3281) kd_loss 0.9221 (0.9025) lr 1.5878e-03 eta 0:15:39
epoch [17/50] batch [220/319] time 0.087 (0.088) data 0.000 (0.003) loss 1.4104 (1.4917) ce_loss 1.3164 (1.3667) teacher_loss 0.7917 (0.8221) loss_zs_kd 0.4640 (0.4091) loss_oracle 0.3867 (0.4651) acc 56.2500 (49.1477) kd_loss 0.8835 (0.9031) lr 1.5878e-03 eta 0:15:33
epoch [17/50] batch [240/319] time 0.085 (0.088) data 0.000 (0.003) loss 1.5428 (1.4881) ce_loss 1.5654 (1.3674) teacher_loss 0.8674 (0.8216) loss_zs_kd 0.4610 (0.4089) loss_oracle 0.4448 (0.4620) acc 37.5000 (48.9714) kd_loss 0.8358 (0.9037) lr 1.5878e-03 eta 0:15:29
epoch [17/50] batch [260/319] time 0.077 (0.087) data 0.000 (0.003) loss 1.4806 (1.4861) ce_loss 1.5576 (1.3705) teacher_loss 0.8203 (0.8237) loss_zs_kd 0.4417 (0.4094) loss_oracle 0.4395 (0.4576) acc 43.7500 (48.7620) kd_loss 0.8837 (0.9041) lr 1.5878e-03 eta 0:15:24
epoch [17/50] batch [280/319] time 0.078 (0.087) data 0.000 (0.003) loss 1.1517 (1.4794) ce_loss 1.0879 (1.3679) teacher_loss 0.5572 (0.8229) loss_zs_kd 0.3762 (0.4074) loss_oracle 0.4064 (0.4529) acc 56.2500 (48.8393) kd_loss 0.9429 (0.9047) lr 1.5878e-03 eta 0:15:16
epoch [17/50] batch [300/319] time 0.085 (0.087) data 0.000 (0.002) loss 1.4617 (1.4751) ce_loss 1.4131 (1.3680) teacher_loss 0.7948 (0.8230) loss_zs_kd 0.4257 (0.4060) loss_oracle 0.4540 (0.4491) acc 46.8750 (48.7917) kd_loss 0.8757 (0.9046) lr 1.5878e-03 eta 0:15:12
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,065
* accuracy: 47.2%
* error: 52.8%
* macro_f1: 36.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,286
* accuracy: 33.8%
* error: 66.2%
* macro_f1: 15.3%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [18/50] batch [20/319] time 0.077 (0.109) data 0.000 (0.025) loss 1.2698 (1.3992) ce_loss 1.2041 (1.3186) teacher_loss 0.7101 (0.8333) loss_zs_kd 0.3463 (0.3652) loss_oracle 0.3865 (0.3833) acc 56.2500 (51.7188) kd_loss 0.8693 (0.9023) lr 1.5358e-03 eta 0:19:03
epoch [18/50] batch [40/319] time 0.081 (0.096) data 0.000 (0.013) loss 1.3330 (1.3984) ce_loss 1.2051 (1.3120) teacher_loss 0.7749 (0.8394) loss_zs_kd 0.3736 (0.3640) loss_oracle 0.3713 (0.3770) acc 43.7500 (50.6250) kd_loss 0.8653 (0.8813) lr 1.5358e-03 eta 0:16:41
epoch [18/50] batch [60/319] time 0.080 (0.092) data 0.000 (0.009) loss 1.3949 (1.3867) ce_loss 1.4893 (1.3276) teacher_loss 0.8401 (0.8242) loss_zs_kd 0.3929 (0.3678) loss_oracle 0.3583 (0.3786) acc 43.7500 (49.7917) kd_loss 0.9146 (0.8820) lr 1.5358e-03 eta 0:16:04
epoch [18/50] batch [80/319] time 0.084 (0.090) data 0.000 (0.007) loss 1.3616 (1.3967) ce_loss 1.4023 (1.3403) teacher_loss 0.7253 (0.8333) loss_zs_kd 0.3873 (0.3702) loss_oracle 0.4426 (0.3783) acc 43.7500 (48.8672) kd_loss 0.9340 (0.8822) lr 1.5358e-03 eta 0:15:42
epoch [18/50] batch [100/319] time 0.083 (0.089) data 0.000 (0.005) loss 1.1839 (1.4007) ce_loss 0.9146 (1.3464) teacher_loss 0.6729 (0.8388) loss_zs_kd 0.3517 (0.3699) loss_oracle 0.3352 (0.3769) acc 71.8750 (48.7812) kd_loss 0.8992 (0.8845) lr 1.5358e-03 eta 0:15:25
epoch [18/50] batch [120/319] time 0.081 (0.088) data 0.000 (0.004) loss 1.5256 (1.4088) ce_loss 1.6211 (1.3597) teacher_loss 0.8705 (0.8498) loss_zs_kd 0.4717 (0.3695) loss_oracle 0.4193 (0.3742) acc 46.8750 (48.6458) kd_loss 0.8575 (0.8844) lr 1.5358e-03 eta 0:15:13
epoch [18/50] batch [140/319] time 0.087 (0.087) data 0.000 (0.004) loss 1.3354 (1.4040) ce_loss 1.2891 (1.3562) teacher_loss 0.8234 (0.8477) loss_zs_kd 0.3882 (0.3701) loss_oracle 0.3178 (0.3712) acc 50.0000 (48.7500) kd_loss 0.9578 (0.8863) lr 1.5358e-03 eta 0:15:06
epoch [18/50] batch [160/319] time 0.083 (0.087) data 0.001 (0.003) loss 1.4223 (1.4067) ce_loss 1.5771 (1.3622) teacher_loss 0.9200 (0.8531) loss_zs_kd 0.3604 (0.3682) loss_oracle 0.3221 (0.3695) acc 46.8750 (48.8672) kd_loss 0.9047 (0.8857) lr 1.5358e-03 eta 0:15:00
epoch [18/50] batch [180/319] time 0.083 (0.087) data 0.000 (0.003) loss 1.4516 (1.4063) ce_loss 1.3691 (1.3650) teacher_loss 0.9531 (0.8536) loss_zs_kd 0.3933 (0.3689) loss_oracle 0.3018 (0.3683) acc 46.8750 (48.7326) kd_loss 0.8075 (0.8847) lr 1.5358e-03 eta 0:14:57
epoch [18/50] batch [200/319] time 0.084 (0.087) data 0.000 (0.003) loss 1.3921 (1.4072) ce_loss 1.4053 (1.3668) teacher_loss 0.8681 (0.8552) loss_zs_kd 0.3367 (0.3670) loss_oracle 0.3556 (0.3685) acc 40.6250 (48.8125) kd_loss 0.9362 (0.8859) lr 1.5358e-03 eta 0:14:54
epoch [18/50] batch [220/319] time 0.089 (0.087) data 0.000 (0.003) loss 1.5744 (1.4099) ce_loss 1.3750 (1.3704) teacher_loss 1.0719 (0.8567) loss_zs_kd 0.3923 (0.3678) loss_oracle 0.3064 (0.3693) acc 53.1250 (48.5795) kd_loss 0.8857 (0.8871) lr 1.5358e-03 eta 0:14:52
epoch [18/50] batch [240/319] time 0.086 (0.086) data 0.000 (0.002) loss 1.3550 (1.4106) ce_loss 1.4629 (1.3724) teacher_loss 0.8272 (0.8572) loss_zs_kd 0.3051 (0.3662) loss_oracle 0.3752 (0.3703) acc 46.8750 (48.6849) kd_loss 0.9164 (0.8874) lr 1.5358e-03 eta 0:14:48
epoch [18/50] batch [260/319] time 0.084 (0.086) data 0.000 (0.002) loss 1.5572 (1.4121) ce_loss 1.5029 (1.3745) teacher_loss 0.9009 (0.8579) loss_zs_kd 0.4189 (0.3663) loss_oracle 0.4469 (0.3711) acc 50.0000 (48.5457) kd_loss 0.8704 (0.8860) lr 1.5358e-03 eta 0:14:46
epoch [18/50] batch [280/319] time 0.085 (0.086) data 0.000 (0.002) loss 1.4555 (1.4175) ce_loss 1.3975 (1.3813) teacher_loss 0.9648 (0.8617) loss_zs_kd 0.3393 (0.3672) loss_oracle 0.3210 (0.3722) acc 50.0000 (48.3817) kd_loss 0.7712 (0.8850) lr 1.5358e-03 eta 0:14:41
epoch [18/50] batch [300/319] time 0.080 (0.086) data 0.000 (0.002) loss 1.4614 (1.4218) ce_loss 1.3174 (1.3841) teacher_loss 0.7785 (0.8644) loss_zs_kd 0.4038 (0.3665) loss_oracle 0.4811 (0.3741) acc 53.1250 (48.2500) kd_loss 0.8388 (0.8821) lr 1.5358e-03 eta 0:14:35
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,184
* accuracy: 49.9%
* error: 50.1%
* macro_f1: 37.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,372
* accuracy: 34.6%
* error: 65.4%
* macro_f1: 15.1%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [19/50] batch [20/319] time 0.081 (0.116) data 0.000 (0.026) loss 1.3553 (1.4694) ce_loss 1.1084 (1.3574) teacher_loss 0.8192 (0.8447) loss_zs_kd 0.3383 (0.3701) loss_oracle 0.3669 (0.4396) acc 56.2500 (50.0000) kd_loss 0.8096 (0.8481) lr 1.4818e-03 eta 0:19:37
epoch [19/50] batch [40/319] time 0.081 (0.100) data 0.000 (0.013) loss 1.4127 (1.4622) ce_loss 1.2734 (1.3542) teacher_loss 0.8878 (0.8582) loss_zs_kd 0.3511 (0.3637) loss_oracle 0.3493 (0.4222) acc 46.8750 (50.0781) kd_loss 0.8203 (0.8418) lr 1.4818e-03 eta 0:16:53
epoch [19/50] batch [60/319] time 0.075 (0.093) data 0.000 (0.009) loss 1.2891 (1.4766) ce_loss 0.9624 (1.3512) teacher_loss 0.7786 (0.8642) loss_zs_kd 0.2890 (0.3711) loss_oracle 0.3660 (0.4269) acc 62.5000 (49.3750) kd_loss 0.8259 (0.8343) lr 1.4818e-03 eta 0:15:46
epoch [19/50] batch [80/319] time 0.083 (0.091) data 0.000 (0.007) loss 1.4553 (1.4802) ce_loss 1.3379 (1.3527) teacher_loss 0.9204 (0.8698) loss_zs_kd 0.4081 (0.3594) loss_oracle 0.3309 (0.4307) acc 46.8750 (49.6484) kd_loss 0.6859 (0.8242) lr 1.4818e-03 eta 0:15:23
epoch [19/50] batch [100/319] time 0.083 (0.090) data 0.000 (0.005) loss 1.5802 (1.4972) ce_loss 1.4004 (1.3604) teacher_loss 0.8756 (0.8765) loss_zs_kd 0.3928 (0.3663) loss_oracle 0.5082 (0.4376) acc 53.1250 (49.0000) kd_loss 0.8132 (0.8210) lr 1.4818e-03 eta 0:15:10
epoch [19/50] batch [120/319] time 0.078 (0.089) data 0.000 (0.005) loss 1.6919 (1.5015) ce_loss 1.7510 (1.3621) teacher_loss 1.0177 (0.8763) loss_zs_kd 0.3269 (0.3677) loss_oracle 0.5108 (0.4413) acc 31.2500 (48.7760) kd_loss 0.7979 (0.8202) lr 1.4818e-03 eta 0:14:57
epoch [19/50] batch [140/319] time 0.089 (0.088) data 0.000 (0.004) loss 1.5667 (1.5042) ce_loss 1.2764 (1.3603) teacher_loss 0.8413 (0.8762) loss_zs_kd 0.3228 (0.3677) loss_oracle 0.5640 (0.4442) acc 50.0000 (48.6384) kd_loss 0.8478 (0.8207) lr 1.4818e-03 eta 0:14:49
epoch [19/50] batch [160/319] time 0.077 (0.088) data 0.000 (0.003) loss 1.5216 (1.5025) ce_loss 1.6396 (1.3546) teacher_loss 0.9132 (0.8724) loss_zs_kd 0.3330 (0.3701) loss_oracle 0.4420 (0.4451) acc 37.5000 (48.5938) kd_loss 0.8208 (0.8209) lr 1.4818e-03 eta 0:14:40
epoch [19/50] batch [180/319] time 0.084 (0.087) data 0.000 (0.003) loss 1.3202 (1.4967) ce_loss 1.0488 (1.3483) teacher_loss 0.7420 (0.8626) loss_zs_kd 0.3809 (0.3718) loss_oracle 0.3877 (0.4481) acc 68.7500 (48.9931) kd_loss 0.8742 (0.8249) lr 1.4818e-03 eta 0:14:27
epoch [19/50] batch [200/319] time 0.083 (0.086) data 0.000 (0.003) loss 1.4780 (1.4965) ce_loss 1.4033 (1.3487) teacher_loss 0.7380 (0.8558) loss_zs_kd 0.4060 (0.3759) loss_oracle 0.5370 (0.4527) acc 43.7500 (48.9219) kd_loss 0.8981 (0.8292) lr 1.4818e-03 eta 0:14:24
epoch [19/50] batch [220/319] time 0.075 (0.086) data 0.000 (0.003) loss 1.4031 (1.4913) ce_loss 1.3076 (1.3421) teacher_loss 0.7257 (0.8464) loss_zs_kd 0.3897 (0.3790) loss_oracle 0.4825 (0.4554) acc 56.2500 (49.2756) kd_loss 0.8749 (0.8327) lr 1.4818e-03 eta 0:14:18
epoch [19/50] batch [240/319] time 0.091 (0.086) data 0.000 (0.002) loss 1.6447 (1.4898) ce_loss 1.4316 (1.3428) teacher_loss 0.9324 (0.8428) loss_zs_kd 0.3971 (0.3819) loss_oracle 0.5138 (0.4561) acc 53.1250 (49.4141) kd_loss 0.9373 (0.8362) lr 1.4818e-03 eta 0:14:14
epoch [19/50] batch [260/319] time 0.085 (0.086) data 0.000 (0.002) loss 1.6843 (1.4892) ce_loss 1.4971 (1.3427) teacher_loss 0.9490 (0.8398) loss_zs_kd 0.3870 (0.3843) loss_oracle 0.5418 (0.4573) acc 56.2500 (49.4231) kd_loss 0.8216 (0.8381) lr 1.4818e-03 eta 0:14:11
epoch [19/50] batch [280/319] time 0.081 (0.085) data 0.000 (0.002) loss 1.3600 (1.4849) ce_loss 1.2227 (1.3431) teacher_loss 0.6441 (0.8347) loss_zs_kd 0.4159 (0.3872) loss_oracle 0.5080 (0.4566) acc 53.1250 (49.3080) kd_loss 0.9433 (0.8405) lr 1.4818e-03 eta 0:14:08
epoch [19/50] batch [300/319] time 0.077 (0.085) data 0.000 (0.002) loss 1.5485 (1.4813) ce_loss 1.3994 (1.3436) teacher_loss 0.8299 (0.8310) loss_zs_kd 0.4188 (0.3893) loss_oracle 0.5092 (0.4557) acc 43.7500 (49.3438) kd_loss 0.9325 (0.8427) lr 1.4818e-03 eta 0:14:05
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,222
* accuracy: 50.8%
* error: 49.2%
* macro_f1: 40.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,702
* accuracy: 38.0%
* error: 62.0%
* macro_f1: 17.5%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [20/50] batch [20/319] time 0.087 (0.119) data 0.000 (0.033) loss 1.5440 (1.4502) ce_loss 1.2764 (1.3505) teacher_loss 0.8714 (0.7656) loss_zs_kd 0.3926 (0.4313) loss_oracle 0.4762 (0.4689) acc 43.7500 (49.5312) kd_loss 0.8126 (0.8783) lr 1.4258e-03 eta 0:19:35
epoch [20/50] batch [40/319] time 0.086 (0.102) data 0.000 (0.017) loss 1.3189 (1.4321) ce_loss 1.1855 (1.3404) teacher_loss 0.6874 (0.7583) loss_zs_kd 0.3598 (0.4173) loss_oracle 0.4516 (0.4652) acc 50.0000 (50.0000) kd_loss 0.8578 (0.8852) lr 1.4258e-03 eta 0:16:41
epoch [20/50] batch [60/319] time 0.077 (0.095) data 0.000 (0.011) loss 1.1959 (1.4474) ce_loss 1.0322 (1.3653) teacher_loss 0.6220 (0.7799) loss_zs_kd 0.3033 (0.4087) loss_oracle 0.4223 (0.4631) acc 59.3750 (49.0104) kd_loss 0.9230 (0.8815) lr 1.4258e-03 eta 0:15:34
epoch [20/50] batch [80/319] time 0.088 (0.092) data 0.000 (0.008) loss 1.3913 (1.4353) ce_loss 1.3047 (1.3560) teacher_loss 0.6495 (0.7698) loss_zs_kd 0.5255 (0.4114) loss_oracle 0.4791 (0.4599) acc 53.1250 (49.3750) kd_loss 0.9102 (0.8824) lr 1.4258e-03 eta 0:15:02
epoch [20/50] batch [100/319] time 0.096 (0.091) data 0.000 (0.007) loss 1.3475 (1.4244) ce_loss 1.2178 (1.3476) teacher_loss 0.7240 (0.7569) loss_zs_kd 0.4228 (0.4155) loss_oracle 0.4121 (0.4597) acc 62.5000 (49.5938) kd_loss 0.8472 (0.8862) lr 1.4258e-03 eta 0:14:49
epoch [20/50] batch [120/319] time 0.081 (0.090) data 0.000 (0.006) loss 1.3512 (1.4194) ce_loss 1.3857 (1.3395) teacher_loss 0.7093 (0.7493) loss_zs_kd 0.4107 (0.4141) loss_oracle 0.4366 (0.4631) acc 43.7500 (49.7917) kd_loss 0.9004 (0.8899) lr 1.4258e-03 eta 0:14:36
epoch [20/50] batch [140/319] time 0.084 (0.089) data 0.000 (0.005) loss 1.3356 (1.4229) ce_loss 1.0967 (1.3431) teacher_loss 0.6522 (0.7468) loss_zs_kd 0.4200 (0.4190) loss_oracle 0.4734 (0.4666) acc 59.3750 (49.6652) kd_loss 0.8364 (0.8898) lr 1.4258e-03 eta 0:14:26
epoch [20/50] batch [160/319] time 0.091 (0.088) data 0.000 (0.004) loss 1.3118 (1.4262) ce_loss 1.1455 (1.3421) teacher_loss 0.6700 (0.7488) loss_zs_kd 0.4295 (0.4180) loss_oracle 0.4270 (0.4684) acc 62.5000 (49.6680) kd_loss 0.9866 (0.8924) lr 1.4258e-03 eta 0:14:18
epoch [20/50] batch [180/319] time 0.074 (0.088) data 0.000 (0.004) loss 1.5829 (1.4338) ce_loss 1.3955 (1.3505) teacher_loss 0.8680 (0.7538) loss_zs_kd 0.4320 (0.4175) loss_oracle 0.4990 (0.4713) acc 40.6250 (49.2361) kd_loss 0.9161 (0.8939) lr 1.4258e-03 eta 0:14:09
epoch [20/50] batch [200/319] time 0.081 (0.087) data 0.000 (0.004) loss 1.5724 (1.4351) ce_loss 1.4756 (1.3539) teacher_loss 0.8586 (0.7520) loss_zs_kd 0.5063 (0.4182) loss_oracle 0.4606 (0.4740) acc 53.1250 (49.1250) kd_loss 0.8941 (0.8938) lr 1.4258e-03 eta 0:14:02
epoch [20/50] batch [220/319] time 0.086 (0.087) data 0.000 (0.003) loss 1.3880 (1.4349) ce_loss 1.3105 (1.3517) teacher_loss 0.7440 (0.7490) loss_zs_kd 0.3692 (0.4206) loss_oracle 0.4593 (0.4757) acc 56.2500 (49.3892) kd_loss 0.8977 (0.8946) lr 1.4258e-03 eta 0:13:59
epoch [20/50] batch [240/319] time 0.072 (0.087) data 0.000 (0.003) loss 1.5135 (1.4391) ce_loss 1.2061 (1.3590) teacher_loss 0.7729 (0.7520) loss_zs_kd 0.4153 (0.4201) loss_oracle 0.5329 (0.4771) acc 56.2500 (49.2578) kd_loss 0.9205 (0.8943) lr 1.4258e-03 eta 0:13:55
epoch [20/50] batch [260/319] time 0.088 (0.086) data 0.000 (0.003) loss 1.4097 (1.4368) ce_loss 1.1660 (1.3549) teacher_loss 0.7365 (0.7506) loss_zs_kd 0.3749 (0.4196) loss_oracle 0.4857 (0.4765) acc 53.1250 (49.3870) kd_loss 0.8571 (0.8929) lr 1.4258e-03 eta 0:13:50
epoch [20/50] batch [280/319] time 0.086 (0.086) data 0.000 (0.003) loss 1.4063 (1.4389) ce_loss 1.3242 (1.3548) teacher_loss 0.7462 (0.7531) loss_zs_kd 0.4059 (0.4188) loss_oracle 0.4571 (0.4764) acc 53.1250 (49.4866) kd_loss 0.9274 (0.8912) lr 1.4258e-03 eta 0:13:48
epoch [20/50] batch [300/319] time 0.086 (0.086) data 0.000 (0.002) loss 1.4725 (1.4384) ce_loss 1.3730 (1.3544) teacher_loss 0.8189 (0.7549) loss_zs_kd 0.4275 (0.4174) loss_oracle 0.4399 (0.4748) acc 50.0000 (49.6042) kd_loss 0.8884 (0.8906) lr 1.4258e-03 eta 0:13:45
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,138
* accuracy: 48.8%
* error: 51.2%
* macro_f1: 37.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,905
* accuracy: 40.1%
* error: 59.9%
* macro_f1: 16.2%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [21/50] batch [20/319] time 0.078 (0.110) data 0.000 (0.026) loss 1.5107 (1.4756) ce_loss 1.4600 (1.3624) teacher_loss 0.6984 (0.7535) loss_zs_kd 0.4857 (0.4465) loss_oracle 0.5694 (0.4989) acc 40.6250 (47.5000) kd_loss 0.9644 (0.8749) lr 1.3681e-03 eta 0:17:34
epoch [21/50] batch [40/319] time 0.080 (0.097) data 0.000 (0.013) loss 1.4841 (1.4714) ce_loss 1.2920 (1.3646) teacher_loss 0.8062 (0.7656) loss_zs_kd 0.3783 (0.4333) loss_oracle 0.4887 (0.4892) acc 53.1250 (47.8125) kd_loss 0.7892 (0.8739) lr 1.3681e-03 eta 0:15:28
epoch [21/50] batch [60/319] time 0.085 (0.093) data 0.000 (0.009) loss 1.5410 (1.4747) ce_loss 1.2744 (1.3588) teacher_loss 0.6487 (0.7582) loss_zs_kd 0.5005 (0.4361) loss_oracle 0.6420 (0.4985) acc 40.6250 (48.0729) kd_loss 0.9394 (0.8822) lr 1.3681e-03 eta 0:14:45
epoch [21/50] batch [80/319] time 0.082 (0.090) data 0.000 (0.007) loss 1.1766 (1.4685) ce_loss 1.0244 (1.3576) teacher_loss 0.5526 (0.7590) loss_zs_kd 0.3625 (0.4315) loss_oracle 0.4427 (0.4937) acc 62.5000 (48.0859) kd_loss 0.8668 (0.8827) lr 1.3681e-03 eta 0:14:15
epoch [21/50] batch [100/319] time 0.082 (0.088) data 0.000 (0.005) loss 1.4140 (1.4705) ce_loss 1.2676 (1.3568) teacher_loss 0.7508 (0.7648) loss_zs_kd 0.4032 (0.4246) loss_oracle 0.4616 (0.4935) acc 62.5000 (48.2812) kd_loss 0.9013 (0.8821) lr 1.3681e-03 eta 0:13:49
epoch [21/50] batch [120/319] time 0.079 (0.087) data 0.000 (0.005) loss 1.4078 (1.4726) ce_loss 1.2363 (1.3460) teacher_loss 0.6644 (0.7657) loss_zs_kd 0.3698 (0.4266) loss_oracle 0.5585 (0.4936) acc 46.8750 (48.6458) kd_loss 0.9000 (0.8780) lr 1.3681e-03 eta 0:13:37
epoch [21/50] batch [140/319] time 0.090 (0.086) data 0.000 (0.004) loss 1.6351 (1.4677) ce_loss 1.4844 (1.3365) teacher_loss 0.9069 (0.7618) loss_zs_kd 0.4898 (0.4237) loss_oracle 0.4833 (0.4940) acc 40.6250 (49.0625) kd_loss 0.7930 (0.8798) lr 1.3681e-03 eta 0:13:32
epoch [21/50] batch [160/319] time 0.092 (0.086) data 0.001 (0.003) loss 1.4217 (1.4679) ce_loss 1.1670 (1.3274) teacher_loss 0.8290 (0.7688) loss_zs_kd 0.3653 (0.4207) loss_oracle 0.4100 (0.4888) acc 56.2500 (49.5898) kd_loss 0.8946 (0.8762) lr 1.3681e-03 eta 0:13:30
epoch [21/50] batch [180/319] time 0.080 (0.086) data 0.000 (0.003) loss 1.5743 (1.4671) ce_loss 1.3906 (1.3227) teacher_loss 0.8984 (0.7677) loss_zs_kd 0.4494 (0.4193) loss_oracle 0.4512 (0.4897) acc 43.7500 (49.5660) kd_loss 0.8137 (0.8757) lr 1.3681e-03 eta 0:13:25
epoch [21/50] batch [200/319] time 0.088 (0.086) data 0.000 (0.003) loss 1.7013 (1.4735) ce_loss 1.5840 (1.3292) teacher_loss 0.9642 (0.7717) loss_zs_kd 0.4901 (0.4194) loss_oracle 0.4920 (0.4921) acc 53.1250 (49.3750) kd_loss 0.9113 (0.8789) lr 1.3681e-03 eta 0:13:23
epoch [21/50] batch [220/319] time 0.081 (0.086) data 0.000 (0.003) loss 1.5168 (1.4731) ce_loss 1.3281 (1.3308) teacher_loss 0.8470 (0.7698) loss_zs_kd 0.3540 (0.4204) loss_oracle 0.4928 (0.4931) acc 43.7500 (49.4886) kd_loss 0.8758 (0.8792) lr 1.3681e-03 eta 0:13:21
epoch [21/50] batch [240/319] time 0.082 (0.085) data 0.000 (0.002) loss 1.1883 (1.4710) ce_loss 1.2041 (1.3303) teacher_loss 0.5769 (0.7698) loss_zs_kd 0.3957 (0.4189) loss_oracle 0.4135 (0.4918) acc 53.1250 (49.5573) kd_loss 0.9461 (0.8799) lr 1.3681e-03 eta 0:13:14
epoch [21/50] batch [260/319] time 0.082 (0.085) data 0.000 (0.002) loss 1.5953 (1.4794) ce_loss 1.5479 (1.3388) teacher_loss 0.7990 (0.7783) loss_zs_kd 0.4759 (0.4193) loss_oracle 0.5584 (0.4914) acc 34.3750 (49.3149) kd_loss 0.8449 (0.8785) lr 1.3681e-03 eta 0:13:11
epoch [21/50] batch [280/319] time 0.086 (0.085) data 0.000 (0.002) loss 1.4201 (1.4815) ce_loss 1.3477 (1.3421) teacher_loss 0.7795 (0.7807) loss_zs_kd 0.4049 (0.4196) loss_oracle 0.4382 (0.4911) acc 50.0000 (49.1629) kd_loss 0.8488 (0.8775) lr 1.3681e-03 eta 0:13:10
epoch [21/50] batch [300/319] time 0.082 (0.085) data 0.000 (0.002) loss 1.3346 (1.4803) ce_loss 1.1250 (1.3386) teacher_loss 0.7103 (0.7807) loss_zs_kd 0.4065 (0.4184) loss_oracle 0.4211 (0.4904) acc 59.3750 (49.3542) kd_loss 0.8824 (0.8764) lr 1.3681e-03 eta 0:13:09
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,146
* accuracy: 49.0%
* error: 51.0%
* macro_f1: 39.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,650
* accuracy: 37.5%
* error: 62.5%
* macro_f1: 15.8%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [22/50] batch [20/319] time 0.080 (0.119) data 0.000 (0.028) loss 1.5875 (1.4618) ce_loss 1.4727 (1.3049) teacher_loss 0.7314 (0.7598) loss_zs_kd 0.5019 (0.4102) loss_oracle 0.6052 (0.4968) acc 43.7500 (50.0000) kd_loss 0.9082 (0.8818) lr 1.3090e-03 eta 0:18:22
epoch [22/50] batch [40/319] time 0.078 (0.100) data 0.000 (0.014) loss 1.4701 (1.4547) ce_loss 1.3418 (1.3116) teacher_loss 0.8046 (0.7576) loss_zs_kd 0.4437 (0.4086) loss_oracle 0.4437 (0.4928) acc 40.6250 (49.2969) kd_loss 0.8204 (0.8725) lr 1.3090e-03 eta 0:15:21
epoch [22/50] batch [60/319] time 0.083 (0.095) data 0.000 (0.009) loss 1.2825 (1.4585) ce_loss 1.1396 (1.3200) teacher_loss 0.6318 (0.7718) loss_zs_kd 0.3790 (0.4024) loss_oracle 0.4612 (0.4855) acc 56.2500 (48.8021) kd_loss 0.8958 (0.8684) lr 1.3090e-03 eta 0:14:31
epoch [22/50] batch [80/319] time 0.084 (0.092) data 0.000 (0.007) loss 1.8711 (1.4571) ce_loss 1.6758 (1.3186) teacher_loss 1.1757 (0.7755) loss_zs_kd 0.4101 (0.4023) loss_oracle 0.4904 (0.4805) acc 31.2500 (49.1797) kd_loss 0.7989 (0.8684) lr 1.3090e-03 eta 0:14:07
epoch [22/50] batch [100/319] time 0.083 (0.091) data 0.000 (0.006) loss 1.3163 (1.4649) ce_loss 1.2715 (1.3250) teacher_loss 0.5983 (0.7800) loss_zs_kd 0.3997 (0.4026) loss_oracle 0.5182 (0.4837) acc 46.8750 (49.0938) kd_loss 0.8796 (0.8707) lr 1.3090e-03 eta 0:13:51
epoch [22/50] batch [120/319] time 0.085 (0.090) data 0.000 (0.005) loss 1.7081 (1.4598) ce_loss 1.6064 (1.3213) teacher_loss 1.0838 (0.7786) loss_zs_kd 0.4024 (0.4028) loss_oracle 0.4230 (0.4799) acc 46.8750 (49.2708) kd_loss 0.8503 (0.8679) lr 1.3090e-03 eta 0:13:38
epoch [22/50] batch [140/319] time 0.086 (0.089) data 0.000 (0.004) loss 1.4883 (1.4715) ce_loss 1.4248 (1.3265) teacher_loss 0.7939 (0.7867) loss_zs_kd 0.3744 (0.4064) loss_oracle 0.5072 (0.4816) acc 43.7500 (49.1071) kd_loss 0.8882 (0.8653) lr 1.3090e-03 eta 0:13:34
epoch [22/50] batch [160/319] time 0.080 (0.089) data 0.000 (0.004) loss 1.5873 (1.4705) ce_loss 1.4336 (1.3284) teacher_loss 0.8981 (0.7903) loss_zs_kd 0.3528 (0.4037) loss_oracle 0.5128 (0.4783) acc 46.8750 (49.1602) kd_loss 0.8448 (0.8637) lr 1.3090e-03 eta 0:13:26
epoch [22/50] batch [180/319] time 0.080 (0.088) data 0.000 (0.003) loss 1.6936 (1.4636) ce_loss 1.5439 (1.3210) teacher_loss 1.0535 (0.7866) loss_zs_kd 0.4346 (0.4020) loss_oracle 0.4227 (0.4760) acc 46.8750 (49.5139) kd_loss 0.8563 (0.8641) lr 1.3090e-03 eta 0:13:14
epoch [22/50] batch [200/319] time 0.082 (0.087) data 0.000 (0.003) loss 1.3934 (1.4634) ce_loss 1.3037 (1.3207) teacher_loss 0.7357 (0.7875) loss_zs_kd 0.4045 (0.4025) loss_oracle 0.4555 (0.4747) acc 43.7500 (49.4375) kd_loss 0.9143 (0.8637) lr 1.3090e-03 eta 0:13:10
epoch [22/50] batch [220/319] time 0.085 (0.087) data 0.000 (0.003) loss 1.2142 (1.4616) ce_loss 1.0732 (1.3205) teacher_loss 0.6339 (0.7878) loss_zs_kd 0.3529 (0.4027) loss_oracle 0.4039 (0.4725) acc 68.7500 (49.5881) kd_loss 0.8116 (0.8640) lr 1.3090e-03 eta 0:13:05
epoch [22/50] batch [240/319] time 0.086 (0.087) data 0.000 (0.003) loss 1.6474 (1.4592) ce_loss 1.5283 (1.3200) teacher_loss 0.9240 (0.7849) loss_zs_kd 0.4567 (0.4031) loss_oracle 0.4950 (0.4728) acc 43.7500 (49.6094) kd_loss 0.8815 (0.8664) lr 1.3090e-03 eta 0:13:01
epoch [22/50] batch [260/319] time 0.087 (0.087) data 0.000 (0.002) loss 1.5064 (1.4600) ce_loss 1.4863 (1.3245) teacher_loss 0.7733 (0.7847) loss_zs_kd 0.4192 (0.4050) loss_oracle 0.5235 (0.4728) acc 37.5000 (49.3870) kd_loss 0.9049 (0.8675) lr 1.3090e-03 eta 0:12:58
epoch [22/50] batch [280/319] time 0.081 (0.086) data 0.000 (0.002) loss 1.2031 (1.4562) ce_loss 1.1250 (1.3218) teacher_loss 0.4314 (0.7805) loss_zs_kd 0.4480 (0.4060) loss_oracle 0.5477 (0.4727) acc 56.2500 (49.6540) kd_loss 0.9588 (0.8694) lr 1.3090e-03 eta 0:12:55
epoch [22/50] batch [300/319] time 0.083 (0.086) data 0.000 (0.002) loss 1.5436 (1.4585) ce_loss 1.4160 (1.3245) teacher_loss 0.8225 (0.7783) loss_zs_kd 0.5024 (0.4087) loss_oracle 0.4700 (0.4758) acc 50.0000 (49.4583) kd_loss 0.8743 (0.8719) lr 1.3090e-03 eta 0:12:50
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,168
* accuracy: 49.5%
* error: 50.5%
* macro_f1: 39.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,738
* accuracy: 38.4%
* error: 61.6%
* macro_f1: 15.5%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [23/50] batch [20/319] time 0.083 (0.114) data 0.000 (0.027) loss 1.7014 (1.4277) ce_loss 1.4795 (1.3465) teacher_loss 0.9610 (0.7163) loss_zs_kd 0.3966 (0.4293) loss_oracle 0.5421 (0.4967) acc 40.6250 (47.0312) kd_loss 0.8178 (0.9051) lr 1.2487e-03 eta 0:16:56
epoch [23/50] batch [40/319] time 0.082 (0.098) data 0.000 (0.013) loss 1.4798 (1.4357) ce_loss 1.3955 (1.3503) teacher_loss 0.6916 (0.7268) loss_zs_kd 0.4655 (0.4202) loss_oracle 0.5555 (0.4988) acc 53.1250 (47.9688) kd_loss 0.9335 (0.9088) lr 1.2487e-03 eta 0:14:33
epoch [23/50] batch [60/319] time 0.085 (0.092) data 0.000 (0.009) loss 1.5696 (1.4242) ce_loss 1.3818 (1.3372) teacher_loss 0.8678 (0.7119) loss_zs_kd 0.4778 (0.4272) loss_oracle 0.4629 (0.4987) acc 43.7500 (49.2708) kd_loss 0.8176 (0.9143) lr 1.2487e-03 eta 0:13:39
epoch [23/50] batch [80/319] time 0.091 (0.091) data 0.000 (0.007) loss 1.3946 (1.4255) ce_loss 1.3096 (1.3336) teacher_loss 0.6434 (0.7139) loss_zs_kd 0.4348 (0.4274) loss_oracle 0.5338 (0.4978) acc 50.0000 (49.3750) kd_loss 0.8758 (0.9097) lr 1.2487e-03 eta 0:13:22
epoch [23/50] batch [100/319] time 0.075 (0.090) data 0.000 (0.006) loss 1.4656 (1.4359) ce_loss 1.3828 (1.3410) teacher_loss 0.7348 (0.7203) loss_zs_kd 0.4396 (0.4313) loss_oracle 0.5110 (0.4999) acc 56.2500 (49.1250) kd_loss 1.0078 (0.9059) lr 1.2487e-03 eta 0:13:10
epoch [23/50] batch [120/319] time 0.081 (0.087) data 0.000 (0.005) loss 1.4656 (1.4338) ce_loss 1.3154 (1.3342) teacher_loss 0.7518 (0.7216) loss_zs_kd 0.3844 (0.4284) loss_oracle 0.5215 (0.4979) acc 50.0000 (49.2448) kd_loss 0.9055 (0.9043) lr 1.2487e-03 eta 0:12:45
epoch [23/50] batch [140/319] time 0.073 (0.085) data 0.000 (0.004) loss 1.3517 (1.4334) ce_loss 1.4297 (1.3351) teacher_loss 0.5808 (0.7229) loss_zs_kd 0.3948 (0.4269) loss_oracle 0.5735 (0.4971) acc 40.6250 (49.3750) kd_loss 0.9359 (0.9020) lr 1.2487e-03 eta 0:12:31
epoch [23/50] batch [160/319] time 0.085 (0.085) data 0.000 (0.004) loss 1.3416 (1.4406) ce_loss 1.1270 (1.3440) teacher_loss 0.5795 (0.7273) loss_zs_kd 0.4782 (0.4280) loss_oracle 0.5230 (0.4993) acc 56.2500 (49.1406) kd_loss 0.8753 (0.9029) lr 1.2487e-03 eta 0:12:25
epoch [23/50] batch [180/319] time 0.085 (0.085) data 0.000 (0.003) loss 1.4432 (1.4412) ce_loss 1.4756 (1.3452) teacher_loss 0.7806 (0.7281) loss_zs_kd 0.4332 (0.4295) loss_oracle 0.4459 (0.4984) acc 43.7500 (49.1667) kd_loss 0.8582 (0.9033) lr 1.2487e-03 eta 0:12:24
epoch [23/50] batch [200/319] time 0.085 (0.085) data 0.000 (0.003) loss 1.0656 (1.4412) ce_loss 0.9619 (1.3450) teacher_loss 0.4549 (0.7293) loss_zs_kd 0.3227 (0.4307) loss_oracle 0.4493 (0.4965) acc 59.3750 (49.1406) kd_loss 0.8523 (0.9030) lr 1.2487e-03 eta 0:12:22
epoch [23/50] batch [220/319] time 0.082 (0.085) data 0.000 (0.003) loss 1.5893 (1.4427) ce_loss 1.5508 (1.3477) teacher_loss 0.7939 (0.7305) loss_zs_kd 0.4700 (0.4309) loss_oracle 0.5605 (0.4968) acc 50.0000 (49.0341) kd_loss 0.9564 (0.9044) lr 1.2487e-03 eta 0:12:21
epoch [23/50] batch [240/319] time 0.077 (0.085) data 0.000 (0.002) loss 1.2994 (1.4470) ce_loss 1.4551 (1.3530) teacher_loss 0.5853 (0.7351) loss_zs_kd 0.4178 (0.4306) loss_oracle 0.5052 (0.4965) acc 46.8750 (49.1797) kd_loss 0.9205 (0.9037) lr 1.2487e-03 eta 0:12:20
epoch [23/50] batch [260/319] time 0.080 (0.085) data 0.000 (0.002) loss 1.4333 (1.4473) ce_loss 1.4043 (1.3534) teacher_loss 0.7069 (0.7347) loss_zs_kd 0.4386 (0.4319) loss_oracle 0.5072 (0.4966) acc 43.7500 (49.3269) kd_loss 0.9088 (0.9042) lr 1.2487e-03 eta 0:12:15
epoch [23/50] batch [280/319] time 0.081 (0.084) data 0.000 (0.002) loss 1.2792 (1.4462) ce_loss 1.2578 (1.3528) teacher_loss 0.5636 (0.7342) loss_zs_kd 0.4512 (0.4327) loss_oracle 0.4900 (0.4956) acc 50.0000 (49.3862) kd_loss 0.9336 (0.9034) lr 1.2487e-03 eta 0:12:10
epoch [23/50] batch [300/319] time 0.085 (0.084) data 0.000 (0.002) loss 1.4802 (1.4444) ce_loss 1.4238 (1.3534) teacher_loss 0.7724 (0.7334) loss_zs_kd 0.4436 (0.4317) loss_oracle 0.4860 (0.4952) acc 46.8750 (49.4688) kd_loss 0.9518 (0.9034) lr 1.2487e-03 eta 0:12:07
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,089
* accuracy: 47.7%
* error: 52.3%
* macro_f1: 37.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,538
* accuracy: 36.3%
* error: 63.7%
* macro_f1: 14.7%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [24/50] batch [20/319] time 0.078 (0.119) data 0.000 (0.027) loss 1.3712 (1.4766) ce_loss 1.3066 (1.4000) teacher_loss 0.6539 (0.7845) loss_zs_kd 0.4777 (0.4343) loss_oracle 0.4785 (0.4749) acc 50.0000 (47.8125) kd_loss 0.9801 (0.9042) lr 1.1874e-03 eta 0:16:59
epoch [24/50] batch [40/319] time 0.075 (0.100) data 0.000 (0.013) loss 1.7978 (1.4538) ce_loss 1.5186 (1.3801) teacher_loss 1.1443 (0.7598) loss_zs_kd 0.3638 (0.4257) loss_oracle 0.4717 (0.4812) acc 46.8750 (48.6719) kd_loss 0.7699 (0.9124) lr 1.1874e-03 eta 0:14:20
epoch [24/50] batch [60/319] time 0.077 (0.094) data 0.001 (0.009) loss 1.6048 (1.4674) ce_loss 1.4863 (1.3917) teacher_loss 0.8834 (0.7831) loss_zs_kd 0.4856 (0.4172) loss_oracle 0.4787 (0.4756) acc 40.6250 (47.8125) kd_loss 0.8297 (0.9014) lr 1.1874e-03 eta 0:13:28
epoch [24/50] batch [80/319] time 0.084 (0.092) data 0.000 (0.007) loss 1.5116 (1.4560) ce_loss 1.5137 (1.3826) teacher_loss 0.7270 (0.7697) loss_zs_kd 0.5347 (0.4185) loss_oracle 0.5172 (0.4771) acc 43.7500 (48.3594) kd_loss 0.8637 (0.9026) lr 1.1874e-03 eta 0:13:03
epoch [24/50] batch [100/319] time 0.076 (0.090) data 0.000 (0.006) loss 1.7760 (1.4528) ce_loss 1.6758 (1.3708) teacher_loss 0.9744 (0.7616) loss_zs_kd 0.4947 (0.4208) loss_oracle 0.5543 (0.4808) acc 34.3750 (48.5312) kd_loss 0.9076 (0.9043) lr 1.1874e-03 eta 0:12:48
epoch [24/50] batch [120/319] time 0.068 (0.088) data 0.000 (0.005) loss 1.4039 (1.4577) ce_loss 1.3008 (1.3781) teacher_loss 0.7820 (0.7671) loss_zs_kd 0.4538 (0.4215) loss_oracle 0.3950 (0.4798) acc 59.3750 (48.1250) kd_loss 0.8794 (0.9050) lr 1.1874e-03 eta 0:12:27
epoch [24/50] batch [140/319] time 0.097 (0.086) data 0.000 (0.004) loss 1.4322 (1.4547) ce_loss 1.1826 (1.3753) teacher_loss 0.6852 (0.7648) loss_zs_kd 0.4525 (0.4175) loss_oracle 0.5207 (0.4812) acc 59.3750 (48.6161) kd_loss 1.0555 (0.9082) lr 1.1874e-03 eta 0:12:12
epoch [24/50] batch [160/319] time 0.084 (0.086) data 0.000 (0.004) loss 1.5174 (1.4490) ce_loss 1.5352 (1.3670) teacher_loss 0.7249 (0.7553) loss_zs_kd 0.3909 (0.4181) loss_oracle 0.5971 (0.4848) acc 34.3750 (49.0430) kd_loss 0.8677 (0.9109) lr 1.1874e-03 eta 0:12:07
epoch [24/50] batch [180/319] time 0.080 (0.086) data 0.000 (0.003) loss 1.6029 (1.4549) ce_loss 1.6445 (1.3694) teacher_loss 0.8470 (0.7563) loss_zs_kd 0.3946 (0.4205) loss_oracle 0.5586 (0.4883) acc 43.7500 (48.8194) kd_loss 0.9629 (0.9143) lr 1.1874e-03 eta 0:12:04
epoch [24/50] batch [200/319] time 0.076 (0.086) data 0.000 (0.003) loss 1.4799 (1.4521) ce_loss 1.3115 (1.3659) teacher_loss 0.6597 (0.7501) loss_zs_kd 0.4248 (0.4222) loss_oracle 0.6078 (0.4909) acc 53.1250 (49.0156) kd_loss 1.0118 (0.9163) lr 1.1874e-03 eta 0:12:00
epoch [24/50] batch [220/319] time 0.095 (0.086) data 0.000 (0.003) loss 1.4967 (1.4506) ce_loss 1.2568 (1.3648) teacher_loss 0.7987 (0.7478) loss_zs_kd 0.4200 (0.4230) loss_oracle 0.4881 (0.4913) acc 46.8750 (49.0909) kd_loss 0.9064 (0.9190) lr 1.1874e-03 eta 0:11:58
epoch [24/50] batch [240/319] time 0.082 (0.086) data 0.000 (0.002) loss 1.5648 (1.4494) ce_loss 1.4941 (1.3611) teacher_loss 0.8938 (0.7458) loss_zs_kd 0.4759 (0.4238) loss_oracle 0.4330 (0.4916) acc 37.5000 (49.1016) kd_loss 0.8671 (0.9180) lr 1.1874e-03 eta 0:11:57
epoch [24/50] batch [260/319] time 0.086 (0.085) data 0.000 (0.002) loss 1.6622 (1.4512) ce_loss 1.7080 (1.3643) teacher_loss 0.8954 (0.7457) loss_zs_kd 0.3907 (0.4238) loss_oracle 0.5715 (0.4936) acc 40.6250 (49.2188) kd_loss 0.8955 (0.9168) lr 1.1874e-03 eta 0:11:52
epoch [24/50] batch [280/319] time 0.088 (0.085) data 0.000 (0.002) loss 1.5004 (1.4520) ce_loss 1.4043 (1.3655) teacher_loss 0.8044 (0.7462) loss_zs_kd 0.4183 (0.4244) loss_oracle 0.4868 (0.4936) acc 34.3750 (49.1741) kd_loss 0.8385 (0.9149) lr 1.1874e-03 eta 0:11:50
epoch [24/50] batch [300/319] time 0.081 (0.085) data 0.000 (0.002) loss 1.2657 (1.4484) ce_loss 1.1836 (1.3648) teacher_loss 0.5829 (0.7450) loss_zs_kd 0.4306 (0.4230) loss_oracle 0.4675 (0.4918) acc 56.2500 (49.2604) kd_loss 0.9771 (0.9162) lr 1.1874e-03 eta 0:11:47
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,195
* accuracy: 50.1%
* error: 49.9%
* macro_f1: 37.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,684
* accuracy: 37.8%
* error: 62.2%
* macro_f1: 15.1%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [25/50] batch [20/319] time 0.090 (0.120) data 0.000 (0.034) loss 1.3933 (1.4603) ce_loss 1.3535 (1.3914) teacher_loss 0.7261 (0.7485) loss_zs_kd 0.4231 (0.4213) loss_oracle 0.4556 (0.5012) acc 53.1250 (49.6875) kd_loss 0.8966 (0.9168) lr 1.1253e-03 eta 0:16:33
epoch [25/50] batch [40/319] time 0.085 (0.102) data 0.000 (0.017) loss 1.4762 (1.4622) ce_loss 1.3545 (1.3894) teacher_loss 0.8524 (0.7652) loss_zs_kd 0.4116 (0.4143) loss_oracle 0.4179 (0.4899) acc 43.7500 (48.8281) kd_loss 0.9185 (0.9149) lr 1.1253e-03 eta 0:14:04
epoch [25/50] batch [60/319] time 0.078 (0.095) data 0.000 (0.011) loss 1.5728 (1.4516) ce_loss 1.7051 (1.3875) teacher_loss 0.7871 (0.7582) loss_zs_kd 0.4650 (0.4144) loss_oracle 0.5532 (0.4862) acc 34.3750 (48.5417) kd_loss 1.0269 (0.9084) lr 1.1253e-03 eta 0:13:05
epoch [25/50] batch [80/319] time 0.088 (0.092) data 0.000 (0.009) loss 1.3714 (1.4495) ce_loss 1.1279 (1.3821) teacher_loss 0.6724 (0.7559) loss_zs_kd 0.4197 (0.4156) loss_oracle 0.4892 (0.4858) acc 56.2500 (48.9453) kd_loss 0.9193 (0.9099) lr 1.1253e-03 eta 0:12:34
epoch [25/50] batch [100/319] time 0.084 (0.090) data 0.000 (0.007) loss 1.6870 (1.4398) ce_loss 1.4180 (1.3647) teacher_loss 0.9471 (0.7489) loss_zs_kd 0.4370 (0.4135) loss_oracle 0.5213 (0.4841) acc 53.1250 (49.6250) kd_loss 0.8349 (0.9147) lr 1.1253e-03 eta 0:12:19
epoch [25/50] batch [120/319] time 0.089 (0.090) data 0.000 (0.006) loss 1.4008 (1.4452) ce_loss 1.3652 (1.3727) teacher_loss 0.6786 (0.7569) loss_zs_kd 0.4843 (0.4116) loss_oracle 0.4801 (0.4826) acc 53.1250 (49.5573) kd_loss 0.9457 (0.9148) lr 1.1253e-03 eta 0:12:12
epoch [25/50] batch [140/319] time 0.087 (0.089) data 0.000 (0.005) loss 1.3749 (1.4403) ce_loss 1.4902 (1.3708) teacher_loss 0.5851 (0.7549) loss_zs_kd 0.4561 (0.4097) loss_oracle 0.5617 (0.4806) acc 46.8750 (49.6205) kd_loss 0.9910 (0.9158) lr 1.1253e-03 eta 0:12:05
epoch [25/50] batch [160/319] time 0.078 (0.088) data 0.000 (0.004) loss 1.5465 (1.4399) ce_loss 1.5557 (1.3756) teacher_loss 0.8332 (0.7550) loss_zs_kd 0.4385 (0.4111) loss_oracle 0.4940 (0.4794) acc 34.3750 (49.4727) kd_loss 0.8551 (0.9149) lr 1.1253e-03 eta 0:11:57
epoch [25/50] batch [180/319] time 0.079 (0.087) data 0.000 (0.004) loss 1.3040 (1.4350) ce_loss 1.2822 (1.3735) teacher_loss 0.6973 (0.7537) loss_zs_kd 0.3890 (0.4103) loss_oracle 0.4122 (0.4762) acc 46.8750 (49.4444) kd_loss 0.8591 (0.9149) lr 1.1253e-03 eta 0:11:42
epoch [25/50] batch [200/319] time 0.088 (0.086) data 0.000 (0.004) loss 1.4726 (1.4331) ce_loss 1.3828 (1.3700) teacher_loss 0.7886 (0.7497) loss_zs_kd 0.4312 (0.4128) loss_oracle 0.4684 (0.4770) acc 43.7500 (49.4219) kd_loss 0.8836 (0.9160) lr 1.1253e-03 eta 0:11:38
epoch [25/50] batch [220/319] time 0.080 (0.086) data 0.000 (0.003) loss 1.3956 (1.4351) ce_loss 1.3086 (1.3740) teacher_loss 0.6565 (0.7513) loss_zs_kd 0.4080 (0.4126) loss_oracle 0.5351 (0.4775) acc 50.0000 (49.2756) kd_loss 1.0158 (0.9170) lr 1.1253e-03 eta 0:11:35
epoch [25/50] batch [240/319] time 0.083 (0.085) data 0.000 (0.003) loss 1.5654 (1.4304) ce_loss 1.4873 (1.3682) teacher_loss 0.9065 (0.7458) loss_zs_kd 0.4517 (0.4143) loss_oracle 0.4331 (0.4774) acc 31.2500 (49.2578) kd_loss 0.8310 (0.9177) lr 1.1253e-03 eta 0:11:27
epoch [25/50] batch [260/319] time 0.077 (0.085) data 0.000 (0.003) loss 1.5279 (1.4314) ce_loss 1.5088 (1.3691) teacher_loss 0.7844 (0.7463) loss_zs_kd 0.4625 (0.4152) loss_oracle 0.5123 (0.4776) acc 40.6250 (49.1466) kd_loss 0.8935 (0.9172) lr 1.1253e-03 eta 0:11:22
epoch [25/50] batch [280/319] time 0.096 (0.085) data 0.000 (0.003) loss 1.5563 (1.4307) ce_loss 1.4287 (1.3693) teacher_loss 0.8926 (0.7457) loss_zs_kd 0.4296 (0.4153) loss_oracle 0.4489 (0.4773) acc 59.3750 (49.1853) kd_loss 0.8995 (0.9155) lr 1.1253e-03 eta 0:11:18
epoch [25/50] batch [300/319] time 0.077 (0.085) data 0.000 (0.002) loss 1.4374 (1.4313) ce_loss 1.4941 (1.3710) teacher_loss 0.8036 (0.7487) loss_zs_kd 0.3574 (0.4137) loss_oracle 0.4551 (0.4757) acc 56.2500 (49.3333) kd_loss 0.8942 (0.9154) lr 1.1253e-03 eta 0:11:16
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,169
* accuracy: 49.5%
* error: 50.5%
* macro_f1: 37.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,817
* accuracy: 39.2%
* error: 60.8%
* macro_f1: 15.1%
******* Domain 2 best val acc:      50.9%, epoch: 6 *******
******* Domain 2 best val test acc: 42.8%, epoch: 6 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [26/50] batch [20/319] time 0.080 (0.119) data 0.000 (0.028) loss 1.4326 (1.4931) ce_loss 1.3936 (1.4305) teacher_loss 0.8585 (0.7991) loss_zs_kd 0.3538 (0.4191) loss_oracle 0.3972 (0.4844) acc 50.0000 (47.1875) kd_loss 0.8613 (0.8895) lr 1.0628e-03 eta 0:15:50
epoch [26/50] batch [40/319] time 0.096 (0.103) data 0.000 (0.014) loss 1.4100 (1.4555) ce_loss 1.2168 (1.4117) teacher_loss 0.7379 (0.7632) loss_zs_kd 0.4302 (0.4112) loss_oracle 0.4571 (0.4867) acc 56.2500 (47.5781) kd_loss 0.9366 (0.8995) lr 1.0628e-03 eta 0:13:38
epoch [26/50] batch [60/319] time 0.089 (0.097) data 0.000 (0.010) loss 1.4140 (1.4378) ce_loss 1.3408 (1.3880) teacher_loss 0.7339 (0.7423) loss_zs_kd 0.3855 (0.4148) loss_oracle 0.4873 (0.4881) acc 50.0000 (48.8021) kd_loss 0.8708 (0.9062) lr 1.0628e-03 eta 0:12:47
epoch [26/50] batch [80/319] time 0.080 (0.093) data 0.000 (0.007) loss 1.5600 (1.4430) ce_loss 1.4414 (1.3960) teacher_loss 0.8111 (0.7464) loss_zs_kd 0.4901 (0.4165) loss_oracle 0.5037 (0.4884) acc 56.2500 (48.4766) kd_loss 0.9794 (0.9077) lr 1.0628e-03 eta 0:12:12
epoch [26/50] batch [100/319] time 0.078 (0.090) data 0.000 (0.006) loss 1.3117 (1.4405) ce_loss 1.2627 (1.3921) teacher_loss 0.5887 (0.7425) loss_zs_kd 0.4306 (0.4206) loss_oracle 0.5077 (0.4877) acc 56.2500 (48.8750) kd_loss 0.9099 (0.9064) lr 1.0628e-03 eta 0:11:52
epoch [26/50] batch [120/319] time 0.074 (0.089) data 0.000 (0.005) loss 1.5155 (1.4352) ce_loss 1.3701 (1.3815) teacher_loss 0.8771 (0.7424) loss_zs_kd 0.4055 (0.4188) loss_oracle 0.4356 (0.4834) acc 40.6250 (49.4531) kd_loss 0.8691 (0.9031) lr 1.0628e-03 eta 0:11:38
epoch [26/50] batch [140/319] time 0.088 (0.088) data 0.000 (0.004) loss 1.4200 (1.4292) ce_loss 1.4922 (1.3728) teacher_loss 0.8080 (0.7425) loss_zs_kd 0.3870 (0.4144) loss_oracle 0.4185 (0.4795) acc 43.7500 (49.5982) kd_loss 0.8910 (0.9005) lr 1.0628e-03 eta 0:11:32
epoch [26/50] batch [160/319] time 0.079 (0.088) data 0.000 (0.004) loss 1.1854 (1.4244) ce_loss 1.1221 (1.3646) teacher_loss 0.5493 (0.7413) loss_zs_kd 0.4034 (0.4109) loss_oracle 0.4345 (0.4776) acc 62.5000 (49.5312) kd_loss 0.8814 (0.8988) lr 1.0628e-03 eta 0:11:25
epoch [26/50] batch [180/319] time 0.083 (0.087) data 0.000 (0.003) loss 1.2905 (1.4260) ce_loss 1.2666 (1.3616) teacher_loss 0.6689 (0.7447) loss_zs_kd 0.3748 (0.4098) loss_oracle 0.4342 (0.4764) acc 59.3750 (49.5486) kd_loss 0.9258 (0.8964) lr 1.0628e-03 eta 0:11:20
epoch [26/50] batch [200/319] time 0.081 (0.087) data 0.001 (0.003) loss 1.7602 (1.4277) ce_loss 1.4570 (1.3616) teacher_loss 1.0607 (0.7468) loss_zs_kd 0.3770 (0.4089) loss_oracle 0.5110 (0.4764) acc 43.7500 (49.5312) kd_loss 0.8254 (0.8954) lr 1.0628e-03 eta 0:11:13
epoch [26/50] batch [220/319] time 0.087 (0.087) data 0.000 (0.003) loss 1.2141 (1.4326) ce_loss 1.0596 (1.3617) teacher_loss 0.6488 (0.7500) loss_zs_kd 0.2965 (0.4095) loss_oracle 0.4170 (0.4779) acc 59.3750 (49.3608) kd_loss 0.9155 (0.8945) lr 1.0628e-03 eta 0:11:14
epoch [26/50] batch [240/319] time 0.085 (0.087) data 0.000 (0.003) loss 1.4110 (1.4333) ce_loss 1.2549 (1.3617) teacher_loss 0.7992 (0.7536) loss_zs_kd 0.3907 (0.4063) loss_oracle 0.4164 (0.4765) acc 65.6250 (49.4271) kd_loss 0.8769 (0.8930) lr 1.0628e-03 eta 0:11:10
epoch [26/50] batch [260/319] time 0.084 (0.086) data 0.000 (0.002) loss 1.2919 (1.4346) ce_loss 1.1631 (1.3617) teacher_loss 0.7119 (0.7539) loss_zs_kd 0.3659 (0.4054) loss_oracle 0.3970 (0.4780) acc 56.2500 (49.5553) kd_loss 0.8167 (0.8919) lr 1.0628e-03 eta 0:11:06
epoch [26/50] batch [280/319] time 0.088 (0.086) data 0.000 (0.002) loss 1.3452 (1.4385) ce_loss 1.1318 (1.3634) teacher_loss 0.7462 (0.7580) loss_zs_kd 0.3581 (0.4053) loss_oracle 0.4200 (0.4779) acc 62.5000 (49.5759) kd_loss 0.7862 (0.8893) lr 1.0628e-03 eta 0:11:03
epoch [26/50] batch [300/319] time 0.083 (0.086) data 0.000 (0.002) loss 1.8847 (1.4425) ce_loss 1.9346 (1.3658) teacher_loss 1.2120 (0.7626) loss_zs_kd 0.3938 (0.4038) loss_oracle 0.4758 (0.4779) acc 31.2500 (49.4375) kd_loss 0.8961 (0.8880) lr 1.0628e-03 eta 0:11:01
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,255
* accuracy: 51.5%
* error: 48.5%
* macro_f1: 39.1%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,819
* accuracy: 39.2%
* error: 60.8%
* macro_f1: 14.9%
******* Domain 2 best val acc:      51.5%, epoch: 26 *******
******* Domain 2 best val test acc: 39.2%, epoch: 26 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [27/50] batch [20/319] time 0.081 (0.118) data 0.000 (0.031) loss 1.1905 (1.4494) ce_loss 1.1777 (1.3551) teacher_loss 0.6318 (0.8019) loss_zs_kd 0.3247 (0.3726) loss_oracle 0.3964 (0.4611) acc 59.3750 (50.0000) kd_loss 0.8778 (0.8485) lr 1.0000e-03 eta 0:15:00
epoch [27/50] batch [40/319] time 0.091 (0.100) data 0.001 (0.016) loss 1.3316 (1.4509) ce_loss 1.3730 (1.3665) teacher_loss 0.5967 (0.7968) loss_zs_kd 0.4318 (0.3808) loss_oracle 0.5190 (0.4637) acc 56.2500 (49.7656) kd_loss 0.9250 (0.8568) lr 1.0000e-03 eta 0:12:43
epoch [27/50] batch [60/319] time 0.079 (0.095) data 0.000 (0.011) loss 1.4303 (1.4275) ce_loss 1.1436 (1.3388) teacher_loss 0.7331 (0.7684) loss_zs_kd 0.4505 (0.3897) loss_oracle 0.4720 (0.4642) acc 59.3750 (51.1979) kd_loss 0.8024 (0.8585) lr 1.0000e-03 eta 0:11:58
epoch [27/50] batch [80/319] time 0.077 (0.090) data 0.000 (0.008) loss 1.5840 (1.4241) ce_loss 1.5801 (1.3304) teacher_loss 0.9251 (0.7637) loss_zs_kd 0.4287 (0.3879) loss_oracle 0.4446 (0.4664) acc 40.6250 (51.6797) kd_loss 0.8580 (0.8648) lr 1.0000e-03 eta 0:11:20
epoch [27/50] batch [100/319] time 0.086 (0.089) data 0.000 (0.006) loss 1.4525 (1.4289) ce_loss 1.3496 (1.3289) teacher_loss 0.7507 (0.7631) loss_zs_kd 0.4007 (0.3892) loss_oracle 0.5015 (0.4712) acc 50.0000 (51.2188) kd_loss 0.9133 (0.8675) lr 1.0000e-03 eta 0:11:09
epoch [27/50] batch [120/319] time 0.086 (0.088) data 0.000 (0.005) loss 1.3792 (1.4313) ce_loss 1.1387 (1.3360) teacher_loss 0.7271 (0.7634) loss_zs_kd 0.4516 (0.3947) loss_oracle 0.4263 (0.4706) acc 62.5000 (51.1198) kd_loss 0.8862 (0.8724) lr 1.0000e-03 eta 0:11:05
epoch [27/50] batch [140/319] time 0.083 (0.088) data 0.000 (0.005) loss 1.2819 (1.4289) ce_loss 1.2334 (1.3373) teacher_loss 0.6506 (0.7612) loss_zs_kd 0.3761 (0.3960) loss_oracle 0.4432 (0.4697) acc 53.1250 (50.9375) kd_loss 0.9334 (0.8723) lr 1.0000e-03 eta 0:11:01
epoch [27/50] batch [160/319] time 0.075 (0.087) data 0.000 (0.004) loss 1.2214 (1.4268) ce_loss 1.0527 (1.3408) teacher_loss 0.5866 (0.7560) loss_zs_kd 0.4127 (0.3987) loss_oracle 0.4285 (0.4714) acc 62.5000 (51.0938) kd_loss 0.9359 (0.8752) lr 1.0000e-03 eta 0:10:53
epoch [27/50] batch [180/319] time 0.080 (0.087) data 0.000 (0.004) loss 1.1848 (1.4282) ce_loss 1.0225 (1.3451) teacher_loss 0.5694 (0.7579) loss_zs_kd 0.3928 (0.3995) loss_oracle 0.4190 (0.4706) acc 65.6250 (50.8681) kd_loss 0.9193 (0.8771) lr 1.0000e-03 eta 0:10:50
epoch [27/50] batch [200/319] time 0.080 (0.086) data 0.000 (0.003) loss 1.2417 (1.4288) ce_loss 1.2881 (1.3479) teacher_loss 0.5558 (0.7555) loss_zs_kd 0.4637 (0.4022) loss_oracle 0.4541 (0.4721) acc 53.1250 (50.8281) kd_loss 0.9726 (0.8801) lr 1.0000e-03 eta 0:10:43
epoch [27/50] batch [220/319] time 0.080 (0.086) data 0.000 (0.003) loss 1.4124 (1.4265) ce_loss 1.3369 (1.3482) teacher_loss 0.7658 (0.7519) loss_zs_kd 0.4471 (0.4048) loss_oracle 0.4231 (0.4722) acc 43.7500 (50.7244) kd_loss 0.8530 (0.8827) lr 1.0000e-03 eta 0:10:39
epoch [27/50] batch [240/319] time 0.077 (0.086) data 0.000 (0.003) loss 1.4861 (1.4307) ce_loss 1.5654 (1.3563) teacher_loss 0.7959 (0.7519) loss_zs_kd 0.4377 (0.4071) loss_oracle 0.4714 (0.4753) acc 46.8750 (50.4557) kd_loss 0.8519 (0.8850) lr 1.0000e-03 eta 0:10:35
epoch [27/50] batch [260/319] time 0.068 (0.084) data 0.000 (0.003) loss 1.4337 (1.4295) ce_loss 1.3633 (1.3554) teacher_loss 0.6735 (0.7516) loss_zs_kd 0.4353 (0.4068) loss_oracle 0.5425 (0.4745) acc 50.0000 (50.4808) kd_loss 0.8649 (0.8857) lr 1.0000e-03 eta 0:10:24
epoch [27/50] batch [280/319] time 0.068 (0.083) data 0.000 (0.002) loss 1.6839 (1.4315) ce_loss 1.5557 (1.3576) teacher_loss 0.9789 (0.7540) loss_zs_kd 0.4658 (0.4073) loss_oracle 0.4720 (0.4739) acc 37.5000 (50.3348) kd_loss 0.8431 (0.8859) lr 1.0000e-03 eta 0:10:14
epoch [27/50] batch [300/319] time 0.071 (0.083) data 0.000 (0.002) loss 1.7769 (1.4284) ce_loss 1.8008 (1.3557) teacher_loss 1.0894 (0.7512) loss_zs_kd 0.4975 (0.4071) loss_oracle 0.4386 (0.4737) acc 37.5000 (50.1771) kd_loss 0.8644 (0.8869) lr 1.0000e-03 eta 0:10:07
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,241
* accuracy: 51.2%
* error: 48.8%
* macro_f1: 39.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,988
* accuracy: 41.0%
* error: 59.0%
* macro_f1: 16.0%
******* Domain 2 best val acc:      51.5%, epoch: 26 *******
******* Domain 2 best val test acc: 39.2%, epoch: 26 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [28/50] batch [20/319] time 0.074 (0.099) data 0.000 (0.032) loss 1.4087 (1.3996) ce_loss 1.2393 (1.3372) teacher_loss 0.7317 (0.7227) loss_zs_kd 0.4252 (0.4225) loss_oracle 0.4644 (0.4656) acc 53.1250 (49.8438) kd_loss 0.8525 (0.9167) lr 9.3721e-04 eta 0:12:07
epoch [28/50] batch [40/319] time 0.085 (0.093) data 0.000 (0.016) loss 1.5647 (1.3996) ce_loss 1.4854 (1.3338) teacher_loss 0.8360 (0.7353) loss_zs_kd 0.4204 (0.4060) loss_oracle 0.5185 (0.4614) acc 50.0000 (50.8594) kd_loss 0.8958 (0.9127) lr 9.3721e-04 eta 0:11:16
epoch [28/50] batch [60/319] time 0.087 (0.090) data 0.001 (0.011) loss 1.3640 (1.4344) ce_loss 1.1787 (1.3521) teacher_loss 0.6822 (0.7630) loss_zs_kd 0.4495 (0.4085) loss_oracle 0.4570 (0.4672) acc 65.6250 (49.9479) kd_loss 0.9419 (0.9093) lr 9.3721e-04 eta 0:10:51
epoch [28/50] batch [80/319] time 0.084 (0.088) data 0.000 (0.008) loss 1.4587 (1.4196) ce_loss 1.4658 (1.3393) teacher_loss 0.8071 (0.7482) loss_zs_kd 0.3990 (0.4064) loss_oracle 0.4522 (0.4682) acc 43.7500 (50.5859) kd_loss 0.9426 (0.9124) lr 9.3721e-04 eta 0:10:40
epoch [28/50] batch [100/319] time 0.074 (0.086) data 0.000 (0.007) loss 1.4867 (1.4258) ce_loss 1.3984 (1.3486) teacher_loss 0.7565 (0.7548) loss_zs_kd 0.4490 (0.4058) loss_oracle 0.5057 (0.4682) acc 46.8750 (50.0312) kd_loss 0.8797 (0.9146) lr 9.3721e-04 eta 0:10:23
epoch [28/50] batch [120/319] time 0.081 (0.086) data 0.000 (0.006) loss 1.4416 (1.4172) ce_loss 1.3555 (1.3404) teacher_loss 0.8251 (0.7470) loss_zs_kd 0.4516 (0.4058) loss_oracle 0.3907 (0.4673) acc 43.7500 (50.1823) kd_loss 0.7684 (0.9103) lr 9.3721e-04 eta 0:10:17
epoch [28/50] batch [140/319] time 0.092 (0.085) data 0.000 (0.005) loss 1.4315 (1.4157) ce_loss 1.3682 (1.3429) teacher_loss 0.6862 (0.7472) loss_zs_kd 0.4142 (0.4052) loss_oracle 0.5382 (0.4659) acc 43.7500 (50.0893) kd_loss 0.9562 (0.9116) lr 9.3721e-04 eta 0:10:11
epoch [28/50] batch [160/319] time 0.083 (0.085) data 0.000 (0.004) loss 1.3730 (1.4145) ce_loss 0.9990 (1.3423) teacher_loss 0.6302 (0.7440) loss_zs_kd 0.4641 (0.4064) loss_oracle 0.5107 (0.4673) acc 50.0000 (50.0000) kd_loss 0.9085 (0.9108) lr 9.3721e-04 eta 0:10:07
epoch [28/50] batch [180/319] time 0.089 (0.085) data 0.000 (0.004) loss 1.3852 (1.4065) ce_loss 1.1631 (1.3314) teacher_loss 0.7285 (0.7375) loss_zs_kd 0.3741 (0.4047) loss_oracle 0.4697 (0.4667) acc 59.3750 (50.5035) kd_loss 0.8035 (0.9109) lr 9.3721e-04 eta 0:10:06
epoch [28/50] batch [200/319] time 0.077 (0.085) data 0.000 (0.003) loss 1.5494 (1.4110) ce_loss 1.6025 (1.3343) teacher_loss 0.9178 (0.7426) loss_zs_kd 0.3878 (0.4045) loss_oracle 0.4377 (0.4662) acc 40.6250 (50.5625) kd_loss 0.8638 (0.9095) lr 9.3721e-04 eta 0:10:03
epoch [28/50] batch [220/319] time 0.082 (0.084) data 0.000 (0.003) loss 1.4996 (1.4154) ce_loss 1.4180 (1.3438) teacher_loss 0.8926 (0.7460) loss_zs_kd 0.3896 (0.4042) loss_oracle 0.4122 (0.4673) acc 50.0000 (50.1989) kd_loss 0.9049 (0.9109) lr 9.3721e-04 eta 0:09:59
epoch [28/50] batch [240/319] time 0.083 (0.084) data 0.000 (0.003) loss 1.4190 (1.4160) ce_loss 1.1514 (1.3413) teacher_loss 0.6882 (0.7455) loss_zs_kd 0.4375 (0.4053) loss_oracle 0.5120 (0.4679) acc 59.3750 (50.3255) kd_loss 0.9629 (0.9113) lr 9.3721e-04 eta 0:09:58
epoch [28/50] batch [260/319] time 0.078 (0.085) data 0.000 (0.003) loss 1.3291 (1.4144) ce_loss 1.2549 (1.3427) teacher_loss 0.5473 (0.7433) loss_zs_kd 0.4532 (0.4066) loss_oracle 0.5551 (0.4678) acc 53.1250 (50.2644) kd_loss 0.9993 (0.9124) lr 9.3721e-04 eta 0:09:58
epoch [28/50] batch [280/319] time 0.085 (0.084) data 0.000 (0.003) loss 1.3979 (1.4154) ce_loss 1.4609 (1.3439) teacher_loss 0.7629 (0.7436) loss_zs_kd 0.3730 (0.4061) loss_oracle 0.4485 (0.4687) acc 40.6250 (50.2344) kd_loss 0.9064 (0.9144) lr 9.3721e-04 eta 0:09:55
epoch [28/50] batch [300/319] time 0.084 (0.084) data 0.000 (0.002) loss 1.4823 (1.4172) ce_loss 1.4678 (1.3450) teacher_loss 0.7878 (0.7450) loss_zs_kd 0.4346 (0.4058) loss_oracle 0.4773 (0.4692) acc 59.3750 (50.3229) kd_loss 0.8787 (0.9138) lr 9.3721e-04 eta 0:09:53
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,216
* accuracy: 50.6%
* error: 49.4%
* macro_f1: 38.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,709
* accuracy: 38.1%
* error: 61.9%
* macro_f1: 15.5%
******* Domain 2 best val acc:      51.5%, epoch: 26 *******
******* Domain 2 best val test acc: 39.2%, epoch: 26 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [29/50] batch [20/319] time 0.079 (0.107) data 0.000 (0.025) loss 1.6493 (1.3815) ce_loss 1.6680 (1.3213) teacher_loss 0.8970 (0.7287) loss_zs_kd 0.4307 (0.3934) loss_oracle 0.5370 (0.4561) acc 37.5000 (53.5938) kd_loss 0.8780 (0.8979) lr 8.7467e-04 eta 0:12:28
epoch [29/50] batch [40/319] time 0.079 (0.094) data 0.000 (0.013) loss 1.3290 (1.4043) ce_loss 1.4004 (1.3364) teacher_loss 0.7061 (0.7480) loss_zs_kd 0.3915 (0.3907) loss_oracle 0.4271 (0.4609) acc 56.2500 (52.1875) kd_loss 1.0047 (0.9134) lr 8.7467e-04 eta 0:10:55
epoch [29/50] batch [60/319] time 0.085 (0.089) data 0.000 (0.009) loss 1.3014 (1.4101) ce_loss 1.1660 (1.3416) teacher_loss 0.5977 (0.7447) loss_zs_kd 0.4067 (0.3951) loss_oracle 0.5004 (0.4678) acc 56.2500 (51.5104) kd_loss 0.9286 (0.9156) lr 8.7467e-04 eta 0:10:18
epoch [29/50] batch [80/319] time 0.084 (0.088) data 0.000 (0.006) loss 1.3539 (1.4138) ce_loss 1.2539 (1.3463) teacher_loss 0.7120 (0.7496) loss_zs_kd 0.4201 (0.3990) loss_oracle 0.4319 (0.4647) acc 46.8750 (50.9375) kd_loss 0.9230 (0.9114) lr 8.7467e-04 eta 0:10:08
epoch [29/50] batch [100/319] time 0.081 (0.087) data 0.000 (0.005) loss 1.5763 (1.4128) ce_loss 1.4521 (1.3480) teacher_loss 0.8895 (0.7511) loss_zs_kd 0.4066 (0.3977) loss_oracle 0.4835 (0.4628) acc 40.6250 (50.3750) kd_loss 0.8763 (0.9093) lr 8.7467e-04 eta 0:10:00
epoch [29/50] batch [120/319] time 0.088 (0.087) data 0.000 (0.004) loss 1.3266 (1.4116) ce_loss 1.3398 (1.3477) teacher_loss 0.7284 (0.7539) loss_zs_kd 0.3314 (0.3935) loss_oracle 0.4325 (0.4610) acc 56.2500 (50.4688) kd_loss 0.9352 (0.9056) lr 8.7467e-04 eta 0:09:59
epoch [29/50] batch [140/319] time 0.089 (0.087) data 0.000 (0.004) loss 1.5528 (1.4097) ce_loss 1.4844 (1.3443) teacher_loss 0.8839 (0.7549) loss_zs_kd 0.3840 (0.3911) loss_oracle 0.4769 (0.4593) acc 50.0000 (50.8036) kd_loss 0.9744 (0.9068) lr 8.7467e-04 eta 0:09:55
epoch [29/50] batch [160/319] time 0.081 (0.086) data 0.000 (0.003) loss 1.3563 (1.4183) ce_loss 1.3105 (1.3508) teacher_loss 0.7560 (0.7624) loss_zs_kd 0.3287 (0.3906) loss_oracle 0.4360 (0.4605) acc 53.1250 (50.4297) kd_loss 0.9647 (0.9033) lr 8.7467e-04 eta 0:09:52
epoch [29/50] batch [180/319] time 0.083 (0.086) data 0.001 (0.003) loss 1.4716 (1.4235) ce_loss 1.5518 (1.3553) teacher_loss 0.8396 (0.7652) loss_zs_kd 0.3524 (0.3907) loss_oracle 0.4558 (0.4629) acc 56.2500 (50.2951) kd_loss 0.8696 (0.9032) lr 8.7467e-04 eta 0:09:46
epoch [29/50] batch [200/319] time 0.079 (0.086) data 0.000 (0.003) loss 1.6280 (1.4305) ce_loss 1.5576 (1.3634) teacher_loss 0.8310 (0.7691) loss_zs_kd 0.4310 (0.3925) loss_oracle 0.5816 (0.4651) acc 43.7500 (50.1562) kd_loss 0.9272 (0.9020) lr 8.7467e-04 eta 0:09:43
epoch [29/50] batch [220/319] time 0.084 (0.085) data 0.000 (0.003) loss 1.7076 (1.4290) ce_loss 1.8047 (1.3626) teacher_loss 0.9713 (0.7680) loss_zs_kd 0.3907 (0.3909) loss_oracle 0.5409 (0.4655) acc 31.2500 (50.0710) kd_loss 0.7689 (0.9008) lr 8.7467e-04 eta 0:09:37
epoch [29/50] batch [240/319] time 0.081 (0.085) data 0.000 (0.002) loss 1.6202 (1.4305) ce_loss 1.2695 (1.3609) teacher_loss 1.0004 (0.7688) loss_zs_kd 0.4811 (0.3925) loss_oracle 0.3793 (0.4654) acc 56.2500 (50.2474) kd_loss 0.8323 (0.9001) lr 8.7467e-04 eta 0:09:34
epoch [29/50] batch [260/319] time 0.084 (0.085) data 0.000 (0.002) loss 1.4282 (1.4330) ce_loss 1.1943 (1.3634) teacher_loss 0.7245 (0.7709) loss_zs_kd 0.4186 (0.3922) loss_oracle 0.4944 (0.4659) acc 53.1250 (50.0601) kd_loss 0.9303 (0.9002) lr 8.7467e-04 eta 0:09:33
epoch [29/50] batch [280/319] time 0.084 (0.085) data 0.001 (0.002) loss 1.4275 (1.4342) ce_loss 1.5312 (1.3659) teacher_loss 0.6931 (0.7700) loss_zs_kd 0.3963 (0.3933) loss_oracle 0.5362 (0.4676) acc 34.3750 (49.8438) kd_loss 0.8854 (0.9014) lr 8.7467e-04 eta 0:09:31
epoch [29/50] batch [300/319] time 0.088 (0.085) data 0.000 (0.002) loss 1.4926 (1.4354) ce_loss 1.6396 (1.3669) teacher_loss 0.8012 (0.7703) loss_zs_kd 0.4482 (0.3930) loss_oracle 0.4673 (0.4686) acc 37.5000 (49.9062) kd_loss 0.9017 (0.9026) lr 8.7467e-04 eta 0:09:28
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,229
* accuracy: 50.9%
* error: 49.1%
* macro_f1: 39.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,657
* accuracy: 37.6%
* error: 62.4%
* macro_f1: 14.9%
******* Domain 2 best val acc:      51.5%, epoch: 26 *******
******* Domain 2 best val test acc: 39.2%, epoch: 26 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [30/50] batch [20/319] time 0.086 (0.115) data 0.000 (0.027) loss 1.2219 (1.4826) ce_loss 1.1025 (1.4255) teacher_loss 0.6318 (0.8123) loss_zs_kd 0.3816 (0.4009) loss_oracle 0.3994 (0.4699) acc 59.3750 (46.2500) kd_loss 0.8101 (0.8908) lr 8.1262e-04 eta 0:12:45
epoch [30/50] batch [40/319] time 0.087 (0.099) data 0.000 (0.013) loss 1.3269 (1.4706) ce_loss 1.3643 (1.4068) teacher_loss 0.6569 (0.7895) loss_zs_kd 0.4305 (0.4042) loss_oracle 0.4547 (0.4790) acc 56.2500 (48.4375) kd_loss 0.9297 (0.9110) lr 8.1262e-04 eta 0:11:01
epoch [30/50] batch [60/319] time 0.081 (0.094) data 0.000 (0.009) loss 1.4287 (1.4636) ce_loss 1.4727 (1.4011) teacher_loss 0.7177 (0.7771) loss_zs_kd 0.4212 (0.4083) loss_oracle 0.5005 (0.4824) acc 50.0000 (47.8646) kd_loss 0.9410 (0.9124) lr 8.1262e-04 eta 0:10:26
epoch [30/50] batch [80/319] time 0.073 (0.091) data 0.000 (0.007) loss 1.4933 (1.4639) ce_loss 1.4824 (1.3907) teacher_loss 0.7795 (0.7815) loss_zs_kd 0.3491 (0.4048) loss_oracle 0.5392 (0.4800) acc 43.7500 (48.0859) kd_loss 0.9665 (0.9173) lr 8.1262e-04 eta 0:10:03
epoch [30/50] batch [100/319] time 0.087 (0.089) data 0.000 (0.006) loss 1.4594 (1.4637) ce_loss 1.2246 (1.3885) teacher_loss 0.8000 (0.7792) loss_zs_kd 0.4227 (0.4043) loss_oracle 0.4480 (0.4823) acc 59.3750 (48.3125) kd_loss 0.9248 (0.9212) lr 8.1262e-04 eta 0:09:46
epoch [30/50] batch [120/319] time 0.087 (0.088) data 0.000 (0.005) loss 1.4986 (1.4645) ce_loss 1.3408 (1.3882) teacher_loss 0.8422 (0.7862) loss_zs_kd 0.3743 (0.4013) loss_oracle 0.4693 (0.4777) acc 53.1250 (48.5938) kd_loss 0.9050 (0.9199) lr 8.1262e-04 eta 0:09:37
epoch [30/50] batch [140/319] time 0.076 (0.087) data 0.000 (0.004) loss 1.1655 (1.4517) ce_loss 0.9712 (1.3752) teacher_loss 0.5345 (0.7762) loss_zs_kd 0.3776 (0.3991) loss_oracle 0.4423 (0.4759) acc 59.3750 (49.3080) kd_loss 0.9166 (0.9209) lr 8.1262e-04 eta 0:09:27
epoch [30/50] batch [160/319] time 0.083 (0.086) data 0.000 (0.004) loss 1.4128 (1.4459) ce_loss 1.4668 (1.3710) teacher_loss 0.7938 (0.7735) loss_zs_kd 0.3454 (0.3970) loss_oracle 0.4463 (0.4740) acc 43.7500 (49.4531) kd_loss 0.8992 (0.9203) lr 8.1262e-04 eta 0:09:20
epoch [30/50] batch [180/319] time 0.085 (0.086) data 0.000 (0.003) loss 1.4058 (1.4419) ce_loss 1.2881 (1.3659) teacher_loss 0.7797 (0.7728) loss_zs_kd 0.3988 (0.3945) loss_oracle 0.4267 (0.4718) acc 46.8750 (49.6875) kd_loss 0.9573 (0.9197) lr 8.1262e-04 eta 0:09:18
epoch [30/50] batch [200/319] time 0.084 (0.086) data 0.000 (0.003) loss 1.4970 (1.4365) ce_loss 1.3848 (1.3593) teacher_loss 0.7629 (0.7688) loss_zs_kd 0.3926 (0.3932) loss_oracle 0.5378 (0.4711) acc 46.8750 (49.8750) kd_loss 0.9700 (0.9221) lr 8.1262e-04 eta 0:09:17
epoch [30/50] batch [220/319] time 0.076 (0.085) data 0.000 (0.003) loss 1.2257 (1.4381) ce_loss 1.0605 (1.3585) teacher_loss 0.6025 (0.7691) loss_zs_kd 0.3534 (0.3948) loss_oracle 0.4465 (0.4716) acc 71.8750 (49.7159) kd_loss 0.9958 (0.9219) lr 8.1262e-04 eta 0:09:13
epoch [30/50] batch [240/319] time 0.086 (0.085) data 0.000 (0.002) loss 1.4175 (1.4444) ce_loss 1.1777 (1.3660) teacher_loss 0.6189 (0.7748) loss_zs_kd 0.3927 (0.3937) loss_oracle 0.6022 (0.4727) acc 46.8750 (49.3490) kd_loss 0.9798 (0.9217) lr 8.1262e-04 eta 0:09:09
epoch [30/50] batch [260/319] time 0.080 (0.085) data 0.000 (0.002) loss 1.4071 (1.4437) ce_loss 1.3125 (1.3662) teacher_loss 0.8444 (0.7764) loss_zs_kd 0.3445 (0.3922) loss_oracle 0.3904 (0.4711) acc 37.5000 (49.1346) kd_loss 0.7840 (0.9203) lr 8.1262e-04 eta 0:09:05
epoch [30/50] batch [280/319] time 0.089 (0.085) data 0.000 (0.002) loss 1.3919 (1.4399) ce_loss 1.3164 (1.3613) teacher_loss 0.7726 (0.7752) loss_zs_kd 0.3666 (0.3903) loss_oracle 0.4360 (0.4696) acc 46.8750 (49.3862) kd_loss 0.8679 (0.9220) lr 8.1262e-04 eta 0:09:03
epoch [30/50] batch [300/319] time 0.096 (0.085) data 0.000 (0.002) loss 1.6318 (1.4369) ce_loss 1.5459 (1.3572) teacher_loss 0.9790 (0.7741) loss_zs_kd 0.3937 (0.3899) loss_oracle 0.4560 (0.4678) acc 43.7500 (49.5312) kd_loss 0.8338 (0.9212) lr 8.1262e-04 eta 0:09:02
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,251
* accuracy: 51.4%
* error: 48.6%
* macro_f1: 40.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,717
* accuracy: 38.2%
* error: 61.8%
* macro_f1: 16.6%
******* Domain 2 best val acc:      51.5%, epoch: 26 *******
******* Domain 2 best val test acc: 39.2%, epoch: 26 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [31/50] batch [20/319] time 0.068 (0.116) data 0.000 (0.032) loss 1.3850 (1.3674) ce_loss 1.4727 (1.2516) teacher_loss 0.6679 (0.7358) loss_zs_kd 0.4080 (0.3854) loss_oracle 0.5131 (0.4388) acc 43.7500 (53.1250) kd_loss 1.0665 (0.9004) lr 7.5131e-04 eta 0:12:18
epoch [31/50] batch [40/319] time 0.076 (0.099) data 0.000 (0.016) loss 1.4301 (1.3919) ce_loss 1.3311 (1.3048) teacher_loss 0.8455 (0.7570) loss_zs_kd 0.3474 (0.3879) loss_oracle 0.4109 (0.4410) acc 53.1250 (52.1875) kd_loss 0.8672 (0.9186) lr 7.5131e-04 eta 0:10:28
epoch [31/50] batch [60/319] time 0.081 (0.093) data 0.000 (0.011) loss 1.3289 (1.4116) ce_loss 1.1387 (1.3227) teacher_loss 0.7589 (0.7824) loss_zs_kd 0.3748 (0.3896) loss_oracle 0.3826 (0.4344) acc 56.2500 (50.9375) kd_loss 1.0336 (0.9182) lr 7.5131e-04 eta 0:09:50
epoch [31/50] batch [80/319] time 0.071 (0.090) data 0.000 (0.008) loss 1.3638 (1.4111) ce_loss 1.6104 (1.3221) teacher_loss 0.7539 (0.7803) loss_zs_kd 0.3667 (0.3870) loss_oracle 0.4265 (0.4372) acc 37.5000 (50.9766) kd_loss 0.9737 (0.9180) lr 7.5131e-04 eta 0:09:26
epoch [31/50] batch [100/319] time 0.083 (0.088) data 0.000 (0.007) loss 1.5518 (1.4095) ce_loss 1.4375 (1.3201) teacher_loss 0.8145 (0.7727) loss_zs_kd 0.4307 (0.3887) loss_oracle 0.5219 (0.4424) acc 46.8750 (51.2812) kd_loss 0.8873 (0.9134) lr 7.5131e-04 eta 0:09:14
epoch [31/50] batch [120/319] time 0.083 (0.088) data 0.000 (0.005) loss 1.3372 (1.4174) ce_loss 1.3008 (1.3313) teacher_loss 0.6667 (0.7776) loss_zs_kd 0.3384 (0.3859) loss_oracle 0.5013 (0.4469) acc 50.0000 (50.6510) kd_loss 0.9111 (0.9200) lr 7.5131e-04 eta 0:09:08
epoch [31/50] batch [140/319] time 0.079 (0.087) data 0.000 (0.005) loss 1.3811 (1.4224) ce_loss 1.2598 (1.3405) teacher_loss 0.7779 (0.7808) loss_zs_kd 0.3567 (0.3879) loss_oracle 0.4249 (0.4477) acc 43.7500 (49.8438) kd_loss 1.0157 (0.9199) lr 7.5131e-04 eta 0:09:01
epoch [31/50] batch [160/319] time 0.078 (0.086) data 0.000 (0.004) loss 1.5339 (1.4272) ce_loss 1.4902 (1.3442) teacher_loss 0.9613 (0.7813) loss_zs_kd 0.3818 (0.3917) loss_oracle 0.3817 (0.4500) acc 40.6250 (49.6484) kd_loss 0.8990 (0.9209) lr 7.5131e-04 eta 0:08:57
epoch [31/50] batch [180/319] time 0.081 (0.086) data 0.000 (0.004) loss 1.6500 (1.4322) ce_loss 1.8516 (1.3524) teacher_loss 0.9554 (0.7869) loss_zs_kd 0.3523 (0.3904) loss_oracle 0.5185 (0.4501) acc 37.5000 (49.4444) kd_loss 0.9963 (0.9221) lr 7.5131e-04 eta 0:08:55
epoch [31/50] batch [200/319] time 0.078 (0.086) data 0.000 (0.003) loss 1.4398 (1.4363) ce_loss 1.4902 (1.3593) teacher_loss 0.7934 (0.7888) loss_zs_kd 0.4102 (0.3918) loss_oracle 0.4413 (0.4516) acc 50.0000 (49.1719) kd_loss 0.9250 (0.9246) lr 7.5131e-04 eta 0:08:51
epoch [31/50] batch [220/319] time 0.084 (0.086) data 0.000 (0.003) loss 1.2592 (1.4359) ce_loss 1.1523 (1.3582) teacher_loss 0.5814 (0.7879) loss_zs_kd 0.4531 (0.3916) loss_oracle 0.4513 (0.4521) acc 62.5000 (49.4602) kd_loss 0.9669 (0.9254) lr 7.5131e-04 eta 0:08:48
epoch [31/50] batch [240/319] time 0.079 (0.086) data 0.000 (0.003) loss 1.3337 (1.4366) ce_loss 1.2559 (1.3583) teacher_loss 0.8202 (0.7913) loss_zs_kd 0.3155 (0.3900) loss_oracle 0.3557 (0.4502) acc 53.1250 (49.3620) kd_loss 0.9585 (0.9261) lr 7.5131e-04 eta 0:08:46
epoch [31/50] batch [260/319] time 0.081 (0.086) data 0.000 (0.003) loss 1.5096 (1.4352) ce_loss 1.3838 (1.3573) teacher_loss 0.8500 (0.7918) loss_zs_kd 0.3770 (0.3883) loss_oracle 0.4710 (0.4492) acc 46.8750 (49.2548) kd_loss 0.8829 (0.9268) lr 7.5131e-04 eta 0:08:43
epoch [31/50] batch [280/319] time 0.084 (0.085) data 0.000 (0.003) loss 1.3819 (1.4410) ce_loss 1.2871 (1.3639) teacher_loss 0.7059 (0.7985) loss_zs_kd 0.3799 (0.3889) loss_oracle 0.4860 (0.4481) acc 43.7500 (48.9621) kd_loss 1.0272 (0.9279) lr 7.5131e-04 eta 0:08:41
epoch [31/50] batch [300/319] time 0.083 (0.085) data 0.000 (0.002) loss 1.2376 (1.4445) ce_loss 1.1914 (1.3661) teacher_loss 0.6495 (0.8025) loss_zs_kd 0.3620 (0.3889) loss_oracle 0.4071 (0.4476) acc 62.5000 (48.9792) kd_loss 1.0301 (0.9286) lr 7.5131e-04 eta 0:08:39
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,273
* accuracy: 51.9%
* error: 48.1%
* macro_f1: 39.9%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,036
* accuracy: 41.5%
* error: 58.5%
* macro_f1: 15.6%
******* Domain 2 best val acc:      51.9%, epoch: 31 *******
******* Domain 2 best val test acc: 41.5%, epoch: 31 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [32/50] batch [20/319] time 0.088 (0.113) data 0.000 (0.030) loss 1.3374 (1.4468) ce_loss 1.3896 (1.3459) teacher_loss 0.7640 (0.8474) loss_zs_kd 0.4214 (0.3754) loss_oracle 0.3627 (0.4117) acc 40.6250 (48.9062) kd_loss 0.9982 (0.9491) lr 6.9098e-04 eta 0:11:19
epoch [32/50] batch [40/319] time 0.085 (0.096) data 0.000 (0.015) loss 1.5515 (1.4565) ce_loss 1.5156 (1.3693) teacher_loss 0.9475 (0.8497) loss_zs_kd 0.3695 (0.3698) loss_oracle 0.4192 (0.4218) acc 37.5000 (48.2812) kd_loss 0.9030 (0.9558) lr 6.9098e-04 eta 0:09:39
epoch [32/50] batch [60/319] time 0.055 (0.092) data 0.000 (0.010) loss 1.2802 (1.4533) ce_loss 1.1279 (1.3610) teacher_loss 0.7323 (0.8412) loss_zs_kd 0.3141 (0.3742) loss_oracle 0.3908 (0.4250) acc 53.1250 (49.2708) kd_loss 0.9083 (0.9523) lr 6.9098e-04 eta 0:09:09
epoch [32/50] batch [80/319] time 0.069 (0.087) data 0.000 (0.008) loss 1.4016 (1.4546) ce_loss 1.1953 (1.3589) teacher_loss 0.7602 (0.8433) loss_zs_kd 0.3727 (0.3716) loss_oracle 0.4551 (0.4256) acc 53.1250 (49.1797) kd_loss 0.9551 (0.9480) lr 6.9098e-04 eta 0:08:37
epoch [32/50] batch [100/319] time 0.081 (0.086) data 0.000 (0.006) loss 1.4380 (1.4581) ce_loss 1.3252 (1.3704) teacher_loss 0.8514 (0.8538) loss_zs_kd 0.3266 (0.3658) loss_oracle 0.4234 (0.4214) acc 53.1250 (48.8750) kd_loss 0.8459 (0.9437) lr 6.9098e-04 eta 0:08:30
epoch [32/50] batch [120/319] time 0.069 (0.085) data 0.000 (0.005) loss 1.3793 (1.4496) ce_loss 1.3057 (1.3576) teacher_loss 0.7750 (0.8444) loss_zs_kd 0.4209 (0.3672) loss_oracle 0.3939 (0.4216) acc 50.0000 (49.0885) kd_loss 0.8734 (0.9410) lr 6.9098e-04 eta 0:08:25
epoch [32/50] batch [140/319] time 0.090 (0.085) data 0.000 (0.005) loss 1.5299 (1.4471) ce_loss 1.4814 (1.3592) teacher_loss 0.9668 (0.8419) loss_zs_kd 0.3963 (0.3654) loss_oracle 0.3650 (0.4225) acc 43.7500 (48.7500) kd_loss 0.8690 (0.9359) lr 6.9098e-04 eta 0:08:20
epoch [32/50] batch [160/319] time 0.072 (0.084) data 0.000 (0.004) loss 1.6208 (1.4530) ce_loss 1.4600 (1.3672) teacher_loss 0.9353 (0.8448) loss_zs_kd 0.3642 (0.3645) loss_oracle 0.5034 (0.4259) acc 43.7500 (48.5547) kd_loss 0.8581 (0.9302) lr 6.9098e-04 eta 0:08:16
epoch [32/50] batch [180/319] time 0.082 (0.084) data 0.000 (0.004) loss 1.4599 (1.4510) ce_loss 1.5781 (1.3641) teacher_loss 0.9091 (0.8412) loss_zs_kd 0.3458 (0.3646) loss_oracle 0.3778 (0.4274) acc 43.7500 (48.8194) kd_loss 0.8870 (0.9276) lr 6.9098e-04 eta 0:08:13
epoch [32/50] batch [200/319] time 0.067 (0.083) data 0.000 (0.003) loss 1.4273 (1.4511) ce_loss 1.4971 (1.3607) teacher_loss 0.8128 (0.8396) loss_zs_kd 0.2935 (0.3644) loss_oracle 0.4678 (0.4293) acc 46.8750 (49.1562) kd_loss 0.8260 (0.9236) lr 6.9098e-04 eta 0:08:06
epoch [32/50] batch [220/319] time 0.077 (0.082) data 0.000 (0.003) loss 1.4228 (1.4468) ce_loss 1.3076 (1.3546) teacher_loss 0.8553 (0.8325) loss_zs_kd 0.3141 (0.3645) loss_oracle 0.4104 (0.4321) acc 46.8750 (49.3182) kd_loss 0.8300 (0.9215) lr 6.9098e-04 eta 0:07:59
epoch [32/50] batch [240/319] time 0.080 (0.082) data 0.000 (0.003) loss 1.1136 (1.4461) ce_loss 1.0068 (1.3553) teacher_loss 0.6126 (0.8327) loss_zs_kd 0.3223 (0.3646) loss_oracle 0.3399 (0.4311) acc 62.5000 (49.3620) kd_loss 0.9203 (0.9184) lr 6.9098e-04 eta 0:07:57
epoch [32/50] batch [260/319] time 0.085 (0.082) data 0.000 (0.003) loss 1.4350 (1.4495) ce_loss 1.3564 (1.3590) teacher_loss 0.7844 (0.8362) loss_zs_kd 0.3641 (0.3634) loss_oracle 0.4686 (0.4316) acc 56.2500 (49.2668) kd_loss 0.9533 (0.9153) lr 6.9098e-04 eta 0:07:54
epoch [32/50] batch [280/319] time 0.080 (0.082) data 0.000 (0.002) loss 1.4905 (1.4518) ce_loss 1.5225 (1.3639) teacher_loss 0.8961 (0.8365) loss_zs_kd 0.3537 (0.3634) loss_oracle 0.4176 (0.4336) acc 53.1250 (49.1853) kd_loss 0.8006 (0.9126) lr 6.9098e-04 eta 0:07:52
epoch [32/50] batch [300/319] time 0.086 (0.082) data 0.000 (0.002) loss 1.3532 (1.4514) ce_loss 1.2773 (1.3624) teacher_loss 0.8286 (0.8332) loss_zs_kd 0.2766 (0.3655) loss_oracle 0.3863 (0.4354) acc 56.2500 (49.4688) kd_loss 0.9242 (0.9090) lr 6.9098e-04 eta 0:07:50
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,231
* accuracy: 51.0%
* error: 49.0%
* macro_f1: 38.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,478
* accuracy: 35.7%
* error: 64.3%
* macro_f1: 15.1%
******* Domain 2 best val acc:      51.9%, epoch: 31 *******
******* Domain 2 best val test acc: 41.5%, epoch: 31 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [33/50] batch [20/319] time 0.060 (0.111) data 0.000 (0.034) loss 1.7473 (1.4933) ce_loss 1.7158 (1.3705) teacher_loss 1.0472 (0.8363) loss_zs_kd 0.3296 (0.3831) loss_oracle 0.5353 (0.4655) acc 37.5000 (49.8438) kd_loss 0.8393 (0.8194) lr 6.3188e-04 eta 0:10:32
epoch [33/50] batch [40/319] time 0.064 (0.088) data 0.000 (0.017) loss 1.4503 (1.4863) ce_loss 1.3164 (1.3787) teacher_loss 0.7515 (0.8229) loss_zs_kd 0.4286 (0.3732) loss_oracle 0.4846 (0.4767) acc 46.8750 (50.6250) kd_loss 0.9040 (0.8288) lr 6.3188e-04 eta 0:08:22
epoch [33/50] batch [60/319] time 0.067 (0.080) data 0.000 (0.011) loss 1.1581 (1.4840) ce_loss 1.0098 (1.3707) teacher_loss 0.5269 (0.8166) loss_zs_kd 0.3201 (0.3726) loss_oracle 0.4711 (0.4812) acc 59.3750 (50.0000) kd_loss 0.7187 (0.8311) lr 6.3188e-04 eta 0:07:35
epoch [33/50] batch [80/319] time 0.077 (0.077) data 0.000 (0.009) loss 1.4766 (1.4784) ce_loss 1.3086 (1.3578) teacher_loss 0.7258 (0.8052) loss_zs_kd 0.4438 (0.3791) loss_oracle 0.5289 (0.4836) acc 56.2500 (50.5859) kd_loss 0.8449 (0.8316) lr 6.3188e-04 eta 0:07:14
epoch [33/50] batch [100/319] time 0.081 (0.077) data 0.000 (0.007) loss 1.5910 (1.4756) ce_loss 1.5439 (1.3627) teacher_loss 0.9124 (0.8023) loss_zs_kd 0.3808 (0.3797) loss_oracle 0.4881 (0.4834) acc 50.0000 (49.9062) kd_loss 0.8375 (0.8317) lr 6.3188e-04 eta 0:07:15
epoch [33/50] batch [120/319] time 0.082 (0.078) data 0.000 (0.006) loss 1.7737 (1.4752) ce_loss 1.5713 (1.3613) teacher_loss 1.0160 (0.8030) loss_zs_kd 0.3535 (0.3776) loss_oracle 0.5810 (0.4834) acc 46.8750 (49.7396) kd_loss 0.8158 (0.8339) lr 6.3188e-04 eta 0:07:17
epoch [33/50] batch [140/319] time 0.086 (0.079) data 0.000 (0.005) loss 1.4490 (1.4764) ce_loss 1.3223 (1.3609) teacher_loss 0.7934 (0.8045) loss_zs_kd 0.4182 (0.3781) loss_oracle 0.4465 (0.4829) acc 46.8750 (49.8438) kd_loss 0.8573 (0.8319) lr 6.3188e-04 eta 0:07:21
epoch [33/50] batch [160/319] time 0.086 (0.079) data 0.000 (0.004) loss 1.1751 (1.4776) ce_loss 1.0068 (1.3604) teacher_loss 0.5462 (0.8061) loss_zs_kd 0.3634 (0.3797) loss_oracle 0.4471 (0.4817) acc 62.5000 (49.6289) kd_loss 0.8430 (0.8313) lr 6.3188e-04 eta 0:07:23
epoch [33/50] batch [180/319] time 0.087 (0.080) data 0.000 (0.004) loss 1.5830 (1.4848) ce_loss 1.5166 (1.3700) teacher_loss 0.8743 (0.8156) loss_zs_kd 0.4944 (0.3791) loss_oracle 0.4615 (0.4797) acc 50.0000 (49.1493) kd_loss 0.8836 (0.8322) lr 6.3188e-04 eta 0:07:25
epoch [33/50] batch [200/319] time 0.083 (0.080) data 0.000 (0.004) loss 1.4268 (1.4860) ce_loss 1.2744 (1.3694) teacher_loss 0.6283 (0.8142) loss_zs_kd 0.4573 (0.3801) loss_oracle 0.5699 (0.4818) acc 56.2500 (49.4062) kd_loss 0.9529 (0.8342) lr 6.3188e-04 eta 0:07:24
epoch [33/50] batch [220/319] time 0.084 (0.080) data 0.000 (0.003) loss 1.3016 (1.4822) ce_loss 1.0674 (1.3608) teacher_loss 0.6350 (0.8088) loss_zs_kd 0.3346 (0.3805) loss_oracle 0.4992 (0.4832) acc 59.3750 (49.7017) kd_loss 0.7677 (0.8332) lr 6.3188e-04 eta 0:07:24
epoch [33/50] batch [240/319] time 0.086 (0.081) data 0.001 (0.003) loss 1.5411 (1.4857) ce_loss 1.4639 (1.3601) teacher_loss 0.7389 (0.8105) loss_zs_kd 0.4589 (0.3809) loss_oracle 0.5727 (0.4848) acc 53.1250 (49.6094) kd_loss 0.9102 (0.8318) lr 6.3188e-04 eta 0:07:24
epoch [33/50] batch [260/319] time 0.090 (0.081) data 0.000 (0.003) loss 1.5257 (1.4871) ce_loss 1.5146 (1.3607) teacher_loss 0.8487 (0.8125) loss_zs_kd 0.3789 (0.3803) loss_oracle 0.4875 (0.4845) acc 43.7500 (49.5433) kd_loss 0.8418 (0.8316) lr 6.3188e-04 eta 0:07:22
epoch [33/50] batch [280/319] time 0.080 (0.081) data 0.000 (0.003) loss 1.3329 (1.4855) ce_loss 1.0771 (1.3556) teacher_loss 0.7279 (0.8118) loss_zs_kd 0.3383 (0.3791) loss_oracle 0.4359 (0.4842) acc 65.6250 (49.7210) kd_loss 0.8270 (0.8294) lr 6.3188e-04 eta 0:07:22
epoch [33/50] batch [300/319] time 0.085 (0.081) data 0.000 (0.003) loss 1.2559 (1.4876) ce_loss 1.0342 (1.3592) teacher_loss 0.6411 (0.8130) loss_zs_kd 0.3277 (0.3785) loss_oracle 0.4509 (0.4853) acc 65.6250 (49.6771) kd_loss 0.8400 (0.8286) lr 6.3188e-04 eta 0:07:20
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,268
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 40.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,560
* accuracy: 36.6%
* error: 63.4%
* macro_f1: 15.6%
******* Domain 2 best val acc:      51.9%, epoch: 31 *******
******* Domain 2 best val test acc: 41.5%, epoch: 31 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [34/50] batch [20/319] time 0.081 (0.112) data 0.000 (0.027) loss 1.7818 (1.4904) ce_loss 1.5537 (1.3435) teacher_loss 1.1422 (0.8177) loss_zs_kd 0.4045 (0.3793) loss_oracle 0.4374 (0.4830) acc 46.8750 (50.1562) kd_loss 0.7342 (0.8183) lr 5.7422e-04 eta 0:10:04
epoch [34/50] batch [40/319] time 0.087 (0.098) data 0.000 (0.014) loss 1.4071 (1.4919) ce_loss 1.3027 (1.3445) teacher_loss 0.8134 (0.8154) loss_zs_kd 0.3017 (0.3876) loss_oracle 0.4428 (0.4827) acc 46.8750 (49.3750) kd_loss 0.8622 (0.8168) lr 5.7422e-04 eta 0:08:49
epoch [34/50] batch [60/319] time 0.074 (0.093) data 0.000 (0.009) loss 1.5688 (1.4765) ce_loss 1.4746 (1.3166) teacher_loss 0.9072 (0.7972) loss_zs_kd 0.3518 (0.3861) loss_oracle 0.4858 (0.4863) acc 43.7500 (50.9896) kd_loss 0.8847 (0.8211) lr 5.7422e-04 eta 0:08:19
epoch [34/50] batch [80/319] time 0.087 (0.090) data 0.000 (0.007) loss 1.5798 (1.4697) ce_loss 1.4502 (1.3128) teacher_loss 0.8956 (0.7929) loss_zs_kd 0.4155 (0.3800) loss_oracle 0.4764 (0.4868) acc 46.8750 (50.6641) kd_loss 0.8160 (0.8262) lr 5.7422e-04 eta 0:08:00
epoch [34/50] batch [100/319] time 0.080 (0.089) data 0.000 (0.006) loss 1.4533 (1.4725) ce_loss 1.3984 (1.3096) teacher_loss 0.7275 (0.7971) loss_zs_kd 0.3825 (0.3819) loss_oracle 0.5345 (0.4845) acc 40.6250 (50.5312) kd_loss 0.8006 (0.8291) lr 5.7422e-04 eta 0:07:53
epoch [34/50] batch [120/319] time 0.077 (0.087) data 0.000 (0.005) loss 1.4049 (1.4555) ce_loss 1.3867 (1.3030) teacher_loss 0.7881 (0.7835) loss_zs_kd 0.3894 (0.3811) loss_oracle 0.4221 (0.4814) acc 46.8750 (50.6250) kd_loss 0.9796 (0.8349) lr 5.7422e-04 eta 0:07:41
epoch [34/50] batch [140/319] time 0.070 (0.086) data 0.000 (0.004) loss 1.6331 (1.4584) ce_loss 1.5254 (1.3063) teacher_loss 0.9670 (0.7869) loss_zs_kd 0.3893 (0.3811) loss_oracle 0.4714 (0.4809) acc 40.6250 (50.2902) kd_loss 0.9384 (0.8381) lr 5.7422e-04 eta 0:07:32
epoch [34/50] batch [160/319] time 0.094 (0.085) data 0.000 (0.004) loss 1.5289 (1.4619) ce_loss 1.3477 (1.3107) teacher_loss 0.7833 (0.7903) loss_zs_kd 0.4453 (0.3828) loss_oracle 0.5230 (0.4802) acc 43.7500 (50.1953) kd_loss 0.8935 (0.8393) lr 5.7422e-04 eta 0:07:29
epoch [34/50] batch [180/319] time 0.082 (0.085) data 0.000 (0.003) loss 1.4804 (1.4633) ce_loss 1.2559 (1.3128) teacher_loss 0.7870 (0.7921) loss_zs_kd 0.5246 (0.3856) loss_oracle 0.4311 (0.4784) acc 56.2500 (50.3125) kd_loss 0.8996 (0.8420) lr 5.7422e-04 eta 0:07:27
epoch [34/50] batch [200/319] time 0.081 (0.085) data 0.000 (0.003) loss 1.3049 (1.4631) ce_loss 1.2959 (1.3213) teacher_loss 0.7052 (0.7929) loss_zs_kd 0.3340 (0.3856) loss_oracle 0.4327 (0.4775) acc 50.0000 (50.1875) kd_loss 0.9490 (0.8476) lr 5.7422e-04 eta 0:07:22
epoch [34/50] batch [220/319] time 0.088 (0.085) data 0.000 (0.003) loss 1.2528 (1.4624) ce_loss 1.1016 (1.3237) teacher_loss 0.5556 (0.7891) loss_zs_kd 0.4390 (0.3888) loss_oracle 0.4777 (0.4789) acc 62.5000 (50.1420) kd_loss 0.8950 (0.8522) lr 5.7422e-04 eta 0:07:20
epoch [34/50] batch [240/319] time 0.082 (0.085) data 0.000 (0.002) loss 1.4572 (1.4573) ce_loss 1.2744 (1.3234) teacher_loss 0.8685 (0.7843) loss_zs_kd 0.4262 (0.3902) loss_oracle 0.3756 (0.4780) acc 59.3750 (50.2734) kd_loss 0.9028 (0.8556) lr 5.7422e-04 eta 0:07:18
epoch [34/50] batch [260/319] time 0.090 (0.085) data 0.000 (0.002) loss 1.2372 (1.4506) ce_loss 1.1064 (1.3162) teacher_loss 0.6220 (0.7785) loss_zs_kd 0.3794 (0.3900) loss_oracle 0.4255 (0.4771) acc 53.1250 (50.6370) kd_loss 0.8606 (0.8572) lr 5.7422e-04 eta 0:07:17
epoch [34/50] batch [280/319] time 0.079 (0.085) data 0.000 (0.002) loss 1.2759 (1.4468) ce_loss 1.0537 (1.3141) teacher_loss 0.6000 (0.7752) loss_zs_kd 0.4094 (0.3902) loss_oracle 0.4713 (0.4765) acc 71.8750 (50.6920) kd_loss 0.9289 (0.8590) lr 5.7422e-04 eta 0:07:15
epoch [34/50] batch [300/319] time 0.083 (0.085) data 0.000 (0.002) loss 1.5309 (1.4464) ce_loss 1.4336 (1.3192) teacher_loss 0.8620 (0.7744) loss_zs_kd 0.4195 (0.3920) loss_oracle 0.4591 (0.4760) acc 43.7500 (50.5729) kd_loss 0.8513 (0.8617) lr 5.7422e-04 eta 0:07:13
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,285
* accuracy: 52.2%
* error: 47.8%
* macro_f1: 40.9%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,794
* accuracy: 39.0%
* error: 61.0%
* macro_f1: 15.4%
******* Domain 2 best val acc:      52.2%, epoch: 34 *******
******* Domain 2 best val test acc: 39.0%, epoch: 34 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [35/50] batch [20/319] time 0.092 (0.116) data 0.000 (0.027) loss 1.5582 (1.4099) ce_loss 1.4805 (1.3373) teacher_loss 0.8556 (0.7410) loss_zs_kd 0.4278 (0.4055) loss_oracle 0.4887 (0.4662) acc 43.7500 (49.5312) kd_loss 0.8673 (0.9022) lr 5.1825e-04 eta 0:09:50
epoch [35/50] batch [40/319] time 0.073 (0.095) data 0.000 (0.013) loss 1.4032 (1.4132) ce_loss 1.3418 (1.3329) teacher_loss 0.7016 (0.7391) loss_zs_kd 0.3950 (0.4049) loss_oracle 0.5041 (0.4717) acc 46.8750 (50.1562) kd_loss 0.9429 (0.9061) lr 5.1825e-04 eta 0:07:59
epoch [35/50] batch [60/319] time 0.078 (0.088) data 0.000 (0.009) loss 1.3202 (1.4202) ce_loss 1.2451 (1.3426) teacher_loss 0.6675 (0.7555) loss_zs_kd 0.3866 (0.3975) loss_oracle 0.4594 (0.4659) acc 50.0000 (50.1042) kd_loss 0.9563 (0.9018) lr 5.1825e-04 eta 0:07:25
epoch [35/50] batch [80/319] time 0.077 (0.087) data 0.000 (0.007) loss 1.4561 (1.4157) ce_loss 1.4922 (1.3381) teacher_loss 0.7674 (0.7480) loss_zs_kd 0.3858 (0.3986) loss_oracle 0.4958 (0.4685) acc 53.1250 (50.1953) kd_loss 0.9749 (0.9031) lr 5.1825e-04 eta 0:07:17
epoch [35/50] batch [100/319] time 0.081 (0.086) data 0.000 (0.006) loss 1.5199 (1.4061) ce_loss 1.4014 (1.3278) teacher_loss 0.8333 (0.7392) loss_zs_kd 0.4753 (0.4022) loss_oracle 0.4490 (0.4658) acc 53.1250 (50.5000) kd_loss 0.8246 (0.9022) lr 5.1825e-04 eta 0:07:09
epoch [35/50] batch [120/319] time 0.081 (0.085) data 0.000 (0.005) loss 1.4841 (1.4086) ce_loss 1.3135 (1.3324) teacher_loss 0.8125 (0.7403) loss_zs_kd 0.4092 (0.4022) loss_oracle 0.4671 (0.4672) acc 56.2500 (50.5469) kd_loss 0.7752 (0.9007) lr 5.1825e-04 eta 0:07:05
epoch [35/50] batch [140/319] time 0.081 (0.084) data 0.000 (0.004) loss 1.3337 (1.4039) ce_loss 1.3076 (1.3207) teacher_loss 0.7418 (0.7365) loss_zs_kd 0.3832 (0.4003) loss_oracle 0.4003 (0.4672) acc 59.3750 (51.2054) kd_loss 1.0202 (0.9001) lr 5.1825e-04 eta 0:06:59
epoch [35/50] batch [160/319] time 0.086 (0.084) data 0.000 (0.004) loss 1.4562 (1.4080) ce_loss 1.2139 (1.3212) teacher_loss 0.8288 (0.7410) loss_zs_kd 0.4466 (0.4020) loss_oracle 0.4041 (0.4660) acc 56.2500 (50.6445) kd_loss 0.8419 (0.8963) lr 5.1825e-04 eta 0:06:57
epoch [35/50] batch [180/319] time 0.079 (0.084) data 0.000 (0.003) loss 1.5337 (1.4152) ce_loss 1.5596 (1.3332) teacher_loss 0.9417 (0.7492) loss_zs_kd 0.3335 (0.4021) loss_oracle 0.4253 (0.4649) acc 43.7500 (50.2951) kd_loss 0.8551 (0.8971) lr 5.1825e-04 eta 0:06:53
epoch [35/50] batch [200/319] time 0.078 (0.084) data 0.000 (0.003) loss 1.4146 (1.4209) ce_loss 1.1885 (1.3414) teacher_loss 0.7672 (0.7549) loss_zs_kd 0.3741 (0.4030) loss_oracle 0.4604 (0.4645) acc 56.2500 (49.9375) kd_loss 0.8117 (0.8973) lr 5.1825e-04 eta 0:06:51
epoch [35/50] batch [220/319] time 0.077 (0.084) data 0.000 (0.003) loss 1.6480 (1.4172) ce_loss 1.5791 (1.3384) teacher_loss 0.8793 (0.7488) loss_zs_kd 0.4271 (0.4043) loss_oracle 0.5551 (0.4663) acc 37.5000 (49.9716) kd_loss 0.9340 (0.8988) lr 5.1825e-04 eta 0:06:48
epoch [35/50] batch [240/319] time 0.082 (0.083) data 0.000 (0.002) loss 1.3252 (1.4177) ce_loss 1.1875 (1.3394) teacher_loss 0.7088 (0.7494) loss_zs_kd 0.4294 (0.4052) loss_oracle 0.4016 (0.4657) acc 53.1250 (49.8177) kd_loss 0.8773 (0.8983) lr 5.1825e-04 eta 0:06:44
epoch [35/50] batch [260/319] time 0.082 (0.083) data 0.000 (0.002) loss 1.0795 (1.4133) ce_loss 0.9028 (1.3353) teacher_loss 0.4257 (0.7445) loss_zs_kd 0.4705 (0.4060) loss_oracle 0.4186 (0.4657) acc 75.0000 (49.8317) kd_loss 0.9358 (0.8988) lr 5.1825e-04 eta 0:06:43
epoch [35/50] batch [280/319] time 0.079 (0.083) data 0.000 (0.002) loss 1.5813 (1.4174) ce_loss 1.5146 (1.3395) teacher_loss 0.8463 (0.7471) loss_zs_kd 0.4325 (0.4069) loss_oracle 0.5187 (0.4668) acc 46.8750 (49.6540) kd_loss 0.9148 (0.8991) lr 5.1825e-04 eta 0:06:42
epoch [35/50] batch [300/319] time 0.078 (0.083) data 0.000 (0.002) loss 1.1682 (1.4159) ce_loss 1.1768 (1.3377) teacher_loss 0.5488 (0.7456) loss_zs_kd 0.4035 (0.4073) loss_oracle 0.4177 (0.4666) acc 53.1250 (49.8958) kd_loss 0.9373 (0.8997) lr 5.1825e-04 eta 0:06:40
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,280
* accuracy: 52.1%
* error: 47.9%
* macro_f1: 39.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,002
* accuracy: 41.1%
* error: 58.9%
* macro_f1: 15.2%
******* Domain 2 best val acc:      52.2%, epoch: 34 *******
******* Domain 2 best val test acc: 39.0%, epoch: 34 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [36/50] batch [20/319] time 0.076 (0.115) data 0.000 (0.034) loss 1.3489 (1.4431) ce_loss 1.1504 (1.3451) teacher_loss 0.7087 (0.7523) loss_zs_kd 0.3502 (0.4206) loss_oracle 0.4651 (0.4805) acc 59.3750 (49.5312) kd_loss 0.8742 (0.8909) lr 4.6417e-04 eta 0:09:05
epoch [36/50] batch [40/319] time 0.092 (0.099) data 0.000 (0.017) loss 1.4499 (1.4554) ce_loss 1.3818 (1.3767) teacher_loss 0.7548 (0.7651) loss_zs_kd 0.3856 (0.4234) loss_oracle 0.5023 (0.4786) acc 37.5000 (47.7344) kd_loss 0.9353 (0.8940) lr 4.6417e-04 eta 0:07:47
epoch [36/50] batch [60/319] time 0.085 (0.093) data 0.000 (0.011) loss 1.5763 (1.4394) ce_loss 1.3330 (1.3509) teacher_loss 0.7820 (0.7561) loss_zs_kd 0.4709 (0.4194) loss_oracle 0.5589 (0.4736) acc 46.8750 (49.2708) kd_loss 0.8676 (0.8963) lr 4.6417e-04 eta 0:07:20
epoch [36/50] batch [80/319] time 0.081 (0.091) data 0.000 (0.009) loss 1.4568 (1.4395) ce_loss 1.2568 (1.3559) teacher_loss 0.7222 (0.7603) loss_zs_kd 0.4371 (0.4115) loss_oracle 0.5161 (0.4734) acc 50.0000 (49.2578) kd_loss 0.9443 (0.8979) lr 4.6417e-04 eta 0:07:09
epoch [36/50] batch [100/319] time 0.081 (0.090) data 0.000 (0.007) loss 1.3997 (1.4340) ce_loss 1.3301 (1.3457) teacher_loss 0.6482 (0.7553) loss_zs_kd 0.4941 (0.4103) loss_oracle 0.5044 (0.4736) acc 46.8750 (49.9688) kd_loss 0.9481 (0.8995) lr 4.6417e-04 eta 0:06:59
epoch [36/50] batch [120/319] time 0.085 (0.089) data 0.000 (0.006) loss 1.2998 (1.4268) ce_loss 1.2295 (1.3385) teacher_loss 0.6105 (0.7486) loss_zs_kd 0.3739 (0.4090) loss_oracle 0.5024 (0.4737) acc 50.0000 (50.4427) kd_loss 0.8590 (0.9005) lr 4.6417e-04 eta 0:06:55
epoch [36/50] batch [140/319] time 0.081 (0.088) data 0.000 (0.005) loss 1.5244 (1.4254) ce_loss 1.3242 (1.3381) teacher_loss 0.8445 (0.7482) loss_zs_kd 0.3708 (0.4087) loss_oracle 0.4945 (0.4729) acc 53.1250 (50.4688) kd_loss 0.8531 (0.9020) lr 4.6417e-04 eta 0:06:51
epoch [36/50] batch [160/319] time 0.074 (0.088) data 0.000 (0.004) loss 1.2902 (1.4241) ce_loss 1.2148 (1.3369) teacher_loss 0.7138 (0.7471) loss_zs_kd 0.3507 (0.4084) loss_oracle 0.4010 (0.4728) acc 62.5000 (50.5078) kd_loss 0.8759 (0.9020) lr 4.6417e-04 eta 0:06:45
epoch [36/50] batch [180/319] time 0.082 (0.087) data 0.000 (0.004) loss 1.5842 (1.4187) ce_loss 1.5342 (1.3389) teacher_loss 0.8723 (0.7450) loss_zs_kd 0.4344 (0.4052) loss_oracle 0.4947 (0.4711) acc 40.6250 (50.5382) kd_loss 0.8965 (0.9045) lr 4.6417e-04 eta 0:06:40
epoch [36/50] batch [200/319] time 0.079 (0.086) data 0.000 (0.004) loss 1.2537 (1.4179) ce_loss 1.1240 (1.3395) teacher_loss 0.6268 (0.7443) loss_zs_kd 0.3992 (0.4071) loss_oracle 0.4273 (0.4701) acc 62.5000 (50.6094) kd_loss 0.9252 (0.9065) lr 4.6417e-04 eta 0:06:36
epoch [36/50] batch [220/319] time 0.080 (0.086) data 0.000 (0.003) loss 1.3275 (1.4214) ce_loss 1.1846 (1.3452) teacher_loss 0.7113 (0.7448) loss_zs_kd 0.4193 (0.4079) loss_oracle 0.4066 (0.4726) acc 56.2500 (50.3551) kd_loss 0.9252 (0.9093) lr 4.6417e-04 eta 0:06:32
epoch [36/50] batch [240/319] time 0.083 (0.086) data 0.000 (0.003) loss 1.3807 (1.4241) ce_loss 1.5674 (1.3477) teacher_loss 0.6315 (0.7449) loss_zs_kd 0.5100 (0.4103) loss_oracle 0.4942 (0.4740) acc 43.7500 (50.4167) kd_loss 0.9990 (0.9080) lr 4.6417e-04 eta 0:06:30
epoch [36/50] batch [260/319] time 0.082 (0.086) data 0.000 (0.003) loss 1.5516 (1.4266) ce_loss 1.5664 (1.3507) teacher_loss 0.7562 (0.7446) loss_zs_kd 0.3902 (0.4108) loss_oracle 0.6003 (0.4766) acc 43.7500 (50.3005) kd_loss 0.8356 (0.9068) lr 4.6417e-04 eta 0:06:27
epoch [36/50] batch [280/319] time 0.088 (0.085) data 0.000 (0.003) loss 1.5618 (1.4258) ce_loss 1.5264 (1.3519) teacher_loss 0.8531 (0.7430) loss_zs_kd 0.4020 (0.4102) loss_oracle 0.5077 (0.4778) acc 37.5000 (50.0558) kd_loss 0.8347 (0.9056) lr 4.6417e-04 eta 0:06:24
epoch [36/50] batch [300/319] time 0.084 (0.085) data 0.000 (0.002) loss 1.5466 (1.4265) ce_loss 1.5859 (1.3528) teacher_loss 0.8592 (0.7422) loss_zs_kd 0.4197 (0.4111) loss_oracle 0.4776 (0.4788) acc 50.0000 (50.1562) kd_loss 0.8735 (0.9063) lr 4.6417e-04 eta 0:06:22
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,240
* accuracy: 51.2%
* error: 48.8%
* macro_f1: 39.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,913
* accuracy: 40.2%
* error: 59.8%
* macro_f1: 16.0%
******* Domain 2 best val acc:      52.2%, epoch: 34 *******
******* Domain 2 best val test acc: 39.0%, epoch: 34 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [37/50] batch [20/319] time 0.073 (0.116) data 0.000 (0.033) loss 1.4656 (1.3957) ce_loss 1.3516 (1.2929) teacher_loss 0.6948 (0.7258) loss_zs_kd 0.4671 (0.4095) loss_oracle 0.5372 (0.4652) acc 37.5000 (53.9062) kd_loss 0.9329 (0.9051) lr 4.1221e-04 eta 0:08:36
epoch [37/50] batch [40/319] time 0.076 (0.098) data 0.000 (0.017) loss 1.5890 (1.4006) ce_loss 1.4756 (1.3214) teacher_loss 0.9618 (0.7096) loss_zs_kd 0.3734 (0.4114) loss_oracle 0.4404 (0.4853) acc 50.0000 (53.0469) kd_loss 0.9165 (0.9201) lr 4.1221e-04 eta 0:07:15
epoch [37/50] batch [60/319] time 0.080 (0.093) data 0.001 (0.011) loss 1.3955 (1.4186) ce_loss 1.3633 (1.3390) teacher_loss 0.6197 (0.7278) loss_zs_kd 0.4467 (0.4117) loss_oracle 0.5524 (0.4850) acc 50.0000 (52.2396) kd_loss 1.0076 (0.9164) lr 4.1221e-04 eta 0:06:47
epoch [37/50] batch [80/319] time 0.077 (0.090) data 0.000 (0.008) loss 1.6728 (1.4322) ce_loss 1.6094 (1.3510) teacher_loss 0.9278 (0.7444) loss_zs_kd 0.4175 (0.4129) loss_oracle 0.5362 (0.4814) acc 40.6250 (51.4453) kd_loss 0.9893 (0.9117) lr 4.1221e-04 eta 0:06:34
epoch [37/50] batch [100/319] time 0.083 (0.088) data 0.000 (0.007) loss 1.4590 (1.4246) ce_loss 1.3828 (1.3526) teacher_loss 0.8650 (0.7375) loss_zs_kd 0.4510 (0.4138) loss_oracle 0.3684 (0.4802) acc 50.0000 (50.8750) kd_loss 0.8629 (0.9133) lr 4.1221e-04 eta 0:06:26
epoch [37/50] batch [120/319] time 0.082 (0.088) data 0.000 (0.006) loss 1.6309 (1.4304) ce_loss 1.6133 (1.3459) teacher_loss 0.9184 (0.7460) loss_zs_kd 0.4331 (0.4115) loss_oracle 0.4959 (0.4786) acc 50.0000 (51.1458) kd_loss 0.9055 (0.9057) lr 4.1221e-04 eta 0:06:20
epoch [37/50] batch [140/319] time 0.080 (0.087) data 0.000 (0.005) loss 1.4098 (1.4329) ce_loss 1.1250 (1.3477) teacher_loss 0.7111 (0.7478) loss_zs_kd 0.3950 (0.4103) loss_oracle 0.5012 (0.4799) acc 50.0000 (51.0045) kd_loss 0.8153 (0.9019) lr 4.1221e-04 eta 0:06:15
epoch [37/50] batch [160/319] time 0.070 (0.086) data 0.000 (0.004) loss 1.6148 (1.4372) ce_loss 1.4170 (1.3499) teacher_loss 0.9329 (0.7499) loss_zs_kd 0.3948 (0.4114) loss_oracle 0.4845 (0.4816) acc 50.0000 (50.9375) kd_loss 0.7800 (0.9010) lr 4.1221e-04 eta 0:06:11
epoch [37/50] batch [180/319] time 0.083 (0.086) data 0.000 (0.004) loss 1.5615 (1.4377) ce_loss 1.4941 (1.3498) teacher_loss 0.8384 (0.7508) loss_zs_kd 0.4273 (0.4121) loss_oracle 0.5094 (0.4808) acc 46.8750 (50.7292) kd_loss 1.0229 (0.9010) lr 4.1221e-04 eta 0:06:09
epoch [37/50] batch [200/319] time 0.074 (0.086) data 0.000 (0.004) loss 1.3885 (1.4328) ce_loss 1.4043 (1.3445) teacher_loss 0.6867 (0.7489) loss_zs_kd 0.3834 (0.4111) loss_oracle 0.5101 (0.4784) acc 56.2500 (50.9688) kd_loss 1.0079 (0.9004) lr 4.1221e-04 eta 0:06:05
epoch [37/50] batch [220/319] time 0.088 (0.085) data 0.000 (0.003) loss 1.7340 (1.4294) ce_loss 1.4209 (1.3422) teacher_loss 1.1110 (0.7467) loss_zs_kd 0.3925 (0.4095) loss_oracle 0.4268 (0.4779) acc 43.7500 (50.9375) kd_loss 0.7120 (0.8995) lr 4.1221e-04 eta 0:06:02
epoch [37/50] batch [240/319] time 0.093 (0.085) data 0.000 (0.003) loss 1.6233 (1.4241) ce_loss 1.3818 (1.3395) teacher_loss 0.8241 (0.7415) loss_zs_kd 0.4451 (0.4091) loss_oracle 0.5767 (0.4780) acc 43.7500 (50.8594) kd_loss 0.9268 (0.9003) lr 4.1221e-04 eta 0:06:00
epoch [37/50] batch [260/319] time 0.084 (0.085) data 0.000 (0.003) loss 1.5108 (1.4307) ce_loss 1.4834 (1.3482) teacher_loss 0.8024 (0.7461) loss_zs_kd 0.3837 (0.4102) loss_oracle 0.5165 (0.4795) acc 34.3750 (50.4808) kd_loss 0.9640 (0.9010) lr 4.1221e-04 eta 0:05:58
epoch [37/50] batch [280/319] time 0.087 (0.085) data 0.000 (0.003) loss 1.4171 (1.4313) ce_loss 1.3398 (1.3481) teacher_loss 0.7105 (0.7474) loss_zs_kd 0.3964 (0.4100) loss_oracle 0.5084 (0.4789) acc 62.5000 (50.5915) kd_loss 0.9773 (0.9019) lr 4.1221e-04 eta 0:05:56
epoch [37/50] batch [300/319] time 0.083 (0.085) data 0.000 (0.002) loss 1.4004 (1.4279) ce_loss 1.4561 (1.3438) teacher_loss 0.7919 (0.7450) loss_zs_kd 0.3835 (0.4101) loss_oracle 0.4167 (0.4779) acc 50.0000 (50.6458) kd_loss 0.9443 (0.9029) lr 4.1221e-04 eta 0:05:55
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,259
* accuracy: 51.6%
* error: 48.4%
* macro_f1: 39.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,830
* accuracy: 39.3%
* error: 60.7%
* macro_f1: 14.9%
******* Domain 2 best val acc:      52.2%, epoch: 34 *******
******* Domain 2 best val test acc: 39.0%, epoch: 34 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [38/50] batch [20/319] time 0.082 (0.112) data 0.000 (0.025) loss 1.3783 (1.4192) ce_loss 1.1738 (1.3232) teacher_loss 0.7201 (0.7552) loss_zs_kd 0.4291 (0.3999) loss_oracle 0.4437 (0.4640) acc 62.5000 (51.2500) kd_loss 0.8857 (0.9420) lr 3.6258e-04 eta 0:07:41
epoch [38/50] batch [40/319] time 0.090 (0.096) data 0.000 (0.013) loss 1.4195 (1.4095) ce_loss 1.4717 (1.3317) teacher_loss 0.8192 (0.7496) loss_zs_kd 0.3437 (0.3945) loss_oracle 0.4284 (0.4626) acc 50.0000 (51.0938) kd_loss 0.9435 (0.9296) lr 3.6258e-04 eta 0:06:32
epoch [38/50] batch [60/319] time 0.088 (0.092) data 0.000 (0.008) loss 1.5850 (1.4347) ce_loss 1.4844 (1.3527) teacher_loss 0.9027 (0.7736) loss_zs_kd 0.4247 (0.3984) loss_oracle 0.4700 (0.4619) acc 50.0000 (50.4167) kd_loss 0.9106 (0.9266) lr 3.6258e-04 eta 0:06:16
epoch [38/50] batch [80/319] time 0.083 (0.090) data 0.000 (0.006) loss 1.6016 (1.4189) ce_loss 1.4941 (1.3439) teacher_loss 0.8551 (0.7536) loss_zs_kd 0.5578 (0.4036) loss_oracle 0.4675 (0.4635) acc 37.5000 (50.2344) kd_loss 0.8051 (0.9303) lr 3.6258e-04 eta 0:06:06
epoch [38/50] batch [100/319] time 0.086 (0.089) data 0.000 (0.005) loss 1.4350 (1.4208) ce_loss 1.4482 (1.3401) teacher_loss 0.6805 (0.7441) loss_zs_kd 0.4208 (0.4097) loss_oracle 0.5442 (0.4718) acc 53.1250 (50.7188) kd_loss 0.9472 (0.9311) lr 3.6258e-04 eta 0:05:59
epoch [38/50] batch [120/319] time 0.078 (0.088) data 0.000 (0.004) loss 1.4129 (1.4219) ce_loss 1.0264 (1.3392) teacher_loss 0.7247 (0.7449) loss_zs_kd 0.3922 (0.4080) loss_oracle 0.4921 (0.4730) acc 59.3750 (50.5990) kd_loss 0.9870 (0.9331) lr 3.6258e-04 eta 0:05:52
epoch [38/50] batch [140/319] time 0.085 (0.087) data 0.000 (0.004) loss 1.5279 (1.4288) ce_loss 1.5752 (1.3528) teacher_loss 0.8624 (0.7508) loss_zs_kd 0.4038 (0.4083) loss_oracle 0.4636 (0.4739) acc 53.1250 (49.7991) kd_loss 0.9584 (0.9348) lr 3.6258e-04 eta 0:05:48
epoch [38/50] batch [160/319] time 0.076 (0.087) data 0.000 (0.003) loss 1.2993 (1.4269) ce_loss 1.2734 (1.3552) teacher_loss 0.6979 (0.7497) loss_zs_kd 0.3495 (0.4077) loss_oracle 0.4266 (0.4734) acc 43.7500 (49.7656) kd_loss 0.9606 (0.9363) lr 3.6258e-04 eta 0:05:47
epoch [38/50] batch [180/319] time 0.074 (0.086) data 0.000 (0.003) loss 1.4675 (1.4305) ce_loss 1.3682 (1.3571) teacher_loss 0.7407 (0.7518) loss_zs_kd 0.3864 (0.4070) loss_oracle 0.5336 (0.4752) acc 28.1250 (49.1319) kd_loss 0.8490 (0.9312) lr 3.6258e-04 eta 0:05:41
epoch [38/50] batch [200/319] time 0.079 (0.086) data 0.000 (0.003) loss 1.4630 (1.4321) ce_loss 1.3359 (1.3639) teacher_loss 0.7821 (0.7536) loss_zs_kd 0.4400 (0.4083) loss_oracle 0.4609 (0.4744) acc 50.0000 (48.9062) kd_loss 0.8398 (0.9310) lr 3.6258e-04 eta 0:05:39
epoch [38/50] batch [220/319] time 0.081 (0.086) data 0.000 (0.002) loss 1.3649 (1.4274) ce_loss 1.4131 (1.3598) teacher_loss 0.6882 (0.7513) loss_zs_kd 0.3811 (0.4070) loss_oracle 0.4861 (0.4726) acc 59.3750 (48.9062) kd_loss 0.9686 (0.9307) lr 3.6258e-04 eta 0:05:36
epoch [38/50] batch [240/319] time 0.084 (0.086) data 0.000 (0.002) loss 1.2212 (1.4238) ce_loss 1.0693 (1.3531) teacher_loss 0.6942 (0.7475) loss_zs_kd 0.3348 (0.4070) loss_oracle 0.3595 (0.4728) acc 62.5000 (49.0885) kd_loss 0.8362 (0.9331) lr 3.6258e-04 eta 0:05:34
epoch [38/50] batch [260/319] time 0.086 (0.086) data 0.000 (0.002) loss 1.7119 (1.4262) ce_loss 1.6973 (1.3562) teacher_loss 0.9173 (0.7498) loss_zs_kd 0.4702 (0.4065) loss_oracle 0.5595 (0.4732) acc 37.5000 (49.0024) kd_loss 0.8526 (0.9321) lr 3.6258e-04 eta 0:05:32
epoch [38/50] batch [280/319] time 0.083 (0.086) data 0.000 (0.002) loss 1.2335 (1.4243) ce_loss 1.1230 (1.3567) teacher_loss 0.6164 (0.7493) loss_zs_kd 0.4160 (0.4066) loss_oracle 0.4091 (0.4717) acc 59.3750 (49.0513) kd_loss 0.8862 (0.9327) lr 3.6258e-04 eta 0:05:30
epoch [38/50] batch [300/319] time 0.081 (0.085) data 0.000 (0.002) loss 1.7030 (1.4257) ce_loss 1.7412 (1.3593) teacher_loss 0.9500 (0.7508) loss_zs_kd 0.4292 (0.4068) loss_oracle 0.5384 (0.4715) acc 34.3750 (48.9688) kd_loss 0.9738 (0.9307) lr 3.6258e-04 eta 0:05:28
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,296
* accuracy: 52.4%
* error: 47.6%
* macro_f1: 39.6%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,034
* accuracy: 41.4%
* error: 58.6%
* macro_f1: 15.1%
******* Domain 2 best val acc:      52.4%, epoch: 38 *******
******* Domain 2 best val test acc: 41.4%, epoch: 38 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [39/50] batch [20/319] time 0.090 (0.112) data 0.000 (0.028) loss 1.3708 (1.3733) ce_loss 1.3574 (1.2821) teacher_loss 0.6853 (0.7205) loss_zs_kd 0.4161 (0.4146) loss_oracle 0.4774 (0.4456) acc 50.0000 (53.2812) kd_loss 1.0050 (0.9230) lr 3.1545e-04 eta 0:07:05
epoch [39/50] batch [40/319] time 0.086 (0.097) data 0.000 (0.014) loss 1.5704 (1.3939) ce_loss 1.6289 (1.3125) teacher_loss 0.8879 (0.7324) loss_zs_kd 0.3679 (0.4105) loss_oracle 0.4986 (0.4563) acc 43.7500 (51.2500) kd_loss 1.0432 (0.9251) lr 3.1545e-04 eta 0:06:08
epoch [39/50] batch [60/319] time 0.083 (0.093) data 0.000 (0.009) loss 1.1810 (1.3981) ce_loss 1.1982 (1.3268) teacher_loss 0.5622 (0.7377) loss_zs_kd 0.3739 (0.4029) loss_oracle 0.4319 (0.4590) acc 56.2500 (50.5208) kd_loss 0.9359 (0.9251) lr 3.1545e-04 eta 0:05:51
epoch [39/50] batch [80/319] time 0.086 (0.091) data 0.000 (0.007) loss 1.5956 (1.3982) ce_loss 1.7012 (1.3332) teacher_loss 0.8454 (0.7387) loss_zs_kd 0.4557 (0.4038) loss_oracle 0.5223 (0.4576) acc 34.3750 (50.1172) kd_loss 0.9127 (0.9203) lr 3.1545e-04 eta 0:05:40
epoch [39/50] batch [100/319] time 0.074 (0.089) data 0.000 (0.006) loss 1.7292 (1.3996) ce_loss 1.8584 (1.3422) teacher_loss 0.9419 (0.7413) loss_zs_kd 0.4658 (0.4016) loss_oracle 0.5544 (0.4574) acc 28.1250 (49.6562) kd_loss 0.8640 (0.9171) lr 3.1545e-04 eta 0:05:31
epoch [39/50] batch [120/319] time 0.088 (0.088) data 0.000 (0.005) loss 1.5643 (1.3892) ce_loss 1.3428 (1.3325) teacher_loss 0.8973 (0.7324) loss_zs_kd 0.3506 (0.4014) loss_oracle 0.4917 (0.4560) acc 50.0000 (50.2083) kd_loss 0.8911 (0.9179) lr 3.1545e-04 eta 0:05:25
epoch [39/50] batch [140/319] time 0.086 (0.088) data 0.000 (0.004) loss 1.3375 (1.3900) ce_loss 1.2666 (1.3374) teacher_loss 0.4987 (0.7301) loss_zs_kd 0.4700 (0.4012) loss_oracle 0.6038 (0.4593) acc 71.8750 (50.4241) kd_loss 0.9496 (0.9180) lr 3.1545e-04 eta 0:05:22
epoch [39/50] batch [160/319] time 0.081 (0.086) data 0.000 (0.004) loss 1.3820 (1.3843) ce_loss 1.2900 (1.3286) teacher_loss 0.7527 (0.7266) loss_zs_kd 0.4318 (0.4011) loss_oracle 0.4134 (0.4572) acc 37.5000 (50.8789) kd_loss 0.8229 (0.9170) lr 3.1545e-04 eta 0:05:17
epoch [39/50] batch [180/319] time 0.085 (0.086) data 0.000 (0.003) loss 1.3554 (1.3858) ce_loss 1.5430 (1.3334) teacher_loss 0.6281 (0.7290) loss_zs_kd 0.4227 (0.4000) loss_oracle 0.5160 (0.4568) acc 40.6250 (50.7118) kd_loss 0.9236 (0.9168) lr 3.1545e-04 eta 0:05:14
epoch [39/50] batch [200/319] time 0.073 (0.085) data 0.000 (0.003) loss 1.1536 (1.3823) ce_loss 1.1562 (1.3328) teacher_loss 0.5456 (0.7258) loss_zs_kd 0.3821 (0.3997) loss_oracle 0.4170 (0.4566) acc 68.7500 (50.7500) kd_loss 1.0297 (0.9189) lr 3.1545e-04 eta 0:05:10
epoch [39/50] batch [220/319] time 0.082 (0.085) data 0.000 (0.003) loss 1.3776 (1.3829) ce_loss 1.2441 (1.3300) teacher_loss 0.7225 (0.7247) loss_zs_kd 0.4340 (0.4016) loss_oracle 0.4381 (0.4574) acc 56.2500 (50.8807) kd_loss 0.8863 (0.9190) lr 3.1545e-04 eta 0:05:05
epoch [39/50] batch [240/319] time 0.081 (0.084) data 0.000 (0.003) loss 1.6879 (1.3881) ce_loss 1.7148 (1.3356) teacher_loss 0.9017 (0.7279) loss_zs_kd 0.4662 (0.4027) loss_oracle 0.5530 (0.4589) acc 46.8750 (50.8594) kd_loss 0.9820 (0.9192) lr 3.1545e-04 eta 0:05:02
epoch [39/50] batch [260/319] time 0.083 (0.084) data 0.000 (0.002) loss 1.3039 (1.3895) ce_loss 1.1709 (1.3329) teacher_loss 0.7147 (0.7287) loss_zs_kd 0.3583 (0.4030) loss_oracle 0.4101 (0.4593) acc 56.2500 (50.8413) kd_loss 0.8473 (0.9200) lr 3.1545e-04 eta 0:04:59
epoch [39/50] batch [280/319] time 0.091 (0.084) data 0.000 (0.002) loss 1.6387 (1.3935) ce_loss 1.6494 (1.3364) teacher_loss 1.0620 (0.7330) loss_zs_kd 0.4050 (0.4031) loss_oracle 0.3742 (0.4590) acc 50.0000 (50.7812) kd_loss 0.9964 (0.9193) lr 3.1545e-04 eta 0:04:58
epoch [39/50] batch [300/319] time 0.081 (0.084) data 0.000 (0.002) loss 1.4334 (1.3955) ce_loss 1.3096 (1.3381) teacher_loss 0.7534 (0.7356) loss_zs_kd 0.4516 (0.4035) loss_oracle 0.4541 (0.4581) acc 46.8750 (50.6771) kd_loss 0.9517 (0.9185) lr 3.1545e-04 eta 0:04:56
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,246
* accuracy: 51.3%
* error: 48.7%
* macro_f1: 39.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,873
* accuracy: 39.8%
* error: 60.2%
* macro_f1: 15.8%
******* Domain 2 best val acc:      52.4%, epoch: 38 *******
******* Domain 2 best val test acc: 41.4%, epoch: 38 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [40/50] batch [20/319] time 0.086 (0.123) data 0.000 (0.032) loss 1.3795 (1.3524) ce_loss 1.2744 (1.2946) teacher_loss 0.7834 (0.7040) loss_zs_kd 0.3630 (0.3827) loss_oracle 0.4146 (0.4570) acc 53.1250 (53.2812) kd_loss 0.9394 (0.9350) lr 2.7103e-04 eta 0:07:07
epoch [40/50] batch [40/319] time 0.090 (0.103) data 0.000 (0.016) loss 1.3043 (1.4087) ce_loss 1.1484 (1.3566) teacher_loss 0.5934 (0.7481) loss_zs_kd 0.3717 (0.3975) loss_oracle 0.5250 (0.4618) acc 56.2500 (50.8594) kd_loss 0.9975 (0.9224) lr 2.7103e-04 eta 0:05:57
epoch [40/50] batch [60/319] time 0.082 (0.096) data 0.000 (0.011) loss 1.4073 (1.4171) ce_loss 1.5029 (1.3647) teacher_loss 0.6777 (0.7461) loss_zs_kd 0.4768 (0.4036) loss_oracle 0.4912 (0.4692) acc 40.6250 (49.6875) kd_loss 0.8596 (0.9131) lr 2.7103e-04 eta 0:05:31
epoch [40/50] batch [80/319] time 0.091 (0.093) data 0.000 (0.008) loss 1.1855 (1.4057) ce_loss 1.1250 (1.3351) teacher_loss 0.5735 (0.7359) loss_zs_kd 0.3744 (0.4033) loss_oracle 0.4248 (0.4681) acc 59.3750 (50.3125) kd_loss 0.9923 (0.9129) lr 2.7103e-04 eta 0:05:20
epoch [40/50] batch [100/319] time 0.081 (0.091) data 0.000 (0.007) loss 1.2360 (1.4021) ce_loss 1.1582 (1.3384) teacher_loss 0.6265 (0.7341) loss_zs_kd 0.3375 (0.3996) loss_oracle 0.4407 (0.4682) acc 50.0000 (50.0938) kd_loss 0.9250 (0.9155) lr 2.7103e-04 eta 0:05:10
epoch [40/50] batch [120/319] time 0.091 (0.090) data 0.000 (0.006) loss 1.3665 (1.4001) ce_loss 1.3867 (1.3276) teacher_loss 0.6193 (0.7313) loss_zs_kd 0.4453 (0.3998) loss_oracle 0.5246 (0.4689) acc 53.1250 (50.5208) kd_loss 0.9414 (0.9145) lr 2.7103e-04 eta 0:05:05
epoch [40/50] batch [140/319] time 0.081 (0.089) data 0.000 (0.005) loss 1.4330 (1.4022) ce_loss 1.3359 (1.3330) teacher_loss 0.8110 (0.7365) loss_zs_kd 0.3748 (0.3971) loss_oracle 0.4346 (0.4672) acc 40.6250 (50.1116) kd_loss 0.8889 (0.9123) lr 2.7103e-04 eta 0:05:01
epoch [40/50] batch [160/319] time 0.081 (0.089) data 0.000 (0.004) loss 1.4667 (1.3981) ce_loss 1.4844 (1.3300) teacher_loss 0.7416 (0.7334) loss_zs_kd 0.4051 (0.3997) loss_oracle 0.5225 (0.4649) acc 40.6250 (50.3125) kd_loss 1.0192 (0.9118) lr 2.7103e-04 eta 0:04:57
epoch [40/50] batch [180/319] time 0.087 (0.088) data 0.000 (0.004) loss 1.5623 (1.4001) ce_loss 1.7129 (1.3342) teacher_loss 0.9516 (0.7340) loss_zs_kd 0.3901 (0.4002) loss_oracle 0.4156 (0.4661) acc 46.8750 (50.3299) kd_loss 0.9793 (0.9109) lr 2.7103e-04 eta 0:04:53
epoch [40/50] batch [200/319] time 0.090 (0.088) data 0.000 (0.003) loss 1.2822 (1.4107) ce_loss 1.2432 (1.3460) teacher_loss 0.7193 (0.7446) loss_zs_kd 0.3942 (0.3998) loss_oracle 0.3659 (0.4662) acc 59.3750 (49.9531) kd_loss 0.8136 (0.9078) lr 2.7103e-04 eta 0:04:50
epoch [40/50] batch [220/319] time 0.085 (0.087) data 0.000 (0.003) loss 1.6018 (1.4143) ce_loss 1.5615 (1.3525) teacher_loss 0.9378 (0.7497) loss_zs_kd 0.4297 (0.3997) loss_oracle 0.4491 (0.4648) acc 34.3750 (49.6023) kd_loss 0.8324 (0.9058) lr 2.7103e-04 eta 0:04:47
epoch [40/50] batch [240/319] time 0.089 (0.087) data 0.000 (0.003) loss 1.6348 (1.4139) ce_loss 1.4287 (1.3498) teacher_loss 1.0230 (0.7493) loss_zs_kd 0.3887 (0.3999) loss_oracle 0.4175 (0.4647) acc 53.1250 (49.5833) kd_loss 0.8469 (0.9039) lr 2.7103e-04 eta 0:04:44
epoch [40/50] batch [260/319] time 0.092 (0.087) data 0.000 (0.003) loss 1.4638 (1.4149) ce_loss 1.4941 (1.3494) teacher_loss 0.7254 (0.7503) loss_zs_kd 0.4420 (0.4003) loss_oracle 0.5174 (0.4644) acc 40.6250 (49.5433) kd_loss 0.9107 (0.9016) lr 2.7103e-04 eta 0:04:42
epoch [40/50] batch [280/319] time 0.079 (0.087) data 0.000 (0.003) loss 1.4608 (1.4186) ce_loss 1.2285 (1.3509) teacher_loss 0.9114 (0.7547) loss_zs_kd 0.3335 (0.3989) loss_oracle 0.3827 (0.4644) acc 59.3750 (49.5982) kd_loss 0.7277 (0.8991) lr 2.7103e-04 eta 0:04:40
epoch [40/50] batch [300/319] time 0.081 (0.087) data 0.000 (0.002) loss 1.4544 (1.4207) ce_loss 1.3770 (1.3560) teacher_loss 0.8222 (0.7574) loss_zs_kd 0.3889 (0.3989) loss_oracle 0.4377 (0.4638) acc 46.8750 (49.6562) kd_loss 0.8721 (0.8984) lr 2.7103e-04 eta 0:04:37
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,222
* accuracy: 50.8%
* error: 49.2%
* macro_f1: 38.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,801
* accuracy: 39.0%
* error: 61.0%
* macro_f1: 15.1%
******* Domain 2 best val acc:      52.4%, epoch: 38 *******
******* Domain 2 best val test acc: 41.4%, epoch: 38 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [41/50] batch [20/319] time 0.085 (0.120) data 0.000 (0.034) loss 1.4253 (1.4226) ce_loss 1.3438 (1.4058) teacher_loss 0.6584 (0.7313) loss_zs_kd 0.4438 (0.4151) loss_oracle 0.5450 (0.4837) acc 50.0000 (46.0938) kd_loss 0.8849 (0.9009) lr 2.2949e-04 eta 0:06:19
epoch [41/50] batch [40/319] time 0.080 (0.102) data 0.000 (0.017) loss 1.5292 (1.4404) ce_loss 1.3916 (1.4017) teacher_loss 0.7985 (0.7479) loss_zs_kd 0.5003 (0.4145) loss_oracle 0.4805 (0.4853) acc 46.8750 (46.4062) kd_loss 0.8589 (0.9018) lr 2.2949e-04 eta 0:05:22
epoch [41/50] batch [60/319] time 0.089 (0.096) data 0.000 (0.011) loss 1.3916 (1.4386) ce_loss 1.3447 (1.3935) teacher_loss 0.7485 (0.7594) loss_zs_kd 0.3931 (0.4084) loss_oracle 0.4465 (0.4750) acc 53.1250 (47.4479) kd_loss 0.8850 (0.9022) lr 2.2949e-04 eta 0:04:59
epoch [41/50] batch [80/319] time 0.082 (0.093) data 0.000 (0.009) loss 1.4641 (1.4370) ce_loss 1.5430 (1.3849) teacher_loss 0.7374 (0.7581) loss_zs_kd 0.4091 (0.4106) loss_oracle 0.5221 (0.4736) acc 34.3750 (48.1250) kd_loss 0.9447 (0.9054) lr 2.2949e-04 eta 0:04:50
epoch [41/50] batch [100/319] time 0.085 (0.092) data 0.000 (0.007) loss 1.3078 (1.4349) ce_loss 1.0801 (1.3831) teacher_loss 0.7248 (0.7587) loss_zs_kd 0.3859 (0.4090) loss_oracle 0.3901 (0.4717) acc 75.0000 (48.9688) kd_loss 0.9529 (0.9065) lr 2.2949e-04 eta 0:04:43
epoch [41/50] batch [120/319] time 0.085 (0.091) data 0.000 (0.006) loss 1.2273 (1.4375) ce_loss 1.1104 (1.3712) teacher_loss 0.6363 (0.7627) loss_zs_kd 0.3568 (0.4050) loss_oracle 0.4126 (0.4723) acc 59.3750 (49.0625) kd_loss 0.9141 (0.9048) lr 2.2949e-04 eta 0:04:38
epoch [41/50] batch [140/319] time 0.081 (0.090) data 0.000 (0.005) loss 1.3212 (1.4323) ce_loss 1.0439 (1.3619) teacher_loss 0.6468 (0.7602) loss_zs_kd 0.3601 (0.4036) loss_oracle 0.4944 (0.4703) acc 56.2500 (49.7545) kd_loss 0.7940 (0.9063) lr 2.2949e-04 eta 0:04:33
epoch [41/50] batch [160/319] time 0.097 (0.089) data 0.001 (0.004) loss 1.4058 (1.4306) ce_loss 1.5654 (1.3588) teacher_loss 0.7264 (0.7597) loss_zs_kd 0.4233 (0.4014) loss_oracle 0.4678 (0.4701) acc 43.7500 (50.0586) kd_loss 0.9801 (0.9052) lr 2.2949e-04 eta 0:04:30
epoch [41/50] batch [180/319] time 0.068 (0.088) data 0.000 (0.004) loss 1.3967 (1.4308) ce_loss 1.4229 (1.3565) teacher_loss 0.7127 (0.7574) loss_zs_kd 0.4042 (0.4017) loss_oracle 0.4819 (0.4725) acc 50.0000 (50.1562) kd_loss 0.9745 (0.9048) lr 2.2949e-04 eta 0:04:25
epoch [41/50] batch [200/319] time 0.081 (0.087) data 0.000 (0.004) loss 1.2951 (1.4241) ce_loss 1.2871 (1.3508) teacher_loss 0.5626 (0.7511) loss_zs_kd 0.4130 (0.4005) loss_oracle 0.5259 (0.4728) acc 46.8750 (50.1406) kd_loss 0.9433 (0.9053) lr 2.2949e-04 eta 0:04:21
epoch [41/50] batch [220/319] time 0.077 (0.087) data 0.000 (0.003) loss 1.5425 (1.4229) ce_loss 1.5527 (1.3489) teacher_loss 0.8338 (0.7501) loss_zs_kd 0.4401 (0.4008) loss_oracle 0.4887 (0.4725) acc 37.5000 (50.2699) kd_loss 0.8591 (0.9039) lr 2.2949e-04 eta 0:04:18
epoch [41/50] batch [240/319] time 0.074 (0.087) data 0.000 (0.003) loss 1.4012 (1.4205) ce_loss 1.3184 (1.3457) teacher_loss 0.7958 (0.7495) loss_zs_kd 0.3609 (0.4006) loss_oracle 0.4250 (0.4707) acc 43.7500 (50.3646) kd_loss 0.9002 (0.9023) lr 2.2949e-04 eta 0:04:16
epoch [41/50] batch [260/319] time 0.085 (0.086) data 0.000 (0.003) loss 1.3211 (1.4210) ce_loss 1.2568 (1.3480) teacher_loss 0.7073 (0.7498) loss_zs_kd 0.3835 (0.4007) loss_oracle 0.4221 (0.4708) acc 40.6250 (50.2284) kd_loss 0.9254 (0.9027) lr 2.2949e-04 eta 0:04:12
epoch [41/50] batch [280/319] time 0.086 (0.086) data 0.000 (0.003) loss 1.3494 (1.4216) ce_loss 1.1553 (1.3473) teacher_loss 0.7301 (0.7506) loss_zs_kd 0.3259 (0.4008) loss_oracle 0.4564 (0.4706) acc 53.1250 (50.0558) kd_loss 0.7629 (0.9025) lr 2.2949e-04 eta 0:04:10
epoch [41/50] batch [300/319] time 0.096 (0.086) data 0.000 (0.002) loss 1.2674 (1.4199) ce_loss 1.0352 (1.3419) teacher_loss 0.6190 (0.7495) loss_zs_kd 0.3651 (0.3999) loss_oracle 0.4658 (0.4705) acc 56.2500 (50.0625) kd_loss 0.8118 (0.9009) lr 2.2949e-04 eta 0:04:08
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,262
* accuracy: 51.7%
* error: 48.3%
* macro_f1: 39.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,858
* accuracy: 39.6%
* error: 60.4%
* macro_f1: 15.0%
******* Domain 2 best val acc:      52.4%, epoch: 38 *******
******* Domain 2 best val test acc: 41.4%, epoch: 38 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [42/50] batch [20/319] time 0.077 (0.119) data 0.000 (0.032) loss 1.6420 (1.4291) ce_loss 1.5459 (1.3784) teacher_loss 0.8565 (0.7766) loss_zs_kd 0.4481 (0.3810) loss_oracle 0.5614 (0.4620) acc 31.2500 (47.9688) kd_loss 0.8599 (0.9067) lr 1.9098e-04 eta 0:05:40
epoch [42/50] batch [40/319] time 0.097 (0.102) data 0.001 (0.016) loss 1.2067 (1.4263) ce_loss 1.0869 (1.3649) teacher_loss 0.5041 (0.7596) loss_zs_kd 0.3749 (0.3914) loss_oracle 0.5151 (0.4710) acc 62.5000 (48.9062) kd_loss 0.9532 (0.9132) lr 1.9098e-04 eta 0:04:49
epoch [42/50] batch [60/319] time 0.071 (0.101) data 0.000 (0.011) loss 1.4606 (1.4276) ce_loss 1.3584 (1.3680) teacher_loss 0.7734 (0.7578) loss_zs_kd 0.3672 (0.3933) loss_oracle 0.5035 (0.4732) acc 53.1250 (49.4271) kd_loss 0.9355 (0.9179) lr 1.9098e-04 eta 0:04:44
epoch [42/50] batch [80/319] time 0.081 (0.097) data 0.000 (0.008) loss 1.4396 (1.4309) ce_loss 1.4746 (1.3793) teacher_loss 0.7717 (0.7587) loss_zs_kd 0.3916 (0.3963) loss_oracle 0.4721 (0.4741) acc 40.6250 (49.4531) kd_loss 0.8118 (0.9126) lr 1.9098e-04 eta 0:04:29
epoch [42/50] batch [100/319] time 0.088 (0.094) data 0.000 (0.007) loss 1.8288 (1.4424) ce_loss 1.4189 (1.3902) teacher_loss 1.1584 (0.7655) loss_zs_kd 0.4327 (0.4014) loss_oracle 0.4540 (0.4762) acc 53.1250 (49.0000) kd_loss 0.8457 (0.9080) lr 1.9098e-04 eta 0:04:19
epoch [42/50] batch [120/319] time 0.081 (0.092) data 0.000 (0.006) loss 1.5599 (1.4304) ce_loss 1.4688 (1.3676) teacher_loss 0.8709 (0.7558) loss_zs_kd 0.4283 (0.4029) loss_oracle 0.4748 (0.4732) acc 43.7500 (49.5312) kd_loss 0.8520 (0.9077) lr 1.9098e-04 eta 0:04:12
epoch [42/50] batch [140/319] time 0.076 (0.091) data 0.000 (0.005) loss 1.2701 (1.4290) ce_loss 1.1631 (1.3647) teacher_loss 0.4921 (0.7527) loss_zs_kd 0.4328 (0.4043) loss_oracle 0.5615 (0.4742) acc 53.1250 (49.5982) kd_loss 0.8559 (0.9052) lr 1.9098e-04 eta 0:04:07
epoch [42/50] batch [160/319] time 0.082 (0.090) data 0.000 (0.004) loss 1.6727 (1.4272) ce_loss 1.4199 (1.3571) teacher_loss 0.9558 (0.7518) loss_zs_kd 0.4676 (0.4048) loss_oracle 0.4831 (0.4730) acc 43.7500 (49.5898) kd_loss 0.9270 (0.9053) lr 1.9098e-04 eta 0:04:03
epoch [42/50] batch [180/319] time 0.090 (0.089) data 0.000 (0.004) loss 1.3728 (1.4268) ce_loss 1.2412 (1.3608) teacher_loss 0.6946 (0.7513) loss_zs_kd 0.4341 (0.4075) loss_oracle 0.4612 (0.4718) acc 62.5000 (49.5486) kd_loss 0.9596 (0.9075) lr 1.9098e-04 eta 0:03:59
epoch [42/50] batch [200/319] time 0.087 (0.088) data 0.000 (0.004) loss 1.4075 (1.4231) ce_loss 1.2871 (1.3564) teacher_loss 0.7768 (0.7480) loss_zs_kd 0.3458 (0.4065) loss_oracle 0.4578 (0.4718) acc 43.7500 (49.5312) kd_loss 0.8844 (0.9086) lr 1.9098e-04 eta 0:03:56
epoch [42/50] batch [220/319] time 0.084 (0.088) data 0.000 (0.003) loss 1.3378 (1.4212) ce_loss 1.2725 (1.3500) teacher_loss 0.7532 (0.7452) loss_zs_kd 0.3531 (0.4067) loss_oracle 0.4080 (0.4727) acc 56.2500 (49.6733) kd_loss 0.8387 (0.9083) lr 1.9098e-04 eta 0:03:53
epoch [42/50] batch [240/319] time 0.085 (0.088) data 0.000 (0.003) loss 1.5407 (1.4189) ce_loss 1.4756 (1.3492) teacher_loss 0.8331 (0.7427) loss_zs_kd 0.3978 (0.4058) loss_oracle 0.5087 (0.4734) acc 46.8750 (49.5964) kd_loss 0.8604 (0.9071) lr 1.9098e-04 eta 0:03:50
epoch [42/50] batch [260/319] time 0.079 (0.087) data 0.000 (0.003) loss 1.6173 (1.4164) ce_loss 1.5957 (1.3479) teacher_loss 0.8089 (0.7397) loss_zs_kd 0.4625 (0.4057) loss_oracle 0.5772 (0.4739) acc 40.6250 (49.5553) kd_loss 0.8981 (0.9073) lr 1.9098e-04 eta 0:03:48
epoch [42/50] batch [280/319] time 0.089 (0.087) data 0.000 (0.003) loss 1.4051 (1.4170) ce_loss 1.2979 (1.3474) teacher_loss 0.8297 (0.7405) loss_zs_kd 0.3688 (0.4064) loss_oracle 0.3911 (0.4733) acc 59.3750 (49.5647) kd_loss 0.8294 (0.9053) lr 1.9098e-04 eta 0:03:45
epoch [42/50] batch [300/319] time 0.082 (0.087) data 0.000 (0.002) loss 1.3780 (1.4196) ce_loss 1.1592 (1.3493) teacher_loss 0.6780 (0.7419) loss_zs_kd 0.4393 (0.4075) loss_oracle 0.4803 (0.4740) acc 53.1250 (49.5729) kd_loss 0.8328 (0.9045) lr 1.9098e-04 eta 0:03:43
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,293
* accuracy: 52.4%
* error: 47.6%
* macro_f1: 40.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,956
* accuracy: 40.6%
* error: 59.4%
* macro_f1: 15.2%
******* Domain 2 best val acc:      52.4%, epoch: 38 *******
******* Domain 2 best val test acc: 41.4%, epoch: 38 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [43/50] batch [20/319] time 0.086 (0.093) data 0.000 (0.024) loss 1.3811 (1.4055) ce_loss 1.3789 (1.3527) teacher_loss 0.6364 (0.7271) loss_zs_kd 0.4948 (0.4068) loss_oracle 0.4972 (0.4750) acc 56.2500 (51.7188) kd_loss 0.9680 (0.9175) lr 1.5567e-04 eta 0:03:55
epoch [43/50] batch [40/319] time 0.078 (0.088) data 0.000 (0.012) loss 1.6712 (1.4257) ce_loss 1.7090 (1.3772) teacher_loss 0.9694 (0.7338) loss_zs_kd 0.4075 (0.4061) loss_oracle 0.4981 (0.4888) acc 37.5000 (48.2031) kd_loss 0.9073 (0.9156) lr 1.5567e-04 eta 0:03:40
epoch [43/50] batch [60/319] time 0.082 (0.086) data 0.000 (0.008) loss 1.6353 (1.4199) ce_loss 1.3135 (1.3543) teacher_loss 0.9637 (0.7356) loss_zs_kd 0.4424 (0.4058) loss_oracle 0.4504 (0.4814) acc 46.8750 (48.6458) kd_loss 0.8413 (0.9021) lr 1.5567e-04 eta 0:03:34
epoch [43/50] batch [80/319] time 0.082 (0.085) data 0.000 (0.006) loss 1.3985 (1.4286) ce_loss 1.1650 (1.3634) teacher_loss 0.7090 (0.7427) loss_zs_kd 0.3983 (0.4067) loss_oracle 0.4904 (0.4825) acc 62.5000 (48.3594) kd_loss 0.8969 (0.9004) lr 1.5567e-04 eta 0:03:30
epoch [43/50] batch [100/319] time 0.085 (0.085) data 0.000 (0.005) loss 1.3330 (1.4205) ce_loss 1.2871 (1.3566) teacher_loss 0.6535 (0.7379) loss_zs_kd 0.3784 (0.4064) loss_oracle 0.4904 (0.4794) acc 53.1250 (49.1250) kd_loss 0.8998 (0.8954) lr 1.5567e-04 eta 0:03:27
epoch [43/50] batch [120/319] time 0.075 (0.084) data 0.000 (0.004) loss 1.3412 (1.4178) ce_loss 1.1826 (1.3556) teacher_loss 0.7274 (0.7364) loss_zs_kd 0.3931 (0.4052) loss_oracle 0.4172 (0.4788) acc 46.8750 (49.1146) kd_loss 0.7841 (0.8956) lr 1.5567e-04 eta 0:03:24
epoch [43/50] batch [140/319] time 0.083 (0.084) data 0.000 (0.004) loss 1.6552 (1.4234) ce_loss 1.6904 (1.3630) teacher_loss 0.9951 (0.7398) loss_zs_kd 0.3566 (0.4076) loss_oracle 0.4819 (0.4798) acc 28.1250 (48.3929) kd_loss 0.8579 (0.8938) lr 1.5567e-04 eta 0:03:22
epoch [43/50] batch [160/319] time 0.083 (0.084) data 0.000 (0.003) loss 1.3114 (1.4188) ce_loss 1.3428 (1.3594) teacher_loss 0.6253 (0.7339) loss_zs_kd 0.4232 (0.4092) loss_oracle 0.4745 (0.4803) acc 37.5000 (48.6523) kd_loss 0.8477 (0.8968) lr 1.5567e-04 eta 0:03:21
epoch [43/50] batch [180/319] time 0.079 (0.084) data 0.000 (0.003) loss 1.3873 (1.4235) ce_loss 1.4795 (1.3637) teacher_loss 0.7680 (0.7395) loss_zs_kd 0.3733 (0.4086) loss_oracle 0.4327 (0.4796) acc 50.0000 (48.7847) kd_loss 0.9102 (0.8993) lr 1.5567e-04 eta 0:03:19
epoch [43/50] batch [200/319] time 0.082 (0.084) data 0.000 (0.003) loss 1.4741 (1.4218) ce_loss 1.2500 (1.3596) teacher_loss 0.8560 (0.7387) loss_zs_kd 0.3718 (0.4089) loss_oracle 0.4321 (0.4786) acc 40.6250 (48.7812) kd_loss 0.8116 (0.9012) lr 1.5567e-04 eta 0:03:17
epoch [43/50] batch [220/319] time 0.092 (0.084) data 0.000 (0.002) loss 1.5398 (1.4250) ce_loss 1.4736 (1.3646) teacher_loss 0.8536 (0.7443) loss_zs_kd 0.4001 (0.4074) loss_oracle 0.4861 (0.4770) acc 43.7500 (48.7216) kd_loss 0.8907 (0.9014) lr 1.5567e-04 eta 0:03:16
epoch [43/50] batch [240/319] time 0.084 (0.084) data 0.000 (0.002) loss 1.3168 (1.4217) ce_loss 1.2061 (1.3594) teacher_loss 0.6404 (0.7419) loss_zs_kd 0.4735 (0.4074) loss_oracle 0.4396 (0.4761) acc 53.1250 (48.9714) kd_loss 0.8220 (0.9022) lr 1.5567e-04 eta 0:03:15
epoch [43/50] batch [260/319] time 0.080 (0.084) data 0.000 (0.002) loss 1.4317 (1.4221) ce_loss 1.1514 (1.3576) teacher_loss 0.6726 (0.7417) loss_zs_kd 0.4660 (0.4073) loss_oracle 0.5261 (0.4767) acc 56.2500 (49.0625) kd_loss 0.8080 (0.9029) lr 1.5567e-04 eta 0:03:13
epoch [43/50] batch [280/319] time 0.084 (0.085) data 0.000 (0.002) loss 1.4992 (1.4196) ce_loss 1.3174 (1.3549) teacher_loss 0.8295 (0.7394) loss_zs_kd 0.3957 (0.4069) loss_oracle 0.4719 (0.4768) acc 56.2500 (49.3192) kd_loss 0.8610 (0.9012) lr 1.5567e-04 eta 0:03:12
epoch [43/50] batch [300/319] time 0.079 (0.084) data 0.000 (0.002) loss 1.4378 (1.4191) ce_loss 1.3174 (1.3524) teacher_loss 0.7928 (0.7392) loss_zs_kd 0.3713 (0.4070) loss_oracle 0.4594 (0.4763) acc 46.8750 (49.3750) kd_loss 0.9517 (0.9008) lr 1.5567e-04 eta 0:03:09
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,259
* accuracy: 51.6%
* error: 48.4%
* macro_f1: 39.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,950
* accuracy: 40.6%
* error: 59.4%
* macro_f1: 15.2%
******* Domain 2 best val acc:      52.4%, epoch: 38 *******
******* Domain 2 best val test acc: 41.4%, epoch: 38 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [44/50] batch [20/319] time 0.080 (0.113) data 0.000 (0.026) loss 1.5607 (1.4125) ce_loss 1.3838 (1.3261) teacher_loss 0.8966 (0.7299) loss_zs_kd 0.4028 (0.4003) loss_oracle 0.4627 (0.4824) acc 43.7500 (48.5938) kd_loss 0.7696 (0.9046) lr 1.2369e-04 eta 0:04:09
epoch [44/50] batch [40/319] time 0.080 (0.098) data 0.000 (0.013) loss 1.5677 (1.4203) ce_loss 1.4141 (1.3384) teacher_loss 1.0165 (0.7456) loss_zs_kd 0.3406 (0.4032) loss_oracle 0.3809 (0.4731) acc 46.8750 (49.2188) kd_loss 0.7503 (0.8818) lr 1.2369e-04 eta 0:03:36
epoch [44/50] batch [60/319] time 0.081 (0.093) data 0.000 (0.009) loss 1.1065 (1.4095) ce_loss 1.1826 (1.3277) teacher_loss 0.4739 (0.7425) loss_zs_kd 0.3695 (0.3978) loss_oracle 0.4479 (0.4681) acc 53.1250 (50.1562) kd_loss 1.0088 (0.8935) lr 1.2369e-04 eta 0:03:22
epoch [44/50] batch [80/319] time 0.082 (0.090) data 0.000 (0.007) loss 1.4937 (1.4029) ce_loss 1.4590 (1.3260) teacher_loss 0.7311 (0.7355) loss_zs_kd 0.4202 (0.3989) loss_oracle 0.5524 (0.4679) acc 53.1250 (50.7422) kd_loss 1.0647 (0.8974) lr 1.2369e-04 eta 0:03:14
epoch [44/50] batch [100/319] time 0.088 (0.089) data 0.000 (0.006) loss 1.4701 (1.4075) ce_loss 1.3408 (1.3323) teacher_loss 0.7395 (0.7376) loss_zs_kd 0.3787 (0.4013) loss_oracle 0.5412 (0.4692) acc 43.7500 (50.0938) kd_loss 0.9385 (0.9006) lr 1.2369e-04 eta 0:03:09
epoch [44/50] batch [120/319] time 0.084 (0.088) data 0.000 (0.005) loss 1.4475 (1.4154) ce_loss 1.6133 (1.3472) teacher_loss 0.7389 (0.7485) loss_zs_kd 0.4333 (0.3988) loss_oracle 0.4920 (0.4676) acc 46.8750 (49.8438) kd_loss 0.9259 (0.8952) lr 1.2369e-04 eta 0:03:06
epoch [44/50] batch [140/319] time 0.074 (0.088) data 0.000 (0.004) loss 1.5006 (1.4174) ce_loss 1.5869 (1.3483) teacher_loss 0.8062 (0.7528) loss_zs_kd 0.3769 (0.3982) loss_oracle 0.5059 (0.4655) acc 43.7500 (49.7098) kd_loss 0.8318 (0.8917) lr 1.2369e-04 eta 0:03:03
epoch [44/50] batch [160/319] time 0.086 (0.087) data 0.000 (0.004) loss 1.3993 (1.4218) ce_loss 1.4062 (1.3467) teacher_loss 0.7682 (0.7558) loss_zs_kd 0.3667 (0.3992) loss_oracle 0.4477 (0.4663) acc 46.8750 (49.5312) kd_loss 0.8787 (0.8896) lr 1.2369e-04 eta 0:02:59
epoch [44/50] batch [180/319] time 0.080 (0.086) data 0.000 (0.003) loss 1.5403 (1.4257) ce_loss 1.4072 (1.3544) teacher_loss 0.9273 (0.7571) loss_zs_kd 0.3530 (0.3996) loss_oracle 0.4365 (0.4688) acc 46.8750 (49.0278) kd_loss 0.8132 (0.8910) lr 1.2369e-04 eta 0:02:57
epoch [44/50] batch [200/319] time 0.079 (0.086) data 0.000 (0.003) loss 1.0618 (1.4230) ce_loss 0.9551 (1.3535) teacher_loss 0.3808 (0.7524) loss_zs_kd 0.3527 (0.4015) loss_oracle 0.5046 (0.4698) acc 62.5000 (49.1250) kd_loss 0.8426 (0.8923) lr 1.2369e-04 eta 0:02:55
epoch [44/50] batch [220/319] time 0.084 (0.086) data 0.000 (0.003) loss 1.3564 (1.4214) ce_loss 1.1719 (1.3545) teacher_loss 0.6771 (0.7481) loss_zs_kd 0.4089 (0.4036) loss_oracle 0.4749 (0.4715) acc 53.1250 (49.1477) kd_loss 0.8281 (0.8932) lr 1.2369e-04 eta 0:02:52
epoch [44/50] batch [240/319] time 0.083 (0.086) data 0.000 (0.002) loss 1.6600 (1.4201) ce_loss 1.4854 (1.3511) teacher_loss 0.9107 (0.7455) loss_zs_kd 0.4782 (0.4048) loss_oracle 0.5102 (0.4723) acc 65.6250 (49.4661) kd_loss 0.9622 (0.8953) lr 1.2369e-04 eta 0:02:50
epoch [44/50] batch [260/319] time 0.079 (0.085) data 0.000 (0.002) loss 1.5194 (1.4206) ce_loss 1.3975 (1.3485) teacher_loss 0.7441 (0.7447) loss_zs_kd 0.3878 (0.4047) loss_oracle 0.5814 (0.4735) acc 50.0000 (49.3510) kd_loss 0.9160 (0.8959) lr 1.2369e-04 eta 0:02:48
epoch [44/50] batch [280/319] time 0.081 (0.085) data 0.000 (0.002) loss 1.6441 (1.4210) ce_loss 1.5713 (1.3463) teacher_loss 0.9491 (0.7452) loss_zs_kd 0.3622 (0.4043) loss_oracle 0.5138 (0.4736) acc 40.6250 (49.5424) kd_loss 0.9106 (0.8964) lr 1.2369e-04 eta 0:02:46
epoch [44/50] batch [300/319] time 0.085 (0.085) data 0.000 (0.002) loss 1.4775 (1.4213) ce_loss 1.2822 (1.3462) teacher_loss 0.8437 (0.7467) loss_zs_kd 0.3970 (0.4038) loss_oracle 0.4353 (0.4727) acc 56.2500 (49.5625) kd_loss 0.8045 (0.8954) lr 1.2369e-04 eta 0:02:43
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,255
* accuracy: 51.5%
* error: 48.5%
* macro_f1: 39.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,889
* accuracy: 39.9%
* error: 60.1%
* macro_f1: 14.9%
******* Domain 2 best val acc:      52.4%, epoch: 38 *******
******* Domain 2 best val test acc: 41.4%, epoch: 38 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [45/50] batch [20/319] time 0.079 (0.120) data 0.000 (0.028) loss 1.3457 (1.3861) ce_loss 1.2305 (1.3178) teacher_loss 0.6739 (0.7210) loss_zs_kd 0.3160 (0.3997) loss_oracle 0.5138 (0.4653) acc 62.5000 (52.1875) kd_loss 0.8730 (0.9099) lr 9.5173e-05 eta 0:03:46
epoch [45/50] batch [40/319] time 0.077 (0.101) data 0.000 (0.014) loss 1.4048 (1.4043) ce_loss 1.3555 (1.3378) teacher_loss 0.7756 (0.7354) loss_zs_kd 0.3597 (0.3999) loss_oracle 0.4494 (0.4690) acc 50.0000 (50.9375) kd_loss 0.9671 (0.9098) lr 9.5173e-05 eta 0:03:09
epoch [45/50] batch [60/319] time 0.088 (0.095) data 0.001 (0.010) loss 1.4830 (1.4233) ce_loss 1.4375 (1.3594) teacher_loss 0.8099 (0.7543) loss_zs_kd 0.4233 (0.4060) loss_oracle 0.4615 (0.4659) acc 53.1250 (49.5312) kd_loss 0.8472 (0.9048) lr 9.5173e-05 eta 0:02:56
epoch [45/50] batch [80/319] time 0.088 (0.093) data 0.000 (0.007) loss 1.5183 (1.4180) ce_loss 1.4277 (1.3453) teacher_loss 0.7694 (0.7472) loss_zs_kd 0.4795 (0.4040) loss_oracle 0.5092 (0.4688) acc 56.2500 (50.3125) kd_loss 0.9611 (0.9053) lr 9.5173e-05 eta 0:02:50
epoch [45/50] batch [100/319] time 0.086 (0.091) data 0.000 (0.006) loss 1.3434 (1.4105) ce_loss 1.1367 (1.3426) teacher_loss 0.6915 (0.7389) loss_zs_kd 0.3747 (0.4046) loss_oracle 0.4645 (0.4693) acc 59.3750 (49.8125) kd_loss 0.8697 (0.9066) lr 9.5173e-05 eta 0:02:45
epoch [45/50] batch [120/319] time 0.085 (0.090) data 0.000 (0.005) loss 1.4736 (1.4082) ce_loss 1.2920 (1.3423) teacher_loss 0.7747 (0.7386) loss_zs_kd 0.3418 (0.4012) loss_oracle 0.5280 (0.4690) acc 46.8750 (49.5573) kd_loss 0.9192 (0.9077) lr 9.5173e-05 eta 0:02:41
epoch [45/50] batch [140/319] time 0.078 (0.089) data 0.000 (0.004) loss 1.2891 (1.4036) ce_loss 1.2383 (1.3332) teacher_loss 0.6755 (0.7353) loss_zs_kd 0.3709 (0.3999) loss_oracle 0.4281 (0.4683) acc 50.0000 (49.6875) kd_loss 0.9075 (0.9046) lr 9.5173e-05 eta 0:02:38
epoch [45/50] batch [160/319] time 0.087 (0.088) data 0.000 (0.004) loss 1.2047 (1.3972) ce_loss 1.1533 (1.3268) teacher_loss 0.6556 (0.7322) loss_zs_kd 0.3617 (0.3975) loss_oracle 0.3683 (0.4663) acc 50.0000 (49.7070) kd_loss 0.8895 (0.9057) lr 9.5173e-05 eta 0:02:34
epoch [45/50] batch [180/319] time 0.084 (0.088) data 0.000 (0.003) loss 1.3485 (1.3977) ce_loss 1.1865 (1.3217) teacher_loss 0.7030 (0.7298) loss_zs_kd 0.4806 (0.3996) loss_oracle 0.4052 (0.4680) acc 53.1250 (49.8264) kd_loss 0.8548 (0.9067) lr 9.5173e-05 eta 0:02:32
epoch [45/50] batch [200/319] time 0.081 (0.088) data 0.000 (0.003) loss 1.4200 (1.4006) ce_loss 1.5029 (1.3290) teacher_loss 0.7324 (0.7322) loss_zs_kd 0.3981 (0.3985) loss_oracle 0.4886 (0.4690) acc 31.2500 (49.5625) kd_loss 0.8234 (0.9037) lr 9.5173e-05 eta 0:02:30
epoch [45/50] batch [220/319] time 0.088 (0.087) data 0.000 (0.003) loss 1.1469 (1.4013) ce_loss 0.9985 (1.3301) teacher_loss 0.4586 (0.7331) loss_zs_kd 0.3419 (0.3979) loss_oracle 0.5173 (0.4692) acc 59.3750 (49.4744) kd_loss 0.9298 (0.9044) lr 9.5173e-05 eta 0:02:27
epoch [45/50] batch [240/319] time 0.083 (0.087) data 0.000 (0.003) loss 1.5821 (1.3987) ce_loss 1.7021 (1.3304) teacher_loss 0.8941 (0.7300) loss_zs_kd 0.4210 (0.3980) loss_oracle 0.4774 (0.4696) acc 28.1250 (49.3880) kd_loss 0.8809 (0.9064) lr 9.5173e-05 eta 0:02:25
epoch [45/50] batch [260/319] time 0.083 (0.086) data 0.000 (0.002) loss 1.6542 (1.4061) ce_loss 1.5234 (1.3417) teacher_loss 0.8830 (0.7370) loss_zs_kd 0.4112 (0.3981) loss_oracle 0.5656 (0.4701) acc 40.6250 (49.1346) kd_loss 0.7763 (0.9085) lr 9.5173e-05 eta 0:02:22
epoch [45/50] batch [280/319] time 0.083 (0.086) data 0.000 (0.002) loss 1.1806 (1.4066) ce_loss 1.0498 (1.3417) teacher_loss 0.5874 (0.7388) loss_zs_kd 0.4020 (0.3985) loss_oracle 0.3922 (0.4686) acc 62.5000 (49.1853) kd_loss 0.9159 (0.9075) lr 9.5173e-05 eta 0:02:20
epoch [45/50] batch [300/319] time 0.090 (0.086) data 0.000 (0.002) loss 1.1995 (1.4046) ce_loss 1.0039 (1.3367) teacher_loss 0.6347 (0.7370) loss_zs_kd 0.3189 (0.3988) loss_oracle 0.4054 (0.4682) acc 59.3750 (49.3542) kd_loss 0.9231 (0.9067) lr 9.5173e-05 eta 0:02:18
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,261
* accuracy: 51.6%
* error: 48.4%
* macro_f1: 39.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,973
* accuracy: 40.8%
* error: 59.2%
* macro_f1: 15.2%
******* Domain 2 best val acc:      52.4%, epoch: 38 *******
******* Domain 2 best val test acc: 41.4%, epoch: 38 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [46/50] batch [20/319] time 0.085 (0.118) data 0.000 (0.033) loss 1.4068 (1.3584) ce_loss 1.4893 (1.2673) teacher_loss 0.6967 (0.6977) loss_zs_kd 0.3899 (0.4068) loss_oracle 0.5152 (0.4573) acc 43.7500 (52.5000) kd_loss 0.8862 (0.8990) lr 7.0224e-05 eta 0:03:05
epoch [46/50] batch [40/319] time 0.080 (0.103) data 0.000 (0.016) loss 1.5408 (1.3904) ce_loss 1.4160 (1.3001) teacher_loss 0.8405 (0.7252) loss_zs_kd 0.3923 (0.4037) loss_oracle 0.5041 (0.4634) acc 46.8750 (51.4062) kd_loss 0.8376 (0.9054) lr 7.0224e-05 eta 0:02:40
epoch [46/50] batch [60/319] time 0.091 (0.097) data 0.000 (0.011) loss 1.4216 (1.3963) ce_loss 1.4043 (1.3161) teacher_loss 0.7395 (0.7215) loss_zs_kd 0.3895 (0.4041) loss_oracle 0.4873 (0.4727) acc 56.2500 (50.7292) kd_loss 0.8697 (0.9081) lr 7.0224e-05 eta 0:02:28
epoch [46/50] batch [80/319] time 0.084 (0.094) data 0.000 (0.008) loss 1.3713 (1.4029) ce_loss 1.3311 (1.3246) teacher_loss 0.7218 (0.7247) loss_zs_kd 0.3491 (0.4056) loss_oracle 0.4750 (0.4753) acc 56.2500 (50.8984) kd_loss 0.9241 (0.9140) lr 7.0224e-05 eta 0:02:22
epoch [46/50] batch [100/319] time 0.079 (0.092) data 0.000 (0.007) loss 1.1903 (1.4020) ce_loss 1.1270 (1.3311) teacher_loss 0.5412 (0.7209) loss_zs_kd 0.3849 (0.4070) loss_oracle 0.4566 (0.4776) acc 46.8750 (50.5625) kd_loss 0.9799 (0.9187) lr 7.0224e-05 eta 0:02:18
epoch [46/50] batch [120/319] time 0.081 (0.089) data 0.000 (0.006) loss 1.4111 (1.3947) ce_loss 1.3359 (1.3231) teacher_loss 0.7839 (0.7170) loss_zs_kd 0.3696 (0.4051) loss_oracle 0.4424 (0.4752) acc 50.0000 (50.5469) kd_loss 0.9201 (0.9156) lr 7.0224e-05 eta 0:02:11
epoch [46/50] batch [140/319] time 0.084 (0.088) data 0.000 (0.005) loss 1.2237 (1.3991) ce_loss 1.0176 (1.3339) teacher_loss 0.6398 (0.7208) loss_zs_kd 0.3042 (0.4052) loss_oracle 0.4318 (0.4757) acc 65.6250 (50.0893) kd_loss 0.8453 (0.9153) lr 7.0224e-05 eta 0:02:08
epoch [46/50] batch [160/319] time 0.083 (0.088) data 0.000 (0.004) loss 1.1435 (1.3948) ce_loss 1.0010 (1.3259) teacher_loss 0.5725 (0.7186) loss_zs_kd 0.3239 (0.4058) loss_oracle 0.4090 (0.4733) acc 68.7500 (50.4102) kd_loss 0.8809 (0.9132) lr 7.0224e-05 eta 0:02:06
epoch [46/50] batch [180/319] time 0.075 (0.088) data 0.000 (0.004) loss 1.4764 (1.3981) ce_loss 1.3193 (1.3281) teacher_loss 0.7403 (0.7215) loss_zs_kd 0.3810 (0.4067) loss_oracle 0.5456 (0.4732) acc 53.1250 (50.5729) kd_loss 0.8852 (0.9110) lr 7.0224e-05 eta 0:02:04
epoch [46/50] batch [200/319] time 0.084 (0.087) data 0.000 (0.004) loss 1.4054 (1.3974) ce_loss 1.2656 (1.3282) teacher_loss 0.7655 (0.7212) loss_zs_kd 0.3792 (0.4070) loss_oracle 0.4503 (0.4728) acc 46.8750 (50.4688) kd_loss 0.7638 (0.9098) lr 7.0224e-05 eta 0:02:01
epoch [46/50] batch [220/319] time 0.088 (0.087) data 0.000 (0.003) loss 1.5116 (1.4037) ce_loss 1.3340 (1.3357) teacher_loss 0.9249 (0.7296) loss_zs_kd 0.4128 (0.4055) loss_oracle 0.3803 (0.4714) acc 50.0000 (50.0284) kd_loss 0.9170 (0.9085) lr 7.0224e-05 eta 0:01:59
epoch [46/50] batch [240/319] time 0.089 (0.087) data 0.000 (0.003) loss 1.2660 (1.4054) ce_loss 1.3389 (1.3371) teacher_loss 0.6362 (0.7304) loss_zs_kd 0.3763 (0.4062) loss_oracle 0.4417 (0.4718) acc 53.1250 (49.9609) kd_loss 0.9240 (0.9070) lr 7.0224e-05 eta 0:01:57
epoch [46/50] batch [260/319] time 0.084 (0.086) data 0.000 (0.003) loss 1.3180 (1.4050) ce_loss 1.1982 (1.3370) teacher_loss 0.6032 (0.7305) loss_zs_kd 0.3934 (0.4065) loss_oracle 0.5180 (0.4712) acc 59.3750 (49.8798) kd_loss 0.9837 (0.9074) lr 7.0224e-05 eta 0:01:55
epoch [46/50] batch [280/319] time 0.085 (0.086) data 0.000 (0.003) loss 1.4473 (1.4074) ce_loss 1.4150 (1.3387) teacher_loss 0.8243 (0.7346) loss_zs_kd 0.3675 (0.4061) loss_oracle 0.4393 (0.4698) acc 43.7500 (49.7433) kd_loss 0.8698 (0.9081) lr 7.0224e-05 eta 0:01:53
epoch [46/50] batch [300/319] time 0.082 (0.086) data 0.001 (0.002) loss 1.5818 (1.4057) ce_loss 1.6318 (1.3367) teacher_loss 0.8879 (0.7330) loss_zs_kd 0.4190 (0.4052) loss_oracle 0.4844 (0.4702) acc 37.5000 (49.7188) kd_loss 0.8421 (0.9072) lr 7.0224e-05 eta 0:01:51
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,259
* accuracy: 51.6%
* error: 48.4%
* macro_f1: 39.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,918
* accuracy: 40.2%
* error: 59.8%
* macro_f1: 15.1%
******* Domain 2 best val acc:      52.4%, epoch: 38 *******
******* Domain 2 best val test acc: 41.4%, epoch: 38 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [47/50] batch [20/319] time 0.089 (0.109) data 0.000 (0.029) loss 1.2881 (1.4470) ce_loss 1.2910 (1.3706) teacher_loss 0.5662 (0.7757) loss_zs_kd 0.3912 (0.3981) loss_oracle 0.5264 (0.4723) acc 53.1250 (50.4688) kd_loss 0.9640 (0.9028) lr 4.8943e-05 eta 0:02:16
epoch [47/50] batch [40/319] time 0.087 (0.096) data 0.000 (0.015) loss 1.3807 (1.4263) ce_loss 1.4248 (1.3692) teacher_loss 0.7379 (0.7611) loss_zs_kd 0.4130 (0.3974) loss_oracle 0.4363 (0.4666) acc 53.1250 (49.6094) kd_loss 0.9416 (0.9015) lr 4.8943e-05 eta 0:01:59
epoch [47/50] batch [60/319] time 0.084 (0.093) data 0.000 (0.010) loss 1.4318 (1.4206) ce_loss 1.2881 (1.3696) teacher_loss 0.7366 (0.7475) loss_zs_kd 0.4178 (0.4012) loss_oracle 0.4863 (0.4725) acc 53.1250 (48.8542) kd_loss 0.8620 (0.9064) lr 4.8943e-05 eta 0:01:52
epoch [47/50] batch [80/319] time 0.076 (0.090) data 0.000 (0.008) loss 1.3844 (1.4161) ce_loss 1.1797 (1.3646) teacher_loss 0.8128 (0.7500) loss_zs_kd 0.3581 (0.3999) loss_oracle 0.3925 (0.4661) acc 37.5000 (48.9844) kd_loss 0.8075 (0.9041) lr 4.8943e-05 eta 0:01:47
epoch [47/50] batch [100/319] time 0.078 (0.089) data 0.000 (0.006) loss 1.2217 (1.4173) ce_loss 1.1846 (1.3611) teacher_loss 0.5564 (0.7499) loss_zs_kd 0.3928 (0.4019) loss_oracle 0.4689 (0.4665) acc 50.0000 (49.3438) kd_loss 0.9016 (0.8998) lr 4.8943e-05 eta 0:01:44
epoch [47/50] batch [120/319] time 0.072 (0.087) data 0.000 (0.005) loss 1.2296 (1.4102) ce_loss 1.0928 (1.3481) teacher_loss 0.6345 (0.7420) loss_zs_kd 0.3498 (0.4021) loss_oracle 0.4201 (0.4671) acc 50.0000 (49.6875) kd_loss 0.8470 (0.8989) lr 4.8943e-05 eta 0:01:40
epoch [47/50] batch [140/319] time 0.093 (0.086) data 0.000 (0.004) loss 1.5564 (1.4072) ce_loss 1.6602 (1.3441) teacher_loss 0.9312 (0.7384) loss_zs_kd 0.4000 (0.4017) loss_oracle 0.4251 (0.4679) acc 31.2500 (49.6875) kd_loss 0.8925 (0.8998) lr 4.8943e-05 eta 0:01:38
epoch [47/50] batch [160/319] time 0.087 (0.086) data 0.000 (0.004) loss 1.1314 (1.4040) ce_loss 1.1572 (1.3399) teacher_loss 0.6343 (0.7353) loss_zs_kd 0.3060 (0.4019) loss_oracle 0.3442 (0.4678) acc 68.7500 (49.6680) kd_loss 0.9622 (0.9003) lr 4.8943e-05 eta 0:01:36
epoch [47/50] batch [180/319] time 0.084 (0.086) data 0.000 (0.004) loss 1.4737 (1.4105) ce_loss 1.4678 (1.3485) teacher_loss 0.7155 (0.7405) loss_zs_kd 0.4188 (0.4031) loss_oracle 0.5488 (0.4685) acc 40.6250 (49.2882) kd_loss 0.8671 (0.8995) lr 4.8943e-05 eta 0:01:34
epoch [47/50] batch [200/319] time 0.089 (0.086) data 0.000 (0.003) loss 1.5185 (1.4046) ce_loss 1.3965 (1.3408) teacher_loss 0.8181 (0.7360) loss_zs_kd 0.3653 (0.4019) loss_oracle 0.5178 (0.4676) acc 59.3750 (49.9375) kd_loss 1.0610 (0.8998) lr 4.8943e-05 eta 0:01:32
epoch [47/50] batch [220/319] time 0.083 (0.086) data 0.000 (0.003) loss 1.2738 (1.4036) ce_loss 1.2441 (1.3407) teacher_loss 0.5887 (0.7340) loss_zs_kd 0.4138 (0.4027) loss_oracle 0.4782 (0.4682) acc 56.2500 (49.8580) kd_loss 0.8677 (0.9008) lr 4.8943e-05 eta 0:01:30
epoch [47/50] batch [240/319] time 0.079 (0.086) data 0.000 (0.003) loss 1.1680 (1.4086) ce_loss 1.0332 (1.3443) teacher_loss 0.5435 (0.7377) loss_zs_kd 0.3886 (0.4035) loss_oracle 0.4303 (0.4692) acc 65.6250 (49.7526) kd_loss 0.8826 (0.9014) lr 4.8943e-05 eta 0:01:28
epoch [47/50] batch [260/319] time 0.090 (0.085) data 0.000 (0.003) loss 1.5821 (1.4125) ce_loss 1.5010 (1.3457) teacher_loss 0.9202 (0.7417) loss_zs_kd 0.3515 (0.4033) loss_oracle 0.4861 (0.4692) acc 46.8750 (49.6274) kd_loss 0.9374 (0.9008) lr 4.8943e-05 eta 0:01:26
epoch [47/50] batch [280/319] time 0.089 (0.085) data 0.000 (0.002) loss 1.5233 (1.4124) ce_loss 1.2021 (1.3418) teacher_loss 0.9107 (0.7412) loss_zs_kd 0.3571 (0.4036) loss_oracle 0.4341 (0.4694) acc 50.0000 (49.7991) kd_loss 0.8727 (0.9011) lr 4.8943e-05 eta 0:01:25
epoch [47/50] batch [300/319] time 0.094 (0.085) data 0.000 (0.002) loss 1.2221 (1.4106) ce_loss 1.1318 (1.3426) teacher_loss 0.6017 (0.7399) loss_zs_kd 0.3555 (0.4032) loss_oracle 0.4427 (0.4691) acc 53.1250 (49.8333) kd_loss 1.0031 (0.9028) lr 4.8943e-05 eta 0:01:22
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,261
* accuracy: 51.6%
* error: 48.4%
* macro_f1: 39.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,904
* accuracy: 40.1%
* error: 59.9%
* macro_f1: 15.1%
******* Domain 2 best val acc:      52.4%, epoch: 38 *******
******* Domain 2 best val test acc: 41.4%, epoch: 38 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [48/50] batch [20/319] time 0.079 (0.105) data 0.000 (0.025) loss 1.4307 (1.4541) ce_loss 1.2197 (1.3967) teacher_loss 0.8280 (0.7836) loss_zs_kd 0.3709 (0.3904) loss_oracle 0.4173 (0.4752) acc 53.1250 (47.5000) kd_loss 0.8091 (0.9112) lr 3.1417e-05 eta 0:01:38
epoch [48/50] batch [40/319] time 0.091 (0.094) data 0.000 (0.012) loss 1.4080 (1.4667) ce_loss 1.3799 (1.4027) teacher_loss 0.7874 (0.7946) loss_zs_kd 0.3475 (0.3960) loss_oracle 0.4469 (0.4740) acc 46.8750 (46.7969) kd_loss 0.8571 (0.9015) lr 3.1417e-05 eta 0:01:26
epoch [48/50] batch [60/319] time 0.077 (0.089) data 0.000 (0.008) loss 1.3884 (1.4498) ce_loss 1.2305 (1.4052) teacher_loss 0.7496 (0.7769) loss_zs_kd 0.3226 (0.3980) loss_oracle 0.4775 (0.4739) acc 56.2500 (47.1354) kd_loss 0.9385 (0.9076) lr 3.1417e-05 eta 0:01:19
epoch [48/50] batch [80/319] time 0.073 (0.087) data 0.000 (0.006) loss 1.3524 (1.4334) ce_loss 1.3096 (1.3851) teacher_loss 0.6875 (0.7614) loss_zs_kd 0.4076 (0.3991) loss_oracle 0.4611 (0.4725) acc 46.8750 (48.2031) kd_loss 0.8975 (0.9142) lr 3.1417e-05 eta 0:01:16
epoch [48/50] batch [100/319] time 0.087 (0.086) data 0.000 (0.005) loss 1.3893 (1.4235) ce_loss 1.3564 (1.3754) teacher_loss 0.6974 (0.7500) loss_zs_kd 0.3750 (0.4005) loss_oracle 0.5044 (0.4733) acc 50.0000 (48.7188) kd_loss 0.9570 (0.9172) lr 3.1417e-05 eta 0:01:13
epoch [48/50] batch [120/319] time 0.089 (0.086) data 0.000 (0.004) loss 1.3771 (1.4100) ce_loss 1.2607 (1.3573) teacher_loss 0.6815 (0.7400) loss_zs_kd 0.3688 (0.3982) loss_oracle 0.5112 (0.4709) acc 59.3750 (49.2708) kd_loss 0.9875 (0.9147) lr 3.1417e-05 eta 0:01:11
epoch [48/50] batch [140/319] time 0.092 (0.086) data 0.000 (0.004) loss 1.5488 (1.4081) ce_loss 1.3516 (1.3497) teacher_loss 0.8959 (0.7385) loss_zs_kd 0.4022 (0.4007) loss_oracle 0.4518 (0.4692) acc 50.0000 (49.5312) kd_loss 0.9252 (0.9116) lr 3.1417e-05 eta 0:01:10
epoch [48/50] batch [160/319] time 0.082 (0.086) data 0.000 (0.003) loss 1.2445 (1.4043) ce_loss 0.9756 (1.3424) teacher_loss 0.5425 (0.7364) loss_zs_kd 0.4494 (0.3992) loss_oracle 0.4772 (0.4683) acc 68.7500 (49.9414) kd_loss 1.0161 (0.9101) lr 3.1417e-05 eta 0:01:08
epoch [48/50] batch [180/319] time 0.081 (0.085) data 0.001 (0.003) loss 1.2941 (1.4071) ce_loss 1.2910 (1.3459) teacher_loss 0.5844 (0.7376) loss_zs_kd 0.4029 (0.3995) loss_oracle 0.5083 (0.4698) acc 53.1250 (49.6007) kd_loss 0.9221 (0.9103) lr 3.1417e-05 eta 0:01:06
epoch [48/50] batch [200/319] time 0.070 (0.084) data 0.000 (0.003) loss 1.6406 (1.4121) ce_loss 1.6377 (1.3492) teacher_loss 1.0430 (0.7419) loss_zs_kd 0.3888 (0.4018) loss_oracle 0.4031 (0.4693) acc 46.8750 (49.3438) kd_loss 0.8972 (0.9082) lr 3.1417e-05 eta 0:01:03
epoch [48/50] batch [220/319] time 0.083 (0.084) data 0.000 (0.002) loss 1.1469 (1.4106) ce_loss 1.0547 (1.3451) teacher_loss 0.5681 (0.7411) loss_zs_kd 0.3486 (0.4015) loss_oracle 0.4045 (0.4687) acc 59.3750 (49.6449) kd_loss 0.8086 (0.9085) lr 3.1417e-05 eta 0:01:01
epoch [48/50] batch [240/319] time 0.088 (0.084) data 0.000 (0.002) loss 1.6461 (1.4113) ce_loss 1.6484 (1.3443) teacher_loss 0.9317 (0.7421) loss_zs_kd 0.4084 (0.4012) loss_oracle 0.5103 (0.4686) acc 40.6250 (49.9219) kd_loss 0.8320 (0.9076) lr 3.1417e-05 eta 0:01:00
epoch [48/50] batch [260/319] time 0.079 (0.083) data 0.000 (0.002) loss 1.7000 (1.4120) ce_loss 1.7715 (1.3491) teacher_loss 0.8748 (0.7412) loss_zs_kd 0.4626 (0.4022) loss_oracle 0.5939 (0.4697) acc 34.3750 (49.6875) kd_loss 1.0687 (0.9089) lr 3.1417e-05 eta 0:00:58
epoch [48/50] batch [280/319] time 0.086 (0.083) data 0.000 (0.002) loss 1.7741 (1.4067) ce_loss 1.5869 (1.3439) teacher_loss 1.0708 (0.7375) loss_zs_kd 0.4248 (0.4009) loss_oracle 0.4909 (0.4688) acc 43.7500 (50.0112) kd_loss 0.8978 (0.9095) lr 3.1417e-05 eta 0:00:56
epoch [48/50] batch [300/319] time 0.086 (0.083) data 0.000 (0.002) loss 1.3764 (1.4041) ce_loss 1.1533 (1.3418) teacher_loss 0.7424 (0.7356) loss_zs_kd 0.3672 (0.3998) loss_oracle 0.4504 (0.4686) acc 50.0000 (50.0208) kd_loss 0.9010 (0.9082) lr 3.1417e-05 eta 0:00:54
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,268
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 39.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,917
* accuracy: 40.2%
* error: 59.8%
* macro_f1: 15.1%
******* Domain 2 best val acc:      52.4%, epoch: 38 *******
******* Domain 2 best val test acc: 41.4%, epoch: 38 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [49/50] batch [20/319] time 0.072 (0.102) data 0.000 (0.025) loss 1.2966 (1.3832) ce_loss 1.2334 (1.3516) teacher_loss 0.6940 (0.7205) loss_zs_kd 0.3815 (0.4132) loss_oracle 0.4119 (0.4561) acc 46.8750 (49.0625) kd_loss 0.8399 (0.8955) lr 1.7713e-05 eta 0:01:02
epoch [49/50] batch [40/319] time 0.085 (0.091) data 0.001 (0.012) loss 1.3240 (1.4014) ce_loss 1.2910 (1.3395) teacher_loss 0.7036 (0.7297) loss_zs_kd 0.4002 (0.4082) loss_oracle 0.4203 (0.4675) acc 53.1250 (48.9062) kd_loss 0.9882 (0.8911) lr 1.7713e-05 eta 0:00:54
epoch [49/50] batch [60/319] time 0.096 (0.089) data 0.000 (0.008) loss 1.0897 (1.4068) ce_loss 0.9038 (1.3402) teacher_loss 0.4921 (0.7307) loss_zs_kd 0.3418 (0.4053) loss_oracle 0.4267 (0.4734) acc 68.7500 (50.0521) kd_loss 0.8764 (0.8966) lr 1.7713e-05 eta 0:00:51
epoch [49/50] batch [80/319] time 0.077 (0.087) data 0.000 (0.006) loss 1.3759 (1.4015) ce_loss 1.3281 (1.3414) teacher_loss 0.7099 (0.7286) loss_zs_kd 0.4084 (0.4018) loss_oracle 0.4618 (0.4720) acc 43.7500 (50.2734) kd_loss 0.9435 (0.9048) lr 1.7713e-05 eta 0:00:48
epoch [49/50] batch [100/319] time 0.084 (0.086) data 0.000 (0.005) loss 1.3060 (1.3920) ce_loss 1.1914 (1.3225) teacher_loss 0.6652 (0.7221) loss_zs_kd 0.4160 (0.3999) loss_oracle 0.4329 (0.4699) acc 56.2500 (51.1562) kd_loss 0.9291 (0.9052) lr 1.7713e-05 eta 0:00:46
epoch [49/50] batch [120/319] time 0.084 (0.086) data 0.000 (0.004) loss 1.1744 (1.3997) ce_loss 0.9741 (1.3339) teacher_loss 0.5290 (0.7302) loss_zs_kd 0.4325 (0.3997) loss_oracle 0.4292 (0.4696) acc 59.3750 (50.6250) kd_loss 0.9138 (0.9064) lr 1.7713e-05 eta 0:00:44
epoch [49/50] batch [140/319] time 0.081 (0.086) data 0.000 (0.004) loss 1.5207 (1.3989) ce_loss 1.2920 (1.3326) teacher_loss 0.8241 (0.7305) loss_zs_kd 0.3657 (0.3991) loss_oracle 0.5138 (0.4688) acc 53.1250 (50.9598) kd_loss 0.8756 (0.9088) lr 1.7713e-05 eta 0:00:42
epoch [49/50] batch [160/319] time 0.090 (0.085) data 0.000 (0.003) loss 1.1910 (1.4029) ce_loss 1.0889 (1.3334) teacher_loss 0.4961 (0.7329) loss_zs_kd 0.3946 (0.4009) loss_oracle 0.4976 (0.4695) acc 62.5000 (50.8594) kd_loss 1.0167 (0.9091) lr 1.7713e-05 eta 0:00:40
epoch [49/50] batch [180/319] time 0.084 (0.085) data 0.000 (0.003) loss 1.3746 (1.4108) ce_loss 1.4707 (1.3437) teacher_loss 0.7393 (0.7400) loss_zs_kd 0.3809 (0.4023) loss_oracle 0.4449 (0.4697) acc 40.6250 (50.3993) kd_loss 0.8128 (0.9082) lr 1.7713e-05 eta 0:00:38
epoch [49/50] batch [200/319] time 0.082 (0.085) data 0.000 (0.003) loss 1.4180 (1.4137) ce_loss 1.2480 (1.3490) teacher_loss 0.7269 (0.7420) loss_zs_kd 0.4157 (0.4037) loss_oracle 0.4832 (0.4699) acc 46.8750 (50.1250) kd_loss 0.8092 (0.9081) lr 1.7713e-05 eta 0:00:37
epoch [49/50] batch [220/319] time 0.081 (0.084) data 0.000 (0.002) loss 1.5097 (1.4167) ce_loss 1.5117 (1.3528) teacher_loss 0.8298 (0.7423) loss_zs_kd 0.3943 (0.4039) loss_oracle 0.4827 (0.4725) acc 43.7500 (49.8864) kd_loss 0.8115 (0.9084) lr 1.7713e-05 eta 0:00:35
epoch [49/50] batch [240/319] time 0.085 (0.084) data 0.000 (0.002) loss 1.4073 (1.4188) ce_loss 1.5137 (1.3553) teacher_loss 0.6858 (0.7441) loss_zs_kd 0.4398 (0.4043) loss_oracle 0.5016 (0.4725) acc 43.7500 (49.5312) kd_loss 0.9329 (0.9081) lr 1.7713e-05 eta 0:00:33
epoch [49/50] batch [260/319] time 0.085 (0.084) data 0.000 (0.002) loss 1.4050 (1.4149) ce_loss 1.4697 (1.3505) teacher_loss 0.6947 (0.7413) loss_zs_kd 0.4058 (0.4038) loss_oracle 0.5074 (0.4717) acc 50.0000 (49.6875) kd_loss 1.0441 (0.9093) lr 1.7713e-05 eta 0:00:31
epoch [49/50] batch [280/319] time 0.083 (0.084) data 0.000 (0.002) loss 1.0890 (1.4153) ce_loss 0.9497 (1.3518) teacher_loss 0.4766 (0.7422) loss_zs_kd 0.4020 (0.4038) loss_oracle 0.4114 (0.4712) acc 62.5000 (49.6763) kd_loss 0.8110 (0.9076) lr 1.7713e-05 eta 0:00:30
epoch [49/50] batch [300/319] time 0.077 (0.084) data 0.000 (0.002) loss 1.2095 (1.4102) ce_loss 1.0391 (1.3441) teacher_loss 0.6109 (0.7369) loss_zs_kd 0.3883 (0.4037) loss_oracle 0.4044 (0.4715) acc 65.6250 (50.0521) kd_loss 0.8731 (0.9096) lr 1.7713e-05 eta 0:00:28
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,269
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 39.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,925
* accuracy: 40.3%
* error: 59.7%
* macro_f1: 15.1%
******* Domain 2 best val acc:      52.4%, epoch: 38 *******
******* Domain 2 best val test acc: 41.4%, epoch: 38 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
epoch [50/50] batch [20/319] time 0.083 (0.113) data 0.000 (0.026) loss 1.2743 (1.4314) ce_loss 1.2500 (1.3265) teacher_loss 0.5714 (0.7633) loss_zs_kd 0.4067 (0.4042) loss_oracle 0.4995 (0.4659) acc 53.1250 (50.9375) kd_loss 0.9506 (0.9095) lr 7.8853e-06 eta 0:00:33
epoch [50/50] batch [40/319] time 0.079 (0.100) data 0.000 (0.013) loss 1.5444 (1.4296) ce_loss 1.4922 (1.3516) teacher_loss 0.7317 (0.7599) loss_zs_kd 0.4716 (0.3991) loss_oracle 0.5769 (0.4701) acc 46.8750 (50.4688) kd_loss 0.9291 (0.9113) lr 7.8853e-06 eta 0:00:27
epoch [50/50] batch [60/319] time 0.077 (0.094) data 0.000 (0.009) loss 1.3419 (1.4244) ce_loss 1.0762 (1.3431) teacher_loss 0.6990 (0.7516) loss_zs_kd 0.4047 (0.4021) loss_oracle 0.4406 (0.4717) acc 50.0000 (49.6875) kd_loss 0.8543 (0.9078) lr 7.8853e-06 eta 0:00:24
epoch [50/50] batch [80/319] time 0.081 (0.092) data 0.000 (0.007) loss 1.3406 (1.4073) ce_loss 1.3193 (1.3367) teacher_loss 0.6484 (0.7347) loss_zs_kd 0.3676 (0.3992) loss_oracle 0.5084 (0.4730) acc 46.8750 (49.5703) kd_loss 0.9874 (0.9129) lr 7.8853e-06 eta 0:00:21
epoch [50/50] batch [100/319] time 0.081 (0.090) data 0.000 (0.005) loss 1.4418 (1.4153) ce_loss 1.3115 (1.3385) teacher_loss 0.8996 (0.7447) loss_zs_kd 0.3762 (0.4000) loss_oracle 0.3541 (0.4706) acc 50.0000 (49.2812) kd_loss 0.8673 (0.9071) lr 7.8853e-06 eta 0:00:19
epoch [50/50] batch [120/319] time 0.082 (0.090) data 0.000 (0.005) loss 1.4443 (1.4124) ce_loss 1.3730 (1.3329) teacher_loss 0.8280 (0.7427) loss_zs_kd 0.3317 (0.3993) loss_oracle 0.4505 (0.4701) acc 59.3750 (49.7135) kd_loss 0.9243 (0.9056) lr 7.8853e-06 eta 0:00:17
epoch [50/50] batch [140/319] time 0.085 (0.089) data 0.000 (0.004) loss 1.2739 (1.4116) ce_loss 1.0361 (1.3339) teacher_loss 0.6690 (0.7424) loss_zs_kd 0.3622 (0.3993) loss_oracle 0.4238 (0.4696) acc 65.6250 (49.7545) kd_loss 0.9426 (0.9025) lr 7.8853e-06 eta 0:00:15
epoch [50/50] batch [160/319] time 0.089 (0.089) data 0.000 (0.004) loss 1.3407 (1.4140) ce_loss 1.3223 (1.3349) teacher_loss 0.7193 (0.7459) loss_zs_kd 0.3581 (0.4006) loss_oracle 0.4423 (0.4678) acc 53.1250 (49.8047) kd_loss 0.8564 (0.9016) lr 7.8853e-06 eta 0:00:14
epoch [50/50] batch [180/319] time 0.080 (0.088) data 0.000 (0.003) loss 1.3531 (1.4155) ce_loss 1.2236 (1.3392) teacher_loss 0.6409 (0.7472) loss_zs_kd 0.4563 (0.4011) loss_oracle 0.4841 (0.4677) acc 50.0000 (49.7569) kd_loss 0.8652 (0.9013) lr 7.8853e-06 eta 0:00:12
epoch [50/50] batch [200/319] time 0.083 (0.088) data 0.000 (0.003) loss 1.4423 (1.4188) ce_loss 1.4287 (1.3411) teacher_loss 0.7322 (0.7498) loss_zs_kd 0.3760 (0.4013) loss_oracle 0.5221 (0.4683) acc 46.8750 (49.7969) kd_loss 0.9049 (0.9010) lr 7.8853e-06 eta 0:00:10
epoch [50/50] batch [220/319] time 0.085 (0.088) data 0.000 (0.003) loss 1.2814 (1.4133) ce_loss 1.1973 (1.3371) teacher_loss 0.6735 (0.7451) loss_zs_kd 0.3355 (0.4019) loss_oracle 0.4401 (0.4672) acc 65.6250 (49.9716) kd_loss 0.8947 (0.9014) lr 7.8853e-06 eta 0:00:08
epoch [50/50] batch [240/319] time 0.090 (0.087) data 0.000 (0.002) loss 1.4060 (1.4086) ce_loss 1.3789 (1.3339) teacher_loss 0.8648 (0.7412) loss_zs_kd 0.3048 (0.4008) loss_oracle 0.3888 (0.4670) acc 56.2500 (49.9479) kd_loss 0.9011 (0.9005) lr 7.8853e-06 eta 0:00:06
epoch [50/50] batch [260/319] time 0.083 (0.087) data 0.000 (0.002) loss 1.2834 (1.4089) ce_loss 1.3301 (1.3392) teacher_loss 0.6412 (0.7413) loss_zs_kd 0.3855 (0.4011) loss_oracle 0.4494 (0.4671) acc 50.0000 (49.9519) kd_loss 0.9159 (0.9002) lr 7.8853e-06 eta 0:00:05
epoch [50/50] batch [280/319] time 0.087 (0.087) data 0.000 (0.002) loss 1.8250 (1.4059) ce_loss 1.7158 (1.3344) teacher_loss 1.0885 (0.7387) loss_zs_kd 0.4289 (0.4004) loss_oracle 0.5221 (0.4669) acc 34.3750 (50.0781) kd_loss 0.9282 (0.9015) lr 7.8853e-06 eta 0:00:03
epoch [50/50] batch [300/319] time 0.082 (0.087) data 0.000 (0.002) loss 1.5440 (1.4033) ce_loss 1.5811 (1.3330) teacher_loss 0.7997 (0.7352) loss_zs_kd 0.4305 (0.4006) loss_oracle 0.5291 (0.4678) acc 46.8750 (50.2604) kd_loss 1.0271 (0.9006) lr 7.8853e-06 eta 0:00:01
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,269
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 39.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,928
* accuracy: 40.3%
* error: 59.7%
* macro_f1: 15.1%
******* Domain 2 best val acc:      52.4%, epoch: 38 *******
******* Domain 2 best val test acc: 41.4%, epoch: 38 *******
******* Domain 2 best test acc:     45.6%, epoch: 10 *******
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:43:31
