Loading trainer: TRIP
Loading dataset: SPG_VLCS
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------
Dataset    SPG_VLCS
Source     ['labelme', 'pascal', 'sun']
Target     ['caltech']
# classes  5
# train_x  6,519
# val      2,795
# test     1,415
---------  ----------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/oracle/04_nonnegative/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/203] time 0.122 (0.151) data 0.000 (0.022) loss 0.6218 (0.7938) ce_loss 0.6216 (0.7934) teacher_loss 0.6214 (0.7935) loss_zs_kd 0.0002 (0.0001) loss_oracle 0.0003 (0.0003) acc 68.7500 (70.9375) kd_loss 0.0009 (0.0010) lr 1.0000e-05 eta 0:25:32
epoch [1/50] batch [40/203] time 0.144 (0.125) data 0.000 (0.011) loss 0.7850 (0.7596) ce_loss 0.7837 (0.7591) teacher_loss 0.7843 (0.7592) loss_zs_kd 0.0011 (0.0004) loss_oracle 0.0002 (0.0002) acc 75.0000 (72.2656) kd_loss 0.0006 (0.0008) lr 1.0000e-05 eta 0:21:08
epoch [1/50] batch [60/203] time 0.058 (0.131) data 0.000 (0.007) loss 0.7827 (0.7578) ce_loss 0.7817 (0.7571) teacher_loss 0.7810 (0.7571) loss_zs_kd 0.0030 (0.0009) loss_oracle 0.0002 (0.0002) acc 75.0000 (73.2292) kd_loss 0.0007 (0.0007) lr 1.0000e-05 eta 0:21:59
epoch [1/50] batch [80/203] time 0.122 (0.125) data 0.000 (0.006) loss 0.6878 (0.7287) ce_loss 0.6855 (0.7276) teacher_loss 0.6849 (0.7277) loss_zs_kd 0.0045 (0.0016) loss_oracle 0.0007 (0.0002) acc 71.8750 (74.1016) kd_loss 0.0021 (0.0008) lr 1.0000e-05 eta 0:20:58
epoch [1/50] batch [100/203] time 0.060 (0.128) data 0.000 (0.005) loss 0.8856 (0.7349) ce_loss 0.8823 (0.7333) teacher_loss 0.8819 (0.7334) loss_zs_kd 0.0062 (0.0024) loss_oracle 0.0007 (0.0003) acc 71.8750 (73.8750) kd_loss 0.0024 (0.0010) lr 1.0000e-05 eta 0:21:23
epoch [1/50] batch [120/203] time 0.081 (0.123) data 0.000 (0.004) loss 0.8658 (0.7344) ce_loss 0.8608 (0.7325) teacher_loss 0.8613 (0.7325) loss_zs_kd 0.0078 (0.0031) loss_oracle 0.0006 (0.0004) acc 65.6250 (73.3854) kd_loss 0.0022 (0.0012) lr 1.0000e-05 eta 0:20:29
epoch [1/50] batch [140/203] time 0.101 (0.121) data 0.000 (0.003) loss 0.5954 (0.7288) ce_loss 0.5908 (0.7265) teacher_loss 0.5906 (0.7265) loss_zs_kd 0.0080 (0.0038) loss_oracle 0.0008 (0.0004) acc 78.1250 (73.7054) kd_loss 0.0030 (0.0013) lr 1.0000e-05 eta 0:20:07
epoch [1/50] batch [160/203] time 0.096 (0.119) data 0.000 (0.003) loss 0.6195 (0.7282) ce_loss 0.6162 (0.7255) teacher_loss 0.6154 (0.7255) loss_zs_kd 0.0063 (0.0044) loss_oracle 0.0010 (0.0005) acc 78.1250 (73.8477) kd_loss 0.0035 (0.0016) lr 1.0000e-05 eta 0:19:51
epoch [1/50] batch [180/203] time 0.088 (0.118) data 0.000 (0.003) loss 0.8695 (0.7363) ce_loss 0.8643 (0.7334) teacher_loss 0.8645 (0.7333) loss_zs_kd 0.0087 (0.0049) loss_oracle 0.0007 (0.0005) acc 65.6250 (73.6979) kd_loss 0.0020 (0.0018) lr 1.0000e-05 eta 0:19:34
epoch [1/50] batch [200/203] time 0.094 (0.116) data 0.000 (0.002) loss 0.6561 (0.7287) ce_loss 0.6494 (0.7256) teacher_loss 0.6489 (0.7256) loss_zs_kd 0.0122 (0.0052) loss_oracle 0.0011 (0.0006) acc 75.0000 (73.9062) kd_loss 0.0037 (0.0020) lr 1.0000e-05 eta 0:19:14
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,212
* accuracy: 79.1%
* error: 20.9%
* macro_f1: 82.8%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain c best val acc:      79.1%, epoch: 1 *******
******* Domain c best val test acc: 100.0%, epoch: 1 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/oracle/04_nonnegative/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/ana
epoch [2/50] batch [20/203] time 0.136 (0.121) data 0.000 (0.019) loss 0.9040 (0.7222) ce_loss 0.8315 (0.6728) teacher_loss 0.8251 (0.6729) loss_zs_kd 0.0574 (0.0556) loss_oracle 0.0503 (0.0215) acc 68.7500 (75.4688) kd_loss 0.0558 (0.0154) lr 2.0000e-03 eta 0:20:01
epoch [2/50] batch [40/203] time 0.135 (0.112) data 0.001 (0.010) loss 0.5743 (0.6946) ce_loss 0.4529 (0.6301) teacher_loss 0.4224 (0.6233) loss_zs_kd 0.0909 (0.0699) loss_oracle 0.1064 (0.0364) acc 81.2500 (77.5000) kd_loss 0.1399 (0.0541) lr 2.0000e-03 eta 0:18:30
epoch [2/50] batch [60/203] time 0.100 (0.113) data 0.000 (0.007) loss 0.7326 (0.7163) ce_loss 0.5269 (0.6260) teacher_loss 0.4645 (0.6120) loss_zs_kd 0.1514 (0.0754) loss_oracle 0.1924 (0.0666) acc 71.8750 (77.0833) kd_loss 0.3058 (0.0982) lr 2.0000e-03 eta 0:18:33
epoch [2/50] batch [80/203] time 0.136 (0.110) data 0.001 (0.005) loss 0.8401 (0.7278) ce_loss 0.6812 (0.6133) teacher_loss 0.5550 (0.5906) loss_zs_kd 0.1012 (0.0786) loss_oracle 0.2344 (0.0979) acc 68.7500 (77.1484) kd_loss 0.6451 (0.1845) lr 2.0000e-03 eta 0:18:09
epoch [2/50] batch [100/203] time 0.091 (0.110) data 0.000 (0.004) loss 0.7111 (0.7587) ce_loss 0.5322 (0.6201) teacher_loss 0.5032 (0.5950) loss_zs_kd 0.0418 (0.0766) loss_oracle 0.1871 (0.1253) acc 84.3750 (76.7500) kd_loss 0.9087 (0.3155) lr 2.0000e-03 eta 0:17:58
epoch [2/50] batch [120/203] time 0.134 (0.109) data 0.000 (0.003) loss 0.6677 (0.7763) ce_loss 0.5269 (0.6273) teacher_loss 0.4738 (0.5994) loss_zs_kd 0.0443 (0.0709) loss_oracle 0.1717 (0.1415) acc 81.2500 (76.8490) kd_loss 0.9963 (0.4248) lr 2.0000e-03 eta 0:17:53
epoch [2/50] batch [140/203] time 0.121 (0.110) data 0.000 (0.003) loss 1.0573 (0.7749) ce_loss 1.0078 (0.6317) teacher_loss 0.8552 (0.5982) loss_zs_kd 0.0876 (0.0687) loss_oracle 0.1584 (0.1423) acc 68.7500 (77.0312) kd_loss 1.0119 (0.5048) lr 2.0000e-03 eta 0:17:58
epoch [2/50] batch [160/203] time 0.110 (0.110) data 0.000 (0.003) loss 0.5808 (0.7698) ce_loss 0.4839 (0.6352) teacher_loss 0.4560 (0.5956) loss_zs_kd 0.0624 (0.0680) loss_oracle 0.0936 (0.1402) acc 78.1250 (76.8750) kd_loss 0.8377 (0.5613) lr 2.0000e-03 eta 0:17:58
epoch [2/50] batch [180/203] time 0.102 (0.111) data 0.000 (0.002) loss 0.5674 (0.7592) ce_loss 0.5029 (0.6290) teacher_loss 0.4330 (0.5865) loss_zs_kd 0.0354 (0.0667) loss_oracle 0.1168 (0.1393) acc 84.3750 (77.0312) kd_loss 0.8646 (0.5990) lr 2.0000e-03 eta 0:18:01
epoch [2/50] batch [200/203] time 0.079 (0.110) data 0.000 (0.002) loss 1.1124 (0.7616) ce_loss 1.0117 (0.6329) teacher_loss 0.8872 (0.5866) loss_zs_kd 0.0910 (0.0672) loss_oracle 0.1797 (0.1414) acc 65.6250 (76.7969) kd_loss 0.8247 (0.6222) lr 2.0000e-03 eta 0:17:48
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,298
* accuracy: 82.2%
* error: 17.8%
* macro_f1: 85.8%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      82.2%, epoch: 2 *******
******* Domain c best val test acc: 100.0%, epoch: 2 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [3/50] batch [20/203] time 0.080 (0.153) data 0.000 (0.014) loss 0.9533 (0.7076) ce_loss 0.7974 (0.5286) teacher_loss 0.6332 (0.4508) loss_zs_kd 0.1820 (0.1016) loss_oracle 0.2291 (0.2060) acc 71.8750 (80.4688) kd_loss 0.7749 (0.7849) lr 1.9980e-03 eta 0:24:44
epoch [3/50] batch [40/203] time 0.086 (0.129) data 0.000 (0.007) loss 0.8453 (0.7525) ce_loss 0.6460 (0.5679) teacher_loss 0.5219 (0.4680) loss_zs_kd 0.1579 (0.1086) loss_oracle 0.2444 (0.2302) acc 78.1250 (79.0625) kd_loss 0.7876 (0.7858) lr 1.9980e-03 eta 0:20:52
epoch [3/50] batch [60/203] time 0.092 (0.120) data 0.000 (0.005) loss 0.6416 (0.7497) ce_loss 0.4578 (0.5633) teacher_loss 0.3535 (0.4610) loss_zs_kd 0.1133 (0.1110) loss_oracle 0.2314 (0.2332) acc 81.2500 (79.2708) kd_loss 0.8073 (0.7953) lr 1.9980e-03 eta 0:19:25
epoch [3/50] batch [80/203] time 0.101 (0.117) data 0.000 (0.004) loss 0.8811 (0.7580) ce_loss 0.7612 (0.5711) teacher_loss 0.5399 (0.4614) loss_zs_kd 0.1042 (0.1131) loss_oracle 0.2891 (0.2401) acc 68.7500 (78.3594) kd_loss 0.8615 (0.7996) lr 1.9980e-03 eta 0:18:50
epoch [3/50] batch [100/203] time 0.088 (0.115) data 0.000 (0.003) loss 0.9874 (0.7699) ce_loss 0.6284 (0.5773) teacher_loss 0.5922 (0.4646) loss_zs_kd 0.1342 (0.1142) loss_oracle 0.3281 (0.2482) acc 75.0000 (78.1875) kd_loss 0.8381 (0.8012) lr 1.9980e-03 eta 0:18:32
epoch [3/50] batch [120/203] time 0.092 (0.114) data 0.000 (0.003) loss 0.9188 (0.7816) ce_loss 0.7852 (0.5847) teacher_loss 0.5396 (0.4649) loss_zs_kd 0.1268 (0.1201) loss_oracle 0.3158 (0.2566) acc 71.8750 (77.7083) kd_loss 0.8498 (0.8039) lr 1.9980e-03 eta 0:18:13
epoch [3/50] batch [140/203] time 0.122 (0.113) data 0.000 (0.002) loss 0.7167 (0.7927) ce_loss 0.4082 (0.5884) teacher_loss 0.3641 (0.4660) loss_zs_kd 0.0804 (0.1205) loss_oracle 0.3124 (0.2664) acc 75.0000 (77.6339) kd_loss 0.7521 (0.8058) lr 1.9980e-03 eta 0:18:07
epoch [3/50] batch [160/203] time 0.121 (0.113) data 0.000 (0.002) loss 1.0012 (0.8018) ce_loss 0.9370 (0.5940) teacher_loss 0.6580 (0.4662) loss_zs_kd 0.1078 (0.1237) loss_oracle 0.2893 (0.2737) acc 62.5000 (77.3242) kd_loss 0.9611 (0.8130) lr 1.9980e-03 eta 0:18:01
epoch [3/50] batch [180/203] time 0.088 (0.112) data 0.000 (0.002) loss 0.7559 (0.8055) ce_loss 0.2922 (0.5912) teacher_loss 0.2476 (0.4612) loss_zs_kd 0.1653 (0.1254) loss_oracle 0.4256 (0.2816) acc 90.6250 (77.5521) kd_loss 0.9064 (0.8196) lr 1.9980e-03 eta 0:17:51
epoch [3/50] batch [200/203] time 0.081 (0.111) data 0.000 (0.002) loss 0.8998 (0.8051) ce_loss 0.5200 (0.5885) teacher_loss 0.3904 (0.4499) loss_zs_kd 0.1834 (0.1288) loss_oracle 0.4176 (0.2908) acc 84.3750 (77.7031) kd_loss 0.8921 (0.8247) lr 1.9980e-03 eta 0:17:36
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,318
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 86.6%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      82.9%, epoch: 3 *******
******* Domain c best val test acc: 100.0%, epoch: 3 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [4/50] batch [20/203] time 0.118 (0.127) data 0.000 (0.013) loss 0.8264 (0.9063) ce_loss 0.5474 (0.6294) teacher_loss 0.3952 (0.4461) loss_zs_kd 0.1517 (0.1538) loss_oracle 0.3554 (0.3833) acc 78.1250 (77.1875) kd_loss 0.8968 (0.8809) lr 1.9921e-03 eta 0:20:05
epoch [4/50] batch [40/203] time 0.138 (0.120) data 0.001 (0.007) loss 0.7285 (0.8722) ce_loss 0.3447 (0.5966) teacher_loss 0.1640 (0.3885) loss_zs_kd 0.1330 (0.1643) loss_oracle 0.4980 (0.4015) acc 90.6250 (78.9062) kd_loss 0.8992 (0.8913) lr 1.9921e-03 eta 0:18:58
epoch [4/50] batch [60/203] time 0.098 (0.116) data 0.001 (0.005) loss 0.8996 (0.8645) ce_loss 0.6675 (0.5888) teacher_loss 0.4563 (0.3688) loss_zs_kd 0.1838 (0.1768) loss_oracle 0.3514 (0.4073) acc 75.0000 (78.8542) kd_loss 0.9199 (0.8990) lr 1.9921e-03 eta 0:18:15
epoch [4/50] batch [80/203] time 0.101 (0.115) data 0.000 (0.004) loss 0.8104 (0.8568) ce_loss 0.4968 (0.5887) teacher_loss 0.3454 (0.3646) loss_zs_kd 0.1404 (0.1747) loss_oracle 0.3949 (0.4049) acc 84.3750 (78.9062) kd_loss 0.9700 (0.8997) lr 1.9921e-03 eta 0:18:07
epoch [4/50] batch [100/203] time 0.136 (0.114) data 0.000 (0.003) loss 0.8399 (0.8561) ce_loss 0.6343 (0.5917) teacher_loss 0.2762 (0.3537) loss_zs_kd 0.2825 (0.1796) loss_oracle 0.4225 (0.4126) acc 71.8750 (78.5938) kd_loss 0.9284 (0.9012) lr 1.9921e-03 eta 0:18:00
epoch [4/50] batch [120/203] time 0.142 (0.114) data 0.000 (0.003) loss 0.8602 (0.8631) ce_loss 0.6924 (0.5983) teacher_loss 0.3603 (0.3553) loss_zs_kd 0.1661 (0.1819) loss_oracle 0.4168 (0.4168) acc 81.2500 (78.2292) kd_loss 0.9097 (0.9051) lr 1.9921e-03 eta 0:17:57
epoch [4/50] batch [140/203] time 0.082 (0.114) data 0.000 (0.002) loss 0.7672 (0.8617) ce_loss 0.6040 (0.5908) teacher_loss 0.3727 (0.3502) loss_zs_kd 0.1097 (0.1817) loss_oracle 0.3397 (0.4207) acc 81.2500 (78.4375) kd_loss 0.9092 (0.9084) lr 1.9921e-03 eta 0:17:53
epoch [4/50] batch [160/203] time 0.164 (0.115) data 0.000 (0.002) loss 1.0010 (0.8594) ce_loss 0.7041 (0.5860) teacher_loss 0.5145 (0.3462) loss_zs_kd 0.1744 (0.1813) loss_oracle 0.3993 (0.4226) acc 81.2500 (78.4961) kd_loss 0.8805 (0.9096) lr 1.9921e-03 eta 0:17:56
epoch [4/50] batch [180/203] time 0.086 (0.117) data 0.000 (0.002) loss 0.8765 (0.8595) ce_loss 0.4006 (0.5822) teacher_loss 0.3005 (0.3452) loss_zs_kd 0.1525 (0.1796) loss_oracle 0.4997 (0.4245) acc 84.3750 (78.5938) kd_loss 0.8832 (0.9109) lr 1.9921e-03 eta 0:18:13
epoch [4/50] batch [200/203] time 0.151 (0.120) data 0.000 (0.002) loss 1.1314 (0.8630) ce_loss 0.7891 (0.5844) teacher_loss 0.5988 (0.3456) loss_zs_kd 0.2104 (0.1794) loss_oracle 0.4274 (0.4277) acc 75.0000 (78.4844) kd_loss 0.9063 (0.9126) lr 1.9921e-03 eta 0:18:39
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,307
* accuracy: 82.5%
* error: 17.5%
* macro_f1: 86.1%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      82.9%, epoch: 3 *******
******* Domain c best val test acc: 100.0%, epoch: 3 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [5/50] batch [20/203] time 0.074 (0.115) data 0.000 (0.015) loss 0.7499 (0.8719) ce_loss 0.4829 (0.6022) teacher_loss 0.1955 (0.3547) loss_zs_kd 0.2073 (0.1695) loss_oracle 0.4508 (0.4325) acc 81.2500 (76.5625) kd_loss 0.9562 (0.9225) lr 1.9823e-03 eta 0:17:50
epoch [5/50] batch [40/203] time 0.104 (0.109) data 0.000 (0.008) loss 0.9737 (0.8736) ce_loss 0.5991 (0.5915) teacher_loss 0.3956 (0.3420) loss_zs_kd 0.1732 (0.1767) loss_oracle 0.4914 (0.4433) acc 75.0000 (78.2031) kd_loss 0.9597 (0.9220) lr 1.9823e-03 eta 0:16:56
epoch [5/50] batch [60/203] time 0.136 (0.111) data 0.001 (0.005) loss 0.7813 (0.8754) ce_loss 0.5356 (0.5890) teacher_loss 0.3234 (0.3450) loss_zs_kd 0.1192 (0.1734) loss_oracle 0.3983 (0.4437) acc 78.1250 (78.4375) kd_loss 0.9351 (0.9297) lr 1.9823e-03 eta 0:17:08
epoch [5/50] batch [80/203] time 0.133 (0.112) data 0.000 (0.004) loss 0.8484 (0.8788) ce_loss 0.5820 (0.5821) teacher_loss 0.3243 (0.3469) loss_zs_kd 0.1933 (0.1695) loss_oracle 0.4274 (0.4472) acc 75.0000 (78.6328) kd_loss 0.9175 (0.9307) lr 1.9823e-03 eta 0:17:14
epoch [5/50] batch [100/203] time 0.116 (0.111) data 0.000 (0.003) loss 0.6549 (0.8814) ce_loss 0.2576 (0.5868) teacher_loss 0.1876 (0.3501) loss_zs_kd 0.1141 (0.1678) loss_oracle 0.4101 (0.4474) acc 93.7500 (78.7188) kd_loss 0.8808 (0.9294) lr 1.9823e-03 eta 0:17:05
epoch [5/50] batch [120/203] time 0.089 (0.110) data 0.000 (0.003) loss 0.7611 (0.8906) ce_loss 0.3623 (0.5978) teacher_loss 0.2397 (0.3548) loss_zs_kd 0.1410 (0.1704) loss_oracle 0.4509 (0.4506) acc 87.5000 (78.4635) kd_loss 0.9213 (0.9295) lr 1.9823e-03 eta 0:16:54
epoch [5/50] batch [140/203] time 0.119 (0.110) data 0.000 (0.002) loss 0.8074 (0.8946) ce_loss 0.4583 (0.5937) teacher_loss 0.1773 (0.3526) loss_zs_kd 0.2442 (0.1729) loss_oracle 0.5080 (0.4554) acc 87.5000 (78.3705) kd_loss 0.9753 (0.9317) lr 1.9823e-03 eta 0:16:49
epoch [5/50] batch [160/203] time 0.094 (0.109) data 0.001 (0.002) loss 0.7496 (0.8962) ce_loss 0.3237 (0.5911) teacher_loss 0.2656 (0.3576) loss_zs_kd 0.1163 (0.1690) loss_oracle 0.4258 (0.4541) acc 90.6250 (78.4180) kd_loss 0.8707 (0.9313) lr 1.9823e-03 eta 0:16:42
epoch [5/50] batch [180/203] time 0.077 (0.109) data 0.000 (0.002) loss 0.7963 (0.8953) ce_loss 0.3950 (0.5865) teacher_loss 0.2240 (0.3549) loss_zs_kd 0.1468 (0.1678) loss_oracle 0.4989 (0.4565) acc 90.6250 (78.6111) kd_loss 0.9355 (0.9321) lr 1.9823e-03 eta 0:16:36
epoch [5/50] batch [200/203] time 0.096 (0.108) data 0.000 (0.002) loss 0.7446 (0.8973) ce_loss 0.3132 (0.5879) teacher_loss 0.1705 (0.3562) loss_zs_kd 0.1757 (0.1669) loss_oracle 0.4862 (0.4576) acc 84.3750 (78.7344) kd_loss 0.9042 (0.9331) lr 1.9823e-03 eta 0:16:31
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,313
* accuracy: 82.8%
* error: 17.2%
* macro_f1: 86.3%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      82.9%, epoch: 3 *******
******* Domain c best val test acc: 100.0%, epoch: 3 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [6/50] batch [20/203] time 0.119 (0.129) data 0.000 (0.015) loss 0.8815 (0.9011) ce_loss 0.5967 (0.5572) teacher_loss 0.4307 (0.3438) loss_zs_kd 0.1262 (0.1704) loss_oracle 0.3877 (0.4721) acc 81.2500 (79.2188) kd_loss 0.9423 (0.9376) lr 1.9686e-03 eta 0:19:31
epoch [6/50] batch [40/203] time 0.078 (0.122) data 0.000 (0.007) loss 0.7562 (0.9091) ce_loss 0.4590 (0.5879) teacher_loss 0.2450 (0.3548) loss_zs_kd 0.1755 (0.1750) loss_oracle 0.4235 (0.4667) acc 84.3750 (78.0469) kd_loss 0.9224 (0.9425) lr 1.9686e-03 eta 0:18:33
epoch [6/50] batch [60/203] time 0.124 (0.119) data 0.001 (0.005) loss 0.8307 (0.8972) ce_loss 0.4880 (0.5753) teacher_loss 0.3126 (0.3487) loss_zs_kd 0.1856 (0.1739) loss_oracle 0.4253 (0.4615) acc 81.2500 (79.2188) kd_loss 0.8678 (0.9399) lr 1.9686e-03 eta 0:17:58
epoch [6/50] batch [80/203] time 0.094 (0.116) data 0.001 (0.004) loss 0.8109 (0.9029) ce_loss 0.5415 (0.5795) teacher_loss 0.2532 (0.3497) loss_zs_kd 0.1697 (0.1719) loss_oracle 0.4728 (0.4672) acc 81.2500 (78.9062) kd_loss 0.9574 (0.9391) lr 1.9686e-03 eta 0:17:28
epoch [6/50] batch [100/203] time 0.174 (0.116) data 0.000 (0.003) loss 0.8809 (0.9058) ce_loss 0.6851 (0.5828) teacher_loss 0.3869 (0.3496) loss_zs_kd 0.1683 (0.1739) loss_oracle 0.4098 (0.4693) acc 71.8750 (79.1250) kd_loss 0.8827 (0.9373) lr 1.9686e-03 eta 0:17:30
epoch [6/50] batch [120/203] time 0.083 (0.121) data 0.000 (0.003) loss 0.9710 (0.9077) ce_loss 0.6577 (0.5864) teacher_loss 0.4443 (0.3555) loss_zs_kd 0.1571 (0.1716) loss_oracle 0.4482 (0.4663) acc 68.7500 (79.1146) kd_loss 0.9964 (0.9375) lr 1.9686e-03 eta 0:18:11
epoch [6/50] batch [140/203] time 0.151 (0.123) data 0.000 (0.002) loss 1.0913 (0.9110) ce_loss 0.6138 (0.5890) teacher_loss 0.4303 (0.3618) loss_zs_kd 0.1644 (0.1709) loss_oracle 0.5789 (0.4637) acc 71.8750 (78.9732) kd_loss 0.9545 (0.9354) lr 1.9686e-03 eta 0:18:25
epoch [6/50] batch [160/203] time 0.131 (0.123) data 0.000 (0.002) loss 1.0876 (0.9120) ce_loss 0.8496 (0.5904) teacher_loss 0.5365 (0.3639) loss_zs_kd 0.1148 (0.1701) loss_oracle 0.4937 (0.4630) acc 78.1250 (79.0234) kd_loss 0.9673 (0.9334) lr 1.9686e-03 eta 0:18:23
epoch [6/50] batch [180/203] time 0.119 (0.121) data 0.000 (0.002) loss 0.8198 (0.9130) ce_loss 0.4504 (0.5887) teacher_loss 0.2821 (0.3648) loss_zs_kd 0.1282 (0.1690) loss_oracle 0.4736 (0.4637) acc 84.3750 (78.9931) kd_loss 0.9110 (0.9314) lr 1.9686e-03 eta 0:18:07
epoch [6/50] batch [200/203] time 0.093 (0.118) data 0.000 (0.002) loss 0.9853 (0.9175) ce_loss 0.6045 (0.5946) teacher_loss 0.3984 (0.3693) loss_zs_kd 0.1808 (0.1686) loss_oracle 0.4965 (0.4639) acc 75.0000 (78.8125) kd_loss 0.9097 (0.9323) lr 1.9686e-03 eta 0:17:38
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,306
* accuracy: 82.5%
* error: 17.5%
* macro_f1: 86.1%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      82.9%, epoch: 3 *******
******* Domain c best val test acc: 100.0%, epoch: 3 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [7/50] batch [20/203] time 0.086 (0.121) data 0.000 (0.013) loss 0.7455 (0.9193) ce_loss 0.4141 (0.5955) teacher_loss 0.2719 (0.3821) loss_zs_kd 0.1501 (0.1658) loss_oracle 0.3985 (0.4543) acc 90.6250 (77.1875) kd_loss 0.8825 (0.9220) lr 1.9511e-03 eta 0:17:55
epoch [7/50] batch [40/203] time 0.096 (0.117) data 0.000 (0.007) loss 0.7301 (0.8955) ce_loss 0.3630 (0.5730) teacher_loss 0.2201 (0.3593) loss_zs_kd 0.1528 (0.1642) loss_oracle 0.4336 (0.4541) acc 90.6250 (77.9688) kd_loss 0.8778 (0.9269) lr 1.9511e-03 eta 0:17:23
epoch [7/50] batch [60/203] time 0.127 (0.116) data 0.000 (0.004) loss 0.8641 (0.8998) ce_loss 0.6138 (0.5745) teacher_loss 0.3490 (0.3679) loss_zs_kd 0.1796 (0.1641) loss_oracle 0.4253 (0.4498) acc 84.3750 (78.6979) kd_loss 0.9389 (0.9283) lr 1.9511e-03 eta 0:17:13
epoch [7/50] batch [80/203] time 0.093 (0.114) data 0.000 (0.003) loss 0.9056 (0.9032) ce_loss 0.5005 (0.5768) teacher_loss 0.3553 (0.3691) loss_zs_kd 0.1737 (0.1653) loss_oracle 0.4635 (0.4514) acc 78.1250 (78.3984) kd_loss 0.9652 (0.9274) lr 1.9511e-03 eta 0:16:49
epoch [7/50] batch [100/203] time 0.133 (0.114) data 0.000 (0.003) loss 0.7994 (0.9010) ce_loss 0.4292 (0.5740) teacher_loss 0.3403 (0.3733) loss_zs_kd 0.1343 (0.1641) loss_oracle 0.3919 (0.4456) acc 75.0000 (78.7188) kd_loss 0.9343 (0.9276) lr 1.9511e-03 eta 0:16:43
epoch [7/50] batch [120/203] time 0.117 (0.113) data 0.000 (0.002) loss 0.9190 (0.8939) ce_loss 0.5981 (0.5710) teacher_loss 0.3692 (0.3695) loss_zs_kd 0.1341 (0.1647) loss_oracle 0.4828 (0.4421) acc 81.2500 (78.8542) kd_loss 0.9598 (0.9288) lr 1.9511e-03 eta 0:16:38
epoch [7/50] batch [140/203] time 0.138 (0.113) data 0.000 (0.002) loss 0.8892 (0.8870) ce_loss 0.5068 (0.5652) teacher_loss 0.2647 (0.3604) loss_zs_kd 0.1762 (0.1669) loss_oracle 0.5364 (0.4432) acc 84.3750 (79.0848) kd_loss 0.9766 (0.9303) lr 1.9511e-03 eta 0:16:29
epoch [7/50] batch [160/203] time 0.085 (0.111) data 0.000 (0.002) loss 1.2300 (0.8908) ce_loss 1.0332 (0.5710) teacher_loss 0.6890 (0.3666) loss_zs_kd 0.1743 (0.1663) loss_oracle 0.4538 (0.4411) acc 68.7500 (78.8867) kd_loss 0.9575 (0.9330) lr 1.9511e-03 eta 0:16:11
epoch [7/50] batch [180/203] time 0.116 (0.110) data 0.000 (0.002) loss 1.0657 (0.8898) ce_loss 0.7461 (0.5677) teacher_loss 0.4688 (0.3650) loss_zs_kd 0.1440 (0.1670) loss_oracle 0.5249 (0.4413) acc 75.0000 (78.9757) kd_loss 0.9623 (0.9325) lr 1.9511e-03 eta 0:16:02
epoch [7/50] batch [200/203] time 0.103 (0.108) data 0.000 (0.002) loss 0.8850 (0.8901) ce_loss 0.5537 (0.5676) teacher_loss 0.3458 (0.3669) loss_zs_kd 0.1820 (0.1668) loss_oracle 0.4481 (0.4399) acc 75.0000 (78.9062) kd_loss 0.9101 (0.9314) lr 1.9511e-03 eta 0:15:40
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,317
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 86.3%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      82.9%, epoch: 3 *******
******* Domain c best val test acc: 100.0%, epoch: 3 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [8/50] batch [20/203] time 0.091 (0.126) data 0.000 (0.016) loss 0.8696 (0.8455) ce_loss 0.7095 (0.5597) teacher_loss 0.4270 (0.3558) loss_zs_kd 0.1674 (0.1466) loss_oracle 0.3589 (0.4164) acc 78.1250 (79.6875) kd_loss 0.8718 (0.9337) lr 1.9298e-03 eta 0:18:13
epoch [8/50] batch [40/203] time 0.080 (0.116) data 0.000 (0.008) loss 0.8657 (0.8691) ce_loss 0.3625 (0.5803) teacher_loss 0.3004 (0.3616) loss_zs_kd 0.1715 (0.1606) loss_oracle 0.4796 (0.4273) acc 84.3750 (78.8281) kd_loss 0.9594 (0.9454) lr 1.9298e-03 eta 0:16:44
epoch [8/50] batch [60/203] time 0.084 (0.109) data 0.000 (0.006) loss 0.7914 (0.8904) ce_loss 0.4268 (0.6014) teacher_loss 0.3673 (0.3707) loss_zs_kd 0.1491 (0.1717) loss_oracle 0.3495 (0.4338) acc 84.3750 (77.8125) kd_loss 0.8652 (0.9453) lr 1.9298e-03 eta 0:15:43
epoch [8/50] batch [80/203] time 0.175 (0.122) data 0.000 (0.004) loss 0.9647 (0.8831) ce_loss 0.7783 (0.5989) teacher_loss 0.4303 (0.3665) loss_zs_kd 0.2166 (0.1715) loss_oracle 0.4260 (0.4309) acc 68.7500 (78.0078) kd_loss 1.0050 (0.9477) lr 1.9298e-03 eta 0:17:34
epoch [8/50] batch [100/203] time 0.174 (0.120) data 0.000 (0.004) loss 0.8036 (0.8713) ce_loss 0.4473 (0.5889) teacher_loss 0.2096 (0.3547) loss_zs_kd 0.2053 (0.1714) loss_oracle 0.4914 (0.4309) acc 81.2500 (78.5625) kd_loss 0.9747 (0.9476) lr 1.9298e-03 eta 0:17:17
epoch [8/50] batch [120/203] time 0.128 (0.124) data 0.000 (0.003) loss 0.8623 (0.8634) ce_loss 0.4502 (0.5813) teacher_loss 0.4175 (0.3518) loss_zs_kd 0.1703 (0.1736) loss_oracle 0.3596 (0.4248) acc 90.6250 (78.8802) kd_loss 0.9277 (0.9427) lr 1.9298e-03 eta 0:17:46
epoch [8/50] batch [140/203] time 0.085 (0.119) data 0.000 (0.003) loss 0.9666 (0.8623) ce_loss 0.7021 (0.5815) teacher_loss 0.4919 (0.3514) loss_zs_kd 0.1988 (0.1737) loss_oracle 0.3753 (0.4240) acc 75.0000 (78.6607) kd_loss 0.8482 (0.9444) lr 1.9298e-03 eta 0:17:06
epoch [8/50] batch [160/203] time 0.086 (0.118) data 0.000 (0.002) loss 0.8790 (0.8568) ce_loss 0.7646 (0.5768) teacher_loss 0.4185 (0.3506) loss_zs_kd 0.1402 (0.1728) loss_oracle 0.3904 (0.4198) acc 71.8750 (78.8086) kd_loss 0.9398 (0.9445) lr 1.9298e-03 eta 0:16:48
epoch [8/50] batch [180/203] time 0.136 (0.116) data 0.000 (0.002) loss 0.7622 (0.8554) ce_loss 0.5474 (0.5758) teacher_loss 0.2893 (0.3508) loss_zs_kd 0.1623 (0.1726) loss_oracle 0.3917 (0.4183) acc 87.5000 (79.0104) kd_loss 1.0257 (0.9443) lr 1.9298e-03 eta 0:16:29
epoch [8/50] batch [200/203] time 0.075 (0.114) data 0.000 (0.002) loss 0.7857 (0.8520) ce_loss 0.5156 (0.5753) teacher_loss 0.3391 (0.3506) loss_zs_kd 0.1678 (0.1714) loss_oracle 0.3627 (0.4157) acc 84.3750 (78.9844) kd_loss 0.9615 (0.9453) lr 1.9298e-03 eta 0:16:09
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,328
* accuracy: 83.3%
* error: 16.7%
* macro_f1: 86.6%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.3%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [9/50] batch [20/203] time 0.110 (0.117) data 0.000 (0.012) loss 1.1019 (0.8601) ce_loss 0.7466 (0.5976) teacher_loss 0.4533 (0.3468) loss_zs_kd 0.2083 (0.1838) loss_oracle 0.5444 (0.4214) acc 75.0000 (77.9688) kd_loss 1.0496 (0.9596) lr 1.9048e-03 eta 0:16:32
epoch [9/50] batch [40/203] time 0.108 (0.106) data 0.000 (0.006) loss 1.1363 (0.8541) ce_loss 0.7085 (0.5974) teacher_loss 0.4954 (0.3399) loss_zs_kd 0.2132 (0.1831) loss_oracle 0.5343 (0.4226) acc 71.8750 (77.8906) kd_loss 0.9905 (0.9598) lr 1.9048e-03 eta 0:15:02
epoch [9/50] batch [60/203] time 0.073 (0.103) data 0.000 (0.004) loss 0.9237 (0.8578) ce_loss 0.7593 (0.5923) teacher_loss 0.4163 (0.3360) loss_zs_kd 0.2184 (0.1818) loss_oracle 0.3982 (0.4308) acc 71.8750 (78.6458) kd_loss 1.0021 (0.9561) lr 1.9048e-03 eta 0:14:36
epoch [9/50] batch [80/203] time 0.122 (0.102) data 0.000 (0.003) loss 0.9543 (0.8624) ce_loss 0.4656 (0.5927) teacher_loss 0.4392 (0.3372) loss_zs_kd 0.1894 (0.1803) loss_oracle 0.4204 (0.4350) acc 87.5000 (78.8281) kd_loss 0.9451 (0.9545) lr 1.9048e-03 eta 0:14:22
epoch [9/50] batch [100/203] time 0.107 (0.102) data 0.000 (0.003) loss 0.7535 (0.8662) ce_loss 0.6060 (0.5955) teacher_loss 0.2704 (0.3422) loss_zs_kd 0.2017 (0.1796) loss_oracle 0.3822 (0.4343) acc 68.7500 (78.6875) kd_loss 0.9843 (0.9528) lr 1.9048e-03 eta 0:14:23
epoch [9/50] batch [120/203] time 0.110 (0.102) data 0.000 (0.002) loss 0.6533 (0.8560) ce_loss 0.4714 (0.5857) teacher_loss 0.2143 (0.3354) loss_zs_kd 0.1547 (0.1803) loss_oracle 0.3616 (0.4304) acc 84.3750 (78.9583) kd_loss 0.9103 (0.9542) lr 1.9048e-03 eta 0:14:18
epoch [9/50] batch [140/203] time 0.125 (0.102) data 0.000 (0.002) loss 0.9608 (0.8555) ce_loss 0.8232 (0.5865) teacher_loss 0.4301 (0.3378) loss_zs_kd 0.1558 (0.1801) loss_oracle 0.4528 (0.4277) acc 62.5000 (78.9062) kd_loss 0.9474 (0.9533) lr 1.9048e-03 eta 0:14:13
epoch [9/50] batch [160/203] time 0.108 (0.102) data 0.000 (0.002) loss 0.6501 (0.8566) ce_loss 0.1913 (0.5882) teacher_loss 0.0977 (0.3381) loss_zs_kd 0.1910 (0.1794) loss_oracle 0.4569 (0.4288) acc 100.0000 (78.6523) kd_loss 0.8948 (0.9515) lr 1.9048e-03 eta 0:14:13
epoch [9/50] batch [180/203] time 0.080 (0.102) data 0.000 (0.002) loss 1.1169 (0.8624) ce_loss 1.0029 (0.5889) teacher_loss 0.6505 (0.3417) loss_zs_kd 0.1776 (0.1808) loss_oracle 0.3776 (0.4303) acc 65.6250 (78.6111) kd_loss 0.9361 (0.9500) lr 1.9048e-03 eta 0:14:11
epoch [9/50] batch [200/203] time 0.076 (0.101) data 0.000 (0.001) loss 0.8124 (0.8586) ce_loss 0.5527 (0.5820) teacher_loss 0.3504 (0.3400) loss_zs_kd 0.1375 (0.1791) loss_oracle 0.3932 (0.4291) acc 84.3750 (79.1094) kd_loss 0.8312 (0.9478) lr 1.9048e-03 eta 0:14:01
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,324
* accuracy: 83.1%
* error: 16.9%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.3%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [10/50] batch [20/203] time 0.107 (0.120) data 0.000 (0.012) loss 0.6790 (0.8665) ce_loss 0.2729 (0.5880) teacher_loss 0.1434 (0.3244) loss_zs_kd 0.1611 (0.1919) loss_oracle 0.4550 (0.4462) acc 93.7500 (78.2812) kd_loss 0.9096 (0.9367) lr 1.8763e-03 eta 0:16:35
epoch [10/50] batch [40/203] time 0.086 (0.110) data 0.000 (0.006) loss 0.9700 (0.8690) ce_loss 0.5850 (0.5792) teacher_loss 0.3931 (0.3347) loss_zs_kd 0.2342 (0.1856) loss_oracle 0.4598 (0.4415) acc 78.1250 (79.2969) kd_loss 0.9537 (0.9382) lr 1.8763e-03 eta 0:15:07
epoch [10/50] batch [60/203] time 0.129 (0.119) data 0.001 (0.004) loss 0.8519 (0.8707) ce_loss 0.5806 (0.5670) teacher_loss 0.2963 (0.3228) loss_zs_kd 0.1970 (0.1894) loss_oracle 0.4572 (0.4532) acc 84.3750 (79.5833) kd_loss 1.0167 (0.9353) lr 1.8763e-03 eta 0:16:27
epoch [10/50] batch [80/203] time 0.171 (0.119) data 0.000 (0.003) loss 0.7576 (0.8605) ce_loss 0.4709 (0.5572) teacher_loss 0.3145 (0.3175) loss_zs_kd 0.1697 (0.1861) loss_oracle 0.3583 (0.4499) acc 87.5000 (80.0000) kd_loss 0.8636 (0.9343) lr 1.8763e-03 eta 0:16:19
epoch [10/50] batch [100/203] time 0.173 (0.126) data 0.000 (0.003) loss 1.3560 (0.8630) ce_loss 1.2539 (0.5637) teacher_loss 0.7475 (0.3179) loss_zs_kd 0.2177 (0.1864) loss_oracle 0.4997 (0.4519) acc 56.2500 (79.7500) kd_loss 0.9290 (0.9346) lr 1.8763e-03 eta 0:17:15
epoch [10/50] batch [120/203] time 0.100 (0.123) data 0.000 (0.002) loss 0.8310 (0.8634) ce_loss 0.5454 (0.5719) teacher_loss 0.3171 (0.3182) loss_zs_kd 0.2051 (0.1884) loss_oracle 0.4113 (0.4510) acc 78.1250 (79.4010) kd_loss 0.8998 (0.9368) lr 1.8763e-03 eta 0:16:48
epoch [10/50] batch [140/203] time 0.088 (0.121) data 0.000 (0.002) loss 0.9688 (0.8703) ce_loss 0.6860 (0.5834) teacher_loss 0.3957 (0.3233) loss_zs_kd 0.1874 (0.1913) loss_oracle 0.4795 (0.4513) acc 71.8750 (79.1741) kd_loss 0.8523 (0.9378) lr 1.8763e-03 eta 0:16:27
epoch [10/50] batch [160/203] time 0.118 (0.119) data 0.000 (0.002) loss 0.7423 (0.8664) ce_loss 0.4692 (0.5861) teacher_loss 0.2081 (0.3228) loss_zs_kd 0.1589 (0.1917) loss_oracle 0.4547 (0.4477) acc 81.2500 (78.9453) kd_loss 0.9599 (0.9354) lr 1.8763e-03 eta 0:16:15
epoch [10/50] batch [180/203] time 0.113 (0.118) data 0.000 (0.002) loss 0.9001 (0.8669) ce_loss 0.4985 (0.5874) teacher_loss 0.3450 (0.3238) loss_zs_kd 0.1848 (0.1909) loss_oracle 0.4627 (0.4477) acc 84.3750 (78.9583) kd_loss 0.9357 (0.9360) lr 1.8763e-03 eta 0:16:03
epoch [10/50] batch [200/203] time 0.073 (0.116) data 0.000 (0.001) loss 1.0047 (0.8637) ce_loss 0.6812 (0.5846) teacher_loss 0.4149 (0.3206) loss_zs_kd 0.2053 (0.1916) loss_oracle 0.4872 (0.4473) acc 81.2500 (79.1562) kd_loss 0.9024 (0.9344) lr 1.8763e-03 eta 0:15:44
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,314
* accuracy: 82.8%
* error: 17.2%
* macro_f1: 86.5%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.3%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [11/50] batch [20/203] time 0.132 (0.122) data 0.000 (0.015) loss 0.9392 (0.8775) ce_loss 0.7788 (0.6121) teacher_loss 0.2850 (0.3313) loss_zs_kd 0.2371 (0.1958) loss_oracle 0.5356 (0.4482) acc 62.5000 (77.0312) kd_loss 0.9927 (0.9456) lr 1.8443e-03 eta 0:16:31
epoch [11/50] batch [40/203] time 0.108 (0.111) data 0.000 (0.007) loss 0.9216 (0.8834) ce_loss 0.6426 (0.6089) teacher_loss 0.3054 (0.3299) loss_zs_kd 0.2259 (0.1885) loss_oracle 0.5033 (0.4593) acc 75.0000 (77.7344) kd_loss 0.9949 (0.9411) lr 1.8443e-03 eta 0:14:57
epoch [11/50] batch [60/203] time 0.073 (0.107) data 0.000 (0.005) loss 1.0257 (0.8735) ce_loss 0.7891 (0.5894) teacher_loss 0.4234 (0.3241) loss_zs_kd 0.1488 (0.1857) loss_oracle 0.5278 (0.4565) acc 68.7500 (78.8021) kd_loss 0.9411 (0.9358) lr 1.8443e-03 eta 0:14:25
epoch [11/50] batch [80/203] time 0.113 (0.106) data 0.000 (0.004) loss 0.7313 (0.8654) ce_loss 0.4724 (0.5798) teacher_loss 0.1989 (0.3180) loss_zs_kd 0.1816 (0.1850) loss_oracle 0.4417 (0.4549) acc 84.3750 (78.9453) kd_loss 0.9530 (0.9355) lr 1.8443e-03 eta 0:14:16
epoch [11/50] batch [100/203] time 0.116 (0.107) data 0.000 (0.003) loss 0.7180 (0.8641) ce_loss 0.4800 (0.5782) teacher_loss 0.2241 (0.3219) loss_zs_kd 0.1669 (0.1823) loss_oracle 0.4105 (0.4511) acc 87.5000 (79.4375) kd_loss 0.8571 (0.9348) lr 1.8443e-03 eta 0:14:15
epoch [11/50] batch [120/203] time 0.083 (0.106) data 0.000 (0.003) loss 0.6875 (0.8615) ce_loss 0.4033 (0.5790) teacher_loss 0.2179 (0.3224) loss_zs_kd 0.1370 (0.1816) loss_oracle 0.4011 (0.4483) acc 87.5000 (79.4010) kd_loss 0.8293 (0.9357) lr 1.8443e-03 eta 0:14:08
epoch [11/50] batch [140/203] time 0.103 (0.105) data 0.000 (0.002) loss 0.8233 (0.8527) ce_loss 0.5024 (0.5736) teacher_loss 0.2438 (0.3207) loss_zs_kd 0.2251 (0.1798) loss_oracle 0.4669 (0.4421) acc 84.3750 (79.6205) kd_loss 0.9880 (0.9359) lr 1.8443e-03 eta 0:14:00
epoch [11/50] batch [160/203] time 0.113 (0.105) data 0.000 (0.002) loss 0.8266 (0.8499) ce_loss 0.5430 (0.5727) teacher_loss 0.3107 (0.3188) loss_zs_kd 0.2245 (0.1816) loss_oracle 0.4036 (0.4403) acc 71.8750 (79.5898) kd_loss 0.9949 (0.9352) lr 1.8443e-03 eta 0:13:52
epoch [11/50] batch [180/203] time 0.080 (0.103) data 0.000 (0.002) loss 0.7492 (0.8447) ce_loss 0.5576 (0.5673) teacher_loss 0.2544 (0.3125) loss_zs_kd 0.1610 (0.1814) loss_oracle 0.4143 (0.4415) acc 81.2500 (79.7049) kd_loss 0.9952 (0.9372) lr 1.8443e-03 eta 0:13:40
epoch [11/50] batch [200/203] time 0.077 (0.102) data 0.000 (0.002) loss 0.8068 (0.8471) ce_loss 0.5723 (0.5699) teacher_loss 0.3083 (0.3164) loss_zs_kd 0.1323 (0.1807) loss_oracle 0.4324 (0.4403) acc 84.3750 (79.5469) kd_loss 0.9151 (0.9368) lr 1.8443e-03 eta 0:13:28
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,325
* accuracy: 83.2%
* error: 16.8%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.3%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [12/50] batch [20/203] time 0.176 (0.107) data 0.001 (0.013) loss 0.8689 (0.8552) ce_loss 0.6240 (0.5919) teacher_loss 0.3759 (0.3513) loss_zs_kd 0.1851 (0.1772) loss_oracle 0.4005 (0.4154) acc 78.1250 (77.8125) kd_loss 0.9372 (0.9292) lr 1.8090e-03 eta 0:14:04
epoch [12/50] batch [40/203] time 0.138 (0.126) data 0.000 (0.007) loss 0.8146 (0.8338) ce_loss 0.4138 (0.5602) teacher_loss 0.2265 (0.3285) loss_zs_kd 0.2172 (0.1753) loss_oracle 0.4795 (0.4176) acc 81.2500 (78.6719) kd_loss 0.9198 (0.9315) lr 1.8090e-03 eta 0:16:31
epoch [12/50] batch [60/203] time 0.178 (0.114) data 0.001 (0.005) loss 0.8782 (0.8292) ce_loss 0.6104 (0.5598) teacher_loss 0.3686 (0.3225) loss_zs_kd 0.1934 (0.1764) loss_oracle 0.4129 (0.4185) acc 78.1250 (78.8021) kd_loss 0.9678 (0.9363) lr 1.8090e-03 eta 0:14:53
epoch [12/50] batch [80/203] time 0.141 (0.122) data 0.000 (0.004) loss 0.8777 (0.8340) ce_loss 0.8501 (0.5696) teacher_loss 0.3865 (0.3177) loss_zs_kd 0.1825 (0.1803) loss_oracle 0.3999 (0.4261) acc 65.6250 (78.5547) kd_loss 0.9601 (0.9402) lr 1.8090e-03 eta 0:15:58
epoch [12/50] batch [100/203] time 0.098 (0.117) data 0.000 (0.003) loss 0.8653 (0.8417) ce_loss 0.6489 (0.5730) teacher_loss 0.3125 (0.3155) loss_zs_kd 0.1973 (0.1847) loss_oracle 0.4542 (0.4338) acc 81.2500 (78.7812) kd_loss 0.9215 (0.9383) lr 1.8090e-03 eta 0:15:12
epoch [12/50] batch [120/203] time 0.083 (0.113) data 0.000 (0.002) loss 0.9683 (0.8470) ce_loss 0.8394 (0.5783) teacher_loss 0.5097 (0.3174) loss_zs_kd 0.1563 (0.1847) loss_oracle 0.3804 (0.4373) acc 71.8750 (78.8542) kd_loss 0.8435 (0.9376) lr 1.8090e-03 eta 0:14:42
epoch [12/50] batch [140/203] time 0.105 (0.111) data 0.000 (0.002) loss 0.7624 (0.8406) ce_loss 0.5283 (0.5673) teacher_loss 0.1603 (0.3082) loss_zs_kd 0.2240 (0.1869) loss_oracle 0.4901 (0.4390) acc 90.6250 (79.5536) kd_loss 0.9167 (0.9363) lr 1.8090e-03 eta 0:14:25
epoch [12/50] batch [160/203] time 0.077 (0.108) data 0.000 (0.002) loss 0.8149 (0.8350) ce_loss 0.3828 (0.5580) teacher_loss 0.1839 (0.3022) loss_zs_kd 0.1748 (0.1856) loss_oracle 0.5435 (0.4400) acc 87.5000 (79.8438) kd_loss 0.9504 (0.9358) lr 1.8090e-03 eta 0:13:58
epoch [12/50] batch [180/203] time 0.091 (0.107) data 0.000 (0.002) loss 0.7939 (0.8391) ce_loss 0.5581 (0.5608) teacher_loss 0.2124 (0.3041) loss_zs_kd 0.2059 (0.1852) loss_oracle 0.4785 (0.4424) acc 81.2500 (79.7569) kd_loss 0.8881 (0.9371) lr 1.8090e-03 eta 0:13:46
epoch [12/50] batch [200/203] time 0.096 (0.105) data 0.000 (0.002) loss 1.0252 (0.8455) ce_loss 0.7021 (0.5685) teacher_loss 0.4906 (0.3088) loss_zs_kd 0.1648 (0.1864) loss_oracle 0.4522 (0.4435) acc 78.1250 (79.5156) kd_loss 0.9009 (0.9366) lr 1.8090e-03 eta 0:13:32
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,319
* accuracy: 83.0%
* error: 17.0%
* macro_f1: 86.6%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.3%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [13/50] batch [20/203] time 0.107 (0.113) data 0.000 (0.014) loss 1.0120 (0.8941) ce_loss 0.7007 (0.5749) teacher_loss 0.4817 (0.3456) loss_zs_kd 0.1850 (0.1833) loss_oracle 0.4378 (0.4568) acc 78.1250 (79.5312) kd_loss 0.9384 (0.9323) lr 1.7705e-03 eta 0:14:26
epoch [13/50] batch [40/203] time 0.119 (0.106) data 0.000 (0.007) loss 0.9491 (0.8723) ce_loss 0.6187 (0.5519) teacher_loss 0.4361 (0.3188) loss_zs_kd 0.1687 (0.1836) loss_oracle 0.4287 (0.4617) acc 78.1250 (80.7031) kd_loss 0.9232 (0.9430) lr 1.7705e-03 eta 0:13:34
epoch [13/50] batch [60/203] time 0.105 (0.105) data 0.000 (0.005) loss 0.7102 (0.8771) ce_loss 0.3770 (0.5605) teacher_loss 0.2251 (0.3243) loss_zs_kd 0.1387 (0.1874) loss_oracle 0.4158 (0.4591) acc 81.2500 (80.2604) kd_loss 0.8691 (0.9399) lr 1.7705e-03 eta 0:13:21
epoch [13/50] batch [80/203] time 0.079 (0.102) data 0.000 (0.004) loss 0.7475 (0.8830) ce_loss 0.6177 (0.5687) teacher_loss 0.2390 (0.3316) loss_zs_kd 0.2361 (0.1890) loss_oracle 0.3904 (0.4569) acc 75.0000 (79.9609) kd_loss 0.9006 (0.9389) lr 1.7705e-03 eta 0:13:01
epoch [13/50] batch [100/203] time 0.128 (0.101) data 0.000 (0.003) loss 0.7880 (0.8792) ce_loss 0.5488 (0.5683) teacher_loss 0.2121 (0.3300) loss_zs_kd 0.1825 (0.1880) loss_oracle 0.4847 (0.4552) acc 75.0000 (80.0000) kd_loss 0.8937 (0.9369) lr 1.7705e-03 eta 0:12:49
epoch [13/50] batch [120/203] time 0.126 (0.102) data 0.000 (0.003) loss 0.9463 (0.8802) ce_loss 0.6475 (0.5700) teacher_loss 0.3696 (0.3351) loss_zs_kd 0.2158 (0.1880) loss_oracle 0.4688 (0.4511) acc 71.8750 (79.8698) kd_loss 0.9874 (0.9349) lr 1.7705e-03 eta 0:12:52
epoch [13/50] batch [140/203] time 0.118 (0.102) data 0.000 (0.002) loss 0.9969 (0.8781) ce_loss 0.6606 (0.5667) teacher_loss 0.4435 (0.3354) loss_zs_kd 0.2332 (0.1851) loss_oracle 0.4368 (0.4501) acc 75.0000 (80.0000) kd_loss 0.9656 (0.9334) lr 1.7705e-03 eta 0:12:52
epoch [13/50] batch [160/203] time 0.132 (0.102) data 0.000 (0.002) loss 1.1091 (0.8855) ce_loss 0.8955 (0.5721) teacher_loss 0.6010 (0.3455) loss_zs_kd 0.1521 (0.1852) loss_oracle 0.4321 (0.4475) acc 71.8750 (79.7852) kd_loss 0.9776 (0.9349) lr 1.7705e-03 eta 0:12:48
epoch [13/50] batch [180/203] time 0.113 (0.102) data 0.000 (0.002) loss 1.1505 (0.8855) ce_loss 0.7920 (0.5738) teacher_loss 0.6053 (0.3511) loss_zs_kd 0.1670 (0.1825) loss_oracle 0.4617 (0.4431) acc 68.7500 (79.4271) kd_loss 0.9354 (0.9354) lr 1.7705e-03 eta 0:12:48
epoch [13/50] batch [200/203] time 0.075 (0.101) data 0.000 (0.002) loss 0.5405 (0.8844) ce_loss 0.3120 (0.5722) teacher_loss 0.1724 (0.3556) loss_zs_kd 0.1387 (0.1808) loss_oracle 0.2988 (0.4384) acc 93.7500 (79.6094) kd_loss 1.0294 (0.9359) lr 1.7705e-03 eta 0:12:36
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,321
* accuracy: 83.0%
* error: 17.0%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.3%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [14/50] batch [20/203] time 0.080 (0.118) data 0.000 (0.017) loss 0.9690 (0.9243) ce_loss 0.6509 (0.5746) teacher_loss 0.4241 (0.4286) loss_zs_kd 0.1310 (0.1831) loss_oracle 0.4793 (0.4041) acc 78.1250 (79.5312) kd_loss 0.8811 (0.9260) lr 1.7290e-03 eta 0:14:46
epoch [14/50] batch [40/203] time 0.142 (0.129) data 0.001 (0.009) loss 0.6776 (0.9216) ce_loss 0.3420 (0.5680) teacher_loss 0.2955 (0.4382) loss_zs_kd 0.1391 (0.1630) loss_oracle 0.3126 (0.4019) acc 90.6250 (79.3750) kd_loss 0.8482 (0.9286) lr 1.7290e-03 eta 0:16:02
epoch [14/50] batch [60/203] time 0.185 (0.133) data 0.000 (0.006) loss 0.6997 (0.8957) ce_loss 0.3066 (0.5570) teacher_loss 0.2620 (0.4307) loss_zs_kd 0.1520 (0.1524) loss_oracle 0.3617 (0.3888) acc 93.7500 (79.7396) kd_loss 0.9948 (0.9302) lr 1.7290e-03 eta 0:16:31
epoch [14/50] batch [80/203] time 0.064 (0.137) data 0.001 (0.004) loss 0.7209 (0.8921) ce_loss 0.4736 (0.5620) teacher_loss 0.3701 (0.4388) loss_zs_kd 0.1158 (0.1517) loss_oracle 0.2929 (0.3775) acc 81.2500 (79.2188) kd_loss 0.8866 (0.9294) lr 1.7290e-03 eta 0:16:57
epoch [14/50] batch [100/203] time 0.100 (0.129) data 0.001 (0.004) loss 0.7688 (0.8845) ce_loss 0.5088 (0.5605) teacher_loss 0.3917 (0.4390) loss_zs_kd 0.1366 (0.1482) loss_oracle 0.3088 (0.3714) acc 78.1250 (79.0625) kd_loss 0.9660 (0.9296) lr 1.7290e-03 eta 0:15:53
epoch [14/50] batch [120/203] time 0.127 (0.126) data 0.000 (0.003) loss 0.8847 (0.8831) ce_loss 0.5713 (0.5587) teacher_loss 0.4325 (0.4443) loss_zs_kd 0.1439 (0.1451) loss_oracle 0.3802 (0.3663) acc 78.1250 (79.2708) kd_loss 0.9858 (0.9332) lr 1.7290e-03 eta 0:15:29
epoch [14/50] batch [140/203] time 0.118 (0.123) data 0.000 (0.003) loss 0.9065 (0.8847) ce_loss 0.5649 (0.5612) teacher_loss 0.4873 (0.4508) loss_zs_kd 0.1117 (0.1415) loss_oracle 0.3633 (0.3632) acc 81.2500 (79.1741) kd_loss 0.9419 (0.9373) lr 1.7290e-03 eta 0:15:03
epoch [14/50] batch [160/203] time 0.109 (0.121) data 0.000 (0.002) loss 0.9533 (0.8807) ce_loss 0.6187 (0.5577) teacher_loss 0.5562 (0.4506) loss_zs_kd 0.1445 (0.1382) loss_oracle 0.3249 (0.3610) acc 68.7500 (79.4141) kd_loss 0.8661 (0.9386) lr 1.7290e-03 eta 0:14:46
epoch [14/50] batch [180/203] time 0.072 (0.119) data 0.000 (0.002) loss 0.8369 (0.8779) ce_loss 0.4639 (0.5569) teacher_loss 0.4315 (0.4536) loss_zs_kd 0.1082 (0.1349) loss_oracle 0.3513 (0.3569) acc 84.3750 (79.5486) kd_loss 0.9233 (0.9386) lr 1.7290e-03 eta 0:14:31
epoch [14/50] batch [200/203] time 0.090 (0.117) data 0.000 (0.002) loss 0.6200 (0.8823) ce_loss 0.3745 (0.5629) teacher_loss 0.2822 (0.4627) loss_zs_kd 0.1011 (0.1318) loss_oracle 0.2872 (0.3536) acc 90.6250 (79.3594) kd_loss 0.9734 (0.9386) lr 1.7290e-03 eta 0:14:12
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,321
* accuracy: 83.0%
* error: 17.0%
* macro_f1: 86.4%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.3%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [15/50] batch [20/203] time 0.082 (0.126) data 0.000 (0.016) loss 0.8727 (0.7765) ce_loss 0.6553 (0.5023) teacher_loss 0.5517 (0.4217) loss_zs_kd 0.0766 (0.1031) loss_oracle 0.2828 (0.3032) acc 78.1250 (82.9688) kd_loss 0.9738 (0.9498) lr 1.6845e-03 eta 0:15:15
epoch [15/50] batch [40/203] time 0.079 (0.114) data 0.000 (0.008) loss 1.1571 (0.8372) ce_loss 0.9004 (0.5546) teacher_loss 0.8252 (0.4666) loss_zs_kd 0.1595 (0.1136) loss_oracle 0.2522 (0.3138) acc 65.6250 (80.5469) kd_loss 0.8548 (0.9464) lr 1.6845e-03 eta 0:13:52
epoch [15/50] batch [60/203] time 0.089 (0.114) data 0.000 (0.006) loss 0.7611 (0.8402) ce_loss 0.5200 (0.5623) teacher_loss 0.4193 (0.4719) loss_zs_kd 0.1029 (0.1144) loss_oracle 0.2904 (0.3111) acc 81.2500 (79.7917) kd_loss 0.9637 (0.9479) lr 1.6845e-03 eta 0:13:45
epoch [15/50] batch [80/203] time 0.086 (0.114) data 0.000 (0.004) loss 0.7623 (0.8352) ce_loss 0.4402 (0.5589) teacher_loss 0.4092 (0.4675) loss_zs_kd 0.1115 (0.1127) loss_oracle 0.2973 (0.3114) acc 90.6250 (79.8438) kd_loss 0.9421 (0.9460) lr 1.6845e-03 eta 0:13:44
epoch [15/50] batch [100/203] time 0.142 (0.114) data 0.000 (0.003) loss 0.9478 (0.8307) ce_loss 0.7388 (0.5559) teacher_loss 0.5846 (0.4666) loss_zs_kd 0.1201 (0.1110) loss_oracle 0.3031 (0.3085) acc 71.8750 (79.6562) kd_loss 0.9530 (0.9435) lr 1.6845e-03 eta 0:13:41
epoch [15/50] batch [120/203] time 0.110 (0.113) data 0.000 (0.003) loss 0.8310 (0.8288) ce_loss 0.6567 (0.5588) teacher_loss 0.4893 (0.4685) loss_zs_kd 0.1298 (0.1115) loss_oracle 0.2768 (0.3045) acc 71.8750 (79.4792) kd_loss 0.8883 (0.9402) lr 1.6845e-03 eta 0:13:32
epoch [15/50] batch [140/203] time 0.079 (0.112) data 0.000 (0.003) loss 0.9007 (0.8283) ce_loss 0.7461 (0.5596) teacher_loss 0.5660 (0.4679) loss_zs_kd 0.1133 (0.1120) loss_oracle 0.2781 (0.3045) acc 71.8750 (79.5982) kd_loss 0.8688 (0.9387) lr 1.6845e-03 eta 0:13:22
epoch [15/50] batch [160/203] time 0.117 (0.111) data 0.000 (0.002) loss 1.1235 (0.8269) ce_loss 0.8794 (0.5612) teacher_loss 0.8062 (0.4678) loss_zs_kd 0.1095 (0.1117) loss_oracle 0.2626 (0.3033) acc 62.5000 (79.5508) kd_loss 0.9624 (0.9361) lr 1.6845e-03 eta 0:13:10
epoch [15/50] batch [180/203] time 0.073 (0.109) data 0.000 (0.002) loss 0.8475 (0.8226) ce_loss 0.5898 (0.5621) teacher_loss 0.4979 (0.4676) loss_zs_kd 0.1239 (0.1098) loss_oracle 0.2876 (0.3001) acc 78.1250 (79.7917) kd_loss 0.9363 (0.9374) lr 1.6845e-03 eta 0:12:55
epoch [15/50] batch [200/203] time 0.093 (0.107) data 0.000 (0.002) loss 0.7289 (0.8190) ce_loss 0.4739 (0.5642) teacher_loss 0.4544 (0.4683) loss_zs_kd 0.0843 (0.1091) loss_oracle 0.2323 (0.2962) acc 75.0000 (79.5781) kd_loss 0.8575 (0.9352) lr 1.6845e-03 eta 0:12:39
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,322
* accuracy: 83.1%
* error: 16.9%
* macro_f1: 86.3%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.3%, epoch: 8 *******
******* Domain c best val test acc: 100.0%, epoch: 8 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [16/50] batch [20/203] time 0.172 (0.137) data 0.000 (0.013) loss 0.9412 (0.8535) ce_loss 0.6562 (0.6326) teacher_loss 0.6230 (0.5120) loss_zs_kd 0.0949 (0.1025) loss_oracle 0.2707 (0.2902) acc 81.2500 (77.1875) kd_loss 0.8915 (0.9241) lr 1.6374e-03 eta 0:16:08
epoch [16/50] batch [40/203] time 0.132 (0.140) data 0.000 (0.007) loss 0.8713 (0.8400) ce_loss 0.7603 (0.6098) teacher_loss 0.5549 (0.4950) loss_zs_kd 0.0891 (0.1037) loss_oracle 0.2719 (0.2931) acc 71.8750 (77.6562) kd_loss 0.9218 (0.9143) lr 1.6374e-03 eta 0:16:26
epoch [16/50] batch [60/203] time 0.071 (0.122) data 0.000 (0.004) loss 0.7447 (0.8251) ce_loss 0.6846 (0.5961) teacher_loss 0.4516 (0.4810) loss_zs_kd 0.1040 (0.1061) loss_oracle 0.2411 (0.2911) acc 81.2500 (78.5938) kd_loss 0.8343 (0.9232) lr 1.6374e-03 eta 0:14:22
epoch [16/50] batch [80/203] time 0.132 (0.117) data 0.000 (0.003) loss 0.8774 (0.8110) ce_loss 0.6274 (0.5883) teacher_loss 0.5584 (0.4736) loss_zs_kd 0.1336 (0.1042) loss_oracle 0.2522 (0.2853) acc 78.1250 (78.7500) kd_loss 0.9339 (0.9212) lr 1.6374e-03 eta 0:13:44
epoch [16/50] batch [100/203] time 0.110 (0.114) data 0.000 (0.003) loss 0.6645 (0.8125) ce_loss 0.3613 (0.5857) teacher_loss 0.2962 (0.4728) loss_zs_kd 0.1347 (0.1057) loss_oracle 0.3008 (0.2869) acc 93.7500 (78.8438) kd_loss 0.9251 (0.9186) lr 1.6374e-03 eta 0:13:21
epoch [16/50] batch [120/203] time 0.093 (0.112) data 0.000 (0.002) loss 0.8113 (0.8104) ce_loss 0.6431 (0.5824) teacher_loss 0.4949 (0.4700) loss_zs_kd 0.0907 (0.1075) loss_oracle 0.2709 (0.2867) acc 81.2500 (78.9323) kd_loss 0.9608 (0.9150) lr 1.6374e-03 eta 0:13:01
epoch [16/50] batch [140/203] time 0.076 (0.110) data 0.000 (0.002) loss 0.8648 (0.8027) ce_loss 0.6919 (0.5759) teacher_loss 0.5388 (0.4633) loss_zs_kd 0.1171 (0.1072) loss_oracle 0.2675 (0.2858) acc 65.6250 (79.0402) kd_loss 0.9591 (0.9150) lr 1.6374e-03 eta 0:12:48
epoch [16/50] batch [160/203] time 0.114 (0.109) data 0.000 (0.002) loss 0.6277 (0.8023) ce_loss 0.3584 (0.5777) teacher_loss 0.2982 (0.4620) loss_zs_kd 0.0947 (0.1080) loss_oracle 0.2821 (0.2863) acc 87.5000 (78.7695) kd_loss 0.9076 (0.9139) lr 1.6374e-03 eta 0:12:37
epoch [16/50] batch [180/203] time 0.083 (0.109) data 0.000 (0.002) loss 0.6133 (0.7999) ce_loss 0.4961 (0.5761) teacher_loss 0.3342 (0.4619) loss_zs_kd 0.0978 (0.1071) loss_oracle 0.2302 (0.2844) acc 81.2500 (78.8889) kd_loss 1.0022 (0.9121) lr 1.6374e-03 eta 0:12:34
epoch [16/50] batch [200/203] time 0.104 (0.108) data 0.000 (0.001) loss 0.7568 (0.7971) ce_loss 0.6084 (0.5747) teacher_loss 0.4725 (0.4581) loss_zs_kd 0.1063 (0.1073) loss_oracle 0.2312 (0.2854) acc 71.8750 (79.0000) kd_loss 0.8711 (0.9115) lr 1.6374e-03 eta 0:12:23
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,333
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.8%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.5%, epoch: 16 *******
******* Domain c best val test acc: 100.0%, epoch: 16 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [17/50] batch [20/203] time 0.134 (0.121) data 0.000 (0.012) loss 0.7373 (0.7943) ce_loss 0.4885 (0.5859) teacher_loss 0.3831 (0.4432) loss_zs_kd 0.0920 (0.1110) loss_oracle 0.3081 (0.2956) acc 87.5000 (78.9062) kd_loss 0.9732 (0.9006) lr 1.5878e-03 eta 0:13:49
epoch [17/50] batch [40/203] time 0.127 (0.115) data 0.000 (0.006) loss 1.0384 (0.7925) ce_loss 0.7236 (0.5700) teacher_loss 0.6191 (0.4310) loss_zs_kd 0.1635 (0.1107) loss_oracle 0.3376 (0.3061) acc 68.7500 (79.4531) kd_loss 0.8459 (0.8970) lr 1.5878e-03 eta 0:13:10
epoch [17/50] batch [60/203] time 0.142 (0.114) data 0.001 (0.004) loss 0.8336 (0.7943) ce_loss 0.5737 (0.5708) teacher_loss 0.4647 (0.4337) loss_zs_kd 0.1039 (0.1101) loss_oracle 0.3169 (0.3056) acc 68.7500 (79.3750) kd_loss 0.8542 (0.8941) lr 1.5878e-03 eta 0:12:59
epoch [17/50] batch [80/203] time 0.079 (0.114) data 0.000 (0.003) loss 0.7915 (0.7913) ce_loss 0.5591 (0.5709) teacher_loss 0.4667 (0.4380) loss_zs_kd 0.1164 (0.1109) loss_oracle 0.2666 (0.2978) acc 75.0000 (79.5703) kd_loss 0.9193 (0.8953) lr 1.5878e-03 eta 0:12:54
epoch [17/50] batch [100/203] time 0.089 (0.113) data 0.000 (0.003) loss 0.7738 (0.7947) ce_loss 0.5137 (0.5704) teacher_loss 0.4470 (0.4383) loss_zs_kd 0.1215 (0.1107) loss_oracle 0.2661 (0.3011) acc 78.1250 (79.4062) kd_loss 0.9000 (0.9003) lr 1.5878e-03 eta 0:12:49
epoch [17/50] batch [120/203] time 0.129 (0.112) data 0.000 (0.002) loss 0.7000 (0.7905) ce_loss 0.4521 (0.5633) teacher_loss 0.2926 (0.4339) loss_zs_kd 0.0964 (0.1097) loss_oracle 0.3592 (0.3017) acc 81.2500 (79.6615) kd_loss 0.9788 (0.9017) lr 1.5878e-03 eta 0:12:39
epoch [17/50] batch [140/203] time 0.107 (0.111) data 0.000 (0.002) loss 0.9737 (0.7875) ce_loss 0.7646 (0.5602) teacher_loss 0.5870 (0.4316) loss_zs_kd 0.1192 (0.1101) loss_oracle 0.3271 (0.3008) acc 78.1250 (79.9330) kd_loss 0.8208 (0.8984) lr 1.5878e-03 eta 0:12:30
epoch [17/50] batch [160/203] time 0.076 (0.110) data 0.000 (0.002) loss 0.9003 (0.7954) ce_loss 0.6514 (0.5709) teacher_loss 0.5064 (0.4406) loss_zs_kd 0.1454 (0.1103) loss_oracle 0.3211 (0.2996) acc 71.8750 (79.5312) kd_loss 1.0167 (0.9008) lr 1.5878e-03 eta 0:12:18
epoch [17/50] batch [180/203] time 0.065 (0.108) data 0.000 (0.002) loss 0.7630 (0.7919) ce_loss 0.5356 (0.5712) teacher_loss 0.4241 (0.4390) loss_zs_kd 0.1479 (0.1106) loss_oracle 0.2650 (0.2976) acc 75.0000 (79.6007) kd_loss 0.9566 (0.9000) lr 1.5878e-03 eta 0:12:06
epoch [17/50] batch [200/203] time 0.142 (0.109) data 0.000 (0.001) loss 0.8257 (0.7885) ce_loss 0.6333 (0.5718) teacher_loss 0.5287 (0.4369) loss_zs_kd 0.1032 (0.1132) loss_oracle 0.2454 (0.2950) acc 81.2500 (79.5156) kd_loss 0.9089 (0.8998) lr 1.5878e-03 eta 0:12:13
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,326
* accuracy: 83.2%
* error: 16.8%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.5%, epoch: 16 *******
******* Domain c best val test acc: 100.0%, epoch: 16 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [18/50] batch [20/203] time 0.128 (0.120) data 0.000 (0.014) loss 0.8391 (0.7540) ce_loss 0.7085 (0.5640) teacher_loss 0.5016 (0.4167) loss_zs_kd 0.1296 (0.1170) loss_oracle 0.2727 (0.2788) acc 75.0000 (80.6250) kd_loss 0.9311 (0.8860) lr 1.5358e-03 eta 0:13:19
epoch [18/50] batch [40/203] time 0.138 (0.112) data 0.000 (0.007) loss 0.7224 (0.7758) ce_loss 0.4861 (0.5807) teacher_loss 0.3583 (0.4412) loss_zs_kd 0.0648 (0.1136) loss_oracle 0.3317 (0.2779) acc 75.0000 (79.2188) kd_loss 0.9160 (0.8929) lr 1.5358e-03 eta 0:12:26
epoch [18/50] batch [60/203] time 0.086 (0.108) data 0.000 (0.005) loss 0.5998 (0.7744) ce_loss 0.4082 (0.5864) teacher_loss 0.3189 (0.4400) loss_zs_kd 0.1043 (0.1111) loss_oracle 0.2287 (0.2788) acc 90.6250 (79.1667) kd_loss 0.8562 (0.8931) lr 1.5358e-03 eta 0:12:00
epoch [18/50] batch [80/203] time 0.078 (0.107) data 0.000 (0.004) loss 0.8744 (0.7745) ce_loss 0.6914 (0.5867) teacher_loss 0.5163 (0.4437) loss_zs_kd 0.1177 (0.1122) loss_oracle 0.2992 (0.2747) acc 71.8750 (79.1016) kd_loss 0.8941 (0.8910) lr 1.5358e-03 eta 0:11:48
epoch [18/50] batch [100/203] time 0.085 (0.105) data 0.000 (0.003) loss 0.6936 (0.7644) ce_loss 0.4790 (0.5726) teacher_loss 0.3548 (0.4339) loss_zs_kd 0.0873 (0.1104) loss_oracle 0.2952 (0.2754) acc 75.0000 (79.6250) kd_loss 0.9332 (0.8907) lr 1.5358e-03 eta 0:11:36
epoch [18/50] batch [120/203] time 0.111 (0.105) data 0.000 (0.002) loss 0.7599 (0.7710) ce_loss 0.5483 (0.5784) teacher_loss 0.4741 (0.4432) loss_zs_kd 0.0993 (0.1087) loss_oracle 0.2361 (0.2734) acc 81.2500 (79.2188) kd_loss 0.9349 (0.8946) lr 1.5358e-03 eta 0:11:31
epoch [18/50] batch [140/203] time 0.122 (0.105) data 0.000 (0.002) loss 0.8882 (0.7705) ce_loss 0.8237 (0.5834) teacher_loss 0.6040 (0.4468) loss_zs_kd 0.1079 (0.1078) loss_oracle 0.2302 (0.2698) acc 71.8750 (79.0179) kd_loss 0.8281 (0.8933) lr 1.5358e-03 eta 0:11:27
epoch [18/50] batch [160/203] time 0.089 (0.104) data 0.000 (0.002) loss 0.8240 (0.7680) ce_loss 0.5967 (0.5821) teacher_loss 0.4699 (0.4451) loss_zs_kd 0.1572 (0.1091) loss_oracle 0.2755 (0.2684) acc 78.1250 (79.1016) kd_loss 0.9056 (0.8905) lr 1.5358e-03 eta 0:11:23
epoch [18/50] batch [180/203] time 0.132 (0.105) data 0.000 (0.002) loss 0.7662 (0.7652) ce_loss 0.6445 (0.5812) teacher_loss 0.4864 (0.4444) loss_zs_kd 0.1320 (0.1089) loss_oracle 0.2138 (0.2664) acc 68.7500 (79.1493) kd_loss 0.9414 (0.8893) lr 1.5358e-03 eta 0:11:22
epoch [18/50] batch [200/203] time 0.074 (0.104) data 0.000 (0.002) loss 0.6520 (0.7631) ce_loss 0.4675 (0.5827) teacher_loss 0.3676 (0.4428) loss_zs_kd 0.1210 (0.1097) loss_oracle 0.2239 (0.2654) acc 81.2500 (79.3125) kd_loss 0.8973 (0.8872) lr 1.5358e-03 eta 0:11:13
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,328
* accuracy: 83.3%
* error: 16.7%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.5%, epoch: 16 *******
******* Domain c best val test acc: 100.0%, epoch: 16 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [19/50] batch [20/203] time 0.126 (0.115) data 0.000 (0.012) loss 0.8556 (0.7374) ce_loss 0.8174 (0.5618) teacher_loss 0.6017 (0.4111) loss_zs_kd 0.1389 (0.1147) loss_oracle 0.1845 (0.2689) acc 65.6250 (79.3750) kd_loss 0.8146 (0.8885) lr 1.4818e-03 eta 0:12:23
epoch [19/50] batch [40/203] time 0.088 (0.110) data 0.000 (0.006) loss 0.7190 (0.7346) ce_loss 0.5576 (0.5511) teacher_loss 0.4459 (0.4099) loss_zs_kd 0.1144 (0.1140) loss_oracle 0.2160 (0.2676) acc 78.1250 (79.8438) kd_loss 0.8058 (0.8844) lr 1.4818e-03 eta 0:11:47
epoch [19/50] batch [60/203] time 0.134 (0.113) data 0.000 (0.004) loss 0.7754 (0.7289) ce_loss 0.5879 (0.5549) teacher_loss 0.4356 (0.4091) loss_zs_kd 0.1632 (0.1126) loss_oracle 0.2582 (0.2635) acc 75.0000 (79.4271) kd_loss 0.8846 (0.8843) lr 1.4818e-03 eta 0:12:04
epoch [19/50] batch [80/203] time 0.090 (0.110) data 0.000 (0.003) loss 0.7690 (0.7320) ce_loss 0.5898 (0.5586) teacher_loss 0.4881 (0.4143) loss_zs_kd 0.0968 (0.1124) loss_oracle 0.2325 (0.2616) acc 78.1250 (79.6484) kd_loss 0.8820 (0.8855) lr 1.4818e-03 eta 0:11:43
epoch [19/50] batch [100/203] time 0.069 (0.108) data 0.000 (0.003) loss 0.7698 (0.7438) ce_loss 0.5947 (0.5723) teacher_loss 0.4209 (0.4241) loss_zs_kd 0.1092 (0.1132) loss_oracle 0.2943 (0.2632) acc 75.0000 (79.3438) kd_loss 0.8976 (0.8847) lr 1.4818e-03 eta 0:11:31
epoch [19/50] batch [120/203] time 0.133 (0.108) data 0.000 (0.002) loss 0.9223 (0.7451) ce_loss 0.7905 (0.5719) teacher_loss 0.5836 (0.4267) loss_zs_kd 0.1311 (0.1108) loss_oracle 0.2732 (0.2630) acc 68.7500 (79.2708) kd_loss 0.9171 (0.8855) lr 1.4818e-03 eta 0:11:30
epoch [19/50] batch [140/203] time 0.133 (0.109) data 0.000 (0.002) loss 0.7829 (0.7470) ce_loss 0.4382 (0.5720) teacher_loss 0.4075 (0.4267) loss_zs_kd 0.1511 (0.1108) loss_oracle 0.2998 (0.2649) acc 81.2500 (79.3973) kd_loss 0.8550 (0.8842) lr 1.4818e-03 eta 0:11:29
epoch [19/50] batch [160/203] time 0.167 (0.109) data 0.000 (0.002) loss 0.6060 (0.7490) ce_loss 0.4038 (0.5748) teacher_loss 0.3025 (0.4271) loss_zs_kd 0.1219 (0.1114) loss_oracle 0.2426 (0.2662) acc 87.5000 (79.2773) kd_loss 0.8296 (0.8847) lr 1.4818e-03 eta 0:11:30
epoch [19/50] batch [180/203] time 0.085 (0.112) data 0.000 (0.002) loss 0.6499 (0.7533) ce_loss 0.5811 (0.5783) teacher_loss 0.3971 (0.4320) loss_zs_kd 0.0980 (0.1111) loss_oracle 0.2038 (0.2658) acc 78.1250 (79.1667) kd_loss 0.8326 (0.8841) lr 1.4818e-03 eta 0:11:48
epoch [19/50] batch [200/203] time 0.176 (0.114) data 0.000 (0.001) loss 1.0373 (0.7531) ce_loss 0.6909 (0.5777) teacher_loss 0.6543 (0.4324) loss_zs_kd 0.0769 (0.1106) loss_oracle 0.3445 (0.2654) acc 84.3750 (79.2031) kd_loss 0.9415 (0.8848) lr 1.4818e-03 eta 0:12:00
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,324
* accuracy: 83.1%
* error: 16.9%
* macro_f1: 86.5%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.5%, epoch: 16 *******
******* Domain c best val test acc: 100.0%, epoch: 16 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [20/50] batch [20/203] time 0.123 (0.123) data 0.000 (0.016) loss 0.8294 (0.7095) ce_loss 0.6416 (0.5165) teacher_loss 0.5215 (0.3834) loss_zs_kd 0.0873 (0.1000) loss_oracle 0.2643 (0.2761) acc 75.0000 (81.2500) kd_loss 0.9173 (0.8869) lr 1.4258e-03 eta 0:12:49
epoch [20/50] batch [40/203] time 0.131 (0.114) data 0.000 (0.008) loss 0.6976 (0.7357) ce_loss 0.5586 (0.5524) teacher_loss 0.3908 (0.4121) loss_zs_kd 0.1073 (0.1055) loss_oracle 0.2531 (0.2709) acc 71.8750 (80.5469) kd_loss 0.8621 (0.8802) lr 1.4258e-03 eta 0:11:49
epoch [20/50] batch [60/203] time 0.114 (0.109) data 0.000 (0.005) loss 0.7623 (0.7373) ce_loss 0.4871 (0.5536) teacher_loss 0.3971 (0.4124) loss_zs_kd 0.1335 (0.1063) loss_oracle 0.2985 (0.2717) acc 87.5000 (80.3646) kd_loss 0.8508 (0.8729) lr 1.4258e-03 eta 0:11:17
epoch [20/50] batch [80/203] time 0.112 (0.107) data 0.000 (0.004) loss 0.7297 (0.7343) ce_loss 0.4646 (0.5576) teacher_loss 0.4472 (0.4120) loss_zs_kd 0.1525 (0.1089) loss_oracle 0.2063 (0.2678) acc 84.3750 (80.0781) kd_loss 0.7780 (0.8736) lr 1.4258e-03 eta 0:11:03
epoch [20/50] batch [100/203] time 0.128 (0.108) data 0.000 (0.003) loss 0.5518 (0.7364) ce_loss 0.2693 (0.5569) teacher_loss 0.2218 (0.4113) loss_zs_kd 0.0876 (0.1110) loss_oracle 0.2862 (0.2696) acc 90.6250 (79.8438) kd_loss 0.8413 (0.8739) lr 1.4258e-03 eta 0:11:07
epoch [20/50] batch [120/203] time 0.127 (0.108) data 0.000 (0.003) loss 0.5143 (0.7468) ce_loss 0.3059 (0.5660) teacher_loss 0.1649 (0.4195) loss_zs_kd 0.1119 (0.1137) loss_oracle 0.2935 (0.2705) acc 90.6250 (79.5573) kd_loss 0.9029 (0.8734) lr 1.4258e-03 eta 0:11:07
epoch [20/50] batch [140/203] time 0.104 (0.108) data 0.000 (0.002) loss 0.6813 (0.7499) ce_loss 0.5303 (0.5683) teacher_loss 0.3305 (0.4197) loss_zs_kd 0.1434 (0.1154) loss_oracle 0.2791 (0.2725) acc 84.3750 (79.4643) kd_loss 0.8573 (0.8746) lr 1.4258e-03 eta 0:11:07
epoch [20/50] batch [160/203] time 0.096 (0.109) data 0.000 (0.002) loss 0.5807 (0.7532) ce_loss 0.4756 (0.5756) teacher_loss 0.2907 (0.4245) loss_zs_kd 0.1005 (0.1158) loss_oracle 0.2397 (0.2708) acc 84.3750 (79.1797) kd_loss 0.8551 (0.8748) lr 1.4258e-03 eta 0:11:09
epoch [20/50] batch [180/203] time 0.131 (0.109) data 0.000 (0.002) loss 0.6806 (0.7499) ce_loss 0.4656 (0.5748) teacher_loss 0.3204 (0.4222) loss_zs_kd 0.1063 (0.1151) loss_oracle 0.3071 (0.2701) acc 84.3750 (79.2361) kd_loss 0.8591 (0.8739) lr 1.4258e-03 eta 0:11:04
epoch [20/50] batch [200/203] time 0.125 (0.107) data 0.000 (0.002) loss 0.8916 (0.7500) ce_loss 0.9194 (0.5781) teacher_loss 0.5528 (0.4240) loss_zs_kd 0.1225 (0.1157) loss_oracle 0.2775 (0.2681) acc 62.5000 (79.2031) kd_loss 0.8965 (0.8727) lr 1.4258e-03 eta 0:10:54
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,331
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.5%, epoch: 16 *******
******* Domain c best val test acc: 100.0%, epoch: 16 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [21/50] batch [20/203] time 0.135 (0.113) data 0.000 (0.014) loss 0.4785 (0.7051) ce_loss 0.3745 (0.5157) teacher_loss 0.2447 (0.3623) loss_zs_kd 0.1127 (0.1309) loss_oracle 0.1775 (0.2775) acc 90.6250 (82.9688) kd_loss 0.8360 (0.8583) lr 1.3681e-03 eta 0:11:28
epoch [21/50] batch [40/203] time 0.139 (0.109) data 0.000 (0.007) loss 0.8390 (0.7156) ce_loss 0.5806 (0.5375) teacher_loss 0.3989 (0.3730) loss_zs_kd 0.1703 (0.1331) loss_oracle 0.3550 (0.2761) acc 68.7500 (80.8594) kd_loss 0.8747 (0.8682) lr 1.3681e-03 eta 0:10:59
epoch [21/50] batch [60/203] time 0.077 (0.108) data 0.000 (0.005) loss 0.6544 (0.7427) ce_loss 0.5742 (0.5616) teacher_loss 0.3698 (0.3967) loss_zs_kd 0.1016 (0.1243) loss_oracle 0.2338 (0.2838) acc 78.1250 (80.0000) kd_loss 0.7973 (0.8625) lr 1.3681e-03 eta 0:10:51
epoch [21/50] batch [80/203] time 0.079 (0.107) data 0.000 (0.004) loss 0.6140 (0.7443) ce_loss 0.4094 (0.5617) teacher_loss 0.2204 (0.3927) loss_zs_kd 0.1525 (0.1233) loss_oracle 0.3174 (0.2899) acc 78.1250 (79.8438) kd_loss 0.8869 (0.8638) lr 1.3681e-03 eta 0:10:44
epoch [21/50] batch [100/203] time 0.105 (0.107) data 0.000 (0.003) loss 0.9031 (0.7528) ce_loss 0.7529 (0.5674) teacher_loss 0.5351 (0.4045) loss_zs_kd 0.1117 (0.1225) loss_oracle 0.3122 (0.2871) acc 75.0000 (79.7812) kd_loss 0.8695 (0.8618) lr 1.3681e-03 eta 0:10:42
epoch [21/50] batch [120/203] time 0.138 (0.107) data 0.000 (0.003) loss 0.5950 (0.7516) ce_loss 0.2576 (0.5637) teacher_loss 0.1968 (0.4080) loss_zs_kd 0.1036 (0.1202) loss_oracle 0.3464 (0.2835) acc 96.8750 (79.9740) kd_loss 0.9514 (0.8628) lr 1.3681e-03 eta 0:10:40
epoch [21/50] batch [140/203] time 0.090 (0.112) data 0.000 (0.002) loss 0.6186 (0.7541) ce_loss 0.4204 (0.5725) teacher_loss 0.3345 (0.4154) loss_zs_kd 0.0773 (0.1203) loss_oracle 0.2454 (0.2785) acc 84.3750 (79.4420) kd_loss 0.8725 (0.8634) lr 1.3681e-03 eta 0:11:09
epoch [21/50] batch [160/203] time 0.127 (0.118) data 0.000 (0.002) loss 0.6348 (0.7492) ce_loss 0.4773 (0.5676) teacher_loss 0.3416 (0.4119) loss_zs_kd 0.1177 (0.1194) loss_oracle 0.2342 (0.2776) acc 87.5000 (79.5703) kd_loss 0.9350 (0.8650) lr 1.3681e-03 eta 0:11:40
epoch [21/50] batch [180/203] time 0.129 (0.118) data 0.000 (0.002) loss 0.8355 (0.7514) ce_loss 0.6450 (0.5673) teacher_loss 0.4905 (0.4154) loss_zs_kd 0.0934 (0.1187) loss_oracle 0.2982 (0.2767) acc 78.1250 (79.4444) kd_loss 0.8484 (0.8664) lr 1.3681e-03 eta 0:11:38
epoch [21/50] batch [200/203] time 0.079 (0.116) data 0.000 (0.002) loss 0.6634 (0.7503) ce_loss 0.4795 (0.5688) teacher_loss 0.3055 (0.4158) loss_zs_kd 0.1032 (0.1162) loss_oracle 0.3062 (0.2764) acc 84.3750 (79.2969) kd_loss 0.9304 (0.8666) lr 1.3681e-03 eta 0:11:23
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,328
* accuracy: 83.3%
* error: 16.7%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.5%, epoch: 16 *******
******* Domain c best val test acc: 100.0%, epoch: 16 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [22/50] batch [20/203] time 0.088 (0.127) data 0.000 (0.017) loss 0.7634 (0.7911) ce_loss 0.4932 (0.6167) teacher_loss 0.4000 (0.4623) loss_zs_kd 0.1115 (0.1157) loss_oracle 0.3076 (0.2709) acc 90.6250 (78.5938) kd_loss 0.8752 (0.8704) lr 1.3090e-03 eta 0:12:25
epoch [22/50] batch [40/203] time 0.139 (0.117) data 0.000 (0.008) loss 0.6631 (0.7643) ce_loss 0.6104 (0.6031) teacher_loss 0.3823 (0.4457) loss_zs_kd 0.1036 (0.1144) loss_oracle 0.2290 (0.2614) acc 81.2500 (79.4531) kd_loss 0.7992 (0.8626) lr 1.3090e-03 eta 0:11:26
epoch [22/50] batch [60/203] time 0.128 (0.115) data 0.000 (0.006) loss 0.8658 (0.7713) ce_loss 0.5854 (0.6021) teacher_loss 0.5221 (0.4457) loss_zs_kd 0.1128 (0.1117) loss_oracle 0.2873 (0.2698) acc 81.2500 (78.9583) kd_loss 0.9374 (0.8673) lr 1.3090e-03 eta 0:11:09
epoch [22/50] batch [80/203] time 0.109 (0.113) data 0.000 (0.004) loss 0.9238 (0.7646) ce_loss 0.6816 (0.5898) teacher_loss 0.6029 (0.4331) loss_zs_kd 0.1067 (0.1150) loss_oracle 0.2675 (0.2740) acc 75.0000 (79.3359) kd_loss 0.8638 (0.8702) lr 1.3090e-03 eta 0:10:57
epoch [22/50] batch [100/203] time 0.117 (0.113) data 0.000 (0.004) loss 0.8197 (0.7617) ce_loss 0.7207 (0.5813) teacher_loss 0.5254 (0.4296) loss_zs_kd 0.1277 (0.1146) loss_oracle 0.2304 (0.2748) acc 75.0000 (79.2500) kd_loss 0.7920 (0.8677) lr 1.3090e-03 eta 0:10:52
epoch [22/50] batch [120/203] time 0.118 (0.112) data 0.000 (0.003) loss 0.7475 (0.7619) ce_loss 0.6250 (0.5755) teacher_loss 0.4261 (0.4272) loss_zs_kd 0.0946 (0.1132) loss_oracle 0.2741 (0.2782) acc 75.0000 (79.2708) kd_loss 0.8767 (0.8697) lr 1.3090e-03 eta 0:10:44
epoch [22/50] batch [140/203] time 0.122 (0.111) data 0.000 (0.003) loss 1.0069 (0.7704) ce_loss 0.7593 (0.5850) teacher_loss 0.6223 (0.4346) loss_zs_kd 0.1417 (0.1133) loss_oracle 0.3138 (0.2791) acc 81.2500 (78.8170) kd_loss 0.8635 (0.8672) lr 1.3090e-03 eta 0:10:36
epoch [22/50] batch [160/203] time 0.078 (0.110) data 0.000 (0.002) loss 0.6059 (0.7678) ce_loss 0.3318 (0.5780) teacher_loss 0.2787 (0.4308) loss_zs_kd 0.0763 (0.1128) loss_oracle 0.2891 (0.2806) acc 87.5000 (79.2188) kd_loss 0.8380 (0.8673) lr 1.3090e-03 eta 0:10:27
epoch [22/50] batch [180/203] time 0.122 (0.109) data 0.000 (0.002) loss 0.6050 (0.7694) ce_loss 0.2810 (0.5803) teacher_loss 0.2119 (0.4339) loss_zs_kd 0.0946 (0.1110) loss_oracle 0.3458 (0.2800) acc 90.6250 (79.3229) kd_loss 0.8896 (0.8658) lr 1.3090e-03 eta 0:10:19
epoch [22/50] batch [200/203] time 0.094 (0.107) data 0.000 (0.002) loss 0.8333 (0.7684) ce_loss 0.7236 (0.5782) teacher_loss 0.4544 (0.4326) loss_zs_kd 0.1742 (0.1104) loss_oracle 0.2919 (0.2806) acc 71.8750 (79.4062) kd_loss 0.8464 (0.8656) lr 1.3090e-03 eta 0:10:08
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,325
* accuracy: 83.2%
* error: 16.8%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.5%, epoch: 16 *******
******* Domain c best val test acc: 100.0%, epoch: 16 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [23/50] batch [20/203] time 0.109 (0.114) data 0.000 (0.014) loss 0.8883 (0.7497) ce_loss 0.7261 (0.5635) teacher_loss 0.5927 (0.4119) loss_zs_kd 0.1088 (0.1119) loss_oracle 0.2412 (0.2818) acc 75.0000 (80.6250) kd_loss 0.8963 (0.8538) lr 1.2487e-03 eta 0:10:45
epoch [23/50] batch [40/203] time 0.127 (0.107) data 0.000 (0.007) loss 0.7506 (0.7605) ce_loss 0.6133 (0.5827) teacher_loss 0.4321 (0.4222) loss_zs_kd 0.1384 (0.1167) loss_oracle 0.2493 (0.2800) acc 78.1250 (79.2969) kd_loss 0.8538 (0.8459) lr 1.2487e-03 eta 0:10:02
epoch [23/50] batch [60/203] time 0.077 (0.104) data 0.000 (0.005) loss 0.6416 (0.7450) ce_loss 0.5161 (0.5549) teacher_loss 0.3359 (0.3988) loss_zs_kd 0.1429 (0.1216) loss_oracle 0.2342 (0.2854) acc 78.1250 (79.6875) kd_loss 0.8442 (0.8482) lr 1.2487e-03 eta 0:09:46
epoch [23/50] batch [80/203] time 0.128 (0.105) data 0.000 (0.004) loss 0.7662 (0.7519) ce_loss 0.5493 (0.5552) teacher_loss 0.4150 (0.3994) loss_zs_kd 0.1147 (0.1210) loss_oracle 0.2938 (0.2920) acc 75.0000 (79.8047) kd_loss 0.8968 (0.8545) lr 1.2487e-03 eta 0:09:47
epoch [23/50] batch [100/203] time 0.078 (0.107) data 0.000 (0.003) loss 0.8052 (0.7614) ce_loss 0.5479 (0.5618) teacher_loss 0.4665 (0.4101) loss_zs_kd 0.1025 (0.1191) loss_oracle 0.2875 (0.2917) acc 81.2500 (79.7188) kd_loss 0.8752 (0.8560) lr 1.2487e-03 eta 0:10:00
epoch [23/50] batch [120/203] time 0.146 (0.116) data 0.000 (0.003) loss 0.8776 (0.7647) ce_loss 0.6992 (0.5717) teacher_loss 0.4946 (0.4163) loss_zs_kd 0.1414 (0.1183) loss_oracle 0.3123 (0.2892) acc 81.2500 (79.5573) kd_loss 0.8305 (0.8532) lr 1.2487e-03 eta 0:10:45
epoch [23/50] batch [140/203] time 0.066 (0.114) data 0.000 (0.002) loss 0.7830 (0.7619) ce_loss 0.5908 (0.5702) teacher_loss 0.3953 (0.4144) loss_zs_kd 0.1168 (0.1190) loss_oracle 0.3292 (0.2880) acc 81.2500 (79.5536) kd_loss 0.8912 (0.8504) lr 1.2487e-03 eta 0:10:32
epoch [23/50] batch [160/203] time 0.098 (0.112) data 0.000 (0.002) loss 0.8201 (0.7614) ce_loss 0.8848 (0.5714) teacher_loss 0.4878 (0.4131) loss_zs_kd 0.1186 (0.1206) loss_oracle 0.2730 (0.2880) acc 65.6250 (79.3164) kd_loss 0.8424 (0.8530) lr 1.2487e-03 eta 0:10:17
epoch [23/50] batch [180/203] time 0.128 (0.110) data 0.000 (0.002) loss 0.8217 (0.7651) ce_loss 0.4390 (0.5717) teacher_loss 0.3478 (0.4146) loss_zs_kd 0.1330 (0.1206) loss_oracle 0.4074 (0.2901) acc 87.5000 (79.2708) kd_loss 0.8893 (0.8547) lr 1.2487e-03 eta 0:10:07
epoch [23/50] batch [200/203] time 0.094 (0.108) data 0.000 (0.002) loss 0.7308 (0.7646) ce_loss 0.5054 (0.5719) teacher_loss 0.3721 (0.4136) loss_zs_kd 0.1172 (0.1213) loss_oracle 0.3002 (0.2904) acc 75.0000 (79.1719) kd_loss 0.8450 (0.8540) lr 1.2487e-03 eta 0:09:51
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,340
* accuracy: 83.7%
* error: 16.3%
* macro_f1: 87.0%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.7%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [24/50] batch [20/203] time 0.123 (0.125) data 0.000 (0.013) loss 0.7861 (0.7721) ce_loss 0.4775 (0.5962) teacher_loss 0.4231 (0.4184) loss_zs_kd 0.1084 (0.1319) loss_oracle 0.3088 (0.2877) acc 81.2500 (79.8438) kd_loss 0.8780 (0.8483) lr 1.1874e-03 eta 0:11:20
epoch [24/50] batch [40/203] time 0.077 (0.116) data 0.000 (0.006) loss 0.8087 (0.7800) ce_loss 0.5996 (0.6062) teacher_loss 0.4358 (0.4363) loss_zs_kd 0.1358 (0.1252) loss_oracle 0.3050 (0.2811) acc 90.6250 (79.6875) kd_loss 0.8294 (0.8516) lr 1.1874e-03 eta 0:10:28
epoch [24/50] batch [60/203] time 0.083 (0.112) data 0.000 (0.004) loss 0.7221 (0.7806) ce_loss 0.5591 (0.6026) teacher_loss 0.3046 (0.4276) loss_zs_kd 0.1567 (0.1264) loss_oracle 0.3391 (0.2898) acc 78.1250 (79.4271) kd_loss 0.9282 (0.8586) lr 1.1874e-03 eta 0:10:09
epoch [24/50] batch [80/203] time 0.126 (0.111) data 0.000 (0.003) loss 0.8358 (0.7835) ce_loss 0.6221 (0.6024) teacher_loss 0.5108 (0.4300) loss_zs_kd 0.1173 (0.1282) loss_oracle 0.2663 (0.2894) acc 81.2500 (78.7109) kd_loss 0.8208 (0.8557) lr 1.1874e-03 eta 0:10:00
epoch [24/50] batch [100/203] time 0.133 (0.111) data 0.000 (0.003) loss 0.9287 (0.7803) ce_loss 0.5645 (0.5920) teacher_loss 0.5302 (0.4273) loss_zs_kd 0.1285 (0.1270) loss_oracle 0.3342 (0.2895) acc 78.1250 (78.7500) kd_loss 0.8862 (0.8513) lr 1.1874e-03 eta 0:09:57
epoch [24/50] batch [120/203] time 0.112 (0.110) data 0.000 (0.002) loss 0.6263 (0.7822) ce_loss 0.5205 (0.5907) teacher_loss 0.3239 (0.4254) loss_zs_kd 0.1091 (0.1263) loss_oracle 0.2479 (0.2936) acc 81.2500 (78.6979) kd_loss 0.8523 (0.8519) lr 1.1874e-03 eta 0:09:50
epoch [24/50] batch [140/203] time 0.104 (0.108) data 0.000 (0.002) loss 0.5974 (0.7730) ce_loss 0.3655 (0.5769) teacher_loss 0.2412 (0.4145) loss_zs_kd 0.1035 (0.1266) loss_oracle 0.3045 (0.2952) acc 84.3750 (79.2634) kd_loss 0.8218 (0.8521) lr 1.1874e-03 eta 0:09:39
epoch [24/50] batch [160/203] time 0.131 (0.108) data 0.000 (0.002) loss 0.7468 (0.7655) ce_loss 0.6255 (0.5689) teacher_loss 0.3997 (0.4074) loss_zs_kd 0.1309 (0.1264) loss_oracle 0.2817 (0.2950) acc 78.1250 (79.6289) kd_loss 0.8314 (0.8521) lr 1.1874e-03 eta 0:09:37
epoch [24/50] batch [180/203] time 0.088 (0.108) data 0.000 (0.002) loss 0.9725 (0.7649) ce_loss 0.9458 (0.5700) teacher_loss 0.6586 (0.4080) loss_zs_kd 0.1106 (0.1272) loss_oracle 0.2587 (0.2933) acc 65.6250 (79.5486) kd_loss 0.8060 (0.8514) lr 1.1874e-03 eta 0:09:34
epoch [24/50] batch [200/203] time 0.081 (0.107) data 0.000 (0.001) loss 0.5993 (0.7643) ce_loss 0.4146 (0.5698) teacher_loss 0.2692 (0.4075) loss_zs_kd 0.1440 (0.1272) loss_oracle 0.2581 (0.2932) acc 90.6250 (79.6250) kd_loss 0.7778 (0.8506) lr 1.1874e-03 eta 0:09:26
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,332
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.7%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [25/50] batch [20/203] time 0.127 (0.127) data 0.000 (0.017) loss 0.5724 (0.8066) ce_loss 0.4180 (0.5605) teacher_loss 0.2557 (0.4199) loss_zs_kd 0.1387 (0.1252) loss_oracle 0.2473 (0.3241) acc 87.5000 (80.4688) kd_loss 0.7813 (0.8643) lr 1.1253e-03 eta 0:11:08
epoch [25/50] batch [40/203] time 0.164 (0.129) data 0.000 (0.009) loss 1.0685 (0.7837) ce_loss 0.8706 (0.5545) teacher_loss 0.6202 (0.3927) loss_zs_kd 0.1398 (0.1256) loss_oracle 0.3784 (0.3281) acc 68.7500 (79.8438) kd_loss 0.8921 (0.8574) lr 1.1253e-03 eta 0:11:17
epoch [25/50] batch [60/203] time 0.191 (0.135) data 0.000 (0.006) loss 0.7830 (0.7652) ce_loss 0.5527 (0.5370) teacher_loss 0.4525 (0.3793) loss_zs_kd 0.1585 (0.1279) loss_oracle 0.2513 (0.3220) acc 81.2500 (80.2083) kd_loss 0.8769 (0.8565) lr 1.1253e-03 eta 0:11:43
epoch [25/50] batch [80/203] time 0.085 (0.140) data 0.000 (0.005) loss 0.9853 (0.7650) ce_loss 0.8433 (0.5428) teacher_loss 0.5983 (0.3823) loss_zs_kd 0.1487 (0.1271) loss_oracle 0.3126 (0.3191) acc 68.7500 (80.5078) kd_loss 0.8503 (0.8551) lr 1.1253e-03 eta 0:12:09
epoch [25/50] batch [100/203] time 0.113 (0.133) data 0.000 (0.004) loss 0.7555 (0.7704) ce_loss 0.5566 (0.5497) teacher_loss 0.3702 (0.3861) loss_zs_kd 0.1094 (0.1298) loss_oracle 0.3307 (0.3194) acc 78.1250 (80.0625) kd_loss 0.8229 (0.8542) lr 1.1253e-03 eta 0:11:30
epoch [25/50] batch [120/203] time 0.108 (0.127) data 0.000 (0.003) loss 0.6169 (0.7714) ce_loss 0.4419 (0.5570) teacher_loss 0.2150 (0.3885) loss_zs_kd 0.1526 (0.1325) loss_oracle 0.3255 (0.3167) acc 87.5000 (79.7917) kd_loss 0.8755 (0.8535) lr 1.1253e-03 eta 0:10:57
epoch [25/50] batch [140/203] time 0.113 (0.123) data 0.000 (0.003) loss 0.7939 (0.7775) ce_loss 0.6191 (0.5640) teacher_loss 0.3924 (0.3948) loss_zs_kd 0.1276 (0.1336) loss_oracle 0.3377 (0.3158) acc 81.2500 (79.7545) kd_loss 0.8833 (0.8540) lr 1.1253e-03 eta 0:10:29
epoch [25/50] batch [160/203] time 0.122 (0.120) data 0.000 (0.002) loss 0.7464 (0.7734) ce_loss 0.5679 (0.5634) teacher_loss 0.3383 (0.3900) loss_zs_kd 0.1577 (0.1344) loss_oracle 0.3293 (0.3162) acc 75.0000 (79.6484) kd_loss 0.9087 (0.8562) lr 1.1253e-03 eta 0:10:15
epoch [25/50] batch [180/203] time 0.075 (0.118) data 0.000 (0.002) loss 0.6568 (0.7738) ce_loss 0.3625 (0.5622) teacher_loss 0.1720 (0.3885) loss_zs_kd 0.1394 (0.1348) loss_oracle 0.4151 (0.3179) acc 87.5000 (79.7917) kd_loss 0.9497 (0.8571) lr 1.1253e-03 eta 0:10:01
epoch [25/50] batch [200/203] time 0.076 (0.116) data 0.000 (0.002) loss 0.7485 (0.7716) ce_loss 0.6250 (0.5609) teacher_loss 0.3161 (0.3852) loss_zs_kd 0.1631 (0.1356) loss_oracle 0.3508 (0.3186) acc 78.1250 (79.6875) kd_loss 0.8779 (0.8574) lr 1.1253e-03 eta 0:09:46
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,336
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.7%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [26/50] batch [20/203] time 0.124 (0.111) data 0.000 (0.015) loss 0.8877 (0.7754) ce_loss 0.5684 (0.5397) teacher_loss 0.4339 (0.3730) loss_zs_kd 0.1747 (0.1470) loss_oracle 0.3665 (0.3289) acc 87.5000 (80.9375) kd_loss 0.8164 (0.8521) lr 1.0628e-03 eta 0:09:19
epoch [26/50] batch [40/203] time 0.090 (0.103) data 0.001 (0.007) loss 0.9444 (0.7553) ce_loss 0.7739 (0.5265) teacher_loss 0.6136 (0.3622) loss_zs_kd 0.1686 (0.1375) loss_oracle 0.2465 (0.3244) acc 71.8750 (80.8594) kd_loss 0.8661 (0.8594) lr 1.0628e-03 eta 0:08:39
epoch [26/50] batch [60/203] time 0.117 (0.103) data 0.000 (0.005) loss 0.7751 (0.7618) ce_loss 0.5596 (0.5513) teacher_loss 0.3793 (0.3721) loss_zs_kd 0.1574 (0.1418) loss_oracle 0.3171 (0.3188) acc 87.5000 (79.4792) kd_loss 0.8747 (0.8518) lr 1.0628e-03 eta 0:08:34
epoch [26/50] batch [80/203] time 0.094 (0.101) data 0.000 (0.004) loss 0.9477 (0.7676) ce_loss 0.7012 (0.5587) teacher_loss 0.5269 (0.3752) loss_zs_kd 0.1933 (0.1461) loss_oracle 0.3241 (0.3193) acc 75.0000 (79.2578) kd_loss 0.8450 (0.8543) lr 1.0628e-03 eta 0:08:26
epoch [26/50] batch [100/203] time 0.100 (0.101) data 0.000 (0.003) loss 0.8199 (0.7663) ce_loss 0.5298 (0.5597) teacher_loss 0.4298 (0.3716) loss_zs_kd 0.1599 (0.1478) loss_oracle 0.3101 (0.3209) acc 81.2500 (79.1250) kd_loss 0.8408 (0.8552) lr 1.0628e-03 eta 0:08:20
epoch [26/50] batch [120/203] time 0.087 (0.101) data 0.000 (0.003) loss 0.6704 (0.7645) ce_loss 0.3889 (0.5622) teacher_loss 0.2667 (0.3680) loss_zs_kd 0.1501 (0.1503) loss_oracle 0.3286 (0.3213) acc 84.3750 (79.4271) kd_loss 0.9290 (0.8576) lr 1.0628e-03 eta 0:08:18
epoch [26/50] batch [140/203] time 0.131 (0.101) data 0.000 (0.002) loss 0.7602 (0.7673) ce_loss 0.4656 (0.5687) teacher_loss 0.3534 (0.3728) loss_zs_kd 0.1627 (0.1507) loss_oracle 0.3254 (0.3191) acc 90.6250 (79.2411) kd_loss 0.8646 (0.8582) lr 1.0628e-03 eta 0:08:16
epoch [26/50] batch [160/203] time 0.095 (0.102) data 0.001 (0.002) loss 0.6852 (0.7722) ce_loss 0.3425 (0.5646) teacher_loss 0.2507 (0.3756) loss_zs_kd 0.1026 (0.1489) loss_oracle 0.3831 (0.3221) acc 84.3750 (79.1992) kd_loss 0.8321 (0.8577) lr 1.0628e-03 eta 0:08:22
epoch [26/50] batch [180/203] time 0.082 (0.103) data 0.000 (0.002) loss 0.6500 (0.7705) ce_loss 0.3628 (0.5635) teacher_loss 0.1866 (0.3732) loss_zs_kd 0.1168 (0.1481) loss_oracle 0.4050 (0.3232) acc 87.5000 (79.4444) kd_loss 0.9483 (0.8589) lr 1.0628e-03 eta 0:08:23
epoch [26/50] batch [200/203] time 0.096 (0.102) data 0.000 (0.002) loss 1.0781 (0.7725) ce_loss 0.9429 (0.5655) teacher_loss 0.7185 (0.3748) loss_zs_kd 0.1850 (0.1495) loss_oracle 0.2672 (0.3230) acc 71.8750 (79.3750) kd_loss 0.8240 (0.8592) lr 1.0628e-03 eta 0:08:18
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,331
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.7%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [27/50] batch [20/203] time 0.166 (0.152) data 0.001 (0.013) loss 0.8629 (0.7256) ce_loss 0.4663 (0.5160) teacher_loss 0.4436 (0.3167) loss_zs_kd 0.1511 (0.1546) loss_oracle 0.3437 (0.3315) acc 87.5000 (81.7188) kd_loss 0.8830 (0.8707) lr 1.0000e-03 eta 0:12:16
epoch [27/50] batch [40/203] time 0.175 (0.144) data 0.000 (0.007) loss 0.6815 (0.7441) ce_loss 0.4050 (0.5329) teacher_loss 0.2559 (0.3328) loss_zs_kd 0.1694 (0.1531) loss_oracle 0.3409 (0.3348) acc 81.2500 (80.7812) kd_loss 0.8169 (0.8624) lr 1.0000e-03 eta 0:11:33
epoch [27/50] batch [60/203] time 0.056 (0.150) data 0.001 (0.004) loss 0.7237 (0.7469) ce_loss 0.4077 (0.5241) teacher_loss 0.2654 (0.3245) loss_zs_kd 0.1996 (0.1595) loss_oracle 0.3585 (0.3426) acc 84.3750 (81.1458) kd_loss 0.8204 (0.8652) lr 1.0000e-03 eta 0:12:03
epoch [27/50] batch [80/203] time 0.135 (0.137) data 0.000 (0.003) loss 1.2129 (0.7760) ce_loss 1.0352 (0.5483) teacher_loss 0.7537 (0.3502) loss_zs_kd 0.1233 (0.1579) loss_oracle 0.3975 (0.3468) acc 59.3750 (79.5703) kd_loss 0.8506 (0.8680) lr 1.0000e-03 eta 0:10:57
epoch [27/50] batch [100/203] time 0.083 (0.132) data 0.000 (0.003) loss 0.7611 (0.7877) ce_loss 0.3416 (0.5578) teacher_loss 0.2759 (0.3608) loss_zs_kd 0.1229 (0.1559) loss_oracle 0.4237 (0.3490) acc 87.5000 (78.9062) kd_loss 0.8706 (0.8678) lr 1.0000e-03 eta 0:10:28
epoch [27/50] batch [120/203] time 0.102 (0.128) data 0.000 (0.002) loss 0.6585 (0.8026) ce_loss 0.2502 (0.5631) teacher_loss 0.1671 (0.3732) loss_zs_kd 0.1249 (0.1550) loss_oracle 0.4289 (0.3518) acc 96.8750 (78.8281) kd_loss 0.8402 (0.8695) lr 1.0000e-03 eta 0:10:06
epoch [27/50] batch [140/203] time 0.089 (0.125) data 0.000 (0.002) loss 0.9299 (0.8077) ce_loss 0.7183 (0.5609) teacher_loss 0.5283 (0.3782) loss_zs_kd 0.1207 (0.1543) loss_oracle 0.3412 (0.3524) acc 81.2500 (78.9955) kd_loss 0.8441 (0.8722) lr 1.0000e-03 eta 0:09:52
epoch [27/50] batch [160/203] time 0.138 (0.123) data 0.001 (0.002) loss 0.8930 (0.8006) ce_loss 0.7651 (0.5526) teacher_loss 0.4826 (0.3715) loss_zs_kd 0.1715 (0.1518) loss_oracle 0.3246 (0.3532) acc 75.0000 (79.4141) kd_loss 0.8596 (0.8742) lr 1.0000e-03 eta 0:09:41
epoch [27/50] batch [180/203] time 0.139 (0.122) data 0.000 (0.002) loss 1.0361 (0.8048) ce_loss 0.8076 (0.5525) teacher_loss 0.6061 (0.3749) loss_zs_kd 0.1896 (0.1522) loss_oracle 0.3352 (0.3538) acc 71.8750 (79.3403) kd_loss 0.8515 (0.8747) lr 1.0000e-03 eta 0:09:31
epoch [27/50] batch [200/203] time 0.086 (0.119) data 0.000 (0.002) loss 0.6232 (0.8032) ce_loss 0.3743 (0.5498) teacher_loss 0.1702 (0.3727) loss_zs_kd 0.1570 (0.1517) loss_oracle 0.3745 (0.3547) acc 93.7500 (79.5156) kd_loss 0.8439 (0.8747) lr 1.0000e-03 eta 0:09:17
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,332
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.7%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [28/50] batch [20/203] time 0.095 (0.115) data 0.000 (0.017) loss 0.8256 (0.7801) ce_loss 0.7529 (0.5593) teacher_loss 0.4695 (0.3529) loss_zs_kd 0.1668 (0.1659) loss_oracle 0.2728 (0.3442) acc 78.1250 (78.7500) kd_loss 0.8377 (0.8800) lr 9.3721e-04 eta 0:08:53
epoch [28/50] batch [40/203] time 0.085 (0.101) data 0.000 (0.009) loss 0.8162 (0.7732) ce_loss 0.4976 (0.5389) teacher_loss 0.3368 (0.3405) loss_zs_kd 0.1280 (0.1611) loss_oracle 0.4154 (0.3522) acc 81.2500 (80.2344) kd_loss 0.8407 (0.8812) lr 9.3721e-04 eta 0:07:47
epoch [28/50] batch [60/203] time 0.099 (0.096) data 0.000 (0.006) loss 0.7391 (0.7781) ce_loss 0.5176 (0.5526) teacher_loss 0.3424 (0.3461) loss_zs_kd 0.2026 (0.1622) loss_oracle 0.2953 (0.3509) acc 78.1250 (79.1146) kd_loss 0.8500 (0.8738) lr 9.3721e-04 eta 0:07:24
epoch [28/50] batch [80/203] time 0.087 (0.095) data 0.000 (0.004) loss 0.9367 (0.7863) ce_loss 0.7910 (0.5570) teacher_loss 0.5206 (0.3497) loss_zs_kd 0.2257 (0.1645) loss_oracle 0.3033 (0.3543) acc 75.0000 (79.1797) kd_loss 0.8606 (0.8765) lr 9.3721e-04 eta 0:07:17
epoch [28/50] batch [100/203] time 0.119 (0.095) data 0.000 (0.004) loss 0.5990 (0.7802) ce_loss 0.3748 (0.5426) teacher_loss 0.1968 (0.3427) loss_zs_kd 0.1430 (0.1610) loss_oracle 0.3307 (0.3570) acc 84.3750 (79.5312) kd_loss 0.8894 (0.8759) lr 9.3721e-04 eta 0:07:12
epoch [28/50] batch [120/203] time 0.100 (0.094) data 0.000 (0.003) loss 0.7882 (0.7779) ce_loss 0.5239 (0.5359) teacher_loss 0.3053 (0.3371) loss_zs_kd 0.1564 (0.1623) loss_oracle 0.4047 (0.3597) acc 75.0000 (79.7135) kd_loss 0.9150 (0.8759) lr 9.3721e-04 eta 0:07:05
epoch [28/50] batch [140/203] time 0.079 (0.093) data 0.000 (0.003) loss 0.6804 (0.7819) ce_loss 0.4478 (0.5380) teacher_loss 0.2613 (0.3408) loss_zs_kd 0.1406 (0.1619) loss_oracle 0.3487 (0.3602) acc 81.2500 (79.7098) kd_loss 0.8863 (0.8780) lr 9.3721e-04 eta 0:07:01
epoch [28/50] batch [160/203] time 0.083 (0.093) data 0.000 (0.002) loss 0.8934 (0.7831) ce_loss 0.8267 (0.5422) teacher_loss 0.5191 (0.3431) loss_zs_kd 0.1399 (0.1608) loss_oracle 0.3043 (0.3596) acc 81.2500 (79.6094) kd_loss 0.8439 (0.8771) lr 9.3721e-04 eta 0:06:59
epoch [28/50] batch [180/203] time 0.079 (0.092) data 0.000 (0.002) loss 0.6509 (0.7900) ce_loss 0.3074 (0.5473) teacher_loss 0.2269 (0.3482) loss_zs_kd 0.1292 (0.1613) loss_oracle 0.3594 (0.3612) acc 96.8750 (79.5660) kd_loss 0.8484 (0.8770) lr 9.3721e-04 eta 0:06:54
epoch [28/50] batch [200/203] time 0.076 (0.092) data 0.000 (0.002) loss 1.0966 (0.7923) ce_loss 0.9644 (0.5522) teacher_loss 0.6554 (0.3508) loss_zs_kd 0.2203 (0.1616) loss_oracle 0.3311 (0.3608) acc 65.6250 (79.5000) kd_loss 0.8698 (0.8768) lr 9.3721e-04 eta 0:06:50
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,328
* accuracy: 83.3%
* error: 16.7%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.7%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [29/50] batch [20/203] time 0.130 (0.131) data 0.000 (0.013) loss 0.7885 (0.7351) ce_loss 0.6104 (0.4733) teacher_loss 0.3667 (0.2941) loss_zs_kd 0.1616 (0.1628) loss_oracle 0.3409 (0.3595) acc 75.0000 (82.6562) kd_loss 0.9294 (0.8710) lr 8.7467e-04 eta 0:09:40
epoch [29/50] batch [40/203] time 0.087 (0.128) data 0.000 (0.007) loss 0.7504 (0.7894) ce_loss 0.5405 (0.5441) teacher_loss 0.3289 (0.3396) loss_zs_kd 0.1700 (0.1665) loss_oracle 0.3365 (0.3666) acc 78.1250 (80.4688) kd_loss 0.8520 (0.8845) lr 8.7467e-04 eta 0:09:26
epoch [29/50] batch [60/203] time 0.162 (0.129) data 0.000 (0.005) loss 0.8154 (0.7913) ce_loss 0.6636 (0.5528) teacher_loss 0.3434 (0.3404) loss_zs_kd 0.1865 (0.1702) loss_oracle 0.3788 (0.3657) acc 68.7500 (80.2083) kd_loss 0.9520 (0.8836) lr 8.7467e-04 eta 0:09:28
epoch [29/50] batch [80/203] time 0.101 (0.128) data 0.000 (0.003) loss 0.7365 (0.7774) ce_loss 0.4570 (0.5428) teacher_loss 0.3865 (0.3312) loss_zs_kd 0.1419 (0.1713) loss_oracle 0.2791 (0.3606) acc 78.1250 (80.6250) kd_loss 0.8944 (0.8787) lr 8.7467e-04 eta 0:09:22
epoch [29/50] batch [100/203] time 0.078 (0.123) data 0.000 (0.003) loss 0.6372 (0.7676) ce_loss 0.4583 (0.5364) teacher_loss 0.2597 (0.3240) loss_zs_kd 0.1828 (0.1707) loss_oracle 0.2862 (0.3582) acc 78.1250 (80.8438) kd_loss 0.8954 (0.8804) lr 8.7467e-04 eta 0:08:58
epoch [29/50] batch [120/203] time 0.082 (0.119) data 0.000 (0.002) loss 0.7596 (0.7791) ce_loss 0.4917 (0.5466) teacher_loss 0.2650 (0.3320) loss_zs_kd 0.1504 (0.1709) loss_oracle 0.4194 (0.3617) acc 81.2500 (80.5729) kd_loss 0.9218 (0.8861) lr 8.7467e-04 eta 0:08:39
epoch [29/50] batch [140/203] time 0.116 (0.117) data 0.000 (0.002) loss 0.7861 (0.7773) ce_loss 0.6504 (0.5471) teacher_loss 0.3766 (0.3328) loss_zs_kd 0.2107 (0.1696) loss_oracle 0.3042 (0.3597) acc 75.0000 (80.5357) kd_loss 0.9033 (0.8853) lr 8.7467e-04 eta 0:08:26
epoch [29/50] batch [160/203] time 0.110 (0.115) data 0.000 (0.002) loss 0.8676 (0.7769) ce_loss 0.4023 (0.5488) teacher_loss 0.2896 (0.3331) loss_zs_kd 0.1485 (0.1712) loss_oracle 0.5038 (0.3583) acc 87.5000 (80.4688) kd_loss 0.9229 (0.8827) lr 8.7467e-04 eta 0:08:16
epoch [29/50] batch [180/203] time 0.089 (0.113) data 0.000 (0.002) loss 1.0401 (0.7749) ce_loss 0.7939 (0.5492) teacher_loss 0.5868 (0.3331) loss_zs_kd 0.2088 (0.1700) loss_oracle 0.3489 (0.3568) acc 59.3750 (80.3819) kd_loss 0.8913 (0.8817) lr 8.7467e-04 eta 0:08:05
epoch [29/50] batch [200/203] time 0.103 (0.112) data 0.000 (0.002) loss 0.6535 (0.7763) ce_loss 0.4714 (0.5507) teacher_loss 0.2704 (0.3356) loss_zs_kd 0.1308 (0.1690) loss_oracle 0.3177 (0.3562) acc 87.5000 (80.3906) kd_loss 0.8981 (0.8824) lr 8.7467e-04 eta 0:07:55
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,332
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.7%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [30/50] batch [20/203] time 0.096 (0.107) data 0.000 (0.016) loss 0.8758 (0.7879) ce_loss 0.6689 (0.5586) teacher_loss 0.4021 (0.3277) loss_zs_kd 0.2161 (0.1668) loss_oracle 0.3656 (0.3767) acc 68.7500 (78.4375) kd_loss 0.9115 (0.9057) lr 8.1262e-04 eta 0:07:32
epoch [30/50] batch [40/203] time 0.104 (0.100) data 0.000 (0.008) loss 0.7302 (0.7921) ce_loss 0.3235 (0.5655) teacher_loss 0.2313 (0.3262) loss_zs_kd 0.1486 (0.1762) loss_oracle 0.4245 (0.3778) acc 87.5000 (78.5938) kd_loss 0.8484 (0.9043) lr 8.1262e-04 eta 0:07:02
epoch [30/50] batch [60/203] time 0.067 (0.100) data 0.000 (0.006) loss 0.7011 (0.7967) ce_loss 0.4878 (0.5608) teacher_loss 0.2591 (0.3356) loss_zs_kd 0.1608 (0.1732) loss_oracle 0.3616 (0.3745) acc 81.2500 (78.8542) kd_loss 0.8927 (0.9005) lr 8.1262e-04 eta 0:06:58
epoch [30/50] batch [80/203] time 0.093 (0.099) data 0.000 (0.004) loss 0.7660 (0.7951) ce_loss 0.5630 (0.5586) teacher_loss 0.3855 (0.3408) loss_zs_kd 0.1599 (0.1704) loss_oracle 0.3005 (0.3692) acc 81.2500 (78.9062) kd_loss 0.8396 (0.8993) lr 8.1262e-04 eta 0:06:55
epoch [30/50] batch [100/203] time 0.099 (0.098) data 0.000 (0.003) loss 0.7089 (0.7966) ce_loss 0.5693 (0.5612) teacher_loss 0.2912 (0.3400) loss_zs_kd 0.1639 (0.1714) loss_oracle 0.3357 (0.3709) acc 78.1250 (78.9062) kd_loss 0.8811 (0.8967) lr 8.1262e-04 eta 0:06:48
epoch [30/50] batch [120/203] time 0.106 (0.097) data 0.000 (0.003) loss 0.9111 (0.7970) ce_loss 0.7759 (0.5562) teacher_loss 0.4617 (0.3389) loss_zs_kd 0.1806 (0.1714) loss_oracle 0.3591 (0.3723) acc 62.5000 (79.2448) kd_loss 0.9047 (0.8969) lr 8.1262e-04 eta 0:06:43
epoch [30/50] batch [140/203] time 0.077 (0.097) data 0.000 (0.002) loss 0.7450 (0.7958) ce_loss 0.6138 (0.5578) teacher_loss 0.4285 (0.3409) loss_zs_kd 0.1344 (0.1699) loss_oracle 0.2492 (0.3700) acc 78.1250 (79.3304) kd_loss 0.8549 (0.8933) lr 8.1262e-04 eta 0:06:40
epoch [30/50] batch [160/203] time 0.100 (0.099) data 0.000 (0.002) loss 0.6114 (0.7935) ce_loss 0.3921 (0.5599) teacher_loss 0.2401 (0.3374) loss_zs_kd 0.1277 (0.1714) loss_oracle 0.3074 (0.3704) acc 84.3750 (79.2188) kd_loss 0.8534 (0.8929) lr 8.1262e-04 eta 0:06:44
epoch [30/50] batch [180/203] time 0.133 (0.099) data 0.000 (0.002) loss 0.6698 (0.7903) ce_loss 0.4749 (0.5548) teacher_loss 0.2196 (0.3317) loss_zs_kd 0.1847 (0.1706) loss_oracle 0.3578 (0.3732) acc 84.3750 (79.4965) kd_loss 0.8676 (0.8930) lr 8.1262e-04 eta 0:06:45
epoch [30/50] batch [200/203] time 0.070 (0.099) data 0.000 (0.002) loss 0.7892 (0.7938) ce_loss 0.3792 (0.5567) teacher_loss 0.1939 (0.3325) loss_zs_kd 0.1538 (0.1702) loss_oracle 0.5184 (0.3761) acc 90.6250 (79.5781) kd_loss 0.9283 (0.8928) lr 8.1262e-04 eta 0:06:41
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,335
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.7%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [31/50] batch [20/203] time 0.130 (0.148) data 0.000 (0.013) loss 0.8495 (0.8250) ce_loss 0.6855 (0.5596) teacher_loss 0.3979 (0.3373) loss_zs_kd 0.1646 (0.1692) loss_oracle 0.3693 (0.4031) acc 78.1250 (79.2188) kd_loss 0.9061 (0.9154) lr 7.5131e-04 eta 0:09:55
epoch [31/50] batch [40/203] time 0.127 (0.129) data 0.000 (0.007) loss 0.8489 (0.8157) ce_loss 0.5073 (0.5621) teacher_loss 0.3778 (0.3289) loss_zs_kd 0.1690 (0.1815) loss_oracle 0.3867 (0.3961) acc 81.2500 (78.9062) kd_loss 0.8998 (0.9136) lr 7.5131e-04 eta 0:08:39
epoch [31/50] batch [60/203] time 0.141 (0.141) data 0.000 (0.005) loss 0.7846 (0.8087) ce_loss 0.6582 (0.5681) teacher_loss 0.3603 (0.3211) loss_zs_kd 0.1845 (0.1847) loss_oracle 0.3320 (0.3953) acc 78.1250 (79.2188) kd_loss 0.9172 (0.9129) lr 7.5131e-04 eta 0:09:23
epoch [31/50] batch [80/203] time 0.072 (0.133) data 0.000 (0.004) loss 0.6566 (0.7888) ce_loss 0.5059 (0.5565) teacher_loss 0.1927 (0.3076) loss_zs_kd 0.2004 (0.1834) loss_oracle 0.3638 (0.3895) acc 81.2500 (79.6875) kd_loss 0.8842 (0.9073) lr 7.5131e-04 eta 0:08:47
epoch [31/50] batch [100/203] time 0.126 (0.128) data 0.000 (0.003) loss 0.6759 (0.7892) ce_loss 0.5239 (0.5551) teacher_loss 0.2903 (0.3113) loss_zs_kd 0.1483 (0.1813) loss_oracle 0.3115 (0.3872) acc 75.0000 (79.6250) kd_loss 0.8680 (0.9057) lr 7.5131e-04 eta 0:08:26
epoch [31/50] batch [120/203] time 0.094 (0.124) data 0.000 (0.002) loss 0.7578 (0.7854) ce_loss 0.4954 (0.5584) teacher_loss 0.2615 (0.3115) loss_zs_kd 0.1748 (0.1818) loss_oracle 0.4088 (0.3830) acc 87.5000 (79.6094) kd_loss 0.9115 (0.9030) lr 7.5131e-04 eta 0:08:09
epoch [31/50] batch [140/203] time 0.087 (0.121) data 0.000 (0.002) loss 0.6509 (0.7832) ce_loss 0.4409 (0.5569) teacher_loss 0.1674 (0.3128) loss_zs_kd 0.1868 (0.1818) loss_oracle 0.3901 (0.3794) acc 87.5000 (79.7768) kd_loss 0.8839 (0.9010) lr 7.5131e-04 eta 0:07:54
epoch [31/50] batch [160/203] time 0.110 (0.119) data 0.000 (0.002) loss 0.7479 (0.7811) ce_loss 0.4814 (0.5526) teacher_loss 0.2530 (0.3122) loss_zs_kd 0.1652 (0.1777) loss_oracle 0.4123 (0.3800) acc 78.1250 (79.9219) kd_loss 0.8849 (0.9001) lr 7.5131e-04 eta 0:07:45
epoch [31/50] batch [180/203] time 0.100 (0.118) data 0.000 (0.002) loss 0.8260 (0.7846) ce_loss 0.6685 (0.5520) teacher_loss 0.3666 (0.3135) loss_zs_kd 0.1880 (0.1774) loss_oracle 0.3654 (0.3824) acc 62.5000 (79.8438) kd_loss 0.9079 (0.8992) lr 7.5131e-04 eta 0:07:39
epoch [31/50] batch [200/203] time 0.076 (0.116) data 0.000 (0.002) loss 0.7794 (0.7864) ce_loss 0.5708 (0.5533) teacher_loss 0.3524 (0.3187) loss_zs_kd 0.1366 (0.1747) loss_oracle 0.3587 (0.3803) acc 81.2500 (79.7656) kd_loss 0.8362 (0.8984) lr 7.5131e-04 eta 0:07:27
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,330
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,414
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain c best val acc:      83.7%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [32/50] batch [20/203] time 0.110 (0.123) data 0.000 (0.015) loss 0.7013 (0.8066) ce_loss 0.3232 (0.5777) teacher_loss 0.2606 (0.3460) loss_zs_kd 0.1646 (0.1678) loss_oracle 0.3584 (0.3767) acc 90.6250 (79.8438) kd_loss 0.8878 (0.8924) lr 6.9098e-04 eta 0:07:53
epoch [32/50] batch [40/203] time 0.103 (0.114) data 0.000 (0.008) loss 0.6905 (0.7974) ce_loss 0.4758 (0.5898) teacher_loss 0.3400 (0.3547) loss_zs_kd 0.1374 (0.1662) loss_oracle 0.2818 (0.3596) acc 81.2500 (78.6719) kd_loss 0.8830 (0.8845) lr 6.9098e-04 eta 0:07:15
epoch [32/50] batch [60/203] time 0.089 (0.114) data 0.000 (0.005) loss 0.8102 (0.7849) ce_loss 0.5024 (0.5681) teacher_loss 0.3260 (0.3399) loss_zs_kd 0.1427 (0.1628) loss_oracle 0.4128 (0.3636) acc 81.2500 (79.1667) kd_loss 0.9139 (0.8848) lr 6.9098e-04 eta 0:07:12
epoch [32/50] batch [80/203] time 0.139 (0.112) data 0.000 (0.004) loss 0.9183 (0.7773) ce_loss 0.7202 (0.5546) teacher_loss 0.5182 (0.3307) loss_zs_kd 0.1432 (0.1659) loss_oracle 0.3284 (0.3636) acc 75.0000 (79.4922) kd_loss 0.8482 (0.8846) lr 6.9098e-04 eta 0:07:04
epoch [32/50] batch [100/203] time 0.102 (0.108) data 0.000 (0.003) loss 0.8700 (0.7824) ce_loss 0.7686 (0.5547) teacher_loss 0.4785 (0.3349) loss_zs_kd 0.1897 (0.1653) loss_oracle 0.2967 (0.3649) acc 62.5000 (79.4062) kd_loss 0.8299 (0.8812) lr 6.9098e-04 eta 0:06:47
epoch [32/50] batch [120/203] time 0.075 (0.108) data 0.000 (0.003) loss 0.8195 (0.7913) ce_loss 0.6167 (0.5607) teacher_loss 0.4332 (0.3418) loss_zs_kd 0.1443 (0.1654) loss_oracle 0.3141 (0.3668) acc 78.1250 (79.4010) kd_loss 0.8385 (0.8789) lr 6.9098e-04 eta 0:06:42
epoch [32/50] batch [140/203] time 0.115 (0.108) data 0.000 (0.002) loss 0.6902 (0.7939) ce_loss 0.3994 (0.5597) teacher_loss 0.2120 (0.3431) loss_zs_kd 0.1445 (0.1649) loss_oracle 0.4060 (0.3683) acc 90.6250 (79.3527) kd_loss 0.9147 (0.8793) lr 6.9098e-04 eta 0:06:41
epoch [32/50] batch [160/203] time 0.093 (0.108) data 0.000 (0.002) loss 0.8573 (0.8025) ce_loss 0.6328 (0.5632) teacher_loss 0.3869 (0.3494) loss_zs_kd 0.1655 (0.1645) loss_oracle 0.3877 (0.3709) acc 78.1250 (79.4727) kd_loss 0.9306 (0.8792) lr 6.9098e-04 eta 0:06:39
epoch [32/50] batch [180/203] time 0.124 (0.108) data 0.000 (0.002) loss 0.7565 (0.8014) ce_loss 0.4568 (0.5597) teacher_loss 0.2830 (0.3457) loss_zs_kd 0.1838 (0.1642) loss_oracle 0.3816 (0.3736) acc 71.8750 (79.3924) kd_loss 0.9161 (0.8811) lr 6.9098e-04 eta 0:06:37
epoch [32/50] batch [200/203] time 0.098 (0.108) data 0.000 (0.002) loss 0.9236 (0.8026) ce_loss 0.7095 (0.5627) teacher_loss 0.3659 (0.3459) loss_zs_kd 0.2296 (0.1659) loss_oracle 0.4429 (0.3737) acc 71.8750 (79.3281) kd_loss 0.9196 (0.8827) lr 6.9098e-04 eta 0:06:34
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,333
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.7%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [33/50] batch [20/203] time 0.059 (0.169) data 0.000 (0.017) loss 0.9071 (0.8302) ce_loss 0.7646 (0.5785) teacher_loss 0.4477 (0.3410) loss_zs_kd 0.2083 (0.1822) loss_oracle 0.3552 (0.3980) acc 71.8750 (78.7500) kd_loss 0.8861 (0.8864) lr 6.3188e-04 eta 0:10:12
epoch [33/50] batch [40/203] time 0.112 (0.127) data 0.000 (0.008) loss 0.5739 (0.8162) ce_loss 0.3518 (0.5844) teacher_loss 0.1839 (0.3398) loss_zs_kd 0.1680 (0.1763) loss_oracle 0.3061 (0.3883) acc 84.3750 (78.1250) kd_loss 0.8181 (0.8846) lr 6.3188e-04 eta 0:07:37
epoch [33/50] batch [60/203] time 0.129 (0.116) data 0.000 (0.006) loss 0.7724 (0.8052) ce_loss 0.6299 (0.5635) teacher_loss 0.3292 (0.3311) loss_zs_kd 0.1993 (0.1774) loss_oracle 0.3436 (0.3854) acc 65.6250 (79.0625) kd_loss 0.8893 (0.8849) lr 6.3188e-04 eta 0:06:55
epoch [33/50] batch [80/203] time 0.113 (0.111) data 0.000 (0.004) loss 0.5828 (0.7939) ce_loss 0.4666 (0.5583) teacher_loss 0.2579 (0.3250) loss_zs_kd 0.1296 (0.1795) loss_oracle 0.2601 (0.3791) acc 75.0000 (79.3359) kd_loss 0.7981 (0.8862) lr 6.3188e-04 eta 0:06:37
epoch [33/50] batch [100/203] time 0.117 (0.110) data 0.000 (0.004) loss 0.7381 (0.7856) ce_loss 0.6064 (0.5449) teacher_loss 0.2781 (0.3174) loss_zs_kd 0.2000 (0.1762) loss_oracle 0.3600 (0.3801) acc 87.5000 (80.1250) kd_loss 0.9032 (0.8862) lr 6.3188e-04 eta 0:06:30
epoch [33/50] batch [120/203] time 0.099 (0.106) data 0.000 (0.003) loss 0.5514 (0.7890) ce_loss 0.3267 (0.5467) teacher_loss 0.1417 (0.3218) loss_zs_kd 0.1663 (0.1736) loss_oracle 0.3265 (0.3804) acc 90.6250 (80.5990) kd_loss 0.8357 (0.8856) lr 6.3188e-04 eta 0:06:14
epoch [33/50] batch [140/203] time 0.102 (0.104) data 0.000 (0.003) loss 0.7941 (0.7936) ce_loss 0.4038 (0.5452) teacher_loss 0.3116 (0.3247) loss_zs_kd 0.1464 (0.1714) loss_oracle 0.4093 (0.3832) acc 81.2500 (80.6696) kd_loss 0.9343 (0.8870) lr 6.3188e-04 eta 0:06:06
epoch [33/50] batch [160/203] time 0.097 (0.104) data 0.000 (0.002) loss 0.9454 (0.7978) ce_loss 0.6089 (0.5483) teacher_loss 0.5032 (0.3282) loss_zs_kd 0.1483 (0.1707) loss_oracle 0.3681 (0.3842) acc 81.2500 (80.7031) kd_loss 0.7813 (0.8862) lr 6.3188e-04 eta 0:06:04
epoch [33/50] batch [180/203] time 0.077 (0.104) data 0.000 (0.002) loss 0.7950 (0.8004) ce_loss 0.5894 (0.5499) teacher_loss 0.3406 (0.3316) loss_zs_kd 0.1539 (0.1695) loss_oracle 0.3774 (0.3841) acc 68.7500 (80.2951) kd_loss 0.9076 (0.8855) lr 6.3188e-04 eta 0:06:00
epoch [33/50] batch [200/203] time 0.097 (0.102) data 0.000 (0.002) loss 0.9613 (0.8010) ce_loss 0.6255 (0.5513) teacher_loss 0.3711 (0.3329) loss_zs_kd 0.2248 (0.1691) loss_oracle 0.4778 (0.3835) acc 68.7500 (80.0625) kd_loss 0.8631 (0.8846) lr 6.3188e-04 eta 0:05:53
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,319
* accuracy: 83.0%
* error: 17.0%
* macro_f1: 86.6%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,414
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain c best val acc:      83.7%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [34/50] batch [20/203] time 0.077 (0.110) data 0.000 (0.012) loss 0.7784 (0.7972) ce_loss 0.5234 (0.5149) teacher_loss 0.2908 (0.3026) loss_zs_kd 0.1542 (0.1756) loss_oracle 0.4105 (0.4068) acc 90.6250 (82.6562) kd_loss 0.9062 (0.8839) lr 5.7422e-04 eta 0:06:16
epoch [34/50] batch [40/203] time 0.086 (0.104) data 0.000 (0.006) loss 0.8474 (0.7888) ce_loss 0.5303 (0.5275) teacher_loss 0.3970 (0.3130) loss_zs_kd 0.1586 (0.1756) loss_oracle 0.3711 (0.3880) acc 84.3750 (80.9375) kd_loss 0.9474 (0.8894) lr 5.7422e-04 eta 0:05:55
epoch [34/50] batch [60/203] time 0.076 (0.102) data 0.000 (0.004) loss 0.6541 (0.7836) ce_loss 0.3303 (0.5266) teacher_loss 0.2066 (0.3125) loss_zs_kd 0.1913 (0.1749) loss_oracle 0.3518 (0.3837) acc 93.7500 (81.3542) kd_loss 0.8470 (0.8856) lr 5.7422e-04 eta 0:05:45
epoch [34/50] batch [80/203] time 0.115 (0.103) data 0.000 (0.003) loss 0.7772 (0.7797) ce_loss 0.4788 (0.5353) teacher_loss 0.2663 (0.3180) loss_zs_kd 0.1909 (0.1703) loss_oracle 0.4155 (0.3766) acc 78.1250 (81.2891) kd_loss 0.9518 (0.8830) lr 5.7422e-04 eta 0:05:48
epoch [34/50] batch [100/203] time 0.121 (0.103) data 0.000 (0.003) loss 0.9618 (0.7837) ce_loss 0.7563 (0.5349) teacher_loss 0.4844 (0.3199) loss_zs_kd 0.1916 (0.1731) loss_oracle 0.3817 (0.3773) acc 75.0000 (81.4375) kd_loss 0.8930 (0.8859) lr 5.7422e-04 eta 0:05:43
epoch [34/50] batch [120/203] time 0.078 (0.102) data 0.000 (0.002) loss 0.7619 (0.7960) ce_loss 0.6528 (0.5529) teacher_loss 0.3470 (0.3316) loss_zs_kd 0.1753 (0.1734) loss_oracle 0.3272 (0.3777) acc 75.0000 (80.3906) kd_loss 0.9094 (0.8857) lr 5.7422e-04 eta 0:05:41
epoch [34/50] batch [140/203] time 0.077 (0.103) data 0.000 (0.002) loss 0.7677 (0.7963) ce_loss 0.5127 (0.5493) teacher_loss 0.2743 (0.3293) loss_zs_kd 0.1433 (0.1729) loss_oracle 0.4218 (0.3806) acc 84.3750 (80.3795) kd_loss 0.8270 (0.8860) lr 5.7422e-04 eta 0:05:40
epoch [34/50] batch [160/203] time 0.109 (0.103) data 0.000 (0.002) loss 0.8161 (0.8030) ce_loss 0.6719 (0.5594) teacher_loss 0.4209 (0.3368) loss_zs_kd 0.1598 (0.1716) loss_oracle 0.3153 (0.3805) acc 78.1250 (80.0391) kd_loss 0.9413 (0.8873) lr 5.7422e-04 eta 0:05:37
epoch [34/50] batch [180/203] time 0.078 (0.102) data 0.000 (0.002) loss 0.6419 (0.8037) ce_loss 0.2744 (0.5567) teacher_loss 0.1549 (0.3355) loss_zs_kd 0.1541 (0.1710) loss_oracle 0.4099 (0.3828) acc 87.5000 (80.0174) kd_loss 0.8692 (0.8868) lr 5.7422e-04 eta 0:05:34
epoch [34/50] batch [200/203] time 0.074 (0.100) data 0.000 (0.001) loss 0.7268 (0.8044) ce_loss 0.4473 (0.5543) teacher_loss 0.2945 (0.3357) loss_zs_kd 0.1573 (0.1704) loss_oracle 0.3536 (0.3835) acc 81.2500 (80.0469) kd_loss 0.8435 (0.8864) lr 5.7422e-04 eta 0:05:26
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,332
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.7%, epoch: 23 *******
******* Domain c best val test acc: 100.0%, epoch: 23 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [35/50] batch [20/203] time 0.068 (0.146) data 0.000 (0.013) loss 0.7538 (0.8397) ce_loss 0.4636 (0.5712) teacher_loss 0.3055 (0.3542) loss_zs_kd 0.1491 (0.1792) loss_oracle 0.3737 (0.3959) acc 84.3750 (79.2188) kd_loss 0.9300 (0.8835) lr 5.1825e-04 eta 0:07:52
epoch [35/50] batch [40/203] time 0.114 (0.122) data 0.000 (0.006) loss 0.6508 (0.8384) ce_loss 0.4495 (0.5720) teacher_loss 0.2097 (0.3482) loss_zs_kd 0.1709 (0.1788) loss_oracle 0.3556 (0.4009) acc 84.3750 (79.6094) kd_loss 0.8985 (0.8801) lr 5.1825e-04 eta 0:06:30
epoch [35/50] batch [60/203] time 0.106 (0.114) data 0.000 (0.004) loss 0.9308 (0.8304) ce_loss 0.6460 (0.5754) teacher_loss 0.3899 (0.3506) loss_zs_kd 0.2117 (0.1776) loss_oracle 0.4351 (0.3910) acc 75.0000 (79.1667) kd_loss 0.8970 (0.8847) lr 5.1825e-04 eta 0:06:02
epoch [35/50] batch [80/203] time 0.108 (0.111) data 0.000 (0.003) loss 0.9220 (0.8118) ce_loss 0.7979 (0.5707) teacher_loss 0.5048 (0.3429) loss_zs_kd 0.2018 (0.1743) loss_oracle 0.3163 (0.3818) acc 75.0000 (78.9844) kd_loss 0.9061 (0.8851) lr 5.1825e-04 eta 0:05:53
epoch [35/50] batch [100/203] time 0.124 (0.110) data 0.000 (0.003) loss 0.8308 (0.8072) ce_loss 0.5527 (0.5590) teacher_loss 0.4027 (0.3397) loss_zs_kd 0.1520 (0.1704) loss_oracle 0.3521 (0.3823) acc 81.2500 (79.4688) kd_loss 0.9076 (0.8838) lr 5.1825e-04 eta 0:05:45
epoch [35/50] batch [120/203] time 0.107 (0.108) data 0.000 (0.002) loss 0.7159 (0.8030) ce_loss 0.4207 (0.5535) teacher_loss 0.2288 (0.3412) loss_zs_kd 0.1584 (0.1663) loss_oracle 0.4078 (0.3786) acc 84.3750 (80.0000) kd_loss 0.8953 (0.8827) lr 5.1825e-04 eta 0:05:38
epoch [35/50] batch [140/203] time 0.092 (0.107) data 0.000 (0.002) loss 0.6195 (0.7963) ce_loss 0.3911 (0.5528) teacher_loss 0.2016 (0.3376) loss_zs_kd 0.1290 (0.1677) loss_oracle 0.3534 (0.3748) acc 81.2500 (79.8661) kd_loss 0.8905 (0.8837) lr 5.1825e-04 eta 0:05:32
epoch [35/50] batch [160/203] time 0.105 (0.106) data 0.000 (0.002) loss 0.7770 (0.7972) ce_loss 0.5293 (0.5587) teacher_loss 0.3799 (0.3412) loss_zs_kd 0.1613 (0.1672) loss_oracle 0.3165 (0.3724) acc 81.2500 (79.2773) kd_loss 0.9052 (0.8817) lr 5.1825e-04 eta 0:05:28
epoch [35/50] batch [180/203] time 0.088 (0.106) data 0.000 (0.002) loss 0.8836 (0.7965) ce_loss 0.9346 (0.5630) teacher_loss 0.4919 (0.3429) loss_zs_kd 0.1893 (0.1678) loss_oracle 0.2971 (0.3697) acc 71.8750 (79.4792) kd_loss 0.8748 (0.8816) lr 5.1825e-04 eta 0:05:24
epoch [35/50] batch [200/203] time 0.104 (0.105) data 0.000 (0.001) loss 0.5905 (0.7924) ce_loss 0.3396 (0.5589) teacher_loss 0.2291 (0.3391) loss_zs_kd 0.1240 (0.1681) loss_oracle 0.2994 (0.3692) acc 93.7500 (79.7188) kd_loss 0.8963 (0.8830) lr 5.1825e-04 eta 0:05:19
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,343
* accuracy: 83.8%
* error: 16.2%
* macro_f1: 87.2%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [36/50] batch [20/203] time 0.079 (0.124) data 0.000 (0.014) loss 0.6332 (0.7875) ce_loss 0.3459 (0.5582) teacher_loss 0.1792 (0.3277) loss_zs_kd 0.1424 (0.1756) loss_oracle 0.3828 (0.3721) acc 87.5000 (80.3125) kd_loss 0.9481 (0.8932) lr 4.6417e-04 eta 0:06:16
epoch [36/50] batch [40/203] time 0.068 (0.113) data 0.000 (0.007) loss 0.5631 (0.7949) ce_loss 0.4683 (0.5544) teacher_loss 0.2446 (0.3379) loss_zs_kd 0.1585 (0.1740) loss_oracle 0.2393 (0.3701) acc 81.2500 (80.0000) kd_loss 0.9070 (0.8845) lr 4.6417e-04 eta 0:05:40
epoch [36/50] batch [60/203] time 0.111 (0.110) data 0.001 (0.005) loss 0.9984 (0.7921) ce_loss 0.8911 (0.5574) teacher_loss 0.6110 (0.3385) loss_zs_kd 0.1502 (0.1709) loss_oracle 0.3123 (0.3681) acc 65.6250 (79.8438) kd_loss 0.8438 (0.8870) lr 4.6417e-04 eta 0:05:28
epoch [36/50] batch [80/203] time 0.077 (0.108) data 0.000 (0.004) loss 0.9577 (0.7856) ce_loss 0.6157 (0.5447) teacher_loss 0.4315 (0.3287) loss_zs_kd 0.1710 (0.1687) loss_oracle 0.4407 (0.3725) acc 78.1250 (80.3516) kd_loss 0.8721 (0.8832) lr 4.6417e-04 eta 0:05:19
epoch [36/50] batch [100/203] time 0.129 (0.106) data 0.000 (0.003) loss 0.8969 (0.7762) ce_loss 0.7012 (0.5337) teacher_loss 0.5176 (0.3222) loss_zs_kd 0.1695 (0.1690) loss_oracle 0.2946 (0.3695) acc 71.8750 (80.7812) kd_loss 0.8635 (0.8830) lr 4.6417e-04 eta 0:05:13
epoch [36/50] batch [120/203] time 0.111 (0.106) data 0.000 (0.003) loss 0.8826 (0.7811) ce_loss 0.6816 (0.5406) teacher_loss 0.3876 (0.3264) loss_zs_kd 0.1667 (0.1701) loss_oracle 0.4117 (0.3696) acc 81.2500 (80.7031) kd_loss 0.8845 (0.8847) lr 4.6417e-04 eta 0:05:09
epoch [36/50] batch [140/203] time 0.094 (0.105) data 0.000 (0.002) loss 0.7829 (0.7821) ce_loss 0.6050 (0.5384) teacher_loss 0.3097 (0.3260) loss_zs_kd 0.1758 (0.1697) loss_oracle 0.3853 (0.3712) acc 62.5000 (80.8929) kd_loss 0.8997 (0.8842) lr 4.6417e-04 eta 0:05:04
epoch [36/50] batch [160/203] time 0.110 (0.105) data 0.000 (0.002) loss 0.6827 (0.7852) ce_loss 0.4707 (0.5379) teacher_loss 0.2034 (0.3264) loss_zs_kd 0.1697 (0.1694) loss_oracle 0.3944 (0.3740) acc 90.6250 (80.8203) kd_loss 0.8757 (0.8865) lr 4.6417e-04 eta 0:05:01
epoch [36/50] batch [180/203] time 0.124 (0.105) data 0.000 (0.002) loss 0.7448 (0.7830) ce_loss 0.5488 (0.5375) teacher_loss 0.3047 (0.3261) loss_zs_kd 0.1629 (0.1678) loss_oracle 0.3587 (0.3730) acc 84.3750 (80.8681) kd_loss 0.8479 (0.8848) lr 4.6417e-04 eta 0:05:00
epoch [36/50] batch [200/203] time 0.060 (0.107) data 0.000 (0.002) loss 0.9141 (0.7900) ce_loss 0.6133 (0.5422) teacher_loss 0.3586 (0.3299) loss_zs_kd 0.1852 (0.1681) loss_oracle 0.4630 (0.3761) acc 71.8750 (80.5781) kd_loss 0.9745 (0.8849) lr 4.6417e-04 eta 0:05:04
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,336
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 87.0%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [37/50] batch [20/203] time 0.084 (0.115) data 0.000 (0.012) loss 0.7280 (0.7921) ce_loss 0.5322 (0.4961) teacher_loss 0.3427 (0.3249) loss_zs_kd 0.1517 (0.1540) loss_oracle 0.3095 (0.3902) acc 81.2500 (82.0312) kd_loss 0.8866 (0.8864) lr 4.1221e-04 eta 0:05:23
epoch [37/50] batch [40/203] time 0.092 (0.112) data 0.000 (0.006) loss 1.2490 (0.8034) ce_loss 1.0547 (0.5267) teacher_loss 0.7761 (0.3350) loss_zs_kd 0.2071 (0.1627) loss_oracle 0.3693 (0.3871) acc 65.6250 (80.2344) kd_loss 0.9148 (0.8914) lr 4.1221e-04 eta 0:05:12
epoch [37/50] batch [60/203] time 0.077 (0.110) data 0.000 (0.004) loss 0.8990 (0.7995) ce_loss 0.5859 (0.5295) teacher_loss 0.4288 (0.3307) loss_zs_kd 0.1516 (0.1640) loss_oracle 0.3945 (0.3868) acc 75.0000 (80.3125) kd_loss 0.8765 (0.8894) lr 4.1221e-04 eta 0:05:06
epoch [37/50] batch [80/203] time 0.089 (0.109) data 0.000 (0.003) loss 0.7555 (0.8030) ce_loss 0.3574 (0.5339) teacher_loss 0.2357 (0.3283) loss_zs_kd 0.1497 (0.1663) loss_oracle 0.4449 (0.3916) acc 87.5000 (80.5469) kd_loss 0.8786 (0.8905) lr 4.1221e-04 eta 0:04:59
epoch [37/50] batch [100/203] time 0.106 (0.108) data 0.000 (0.003) loss 0.8168 (0.8106) ce_loss 0.6470 (0.5424) teacher_loss 0.3490 (0.3290) loss_zs_kd 0.1637 (0.1719) loss_oracle 0.3859 (0.3956) acc 75.0000 (79.7188) kd_loss 0.8604 (0.8901) lr 4.1221e-04 eta 0:04:54
epoch [37/50] batch [120/203] time 0.088 (0.106) data 0.000 (0.002) loss 0.7757 (0.8203) ce_loss 0.6245 (0.5484) teacher_loss 0.3424 (0.3374) loss_zs_kd 0.2028 (0.1720) loss_oracle 0.3319 (0.3969) acc 75.0000 (79.8698) kd_loss 0.8013 (0.8916) lr 4.1221e-04 eta 0:04:48
epoch [37/50] batch [140/203] time 0.086 (0.105) data 0.000 (0.002) loss 0.7170 (0.8190) ce_loss 0.4578 (0.5491) teacher_loss 0.2911 (0.3386) loss_zs_kd 0.1755 (0.1709) loss_oracle 0.3382 (0.3949) acc 87.5000 (79.9107) kd_loss 0.8951 (0.8894) lr 4.1221e-04 eta 0:04:42
epoch [37/50] batch [160/203] time 0.087 (0.105) data 0.000 (0.002) loss 0.9702 (0.8164) ce_loss 0.6265 (0.5507) teacher_loss 0.4596 (0.3379) loss_zs_kd 0.2294 (0.1724) loss_oracle 0.3959 (0.3922) acc 75.0000 (79.8242) kd_loss 0.9314 (0.8914) lr 4.1221e-04 eta 0:04:41
epoch [37/50] batch [180/203] time 0.081 (0.105) data 0.000 (0.002) loss 0.9483 (0.8257) ce_loss 0.6885 (0.5594) teacher_loss 0.3729 (0.3436) loss_zs_kd 0.2161 (0.1721) loss_oracle 0.4673 (0.3961) acc 75.0000 (79.7049) kd_loss 0.9508 (0.8922) lr 4.1221e-04 eta 0:04:38
epoch [37/50] batch [200/203] time 0.075 (0.103) data 0.000 (0.001) loss 0.8749 (0.8218) ce_loss 0.5645 (0.5536) teacher_loss 0.3635 (0.3374) loss_zs_kd 0.1946 (0.1732) loss_oracle 0.4142 (0.3978) acc 84.3750 (79.8906) kd_loss 0.9126 (0.8933) lr 4.1221e-04 eta 0:04:33
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,332
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [38/50] batch [20/203] time 0.070 (0.126) data 0.000 (0.017) loss 0.6955 (0.8053) ce_loss 0.4028 (0.5521) teacher_loss 0.2461 (0.3229) loss_zs_kd 0.1301 (0.1805) loss_oracle 0.3843 (0.3922) acc 81.2500 (78.7500) kd_loss 0.8773 (0.8890) lr 3.6258e-04 eta 0:05:28
epoch [38/50] batch [40/203] time 0.099 (0.116) data 0.000 (0.009) loss 0.9042 (0.7934) ce_loss 0.7085 (0.5355) teacher_loss 0.3806 (0.3126) loss_zs_kd 0.2074 (0.1800) loss_oracle 0.4199 (0.3908) acc 71.8750 (79.2969) kd_loss 0.8495 (0.8898) lr 3.6258e-04 eta 0:05:01
epoch [38/50] batch [60/203] time 0.098 (0.114) data 0.000 (0.006) loss 0.7207 (0.7930) ce_loss 0.3726 (0.5399) teacher_loss 0.1988 (0.3182) loss_zs_kd 0.1578 (0.1766) loss_oracle 0.4430 (0.3865) acc 78.1250 (79.4271) kd_loss 0.9658 (0.8912) lr 3.6258e-04 eta 0:04:54
epoch [38/50] batch [80/203] time 0.082 (0.113) data 0.000 (0.004) loss 0.7646 (0.7996) ce_loss 0.4878 (0.5485) teacher_loss 0.2931 (0.3264) loss_zs_kd 0.1548 (0.1739) loss_oracle 0.3941 (0.3863) acc 87.5000 (79.6484) kd_loss 0.8906 (0.8894) lr 3.6258e-04 eta 0:04:49
epoch [38/50] batch [100/203] time 0.123 (0.113) data 0.000 (0.004) loss 0.9606 (0.8029) ce_loss 0.8770 (0.5540) teacher_loss 0.5577 (0.3271) loss_zs_kd 0.1330 (0.1735) loss_oracle 0.3365 (0.3891) acc 59.3750 (79.3125) kd_loss 0.8937 (0.8914) lr 3.6258e-04 eta 0:04:47
epoch [38/50] batch [120/203] time 0.133 (0.113) data 0.000 (0.003) loss 0.9185 (0.8050) ce_loss 0.6260 (0.5511) teacher_loss 0.4287 (0.3252) loss_zs_kd 0.1692 (0.1737) loss_oracle 0.4052 (0.3930) acc 75.0000 (79.4531) kd_loss 0.8573 (0.8905) lr 3.6258e-04 eta 0:04:43
epoch [38/50] batch [140/203] time 0.079 (0.110) data 0.000 (0.003) loss 0.9578 (0.8023) ce_loss 0.4578 (0.5402) teacher_loss 0.3638 (0.3208) loss_zs_kd 0.1621 (0.1727) loss_oracle 0.5130 (0.3951) acc 81.2500 (80.0446) kd_loss 0.9302 (0.8910) lr 3.6258e-04 eta 0:04:35
epoch [38/50] batch [160/203] time 0.141 (0.115) data 0.000 (0.002) loss 0.8647 (0.8102) ce_loss 0.5508 (0.5458) teacher_loss 0.3560 (0.3262) loss_zs_kd 0.1211 (0.1730) loss_oracle 0.4481 (0.3975) acc 81.2500 (79.8828) kd_loss 0.9128 (0.8909) lr 3.6258e-04 eta 0:04:44
epoch [38/50] batch [180/203] time 0.124 (0.115) data 0.000 (0.002) loss 0.5990 (0.8072) ce_loss 0.4058 (0.5448) teacher_loss 0.1970 (0.3257) loss_zs_kd 0.1320 (0.1722) loss_oracle 0.3360 (0.3954) acc 81.2500 (79.9653) kd_loss 0.8536 (0.8899) lr 3.6258e-04 eta 0:04:42
epoch [38/50] batch [200/203] time 0.107 (0.116) data 0.000 (0.002) loss 0.8174 (0.8095) ce_loss 0.5024 (0.5456) teacher_loss 0.3181 (0.3270) loss_zs_kd 0.1945 (0.1718) loss_oracle 0.4020 (0.3965) acc 81.2500 (80.0000) kd_loss 0.9100 (0.8899) lr 3.6258e-04 eta 0:04:41
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,335
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [39/50] batch [20/203] time 0.106 (0.130) data 0.000 (0.016) loss 0.6817 (0.8155) ce_loss 0.3875 (0.5457) teacher_loss 0.1608 (0.3441) loss_zs_kd 0.1662 (0.1650) loss_oracle 0.4378 (0.3889) acc 84.3750 (79.2188) kd_loss 0.9271 (0.8879) lr 3.1545e-04 eta 0:05:13
epoch [39/50] batch [40/203] time 0.098 (0.116) data 0.000 (0.008) loss 0.6579 (0.8073) ce_loss 0.3567 (0.5348) teacher_loss 0.1841 (0.3301) loss_zs_kd 0.1536 (0.1672) loss_oracle 0.3971 (0.3935) acc 90.6250 (80.5469) kd_loss 0.8656 (0.8923) lr 3.1545e-04 eta 0:04:38
epoch [39/50] batch [60/203] time 0.079 (0.112) data 0.000 (0.005) loss 0.5858 (0.8098) ce_loss 0.2032 (0.5387) teacher_loss 0.0963 (0.3297) loss_zs_kd 0.1433 (0.1676) loss_oracle 0.4178 (0.3963) acc 96.8750 (80.7292) kd_loss 0.9403 (0.8901) lr 3.1545e-04 eta 0:04:25
epoch [39/50] batch [80/203] time 0.119 (0.109) data 0.000 (0.004) loss 0.8029 (0.8075) ce_loss 0.5093 (0.5319) teacher_loss 0.3744 (0.3264) loss_zs_kd 0.1572 (0.1701) loss_oracle 0.3499 (0.3960) acc 81.2500 (80.9375) kd_loss 0.8752 (0.8882) lr 3.1545e-04 eta 0:04:16
epoch [39/50] batch [100/203] time 0.085 (0.107) data 0.000 (0.003) loss 0.6754 (0.8034) ce_loss 0.5220 (0.5258) teacher_loss 0.2461 (0.3222) loss_zs_kd 0.1693 (0.1693) loss_oracle 0.3446 (0.3965) acc 78.1250 (80.8125) kd_loss 0.9370 (0.8887) lr 3.1545e-04 eta 0:04:11
epoch [39/50] batch [120/203] time 0.106 (0.107) data 0.000 (0.003) loss 1.0891 (0.8078) ce_loss 0.8638 (0.5289) teacher_loss 0.6959 (0.3255) loss_zs_kd 0.1713 (0.1696) loss_oracle 0.3076 (0.3975) acc 68.7500 (80.7552) kd_loss 0.8676 (0.8893) lr 3.1545e-04 eta 0:04:08
epoch [39/50] batch [140/203] time 0.121 (0.107) data 0.000 (0.002) loss 0.9229 (0.8077) ce_loss 0.5620 (0.5311) teacher_loss 0.3974 (0.3248) loss_zs_kd 0.2040 (0.1694) loss_oracle 0.4235 (0.3982) acc 78.1250 (80.7589) kd_loss 0.8757 (0.8899) lr 3.1545e-04 eta 0:04:05
epoch [39/50] batch [160/203] time 0.129 (0.107) data 0.000 (0.002) loss 0.6771 (0.8117) ce_loss 0.5811 (0.5408) teacher_loss 0.2757 (0.3283) loss_zs_kd 0.1800 (0.1715) loss_oracle 0.3115 (0.3976) acc 78.1250 (80.4102) kd_loss 0.8922 (0.8893) lr 3.1545e-04 eta 0:04:04
epoch [39/50] batch [180/203] time 0.111 (0.107) data 0.000 (0.002) loss 0.8180 (0.8121) ce_loss 0.6484 (0.5424) teacher_loss 0.3959 (0.3291) loss_zs_kd 0.1709 (0.1727) loss_oracle 0.3366 (0.3967) acc 71.8750 (80.3299) kd_loss 0.8958 (0.8891) lr 3.1545e-04 eta 0:04:02
epoch [39/50] batch [200/203] time 0.094 (0.107) data 0.001 (0.002) loss 0.8966 (0.8123) ce_loss 0.5156 (0.5420) teacher_loss 0.3534 (0.3284) loss_zs_kd 0.1810 (0.1721) loss_oracle 0.4527 (0.3978) acc 78.1250 (80.3125) kd_loss 0.9159 (0.8902) lr 3.1545e-04 eta 0:03:58
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,333
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [40/50] batch [20/203] time 0.079 (0.108) data 0.000 (0.012) loss 0.8738 (0.8258) ce_loss 0.6318 (0.5551) teacher_loss 0.3110 (0.3253) loss_zs_kd 0.1925 (0.1786) loss_oracle 0.4665 (0.4111) acc 81.2500 (80.6250) kd_loss 0.9475 (0.8928) lr 2.7103e-04 eta 0:03:58
epoch [40/50] batch [40/203] time 0.082 (0.101) data 0.000 (0.006) loss 0.8020 (0.8221) ce_loss 0.5879 (0.5351) teacher_loss 0.4142 (0.3265) loss_zs_kd 0.1327 (0.1696) loss_oracle 0.3214 (0.4108) acc 75.0000 (81.2500) kd_loss 0.9128 (0.8948) lr 2.7103e-04 eta 0:03:42
epoch [40/50] batch [60/203] time 0.097 (0.101) data 0.000 (0.004) loss 0.9331 (0.8324) ce_loss 0.5620 (0.5433) teacher_loss 0.4481 (0.3320) loss_zs_kd 0.1589 (0.1700) loss_oracle 0.4056 (0.4153) acc 78.1250 (80.6250) kd_loss 0.9197 (0.8996) lr 2.7103e-04 eta 0:03:38
epoch [40/50] batch [80/203] time 0.131 (0.100) data 0.000 (0.003) loss 0.8227 (0.8200) ce_loss 0.5430 (0.5347) teacher_loss 0.3957 (0.3281) loss_zs_kd 0.1448 (0.1694) loss_oracle 0.3546 (0.4072) acc 75.0000 (80.8203) kd_loss 0.8403 (0.8932) lr 2.7103e-04 eta 0:03:36
epoch [40/50] batch [100/203] time 0.073 (0.101) data 0.000 (0.003) loss 0.7454 (0.8175) ce_loss 0.4822 (0.5363) teacher_loss 0.1892 (0.3279) loss_zs_kd 0.2010 (0.1668) loss_oracle 0.4557 (0.4062) acc 84.3750 (80.8125) kd_loss 0.8833 (0.8931) lr 2.7103e-04 eta 0:03:35
epoch [40/50] batch [120/203] time 0.111 (0.102) data 0.000 (0.002) loss 0.7844 (0.8104) ce_loss 0.4729 (0.5350) teacher_loss 0.2676 (0.3215) loss_zs_kd 0.1610 (0.1687) loss_oracle 0.4363 (0.4045) acc 75.0000 (80.7812) kd_loss 0.9416 (0.8943) lr 2.7103e-04 eta 0:03:36
epoch [40/50] batch [140/203] time 0.162 (0.104) data 0.000 (0.002) loss 0.8141 (0.8047) ce_loss 0.5039 (0.5307) teacher_loss 0.3010 (0.3195) loss_zs_kd 0.1623 (0.1679) loss_oracle 0.4320 (0.4013) acc 71.8750 (80.8036) kd_loss 0.9052 (0.8947) lr 2.7103e-04 eta 0:03:36
epoch [40/50] batch [160/203] time 0.162 (0.107) data 0.000 (0.002) loss 1.0706 (0.8049) ce_loss 0.6367 (0.5329) teacher_loss 0.5412 (0.3215) loss_zs_kd 0.1366 (0.1678) loss_oracle 0.4611 (0.3995) acc 81.2500 (80.8984) kd_loss 0.8782 (0.8934) lr 2.7103e-04 eta 0:03:40
epoch [40/50] batch [180/203] time 0.124 (0.112) data 0.000 (0.002) loss 0.8709 (0.8041) ce_loss 0.5571 (0.5359) teacher_loss 0.3653 (0.3215) loss_zs_kd 0.2285 (0.1689) loss_oracle 0.3914 (0.3981) acc 81.2500 (80.6944) kd_loss 0.9262 (0.8948) lr 2.7103e-04 eta 0:03:50
epoch [40/50] batch [200/203] time 0.070 (0.112) data 0.000 (0.001) loss 0.8108 (0.8115) ce_loss 0.4111 (0.5408) teacher_loss 0.2865 (0.3275) loss_zs_kd 0.1766 (0.1696) loss_oracle 0.4360 (0.3992) acc 93.7500 (80.6875) kd_loss 0.9196 (0.8951) lr 2.7103e-04 eta 0:03:46
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,330
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 86.8%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [41/50] batch [20/203] time 0.114 (0.132) data 0.000 (0.015) loss 0.7968 (0.8054) ce_loss 0.5542 (0.5139) teacher_loss 0.2955 (0.3076) loss_zs_kd 0.1643 (0.1697) loss_oracle 0.4192 (0.4130) acc 71.8750 (81.7188) kd_loss 0.9653 (0.9069) lr 2.2949e-04 eta 0:04:24
epoch [41/50] batch [40/203] time 0.121 (0.124) data 0.000 (0.008) loss 0.6896 (0.7982) ce_loss 0.3513 (0.5205) teacher_loss 0.1473 (0.3033) loss_zs_kd 0.1637 (0.1695) loss_oracle 0.4604 (0.4101) acc 84.3750 (80.5469) kd_loss 0.9033 (0.8966) lr 2.2949e-04 eta 0:04:06
epoch [41/50] batch [60/203] time 0.134 (0.119) data 0.001 (0.005) loss 0.9308 (0.7937) ce_loss 0.6943 (0.5265) teacher_loss 0.4742 (0.3097) loss_zs_kd 0.1865 (0.1716) loss_oracle 0.3633 (0.3982) acc 81.2500 (80.7812) kd_loss 0.8331 (0.8953) lr 2.2949e-04 eta 0:03:54
epoch [41/50] batch [80/203] time 0.085 (0.115) data 0.000 (0.004) loss 0.7111 (0.7933) ce_loss 0.4036 (0.5286) teacher_loss 0.1903 (0.3077) loss_zs_kd 0.1635 (0.1728) loss_oracle 0.4391 (0.3992) acc 78.1250 (80.3516) kd_loss 0.8825 (0.8931) lr 2.2949e-04 eta 0:03:44
epoch [41/50] batch [100/203] time 0.143 (0.113) data 0.000 (0.003) loss 0.6832 (0.8046) ce_loss 0.3667 (0.5320) teacher_loss 0.2039 (0.3164) loss_zs_kd 0.1475 (0.1720) loss_oracle 0.4055 (0.4023) acc 87.5000 (79.9375) kd_loss 0.8713 (0.8923) lr 2.2949e-04 eta 0:03:37
epoch [41/50] batch [120/203] time 0.139 (0.113) data 0.000 (0.003) loss 0.6761 (0.8119) ce_loss 0.4851 (0.5352) teacher_loss 0.2852 (0.3202) loss_zs_kd 0.1421 (0.1731) loss_oracle 0.3199 (0.4051) acc 81.2500 (79.9219) kd_loss 0.8418 (0.8945) lr 2.2949e-04 eta 0:03:36
epoch [41/50] batch [140/203] time 0.138 (0.113) data 0.000 (0.002) loss 0.7907 (0.8018) ce_loss 0.5107 (0.5301) teacher_loss 0.3130 (0.3144) loss_zs_kd 0.1797 (0.1729) loss_oracle 0.3878 (0.4010) acc 84.3750 (80.3795) kd_loss 0.8717 (0.8958) lr 2.2949e-04 eta 0:03:34
epoch [41/50] batch [160/203] time 0.094 (0.113) data 0.000 (0.002) loss 0.8964 (0.8038) ce_loss 0.6079 (0.5345) teacher_loss 0.3836 (0.3170) loss_zs_kd 0.2231 (0.1741) loss_oracle 0.4012 (0.3997) acc 84.3750 (80.2734) kd_loss 0.7988 (0.8948) lr 2.2949e-04 eta 0:03:31
epoch [41/50] batch [180/203] time 0.100 (0.113) data 0.000 (0.002) loss 0.7826 (0.8022) ce_loss 0.4453 (0.5343) teacher_loss 0.2630 (0.3170) loss_zs_kd 0.1687 (0.1741) loss_oracle 0.4352 (0.3982) acc 84.3750 (80.3125) kd_loss 0.9448 (0.8958) lr 2.2949e-04 eta 0:03:29
epoch [41/50] batch [200/203] time 0.097 (0.112) data 0.000 (0.002) loss 0.7154 (0.8065) ce_loss 0.6294 (0.5391) teacher_loss 0.3324 (0.3224) loss_zs_kd 0.1800 (0.1734) loss_oracle 0.2931 (0.3974) acc 81.2500 (80.2500) kd_loss 0.8562 (0.8951) lr 2.2949e-04 eta 0:03:25
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,335
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [42/50] batch [20/203] time 0.134 (0.134) data 0.000 (0.016) loss 0.8577 (0.7808) ce_loss 0.6079 (0.5136) teacher_loss 0.3267 (0.2925) loss_zs_kd 0.1744 (0.1827) loss_oracle 0.4438 (0.3970) acc 78.1250 (81.2500) kd_loss 0.8744 (0.8977) lr 1.9098e-04 eta 0:04:01
epoch [42/50] batch [40/203] time 0.130 (0.124) data 0.000 (0.008) loss 0.7295 (0.8144) ce_loss 0.4373 (0.5560) teacher_loss 0.2972 (0.3260) loss_zs_kd 0.1534 (0.1811) loss_oracle 0.3557 (0.3979) acc 87.5000 (79.2969) kd_loss 0.7914 (0.9013) lr 1.9098e-04 eta 0:03:41
epoch [42/50] batch [60/203] time 0.139 (0.118) data 0.001 (0.005) loss 0.5312 (0.8018) ce_loss 0.2771 (0.5412) teacher_loss 0.1630 (0.3167) loss_zs_kd 0.1121 (0.1752) loss_oracle 0.3121 (0.3976) acc 93.7500 (80.4167) kd_loss 0.8994 (0.9011) lr 1.9098e-04 eta 0:03:28
epoch [42/50] batch [80/203] time 0.150 (0.120) data 0.000 (0.004) loss 0.7958 (0.7965) ce_loss 0.5586 (0.5345) teacher_loss 0.4276 (0.3149) loss_zs_kd 0.1268 (0.1745) loss_oracle 0.3048 (0.3942) acc 78.1250 (80.7422) kd_loss 0.9100 (0.8990) lr 1.9098e-04 eta 0:03:29
epoch [42/50] batch [100/203] time 0.131 (0.120) data 0.000 (0.003) loss 0.9060 (0.8012) ce_loss 0.6484 (0.5382) teacher_loss 0.4195 (0.3168) loss_zs_kd 0.1638 (0.1732) loss_oracle 0.4046 (0.3979) acc 65.6250 (80.7500) kd_loss 0.9020 (0.8999) lr 1.9098e-04 eta 0:03:27
epoch [42/50] batch [120/203] time 0.126 (0.127) data 0.000 (0.003) loss 0.7142 (0.7970) ce_loss 0.5972 (0.5385) teacher_loss 0.3140 (0.3132) loss_zs_kd 0.1868 (0.1734) loss_oracle 0.3068 (0.3971) acc 75.0000 (80.7292) kd_loss 0.8733 (0.8976) lr 1.9098e-04 eta 0:03:36
epoch [42/50] batch [140/203] time 0.128 (0.124) data 0.000 (0.002) loss 0.9586 (0.7987) ce_loss 0.6675 (0.5441) teacher_loss 0.5550 (0.3164) loss_zs_kd 0.1660 (0.1740) loss_oracle 0.3206 (0.3953) acc 81.2500 (80.3571) kd_loss 0.9084 (0.8973) lr 1.9098e-04 eta 0:03:29
epoch [42/50] batch [160/203] time 0.116 (0.122) data 0.000 (0.002) loss 0.7073 (0.8014) ce_loss 0.4583 (0.5444) teacher_loss 0.2985 (0.3181) loss_zs_kd 0.1682 (0.1748) loss_oracle 0.3247 (0.3959) acc 81.2500 (80.3711) kd_loss 0.9460 (0.8992) lr 1.9098e-04 eta 0:03:23
epoch [42/50] batch [180/203] time 0.092 (0.120) data 0.000 (0.002) loss 1.0014 (0.8030) ce_loss 0.8638 (0.5449) teacher_loss 0.4376 (0.3193) loss_zs_kd 0.2430 (0.1746) loss_oracle 0.4423 (0.3964) acc 65.6250 (80.5208) kd_loss 0.8814 (0.8966) lr 1.9098e-04 eta 0:03:18
epoch [42/50] batch [200/203] time 0.079 (0.118) data 0.000 (0.002) loss 0.9157 (0.8037) ce_loss 0.6392 (0.5460) teacher_loss 0.4657 (0.3220) loss_zs_kd 0.1589 (0.1742) loss_oracle 0.3706 (0.3946) acc 78.1250 (80.5156) kd_loss 0.9260 (0.8969) lr 1.9098e-04 eta 0:03:12
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,336
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 87.0%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [43/50] batch [20/203] time 0.091 (0.128) data 0.000 (0.017) loss 0.8491 (0.8900) ce_loss 0.5869 (0.6192) teacher_loss 0.4092 (0.3971) loss_zs_kd 0.1670 (0.1646) loss_oracle 0.3564 (0.4107) acc 81.2500 (77.8125) kd_loss 0.8270 (0.9036) lr 1.5567e-04 eta 0:03:25
epoch [43/50] batch [40/203] time 0.071 (0.111) data 0.000 (0.009) loss 0.7198 (0.8598) ce_loss 0.3479 (0.5794) teacher_loss 0.1803 (0.3744) loss_zs_kd 0.1404 (0.1618) loss_oracle 0.4693 (0.4045) acc 87.5000 (80.3125) kd_loss 0.8542 (0.8949) lr 1.5567e-04 eta 0:02:55
epoch [43/50] batch [60/203] time 0.073 (0.106) data 0.000 (0.006) loss 0.7508 (0.8472) ce_loss 0.4216 (0.5700) teacher_loss 0.2277 (0.3623) loss_zs_kd 0.1686 (0.1633) loss_oracle 0.4388 (0.4032) acc 90.6250 (80.5208) kd_loss 0.9260 (0.8907) lr 1.5567e-04 eta 0:02:45
epoch [43/50] batch [80/203] time 0.077 (0.104) data 0.000 (0.004) loss 0.6623 (0.8341) ce_loss 0.3184 (0.5545) teacher_loss 0.1926 (0.3497) loss_zs_kd 0.1416 (0.1629) loss_oracle 0.3989 (0.4030) acc 90.6250 (80.7031) kd_loss 0.9286 (0.8933) lr 1.5567e-04 eta 0:02:39
epoch [43/50] batch [100/203] time 0.084 (0.103) data 0.000 (0.004) loss 0.7763 (0.8328) ce_loss 0.4883 (0.5587) teacher_loss 0.2749 (0.3498) loss_zs_kd 0.1847 (0.1649) loss_oracle 0.4090 (0.4005) acc 84.3750 (80.4062) kd_loss 0.8732 (0.8951) lr 1.5567e-04 eta 0:02:36
epoch [43/50] batch [120/203] time 0.123 (0.103) data 0.000 (0.003) loss 0.7444 (0.8268) ce_loss 0.3250 (0.5500) teacher_loss 0.1770 (0.3402) loss_zs_kd 0.1312 (0.1660) loss_oracle 0.5018 (0.4036) acc 87.5000 (80.7812) kd_loss 0.9166 (0.8960) lr 1.5567e-04 eta 0:02:34
epoch [43/50] batch [140/203] time 0.089 (0.102) data 0.000 (0.003) loss 0.8537 (0.8311) ce_loss 0.6523 (0.5615) teacher_loss 0.4192 (0.3443) loss_zs_kd 0.1753 (0.1661) loss_oracle 0.3469 (0.4038) acc 78.1250 (80.3571) kd_loss 0.9148 (0.8964) lr 1.5567e-04 eta 0:02:31
epoch [43/50] batch [160/203] time 0.097 (0.102) data 0.000 (0.002) loss 0.7188 (0.8317) ce_loss 0.4084 (0.5617) teacher_loss 0.2576 (0.3429) loss_zs_kd 0.1533 (0.1684) loss_oracle 0.3845 (0.4047) acc 93.7500 (80.1953) kd_loss 0.8730 (0.8952) lr 1.5567e-04 eta 0:02:28
epoch [43/50] batch [180/203] time 0.075 (0.101) data 0.000 (0.002) loss 0.7589 (0.8258) ce_loss 0.5332 (0.5596) teacher_loss 0.2940 (0.3391) loss_zs_kd 0.1798 (0.1689) loss_oracle 0.3750 (0.4022) acc 81.2500 (80.0000) kd_loss 0.9210 (0.8962) lr 1.5567e-04 eta 0:02:26
epoch [43/50] batch [200/203] time 0.093 (0.101) data 0.000 (0.002) loss 0.8291 (0.8271) ce_loss 0.5122 (0.5612) teacher_loss 0.3103 (0.3411) loss_zs_kd 0.1655 (0.1697) loss_oracle 0.4361 (0.4011) acc 78.1250 (79.8125) kd_loss 0.9088 (0.8950) lr 1.5567e-04 eta 0:02:23
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,337
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 87.0%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [44/50] batch [20/203] time 0.139 (0.120) data 0.000 (0.017) loss 0.7898 (0.8035) ce_loss 0.6748 (0.5425) teacher_loss 0.3319 (0.3216) loss_zs_kd 0.2479 (0.1707) loss_oracle 0.3340 (0.3965) acc 75.0000 (81.4062) kd_loss 0.8938 (0.8772) lr 1.2369e-04 eta 0:02:47
epoch [44/50] batch [40/203] time 0.076 (0.106) data 0.000 (0.008) loss 0.7021 (0.8126) ce_loss 0.3591 (0.5374) teacher_loss 0.2056 (0.3203) loss_zs_kd 0.1965 (0.1750) loss_oracle 0.3983 (0.4048) acc 90.6250 (81.4062) kd_loss 0.8630 (0.8857) lr 1.2369e-04 eta 0:02:26
epoch [44/50] batch [60/203] time 0.159 (0.115) data 0.000 (0.006) loss 0.6732 (0.8092) ce_loss 0.4109 (0.5297) teacher_loss 0.2718 (0.3187) loss_zs_kd 0.1206 (0.1730) loss_oracle 0.3411 (0.4040) acc 87.5000 (81.6667) kd_loss 0.9157 (0.8920) lr 1.2369e-04 eta 0:02:36
epoch [44/50] batch [80/203] time 0.147 (0.112) data 0.000 (0.004) loss 0.6960 (0.8204) ce_loss 0.3818 (0.5353) teacher_loss 0.1930 (0.3295) loss_zs_kd 0.1686 (0.1717) loss_oracle 0.4187 (0.4051) acc 87.5000 (81.2891) kd_loss 0.9730 (0.8921) lr 1.2369e-04 eta 0:02:29
epoch [44/50] batch [100/203] time 0.123 (0.119) data 0.000 (0.003) loss 0.7714 (0.8248) ce_loss 0.4775 (0.5390) teacher_loss 0.2695 (0.3367) loss_zs_kd 0.1456 (0.1680) loss_oracle 0.4291 (0.4041) acc 90.6250 (80.9688) kd_loss 0.9153 (0.8916) lr 1.2369e-04 eta 0:02:36
epoch [44/50] batch [120/203] time 0.133 (0.117) data 0.000 (0.003) loss 0.7377 (0.8239) ce_loss 0.3428 (0.5377) teacher_loss 0.2102 (0.3358) loss_zs_kd 0.1616 (0.1678) loss_oracle 0.4467 (0.4042) acc 87.5000 (80.7552) kd_loss 0.9600 (0.8937) lr 1.2369e-04 eta 0:02:31
epoch [44/50] batch [140/203] time 0.109 (0.114) data 0.000 (0.003) loss 0.8137 (0.8280) ce_loss 0.5244 (0.5450) teacher_loss 0.3371 (0.3388) loss_zs_kd 0.1681 (0.1686) loss_oracle 0.3926 (0.4049) acc 84.3750 (80.4018) kd_loss 0.9407 (0.8941) lr 1.2369e-04 eta 0:02:25
epoch [44/50] batch [160/203] time 0.129 (0.112) data 0.000 (0.002) loss 0.7159 (0.8254) ce_loss 0.3049 (0.5372) teacher_loss 0.2201 (0.3339) loss_zs_kd 0.1365 (0.1686) loss_oracle 0.4276 (0.4072) acc 93.7500 (80.7422) kd_loss 0.8485 (0.8947) lr 1.2369e-04 eta 0:02:20
epoch [44/50] batch [180/203] time 0.089 (0.110) data 0.000 (0.002) loss 1.0726 (0.8274) ce_loss 0.7163 (0.5407) teacher_loss 0.5790 (0.3350) loss_zs_kd 0.1836 (0.1688) loss_oracle 0.4018 (0.4080) acc 78.1250 (80.5208) kd_loss 0.9187 (0.8936) lr 1.2369e-04 eta 0:02:17
epoch [44/50] batch [200/203] time 0.069 (0.108) data 0.000 (0.002) loss 0.9560 (0.8275) ce_loss 0.6191 (0.5428) teacher_loss 0.3926 (0.3354) loss_zs_kd 0.1910 (0.1699) loss_oracle 0.4679 (0.4072) acc 78.1250 (80.2344) kd_loss 0.9323 (0.8938) lr 1.2369e-04 eta 0:02:12
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,336
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [45/50] batch [20/203] time 0.099 (0.123) data 0.000 (0.015) loss 0.6721 (0.7940) ce_loss 0.2720 (0.4861) teacher_loss 0.1092 (0.2976) loss_zs_kd 0.1523 (0.1710) loss_oracle 0.4868 (0.4108) acc 96.8750 (81.2500) kd_loss 0.8930 (0.8821) lr 9.5173e-05 eta 0:02:27
epoch [45/50] batch [40/203] time 0.096 (0.113) data 0.000 (0.008) loss 1.0004 (0.8107) ce_loss 0.7363 (0.5222) teacher_loss 0.5594 (0.3264) loss_zs_kd 0.1865 (0.1637) loss_oracle 0.3477 (0.4025) acc 71.8750 (80.7812) kd_loss 0.9158 (0.8858) lr 9.5173e-05 eta 0:02:13
epoch [45/50] batch [60/203] time 0.100 (0.112) data 0.000 (0.005) loss 0.7177 (0.8185) ce_loss 0.4680 (0.5295) teacher_loss 0.1821 (0.3306) loss_zs_kd 0.1989 (0.1643) loss_oracle 0.4361 (0.4057) acc 87.5000 (80.6771) kd_loss 0.9024 (0.8840) lr 9.5173e-05 eta 0:02:09
epoch [45/50] batch [80/203] time 0.073 (0.110) data 0.000 (0.004) loss 0.8626 (0.8220) ce_loss 0.4861 (0.5389) teacher_loss 0.3811 (0.3384) loss_zs_kd 0.1622 (0.1656) loss_oracle 0.4004 (0.4008) acc 84.3750 (80.1562) kd_loss 0.9236 (0.8805) lr 9.5173e-05 eta 0:02:05
epoch [45/50] batch [100/203] time 0.108 (0.110) data 0.000 (0.003) loss 1.1469 (0.8225) ce_loss 0.9160 (0.5442) teacher_loss 0.5109 (0.3356) loss_zs_kd 0.1959 (0.1659) loss_oracle 0.5380 (0.4040) acc 65.6250 (79.8125) kd_loss 1.0143 (0.8845) lr 9.5173e-05 eta 0:02:02
epoch [45/50] batch [120/203] time 0.132 (0.109) data 0.000 (0.003) loss 0.6544 (0.8195) ce_loss 0.2006 (0.5385) teacher_loss 0.0979 (0.3313) loss_zs_kd 0.1874 (0.1665) loss_oracle 0.4629 (0.4049) acc 100.0000 (79.8698) kd_loss 0.8977 (0.8835) lr 9.5173e-05 eta 0:01:59
epoch [45/50] batch [140/203] time 0.093 (0.109) data 0.000 (0.002) loss 0.8009 (0.8146) ce_loss 0.6045 (0.5416) teacher_loss 0.3594 (0.3297) loss_zs_kd 0.1587 (0.1663) loss_oracle 0.3622 (0.4017) acc 78.1250 (79.8661) kd_loss 0.8785 (0.8847) lr 9.5173e-05 eta 0:01:57
epoch [45/50] batch [160/203] time 0.118 (0.109) data 0.000 (0.002) loss 0.9959 (0.8168) ce_loss 0.8081 (0.5429) teacher_loss 0.5500 (0.3313) loss_zs_kd 0.1437 (0.1659) loss_oracle 0.3741 (0.4026) acc 75.0000 (80.1172) kd_loss 0.8677 (0.8865) lr 9.5173e-05 eta 0:01:55
epoch [45/50] batch [180/203] time 0.102 (0.109) data 0.000 (0.002) loss 0.8401 (0.8151) ce_loss 0.4646 (0.5427) teacher_loss 0.2702 (0.3307) loss_zs_kd 0.1725 (0.1661) loss_oracle 0.4836 (0.4013) acc 84.3750 (79.9653) kd_loss 0.8305 (0.8867) lr 9.5173e-05 eta 0:01:53
epoch [45/50] batch [200/203] time 0.079 (0.108) data 0.000 (0.002) loss 1.0980 (0.8178) ce_loss 0.8457 (0.5477) teacher_loss 0.6866 (0.3335) loss_zs_kd 0.1781 (0.1676) loss_oracle 0.3224 (0.4006) acc 62.5000 (79.6250) kd_loss 0.8626 (0.8881) lr 9.5173e-05 eta 0:01:49
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,339
* accuracy: 83.7%
* error: 16.3%
* macro_f1: 87.0%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [46/50] batch [20/203] time 0.127 (0.126) data 0.001 (0.016) loss 0.6712 (0.7857) ce_loss 0.2935 (0.5314) teacher_loss 0.1552 (0.2994) loss_zs_kd 0.1928 (0.1812) loss_oracle 0.4196 (0.3956) acc 93.7500 (81.7188) kd_loss 0.8247 (0.8990) lr 7.0224e-05 eta 0:02:05
epoch [46/50] batch [40/203] time 0.078 (0.126) data 0.000 (0.008) loss 0.6850 (0.8001) ce_loss 0.6499 (0.5500) teacher_loss 0.2832 (0.3209) loss_zs_kd 0.1935 (0.1780) loss_oracle 0.3050 (0.3902) acc 71.8750 (80.7812) kd_loss 0.8172 (0.8899) lr 7.0224e-05 eta 0:02:03
epoch [46/50] batch [60/203] time 0.185 (0.132) data 0.001 (0.005) loss 0.9428 (0.7998) ce_loss 0.7944 (0.5437) teacher_loss 0.4359 (0.3197) loss_zs_kd 0.2139 (0.1755) loss_oracle 0.3999 (0.3924) acc 78.1250 (80.8854) kd_loss 0.8866 (0.8899) lr 7.0224e-05 eta 0:02:06
epoch [46/50] batch [80/203] time 0.110 (0.130) data 0.000 (0.004) loss 0.6454 (0.7989) ce_loss 0.3433 (0.5351) teacher_loss 0.1740 (0.3190) loss_zs_kd 0.1578 (0.1738) loss_oracle 0.3924 (0.3930) acc 87.5000 (81.0547) kd_loss 0.8811 (0.8900) lr 7.0224e-05 eta 0:02:01
epoch [46/50] batch [100/203] time 0.139 (0.127) data 0.001 (0.003) loss 0.6509 (0.7954) ce_loss 0.4912 (0.5300) teacher_loss 0.1995 (0.3167) loss_zs_kd 0.1747 (0.1729) loss_oracle 0.3641 (0.3922) acc 78.1250 (81.2500) kd_loss 0.8752 (0.8873) lr 7.0224e-05 eta 0:01:56
epoch [46/50] batch [120/203] time 0.076 (0.124) data 0.000 (0.003) loss 0.7807 (0.7993) ce_loss 0.5254 (0.5337) teacher_loss 0.2967 (0.3188) loss_zs_kd 0.1353 (0.1747) loss_oracle 0.4163 (0.3932) acc 81.2500 (81.3021) kd_loss 0.9337 (0.8898) lr 7.0224e-05 eta 0:01:51
epoch [46/50] batch [140/203] time 0.128 (0.123) data 0.000 (0.003) loss 0.8974 (0.8032) ce_loss 0.7974 (0.5359) teacher_loss 0.5131 (0.3215) loss_zs_kd 0.1710 (0.1736) loss_oracle 0.2989 (0.3950) acc 59.3750 (81.1607) kd_loss 0.8699 (0.8906) lr 7.0224e-05 eta 0:01:47
epoch [46/50] batch [160/203] time 0.074 (0.122) data 0.000 (0.002) loss 0.6415 (0.8037) ce_loss 0.3232 (0.5326) teacher_loss 0.1271 (0.3195) loss_zs_kd 0.1836 (0.1729) loss_oracle 0.4226 (0.3978) acc 90.6250 (81.2891) kd_loss 0.9527 (0.8902) lr 7.0224e-05 eta 0:01:43
epoch [46/50] batch [180/203] time 0.098 (0.121) data 0.000 (0.002) loss 0.8324 (0.8061) ce_loss 0.6270 (0.5358) teacher_loss 0.3851 (0.3217) loss_zs_kd 0.1445 (0.1724) loss_oracle 0.3751 (0.3981) acc 87.5000 (81.1285) kd_loss 0.9289 (0.8907) lr 7.0224e-05 eta 0:01:40
epoch [46/50] batch [200/203] time 0.083 (0.119) data 0.001 (0.002) loss 0.8521 (0.8103) ce_loss 0.5444 (0.5380) teacher_loss 0.3341 (0.3225) loss_zs_kd 0.2020 (0.1729) loss_oracle 0.4170 (0.4013) acc 81.2500 (80.9688) kd_loss 0.9465 (0.8923) lr 7.0224e-05 eta 0:01:36
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,337
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [47/50] batch [20/203] time 0.132 (0.119) data 0.000 (0.014) loss 0.6614 (0.8151) ce_loss 0.5015 (0.5905) teacher_loss 0.1865 (0.3436) loss_zs_kd 0.1842 (0.1703) loss_oracle 0.3827 (0.3863) acc 81.2500 (78.4375) kd_loss 0.9274 (0.8781) lr 4.8943e-05 eta 0:01:34
epoch [47/50] batch [40/203] time 0.130 (0.111) data 0.000 (0.007) loss 0.7063 (0.8094) ce_loss 0.4766 (0.5550) teacher_loss 0.2131 (0.3224) loss_zs_kd 0.1896 (0.1690) loss_oracle 0.3985 (0.4026) acc 90.6250 (80.2344) kd_loss 0.8626 (0.8820) lr 4.8943e-05 eta 0:01:26
epoch [47/50] batch [60/203] time 0.080 (0.109) data 0.000 (0.005) loss 0.9572 (0.8083) ce_loss 0.7803 (0.5400) teacher_loss 0.4464 (0.3159) loss_zs_kd 0.1914 (0.1682) loss_oracle 0.4151 (0.4083) acc 75.0000 (80.6771) kd_loss 0.8988 (0.8856) lr 4.8943e-05 eta 0:01:21
epoch [47/50] batch [80/203] time 0.110 (0.108) data 0.000 (0.004) loss 0.9460 (0.8102) ce_loss 0.8037 (0.5428) teacher_loss 0.4388 (0.3189) loss_zs_kd 0.1462 (0.1672) loss_oracle 0.4342 (0.4077) acc 71.8750 (80.8594) kd_loss 0.8686 (0.8869) lr 4.8943e-05 eta 0:01:18
epoch [47/50] batch [100/203] time 0.134 (0.107) data 0.000 (0.003) loss 0.8756 (0.8076) ce_loss 0.6167 (0.5471) teacher_loss 0.4134 (0.3209) loss_zs_kd 0.1835 (0.1666) loss_oracle 0.3705 (0.4034) acc 78.1250 (80.7500) kd_loss 0.8415 (0.8884) lr 4.8943e-05 eta 0:01:16
epoch [47/50] batch [120/203] time 0.135 (0.106) data 0.000 (0.002) loss 0.8176 (0.8104) ce_loss 0.5591 (0.5500) teacher_loss 0.3368 (0.3252) loss_zs_kd 0.1826 (0.1679) loss_oracle 0.3895 (0.4012) acc 78.1250 (80.4167) kd_loss 0.9042 (0.8877) lr 4.8943e-05 eta 0:01:13
epoch [47/50] batch [140/203] time 0.087 (0.106) data 0.000 (0.002) loss 0.9281 (0.8155) ce_loss 0.5562 (0.5503) teacher_loss 0.4376 (0.3291) loss_zs_kd 0.1276 (0.1681) loss_oracle 0.4266 (0.4025) acc 87.5000 (80.3125) kd_loss 0.8761 (0.8884) lr 4.8943e-05 eta 0:01:10
epoch [47/50] batch [160/203] time 0.109 (0.105) data 0.000 (0.002) loss 0.9132 (0.8125) ce_loss 0.7935 (0.5448) teacher_loss 0.4005 (0.3269) loss_zs_kd 0.1895 (0.1684) loss_oracle 0.4180 (0.4015) acc 68.7500 (80.5859) kd_loss 0.8654 (0.8891) lr 4.8943e-05 eta 0:01:08
epoch [47/50] batch [180/203] time 0.084 (0.105) data 0.000 (0.002) loss 0.8628 (0.8107) ce_loss 0.4902 (0.5440) teacher_loss 0.3652 (0.3255) loss_zs_kd 0.1538 (0.1685) loss_oracle 0.4208 (0.4009) acc 81.2500 (80.3993) kd_loss 0.8760 (0.8896) lr 4.8943e-05 eta 0:01:06
epoch [47/50] batch [200/203] time 0.074 (0.104) data 0.000 (0.002) loss 0.7981 (0.8145) ce_loss 0.5405 (0.5485) teacher_loss 0.3279 (0.3295) loss_zs_kd 0.1921 (0.1688) loss_oracle 0.3742 (0.4006) acc 81.2500 (79.9844) kd_loss 0.9045 (0.8911) lr 4.8943e-05 eta 0:01:03
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,337
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 87.0%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [48/50] batch [20/203] time 0.138 (0.148) data 0.000 (0.014) loss 0.7684 (0.7771) ce_loss 0.5093 (0.5151) teacher_loss 0.2926 (0.2854) loss_zs_kd 0.1353 (0.1813) loss_oracle 0.4082 (0.4011) acc 75.0000 (78.9062) kd_loss 0.9165 (0.8841) lr 3.1417e-05 eta 0:01:27
epoch [48/50] batch [40/203] time 0.101 (0.131) data 0.000 (0.007) loss 1.1440 (0.8241) ce_loss 0.8765 (0.5617) teacher_loss 0.6551 (0.3283) loss_zs_kd 0.1924 (0.1760) loss_oracle 0.3927 (0.4077) acc 59.3750 (78.2031) kd_loss 0.9243 (0.8880) lr 3.1417e-05 eta 0:01:14
epoch [48/50] batch [60/203] time 0.123 (0.124) data 0.001 (0.005) loss 1.2527 (0.8284) ce_loss 1.0234 (0.5621) teacher_loss 0.6462 (0.3381) loss_zs_kd 0.1595 (0.1740) loss_oracle 0.5267 (0.4033) acc 75.0000 (78.2812) kd_loss 0.9054 (0.8861) lr 3.1417e-05 eta 0:01:08
epoch [48/50] batch [80/203] time 0.100 (0.121) data 0.000 (0.004) loss 0.8508 (0.8272) ce_loss 0.4805 (0.5578) teacher_loss 0.2537 (0.3356) loss_zs_kd 0.1563 (0.1740) loss_oracle 0.5189 (0.4046) acc 78.1250 (78.9453) kd_loss 0.9060 (0.8861) lr 3.1417e-05 eta 0:01:04
epoch [48/50] batch [100/203] time 0.124 (0.119) data 0.000 (0.003) loss 0.8294 (0.8339) ce_loss 0.4810 (0.5567) teacher_loss 0.3512 (0.3421) loss_zs_kd 0.1589 (0.1719) loss_oracle 0.3987 (0.4060) acc 81.2500 (78.9375) kd_loss 0.9482 (0.8878) lr 3.1417e-05 eta 0:01:00
epoch [48/50] batch [120/203] time 0.106 (0.118) data 0.000 (0.003) loss 0.9088 (0.8360) ce_loss 0.5283 (0.5621) teacher_loss 0.4439 (0.3465) loss_zs_kd 0.1534 (0.1719) loss_oracle 0.3882 (0.4036) acc 81.2500 (78.9062) kd_loss 0.8497 (0.8872) lr 3.1417e-05 eta 0:00:57
epoch [48/50] batch [140/203] time 0.113 (0.116) data 0.000 (0.002) loss 0.6866 (0.8305) ce_loss 0.3474 (0.5551) teacher_loss 0.1717 (0.3402) loss_zs_kd 0.1522 (0.1731) loss_oracle 0.4387 (0.4038) acc 87.5000 (79.1518) kd_loss 0.9416 (0.8879) lr 3.1417e-05 eta 0:00:54
epoch [48/50] batch [160/203] time 0.074 (0.114) data 0.000 (0.002) loss 0.7170 (0.8277) ce_loss 0.4539 (0.5503) teacher_loss 0.1946 (0.3366) loss_zs_kd 0.2019 (0.1726) loss_oracle 0.4214 (0.4048) acc 78.1250 (79.4922) kd_loss 0.9631 (0.8895) lr 3.1417e-05 eta 0:00:51
epoch [48/50] batch [180/203] time 0.105 (0.113) data 0.000 (0.002) loss 1.0928 (0.8251) ce_loss 0.8960 (0.5481) teacher_loss 0.6390 (0.3363) loss_zs_kd 0.1556 (0.1709) loss_oracle 0.3760 (0.4034) acc 59.3750 (79.7222) kd_loss 0.9273 (0.8894) lr 3.1417e-05 eta 0:00:48
epoch [48/50] batch [200/203] time 0.103 (0.111) data 0.000 (0.002) loss 0.7545 (0.8200) ce_loss 0.6313 (0.5470) teacher_loss 0.2831 (0.3333) loss_zs_kd 0.1795 (0.1705) loss_oracle 0.3817 (0.4015) acc 78.1250 (79.8594) kd_loss 0.8481 (0.8896) lr 3.1417e-05 eta 0:00:45
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,336
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 86.9%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [49/50] batch [20/203] time 0.084 (0.117) data 0.000 (0.012) loss 1.1289 (0.8369) ce_loss 0.7124 (0.5480) teacher_loss 0.5896 (0.3413) loss_zs_kd 0.1769 (0.1622) loss_oracle 0.4509 (0.4145) acc 71.8750 (79.3750) kd_loss 0.8016 (0.8851) lr 1.7713e-05 eta 0:00:45
epoch [49/50] batch [40/203] time 0.078 (0.107) data 0.000 (0.006) loss 0.7661 (0.8095) ce_loss 0.3962 (0.5358) teacher_loss 0.2855 (0.3251) loss_zs_kd 0.1525 (0.1678) loss_oracle 0.4043 (0.4005) acc 75.0000 (80.4688) kd_loss 0.9085 (0.8843) lr 1.7713e-05 eta 0:00:39
epoch [49/50] batch [60/203] time 0.125 (0.106) data 0.000 (0.004) loss 0.9217 (0.8197) ce_loss 0.6191 (0.5455) teacher_loss 0.4122 (0.3352) loss_zs_kd 0.2061 (0.1686) loss_oracle 0.4064 (0.4002) acc 78.1250 (80.1042) kd_loss 0.9154 (0.8875) lr 1.7713e-05 eta 0:00:36
epoch [49/50] batch [80/203] time 0.080 (0.105) data 0.000 (0.003) loss 0.8199 (0.8165) ce_loss 0.5688 (0.5542) teacher_loss 0.3608 (0.3406) loss_zs_kd 0.1663 (0.1693) loss_oracle 0.3760 (0.3912) acc 81.2500 (79.9219) kd_loss 0.8284 (0.8875) lr 1.7713e-05 eta 0:00:34
epoch [49/50] batch [100/203] time 0.113 (0.104) data 0.000 (0.003) loss 1.0131 (0.8202) ce_loss 0.6299 (0.5622) teacher_loss 0.4737 (0.3421) loss_zs_kd 0.1323 (0.1706) loss_oracle 0.4733 (0.3929) acc 75.0000 (79.4375) kd_loss 0.9354 (0.8908) lr 1.7713e-05 eta 0:00:31
epoch [49/50] batch [120/203] time 0.126 (0.104) data 0.000 (0.002) loss 0.9115 (0.8200) ce_loss 0.6621 (0.5583) teacher_loss 0.3732 (0.3408) loss_zs_kd 0.2256 (0.1717) loss_oracle 0.4255 (0.3933) acc 78.1250 (79.5573) kd_loss 0.9428 (0.8914) lr 1.7713e-05 eta 0:00:29
epoch [49/50] batch [140/203] time 0.098 (0.104) data 0.000 (0.002) loss 1.0401 (0.8186) ce_loss 0.8135 (0.5534) teacher_loss 0.4937 (0.3368) loss_zs_kd 0.1943 (0.1717) loss_oracle 0.4492 (0.3960) acc 87.5000 (79.6875) kd_loss 0.9646 (0.8924) lr 1.7713e-05 eta 0:00:27
epoch [49/50] batch [160/203] time 0.123 (0.104) data 0.000 (0.002) loss 1.0402 (0.8136) ce_loss 0.7603 (0.5464) teacher_loss 0.5654 (0.3328) loss_zs_kd 0.1739 (0.1707) loss_oracle 0.3879 (0.3954) acc 75.0000 (79.9609) kd_loss 0.8703 (0.8910) lr 1.7713e-05 eta 0:00:25
epoch [49/50] batch [180/203] time 0.077 (0.103) data 0.000 (0.002) loss 0.6819 (0.8167) ce_loss 0.4268 (0.5470) teacher_loss 0.2174 (0.3339) loss_zs_kd 0.1883 (0.1705) loss_oracle 0.3704 (0.3975) acc 81.2500 (80.0000) kd_loss 0.9200 (0.8902) lr 1.7713e-05 eta 0:00:23
epoch [49/50] batch [200/203] time 0.168 (0.106) data 0.000 (0.001) loss 0.8360 (0.8153) ce_loss 0.4187 (0.5460) teacher_loss 0.3720 (0.3327) loss_zs_kd 0.1218 (0.1710) loss_oracle 0.4031 (0.3970) acc 87.5000 (80.2344) kd_loss 0.8514 (0.8888) lr 1.7713e-05 eta 0:00:21
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,339
* accuracy: 83.7%
* error: 16.3%
* macro_f1: 87.1%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
epoch [50/50] batch [20/203] time 0.087 (0.113) data 0.000 (0.014) loss 1.1340 (0.8514) ce_loss 0.7920 (0.5548) teacher_loss 0.5019 (0.3499) loss_zs_kd 0.2208 (0.1693) loss_oracle 0.5217 (0.4169) acc 68.7500 (79.8438) kd_loss 0.9143 (0.8839) lr 7.8853e-06 eta 0:00:20
epoch [50/50] batch [40/203] time 0.077 (0.108) data 0.000 (0.007) loss 0.8712 (0.8324) ce_loss 0.7100 (0.5485) teacher_loss 0.3645 (0.3376) loss_zs_kd 0.2012 (0.1709) loss_oracle 0.4061 (0.4094) acc 65.6250 (79.8438) kd_loss 0.8654 (0.8891) lr 7.8853e-06 eta 0:00:17
epoch [50/50] batch [60/203] time 0.107 (0.106) data 0.000 (0.005) loss 0.8866 (0.8289) ce_loss 0.6157 (0.5552) teacher_loss 0.4350 (0.3417) loss_zs_kd 0.1656 (0.1695) loss_oracle 0.3688 (0.4024) acc 78.1250 (79.4271) kd_loss 0.8471 (0.8817) lr 7.8853e-06 eta 0:00:15
epoch [50/50] batch [80/203] time 0.092 (0.105) data 0.000 (0.004) loss 0.7610 (0.8229) ce_loss 0.4482 (0.5463) teacher_loss 0.2619 (0.3342) loss_zs_kd 0.1773 (0.1711) loss_oracle 0.4105 (0.4031) acc 81.2500 (79.9219) kd_loss 0.8878 (0.8827) lr 7.8853e-06 eta 0:00:12
epoch [50/50] batch [100/203] time 0.116 (0.105) data 0.000 (0.003) loss 0.8254 (0.8163) ce_loss 0.5532 (0.5365) teacher_loss 0.3651 (0.3285) loss_zs_kd 0.2052 (0.1702) loss_oracle 0.3576 (0.4027) acc 84.3750 (80.3125) kd_loss 0.8738 (0.8845) lr 7.8853e-06 eta 0:00:10
epoch [50/50] batch [120/203] time 0.101 (0.104) data 0.000 (0.003) loss 0.6711 (0.8204) ce_loss 0.4109 (0.5421) teacher_loss 0.2443 (0.3325) loss_zs_kd 0.1618 (0.1702) loss_oracle 0.3459 (0.4028) acc 90.6250 (80.2344) kd_loss 0.9050 (0.8868) lr 7.8853e-06 eta 0:00:08
epoch [50/50] batch [140/203] time 0.074 (0.104) data 0.000 (0.002) loss 0.6699 (0.8195) ce_loss 0.3857 (0.5430) teacher_loss 0.2221 (0.3321) loss_zs_kd 0.1535 (0.1707) loss_oracle 0.3710 (0.4020) acc 93.7500 (80.1116) kd_loss 0.7938 (0.8852) lr 7.8853e-06 eta 0:00:06
epoch [50/50] batch [160/203] time 0.114 (0.104) data 0.000 (0.002) loss 1.0402 (0.8192) ce_loss 0.8188 (0.5462) teacher_loss 0.5831 (0.3335) loss_zs_kd 0.1533 (0.1707) loss_oracle 0.3805 (0.4004) acc 75.0000 (80.0586) kd_loss 0.8030 (0.8838) lr 7.8853e-06 eta 0:00:04
epoch [50/50] batch [180/203] time 0.108 (0.104) data 0.000 (0.002) loss 0.8925 (0.8128) ce_loss 0.5312 (0.5403) teacher_loss 0.3984 (0.3296) loss_zs_kd 0.1708 (0.1700) loss_oracle 0.4087 (0.3983) acc 81.2500 (80.3646) kd_loss 0.8166 (0.8846) lr 7.8853e-06 eta 0:00:02
epoch [50/50] batch [200/203] time 0.076 (0.103) data 0.000 (0.002) loss 0.8599 (0.8160) ce_loss 0.5771 (0.5443) teacher_loss 0.3495 (0.3320) loss_zs_kd 0.1840 (0.1707) loss_oracle 0.4184 (0.3986) acc 75.0000 (80.1406) kd_loss 0.9048 (0.8853) lr 7.8853e-06 eta 0:00:00
Evaluate on the *val* set
=> result
* total: 2,795
* correct: 2,337
* accuracy: 83.6%
* error: 16.4%
* macro_f1: 87.0%
Evaluate on the *test* set
=> result
* total: 1,415
* correct: 1,415
* accuracy: 100.0%
* error: 0.0%
* macro_f1: 100.0%
******* Domain c best val acc:      83.8%, epoch: 35 *******
******* Domain c best val test acc: 100.0%, epoch: 35 *******
******* Domain c best test acc:     100.0%, epoch: 1 *******
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/vlcs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:22:38
