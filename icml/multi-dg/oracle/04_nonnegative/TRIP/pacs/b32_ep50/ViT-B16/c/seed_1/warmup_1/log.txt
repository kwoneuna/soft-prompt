Loading trainer: TRIP
Loading dataset: SPG_PACS
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -----------------------------------
Dataset    SPG_PACS
Source     ['art_painting', 'photo', 'sketch']
Target     ['cartoon']
# classes  7
# train_x  5,349
# val      2,297
# test     2,344
---------  -----------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/oracle/04_nonnegative/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/167] time 0.188 (0.178) data 0.000 (0.020) loss 0.6000 (0.5504) ce_loss 0.5991 (0.5499) teacher_loss 0.5996 (0.5500) loss_zs_kd 0.0001 (0.0000) loss_oracle 0.0003 (0.0005) acc 84.3750 (80.1562) kd_loss 0.0011 (0.0017) lr 1.0000e-05 eta 0:24:45
epoch [1/50] batch [40/167] time 0.078 (0.174) data 0.000 (0.010) loss 0.7089 (0.5569) ce_loss 0.7090 (0.5564) teacher_loss 0.7083 (0.5564) loss_zs_kd 0.0008 (0.0002) loss_oracle 0.0002 (0.0003) acc 75.0000 (80.3125) kd_loss 0.0009 (0.0013) lr 1.0000e-05 eta 0:24:02
epoch [1/50] batch [60/167] time 0.076 (0.150) data 0.000 (0.007) loss 0.5877 (0.5332) ce_loss 0.5864 (0.5326) teacher_loss 0.5864 (0.5326) loss_zs_kd 0.0015 (0.0005) loss_oracle 0.0005 (0.0004) acc 75.0000 (81.5104) kd_loss 0.0021 (0.0014) lr 1.0000e-05 eta 0:20:42
epoch [1/50] batch [80/167] time 0.094 (0.139) data 0.000 (0.005) loss 0.6666 (0.5200) ce_loss 0.6646 (0.5191) teacher_loss 0.6647 (0.5191) loss_zs_kd 0.0025 (0.0009) loss_oracle 0.0006 (0.0004) acc 71.8750 (81.8750) kd_loss 0.0023 (0.0015) lr 1.0000e-05 eta 0:19:06
epoch [1/50] batch [100/167] time 0.118 (0.132) data 0.000 (0.004) loss 0.3047 (0.5074) ce_loss 0.3020 (0.5064) teacher_loss 0.3018 (0.5063) loss_zs_kd 0.0048 (0.0013) loss_oracle 0.0005 (0.0004) acc 87.5000 (82.2188) kd_loss 0.0020 (0.0016) lr 1.0000e-05 eta 0:18:08
epoch [1/50] batch [120/167] time 0.102 (0.125) data 0.000 (0.003) loss 0.5083 (0.5022) ce_loss 0.5049 (0.5009) teacher_loss 0.5051 (0.5008) loss_zs_kd 0.0050 (0.0019) loss_oracle 0.0007 (0.0004) acc 81.2500 (82.3698) kd_loss 0.0029 (0.0017) lr 1.0000e-05 eta 0:17:08
epoch [1/50] batch [140/167] time 0.131 (0.121) data 0.000 (0.003) loss 0.5684 (0.4941) ce_loss 0.5645 (0.4924) teacher_loss 0.5641 (0.4924) loss_zs_kd 0.0063 (0.0024) loss_oracle 0.0011 (0.0005) acc 75.0000 (82.5000) kd_loss 0.0042 (0.0020) lr 1.0000e-05 eta 0:16:35
epoch [1/50] batch [160/167] time 0.090 (0.119) data 0.000 (0.003) loss 0.3219 (0.4941) ce_loss 0.3181 (0.4920) teacher_loss 0.3182 (0.4919) loss_zs_kd 0.0058 (0.0031) loss_oracle 0.0008 (0.0006) acc 90.6250 (82.4609) kd_loss 0.0027 (0.0022) lr 1.0000e-05 eta 0:16:17
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,168
* accuracy: 94.4%
* error: 5.6%
* macro_f1: 95.0%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,327
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain c best val acc:      94.4%, epoch: 1 *******
******* Domain c best val test acc: 99.3%, epoch: 1 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/oracle/04_nonnegative/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/ana
epoch [2/50] batch [20/167] time 0.106 (0.153) data 0.000 (0.019) loss 0.8186 (0.5217) ce_loss 0.7993 (0.4873) teacher_loss 0.7772 (0.4841) loss_zs_kd 0.0369 (0.0529) loss_oracle 0.0229 (0.0111) acc 71.8750 (82.5000) kd_loss 0.0831 (0.0198) lr 2.0000e-03 eta 0:20:45
epoch [2/50] batch [40/167] time 0.105 (0.141) data 0.000 (0.010) loss 0.3804 (0.4889) ce_loss 0.2791 (0.4380) teacher_loss 0.2246 (0.4238) loss_zs_kd 0.0792 (0.0538) loss_oracle 0.1163 (0.0382) acc 93.7500 (84.5312) kd_loss 0.2081 (0.0648) lr 2.0000e-03 eta 0:19:07
epoch [2/50] batch [60/167] time 0.124 (0.137) data 0.000 (0.007) loss 0.4315 (0.5274) ce_loss 0.2622 (0.4436) teacher_loss 0.2364 (0.4159) loss_zs_kd 0.0620 (0.0586) loss_oracle 0.1642 (0.0822) acc 87.5000 (84.3229) kd_loss 0.2753 (0.1231) lr 2.0000e-03 eta 0:18:32
epoch [2/50] batch [80/167] time 0.134 (0.130) data 0.000 (0.005) loss 0.5912 (0.5631) ce_loss 0.3484 (0.4542) teacher_loss 0.2187 (0.4043) loss_zs_kd 0.1282 (0.0672) loss_oracle 0.3085 (0.1253) acc 90.6250 (83.9453) kd_loss 0.4512 (0.1908) lr 2.0000e-03 eta 0:17:30
epoch [2/50] batch [100/167] time 0.115 (0.125) data 0.000 (0.004) loss 0.5354 (0.5704) ce_loss 0.2820 (0.4424) teacher_loss 0.1633 (0.3744) loss_zs_kd 0.0627 (0.0696) loss_oracle 0.3407 (0.1612) acc 87.5000 (84.1250) kd_loss 0.6135 (0.2564) lr 2.0000e-03 eta 0:16:47
epoch [2/50] batch [120/167] time 0.143 (0.123) data 0.000 (0.003) loss 0.7201 (0.5884) ce_loss 0.4075 (0.4409) teacher_loss 0.2658 (0.3599) loss_zs_kd 0.0503 (0.0727) loss_oracle 0.4291 (0.1922) acc 87.5000 (84.0885) kd_loss 0.6139 (0.3163) lr 2.0000e-03 eta 0:16:32
epoch [2/50] batch [140/167] time 0.114 (0.122) data 0.000 (0.003) loss 0.4872 (0.6175) ce_loss 0.1150 (0.4376) teacher_loss 0.1052 (0.3478) loss_zs_kd 0.0376 (0.0774) loss_oracle 0.3632 (0.2310) acc 96.8750 (84.3750) kd_loss 0.6983 (0.3686) lr 2.0000e-03 eta 0:16:24
epoch [2/50] batch [160/167] time 0.100 (0.121) data 0.000 (0.003) loss 0.7496 (0.6421) ce_loss 0.3765 (0.4411) teacher_loss 0.2359 (0.3454) loss_zs_kd 0.0928 (0.0764) loss_oracle 0.4672 (0.2585) acc 84.3750 (84.2578) kd_loss 0.8788 (0.4203) lr 2.0000e-03 eta 0:16:10
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,183
* accuracy: 95.0%
* error: 5.0%
* macro_f1: 95.6%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.0%, epoch: 2 *******
******* Domain c best val test acc: 99.1%, epoch: 2 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [3/50] batch [20/167] time 0.125 (0.174) data 0.000 (0.017) loss 0.7952 (0.8789) ce_loss 0.2791 (0.4115) teacher_loss 0.1748 (0.2605) loss_zs_kd 0.0480 (0.0960) loss_oracle 0.5964 (0.5704) acc 87.5000 (84.6875) kd_loss 0.9415 (0.9252) lr 1.9980e-03 eta 0:23:13
epoch [3/50] batch [40/167] time 0.143 (0.147) data 0.000 (0.009) loss 0.9075 (0.9051) ce_loss 0.6528 (0.4550) teacher_loss 0.2983 (0.2886) loss_zs_kd 0.0693 (0.0983) loss_oracle 0.5745 (0.5673) acc 78.1250 (83.0469) kd_loss 0.8819 (0.9198) lr 1.9980e-03 eta 0:19:32
epoch [3/50] batch [60/167] time 0.092 (0.138) data 0.000 (0.006) loss 0.7992 (0.8844) ce_loss 0.4099 (0.4547) teacher_loss 0.3449 (0.2945) loss_zs_kd 0.0656 (0.0962) loss_oracle 0.4215 (0.5418) acc 87.5000 (83.2292) kd_loss 0.7601 (0.9023) lr 1.9980e-03 eta 0:18:19
epoch [3/50] batch [80/167] time 0.141 (0.135) data 0.000 (0.005) loss 0.7089 (0.8692) ce_loss 0.3218 (0.4624) teacher_loss 0.2457 (0.3014) loss_zs_kd 0.0957 (0.0954) loss_oracle 0.4153 (0.5200) acc 93.7500 (83.1250) kd_loss 0.8574 (0.8956) lr 1.9980e-03 eta 0:17:54
epoch [3/50] batch [100/167] time 0.140 (0.133) data 0.000 (0.004) loss 0.5946 (0.8509) ce_loss 0.1890 (0.4538) teacher_loss 0.1386 (0.3021) loss_zs_kd 0.0771 (0.0930) loss_oracle 0.4174 (0.5023) acc 96.8750 (83.3438) kd_loss 0.9256 (0.8974) lr 1.9980e-03 eta 0:17:33
epoch [3/50] batch [120/167] time 0.100 (0.131) data 0.000 (0.003) loss 0.6513 (0.8344) ce_loss 0.3464 (0.4478) teacher_loss 0.2695 (0.3045) loss_zs_kd 0.0426 (0.0888) loss_oracle 0.3604 (0.4855) acc 87.5000 (83.5677) kd_loss 0.9249 (0.9019) lr 1.9980e-03 eta 0:17:17
epoch [3/50] batch [140/167] time 0.116 (0.131) data 0.000 (0.003) loss 0.5602 (0.8288) ce_loss 0.2129 (0.4500) teacher_loss 0.1759 (0.3128) loss_zs_kd 0.0500 (0.0871) loss_oracle 0.3593 (0.4724) acc 90.6250 (83.6607) kd_loss 0.9332 (0.9063) lr 1.9980e-03 eta 0:17:07
epoch [3/50] batch [160/167] time 0.100 (0.128) data 0.000 (0.002) loss 0.8255 (0.8304) ce_loss 0.3608 (0.4495) teacher_loss 0.3033 (0.3159) loss_zs_kd 0.0578 (0.0852) loss_oracle 0.4932 (0.4719) acc 87.5000 (83.7500) kd_loss 0.9402 (0.9106) lr 1.9980e-03 eta 0:16:41
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,185
* accuracy: 95.1%
* error: 4.9%
* macro_f1: 95.6%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,322
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
******* Domain c best val acc:      95.1%, epoch: 3 *******
******* Domain c best val test acc: 99.1%, epoch: 3 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [4/50] batch [20/167] time 0.081 (0.134) data 0.000 (0.017) loss 0.6169 (0.8290) ce_loss 0.1904 (0.4305) teacher_loss 0.1229 (0.3282) loss_zs_kd 0.0688 (0.0745) loss_oracle 0.4595 (0.4636) acc 93.7500 (84.3750) kd_loss 0.9928 (0.9627) lr 1.9921e-03 eta 0:17:29
epoch [4/50] batch [40/167] time 0.098 (0.123) data 0.000 (0.008) loss 1.0621 (0.8465) ce_loss 0.6240 (0.4477) teacher_loss 0.5077 (0.3444) loss_zs_kd 0.0735 (0.0742) loss_oracle 0.5176 (0.4649) acc 78.1250 (84.0625) kd_loss 0.9719 (0.9558) lr 1.9921e-03 eta 0:16:01
epoch [4/50] batch [60/167] time 0.094 (0.120) data 0.000 (0.006) loss 0.8206 (0.8205) ce_loss 0.4568 (0.4271) teacher_loss 0.3036 (0.3276) loss_zs_kd 0.0799 (0.0708) loss_oracle 0.4770 (0.4575) acc 84.3750 (84.7917) kd_loss 0.9644 (0.9494) lr 1.9921e-03 eta 0:15:31
epoch [4/50] batch [80/167] time 0.093 (0.118) data 0.000 (0.004) loss 0.8097 (0.8289) ce_loss 0.5327 (0.4387) teacher_loss 0.3420 (0.3330) loss_zs_kd 0.0847 (0.0728) loss_oracle 0.4254 (0.4595) acc 78.1250 (84.2188) kd_loss 0.8583 (0.9469) lr 1.9921e-03 eta 0:15:20
epoch [4/50] batch [100/167] time 0.135 (0.118) data 0.000 (0.003) loss 0.8461 (0.8236) ce_loss 0.4402 (0.4378) teacher_loss 0.3470 (0.3288) loss_zs_kd 0.0778 (0.0765) loss_oracle 0.4602 (0.4565) acc 84.3750 (84.2500) kd_loss 0.9165 (0.9456) lr 1.9921e-03 eta 0:15:14
epoch [4/50] batch [120/167] time 0.141 (0.117) data 0.000 (0.003) loss 0.7844 (0.8275) ce_loss 0.3765 (0.4412) teacher_loss 0.3040 (0.3302) loss_zs_kd 0.0956 (0.0764) loss_oracle 0.4326 (0.4591) acc 81.2500 (83.9323) kd_loss 0.9058 (0.9406) lr 1.9921e-03 eta 0:15:04
epoch [4/50] batch [140/167] time 0.071 (0.116) data 0.000 (0.003) loss 0.7260 (0.8270) ce_loss 0.2891 (0.4383) teacher_loss 0.1800 (0.3238) loss_zs_kd 0.0886 (0.0769) loss_oracle 0.5018 (0.4647) acc 93.7500 (83.7723) kd_loss 0.8790 (0.9339) lr 1.9921e-03 eta 0:14:54
epoch [4/50] batch [160/167] time 0.187 (0.120) data 0.000 (0.002) loss 0.8069 (0.8286) ce_loss 0.5044 (0.4398) teacher_loss 0.2651 (0.3210) loss_zs_kd 0.1164 (0.0781) loss_oracle 0.4835 (0.4686) acc 78.1250 (83.7500) kd_loss 0.8348 (0.9294) lr 1.9921e-03 eta 0:15:21
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,185
* accuracy: 95.1%
* error: 4.9%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.1%, epoch: 3 *******
******* Domain c best val test acc: 99.1%, epoch: 3 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [5/50] batch [20/167] time 0.087 (0.124) data 0.000 (0.012) loss 1.0207 (0.8614) ce_loss 0.5449 (0.4269) teacher_loss 0.4097 (0.3009) loss_zs_kd 0.0686 (0.0823) loss_oracle 0.5766 (0.5193) acc 84.3750 (83.5938) kd_loss 0.9268 (0.9071) lr 1.9823e-03 eta 0:15:51
epoch [5/50] batch [40/167] time 0.111 (0.117) data 0.000 (0.006) loss 0.9392 (0.8342) ce_loss 0.4880 (0.4091) teacher_loss 0.3194 (0.2856) loss_zs_kd 0.1063 (0.0771) loss_oracle 0.5666 (0.5101) acc 75.0000 (84.2969) kd_loss 0.9118 (0.9103) lr 1.9823e-03 eta 0:14:52
epoch [5/50] batch [60/167] time 0.089 (0.114) data 0.001 (0.004) loss 0.8980 (0.8385) ce_loss 0.4285 (0.4112) teacher_loss 0.2906 (0.2909) loss_zs_kd 0.0836 (0.0776) loss_oracle 0.5656 (0.5088) acc 81.2500 (84.6875) kd_loss 0.9782 (0.9080) lr 1.9823e-03 eta 0:14:30
epoch [5/50] batch [80/167] time 0.137 (0.113) data 0.000 (0.003) loss 1.0095 (0.8423) ce_loss 0.6445 (0.4213) teacher_loss 0.4467 (0.3018) loss_zs_kd 0.0622 (0.0762) loss_oracle 0.5318 (0.5024) acc 71.8750 (84.2188) kd_loss 0.9144 (0.9062) lr 1.9823e-03 eta 0:14:21
epoch [5/50] batch [100/167] time 0.115 (0.113) data 0.000 (0.003) loss 0.8382 (0.8522) ce_loss 0.3887 (0.4338) teacher_loss 0.3597 (0.3154) loss_zs_kd 0.0999 (0.0773) loss_oracle 0.4285 (0.4981) acc 87.5000 (84.1250) kd_loss 0.8159 (0.9061) lr 1.9823e-03 eta 0:14:15
epoch [5/50] batch [120/167] time 0.135 (0.112) data 0.000 (0.002) loss 0.8673 (0.8503) ce_loss 0.3696 (0.4296) teacher_loss 0.2942 (0.3174) loss_zs_kd 0.0876 (0.0790) loss_oracle 0.5292 (0.4935) acc 84.3750 (84.3490) kd_loss 0.9423 (0.9064) lr 1.9823e-03 eta 0:14:06
epoch [5/50] batch [140/167] time 0.088 (0.111) data 0.001 (0.002) loss 0.8506 (0.8494) ce_loss 0.5161 (0.4261) teacher_loss 0.3761 (0.3189) loss_zs_kd 0.0773 (0.0789) loss_oracle 0.4359 (0.4911) acc 78.1250 (84.3527) kd_loss 0.9096 (0.9064) lr 1.9823e-03 eta 0:14:00
epoch [5/50] batch [160/167] time 0.097 (0.110) data 0.000 (0.002) loss 0.8414 (0.8473) ce_loss 0.3037 (0.4220) teacher_loss 0.1948 (0.3168) loss_zs_kd 0.0698 (0.0790) loss_oracle 0.6117 (0.4910) acc 84.3750 (84.4141) kd_loss 0.9796 (0.9071) lr 1.9823e-03 eta 0:13:50
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,191
* accuracy: 95.4%
* error: 4.6%
* macro_f1: 95.9%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.4%, epoch: 5 *******
******* Domain c best val test acc: 99.1%, epoch: 5 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [6/50] batch [20/167] time 0.135 (0.136) data 0.000 (0.015) loss 1.1674 (0.9602) ce_loss 0.5732 (0.4032) teacher_loss 0.4663 (0.3164) loss_zs_kd 0.0811 (0.0816) loss_oracle 0.6605 (0.6029) acc 84.3750 (84.5312) kd_loss 0.9535 (0.9583) lr 1.9686e-03 eta 0:17:00
epoch [6/50] batch [40/167] time 0.119 (0.127) data 0.000 (0.008) loss 0.8184 (0.9539) ce_loss 0.4409 (0.4004) teacher_loss 0.2606 (0.3086) loss_zs_kd 0.0737 (0.0782) loss_oracle 0.5209 (0.6062) acc 81.2500 (84.6875) kd_loss 0.8888 (0.9645) lr 1.9686e-03 eta 0:15:51
epoch [6/50] batch [60/167] time 0.138 (0.126) data 0.000 (0.005) loss 1.0587 (0.9651) ce_loss 0.5605 (0.4168) teacher_loss 0.3285 (0.3123) loss_zs_kd 0.0705 (0.0850) loss_oracle 0.6950 (0.6103) acc 78.1250 (84.0104) kd_loss 1.0047 (0.9680) lr 1.9686e-03 eta 0:15:38
epoch [6/50] batch [80/167] time 0.144 (0.124) data 0.000 (0.004) loss 0.8268 (0.9481) ce_loss 0.2585 (0.4017) teacher_loss 0.2210 (0.2974) loss_zs_kd 0.0535 (0.0807) loss_oracle 0.5790 (0.6104) acc 93.7500 (84.6484) kd_loss 0.9736 (0.9731) lr 1.9686e-03 eta 0:15:20
epoch [6/50] batch [100/167] time 0.133 (0.123) data 0.000 (0.003) loss 0.9596 (0.9464) ce_loss 0.3875 (0.4068) teacher_loss 0.2715 (0.2985) loss_zs_kd 0.0658 (0.0815) loss_oracle 0.6552 (0.6071) acc 87.5000 (84.4688) kd_loss 1.0398 (0.9742) lr 1.9686e-03 eta 0:15:10
epoch [6/50] batch [120/167] time 0.069 (0.120) data 0.000 (0.003) loss 1.1559 (0.9520) ce_loss 0.6567 (0.4179) teacher_loss 0.4856 (0.3046) loss_zs_kd 0.0977 (0.0816) loss_oracle 0.6215 (0.6066) acc 75.0000 (84.0365) kd_loss 0.9013 (0.9722) lr 1.9686e-03 eta 0:14:49
epoch [6/50] batch [140/167] time 0.155 (0.117) data 0.000 (0.002) loss 0.8893 (0.9492) ce_loss 0.4436 (0.4192) teacher_loss 0.2614 (0.3031) loss_zs_kd 0.0732 (0.0822) loss_oracle 0.5912 (0.6050) acc 87.5000 (83.9732) kd_loss 0.9545 (0.9729) lr 1.9686e-03 eta 0:14:25
epoch [6/50] batch [160/167] time 0.068 (0.123) data 0.000 (0.002) loss 0.6899 (0.9408) ce_loss 0.2369 (0.4168) teacher_loss 0.1769 (0.2989) loss_zs_kd 0.0427 (0.0828) loss_oracle 0.4917 (0.6005) acc 90.6250 (84.0234) kd_loss 0.9162 (0.9718) lr 1.9686e-03 eta 0:15:05
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,187
* accuracy: 95.2%
* error: 4.8%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.4%, epoch: 5 *******
******* Domain c best val test acc: 99.1%, epoch: 5 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [7/50] batch [20/167] time 0.101 (0.132) data 0.001 (0.018) loss 0.7603 (0.8481) ce_loss 0.3323 (0.4194) teacher_loss 0.2273 (0.2941) loss_zs_kd 0.0732 (0.0790) loss_oracle 0.4964 (0.5145) acc 84.3750 (84.2188) kd_loss 0.9352 (0.9327) lr 1.9511e-03 eta 0:16:06
epoch [7/50] batch [40/167] time 0.143 (0.127) data 0.000 (0.009) loss 0.6242 (0.8211) ce_loss 0.2080 (0.3993) teacher_loss 0.1606 (0.2730) loss_zs_kd 0.0632 (0.0804) loss_oracle 0.4320 (0.5079) acc 93.7500 (85.2344) kd_loss 0.8512 (0.9303) lr 1.9511e-03 eta 0:15:27
epoch [7/50] batch [60/167] time 0.147 (0.128) data 0.001 (0.006) loss 0.8803 (0.8185) ce_loss 0.5366 (0.4067) teacher_loss 0.3014 (0.2727) loss_zs_kd 0.1036 (0.0822) loss_oracle 0.5271 (0.5047) acc 81.2500 (85.1562) kd_loss 0.8735 (0.9267) lr 1.9511e-03 eta 0:15:30
epoch [7/50] batch [80/167] time 0.137 (0.127) data 0.000 (0.005) loss 0.6757 (0.8174) ce_loss 0.3489 (0.4134) teacher_loss 0.1896 (0.2781) loss_zs_kd 0.0749 (0.0870) loss_oracle 0.4486 (0.4958) acc 87.5000 (85.0000) kd_loss 0.9280 (0.9242) lr 1.9511e-03 eta 0:15:20
epoch [7/50] batch [100/167] time 0.137 (0.126) data 0.000 (0.004) loss 1.0464 (0.8204) ce_loss 0.8003 (0.4140) teacher_loss 0.4431 (0.2810) loss_zs_kd 0.1046 (0.0845) loss_oracle 0.5509 (0.4971) acc 71.8750 (84.9062) kd_loss 1.0068 (0.9265) lr 1.9511e-03 eta 0:15:12
epoch [7/50] batch [120/167] time 0.146 (0.125) data 0.000 (0.003) loss 1.1422 (0.8296) ce_loss 0.6001 (0.4174) teacher_loss 0.5249 (0.2813) loss_zs_kd 0.1272 (0.0882) loss_oracle 0.5537 (0.5042) acc 84.3750 (84.7396) kd_loss 0.9836 (0.9324) lr 1.9511e-03 eta 0:15:02
epoch [7/50] batch [140/167] time 0.123 (0.125) data 0.000 (0.003) loss 0.7809 (0.8386) ce_loss 0.3276 (0.4190) teacher_loss 0.2058 (0.2837) loss_zs_kd 0.1130 (0.0885) loss_oracle 0.5186 (0.5106) acc 93.7500 (84.6205) kd_loss 1.0174 (0.9368) lr 1.9511e-03 eta 0:14:58
epoch [7/50] batch [160/167] time 0.113 (0.123) data 0.000 (0.002) loss 0.7494 (0.8398) ce_loss 0.2544 (0.4212) teacher_loss 0.1634 (0.2856) loss_zs_kd 0.0862 (0.0881) loss_oracle 0.5429 (0.5101) acc 93.7500 (84.5898) kd_loss 0.9990 (0.9389) lr 1.9511e-03 eta 0:14:47
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,189
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.4%, epoch: 5 *******
******* Domain c best val test acc: 99.1%, epoch: 5 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [8/50] batch [20/167] time 0.146 (0.142) data 0.000 (0.014) loss 0.6537 (0.7338) ce_loss 0.3291 (0.3978) teacher_loss 0.1764 (0.2625) loss_zs_kd 0.0888 (0.0961) loss_oracle 0.4329 (0.4232) acc 87.5000 (84.3750) kd_loss 0.9658 (0.9740) lr 1.9298e-03 eta 0:16:54
epoch [8/50] batch [40/167] time 0.087 (0.131) data 0.000 (0.007) loss 0.5879 (0.7139) ce_loss 0.3213 (0.3935) teacher_loss 0.1730 (0.2530) loss_zs_kd 0.0844 (0.0967) loss_oracle 0.3728 (0.4124) acc 87.5000 (85.3906) kd_loss 0.9593 (0.9709) lr 1.9298e-03 eta 0:15:35
epoch [8/50] batch [60/167] time 0.145 (0.130) data 0.001 (0.005) loss 0.7039 (0.7218) ce_loss 0.4077 (0.3978) teacher_loss 0.2786 (0.2479) loss_zs_kd 0.1320 (0.1086) loss_oracle 0.3594 (0.4196) acc 84.3750 (85.3125) kd_loss 0.9779 (0.9757) lr 1.9298e-03 eta 0:15:25
epoch [8/50] batch [80/167] time 0.106 (0.128) data 0.000 (0.004) loss 0.5237 (0.7300) ce_loss 0.2003 (0.4047) teacher_loss 0.1261 (0.2509) loss_zs_kd 0.1126 (0.1112) loss_oracle 0.3413 (0.4235) acc 93.7500 (85.2734) kd_loss 0.9216 (0.9875) lr 1.9298e-03 eta 0:15:05
epoch [8/50] batch [100/167] time 0.143 (0.127) data 0.000 (0.003) loss 0.6677 (0.7364) ce_loss 0.3665 (0.4147) teacher_loss 0.2135 (0.2511) loss_zs_kd 0.1132 (0.1160) loss_oracle 0.3976 (0.4273) acc 81.2500 (85.2188) kd_loss 1.0078 (0.9946) lr 1.9298e-03 eta 0:14:59
epoch [8/50] batch [120/167] time 0.197 (0.128) data 0.000 (0.003) loss 0.5284 (0.7275) ce_loss 0.3523 (0.4103) teacher_loss 0.1530 (0.2458) loss_zs_kd 0.0736 (0.1160) loss_oracle 0.3386 (0.4238) acc 87.5000 (85.1823) kd_loss 1.0183 (0.9967) lr 1.9298e-03 eta 0:15:05
epoch [8/50] batch [140/167] time 0.189 (0.131) data 0.000 (0.002) loss 0.6303 (0.7203) ce_loss 0.2668 (0.4040) teacher_loss 0.2807 (0.2442) loss_zs_kd 0.1117 (0.1148) loss_oracle 0.2937 (0.4187) acc 93.7500 (85.3795) kd_loss 0.9817 (0.9937) lr 1.9298e-03 eta 0:15:21
epoch [8/50] batch [160/167] time 0.061 (0.135) data 0.000 (0.002) loss 0.7832 (0.7159) ce_loss 0.5488 (0.4096) teacher_loss 0.2856 (0.2458) loss_zs_kd 0.1828 (0.1141) loss_oracle 0.4062 (0.4131) acc 78.1250 (85.1367) kd_loss 1.0062 (0.9922) lr 1.9298e-03 eta 0:15:49
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,191
* accuracy: 95.4%
* error: 4.6%
* macro_f1: 95.9%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.4%, epoch: 5 *******
******* Domain c best val test acc: 99.1%, epoch: 5 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [9/50] batch [20/167] time 0.106 (0.135) data 0.000 (0.017) loss 0.9632 (0.7788) ce_loss 0.7280 (0.4798) teacher_loss 0.3544 (0.2622) loss_zs_kd 0.1878 (0.1390) loss_oracle 0.5149 (0.4472) acc 65.6250 (81.5625) kd_loss 0.9062 (0.9984) lr 1.9048e-03 eta 0:15:44
epoch [9/50] batch [40/167] time 0.144 (0.124) data 0.000 (0.008) loss 0.8609 (0.7668) ce_loss 0.5522 (0.4463) teacher_loss 0.3112 (0.2418) loss_zs_kd 0.1376 (0.1282) loss_oracle 0.4809 (0.4608) acc 78.1250 (82.8125) kd_loss 1.0513 (1.0101) lr 1.9048e-03 eta 0:14:26
epoch [9/50] batch [60/167] time 0.104 (0.121) data 0.001 (0.006) loss 0.7703 (0.7772) ce_loss 0.4414 (0.4506) teacher_loss 0.2879 (0.2459) loss_zs_kd 0.1410 (0.1318) loss_oracle 0.4119 (0.4654) acc 81.2500 (83.2812) kd_loss 0.9415 (1.0148) lr 1.9048e-03 eta 0:13:58
epoch [9/50] batch [80/167] time 0.146 (0.121) data 0.000 (0.004) loss 0.8596 (0.7847) ce_loss 0.3794 (0.4457) teacher_loss 0.2218 (0.2418) loss_zs_kd 0.1172 (0.1314) loss_oracle 0.5793 (0.4771) acc 81.2500 (83.3594) kd_loss 1.1032 (1.0219) lr 1.9048e-03 eta 0:14:01
epoch [9/50] batch [100/167] time 0.102 (0.120) data 0.000 (0.004) loss 0.5951 (0.7826) ce_loss 0.1609 (0.4454) teacher_loss 0.0628 (0.2401) loss_zs_kd 0.1191 (0.1325) loss_oracle 0.4728 (0.4763) acc 96.8750 (83.4688) kd_loss 1.0488 (1.0232) lr 1.9048e-03 eta 0:13:51
epoch [9/50] batch [120/167] time 0.112 (0.119) data 0.000 (0.003) loss 0.7642 (0.7875) ce_loss 0.4080 (0.4448) teacher_loss 0.2189 (0.2428) loss_zs_kd 0.1194 (0.1330) loss_oracle 0.4856 (0.4783) acc 84.3750 (83.5417) kd_loss 1.0048 (1.0252) lr 1.9048e-03 eta 0:13:42
epoch [9/50] batch [140/167] time 0.131 (0.120) data 0.000 (0.003) loss 0.4341 (0.7792) ce_loss 0.0692 (0.4369) teacher_loss 0.0333 (0.2386) loss_zs_kd 0.0362 (0.1298) loss_oracle 0.3827 (0.4757) acc 96.8750 (84.0179) kd_loss 1.0045 (1.0245) lr 1.9048e-03 eta 0:13:43
epoch [9/50] batch [160/167] time 0.091 (0.119) data 0.000 (0.002) loss 0.7788 (0.7758) ce_loss 0.5903 (0.4403) teacher_loss 0.2191 (0.2395) loss_zs_kd 0.1690 (0.1288) loss_oracle 0.4751 (0.4719) acc 75.0000 (83.8086) kd_loss 1.0530 (1.0230) lr 1.9048e-03 eta 0:13:33
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,197
* accuracy: 95.6%
* error: 4.4%
* macro_f1: 96.1%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [10/50] batch [20/167] time 0.079 (0.121) data 0.000 (0.015) loss 0.6010 (0.7507) ce_loss 0.2881 (0.4210) teacher_loss 0.1360 (0.2493) loss_zs_kd 0.0753 (0.1419) loss_oracle 0.4273 (0.4305) acc 87.5000 (84.5312) kd_loss 1.0110 (0.9968) lr 1.8763e-03 eta 0:13:45
epoch [10/50] batch [40/167] time 0.136 (0.116) data 0.000 (0.008) loss 0.6960 (0.7224) ce_loss 0.2954 (0.3904) teacher_loss 0.2643 (0.2303) loss_zs_kd 0.1071 (0.1293) loss_oracle 0.3782 (0.4275) acc 93.7500 (85.7812) kd_loss 1.0068 (0.9951) lr 1.8763e-03 eta 0:13:07
epoch [10/50] batch [60/167] time 0.091 (0.113) data 0.000 (0.005) loss 0.8079 (0.7310) ce_loss 0.5410 (0.3999) teacher_loss 0.2749 (0.2328) loss_zs_kd 0.1412 (0.1229) loss_oracle 0.4623 (0.4367) acc 84.3750 (85.1042) kd_loss 0.9463 (0.9923) lr 1.8763e-03 eta 0:12:47
epoch [10/50] batch [80/167] time 0.073 (0.112) data 0.000 (0.004) loss 0.8054 (0.7467) ce_loss 0.4436 (0.3981) teacher_loss 0.2366 (0.2328) loss_zs_kd 0.0869 (0.1215) loss_oracle 0.5254 (0.4531) acc 87.5000 (85.0781) kd_loss 0.9791 (0.9946) lr 1.8763e-03 eta 0:12:34
epoch [10/50] batch [100/167] time 0.165 (0.108) data 0.000 (0.003) loss 1.0048 (0.7617) ce_loss 0.6396 (0.4086) teacher_loss 0.4359 (0.2395) loss_zs_kd 0.1406 (0.1213) loss_oracle 0.4986 (0.4616) acc 75.0000 (84.6562) kd_loss 0.9962 (0.9957) lr 1.8763e-03 eta 0:12:11
epoch [10/50] batch [120/167] time 0.068 (0.115) data 0.000 (0.003) loss 1.1559 (0.7747) ce_loss 0.7441 (0.4159) teacher_loss 0.5537 (0.2475) loss_zs_kd 0.1559 (0.1206) loss_oracle 0.5243 (0.4669) acc 75.0000 (84.5312) kd_loss 0.9937 (0.9942) lr 1.8763e-03 eta 0:12:56
epoch [10/50] batch [140/167] time 0.178 (0.119) data 0.000 (0.002) loss 0.8920 (0.7842) ce_loss 0.5210 (0.4194) teacher_loss 0.2538 (0.2519) loss_zs_kd 0.1603 (0.1200) loss_oracle 0.5580 (0.4722) acc 78.1250 (84.3304) kd_loss 1.0142 (0.9965) lr 1.8763e-03 eta 0:13:18
epoch [10/50] batch [160/167] time 0.095 (0.120) data 0.000 (0.002) loss 0.6928 (0.7784) ce_loss 0.3220 (0.4163) teacher_loss 0.2506 (0.2504) loss_zs_kd 0.0890 (0.1166) loss_oracle 0.3977 (0.4697) acc 87.5000 (84.4141) kd_loss 0.9521 (0.9967) lr 1.8763e-03 eta 0:13:23
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,191
* accuracy: 95.4%
* error: 4.6%
* macro_f1: 95.9%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,324
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [11/50] batch [20/167] time 0.116 (0.129) data 0.000 (0.014) loss 0.7926 (0.7180) ce_loss 0.4197 (0.4028) teacher_loss 0.2774 (0.2361) loss_zs_kd 0.1489 (0.1072) loss_oracle 0.4407 (0.4283) acc 81.2500 (83.9062) kd_loss 0.9282 (0.9696) lr 1.8443e-03 eta 0:14:17
epoch [11/50] batch [40/167] time 0.134 (0.118) data 0.000 (0.007) loss 0.6671 (0.7088) ce_loss 0.3113 (0.3935) teacher_loss 0.2481 (0.2315) loss_zs_kd 0.1039 (0.1130) loss_oracle 0.3671 (0.4208) acc 90.6250 (85.1562) kd_loss 0.9028 (0.9721) lr 1.8443e-03 eta 0:13:04
epoch [11/50] batch [60/167] time 0.102 (0.114) data 0.000 (0.005) loss 0.8110 (0.7133) ce_loss 0.4746 (0.3901) teacher_loss 0.3264 (0.2399) loss_zs_kd 0.0788 (0.1049) loss_oracle 0.4452 (0.4209) acc 87.5000 (85.8854) kd_loss 0.9442 (0.9663) lr 1.8443e-03 eta 0:12:37
epoch [11/50] batch [80/167] time 0.110 (0.114) data 0.001 (0.004) loss 0.6303 (0.7224) ce_loss 0.3367 (0.4082) teacher_loss 0.2380 (0.2528) loss_zs_kd 0.0737 (0.1067) loss_oracle 0.3554 (0.4162) acc 90.6250 (84.9609) kd_loss 0.9406 (0.9611) lr 1.8443e-03 eta 0:12:31
epoch [11/50] batch [100/167] time 0.136 (0.113) data 0.000 (0.003) loss 0.5665 (0.7021) ce_loss 0.3389 (0.3941) teacher_loss 0.2016 (0.2419) loss_zs_kd 0.0934 (0.1032) loss_oracle 0.3182 (0.4087) acc 87.5000 (85.6250) kd_loss 0.9634 (0.9580) lr 1.8443e-03 eta 0:12:26
epoch [11/50] batch [120/167] time 0.133 (0.112) data 0.000 (0.003) loss 0.5386 (0.6962) ce_loss 0.2612 (0.3936) teacher_loss 0.2225 (0.2426) loss_zs_kd 0.0735 (0.1031) loss_oracle 0.2794 (0.4020) acc 87.5000 (85.5469) kd_loss 0.8516 (0.9562) lr 1.8443e-03 eta 0:12:16
epoch [11/50] batch [140/167] time 0.137 (0.112) data 0.000 (0.002) loss 0.7291 (0.6954) ce_loss 0.3521 (0.3959) teacher_loss 0.3437 (0.2454) loss_zs_kd 0.0899 (0.1036) loss_oracle 0.3404 (0.3982) acc 90.6250 (85.4464) kd_loss 0.8998 (0.9542) lr 1.8443e-03 eta 0:12:13
epoch [11/50] batch [160/167] time 0.070 (0.111) data 0.000 (0.002) loss 0.7528 (0.6958) ce_loss 0.5806 (0.4021) teacher_loss 0.2768 (0.2497) loss_zs_kd 0.1623 (0.1050) loss_oracle 0.3949 (0.3936) acc 75.0000 (85.2734) kd_loss 0.9517 (0.9537) lr 1.8443e-03 eta 0:12:01
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,192
* accuracy: 95.4%
* error: 4.6%
* macro_f1: 95.9%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [12/50] batch [20/167] time 0.079 (0.121) data 0.000 (0.016) loss 0.7510 (0.6799) ce_loss 0.5112 (0.3737) teacher_loss 0.2738 (0.2417) loss_zs_kd 0.0984 (0.0985) loss_oracle 0.4281 (0.3890) acc 81.2500 (85.4688) kd_loss 0.9902 (0.9373) lr 1.8090e-03 eta 0:13:06
epoch [12/50] batch [40/167] time 0.137 (0.113) data 0.000 (0.008) loss 0.7380 (0.6823) ce_loss 0.3787 (0.3618) teacher_loss 0.2090 (0.2303) loss_zs_kd 0.1346 (0.1027) loss_oracle 0.4617 (0.4006) acc 84.3750 (86.4844) kd_loss 1.0433 (0.9302) lr 1.8090e-03 eta 0:12:11
epoch [12/50] batch [60/167] time 0.092 (0.109) data 0.000 (0.005) loss 0.8357 (0.7164) ce_loss 0.5122 (0.3912) teacher_loss 0.2903 (0.2505) loss_zs_kd 0.1394 (0.1091) loss_oracle 0.4757 (0.4114) acc 78.1250 (85.3125) kd_loss 0.9394 (0.9270) lr 1.8090e-03 eta 0:11:43
epoch [12/50] batch [80/167] time 0.111 (0.109) data 0.000 (0.004) loss 0.9025 (0.7504) ce_loss 0.4932 (0.4046) teacher_loss 0.2624 (0.2568) loss_zs_kd 0.1673 (0.1132) loss_oracle 0.5565 (0.4370) acc 84.3750 (85.0781) kd_loss 0.9704 (0.9321) lr 1.8090e-03 eta 0:11:38
epoch [12/50] batch [100/167] time 0.078 (0.109) data 0.000 (0.003) loss 0.7572 (0.7676) ce_loss 0.3569 (0.4104) teacher_loss 0.1963 (0.2598) loss_zs_kd 0.0792 (0.1135) loss_oracle 0.5213 (0.4511) acc 93.7500 (84.7812) kd_loss 0.8934 (0.9370) lr 1.8090e-03 eta 0:11:41
epoch [12/50] batch [120/167] time 0.088 (0.107) data 0.000 (0.003) loss 0.9501 (0.7852) ce_loss 0.4934 (0.4242) teacher_loss 0.2748 (0.2646) loss_zs_kd 0.1632 (0.1171) loss_oracle 0.5937 (0.4622) acc 87.5000 (84.3750) kd_loss 0.9660 (0.9375) lr 1.8090e-03 eta 0:11:26
epoch [12/50] batch [140/167] time 0.188 (0.116) data 0.000 (0.002) loss 0.6067 (0.7896) ce_loss 0.1743 (0.4265) teacher_loss 0.1202 (0.2627) loss_zs_kd 0.0866 (0.1172) loss_oracle 0.4432 (0.4683) acc 93.7500 (84.3527) kd_loss 0.8988 (0.9373) lr 1.8090e-03 eta 0:12:16
epoch [12/50] batch [160/167] time 0.188 (0.117) data 0.000 (0.002) loss 0.7861 (0.7892) ce_loss 0.3074 (0.4238) teacher_loss 0.2022 (0.2589) loss_zs_kd 0.1242 (0.1173) loss_oracle 0.5218 (0.4717) acc 90.6250 (84.4727) kd_loss 0.9451 (0.9393) lr 1.8090e-03 eta 0:12:26
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,185
* accuracy: 95.1%
* error: 4.9%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,324
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [13/50] batch [20/167] time 0.089 (0.130) data 0.000 (0.012) loss 0.7756 (0.7756) ce_loss 0.4031 (0.4489) teacher_loss 0.1876 (0.2446) loss_zs_kd 0.1129 (0.1121) loss_oracle 0.5316 (0.4749) acc 87.5000 (83.7500) kd_loss 1.0182 (0.9452) lr 1.7705e-03 eta 0:13:42
epoch [13/50] batch [40/167] time 0.137 (0.125) data 0.000 (0.006) loss 0.7255 (0.7724) ce_loss 0.3337 (0.4432) teacher_loss 0.1769 (0.2447) loss_zs_kd 0.1226 (0.1225) loss_oracle 0.4873 (0.4665) acc 90.6250 (83.6719) kd_loss 1.0194 (0.9642) lr 1.7705e-03 eta 0:13:05
epoch [13/50] batch [60/167] time 0.115 (0.122) data 0.001 (0.004) loss 0.5343 (0.7486) ce_loss 0.1898 (0.4251) teacher_loss 0.1461 (0.2349) loss_zs_kd 0.0759 (0.1248) loss_oracle 0.3503 (0.4513) acc 93.7500 (84.0104) kd_loss 0.9823 (0.9717) lr 1.7705e-03 eta 0:12:47
epoch [13/50] batch [80/167] time 0.100 (0.120) data 0.000 (0.003) loss 0.6804 (0.7336) ce_loss 0.2986 (0.4187) teacher_loss 0.2275 (0.2372) loss_zs_kd 0.1162 (0.1181) loss_oracle 0.3947 (0.4374) acc 87.5000 (84.2969) kd_loss 1.0232 (0.9845) lr 1.7705e-03 eta 0:12:30
epoch [13/50] batch [100/167] time 0.144 (0.121) data 0.000 (0.003) loss 0.6793 (0.7356) ce_loss 0.2959 (0.4161) teacher_loss 0.2162 (0.2439) loss_zs_kd 0.0792 (0.1153) loss_oracle 0.4235 (0.4340) acc 90.6250 (84.5938) kd_loss 1.0517 (0.9953) lr 1.7705e-03 eta 0:12:37
epoch [13/50] batch [120/167] time 0.134 (0.122) data 0.000 (0.002) loss 0.8206 (0.7613) ce_loss 0.2280 (0.4169) teacher_loss 0.1234 (0.2525) loss_zs_kd 0.0880 (0.1115) loss_oracle 0.6531 (0.4531) acc 90.6250 (84.5833) kd_loss 1.0984 (1.0054) lr 1.7705e-03 eta 0:12:42
epoch [13/50] batch [140/167] time 0.144 (0.123) data 0.000 (0.002) loss 1.3718 (0.7915) ce_loss 1.0391 (0.4249) teacher_loss 0.7316 (0.2644) loss_zs_kd 0.1094 (0.1089) loss_oracle 0.5856 (0.4727) acc 59.3750 (84.2857) kd_loss 1.1079 (1.0123) lr 1.7705e-03 eta 0:12:45
epoch [13/50] batch [160/167] time 0.080 (0.124) data 0.000 (0.002) loss 0.7698 (0.8030) ce_loss 0.2937 (0.4238) teacher_loss 0.1684 (0.2642) loss_zs_kd 0.1045 (0.1080) loss_oracle 0.5491 (0.4848) acc 87.5000 (84.3164) kd_loss 1.0529 (1.0198) lr 1.7705e-03 eta 0:12:47
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,189
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [14/50] batch [20/167] time 0.089 (0.130) data 0.000 (0.016) loss 0.9419 (0.8586) ce_loss 0.4426 (0.4166) teacher_loss 0.2656 (0.2652) loss_zs_kd 0.1042 (0.0912) loss_oracle 0.6242 (0.5478) acc 81.2500 (84.8438) kd_loss 1.0935 (1.0604) lr 1.7290e-03 eta 0:13:19
epoch [14/50] batch [40/167] time 0.121 (0.123) data 0.000 (0.008) loss 0.6528 (0.8544) ce_loss 0.2808 (0.4124) teacher_loss 0.1621 (0.2627) loss_zs_kd 0.0796 (0.0966) loss_oracle 0.4508 (0.5434) acc 90.6250 (85.0781) kd_loss 0.9539 (1.0629) lr 1.7290e-03 eta 0:12:37
epoch [14/50] batch [60/167] time 0.144 (0.123) data 0.001 (0.006) loss 0.9181 (0.8621) ce_loss 0.5508 (0.4180) teacher_loss 0.3277 (0.2690) loss_zs_kd 0.0734 (0.0973) loss_oracle 0.5538 (0.5444) acc 81.2500 (84.6875) kd_loss 1.1005 (1.0610) lr 1.7290e-03 eta 0:12:30
epoch [14/50] batch [80/167] time 0.148 (0.121) data 0.000 (0.004) loss 0.8162 (0.8640) ce_loss 0.5737 (0.4210) teacher_loss 0.2863 (0.2785) loss_zs_kd 0.0879 (0.0967) loss_oracle 0.4860 (0.5371) acc 75.0000 (84.1797) kd_loss 1.0649 (1.0615) lr 1.7290e-03 eta 0:12:15
epoch [14/50] batch [100/167] time 0.157 (0.119) data 0.000 (0.003) loss 0.8543 (0.8604) ce_loss 0.4812 (0.4226) teacher_loss 0.3416 (0.2830) loss_zs_kd 0.0991 (0.0951) loss_oracle 0.4632 (0.5299) acc 81.2500 (84.1250) kd_loss 1.0341 (1.0607) lr 1.7290e-03 eta 0:12:03
epoch [14/50] batch [120/167] time 0.080 (0.127) data 0.000 (0.003) loss 0.7543 (0.8578) ce_loss 0.5557 (0.4306) teacher_loss 0.2649 (0.2906) loss_zs_kd 0.1079 (0.0940) loss_oracle 0.4355 (0.5202) acc 78.1250 (83.7760) kd_loss 0.9534 (1.0578) lr 1.7290e-03 eta 0:12:46
epoch [14/50] batch [140/167] time 0.185 (0.132) data 0.000 (0.002) loss 0.9746 (0.8518) ce_loss 0.6279 (0.4320) teacher_loss 0.4665 (0.2933) loss_zs_kd 0.1300 (0.0935) loss_oracle 0.4431 (0.5118) acc 78.1250 (83.7946) kd_loss 1.0903 (1.0525) lr 1.7290e-03 eta 0:13:17
epoch [14/50] batch [160/167] time 0.089 (0.131) data 0.000 (0.002) loss 0.7969 (0.8466) ce_loss 0.3875 (0.4305) teacher_loss 0.2821 (0.2939) loss_zs_kd 0.0790 (0.0931) loss_oracle 0.4753 (0.5061) acc 78.1250 (83.8281) kd_loss 1.0701 (1.0512) lr 1.7290e-03 eta 0:13:08
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,184
* accuracy: 95.1%
* error: 4.9%
* macro_f1: 95.6%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,322
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [15/50] batch [20/167] time 0.074 (0.127) data 0.000 (0.016) loss 0.7957 (0.8062) ce_loss 0.4414 (0.4545) teacher_loss 0.3370 (0.3234) loss_zs_kd 0.0522 (0.0815) loss_oracle 0.4325 (0.4420) acc 84.3750 (83.9062) kd_loss 0.9844 (1.0251) lr 1.6845e-03 eta 0:12:42
epoch [15/50] batch [40/167] time 0.103 (0.116) data 0.000 (0.008) loss 0.5875 (0.7829) ce_loss 0.1971 (0.4141) teacher_loss 0.1452 (0.2981) loss_zs_kd 0.0678 (0.0824) loss_oracle 0.4083 (0.4436) acc 90.6250 (84.9219) kd_loss 1.0159 (1.0237) lr 1.6845e-03 eta 0:11:33
epoch [15/50] batch [60/167] time 0.104 (0.111) data 0.000 (0.006) loss 0.5626 (0.7594) ce_loss 0.2235 (0.3924) teacher_loss 0.1606 (0.2795) loss_zs_kd 0.0499 (0.0801) loss_oracle 0.3770 (0.4398) acc 87.5000 (85.7292) kd_loss 1.0121 (1.0210) lr 1.6845e-03 eta 0:11:02
epoch [15/50] batch [80/167] time 0.073 (0.110) data 0.000 (0.004) loss 0.6070 (0.7716) ce_loss 0.4067 (0.4126) teacher_loss 0.1930 (0.2941) loss_zs_kd 0.0869 (0.0830) loss_oracle 0.3706 (0.4360) acc 81.2500 (84.9609) kd_loss 0.9729 (1.0177) lr 1.6845e-03 eta 0:10:53
epoch [15/50] batch [100/167] time 0.095 (0.110) data 0.000 (0.003) loss 0.8416 (0.7678) ce_loss 0.3962 (0.4128) teacher_loss 0.3581 (0.2914) loss_zs_kd 0.0840 (0.0844) loss_oracle 0.4415 (0.4342) acc 87.5000 (85.0000) kd_loss 1.0555 (1.0152) lr 1.6845e-03 eta 0:10:53
epoch [15/50] batch [120/167] time 0.133 (0.111) data 0.000 (0.003) loss 0.7834 (0.7593) ce_loss 0.4712 (0.4046) teacher_loss 0.2968 (0.2841) loss_zs_kd 0.1487 (0.0843) loss_oracle 0.4122 (0.4331) acc 75.0000 (85.1302) kd_loss 1.0281 (1.0139) lr 1.6845e-03 eta 0:10:56
epoch [15/50] batch [140/167] time 0.082 (0.112) data 0.000 (0.003) loss 0.6494 (0.7596) ce_loss 0.2854 (0.4057) teacher_loss 0.2293 (0.2862) loss_zs_kd 0.0756 (0.0839) loss_oracle 0.3822 (0.4315) acc 90.6250 (85.0670) kd_loss 0.9312 (1.0132) lr 1.6845e-03 eta 0:10:56
epoch [15/50] batch [160/167] time 0.118 (0.112) data 0.000 (0.002) loss 0.7864 (0.7608) ce_loss 0.4229 (0.4086) teacher_loss 0.3142 (0.2881) loss_zs_kd 0.1051 (0.0847) loss_oracle 0.4197 (0.4304) acc 84.3750 (84.9414) kd_loss 0.9971 (1.0134) lr 1.6845e-03 eta 0:10:57
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,190
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,322
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [16/50] batch [20/167] time 0.084 (0.117) data 0.000 (0.011) loss 0.6815 (0.7963) ce_loss 0.3694 (0.4509) teacher_loss 0.2742 (0.3107) loss_zs_kd 0.0794 (0.1066) loss_oracle 0.3676 (0.4323) acc 81.2500 (82.6562) kd_loss 1.0158 (1.0126) lr 1.6374e-03 eta 0:11:18
epoch [16/50] batch [40/167] time 0.139 (0.113) data 0.000 (0.006) loss 0.7046 (0.7615) ce_loss 0.3564 (0.4249) teacher_loss 0.2461 (0.2977) loss_zs_kd 0.0946 (0.0910) loss_oracle 0.4111 (0.4183) acc 90.6250 (84.8438) kd_loss 0.9134 (1.0047) lr 1.6374e-03 eta 0:10:58
epoch [16/50] batch [60/167] time 0.106 (0.111) data 0.000 (0.004) loss 0.6960 (0.7558) ce_loss 0.4268 (0.4336) teacher_loss 0.3175 (0.2946) loss_zs_kd 0.0933 (0.0930) loss_oracle 0.3318 (0.4146) acc 90.6250 (84.3229) kd_loss 0.9626 (1.0051) lr 1.6374e-03 eta 0:10:43
epoch [16/50] batch [80/167] time 0.125 (0.111) data 0.000 (0.003) loss 0.8624 (0.7563) ce_loss 0.5791 (0.4322) teacher_loss 0.3931 (0.2962) loss_zs_kd 0.1015 (0.0935) loss_oracle 0.4186 (0.4134) acc 75.0000 (84.1406) kd_loss 1.0140 (1.0058) lr 1.6374e-03 eta 0:10:42
epoch [16/50] batch [100/167] time 0.086 (0.109) data 0.000 (0.002) loss 0.6924 (0.7615) ce_loss 0.2903 (0.4299) teacher_loss 0.2144 (0.2955) loss_zs_kd 0.1220 (0.0937) loss_oracle 0.4170 (0.4191) acc 84.3750 (84.3438) kd_loss 1.0106 (1.0033) lr 1.6374e-03 eta 0:10:25
epoch [16/50] batch [120/167] time 0.077 (0.118) data 0.000 (0.002) loss 0.8614 (0.7624) ce_loss 0.5308 (0.4309) teacher_loss 0.3596 (0.2976) loss_zs_kd 0.0854 (0.0911) loss_oracle 0.4591 (0.4193) acc 84.3750 (84.3490) kd_loss 1.0503 (1.0024) lr 1.6374e-03 eta 0:11:15
epoch [16/50] batch [140/167] time 0.185 (0.123) data 0.000 (0.002) loss 0.6054 (0.7568) ce_loss 0.2151 (0.4224) teacher_loss 0.1902 (0.2954) loss_zs_kd 0.0781 (0.0888) loss_oracle 0.3762 (0.4171) acc 93.7500 (84.8884) kd_loss 0.9323 (1.0010) lr 1.6374e-03 eta 0:11:43
epoch [16/50] batch [160/167] time 0.079 (0.123) data 0.000 (0.002) loss 0.9343 (0.7632) ce_loss 0.6069 (0.4248) teacher_loss 0.4394 (0.2987) loss_zs_kd 0.0866 (0.0878) loss_oracle 0.4516 (0.4206) acc 78.1250 (84.7266) kd_loss 0.9878 (1.0015) lr 1.6374e-03 eta 0:11:40
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,191
* accuracy: 95.4%
* error: 4.6%
* macro_f1: 95.9%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [17/50] batch [20/167] time 0.148 (0.150) data 0.001 (0.015) loss 0.7986 (0.7733) ce_loss 0.4287 (0.4121) teacher_loss 0.3945 (0.3126) loss_zs_kd 0.0906 (0.0913) loss_oracle 0.3587 (0.4150) acc 78.1250 (83.7500) kd_loss 0.8838 (1.0020) lr 1.5878e-03 eta 0:14:07
epoch [17/50] batch [40/167] time 0.144 (0.139) data 0.000 (0.008) loss 0.6410 (0.7443) ce_loss 0.3284 (0.3969) teacher_loss 0.1668 (0.2928) loss_zs_kd 0.0594 (0.0894) loss_oracle 0.4445 (0.4068) acc 90.6250 (85.0781) kd_loss 1.0307 (1.0078) lr 1.5878e-03 eta 0:13:01
epoch [17/50] batch [60/167] time 0.126 (0.135) data 0.001 (0.005) loss 0.6511 (0.7353) ce_loss 0.2502 (0.3966) teacher_loss 0.1004 (0.2903) loss_zs_kd 0.1118 (0.0875) loss_oracle 0.4949 (0.4012) acc 90.6250 (85.2083) kd_loss 1.0499 (1.0059) lr 1.5878e-03 eta 0:12:37
epoch [17/50] batch [80/167] time 0.145 (0.135) data 0.000 (0.004) loss 0.6635 (0.7504) ce_loss 0.4189 (0.4143) teacher_loss 0.2550 (0.3019) loss_zs_kd 0.0699 (0.0899) loss_oracle 0.3735 (0.4035) acc 81.2500 (84.4922) kd_loss 0.9875 (1.0014) lr 1.5878e-03 eta 0:12:33
epoch [17/50] batch [100/167] time 0.091 (0.133) data 0.000 (0.003) loss 0.7638 (0.7490) ce_loss 0.4236 (0.4111) teacher_loss 0.2340 (0.2967) loss_zs_kd 0.0985 (0.0897) loss_oracle 0.4806 (0.4074) acc 84.3750 (84.6875) kd_loss 1.0135 (0.9994) lr 1.5878e-03 eta 0:12:19
epoch [17/50] batch [120/167] time 0.143 (0.132) data 0.000 (0.003) loss 0.7117 (0.7506) ce_loss 0.3564 (0.4085) teacher_loss 0.1985 (0.2916) loss_zs_kd 0.0758 (0.0907) loss_oracle 0.4753 (0.4136) acc 84.3750 (84.8177) kd_loss 0.9966 (1.0000) lr 1.5878e-03 eta 0:12:15
epoch [17/50] batch [140/167] time 0.137 (0.132) data 0.000 (0.002) loss 0.7648 (0.7456) ce_loss 0.4253 (0.4021) teacher_loss 0.2723 (0.2858) loss_zs_kd 0.0734 (0.0898) loss_oracle 0.4558 (0.4149) acc 87.5000 (85.0223) kd_loss 0.9579 (0.9989) lr 1.5878e-03 eta 0:12:10
epoch [17/50] batch [160/167] time 0.085 (0.131) data 0.000 (0.002) loss 0.5551 (0.7458) ce_loss 0.2170 (0.4033) teacher_loss 0.1376 (0.2836) loss_zs_kd 0.0699 (0.0903) loss_oracle 0.3825 (0.4170) acc 90.6250 (85.0781) kd_loss 0.9450 (0.9981) lr 1.5878e-03 eta 0:12:02
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,193
* accuracy: 95.5%
* error: 4.5%
* macro_f1: 96.0%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [18/50] batch [20/167] time 0.123 (0.143) data 0.000 (0.015) loss 0.6939 (0.7649) ce_loss 0.2263 (0.3945) teacher_loss 0.1870 (0.2891) loss_zs_kd 0.0616 (0.0960) loss_oracle 0.4760 (0.4278) acc 90.6250 (84.8438) kd_loss 1.0340 (0.9943) lr 1.5358e-03 eta 0:13:04
epoch [18/50] batch [40/167] time 0.140 (0.133) data 0.000 (0.008) loss 0.7038 (0.7516) ce_loss 0.3320 (0.3949) teacher_loss 0.2084 (0.2862) loss_zs_kd 0.1189 (0.0979) loss_oracle 0.4360 (0.4164) acc 90.6250 (84.6094) kd_loss 0.8959 (0.9865) lr 1.5358e-03 eta 0:12:07
epoch [18/50] batch [60/167] time 0.189 (0.129) data 0.001 (0.005) loss 0.6905 (0.7564) ce_loss 0.3425 (0.4005) teacher_loss 0.2602 (0.2864) loss_zs_kd 0.0885 (0.1003) loss_oracle 0.3861 (0.4199) acc 87.5000 (84.7396) kd_loss 1.0017 (0.9859) lr 1.5358e-03 eta 0:11:45
epoch [18/50] batch [80/167] time 0.103 (0.136) data 0.000 (0.004) loss 0.7872 (0.7632) ce_loss 0.6099 (0.4120) teacher_loss 0.2872 (0.2866) loss_zs_kd 0.1010 (0.1001) loss_oracle 0.4495 (0.4266) acc 75.0000 (84.2188) kd_loss 0.9995 (0.9876) lr 1.5358e-03 eta 0:12:18
epoch [18/50] batch [100/167] time 0.187 (0.145) data 0.002 (0.003) loss 0.7643 (0.7556) ce_loss 0.3098 (0.3953) teacher_loss 0.1842 (0.2666) loss_zs_kd 0.0888 (0.1044) loss_oracle 0.5356 (0.4368) acc 84.3750 (84.9688) kd_loss 0.9452 (0.9890) lr 1.5358e-03 eta 0:13:05
epoch [18/50] batch [120/167] time 0.142 (0.141) data 0.000 (0.003) loss 0.7320 (0.7609) ce_loss 0.3291 (0.3964) teacher_loss 0.1833 (0.2615) loss_zs_kd 0.1096 (0.1069) loss_oracle 0.4939 (0.4460) acc 87.5000 (84.9740) kd_loss 0.9913 (0.9901) lr 1.5358e-03 eta 0:12:41
epoch [18/50] batch [140/167] time 0.114 (0.139) data 0.001 (0.002) loss 0.6981 (0.7647) ce_loss 0.3979 (0.3991) teacher_loss 0.1857 (0.2680) loss_zs_kd 0.1353 (0.1077) loss_oracle 0.4447 (0.4429) acc 87.5000 (85.0223) kd_loss 1.0497 (0.9910) lr 1.5358e-03 eta 0:12:23
epoch [18/50] batch [160/167] time 0.127 (0.136) data 0.000 (0.002) loss 0.7353 (0.7692) ce_loss 0.3303 (0.4049) teacher_loss 0.3146 (0.2737) loss_zs_kd 0.0955 (0.1084) loss_oracle 0.3730 (0.4413) acc 87.5000 (84.7852) kd_loss 0.9921 (0.9928) lr 1.5358e-03 eta 0:12:06
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,199
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.2%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.7%, epoch: 18 *******
******* Domain c best val test acc: 99.0%, epoch: 18 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [19/50] batch [20/167] time 0.081 (0.117) data 0.000 (0.013) loss 1.0625 (0.7740) ce_loss 0.6201 (0.4039) teacher_loss 0.4779 (0.2807) loss_zs_kd 0.1274 (0.1112) loss_oracle 0.5209 (0.4377) acc 78.1250 (84.8438) kd_loss 0.9966 (1.0043) lr 1.4818e-03 eta 0:10:22
epoch [19/50] batch [40/167] time 0.083 (0.105) data 0.000 (0.007) loss 0.7592 (0.8124) ce_loss 0.3550 (0.4279) teacher_loss 0.2685 (0.2983) loss_zs_kd 0.0732 (0.1111) loss_oracle 0.4541 (0.4586) acc 90.6250 (84.3750) kd_loss 1.0206 (1.0106) lr 1.4818e-03 eta 0:09:18
epoch [19/50] batch [60/167] time 0.095 (0.103) data 0.000 (0.004) loss 0.8745 (0.8151) ce_loss 0.3655 (0.3988) teacher_loss 0.2914 (0.2832) loss_zs_kd 0.0869 (0.1055) loss_oracle 0.5396 (0.4791) acc 87.5000 (85.1042) kd_loss 1.0108 (1.0119) lr 1.4818e-03 eta 0:09:05
epoch [19/50] batch [80/167] time 0.090 (0.103) data 0.000 (0.003) loss 0.8687 (0.8282) ce_loss 0.3623 (0.3997) teacher_loss 0.3743 (0.2966) loss_zs_kd 0.0866 (0.1009) loss_oracle 0.4511 (0.4811) acc 87.5000 (85.1562) kd_loss 1.0257 (1.0127) lr 1.4818e-03 eta 0:09:02
epoch [19/50] batch [100/167] time 0.138 (0.104) data 0.000 (0.003) loss 0.9928 (0.8475) ce_loss 0.5742 (0.4093) teacher_loss 0.4596 (0.3128) loss_zs_kd 0.0824 (0.0981) loss_oracle 0.4920 (0.4856) acc 75.0000 (84.5938) kd_loss 0.9813 (1.0104) lr 1.4818e-03 eta 0:09:07
epoch [19/50] batch [120/167] time 0.137 (0.108) data 0.000 (0.002) loss 1.0609 (0.8419) ce_loss 0.5874 (0.4023) teacher_loss 0.5429 (0.3142) loss_zs_kd 0.0644 (0.0912) loss_oracle 0.4858 (0.4821) acc 78.1250 (84.9219) kd_loss 0.9707 (1.0080) lr 1.4818e-03 eta 0:09:22
epoch [19/50] batch [140/167] time 0.097 (0.110) data 0.000 (0.002) loss 0.8197 (0.8478) ce_loss 0.3220 (0.4070) teacher_loss 0.2432 (0.3226) loss_zs_kd 0.0849 (0.0874) loss_oracle 0.5341 (0.4815) acc 87.5000 (84.7991) kd_loss 1.0427 (1.0090) lr 1.4818e-03 eta 0:09:33
epoch [19/50] batch [160/167] time 0.109 (0.111) data 0.000 (0.002) loss 0.9525 (0.8530) ce_loss 0.4961 (0.4102) teacher_loss 0.4151 (0.3278) loss_zs_kd 0.0609 (0.0844) loss_oracle 0.5070 (0.4830) acc 81.2500 (84.6875) kd_loss 1.0050 (1.0103) lr 1.4818e-03 eta 0:09:35
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,188
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.0%
******* Domain c best val acc:      95.7%, epoch: 18 *******
******* Domain c best val test acc: 99.0%, epoch: 18 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [20/50] batch [20/167] time 0.091 (0.135) data 0.000 (0.014) loss 1.0297 (0.8221) ce_loss 0.6465 (0.3789) teacher_loss 0.4521 (0.3174) loss_zs_kd 0.0941 (0.0563) loss_oracle 0.5305 (0.4766) acc 78.1250 (86.0938) kd_loss 1.0184 (1.0108) lr 1.4258e-03 eta 0:11:34
epoch [20/50] batch [40/167] time 0.087 (0.123) data 0.000 (0.007) loss 0.7821 (0.8268) ce_loss 0.3081 (0.3861) teacher_loss 0.2882 (0.3239) loss_zs_kd 0.0518 (0.0557) loss_oracle 0.4680 (0.4750) acc 90.6250 (85.6250) kd_loss 1.0286 (1.0079) lr 1.4258e-03 eta 0:10:33
epoch [20/50] batch [60/167] time 0.071 (0.138) data 0.001 (0.005) loss 0.8308 (0.8411) ce_loss 0.3904 (0.3971) teacher_loss 0.3744 (0.3359) loss_zs_kd 0.0412 (0.0540) loss_oracle 0.4358 (0.4782) acc 87.5000 (85.2083) kd_loss 0.9577 (1.0024) lr 1.4258e-03 eta 0:11:44
epoch [20/50] batch [80/167] time 0.176 (0.138) data 0.000 (0.004) loss 0.8477 (0.8362) ce_loss 0.4199 (0.3948) teacher_loss 0.3757 (0.3333) loss_zs_kd 0.0763 (0.0537) loss_oracle 0.4338 (0.4761) acc 87.5000 (85.5469) kd_loss 0.9728 (1.0002) lr 1.4258e-03 eta 0:11:45
epoch [20/50] batch [100/167] time 0.116 (0.138) data 0.000 (0.003) loss 0.9450 (0.8334) ce_loss 0.5327 (0.3986) teacher_loss 0.4919 (0.3344) loss_zs_kd 0.0765 (0.0548) loss_oracle 0.4148 (0.4716) acc 75.0000 (85.3750) kd_loss 0.9876 (0.9969) lr 1.4258e-03 eta 0:11:39
epoch [20/50] batch [120/167] time 0.096 (0.134) data 0.000 (0.003) loss 0.8854 (0.8310) ce_loss 0.4875 (0.3980) teacher_loss 0.4136 (0.3343) loss_zs_kd 0.0840 (0.0549) loss_oracle 0.4298 (0.4693) acc 87.5000 (85.3385) kd_loss 0.9972 (0.9934) lr 1.4258e-03 eta 0:11:16
epoch [20/50] batch [140/167] time 0.110 (0.131) data 0.000 (0.002) loss 0.8910 (0.8319) ce_loss 0.4631 (0.4039) teacher_loss 0.3794 (0.3389) loss_zs_kd 0.0583 (0.0561) loss_oracle 0.4825 (0.4650) acc 81.2500 (84.8661) kd_loss 0.9842 (0.9893) lr 1.4258e-03 eta 0:10:58
epoch [20/50] batch [160/167] time 0.085 (0.128) data 0.000 (0.002) loss 0.7084 (0.8224) ce_loss 0.3481 (0.3982) teacher_loss 0.2769 (0.3336) loss_zs_kd 0.0541 (0.0556) loss_oracle 0.4045 (0.4611) acc 87.5000 (85.2148) kd_loss 0.9029 (0.9846) lr 1.4258e-03 eta 0:10:43
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,191
* accuracy: 95.4%
* error: 4.6%
* macro_f1: 95.9%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.7%, epoch: 18 *******
******* Domain c best val test acc: 99.0%, epoch: 18 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [21/50] batch [20/167] time 0.110 (0.137) data 0.000 (0.015) loss 0.7315 (0.8370) ce_loss 0.3953 (0.4568) teacher_loss 0.3157 (0.3777) loss_zs_kd 0.0389 (0.0641) loss_oracle 0.3964 (0.4272) acc 84.3750 (82.5000) kd_loss 0.9574 (0.9417) lr 1.3681e-03 eta 0:11:21
epoch [21/50] batch [40/167] time 0.089 (0.123) data 0.000 (0.008) loss 0.7493 (0.8046) ce_loss 0.3601 (0.4377) teacher_loss 0.2864 (0.3630) loss_zs_kd 0.0693 (0.0657) loss_oracle 0.4283 (0.4088) acc 84.3750 (82.8125) kd_loss 0.9776 (0.9318) lr 1.3681e-03 eta 0:10:12
epoch [21/50] batch [60/167] time 0.144 (0.122) data 0.001 (0.005) loss 0.6589 (0.7921) ce_loss 0.2556 (0.4280) teacher_loss 0.2357 (0.3543) loss_zs_kd 0.0703 (0.0674) loss_oracle 0.3880 (0.4042) acc 90.6250 (83.5417) kd_loss 0.9938 (0.9378) lr 1.3681e-03 eta 0:10:03
epoch [21/50] batch [80/167] time 0.115 (0.122) data 0.000 (0.004) loss 0.7554 (0.7788) ce_loss 0.3967 (0.4147) teacher_loss 0.2809 (0.3489) loss_zs_kd 0.0861 (0.0677) loss_oracle 0.4314 (0.3961) acc 84.3750 (84.2578) kd_loss 1.0557 (0.9553) lr 1.3681e-03 eta 0:09:59
epoch [21/50] batch [100/167] time 0.137 (0.120) data 0.000 (0.003) loss 0.7559 (0.7775) ce_loss 0.3601 (0.4173) teacher_loss 0.3148 (0.3525) loss_zs_kd 0.0773 (0.0687) loss_oracle 0.4024 (0.3906) acc 87.5000 (84.2500) kd_loss 1.1095 (0.9736) lr 1.3681e-03 eta 0:09:47
epoch [21/50] batch [120/167] time 0.145 (0.118) data 0.000 (0.003) loss 0.7391 (0.7738) ce_loss 0.4351 (0.4168) teacher_loss 0.3391 (0.3536) loss_zs_kd 0.0870 (0.0685) loss_oracle 0.3565 (0.3859) acc 81.2500 (84.2969) kd_loss 1.0323 (0.9919) lr 1.3681e-03 eta 0:09:38
epoch [21/50] batch [140/167] time 0.134 (0.117) data 0.000 (0.002) loss 0.6652 (0.7704) ce_loss 0.4292 (0.4171) teacher_loss 0.2735 (0.3539) loss_zs_kd 0.0665 (0.0679) loss_oracle 0.3584 (0.3825) acc 87.5000 (84.3527) kd_loss 1.1239 (1.0071) lr 1.3681e-03 eta 0:09:29
epoch [21/50] batch [160/167] time 0.129 (0.116) data 0.000 (0.002) loss 0.6980 (0.7724) ce_loss 0.4551 (0.4181) teacher_loss 0.2883 (0.3544) loss_zs_kd 0.0874 (0.0670) loss_oracle 0.3660 (0.3844) acc 81.2500 (84.2188) kd_loss 1.0778 (1.0166) lr 1.3681e-03 eta 0:09:23
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,179
* accuracy: 94.9%
* error: 5.1%
* macro_f1: 95.4%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.7%, epoch: 18 *******
******* Domain c best val test acc: 99.0%, epoch: 18 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [22/50] batch [20/167] time 0.090 (0.132) data 0.000 (0.013) loss 0.8405 (0.7460) ce_loss 0.5010 (0.3976) teacher_loss 0.3686 (0.3051) loss_zs_kd 0.0927 (0.0759) loss_oracle 0.4255 (0.4029) acc 81.2500 (85.3125) kd_loss 1.1123 (1.0756) lr 1.3090e-03 eta 0:10:34
epoch [22/50] batch [40/167] time 0.132 (0.120) data 0.000 (0.007) loss 0.7325 (0.7714) ce_loss 0.4756 (0.4134) teacher_loss 0.3672 (0.3196) loss_zs_kd 0.0797 (0.0735) loss_oracle 0.3255 (0.4151) acc 81.2500 (84.3750) kd_loss 1.0502 (1.0691) lr 1.3090e-03 eta 0:09:35
epoch [22/50] batch [60/167] time 0.074 (0.127) data 0.001 (0.005) loss 0.5778 (0.7638) ce_loss 0.1711 (0.3980) teacher_loss 0.1102 (0.3080) loss_zs_kd 0.0515 (0.0726) loss_oracle 0.4418 (0.4195) acc 90.6250 (85.0521) kd_loss 1.0549 (1.0667) lr 1.3090e-03 eta 0:10:08
epoch [22/50] batch [80/167] time 0.134 (0.134) data 0.000 (0.003) loss 0.7699 (0.7816) ce_loss 0.3550 (0.4101) teacher_loss 0.2696 (0.3148) loss_zs_kd 0.0804 (0.0741) loss_oracle 0.4601 (0.4297) acc 84.3750 (84.3750) kd_loss 1.0284 (1.0597) lr 1.3090e-03 eta 0:10:38
epoch [22/50] batch [100/167] time 0.085 (0.130) data 0.000 (0.003) loss 0.6106 (0.7788) ce_loss 0.1898 (0.3929) teacher_loss 0.1443 (0.3004) loss_zs_kd 0.0556 (0.0745) loss_oracle 0.4385 (0.4412) acc 93.7500 (85.3125) kd_loss 1.0807 (1.0540) lr 1.3090e-03 eta 0:10:18
epoch [22/50] batch [120/167] time 0.082 (0.125) data 0.000 (0.002) loss 0.8055 (0.7830) ce_loss 0.5396 (0.4018) teacher_loss 0.3840 (0.3052) loss_zs_kd 0.0910 (0.0747) loss_oracle 0.3760 (0.4405) acc 84.3750 (85.2083) kd_loss 0.9672 (1.0518) lr 1.3090e-03 eta 0:09:49
epoch [22/50] batch [140/167] time 0.084 (0.123) data 0.000 (0.002) loss 0.9178 (0.7854) ce_loss 0.5771 (0.4033) teacher_loss 0.4015 (0.3036) loss_zs_kd 0.1154 (0.0761) loss_oracle 0.4586 (0.4437) acc 75.0000 (85.3348) kd_loss 1.0447 (1.0481) lr 1.3090e-03 eta 0:09:37
epoch [22/50] batch [160/167] time 0.076 (0.120) data 0.000 (0.002) loss 0.9041 (0.7939) ce_loss 0.3640 (0.4094) teacher_loss 0.3018 (0.3089) loss_zs_kd 0.0779 (0.0772) loss_oracle 0.5633 (0.4464) acc 90.6250 (85.0586) kd_loss 1.0043 (1.0459) lr 1.3090e-03 eta 0:09:23
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,196
* accuracy: 95.6%
* error: 4.4%
* macro_f1: 96.1%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.7%, epoch: 18 *******
******* Domain c best val test acc: 99.0%, epoch: 18 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [23/50] batch [20/167] time 0.074 (0.116) data 0.000 (0.013) loss 0.8498 (0.8548) ce_loss 0.3376 (0.4206) teacher_loss 0.2647 (0.2952) loss_zs_kd 0.1115 (0.1056) loss_oracle 0.5294 (0.5068) acc 87.5000 (83.5938) kd_loss 1.0595 (1.0246) lr 1.2487e-03 eta 0:09:01
epoch [23/50] batch [40/167] time 0.128 (0.109) data 0.000 (0.006) loss 0.8656 (0.8317) ce_loss 0.3982 (0.3983) teacher_loss 0.3007 (0.2746) loss_zs_kd 0.0863 (0.0986) loss_oracle 0.5218 (0.5078) acc 87.5000 (85.0781) kd_loss 0.9787 (1.0275) lr 1.2487e-03 eta 0:08:24
epoch [23/50] batch [60/167] time 0.089 (0.107) data 0.001 (0.004) loss 0.8192 (0.8421) ce_loss 0.3362 (0.4174) teacher_loss 0.2236 (0.2906) loss_zs_kd 0.0870 (0.0973) loss_oracle 0.5520 (0.5029) acc 87.5000 (84.9479) kd_loss 1.0297 (1.0247) lr 1.2487e-03 eta 0:08:13
epoch [23/50] batch [80/167] time 0.075 (0.107) data 0.000 (0.003) loss 1.1939 (0.8591) ce_loss 0.7935 (0.4316) teacher_loss 0.6590 (0.3112) loss_zs_kd 0.0750 (0.0926) loss_oracle 0.4974 (0.5016) acc 75.0000 (83.9844) kd_loss 1.0615 (1.0294) lr 1.2487e-03 eta 0:08:10
epoch [23/50] batch [100/167] time 0.082 (0.108) data 0.000 (0.003) loss 0.9319 (0.8524) ce_loss 0.5503 (0.4219) teacher_loss 0.4414 (0.3129) loss_zs_kd 0.0568 (0.0870) loss_oracle 0.4621 (0.4960) acc 81.2500 (84.2812) kd_loss 1.0526 (1.0347) lr 1.2487e-03 eta 0:08:12
epoch [23/50] batch [120/167] time 0.135 (0.108) data 0.000 (0.002) loss 0.7773 (0.8579) ce_loss 0.2988 (0.4252) teacher_loss 0.2060 (0.3256) loss_zs_kd 0.0519 (0.0829) loss_oracle 0.5453 (0.4909) acc 87.5000 (84.1146) kd_loss 1.0594 (1.0385) lr 1.2487e-03 eta 0:08:11
epoch [23/50] batch [140/167] time 0.090 (0.108) data 0.000 (0.002) loss 0.9992 (0.8603) ce_loss 0.6675 (0.4239) teacher_loss 0.4556 (0.3288) loss_zs_kd 0.1021 (0.0791) loss_oracle 0.4925 (0.4919) acc 81.2500 (84.0179) kd_loss 1.0526 (1.0404) lr 1.2487e-03 eta 0:08:10
epoch [23/50] batch [160/167] time 0.084 (0.108) data 0.000 (0.002) loss 0.7306 (0.8606) ce_loss 0.3330 (0.4306) teacher_loss 0.3200 (0.3417) loss_zs_kd 0.0548 (0.0767) loss_oracle 0.3831 (0.4806) acc 90.6250 (83.6914) kd_loss 1.0426 (1.0410) lr 1.2487e-03 eta 0:08:05
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,184
* accuracy: 95.1%
* error: 4.9%
* macro_f1: 95.6%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.7%, epoch: 18 *******
******* Domain c best val test acc: 99.0%, epoch: 18 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [24/50] batch [20/167] time 0.100 (0.133) data 0.000 (0.011) loss 0.9590 (0.8057) ce_loss 0.6392 (0.4003) teacher_loss 0.4820 (0.3399) loss_zs_kd 0.0669 (0.0532) loss_oracle 0.4436 (0.4392) acc 81.2500 (85.3125) kd_loss 1.0361 (1.0374) lr 1.1874e-03 eta 0:09:59
epoch [24/50] batch [40/167] time 0.091 (0.128) data 0.000 (0.005) loss 0.7373 (0.7921) ce_loss 0.4094 (0.4051) teacher_loss 0.3661 (0.3466) loss_zs_kd 0.0745 (0.0552) loss_oracle 0.3340 (0.4179) acc 81.2500 (85.0781) kd_loss 1.0077 (1.0336) lr 1.1874e-03 eta 0:09:33
epoch [24/50] batch [60/167] time 0.200 (0.124) data 0.000 (0.004) loss 0.8038 (0.7782) ce_loss 0.5889 (0.4184) teacher_loss 0.4733 (0.3588) loss_zs_kd 0.0675 (0.0562) loss_oracle 0.2968 (0.3912) acc 75.0000 (84.3750) kd_loss 1.0002 (1.0275) lr 1.1874e-03 eta 0:09:11
epoch [24/50] batch [80/167] time 0.080 (0.132) data 0.000 (0.003) loss 0.6065 (0.7553) ce_loss 0.3276 (0.4116) teacher_loss 0.2748 (0.3533) loss_zs_kd 0.0406 (0.0549) loss_oracle 0.3114 (0.3745) acc 90.6250 (84.6875) kd_loss 0.9975 (1.0217) lr 1.1874e-03 eta 0:09:45
epoch [24/50] batch [100/167] time 0.188 (0.141) data 0.000 (0.002) loss 0.5201 (0.7472) ce_loss 0.2072 (0.4122) teacher_loss 0.1500 (0.3521) loss_zs_kd 0.0241 (0.0544) loss_oracle 0.3580 (0.3679) acc 87.5000 (84.8125) kd_loss 0.9565 (1.0109) lr 1.1874e-03 eta 0:10:23
epoch [24/50] batch [120/167] time 0.144 (0.139) data 0.000 (0.002) loss 0.6588 (0.7402) ce_loss 0.3728 (0.4084) teacher_loss 0.2838 (0.3495) loss_zs_kd 0.0728 (0.0560) loss_oracle 0.3387 (0.3627) acc 87.5000 (84.7656) kd_loss 0.9733 (0.9990) lr 1.1874e-03 eta 0:10:11
epoch [24/50] batch [140/167] time 0.150 (0.139) data 0.000 (0.002) loss 1.0634 (0.7517) ce_loss 0.6567 (0.4067) teacher_loss 0.5072 (0.3488) loss_zs_kd 0.0812 (0.0580) loss_oracle 0.5156 (0.3738) acc 75.0000 (84.8884) kd_loss 0.8973 (0.9845) lr 1.1874e-03 eta 0:10:05
epoch [24/50] batch [160/167] time 0.135 (0.138) data 0.000 (0.002) loss 1.0404 (0.7722) ce_loss 0.4902 (0.4041) teacher_loss 0.4474 (0.3477) loss_zs_kd 0.0708 (0.0593) loss_oracle 0.5577 (0.3948) acc 81.2500 (84.9023) kd_loss 0.9589 (0.9763) lr 1.1874e-03 eta 0:09:59
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,199
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.2%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.7%, epoch: 18 *******
******* Domain c best val test acc: 99.0%, epoch: 18 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [25/50] batch [20/167] time 0.100 (0.129) data 0.000 (0.013) loss 0.9956 (1.0664) ce_loss 0.2834 (0.3902) teacher_loss 0.2120 (0.3554) loss_zs_kd 0.0635 (0.0823) loss_oracle 0.7519 (0.6699) acc 90.6250 (85.6250) kd_loss 0.9976 (0.9541) lr 1.1253e-03 eta 0:09:15
epoch [25/50] batch [40/167] time 0.143 (0.122) data 0.000 (0.007) loss 0.8459 (1.1044) ce_loss 0.1067 (0.3711) teacher_loss 0.1058 (0.3537) loss_zs_kd 0.0524 (0.0763) loss_oracle 0.7139 (0.7126) acc 100.0000 (86.3281) kd_loss 1.0005 (0.9746) lr 1.1253e-03 eta 0:08:45
epoch [25/50] batch [60/167] time 0.143 (0.118) data 0.001 (0.004) loss 1.1010 (1.1456) ce_loss 0.4092 (0.3876) teacher_loss 0.3309 (0.3673) loss_zs_kd 0.0598 (0.0743) loss_oracle 0.7403 (0.7412) acc 81.2500 (85.4688) kd_loss 0.9539 (0.9855) lr 1.1253e-03 eta 0:08:26
epoch [25/50] batch [80/167] time 0.093 (0.116) data 0.000 (0.003) loss 1.0523 (1.1281) ce_loss 0.3179 (0.3794) teacher_loss 0.2761 (0.3581) loss_zs_kd 0.0887 (0.0733) loss_oracle 0.7319 (0.7334) acc 90.6250 (85.7422) kd_loss 1.0010 (0.9812) lr 1.1253e-03 eta 0:08:15
epoch [25/50] batch [100/167] time 0.107 (0.115) data 0.000 (0.003) loss 1.0676 (1.1151) ce_loss 0.4473 (0.3848) teacher_loss 0.3747 (0.3554) loss_zs_kd 0.0921 (0.0727) loss_oracle 0.6468 (0.7233) acc 81.2500 (85.3750) kd_loss 0.9237 (0.9753) lr 1.1253e-03 eta 0:08:07
epoch [25/50] batch [120/167] time 0.141 (0.115) data 0.000 (0.002) loss 0.8966 (1.0887) ce_loss 0.3877 (0.3919) teacher_loss 0.3279 (0.3515) loss_zs_kd 0.0820 (0.0758) loss_oracle 0.5277 (0.6993) acc 81.2500 (84.8698) kd_loss 0.9243 (0.9665) lr 1.1253e-03 eta 0:08:06
epoch [25/50] batch [140/167] time 0.145 (0.119) data 0.000 (0.002) loss 0.6560 (1.0518) ce_loss 0.2974 (0.3886) teacher_loss 0.2354 (0.3431) loss_zs_kd 0.0584 (0.0789) loss_oracle 0.3914 (0.6693) acc 87.5000 (85.0000) kd_loss 0.9487 (0.9617) lr 1.1253e-03 eta 0:08:18
epoch [25/50] batch [160/167] time 0.117 (0.118) data 0.000 (0.002) loss 0.8003 (1.0235) ce_loss 0.4343 (0.3939) teacher_loss 0.3379 (0.3436) loss_zs_kd 0.0984 (0.0798) loss_oracle 0.4132 (0.6400) acc 81.2500 (84.9023) kd_loss 0.9509 (0.9613) lr 1.1253e-03 eta 0:08:15
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,201
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.3%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [26/50] batch [20/167] time 0.079 (0.119) data 0.000 (0.013) loss 0.6328 (0.7073) ce_loss 0.2886 (0.3612) teacher_loss 0.2512 (0.3069) loss_zs_kd 0.0581 (0.0832) loss_oracle 0.3525 (0.3588) acc 87.5000 (86.8750) kd_loss 0.9781 (0.9622) lr 1.0628e-03 eta 0:08:13
epoch [26/50] batch [40/167] time 0.185 (0.143) data 0.000 (0.007) loss 0.7402 (0.7231) ce_loss 0.3516 (0.3804) teacher_loss 0.3167 (0.3194) loss_zs_kd 0.0957 (0.0857) loss_oracle 0.3756 (0.3609) acc 87.5000 (86.4062) kd_loss 0.9124 (0.9594) lr 1.0628e-03 eta 0:09:50
epoch [26/50] batch [60/167] time 0.186 (0.137) data 0.001 (0.005) loss 0.7502 (0.7430) ce_loss 0.4072 (0.3936) teacher_loss 0.2828 (0.3178) loss_zs_kd 0.0988 (0.0900) loss_oracle 0.4180 (0.3802) acc 84.3750 (85.7292) kd_loss 0.8848 (0.9578) lr 1.0628e-03 eta 0:09:22
epoch [26/50] batch [80/167] time 0.106 (0.138) data 0.000 (0.003) loss 0.6828 (0.7414) ce_loss 0.3682 (0.3945) teacher_loss 0.2570 (0.3095) loss_zs_kd 0.1102 (0.0937) loss_oracle 0.3707 (0.3851) acc 87.5000 (85.7031) kd_loss 0.9452 (0.9584) lr 1.0628e-03 eta 0:09:23
epoch [26/50] batch [100/167] time 0.118 (0.131) data 0.000 (0.003) loss 0.7937 (0.7476) ce_loss 0.5098 (0.3993) teacher_loss 0.3179 (0.3083) loss_zs_kd 0.1104 (0.0967) loss_oracle 0.4206 (0.3910) acc 84.3750 (85.1562) kd_loss 1.0064 (0.9604) lr 1.0628e-03 eta 0:08:52
epoch [26/50] batch [120/167] time 0.086 (0.126) data 0.000 (0.002) loss 0.7627 (0.7478) ce_loss 0.5005 (0.4021) teacher_loss 0.3300 (0.3062) loss_zs_kd 0.0915 (0.0977) loss_oracle 0.3869 (0.3927) acc 81.2500 (85.2344) kd_loss 0.9923 (0.9638) lr 1.0628e-03 eta 0:08:30
epoch [26/50] batch [140/167] time 0.084 (0.123) data 0.000 (0.002) loss 0.8194 (0.7379) ce_loss 0.5161 (0.3950) teacher_loss 0.3173 (0.2947) loss_zs_kd 0.1447 (0.1001) loss_oracle 0.4297 (0.3932) acc 84.3750 (85.7143) kd_loss 1.0063 (0.9663) lr 1.0628e-03 eta 0:08:15
epoch [26/50] batch [160/167] time 0.109 (0.120) data 0.000 (0.002) loss 0.8363 (0.7399) ce_loss 0.3950 (0.3980) teacher_loss 0.2601 (0.2912) loss_zs_kd 0.1483 (0.1028) loss_oracle 0.5020 (0.3973) acc 84.3750 (85.6836) kd_loss 1.0079 (0.9686) lr 1.0628e-03 eta 0:08:03
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,205
* accuracy: 96.0%
* error: 4.0%
* macro_f1: 96.4%
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [27/50] batch [20/167] time 0.082 (0.133) data 0.000 (0.015) loss 0.8549 (0.7495) ce_loss 0.4568 (0.3661) teacher_loss 0.2702 (0.2447) loss_zs_kd 0.2406 (0.1305) loss_oracle 0.4644 (0.4396) acc 84.3750 (86.7188) kd_loss 0.9814 (0.9924) lr 1.0000e-03 eta 0:08:49
epoch [27/50] batch [40/167] time 0.132 (0.119) data 0.000 (0.007) loss 0.6114 (0.7742) ce_loss 0.1697 (0.4015) teacher_loss 0.0863 (0.2617) loss_zs_kd 0.0980 (0.1271) loss_oracle 0.4761 (0.4490) acc 90.6250 (84.6094) kd_loss 0.9329 (0.9858) lr 1.0000e-03 eta 0:07:53
epoch [27/50] batch [60/167] time 0.095 (0.114) data 0.000 (0.005) loss 0.9121 (0.7792) ce_loss 0.5347 (0.4143) teacher_loss 0.2807 (0.2655) loss_zs_kd 0.1737 (0.1229) loss_oracle 0.5445 (0.4523) acc 75.0000 (84.6875) kd_loss 0.9822 (0.9818) lr 1.0000e-03 eta 0:07:28
epoch [27/50] batch [80/167] time 0.133 (0.113) data 0.000 (0.004) loss 0.6567 (0.7776) ce_loss 0.1759 (0.3996) teacher_loss 0.1014 (0.2526) loss_zs_kd 0.1073 (0.1245) loss_oracle 0.5016 (0.4627) acc 96.8750 (85.0391) kd_loss 1.0124 (0.9808) lr 1.0000e-03 eta 0:07:25
epoch [27/50] batch [100/167] time 0.115 (0.113) data 0.000 (0.003) loss 0.5785 (0.7839) ce_loss 0.0618 (0.4032) teacher_loss 0.0312 (0.2490) loss_zs_kd 0.0840 (0.1245) loss_oracle 0.5053 (0.4727) acc 100.0000 (84.8750) kd_loss 0.9789 (0.9826) lr 1.0000e-03 eta 0:07:21
epoch [27/50] batch [120/167] time 0.135 (0.112) data 0.000 (0.003) loss 0.7901 (0.7875) ce_loss 0.2161 (0.3962) teacher_loss 0.1714 (0.2434) loss_zs_kd 0.0781 (0.1244) loss_oracle 0.5796 (0.4819) acc 90.6250 (85.2604) kd_loss 1.0003 (0.9839) lr 1.0000e-03 eta 0:07:16
epoch [27/50] batch [140/167] time 0.086 (0.111) data 0.000 (0.002) loss 0.7412 (0.7908) ce_loss 0.2390 (0.3942) teacher_loss 0.1570 (0.2402) loss_zs_kd 0.1175 (0.1236) loss_oracle 0.5254 (0.4888) acc 90.6250 (85.4018) kd_loss 0.9805 (0.9858) lr 1.0000e-03 eta 0:07:10
epoch [27/50] batch [160/167] time 0.079 (0.110) data 0.000 (0.002) loss 0.7465 (0.7988) ce_loss 0.2690 (0.3941) teacher_loss 0.2017 (0.2391) loss_zs_kd 0.1160 (0.1246) loss_oracle 0.4868 (0.4974) acc 90.6250 (85.4297) kd_loss 1.0037 (0.9884) lr 1.0000e-03 eta 0:07:04
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,190
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,319
* accuracy: 98.9%
* error: 1.1%
* macro_f1: 99.0%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [28/50] batch [20/167] time 0.132 (0.119) data 0.000 (0.014) loss 0.8062 (0.8526) ce_loss 0.4382 (0.3920) teacher_loss 0.1945 (0.2266) loss_zs_kd 0.1192 (0.1173) loss_oracle 0.5521 (0.5673) acc 81.2500 (85.6250) kd_loss 1.0492 (1.0010) lr 9.3721e-04 eta 0:07:35
epoch [28/50] batch [40/167] time 0.082 (0.111) data 0.000 (0.007) loss 0.9566 (0.8740) ce_loss 0.4072 (0.3934) teacher_loss 0.2832 (0.2309) loss_zs_kd 0.1137 (0.1229) loss_oracle 0.6166 (0.5817) acc 84.3750 (85.3906) kd_loss 1.0068 (0.9927) lr 9.3721e-04 eta 0:07:01
epoch [28/50] batch [60/167] time 0.063 (0.130) data 0.000 (0.005) loss 0.8499 (0.8777) ce_loss 0.4255 (0.3931) teacher_loss 0.2662 (0.2344) loss_zs_kd 0.0725 (0.1213) loss_oracle 0.5474 (0.5826) acc 81.2500 (85.3125) kd_loss 0.9880 (0.9891) lr 9.3721e-04 eta 0:08:11
epoch [28/50] batch [80/167] time 0.200 (0.134) data 0.000 (0.004) loss 0.8207 (0.8756) ce_loss 0.4270 (0.3973) teacher_loss 0.2149 (0.2375) loss_zs_kd 0.1491 (0.1236) loss_oracle 0.5313 (0.5763) acc 87.5000 (84.9219) kd_loss 1.0035 (0.9880) lr 9.3721e-04 eta 0:08:23
epoch [28/50] batch [100/167] time 0.081 (0.132) data 0.000 (0.003) loss 0.9372 (0.8698) ce_loss 0.3635 (0.3870) teacher_loss 0.2813 (0.2310) loss_zs_kd 0.1156 (0.1235) loss_oracle 0.5980 (0.5771) acc 90.6250 (85.4688) kd_loss 0.9991 (0.9868) lr 9.3721e-04 eta 0:08:15
epoch [28/50] batch [120/167] time 0.091 (0.125) data 0.000 (0.002) loss 0.9340 (0.8767) ce_loss 0.4041 (0.3983) teacher_loss 0.3107 (0.2353) loss_zs_kd 0.0964 (0.1259) loss_oracle 0.5751 (0.5785) acc 84.3750 (85.3125) kd_loss 0.9875 (0.9874) lr 9.3721e-04 eta 0:07:43
epoch [28/50] batch [140/167] time 0.076 (0.117) data 0.000 (0.002) loss 0.8876 (0.8754) ce_loss 0.4761 (0.3928) teacher_loss 0.2229 (0.2301) loss_zs_kd 0.1303 (0.1262) loss_oracle 0.5996 (0.5822) acc 81.2500 (85.6027) kd_loss 0.9513 (0.9856) lr 9.3721e-04 eta 0:07:13
epoch [28/50] batch [160/167] time 0.065 (0.112) data 0.000 (0.002) loss 0.9090 (0.8736) ce_loss 0.4431 (0.3936) teacher_loss 0.2474 (0.2292) loss_zs_kd 0.1295 (0.1260) loss_oracle 0.5968 (0.5814) acc 84.3750 (85.4688) kd_loss 1.0124 (0.9850) lr 9.3721e-04 eta 0:06:51
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,193
* accuracy: 95.5%
* error: 4.5%
* macro_f1: 96.0%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [29/50] batch [20/167] time 0.091 (0.131) data 0.000 (0.014) loss 0.8802 (0.8717) ce_loss 0.3645 (0.4143) teacher_loss 0.2217 (0.2198) loss_zs_kd 0.1157 (0.1361) loss_oracle 0.6006 (0.5839) acc 87.5000 (85.1562) kd_loss 0.9841 (0.9615) lr 8.7467e-04 eta 0:07:58
epoch [29/50] batch [40/167] time 0.114 (0.131) data 0.000 (0.007) loss 0.9248 (0.8444) ce_loss 0.4883 (0.3915) teacher_loss 0.2325 (0.2167) loss_zs_kd 0.1823 (0.1339) loss_oracle 0.6011 (0.5608) acc 78.1250 (85.2344) kd_loss 0.9884 (0.9653) lr 8.7467e-04 eta 0:07:55
epoch [29/50] batch [60/167] time 0.105 (0.127) data 0.001 (0.005) loss 0.9112 (0.8452) ce_loss 0.4507 (0.3962) teacher_loss 0.2499 (0.2197) loss_zs_kd 0.1569 (0.1321) loss_oracle 0.5828 (0.5594) acc 84.3750 (85.0521) kd_loss 0.9829 (0.9686) lr 8.7467e-04 eta 0:07:37
epoch [29/50] batch [80/167] time 0.088 (0.125) data 0.000 (0.004) loss 0.6521 (0.8409) ce_loss 0.1642 (0.3922) teacher_loss 0.1054 (0.2198) loss_zs_kd 0.0514 (0.1269) loss_oracle 0.5211 (0.5576) acc 96.8750 (85.0391) kd_loss 0.9578 (0.9662) lr 8.7467e-04 eta 0:07:30
epoch [29/50] batch [100/167] time 0.137 (0.125) data 0.000 (0.003) loss 1.0782 (0.8366) ce_loss 0.7104 (0.3997) teacher_loss 0.4233 (0.2213) loss_zs_kd 0.1868 (0.1270) loss_oracle 0.5615 (0.5518) acc 75.0000 (84.9062) kd_loss 0.9741 (0.9653) lr 8.7467e-04 eta 0:07:25
epoch [29/50] batch [120/167] time 0.119 (0.124) data 0.000 (0.003) loss 0.9142 (0.8364) ce_loss 0.4438 (0.4029) teacher_loss 0.2165 (0.2197) loss_zs_kd 0.1835 (0.1296) loss_oracle 0.6059 (0.5519) acc 84.3750 (84.8177) kd_loss 0.9770 (0.9660) lr 8.7467e-04 eta 0:07:19
epoch [29/50] batch [140/167] time 0.097 (0.121) data 0.000 (0.002) loss 0.8400 (0.8398) ce_loss 0.4490 (0.4080) teacher_loss 0.2265 (0.2222) loss_zs_kd 0.1264 (0.1305) loss_oracle 0.5503 (0.5523) acc 84.3750 (84.8661) kd_loss 0.9672 (0.9653) lr 8.7467e-04 eta 0:07:08
epoch [29/50] batch [160/167] time 0.079 (0.119) data 0.000 (0.002) loss 0.7734 (0.8414) ce_loss 0.2505 (0.4132) teacher_loss 0.1149 (0.2249) loss_zs_kd 0.1346 (0.1318) loss_oracle 0.5912 (0.5505) acc 90.6250 (84.5898) kd_loss 0.9883 (0.9636) lr 8.7467e-04 eta 0:06:57
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,190
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [30/50] batch [20/167] time 0.121 (0.136) data 0.000 (0.014) loss 0.7310 (0.8341) ce_loss 0.2778 (0.4348) teacher_loss 0.1177 (0.2299) loss_zs_kd 0.1384 (0.1321) loss_oracle 0.5441 (0.5381) acc 90.6250 (84.5312) kd_loss 0.9730 (0.9570) lr 8.1262e-04 eta 0:07:54
epoch [30/50] batch [40/167] time 0.141 (0.127) data 0.000 (0.007) loss 0.9178 (0.8347) ce_loss 0.5073 (0.4370) teacher_loss 0.2487 (0.2191) loss_zs_kd 0.1402 (0.1351) loss_oracle 0.5990 (0.5480) acc 84.3750 (83.6719) kd_loss 0.9596 (0.9528) lr 8.1262e-04 eta 0:07:21
epoch [30/50] batch [60/167] time 0.136 (0.124) data 0.000 (0.005) loss 0.8696 (0.8261) ce_loss 0.4021 (0.4292) teacher_loss 0.2117 (0.2083) loss_zs_kd 0.1576 (0.1377) loss_oracle 0.5791 (0.5490) acc 81.2500 (84.0625) kd_loss 0.9827 (0.9552) lr 8.1262e-04 eta 0:07:08
epoch [30/50] batch [80/167] time 0.144 (0.124) data 0.000 (0.004) loss 0.8661 (0.8287) ce_loss 0.5151 (0.4327) teacher_loss 0.2240 (0.2174) loss_zs_kd 0.1903 (0.1396) loss_oracle 0.5469 (0.5415) acc 84.3750 (83.8672) kd_loss 0.9695 (0.9484) lr 8.1262e-04 eta 0:07:05
epoch [30/50] batch [100/167] time 0.134 (0.123) data 0.000 (0.003) loss 0.7838 (0.8201) ce_loss 0.4302 (0.4358) teacher_loss 0.2416 (0.2211) loss_zs_kd 0.1469 (0.1362) loss_oracle 0.4688 (0.5308) acc 84.3750 (83.6250) kd_loss 0.9111 (0.9455) lr 8.1262e-04 eta 0:06:59
epoch [30/50] batch [120/167] time 0.082 (0.121) data 0.000 (0.003) loss 0.9968 (0.8218) ce_loss 0.5811 (0.4393) teacher_loss 0.3482 (0.2273) loss_zs_kd 0.1671 (0.1367) loss_oracle 0.5650 (0.5262) acc 78.1250 (83.3594) kd_loss 0.9415 (0.9430) lr 8.1262e-04 eta 0:06:48
epoch [30/50] batch [140/167] time 0.188 (0.126) data 0.000 (0.002) loss 0.7474 (0.8219) ce_loss 0.3777 (0.4418) teacher_loss 0.1597 (0.2308) loss_zs_kd 0.1889 (0.1354) loss_oracle 0.4933 (0.5233) acc 84.3750 (83.4821) kd_loss 0.9262 (0.9406) lr 8.1262e-04 eta 0:07:03
epoch [30/50] batch [160/167] time 0.172 (0.123) data 0.000 (0.002) loss 0.9143 (0.8184) ce_loss 0.4722 (0.4346) teacher_loss 0.3561 (0.2317) loss_zs_kd 0.0790 (0.1338) loss_oracle 0.5187 (0.5198) acc 81.2500 (83.7695) kd_loss 0.9414 (0.9367) lr 8.1262e-04 eta 0:06:50
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,185
* accuracy: 95.1%
* error: 4.9%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [31/50] batch [20/167] time 0.152 (0.143) data 0.000 (0.017) loss 0.6633 (0.7565) ce_loss 0.2155 (0.3852) teacher_loss 0.1359 (0.2199) loss_zs_kd 0.0968 (0.1069) loss_oracle 0.4790 (0.4831) acc 93.7500 (85.7812) kd_loss 0.8943 (0.9279) lr 7.5131e-04 eta 0:07:53
epoch [31/50] batch [40/167] time 0.145 (0.130) data 0.000 (0.009) loss 0.8204 (0.7743) ce_loss 0.4319 (0.4023) teacher_loss 0.2274 (0.2219) loss_zs_kd 0.1866 (0.1156) loss_oracle 0.4997 (0.4946) acc 87.5000 (84.8438) kd_loss 0.9694 (0.9365) lr 7.5131e-04 eta 0:07:10
epoch [31/50] batch [60/167] time 0.118 (0.126) data 0.001 (0.006) loss 0.6129 (0.7831) ce_loss 0.1962 (0.3986) teacher_loss 0.0944 (0.2109) loss_zs_kd 0.1005 (0.1234) loss_oracle 0.4682 (0.5105) acc 93.7500 (84.9479) kd_loss 0.9506 (0.9418) lr 7.5131e-04 eta 0:06:52
epoch [31/50] batch [80/167] time 0.081 (0.123) data 0.000 (0.004) loss 0.5977 (0.7750) ce_loss 0.1829 (0.3960) teacher_loss 0.0954 (0.2096) loss_zs_kd 0.1350 (0.1223) loss_oracle 0.4348 (0.5043) acc 93.7500 (85.1953) kd_loss 0.9386 (0.9398) lr 7.5131e-04 eta 0:06:40
epoch [31/50] batch [100/167] time 0.107 (0.122) data 0.000 (0.004) loss 0.5776 (0.7685) ce_loss 0.1791 (0.3853) teacher_loss 0.0651 (0.2043) loss_zs_kd 0.0719 (0.1225) loss_oracle 0.4765 (0.5029) acc 93.7500 (85.8438) kd_loss 0.8891 (0.9409) lr 7.5131e-04 eta 0:06:35
epoch [31/50] batch [120/167] time 0.122 (0.122) data 0.000 (0.003) loss 0.6888 (0.7760) ce_loss 0.2338 (0.3964) teacher_loss 0.1249 (0.2099) loss_zs_kd 0.0884 (0.1236) loss_oracle 0.5197 (0.5043) acc 93.7500 (85.4427) kd_loss 0.9195 (0.9429) lr 7.5131e-04 eta 0:06:33
epoch [31/50] batch [140/167] time 0.117 (0.121) data 0.000 (0.003) loss 0.8063 (0.7784) ce_loss 0.5635 (0.4054) teacher_loss 0.3168 (0.2134) loss_zs_kd 0.1227 (0.1265) loss_oracle 0.4281 (0.5017) acc 75.0000 (84.9554) kd_loss 0.9127 (0.9422) lr 7.5131e-04 eta 0:06:28
epoch [31/50] batch [160/167] time 0.080 (0.119) data 0.000 (0.002) loss 0.8466 (0.7772) ce_loss 0.5161 (0.4046) teacher_loss 0.2723 (0.2149) loss_zs_kd 0.1369 (0.1269) loss_oracle 0.5058 (0.4988) acc 81.2500 (84.9219) kd_loss 0.9317 (0.9413) lr 7.5131e-04 eta 0:06:19
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,188
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [32/50] batch [20/167] time 0.139 (0.127) data 0.000 (0.011) loss 0.7580 (0.7350) ce_loss 0.4214 (0.3628) teacher_loss 0.2763 (0.2026) loss_zs_kd 0.0689 (0.1069) loss_oracle 0.4474 (0.4789) acc 84.3750 (85.9375) kd_loss 0.9483 (0.9326) lr 6.9098e-04 eta 0:06:41
epoch [32/50] batch [40/167] time 0.134 (0.120) data 0.000 (0.006) loss 0.6779 (0.7536) ce_loss 0.2866 (0.3837) teacher_loss 0.1911 (0.2174) loss_zs_kd 0.1053 (0.1140) loss_oracle 0.4342 (0.4792) acc 84.3750 (85.7812) kd_loss 0.9023 (0.9318) lr 6.9098e-04 eta 0:06:16
epoch [32/50] batch [60/167] time 0.107 (0.118) data 0.000 (0.004) loss 0.7900 (0.7654) ce_loss 0.3557 (0.3933) teacher_loss 0.1958 (0.2239) loss_zs_kd 0.1328 (0.1189) loss_oracle 0.5278 (0.4820) acc 90.6250 (85.6771) kd_loss 0.9259 (0.9324) lr 6.9098e-04 eta 0:06:06
epoch [32/50] batch [80/167] time 0.139 (0.116) data 0.000 (0.003) loss 0.9292 (0.7633) ce_loss 0.5210 (0.3896) teacher_loss 0.3156 (0.2190) loss_zs_kd 0.1778 (0.1192) loss_oracle 0.5246 (0.4847) acc 78.1250 (85.2734) kd_loss 0.9620 (0.9339) lr 6.9098e-04 eta 0:05:59
epoch [32/50] batch [100/167] time 0.131 (0.115) data 0.000 (0.003) loss 0.7775 (0.7698) ce_loss 0.3674 (0.4012) teacher_loss 0.1998 (0.2261) loss_zs_kd 0.1634 (0.1218) loss_oracle 0.4960 (0.4828) acc 81.2500 (84.9062) kd_loss 0.9055 (0.9315) lr 6.9098e-04 eta 0:05:51
epoch [32/50] batch [120/167] time 0.098 (0.114) data 0.000 (0.002) loss 0.6233 (0.7668) ce_loss 0.2239 (0.4027) teacher_loss 0.1372 (0.2238) loss_zs_kd 0.0916 (0.1243) loss_oracle 0.4403 (0.4808) acc 90.6250 (84.7135) kd_loss 0.8587 (0.9269) lr 6.9098e-04 eta 0:05:48
epoch [32/50] batch [140/167] time 0.177 (0.113) data 0.000 (0.002) loss 0.9397 (0.7648) ce_loss 0.5166 (0.4005) teacher_loss 0.4653 (0.2221) loss_zs_kd 0.1393 (0.1240) loss_oracle 0.4047 (0.4807) acc 84.3750 (85.0223) kd_loss 0.8928 (0.9255) lr 6.9098e-04 eta 0:05:42
epoch [32/50] batch [160/167] time 0.059 (0.118) data 0.000 (0.002) loss 0.6973 (0.7643) ce_loss 0.3208 (0.4015) teacher_loss 0.1655 (0.2238) loss_zs_kd 0.0774 (0.1226) loss_oracle 0.4931 (0.4793) acc 90.6250 (85.0195) kd_loss 0.9618 (0.9252) lr 6.9098e-04 eta 0:05:55
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,190
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.9%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [33/50] batch [20/167] time 0.140 (0.127) data 0.000 (0.013) loss 0.7724 (0.7324) ce_loss 0.3757 (0.3688) teacher_loss 0.2218 (0.1960) loss_zs_kd 0.1476 (0.1231) loss_oracle 0.4768 (0.4748) acc 93.7500 (86.0938) kd_loss 0.9064 (0.9141) lr 6.3188e-04 eta 0:06:20
epoch [33/50] batch [40/167] time 0.101 (0.123) data 0.000 (0.007) loss 0.8725 (0.7305) ce_loss 0.5186 (0.3558) teacher_loss 0.2599 (0.1806) loss_zs_kd 0.1640 (0.1261) loss_oracle 0.5306 (0.4868) acc 81.2500 (86.5625) kd_loss 0.9864 (0.9191) lr 6.3188e-04 eta 0:06:05
epoch [33/50] batch [60/167] time 0.094 (0.118) data 0.000 (0.004) loss 0.9217 (0.7567) ce_loss 0.6187 (0.3898) teacher_loss 0.2985 (0.1994) loss_zs_kd 0.1775 (0.1268) loss_oracle 0.5344 (0.4939) acc 78.1250 (85.6771) kd_loss 0.8850 (0.9304) lr 6.3188e-04 eta 0:05:47
epoch [33/50] batch [80/167] time 0.092 (0.119) data 0.000 (0.003) loss 0.7581 (0.7652) ce_loss 0.4910 (0.3939) teacher_loss 0.2311 (0.2086) loss_zs_kd 0.1400 (0.1275) loss_oracle 0.4570 (0.4929) acc 81.2500 (85.7031) kd_loss 0.9356 (0.9308) lr 6.3188e-04 eta 0:05:47
epoch [33/50] batch [100/167] time 0.134 (0.119) data 0.000 (0.003) loss 0.7361 (0.7619) ce_loss 0.3708 (0.3948) teacher_loss 0.1689 (0.2090) loss_zs_kd 0.1055 (0.1263) loss_oracle 0.5145 (0.4897) acc 87.5000 (85.6562) kd_loss 0.9455 (0.9289) lr 6.3188e-04 eta 0:05:46
epoch [33/50] batch [120/167] time 0.150 (0.120) data 0.000 (0.002) loss 0.6182 (0.7569) ce_loss 0.2947 (0.3934) teacher_loss 0.0790 (0.2049) loss_zs_kd 0.1258 (0.1252) loss_oracle 0.4763 (0.4895) acc 87.5000 (85.4688) kd_loss 0.8782 (0.9252) lr 6.3188e-04 eta 0:05:46
epoch [33/50] batch [140/167] time 0.118 (0.119) data 0.000 (0.002) loss 0.7342 (0.7679) ce_loss 0.2932 (0.4039) teacher_loss 0.1309 (0.2114) loss_zs_kd 0.1194 (0.1290) loss_oracle 0.5436 (0.4920) acc 90.6250 (85.1339) kd_loss 0.9160 (0.9219) lr 6.3188e-04 eta 0:05:40
epoch [33/50] batch [160/167] time 0.120 (0.118) data 0.000 (0.002) loss 0.7695 (0.7656) ce_loss 0.3901 (0.3988) teacher_loss 0.1837 (0.2100) loss_zs_kd 0.1318 (0.1273) loss_oracle 0.5198 (0.4920) acc 81.2500 (85.3125) kd_loss 0.9523 (0.9202) lr 6.3188e-04 eta 0:05:36
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,187
* accuracy: 95.2%
* error: 4.8%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [34/50] batch [20/167] time 0.097 (0.121) data 0.000 (0.011) loss 0.8867 (0.7520) ce_loss 0.6694 (0.4300) teacher_loss 0.3819 (0.2206) loss_zs_kd 0.0812 (0.1126) loss_oracle 0.4642 (0.4751) acc 81.2500 (82.6562) kd_loss 0.8442 (0.9033) lr 5.7422e-04 eta 0:05:41
epoch [34/50] batch [40/167] time 0.146 (0.117) data 0.000 (0.006) loss 0.9992 (0.7582) ce_loss 0.7202 (0.4115) teacher_loss 0.3788 (0.2217) loss_zs_kd 0.1404 (0.1210) loss_oracle 0.5501 (0.4761) acc 71.8750 (83.5156) kd_loss 0.8937 (0.8978) lr 5.7422e-04 eta 0:05:26
epoch [34/50] batch [60/167] time 0.139 (0.115) data 0.000 (0.004) loss 0.7162 (0.7578) ce_loss 0.2612 (0.4006) teacher_loss 0.1669 (0.2161) loss_zs_kd 0.1039 (0.1207) loss_oracle 0.4973 (0.4813) acc 90.6250 (84.1667) kd_loss 0.9010 (0.8899) lr 5.7422e-04 eta 0:05:20
epoch [34/50] batch [80/167] time 0.088 (0.114) data 0.000 (0.003) loss 0.5477 (0.7634) ce_loss 0.2223 (0.4035) teacher_loss 0.0709 (0.2171) loss_zs_kd 0.0821 (0.1217) loss_oracle 0.4357 (0.4854) acc 93.7500 (84.0234) kd_loss 0.8737 (0.8896) lr 5.7422e-04 eta 0:05:13
epoch [34/50] batch [100/167] time 0.115 (0.113) data 0.000 (0.002) loss 0.8306 (0.7629) ce_loss 0.5356 (0.4053) teacher_loss 0.2980 (0.2202) loss_zs_kd 0.1623 (0.1213) loss_oracle 0.4515 (0.4820) acc 81.2500 (84.2500) kd_loss 0.8722 (0.8860) lr 5.7422e-04 eta 0:05:09
epoch [34/50] batch [120/167] time 0.081 (0.112) data 0.000 (0.002) loss 0.9291 (0.7634) ce_loss 0.5952 (0.4035) teacher_loss 0.3134 (0.2221) loss_zs_kd 0.1876 (0.1219) loss_oracle 0.5219 (0.4804) acc 84.3750 (84.4792) kd_loss 0.8961 (0.8851) lr 5.7422e-04 eta 0:05:05
epoch [34/50] batch [140/167] time 0.100 (0.112) data 0.000 (0.002) loss 0.7153 (0.7654) ce_loss 0.3557 (0.4086) teacher_loss 0.1320 (0.2252) loss_zs_kd 0.0994 (0.1226) loss_oracle 0.5336 (0.4789) acc 87.5000 (84.1964) kd_loss 0.9660 (0.8836) lr 5.7422e-04 eta 0:05:02
epoch [34/50] batch [160/167] time 0.187 (0.115) data 0.000 (0.002) loss 0.9330 (0.7721) ce_loss 0.5571 (0.4130) teacher_loss 0.3441 (0.2299) loss_zs_kd 0.1468 (0.1234) loss_oracle 0.5155 (0.4805) acc 78.1250 (84.2188) kd_loss 0.9132 (0.8821) lr 5.7422e-04 eta 0:05:08
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,185
* accuracy: 95.1%
* error: 4.9%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [35/50] batch [20/167] time 0.121 (0.120) data 0.000 (0.013) loss 0.6345 (0.7215) ce_loss 0.2413 (0.3628) teacher_loss 0.1962 (0.2256) loss_zs_kd 0.0782 (0.1031) loss_oracle 0.3993 (0.4444) acc 90.6250 (87.1875) kd_loss 0.7846 (0.8332) lr 5.1825e-04 eta 0:05:19
epoch [35/50] batch [40/167] time 0.107 (0.117) data 0.000 (0.007) loss 0.7541 (0.7482) ce_loss 0.4458 (0.3943) teacher_loss 0.2651 (0.2440) loss_zs_kd 0.1202 (0.1126) loss_oracle 0.4289 (0.4479) acc 81.2500 (86.0938) kd_loss 0.8659 (0.8487) lr 5.1825e-04 eta 0:05:09
epoch [35/50] batch [60/167] time 0.138 (0.116) data 0.001 (0.005) loss 0.6637 (0.7388) ce_loss 0.2423 (0.3841) teacher_loss 0.1728 (0.2354) loss_zs_kd 0.1215 (0.1143) loss_oracle 0.4302 (0.4462) acc 93.7500 (86.4062) kd_loss 0.8317 (0.8552) lr 5.1825e-04 eta 0:05:02
epoch [35/50] batch [80/167] time 0.082 (0.115) data 0.000 (0.004) loss 0.7763 (0.7386) ce_loss 0.3948 (0.3844) teacher_loss 0.2420 (0.2338) loss_zs_kd 0.1216 (0.1165) loss_oracle 0.4735 (0.4466) acc 87.5000 (86.2500) kd_loss 0.9040 (0.8579) lr 5.1825e-04 eta 0:04:58
epoch [35/50] batch [100/167] time 0.148 (0.116) data 0.000 (0.003) loss 0.7421 (0.7297) ce_loss 0.4187 (0.3792) teacher_loss 0.2783 (0.2309) loss_zs_kd 0.0980 (0.1148) loss_oracle 0.4148 (0.4415) acc 84.3750 (86.2812) kd_loss 0.8446 (0.8528) lr 5.1825e-04 eta 0:04:58
epoch [35/50] batch [120/167] time 0.147 (0.116) data 0.000 (0.002) loss 0.5139 (0.7263) ce_loss 0.1709 (0.3774) teacher_loss 0.1168 (0.2293) loss_zs_kd 0.0731 (0.1131) loss_oracle 0.3605 (0.4404) acc 90.6250 (86.0417) kd_loss 0.6565 (0.8474) lr 5.1825e-04 eta 0:04:54
epoch [35/50] batch [140/167] time 0.124 (0.117) data 0.000 (0.002) loss 0.6824 (0.7330) ce_loss 0.3777 (0.3859) teacher_loss 0.2162 (0.2367) loss_zs_kd 0.1164 (0.1132) loss_oracle 0.4080 (0.4397) acc 84.3750 (85.8259) kd_loss 0.8679 (0.8450) lr 5.1825e-04 eta 0:04:55
epoch [35/50] batch [160/167] time 0.096 (0.116) data 0.000 (0.002) loss 0.7861 (0.7384) ce_loss 0.2988 (0.3883) teacher_loss 0.2665 (0.2389) loss_zs_kd 0.1041 (0.1133) loss_oracle 0.4676 (0.4429) acc 87.5000 (85.7227) kd_loss 0.8347 (0.8416) lr 5.1825e-04 eta 0:04:51
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,199
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.2%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [36/50] batch [20/167] time 0.143 (0.149) data 0.000 (0.016) loss 0.6303 (0.7390) ce_loss 0.2737 (0.3837) teacher_loss 0.2219 (0.2404) loss_zs_kd 0.0532 (0.1151) loss_oracle 0.3818 (0.4411) acc 93.7500 (85.9375) kd_loss 0.8103 (0.8234) lr 4.6417e-04 eta 0:06:10
epoch [36/50] batch [40/167] time 0.138 (0.142) data 0.000 (0.008) loss 0.7553 (0.7536) ce_loss 0.4031 (0.4065) teacher_loss 0.3199 (0.2669) loss_zs_kd 0.1233 (0.1177) loss_oracle 0.3738 (0.4278) acc 81.2500 (86.2500) kd_loss 0.7738 (0.8199) lr 4.6417e-04 eta 0:05:50
epoch [36/50] batch [60/167] time 0.144 (0.138) data 0.000 (0.006) loss 0.7973 (0.7485) ce_loss 0.4248 (0.4005) teacher_loss 0.2227 (0.2640) loss_zs_kd 0.1567 (0.1136) loss_oracle 0.4962 (0.4278) acc 87.5000 (85.9375) kd_loss 0.9124 (0.8269) lr 4.6417e-04 eta 0:05:37
epoch [36/50] batch [80/167] time 0.116 (0.136) data 0.000 (0.004) loss 0.6750 (0.7429) ce_loss 0.2837 (0.3906) teacher_loss 0.1708 (0.2535) loss_zs_kd 0.0940 (0.1176) loss_oracle 0.4572 (0.4307) acc 90.6250 (86.1719) kd_loss 0.9078 (0.8317) lr 4.6417e-04 eta 0:05:28
epoch [36/50] batch [100/167] time 0.147 (0.135) data 0.000 (0.003) loss 0.8484 (0.7392) ce_loss 0.5215 (0.3842) teacher_loss 0.3450 (0.2479) loss_zs_kd 0.1455 (0.1184) loss_oracle 0.4306 (0.4322) acc 78.1250 (86.3438) kd_loss 0.8453 (0.8373) lr 4.6417e-04 eta 0:05:23
epoch [36/50] batch [120/167] time 0.077 (0.133) data 0.000 (0.003) loss 0.7969 (0.7357) ce_loss 0.4360 (0.3872) teacher_loss 0.2092 (0.2494) loss_zs_kd 0.1386 (0.1191) loss_oracle 0.5184 (0.4268) acc 90.6250 (86.2500) kd_loss 0.9319 (0.8407) lr 4.6417e-04 eta 0:05:16
epoch [36/50] batch [140/167] time 0.202 (0.138) data 0.000 (0.003) loss 0.8927 (0.7384) ce_loss 0.4956 (0.3874) teacher_loss 0.3379 (0.2485) loss_zs_kd 0.1239 (0.1195) loss_oracle 0.4928 (0.4301) acc 78.1250 (86.1607) kd_loss 0.9353 (0.8470) lr 4.6417e-04 eta 0:05:26
epoch [36/50] batch [160/167] time 0.188 (0.133) data 0.000 (0.002) loss 0.7071 (0.7308) ce_loss 0.2803 (0.3799) teacher_loss 0.1728 (0.2432) loss_zs_kd 0.1109 (0.1180) loss_oracle 0.4788 (0.4285) acc 93.7500 (86.4062) kd_loss 0.8813 (0.8478) lr 4.6417e-04 eta 0:05:10
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,203
* accuracy: 95.9%
* error: 4.1%
* macro_f1: 96.4%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [37/50] batch [20/167] time 0.102 (0.126) data 0.000 (0.013) loss 0.7542 (0.7263) ce_loss 0.4431 (0.3536) teacher_loss 0.2293 (0.2269) loss_zs_kd 0.1539 (0.1309) loss_oracle 0.4479 (0.4340) acc 81.2500 (87.1875) kd_loss 0.8970 (0.8675) lr 4.1221e-04 eta 0:04:52
epoch [37/50] batch [40/167] time 0.123 (0.122) data 0.000 (0.007) loss 0.5430 (0.7222) ce_loss 0.1696 (0.3737) teacher_loss 0.1317 (0.2446) loss_zs_kd 0.0956 (0.1144) loss_oracle 0.3635 (0.4204) acc 93.7500 (86.0938) kd_loss 0.7908 (0.8622) lr 4.1221e-04 eta 0:04:40
epoch [37/50] batch [60/167] time 0.101 (0.119) data 0.001 (0.005) loss 0.6652 (0.7058) ce_loss 0.2412 (0.3689) teacher_loss 0.1451 (0.2406) loss_zs_kd 0.0689 (0.1134) loss_oracle 0.4856 (0.4085) acc 87.5000 (86.3542) kd_loss 0.8655 (0.8554) lr 4.1221e-04 eta 0:04:31
epoch [37/50] batch [80/167] time 0.087 (0.117) data 0.000 (0.004) loss 0.5847 (0.7097) ce_loss 0.3027 (0.3759) teacher_loss 0.1787 (0.2474) loss_zs_kd 0.0976 (0.1149) loss_oracle 0.3571 (0.4048) acc 87.5000 (85.7812) kd_loss 0.8832 (0.8541) lr 4.1221e-04 eta 0:04:23
epoch [37/50] batch [100/167] time 0.089 (0.116) data 0.000 (0.003) loss 0.5993 (0.7025) ce_loss 0.3438 (0.3676) teacher_loss 0.2378 (0.2433) loss_zs_kd 0.0854 (0.1117) loss_oracle 0.3188 (0.4033) acc 78.1250 (86.0625) kd_loss 0.7942 (0.8528) lr 4.1221e-04 eta 0:04:18
epoch [37/50] batch [120/167] time 0.097 (0.115) data 0.000 (0.002) loss 0.8656 (0.7130) ce_loss 0.4810 (0.3844) teacher_loss 0.4351 (0.2568) loss_zs_kd 0.0883 (0.1114) loss_oracle 0.3863 (0.4005) acc 81.2500 (85.3125) kd_loss 0.8858 (0.8521) lr 4.1221e-04 eta 0:04:14
epoch [37/50] batch [140/167] time 0.098 (0.113) data 0.000 (0.002) loss 0.6267 (0.7063) ce_loss 0.3584 (0.3868) teacher_loss 0.2321 (0.2572) loss_zs_kd 0.1253 (0.1113) loss_oracle 0.3320 (0.3934) acc 81.2500 (85.3348) kd_loss 0.8228 (0.8509) lr 4.1221e-04 eta 0:04:09
epoch [37/50] batch [160/167] time 0.079 (0.112) data 0.000 (0.002) loss 0.8653 (0.7069) ce_loss 0.4470 (0.3874) teacher_loss 0.3666 (0.2593) loss_zs_kd 0.1134 (0.1127) loss_oracle 0.4420 (0.3913) acc 78.1250 (85.3516) kd_loss 0.8839 (0.8516) lr 4.1221e-04 eta 0:04:03
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,201
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [38/50] batch [20/167] time 0.107 (0.135) data 0.000 (0.013) loss 0.8065 (0.6835) ce_loss 0.4915 (0.3671) teacher_loss 0.3393 (0.2436) loss_zs_kd 0.1032 (0.1011) loss_oracle 0.4156 (0.3894) acc 84.3750 (86.0938) kd_loss 0.8473 (0.8492) lr 3.6258e-04 eta 0:04:51
epoch [38/50] batch [40/167] time 0.128 (0.129) data 0.000 (0.007) loss 0.6356 (0.6975) ce_loss 0.3030 (0.4014) teacher_loss 0.2048 (0.2732) loss_zs_kd 0.1038 (0.1065) loss_oracle 0.3789 (0.3710) acc 90.6250 (84.6094) kd_loss 0.8188 (0.8462) lr 3.6258e-04 eta 0:04:34
epoch [38/50] batch [60/167] time 0.141 (0.129) data 0.001 (0.005) loss 0.8450 (0.7063) ce_loss 0.5264 (0.3983) teacher_loss 0.3317 (0.2725) loss_zs_kd 0.1103 (0.1089) loss_oracle 0.4582 (0.3793) acc 81.2500 (84.8438) kd_loss 0.8795 (0.8434) lr 3.6258e-04 eta 0:04:32
epoch [38/50] batch [80/167] time 0.122 (0.127) data 0.000 (0.004) loss 0.6540 (0.7084) ce_loss 0.4072 (0.3949) teacher_loss 0.2652 (0.2720) loss_zs_kd 0.0926 (0.1110) loss_oracle 0.3425 (0.3809) acc 81.2500 (84.8438) kd_loss 0.7526 (0.8411) lr 3.6258e-04 eta 0:04:26
epoch [38/50] batch [100/167] time 0.142 (0.126) data 0.000 (0.003) loss 0.7496 (0.7066) ce_loss 0.3806 (0.3916) teacher_loss 0.2317 (0.2704) loss_zs_kd 0.1217 (0.1080) loss_oracle 0.4571 (0.3822) acc 84.3750 (84.9375) kd_loss 0.8972 (0.8431) lr 3.6258e-04 eta 0:04:20
epoch [38/50] batch [120/167] time 0.076 (0.125) data 0.000 (0.002) loss 0.5340 (0.7020) ce_loss 0.1628 (0.3864) teacher_loss 0.1216 (0.2690) loss_zs_kd 0.0827 (0.1093) loss_oracle 0.3711 (0.3784) acc 96.8750 (85.1042) kd_loss 0.7756 (0.8399) lr 3.6258e-04 eta 0:04:15
epoch [38/50] batch [140/167] time 0.188 (0.130) data 0.000 (0.002) loss 0.7869 (0.7026) ce_loss 0.4470 (0.3847) teacher_loss 0.3361 (0.2698) loss_zs_kd 0.0911 (0.1067) loss_oracle 0.4053 (0.3794) acc 84.3750 (85.3348) kd_loss 0.8574 (0.8432) lr 3.6258e-04 eta 0:04:23
epoch [38/50] batch [160/167] time 0.188 (0.132) data 0.000 (0.002) loss 0.8019 (0.7048) ce_loss 0.4871 (0.3857) teacher_loss 0.3744 (0.2726) loss_zs_kd 0.1152 (0.1055) loss_oracle 0.3699 (0.3794) acc 84.3750 (85.1367) kd_loss 0.8330 (0.8442) lr 3.6258e-04 eta 0:04:24
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,199
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.2%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [39/50] batch [20/167] time 0.092 (0.135) data 0.000 (0.012) loss 0.7688 (0.7323) ce_loss 0.4087 (0.3784) teacher_loss 0.2912 (0.2519) loss_zs_kd 0.1485 (0.1109) loss_oracle 0.4034 (0.4250) acc 84.3750 (85.3125) kd_loss 0.8489 (0.8601) lr 3.1545e-04 eta 0:04:26
epoch [39/50] batch [40/167] time 0.129 (0.131) data 0.000 (0.006) loss 0.7234 (0.7433) ce_loss 0.3574 (0.3939) teacher_loss 0.2426 (0.2712) loss_zs_kd 0.1056 (0.1099) loss_oracle 0.4280 (0.4171) acc 84.3750 (84.8438) kd_loss 0.8583 (0.8611) lr 3.1545e-04 eta 0:04:17
epoch [39/50] batch [60/167] time 0.122 (0.126) data 0.001 (0.004) loss 0.7217 (0.7410) ce_loss 0.3555 (0.3945) teacher_loss 0.2182 (0.2737) loss_zs_kd 0.1304 (0.1061) loss_oracle 0.4383 (0.4142) acc 81.2500 (85.2083) kd_loss 0.8429 (0.8550) lr 3.1545e-04 eta 0:04:05
epoch [39/50] batch [80/167] time 0.141 (0.126) data 0.000 (0.003) loss 0.6939 (0.7289) ce_loss 0.2854 (0.3761) teacher_loss 0.1856 (0.2618) loss_zs_kd 0.1208 (0.1035) loss_oracle 0.4479 (0.4153) acc 90.6250 (85.8984) kd_loss 0.8639 (0.8546) lr 3.1545e-04 eta 0:04:02
epoch [39/50] batch [100/167] time 0.091 (0.126) data 0.000 (0.003) loss 0.6587 (0.7259) ce_loss 0.3564 (0.3748) teacher_loss 0.2252 (0.2620) loss_zs_kd 0.1168 (0.1022) loss_oracle 0.3752 (0.4128) acc 87.5000 (85.9688) kd_loss 0.8318 (0.8552) lr 3.1545e-04 eta 0:03:59
epoch [39/50] batch [120/167] time 0.100 (0.126) data 0.000 (0.002) loss 0.7461 (0.7198) ce_loss 0.3625 (0.3720) teacher_loss 0.2969 (0.2593) loss_zs_kd 0.1004 (0.1023) loss_oracle 0.3990 (0.4093) acc 90.6250 (86.0677) kd_loss 0.8669 (0.8542) lr 3.1545e-04 eta 0:03:56
epoch [39/50] batch [140/167] time 0.143 (0.126) data 0.000 (0.002) loss 0.5283 (0.7224) ce_loss 0.2532 (0.3787) teacher_loss 0.1082 (0.2643) loss_zs_kd 0.0691 (0.1013) loss_oracle 0.3856 (0.4075) acc 90.6250 (85.8259) kd_loss 0.8156 (0.8516) lr 3.1545e-04 eta 0:03:54
epoch [39/50] batch [160/167] time 0.136 (0.125) data 0.000 (0.002) loss 0.7258 (0.7282) ce_loss 0.4722 (0.3806) teacher_loss 0.2692 (0.2676) loss_zs_kd 0.0936 (0.1019) loss_oracle 0.4098 (0.4097) acc 78.1250 (85.7617) kd_loss 0.8369 (0.8512) lr 3.1545e-04 eta 0:03:49
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,199
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.2%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,322
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [40/50] batch [20/167] time 0.144 (0.139) data 0.000 (0.018) loss 0.7636 (0.7721) ce_loss 0.4414 (0.4215) teacher_loss 0.2579 (0.2930) loss_zs_kd 0.1467 (0.1133) loss_oracle 0.4324 (0.4224) acc 84.3750 (84.2188) kd_loss 0.8936 (0.8421) lr 2.7103e-04 eta 0:04:12
epoch [40/50] batch [40/167] time 0.113 (0.129) data 0.000 (0.009) loss 0.7195 (0.7780) ce_loss 0.3882 (0.4287) teacher_loss 0.2671 (0.2966) loss_zs_kd 0.1034 (0.1092) loss_oracle 0.4007 (0.4268) acc 87.5000 (84.6094) kd_loss 0.8000 (0.8431) lr 2.7103e-04 eta 0:03:51
epoch [40/50] batch [60/167] time 0.137 (0.127) data 0.000 (0.006) loss 0.4850 (0.7607) ce_loss 0.0796 (0.4127) teacher_loss 0.0367 (0.2832) loss_zs_kd 0.0394 (0.1086) loss_oracle 0.4285 (0.4232) acc 96.8750 (85.4167) kd_loss 0.8312 (0.8411) lr 2.7103e-04 eta 0:03:45
epoch [40/50] batch [80/167] time 0.137 (0.126) data 0.000 (0.005) loss 0.7363 (0.7424) ce_loss 0.3472 (0.3889) teacher_loss 0.2632 (0.2670) loss_zs_kd 0.0836 (0.1067) loss_oracle 0.4313 (0.4219) acc 90.6250 (86.2891) kd_loss 0.8462 (0.8384) lr 2.7103e-04 eta 0:03:41
epoch [40/50] batch [100/167] time 0.189 (0.124) data 0.000 (0.004) loss 1.1375 (0.7406) ce_loss 0.9229 (0.3924) teacher_loss 0.7061 (0.2696) loss_zs_kd 0.1148 (0.1059) loss_oracle 0.3739 (0.4180) acc 68.7500 (86.0938) kd_loss 0.8445 (0.8361) lr 2.7103e-04 eta 0:03:35
epoch [40/50] batch [120/167] time 0.083 (0.130) data 0.000 (0.003) loss 0.6756 (0.7320) ce_loss 0.3035 (0.3844) teacher_loss 0.2512 (0.2623) loss_zs_kd 0.0827 (0.1052) loss_oracle 0.3830 (0.4170) acc 90.6250 (86.3021) kd_loss 0.8102 (0.8388) lr 2.7103e-04 eta 0:03:42
epoch [40/50] batch [140/167] time 0.188 (0.132) data 0.000 (0.003) loss 0.7415 (0.7346) ce_loss 0.4380 (0.3867) teacher_loss 0.2549 (0.2644) loss_zs_kd 0.1050 (0.1051) loss_oracle 0.4341 (0.4177) acc 81.2500 (86.0938) kd_loss 0.8349 (0.8392) lr 2.7103e-04 eta 0:03:43
epoch [40/50] batch [160/167] time 0.101 (0.132) data 0.000 (0.002) loss 0.9950 (0.7349) ce_loss 0.7192 (0.3843) teacher_loss 0.4484 (0.2623) loss_zs_kd 0.1754 (0.1043) loss_oracle 0.4588 (0.4205) acc 78.1250 (86.1523) kd_loss 0.8803 (0.8413) lr 2.7103e-04 eta 0:03:41
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,199
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.2%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,322
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [41/50] batch [20/167] time 0.087 (0.124) data 0.000 (0.012) loss 0.7831 (0.7580) ce_loss 0.3960 (0.3985) teacher_loss 0.2173 (0.2475) loss_zs_kd 0.1481 (0.1086) loss_oracle 0.4918 (0.4562) acc 84.3750 (85.4688) kd_loss 0.8574 (0.8415) lr 2.2949e-04 eta 0:03:24
epoch [41/50] batch [40/167] time 0.098 (0.114) data 0.000 (0.006) loss 0.6972 (0.7565) ce_loss 0.3318 (0.3807) teacher_loss 0.2184 (0.2485) loss_zs_kd 0.0967 (0.1051) loss_oracle 0.4305 (0.4554) acc 87.5000 (85.7812) kd_loss 0.7983 (0.8436) lr 2.2949e-04 eta 0:03:05
epoch [41/50] batch [60/167] time 0.138 (0.113) data 0.000 (0.004) loss 0.7356 (0.7706) ce_loss 0.3811 (0.3927) teacher_loss 0.2452 (0.2596) loss_zs_kd 0.1158 (0.1072) loss_oracle 0.4325 (0.4574) acc 78.1250 (85.0000) kd_loss 0.7925 (0.8427) lr 2.2949e-04 eta 0:03:01
epoch [41/50] batch [80/167] time 0.118 (0.113) data 0.000 (0.003) loss 0.5440 (0.7672) ce_loss 0.1456 (0.3893) teacher_loss 0.0882 (0.2575) loss_zs_kd 0.0835 (0.1058) loss_oracle 0.4141 (0.4568) acc 96.8750 (85.1953) kd_loss 0.8462 (0.8460) lr 2.2949e-04 eta 0:02:58
epoch [41/50] batch [100/167] time 0.139 (0.112) data 0.000 (0.002) loss 0.7786 (0.7706) ce_loss 0.3486 (0.3901) teacher_loss 0.2826 (0.2587) loss_zs_kd 0.1076 (0.1063) loss_oracle 0.4422 (0.4587) acc 78.1250 (85.0625) kd_loss 0.8323 (0.8479) lr 2.2949e-04 eta 0:02:55
epoch [41/50] batch [120/167] time 0.086 (0.111) data 0.000 (0.002) loss 0.8329 (0.7689) ce_loss 0.4993 (0.3892) teacher_loss 0.3030 (0.2581) loss_zs_kd 0.1288 (0.1057) loss_oracle 0.4655 (0.4580) acc 78.1250 (85.1042) kd_loss 0.8569 (0.8487) lr 2.2949e-04 eta 0:02:52
epoch [41/50] batch [140/167] time 0.135 (0.111) data 0.000 (0.002) loss 0.6251 (0.7654) ce_loss 0.2456 (0.3924) teacher_loss 0.1675 (0.2608) loss_zs_kd 0.0799 (0.1058) loss_oracle 0.4176 (0.4517) acc 90.6250 (85.1116) kd_loss 0.8228 (0.8467) lr 2.2949e-04 eta 0:02:49
epoch [41/50] batch [160/167] time 0.080 (0.110) data 0.000 (0.002) loss 0.7379 (0.7639) ce_loss 0.2942 (0.3900) teacher_loss 0.2209 (0.2593) loss_zs_kd 0.0903 (0.1069) loss_oracle 0.4718 (0.4512) acc 87.5000 (85.3711) kd_loss 0.8202 (0.8480) lr 2.2949e-04 eta 0:02:45
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,200
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.2%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [42/50] batch [20/167] time 0.105 (0.131) data 0.000 (0.016) loss 0.7655 (0.7438) ce_loss 0.3423 (0.3318) teacher_loss 0.2044 (0.2199) loss_zs_kd 0.1022 (0.1120) loss_oracle 0.5100 (0.4679) acc 84.3750 (87.1875) kd_loss 0.8614 (0.8813) lr 1.9098e-04 eta 0:03:14
epoch [42/50] batch [40/167] time 0.089 (0.119) data 0.000 (0.008) loss 0.6440 (0.7411) ce_loss 0.2476 (0.3307) teacher_loss 0.1680 (0.2182) loss_zs_kd 0.1155 (0.1098) loss_oracle 0.4183 (0.4680) acc 93.7500 (87.8906) kd_loss 0.8080 (0.8816) lr 1.9098e-04 eta 0:02:53
epoch [42/50] batch [60/167] time 0.137 (0.114) data 0.000 (0.005) loss 0.9108 (0.7606) ce_loss 0.7246 (0.3601) teacher_loss 0.4243 (0.2347) loss_zs_kd 0.1280 (0.1096) loss_oracle 0.4225 (0.4711) acc 65.6250 (86.6146) kd_loss 0.8933 (0.8778) lr 1.9098e-04 eta 0:02:45
epoch [42/50] batch [80/167] time 0.070 (0.111) data 0.000 (0.004) loss 0.9336 (0.7541) ce_loss 0.5464 (0.3586) teacher_loss 0.4040 (0.2324) loss_zs_kd 0.1269 (0.1091) loss_oracle 0.4662 (0.4672) acc 81.2500 (86.6016) kd_loss 0.8486 (0.8700) lr 1.9098e-04 eta 0:02:38
epoch [42/50] batch [100/167] time 0.098 (0.111) data 0.000 (0.003) loss 0.7108 (0.7610) ce_loss 0.2856 (0.3676) teacher_loss 0.1828 (0.2403) loss_zs_kd 0.1157 (0.1099) loss_oracle 0.4702 (0.4658) acc 90.6250 (86.3438) kd_loss 0.8448 (0.8662) lr 1.9098e-04 eta 0:02:36
epoch [42/50] batch [120/167] time 0.151 (0.108) data 0.000 (0.003) loss 0.8222 (0.7622) ce_loss 0.3657 (0.3741) teacher_loss 0.2665 (0.2417) loss_zs_kd 0.1106 (0.1108) loss_oracle 0.5003 (0.4651) acc 81.2500 (86.0677) kd_loss 0.8653 (0.8664) lr 1.9098e-04 eta 0:02:28
epoch [42/50] batch [140/167] time 0.069 (0.115) data 0.000 (0.002) loss 1.0592 (0.7690) ce_loss 0.6099 (0.3797) teacher_loss 0.4926 (0.2453) loss_zs_kd 0.1424 (0.1123) loss_oracle 0.4953 (0.4676) acc 81.2500 (85.8259) kd_loss 0.8858 (0.8690) lr 1.9098e-04 eta 0:02:37
epoch [42/50] batch [160/167] time 0.189 (0.119) data 0.000 (0.002) loss 0.6933 (0.7705) ce_loss 0.3274 (0.3823) teacher_loss 0.1721 (0.2481) loss_zs_kd 0.0975 (0.1126) loss_oracle 0.4723 (0.4661) acc 90.6250 (85.8594) kd_loss 0.9087 (0.8688) lr 1.9098e-04 eta 0:02:40
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,200
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.2%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [43/50] batch [20/167] time 0.074 (0.108) data 0.000 (0.013) loss 0.6585 (0.7568) ce_loss 0.2888 (0.3888) teacher_loss 0.1444 (0.2631) loss_zs_kd 0.1096 (0.1099) loss_oracle 0.4593 (0.4387) acc 90.6250 (86.8750) kd_loss 0.8606 (0.8463) lr 1.5567e-04 eta 0:02:22
epoch [43/50] batch [40/167] time 0.085 (0.104) data 0.000 (0.006) loss 0.7240 (0.7586) ce_loss 0.3813 (0.3755) teacher_loss 0.2224 (0.2510) loss_zs_kd 0.1249 (0.1091) loss_oracle 0.4391 (0.4530) acc 87.5000 (86.9531) kd_loss 0.8560 (0.8569) lr 1.5567e-04 eta 0:02:14
epoch [43/50] batch [60/167] time 0.064 (0.106) data 0.000 (0.004) loss 0.9051 (0.7670) ce_loss 0.5229 (0.3850) teacher_loss 0.3273 (0.2543) loss_zs_kd 0.1620 (0.1105) loss_oracle 0.4968 (0.4575) acc 81.2500 (85.8854) kd_loss 0.9201 (0.8651) lr 1.5567e-04 eta 0:02:14
epoch [43/50] batch [80/167] time 0.087 (0.105) data 0.000 (0.003) loss 0.7088 (0.7707) ce_loss 0.3408 (0.3930) teacher_loss 0.1819 (0.2561) loss_zs_kd 0.1213 (0.1133) loss_oracle 0.4663 (0.4580) acc 87.5000 (85.8984) kd_loss 0.8629 (0.8633) lr 1.5567e-04 eta 0:02:11
epoch [43/50] batch [100/167] time 0.128 (0.106) data 0.000 (0.003) loss 0.7257 (0.7796) ce_loss 0.2321 (0.3961) teacher_loss 0.1883 (0.2566) loss_zs_kd 0.0679 (0.1144) loss_oracle 0.5035 (0.4659) acc 87.5000 (85.7188) kd_loss 0.8933 (0.8688) lr 1.5567e-04 eta 0:02:10
epoch [43/50] batch [120/167] time 0.086 (0.106) data 0.000 (0.002) loss 0.9358 (0.7815) ce_loss 0.4712 (0.3956) teacher_loss 0.4085 (0.2571) loss_zs_kd 0.1173 (0.1144) loss_oracle 0.4687 (0.4672) acc 81.2500 (85.7292) kd_loss 0.8702 (0.8705) lr 1.5567e-04 eta 0:02:08
epoch [43/50] batch [140/167] time 0.130 (0.107) data 0.000 (0.002) loss 0.6260 (0.7766) ce_loss 0.1971 (0.3911) teacher_loss 0.1016 (0.2543) loss_zs_kd 0.0974 (0.1133) loss_oracle 0.4757 (0.4657) acc 93.7500 (85.6696) kd_loss 0.8496 (0.8697) lr 1.5567e-04 eta 0:02:07
epoch [43/50] batch [160/167] time 0.098 (0.106) data 0.000 (0.002) loss 0.6325 (0.7744) ce_loss 0.1893 (0.3909) teacher_loss 0.1066 (0.2540) loss_zs_kd 0.1038 (0.1121) loss_oracle 0.4740 (0.4644) acc 96.8750 (85.6836) kd_loss 0.8903 (0.8698) lr 1.5567e-04 eta 0:02:04
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,201
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [44/50] batch [20/167] time 0.139 (0.131) data 0.000 (0.013) loss 0.7434 (0.7317) ce_loss 0.3311 (0.3371) teacher_loss 0.1916 (0.2212) loss_zs_kd 0.1708 (0.1062) loss_oracle 0.4664 (0.4573) acc 93.7500 (87.5000) kd_loss 0.8755 (0.8884) lr 1.2369e-04 eta 0:02:30
epoch [44/50] batch [40/167] time 0.146 (0.125) data 0.000 (0.006) loss 0.7515 (0.7725) ce_loss 0.4487 (0.3767) teacher_loss 0.2565 (0.2491) loss_zs_kd 0.1074 (0.1114) loss_oracle 0.4413 (0.4677) acc 90.6250 (86.0156) kd_loss 0.8725 (0.8874) lr 1.2369e-04 eta 0:02:21
epoch [44/50] batch [60/167] time 0.138 (0.123) data 0.001 (0.004) loss 0.7803 (0.7733) ce_loss 0.4243 (0.3873) teacher_loss 0.2882 (0.2522) loss_zs_kd 0.0887 (0.1100) loss_oracle 0.4478 (0.4661) acc 81.2500 (85.3125) kd_loss 0.8208 (0.8856) lr 1.2369e-04 eta 0:02:16
epoch [44/50] batch [80/167] time 0.134 (0.124) data 0.000 (0.003) loss 0.7470 (0.7630) ce_loss 0.3542 (0.3693) teacher_loss 0.2482 (0.2427) loss_zs_kd 0.0957 (0.1071) loss_oracle 0.4509 (0.4667) acc 81.2500 (86.0547) kd_loss 0.8945 (0.8833) lr 1.2369e-04 eta 0:02:15
epoch [44/50] batch [100/167] time 0.101 (0.123) data 0.000 (0.003) loss 0.6882 (0.7680) ce_loss 0.4641 (0.3805) teacher_loss 0.2311 (0.2484) loss_zs_kd 0.0911 (0.1077) loss_oracle 0.4116 (0.4657) acc 81.2500 (85.6562) kd_loss 0.8698 (0.8834) lr 1.2369e-04 eta 0:02:11
epoch [44/50] batch [120/167] time 0.140 (0.122) data 0.000 (0.002) loss 0.6878 (0.7646) ce_loss 0.2891 (0.3745) teacher_loss 0.1641 (0.2442) loss_zs_kd 0.1293 (0.1082) loss_oracle 0.4590 (0.4663) acc 93.7500 (85.9896) kd_loss 0.8765 (0.8827) lr 1.2369e-04 eta 0:02:08
epoch [44/50] batch [140/167] time 0.194 (0.123) data 0.000 (0.002) loss 0.8346 (0.7695) ce_loss 0.4072 (0.3802) teacher_loss 0.2807 (0.2485) loss_zs_kd 0.1042 (0.1095) loss_oracle 0.5018 (0.4663) acc 87.5000 (85.7366) kd_loss 0.9016 (0.8810) lr 1.2369e-04 eta 0:02:06
epoch [44/50] batch [160/167] time 0.073 (0.124) data 0.000 (0.002) loss 0.9749 (0.7669) ce_loss 0.7373 (0.3795) teacher_loss 0.4257 (0.2471) loss_zs_kd 0.1106 (0.1084) loss_oracle 0.4938 (0.4656) acc 75.0000 (85.5664) kd_loss 0.9221 (0.8817) lr 1.2369e-04 eta 0:02:04
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,201
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [45/50] batch [20/167] time 0.106 (0.115) data 0.000 (0.015) loss 0.7688 (0.7922) ce_loss 0.4080 (0.3995) teacher_loss 0.1911 (0.2707) loss_zs_kd 0.1169 (0.1119) loss_oracle 0.5192 (0.4656) acc 81.2500 (84.2188) kd_loss 0.9531 (0.8718) lr 9.5173e-05 eta 0:01:52
epoch [45/50] batch [40/167] time 0.075 (0.109) data 0.000 (0.007) loss 0.8135 (0.7771) ce_loss 0.4343 (0.3910) teacher_loss 0.2648 (0.2622) loss_zs_kd 0.1666 (0.1090) loss_oracle 0.4654 (0.4604) acc 90.6250 (85.4688) kd_loss 0.8935 (0.8812) lr 9.5173e-05 eta 0:01:44
epoch [45/50] batch [60/167] time 0.134 (0.107) data 0.000 (0.005) loss 0.6314 (0.7788) ce_loss 0.2742 (0.3924) teacher_loss 0.1641 (0.2620) loss_zs_kd 0.0961 (0.1116) loss_oracle 0.4192 (0.4609) acc 90.6250 (85.5729) kd_loss 0.8536 (0.8825) lr 9.5173e-05 eta 0:01:40
epoch [45/50] batch [80/167] time 0.085 (0.106) data 0.000 (0.004) loss 0.7667 (0.7717) ce_loss 0.2688 (0.3847) teacher_loss 0.2117 (0.2580) loss_zs_kd 0.0732 (0.1087) loss_oracle 0.5184 (0.4594) acc 90.6250 (85.6641) kd_loss 0.8515 (0.8841) lr 9.5173e-05 eta 0:01:37
epoch [45/50] batch [100/167] time 0.096 (0.106) data 0.000 (0.003) loss 0.9736 (0.7771) ce_loss 0.6060 (0.3952) teacher_loss 0.4281 (0.2621) loss_zs_kd 0.1821 (0.1112) loss_oracle 0.4545 (0.4595) acc 75.0000 (85.1562) kd_loss 0.9023 (0.8844) lr 9.5173e-05 eta 0:01:35
epoch [45/50] batch [120/167] time 0.114 (0.105) data 0.000 (0.003) loss 0.7280 (0.7775) ce_loss 0.4856 (0.3936) teacher_loss 0.3057 (0.2603) loss_zs_kd 0.1062 (0.1116) loss_oracle 0.3692 (0.4615) acc 71.8750 (85.2083) kd_loss 0.7730 (0.8865) lr 9.5173e-05 eta 0:01:32
epoch [45/50] batch [140/167] time 0.142 (0.107) data 0.001 (0.002) loss 0.6933 (0.7760) ce_loss 0.3162 (0.3921) teacher_loss 0.1762 (0.2571) loss_zs_kd 0.1004 (0.1129) loss_oracle 0.4669 (0.4625) acc 90.6250 (85.3795) kd_loss 0.8685 (0.8862) lr 9.5173e-05 eta 0:01:32
epoch [45/50] batch [160/167] time 0.079 (0.106) data 0.000 (0.002) loss 0.8673 (0.7783) ce_loss 0.4229 (0.3937) teacher_loss 0.2915 (0.2583) loss_zs_kd 0.1541 (0.1125) loss_oracle 0.4987 (0.4638) acc 84.3750 (85.3516) kd_loss 0.9614 (0.8860) lr 9.5173e-05 eta 0:01:29
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,201
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [46/50] batch [20/167] time 0.089 (0.124) data 0.000 (0.012) loss 0.7702 (0.7495) ce_loss 0.3340 (0.3706) teacher_loss 0.2272 (0.2298) loss_zs_kd 0.1056 (0.1178) loss_oracle 0.4902 (0.4607) acc 84.3750 (85.4688) kd_loss 0.9069 (0.8745) lr 7.0224e-05 eta 0:01:40
epoch [46/50] batch [40/167] time 0.134 (0.113) data 0.000 (0.006) loss 0.7303 (0.7462) ce_loss 0.3135 (0.3658) teacher_loss 0.2227 (0.2283) loss_zs_kd 0.0994 (0.1140) loss_oracle 0.4579 (0.4609) acc 90.6250 (85.7031) kd_loss 0.8267 (0.8737) lr 7.0224e-05 eta 0:01:30
epoch [46/50] batch [60/167] time 0.087 (0.112) data 0.000 (0.004) loss 0.8827 (0.7346) ce_loss 0.5190 (0.3527) teacher_loss 0.3026 (0.2189) loss_zs_kd 0.1332 (0.1119) loss_oracle 0.5135 (0.4597) acc 81.2500 (86.3021) kd_loss 0.9081 (0.8778) lr 7.0224e-05 eta 0:01:26
epoch [46/50] batch [80/167] time 0.136 (0.111) data 0.000 (0.003) loss 0.8132 (0.7361) ce_loss 0.4727 (0.3565) teacher_loss 0.3133 (0.2229) loss_zs_kd 0.1180 (0.1102) loss_oracle 0.4408 (0.4582) acc 84.3750 (86.4844) kd_loss 0.8773 (0.8775) lr 7.0224e-05 eta 0:01:24
epoch [46/50] batch [100/167] time 0.086 (0.111) data 0.000 (0.003) loss 0.8746 (0.7438) ce_loss 0.5796 (0.3646) teacher_loss 0.3345 (0.2296) loss_zs_kd 0.1571 (0.1117) loss_oracle 0.4615 (0.4584) acc 71.8750 (86.3125) kd_loss 0.8809 (0.8786) lr 7.0224e-05 eta 0:01:21
epoch [46/50] batch [120/167] time 0.127 (0.111) data 0.000 (0.002) loss 0.9142 (0.7483) ce_loss 0.6064 (0.3689) teacher_loss 0.4548 (0.2327) loss_zs_kd 0.1388 (0.1116) loss_oracle 0.3900 (0.4598) acc 71.8750 (85.9635) kd_loss 0.8130 (0.8775) lr 7.0224e-05 eta 0:01:19
epoch [46/50] batch [140/167] time 0.087 (0.111) data 0.000 (0.002) loss 0.6565 (0.7526) ce_loss 0.2423 (0.3713) teacher_loss 0.1650 (0.2371) loss_zs_kd 0.0557 (0.1102) loss_oracle 0.4636 (0.4604) acc 90.6250 (85.8259) kd_loss 0.8268 (0.8753) lr 7.0224e-05 eta 0:01:17
epoch [46/50] batch [160/167] time 0.073 (0.112) data 0.000 (0.002) loss 0.8418 (0.7549) ce_loss 0.5464 (0.3754) teacher_loss 0.3230 (0.2391) loss_zs_kd 0.1670 (0.1108) loss_oracle 0.4354 (0.4604) acc 71.8750 (85.6055) kd_loss 0.8140 (0.8754) lr 7.0224e-05 eta 0:01:15
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,201
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [47/50] batch [20/167] time 0.132 (0.153) data 0.000 (0.014) loss 0.8679 (0.7577) ce_loss 0.5708 (0.3929) teacher_loss 0.3582 (0.2413) loss_zs_kd 0.0888 (0.1158) loss_oracle 0.4653 (0.4585) acc 78.1250 (85.0000) kd_loss 0.8478 (0.8857) lr 4.8943e-05 eta 0:01:39
epoch [47/50] batch [40/167] time 0.136 (0.133) data 0.000 (0.007) loss 0.7680 (0.7343) ce_loss 0.4441 (0.3621) teacher_loss 0.3068 (0.2231) loss_zs_kd 0.1019 (0.1129) loss_oracle 0.4102 (0.4547) acc 84.3750 (86.6406) kd_loss 0.8335 (0.8860) lr 4.8943e-05 eta 0:01:23
epoch [47/50] batch [60/167] time 0.093 (0.125) data 0.000 (0.005) loss 0.9281 (0.7443) ce_loss 0.6318 (0.3700) teacher_loss 0.4001 (0.2280) loss_zs_kd 0.0967 (0.1102) loss_oracle 0.4797 (0.4612) acc 78.1250 (86.1979) kd_loss 0.8990 (0.8928) lr 4.8943e-05 eta 0:01:15
epoch [47/50] batch [80/167] time 0.141 (0.121) data 0.000 (0.004) loss 0.7960 (0.7423) ce_loss 0.3301 (0.3639) teacher_loss 0.2597 (0.2264) loss_zs_kd 0.0916 (0.1101) loss_oracle 0.4905 (0.4609) acc 90.6250 (87.0312) kd_loss 0.9181 (0.8896) lr 4.8943e-05 eta 0:01:11
epoch [47/50] batch [100/167] time 0.089 (0.119) data 0.000 (0.003) loss 0.5906 (0.7467) ce_loss 0.2280 (0.3660) teacher_loss 0.1358 (0.2303) loss_zs_kd 0.0949 (0.1100) loss_oracle 0.4073 (0.4614) acc 90.6250 (87.0312) kd_loss 0.8417 (0.8865) lr 4.8943e-05 eta 0:01:07
epoch [47/50] batch [120/167] time 0.145 (0.117) data 0.000 (0.002) loss 0.7909 (0.7519) ce_loss 0.5396 (0.3729) teacher_loss 0.3036 (0.2346) loss_zs_kd 0.1300 (0.1106) loss_oracle 0.4223 (0.4620) acc 75.0000 (86.6146) kd_loss 0.8125 (0.8850) lr 4.8943e-05 eta 0:01:04
epoch [47/50] batch [140/167] time 0.135 (0.116) data 0.000 (0.002) loss 0.7754 (0.7501) ce_loss 0.3975 (0.3669) teacher_loss 0.2150 (0.2314) loss_zs_kd 0.1461 (0.1099) loss_oracle 0.4873 (0.4637) acc 81.2500 (86.8304) kd_loss 0.8798 (0.8863) lr 4.8943e-05 eta 0:01:01
epoch [47/50] batch [160/167] time 0.079 (0.115) data 0.000 (0.002) loss 0.6804 (0.7518) ce_loss 0.1744 (0.3708) teacher_loss 0.0986 (0.2350) loss_zs_kd 0.0813 (0.1096) loss_oracle 0.5412 (0.4620) acc 93.7500 (86.5820) kd_loss 0.8951 (0.8858) lr 4.8943e-05 eta 0:00:58
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,202
* accuracy: 95.9%
* error: 4.1%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [48/50] batch [20/167] time 0.101 (0.133) data 0.000 (0.016) loss 0.7568 (0.8000) ce_loss 0.3462 (0.4285) teacher_loss 0.1772 (0.2697) loss_zs_kd 0.1180 (0.1223) loss_oracle 0.5206 (0.4691) acc 84.3750 (83.9062) kd_loss 0.9264 (0.8836) lr 3.1417e-05 eta 0:01:04
epoch [48/50] batch [40/167] time 0.090 (0.128) data 0.000 (0.008) loss 0.9825 (0.7812) ce_loss 0.5771 (0.3959) teacher_loss 0.4814 (0.2562) loss_zs_kd 0.1481 (0.1163) loss_oracle 0.4271 (0.4669) acc 78.1250 (84.8438) kd_loss 0.8977 (0.8838) lr 3.1417e-05 eta 0:00:58
epoch [48/50] batch [60/167] time 0.145 (0.128) data 0.000 (0.005) loss 0.7582 (0.7758) ce_loss 0.3782 (0.3907) teacher_loss 0.2536 (0.2516) loss_zs_kd 0.1304 (0.1151) loss_oracle 0.4394 (0.4667) acc 90.6250 (85.4167) kd_loss 0.8311 (0.8832) lr 3.1417e-05 eta 0:00:56
epoch [48/50] batch [80/167] time 0.134 (0.127) data 0.000 (0.004) loss 0.8917 (0.7719) ce_loss 0.5200 (0.3913) teacher_loss 0.3236 (0.2517) loss_zs_kd 0.1703 (0.1164) loss_oracle 0.4830 (0.4621) acc 78.1250 (85.2344) kd_loss 0.8684 (0.8780) lr 3.1417e-05 eta 0:00:53
epoch [48/50] batch [100/167] time 0.088 (0.124) data 0.000 (0.003) loss 0.7706 (0.7666) ce_loss 0.4270 (0.3810) teacher_loss 0.2695 (0.2442) loss_zs_kd 0.1261 (0.1153) loss_oracle 0.4381 (0.4647) acc 87.5000 (85.7500) kd_loss 0.8328 (0.8792) lr 3.1417e-05 eta 0:00:49
epoch [48/50] batch [120/167] time 0.087 (0.123) data 0.000 (0.003) loss 0.8246 (0.7661) ce_loss 0.4497 (0.3818) teacher_loss 0.3092 (0.2449) loss_zs_kd 0.1366 (0.1146) loss_oracle 0.4471 (0.4639) acc 84.3750 (85.6771) kd_loss 0.8852 (0.8800) lr 3.1417e-05 eta 0:00:46
epoch [48/50] batch [140/167] time 0.121 (0.122) data 0.000 (0.002) loss 0.7559 (0.7629) ce_loss 0.4011 (0.3775) teacher_loss 0.2697 (0.2421) loss_zs_kd 0.1305 (0.1137) loss_oracle 0.4210 (0.4640) acc 84.3750 (85.9598) kd_loss 0.8665 (0.8813) lr 3.1417e-05 eta 0:00:44
epoch [48/50] batch [160/167] time 0.189 (0.119) data 0.000 (0.002) loss 0.7067 (0.7639) ce_loss 0.2913 (0.3813) teacher_loss 0.1989 (0.2440) loss_zs_kd 0.0945 (0.1136) loss_oracle 0.4606 (0.4631) acc 90.6250 (85.7422) kd_loss 0.8894 (0.8824) lr 3.1417e-05 eta 0:00:40
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,201
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [49/50] batch [20/167] time 0.079 (0.126) data 0.000 (0.012) loss 0.7984 (0.7416) ce_loss 0.4294 (0.3282) teacher_loss 0.2574 (0.2082) loss_zs_kd 0.1377 (0.1104) loss_oracle 0.4721 (0.4782) acc 81.2500 (87.3438) kd_loss 0.9133 (0.9063) lr 1.7713e-05 eta 0:00:39
epoch [49/50] batch [40/167] time 0.119 (0.117) data 0.000 (0.006) loss 0.8421 (0.7655) ce_loss 0.4902 (0.3636) teacher_loss 0.3012 (0.2347) loss_zs_kd 0.1121 (0.1145) loss_oracle 0.4848 (0.4735) acc 84.3750 (86.1719) kd_loss 0.9061 (0.8972) lr 1.7713e-05 eta 0:00:34
epoch [49/50] batch [60/167] time 0.116 (0.114) data 0.000 (0.004) loss 0.8750 (0.7693) ce_loss 0.4495 (0.3701) teacher_loss 0.3476 (0.2432) loss_zs_kd 0.1146 (0.1115) loss_oracle 0.4702 (0.4703) acc 78.1250 (86.0417) kd_loss 0.8910 (0.8937) lr 1.7713e-05 eta 0:00:31
epoch [49/50] batch [80/167] time 0.135 (0.114) data 0.000 (0.003) loss 0.7750 (0.7630) ce_loss 0.4172 (0.3665) teacher_loss 0.2659 (0.2411) loss_zs_kd 0.1310 (0.1113) loss_oracle 0.4436 (0.4663) acc 81.2500 (86.1719) kd_loss 0.8921 (0.8912) lr 1.7713e-05 eta 0:00:28
epoch [49/50] batch [100/167] time 0.078 (0.112) data 0.000 (0.003) loss 0.6738 (0.7712) ce_loss 0.2217 (0.3807) teacher_loss 0.0934 (0.2493) loss_zs_kd 0.1086 (0.1130) loss_oracle 0.5261 (0.4653) acc 93.7500 (85.5000) kd_loss 0.9277 (0.8893) lr 1.7713e-05 eta 0:00:26
epoch [49/50] batch [120/167] time 0.116 (0.113) data 0.000 (0.002) loss 0.7234 (0.7727) ce_loss 0.3191 (0.3835) teacher_loss 0.2162 (0.2501) loss_zs_kd 0.1103 (0.1133) loss_oracle 0.4521 (0.4659) acc 87.5000 (85.5208) kd_loss 0.8475 (0.8889) lr 1.7713e-05 eta 0:00:24
epoch [49/50] batch [140/167] time 0.103 (0.112) data 0.000 (0.002) loss 0.7487 (0.7697) ce_loss 0.3564 (0.3834) teacher_loss 0.2964 (0.2503) loss_zs_kd 0.0796 (0.1129) loss_oracle 0.4126 (0.4630) acc 87.5000 (85.5134) kd_loss 0.8517 (0.8873) lr 1.7713e-05 eta 0:00:21
epoch [49/50] batch [160/167] time 0.080 (0.111) data 0.000 (0.002) loss 0.8059 (0.7757) ce_loss 0.3528 (0.3882) teacher_loss 0.2923 (0.2547) loss_zs_kd 0.1306 (0.1120) loss_oracle 0.4483 (0.4649) acc 84.3750 (85.3516) kd_loss 0.8814 (0.8868) lr 1.7713e-05 eta 0:00:19
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,200
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.2%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [50/50] batch [20/167] time 0.129 (0.114) data 0.000 (0.012) loss 0.8567 (0.7579) ce_loss 0.4421 (0.3877) teacher_loss 0.3085 (0.2298) loss_zs_kd 0.1177 (0.1178) loss_oracle 0.4893 (0.4693) acc 87.5000 (85.1562) kd_loss 0.9255 (0.8929) lr 7.8853e-06 eta 0:00:16
epoch [50/50] batch [40/167] time 0.109 (0.107) data 0.000 (0.006) loss 0.7349 (0.7457) ce_loss 0.3459 (0.3699) teacher_loss 0.2181 (0.2238) loss_zs_kd 0.1004 (0.1157) loss_oracle 0.4666 (0.4641) acc 87.5000 (86.0938) kd_loss 0.9207 (0.8844) lr 7.8853e-06 eta 0:00:13
epoch [50/50] batch [60/167] time 0.134 (0.105) data 0.001 (0.004) loss 0.8223 (0.7368) ce_loss 0.3662 (0.3530) teacher_loss 0.2896 (0.2131) loss_zs_kd 0.0887 (0.1095) loss_oracle 0.4884 (0.4690) acc 84.3750 (86.7188) kd_loss 0.9277 (0.8906) lr 7.8853e-06 eta 0:00:11
epoch [50/50] batch [80/167] time 0.088 (0.104) data 0.000 (0.003) loss 0.5890 (0.7402) ce_loss 0.2764 (0.3496) teacher_loss 0.1300 (0.2160) loss_zs_kd 0.0855 (0.1069) loss_oracle 0.4163 (0.4708) acc 90.6250 (87.0703) kd_loss 0.8881 (0.8918) lr 7.8853e-06 eta 0:00:09
epoch [50/50] batch [100/167] time 0.105 (0.104) data 0.000 (0.002) loss 0.7822 (0.7497) ce_loss 0.3425 (0.3591) teacher_loss 0.2170 (0.2237) loss_zs_kd 0.1077 (0.1079) loss_oracle 0.5114 (0.4721) acc 90.6250 (86.5938) kd_loss 0.9379 (0.8895) lr 7.8853e-06 eta 0:00:06
epoch [50/50] batch [120/167] time 0.096 (0.104) data 0.000 (0.002) loss 0.8133 (0.7516) ce_loss 0.2842 (0.3593) teacher_loss 0.2557 (0.2231) loss_zs_kd 0.1113 (0.1099) loss_oracle 0.5019 (0.4736) acc 90.6250 (86.5625) kd_loss 0.9337 (0.8903) lr 7.8853e-06 eta 0:00:04
epoch [50/50] batch [140/167] time 0.138 (0.105) data 0.000 (0.002) loss 0.7042 (0.7539) ce_loss 0.4321 (0.3632) teacher_loss 0.2578 (0.2268) loss_zs_kd 0.1311 (0.1110) loss_oracle 0.3809 (0.4716) acc 90.6250 (86.4509) kd_loss 0.8344 (0.8885) lr 7.8853e-06 eta 0:00:02
epoch [50/50] batch [160/167] time 0.098 (0.104) data 0.000 (0.002) loss 0.7297 (0.7554) ce_loss 0.3611 (0.3665) teacher_loss 0.2202 (0.2305) loss_zs_kd 0.1098 (0.1119) loss_oracle 0.4546 (0.4690) acc 87.5000 (86.3477) kd_loss 0.8669 (0.8886) lr 7.8853e-06 eta 0:00:00
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,199
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.2%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      96.0%, epoch: 26 *******
******* Domain c best val test acc: 99.0%, epoch: 26 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
Checkpoint saved to icml/multi-dg/oracle/04_nonnegative/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:21:13
