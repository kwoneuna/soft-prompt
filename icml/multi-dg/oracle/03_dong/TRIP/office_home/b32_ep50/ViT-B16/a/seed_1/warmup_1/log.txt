Loading trainer: TRIP
Loading dataset: SPG_OfficeHome
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ------------------------------------
Dataset    SPG_OfficeHome
Source     ['clipart', 'product', 'real_world']
Target     ['art']
# classes  65
# train_x  9,222
# val      3,939
# test     2,427
---------  ------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/288] time 0.166 (0.223) data 0.000 (0.024) loss 1.1134 (1.2413) ce_loss 1.1113 (1.2380) teacher_loss 1.1109 (1.2381) loss_zs_kd 0.0000 (0.0000) loss_oracle 0.0025 (0.0032) acc 68.7500 (68.2812) kd_loss 0.0097 (0.0128) lr 1.0000e-05 eta 0:53:20
epoch [1/50] batch [40/288] time 0.170 (0.196) data 0.000 (0.012) loss 1.2206 (1.2627) ce_loss 1.2168 (1.2595) teacher_loss 1.2164 (1.2595) loss_zs_kd 0.0002 (0.0000) loss_oracle 0.0041 (0.0032) acc 65.6250 (68.2031) kd_loss 0.0168 (0.0129) lr 1.0000e-05 eta 0:46:55
epoch [1/50] batch [60/288] time 0.155 (0.184) data 0.001 (0.008) loss 1.4309 (1.2694) ce_loss 1.4297 (1.2663) teacher_loss 1.4285 (1.2663) loss_zs_kd 0.0006 (0.0001) loss_oracle 0.0021 (0.0030) acc 59.3750 (67.6042) kd_loss 0.0076 (0.0122) lr 1.0000e-05 eta 0:43:58
epoch [1/50] batch [80/288] time 0.173 (0.179) data 0.000 (0.006) loss 1.2614 (1.2732) ce_loss 1.2578 (1.2704) teacher_loss 1.2569 (1.2703) loss_zs_kd 0.0008 (0.0002) loss_oracle 0.0040 (0.0029) acc 62.5000 (67.3828) kd_loss 0.0158 (0.0115) lr 1.0000e-05 eta 0:42:39
epoch [1/50] batch [100/288] time 0.149 (0.175) data 0.000 (0.005) loss 1.0926 (1.2454) ce_loss 1.0908 (1.2427) teacher_loss 1.0898 (1.2425) loss_zs_kd 0.0005 (0.0003) loss_oracle 0.0025 (0.0027) acc 62.5000 (68.0938) kd_loss 0.0101 (0.0106) lr 1.0000e-05 eta 0:41:49
epoch [1/50] batch [120/288] time 0.172 (0.173) data 0.000 (0.004) loss 1.0349 (1.2390) ce_loss 1.0352 (1.2366) teacher_loss 1.0325 (1.2363) loss_zs_kd 0.0007 (0.0004) loss_oracle 0.0021 (0.0025) acc 75.0000 (68.1510) kd_loss 0.0066 (0.0097) lr 1.0000e-05 eta 0:41:04
epoch [1/50] batch [140/288] time 0.084 (0.174) data 0.000 (0.004) loss 1.4868 (1.2249) ce_loss 1.4863 (1.2226) teacher_loss 1.4844 (1.2224) loss_zs_kd 0.0010 (0.0005) loss_oracle 0.0019 (0.0023) acc 56.2500 (68.2812) kd_loss 0.0050 (0.0090) lr 1.0000e-05 eta 0:41:23
epoch [1/50] batch [160/288] time 0.174 (0.178) data 0.000 (0.003) loss 1.0574 (1.2224) ce_loss 1.0547 (1.2202) teacher_loss 1.0557 (1.2199) loss_zs_kd 0.0019 (0.0006) loss_oracle 0.0008 (0.0022) acc 71.8750 (68.6133) kd_loss 0.0024 (0.0084) lr 1.0000e-05 eta 0:42:15
epoch [1/50] batch [180/288] time 0.155 (0.176) data 0.000 (0.003) loss 0.9956 (1.2259) ce_loss 0.9922 (1.2237) teacher_loss 0.9936 (1.2234) loss_zs_kd 0.0023 (0.0007) loss_oracle 0.0008 (0.0021) acc 71.8750 (68.4375) kd_loss 0.0026 (0.0079) lr 1.0000e-05 eta 0:41:38
epoch [1/50] batch [200/288] time 0.172 (0.174) data 0.000 (0.003) loss 1.3386 (1.2226) ce_loss 1.3379 (1.2205) teacher_loss 1.3370 (1.2202) loss_zs_kd 0.0020 (0.0008) loss_oracle 0.0007 (0.0020) acc 62.5000 (68.3281) kd_loss 0.0028 (0.0075) lr 1.0000e-05 eta 0:41:13
epoch [1/50] batch [220/288] time 0.179 (0.173) data 0.000 (0.002) loss 1.4192 (1.2183) ce_loss 1.4160 (1.2161) teacher_loss 1.4172 (1.2159) loss_zs_kd 0.0022 (0.0010) loss_oracle 0.0009 (0.0019) acc 65.6250 (68.5938) kd_loss 0.0028 (0.0070) lr 1.0000e-05 eta 0:40:53
epoch [1/50] batch [240/288] time 0.168 (0.172) data 0.000 (0.002) loss 0.9869 (1.2158) ce_loss 0.9849 (1.2137) teacher_loss 0.9854 (1.2135) loss_zs_kd 0.0010 (0.0011) loss_oracle 0.0010 (0.0018) acc 81.2500 (68.8542) kd_loss 0.0038 (0.0067) lr 1.0000e-05 eta 0:40:38
epoch [1/50] batch [260/288] time 0.168 (0.171) data 0.000 (0.002) loss 1.3066 (1.2215) ce_loss 1.3037 (1.2193) teacher_loss 1.3031 (1.2191) loss_zs_kd 0.0053 (0.0012) loss_oracle 0.0009 (0.0017) acc 71.8750 (68.7019) kd_loss 0.0024 (0.0064) lr 1.0000e-05 eta 0:40:23
epoch [1/50] batch [280/288] time 0.085 (0.173) data 0.000 (0.002) loss 1.5228 (1.2214) ce_loss 1.5186 (1.2192) teacher_loss 1.5193 (1.2190) loss_zs_kd 0.0052 (0.0014) loss_oracle 0.0009 (0.0017) acc 62.5000 (68.7612) kd_loss 0.0027 (0.0061) lr 1.0000e-05 eta 0:40:36
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,264
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 81.9%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 1,963
* accuracy: 80.9%
* error: 19.1%
* macro_f1: 76.6%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain a best val acc:      82.9%, epoch: 1 *******
******* Domain a best val test acc: 80.9%, epoch: 1 *******
******* Domain a best test acc:     80.9%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/ana
epoch [2/50] batch [20/288] time 0.174 (0.183) data 0.000 (0.014) loss 1.1004 (1.2407) ce_loss 1.0449 (1.1903) teacher_loss 1.0464 (1.1909) loss_zs_kd 0.0997 (0.0958) loss_oracle 0.0041 (0.0019) acc 65.6250 (68.7500) kd_loss 0.0024 (0.0020) lr 2.0000e-03 eta 0:43:01
epoch [2/50] batch [40/288] time 0.154 (0.173) data 0.000 (0.007) loss 0.7482 (1.1873) ce_loss 0.6909 (1.1246) teacher_loss 0.6936 (1.1264) loss_zs_kd 0.0867 (0.1083) loss_oracle 0.0113 (0.0067) acc 81.2500 (70.2344) kd_loss 0.0011 (0.0019) lr 2.0000e-03 eta 0:40:41
epoch [2/50] batch [60/288] time 0.160 (0.171) data 0.001 (0.005) loss 1.3856 (1.1918) ce_loss 1.3252 (1.1282) teacher_loss 1.3259 (1.1300) loss_zs_kd 0.0938 (0.1062) loss_oracle 0.0129 (0.0087) acc 68.7500 (70.4688) kd_loss 0.0031 (0.0020) lr 2.0000e-03 eta 0:40:05
epoch [2/50] batch [80/288] time 0.343 (0.174) data 0.000 (0.004) loss 0.8877 (1.1757) ce_loss 0.8394 (1.1137) teacher_loss 0.8410 (1.1154) loss_zs_kd 0.0810 (0.1021) loss_oracle 0.0062 (0.0092) acc 71.8750 (71.2500) kd_loss 0.0021 (0.0022) lr 2.0000e-03 eta 0:40:45
epoch [2/50] batch [100/288] time 0.152 (0.182) data 0.000 (0.003) loss 1.5377 (1.1742) ce_loss 1.4922 (1.1133) teacher_loss 1.4937 (1.1150) loss_zs_kd 0.0768 (0.1010) loss_oracle 0.0055 (0.0087) acc 62.5000 (71.2500) kd_loss 0.0034 (0.0023) lr 2.0000e-03 eta 0:42:30
epoch [2/50] batch [120/288] time 0.165 (0.179) data 0.000 (0.003) loss 1.1474 (1.1694) ce_loss 1.1104 (1.1092) teacher_loss 1.1120 (1.1107) loss_zs_kd 0.0552 (0.1007) loss_oracle 0.0078 (0.0084) acc 71.8750 (71.2240) kd_loss 0.0026 (0.0025) lr 2.0000e-03 eta 0:41:41
epoch [2/50] batch [140/288] time 0.156 (0.177) data 0.000 (0.002) loss 1.2924 (1.1729) ce_loss 1.2129 (1.1135) teacher_loss 1.2175 (1.1150) loss_zs_kd 0.1238 (0.0979) loss_oracle 0.0130 (0.0090) acc 68.7500 (70.9821) kd_loss 0.0039 (0.0026) lr 2.0000e-03 eta 0:41:06
epoch [2/50] batch [160/288] time 0.173 (0.175) data 0.000 (0.002) loss 1.2174 (1.1743) ce_loss 1.1045 (1.1135) teacher_loss 1.1109 (1.1154) loss_zs_kd 0.1708 (0.0973) loss_oracle 0.0212 (0.0102) acc 68.7500 (70.9180) kd_loss 0.0047 (0.0028) lr 2.0000e-03 eta 0:40:47
epoch [2/50] batch [180/288] time 0.171 (0.175) data 0.000 (0.002) loss 1.0766 (1.1705) ce_loss 1.0020 (1.1079) teacher_loss 1.0063 (1.1099) loss_zs_kd 0.1072 (0.0982) loss_oracle 0.0166 (0.0115) acc 78.1250 (71.0590) kd_loss 0.0049 (0.0030) lr 2.0000e-03 eta 0:40:36
epoch [2/50] batch [200/288] time 0.104 (0.175) data 0.001 (0.002) loss 1.8515 (1.1742) ce_loss 1.7373 (1.1091) teacher_loss 1.7442 (1.1112) loss_zs_kd 0.1532 (0.1011) loss_oracle 0.0308 (0.0125) acc 56.2500 (70.9062) kd_loss 0.0068 (0.0033) lr 2.0000e-03 eta 0:40:31
epoch [2/50] batch [220/288] time 0.382 (0.183) data 0.000 (0.001) loss 1.2324 (1.1659) ce_loss 1.1328 (1.0977) teacher_loss 1.1318 (1.1000) loss_zs_kd 0.1170 (0.1017) loss_oracle 0.0422 (0.0151) acc 71.8750 (71.1648) kd_loss 0.0084 (0.0036) lr 2.0000e-03 eta 0:42:15
epoch [2/50] batch [240/288] time 0.193 (0.181) data 0.000 (0.001) loss 1.4729 (1.1626) ce_loss 1.3877 (1.0929) teacher_loss 1.3902 (1.0952) loss_zs_kd 0.0970 (0.1019) loss_oracle 0.0342 (0.0164) acc 65.6250 (71.2760) kd_loss 0.0086 (0.0040) lr 2.0000e-03 eta 0:41:51
epoch [2/50] batch [260/288] time 0.181 (0.181) data 0.000 (0.001) loss 1.1972 (1.1600) ce_loss 1.0752 (1.0884) teacher_loss 1.0748 (1.0907) loss_zs_kd 0.1907 (0.1029) loss_oracle 0.0271 (0.0178) acc 78.1250 (71.3822) kd_loss 0.0112 (0.0046) lr 2.0000e-03 eta 0:41:47
epoch [2/50] batch [280/288] time 0.161 (0.181) data 0.000 (0.001) loss 0.9151 (1.1562) ce_loss 0.8159 (1.0836) teacher_loss 0.8171 (1.0859) loss_zs_kd 0.1273 (0.1033) loss_oracle 0.0343 (0.0186) acc 75.0000 (71.4286) kd_loss 0.0143 (0.0053) lr 2.0000e-03 eta 0:41:41
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,387
* accuracy: 86.0%
* error: 14.0%
* macro_f1: 85.3%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,025
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 79.8%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain a best val acc:      86.0%, epoch: 2 *******
******* Domain a best val test acc: 83.4%, epoch: 2 *******
******* Domain a best test acc:     83.4%, epoch: 2 *******
epoch [3/50] batch [20/288] time 0.185 (0.223) data 0.000 (0.015) loss 1.5864 (1.1733) ce_loss 1.4844 (1.0720) teacher_loss 1.4894 (1.0729) loss_zs_kd 0.1307 (0.1162) loss_oracle 0.0317 (0.0423) acc 53.1250 (71.4062) kd_loss 0.0135 (0.0152) lr 1.9980e-03 eta 0:51:12
epoch [3/50] batch [40/288] time 0.177 (0.200) data 0.000 (0.008) loss 0.9314 (1.0910) ce_loss 0.8618 (0.9985) teacher_loss 0.8680 (1.0006) loss_zs_kd 0.0716 (0.1084) loss_oracle 0.0276 (0.0361) acc 78.1250 (73.5156) kd_loss 0.0158 (0.0153) lr 1.9980e-03 eta 0:46:00
epoch [3/50] batch [60/288] time 0.166 (0.188) data 0.000 (0.005) loss 1.0136 (1.1359) ce_loss 0.9360 (1.0463) teacher_loss 0.9385 (1.0483) loss_zs_kd 0.0838 (0.1076) loss_oracle 0.0331 (0.0338) acc 75.0000 (72.5521) kd_loss 0.0199 (0.0157) lr 1.9980e-03 eta 0:43:09
epoch [3/50] batch [80/288] time 0.148 (0.181) data 0.000 (0.004) loss 1.1275 (1.1430) ce_loss 1.0078 (1.0487) teacher_loss 1.0117 (1.0510) loss_zs_kd 0.1045 (0.1080) loss_oracle 0.0636 (0.0380) acc 75.0000 (72.4609) kd_loss 0.0182 (0.0163) lr 1.9980e-03 eta 0:41:33
epoch [3/50] batch [100/288] time 0.148 (0.176) data 0.000 (0.003) loss 1.0637 (1.1570) ce_loss 0.9624 (1.0601) teacher_loss 0.9677 (1.0625) loss_zs_kd 0.0964 (0.1085) loss_oracle 0.0478 (0.0402) acc 75.0000 (72.1875) kd_loss 0.0236 (0.0178) lr 1.9980e-03 eta 0:40:20
epoch [3/50] batch [120/288] time 0.157 (0.174) data 0.000 (0.003) loss 0.8948 (1.1539) ce_loss 0.7056 (1.0493) teacher_loss 0.7066 (1.0519) loss_zs_kd 0.1336 (0.1125) loss_oracle 0.1214 (0.0457) acc 78.1250 (72.5781) kd_loss 0.0395 (0.0199) lr 1.9980e-03 eta 0:39:45
epoch [3/50] batch [140/288] time 0.362 (0.177) data 0.000 (0.002) loss 1.1142 (1.1560) ce_loss 0.9941 (1.0451) teacher_loss 0.9944 (1.0475) loss_zs_kd 0.0731 (0.1130) loss_oracle 0.0832 (0.0520) acc 75.0000 (72.4777) kd_loss 0.0427 (0.0228) lr 1.9980e-03 eta 0:40:26
epoch [3/50] batch [160/288] time 0.168 (0.179) data 0.000 (0.002) loss 1.6866 (1.1653) ce_loss 1.5352 (1.0496) teacher_loss 1.5479 (1.0521) loss_zs_kd 0.1410 (0.1147) loss_oracle 0.0682 (0.0559) acc 59.3750 (72.2461) kd_loss 0.0390 (0.0251) lr 1.9980e-03 eta 0:40:46
epoch [3/50] batch [180/288] time 0.148 (0.177) data 0.000 (0.002) loss 1.2230 (1.1667) ce_loss 1.1016 (1.0497) teacher_loss 1.1080 (1.0519) loss_zs_kd 0.1184 (0.1139) loss_oracle 0.0557 (0.0579) acc 71.8750 (72.3264) kd_loss 0.0361 (0.0269) lr 1.9980e-03 eta 0:40:09
epoch [3/50] batch [200/288] time 0.164 (0.175) data 0.000 (0.002) loss 1.1621 (1.1682) ce_loss 1.0195 (1.0479) teacher_loss 1.0167 (1.0496) loss_zs_kd 0.0948 (0.1139) loss_oracle 0.0980 (0.0616) acc 75.0000 (72.4375) kd_loss 0.0567 (0.0292) lr 1.9980e-03 eta 0:39:37
epoch [3/50] batch [220/288] time 0.151 (0.174) data 0.000 (0.002) loss 0.9421 (1.1803) ce_loss 0.8296 (1.0577) teacher_loss 0.8327 (1.0592) loss_zs_kd 0.1146 (0.1154) loss_oracle 0.0521 (0.0634) acc 75.0000 (72.2443) kd_loss 0.0488 (0.0315) lr 1.9980e-03 eta 0:39:20
epoch [3/50] batch [240/288] time 0.174 (0.173) data 0.000 (0.001) loss 1.4156 (1.1825) ce_loss 1.3086 (1.0617) teacher_loss 1.3128 (1.0629) loss_zs_kd 0.0925 (0.1151) loss_oracle 0.0566 (0.0620) acc 65.6250 (72.1615) kd_loss 0.0561 (0.0330) lr 1.9980e-03 eta 0:39:08
epoch [3/50] batch [260/288] time 0.185 (0.172) data 0.000 (0.001) loss 0.7785 (1.1765) ce_loss 0.6802 (1.0569) teacher_loss 0.6425 (1.0580) loss_zs_kd 0.1177 (0.1153) loss_oracle 0.0771 (0.0609) acc 87.5000 (72.1875) kd_loss 0.0543 (0.0340) lr 1.9980e-03 eta 0:38:58
epoch [3/50] batch [280/288] time 0.083 (0.174) data 0.000 (0.001) loss 1.2822 (1.1738) ce_loss 1.1064 (1.0530) teacher_loss 1.1031 (1.0540) loss_zs_kd 0.1946 (0.1166) loss_oracle 0.0818 (0.0615) acc 68.7500 (72.3438) kd_loss 0.0563 (0.0350) lr 1.9980e-03 eta 0:39:12
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,397
* accuracy: 86.2%
* error: 13.8%
* macro_f1: 85.5%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,011
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 79.3%
******* Domain a best val acc:      86.2%, epoch: 3 *******
******* Domain a best val test acc: 82.9%, epoch: 3 *******
******* Domain a best test acc:     83.4%, epoch: 2 *******
epoch [4/50] batch [20/288] time 0.147 (0.176) data 0.000 (0.014) loss 0.9987 (1.1243) ce_loss 0.8447 (0.9919) teacher_loss 0.8464 (0.9895) loss_zs_kd 0.0936 (0.1104) loss_oracle 0.1055 (0.0796) acc 84.3750 (73.5938) kd_loss 0.0483 (0.0477) lr 1.9921e-03 eta 0:39:32
epoch [4/50] batch [40/288] time 0.170 (0.169) data 0.000 (0.007) loss 1.2450 (1.1303) ce_loss 1.1016 (1.0010) teacher_loss 1.1008 (0.9996) loss_zs_kd 0.1979 (0.1158) loss_oracle 0.0453 (0.0728) acc 68.7500 (73.2031) kd_loss 0.0423 (0.0469) lr 1.9921e-03 eta 0:37:55
epoch [4/50] batch [60/288] time 0.150 (0.166) data 0.000 (0.005) loss 1.2837 (1.1133) ce_loss 1.1924 (0.9928) teacher_loss 1.2010 (0.9933) loss_zs_kd 0.0900 (0.1133) loss_oracle 0.0377 (0.0633) acc 68.7500 (73.2292) kd_loss 0.0328 (0.0464) lr 1.9921e-03 eta 0:37:18
epoch [4/50] batch [80/288] time 0.173 (0.165) data 0.000 (0.004) loss 1.5289 (1.1280) ce_loss 1.4326 (1.0119) teacher_loss 1.4418 (1.0126) loss_zs_kd 0.0916 (0.1111) loss_oracle 0.0413 (0.0599) acc 65.6250 (73.1250) kd_loss 0.0360 (0.0452) lr 1.9921e-03 eta 0:37:03
epoch [4/50] batch [100/288] time 0.093 (0.167) data 0.000 (0.003) loss 1.0305 (1.1438) ce_loss 0.9502 (1.0327) teacher_loss 0.9394 (1.0332) loss_zs_kd 0.0827 (0.1075) loss_oracle 0.0498 (0.0569) acc 78.1250 (72.5938) kd_loss 0.0385 (0.0434) lr 1.9921e-03 eta 0:37:21
epoch [4/50] batch [120/288] time 0.166 (0.173) data 0.000 (0.003) loss 1.0580 (1.1507) ce_loss 0.9473 (1.0409) teacher_loss 0.9523 (1.0412) loss_zs_kd 0.1095 (0.1066) loss_oracle 0.0510 (0.0562) acc 78.1250 (72.5000) kd_loss 0.0308 (0.0421) lr 1.9921e-03 eta 0:38:36
epoch [4/50] batch [140/288] time 0.149 (0.171) data 0.000 (0.002) loss 0.8835 (1.1574) ce_loss 0.8013 (1.0475) teacher_loss 0.8045 (1.0477) loss_zs_kd 0.0958 (0.1082) loss_oracle 0.0311 (0.0556) acc 81.2500 (72.3661) kd_loss 0.0252 (0.0411) lr 1.9921e-03 eta 0:38:07
epoch [4/50] batch [160/288] time 0.166 (0.169) data 0.000 (0.002) loss 1.3111 (1.1494) ce_loss 1.2275 (1.0404) teacher_loss 1.2214 (1.0404) loss_zs_kd 0.1125 (0.1106) loss_oracle 0.0334 (0.0537) acc 71.8750 (72.4219) kd_loss 0.0303 (0.0402) lr 1.9921e-03 eta 0:37:46
epoch [4/50] batch [180/288] time 0.173 (0.169) data 0.000 (0.002) loss 1.5034 (1.1460) ce_loss 1.3848 (1.0381) teacher_loss 1.3870 (1.0381) loss_zs_kd 0.1500 (0.1114) loss_oracle 0.0414 (0.0522) acc 62.5000 (72.3785) kd_loss 0.0228 (0.0391) lr 1.9921e-03 eta 0:37:31
epoch [4/50] batch [200/288] time 0.164 (0.168) data 0.000 (0.002) loss 1.2299 (1.1441) ce_loss 1.1191 (1.0350) teacher_loss 1.1192 (1.0351) loss_zs_kd 0.1079 (0.1140) loss_oracle 0.0567 (0.0520) acc 71.8750 (72.6094) kd_loss 0.0301 (0.0381) lr 1.9921e-03 eta 0:37:19
epoch [4/50] batch [220/288] time 0.154 (0.167) data 0.000 (0.001) loss 1.2801 (1.1461) ce_loss 1.1758 (1.0359) teacher_loss 1.1776 (1.0360) loss_zs_kd 0.1004 (0.1153) loss_oracle 0.0524 (0.0524) acc 68.7500 (72.4574) kd_loss 0.0306 (0.0376) lr 1.9921e-03 eta 0:37:08
epoch [4/50] batch [240/288] time 0.096 (0.169) data 0.000 (0.001) loss 1.3215 (1.1436) ce_loss 1.2168 (1.0332) teacher_loss 1.1998 (1.0334) loss_zs_kd 0.1290 (0.1153) loss_oracle 0.0572 (0.0525) acc 68.7500 (72.6172) kd_loss 0.0306 (0.0368) lr 1.9921e-03 eta 0:37:27
epoch [4/50] batch [260/288] time 0.144 (0.172) data 0.000 (0.001) loss 0.9528 (1.1488) ce_loss 0.8301 (1.0375) teacher_loss 0.8296 (1.0376) loss_zs_kd 0.1243 (0.1160) loss_oracle 0.0610 (0.0532) acc 75.0000 (72.4880) kd_loss 0.0293 (0.0364) lr 1.9921e-03 eta 0:38:00
epoch [4/50] batch [280/288] time 0.144 (0.171) data 0.000 (0.001) loss 0.8166 (1.1439) ce_loss 0.7271 (1.0332) teacher_loss 0.7317 (1.0332) loss_zs_kd 0.0924 (0.1149) loss_oracle 0.0387 (0.0533) acc 81.2500 (72.7567) kd_loss 0.0219 (0.0361) lr 1.9921e-03 eta 0:37:40
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,411
* accuracy: 86.6%
* error: 13.4%
* macro_f1: 85.8%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,026
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 80.1%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain a best val acc:      86.6%, epoch: 4 *******
******* Domain a best val test acc: 83.5%, epoch: 4 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [5/50] batch [20/288] time 0.171 (0.171) data 0.000 (0.013) loss 1.5679 (1.3031) ce_loss 1.4199 (1.1790) teacher_loss 1.4257 (1.1782) loss_zs_kd 0.1400 (0.1434) loss_oracle 0.0722 (0.0532) acc 71.8750 (69.8438) kd_loss 0.0422 (0.0361) lr 1.9823e-03 eta 0:37:37
epoch [5/50] batch [40/288] time 0.136 (0.164) data 0.000 (0.007) loss 0.6681 (1.2006) ce_loss 0.4939 (1.0696) teacher_loss 0.4970 (1.0679) loss_zs_kd 0.1801 (0.1365) loss_oracle 0.0811 (0.0645) acc 90.6250 (71.9531) kd_loss 0.0447 (0.0396) lr 1.9823e-03 eta 0:36:08
epoch [5/50] batch [60/288] time 0.358 (0.181) data 0.001 (0.005) loss 1.2623 (1.1664) ce_loss 1.1689 (1.0380) teacher_loss 1.1708 (1.0356) loss_zs_kd 0.0793 (0.1286) loss_oracle 0.0518 (0.0664) acc 62.5000 (73.1771) kd_loss 0.0428 (0.0414) lr 1.9823e-03 eta 0:39:49
epoch [5/50] batch [80/288] time 0.148 (0.178) data 0.000 (0.003) loss 1.5145 (1.1462) ce_loss 1.4111 (1.0210) teacher_loss 1.4114 (1.0174) loss_zs_kd 0.1027 (0.1282) loss_oracle 0.0517 (0.0647) acc 71.8750 (73.3594) kd_loss 0.0389 (0.0425) lr 1.9823e-03 eta 0:39:03
epoch [5/50] batch [100/288] time 0.171 (0.175) data 0.000 (0.003) loss 0.8253 (1.1558) ce_loss 0.6899 (1.0292) teacher_loss 0.6842 (1.0256) loss_zs_kd 0.1169 (0.1279) loss_oracle 0.0827 (0.0663) acc 84.3750 (73.2500) kd_loss 0.0446 (0.0437) lr 1.9823e-03 eta 0:38:22
epoch [5/50] batch [120/288] time 0.163 (0.173) data 0.000 (0.002) loss 1.1824 (1.1489) ce_loss 1.0303 (1.0205) teacher_loss 1.0291 (1.0168) loss_zs_kd 0.1432 (0.1250) loss_oracle 0.0818 (0.0696) acc 75.0000 (73.4115) kd_loss 0.0542 (0.0447) lr 1.9823e-03 eta 0:37:50
epoch [5/50] batch [140/288] time 0.168 (0.171) data 0.000 (0.002) loss 1.2199 (1.1524) ce_loss 1.0840 (1.0246) teacher_loss 1.0938 (1.0203) loss_zs_kd 0.1073 (0.1221) loss_oracle 0.0724 (0.0711) acc 65.6250 (73.3929) kd_loss 0.0479 (0.0453) lr 1.9823e-03 eta 0:37:22
epoch [5/50] batch [160/288] time 0.150 (0.170) data 0.000 (0.002) loss 1.4170 (1.1558) ce_loss 1.2959 (1.0271) teacher_loss 1.2994 (1.0230) loss_zs_kd 0.1122 (0.1218) loss_oracle 0.0615 (0.0719) acc 68.7500 (73.2031) kd_loss 0.0434 (0.0461) lr 1.9823e-03 eta 0:36:58
epoch [5/50] batch [180/288] time 0.163 (0.168) data 0.000 (0.002) loss 1.1257 (1.1634) ce_loss 0.9844 (1.0329) teacher_loss 0.9669 (1.0294) loss_zs_kd 0.1093 (0.1223) loss_oracle 0.1041 (0.0729) acc 71.8750 (73.0382) kd_loss 0.0549 (0.0468) lr 1.9823e-03 eta 0:36:38
epoch [5/50] batch [200/288] time 0.083 (0.169) data 0.000 (0.001) loss 1.1131 (1.1665) ce_loss 0.9902 (1.0359) teacher_loss 0.9767 (1.0324) loss_zs_kd 0.1084 (0.1210) loss_oracle 0.0822 (0.0736) acc 78.1250 (72.9531) kd_loss 0.0533 (0.0475) lr 1.9823e-03 eta 0:36:47
epoch [5/50] batch [220/288] time 0.155 (0.171) data 0.000 (0.001) loss 1.3197 (1.1700) ce_loss 1.1943 (1.0392) teacher_loss 1.1900 (1.0360) loss_zs_kd 0.1175 (0.1210) loss_oracle 0.0708 (0.0735) acc 75.0000 (72.6420) kd_loss 0.0404 (0.0474) lr 1.9823e-03 eta 0:37:10
epoch [5/50] batch [240/288] time 0.169 (0.170) data 0.001 (0.001) loss 0.9441 (1.1691) ce_loss 0.8252 (1.0373) teacher_loss 0.8188 (1.0342) loss_zs_kd 0.0984 (0.1206) loss_oracle 0.0762 (0.0745) acc 81.2500 (72.6562) kd_loss 0.0563 (0.0477) lr 1.9823e-03 eta 0:36:55
epoch [5/50] batch [260/288] time 0.144 (0.169) data 0.000 (0.001) loss 1.2178 (1.1640) ce_loss 1.1201 (1.0316) teacher_loss 1.1162 (1.0283) loss_zs_kd 0.0737 (0.1205) loss_oracle 0.0647 (0.0755) acc 65.6250 (72.7284) kd_loss 0.0343 (0.0482) lr 1.9823e-03 eta 0:36:38
epoch [5/50] batch [280/288] time 0.146 (0.168) data 0.000 (0.001) loss 0.8786 (1.1553) ce_loss 0.7603 (1.0227) teacher_loss 0.7385 (1.0191) loss_zs_kd 0.1348 (0.1200) loss_oracle 0.0728 (0.0761) acc 78.1250 (72.9018) kd_loss 0.0447 (0.0487) lr 1.9823e-03 eta 0:36:23
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,402
* accuracy: 86.4%
* error: 13.6%
* macro_f1: 85.7%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,012
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 79.5%
******* Domain a best val acc:      86.6%, epoch: 4 *******
******* Domain a best val test acc: 83.5%, epoch: 4 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [6/50] batch [20/288] time 0.094 (0.204) data 0.000 (0.012) loss 1.2368 (1.0453) ce_loss 1.1152 (0.9245) teacher_loss 1.1130 (0.9216) loss_zs_kd 0.0898 (0.1061) loss_oracle 0.0789 (0.0706) acc 71.8750 (73.5938) kd_loss 0.0602 (0.0537) lr 1.9686e-03 eta 0:43:59
epoch [6/50] batch [40/288] time 0.149 (0.202) data 0.000 (0.006) loss 1.0859 (1.1067) ce_loss 0.9570 (0.9799) teacher_loss 0.9605 (0.9779) loss_zs_kd 0.1113 (0.1095) loss_oracle 0.0698 (0.0741) acc 75.0000 (72.8906) kd_loss 0.0464 (0.0537) lr 1.9686e-03 eta 0:43:34
epoch [6/50] batch [60/288] time 0.157 (0.188) data 0.001 (0.004) loss 1.1859 (1.0953) ce_loss 1.0391 (0.9677) teacher_loss 1.0253 (0.9650) loss_zs_kd 0.1510 (0.1092) loss_oracle 0.0851 (0.0757) acc 62.5000 (73.1771) kd_loss 0.0580 (0.0538) lr 1.9686e-03 eta 0:40:29
epoch [6/50] batch [80/288] time 0.167 (0.183) data 0.000 (0.003) loss 1.1408 (1.1014) ce_loss 1.0264 (0.9745) teacher_loss 1.0055 (0.9717) loss_zs_kd 0.1357 (0.1118) loss_oracle 0.0674 (0.0739) acc 68.7500 (73.2031) kd_loss 0.0446 (0.0534) lr 1.9686e-03 eta 0:39:23
epoch [6/50] batch [100/288] time 0.171 (0.179) data 0.000 (0.003) loss 1.4397 (1.1243) ce_loss 1.2803 (0.9940) teacher_loss 1.2634 (0.9903) loss_zs_kd 0.1310 (0.1116) loss_oracle 0.1107 (0.0782) acc 62.5000 (73.1875) kd_loss 0.0607 (0.0536) lr 1.9686e-03 eta 0:38:25
epoch [6/50] batch [120/288] time 0.168 (0.176) data 0.000 (0.002) loss 1.3380 (1.1213) ce_loss 1.1602 (0.9865) teacher_loss 1.1456 (0.9828) loss_zs_kd 0.1450 (0.1115) loss_oracle 0.1199 (0.0826) acc 71.8750 (73.8021) kd_loss 0.0682 (0.0544) lr 1.9686e-03 eta 0:37:45
epoch [6/50] batch [140/288] time 0.085 (0.174) data 0.000 (0.002) loss 0.9476 (1.1224) ce_loss 0.8267 (0.9870) teacher_loss 0.8259 (0.9831) loss_zs_kd 0.0743 (0.1115) loss_oracle 0.0845 (0.0835) acc 75.0000 (73.6607) kd_loss 0.0689 (0.0553) lr 1.9686e-03 eta 0:37:07
epoch [6/50] batch [160/288] time 0.373 (0.182) data 0.000 (0.002) loss 0.8526 (1.1267) ce_loss 0.6968 (0.9906) teacher_loss 0.6987 (0.9865) loss_zs_kd 0.1320 (0.1146) loss_oracle 0.0880 (0.0830) acc 75.0000 (73.5156) kd_loss 0.0500 (0.0554) lr 1.9686e-03 eta 0:38:50
epoch [6/50] batch [180/288] time 0.161 (0.180) data 0.001 (0.002) loss 0.9553 (1.1319) ce_loss 0.7549 (0.9935) teacher_loss 0.7383 (0.9890) loss_zs_kd 0.1718 (0.1164) loss_oracle 0.1311 (0.0848) acc 81.2500 (73.5417) kd_loss 0.0670 (0.0560) lr 1.9686e-03 eta 0:38:15
epoch [6/50] batch [200/288] time 0.168 (0.178) data 0.000 (0.001) loss 1.1837 (1.1365) ce_loss 1.0400 (0.9977) teacher_loss 1.0331 (0.9932) loss_zs_kd 0.1098 (0.1167) loss_oracle 0.0957 (0.0850) acc 68.7500 (73.5000) kd_loss 0.0657 (0.0559) lr 1.9686e-03 eta 0:37:56
epoch [6/50] batch [220/288] time 0.155 (0.177) data 0.000 (0.001) loss 1.3847 (1.1408) ce_loss 1.2178 (1.0006) teacher_loss 1.2127 (0.9962) loss_zs_kd 0.1434 (0.1174) loss_oracle 0.1003 (0.0860) acc 75.0000 (73.4943) kd_loss 0.0605 (0.0561) lr 1.9686e-03 eta 0:37:34
epoch [6/50] batch [240/288] time 0.181 (0.176) data 0.000 (0.001) loss 1.0798 (1.1455) ce_loss 0.9683 (1.0053) teacher_loss 0.9671 (1.0006) loss_zs_kd 0.0759 (0.1172) loss_oracle 0.0748 (0.0862) acc 75.0000 (73.3073) kd_loss 0.0760 (0.0568) lr 1.9686e-03 eta 0:37:20
epoch [6/50] batch [260/288] time 0.168 (0.175) data 0.000 (0.001) loss 1.3589 (1.1464) ce_loss 1.2549 (1.0078) teacher_loss 1.2420 (1.0029) loss_zs_kd 0.1037 (0.1182) loss_oracle 0.0650 (0.0844) acc 68.7500 (73.3173) kd_loss 0.0555 (0.0567) lr 1.9686e-03 eta 0:37:03
epoch [6/50] batch [280/288] time 0.085 (0.176) data 0.000 (0.001) loss 1.3849 (1.1453) ce_loss 1.2178 (1.0070) teacher_loss 1.2118 (1.0023) loss_zs_kd 0.1616 (0.1185) loss_oracle 0.0922 (0.0837) acc 75.0000 (73.4487) kd_loss 0.0617 (0.0564) lr 1.9686e-03 eta 0:37:14
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,405
* accuracy: 86.4%
* error: 13.6%
* macro_f1: 85.8%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,022
* accuracy: 83.3%
* error: 16.7%
* macro_f1: 79.8%
******* Domain a best val acc:      86.6%, epoch: 4 *******
******* Domain a best val test acc: 83.5%, epoch: 4 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [7/50] batch [20/288] time 0.170 (0.177) data 0.000 (0.015) loss 1.3168 (1.1776) ce_loss 1.1914 (1.0447) teacher_loss 1.1877 (1.0416) loss_zs_kd 0.1054 (0.1174) loss_oracle 0.0764 (0.0773) acc 71.8750 (73.4375) kd_loss 0.0531 (0.0508) lr 1.9511e-03 eta 0:37:22
epoch [7/50] batch [40/288] time 0.141 (0.166) data 0.000 (0.008) loss 0.8385 (1.1165) ce_loss 0.7051 (0.9870) teacher_loss 0.7183 (0.9846) loss_zs_kd 0.1147 (0.1179) loss_oracle 0.0628 (0.0730) acc 90.6250 (74.9219) kd_loss 0.0360 (0.0500) lr 1.9511e-03 eta 0:34:55
epoch [7/50] batch [60/288] time 0.173 (0.164) data 0.000 (0.005) loss 1.3071 (1.0957) ce_loss 1.1875 (0.9707) teacher_loss 1.1844 (0.9674) loss_zs_kd 0.1176 (0.1178) loss_oracle 0.0639 (0.0694) acc 68.7500 (74.7917) kd_loss 0.0536 (0.0502) lr 1.9511e-03 eta 0:34:30
epoch [7/50] batch [80/288] time 0.087 (0.163) data 0.000 (0.004) loss 1.0723 (1.0985) ce_loss 0.9385 (0.9731) teacher_loss 0.9170 (0.9680) loss_zs_kd 0.1320 (0.1210) loss_oracle 0.0893 (0.0700) acc 75.0000 (74.5703) kd_loss 0.0664 (0.0517) lr 1.9511e-03 eta 0:34:15
epoch [7/50] batch [100/288] time 0.415 (0.172) data 0.000 (0.003) loss 0.7530 (1.0979) ce_loss 0.6221 (0.9716) teacher_loss 0.6167 (0.9668) loss_zs_kd 0.0845 (0.1203) loss_oracle 0.0940 (0.0710) acc 84.3750 (74.1562) kd_loss 0.0629 (0.0521) lr 1.9511e-03 eta 0:36:00
epoch [7/50] batch [120/288] time 0.157 (0.175) data 0.000 (0.003) loss 1.4162 (1.0953) ce_loss 1.2715 (0.9682) teacher_loss 1.2666 (0.9630) loss_zs_kd 0.1111 (0.1192) loss_oracle 0.0941 (0.0727) acc 71.8750 (74.1146) kd_loss 0.0679 (0.0526) lr 1.9511e-03 eta 0:36:40
epoch [7/50] batch [140/288] time 0.152 (0.175) data 0.000 (0.002) loss 1.1888 (1.1078) ce_loss 1.0732 (0.9795) teacher_loss 1.0632 (0.9735) loss_zs_kd 0.1063 (0.1193) loss_oracle 0.0724 (0.0746) acc 71.8750 (73.7277) kd_loss 0.0479 (0.0534) lr 1.9511e-03 eta 0:36:27
epoch [7/50] batch [160/288] time 0.149 (0.173) data 0.000 (0.002) loss 1.1546 (1.1255) ce_loss 1.0127 (0.9963) teacher_loss 1.0100 (0.9898) loss_zs_kd 0.1175 (0.1191) loss_oracle 0.0858 (0.0762) acc 75.0000 (73.3008) kd_loss 0.0520 (0.0540) lr 1.9511e-03 eta 0:36:05
epoch [7/50] batch [180/288] time 0.158 (0.172) data 0.000 (0.002) loss 1.2115 (1.1326) ce_loss 1.0947 (1.0018) teacher_loss 1.0667 (0.9951) loss_zs_kd 0.1230 (0.1191) loss_oracle 0.0832 (0.0780) acc 71.8750 (73.2639) kd_loss 0.0617 (0.0546) lr 1.9511e-03 eta 0:35:48
epoch [7/50] batch [200/288] time 0.156 (0.171) data 0.000 (0.002) loss 0.8640 (1.1261) ce_loss 0.7065 (0.9948) teacher_loss 0.6965 (0.9877) loss_zs_kd 0.1350 (0.1193) loss_oracle 0.1000 (0.0787) acc 75.0000 (73.3750) kd_loss 0.0570 (0.0550) lr 1.9511e-03 eta 0:35:30
epoch [7/50] batch [220/288] time 0.348 (0.170) data 0.000 (0.002) loss 1.3629 (1.1274) ce_loss 1.2314 (0.9958) teacher_loss 1.2347 (0.9887) loss_zs_kd 0.1265 (0.1193) loss_oracle 0.0649 (0.0791) acc 68.7500 (73.2244) kd_loss 0.0475 (0.0552) lr 1.9511e-03 eta 0:35:11
epoch [7/50] batch [240/288] time 0.090 (0.175) data 0.000 (0.001) loss 1.5959 (1.1338) ce_loss 1.4453 (1.0020) teacher_loss 1.4368 (0.9947) loss_zs_kd 0.1137 (0.1195) loss_oracle 0.1022 (0.0794) acc 59.3750 (73.1250) kd_loss 0.0739 (0.0555) lr 1.9511e-03 eta 0:36:14
epoch [7/50] batch [260/288] time 0.172 (0.174) data 0.000 (0.001) loss 1.0723 (1.1353) ce_loss 0.9634 (1.0040) teacher_loss 0.9596 (0.9966) loss_zs_kd 0.0949 (0.1185) loss_oracle 0.0652 (0.0795) acc 75.0000 (73.0288) kd_loss 0.0619 (0.0559) lr 1.9511e-03 eta 0:35:54
epoch [7/50] batch [280/288] time 0.164 (0.173) data 0.000 (0.001) loss 0.8495 (1.1303) ce_loss 0.7246 (0.9993) teacher_loss 0.7278 (0.9922) loss_zs_kd 0.1014 (0.1175) loss_oracle 0.0710 (0.0793) acc 75.0000 (73.2031) kd_loss 0.0465 (0.0562) lr 1.9511e-03 eta 0:35:40
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,405
* accuracy: 86.4%
* error: 13.6%
* macro_f1: 85.8%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,015
* accuracy: 83.0%
* error: 17.0%
* macro_f1: 79.6%
******* Domain a best val acc:      86.6%, epoch: 4 *******
******* Domain a best val test acc: 83.5%, epoch: 4 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [8/50] batch [20/288] time 0.182 (0.186) data 0.000 (0.014) loss 1.1057 (1.1435) ce_loss 0.9019 (0.9869) teacher_loss 0.8812 (0.9759) loss_zs_kd 0.2063 (0.1296) loss_oracle 0.1213 (0.1028) acc 84.3750 (74.2188) kd_loss 0.0947 (0.0665) lr 1.9298e-03 eta 0:38:18
epoch [8/50] batch [40/288] time 0.084 (0.188) data 0.000 (0.007) loss 0.9821 (1.1245) ce_loss 0.8530 (0.9745) teacher_loss 0.8472 (0.9659) loss_zs_kd 0.1309 (0.1218) loss_oracle 0.0694 (0.0977) acc 81.2500 (73.6719) kd_loss 0.0440 (0.0642) lr 1.9298e-03 eta 0:38:45
epoch [8/50] batch [60/288] time 0.159 (0.194) data 0.000 (0.005) loss 1.6853 (1.0999) ce_loss 1.5918 (0.9600) teacher_loss 1.5841 (0.9513) loss_zs_kd 0.0786 (0.1211) loss_oracle 0.0619 (0.0881) acc 56.2500 (73.9583) kd_loss 0.0529 (0.0624) lr 1.9298e-03 eta 0:39:56
epoch [8/50] batch [80/288] time 0.164 (0.187) data 0.000 (0.004) loss 1.1864 (1.0887) ce_loss 1.0771 (0.9537) teacher_loss 1.0625 (0.9447) loss_zs_kd 0.1022 (0.1226) loss_oracle 0.0728 (0.0827) acc 68.7500 (74.1406) kd_loss 0.0467 (0.0610) lr 1.9298e-03 eta 0:38:15
epoch [8/50] batch [100/288] time 0.165 (0.182) data 0.000 (0.003) loss 0.9309 (1.0945) ce_loss 0.7676 (0.9615) teacher_loss 0.7566 (0.9532) loss_zs_kd 0.1677 (0.1244) loss_oracle 0.0904 (0.0790) acc 84.3750 (74.1562) kd_loss 0.0737 (0.0589) lr 1.9298e-03 eta 0:37:11
epoch [8/50] batch [120/288] time 0.151 (0.178) data 0.000 (0.003) loss 1.0598 (1.0842) ce_loss 0.9199 (0.9520) teacher_loss 0.9049 (0.9442) loss_zs_kd 0.1428 (0.1256) loss_oracle 0.0835 (0.0772) acc 78.1250 (74.4010) kd_loss 0.0533 (0.0576) lr 1.9298e-03 eta 0:36:23
epoch [8/50] batch [140/288] time 0.155 (0.176) data 0.000 (0.002) loss 1.0622 (1.0945) ce_loss 0.9038 (0.9631) teacher_loss 0.9086 (0.9556) loss_zs_kd 0.1463 (0.1255) loss_oracle 0.0804 (0.0761) acc 68.7500 (74.1295) kd_loss 0.0509 (0.0564) lr 1.9298e-03 eta 0:35:51
epoch [8/50] batch [160/288] time 0.183 (0.174) data 0.000 (0.002) loss 1.2527 (1.1108) ce_loss 1.1279 (0.9809) teacher_loss 1.1223 (0.9729) loss_zs_kd 0.1376 (0.1242) loss_oracle 0.0616 (0.0758) acc 68.7500 (73.6523) kd_loss 0.0374 (0.0554) lr 1.9298e-03 eta 0:35:28
epoch [8/50] batch [180/288] time 0.085 (0.174) data 0.000 (0.002) loss 1.5129 (1.1113) ce_loss 1.3916 (0.9822) teacher_loss 1.3823 (0.9748) loss_zs_kd 0.0999 (0.1226) loss_oracle 0.0806 (0.0753) acc 68.7500 (73.5590) kd_loss 0.0483 (0.0542) lr 1.9298e-03 eta 0:35:25
epoch [8/50] batch [200/288] time 0.171 (0.176) data 0.000 (0.002) loss 1.3760 (1.1148) ce_loss 1.2598 (0.9847) teacher_loss 1.2387 (0.9771) loss_zs_kd 0.1154 (0.1228) loss_oracle 0.0796 (0.0762) acc 65.6250 (73.4844) kd_loss 0.0477 (0.0536) lr 1.9298e-03 eta 0:35:45
epoch [8/50] batch [220/288] time 0.156 (0.175) data 0.000 (0.001) loss 0.8140 (1.1098) ce_loss 0.7075 (0.9801) teacher_loss 0.6999 (0.9724) loss_zs_kd 0.1054 (0.1224) loss_oracle 0.0614 (0.0761) acc 84.3750 (73.6506) kd_loss 0.0483 (0.0534) lr 1.9298e-03 eta 0:35:28
epoch [8/50] batch [240/288] time 0.156 (0.174) data 0.000 (0.001) loss 1.0752 (1.1135) ce_loss 0.9409 (0.9839) teacher_loss 0.9272 (0.9764) loss_zs_kd 0.1509 (0.1227) loss_oracle 0.0726 (0.0757) acc 75.0000 (73.5026) kd_loss 0.0455 (0.0533) lr 1.9298e-03 eta 0:35:09
epoch [8/50] batch [260/288] time 0.162 (0.172) data 0.000 (0.001) loss 1.1120 (1.1139) ce_loss 0.9351 (0.9843) teacher_loss 0.9231 (0.9769) loss_zs_kd 0.1678 (0.1222) loss_oracle 0.1051 (0.0759) acc 78.1250 (73.5938) kd_loss 0.0587 (0.0530) lr 1.9298e-03 eta 0:34:48
epoch [8/50] batch [280/288] time 0.161 (0.171) data 0.000 (0.001) loss 1.6297 (1.1204) ce_loss 1.4746 (0.9910) teacher_loss 1.4660 (0.9835) loss_zs_kd 0.1401 (0.1219) loss_oracle 0.0937 (0.0759) acc 59.3750 (73.4710) kd_loss 0.0558 (0.0528) lr 1.9298e-03 eta 0:34:31
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,409
* accuracy: 86.5%
* error: 13.5%
* macro_f1: 85.9%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,023
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 80.0%
******* Domain a best val acc:      86.6%, epoch: 4 *******
******* Domain a best val test acc: 83.5%, epoch: 4 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [9/50] batch [20/288] time 0.170 (0.210) data 0.000 (0.015) loss 1.2131 (1.1487) ce_loss 1.0713 (1.0075) teacher_loss 1.0751 (0.9992) loss_zs_kd 0.1111 (0.1210) loss_oracle 0.0825 (0.0890) acc 71.8750 (71.8750) kd_loss 0.0498 (0.0528) lr 1.9048e-03 eta 0:42:21
epoch [9/50] batch [40/288] time 0.161 (0.189) data 0.000 (0.007) loss 0.7532 (1.0996) ce_loss 0.6489 (0.9547) teacher_loss 0.6335 (0.9464) loss_zs_kd 0.0647 (0.1204) loss_oracle 0.0874 (0.0931) acc 81.2500 (74.1406) kd_loss 0.0539 (0.0537) lr 1.9048e-03 eta 0:38:03
epoch [9/50] batch [60/288] time 0.153 (0.179) data 0.001 (0.005) loss 1.2294 (1.1006) ce_loss 1.1143 (0.9608) teacher_loss 1.1172 (0.9532) loss_zs_kd 0.1095 (0.1196) loss_oracle 0.0574 (0.0876) acc 68.7500 (73.9583) kd_loss 0.0323 (0.0534) lr 1.9048e-03 eta 0:35:49
epoch [9/50] batch [80/288] time 0.153 (0.174) data 0.000 (0.004) loss 0.9640 (1.1292) ce_loss 0.8242 (0.9895) teacher_loss 0.8332 (0.9820) loss_zs_kd 0.1188 (0.1227) loss_oracle 0.0714 (0.0858) acc 84.3750 (73.5547) kd_loss 0.0367 (0.0536) lr 1.9048e-03 eta 0:34:49
epoch [9/50] batch [100/288] time 0.150 (0.171) data 0.000 (0.003) loss 0.8941 (1.1285) ce_loss 0.7495 (0.9907) teacher_loss 0.7585 (0.9835) loss_zs_kd 0.1170 (0.1205) loss_oracle 0.0771 (0.0847) acc 71.8750 (73.5938) kd_loss 0.0435 (0.0528) lr 1.9048e-03 eta 0:34:12
epoch [9/50] batch [120/288] time 0.178 (0.170) data 0.000 (0.003) loss 1.1674 (1.1414) ce_loss 1.0156 (1.0029) teacher_loss 1.0203 (0.9955) loss_zs_kd 0.1163 (0.1213) loss_oracle 0.0889 (0.0852) acc 68.7500 (73.0990) kd_loss 0.0520 (0.0527) lr 1.9048e-03 eta 0:33:59
epoch [9/50] batch [140/288] time 0.088 (0.173) data 0.000 (0.002) loss 1.0616 (1.1478) ce_loss 0.9512 (1.0084) teacher_loss 0.9468 (1.0010) loss_zs_kd 0.0670 (0.1225) loss_oracle 0.0814 (0.0854) acc 71.8750 (73.2143) kd_loss 0.0570 (0.0532) lr 1.9048e-03 eta 0:34:26
epoch [9/50] batch [160/288] time 0.150 (0.174) data 0.000 (0.002) loss 0.8717 (1.1412) ce_loss 0.7656 (1.0019) teacher_loss 0.7509 (0.9939) loss_zs_kd 0.1324 (0.1259) loss_oracle 0.0546 (0.0843) acc 78.1250 (73.2617) kd_loss 0.0436 (0.0539) lr 1.9048e-03 eta 0:34:41
epoch [9/50] batch [180/288] time 0.158 (0.173) data 0.000 (0.002) loss 1.7694 (1.1397) ce_loss 1.6562 (1.0042) teacher_loss 1.6504 (0.9961) loss_zs_kd 0.1308 (0.1243) loss_oracle 0.0536 (0.0815) acc 65.6250 (73.1944) kd_loss 0.0439 (0.0535) lr 1.9048e-03 eta 0:34:22
epoch [9/50] batch [200/288] time 0.155 (0.172) data 0.000 (0.002) loss 1.3635 (1.1464) ce_loss 1.2510 (1.0123) teacher_loss 1.2263 (1.0040) loss_zs_kd 0.1252 (0.1244) loss_oracle 0.0746 (0.0802) acc 68.7500 (72.9844) kd_loss 0.0479 (0.0534) lr 1.9048e-03 eta 0:34:05
epoch [9/50] batch [220/288] time 0.150 (0.171) data 0.000 (0.002) loss 0.8100 (1.1443) ce_loss 0.6548 (1.0121) teacher_loss 0.6526 (1.0037) loss_zs_kd 0.1664 (0.1240) loss_oracle 0.0742 (0.0786) acc 81.2500 (72.9688) kd_loss 0.0586 (0.0528) lr 1.9048e-03 eta 0:33:52
epoch [9/50] batch [240/288] time 0.181 (0.171) data 0.000 (0.001) loss 1.2446 (1.1414) ce_loss 1.0967 (1.0104) teacher_loss 1.0772 (1.0020) loss_zs_kd 0.1837 (0.1234) loss_oracle 0.0756 (0.0777) acc 71.8750 (72.9948) kd_loss 0.0478 (0.0520) lr 1.9048e-03 eta 0:33:44
epoch [9/50] batch [260/288] time 0.181 (0.170) data 0.000 (0.001) loss 1.0047 (1.1441) ce_loss 0.8950 (1.0133) teacher_loss 0.9002 (1.0049) loss_zs_kd 0.0940 (0.1230) loss_oracle 0.0574 (0.0777) acc 71.8750 (72.8846) kd_loss 0.0297 (0.0517) lr 1.9048e-03 eta 0:33:35
epoch [9/50] batch [280/288] time 0.324 (0.172) data 0.000 (0.001) loss 0.9748 (1.1372) ce_loss 0.8887 (1.0070) teacher_loss 0.8743 (0.9984) loss_zs_kd 0.0678 (0.1229) loss_oracle 0.0666 (0.0774) acc 75.0000 (72.9688) kd_loss 0.0506 (0.0518) lr 1.9048e-03 eta 0:33:49
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,408
* accuracy: 86.5%
* error: 13.5%
* macro_f1: 85.8%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,022
* accuracy: 83.3%
* error: 16.7%
* macro_f1: 79.9%
******* Domain a best val acc:      86.6%, epoch: 4 *******
******* Domain a best val test acc: 83.5%, epoch: 4 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [10/50] batch [20/288] time 0.121 (0.115) data 0.000 (0.013) loss 0.8771 (1.1350) ce_loss 0.7729 (1.0169) teacher_loss 0.7710 (1.0099) loss_zs_kd 0.0762 (0.1222) loss_oracle 0.0680 (0.0640) acc 78.1250 (74.2188) kd_loss 0.0433 (0.0472) lr 1.8763e-03 eta 0:22:31
epoch [10/50] batch [40/288] time 0.173 (0.136) data 0.000 (0.007) loss 1.3044 (1.1010) ce_loss 1.1504 (0.9761) teacher_loss 1.1472 (0.9669) loss_zs_kd 0.1626 (0.1272) loss_oracle 0.0759 (0.0705) acc 65.6250 (75.0781) kd_loss 0.0662 (0.0517) lr 1.8763e-03 eta 0:26:40
epoch [10/50] batch [60/288] time 0.168 (0.145) data 0.000 (0.005) loss 0.9798 (1.0664) ce_loss 0.8618 (0.9457) teacher_loss 0.8700 (0.9356) loss_zs_kd 0.0947 (0.1246) loss_oracle 0.0625 (0.0685) acc 81.2500 (75.0521) kd_loss 0.0466 (0.0520) lr 1.8763e-03 eta 0:28:21
epoch [10/50] batch [80/288] time 0.172 (0.149) data 0.000 (0.003) loss 1.2262 (1.0931) ce_loss 1.1201 (0.9719) teacher_loss 1.1230 (0.9619) loss_zs_kd 0.1073 (0.1267) loss_oracle 0.0495 (0.0679) acc 81.2500 (74.3359) kd_loss 0.0383 (0.0513) lr 1.8763e-03 eta 0:29:10
epoch [10/50] batch [100/288] time 0.148 (0.151) data 0.000 (0.003) loss 1.4092 (1.0806) ce_loss 1.2900 (0.9619) teacher_loss 1.2809 (0.9525) loss_zs_kd 0.1233 (0.1241) loss_oracle 0.0666 (0.0661) acc 71.8750 (74.5938) kd_loss 0.0495 (0.0495) lr 1.8763e-03 eta 0:29:29
epoch [10/50] batch [120/288] time 0.134 (0.153) data 0.000 (0.002) loss 0.9752 (1.0805) ce_loss 0.8560 (0.9597) teacher_loss 0.8472 (0.9512) loss_zs_kd 0.1161 (0.1236) loss_oracle 0.0699 (0.0675) acc 81.2500 (74.7656) kd_loss 0.0329 (0.0482) lr 1.8763e-03 eta 0:29:45
epoch [10/50] batch [140/288] time 0.097 (0.154) data 0.000 (0.002) loss 1.3899 (1.0990) ce_loss 1.2676 (0.9758) teacher_loss 1.2611 (0.9670) loss_zs_kd 0.1162 (0.1249) loss_oracle 0.0707 (0.0695) acc 68.7500 (74.4196) kd_loss 0.0523 (0.0485) lr 1.8763e-03 eta 0:30:02
epoch [10/50] batch [160/288] time 0.095 (0.160) data 0.000 (0.002) loss 0.8332 (1.0998) ce_loss 0.6880 (0.9749) teacher_loss 0.6931 (0.9663) loss_zs_kd 0.0897 (0.1239) loss_oracle 0.0952 (0.0716) acc 84.3750 (74.3945) kd_loss 0.0560 (0.0491) lr 1.8763e-03 eta 0:31:03
epoch [10/50] batch [180/288] time 0.170 (0.159) data 0.000 (0.002) loss 1.2166 (1.1127) ce_loss 1.1006 (0.9855) teacher_loss 1.1052 (0.9775) loss_zs_kd 0.0918 (0.1232) loss_oracle 0.0656 (0.0736) acc 75.0000 (74.0972) kd_loss 0.0418 (0.0495) lr 1.8763e-03 eta 0:30:53
epoch [10/50] batch [200/288] time 0.161 (0.159) data 0.000 (0.001) loss 1.4243 (1.1192) ce_loss 1.3096 (0.9929) teacher_loss 1.2939 (0.9849) loss_zs_kd 0.1008 (0.1221) loss_oracle 0.0799 (0.0733) acc 62.5000 (74.0312) kd_loss 0.0814 (0.0499) lr 1.8763e-03 eta 0:30:47
epoch [10/50] batch [220/288] time 0.170 (0.159) data 0.000 (0.001) loss 1.2103 (1.1185) ce_loss 1.0977 (0.9939) teacher_loss 1.0750 (0.9856) loss_zs_kd 0.1305 (0.1215) loss_oracle 0.0701 (0.0721) acc 68.7500 (74.0909) kd_loss 0.0628 (0.0501) lr 1.8763e-03 eta 0:30:42
epoch [10/50] batch [240/288] time 0.166 (0.160) data 0.000 (0.001) loss 1.0642 (1.1211) ce_loss 0.9106 (0.9973) teacher_loss 0.9080 (0.9886) loss_zs_kd 0.1445 (0.1217) loss_oracle 0.0840 (0.0716) acc 75.0000 (73.9583) kd_loss 0.0603 (0.0503) lr 1.8763e-03 eta 0:30:47
epoch [10/50] batch [260/288] time 0.194 (0.161) data 0.000 (0.001) loss 1.2218 (1.1216) ce_loss 1.0801 (0.9971) teacher_loss 1.0731 (0.9882) loss_zs_kd 0.1189 (0.1223) loss_oracle 0.0892 (0.0723) acc 75.0000 (73.8702) kd_loss 0.0651 (0.0509) lr 1.8763e-03 eta 0:30:55
epoch [10/50] batch [280/288] time 0.105 (0.163) data 0.000 (0.001) loss 1.6421 (1.1303) ce_loss 1.4629 (1.0049) teacher_loss 1.4644 (0.9960) loss_zs_kd 0.1811 (0.1231) loss_oracle 0.0872 (0.0728) acc 65.6250 (73.6161) kd_loss 0.0695 (0.0513) lr 1.8763e-03 eta 0:31:14
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,410
* accuracy: 86.6%
* error: 13.4%
* macro_f1: 85.8%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,017
* accuracy: 83.1%
* error: 16.9%
* macro_f1: 79.5%
******* Domain a best val acc:      86.6%, epoch: 4 *******
******* Domain a best val test acc: 83.5%, epoch: 4 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [11/50] batch [20/288] time 0.148 (0.173) data 0.000 (0.013) loss 1.6577 (1.1465) ce_loss 1.5352 (1.0220) teacher_loss 1.5206 (1.0148) loss_zs_kd 0.1083 (0.1214) loss_oracle 0.0829 (0.0710) acc 62.5000 (72.5000) kd_loss 0.0658 (0.0569) lr 1.8443e-03 eta 0:33:11
epoch [11/50] batch [40/288] time 0.153 (0.166) data 0.000 (0.007) loss 1.3029 (1.1499) ce_loss 1.1572 (1.0223) teacher_loss 1.1541 (1.0129) loss_zs_kd 0.1410 (0.1253) loss_oracle 0.0784 (0.0743) acc 71.8750 (71.7969) kd_loss 0.0635 (0.0594) lr 1.8443e-03 eta 0:31:48
epoch [11/50] batch [60/288] time 0.158 (0.164) data 0.000 (0.005) loss 0.9528 (1.1434) ce_loss 0.8140 (1.0164) teacher_loss 0.8009 (1.0078) loss_zs_kd 0.1377 (0.1235) loss_oracle 0.0830 (0.0739) acc 78.1250 (72.1875) kd_loss 0.0532 (0.0579) lr 1.8443e-03 eta 0:31:16
epoch [11/50] batch [80/288] time 0.092 (0.162) data 0.000 (0.003) loss 1.1985 (1.1216) ce_loss 1.0820 (0.9930) teacher_loss 1.0920 (0.9830) loss_zs_kd 0.0857 (0.1212) loss_oracle 0.0636 (0.0780) acc 68.7500 (72.8516) kd_loss 0.0401 (0.0588) lr 1.8443e-03 eta 0:30:53
epoch [11/50] batch [100/288] time 0.116 (0.163) data 0.000 (0.003) loss 1.3473 (1.1089) ce_loss 1.1904 (0.9786) teacher_loss 1.1732 (0.9687) loss_zs_kd 0.1450 (0.1206) loss_oracle 0.1016 (0.0800) acc 68.7500 (73.2812) kd_loss 0.0709 (0.0580) lr 1.8443e-03 eta 0:31:00
epoch [11/50] batch [120/288] time 0.155 (0.171) data 0.000 (0.002) loss 1.6245 (1.1119) ce_loss 1.5029 (0.9808) teacher_loss 1.4815 (0.9714) loss_zs_kd 0.1031 (0.1211) loss_oracle 0.0914 (0.0799) acc 53.1250 (73.3073) kd_loss 0.0623 (0.0579) lr 1.8443e-03 eta 0:32:29
epoch [11/50] batch [140/288] time 0.162 (0.170) data 0.000 (0.002) loss 0.9576 (1.1137) ce_loss 0.8413 (0.9823) teacher_loss 0.8385 (0.9734) loss_zs_kd 0.0815 (0.1204) loss_oracle 0.0784 (0.0801) acc 81.2500 (73.2143) kd_loss 0.0583 (0.0583) lr 1.8443e-03 eta 0:32:13
epoch [11/50] batch [160/288] time 0.164 (0.169) data 0.000 (0.002) loss 1.3612 (1.1259) ce_loss 1.2217 (0.9952) teacher_loss 1.2202 (0.9862) loss_zs_kd 0.1149 (0.1199) loss_oracle 0.0836 (0.0798) acc 62.5000 (72.7148) kd_loss 0.0703 (0.0583) lr 1.8443e-03 eta 0:32:01
epoch [11/50] batch [180/288] time 0.161 (0.169) data 0.000 (0.002) loss 1.2079 (1.1214) ce_loss 1.0566 (0.9909) teacher_loss 1.0503 (0.9818) loss_zs_kd 0.1403 (0.1206) loss_oracle 0.0874 (0.0794) acc 78.1250 (72.7951) kd_loss 0.0785 (0.0587) lr 1.8443e-03 eta 0:31:58
epoch [11/50] batch [200/288] time 0.175 (0.169) data 0.000 (0.002) loss 1.2391 (1.1166) ce_loss 1.0713 (0.9870) teacher_loss 1.0503 (0.9778) loss_zs_kd 0.1684 (0.1202) loss_oracle 0.1047 (0.0787) acc 78.1250 (72.9531) kd_loss 0.0756 (0.0590) lr 1.8443e-03 eta 0:31:56
epoch [11/50] batch [220/288] time 0.102 (0.171) data 0.000 (0.001) loss 1.1615 (1.1183) ce_loss 0.9829 (0.9863) teacher_loss 0.9773 (0.9767) loss_zs_kd 0.1439 (0.1226) loss_oracle 0.1122 (0.0803) acc 81.2500 (72.9972) kd_loss 0.0755 (0.0598) lr 1.8443e-03 eta 0:32:13
epoch [11/50] batch [240/288] time 0.178 (0.174) data 0.001 (0.001) loss 1.0907 (1.1154) ce_loss 0.9717 (0.9829) teacher_loss 0.9595 (0.9734) loss_zs_kd 0.1055 (0.1230) loss_oracle 0.0784 (0.0804) acc 71.8750 (73.1510) kd_loss 0.0500 (0.0599) lr 1.8443e-03 eta 0:32:44
epoch [11/50] batch [260/288] time 0.182 (0.174) data 0.000 (0.001) loss 1.0635 (1.1165) ce_loss 0.9585 (0.9840) teacher_loss 0.9499 (0.9745) loss_zs_kd 0.1050 (0.1229) loss_oracle 0.0610 (0.0805) acc 75.0000 (73.0889) kd_loss 0.0435 (0.0601) lr 1.8443e-03 eta 0:32:40
epoch [11/50] batch [280/288] time 0.174 (0.174) data 0.000 (0.001) loss 0.8379 (1.1096) ce_loss 0.7344 (0.9767) teacher_loss 0.7126 (0.9672) loss_zs_kd 0.0847 (0.1223) loss_oracle 0.0830 (0.0812) acc 81.2500 (73.3482) kd_loss 0.0698 (0.0607) lr 1.8443e-03 eta 0:32:34
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,409
* accuracy: 86.5%
* error: 13.5%
* macro_f1: 85.9%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,026
* accuracy: 83.5%
* error: 16.5%
* macro_f1: 80.0%
******* Domain a best val acc:      86.6%, epoch: 4 *******
******* Domain a best val test acc: 83.5%, epoch: 4 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [12/50] batch [20/288] time 0.451 (0.208) data 0.001 (0.013) loss 1.0613 (1.1123) ce_loss 0.9727 (0.9969) teacher_loss 0.9637 (0.9868) loss_zs_kd 0.0783 (0.1260) loss_oracle 0.0584 (0.0625) acc 81.2500 (72.8125) kd_loss 0.0569 (0.0606) lr 1.8090e-03 eta 0:38:53
epoch [12/50] batch [40/288] time 0.161 (0.207) data 0.000 (0.007) loss 1.1465 (1.0940) ce_loss 1.0303 (0.9782) teacher_loss 1.0373 (0.9710) loss_zs_kd 0.0802 (0.1235) loss_oracle 0.0691 (0.0613) acc 75.0000 (73.2031) kd_loss 0.0442 (0.0545) lr 1.8090e-03 eta 0:38:31
epoch [12/50] batch [60/288] time 0.172 (0.191) data 0.000 (0.004) loss 1.3110 (1.1188) ce_loss 1.2197 (1.0026) teacher_loss 1.2211 (0.9941) loss_zs_kd 0.1142 (0.1217) loss_oracle 0.0327 (0.0639) acc 65.6250 (72.7083) kd_loss 0.0324 (0.0530) lr 1.8090e-03 eta 0:35:33
epoch [12/50] batch [80/288] time 0.161 (0.184) data 0.000 (0.003) loss 2.0556 (1.1233) ce_loss 1.9414 (1.0068) teacher_loss 1.9238 (0.9982) loss_zs_kd 0.1451 (0.1232) loss_oracle 0.0592 (0.0635) acc 53.1250 (72.9688) kd_loss 0.0489 (0.0519) lr 1.8090e-03 eta 0:34:14
epoch [12/50] batch [100/288] time 0.173 (0.180) data 0.000 (0.003) loss 1.1706 (1.1039) ce_loss 1.0693 (0.9873) teacher_loss 1.0586 (0.9793) loss_zs_kd 0.1267 (0.1215) loss_oracle 0.0488 (0.0638) acc 59.3750 (73.3125) kd_loss 0.0352 (0.0492) lr 1.8090e-03 eta 0:33:27
epoch [12/50] batch [120/288] time 0.167 (0.178) data 0.000 (0.002) loss 1.2568 (1.0971) ce_loss 1.1250 (0.9795) teacher_loss 1.1288 (0.9721) loss_zs_kd 0.1342 (0.1217) loss_oracle 0.0609 (0.0642) acc 68.7500 (73.7500) kd_loss 0.0343 (0.0481) lr 1.8090e-03 eta 0:32:54
epoch [12/50] batch [140/288] time 0.092 (0.178) data 0.000 (0.002) loss 0.5993 (1.1028) ce_loss 0.4873 (0.9842) teacher_loss 0.4796 (0.9764) loss_zs_kd 0.1112 (0.1236) loss_oracle 0.0641 (0.0646) acc 90.6250 (73.6161) kd_loss 0.0411 (0.0475) lr 1.8090e-03 eta 0:32:49
epoch [12/50] batch [160/288] time 0.170 (0.183) data 0.000 (0.002) loss 1.1598 (1.1013) ce_loss 0.9912 (0.9818) teacher_loss 0.9896 (0.9738) loss_zs_kd 0.1839 (0.1250) loss_oracle 0.0783 (0.0651) acc 71.8750 (73.5742) kd_loss 0.0513 (0.0468) lr 1.8090e-03 eta 0:33:44
epoch [12/50] batch [180/288] time 0.150 (0.180) data 0.000 (0.002) loss 1.0160 (1.1163) ce_loss 0.8604 (0.9960) teacher_loss 0.8650 (0.9881) loss_zs_kd 0.1553 (0.1264) loss_oracle 0.0733 (0.0651) acc 78.1250 (73.1771) kd_loss 0.0387 (0.0460) lr 1.8090e-03 eta 0:33:05
epoch [12/50] batch [200/288] time 0.164 (0.178) data 0.000 (0.001) loss 1.2503 (1.1177) ce_loss 1.1318 (0.9979) teacher_loss 1.1348 (0.9901) loss_zs_kd 0.1124 (0.1257) loss_oracle 0.0593 (0.0648) acc 68.7500 (73.2656) kd_loss 0.0355 (0.0449) lr 1.8090e-03 eta 0:32:39
epoch [12/50] batch [220/288] time 0.146 (0.176) data 0.000 (0.001) loss 0.8403 (1.1142) ce_loss 0.7192 (0.9939) teacher_loss 0.7077 (0.9864) loss_zs_kd 0.1736 (0.1270) loss_oracle 0.0458 (0.0643) acc 75.0000 (73.4517) kd_loss 0.0327 (0.0441) lr 1.8090e-03 eta 0:32:17
epoch [12/50] batch [240/288] time 0.158 (0.175) data 0.000 (0.001) loss 1.5156 (1.1175) ce_loss 1.3740 (0.9969) teacher_loss 1.3629 (0.9895) loss_zs_kd 0.1526 (0.1271) loss_oracle 0.0763 (0.0644) acc 59.3750 (73.5417) kd_loss 0.0484 (0.0436) lr 1.8090e-03 eta 0:32:07
epoch [12/50] batch [260/288] time 0.107 (0.173) data 0.000 (0.001) loss 0.9484 (1.1143) ce_loss 0.7969 (0.9937) teacher_loss 0.7805 (0.9863) loss_zs_kd 0.1548 (0.1269) loss_oracle 0.0905 (0.0645) acc 84.3750 (73.6418) kd_loss 0.0550 (0.0430) lr 1.8090e-03 eta 0:31:40
epoch [12/50] batch [280/288] time 0.415 (0.179) data 0.000 (0.001) loss 0.9926 (1.1133) ce_loss 0.8750 (0.9919) teacher_loss 0.8755 (0.9847) loss_zs_kd 0.0942 (0.1268) loss_oracle 0.0700 (0.0652) acc 75.0000 (73.7388) kd_loss 0.0412 (0.0428) lr 1.8090e-03 eta 0:32:35
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,410
* accuracy: 86.6%
* error: 13.4%
* macro_f1: 86.0%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,025
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 80.2%
******* Domain a best val acc:      86.6%, epoch: 4 *******
******* Domain a best val test acc: 83.5%, epoch: 4 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [13/50] batch [20/288] time 0.165 (0.185) data 0.000 (0.013) loss 0.9044 (1.0866) ce_loss 0.7656 (0.9518) teacher_loss 0.7569 (0.9472) loss_zs_kd 0.1458 (0.1339) loss_oracle 0.0746 (0.0725) acc 81.2500 (73.7500) kd_loss 0.0410 (0.0429) lr 1.7705e-03 eta 0:33:35
epoch [13/50] batch [40/288] time 0.170 (0.174) data 0.000 (0.007) loss 0.8613 (1.1546) ce_loss 0.7261 (1.0188) teacher_loss 0.7238 (1.0152) loss_zs_kd 0.1516 (0.1343) loss_oracle 0.0617 (0.0722) acc 81.2500 (72.4219) kd_loss 0.0367 (0.0411) lr 1.7705e-03 eta 0:31:37
epoch [13/50] batch [60/288] time 0.317 (0.166) data 0.001 (0.005) loss 1.7231 (1.1981) ce_loss 1.6045 (1.0702) teacher_loss 1.5772 (1.0635) loss_zs_kd 0.1644 (0.1310) loss_oracle 0.0637 (0.0691) acc 62.5000 (71.1458) kd_loss 0.0467 (0.0410) lr 1.7705e-03 eta 0:30:05
epoch [13/50] batch [80/288] time 0.103 (0.188) data 0.000 (0.003) loss 1.4444 (1.1696) ce_loss 1.3086 (1.0442) teacher_loss 1.2955 (1.0376) loss_zs_kd 0.1948 (0.1317) loss_oracle 0.0514 (0.0662) acc 68.7500 (71.9141) kd_loss 0.0329 (0.0396) lr 1.7705e-03 eta 0:34:04
epoch [13/50] batch [100/288] time 0.151 (0.179) data 0.000 (0.003) loss 0.7709 (1.1376) ce_loss 0.6606 (1.0110) teacher_loss 0.6625 (1.0057) loss_zs_kd 0.0655 (0.1303) loss_oracle 0.0756 (0.0667) acc 84.3750 (72.9375) kd_loss 0.0418 (0.0389) lr 1.7705e-03 eta 0:32:23
epoch [13/50] batch [120/288] time 0.143 (0.176) data 0.000 (0.002) loss 1.1046 (1.1302) ce_loss 0.9971 (1.0027) teacher_loss 0.9873 (0.9977) loss_zs_kd 0.1221 (0.1305) loss_oracle 0.0563 (0.0672) acc 71.8750 (73.4115) kd_loss 0.0381 (0.0393) lr 1.7705e-03 eta 0:31:41
epoch [13/50] batch [140/288] time 0.143 (0.173) data 0.000 (0.002) loss 1.0901 (1.1397) ce_loss 0.9639 (1.0118) teacher_loss 0.9679 (1.0067) loss_zs_kd 0.1167 (0.1304) loss_oracle 0.0638 (0.0678) acc 75.0000 (73.1250) kd_loss 0.0398 (0.0396) lr 1.7705e-03 eta 0:31:07
epoch [13/50] batch [160/288] time 0.172 (0.171) data 0.000 (0.002) loss 1.2274 (1.1268) ce_loss 1.1230 (0.9984) teacher_loss 1.1164 (0.9935) loss_zs_kd 0.1032 (0.1296) loss_oracle 0.0594 (0.0684) acc 75.0000 (73.4961) kd_loss 0.0348 (0.0401) lr 1.7705e-03 eta 0:30:41
epoch [13/50] batch [180/288] time 0.165 (0.169) data 0.000 (0.002) loss 0.7257 (1.1350) ce_loss 0.6289 (1.0061) teacher_loss 0.6291 (1.0009) loss_zs_kd 0.0807 (0.1302) loss_oracle 0.0563 (0.0690) acc 81.2500 (73.2465) kd_loss 0.0337 (0.0408) lr 1.7705e-03 eta 0:30:21
epoch [13/50] batch [200/288] time 0.091 (0.166) data 0.000 (0.001) loss 1.5216 (1.1322) ce_loss 1.4238 (1.0029) teacher_loss 1.4206 (0.9975) loss_zs_kd 0.1057 (0.1307) loss_oracle 0.0482 (0.0693) acc 62.5000 (73.3281) kd_loss 0.0432 (0.0418) lr 1.7705e-03 eta 0:29:47
epoch [13/50] batch [220/288] time 0.344 (0.175) data 0.000 (0.001) loss 0.9557 (1.1265) ce_loss 0.8052 (0.9974) teacher_loss 0.7992 (0.9918) loss_zs_kd 0.1538 (0.1308) loss_oracle 0.0795 (0.0693) acc 81.2500 (73.4233) kd_loss 0.0648 (0.0425) lr 1.7705e-03 eta 0:31:19
epoch [13/50] batch [240/288] time 0.170 (0.173) data 0.000 (0.001) loss 1.2936 (1.1218) ce_loss 1.1533 (0.9937) teacher_loss 1.1569 (0.9877) loss_zs_kd 0.1424 (0.1296) loss_oracle 0.0656 (0.0693) acc 71.8750 (73.4896) kd_loss 0.0435 (0.0428) lr 1.7705e-03 eta 0:30:55
epoch [13/50] batch [260/288] time 0.165 (0.173) data 0.000 (0.001) loss 1.1718 (1.1097) ce_loss 1.0391 (0.9827) teacher_loss 1.0409 (0.9765) loss_zs_kd 0.1226 (0.1282) loss_oracle 0.0696 (0.0691) acc 75.0000 (73.8221) kd_loss 0.0433 (0.0432) lr 1.7705e-03 eta 0:30:43
epoch [13/50] batch [280/288] time 0.179 (0.172) data 0.000 (0.001) loss 0.8186 (1.1102) ce_loss 0.7153 (0.9838) teacher_loss 0.6819 (0.9775) loss_zs_kd 0.0961 (0.1274) loss_oracle 0.0887 (0.0690) acc 84.3750 (73.7612) kd_loss 0.0534 (0.0432) lr 1.7705e-03 eta 0:30:35
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,412
* accuracy: 86.6%
* error: 13.4%
* macro_f1: 86.1%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,016
* accuracy: 83.1%
* error: 16.9%
* macro_f1: 80.0%
******* Domain a best val acc:      86.6%, epoch: 13 *******
******* Domain a best val test acc: 83.1%, epoch: 13 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [14/50] batch [20/288] time 0.088 (0.266) data 0.000 (0.017) loss 1.1442 (1.1376) ce_loss 1.0156 (0.9992) teacher_loss 1.0050 (0.9979) loss_zs_kd 0.1273 (0.1276) loss_oracle 0.0755 (0.0759) acc 71.8750 (73.5938) kd_loss 0.0572 (0.0439) lr 1.7290e-03 eta 0:47:13
epoch [14/50] batch [40/288] time 0.163 (0.212) data 0.000 (0.009) loss 0.8824 (1.0950) ce_loss 0.7329 (0.9661) teacher_loss 0.7189 (0.9621) loss_zs_kd 0.1828 (0.1258) loss_oracle 0.0721 (0.0700) acc 78.1250 (74.2969) kd_loss 0.0464 (0.0428) lr 1.7290e-03 eta 0:37:28
epoch [14/50] batch [60/288] time 0.169 (0.194) data 0.000 (0.006) loss 1.0067 (1.0716) ce_loss 0.8818 (0.9438) teacher_loss 0.8854 (0.9391) loss_zs_kd 0.1115 (0.1272) loss_oracle 0.0655 (0.0689) acc 75.0000 (74.7396) kd_loss 0.0309 (0.0429) lr 1.7290e-03 eta 0:34:12
epoch [14/50] batch [80/288] time 0.162 (0.184) data 0.000 (0.004) loss 1.2779 (1.0970) ce_loss 1.1318 (0.9641) teacher_loss 1.1183 (0.9597) loss_zs_kd 0.1110 (0.1317) loss_oracle 0.1041 (0.0714) acc 78.1250 (74.1797) kd_loss 0.0610 (0.0430) lr 1.7290e-03 eta 0:32:29
epoch [14/50] batch [100/288] time 0.169 (0.179) data 0.000 (0.004) loss 1.3048 (1.0964) ce_loss 1.1504 (0.9610) teacher_loss 1.1458 (0.9558) loss_zs_kd 0.1602 (0.1348) loss_oracle 0.0789 (0.0732) acc 62.5000 (74.0938) kd_loss 0.0415 (0.0440) lr 1.7290e-03 eta 0:31:29
epoch [14/50] batch [120/288] time 0.152 (0.175) data 0.000 (0.003) loss 0.8697 (1.1093) ce_loss 0.7168 (0.9732) teacher_loss 0.7178 (0.9681) loss_zs_kd 0.1274 (0.1333) loss_oracle 0.0882 (0.0745) acc 84.3750 (73.9323) kd_loss 0.0552 (0.0442) lr 1.7290e-03 eta 0:30:44
epoch [14/50] batch [140/288] time 0.368 (0.179) data 0.000 (0.003) loss 0.9088 (1.1186) ce_loss 0.8057 (0.9843) teacher_loss 0.7697 (0.9785) loss_zs_kd 0.1200 (0.1322) loss_oracle 0.0792 (0.0740) acc 81.2500 (73.8616) kd_loss 0.0617 (0.0447) lr 1.7290e-03 eta 0:31:17
epoch [14/50] batch [160/288] time 0.088 (0.181) data 0.000 (0.002) loss 0.8341 (1.1063) ce_loss 0.6997 (0.9728) teacher_loss 0.7041 (0.9673) loss_zs_kd 0.1150 (0.1310) loss_oracle 0.0725 (0.0735) acc 78.1250 (74.1992) kd_loss 0.0584 (0.0449) lr 1.7290e-03 eta 0:31:34
epoch [14/50] batch [180/288] time 0.152 (0.176) data 0.000 (0.002) loss 0.7329 (1.0943) ce_loss 0.6313 (0.9623) teacher_loss 0.6338 (0.9568) loss_zs_kd 0.0881 (0.1298) loss_oracle 0.0550 (0.0726) acc 84.3750 (74.4618) kd_loss 0.0299 (0.0451) lr 1.7290e-03 eta 0:30:48
epoch [14/50] batch [200/288] time 0.166 (0.175) data 0.000 (0.002) loss 1.3347 (1.0996) ce_loss 1.2070 (0.9686) teacher_loss 1.1881 (0.9630) loss_zs_kd 0.1397 (0.1290) loss_oracle 0.0768 (0.0720) acc 68.7500 (74.3125) kd_loss 0.0507 (0.0449) lr 1.7290e-03 eta 0:30:32
epoch [14/50] batch [220/288] time 0.169 (0.174) data 0.000 (0.002) loss 0.5379 (1.0935) ce_loss 0.4197 (0.9622) teacher_loss 0.4181 (0.9566) loss_zs_kd 0.1039 (0.1294) loss_oracle 0.0679 (0.0721) acc 90.6250 (74.4602) kd_loss 0.0479 (0.0451) lr 1.7290e-03 eta 0:30:14
epoch [14/50] batch [240/288] time 0.152 (0.173) data 0.000 (0.002) loss 1.0215 (1.0888) ce_loss 0.8579 (0.9577) teacher_loss 0.8424 (0.9517) loss_zs_kd 0.1717 (0.1305) loss_oracle 0.0933 (0.0719) acc 75.0000 (74.5182) kd_loss 0.0591 (0.0453) lr 1.7290e-03 eta 0:30:00
epoch [14/50] batch [260/288] time 0.186 (0.172) data 0.000 (0.001) loss 1.4490 (1.0897) ce_loss 1.3154 (0.9594) teacher_loss 1.3035 (0.9534) loss_zs_kd 0.1332 (0.1305) loss_oracle 0.0790 (0.0711) acc 71.8750 (74.5913) kd_loss 0.0486 (0.0451) lr 1.7290e-03 eta 0:29:50
epoch [14/50] batch [280/288] time 0.084 (0.173) data 0.000 (0.001) loss 0.6736 (1.0888) ce_loss 0.5415 (0.9587) teacher_loss 0.5220 (0.9523) loss_zs_kd 0.1118 (0.1300) loss_oracle 0.0957 (0.0716) acc 84.3750 (74.6094) kd_loss 0.0541 (0.0451) lr 1.7290e-03 eta 0:29:52
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,414
* accuracy: 86.7%
* error: 13.3%
* macro_f1: 86.1%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,022
* accuracy: 83.3%
* error: 16.7%
* macro_f1: 80.0%
******* Domain a best val acc:      86.7%, epoch: 14 *******
******* Domain a best val test acc: 83.3%, epoch: 14 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [15/50] batch [20/288] time 0.151 (0.176) data 0.000 (0.014) loss 1.1801 (1.0968) ce_loss 1.0684 (0.9673) teacher_loss 1.0726 (0.9638) loss_zs_kd 0.0916 (0.1293) loss_oracle 0.0618 (0.0684) acc 78.1250 (74.8438) kd_loss 0.0366 (0.0415) lr 1.6845e-03 eta 0:30:26
epoch [15/50] batch [40/288] time 0.153 (0.170) data 0.000 (0.007) loss 1.2282 (1.1595) ce_loss 1.1074 (1.0315) teacher_loss 1.1049 (1.0287) loss_zs_kd 0.1177 (0.1268) loss_oracle 0.0645 (0.0674) acc 78.1250 (73.9062) kd_loss 0.0483 (0.0420) lr 1.6845e-03 eta 0:29:13
epoch [15/50] batch [60/288] time 0.167 (0.167) data 0.001 (0.005) loss 0.8235 (1.1151) ce_loss 0.6836 (0.9869) teacher_loss 0.6844 (0.9840) loss_zs_kd 0.1055 (0.1255) loss_oracle 0.0864 (0.0684) acc 78.1250 (74.5312) kd_loss 0.0498 (0.0428) lr 1.6845e-03 eta 0:28:46
epoch [15/50] batch [80/288] time 0.083 (0.167) data 0.000 (0.004) loss 1.1000 (1.0789) ce_loss 0.9653 (0.9494) teacher_loss 0.9630 (0.9456) loss_zs_kd 0.1113 (0.1251) loss_oracle 0.0814 (0.0708) acc 78.1250 (75.1953) kd_loss 0.0527 (0.0442) lr 1.6845e-03 eta 0:28:34
epoch [15/50] batch [100/288] time 0.152 (0.177) data 0.000 (0.003) loss 1.1509 (1.0718) ce_loss 1.0117 (0.9407) teacher_loss 1.0150 (0.9363) loss_zs_kd 0.1000 (0.1269) loss_oracle 0.0859 (0.0721) acc 71.8750 (75.0625) kd_loss 0.0340 (0.0450) lr 1.6845e-03 eta 0:30:20
epoch [15/50] batch [120/288] time 0.152 (0.174) data 0.000 (0.003) loss 1.3964 (1.0757) ce_loss 1.2539 (0.9439) teacher_loss 1.2521 (0.9396) loss_zs_kd 0.1577 (0.1260) loss_oracle 0.0654 (0.0731) acc 71.8750 (74.9219) kd_loss 0.0399 (0.0456) lr 1.6845e-03 eta 0:29:45
epoch [15/50] batch [140/288] time 0.166 (0.172) data 0.000 (0.002) loss 1.2113 (1.0874) ce_loss 1.0879 (0.9546) teacher_loss 1.0838 (0.9495) loss_zs_kd 0.1027 (0.1258) loss_oracle 0.0762 (0.0750) acc 68.7500 (74.5312) kd_loss 0.0491 (0.0471) lr 1.6845e-03 eta 0:29:16
epoch [15/50] batch [160/288] time 0.148 (0.170) data 0.000 (0.002) loss 1.1410 (1.0933) ce_loss 1.0449 (0.9607) teacher_loss 1.0353 (0.9552) loss_zs_kd 0.1003 (0.1268) loss_oracle 0.0556 (0.0747) acc 71.8750 (74.3359) kd_loss 0.0441 (0.0478) lr 1.6845e-03 eta 0:28:52
epoch [15/50] batch [180/288] time 0.148 (0.168) data 0.000 (0.002) loss 1.5194 (1.1006) ce_loss 1.3604 (0.9685) teacher_loss 1.3363 (0.9629) loss_zs_kd 0.1516 (0.1261) loss_oracle 0.1073 (0.0747) acc 75.0000 (74.2014) kd_loss 0.0694 (0.0483) lr 1.6845e-03 eta 0:28:34
epoch [15/50] batch [200/288] time 0.172 (0.167) data 0.000 (0.002) loss 0.9492 (1.1069) ce_loss 0.8223 (0.9750) teacher_loss 0.7910 (0.9688) loss_zs_kd 0.1563 (0.1268) loss_oracle 0.0800 (0.0748) acc 71.8750 (73.9375) kd_loss 0.0551 (0.0484) lr 1.6845e-03 eta 0:28:20
epoch [15/50] batch [220/288] time 0.084 (0.168) data 0.000 (0.001) loss 1.2472 (1.1060) ce_loss 1.1035 (0.9743) teacher_loss 1.1044 (0.9679) loss_zs_kd 0.1328 (0.1269) loss_oracle 0.0765 (0.0747) acc 71.8750 (73.8636) kd_loss 0.0570 (0.0487) lr 1.6845e-03 eta 0:28:21
epoch [15/50] batch [240/288] time 0.088 (0.170) data 0.000 (0.001) loss 0.9848 (1.1006) ce_loss 0.7827 (0.9681) teacher_loss 0.7718 (0.9615) loss_zs_kd 0.2318 (0.1282) loss_oracle 0.0971 (0.0750) acc 71.8750 (74.0104) kd_loss 0.0725 (0.0492) lr 1.6845e-03 eta 0:28:40
epoch [15/50] batch [260/288] time 0.173 (0.169) data 0.000 (0.001) loss 1.1360 (1.1037) ce_loss 1.0264 (0.9710) teacher_loss 1.0294 (0.9640) loss_zs_kd 0.0924 (0.1290) loss_oracle 0.0604 (0.0752) acc 75.0000 (73.9663) kd_loss 0.0390 (0.0495) lr 1.6845e-03 eta 0:28:31
epoch [15/50] batch [280/288] time 0.148 (0.168) data 0.000 (0.001) loss 1.0858 (1.1006) ce_loss 0.9863 (0.9686) teacher_loss 0.9805 (0.9617) loss_zs_kd 0.0996 (0.1278) loss_oracle 0.0556 (0.0751) acc 71.8750 (73.9621) kd_loss 0.0385 (0.0494) lr 1.6845e-03 eta 0:28:17
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,409
* accuracy: 86.5%
* error: 13.5%
* macro_f1: 86.0%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,021
* accuracy: 83.3%
* error: 16.7%
* macro_f1: 79.9%
******* Domain a best val acc:      86.7%, epoch: 14 *******
******* Domain a best val test acc: 83.3%, epoch: 14 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [16/50] batch [20/288] time 0.081 (0.168) data 0.000 (0.013) loss 1.4199 (1.1259) ce_loss 1.2764 (1.0039) teacher_loss 1.2673 (0.9943) loss_zs_kd 0.1424 (0.1225) loss_oracle 0.0814 (0.0703) acc 71.8750 (73.2812) kd_loss 0.0506 (0.0447) lr 1.6374e-03 eta 0:28:11
epoch [16/50] batch [40/288] time 0.083 (0.162) data 0.000 (0.007) loss 1.3087 (1.0939) ce_loss 1.2021 (0.9684) teacher_loss 1.1718 (0.9597) loss_zs_kd 0.1443 (0.1259) loss_oracle 0.0647 (0.0712) acc 68.7500 (73.7500) kd_loss 0.0466 (0.0460) lr 1.6374e-03 eta 0:27:09
epoch [16/50] batch [60/288] time 0.111 (0.176) data 0.000 (0.004) loss 1.2818 (1.0908) ce_loss 1.1357 (0.9652) teacher_loss 1.1268 (0.9577) loss_zs_kd 0.1528 (0.1258) loss_oracle 0.0785 (0.0702) acc 78.1250 (74.1667) kd_loss 0.0460 (0.0441) lr 1.6374e-03 eta 0:29:18
epoch [16/50] batch [80/288] time 0.170 (0.174) data 0.000 (0.003) loss 1.5211 (1.0909) ce_loss 1.3730 (0.9629) teacher_loss 1.3728 (0.9561) loss_zs_kd 0.1522 (0.1273) loss_oracle 0.0723 (0.0712) acc 59.3750 (73.9062) kd_loss 0.0395 (0.0429) lr 1.6374e-03 eta 0:28:56
epoch [16/50] batch [100/288] time 0.172 (0.172) data 0.000 (0.003) loss 1.1892 (1.1063) ce_loss 1.0615 (0.9759) teacher_loss 1.0499 (0.9693) loss_zs_kd 0.1479 (0.1294) loss_oracle 0.0654 (0.0723) acc 65.6250 (73.2812) kd_loss 0.0406 (0.0424) lr 1.6374e-03 eta 0:28:38
epoch [16/50] batch [120/288] time 0.157 (0.170) data 0.000 (0.002) loss 0.9266 (1.1002) ce_loss 0.7808 (0.9719) teacher_loss 0.7680 (0.9645) loss_zs_kd 0.1708 (0.1270) loss_oracle 0.0733 (0.0721) acc 81.2500 (73.3073) kd_loss 0.0390 (0.0422) lr 1.6374e-03 eta 0:28:15
epoch [16/50] batch [140/288] time 0.160 (0.168) data 0.000 (0.002) loss 1.1654 (1.0814) ce_loss 1.0449 (0.9541) teacher_loss 1.0452 (0.9474) loss_zs_kd 0.1277 (0.1259) loss_oracle 0.0563 (0.0711) acc 75.0000 (73.8839) kd_loss 0.0273 (0.0412) lr 1.6374e-03 eta 0:27:51
epoch [16/50] batch [160/288] time 0.173 (0.167) data 0.000 (0.002) loss 1.1853 (1.0805) ce_loss 1.0537 (0.9520) teacher_loss 1.0348 (0.9450) loss_zs_kd 0.1191 (0.1270) loss_oracle 0.0910 (0.0720) acc 75.0000 (74.0625) kd_loss 0.0462 (0.0413) lr 1.6374e-03 eta 0:27:37
epoch [16/50] batch [180/288] time 0.107 (0.169) data 0.000 (0.002) loss 0.8566 (1.0909) ce_loss 0.7627 (0.9621) teacher_loss 0.7646 (0.9554) loss_zs_kd 0.0864 (0.1273) loss_oracle 0.0487 (0.0719) acc 81.2500 (74.0972) kd_loss 0.0283 (0.0411) lr 1.6374e-03 eta 0:27:55
epoch [16/50] batch [200/288] time 0.170 (0.175) data 0.000 (0.002) loss 0.9357 (1.0948) ce_loss 0.7842 (0.9666) teacher_loss 0.7856 (0.9599) loss_zs_kd 0.1400 (0.1263) loss_oracle 0.0801 (0.0717) acc 78.1250 (73.8438) kd_loss 0.0484 (0.0411) lr 1.6374e-03 eta 0:28:48
epoch [16/50] batch [220/288] time 0.167 (0.174) data 0.000 (0.001) loss 0.8044 (1.0913) ce_loss 0.6704 (0.9631) teacher_loss 0.6714 (0.9564) loss_zs_kd 0.1485 (0.1270) loss_oracle 0.0587 (0.0714) acc 84.3750 (73.8494) kd_loss 0.0393 (0.0409) lr 1.6374e-03 eta 0:28:33
epoch [16/50] batch [240/288] time 0.161 (0.173) data 0.000 (0.001) loss 0.9683 (1.0840) ce_loss 0.8276 (0.9554) teacher_loss 0.8370 (0.9488) loss_zs_kd 0.1694 (0.1280) loss_oracle 0.0466 (0.0712) acc 78.1250 (74.0495) kd_loss 0.0278 (0.0408) lr 1.6374e-03 eta 0:28:21
epoch [16/50] batch [260/288] time 0.158 (0.172) data 0.000 (0.001) loss 0.9950 (1.0886) ce_loss 0.8726 (0.9596) teacher_loss 0.8802 (0.9533) loss_zs_kd 0.1199 (0.1288) loss_oracle 0.0548 (0.0709) acc 78.1250 (73.9303) kd_loss 0.0277 (0.0409) lr 1.6374e-03 eta 0:28:08
epoch [16/50] batch [280/288] time 0.153 (0.171) data 0.000 (0.001) loss 1.5619 (1.0970) ce_loss 1.4199 (0.9669) teacher_loss 1.4016 (0.9609) loss_zs_kd 0.1635 (0.1299) loss_oracle 0.0787 (0.0711) acc 62.5000 (73.8170) kd_loss 0.0449 (0.0409) lr 1.6374e-03 eta 0:27:54
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,421
* accuracy: 86.8%
* error: 13.2%
* macro_f1: 86.3%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,021
* accuracy: 83.3%
* error: 16.7%
* macro_f1: 80.2%
******* Domain a best val acc:      86.8%, epoch: 16 *******
******* Domain a best val test acc: 83.3%, epoch: 16 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [17/50] batch [20/288] time 0.161 (0.184) data 0.000 (0.016) loss 1.5258 (0.9650) ce_loss 1.3984 (0.8290) teacher_loss 1.4015 (0.8239) loss_zs_kd 0.1235 (0.1152) loss_oracle 0.0625 (0.0835) acc 71.8750 (79.0625) kd_loss 0.0225 (0.0436) lr 1.5878e-03 eta 0:29:59
epoch [17/50] batch [40/288] time 0.166 (0.180) data 0.000 (0.008) loss 1.0301 (1.0476) ce_loss 0.8828 (0.9149) teacher_loss 0.8691 (0.9080) loss_zs_kd 0.1423 (0.1187) loss_oracle 0.0899 (0.0802) acc 78.1250 (76.7969) kd_loss 0.0561 (0.0456) lr 1.5878e-03 eta 0:29:12
epoch [17/50] batch [60/288] time 0.176 (0.177) data 0.001 (0.006) loss 1.4520 (1.0646) ce_loss 1.3271 (0.9324) teacher_loss 1.3351 (0.9258) loss_zs_kd 0.1101 (0.1226) loss_oracle 0.0619 (0.0775) acc 68.7500 (75.8333) kd_loss 0.0284 (0.0446) lr 1.5878e-03 eta 0:28:45
epoch [17/50] batch [80/288] time 0.159 (0.176) data 0.000 (0.004) loss 0.8847 (1.0597) ce_loss 0.7725 (0.9278) teacher_loss 0.7439 (0.9212) loss_zs_kd 0.1552 (0.1264) loss_oracle 0.0632 (0.0753) acc 78.1250 (75.8594) kd_loss 0.0401 (0.0441) lr 1.5878e-03 eta 0:28:26
epoch [17/50] batch [100/288] time 0.110 (0.175) data 0.000 (0.004) loss 1.2339 (1.0631) ce_loss 1.0791 (0.9291) teacher_loss 1.0784 (0.9223) loss_zs_kd 0.1228 (0.1282) loss_oracle 0.0941 (0.0767) acc 62.5000 (75.5938) kd_loss 0.0588 (0.0447) lr 1.5878e-03 eta 0:28:13
epoch [17/50] batch [120/288] time 0.114 (0.176) data 0.000 (0.003) loss 1.0989 (1.0709) ce_loss 0.9917 (0.9368) teacher_loss 0.9993 (0.9309) loss_zs_kd 0.0805 (0.1280) loss_oracle 0.0594 (0.0759) acc 75.0000 (75.0781) kd_loss 0.0334 (0.0444) lr 1.5878e-03 eta 0:28:19
epoch [17/50] batch [140/288] time 0.177 (0.183) data 0.001 (0.003) loss 1.2607 (1.0939) ce_loss 1.1436 (0.9595) teacher_loss 1.1449 (0.9529) loss_zs_kd 0.1276 (0.1295) loss_oracle 0.0520 (0.0762) acc 65.6250 (74.5982) kd_loss 0.0363 (0.0453) lr 1.5878e-03 eta 0:29:29
epoch [17/50] batch [160/288] time 0.167 (0.182) data 0.000 (0.002) loss 1.1633 (1.0939) ce_loss 1.0439 (0.9600) teacher_loss 1.0364 (0.9534) loss_zs_kd 0.1206 (0.1298) loss_oracle 0.0666 (0.0756) acc 68.7500 (74.5508) kd_loss 0.0473 (0.0459) lr 1.5878e-03 eta 0:29:11
epoch [17/50] batch [180/288] time 0.165 (0.179) data 0.000 (0.002) loss 0.9938 (1.0850) ce_loss 0.8638 (0.9522) teacher_loss 0.8574 (0.9453) loss_zs_kd 0.0999 (0.1284) loss_oracle 0.0865 (0.0755) acc 78.1250 (74.6875) kd_loss 0.0512 (0.0460) lr 1.5878e-03 eta 0:28:45
epoch [17/50] batch [200/288] time 0.148 (0.177) data 0.000 (0.002) loss 0.9292 (1.0828) ce_loss 0.8101 (0.9492) teacher_loss 0.8122 (0.9423) loss_zs_kd 0.0862 (0.1292) loss_oracle 0.0739 (0.0760) acc 75.0000 (74.7812) kd_loss 0.0434 (0.0464) lr 1.5878e-03 eta 0:28:21
epoch [17/50] batch [220/288] time 0.146 (0.175) data 0.000 (0.002) loss 0.9345 (1.0822) ce_loss 0.8247 (0.9479) teacher_loss 0.8127 (0.9413) loss_zs_kd 0.0737 (0.1302) loss_oracle 0.0849 (0.0758) acc 81.2500 (74.8153) kd_loss 0.0501 (0.0464) lr 1.5878e-03 eta 0:27:59
epoch [17/50] batch [240/288] time 0.105 (0.173) data 0.000 (0.002) loss 1.0504 (1.0804) ce_loss 0.9360 (0.9460) teacher_loss 0.9076 (0.9394) loss_zs_kd 0.1103 (0.1300) loss_oracle 0.0877 (0.0760) acc 71.8750 (74.7656) kd_loss 0.0480 (0.0464) lr 1.5878e-03 eta 0:27:33
epoch [17/50] batch [260/288] time 0.294 (0.181) data 0.000 (0.002) loss 1.4824 (1.0834) ce_loss 1.3604 (0.9485) teacher_loss 1.3606 (0.9418) loss_zs_kd 0.1290 (0.1307) loss_oracle 0.0573 (0.0763) acc 68.7500 (74.6875) kd_loss 0.0368 (0.0464) lr 1.5878e-03 eta 0:28:42
epoch [17/50] batch [280/288] time 0.147 (0.178) data 0.000 (0.001) loss 1.3666 (1.0832) ce_loss 1.2266 (0.9475) teacher_loss 1.1968 (0.9409) loss_zs_kd 0.1731 (0.1316) loss_oracle 0.0833 (0.0765) acc 71.8750 (74.7433) kd_loss 0.0587 (0.0464) lr 1.5878e-03 eta 0:28:13
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,424
* accuracy: 86.9%
* error: 13.1%
* macro_f1: 86.4%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,017
* accuracy: 83.1%
* error: 16.9%
* macro_f1: 79.9%
******* Domain a best val acc:      86.9%, epoch: 17 *******
******* Domain a best val test acc: 83.1%, epoch: 17 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [18/50] batch [20/288] time 0.152 (0.183) data 0.000 (0.015) loss 1.3625 (1.0769) ce_loss 1.2480 (0.9367) teacher_loss 1.2320 (0.9299) loss_zs_kd 0.1323 (0.1411) loss_oracle 0.0644 (0.0764) acc 68.7500 (75.0000) kd_loss 0.0423 (0.0443) lr 1.5358e-03 eta 0:28:54
epoch [18/50] batch [40/288] time 0.394 (0.177) data 0.000 (0.008) loss 1.6498 (1.1264) ce_loss 1.4863 (0.9854) teacher_loss 1.4868 (0.9781) loss_zs_kd 0.1848 (0.1408) loss_oracle 0.0706 (0.0779) acc 62.5000 (73.6719) kd_loss 0.0449 (0.0464) lr 1.5358e-03 eta 0:27:58
epoch [18/50] batch [60/288] time 0.146 (0.199) data 0.000 (0.005) loss 0.8501 (1.1202) ce_loss 0.7100 (0.9838) teacher_loss 0.7062 (0.9761) loss_zs_kd 0.1238 (0.1348) loss_oracle 0.0819 (0.0767) acc 75.0000 (73.6458) kd_loss 0.0615 (0.0465) lr 1.5358e-03 eta 0:31:22
epoch [18/50] batch [80/288] time 0.152 (0.187) data 0.000 (0.004) loss 1.9856 (1.1410) ce_loss 1.7998 (1.0046) teacher_loss 1.7939 (0.9958) loss_zs_kd 0.1805 (0.1338) loss_oracle 0.1015 (0.0783) acc 53.1250 (73.0078) kd_loss 0.0500 (0.0477) lr 1.5358e-03 eta 0:29:18
epoch [18/50] batch [100/288] time 0.151 (0.181) data 0.000 (0.003) loss 0.9164 (1.1316) ce_loss 0.8086 (0.9924) teacher_loss 0.7867 (0.9840) loss_zs_kd 0.1026 (0.1337) loss_oracle 0.0783 (0.0808) acc 87.5000 (73.1250) kd_loss 0.0515 (0.0493) lr 1.5358e-03 eta 0:28:25
epoch [18/50] batch [120/288] time 0.174 (0.178) data 0.000 (0.003) loss 1.2313 (1.1185) ce_loss 1.0830 (0.9791) teacher_loss 1.0877 (0.9709) loss_zs_kd 0.1290 (0.1323) loss_oracle 0.0791 (0.0814) acc 75.0000 (73.4635) kd_loss 0.0520 (0.0499) lr 1.5358e-03 eta 0:27:49
epoch [18/50] batch [140/288] time 0.155 (0.176) data 0.000 (0.002) loss 1.1667 (1.1261) ce_loss 1.0244 (0.9866) teacher_loss 1.0232 (0.9781) loss_zs_kd 0.1306 (0.1324) loss_oracle 0.0782 (0.0818) acc 75.0000 (73.1696) kd_loss 0.0476 (0.0505) lr 1.5358e-03 eta 0:27:24
epoch [18/50] batch [160/288] time 0.165 (0.174) data 0.000 (0.002) loss 1.0379 (1.1184) ce_loss 0.8926 (0.9780) teacher_loss 0.8642 (0.9691) loss_zs_kd 0.1695 (0.1333) loss_oracle 0.0890 (0.0827) acc 75.0000 (73.4180) kd_loss 0.0446 (0.0513) lr 1.5358e-03 eta 0:27:05
epoch [18/50] batch [180/288] time 0.093 (0.175) data 0.000 (0.002) loss 1.0055 (1.1141) ce_loss 0.8032 (0.9724) teacher_loss 0.8170 (0.9636) loss_zs_kd 0.1731 (0.1340) loss_oracle 0.1019 (0.0835) acc 68.7500 (73.5590) kd_loss 0.0623 (0.0517) lr 1.5358e-03 eta 0:27:07
epoch [18/50] batch [200/288] time 0.084 (0.177) data 0.000 (0.002) loss 1.4582 (1.1052) ce_loss 1.3008 (0.9633) teacher_loss 1.2933 (0.9546) loss_zs_kd 0.1298 (0.1335) loss_oracle 0.0999 (0.0838) acc 65.6250 (73.7500) kd_loss 0.0677 (0.0523) lr 1.5358e-03 eta 0:27:27
epoch [18/50] batch [220/288] time 0.158 (0.175) data 0.000 (0.002) loss 1.6160 (1.1089) ce_loss 1.5049 (0.9683) teacher_loss 1.4899 (0.9587) loss_zs_kd 0.1131 (0.1329) loss_oracle 0.0696 (0.0837) acc 62.5000 (73.5938) kd_loss 0.0413 (0.0525) lr 1.5358e-03 eta 0:27:04
epoch [18/50] batch [240/288] time 0.154 (0.174) data 0.000 (0.001) loss 0.8806 (1.1109) ce_loss 0.7197 (0.9695) teacher_loss 0.7118 (0.9602) loss_zs_kd 0.1407 (0.1332) loss_oracle 0.0985 (0.0842) acc 84.3750 (73.5677) kd_loss 0.0626 (0.0528) lr 1.5358e-03 eta 0:26:48
epoch [18/50] batch [260/288] time 0.149 (0.173) data 0.000 (0.001) loss 1.0761 (1.1099) ce_loss 0.9639 (0.9691) teacher_loss 0.9431 (0.9600) loss_zs_kd 0.0706 (0.1322) loss_oracle 0.0977 (0.0838) acc 78.1250 (73.7620) kd_loss 0.0570 (0.0525) lr 1.5358e-03 eta 0:26:35
epoch [18/50] batch [280/288] time 0.151 (0.172) data 0.000 (0.001) loss 1.4334 (1.1136) ce_loss 1.2500 (0.9723) teacher_loss 1.2290 (0.9631) loss_zs_kd 0.1633 (0.1320) loss_oracle 0.1228 (0.0845) acc 65.6250 (73.7277) kd_loss 0.0805 (0.0528) lr 1.5358e-03 eta 0:26:21
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,429
* accuracy: 87.1%
* error: 12.9%
* macro_f1: 86.4%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,009
* accuracy: 82.8%
* error: 17.2%
* macro_f1: 79.5%
******* Domain a best val acc:      87.1%, epoch: 18 *******
******* Domain a best val test acc: 82.8%, epoch: 18 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [19/50] batch [20/288] time 0.171 (0.241) data 0.000 (0.019) loss 1.1187 (1.0585) ce_loss 1.0029 (0.9128) teacher_loss 1.0068 (0.9050) loss_zs_kd 0.1041 (0.1310) loss_oracle 0.0598 (0.0880) acc 71.8750 (76.8750) kd_loss 0.0383 (0.0550) lr 1.4818e-03 eta 0:36:55
epoch [19/50] batch [40/288] time 0.161 (0.201) data 0.000 (0.009) loss 1.1816 (1.1108) ce_loss 1.0586 (0.9684) teacher_loss 1.0460 (0.9600) loss_zs_kd 0.1258 (0.1302) loss_oracle 0.0726 (0.0858) acc 65.6250 (74.6875) kd_loss 0.0400 (0.0549) lr 1.4818e-03 eta 0:30:45
epoch [19/50] batch [60/288] time 0.175 (0.191) data 0.002 (0.006) loss 1.3707 (1.1566) ce_loss 1.2217 (1.0159) teacher_loss 1.2122 (1.0061) loss_zs_kd 0.1703 (0.1340) loss_oracle 0.0733 (0.0836) acc 71.8750 (73.4896) kd_loss 0.0556 (0.0546) lr 1.4818e-03 eta 0:29:04
epoch [19/50] batch [80/288] time 0.162 (0.185) data 0.000 (0.005) loss 1.0160 (1.1140) ce_loss 0.8828 (0.9760) teacher_loss 0.8807 (0.9673) loss_zs_kd 0.1249 (0.1329) loss_oracle 0.0728 (0.0802) acc 68.7500 (74.3359) kd_loss 0.0469 (0.0525) lr 1.4818e-03 eta 0:28:07
epoch [19/50] batch [100/288] time 0.167 (0.180) data 0.000 (0.004) loss 1.2155 (1.1083) ce_loss 1.0771 (0.9704) teacher_loss 1.0776 (0.9626) loss_zs_kd 0.1092 (0.1317) loss_oracle 0.0834 (0.0799) acc 65.6250 (74.4688) kd_loss 0.0406 (0.0505) lr 1.4818e-03 eta 0:27:24
epoch [19/50] batch [120/288] time 0.085 (0.182) data 0.000 (0.003) loss 1.5511 (1.1066) ce_loss 1.4424 (0.9685) teacher_loss 1.4017 (0.9607) loss_zs_kd 0.1268 (0.1311) loss_oracle 0.0860 (0.0803) acc 65.6250 (74.6094) kd_loss 0.0548 (0.0503) lr 1.4818e-03 eta 0:27:31
epoch [19/50] batch [140/288] time 0.086 (0.184) data 0.001 (0.003) loss 1.4372 (1.1063) ce_loss 1.3193 (0.9682) teacher_loss 1.3204 (0.9602) loss_zs_kd 0.1049 (0.1310) loss_oracle 0.0644 (0.0806) acc 75.0000 (74.6652) kd_loss 0.0444 (0.0506) lr 1.4818e-03 eta 0:27:46
epoch [19/50] batch [160/288] time 0.154 (0.181) data 0.000 (0.003) loss 1.1024 (1.1055) ce_loss 0.9658 (0.9690) teacher_loss 0.9531 (0.9610) loss_zs_kd 0.1422 (0.1288) loss_oracle 0.0782 (0.0801) acc 71.8750 (74.3945) kd_loss 0.0486 (0.0503) lr 1.4818e-03 eta 0:27:18
epoch [19/50] batch [180/288] time 0.152 (0.179) data 0.000 (0.002) loss 1.1728 (1.1050) ce_loss 1.0371 (0.9691) teacher_loss 1.0174 (0.9611) loss_zs_kd 0.1170 (0.1290) loss_oracle 0.0969 (0.0794) acc 75.0000 (74.2535) kd_loss 0.0609 (0.0499) lr 1.4818e-03 eta 0:27:00
epoch [19/50] batch [200/288] time 0.152 (0.177) data 0.000 (0.002) loss 0.7940 (1.0980) ce_loss 0.6274 (0.9626) teacher_loss 0.6216 (0.9548) loss_zs_kd 0.1599 (0.1294) loss_oracle 0.0923 (0.0786) acc 81.2500 (74.2969) kd_loss 0.0465 (0.0490) lr 1.4818e-03 eta 0:26:40
epoch [19/50] batch [220/288] time 0.155 (0.176) data 0.000 (0.002) loss 1.1277 (1.1070) ce_loss 0.9609 (0.9694) teacher_loss 0.9767 (0.9618) loss_zs_kd 0.1707 (0.1320) loss_oracle 0.0656 (0.0792) acc 78.1250 (74.2472) kd_loss 0.0393 (0.0491) lr 1.4818e-03 eta 0:26:26
epoch [19/50] batch [240/288] time 0.100 (0.174) data 0.000 (0.002) loss 0.8343 (1.1049) ce_loss 0.6562 (0.9672) teacher_loss 0.6506 (0.9594) loss_zs_kd 0.2030 (0.1325) loss_oracle 0.0823 (0.0792) acc 81.2500 (74.1667) kd_loss 0.0504 (0.0491) lr 1.4818e-03 eta 0:25:59
epoch [19/50] batch [260/288] time 0.215 (0.181) data 0.000 (0.002) loss 1.1599 (1.1018) ce_loss 1.0293 (0.9639) teacher_loss 1.0259 (0.9563) loss_zs_kd 0.1478 (0.1331) loss_oracle 0.0600 (0.0789) acc 75.0000 (74.2428) kd_loss 0.0394 (0.0489) lr 1.4818e-03 eta 0:26:59
epoch [19/50] batch [280/288] time 0.143 (0.178) data 0.000 (0.002) loss 1.5681 (1.1021) ce_loss 1.4346 (0.9646) teacher_loss 1.4312 (0.9569) loss_zs_kd 0.1623 (0.1333) loss_oracle 0.0558 (0.0785) acc 59.3750 (74.2746) kd_loss 0.0406 (0.0487) lr 1.4818e-03 eta 0:26:31
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,425
* accuracy: 87.0%
* error: 13.0%
* macro_f1: 86.4%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,019
* accuracy: 83.2%
* error: 16.8%
* macro_f1: 80.0%
******* Domain a best val acc:      87.1%, epoch: 18 *******
******* Domain a best val test acc: 82.8%, epoch: 18 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [20/50] batch [20/288] time 0.152 (0.180) data 0.000 (0.013) loss 1.5050 (1.0780) ce_loss 1.3750 (0.9399) teacher_loss 1.3787 (0.9341) loss_zs_kd 0.1314 (0.1367) loss_oracle 0.0606 (0.0756) acc 62.5000 (74.2188) kd_loss 0.0354 (0.0454) lr 1.4258e-03 eta 0:26:43
epoch [20/50] batch [40/288] time 0.174 (0.174) data 0.000 (0.007) loss 1.1426 (1.0838) ce_loss 0.9458 (0.9414) teacher_loss 0.9356 (0.9343) loss_zs_kd 0.2379 (0.1448) loss_oracle 0.0881 (0.0772) acc 75.0000 (74.1406) kd_loss 0.0415 (0.0455) lr 1.4258e-03 eta 0:25:48
epoch [20/50] batch [60/288] time 0.402 (0.183) data 0.000 (0.004) loss 0.9165 (1.0784) ce_loss 0.8071 (0.9348) teacher_loss 0.8129 (0.9286) loss_zs_kd 0.0852 (0.1456) loss_oracle 0.0610 (0.0770) acc 81.2500 (74.5312) kd_loss 0.0337 (0.0451) lr 1.4258e-03 eta 0:27:01
epoch [20/50] batch [80/288] time 0.168 (0.188) data 0.000 (0.003) loss 0.9232 (1.0812) ce_loss 0.7852 (0.9364) teacher_loss 0.7819 (0.9307) loss_zs_kd 0.1071 (0.1431) loss_oracle 0.0877 (0.0789) acc 81.2500 (74.4531) kd_loss 0.0533 (0.0459) lr 1.4258e-03 eta 0:27:43
epoch [20/50] batch [100/288] time 0.154 (0.183) data 0.000 (0.003) loss 1.2639 (1.0726) ce_loss 1.1543 (0.9299) teacher_loss 1.1292 (0.9243) loss_zs_kd 0.1299 (0.1397) loss_oracle 0.0697 (0.0785) acc 68.7500 (74.7188) kd_loss 0.0413 (0.0454) lr 1.4258e-03 eta 0:26:51
epoch [20/50] batch [120/288] time 0.170 (0.179) data 0.000 (0.002) loss 0.6790 (1.0888) ce_loss 0.5771 (0.9481) teacher_loss 0.5706 (0.9415) loss_zs_kd 0.0710 (0.1386) loss_oracle 0.0730 (0.0780) acc 87.5000 (74.2969) kd_loss 0.0448 (0.0455) lr 1.4258e-03 eta 0:26:19
epoch [20/50] batch [140/288] time 0.152 (0.177) data 0.000 (0.002) loss 0.9424 (1.0944) ce_loss 0.8008 (0.9535) teacher_loss 0.7858 (0.9464) loss_zs_kd 0.1446 (0.1397) loss_oracle 0.0844 (0.0781) acc 78.1250 (74.0848) kd_loss 0.0449 (0.0458) lr 1.4258e-03 eta 0:25:51
epoch [20/50] batch [160/288] time 0.171 (0.175) data 0.000 (0.002) loss 1.0615 (1.0900) ce_loss 0.9565 (0.9500) teacher_loss 0.9631 (0.9434) loss_zs_kd 0.1069 (0.1391) loss_oracle 0.0449 (0.0771) acc 75.0000 (74.2578) kd_loss 0.0224 (0.0453) lr 1.4258e-03 eta 0:25:34
epoch [20/50] batch [180/288] time 0.088 (0.176) data 0.000 (0.002) loss 0.8629 (1.0806) ce_loss 0.7515 (0.9417) teacher_loss 0.7537 (0.9354) loss_zs_kd 0.1015 (0.1387) loss_oracle 0.0585 (0.0758) acc 81.2500 (74.4965) kd_loss 0.0367 (0.0446) lr 1.4258e-03 eta 0:25:39
epoch [20/50] batch [200/288] time 0.160 (0.180) data 0.000 (0.001) loss 1.5943 (1.0852) ce_loss 1.4023 (0.9464) teacher_loss 1.3962 (0.9403) loss_zs_kd 0.2041 (0.1378) loss_oracle 0.0960 (0.0760) acc 62.5000 (74.3281) kd_loss 0.0377 (0.0443) lr 1.4258e-03 eta 0:26:09
epoch [20/50] batch [220/288] time 0.152 (0.178) data 0.000 (0.001) loss 1.0248 (1.0744) ce_loss 0.8950 (0.9350) teacher_loss 0.8795 (0.9292) loss_zs_kd 0.1288 (0.1379) loss_oracle 0.0808 (0.0763) acc 75.0000 (74.4886) kd_loss 0.0390 (0.0437) lr 1.4258e-03 eta 0:25:46
epoch [20/50] batch [240/288] time 0.148 (0.176) data 0.000 (0.001) loss 1.2460 (1.0721) ce_loss 1.0742 (0.9314) teacher_loss 1.0862 (0.9259) loss_zs_kd 0.1393 (0.1388) loss_oracle 0.0901 (0.0767) acc 62.5000 (74.5703) kd_loss 0.0420 (0.0436) lr 1.4258e-03 eta 0:25:26
epoch [20/50] batch [260/288] time 0.163 (0.174) data 0.000 (0.001) loss 1.4037 (1.0685) ce_loss 1.2754 (0.9277) teacher_loss 1.2721 (0.9222) loss_zs_kd 0.0955 (0.1381) loss_oracle 0.0839 (0.0772) acc 65.6250 (74.6755) kd_loss 0.0444 (0.0438) lr 1.4258e-03 eta 0:25:09
epoch [20/50] batch [280/288] time 0.147 (0.173) data 0.000 (0.001) loss 0.8054 (1.0656) ce_loss 0.6816 (0.9257) teacher_loss 0.6796 (0.9201) loss_zs_kd 0.1165 (0.1373) loss_oracle 0.0675 (0.0769) acc 87.5000 (74.7656) kd_loss 0.0344 (0.0438) lr 1.4258e-03 eta 0:24:54
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,431
* accuracy: 87.1%
* error: 12.9%
* macro_f1: 86.5%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,024
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 80.3%
******* Domain a best val acc:      87.1%, epoch: 20 *******
******* Domain a best val test acc: 83.4%, epoch: 20 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [21/50] batch [20/288] time 0.153 (0.205) data 0.000 (0.015) loss 0.5958 (1.0377) ce_loss 0.4421 (0.8881) teacher_loss 0.4267 (0.8822) loss_zs_kd 0.1358 (0.1468) loss_oracle 0.1012 (0.0821) acc 90.6250 (74.5312) kd_loss 0.0491 (0.0425) lr 1.3681e-03 eta 0:29:30
epoch [21/50] batch [40/288] time 0.165 (0.187) data 0.000 (0.008) loss 0.7087 (1.0334) ce_loss 0.5879 (0.8888) teacher_loss 0.5859 (0.8836) loss_zs_kd 0.1199 (0.1409) loss_oracle 0.0628 (0.0794) acc 84.3750 (74.0625) kd_loss 0.0418 (0.0419) lr 1.3681e-03 eta 0:26:48
epoch [21/50] batch [60/288] time 0.168 (0.180) data 0.001 (0.005) loss 1.0094 (1.0539) ce_loss 0.8584 (0.9112) teacher_loss 0.8629 (0.9056) loss_zs_kd 0.1396 (0.1379) loss_oracle 0.0767 (0.0793) acc 78.1250 (74.3750) kd_loss 0.0359 (0.0421) lr 1.3681e-03 eta 0:25:45
epoch [21/50] batch [80/288] time 0.162 (0.175) data 0.000 (0.004) loss 0.7110 (1.0798) ce_loss 0.5869 (0.9385) teacher_loss 0.5832 (0.9332) loss_zs_kd 0.0847 (0.1343) loss_oracle 0.0855 (0.0795) acc 81.2500 (73.9062) kd_loss 0.0493 (0.0416) lr 1.3681e-03 eta 0:24:56
epoch [21/50] batch [100/288] time 0.153 (0.172) data 0.000 (0.003) loss 1.0405 (1.0684) ce_loss 0.9136 (0.9268) teacher_loss 0.9090 (0.9211) loss_zs_kd 0.0955 (0.1329) loss_oracle 0.0838 (0.0809) acc 75.0000 (74.3438) kd_loss 0.0384 (0.0423) lr 1.3681e-03 eta 0:24:29
epoch [21/50] batch [120/288] time 0.086 (0.175) data 0.000 (0.003) loss 0.8215 (1.0743) ce_loss 0.6982 (0.9325) teacher_loss 0.6978 (0.9266) loss_zs_kd 0.1050 (0.1352) loss_oracle 0.0712 (0.0801) acc 84.3750 (74.4271) kd_loss 0.0395 (0.0419) lr 1.3681e-03 eta 0:24:50
epoch [21/50] batch [140/288] time 0.167 (0.180) data 0.000 (0.002) loss 1.0783 (1.0842) ce_loss 0.9414 (0.9437) teacher_loss 0.9462 (0.9385) loss_zs_kd 0.1475 (0.1346) loss_oracle 0.0584 (0.0784) acc 81.2500 (74.1964) kd_loss 0.0265 (0.0411) lr 1.3681e-03 eta 0:25:31
epoch [21/50] batch [160/288] time 0.185 (0.178) data 0.000 (0.002) loss 1.0354 (1.0997) ce_loss 0.8955 (0.9577) teacher_loss 0.8851 (0.9528) loss_zs_kd 0.1369 (0.1379) loss_oracle 0.0818 (0.0779) acc 75.0000 (73.9648) kd_loss 0.0476 (0.0412) lr 1.3681e-03 eta 0:25:07
epoch [21/50] batch [180/288] time 0.179 (0.177) data 0.000 (0.002) loss 1.2891 (1.1048) ce_loss 1.1719 (0.9629) teacher_loss 1.1756 (0.9584) loss_zs_kd 0.1098 (0.1387) loss_oracle 0.0587 (0.0771) acc 68.7500 (73.7847) kd_loss 0.0265 (0.0407) lr 1.3681e-03 eta 0:24:59
epoch [21/50] batch [200/288] time 0.156 (0.177) data 0.000 (0.002) loss 1.2971 (1.0971) ce_loss 1.2021 (0.9554) teacher_loss 1.1901 (0.9510) loss_zs_kd 0.1098 (0.1385) loss_oracle 0.0521 (0.0769) acc 68.7500 (74.0625) kd_loss 0.0259 (0.0405) lr 1.3681e-03 eta 0:24:53
epoch [21/50] batch [220/288] time 0.172 (0.176) data 0.000 (0.002) loss 0.9330 (1.0962) ce_loss 0.8232 (0.9541) teacher_loss 0.8114 (0.9498) loss_zs_kd 0.1168 (0.1384) loss_oracle 0.0632 (0.0771) acc 78.1250 (74.0341) kd_loss 0.0326 (0.0406) lr 1.3681e-03 eta 0:24:45
epoch [21/50] batch [240/288] time 0.112 (0.175) data 0.000 (0.002) loss 1.0922 (1.1067) ce_loss 0.9351 (0.9654) teacher_loss 0.9381 (0.9612) loss_zs_kd 0.1682 (0.1381) loss_oracle 0.0700 (0.0765) acc 81.2500 (73.8672) kd_loss 0.0282 (0.0402) lr 1.3681e-03 eta 0:24:30
epoch [21/50] batch [260/288] time 0.282 (0.183) data 0.000 (0.001) loss 0.9972 (1.1031) ce_loss 0.8623 (0.9620) teacher_loss 0.8640 (0.9579) loss_zs_kd 0.1215 (0.1378) loss_oracle 0.0725 (0.0763) acc 75.0000 (73.9303) kd_loss 0.0325 (0.0401) lr 1.3681e-03 eta 0:25:33
epoch [21/50] batch [280/288] time 0.165 (0.181) data 0.000 (0.001) loss 0.9985 (1.1006) ce_loss 0.8804 (0.9598) teacher_loss 0.8761 (0.9557) loss_zs_kd 0.1132 (0.1378) loss_oracle 0.0658 (0.0760) acc 78.1250 (74.0625) kd_loss 0.0354 (0.0400) lr 1.3681e-03 eta 0:25:13
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,428
* accuracy: 87.0%
* error: 13.0%
* macro_f1: 86.4%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,015
* accuracy: 83.0%
* error: 17.0%
* macro_f1: 79.9%
******* Domain a best val acc:      87.1%, epoch: 20 *******
******* Domain a best val test acc: 83.4%, epoch: 20 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [22/50] batch [20/288] time 0.152 (0.178) data 0.000 (0.015) loss 1.5416 (1.0829) ce_loss 1.3965 (0.9341) teacher_loss 1.3927 (0.9281) loss_zs_kd 0.1524 (0.1526) loss_oracle 0.0727 (0.0786) acc 56.2500 (73.1250) kd_loss 0.0358 (0.0421) lr 1.3090e-03 eta 0:24:43
epoch [22/50] batch [40/288] time 0.098 (0.166) data 0.000 (0.008) loss 0.9822 (1.0676) ce_loss 0.8721 (0.9228) teacher_loss 0.8773 (0.9171) loss_zs_kd 0.1249 (0.1446) loss_oracle 0.0424 (0.0782) acc 84.3750 (73.8281) kd_loss 0.0198 (0.0409) lr 1.3090e-03 eta 0:22:57
epoch [22/50] batch [60/288] time 0.378 (0.193) data 0.000 (0.005) loss 0.8014 (1.0848) ce_loss 0.6621 (0.9433) teacher_loss 0.6593 (0.9378) loss_zs_kd 0.1860 (0.1447) loss_oracle 0.0491 (0.0747) acc 81.2500 (73.8542) kd_loss 0.0318 (0.0395) lr 1.3090e-03 eta 0:26:38
epoch [22/50] batch [80/288] time 0.164 (0.189) data 0.000 (0.004) loss 1.4200 (1.0723) ce_loss 1.2881 (0.9299) teacher_loss 1.2640 (0.9247) loss_zs_kd 0.1582 (0.1453) loss_oracle 0.0770 (0.0749) acc 68.7500 (74.4141) kd_loss 0.0426 (0.0400) lr 1.3090e-03 eta 0:26:05
epoch [22/50] batch [100/288] time 0.175 (0.185) data 0.000 (0.003) loss 0.8030 (1.0718) ce_loss 0.6929 (0.9314) teacher_loss 0.6881 (0.9269) loss_zs_kd 0.0850 (0.1405) loss_oracle 0.0724 (0.0747) acc 78.1250 (74.1875) kd_loss 0.0358 (0.0400) lr 1.3090e-03 eta 0:25:25
epoch [22/50] batch [120/288] time 0.168 (0.181) data 0.000 (0.003) loss 1.1315 (1.0815) ce_loss 0.9766 (0.9396) teacher_loss 0.9887 (0.9353) loss_zs_kd 0.1607 (0.1422) loss_oracle 0.0624 (0.0752) acc 75.0000 (74.2708) kd_loss 0.0386 (0.0402) lr 1.3090e-03 eta 0:24:50
epoch [22/50] batch [140/288] time 0.158 (0.178) data 0.000 (0.002) loss 1.0575 (1.0728) ce_loss 0.9058 (0.9321) teacher_loss 0.9034 (0.9274) loss_zs_kd 0.1472 (0.1397) loss_oracle 0.0805 (0.0756) acc 75.0000 (74.4866) kd_loss 0.0405 (0.0405) lr 1.3090e-03 eta 0:24:20
epoch [22/50] batch [160/288] time 0.171 (0.176) data 0.000 (0.002) loss 0.6877 (1.0830) ce_loss 0.5786 (0.9420) teacher_loss 0.5871 (0.9373) loss_zs_kd 0.0973 (0.1401) loss_oracle 0.0520 (0.0757) acc 84.3750 (74.2969) kd_loss 0.0332 (0.0410) lr 1.3090e-03 eta 0:23:58
epoch [22/50] batch [180/288] time 0.083 (0.176) data 0.000 (0.002) loss 0.9873 (1.0777) ce_loss 0.8716 (0.9372) teacher_loss 0.8751 (0.9321) loss_zs_kd 0.0890 (0.1401) loss_oracle 0.0677 (0.0756) acc 81.2500 (74.5660) kd_loss 0.0308 (0.0413) lr 1.3090e-03 eta 0:23:56
epoch [22/50] batch [200/288] time 0.151 (0.180) data 0.000 (0.002) loss 0.9872 (1.0811) ce_loss 0.8696 (0.9414) teacher_loss 0.8553 (0.9362) loss_zs_kd 0.1367 (0.1397) loss_oracle 0.0636 (0.0751) acc 75.0000 (74.5156) kd_loss 0.0360 (0.0412) lr 1.3090e-03 eta 0:24:24
epoch [22/50] batch [220/288] time 0.169 (0.178) data 0.000 (0.002) loss 0.6864 (1.0809) ce_loss 0.5376 (0.9413) teacher_loss 0.5414 (0.9361) loss_zs_kd 0.1323 (0.1406) loss_oracle 0.0789 (0.0744) acc 87.5000 (74.3324) kd_loss 0.0492 (0.0411) lr 1.3090e-03 eta 0:24:07
epoch [22/50] batch [240/288] time 0.158 (0.177) data 0.000 (0.001) loss 1.1642 (1.0840) ce_loss 1.0146 (0.9450) teacher_loss 1.0127 (0.9403) loss_zs_kd 0.1454 (0.1405) loss_oracle 0.0788 (0.0735) acc 71.8750 (74.2318) kd_loss 0.0364 (0.0405) lr 1.3090e-03 eta 0:23:52
epoch [22/50] batch [260/288] time 0.151 (0.176) data 0.000 (0.001) loss 1.0405 (1.0848) ce_loss 0.8613 (0.9459) teacher_loss 0.8625 (0.9414) loss_zs_kd 0.1446 (0.1398) loss_oracle 0.1057 (0.0735) acc 81.2500 (74.2548) kd_loss 0.0507 (0.0403) lr 1.3090e-03 eta 0:23:42
epoch [22/50] batch [280/288] time 0.167 (0.175) data 0.000 (0.001) loss 0.7029 (1.0871) ce_loss 0.5664 (0.9481) teacher_loss 0.5721 (0.9436) loss_zs_kd 0.1317 (0.1400) loss_oracle 0.0650 (0.0735) acc 84.3750 (74.1071) kd_loss 0.0337 (0.0403) lr 1.3090e-03 eta 0:23:29
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,422
* accuracy: 86.9%
* error: 13.1%
* macro_f1: 86.3%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,013
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 79.9%
******* Domain a best val acc:      87.1%, epoch: 20 *******
******* Domain a best val test acc: 83.4%, epoch: 20 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [23/50] batch [20/288] time 0.165 (0.176) data 0.000 (0.013) loss 1.2267 (1.0432) ce_loss 1.0684 (0.9112) teacher_loss 1.0576 (0.9058) loss_zs_kd 0.1388 (0.1318) loss_oracle 0.0997 (0.0715) acc 68.7500 (74.6875) kd_loss 0.0525 (0.0376) lr 1.2487e-03 eta 0:23:35
epoch [23/50] batch [40/288] time 0.165 (0.169) data 0.000 (0.006) loss 1.0232 (1.0494) ce_loss 0.8735 (0.9115) teacher_loss 0.8650 (0.9073) loss_zs_kd 0.1232 (0.1357) loss_oracle 0.0966 (0.0743) acc 75.0000 (74.8438) kd_loss 0.0539 (0.0386) lr 1.2487e-03 eta 0:22:35
epoch [23/50] batch [60/288] time 0.153 (0.167) data 0.000 (0.004) loss 1.4380 (1.0803) ce_loss 1.2939 (0.9397) teacher_loss 1.2877 (0.9361) loss_zs_kd 0.1875 (0.1405) loss_oracle 0.0566 (0.0738) acc 62.5000 (73.8542) kd_loss 0.0295 (0.0386) lr 1.2487e-03 eta 0:22:13
epoch [23/50] batch [80/288] time 0.149 (0.166) data 0.000 (0.003) loss 1.3565 (1.0700) ce_loss 1.2246 (0.9289) teacher_loss 1.2055 (0.9242) loss_zs_kd 0.1525 (0.1434) loss_oracle 0.0748 (0.0740) acc 65.6250 (74.1797) kd_loss 0.0434 (0.0389) lr 1.2487e-03 eta 0:22:01
epoch [23/50] batch [100/288] time 0.085 (0.163) data 0.000 (0.003) loss 0.8454 (1.0613) ce_loss 0.6934 (0.9194) teacher_loss 0.6991 (0.9143) loss_zs_kd 0.1465 (0.1450) loss_oracle 0.0731 (0.0745) acc 84.3750 (74.6250) kd_loss 0.0409 (0.0398) lr 1.2487e-03 eta 0:21:34
epoch [23/50] batch [120/288] time 0.378 (0.175) data 0.000 (0.002) loss 0.7327 (1.0677) ce_loss 0.5864 (0.9260) teacher_loss 0.5912 (0.9218) loss_zs_kd 0.1449 (0.1452) loss_oracle 0.0690 (0.0733) acc 90.6250 (74.7396) kd_loss 0.0373 (0.0398) lr 1.2487e-03 eta 0:23:14
epoch [23/50] batch [140/288] time 0.160 (0.174) data 0.000 (0.002) loss 1.0053 (1.0645) ce_loss 0.8784 (0.9239) teacher_loss 0.8822 (0.9197) loss_zs_kd 0.1080 (0.1431) loss_oracle 0.0691 (0.0732) acc 78.1250 (74.8438) kd_loss 0.0456 (0.0402) lr 1.2487e-03 eta 0:23:00
epoch [23/50] batch [160/288] time 0.145 (0.172) data 0.000 (0.002) loss 1.0703 (1.0732) ce_loss 0.9292 (0.9336) teacher_loss 0.9301 (0.9294) loss_zs_kd 0.1338 (0.1425) loss_oracle 0.0733 (0.0725) acc 71.8750 (74.4922) kd_loss 0.0428 (0.0403) lr 1.2487e-03 eta 0:22:41
epoch [23/50] batch [180/288] time 0.156 (0.171) data 0.000 (0.002) loss 0.9423 (1.0685) ce_loss 0.8452 (0.9290) teacher_loss 0.8237 (0.9250) loss_zs_kd 0.0900 (0.1419) loss_oracle 0.0736 (0.0725) acc 75.0000 (74.7222) kd_loss 0.0419 (0.0405) lr 1.2487e-03 eta 0:22:27
epoch [23/50] batch [200/288] time 0.151 (0.170) data 0.000 (0.001) loss 0.9667 (1.0702) ce_loss 0.8115 (0.9298) teacher_loss 0.7954 (0.9257) loss_zs_kd 0.1597 (0.1427) loss_oracle 0.0915 (0.0731) acc 75.0000 (74.9062) kd_loss 0.0495 (0.0406) lr 1.2487e-03 eta 0:22:13
epoch [23/50] batch [220/288] time 0.152 (0.169) data 0.000 (0.001) loss 1.2838 (1.0716) ce_loss 1.1611 (0.9312) teacher_loss 1.1520 (0.9272) loss_zs_kd 0.1355 (0.1431) loss_oracle 0.0640 (0.0729) acc 75.0000 (74.8722) kd_loss 0.0346 (0.0405) lr 1.2487e-03 eta 0:22:02
epoch [23/50] batch [240/288] time 0.403 (0.169) data 0.000 (0.001) loss 0.9200 (1.0796) ce_loss 0.7764 (0.9391) teacher_loss 0.7650 (0.9354) loss_zs_kd 0.1509 (0.1423) loss_oracle 0.0795 (0.0731) acc 78.1250 (74.7786) kd_loss 0.0410 (0.0405) lr 1.2487e-03 eta 0:22:04
epoch [23/50] batch [260/288] time 0.163 (0.174) data 0.000 (0.001) loss 0.7829 (1.0881) ce_loss 0.6338 (0.9475) teacher_loss 0.6439 (0.9434) loss_zs_kd 0.1486 (0.1429) loss_oracle 0.0647 (0.0732) acc 84.3750 (74.4952) kd_loss 0.0320 (0.0408) lr 1.2487e-03 eta 0:22:34
epoch [23/50] batch [280/288] time 0.158 (0.173) data 0.000 (0.001) loss 1.0539 (1.0819) ce_loss 0.8823 (0.9414) teacher_loss 0.8790 (0.9374) loss_zs_kd 0.1753 (0.1426) loss_oracle 0.0872 (0.0733) acc 71.8750 (74.6317) kd_loss 0.0487 (0.0408) lr 1.2487e-03 eta 0:22:30
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,430
* accuracy: 87.1%
* error: 12.9%
* macro_f1: 86.4%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,010
* accuracy: 82.8%
* error: 17.2%
* macro_f1: 79.7%
******* Domain a best val acc:      87.1%, epoch: 20 *******
******* Domain a best val test acc: 83.4%, epoch: 20 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [24/50] batch [20/288] time 0.176 (0.181) data 0.000 (0.014) loss 1.1540 (1.0527) ce_loss 1.0352 (0.9237) teacher_loss 1.0338 (0.9154) loss_zs_kd 0.1198 (0.1309) loss_oracle 0.0603 (0.0718) acc 78.1250 (74.0625) kd_loss 0.0315 (0.0418) lr 1.1874e-03 eta 0:23:26
epoch [24/50] batch [40/288] time 0.339 (0.179) data 0.000 (0.007) loss 1.1460 (1.0977) ce_loss 0.9663 (0.9643) teacher_loss 0.9684 (0.9578) loss_zs_kd 0.1757 (0.1342) loss_oracle 0.0897 (0.0728) acc 75.0000 (73.6719) kd_loss 0.0452 (0.0405) lr 1.1874e-03 eta 0:23:05
epoch [24/50] batch [60/288] time 0.160 (0.191) data 0.000 (0.005) loss 1.0241 (1.1084) ce_loss 0.8994 (0.9702) teacher_loss 0.8945 (0.9644) loss_zs_kd 0.1361 (0.1403) loss_oracle 0.0616 (0.0739) acc 84.3750 (74.0625) kd_loss 0.0330 (0.0403) lr 1.1874e-03 eta 0:24:36
epoch [24/50] batch [80/288] time 0.150 (0.182) data 0.000 (0.004) loss 1.0002 (1.0857) ce_loss 0.8320 (0.9457) teacher_loss 0.8266 (0.9409) loss_zs_kd 0.1663 (0.1390) loss_oracle 0.0905 (0.0753) acc 78.1250 (74.3359) kd_loss 0.0451 (0.0405) lr 1.1874e-03 eta 0:23:19
epoch [24/50] batch [100/288] time 0.162 (0.178) data 0.000 (0.003) loss 0.9660 (1.0836) ce_loss 0.7881 (0.9450) teacher_loss 0.7836 (0.9396) loss_zs_kd 0.1820 (0.1375) loss_oracle 0.0913 (0.0752) acc 84.3750 (74.2812) kd_loss 0.0487 (0.0407) lr 1.1874e-03 eta 0:22:42
epoch [24/50] batch [120/288] time 0.168 (0.173) data 0.000 (0.002) loss 1.0905 (1.0745) ce_loss 0.9644 (0.9370) teacher_loss 0.9688 (0.9311) loss_zs_kd 0.1119 (0.1371) loss_oracle 0.0657 (0.0749) acc 68.7500 (74.6875) kd_loss 0.0376 (0.0407) lr 1.1874e-03 eta 0:22:07
epoch [24/50] batch [140/288] time 0.176 (0.172) data 0.000 (0.002) loss 1.1103 (1.0705) ce_loss 0.9761 (0.9322) teacher_loss 0.9816 (0.9268) loss_zs_kd 0.1152 (0.1389) loss_oracle 0.0712 (0.0742) acc 78.1250 (74.8438) kd_loss 0.0426 (0.0408) lr 1.1874e-03 eta 0:21:49
epoch [24/50] batch [160/288] time 0.151 (0.170) data 0.000 (0.002) loss 1.2124 (1.0763) ce_loss 1.0820 (0.9369) teacher_loss 1.0919 (0.9320) loss_zs_kd 0.1257 (0.1415) loss_oracle 0.0576 (0.0736) acc 65.6250 (74.6875) kd_loss 0.0287 (0.0405) lr 1.1874e-03 eta 0:21:38
epoch [24/50] batch [180/288] time 0.344 (0.173) data 0.000 (0.002) loss 0.9522 (1.0870) ce_loss 0.8335 (0.9479) teacher_loss 0.8216 (0.9434) loss_zs_kd 0.1115 (0.1409) loss_oracle 0.0749 (0.0731) acc 75.0000 (74.3229) kd_loss 0.0387 (0.0404) lr 1.1874e-03 eta 0:21:54
epoch [24/50] batch [200/288] time 0.175 (0.176) data 0.000 (0.002) loss 1.0890 (1.0874) ce_loss 0.9316 (0.9484) teacher_loss 0.9369 (0.9443) loss_zs_kd 0.1235 (0.1407) loss_oracle 0.0903 (0.0727) acc 71.8750 (74.1875) kd_loss 0.0508 (0.0403) lr 1.1874e-03 eta 0:22:16
epoch [24/50] batch [220/288] time 0.146 (0.175) data 0.000 (0.001) loss 0.9049 (1.0870) ce_loss 0.7690 (0.9480) teacher_loss 0.7713 (0.9440) loss_zs_kd 0.1542 (0.1407) loss_oracle 0.0565 (0.0726) acc 78.1250 (74.2330) kd_loss 0.0311 (0.0402) lr 1.1874e-03 eta 0:22:06
epoch [24/50] batch [240/288] time 0.164 (0.174) data 0.000 (0.001) loss 0.9192 (1.0875) ce_loss 0.7759 (0.9484) teacher_loss 0.7792 (0.9443) loss_zs_kd 0.1357 (0.1405) loss_oracle 0.0722 (0.0729) acc 84.3750 (74.2057) kd_loss 0.0457 (0.0403) lr 1.1874e-03 eta 0:21:51
epoch [24/50] batch [260/288] time 0.165 (0.173) data 0.000 (0.001) loss 0.6590 (1.0900) ce_loss 0.5317 (0.9510) teacher_loss 0.5235 (0.9470) loss_zs_kd 0.1492 (0.1402) loss_oracle 0.0609 (0.0729) acc 87.5000 (74.1226) kd_loss 0.0377 (0.0403) lr 1.1874e-03 eta 0:21:41
epoch [24/50] batch [280/288] time 0.180 (0.173) data 0.000 (0.001) loss 1.0132 (1.0931) ce_loss 0.8843 (0.9541) teacher_loss 0.8804 (0.9501) loss_zs_kd 0.1295 (0.1402) loss_oracle 0.0680 (0.0728) acc 75.0000 (74.0960) kd_loss 0.0386 (0.0402) lr 1.1874e-03 eta 0:21:35
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,433
* accuracy: 87.2%
* error: 12.8%
* macro_f1: 86.6%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,021
* accuracy: 83.3%
* error: 16.7%
* macro_f1: 80.1%
******* Domain a best val acc:      87.2%, epoch: 24 *******
******* Domain a best val test acc: 83.3%, epoch: 24 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [25/50] batch [20/288] time 0.159 (0.188) data 0.001 (0.017) loss 1.3926 (1.1050) ce_loss 1.2568 (0.9604) teacher_loss 1.2439 (0.9535) loss_zs_kd 0.1388 (0.1389) loss_oracle 0.0793 (0.0820) acc 65.6250 (74.0625) kd_loss 0.0493 (0.0465) lr 1.1253e-03 eta 0:23:23
epoch [25/50] batch [40/288] time 0.165 (0.181) data 0.000 (0.009) loss 0.7854 (1.1029) ce_loss 0.6665 (0.9591) teacher_loss 0.6590 (0.9528) loss_zs_kd 0.1137 (0.1368) loss_oracle 0.0696 (0.0817) acc 84.3750 (74.6875) kd_loss 0.0363 (0.0444) lr 1.1253e-03 eta 0:22:26
epoch [25/50] batch [60/288] time 0.175 (0.178) data 0.000 (0.006) loss 1.4842 (1.1224) ce_loss 1.3633 (0.9803) teacher_loss 1.3581 (0.9741) loss_zs_kd 0.1317 (0.1349) loss_oracle 0.0602 (0.0809) acc 59.3750 (73.7500) kd_loss 0.0304 (0.0444) lr 1.1253e-03 eta 0:22:03
epoch [25/50] batch [80/288] time 0.171 (0.176) data 0.000 (0.005) loss 1.1693 (1.1199) ce_loss 0.9858 (0.9785) teacher_loss 0.9933 (0.9731) loss_zs_kd 0.2059 (0.1356) loss_oracle 0.0730 (0.0790) acc 78.1250 (73.9844) kd_loss 0.0461 (0.0427) lr 1.1253e-03 eta 0:21:46
epoch [25/50] batch [100/288] time 0.130 (0.173) data 0.000 (0.004) loss 0.9934 (1.1182) ce_loss 0.8247 (0.9742) teacher_loss 0.8298 (0.9694) loss_zs_kd 0.1697 (0.1413) loss_oracle 0.0787 (0.0782) acc 71.8750 (74.1250) kd_loss 0.0447 (0.0425) lr 1.1253e-03 eta 0:21:18
epoch [25/50] batch [120/288] time 0.153 (0.190) data 0.000 (0.003) loss 1.2658 (1.1064) ce_loss 1.1367 (0.9642) teacher_loss 1.1431 (0.9591) loss_zs_kd 0.1188 (0.1399) loss_oracle 0.0632 (0.0774) acc 62.5000 (74.2969) kd_loss 0.0321 (0.0421) lr 1.1253e-03 eta 0:23:21
epoch [25/50] batch [140/288] time 0.150 (0.186) data 0.000 (0.003) loss 0.5235 (1.1046) ce_loss 0.4258 (0.9632) teacher_loss 0.4311 (0.9583) loss_zs_kd 0.1032 (0.1399) loss_oracle 0.0408 (0.0764) acc 87.5000 (74.3973) kd_loss 0.0230 (0.0417) lr 1.1253e-03 eta 0:22:43
epoch [25/50] batch [160/288] time 0.175 (0.182) data 0.000 (0.002) loss 0.9804 (1.0919) ce_loss 0.8413 (0.9511) teacher_loss 0.8407 (0.9466) loss_zs_kd 0.1266 (0.1397) loss_oracle 0.0765 (0.0754) acc 78.1250 (74.6680) kd_loss 0.0431 (0.0412) lr 1.1253e-03 eta 0:22:15
epoch [25/50] batch [180/288] time 0.155 (0.180) data 0.000 (0.002) loss 1.1633 (1.0966) ce_loss 1.0273 (0.9559) teacher_loss 1.0186 (0.9511) loss_zs_kd 0.1458 (0.1400) loss_oracle 0.0719 (0.0755) acc 71.8750 (74.6007) kd_loss 0.0422 (0.0412) lr 1.1253e-03 eta 0:21:53
epoch [25/50] batch [200/288] time 0.157 (0.179) data 0.000 (0.002) loss 0.7984 (1.0931) ce_loss 0.6270 (0.9514) teacher_loss 0.5960 (0.9463) loss_zs_kd 0.1882 (0.1407) loss_oracle 0.1083 (0.0765) acc 84.3750 (74.6875) kd_loss 0.0628 (0.0416) lr 1.1253e-03 eta 0:21:43
epoch [25/50] batch [220/288] time 0.102 (0.178) data 0.000 (0.002) loss 0.9983 (1.0879) ce_loss 0.8110 (0.9452) teacher_loss 0.8160 (0.9396) loss_zs_kd 0.1929 (0.1414) loss_oracle 0.0858 (0.0776) acc 81.2500 (74.7443) kd_loss 0.0443 (0.0422) lr 1.1253e-03 eta 0:21:33
epoch [25/50] batch [240/288] time 0.407 (0.184) data 0.000 (0.002) loss 1.6172 (1.0897) ce_loss 1.4502 (0.9463) teacher_loss 1.4441 (0.9409) loss_zs_kd 0.1417 (0.1419) loss_oracle 0.1023 (0.0778) acc 62.5000 (74.6875) kd_loss 0.0579 (0.0423) lr 1.1253e-03 eta 0:22:11
epoch [25/50] batch [260/288] time 0.148 (0.182) data 0.000 (0.002) loss 0.9606 (1.0883) ce_loss 0.8350 (0.9446) teacher_loss 0.8263 (0.9390) loss_zs_kd 0.1155 (0.1423) loss_oracle 0.0766 (0.0781) acc 78.1250 (74.7716) kd_loss 0.0418 (0.0425) lr 1.1253e-03 eta 0:21:58
epoch [25/50] batch [280/288] time 0.170 (0.181) data 0.000 (0.001) loss 1.1401 (1.0868) ce_loss 1.0039 (0.9427) teacher_loss 0.9893 (0.9372) loss_zs_kd 0.1055 (0.1421) loss_oracle 0.0981 (0.0786) acc 75.0000 (74.9330) kd_loss 0.0478 (0.0427) lr 1.1253e-03 eta 0:21:44
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,418
* accuracy: 86.8%
* error: 13.2%
* macro_f1: 86.2%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,017
* accuracy: 83.1%
* error: 16.9%
* macro_f1: 79.8%
******* Domain a best val acc:      87.2%, epoch: 24 *******
******* Domain a best val test acc: 83.3%, epoch: 24 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [26/50] batch [20/288] time 0.402 (0.187) data 0.001 (0.016) loss 0.8062 (0.9567) ce_loss 0.6973 (0.8027) teacher_loss 0.6926 (0.8011) loss_zs_kd 0.0840 (0.1416) loss_oracle 0.0716 (0.0848) acc 75.0000 (78.5938) kd_loss 0.0370 (0.0421) lr 1.0628e-03 eta 0:22:22
epoch [26/50] batch [40/288] time 0.083 (0.222) data 0.000 (0.008) loss 1.1297 (1.0266) ce_loss 1.0234 (0.8750) teacher_loss 1.0308 (0.8727) loss_zs_kd 0.0827 (0.1402) loss_oracle 0.0576 (0.0838) acc 75.0000 (75.6250) kd_loss 0.0290 (0.0425) lr 1.0628e-03 eta 0:26:28
epoch [26/50] batch [60/288] time 0.161 (0.198) data 0.000 (0.006) loss 1.1149 (1.0406) ce_loss 0.9746 (0.8893) teacher_loss 0.9753 (0.8851) loss_zs_kd 0.1269 (0.1419) loss_oracle 0.0762 (0.0846) acc 68.7500 (75.7292) kd_loss 0.0427 (0.0427) lr 1.0628e-03 eta 0:23:36
epoch [26/50] batch [80/288] time 0.164 (0.188) data 0.000 (0.004) loss 1.5308 (1.0498) ce_loss 1.3896 (0.8994) teacher_loss 1.3760 (0.8956) loss_zs_kd 0.1358 (0.1424) loss_oracle 0.0869 (0.0830) acc 71.8750 (75.5859) kd_loss 0.0518 (0.0435) lr 1.0628e-03 eta 0:22:18
epoch [26/50] batch [100/288] time 0.167 (0.182) data 0.000 (0.003) loss 0.8867 (1.0623) ce_loss 0.7739 (0.9132) teacher_loss 0.7665 (0.9100) loss_zs_kd 0.1025 (0.1411) loss_oracle 0.0689 (0.0818) acc 78.1250 (75.0312) kd_loss 0.0459 (0.0435) lr 1.0628e-03 eta 0:21:33
epoch [26/50] batch [120/288] time 0.155 (0.179) data 0.000 (0.003) loss 1.0055 (1.0657) ce_loss 0.8428 (0.9181) teacher_loss 0.8108 (0.9144) loss_zs_kd 0.2151 (0.1403) loss_oracle 0.0872 (0.0812) acc 75.0000 (74.9479) kd_loss 0.0522 (0.0437) lr 1.0628e-03 eta 0:21:07
epoch [26/50] batch [140/288] time 0.153 (0.176) data 0.000 (0.002) loss 1.1260 (1.0612) ce_loss 0.9917 (0.9141) teacher_loss 0.9931 (0.9106) loss_zs_kd 0.1279 (0.1400) loss_oracle 0.0690 (0.0806) acc 78.1250 (75.2679) kd_loss 0.0409 (0.0439) lr 1.0628e-03 eta 0:20:41
epoch [26/50] batch [160/288] time 0.246 (0.178) data 0.000 (0.002) loss 1.2740 (1.0615) ce_loss 1.1123 (0.9142) teacher_loss 1.1169 (0.9103) loss_zs_kd 0.1852 (0.1411) loss_oracle 0.0646 (0.0807) acc 71.8750 (75.2344) kd_loss 0.0305 (0.0441) lr 1.0628e-03 eta 0:20:54
epoch [26/50] batch [180/288] time 0.095 (0.180) data 0.000 (0.002) loss 0.8813 (1.0621) ce_loss 0.7563 (0.9146) teacher_loss 0.7574 (0.9108) loss_zs_kd 0.0989 (0.1408) loss_oracle 0.0745 (0.0809) acc 78.1250 (75.0521) kd_loss 0.0393 (0.0441) lr 1.0628e-03 eta 0:21:05
epoch [26/50] batch [200/288] time 0.168 (0.178) data 0.000 (0.002) loss 1.0438 (1.0666) ce_loss 0.8862 (0.9182) teacher_loss 0.9006 (0.9149) loss_zs_kd 0.1425 (0.1411) loss_oracle 0.0720 (0.0812) acc 84.3750 (75.0000) kd_loss 0.0388 (0.0442) lr 1.0628e-03 eta 0:20:43
epoch [26/50] batch [220/288] time 0.156 (0.176) data 0.000 (0.002) loss 0.4564 (1.0688) ce_loss 0.3228 (0.9199) teacher_loss 0.3181 (0.9164) loss_zs_kd 0.1079 (0.1415) loss_oracle 0.0844 (0.0816) acc 93.7500 (74.8580) kd_loss 0.0472 (0.0445) lr 1.0628e-03 eta 0:20:27
epoch [26/50] batch [240/288] time 0.168 (0.174) data 0.000 (0.002) loss 1.1105 (1.0753) ce_loss 0.9375 (0.9255) teacher_loss 0.9318 (0.9222) loss_zs_kd 0.1677 (0.1422) loss_oracle 0.0949 (0.0820) acc 71.8750 (74.7005) kd_loss 0.0416 (0.0448) lr 1.0628e-03 eta 0:20:13
epoch [26/50] batch [260/288] time 0.147 (0.173) data 0.000 (0.001) loss 1.0796 (1.0848) ce_loss 0.9199 (0.9339) teacher_loss 0.9221 (0.9305) loss_zs_kd 0.1683 (0.1439) loss_oracle 0.0734 (0.0823) acc 71.8750 (74.4351) kd_loss 0.0376 (0.0450) lr 1.0628e-03 eta 0:20:00
epoch [26/50] batch [280/288] time 0.145 (0.172) data 0.000 (0.001) loss 1.2263 (1.0880) ce_loss 1.0420 (0.9369) teacher_loss 1.0518 (0.9335) loss_zs_kd 0.1752 (0.1448) loss_oracle 0.0868 (0.0821) acc 65.6250 (74.4308) kd_loss 0.0579 (0.0450) lr 1.0628e-03 eta 0:19:48
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,432
* accuracy: 87.1%
* error: 12.9%
* macro_f1: 86.5%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,016
* accuracy: 83.1%
* error: 16.9%
* macro_f1: 79.8%
******* Domain a best val acc:      87.2%, epoch: 24 *******
******* Domain a best val test acc: 83.3%, epoch: 24 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [27/50] batch [20/288] time 0.163 (0.181) data 0.000 (0.013) loss 0.8298 (1.0523) ce_loss 0.6533 (0.8975) teacher_loss 0.6428 (0.8881) loss_zs_kd 0.1759 (0.1580) loss_oracle 0.0990 (0.0853) acc 78.1250 (76.7188) kd_loss 0.0517 (0.0500) lr 1.0000e-03 eta 0:20:46
epoch [27/50] batch [40/288] time 0.184 (0.176) data 0.000 (0.007) loss 0.5468 (1.0934) ce_loss 0.4429 (0.9444) teacher_loss 0.4339 (0.9379) loss_zs_kd 0.0918 (0.1476) loss_oracle 0.0670 (0.0817) acc 93.7500 (75.7812) kd_loss 0.0357 (0.0463) lr 1.0000e-03 eta 0:20:09
epoch [27/50] batch [60/288] time 0.151 (0.174) data 0.001 (0.004) loss 1.5366 (1.0748) ce_loss 1.3389 (0.9276) teacher_loss 1.3284 (0.9211) loss_zs_kd 0.2209 (0.1488) loss_oracle 0.0978 (0.0794) acc 62.5000 (75.6771) kd_loss 0.0595 (0.0447) lr 1.0000e-03 eta 0:19:53
epoch [27/50] batch [80/288] time 0.172 (0.171) data 0.000 (0.003) loss 0.9019 (1.0645) ce_loss 0.7754 (0.9208) teacher_loss 0.7638 (0.9146) loss_zs_kd 0.1488 (0.1444) loss_oracle 0.0636 (0.0776) acc 81.2500 (75.5078) kd_loss 0.0376 (0.0439) lr 1.0000e-03 eta 0:19:31
epoch [27/50] batch [100/288] time 0.107 (0.175) data 0.000 (0.003) loss 0.9610 (1.0741) ce_loss 0.7710 (0.9306) teacher_loss 0.7703 (0.9241) loss_zs_kd 0.1992 (0.1446) loss_oracle 0.0912 (0.0777) acc 84.3750 (75.1250) kd_loss 0.0443 (0.0438) lr 1.0000e-03 eta 0:19:52
epoch [27/50] batch [120/288] time 0.176 (0.184) data 0.000 (0.002) loss 0.8509 (1.0533) ce_loss 0.7324 (0.9114) teacher_loss 0.7056 (0.9045) loss_zs_kd 0.1431 (0.1426) loss_oracle 0.0738 (0.0775) acc 84.3750 (75.8594) kd_loss 0.0463 (0.0436) lr 1.0000e-03 eta 0:20:49
epoch [27/50] batch [140/288] time 0.171 (0.181) data 0.000 (0.002) loss 1.0773 (1.0646) ce_loss 0.9150 (0.9222) teacher_loss 0.8941 (0.9143) loss_zs_kd 0.2229 (0.1448) loss_oracle 0.0718 (0.0779) acc 71.8750 (75.6473) kd_loss 0.0457 (0.0439) lr 1.0000e-03 eta 0:20:27
epoch [27/50] batch [160/288] time 0.160 (0.179) data 0.000 (0.002) loss 1.0909 (1.0635) ce_loss 0.9478 (0.9202) teacher_loss 0.9523 (0.9121) loss_zs_kd 0.1556 (0.1457) loss_oracle 0.0608 (0.0785) acc 68.7500 (75.6250) kd_loss 0.0331 (0.0444) lr 1.0000e-03 eta 0:20:07
epoch [27/50] batch [180/288] time 0.153 (0.177) data 0.000 (0.002) loss 0.8916 (1.0690) ce_loss 0.7451 (0.9244) teacher_loss 0.7406 (0.9171) loss_zs_kd 0.1361 (0.1455) loss_oracle 0.0830 (0.0791) acc 75.0000 (75.5556) kd_loss 0.0421 (0.0444) lr 1.0000e-03 eta 0:19:51
epoch [27/50] batch [200/288] time 0.146 (0.175) data 0.000 (0.001) loss 1.0900 (1.0611) ce_loss 0.9658 (0.9175) teacher_loss 0.9617 (0.9100) loss_zs_kd 0.1044 (0.1445) loss_oracle 0.0761 (0.0788) acc 75.0000 (75.5938) kd_loss 0.0472 (0.0447) lr 1.0000e-03 eta 0:19:36
epoch [27/50] batch [220/288] time 0.174 (0.178) data 0.000 (0.001) loss 1.1343 (1.0600) ce_loss 0.8999 (0.9168) teacher_loss 0.8877 (0.9096) loss_zs_kd 0.2702 (0.1438) loss_oracle 0.1115 (0.0786) acc 81.2500 (75.6534) kd_loss 0.0642 (0.0447) lr 1.0000e-03 eta 0:19:47
epoch [27/50] batch [240/288] time 0.156 (0.180) data 0.000 (0.001) loss 0.7455 (1.0721) ce_loss 0.6289 (0.9291) teacher_loss 0.6188 (0.9222) loss_zs_kd 0.0905 (0.1439) loss_oracle 0.0814 (0.0779) acc 81.2500 (75.1562) kd_loss 0.0371 (0.0444) lr 1.0000e-03 eta 0:19:59
epoch [27/50] batch [260/288] time 0.156 (0.178) data 0.000 (0.001) loss 0.8286 (1.0740) ce_loss 0.6963 (0.9306) teacher_loss 0.6939 (0.9244) loss_zs_kd 0.1143 (0.1439) loss_oracle 0.0776 (0.0777) acc 81.2500 (75.1442) kd_loss 0.0507 (0.0444) lr 1.0000e-03 eta 0:19:46
epoch [27/50] batch [280/288] time 0.166 (0.177) data 0.000 (0.001) loss 1.4544 (1.0783) ce_loss 1.2646 (0.9349) teacher_loss 1.2547 (0.9286) loss_zs_kd 0.2202 (0.1441) loss_oracle 0.0896 (0.0776) acc 50.0000 (74.9219) kd_loss 0.0461 (0.0443) lr 1.0000e-03 eta 0:19:34
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,425
* accuracy: 87.0%
* error: 13.0%
* macro_f1: 86.3%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,011
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 79.8%
******* Domain a best val acc:      87.2%, epoch: 24 *******
******* Domain a best val test acc: 83.3%, epoch: 24 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [28/50] batch [20/288] time 0.092 (0.210) data 0.000 (0.015) loss 0.9063 (1.0493) ce_loss 0.7856 (0.8997) teacher_loss 0.7648 (0.8934) loss_zs_kd 0.1074 (0.1585) loss_oracle 0.0878 (0.0767) acc 78.1250 (75.3125) kd_loss 0.0475 (0.0407) lr 9.3721e-04 eta 0:23:04
epoch [28/50] batch [40/288] time 0.172 (0.214) data 0.000 (0.008) loss 0.7695 (1.0854) ce_loss 0.6084 (0.9416) teacher_loss 0.6119 (0.9358) loss_zs_kd 0.1158 (0.1410) loss_oracle 0.0997 (0.0791) acc 84.3750 (74.3750) kd_loss 0.0449 (0.0420) lr 9.3721e-04 eta 0:23:30
epoch [28/50] batch [60/288] time 0.159 (0.196) data 0.000 (0.005) loss 0.8846 (1.0958) ce_loss 0.7222 (0.9519) teacher_loss 0.7265 (0.9474) loss_zs_kd 0.1669 (0.1412) loss_oracle 0.0746 (0.0779) acc 78.1250 (74.0625) kd_loss 0.0352 (0.0409) lr 9.3721e-04 eta 0:21:29
epoch [28/50] batch [80/288] time 0.172 (0.188) data 0.000 (0.004) loss 0.9050 (1.1072) ce_loss 0.7822 (0.9615) teacher_loss 0.7788 (0.9580) loss_zs_kd 0.1342 (0.1432) loss_oracle 0.0591 (0.0776) acc 68.7500 (73.7891) kd_loss 0.0307 (0.0405) lr 9.3721e-04 eta 0:20:29
epoch [28/50] batch [100/288] time 0.154 (0.182) data 0.000 (0.003) loss 0.9333 (1.0944) ce_loss 0.7920 (0.9479) teacher_loss 0.7982 (0.9454) loss_zs_kd 0.0878 (0.1426) loss_oracle 0.0912 (0.0777) acc 81.2500 (74.1875) kd_loss 0.0471 (0.0406) lr 9.3721e-04 eta 0:19:47
epoch [28/50] batch [120/288] time 0.169 (0.179) data 0.000 (0.003) loss 0.9841 (1.0817) ce_loss 0.8423 (0.9363) teacher_loss 0.8423 (0.9326) loss_zs_kd 0.1066 (0.1399) loss_oracle 0.0885 (0.0791) acc 81.2500 (74.2708) kd_loss 0.0455 (0.0414) lr 9.3721e-04 eta 0:19:23
epoch [28/50] batch [140/288] time 0.354 (0.180) data 0.000 (0.002) loss 0.5628 (1.0766) ce_loss 0.4661 (0.9309) teacher_loss 0.4736 (0.9274) loss_zs_kd 0.0940 (0.1406) loss_oracle 0.0422 (0.0788) acc 90.6250 (74.5536) kd_loss 0.0212 (0.0408) lr 9.3721e-04 eta 0:19:29
epoch [28/50] batch [160/288] time 0.088 (0.185) data 0.000 (0.002) loss 1.3928 (1.0662) ce_loss 1.2344 (0.9207) teacher_loss 1.2342 (0.9170) loss_zs_kd 0.1571 (0.1405) loss_oracle 0.0800 (0.0790) acc 62.5000 (74.8633) kd_loss 0.0348 (0.0408) lr 9.3721e-04 eta 0:19:53
epoch [28/50] batch [180/288] time 0.159 (0.181) data 0.000 (0.002) loss 0.9358 (1.0616) ce_loss 0.7417 (0.9147) teacher_loss 0.7547 (0.9108) loss_zs_kd 0.2064 (0.1419) loss_oracle 0.0780 (0.0799) acc 75.0000 (75.0521) kd_loss 0.0379 (0.0409) lr 9.3721e-04 eta 0:19:27
epoch [28/50] batch [200/288] time 0.144 (0.178) data 0.000 (0.002) loss 1.4775 (1.0707) ce_loss 1.3096 (0.9232) teacher_loss 1.3112 (0.9191) loss_zs_kd 0.1813 (0.1432) loss_oracle 0.0756 (0.0800) acc 71.8750 (75.0156) kd_loss 0.0424 (0.0409) lr 9.3721e-04 eta 0:19:04
epoch [28/50] batch [220/288] time 0.156 (0.176) data 0.000 (0.002) loss 1.0647 (1.0703) ce_loss 0.9419 (0.9223) teacher_loss 0.9385 (0.9181) loss_zs_kd 0.1160 (0.1437) loss_oracle 0.0681 (0.0803) acc 81.2500 (75.1420) kd_loss 0.0342 (0.0413) lr 9.3721e-04 eta 0:18:46
epoch [28/50] batch [240/288] time 0.161 (0.174) data 0.000 (0.001) loss 0.5333 (1.0706) ce_loss 0.3894 (0.9224) teacher_loss 0.3905 (0.9182) loss_zs_kd 0.1236 (0.1440) loss_oracle 0.0811 (0.0804) acc 96.8750 (75.1302) kd_loss 0.0436 (0.0415) lr 9.3721e-04 eta 0:18:29
epoch [28/50] batch [260/288] time 0.152 (0.173) data 0.000 (0.001) loss 0.8153 (1.0742) ce_loss 0.6904 (0.9262) teacher_loss 0.6933 (0.9219) loss_zs_kd 0.1300 (0.1440) loss_oracle 0.0570 (0.0803) acc 81.2500 (75.2163) kd_loss 0.0338 (0.0419) lr 9.3721e-04 eta 0:18:20
epoch [28/50] batch [280/288] time 0.089 (0.171) data 0.000 (0.001) loss 0.9160 (1.0732) ce_loss 0.7739 (0.9249) teacher_loss 0.7783 (0.9204) loss_zs_kd 0.1413 (0.1449) loss_oracle 0.0670 (0.0803) acc 78.1250 (75.2567) kd_loss 0.0382 (0.0423) lr 9.3721e-04 eta 0:18:02
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,429
* accuracy: 87.1%
* error: 12.9%
* macro_f1: 86.4%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,008
* accuracy: 82.7%
* error: 17.3%
* macro_f1: 79.5%
******* Domain a best val acc:      87.2%, epoch: 24 *******
******* Domain a best val test acc: 83.3%, epoch: 24 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [29/50] batch [20/288] time 0.171 (0.176) data 0.000 (0.016) loss 0.8151 (0.9631) ce_loss 0.6519 (0.8191) teacher_loss 0.6494 (0.8143) loss_zs_kd 0.1899 (0.1483) loss_oracle 0.0707 (0.0746) acc 78.1250 (77.6562) kd_loss 0.0469 (0.0445) lr 8.7467e-04 eta 0:18:30
epoch [29/50] batch [40/288] time 0.163 (0.172) data 0.000 (0.008) loss 0.9292 (1.0649) ce_loss 0.8062 (0.9212) teacher_loss 0.8102 (0.9163) loss_zs_kd 0.1175 (0.1428) loss_oracle 0.0603 (0.0773) acc 78.1250 (75.2344) kd_loss 0.0373 (0.0444) lr 8.7467e-04 eta 0:18:03
epoch [29/50] batch [60/288] time 0.176 (0.171) data 0.000 (0.006) loss 1.7907 (1.1020) ce_loss 1.6436 (0.9588) teacher_loss 1.6333 (0.9522) loss_zs_kd 0.1514 (0.1381) loss_oracle 0.0817 (0.0807) acc 62.5000 (74.4271) kd_loss 0.0476 (0.0457) lr 8.7467e-04 eta 0:17:52
epoch [29/50] batch [80/288] time 0.093 (0.165) data 0.000 (0.004) loss 0.8362 (1.1015) ce_loss 0.6636 (0.9551) teacher_loss 0.6568 (0.9490) loss_zs_kd 0.1906 (0.1440) loss_oracle 0.0841 (0.0805) acc 87.5000 (73.9062) kd_loss 0.0489 (0.0455) lr 8.7467e-04 eta 0:17:12
epoch [29/50] batch [100/288] time 0.084 (0.185) data 0.000 (0.003) loss 1.4081 (1.1175) ce_loss 1.2900 (0.9689) teacher_loss 1.2709 (0.9630) loss_zs_kd 0.1544 (0.1469) loss_oracle 0.0600 (0.0810) acc 71.8750 (73.7812) kd_loss 0.0427 (0.0456) lr 8.7467e-04 eta 0:19:14
epoch [29/50] batch [120/288] time 0.166 (0.180) data 0.000 (0.003) loss 0.9646 (1.1019) ce_loss 0.8398 (0.9533) teacher_loss 0.8360 (0.9472) loss_zs_kd 0.1088 (0.1462) loss_oracle 0.0742 (0.0817) acc 75.0000 (74.2969) kd_loss 0.0471 (0.0460) lr 8.7467e-04 eta 0:18:38
epoch [29/50] batch [140/288] time 0.166 (0.177) data 0.000 (0.002) loss 1.1692 (1.0926) ce_loss 1.0283 (0.9440) teacher_loss 1.0312 (0.9383) loss_zs_kd 0.0937 (0.1450) loss_oracle 0.0912 (0.0818) acc 65.6250 (74.4866) kd_loss 0.0524 (0.0459) lr 8.7467e-04 eta 0:18:19
epoch [29/50] batch [160/288] time 0.152 (0.176) data 0.000 (0.002) loss 0.9104 (1.0922) ce_loss 0.7339 (0.9418) teacher_loss 0.7210 (0.9361) loss_zs_kd 0.1714 (0.1464) loss_oracle 0.1037 (0.0828) acc 78.1250 (74.7656) kd_loss 0.0582 (0.0463) lr 8.7467e-04 eta 0:18:04
epoch [29/50] batch [180/288] time 0.152 (0.174) data 0.000 (0.002) loss 1.3397 (1.1004) ce_loss 1.1660 (0.9492) teacher_loss 1.1637 (0.9435) loss_zs_kd 0.1671 (0.1473) loss_oracle 0.0925 (0.0832) acc 62.5000 (74.6701) kd_loss 0.0488 (0.0465) lr 8.7467e-04 eta 0:17:52
epoch [29/50] batch [200/288] time 0.136 (0.174) data 0.000 (0.002) loss 1.3089 (1.0957) ce_loss 1.1191 (0.9441) teacher_loss 1.1092 (0.9385) loss_zs_kd 0.1427 (0.1473) loss_oracle 0.1283 (0.0835) acc 68.7500 (74.7656) kd_loss 0.0681 (0.0465) lr 8.7467e-04 eta 0:17:44
epoch [29/50] batch [220/288] time 0.391 (0.178) data 0.000 (0.002) loss 1.0980 (1.0988) ce_loss 0.9536 (0.9475) teacher_loss 0.9443 (0.9421) loss_zs_kd 0.1687 (0.1462) loss_oracle 0.0694 (0.0836) acc 71.8750 (74.6591) kd_loss 0.0445 (0.0463) lr 8.7467e-04 eta 0:18:08
epoch [29/50] batch [240/288] time 0.155 (0.178) data 0.000 (0.002) loss 0.9837 (1.0992) ce_loss 0.8545 (0.9483) teacher_loss 0.8516 (0.9431) loss_zs_kd 0.1250 (0.1458) loss_oracle 0.0696 (0.0832) acc 78.1250 (74.5443) kd_loss 0.0326 (0.0458) lr 8.7467e-04 eta 0:18:06
epoch [29/50] batch [260/288] time 0.172 (0.177) data 0.000 (0.001) loss 0.9503 (1.0996) ce_loss 0.7754 (0.9484) teacher_loss 0.7738 (0.9433) loss_zs_kd 0.1840 (0.1466) loss_oracle 0.0846 (0.0831) acc 75.0000 (74.6274) kd_loss 0.0421 (0.0455) lr 8.7467e-04 eta 0:17:57
epoch [29/50] batch [280/288] time 0.155 (0.176) data 0.000 (0.001) loss 1.6030 (1.1003) ce_loss 1.4453 (0.9489) teacher_loss 1.4446 (0.9439) loss_zs_kd 0.1431 (0.1472) loss_oracle 0.0869 (0.0828) acc 59.3750 (74.5871) kd_loss 0.0420 (0.0452) lr 8.7467e-04 eta 0:17:46
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,434
* accuracy: 87.2%
* error: 12.8%
* macro_f1: 86.6%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,014
* accuracy: 83.0%
* error: 17.0%
* macro_f1: 79.7%
******* Domain a best val acc:      87.2%, epoch: 29 *******
******* Domain a best val test acc: 83.0%, epoch: 29 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [30/50] batch [20/288] time 0.106 (0.223) data 0.000 (0.013) loss 0.8508 (1.0536) ce_loss 0.6968 (0.9068) teacher_loss 0.6929 (0.9022) loss_zs_kd 0.1445 (0.1450) loss_oracle 0.0856 (0.0789) acc 75.0000 (73.5938) kd_loss 0.0466 (0.0433) lr 8.1262e-04 eta 0:22:22
epoch [30/50] batch [40/288] time 0.101 (0.170) data 0.000 (0.007) loss 1.0085 (0.9954) ce_loss 0.8779 (0.8512) teacher_loss 0.8714 (0.8475) loss_zs_kd 0.1242 (0.1422) loss_oracle 0.0750 (0.0768) acc 68.7500 (75.4688) kd_loss 0.0414 (0.0430) lr 8.1262e-04 eta 0:17:03
epoch [30/50] batch [60/288] time 0.128 (0.149) data 0.001 (0.005) loss 1.2805 (1.0353) ce_loss 1.0889 (0.8868) teacher_loss 1.0840 (0.8833) loss_zs_kd 0.2097 (0.1452) loss_oracle 0.0916 (0.0794) acc 68.7500 (75.3125) kd_loss 0.0527 (0.0441) lr 8.1262e-04 eta 0:14:54
epoch [30/50] batch [80/288] time 0.123 (0.143) data 0.000 (0.004) loss 0.9736 (1.0527) ce_loss 0.8384 (0.9048) teacher_loss 0.8172 (0.9007) loss_zs_kd 0.1362 (0.1447) loss_oracle 0.0882 (0.0797) acc 75.0000 (75.1562) kd_loss 0.0503 (0.0443) lr 8.1262e-04 eta 0:14:16
epoch [30/50] batch [100/288] time 0.135 (0.137) data 0.000 (0.003) loss 0.6894 (1.0686) ce_loss 0.5698 (0.9219) teacher_loss 0.5717 (0.9168) loss_zs_kd 0.1158 (0.1438) loss_oracle 0.0598 (0.0800) acc 87.5000 (74.7812) kd_loss 0.0484 (0.0448) lr 8.1262e-04 eta 0:13:36
epoch [30/50] batch [120/288] time 0.168 (0.143) data 0.000 (0.002) loss 1.1754 (1.0784) ce_loss 1.0430 (0.9319) teacher_loss 1.0450 (0.9274) loss_zs_kd 0.1067 (0.1438) loss_oracle 0.0771 (0.0790) acc 71.8750 (74.5833) kd_loss 0.0393 (0.0446) lr 8.1262e-04 eta 0:14:10
epoch [30/50] batch [140/288] time 0.173 (0.147) data 0.000 (0.002) loss 1.3496 (1.0946) ce_loss 1.2559 (0.9479) teacher_loss 1.2294 (0.9434) loss_zs_kd 0.0925 (0.1450) loss_oracle 0.0740 (0.0786) acc 56.2500 (74.3527) kd_loss 0.0425 (0.0444) lr 8.1262e-04 eta 0:14:29
epoch [30/50] batch [160/288] time 0.163 (0.149) data 0.000 (0.002) loss 0.8538 (1.0905) ce_loss 0.7183 (0.9444) teacher_loss 0.6917 (0.9396) loss_zs_kd 0.1398 (0.1454) loss_oracle 0.0922 (0.0781) acc 78.1250 (74.5703) kd_loss 0.0569 (0.0440) lr 8.1262e-04 eta 0:14:35
epoch [30/50] batch [180/288] time 0.164 (0.150) data 0.000 (0.002) loss 1.2271 (1.1006) ce_loss 1.0869 (0.9551) teacher_loss 1.0869 (0.9502) loss_zs_kd 0.1403 (0.1453) loss_oracle 0.0700 (0.0778) acc 75.0000 (74.2014) kd_loss 0.0366 (0.0440) lr 8.1262e-04 eta 0:14:37
epoch [30/50] batch [200/288] time 0.185 (0.151) data 0.000 (0.002) loss 1.3225 (1.0964) ce_loss 1.2129 (0.9515) teacher_loss 1.1759 (0.9464) loss_zs_kd 0.1525 (0.1452) loss_oracle 0.0704 (0.0774) acc 65.6250 (74.2812) kd_loss 0.0421 (0.0438) lr 8.1262e-04 eta 0:14:41
epoch [30/50] batch [220/288] time 0.095 (0.153) data 0.000 (0.001) loss 1.1678 (1.0960) ce_loss 1.0020 (0.9511) teacher_loss 1.0077 (0.9458) loss_zs_kd 0.1490 (0.1455) loss_oracle 0.0856 (0.0775) acc 68.7500 (74.2045) kd_loss 0.0392 (0.0437) lr 8.1262e-04 eta 0:14:54
epoch [30/50] batch [240/288] time 0.106 (0.157) data 0.000 (0.001) loss 0.7729 (1.0979) ce_loss 0.6387 (0.9535) teacher_loss 0.6257 (0.9480) loss_zs_kd 0.1322 (0.1450) loss_oracle 0.0810 (0.0774) acc 84.3750 (74.2188) kd_loss 0.0463 (0.0438) lr 8.1262e-04 eta 0:15:12
epoch [30/50] batch [260/288] time 0.147 (0.157) data 0.000 (0.001) loss 0.8594 (1.1055) ce_loss 0.7051 (0.9611) teacher_loss 0.6865 (0.9555) loss_zs_kd 0.1320 (0.1448) loss_oracle 0.1069 (0.0777) acc 84.3750 (74.1827) kd_loss 0.0647 (0.0440) lr 8.1262e-04 eta 0:15:08
epoch [30/50] batch [280/288] time 0.150 (0.157) data 0.000 (0.001) loss 0.8285 (1.0974) ce_loss 0.7134 (0.9535) teacher_loss 0.7034 (0.9480) loss_zs_kd 0.1188 (0.1440) loss_oracle 0.0658 (0.0774) acc 78.1250 (74.4420) kd_loss 0.0451 (0.0438) lr 8.1262e-04 eta 0:15:05
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,427
* accuracy: 87.0%
* error: 13.0%
* macro_f1: 86.4%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,015
* accuracy: 83.0%
* error: 17.0%
* macro_f1: 79.7%
******* Domain a best val acc:      87.2%, epoch: 29 *******
******* Domain a best val test acc: 83.0%, epoch: 29 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [31/50] batch [20/288] time 0.384 (0.183) data 0.000 (0.015) loss 0.4910 (1.0274) ce_loss 0.3716 (0.8758) teacher_loss 0.3798 (0.8714) loss_zs_kd 0.1169 (0.1583) loss_oracle 0.0528 (0.0768) acc 90.6250 (75.9375) kd_loss 0.0339 (0.0407) lr 7.5131e-04 eta 0:17:31
epoch [31/50] batch [40/288] time 0.403 (0.213) data 0.000 (0.007) loss 0.8178 (1.0849) ce_loss 0.6533 (0.9346) teacher_loss 0.6636 (0.9316) loss_zs_kd 0.1464 (0.1485) loss_oracle 0.0810 (0.0791) acc 87.5000 (75.1562) kd_loss 0.0419 (0.0416) lr 7.5131e-04 eta 0:20:17
epoch [31/50] batch [60/288] time 0.169 (0.190) data 0.000 (0.005) loss 1.0810 (1.0948) ce_loss 0.9248 (0.9473) teacher_loss 0.9232 (0.9427) loss_zs_kd 0.1516 (0.1445) loss_oracle 0.0819 (0.0799) acc 75.0000 (74.7917) kd_loss 0.0382 (0.0422) lr 7.5131e-04 eta 0:18:03
epoch [31/50] batch [80/288] time 0.168 (0.184) data 0.000 (0.004) loss 0.9967 (1.0758) ce_loss 0.8643 (0.9279) teacher_loss 0.8505 (0.9225) loss_zs_kd 0.1195 (0.1456) loss_oracle 0.0865 (0.0805) acc 81.2500 (74.8828) kd_loss 0.0507 (0.0425) lr 7.5131e-04 eta 0:17:23
epoch [31/50] batch [100/288] time 0.152 (0.180) data 0.000 (0.003) loss 1.1549 (1.0630) ce_loss 0.9707 (0.9161) teacher_loss 0.9813 (0.9107) loss_zs_kd 0.2143 (0.1449) loss_oracle 0.0665 (0.0799) acc 75.0000 (75.3125) kd_loss 0.0378 (0.0427) lr 7.5131e-04 eta 0:16:57
epoch [31/50] batch [120/288] time 0.168 (0.177) data 0.001 (0.003) loss 0.6541 (1.0686) ce_loss 0.5107 (0.9210) teacher_loss 0.4890 (0.9153) loss_zs_kd 0.1198 (0.1476) loss_oracle 0.1052 (0.0795) acc 87.5000 (75.3646) kd_loss 0.0644 (0.0432) lr 7.5131e-04 eta 0:16:35
epoch [31/50] batch [140/288] time 0.160 (0.174) data 0.000 (0.002) loss 0.8594 (1.0670) ce_loss 0.7065 (0.9198) teacher_loss 0.6998 (0.9141) loss_zs_kd 0.1707 (0.1474) loss_oracle 0.0742 (0.0792) acc 81.2500 (75.4464) kd_loss 0.0373 (0.0434) lr 7.5131e-04 eta 0:16:20
epoch [31/50] batch [160/288] time 0.082 (0.177) data 0.000 (0.002) loss 0.9449 (1.0731) ce_loss 0.7949 (0.9262) teacher_loss 0.7938 (0.9205) loss_zs_kd 0.1680 (0.1470) loss_oracle 0.0671 (0.0792) acc 81.2500 (75.2539) kd_loss 0.0539 (0.0441) lr 7.5131e-04 eta 0:16:29
epoch [31/50] batch [180/288] time 0.090 (0.178) data 0.000 (0.002) loss 1.3527 (1.0750) ce_loss 1.2168 (0.9297) teacher_loss 1.2029 (0.9237) loss_zs_kd 0.1323 (0.1451) loss_oracle 0.0837 (0.0786) acc 68.7500 (75.1215) kd_loss 0.0498 (0.0441) lr 7.5131e-04 eta 0:16:34
epoch [31/50] batch [200/288] time 0.165 (0.175) data 0.000 (0.002) loss 1.0346 (1.0767) ce_loss 0.8970 (0.9311) teacher_loss 0.8948 (0.9248) loss_zs_kd 0.1230 (0.1456) loss_oracle 0.0783 (0.0791) acc 81.2500 (75.1094) kd_loss 0.0441 (0.0446) lr 7.5131e-04 eta 0:16:14
epoch [31/50] batch [220/288] time 0.165 (0.174) data 0.000 (0.002) loss 1.1190 (1.0812) ce_loss 0.9800 (0.9351) teacher_loss 0.9571 (0.9288) loss_zs_kd 0.1540 (0.1452) loss_oracle 0.0849 (0.0797) acc 71.8750 (75.1420) kd_loss 0.0442 (0.0452) lr 7.5131e-04 eta 0:16:02
epoch [31/50] batch [240/288] time 0.146 (0.172) data 0.000 (0.001) loss 1.0560 (1.0794) ce_loss 0.9253 (0.9333) teacher_loss 0.9277 (0.9269) loss_zs_kd 0.1371 (0.1450) loss_oracle 0.0598 (0.0800) acc 75.0000 (75.1302) kd_loss 0.0320 (0.0457) lr 7.5131e-04 eta 0:15:51
epoch [31/50] batch [260/288] time 0.143 (0.171) data 0.000 (0.001) loss 0.7064 (1.0797) ce_loss 0.5972 (0.9345) teacher_loss 0.5954 (0.9283) loss_zs_kd 0.0790 (0.1437) loss_oracle 0.0715 (0.0796) acc 87.5000 (75.1082) kd_loss 0.0429 (0.0456) lr 7.5131e-04 eta 0:15:41
epoch [31/50] batch [280/288] time 0.147 (0.170) data 0.000 (0.001) loss 0.9212 (1.0709) ce_loss 0.8208 (0.9266) teacher_loss 0.8155 (0.9204) loss_zs_kd 0.0933 (0.1424) loss_oracle 0.0591 (0.0793) acc 84.3750 (75.4576) kd_loss 0.0401 (0.0456) lr 7.5131e-04 eta 0:15:32
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,420
* accuracy: 86.8%
* error: 13.2%
* macro_f1: 86.2%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,015
* accuracy: 83.0%
* error: 17.0%
* macro_f1: 79.8%
******* Domain a best val acc:      87.2%, epoch: 29 *******
******* Domain a best val test acc: 83.0%, epoch: 29 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [32/50] batch [20/288] time 0.153 (0.174) data 0.000 (0.013) loss 1.0216 (1.0965) ce_loss 0.9097 (0.9527) teacher_loss 0.9145 (0.9453) loss_zs_kd 0.0897 (0.1366) loss_oracle 0.0623 (0.0829) acc 78.1250 (75.0000) kd_loss 0.0370 (0.0491) lr 6.9098e-04 eta 0:15:50
epoch [32/50] batch [40/288] time 0.177 (0.169) data 0.000 (0.006) loss 0.5952 (1.0898) ce_loss 0.4834 (0.9467) teacher_loss 0.4762 (0.9376) loss_zs_kd 0.0777 (0.1428) loss_oracle 0.0802 (0.0807) acc 90.6250 (75.6250) kd_loss 0.0452 (0.0481) lr 6.9098e-04 eta 0:15:18
epoch [32/50] batch [60/288] time 0.165 (0.168) data 0.000 (0.004) loss 0.9765 (1.1048) ce_loss 0.8262 (0.9615) teacher_loss 0.8083 (0.9520) loss_zs_kd 0.1698 (0.1467) loss_oracle 0.0833 (0.0795) acc 78.1250 (74.9479) kd_loss 0.0415 (0.0473) lr 6.9098e-04 eta 0:15:06
epoch [32/50] batch [80/288] time 0.155 (0.166) data 0.000 (0.003) loss 1.5402 (1.0803) ce_loss 1.4297 (0.9379) teacher_loss 1.4290 (0.9279) loss_zs_kd 0.1143 (0.1468) loss_oracle 0.0541 (0.0790) acc 62.5000 (75.3125) kd_loss 0.0251 (0.0470) lr 6.9098e-04 eta 0:14:55
epoch [32/50] batch [100/288] time 0.100 (0.162) data 0.000 (0.003) loss 0.6201 (1.0808) ce_loss 0.4651 (0.9385) teacher_loss 0.4438 (0.9288) loss_zs_kd 0.1438 (0.1445) loss_oracle 0.1044 (0.0798) acc 87.5000 (75.4688) kd_loss 0.0624 (0.0478) lr 6.9098e-04 eta 0:14:32
epoch [32/50] batch [120/288] time 0.415 (0.176) data 0.000 (0.002) loss 0.7021 (1.0780) ce_loss 0.6025 (0.9356) teacher_loss 0.5750 (0.9264) loss_zs_kd 0.1098 (0.1449) loss_oracle 0.0722 (0.0791) acc 78.1250 (75.2604) kd_loss 0.0406 (0.0474) lr 6.9098e-04 eta 0:15:43
epoch [32/50] batch [140/288] time 0.166 (0.173) data 0.000 (0.002) loss 1.0777 (1.0762) ce_loss 0.9141 (0.9345) teacher_loss 0.9067 (0.9254) loss_zs_kd 0.2087 (0.1450) loss_oracle 0.0666 (0.0784) acc 78.1250 (75.1116) kd_loss 0.0412 (0.0470) lr 6.9098e-04 eta 0:15:24
epoch [32/50] batch [160/288] time 0.165 (0.172) data 0.000 (0.002) loss 0.8474 (1.0721) ce_loss 0.7173 (0.9312) teacher_loss 0.6919 (0.9223) loss_zs_kd 0.1557 (0.1441) loss_oracle 0.0776 (0.0777) acc 78.1250 (75.0000) kd_loss 0.0494 (0.0468) lr 6.9098e-04 eta 0:15:15
epoch [32/50] batch [180/288] time 0.184 (0.172) data 0.000 (0.002) loss 1.0376 (1.0816) ce_loss 0.8828 (0.9402) teacher_loss 0.8734 (0.9320) loss_zs_kd 0.1563 (0.1447) loss_oracle 0.0861 (0.0772) acc 71.8750 (74.5833) kd_loss 0.0537 (0.0463) lr 6.9098e-04 eta 0:15:08
epoch [32/50] batch [200/288] time 0.172 (0.172) data 0.000 (0.001) loss 1.0753 (1.0780) ce_loss 0.9136 (0.9371) teacher_loss 0.9138 (0.9294) loss_zs_kd 0.1616 (0.1442) loss_oracle 0.0807 (0.0766) acc 75.0000 (74.6719) kd_loss 0.0495 (0.0459) lr 6.9098e-04 eta 0:15:04
epoch [32/50] batch [220/288] time 0.110 (0.170) data 0.000 (0.001) loss 0.8809 (1.0830) ce_loss 0.7583 (0.9423) teacher_loss 0.7588 (0.9349) loss_zs_kd 0.0997 (0.1434) loss_oracle 0.0723 (0.0764) acc 71.8750 (74.5597) kd_loss 0.0445 (0.0457) lr 6.9098e-04 eta 0:14:53
epoch [32/50] batch [240/288] time 0.213 (0.179) data 0.000 (0.001) loss 1.0485 (1.0760) ce_loss 0.9233 (0.9355) teacher_loss 0.9353 (0.9283) loss_zs_kd 0.1117 (0.1426) loss_oracle 0.0574 (0.0764) acc 78.1250 (74.7917) kd_loss 0.0289 (0.0455) lr 6.9098e-04 eta 0:15:34
epoch [32/50] batch [260/288] time 0.171 (0.177) data 0.000 (0.001) loss 1.0450 (1.0820) ce_loss 0.9189 (0.9413) teacher_loss 0.9001 (0.9340) loss_zs_kd 0.1030 (0.1429) loss_oracle 0.0935 (0.0765) acc 78.1250 (74.6274) kd_loss 0.0481 (0.0454) lr 6.9098e-04 eta 0:15:20
epoch [32/50] batch [280/288] time 0.153 (0.176) data 0.000 (0.001) loss 0.8793 (1.0805) ce_loss 0.7642 (0.9398) teacher_loss 0.7466 (0.9329) loss_zs_kd 0.1221 (0.1429) loss_oracle 0.0717 (0.0761) acc 71.8750 (74.5982) kd_loss 0.0416 (0.0450) lr 6.9098e-04 eta 0:15:11
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,428
* accuracy: 87.0%
* error: 13.0%
* macro_f1: 86.5%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,015
* accuracy: 83.0%
* error: 17.0%
* macro_f1: 79.8%
******* Domain a best val acc:      87.2%, epoch: 29 *******
******* Domain a best val test acc: 83.0%, epoch: 29 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [33/50] batch [20/288] time 0.404 (0.190) data 0.001 (0.015) loss 1.1596 (1.1282) ce_loss 1.0264 (0.9834) teacher_loss 1.0319 (0.9784) loss_zs_kd 0.1346 (0.1505) loss_oracle 0.0604 (0.0745) acc 81.2500 (74.0625) kd_loss 0.0329 (0.0439) lr 6.3188e-04 eta 0:16:22
epoch [33/50] batch [40/288] time 0.086 (0.217) data 0.000 (0.008) loss 1.1531 (1.1394) ce_loss 1.0273 (0.9965) teacher_loss 1.0271 (0.9906) loss_zs_kd 0.1396 (0.1471) loss_oracle 0.0562 (0.0752) acc 75.0000 (73.5156) kd_loss 0.0331 (0.0444) lr 6.3188e-04 eta 0:18:38
epoch [33/50] batch [60/288] time 0.166 (0.199) data 0.000 (0.005) loss 1.0424 (1.1221) ce_loss 0.8960 (0.9802) teacher_loss 0.9122 (0.9731) loss_zs_kd 0.1470 (0.1467) loss_oracle 0.0567 (0.0756) acc 75.0000 (73.8021) kd_loss 0.0305 (0.0444) lr 6.3188e-04 eta 0:17:00
epoch [33/50] batch [80/288] time 0.154 (0.191) data 0.000 (0.004) loss 0.8909 (1.1185) ce_loss 0.7681 (0.9761) teacher_loss 0.7718 (0.9693) loss_zs_kd 0.1067 (0.1445) loss_oracle 0.0657 (0.0769) acc 84.3750 (74.1406) kd_loss 0.0401 (0.0455) lr 6.3188e-04 eta 0:16:13
epoch [33/50] batch [100/288] time 0.160 (0.185) data 0.001 (0.003) loss 0.9806 (1.1000) ce_loss 0.8462 (0.9554) teacher_loss 0.8490 (0.9494) loss_zs_kd 0.1135 (0.1471) loss_oracle 0.0748 (0.0770) acc 81.2500 (74.6250) kd_loss 0.0485 (0.0456) lr 6.3188e-04 eta 0:15:40
epoch [33/50] batch [120/288] time 0.156 (0.181) data 0.000 (0.003) loss 1.7399 (1.0993) ce_loss 1.6016 (0.9545) teacher_loss 1.5967 (0.9491) loss_zs_kd 0.1303 (0.1464) loss_oracle 0.0781 (0.0771) acc 56.2500 (74.7917) kd_loss 0.0476 (0.0458) lr 6.3188e-04 eta 0:15:18
epoch [33/50] batch [140/288] time 0.173 (0.179) data 0.000 (0.002) loss 1.1814 (1.0946) ce_loss 1.0303 (0.9501) teacher_loss 1.0349 (0.9450) loss_zs_kd 0.1620 (0.1462) loss_oracle 0.0656 (0.0766) acc 75.0000 (74.8884) kd_loss 0.0342 (0.0457) lr 6.3188e-04 eta 0:15:01
epoch [33/50] batch [160/288] time 0.338 (0.178) data 0.000 (0.002) loss 1.1862 (1.0906) ce_loss 1.0029 (0.9461) teacher_loss 0.9963 (0.9409) loss_zs_kd 0.1880 (0.1454) loss_oracle 0.0960 (0.0771) acc 65.6250 (74.9023) kd_loss 0.0546 (0.0459) lr 6.3188e-04 eta 0:14:55
epoch [33/50] batch [180/288] time 0.170 (0.182) data 0.000 (0.002) loss 1.2544 (1.0904) ce_loss 1.1104 (0.9455) teacher_loss 1.1106 (0.9400) loss_zs_kd 0.1530 (0.1448) loss_oracle 0.0673 (0.0780) acc 68.7500 (74.9306) kd_loss 0.0441 (0.0466) lr 6.3188e-04 eta 0:15:09
epoch [33/50] batch [200/288] time 0.167 (0.180) data 0.000 (0.002) loss 1.1366 (1.0866) ce_loss 1.0039 (0.9416) teacher_loss 0.9943 (0.9361) loss_zs_kd 0.1115 (0.1445) loss_oracle 0.0865 (0.0782) acc 71.8750 (75.0156) kd_loss 0.0515 (0.0471) lr 6.3188e-04 eta 0:14:56
epoch [33/50] batch [220/288] time 0.168 (0.178) data 0.000 (0.002) loss 1.1651 (1.0839) ce_loss 1.0820 (0.9389) teacher_loss 1.0876 (0.9335) loss_zs_kd 0.0652 (0.1448) loss_oracle 0.0448 (0.0780) acc 68.7500 (75.0284) kd_loss 0.0226 (0.0470) lr 6.3188e-04 eta 0:14:44
epoch [33/50] batch [240/288] time 0.169 (0.177) data 0.000 (0.001) loss 0.7627 (1.0751) ce_loss 0.5894 (0.9295) teacher_loss 0.5976 (0.9242) loss_zs_kd 0.1639 (0.1454) loss_oracle 0.0831 (0.0783) acc 81.2500 (75.2474) kd_loss 0.0449 (0.0471) lr 6.3188e-04 eta 0:14:33
epoch [33/50] batch [260/288] time 0.160 (0.176) data 0.000 (0.001) loss 1.0583 (1.0821) ce_loss 0.9463 (0.9363) teacher_loss 0.9478 (0.9307) loss_zs_kd 0.0991 (0.1453) loss_oracle 0.0610 (0.0787) acc 81.2500 (75.1322) kd_loss 0.0384 (0.0474) lr 6.3188e-04 eta 0:14:25
epoch [33/50] batch [280/288] time 0.380 (0.174) data 0.000 (0.001) loss 1.0001 (1.0828) ce_loss 0.8584 (0.9365) teacher_loss 0.8682 (0.9307) loss_zs_kd 0.1232 (0.1459) loss_oracle 0.0703 (0.0792) acc 81.2500 (75.0558) kd_loss 0.0431 (0.0477) lr 6.3188e-04 eta 0:14:13
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,432
* accuracy: 87.1%
* error: 12.9%
* macro_f1: 86.6%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,012
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 79.8%
******* Domain a best val acc:      87.2%, epoch: 29 *******
******* Domain a best val test acc: 83.0%, epoch: 29 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [34/50] batch [20/288] time 0.175 (0.180) data 0.000 (0.013) loss 1.3317 (0.9887) ce_loss 1.1904 (0.8403) teacher_loss 1.1561 (0.8403) loss_zs_kd 0.1706 (0.1486) loss_oracle 0.0902 (0.0741) acc 71.8750 (78.1250) kd_loss 0.0544 (0.0453) lr 5.7422e-04 eta 0:14:37
epoch [34/50] batch [40/288] time 0.169 (0.173) data 0.000 (0.007) loss 0.9438 (1.0448) ce_loss 0.8271 (0.9035) teacher_loss 0.8189 (0.8981) loss_zs_kd 0.0970 (0.1443) loss_oracle 0.0764 (0.0746) acc 78.1250 (75.3125) kd_loss 0.0448 (0.0465) lr 5.7422e-04 eta 0:13:57
epoch [34/50] batch [60/288] time 0.164 (0.168) data 0.000 (0.004) loss 0.9106 (1.0509) ce_loss 0.8037 (0.9105) teacher_loss 0.8028 (0.9044) loss_zs_kd 0.0887 (0.1420) loss_oracle 0.0634 (0.0755) acc 78.1250 (75.1042) kd_loss 0.0426 (0.0475) lr 5.7422e-04 eta 0:13:34
epoch [34/50] batch [80/288] time 0.171 (0.167) data 0.000 (0.003) loss 1.0513 (1.0549) ce_loss 0.9189 (0.9144) teacher_loss 0.9172 (0.9093) loss_zs_kd 0.1720 (0.1420) loss_oracle 0.0481 (0.0746) acc 78.1250 (75.4688) kd_loss 0.0309 (0.0466) lr 5.7422e-04 eta 0:13:24
epoch [34/50] batch [100/288] time 0.374 (0.176) data 0.000 (0.003) loss 1.2233 (1.0434) ce_loss 1.0625 (0.9018) teacher_loss 1.0572 (0.8965) loss_zs_kd 0.1784 (0.1421) loss_oracle 0.0768 (0.0759) acc 71.8750 (75.8125) kd_loss 0.0485 (0.0470) lr 5.7422e-04 eta 0:14:03
epoch [34/50] batch [120/288] time 0.167 (0.179) data 0.000 (0.002) loss 1.0910 (1.0562) ce_loss 0.9268 (0.9130) teacher_loss 0.9303 (0.9080) loss_zs_kd 0.1297 (0.1420) loss_oracle 0.0959 (0.0771) acc 71.8750 (75.5469) kd_loss 0.0592 (0.0472) lr 5.7422e-04 eta 0:14:13
epoch [34/50] batch [140/288] time 0.161 (0.176) data 0.000 (0.002) loss 1.1650 (1.0521) ce_loss 1.0518 (0.9081) teacher_loss 1.0318 (0.9029) loss_zs_kd 0.1305 (0.1430) loss_oracle 0.0679 (0.0776) acc 65.6250 (75.7143) kd_loss 0.0368 (0.0471) lr 5.7422e-04 eta 0:13:58
epoch [34/50] batch [160/288] time 0.174 (0.174) data 0.000 (0.002) loss 0.7337 (1.0528) ce_loss 0.5757 (0.9075) teacher_loss 0.5812 (0.9023) loss_zs_kd 0.1530 (0.1447) loss_oracle 0.0761 (0.0781) acc 84.3750 (75.6250) kd_loss 0.0384 (0.0469) lr 5.7422e-04 eta 0:13:46
epoch [34/50] batch [180/288] time 0.151 (0.173) data 0.000 (0.002) loss 1.0529 (1.0591) ce_loss 0.8813 (0.9124) teacher_loss 0.8736 (0.9070) loss_zs_kd 0.1532 (0.1466) loss_oracle 0.1026 (0.0788) acc 75.0000 (75.3819) kd_loss 0.0630 (0.0472) lr 5.7422e-04 eta 0:13:35
epoch [34/50] batch [200/288] time 0.153 (0.172) data 0.000 (0.001) loss 1.5461 (1.0721) ce_loss 1.4043 (0.9255) teacher_loss 1.4060 (0.9199) loss_zs_kd 0.1613 (0.1465) loss_oracle 0.0595 (0.0790) acc 65.6250 (75.1562) kd_loss 0.0354 (0.0470) lr 5.7422e-04 eta 0:13:25
epoch [34/50] batch [220/288] time 0.353 (0.172) data 0.000 (0.001) loss 1.1746 (1.0744) ce_loss 1.0342 (0.9274) teacher_loss 1.0188 (0.9215) loss_zs_kd 0.1222 (0.1471) loss_oracle 0.0946 (0.0794) acc 68.7500 (75.1705) kd_loss 0.0622 (0.0469) lr 5.7422e-04 eta 0:13:22
epoch [34/50] batch [240/288] time 0.345 (0.174) data 0.000 (0.001) loss 1.1499 (1.0815) ce_loss 0.9922 (0.9342) teacher_loss 0.9771 (0.9281) loss_zs_kd 0.1535 (0.1477) loss_oracle 0.0960 (0.0795) acc 68.7500 (75.0781) kd_loss 0.0567 (0.0468) lr 5.7422e-04 eta 0:13:28
epoch [34/50] batch [260/288] time 0.172 (0.173) data 0.000 (0.001) loss 0.9426 (1.0782) ce_loss 0.7905 (0.9318) teacher_loss 0.7852 (0.9255) loss_zs_kd 0.1578 (0.1475) loss_oracle 0.0785 (0.0790) acc 81.2500 (75.2043) kd_loss 0.0429 (0.0463) lr 5.7422e-04 eta 0:13:21
epoch [34/50] batch [280/288] time 0.149 (0.172) data 0.000 (0.001) loss 1.2549 (1.0742) ce_loss 1.0947 (0.9287) teacher_loss 1.0725 (0.9225) loss_zs_kd 0.2030 (0.1464) loss_oracle 0.0809 (0.0784) acc 68.7500 (75.2679) kd_loss 0.0443 (0.0459) lr 5.7422e-04 eta 0:13:12
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,436
* accuracy: 87.2%
* error: 12.8%
* macro_f1: 86.6%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,012
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 79.7%
******* Domain a best val acc:      87.2%, epoch: 34 *******
******* Domain a best val test acc: 82.9%, epoch: 34 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [35/50] batch [20/288] time 0.169 (0.174) data 0.000 (0.014) loss 1.4230 (1.1603) ce_loss 1.2539 (1.0066) teacher_loss 1.2435 (0.9988) loss_zs_kd 0.1699 (0.1542) loss_oracle 0.0946 (0.0843) acc 71.8750 (73.4375) kd_loss 0.0531 (0.0469) lr 5.1825e-04 eta 0:13:16
epoch [35/50] batch [40/288] time 0.204 (0.184) data 0.000 (0.007) loss 1.1921 (1.1813) ce_loss 1.0537 (1.0280) teacher_loss 1.0676 (1.0209) loss_zs_kd 0.1144 (0.1549) loss_oracle 0.0673 (0.0830) acc 71.8750 (72.6562) kd_loss 0.0327 (0.0467) lr 5.1825e-04 eta 0:14:00
epoch [35/50] batch [60/288] time 0.142 (0.188) data 0.001 (0.005) loss 1.5129 (1.1483) ce_loss 1.4014 (0.9989) teacher_loss 1.3570 (0.9925) loss_zs_kd 0.1391 (0.1495) loss_oracle 0.0864 (0.0811) acc 71.8750 (74.1146) kd_loss 0.0475 (0.0456) lr 5.1825e-04 eta 0:14:16
epoch [35/50] batch [80/288] time 0.163 (0.181) data 0.000 (0.004) loss 1.1475 (1.1459) ce_loss 1.0127 (0.9966) teacher_loss 1.0027 (0.9911) loss_zs_kd 0.1686 (0.1467) loss_oracle 0.0606 (0.0814) acc 71.8750 (73.9844) kd_loss 0.0384 (0.0462) lr 5.1825e-04 eta 0:13:40
epoch [35/50] batch [100/288] time 0.162 (0.177) data 0.000 (0.003) loss 1.2721 (1.1392) ce_loss 1.1416 (0.9904) teacher_loss 1.1417 (0.9851) loss_zs_kd 0.1280 (0.1472) loss_oracle 0.0663 (0.0806) acc 68.7500 (73.9688) kd_loss 0.0376 (0.0464) lr 5.1825e-04 eta 0:13:18
epoch [35/50] batch [120/288] time 0.171 (0.175) data 0.000 (0.003) loss 1.0111 (1.1265) ce_loss 0.8218 (0.9779) teacher_loss 0.8187 (0.9732) loss_zs_kd 0.1939 (0.1477) loss_oracle 0.0954 (0.0794) acc 75.0000 (74.2708) kd_loss 0.0505 (0.0461) lr 5.1825e-04 eta 0:13:03
epoch [35/50] batch [140/288] time 0.169 (0.173) data 0.000 (0.002) loss 0.6186 (1.1219) ce_loss 0.5229 (0.9738) teacher_loss 0.5268 (0.9690) loss_zs_kd 0.0721 (0.1470) loss_oracle 0.0557 (0.0794) acc 87.5000 (74.3750) kd_loss 0.0431 (0.0462) lr 5.1825e-04 eta 0:12:50
epoch [35/50] batch [160/288] time 0.138 (0.172) data 0.000 (0.002) loss 1.0112 (1.1150) ce_loss 0.8740 (0.9676) teacher_loss 0.8735 (0.9631) loss_zs_kd 0.1374 (0.1468) loss_oracle 0.0690 (0.0785) acc 71.8750 (74.4727) kd_loss 0.0407 (0.0456) lr 5.1825e-04 eta 0:12:43
epoch [35/50] batch [180/288] time 0.404 (0.176) data 0.000 (0.002) loss 0.7501 (1.0966) ce_loss 0.6318 (0.9504) teacher_loss 0.6389 (0.9459) loss_zs_kd 0.0823 (0.1449) loss_oracle 0.0700 (0.0782) acc 81.2500 (74.9306) kd_loss 0.0393 (0.0455) lr 5.1825e-04 eta 0:12:59
epoch [35/50] batch [200/288] time 0.154 (0.177) data 0.000 (0.002) loss 0.7286 (1.0910) ce_loss 0.5781 (0.9448) teacher_loss 0.5802 (0.9401) loss_zs_kd 0.1449 (0.1453) loss_oracle 0.0759 (0.0783) acc 75.0000 (75.0000) kd_loss 0.0396 (0.0457) lr 5.1825e-04 eta 0:13:01
epoch [35/50] batch [220/288] time 0.165 (0.177) data 0.000 (0.001) loss 0.7255 (1.0856) ce_loss 0.5894 (0.9401) teacher_loss 0.5966 (0.9355) loss_zs_kd 0.1127 (0.1447) loss_oracle 0.0726 (0.0778) acc 84.3750 (75.0000) kd_loss 0.0455 (0.0458) lr 5.1825e-04 eta 0:12:54
epoch [35/50] batch [240/288] time 0.169 (0.176) data 0.000 (0.001) loss 0.5736 (1.0806) ce_loss 0.4019 (0.9345) teacher_loss 0.3983 (0.9301) loss_zs_kd 0.2081 (0.1454) loss_oracle 0.0713 (0.0777) acc 87.5000 (75.0260) kd_loss 0.0454 (0.0460) lr 5.1825e-04 eta 0:12:47
epoch [35/50] batch [260/288] time 0.178 (0.175) data 0.000 (0.001) loss 0.8094 (1.0674) ce_loss 0.6685 (0.9214) teacher_loss 0.6672 (0.9171) loss_zs_kd 0.1189 (0.1453) loss_oracle 0.0827 (0.0777) acc 90.6250 (75.3245) kd_loss 0.0565 (0.0462) lr 5.1825e-04 eta 0:12:39
epoch [35/50] batch [280/288] time 0.181 (0.174) data 0.000 (0.001) loss 1.1721 (1.0724) ce_loss 1.0273 (0.9256) teacher_loss 1.0253 (0.9211) loss_zs_kd 0.1174 (0.1461) loss_oracle 0.0881 (0.0782) acc 71.8750 (75.1786) kd_loss 0.0483 (0.0469) lr 5.1825e-04 eta 0:12:34
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,429
* accuracy: 87.1%
* error: 12.9%
* macro_f1: 86.5%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,017
* accuracy: 83.1%
* error: 16.9%
* macro_f1: 79.9%
******* Domain a best val acc:      87.2%, epoch: 34 *******
******* Domain a best val test acc: 82.9%, epoch: 34 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [36/50] batch [20/288] time 0.154 (0.180) data 0.000 (0.013) loss 1.4447 (1.0244) ce_loss 1.3340 (0.8800) teacher_loss 1.2960 (0.8780) loss_zs_kd 0.1118 (0.1437) loss_oracle 0.0927 (0.0746) acc 68.7500 (78.1250) kd_loss 0.0576 (0.0449) lr 4.6417e-04 eta 0:12:52
epoch [36/50] batch [40/288] time 0.166 (0.168) data 0.000 (0.007) loss 1.0601 (1.0773) ce_loss 0.9209 (0.9293) teacher_loss 0.9253 (0.9251) loss_zs_kd 0.1201 (0.1525) loss_oracle 0.0748 (0.0759) acc 78.1250 (76.2500) kd_loss 0.0435 (0.0462) lr 4.6417e-04 eta 0:11:57
epoch [36/50] batch [60/288] time 0.165 (0.165) data 0.000 (0.004) loss 0.9197 (1.0795) ce_loss 0.7358 (0.9294) teacher_loss 0.7468 (0.9258) loss_zs_kd 0.1910 (0.1521) loss_oracle 0.0773 (0.0776) acc 84.3750 (76.0938) kd_loss 0.0468 (0.0474) lr 4.6417e-04 eta 0:11:44
epoch [36/50] batch [80/288] time 0.166 (0.164) data 0.000 (0.003) loss 1.0313 (1.0600) ce_loss 0.8691 (0.9108) teacher_loss 0.8848 (0.9079) loss_zs_kd 0.1462 (0.1497) loss_oracle 0.0735 (0.0773) acc 78.1250 (76.5234) kd_loss 0.0418 (0.0472) lr 4.6417e-04 eta 0:11:33
epoch [36/50] batch [100/288] time 0.328 (0.160) data 0.000 (0.003) loss 1.2556 (1.0360) ce_loss 1.1084 (0.8846) teacher_loss 1.1020 (0.8813) loss_zs_kd 0.1275 (0.1507) loss_oracle 0.0899 (0.0794) acc 75.0000 (77.0938) kd_loss 0.0543 (0.0485) lr 4.6417e-04 eta 0:11:17
epoch [36/50] batch [120/288] time 0.101 (0.176) data 0.000 (0.002) loss 0.7956 (1.0469) ce_loss 0.6465 (0.8964) teacher_loss 0.6481 (0.8930) loss_zs_kd 0.1354 (0.1488) loss_oracle 0.0798 (0.0796) acc 87.5000 (76.6667) kd_loss 0.0457 (0.0486) lr 4.6417e-04 eta 0:12:18
epoch [36/50] batch [140/288] time 0.149 (0.173) data 0.000 (0.002) loss 1.0684 (1.0532) ce_loss 0.9458 (0.9026) teacher_loss 0.9417 (0.8989) loss_zs_kd 0.1251 (0.1488) loss_oracle 0.0641 (0.0799) acc 71.8750 (76.5402) kd_loss 0.0393 (0.0493) lr 4.6417e-04 eta 0:12:02
epoch [36/50] batch [160/288] time 0.149 (0.171) data 0.000 (0.002) loss 0.9757 (1.0472) ce_loss 0.8428 (0.8957) teacher_loss 0.8379 (0.8917) loss_zs_kd 0.1122 (0.1499) loss_oracle 0.0816 (0.0805) acc 78.1250 (76.4648) kd_loss 0.0472 (0.0496) lr 4.6417e-04 eta 0:11:50
epoch [36/50] batch [180/288] time 0.146 (0.169) data 0.000 (0.002) loss 1.3993 (1.0528) ce_loss 1.2520 (0.9015) teacher_loss 1.2537 (0.8974) loss_zs_kd 0.1212 (0.1496) loss_oracle 0.0849 (0.0806) acc 68.7500 (76.2500) kd_loss 0.0403 (0.0498) lr 4.6417e-04 eta 0:11:41
epoch [36/50] batch [200/288] time 0.152 (0.168) data 0.000 (0.001) loss 1.1779 (1.0608) ce_loss 1.0332 (0.9099) teacher_loss 1.0104 (0.9056) loss_zs_kd 0.1383 (0.1495) loss_oracle 0.0983 (0.0804) acc 65.6250 (76.0625) kd_loss 0.0584 (0.0496) lr 4.6417e-04 eta 0:11:32
epoch [36/50] batch [220/288] time 0.147 (0.167) data 0.000 (0.001) loss 1.1721 (1.0587) ce_loss 1.0547 (0.9088) teacher_loss 1.0442 (0.9043) loss_zs_kd 0.1447 (0.1484) loss_oracle 0.0555 (0.0803) acc 75.0000 (76.0369) kd_loss 0.0343 (0.0494) lr 4.6417e-04 eta 0:11:24
epoch [36/50] batch [240/288] time 0.341 (0.166) data 0.000 (0.001) loss 0.9270 (1.0570) ce_loss 0.7637 (0.9072) teacher_loss 0.7670 (0.9029) loss_zs_kd 0.1557 (0.1481) loss_oracle 0.0821 (0.0800) acc 75.0000 (76.0547) kd_loss 0.0392 (0.0493) lr 4.6417e-04 eta 0:11:15
epoch [36/50] batch [260/288] time 0.100 (0.173) data 0.000 (0.001) loss 0.8071 (1.0526) ce_loss 0.6387 (0.9027) teacher_loss 0.6384 (0.8989) loss_zs_kd 0.1522 (0.1478) loss_oracle 0.0926 (0.0799) acc 84.3750 (76.1418) kd_loss 0.0526 (0.0491) lr 4.6417e-04 eta 0:11:41
epoch [36/50] batch [280/288] time 0.164 (0.171) data 0.000 (0.001) loss 0.9029 (1.0574) ce_loss 0.7739 (0.9073) teacher_loss 0.7719 (0.9032) loss_zs_kd 0.1526 (0.1493) loss_oracle 0.0547 (0.0796) acc 84.3750 (76.0156) kd_loss 0.0448 (0.0490) lr 4.6417e-04 eta 0:11:31
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,433
* accuracy: 87.2%
* error: 12.8%
* macro_f1: 86.5%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,014
* accuracy: 83.0%
* error: 17.0%
* macro_f1: 79.6%
******* Domain a best val acc:      87.2%, epoch: 34 *******
******* Domain a best val test acc: 82.9%, epoch: 34 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [37/50] batch [20/288] time 0.172 (0.176) data 0.000 (0.013) loss 1.0612 (1.0887) ce_loss 0.9204 (0.9381) teacher_loss 0.9297 (0.9284) loss_zs_kd 0.1266 (0.1586) loss_oracle 0.0683 (0.0811) acc 75.0000 (75.0000) kd_loss 0.0420 (0.0537) lr 4.1221e-04 eta 0:11:46
epoch [37/50] batch [40/288] time 0.109 (0.163) data 0.000 (0.007) loss 1.0714 (1.1164) ce_loss 0.9180 (0.9697) teacher_loss 0.9103 (0.9614) loss_zs_kd 0.1767 (0.1506) loss_oracle 0.0727 (0.0797) acc 75.0000 (73.9062) kd_loss 0.0483 (0.0528) lr 4.1221e-04 eta 0:10:51
epoch [37/50] batch [60/288] time 0.147 (0.199) data 0.001 (0.004) loss 0.9318 (1.0957) ce_loss 0.7817 (0.9512) teacher_loss 0.7638 (0.9450) loss_zs_kd 0.1607 (0.1458) loss_oracle 0.0877 (0.0778) acc 84.3750 (74.6354) kd_loss 0.0462 (0.0504) lr 4.1221e-04 eta 0:13:09
epoch [37/50] batch [80/288] time 0.146 (0.184) data 0.000 (0.003) loss 0.7528 (1.0843) ce_loss 0.6201 (0.9369) teacher_loss 0.6256 (0.9316) loss_zs_kd 0.1055 (0.1486) loss_oracle 0.0745 (0.0784) acc 81.2500 (75.2734) kd_loss 0.0434 (0.0504) lr 4.1221e-04 eta 0:12:08
epoch [37/50] batch [100/288] time 0.167 (0.179) data 0.000 (0.003) loss 0.9067 (1.0659) ce_loss 0.7788 (0.9179) teacher_loss 0.7648 (0.9119) loss_zs_kd 0.1326 (0.1495) loss_oracle 0.0756 (0.0793) acc 81.2500 (75.7812) kd_loss 0.0561 (0.0502) lr 4.1221e-04 eta 0:11:42
epoch [37/50] batch [120/288] time 0.166 (0.175) data 0.000 (0.002) loss 1.4260 (1.0810) ce_loss 1.3066 (0.9320) teacher_loss 1.2793 (0.9268) loss_zs_kd 0.0938 (0.1504) loss_oracle 0.0998 (0.0789) acc 65.6250 (74.9740) kd_loss 0.0742 (0.0500) lr 4.1221e-04 eta 0:11:23
epoch [37/50] batch [140/288] time 0.165 (0.172) data 0.000 (0.002) loss 1.2160 (1.0827) ce_loss 1.0762 (0.9328) teacher_loss 1.0662 (0.9284) loss_zs_kd 0.1154 (0.1508) loss_oracle 0.0921 (0.0789) acc 71.8750 (74.8884) kd_loss 0.0625 (0.0502) lr 4.1221e-04 eta 0:11:08
epoch [37/50] batch [160/288] time 0.149 (0.169) data 0.000 (0.002) loss 0.9107 (1.0771) ce_loss 0.7769 (0.9266) teacher_loss 0.7710 (0.9224) loss_zs_kd 0.1136 (0.1510) loss_oracle 0.0830 (0.0793) acc 78.1250 (75.0195) kd_loss 0.0651 (0.0503) lr 4.1221e-04 eta 0:10:55
epoch [37/50] batch [180/288] time 0.167 (0.168) data 0.000 (0.002) loss 1.0099 (1.0664) ce_loss 0.8608 (0.9163) teacher_loss 0.8480 (0.9121) loss_zs_kd 0.1560 (0.1503) loss_oracle 0.0838 (0.0792) acc 78.1250 (75.2604) kd_loss 0.0491 (0.0500) lr 4.1221e-04 eta 0:10:45
epoch [37/50] batch [200/288] time 0.328 (0.168) data 0.000 (0.001) loss 0.9223 (1.0673) ce_loss 0.7646 (0.9167) teacher_loss 0.7700 (0.9123) loss_zs_kd 0.1322 (0.1506) loss_oracle 0.0863 (0.0797) acc 78.1250 (75.4062) kd_loss 0.0571 (0.0501) lr 4.1221e-04 eta 0:10:45
epoch [37/50] batch [220/288] time 0.167 (0.171) data 0.000 (0.001) loss 1.3493 (1.0700) ce_loss 1.1826 (0.9196) teacher_loss 1.1695 (0.9150) loss_zs_kd 0.1889 (0.1505) loss_oracle 0.0853 (0.0797) acc 71.8750 (75.2557) kd_loss 0.0532 (0.0499) lr 4.1221e-04 eta 0:10:52
epoch [37/50] batch [240/288] time 0.150 (0.170) data 0.000 (0.001) loss 0.8928 (1.0701) ce_loss 0.7402 (0.9202) teacher_loss 0.7349 (0.9154) loss_zs_kd 0.1465 (0.1500) loss_oracle 0.0847 (0.0797) acc 84.3750 (75.2083) kd_loss 0.0510 (0.0497) lr 4.1221e-04 eta 0:10:44
epoch [37/50] batch [260/288] time 0.153 (0.169) data 0.000 (0.001) loss 1.2427 (1.0738) ce_loss 1.0703 (0.9239) teacher_loss 1.0590 (0.9188) loss_zs_kd 0.1731 (0.1501) loss_oracle 0.0971 (0.0799) acc 78.1250 (75.1322) kd_loss 0.0636 (0.0497) lr 4.1221e-04 eta 0:10:36
epoch [37/50] batch [280/288] time 0.165 (0.168) data 0.000 (0.001) loss 0.8706 (1.0686) ce_loss 0.6934 (0.9183) teacher_loss 0.6837 (0.9130) loss_zs_kd 0.1615 (0.1508) loss_oracle 0.1061 (0.0802) acc 87.5000 (75.2790) kd_loss 0.0661 (0.0497) lr 4.1221e-04 eta 0:10:28
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,435
* accuracy: 87.2%
* error: 12.8%
* macro_f1: 86.6%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,021
* accuracy: 83.3%
* error: 16.7%
* macro_f1: 80.0%
******* Domain a best val acc:      87.2%, epoch: 34 *******
******* Domain a best val test acc: 82.9%, epoch: 34 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [38/50] batch [20/288] time 0.389 (0.256) data 0.000 (0.016) loss 1.2927 (1.1117) ce_loss 1.1758 (0.9681) teacher_loss 1.1829 (0.9614) loss_zs_kd 0.0991 (0.1551) loss_oracle 0.0602 (0.0728) acc 65.6250 (74.2188) kd_loss 0.0335 (0.0465) lr 3.6258e-04 eta 0:15:54
epoch [38/50] batch [40/288] time 0.169 (0.211) data 0.000 (0.008) loss 0.5180 (1.0453) ce_loss 0.3333 (0.9013) teacher_loss 0.3339 (0.8951) loss_zs_kd 0.2266 (0.1514) loss_oracle 0.0708 (0.0744) acc 90.6250 (75.7812) kd_loss 0.0434 (0.0473) lr 3.6258e-04 eta 0:13:01
epoch [38/50] batch [60/288] time 0.166 (0.194) data 0.000 (0.005) loss 0.8268 (1.0503) ce_loss 0.7017 (0.9055) teacher_loss 0.7093 (0.9005) loss_zs_kd 0.1494 (0.1512) loss_oracle 0.0428 (0.0743) acc 81.2500 (75.7292) kd_loss 0.0298 (0.0460) lr 3.6258e-04 eta 0:11:53
epoch [38/50] batch [80/288] time 0.165 (0.185) data 0.000 (0.004) loss 1.0925 (1.0601) ce_loss 0.9858 (0.9159) teacher_loss 0.9856 (0.9117) loss_zs_kd 0.0977 (0.1501) loss_oracle 0.0581 (0.0734) acc 78.1250 (75.2734) kd_loss 0.0322 (0.0451) lr 3.6258e-04 eta 0:11:17
epoch [38/50] batch [100/288] time 0.144 (0.179) data 0.000 (0.003) loss 1.0931 (1.0805) ce_loss 0.9277 (0.9362) teacher_loss 0.9406 (0.9316) loss_zs_kd 0.1204 (0.1494) loss_oracle 0.0923 (0.0742) acc 81.2500 (74.8750) kd_loss 0.0552 (0.0456) lr 3.6258e-04 eta 0:10:52
epoch [38/50] batch [120/288] time 0.148 (0.175) data 0.000 (0.003) loss 1.5481 (1.0881) ce_loss 1.4082 (0.9446) teacher_loss 1.4034 (0.9402) loss_zs_kd 0.1557 (0.1485) loss_oracle 0.0668 (0.0737) acc 65.6250 (74.4531) kd_loss 0.0402 (0.0453) lr 3.6258e-04 eta 0:10:32
epoch [38/50] batch [140/288] time 0.089 (0.170) data 0.000 (0.002) loss 0.9242 (1.0953) ce_loss 0.7671 (0.9506) teacher_loss 0.7552 (0.9458) loss_zs_kd 0.1504 (0.1499) loss_oracle 0.0939 (0.0746) acc 84.3750 (74.2634) kd_loss 0.0523 (0.0455) lr 3.6258e-04 eta 0:10:12
epoch [38/50] batch [160/288] time 0.390 (0.177) data 0.000 (0.002) loss 0.7161 (1.1058) ce_loss 0.5947 (0.9600) teacher_loss 0.5885 (0.9551) loss_zs_kd 0.1186 (0.1510) loss_oracle 0.0683 (0.0752) acc 84.3750 (73.9648) kd_loss 0.0466 (0.0457) lr 3.6258e-04 eta 0:10:35
epoch [38/50] batch [180/288] time 0.151 (0.177) data 0.000 (0.002) loss 1.2051 (1.1146) ce_loss 1.0332 (0.9670) teacher_loss 1.0153 (0.9622) loss_zs_kd 0.1904 (0.1530) loss_oracle 0.0947 (0.0759) acc 78.1250 (73.9757) kd_loss 0.0622 (0.0458) lr 3.6258e-04 eta 0:10:30
epoch [38/50] batch [200/288] time 0.146 (0.175) data 0.000 (0.002) loss 0.8550 (1.1026) ce_loss 0.7266 (0.9553) teacher_loss 0.7224 (0.9505) loss_zs_kd 0.1043 (0.1517) loss_oracle 0.0804 (0.0762) acc 75.0000 (74.3906) kd_loss 0.0463 (0.0458) lr 3.6258e-04 eta 0:10:19
epoch [38/50] batch [220/288] time 0.145 (0.173) data 0.000 (0.002) loss 0.7655 (1.0995) ce_loss 0.5947 (0.9519) teacher_loss 0.5843 (0.9468) loss_zs_kd 0.1593 (0.1514) loss_oracle 0.1016 (0.0770) acc 81.2500 (74.5028) kd_loss 0.0581 (0.0461) lr 3.6258e-04 eta 0:10:10
epoch [38/50] batch [240/288] time 0.146 (0.172) data 0.000 (0.001) loss 0.6596 (1.0989) ce_loss 0.4983 (0.9511) teacher_loss 0.5022 (0.9458) loss_zs_kd 0.1318 (0.1517) loss_oracle 0.0915 (0.0773) acc 84.3750 (74.6615) kd_loss 0.0552 (0.0463) lr 3.6258e-04 eta 0:10:02
epoch [38/50] batch [260/288] time 0.168 (0.171) data 0.000 (0.001) loss 1.0528 (1.0971) ce_loss 0.9375 (0.9496) teacher_loss 0.9188 (0.9442) loss_zs_kd 0.1149 (0.1512) loss_oracle 0.0765 (0.0773) acc 81.2500 (74.6875) kd_loss 0.0450 (0.0462) lr 3.6258e-04 eta 0:09:54
epoch [38/50] batch [280/288] time 0.133 (0.170) data 0.000 (0.001) loss 0.7482 (1.0912) ce_loss 0.5942 (0.9435) teacher_loss 0.5935 (0.9379) loss_zs_kd 0.1163 (0.1504) loss_oracle 0.0966 (0.0782) acc 84.3750 (74.8214) kd_loss 0.0667 (0.0467) lr 3.6258e-04 eta 0:09:48
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,437
* accuracy: 87.3%
* error: 12.7%
* macro_f1: 86.6%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,011
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 79.6%
******* Domain a best val acc:      87.3%, epoch: 38 *******
******* Domain a best val test acc: 82.9%, epoch: 38 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [39/50] batch [20/288] time 0.149 (0.178) data 0.000 (0.016) loss 1.0474 (1.0303) ce_loss 0.9067 (0.8879) teacher_loss 0.8922 (0.8792) loss_zs_kd 0.1357 (0.1432) loss_oracle 0.0873 (0.0796) acc 71.8750 (75.0000) kd_loss 0.0532 (0.0483) lr 3.1545e-04 eta 0:10:11
epoch [39/50] batch [40/288] time 0.153 (0.169) data 0.000 (0.008) loss 1.3034 (1.0686) ce_loss 1.1514 (0.9209) teacher_loss 1.1179 (0.9146) loss_zs_kd 0.1788 (0.1489) loss_oracle 0.0961 (0.0796) acc 62.5000 (75.0781) kd_loss 0.0578 (0.0495) lr 3.1545e-04 eta 0:09:38
epoch [39/50] batch [60/288] time 0.159 (0.167) data 0.000 (0.005) loss 0.9288 (1.0647) ce_loss 0.7778 (0.9194) teacher_loss 0.7674 (0.9118) loss_zs_kd 0.0996 (0.1454) loss_oracle 0.1117 (0.0802) acc 75.0000 (74.6354) kd_loss 0.0572 (0.0494) lr 3.1545e-04 eta 0:09:28
epoch [39/50] batch [80/288] time 0.182 (0.167) data 0.000 (0.004) loss 1.4569 (1.0640) ce_loss 1.3086 (0.9170) teacher_loss 1.2771 (0.9100) loss_zs_kd 0.1268 (0.1463) loss_oracle 0.1164 (0.0808) acc 62.5000 (75.1172) kd_loss 0.0598 (0.0493) lr 3.1545e-04 eta 0:09:25
epoch [39/50] batch [100/288] time 0.087 (0.168) data 0.000 (0.003) loss 1.0345 (1.0688) ce_loss 0.8931 (0.9213) teacher_loss 0.8990 (0.9148) loss_zs_kd 0.1385 (0.1465) loss_oracle 0.0663 (0.0807) acc 71.8750 (74.8438) kd_loss 0.0452 (0.0496) lr 3.1545e-04 eta 0:09:22
epoch [39/50] batch [120/288] time 0.174 (0.177) data 0.000 (0.003) loss 0.7378 (1.0736) ce_loss 0.5928 (0.9269) teacher_loss 0.6105 (0.9207) loss_zs_kd 0.1247 (0.1463) loss_oracle 0.0650 (0.0798) acc 84.3750 (74.6875) kd_loss 0.0430 (0.0493) lr 3.1545e-04 eta 0:09:50
epoch [39/50] batch [140/288] time 0.150 (0.174) data 0.000 (0.002) loss 1.2389 (1.0746) ce_loss 1.1104 (0.9267) teacher_loss 1.0864 (0.9199) loss_zs_kd 0.1754 (0.1495) loss_oracle 0.0648 (0.0800) acc 68.7500 (74.6429) kd_loss 0.0393 (0.0496) lr 3.1545e-04 eta 0:09:36
epoch [39/50] batch [160/288] time 0.166 (0.172) data 0.000 (0.002) loss 1.1688 (1.0706) ce_loss 1.0215 (0.9232) teacher_loss 1.0213 (0.9169) loss_zs_kd 0.1651 (0.1495) loss_oracle 0.0649 (0.0790) acc 75.0000 (74.9414) kd_loss 0.0435 (0.0489) lr 3.1545e-04 eta 0:09:26
epoch [39/50] batch [180/288] time 0.171 (0.170) data 0.000 (0.002) loss 0.9329 (1.0675) ce_loss 0.7529 (0.9202) teacher_loss 0.7654 (0.9139) loss_zs_kd 0.1808 (0.1486) loss_oracle 0.0771 (0.0792) acc 78.1250 (74.8785) kd_loss 0.0535 (0.0492) lr 3.1545e-04 eta 0:09:17
epoch [39/50] batch [200/288] time 0.168 (0.169) data 0.000 (0.002) loss 0.8470 (1.0780) ce_loss 0.6802 (0.9301) teacher_loss 0.6902 (0.9243) loss_zs_kd 0.1704 (0.1489) loss_oracle 0.0715 (0.0793) acc 78.1250 (74.6250) kd_loss 0.0519 (0.0490) lr 3.1545e-04 eta 0:09:08
epoch [39/50] batch [220/288] time 0.174 (0.168) data 0.000 (0.002) loss 1.4083 (1.0759) ce_loss 1.2588 (0.9283) teacher_loss 1.2367 (0.9226) loss_zs_kd 0.1739 (0.1483) loss_oracle 0.0846 (0.0792) acc 75.0000 (74.8722) kd_loss 0.0468 (0.0489) lr 3.1545e-04 eta 0:09:02
epoch [39/50] batch [240/288] time 0.083 (0.169) data 0.000 (0.001) loss 0.9202 (1.0787) ce_loss 0.7363 (0.9305) teacher_loss 0.7370 (0.9245) loss_zs_kd 0.1808 (0.1497) loss_oracle 0.0928 (0.0794) acc 71.8750 (74.6615) kd_loss 0.0534 (0.0488) lr 3.1545e-04 eta 0:09:02
epoch [39/50] batch [260/288] time 0.165 (0.171) data 0.000 (0.001) loss 0.6403 (1.0786) ce_loss 0.5200 (0.9310) teacher_loss 0.5113 (0.9249) loss_zs_kd 0.0995 (0.1488) loss_oracle 0.0792 (0.0792) acc 87.5000 (74.5913) kd_loss 0.0475 (0.0486) lr 3.1545e-04 eta 0:09:06
epoch [39/50] batch [280/288] time 0.169 (0.170) data 0.000 (0.001) loss 0.9547 (1.0768) ce_loss 0.8452 (0.9293) teacher_loss 0.8384 (0.9233) loss_zs_kd 0.1104 (0.1487) loss_oracle 0.0611 (0.0791) acc 78.1250 (74.6094) kd_loss 0.0280 (0.0484) lr 3.1545e-04 eta 0:09:00
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,435
* accuracy: 87.2%
* error: 12.8%
* macro_f1: 86.6%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,023
* accuracy: 83.4%
* error: 16.6%
* macro_f1: 80.2%
******* Domain a best val acc:      87.3%, epoch: 38 *******
******* Domain a best val test acc: 82.9%, epoch: 38 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [40/50] batch [20/288] time 0.146 (0.177) data 0.000 (0.014) loss 0.9494 (1.0554) ce_loss 0.8218 (0.9133) teacher_loss 0.8262 (0.9092) loss_zs_kd 0.1277 (0.1445) loss_oracle 0.0594 (0.0739) acc 78.1250 (76.0938) kd_loss 0.0295 (0.0432) lr 2.7103e-04 eta 0:09:17
epoch [40/50] batch [40/288] time 0.164 (0.167) data 0.000 (0.007) loss 1.3944 (1.0944) ce_loss 1.2197 (0.9462) teacher_loss 1.2195 (0.9414) loss_zs_kd 0.2066 (0.1511) loss_oracle 0.0716 (0.0775) acc 68.7500 (74.4531) kd_loss 0.0354 (0.0449) lr 2.7103e-04 eta 0:08:42
epoch [40/50] batch [60/288] time 0.346 (0.172) data 0.001 (0.005) loss 0.9393 (1.0720) ce_loss 0.8135 (0.9258) teacher_loss 0.8034 (0.9209) loss_zs_kd 0.1483 (0.1476) loss_oracle 0.0618 (0.0773) acc 78.1250 (74.8958) kd_loss 0.0459 (0.0456) lr 2.7103e-04 eta 0:08:56
epoch [40/50] batch [80/288] time 0.176 (0.179) data 0.000 (0.004) loss 1.3495 (1.0809) ce_loss 1.1826 (0.9320) teacher_loss 1.1875 (0.9269) loss_zs_kd 0.1685 (0.1497) loss_oracle 0.0778 (0.0791) acc 68.7500 (74.7656) kd_loss 0.0495 (0.0468) lr 2.7103e-04 eta 0:09:13
epoch [40/50] batch [100/288] time 0.172 (0.177) data 0.000 (0.003) loss 1.0874 (1.0862) ce_loss 0.9453 (0.9386) teacher_loss 0.9334 (0.9329) loss_zs_kd 0.1255 (0.1478) loss_oracle 0.0912 (0.0794) acc 68.7500 (74.4688) kd_loss 0.0536 (0.0469) lr 2.7103e-04 eta 0:09:01
epoch [40/50] batch [120/288] time 0.146 (0.174) data 0.000 (0.002) loss 1.1082 (1.0829) ce_loss 0.9131 (0.9344) teacher_loss 0.9236 (0.9285) loss_zs_kd 0.1760 (0.1486) loss_oracle 0.0966 (0.0800) acc 78.1250 (74.7135) kd_loss 0.0517 (0.0475) lr 2.7103e-04 eta 0:08:49
epoch [40/50] batch [140/288] time 0.150 (0.171) data 0.000 (0.002) loss 1.1159 (1.0844) ce_loss 0.9932 (0.9357) teacher_loss 1.0022 (0.9298) loss_zs_kd 0.1095 (0.1481) loss_oracle 0.0589 (0.0806) acc 68.7500 (74.7098) kd_loss 0.0312 (0.0480) lr 2.7103e-04 eta 0:08:38
epoch [40/50] batch [160/288] time 0.151 (0.170) data 0.000 (0.002) loss 1.4180 (1.0852) ce_loss 1.2666 (0.9363) teacher_loss 1.2601 (0.9302) loss_zs_kd 0.1679 (0.1492) loss_oracle 0.0739 (0.0804) acc 71.8750 (74.7852) kd_loss 0.0429 (0.0476) lr 2.7103e-04 eta 0:08:30
epoch [40/50] batch [180/288] time 0.166 (0.168) data 0.000 (0.002) loss 0.8560 (1.0946) ce_loss 0.7153 (0.9458) teacher_loss 0.6986 (0.9400) loss_zs_kd 0.1521 (0.1497) loss_oracle 0.0813 (0.0799) acc 84.3750 (74.6528) kd_loss 0.0590 (0.0475) lr 2.7103e-04 eta 0:08:22
epoch [40/50] batch [200/288] time 0.342 (0.170) data 0.001 (0.002) loss 1.1346 (1.0871) ce_loss 0.9155 (0.9383) teacher_loss 0.9006 (0.9327) loss_zs_kd 0.2014 (0.1494) loss_oracle 0.1333 (0.0797) acc 65.6250 (74.8125) kd_loss 0.0768 (0.0474) lr 2.7103e-04 eta 0:08:24
epoch [40/50] batch [220/288] time 0.173 (0.174) data 0.000 (0.001) loss 0.8829 (1.0876) ce_loss 0.7964 (0.9388) teacher_loss 0.7993 (0.9331) loss_zs_kd 0.0695 (0.1500) loss_oracle 0.0488 (0.0794) acc 81.2500 (74.8295) kd_loss 0.0364 (0.0473) lr 2.7103e-04 eta 0:08:34
epoch [40/50] batch [240/288] time 0.164 (0.173) data 0.000 (0.001) loss 0.7264 (1.0783) ce_loss 0.5610 (0.9296) teacher_loss 0.5555 (0.9239) loss_zs_kd 0.1785 (0.1496) loss_oracle 0.0816 (0.0796) acc 84.3750 (75.0781) kd_loss 0.0495 (0.0477) lr 2.7103e-04 eta 0:08:27
epoch [40/50] batch [260/288] time 0.150 (0.172) data 0.000 (0.001) loss 1.2752 (1.0736) ce_loss 1.0938 (0.9244) teacher_loss 1.0821 (0.9190) loss_zs_kd 0.1996 (0.1508) loss_oracle 0.0932 (0.0793) acc 65.6250 (75.1562) kd_loss 0.0530 (0.0474) lr 2.7103e-04 eta 0:08:20
epoch [40/50] batch [280/288] time 0.157 (0.171) data 0.000 (0.001) loss 1.2331 (1.0707) ce_loss 1.0811 (0.9218) teacher_loss 1.0554 (0.9165) loss_zs_kd 0.2039 (0.1503) loss_oracle 0.0757 (0.0790) acc 78.1250 (75.1674) kd_loss 0.0387 (0.0473) lr 2.7103e-04 eta 0:08:13
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,435
* accuracy: 87.2%
* error: 12.8%
* macro_f1: 86.6%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,012
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 79.6%
******* Domain a best val acc:      87.3%, epoch: 38 *******
******* Domain a best val test acc: 82.9%, epoch: 38 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [41/50] batch [20/288] time 0.087 (0.240) data 0.000 (0.015) loss 0.8745 (1.0771) ce_loss 0.6982 (0.9207) teacher_loss 0.7000 (0.9116) loss_zs_kd 0.1705 (0.1670) loss_oracle 0.0892 (0.0820) acc 78.1250 (75.9375) kd_loss 0.0510 (0.0502) lr 2.2949e-04 eta 0:11:27
epoch [41/50] batch [40/288] time 0.166 (0.199) data 0.000 (0.007) loss 0.9552 (1.0731) ce_loss 0.8140 (0.9243) teacher_loss 0.8094 (0.9171) loss_zs_kd 0.1534 (0.1532) loss_oracle 0.0691 (0.0794) acc 78.1250 (75.4688) kd_loss 0.0402 (0.0476) lr 2.2949e-04 eta 0:09:25
epoch [41/50] batch [60/288] time 0.175 (0.188) data 0.001 (0.005) loss 1.2887 (1.0858) ce_loss 1.1152 (0.9371) teacher_loss 1.1214 (0.9318) loss_zs_kd 0.1623 (0.1483) loss_oracle 0.0861 (0.0798) acc 75.0000 (75.1042) kd_loss 0.0452 (0.0471) lr 2.2949e-04 eta 0:08:50
epoch [41/50] batch [80/288] time 0.142 (0.180) data 0.000 (0.004) loss 0.6590 (1.0892) ce_loss 0.5273 (0.9415) teacher_loss 0.5268 (0.9359) loss_zs_kd 0.1151 (0.1455) loss_oracle 0.0746 (0.0806) acc 78.1250 (75.1562) kd_loss 0.0435 (0.0472) lr 2.2949e-04 eta 0:08:23
epoch [41/50] batch [100/288] time 0.175 (0.178) data 0.000 (0.003) loss 1.5394 (1.0937) ce_loss 1.3730 (0.9439) teacher_loss 1.3767 (0.9394) loss_zs_kd 0.1710 (0.1486) loss_oracle 0.0772 (0.0800) acc 59.3750 (74.8438) kd_loss 0.0387 (0.0464) lr 2.2949e-04 eta 0:08:13
epoch [41/50] batch [120/288] time 0.086 (0.176) data 0.000 (0.003) loss 1.3810 (1.0917) ce_loss 1.2285 (0.9418) teacher_loss 1.2176 (0.9362) loss_zs_kd 0.1962 (0.1481) loss_oracle 0.0653 (0.0815) acc 65.6250 (74.7917) kd_loss 0.0495 (0.0475) lr 2.2949e-04 eta 0:08:04
epoch [41/50] batch [140/288] time 0.405 (0.182) data 0.000 (0.002) loss 1.2747 (1.0854) ce_loss 1.1523 (0.9348) teacher_loss 1.1513 (0.9297) loss_zs_kd 0.1166 (0.1479) loss_oracle 0.0651 (0.0818) acc 68.7500 (75.0446) kd_loss 0.0463 (0.0477) lr 2.2949e-04 eta 0:08:18
epoch [41/50] batch [160/288] time 0.150 (0.182) data 0.000 (0.002) loss 0.7600 (1.0747) ce_loss 0.6357 (0.9252) teacher_loss 0.6441 (0.9204) loss_zs_kd 0.1062 (0.1470) loss_oracle 0.0629 (0.0808) acc 87.5000 (75.1953) kd_loss 0.0411 (0.0475) lr 2.2949e-04 eta 0:08:13
epoch [41/50] batch [180/288] time 0.156 (0.180) data 0.000 (0.002) loss 1.8220 (1.0738) ce_loss 1.6230 (0.9240) teacher_loss 1.6017 (0.9188) loss_zs_kd 0.2372 (0.1477) loss_oracle 0.1017 (0.0811) acc 62.5000 (75.3299) kd_loss 0.0666 (0.0477) lr 2.2949e-04 eta 0:08:05
epoch [41/50] batch [200/288] time 0.141 (0.177) data 0.000 (0.002) loss 1.1171 (1.0755) ce_loss 0.9429 (0.9260) teacher_loss 0.9326 (0.9204) loss_zs_kd 0.1498 (0.1482) loss_oracle 0.1096 (0.0810) acc 65.6250 (75.4062) kd_loss 0.0637 (0.0480) lr 2.2949e-04 eta 0:07:55
epoch [41/50] batch [220/288] time 0.146 (0.175) data 0.000 (0.002) loss 1.0614 (1.0746) ce_loss 0.8804 (0.9245) teacher_loss 0.8812 (0.9188) loss_zs_kd 0.1993 (0.1491) loss_oracle 0.0806 (0.0812) acc 81.2500 (75.4688) kd_loss 0.0509 (0.0482) lr 2.2949e-04 eta 0:07:46
epoch [41/50] batch [240/288] time 0.165 (0.173) data 0.000 (0.001) loss 1.0829 (1.0734) ce_loss 0.9019 (0.9238) teacher_loss 0.8891 (0.9182) loss_zs_kd 0.1807 (0.1474) loss_oracle 0.1034 (0.0815) acc 84.3750 (75.5859) kd_loss 0.0563 (0.0484) lr 2.2949e-04 eta 0:07:37
epoch [41/50] batch [260/288] time 0.163 (0.172) data 0.000 (0.001) loss 1.6820 (1.0759) ce_loss 1.5098 (0.9265) teacher_loss 1.4858 (0.9206) loss_zs_kd 0.1829 (0.1474) loss_oracle 0.1047 (0.0816) acc 62.5000 (75.4087) kd_loss 0.0615 (0.0485) lr 2.2949e-04 eta 0:07:30
epoch [41/50] batch [280/288] time 0.084 (0.172) data 0.000 (0.001) loss 0.8253 (1.0756) ce_loss 0.6904 (0.9269) teacher_loss 0.7007 (0.9213) loss_zs_kd 0.1530 (0.1469) loss_oracle 0.0480 (0.0809) acc 81.2500 (75.2902) kd_loss 0.0398 (0.0483) lr 2.2949e-04 eta 0:07:26
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,430
* accuracy: 87.1%
* error: 12.9%
* macro_f1: 86.5%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,013
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 79.7%
******* Domain a best val acc:      87.3%, epoch: 38 *******
******* Domain a best val test acc: 82.9%, epoch: 38 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [42/50] batch [20/288] time 0.147 (0.172) data 0.000 (0.015) loss 0.9176 (1.0423) ce_loss 0.7983 (0.8989) teacher_loss 0.7860 (0.8955) loss_zs_kd 0.1192 (0.1378) loss_oracle 0.0720 (0.0779) acc 81.2500 (76.7188) kd_loss 0.0361 (0.0478) lr 1.9098e-04 eta 0:07:22
epoch [42/50] batch [40/288] time 0.168 (0.166) data 0.000 (0.008) loss 1.0075 (1.0673) ce_loss 0.8735 (0.9219) teacher_loss 0.8819 (0.9183) loss_zs_kd 0.1434 (0.1418) loss_oracle 0.0539 (0.0781) acc 78.1250 (76.4062) kd_loss 0.0300 (0.0467) lr 1.9098e-04 eta 0:07:03
epoch [42/50] batch [60/288] time 0.158 (0.162) data 0.000 (0.005) loss 1.4341 (1.0954) ce_loss 1.2979 (0.9459) teacher_loss 1.3000 (0.9405) loss_zs_kd 0.1334 (0.1483) loss_oracle 0.0674 (0.0808) acc 68.7500 (75.8333) kd_loss 0.0367 (0.0488) lr 1.9098e-04 eta 0:06:49
epoch [42/50] batch [80/288] time 0.107 (0.159) data 0.000 (0.004) loss 0.8953 (1.0803) ce_loss 0.7207 (0.9300) teacher_loss 0.7154 (0.9248) loss_zs_kd 0.1394 (0.1495) loss_oracle 0.1102 (0.0809) acc 78.1250 (75.4297) kd_loss 0.0707 (0.0489) lr 1.9098e-04 eta 0:06:38
epoch [42/50] batch [100/288] time 0.345 (0.170) data 0.000 (0.003) loss 1.0245 (1.0948) ce_loss 0.8755 (0.9430) teacher_loss 0.8786 (0.9390) loss_zs_kd 0.1777 (0.1515) loss_oracle 0.0570 (0.0800) acc 78.1250 (75.0000) kd_loss 0.0362 (0.0478) lr 1.9098e-04 eta 0:07:04
epoch [42/50] batch [120/288] time 0.144 (0.171) data 0.000 (0.003) loss 0.8124 (1.0681) ce_loss 0.6650 (0.9177) teacher_loss 0.6473 (0.9134) loss_zs_kd 0.1804 (0.1484) loss_oracle 0.0749 (0.0805) acc 75.0000 (75.5208) kd_loss 0.0404 (0.0474) lr 1.9098e-04 eta 0:07:02
epoch [42/50] batch [140/288] time 0.165 (0.169) data 0.000 (0.002) loss 1.2649 (1.0639) ce_loss 1.0850 (0.9133) teacher_loss 1.0617 (0.9081) loss_zs_kd 0.1601 (0.1499) loss_oracle 0.1232 (0.0809) acc 59.3750 (75.6696) kd_loss 0.0768 (0.0472) lr 1.9098e-04 eta 0:06:54
epoch [42/50] batch [160/288] time 0.164 (0.169) data 0.000 (0.002) loss 1.2941 (1.0687) ce_loss 1.1152 (0.9172) teacher_loss 1.1059 (0.9122) loss_zs_kd 0.2071 (0.1510) loss_oracle 0.0847 (0.0810) acc 71.8750 (75.5273) kd_loss 0.0566 (0.0472) lr 1.9098e-04 eta 0:06:50
epoch [42/50] batch [180/288] time 0.153 (0.168) data 0.000 (0.002) loss 1.1607 (1.0652) ce_loss 0.9863 (0.9140) teacher_loss 0.9863 (0.9088) loss_zs_kd 0.1957 (0.1508) loss_oracle 0.0766 (0.0810) acc 75.0000 (75.5903) kd_loss 0.0432 (0.0473) lr 1.9098e-04 eta 0:06:45
epoch [42/50] batch [200/288] time 0.164 (0.167) data 0.000 (0.002) loss 1.0334 (1.0661) ce_loss 0.8867 (0.9148) teacher_loss 0.8728 (0.9092) loss_zs_kd 0.1319 (0.1508) loss_oracle 0.0946 (0.0814) acc 71.8750 (75.7188) kd_loss 0.0593 (0.0475) lr 1.9098e-04 eta 0:06:39
epoch [42/50] batch [220/288] time 0.088 (0.166) data 0.000 (0.002) loss 1.0342 (1.0704) ce_loss 0.8936 (0.9190) teacher_loss 0.8955 (0.9134) loss_zs_kd 0.1348 (0.1505) loss_oracle 0.0712 (0.0818) acc 78.1250 (75.5540) kd_loss 0.0504 (0.0476) lr 1.9098e-04 eta 0:06:33
epoch [42/50] batch [240/288] time 0.344 (0.172) data 0.000 (0.001) loss 1.1178 (1.0682) ce_loss 0.9727 (0.9176) teacher_loss 0.9445 (0.9119) loss_zs_kd 0.1471 (0.1499) loss_oracle 0.0997 (0.0814) acc 78.1250 (75.6641) kd_loss 0.0620 (0.0473) lr 1.9098e-04 eta 0:06:44
epoch [42/50] batch [260/288] time 0.176 (0.172) data 0.000 (0.001) loss 1.2895 (1.0731) ce_loss 1.1289 (0.9225) teacher_loss 1.1163 (0.9165) loss_zs_kd 0.1755 (0.1500) loss_oracle 0.0855 (0.0816) acc 78.1250 (75.5048) kd_loss 0.0505 (0.0475) lr 1.9098e-04 eta 0:06:40
epoch [42/50] batch [280/288] time 0.143 (0.171) data 0.000 (0.001) loss 0.9722 (1.0674) ce_loss 0.8423 (0.9170) teacher_loss 0.8477 (0.9115) loss_zs_kd 0.1287 (0.1493) loss_oracle 0.0601 (0.0812) acc 87.5000 (75.7031) kd_loss 0.0448 (0.0472) lr 1.9098e-04 eta 0:06:34
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,434
* accuracy: 87.2%
* error: 12.8%
* macro_f1: 86.6%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,010
* accuracy: 82.8%
* error: 17.2%
* macro_f1: 79.5%
******* Domain a best val acc:      87.3%, epoch: 38 *******
******* Domain a best val test acc: 82.9%, epoch: 38 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [43/50] batch [20/288] time 0.147 (0.176) data 0.000 (0.015) loss 1.3825 (1.1368) ce_loss 1.2549 (0.9894) teacher_loss 1.2302 (0.9776) loss_zs_kd 0.1332 (0.1513) loss_oracle 0.0857 (0.0835) acc 68.7500 (71.8750) kd_loss 0.0417 (0.0519) lr 1.5567e-04 eta 0:06:43
epoch [43/50] batch [40/288] time 0.333 (0.180) data 0.000 (0.008) loss 1.1686 (1.1113) ce_loss 1.0234 (0.9622) teacher_loss 1.0217 (0.9537) loss_zs_kd 0.1491 (0.1536) loss_oracle 0.0723 (0.0808) acc 71.8750 (73.1250) kd_loss 0.0378 (0.0495) lr 1.5567e-04 eta 0:06:47
epoch [43/50] batch [60/288] time 0.139 (0.189) data 0.000 (0.005) loss 1.8382 (1.1307) ce_loss 1.7021 (0.9790) teacher_loss 1.6967 (0.9715) loss_zs_kd 0.1575 (0.1582) loss_oracle 0.0627 (0.0801) acc 53.1250 (72.9688) kd_loss 0.0371 (0.0492) lr 1.5567e-04 eta 0:07:03
epoch [43/50] batch [80/288] time 0.164 (0.182) data 0.000 (0.004) loss 0.6796 (1.0816) ce_loss 0.5527 (0.9326) teacher_loss 0.5633 (0.9260) loss_zs_kd 0.0696 (0.1505) loss_oracle 0.0815 (0.0804) acc 87.5000 (74.4922) kd_loss 0.0453 (0.0495) lr 1.5567e-04 eta 0:06:43
epoch [43/50] batch [100/288] time 0.173 (0.177) data 0.000 (0.003) loss 1.4470 (1.0890) ce_loss 1.2822 (0.9408) teacher_loss 1.2708 (0.9344) loss_zs_kd 0.1681 (0.1489) loss_oracle 0.0922 (0.0801) acc 68.7500 (74.0000) kd_loss 0.0564 (0.0493) lr 1.5567e-04 eta 0:06:30
epoch [43/50] batch [120/288] time 0.165 (0.174) data 0.000 (0.003) loss 0.8671 (1.0875) ce_loss 0.7090 (0.9369) teacher_loss 0.7154 (0.9310) loss_zs_kd 0.1332 (0.1513) loss_oracle 0.0851 (0.0809) acc 75.0000 (74.4010) kd_loss 0.0529 (0.0498) lr 1.5567e-04 eta 0:06:21
epoch [43/50] batch [140/288] time 0.158 (0.173) data 0.000 (0.002) loss 0.8810 (1.0861) ce_loss 0.6968 (0.9350) teacher_loss 0.6903 (0.9284) loss_zs_kd 0.1715 (0.1514) loss_oracle 0.1050 (0.0820) acc 84.3750 (74.6205) kd_loss 0.0657 (0.0505) lr 1.5567e-04 eta 0:06:14
epoch [43/50] batch [160/288] time 0.101 (0.170) data 0.000 (0.002) loss 0.9541 (1.0803) ce_loss 0.8179 (0.9284) teacher_loss 0.8111 (0.9223) loss_zs_kd 0.1356 (0.1517) loss_oracle 0.0751 (0.0821) acc 75.0000 (74.7266) kd_loss 0.0453 (0.0506) lr 1.5567e-04 eta 0:06:04
epoch [43/50] batch [180/288] time 0.090 (0.180) data 0.000 (0.002) loss 0.8684 (1.0712) ce_loss 0.7188 (0.9195) teacher_loss 0.7169 (0.9139) loss_zs_kd 0.1179 (0.1507) loss_oracle 0.0926 (0.0820) acc 81.2500 (74.8958) kd_loss 0.0501 (0.0506) lr 1.5567e-04 eta 0:06:23
epoch [43/50] batch [200/288] time 0.153 (0.178) data 0.000 (0.002) loss 0.9935 (1.0737) ce_loss 0.8530 (0.9216) teacher_loss 0.8484 (0.9166) loss_zs_kd 0.1618 (0.1508) loss_oracle 0.0642 (0.0817) acc 84.3750 (74.8906) kd_loss 0.0336 (0.0503) lr 1.5567e-04 eta 0:06:14
epoch [43/50] batch [220/288] time 0.156 (0.176) data 0.000 (0.002) loss 1.0542 (1.0748) ce_loss 0.8794 (0.9230) teacher_loss 0.8783 (0.9179) loss_zs_kd 0.1663 (0.1506) loss_oracle 0.0928 (0.0816) acc 68.7500 (74.9148) kd_loss 0.0504 (0.0501) lr 1.5567e-04 eta 0:06:06
epoch [43/50] batch [240/288] time 0.165 (0.174) data 0.000 (0.001) loss 1.1591 (1.0708) ce_loss 0.9678 (0.9190) teacher_loss 0.9667 (0.9138) loss_zs_kd 0.2195 (0.1502) loss_oracle 0.0827 (0.0819) acc 68.7500 (74.9089) kd_loss 0.0532 (0.0502) lr 1.5567e-04 eta 0:05:59
epoch [43/50] batch [260/288] time 0.165 (0.173) data 0.000 (0.001) loss 0.8759 (1.0708) ce_loss 0.7476 (0.9190) teacher_loss 0.7389 (0.9137) loss_zs_kd 0.1539 (0.1502) loss_oracle 0.0601 (0.0819) acc 78.1250 (74.8798) kd_loss 0.0370 (0.0504) lr 1.5567e-04 eta 0:05:53
epoch [43/50] batch [280/288] time 0.162 (0.171) data 0.000 (0.001) loss 1.0613 (1.0702) ce_loss 0.9263 (0.9186) teacher_loss 0.9081 (0.9135) loss_zs_kd 0.1483 (0.1502) loss_oracle 0.0790 (0.0817) acc 78.1250 (74.8884) kd_loss 0.0449 (0.0501) lr 1.5567e-04 eta 0:05:47
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,435
* accuracy: 87.2%
* error: 12.8%
* macro_f1: 86.6%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,012
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 79.7%
******* Domain a best val acc:      87.3%, epoch: 38 *******
******* Domain a best val test acc: 82.9%, epoch: 38 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [44/50] batch [20/288] time 0.174 (0.183) data 0.000 (0.013) loss 1.2793 (1.0735) ce_loss 1.1406 (0.9235) teacher_loss 1.1366 (0.9194) loss_zs_kd 0.1327 (0.1479) loss_oracle 0.0763 (0.0801) acc 65.6250 (74.2188) kd_loss 0.0425 (0.0483) lr 1.2369e-04 eta 0:06:04
epoch [44/50] batch [40/288] time 0.161 (0.172) data 0.000 (0.007) loss 0.8750 (1.1093) ce_loss 0.7256 (0.9595) teacher_loss 0.7293 (0.9550) loss_zs_kd 0.1470 (0.1463) loss_oracle 0.0722 (0.0812) acc 81.2500 (73.5938) kd_loss 0.0555 (0.0499) lr 1.2369e-04 eta 0:05:39
epoch [44/50] batch [60/288] time 0.163 (0.166) data 0.000 (0.005) loss 0.8409 (1.0942) ce_loss 0.7139 (0.9428) teacher_loss 0.7069 (0.9372) loss_zs_kd 0.0947 (0.1508) loss_oracle 0.0867 (0.0817) acc 81.2500 (74.1146) kd_loss 0.0645 (0.0503) lr 1.2369e-04 eta 0:05:25
epoch [44/50] batch [80/288] time 0.166 (0.164) data 0.000 (0.003) loss 1.2259 (1.0902) ce_loss 1.0645 (0.9386) teacher_loss 1.0643 (0.9333) loss_zs_kd 0.1895 (0.1499) loss_oracle 0.0668 (0.0819) acc 75.0000 (74.1016) kd_loss 0.0446 (0.0504) lr 1.2369e-04 eta 0:05:17
epoch [44/50] batch [100/288] time 0.149 (0.162) data 0.000 (0.003) loss 1.1695 (1.0811) ce_loss 1.0244 (0.9297) teacher_loss 1.0178 (0.9242) loss_zs_kd 0.1303 (0.1495) loss_oracle 0.0866 (0.0822) acc 75.0000 (74.5938) kd_loss 0.0534 (0.0505) lr 1.2369e-04 eta 0:05:10
epoch [44/50] batch [120/288] time 0.091 (0.166) data 0.000 (0.002) loss 1.1482 (1.0710) ce_loss 0.9707 (0.9206) teacher_loss 0.9608 (0.9156) loss_zs_kd 0.2107 (0.1485) loss_oracle 0.0820 (0.0812) acc 71.8750 (75.1042) kd_loss 0.0430 (0.0500) lr 1.2369e-04 eta 0:05:15
epoch [44/50] batch [140/288] time 0.171 (0.174) data 0.000 (0.002) loss 1.0205 (1.0726) ce_loss 0.8369 (0.9220) teacher_loss 0.8355 (0.9169) loss_zs_kd 0.1637 (0.1488) loss_oracle 0.1031 (0.0813) acc 81.2500 (75.3348) kd_loss 0.0550 (0.0498) lr 1.2369e-04 eta 0:05:25
epoch [44/50] batch [160/288] time 0.151 (0.171) data 0.000 (0.002) loss 1.2469 (1.0766) ce_loss 1.0977 (0.9269) teacher_loss 1.1056 (0.9220) loss_zs_kd 0.1473 (0.1491) loss_oracle 0.0676 (0.0801) acc 62.5000 (75.0977) kd_loss 0.0381 (0.0491) lr 1.2369e-04 eta 0:05:17
epoch [44/50] batch [180/288] time 0.142 (0.169) data 0.000 (0.002) loss 0.9493 (1.0847) ce_loss 0.8164 (0.9345) teacher_loss 0.8023 (0.9295) loss_zs_kd 0.1205 (0.1493) loss_oracle 0.0867 (0.0806) acc 78.1250 (74.9653) kd_loss 0.0543 (0.0493) lr 1.2369e-04 eta 0:05:10
epoch [44/50] batch [200/288] time 0.148 (0.167) data 0.000 (0.002) loss 0.9179 (1.0858) ce_loss 0.7759 (0.9348) teacher_loss 0.7865 (0.9299) loss_zs_kd 0.1488 (0.1512) loss_oracle 0.0570 (0.0803) acc 78.1250 (74.8906) kd_loss 0.0304 (0.0492) lr 1.2369e-04 eta 0:05:03
epoch [44/50] batch [220/288] time 0.149 (0.166) data 0.000 (0.001) loss 1.0033 (1.0879) ce_loss 0.8862 (0.9381) teacher_loss 0.8749 (0.9329) loss_zs_kd 0.1397 (0.1506) loss_oracle 0.0587 (0.0797) acc 75.0000 (74.8153) kd_loss 0.0425 (0.0489) lr 1.2369e-04 eta 0:04:58
epoch [44/50] batch [240/288] time 0.148 (0.166) data 0.000 (0.001) loss 1.0392 (1.0995) ce_loss 0.9106 (0.9496) teacher_loss 0.8900 (0.9442) loss_zs_kd 0.1457 (0.1504) loss_oracle 0.0764 (0.0801) acc 75.0000 (74.4792) kd_loss 0.0456 (0.0489) lr 1.2369e-04 eta 0:04:55
epoch [44/50] batch [260/288] time 0.330 (0.165) data 0.000 (0.001) loss 1.4557 (1.0956) ce_loss 1.3525 (0.9461) teacher_loss 1.3440 (0.9405) loss_zs_kd 0.1156 (0.1497) loss_oracle 0.0538 (0.0803) acc 68.7500 (74.5553) kd_loss 0.0424 (0.0490) lr 1.2369e-04 eta 0:04:49
epoch [44/50] batch [280/288] time 0.084 (0.172) data 0.000 (0.001) loss 1.3907 (1.0947) ce_loss 1.2441 (0.9448) teacher_loss 1.2492 (0.9394) loss_zs_kd 0.1252 (0.1503) loss_oracle 0.0789 (0.0801) acc 65.6250 (74.4978) kd_loss 0.0500 (0.0487) lr 1.2369e-04 eta 0:04:57
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,441
* accuracy: 87.4%
* error: 12.6%
* macro_f1: 86.7%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,013
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 79.7%
******* Domain a best val acc:      87.4%, epoch: 44 *******
******* Domain a best val test acc: 82.9%, epoch: 44 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [45/50] batch [20/288] time 0.173 (0.190) data 0.000 (0.017) loss 1.3171 (1.0913) ce_loss 1.1846 (0.9343) teacher_loss 1.1793 (0.9293) loss_zs_kd 0.1102 (0.1547) loss_oracle 0.0827 (0.0846) acc 62.5000 (75.1562) kd_loss 0.0497 (0.0503) lr 9.5173e-05 eta 0:05:23
epoch [45/50] batch [40/288] time 0.164 (0.177) data 0.000 (0.009) loss 0.8483 (1.0326) ce_loss 0.7456 (0.8790) teacher_loss 0.7392 (0.8767) loss_zs_kd 0.0726 (0.1514) loss_oracle 0.0728 (0.0802) acc 78.1250 (76.3281) kd_loss 0.0498 (0.0483) lr 9.5173e-05 eta 0:04:58
epoch [45/50] batch [60/288] time 0.102 (0.165) data 0.000 (0.006) loss 0.6756 (1.0346) ce_loss 0.5151 (0.8823) teacher_loss 0.5165 (0.8783) loss_zs_kd 0.1359 (0.1477) loss_oracle 0.0911 (0.0825) acc 84.3750 (76.4583) kd_loss 0.0621 (0.0494) lr 9.5173e-05 eta 0:04:35
epoch [45/50] batch [80/288] time 0.342 (0.186) data 0.000 (0.004) loss 0.7265 (1.0452) ce_loss 0.5928 (0.8948) teacher_loss 0.5967 (0.8898) loss_zs_kd 0.1098 (0.1458) loss_oracle 0.0749 (0.0825) acc 84.3750 (75.9766) kd_loss 0.0494 (0.0503) lr 9.5173e-05 eta 0:05:06
epoch [45/50] batch [100/288] time 0.172 (0.181) data 0.000 (0.004) loss 1.5382 (1.0393) ce_loss 1.3975 (0.8896) teacher_loss 1.3914 (0.8846) loss_zs_kd 0.1337 (0.1455) loss_oracle 0.0799 (0.0819) acc 59.3750 (75.9062) kd_loss 0.0486 (0.0505) lr 9.5173e-05 eta 0:04:54
epoch [45/50] batch [120/288] time 0.171 (0.179) data 0.000 (0.003) loss 0.9328 (1.0484) ce_loss 0.8018 (0.8984) teacher_loss 0.8000 (0.8930) loss_zs_kd 0.1307 (0.1476) loss_oracle 0.0674 (0.0816) acc 81.2500 (75.8333) kd_loss 0.0449 (0.0500) lr 9.5173e-05 eta 0:04:48
epoch [45/50] batch [140/288] time 0.157 (0.177) data 0.000 (0.003) loss 0.4752 (1.0521) ce_loss 0.3206 (0.9023) teacher_loss 0.3243 (0.8972) loss_zs_kd 0.1213 (0.1472) loss_oracle 0.0903 (0.0814) acc 87.5000 (75.8259) kd_loss 0.0573 (0.0496) lr 9.5173e-05 eta 0:04:41
epoch [45/50] batch [160/288] time 0.165 (0.176) data 0.000 (0.002) loss 1.0870 (1.0576) ce_loss 0.9199 (0.9064) teacher_loss 0.9357 (0.9011) loss_zs_kd 0.1834 (0.1491) loss_oracle 0.0596 (0.0820) acc 75.0000 (75.4883) kd_loss 0.0344 (0.0499) lr 9.5173e-05 eta 0:04:35
epoch [45/50] batch [180/288] time 0.141 (0.175) data 0.000 (0.002) loss 1.2779 (1.0629) ce_loss 1.1025 (0.9121) teacher_loss 1.1108 (0.9064) loss_zs_kd 0.2093 (0.1495) loss_oracle 0.0624 (0.0817) acc 65.6250 (75.1562) kd_loss 0.0373 (0.0497) lr 9.5173e-05 eta 0:04:30
epoch [45/50] batch [200/288] time 0.372 (0.180) data 0.000 (0.002) loss 0.7105 (1.0674) ce_loss 0.5728 (0.9159) teacher_loss 0.5765 (0.9098) loss_zs_kd 0.1167 (0.1500) loss_oracle 0.0757 (0.0825) acc 87.5000 (75.3281) kd_loss 0.0518 (0.0504) lr 9.5173e-05 eta 0:04:35
epoch [45/50] batch [220/288] time 0.151 (0.179) data 0.000 (0.002) loss 0.9279 (1.0620) ce_loss 0.7588 (0.9109) teacher_loss 0.7673 (0.9046) loss_zs_kd 0.1931 (0.1500) loss_oracle 0.0640 (0.0824) acc 84.3750 (75.4830) kd_loss 0.0308 (0.0504) lr 9.5173e-05 eta 0:04:30
epoch [45/50] batch [240/288] time 0.166 (0.177) data 0.000 (0.002) loss 1.0481 (1.0540) ce_loss 0.9038 (0.9031) teacher_loss 0.8994 (0.8970) loss_zs_kd 0.1231 (0.1492) loss_oracle 0.0872 (0.0824) acc 71.8750 (75.7682) kd_loss 0.0520 (0.0506) lr 9.5173e-05 eta 0:04:23
epoch [45/50] batch [260/288] time 0.170 (0.176) data 0.000 (0.002) loss 1.3910 (1.0528) ce_loss 1.1826 (0.9012) teacher_loss 1.1544 (0.8954) loss_zs_kd 0.2242 (0.1503) loss_oracle 0.1246 (0.0822) acc 68.7500 (75.8654) kd_loss 0.0767 (0.0505) lr 9.5173e-05 eta 0:04:18
epoch [45/50] batch [280/288] time 0.152 (0.174) data 0.000 (0.001) loss 1.1273 (1.0624) ce_loss 0.9521 (0.9103) teacher_loss 0.9545 (0.9044) loss_zs_kd 0.1617 (0.1511) loss_oracle 0.0919 (0.0825) acc 81.2500 (75.6696) kd_loss 0.0568 (0.0507) lr 9.5173e-05 eta 0:04:12
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,440
* accuracy: 87.3%
* error: 12.7%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,013
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 79.7%
******* Domain a best val acc:      87.4%, epoch: 44 *******
******* Domain a best val test acc: 82.9%, epoch: 44 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [46/50] batch [20/288] time 0.163 (0.254) data 0.000 (0.017) loss 0.8661 (1.0553) ce_loss 0.7275 (0.9059) teacher_loss 0.7071 (0.8992) loss_zs_kd 0.1220 (0.1467) loss_oracle 0.0979 (0.0827) acc 78.1250 (75.9375) kd_loss 0.0650 (0.0536) lr 7.0224e-05 eta 0:06:00
epoch [46/50] batch [40/288] time 0.194 (0.219) data 0.001 (0.009) loss 1.2179 (1.0991) ce_loss 1.0732 (0.9478) teacher_loss 1.0833 (0.9428) loss_zs_kd 0.1496 (0.1512) loss_oracle 0.0599 (0.0807) acc 71.8750 (75.8594) kd_loss 0.0362 (0.0519) lr 7.0224e-05 eta 0:05:06
epoch [46/50] batch [60/288] time 0.180 (0.204) data 0.000 (0.006) loss 0.9868 (1.1077) ce_loss 0.8315 (0.9523) teacher_loss 0.8284 (0.9469) loss_zs_kd 0.1552 (0.1558) loss_oracle 0.0808 (0.0829) acc 78.1250 (75.2604) kd_loss 0.0441 (0.0524) lr 7.0224e-05 eta 0:04:41
epoch [46/50] batch [80/288] time 0.162 (0.195) data 0.000 (0.004) loss 0.8902 (1.0795) ce_loss 0.7461 (0.9271) teacher_loss 0.7498 (0.9223) loss_zs_kd 0.1212 (0.1522) loss_oracle 0.0798 (0.0811) acc 81.2500 (75.8984) kd_loss 0.0452 (0.0516) lr 7.0224e-05 eta 0:04:25
epoch [46/50] batch [100/288] time 0.163 (0.189) data 0.000 (0.004) loss 0.8998 (1.0690) ce_loss 0.7500 (0.9168) teacher_loss 0.7558 (0.9132) loss_zs_kd 0.1501 (0.1518) loss_oracle 0.0689 (0.0799) acc 71.8750 (76.1250) kd_loss 0.0382 (0.0498) lr 7.0224e-05 eta 0:04:13
epoch [46/50] batch [120/288] time 0.102 (0.181) data 0.000 (0.003) loss 0.6658 (1.0727) ce_loss 0.4983 (0.9204) teacher_loss 0.4938 (0.9161) loss_zs_kd 0.1583 (0.1522) loss_oracle 0.0929 (0.0805) acc 84.3750 (75.8594) kd_loss 0.0546 (0.0499) lr 7.0224e-05 eta 0:03:59
epoch [46/50] batch [140/288] time 0.360 (0.192) data 0.000 (0.003) loss 0.9892 (1.0717) ce_loss 0.8550 (0.9201) teacher_loss 0.8405 (0.9153) loss_zs_kd 0.1457 (0.1519) loss_oracle 0.0759 (0.0805) acc 78.1250 (75.7812) kd_loss 0.0454 (0.0498) lr 7.0224e-05 eta 0:04:09
epoch [46/50] batch [160/288] time 0.175 (0.188) data 0.000 (0.002) loss 1.1034 (1.0639) ce_loss 0.9268 (0.9133) teacher_loss 0.9208 (0.9088) loss_zs_kd 0.2070 (0.1512) loss_oracle 0.0792 (0.0795) acc 75.0000 (75.7227) kd_loss 0.0563 (0.0493) lr 7.0224e-05 eta 0:04:01
epoch [46/50] batch [180/288] time 0.178 (0.187) data 0.000 (0.002) loss 1.1718 (1.0713) ce_loss 0.9873 (0.9207) teacher_loss 0.9830 (0.9157) loss_zs_kd 0.1954 (0.1518) loss_oracle 0.0912 (0.0797) acc 78.1250 (75.5208) kd_loss 0.0563 (0.0494) lr 7.0224e-05 eta 0:03:55
epoch [46/50] batch [200/288] time 0.173 (0.185) data 0.000 (0.002) loss 1.3253 (1.0811) ce_loss 1.2217 (0.9301) teacher_loss 1.2127 (0.9250) loss_zs_kd 0.0879 (0.1518) loss_oracle 0.0686 (0.0801) acc 71.8750 (75.2188) kd_loss 0.0454 (0.0497) lr 7.0224e-05 eta 0:03:49
epoch [46/50] batch [220/288] time 0.156 (0.183) data 0.000 (0.002) loss 1.0081 (1.0838) ce_loss 0.8677 (0.9328) teacher_loss 0.8682 (0.9278) loss_zs_kd 0.1378 (0.1509) loss_oracle 0.0710 (0.0805) acc 75.0000 (75.1136) kd_loss 0.0425 (0.0498) lr 7.0224e-05 eta 0:03:42
epoch [46/50] batch [240/288] time 0.099 (0.180) data 0.000 (0.002) loss 1.0094 (1.0857) ce_loss 0.8682 (0.9343) teacher_loss 0.8776 (0.9291) loss_zs_kd 0.1590 (0.1513) loss_oracle 0.0523 (0.0810) acc 75.0000 (75.1302) kd_loss 0.0379 (0.0500) lr 7.0224e-05 eta 0:03:36
epoch [46/50] batch [260/288] time 0.403 (0.187) data 0.000 (0.002) loss 0.9128 (1.0811) ce_loss 0.7676 (0.9295) teacher_loss 0.7660 (0.9243) loss_zs_kd 0.1179 (0.1517) loss_oracle 0.0879 (0.0809) acc 87.5000 (75.2524) kd_loss 0.0568 (0.0501) lr 7.0224e-05 eta 0:03:40
epoch [46/50] batch [280/288] time 0.165 (0.185) data 0.000 (0.001) loss 1.4398 (1.0843) ce_loss 1.2822 (0.9327) teacher_loss 1.2734 (0.9273) loss_zs_kd 0.1490 (0.1519) loss_oracle 0.0920 (0.0810) acc 65.6250 (75.1674) kd_loss 0.0507 (0.0501) lr 7.0224e-05 eta 0:03:34
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,438
* accuracy: 87.3%
* error: 12.7%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,012
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 79.6%
******* Domain a best val acc:      87.4%, epoch: 44 *******
******* Domain a best val test acc: 82.9%, epoch: 44 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [47/50] batch [20/288] time 0.158 (0.183) data 0.000 (0.015) loss 1.3039 (1.1005) ce_loss 1.1621 (0.9487) teacher_loss 1.1531 (0.9422) loss_zs_kd 0.1307 (0.1506) loss_oracle 0.0854 (0.0830) acc 68.7500 (75.1562) kd_loss 0.0476 (0.0520) lr 4.8943e-05 eta 0:03:27
epoch [47/50] batch [40/288] time 0.105 (0.167) data 0.000 (0.008) loss 1.3830 (1.0861) ce_loss 1.2383 (0.9410) teacher_loss 1.2182 (0.9353) loss_zs_kd 0.1320 (0.1430) loss_oracle 0.0988 (0.0793) acc 71.8750 (75.3125) kd_loss 0.0588 (0.0491) lr 4.8943e-05 eta 0:03:05
epoch [47/50] batch [60/288] time 0.344 (0.183) data 0.000 (0.005) loss 1.6677 (1.0888) ce_loss 1.5732 (0.9430) teacher_loss 1.5405 (0.9368) loss_zs_kd 0.1317 (0.1437) loss_oracle 0.0613 (0.0802) acc 62.5000 (75.4167) kd_loss 0.0503 (0.0498) lr 4.8943e-05 eta 0:03:20
epoch [47/50] batch [80/288] time 0.172 (0.186) data 0.000 (0.004) loss 1.1856 (1.0863) ce_loss 1.0469 (0.9375) teacher_loss 1.0553 (0.9310) loss_zs_kd 0.1331 (0.1463) loss_oracle 0.0637 (0.0822) acc 75.0000 (75.6641) kd_loss 0.0402 (0.0503) lr 4.8943e-05 eta 0:03:19
epoch [47/50] batch [100/288] time 0.170 (0.182) data 0.000 (0.003) loss 0.7863 (1.0790) ce_loss 0.6650 (0.9287) teacher_loss 0.6565 (0.9217) loss_zs_kd 0.1010 (0.1478) loss_oracle 0.0793 (0.0834) acc 78.1250 (75.3438) kd_loss 0.0486 (0.0509) lr 4.8943e-05 eta 0:03:11
epoch [47/50] batch [120/288] time 0.170 (0.178) data 0.000 (0.003) loss 1.3684 (1.0687) ce_loss 1.2188 (0.9177) teacher_loss 1.2111 (0.9112) loss_zs_kd 0.1186 (0.1487) loss_oracle 0.0979 (0.0831) acc 75.0000 (75.5729) kd_loss 0.0545 (0.0508) lr 4.8943e-05 eta 0:03:03
epoch [47/50] batch [140/288] time 0.149 (0.174) data 0.000 (0.002) loss 0.8610 (1.0700) ce_loss 0.7129 (0.9184) teacher_loss 0.7103 (0.9120) loss_zs_kd 0.1897 (0.1507) loss_oracle 0.0558 (0.0826) acc 71.8750 (75.4241) kd_loss 0.0347 (0.0504) lr 4.8943e-05 eta 0:02:56
epoch [47/50] batch [160/288] time 0.142 (0.172) data 0.000 (0.002) loss 1.1018 (1.0750) ce_loss 0.9121 (0.9222) teacher_loss 0.9111 (0.9160) loss_zs_kd 0.2389 (0.1525) loss_oracle 0.0713 (0.0827) acc 75.0000 (75.1562) kd_loss 0.0409 (0.0503) lr 4.8943e-05 eta 0:02:50
epoch [47/50] batch [180/288] time 0.175 (0.171) data 0.000 (0.002) loss 1.0340 (1.0774) ce_loss 0.9048 (0.9248) teacher_loss 0.8970 (0.9181) loss_zs_kd 0.1403 (0.1530) loss_oracle 0.0668 (0.0827) acc 68.7500 (74.8785) kd_loss 0.0433 (0.0503) lr 4.8943e-05 eta 0:02:45
epoch [47/50] batch [200/288] time 0.326 (0.176) data 0.000 (0.002) loss 0.5231 (1.0760) ce_loss 0.3926 (0.9240) teacher_loss 0.3940 (0.9176) loss_zs_kd 0.1086 (0.1510) loss_oracle 0.0747 (0.0829) acc 84.3750 (75.0156) kd_loss 0.0450 (0.0504) lr 4.8943e-05 eta 0:02:47
epoch [47/50] batch [220/288] time 0.162 (0.177) data 0.000 (0.002) loss 0.8897 (1.0812) ce_loss 0.7539 (0.9287) teacher_loss 0.7406 (0.9222) loss_zs_kd 0.1537 (0.1520) loss_oracle 0.0723 (0.0830) acc 78.1250 (75.0426) kd_loss 0.0448 (0.0504) lr 4.8943e-05 eta 0:02:44
epoch [47/50] batch [240/288] time 0.172 (0.175) data 0.000 (0.001) loss 0.7649 (1.0804) ce_loss 0.6123 (0.9279) teacher_loss 0.6147 (0.9217) loss_zs_kd 0.1283 (0.1524) loss_oracle 0.0861 (0.0825) acc 84.3750 (75.0391) kd_loss 0.0389 (0.0499) lr 4.8943e-05 eta 0:02:39
epoch [47/50] batch [260/288] time 0.145 (0.174) data 0.000 (0.001) loss 1.5408 (1.0820) ce_loss 1.3184 (0.9291) teacher_loss 1.3319 (0.9232) loss_zs_kd 0.2347 (0.1527) loss_oracle 0.0916 (0.0825) acc 68.7500 (75.0120) kd_loss 0.0630 (0.0500) lr 4.8943e-05 eta 0:02:35
epoch [47/50] batch [280/288] time 0.164 (0.173) data 0.000 (0.001) loss 0.6502 (1.0852) ce_loss 0.5195 (0.9323) teacher_loss 0.5170 (0.9263) loss_zs_kd 0.1171 (0.1531) loss_oracle 0.0746 (0.0824) acc 90.6250 (74.9554) kd_loss 0.0421 (0.0499) lr 4.8943e-05 eta 0:02:30
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,439
* accuracy: 87.3%
* error: 12.7%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,011
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 79.6%
******* Domain a best val acc:      87.4%, epoch: 44 *******
******* Domain a best val test acc: 82.9%, epoch: 44 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [48/50] batch [20/288] time 0.152 (0.248) data 0.000 (0.016) loss 1.2096 (1.1611) ce_loss 1.0371 (1.0019) teacher_loss 1.0441 (1.0003) loss_zs_kd 0.1511 (0.1562) loss_oracle 0.0899 (0.0827) acc 62.5000 (72.0312) kd_loss 0.0536 (0.0485) lr 3.1417e-05 eta 0:03:28
epoch [48/50] batch [40/288] time 0.163 (0.204) data 0.000 (0.008) loss 1.4090 (1.1233) ce_loss 1.2354 (0.9707) teacher_loss 1.2321 (0.9672) loss_zs_kd 0.1733 (0.1538) loss_oracle 0.0903 (0.0791) acc 65.6250 (73.7500) kd_loss 0.0558 (0.0473) lr 3.1417e-05 eta 0:02:48
epoch [48/50] batch [60/288] time 0.146 (0.189) data 0.000 (0.005) loss 1.1825 (1.1024) ce_loss 1.0488 (0.9455) teacher_loss 1.0560 (0.9418) loss_zs_kd 0.1411 (0.1618) loss_oracle 0.0559 (0.0797) acc 71.8750 (74.5833) kd_loss 0.0410 (0.0479) lr 3.1417e-05 eta 0:02:31
epoch [48/50] batch [80/288] time 0.148 (0.181) data 0.001 (0.004) loss 1.2531 (1.0966) ce_loss 1.0664 (0.9421) teacher_loss 1.0653 (0.9379) loss_zs_kd 0.1620 (0.1574) loss_oracle 0.1068 (0.0800) acc 75.0000 (74.4922) kd_loss 0.0639 (0.0482) lr 3.1417e-05 eta 0:02:21
epoch [48/50] batch [100/288] time 0.170 (0.176) data 0.000 (0.003) loss 0.9917 (1.0825) ce_loss 0.8647 (0.9295) teacher_loss 0.8592 (0.9248) loss_zs_kd 0.1141 (0.1558) loss_oracle 0.0755 (0.0798) acc 75.0000 (74.6875) kd_loss 0.0466 (0.0484) lr 3.1417e-05 eta 0:02:14
epoch [48/50] batch [120/288] time 0.138 (0.173) data 0.000 (0.003) loss 1.2105 (1.0829) ce_loss 1.0654 (0.9303) teacher_loss 1.0171 (0.9253) loss_zs_kd 0.2083 (0.1547) loss_oracle 0.0893 (0.0802) acc 68.7500 (74.5312) kd_loss 0.0551 (0.0486) lr 3.1417e-05 eta 0:02:09
epoch [48/50] batch [140/288] time 0.349 (0.175) data 0.000 (0.002) loss 0.9786 (1.0823) ce_loss 0.8384 (0.9306) teacher_loss 0.8409 (0.9254) loss_zs_kd 0.1563 (0.1542) loss_oracle 0.0595 (0.0798) acc 81.2500 (74.5536) kd_loss 0.0438 (0.0485) lr 3.1417e-05 eta 0:02:06
epoch [48/50] batch [160/288] time 0.178 (0.179) data 0.000 (0.002) loss 1.1125 (1.0916) ce_loss 0.9751 (0.9394) teacher_loss 0.9679 (0.9334) loss_zs_kd 0.1151 (0.1547) loss_oracle 0.0870 (0.0808) acc 68.7500 (74.3750) kd_loss 0.0581 (0.0489) lr 3.1417e-05 eta 0:02:06
epoch [48/50] batch [180/288] time 0.167 (0.178) data 0.000 (0.002) loss 0.8691 (1.0832) ce_loss 0.7236 (0.9306) teacher_loss 0.7259 (0.9248) loss_zs_kd 0.1412 (0.1554) loss_oracle 0.0726 (0.0807) acc 84.3750 (74.6181) kd_loss 0.0430 (0.0488) lr 3.1417e-05 eta 0:02:01
epoch [48/50] batch [200/288] time 0.168 (0.176) data 0.000 (0.002) loss 0.9049 (1.0831) ce_loss 0.7529 (0.9306) teacher_loss 0.7633 (0.9244) loss_zs_kd 0.1586 (0.1551) loss_oracle 0.0623 (0.0812) acc 84.3750 (74.7031) kd_loss 0.0314 (0.0493) lr 3.1417e-05 eta 0:01:56
epoch [48/50] batch [220/288] time 0.169 (0.175) data 0.000 (0.002) loss 1.0057 (1.0818) ce_loss 0.8398 (0.9287) teacher_loss 0.8238 (0.9223) loss_zs_kd 0.1659 (0.1553) loss_oracle 0.0989 (0.0818) acc 81.2500 (74.8438) kd_loss 0.0628 (0.0498) lr 3.1417e-05 eta 0:01:52
epoch [48/50] batch [240/288] time 0.153 (0.174) data 0.000 (0.002) loss 1.1542 (1.0828) ce_loss 1.0225 (0.9298) teacher_loss 1.0227 (0.9230) loss_zs_kd 0.1373 (0.1555) loss_oracle 0.0628 (0.0821) acc 75.0000 (74.7786) kd_loss 0.0351 (0.0498) lr 3.1417e-05 eta 0:01:48
epoch [48/50] batch [260/288] time 0.403 (0.175) data 0.000 (0.001) loss 1.1026 (1.0804) ce_loss 0.9653 (0.9280) teacher_loss 0.9499 (0.9214) loss_zs_kd 0.1553 (0.1547) loss_oracle 0.0750 (0.0816) acc 78.1250 (74.8317) kd_loss 0.0487 (0.0495) lr 3.1417e-05 eta 0:01:45
epoch [48/50] batch [280/288] time 0.174 (0.178) data 0.000 (0.001) loss 0.9984 (1.0777) ce_loss 0.8188 (0.9254) teacher_loss 0.8070 (0.9188) loss_zs_kd 0.1516 (0.1549) loss_oracle 0.1156 (0.0815) acc 84.3750 (74.9330) kd_loss 0.0749 (0.0492) lr 3.1417e-05 eta 0:01:43
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,439
* accuracy: 87.3%
* error: 12.7%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,010
* accuracy: 82.8%
* error: 17.2%
* macro_f1: 79.5%
******* Domain a best val acc:      87.4%, epoch: 44 *******
******* Domain a best val test acc: 82.9%, epoch: 44 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [49/50] batch [20/288] time 0.148 (0.193) data 0.000 (0.015) loss 1.1051 (1.0288) ce_loss 0.9688 (0.8773) teacher_loss 0.9480 (0.8715) loss_zs_kd 0.1352 (0.1567) loss_oracle 0.0895 (0.0789) acc 68.7500 (75.7812) kd_loss 0.0523 (0.0450) lr 1.7713e-05 eta 0:01:47
epoch [49/50] batch [40/288] time 0.181 (0.177) data 0.000 (0.008) loss 1.4494 (1.0508) ce_loss 1.3047 (0.9045) teacher_loss 1.3053 (0.8971) loss_zs_kd 0.1455 (0.1522) loss_oracle 0.0714 (0.0776) acc 59.3750 (75.3125) kd_loss 0.0477 (0.0454) lr 1.7713e-05 eta 0:01:35
epoch [49/50] batch [60/288] time 0.208 (0.177) data 0.000 (0.005) loss 0.6627 (1.0505) ce_loss 0.5195 (0.9006) teacher_loss 0.5211 (0.8938) loss_zs_kd 0.1391 (0.1546) loss_oracle 0.0720 (0.0794) acc 87.5000 (75.7292) kd_loss 0.0509 (0.0470) lr 1.7713e-05 eta 0:01:31
epoch [49/50] batch [80/288] time 0.165 (0.191) data 0.000 (0.004) loss 1.1553 (1.0404) ce_loss 0.9873 (0.8890) teacher_loss 0.9889 (0.8808) loss_zs_kd 0.1512 (0.1552) loss_oracle 0.0909 (0.0820) acc 71.8750 (76.3672) kd_loss 0.0526 (0.0498) lr 1.7713e-05 eta 0:01:34
epoch [49/50] batch [100/288] time 0.163 (0.185) data 0.000 (0.003) loss 0.7124 (1.0558) ce_loss 0.5332 (0.9023) teacher_loss 0.5217 (0.8949) loss_zs_kd 0.1476 (0.1566) loss_oracle 0.1170 (0.0826) acc 90.6250 (76.0625) kd_loss 0.0657 (0.0504) lr 1.7713e-05 eta 0:01:27
epoch [49/50] batch [120/288] time 0.161 (0.181) data 0.000 (0.003) loss 1.1467 (1.0623) ce_loss 0.9966 (0.9092) teacher_loss 0.9929 (0.9019) loss_zs_kd 0.1445 (0.1551) loss_oracle 0.0816 (0.0828) acc 75.0000 (75.8333) kd_loss 0.0447 (0.0510) lr 1.7713e-05 eta 0:01:22
epoch [49/50] batch [140/288] time 0.172 (0.178) data 0.000 (0.002) loss 1.4727 (1.0625) ce_loss 1.2656 (0.9081) teacher_loss 1.2694 (0.9013) loss_zs_kd 0.1987 (0.1563) loss_oracle 0.1039 (0.0831) acc 68.7500 (75.7589) kd_loss 0.0571 (0.0512) lr 1.7713e-05 eta 0:01:17
epoch [49/50] batch [160/288] time 0.156 (0.176) data 0.000 (0.002) loss 0.8564 (1.0588) ce_loss 0.7144 (0.9050) teacher_loss 0.7161 (0.8986) loss_zs_kd 0.1438 (0.1548) loss_oracle 0.0684 (0.0828) acc 81.2500 (75.7812) kd_loss 0.0438 (0.0510) lr 1.7713e-05 eta 0:01:13
epoch [49/50] batch [180/288] time 0.404 (0.178) data 0.000 (0.002) loss 1.3446 (1.0537) ce_loss 1.1426 (0.8995) teacher_loss 1.1586 (0.8936) loss_zs_kd 0.2422 (0.1545) loss_oracle 0.0650 (0.0828) acc 68.7500 (75.9028) kd_loss 0.0278 (0.0508) lr 1.7713e-05 eta 0:01:10
epoch [49/50] batch [200/288] time 0.149 (0.182) data 0.000 (0.002) loss 1.7039 (1.0657) ce_loss 1.5713 (0.9118) teacher_loss 1.5809 (0.9060) loss_zs_kd 0.1537 (0.1545) loss_oracle 0.0461 (0.0824) acc 59.3750 (75.5938) kd_loss 0.0249 (0.0507) lr 1.7713e-05 eta 0:01:08
epoch [49/50] batch [220/288] time 0.168 (0.180) data 0.000 (0.002) loss 1.2576 (1.0716) ce_loss 1.0977 (0.9175) teacher_loss 1.0984 (0.9119) loss_zs_kd 0.1630 (0.1547) loss_oracle 0.0777 (0.0823) acc 68.7500 (75.5540) kd_loss 0.0502 (0.0505) lr 1.7713e-05 eta 0:01:04
epoch [49/50] batch [240/288] time 0.167 (0.178) data 0.000 (0.001) loss 0.7789 (1.0698) ce_loss 0.6250 (0.9158) teacher_loss 0.6302 (0.9103) loss_zs_kd 0.1485 (0.1544) loss_oracle 0.0744 (0.0823) acc 81.2500 (75.6120) kd_loss 0.0524 (0.0506) lr 1.7713e-05 eta 0:00:59
epoch [49/50] batch [260/288] time 0.165 (0.177) data 0.000 (0.001) loss 1.1912 (1.0610) ce_loss 1.0156 (0.9076) teacher_loss 1.0199 (0.9023) loss_zs_kd 0.1779 (0.1533) loss_oracle 0.0823 (0.0820) acc 78.1250 (75.9135) kd_loss 0.0481 (0.0504) lr 1.7713e-05 eta 0:00:55
epoch [49/50] batch [280/288] time 0.156 (0.176) data 0.000 (0.001) loss 0.6926 (1.0542) ce_loss 0.5693 (0.9015) teacher_loss 0.5724 (0.8962) loss_zs_kd 0.1130 (0.1526) loss_oracle 0.0638 (0.0817) acc 84.3750 (75.9375) kd_loss 0.0393 (0.0502) lr 1.7713e-05 eta 0:00:52
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,439
* accuracy: 87.3%
* error: 12.7%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,011
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 79.6%
******* Domain a best val acc:      87.4%, epoch: 44 *******
******* Domain a best val test acc: 82.9%, epoch: 44 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
epoch [50/50] batch [20/288] time 0.171 (0.175) data 0.000 (0.015) loss 1.2325 (0.9867) ce_loss 1.0840 (0.8320) teacher_loss 1.0623 (0.8259) loss_zs_kd 0.1192 (0.1532) loss_oracle 0.1106 (0.0842) acc 71.8750 (77.3438) kd_loss 0.0673 (0.0540) lr 7.8853e-06 eta 0:00:46
epoch [50/50] batch [40/288] time 0.151 (0.166) data 0.000 (0.007) loss 1.2094 (1.0517) ce_loss 1.0693 (0.8983) teacher_loss 1.0348 (0.8924) loss_zs_kd 0.1660 (0.1534) loss_oracle 0.0915 (0.0825) acc 68.7500 (75.8594) kd_loss 0.0560 (0.0527) lr 7.8853e-06 eta 0:00:41
epoch [50/50] batch [60/288] time 0.154 (0.166) data 0.000 (0.005) loss 0.9482 (1.0509) ce_loss 0.7925 (0.9007) teacher_loss 0.7802 (0.8950) loss_zs_kd 0.1493 (0.1494) loss_oracle 0.0934 (0.0811) acc 78.1250 (76.0417) kd_loss 0.0640 (0.0510) lr 7.8853e-06 eta 0:00:37
epoch [50/50] batch [80/288] time 0.147 (0.164) data 0.000 (0.004) loss 0.9093 (1.0660) ce_loss 0.7456 (0.9146) teacher_loss 0.7544 (0.9099) loss_zs_kd 0.1301 (0.1505) loss_oracle 0.0899 (0.0809) acc 75.0000 (75.2344) kd_loss 0.0517 (0.0501) lr 7.8853e-06 eta 0:00:34
epoch [50/50] batch [100/288] time 0.153 (0.163) data 0.000 (0.003) loss 1.2982 (1.0835) ce_loss 1.1533 (0.9325) teacher_loss 1.1321 (0.9261) loss_zs_kd 0.1586 (0.1518) loss_oracle 0.0868 (0.0815) acc 75.0000 (75.0625) kd_loss 0.0473 (0.0501) lr 7.8853e-06 eta 0:00:30
epoch [50/50] batch [120/288] time 0.110 (0.159) data 0.000 (0.003) loss 0.9333 (1.0807) ce_loss 0.8101 (0.9294) teacher_loss 0.8011 (0.9234) loss_zs_kd 0.1456 (0.1518) loss_oracle 0.0594 (0.0815) acc 75.0000 (75.1042) kd_loss 0.0402 (0.0499) lr 7.8853e-06 eta 0:00:26
epoch [50/50] batch [140/288] time 0.085 (0.174) data 0.000 (0.002) loss 1.3645 (1.0771) ce_loss 1.1973 (0.9241) teacher_loss 1.1732 (0.9180) loss_zs_kd 0.1780 (0.1549) loss_oracle 0.1022 (0.0816) acc 68.7500 (75.2902) kd_loss 0.0658 (0.0501) lr 7.8853e-06 eta 0:00:25
epoch [50/50] batch [160/288] time 0.177 (0.173) data 0.000 (0.002) loss 0.9673 (1.0662) ce_loss 0.8306 (0.9139) teacher_loss 0.8173 (0.9082) loss_zs_kd 0.1103 (0.1531) loss_oracle 0.0948 (0.0815) acc 78.1250 (75.5078) kd_loss 0.0575 (0.0500) lr 7.8853e-06 eta 0:00:22
epoch [50/50] batch [180/288] time 0.168 (0.173) data 0.000 (0.002) loss 1.1853 (1.0825) ce_loss 1.0312 (0.9301) teacher_loss 1.0311 (0.9244) loss_zs_kd 0.1638 (0.1537) loss_oracle 0.0724 (0.0813) acc 78.1250 (75.3472) kd_loss 0.0445 (0.0498) lr 7.8853e-06 eta 0:00:18
epoch [50/50] batch [200/288] time 0.158 (0.172) data 0.000 (0.002) loss 1.2074 (1.0861) ce_loss 1.0771 (0.9339) teacher_loss 1.0598 (0.9282) loss_zs_kd 0.1187 (0.1539) loss_oracle 0.0882 (0.0810) acc 59.3750 (75.3125) kd_loss 0.0506 (0.0493) lr 7.8853e-06 eta 0:00:15
epoch [50/50] batch [220/288] time 0.159 (0.170) data 0.000 (0.002) loss 0.8136 (1.0822) ce_loss 0.6768 (0.9296) teacher_loss 0.6623 (0.9240) loss_zs_kd 0.1225 (0.1545) loss_oracle 0.0901 (0.0810) acc 71.8750 (75.2557) kd_loss 0.0511 (0.0491) lr 7.8853e-06 eta 0:00:11
epoch [50/50] batch [240/288] time 0.170 (0.170) data 0.000 (0.001) loss 0.9200 (1.0904) ce_loss 0.7710 (0.9377) teacher_loss 0.7765 (0.9323) loss_zs_kd 0.1201 (0.1542) loss_oracle 0.0835 (0.0810) acc 78.1250 (75.1562) kd_loss 0.0467 (0.0489) lr 7.8853e-06 eta 0:00:08
epoch [50/50] batch [260/288] time 0.347 (0.171) data 0.000 (0.001) loss 0.7981 (1.0961) ce_loss 0.6606 (0.9433) teacher_loss 0.6548 (0.9380) loss_zs_kd 0.1356 (0.1546) loss_oracle 0.0755 (0.0808) acc 78.1250 (74.9760) kd_loss 0.0458 (0.0486) lr 7.8853e-06 eta 0:00:04
epoch [50/50] batch [280/288] time 0.084 (0.171) data 0.000 (0.001) loss 1.4373 (1.0913) ce_loss 1.2549 (0.9382) teacher_loss 1.2521 (0.9328) loss_zs_kd 0.1576 (0.1545) loss_oracle 0.1065 (0.0813) acc 59.3750 (75.0893) kd_loss 0.0586 (0.0489) lr 7.8853e-06 eta 0:00:01
Evaluate on the *val* set
=> result
* total: 3,939
* correct: 3,440
* accuracy: 87.3%
* error: 12.7%
* macro_f1: 86.7%
Evaluate on the *test* set
=> result
* total: 2,427
* correct: 2,012
* accuracy: 82.9%
* error: 17.1%
* macro_f1: 79.6%
******* Domain a best val acc:      87.4%, epoch: 44 *******
******* Domain a best val test acc: 82.9%, epoch: 44 *******
******* Domain a best test acc:     83.5%, epoch: 4 *******
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/office_home/b32_ep50/ViT-B16/a/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:48:14
