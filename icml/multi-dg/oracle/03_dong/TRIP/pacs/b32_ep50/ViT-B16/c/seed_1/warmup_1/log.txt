Loading trainer: TRIP
Loading dataset: SPG_PACS
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -----------------------------------
Dataset    SPG_PACS
Source     ['art_painting', 'photo', 'sketch']
Target     ['cartoon']
# classes  7
# train_x  5,349
# val      2,297
# test     2,344
---------  -----------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/oracle/03_dong/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/167] time 0.079 (0.119) data 0.000 (0.019) loss 0.6000 (0.5504) ce_loss 0.5991 (0.5499) teacher_loss 0.5996 (0.5500) loss_zs_kd 0.0001 (0.0000) loss_oracle 0.0003 (0.0005) acc 84.3750 (80.1562) kd_loss 0.0011 (0.0017) lr 1.0000e-05 eta 0:16:35
epoch [1/50] batch [40/167] time 0.085 (0.104) data 0.001 (0.010) loss 0.7089 (0.5569) ce_loss 0.7090 (0.5564) teacher_loss 0.7083 (0.5564) loss_zs_kd 0.0008 (0.0002) loss_oracle 0.0002 (0.0003) acc 75.0000 (80.3125) kd_loss 0.0009 (0.0013) lr 1.0000e-05 eta 0:14:26
epoch [1/50] batch [60/167] time 0.093 (0.100) data 0.000 (0.007) loss 0.5877 (0.5332) ce_loss 0.5864 (0.5326) teacher_loss 0.5864 (0.5326) loss_zs_kd 0.0015 (0.0005) loss_oracle 0.0005 (0.0004) acc 75.0000 (81.5104) kd_loss 0.0021 (0.0014) lr 1.0000e-05 eta 0:13:50
epoch [1/50] batch [80/167] time 0.079 (0.095) data 0.000 (0.005) loss 0.6666 (0.5200) ce_loss 0.6646 (0.5191) teacher_loss 0.6647 (0.5191) loss_zs_kd 0.0025 (0.0009) loss_oracle 0.0006 (0.0004) acc 71.8750 (81.8750) kd_loss 0.0023 (0.0015) lr 1.0000e-05 eta 0:13:09
epoch [1/50] batch [100/167] time 0.084 (0.093) data 0.000 (0.004) loss 0.3047 (0.5074) ce_loss 0.3020 (0.5064) teacher_loss 0.3018 (0.5063) loss_zs_kd 0.0048 (0.0013) loss_oracle 0.0005 (0.0004) acc 87.5000 (82.2188) kd_loss 0.0020 (0.0016) lr 1.0000e-05 eta 0:12:49
epoch [1/50] batch [120/167] time 0.079 (0.092) data 0.000 (0.003) loss 0.5083 (0.5022) ce_loss 0.5049 (0.5009) teacher_loss 0.5051 (0.5008) loss_zs_kd 0.0050 (0.0019) loss_oracle 0.0007 (0.0004) acc 81.2500 (82.3698) kd_loss 0.0029 (0.0017) lr 1.0000e-05 eta 0:12:36
epoch [1/50] batch [140/167] time 0.082 (0.091) data 0.000 (0.003) loss 0.5684 (0.4941) ce_loss 0.5645 (0.4924) teacher_loss 0.5641 (0.4924) loss_zs_kd 0.0063 (0.0024) loss_oracle 0.0011 (0.0005) acc 75.0000 (82.5000) kd_loss 0.0042 (0.0020) lr 1.0000e-05 eta 0:12:26
epoch [1/50] batch [160/167] time 0.082 (0.090) data 0.000 (0.003) loss 0.3219 (0.4941) ce_loss 0.3181 (0.4920) teacher_loss 0.3182 (0.4919) loss_zs_kd 0.0058 (0.0031) loss_oracle 0.0008 (0.0006) acc 90.6250 (82.4609) kd_loss 0.0027 (0.0022) lr 1.0000e-05 eta 0:12:16
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,168
* accuracy: 94.4%
* error: 5.6%
* macro_f1: 95.0%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,327
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain c best val acc:      94.4%, epoch: 1 *******
******* Domain c best val test acc: 99.3%, epoch: 1 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/oracle/03_dong/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/ana
epoch [2/50] batch [20/167] time 0.090 (0.106) data 0.000 (0.017) loss 0.8186 (0.5217) ce_loss 0.7993 (0.4873) teacher_loss 0.7772 (0.4841) loss_zs_kd 0.0369 (0.0529) loss_oracle 0.0229 (0.0111) acc 71.8750 (82.5000) kd_loss 0.0831 (0.0198) lr 2.0000e-03 eta 0:14:23
epoch [2/50] batch [40/167] time 0.085 (0.095) data 0.000 (0.008) loss 0.3804 (0.4889) ce_loss 0.2791 (0.4380) teacher_loss 0.2246 (0.4238) loss_zs_kd 0.0792 (0.0538) loss_oracle 0.1163 (0.0382) acc 93.7500 (84.5312) kd_loss 0.2081 (0.0648) lr 2.0000e-03 eta 0:12:54
epoch [2/50] batch [60/167] time 0.089 (0.092) data 0.000 (0.006) loss 0.4315 (0.5274) ce_loss 0.2622 (0.4436) teacher_loss 0.2364 (0.4159) loss_zs_kd 0.0620 (0.0586) loss_oracle 0.1642 (0.0822) acc 87.5000 (84.3229) kd_loss 0.2753 (0.1231) lr 2.0000e-03 eta 0:12:29
epoch [2/50] batch [80/167] time 0.081 (0.091) data 0.000 (0.004) loss 0.5912 (0.5631) ce_loss 0.3484 (0.4542) teacher_loss 0.2187 (0.4043) loss_zs_kd 0.1282 (0.0672) loss_oracle 0.3085 (0.1253) acc 90.6250 (83.9453) kd_loss 0.4512 (0.1908) lr 2.0000e-03 eta 0:12:13
epoch [2/50] batch [100/167] time 0.094 (0.090) data 0.000 (0.004) loss 0.5354 (0.5704) ce_loss 0.2820 (0.4424) teacher_loss 0.1633 (0.3744) loss_zs_kd 0.0627 (0.0696) loss_oracle 0.3407 (0.1612) acc 87.5000 (84.1250) kd_loss 0.6135 (0.2564) lr 2.0000e-03 eta 0:12:10
epoch [2/50] batch [120/167] time 0.083 (0.089) data 0.000 (0.003) loss 0.7201 (0.5884) ce_loss 0.4075 (0.4409) teacher_loss 0.2658 (0.3599) loss_zs_kd 0.0503 (0.0727) loss_oracle 0.4291 (0.1922) acc 87.5000 (84.0885) kd_loss 0.6139 (0.3163) lr 2.0000e-03 eta 0:12:01
epoch [2/50] batch [140/167] time 0.087 (0.089) data 0.000 (0.003) loss 0.4872 (0.6175) ce_loss 0.1150 (0.4376) teacher_loss 0.1052 (0.3478) loss_zs_kd 0.0376 (0.0774) loss_oracle 0.3632 (0.2310) acc 96.8750 (84.3750) kd_loss 0.6983 (0.3686) lr 2.0000e-03 eta 0:11:54
epoch [2/50] batch [160/167] time 0.067 (0.088) data 0.000 (0.002) loss 0.7496 (0.6421) ce_loss 0.3765 (0.4411) teacher_loss 0.2359 (0.3454) loss_zs_kd 0.0928 (0.0764) loss_oracle 0.4672 (0.2585) acc 84.3750 (84.2578) kd_loss 0.8788 (0.4203) lr 2.0000e-03 eta 0:11:44
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,183
* accuracy: 95.0%
* error: 5.0%
* macro_f1: 95.6%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.0%, epoch: 2 *******
******* Domain c best val test acc: 99.1%, epoch: 2 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [3/50] batch [20/167] time 0.078 (0.099) data 0.000 (0.014) loss 0.7952 (0.8789) ce_loss 0.2791 (0.4115) teacher_loss 0.1748 (0.2605) loss_zs_kd 0.0480 (0.0960) loss_oracle 0.5964 (0.5704) acc 87.5000 (84.6875) kd_loss 0.9415 (0.9252) lr 1.9980e-03 eta 0:13:14
epoch [3/50] batch [40/167] time 0.082 (0.093) data 0.000 (0.007) loss 0.9075 (0.9051) ce_loss 0.6528 (0.4550) teacher_loss 0.2983 (0.2886) loss_zs_kd 0.0693 (0.0983) loss_oracle 0.5745 (0.5673) acc 78.1250 (83.0469) kd_loss 0.8819 (0.9198) lr 1.9980e-03 eta 0:12:21
epoch [3/50] batch [60/167] time 0.081 (0.090) data 0.000 (0.005) loss 0.7992 (0.8844) ce_loss 0.4099 (0.4547) teacher_loss 0.3449 (0.2945) loss_zs_kd 0.0656 (0.0962) loss_oracle 0.4215 (0.5418) acc 87.5000 (83.2292) kd_loss 0.7601 (0.9023) lr 1.9980e-03 eta 0:11:58
epoch [3/50] batch [80/167] time 0.085 (0.089) data 0.000 (0.004) loss 0.7089 (0.8692) ce_loss 0.3218 (0.4624) teacher_loss 0.2457 (0.3014) loss_zs_kd 0.0957 (0.0954) loss_oracle 0.4153 (0.5200) acc 93.7500 (83.1250) kd_loss 0.8574 (0.8956) lr 1.9980e-03 eta 0:11:44
epoch [3/50] batch [100/167] time 0.084 (0.088) data 0.000 (0.003) loss 0.5946 (0.8509) ce_loss 0.1890 (0.4538) teacher_loss 0.1386 (0.3021) loss_zs_kd 0.0771 (0.0930) loss_oracle 0.4174 (0.5023) acc 96.8750 (83.3438) kd_loss 0.9256 (0.8974) lr 1.9980e-03 eta 0:11:40
epoch [3/50] batch [120/167] time 0.085 (0.088) data 0.000 (0.003) loss 0.6513 (0.8344) ce_loss 0.3464 (0.4478) teacher_loss 0.2695 (0.3045) loss_zs_kd 0.0426 (0.0888) loss_oracle 0.3604 (0.4855) acc 87.5000 (83.5677) kd_loss 0.9249 (0.9019) lr 1.9980e-03 eta 0:11:36
epoch [3/50] batch [140/167] time 0.082 (0.087) data 0.000 (0.002) loss 0.5602 (0.8288) ce_loss 0.2129 (0.4500) teacher_loss 0.1759 (0.3128) loss_zs_kd 0.0500 (0.0871) loss_oracle 0.3593 (0.4724) acc 90.6250 (83.6607) kd_loss 0.9332 (0.9063) lr 1.9980e-03 eta 0:11:29
epoch [3/50] batch [160/167] time 0.083 (0.087) data 0.000 (0.002) loss 0.8255 (0.8304) ce_loss 0.3608 (0.4495) teacher_loss 0.3033 (0.3159) loss_zs_kd 0.0578 (0.0852) loss_oracle 0.4932 (0.4719) acc 87.5000 (83.7500) kd_loss 0.9402 (0.9106) lr 1.9980e-03 eta 0:11:22
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,185
* accuracy: 95.1%
* error: 4.9%
* macro_f1: 95.6%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,322
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
******* Domain c best val acc:      95.1%, epoch: 3 *******
******* Domain c best val test acc: 99.1%, epoch: 3 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [4/50] batch [20/167] time 0.087 (0.108) data 0.000 (0.017) loss 0.6169 (0.8290) ce_loss 0.1904 (0.4305) teacher_loss 0.1229 (0.3282) loss_zs_kd 0.0688 (0.0745) loss_oracle 0.4595 (0.4636) acc 93.7500 (84.3750) kd_loss 0.9928 (0.9627) lr 1.9921e-03 eta 0:14:01
epoch [4/50] batch [40/167] time 0.082 (0.098) data 0.000 (0.008) loss 1.0621 (0.8465) ce_loss 0.6240 (0.4477) teacher_loss 0.5077 (0.3444) loss_zs_kd 0.0735 (0.0742) loss_oracle 0.5176 (0.4649) acc 78.1250 (84.0625) kd_loss 0.9719 (0.9558) lr 1.9921e-03 eta 0:12:41
epoch [4/50] batch [60/167] time 0.087 (0.094) data 0.000 (0.006) loss 0.8206 (0.8205) ce_loss 0.4568 (0.4271) teacher_loss 0.3036 (0.3276) loss_zs_kd 0.0799 (0.0708) loss_oracle 0.4770 (0.4575) acc 84.3750 (84.7917) kd_loss 0.9644 (0.9494) lr 1.9921e-03 eta 0:12:09
epoch [4/50] batch [80/167] time 0.088 (0.092) data 0.000 (0.004) loss 0.8097 (0.8289) ce_loss 0.5327 (0.4387) teacher_loss 0.3420 (0.3330) loss_zs_kd 0.0847 (0.0728) loss_oracle 0.4254 (0.4595) acc 78.1250 (84.2188) kd_loss 0.8583 (0.9469) lr 1.9921e-03 eta 0:11:54
epoch [4/50] batch [100/167] time 0.087 (0.091) data 0.000 (0.004) loss 0.8461 (0.8236) ce_loss 0.4402 (0.4378) teacher_loss 0.3470 (0.3288) loss_zs_kd 0.0778 (0.0765) loss_oracle 0.4602 (0.4565) acc 84.3750 (84.2500) kd_loss 0.9165 (0.9456) lr 1.9921e-03 eta 0:11:45
epoch [4/50] batch [120/167] time 0.085 (0.090) data 0.000 (0.003) loss 0.7844 (0.8275) ce_loss 0.3765 (0.4412) teacher_loss 0.3040 (0.3302) loss_zs_kd 0.0956 (0.0764) loss_oracle 0.4326 (0.4591) acc 81.2500 (83.9323) kd_loss 0.9058 (0.9406) lr 1.9921e-03 eta 0:11:36
epoch [4/50] batch [140/167] time 0.094 (0.090) data 0.000 (0.003) loss 0.7260 (0.8270) ce_loss 0.2891 (0.4383) teacher_loss 0.1800 (0.3238) loss_zs_kd 0.0886 (0.0769) loss_oracle 0.5018 (0.4647) acc 93.7500 (83.7723) kd_loss 0.8790 (0.9339) lr 1.9921e-03 eta 0:11:32
epoch [4/50] batch [160/167] time 0.083 (0.089) data 0.000 (0.002) loss 0.8069 (0.8286) ce_loss 0.5044 (0.4398) teacher_loss 0.2651 (0.3210) loss_zs_kd 0.1164 (0.0781) loss_oracle 0.4835 (0.4686) acc 78.1250 (83.7500) kd_loss 0.8348 (0.9294) lr 1.9921e-03 eta 0:11:26
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,185
* accuracy: 95.1%
* error: 4.9%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.1%, epoch: 3 *******
******* Domain c best val test acc: 99.1%, epoch: 3 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [5/50] batch [20/167] time 0.085 (0.104) data 0.000 (0.016) loss 1.0207 (0.8614) ce_loss 0.5449 (0.4269) teacher_loss 0.4097 (0.3009) loss_zs_kd 0.0686 (0.0823) loss_oracle 0.5766 (0.5193) acc 84.3750 (83.5938) kd_loss 0.9268 (0.9071) lr 1.9823e-03 eta 0:13:17
epoch [5/50] batch [40/167] time 0.084 (0.095) data 0.000 (0.008) loss 0.9392 (0.8342) ce_loss 0.4880 (0.4091) teacher_loss 0.3194 (0.2856) loss_zs_kd 0.1063 (0.0771) loss_oracle 0.5666 (0.5101) acc 75.0000 (84.2969) kd_loss 0.9118 (0.9103) lr 1.9823e-03 eta 0:12:02
epoch [5/50] batch [60/167] time 0.084 (0.092) data 0.001 (0.005) loss 0.8980 (0.8385) ce_loss 0.4285 (0.4112) teacher_loss 0.2906 (0.2909) loss_zs_kd 0.0836 (0.0776) loss_oracle 0.5656 (0.5088) acc 81.2500 (84.6875) kd_loss 0.9782 (0.9080) lr 1.9823e-03 eta 0:11:38
epoch [5/50] batch [80/167] time 0.085 (0.091) data 0.000 (0.004) loss 1.0095 (0.8423) ce_loss 0.6445 (0.4213) teacher_loss 0.4467 (0.3018) loss_zs_kd 0.0622 (0.0762) loss_oracle 0.5318 (0.5024) acc 71.8750 (84.2188) kd_loss 0.9144 (0.9062) lr 1.9823e-03 eta 0:11:30
epoch [5/50] batch [100/167] time 0.089 (0.090) data 0.001 (0.003) loss 0.8382 (0.8522) ce_loss 0.3887 (0.4338) teacher_loss 0.3597 (0.3154) loss_zs_kd 0.0999 (0.0773) loss_oracle 0.4285 (0.4981) acc 87.5000 (84.1250) kd_loss 0.8159 (0.9061) lr 1.9823e-03 eta 0:11:21
epoch [5/50] batch [120/167] time 0.085 (0.089) data 0.000 (0.003) loss 0.8673 (0.8503) ce_loss 0.3696 (0.4296) teacher_loss 0.2942 (0.3174) loss_zs_kd 0.0876 (0.0790) loss_oracle 0.5292 (0.4935) acc 84.3750 (84.3490) kd_loss 0.9423 (0.9064) lr 1.9823e-03 eta 0:11:11
epoch [5/50] batch [140/167] time 0.087 (0.088) data 0.000 (0.002) loss 0.8506 (0.8494) ce_loss 0.5161 (0.4261) teacher_loss 0.3761 (0.3189) loss_zs_kd 0.0773 (0.0789) loss_oracle 0.4359 (0.4911) acc 78.1250 (84.3527) kd_loss 0.9096 (0.9064) lr 1.9823e-03 eta 0:11:04
epoch [5/50] batch [160/167] time 0.076 (0.088) data 0.001 (0.002) loss 0.8414 (0.8473) ce_loss 0.3037 (0.4220) teacher_loss 0.1948 (0.3168) loss_zs_kd 0.0698 (0.0790) loss_oracle 0.6117 (0.4910) acc 84.3750 (84.4141) kd_loss 0.9796 (0.9071) lr 1.9823e-03 eta 0:11:01
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,191
* accuracy: 95.4%
* error: 4.6%
* macro_f1: 95.9%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.4%, epoch: 5 *******
******* Domain c best val test acc: 99.1%, epoch: 5 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [6/50] batch [20/167] time 0.092 (0.112) data 0.001 (0.017) loss 1.1674 (0.9602) ce_loss 0.5732 (0.4032) teacher_loss 0.4663 (0.3164) loss_zs_kd 0.0811 (0.0816) loss_oracle 0.6605 (0.6029) acc 84.3750 (84.5312) kd_loss 0.9535 (0.9583) lr 1.9686e-03 eta 0:14:00
epoch [6/50] batch [40/167] time 0.085 (0.099) data 0.000 (0.009) loss 0.8184 (0.9539) ce_loss 0.4409 (0.4004) teacher_loss 0.2606 (0.3086) loss_zs_kd 0.0737 (0.0782) loss_oracle 0.5209 (0.6062) acc 81.2500 (84.6875) kd_loss 0.8888 (0.9645) lr 1.9686e-03 eta 0:12:22
epoch [6/50] batch [60/167] time 0.083 (0.095) data 0.000 (0.006) loss 1.0587 (0.9651) ce_loss 0.5605 (0.4168) teacher_loss 0.3285 (0.3123) loss_zs_kd 0.0705 (0.0850) loss_oracle 0.6950 (0.6103) acc 78.1250 (84.0104) kd_loss 1.0047 (0.9680) lr 1.9686e-03 eta 0:11:44
epoch [6/50] batch [80/167] time 0.090 (0.092) data 0.000 (0.005) loss 0.8268 (0.9481) ce_loss 0.2585 (0.4017) teacher_loss 0.2210 (0.2974) loss_zs_kd 0.0535 (0.0807) loss_oracle 0.5790 (0.6104) acc 93.7500 (84.6484) kd_loss 0.9736 (0.9731) lr 1.9686e-03 eta 0:11:25
epoch [6/50] batch [100/167] time 0.089 (0.091) data 0.001 (0.004) loss 0.9596 (0.9464) ce_loss 0.3875 (0.4068) teacher_loss 0.2715 (0.2985) loss_zs_kd 0.0658 (0.0815) loss_oracle 0.6552 (0.6071) acc 87.5000 (84.4688) kd_loss 1.0398 (0.9742) lr 1.9686e-03 eta 0:11:15
epoch [6/50] batch [120/167] time 0.083 (0.091) data 0.000 (0.003) loss 1.1559 (0.9520) ce_loss 0.6567 (0.4179) teacher_loss 0.4856 (0.3046) loss_zs_kd 0.0977 (0.0816) loss_oracle 0.6215 (0.6066) acc 75.0000 (84.0365) kd_loss 0.9013 (0.9722) lr 1.9686e-03 eta 0:11:10
epoch [6/50] batch [140/167] time 0.092 (0.090) data 0.001 (0.003) loss 0.8893 (0.9492) ce_loss 0.4436 (0.4192) teacher_loss 0.2614 (0.3031) loss_zs_kd 0.0732 (0.0822) loss_oracle 0.5912 (0.6050) acc 87.5000 (83.9732) kd_loss 0.9545 (0.9729) lr 1.9686e-03 eta 0:11:04
epoch [6/50] batch [160/167] time 0.073 (0.089) data 0.000 (0.002) loss 0.6899 (0.9408) ce_loss 0.2369 (0.4168) teacher_loss 0.1769 (0.2989) loss_zs_kd 0.0427 (0.0828) loss_oracle 0.4917 (0.6005) acc 90.6250 (84.0234) kd_loss 0.9162 (0.9718) lr 1.9686e-03 eta 0:10:56
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,187
* accuracy: 95.2%
* error: 4.8%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.4%, epoch: 5 *******
******* Domain c best val test acc: 99.1%, epoch: 5 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [7/50] batch [20/167] time 0.082 (0.103) data 0.000 (0.017) loss 0.7603 (0.8481) ce_loss 0.3323 (0.4194) teacher_loss 0.2273 (0.2941) loss_zs_kd 0.0732 (0.0790) loss_oracle 0.4964 (0.5145) acc 84.3750 (84.2188) kd_loss 0.9352 (0.9327) lr 1.9511e-03 eta 0:12:31
epoch [7/50] batch [40/167] time 0.089 (0.094) data 0.000 (0.009) loss 0.6242 (0.8211) ce_loss 0.2080 (0.3993) teacher_loss 0.1606 (0.2730) loss_zs_kd 0.0632 (0.0804) loss_oracle 0.4320 (0.5079) acc 93.7500 (85.2344) kd_loss 0.8512 (0.9303) lr 1.9511e-03 eta 0:11:23
epoch [7/50] batch [60/167] time 0.093 (0.090) data 0.001 (0.006) loss 0.8803 (0.8185) ce_loss 0.5366 (0.4067) teacher_loss 0.3014 (0.2727) loss_zs_kd 0.1036 (0.0822) loss_oracle 0.5271 (0.5047) acc 81.2500 (85.1562) kd_loss 0.8735 (0.9267) lr 1.9511e-03 eta 0:10:57
epoch [7/50] batch [80/167] time 0.080 (0.088) data 0.000 (0.005) loss 0.6757 (0.8174) ce_loss 0.3489 (0.4134) teacher_loss 0.1896 (0.2781) loss_zs_kd 0.0749 (0.0870) loss_oracle 0.4486 (0.4958) acc 87.5000 (85.0000) kd_loss 0.9280 (0.9242) lr 1.9511e-03 eta 0:10:42
epoch [7/50] batch [100/167] time 0.075 (0.088) data 0.000 (0.004) loss 1.0464 (0.8204) ce_loss 0.8003 (0.4140) teacher_loss 0.4431 (0.2810) loss_zs_kd 0.1046 (0.0845) loss_oracle 0.5509 (0.4971) acc 71.8750 (84.9062) kd_loss 1.0068 (0.9265) lr 1.9511e-03 eta 0:10:34
epoch [7/50] batch [120/167] time 0.090 (0.087) data 0.000 (0.003) loss 1.1422 (0.8296) ce_loss 0.6001 (0.4174) teacher_loss 0.5249 (0.2813) loss_zs_kd 0.1272 (0.0882) loss_oracle 0.5537 (0.5042) acc 84.3750 (84.7396) kd_loss 0.9836 (0.9324) lr 1.9511e-03 eta 0:10:30
epoch [7/50] batch [140/167] time 0.084 (0.087) data 0.000 (0.003) loss 0.7809 (0.8386) ce_loss 0.3276 (0.4190) teacher_loss 0.2058 (0.2837) loss_zs_kd 0.1130 (0.0885) loss_oracle 0.5186 (0.5106) acc 93.7500 (84.6205) kd_loss 1.0174 (0.9368) lr 1.9511e-03 eta 0:10:25
epoch [7/50] batch [160/167] time 0.080 (0.087) data 0.000 (0.002) loss 0.7494 (0.8398) ce_loss 0.2544 (0.4212) teacher_loss 0.1634 (0.2856) loss_zs_kd 0.0862 (0.0881) loss_oracle 0.5429 (0.5101) acc 93.7500 (84.5898) kd_loss 0.9990 (0.9389) lr 1.9511e-03 eta 0:10:23
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,189
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.4%, epoch: 5 *******
******* Domain c best val test acc: 99.1%, epoch: 5 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [8/50] batch [20/167] time 0.083 (0.102) data 0.000 (0.014) loss 0.6537 (0.7338) ce_loss 0.3291 (0.3978) teacher_loss 0.1764 (0.2625) loss_zs_kd 0.0888 (0.0961) loss_oracle 0.4329 (0.4232) acc 87.5000 (84.3750) kd_loss 0.9658 (0.9740) lr 1.9298e-03 eta 0:12:13
epoch [8/50] batch [40/167] time 0.086 (0.094) data 0.000 (0.007) loss 0.5879 (0.7139) ce_loss 0.3213 (0.3935) teacher_loss 0.1730 (0.2530) loss_zs_kd 0.0844 (0.0967) loss_oracle 0.3728 (0.4124) acc 87.5000 (85.3906) kd_loss 0.9593 (0.9709) lr 1.9298e-03 eta 0:11:14
epoch [8/50] batch [60/167] time 0.084 (0.091) data 0.001 (0.005) loss 0.7039 (0.7218) ce_loss 0.4077 (0.3978) teacher_loss 0.2786 (0.2479) loss_zs_kd 0.1320 (0.1086) loss_oracle 0.3594 (0.4196) acc 84.3750 (85.3125) kd_loss 0.9779 (0.9757) lr 1.9298e-03 eta 0:10:48
epoch [8/50] batch [80/167] time 0.083 (0.090) data 0.000 (0.004) loss 0.5237 (0.7300) ce_loss 0.2003 (0.4047) teacher_loss 0.1261 (0.2509) loss_zs_kd 0.1126 (0.1112) loss_oracle 0.3413 (0.4235) acc 93.7500 (85.2734) kd_loss 0.9216 (0.9875) lr 1.9298e-03 eta 0:10:35
epoch [8/50] batch [100/167] time 0.091 (0.089) data 0.000 (0.003) loss 0.6677 (0.7364) ce_loss 0.3665 (0.4147) teacher_loss 0.2135 (0.2511) loss_zs_kd 0.1132 (0.1160) loss_oracle 0.3976 (0.4273) acc 81.2500 (85.2188) kd_loss 1.0078 (0.9946) lr 1.9298e-03 eta 0:10:27
epoch [8/50] batch [120/167] time 0.085 (0.089) data 0.000 (0.003) loss 0.5284 (0.7275) ce_loss 0.3523 (0.4103) teacher_loss 0.1530 (0.2458) loss_zs_kd 0.0736 (0.1160) loss_oracle 0.3386 (0.4238) acc 87.5000 (85.1823) kd_loss 1.0183 (0.9967) lr 1.9298e-03 eta 0:10:26
epoch [8/50] batch [140/167] time 0.082 (0.088) data 0.000 (0.002) loss 0.6303 (0.7203) ce_loss 0.2668 (0.4040) teacher_loss 0.2807 (0.2442) loss_zs_kd 0.1117 (0.1148) loss_oracle 0.2937 (0.4187) acc 93.7500 (85.3795) kd_loss 0.9817 (0.9937) lr 1.9298e-03 eta 0:10:21
epoch [8/50] batch [160/167] time 0.076 (0.087) data 0.000 (0.002) loss 0.7832 (0.7159) ce_loss 0.5488 (0.4096) teacher_loss 0.2856 (0.2458) loss_zs_kd 0.1828 (0.1141) loss_oracle 0.4062 (0.4131) acc 78.1250 (85.1367) kd_loss 1.0062 (0.9922) lr 1.9298e-03 eta 0:10:13
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,191
* accuracy: 95.4%
* error: 4.6%
* macro_f1: 95.9%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.4%, epoch: 5 *******
******* Domain c best val test acc: 99.1%, epoch: 5 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [9/50] batch [20/167] time 0.081 (0.095) data 0.000 (0.013) loss 0.9632 (0.7788) ce_loss 0.7280 (0.4798) teacher_loss 0.3544 (0.2622) loss_zs_kd 0.1878 (0.1390) loss_oracle 0.5149 (0.4472) acc 65.6250 (81.5625) kd_loss 0.9062 (0.9984) lr 1.9048e-03 eta 0:11:02
epoch [9/50] batch [40/167] time 0.087 (0.090) data 0.000 (0.006) loss 0.8609 (0.7668) ce_loss 0.5522 (0.4463) teacher_loss 0.3112 (0.2418) loss_zs_kd 0.1376 (0.1282) loss_oracle 0.4809 (0.4608) acc 78.1250 (82.8125) kd_loss 1.0513 (1.0101) lr 1.9048e-03 eta 0:10:27
epoch [9/50] batch [60/167] time 0.089 (0.088) data 0.001 (0.004) loss 0.7703 (0.7772) ce_loss 0.4414 (0.4506) teacher_loss 0.2879 (0.2459) loss_zs_kd 0.1410 (0.1318) loss_oracle 0.4119 (0.4654) acc 81.2500 (83.2812) kd_loss 0.9415 (1.0148) lr 1.9048e-03 eta 0:10:14
epoch [9/50] batch [80/167] time 0.084 (0.087) data 0.000 (0.003) loss 0.8596 (0.7847) ce_loss 0.3794 (0.4457) teacher_loss 0.2218 (0.2418) loss_zs_kd 0.1172 (0.1314) loss_oracle 0.5793 (0.4771) acc 81.2500 (83.3594) kd_loss 1.1032 (1.0219) lr 1.9048e-03 eta 0:10:04
epoch [9/50] batch [100/167] time 0.093 (0.087) data 0.000 (0.003) loss 0.5951 (0.7826) ce_loss 0.1609 (0.4454) teacher_loss 0.0628 (0.2401) loss_zs_kd 0.1191 (0.1325) loss_oracle 0.4728 (0.4763) acc 96.8750 (83.4688) kd_loss 1.0488 (1.0232) lr 1.9048e-03 eta 0:10:03
epoch [9/50] batch [120/167] time 0.089 (0.087) data 0.000 (0.002) loss 0.7642 (0.7875) ce_loss 0.4080 (0.4448) teacher_loss 0.2189 (0.2428) loss_zs_kd 0.1194 (0.1330) loss_oracle 0.4856 (0.4783) acc 84.3750 (83.5417) kd_loss 1.0048 (1.0252) lr 1.9048e-03 eta 0:10:01
epoch [9/50] batch [140/167] time 0.092 (0.087) data 0.000 (0.002) loss 0.4341 (0.7792) ce_loss 0.0692 (0.4369) teacher_loss 0.0333 (0.2386) loss_zs_kd 0.0362 (0.1298) loss_oracle 0.3827 (0.4757) acc 96.8750 (84.0179) kd_loss 1.0045 (1.0245) lr 1.9048e-03 eta 0:09:57
epoch [9/50] batch [160/167] time 0.073 (0.087) data 0.000 (0.002) loss 0.7788 (0.7758) ce_loss 0.5903 (0.4403) teacher_loss 0.2191 (0.2395) loss_zs_kd 0.1690 (0.1288) loss_oracle 0.4751 (0.4719) acc 75.0000 (83.8086) kd_loss 1.0530 (1.0230) lr 1.9048e-03 eta 0:09:53
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,197
* accuracy: 95.6%
* error: 4.4%
* macro_f1: 96.1%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [10/50] batch [20/167] time 0.080 (0.101) data 0.000 (0.015) loss 0.6010 (0.7507) ce_loss 0.2881 (0.4210) teacher_loss 0.1360 (0.2493) loss_zs_kd 0.0753 (0.1419) loss_oracle 0.4273 (0.4305) acc 87.5000 (84.5312) kd_loss 1.0110 (0.9968) lr 1.8763e-03 eta 0:11:29
epoch [10/50] batch [40/167] time 0.087 (0.092) data 0.001 (0.008) loss 0.6960 (0.7224) ce_loss 0.2954 (0.3904) teacher_loss 0.2643 (0.2303) loss_zs_kd 0.1071 (0.1293) loss_oracle 0.3782 (0.4275) acc 93.7500 (85.7812) kd_loss 1.0068 (0.9951) lr 1.8763e-03 eta 0:10:25
epoch [10/50] batch [60/167] time 0.084 (0.090) data 0.001 (0.005) loss 0.8079 (0.7310) ce_loss 0.5410 (0.3999) teacher_loss 0.2749 (0.2328) loss_zs_kd 0.1412 (0.1229) loss_oracle 0.4623 (0.4367) acc 84.3750 (85.1042) kd_loss 0.9463 (0.9923) lr 1.8763e-03 eta 0:10:13
epoch [10/50] batch [80/167] time 0.088 (0.089) data 0.000 (0.004) loss 0.8054 (0.7467) ce_loss 0.4436 (0.3981) teacher_loss 0.2366 (0.2328) loss_zs_kd 0.0869 (0.1215) loss_oracle 0.5254 (0.4531) acc 87.5000 (85.0781) kd_loss 0.9791 (0.9946) lr 1.8763e-03 eta 0:10:05
epoch [10/50] batch [100/167] time 0.087 (0.089) data 0.000 (0.003) loss 1.0048 (0.7617) ce_loss 0.6396 (0.4086) teacher_loss 0.4359 (0.2395) loss_zs_kd 0.1406 (0.1213) loss_oracle 0.4986 (0.4616) acc 75.0000 (84.6562) kd_loss 0.9962 (0.9957) lr 1.8763e-03 eta 0:09:58
epoch [10/50] batch [120/167] time 0.087 (0.088) data 0.000 (0.003) loss 1.1559 (0.7747) ce_loss 0.7441 (0.4159) teacher_loss 0.5537 (0.2475) loss_zs_kd 0.1559 (0.1206) loss_oracle 0.5243 (0.4669) acc 75.0000 (84.5312) kd_loss 0.9937 (0.9942) lr 1.8763e-03 eta 0:09:53
epoch [10/50] batch [140/167] time 0.086 (0.088) data 0.000 (0.002) loss 0.8920 (0.7842) ce_loss 0.5210 (0.4194) teacher_loss 0.2538 (0.2519) loss_zs_kd 0.1603 (0.1200) loss_oracle 0.5580 (0.4722) acc 78.1250 (84.3304) kd_loss 1.0142 (0.9965) lr 1.8763e-03 eta 0:09:50
epoch [10/50] batch [160/167] time 0.073 (0.087) data 0.000 (0.002) loss 0.6928 (0.7784) ce_loss 0.3220 (0.4163) teacher_loss 0.2506 (0.2504) loss_zs_kd 0.0890 (0.1166) loss_oracle 0.3977 (0.4697) acc 87.5000 (84.4141) kd_loss 0.9521 (0.9967) lr 1.8763e-03 eta 0:09:43
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,191
* accuracy: 95.4%
* error: 4.6%
* macro_f1: 95.9%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,324
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [11/50] batch [20/167] time 0.087 (0.102) data 0.000 (0.018) loss 0.7926 (0.7180) ce_loss 0.4197 (0.4028) teacher_loss 0.2774 (0.2361) loss_zs_kd 0.1489 (0.1072) loss_oracle 0.4407 (0.4283) acc 81.2500 (83.9062) kd_loss 0.9282 (0.9696) lr 1.8443e-03 eta 0:11:21
epoch [11/50] batch [40/167] time 0.100 (0.092) data 0.002 (0.009) loss 0.6671 (0.7088) ce_loss 0.3113 (0.3935) teacher_loss 0.2481 (0.2315) loss_zs_kd 0.1039 (0.1130) loss_oracle 0.3671 (0.4208) acc 90.6250 (85.1562) kd_loss 0.9028 (0.9721) lr 1.8443e-03 eta 0:10:13
epoch [11/50] batch [60/167] time 0.089 (0.090) data 0.001 (0.006) loss 0.8110 (0.7133) ce_loss 0.4746 (0.3901) teacher_loss 0.3264 (0.2399) loss_zs_kd 0.0788 (0.1049) loss_oracle 0.4452 (0.4209) acc 87.5000 (85.8854) kd_loss 0.9442 (0.9663) lr 1.8443e-03 eta 0:09:54
epoch [11/50] batch [80/167] time 0.089 (0.089) data 0.000 (0.005) loss 0.6303 (0.7224) ce_loss 0.3367 (0.4082) teacher_loss 0.2380 (0.2528) loss_zs_kd 0.0737 (0.1067) loss_oracle 0.3554 (0.4162) acc 90.6250 (84.9609) kd_loss 0.9406 (0.9611) lr 1.8443e-03 eta 0:09:46
epoch [11/50] batch [100/167] time 0.093 (0.089) data 0.001 (0.004) loss 0.5665 (0.7021) ce_loss 0.3389 (0.3941) teacher_loss 0.2016 (0.2419) loss_zs_kd 0.0934 (0.1032) loss_oracle 0.3182 (0.4087) acc 87.5000 (85.6250) kd_loss 0.9634 (0.9580) lr 1.8443e-03 eta 0:09:44
epoch [11/50] batch [120/167] time 0.081 (0.089) data 0.000 (0.003) loss 0.5386 (0.6962) ce_loss 0.2612 (0.3936) teacher_loss 0.2225 (0.2426) loss_zs_kd 0.0735 (0.1031) loss_oracle 0.2794 (0.4020) acc 87.5000 (85.5469) kd_loss 0.8516 (0.9562) lr 1.8443e-03 eta 0:09:41
epoch [11/50] batch [140/167] time 0.088 (0.088) data 0.001 (0.003) loss 0.7291 (0.6954) ce_loss 0.3521 (0.3959) teacher_loss 0.3437 (0.2454) loss_zs_kd 0.0899 (0.1036) loss_oracle 0.3404 (0.3982) acc 90.6250 (85.4464) kd_loss 0.8998 (0.9542) lr 1.8443e-03 eta 0:09:36
epoch [11/50] batch [160/167] time 0.074 (0.087) data 0.000 (0.003) loss 0.7532 (0.6958) ce_loss 0.5796 (0.4021) teacher_loss 0.2758 (0.2497) loss_zs_kd 0.1637 (0.1050) loss_oracle 0.3955 (0.3936) acc 75.0000 (85.2734) kd_loss 0.9517 (0.9537) lr 1.8443e-03 eta 0:09:29
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,192
* accuracy: 95.4%
* error: 4.6%
* macro_f1: 95.9%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [12/50] batch [20/167] time 0.070 (0.097) data 0.000 (0.018) loss 0.7522 (0.6800) ce_loss 0.5122 (0.3739) teacher_loss 0.2755 (0.2419) loss_zs_kd 0.0982 (0.0984) loss_oracle 0.4275 (0.3888) acc 81.2500 (85.4688) kd_loss 0.9899 (0.9373) lr 1.8090e-03 eta 0:10:29
epoch [12/50] batch [40/167] time 0.083 (0.086) data 0.000 (0.009) loss 0.7374 (0.6823) ce_loss 0.3784 (0.3620) teacher_loss 0.2090 (0.2304) loss_zs_kd 0.1339 (0.1027) loss_oracle 0.4615 (0.4004) acc 84.3750 (86.4844) kd_loss 1.0435 (0.9302) lr 1.8090e-03 eta 0:09:15
epoch [12/50] batch [60/167] time 0.066 (0.081) data 0.000 (0.006) loss 0.8363 (0.7163) ce_loss 0.5137 (0.3913) teacher_loss 0.2903 (0.2505) loss_zs_kd 0.1401 (0.1091) loss_oracle 0.4760 (0.4112) acc 78.1250 (85.3125) kd_loss 0.9396 (0.9270) lr 1.8090e-03 eta 0:08:41
epoch [12/50] batch [80/167] time 0.078 (0.079) data 0.000 (0.005) loss 0.9022 (0.7504) ce_loss 0.4937 (0.4047) teacher_loss 0.2615 (0.2569) loss_zs_kd 0.1678 (0.1133) loss_oracle 0.5569 (0.4369) acc 84.3750 (85.0781) kd_loss 0.9706 (0.9320) lr 1.8090e-03 eta 0:08:26
epoch [12/50] batch [100/167] time 0.084 (0.078) data 0.000 (0.004) loss 0.7602 (0.7678) ce_loss 0.3567 (0.4105) teacher_loss 0.1976 (0.2599) loss_zs_kd 0.0787 (0.1135) loss_oracle 0.5233 (0.4511) acc 93.7500 (84.8125) kd_loss 0.8939 (0.9369) lr 1.8090e-03 eta 0:08:18
epoch [12/50] batch [120/167] time 0.078 (0.077) data 0.000 (0.003) loss 0.9515 (0.7856) ce_loss 0.4924 (0.4243) teacher_loss 0.2742 (0.2646) loss_zs_kd 0.1658 (0.1171) loss_oracle 0.5944 (0.4624) acc 87.5000 (84.4271) kd_loss 0.9640 (0.9374) lr 1.8090e-03 eta 0:08:15
epoch [12/50] batch [140/167] time 0.082 (0.077) data 0.000 (0.003) loss 0.6064 (0.7903) ce_loss 0.1741 (0.4266) teacher_loss 0.1200 (0.2628) loss_zs_kd 0.0860 (0.1172) loss_oracle 0.4434 (0.4689) acc 93.7500 (84.3973) kd_loss 0.8968 (0.9372) lr 1.8090e-03 eta 0:08:12
epoch [12/50] batch [160/167] time 0.081 (0.078) data 0.001 (0.002) loss 0.7879 (0.7901) ce_loss 0.3091 (0.4240) teacher_loss 0.2023 (0.2590) loss_zs_kd 0.1233 (0.1173) loss_oracle 0.5239 (0.4725) acc 90.6250 (84.5117) kd_loss 0.9430 (0.9390) lr 1.8090e-03 eta 0:08:14
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,185
* accuracy: 95.1%
* error: 4.9%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,325
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.2%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [13/50] batch [20/167] time 0.085 (0.111) data 0.000 (0.017) loss 0.7743 (0.7788) ce_loss 0.4011 (0.4490) teacher_loss 0.1840 (0.2444) loss_zs_kd 0.1143 (0.1123) loss_oracle 0.5331 (0.4782) acc 87.5000 (83.9062) kd_loss 1.0153 (0.9414) lr 1.7705e-03 eta 0:11:42
epoch [13/50] batch [40/167] time 0.095 (0.101) data 0.000 (0.009) loss 0.7274 (0.7752) ce_loss 0.3335 (0.4433) teacher_loss 0.1781 (0.2443) loss_zs_kd 0.1226 (0.1225) loss_oracle 0.4880 (0.4696) acc 90.6250 (83.7500) kd_loss 1.0202 (0.9607) lr 1.7705e-03 eta 0:10:38
epoch [13/50] batch [60/167] time 0.097 (0.097) data 0.001 (0.006) loss 0.5359 (0.7507) ce_loss 0.1896 (0.4252) teacher_loss 0.1422 (0.2334) loss_zs_kd 0.0771 (0.1251) loss_oracle 0.3552 (0.4548) acc 93.7500 (84.0625) kd_loss 0.9771 (0.9684) lr 1.7705e-03 eta 0:10:09
epoch [13/50] batch [80/167] time 0.089 (0.095) data 0.000 (0.005) loss 0.6736 (0.7348) ce_loss 0.2974 (0.4186) teacher_loss 0.2206 (0.2346) loss_zs_kd 0.1195 (0.1190) loss_oracle 0.3933 (0.4406) acc 87.5000 (84.2969) kd_loss 1.0089 (0.9817) lr 1.7705e-03 eta 0:09:54
epoch [13/50] batch [100/167] time 0.088 (0.093) data 0.000 (0.004) loss 0.6571 (0.7331) ce_loss 0.2961 (0.4162) teacher_loss 0.2249 (0.2409) loss_zs_kd 0.0819 (0.1166) loss_oracle 0.3913 (0.4339) acc 90.6250 (84.5938) kd_loss 1.0435 (0.9922) lr 1.7705e-03 eta 0:09:42
epoch [13/50] batch [120/167] time 0.088 (0.093) data 0.000 (0.003) loss 0.7526 (0.7487) ce_loss 0.2247 (0.4170) teacher_loss 0.1224 (0.2492) loss_zs_kd 0.0895 (0.1127) loss_oracle 0.5855 (0.4431) acc 93.7500 (84.5573) kd_loss 1.0957 (1.0019) lr 1.7705e-03 eta 0:09:36
epoch [13/50] batch [140/167] time 0.090 (0.092) data 0.000 (0.003) loss 1.3554 (0.7763) ce_loss 1.0361 (0.4246) teacher_loss 0.7285 (0.2612) loss_zs_kd 0.1104 (0.1103) loss_oracle 0.5718 (0.4599) acc 59.3750 (84.2857) kd_loss 1.1006 (1.0090) lr 1.7705e-03 eta 0:09:31
epoch [13/50] batch [160/167] time 0.081 (0.092) data 0.000 (0.003) loss 0.7572 (0.7887) ce_loss 0.2930 (0.4235) teacher_loss 0.1671 (0.2613) loss_zs_kd 0.1049 (0.1094) loss_oracle 0.5377 (0.4727) acc 87.5000 (84.3164) kd_loss 1.0496 (1.0172) lr 1.7705e-03 eta 0:09:26
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,187
* accuracy: 95.2%
* error: 4.8%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [14/50] batch [20/167] time 0.083 (0.103) data 0.000 (0.014) loss 0.9355 (0.8516) ce_loss 0.4443 (0.4170) teacher_loss 0.2661 (0.2654) loss_zs_kd 0.1053 (0.0916) loss_oracle 0.6167 (0.5403) acc 81.2500 (85.0000) kd_loss 1.0994 (1.0637) lr 1.7290e-03 eta 0:10:34
epoch [14/50] batch [40/167] time 0.090 (0.096) data 0.000 (0.007) loss 0.6394 (0.8449) ce_loss 0.2808 (0.4123) teacher_loss 0.1624 (0.2632) loss_zs_kd 0.0789 (0.0972) loss_oracle 0.4376 (0.5331) acc 90.6250 (85.2344) kd_loss 0.9538 (1.0652) lr 1.7290e-03 eta 0:09:50
epoch [14/50] batch [60/167] time 0.091 (0.095) data 0.001 (0.005) loss 0.9097 (0.8524) ce_loss 0.5532 (0.4180) teacher_loss 0.3291 (0.2693) loss_zs_kd 0.0733 (0.0976) loss_oracle 0.5440 (0.5343) acc 81.2500 (84.8438) kd_loss 1.0983 (1.0628) lr 1.7290e-03 eta 0:09:43
epoch [14/50] batch [80/167] time 0.091 (0.093) data 0.000 (0.004) loss 0.8102 (0.8552) ce_loss 0.5752 (0.4212) teacher_loss 0.2856 (0.2788) loss_zs_kd 0.0882 (0.0969) loss_oracle 0.4805 (0.5279) acc 75.0000 (84.2969) kd_loss 1.0708 (1.0635) lr 1.7290e-03 eta 0:09:29
epoch [14/50] batch [100/167] time 0.088 (0.093) data 0.000 (0.003) loss 0.8476 (0.8522) ce_loss 0.4822 (0.4228) teacher_loss 0.3415 (0.2831) loss_zs_kd 0.0996 (0.0953) loss_oracle 0.4564 (0.5214) acc 81.2500 (84.2500) kd_loss 1.0324 (1.0629) lr 1.7290e-03 eta 0:09:22
epoch [14/50] batch [120/167] time 0.088 (0.092) data 0.000 (0.003) loss 0.7472 (0.8501) ce_loss 0.5542 (0.4308) teacher_loss 0.2666 (0.2907) loss_zs_kd 0.1075 (0.0943) loss_oracle 0.4267 (0.5123) acc 78.1250 (83.8802) kd_loss 0.9669 (1.0604) lr 1.7290e-03 eta 0:09:18
epoch [14/50] batch [140/167] time 0.084 (0.091) data 0.000 (0.002) loss 0.9662 (0.8440) ce_loss 0.6284 (0.4323) teacher_loss 0.4654 (0.2935) loss_zs_kd 0.1303 (0.0936) loss_oracle 0.4357 (0.5037) acc 78.1250 (83.8839) kd_loss 1.0936 (1.0552) lr 1.7290e-03 eta 0:09:12
epoch [14/50] batch [160/167] time 0.081 (0.091) data 0.000 (0.002) loss 0.7959 (0.8394) ce_loss 0.3867 (0.4308) teacher_loss 0.2802 (0.2941) loss_zs_kd 0.0800 (0.0933) loss_oracle 0.4756 (0.4986) acc 78.1250 (83.9258) kd_loss 1.0775 (1.0541) lr 1.7290e-03 eta 0:09:06
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,183
* accuracy: 95.0%
* error: 5.0%
* macro_f1: 95.5%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [15/50] batch [20/167] time 0.099 (0.113) data 0.000 (0.019) loss 0.7915 (0.8042) ce_loss 0.4431 (0.4555) teacher_loss 0.3400 (0.3234) loss_zs_kd 0.0529 (0.0816) loss_oracle 0.4251 (0.4400) acc 84.3750 (84.0625) kd_loss 0.9888 (1.0311) lr 1.6845e-03 eta 0:11:18
epoch [15/50] batch [40/167] time 0.091 (0.101) data 0.000 (0.010) loss 0.5823 (0.7804) ce_loss 0.1987 (0.4148) teacher_loss 0.1475 (0.2978) loss_zs_kd 0.0663 (0.0827) loss_oracle 0.4016 (0.4413) acc 90.6250 (85.0000) kd_loss 1.0009 (1.0281) lr 1.6845e-03 eta 0:10:05
epoch [15/50] batch [60/167] time 0.085 (0.098) data 0.001 (0.007) loss 0.5549 (0.7580) ce_loss 0.2267 (0.3933) teacher_loss 0.1650 (0.2793) loss_zs_kd 0.0503 (0.0804) loss_oracle 0.3648 (0.4385) acc 87.5000 (85.8333) kd_loss 0.9964 (1.0260) lr 1.6845e-03 eta 0:09:40
epoch [15/50] batch [80/167] time 0.092 (0.095) data 0.000 (0.005) loss 0.6101 (0.7700) ce_loss 0.4067 (0.4132) teacher_loss 0.2003 (0.2940) loss_zs_kd 0.0874 (0.0833) loss_oracle 0.3661 (0.4344) acc 81.2500 (85.0781) kd_loss 0.9684 (1.0220) lr 1.6845e-03 eta 0:09:24
epoch [15/50] batch [100/167] time 0.091 (0.095) data 0.001 (0.004) loss 0.8356 (0.7660) ce_loss 0.3955 (0.4132) teacher_loss 0.3685 (0.2910) loss_zs_kd 0.0827 (0.0849) loss_oracle 0.4257 (0.4326) acc 84.3750 (85.0000) kd_loss 1.0350 (1.0183) lr 1.6845e-03 eta 0:09:20
epoch [15/50] batch [120/167] time 0.098 (0.094) data 0.000 (0.004) loss 0.7694 (0.7567) ce_loss 0.4722 (0.4047) teacher_loss 0.3015 (0.2842) loss_zs_kd 0.1446 (0.0846) loss_oracle 0.3956 (0.4302) acc 75.0000 (85.2083) kd_loss 0.9955 (1.0154) lr 1.6845e-03 eta 0:09:13
epoch [15/50] batch [140/167] time 0.097 (0.094) data 0.000 (0.003) loss 0.6491 (0.7570) ce_loss 0.2891 (0.4059) teacher_loss 0.2410 (0.2863) loss_zs_kd 0.0747 (0.0843) loss_oracle 0.3707 (0.4285) acc 90.6250 (85.1116) kd_loss 0.9274 (1.0146) lr 1.6845e-03 eta 0:09:10
epoch [15/50] batch [160/167] time 0.081 (0.094) data 0.000 (0.003) loss 0.7842 (0.7570) ce_loss 0.4243 (0.4089) teacher_loss 0.3172 (0.2881) loss_zs_kd 0.1044 (0.0848) loss_oracle 0.4147 (0.4265) acc 84.3750 (85.0000) kd_loss 1.0190 (1.0130) lr 1.6845e-03 eta 0:09:08
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,190
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [16/50] batch [20/167] time 0.072 (0.088) data 0.000 (0.013) loss 0.6812 (0.8033) ce_loss 0.3691 (0.4513) teacher_loss 0.2817 (0.3116) loss_zs_kd 0.0787 (0.1080) loss_oracle 0.3601 (0.4377) acc 81.2500 (82.5000) kd_loss 0.9874 (1.0138) lr 1.6374e-03 eta 0:08:33
epoch [16/50] batch [40/167] time 0.077 (0.083) data 0.000 (0.007) loss 0.7062 (0.7672) ce_loss 0.3582 (0.4256) teacher_loss 0.2544 (0.2993) loss_zs_kd 0.0877 (0.0909) loss_oracle 0.4079 (0.4224) acc 90.6250 (84.5312) kd_loss 0.9321 (1.0080) lr 1.6374e-03 eta 0:08:02
epoch [16/50] batch [60/167] time 0.071 (0.080) data 0.001 (0.005) loss 0.6997 (0.7568) ce_loss 0.4277 (0.4345) teacher_loss 0.3250 (0.2965) loss_zs_kd 0.0887 (0.0923) loss_oracle 0.3304 (0.4141) acc 90.6250 (84.0625) kd_loss 0.9727 (1.0052) lr 1.6374e-03 eta 0:07:44
epoch [16/50] batch [80/167] time 0.072 (0.080) data 0.000 (0.003) loss 0.8425 (0.7549) ce_loss 0.5781 (0.4326) teacher_loss 0.3790 (0.2976) loss_zs_kd 0.1082 (0.0931) loss_oracle 0.4094 (0.4108) acc 75.0000 (83.9453) kd_loss 1.0099 (1.0053) lr 1.6374e-03 eta 0:07:40
epoch [16/50] batch [100/167] time 0.070 (0.080) data 0.000 (0.003) loss 0.6868 (0.7597) ce_loss 0.2925 (0.4300) teacher_loss 0.2169 (0.2967) loss_zs_kd 0.1108 (0.0933) loss_oracle 0.4146 (0.4163) acc 84.3750 (84.1562) kd_loss 0.9986 (1.0025) lr 1.6374e-03 eta 0:07:37
epoch [16/50] batch [120/167] time 0.075 (0.081) data 0.000 (0.002) loss 0.8853 (0.7594) ce_loss 0.5352 (0.4311) teacher_loss 0.3745 (0.2978) loss_zs_kd 0.0907 (0.0909) loss_oracle 0.4654 (0.4161) acc 81.2500 (84.1406) kd_loss 1.0501 (1.0018) lr 1.6374e-03 eta 0:07:41
epoch [16/50] batch [140/167] time 0.074 (0.081) data 0.000 (0.002) loss 0.6066 (0.7510) ce_loss 0.2207 (0.4226) teacher_loss 0.1829 (0.2944) loss_zs_kd 0.0768 (0.0889) loss_oracle 0.3853 (0.4121) acc 93.7500 (84.7098) kd_loss 0.9275 (0.9990) lr 1.6374e-03 eta 0:07:44
epoch [16/50] batch [160/167] time 0.074 (0.081) data 0.000 (0.002) loss 0.9028 (0.7530) ce_loss 0.6152 (0.4253) teacher_loss 0.4206 (0.2966) loss_zs_kd 0.0812 (0.0880) loss_oracle 0.4415 (0.4124) acc 78.1250 (84.5508) kd_loss 0.9723 (0.9982) lr 1.6374e-03 eta 0:07:40
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,188
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,322
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [17/50] batch [20/167] time 0.055 (0.089) data 0.000 (0.013) loss 0.7688 (0.7545) ce_loss 0.4417 (0.4156) teacher_loss 0.3484 (0.3030) loss_zs_kd 0.0943 (0.0930) loss_oracle 0.3732 (0.4050) acc 78.1250 (83.7500) kd_loss 0.8896 (1.0075) lr 1.5878e-03 eta 0:08:20
epoch [17/50] batch [40/167] time 0.085 (0.083) data 0.000 (0.007) loss 0.6486 (0.7269) ce_loss 0.3516 (0.4008) teacher_loss 0.1820 (0.2843) loss_zs_kd 0.0565 (0.0901) loss_oracle 0.4384 (0.3976) acc 90.6250 (85.0781) kd_loss 1.0393 (1.0050) lr 1.5878e-03 eta 0:07:49
epoch [17/50] batch [60/167] time 0.079 (0.083) data 0.001 (0.005) loss 0.6366 (0.7198) ce_loss 0.2593 (0.4005) teacher_loss 0.1021 (0.2837) loss_zs_kd 0.1106 (0.0873) loss_oracle 0.4792 (0.3924) acc 90.6250 (85.0000) kd_loss 1.0335 (1.0068) lr 1.5878e-03 eta 0:07:46
epoch [17/50] batch [80/167] time 0.086 (0.084) data 0.000 (0.003) loss 0.6630 (0.7362) ce_loss 0.4282 (0.4177) teacher_loss 0.2686 (0.2950) loss_zs_kd 0.0768 (0.0907) loss_oracle 0.3560 (0.3959) acc 81.2500 (84.1797) kd_loss 0.9406 (1.0013) lr 1.5878e-03 eta 0:07:48
epoch [17/50] batch [100/167] time 0.087 (0.083) data 0.000 (0.003) loss 0.7628 (0.7372) ce_loss 0.4370 (0.4147) teacher_loss 0.2326 (0.2907) loss_zs_kd 0.1031 (0.0909) loss_oracle 0.4787 (0.4011) acc 84.3750 (84.3750) kd_loss 1.0436 (1.0018) lr 1.5878e-03 eta 0:07:40
epoch [17/50] batch [120/167] time 0.082 (0.082) data 0.000 (0.002) loss 0.6766 (0.7374) ce_loss 0.3630 (0.4122) teacher_loss 0.1984 (0.2858) loss_zs_kd 0.0734 (0.0918) loss_oracle 0.4415 (0.4057) acc 84.3750 (84.5573) kd_loss 0.9733 (1.0006) lr 1.5878e-03 eta 0:07:36
epoch [17/50] batch [140/167] time 0.077 (0.082) data 0.000 (0.002) loss 0.8034 (0.7323) ce_loss 0.4226 (0.4056) teacher_loss 0.2722 (0.2801) loss_zs_kd 0.0747 (0.0909) loss_oracle 0.4938 (0.4068) acc 87.5000 (84.7991) kd_loss 1.0031 (0.9986) lr 1.5878e-03 eta 0:07:31
epoch [17/50] batch [160/167] time 0.074 (0.081) data 0.000 (0.002) loss 0.5635 (0.7336) ce_loss 0.2189 (0.4069) teacher_loss 0.1313 (0.2779) loss_zs_kd 0.0730 (0.0915) loss_oracle 0.3957 (0.4099) acc 90.6250 (84.8438) kd_loss 0.9874 (0.9966) lr 1.5878e-03 eta 0:07:28
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,193
* accuracy: 95.5%
* error: 4.5%
* macro_f1: 96.0%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [18/50] batch [20/167] time 0.070 (0.092) data 0.000 (0.013) loss 0.6782 (0.7337) ce_loss 0.2305 (0.3969) teacher_loss 0.1798 (0.2700) loss_zs_kd 0.0601 (0.0984) loss_oracle 0.4683 (0.4145) acc 90.6250 (84.6875) kd_loss 1.0286 (0.9933) lr 1.5358e-03 eta 0:08:27
epoch [18/50] batch [40/167] time 0.083 (0.085) data 0.000 (0.007) loss 0.7444 (0.7286) ce_loss 0.3345 (0.3984) teacher_loss 0.2132 (0.2719) loss_zs_kd 0.1255 (0.1006) loss_oracle 0.4684 (0.4065) acc 87.5000 (84.3750) kd_loss 0.9987 (0.9857) lr 1.5358e-03 eta 0:07:43
epoch [18/50] batch [60/167] time 0.080 (0.084) data 0.000 (0.005) loss 0.6496 (0.7328) ce_loss 0.3506 (0.4043) teacher_loss 0.2600 (0.2745) loss_zs_kd 0.0867 (0.1027) loss_oracle 0.3463 (0.4069) acc 84.3750 (84.3750) kd_loss 0.9686 (0.9847) lr 1.5358e-03 eta 0:07:37
epoch [18/50] batch [80/167] time 0.089 (0.083) data 0.000 (0.003) loss 0.7300 (0.7383) ce_loss 0.6055 (0.4155) teacher_loss 0.2924 (0.2759) loss_zs_kd 0.0981 (0.1027) loss_oracle 0.3886 (0.4110) acc 75.0000 (83.8281) kd_loss 0.9454 (0.9824) lr 1.5358e-03 eta 0:07:28
epoch [18/50] batch [100/167] time 0.085 (0.082) data 0.000 (0.003) loss 0.7413 (0.7286) ce_loss 0.3042 (0.3993) teacher_loss 0.2078 (0.2579) loss_zs_kd 0.0866 (0.1050) loss_oracle 0.4903 (0.4182) acc 84.3750 (84.5312) kd_loss 0.9580 (0.9830) lr 1.5358e-03 eta 0:07:24
epoch [18/50] batch [120/167] time 0.068 (0.081) data 0.000 (0.002) loss 0.7408 (0.7361) ce_loss 0.3364 (0.4004) teacher_loss 0.2136 (0.2553) loss_zs_kd 0.0959 (0.1072) loss_oracle 0.4793 (0.4272) acc 87.5000 (84.6615) kd_loss 0.9491 (0.9823) lr 1.5358e-03 eta 0:07:18
epoch [18/50] batch [140/167] time 0.072 (0.081) data 0.000 (0.002) loss 0.6709 (0.7401) ce_loss 0.4092 (0.4037) teacher_loss 0.1679 (0.2598) loss_zs_kd 0.1319 (0.1077) loss_oracle 0.4370 (0.4264) acc 87.5000 (84.6205) kd_loss 0.9915 (0.9835) lr 1.5358e-03 eta 0:07:17
epoch [18/50] batch [160/167] time 0.075 (0.081) data 0.000 (0.002) loss 0.7181 (0.7472) ce_loss 0.3257 (0.4105) teacher_loss 0.3169 (0.2661) loss_zs_kd 0.0829 (0.1085) loss_oracle 0.3597 (0.4269) acc 87.5000 (84.4336) kd_loss 0.9649 (0.9851) lr 1.5358e-03 eta 0:07:16
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,188
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [19/50] batch [20/167] time 0.066 (0.087) data 0.000 (0.012) loss 1.0084 (0.7591) ce_loss 0.6523 (0.4199) teacher_loss 0.4723 (0.2828) loss_zs_kd 0.1171 (0.1033) loss_oracle 0.4776 (0.4247) acc 75.0000 (83.9062) kd_loss 1.0360 (0.9953) lr 1.4818e-03 eta 0:07:45
epoch [19/50] batch [40/167] time 0.081 (0.082) data 0.000 (0.006) loss 0.6901 (0.7834) ce_loss 0.3782 (0.4435) teacher_loss 0.2496 (0.2925) loss_zs_kd 0.0740 (0.1073) loss_oracle 0.4035 (0.4372) acc 90.6250 (83.9844) kd_loss 1.0109 (1.0001) lr 1.4818e-03 eta 0:07:17
epoch [19/50] batch [60/167] time 0.071 (0.081) data 0.000 (0.004) loss 0.7977 (0.7673) ce_loss 0.3726 (0.4108) teacher_loss 0.2793 (0.2764) loss_zs_kd 0.0800 (0.1013) loss_oracle 0.4784 (0.4402) acc 84.3750 (84.7917) kd_loss 1.0262 (1.0006) lr 1.4818e-03 eta 0:07:09
epoch [19/50] batch [80/167] time 0.085 (0.080) data 0.000 (0.003) loss 0.8060 (0.7689) ce_loss 0.3767 (0.4137) teacher_loss 0.3665 (0.2834) loss_zs_kd 0.0905 (0.0971) loss_oracle 0.3942 (0.4370) acc 84.3750 (84.9609) kd_loss 0.9819 (1.0016) lr 1.4818e-03 eta 0:07:03
epoch [19/50] batch [100/167] time 0.083 (0.080) data 0.000 (0.003) loss 0.8696 (0.7788) ce_loss 0.5962 (0.4216) teacher_loss 0.4202 (0.2950) loss_zs_kd 0.0942 (0.0971) loss_oracle 0.4024 (0.4352) acc 75.0000 (84.5000) kd_loss 0.9373 (0.9975) lr 1.4818e-03 eta 0:06:58
epoch [19/50] batch [120/167] time 0.086 (0.080) data 0.000 (0.002) loss 0.9315 (0.7650) ce_loss 0.6060 (0.4133) teacher_loss 0.4407 (0.2926) loss_zs_kd 0.0739 (0.0922) loss_oracle 0.4539 (0.4262) acc 78.1250 (84.7917) kd_loss 1.0107 (0.9929) lr 1.4818e-03 eta 0:06:58
epoch [19/50] batch [140/167] time 0.086 (0.081) data 0.000 (0.002) loss 0.6460 (0.7611) ce_loss 0.3376 (0.4167) teacher_loss 0.1819 (0.2945) loss_zs_kd 0.1035 (0.0912) loss_oracle 0.4123 (0.4210) acc 87.5000 (84.7768) kd_loss 1.0138 (0.9933) lr 1.4818e-03 eta 0:06:59
epoch [19/50] batch [160/167] time 0.074 (0.081) data 0.000 (0.002) loss 0.7102 (0.7577) ce_loss 0.4792 (0.4188) teacher_loss 0.2524 (0.2938) loss_zs_kd 0.1059 (0.0918) loss_oracle 0.4048 (0.4181) acc 81.2500 (84.6875) kd_loss 0.9830 (0.9933) lr 1.4818e-03 eta 0:06:58
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,188
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [20/50] batch [20/167] time 0.086 (0.091) data 0.000 (0.013) loss 0.8930 (0.6902) ce_loss 0.6494 (0.3740) teacher_loss 0.3820 (0.2437) loss_zs_kd 0.1413 (0.0943) loss_oracle 0.4403 (0.3994) acc 75.0000 (86.2500) kd_loss 1.0227 (0.9796) lr 1.4258e-03 eta 0:07:48
epoch [20/50] batch [40/167] time 0.083 (0.082) data 0.000 (0.007) loss 0.6492 (0.6907) ce_loss 0.2859 (0.3819) teacher_loss 0.2244 (0.2503) loss_zs_kd 0.0865 (0.0947) loss_oracle 0.3816 (0.3931) acc 90.6250 (85.6250) kd_loss 0.9697 (0.9710) lr 1.4258e-03 eta 0:07:01
epoch [20/50] batch [60/167] time 0.087 (0.079) data 0.001 (0.005) loss 0.6486 (0.6984) ce_loss 0.3896 (0.3967) teacher_loss 0.2289 (0.2598) loss_zs_kd 0.0702 (0.0896) loss_oracle 0.3846 (0.3938) acc 87.5000 (85.1042) kd_loss 1.0402 (0.9710) lr 1.4258e-03 eta 0:06:44
epoch [20/50] batch [80/167] time 0.085 (0.078) data 0.000 (0.004) loss 0.6962 (0.6998) ce_loss 0.4138 (0.3953) teacher_loss 0.2368 (0.2607) loss_zs_kd 0.1250 (0.0896) loss_oracle 0.3968 (0.3943) acc 87.5000 (85.4297) kd_loss 1.0033 (0.9639) lr 1.4258e-03 eta 0:06:39
epoch [20/50] batch [100/167] time 0.077 (0.079) data 0.000 (0.003) loss 0.8593 (0.7009) ce_loss 0.4922 (0.3979) teacher_loss 0.3929 (0.2599) loss_zs_kd 0.1265 (0.0918) loss_oracle 0.4032 (0.3951) acc 81.2500 (85.3125) kd_loss 0.9830 (0.9582) lr 1.4258e-03 eta 0:06:40
epoch [20/50] batch [120/167] time 0.092 (0.079) data 0.000 (0.002) loss 0.8757 (0.7018) ce_loss 0.4648 (0.3983) teacher_loss 0.4445 (0.2586) loss_zs_kd 0.1237 (0.0930) loss_oracle 0.3693 (0.3967) acc 87.5000 (85.3646) kd_loss 0.9306 (0.9532) lr 1.4258e-03 eta 0:06:39
epoch [20/50] batch [140/167] time 0.062 (0.078) data 0.000 (0.002) loss 0.8569 (0.7174) ce_loss 0.4827 (0.4044) teacher_loss 0.2471 (0.2615) loss_zs_kd 0.1103 (0.0961) loss_oracle 0.5546 (0.4078) acc 81.2500 (84.9107) kd_loss 0.9650 (0.9502) lr 1.4258e-03 eta 0:06:35
epoch [20/50] batch [160/167] time 0.075 (0.078) data 0.000 (0.002) loss 0.7659 (0.7261) ce_loss 0.3303 (0.3987) teacher_loss 0.2345 (0.2564) loss_zs_kd 0.0976 (0.0967) loss_oracle 0.4826 (0.4214) acc 87.5000 (85.0586) kd_loss 0.9347 (0.9516) lr 1.4258e-03 eta 0:06:32
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,191
* accuracy: 95.4%
* error: 4.6%
* macro_f1: 95.9%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [21/50] batch [20/167] time 0.081 (0.103) data 0.000 (0.018) loss 0.7223 (0.8938) ce_loss 0.4141 (0.4617) teacher_loss 0.2126 (0.2820) loss_zs_kd 0.0756 (0.1107) loss_oracle 0.4719 (0.5565) acc 87.5000 (82.8125) kd_loss 0.8916 (0.9857) lr 1.3681e-03 eta 0:08:35
epoch [21/50] batch [40/167] time 0.084 (0.093) data 0.000 (0.009) loss 0.7047 (0.8777) ce_loss 0.3862 (0.4440) teacher_loss 0.1597 (0.2625) loss_zs_kd 0.1325 (0.1199) loss_oracle 0.4787 (0.5552) acc 87.5000 (83.5156) kd_loss 0.9537 (0.9701) lr 1.3681e-03 eta 0:07:41
epoch [21/50] batch [60/167] time 0.096 (0.090) data 0.001 (0.006) loss 0.8952 (0.8636) ce_loss 0.2537 (0.4312) teacher_loss 0.2200 (0.2581) loss_zs_kd 0.1118 (0.1187) loss_oracle 0.6193 (0.5461) acc 90.6250 (84.2188) kd_loss 1.0079 (0.9636) lr 1.3681e-03 eta 0:07:25
epoch [21/50] batch [80/167] time 0.086 (0.089) data 0.000 (0.005) loss 0.8211 (0.8509) ce_loss 0.3872 (0.4181) teacher_loss 0.1919 (0.2519) loss_zs_kd 0.1530 (0.1173) loss_oracle 0.5526 (0.5404) acc 84.3750 (84.8828) kd_loss 0.9968 (0.9589) lr 1.3681e-03 eta 0:07:18
epoch [21/50] batch [100/167] time 0.089 (0.088) data 0.000 (0.004) loss 0.7475 (0.8467) ce_loss 0.3665 (0.4203) teacher_loss 0.1704 (0.2500) loss_zs_kd 0.1307 (0.1189) loss_oracle 0.5117 (0.5373) acc 87.5000 (84.6562) kd_loss 0.9689 (0.9549) lr 1.3681e-03 eta 0:07:10
epoch [21/50] batch [120/167] time 0.089 (0.087) data 0.000 (0.003) loss 0.7596 (0.8378) ce_loss 0.4585 (0.4194) teacher_loss 0.1734 (0.2503) loss_zs_kd 0.1487 (0.1172) loss_oracle 0.5118 (0.5289) acc 81.2500 (84.5573) kd_loss 1.0121 (0.9585) lr 1.3681e-03 eta 0:07:06
epoch [21/50] batch [140/167] time 0.071 (0.086) data 0.000 (0.003) loss 0.7670 (0.8317) ce_loss 0.4292 (0.4195) teacher_loss 0.1790 (0.2476) loss_zs_kd 0.1551 (0.1176) loss_oracle 0.5105 (0.5253) acc 84.3750 (84.5312) kd_loss 0.9974 (0.9573) lr 1.3681e-03 eta 0:07:00
epoch [21/50] batch [160/167] time 0.075 (0.085) data 0.000 (0.003) loss 0.8235 (0.8260) ce_loss 0.4507 (0.4202) teacher_loss 0.2305 (0.2483) loss_zs_kd 0.1146 (0.1166) loss_oracle 0.5357 (0.5193) acc 81.2500 (84.5117) kd_loss 0.9697 (0.9586) lr 1.3681e-03 eta 0:06:53
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,187
* accuracy: 95.2%
* error: 4.8%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,322
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [22/50] batch [20/167] time 0.072 (0.094) data 0.000 (0.016) loss 0.7978 (0.7286) ce_loss 0.4556 (0.3896) teacher_loss 0.2614 (0.2299) loss_zs_kd 0.1531 (0.1094) loss_oracle 0.4599 (0.4439) acc 84.3750 (85.6250) kd_loss 0.9599 (0.9772) lr 1.3090e-03 eta 0:07:35
epoch [22/50] batch [40/167] time 0.069 (0.084) data 0.000 (0.008) loss 0.7399 (0.7435) ce_loss 0.4685 (0.4016) teacher_loss 0.2301 (0.2393) loss_zs_kd 0.1222 (0.1065) loss_oracle 0.4486 (0.4510) acc 81.2500 (84.7656) kd_loss 0.9252 (0.9692) lr 1.3090e-03 eta 0:06:41
epoch [22/50] batch [60/167] time 0.062 (0.078) data 0.001 (0.006) loss 0.6610 (0.7338) ce_loss 0.1581 (0.3873) teacher_loss 0.0739 (0.2313) loss_zs_kd 0.0809 (0.1067) loss_oracle 0.5467 (0.4491) acc 93.7500 (85.5729) kd_loss 0.9718 (0.9656) lr 1.3090e-03 eta 0:06:13
epoch [22/50] batch [80/167] time 0.071 (0.077) data 0.000 (0.004) loss 0.7288 (0.7469) ce_loss 0.3508 (0.4010) teacher_loss 0.1724 (0.2366) loss_zs_kd 0.1331 (0.1088) loss_oracle 0.4899 (0.4560) acc 84.3750 (84.9609) kd_loss 1.0079 (0.9687) lr 1.3090e-03 eta 0:06:04
epoch [22/50] batch [100/167] time 0.062 (0.075) data 0.000 (0.003) loss 0.6531 (0.7478) ce_loss 0.1711 (0.3829) teacher_loss 0.1056 (0.2286) loss_zs_kd 0.0662 (0.1087) loss_oracle 0.5145 (0.4649) acc 93.7500 (85.8125) kd_loss 0.9863 (0.9686) lr 1.3090e-03 eta 0:05:57
epoch [22/50] batch [120/167] time 0.072 (0.075) data 0.000 (0.003) loss 1.0536 (0.7717) ce_loss 0.5225 (0.3921) teacher_loss 0.3153 (0.2373) loss_zs_kd 0.1441 (0.1073) loss_oracle 0.6662 (0.4807) acc 84.3750 (85.4427) kd_loss 0.9841 (0.9621) lr 1.3090e-03 eta 0:05:52
epoch [22/50] batch [140/167] time 0.063 (0.073) data 0.000 (0.003) loss 1.0269 (0.7941) ce_loss 0.5532 (0.3937) teacher_loss 0.3541 (0.2398) loss_zs_kd 0.1512 (0.1081) loss_oracle 0.5971 (0.5002) acc 75.0000 (85.4688) kd_loss 0.8254 (0.9600) lr 1.3090e-03 eta 0:05:45
epoch [22/50] batch [160/167] time 0.073 (0.074) data 0.000 (0.002) loss 0.9794 (0.8118) ce_loss 0.3833 (0.4000) teacher_loss 0.2601 (0.2466) loss_zs_kd 0.1014 (0.1101) loss_oracle 0.6686 (0.5102) acc 84.3750 (85.1758) kd_loss 0.9610 (0.9565) lr 1.3090e-03 eta 0:05:44
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,195
* accuracy: 95.6%
* error: 4.4%
* macro_f1: 96.0%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,322
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [23/50] batch [20/167] time 0.086 (0.094) data 0.000 (0.013) loss 0.9278 (0.9872) ce_loss 0.3557 (0.4169) teacher_loss 0.2644 (0.3135) loss_zs_kd 0.1110 (0.1133) loss_oracle 0.6079 (0.6170) acc 87.5000 (83.4375) kd_loss 0.9468 (0.9151) lr 1.2487e-03 eta 0:07:16
epoch [23/50] batch [40/167] time 0.072 (0.087) data 0.000 (0.006) loss 1.0683 (0.9666) ce_loss 0.4048 (0.3904) teacher_loss 0.3261 (0.2976) loss_zs_kd 0.0562 (0.1012) loss_oracle 0.7141 (0.6184) acc 87.5000 (85.2344) kd_loss 0.9389 (0.9137) lr 1.2487e-03 eta 0:06:41
epoch [23/50] batch [60/167] time 0.091 (0.082) data 0.001 (0.004) loss 1.0258 (0.9975) ce_loss 0.3406 (0.4086) teacher_loss 0.2529 (0.3158) loss_zs_kd 0.1004 (0.0967) loss_oracle 0.7227 (0.6334) acc 87.5000 (85.2083) kd_loss 0.9072 (0.9154) lr 1.2487e-03 eta 0:06:19
epoch [23/50] batch [80/167] time 0.085 (0.083) data 0.000 (0.003) loss 1.2997 (1.0272) ce_loss 0.7329 (0.4190) teacher_loss 0.5333 (0.3265) loss_zs_kd 0.0929 (0.0960) loss_oracle 0.7199 (0.6527) acc 75.0000 (84.4531) kd_loss 0.9628 (0.9178) lr 1.2487e-03 eta 0:06:23
epoch [23/50] batch [100/167] time 0.073 (0.082) data 0.000 (0.003) loss 1.1835 (1.0301) ce_loss 0.5171 (0.4086) teacher_loss 0.4204 (0.3207) loss_zs_kd 0.0858 (0.0937) loss_oracle 0.7201 (0.6626) acc 81.2500 (84.7188) kd_loss 0.8710 (0.9205) lr 1.2487e-03 eta 0:06:13
epoch [23/50] batch [120/167] time 0.083 (0.081) data 0.000 (0.002) loss 0.9831 (1.0454) ce_loss 0.2974 (0.4123) teacher_loss 0.1963 (0.3266) loss_zs_kd 0.0607 (0.0920) loss_oracle 0.7563 (0.6728) acc 87.5000 (84.4531) kd_loss 1.0087 (0.9268) lr 1.2487e-03 eta 0:06:09
epoch [23/50] batch [140/167] time 0.093 (0.081) data 0.000 (0.002) loss 1.2688 (1.0444) ce_loss 0.6597 (0.4121) teacher_loss 0.5072 (0.3270) loss_zs_kd 0.1333 (0.0897) loss_oracle 0.6949 (0.6726) acc 81.2500 (84.3080) kd_loss 0.9704 (0.9305) lr 1.2487e-03 eta 0:06:08
epoch [23/50] batch [160/167] time 0.073 (0.081) data 0.000 (0.002) loss 0.9915 (1.0508) ce_loss 0.3289 (0.4190) teacher_loss 0.2655 (0.3346) loss_zs_kd 0.0743 (0.0881) loss_oracle 0.6889 (0.6721) acc 90.6250 (84.0430) kd_loss 0.9644 (0.9331) lr 1.2487e-03 eta 0:06:05
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,186
* accuracy: 95.2%
* error: 4.8%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [24/50] batch [20/167] time 0.063 (0.099) data 0.000 (0.017) loss 1.1144 (1.0225) ce_loss 0.5723 (0.3923) teacher_loss 0.4172 (0.3202) loss_zs_kd 0.0883 (0.0670) loss_oracle 0.6531 (0.6688) acc 81.2500 (85.9375) kd_loss 0.9157 (0.9481) lr 1.1874e-03 eta 0:07:25
epoch [24/50] batch [40/167] time 0.077 (0.088) data 0.000 (0.008) loss 1.0090 (1.0168) ce_loss 0.4048 (0.3955) teacher_loss 0.3341 (0.3271) loss_zs_kd 0.0933 (0.0707) loss_oracle 0.6283 (0.6543) acc 81.2500 (85.4688) kd_loss 0.9852 (0.9539) lr 1.1874e-03 eta 0:06:34
epoch [24/50] batch [60/167] time 0.065 (0.086) data 0.000 (0.006) loss 1.1668 (1.0200) ce_loss 0.5762 (0.4102) teacher_loss 0.4930 (0.3408) loss_zs_kd 0.1030 (0.0730) loss_oracle 0.6222 (0.6427) acc 75.0000 (84.6354) kd_loss 0.9593 (0.9562) lr 1.1874e-03 eta 0:06:23
epoch [24/50] batch [80/167] time 0.085 (0.085) data 0.000 (0.004) loss 0.9477 (0.9977) ce_loss 0.3142 (0.4018) teacher_loss 0.2542 (0.3321) loss_zs_kd 0.0496 (0.0720) loss_oracle 0.6687 (0.6296) acc 90.6250 (85.0391) kd_loss 0.9815 (0.9614) lr 1.1874e-03 eta 0:06:16
epoch [24/50] batch [100/167] time 0.067 (0.085) data 0.000 (0.004) loss 0.6360 (0.9878) ce_loss 0.2125 (0.4023) teacher_loss 0.1617 (0.3324) loss_zs_kd 0.0288 (0.0715) loss_oracle 0.4599 (0.6197) acc 87.5000 (85.0312) kd_loss 1.0294 (0.9670) lr 1.1874e-03 eta 0:06:14
epoch [24/50] batch [120/167] time 0.083 (0.084) data 0.000 (0.003) loss 0.9380 (0.9805) ce_loss 0.3853 (0.3999) teacher_loss 0.2650 (0.3308) loss_zs_kd 0.0828 (0.0720) loss_oracle 0.6317 (0.6138) acc 84.3750 (84.8958) kd_loss 1.0084 (0.9703) lr 1.1874e-03 eta 0:06:08
epoch [24/50] batch [140/167] time 0.063 (0.084) data 0.000 (0.003) loss 1.2255 (0.9786) ce_loss 0.6680 (0.3996) teacher_loss 0.5461 (0.3295) loss_zs_kd 0.0865 (0.0722) loss_oracle 0.6361 (0.6130) acc 78.1250 (84.9777) kd_loss 0.9734 (0.9699) lr 1.1874e-03 eta 0:06:05
epoch [24/50] batch [160/167] time 0.075 (0.083) data 0.000 (0.002) loss 1.0433 (0.9754) ce_loss 0.5161 (0.3992) teacher_loss 0.4040 (0.3291) loss_zs_kd 0.0705 (0.0714) loss_oracle 0.6040 (0.6106) acc 81.2500 (84.9023) kd_loss 0.9471 (0.9664) lr 1.1874e-03 eta 0:06:00
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,186
* accuracy: 95.2%
* error: 4.8%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.6%, epoch: 9 *******
******* Domain c best val test acc: 99.1%, epoch: 9 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [25/50] batch [20/167] time 0.081 (0.105) data 0.000 (0.017) loss 0.7951 (0.9329) ce_loss 0.3274 (0.4076) teacher_loss 0.1944 (0.3376) loss_zs_kd 0.0407 (0.0717) loss_oracle 0.5803 (0.5594) acc 81.2500 (83.4375) kd_loss 0.9902 (0.9605) lr 1.1253e-03 eta 0:07:35
epoch [25/50] batch [40/167] time 0.083 (0.094) data 0.000 (0.009) loss 0.5949 (0.9013) ce_loss 0.0932 (0.3843) teacher_loss 0.0709 (0.3174) loss_zs_kd 0.0475 (0.0682) loss_oracle 0.5003 (0.5498) acc 100.0000 (84.3750) kd_loss 1.0371 (0.9617) lr 1.1253e-03 eta 0:06:43
epoch [25/50] batch [60/167] time 0.085 (0.090) data 0.000 (0.006) loss 0.8714 (0.9085) ce_loss 0.4167 (0.3991) teacher_loss 0.2683 (0.3240) loss_zs_kd 0.0728 (0.0710) loss_oracle 0.5667 (0.5490) acc 81.2500 (84.4271) kd_loss 0.9033 (0.9608) lr 1.1253e-03 eta 0:06:26
epoch [25/50] batch [80/167] time 0.084 (0.089) data 0.000 (0.005) loss 0.8668 (0.8949) ce_loss 0.3064 (0.3891) teacher_loss 0.1964 (0.3130) loss_zs_kd 0.1264 (0.0719) loss_oracle 0.6072 (0.5459) acc 93.7500 (84.9609) kd_loss 0.9592 (0.9552) lr 1.1253e-03 eta 0:06:19
epoch [25/50] batch [100/167] time 0.088 (0.088) data 0.000 (0.004) loss 0.9093 (0.8990) ce_loss 0.4634 (0.3955) teacher_loss 0.3283 (0.3151) loss_zs_kd 0.0847 (0.0714) loss_oracle 0.5387 (0.5482) acc 81.2500 (84.6562) kd_loss 0.9685 (0.9488) lr 1.1253e-03 eta 0:06:13
epoch [25/50] batch [120/167] time 0.080 (0.087) data 0.000 (0.003) loss 0.8166 (0.9043) ce_loss 0.3804 (0.4024) teacher_loss 0.2705 (0.3194) loss_zs_kd 0.0714 (0.0736) loss_oracle 0.5104 (0.5480) acc 81.2500 (84.2448) kd_loss 0.8530 (0.9449) lr 1.1253e-03 eta 0:06:07
epoch [25/50] batch [140/167] time 0.083 (0.086) data 0.000 (0.003) loss 0.7956 (0.9030) ce_loss 0.3193 (0.3992) teacher_loss 0.2285 (0.3175) loss_zs_kd 0.0551 (0.0748) loss_oracle 0.5395 (0.5481) acc 84.3750 (84.4643) kd_loss 0.8223 (0.9457) lr 1.1253e-03 eta 0:06:03
epoch [25/50] batch [160/167] time 0.073 (0.085) data 0.000 (0.002) loss 0.9849 (0.9053) ce_loss 0.4258 (0.4037) teacher_loss 0.3331 (0.3204) loss_zs_kd 0.0828 (0.0744) loss_oracle 0.6104 (0.5477) acc 78.1250 (84.2578) kd_loss 0.8899 (0.9422) lr 1.1253e-03 eta 0:05:56
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,201
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.3%
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [26/50] batch [20/167] time 0.082 (0.106) data 0.000 (0.017) loss 0.7001 (0.8349) ce_loss 0.3330 (0.3612) teacher_loss 0.2099 (0.2834) loss_zs_kd 0.0694 (0.0867) loss_oracle 0.4554 (0.5081) acc 84.3750 (86.5625) kd_loss 0.8969 (0.9078) lr 1.0628e-03 eta 0:07:19
epoch [26/50] batch [40/167] time 0.077 (0.096) data 0.000 (0.009) loss 0.8144 (0.8500) ce_loss 0.3689 (0.3893) teacher_loss 0.2955 (0.3001) loss_zs_kd 0.0843 (0.0865) loss_oracle 0.4767 (0.5067) acc 84.3750 (85.7031) kd_loss 0.9337 (0.9166) lr 1.0628e-03 eta 0:06:37
epoch [26/50] batch [60/167] time 0.092 (0.092) data 0.000 (0.006) loss 0.8547 (0.8569) ce_loss 0.4058 (0.4028) teacher_loss 0.2936 (0.2985) loss_zs_kd 0.1039 (0.0925) loss_oracle 0.5092 (0.5121) acc 84.3750 (85.0521) kd_loss 0.9655 (0.9208) lr 1.0628e-03 eta 0:06:18
epoch [26/50] batch [80/167] time 0.082 (0.091) data 0.000 (0.004) loss 0.8342 (0.8554) ce_loss 0.3513 (0.4051) teacher_loss 0.2530 (0.2949) loss_zs_kd 0.0953 (0.0943) loss_oracle 0.5335 (0.5133) acc 87.5000 (84.8047) kd_loss 1.0186 (0.9227) lr 1.0628e-03 eta 0:06:11
epoch [26/50] batch [100/167] time 0.096 (0.090) data 0.001 (0.004) loss 0.9303 (0.8565) ce_loss 0.5283 (0.4095) teacher_loss 0.4191 (0.2937) loss_zs_kd 0.0862 (0.0969) loss_oracle 0.4680 (0.5144) acc 81.2500 (84.5312) kd_loss 0.9265 (0.9256) lr 1.0628e-03 eta 0:06:07
epoch [26/50] batch [120/167] time 0.093 (0.090) data 0.000 (0.003) loss 0.8361 (0.8503) ce_loss 0.5015 (0.4137) teacher_loss 0.3460 (0.2909) loss_zs_kd 0.0890 (0.0979) loss_oracle 0.4456 (0.5105) acc 81.2500 (84.5312) kd_loss 0.9177 (0.9304) lr 1.0628e-03 eta 0:06:05
epoch [26/50] batch [140/167] time 0.085 (0.090) data 0.000 (0.003) loss 0.9617 (0.8405) ce_loss 0.5200 (0.4084) teacher_loss 0.4097 (0.2817) loss_zs_kd 0.1398 (0.0992) loss_oracle 0.4821 (0.5091) acc 81.2500 (84.8214) kd_loss 0.9648 (0.9335) lr 1.0628e-03 eta 0:06:01
epoch [26/50] batch [160/167] time 0.078 (0.089) data 0.000 (0.002) loss 0.8385 (0.8365) ce_loss 0.4019 (0.4117) teacher_loss 0.3001 (0.2824) loss_zs_kd 0.1123 (0.0991) loss_oracle 0.4822 (0.5045) acc 84.3750 (84.8047) kd_loss 0.9448 (0.9363) lr 1.0628e-03 eta 0:05:55
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,187
* accuracy: 95.2%
* error: 4.8%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [27/50] batch [20/167] time 0.080 (0.098) data 0.000 (0.013) loss 0.8164 (0.7475) ce_loss 0.5039 (0.4075) teacher_loss 0.2136 (0.2263) loss_zs_kd 0.2078 (0.1099) loss_oracle 0.4989 (0.4662) acc 87.5000 (84.6875) kd_loss 1.0318 (1.0131) lr 1.0000e-03 eta 0:06:29
epoch [27/50] batch [40/167] time 0.088 (0.090) data 0.000 (0.007) loss 0.5444 (0.7766) ce_loss 0.1749 (0.4243) teacher_loss 0.0876 (0.2570) loss_zs_kd 0.0852 (0.1102) loss_oracle 0.4142 (0.4645) acc 90.6250 (84.0625) kd_loss 0.9832 (0.9949) lr 1.0000e-03 eta 0:05:58
epoch [27/50] batch [60/167] time 0.085 (0.088) data 0.000 (0.005) loss 0.7990 (0.7698) ce_loss 0.5762 (0.4314) teacher_loss 0.2380 (0.2603) loss_zs_kd 0.1598 (0.1102) loss_oracle 0.4811 (0.4544) acc 75.0000 (83.9062) kd_loss 1.0314 (0.9977) lr 1.0000e-03 eta 0:05:49
epoch [27/50] batch [80/167] time 0.092 (0.088) data 0.000 (0.004) loss 0.6494 (0.7572) ce_loss 0.1626 (0.4206) teacher_loss 0.1062 (0.2459) loss_zs_kd 0.1091 (0.1120) loss_oracle 0.4886 (0.4552) acc 96.8750 (84.2188) kd_loss 0.9834 (1.0029) lr 1.0000e-03 eta 0:05:45
epoch [27/50] batch [100/167] time 0.084 (0.088) data 0.000 (0.003) loss 0.5527 (0.7605) ce_loss 0.0755 (0.4207) teacher_loss 0.0317 (0.2479) loss_zs_kd 0.0729 (0.1111) loss_oracle 0.4845 (0.4570) acc 100.0000 (84.1875) kd_loss 1.0200 (1.0030) lr 1.0000e-03 eta 0:05:44
epoch [27/50] batch [120/167] time 0.085 (0.088) data 0.000 (0.002) loss 0.5958 (0.7535) ce_loss 0.2228 (0.4119) teacher_loss 0.1033 (0.2431) loss_zs_kd 0.0679 (0.1124) loss_oracle 0.4586 (0.4542) acc 90.6250 (84.5052) kd_loss 1.0934 (1.0029) lr 1.0000e-03 eta 0:05:41
epoch [27/50] batch [140/167] time 0.087 (0.088) data 0.000 (0.002) loss 0.6267 (0.7507) ce_loss 0.2290 (0.4095) teacher_loss 0.1413 (0.2436) loss_zs_kd 0.1103 (0.1108) loss_oracle 0.4303 (0.4517) acc 93.7500 (84.6205) kd_loss 1.0241 (0.9998) lr 1.0000e-03 eta 0:05:39
epoch [27/50] batch [160/167] time 0.078 (0.087) data 0.000 (0.002) loss 0.6836 (0.7517) ce_loss 0.2568 (0.4086) teacher_loss 0.1584 (0.2455) loss_zs_kd 0.0880 (0.1088) loss_oracle 0.4812 (0.4518) acc 87.5000 (84.7070) kd_loss 1.0445 (0.9982) lr 1.0000e-03 eta 0:05:35
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,182
* accuracy: 95.0%
* error: 5.0%
* macro_f1: 95.5%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [28/50] batch [20/167] time 0.083 (0.097) data 0.000 (0.013) loss 0.7952 (0.7557) ce_loss 0.4832 (0.4084) teacher_loss 0.2449 (0.2559) loss_zs_kd 0.0789 (0.0954) loss_oracle 0.5109 (0.4522) acc 81.2500 (85.7812) kd_loss 0.9885 (1.0002) lr 9.3721e-04 eta 0:06:12
epoch [28/50] batch [40/167] time 0.093 (0.092) data 0.000 (0.007) loss 0.6844 (0.7478) ce_loss 0.4109 (0.4063) teacher_loss 0.2063 (0.2521) loss_zs_kd 0.0912 (0.1002) loss_oracle 0.4325 (0.4456) acc 84.3750 (85.3125) kd_loss 0.9915 (0.9925) lr 9.3721e-04 eta 0:05:49
epoch [28/50] batch [60/167] time 0.083 (0.089) data 0.001 (0.005) loss 0.7064 (0.7376) ce_loss 0.4368 (0.4060) teacher_loss 0.2314 (0.2442) loss_zs_kd 0.0705 (0.1026) loss_oracle 0.4398 (0.4422) acc 81.2500 (85.2604) kd_loss 0.9959 (0.9965) lr 9.3721e-04 eta 0:05:35
epoch [28/50] batch [80/167] time 0.084 (0.088) data 0.000 (0.004) loss 0.7317 (0.7377) ce_loss 0.4543 (0.4135) teacher_loss 0.1914 (0.2451) loss_zs_kd 0.1458 (0.1065) loss_oracle 0.4674 (0.4393) acc 87.5000 (84.8047) kd_loss 1.0604 (1.0048) lr 9.3721e-04 eta 0:05:30
epoch [28/50] batch [100/167] time 0.094 (0.087) data 0.000 (0.003) loss 0.7325 (0.7304) ce_loss 0.3823 (0.4040) teacher_loss 0.2860 (0.2412) loss_zs_kd 0.0980 (0.1062) loss_oracle 0.3975 (0.4361) acc 84.3750 (85.2188) kd_loss 1.0456 (1.0041) lr 9.3721e-04 eta 0:05:26
epoch [28/50] batch [120/167] time 0.083 (0.087) data 0.000 (0.002) loss 0.7460 (0.7407) ce_loss 0.4441 (0.4135) teacher_loss 0.2521 (0.2479) loss_zs_kd 0.0846 (0.1073) loss_oracle 0.4517 (0.4391) acc 84.3750 (85.0260) kd_loss 0.9933 (1.0040) lr 9.3721e-04 eta 0:05:22
epoch [28/50] batch [140/167] time 0.088 (0.086) data 0.000 (0.002) loss 0.8421 (0.7353) ce_loss 0.4666 (0.4051) teacher_loss 0.3006 (0.2436) loss_zs_kd 0.1134 (0.1072) loss_oracle 0.4848 (0.4380) acc 81.2500 (85.3571) kd_loss 1.0344 (1.0046) lr 9.3721e-04 eta 0:05:19
epoch [28/50] batch [160/167] time 0.074 (0.086) data 0.000 (0.002) loss 0.8216 (0.7337) ce_loss 0.4629 (0.4043) teacher_loss 0.2923 (0.2418) loss_zs_kd 0.1055 (0.1074) loss_oracle 0.4766 (0.4382) acc 84.3750 (85.3125) kd_loss 0.9514 (1.0036) lr 9.3721e-04 eta 0:05:15
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,191
* accuracy: 95.4%
* error: 4.6%
* macro_f1: 95.9%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,323
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [29/50] batch [20/167] time 0.080 (0.106) data 0.000 (0.019) loss 0.7578 (0.7527) ce_loss 0.3452 (0.4103) teacher_loss 0.2527 (0.2569) loss_zs_kd 0.1094 (0.1114) loss_oracle 0.4504 (0.4401) acc 90.6250 (85.6250) kd_loss 1.0179 (0.9942) lr 8.7467e-04 eta 0:06:27
epoch [29/50] batch [40/167] time 0.082 (0.094) data 0.000 (0.010) loss 0.7900 (0.7359) ce_loss 0.5308 (0.3956) teacher_loss 0.2665 (0.2432) loss_zs_kd 0.1490 (0.1103) loss_oracle 0.4490 (0.4376) acc 78.1250 (85.4688) kd_loss 0.9424 (0.9873) lr 8.7467e-04 eta 0:05:41
epoch [29/50] batch [60/167] time 0.084 (0.090) data 0.001 (0.006) loss 0.8542 (0.7499) ce_loss 0.4429 (0.3991) teacher_loss 0.3516 (0.2493) loss_zs_kd 0.1232 (0.1081) loss_oracle 0.4410 (0.4466) acc 81.2500 (85.1042) kd_loss 0.9494 (0.9859) lr 8.7467e-04 eta 0:05:24
epoch [29/50] batch [80/167] time 0.089 (0.088) data 0.000 (0.005) loss 0.4874 (0.7443) ce_loss 0.1492 (0.3951) teacher_loss 0.0656 (0.2475) loss_zs_kd 0.0487 (0.1043) loss_oracle 0.3974 (0.4446) acc 96.8750 (85.1562) kd_loss 1.0003 (0.9818) lr 8.7467e-04 eta 0:05:17
epoch [29/50] batch [100/167] time 0.081 (0.088) data 0.000 (0.004) loss 0.8846 (0.7432) ce_loss 0.6831 (0.4026) teacher_loss 0.3773 (0.2500) loss_zs_kd 0.1547 (0.1048) loss_oracle 0.4299 (0.4408) acc 75.0000 (84.9688) kd_loss 1.0011 (0.9808) lr 8.7467e-04 eta 0:05:15
epoch [29/50] batch [120/167] time 0.085 (0.088) data 0.000 (0.003) loss 0.8220 (0.7436) ce_loss 0.4277 (0.4064) teacher_loss 0.2119 (0.2484) loss_zs_kd 0.1687 (0.1066) loss_oracle 0.5257 (0.4419) acc 81.2500 (84.7396) kd_loss 1.0433 (0.9764) lr 8.7467e-04 eta 0:05:12
epoch [29/50] batch [140/167] time 0.090 (0.088) data 0.000 (0.003) loss 0.8482 (0.7505) ce_loss 0.4175 (0.4098) teacher_loss 0.3118 (0.2510) loss_zs_kd 0.1039 (0.1065) loss_oracle 0.4844 (0.4463) acc 84.3750 (84.8661) kd_loss 0.9217 (0.9719) lr 8.7467e-04 eta 0:05:10
epoch [29/50] batch [160/167] time 0.074 (0.087) data 0.000 (0.003) loss 0.7180 (0.7554) ce_loss 0.2360 (0.4163) teacher_loss 0.1321 (0.2520) loss_zs_kd 0.1041 (0.1089) loss_oracle 0.5339 (0.4489) acc 93.7500 (84.4727) kd_loss 0.9504 (0.9677) lr 8.7467e-04 eta 0:05:06
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,185
* accuracy: 95.1%
* error: 4.9%
* macro_f1: 95.6%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,322
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [30/50] batch [20/167] time 0.095 (0.106) data 0.000 (0.018) loss 0.7310 (0.7737) ce_loss 0.2788 (0.4369) teacher_loss 0.1797 (0.2555) loss_zs_kd 0.0948 (0.1116) loss_oracle 0.5039 (0.4624) acc 90.6250 (84.5312) kd_loss 0.9442 (0.9529) lr 8.1262e-04 eta 0:06:10
epoch [30/50] batch [40/167] time 0.078 (0.095) data 0.000 (0.009) loss 0.7575 (0.7647) ce_loss 0.4956 (0.4414) teacher_loss 0.2344 (0.2576) loss_zs_kd 0.1044 (0.1073) loss_oracle 0.4709 (0.4534) acc 84.3750 (83.7500) kd_loss 0.9805 (0.9638) lr 8.1262e-04 eta 0:05:30
epoch [30/50] batch [60/167] time 0.082 (0.092) data 0.000 (0.006) loss 0.8112 (0.7503) ce_loss 0.3479 (0.4295) teacher_loss 0.2325 (0.2473) loss_zs_kd 0.1364 (0.1117) loss_oracle 0.5105 (0.4471) acc 87.5000 (84.2188) kd_loss 0.9939 (0.9770) lr 8.1262e-04 eta 0:05:17
epoch [30/50] batch [80/167] time 0.094 (0.091) data 0.000 (0.005) loss 0.7822 (0.7596) ce_loss 0.5283 (0.4305) teacher_loss 0.3047 (0.2546) loss_zs_kd 0.1592 (0.1154) loss_oracle 0.3979 (0.4473) acc 84.3750 (83.9062) kd_loss 1.0145 (0.9784) lr 8.1262e-04 eta 0:05:10
epoch [30/50] batch [100/167] time 0.084 (0.090) data 0.000 (0.004) loss 0.7481 (0.7597) ce_loss 0.3892 (0.4339) teacher_loss 0.2354 (0.2569) loss_zs_kd 0.1403 (0.1148) loss_oracle 0.4426 (0.4454) acc 87.5000 (83.8750) kd_loss 0.9079 (0.9807) lr 8.1262e-04 eta 0:05:06
epoch [30/50] batch [120/167] time 0.087 (0.090) data 0.000 (0.003) loss 0.9200 (0.7616) ce_loss 0.6035 (0.4372) teacher_loss 0.3203 (0.2602) loss_zs_kd 0.1465 (0.1151) loss_oracle 0.5265 (0.4438) acc 78.1250 (83.8021) kd_loss 1.0222 (0.9891) lr 8.1262e-04 eta 0:05:03
epoch [30/50] batch [140/167] time 0.089 (0.089) data 0.000 (0.003) loss 0.7627 (0.7624) ce_loss 0.3767 (0.4377) teacher_loss 0.2615 (0.2624) loss_zs_kd 0.1589 (0.1153) loss_oracle 0.4218 (0.4423) acc 84.3750 (83.9062) kd_loss 1.1120 (0.9966) lr 8.1262e-04 eta 0:05:00
epoch [30/50] batch [160/167] time 0.073 (0.089) data 0.000 (0.003) loss 0.8994 (0.7556) ce_loss 0.4275 (0.4319) teacher_loss 0.3313 (0.2586) loss_zs_kd 0.1136 (0.1148) loss_oracle 0.5113 (0.4397) acc 78.1250 (84.0625) kd_loss 1.0607 (1.0037) lr 8.1262e-04 eta 0:04:56
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,182
* accuracy: 95.0%
* error: 5.0%
* macro_f1: 95.5%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,325
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.3%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [31/50] batch [20/167] time 0.073 (0.099) data 0.000 (0.015) loss 0.5569 (0.6935) ce_loss 0.2206 (0.3807) teacher_loss 0.1587 (0.2306) loss_zs_kd 0.0913 (0.1033) loss_oracle 0.3525 (0.4112) acc 93.7500 (85.1562) kd_loss 1.1153 (1.0677) lr 7.5131e-04 eta 0:05:27
epoch [31/50] batch [40/167] time 0.090 (0.090) data 0.000 (0.008) loss 0.7009 (0.7032) ce_loss 0.3950 (0.3914) teacher_loss 0.2145 (0.2374) loss_zs_kd 0.1543 (0.1071) loss_oracle 0.4093 (0.4122) acc 87.5000 (85.0000) kd_loss 1.0696 (1.0683) lr 7.5131e-04 eta 0:04:56
epoch [31/50] batch [60/167] time 0.066 (0.087) data 0.001 (0.005) loss 0.5020 (0.6991) ce_loss 0.1887 (0.3915) teacher_loss 0.0975 (0.2286) loss_zs_kd 0.0965 (0.1114) loss_oracle 0.3563 (0.4148) acc 90.6250 (84.7396) kd_loss 1.0182 (1.0723) lr 7.5131e-04 eta 0:04:44
epoch [31/50] batch [80/167] time 0.088 (0.085) data 0.000 (0.004) loss 0.5366 (0.7028) ce_loss 0.1797 (0.3915) teacher_loss 0.1189 (0.2326) loss_zs_kd 0.1043 (0.1102) loss_oracle 0.3655 (0.4151) acc 93.7500 (85.0781) kd_loss 1.1642 (1.0735) lr 7.5131e-04 eta 0:04:36
epoch [31/50] batch [100/167] time 0.066 (0.084) data 0.000 (0.003) loss 0.4966 (0.7001) ce_loss 0.1743 (0.3813) teacher_loss 0.0984 (0.2304) loss_zs_kd 0.0498 (0.1087) loss_oracle 0.3733 (0.4153) acc 90.6250 (85.7500) kd_loss 1.1171 (1.0781) lr 7.5131e-04 eta 0:04:31
epoch [31/50] batch [120/167] time 0.079 (0.084) data 0.000 (0.003) loss 0.6248 (0.7095) ce_loss 0.2456 (0.3926) teacher_loss 0.1307 (0.2396) loss_zs_kd 0.0896 (0.1073) loss_oracle 0.4493 (0.4163) acc 93.7500 (85.2865) kd_loss 1.1330 (1.0823) lr 7.5131e-04 eta 0:04:29
epoch [31/50] batch [140/167] time 0.069 (0.083) data 0.000 (0.002) loss 0.8528 (0.7153) ce_loss 0.5161 (0.3988) teacher_loss 0.3823 (0.2455) loss_zs_kd 0.1134 (0.1100) loss_oracle 0.4138 (0.4147) acc 78.1250 (84.9554) kd_loss 1.1270 (1.0831) lr 7.5131e-04 eta 0:04:25
epoch [31/50] batch [160/167] time 0.076 (0.082) data 0.000 (0.002) loss 0.7698 (0.7149) ce_loss 0.4944 (0.3981) teacher_loss 0.3007 (0.2459) loss_zs_kd 0.1213 (0.1104) loss_oracle 0.4084 (0.4137) acc 87.5000 (84.9414) kd_loss 1.1279 (1.0836) lr 7.5131e-04 eta 0:04:21
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,193
* accuracy: 95.5%
* error: 4.5%
* macro_f1: 96.0%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,327
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [32/50] batch [20/167] time 0.082 (0.096) data 0.000 (0.017) loss 0.7663 (0.6886) ce_loss 0.4658 (0.3581) teacher_loss 0.3295 (0.2306) loss_zs_kd 0.0786 (0.1064) loss_oracle 0.3975 (0.4047) acc 84.3750 (87.1875) kd_loss 1.1284 (1.0845) lr 6.9098e-04 eta 0:05:04
epoch [32/50] batch [40/167] time 0.075 (0.085) data 0.000 (0.009) loss 0.5672 (0.7079) ce_loss 0.2651 (0.3808) teacher_loss 0.1627 (0.2426) loss_zs_kd 0.0951 (0.1071) loss_oracle 0.3569 (0.4118) acc 84.3750 (86.1719) kd_loss 1.1124 (1.0819) lr 6.9098e-04 eta 0:04:27
epoch [32/50] batch [60/167] time 0.087 (0.082) data 0.001 (0.006) loss 0.8373 (0.7169) ce_loss 0.3572 (0.3894) teacher_loss 0.2607 (0.2504) loss_zs_kd 0.1231 (0.1093) loss_oracle 0.5150 (0.4118) acc 87.5000 (85.6250) kd_loss 1.1691 (1.0823) lr 6.9098e-04 eta 0:04:16
epoch [32/50] batch [80/167] time 0.081 (0.081) data 0.000 (0.004) loss 0.7909 (0.7116) ce_loss 0.5254 (0.3860) teacher_loss 0.2921 (0.2449) loss_zs_kd 0.1641 (0.1105) loss_oracle 0.4168 (0.4115) acc 78.1250 (85.4688) kd_loss 1.0481 (1.0900) lr 6.9098e-04 eta 0:04:10
epoch [32/50] batch [100/167] time 0.081 (0.081) data 0.000 (0.004) loss 0.6337 (0.7255) ce_loss 0.3872 (0.3974) teacher_loss 0.2252 (0.2574) loss_zs_kd 0.1321 (0.1114) loss_oracle 0.3424 (0.4123) acc 81.2500 (85.1562) kd_loss 1.1037 (1.0930) lr 6.9098e-04 eta 0:04:07
epoch [32/50] batch [120/167] time 0.085 (0.080) data 0.000 (0.003) loss 0.6079 (0.7299) ce_loss 0.2269 (0.3995) teacher_loss 0.1278 (0.2591) loss_zs_kd 0.0921 (0.1115) loss_oracle 0.4340 (0.4150) acc 90.6250 (84.8958) kd_loss 1.1045 (1.0951) lr 6.9098e-04 eta 0:04:03
epoch [32/50] batch [140/167] time 0.096 (0.080) data 0.000 (0.003) loss 0.9936 (0.7293) ce_loss 0.5454 (0.3973) teacher_loss 0.5018 (0.2570) loss_zs_kd 0.1276 (0.1101) loss_oracle 0.4280 (0.4172) acc 81.2500 (85.2902) kd_loss 1.0693 (1.0974) lr 6.9098e-04 eta 0:04:02
epoch [32/50] batch [160/167] time 0.076 (0.080) data 0.000 (0.002) loss 0.6617 (0.7287) ce_loss 0.3076 (0.3967) teacher_loss 0.2019 (0.2553) loss_zs_kd 0.0687 (0.1101) loss_oracle 0.4255 (0.4184) acc 90.6250 (85.3125) kd_loss 1.1500 (1.1016) lr 6.9098e-04 eta 0:04:00
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,193
* accuracy: 95.5%
* error: 4.5%
* macro_f1: 96.0%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,324
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.2%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [33/50] batch [20/167] time 0.072 (0.102) data 0.000 (0.020) loss 0.6941 (0.7043) ce_loss 0.4097 (0.3624) teacher_loss 0.2515 (0.2226) loss_zs_kd 0.1277 (0.1105) loss_oracle 0.3788 (0.4264) acc 96.8750 (86.7188) kd_loss 0.9987 (1.1181) lr 6.3188e-04 eta 0:05:03
epoch [33/50] batch [40/167] time 0.079 (0.092) data 0.000 (0.010) loss 0.7976 (0.7035) ce_loss 0.5034 (0.3477) teacher_loss 0.2673 (0.2041) loss_zs_kd 0.1531 (0.1167) loss_oracle 0.4538 (0.4410) acc 84.3750 (87.5781) kd_loss 1.1270 (1.1205) lr 6.3188e-04 eta 0:04:31
epoch [33/50] batch [60/167] time 0.071 (0.089) data 0.000 (0.007) loss 0.9036 (0.7211) ce_loss 0.5889 (0.3787) teacher_loss 0.3575 (0.2233) loss_zs_kd 0.1572 (0.1177) loss_oracle 0.4675 (0.4389) acc 84.3750 (86.1458) kd_loss 1.0720 (1.1145) lr 6.3188e-04 eta 0:04:20
epoch [33/50] batch [80/167] time 0.085 (0.087) data 0.000 (0.005) loss 0.8239 (0.7278) ce_loss 0.4619 (0.3857) teacher_loss 0.3043 (0.2315) loss_zs_kd 0.1173 (0.1171) loss_oracle 0.4609 (0.4377) acc 81.2500 (85.9766) kd_loss 1.0903 (1.1133) lr 6.3188e-04 eta 0:04:13
epoch [33/50] batch [100/167] time 0.095 (0.087) data 0.000 (0.004) loss 0.7177 (0.7305) ce_loss 0.3979 (0.3859) teacher_loss 0.2153 (0.2332) loss_zs_kd 0.0951 (0.1164) loss_oracle 0.4549 (0.4390) acc 84.3750 (85.9688) kd_loss 1.1164 (1.1133) lr 6.3188e-04 eta 0:04:12
epoch [33/50] batch [120/167] time 0.097 (0.088) data 0.000 (0.004) loss 0.7148 (0.7361) ce_loss 0.2617 (0.3825) teacher_loss 0.1628 (0.2325) loss_zs_kd 0.1120 (0.1157) loss_oracle 0.4960 (0.4458) acc 90.6250 (85.8594) kd_loss 1.1356 (1.1170) lr 6.3188e-04 eta 0:04:13
epoch [33/50] batch [140/167] time 0.088 (0.088) data 0.000 (0.003) loss 0.6582 (0.7492) ce_loss 0.2871 (0.3920) teacher_loss 0.1997 (0.2434) loss_zs_kd 0.1079 (0.1172) loss_oracle 0.4046 (0.4473) acc 90.6250 (85.3795) kd_loss 1.1296 (1.1181) lr 6.3188e-04 eta 0:04:11
epoch [33/50] batch [160/167] time 0.074 (0.087) data 0.000 (0.003) loss 0.7696 (0.7475) ce_loss 0.3262 (0.3852) teacher_loss 0.2766 (0.2419) loss_zs_kd 0.1233 (0.1160) loss_oracle 0.4314 (0.4476) acc 84.3750 (85.6055) kd_loss 1.0957 (1.1217) lr 6.3188e-04 eta 0:04:07
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,190
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [34/50] batch [20/167] time 0.083 (0.101) data 0.000 (0.015) loss 0.9469 (0.8260) ce_loss 0.6260 (0.4083) teacher_loss 0.4244 (0.3103) loss_zs_kd 0.0804 (0.1065) loss_oracle 0.4823 (0.4625) acc 84.3750 (83.2812) kd_loss 1.1842 (1.1615) lr 5.7422e-04 eta 0:04:46
epoch [34/50] batch [40/167] time 0.080 (0.092) data 0.000 (0.007) loss 0.9699 (0.8112) ce_loss 0.6558 (0.3983) teacher_loss 0.5355 (0.3132) loss_zs_kd 0.0906 (0.1040) loss_oracle 0.3891 (0.4460) acc 68.7500 (84.0625) kd_loss 1.1604 (1.1664) lr 5.7422e-04 eta 0:04:16
epoch [34/50] batch [60/167] time 0.085 (0.089) data 0.000 (0.005) loss 0.6895 (0.7801) ce_loss 0.2739 (0.3953) teacher_loss 0.2100 (0.3090) loss_zs_kd 0.0807 (0.0975) loss_oracle 0.4392 (0.4223) acc 90.6250 (84.1667) kd_loss 1.2118 (1.1722) lr 5.7422e-04 eta 0:04:07
epoch [34/50] batch [80/167] time 0.083 (0.088) data 0.000 (0.004) loss 0.5671 (0.7718) ce_loss 0.2344 (0.3984) teacher_loss 0.0852 (0.3025) loss_zs_kd 0.0831 (0.0990) loss_oracle 0.4404 (0.4198) acc 87.5000 (83.8672) kd_loss 1.2049 (1.1754) lr 5.7422e-04 eta 0:04:02
epoch [34/50] batch [100/167] time 0.094 (0.087) data 0.000 (0.003) loss 0.8843 (0.7724) ce_loss 0.5894 (0.4045) teacher_loss 0.4809 (0.3082) loss_zs_kd 0.1123 (0.0980) loss_oracle 0.3472 (0.4151) acc 75.0000 (84.0312) kd_loss 1.1737 (1.1769) lr 5.7422e-04 eta 0:03:59
epoch [34/50] batch [120/167] time 0.082 (0.087) data 0.000 (0.003) loss 0.9669 (0.7715) ce_loss 0.6001 (0.4034) teacher_loss 0.4996 (0.3061) loss_zs_kd 0.1517 (0.0985) loss_oracle 0.3915 (0.4162) acc 78.1250 (84.2448) kd_loss 1.2020 (1.1781) lr 5.7422e-04 eta 0:03:56
epoch [34/50] batch [140/167] time 0.086 (0.086) data 0.000 (0.002) loss 0.7999 (0.7801) ce_loss 0.3499 (0.4087) teacher_loss 0.2359 (0.3096) loss_zs_kd 0.0760 (0.0979) loss_oracle 0.5260 (0.4215) acc 87.5000 (84.0625) kd_loss 1.1905 (1.1781) lr 5.7422e-04 eta 0:03:52
epoch [34/50] batch [160/167] time 0.078 (0.086) data 0.000 (0.002) loss 1.0199 (0.7875) ce_loss 0.5449 (0.4138) teacher_loss 0.3937 (0.3107) loss_zs_kd 0.1339 (0.0984) loss_oracle 0.5592 (0.4276) acc 81.2500 (84.0039) kd_loss 1.1705 (1.1788) lr 5.7422e-04 eta 0:03:50
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,184
* accuracy: 95.1%
* error: 4.9%
* macro_f1: 95.6%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,322
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [35/50] batch [20/167] time 0.083 (0.102) data 0.000 (0.016) loss 0.6802 (0.7904) ce_loss 0.2241 (0.3742) teacher_loss 0.1963 (0.2685) loss_zs_kd 0.0615 (0.0845) loss_oracle 0.4532 (0.4796) acc 90.6250 (87.8125) kd_loss 1.1338 (1.1712) lr 5.1825e-04 eta 0:04:30
epoch [35/50] batch [40/167] time 0.084 (0.094) data 0.000 (0.008) loss 0.9173 (0.8290) ce_loss 0.4783 (0.4053) teacher_loss 0.2937 (0.2878) loss_zs_kd 0.1023 (0.0915) loss_oracle 0.5724 (0.4955) acc 78.1250 (85.7031) kd_loss 1.2084 (1.1703) lr 5.1825e-04 eta 0:04:07
epoch [35/50] batch [60/167] time 0.077 (0.089) data 0.001 (0.005) loss 0.6961 (0.8149) ce_loss 0.2435 (0.3975) teacher_loss 0.1346 (0.2692) loss_zs_kd 0.1069 (0.0953) loss_oracle 0.5081 (0.4980) acc 93.7500 (85.7812) kd_loss 1.1705 (1.1700) lr 5.1825e-04 eta 0:03:51
epoch [35/50] batch [80/167] time 0.069 (0.084) data 0.000 (0.004) loss 0.8208 (0.8121) ce_loss 0.4124 (0.3984) teacher_loss 0.2777 (0.2704) loss_zs_kd 0.0879 (0.0973) loss_oracle 0.4991 (0.4931) acc 81.2500 (85.3906) kd_loss 1.1599 (1.1673) lr 5.1825e-04 eta 0:03:37
epoch [35/50] batch [100/167] time 0.071 (0.081) data 0.000 (0.003) loss 0.7605 (0.8037) ce_loss 0.4202 (0.3944) teacher_loss 0.2533 (0.2692) loss_zs_kd 0.0895 (0.0975) loss_oracle 0.4624 (0.4859) acc 84.3750 (85.4062) kd_loss 1.1837 (1.1674) lr 5.1825e-04 eta 0:03:28
epoch [35/50] batch [120/167] time 0.080 (0.079) data 0.000 (0.003) loss 0.6872 (0.7963) ce_loss 0.1949 (0.3925) teacher_loss 0.1150 (0.2682) loss_zs_kd 0.0779 (0.0970) loss_oracle 0.5333 (0.4796) acc 93.7500 (85.2344) kd_loss 1.1467 (1.1655) lr 5.1825e-04 eta 0:03:21
epoch [35/50] batch [140/167] time 0.078 (0.079) data 0.000 (0.002) loss 0.8893 (0.7994) ce_loss 0.3838 (0.4008) teacher_loss 0.3734 (0.2742) loss_zs_kd 0.1132 (0.0976) loss_oracle 0.4593 (0.4764) acc 84.3750 (85.1786) kd_loss 1.1351 (1.1631) lr 5.1825e-04 eta 0:03:19
epoch [35/50] batch [160/167] time 0.075 (0.079) data 0.000 (0.002) loss 0.7062 (0.7987) ce_loss 0.3389 (0.4026) teacher_loss 0.1557 (0.2767) loss_zs_kd 0.0846 (0.0976) loss_oracle 0.5082 (0.4731) acc 84.3750 (85.0000) kd_loss 1.1560 (1.1618) lr 5.1825e-04 eta 0:03:18
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,189
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [36/50] batch [20/167] time 0.087 (0.103) data 0.000 (0.016) loss 0.6800 (0.7716) ce_loss 0.2883 (0.3878) teacher_loss 0.1843 (0.2570) loss_zs_kd 0.0576 (0.1045) loss_oracle 0.4669 (0.4623) acc 93.7500 (85.7812) kd_loss 1.1129 (1.1409) lr 4.6417e-04 eta 0:04:16
epoch [36/50] batch [40/167] time 0.087 (0.095) data 0.000 (0.008) loss 0.7996 (0.8092) ce_loss 0.4302 (0.4111) teacher_loss 0.2616 (0.2863) loss_zs_kd 0.0998 (0.1057) loss_oracle 0.4881 (0.4700) acc 81.2500 (85.5469) kd_loss 1.1629 (1.1417) lr 4.6417e-04 eta 0:03:54
epoch [36/50] batch [60/167] time 0.088 (0.093) data 0.000 (0.006) loss 0.8580 (0.8095) ce_loss 0.4675 (0.4115) teacher_loss 0.3312 (0.2802) loss_zs_kd 0.1223 (0.1027) loss_oracle 0.4656 (0.4780) acc 84.3750 (85.1042) kd_loss 1.1676 (1.1401) lr 4.6417e-04 eta 0:03:46
epoch [36/50] batch [80/167] time 0.089 (0.090) data 0.000 (0.004) loss 0.7650 (0.8044) ce_loss 0.2734 (0.4039) teacher_loss 0.2251 (0.2774) loss_zs_kd 0.0721 (0.1008) loss_oracle 0.5039 (0.4766) acc 93.7500 (85.4688) kd_loss 1.1514 (1.1391) lr 4.6417e-04 eta 0:03:39
epoch [36/50] batch [100/167] time 0.077 (0.089) data 0.000 (0.003) loss 0.8364 (0.7992) ce_loss 0.5864 (0.3997) teacher_loss 0.3619 (0.2743) loss_zs_kd 0.1120 (0.1000) loss_oracle 0.4185 (0.4748) acc 75.0000 (85.3438) kd_loss 1.1516 (1.1388) lr 4.6417e-04 eta 0:03:34
epoch [36/50] batch [120/167] time 0.084 (0.089) data 0.000 (0.003) loss 0.6986 (0.7947) ce_loss 0.4536 (0.4056) teacher_loss 0.2250 (0.2788) loss_zs_kd 0.1203 (0.0986) loss_oracle 0.4134 (0.4666) acc 87.5000 (85.0781) kd_loss 1.1098 (1.1371) lr 4.6417e-04 eta 0:03:31
epoch [36/50] batch [140/167] time 0.080 (0.088) data 0.000 (0.003) loss 0.8202 (0.7902) ce_loss 0.5322 (0.4067) teacher_loss 0.3059 (0.2782) loss_zs_kd 0.1082 (0.0970) loss_oracle 0.4602 (0.4635) acc 78.1250 (84.8884) kd_loss 1.0898 (1.1359) lr 4.6417e-04 eta 0:03:28
epoch [36/50] batch [160/167] time 0.075 (0.088) data 0.000 (0.002) loss 0.7411 (0.7831) ce_loss 0.3054 (0.3990) teacher_loss 0.2508 (0.2748) loss_zs_kd 0.0803 (0.0956) loss_oracle 0.4501 (0.4605) acc 93.7500 (85.1367) kd_loss 1.1258 (1.1350) lr 4.6417e-04 eta 0:03:25
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,182
* accuracy: 95.0%
* error: 5.0%
* macro_f1: 95.5%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [37/50] batch [20/167] time 0.090 (0.105) data 0.000 (0.017) loss 0.8352 (0.7391) ce_loss 0.4451 (0.3835) teacher_loss 0.3175 (0.2697) loss_zs_kd 0.1130 (0.0873) loss_oracle 0.4612 (0.4258) acc 84.3750 (86.8750) kd_loss 1.1417 (1.1297) lr 4.1221e-04 eta 0:04:03
epoch [37/50] batch [40/167] time 0.084 (0.095) data 0.000 (0.009) loss 0.6978 (0.7664) ce_loss 0.1858 (0.3957) teacher_loss 0.2120 (0.2882) loss_zs_kd 0.0797 (0.0848) loss_oracle 0.4460 (0.4358) acc 93.7500 (85.6250) kd_loss 1.1069 (1.1251) lr 4.1221e-04 eta 0:03:38
epoch [37/50] batch [60/167] time 0.084 (0.091) data 0.001 (0.006) loss 0.7462 (0.7695) ce_loss 0.2280 (0.3926) teacher_loss 0.1968 (0.2873) loss_zs_kd 0.0455 (0.0841) loss_oracle 0.5266 (0.4401) acc 87.5000 (85.5729) kd_loss 1.1104 (1.1216) lr 4.1221e-04 eta 0:03:28
epoch [37/50] batch [80/167] time 0.088 (0.091) data 0.000 (0.005) loss 0.7565 (0.7737) ce_loss 0.3271 (0.4001) teacher_loss 0.2763 (0.2953) loss_zs_kd 0.0789 (0.0833) loss_oracle 0.4407 (0.4368) acc 90.6250 (85.3906) kd_loss 1.1413 (1.1202) lr 4.1221e-04 eta 0:03:24
epoch [37/50] batch [100/167] time 0.088 (0.090) data 0.000 (0.004) loss 0.6509 (0.7618) ce_loss 0.3733 (0.3903) teacher_loss 0.1994 (0.2873) loss_zs_kd 0.0735 (0.0815) loss_oracle 0.4147 (0.4338) acc 81.2500 (85.6562) kd_loss 1.0678 (1.1191) lr 4.1221e-04 eta 0:03:20
epoch [37/50] batch [120/167] time 0.090 (0.089) data 0.000 (0.003) loss 0.8186 (0.7772) ce_loss 0.4822 (0.4077) teacher_loss 0.3652 (0.3024) loss_zs_kd 0.0647 (0.0817) loss_oracle 0.4210 (0.4340) acc 81.2500 (84.9219) kd_loss 1.1102 (1.1174) lr 4.1221e-04 eta 0:03:18
epoch [37/50] batch [140/167] time 0.084 (0.089) data 0.000 (0.003) loss 0.7709 (0.7783) ce_loss 0.3733 (0.4104) teacher_loss 0.2740 (0.3028) loss_zs_kd 0.1044 (0.0824) loss_oracle 0.4448 (0.4343) acc 84.3750 (84.7768) kd_loss 1.1186 (1.1156) lr 4.1221e-04 eta 0:03:14
epoch [37/50] batch [160/167] time 0.082 (0.088) data 0.000 (0.002) loss 0.9013 (0.7796) ce_loss 0.4985 (0.4117) teacher_loss 0.3483 (0.3044) loss_zs_kd 0.0898 (0.0830) loss_oracle 0.5080 (0.4337) acc 75.0000 (84.6289) kd_loss 1.1538 (1.1145) lr 4.1221e-04 eta 0:03:11
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,186
* accuracy: 95.2%
* error: 4.8%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [38/50] batch [20/167] time 0.084 (0.105) data 0.000 (0.015) loss 0.8060 (0.7681) ce_loss 0.5327 (0.3954) teacher_loss 0.3234 (0.2876) loss_zs_kd 0.0820 (0.0798) loss_oracle 0.4416 (0.4407) acc 81.2500 (84.6875) kd_loss 1.1036 (1.1031) lr 3.6258e-04 eta 0:03:45
epoch [38/50] batch [40/167] time 0.083 (0.095) data 0.000 (0.008) loss 0.7544 (0.7983) ce_loss 0.3135 (0.4293) teacher_loss 0.2258 (0.3182) loss_zs_kd 0.0809 (0.0836) loss_oracle 0.4881 (0.4383) acc 93.7500 (83.6719) kd_loss 1.1165 (1.1045) lr 3.6258e-04 eta 0:03:22
epoch [38/50] batch [60/167] time 0.085 (0.092) data 0.001 (0.005) loss 0.8719 (0.7937) ce_loss 0.5718 (0.4259) teacher_loss 0.4583 (0.3158) loss_zs_kd 0.0744 (0.0831) loss_oracle 0.3764 (0.4363) acc 81.2500 (84.3229) kd_loss 1.0891 (1.1043) lr 3.6258e-04 eta 0:03:14
epoch [38/50] batch [80/167] time 0.090 (0.091) data 0.000 (0.004) loss 0.8185 (0.7906) ce_loss 0.4331 (0.4229) teacher_loss 0.2552 (0.3120) loss_zs_kd 0.0718 (0.0835) loss_oracle 0.5274 (0.4369) acc 81.2500 (83.9844) kd_loss 1.1345 (1.1057) lr 3.6258e-04 eta 0:03:10
epoch [38/50] batch [100/167] time 0.091 (0.090) data 0.000 (0.003) loss 0.7056 (0.7842) ce_loss 0.3960 (0.4190) teacher_loss 0.2412 (0.3071) loss_zs_kd 0.1007 (0.0821) loss_oracle 0.4141 (0.4360) acc 87.5000 (84.1562) kd_loss 1.1248 (1.1057) lr 3.6258e-04 eta 0:03:05
epoch [38/50] batch [120/167] time 0.084 (0.089) data 0.000 (0.003) loss 0.6360 (0.7808) ce_loss 0.1749 (0.4134) teacher_loss 0.0870 (0.3037) loss_zs_kd 0.0704 (0.0838) loss_oracle 0.5138 (0.4353) acc 96.8750 (84.1927) kd_loss 1.0796 (1.1047) lr 3.6258e-04 eta 0:03:01
epoch [38/50] batch [140/167] time 0.088 (0.089) data 0.000 (0.002) loss 0.7599 (0.7769) ce_loss 0.4846 (0.4117) teacher_loss 0.3688 (0.3041) loss_zs_kd 0.0654 (0.0820) loss_oracle 0.3585 (0.4318) acc 84.3750 (84.4643) kd_loss 1.0602 (1.1028) lr 3.6258e-04 eta 0:03:00
epoch [38/50] batch [160/167] time 0.080 (0.088) data 0.000 (0.002) loss 0.9545 (0.7786) ce_loss 0.5234 (0.4130) teacher_loss 0.4536 (0.3060) loss_zs_kd 0.0968 (0.0815) loss_oracle 0.4525 (0.4318) acc 81.2500 (84.2578) kd_loss 1.0967 (1.1010) lr 3.6258e-04 eta 0:02:57
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,186
* accuracy: 95.2%
* error: 4.8%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.0%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [39/50] batch [20/167] time 0.090 (0.112) data 0.000 (0.019) loss 0.8444 (0.7577) ce_loss 0.4529 (0.4141) teacher_loss 0.3450 (0.2793) loss_zs_kd 0.1144 (0.0828) loss_oracle 0.4421 (0.4370) acc 84.3750 (83.7500) kd_loss 1.0911 (1.0936) lr 3.1545e-04 eta 0:03:41
epoch [39/50] batch [40/167] time 0.093 (0.101) data 0.000 (0.010) loss 0.8229 (0.7744) ce_loss 0.3503 (0.4205) teacher_loss 0.2578 (0.2986) loss_zs_kd 0.1011 (0.0839) loss_oracle 0.5145 (0.4338) acc 87.5000 (83.8281) kd_loss 1.1318 (1.0862) lr 3.1545e-04 eta 0:03:19
epoch [39/50] batch [60/167] time 0.094 (0.098) data 0.001 (0.007) loss 0.7722 (0.7779) ce_loss 0.4043 (0.4211) teacher_loss 0.2405 (0.3023) loss_zs_kd 0.0965 (0.0831) loss_oracle 0.4835 (0.4340) acc 78.1250 (84.3229) kd_loss 1.0699 (1.0824) lr 3.1545e-04 eta 0:03:10
epoch [39/50] batch [80/167] time 0.086 (0.096) data 0.000 (0.005) loss 0.6501 (0.7672) ce_loss 0.3052 (0.4006) teacher_loss 0.1881 (0.2908) loss_zs_kd 0.0855 (0.0819) loss_oracle 0.4193 (0.4354) acc 87.5000 (84.9219) kd_loss 1.0487 (1.0824) lr 3.1545e-04 eta 0:03:05
epoch [39/50] batch [100/167] time 0.090 (0.095) data 0.000 (0.004) loss 0.7704 (0.7658) ce_loss 0.3704 (0.3978) teacher_loss 0.2449 (0.2896) loss_zs_kd 0.1043 (0.0820) loss_oracle 0.4734 (0.4352) acc 87.5000 (85.0000) kd_loss 1.0816 (1.0819) lr 3.1545e-04 eta 0:03:01
epoch [39/50] batch [120/167] time 0.092 (0.095) data 0.000 (0.004) loss 0.7117 (0.7576) ce_loss 0.3840 (0.3953) teacher_loss 0.2901 (0.2847) loss_zs_kd 0.0841 (0.0827) loss_oracle 0.3795 (0.4316) acc 84.3750 (85.1302) kd_loss 1.0716 (1.0810) lr 3.1545e-04 eta 0:02:58
epoch [39/50] batch [140/167] time 0.091 (0.094) data 0.000 (0.003) loss 0.5592 (0.7587) ce_loss 0.2825 (0.4016) teacher_loss 0.2005 (0.2906) loss_zs_kd 0.0479 (0.0822) loss_oracle 0.3347 (0.4271) acc 93.7500 (84.8438) kd_loss 1.0062 (1.0805) lr 3.1545e-04 eta 0:02:55
epoch [39/50] batch [160/167] time 0.082 (0.093) data 0.000 (0.003) loss 0.7776 (0.7589) ce_loss 0.5068 (0.4041) teacher_loss 0.2831 (0.2938) loss_zs_kd 0.0773 (0.0820) loss_oracle 0.4559 (0.4241) acc 81.2500 (84.9023) kd_loss 1.0841 (1.0799) lr 3.1545e-04 eta 0:02:51
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,185
* accuracy: 95.1%
* error: 4.9%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [40/50] batch [20/167] time 0.083 (0.102) data 0.000 (0.016) loss 0.7360 (0.7943) ce_loss 0.4868 (0.4495) teacher_loss 0.2661 (0.3256) loss_zs_kd 0.1301 (0.0949) loss_oracle 0.4048 (0.4212) acc 81.2500 (82.6562) kd_loss 1.0630 (1.0775) lr 2.7103e-04 eta 0:03:05
epoch [40/50] batch [40/167] time 0.090 (0.094) data 0.000 (0.008) loss 0.8034 (0.8038) ce_loss 0.4194 (0.4526) teacher_loss 0.2854 (0.3264) loss_zs_kd 0.0894 (0.0933) loss_oracle 0.4733 (0.4308) acc 87.5000 (82.9688) kd_loss 1.0869 (1.0792) lr 2.7103e-04 eta 0:02:48
epoch [40/50] batch [60/167] time 0.089 (0.092) data 0.001 (0.005) loss 0.5216 (0.7918) ce_loss 0.0819 (0.4376) teacher_loss 0.0378 (0.3119) loss_zs_kd 0.0346 (0.0914) loss_oracle 0.4666 (0.4342) acc 96.8750 (83.5938) kd_loss 1.1107 (1.0757) lr 2.7103e-04 eta 0:02:43
epoch [40/50] batch [80/167] time 0.092 (0.091) data 0.000 (0.004) loss 0.7701 (0.7772) ce_loss 0.3521 (0.4123) teacher_loss 0.2824 (0.2934) loss_zs_kd 0.0760 (0.0903) loss_oracle 0.4496 (0.4387) acc 90.6250 (84.7266) kd_loss 1.0885 (1.0742) lr 2.7103e-04 eta 0:02:39
epoch [40/50] batch [100/167] time 0.091 (0.090) data 0.000 (0.003) loss 1.2102 (0.7783) ce_loss 0.9370 (0.4150) teacher_loss 0.6896 (0.2931) loss_zs_kd 0.0997 (0.0904) loss_oracle 0.4707 (0.4400) acc 71.8750 (84.6562) kd_loss 1.0761 (1.0741) lr 2.7103e-04 eta 0:02:36
epoch [40/50] batch [120/167] time 0.090 (0.090) data 0.000 (0.003) loss 0.8241 (0.7729) ce_loss 0.3083 (0.4065) teacher_loss 0.2658 (0.2857) loss_zs_kd 0.0772 (0.0904) loss_oracle 0.5197 (0.4420) acc 90.6250 (85.0260) kd_loss 1.0159 (1.0730) lr 2.7103e-04 eta 0:02:34
epoch [40/50] batch [140/167] time 0.091 (0.090) data 0.000 (0.003) loss 0.7834 (0.7722) ce_loss 0.4651 (0.4087) teacher_loss 0.3212 (0.2858) loss_zs_kd 0.0944 (0.0902) loss_oracle 0.4150 (0.4413) acc 81.2500 (85.0000) kd_loss 1.0734 (1.0735) lr 2.7103e-04 eta 0:02:32
epoch [40/50] batch [160/167] time 0.081 (0.090) data 0.000 (0.002) loss 1.0601 (0.7695) ce_loss 0.7222 (0.4049) teacher_loss 0.5521 (0.2829) loss_zs_kd 0.1754 (0.0902) loss_oracle 0.4204 (0.4415) acc 75.0000 (85.1562) kd_loss 1.1072 (1.0746) lr 2.7103e-04 eta 0:02:30
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,187
* accuracy: 95.2%
* error: 4.8%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [41/50] batch [20/167] time 0.084 (0.101) data 0.000 (0.013) loss 0.7596 (0.7630) ce_loss 0.4160 (0.4143) teacher_loss 0.2417 (0.2632) loss_zs_kd 0.1257 (0.0951) loss_oracle 0.4551 (0.4523) acc 84.3750 (84.0625) kd_loss 1.0618 (1.0699) lr 2.2949e-04 eta 0:02:46
epoch [41/50] batch [40/167] time 0.083 (0.092) data 0.000 (0.007) loss 0.7686 (0.7676) ce_loss 0.3604 (0.3980) teacher_loss 0.2200 (0.2665) loss_zs_kd 0.0884 (0.0928) loss_oracle 0.5044 (0.4547) acc 84.3750 (85.0781) kd_loss 1.0889 (1.0692) lr 2.2949e-04 eta 0:02:29
epoch [41/50] batch [60/167] time 0.091 (0.091) data 0.001 (0.005) loss 0.8391 (0.7802) ce_loss 0.4058 (0.4135) teacher_loss 0.3206 (0.2811) loss_zs_kd 0.0914 (0.0921) loss_oracle 0.4728 (0.4530) acc 78.1250 (83.9062) kd_loss 1.0261 (1.0677) lr 2.2949e-04 eta 0:02:25
epoch [41/50] batch [80/167] time 0.089 (0.090) data 0.000 (0.003) loss 0.6085 (0.7770) ce_loss 0.1578 (0.4095) teacher_loss 0.0769 (0.2802) loss_zs_kd 0.0759 (0.0908) loss_oracle 0.4937 (0.4514) acc 96.8750 (84.3359) kd_loss 1.0605 (1.0659) lr 2.2949e-04 eta 0:02:22
epoch [41/50] batch [100/167] time 0.093 (0.089) data 0.000 (0.003) loss 0.7198 (0.7768) ce_loss 0.3538 (0.4111) teacher_loss 0.2199 (0.2789) loss_zs_kd 0.0973 (0.0910) loss_oracle 0.4513 (0.4524) acc 81.2500 (84.2500) kd_loss 1.0621 (1.0641) lr 2.2949e-04 eta 0:02:19
epoch [41/50] batch [120/167] time 0.085 (0.089) data 0.000 (0.002) loss 0.8811 (0.7748) ce_loss 0.5776 (0.4105) teacher_loss 0.3501 (0.2777) loss_zs_kd 0.1130 (0.0907) loss_oracle 0.4745 (0.4517) acc 78.1250 (84.1406) kd_loss 1.0578 (1.0647) lr 2.2949e-04 eta 0:02:17
epoch [41/50] batch [140/167] time 0.083 (0.088) data 0.000 (0.002) loss 0.6783 (0.7798) ce_loss 0.2681 (0.4140) teacher_loss 0.1726 (0.2804) loss_zs_kd 0.0716 (0.0933) loss_oracle 0.4700 (0.4528) acc 90.6250 (84.2411) kd_loss 1.0686 (1.0644) lr 2.2949e-04 eta 0:02:15
epoch [41/50] batch [160/167] time 0.080 (0.088) data 0.000 (0.002) loss 0.7252 (0.7814) ce_loss 0.2896 (0.4119) teacher_loss 0.2074 (0.2805) loss_zs_kd 0.0768 (0.0932) loss_oracle 0.4794 (0.4544) acc 87.5000 (84.3750) kd_loss 1.0825 (1.0652) lr 2.2949e-04 eta 0:02:12
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,190
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.9%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [42/50] batch [20/167] time 0.069 (0.087) data 0.000 (0.012) loss 0.6584 (0.7585) ce_loss 0.3750 (0.3556) teacher_loss 0.2259 (0.2447) loss_zs_kd 0.0844 (0.0952) loss_oracle 0.3903 (0.4662) acc 84.3750 (85.9375) kd_loss 1.0248 (1.0691) lr 1.9098e-04 eta 0:02:08
epoch [42/50] batch [40/167] time 0.073 (0.081) data 0.000 (0.006) loss 0.7077 (0.7594) ce_loss 0.2869 (0.3535) teacher_loss 0.1798 (0.2413) loss_zs_kd 0.0955 (0.0941) loss_oracle 0.4801 (0.4711) acc 90.6250 (86.6406) kd_loss 1.0341 (1.0668) lr 1.9098e-04 eta 0:01:58
epoch [42/50] batch [60/167] time 0.067 (0.080) data 0.000 (0.004) loss 1.0718 (0.7789) ce_loss 0.7798 (0.3839) teacher_loss 0.4960 (0.2635) loss_zs_kd 0.1126 (0.0920) loss_oracle 0.5195 (0.4694) acc 65.6250 (85.4688) kd_loss 1.1079 (1.0680) lr 1.9098e-04 eta 0:01:54
epoch [42/50] batch [80/167] time 0.077 (0.079) data 0.000 (0.003) loss 0.9555 (0.7814) ce_loss 0.5591 (0.3830) teacher_loss 0.4735 (0.2666) loss_zs_kd 0.0920 (0.0905) loss_oracle 0.4360 (0.4696) acc 84.3750 (85.4688) kd_loss 1.0661 (1.0666) lr 1.9098e-04 eta 0:01:52
epoch [42/50] batch [100/167] time 0.068 (0.077) data 0.000 (0.003) loss 0.6671 (0.7868) ce_loss 0.3115 (0.3926) teacher_loss 0.1757 (0.2743) loss_zs_kd 0.0826 (0.0899) loss_oracle 0.4501 (0.4676) acc 90.6250 (85.2812) kd_loss 1.0504 (1.0649) lr 1.9098e-04 eta 0:01:48
epoch [42/50] batch [120/167] time 0.081 (0.077) data 0.000 (0.002) loss 0.7737 (0.7876) ce_loss 0.3782 (0.4011) teacher_loss 0.2682 (0.2775) loss_zs_kd 0.0963 (0.0897) loss_oracle 0.4574 (0.4652) acc 81.2500 (84.8958) kd_loss 1.0331 (1.0618) lr 1.9098e-04 eta 0:01:46
epoch [42/50] batch [140/167] time 0.078 (0.078) data 0.000 (0.002) loss 1.0627 (0.7914) ce_loss 0.6567 (0.4067) teacher_loss 0.5322 (0.2809) loss_zs_kd 0.1185 (0.0920) loss_oracle 0.4713 (0.4645) acc 81.2500 (84.6652) kd_loss 1.0344 (1.0621) lr 1.9098e-04 eta 0:01:46
epoch [42/50] batch [160/167] time 0.074 (0.078) data 0.000 (0.002) loss 0.7648 (0.7946) ce_loss 0.3376 (0.4091) teacher_loss 0.2443 (0.2852) loss_zs_kd 0.0721 (0.0914) loss_oracle 0.4845 (0.4637) acc 90.6250 (84.7266) kd_loss 1.0891 (1.0611) lr 1.9098e-04 eta 0:01:45
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,188
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,322
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [43/50] batch [20/167] time 0.075 (0.099) data 0.000 (0.018) loss 0.7529 (0.8019) ce_loss 0.3274 (0.4097) teacher_loss 0.1979 (0.2826) loss_zs_kd 0.0970 (0.0922) loss_oracle 0.5065 (0.4732) acc 90.6250 (86.2500) kd_loss 1.0842 (1.0782) lr 1.5567e-04 eta 0:02:09
epoch [43/50] batch [40/167] time 0.090 (0.088) data 0.001 (0.009) loss 0.8600 (0.7883) ce_loss 0.4089 (0.3974) teacher_loss 0.2330 (0.2650) loss_zs_kd 0.1166 (0.0935) loss_oracle 0.5686 (0.4766) acc 84.3750 (86.0938) kd_loss 1.0820 (1.0779) lr 1.5567e-04 eta 0:01:54
epoch [43/50] batch [60/167] time 0.093 (0.088) data 0.001 (0.006) loss 0.8476 (0.7966) ce_loss 0.5566 (0.4072) teacher_loss 0.3067 (0.2740) loss_zs_kd 0.1486 (0.0954) loss_oracle 0.4667 (0.4749) acc 78.1250 (85.1042) kd_loss 1.1131 (1.0726) lr 1.5567e-04 eta 0:01:52
epoch [43/50] batch [80/167] time 0.083 (0.087) data 0.000 (0.005) loss 0.8038 (0.8056) ce_loss 0.3882 (0.4180) teacher_loss 0.2648 (0.2802) loss_zs_kd 0.1083 (0.0970) loss_oracle 0.4848 (0.4769) acc 87.5000 (84.8047) kd_loss 1.0369 (1.0715) lr 1.5567e-04 eta 0:01:49
epoch [43/50] batch [100/167] time 0.080 (0.086) data 0.000 (0.004) loss 0.6701 (0.8044) ce_loss 0.2412 (0.4207) teacher_loss 0.1764 (0.2794) loss_zs_kd 0.0605 (0.0990) loss_oracle 0.4635 (0.4755) acc 87.5000 (84.6250) kd_loss 1.0448 (1.0709) lr 1.5567e-04 eta 0:01:46
epoch [43/50] batch [120/167] time 0.086 (0.086) data 0.000 (0.003) loss 0.9694 (0.8054) ce_loss 0.4973 (0.4206) teacher_loss 0.4210 (0.2812) loss_zs_kd 0.1146 (0.0985) loss_oracle 0.4911 (0.4750) acc 81.2500 (84.5833) kd_loss 1.0733 (1.0694) lr 1.5567e-04 eta 0:01:44
epoch [43/50] batch [140/167] time 0.082 (0.086) data 0.000 (0.003) loss 0.6231 (0.8032) ce_loss 0.2205 (0.4164) teacher_loss 0.1541 (0.2786) loss_zs_kd 0.0943 (0.0974) loss_oracle 0.4219 (0.4759) acc 93.7500 (84.6652) kd_loss 1.0040 (1.0695) lr 1.5567e-04 eta 0:01:43
epoch [43/50] batch [160/167] time 0.079 (0.086) data 0.000 (0.003) loss 0.6237 (0.8044) ce_loss 0.2072 (0.4165) teacher_loss 0.1270 (0.2793) loss_zs_kd 0.0862 (0.0963) loss_oracle 0.4537 (0.4770) acc 93.7500 (84.6875) kd_loss 1.0194 (1.0686) lr 1.5567e-04 eta 0:01:41
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,187
* accuracy: 95.2%
* error: 4.8%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [44/50] batch [20/167] time 0.084 (0.102) data 0.000 (0.014) loss 0.6994 (0.7858) ce_loss 0.3540 (0.3542) teacher_loss 0.2077 (0.2610) loss_zs_kd 0.1360 (0.0894) loss_oracle 0.4237 (0.4802) acc 93.7500 (86.7188) kd_loss 1.0727 (1.0523) lr 1.2369e-04 eta 0:01:57
epoch [44/50] batch [40/167] time 0.083 (0.092) data 0.000 (0.007) loss 0.8690 (0.8154) ce_loss 0.5054 (0.4017) teacher_loss 0.3717 (0.2975) loss_zs_kd 0.0747 (0.0881) loss_oracle 0.4599 (0.4738) acc 81.2500 (84.9219) kd_loss 1.0314 (1.0523) lr 1.2369e-04 eta 0:01:43
epoch [44/50] batch [60/167] time 0.085 (0.091) data 0.001 (0.005) loss 0.8295 (0.8178) ce_loss 0.4609 (0.4140) teacher_loss 0.3128 (0.3070) loss_zs_kd 0.0598 (0.0848) loss_oracle 0.4868 (0.4684) acc 81.2500 (84.4792) kd_loss 1.0734 (1.0526) lr 1.2369e-04 eta 0:01:40
epoch [44/50] batch [80/167] time 0.083 (0.090) data 0.000 (0.004) loss 0.6747 (0.7941) ce_loss 0.3794 (0.3947) teacher_loss 0.2814 (0.2911) loss_zs_kd 0.0652 (0.0816) loss_oracle 0.3608 (0.4622) acc 81.2500 (84.9609) kd_loss 1.0098 (1.0522) lr 1.2369e-04 eta 0:01:37
epoch [44/50] batch [100/167] time 0.088 (0.089) data 0.000 (0.003) loss 0.8452 (0.8010) ce_loss 0.5542 (0.4062) teacher_loss 0.3291 (0.3007) loss_zs_kd 0.0545 (0.0822) loss_oracle 0.4888 (0.4592) acc 81.2500 (84.6562) kd_loss 1.0603 (1.0516) lr 1.2369e-04 eta 0:01:34
epoch [44/50] batch [120/167] time 0.085 (0.088) data 0.000 (0.003) loss 0.6656 (0.7934) ce_loss 0.3247 (0.3996) teacher_loss 0.1915 (0.2955) loss_zs_kd 0.1112 (0.0818) loss_oracle 0.4185 (0.4570) acc 90.6250 (84.9479) kd_loss 1.0317 (1.0516) lr 1.2369e-04 eta 0:01:32
epoch [44/50] batch [140/167] time 0.084 (0.088) data 0.000 (0.002) loss 0.7627 (0.7936) ce_loss 0.4287 (0.4067) teacher_loss 0.3254 (0.2974) loss_zs_kd 0.0818 (0.0827) loss_oracle 0.3965 (0.4549) acc 87.5000 (84.7768) kd_loss 1.0596 (1.0523) lr 1.2369e-04 eta 0:01:30
epoch [44/50] batch [160/167] time 0.080 (0.087) data 0.000 (0.002) loss 0.9624 (0.7879) ce_loss 0.7979 (0.4057) teacher_loss 0.4862 (0.2937) loss_zs_kd 0.0993 (0.0829) loss_oracle 0.4265 (0.4527) acc 71.8750 (84.7070) kd_loss 1.0445 (1.0523) lr 1.2369e-04 eta 0:01:28
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,188
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,320
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.0%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [45/50] batch [20/167] time 0.081 (0.106) data 0.000 (0.014) loss 0.7078 (0.7813) ce_loss 0.4441 (0.4157) teacher_loss 0.2393 (0.3037) loss_zs_kd 0.0896 (0.0896) loss_oracle 0.4237 (0.4327) acc 81.2500 (83.9062) kd_loss 1.0641 (1.0568) lr 9.5173e-05 eta 0:01:44
epoch [45/50] batch [40/167] time 0.081 (0.096) data 0.000 (0.007) loss 0.7918 (0.7739) ce_loss 0.4734 (0.4105) teacher_loss 0.2903 (0.2947) loss_zs_kd 0.1312 (0.0857) loss_oracle 0.4359 (0.4363) acc 90.6250 (85.0781) kd_loss 1.0771 (1.0532) lr 9.5173e-05 eta 0:01:32
epoch [45/50] batch [60/167] time 0.081 (0.093) data 0.001 (0.005) loss 0.6808 (0.7771) ce_loss 0.2927 (0.4132) teacher_loss 0.1800 (0.2933) loss_zs_kd 0.0806 (0.0879) loss_oracle 0.4605 (0.4398) acc 87.5000 (85.0000) kd_loss 1.0138 (1.0509) lr 9.5173e-05 eta 0:01:27
epoch [45/50] batch [80/167] time 0.086 (0.091) data 0.000 (0.004) loss 0.7396 (0.7741) ce_loss 0.2920 (0.4046) teacher_loss 0.2162 (0.2904) loss_zs_kd 0.0556 (0.0861) loss_oracle 0.4956 (0.4406) acc 90.6250 (85.1953) kd_loss 1.0741 (1.0503) lr 9.5173e-05 eta 0:01:24
epoch [45/50] batch [100/167] time 0.088 (0.090) data 0.000 (0.003) loss 0.9464 (0.7849) ce_loss 0.6294 (0.4169) teacher_loss 0.4397 (0.2990) loss_zs_kd 0.1504 (0.0872) loss_oracle 0.4315 (0.4423) acc 75.0000 (84.5938) kd_loss 1.0365 (1.0512) lr 9.5173e-05 eta 0:01:21
epoch [45/50] batch [120/167] time 0.081 (0.089) data 0.000 (0.003) loss 0.7932 (0.7807) ce_loss 0.5229 (0.4147) teacher_loss 0.3660 (0.2963) loss_zs_kd 0.0781 (0.0874) loss_oracle 0.3881 (0.4406) acc 71.8750 (84.6875) kd_loss 1.0204 (1.0513) lr 9.5173e-05 eta 0:01:18
epoch [45/50] batch [140/167] time 0.096 (0.088) data 0.000 (0.002) loss 0.6494 (0.7776) ce_loss 0.3386 (0.4132) teacher_loss 0.1778 (0.2927) loss_zs_kd 0.0950 (0.0896) loss_oracle 0.4241 (0.4402) acc 87.5000 (84.8438) kd_loss 1.0676 (1.0523) lr 9.5173e-05 eta 0:01:16
epoch [45/50] batch [160/167] time 0.080 (0.088) data 0.000 (0.002) loss 0.7789 (0.7797) ce_loss 0.4485 (0.4149) teacher_loss 0.3284 (0.2941) loss_zs_kd 0.1333 (0.0896) loss_oracle 0.3839 (0.4408) acc 84.3750 (84.7852) kd_loss 1.0232 (1.0529) lr 9.5173e-05 eta 0:01:13
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,188
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [46/50] batch [20/167] time 0.080 (0.099) data 0.000 (0.015) loss 0.6774 (0.7428) ce_loss 0.3552 (0.3968) teacher_loss 0.2127 (0.2565) loss_zs_kd 0.1017 (0.0924) loss_oracle 0.4139 (0.4401) acc 84.3750 (84.6875) kd_loss 1.0049 (1.0613) lr 7.0224e-05 eta 0:01:21
epoch [46/50] batch [40/167] time 0.083 (0.092) data 0.000 (0.008) loss 0.7022 (0.7439) ce_loss 0.3298 (0.3908) teacher_loss 0.2314 (0.2564) loss_zs_kd 0.0779 (0.0898) loss_oracle 0.4318 (0.4426) acc 90.6250 (84.9219) kd_loss 1.0872 (1.0587) lr 7.0224e-05 eta 0:01:13
epoch [46/50] batch [60/167] time 0.085 (0.090) data 0.001 (0.005) loss 0.8528 (0.7377) ce_loss 0.5454 (0.3753) teacher_loss 0.3638 (0.2491) loss_zs_kd 0.1058 (0.0889) loss_oracle 0.4361 (0.4441) acc 81.2500 (85.7292) kd_loss 1.0977 (1.0583) lr 7.0224e-05 eta 0:01:09
epoch [46/50] batch [80/167] time 0.079 (0.088) data 0.000 (0.004) loss 0.9068 (0.7393) ce_loss 0.5161 (0.3785) teacher_loss 0.3770 (0.2549) loss_zs_kd 0.0927 (0.0880) loss_oracle 0.4834 (0.4404) acc 84.3750 (85.7031) kd_loss 1.0602 (1.0573) lr 7.0224e-05 eta 0:01:06
epoch [46/50] batch [100/167] time 0.084 (0.088) data 0.000 (0.003) loss 0.9530 (0.7458) ce_loss 0.6504 (0.3874) teacher_loss 0.4264 (0.2609) loss_zs_kd 0.1223 (0.0895) loss_oracle 0.4655 (0.4402) acc 71.8750 (85.5000) kd_loss 1.0723 (1.0570) lr 7.0224e-05 eta 0:01:04
epoch [46/50] batch [120/167] time 0.086 (0.088) data 0.000 (0.003) loss 0.9956 (0.7493) ce_loss 0.6484 (0.3907) teacher_loss 0.4926 (0.2630) loss_zs_kd 0.1199 (0.0900) loss_oracle 0.4431 (0.4414) acc 71.8750 (85.3125) kd_loss 1.0138 (1.0570) lr 7.0224e-05 eta 0:01:03
epoch [46/50] batch [140/167] time 0.085 (0.088) data 0.000 (0.002) loss 0.6572 (0.7532) ce_loss 0.2712 (0.3939) teacher_loss 0.2017 (0.2675) loss_zs_kd 0.0386 (0.0895) loss_oracle 0.4362 (0.4410) acc 90.6250 (85.2679) kd_loss 1.0414 (1.0561) lr 7.0224e-05 eta 0:01:00
epoch [46/50] batch [160/167] time 0.080 (0.087) data 0.000 (0.002) loss 0.8971 (0.7555) ce_loss 0.6079 (0.3987) teacher_loss 0.3752 (0.2699) loss_zs_kd 0.1507 (0.0904) loss_oracle 0.4466 (0.4404) acc 71.8750 (85.0000) kd_loss 1.0119 (1.0545) lr 7.0224e-05 eta 0:00:58
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,190
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.9%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [47/50] batch [20/167] time 0.087 (0.095) data 0.000 (0.012) loss 0.9316 (0.7784) ce_loss 0.6064 (0.4210) teacher_loss 0.3692 (0.2671) loss_zs_kd 0.0872 (0.1028) loss_oracle 0.5187 (0.4598) acc 78.1250 (85.7812) kd_loss 1.0955 (1.0748) lr 4.8943e-05 eta 0:01:01
epoch [47/50] batch [40/167] time 0.088 (0.090) data 0.000 (0.006) loss 0.8716 (0.7578) ce_loss 0.4785 (0.3860) teacher_loss 0.3079 (0.2501) loss_zs_kd 0.0937 (0.0990) loss_oracle 0.5169 (0.4582) acc 84.3750 (86.3281) kd_loss 1.0687 (1.0738) lr 4.8943e-05 eta 0:00:56
epoch [47/50] batch [60/167] time 0.085 (0.089) data 0.001 (0.004) loss 0.9711 (0.7628) ce_loss 0.6436 (0.3906) teacher_loss 0.4422 (0.2599) loss_zs_kd 0.0851 (0.0963) loss_oracle 0.4864 (0.4548) acc 78.1250 (85.9896) kd_loss 1.0367 (1.0719) lr 4.8943e-05 eta 0:00:54
epoch [47/50] batch [80/167] time 0.083 (0.088) data 0.000 (0.003) loss 0.7399 (0.7595) ce_loss 0.3315 (0.3832) teacher_loss 0.2733 (0.2549) loss_zs_kd 0.0923 (0.0964) loss_oracle 0.4204 (0.4564) acc 93.7500 (86.3281) kd_loss 1.0703 (1.0720) lr 4.8943e-05 eta 0:00:51
epoch [47/50] batch [100/167] time 0.082 (0.088) data 0.000 (0.003) loss 0.7343 (0.7613) ce_loss 0.2290 (0.3856) teacher_loss 0.1773 (0.2566) loss_zs_kd 0.0820 (0.0957) loss_oracle 0.5160 (0.4568) acc 90.6250 (86.1562) kd_loss 1.1268 (1.0712) lr 4.8943e-05 eta 0:00:49
epoch [47/50] batch [120/167] time 0.084 (0.087) data 0.000 (0.002) loss 0.9030 (0.7678) ce_loss 0.6113 (0.3937) teacher_loss 0.3341 (0.2611) loss_zs_kd 0.1068 (0.0955) loss_oracle 0.5155 (0.4589) acc 75.0000 (85.8073) kd_loss 1.0663 (1.0704) lr 4.8943e-05 eta 0:00:47
epoch [47/50] batch [140/167] time 0.085 (0.087) data 0.000 (0.002) loss 0.8205 (0.7624) ce_loss 0.4280 (0.3872) teacher_loss 0.2846 (0.2573) loss_zs_kd 0.1313 (0.0950) loss_oracle 0.4703 (0.4576) acc 78.1250 (85.8929) kd_loss 1.0668 (1.0694) lr 4.8943e-05 eta 0:00:45
epoch [47/50] batch [160/167] time 0.079 (0.086) data 0.000 (0.002) loss 0.6386 (0.7689) ce_loss 0.1802 (0.3907) teacher_loss 0.1377 (0.2623) loss_zs_kd 0.0661 (0.0946) loss_oracle 0.4679 (0.4594) acc 93.7500 (85.7422) kd_loss 1.0477 (1.0700) lr 4.8943e-05 eta 0:00:43
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,187
* accuracy: 95.2%
* error: 4.8%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [48/50] batch [20/167] time 0.062 (0.095) data 0.000 (0.017) loss 0.7125 (0.8147) ce_loss 0.3486 (0.4608) teacher_loss 0.2026 (0.3032) loss_zs_kd 0.0964 (0.1035) loss_oracle 0.4616 (0.4597) acc 84.3750 (81.8750) kd_loss 1.0693 (1.0710) lr 3.1417e-05 eta 0:00:45
epoch [48/50] batch [40/167] time 0.078 (0.082) data 0.000 (0.008) loss 0.9120 (0.7968) ce_loss 0.5850 (0.4224) teacher_loss 0.4502 (0.2830) loss_zs_kd 0.1283 (0.0986) loss_oracle 0.3977 (0.4645) acc 81.2500 (83.4375) kd_loss 1.0873 (1.0722) lr 3.1417e-05 eta 0:00:38
epoch [48/50] batch [60/167] time 0.082 (0.081) data 0.001 (0.006) loss 0.7608 (0.7895) ce_loss 0.3997 (0.4152) teacher_loss 0.2403 (0.2764) loss_zs_kd 0.1046 (0.0968) loss_oracle 0.4681 (0.4647) acc 90.6250 (84.1667) kd_loss 1.0600 (1.0702) lr 3.1417e-05 eta 0:00:35
epoch [48/50] batch [80/167] time 0.080 (0.081) data 0.000 (0.004) loss 0.9051 (0.7900) ce_loss 0.5244 (0.4167) teacher_loss 0.3588 (0.2756) loss_zs_kd 0.1444 (0.0981) loss_oracle 0.4741 (0.4653) acc 75.0000 (83.9453) kd_loss 1.0892 (1.0692) lr 3.1417e-05 eta 0:00:34
epoch [48/50] batch [100/167] time 0.090 (0.081) data 0.000 (0.004) loss 0.8845 (0.7839) ce_loss 0.4490 (0.4055) teacher_loss 0.3324 (0.2682) loss_zs_kd 0.1012 (0.0972) loss_oracle 0.5015 (0.4670) acc 87.5000 (84.3438) kd_loss 1.0623 (1.0676) lr 3.1417e-05 eta 0:00:32
epoch [48/50] batch [120/167] time 0.079 (0.081) data 0.000 (0.003) loss 0.8236 (0.7865) ce_loss 0.4963 (0.4047) teacher_loss 0.2756 (0.2714) loss_zs_kd 0.1006 (0.0964) loss_oracle 0.4977 (0.4669) acc 84.3750 (84.4010) kd_loss 1.0897 (1.0668) lr 3.1417e-05 eta 0:00:30
epoch [48/50] batch [140/167] time 0.087 (0.081) data 0.001 (0.003) loss 0.7635 (0.7795) ce_loss 0.4072 (0.3997) teacher_loss 0.2769 (0.2683) loss_zs_kd 0.1064 (0.0951) loss_oracle 0.4335 (0.4636) acc 87.5000 (84.6205) kd_loss 1.0126 (1.0638) lr 3.1417e-05 eta 0:00:29
epoch [48/50] batch [160/167] time 0.080 (0.082) data 0.000 (0.002) loss 0.6968 (0.7815) ce_loss 0.3186 (0.4033) teacher_loss 0.2002 (0.2722) loss_zs_kd 0.0842 (0.0948) loss_oracle 0.4545 (0.4619) acc 90.6250 (84.4922) kd_loss 1.0213 (1.0622) lr 3.1417e-05 eta 0:00:27
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,185
* accuracy: 95.1%
* error: 4.9%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [49/50] batch [20/167] time 0.088 (0.095) data 0.000 (0.013) loss 0.9096 (0.7491) ce_loss 0.4839 (0.3539) teacher_loss 0.3927 (0.2395) loss_zs_kd 0.1026 (0.0889) loss_oracle 0.4656 (0.4652) acc 84.3750 (86.4062) kd_loss 1.0617 (1.0433) lr 1.7713e-05 eta 0:00:29
epoch [49/50] batch [40/167] time 0.080 (0.090) data 0.000 (0.006) loss 0.9078 (0.7714) ce_loss 0.5044 (0.3885) teacher_loss 0.3494 (0.2650) loss_zs_kd 0.1018 (0.0926) loss_oracle 0.5076 (0.4601) acc 81.2500 (85.0781) kd_loss 1.0736 (1.0486) lr 1.7713e-05 eta 0:00:26
epoch [49/50] batch [60/167] time 0.084 (0.088) data 0.000 (0.004) loss 0.8932 (0.7763) ce_loss 0.4727 (0.3927) teacher_loss 0.3679 (0.2732) loss_zs_kd 0.1060 (0.0903) loss_oracle 0.4723 (0.4580) acc 71.8750 (84.8958) kd_loss 1.0731 (1.0518) lr 1.7713e-05 eta 0:00:24
epoch [49/50] batch [80/167] time 0.087 (0.088) data 0.000 (0.003) loss 0.8313 (0.7753) ce_loss 0.4321 (0.3911) teacher_loss 0.3160 (0.2696) loss_zs_kd 0.1061 (0.0903) loss_oracle 0.4623 (0.4605) acc 87.5000 (85.1172) kd_loss 1.0381 (1.0516) lr 1.7713e-05 eta 0:00:22
epoch [49/50] batch [100/167] time 0.082 (0.087) data 0.000 (0.003) loss 0.6860 (0.7841) ce_loss 0.2192 (0.4050) teacher_loss 0.1344 (0.2798) loss_zs_kd 0.0860 (0.0911) loss_oracle 0.5087 (0.4587) acc 93.7500 (84.3750) kd_loss 1.0823 (1.0523) lr 1.7713e-05 eta 0:00:20
epoch [49/50] batch [120/167] time 0.089 (0.086) data 0.000 (0.002) loss 0.7284 (0.7839) ce_loss 0.3655 (0.4092) teacher_loss 0.2117 (0.2793) loss_zs_kd 0.0978 (0.0911) loss_oracle 0.4678 (0.4590) acc 87.5000 (84.2969) kd_loss 1.0722 (1.0515) lr 1.7713e-05 eta 0:00:18
epoch [49/50] batch [140/167] time 0.083 (0.085) data 0.000 (0.002) loss 0.8501 (0.7857) ce_loss 0.3904 (0.4085) teacher_loss 0.2914 (0.2814) loss_zs_kd 0.0741 (0.0907) loss_oracle 0.5216 (0.4590) acc 87.5000 (84.4420) kd_loss 1.0734 (1.0506) lr 1.7713e-05 eta 0:00:16
epoch [49/50] batch [160/167] time 0.074 (0.085) data 0.000 (0.002) loss 0.8084 (0.7897) ce_loss 0.3948 (0.4129) teacher_loss 0.2831 (0.2859) loss_zs_kd 0.1142 (0.0901) loss_oracle 0.4682 (0.4588) acc 81.2500 (84.3359) kd_loss 1.0287 (1.0500) lr 1.7713e-05 eta 0:00:14
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,185
* accuracy: 95.1%
* error: 4.9%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
epoch [50/50] batch [20/167] time 0.078 (0.100) data 0.000 (0.016) loss 0.7199 (0.7696) ce_loss 0.4226 (0.4159) teacher_loss 0.2806 (0.2586) loss_zs_kd 0.1043 (0.0921) loss_oracle 0.3871 (0.4650) acc 87.5000 (84.0625) kd_loss 1.0639 (1.0521) lr 7.8853e-06 eta 0:00:14
epoch [50/50] batch [40/167] time 0.083 (0.093) data 0.000 (0.008) loss 0.7049 (0.7630) ce_loss 0.3655 (0.3960) teacher_loss 0.2220 (0.2563) loss_zs_kd 0.0848 (0.0923) loss_oracle 0.4405 (0.4605) acc 87.5000 (84.7656) kd_loss 1.0897 (1.0529) lr 7.8853e-06 eta 0:00:11
epoch [50/50] batch [60/167] time 0.085 (0.090) data 0.000 (0.005) loss 0.8391 (0.7503) ce_loss 0.4009 (0.3762) teacher_loss 0.3362 (0.2480) loss_zs_kd 0.0582 (0.0870) loss_oracle 0.4738 (0.4588) acc 84.3750 (85.6771) kd_loss 1.0862 (1.0523) lr 7.8853e-06 eta 0:00:09
epoch [50/50] batch [80/167] time 0.084 (0.088) data 0.000 (0.004) loss 0.6384 (0.7548) ce_loss 0.3076 (0.3732) teacher_loss 0.1714 (0.2493) loss_zs_kd 0.0698 (0.0849) loss_oracle 0.4321 (0.4630) acc 90.6250 (85.9375) kd_loss 1.0686 (1.0525) lr 7.8853e-06 eta 0:00:07
epoch [50/50] batch [100/167] time 0.087 (0.087) data 0.000 (0.003) loss 0.8705 (0.7676) ce_loss 0.3843 (0.3839) teacher_loss 0.2384 (0.2568) loss_zs_kd 0.1081 (0.0861) loss_oracle 0.5780 (0.4677) acc 90.6250 (85.3750) kd_loss 1.0968 (1.0543) lr 7.8853e-06 eta 0:00:05
epoch [50/50] batch [120/167] time 0.083 (0.087) data 0.000 (0.003) loss 0.6698 (0.7664) ce_loss 0.3137 (0.3836) teacher_loss 0.1971 (0.2572) loss_zs_kd 0.0915 (0.0880) loss_oracle 0.4269 (0.4651) acc 84.3750 (85.3385) kd_loss 1.0084 (1.0536) lr 7.8853e-06 eta 0:00:04
epoch [50/50] batch [140/167] time 0.092 (0.086) data 0.000 (0.003) loss 0.8555 (0.7718) ce_loss 0.4575 (0.3885) teacher_loss 0.3192 (0.2630) loss_zs_kd 0.0870 (0.0886) loss_oracle 0.4929 (0.4644) acc 84.3750 (85.2009) kd_loss 1.0596 (1.0539) lr 7.8853e-06 eta 0:00:02
epoch [50/50] batch [160/167] time 0.083 (0.086) data 0.000 (0.002) loss 0.7753 (0.7744) ce_loss 0.3936 (0.3922) teacher_loss 0.3027 (0.2661) loss_zs_kd 0.0906 (0.0892) loss_oracle 0.4273 (0.4637) acc 84.3750 (85.0977) kd_loss 1.0299 (1.0527) lr 7.8853e-06 eta 0:00:00
Evaluate on the *val* set
=> result
* total: 2,297
* correct: 2,185
* accuracy: 95.1%
* error: 4.9%
* macro_f1: 95.7%
Evaluate on the *test* set
=> result
* total: 2,344
* correct: 2,321
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.1%
******* Domain c best val acc:      95.8%, epoch: 25 *******
******* Domain c best val test acc: 99.0%, epoch: 25 *******
******* Domain c best test acc:     99.3%, epoch: 1 *******
Checkpoint saved to icml/multi-dg/oracle/03_dong/TRIP/pacs/b32_ep50/ViT-B16/c/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:15:43
