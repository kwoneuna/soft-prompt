Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_100', 'location_43', 'location_46']
Target     ['location_38']
# classes  10
# train_x  10,216
# val      4,378
# test     9,736
---------  ----------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/319] time 0.076 (0.176) data 0.001 (0.045) loss 2.2197 (2.9645) ce_loss 1.2549 (2.0158) teacher_loss 1.2528 (2.0152) loss_zs_kd 0.0002 (0.0001) loss_oracle 0.0082 (0.0053) acc 59.3750 (36.8750) kd_loss 0.9628 (0.9466) lr 1.0000e-05 eta 0:46:37
epoch [1/50] batch [40/319] time 0.080 (0.137) data 0.000 (0.023) loss 2.4879 (2.8460) ce_loss 1.5752 (1.9127) teacher_loss 1.5746 (1.9121) loss_zs_kd 0.0015 (0.0003) loss_oracle 0.0138 (0.0112) acc 56.2500 (39.8438) kd_loss 0.9064 (0.9283) lr 1.0000e-05 eta 0:36:15
epoch [1/50] batch [60/319] time 0.077 (0.124) data 0.000 (0.015) loss 3.1352 (2.8817) ce_loss 2.1699 (1.9407) teacher_loss 2.1716 (1.9404) loss_zs_kd 0.0026 (0.0008) loss_oracle 0.0291 (0.0154) acc 31.2500 (39.2708) kd_loss 0.9491 (0.9336) lr 1.0000e-05 eta 0:32:46
epoch [1/50] batch [80/319] time 0.069 (0.120) data 0.000 (0.011) loss 2.9449 (2.8665) ce_loss 1.9766 (1.9221) teacher_loss 1.9702 (1.9215) loss_zs_kd 0.0041 (0.0015) loss_oracle 0.1025 (0.0251) acc 43.7500 (38.8672) kd_loss 0.9235 (0.9324) lr 1.0000e-05 eta 0:31:43
epoch [1/50] batch [100/319] time 0.083 (0.118) data 0.000 (0.009) loss 3.2530 (2.8355) ce_loss 2.1680 (1.8832) teacher_loss 2.1710 (1.8828) loss_zs_kd 0.0083 (0.0025) loss_oracle 0.1544 (0.0447) acc 25.0000 (39.4688) kd_loss 1.0048 (0.9303) lr 1.0000e-05 eta 0:31:11
epoch [1/50] batch [120/319] time 0.088 (0.115) data 0.000 (0.008) loss 2.7710 (2.8378) ce_loss 1.8672 (1.8809) teacher_loss 1.8661 (1.8809) loss_zs_kd 0.0065 (0.0035) loss_oracle 0.0703 (0.0565) acc 40.6250 (39.6354) kd_loss 0.8698 (0.9287) lr 1.0000e-05 eta 0:30:21
epoch [1/50] batch [140/319] time 0.165 (0.115) data 0.000 (0.007) loss 2.8860 (2.8354) ce_loss 2.0508 (1.8808) teacher_loss 2.0505 (1.8808) loss_zs_kd 0.0103 (0.0045) loss_oracle 0.0357 (0.0563) acc 37.5000 (39.5759) kd_loss 0.8176 (0.9264) lr 1.0000e-05 eta 0:30:13
epoch [1/50] batch [160/319] time 0.098 (0.113) data 0.000 (0.006) loss 2.7501 (2.8278) ce_loss 1.8291 (1.8768) teacher_loss 1.8241 (1.8768) loss_zs_kd 0.0138 (0.0058) loss_oracle 0.0373 (0.0529) acc 34.3750 (39.7070) kd_loss 0.9074 (0.9246) lr 1.0000e-05 eta 0:29:49
epoch [1/50] batch [180/319] time 0.127 (0.114) data 0.000 (0.005) loss 3.0509 (2.8229) ce_loss 2.1719 (1.8733) teacher_loss 2.1712 (1.8734) loss_zs_kd 0.0238 (0.0073) loss_oracle 0.0557 (0.0528) acc 28.1250 (39.6181) kd_loss 0.8519 (0.9231) lr 1.0000e-05 eta 0:30:01
epoch [1/50] batch [200/319] time 0.100 (0.112) data 0.000 (0.005) loss 3.0376 (2.8206) ce_loss 1.9932 (1.8687) teacher_loss 1.9913 (1.8687) loss_zs_kd 0.0248 (0.0089) loss_oracle 0.1423 (0.0576) acc 31.2500 (39.5625) kd_loss 0.9751 (0.9231) lr 1.0000e-05 eta 0:29:29
epoch [1/50] batch [220/319] time 0.106 (0.112) data 0.000 (0.004) loss 2.7280 (2.8305) ce_loss 1.7129 (1.8743) teacher_loss 1.7087 (1.8743) loss_zs_kd 0.0326 (0.0108) loss_oracle 0.1447 (0.0655) acc 50.0000 (39.1903) kd_loss 0.9470 (0.9235) lr 1.0000e-05 eta 0:29:15
epoch [1/50] batch [240/319] time 0.145 (0.111) data 0.000 (0.004) loss 2.9018 (2.8429) ce_loss 1.9336 (1.8807) teacher_loss 1.9297 (1.8808) loss_zs_kd 0.0452 (0.0128) loss_oracle 0.1463 (0.0733) acc 28.1250 (38.8802) kd_loss 0.8989 (0.9254) lr 1.0000e-05 eta 0:29:03
epoch [1/50] batch [260/319] time 0.097 (0.111) data 0.000 (0.004) loss 2.9695 (2.8433) ce_loss 1.9746 (1.8779) teacher_loss 1.9806 (1.8779) loss_zs_kd 0.0415 (0.0149) loss_oracle 0.1926 (0.0799) acc 40.6250 (38.8221) kd_loss 0.8925 (0.9255) lr 1.0000e-05 eta 0:28:57
epoch [1/50] batch [280/319] time 0.095 (0.110) data 0.000 (0.003) loss 3.1981 (2.8452) ce_loss 2.0684 (1.8738) teacher_loss 2.0918 (1.8740) loss_zs_kd 0.0606 (0.0172) loss_oracle 0.2967 (0.0913) acc 31.2500 (38.8393) kd_loss 0.9579 (0.9256) lr 1.0000e-05 eta 0:28:44
epoch [1/50] batch [300/319] time 0.092 (0.110) data 0.000 (0.003) loss 3.2807 (2.8452) ce_loss 2.2773 (1.8695) teacher_loss 2.2817 (1.8698) loss_zs_kd 0.0592 (0.0197) loss_oracle 0.1817 (0.1000) acc 31.2500 (38.8229) kd_loss 0.9081 (0.9255) lr 1.0000e-05 eta 0:28:34
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 1,773
* accuracy: 40.5%
* error: 59.5%
* macro_f1: 26.1%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,207
* accuracy: 32.9%
* error: 67.1%
* macro_f1: 14.2%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      40.5%, epoch: 1 *******
******* Domain 2 best val test acc: 32.9%, epoch: 1 *******
******* Domain 2 best test acc:     32.9%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/ana
epoch [2/50] batch [20/319] time 0.150 (0.145) data 0.000 (0.029) loss 3.1172 (3.0927) ce_loss 1.7559 (1.7050) teacher_loss 1.5941 (1.6725) loss_zs_kd 0.6244 (0.4990) loss_oracle 1.0144 (0.8600) acc 31.2500 (37.3438) kd_loss 1.0159 (0.9902) lr 2.0000e-03 eta 0:37:47
epoch [2/50] batch [40/319] time 0.091 (0.114) data 0.000 (0.015) loss 3.4281 (3.1211) ce_loss 2.0410 (1.6997) teacher_loss 1.8791 (1.6267) loss_zs_kd 0.4792 (0.6267) loss_oracle 1.0497 (0.9609) acc 28.1250 (37.4219) kd_loss 1.0242 (1.0140) lr 2.0000e-03 eta 0:29:42
epoch [2/50] batch [60/319] time 0.129 (0.113) data 0.002 (0.010) loss 3.0556 (3.0953) ce_loss 1.7607 (1.6671) teacher_loss 1.4907 (1.5795) loss_zs_kd 0.3677 (0.5531) loss_oracle 1.0518 (0.9904) acc 34.3750 (38.2812) kd_loss 1.0389 (1.0206) lr 2.0000e-03 eta 0:29:26
epoch [2/50] batch [80/319] time 0.094 (0.114) data 0.000 (0.007) loss 2.9041 (3.0664) ce_loss 1.4893 (1.6208) teacher_loss 1.4039 (1.5474) loss_zs_kd 0.4397 (0.4996) loss_oracle 0.9782 (0.9893) acc 53.1250 (39.9609) kd_loss 1.0111 (1.0243) lr 2.0000e-03 eta 0:29:27
epoch [2/50] batch [100/319] time 0.084 (0.112) data 0.000 (0.006) loss 3.0277 (3.0606) ce_loss 1.6943 (1.6012) teacher_loss 1.5053 (1.5340) loss_zs_kd 0.3950 (0.4825) loss_oracle 0.9593 (0.9872) acc 34.3750 (40.3125) kd_loss 1.0428 (1.0330) lr 2.0000e-03 eta 0:29:00
epoch [2/50] batch [120/319] time 0.176 (0.111) data 0.000 (0.005) loss 2.6192 (3.0383) ce_loss 1.2070 (1.5804) teacher_loss 1.0762 (1.5135) loss_zs_kd 0.3804 (0.4770) loss_oracle 0.9811 (0.9843) acc 62.5000 (40.7552) kd_loss 1.0524 (1.0326) lr 2.0000e-03 eta 0:28:37
epoch [2/50] batch [140/319] time 0.174 (0.112) data 0.000 (0.004) loss 3.0931 (3.0239) ce_loss 1.7246 (1.5740) teacher_loss 1.5408 (1.4995) loss_zs_kd 0.5189 (0.4757) loss_oracle 1.0070 (0.9836) acc 37.5000 (40.7589) kd_loss 1.0488 (1.0326) lr 2.0000e-03 eta 0:28:55
epoch [2/50] batch [160/319] time 0.153 (0.113) data 0.000 (0.004) loss 2.9105 (3.0053) ce_loss 1.4600 (1.5584) teacher_loss 1.3376 (1.4779) loss_zs_kd 0.4631 (0.4842) loss_oracle 1.0214 (0.9861) acc 46.8750 (41.6406) kd_loss 1.0622 (1.0343) lr 2.0000e-03 eta 0:29:04
epoch [2/50] batch [180/319] time 0.090 (0.110) data 0.000 (0.003) loss 3.0588 (3.0000) ce_loss 1.6279 (1.5592) teacher_loss 1.4945 (1.4709) loss_zs_kd 0.6379 (0.5004) loss_oracle 1.0542 (0.9910) acc 31.2500 (41.7014) kd_loss 1.0372 (1.0336) lr 2.0000e-03 eta 0:28:19
epoch [2/50] batch [200/319] time 0.102 (0.109) data 0.000 (0.003) loss 2.8769 (2.9918) ce_loss 1.4727 (1.5602) teacher_loss 1.3736 (1.4652) loss_zs_kd 0.6674 (0.5202) loss_oracle 1.0028 (0.9921) acc 53.1250 (41.7031) kd_loss 1.0019 (1.0306) lr 2.0000e-03 eta 0:28:05
epoch [2/50] batch [220/319] time 0.111 (0.109) data 0.000 (0.003) loss 3.1250 (2.9774) ce_loss 1.7490 (1.5561) teacher_loss 1.6519 (1.4562) loss_zs_kd 0.3932 (0.5216) loss_oracle 0.9737 (0.9905) acc 31.2500 (41.5199) kd_loss 0.9863 (1.0260) lr 2.0000e-03 eta 0:27:54
epoch [2/50] batch [240/319] time 0.107 (0.108) data 0.000 (0.003) loss 2.4383 (2.9554) ce_loss 1.1318 (1.5440) teacher_loss 0.9756 (1.4395) loss_zs_kd 0.4891 (0.5131) loss_oracle 0.9539 (0.9876) acc 53.1250 (41.9531) kd_loss 0.9858 (1.0222) lr 2.0000e-03 eta 0:27:46
epoch [2/50] batch [260/319] time 0.104 (0.108) data 0.000 (0.002) loss 2.7334 (2.9274) ce_loss 1.4404 (1.5322) teacher_loss 1.2935 (1.4174) loss_zs_kd 0.4363 (0.5144) loss_oracle 0.9479 (0.9861) acc 46.8750 (42.3197) kd_loss 0.9659 (1.0170) lr 2.0000e-03 eta 0:27:40
epoch [2/50] batch [280/319] time 0.116 (0.108) data 0.000 (0.002) loss 2.7714 (2.9140) ce_loss 1.3975 (1.5281) teacher_loss 1.3513 (1.4105) loss_zs_kd 0.4167 (0.5123) loss_oracle 0.9460 (0.9832) acc 46.8750 (42.4219) kd_loss 0.9471 (1.0120) lr 2.0000e-03 eta 0:27:36
epoch [2/50] batch [300/319] time 0.114 (0.108) data 0.000 (0.002) loss 2.5037 (2.9030) ce_loss 1.2910 (1.5250) teacher_loss 1.1027 (1.4058) loss_zs_kd 0.4758 (0.5136) loss_oracle 0.9396 (0.9808) acc 50.0000 (42.4479) kd_loss 0.9312 (1.0068) lr 2.0000e-03 eta 0:27:31
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,123
* accuracy: 48.5%
* error: 51.5%
* macro_f1: 36.4%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,490
* accuracy: 46.1%
* error: 53.9%
* macro_f1: 17.8%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      48.5%, epoch: 2 *******
******* Domain 2 best val test acc: 46.1%, epoch: 2 *******
******* Domain 2 best test acc:     46.1%, epoch: 2 *******
epoch [3/50] batch [20/319] time 0.086 (0.120) data 0.000 (0.025) loss 2.3570 (2.5777) ce_loss 1.0996 (1.3106) teacher_loss 1.0089 (1.1996) loss_zs_kd 0.4173 (0.5066) loss_oracle 0.9086 (0.9285) acc 56.2500 (50.9375) kd_loss 0.8938 (0.9139) lr 1.9980e-03 eta 0:30:29
epoch [3/50] batch [40/319] time 0.080 (0.116) data 0.000 (0.013) loss 2.4857 (2.6020) ce_loss 1.2861 (1.3391) teacher_loss 1.1386 (1.2312) loss_zs_kd 0.5511 (0.5177) loss_oracle 0.9092 (0.9241) acc 56.2500 (49.2969) kd_loss 0.8924 (0.9088) lr 1.9980e-03 eta 0:29:31
epoch [3/50] batch [60/319] time 0.070 (0.114) data 0.000 (0.009) loss 2.3474 (2.5846) ce_loss 1.1943 (1.3407) teacher_loss 1.0183 (1.2170) loss_zs_kd 0.5972 (0.5319) loss_oracle 0.8937 (0.9271) acc 56.2500 (49.1667) kd_loss 0.8822 (0.9040) lr 1.9980e-03 eta 0:28:53
epoch [3/50] batch [80/319] time 0.073 (0.109) data 0.000 (0.006) loss 2.4071 (2.5836) ce_loss 1.1396 (1.3471) teacher_loss 1.0648 (1.2203) loss_zs_kd 0.4949 (0.5477) loss_oracle 0.8823 (0.9200) acc 62.5000 (48.5938) kd_loss 0.9012 (0.9033) lr 1.9980e-03 eta 0:27:37
epoch [3/50] batch [100/319] time 0.073 (0.109) data 0.000 (0.005) loss 2.4842 (2.5849) ce_loss 1.1660 (1.3505) teacher_loss 1.1631 (1.2232) loss_zs_kd 0.5140 (0.5394) loss_oracle 0.9242 (0.9185) acc 65.6250 (48.7812) kd_loss 0.8590 (0.9025) lr 1.9980e-03 eta 0:27:40
epoch [3/50] batch [120/319] time 0.066 (0.110) data 0.000 (0.004) loss 2.8361 (2.5891) ce_loss 1.4814 (1.3482) teacher_loss 1.4155 (1.2221) loss_zs_kd 0.5278 (0.5376) loss_oracle 0.9420 (0.9185) acc 43.7500 (49.2448) kd_loss 0.9497 (0.9077) lr 1.9980e-03 eta 0:27:57
epoch [3/50] batch [140/319] time 0.081 (0.110) data 0.000 (0.004) loss 2.3014 (2.5813) ce_loss 1.0820 (1.3431) teacher_loss 0.9843 (1.2162) loss_zs_kd 0.5412 (0.5402) loss_oracle 0.8436 (0.9165) acc 65.6250 (49.4643) kd_loss 0.8953 (0.9068) lr 1.9980e-03 eta 0:27:51
epoch [3/50] batch [160/319] time 0.094 (0.108) data 0.000 (0.003) loss 2.4121 (2.5677) ce_loss 1.1846 (1.3404) teacher_loss 1.0907 (1.2056) loss_zs_kd 0.6872 (0.5506) loss_oracle 0.8854 (0.9156) acc 59.3750 (49.4141) kd_loss 0.8788 (0.9043) lr 1.9980e-03 eta 0:27:22
epoch [3/50] batch [180/319] time 0.097 (0.107) data 0.000 (0.003) loss 2.7207 (2.5689) ce_loss 1.3535 (1.3396) teacher_loss 1.3458 (1.2072) loss_zs_kd 0.4451 (0.5584) loss_oracle 0.9305 (0.9176) acc 50.0000 (49.3924) kd_loss 0.9096 (0.9030) lr 1.9980e-03 eta 0:27:06
epoch [3/50] batch [200/319] time 0.100 (0.107) data 0.000 (0.003) loss 2.5777 (2.5603) ce_loss 1.3350 (1.3374) teacher_loss 1.2523 (1.2038) loss_zs_kd 0.6085 (0.5541) loss_oracle 0.8791 (0.9133) acc 56.2500 (49.3594) kd_loss 0.8858 (0.8999) lr 1.9980e-03 eta 0:27:00
epoch [3/50] batch [220/319] time 0.110 (0.107) data 0.000 (0.003) loss 2.4497 (2.5531) ce_loss 1.3740 (1.3391) teacher_loss 1.0375 (1.1981) loss_zs_kd 0.5229 (0.5610) loss_oracle 0.9426 (0.9113) acc 31.2500 (49.0767) kd_loss 0.9408 (0.8993) lr 1.9980e-03 eta 0:26:54
epoch [3/50] batch [240/319] time 0.110 (0.107) data 0.000 (0.002) loss 2.6352 (2.5447) ce_loss 1.5410 (1.3350) teacher_loss 1.2734 (1.1913) loss_zs_kd 0.7482 (0.5682) loss_oracle 0.9005 (0.9091) acc 43.7500 (49.2839) kd_loss 0.9116 (0.8988) lr 1.9980e-03 eta 0:26:49
epoch [3/50] batch [260/319] time 0.112 (0.107) data 0.000 (0.002) loss 2.5087 (2.5472) ce_loss 1.2363 (1.3339) teacher_loss 1.1891 (1.1940) loss_zs_kd 0.6348 (0.5755) loss_oracle 0.8686 (0.9070) acc 53.1250 (49.4471) kd_loss 0.8853 (0.8997) lr 1.9980e-03 eta 0:26:45
epoch [3/50] batch [280/319] time 0.092 (0.106) data 0.000 (0.002) loss 2.3441 (2.5386) ce_loss 1.2852 (1.3314) teacher_loss 1.0264 (1.1880) loss_zs_kd 0.7511 (0.5862) loss_oracle 0.8702 (0.9037) acc 50.0000 (49.4754) kd_loss 0.8826 (0.8988) lr 1.9980e-03 eta 0:26:36
epoch [3/50] batch [300/319] time 0.102 (0.106) data 0.000 (0.002) loss 2.2401 (2.5332) ce_loss 1.1719 (1.3318) teacher_loss 0.8957 (1.1851) loss_zs_kd 0.8643 (0.6008) loss_oracle 0.8569 (0.8995) acc 56.2500 (49.6771) kd_loss 0.9160 (0.8984) lr 1.9980e-03 eta 0:26:29
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,172
* accuracy: 49.6%
* error: 50.4%
* macro_f1: 38.7%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,171
* accuracy: 53.1%
* error: 46.9%
* macro_f1: 21.1%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      49.6%, epoch: 3 *******
******* Domain 2 best val test acc: 53.1%, epoch: 3 *******
******* Domain 2 best test acc:     53.1%, epoch: 3 *******
epoch [4/50] batch [20/319] time 0.094 (0.120) data 0.000 (0.026) loss 2.4135 (2.3964) ce_loss 1.4512 (1.3650) teacher_loss 1.1251 (1.1037) loss_zs_kd 0.9057 (0.8968) loss_oracle 0.8661 (0.8612) acc 37.5000 (45.6250) kd_loss 0.8554 (0.8620) lr 1.9921e-03 eta 0:29:58
epoch [4/50] batch [40/319] time 0.078 (0.116) data 0.000 (0.013) loss 2.4841 (2.4049) ce_loss 1.2812 (1.3348) teacher_loss 1.1174 (1.0986) loss_zs_kd 0.7519 (0.9202) loss_oracle 0.8606 (0.8645) acc 46.8750 (47.0312) kd_loss 0.9364 (0.8740) lr 1.9921e-03 eta 0:29:01
epoch [4/50] batch [60/319] time 0.065 (0.115) data 0.000 (0.009) loss 2.4884 (2.3900) ce_loss 1.5068 (1.3130) teacher_loss 1.1650 (1.0896) loss_zs_kd 0.9526 (0.8840) loss_oracle 0.8482 (0.8611) acc 43.7500 (49.2708) kd_loss 0.8993 (0.8699) lr 1.9921e-03 eta 0:28:34
epoch [4/50] batch [80/319] time 0.064 (0.113) data 0.000 (0.007) loss 2.5697 (2.3926) ce_loss 1.3301 (1.3206) teacher_loss 1.3068 (1.1003) loss_zs_kd 0.7487 (0.8621) loss_oracle 0.8720 (0.8578) acc 53.1250 (49.1797) kd_loss 0.8270 (0.8634) lr 1.9921e-03 eta 0:28:06
epoch [4/50] batch [100/319] time 0.086 (0.111) data 0.000 (0.005) loss 2.6613 (2.3869) ce_loss 1.3594 (1.3174) teacher_loss 1.3597 (1.0979) loss_zs_kd 0.8047 (0.8476) loss_oracle 0.8977 (0.8599) acc 46.8750 (49.3125) kd_loss 0.8527 (0.8591) lr 1.9921e-03 eta 0:27:39
epoch [4/50] batch [120/319] time 0.123 (0.113) data 0.000 (0.005) loss 2.4351 (2.3864) ce_loss 1.4307 (1.3158) teacher_loss 1.1958 (1.1003) loss_zs_kd 0.7336 (0.8360) loss_oracle 0.8117 (0.8573) acc 53.1250 (49.6875) kd_loss 0.8335 (0.8574) lr 1.9921e-03 eta 0:27:55
epoch [4/50] batch [140/319] time 0.073 (0.113) data 0.000 (0.004) loss 2.6980 (2.3933) ce_loss 1.3809 (1.3135) teacher_loss 1.4310 (1.1053) loss_zs_kd 1.0365 (0.8423) loss_oracle 0.8172 (0.8546) acc 50.0000 (49.9554) kd_loss 0.8584 (0.8608) lr 1.9921e-03 eta 0:27:52
epoch [4/50] batch [160/319] time 0.108 (0.110) data 0.000 (0.004) loss 2.9576 (2.4029) ce_loss 1.5957 (1.3167) teacher_loss 1.5602 (1.1100) loss_zs_kd 0.9891 (0.8481) loss_oracle 0.8331 (0.8518) acc 37.5000 (50.1172) kd_loss 0.9808 (0.8670) lr 1.9921e-03 eta 0:27:15
epoch [4/50] batch [180/319] time 0.116 (0.110) data 0.000 (0.003) loss 2.5012 (2.4156) ce_loss 1.2617 (1.3142) teacher_loss 1.1589 (1.1158) loss_zs_kd 0.7348 (0.8506) loss_oracle 0.8678 (0.8501) acc 53.1250 (50.0347) kd_loss 0.9084 (0.8748) lr 1.9921e-03 eta 0:27:06
epoch [4/50] batch [200/319] time 0.083 (0.109) data 0.000 (0.003) loss 2.3756 (2.4224) ce_loss 1.2021 (1.3070) teacher_loss 1.0796 (1.1222) loss_zs_kd 0.7518 (0.8441) loss_oracle 0.8198 (0.8494) acc 62.5000 (50.4062) kd_loss 0.8861 (0.8756) lr 1.9921e-03 eta 0:26:54
epoch [4/50] batch [220/319] time 0.102 (0.108) data 0.001 (0.003) loss 2.4807 (2.4193) ce_loss 1.2666 (1.2977) teacher_loss 1.2412 (1.1204) loss_zs_kd 0.8722 (0.8401) loss_oracle 0.8360 (0.8475) acc 46.8750 (50.9233) kd_loss 0.8215 (0.8751) lr 1.9921e-03 eta 0:26:38
epoch [4/50] batch [240/319] time 0.106 (0.108) data 0.000 (0.002) loss 2.4465 (2.4211) ce_loss 1.2061 (1.2970) teacher_loss 1.2614 (1.1240) loss_zs_kd 0.8114 (0.8386) loss_oracle 0.8286 (0.8462) acc 50.0000 (50.8984) kd_loss 0.7707 (0.8740) lr 1.9921e-03 eta 0:26:28
epoch [4/50] batch [260/319] time 0.110 (0.107) data 0.000 (0.002) loss 2.5643 (2.4204) ce_loss 1.3643 (1.2975) teacher_loss 1.2866 (1.1269) loss_zs_kd 0.9639 (0.8396) loss_oracle 0.8879 (0.8459) acc 43.7500 (50.7452) kd_loss 0.8338 (0.8705) lr 1.9921e-03 eta 0:26:22
epoch [4/50] batch [280/319] time 0.102 (0.107) data 0.000 (0.002) loss 2.2876 (2.4143) ce_loss 1.3213 (1.2931) teacher_loss 1.0981 (1.1250) loss_zs_kd 0.8178 (0.8392) loss_oracle 0.8209 (0.8452) acc 46.8750 (50.9040) kd_loss 0.7790 (0.8668) lr 1.9921e-03 eta 0:26:15
epoch [4/50] batch [300/319] time 0.109 (0.107) data 0.000 (0.002) loss 2.1811 (2.4092) ce_loss 1.0889 (1.2869) teacher_loss 0.8976 (1.1218) loss_zs_kd 0.9963 (0.8392) loss_oracle 0.8345 (0.8433) acc 59.3750 (51.0729) kd_loss 0.8663 (0.8657) lr 1.9921e-03 eta 0:26:08
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,285
* accuracy: 52.2%
* error: 47.8%
* macro_f1: 41.9%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,178
* accuracy: 53.2%
* error: 46.8%
* macro_f1: 19.3%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      52.2%, epoch: 4 *******
******* Domain 2 best val test acc: 53.2%, epoch: 4 *******
******* Domain 2 best test acc:     53.2%, epoch: 4 *******
epoch [5/50] batch [20/319] time 0.076 (0.128) data 0.000 (0.029) loss 2.3579 (2.3501) ce_loss 1.2676 (1.2726) teacher_loss 1.1239 (1.1006) loss_zs_kd 0.8057 (0.8886) loss_oracle 0.7839 (0.8139) acc 50.0000 (50.0000) kd_loss 0.8420 (0.8426) lr 1.9823e-03 eta 0:31:21
epoch [5/50] batch [40/319] time 0.076 (0.114) data 0.000 (0.015) loss 2.0798 (2.3492) ce_loss 1.0000 (1.2762) teacher_loss 0.7861 (1.1145) loss_zs_kd 0.9112 (0.9206) loss_oracle 0.8283 (0.8066) acc 56.2500 (50.0000) kd_loss 0.8795 (0.8315) lr 1.9823e-03 eta 0:27:48
epoch [5/50] batch [60/319] time 0.085 (0.113) data 0.000 (0.010) loss 2.2199 (2.3643) ce_loss 1.1748 (1.2739) teacher_loss 0.9940 (1.1260) loss_zs_kd 0.9991 (0.8988) loss_oracle 0.8569 (0.8113) acc 56.2500 (50.2083) kd_loss 0.7974 (0.8327) lr 1.9823e-03 eta 0:27:33
epoch [5/50] batch [80/319] time 0.082 (0.113) data 0.000 (0.008) loss 1.9934 (2.3426) ce_loss 1.0156 (1.2601) teacher_loss 0.7618 (1.1154) loss_zs_kd 0.7968 (0.8969) loss_oracle 0.8124 (0.8078) acc 68.7500 (51.4453) kd_loss 0.8255 (0.8233) lr 1.9823e-03 eta 0:27:27
epoch [5/50] batch [100/319] time 0.066 (0.111) data 0.000 (0.006) loss 2.4155 (2.3287) ce_loss 1.2988 (1.2548) teacher_loss 1.1273 (1.1023) loss_zs_kd 0.9688 (0.9092) loss_oracle 0.8055 (0.8089) acc 43.7500 (51.9062) kd_loss 0.8854 (0.8219) lr 1.9823e-03 eta 0:27:02
epoch [5/50] batch [120/319] time 0.078 (0.112) data 0.000 (0.005) loss 2.4077 (2.3422) ce_loss 1.2002 (1.2582) teacher_loss 1.1232 (1.1141) loss_zs_kd 0.7293 (0.8946) loss_oracle 0.8033 (0.8083) acc 46.8750 (51.7448) kd_loss 0.8828 (0.8239) lr 1.9823e-03 eta 0:27:10
epoch [5/50] batch [140/319] time 0.086 (0.112) data 0.000 (0.004) loss 2.7375 (2.3452) ce_loss 1.5342 (1.2507) teacher_loss 1.4051 (1.1113) loss_zs_kd 0.8207 (0.8903) loss_oracle 0.8404 (0.8071) acc 31.2500 (52.1875) kd_loss 0.9123 (0.8303) lr 1.9823e-03 eta 0:27:12
epoch [5/50] batch [160/319] time 0.104 (0.110) data 0.000 (0.004) loss 2.7215 (2.3659) ce_loss 1.3330 (1.2422) teacher_loss 1.2800 (1.1156) loss_zs_kd 0.7655 (0.8818) loss_oracle 0.8212 (0.8099) acc 50.0000 (52.6758) kd_loss 1.0309 (0.8454) lr 1.9823e-03 eta 0:26:41
epoch [5/50] batch [180/319] time 0.118 (0.110) data 0.000 (0.004) loss 2.3504 (2.3841) ce_loss 1.0459 (1.2379) teacher_loss 0.9638 (1.1184) loss_zs_kd 0.9505 (0.8782) loss_oracle 0.8207 (0.8106) acc 65.6250 (53.0035) kd_loss 0.9763 (0.8603) lr 1.9823e-03 eta 0:26:34
epoch [5/50] batch [200/319] time 0.097 (0.109) data 0.000 (0.003) loss 2.4473 (2.3911) ce_loss 1.1797 (1.2355) teacher_loss 1.0838 (1.1212) loss_zs_kd 0.9333 (0.8712) loss_oracle 0.8637 (0.8114) acc 62.5000 (53.2656) kd_loss 0.9317 (0.8642) lr 1.9823e-03 eta 0:26:23
epoch [5/50] batch [220/319] time 0.099 (0.109) data 0.000 (0.003) loss 2.3166 (2.4047) ce_loss 1.0020 (1.2359) teacher_loss 0.9894 (1.1266) loss_zs_kd 0.8029 (0.8621) loss_oracle 0.8061 (0.8144) acc 75.0000 (53.3381) kd_loss 0.9241 (0.8709) lr 1.9823e-03 eta 0:26:13
epoch [5/50] batch [240/319] time 0.099 (0.108) data 0.000 (0.003) loss 2.4314 (2.4179) ce_loss 1.1250 (1.2397) teacher_loss 1.0768 (1.1322) loss_zs_kd 0.6923 (0.8582) loss_oracle 0.8988 (0.8184) acc 46.8750 (53.1901) kd_loss 0.9052 (0.8765) lr 1.9823e-03 eta 0:26:04
epoch [5/50] batch [260/319] time 0.100 (0.108) data 0.000 (0.003) loss 2.7001 (2.4240) ce_loss 1.3838 (1.2428) teacher_loss 1.4198 (1.1342) loss_zs_kd 0.9696 (0.8588) loss_oracle 0.7936 (0.8231) acc 50.0000 (52.8966) kd_loss 0.8835 (0.8782) lr 1.9823e-03 eta 0:25:53
epoch [5/50] batch [280/319] time 0.099 (0.107) data 0.000 (0.002) loss 2.1076 (2.4255) ce_loss 0.8413 (1.2419) teacher_loss 0.7771 (1.1350) loss_zs_kd 0.5607 (0.8544) loss_oracle 0.8175 (0.8232) acc 68.7500 (53.0134) kd_loss 0.9218 (0.8789) lr 1.9823e-03 eta 0:25:39
epoch [5/50] batch [300/319] time 0.125 (0.106) data 0.000 (0.002) loss 2.4876 (2.4239) ce_loss 1.2803 (1.2383) teacher_loss 1.2678 (1.1365) loss_zs_kd 0.7188 (0.8478) loss_oracle 0.7868 (0.8223) acc 56.2500 (53.2292) kd_loss 0.8264 (0.8763) lr 1.9823e-03 eta 0:25:30
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,686
* accuracy: 61.4%
* error: 38.6%
* macro_f1: 52.3%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,636
* accuracy: 47.6%
* error: 52.4%
* macro_f1: 21.1%
******* Domain 2 best val acc:      61.4%, epoch: 5 *******
******* Domain 2 best val test acc: 47.6%, epoch: 5 *******
******* Domain 2 best test acc:     53.2%, epoch: 4 *******
epoch [6/50] batch [20/319] time 0.071 (0.130) data 0.000 (0.029) loss 2.4709 (2.3614) ce_loss 1.3779 (1.1451) teacher_loss 1.1871 (1.0992) loss_zs_kd 0.8320 (0.7728) loss_oracle 0.8057 (0.8177) acc 37.5000 (57.3438) kd_loss 0.8809 (0.8533) lr 1.9686e-03 eta 0:31:08
epoch [6/50] batch [40/319] time 0.069 (0.119) data 0.000 (0.015) loss 2.3126 (2.3097) ce_loss 1.2803 (1.1359) teacher_loss 1.0845 (1.0538) loss_zs_kd 0.7921 (0.7877) loss_oracle 0.8030 (0.8199) acc 50.0000 (57.1875) kd_loss 0.8266 (0.8459) lr 1.9686e-03 eta 0:28:28
epoch [6/50] batch [60/319] time 0.083 (0.117) data 0.001 (0.010) loss 2.4652 (2.3388) ce_loss 1.2402 (1.1638) teacher_loss 1.2121 (1.0869) loss_zs_kd 0.7803 (0.7775) loss_oracle 0.8008 (0.8197) acc 46.8750 (55.4688) kd_loss 0.8527 (0.8420) lr 1.9686e-03 eta 0:27:46
epoch [6/50] batch [80/319] time 0.068 (0.109) data 0.000 (0.008) loss 2.4061 (2.3478) ce_loss 1.2598 (1.1683) teacher_loss 1.1973 (1.0981) loss_zs_kd 0.7880 (0.7742) loss_oracle 0.7340 (0.8189) acc 59.3750 (54.8438) kd_loss 0.8419 (0.8403) lr 1.9686e-03 eta 0:26:01
epoch [6/50] batch [100/319] time 0.079 (0.109) data 0.000 (0.006) loss 2.2829 (2.3633) ce_loss 1.0186 (1.1796) teacher_loss 1.0144 (1.1156) loss_zs_kd 0.8184 (0.7638) loss_oracle 0.8380 (0.8169) acc 68.7500 (54.7500) kd_loss 0.8495 (0.8393) lr 1.9686e-03 eta 0:25:58
epoch [6/50] batch [120/319] time 0.075 (0.109) data 0.000 (0.005) loss 2.3068 (2.3630) ce_loss 1.1836 (1.1786) teacher_loss 1.0565 (1.1115) loss_zs_kd 0.9541 (0.7755) loss_oracle 0.7841 (0.8188) acc 56.2500 (55.2344) kd_loss 0.8582 (0.8421) lr 1.9686e-03 eta 0:25:53
epoch [6/50] batch [140/319] time 0.108 (0.107) data 0.000 (0.004) loss 2.5267 (2.3606) ce_loss 1.3477 (1.1770) teacher_loss 1.3222 (1.1088) loss_zs_kd 0.7956 (0.7854) loss_oracle 0.8210 (0.8218) acc 50.0000 (55.5134) kd_loss 0.7940 (0.8409) lr 1.9686e-03 eta 0:25:27
epoch [6/50] batch [160/319] time 0.100 (0.107) data 0.000 (0.004) loss 2.3482 (2.3534) ce_loss 1.1250 (1.1807) teacher_loss 1.0852 (1.1014) loss_zs_kd 0.7594 (0.7986) loss_oracle 0.7679 (0.8222) acc 62.5000 (55.5078) kd_loss 0.8790 (0.8408) lr 1.9686e-03 eta 0:25:14
epoch [6/50] batch [180/319] time 0.096 (0.106) data 0.000 (0.004) loss 2.5382 (2.3608) ce_loss 1.4258 (1.1882) teacher_loss 1.3273 (1.1085) loss_zs_kd 0.8176 (0.8000) loss_oracle 0.8112 (0.8232) acc 46.8750 (55.4340) kd_loss 0.8053 (0.8407) lr 1.9686e-03 eta 0:25:04
epoch [6/50] batch [200/319] time 0.113 (0.105) data 0.000 (0.003) loss 2.3013 (2.3542) ce_loss 1.1289 (1.1846) teacher_loss 1.0670 (1.1039) loss_zs_kd 0.7285 (0.7917) loss_oracle 0.8165 (0.8217) acc 59.3750 (55.5469) kd_loss 0.8260 (0.8394) lr 1.9686e-03 eta 0:24:53
epoch [6/50] batch [220/319] time 0.109 (0.105) data 0.000 (0.003) loss 2.3045 (2.3547) ce_loss 1.0850 (1.1828) teacher_loss 1.0074 (1.1044) loss_zs_kd 0.8321 (0.7995) loss_oracle 0.8157 (0.8210) acc 65.6250 (55.6818) kd_loss 0.8893 (0.8398) lr 1.9686e-03 eta 0:24:48
epoch [6/50] batch [240/319] time 0.105 (0.105) data 0.000 (0.003) loss 2.6732 (2.3611) ce_loss 1.4082 (1.1865) teacher_loss 1.4383 (1.1117) loss_zs_kd 0.7641 (0.7973) loss_oracle 0.8362 (0.8204) acc 37.5000 (55.5469) kd_loss 0.8168 (0.8392) lr 1.9686e-03 eta 0:24:45
epoch [6/50] batch [260/319] time 0.099 (0.105) data 0.000 (0.003) loss 2.1922 (2.3598) ce_loss 1.0156 (1.1870) teacher_loss 0.8988 (1.1104) loss_zs_kd 0.7988 (0.7923) loss_oracle 0.8399 (0.8203) acc 53.1250 (55.5048) kd_loss 0.8734 (0.8392) lr 1.9686e-03 eta 0:24:40
epoch [6/50] batch [280/319] time 0.100 (0.105) data 0.000 (0.002) loss 2.3061 (2.3607) ce_loss 1.1270 (1.1896) teacher_loss 1.0645 (1.1113) loss_zs_kd 0.7006 (0.7905) loss_oracle 0.8000 (0.8204) acc 56.2500 (55.2679) kd_loss 0.8416 (0.8391) lr 1.9686e-03 eta 0:24:38
epoch [6/50] batch [300/319] time 0.094 (0.105) data 0.000 (0.002) loss 2.2723 (2.3589) ce_loss 1.2480 (1.1940) teacher_loss 1.0006 (1.1099) loss_zs_kd 0.8069 (0.7850) loss_oracle 0.8591 (0.8210) acc 56.2500 (55.0000) kd_loss 0.8422 (0.8385) lr 1.9686e-03 eta 0:24:35
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,677
* accuracy: 61.1%
* error: 38.9%
* macro_f1: 53.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,033
* accuracy: 51.7%
* error: 48.3%
* macro_f1: 22.2%
******* Domain 2 best val acc:      61.4%, epoch: 5 *******
******* Domain 2 best val test acc: 47.6%, epoch: 5 *******
******* Domain 2 best test acc:     53.2%, epoch: 4 *******
epoch [7/50] batch [20/319] time 0.169 (0.138) data 0.000 (0.027) loss 1.9674 (2.2911) ce_loss 0.8447 (1.1543) teacher_loss 0.7209 (1.0672) loss_zs_kd 0.7846 (0.7698) loss_oracle 0.8421 (0.8140) acc 71.8750 (59.6875) kd_loss 0.8254 (0.8169) lr 1.9511e-03 eta 0:32:19
epoch [7/50] batch [40/319] time 0.170 (0.124) data 0.000 (0.014) loss 2.6186 (2.3298) ce_loss 1.4238 (1.1839) teacher_loss 1.3597 (1.1057) loss_zs_kd 0.8105 (0.7677) loss_oracle 0.8194 (0.8168) acc 53.1250 (57.1875) kd_loss 0.8492 (0.8157) lr 1.9511e-03 eta 0:28:51
epoch [7/50] batch [60/319] time 0.074 (0.115) data 0.000 (0.009) loss 2.2552 (2.2923) ce_loss 1.1270 (1.1733) teacher_loss 0.9606 (1.0644) loss_zs_kd 0.8591 (0.7812) loss_oracle 0.8558 (0.8186) acc 62.5000 (57.5000) kd_loss 0.8667 (0.8187) lr 1.9511e-03 eta 0:26:49
epoch [7/50] batch [80/319] time 0.067 (0.113) data 0.000 (0.007) loss 2.2615 (2.2957) ce_loss 1.1328 (1.1797) teacher_loss 1.0678 (1.0666) loss_zs_kd 0.7475 (0.7861) loss_oracle 0.8042 (0.8204) acc 56.2500 (56.8359) kd_loss 0.7915 (0.8188) lr 1.9511e-03 eta 0:26:20
epoch [7/50] batch [100/319] time 0.130 (0.107) data 0.000 (0.006) loss 2.3059 (2.3012) ce_loss 1.2246 (1.1944) teacher_loss 1.0699 (1.0714) loss_zs_kd 0.7605 (0.7868) loss_oracle 0.8219 (0.8180) acc 59.3750 (55.8125) kd_loss 0.8251 (0.8207) lr 1.9511e-03 eta 0:24:57
epoch [7/50] batch [120/319] time 0.072 (0.106) data 0.000 (0.005) loss 2.6499 (2.2912) ce_loss 1.5029 (1.1955) teacher_loss 1.4285 (1.0614) loss_zs_kd 0.8192 (0.7945) loss_oracle 0.8121 (0.8180) acc 37.5000 (55.0521) kd_loss 0.8154 (0.8208) lr 1.9511e-03 eta 0:24:38
epoch [7/50] batch [140/319] time 0.095 (0.104) data 0.000 (0.004) loss 2.3097 (2.2937) ce_loss 1.1299 (1.1966) teacher_loss 1.0737 (1.0627) loss_zs_kd 0.7229 (0.7916) loss_oracle 0.8194 (0.8180) acc 50.0000 (54.9777) kd_loss 0.8263 (0.8220) lr 1.9511e-03 eta 0:24:04
epoch [7/50] batch [160/319] time 0.086 (0.104) data 0.000 (0.004) loss 2.1482 (2.2986) ce_loss 0.9849 (1.1953) teacher_loss 0.9341 (1.0678) loss_zs_kd 0.7225 (0.7885) loss_oracle 0.7843 (0.8165) acc 65.6250 (54.7852) kd_loss 0.8219 (0.8225) lr 1.9511e-03 eta 0:23:56
epoch [7/50] batch [180/319] time 0.106 (0.103) data 0.000 (0.003) loss 2.3067 (2.3089) ce_loss 1.2832 (1.1979) teacher_loss 1.0446 (1.0784) loss_zs_kd 0.8733 (0.7953) loss_oracle 0.8135 (0.8175) acc 53.1250 (54.7222) kd_loss 0.8553 (0.8218) lr 1.9511e-03 eta 0:23:50
epoch [7/50] batch [200/319] time 0.111 (0.103) data 0.000 (0.003) loss 2.6770 (2.3053) ce_loss 1.4248 (1.1912) teacher_loss 1.3976 (1.0734) loss_zs_kd 0.9987 (0.7994) loss_oracle 0.8431 (0.8176) acc 50.0000 (55.0469) kd_loss 0.8578 (0.8231) lr 1.9511e-03 eta 0:23:43
epoch [7/50] batch [220/319] time 0.117 (0.102) data 0.000 (0.003) loss 2.4636 (2.2990) ce_loss 1.1104 (1.1860) teacher_loss 1.1962 (1.0656) loss_zs_kd 0.9627 (0.8087) loss_oracle 0.8512 (0.8183) acc 59.3750 (55.3977) kd_loss 0.8418 (0.8242) lr 1.9511e-03 eta 0:23:36
epoch [7/50] batch [240/319] time 0.098 (0.103) data 0.000 (0.003) loss 2.5331 (2.2993) ce_loss 1.2051 (1.1865) teacher_loss 1.3008 (1.0659) loss_zs_kd 0.8685 (0.8207) loss_oracle 0.8258 (0.8183) acc 53.1250 (55.3385) kd_loss 0.8194 (0.8243) lr 1.9511e-03 eta 0:23:35
epoch [7/50] batch [260/319] time 0.104 (0.102) data 0.000 (0.002) loss 2.2275 (2.3022) ce_loss 0.9980 (1.1865) teacher_loss 0.9911 (1.0699) loss_zs_kd 0.7461 (0.8169) loss_oracle 0.8137 (0.8179) acc 65.6250 (55.2644) kd_loss 0.8296 (0.8233) lr 1.9511e-03 eta 0:23:25
epoch [7/50] batch [280/319] time 0.093 (0.102) data 0.000 (0.002) loss 2.2144 (2.3038) ce_loss 1.1143 (1.1861) teacher_loss 0.9861 (1.0720) loss_zs_kd 0.9522 (0.8155) loss_oracle 0.8228 (0.8182) acc 59.3750 (55.3906) kd_loss 0.8170 (0.8226) lr 1.9511e-03 eta 0:23:23
epoch [7/50] batch [300/319] time 0.109 (0.102) data 0.000 (0.002) loss 2.2526 (2.3023) ce_loss 1.2793 (1.1836) teacher_loss 1.0246 (1.0713) loss_zs_kd 0.8720 (0.8128) loss_oracle 0.8289 (0.8180) acc 43.7500 (55.4062) kd_loss 0.8136 (0.8219) lr 1.9511e-03 eta 0:23:22
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,741
* accuracy: 62.6%
* error: 37.4%
* macro_f1: 54.3%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,963
* accuracy: 51.0%
* error: 49.0%
* macro_f1: 21.2%
******* Domain 2 best val acc:      62.6%, epoch: 7 *******
******* Domain 2 best val test acc: 51.0%, epoch: 7 *******
******* Domain 2 best test acc:     53.2%, epoch: 4 *******
epoch [8/50] batch [20/319] time 0.095 (0.148) data 0.000 (0.029) loss 2.4787 (2.3817) ce_loss 1.3975 (1.2257) teacher_loss 1.1942 (1.1386) loss_zs_kd 0.7658 (0.7232) loss_oracle 0.8316 (0.8231) acc 43.7500 (54.5312) kd_loss 0.8687 (0.8316) lr 1.9298e-03 eta 0:33:46
epoch [8/50] batch [40/319] time 0.110 (0.129) data 0.000 (0.015) loss 2.0591 (2.3343) ce_loss 1.0195 (1.1869) teacher_loss 0.8232 (1.0881) loss_zs_kd 0.8730 (0.7930) loss_oracle 0.8477 (0.8292) acc 56.2500 (55.2344) kd_loss 0.8120 (0.8316) lr 1.9298e-03 eta 0:29:25
epoch [8/50] batch [60/319] time 0.097 (0.122) data 0.001 (0.010) loss 2.2516 (2.3193) ce_loss 1.2275 (1.1810) teacher_loss 1.0489 (1.0774) loss_zs_kd 0.7718 (0.7940) loss_oracle 0.7791 (0.8274) acc 62.5000 (55.2604) kd_loss 0.8132 (0.8283) lr 1.9298e-03 eta 0:27:52
epoch [8/50] batch [80/319] time 0.078 (0.120) data 0.000 (0.007) loss 2.2891 (2.3014) ce_loss 1.1758 (1.1696) teacher_loss 1.0532 (1.0645) loss_zs_kd 0.6618 (0.7801) loss_oracle 0.8362 (0.8248) acc 46.8750 (55.2734) kd_loss 0.8178 (0.8244) lr 1.9298e-03 eta 0:27:17
epoch [8/50] batch [100/319] time 0.100 (0.115) data 0.000 (0.006) loss 2.1322 (2.3087) ce_loss 0.9751 (1.1736) teacher_loss 0.9066 (1.0755) loss_zs_kd 0.8122 (0.7800) loss_oracle 0.8637 (0.8264) acc 62.5000 (55.1562) kd_loss 0.7938 (0.8199) lr 1.9298e-03 eta 0:26:12
epoch [8/50] batch [120/319] time 0.112 (0.113) data 0.000 (0.005) loss 2.5329 (2.3045) ce_loss 1.3037 (1.1631) teacher_loss 1.2938 (1.0714) loss_zs_kd 0.9034 (0.7789) loss_oracle 0.8199 (0.8261) acc 62.5000 (55.6510) kd_loss 0.8292 (0.8200) lr 1.9298e-03 eta 0:25:39
epoch [8/50] batch [140/319] time 0.097 (0.112) data 0.000 (0.004) loss 2.3457 (2.3117) ce_loss 1.0869 (1.1647) teacher_loss 1.1233 (1.0807) loss_zs_kd 0.9831 (0.7739) loss_oracle 0.8447 (0.8257) acc 59.3750 (55.6473) kd_loss 0.8000 (0.8181) lr 1.9298e-03 eta 0:25:14
epoch [8/50] batch [160/319] time 0.115 (0.111) data 0.000 (0.004) loss 2.4829 (2.3115) ce_loss 1.2490 (1.1664) teacher_loss 1.1670 (1.0841) loss_zs_kd 0.6883 (0.7736) loss_oracle 0.8378 (0.8247) acc 59.3750 (55.8008) kd_loss 0.8970 (0.8151) lr 1.9298e-03 eta 0:25:01
epoch [8/50] batch [180/319] time 0.103 (0.110) data 0.000 (0.003) loss 2.4320 (2.3101) ce_loss 1.2861 (1.1681) teacher_loss 1.3403 (1.0853) loss_zs_kd 0.7406 (0.7835) loss_oracle 0.7534 (0.8234) acc 50.0000 (56.0069) kd_loss 0.7149 (0.8131) lr 1.9298e-03 eta 0:24:46
epoch [8/50] batch [200/319] time 0.107 (0.110) data 0.000 (0.003) loss 2.1920 (2.3040) ce_loss 1.1689 (1.1643) teacher_loss 1.0084 (1.0808) loss_zs_kd 1.0248 (0.7896) loss_oracle 0.8250 (0.8219) acc 56.2500 (56.0156) kd_loss 0.7711 (0.8123) lr 1.9298e-03 eta 0:24:40
epoch [8/50] batch [220/319] time 0.097 (0.109) data 0.000 (0.003) loss 2.0779 (2.3013) ce_loss 0.8975 (1.1645) teacher_loss 0.8761 (1.0778) loss_zs_kd 0.8812 (0.7929) loss_oracle 0.8012 (0.8212) acc 62.5000 (55.9517) kd_loss 0.8012 (0.8129) lr 1.9298e-03 eta 0:24:31
epoch [8/50] batch [240/319] time 0.096 (0.109) data 0.000 (0.003) loss 2.6369 (2.2922) ce_loss 1.3877 (1.1624) teacher_loss 1.4073 (1.0696) loss_zs_kd 0.8195 (0.7970) loss_oracle 0.8323 (0.8214) acc 53.1250 (56.0417) kd_loss 0.8134 (0.8120) lr 1.9298e-03 eta 0:24:23
epoch [8/50] batch [260/319] time 0.107 (0.108) data 0.000 (0.003) loss 2.5476 (2.2886) ce_loss 1.4541 (1.1624) teacher_loss 1.3033 (1.0660) loss_zs_kd 0.8667 (0.8012) loss_oracle 0.8294 (0.8215) acc 43.7500 (56.0216) kd_loss 0.8297 (0.8118) lr 1.9298e-03 eta 0:24:15
epoch [8/50] batch [280/319] time 0.105 (0.108) data 0.000 (0.002) loss 2.5404 (2.2836) ce_loss 1.2686 (1.1599) teacher_loss 1.3489 (1.0611) loss_zs_kd 0.7603 (0.8024) loss_oracle 0.7645 (0.8206) acc 43.7500 (55.8817) kd_loss 0.8092 (0.8122) lr 1.9298e-03 eta 0:24:09
epoch [8/50] batch [300/319] time 0.103 (0.108) data 0.000 (0.002) loss 2.5714 (2.2905) ce_loss 1.4873 (1.1644) teacher_loss 1.3162 (1.0673) loss_zs_kd 0.7211 (0.8050) loss_oracle 0.8711 (0.8208) acc 50.0000 (55.7917) kd_loss 0.8196 (0.8129) lr 1.9298e-03 eta 0:24:05
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,534
* accuracy: 57.9%
* error: 42.1%
* macro_f1: 51.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,359
* accuracy: 55.0%
* error: 45.0%
* macro_f1: 21.8%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      62.6%, epoch: 7 *******
******* Domain 2 best val test acc: 51.0%, epoch: 7 *******
******* Domain 2 best test acc:     55.0%, epoch: 8 *******
epoch [9/50] batch [20/319] time 0.070 (0.129) data 0.000 (0.026) loss 2.1124 (2.1943) ce_loss 1.0430 (1.1251) teacher_loss 0.8763 (0.9659) loss_zs_kd 0.9097 (0.9453) loss_oracle 0.8274 (0.8159) acc 56.2500 (56.0938) kd_loss 0.8224 (0.8204) lr 1.9048e-03 eta 0:28:44
epoch [9/50] batch [40/319] time 0.075 (0.121) data 0.000 (0.013) loss 2.1165 (2.2073) ce_loss 1.1211 (1.1011) teacher_loss 0.9000 (0.9780) loss_zs_kd 0.9440 (0.9358) loss_oracle 0.8391 (0.8214) acc 56.2500 (58.2031) kd_loss 0.7969 (0.8187) lr 1.9048e-03 eta 0:26:49
epoch [9/50] batch [60/319] time 0.162 (0.117) data 0.000 (0.009) loss 2.4111 (2.2398) ce_loss 1.2920 (1.1234) teacher_loss 1.1586 (1.0100) loss_zs_kd 0.8408 (0.9055) loss_oracle 0.8390 (0.8209) acc 46.8750 (57.0312) kd_loss 0.8330 (0.8193) lr 1.9048e-03 eta 0:26:03
epoch [9/50] batch [80/319] time 0.073 (0.114) data 0.000 (0.007) loss 2.3087 (2.2511) ce_loss 1.1953 (1.1408) teacher_loss 1.0777 (1.0232) loss_zs_kd 0.8345 (0.9094) loss_oracle 0.8222 (0.8226) acc 59.3750 (56.6406) kd_loss 0.8199 (0.8167) lr 1.9048e-03 eta 0:25:24
epoch [9/50] batch [100/319] time 0.096 (0.110) data 0.000 (0.005) loss 2.3442 (2.2567) ce_loss 1.2764 (1.1428) teacher_loss 1.1636 (1.0291) loss_zs_kd 0.6662 (0.8808) loss_oracle 0.8122 (0.8241) acc 50.0000 (56.7500) kd_loss 0.7745 (0.8156) lr 1.9048e-03 eta 0:24:22
epoch [9/50] batch [120/319] time 0.093 (0.108) data 0.000 (0.005) loss 2.3184 (2.2670) ce_loss 1.1953 (1.1542) teacher_loss 1.0511 (1.0432) loss_zs_kd 0.6312 (0.8549) loss_oracle 0.8128 (0.8223) acc 56.2500 (56.5365) kd_loss 0.8609 (0.8127) lr 1.9048e-03 eta 0:23:54
epoch [9/50] batch [140/319] time 0.103 (0.107) data 0.000 (0.004) loss 2.7834 (2.2783) ce_loss 1.4805 (1.1591) teacher_loss 1.5493 (1.0592) loss_zs_kd 0.7318 (0.8397) loss_oracle 0.8284 (0.8199) acc 37.5000 (55.9152) kd_loss 0.8198 (0.8092) lr 1.9048e-03 eta 0:23:32
epoch [9/50] batch [160/319] time 0.103 (0.106) data 0.000 (0.003) loss 2.3064 (2.2750) ce_loss 1.1396 (1.1521) teacher_loss 1.0582 (1.0553) loss_zs_kd 0.8212 (0.8329) loss_oracle 0.8140 (0.8205) acc 56.2500 (56.3672) kd_loss 0.8412 (0.8095) lr 1.9048e-03 eta 0:23:25
epoch [9/50] batch [180/319] time 0.110 (0.105) data 0.000 (0.003) loss 1.9868 (2.2652) ce_loss 1.1211 (1.1453) teacher_loss 0.7908 (1.0454) loss_zs_kd 0.9951 (0.8379) loss_oracle 0.8001 (0.8207) acc 59.3750 (56.5799) kd_loss 0.7960 (0.8094) lr 1.9048e-03 eta 0:23:12
epoch [9/50] batch [200/319] time 0.109 (0.105) data 0.000 (0.003) loss 2.1604 (2.2638) ce_loss 1.0957 (1.1468) teacher_loss 0.9317 (1.0441) loss_zs_kd 0.8174 (0.8459) loss_oracle 0.8022 (0.8204) acc 59.3750 (56.6250) kd_loss 0.8277 (0.8095) lr 1.9048e-03 eta 0:23:05
epoch [9/50] batch [220/319] time 0.108 (0.105) data 0.000 (0.003) loss 2.0718 (2.2582) ce_loss 1.1826 (1.1457) teacher_loss 0.8207 (1.0369) loss_zs_kd 0.8386 (0.8470) loss_oracle 0.8145 (0.8211) acc 37.5000 (56.5341) kd_loss 0.8438 (0.8107) lr 1.9048e-03 eta 0:23:01
epoch [9/50] batch [240/319] time 0.100 (0.105) data 0.000 (0.002) loss 2.3081 (2.2613) ce_loss 1.4189 (1.1495) teacher_loss 1.0927 (1.0388) loss_zs_kd 1.1154 (0.8542) loss_oracle 0.8298 (0.8223) acc 40.6250 (56.3932) kd_loss 0.8005 (0.8113) lr 1.9048e-03 eta 0:22:56
epoch [9/50] batch [260/319] time 0.099 (0.105) data 0.000 (0.002) loss 2.2959 (2.2614) ce_loss 1.1455 (1.1510) teacher_loss 1.0616 (1.0387) loss_zs_kd 0.8300 (0.8617) loss_oracle 0.8320 (0.8223) acc 53.1250 (56.1178) kd_loss 0.8182 (0.8116) lr 1.9048e-03 eta 0:22:59
epoch [9/50] batch [280/319] time 0.104 (0.105) data 0.000 (0.002) loss 2.2060 (2.2685) ce_loss 1.0605 (1.1582) teacher_loss 0.9525 (1.0454) loss_zs_kd 1.0350 (0.8664) loss_oracle 0.8368 (0.8227) acc 65.6250 (55.9263) kd_loss 0.8351 (0.8118) lr 1.9048e-03 eta 0:22:54
epoch [9/50] batch [300/319] time 0.103 (0.105) data 0.000 (0.002) loss 2.3107 (2.2688) ce_loss 1.3115 (1.1582) teacher_loss 1.1391 (1.0451) loss_zs_kd 0.8319 (0.8683) loss_oracle 0.7781 (0.8232) acc 56.2500 (55.9375) kd_loss 0.7825 (0.8121) lr 1.9048e-03 eta 0:22:49
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,697
* accuracy: 61.6%
* error: 38.4%
* macro_f1: 52.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,463
* accuracy: 56.1%
* error: 43.9%
* macro_f1: 21.8%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      62.6%, epoch: 7 *******
******* Domain 2 best val test acc: 51.0%, epoch: 7 *******
******* Domain 2 best test acc:     56.1%, epoch: 9 *******
epoch [10/50] batch [20/319] time 0.166 (0.152) data 0.000 (0.028) loss 2.4277 (2.3369) ce_loss 1.3379 (1.1957) teacher_loss 1.2424 (1.1096) loss_zs_kd 0.7892 (0.7713) loss_oracle 0.8236 (0.8228) acc 40.6250 (53.9062) kd_loss 0.7735 (0.8159) lr 1.8763e-03 eta 0:33:09
epoch [10/50] batch [40/319] time 0.072 (0.134) data 0.000 (0.014) loss 2.4687 (2.3284) ce_loss 1.1777 (1.1716) teacher_loss 1.2012 (1.0988) loss_zs_kd 0.6572 (0.7355) loss_oracle 0.8414 (0.8205) acc 59.3750 (54.6094) kd_loss 0.8468 (0.8194) lr 1.8763e-03 eta 0:29:02
epoch [10/50] batch [60/319] time 0.102 (0.120) data 0.000 (0.010) loss 2.5606 (2.3136) ce_loss 1.3887 (1.1583) teacher_loss 1.3976 (1.0868) loss_zs_kd 0.6413 (0.7128) loss_oracle 0.7980 (0.8176) acc 43.7500 (55.1042) kd_loss 0.7640 (0.8180) lr 1.8763e-03 eta 0:26:02
epoch [10/50] batch [80/319] time 0.098 (0.116) data 0.000 (0.007) loss 1.9654 (2.3138) ce_loss 0.9321 (1.1626) teacher_loss 0.7960 (1.0909) loss_zs_kd 0.6324 (0.6958) loss_oracle 0.8258 (0.8189) acc 68.7500 (55.1172) kd_loss 0.7565 (0.8135) lr 1.8763e-03 eta 0:25:08
epoch [10/50] batch [100/319] time 0.095 (0.114) data 0.000 (0.006) loss 2.1043 (2.3233) ce_loss 0.9253 (1.1704) teacher_loss 0.8475 (1.1019) loss_zs_kd 0.5477 (0.6901) loss_oracle 0.8617 (0.8171) acc 71.8750 (55.0000) kd_loss 0.8259 (0.8128) lr 1.8763e-03 eta 0:24:34
epoch [10/50] batch [120/319] time 0.099 (0.111) data 0.000 (0.005) loss 2.3306 (2.3207) ce_loss 1.1523 (1.1666) teacher_loss 1.0824 (1.0988) loss_zs_kd 0.6524 (0.6868) loss_oracle 0.8340 (0.8177) acc 56.2500 (55.2865) kd_loss 0.8312 (0.8130) lr 1.8763e-03 eta 0:23:58
epoch [10/50] batch [140/319] time 0.108 (0.110) data 0.000 (0.004) loss 2.1996 (2.3079) ce_loss 1.1465 (1.1586) teacher_loss 1.0332 (1.0883) loss_zs_kd 0.6274 (0.6842) loss_oracle 0.8113 (0.8172) acc 43.7500 (55.5134) kd_loss 0.7607 (0.8109) lr 1.8763e-03 eta 0:23:44
epoch [10/50] batch [160/319] time 0.103 (0.109) data 0.000 (0.004) loss 2.2645 (2.3035) ce_loss 1.1562 (1.1524) teacher_loss 1.0955 (1.0844) loss_zs_kd 0.8477 (0.6881) loss_oracle 0.8145 (0.8176) acc 50.0000 (56.0938) kd_loss 0.7617 (0.8103) lr 1.8763e-03 eta 0:23:31
epoch [10/50] batch [180/319] time 0.095 (0.108) data 0.000 (0.003) loss 2.3144 (2.3120) ce_loss 1.1807 (1.1586) teacher_loss 1.1080 (1.0921) loss_zs_kd 0.5626 (0.6946) loss_oracle 0.8469 (0.8191) acc 62.5000 (56.1458) kd_loss 0.7829 (0.8104) lr 1.8763e-03 eta 0:23:16
epoch [10/50] batch [200/319] time 0.110 (0.108) data 0.000 (0.003) loss 1.9959 (2.3098) ce_loss 0.8291 (1.1571) teacher_loss 0.8089 (1.0914) loss_zs_kd 0.6309 (0.6872) loss_oracle 0.8081 (0.8189) acc 71.8750 (56.1562) kd_loss 0.7830 (0.8090) lr 1.8763e-03 eta 0:23:04
epoch [10/50] batch [220/319] time 0.103 (0.107) data 0.000 (0.003) loss 2.0731 (2.3074) ce_loss 0.9858 (1.1569) teacher_loss 0.8452 (1.0884) loss_zs_kd 0.7725 (0.6926) loss_oracle 0.8301 (0.8182) acc 59.3750 (56.3494) kd_loss 0.8129 (0.8099) lr 1.8763e-03 eta 0:22:57
epoch [10/50] batch [240/319] time 0.096 (0.107) data 0.000 (0.003) loss 2.3901 (2.3097) ce_loss 1.0664 (1.1600) teacher_loss 1.1483 (1.0901) loss_zs_kd 0.8743 (0.7043) loss_oracle 0.8450 (0.8188) acc 62.5000 (56.2109) kd_loss 0.8193 (0.8102) lr 1.8763e-03 eta 0:22:51
epoch [10/50] batch [260/319] time 0.102 (0.107) data 0.000 (0.002) loss 2.3487 (2.3058) ce_loss 1.0986 (1.1612) teacher_loss 1.0875 (1.0862) loss_zs_kd 1.0108 (0.7140) loss_oracle 0.8521 (0.8190) acc 59.3750 (56.0817) kd_loss 0.8351 (0.8101) lr 1.8763e-03 eta 0:22:48
epoch [10/50] batch [280/319] time 0.102 (0.107) data 0.000 (0.002) loss 2.1891 (2.2979) ce_loss 1.1035 (1.1563) teacher_loss 0.9977 (1.0780) loss_zs_kd 0.8689 (0.7262) loss_oracle 0.8236 (0.8187) acc 53.1250 (56.1384) kd_loss 0.7796 (0.8105) lr 1.8763e-03 eta 0:22:43
epoch [10/50] batch [300/319] time 0.102 (0.106) data 0.000 (0.002) loss 2.2608 (2.2965) ce_loss 1.1895 (1.1557) teacher_loss 1.0569 (1.0768) loss_zs_kd 0.7962 (0.7339) loss_oracle 0.8505 (0.8188) acc 56.2500 (56.1146) kd_loss 0.7787 (0.8103) lr 1.8763e-03 eta 0:22:39
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,662
* accuracy: 60.8%
* error: 39.2%
* macro_f1: 53.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,307
* accuracy: 54.5%
* error: 45.5%
* macro_f1: 21.3%
******* Domain 2 best val acc:      62.6%, epoch: 7 *******
******* Domain 2 best val test acc: 51.0%, epoch: 7 *******
******* Domain 2 best test acc:     56.1%, epoch: 9 *******
epoch [11/50] batch [20/319] time 0.078 (0.141) data 0.000 (0.036) loss 2.2187 (2.1681) ce_loss 1.0957 (1.0995) teacher_loss 0.9503 (0.9485) loss_zs_kd 0.7923 (0.7705) loss_oracle 0.8441 (0.8224) acc 53.1250 (57.8125) kd_loss 0.8463 (0.8085) lr 1.8443e-03 eta 0:29:58
epoch [11/50] batch [40/319] time 0.103 (0.118) data 0.000 (0.018) loss 2.0510 (2.1962) ce_loss 0.9849 (1.1080) teacher_loss 0.7890 (0.9675) loss_zs_kd 0.8103 (0.8239) loss_oracle 0.8574 (0.8268) acc 59.3750 (56.4062) kd_loss 0.8333 (0.8154) lr 1.8443e-03 eta 0:25:01
epoch [11/50] batch [60/319] time 0.095 (0.113) data 0.001 (0.012) loss 2.4235 (2.2012) ce_loss 1.2041 (1.1211) teacher_loss 1.1454 (0.9704) loss_zs_kd 1.0204 (0.8359) loss_oracle 0.8410 (0.8275) acc 56.2500 (56.5625) kd_loss 0.8576 (0.8171) lr 1.8443e-03 eta 0:23:55
epoch [11/50] batch [80/319] time 0.131 (0.111) data 0.000 (0.009) loss 2.4738 (2.2054) ce_loss 1.3428 (1.1281) teacher_loss 1.2638 (0.9717) loss_zs_kd 1.0546 (0.8498) loss_oracle 0.8254 (0.8285) acc 53.1250 (56.9141) kd_loss 0.7973 (0.8194) lr 1.8443e-03 eta 0:23:24
epoch [11/50] batch [100/319] time 0.101 (0.108) data 0.000 (0.007) loss 2.2348 (2.2146) ce_loss 1.1201 (1.1411) teacher_loss 0.9851 (0.9796) loss_zs_kd 0.8260 (0.8621) loss_oracle 0.8190 (0.8292) acc 59.3750 (56.4688) kd_loss 0.8402 (0.8203) lr 1.8443e-03 eta 0:22:52
epoch [11/50] batch [120/319] time 0.101 (0.108) data 0.000 (0.006) loss 2.2144 (2.2186) ce_loss 1.0693 (1.1459) teacher_loss 0.9936 (0.9839) loss_zs_kd 0.8787 (0.8684) loss_oracle 0.8638 (0.8300) acc 59.3750 (56.0156) kd_loss 0.7889 (0.8197) lr 1.8443e-03 eta 0:22:39
epoch [11/50] batch [140/319] time 0.107 (0.106) data 0.000 (0.005) loss 2.5866 (2.2146) ce_loss 1.3838 (1.1461) teacher_loss 1.3143 (0.9807) loss_zs_kd 1.0507 (0.8681) loss_oracle 0.8559 (0.8311) acc 43.7500 (56.4732) kd_loss 0.8443 (0.8183) lr 1.8443e-03 eta 0:22:20
epoch [11/50] batch [160/319] time 0.095 (0.106) data 0.000 (0.005) loss 1.8785 (2.2212) ce_loss 0.7959 (1.1518) teacher_loss 0.6819 (0.9886) loss_zs_kd 0.6796 (0.8603) loss_oracle 0.8208 (0.8312) acc 65.6250 (56.1328) kd_loss 0.7862 (0.8170) lr 1.8443e-03 eta 0:22:11
epoch [11/50] batch [180/319] time 0.107 (0.105) data 0.000 (0.004) loss 2.2037 (2.2249) ce_loss 1.2041 (1.1532) teacher_loss 1.0414 (0.9923) loss_zs_kd 0.5964 (0.8393) loss_oracle 0.7494 (0.8300) acc 50.0000 (55.9722) kd_loss 0.7877 (0.8176) lr 1.8443e-03 eta 0:22:05
epoch [11/50] batch [200/319] time 0.087 (0.105) data 0.000 (0.004) loss 2.1862 (2.2229) ce_loss 1.1514 (1.1518) teacher_loss 0.9131 (0.9901) loss_zs_kd 0.7492 (0.8274) loss_oracle 0.8197 (0.8284) acc 62.5000 (56.0781) kd_loss 0.8632 (0.8186) lr 1.8443e-03 eta 0:21:56
epoch [11/50] batch [220/319] time 0.106 (0.104) data 0.000 (0.004) loss 2.3750 (2.2206) ce_loss 1.3213 (1.1489) teacher_loss 1.1399 (0.9890) loss_zs_kd 0.6470 (0.8120) loss_oracle 0.8168 (0.8276) acc 50.0000 (56.1932) kd_loss 0.8267 (0.8178) lr 1.8443e-03 eta 0:21:39
epoch [11/50] batch [240/319] time 0.095 (0.103) data 0.000 (0.003) loss 2.1388 (2.2164) ce_loss 1.0840 (1.1422) teacher_loss 0.9770 (0.9863) loss_zs_kd 0.5776 (0.7980) loss_oracle 0.8133 (0.8279) acc 65.6250 (56.4714) kd_loss 0.7552 (0.8162) lr 1.8443e-03 eta 0:21:34
epoch [11/50] batch [260/319] time 0.104 (0.104) data 0.000 (0.003) loss 1.9378 (2.2161) ce_loss 1.1436 (1.1433) teacher_loss 0.7060 (0.9868) loss_zs_kd 0.8514 (0.7925) loss_oracle 0.8078 (0.8270) acc 43.7500 (56.2380) kd_loss 0.8278 (0.8157) lr 1.8443e-03 eta 0:21:33
epoch [11/50] batch [280/319] time 0.102 (0.103) data 0.000 (0.003) loss 2.3979 (2.2139) ce_loss 1.3379 (1.1400) teacher_loss 1.1105 (0.9844) loss_zs_kd 0.6785 (0.7871) loss_oracle 0.8500 (0.8258) acc 46.8750 (56.4062) kd_loss 0.8624 (0.8166) lr 1.8443e-03 eta 0:21:31
epoch [11/50] batch [300/319] time 0.101 (0.103) data 0.000 (0.003) loss 2.7640 (2.2180) ce_loss 1.7061 (1.1454) teacher_loss 1.5257 (0.9881) loss_zs_kd 0.7739 (0.7847) loss_oracle 0.8416 (0.8254) acc 43.7500 (56.1354) kd_loss 0.8176 (0.8172) lr 1.8443e-03 eta 0:21:25
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,639
* accuracy: 60.3%
* error: 39.7%
* macro_f1: 51.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,345
* accuracy: 54.9%
* error: 45.1%
* macro_f1: 22.1%
******* Domain 2 best val acc:      62.6%, epoch: 7 *******
******* Domain 2 best val test acc: 51.0%, epoch: 7 *******
******* Domain 2 best test acc:     56.1%, epoch: 9 *******
epoch [12/50] batch [20/319] time 0.086 (0.139) data 0.000 (0.035) loss 2.2138 (2.2279) ce_loss 1.0703 (1.1561) teacher_loss 0.9339 (0.9864) loss_zs_kd 0.6423 (0.8288) loss_oracle 0.8257 (0.8267) acc 59.3750 (55.6250) kd_loss 0.8671 (0.8281) lr 1.8090e-03 eta 0:28:49
epoch [12/50] batch [40/319] time 0.100 (0.120) data 0.000 (0.018) loss 1.8897 (2.2279) ce_loss 0.9224 (1.1682) teacher_loss 0.6798 (0.9892) loss_zs_kd 0.6882 (0.7410) loss_oracle 0.7858 (0.8263) acc 62.5000 (54.1406) kd_loss 0.8170 (0.8255) lr 1.8090e-03 eta 0:24:44
epoch [12/50] batch [60/319] time 0.100 (0.114) data 0.001 (0.012) loss 2.4071 (2.2544) ce_loss 1.3623 (1.1829) teacher_loss 1.1555 (1.0216) loss_zs_kd 0.5603 (0.7273) loss_oracle 0.8186 (0.8280) acc 50.0000 (53.9062) kd_loss 0.8423 (0.8187) lr 1.8090e-03 eta 0:23:33
epoch [12/50] batch [80/319] time 0.102 (0.111) data 0.000 (0.009) loss 2.1627 (2.2467) ce_loss 0.9780 (1.1728) teacher_loss 0.8964 (1.0162) loss_zs_kd 0.5676 (0.7128) loss_oracle 0.8477 (0.8262) acc 65.6250 (54.3750) kd_loss 0.8425 (0.8174) lr 1.8090e-03 eta 0:22:56
epoch [12/50] batch [100/319] time 0.098 (0.110) data 0.000 (0.007) loss 2.1474 (2.2532) ce_loss 1.2568 (1.1885) teacher_loss 0.8993 (1.0249) loss_zs_kd 0.7097 (0.6977) loss_oracle 0.8280 (0.8258) acc 53.1250 (54.0625) kd_loss 0.8342 (0.8153) lr 1.8090e-03 eta 0:22:34
epoch [12/50] batch [120/319] time 0.096 (0.108) data 0.000 (0.006) loss 2.2214 (2.2580) ce_loss 1.2686 (1.1908) teacher_loss 1.0198 (1.0300) loss_zs_kd 0.7039 (0.6953) loss_oracle 0.8251 (0.8255) acc 50.0000 (54.2969) kd_loss 0.7891 (0.8153) lr 1.8090e-03 eta 0:22:10
epoch [12/50] batch [140/319] time 0.116 (0.107) data 0.000 (0.005) loss 2.5063 (2.2513) ce_loss 1.2246 (1.1758) teacher_loss 1.2394 (1.0243) loss_zs_kd 0.8678 (0.7096) loss_oracle 0.8236 (0.8259) acc 62.5000 (55.2902) kd_loss 0.8551 (0.8141) lr 1.8090e-03 eta 0:21:57
epoch [12/50] batch [160/319] time 0.108 (0.107) data 0.000 (0.005) loss 2.2947 (2.2516) ce_loss 1.2471 (1.1696) teacher_loss 1.1010 (1.0242) loss_zs_kd 0.8324 (0.7173) loss_oracle 0.7933 (0.8257) acc 46.8750 (55.6836) kd_loss 0.7971 (0.8146) lr 1.8090e-03 eta 0:21:50
epoch [12/50] batch [180/319] time 0.100 (0.106) data 0.000 (0.004) loss 2.1793 (2.2515) ce_loss 1.0801 (1.1670) teacher_loss 0.9529 (1.0245) loss_zs_kd 0.7626 (0.7276) loss_oracle 0.8365 (0.8254) acc 59.3750 (56.0069) kd_loss 0.8082 (0.8144) lr 1.8090e-03 eta 0:21:44
epoch [12/50] batch [200/319] time 0.097 (0.106) data 0.000 (0.004) loss 2.3615 (2.2515) ce_loss 1.1719 (1.1618) teacher_loss 1.1275 (1.0234) loss_zs_kd 0.8056 (0.7341) loss_oracle 0.8264 (0.8253) acc 40.6250 (56.0469) kd_loss 0.8208 (0.8155) lr 1.8090e-03 eta 0:21:36
epoch [12/50] batch [220/319] time 0.111 (0.105) data 0.000 (0.003) loss 2.0600 (2.2454) ce_loss 0.9536 (1.1569) teacher_loss 0.8301 (1.0176) loss_zs_kd 0.7382 (0.7536) loss_oracle 0.8359 (0.8248) acc 56.2500 (56.2074) kd_loss 0.8120 (0.8153) lr 1.8090e-03 eta 0:21:28
epoch [12/50] batch [240/319] time 0.106 (0.105) data 0.000 (0.003) loss 2.1377 (2.2436) ce_loss 1.0781 (1.1537) teacher_loss 0.8459 (1.0156) loss_zs_kd 0.8934 (0.7570) loss_oracle 0.8416 (0.8257) acc 59.3750 (56.3672) kd_loss 0.8710 (0.8151) lr 1.8090e-03 eta 0:21:22
epoch [12/50] batch [260/319] time 0.099 (0.105) data 0.000 (0.003) loss 2.0976 (2.2409) ce_loss 1.0586 (1.1474) teacher_loss 0.8892 (1.0127) loss_zs_kd 0.6145 (0.7521) loss_oracle 0.8130 (0.8261) acc 62.5000 (56.6466) kd_loss 0.8019 (0.8151) lr 1.8090e-03 eta 0:21:17
epoch [12/50] batch [280/319] time 0.099 (0.104) data 0.000 (0.003) loss 1.9787 (2.2422) ce_loss 0.9097 (1.1454) teacher_loss 0.7786 (1.0131) loss_zs_kd 0.6244 (0.7460) loss_oracle 0.7914 (0.8269) acc 59.3750 (56.6295) kd_loss 0.8043 (0.8156) lr 1.8090e-03 eta 0:21:10
epoch [12/50] batch [300/319] time 0.103 (0.104) data 0.000 (0.003) loss 2.3731 (2.2399) ce_loss 1.2256 (1.1406) teacher_loss 1.0865 (1.0107) loss_zs_kd 0.6595 (0.7453) loss_oracle 0.8385 (0.8272) acc 53.1250 (56.7292) kd_loss 0.8674 (0.8157) lr 1.8090e-03 eta 0:21:07
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,680
* accuracy: 61.2%
* error: 38.8%
* macro_f1: 53.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,275
* accuracy: 54.2%
* error: 45.8%
* macro_f1: 21.9%
******* Domain 2 best val acc:      62.6%, epoch: 7 *******
******* Domain 2 best val test acc: 51.0%, epoch: 7 *******
******* Domain 2 best test acc:     56.1%, epoch: 9 *******
epoch [13/50] batch [20/319] time 0.111 (0.136) data 0.000 (0.035) loss 2.2135 (2.2758) ce_loss 1.1328 (1.1904) teacher_loss 0.9949 (1.0572) loss_zs_kd 0.9378 (0.8225) loss_oracle 0.8124 (0.8216) acc 56.2500 (55.4688) kd_loss 0.8124 (0.8078) lr 1.7705e-03 eta 0:27:26
epoch [13/50] batch [40/319] time 0.089 (0.119) data 0.000 (0.018) loss 2.6101 (2.2352) ce_loss 1.4531 (1.1158) teacher_loss 1.3430 (1.0134) loss_zs_kd 0.8605 (0.8177) loss_oracle 0.8442 (0.8270) acc 50.0000 (57.7344) kd_loss 0.8450 (0.8083) lr 1.7705e-03 eta 0:23:57
epoch [13/50] batch [60/319] time 0.100 (0.113) data 0.000 (0.012) loss 2.7692 (2.2599) ce_loss 1.5605 (1.1323) teacher_loss 1.5708 (1.0379) loss_zs_kd 0.7915 (0.8129) loss_oracle 0.7794 (0.8253) acc 46.8750 (57.5521) kd_loss 0.8087 (0.8094) lr 1.7705e-03 eta 0:22:37
epoch [13/50] batch [80/319] time 0.095 (0.109) data 0.000 (0.009) loss 2.0292 (2.2798) ce_loss 0.8687 (1.1410) teacher_loss 0.7881 (1.0553) loss_zs_kd 0.6233 (0.7878) loss_oracle 0.8494 (0.8238) acc 62.5000 (56.7188) kd_loss 0.8164 (0.8126) lr 1.7705e-03 eta 0:21:48
epoch [13/50] batch [100/319] time 0.108 (0.108) data 0.000 (0.007) loss 2.3081 (2.2744) ce_loss 1.2227 (1.1394) teacher_loss 1.1000 (1.0495) loss_zs_kd 0.7854 (0.7870) loss_oracle 0.7845 (0.8222) acc 46.8750 (56.3125) kd_loss 0.8158 (0.8138) lr 1.7705e-03 eta 0:21:34
epoch [13/50] batch [120/319] time 0.103 (0.108) data 0.000 (0.006) loss 2.2812 (2.2651) ce_loss 1.1465 (1.1326) teacher_loss 1.0333 (1.0415) loss_zs_kd 0.7140 (0.7925) loss_oracle 0.8117 (0.8202) acc 50.0000 (56.5625) kd_loss 0.8421 (0.8135) lr 1.7705e-03 eta 0:21:30
epoch [13/50] batch [140/319] time 0.101 (0.106) data 0.000 (0.005) loss 2.5449 (2.2637) ce_loss 1.3428 (1.1325) teacher_loss 1.2889 (1.0394) loss_zs_kd 0.7955 (0.7883) loss_oracle 0.8314 (0.8215) acc 56.2500 (56.8080) kd_loss 0.8403 (0.8136) lr 1.7705e-03 eta 0:21:12
epoch [13/50] batch [160/319] time 0.107 (0.106) data 0.000 (0.005) loss 2.3156 (2.2545) ce_loss 1.1992 (1.1299) teacher_loss 1.0862 (1.0300) loss_zs_kd 0.9163 (0.7885) loss_oracle 0.8185 (0.8218) acc 53.1250 (56.6602) kd_loss 0.8202 (0.8135) lr 1.7705e-03 eta 0:21:04
epoch [13/50] batch [180/319] time 0.084 (0.105) data 0.000 (0.004) loss 2.1702 (2.2519) ce_loss 1.0352 (1.1352) teacher_loss 0.9516 (1.0267) loss_zs_kd 0.8975 (0.8002) loss_oracle 0.8404 (0.8225) acc 68.7500 (56.6493) kd_loss 0.7984 (0.8139) lr 1.7705e-03 eta 0:20:56
epoch [13/50] batch [200/319] time 0.114 (0.105) data 0.000 (0.004) loss 2.2944 (2.2492) ce_loss 1.2529 (1.1409) teacher_loss 1.0653 (1.0234) loss_zs_kd 0.7812 (0.8040) loss_oracle 0.8278 (0.8233) acc 56.2500 (56.5625) kd_loss 0.8153 (0.8141) lr 1.7705e-03 eta 0:20:46
epoch [13/50] batch [220/319] time 0.104 (0.104) data 0.000 (0.003) loss 2.2513 (2.2399) ce_loss 1.2549 (1.1413) teacher_loss 0.9979 (1.0127) loss_zs_kd 1.0023 (0.8080) loss_oracle 0.8635 (0.8246) acc 53.1250 (56.4205) kd_loss 0.8217 (0.8149) lr 1.7705e-03 eta 0:20:42
epoch [13/50] batch [240/319] time 0.096 (0.105) data 0.000 (0.003) loss 2.0568 (2.2351) ce_loss 0.9019 (1.1427) teacher_loss 0.7954 (1.0067) loss_zs_kd 0.9835 (0.8170) loss_oracle 0.8067 (0.8247) acc 71.8750 (56.3411) kd_loss 0.8581 (0.8161) lr 1.7705e-03 eta 0:20:45
epoch [13/50] batch [260/319] time 0.109 (0.105) data 0.000 (0.003) loss 2.2420 (2.2294) ce_loss 1.1982 (1.1468) teacher_loss 0.9679 (0.9986) loss_zs_kd 0.8991 (0.8280) loss_oracle 0.8507 (0.8258) acc 53.1250 (56.2139) kd_loss 0.8488 (0.8179) lr 1.7705e-03 eta 0:20:42
epoch [13/50] batch [280/319] time 0.110 (0.105) data 0.000 (0.003) loss 2.1331 (2.2254) ce_loss 1.0928 (1.1476) teacher_loss 0.8920 (0.9927) loss_zs_kd 0.9367 (0.8283) loss_oracle 0.8362 (0.8263) acc 65.6250 (56.1496) kd_loss 0.8230 (0.8196) lr 1.7705e-03 eta 0:20:42
epoch [13/50] batch [300/319] time 0.112 (0.105) data 0.000 (0.003) loss 2.2505 (2.2214) ce_loss 1.1621 (1.1458) teacher_loss 0.9966 (0.9875) loss_zs_kd 0.7865 (0.8271) loss_oracle 0.8496 (0.8262) acc 56.2500 (56.2188) kd_loss 0.8291 (0.8208) lr 1.7705e-03 eta 0:20:39
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,620
* accuracy: 59.8%
* error: 40.2%
* macro_f1: 51.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,474
* accuracy: 56.2%
* error: 43.8%
* macro_f1: 22.3%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      62.6%, epoch: 7 *******
******* Domain 2 best val test acc: 51.0%, epoch: 7 *******
******* Domain 2 best test acc:     56.2%, epoch: 13 *******
epoch [14/50] batch [20/319] time 0.084 (0.135) data 0.000 (0.033) loss 2.1471 (2.2013) ce_loss 1.0146 (1.1276) teacher_loss 0.8518 (0.9474) loss_zs_kd 1.0608 (0.8502) loss_oracle 0.8535 (0.8290) acc 75.0000 (57.0312) kd_loss 0.8686 (0.8394) lr 1.7290e-03 eta 0:26:35
epoch [14/50] batch [40/319] time 0.085 (0.110) data 0.000 (0.016) loss 2.4963 (2.1722) ce_loss 1.0537 (1.1247) teacher_loss 1.2038 (0.9240) loss_zs_kd 0.9033 (0.9495) loss_oracle 0.8192 (0.8302) acc 68.7500 (57.8125) kd_loss 0.8830 (0.8331) lr 1.7290e-03 eta 0:21:36
epoch [14/50] batch [60/319] time 0.102 (0.108) data 0.001 (0.011) loss 2.0975 (2.2000) ce_loss 1.0312 (1.1443) teacher_loss 0.8810 (0.9557) loss_zs_kd 1.2810 (0.9743) loss_oracle 0.7985 (0.8288) acc 56.2500 (55.9375) kd_loss 0.8173 (0.8300) lr 1.7290e-03 eta 0:21:04
epoch [14/50] batch [80/319] time 0.102 (0.107) data 0.000 (0.008) loss 2.3311 (2.2125) ce_loss 1.3477 (1.1504) teacher_loss 1.0540 (0.9693) loss_zs_kd 0.9889 (0.9577) loss_oracle 0.8375 (0.8264) acc 43.7500 (55.2734) kd_loss 0.8584 (0.8300) lr 1.7290e-03 eta 0:20:59
epoch [14/50] batch [100/319] time 0.103 (0.107) data 0.000 (0.007) loss 1.8574 (2.2207) ce_loss 0.9209 (1.1555) teacher_loss 0.6227 (0.9781) loss_zs_kd 0.9711 (0.9622) loss_oracle 0.8089 (0.8244) acc 59.3750 (54.5000) kd_loss 0.8302 (0.8304) lr 1.7290e-03 eta 0:20:52
epoch [14/50] batch [120/319] time 0.097 (0.108) data 0.000 (0.006) loss 2.1048 (2.2272) ce_loss 1.0273 (1.1554) teacher_loss 0.8774 (0.9841) loss_zs_kd 1.0632 (0.9694) loss_oracle 0.7978 (0.8246) acc 59.3750 (54.4531) kd_loss 0.8285 (0.8308) lr 1.7290e-03 eta 0:20:56
epoch [14/50] batch [140/319] time 0.108 (0.107) data 0.000 (0.005) loss 2.5323 (2.2346) ce_loss 1.5273 (1.1561) teacher_loss 1.3024 (0.9935) loss_zs_kd 0.8578 (0.9635) loss_oracle 0.8285 (0.8229) acc 40.6250 (54.2188) kd_loss 0.8156 (0.8296) lr 1.7290e-03 eta 0:20:44
epoch [14/50] batch [160/319] time 0.104 (0.106) data 0.000 (0.004) loss 2.2660 (2.2456) ce_loss 1.2285 (1.1612) teacher_loss 1.0609 (1.0048) loss_zs_kd 0.7890 (0.9487) loss_oracle 0.7805 (0.8214) acc 50.0000 (54.3164) kd_loss 0.8148 (0.8301) lr 1.7290e-03 eta 0:20:38
epoch [14/50] batch [180/319] time 0.115 (0.106) data 0.000 (0.004) loss 2.2310 (2.2439) ce_loss 1.0859 (1.1582) teacher_loss 0.9796 (1.0025) loss_zs_kd 0.8335 (0.9404) loss_oracle 0.8398 (0.8217) acc 59.3750 (54.5833) kd_loss 0.8314 (0.8306) lr 1.7290e-03 eta 0:20:34
epoch [14/50] batch [200/319] time 0.072 (0.106) data 0.000 (0.004) loss 2.1038 (2.2399) ce_loss 1.0225 (1.1500) teacher_loss 0.8784 (0.9971) loss_zs_kd 0.8978 (0.9381) loss_oracle 0.8334 (0.8214) acc 68.7500 (55.2188) kd_loss 0.8087 (0.8320) lr 1.7290e-03 eta 0:20:25
epoch [14/50] batch [220/319] time 0.107 (0.105) data 0.000 (0.003) loss 2.2197 (2.2417) ce_loss 1.1025 (1.1501) teacher_loss 0.9629 (0.9995) loss_zs_kd 0.8293 (0.9341) loss_oracle 0.8555 (0.8215) acc 56.2500 (55.4119) kd_loss 0.8290 (0.8314) lr 1.7290e-03 eta 0:20:19
epoch [14/50] batch [240/319] time 0.099 (0.105) data 0.000 (0.003) loss 2.1952 (2.2427) ce_loss 1.0928 (1.1469) teacher_loss 0.9697 (1.0005) loss_zs_kd 0.8851 (0.9262) loss_oracle 0.8354 (0.8218) acc 62.5000 (55.5729) kd_loss 0.8079 (0.8312) lr 1.7290e-03 eta 0:20:15
epoch [14/50] batch [260/319] time 0.104 (0.105) data 0.000 (0.003) loss 2.0900 (2.2411) ce_loss 1.0010 (1.1433) teacher_loss 0.8518 (0.9998) loss_zs_kd 0.7210 (0.9168) loss_oracle 0.8411 (0.8223) acc 62.5000 (55.8173) kd_loss 0.8176 (0.8301) lr 1.7290e-03 eta 0:20:12
epoch [14/50] batch [280/319] time 0.104 (0.105) data 0.000 (0.003) loss 2.0852 (2.2359) ce_loss 1.0859 (1.1399) teacher_loss 0.8492 (0.9959) loss_zs_kd 0.8705 (0.9161) loss_oracle 0.8433 (0.8219) acc 53.1250 (56.0379) kd_loss 0.8143 (0.8290) lr 1.7290e-03 eta 0:20:09
epoch [14/50] batch [300/319] time 0.105 (0.105) data 0.000 (0.002) loss 2.3020 (2.2342) ce_loss 1.3125 (1.1405) teacher_loss 1.0524 (0.9939) loss_zs_kd 0.9021 (0.9131) loss_oracle 0.8449 (0.8222) acc 50.0000 (56.1875) kd_loss 0.8271 (0.8292) lr 1.7290e-03 eta 0:20:06
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,544
* accuracy: 58.1%
* error: 41.9%
* macro_f1: 51.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,210
* accuracy: 53.5%
* error: 46.5%
* macro_f1: 21.6%
******* Domain 2 best val acc:      62.6%, epoch: 7 *******
******* Domain 2 best val test acc: 51.0%, epoch: 7 *******
******* Domain 2 best test acc:     56.2%, epoch: 13 *******
epoch [15/50] batch [20/319] time 0.062 (0.126) data 0.000 (0.027) loss 2.6974 (2.3119) ce_loss 1.5498 (1.1768) teacher_loss 1.4462 (1.0678) loss_zs_kd 0.8566 (0.9323) loss_oracle 0.7911 (0.8275) acc 40.6250 (55.3125) kd_loss 0.8556 (0.8303) lr 1.6845e-03 eta 0:24:09
epoch [15/50] batch [40/319] time 0.058 (0.107) data 0.000 (0.014) loss 1.9450 (2.2478) ce_loss 0.9805 (1.1450) teacher_loss 0.7409 (1.0140) loss_zs_kd 0.8543 (0.9245) loss_oracle 0.8363 (0.8243) acc 59.3750 (56.0938) kd_loss 0.7860 (0.8216) lr 1.6845e-03 eta 0:20:27
epoch [15/50] batch [60/319] time 0.115 (0.100) data 0.000 (0.009) loss 2.1807 (2.2374) ce_loss 1.3076 (1.1444) teacher_loss 0.9864 (0.9998) loss_zs_kd 1.0513 (0.9348) loss_oracle 0.8212 (0.8220) acc 46.8750 (56.1979) kd_loss 0.7837 (0.8266) lr 1.6845e-03 eta 0:18:57
epoch [15/50] batch [80/319] time 0.112 (0.100) data 0.000 (0.007) loss 2.1167 (2.2414) ce_loss 1.0146 (1.1473) teacher_loss 0.9212 (1.0015) loss_zs_kd 0.9332 (0.9563) loss_oracle 0.8222 (0.8258) acc 56.2500 (55.9375) kd_loss 0.7843 (0.8271) lr 1.6845e-03 eta 0:19:02
epoch [15/50] batch [100/319] time 0.108 (0.101) data 0.000 (0.006) loss 2.1258 (2.2261) ce_loss 0.9937 (1.1407) teacher_loss 0.8755 (0.9865) loss_zs_kd 0.7576 (0.9481) loss_oracle 0.8196 (0.8260) acc 59.3750 (56.2812) kd_loss 0.8404 (0.8266) lr 1.6845e-03 eta 0:19:12
epoch [15/50] batch [120/319] time 0.102 (0.101) data 0.000 (0.005) loss 1.9663 (2.2205) ce_loss 0.9619 (1.1435) teacher_loss 0.7140 (0.9798) loss_zs_kd 0.9823 (0.9408) loss_oracle 0.8360 (0.8275) acc 68.7500 (56.1979) kd_loss 0.8343 (0.8269) lr 1.6845e-03 eta 0:19:04
epoch [15/50] batch [140/319] time 0.098 (0.100) data 0.000 (0.004) loss 2.2971 (2.2092) ce_loss 1.2305 (1.1440) teacher_loss 1.0053 (0.9686) loss_zs_kd 1.2575 (0.9440) loss_oracle 0.8381 (0.8280) acc 56.2500 (56.4509) kd_loss 0.8728 (0.8265) lr 1.6845e-03 eta 0:18:55
epoch [15/50] batch [160/319] time 0.099 (0.100) data 0.000 (0.004) loss 2.1324 (2.1990) ce_loss 1.1084 (1.1375) teacher_loss 0.8611 (0.9580) loss_zs_kd 1.0388 (0.9690) loss_oracle 0.8505 (0.8292) acc 62.5000 (56.5430) kd_loss 0.8461 (0.8264) lr 1.6845e-03 eta 0:18:47
epoch [15/50] batch [180/319] time 0.114 (0.099) data 0.000 (0.003) loss 2.0455 (2.1863) ce_loss 1.1807 (1.1306) teacher_loss 0.8256 (0.9451) loss_zs_kd 0.8177 (0.9692) loss_oracle 0.8443 (0.8296) acc 62.5000 (56.7882) kd_loss 0.7978 (0.8264) lr 1.6845e-03 eta 0:18:43
epoch [15/50] batch [200/319] time 0.100 (0.099) data 0.000 (0.003) loss 2.4765 (2.1983) ce_loss 1.4863 (1.1384) teacher_loss 1.2533 (0.9572) loss_zs_kd 0.8349 (0.9691) loss_oracle 0.8183 (0.8287) acc 50.0000 (56.7188) kd_loss 0.8140 (0.8267) lr 1.6845e-03 eta 0:18:33
epoch [15/50] batch [220/319] time 0.098 (0.099) data 0.000 (0.003) loss 2.3651 (2.2067) ce_loss 1.2549 (1.1403) teacher_loss 1.1722 (0.9669) loss_zs_kd 0.8062 (0.9572) loss_oracle 0.8291 (0.8289) acc 53.1250 (56.7898) kd_loss 0.7784 (0.8253) lr 1.6845e-03 eta 0:18:38
epoch [15/50] batch [240/319] time 0.100 (0.100) data 0.000 (0.003) loss 2.0257 (2.2061) ce_loss 1.0342 (1.1391) teacher_loss 0.8246 (0.9681) loss_zs_kd 0.8290 (0.9416) loss_oracle 0.8562 (0.8291) acc 59.3750 (56.8359) kd_loss 0.7730 (0.8234) lr 1.6845e-03 eta 0:18:39
epoch [15/50] batch [260/319] time 0.110 (0.100) data 0.000 (0.002) loss 2.3052 (2.2149) ce_loss 1.1230 (1.1429) teacher_loss 1.0860 (0.9781) loss_zs_kd 0.7309 (0.9334) loss_oracle 0.8149 (0.8295) acc 50.0000 (56.5865) kd_loss 0.8117 (0.8220) lr 1.6845e-03 eta 0:18:40
epoch [15/50] batch [280/319] time 0.101 (0.100) data 0.000 (0.002) loss 2.0558 (2.2221) ce_loss 1.1172 (1.1466) teacher_loss 0.8311 (0.9857) loss_zs_kd 0.8250 (0.9244) loss_oracle 0.8438 (0.8303) acc 50.0000 (56.4509) kd_loss 0.8028 (0.8213) lr 1.6845e-03 eta 0:18:41
epoch [15/50] batch [300/319] time 0.094 (0.100) data 0.000 (0.002) loss 2.4293 (2.2228) ce_loss 1.2236 (1.1424) teacher_loss 1.2494 (0.9863) loss_zs_kd 0.7649 (0.9144) loss_oracle 0.7932 (0.8296) acc 53.1250 (56.7188) kd_loss 0.7832 (0.8217) lr 1.6845e-03 eta 0:18:42
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,699
* accuracy: 61.6%
* error: 38.4%
* macro_f1: 53.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,834
* accuracy: 49.7%
* error: 50.3%
* macro_f1: 21.4%
******* Domain 2 best val acc:      62.6%, epoch: 7 *******
******* Domain 2 best val test acc: 51.0%, epoch: 7 *******
******* Domain 2 best test acc:     56.2%, epoch: 13 *******
epoch [16/50] batch [20/319] time 0.073 (0.137) data 0.000 (0.027) loss 2.0339 (2.1835) ce_loss 0.8936 (1.1421) teacher_loss 0.8192 (0.9526) loss_zs_kd 0.7711 (0.8153) loss_oracle 0.8259 (0.8304) acc 68.7500 (57.0312) kd_loss 0.8018 (0.8157) lr 1.6374e-03 eta 0:25:30
epoch [16/50] batch [40/319] time 0.091 (0.118) data 0.000 (0.014) loss 2.3640 (2.1929) ce_loss 1.4756 (1.1303) teacher_loss 1.1242 (0.9500) loss_zs_kd 0.6723 (0.8300) loss_oracle 0.8500 (0.8373) acc 43.7500 (58.5156) kd_loss 0.8148 (0.8242) lr 1.6374e-03 eta 0:21:57
epoch [16/50] batch [60/319] time 0.099 (0.113) data 0.000 (0.009) loss 1.9833 (2.1786) ce_loss 0.8677 (1.1406) teacher_loss 0.7415 (0.9320) loss_zs_kd 1.0115 (0.8441) loss_oracle 0.8317 (0.8377) acc 65.6250 (57.9167) kd_loss 0.8260 (0.8277) lr 1.6374e-03 eta 0:20:56
epoch [16/50] batch [80/319] time 0.116 (0.111) data 0.000 (0.007) loss 2.1926 (2.1862) ce_loss 1.0146 (1.1375) teacher_loss 0.9625 (0.9404) loss_zs_kd 0.8899 (0.8553) loss_oracle 0.8362 (0.8379) acc 56.2500 (57.9688) kd_loss 0.8120 (0.8269) lr 1.6374e-03 eta 0:20:26
epoch [16/50] batch [100/319] time 0.103 (0.109) data 0.000 (0.006) loss 2.3451 (2.2020) ce_loss 1.2402 (1.1454) teacher_loss 1.1282 (0.9560) loss_zs_kd 0.6698 (0.8542) loss_oracle 0.8076 (0.8370) acc 50.0000 (57.3438) kd_loss 0.8131 (0.8275) lr 1.6374e-03 eta 0:20:04
epoch [16/50] batch [120/319] time 0.103 (0.108) data 0.000 (0.005) loss 2.1611 (2.1979) ce_loss 1.0693 (1.1396) teacher_loss 0.8991 (0.9529) loss_zs_kd 0.9715 (0.8524) loss_oracle 0.8530 (0.8359) acc 56.2500 (57.5781) kd_loss 0.8355 (0.8270) lr 1.6374e-03 eta 0:19:51
epoch [16/50] batch [140/319] time 0.100 (0.107) data 0.000 (0.004) loss 2.0357 (2.2111) ce_loss 0.8604 (1.1512) teacher_loss 0.7993 (0.9655) loss_zs_kd 0.8972 (0.8552) loss_oracle 0.8511 (0.8367) acc 71.8750 (56.9420) kd_loss 0.8109 (0.8272) lr 1.6374e-03 eta 0:19:40
epoch [16/50] batch [160/319] time 0.097 (0.107) data 0.000 (0.004) loss 1.9630 (2.2199) ce_loss 1.0010 (1.1599) teacher_loss 0.7315 (0.9745) loss_zs_kd 0.9092 (0.8587) loss_oracle 0.8240 (0.8362) acc 62.5000 (56.4453) kd_loss 0.8195 (0.8274) lr 1.6374e-03 eta 0:19:33
epoch [16/50] batch [180/319] time 0.097 (0.106) data 0.000 (0.003) loss 2.1043 (2.2180) ce_loss 1.0957 (1.1539) teacher_loss 0.8137 (0.9735) loss_zs_kd 0.7137 (0.8557) loss_oracle 0.8130 (0.8360) acc 50.0000 (56.2847) kd_loss 0.8841 (0.8265) lr 1.6374e-03 eta 0:19:29
epoch [16/50] batch [200/319] time 0.090 (0.106) data 0.000 (0.003) loss 2.1528 (2.2173) ce_loss 1.1143 (1.1559) teacher_loss 0.9175 (0.9726) loss_zs_kd 0.8524 (0.8542) loss_oracle 0.8290 (0.8361) acc 65.6250 (55.8438) kd_loss 0.8209 (0.8267) lr 1.6374e-03 eta 0:19:25
epoch [16/50] batch [220/319] time 0.101 (0.106) data 0.000 (0.003) loss 2.1986 (2.2139) ce_loss 1.0293 (1.1537) teacher_loss 0.9215 (0.9695) loss_zs_kd 0.8534 (0.8654) loss_oracle 0.8548 (0.8353) acc 59.3750 (55.8239) kd_loss 0.8498 (0.8268) lr 1.6374e-03 eta 0:19:21
epoch [16/50] batch [240/319] time 0.109 (0.106) data 0.000 (0.003) loss 2.0939 (2.2144) ce_loss 1.1416 (1.1565) teacher_loss 0.8920 (0.9704) loss_zs_kd 1.1441 (0.8740) loss_oracle 0.8402 (0.8353) acc 46.8750 (55.7031) kd_loss 0.7819 (0.8264) lr 1.6374e-03 eta 0:19:17
epoch [16/50] batch [260/319] time 0.103 (0.106) data 0.000 (0.002) loss 1.9113 (2.2157) ce_loss 1.0234 (1.1577) teacher_loss 0.6822 (0.9717) loss_zs_kd 0.7902 (0.8676) loss_oracle 0.8647 (0.8349) acc 53.1250 (55.6851) kd_loss 0.7967 (0.8266) lr 1.6374e-03 eta 0:19:13
epoch [16/50] batch [280/319] time 0.128 (0.106) data 0.000 (0.002) loss 2.5246 (2.2150) ce_loss 1.4268 (1.1595) teacher_loss 1.2937 (0.9706) loss_zs_kd 0.9445 (0.8699) loss_oracle 0.8051 (0.8341) acc 37.5000 (55.6696) kd_loss 0.8283 (0.8273) lr 1.6374e-03 eta 0:19:11
epoch [16/50] batch [300/319] time 0.108 (0.106) data 0.000 (0.002) loss 2.1692 (2.2095) ce_loss 1.1934 (1.1566) teacher_loss 0.8832 (0.9643) loss_zs_kd 0.7992 (0.8726) loss_oracle 0.8543 (0.8344) acc 50.0000 (55.7396) kd_loss 0.8588 (0.8279) lr 1.6374e-03 eta 0:19:09
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,616
* accuracy: 59.8%
* error: 40.2%
* macro_f1: 51.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,808
* accuracy: 49.4%
* error: 50.6%
* macro_f1: 21.0%
******* Domain 2 best val acc:      62.6%, epoch: 7 *******
******* Domain 2 best val test acc: 51.0%, epoch: 7 *******
******* Domain 2 best test acc:     56.2%, epoch: 13 *******
epoch [17/50] batch [20/319] time 0.088 (0.129) data 0.000 (0.026) loss 2.0045 (2.0539) ce_loss 0.9526 (1.0976) teacher_loss 0.7447 (0.8071) loss_zs_kd 1.3036 (0.8284) loss_oracle 0.8238 (0.8327) acc 59.3750 (56.2500) kd_loss 0.8479 (0.8304) lr 1.5878e-03 eta 0:23:18
epoch [17/50] batch [40/319] time 0.100 (0.111) data 0.000 (0.013) loss 2.0246 (2.0990) ce_loss 1.0908 (1.1318) teacher_loss 0.8264 (0.8461) loss_zs_kd 1.0400 (0.9046) loss_oracle 0.8165 (0.8317) acc 59.3750 (55.6250) kd_loss 0.7899 (0.8370) lr 1.5878e-03 eta 0:19:57
epoch [17/50] batch [60/319] time 0.100 (0.109) data 0.000 (0.009) loss 2.4451 (2.1030) ce_loss 1.3994 (1.1397) teacher_loss 1.2030 (0.8525) loss_zs_kd 0.7541 (0.9061) loss_oracle 0.8071 (0.8328) acc 53.1250 (56.3542) kd_loss 0.8386 (0.8341) lr 1.5878e-03 eta 0:19:39
epoch [17/50] batch [80/319] time 0.103 (0.105) data 0.000 (0.007) loss 2.0295 (2.0941) ce_loss 0.8560 (1.1348) teacher_loss 0.8288 (0.8452) loss_zs_kd 1.0312 (0.8897) loss_oracle 0.8132 (0.8335) acc 68.7500 (56.7969) kd_loss 0.7941 (0.8321) lr 1.5878e-03 eta 0:18:52
epoch [17/50] batch [100/319] time 0.106 (0.104) data 0.000 (0.006) loss 1.9914 (2.0975) ce_loss 1.2158 (1.1425) teacher_loss 0.7546 (0.8464) loss_zs_kd 1.1157 (0.8862) loss_oracle 0.8614 (0.8352) acc 50.0000 (56.5312) kd_loss 0.8061 (0.8335) lr 1.5878e-03 eta 0:18:33
epoch [17/50] batch [120/319] time 0.107 (0.103) data 0.000 (0.005) loss 2.2849 (2.1094) ce_loss 1.0322 (1.1538) teacher_loss 1.0125 (0.8596) loss_zs_kd 1.2203 (0.9065) loss_oracle 0.8039 (0.8345) acc 53.1250 (56.0677) kd_loss 0.8704 (0.8326) lr 1.5878e-03 eta 0:18:30
epoch [17/50] batch [140/319] time 0.116 (0.103) data 0.000 (0.004) loss 2.3902 (2.1249) ce_loss 1.2246 (1.1579) teacher_loss 1.1604 (0.8759) loss_zs_kd 0.9958 (0.9192) loss_oracle 0.8260 (0.8342) acc 56.2500 (55.8482) kd_loss 0.8169 (0.8319) lr 1.5878e-03 eta 0:18:24
epoch [17/50] batch [160/319] time 0.091 (0.102) data 0.000 (0.004) loss 1.9423 (2.1308) ce_loss 0.8760 (1.1512) teacher_loss 0.6421 (0.8814) loss_zs_kd 0.8229 (0.9162) loss_oracle 0.8648 (0.8342) acc 65.6250 (56.0742) kd_loss 0.8678 (0.8324) lr 1.5878e-03 eta 0:18:07
epoch [17/50] batch [180/319] time 0.084 (0.101) data 0.000 (0.003) loss 1.8818 (2.1281) ce_loss 0.9937 (1.1505) teacher_loss 0.5903 (0.8795) loss_zs_kd 1.1170 (0.9133) loss_oracle 0.8437 (0.8342) acc 65.6250 (55.9549) kd_loss 0.8696 (0.8315) lr 1.5878e-03 eta 0:17:53
epoch [17/50] batch [200/319] time 0.086 (0.099) data 0.000 (0.003) loss 1.9656 (2.1336) ce_loss 0.8462 (1.1517) teacher_loss 0.7192 (0.8839) loss_zs_kd 0.9444 (0.9156) loss_oracle 0.8296 (0.8340) acc 84.3750 (56.2188) kd_loss 0.8316 (0.8326) lr 1.5878e-03 eta 0:17:38
epoch [17/50] batch [220/319] time 0.101 (0.099) data 0.000 (0.003) loss 2.1335 (2.1447) ce_loss 1.0557 (1.1584) teacher_loss 0.9047 (0.8957) loss_zs_kd 1.0660 (0.9111) loss_oracle 0.8328 (0.8334) acc 59.3750 (55.9801) kd_loss 0.8123 (0.8323) lr 1.5878e-03 eta 0:17:29
epoch [17/50] batch [240/319] time 0.105 (0.099) data 0.000 (0.002) loss 2.3787 (2.1428) ce_loss 1.2783 (1.1569) teacher_loss 1.1240 (0.8940) loss_zs_kd 1.0468 (0.9074) loss_oracle 0.8511 (0.8337) acc 46.8750 (56.0286) kd_loss 0.8292 (0.8319) lr 1.5878e-03 eta 0:17:31
epoch [17/50] batch [260/319] time 0.097 (0.099) data 0.000 (0.002) loss 2.0859 (2.1424) ce_loss 1.1904 (1.1554) teacher_loss 0.7863 (0.8924) loss_zs_kd 1.0392 (0.9099) loss_oracle 0.8246 (0.8340) acc 50.0000 (56.0697) kd_loss 0.8873 (0.8330) lr 1.5878e-03 eta 0:17:32
epoch [17/50] batch [280/319] time 0.099 (0.100) data 0.001 (0.002) loss 1.7728 (2.1414) ce_loss 0.8662 (1.1534) teacher_loss 0.5386 (0.8911) loss_zs_kd 0.9997 (0.9096) loss_oracle 0.8418 (0.8334) acc 59.3750 (55.9933) kd_loss 0.8133 (0.8336) lr 1.5878e-03 eta 0:17:33
epoch [17/50] batch [300/319] time 0.103 (0.100) data 0.000 (0.002) loss 2.3325 (2.1419) ce_loss 1.2002 (1.1526) teacher_loss 1.0483 (0.8916) loss_zs_kd 1.1100 (0.9146) loss_oracle 0.8543 (0.8340) acc 53.1250 (56.1250) kd_loss 0.8571 (0.8333) lr 1.5878e-03 eta 0:17:35
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,713
* accuracy: 62.0%
* error: 38.0%
* macro_f1: 52.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,283
* accuracy: 54.3%
* error: 45.7%
* macro_f1: 21.2%
******* Domain 2 best val acc:      62.6%, epoch: 7 *******
******* Domain 2 best val test acc: 51.0%, epoch: 7 *******
******* Domain 2 best test acc:     56.2%, epoch: 13 *******
epoch [18/50] batch [20/319] time 0.075 (0.127) data 0.000 (0.025) loss 2.0363 (2.1302) ce_loss 1.0674 (1.0800) teacher_loss 0.8180 (0.8904) loss_zs_kd 0.9894 (1.0278) loss_oracle 0.8016 (0.8362) acc 59.3750 (60.0000) kd_loss 0.8176 (0.8216) lr 1.5358e-03 eta 0:22:09
epoch [18/50] batch [40/319] time 0.080 (0.103) data 0.000 (0.013) loss 2.0595 (2.1302) ce_loss 1.0635 (1.1060) teacher_loss 0.8777 (0.8882) loss_zs_kd 0.9504 (1.0266) loss_oracle 0.8374 (0.8357) acc 50.0000 (58.1250) kd_loss 0.7631 (0.8242) lr 1.5358e-03 eta 0:18:02
epoch [18/50] batch [60/319] time 0.086 (0.096) data 0.000 (0.009) loss 2.0540 (2.1189) ce_loss 1.1807 (1.1210) teacher_loss 0.8377 (0.8751) loss_zs_kd 0.9190 (0.9797) loss_oracle 0.8382 (0.8370) acc 53.1250 (56.9792) kd_loss 0.7972 (0.8253) lr 1.5358e-03 eta 0:16:46
epoch [18/50] batch [80/319] time 0.090 (0.093) data 0.000 (0.007) loss 1.8639 (2.1229) ce_loss 0.9678 (1.1275) teacher_loss 0.6315 (0.8779) loss_zs_kd 0.9354 (0.9623) loss_oracle 0.8592 (0.8354) acc 68.7500 (56.9922) kd_loss 0.8028 (0.8273) lr 1.5358e-03 eta 0:16:12
epoch [18/50] batch [100/319] time 0.086 (0.091) data 0.000 (0.005) loss 1.7941 (2.1165) ce_loss 0.7217 (1.1354) teacher_loss 0.5472 (0.8686) loss_zs_kd 0.9683 (0.9603) loss_oracle 0.8228 (0.8346) acc 75.0000 (56.6875) kd_loss 0.8355 (0.8306) lr 1.5358e-03 eta 0:15:52
epoch [18/50] batch [120/319] time 0.086 (0.090) data 0.000 (0.005) loss 1.9805 (2.1231) ce_loss 1.2646 (1.1510) teacher_loss 0.7560 (0.8784) loss_zs_kd 1.2157 (0.9507) loss_oracle 0.8114 (0.8328) acc 53.1250 (56.1198) kd_loss 0.8188 (0.8283) lr 1.5358e-03 eta 0:15:38
epoch [18/50] batch [140/319] time 0.086 (0.089) data 0.000 (0.004) loss 2.0819 (2.1207) ce_loss 0.9146 (1.1503) teacher_loss 0.8330 (0.8758) loss_zs_kd 0.9471 (0.9368) loss_oracle 0.8388 (0.8339) acc 71.8750 (55.8929) kd_loss 0.8294 (0.8280) lr 1.5358e-03 eta 0:15:24
epoch [18/50] batch [160/319] time 0.091 (0.090) data 0.000 (0.003) loss 2.2861 (2.1319) ce_loss 1.2871 (1.1612) teacher_loss 1.0350 (0.8869) loss_zs_kd 0.7969 (0.9190) loss_oracle 0.8530 (0.8330) acc 50.0000 (55.5859) kd_loss 0.8247 (0.8286) lr 1.5358e-03 eta 0:15:36
epoch [18/50] batch [180/319] time 0.081 (0.090) data 0.000 (0.003) loss 2.2731 (2.1302) ce_loss 1.2334 (1.1638) teacher_loss 1.0050 (0.8854) loss_zs_kd 0.8921 (0.9094) loss_oracle 0.8321 (0.8334) acc 53.1250 (55.4514) kd_loss 0.8520 (0.8281) lr 1.5358e-03 eta 0:15:31
epoch [18/50] batch [200/319] time 0.083 (0.089) data 0.000 (0.003) loss 2.3162 (2.1347) ce_loss 1.1816 (1.1699) teacher_loss 1.0438 (0.8889) loss_zs_kd 0.8371 (0.9040) loss_oracle 0.8344 (0.8343) acc 46.8750 (55.1719) kd_loss 0.8552 (0.8286) lr 1.5358e-03 eta 0:15:18
epoch [18/50] batch [220/319] time 0.086 (0.088) data 0.000 (0.003) loss 2.1634 (2.1338) ce_loss 1.1641 (1.1741) teacher_loss 0.9449 (0.8884) loss_zs_kd 0.8797 (0.8991) loss_oracle 0.8576 (0.8346) acc 50.0000 (54.9006) kd_loss 0.7898 (0.8281) lr 1.5358e-03 eta 0:15:10
epoch [18/50] batch [240/319] time 0.085 (0.088) data 0.000 (0.002) loss 1.9440 (2.1301) ce_loss 1.0674 (1.1726) teacher_loss 0.6868 (0.8844) loss_zs_kd 0.9364 (0.9050) loss_oracle 0.8446 (0.8345) acc 62.5000 (54.9740) kd_loss 0.8348 (0.8284) lr 1.5358e-03 eta 0:15:05
epoch [18/50] batch [260/319] time 0.080 (0.088) data 0.000 (0.002) loss 2.3053 (2.1271) ce_loss 1.1094 (1.1697) teacher_loss 1.0467 (0.8817) loss_zs_kd 1.1342 (0.9158) loss_oracle 0.8132 (0.8342) acc 53.1250 (55.1202) kd_loss 0.8520 (0.8283) lr 1.5358e-03 eta 0:14:58
epoch [18/50] batch [280/319] time 0.083 (0.087) data 0.000 (0.002) loss 2.3271 (2.1335) ce_loss 1.2598 (1.1711) teacher_loss 1.1161 (0.8880) loss_zs_kd 0.8284 (0.9200) loss_oracle 0.8223 (0.8345) acc 50.0000 (55.1451) kd_loss 0.7998 (0.8282) lr 1.5358e-03 eta 0:14:54
epoch [18/50] batch [300/319] time 0.087 (0.087) data 0.000 (0.002) loss 1.9327 (2.1374) ce_loss 0.9351 (1.1736) teacher_loss 0.6721 (0.8932) loss_zs_kd 0.9574 (0.9156) loss_oracle 0.8517 (0.8343) acc 68.7500 (55.1562) kd_loss 0.8348 (0.8270) lr 1.5358e-03 eta 0:14:49
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,729
* accuracy: 62.3%
* error: 37.7%
* macro_f1: 54.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,824
* accuracy: 49.5%
* error: 50.5%
* macro_f1: 21.4%
******* Domain 2 best val acc:      62.6%, epoch: 7 *******
******* Domain 2 best val test acc: 51.0%, epoch: 7 *******
******* Domain 2 best test acc:     56.2%, epoch: 13 *******
epoch [19/50] batch [20/319] time 0.072 (0.115) data 0.000 (0.033) loss 2.0820 (2.1372) ce_loss 0.8755 (1.1291) teacher_loss 0.8888 (0.9004) loss_zs_kd 0.8688 (0.8147) loss_oracle 0.8525 (0.8265) acc 65.6250 (56.8750) kd_loss 0.7669 (0.8235) lr 1.4818e-03 eta 0:19:35
epoch [19/50] batch [40/319] time 0.089 (0.097) data 0.000 (0.016) loss 2.0772 (2.1603) ce_loss 1.1152 (1.1449) teacher_loss 0.8650 (0.9249) loss_zs_kd 0.7650 (0.8175) loss_oracle 0.8417 (0.8258) acc 56.2500 (56.7969) kd_loss 0.7914 (0.8225) lr 1.4818e-03 eta 0:16:27
epoch [19/50] batch [60/319] time 0.083 (0.093) data 0.000 (0.011) loss 2.1384 (2.1616) ce_loss 0.9287 (1.1641) teacher_loss 0.9712 (0.9257) loss_zs_kd 0.5739 (0.8130) loss_oracle 0.8083 (0.8265) acc 75.0000 (56.0417) kd_loss 0.7630 (0.8226) lr 1.4818e-03 eta 0:15:41
epoch [19/50] batch [80/319] time 0.082 (0.091) data 0.000 (0.008) loss 2.3233 (2.1758) ce_loss 1.3369 (1.1898) teacher_loss 1.1535 (0.9407) loss_zs_kd 0.8144 (0.7923) loss_oracle 0.8105 (0.8281) acc 40.6250 (54.8438) kd_loss 0.7645 (0.8211) lr 1.4818e-03 eta 0:15:20
epoch [19/50] batch [100/319] time 0.080 (0.089) data 0.000 (0.007) loss 2.0886 (2.1820) ce_loss 1.2627 (1.2025) teacher_loss 0.8480 (0.9462) loss_zs_kd 0.8217 (0.7923) loss_oracle 0.8461 (0.8288) acc 56.2500 (53.8750) kd_loss 0.8175 (0.8214) lr 1.4818e-03 eta 0:14:57
epoch [19/50] batch [120/319] time 0.086 (0.088) data 0.000 (0.006) loss 2.2536 (2.1801) ce_loss 1.5137 (1.2032) teacher_loss 1.0377 (0.9451) loss_zs_kd 0.6586 (0.7901) loss_oracle 0.8015 (0.8284) acc 34.3750 (54.0365) kd_loss 0.8151 (0.8208) lr 1.4818e-03 eta 0:14:46
epoch [19/50] batch [140/319] time 0.071 (0.086) data 0.000 (0.005) loss 2.1081 (2.1804) ce_loss 1.1885 (1.2069) teacher_loss 0.8560 (0.9457) loss_zs_kd 0.9063 (0.8002) loss_oracle 0.8170 (0.8279) acc 56.2500 (53.8839) kd_loss 0.8435 (0.8207) lr 1.4818e-03 eta 0:14:29
epoch [19/50] batch [160/319] time 0.088 (0.085) data 0.000 (0.004) loss 2.2585 (2.1778) ce_loss 1.3096 (1.1996) teacher_loss 1.0351 (0.9432) loss_zs_kd 0.7069 (0.8020) loss_oracle 0.7906 (0.8281) acc 40.6250 (54.0039) kd_loss 0.8282 (0.8205) lr 1.4818e-03 eta 0:14:16
epoch [19/50] batch [180/319] time 0.072 (0.085) data 0.000 (0.004) loss 2.1292 (2.1729) ce_loss 0.8823 (1.1952) teacher_loss 0.8440 (0.9381) loss_zs_kd 0.8121 (0.7967) loss_oracle 0.8562 (0.8279) acc 78.1250 (54.1493) kd_loss 0.8571 (0.8209) lr 1.4818e-03 eta 0:14:09
epoch [19/50] batch [200/319] time 0.084 (0.085) data 0.000 (0.004) loss 2.1247 (2.1705) ce_loss 1.2344 (1.1937) teacher_loss 0.8865 (0.9351) loss_zs_kd 0.8111 (0.8075) loss_oracle 0.8446 (0.8287) acc 46.8750 (54.1406) kd_loss 0.8159 (0.8211) lr 1.4818e-03 eta 0:14:07
epoch [19/50] batch [220/319] time 0.079 (0.085) data 0.000 (0.003) loss 2.2918 (2.1653) ce_loss 1.3174 (1.1865) teacher_loss 1.0107 (0.9292) loss_zs_kd 0.7183 (0.8119) loss_oracle 0.8233 (0.8293) acc 50.0000 (54.5597) kd_loss 0.8695 (0.8215) lr 1.4818e-03 eta 0:14:06
epoch [19/50] batch [240/319] time 0.078 (0.085) data 0.000 (0.003) loss 2.3013 (2.1695) ce_loss 1.2969 (1.1841) teacher_loss 1.0769 (0.9333) loss_zs_kd 0.7644 (0.8117) loss_oracle 0.8241 (0.8291) acc 50.0000 (54.7135) kd_loss 0.8124 (0.8216) lr 1.4818e-03 eta 0:14:05
epoch [19/50] batch [260/319] time 0.082 (0.085) data 0.000 (0.003) loss 2.5208 (2.1750) ce_loss 1.4199 (1.1811) teacher_loss 1.2725 (0.9388) loss_zs_kd 0.6506 (0.8143) loss_oracle 0.8605 (0.8292) acc 50.0000 (54.8918) kd_loss 0.8181 (0.8216) lr 1.4818e-03 eta 0:14:01
epoch [19/50] batch [280/319] time 0.082 (0.085) data 0.000 (0.003) loss 2.0075 (2.1742) ce_loss 1.0967 (1.1789) teacher_loss 0.7826 (0.9386) loss_zs_kd 0.8335 (0.8149) loss_oracle 0.8419 (0.8295) acc 59.3750 (54.7991) kd_loss 0.8039 (0.8208) lr 1.4818e-03 eta 0:13:59
epoch [19/50] batch [300/319] time 0.084 (0.085) data 0.000 (0.002) loss 2.0624 (2.1717) ce_loss 1.2705 (1.1764) teacher_loss 0.8824 (0.9369) loss_zs_kd 0.9463 (0.8246) loss_oracle 0.8159 (0.8293) acc 53.1250 (54.8646) kd_loss 0.7720 (0.8202) lr 1.4818e-03 eta 0:13:57
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,718
* accuracy: 62.1%
* error: 37.9%
* macro_f1: 54.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,122
* accuracy: 52.6%
* error: 47.4%
* macro_f1: 22.0%
******* Domain 2 best val acc:      62.6%, epoch: 7 *******
******* Domain 2 best val test acc: 51.0%, epoch: 7 *******
******* Domain 2 best test acc:     56.2%, epoch: 13 *******
epoch [20/50] batch [20/319] time 0.074 (0.121) data 0.000 (0.037) loss 2.0461 (2.1213) ce_loss 1.0693 (1.1494) teacher_loss 0.7914 (0.8727) loss_zs_kd 0.9687 (1.0113) loss_oracle 0.8488 (0.8346) acc 53.1250 (57.9688) kd_loss 0.8303 (0.8312) lr 1.4258e-03 eta 0:19:53
epoch [20/50] batch [40/319] time 0.093 (0.104) data 0.000 (0.019) loss 2.0859 (2.1241) ce_loss 1.1621 (1.1412) teacher_loss 0.7880 (0.8778) loss_zs_kd 0.8646 (0.9921) loss_oracle 0.8383 (0.8346) acc 56.2500 (57.2656) kd_loss 0.8788 (0.8289) lr 1.4258e-03 eta 0:17:03
epoch [20/50] batch [60/319] time 0.072 (0.097) data 0.000 (0.012) loss 1.8177 (2.1692) ce_loss 0.9258 (1.1758) teacher_loss 0.6410 (0.9262) loss_zs_kd 0.7091 (0.9598) loss_oracle 0.8508 (0.8346) acc 68.7500 (55.9896) kd_loss 0.7513 (0.8256) lr 1.4258e-03 eta 0:15:54
epoch [20/50] batch [80/319] time 0.088 (0.093) data 0.000 (0.009) loss 2.1343 (2.1796) ce_loss 1.0811 (1.1696) teacher_loss 0.8829 (0.9374) loss_zs_kd 1.0740 (0.9636) loss_oracle 0.8526 (0.8334) acc 56.2500 (55.8984) kd_loss 0.8251 (0.8256) lr 1.4258e-03 eta 0:15:13
epoch [20/50] batch [100/319] time 0.088 (0.091) data 0.000 (0.008) loss 2.0771 (2.1850) ce_loss 1.1582 (1.1659) teacher_loss 0.8765 (0.9464) loss_zs_kd 0.9178 (0.9607) loss_oracle 0.8476 (0.8320) acc 56.2500 (55.8125) kd_loss 0.7769 (0.8226) lr 1.4258e-03 eta 0:14:53
epoch [20/50] batch [120/319] time 0.079 (0.090) data 0.000 (0.006) loss 1.9992 (2.1795) ce_loss 1.2520 (1.1616) teacher_loss 0.8094 (0.9444) loss_zs_kd 0.8793 (0.9559) loss_oracle 0.8088 (0.8319) acc 53.1250 (55.6771) kd_loss 0.7854 (0.8191) lr 1.4258e-03 eta 0:14:43
epoch [20/50] batch [140/319] time 0.072 (0.091) data 0.000 (0.006) loss 2.0986 (2.1766) ce_loss 1.1064 (1.1652) teacher_loss 0.8700 (0.9403) loss_zs_kd 0.8815 (0.9600) loss_oracle 0.8137 (0.8325) acc 50.0000 (55.2679) kd_loss 0.8217 (0.8200) lr 1.4258e-03 eta 0:14:44
epoch [20/50] batch [160/319] time 0.078 (0.089) data 0.000 (0.005) loss 2.0255 (2.1720) ce_loss 0.9312 (1.1582) teacher_loss 0.7943 (0.9356) loss_zs_kd 0.9773 (0.9528) loss_oracle 0.8212 (0.8321) acc 68.7500 (55.4883) kd_loss 0.8206 (0.8204) lr 1.4258e-03 eta 0:14:29
epoch [20/50] batch [180/319] time 0.082 (0.089) data 0.000 (0.004) loss 2.3800 (2.1778) ce_loss 1.2012 (1.1636) teacher_loss 1.0818 (0.9415) loss_zs_kd 0.7848 (0.9334) loss_oracle 0.8356 (0.8316) acc 46.8750 (54.9306) kd_loss 0.8804 (0.8205) lr 1.4258e-03 eta 0:14:22
epoch [20/50] batch [200/319] time 0.085 (0.089) data 0.000 (0.004) loss 2.3984 (2.1804) ce_loss 1.1670 (1.1658) teacher_loss 1.1935 (0.9441) loss_zs_kd 1.1248 (0.9202) loss_oracle 0.8442 (0.8315) acc 65.6250 (54.9531) kd_loss 0.7827 (0.8206) lr 1.4258e-03 eta 0:14:19
epoch [20/50] batch [220/319] time 0.081 (0.088) data 0.000 (0.004) loss 2.2994 (2.1809) ce_loss 1.2891 (1.1633) teacher_loss 1.0611 (0.9450) loss_zs_kd 0.8875 (0.9158) loss_oracle 0.8199 (0.8314) acc 62.5000 (54.9432) kd_loss 0.8284 (0.8202) lr 1.4258e-03 eta 0:14:09
epoch [20/50] batch [240/319] time 0.091 (0.088) data 0.000 (0.003) loss 2.2917 (2.1878) ce_loss 1.1875 (1.1674) teacher_loss 1.0842 (0.9526) loss_zs_kd 0.8007 (0.9070) loss_oracle 0.8331 (0.8317) acc 59.3750 (54.7526) kd_loss 0.7909 (0.8194) lr 1.4258e-03 eta 0:14:05
epoch [20/50] batch [260/319] time 0.077 (0.087) data 0.000 (0.003) loss 2.1793 (2.1916) ce_loss 1.0674 (1.1633) teacher_loss 0.9323 (0.9566) loss_zs_kd 0.6950 (0.8963) loss_oracle 0.8405 (0.8313) acc 59.3750 (55.0240) kd_loss 0.8268 (0.8193) lr 1.4258e-03 eta 0:14:00
epoch [20/50] batch [280/319] time 0.081 (0.087) data 0.000 (0.003) loss 2.2882 (2.1971) ce_loss 1.2949 (1.1666) teacher_loss 1.0378 (0.9626) loss_zs_kd 0.8757 (0.8875) loss_oracle 0.8501 (0.8307) acc 59.3750 (55.1004) kd_loss 0.8253 (0.8191) lr 1.4258e-03 eta 0:13:53
epoch [20/50] batch [300/319] time 0.080 (0.087) data 0.000 (0.003) loss 2.1685 (2.2019) ce_loss 1.1182 (1.1665) teacher_loss 0.9718 (0.9677) loss_zs_kd 1.0895 (0.8823) loss_oracle 0.8364 (0.8311) acc 59.3750 (55.2917) kd_loss 0.7785 (0.8186) lr 1.4258e-03 eta 0:13:49
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,589
* accuracy: 59.1%
* error: 40.9%
* macro_f1: 52.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,045
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 22.6%
******* Domain 2 best val acc:      62.6%, epoch: 7 *******
******* Domain 2 best val test acc: 51.0%, epoch: 7 *******
******* Domain 2 best test acc:     56.2%, epoch: 13 *******
epoch [21/50] batch [20/319] time 0.076 (0.110) data 0.000 (0.027) loss 2.1553 (2.1897) ce_loss 1.1270 (1.1782) teacher_loss 0.9215 (0.9468) loss_zs_kd 1.0124 (0.8998) loss_oracle 0.8463 (0.8282) acc 56.2500 (51.8750) kd_loss 0.8107 (0.8288) lr 1.3681e-03 eta 0:17:26
epoch [21/50] batch [40/319] time 0.083 (0.097) data 0.000 (0.014) loss 2.2399 (2.2200) ce_loss 1.2520 (1.2024) teacher_loss 1.0326 (0.9848) loss_zs_kd 0.6447 (0.8598) loss_oracle 0.8418 (0.8276) acc 53.1250 (52.0312) kd_loss 0.7864 (0.8213) lr 1.3681e-03 eta 0:15:28
epoch [21/50] batch [60/319] time 0.087 (0.093) data 0.000 (0.009) loss 2.0658 (2.2260) ce_loss 1.2764 (1.2218) teacher_loss 0.8148 (0.9887) loss_zs_kd 1.0251 (0.8619) loss_oracle 0.8529 (0.8295) acc 50.0000 (51.9792) kd_loss 0.8246 (0.8226) lr 1.3681e-03 eta 0:14:42
epoch [21/50] batch [80/319] time 0.091 (0.091) data 0.000 (0.007) loss 1.9972 (2.2331) ce_loss 0.9072 (1.2299) teacher_loss 0.7822 (0.9960) loss_zs_kd 0.7315 (0.8429) loss_oracle 0.7933 (0.8308) acc 68.7500 (51.7969) kd_loss 0.8183 (0.8217) lr 1.3681e-03 eta 0:14:24
epoch [21/50] batch [100/319] time 0.085 (0.089) data 0.000 (0.006) loss 2.0702 (2.2392) ce_loss 1.2402 (1.2316) teacher_loss 0.8103 (1.0023) loss_zs_kd 0.6950 (0.8282) loss_oracle 0.8570 (0.8312) acc 53.1250 (51.7188) kd_loss 0.8314 (0.8213) lr 1.3681e-03 eta 0:14:07
epoch [21/50] batch [120/319] time 0.081 (0.089) data 0.000 (0.005) loss 2.0563 (2.2271) ce_loss 1.0244 (1.2200) teacher_loss 0.8470 (0.9901) loss_zs_kd 0.7837 (0.8215) loss_oracle 0.7954 (0.8311) acc 59.3750 (52.1615) kd_loss 0.8116 (0.8214) lr 1.3681e-03 eta 0:13:59
epoch [21/50] batch [140/319] time 0.078 (0.088) data 0.000 (0.004) loss 2.2611 (2.2238) ce_loss 1.3408 (1.2056) teacher_loss 1.0316 (0.9878) loss_zs_kd 0.9013 (0.8192) loss_oracle 0.8370 (0.8325) acc 40.6250 (52.6339) kd_loss 0.8110 (0.8198) lr 1.3681e-03 eta 0:13:51
epoch [21/50] batch [160/319] time 0.083 (0.088) data 0.000 (0.004) loss 2.0439 (2.2251) ce_loss 1.0576 (1.1988) teacher_loss 0.8934 (0.9904) loss_zs_kd 0.9526 (0.8124) loss_oracle 0.8262 (0.8326) acc 65.6250 (53.3594) kd_loss 0.7374 (0.8185) lr 1.3681e-03 eta 0:13:46
epoch [21/50] batch [180/319] time 0.076 (0.087) data 0.000 (0.003) loss 2.2672 (2.2163) ce_loss 1.2285 (1.1924) teacher_loss 1.0021 (0.9810) loss_zs_kd 0.8234 (0.8116) loss_oracle 0.8650 (0.8326) acc 53.1250 (53.7153) kd_loss 0.8326 (0.8190) lr 1.3681e-03 eta 0:13:40
epoch [21/50] batch [200/319] time 0.093 (0.087) data 0.000 (0.003) loss 2.4679 (2.2127) ce_loss 1.3594 (1.1889) teacher_loss 1.2561 (0.9767) loss_zs_kd 0.8785 (0.8162) loss_oracle 0.8278 (0.8322) acc 50.0000 (53.7500) kd_loss 0.7980 (0.8199) lr 1.3681e-03 eta 0:13:34
epoch [21/50] batch [220/319] time 0.082 (0.087) data 0.000 (0.003) loss 2.0123 (2.2061) ce_loss 1.0830 (1.1823) teacher_loss 0.8040 (0.9689) loss_zs_kd 0.8002 (0.8272) loss_oracle 0.7992 (0.8330) acc 53.1250 (54.1761) kd_loss 0.8087 (0.8207) lr 1.3681e-03 eta 0:13:30
epoch [21/50] batch [240/319] time 0.076 (0.086) data 0.000 (0.003) loss 2.1053 (2.2012) ce_loss 1.0625 (1.1774) teacher_loss 0.8119 (0.9633) loss_zs_kd 0.8806 (0.8287) loss_oracle 0.8334 (0.8331) acc 56.2500 (54.4661) kd_loss 0.8768 (0.8213) lr 1.3681e-03 eta 0:13:25
epoch [21/50] batch [260/319] time 0.093 (0.086) data 0.000 (0.002) loss 2.2084 (2.2056) ce_loss 1.2754 (1.1798) teacher_loss 0.9923 (0.9676) loss_zs_kd 0.8739 (0.8287) loss_oracle 0.8516 (0.8328) acc 43.7500 (54.2548) kd_loss 0.7903 (0.8216) lr 1.3681e-03 eta 0:13:19
epoch [21/50] batch [280/319] time 0.103 (0.086) data 0.000 (0.002) loss 2.1307 (2.2071) ce_loss 1.0996 (1.1792) teacher_loss 0.8563 (0.9682) loss_zs_kd 0.6735 (0.8240) loss_oracle 0.8525 (0.8322) acc 59.3750 (54.0737) kd_loss 0.8481 (0.8229) lr 1.3681e-03 eta 0:13:18
epoch [21/50] batch [300/319] time 0.081 (0.086) data 0.000 (0.002) loss 1.9292 (2.2004) ce_loss 0.9780 (1.1774) teacher_loss 0.6444 (0.9605) loss_zs_kd 0.8250 (0.8191) loss_oracle 0.8494 (0.8319) acc 59.3750 (54.2083) kd_loss 0.8602 (0.8239) lr 1.3681e-03 eta 0:13:16
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,754
* accuracy: 62.9%
* error: 37.1%
* macro_f1: 54.9%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,782
* accuracy: 49.1%
* error: 50.9%
* macro_f1: 21.1%
******* Domain 2 best val acc:      62.9%, epoch: 21 *******
******* Domain 2 best val test acc: 49.1%, epoch: 21 *******
******* Domain 2 best test acc:     56.2%, epoch: 13 *******
epoch [22/50] batch [20/319] time 0.088 (0.112) data 0.000 (0.027) loss 2.1459 (2.1190) ce_loss 1.2148 (1.1282) teacher_loss 0.8574 (0.8762) loss_zs_kd 1.0344 (0.8911) loss_oracle 0.8361 (0.8268) acc 53.1250 (57.6562) kd_loss 0.8705 (0.8294) lr 1.3090e-03 eta 0:17:16
epoch [22/50] batch [40/319] time 0.089 (0.100) data 0.000 (0.014) loss 2.2517 (2.1194) ce_loss 1.2393 (1.1318) teacher_loss 0.9826 (0.8784) loss_zs_kd 0.9041 (0.8488) loss_oracle 0.8419 (0.8304) acc 46.8750 (56.5625) kd_loss 0.8482 (0.8258) lr 1.3090e-03 eta 0:15:19
epoch [22/50] batch [60/319] time 0.085 (0.095) data 0.001 (0.009) loss 1.9629 (2.1438) ce_loss 1.0928 (1.1534) teacher_loss 0.7336 (0.8978) loss_zs_kd 0.8589 (0.8307) loss_oracle 0.8392 (0.8314) acc 59.3750 (55.8333) kd_loss 0.8097 (0.8304) lr 1.3090e-03 eta 0:14:31
epoch [22/50] batch [80/319] time 0.083 (0.095) data 0.000 (0.007) loss 2.4911 (2.1430) ce_loss 1.5967 (1.1584) teacher_loss 1.2070 (0.8974) loss_zs_kd 0.9678 (0.8451) loss_oracle 0.8427 (0.8318) acc 40.6250 (55.8984) kd_loss 0.8627 (0.8297) lr 1.3090e-03 eta 0:14:29
epoch [22/50] batch [100/319] time 0.092 (0.093) data 0.000 (0.006) loss 2.0374 (2.1475) ce_loss 1.2676 (1.1723) teacher_loss 0.7413 (0.9008) loss_zs_kd 0.7889 (0.8562) loss_oracle 0.8434 (0.8321) acc 43.7500 (55.0625) kd_loss 0.8744 (0.8307) lr 1.3090e-03 eta 0:14:11
epoch [22/50] batch [120/319] time 0.081 (0.092) data 0.000 (0.005) loss 2.4843 (2.1413) ce_loss 1.5938 (1.1814) teacher_loss 1.1963 (0.8929) loss_zs_kd 1.0435 (0.8632) loss_oracle 0.8266 (0.8315) acc 53.1250 (54.7656) kd_loss 0.8747 (0.8327) lr 1.3090e-03 eta 0:14:03
epoch [22/50] batch [140/319] time 0.080 (0.092) data 0.000 (0.004) loss 2.2057 (2.1455) ce_loss 1.1396 (1.1867) teacher_loss 0.9644 (0.8919) loss_zs_kd 0.8688 (0.9028) loss_oracle 0.8522 (0.8316) acc 53.1250 (54.5759) kd_loss 0.8152 (0.8378) lr 1.3090e-03 eta 0:14:00
epoch [22/50] batch [160/319] time 0.077 (0.091) data 0.000 (0.004) loss 2.2523 (2.1501) ce_loss 1.2051 (1.1864) teacher_loss 1.0850 (0.8911) loss_zs_kd 0.7160 (0.9067) loss_oracle 0.7764 (0.8318) acc 53.1250 (54.5898) kd_loss 0.7791 (0.8431) lr 1.3090e-03 eta 0:13:50
epoch [22/50] batch [180/319] time 0.078 (0.091) data 0.000 (0.003) loss 2.4827 (2.1407) ce_loss 1.2988 (1.1771) teacher_loss 1.2022 (0.8825) loss_zs_kd 0.9322 (0.9092) loss_oracle 0.8245 (0.8326) acc 50.0000 (54.7569) kd_loss 0.8682 (0.8418) lr 1.3090e-03 eta 0:13:41
epoch [22/50] batch [200/319] time 0.087 (0.090) data 0.000 (0.003) loss 2.1348 (2.1389) ce_loss 1.2842 (1.1795) teacher_loss 0.9025 (0.8836) loss_zs_kd 0.7911 (0.8999) loss_oracle 0.8309 (0.8311) acc 53.1250 (54.8594) kd_loss 0.8169 (0.8398) lr 1.3090e-03 eta 0:13:33
epoch [22/50] batch [220/319] time 0.082 (0.089) data 0.000 (0.003) loss 2.1782 (2.1426) ce_loss 0.9912 (1.1787) teacher_loss 0.9534 (0.8873) loss_zs_kd 0.7610 (0.8958) loss_oracle 0.8112 (0.8306) acc 71.8750 (55.0142) kd_loss 0.8192 (0.8400) lr 1.3090e-03 eta 0:13:27
epoch [22/50] batch [240/319] time 0.087 (0.089) data 0.000 (0.003) loss 2.2243 (2.1378) ce_loss 1.4160 (1.1719) teacher_loss 1.0134 (0.8824) loss_zs_kd 0.9825 (0.8972) loss_oracle 0.8072 (0.8309) acc 46.8750 (55.2344) kd_loss 0.8073 (0.8399) lr 1.3090e-03 eta 0:13:21
epoch [22/50] batch [260/319] time 0.082 (0.088) data 0.000 (0.002) loss 2.3377 (2.1470) ce_loss 1.1562 (1.1733) teacher_loss 1.1474 (0.8918) loss_zs_kd 0.7809 (0.8979) loss_oracle 0.7917 (0.8314) acc 59.3750 (55.1923) kd_loss 0.7944 (0.8394) lr 1.3090e-03 eta 0:13:15
epoch [22/50] batch [280/319] time 0.081 (0.088) data 0.000 (0.002) loss 1.7751 (2.1472) ce_loss 0.9253 (1.1678) teacher_loss 0.5810 (0.8935) loss_zs_kd 0.7281 (0.8916) loss_oracle 0.8210 (0.8304) acc 65.6250 (55.3460) kd_loss 0.7836 (0.8384) lr 1.3090e-03 eta 0:13:08
epoch [22/50] batch [300/319] time 0.086 (0.088) data 0.000 (0.002) loss 2.1602 (2.1505) ce_loss 1.1748 (1.1683) teacher_loss 0.9164 (0.8985) loss_zs_kd 1.0051 (0.8890) loss_oracle 0.8128 (0.8297) acc 56.2500 (55.3125) kd_loss 0.8374 (0.8371) lr 1.3090e-03 eta 0:13:03
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,677
* accuracy: 61.1%
* error: 38.9%
* macro_f1: 53.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,200
* accuracy: 43.1%
* error: 56.9%
* macro_f1: 21.9%
******* Domain 2 best val acc:      62.9%, epoch: 21 *******
******* Domain 2 best val test acc: 49.1%, epoch: 21 *******
******* Domain 2 best test acc:     56.2%, epoch: 13 *******
epoch [23/50] batch [20/319] time 0.082 (0.121) data 0.000 (0.034) loss 2.4611 (2.2068) ce_loss 1.2959 (1.1779) teacher_loss 1.1819 (0.9655) loss_zs_kd 0.7586 (0.8159) loss_oracle 0.8555 (0.8291) acc 50.0000 (53.4375) kd_loss 0.8514 (0.8268) lr 1.2487e-03 eta 0:17:57
epoch [23/50] batch [40/319] time 0.084 (0.102) data 0.000 (0.017) loss 2.0798 (2.2072) ce_loss 1.1270 (1.1839) teacher_loss 0.8570 (0.9703) loss_zs_kd 0.9725 (0.7916) loss_oracle 0.8429 (0.8296) acc 56.2500 (53.8281) kd_loss 0.8013 (0.8221) lr 1.2487e-03 eta 0:15:10
epoch [23/50] batch [60/319] time 0.077 (0.096) data 0.000 (0.011) loss 2.1250 (2.1701) ce_loss 1.2090 (1.1520) teacher_loss 0.9553 (0.9309) loss_zs_kd 0.9185 (0.8165) loss_oracle 0.7981 (0.8273) acc 46.8750 (55.6250) kd_loss 0.7706 (0.8256) lr 1.2487e-03 eta 0:14:15
epoch [23/50] batch [80/319] time 0.089 (0.094) data 0.000 (0.009) loss 2.0181 (2.1766) ce_loss 1.0361 (1.1520) teacher_loss 0.8702 (0.9385) loss_zs_kd 0.8225 (0.8169) loss_oracle 0.8375 (0.8290) acc 59.3750 (55.4688) kd_loss 0.7291 (0.8236) lr 1.2487e-03 eta 0:13:48
epoch [23/50] batch [100/319] time 0.082 (0.092) data 0.000 (0.007) loss 1.9805 (2.1821) ce_loss 0.9990 (1.1562) teacher_loss 0.8249 (0.9447) loss_zs_kd 0.9752 (0.8105) loss_oracle 0.8410 (0.8293) acc 68.7500 (54.8750) kd_loss 0.7351 (0.8228) lr 1.2487e-03 eta 0:13:32
epoch [23/50] batch [120/319] time 0.087 (0.091) data 0.000 (0.006) loss 2.1866 (2.1815) ce_loss 1.1582 (1.1491) teacher_loss 0.9824 (0.9426) loss_zs_kd 0.7819 (0.8059) loss_oracle 0.8218 (0.8289) acc 59.3750 (55.0781) kd_loss 0.7933 (0.8244) lr 1.2487e-03 eta 0:13:18
epoch [23/50] batch [140/319] time 0.067 (0.090) data 0.000 (0.005) loss 1.9865 (2.1766) ce_loss 1.1934 (1.1496) teacher_loss 0.7540 (0.9386) loss_zs_kd 0.6849 (0.8049) loss_oracle 0.8302 (0.8280) acc 50.0000 (55.1116) kd_loss 0.8174 (0.8240) lr 1.2487e-03 eta 0:13:08
epoch [23/50] batch [160/319] time 0.090 (0.089) data 0.000 (0.004) loss 2.0864 (2.1711) ce_loss 1.0059 (1.1490) teacher_loss 0.8450 (0.9299) loss_zs_kd 0.8257 (0.8172) loss_oracle 0.8158 (0.8281) acc 68.7500 (55.1562) kd_loss 0.8336 (0.8272) lr 1.2487e-03 eta 0:13:00
epoch [23/50] batch [180/319] time 0.090 (0.089) data 0.001 (0.004) loss 2.3038 (2.1686) ce_loss 1.2822 (1.1500) teacher_loss 1.0854 (0.9280) loss_zs_kd 0.7518 (0.8222) loss_oracle 0.8357 (0.8274) acc 40.6250 (54.9306) kd_loss 0.8005 (0.8269) lr 1.2487e-03 eta 0:12:58
epoch [23/50] batch [200/319] time 0.081 (0.089) data 0.000 (0.004) loss 1.7144 (2.1671) ce_loss 0.8188 (1.1524) teacher_loss 0.4725 (0.9260) loss_zs_kd 0.6352 (0.8214) loss_oracle 0.8631 (0.8283) acc 68.7500 (54.9844) kd_loss 0.8103 (0.8270) lr 1.2487e-03 eta 0:12:58
epoch [23/50] batch [220/319] time 0.089 (0.089) data 0.000 (0.003) loss 2.4651 (2.1688) ce_loss 1.4287 (1.1539) teacher_loss 1.2002 (0.9255) loss_zs_kd 0.8631 (0.8254) loss_oracle 0.8631 (0.8290) acc 50.0000 (55.1136) kd_loss 0.8332 (0.8288) lr 1.2487e-03 eta 0:12:52
epoch [23/50] batch [240/319] time 0.084 (0.089) data 0.000 (0.003) loss 2.1260 (2.1730) ce_loss 1.2334 (1.1611) teacher_loss 0.9074 (0.9305) loss_zs_kd 0.7757 (0.8218) loss_oracle 0.8559 (0.8295) acc 56.2500 (55.1042) kd_loss 0.7906 (0.8278) lr 1.2487e-03 eta 0:12:54
epoch [23/50] batch [260/319] time 0.085 (0.089) data 0.000 (0.003) loss 2.2951 (2.1760) ce_loss 1.2578 (1.1637) teacher_loss 1.0100 (0.9332) loss_zs_kd 0.8489 (0.8231) loss_oracle 0.8634 (0.8298) acc 50.0000 (55.2163) kd_loss 0.8534 (0.8279) lr 1.2487e-03 eta 0:12:49
epoch [23/50] batch [280/319] time 0.082 (0.088) data 0.000 (0.003) loss 1.8830 (2.1757) ce_loss 1.0049 (1.1650) teacher_loss 0.6523 (0.9326) loss_zs_kd 0.9929 (0.8241) loss_oracle 0.7359 (0.8301) acc 53.1250 (55.0781) kd_loss 0.8627 (0.8280) lr 1.2487e-03 eta 0:12:44
epoch [23/50] batch [300/319] time 0.094 (0.088) data 0.001 (0.003) loss 2.2971 (2.1748) ce_loss 1.2363 (1.1679) teacher_loss 1.0455 (0.9310) loss_zs_kd 0.9950 (0.8261) loss_oracle 0.8436 (0.8307) acc 56.2500 (55.0521) kd_loss 0.8298 (0.8284) lr 1.2487e-03 eta 0:12:41
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,776
* accuracy: 63.4%
* error: 36.6%
* macro_f1: 56.2%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,090
* accuracy: 52.3%
* error: 47.7%
* macro_f1: 22.5%
******* Domain 2 best val acc:      63.4%, epoch: 23 *******
******* Domain 2 best val test acc: 52.3%, epoch: 23 *******
******* Domain 2 best test acc:     56.2%, epoch: 13 *******
epoch [24/50] batch [20/319] time 0.075 (0.114) data 0.000 (0.033) loss 1.9228 (2.1376) ce_loss 0.9741 (1.1711) teacher_loss 0.6335 (0.8689) loss_zs_kd 1.0003 (0.9178) loss_oracle 0.8547 (0.8408) acc 62.5000 (56.4062) kd_loss 0.8620 (0.8484) lr 1.1874e-03 eta 0:16:18
epoch [24/50] batch [40/319] time 0.087 (0.099) data 0.001 (0.016) loss 2.6913 (2.1599) ce_loss 1.4209 (1.1662) teacher_loss 1.4165 (0.8967) loss_zs_kd 0.8321 (0.9164) loss_oracle 0.8559 (0.8386) acc 43.7500 (55.7812) kd_loss 0.8468 (0.8439) lr 1.1874e-03 eta 0:14:08
epoch [24/50] batch [60/319] time 0.081 (0.095) data 0.001 (0.011) loss 2.1630 (2.1947) ce_loss 1.2764 (1.1912) teacher_loss 0.8800 (0.9382) loss_zs_kd 0.9737 (0.8847) loss_oracle 0.8459 (0.8353) acc 50.0000 (55.0000) kd_loss 0.8601 (0.8388) lr 1.1874e-03 eta 0:13:28
epoch [24/50] batch [80/319] time 0.091 (0.092) data 0.000 (0.008) loss 2.1858 (2.1871) ce_loss 1.3350 (1.1858) teacher_loss 0.9777 (0.9351) loss_zs_kd 0.9087 (0.8655) loss_oracle 0.8624 (0.8340) acc 43.7500 (55.4297) kd_loss 0.7768 (0.8350) lr 1.1874e-03 eta 0:13:09
epoch [24/50] batch [100/319] time 0.083 (0.091) data 0.000 (0.007) loss 2.5559 (2.1909) ce_loss 1.5527 (1.1786) teacher_loss 1.3140 (0.9402) loss_zs_kd 0.8801 (0.8495) loss_oracle 0.8492 (0.8341) acc 37.5000 (55.3750) kd_loss 0.8174 (0.8335) lr 1.1874e-03 eta 0:12:57
epoch [24/50] batch [120/319] time 0.086 (0.090) data 0.000 (0.006) loss 2.2006 (2.2019) ce_loss 1.2021 (1.1835) teacher_loss 0.9674 (0.9533) loss_zs_kd 0.7497 (0.8431) loss_oracle 0.8345 (0.8349) acc 53.1250 (54.8958) kd_loss 0.8160 (0.8312) lr 1.1874e-03 eta 0:12:47
epoch [24/50] batch [140/319] time 0.082 (0.089) data 0.000 (0.005) loss 2.1005 (2.1970) ce_loss 0.9829 (1.1799) teacher_loss 0.8782 (0.9493) loss_zs_kd 0.9445 (0.8322) loss_oracle 0.8325 (0.8346) acc 71.8750 (55.0446) kd_loss 0.8060 (0.8304) lr 1.1874e-03 eta 0:12:37
epoch [24/50] batch [160/319] time 0.086 (0.089) data 0.000 (0.004) loss 2.1227 (2.1891) ce_loss 1.3838 (1.1739) teacher_loss 0.8737 (0.9430) loss_zs_kd 0.6544 (0.8291) loss_oracle 0.8487 (0.8341) acc 46.8750 (55.1562) kd_loss 0.8246 (0.8290) lr 1.1874e-03 eta 0:12:28
epoch [24/50] batch [180/319] time 0.082 (0.088) data 0.000 (0.004) loss 2.3129 (2.1899) ce_loss 1.3604 (1.1771) teacher_loss 1.1424 (0.9456) loss_zs_kd 0.7478 (0.8355) loss_oracle 0.8305 (0.8339) acc 56.2500 (55.3299) kd_loss 0.7553 (0.8273) lr 1.1874e-03 eta 0:12:22
epoch [24/50] batch [200/319] time 0.081 (0.088) data 0.000 (0.004) loss 2.0861 (2.1850) ce_loss 1.1895 (1.1743) teacher_loss 0.8559 (0.9410) loss_zs_kd 0.7972 (0.8304) loss_oracle 0.8384 (0.8337) acc 59.3750 (55.5156) kd_loss 0.8110 (0.8271) lr 1.1874e-03 eta 0:12:18
epoch [24/50] batch [220/319] time 0.081 (0.087) data 0.000 (0.003) loss 2.4358 (2.1816) ce_loss 1.3047 (1.1733) teacher_loss 1.1256 (0.9376) loss_zs_kd 0.9095 (0.8300) loss_oracle 0.8412 (0.8333) acc 53.1250 (55.5114) kd_loss 0.8896 (0.8273) lr 1.1874e-03 eta 0:12:13
epoch [24/50] batch [240/319] time 0.092 (0.087) data 0.000 (0.003) loss 2.4756 (2.1788) ce_loss 1.3740 (1.1682) teacher_loss 1.1846 (0.9345) loss_zs_kd 0.8922 (0.8276) loss_oracle 0.8521 (0.8329) acc 46.8750 (55.6120) kd_loss 0.8649 (0.8279) lr 1.1874e-03 eta 0:12:10
epoch [24/50] batch [260/319] time 0.086 (0.087) data 0.000 (0.003) loss 2.3794 (2.1780) ce_loss 1.3506 (1.1672) teacher_loss 1.1394 (0.9330) loss_zs_kd 0.6466 (0.8267) loss_oracle 0.8194 (0.8330) acc 46.8750 (55.6731) kd_loss 0.8303 (0.8285) lr 1.1874e-03 eta 0:12:05
epoch [24/50] batch [280/319] time 0.087 (0.087) data 0.000 (0.003) loss 2.3698 (2.1766) ce_loss 1.2676 (1.1698) teacher_loss 1.1016 (0.9315) loss_zs_kd 0.6869 (0.8289) loss_oracle 0.8112 (0.8325) acc 46.8750 (55.6473) kd_loss 0.8626 (0.8288) lr 1.1874e-03 eta 0:12:02
epoch [24/50] batch [300/319] time 0.080 (0.086) data 0.000 (0.002) loss 2.0523 (2.1755) ce_loss 0.9595 (1.1666) teacher_loss 0.7711 (0.9314) loss_zs_kd 0.9811 (0.8277) loss_oracle 0.8125 (0.8322) acc 62.5000 (55.7500) kd_loss 0.8750 (0.8280) lr 1.1874e-03 eta 0:11:58
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,788
* accuracy: 63.7%
* error: 36.3%
* macro_f1: 55.4%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,200
* accuracy: 53.4%
* error: 46.6%
* macro_f1: 22.6%
******* Domain 2 best val acc:      63.7%, epoch: 24 *******
******* Domain 2 best val test acc: 53.4%, epoch: 24 *******
******* Domain 2 best test acc:     56.2%, epoch: 13 *******
epoch [25/50] batch [20/319] time 0.081 (0.112) data 0.001 (0.033) loss 2.2048 (2.1692) ce_loss 1.1963 (1.1078) teacher_loss 0.9676 (0.9185) loss_zs_kd 0.8364 (0.8481) loss_oracle 0.8353 (0.8372) acc 65.6250 (59.6875) kd_loss 0.8195 (0.8321) lr 1.1253e-03 eta 0:15:29
epoch [25/50] batch [40/319] time 0.084 (0.099) data 0.000 (0.017) loss 2.3477 (2.2029) ce_loss 1.2041 (1.1245) teacher_loss 1.1216 (0.9629) loss_zs_kd 0.6445 (0.8035) loss_oracle 0.8306 (0.8346) acc 62.5000 (58.0469) kd_loss 0.8108 (0.8227) lr 1.1253e-03 eta 0:13:35
epoch [25/50] batch [60/319] time 0.081 (0.093) data 0.000 (0.011) loss 2.5383 (2.2008) ce_loss 1.2002 (1.1260) teacher_loss 1.2818 (0.9623) loss_zs_kd 0.9400 (0.7832) loss_oracle 0.8005 (0.8321) acc 53.1250 (56.9792) kd_loss 0.8563 (0.8225) lr 1.1253e-03 eta 0:12:49
epoch [25/50] batch [80/319] time 0.080 (0.091) data 0.000 (0.008) loss 2.1934 (2.2142) ce_loss 1.0908 (1.1303) teacher_loss 0.9994 (0.9760) loss_zs_kd 0.7842 (0.7885) loss_oracle 0.8473 (0.8311) acc 50.0000 (56.9531) kd_loss 0.7703 (0.8227) lr 1.1253e-03 eta 0:12:27
epoch [25/50] batch [100/319] time 0.079 (0.089) data 0.000 (0.007) loss 2.4744 (2.2207) ce_loss 1.2646 (1.1166) teacher_loss 1.2580 (0.9812) loss_zs_kd 0.7640 (0.7965) loss_oracle 0.8173 (0.8305) acc 62.5000 (57.4688) kd_loss 0.8077 (0.8243) lr 1.1253e-03 eta 0:12:13
epoch [25/50] batch [120/319] time 0.086 (0.088) data 0.000 (0.006) loss 2.1185 (2.2232) ce_loss 1.0312 (1.1162) teacher_loss 0.8973 (0.9869) loss_zs_kd 1.0110 (0.7947) loss_oracle 0.8326 (0.8294) acc 62.5000 (57.7344) kd_loss 0.8049 (0.8216) lr 1.1253e-03 eta 0:12:02
epoch [25/50] batch [140/319] time 0.084 (0.088) data 0.000 (0.005) loss 2.0966 (2.2172) ce_loss 1.0225 (1.1083) teacher_loss 0.7792 (0.9811) loss_zs_kd 0.9541 (0.7963) loss_oracle 0.8391 (0.8291) acc 59.3750 (58.1473) kd_loss 0.8979 (0.8216) lr 1.1253e-03 eta 0:11:55
epoch [25/50] batch [160/319] time 0.081 (0.089) data 0.000 (0.004) loss 2.0561 (2.2142) ce_loss 1.0918 (1.1084) teacher_loss 0.7910 (0.9763) loss_zs_kd 0.9427 (0.7996) loss_oracle 0.8381 (0.8294) acc 68.7500 (58.1445) kd_loss 0.8461 (0.8231) lr 1.1253e-03 eta 0:12:02
epoch [25/50] batch [180/319] time 0.084 (0.088) data 0.000 (0.004) loss 2.0828 (2.2030) ce_loss 1.0732 (1.1056) teacher_loss 0.8419 (0.9663) loss_zs_kd 0.7508 (0.8087) loss_oracle 0.8461 (0.8298) acc 56.2500 (58.1944) kd_loss 0.8179 (0.8217) lr 1.1253e-03 eta 0:11:56
epoch [25/50] batch [200/319] time 0.085 (0.088) data 0.000 (0.003) loss 2.1944 (2.1953) ce_loss 1.1357 (1.1044) teacher_loss 1.0112 (0.9576) loss_zs_kd 0.9104 (0.8228) loss_oracle 0.8006 (0.8303) acc 46.8750 (58.0781) kd_loss 0.7829 (0.8225) lr 1.1253e-03 eta 0:11:52
epoch [25/50] batch [220/319] time 0.082 (0.088) data 0.000 (0.003) loss 2.0842 (2.1963) ce_loss 1.0000 (1.1084) teacher_loss 0.8621 (0.9574) loss_zs_kd 0.9989 (0.8316) loss_oracle 0.8271 (0.8309) acc 50.0000 (57.9403) kd_loss 0.8085 (0.8234) lr 1.1253e-03 eta 0:11:48
epoch [25/50] batch [240/319] time 0.085 (0.088) data 0.000 (0.003) loss 2.3317 (2.1882) ce_loss 1.2744 (1.1035) teacher_loss 1.0797 (0.9473) loss_zs_kd 0.9890 (0.8390) loss_oracle 0.8438 (0.8313) acc 50.0000 (58.0208) kd_loss 0.8302 (0.8252) lr 1.1253e-03 eta 0:11:45
epoch [25/50] batch [260/319] time 0.080 (0.087) data 0.000 (0.003) loss 2.0643 (2.1880) ce_loss 1.2441 (1.1034) teacher_loss 0.8132 (0.9464) loss_zs_kd 0.9841 (0.8481) loss_oracle 0.8614 (0.8314) acc 40.6250 (57.9688) kd_loss 0.8204 (0.8260) lr 1.1253e-03 eta 0:11:41
epoch [25/50] batch [280/319] time 0.079 (0.087) data 0.000 (0.003) loss 2.1570 (2.1842) ce_loss 1.1113 (1.1050) teacher_loss 0.9595 (0.9412) loss_zs_kd 0.7987 (0.8487) loss_oracle 0.8117 (0.8320) acc 59.3750 (57.9353) kd_loss 0.7916 (0.8271) lr 1.1253e-03 eta 0:11:37
epoch [25/50] batch [300/319] time 0.085 (0.087) data 0.000 (0.002) loss 2.1340 (2.1824) ce_loss 1.1553 (1.1064) teacher_loss 0.9745 (0.9397) loss_zs_kd 0.8179 (0.8509) loss_oracle 0.8368 (0.8323) acc 56.2500 (57.9062) kd_loss 0.7411 (0.8265) lr 1.1253e-03 eta 0:11:34
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,741
* accuracy: 62.6%
* error: 37.4%
* macro_f1: 54.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,191
* accuracy: 53.3%
* error: 46.7%
* macro_f1: 23.4%
******* Domain 2 best val acc:      63.7%, epoch: 24 *******
******* Domain 2 best val test acc: 53.4%, epoch: 24 *******
******* Domain 2 best test acc:     56.2%, epoch: 13 *******
epoch [26/50] batch [20/319] time 0.078 (0.103) data 0.000 (0.027) loss 2.1446 (2.2188) ce_loss 1.1611 (1.1977) teacher_loss 0.9113 (0.9759) loss_zs_kd 0.6356 (0.8372) loss_oracle 0.8376 (0.8289) acc 53.1250 (53.4375) kd_loss 0.8145 (0.8284) lr 1.0628e-03 eta 0:13:39
epoch [26/50] batch [40/319] time 0.085 (0.091) data 0.000 (0.013) loss 2.1590 (2.1986) ce_loss 1.0703 (1.1979) teacher_loss 0.9213 (0.9521) loss_zs_kd 0.9346 (0.8254) loss_oracle 0.8050 (0.8298) acc 59.3750 (54.2969) kd_loss 0.8352 (0.8316) lr 1.0628e-03 eta 0:12:02
epoch [26/50] batch [60/319] time 0.086 (0.087) data 0.000 (0.009) loss 2.2003 (2.1668) ce_loss 1.0986 (1.1605) teacher_loss 0.9370 (0.9216) loss_zs_kd 0.7741 (0.8454) loss_oracle 0.8398 (0.8290) acc 62.5000 (56.3021) kd_loss 0.8434 (0.8307) lr 1.0628e-03 eta 0:11:28
epoch [26/50] batch [80/319] time 0.086 (0.086) data 0.000 (0.007) loss 2.1507 (2.1695) ce_loss 1.1846 (1.1734) teacher_loss 0.9124 (0.9227) loss_zs_kd 1.1463 (0.8653) loss_oracle 0.8379 (0.8300) acc 59.3750 (55.5469) kd_loss 0.8193 (0.8319) lr 1.0628e-03 eta 0:11:19
epoch [26/50] batch [100/319] time 0.088 (0.086) data 0.001 (0.006) loss 2.1917 (2.1724) ce_loss 1.1230 (1.1735) teacher_loss 0.9716 (0.9230) loss_zs_kd 0.7770 (0.8769) loss_oracle 0.8166 (0.8323) acc 53.1250 (55.8750) kd_loss 0.8118 (0.8333) lr 1.0628e-03 eta 0:11:16
epoch [26/50] batch [120/319] time 0.086 (0.085) data 0.000 (0.005) loss 2.1176 (2.1591) ce_loss 1.1182 (1.1632) teacher_loss 0.8397 (0.9060) loss_zs_kd 0.9354 (0.8831) loss_oracle 0.8491 (0.8320) acc 59.3750 (56.3281) kd_loss 0.8534 (0.8371) lr 1.0628e-03 eta 0:11:09
epoch [26/50] batch [140/319] time 0.085 (0.085) data 0.000 (0.004) loss 2.2445 (2.1577) ce_loss 1.2061 (1.1538) teacher_loss 0.9892 (0.9041) loss_zs_kd 0.8980 (0.8852) loss_oracle 0.8007 (0.8317) acc 56.2500 (56.5625) kd_loss 0.8550 (0.8378) lr 1.0628e-03 eta 0:11:09
epoch [26/50] batch [160/319] time 0.088 (0.085) data 0.000 (0.004) loss 2.0187 (2.1534) ce_loss 0.9424 (1.1472) teacher_loss 0.7641 (0.9003) loss_zs_kd 0.8146 (0.8833) loss_oracle 0.8267 (0.8319) acc 65.6250 (56.5820) kd_loss 0.8412 (0.8371) lr 1.0628e-03 eta 0:11:02
epoch [26/50] batch [180/319] time 0.080 (0.084) data 0.000 (0.003) loss 1.9156 (2.1519) ce_loss 0.9546 (1.1442) teacher_loss 0.7085 (0.8988) loss_zs_kd 0.8823 (0.8836) loss_oracle 0.7853 (0.8316) acc 62.5000 (56.4236) kd_loss 0.8144 (0.8374) lr 1.0628e-03 eta 0:10:58
epoch [26/50] batch [200/319] time 0.088 (0.084) data 0.000 (0.003) loss 2.4241 (2.1550) ce_loss 1.3740 (1.1409) teacher_loss 1.1865 (0.9033) loss_zs_kd 0.7618 (0.8792) loss_oracle 0.8595 (0.8313) acc 43.7500 (56.3438) kd_loss 0.8078 (0.8360) lr 1.0628e-03 eta 0:10:56
epoch [26/50] batch [220/319] time 0.082 (0.085) data 0.000 (0.003) loss 1.8399 (2.1564) ce_loss 0.7354 (1.1397) teacher_loss 0.7246 (0.9068) loss_zs_kd 0.6605 (0.8757) loss_oracle 0.8434 (0.8310) acc 71.8750 (56.4915) kd_loss 0.6936 (0.8341) lr 1.0628e-03 eta 0:10:55
epoch [26/50] batch [240/319] time 0.083 (0.085) data 0.000 (0.002) loss 2.0675 (2.1586) ce_loss 1.1123 (1.1382) teacher_loss 0.8519 (0.9102) loss_zs_kd 0.8676 (0.8706) loss_oracle 0.8070 (0.8310) acc 75.0000 (56.5885) kd_loss 0.8121 (0.8330) lr 1.0628e-03 eta 0:10:55
epoch [26/50] batch [260/319] time 0.086 (0.085) data 0.000 (0.002) loss 2.1604 (2.1562) ce_loss 0.9727 (1.1340) teacher_loss 0.8951 (0.9074) loss_zs_kd 0.7344 (0.8698) loss_oracle 0.8211 (0.8308) acc 62.5000 (56.8029) kd_loss 0.8547 (0.8334) lr 1.0628e-03 eta 0:10:52
epoch [26/50] batch [280/319] time 0.082 (0.085) data 0.000 (0.002) loss 2.1279 (2.1586) ce_loss 0.9443 (1.1353) teacher_loss 0.8961 (0.9106) loss_zs_kd 0.7539 (0.8690) loss_oracle 0.8110 (0.8303) acc 71.8750 (56.6964) kd_loss 0.8263 (0.8327) lr 1.0628e-03 eta 0:10:50
epoch [26/50] batch [300/319] time 0.085 (0.085) data 0.000 (0.002) loss 2.6530 (2.1645) ce_loss 1.6201 (1.1397) teacher_loss 1.3898 (0.9161) loss_zs_kd 0.8680 (0.8641) loss_oracle 0.8122 (0.8304) acc 40.6250 (56.5000) kd_loss 0.8571 (0.8333) lr 1.0628e-03 eta 0:10:49
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,800
* accuracy: 64.0%
* error: 36.0%
* macro_f1: 55.9%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,063
* accuracy: 52.0%
* error: 48.0%
* macro_f1: 22.9%
******* Domain 2 best val acc:      64.0%, epoch: 26 *******
******* Domain 2 best val test acc: 52.0%, epoch: 26 *******
******* Domain 2 best test acc:     56.2%, epoch: 13 *******
epoch [27/50] batch [20/319] time 0.073 (0.113) data 0.000 (0.035) loss 1.9344 (2.1672) ce_loss 0.9741 (1.1213) teacher_loss 0.6807 (0.9138) loss_zs_kd 0.6180 (0.8319) loss_oracle 0.7998 (0.8323) acc 56.2500 (54.3750) kd_loss 0.8538 (0.8372) lr 1.0000e-03 eta 0:14:21
epoch [27/50] batch [40/319] time 0.087 (0.098) data 0.000 (0.018) loss 1.8462 (2.1533) ce_loss 0.9888 (1.1263) teacher_loss 0.6313 (0.9112) loss_zs_kd 1.0735 (0.8536) loss_oracle 0.8585 (0.8338) acc 68.7500 (55.5469) kd_loss 0.7857 (0.8252) lr 1.0000e-03 eta 0:12:26
epoch [27/50] batch [60/319] time 0.074 (0.093) data 0.000 (0.012) loss 1.9833 (2.1286) ce_loss 1.0049 (1.1038) teacher_loss 0.7151 (0.8867) loss_zs_kd 1.0288 (0.8409) loss_oracle 0.8224 (0.8342) acc 62.5000 (57.5000) kd_loss 0.8571 (0.8248) lr 1.0000e-03 eta 0:11:44
epoch [27/50] batch [80/319] time 0.077 (0.089) data 0.000 (0.009) loss 2.3540 (2.1339) ce_loss 1.4229 (1.1035) teacher_loss 1.0741 (0.8922) loss_zs_kd 0.8539 (0.8357) loss_oracle 0.8613 (0.8336) acc 50.0000 (57.7734) kd_loss 0.8492 (0.8249) lr 1.0000e-03 eta 0:11:15
epoch [27/50] batch [100/319] time 0.080 (0.087) data 0.000 (0.007) loss 2.0770 (2.1317) ce_loss 0.9048 (1.0921) teacher_loss 0.7882 (0.8945) loss_zs_kd 0.9158 (0.8430) loss_oracle 0.8283 (0.8308) acc 68.7500 (58.4062) kd_loss 0.8746 (0.8218) lr 1.0000e-03 eta 0:10:56
epoch [27/50] batch [120/319] time 0.075 (0.087) data 0.000 (0.006) loss 2.1097 (2.1361) ce_loss 0.9702 (1.0915) teacher_loss 0.8307 (0.8992) loss_zs_kd 1.0067 (0.8617) loss_oracle 0.8533 (0.8310) acc 68.7500 (58.3594) kd_loss 0.8524 (0.8214) lr 1.0000e-03 eta 0:10:53
epoch [27/50] batch [140/319] time 0.086 (0.086) data 0.000 (0.005) loss 2.0505 (2.1373) ce_loss 1.0693 (1.0944) teacher_loss 0.8372 (0.9004) loss_zs_kd 0.9767 (0.8695) loss_oracle 0.8279 (0.8321) acc 56.2500 (57.9911) kd_loss 0.7993 (0.8209) lr 1.0000e-03 eta 0:10:47
epoch [27/50] batch [160/319] time 0.074 (0.085) data 0.000 (0.005) loss 1.9940 (2.1324) ce_loss 0.8735 (1.0927) teacher_loss 0.7648 (0.8944) loss_zs_kd 0.9791 (0.8875) loss_oracle 0.8519 (0.8312) acc 62.5000 (58.1055) kd_loss 0.8032 (0.8223) lr 1.0000e-03 eta 0:10:40
epoch [27/50] batch [180/319] time 0.085 (0.085) data 0.000 (0.004) loss 1.9487 (2.1366) ce_loss 0.8608 (1.0955) teacher_loss 0.7391 (0.8977) loss_zs_kd 0.8730 (0.8914) loss_oracle 0.7654 (0.8304) acc 65.6250 (58.0382) kd_loss 0.8269 (0.8237) lr 1.0000e-03 eta 0:10:34
epoch [27/50] batch [200/319] time 0.088 (0.085) data 0.000 (0.004) loss 2.0096 (2.1374) ce_loss 1.0088 (1.0990) teacher_loss 0.7285 (0.8976) loss_zs_kd 1.1714 (0.8995) loss_oracle 0.8592 (0.8314) acc 56.2500 (57.9062) kd_loss 0.8515 (0.8241) lr 1.0000e-03 eta 0:10:32
epoch [27/50] batch [220/319] time 0.081 (0.085) data 0.000 (0.003) loss 2.1525 (2.1329) ce_loss 1.1387 (1.1018) teacher_loss 0.9112 (0.8900) loss_zs_kd 0.9468 (0.9053) loss_oracle 0.8030 (0.8316) acc 53.1250 (57.7557) kd_loss 0.8399 (0.8271) lr 1.0000e-03 eta 0:10:30
epoch [27/50] batch [240/319] time 0.083 (0.085) data 0.000 (0.003) loss 2.2795 (2.1375) ce_loss 1.2744 (1.1089) teacher_loss 0.9835 (0.8934) loss_zs_kd 0.7855 (0.9081) loss_oracle 0.8283 (0.8323) acc 43.7500 (57.5391) kd_loss 0.8818 (0.8280) lr 1.0000e-03 eta 0:10:26
epoch [27/50] batch [260/319] time 0.076 (0.084) data 0.000 (0.003) loss 1.9766 (2.1341) ce_loss 1.0332 (1.1107) teacher_loss 0.7002 (0.8900) loss_zs_kd 0.9986 (0.9058) loss_oracle 0.8573 (0.8320) acc 59.3750 (57.5361) kd_loss 0.8478 (0.8281) lr 1.0000e-03 eta 0:10:20
epoch [27/50] batch [280/319] time 0.082 (0.084) data 0.000 (0.003) loss 2.4108 (2.1387) ce_loss 1.5000 (1.1169) teacher_loss 1.1398 (0.8943) loss_zs_kd 1.0401 (0.9046) loss_oracle 0.8327 (0.8316) acc 34.3750 (57.3103) kd_loss 0.8547 (0.8285) lr 1.0000e-03 eta 0:10:18
epoch [27/50] batch [300/319] time 0.075 (0.084) data 0.000 (0.003) loss 2.4079 (2.1357) ce_loss 1.3916 (1.1175) teacher_loss 1.1568 (0.8907) loss_zs_kd 1.0521 (0.9000) loss_oracle 0.8250 (0.8318) acc 46.8750 (57.2604) kd_loss 0.8385 (0.8290) lr 1.0000e-03 eta 0:10:16
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,774
* accuracy: 63.4%
* error: 36.6%
* macro_f1: 55.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,065
* accuracy: 52.0%
* error: 48.0%
* macro_f1: 23.6%
******* Domain 2 best val acc:      64.0%, epoch: 26 *******
******* Domain 2 best val test acc: 52.0%, epoch: 26 *******
******* Domain 2 best test acc:     56.2%, epoch: 13 *******
epoch [28/50] batch [20/319] time 0.063 (0.100) data 0.000 (0.032) loss 2.0326 (2.0834) ce_loss 1.0576 (1.0899) teacher_loss 0.7484 (0.8252) loss_zs_kd 1.0200 (0.9180) loss_oracle 0.8475 (0.8308) acc 59.3750 (56.4062) kd_loss 0.8604 (0.8428) lr 9.3721e-04 eta 0:12:11
epoch [28/50] batch [40/319] time 0.067 (0.081) data 0.000 (0.016) loss 2.3222 (2.1032) ce_loss 1.1797 (1.0864) teacher_loss 1.0115 (0.8449) loss_zs_kd 1.0428 (0.8979) loss_oracle 0.8120 (0.8273) acc 53.1250 (58.3594) kd_loss 0.9047 (0.8447) lr 9.3721e-04 eta 0:09:49
epoch [28/50] batch [60/319] time 0.063 (0.075) data 0.001 (0.011) loss 2.0013 (2.1298) ce_loss 1.0498 (1.1149) teacher_loss 0.7513 (0.8721) loss_zs_kd 0.9415 (0.9155) loss_oracle 0.8509 (0.8302) acc 59.3750 (57.0833) kd_loss 0.8246 (0.8426) lr 9.3721e-04 eta 0:09:02
epoch [28/50] batch [80/319] time 0.082 (0.074) data 0.000 (0.008) loss 2.1365 (2.1120) ce_loss 1.1719 (1.1076) teacher_loss 0.8725 (0.8515) loss_zs_kd 0.8954 (0.9186) loss_oracle 0.8385 (0.8319) acc 43.7500 (57.1484) kd_loss 0.8448 (0.8445) lr 9.3721e-04 eta 0:09:00
epoch [28/50] batch [100/319] time 0.070 (0.075) data 0.000 (0.007) loss 2.1412 (2.1109) ce_loss 1.1494 (1.1105) teacher_loss 0.8941 (0.8510) loss_zs_kd 1.0807 (0.9430) loss_oracle 0.8479 (0.8333) acc 46.8750 (57.4688) kd_loss 0.8232 (0.8431) lr 9.3721e-04 eta 0:08:59
epoch [28/50] batch [120/319] time 0.088 (0.076) data 0.000 (0.006) loss 2.0227 (2.1084) ce_loss 1.1025 (1.1044) teacher_loss 0.7881 (0.8500) loss_zs_kd 1.0666 (0.9454) loss_oracle 0.8507 (0.8325) acc 59.3750 (57.6302) kd_loss 0.8093 (0.8421) lr 9.3721e-04 eta 0:09:06
epoch [28/50] batch [140/319] time 0.079 (0.076) data 0.000 (0.005) loss 2.0680 (2.1134) ce_loss 1.0742 (1.1090) teacher_loss 0.8572 (0.8563) loss_zs_kd 0.9837 (0.9416) loss_oracle 0.8435 (0.8329) acc 53.1250 (57.6786) kd_loss 0.7891 (0.8406) lr 9.3721e-04 eta 0:09:10
epoch [28/50] batch [160/319] time 0.087 (0.077) data 0.000 (0.004) loss 1.8375 (2.1075) ce_loss 0.8369 (1.1054) teacher_loss 0.5883 (0.8521) loss_zs_kd 1.1328 (0.9310) loss_oracle 0.8275 (0.8320) acc 62.5000 (57.5195) kd_loss 0.8355 (0.8394) lr 9.3721e-04 eta 0:09:15
epoch [28/50] batch [180/319] time 0.078 (0.078) data 0.000 (0.004) loss 1.9911 (2.0989) ce_loss 0.9336 (1.0953) teacher_loss 0.7310 (0.8442) loss_zs_kd 0.9124 (0.9287) loss_oracle 0.8506 (0.8325) acc 65.6250 (58.0382) kd_loss 0.8348 (0.8384) lr 9.3721e-04 eta 0:09:18
epoch [28/50] batch [200/319] time 0.082 (0.079) data 0.000 (0.003) loss 2.1683 (2.1047) ce_loss 1.3340 (1.0981) teacher_loss 0.9210 (0.8491) loss_zs_kd 0.9188 (0.9298) loss_oracle 0.8637 (0.8324) acc 40.6250 (58.0625) kd_loss 0.8154 (0.8393) lr 9.3721e-04 eta 0:09:22
epoch [28/50] batch [220/319] time 0.087 (0.079) data 0.000 (0.003) loss 2.4560 (2.1101) ce_loss 1.2051 (1.1033) teacher_loss 1.1399 (0.8540) loss_zs_kd 0.8519 (0.9324) loss_oracle 0.8418 (0.8319) acc 56.2500 (57.8977) kd_loss 0.8952 (0.8402) lr 9.3721e-04 eta 0:09:25
epoch [28/50] batch [240/319] time 0.071 (0.079) data 0.000 (0.003) loss 2.0678 (2.1088) ce_loss 1.1133 (1.1018) teacher_loss 0.7923 (0.8534) loss_zs_kd 1.0178 (0.9396) loss_oracle 0.8635 (0.8321) acc 56.2500 (57.8255) kd_loss 0.8438 (0.8394) lr 9.3721e-04 eta 0:09:21
epoch [28/50] batch [260/319] time 0.066 (0.078) data 0.000 (0.003) loss 1.9984 (2.1033) ce_loss 0.9087 (1.1034) teacher_loss 0.6722 (0.8487) loss_zs_kd 1.1099 (0.9432) loss_oracle 0.8445 (0.8324) acc 65.6250 (57.7644) kd_loss 0.9040 (0.8384) lr 9.3721e-04 eta 0:09:12
epoch [28/50] batch [280/319] time 0.066 (0.077) data 0.000 (0.003) loss 1.9909 (2.1029) ce_loss 0.9785 (1.1037) teacher_loss 0.7218 (0.8485) loss_zs_kd 0.9732 (0.9471) loss_oracle 0.8333 (0.8324) acc 65.6250 (57.7121) kd_loss 0.8524 (0.8381) lr 9.3721e-04 eta 0:09:05
epoch [28/50] batch [300/319] time 0.065 (0.076) data 0.000 (0.002) loss 2.2179 (2.1035) ce_loss 1.3359 (1.1075) teacher_loss 0.9792 (0.8499) loss_zs_kd 0.8388 (0.9488) loss_oracle 0.8204 (0.8322) acc 46.8750 (57.6771) kd_loss 0.8285 (0.8374) lr 9.3721e-04 eta 0:08:57
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,715
* accuracy: 62.0%
* error: 38.0%
* macro_f1: 54.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,411
* accuracy: 45.3%
* error: 54.7%
* macro_f1: 21.7%
******* Domain 2 best val acc:      64.0%, epoch: 26 *******
******* Domain 2 best val test acc: 52.0%, epoch: 26 *******
******* Domain 2 best test acc:     56.2%, epoch: 13 *******
epoch [29/50] batch [20/319] time 0.081 (0.118) data 0.000 (0.032) loss 2.2160 (2.1330) ce_loss 1.4512 (1.1403) teacher_loss 0.9621 (0.8925) loss_zs_kd 0.7998 (0.8166) loss_oracle 0.8320 (0.8218) acc 43.7500 (57.8125) kd_loss 0.8380 (0.8296) lr 8.7467e-04 eta 0:13:48
epoch [29/50] batch [40/319] time 0.079 (0.100) data 0.000 (0.016) loss 2.0387 (2.1001) ce_loss 1.0947 (1.1254) teacher_loss 0.7964 (0.8596) loss_zs_kd 0.8787 (0.8440) loss_oracle 0.8440 (0.8246) acc 71.8750 (57.8125) kd_loss 0.8203 (0.8281) lr 8.7467e-04 eta 0:11:39
epoch [29/50] batch [60/319] time 0.085 (0.095) data 0.001 (0.011) loss 1.8854 (2.1073) ce_loss 0.9697 (1.1313) teacher_loss 0.6244 (0.8607) loss_zs_kd 0.9226 (0.8695) loss_oracle 0.8343 (0.8267) acc 59.3750 (57.6042) kd_loss 0.8438 (0.8332) lr 8.7467e-04 eta 0:11:02
epoch [29/50] batch [80/319] time 0.081 (0.093) data 0.000 (0.008) loss 2.0345 (2.1041) ce_loss 1.0527 (1.1273) teacher_loss 0.7783 (0.8588) loss_zs_kd 1.0525 (0.8925) loss_oracle 0.8301 (0.8265) acc 68.7500 (58.2422) kd_loss 0.8412 (0.8320) lr 8.7467e-04 eta 0:10:42
epoch [29/50] batch [100/319] time 0.072 (0.093) data 0.000 (0.007) loss 2.1924 (2.1043) ce_loss 1.0859 (1.1231) teacher_loss 1.0034 (0.8573) loss_zs_kd 1.2095 (0.9049) loss_oracle 0.8002 (0.8259) acc 59.3750 (58.2812) kd_loss 0.7889 (0.8341) lr 8.7467e-04 eta 0:10:44
epoch [29/50] batch [120/319] time 0.074 (0.091) data 0.000 (0.006) loss 2.0116 (2.1014) ce_loss 1.0205 (1.1173) teacher_loss 0.7540 (0.8546) loss_zs_kd 0.8492 (0.9100) loss_oracle 0.8429 (0.8270) acc 65.6250 (58.2292) kd_loss 0.8362 (0.8333) lr 8.7467e-04 eta 0:10:24
epoch [29/50] batch [140/319] time 0.076 (0.089) data 0.000 (0.005) loss 2.3630 (2.1070) ce_loss 1.3750 (1.1122) teacher_loss 1.1138 (0.8594) loss_zs_kd 1.1125 (0.9148) loss_oracle 0.8226 (0.8275) acc 43.7500 (58.4375) kd_loss 0.8379 (0.8339) lr 8.7467e-04 eta 0:10:08
epoch [29/50] batch [160/319] time 0.094 (0.088) data 0.000 (0.004) loss 2.5471 (2.1178) ce_loss 1.1689 (1.1201) teacher_loss 1.3050 (0.8717) loss_zs_kd 0.7825 (0.9166) loss_oracle 0.8218 (0.8276) acc 59.3750 (58.2227) kd_loss 0.8312 (0.8324) lr 8.7467e-04 eta 0:10:02
epoch [29/50] batch [180/319] time 0.084 (0.087) data 0.000 (0.004) loss 2.2248 (2.1254) ce_loss 1.1699 (1.1191) teacher_loss 0.9418 (0.8799) loss_zs_kd 0.6158 (0.9124) loss_oracle 0.8091 (0.8285) acc 56.2500 (58.0903) kd_loss 0.8785 (0.8313) lr 8.7467e-04 eta 0:09:58
epoch [29/50] batch [200/319] time 0.090 (0.087) data 0.000 (0.003) loss 2.1193 (2.1344) ce_loss 1.1260 (1.1224) teacher_loss 0.8843 (0.8893) loss_zs_kd 0.9483 (0.9066) loss_oracle 0.8001 (0.8281) acc 56.2500 (58.0000) kd_loss 0.8349 (0.8310) lr 8.7467e-04 eta 0:09:54
epoch [29/50] batch [220/319] time 0.091 (0.087) data 0.001 (0.003) loss 2.5033 (2.1333) ce_loss 1.4951 (1.1201) teacher_loss 1.3006 (0.8885) loss_zs_kd 0.7743 (0.8967) loss_oracle 0.8515 (0.8282) acc 40.6250 (57.9119) kd_loss 0.7769 (0.8307) lr 8.7467e-04 eta 0:09:50
epoch [29/50] batch [240/319] time 0.081 (0.087) data 0.000 (0.003) loss 2.2007 (2.1341) ce_loss 1.1748 (1.1182) teacher_loss 1.0112 (0.8891) loss_zs_kd 1.0746 (0.9062) loss_oracle 0.8201 (0.8284) acc 62.5000 (58.1120) kd_loss 0.7795 (0.8307) lr 8.7467e-04 eta 0:09:46
epoch [29/50] batch [260/319] time 0.079 (0.086) data 0.000 (0.003) loss 2.0748 (2.1390) ce_loss 1.0000 (1.1196) teacher_loss 0.8596 (0.8936) loss_zs_kd 1.1223 (0.9155) loss_oracle 0.8134 (0.8285) acc 65.6250 (57.9808) kd_loss 0.8085 (0.8312) lr 8.7467e-04 eta 0:09:44
epoch [29/50] batch [280/319] time 0.086 (0.086) data 0.000 (0.003) loss 2.1304 (2.1392) ce_loss 1.1855 (1.1174) teacher_loss 0.8595 (0.8949) loss_zs_kd 1.0771 (0.9246) loss_oracle 0.8294 (0.8286) acc 56.2500 (58.1027) kd_loss 0.8562 (0.8300) lr 8.7467e-04 eta 0:09:41
epoch [29/50] batch [300/319] time 0.087 (0.086) data 0.000 (0.002) loss 2.3099 (2.1421) ce_loss 1.3135 (1.1178) teacher_loss 1.1502 (0.8983) loss_zs_kd 1.0112 (0.9297) loss_oracle 0.8116 (0.8289) acc 46.8750 (58.1042) kd_loss 0.7539 (0.8293) lr 8.7467e-04 eta 0:09:39
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,760
* accuracy: 63.0%
* error: 37.0%
* macro_f1: 55.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,532
* accuracy: 56.8%
* error: 43.2%
* macro_f1: 23.7%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      64.0%, epoch: 26 *******
******* Domain 2 best val test acc: 52.0%, epoch: 26 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [30/50] batch [20/319] time 0.062 (0.102) data 0.000 (0.033) loss 1.8807 (2.1672) ce_loss 0.9297 (1.1818) teacher_loss 0.5961 (0.9023) loss_zs_kd 1.0200 (0.9754) loss_oracle 0.8631 (0.8341) acc 65.6250 (56.4062) kd_loss 0.8530 (0.8478) lr 8.1262e-04 eta 0:11:20
epoch [30/50] batch [40/319] time 0.066 (0.084) data 0.000 (0.017) loss 1.8966 (2.1829) ce_loss 1.1279 (1.1537) teacher_loss 0.5795 (0.9116) loss_zs_kd 0.9557 (1.0155) loss_oracle 0.8632 (0.8379) acc 56.2500 (56.1719) kd_loss 0.8855 (0.8523) lr 8.1262e-04 eta 0:09:20
epoch [30/50] batch [60/319] time 0.072 (0.078) data 0.001 (0.011) loss 2.0730 (2.1816) ce_loss 1.0049 (1.1364) teacher_loss 0.7981 (0.9134) loss_zs_kd 1.0295 (1.0122) loss_oracle 0.8216 (0.8373) acc 62.5000 (57.0312) kd_loss 0.8641 (0.8496) lr 8.1262e-04 eta 0:08:37
epoch [30/50] batch [80/319] time 0.063 (0.075) data 0.000 (0.008) loss 2.2251 (2.1788) ce_loss 1.1855 (1.1298) teacher_loss 1.0015 (0.9156) loss_zs_kd 0.8061 (1.0084) loss_oracle 0.7933 (0.8350) acc 59.3750 (57.1875) kd_loss 0.8269 (0.8457) lr 8.1262e-04 eta 0:08:17
epoch [30/50] batch [100/319] time 0.063 (0.073) data 0.000 (0.007) loss 2.1693 (2.1802) ce_loss 0.9336 (1.1293) teacher_loss 0.8947 (0.9205) loss_zs_kd 1.0205 (0.9951) loss_oracle 0.8616 (0.8355) acc 65.6250 (57.3125) kd_loss 0.8439 (0.8420) lr 8.1262e-04 eta 0:08:03
epoch [30/50] batch [120/319] time 0.068 (0.072) data 0.000 (0.006) loss 2.3134 (2.1848) ce_loss 1.1299 (1.1287) teacher_loss 0.9941 (0.9259) loss_zs_kd 0.9420 (0.9835) loss_oracle 0.8443 (0.8345) acc 59.3750 (57.3958) kd_loss 0.8972 (0.8417) lr 8.1262e-04 eta 0:07:55
epoch [30/50] batch [140/319] time 0.066 (0.071) data 0.000 (0.005) loss 1.9163 (2.1715) ce_loss 0.8901 (1.1202) teacher_loss 0.6828 (0.9162) loss_zs_kd 0.8476 (0.9704) loss_oracle 0.8423 (0.8327) acc 65.6250 (57.7009) kd_loss 0.8124 (0.8390) lr 8.1262e-04 eta 0:07:47
epoch [30/50] batch [160/319] time 0.085 (0.071) data 0.000 (0.004) loss 1.9434 (2.1675) ce_loss 1.1221 (1.1160) teacher_loss 0.7298 (0.9157) loss_zs_kd 0.6182 (0.9534) loss_oracle 0.7871 (0.8311) acc 59.3750 (57.7734) kd_loss 0.8201 (0.8363) lr 8.1262e-04 eta 0:07:46
epoch [30/50] batch [180/319] time 0.080 (0.073) data 0.000 (0.004) loss 2.1322 (2.1665) ce_loss 1.0576 (1.1135) teacher_loss 0.8749 (0.9130) loss_zs_kd 0.9460 (0.9448) loss_oracle 0.8302 (0.8309) acc 59.3750 (57.5868) kd_loss 0.8422 (0.8380) lr 8.1262e-04 eta 0:07:57
epoch [30/50] batch [200/319] time 0.077 (0.075) data 0.000 (0.004) loss 2.2941 (2.1608) ce_loss 1.0645 (1.1071) teacher_loss 0.9728 (0.9068) loss_zs_kd 0.9653 (0.9473) loss_oracle 0.8212 (0.8308) acc 62.5000 (57.8594) kd_loss 0.9107 (0.8386) lr 8.1262e-04 eta 0:08:06
epoch [30/50] batch [220/319] time 0.095 (0.076) data 0.000 (0.003) loss 2.2061 (2.1591) ce_loss 0.9268 (1.1070) teacher_loss 0.8839 (0.9043) loss_zs_kd 1.0021 (0.9564) loss_oracle 0.8160 (0.8311) acc 71.8750 (58.0398) kd_loss 0.9142 (0.8392) lr 8.1262e-04 eta 0:08:10
epoch [30/50] batch [240/319] time 0.085 (0.077) data 0.000 (0.003) loss 2.2572 (2.1663) ce_loss 1.1309 (1.1155) teacher_loss 0.9558 (0.9114) loss_zs_kd 0.9130 (0.9566) loss_oracle 0.8327 (0.8308) acc 56.2500 (57.4870) kd_loss 0.8851 (0.8395) lr 8.1262e-04 eta 0:08:16
epoch [30/50] batch [260/319] time 0.083 (0.077) data 0.000 (0.003) loss 2.1586 (2.1646) ce_loss 1.1641 (1.1183) teacher_loss 0.9552 (0.9119) loss_zs_kd 0.8127 (0.9499) loss_oracle 0.8204 (0.8300) acc 50.0000 (57.1995) kd_loss 0.7932 (0.8377) lr 8.1262e-04 eta 0:08:18
epoch [30/50] batch [280/319] time 0.090 (0.078) data 0.000 (0.003) loss 2.1660 (2.1616) ce_loss 1.0586 (1.1131) teacher_loss 0.9253 (0.9097) loss_zs_kd 0.8096 (0.9463) loss_oracle 0.8211 (0.8289) acc 56.2500 (57.3772) kd_loss 0.8302 (0.8374) lr 8.1262e-04 eta 0:08:22
epoch [30/50] batch [300/319] time 0.082 (0.080) data 0.000 (0.002) loss 2.4832 (2.1614) ce_loss 1.5146 (1.1121) teacher_loss 1.1997 (0.9094) loss_zs_kd 0.8892 (0.9431) loss_oracle 0.8174 (0.8285) acc 37.5000 (57.4479) kd_loss 0.8748 (0.8377) lr 8.1262e-04 eta 0:08:28
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,821
* accuracy: 64.4%
* error: 35.6%
* macro_f1: 56.3%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,348
* accuracy: 54.9%
* error: 45.1%
* macro_f1: 23.5%
******* Domain 2 best val acc:      64.4%, epoch: 30 *******
******* Domain 2 best val test acc: 54.9%, epoch: 30 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [31/50] batch [20/319] time 0.085 (0.120) data 0.000 (0.032) loss 1.9771 (2.0522) ce_loss 0.9717 (1.0146) teacher_loss 0.7404 (0.8082) loss_zs_kd 1.1202 (0.9442) loss_oracle 0.8420 (0.8315) acc 62.5000 (60.7812) kd_loss 0.8157 (0.8283) lr 7.5131e-04 eta 0:12:40
epoch [31/50] batch [40/319] time 0.080 (0.102) data 0.000 (0.016) loss 1.9959 (2.0775) ce_loss 1.0889 (1.0371) teacher_loss 0.8088 (0.8300) loss_zs_kd 0.8659 (0.9707) loss_oracle 0.8231 (0.8336) acc 56.2500 (60.0781) kd_loss 0.7756 (0.8307) lr 7.5131e-04 eta 0:10:46
epoch [31/50] batch [60/319] time 0.084 (0.099) data 0.001 (0.011) loss 2.1706 (2.1146) ce_loss 1.0996 (1.0642) teacher_loss 0.9201 (0.8715) loss_zs_kd 0.9413 (0.9599) loss_oracle 0.8101 (0.8302) acc 59.3750 (59.2708) kd_loss 0.8454 (0.8280) lr 7.5131e-04 eta 0:10:25
epoch [31/50] batch [80/319] time 0.082 (0.095) data 0.000 (0.008) loss 2.1026 (2.1226) ce_loss 1.3193 (1.0880) teacher_loss 0.9311 (0.8800) loss_zs_kd 0.8567 (0.9506) loss_oracle 0.7710 (0.8279) acc 43.7500 (58.0859) kd_loss 0.7860 (0.8286) lr 7.5131e-04 eta 0:09:57
epoch [31/50] batch [100/319] time 0.085 (0.092) data 0.000 (0.007) loss 2.1745 (2.1169) ce_loss 1.2178 (1.0880) teacher_loss 0.9212 (0.8742) loss_zs_kd 1.1462 (0.9509) loss_oracle 0.8588 (0.8298) acc 59.3750 (58.3438) kd_loss 0.8239 (0.8278) lr 7.5131e-04 eta 0:09:40
epoch [31/50] batch [120/319] time 0.092 (0.091) data 0.000 (0.006) loss 1.9235 (2.1296) ce_loss 1.0107 (1.0981) teacher_loss 0.6804 (0.8839) loss_zs_kd 0.8642 (0.9431) loss_oracle 0.8063 (0.8293) acc 50.0000 (57.7865) kd_loss 0.8399 (0.8310) lr 7.5131e-04 eta 0:09:31
epoch [31/50] batch [140/319] time 0.078 (0.090) data 0.000 (0.005) loss 2.0050 (2.1374) ce_loss 1.0693 (1.1078) teacher_loss 0.7604 (0.8909) loss_zs_kd 1.0934 (0.9441) loss_oracle 0.8270 (0.8295) acc 62.5000 (57.1429) kd_loss 0.8312 (0.8317) lr 7.5131e-04 eta 0:09:21
epoch [31/50] batch [160/319] time 0.077 (0.089) data 0.000 (0.004) loss 2.4342 (2.1417) ce_loss 1.0996 (1.1056) teacher_loss 1.1417 (0.8947) loss_zs_kd 1.0848 (0.9557) loss_oracle 0.7966 (0.8294) acc 59.3750 (57.3828) kd_loss 0.8943 (0.8323) lr 7.5131e-04 eta 0:09:13
epoch [31/50] batch [180/319] time 0.079 (0.088) data 0.000 (0.004) loss 2.4240 (2.1462) ce_loss 1.3613 (1.1108) teacher_loss 1.1545 (0.8993) loss_zs_kd 0.9582 (0.9607) loss_oracle 0.8324 (0.8293) acc 59.3750 (57.4306) kd_loss 0.8533 (0.8322) lr 7.5131e-04 eta 0:09:08
epoch [31/50] batch [200/319] time 0.107 (0.089) data 0.001 (0.003) loss 1.9978 (2.1472) ce_loss 1.1914 (1.1130) teacher_loss 0.8021 (0.8998) loss_zs_kd 0.9707 (0.9680) loss_oracle 0.8001 (0.8297) acc 53.1250 (57.3594) kd_loss 0.7957 (0.8325) lr 7.5131e-04 eta 0:09:11
epoch [31/50] batch [220/319] time 0.095 (0.089) data 0.000 (0.003) loss 2.0424 (2.1494) ce_loss 0.9844 (1.1123) teacher_loss 0.7681 (0.9018) loss_zs_kd 1.1572 (0.9693) loss_oracle 0.8446 (0.8302) acc 71.8750 (57.4148) kd_loss 0.8520 (0.8325) lr 7.5131e-04 eta 0:09:06
epoch [31/50] batch [240/319] time 0.071 (0.088) data 0.000 (0.003) loss 2.1202 (2.1475) ce_loss 1.1738 (1.1106) teacher_loss 0.8911 (0.9018) loss_zs_kd 0.6847 (0.9649) loss_oracle 0.8172 (0.8302) acc 56.2500 (57.4609) kd_loss 0.8205 (0.8307) lr 7.5131e-04 eta 0:09:02
epoch [31/50] batch [260/319] time 0.085 (0.088) data 0.000 (0.003) loss 2.1902 (2.1440) ce_loss 1.2588 (1.1085) teacher_loss 0.9333 (0.8974) loss_zs_kd 1.0939 (0.9647) loss_oracle 0.8591 (0.8308) acc 56.2500 (57.5601) kd_loss 0.8274 (0.8312) lr 7.5131e-04 eta 0:08:58
epoch [31/50] batch [280/319] time 0.079 (0.088) data 0.000 (0.003) loss 2.2192 (2.1490) ce_loss 1.1465 (1.1142) teacher_loss 0.9588 (0.9021) loss_zs_kd 1.0823 (0.9659) loss_oracle 0.8150 (0.8307) acc 40.6250 (57.1763) kd_loss 0.8530 (0.8316) lr 7.5131e-04 eta 0:08:54
epoch [31/50] batch [300/319] time 0.077 (0.088) data 0.000 (0.002) loss 1.7699 (2.1507) ce_loss 0.8208 (1.1154) teacher_loss 0.5490 (0.9044) loss_zs_kd 0.9339 (0.9663) loss_oracle 0.8140 (0.8310) acc 71.8750 (57.2396) kd_loss 0.8139 (0.8307) lr 7.5131e-04 eta 0:08:52
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,732
* accuracy: 62.4%
* error: 37.6%
* macro_f1: 54.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,375
* accuracy: 55.2%
* error: 44.8%
* macro_f1: 22.7%
******* Domain 2 best val acc:      64.4%, epoch: 30 *******
******* Domain 2 best val test acc: 54.9%, epoch: 30 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [32/50] batch [20/319] time 0.070 (0.117) data 0.000 (0.030) loss 2.2845 (2.1705) ce_loss 1.0674 (1.1302) teacher_loss 1.0334 (0.9253) loss_zs_kd 1.2290 (0.9959) loss_oracle 0.8185 (0.8371) acc 53.1250 (55.0000) kd_loss 0.8418 (0.8267) lr 6.9098e-04 eta 0:11:47
epoch [32/50] batch [40/319] time 0.078 (0.098) data 0.000 (0.015) loss 2.2927 (2.1527) ce_loss 1.1865 (1.1243) teacher_loss 1.0331 (0.9115) loss_zs_kd 0.8430 (0.9637) loss_oracle 0.8538 (0.8314) acc 53.1250 (56.6406) kd_loss 0.8327 (0.8255) lr 6.9098e-04 eta 0:09:50
epoch [32/50] batch [60/319] time 0.074 (0.091) data 0.001 (0.010) loss 2.0045 (2.1386) ce_loss 1.0322 (1.1117) teacher_loss 0.7142 (0.8903) loss_zs_kd 0.8899 (0.9888) loss_oracle 0.8291 (0.8316) acc 68.7500 (57.5521) kd_loss 0.8757 (0.8326) lr 6.9098e-04 eta 0:09:06
epoch [32/50] batch [80/319] time 0.077 (0.090) data 0.000 (0.008) loss 1.9551 (2.1417) ce_loss 1.0293 (1.1082) teacher_loss 0.6681 (0.8905) loss_zs_kd 1.0665 (0.9935) loss_oracle 0.8235 (0.8333) acc 53.1250 (57.3828) kd_loss 0.8752 (0.8346) lr 6.9098e-04 eta 0:08:56
epoch [32/50] batch [100/319] time 0.066 (0.087) data 0.000 (0.006) loss 1.9959 (2.1529) ce_loss 0.9829 (1.1192) teacher_loss 0.7301 (0.9007) loss_zs_kd 0.8542 (0.9844) loss_oracle 0.8505 (0.8340) acc 62.5000 (57.3125) kd_loss 0.8405 (0.8352) lr 6.9098e-04 eta 0:08:39
epoch [32/50] batch [120/319] time 0.084 (0.086) data 0.000 (0.005) loss 1.9403 (2.1416) ce_loss 1.1572 (1.1141) teacher_loss 0.7399 (0.8885) loss_zs_kd 1.0331 (0.9680) loss_oracle 0.8127 (0.8333) acc 59.3750 (57.5781) kd_loss 0.7940 (0.8364) lr 6.9098e-04 eta 0:08:28
epoch [32/50] batch [140/319] time 0.085 (0.085) data 0.000 (0.005) loss 2.1156 (2.1370) ce_loss 1.0986 (1.1122) teacher_loss 0.8445 (0.8849) loss_zs_kd 1.1297 (0.9605) loss_oracle 0.7926 (0.8332) acc 50.0000 (57.4777) kd_loss 0.8748 (0.8356) lr 6.9098e-04 eta 0:08:26
epoch [32/50] batch [160/319] time 0.083 (0.085) data 0.000 (0.004) loss 2.3862 (2.1411) ce_loss 1.2168 (1.1145) teacher_loss 1.1009 (0.8893) loss_zs_kd 0.8548 (0.9599) loss_oracle 0.8185 (0.8330) acc 53.1250 (57.5781) kd_loss 0.8761 (0.8354) lr 6.9098e-04 eta 0:08:23
epoch [32/50] batch [180/319] time 0.084 (0.085) data 0.000 (0.004) loss 2.4043 (2.1406) ce_loss 1.4463 (1.1136) teacher_loss 1.1279 (0.8892) loss_zs_kd 0.7746 (0.9589) loss_oracle 0.8597 (0.8334) acc 40.6250 (57.5521) kd_loss 0.8466 (0.8348) lr 6.9098e-04 eta 0:08:19
epoch [32/50] batch [200/319] time 0.073 (0.085) data 0.000 (0.003) loss 2.1322 (2.1427) ce_loss 1.0918 (1.1120) teacher_loss 0.8859 (0.8926) loss_zs_kd 0.8271 (0.9568) loss_oracle 0.8515 (0.8331) acc 53.1250 (57.6875) kd_loss 0.8206 (0.8335) lr 6.9098e-04 eta 0:08:16
epoch [32/50] batch [220/319] time 0.070 (0.084) data 0.000 (0.003) loss 2.2032 (2.1434) ce_loss 1.1406 (1.1086) teacher_loss 0.9486 (0.8937) loss_zs_kd 0.7310 (0.9473) loss_oracle 0.8603 (0.8330) acc 50.0000 (57.8267) kd_loss 0.8245 (0.8332) lr 6.9098e-04 eta 0:08:12
epoch [32/50] batch [240/319] time 0.080 (0.085) data 0.000 (0.003) loss 2.0387 (2.1488) ce_loss 0.9863 (1.1129) teacher_loss 0.8001 (0.8999) loss_zs_kd 0.7712 (0.9377) loss_oracle 0.8347 (0.8327) acc 62.5000 (57.5130) kd_loss 0.8212 (0.8326) lr 6.9098e-04 eta 0:08:14
epoch [32/50] batch [260/319] time 0.081 (0.085) data 0.000 (0.003) loss 2.1242 (2.1571) ce_loss 1.0332 (1.1168) teacher_loss 0.9027 (0.9081) loss_zs_kd 0.9615 (0.9339) loss_oracle 0.8383 (0.8327) acc 65.6250 (57.3798) kd_loss 0.8023 (0.8326) lr 6.9098e-04 eta 0:08:13
epoch [32/50] batch [280/319] time 0.080 (0.085) data 0.000 (0.002) loss 2.3258 (2.1647) ce_loss 1.3262 (1.1205) teacher_loss 1.0909 (0.9164) loss_zs_kd 0.8167 (0.9296) loss_oracle 0.7824 (0.8322) acc 56.2500 (57.2545) kd_loss 0.8437 (0.8322) lr 6.9098e-04 eta 0:08:11
epoch [32/50] batch [300/319] time 0.085 (0.085) data 0.000 (0.002) loss 2.1198 (2.1644) ce_loss 1.0195 (1.1160) teacher_loss 0.8544 (0.9167) loss_zs_kd 0.7525 (0.9326) loss_oracle 0.8131 (0.8326) acc 68.7500 (57.4271) kd_loss 0.8588 (0.8314) lr 6.9098e-04 eta 0:08:09
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,801
* accuracy: 64.0%
* error: 36.0%
* macro_f1: 56.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,793
* accuracy: 49.2%
* error: 50.8%
* macro_f1: 22.4%
******* Domain 2 best val acc:      64.4%, epoch: 30 *******
******* Domain 2 best val test acc: 54.9%, epoch: 30 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [33/50] batch [20/319] time 0.082 (0.138) data 0.000 (0.036) loss 2.4748 (2.2326) ce_loss 1.4385 (1.0919) teacher_loss 1.2198 (1.0042) loss_zs_kd 0.9210 (0.9299) loss_oracle 0.8242 (0.8288) acc 50.0000 (59.2188) kd_loss 0.8430 (0.8140) lr 6.3188e-04 eta 0:13:06
epoch [33/50] batch [40/319] time 0.082 (0.109) data 0.000 (0.018) loss 2.1526 (2.2281) ce_loss 1.0186 (1.0926) teacher_loss 0.8547 (0.9906) loss_zs_kd 0.9386 (0.9064) loss_oracle 0.8393 (0.8316) acc 62.5000 (60.0000) kd_loss 0.8783 (0.8217) lr 6.3188e-04 eta 0:10:23
epoch [33/50] batch [60/319] time 0.088 (0.101) data 0.001 (0.012) loss 1.6963 (2.2224) ce_loss 0.7993 (1.0949) teacher_loss 0.4697 (0.9834) loss_zs_kd 0.6869 (0.8920) loss_oracle 0.8225 (0.8320) acc 68.7500 (59.5833) kd_loss 0.8154 (0.8230) lr 6.3188e-04 eta 0:09:35
epoch [33/50] batch [80/319] time 0.092 (0.098) data 0.000 (0.009) loss 2.0592 (2.2018) ce_loss 1.0293 (1.0852) teacher_loss 0.8516 (0.9641) loss_zs_kd 1.0129 (0.8924) loss_oracle 0.7624 (0.8319) acc 62.5000 (60.1562) kd_loss 0.8264 (0.8218) lr 6.3188e-04 eta 0:09:12
epoch [33/50] batch [100/319] time 0.082 (0.095) data 0.000 (0.007) loss 2.2582 (2.1958) ce_loss 1.2354 (1.0901) teacher_loss 1.0515 (0.9588) loss_zs_kd 0.8067 (0.8861) loss_oracle 0.8599 (0.8325) acc 46.8750 (59.4062) kd_loss 0.7768 (0.8208) lr 6.3188e-04 eta 0:08:58
epoch [33/50] batch [120/319] time 0.086 (0.094) data 0.000 (0.006) loss 2.4511 (2.1922) ce_loss 1.2871 (1.0885) teacher_loss 1.1815 (0.9561) loss_zs_kd 0.8574 (0.8786) loss_oracle 0.8393 (0.8324) acc 53.1250 (59.0885) kd_loss 0.8500 (0.8199) lr 6.3188e-04 eta 0:08:47
epoch [33/50] batch [140/319] time 0.086 (0.092) data 0.000 (0.005) loss 2.1009 (2.1922) ce_loss 1.0508 (1.0825) teacher_loss 0.9032 (0.9552) loss_zs_kd 1.0594 (0.8781) loss_oracle 0.8179 (0.8311) acc 53.1250 (58.8616) kd_loss 0.7887 (0.8215) lr 6.3188e-04 eta 0:08:37
epoch [33/50] batch [160/319] time 0.084 (0.092) data 0.000 (0.005) loss 1.8126 (2.1933) ce_loss 0.7588 (1.0843) teacher_loss 0.5601 (0.9567) loss_zs_kd 0.7757 (0.8826) loss_oracle 0.8620 (0.8320) acc 75.0000 (58.6133) kd_loss 0.8214 (0.8206) lr 6.3188e-04 eta 0:08:31
epoch [33/50] batch [180/319] time 0.086 (0.091) data 0.000 (0.004) loss 2.4176 (2.2094) ce_loss 1.1162 (1.0965) teacher_loss 1.1511 (0.9711) loss_zs_kd 1.3369 (0.8755) loss_oracle 0.8431 (0.8328) acc 62.5000 (57.9688) kd_loss 0.8449 (0.8218) lr 6.3188e-04 eta 0:08:25
epoch [33/50] batch [200/319] time 0.097 (0.091) data 0.000 (0.004) loss 2.0887 (2.2077) ce_loss 0.9380 (1.0975) teacher_loss 0.8104 (0.9690) loss_zs_kd 1.2945 (0.8778) loss_oracle 0.8463 (0.8327) acc 59.3750 (58.0000) kd_loss 0.8552 (0.8223) lr 6.3188e-04 eta 0:08:21
epoch [33/50] batch [220/319] time 0.080 (0.090) data 0.000 (0.004) loss 1.9163 (2.2013) ce_loss 0.8984 (1.0943) teacher_loss 0.6813 (0.9650) loss_zs_kd 0.7518 (0.8710) loss_oracle 0.8496 (0.8320) acc 62.5000 (58.0256) kd_loss 0.8102 (0.8203) lr 6.3188e-04 eta 0:08:18
epoch [33/50] batch [240/319] time 0.087 (0.090) data 0.000 (0.003) loss 2.1742 (2.2018) ce_loss 1.0703 (1.0957) teacher_loss 0.9411 (0.9645) loss_zs_kd 0.9428 (0.8672) loss_oracle 0.8320 (0.8329) acc 62.5000 (57.8776) kd_loss 0.8171 (0.8210) lr 6.3188e-04 eta 0:08:15
epoch [33/50] batch [260/319] time 0.085 (0.090) data 0.000 (0.003) loss 2.2583 (2.2074) ce_loss 1.2080 (1.1020) teacher_loss 1.0447 (0.9706) loss_zs_kd 0.7004 (0.8613) loss_oracle 0.8570 (0.8332) acc 53.1250 (57.6683) kd_loss 0.7851 (0.8202) lr 6.3188e-04 eta 0:08:11
epoch [33/50] batch [280/319] time 0.088 (0.089) data 0.000 (0.003) loss 1.9388 (2.2041) ce_loss 0.7905 (1.0988) teacher_loss 0.6808 (0.9684) loss_zs_kd 0.7877 (0.8580) loss_oracle 0.8200 (0.8331) acc 68.7500 (57.7790) kd_loss 0.8481 (0.8191) lr 6.3188e-04 eta 0:08:08
epoch [33/50] batch [300/319] time 0.087 (0.089) data 0.000 (0.003) loss 1.9055 (2.2055) ce_loss 0.8027 (1.1022) teacher_loss 0.6749 (0.9698) loss_zs_kd 0.7202 (0.8543) loss_oracle 0.8532 (0.8329) acc 75.0000 (57.7083) kd_loss 0.8040 (0.8192) lr 6.3188e-04 eta 0:08:05
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,840
* accuracy: 64.9%
* error: 35.1%
* macro_f1: 56.9%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,890
* accuracy: 50.2%
* error: 49.8%
* macro_f1: 23.0%
******* Domain 2 best val acc:      64.9%, epoch: 33 *******
******* Domain 2 best val test acc: 50.2%, epoch: 33 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [34/50] batch [20/319] time 0.092 (0.125) data 0.000 (0.033) loss 2.5628 (2.2318) ce_loss 1.3643 (1.1197) teacher_loss 1.3618 (1.0052) loss_zs_kd 0.7640 (0.7971) loss_oracle 0.8415 (0.8431) acc 50.0000 (57.3438) kd_loss 0.7802 (0.8050) lr 5.7422e-04 eta 0:11:15
epoch [34/50] batch [40/319] time 0.080 (0.104) data 0.000 (0.017) loss 2.0625 (2.2204) ce_loss 1.0566 (1.1007) teacher_loss 0.8381 (0.9913) loss_zs_kd 0.6532 (0.8191) loss_oracle 0.8146 (0.8388) acc 53.1250 (57.5000) kd_loss 0.8171 (0.8096) lr 5.7422e-04 eta 0:09:21
epoch [34/50] batch [60/319] time 0.090 (0.099) data 0.001 (0.011) loss 2.2622 (2.1893) ce_loss 1.2412 (1.0793) teacher_loss 1.0684 (0.9607) loss_zs_kd 0.7674 (0.8315) loss_oracle 0.8084 (0.8347) acc 50.0000 (58.8021) kd_loss 0.7895 (0.8112) lr 5.7422e-04 eta 0:08:48
epoch [34/50] batch [80/319] time 0.078 (0.094) data 0.000 (0.008) loss 2.3448 (2.1822) ce_loss 1.2617 (1.0753) teacher_loss 1.0973 (0.9546) loss_zs_kd 0.9050 (0.8222) loss_oracle 0.8631 (0.8346) acc 59.3750 (58.9062) kd_loss 0.8160 (0.8103) lr 5.7422e-04 eta 0:08:23
epoch [34/50] batch [100/319] time 0.078 (0.092) data 0.000 (0.007) loss 2.2434 (2.1966) ce_loss 1.0322 (1.0781) teacher_loss 1.0206 (0.9686) loss_zs_kd 0.7955 (0.8341) loss_oracle 0.8520 (0.8346) acc 71.8750 (58.7812) kd_loss 0.7968 (0.8106) lr 5.7422e-04 eta 0:08:08
epoch [34/50] batch [120/319] time 0.087 (0.091) data 0.000 (0.006) loss 2.2373 (2.1894) ce_loss 1.1182 (1.0665) teacher_loss 1.0205 (0.9614) loss_zs_kd 0.8385 (0.8334) loss_oracle 0.8435 (0.8339) acc 56.2500 (59.0885) kd_loss 0.7950 (0.8110) lr 5.7422e-04 eta 0:08:00
epoch [34/50] batch [140/319] time 0.078 (0.090) data 0.000 (0.005) loss 2.4101 (2.1976) ce_loss 1.2549 (1.0706) teacher_loss 1.1557 (0.9682) loss_zs_kd 0.8120 (0.8375) loss_oracle 0.8607 (0.8342) acc 46.8750 (58.9062) kd_loss 0.8240 (0.8123) lr 5.7422e-04 eta 0:07:57
epoch [34/50] batch [160/319] time 0.076 (0.090) data 0.000 (0.004) loss 2.2667 (2.1994) ce_loss 1.1172 (1.0720) teacher_loss 1.0315 (0.9706) loss_zs_kd 0.9083 (0.8451) loss_oracle 0.8410 (0.8345) acc 59.3750 (59.1406) kd_loss 0.8146 (0.8116) lr 5.7422e-04 eta 0:07:51
epoch [34/50] batch [180/319] time 0.078 (0.090) data 0.000 (0.004) loss 2.2067 (2.2047) ce_loss 1.1494 (1.0760) teacher_loss 0.8925 (0.9750) loss_zs_kd 1.1225 (0.8551) loss_oracle 0.8485 (0.8338) acc 62.5000 (58.9236) kd_loss 0.8900 (0.8128) lr 5.7422e-04 eta 0:07:52
epoch [34/50] batch [200/319] time 0.076 (0.089) data 0.000 (0.004) loss 2.1115 (2.2161) ce_loss 1.0146 (1.0820) teacher_loss 0.9207 (0.9857) loss_zs_kd 0.6922 (0.8503) loss_oracle 0.8350 (0.8334) acc 65.6250 (58.6406) kd_loss 0.7733 (0.8137) lr 5.7422e-04 eta 0:07:47
epoch [34/50] batch [220/319] time 0.090 (0.089) data 0.000 (0.003) loss 2.1036 (2.2154) ce_loss 0.8149 (1.0802) teacher_loss 0.8110 (0.9843) loss_zs_kd 0.8813 (0.8509) loss_oracle 0.8188 (0.8339) acc 75.0000 (58.7500) kd_loss 0.8832 (0.8142) lr 5.7422e-04 eta 0:07:43
epoch [34/50] batch [240/319] time 0.081 (0.089) data 0.000 (0.003) loss 2.3614 (2.2152) ce_loss 1.2139 (1.0785) teacher_loss 1.1796 (0.9834) loss_zs_kd 0.9629 (0.8497) loss_oracle 0.8443 (0.8331) acc 56.2500 (58.9323) kd_loss 0.7597 (0.8152) lr 5.7422e-04 eta 0:07:39
epoch [34/50] batch [260/319] time 0.089 (0.088) data 0.000 (0.003) loss 1.8607 (2.2088) ce_loss 0.8193 (1.0742) teacher_loss 0.6361 (0.9765) loss_zs_kd 0.7700 (0.8476) loss_oracle 0.8566 (0.8328) acc 62.5000 (59.1827) kd_loss 0.7963 (0.8159) lr 5.7422e-04 eta 0:07:35
epoch [34/50] batch [280/319] time 0.093 (0.088) data 0.000 (0.003) loss 1.9922 (2.2045) ce_loss 0.7905 (1.0709) teacher_loss 0.7022 (0.9707) loss_zs_kd 1.0216 (0.8504) loss_oracle 0.7999 (0.8330) acc 81.2500 (59.1964) kd_loss 0.8901 (0.8173) lr 5.7422e-04 eta 0:07:32
epoch [34/50] batch [300/319] time 0.090 (0.088) data 0.000 (0.002) loss 2.1795 (2.2059) ce_loss 1.1016 (1.0725) teacher_loss 0.9631 (0.9710) loss_zs_kd 1.0364 (0.8547) loss_oracle 0.8110 (0.8328) acc 62.5000 (59.0938) kd_loss 0.8109 (0.8184) lr 5.7422e-04 eta 0:07:33
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,810
* accuracy: 64.2%
* error: 35.8%
* macro_f1: 56.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,723
* accuracy: 48.5%
* error: 51.5%
* macro_f1: 21.8%
******* Domain 2 best val acc:      64.9%, epoch: 33 *******
******* Domain 2 best val test acc: 50.2%, epoch: 33 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [35/50] batch [20/319] time 0.081 (0.118) data 0.000 (0.033) loss 2.2748 (2.2021) ce_loss 1.2197 (1.0494) teacher_loss 1.0271 (0.9693) loss_zs_kd 0.8472 (0.8383) loss_oracle 0.8370 (0.8298) acc 50.0000 (60.3125) kd_loss 0.8293 (0.8179) lr 5.1825e-04 eta 0:10:02
epoch [35/50] batch [40/319] time 0.082 (0.103) data 0.000 (0.016) loss 2.1344 (2.1894) ce_loss 0.9678 (1.0468) teacher_loss 0.9052 (0.9513) loss_zs_kd 0.9134 (0.8474) loss_oracle 0.8351 (0.8352) acc 65.6250 (60.4688) kd_loss 0.8117 (0.8205) lr 5.1825e-04 eta 0:08:41
epoch [35/50] batch [60/319] time 0.083 (0.098) data 0.001 (0.011) loss 2.2769 (2.2098) ce_loss 1.0654 (1.0681) teacher_loss 1.0015 (0.9691) loss_zs_kd 0.8258 (0.8362) loss_oracle 0.8398 (0.8348) acc 65.6250 (59.5833) kd_loss 0.8554 (0.8233) lr 5.1825e-04 eta 0:08:13
epoch [35/50] batch [80/319] time 0.082 (0.094) data 0.000 (0.008) loss 2.2182 (2.1986) ce_loss 1.1553 (1.0570) teacher_loss 1.0002 (0.9581) loss_zs_kd 0.8246 (0.8419) loss_oracle 0.8322 (0.8337) acc 59.3750 (60.0391) kd_loss 0.8019 (0.8237) lr 5.1825e-04 eta 0:07:53
epoch [35/50] batch [100/319] time 0.089 (0.093) data 0.000 (0.007) loss 2.3222 (2.1859) ce_loss 1.1670 (1.0502) teacher_loss 1.0671 (0.9428) loss_zs_kd 0.9840 (0.8424) loss_oracle 0.8583 (0.8349) acc 62.5000 (60.1875) kd_loss 0.8259 (0.8256) lr 5.1825e-04 eta 0:07:45
epoch [35/50] batch [120/319] time 0.087 (0.092) data 0.001 (0.006) loss 2.2964 (2.1849) ce_loss 1.0635 (1.0537) teacher_loss 1.1089 (0.9439) loss_zs_kd 0.9816 (0.8433) loss_oracle 0.8625 (0.8347) acc 68.7500 (60.0260) kd_loss 0.7562 (0.8236) lr 5.1825e-04 eta 0:07:37
epoch [35/50] batch [140/319] time 0.080 (0.091) data 0.000 (0.005) loss 2.0557 (2.1792) ce_loss 1.1377 (1.0477) teacher_loss 0.7425 (0.9370) loss_zs_kd 0.8226 (0.8447) loss_oracle 0.8220 (0.8348) acc 53.1250 (60.1116) kd_loss 0.9021 (0.8247) lr 5.1825e-04 eta 0:07:30
epoch [35/50] batch [160/319] time 0.081 (0.090) data 0.000 (0.004) loss 2.3081 (2.1784) ce_loss 1.1807 (1.0505) teacher_loss 1.1024 (0.9360) loss_zs_kd 0.9353 (0.8521) loss_oracle 0.8272 (0.8351) acc 50.0000 (59.7656) kd_loss 0.7921 (0.8249) lr 5.1825e-04 eta 0:07:27
epoch [35/50] batch [180/319] time 0.084 (0.090) data 0.000 (0.004) loss 2.2668 (2.1879) ce_loss 1.1963 (1.0616) teacher_loss 1.0123 (0.9460) loss_zs_kd 0.7473 (0.8541) loss_oracle 0.8376 (0.8345) acc 56.2500 (59.3056) kd_loss 0.8357 (0.8246) lr 5.1825e-04 eta 0:07:22
epoch [35/50] batch [200/319] time 0.090 (0.090) data 0.000 (0.004) loss 2.2028 (2.1966) ce_loss 1.0391 (1.0707) teacher_loss 0.9781 (0.9551) loss_zs_kd 0.6221 (0.8542) loss_oracle 0.8073 (0.8347) acc 62.5000 (59.1406) kd_loss 0.8210 (0.8241) lr 5.1825e-04 eta 0:07:19
epoch [35/50] batch [220/319] time 0.085 (0.089) data 0.000 (0.003) loss 2.5225 (2.1873) ce_loss 1.2773 (1.0653) teacher_loss 1.3141 (0.9465) loss_zs_kd 0.8037 (0.8551) loss_oracle 0.8255 (0.8344) acc 46.8750 (59.2898) kd_loss 0.7957 (0.8236) lr 5.1825e-04 eta 0:07:15
epoch [35/50] batch [240/319] time 0.083 (0.089) data 0.000 (0.003) loss 2.0511 (2.1883) ce_loss 1.0488 (1.0683) teacher_loss 0.7736 (0.9476) loss_zs_kd 0.8582 (0.8559) loss_oracle 0.8035 (0.8338) acc 53.1250 (59.2708) kd_loss 0.8758 (0.8238) lr 5.1825e-04 eta 0:07:11
epoch [35/50] batch [260/319] time 0.078 (0.089) data 0.000 (0.003) loss 1.8644 (2.1806) ce_loss 0.7607 (1.0661) teacher_loss 0.6039 (0.9402) loss_zs_kd 0.9086 (0.8586) loss_oracle 0.8346 (0.8336) acc 81.2500 (59.3149) kd_loss 0.8432 (0.8236) lr 5.1825e-04 eta 0:07:09
epoch [35/50] batch [280/319] time 0.086 (0.088) data 0.000 (0.003) loss 2.3043 (2.1823) ce_loss 1.1084 (1.0688) teacher_loss 0.9355 (0.9404) loss_zs_kd 1.0526 (0.8688) loss_oracle 0.8473 (0.8338) acc 59.3750 (59.2188) kd_loss 0.9451 (0.8249) lr 5.1825e-04 eta 0:07:05
epoch [35/50] batch [300/319] time 0.080 (0.088) data 0.000 (0.002) loss 1.9505 (2.1779) ce_loss 0.9888 (1.0672) teacher_loss 0.7441 (0.9365) loss_zs_kd 0.8935 (0.8753) loss_oracle 0.8069 (0.8335) acc 59.3750 (59.3229) kd_loss 0.8029 (0.8247) lr 5.1825e-04 eta 0:07:01
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,844
* accuracy: 65.0%
* error: 35.0%
* macro_f1: 57.8%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,224
* accuracy: 53.7%
* error: 46.3%
* macro_f1: 23.4%
******* Domain 2 best val acc:      65.0%, epoch: 35 *******
******* Domain 2 best val test acc: 53.7%, epoch: 35 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [36/50] batch [20/319] time 0.091 (0.127) data 0.000 (0.035) loss 2.1937 (2.2142) ce_loss 1.0479 (1.1117) teacher_loss 0.9707 (0.9605) loss_zs_kd 0.6765 (0.9261) loss_oracle 0.8283 (0.8365) acc 62.5000 (56.8750) kd_loss 0.8088 (0.8355) lr 4.6417e-04 eta 0:10:07
epoch [36/50] batch [40/319] time 0.063 (0.100) data 0.000 (0.018) loss 2.1689 (2.2249) ce_loss 1.0674 (1.1286) teacher_loss 0.9108 (0.9716) loss_zs_kd 0.8849 (0.9224) loss_oracle 0.8344 (0.8333) acc 56.2500 (55.9375) kd_loss 0.8409 (0.8367) lr 4.6417e-04 eta 0:07:52
epoch [36/50] batch [60/319] time 0.086 (0.093) data 0.001 (0.012) loss 2.1155 (2.1990) ce_loss 0.9995 (1.1021) teacher_loss 0.8797 (0.9544) loss_zs_kd 1.2220 (0.9152) loss_oracle 0.8465 (0.8330) acc 65.6250 (57.7083) kd_loss 0.8126 (0.8281) lr 4.6417e-04 eta 0:07:21
epoch [36/50] batch [80/319] time 0.072 (0.093) data 0.000 (0.009) loss 2.2186 (2.2086) ce_loss 1.0146 (1.1113) teacher_loss 0.9846 (0.9639) loss_zs_kd 0.9603 (0.8979) loss_oracle 0.8218 (0.8328) acc 59.3750 (56.7969) kd_loss 0.8231 (0.8283) lr 4.6417e-04 eta 0:07:17
epoch [36/50] batch [100/319] time 0.080 (0.091) data 0.000 (0.007) loss 2.0566 (2.1932) ce_loss 1.0986 (1.1028) teacher_loss 0.7663 (0.9517) loss_zs_kd 1.0910 (0.8882) loss_oracle 0.8530 (0.8312) acc 53.1250 (57.4062) kd_loss 0.8638 (0.8259) lr 4.6417e-04 eta 0:07:06
epoch [36/50] batch [120/319] time 0.091 (0.090) data 0.001 (0.006) loss 2.1327 (2.1892) ce_loss 0.9907 (1.0993) teacher_loss 0.9086 (0.9480) loss_zs_kd 0.9135 (0.8859) loss_oracle 0.8030 (0.8310) acc 62.5000 (57.7865) kd_loss 0.8227 (0.8257) lr 4.6417e-04 eta 0:07:00
epoch [36/50] batch [140/319] time 0.082 (0.090) data 0.000 (0.005) loss 2.2419 (2.1826) ce_loss 1.0342 (1.0908) teacher_loss 0.9829 (0.9412) loss_zs_kd 0.7529 (0.8909) loss_oracle 0.8376 (0.8303) acc 62.5000 (58.1696) kd_loss 0.8402 (0.8262) lr 4.6417e-04 eta 0:06:56
epoch [36/50] batch [160/319] time 0.082 (0.089) data 0.001 (0.005) loss 2.2234 (2.1768) ce_loss 0.9985 (1.0877) teacher_loss 0.9759 (0.9346) loss_zs_kd 0.7560 (0.8971) loss_oracle 0.8196 (0.8305) acc 65.6250 (58.2422) kd_loss 0.8376 (0.8269) lr 4.6417e-04 eta 0:06:50
epoch [36/50] batch [180/319] time 0.083 (0.088) data 0.000 (0.004) loss 2.3557 (2.1711) ce_loss 1.2832 (1.0843) teacher_loss 1.0599 (0.9280) loss_zs_kd 0.9788 (0.8957) loss_oracle 0.8557 (0.8310) acc 46.8750 (58.4896) kd_loss 0.8679 (0.8276) lr 4.6417e-04 eta 0:06:47
epoch [36/50] batch [200/319] time 0.094 (0.088) data 0.000 (0.004) loss 2.0820 (2.1699) ce_loss 0.9766 (1.0870) teacher_loss 0.8364 (0.9250) loss_zs_kd 0.8109 (0.8971) loss_oracle 0.8547 (0.8317) acc 62.5000 (58.6094) kd_loss 0.8182 (0.8290) lr 4.6417e-04 eta 0:06:44
epoch [36/50] batch [220/319] time 0.083 (0.088) data 0.000 (0.003) loss 2.1725 (2.1688) ce_loss 0.9551 (1.0858) teacher_loss 0.9449 (0.9235) loss_zs_kd 1.0670 (0.9066) loss_oracle 0.7877 (0.8316) acc 59.3750 (58.6506) kd_loss 0.8337 (0.8295) lr 4.6417e-04 eta 0:06:42
epoch [36/50] batch [240/319] time 0.080 (0.088) data 0.000 (0.003) loss 2.1088 (2.1692) ce_loss 1.0723 (1.0881) teacher_loss 0.8597 (0.9242) loss_zs_kd 1.1582 (0.9148) loss_oracle 0.8271 (0.8316) acc 53.1250 (58.5677) kd_loss 0.8356 (0.8292) lr 4.6417e-04 eta 0:06:39
epoch [36/50] batch [260/319] time 0.076 (0.088) data 0.000 (0.003) loss 2.2727 (2.1686) ce_loss 1.2793 (1.0880) teacher_loss 1.0408 (0.9244) loss_zs_kd 0.6780 (0.9149) loss_oracle 0.8212 (0.8317) acc 46.8750 (58.2212) kd_loss 0.8213 (0.8283) lr 4.6417e-04 eta 0:06:36
epoch [36/50] batch [280/319] time 0.084 (0.088) data 0.000 (0.003) loss 2.2440 (2.1652) ce_loss 1.3467 (1.0897) teacher_loss 0.9951 (0.9212) loss_zs_kd 0.8202 (0.9120) loss_oracle 0.8569 (0.8320) acc 46.8750 (58.0134) kd_loss 0.8204 (0.8279) lr 4.6417e-04 eta 0:06:35
epoch [36/50] batch [300/319] time 0.086 (0.088) data 0.000 (0.003) loss 2.3767 (2.1667) ce_loss 1.3613 (1.0891) teacher_loss 1.0797 (0.9216) loss_zs_kd 0.9479 (0.9150) loss_oracle 0.8436 (0.8324) acc 46.8750 (58.2083) kd_loss 0.8752 (0.8289) lr 4.6417e-04 eta 0:06:32
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,823
* accuracy: 64.5%
* error: 35.5%
* macro_f1: 57.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,011
* accuracy: 51.5%
* error: 48.5%
* macro_f1: 24.7%
******* Domain 2 best val acc:      65.0%, epoch: 35 *******
******* Domain 2 best val test acc: 53.7%, epoch: 35 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [37/50] batch [20/319] time 0.089 (0.121) data 0.000 (0.034) loss 2.1726 (2.1024) ce_loss 1.0283 (1.0552) teacher_loss 0.8969 (0.8571) loss_zs_kd 1.2290 (0.9227) loss_oracle 0.8102 (0.8362) acc 59.3750 (59.0625) kd_loss 0.8706 (0.8272) lr 4.1221e-04 eta 0:08:55
epoch [37/50] batch [40/319] time 0.097 (0.103) data 0.000 (0.017) loss 2.3390 (2.0957) ce_loss 1.3174 (1.0605) teacher_loss 1.0432 (0.8466) loss_zs_kd 0.8179 (0.9107) loss_oracle 0.8198 (0.8342) acc 59.3750 (60.2344) kd_loss 0.8859 (0.8320) lr 4.1221e-04 eta 0:07:34
epoch [37/50] batch [60/319] time 0.087 (0.099) data 0.001 (0.012) loss 1.9816 (2.1195) ce_loss 1.0381 (1.0802) teacher_loss 0.7258 (0.8706) loss_zs_kd 1.2427 (0.9178) loss_oracle 0.8409 (0.8340) acc 59.3750 (59.1146) kd_loss 0.8353 (0.8319) lr 4.1221e-04 eta 0:07:14
epoch [37/50] batch [80/319] time 0.092 (0.095) data 0.000 (0.009) loss 2.2165 (2.1362) ce_loss 1.3750 (1.0962) teacher_loss 0.8925 (0.8856) loss_zs_kd 0.9484 (0.9336) loss_oracle 0.8618 (0.8341) acc 43.7500 (58.3203) kd_loss 0.8931 (0.8335) lr 4.1221e-04 eta 0:06:57
epoch [37/50] batch [100/319] time 0.078 (0.093) data 0.000 (0.007) loss 2.1703 (2.1334) ce_loss 1.0977 (1.0903) teacher_loss 0.9596 (0.8782) loss_zs_kd 0.9317 (0.9387) loss_oracle 0.7934 (0.8331) acc 62.5000 (58.2500) kd_loss 0.8141 (0.8386) lr 4.1221e-04 eta 0:06:47
epoch [37/50] batch [120/319] time 0.084 (0.093) data 0.000 (0.006) loss 2.3198 (2.1393) ce_loss 1.2598 (1.0906) teacher_loss 0.9926 (0.8806) loss_zs_kd 1.0315 (0.9463) loss_oracle 0.8624 (0.8338) acc 56.2500 (58.5156) kd_loss 0.8961 (0.8418) lr 4.1221e-04 eta 0:06:45
epoch [37/50] batch [140/319] time 0.081 (0.092) data 0.000 (0.005) loss 1.8949 (2.1390) ce_loss 0.8999 (1.0892) teacher_loss 0.6227 (0.8786) loss_zs_kd 1.0557 (0.9586) loss_oracle 0.8419 (0.8336) acc 65.6250 (58.3259) kd_loss 0.8513 (0.8436) lr 4.1221e-04 eta 0:06:39
epoch [37/50] batch [160/319] time 0.081 (0.092) data 0.000 (0.005) loss 2.2686 (2.1442) ce_loss 1.1709 (1.0914) teacher_loss 1.0580 (0.8838) loss_zs_kd 1.0336 (0.9621) loss_oracle 0.7890 (0.8334) acc 46.8750 (58.1445) kd_loss 0.8161 (0.8437) lr 4.1221e-04 eta 0:06:34
epoch [37/50] batch [180/319] time 0.082 (0.091) data 0.000 (0.004) loss 2.0956 (2.1452) ce_loss 1.0830 (1.0938) teacher_loss 0.8462 (0.8834) loss_zs_kd 1.2921 (0.9671) loss_oracle 0.8404 (0.8340) acc 59.3750 (58.0035) kd_loss 0.8291 (0.8448) lr 4.1221e-04 eta 0:06:30
epoch [37/50] batch [200/319] time 0.088 (0.090) data 0.000 (0.004) loss 2.0435 (2.1418) ce_loss 1.0938 (1.0904) teacher_loss 0.7976 (0.8806) loss_zs_kd 0.9769 (0.9652) loss_oracle 0.8514 (0.8340) acc 59.3750 (58.2656) kd_loss 0.8202 (0.8442) lr 4.1221e-04 eta 0:06:26
epoch [37/50] batch [220/319] time 0.086 (0.090) data 0.000 (0.003) loss 2.3442 (2.1339) ce_loss 1.3184 (1.0855) teacher_loss 1.0681 (0.8743) loss_zs_kd 0.8973 (0.9580) loss_oracle 0.8336 (0.8337) acc 46.8750 (58.4375) kd_loss 0.8594 (0.8427) lr 4.1221e-04 eta 0:06:22
epoch [37/50] batch [240/319] time 0.094 (0.090) data 0.001 (0.003) loss 2.1176 (2.1307) ce_loss 1.0479 (1.0800) teacher_loss 0.8426 (0.8720) loss_zs_kd 0.8595 (0.9521) loss_oracle 0.8415 (0.8341) acc 59.3750 (58.4635) kd_loss 0.8542 (0.8417) lr 4.1221e-04 eta 0:06:20
epoch [37/50] batch [260/319] time 0.087 (0.090) data 0.000 (0.003) loss 2.2062 (2.1399) ce_loss 1.3125 (1.0874) teacher_loss 0.9758 (0.8824) loss_zs_kd 0.8294 (0.9459) loss_oracle 0.8552 (0.8342) acc 46.8750 (58.0889) kd_loss 0.8028 (0.8405) lr 4.1221e-04 eta 0:06:17
epoch [37/50] batch [280/319] time 0.093 (0.090) data 0.000 (0.003) loss 2.0988 (2.1406) ce_loss 0.9976 (1.0900) teacher_loss 0.8642 (0.8837) loss_zs_kd 0.7877 (0.9440) loss_oracle 0.8499 (0.8347) acc 65.6250 (58.0357) kd_loss 0.8096 (0.8396) lr 4.1221e-04 eta 0:06:15
epoch [37/50] batch [300/319] time 0.084 (0.089) data 0.000 (0.003) loss 1.9389 (2.1376) ce_loss 1.1211 (1.0882) teacher_loss 0.6520 (0.8807) loss_zs_kd 0.9699 (0.9439) loss_oracle 0.8412 (0.8350) acc 56.2500 (58.0938) kd_loss 0.8663 (0.8394) lr 4.1221e-04 eta 0:06:12
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,778
* accuracy: 63.5%
* error: 36.5%
* macro_f1: 56.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,520
* accuracy: 46.4%
* error: 53.6%
* macro_f1: 22.6%
******* Domain 2 best val acc:      65.0%, epoch: 35 *******
******* Domain 2 best val test acc: 53.7%, epoch: 35 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [38/50] batch [20/319] time 0.076 (0.113) data 0.000 (0.028) loss 2.1338 (2.1921) ce_loss 0.9795 (1.1204) teacher_loss 0.8855 (0.9284) loss_zs_kd 1.0759 (0.8780) loss_oracle 0.8235 (0.8380) acc 68.7500 (57.6562) kd_loss 0.8366 (0.8447) lr 3.6258e-04 eta 0:07:45
epoch [38/50] batch [40/319] time 0.074 (0.095) data 0.000 (0.014) loss 2.2264 (2.1759) ce_loss 1.1396 (1.0964) teacher_loss 0.9680 (0.9159) loss_zs_kd 0.6934 (0.8766) loss_oracle 0.8363 (0.8417) acc 59.3750 (58.1250) kd_loss 0.8403 (0.8392) lr 3.6258e-04 eta 0:06:31
epoch [38/50] batch [60/319] time 0.071 (0.087) data 0.001 (0.010) loss 2.4533 (2.1925) ce_loss 1.2041 (1.1222) teacher_loss 1.2120 (0.9374) loss_zs_kd 1.0257 (0.8745) loss_oracle 0.8316 (0.8382) acc 65.6250 (57.0312) kd_loss 0.8255 (0.8360) lr 3.6258e-04 eta 0:05:56
epoch [38/50] batch [80/319] time 0.065 (0.082) data 0.000 (0.007) loss 2.2180 (2.1792) ce_loss 1.3125 (1.1092) teacher_loss 0.9793 (0.9236) loss_zs_kd 1.1750 (0.8832) loss_oracle 0.8191 (0.8379) acc 50.0000 (57.4219) kd_loss 0.8292 (0.8366) lr 3.6258e-04 eta 0:05:33
epoch [38/50] batch [100/319] time 0.071 (0.079) data 0.000 (0.006) loss 2.0478 (2.1669) ce_loss 1.0410 (1.1017) teacher_loss 0.8193 (0.9131) loss_zs_kd 1.0998 (0.8987) loss_oracle 0.8468 (0.8369) acc 62.5000 (57.9688) kd_loss 0.8051 (0.8353) lr 3.6258e-04 eta 0:05:18
epoch [38/50] batch [120/319] time 0.077 (0.079) data 0.000 (0.005) loss 2.1182 (2.1612) ce_loss 0.8789 (1.0990) teacher_loss 0.8529 (0.9079) loss_zs_kd 0.9606 (0.8970) loss_oracle 0.8220 (0.8370) acc 65.6250 (58.2292) kd_loss 0.8542 (0.8348) lr 3.6258e-04 eta 0:05:17
epoch [38/50] batch [140/319] time 0.082 (0.079) data 0.000 (0.004) loss 2.2278 (2.1680) ce_loss 1.2422 (1.1064) teacher_loss 1.0716 (0.9164) loss_zs_kd 0.9508 (0.9003) loss_oracle 0.8215 (0.8373) acc 56.2500 (57.9018) kd_loss 0.7454 (0.8329) lr 3.6258e-04 eta 0:05:18
epoch [38/50] batch [160/319] time 0.072 (0.080) data 0.000 (0.004) loss 2.0080 (2.1646) ce_loss 1.0703 (1.1048) teacher_loss 0.7220 (0.9142) loss_zs_kd 0.7188 (0.8970) loss_oracle 0.8381 (0.8372) acc 62.5000 (57.9297) kd_loss 0.8669 (0.8319) lr 3.6258e-04 eta 0:05:17
epoch [38/50] batch [180/319] time 0.078 (0.080) data 0.000 (0.003) loss 2.1819 (2.1675) ce_loss 1.0234 (1.1088) teacher_loss 0.8938 (0.9152) loss_zs_kd 0.9466 (0.8956) loss_oracle 0.7990 (0.8369) acc 59.3750 (57.5868) kd_loss 0.8886 (0.8339) lr 3.6258e-04 eta 0:05:16
epoch [38/50] batch [200/319] time 0.079 (0.080) data 0.000 (0.003) loss 2.1463 (2.1656) ce_loss 1.1309 (1.1142) teacher_loss 0.9126 (0.9129) loss_zs_kd 0.9586 (0.9033) loss_oracle 0.8132 (0.8364) acc 46.8750 (57.0781) kd_loss 0.8270 (0.8345) lr 3.6258e-04 eta 0:05:17
epoch [38/50] batch [220/319] time 0.090 (0.081) data 0.000 (0.003) loss 2.3437 (2.1620) ce_loss 1.1172 (1.1106) teacher_loss 1.1016 (0.9101) loss_zs_kd 0.8141 (0.9065) loss_oracle 0.8621 (0.8365) acc 65.6250 (57.0597) kd_loss 0.8110 (0.8336) lr 3.6258e-04 eta 0:05:17
epoch [38/50] batch [240/319] time 0.080 (0.081) data 0.000 (0.003) loss 1.9287 (2.1559) ce_loss 0.9507 (1.1031) teacher_loss 0.6859 (0.9036) loss_zs_kd 0.7374 (0.9101) loss_oracle 0.8141 (0.8367) acc 56.2500 (57.2005) kd_loss 0.8357 (0.8340) lr 3.6258e-04 eta 0:05:16
epoch [38/50] batch [260/319] time 0.088 (0.081) data 0.000 (0.002) loss 2.4607 (2.1553) ce_loss 1.5264 (1.1042) teacher_loss 1.2020 (0.9041) loss_zs_kd 1.1590 (0.9118) loss_oracle 0.8213 (0.8359) acc 40.6250 (57.1755) kd_loss 0.8481 (0.8332) lr 3.6258e-04 eta 0:05:15
epoch [38/50] batch [280/319] time 0.085 (0.081) data 0.000 (0.002) loss 1.9375 (2.1513) ce_loss 0.9092 (1.1041) teacher_loss 0.6721 (0.8997) loss_zs_kd 0.9250 (0.9132) loss_oracle 0.8366 (0.8354) acc 62.5000 (57.0982) kd_loss 0.8471 (0.8338) lr 3.6258e-04 eta 0:05:14
epoch [38/50] batch [300/319] time 0.083 (0.082) data 0.000 (0.002) loss 2.4361 (2.1544) ce_loss 1.3984 (1.1051) teacher_loss 1.1602 (0.9016) loss_zs_kd 1.0054 (0.9160) loss_oracle 0.8372 (0.8352) acc 53.1250 (57.1771) kd_loss 0.8572 (0.8352) lr 3.6258e-04 eta 0:05:14
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,842
* accuracy: 64.9%
* error: 35.1%
* macro_f1: 57.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,217
* accuracy: 53.6%
* error: 46.4%
* macro_f1: 23.7%
******* Domain 2 best val acc:      65.0%, epoch: 35 *******
******* Domain 2 best val test acc: 53.7%, epoch: 35 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [39/50] batch [20/319] time 0.081 (0.117) data 0.000 (0.027) loss 2.1106 (2.1412) ce_loss 0.9390 (1.0386) teacher_loss 0.8729 (0.8789) loss_zs_kd 0.9794 (0.9183) loss_oracle 0.8489 (0.8359) acc 62.5000 (64.5312) kd_loss 0.8132 (0.8444) lr 3.1545e-04 eta 0:07:25
epoch [39/50] batch [40/319] time 0.090 (0.099) data 0.000 (0.014) loss 2.3783 (2.1412) ce_loss 1.3418 (1.0572) teacher_loss 1.1206 (0.8787) loss_zs_kd 0.8968 (0.9390) loss_oracle 0.8461 (0.8348) acc 53.1250 (61.7188) kd_loss 0.8346 (0.8451) lr 3.1545e-04 eta 0:06:15
epoch [39/50] batch [60/319] time 0.082 (0.094) data 0.000 (0.009) loss 1.9649 (2.1334) ce_loss 0.8809 (1.0637) teacher_loss 0.7566 (0.8725) loss_zs_kd 0.7695 (0.9326) loss_oracle 0.8116 (0.8333) acc 59.3750 (60.8333) kd_loss 0.8025 (0.8442) lr 3.1545e-04 eta 0:05:55
epoch [39/50] batch [80/319] time 0.084 (0.092) data 0.000 (0.007) loss 2.2045 (2.1414) ce_loss 1.1533 (1.0724) teacher_loss 0.9143 (0.8845) loss_zs_kd 1.1404 (0.9353) loss_oracle 0.8424 (0.8325) acc 65.6250 (59.8047) kd_loss 0.8690 (0.8407) lr 3.1545e-04 eta 0:05:44
epoch [39/50] batch [100/319] time 0.096 (0.090) data 0.000 (0.006) loss 2.5549 (2.1466) ce_loss 1.4141 (1.0781) teacher_loss 1.3079 (0.8923) loss_zs_kd 0.8475 (0.9186) loss_oracle 0.8580 (0.8328) acc 46.8750 (59.3438) kd_loss 0.8179 (0.8379) lr 3.1545e-04 eta 0:05:37
epoch [39/50] batch [120/319] time 0.077 (0.089) data 0.000 (0.005) loss 2.3663 (2.1402) ce_loss 1.2148 (1.0751) teacher_loss 1.1383 (0.8840) loss_zs_kd 0.6388 (0.9076) loss_oracle 0.8209 (0.8341) acc 68.7500 (59.5833) kd_loss 0.8177 (0.8392) lr 3.1545e-04 eta 0:05:30
epoch [39/50] batch [140/319] time 0.081 (0.088) data 0.001 (0.004) loss 1.9795 (2.1408) ce_loss 0.9253 (1.0753) teacher_loss 0.6749 (0.8816) loss_zs_kd 1.1848 (0.9105) loss_oracle 0.8280 (0.8344) acc 65.6250 (59.7321) kd_loss 0.8906 (0.8419) lr 3.1545e-04 eta 0:05:26
epoch [39/50] batch [160/319] time 0.087 (0.088) data 0.000 (0.004) loss 2.0277 (2.1354) ce_loss 0.8994 (1.0701) teacher_loss 0.7415 (0.8755) loss_zs_kd 1.1554 (0.9125) loss_oracle 0.8432 (0.8350) acc 62.5000 (59.6094) kd_loss 0.8646 (0.8424) lr 3.1545e-04 eta 0:05:22
epoch [39/50] batch [180/319] time 0.087 (0.088) data 0.000 (0.003) loss 1.9887 (2.1366) ce_loss 1.1504 (1.0735) teacher_loss 0.7046 (0.8759) loss_zs_kd 0.9367 (0.9134) loss_oracle 0.8607 (0.8351) acc 53.1250 (59.1840) kd_loss 0.8537 (0.8431) lr 3.1545e-04 eta 0:05:19
epoch [39/50] batch [200/319] time 0.161 (0.088) data 0.000 (0.003) loss 1.8977 (2.1315) ce_loss 0.9292 (1.0719) teacher_loss 0.5891 (0.8717) loss_zs_kd 0.8064 (0.9153) loss_oracle 0.8307 (0.8350) acc 71.8750 (59.2188) kd_loss 0.8933 (0.8423) lr 3.1545e-04 eta 0:05:19
epoch [39/50] batch [220/319] time 0.092 (0.088) data 0.000 (0.003) loss 2.1098 (2.1306) ce_loss 1.0137 (1.0688) teacher_loss 0.7668 (0.8699) loss_zs_kd 1.0915 (0.9236) loss_oracle 0.8435 (0.8347) acc 68.7500 (59.5028) kd_loss 0.9213 (0.8434) lr 3.1545e-04 eta 0:05:18
epoch [39/50] batch [240/319] time 0.086 (0.088) data 0.000 (0.003) loss 2.3468 (2.1357) ce_loss 1.3418 (1.0742) teacher_loss 1.0711 (0.8749) loss_zs_kd 1.0471 (0.9317) loss_oracle 0.8007 (0.8349) acc 40.6250 (59.4141) kd_loss 0.8753 (0.8434) lr 3.1545e-04 eta 0:05:16
epoch [39/50] batch [260/319] time 0.090 (0.088) data 0.000 (0.002) loss 2.0585 (2.1371) ce_loss 0.9351 (1.0737) teacher_loss 0.8341 (0.8760) loss_zs_kd 0.9563 (0.9362) loss_oracle 0.8350 (0.8345) acc 65.6250 (59.4712) kd_loss 0.8069 (0.8439) lr 3.1545e-04 eta 0:05:15
epoch [39/50] batch [280/319] time 0.081 (0.088) data 0.000 (0.002) loss 2.4322 (2.1372) ce_loss 1.4619 (1.0780) teacher_loss 1.1857 (0.8759) loss_zs_kd 0.9717 (0.9398) loss_oracle 0.8293 (0.8346) acc 53.1250 (59.3527) kd_loss 0.8318 (0.8441) lr 3.1545e-04 eta 0:05:13
epoch [39/50] batch [300/319] time 0.087 (0.088) data 0.000 (0.002) loss 2.1820 (2.1398) ce_loss 1.1367 (1.0809) teacher_loss 0.9258 (0.8783) loss_zs_kd 1.3764 (0.9476) loss_oracle 0.8614 (0.8347) acc 53.1250 (59.1146) kd_loss 0.8255 (0.8441) lr 3.1545e-04 eta 0:05:10
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,822
* accuracy: 64.5%
* error: 35.5%
* macro_f1: 56.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,006
* accuracy: 51.4%
* error: 48.6%
* macro_f1: 22.5%
******* Domain 2 best val acc:      65.0%, epoch: 35 *******
******* Domain 2 best val test acc: 53.7%, epoch: 35 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [40/50] batch [20/319] time 0.079 (0.125) data 0.000 (0.034) loss 2.2104 (2.1008) ce_loss 1.0732 (1.0247) teacher_loss 0.8893 (0.8355) loss_zs_kd 0.7697 (0.9281) loss_oracle 0.8578 (0.8361) acc 59.3750 (61.7188) kd_loss 0.8922 (0.8472) lr 2.7103e-04 eta 0:07:15
epoch [40/50] batch [40/319] time 0.089 (0.106) data 0.000 (0.017) loss 2.0992 (2.1371) ce_loss 0.9800 (1.0880) teacher_loss 0.7775 (0.8676) loss_zs_kd 0.8192 (0.9493) loss_oracle 0.8538 (0.8321) acc 62.5000 (58.6719) kd_loss 0.8948 (0.8535) lr 2.7103e-04 eta 0:06:08
epoch [40/50] batch [60/319] time 0.080 (0.100) data 0.001 (0.012) loss 2.1593 (2.1442) ce_loss 1.1592 (1.0924) teacher_loss 0.8517 (0.8719) loss_zs_kd 0.9114 (0.9638) loss_oracle 0.8628 (0.8364) acc 56.2500 (58.5417) kd_loss 0.8762 (0.8541) lr 2.7103e-04 eta 0:05:43
epoch [40/50] batch [80/319] time 0.083 (0.096) data 0.000 (0.009) loss 1.9613 (2.1149) ce_loss 0.9917 (1.0737) teacher_loss 0.7278 (0.8444) loss_zs_kd 0.8821 (0.9721) loss_oracle 0.8326 (0.8349) acc 56.2500 (59.0234) kd_loss 0.8172 (0.8531) lr 2.7103e-04 eta 0:05:28
epoch [40/50] batch [100/319] time 0.075 (0.093) data 0.000 (0.007) loss 2.1698 (2.1162) ce_loss 0.9980 (1.0782) teacher_loss 0.9093 (0.8484) loss_zs_kd 0.7033 (0.9627) loss_oracle 0.8168 (0.8343) acc 62.5000 (58.8750) kd_loss 0.8521 (0.8506) lr 2.7103e-04 eta 0:05:17
epoch [40/50] batch [120/319] time 0.094 (0.092) data 0.000 (0.006) loss 1.8950 (2.1110) ce_loss 0.9058 (1.0696) teacher_loss 0.5849 (0.8430) loss_zs_kd 1.1512 (0.9690) loss_oracle 0.8576 (0.8341) acc 59.3750 (58.9583) kd_loss 0.8813 (0.8509) lr 2.7103e-04 eta 0:05:11
epoch [40/50] batch [140/319] time 0.078 (0.092) data 0.000 (0.005) loss 2.2195 (2.1188) ce_loss 1.1055 (1.0777) teacher_loss 0.9055 (0.8511) loss_zs_kd 0.9590 (0.9661) loss_oracle 0.8127 (0.8343) acc 62.5000 (58.8616) kd_loss 0.9077 (0.8505) lr 2.7103e-04 eta 0:05:08
epoch [40/50] batch [160/319] time 0.086 (0.090) data 0.000 (0.004) loss 2.1602 (2.1168) ce_loss 1.1357 (1.0747) teacher_loss 0.8768 (0.8483) loss_zs_kd 0.9700 (0.9734) loss_oracle 0.8368 (0.8340) acc 50.0000 (58.8867) kd_loss 0.8650 (0.8516) lr 2.7103e-04 eta 0:05:00
epoch [40/50] batch [180/319] time 0.084 (0.089) data 0.000 (0.004) loss 2.4006 (2.1203) ce_loss 1.4072 (1.0748) teacher_loss 1.1120 (0.8505) loss_zs_kd 0.8755 (0.9725) loss_oracle 0.8408 (0.8346) acc 53.1250 (58.7847) kd_loss 0.8682 (0.8524) lr 2.7103e-04 eta 0:04:56
epoch [40/50] batch [200/319] time 0.083 (0.088) data 0.000 (0.004) loss 2.0256 (2.1336) ce_loss 1.0469 (1.0841) teacher_loss 0.7869 (0.8619) loss_zs_kd 0.8344 (0.9670) loss_oracle 0.8377 (0.8355) acc 65.6250 (58.4375) kd_loss 0.8199 (0.8539) lr 2.7103e-04 eta 0:04:52
epoch [40/50] batch [220/319] time 0.083 (0.088) data 0.000 (0.003) loss 2.2306 (2.1377) ce_loss 1.2773 (1.0888) teacher_loss 0.9108 (0.8654) loss_zs_kd 1.0763 (0.9654) loss_oracle 0.8419 (0.8361) acc 43.7500 (58.3523) kd_loss 0.8989 (0.8543) lr 2.7103e-04 eta 0:04:49
epoch [40/50] batch [240/319] time 0.092 (0.088) data 0.000 (0.003) loss 2.3840 (2.1397) ce_loss 1.2178 (1.0868) teacher_loss 1.0966 (0.8663) loss_zs_kd 0.8835 (0.9652) loss_oracle 0.8600 (0.8361) acc 53.1250 (58.5677) kd_loss 0.8574 (0.8553) lr 2.7103e-04 eta 0:04:47
epoch [40/50] batch [260/319] time 0.075 (0.088) data 0.000 (0.003) loss 2.1166 (2.1413) ce_loss 1.2168 (1.0879) teacher_loss 0.8963 (0.8684) loss_zs_kd 1.0815 (0.9660) loss_oracle 0.8545 (0.8358) acc 53.1250 (58.4856) kd_loss 0.7931 (0.8550) lr 2.7103e-04 eta 0:04:45
epoch [40/50] batch [280/319] time 0.088 (0.088) data 0.000 (0.003) loss 2.2098 (2.1463) ce_loss 1.1455 (1.0883) teacher_loss 0.9491 (0.8730) loss_zs_kd 0.7500 (0.9617) loss_oracle 0.8088 (0.8354) acc 59.3750 (58.4040) kd_loss 0.8563 (0.8556) lr 2.7103e-04 eta 0:04:42
epoch [40/50] batch [300/319] time 0.081 (0.087) data 0.000 (0.003) loss 2.3857 (2.1504) ce_loss 1.1973 (1.0908) teacher_loss 1.1306 (0.8764) loss_zs_kd 0.8547 (0.9598) loss_oracle 0.8221 (0.8356) acc 56.2500 (58.3958) kd_loss 0.8441 (0.8562) lr 2.7103e-04 eta 0:04:40
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,821
* accuracy: 64.4%
* error: 35.6%
* macro_f1: 56.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,187
* accuracy: 53.3%
* error: 46.7%
* macro_f1: 23.0%
******* Domain 2 best val acc:      65.0%, epoch: 35 *******
******* Domain 2 best val test acc: 53.7%, epoch: 35 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [41/50] batch [20/319] time 0.081 (0.117) data 0.000 (0.032) loss 2.0823 (2.1346) ce_loss 0.9688 (1.0735) teacher_loss 0.8693 (0.8528) loss_zs_kd 1.1017 (0.9969) loss_oracle 0.8338 (0.8424) acc 68.7500 (57.8125) kd_loss 0.7961 (0.8606) lr 2.2949e-04 eta 0:06:10
epoch [41/50] batch [40/319] time 0.094 (0.103) data 0.000 (0.016) loss 2.2199 (2.1333) ce_loss 1.1230 (1.0849) teacher_loss 1.0141 (0.8597) loss_zs_kd 1.3126 (0.9865) loss_oracle 0.8414 (0.8364) acc 65.6250 (58.7500) kd_loss 0.7851 (0.8555) lr 2.2949e-04 eta 0:05:25
epoch [41/50] batch [60/319] time 0.086 (0.098) data 0.001 (0.011) loss 2.2232 (2.1455) ce_loss 1.1270 (1.0904) teacher_loss 0.9031 (0.8681) loss_zs_kd 0.9250 (0.9818) loss_oracle 0.8545 (0.8364) acc 59.3750 (58.1250) kd_loss 0.8928 (0.8592) lr 2.2949e-04 eta 0:05:06
epoch [41/50] batch [80/319] time 0.080 (0.095) data 0.000 (0.008) loss 1.9667 (2.1445) ce_loss 1.0752 (1.0882) teacher_loss 0.7087 (0.8641) loss_zs_kd 1.1647 (0.9987) loss_oracle 0.8156 (0.8377) acc 53.1250 (58.7500) kd_loss 0.8502 (0.8615) lr 2.2949e-04 eta 0:04:54
epoch [41/50] batch [100/319] time 0.079 (0.092) data 0.000 (0.007) loss 2.0732 (2.1458) ce_loss 0.9233 (1.0905) teacher_loss 0.7671 (0.8661) loss_zs_kd 0.9927 (1.0014) loss_oracle 0.8313 (0.8367) acc 62.5000 (58.9062) kd_loss 0.8904 (0.8614) lr 2.2949e-04 eta 0:04:45
epoch [41/50] batch [120/319] time 0.085 (0.091) data 0.000 (0.006) loss 1.8484 (2.1532) ce_loss 0.9775 (1.0919) teacher_loss 0.5735 (0.8724) loss_zs_kd 0.8626 (1.0014) loss_oracle 0.8368 (0.8366) acc 65.6250 (58.6979) kd_loss 0.8565 (0.8625) lr 2.2949e-04 eta 0:04:39
epoch [41/50] batch [140/319] time 0.076 (0.090) data 0.000 (0.005) loss 1.8996 (2.1486) ce_loss 0.8379 (1.0847) teacher_loss 0.6349 (0.8695) loss_zs_kd 0.9562 (0.9981) loss_oracle 0.8528 (0.8345) acc 68.7500 (59.3304) kd_loss 0.8383 (0.8618) lr 2.2949e-04 eta 0:04:35
epoch [41/50] batch [160/319] time 0.087 (0.090) data 0.000 (0.004) loss 2.1608 (2.1506) ce_loss 1.1289 (1.0858) teacher_loss 0.8802 (0.8750) loss_zs_kd 0.8720 (0.9928) loss_oracle 0.8579 (0.8349) acc 56.2500 (59.0625) kd_loss 0.8517 (0.8582) lr 2.2949e-04 eta 0:04:32
epoch [41/50] batch [180/319] time 0.085 (0.090) data 0.000 (0.004) loss 1.9000 (2.1482) ce_loss 1.0430 (1.0852) teacher_loss 0.6698 (0.8729) loss_zs_kd 0.9848 (0.9910) loss_oracle 0.8053 (0.8352) acc 59.3750 (59.1146) kd_loss 0.8275 (0.8577) lr 2.2949e-04 eta 0:04:30
epoch [41/50] batch [200/319] time 0.092 (0.089) data 0.001 (0.004) loss 1.9733 (2.1424) ce_loss 1.0010 (1.0797) teacher_loss 0.6781 (0.8681) loss_zs_kd 0.9480 (0.9850) loss_oracle 0.8609 (0.8344) acc 59.3750 (59.2188) kd_loss 0.8648 (0.8571) lr 2.2949e-04 eta 0:04:27
epoch [41/50] batch [220/319] time 0.083 (0.089) data 0.000 (0.003) loss 2.1958 (2.1407) ce_loss 1.3057 (1.0758) teacher_loss 0.8906 (0.8663) loss_zs_kd 0.9416 (0.9854) loss_oracle 0.8611 (0.8346) acc 53.1250 (59.3608) kd_loss 0.8747 (0.8571) lr 2.2949e-04 eta 0:04:23
epoch [41/50] batch [240/319] time 0.076 (0.088) data 0.000 (0.003) loss 2.0774 (2.1417) ce_loss 1.0527 (1.0764) teacher_loss 0.8574 (0.8683) loss_zs_kd 0.7771 (0.9841) loss_oracle 0.8151 (0.8348) acc 50.0000 (59.2969) kd_loss 0.8124 (0.8560) lr 2.2949e-04 eta 0:04:20
epoch [41/50] batch [260/319] time 0.083 (0.088) data 0.000 (0.003) loss 2.2061 (2.1436) ce_loss 1.0977 (1.0787) teacher_loss 0.9503 (0.8715) loss_zs_kd 0.9650 (0.9782) loss_oracle 0.8453 (0.8346) acc 56.2500 (59.0625) kd_loss 0.8332 (0.8549) lr 2.2949e-04 eta 0:04:17
epoch [41/50] batch [280/319] time 0.078 (0.088) data 0.001 (0.003) loss 2.1463 (2.1469) ce_loss 0.9531 (1.0824) teacher_loss 0.8868 (0.8749) loss_zs_kd 0.9025 (0.9786) loss_oracle 0.8580 (0.8345) acc 65.6250 (58.7723) kd_loss 0.8305 (0.8548) lr 2.2949e-04 eta 0:04:14
epoch [41/50] batch [300/319] time 0.090 (0.088) data 0.000 (0.002) loss 2.2527 (2.1449) ce_loss 1.0361 (1.0808) teacher_loss 0.9536 (0.8737) loss_zs_kd 0.8306 (0.9749) loss_oracle 0.8409 (0.8344) acc 65.6250 (58.7917) kd_loss 0.8786 (0.8539) lr 2.2949e-04 eta 0:04:13
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,852
* accuracy: 65.1%
* error: 34.9%
* macro_f1: 56.4%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,010
* accuracy: 51.5%
* error: 48.5%
* macro_f1: 22.5%
******* Domain 2 best val acc:      65.1%, epoch: 41 *******
******* Domain 2 best val test acc: 51.5%, epoch: 41 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [42/50] batch [20/319] time 0.077 (0.123) data 0.000 (0.031) loss 2.2346 (2.1786) ce_loss 1.2266 (1.1039) teacher_loss 0.9367 (0.9023) loss_zs_kd 1.2131 (0.8962) loss_oracle 0.8608 (0.8348) acc 53.1250 (57.0312) kd_loss 0.8675 (0.8589) lr 1.9098e-04 eta 0:05:50
epoch [42/50] batch [40/319] time 0.067 (0.100) data 0.000 (0.016) loss 1.7984 (2.1732) ce_loss 0.8208 (1.0997) teacher_loss 0.5593 (0.9040) loss_zs_kd 0.8637 (0.9116) loss_oracle 0.8394 (0.8326) acc 71.8750 (58.2031) kd_loss 0.8194 (0.8529) lr 1.9098e-04 eta 0:04:42
epoch [42/50] batch [60/319] time 0.090 (0.095) data 0.001 (0.011) loss 2.2095 (2.1753) ce_loss 1.0498 (1.1028) teacher_loss 0.9387 (0.9105) loss_zs_kd 0.8884 (0.9162) loss_oracle 0.8319 (0.8328) acc 59.3750 (58.0208) kd_loss 0.8548 (0.8484) lr 1.9098e-04 eta 0:04:26
epoch [42/50] batch [80/319] time 0.077 (0.092) data 0.000 (0.008) loss 2.1322 (2.1669) ce_loss 1.2451 (1.1015) teacher_loss 0.8718 (0.9033) loss_zs_kd 0.8642 (0.9223) loss_oracle 0.8331 (0.8336) acc 31.2500 (57.8516) kd_loss 0.8439 (0.8467) lr 1.9098e-04 eta 0:04:17
epoch [42/50] batch [100/319] time 0.093 (0.091) data 0.001 (0.006) loss 2.7019 (2.1760) ce_loss 1.4062 (1.1099) teacher_loss 1.3739 (0.9120) loss_zs_kd 1.0566 (0.9256) loss_oracle 0.8212 (0.8340) acc 46.8750 (57.4062) kd_loss 0.9174 (0.8470) lr 1.9098e-04 eta 0:04:11
epoch [42/50] batch [120/319] time 0.081 (0.089) data 0.000 (0.005) loss 2.2154 (2.1610) ce_loss 1.1689 (1.0961) teacher_loss 0.9448 (0.8980) loss_zs_kd 0.9907 (0.9379) loss_oracle 0.8228 (0.8334) acc 56.2500 (58.0990) kd_loss 0.8592 (0.8463) lr 1.9098e-04 eta 0:04:05
epoch [42/50] batch [140/319] time 0.079 (0.088) data 0.000 (0.005) loss 1.7305 (2.1646) ce_loss 0.7246 (1.0958) teacher_loss 0.5148 (0.9044) loss_zs_kd 1.0624 (0.9425) loss_oracle 0.8227 (0.8335) acc 71.8750 (57.8795) kd_loss 0.8043 (0.8435) lr 1.9098e-04 eta 0:03:59
epoch [42/50] batch [160/319] time 0.095 (0.087) data 0.000 (0.004) loss 2.5357 (2.1645) ce_loss 1.3066 (1.0973) teacher_loss 1.2517 (0.9033) loss_zs_kd 1.1535 (0.9425) loss_oracle 0.8264 (0.8331) acc 56.2500 (57.7734) kd_loss 0.8707 (0.8447) lr 1.9098e-04 eta 0:03:56
epoch [42/50] batch [180/319] time 0.084 (0.087) data 0.000 (0.004) loss 2.0752 (2.1617) ce_loss 1.0703 (1.0968) teacher_loss 0.8877 (0.9014) loss_zs_kd 1.0235 (0.9529) loss_oracle 0.8271 (0.8324) acc 65.6250 (58.1597) kd_loss 0.7739 (0.8441) lr 1.9098e-04 eta 0:03:53
epoch [42/50] batch [200/319] time 0.093 (0.086) data 0.000 (0.003) loss 2.0920 (2.1573) ce_loss 1.0303 (1.0918) teacher_loss 0.8454 (0.8967) loss_zs_kd 0.9062 (0.9561) loss_oracle 0.8337 (0.8321) acc 59.3750 (58.3594) kd_loss 0.8297 (0.8446) lr 1.9098e-04 eta 0:03:50
epoch [42/50] batch [220/319] time 0.080 (0.086) data 0.000 (0.003) loss 2.2692 (2.1482) ce_loss 1.1455 (1.0872) teacher_loss 0.9909 (0.8883) loss_zs_kd 0.7927 (0.9616) loss_oracle 0.8094 (0.8321) acc 56.2500 (58.4943) kd_loss 0.8736 (0.8439) lr 1.9098e-04 eta 0:03:49
epoch [42/50] batch [240/319] time 0.083 (0.087) data 0.000 (0.003) loss 2.3852 (2.1455) ce_loss 1.2246 (1.0842) teacher_loss 1.1196 (0.8866) loss_zs_kd 0.9731 (0.9627) loss_oracle 0.8261 (0.8325) acc 53.1250 (58.5417) kd_loss 0.8525 (0.8427) lr 1.9098e-04 eta 0:03:47
epoch [42/50] batch [260/319] time 0.086 (0.086) data 0.000 (0.003) loss 2.2775 (2.1414) ce_loss 1.1787 (1.0834) teacher_loss 1.0065 (0.8827) loss_zs_kd 1.0498 (0.9603) loss_oracle 0.8263 (0.8327) acc 53.1250 (58.5457) kd_loss 0.8579 (0.8424) lr 1.9098e-04 eta 0:03:45
epoch [42/50] batch [280/319] time 0.082 (0.086) data 0.000 (0.003) loss 2.3088 (2.1409) ce_loss 1.1875 (1.0833) teacher_loss 1.0343 (0.8819) loss_zs_kd 0.8169 (0.9635) loss_oracle 0.8408 (0.8328) acc 65.6250 (58.6719) kd_loss 0.8541 (0.8425) lr 1.9098e-04 eta 0:03:43
epoch [42/50] batch [300/319] time 0.084 (0.086) data 0.000 (0.002) loss 2.1687 (2.1437) ce_loss 1.0674 (1.0853) teacher_loss 0.8489 (0.8854) loss_zs_kd 1.1027 (0.9679) loss_oracle 0.8588 (0.8328) acc 56.2500 (58.7292) kd_loss 0.8904 (0.8419) lr 1.9098e-04 eta 0:03:41
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,839
* accuracy: 64.8%
* error: 35.2%
* macro_f1: 56.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,044
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 22.5%
******* Domain 2 best val acc:      65.1%, epoch: 41 *******
******* Domain 2 best val test acc: 51.5%, epoch: 41 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [43/50] batch [20/319] time 0.089 (0.119) data 0.000 (0.028) loss 2.0034 (2.0843) ce_loss 0.9297 (1.0361) teacher_loss 0.7342 (0.8392) loss_zs_kd 1.2453 (0.9795) loss_oracle 0.8555 (0.8306) acc 65.6250 (60.7812) kd_loss 0.8415 (0.8298) lr 1.5567e-04 eta 0:05:00
epoch [43/50] batch [40/319] time 0.085 (0.100) data 0.000 (0.014) loss 2.4346 (2.1285) ce_loss 1.3779 (1.0708) teacher_loss 1.2191 (0.8760) loss_zs_kd 0.8987 (0.9542) loss_oracle 0.8435 (0.8340) acc 46.8750 (58.5938) kd_loss 0.7937 (0.8355) lr 1.5567e-04 eta 0:04:12
epoch [43/50] batch [60/319] time 0.082 (0.094) data 0.001 (0.010) loss 2.4574 (2.1294) ce_loss 1.3369 (1.0714) teacher_loss 1.2153 (0.8750) loss_zs_kd 0.9343 (0.9525) loss_oracle 0.8486 (0.8315) acc 43.7500 (57.6562) kd_loss 0.8178 (0.8386) lr 1.5567e-04 eta 0:03:54
epoch [43/50] batch [80/319] time 0.115 (0.096) data 0.000 (0.007) loss 2.0162 (2.1280) ce_loss 0.9473 (1.0765) teacher_loss 0.7118 (0.8762) loss_zs_kd 1.1106 (0.9515) loss_oracle 0.8130 (0.8313) acc 71.8750 (58.5938) kd_loss 0.8980 (0.8362) lr 1.5567e-04 eta 0:03:56
epoch [43/50] batch [100/319] time 0.093 (0.094) data 0.000 (0.006) loss 1.8676 (2.1186) ce_loss 0.9585 (1.0705) teacher_loss 0.6299 (0.8690) loss_zs_kd 0.8710 (0.9437) loss_oracle 0.8385 (0.8314) acc 56.2500 (58.5000) kd_loss 0.8184 (0.8339) lr 1.5567e-04 eta 0:03:49
epoch [43/50] batch [120/319] time 0.091 (0.092) data 0.000 (0.005) loss 2.0987 (2.1244) ce_loss 0.9478 (1.0737) teacher_loss 0.8591 (0.8717) loss_zs_kd 0.9313 (0.9372) loss_oracle 0.8527 (0.8325) acc 56.2500 (58.8021) kd_loss 0.8132 (0.8365) lr 1.5567e-04 eta 0:03:44
epoch [43/50] batch [140/319] time 0.095 (0.091) data 0.000 (0.004) loss 2.3119 (2.1261) ce_loss 1.3682 (1.0770) teacher_loss 1.0119 (0.8741) loss_zs_kd 0.8122 (0.9447) loss_oracle 0.8598 (0.8320) acc 46.8750 (58.6384) kd_loss 0.8701 (0.8359) lr 1.5567e-04 eta 0:03:40
epoch [43/50] batch [160/319] time 0.090 (0.091) data 0.000 (0.004) loss 2.0717 (2.1214) ce_loss 1.0322 (1.0734) teacher_loss 0.8171 (0.8699) loss_zs_kd 0.9361 (0.9475) loss_oracle 0.8381 (0.8321) acc 59.3750 (58.6914) kd_loss 0.8356 (0.8355) lr 1.5567e-04 eta 0:03:36
epoch [43/50] batch [180/319] time 0.082 (0.090) data 0.000 (0.003) loss 2.0785 (2.1294) ce_loss 1.1016 (1.0790) teacher_loss 0.8475 (0.8784) loss_zs_kd 0.8536 (0.9477) loss_oracle 0.8005 (0.8314) acc 62.5000 (58.8889) kd_loss 0.8308 (0.8353) lr 1.5567e-04 eta 0:03:33
epoch [43/50] batch [200/319] time 0.093 (0.090) data 0.000 (0.003) loss 2.1715 (2.1332) ce_loss 1.1191 (1.0803) teacher_loss 0.9246 (0.8810) loss_zs_kd 0.8635 (0.9500) loss_oracle 0.8432 (0.8313) acc 50.0000 (58.8438) kd_loss 0.8252 (0.8366) lr 1.5567e-04 eta 0:03:30
epoch [43/50] batch [220/319] time 0.081 (0.089) data 0.000 (0.003) loss 2.5719 (2.1399) ce_loss 1.2393 (1.0868) teacher_loss 1.2859 (0.8881) loss_zs_kd 1.0259 (0.9435) loss_oracle 0.8546 (0.8315) acc 56.2500 (58.6506) kd_loss 0.8587 (0.8360) lr 1.5567e-04 eta 0:03:27
epoch [43/50] batch [240/319] time 0.087 (0.089) data 0.000 (0.003) loss 2.1457 (2.1412) ce_loss 1.0771 (1.0850) teacher_loss 0.8782 (0.8887) loss_zs_kd 1.1339 (0.9438) loss_oracle 0.8221 (0.8321) acc 53.1250 (58.7370) kd_loss 0.8565 (0.8364) lr 1.5567e-04 eta 0:03:25
epoch [43/50] batch [260/319] time 0.088 (0.088) data 0.000 (0.002) loss 2.0737 (2.1414) ce_loss 1.0039 (1.0836) teacher_loss 0.7918 (0.8881) loss_zs_kd 1.1132 (0.9456) loss_oracle 0.8426 (0.8321) acc 71.8750 (58.9183) kd_loss 0.8606 (0.8372) lr 1.5567e-04 eta 0:03:22
epoch [43/50] batch [280/319] time 0.095 (0.088) data 0.000 (0.002) loss 1.9923 (2.1358) ce_loss 1.0176 (1.0811) teacher_loss 0.7127 (0.8834) loss_zs_kd 1.0211 (0.9455) loss_oracle 0.8084 (0.8319) acc 62.5000 (58.8951) kd_loss 0.8754 (0.8364) lr 1.5567e-04 eta 0:03:20
epoch [43/50] batch [300/319] time 0.089 (0.088) data 0.000 (0.002) loss 2.1687 (2.1343) ce_loss 1.0977 (1.0782) teacher_loss 0.9191 (0.8824) loss_zs_kd 0.6973 (0.9464) loss_oracle 0.8566 (0.8324) acc 65.6250 (59.0000) kd_loss 0.8213 (0.8357) lr 1.5567e-04 eta 0:03:18
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,837
* accuracy: 64.8%
* error: 35.2%
* macro_f1: 56.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,149
* accuracy: 52.9%
* error: 47.1%
* macro_f1: 22.6%
******* Domain 2 best val acc:      65.1%, epoch: 41 *******
******* Domain 2 best val test acc: 51.5%, epoch: 41 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [44/50] batch [20/319] time 0.084 (0.119) data 0.000 (0.032) loss 2.4629 (2.1473) ce_loss 1.2568 (1.0782) teacher_loss 1.2321 (0.8956) loss_zs_kd 0.9211 (0.9627) loss_oracle 0.8346 (0.8366) acc 56.2500 (60.6250) kd_loss 0.8134 (0.8334) lr 1.2369e-04 eta 0:04:23
epoch [44/50] batch [40/319] time 0.083 (0.101) data 0.000 (0.016) loss 2.5434 (2.1642) ce_loss 1.2354 (1.0946) teacher_loss 1.2556 (0.9180) loss_zs_kd 0.7740 (0.9529) loss_oracle 0.8372 (0.8383) acc 56.2500 (59.1406) kd_loss 0.8692 (0.8269) lr 1.2369e-04 eta 0:03:40
epoch [44/50] batch [60/319] time 0.080 (0.094) data 0.001 (0.011) loss 1.7586 (2.1483) ce_loss 0.8008 (1.0828) teacher_loss 0.5144 (0.8989) loss_zs_kd 1.0475 (0.9442) loss_oracle 0.8008 (0.8397) acc 71.8750 (59.2708) kd_loss 0.8437 (0.8295) lr 1.2369e-04 eta 0:03:25
epoch [44/50] batch [80/319] time 0.090 (0.092) data 0.000 (0.008) loss 1.9891 (2.1360) ce_loss 0.9980 (1.0742) teacher_loss 0.8602 (0.8866) loss_zs_kd 1.1396 (0.9450) loss_oracle 0.8395 (0.8384) acc 62.5000 (59.5312) kd_loss 0.7092 (0.8302) lr 1.2369e-04 eta 0:03:18
epoch [44/50] batch [100/319] time 0.089 (0.090) data 0.000 (0.007) loss 2.2271 (2.1363) ce_loss 1.0371 (1.0744) teacher_loss 0.9664 (0.8861) loss_zs_kd 0.8422 (0.9506) loss_oracle 0.8096 (0.8374) acc 62.5000 (59.5625) kd_loss 0.8558 (0.8315) lr 1.2369e-04 eta 0:03:11
epoch [44/50] batch [120/319] time 0.083 (0.089) data 0.000 (0.006) loss 2.3737 (2.1544) ce_loss 1.2510 (1.0879) teacher_loss 1.1361 (0.9007) loss_zs_kd 0.9202 (0.9372) loss_oracle 0.8627 (0.8387) acc 56.2500 (58.9062) kd_loss 0.8062 (0.8343) lr 1.2369e-04 eta 0:03:07
epoch [44/50] batch [140/319] time 0.080 (0.088) data 0.001 (0.005) loss 2.3369 (2.1610) ce_loss 1.2129 (1.0937) teacher_loss 1.1224 (0.9071) loss_zs_kd 0.9261 (0.9256) loss_oracle 0.8176 (0.8377) acc 50.0000 (58.7500) kd_loss 0.8058 (0.8350) lr 1.2369e-04 eta 0:03:03
epoch [44/50] batch [160/319] time 0.077 (0.088) data 0.000 (0.004) loss 2.2977 (2.1650) ce_loss 1.0723 (1.0962) teacher_loss 1.0196 (0.9108) loss_zs_kd 0.7778 (0.9273) loss_oracle 0.8619 (0.8369) acc 62.5000 (58.7695) kd_loss 0.8471 (0.8358) lr 1.2369e-04 eta 0:03:01
epoch [44/50] batch [180/319] time 0.086 (0.087) data 0.000 (0.004) loss 2.4432 (2.1676) ce_loss 1.2188 (1.0996) teacher_loss 1.1647 (0.9137) loss_zs_kd 0.7362 (0.9260) loss_oracle 0.8252 (0.8371) acc 53.1250 (58.4375) kd_loss 0.8659 (0.8353) lr 1.2369e-04 eta 0:02:58
epoch [44/50] batch [200/319] time 0.075 (0.087) data 0.000 (0.003) loss 1.8329 (2.1651) ce_loss 0.7681 (1.0970) teacher_loss 0.5312 (0.9101) loss_zs_kd 0.7624 (0.9295) loss_oracle 0.8294 (0.8359) acc 68.7500 (58.4219) kd_loss 0.8870 (0.8371) lr 1.2369e-04 eta 0:02:56
epoch [44/50] batch [220/319] time 0.087 (0.087) data 0.000 (0.003) loss 1.9646 (2.1612) ce_loss 0.9521 (1.0959) teacher_loss 0.7119 (0.9063) loss_zs_kd 0.9999 (0.9343) loss_oracle 0.8247 (0.8354) acc 59.3750 (58.4375) kd_loss 0.8404 (0.8372) lr 1.2369e-04 eta 0:02:54
epoch [44/50] batch [240/319] time 0.076 (0.087) data 0.000 (0.003) loss 2.3506 (2.1573) ce_loss 1.1670 (1.0899) teacher_loss 1.0981 (0.9030) loss_zs_kd 1.2211 (0.9375) loss_oracle 0.8285 (0.8346) acc 75.0000 (58.6589) kd_loss 0.8383 (0.8370) lr 1.2369e-04 eta 0:02:54
epoch [44/50] batch [260/319] time 0.085 (0.087) data 0.000 (0.003) loss 2.1920 (2.1563) ce_loss 1.1875 (1.0893) teacher_loss 0.9898 (0.9021) loss_zs_kd 0.8828 (0.9365) loss_oracle 0.8003 (0.8346) acc 53.1250 (58.5577) kd_loss 0.8021 (0.8370) lr 1.2369e-04 eta 0:02:51
epoch [44/50] batch [280/319] time 0.080 (0.087) data 0.000 (0.003) loss 2.2947 (2.1552) ce_loss 1.2471 (1.0879) teacher_loss 1.0312 (0.9008) loss_zs_kd 0.8864 (0.9346) loss_oracle 0.8498 (0.8345) acc 53.1250 (58.6830) kd_loss 0.8386 (0.8372) lr 1.2369e-04 eta 0:02:49
epoch [44/50] batch [300/319] time 0.088 (0.087) data 0.000 (0.002) loss 2.1427 (2.1539) ce_loss 1.1152 (1.0890) teacher_loss 0.9476 (0.8993) loss_zs_kd 0.8925 (0.9345) loss_oracle 0.8559 (0.8344) acc 65.6250 (58.6250) kd_loss 0.7671 (0.8374) lr 1.2369e-04 eta 0:02:47
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,849
* accuracy: 65.1%
* error: 34.9%
* macro_f1: 56.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,051
* accuracy: 51.9%
* error: 48.1%
* macro_f1: 22.6%
******* Domain 2 best val acc:      65.1%, epoch: 41 *******
******* Domain 2 best val test acc: 51.5%, epoch: 41 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [45/50] batch [20/319] time 0.088 (0.131) data 0.001 (0.034) loss 1.8830 (2.0857) ce_loss 0.9370 (1.0376) teacher_loss 0.6830 (0.8319) loss_zs_kd 0.6320 (0.9189) loss_oracle 0.8422 (0.8332) acc 62.5000 (60.4688) kd_loss 0.7788 (0.8372) lr 9.5173e-05 eta 0:04:09
epoch [45/50] batch [40/319] time 0.080 (0.108) data 0.000 (0.017) loss 2.2073 (2.1244) ce_loss 1.1768 (1.0782) teacher_loss 0.9458 (0.8723) loss_zs_kd 0.8636 (0.9167) loss_oracle 0.8065 (0.8318) acc 62.5000 (59.9219) kd_loss 0.8582 (0.8362) lr 9.5173e-05 eta 0:03:22
epoch [45/50] batch [60/319] time 0.082 (0.100) data 0.001 (0.012) loss 2.0475 (2.1417) ce_loss 0.9736 (1.0938) teacher_loss 0.7614 (0.8836) loss_zs_kd 1.0739 (0.9408) loss_oracle 0.8358 (0.8319) acc 75.0000 (59.0625) kd_loss 0.8682 (0.8421) lr 9.5173e-05 eta 0:03:05
epoch [45/50] batch [80/319] time 0.097 (0.097) data 0.000 (0.009) loss 2.1837 (2.1339) ce_loss 1.2344 (1.0841) teacher_loss 0.9131 (0.8737) loss_zs_kd 1.0804 (0.9392) loss_oracle 0.8526 (0.8327) acc 46.8750 (59.2969) kd_loss 0.8443 (0.8439) lr 9.5173e-05 eta 0:02:58
epoch [45/50] batch [100/319] time 0.086 (0.095) data 0.000 (0.007) loss 2.3097 (2.1393) ce_loss 0.9331 (1.0772) teacher_loss 0.9490 (0.8755) loss_zs_kd 0.8135 (0.9402) loss_oracle 0.8218 (0.8345) acc 68.7500 (58.7812) kd_loss 0.9498 (0.8466) lr 9.5173e-05 eta 0:02:52
epoch [45/50] batch [120/319] time 0.095 (0.094) data 0.000 (0.006) loss 2.1002 (2.1386) ce_loss 1.1523 (1.0786) teacher_loss 0.9135 (0.8745) loss_zs_kd 0.7549 (0.9333) loss_oracle 0.8570 (0.8349) acc 50.0000 (58.4896) kd_loss 0.7582 (0.8467) lr 9.5173e-05 eta 0:02:48
epoch [45/50] batch [140/319] time 0.087 (0.092) data 0.000 (0.005) loss 2.1750 (2.1300) ce_loss 0.9824 (1.0674) teacher_loss 0.8160 (0.8643) loss_zs_kd 0.9254 (0.9388) loss_oracle 0.8520 (0.8346) acc 65.6250 (58.9955) kd_loss 0.9330 (0.8484) lr 9.5173e-05 eta 0:02:43
epoch [45/50] batch [160/319] time 0.083 (0.091) data 0.000 (0.005) loss 2.0849 (2.1228) ce_loss 0.9224 (1.0615) teacher_loss 0.8572 (0.8574) loss_zs_kd 0.8055 (0.9355) loss_oracle 0.8156 (0.8353) acc 59.3750 (59.2773) kd_loss 0.8199 (0.8477) lr 9.5173e-05 eta 0:02:40
epoch [45/50] batch [180/319] time 0.087 (0.090) data 0.000 (0.004) loss 1.9754 (2.1212) ce_loss 0.9468 (1.0568) teacher_loss 0.7718 (0.8550) loss_zs_kd 1.0087 (0.9418) loss_oracle 0.8219 (0.8352) acc 65.6250 (59.6701) kd_loss 0.7926 (0.8486) lr 9.5173e-05 eta 0:02:36
epoch [45/50] batch [200/319] time 0.084 (0.090) data 0.000 (0.004) loss 2.0894 (2.1225) ce_loss 1.2471 (1.0623) teacher_loss 0.8205 (0.8567) loss_zs_kd 0.8178 (0.9340) loss_oracle 0.8622 (0.8352) acc 46.8750 (59.4844) kd_loss 0.8378 (0.8483) lr 9.5173e-05 eta 0:02:33
epoch [45/50] batch [220/319] time 0.083 (0.089) data 0.000 (0.003) loss 1.8591 (2.1239) ce_loss 0.8960 (1.0669) teacher_loss 0.5574 (0.8582) loss_zs_kd 0.7706 (0.9330) loss_oracle 0.8469 (0.8353) acc 65.6250 (59.2614) kd_loss 0.8783 (0.8480) lr 9.5173e-05 eta 0:02:31
epoch [45/50] batch [240/319] time 0.085 (0.089) data 0.000 (0.003) loss 2.1693 (2.1198) ce_loss 1.3691 (1.0664) teacher_loss 0.8698 (0.8546) loss_zs_kd 1.1396 (0.9341) loss_oracle 0.8315 (0.8356) acc 37.5000 (59.2448) kd_loss 0.8838 (0.8475) lr 9.5173e-05 eta 0:02:28
epoch [45/50] batch [260/319] time 0.078 (0.088) data 0.000 (0.003) loss 2.1852 (2.1314) ce_loss 1.1768 (1.0769) teacher_loss 0.9373 (0.8666) loss_zs_kd 0.9696 (0.9333) loss_oracle 0.8475 (0.8356) acc 59.3750 (58.8221) kd_loss 0.8241 (0.8470) lr 9.5173e-05 eta 0:02:25
epoch [45/50] batch [280/319] time 0.085 (0.087) data 0.000 (0.003) loss 1.9757 (2.1364) ce_loss 0.8521 (1.0776) teacher_loss 0.6959 (0.8731) loss_zs_kd 1.1232 (0.9339) loss_oracle 0.8400 (0.8358) acc 65.6250 (58.7500) kd_loss 0.8598 (0.8454) lr 9.5173e-05 eta 0:02:22
epoch [45/50] batch [300/319] time 0.079 (0.087) data 0.000 (0.003) loss 2.0567 (2.1346) ce_loss 0.8843 (1.0742) teacher_loss 0.8115 (0.8720) loss_zs_kd 0.7907 (0.9347) loss_oracle 0.8375 (0.8357) acc 59.3750 (58.9479) kd_loss 0.8265 (0.8447) lr 9.5173e-05 eta 0:02:19
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,870
* accuracy: 65.6%
* error: 34.4%
* macro_f1: 57.5%
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,109
* accuracy: 52.5%
* error: 47.5%
* macro_f1: 22.5%
******* Domain 2 best val acc:      65.6%, epoch: 45 *******
******* Domain 2 best val test acc: 52.5%, epoch: 45 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [46/50] batch [20/319] time 0.088 (0.124) data 0.000 (0.031) loss 2.1516 (2.0931) ce_loss 1.1514 (1.0182) teacher_loss 0.9118 (0.8415) loss_zs_kd 0.9137 (0.9627) loss_oracle 0.8308 (0.8402) acc 46.8750 (60.1562) kd_loss 0.8244 (0.8315) lr 7.0224e-05 eta 0:03:15
epoch [46/50] batch [40/319] time 0.080 (0.102) data 0.000 (0.016) loss 2.3270 (2.1135) ce_loss 1.2148 (1.0460) teacher_loss 1.0522 (0.8516) loss_zs_kd 0.9262 (0.9535) loss_oracle 0.8057 (0.8385) acc 50.0000 (59.6094) kd_loss 0.8720 (0.8426) lr 7.0224e-05 eta 0:02:39
epoch [46/50] batch [60/319] time 0.086 (0.097) data 0.001 (0.011) loss 2.0869 (2.1072) ce_loss 1.1572 (1.0428) teacher_loss 0.8239 (0.8431) loss_zs_kd 1.0042 (0.9710) loss_oracle 0.8010 (0.8360) acc 56.2500 (60.2083) kd_loss 0.8625 (0.8462) lr 7.0224e-05 eta 0:02:28
epoch [46/50] batch [80/319] time 0.090 (0.093) data 0.000 (0.008) loss 2.0010 (2.1081) ce_loss 0.9668 (1.0431) teacher_loss 0.7744 (0.8447) loss_zs_kd 0.8120 (0.9767) loss_oracle 0.8570 (0.8348) acc 75.0000 (60.4688) kd_loss 0.7982 (0.8460) lr 7.0224e-05 eta 0:02:21
epoch [46/50] batch [100/319] time 0.077 (0.092) data 0.000 (0.006) loss 1.7705 (2.1094) ce_loss 0.8066 (1.0444) teacher_loss 0.5367 (0.8436) loss_zs_kd 0.8417 (0.9765) loss_oracle 0.8291 (0.8346) acc 62.5000 (60.3750) kd_loss 0.8192 (0.8485) lr 7.0224e-05 eta 0:02:16
epoch [46/50] batch [120/319] time 0.080 (0.090) data 0.000 (0.005) loss 2.1142 (2.1087) ce_loss 0.9277 (1.0421) teacher_loss 0.8141 (0.8454) loss_zs_kd 0.9927 (0.9685) loss_oracle 0.8224 (0.8351) acc 62.5000 (60.3385) kd_loss 0.8889 (0.8458) lr 7.0224e-05 eta 0:02:12
epoch [46/50] batch [140/319] time 0.076 (0.089) data 0.000 (0.005) loss 2.0840 (2.1160) ce_loss 0.8823 (1.0541) teacher_loss 0.8508 (0.8530) loss_zs_kd 0.7187 (0.9641) loss_oracle 0.8022 (0.8344) acc 78.1250 (59.7545) kd_loss 0.8321 (0.8458) lr 7.0224e-05 eta 0:02:08
epoch [46/50] batch [160/319] time 0.080 (0.088) data 0.000 (0.004) loss 1.8995 (2.1115) ce_loss 0.9380 (1.0502) teacher_loss 0.6136 (0.8471) loss_zs_kd 0.8043 (0.9635) loss_oracle 0.8328 (0.8347) acc 59.3750 (60.0391) kd_loss 0.8695 (0.8471) lr 7.0224e-05 eta 0:02:05
epoch [46/50] batch [180/319] time 0.088 (0.089) data 0.001 (0.004) loss 2.1910 (2.1201) ce_loss 1.0459 (1.0554) teacher_loss 0.9250 (0.8560) loss_zs_kd 0.8103 (0.9639) loss_oracle 0.8160 (0.8341) acc 62.5000 (60.0694) kd_loss 0.8581 (0.8471) lr 7.0224e-05 eta 0:02:05
epoch [46/50] batch [200/319] time 0.082 (0.088) data 0.000 (0.003) loss 2.1428 (2.1218) ce_loss 1.0635 (1.0538) teacher_loss 0.9172 (0.8569) loss_zs_kd 0.8565 (0.9658) loss_oracle 0.8372 (0.8347) acc 56.2500 (60.0312) kd_loss 0.8070 (0.8475) lr 7.0224e-05 eta 0:02:03
epoch [46/50] batch [220/319] time 0.089 (0.088) data 0.000 (0.003) loss 2.3645 (2.1289) ce_loss 1.2510 (1.0624) teacher_loss 1.1171 (0.8646) loss_zs_kd 0.9659 (0.9614) loss_oracle 0.8372 (0.8348) acc 46.8750 (59.6875) kd_loss 0.8289 (0.8469) lr 7.0224e-05 eta 0:02:00
epoch [46/50] batch [240/319] time 0.082 (0.088) data 0.000 (0.003) loss 1.9369 (2.1317) ce_loss 0.9463 (1.0624) teacher_loss 0.7480 (0.8660) loss_zs_kd 0.8356 (0.9603) loss_oracle 0.8315 (0.8353) acc 68.7500 (59.7005) kd_loss 0.7731 (0.8481) lr 7.0224e-05 eta 0:01:58
epoch [46/50] batch [260/319] time 0.078 (0.087) data 0.000 (0.003) loss 2.2068 (2.1308) ce_loss 0.9170 (1.0640) teacher_loss 0.8742 (0.8665) loss_zs_kd 1.0164 (0.9596) loss_oracle 0.8282 (0.8347) acc 65.6250 (59.6875) kd_loss 0.9186 (0.8470) lr 7.0224e-05 eta 0:01:55
epoch [46/50] batch [280/319] time 0.085 (0.087) data 0.000 (0.002) loss 2.2405 (2.1331) ce_loss 1.2754 (1.0664) teacher_loss 0.9935 (0.8705) loss_zs_kd 0.7928 (0.9584) loss_oracle 0.8343 (0.8339) acc 50.0000 (59.5536) kd_loss 0.8299 (0.8456) lr 7.0224e-05 eta 0:01:53
epoch [46/50] batch [300/319] time 0.085 (0.087) data 0.000 (0.002) loss 2.0546 (2.1306) ce_loss 1.2637 (1.0654) teacher_loss 0.8153 (0.8685) loss_zs_kd 1.0010 (0.9571) loss_oracle 0.8431 (0.8339) acc 46.8750 (59.5938) kd_loss 0.8178 (0.8452) lr 7.0224e-05 eta 0:01:52
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,865
* accuracy: 65.4%
* error: 34.6%
* macro_f1: 57.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,101
* accuracy: 52.4%
* error: 47.6%
* macro_f1: 22.7%
******* Domain 2 best val acc:      65.6%, epoch: 45 *******
******* Domain 2 best val test acc: 52.5%, epoch: 45 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [47/50] batch [20/319] time 0.075 (0.121) data 0.001 (0.032) loss 2.0607 (2.1933) ce_loss 0.9453 (1.1110) teacher_loss 0.8218 (0.9360) loss_zs_kd 0.9041 (0.9310) loss_oracle 0.8479 (0.8335) acc 68.7500 (57.1875) kd_loss 0.8150 (0.8405) lr 4.8943e-05 eta 0:02:32
epoch [47/50] batch [40/319] time 0.083 (0.102) data 0.000 (0.016) loss 2.0796 (2.1679) ce_loss 1.0371 (1.1102) teacher_loss 0.8061 (0.9091) loss_zs_kd 0.8920 (0.9258) loss_oracle 0.8292 (0.8347) acc 59.3750 (56.8750) kd_loss 0.8589 (0.8414) lr 4.8943e-05 eta 0:02:06
epoch [47/50] batch [60/319] time 0.078 (0.096) data 0.000 (0.011) loss 2.3633 (2.1473) ce_loss 1.0664 (1.1027) teacher_loss 0.9686 (0.8893) loss_zs_kd 1.1673 (0.9517) loss_oracle 0.8592 (0.8303) acc 62.5000 (57.1354) kd_loss 0.9651 (0.8428) lr 4.8943e-05 eta 0:01:56
epoch [47/50] batch [80/319] time 0.086 (0.093) data 0.000 (0.008) loss 2.1556 (2.1439) ce_loss 1.0254 (1.1002) teacher_loss 0.9954 (0.8869) loss_zs_kd 0.7408 (0.9370) loss_oracle 0.8293 (0.8316) acc 50.0000 (57.5781) kd_loss 0.7456 (0.8413) lr 4.8943e-05 eta 0:01:51
epoch [47/50] batch [100/319] time 0.082 (0.092) data 0.000 (0.007) loss 1.8561 (2.1493) ce_loss 0.8838 (1.0921) teacher_loss 0.6249 (0.8916) loss_zs_kd 0.9535 (0.9395) loss_oracle 0.8328 (0.8331) acc 56.2500 (58.3125) kd_loss 0.8148 (0.8412) lr 4.8943e-05 eta 0:01:48
epoch [47/50] batch [120/319] time 0.083 (0.091) data 0.000 (0.006) loss 1.9144 (2.1355) ce_loss 0.9639 (1.0794) teacher_loss 0.6474 (0.8752) loss_zs_kd 0.7887 (0.9451) loss_oracle 0.8142 (0.8333) acc 56.2500 (58.4115) kd_loss 0.8598 (0.8436) lr 4.8943e-05 eta 0:01:45
epoch [47/50] batch [140/319] time 0.089 (0.090) data 0.001 (0.005) loss 2.3519 (2.1256) ce_loss 1.3633 (1.0718) teacher_loss 1.1231 (0.8663) loss_zs_kd 1.0507 (0.9455) loss_oracle 0.8440 (0.8329) acc 50.0000 (58.8616) kd_loss 0.8068 (0.8428) lr 4.8943e-05 eta 0:01:42
epoch [47/50] batch [160/319] time 0.080 (0.089) data 0.000 (0.004) loss 2.0929 (2.1216) ce_loss 0.9526 (1.0700) teacher_loss 0.8596 (0.8628) loss_zs_kd 0.6966 (0.9475) loss_oracle 0.8227 (0.8327) acc 71.8750 (58.7891) kd_loss 0.8219 (0.8425) lr 4.8943e-05 eta 0:01:39
epoch [47/50] batch [180/319] time 0.081 (0.089) data 0.000 (0.004) loss 2.0405 (2.1239) ce_loss 1.0684 (1.0743) teacher_loss 0.7885 (0.8630) loss_zs_kd 1.0260 (0.9508) loss_oracle 0.8368 (0.8329) acc 50.0000 (58.3333) kd_loss 0.8336 (0.8444) lr 4.8943e-05 eta 0:01:37
epoch [47/50] batch [200/319] time 0.074 (0.088) data 0.000 (0.003) loss 2.2724 (2.1196) ce_loss 1.1191 (1.0686) teacher_loss 1.0019 (0.8590) loss_zs_kd 1.1334 (0.9464) loss_oracle 0.8593 (0.8332) acc 56.2500 (58.7969) kd_loss 0.8409 (0.8440) lr 4.8943e-05 eta 0:01:34
epoch [47/50] batch [220/319] time 0.084 (0.087) data 0.000 (0.003) loss 1.9051 (2.1189) ce_loss 1.0010 (1.0664) teacher_loss 0.6453 (0.8583) loss_zs_kd 0.8596 (0.9511) loss_oracle 0.8499 (0.8331) acc 68.7500 (58.9773) kd_loss 0.8348 (0.8440) lr 4.8943e-05 eta 0:01:31
epoch [47/50] batch [240/319] time 0.082 (0.087) data 0.000 (0.003) loss 1.9667 (2.1242) ce_loss 0.7734 (1.0725) teacher_loss 0.6742 (0.8638) loss_zs_kd 0.8813 (0.9516) loss_oracle 0.8286 (0.8327) acc 81.2500 (58.8021) kd_loss 0.8781 (0.8440) lr 4.8943e-05 eta 0:01:29
epoch [47/50] batch [260/319] time 0.087 (0.086) data 0.000 (0.003) loss 2.3684 (2.1283) ce_loss 1.2178 (1.0748) teacher_loss 1.1141 (0.8678) loss_zs_kd 0.8166 (0.9506) loss_oracle 0.8386 (0.8331) acc 56.2500 (58.8942) kd_loss 0.8351 (0.8439) lr 4.8943e-05 eta 0:01:27
epoch [47/50] batch [280/319] time 0.081 (0.086) data 0.000 (0.003) loss 2.4027 (2.1270) ce_loss 0.9424 (1.0734) teacher_loss 1.1113 (0.8677) loss_zs_kd 0.7653 (0.9514) loss_oracle 0.8416 (0.8333) acc 62.5000 (58.7946) kd_loss 0.8706 (0.8426) lr 4.8943e-05 eta 0:01:25
epoch [47/50] batch [300/319] time 0.076 (0.086) data 0.000 (0.002) loss 2.0100 (2.1288) ce_loss 0.8262 (1.0721) teacher_loss 0.6754 (0.8696) loss_zs_kd 0.8985 (0.9518) loss_oracle 0.8424 (0.8339) acc 68.7500 (58.8646) kd_loss 0.9135 (0.8423) lr 4.8943e-05 eta 0:01:24
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,863
* accuracy: 65.4%
* error: 34.6%
* macro_f1: 57.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,082
* accuracy: 52.2%
* error: 47.8%
* macro_f1: 22.6%
******* Domain 2 best val acc:      65.6%, epoch: 45 *******
******* Domain 2 best val test acc: 52.5%, epoch: 45 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [48/50] batch [20/319] time 0.113 (0.107) data 0.000 (0.026) loss 2.0425 (2.1810) ce_loss 0.9697 (1.1350) teacher_loss 0.9374 (0.9417) loss_zs_kd 0.7683 (0.9395) loss_oracle 0.7851 (0.8291) acc 65.6250 (58.1250) kd_loss 0.7126 (0.8247) lr 3.1417e-05 eta 0:01:40
epoch [48/50] batch [40/319] time 0.070 (0.094) data 0.000 (0.013) loss 1.9303 (2.1651) ce_loss 1.0537 (1.1334) teacher_loss 0.7188 (0.9147) loss_zs_kd 0.9127 (0.9479) loss_oracle 0.8433 (0.8313) acc 59.3750 (57.8125) kd_loss 0.7898 (0.8348) lr 3.1417e-05 eta 0:01:26
epoch [48/50] batch [60/319] time 0.081 (0.090) data 0.001 (0.009) loss 2.1879 (2.1530) ce_loss 1.1055 (1.1194) teacher_loss 0.9475 (0.9008) loss_zs_kd 0.6999 (0.9485) loss_oracle 0.8403 (0.8303) acc 62.5000 (58.5938) kd_loss 0.8202 (0.8370) lr 3.1417e-05 eta 0:01:20
epoch [48/50] batch [80/319] time 0.065 (0.088) data 0.000 (0.007) loss 2.0675 (2.1316) ce_loss 0.9912 (1.0971) teacher_loss 0.8753 (0.8756) loss_zs_kd 0.8648 (0.9531) loss_oracle 0.8084 (0.8319) acc 56.2500 (59.2188) kd_loss 0.7879 (0.8401) lr 3.1417e-05 eta 0:01:17
epoch [48/50] batch [100/319] time 0.075 (0.084) data 0.000 (0.006) loss 2.1422 (2.1269) ce_loss 1.0771 (1.0882) teacher_loss 0.8186 (0.8703) loss_zs_kd 0.8331 (0.9571) loss_oracle 0.8403 (0.8321) acc 59.3750 (59.2188) kd_loss 0.9034 (0.8406) lr 3.1417e-05 eta 0:01:12
epoch [48/50] batch [120/319] time 0.061 (0.084) data 0.000 (0.005) loss 2.2062 (2.1233) ce_loss 1.0039 (1.0768) teacher_loss 0.9216 (0.8633) loss_zs_kd 0.8247 (0.9544) loss_oracle 0.8002 (0.8339) acc 65.6250 (59.7135) kd_loss 0.8846 (0.8431) lr 3.1417e-05 eta 0:01:10
epoch [48/50] batch [140/319] time 0.089 (0.084) data 0.000 (0.004) loss 2.2478 (2.1252) ce_loss 1.2402 (1.0755) teacher_loss 0.9405 (0.8627) loss_zs_kd 0.8781 (0.9554) loss_oracle 0.8529 (0.8340) acc 59.3750 (59.8884) kd_loss 0.8809 (0.8456) lr 3.1417e-05 eta 0:01:08
epoch [48/50] batch [160/319] time 0.081 (0.084) data 0.000 (0.004) loss 1.8725 (2.1201) ce_loss 0.8315 (1.0667) teacher_loss 0.6298 (0.8576) loss_zs_kd 1.1613 (0.9521) loss_oracle 0.8072 (0.8338) acc 65.6250 (60.2539) kd_loss 0.8392 (0.8457) lr 3.1417e-05 eta 0:01:07
epoch [48/50] batch [180/319] time 0.092 (0.084) data 0.000 (0.003) loss 2.1190 (2.1238) ce_loss 0.9141 (1.0738) teacher_loss 0.8999 (0.8627) loss_zs_kd 1.0123 (0.9478) loss_oracle 0.8322 (0.8332) acc 71.8750 (59.7569) kd_loss 0.8030 (0.8445) lr 3.1417e-05 eta 0:01:05
epoch [48/50] batch [200/319] time 0.087 (0.084) data 0.000 (0.003) loss 2.4230 (2.1308) ce_loss 1.4463 (1.0782) teacher_loss 1.1514 (0.8688) loss_zs_kd 0.8192 (0.9525) loss_oracle 0.8511 (0.8332) acc 43.7500 (59.3750) kd_loss 0.8459 (0.8454) lr 3.1417e-05 eta 0:01:03
epoch [48/50] batch [220/319] time 0.088 (0.084) data 0.000 (0.003) loss 1.9817 (2.1304) ce_loss 0.8652 (1.0787) teacher_loss 0.7665 (0.8685) loss_zs_kd 0.7925 (0.9520) loss_oracle 0.8159 (0.8327) acc 62.5000 (59.2898) kd_loss 0.8073 (0.8456) lr 3.1417e-05 eta 0:01:01
epoch [48/50] batch [240/319] time 0.082 (0.084) data 0.000 (0.002) loss 2.3519 (2.1345) ce_loss 1.2705 (1.0800) teacher_loss 1.1222 (0.8725) loss_zs_kd 0.9773 (0.9503) loss_oracle 0.8426 (0.8332) acc 59.3750 (59.2969) kd_loss 0.8084 (0.8454) lr 3.1417e-05 eta 0:01:00
epoch [48/50] batch [260/319] time 0.091 (0.084) data 0.000 (0.002) loss 2.3420 (2.1321) ce_loss 1.1807 (1.0779) teacher_loss 1.0367 (0.8689) loss_zs_kd 1.2414 (0.9528) loss_oracle 0.8490 (0.8337) acc 59.3750 (59.3149) kd_loss 0.8808 (0.8463) lr 3.1417e-05 eta 0:00:58
epoch [48/50] batch [280/319] time 0.086 (0.084) data 0.000 (0.002) loss 2.4438 (2.1282) ce_loss 1.5596 (1.0747) teacher_loss 1.2690 (0.8662) loss_zs_kd 0.9982 (0.9485) loss_oracle 0.8072 (0.8338) acc 40.6250 (59.5759) kd_loss 0.7713 (0.8451) lr 3.1417e-05 eta 0:00:57
epoch [48/50] batch [300/319] time 0.087 (0.085) data 0.000 (0.002) loss 2.1183 (2.1290) ce_loss 0.9282 (1.0747) teacher_loss 0.8550 (0.8679) loss_zs_kd 0.9221 (0.9454) loss_oracle 0.8435 (0.8341) acc 65.6250 (59.5312) kd_loss 0.8415 (0.8440) lr 3.1417e-05 eta 0:00:55
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,857
* accuracy: 65.3%
* error: 34.7%
* macro_f1: 57.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,084
* accuracy: 52.2%
* error: 47.8%
* macro_f1: 22.7%
******* Domain 2 best val acc:      65.6%, epoch: 45 *******
******* Domain 2 best val test acc: 52.5%, epoch: 45 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [49/50] batch [20/319] time 0.058 (0.095) data 0.000 (0.030) loss 2.0621 (2.0811) ce_loss 0.9873 (1.0702) teacher_loss 0.7795 (0.8390) loss_zs_kd 0.9041 (0.9646) loss_oracle 0.8509 (0.8329) acc 62.5000 (58.1250) kd_loss 0.8572 (0.8256) lr 1.7713e-05 eta 0:00:58
epoch [49/50] batch [40/319] time 0.074 (0.079) data 0.000 (0.015) loss 2.3417 (2.1226) ce_loss 1.0674 (1.0613) teacher_loss 1.1071 (0.8757) loss_zs_kd 0.9171 (0.9552) loss_oracle 0.8164 (0.8330) acc 56.2500 (58.9844) kd_loss 0.8264 (0.8304) lr 1.7713e-05 eta 0:00:47
epoch [49/50] batch [60/319] time 0.066 (0.074) data 0.000 (0.010) loss 1.8944 (2.1304) ce_loss 0.7393 (1.0733) teacher_loss 0.6032 (0.8777) loss_zs_kd 0.7727 (0.9511) loss_oracle 0.8496 (0.8342) acc 75.0000 (58.6979) kd_loss 0.8665 (0.8355) lr 1.7713e-05 eta 0:00:42
epoch [49/50] batch [80/319] time 0.086 (0.075) data 0.000 (0.008) loss 2.2336 (2.1437) ce_loss 1.1201 (1.0788) teacher_loss 0.9913 (0.8862) loss_zs_kd 1.0004 (0.9384) loss_oracle 0.8143 (0.8330) acc 46.8750 (59.1797) kd_loss 0.8351 (0.8411) lr 1.7713e-05 eta 0:00:41
epoch [49/50] batch [100/319] time 0.078 (0.077) data 0.000 (0.006) loss 2.0166 (2.1237) ce_loss 0.9595 (1.0609) teacher_loss 0.8481 (0.8659) loss_zs_kd 1.1048 (0.9350) loss_oracle 0.7757 (0.8312) acc 65.6250 (60.0312) kd_loss 0.7807 (0.8422) lr 1.7713e-05 eta 0:00:41
epoch [49/50] batch [120/319] time 0.078 (0.078) data 0.000 (0.005) loss 1.9058 (2.1367) ce_loss 0.8467 (1.0739) teacher_loss 0.6409 (0.8775) loss_zs_kd 1.0618 (0.9334) loss_oracle 0.8362 (0.8306) acc 71.8750 (59.3490) kd_loss 0.8468 (0.8439) lr 1.7713e-05 eta 0:00:40
epoch [49/50] batch [140/319] time 0.086 (0.079) data 0.000 (0.005) loss 2.0039 (2.1317) ce_loss 1.0186 (1.0715) teacher_loss 0.7482 (0.8731) loss_zs_kd 0.8439 (0.9374) loss_oracle 0.8165 (0.8308) acc 68.7500 (59.5089) kd_loss 0.8474 (0.8433) lr 1.7713e-05 eta 0:00:39
epoch [49/50] batch [160/319] time 0.086 (0.080) data 0.000 (0.004) loss 1.8076 (2.1328) ce_loss 0.8594 (1.0681) teacher_loss 0.5859 (0.8752) loss_zs_kd 0.8758 (0.9415) loss_oracle 0.7915 (0.8313) acc 71.8750 (59.4141) kd_loss 0.8260 (0.8419) lr 1.7713e-05 eta 0:00:38
epoch [49/50] batch [180/319] time 0.063 (0.079) data 0.000 (0.004) loss 2.1501 (2.1432) ce_loss 1.0908 (1.0777) teacher_loss 0.8355 (0.8860) loss_zs_kd 0.8144 (0.9428) loss_oracle 0.8501 (0.8314) acc 59.3750 (58.9236) kd_loss 0.8896 (0.8415) lr 1.7713e-05 eta 0:00:36
epoch [49/50] batch [200/319] time 0.091 (0.079) data 0.000 (0.003) loss 2.0160 (2.1449) ce_loss 0.9756 (1.0795) teacher_loss 0.6863 (0.8884) loss_zs_kd 1.0759 (0.9463) loss_oracle 0.8580 (0.8321) acc 53.1250 (58.8750) kd_loss 0.9008 (0.8405) lr 1.7713e-05 eta 0:00:34
epoch [49/50] batch [220/319] time 0.083 (0.079) data 0.000 (0.003) loss 2.2767 (2.1440) ce_loss 1.1973 (1.0799) teacher_loss 1.0035 (0.8866) loss_zs_kd 0.9120 (0.9470) loss_oracle 0.8439 (0.8323) acc 53.1250 (58.7358) kd_loss 0.8513 (0.8413) lr 1.7713e-05 eta 0:00:33
epoch [49/50] batch [240/319] time 0.082 (0.080) data 0.000 (0.003) loss 2.0455 (2.1497) ce_loss 0.9478 (1.0830) teacher_loss 0.7899 (0.8910) loss_zs_kd 1.0198 (0.9489) loss_oracle 0.8433 (0.8328) acc 59.3750 (58.8021) kd_loss 0.8339 (0.8423) lr 1.7713e-05 eta 0:00:31
epoch [49/50] batch [260/319] time 0.082 (0.080) data 0.000 (0.003) loss 2.0285 (2.1479) ce_loss 1.2119 (1.0795) teacher_loss 0.7806 (0.8889) loss_zs_kd 0.9876 (0.9477) loss_oracle 0.8560 (0.8328) acc 56.2500 (58.8101) kd_loss 0.8199 (0.8426) lr 1.7713e-05 eta 0:00:30
epoch [49/50] batch [280/319] time 0.082 (0.080) data 0.000 (0.002) loss 1.8907 (2.1481) ce_loss 0.8003 (1.0813) teacher_loss 0.5350 (0.8892) loss_zs_kd 0.9182 (0.9464) loss_oracle 0.8388 (0.8330) acc 65.6250 (58.6049) kd_loss 0.9364 (0.8423) lr 1.7713e-05 eta 0:00:28
epoch [49/50] batch [300/319] time 0.104 (0.081) data 0.000 (0.002) loss 2.0056 (2.1400) ce_loss 0.9253 (1.0736) teacher_loss 0.7705 (0.8812) loss_zs_kd 1.0495 (0.9497) loss_oracle 0.8621 (0.8329) acc 62.5000 (58.9583) kd_loss 0.8041 (0.8424) lr 1.7713e-05 eta 0:00:27
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,862
* accuracy: 65.4%
* error: 34.6%
* macro_f1: 57.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,088
* accuracy: 52.3%
* error: 47.7%
* macro_f1: 22.6%
******* Domain 2 best val acc:      65.6%, epoch: 45 *******
******* Domain 2 best val test acc: 52.5%, epoch: 45 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [50/50] batch [20/319] time 0.084 (0.117) data 0.000 (0.028) loss 1.9095 (2.1958) ce_loss 0.9604 (1.1005) teacher_loss 0.6190 (0.9300) loss_zs_kd 0.9499 (0.9456) loss_oracle 0.8163 (0.8299) acc 65.6250 (57.8125) kd_loss 0.8823 (0.8508) lr 7.8853e-06 eta 0:00:34
epoch [50/50] batch [40/319] time 0.077 (0.100) data 0.000 (0.014) loss 2.2321 (2.1548) ce_loss 0.9941 (1.0740) teacher_loss 0.9544 (0.8991) loss_zs_kd 1.3246 (0.9480) loss_oracle 0.8623 (0.8291) acc 71.8750 (58.8281) kd_loss 0.8465 (0.8411) lr 7.8853e-06 eta 0:00:27
epoch [50/50] batch [60/319] time 0.105 (0.097) data 0.000 (0.009) loss 2.0911 (2.1567) ce_loss 0.9277 (1.0708) teacher_loss 0.8480 (0.8958) loss_zs_kd 0.9298 (0.9531) loss_oracle 0.8557 (0.8298) acc 65.6250 (59.6875) kd_loss 0.8153 (0.8460) lr 7.8853e-06 eta 0:00:25
epoch [50/50] batch [80/319] time 0.099 (0.099) data 0.001 (0.007) loss 1.9863 (2.1421) ce_loss 1.0947 (1.0619) teacher_loss 0.7465 (0.8770) loss_zs_kd 0.7929 (0.9464) loss_oracle 0.8227 (0.8318) acc 50.0000 (59.8438) kd_loss 0.8284 (0.8492) lr 7.8853e-06 eta 0:00:23
epoch [50/50] batch [100/319] time 0.081 (0.096) data 0.000 (0.006) loss 2.3560 (2.1525) ce_loss 1.2363 (1.0722) teacher_loss 1.0522 (0.8898) loss_zs_kd 0.8336 (0.9414) loss_oracle 0.8406 (0.8325) acc 59.3750 (59.3438) kd_loss 0.8834 (0.8465) lr 7.8853e-06 eta 0:00:21
epoch [50/50] batch [120/319] time 0.089 (0.094) data 0.000 (0.005) loss 2.2278 (2.1447) ce_loss 1.2090 (1.0745) teacher_loss 0.9912 (0.8832) loss_zs_kd 0.7456 (0.9346) loss_oracle 0.8282 (0.8324) acc 65.6250 (59.2188) kd_loss 0.8226 (0.8453) lr 7.8853e-06 eta 0:00:18
epoch [50/50] batch [140/319] time 0.086 (0.093) data 0.000 (0.004) loss 2.0277 (2.1438) ce_loss 0.7534 (1.0732) teacher_loss 0.6719 (0.8804) loss_zs_kd 0.9461 (0.9356) loss_oracle 0.8475 (0.8326) acc 75.0000 (59.1295) kd_loss 0.9321 (0.8470) lr 7.8853e-06 eta 0:00:16
epoch [50/50] batch [160/319] time 0.078 (0.092) data 0.000 (0.004) loss 2.1899 (2.1496) ce_loss 1.0361 (1.0797) teacher_loss 0.9508 (0.8876) loss_zs_kd 0.7837 (0.9423) loss_oracle 0.8436 (0.8335) acc 59.3750 (58.7500) kd_loss 0.8173 (0.8452) lr 7.8853e-06 eta 0:00:14
epoch [50/50] batch [180/319] time 0.088 (0.091) data 0.000 (0.003) loss 2.0066 (2.1469) ce_loss 1.0244 (1.0802) teacher_loss 0.7262 (0.8849) loss_zs_kd 1.1514 (0.9454) loss_oracle 0.7730 (0.8330) acc 62.5000 (58.6632) kd_loss 0.8939 (0.8455) lr 7.8853e-06 eta 0:00:12
epoch [50/50] batch [200/319] time 0.104 (0.092) data 0.001 (0.003) loss 2.0206 (2.1511) ce_loss 1.0830 (1.0829) teacher_loss 0.7673 (0.8882) loss_zs_kd 0.9540 (0.9463) loss_oracle 0.8353 (0.8325) acc 68.7500 (58.8594) kd_loss 0.8356 (0.8466) lr 7.8853e-06 eta 0:00:10
epoch [50/50] batch [220/319] time 0.095 (0.091) data 0.000 (0.003) loss 2.0365 (2.1450) ce_loss 0.8647 (1.0783) teacher_loss 0.8157 (0.8834) loss_zs_kd 0.9913 (0.9470) loss_oracle 0.8222 (0.8327) acc 75.0000 (58.8068) kd_loss 0.8097 (0.8452) lr 7.8853e-06 eta 0:00:09
epoch [50/50] batch [240/319] time 0.080 (0.091) data 0.000 (0.003) loss 2.2866 (2.1366) ce_loss 1.2549 (1.0737) teacher_loss 0.9436 (0.8756) loss_zs_kd 0.7358 (0.9434) loss_oracle 0.8433 (0.8330) acc 53.1250 (58.9714) kd_loss 0.9213 (0.8445) lr 7.8853e-06 eta 0:00:07
epoch [50/50] batch [260/319] time 0.084 (0.090) data 0.000 (0.002) loss 1.9512 (2.1392) ce_loss 0.9717 (1.0751) teacher_loss 0.6861 (0.8785) loss_zs_kd 1.0644 (0.9445) loss_oracle 0.8358 (0.8332) acc 68.7500 (58.9663) kd_loss 0.8472 (0.8442) lr 7.8853e-06 eta 0:00:05
epoch [50/50] batch [280/319] time 0.086 (0.090) data 0.001 (0.002) loss 2.7867 (2.1360) ce_loss 1.4561 (1.0739) teacher_loss 1.4936 (0.8761) loss_zs_kd 0.8484 (0.9427) loss_oracle 0.8234 (0.8327) acc 43.7500 (59.2299) kd_loss 0.8815 (0.8435) lr 7.8853e-06 eta 0:00:03
epoch [50/50] batch [300/319] time 0.082 (0.089) data 0.000 (0.002) loss 2.1481 (2.1311) ce_loss 1.2373 (1.0715) teacher_loss 0.9190 (0.8710) loss_zs_kd 1.0599 (0.9431) loss_oracle 0.8353 (0.8326) acc 56.2500 (59.4375) kd_loss 0.8115 (0.8438) lr 7.8853e-06 eta 0:00:01
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,858
* accuracy: 65.3%
* error: 34.7%
* macro_f1: 57.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,094
* accuracy: 52.3%
* error: 47.7%
* macro_f1: 22.6%
******* Domain 2 best val acc:      65.6%, epoch: 45 *******
******* Domain 2 best val test acc: 52.5%, epoch: 45 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
Checkpoint saved to icml/multi-dg/oracle/08_nouse_ema_and_0.0zeroshot_and_tau0.1_seperate/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:44:57
