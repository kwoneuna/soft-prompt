Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_100', 'location_43', 'location_46']
Target     ['location_38']
# classes  10
# train_x  10,216
# val      4,378
# test     9,736
---------  ----------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/319] time 0.094 (0.163) data 0.000 (0.040) loss 1.4534 (2.2177) ce_loss 1.2549 (2.0158) teacher_loss 1.2528 (2.0152) loss_zs_kd 0.0002 (0.0001) loss_oracle 0.2006 (0.2025) acc 59.3750 (36.8750) kd_loss 0.9628 (0.9466) lr 1.0000e-05 eta 0:43:19
epoch [1/50] batch [40/319] time 0.077 (0.127) data 0.000 (0.020) loss 1.7665 (2.1124) ce_loss 1.5752 (1.9127) teacher_loss 1.5746 (1.9121) loss_zs_kd 0.0015 (0.0003) loss_oracle 0.1918 (0.2003) acc 56.2500 (39.8438) kd_loss 0.9064 (0.9283) lr 1.0000e-05 eta 0:33:47
epoch [1/50] batch [60/319] time 0.176 (0.115) data 0.000 (0.014) loss 2.3797 (2.1433) ce_loss 2.1699 (1.9407) teacher_loss 2.1716 (1.9404) loss_zs_kd 0.0026 (0.0008) loss_oracle 0.2081 (0.2029) acc 31.2500 (39.2708) kd_loss 0.9491 (0.9336) lr 1.0000e-05 eta 0:30:23
epoch [1/50] batch [80/319] time 0.067 (0.111) data 0.000 (0.010) loss 2.2079 (2.1283) ce_loss 1.9766 (1.9221) teacher_loss 1.9702 (1.9215) loss_zs_kd 0.0041 (0.0015) loss_oracle 0.2377 (0.2068) acc 43.7500 (38.8672) kd_loss 0.9235 (0.9324) lr 1.0000e-05 eta 0:29:20
epoch [1/50] batch [100/319] time 0.076 (0.107) data 0.000 (0.008) loss 2.3992 (2.0963) ce_loss 2.1680 (1.8832) teacher_loss 2.1710 (1.8828) loss_zs_kd 0.0083 (0.0025) loss_oracle 0.2282 (0.2134) acc 25.0000 (39.4688) kd_loss 1.0048 (0.9303) lr 1.0000e-05 eta 0:28:16
epoch [1/50] batch [120/319] time 0.080 (0.105) data 0.000 (0.007) loss 2.0870 (2.0988) ce_loss 1.8672 (1.8809) teacher_loss 1.8661 (1.8809) loss_zs_kd 0.0065 (0.0035) loss_oracle 0.2209 (0.2179) acc 40.6250 (39.6354) kd_loss 0.8698 (0.9287) lr 1.0000e-05 eta 0:27:38
epoch [1/50] batch [140/319] time 0.083 (0.104) data 0.000 (0.006) loss 2.2327 (2.0982) ce_loss 2.0508 (1.8808) teacher_loss 2.0505 (1.8808) loss_zs_kd 0.0103 (0.0045) loss_oracle 0.1822 (0.2174) acc 37.5000 (39.5759) kd_loss 0.8176 (0.9264) lr 1.0000e-05 eta 0:27:21
epoch [1/50] batch [160/319] time 0.088 (0.103) data 0.000 (0.005) loss 2.0289 (2.0924) ce_loss 1.8291 (1.8768) teacher_loss 1.8241 (1.8768) loss_zs_kd 0.0138 (0.0058) loss_oracle 0.2048 (0.2156) acc 34.3750 (39.7070) kd_loss 0.9074 (0.9246) lr 1.0000e-05 eta 0:27:11
epoch [1/50] batch [180/319] time 0.148 (0.105) data 0.000 (0.005) loss 2.3698 (2.0883) ce_loss 2.1719 (1.8733) teacher_loss 2.1712 (1.8734) loss_zs_kd 0.0238 (0.0073) loss_oracle 0.1986 (0.2149) acc 28.1250 (39.6181) kd_loss 0.8519 (0.9231) lr 1.0000e-05 eta 0:27:37
epoch [1/50] batch [200/319] time 0.078 (0.106) data 0.000 (0.004) loss 2.2517 (2.0853) ce_loss 1.9932 (1.8687) teacher_loss 1.9913 (1.8687) loss_zs_kd 0.0248 (0.0089) loss_oracle 0.2604 (0.2166) acc 31.2500 (39.5625) kd_loss 0.9751 (0.9231) lr 1.0000e-05 eta 0:27:48
epoch [1/50] batch [220/319] time 0.068 (0.107) data 0.001 (0.004) loss 1.9879 (2.0945) ce_loss 1.7129 (1.8743) teacher_loss 1.7087 (1.8743) loss_zs_kd 0.0326 (0.0108) loss_oracle 0.2792 (0.2202) acc 50.0000 (39.1903) kd_loss 0.9470 (0.9235) lr 1.0000e-05 eta 0:27:57
epoch [1/50] batch [240/319] time 0.072 (0.107) data 0.000 (0.004) loss 2.1785 (2.1043) ce_loss 1.9336 (1.8807) teacher_loss 1.9297 (1.8808) loss_zs_kd 0.0452 (0.0128) loss_oracle 0.2488 (0.2235) acc 28.1250 (38.8802) kd_loss 0.8989 (0.9254) lr 1.0000e-05 eta 0:28:00
epoch [1/50] batch [260/319] time 0.145 (0.106) data 0.000 (0.003) loss 2.2543 (2.1042) ce_loss 1.9736 (1.8779) teacher_loss 1.9806 (1.8779) loss_zs_kd 0.0415 (0.0149) loss_oracle 0.2737 (0.2263) acc 40.6250 (38.8221) kd_loss 0.8925 (0.9255) lr 1.0000e-05 eta 0:27:44
epoch [1/50] batch [280/319] time 0.085 (0.106) data 0.000 (0.003) loss 2.3721 (2.1048) ce_loss 2.0684 (1.8738) teacher_loss 2.0918 (1.8740) loss_zs_kd 0.0606 (0.0172) loss_oracle 0.2803 (0.2308) acc 31.2500 (38.8393) kd_loss 0.9579 (0.9256) lr 1.0000e-05 eta 0:27:41
epoch [1/50] batch [300/319] time 0.098 (0.105) data 0.000 (0.003) loss 2.5586 (2.1040) ce_loss 2.2773 (1.8695) teacher_loss 2.2817 (1.8698) loss_zs_kd 0.0592 (0.0197) loss_oracle 0.2768 (0.2342) acc 31.2500 (38.8229) kd_loss 0.9081 (0.9255) lr 1.0000e-05 eta 0:27:21
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 1,773
* accuracy: 40.5%
* error: 59.5%
* macro_f1: 26.1%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,207
* accuracy: 32.9%
* error: 67.1%
* macro_f1: 14.2%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      40.5%, epoch: 1 *******
******* Domain 2 best val test acc: 32.9%, epoch: 1 *******
******* Domain 2 best test acc:     32.9%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/ana
epoch [2/50] batch [20/319] time 0.093 (0.124) data 0.000 (0.025) loss 2.5143 (2.3371) ce_loss 1.7568 (1.7054) teacher_loss 1.5941 (1.6725) loss_zs_kd 0.6244 (0.4990) loss_oracle 0.9202 (0.6646) acc 28.1250 (37.1875) kd_loss 1.0168 (0.9905) lr 2.0000e-03 eta 0:32:08
epoch [2/50] batch [40/319] time 0.104 (0.114) data 0.000 (0.013) loss 2.7620 (2.4277) ce_loss 2.0430 (1.7004) teacher_loss 1.8791 (1.6267) loss_zs_kd 0.4792 (0.6267) loss_oracle 0.8829 (0.8010) acc 28.1250 (37.3438) kd_loss 1.0292 (1.0156) lr 2.0000e-03 eta 0:29:34
epoch [2/50] batch [60/319] time 0.105 (0.110) data 0.000 (0.009) loss 2.4813 (2.4374) ce_loss 1.7646 (1.6681) teacher_loss 1.4907 (1.5795) loss_zs_kd 0.3677 (0.5531) loss_oracle 0.9906 (0.8579) acc 34.3750 (38.2292) kd_loss 1.0505 (1.0246) lr 2.0000e-03 eta 0:28:36
epoch [2/50] batch [80/319] time 0.084 (0.106) data 0.000 (0.007) loss 2.0378 (2.3732) ce_loss 1.4922 (1.6219) teacher_loss 1.4039 (1.5474) loss_zs_kd 0.4397 (0.4996) loss_oracle 0.6339 (0.8258) acc 53.1250 (39.6875) kd_loss 1.0151 (1.0285) lr 2.0000e-03 eta 0:27:28
epoch [2/50] batch [100/319] time 0.078 (0.104) data 0.000 (0.005) loss 2.1920 (2.3058) ce_loss 1.6992 (1.6024) teacher_loss 1.5053 (1.5340) loss_zs_kd 0.3950 (0.4825) loss_oracle 0.6867 (0.7718) acc 34.3750 (40.1250) kd_loss 1.0505 (1.0371) lr 2.0000e-03 eta 0:27:01
epoch [2/50] batch [120/319] time 0.077 (0.105) data 0.000 (0.004) loss 1.7544 (2.2713) ce_loss 1.2090 (1.5819) teacher_loss 1.0762 (1.5135) loss_zs_kd 0.3804 (0.4770) loss_oracle 0.6782 (0.7578) acc 62.5000 (40.5729) kd_loss 1.0631 (1.0375) lr 2.0000e-03 eta 0:27:14
epoch [2/50] batch [140/319] time 0.079 (0.106) data 0.000 (0.004) loss 2.3561 (2.2492) ce_loss 1.7275 (1.5757) teacher_loss 1.5408 (1.4995) loss_zs_kd 0.5189 (0.4757) loss_oracle 0.8153 (0.7497) acc 37.5000 (40.6250) kd_loss 1.0631 (1.0385) lr 2.0000e-03 eta 0:27:22
epoch [2/50] batch [160/319] time 0.093 (0.104) data 0.000 (0.003) loss 2.2527 (2.2325) ce_loss 1.4639 (1.5604) teacher_loss 1.3376 (1.4779) loss_zs_kd 0.4631 (0.4842) loss_oracle 0.9151 (0.7546) acc 46.8750 (41.5625) kd_loss 1.0825 (1.0417) lr 2.0000e-03 eta 0:26:50
epoch [2/50] batch [180/319] time 0.080 (0.105) data 0.000 (0.003) loss 2.5662 (2.2465) ce_loss 1.6357 (1.5615) teacher_loss 1.4945 (1.4709) loss_zs_kd 0.6379 (0.5004) loss_oracle 1.0716 (0.7756) acc 28.1250 (41.5799) kd_loss 1.0660 (1.0428) lr 2.0000e-03 eta 0:27:04
epoch [2/50] batch [200/319] time 0.140 (0.106) data 0.000 (0.003) loss 2.2805 (2.2542) ce_loss 1.4834 (1.5632) teacher_loss 1.3736 (1.4652) loss_zs_kd 0.6674 (0.5202) loss_oracle 0.9070 (0.7890) acc 53.1250 (41.6250) kd_loss 1.0335 (1.0417) lr 2.0000e-03 eta 0:27:19
epoch [2/50] batch [220/319] time 0.172 (0.108) data 0.000 (0.003) loss 2.5771 (2.2511) ce_loss 1.7520 (1.5594) teacher_loss 1.6519 (1.4562) loss_zs_kd 0.3932 (0.5216) loss_oracle 0.9252 (0.7949) acc 31.2500 (41.4489) kd_loss 1.0257 (1.0392) lr 2.0000e-03 eta 0:27:37
epoch [2/50] batch [240/319] time 0.082 (0.108) data 0.000 (0.002) loss 1.8512 (2.2385) ce_loss 1.1406 (1.5476) teacher_loss 0.9756 (1.4395) loss_zs_kd 0.4891 (0.5131) loss_oracle 0.8756 (0.7991) acc 53.1250 (41.9141) kd_loss 1.0249 (1.0375) lr 2.0000e-03 eta 0:27:39
epoch [2/50] batch [260/319] time 0.076 (0.108) data 0.000 (0.002) loss 2.1323 (2.2242) ce_loss 1.4521 (1.5363) teacher_loss 1.2935 (1.4174) loss_zs_kd 0.4363 (0.5144) loss_oracle 0.8389 (0.8068) acc 46.8750 (42.2476) kd_loss 1.0135 (1.0346) lr 2.0000e-03 eta 0:27:46
epoch [2/50] batch [280/319] time 0.092 (0.109) data 0.000 (0.002) loss 2.0758 (2.2157) ce_loss 1.4072 (1.5326) teacher_loss 1.3513 (1.4105) loss_zs_kd 0.4167 (0.5123) loss_oracle 0.7245 (0.8052) acc 46.8750 (42.3438) kd_loss 0.9960 (1.0319) lr 2.0000e-03 eta 0:27:48
epoch [2/50] batch [300/319] time 0.110 (0.108) data 0.000 (0.002) loss 1.8815 (2.2077) ce_loss 1.3018 (1.5298) teacher_loss 1.1027 (1.4058) loss_zs_kd 0.4758 (0.5136) loss_oracle 0.7787 (0.8019) acc 46.8750 (42.3021) kd_loss 0.9850 (1.0286) lr 2.0000e-03 eta 0:27:35
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,096
* accuracy: 47.9%
* error: 52.1%
* macro_f1: 36.2%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,458
* accuracy: 45.8%
* error: 54.2%
* macro_f1: 17.6%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      47.9%, epoch: 2 *******
******* Domain 2 best val test acc: 45.8%, epoch: 2 *******
******* Domain 2 best test acc:     45.8%, epoch: 2 *******
epoch [3/50] batch [20/319] time 0.104 (0.144) data 0.000 (0.033) loss 1.7337 (1.8909) ce_loss 1.1045 (1.3206) teacher_loss 1.0089 (1.1996) loss_zs_kd 0.4173 (0.5066) loss_oracle 0.7248 (0.6913) acc 56.2500 (50.7812) kd_loss 0.9540 (0.9723) lr 1.9980e-03 eta 0:36:44
epoch [3/50] batch [40/319] time 0.096 (0.123) data 0.000 (0.017) loss 1.8878 (1.9515) ce_loss 1.3018 (1.3492) teacher_loss 1.1386 (1.2312) loss_zs_kd 0.5511 (0.5177) loss_oracle 0.7492 (0.7204) acc 50.0000 (49.2188) kd_loss 0.9648 (0.9705) lr 1.9980e-03 eta 0:31:25
epoch [3/50] batch [60/319] time 0.084 (0.113) data 0.001 (0.011) loss 1.8837 (1.9361) ce_loss 1.2090 (1.3519) teacher_loss 1.0183 (1.2170) loss_zs_kd 0.5972 (0.5319) loss_oracle 0.8654 (0.7190) acc 53.1250 (48.8542) kd_loss 0.9468 (0.9650) lr 1.9980e-03 eta 0:28:47
epoch [3/50] batch [80/319] time 0.081 (0.110) data 0.000 (0.009) loss 1.7815 (1.9485) ce_loss 1.1523 (1.3581) teacher_loss 1.0648 (1.2203) loss_zs_kd 0.4949 (0.5477) loss_oracle 0.7167 (0.7282) acc 62.5000 (48.3203) kd_loss 0.9402 (0.9615) lr 1.9980e-03 eta 0:27:50
epoch [3/50] batch [100/319] time 0.158 (0.111) data 0.000 (0.007) loss 1.9952 (1.9583) ce_loss 1.1699 (1.3609) teacher_loss 1.1631 (1.2232) loss_zs_kd 0.5140 (0.5394) loss_oracle 0.8321 (0.7351) acc 68.7500 (48.6562) kd_loss 0.8808 (0.9559) lr 1.9980e-03 eta 0:28:10
epoch [3/50] batch [120/319] time 0.086 (0.112) data 0.000 (0.006) loss 2.1623 (1.9586) ce_loss 1.4844 (1.3574) teacher_loss 1.4155 (1.2221) loss_zs_kd 0.5278 (0.5376) loss_oracle 0.7468 (0.7365) acc 43.7500 (49.0365) kd_loss 0.9732 (0.9559) lr 1.9980e-03 eta 0:28:20
epoch [3/50] batch [140/319] time 0.084 (0.108) data 0.000 (0.005) loss 1.6827 (1.9506) ce_loss 1.0996 (1.3517) teacher_loss 0.9843 (1.2162) loss_zs_kd 0.5412 (0.5402) loss_oracle 0.6984 (0.7343) acc 65.6250 (49.2188) kd_loss 0.9508 (0.9540) lr 1.9980e-03 eta 0:27:23
epoch [3/50] batch [160/319] time 0.083 (0.108) data 0.000 (0.004) loss 1.8267 (1.9404) ce_loss 1.1982 (1.3497) teacher_loss 1.0907 (1.2056) loss_zs_kd 0.6872 (0.5506) loss_oracle 0.7360 (0.7349) acc 59.3750 (49.0625) kd_loss 0.9372 (0.9520) lr 1.9980e-03 eta 0:27:09
epoch [3/50] batch [180/319] time 0.155 (0.109) data 0.000 (0.004) loss 2.1333 (1.9355) ce_loss 1.3574 (1.3493) teacher_loss 1.3458 (1.2072) loss_zs_kd 0.4451 (0.5584) loss_oracle 0.7875 (0.7283) acc 50.0000 (48.9583) kd_loss 0.9459 (0.9505) lr 1.9980e-03 eta 0:27:28
epoch [3/50] batch [200/319] time 0.164 (0.110) data 0.000 (0.004) loss 1.9882 (1.9370) ce_loss 1.3496 (1.3476) teacher_loss 1.2523 (1.2038) loss_zs_kd 0.6085 (0.5541) loss_oracle 0.7359 (0.7332) acc 59.3750 (48.9531) kd_loss 0.9427 (0.9477) lr 1.9980e-03 eta 0:27:41
epoch [3/50] batch [220/319] time 0.082 (0.109) data 0.000 (0.003) loss 1.8170 (1.9356) ce_loss 1.3984 (1.3499) teacher_loss 1.0375 (1.1981) loss_zs_kd 0.5229 (0.5610) loss_oracle 0.7795 (0.7375) acc 31.2500 (48.7216) kd_loss 0.9798 (0.9467) lr 1.9980e-03 eta 0:27:32
epoch [3/50] batch [240/319] time 0.174 (0.110) data 0.000 (0.003) loss 2.1464 (1.9345) ce_loss 1.5488 (1.3463) teacher_loss 1.2734 (1.1913) loss_zs_kd 0.7482 (0.5682) loss_oracle 0.8730 (0.7433) acc 43.7500 (48.9453) kd_loss 0.9519 (0.9458) lr 1.9980e-03 eta 0:27:31
epoch [3/50] batch [260/319] time 0.156 (0.110) data 0.001 (0.003) loss 1.9462 (1.9356) ce_loss 1.2412 (1.3452) teacher_loss 1.1891 (1.1940) loss_zs_kd 0.6348 (0.5755) loss_oracle 0.7571 (0.7416) acc 53.1250 (49.1106) kd_loss 0.9262 (0.9453) lr 1.9980e-03 eta 0:27:37
epoch [3/50] batch [280/319] time 0.097 (0.109) data 0.000 (0.003) loss 1.8821 (1.9308) ce_loss 1.3223 (1.3430) teacher_loss 1.0264 (1.1880) loss_zs_kd 0.7511 (0.5862) loss_oracle 0.8557 (0.7428) acc 46.8750 (49.1071) kd_loss 0.9392 (0.9440) lr 1.9980e-03 eta 0:27:20
epoch [3/50] batch [300/319] time 0.101 (0.109) data 0.000 (0.003) loss 1.6636 (1.9265) ce_loss 1.1836 (1.3437) teacher_loss 0.8957 (1.1851) loss_zs_kd 0.8643 (0.6008) loss_oracle 0.7679 (0.7414) acc 56.2500 (49.3125) kd_loss 0.9490 (0.9431) lr 1.9980e-03 eta 0:27:09
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,132
* accuracy: 48.7%
* error: 51.3%
* macro_f1: 38.0%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,176
* accuracy: 53.2%
* error: 46.8%
* macro_f1: 20.9%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      48.7%, epoch: 3 *******
******* Domain 2 best val test acc: 53.2%, epoch: 3 *******
******* Domain 2 best test acc:     53.2%, epoch: 3 *******
epoch [4/50] batch [20/319] time 0.108 (0.132) data 0.000 (0.025) loss 1.9699 (1.8683) ce_loss 1.4727 (1.3855) teacher_loss 1.1251 (1.1037) loss_zs_kd 0.9057 (0.8968) loss_oracle 0.8448 (0.7646) acc 37.5000 (45.0000) kd_loss 0.8913 (0.9106) lr 1.9921e-03 eta 0:33:00
epoch [4/50] batch [40/319] time 0.099 (0.115) data 0.000 (0.013) loss 1.8153 (1.8618) ce_loss 1.2803 (1.3515) teacher_loss 1.1174 (1.0986) loss_zs_kd 0.7519 (0.9202) loss_oracle 0.6979 (0.7632) acc 46.8750 (46.5625) kd_loss 0.9714 (0.9189) lr 1.9921e-03 eta 0:28:41
epoch [4/50] batch [60/319] time 0.076 (0.103) data 0.000 (0.009) loss 1.8636 (1.8531) ce_loss 1.5244 (1.3285) teacher_loss 1.1650 (1.0896) loss_zs_kd 0.9526 (0.8840) loss_oracle 0.6986 (0.7635) acc 46.8750 (48.8021) kd_loss 0.9415 (0.9153) lr 1.9921e-03 eta 0:25:38
epoch [4/50] batch [80/319] time 0.149 (0.103) data 0.000 (0.007) loss 1.9919 (1.8594) ce_loss 1.3379 (1.3371) teacher_loss 1.3068 (1.1003) loss_zs_kd 0.7487 (0.8621) loss_oracle 0.6852 (0.7591) acc 56.2500 (48.8281) kd_loss 0.8844 (0.9110) lr 1.9921e-03 eta 0:25:33
epoch [4/50] batch [100/319] time 0.080 (0.105) data 0.000 (0.005) loss 2.0560 (1.8535) ce_loss 1.3584 (1.3335) teacher_loss 1.3597 (1.0979) loss_zs_kd 0.8047 (0.8476) loss_oracle 0.6962 (0.7557) acc 46.8750 (49.0625) kd_loss 0.8954 (0.9073) lr 1.9921e-03 eta 0:26:07
epoch [4/50] batch [120/319] time 0.091 (0.106) data 0.000 (0.004) loss 1.9344 (1.8527) ce_loss 1.4551 (1.3311) teacher_loss 1.1958 (1.1003) loss_zs_kd 0.7336 (0.8360) loss_oracle 0.7386 (0.7524) acc 53.1250 (49.2969) kd_loss 0.8784 (0.9046) lr 1.9921e-03 eta 0:26:19
epoch [4/50] batch [140/319] time 0.094 (0.104) data 0.000 (0.004) loss 2.0940 (1.8503) ce_loss 1.3906 (1.3276) teacher_loss 1.4310 (1.1053) loss_zs_kd 1.0365 (0.8423) loss_oracle 0.6630 (0.7451) acc 50.0000 (49.6205) kd_loss 0.8834 (0.9050) lr 1.9921e-03 eta 0:25:40
epoch [4/50] batch [160/319] time 0.081 (0.104) data 0.000 (0.003) loss 2.1867 (1.8440) ce_loss 1.5947 (1.3297) teacher_loss 1.5602 (1.1100) loss_zs_kd 0.9891 (0.8481) loss_oracle 0.6265 (0.7340) acc 37.5000 (49.6484) kd_loss 0.9830 (0.9079) lr 1.9921e-03 eta 0:25:39
epoch [4/50] batch [180/319] time 0.151 (0.105) data 0.000 (0.003) loss 1.8015 (1.8387) ce_loss 1.2725 (1.3264) teacher_loss 1.1589 (1.1158) loss_zs_kd 0.7348 (0.8506) loss_oracle 0.6426 (0.7230) acc 53.1250 (49.5660) kd_loss 0.9161 (0.9120) lr 1.9921e-03 eta 0:25:57
epoch [4/50] batch [200/319] time 0.148 (0.106) data 0.000 (0.003) loss 1.7080 (1.8372) ce_loss 1.2217 (1.3191) teacher_loss 1.0796 (1.1222) loss_zs_kd 0.7518 (0.8441) loss_oracle 0.6284 (0.7151) acc 56.2500 (49.9531) kd_loss 0.9065 (0.9114) lr 1.9921e-03 eta 0:26:12
epoch [4/50] batch [220/319] time 0.147 (0.107) data 0.000 (0.003) loss 1.8260 (1.8288) ce_loss 1.2803 (1.3099) teacher_loss 1.2412 (1.1204) loss_zs_kd 0.8722 (0.8401) loss_oracle 0.5848 (0.7084) acc 46.8750 (50.3835) kd_loss 0.8560 (0.9099) lr 1.9921e-03 eta 0:26:19
epoch [4/50] batch [240/319] time 0.157 (0.108) data 0.000 (0.002) loss 1.8980 (1.8291) ce_loss 1.2168 (1.3090) teacher_loss 1.2614 (1.1240) loss_zs_kd 0.8114 (0.8386) loss_oracle 0.6365 (0.7052) acc 53.1250 (50.4167) kd_loss 0.8186 (0.9085) lr 1.9921e-03 eta 0:26:32
epoch [4/50] batch [260/319] time 0.162 (0.109) data 0.000 (0.002) loss 2.0489 (1.8311) ce_loss 1.3721 (1.3096) teacher_loss 1.2866 (1.1269) loss_zs_kd 0.9639 (0.8396) loss_oracle 0.7623 (0.7042) acc 46.8750 (50.3005) kd_loss 0.8692 (0.9053) lr 1.9921e-03 eta 0:26:45
epoch [4/50] batch [280/319] time 0.100 (0.108) data 0.000 (0.002) loss 1.7650 (1.8269) ce_loss 1.3418 (1.3052) teacher_loss 1.0981 (1.1250) loss_zs_kd 0.8178 (0.8392) loss_oracle 0.6668 (0.7019) acc 46.8750 (50.4576) kd_loss 0.8223 (0.9019) lr 1.9921e-03 eta 0:26:28
epoch [4/50] batch [300/319] time 0.096 (0.108) data 0.000 (0.002) loss 1.6144 (1.8234) ce_loss 1.1084 (1.2990) teacher_loss 0.8976 (1.1218) loss_zs_kd 0.9963 (0.8392) loss_oracle 0.7168 (0.7016) acc 59.3750 (50.6354) kd_loss 0.9001 (0.9008) lr 1.9921e-03 eta 0:26:22
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,253
* accuracy: 51.5%
* error: 48.5%
* macro_f1: 40.9%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,143
* accuracy: 52.8%
* error: 47.2%
* macro_f1: 19.0%
******* Domain 2 best val acc:      51.5%, epoch: 4 *******
******* Domain 2 best val test acc: 52.8%, epoch: 4 *******
******* Domain 2 best test acc:     53.2%, epoch: 3 *******
epoch [5/50] batch [20/319] time 0.167 (0.125) data 0.000 (0.025) loss 1.7638 (1.7999) ce_loss 1.2773 (1.2842) teacher_loss 1.1239 (1.1006) loss_zs_kd 0.8057 (0.8886) loss_oracle 0.6399 (0.6993) acc 50.0000 (49.6875) kd_loss 0.8752 (0.8764) lr 1.9823e-03 eta 0:30:38
epoch [5/50] batch [40/319] time 0.082 (0.117) data 0.000 (0.013) loss 1.4851 (1.7915) ce_loss 1.0127 (1.2880) teacher_loss 0.7861 (1.1145) loss_zs_kd 0.9112 (0.9206) loss_oracle 0.6990 (0.6770) acc 56.2500 (49.8438) kd_loss 0.9077 (0.8650) lr 1.9823e-03 eta 0:28:28
epoch [5/50] batch [60/319] time 0.173 (0.114) data 0.001 (0.009) loss 1.7146 (1.8001) ce_loss 1.1943 (1.2857) teacher_loss 0.9940 (1.1260) loss_zs_kd 0.9991 (0.8988) loss_oracle 0.7206 (0.6740) acc 56.2500 (49.8958) kd_loss 0.8328 (0.8651) lr 1.9823e-03 eta 0:27:49
epoch [5/50] batch [80/319] time 0.069 (0.112) data 0.000 (0.007) loss 1.5612 (1.7965) ce_loss 1.0283 (1.2713) teacher_loss 0.7618 (1.1154) loss_zs_kd 0.7968 (0.8969) loss_oracle 0.7994 (0.6811) acc 68.7500 (50.9766) kd_loss 0.8598 (0.8567) lr 1.9823e-03 eta 0:27:09
epoch [5/50] batch [100/319] time 0.171 (0.110) data 0.000 (0.005) loss 1.8139 (1.7909) ce_loss 1.3047 (1.2662) teacher_loss 1.1273 (1.1023) loss_zs_kd 0.9688 (0.9092) loss_oracle 0.6866 (0.6885) acc 43.7500 (51.5938) kd_loss 0.9114 (0.8552) lr 1.9823e-03 eta 0:26:43
epoch [5/50] batch [120/319] time 0.154 (0.111) data 0.000 (0.005) loss 1.7546 (1.7946) ce_loss 1.2080 (1.2692) teacher_loss 1.1232 (1.1141) loss_zs_kd 0.7293 (0.8946) loss_oracle 0.6315 (0.6804) acc 46.8750 (51.4583) kd_loss 0.9064 (0.8558) lr 1.9823e-03 eta 0:26:55
epoch [5/50] batch [140/319] time 0.160 (0.112) data 0.000 (0.004) loss 2.0022 (1.7850) ce_loss 1.5381 (1.2615) teacher_loss 1.4051 (1.1113) loss_zs_kd 0.8207 (0.8903) loss_oracle 0.5971 (0.6737) acc 34.3750 (51.8973) kd_loss 0.9302 (0.8608) lr 1.9823e-03 eta 0:27:09
epoch [5/50] batch [160/319] time 0.158 (0.113) data 0.000 (0.003) loss 1.7788 (1.7814) ce_loss 1.3369 (1.2527) teacher_loss 1.2800 (1.1156) loss_zs_kd 0.7655 (0.8818) loss_oracle 0.4988 (0.6658) acc 50.0000 (52.4219) kd_loss 1.0485 (0.8743) lr 1.9823e-03 eta 0:27:18
epoch [5/50] batch [180/319] time 0.171 (0.112) data 0.000 (0.003) loss 1.5370 (1.7729) ce_loss 1.0537 (1.2483) teacher_loss 0.9638 (1.1184) loss_zs_kd 0.9505 (0.8782) loss_oracle 0.5732 (0.6545) acc 65.6250 (52.6389) kd_loss 1.0045 (0.8886) lr 1.9823e-03 eta 0:27:08
epoch [5/50] batch [200/319] time 0.164 (0.112) data 0.000 (0.003) loss 1.7031 (1.7700) ce_loss 1.1846 (1.2457) teacher_loss 1.0838 (1.1212) loss_zs_kd 0.9333 (0.8712) loss_oracle 0.6193 (0.6488) acc 62.5000 (52.9375) kd_loss 0.9658 (0.8926) lr 1.9823e-03 eta 0:27:05
epoch [5/50] batch [220/319] time 0.074 (0.112) data 0.000 (0.003) loss 1.6608 (1.7771) ce_loss 1.0098 (1.2454) teacher_loss 0.9894 (1.1266) loss_zs_kd 0.8029 (0.8621) loss_oracle 0.6713 (0.6505) acc 68.7500 (53.0114) kd_loss 0.9654 (0.9002) lr 1.9823e-03 eta 0:26:52
epoch [5/50] batch [240/319] time 0.092 (0.110) data 0.000 (0.002) loss 1.8306 (1.7888) ce_loss 1.1357 (1.2488) teacher_loss 1.0768 (1.1322) loss_zs_kd 0.6923 (0.8582) loss_oracle 0.7538 (0.6566) acc 50.0000 (52.8906) kd_loss 0.9480 (0.9070) lr 1.9823e-03 eta 0:26:31
epoch [5/50] batch [260/319] time 0.111 (0.109) data 0.000 (0.002) loss 1.9503 (1.7956) ce_loss 1.3877 (1.2518) teacher_loss 1.4198 (1.1342) loss_zs_kd 0.9696 (0.8588) loss_oracle 0.5305 (0.6615) acc 46.8750 (52.5962) kd_loss 0.9274 (0.9100) lr 1.9823e-03 eta 0:26:17
epoch [5/50] batch [280/319] time 0.083 (0.108) data 0.000 (0.002) loss 1.3136 (1.7935) ce_loss 0.8550 (1.2510) teacher_loss 0.7771 (1.1350) loss_zs_kd 0.5607 (0.8544) loss_oracle 0.5365 (0.6585) acc 68.7500 (52.6451) kd_loss 0.9736 (0.9119) lr 1.9823e-03 eta 0:25:57
epoch [5/50] batch [300/319] time 0.092 (0.107) data 0.000 (0.002) loss 1.8894 (1.7907) ce_loss 1.2861 (1.2472) teacher_loss 1.2678 (1.1365) loss_zs_kd 0.7188 (0.8478) loss_oracle 0.6217 (0.6543) acc 53.1250 (52.8438) kd_loss 0.8657 (0.9097) lr 1.9823e-03 eta 0:25:37
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,677
* accuracy: 61.1%
* error: 38.9%
* macro_f1: 51.5%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,587
* accuracy: 47.1%
* error: 52.9%
* macro_f1: 21.1%
******* Domain 2 best val acc:      61.1%, epoch: 5 *******
******* Domain 2 best val test acc: 47.1%, epoch: 5 *******
******* Domain 2 best test acc:     53.2%, epoch: 3 *******
epoch [6/50] batch [20/319] time 0.094 (0.132) data 0.000 (0.029) loss 1.8434 (1.6487) ce_loss 1.3779 (1.1507) teacher_loss 1.1871 (1.0992) loss_zs_kd 0.8320 (0.7728) loss_oracle 0.6563 (0.5495) acc 37.5000 (57.0312) kd_loss 0.9254 (0.8993) lr 1.9686e-03 eta 0:31:32
epoch [6/50] batch [40/319] time 0.088 (0.122) data 0.000 (0.015) loss 1.7647 (1.6372) ce_loss 1.2822 (1.1421) teacher_loss 1.0845 (1.0538) loss_zs_kd 0.7921 (0.7877) loss_oracle 0.6802 (0.5834) acc 50.0000 (56.7969) kd_loss 0.8593 (0.8885) lr 1.9686e-03 eta 0:29:01
epoch [6/50] batch [60/319] time 0.172 (0.122) data 0.000 (0.010) loss 1.7782 (1.6751) ce_loss 1.2500 (1.1696) teacher_loss 1.2121 (1.0869) loss_zs_kd 0.7803 (0.7775) loss_oracle 0.5660 (0.5882) acc 46.8750 (55.1562) kd_loss 0.8970 (0.8827) lr 1.9686e-03 eta 0:28:58
epoch [6/50] batch [80/319] time 0.068 (0.111) data 0.000 (0.008) loss 1.7536 (1.6790) ce_loss 1.2598 (1.1740) teacher_loss 1.1973 (1.0981) loss_zs_kd 0.7880 (0.7742) loss_oracle 0.5564 (0.5809) acc 59.3750 (54.6484) kd_loss 0.8852 (0.8825) lr 1.9686e-03 eta 0:26:24
epoch [6/50] batch [100/319] time 0.078 (0.111) data 0.000 (0.006) loss 1.7457 (1.6942) ce_loss 1.0205 (1.1851) teacher_loss 1.0144 (1.1156) loss_zs_kd 0.8184 (0.7638) loss_oracle 0.7313 (0.5786) acc 65.6250 (54.4688) kd_loss 0.9082 (0.8827) lr 1.9686e-03 eta 0:26:21
epoch [6/50] batch [120/319] time 0.077 (0.112) data 0.001 (0.005) loss 1.7867 (1.7083) ce_loss 1.1885 (1.1842) teacher_loss 1.0565 (1.1115) loss_zs_kd 0.9541 (0.7755) loss_oracle 0.7301 (0.5968) acc 53.1250 (54.9740) kd_loss 0.9059 (0.8869) lr 1.9686e-03 eta 0:26:29
epoch [6/50] batch [140/319] time 0.094 (0.112) data 0.000 (0.004) loss 2.0373 (1.7193) ce_loss 1.3486 (1.1828) teacher_loss 1.3222 (1.1088) loss_zs_kd 0.7956 (0.7854) loss_oracle 0.7151 (0.6104) acc 50.0000 (55.2232) kd_loss 0.8324 (0.8849) lr 1.9686e-03 eta 0:26:30
epoch [6/50] batch [160/319] time 0.079 (0.112) data 0.000 (0.004) loss 1.7888 (1.7241) ce_loss 1.1328 (1.1865) teacher_loss 1.0852 (1.1014) loss_zs_kd 0.7594 (0.7986) loss_oracle 0.7036 (0.6227) acc 62.5000 (55.2148) kd_loss 0.9289 (0.8847) lr 1.9686e-03 eta 0:26:33
epoch [6/50] batch [180/319] time 0.090 (0.113) data 0.000 (0.004) loss 1.9925 (1.7349) ce_loss 1.4307 (1.1939) teacher_loss 1.3273 (1.1085) loss_zs_kd 0.8176 (0.8000) loss_oracle 0.6653 (0.6264) acc 50.0000 (55.2083) kd_loss 0.8446 (0.8843) lr 1.9686e-03 eta 0:26:39
epoch [6/50] batch [200/319] time 0.071 (0.113) data 0.000 (0.003) loss 1.6617 (1.7279) ce_loss 1.1279 (1.1901) teacher_loss 1.0670 (1.1039) loss_zs_kd 0.7285 (0.7917) loss_oracle 0.5947 (0.6239) acc 62.5000 (55.3750) kd_loss 0.8640 (0.8826) lr 1.9686e-03 eta 0:26:32
epoch [6/50] batch [220/319] time 0.103 (0.112) data 0.000 (0.003) loss 1.6699 (1.7292) ce_loss 1.0898 (1.1881) teacher_loss 1.0074 (1.1044) loss_zs_kd 0.8321 (0.7995) loss_oracle 0.6625 (0.6249) acc 65.6250 (55.5114) kd_loss 0.9334 (0.8829) lr 1.9686e-03 eta 0:26:25
epoch [6/50] batch [240/319] time 0.108 (0.112) data 0.000 (0.003) loss 1.9867 (1.7332) ce_loss 1.4033 (1.1917) teacher_loss 1.4383 (1.1117) loss_zs_kd 0.7641 (0.7973) loss_oracle 0.5484 (0.6215) acc 34.3750 (55.3776) kd_loss 0.8509 (0.8820) lr 1.9686e-03 eta 0:26:13
epoch [6/50] batch [260/319] time 0.105 (0.111) data 0.000 (0.003) loss 1.5121 (1.7284) ce_loss 1.0205 (1.1922) teacher_loss 0.8988 (1.1104) loss_zs_kd 0.7988 (0.7923) loss_oracle 0.6133 (0.6180) acc 53.1250 (55.3726) kd_loss 0.9223 (0.8818) lr 1.9686e-03 eta 0:26:03
epoch [6/50] batch [280/319] time 0.101 (0.110) data 0.000 (0.002) loss 1.5993 (1.7250) ce_loss 1.1338 (1.1950) teacher_loss 1.0645 (1.1113) loss_zs_kd 0.7006 (0.7905) loss_oracle 0.5348 (0.6136) acc 56.2500 (55.1674) kd_loss 0.8790 (0.8816) lr 1.9686e-03 eta 0:25:53
epoch [6/50] batch [300/319] time 0.097 (0.110) data 0.000 (0.002) loss 1.6290 (1.7242) ce_loss 1.2549 (1.1995) teacher_loss 1.0006 (1.1099) loss_zs_kd 0.8069 (0.7850) loss_oracle 0.6284 (0.6143) acc 56.2500 (54.8646) kd_loss 0.8746 (0.8802) lr 1.9686e-03 eta 0:25:45
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,686
* accuracy: 61.4%
* error: 38.6%
* macro_f1: 53.0%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,015
* accuracy: 51.5%
* error: 48.5%
* macro_f1: 22.1%
******* Domain 2 best val acc:      61.4%, epoch: 6 *******
******* Domain 2 best val test acc: 51.5%, epoch: 6 *******
******* Domain 2 best test acc:     53.2%, epoch: 3 *******
epoch [7/50] batch [20/319] time 0.137 (0.157) data 0.000 (0.037) loss 1.3694 (1.6615) ce_loss 0.8545 (1.1595) teacher_loss 0.7209 (1.0672) loss_zs_kd 0.7846 (0.7698) loss_oracle 0.6485 (0.5943) acc 71.8750 (59.6875) kd_loss 0.8534 (0.8464) lr 1.9511e-03 eta 0:36:46
epoch [7/50] batch [40/319] time 0.134 (0.137) data 0.000 (0.019) loss 2.0629 (1.6959) ce_loss 1.4199 (1.1884) teacher_loss 1.3597 (1.1057) loss_zs_kd 0.8105 (0.7677) loss_oracle 0.7032 (0.5901) acc 56.2500 (57.4219) kd_loss 0.8682 (0.8440) lr 1.9511e-03 eta 0:31:53
epoch [7/50] batch [60/319] time 0.088 (0.120) data 0.001 (0.013) loss 1.6715 (1.6591) ce_loss 1.1318 (1.1781) teacher_loss 0.9606 (1.0644) loss_zs_kd 0.8591 (0.7812) loss_oracle 0.7109 (0.5948) acc 59.3750 (57.3958) kd_loss 0.8829 (0.8468) lr 1.9511e-03 eta 0:27:54
epoch [7/50] batch [80/319] time 0.073 (0.119) data 0.000 (0.010) loss 1.7310 (1.6578) ce_loss 1.1396 (1.1841) teacher_loss 1.0678 (1.0666) loss_zs_kd 0.7475 (0.7861) loss_oracle 0.6632 (0.5912) acc 56.2500 (56.7969) kd_loss 0.8143 (0.8464) lr 1.9511e-03 eta 0:27:36
epoch [7/50] batch [100/319] time 0.099 (0.116) data 0.000 (0.008) loss 1.7241 (1.6629) ce_loss 1.2285 (1.1993) teacher_loss 1.0699 (1.0714) loss_zs_kd 0.7605 (0.7868) loss_oracle 0.6542 (0.5915) acc 59.3750 (55.6875) kd_loss 0.8490 (0.8487) lr 1.9511e-03 eta 0:27:02
epoch [7/50] batch [120/319] time 0.172 (0.114) data 0.000 (0.006) loss 2.0126 (1.6590) ce_loss 1.5029 (1.2009) teacher_loss 1.4285 (1.0614) loss_zs_kd 0.8192 (0.7945) loss_oracle 0.5841 (0.5976) acc 37.5000 (54.9479) kd_loss 0.8420 (0.8489) lr 1.9511e-03 eta 0:26:23
epoch [7/50] batch [140/319] time 0.070 (0.112) data 0.000 (0.006) loss 1.5594 (1.6630) ce_loss 1.1367 (1.2018) teacher_loss 1.0737 (1.0627) loss_zs_kd 0.7229 (0.7916) loss_oracle 0.4856 (0.6003) acc 50.0000 (54.8214) kd_loss 0.8642 (0.8499) lr 1.9511e-03 eta 0:25:58
epoch [7/50] batch [160/319] time 0.147 (0.112) data 0.000 (0.005) loss 1.4869 (1.6614) ce_loss 0.9893 (1.2003) teacher_loss 0.9341 (1.0678) loss_zs_kd 0.7225 (0.7885) loss_oracle 0.5528 (0.5936) acc 68.7500 (54.6484) kd_loss 0.8459 (0.8509) lr 1.9511e-03 eta 0:25:53
epoch [7/50] batch [180/319] time 0.165 (0.112) data 0.000 (0.004) loss 1.5471 (1.6644) ce_loss 1.2871 (1.2028) teacher_loss 1.0446 (1.0784) loss_zs_kd 0.8733 (0.7953) loss_oracle 0.5025 (0.5860) acc 53.1250 (54.5660) kd_loss 0.8915 (0.8506) lr 1.9511e-03 eta 0:25:47
epoch [7/50] batch [200/319] time 0.083 (0.110) data 0.000 (0.004) loss 2.0724 (1.6602) ce_loss 1.4229 (1.1960) teacher_loss 1.3976 (1.0734) loss_zs_kd 0.9987 (0.7994) loss_oracle 0.6748 (0.5868) acc 50.0000 (54.9062) kd_loss 0.8895 (0.8524) lr 1.9511e-03 eta 0:25:22
epoch [7/50] batch [220/319] time 0.101 (0.109) data 0.000 (0.004) loss 1.8950 (1.6622) ce_loss 1.1143 (1.1910) teacher_loss 1.1962 (1.0656) loss_zs_kd 0.9627 (0.8087) loss_oracle 0.6988 (0.5966) acc 59.3750 (55.2841) kd_loss 0.8722 (0.8537) lr 1.9511e-03 eta 0:25:00
epoch [7/50] batch [240/319] time 0.098 (0.108) data 0.000 (0.003) loss 1.9179 (1.6676) ce_loss 1.2070 (1.1914) teacher_loss 1.3008 (1.0659) loss_zs_kd 0.8685 (0.8207) loss_oracle 0.6171 (0.6018) acc 53.1250 (55.1953) kd_loss 0.8414 (0.8536) lr 1.9511e-03 eta 0:24:52
epoch [7/50] batch [260/319] time 0.101 (0.108) data 0.000 (0.003) loss 1.5853 (1.6700) ce_loss 1.0000 (1.1913) teacher_loss 0.9911 (1.0699) loss_zs_kd 0.7461 (0.8169) loss_oracle 0.5942 (0.6001) acc 65.6250 (55.1442) kd_loss 0.8493 (0.8520) lr 1.9511e-03 eta 0:24:46
epoch [7/50] batch [280/319] time 0.134 (0.108) data 0.000 (0.003) loss 1.6918 (1.6742) ce_loss 1.1123 (1.1908) teacher_loss 0.9861 (1.0720) loss_zs_kd 0.9522 (0.8155) loss_oracle 0.7057 (0.6022) acc 59.3750 (55.3013) kd_loss 0.8336 (0.8505) lr 1.9511e-03 eta 0:24:41
epoch [7/50] batch [300/319] time 0.102 (0.108) data 0.000 (0.003) loss 1.5940 (1.6727) ce_loss 1.2832 (1.1881) teacher_loss 1.0246 (1.0713) loss_zs_kd 0.8720 (0.8128) loss_oracle 0.5694 (0.6014) acc 43.7500 (55.3125) kd_loss 0.8336 (0.8493) lr 1.9511e-03 eta 0:24:40
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,749
* accuracy: 62.8%
* error: 37.2%
* macro_f1: 54.3%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,950
* accuracy: 50.8%
* error: 49.2%
* macro_f1: 21.2%
******* Domain 2 best val acc:      62.8%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     53.2%, epoch: 3 *******
epoch [8/50] batch [20/319] time 0.088 (0.139) data 0.000 (0.038) loss 1.8919 (1.7600) ce_loss 1.3965 (1.2284) teacher_loss 1.1942 (1.1386) loss_zs_kd 0.7658 (0.7232) loss_oracle 0.6977 (0.6214) acc 43.7500 (54.6875) kd_loss 0.8900 (0.8547) lr 1.9298e-03 eta 0:31:48
epoch [8/50] batch [40/319] time 0.157 (0.123) data 0.000 (0.019) loss 1.5295 (1.7347) ce_loss 1.0264 (1.1902) teacher_loss 0.8232 (1.0881) loss_zs_kd 0.8730 (0.7930) loss_oracle 0.7063 (0.6465) acc 56.2500 (55.3906) kd_loss 0.8356 (0.8543) lr 1.9298e-03 eta 0:28:08
epoch [8/50] batch [60/319] time 0.161 (0.122) data 0.001 (0.013) loss 1.6469 (1.7302) ce_loss 1.2334 (1.1845) teacher_loss 1.0489 (1.0774) loss_zs_kd 0.7718 (0.7940) loss_oracle 0.5980 (0.6529) acc 62.5000 (55.3646) kd_loss 0.8329 (0.8507) lr 1.9298e-03 eta 0:27:52
epoch [8/50] batch [80/319] time 0.084 (0.114) data 0.000 (0.010) loss 1.7044 (1.7081) ce_loss 1.1787 (1.1733) teacher_loss 1.0532 (1.0645) loss_zs_kd 0.6618 (0.7801) loss_oracle 0.6511 (0.6436) acc 46.8750 (55.2734) kd_loss 0.8342 (0.8459) lr 1.9298e-03 eta 0:25:59
epoch [8/50] batch [100/319] time 0.079 (0.113) data 0.000 (0.008) loss 1.6268 (1.7121) ce_loss 0.9785 (1.1771) teacher_loss 0.9066 (1.0755) loss_zs_kd 0.8122 (0.7800) loss_oracle 0.7202 (0.6365) acc 65.6250 (55.1562) kd_loss 0.8105 (0.8403) lr 1.9298e-03 eta 0:25:36
epoch [8/50] batch [120/319] time 0.174 (0.112) data 0.000 (0.007) loss 1.9112 (1.7081) ce_loss 1.3066 (1.1664) teacher_loss 1.2938 (1.0714) loss_zs_kd 0.9034 (0.7789) loss_oracle 0.6174 (0.6368) acc 59.3750 (55.6510) kd_loss 0.8430 (0.8397) lr 1.9298e-03 eta 0:25:25
epoch [8/50] batch [140/319] time 0.165 (0.113) data 0.000 (0.006) loss 1.7087 (1.7162) ce_loss 1.0908 (1.1678) teacher_loss 1.1233 (1.0807) loss_zs_kd 0.9831 (0.7739) loss_oracle 0.5854 (0.6355) acc 59.3750 (55.6473) kd_loss 0.8150 (0.8370) lr 1.9298e-03 eta 0:25:36
epoch [8/50] batch [160/319] time 0.085 (0.113) data 0.000 (0.005) loss 1.8567 (1.7159) ce_loss 1.2510 (1.1694) teacher_loss 1.1670 (1.0841) loss_zs_kd 0.6883 (0.7736) loss_oracle 0.6897 (0.6318) acc 59.3750 (55.7812) kd_loss 0.9068 (0.8333) lr 1.9298e-03 eta 0:25:36
epoch [8/50] batch [180/319] time 0.095 (0.114) data 0.000 (0.005) loss 1.8983 (1.7132) ce_loss 1.2881 (1.1709) teacher_loss 1.3403 (1.0853) loss_zs_kd 0.7406 (0.7835) loss_oracle 0.5580 (0.6279) acc 50.0000 (55.9896) kd_loss 0.7288 (0.8308) lr 1.9298e-03 eta 0:25:36
epoch [8/50] batch [200/319] time 0.079 (0.114) data 0.000 (0.004) loss 1.6302 (1.7046) ce_loss 1.1709 (1.1670) teacher_loss 1.0084 (1.0808) loss_zs_kd 1.0248 (0.7896) loss_oracle 0.6219 (0.6238) acc 53.1250 (55.9688) kd_loss 0.7848 (0.8297) lr 1.9298e-03 eta 0:25:35
epoch [8/50] batch [220/319] time 0.099 (0.112) data 0.000 (0.004) loss 1.4367 (1.7017) ce_loss 0.9009 (1.1671) teacher_loss 0.8761 (1.0778) loss_zs_kd 0.8812 (0.7929) loss_oracle 0.5606 (0.6239) acc 62.5000 (55.9375) kd_loss 0.8171 (0.8300) lr 1.9298e-03 eta 0:25:12
epoch [8/50] batch [240/319] time 0.104 (0.111) data 0.000 (0.003) loss 2.0645 (1.6917) ce_loss 1.3867 (1.1650) teacher_loss 1.4073 (1.0696) loss_zs_kd 0.8195 (0.7970) loss_oracle 0.6571 (0.6222) acc 53.1250 (56.0156) kd_loss 0.8273 (0.8289) lr 1.9298e-03 eta 0:24:59
epoch [8/50] batch [260/319] time 0.110 (0.111) data 0.000 (0.003) loss 1.8779 (1.6891) ce_loss 1.4541 (1.1650) teacher_loss 1.3033 (1.0660) loss_zs_kd 0.8667 (0.8012) loss_oracle 0.5747 (0.6231) acc 43.7500 (55.9856) kd_loss 0.8423 (0.8285) lr 1.9298e-03 eta 0:24:49
epoch [8/50] batch [280/319] time 0.116 (0.110) data 0.000 (0.003) loss 1.8990 (1.6853) ce_loss 1.2676 (1.1625) teacher_loss 1.3489 (1.0611) loss_zs_kd 0.7603 (0.8024) loss_oracle 0.5501 (0.6242) acc 43.7500 (55.8371) kd_loss 0.8223 (0.8286) lr 1.9298e-03 eta 0:24:40
epoch [8/50] batch [300/319] time 0.099 (0.110) data 0.000 (0.003) loss 1.9071 (1.6892) ce_loss 1.4873 (1.1669) teacher_loss 1.3162 (1.0673) loss_zs_kd 0.7211 (0.8050) loss_oracle 0.5909 (0.6219) acc 50.0000 (55.7500) kd_loss 0.8323 (0.8290) lr 1.9298e-03 eta 0:24:33
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,534
* accuracy: 57.9%
* error: 42.1%
* macro_f1: 51.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,361
* accuracy: 55.1%
* error: 44.9%
* macro_f1: 21.8%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      62.8%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     55.1%, epoch: 8 *******
epoch [9/50] batch [20/319] time 0.092 (0.153) data 0.000 (0.036) loss 1.4548 (1.5683) ce_loss 1.0420 (1.1267) teacher_loss 0.8763 (0.9659) loss_zs_kd 0.9097 (0.9453) loss_oracle 0.5785 (0.6024) acc 56.2500 (56.2500) kd_loss 0.8350 (0.8336) lr 1.9048e-03 eta 0:34:06
epoch [9/50] batch [40/319] time 0.085 (0.121) data 0.000 (0.018) loss 1.4959 (1.5924) ce_loss 1.1211 (1.1027) teacher_loss 0.9000 (0.9780) loss_zs_kd 0.9440 (0.9358) loss_oracle 0.5960 (0.6144) acc 56.2500 (58.2812) kd_loss 0.8090 (0.8313) lr 1.9048e-03 eta 0:26:51
epoch [9/50] batch [60/319] time 0.161 (0.116) data 0.000 (0.012) loss 1.8178 (1.6296) ce_loss 1.2930 (1.1248) teacher_loss 1.1586 (1.0100) loss_zs_kd 0.8408 (0.9055) loss_oracle 0.6592 (0.6197) acc 46.8750 (57.0312) kd_loss 0.8439 (0.8315) lr 1.9048e-03 eta 0:25:46
epoch [9/50] batch [80/319] time 0.150 (0.114) data 0.000 (0.009) loss 1.7034 (1.6475) ce_loss 1.1963 (1.1422) teacher_loss 1.0777 (1.0232) loss_zs_kd 0.8345 (0.9094) loss_oracle 0.6258 (0.6243) acc 59.3750 (56.6406) kd_loss 0.8310 (0.8285) lr 1.9048e-03 eta 0:25:19
epoch [9/50] batch [100/319] time 0.156 (0.114) data 0.000 (0.007) loss 1.7673 (1.6559) ce_loss 1.2783 (1.1441) teacher_loss 1.1636 (1.0291) loss_zs_kd 0.6662 (0.8808) loss_oracle 0.6037 (0.6268) acc 50.0000 (56.7812) kd_loss 0.7840 (0.8270) lr 1.9048e-03 eta 0:25:14
epoch [9/50] batch [120/319] time 0.162 (0.114) data 0.000 (0.006) loss 1.6978 (1.6673) ce_loss 1.1992 (1.1556) teacher_loss 1.0511 (1.0432) loss_zs_kd 0.6312 (0.8549) loss_oracle 0.6467 (0.6241) acc 56.2500 (56.4844) kd_loss 0.8693 (0.8238) lr 1.9048e-03 eta 0:25:11
epoch [9/50] batch [140/319] time 0.078 (0.113) data 0.000 (0.005) loss 2.1232 (1.6788) ce_loss 1.4795 (1.1606) teacher_loss 1.5493 (1.0592) loss_zs_kd 0.7318 (0.8397) loss_oracle 0.5739 (0.6196) acc 37.5000 (55.8929) kd_loss 0.8297 (0.8201) lr 1.9048e-03 eta 0:24:55
epoch [9/50] batch [160/319] time 0.072 (0.113) data 0.000 (0.005) loss 1.7351 (1.6743) ce_loss 1.1416 (1.1536) teacher_loss 1.0582 (1.0553) loss_zs_kd 0.8212 (0.8329) loss_oracle 0.6770 (0.6190) acc 56.2500 (56.3672) kd_loss 0.8506 (0.8202) lr 1.9048e-03 eta 0:24:49
epoch [9/50] batch [180/319] time 0.097 (0.112) data 0.000 (0.004) loss 1.4510 (1.6639) ce_loss 1.1221 (1.1468) teacher_loss 0.7908 (1.0454) loss_zs_kd 0.9951 (0.8379) loss_oracle 0.6602 (0.6185) acc 59.3750 (56.5625) kd_loss 0.8062 (0.8201) lr 1.9048e-03 eta 0:24:34
epoch [9/50] batch [200/319] time 0.108 (0.110) data 0.000 (0.004) loss 1.5235 (1.6616) ce_loss 1.0967 (1.1482) teacher_loss 0.9317 (1.0441) loss_zs_kd 0.8174 (0.8459) loss_oracle 0.5919 (0.6175) acc 59.3750 (56.5938) kd_loss 0.8365 (0.8200) lr 1.9048e-03 eta 0:24:17
epoch [9/50] batch [220/319] time 0.102 (0.110) data 0.000 (0.004) loss 1.5334 (1.6577) ce_loss 1.1826 (1.1472) teacher_loss 0.8207 (1.0369) loss_zs_kd 0.8386 (0.8470) loss_oracle 0.7128 (0.6208) acc 37.5000 (56.4915) kd_loss 0.8539 (0.8211) lr 1.9048e-03 eta 0:24:07
epoch [9/50] batch [240/319] time 0.100 (0.109) data 0.000 (0.003) loss 1.7723 (1.6618) ce_loss 1.4180 (1.1508) teacher_loss 1.0927 (1.0388) loss_zs_kd 1.1154 (0.8542) loss_oracle 0.6796 (0.6230) acc 40.6250 (56.3932) kd_loss 0.8103 (0.8216) lr 1.9048e-03 eta 0:23:59
epoch [9/50] batch [260/319] time 0.104 (0.109) data 0.000 (0.003) loss 1.5736 (1.6588) ce_loss 1.1455 (1.1522) teacher_loss 1.0616 (1.0387) loss_zs_kd 0.8300 (0.8617) loss_oracle 0.5119 (0.6201) acc 53.1250 (56.1178) kd_loss 0.8275 (0.8219) lr 1.9048e-03 eta 0:23:52
epoch [9/50] batch [280/319] time 0.104 (0.108) data 0.000 (0.003) loss 1.6407 (1.6650) ce_loss 1.0615 (1.1593) teacher_loss 0.9525 (1.0454) loss_zs_kd 1.0350 (0.8664) loss_oracle 0.6882 (0.6196) acc 65.6250 (55.9040) kd_loss 0.8439 (0.8219) lr 1.9048e-03 eta 0:23:41
epoch [9/50] batch [300/319] time 0.102 (0.108) data 0.000 (0.003) loss 1.7897 (1.6642) ce_loss 1.3154 (1.1593) teacher_loss 1.1391 (1.0451) loss_zs_kd 0.8319 (0.8683) loss_oracle 0.6507 (0.6190) acc 56.2500 (55.9271) kd_loss 0.7908 (0.8221) lr 1.9048e-03 eta 0:23:34
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,695
* accuracy: 61.6%
* error: 38.4%
* macro_f1: 52.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,468
* accuracy: 56.2%
* error: 43.8%
* macro_f1: 21.9%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      62.8%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.2%, epoch: 9 *******
epoch [10/50] batch [20/319] time 0.143 (0.144) data 0.000 (0.035) loss 1.7853 (1.6981) ce_loss 1.3389 (1.1964) teacher_loss 1.2424 (1.1096) loss_zs_kd 0.7892 (0.7713) loss_oracle 0.5429 (0.5885) acc 40.6250 (54.0625) kd_loss 0.7812 (0.8237) lr 1.8763e-03 eta 0:31:23
epoch [10/50] batch [40/319] time 0.093 (0.115) data 0.000 (0.018) loss 1.8414 (1.6849) ce_loss 1.1777 (1.1727) teacher_loss 1.2012 (1.0988) loss_zs_kd 0.6572 (0.7355) loss_oracle 0.6401 (0.5860) acc 59.3750 (54.6094) kd_loss 0.8545 (0.8271) lr 1.8763e-03 eta 0:24:57
epoch [10/50] batch [60/319] time 0.081 (0.114) data 0.000 (0.012) loss 1.9745 (1.6822) ce_loss 1.3926 (1.1597) teacher_loss 1.3976 (1.0868) loss_zs_kd 0.6413 (0.7128) loss_oracle 0.5769 (0.5954) acc 43.7500 (55.0521) kd_loss 0.7714 (0.8256) lr 1.8763e-03 eta 0:24:38
epoch [10/50] batch [80/319] time 0.081 (0.113) data 0.000 (0.009) loss 1.4963 (1.6937) ce_loss 0.9336 (1.1639) teacher_loss 0.7960 (1.0909) loss_zs_kd 0.6324 (0.6958) loss_oracle 0.7003 (0.6028) acc 68.7500 (55.0391) kd_loss 0.7641 (0.8210) lr 1.8763e-03 eta 0:24:33
epoch [10/50] batch [100/319] time 0.076 (0.113) data 0.000 (0.007) loss 1.4817 (1.7102) ce_loss 0.9268 (1.1717) teacher_loss 0.8475 (1.1019) loss_zs_kd 0.5477 (0.6901) loss_oracle 0.6342 (0.6084) acc 71.8750 (54.9375) kd_loss 0.8328 (0.8202) lr 1.8763e-03 eta 0:24:26
epoch [10/50] batch [120/319] time 0.072 (0.112) data 0.000 (0.006) loss 1.7476 (1.7126) ce_loss 1.1543 (1.1679) teacher_loss 1.0824 (1.0988) loss_zs_kd 0.6524 (0.6868) loss_oracle 0.6651 (0.6138) acc 56.2500 (55.2604) kd_loss 0.8383 (0.8203) lr 1.8763e-03 eta 0:24:11
epoch [10/50] batch [140/319] time 0.151 (0.112) data 0.000 (0.005) loss 1.7049 (1.7049) ce_loss 1.1494 (1.1600) teacher_loss 1.0332 (1.0883) loss_zs_kd 0.6274 (0.6842) loss_oracle 0.6716 (0.6166) acc 43.7500 (55.4911) kd_loss 0.7673 (0.8182) lr 1.8763e-03 eta 0:24:07
epoch [10/50] batch [160/319] time 0.067 (0.110) data 0.000 (0.005) loss 1.6693 (1.6999) ce_loss 1.1572 (1.1539) teacher_loss 1.0955 (1.0844) loss_zs_kd 0.8477 (0.6881) loss_oracle 0.5737 (0.6154) acc 50.0000 (55.9961) kd_loss 0.7686 (0.8175) lr 1.8763e-03 eta 0:23:36
epoch [10/50] batch [180/319] time 0.130 (0.107) data 0.001 (0.004) loss 1.7732 (1.7073) ce_loss 1.1797 (1.1600) teacher_loss 1.1080 (1.0921) loss_zs_kd 0.5626 (0.6946) loss_oracle 0.6652 (0.6152) acc 62.5000 (56.0069) kd_loss 0.7907 (0.8176) lr 1.8763e-03 eta 0:22:58
epoch [10/50] batch [200/319] time 0.092 (0.106) data 0.000 (0.004) loss 1.4050 (1.7046) ce_loss 0.8301 (1.1585) teacher_loss 0.8089 (1.0914) loss_zs_kd 0.6309 (0.6872) loss_oracle 0.5961 (0.6132) acc 75.0000 (56.0000) kd_loss 0.7902 (0.8162) lr 1.8763e-03 eta 0:22:50
epoch [10/50] batch [220/319] time 0.093 (0.106) data 0.000 (0.003) loss 1.4007 (1.6974) ce_loss 0.9858 (1.1584) teacher_loss 0.8452 (1.0884) loss_zs_kd 0.7725 (0.6926) loss_oracle 0.5555 (0.6090) acc 59.3750 (56.2358) kd_loss 0.8204 (0.8171) lr 1.8763e-03 eta 0:22:39
epoch [10/50] batch [240/319] time 0.102 (0.106) data 0.000 (0.003) loss 1.6819 (1.6941) ce_loss 1.0664 (1.1614) teacher_loss 1.1483 (1.0901) loss_zs_kd 0.8743 (0.7043) loss_oracle 0.5336 (0.6040) acc 62.5000 (56.1068) kd_loss 0.8266 (0.8175) lr 1.8763e-03 eta 0:22:35
epoch [10/50] batch [260/319] time 0.099 (0.106) data 0.000 (0.003) loss 1.6787 (1.6900) ce_loss 1.1006 (1.1627) teacher_loss 1.0875 (1.0862) loss_zs_kd 1.0108 (0.7140) loss_oracle 0.5912 (0.6038) acc 59.3750 (56.0337) kd_loss 0.8421 (0.8173) lr 1.8763e-03 eta 0:22:32
epoch [10/50] batch [280/319] time 0.099 (0.105) data 0.000 (0.003) loss 1.6476 (1.6817) ce_loss 1.1064 (1.1578) teacher_loss 0.9977 (1.0780) loss_zs_kd 0.8689 (0.7262) loss_oracle 0.6499 (0.6036) acc 53.1250 (56.0938) kd_loss 0.7859 (0.8176) lr 1.8763e-03 eta 0:22:29
epoch [10/50] batch [300/319] time 0.107 (0.105) data 0.000 (0.003) loss 1.7341 (1.6822) ce_loss 1.1934 (1.1572) teacher_loss 1.0569 (1.0768) loss_zs_kd 0.7962 (0.7339) loss_oracle 0.6772 (0.6054) acc 56.2500 (56.0417) kd_loss 0.7847 (0.8174) lr 1.8763e-03 eta 0:22:26
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,656
* accuracy: 60.7%
* error: 39.3%
* macro_f1: 53.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,301
* accuracy: 54.4%
* error: 45.6%
* macro_f1: 21.3%
******* Domain 2 best val acc:      62.8%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.2%, epoch: 9 *******
epoch [11/50] batch [20/319] time 0.072 (0.147) data 0.000 (0.034) loss 1.5831 (1.5642) ce_loss 1.0967 (1.1010) teacher_loss 0.9503 (0.9485) loss_zs_kd 0.7923 (0.7705) loss_oracle 0.6328 (0.6157) acc 53.1250 (57.5000) kd_loss 0.8528 (0.8150) lr 1.8443e-03 eta 0:31:14
epoch [11/50] batch [40/319] time 0.080 (0.115) data 0.000 (0.017) loss 1.4244 (1.5983) ce_loss 0.9858 (1.1094) teacher_loss 0.7890 (0.9675) loss_zs_kd 0.8103 (0.8239) loss_oracle 0.6354 (0.6308) acc 59.3750 (56.1719) kd_loss 0.8399 (0.8218) lr 1.8443e-03 eta 0:24:22
epoch [11/50] batch [60/319] time 0.176 (0.114) data 0.001 (0.012) loss 1.8152 (1.6111) ce_loss 1.2061 (1.1226) teacher_loss 1.1454 (0.9704) loss_zs_kd 1.0204 (0.8359) loss_oracle 0.6698 (0.6408) acc 53.1250 (56.2500) kd_loss 0.8643 (0.8235) lr 1.8443e-03 eta 0:24:04
epoch [11/50] batch [80/319] time 0.182 (0.115) data 0.000 (0.009) loss 1.9542 (1.6242) ce_loss 1.3447 (1.1294) teacher_loss 1.2638 (0.9717) loss_zs_kd 1.0546 (0.8498) loss_oracle 0.6904 (0.6525) acc 53.1250 (56.6797) kd_loss 0.8033 (0.8258) lr 1.8443e-03 eta 0:24:12
epoch [11/50] batch [100/319] time 0.074 (0.114) data 0.000 (0.007) loss 1.6455 (1.6373) ce_loss 1.1182 (1.1423) teacher_loss 0.9851 (0.9796) loss_zs_kd 0.8260 (0.8621) loss_oracle 0.6604 (0.6577) acc 59.3750 (56.2812) kd_loss 0.8467 (0.8266) lr 1.8443e-03 eta 0:24:05
epoch [11/50] batch [120/319] time 0.081 (0.114) data 0.000 (0.006) loss 1.6364 (1.6426) ce_loss 1.0723 (1.1470) teacher_loss 0.9936 (0.9839) loss_zs_kd 0.8787 (0.8684) loss_oracle 0.6428 (0.6587) acc 59.3750 (55.8073) kd_loss 0.7947 (0.8259) lr 1.8443e-03 eta 0:24:06
epoch [11/50] batch [140/319] time 0.082 (0.114) data 0.000 (0.005) loss 2.0185 (1.6381) ce_loss 1.3848 (1.1471) teacher_loss 1.3143 (0.9807) loss_zs_kd 1.0507 (0.8681) loss_oracle 0.7041 (0.6574) acc 43.7500 (56.2723) kd_loss 0.8499 (0.8245) lr 1.8443e-03 eta 0:24:04
epoch [11/50] batch [160/319] time 0.072 (0.113) data 0.000 (0.005) loss 1.2493 (1.6447) ce_loss 0.7998 (1.1530) teacher_loss 0.6819 (0.9886) loss_zs_kd 0.6796 (0.8603) loss_oracle 0.5674 (0.6561) acc 65.6250 (55.9180) kd_loss 0.7922 (0.8231) lr 1.8443e-03 eta 0:23:46
epoch [11/50] batch [180/319] time 0.100 (0.111) data 0.000 (0.004) loss 1.6185 (1.6470) ce_loss 1.2051 (1.1545) teacher_loss 1.0414 (0.9923) loss_zs_kd 0.5964 (0.8393) loss_oracle 0.5772 (0.6547) acc 50.0000 (55.8160) kd_loss 0.7933 (0.8236) lr 1.8443e-03 eta 0:23:15
epoch [11/50] batch [200/319] time 0.078 (0.109) data 0.000 (0.004) loss 1.6010 (1.6446) ce_loss 1.1543 (1.1531) teacher_loss 0.9131 (0.9901) loss_zs_kd 0.7492 (0.8274) loss_oracle 0.6878 (0.6545) acc 62.5000 (55.9062) kd_loss 0.8684 (0.8246) lr 1.8443e-03 eta 0:22:49
epoch [11/50] batch [220/319] time 0.089 (0.107) data 0.000 (0.003) loss 1.7596 (1.6419) ce_loss 1.3262 (1.1503) teacher_loss 1.1399 (0.9890) loss_zs_kd 0.6470 (0.8120) loss_oracle 0.6197 (0.6530) acc 50.0000 (56.0369) kd_loss 0.8318 (0.8237) lr 1.8443e-03 eta 0:22:17
epoch [11/50] batch [240/319] time 0.085 (0.105) data 0.000 (0.003) loss 1.5992 (1.6374) ce_loss 1.0869 (1.1436) teacher_loss 0.9770 (0.9863) loss_zs_kd 0.5776 (0.7980) loss_oracle 0.6222 (0.6511) acc 65.6250 (56.3151) kd_loss 0.7602 (0.8220) lr 1.8443e-03 eta 0:21:51
epoch [11/50] batch [260/319] time 0.066 (0.103) data 0.000 (0.003) loss 1.3531 (1.6380) ce_loss 1.1475 (1.1449) teacher_loss 0.7060 (0.9868) loss_zs_kd 0.8514 (0.7925) loss_oracle 0.6470 (0.6512) acc 43.7500 (56.0938) kd_loss 0.8328 (0.8215) lr 1.8443e-03 eta 0:21:22
epoch [11/50] batch [280/319] time 0.178 (0.101) data 0.000 (0.003) loss 1.8114 (1.6350) ce_loss 1.3408 (1.1417) teacher_loss 1.1105 (0.9844) loss_zs_kd 0.6785 (0.7871) loss_oracle 0.7009 (0.6506) acc 46.8750 (56.2500) kd_loss 0.8673 (0.8223) lr 1.8443e-03 eta 0:20:56
epoch [11/50] batch [300/319] time 0.080 (0.101) data 0.000 (0.003) loss 2.2566 (1.6392) ce_loss 1.7051 (1.1470) teacher_loss 1.5257 (0.9881) loss_zs_kd 0.7739 (0.7847) loss_oracle 0.7309 (0.6511) acc 43.7500 (56.0000) kd_loss 0.8229 (0.8229) lr 1.8443e-03 eta 0:20:57
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,637
* accuracy: 60.2%
* error: 39.8%
* macro_f1: 51.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,346
* accuracy: 54.9%
* error: 45.1%
* macro_f1: 22.1%
******* Domain 2 best val acc:      62.8%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.2%, epoch: 9 *******
epoch [12/50] batch [20/319] time 0.091 (0.116) data 0.000 (0.028) loss 1.5493 (1.6410) ce_loss 1.0713 (1.1568) teacher_loss 0.9339 (0.9864) loss_zs_kd 0.6423 (0.8288) loss_oracle 0.6153 (0.6545) acc 59.3750 (55.4688) kd_loss 0.8720 (0.8331) lr 1.8090e-03 eta 0:24:02
epoch [12/50] batch [40/319] time 0.089 (0.098) data 0.000 (0.014) loss 1.3374 (1.6464) ce_loss 0.9224 (1.1694) teacher_loss 0.6798 (0.9892) loss_zs_kd 0.6882 (0.7410) loss_oracle 0.6576 (0.6572) acc 62.5000 (54.0625) kd_loss 0.8220 (0.8303) lr 1.8090e-03 eta 0:20:20
epoch [12/50] batch [60/319] time 0.083 (0.092) data 0.000 (0.009) loss 1.8490 (1.6753) ce_loss 1.3643 (1.1841) teacher_loss 1.1555 (1.0216) loss_zs_kd 0.5603 (0.7273) loss_oracle 0.6936 (0.6537) acc 50.0000 (53.8021) kd_loss 0.8459 (0.8235) lr 1.8090e-03 eta 0:19:02
epoch [12/50] batch [80/319] time 0.091 (0.095) data 0.000 (0.007) loss 1.6615 (1.6686) ce_loss 0.9780 (1.1741) teacher_loss 0.8964 (1.0162) loss_zs_kd 0.5676 (0.7128) loss_oracle 0.7652 (0.6524) acc 65.6250 (54.2969) kd_loss 0.8474 (0.8222) lr 1.8090e-03 eta 0:19:33
epoch [12/50] batch [100/319] time 0.082 (0.093) data 0.000 (0.006) loss 1.6090 (1.6792) ce_loss 1.2607 (1.1897) teacher_loss 0.8993 (1.0249) loss_zs_kd 0.7097 (0.6977) loss_oracle 0.7098 (0.6543) acc 53.1250 (53.9062) kd_loss 0.8388 (0.8201) lr 1.8090e-03 eta 0:19:08
epoch [12/50] batch [120/319] time 0.083 (0.092) data 0.000 (0.005) loss 1.6137 (1.6796) ce_loss 1.2695 (1.1920) teacher_loss 1.0198 (1.0300) loss_zs_kd 0.7039 (0.6953) loss_oracle 0.5939 (0.6496) acc 50.0000 (54.1927) kd_loss 0.7939 (0.8200) lr 1.8090e-03 eta 0:18:52
epoch [12/50] batch [140/319] time 0.085 (0.091) data 0.000 (0.004) loss 1.8388 (1.6634) ce_loss 1.2266 (1.1769) teacher_loss 1.2394 (1.0243) loss_zs_kd 0.8678 (0.7096) loss_oracle 0.5994 (0.6392) acc 62.5000 (55.1339) kd_loss 0.8598 (0.8188) lr 1.8090e-03 eta 0:18:39
epoch [12/50] batch [160/319] time 0.079 (0.090) data 0.000 (0.004) loss 1.6131 (1.6509) ce_loss 1.2480 (1.1707) teacher_loss 1.1010 (1.0242) loss_zs_kd 0.8324 (0.7173) loss_oracle 0.5120 (0.6267) acc 46.8750 (55.5469) kd_loss 0.8026 (0.8194) lr 1.8090e-03 eta 0:18:25
epoch [12/50] batch [180/319] time 0.086 (0.089) data 0.000 (0.003) loss 1.4234 (1.6397) ce_loss 1.0811 (1.1682) teacher_loss 0.9529 (1.0245) loss_zs_kd 0.7626 (0.7276) loss_oracle 0.4706 (0.6152) acc 59.3750 (55.8507) kd_loss 0.8134 (0.8192) lr 1.8090e-03 eta 0:18:13
epoch [12/50] batch [200/319] time 0.087 (0.089) data 0.000 (0.003) loss 1.6876 (1.6355) ce_loss 1.1758 (1.1628) teacher_loss 1.1275 (1.0234) loss_zs_kd 0.8056 (0.7341) loss_oracle 0.5601 (0.6121) acc 40.6250 (55.9062) kd_loss 0.8256 (0.8203) lr 1.8090e-03 eta 0:18:07
epoch [12/50] batch [220/319] time 0.089 (0.089) data 0.000 (0.003) loss 1.3730 (1.6267) ce_loss 0.9546 (1.1580) teacher_loss 0.8301 (1.0176) loss_zs_kd 0.7382 (0.7536) loss_oracle 0.5430 (0.6090) acc 56.2500 (56.0795) kd_loss 0.8168 (0.8202) lr 1.8090e-03 eta 0:18:02
epoch [12/50] batch [240/319] time 0.091 (0.088) data 0.000 (0.003) loss 1.3514 (1.6222) ce_loss 1.0791 (1.1547) teacher_loss 0.8459 (1.0156) loss_zs_kd 0.8934 (0.7570) loss_oracle 0.5055 (0.6066) acc 59.3750 (56.2630) kd_loss 0.8746 (0.8199) lr 1.8090e-03 eta 0:17:59
epoch [12/50] batch [260/319] time 0.087 (0.088) data 0.000 (0.002) loss 1.5875 (1.6182) ce_loss 1.0615 (1.1484) teacher_loss 0.8892 (1.0127) loss_zs_kd 0.6145 (0.7521) loss_oracle 0.6983 (0.6055) acc 62.5000 (56.5505) kd_loss 0.8063 (0.8199) lr 1.8090e-03 eta 0:17:54
epoch [12/50] batch [280/319] time 0.084 (0.088) data 0.000 (0.002) loss 1.3665 (1.6182) ce_loss 0.9116 (1.1465) teacher_loss 0.7786 (1.0131) loss_zs_kd 0.6244 (0.7460) loss_oracle 0.5879 (0.6051) acc 59.3750 (56.5402) kd_loss 0.8086 (0.8203) lr 1.8090e-03 eta 0:17:51
epoch [12/50] batch [300/319] time 0.080 (0.088) data 0.000 (0.002) loss 1.7463 (1.6163) ce_loss 1.2305 (1.1416) teacher_loss 1.0865 (1.0107) loss_zs_kd 0.6595 (0.7453) loss_oracle 0.6597 (0.6056) acc 53.1250 (56.6354) kd_loss 0.8703 (0.8203) lr 1.8090e-03 eta 0:17:46
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,672
* accuracy: 61.0%
* error: 39.0%
* macro_f1: 53.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,273
* accuracy: 54.2%
* error: 45.8%
* macro_f1: 21.9%
******* Domain 2 best val acc:      62.8%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.2%, epoch: 9 *******
epoch [13/50] batch [20/319] time 0.082 (0.112) data 0.000 (0.026) loss 1.6178 (1.6586) ce_loss 1.1318 (1.1916) teacher_loss 0.9949 (1.0572) loss_zs_kd 0.9378 (0.8225) loss_oracle 0.6229 (0.6014) acc 56.2500 (55.4688) kd_loss 0.8169 (0.8118) lr 1.7705e-03 eta 0:22:38
epoch [13/50] batch [40/319] time 0.083 (0.096) data 0.000 (0.013) loss 1.9723 (1.5974) ce_loss 1.4521 (1.1169) teacher_loss 1.3430 (1.0134) loss_zs_kd 0.8605 (0.8177) loss_oracle 0.6294 (0.5840) acc 50.0000 (57.5781) kd_loss 0.8491 (0.8125) lr 1.7705e-03 eta 0:19:24
epoch [13/50] batch [60/319] time 0.083 (0.091) data 0.000 (0.009) loss 2.0990 (1.6175) ce_loss 1.5625 (1.1334) teacher_loss 1.5708 (1.0379) loss_zs_kd 0.7915 (0.8129) loss_oracle 0.5282 (0.5797) acc 46.8750 (57.4479) kd_loss 0.8133 (0.8136) lr 1.7705e-03 eta 0:18:21
epoch [13/50] batch [80/319] time 0.085 (0.089) data 0.000 (0.007) loss 1.2437 (1.6123) ce_loss 0.8696 (1.1420) teacher_loss 0.7881 (1.0553) loss_zs_kd 0.6233 (0.7878) loss_oracle 0.4556 (0.5569) acc 62.5000 (56.6406) kd_loss 0.8210 (0.8169) lr 1.7705e-03 eta 0:17:51
epoch [13/50] batch [100/319] time 0.082 (0.088) data 0.000 (0.005) loss 1.5558 (1.6038) ce_loss 1.2246 (1.1406) teacher_loss 1.1000 (1.0495) loss_zs_kd 0.7854 (0.7870) loss_oracle 0.4558 (0.5542) acc 46.8750 (56.2500) kd_loss 0.8204 (0.8181) lr 1.7705e-03 eta 0:17:41
epoch [13/50] batch [120/319] time 0.080 (0.088) data 0.000 (0.005) loss 1.6379 (1.5991) ce_loss 1.1475 (1.1337) teacher_loss 1.0333 (1.0415) loss_zs_kd 0.7140 (0.7925) loss_oracle 0.6046 (0.5576) acc 50.0000 (56.5104) kd_loss 0.8464 (0.8179) lr 1.7705e-03 eta 0:17:30
epoch [13/50] batch [140/319] time 0.092 (0.087) data 0.000 (0.004) loss 1.8295 (1.6031) ce_loss 1.3447 (1.1336) teacher_loss 1.2889 (1.0394) loss_zs_kd 0.7955 (0.7883) loss_oracle 0.5406 (0.5638) acc 56.2500 (56.7857) kd_loss 0.8438 (0.8179) lr 1.7705e-03 eta 0:17:26
epoch [13/50] batch [160/319] time 0.091 (0.087) data 0.000 (0.004) loss 1.6236 (1.5989) ce_loss 1.1982 (1.1310) teacher_loss 1.0862 (1.0300) loss_zs_kd 0.9163 (0.7885) loss_oracle 0.5374 (0.5688) acc 53.1250 (56.6406) kd_loss 0.8242 (0.8178) lr 1.7705e-03 eta 0:17:22
epoch [13/50] batch [180/319] time 0.088 (0.087) data 0.000 (0.003) loss 1.6328 (1.6053) ce_loss 1.0361 (1.1362) teacher_loss 0.9516 (1.0267) loss_zs_kd 0.8975 (0.8002) loss_oracle 0.6812 (0.5786) acc 68.7500 (56.6493) kd_loss 0.8019 (0.8181) lr 1.7705e-03 eta 0:17:17
epoch [13/50] batch [200/319] time 0.087 (0.087) data 0.000 (0.003) loss 1.6967 (1.6079) ce_loss 1.2539 (1.1419) teacher_loss 1.0653 (1.0234) loss_zs_kd 0.7812 (0.8040) loss_oracle 0.6314 (0.5845) acc 56.2500 (56.5625) kd_loss 0.8178 (0.8182) lr 1.7705e-03 eta 0:17:14
epoch [13/50] batch [220/319] time 0.094 (0.087) data 0.000 (0.003) loss 1.6907 (1.6050) ce_loss 1.2568 (1.1423) teacher_loss 0.9979 (1.0127) loss_zs_kd 1.0023 (0.8080) loss_oracle 0.6929 (0.5923) acc 53.1250 (56.4347) kd_loss 0.8253 (0.8189) lr 1.7705e-03 eta 0:17:10
epoch [13/50] batch [240/319] time 0.116 (0.087) data 0.000 (0.002) loss 1.5031 (1.6032) ce_loss 0.9023 (1.1437) teacher_loss 0.7954 (1.0067) loss_zs_kd 0.9835 (0.8170) loss_oracle 0.7076 (0.5964) acc 71.8750 (56.3672) kd_loss 0.8613 (0.8200) lr 1.7705e-03 eta 0:17:08
epoch [13/50] batch [260/319] time 0.085 (0.087) data 0.000 (0.002) loss 1.7188 (1.6022) ce_loss 1.1992 (1.1478) teacher_loss 0.9679 (0.9986) loss_zs_kd 0.8991 (0.8280) loss_oracle 0.7509 (0.6036) acc 53.1250 (56.2500) kd_loss 0.8526 (0.8217) lr 1.7705e-03 eta 0:17:16
epoch [13/50] batch [280/319] time 0.082 (0.087) data 0.000 (0.002) loss 1.6206 (1.6016) ce_loss 1.0928 (1.1485) teacher_loss 0.8920 (0.9927) loss_zs_kd 0.9367 (0.8283) loss_oracle 0.7286 (0.6089) acc 65.6250 (56.1830) kd_loss 0.8264 (0.8234) lr 1.7705e-03 eta 0:17:11
epoch [13/50] batch [300/319] time 0.083 (0.087) data 0.000 (0.002) loss 1.6360 (1.6003) ce_loss 1.1621 (1.1467) teacher_loss 0.9966 (0.9875) loss_zs_kd 0.7865 (0.8271) loss_oracle 0.6394 (0.6128) acc 56.2500 (56.2500) kd_loss 0.8321 (0.8245) lr 1.7705e-03 eta 0:17:07
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,617
* accuracy: 59.8%
* error: 40.2%
* macro_f1: 51.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,479
* accuracy: 56.3%
* error: 43.7%
* macro_f1: 22.3%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      62.8%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [14/50] batch [20/319] time 0.117 (0.126) data 0.001 (0.036) loss 1.4599 (1.5750) ce_loss 1.0156 (1.1280) teacher_loss 0.8518 (0.9474) loss_zs_kd 1.0608 (0.8502) loss_oracle 0.6081 (0.6277) acc 75.0000 (57.0312) kd_loss 0.8715 (0.8426) lr 1.7290e-03 eta 0:24:43
epoch [14/50] batch [40/319] time 0.084 (0.104) data 0.000 (0.018) loss 1.8318 (1.5771) ce_loss 1.0508 (1.1250) teacher_loss 1.2038 (0.9240) loss_zs_kd 0.9033 (0.9495) loss_oracle 0.6280 (0.6531) acc 68.7500 (57.5781) kd_loss 0.8853 (0.8365) lr 1.7290e-03 eta 0:20:23
epoch [14/50] batch [60/319] time 0.085 (0.098) data 0.001 (0.012) loss 1.3817 (1.5946) ce_loss 1.0312 (1.1448) teacher_loss 0.8810 (0.9557) loss_zs_kd 1.2810 (0.9743) loss_oracle 0.5007 (0.6389) acc 56.2500 (55.7812) kd_loss 0.8212 (0.8335) lr 1.7290e-03 eta 0:19:06
epoch [14/50] batch [80/319] time 0.086 (0.095) data 0.000 (0.009) loss 1.6414 (1.5927) ce_loss 1.3486 (1.1507) teacher_loss 1.0540 (0.9693) loss_zs_kd 0.9889 (0.9577) loss_oracle 0.5874 (0.6233) acc 43.7500 (55.3125) kd_loss 0.8613 (0.8337) lr 1.7290e-03 eta 0:18:30
epoch [14/50] batch [100/319] time 0.082 (0.093) data 0.000 (0.007) loss 1.2736 (1.6043) ce_loss 0.9224 (1.1559) teacher_loss 0.6227 (0.9781) loss_zs_kd 0.9711 (0.9622) loss_oracle 0.6509 (0.6262) acc 59.3750 (54.4688) kd_loss 0.8345 (0.8341) lr 1.7290e-03 eta 0:18:09
epoch [14/50] batch [120/319] time 0.084 (0.091) data 0.000 (0.006) loss 1.5326 (1.6095) ce_loss 1.0283 (1.1559) teacher_loss 0.8774 (0.9841) loss_zs_kd 1.0632 (0.9694) loss_oracle 0.6551 (0.6255) acc 59.3750 (54.4010) kd_loss 0.8317 (0.8346) lr 1.7290e-03 eta 0:17:48
epoch [14/50] batch [140/319] time 0.094 (0.090) data 0.000 (0.005) loss 1.9092 (1.6110) ce_loss 1.5293 (1.1566) teacher_loss 1.3024 (0.9935) loss_zs_kd 0.8578 (0.9635) loss_oracle 0.6068 (0.6174) acc 37.5000 (54.1518) kd_loss 0.8195 (0.8334) lr 1.7290e-03 eta 0:17:34
epoch [14/50] batch [160/319] time 0.084 (0.090) data 0.000 (0.005) loss 1.6421 (1.6155) ce_loss 1.2285 (1.1618) teacher_loss 1.0609 (1.0048) loss_zs_kd 0.7890 (0.9487) loss_oracle 0.5812 (0.6107) acc 46.8750 (54.2188) kd_loss 0.8186 (0.8338) lr 1.7290e-03 eta 0:17:22
epoch [14/50] batch [180/319] time 0.077 (0.088) data 0.000 (0.004) loss 1.5714 (1.6111) ce_loss 1.0859 (1.1588) teacher_loss 0.9796 (1.0025) loss_zs_kd 0.8335 (0.9404) loss_oracle 0.5918 (0.6086) acc 59.3750 (54.5139) kd_loss 0.8354 (0.8343) lr 1.7290e-03 eta 0:17:05
epoch [14/50] batch [200/319] time 0.084 (0.087) data 0.000 (0.004) loss 1.4951 (1.6095) ce_loss 1.0234 (1.1506) teacher_loss 0.8784 (0.9971) loss_zs_kd 0.8978 (0.9381) loss_oracle 0.6166 (0.6123) acc 68.7500 (55.1562) kd_loss 0.8118 (0.8357) lr 1.7290e-03 eta 0:16:54
epoch [14/50] batch [220/319] time 0.078 (0.087) data 0.000 (0.003) loss 1.5404 (1.6117) ce_loss 1.1045 (1.1507) teacher_loss 0.9629 (0.9995) loss_zs_kd 0.8293 (0.9341) loss_oracle 0.5775 (0.6122) acc 56.2500 (55.3267) kd_loss 0.8320 (0.8351) lr 1.7290e-03 eta 0:16:47
epoch [14/50] batch [240/319] time 0.081 (0.086) data 0.000 (0.003) loss 1.5437 (1.6097) ce_loss 1.0938 (1.1475) teacher_loss 0.9697 (1.0005) loss_zs_kd 0.8851 (0.9262) loss_oracle 0.5741 (0.6092) acc 62.5000 (55.4688) kd_loss 0.8106 (0.8348) lr 1.7290e-03 eta 0:16:36
epoch [14/50] batch [260/319] time 0.072 (0.086) data 0.000 (0.003) loss 1.3699 (1.6070) ce_loss 1.0039 (1.1439) teacher_loss 0.8518 (0.9998) loss_zs_kd 0.7210 (0.9168) loss_oracle 0.5180 (0.6072) acc 62.5000 (55.7091) kd_loss 0.8212 (0.8337) lr 1.7290e-03 eta 0:16:27
epoch [14/50] batch [280/319] time 0.073 (0.085) data 0.000 (0.003) loss 1.4653 (1.6004) ce_loss 1.0859 (1.1404) teacher_loss 0.8492 (0.9959) loss_zs_kd 0.8705 (0.9161) loss_oracle 0.6160 (0.6045) acc 53.1250 (55.9263) kd_loss 0.8177 (0.8325) lr 1.7290e-03 eta 0:16:18
epoch [14/50] batch [300/319] time 0.083 (0.085) data 0.000 (0.003) loss 1.7341 (1.6002) ce_loss 1.3135 (1.1411) teacher_loss 1.0524 (0.9939) loss_zs_kd 0.9021 (0.9131) loss_oracle 0.6817 (0.6063) acc 50.0000 (56.0729) kd_loss 0.8296 (0.8327) lr 1.7290e-03 eta 0:16:12
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,545
* accuracy: 58.1%
* error: 41.9%
* macro_f1: 51.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,207
* accuracy: 53.5%
* error: 46.5%
* macro_f1: 21.6%
******* Domain 2 best val acc:      62.8%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [15/50] batch [20/319] time 0.089 (0.117) data 0.000 (0.030) loss 1.9924 (1.6741) ce_loss 1.5498 (1.1775) teacher_loss 1.4462 (1.0678) loss_zs_kd 0.8566 (0.9323) loss_oracle 0.5462 (0.6063) acc 37.5000 (55.1562) kd_loss 0.8584 (0.8334) lr 1.6845e-03 eta 0:22:23
epoch [15/50] batch [40/319] time 0.095 (0.101) data 0.000 (0.015) loss 1.2967 (1.6141) ce_loss 0.9819 (1.1457) teacher_loss 0.7409 (1.0140) loss_zs_kd 0.8543 (0.9245) loss_oracle 0.5558 (0.6000) acc 59.3750 (55.8594) kd_loss 0.7890 (0.8247) lr 1.6845e-03 eta 0:19:17
epoch [15/50] batch [60/319] time 0.086 (0.095) data 0.000 (0.010) loss 1.5944 (1.6112) ce_loss 1.3076 (1.1451) teacher_loss 0.9864 (0.9998) loss_zs_kd 1.0513 (0.9348) loss_oracle 0.6079 (0.6115) acc 46.8750 (56.1979) kd_loss 0.7867 (0.8294) lr 1.6845e-03 eta 0:18:10
epoch [15/50] batch [80/319] time 0.087 (0.093) data 0.000 (0.008) loss 1.4373 (1.6150) ce_loss 1.0146 (1.1478) teacher_loss 0.9212 (1.0015) loss_zs_kd 0.9332 (0.9563) loss_oracle 0.5161 (0.6135) acc 56.2500 (55.9766) kd_loss 0.7878 (0.8299) lr 1.6845e-03 eta 0:17:43
epoch [15/50] batch [100/319] time 0.089 (0.092) data 0.000 (0.006) loss 1.5414 (1.6025) ce_loss 0.9937 (1.1412) teacher_loss 0.8755 (0.9865) loss_zs_kd 0.7576 (0.9481) loss_oracle 0.6659 (0.6160) acc 59.3750 (56.3125) kd_loss 0.8424 (0.8294) lr 1.6845e-03 eta 0:17:26
epoch [15/50] batch [120/319] time 0.091 (0.091) data 0.000 (0.005) loss 1.2993 (1.6045) ce_loss 0.9624 (1.1440) teacher_loss 0.7140 (0.9798) loss_zs_kd 0.9823 (0.9408) loss_oracle 0.5853 (0.6247) acc 68.7500 (56.2240) kd_loss 0.8365 (0.8297) lr 1.6845e-03 eta 0:17:15
epoch [15/50] batch [140/319] time 0.079 (0.090) data 0.000 (0.004) loss 1.6840 (1.5988) ce_loss 1.2314 (1.1444) teacher_loss 1.0053 (0.9686) loss_zs_kd 1.2575 (0.9440) loss_oracle 0.6787 (0.6302) acc 56.2500 (56.4955) kd_loss 0.8749 (0.8293) lr 1.6845e-03 eta 0:17:04
epoch [15/50] batch [160/319] time 0.084 (0.090) data 0.000 (0.004) loss 1.6061 (1.5915) ce_loss 1.1084 (1.1380) teacher_loss 0.8611 (0.9580) loss_zs_kd 1.0388 (0.9690) loss_oracle 0.7451 (0.6335) acc 62.5000 (56.5234) kd_loss 0.8485 (0.8292) lr 1.6845e-03 eta 0:16:58
epoch [15/50] batch [180/319] time 0.114 (0.090) data 0.000 (0.003) loss 1.5196 (1.5810) ce_loss 1.1807 (1.1311) teacher_loss 0.8256 (0.9451) loss_zs_kd 0.8177 (0.9692) loss_oracle 0.6940 (0.6359) acc 62.5000 (56.8056) kd_loss 0.8004 (0.8291) lr 1.6845e-03 eta 0:16:56
epoch [15/50] batch [200/319] time 0.104 (0.092) data 0.000 (0.003) loss 2.0051 (1.5924) ce_loss 1.4863 (1.1388) teacher_loss 1.2533 (0.9572) loss_zs_kd 0.8349 (0.9691) loss_oracle 0.7517 (0.6352) acc 50.0000 (56.7500) kd_loss 0.8165 (0.8294) lr 1.6845e-03 eta 0:17:15
epoch [15/50] batch [220/319] time 0.113 (0.093) data 0.000 (0.003) loss 1.6844 (1.6000) ce_loss 1.2549 (1.1408) teacher_loss 1.1722 (0.9669) loss_zs_kd 0.8062 (0.9572) loss_oracle 0.5122 (0.6331) acc 53.1250 (56.8182) kd_loss 0.7809 (0.8279) lr 1.6845e-03 eta 0:17:25
epoch [15/50] batch [240/319] time 0.103 (0.094) data 0.000 (0.003) loss 1.4077 (1.6007) ce_loss 1.0352 (1.1395) teacher_loss 0.8246 (0.9681) loss_zs_kd 0.8290 (0.9416) loss_oracle 0.5831 (0.6325) acc 59.3750 (56.8620) kd_loss 0.7753 (0.8260) lr 1.6845e-03 eta 0:17:32
epoch [15/50] batch [260/319] time 0.080 (0.093) data 0.000 (0.003) loss 1.7516 (1.6079) ce_loss 1.1221 (1.1433) teacher_loss 1.0860 (0.9781) loss_zs_kd 0.7309 (0.9334) loss_oracle 0.6656 (0.6298) acc 50.0000 (56.5865) kd_loss 0.8142 (0.8246) lr 1.6845e-03 eta 0:17:23
epoch [15/50] batch [280/319] time 0.178 (0.095) data 0.000 (0.002) loss 1.4667 (1.6135) ce_loss 1.1191 (1.1470) teacher_loss 0.8311 (0.9857) loss_zs_kd 0.8250 (0.9244) loss_oracle 0.6357 (0.6278) acc 53.1250 (56.4621) kd_loss 0.8053 (0.8239) lr 1.6845e-03 eta 0:17:41
epoch [15/50] batch [300/319] time 0.166 (0.096) data 0.000 (0.002) loss 1.8702 (1.6124) ce_loss 1.2236 (1.1428) teacher_loss 1.2494 (0.9863) loss_zs_kd 0.7649 (0.9144) loss_oracle 0.6207 (0.6261) acc 53.1250 (56.7188) kd_loss 0.7857 (0.8243) lr 1.6845e-03 eta 0:17:55
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,694
* accuracy: 61.5%
* error: 38.5%
* macro_f1: 53.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,831
* accuracy: 49.6%
* error: 50.4%
* macro_f1: 21.4%
******* Domain 2 best val acc:      62.8%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [16/50] batch [20/319] time 0.076 (0.130) data 0.000 (0.034) loss 1.5112 (1.6138) ce_loss 0.8936 (1.1430) teacher_loss 0.8192 (0.9526) loss_zs_kd 0.7711 (0.8153) loss_oracle 0.6921 (0.6612) acc 68.7500 (57.0312) kd_loss 0.8039 (0.8179) lr 1.6374e-03 eta 0:24:06
epoch [16/50] batch [40/319] time 0.097 (0.111) data 0.000 (0.017) loss 1.9239 (1.6207) ce_loss 1.4766 (1.1312) teacher_loss 1.1242 (0.9500) loss_zs_kd 0.6723 (0.8300) loss_oracle 0.7997 (0.6707) acc 43.7500 (58.5156) kd_loss 0.8165 (0.8264) lr 1.6374e-03 eta 0:20:31
epoch [16/50] batch [60/319] time 0.092 (0.105) data 0.001 (0.012) loss 1.4168 (1.6045) ce_loss 0.8687 (1.1414) teacher_loss 0.7415 (0.9320) loss_zs_kd 1.0115 (0.8441) loss_oracle 0.6753 (0.6725) acc 62.5000 (57.8646) kd_loss 0.8287 (0.8298) lr 1.6374e-03 eta 0:19:22
epoch [16/50] batch [80/319] time 0.097 (0.101) data 0.000 (0.009) loss 1.5025 (1.6076) ce_loss 1.0156 (1.1381) teacher_loss 0.9625 (0.9404) loss_zs_kd 0.8899 (0.8553) loss_oracle 0.5400 (0.6672) acc 56.2500 (57.8906) kd_loss 0.8140 (0.8290) lr 1.6374e-03 eta 0:18:34
epoch [16/50] batch [100/319] time 0.086 (0.098) data 0.000 (0.007) loss 1.7417 (1.6212) ce_loss 1.2422 (1.1461) teacher_loss 1.1282 (0.9560) loss_zs_kd 0.6698 (0.8542) loss_oracle 0.6135 (0.6652) acc 50.0000 (57.2188) kd_loss 0.8153 (0.8296) lr 1.6374e-03 eta 0:18:07
epoch [16/50] batch [120/319] time 0.085 (0.097) data 0.000 (0.006) loss 1.5249 (1.6195) ce_loss 1.0693 (1.1402) teacher_loss 0.8991 (0.9529) loss_zs_kd 0.9715 (0.8524) loss_oracle 0.6258 (0.6665) acc 56.2500 (57.4740) kd_loss 0.8374 (0.8291) lr 1.6374e-03 eta 0:17:47
epoch [16/50] batch [140/319] time 0.114 (0.097) data 0.000 (0.005) loss 1.5024 (1.6306) ce_loss 0.8633 (1.1518) teacher_loss 0.7993 (0.9655) loss_zs_kd 0.8972 (0.8552) loss_oracle 0.7030 (0.6651) acc 68.7500 (56.8750) kd_loss 0.8130 (0.8292) lr 1.6374e-03 eta 0:17:50
epoch [16/50] batch [160/319] time 0.092 (0.098) data 0.000 (0.004) loss 1.3936 (1.6362) ce_loss 1.0010 (1.1605) teacher_loss 0.7315 (0.9745) loss_zs_kd 0.9092 (0.8587) loss_oracle 0.6621 (0.6618) acc 62.5000 (56.3867) kd_loss 0.8219 (0.8295) lr 1.6374e-03 eta 0:17:55
epoch [16/50] batch [180/319] time 0.100 (0.098) data 0.000 (0.004) loss 1.5497 (1.6372) ce_loss 1.0957 (1.1545) teacher_loss 0.8137 (0.9735) loss_zs_kd 0.7137 (0.8557) loss_oracle 0.7360 (0.6637) acc 50.0000 (56.2674) kd_loss 0.8859 (0.8285) lr 1.6374e-03 eta 0:17:59
epoch [16/50] batch [200/319] time 0.081 (0.099) data 0.000 (0.004) loss 1.5163 (1.6347) ce_loss 1.1152 (1.1565) teacher_loss 0.9175 (0.9726) loss_zs_kd 0.8524 (0.8542) loss_oracle 0.5988 (0.6621) acc 65.6250 (55.8281) kd_loss 0.8229 (0.8288) lr 1.6374e-03 eta 0:18:03
epoch [16/50] batch [220/319] time 0.099 (0.099) data 0.000 (0.003) loss 1.6230 (1.6292) ce_loss 1.0303 (1.1543) teacher_loss 0.9215 (0.9695) loss_zs_kd 0.8534 (0.8654) loss_oracle 0.7015 (0.6597) acc 59.3750 (55.7955) kd_loss 0.8515 (0.8289) lr 1.6374e-03 eta 0:18:05
epoch [16/50] batch [240/319] time 0.110 (0.100) data 0.000 (0.003) loss 1.5796 (1.6307) ce_loss 1.1426 (1.1571) teacher_loss 0.8920 (0.9704) loss_zs_kd 1.1441 (0.8740) loss_oracle 0.6876 (0.6603) acc 46.8750 (55.6771) kd_loss 0.7837 (0.8284) lr 1.6374e-03 eta 0:18:07
epoch [16/50] batch [260/319] time 0.099 (0.100) data 0.000 (0.003) loss 1.3900 (1.6317) ce_loss 1.0234 (1.1583) teacher_loss 0.6822 (0.9717) loss_zs_kd 0.7902 (0.8676) loss_oracle 0.7078 (0.6600) acc 53.1250 (55.6490) kd_loss 0.7987 (0.8286) lr 1.6374e-03 eta 0:18:08
epoch [16/50] batch [280/319] time 0.091 (0.099) data 0.000 (0.003) loss 1.8777 (1.6304) ce_loss 1.4277 (1.1602) teacher_loss 1.2937 (0.9706) loss_zs_kd 0.9445 (0.8699) loss_oracle 0.5840 (0.6597) acc 37.5000 (55.6473) kd_loss 0.8307 (0.8294) lr 1.6374e-03 eta 0:17:56
epoch [16/50] batch [300/319] time 0.081 (0.101) data 0.000 (0.003) loss 1.7005 (1.6264) ce_loss 1.1934 (1.1572) teacher_loss 0.8832 (0.9643) loss_zs_kd 0.7992 (0.8726) loss_oracle 0.8173 (0.6621) acc 50.0000 (55.7083) kd_loss 0.8605 (0.8300) lr 1.6374e-03 eta 0:18:12
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,615
* accuracy: 59.7%
* error: 40.3%
* macro_f1: 51.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,808
* accuracy: 49.4%
* error: 50.6%
* macro_f1: 21.0%
******* Domain 2 best val acc:      62.8%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [17/50] batch [20/319] time 0.104 (0.141) data 0.000 (0.032) loss 1.4719 (1.4772) ce_loss 0.9526 (1.0982) teacher_loss 0.7447 (0.8071) loss_zs_kd 1.3036 (0.8284) loss_oracle 0.7271 (0.6700) acc 59.3750 (56.4062) kd_loss 0.8500 (0.8325) lr 1.5878e-03 eta 0:25:25
epoch [17/50] batch [40/319] time 0.104 (0.123) data 0.000 (0.016) loss 1.4285 (1.5138) ce_loss 1.0918 (1.1321) teacher_loss 0.8264 (0.8461) loss_zs_kd 1.0400 (0.9046) loss_oracle 0.6020 (0.6677) acc 59.3750 (55.7031) kd_loss 0.7922 (0.8390) lr 1.5878e-03 eta 0:22:06
epoch [17/50] batch [60/319] time 0.100 (0.119) data 0.001 (0.011) loss 1.8319 (1.5228) ce_loss 1.4014 (1.1401) teacher_loss 1.2030 (0.8525) loss_zs_kd 0.7541 (0.9061) loss_oracle 0.6289 (0.6703) acc 53.1250 (56.3542) kd_loss 0.8412 (0.8362) lr 1.5878e-03 eta 0:21:25
epoch [17/50] batch [80/319] time 0.102 (0.116) data 0.000 (0.008) loss 1.3683 (1.5160) ce_loss 0.8569 (1.1351) teacher_loss 0.8288 (0.8452) loss_zs_kd 1.0312 (0.8897) loss_oracle 0.5395 (0.6709) acc 68.7500 (56.7578) kd_loss 0.7965 (0.8342) lr 1.5878e-03 eta 0:20:45
epoch [17/50] batch [100/319] time 0.107 (0.113) data 0.000 (0.007) loss 1.4521 (1.5155) ce_loss 1.2158 (1.1428) teacher_loss 0.7546 (0.8464) loss_zs_kd 1.1157 (0.8862) loss_oracle 0.6975 (0.6691) acc 50.0000 (56.5000) kd_loss 0.8082 (0.8356) lr 1.5878e-03 eta 0:20:18
epoch [17/50] batch [120/319] time 0.110 (0.112) data 0.000 (0.006) loss 1.6638 (1.5309) ce_loss 1.0312 (1.1541) teacher_loss 1.0125 (0.8596) loss_zs_kd 1.2203 (0.9065) loss_oracle 0.6513 (0.6713) acc 53.1250 (56.0417) kd_loss 0.8721 (0.8347) lr 1.5878e-03 eta 0:20:01
epoch [17/50] batch [140/319] time 0.124 (0.111) data 0.000 (0.005) loss 1.7862 (1.5469) ce_loss 1.2266 (1.1582) teacher_loss 1.1604 (0.8759) loss_zs_kd 0.9958 (0.9192) loss_oracle 0.6258 (0.6709) acc 56.2500 (55.7812) kd_loss 0.8192 (0.8340) lr 1.5878e-03 eta 0:19:48
epoch [17/50] batch [160/319] time 0.109 (0.110) data 0.000 (0.004) loss 1.2952 (1.5535) ce_loss 0.8779 (1.1515) teacher_loss 0.6421 (0.8814) loss_zs_kd 0.8229 (0.9162) loss_oracle 0.6531 (0.6721) acc 65.6250 (55.9570) kd_loss 0.8694 (0.8345) lr 1.5878e-03 eta 0:19:37
epoch [17/50] batch [180/319] time 0.100 (0.109) data 0.000 (0.004) loss 1.3803 (1.5526) ce_loss 0.9927 (1.1508) teacher_loss 0.5903 (0.8795) loss_zs_kd 1.1170 (0.9133) loss_oracle 0.7900 (0.6731) acc 65.6250 (55.8160) kd_loss 0.8715 (0.8336) lr 1.5878e-03 eta 0:19:27
epoch [17/50] batch [200/319] time 0.106 (0.109) data 0.000 (0.003) loss 1.3808 (1.5559) ce_loss 0.8452 (1.1519) teacher_loss 0.7192 (0.8839) loss_zs_kd 0.9444 (0.9156) loss_oracle 0.6616 (0.6720) acc 84.3750 (56.0781) kd_loss 0.8338 (0.8347) lr 1.5878e-03 eta 0:19:20
epoch [17/50] batch [220/319] time 0.107 (0.109) data 0.000 (0.003) loss 1.5174 (1.5656) ce_loss 1.0566 (1.1586) teacher_loss 0.9047 (0.8957) loss_zs_kd 1.0660 (0.9111) loss_oracle 0.6127 (0.6699) acc 59.3750 (55.8381) kd_loss 0.8146 (0.8344) lr 1.5878e-03 eta 0:19:13
epoch [17/50] batch [240/319] time 0.113 (0.108) data 0.000 (0.003) loss 1.8179 (1.5643) ce_loss 1.2773 (1.1571) teacher_loss 1.1240 (0.8940) loss_zs_kd 1.0468 (0.9074) loss_oracle 0.6939 (0.6703) acc 46.8750 (55.8984) kd_loss 0.8312 (0.8340) lr 1.5878e-03 eta 0:19:07
epoch [17/50] batch [260/319] time 0.081 (0.108) data 0.000 (0.003) loss 1.5304 (1.5645) ce_loss 1.1904 (1.1556) teacher_loss 0.7863 (0.8924) loss_zs_kd 1.0392 (0.9099) loss_oracle 0.7442 (0.6721) acc 50.0000 (55.9736) kd_loss 0.8887 (0.8351) lr 1.5878e-03 eta 0:18:59
epoch [17/50] batch [280/319] time 0.083 (0.106) data 0.000 (0.003) loss 1.2509 (1.5634) ce_loss 0.8667 (1.1536) teacher_loss 0.5386 (0.8911) loss_zs_kd 0.9997 (0.9096) loss_oracle 0.7123 (0.6723) acc 59.3750 (55.9040) kd_loss 0.8154 (0.8356) lr 1.5878e-03 eta 0:18:37
epoch [17/50] batch [300/319] time 0.076 (0.106) data 0.000 (0.002) loss 1.7527 (1.5643) ce_loss 1.1982 (1.1528) teacher_loss 1.0483 (0.8916) loss_zs_kd 1.1100 (0.9146) loss_oracle 0.7044 (0.6727) acc 53.1250 (56.0417) kd_loss 0.8589 (0.8354) lr 1.5878e-03 eta 0:18:41
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,715
* accuracy: 62.0%
* error: 38.0%
* macro_f1: 52.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,282
* accuracy: 54.3%
* error: 45.7%
* macro_f1: 21.2%
******* Domain 2 best val acc:      62.8%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [18/50] batch [20/319] time 0.084 (0.122) data 0.000 (0.028) loss 1.4947 (1.5362) ce_loss 1.0693 (1.0804) teacher_loss 0.8180 (0.8904) loss_zs_kd 0.9894 (1.0278) loss_oracle 0.6767 (0.6457) acc 59.3750 (59.6875) kd_loss 0.8199 (0.8238) lr 1.5358e-03 eta 0:21:21
epoch [18/50] batch [40/319] time 0.083 (0.104) data 0.000 (0.014) loss 1.4910 (1.5445) ce_loss 1.0664 (1.1065) teacher_loss 0.8777 (0.8882) loss_zs_kd 0.9504 (1.0266) loss_oracle 0.6133 (0.6563) acc 50.0000 (57.9688) kd_loss 0.7653 (0.8263) lr 1.5358e-03 eta 0:18:09
epoch [18/50] batch [60/319] time 0.106 (0.099) data 0.001 (0.009) loss 1.5314 (1.5438) ce_loss 1.1797 (1.1214) teacher_loss 0.8377 (0.8751) loss_zs_kd 0.9190 (0.9797) loss_oracle 0.6937 (0.6688) acc 53.1250 (56.9271) kd_loss 0.7992 (0.8273) lr 1.5358e-03 eta 0:17:14
epoch [18/50] batch [80/319] time 0.084 (0.096) data 0.000 (0.007) loss 1.2798 (1.5461) ce_loss 0.9697 (1.1280) teacher_loss 0.6315 (0.8779) loss_zs_kd 0.9354 (0.9623) loss_oracle 0.6483 (0.6682) acc 68.7500 (56.9531) kd_loss 0.8045 (0.8292) lr 1.5358e-03 eta 0:16:43
epoch [18/50] batch [100/319] time 0.076 (0.094) data 0.000 (0.006) loss 1.3113 (1.5432) ce_loss 0.7217 (1.1357) teacher_loss 0.5472 (0.8686) loss_zs_kd 0.9683 (0.9603) loss_oracle 0.7641 (0.6746) acc 75.0000 (56.6250) kd_loss 0.8377 (0.8325) lr 1.5358e-03 eta 0:16:20
epoch [18/50] batch [120/319] time 0.082 (0.093) data 0.000 (0.005) loss 1.4440 (1.5479) ce_loss 1.2637 (1.1513) teacher_loss 0.7560 (0.8784) loss_zs_kd 1.2157 (0.9507) loss_oracle 0.6880 (0.6695) acc 53.1250 (56.0677) kd_loss 0.8203 (0.8302) lr 1.5358e-03 eta 0:16:05
epoch [18/50] batch [140/319] time 0.090 (0.091) data 0.000 (0.004) loss 1.4362 (1.5465) ce_loss 0.9155 (1.1506) teacher_loss 0.8330 (0.8758) loss_zs_kd 0.9471 (0.9368) loss_oracle 0.6032 (0.6707) acc 71.8750 (55.8482) kd_loss 0.8315 (0.8299) lr 1.5358e-03 eta 0:15:50
epoch [18/50] batch [160/319] time 0.092 (0.092) data 0.000 (0.004) loss 1.8017 (1.5573) ce_loss 1.2881 (1.1615) teacher_loss 1.0350 (0.8869) loss_zs_kd 0.7969 (0.9190) loss_oracle 0.7667 (0.6704) acc 50.0000 (55.5273) kd_loss 0.8263 (0.8304) lr 1.5358e-03 eta 0:15:54
epoch [18/50] batch [180/319] time 0.085 (0.093) data 0.000 (0.003) loss 1.7657 (1.5568) ce_loss 1.2344 (1.1641) teacher_loss 1.0050 (0.8854) loss_zs_kd 0.8921 (0.9094) loss_oracle 0.7607 (0.6714) acc 53.1250 (55.3993) kd_loss 0.8538 (0.8299) lr 1.5358e-03 eta 0:15:57
epoch [18/50] batch [200/319] time 0.079 (0.093) data 0.000 (0.003) loss 1.7160 (1.5604) ce_loss 1.1816 (1.1702) teacher_loss 1.0438 (0.8889) loss_zs_kd 0.8371 (0.9040) loss_oracle 0.6722 (0.6715) acc 46.8750 (55.1250) kd_loss 0.8568 (0.8304) lr 1.5358e-03 eta 0:15:56
epoch [18/50] batch [220/319] time 0.084 (0.092) data 0.000 (0.003) loss 1.5689 (1.5574) ce_loss 1.1631 (1.1743) teacher_loss 0.9449 (0.8884) loss_zs_kd 0.8797 (0.8991) loss_oracle 0.6240 (0.6690) acc 50.0000 (54.8580) kd_loss 0.7921 (0.8300) lr 1.5358e-03 eta 0:15:47
epoch [18/50] batch [240/319] time 0.080 (0.091) data 0.000 (0.003) loss 1.3541 (1.5526) ce_loss 1.0674 (1.1728) teacher_loss 0.6868 (0.8844) loss_zs_kd 0.9364 (0.9050) loss_oracle 0.6672 (0.6682) acc 62.5000 (54.9349) kd_loss 0.8368 (0.8303) lr 1.5358e-03 eta 0:15:39
epoch [18/50] batch [260/319] time 0.093 (0.091) data 0.000 (0.002) loss 1.5778 (1.5494) ce_loss 1.1094 (1.1699) teacher_loss 1.0467 (0.8817) loss_zs_kd 1.1342 (0.9158) loss_oracle 0.5311 (0.6677) acc 53.1250 (55.0601) kd_loss 0.8537 (0.8301) lr 1.5358e-03 eta 0:15:34
epoch [18/50] batch [280/319] time 0.085 (0.092) data 0.000 (0.002) loss 1.7839 (1.5547) ce_loss 1.2617 (1.1714) teacher_loss 1.1161 (0.8880) loss_zs_kd 0.8284 (0.9200) loss_oracle 0.6678 (0.6667) acc 50.0000 (55.1004) kd_loss 0.8017 (0.8301) lr 1.5358e-03 eta 0:15:39
epoch [18/50] batch [300/319] time 0.087 (0.091) data 0.000 (0.002) loss 1.3758 (1.5593) ce_loss 0.9346 (1.1738) teacher_loss 0.6721 (0.8932) loss_zs_kd 0.9574 (0.9156) loss_oracle 0.7037 (0.6661) acc 68.7500 (55.1146) kd_loss 0.8361 (0.8288) lr 1.5358e-03 eta 0:15:32
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,728
* accuracy: 62.3%
* error: 37.7%
* macro_f1: 54.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,822
* accuracy: 49.5%
* error: 50.5%
* macro_f1: 21.4%
******* Domain 2 best val acc:      62.8%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [19/50] batch [20/319] time 0.084 (0.107) data 0.000 (0.031) loss 1.4248 (1.5498) ce_loss 0.8770 (1.1294) teacher_loss 0.8888 (0.9004) loss_zs_kd 0.8688 (0.8147) loss_oracle 0.5361 (0.6494) acc 65.6250 (56.7188) kd_loss 0.7689 (0.8252) lr 1.4818e-03 eta 0:18:14
epoch [19/50] batch [40/319] time 0.062 (0.092) data 0.000 (0.016) loss 1.5217 (1.5662) ce_loss 1.1162 (1.1452) teacher_loss 0.8650 (0.9249) loss_zs_kd 0.7650 (0.8175) loss_oracle 0.6567 (0.6413) acc 53.1250 (56.6406) kd_loss 0.7931 (0.8242) lr 1.4818e-03 eta 0:15:37
epoch [19/50] batch [60/319] time 0.084 (0.088) data 0.001 (0.011) loss 1.5602 (1.5674) ce_loss 0.9277 (1.1643) teacher_loss 0.9712 (0.9257) loss_zs_kd 0.5739 (0.8130) loss_oracle 0.5890 (0.6416) acc 75.0000 (55.9375) kd_loss 0.7652 (0.8243) lr 1.4818e-03 eta 0:14:49
epoch [19/50] batch [80/319] time 0.093 (0.089) data 0.000 (0.008) loss 1.7767 (1.5862) ce_loss 1.3359 (1.1900) teacher_loss 1.1535 (0.9407) loss_zs_kd 0.8144 (0.7923) loss_oracle 0.6232 (0.6456) acc 40.6250 (54.6875) kd_loss 0.7658 (0.8228) lr 1.4818e-03 eta 0:14:59
epoch [19/50] batch [100/319] time 0.085 (0.088) data 0.000 (0.006) loss 1.4838 (1.5923) ce_loss 1.2627 (1.2027) teacher_loss 0.8480 (0.9462) loss_zs_kd 0.8217 (0.7923) loss_oracle 0.6358 (0.6461) acc 56.2500 (53.6875) kd_loss 0.8189 (0.8230) lr 1.4818e-03 eta 0:14:52
epoch [19/50] batch [120/319] time 0.115 (0.090) data 0.000 (0.005) loss 1.6515 (1.5923) ce_loss 1.5146 (1.2035) teacher_loss 1.0377 (0.9451) loss_zs_kd 0.6586 (0.7901) loss_oracle 0.6138 (0.6473) acc 34.3750 (53.8802) kd_loss 0.8166 (0.8224) lr 1.4818e-03 eta 0:15:09
epoch [19/50] batch [140/319] time 0.107 (0.092) data 0.000 (0.005) loss 1.5731 (1.5944) ce_loss 1.1865 (1.2071) teacher_loss 0.8560 (0.9457) loss_zs_kd 0.9063 (0.8002) loss_oracle 0.7171 (0.6486) acc 56.2500 (53.7500) kd_loss 0.8446 (0.8223) lr 1.4818e-03 eta 0:15:26
epoch [19/50] batch [160/319] time 0.097 (0.093) data 0.000 (0.004) loss 1.6662 (1.5947) ce_loss 1.3115 (1.1998) teacher_loss 1.0351 (0.9432) loss_zs_kd 0.7069 (0.8020) loss_oracle 0.6312 (0.6515) acc 40.6250 (53.8867) kd_loss 0.8297 (0.8221) lr 1.4818e-03 eta 0:15:37
epoch [19/50] batch [180/319] time 0.098 (0.094) data 0.000 (0.004) loss 1.5073 (1.5890) ce_loss 0.8833 (1.1954) teacher_loss 0.8440 (0.9381) loss_zs_kd 0.8121 (0.7967) loss_oracle 0.6634 (0.6509) acc 78.1250 (54.0625) kd_loss 0.8586 (0.8225) lr 1.4818e-03 eta 0:15:46
epoch [19/50] batch [200/319] time 0.110 (0.095) data 0.000 (0.003) loss 1.5160 (1.5895) ce_loss 1.2344 (1.1940) teacher_loss 0.8865 (0.9351) loss_zs_kd 0.8111 (0.8075) loss_oracle 0.6295 (0.6543) acc 46.8750 (54.0469) kd_loss 0.8174 (0.8226) lr 1.4818e-03 eta 0:15:53
epoch [19/50] batch [220/319] time 0.101 (0.096) data 0.000 (0.003) loss 1.6807 (1.5830) ce_loss 1.3203 (1.1867) teacher_loss 1.0107 (0.9292) loss_zs_kd 0.7183 (0.8119) loss_oracle 0.6701 (0.6538) acc 46.8750 (54.4602) kd_loss 0.8707 (0.8231) lr 1.4818e-03 eta 0:15:57
epoch [19/50] batch [240/319] time 0.106 (0.096) data 0.000 (0.003) loss 1.6068 (1.5844) ce_loss 1.2979 (1.1844) teacher_loss 1.0769 (0.9333) loss_zs_kd 0.7644 (0.8117) loss_oracle 0.5299 (0.6511) acc 50.0000 (54.6094) kd_loss 0.8138 (0.8232) lr 1.4818e-03 eta 0:16:01
epoch [19/50] batch [260/319] time 0.104 (0.097) data 0.000 (0.003) loss 1.9208 (1.5900) ce_loss 1.4209 (1.1814) teacher_loss 1.2725 (0.9388) loss_zs_kd 0.6506 (0.8143) loss_oracle 0.6483 (0.6511) acc 50.0000 (54.7957) kd_loss 0.8193 (0.8231) lr 1.4818e-03 eta 0:16:04
epoch [19/50] batch [280/319] time 0.105 (0.097) data 0.000 (0.002) loss 1.4208 (1.5890) ce_loss 1.0967 (1.1792) teacher_loss 0.7826 (0.9386) loss_zs_kd 0.8335 (0.8149) loss_oracle 0.6382 (0.6504) acc 59.3750 (54.7098) kd_loss 0.8055 (0.8224) lr 1.4818e-03 eta 0:16:06
epoch [19/50] batch [300/319] time 0.096 (0.098) data 0.000 (0.002) loss 1.4818 (1.5863) ce_loss 1.2715 (1.1767) teacher_loss 0.8824 (0.9369) loss_zs_kd 0.9463 (0.8246) loss_oracle 0.5994 (0.6494) acc 53.1250 (54.7604) kd_loss 0.7737 (0.8217) lr 1.4818e-03 eta 0:16:09
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,718
* accuracy: 62.1%
* error: 37.9%
* macro_f1: 54.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,128
* accuracy: 52.7%
* error: 47.3%
* macro_f1: 22.1%
******* Domain 2 best val acc:      62.8%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [20/50] batch [20/319] time 0.079 (0.139) data 0.000 (0.034) loss 1.5361 (1.5477) ce_loss 1.0684 (1.1498) teacher_loss 0.7914 (0.8727) loss_zs_kd 0.9687 (1.0113) loss_oracle 0.7447 (0.6749) acc 53.1250 (57.8125) kd_loss 0.8315 (0.8328) lr 1.4258e-03 eta 0:22:47
epoch [20/50] batch [40/319] time 0.065 (0.127) data 0.000 (0.017) loss 1.4719 (1.5485) ce_loss 1.1611 (1.1414) teacher_loss 0.7880 (0.8778) loss_zs_kd 0.8646 (0.9921) loss_oracle 0.6840 (0.6706) acc 56.2500 (57.1875) kd_loss 0.8800 (0.8305) lr 1.4258e-03 eta 0:20:47
epoch [20/50] batch [60/319] time 0.092 (0.123) data 0.000 (0.012) loss 1.2765 (1.5936) ce_loss 0.9258 (1.1761) teacher_loss 0.6410 (0.9262) loss_zs_kd 0.7091 (0.9598) loss_oracle 0.6355 (0.6674) acc 68.7500 (55.9375) kd_loss 0.7530 (0.8271) lr 1.4258e-03 eta 0:20:06
epoch [20/50] batch [80/319] time 0.089 (0.121) data 0.000 (0.009) loss 1.4990 (1.6011) ce_loss 1.0850 (1.1700) teacher_loss 0.8829 (0.9374) loss_zs_kd 1.0740 (0.9636) loss_oracle 0.6161 (0.6638) acc 56.2500 (55.8203) kd_loss 0.8265 (0.8270) lr 1.4258e-03 eta 0:19:46
epoch [20/50] batch [100/319] time 0.102 (0.116) data 0.000 (0.007) loss 1.5462 (1.6074) ce_loss 1.1582 (1.1663) teacher_loss 0.8765 (0.9464) loss_zs_kd 0.9178 (0.9607) loss_oracle 0.6697 (0.6610) acc 56.2500 (55.7812) kd_loss 0.7785 (0.8240) lr 1.4258e-03 eta 0:18:57
epoch [20/50] batch [120/319] time 0.091 (0.114) data 0.000 (0.006) loss 1.4328 (1.6060) ce_loss 1.2520 (1.1619) teacher_loss 0.8094 (0.9444) loss_zs_kd 0.8793 (0.9559) loss_oracle 0.6233 (0.6616) acc 53.1250 (55.6250) kd_loss 0.7866 (0.8205) lr 1.4258e-03 eta 0:18:34
epoch [20/50] batch [140/319] time 0.112 (0.112) data 0.000 (0.005) loss 1.5792 (1.6059) ce_loss 1.1074 (1.1656) teacher_loss 0.8700 (0.9403) loss_zs_kd 0.8815 (0.9600) loss_oracle 0.7092 (0.6656) acc 50.0000 (55.2455) kd_loss 0.8237 (0.8214) lr 1.4258e-03 eta 0:18:14
epoch [20/50] batch [160/319] time 0.103 (0.111) data 0.000 (0.005) loss 1.4538 (1.5997) ce_loss 0.9316 (1.1585) teacher_loss 0.7943 (0.9356) loss_zs_kd 0.9773 (0.9528) loss_oracle 0.6595 (0.6641) acc 68.7500 (55.4492) kd_loss 0.8221 (0.8217) lr 1.4258e-03 eta 0:18:01
epoch [20/50] batch [180/319] time 0.089 (0.110) data 0.000 (0.004) loss 1.8209 (1.6047) ce_loss 1.2021 (1.1639) teacher_loss 1.0818 (0.9415) loss_zs_kd 0.7848 (0.9334) loss_oracle 0.7391 (0.6632) acc 46.8750 (54.9132) kd_loss 0.8811 (0.8219) lr 1.4258e-03 eta 0:17:48
epoch [20/50] batch [200/319] time 0.086 (0.109) data 0.000 (0.004) loss 1.6562 (1.6070) ce_loss 1.1680 (1.1661) teacher_loss 1.1935 (0.9441) loss_zs_kd 1.1248 (0.9202) loss_oracle 0.4627 (0.6628) acc 65.6250 (54.9531) kd_loss 0.7839 (0.8220) lr 1.4258e-03 eta 0:17:32
epoch [20/50] batch [220/319] time 0.102 (0.108) data 0.000 (0.003) loss 1.7096 (1.6092) ce_loss 1.2881 (1.1636) teacher_loss 1.0611 (0.9450) loss_zs_kd 0.8875 (0.9158) loss_oracle 0.6486 (0.6643) acc 62.5000 (54.9432) kd_loss 0.8295 (0.8216) lr 1.4258e-03 eta 0:17:21
epoch [20/50] batch [240/319] time 0.093 (0.107) data 0.000 (0.003) loss 1.6781 (1.6180) ce_loss 1.1875 (1.1677) teacher_loss 1.0842 (0.9526) loss_zs_kd 0.8007 (0.9070) loss_oracle 0.5940 (0.6654) acc 59.3750 (54.7526) kd_loss 0.7922 (0.8207) lr 1.4258e-03 eta 0:17:09
epoch [20/50] batch [260/319] time 0.091 (0.106) data 0.000 (0.003) loss 1.6160 (1.6227) ce_loss 1.0674 (1.1635) teacher_loss 0.9323 (0.9566) loss_zs_kd 0.6950 (0.8963) loss_oracle 0.6837 (0.6661) acc 59.3750 (55.0240) kd_loss 0.8280 (0.8206) lr 1.4258e-03 eta 0:16:58
epoch [20/50] batch [280/319] time 0.090 (0.105) data 0.000 (0.003) loss 1.7594 (1.6302) ce_loss 1.2949 (1.1669) teacher_loss 1.0378 (0.9626) loss_zs_kd 0.8757 (0.8875) loss_oracle 0.7216 (0.6676) acc 59.3750 (55.1004) kd_loss 0.8263 (0.8204) lr 1.4258e-03 eta 0:16:46
epoch [20/50] batch [300/319] time 0.094 (0.104) data 0.000 (0.003) loss 1.5833 (1.6352) ce_loss 1.1172 (1.1667) teacher_loss 0.9718 (0.9677) loss_zs_kd 1.0895 (0.8823) loss_oracle 0.6114 (0.6674) acc 59.3750 (55.2917) kd_loss 0.7797 (0.8199) lr 1.4258e-03 eta 0:16:35
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,590
* accuracy: 59.2%
* error: 40.8%
* macro_f1: 52.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,044
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 22.7%
******* Domain 2 best val acc:      62.8%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [21/50] batch [20/319] time 0.156 (0.133) data 0.000 (0.025) loss 1.6420 (1.6303) ce_loss 1.1260 (1.1785) teacher_loss 0.9215 (0.9468) loss_zs_kd 1.0124 (0.8998) loss_oracle 0.7205 (0.6836) acc 56.2500 (51.8750) kd_loss 0.8112 (0.8297) lr 1.3681e-03 eta 0:21:11
epoch [21/50] batch [40/319] time 0.156 (0.119) data 0.000 (0.013) loss 1.6356 (1.6670) ce_loss 1.2529 (1.2026) teacher_loss 1.0326 (0.9848) loss_zs_kd 0.6447 (0.8598) loss_oracle 0.6030 (0.6821) acc 53.1250 (52.1094) kd_loss 0.7877 (0.8222) lr 1.3681e-03 eta 0:18:58
epoch [21/50] batch [60/319] time 0.080 (0.115) data 0.000 (0.009) loss 1.5478 (1.6726) ce_loss 1.2754 (1.2219) teacher_loss 0.8148 (0.9887) loss_zs_kd 1.0251 (0.8619) loss_oracle 0.7330 (0.6839) acc 50.0000 (52.0312) kd_loss 0.8253 (0.8235) lr 1.3681e-03 eta 0:18:11
epoch [21/50] batch [80/319] time 0.106 (0.109) data 0.000 (0.006) loss 1.3469 (1.6755) ce_loss 0.9072 (1.2299) teacher_loss 0.7822 (0.9960) loss_zs_kd 0.7315 (0.8429) loss_oracle 0.5647 (0.6795) acc 68.7500 (51.8359) kd_loss 0.8199 (0.8226) lr 1.3681e-03 eta 0:17:17
epoch [21/50] batch [100/319] time 0.107 (0.108) data 0.000 (0.005) loss 1.5244 (1.6788) ce_loss 1.2412 (1.2316) teacher_loss 0.8103 (1.0023) loss_zs_kd 0.6950 (0.8282) loss_oracle 0.7140 (0.6765) acc 53.1250 (51.7188) kd_loss 0.8324 (0.8223) lr 1.3681e-03 eta 0:17:03
epoch [21/50] batch [120/319] time 0.088 (0.107) data 0.000 (0.004) loss 1.5302 (1.6680) ce_loss 1.0244 (1.2200) teacher_loss 0.8470 (0.9901) loss_zs_kd 0.7837 (0.8215) loss_oracle 0.6832 (0.6778) acc 59.3750 (52.1615) kd_loss 0.8127 (0.8224) lr 1.3681e-03 eta 0:16:51
epoch [21/50] batch [140/319] time 0.112 (0.106) data 0.000 (0.004) loss 1.7229 (1.6644) ce_loss 1.3408 (1.2056) teacher_loss 1.0316 (0.9878) loss_zs_kd 0.9013 (0.8192) loss_oracle 0.6914 (0.6767) acc 40.6250 (52.6339) kd_loss 0.8117 (0.8207) lr 1.3681e-03 eta 0:16:42
epoch [21/50] batch [160/319] time 0.110 (0.106) data 0.000 (0.003) loss 1.5149 (1.6598) ce_loss 1.0566 (1.1989) teacher_loss 0.8934 (0.9904) loss_zs_kd 0.9526 (0.8124) loss_oracle 0.6214 (0.6695) acc 65.6250 (53.3594) kd_loss 0.7392 (0.8195) lr 1.3681e-03 eta 0:16:36
epoch [21/50] batch [180/319] time 0.113 (0.106) data 0.000 (0.003) loss 1.6817 (1.6494) ce_loss 1.2295 (1.1925) teacher_loss 1.0021 (0.9810) loss_zs_kd 0.8234 (0.8116) loss_oracle 0.6796 (0.6684) acc 53.1250 (53.6979) kd_loss 0.8340 (0.8200) lr 1.3681e-03 eta 0:16:33
epoch [21/50] batch [200/319] time 0.106 (0.106) data 0.000 (0.003) loss 1.7659 (1.6440) ce_loss 1.3604 (1.1890) teacher_loss 1.2561 (0.9767) loss_zs_kd 0.8785 (0.8162) loss_oracle 0.5098 (0.6673) acc 50.0000 (53.7500) kd_loss 0.7997 (0.8209) lr 1.3681e-03 eta 0:16:29
epoch [21/50] batch [220/319] time 0.104 (0.105) data 0.000 (0.003) loss 1.4279 (1.6358) ce_loss 1.0850 (1.1824) teacher_loss 0.8040 (0.9689) loss_zs_kd 0.8002 (0.8272) loss_oracle 0.6239 (0.6669) acc 53.1250 (54.1477) kd_loss 0.8108 (0.8218) lr 1.3681e-03 eta 0:16:25
epoch [21/50] batch [240/319] time 0.103 (0.105) data 0.000 (0.002) loss 1.4893 (1.6307) ce_loss 1.0605 (1.1776) teacher_loss 0.8119 (0.9633) loss_zs_kd 0.8806 (0.8287) loss_oracle 0.6774 (0.6674) acc 56.2500 (54.4401) kd_loss 0.8777 (0.8225) lr 1.3681e-03 eta 0:16:21
epoch [21/50] batch [260/319] time 0.106 (0.105) data 0.000 (0.002) loss 1.6506 (1.6351) ce_loss 1.2744 (1.1799) teacher_loss 0.9923 (0.9676) loss_zs_kd 0.8739 (0.8287) loss_oracle 0.6583 (0.6675) acc 43.7500 (54.2188) kd_loss 0.7914 (0.8227) lr 1.3681e-03 eta 0:16:17
epoch [21/50] batch [280/319] time 0.112 (0.105) data 0.000 (0.002) loss 1.5146 (1.6334) ce_loss 1.0986 (1.1793) teacher_loss 0.8563 (0.9682) loss_zs_kd 0.6735 (0.8240) loss_oracle 0.6582 (0.6652) acc 59.3750 (54.0513) kd_loss 0.8491 (0.8240) lr 1.3681e-03 eta 0:16:17
epoch [21/50] batch [300/319] time 0.098 (0.105) data 0.000 (0.002) loss 1.4378 (1.6262) ce_loss 0.9790 (1.1775) teacher_loss 0.6444 (0.9605) loss_zs_kd 0.8250 (0.8191) loss_oracle 0.7935 (0.6657) acc 59.3750 (54.1979) kd_loss 0.8619 (0.8251) lr 1.3681e-03 eta 0:16:13
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,751
* accuracy: 62.8%
* error: 37.2%
* macro_f1: 54.8%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,784
* accuracy: 49.1%
* error: 50.9%
* macro_f1: 21.1%
******* Domain 2 best val acc:      62.8%, epoch: 21 *******
******* Domain 2 best val test acc: 49.1%, epoch: 21 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [22/50] batch [20/319] time 0.138 (0.143) data 0.000 (0.026) loss 1.5471 (1.5480) ce_loss 1.2119 (1.1280) teacher_loss 0.8574 (0.8762) loss_zs_kd 1.0344 (0.8911) loss_oracle 0.6896 (0.6717) acc 50.0000 (57.5000) kd_loss 0.8711 (0.8306) lr 1.3090e-03 eta 0:21:58
epoch [22/50] batch [40/319] time 0.095 (0.126) data 0.000 (0.013) loss 1.6706 (1.5475) ce_loss 1.2393 (1.1317) teacher_loss 0.9826 (0.8784) loss_zs_kd 0.9041 (0.8488) loss_oracle 0.6880 (0.6691) acc 46.8750 (56.4844) kd_loss 0.8489 (0.8269) lr 1.3090e-03 eta 0:19:24
epoch [22/50] batch [60/319] time 0.097 (0.118) data 0.000 (0.009) loss 1.3943 (1.5659) ce_loss 1.0928 (1.1533) teacher_loss 0.7336 (0.8978) loss_zs_kd 0.8589 (0.8307) loss_oracle 0.6607 (0.6682) acc 59.3750 (55.7812) kd_loss 0.8103 (0.8314) lr 1.3090e-03 eta 0:18:06
epoch [22/50] batch [80/319] time 0.103 (0.114) data 0.000 (0.007) loss 1.8628 (1.5623) ce_loss 1.5996 (1.1583) teacher_loss 1.2070 (0.8974) loss_zs_kd 0.9678 (0.8451) loss_oracle 0.6558 (0.6649) acc 40.6250 (55.8594) kd_loss 0.8635 (0.8308) lr 1.3090e-03 eta 0:17:29
epoch [22/50] batch [100/319] time 0.111 (0.113) data 0.000 (0.005) loss 1.4526 (1.5606) ce_loss 1.2666 (1.1722) teacher_loss 0.7413 (0.9008) loss_zs_kd 0.7889 (0.8562) loss_oracle 0.7113 (0.6598) acc 43.7500 (55.0625) kd_loss 0.8747 (0.8317) lr 1.3090e-03 eta 0:17:11
epoch [22/50] batch [120/319] time 0.102 (0.111) data 0.001 (0.005) loss 1.7885 (1.5540) ce_loss 1.5938 (1.1814) teacher_loss 1.1963 (0.8929) loss_zs_kd 1.0435 (0.8632) loss_oracle 0.5922 (0.6611) acc 53.1250 (54.7656) kd_loss 0.8755 (0.8337) lr 1.3090e-03 eta 0:16:54
epoch [22/50] batch [140/319] time 0.107 (0.110) data 0.000 (0.004) loss 1.5577 (1.5555) ce_loss 1.1387 (1.1866) teacher_loss 0.9644 (0.8919) loss_zs_kd 0.8688 (0.9028) loss_oracle 0.5933 (0.6637) acc 53.1250 (54.5759) kd_loss 0.8163 (0.8388) lr 1.3090e-03 eta 0:16:42
epoch [22/50] batch [160/319] time 0.109 (0.109) data 0.000 (0.004) loss 1.5734 (1.5551) ce_loss 1.2061 (1.1863) teacher_loss 1.0850 (0.8911) loss_zs_kd 0.7160 (0.9067) loss_oracle 0.4884 (0.6641) acc 53.1250 (54.5703) kd_loss 0.7807 (0.8441) lr 1.3090e-03 eta 0:16:33
epoch [22/50] batch [180/319] time 0.106 (0.109) data 0.000 (0.003) loss 1.8437 (1.5486) ce_loss 1.2998 (1.1770) teacher_loss 1.2022 (0.8825) loss_zs_kd 0.9322 (0.9092) loss_oracle 0.6415 (0.6661) acc 50.0000 (54.7396) kd_loss 0.8698 (0.8428) lr 1.3090e-03 eta 0:16:26
epoch [22/50] batch [200/319] time 0.107 (0.108) data 0.000 (0.003) loss 1.6209 (1.5469) ce_loss 1.2842 (1.1794) teacher_loss 0.9025 (0.8836) loss_zs_kd 0.7911 (0.8999) loss_oracle 0.7184 (0.6633) acc 53.1250 (54.8438) kd_loss 0.8176 (0.8407) lr 1.3090e-03 eta 0:16:20
epoch [22/50] batch [220/319] time 0.106 (0.108) data 0.000 (0.003) loss 1.5726 (1.5494) ce_loss 0.9922 (1.1787) teacher_loss 0.9534 (0.8873) loss_zs_kd 0.7610 (0.8958) loss_oracle 0.6192 (0.6621) acc 71.8750 (54.9858) kd_loss 0.8211 (0.8409) lr 1.3090e-03 eta 0:16:15
epoch [22/50] batch [240/319] time 0.098 (0.108) data 0.000 (0.002) loss 1.6184 (1.5438) ce_loss 1.4170 (1.1719) teacher_loss 1.0134 (0.8824) loss_zs_kd 0.9825 (0.8972) loss_oracle 0.6050 (0.6614) acc 50.0000 (55.1953) kd_loss 0.8089 (0.8409) lr 1.3090e-03 eta 0:16:10
epoch [22/50] batch [260/319] time 0.101 (0.107) data 0.000 (0.002) loss 1.7151 (1.5511) ce_loss 1.1572 (1.1733) teacher_loss 1.1474 (0.8918) loss_zs_kd 0.7809 (0.8979) loss_oracle 0.5676 (0.6593) acc 59.3750 (55.1562) kd_loss 0.7957 (0.8405) lr 1.3090e-03 eta 0:16:05
epoch [22/50] batch [280/319] time 0.071 (0.107) data 0.000 (0.002) loss 1.2349 (1.5509) ce_loss 0.9238 (1.1678) teacher_loss 0.5810 (0.8935) loss_zs_kd 0.7281 (0.8916) loss_oracle 0.6539 (0.6573) acc 65.6250 (55.3348) kd_loss 0.7842 (0.8395) lr 1.3090e-03 eta 0:16:00
epoch [22/50] batch [300/319] time 0.074 (0.106) data 0.000 (0.002) loss 1.5173 (1.5543) ce_loss 1.1768 (1.1684) teacher_loss 0.9164 (0.8985) loss_zs_kd 1.0051 (0.8890) loss_oracle 0.6009 (0.6558) acc 56.2500 (55.2917) kd_loss 0.8388 (0.8382) lr 1.3090e-03 eta 0:15:48
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,678
* accuracy: 61.2%
* error: 38.8%
* macro_f1: 53.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,197
* accuracy: 43.1%
* error: 56.9%
* macro_f1: 22.0%
******* Domain 2 best val acc:      62.8%, epoch: 21 *******
******* Domain 2 best val test acc: 49.1%, epoch: 21 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [23/50] batch [20/319] time 0.151 (0.150) data 0.000 (0.030) loss 1.9061 (1.6199) ce_loss 1.2959 (1.1776) teacher_loss 1.1819 (0.9655) loss_zs_kd 0.7586 (0.8159) loss_oracle 0.7242 (0.6544) acc 50.0000 (53.2812) kd_loss 0.8523 (0.8276) lr 1.2487e-03 eta 0:22:18
epoch [23/50] batch [40/319] time 0.111 (0.133) data 0.000 (0.015) loss 1.5051 (1.6234) ce_loss 1.1260 (1.1839) teacher_loss 0.8570 (0.9703) loss_zs_kd 0.9725 (0.7916) loss_oracle 0.6480 (0.6531) acc 56.2500 (53.7500) kd_loss 0.8021 (0.8230) lr 1.2487e-03 eta 0:19:40
epoch [23/50] batch [60/319] time 0.110 (0.121) data 0.000 (0.010) loss 1.5979 (1.5856) ce_loss 1.2061 (1.1520) teacher_loss 0.9553 (0.9309) loss_zs_kd 0.9185 (0.8165) loss_oracle 0.6426 (0.6548) acc 50.0000 (55.5208) kd_loss 0.7719 (0.8265) lr 1.2487e-03 eta 0:17:56
epoch [23/50] batch [80/319] time 0.122 (0.117) data 0.000 (0.008) loss 1.5649 (1.5966) ce_loss 1.0361 (1.1519) teacher_loss 0.8702 (0.9385) loss_zs_kd 0.8225 (0.8169) loss_oracle 0.6946 (0.6581) acc 59.3750 (55.3516) kd_loss 0.7300 (0.8245) lr 1.2487e-03 eta 0:17:19
epoch [23/50] batch [100/319] time 0.107 (0.115) data 0.000 (0.006) loss 1.3595 (1.5989) ce_loss 0.9985 (1.1561) teacher_loss 0.8249 (0.9447) loss_zs_kd 0.9752 (0.8105) loss_oracle 0.5345 (0.6543) acc 68.7500 (54.7812) kd_loss 0.7363 (0.8236) lr 1.2487e-03 eta 0:16:53
epoch [23/50] batch [120/319] time 0.109 (0.113) data 0.000 (0.005) loss 1.6311 (1.5964) ce_loss 1.1572 (1.1490) teacher_loss 0.9824 (0.9426) loss_zs_kd 0.7819 (0.8059) loss_oracle 0.6488 (0.6538) acc 59.3750 (54.9740) kd_loss 0.7944 (0.8252) lr 1.2487e-03 eta 0:16:34
epoch [23/50] batch [140/319] time 0.106 (0.112) data 0.000 (0.005) loss 1.4598 (1.5932) ce_loss 1.1924 (1.1495) teacher_loss 0.7540 (0.9386) loss_zs_kd 0.6849 (0.8049) loss_oracle 0.7058 (0.6546) acc 50.0000 (55.0223) kd_loss 0.8182 (0.8249) lr 1.2487e-03 eta 0:16:21
epoch [23/50] batch [160/319] time 0.111 (0.111) data 0.000 (0.004) loss 1.5152 (1.5877) ce_loss 1.0059 (1.1489) teacher_loss 0.8450 (0.9299) loss_zs_kd 0.8257 (0.8172) loss_oracle 0.6702 (0.6578) acc 68.7500 (55.0781) kd_loss 0.8345 (0.8280) lr 1.2487e-03 eta 0:16:12
epoch [23/50] batch [180/319] time 0.097 (0.110) data 0.000 (0.004) loss 1.7004 (1.5884) ce_loss 1.2842 (1.1499) teacher_loss 1.0854 (0.9280) loss_zs_kd 0.7518 (0.8222) loss_oracle 0.6150 (0.6604) acc 40.6250 (54.8264) kd_loss 0.8013 (0.8278) lr 1.2487e-03 eta 0:16:01
epoch [23/50] batch [200/319] time 0.102 (0.109) data 0.000 (0.003) loss 1.2077 (1.5887) ce_loss 0.8203 (1.1523) teacher_loss 0.4725 (0.9260) loss_zs_kd 0.6352 (0.8214) loss_oracle 0.7352 (0.6628) acc 68.7500 (54.9062) kd_loss 0.8123 (0.8279) lr 1.2487e-03 eta 0:15:51
epoch [23/50] batch [220/319] time 0.113 (0.109) data 0.000 (0.003) loss 1.8510 (1.5898) ce_loss 1.4277 (1.1538) teacher_loss 1.2002 (0.9255) loss_zs_kd 0.8631 (0.8254) loss_oracle 0.6507 (0.6644) acc 50.0000 (55.0426) kd_loss 0.8343 (0.8297) lr 1.2487e-03 eta 0:15:45
epoch [23/50] batch [240/319] time 0.085 (0.108) data 0.000 (0.003) loss 1.5795 (1.5951) ce_loss 1.2344 (1.1610) teacher_loss 0.9074 (0.9305) loss_zs_kd 0.7757 (0.8218) loss_oracle 0.6721 (0.6646) acc 56.2500 (55.0391) kd_loss 0.7914 (0.8287) lr 1.2487e-03 eta 0:15:39
epoch [23/50] batch [260/319] time 0.104 (0.108) data 0.000 (0.003) loss 1.7116 (1.5985) ce_loss 1.2578 (1.1636) teacher_loss 1.0100 (0.9332) loss_zs_kd 0.8489 (0.8231) loss_oracle 0.7015 (0.6653) acc 50.0000 (55.1562) kd_loss 0.8535 (0.8288) lr 1.2487e-03 eta 0:15:34
epoch [23/50] batch [280/319] time 0.098 (0.107) data 0.001 (0.002) loss 1.3073 (1.5996) ce_loss 1.0049 (1.1649) teacher_loss 0.6523 (0.9326) loss_zs_kd 0.9929 (0.8241) loss_oracle 0.6550 (0.6669) acc 53.1250 (55.0112) kd_loss 0.8631 (0.8289) lr 1.2487e-03 eta 0:15:28
epoch [23/50] batch [300/319] time 0.109 (0.107) data 0.000 (0.002) loss 1.7579 (1.5995) ce_loss 1.2383 (1.1679) teacher_loss 1.0455 (0.9310) loss_zs_kd 0.9950 (0.8261) loss_oracle 0.7124 (0.6684) acc 56.2500 (55.0000) kd_loss 0.8307 (0.8292) lr 1.2487e-03 eta 0:15:23
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,772
* accuracy: 63.3%
* error: 36.7%
* macro_f1: 56.2%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,086
* accuracy: 52.2%
* error: 47.8%
* macro_f1: 22.4%
******* Domain 2 best val acc:      63.3%, epoch: 23 *******
******* Domain 2 best val test acc: 52.2%, epoch: 23 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [24/50] batch [20/319] time 0.170 (0.150) data 0.000 (0.030) loss 1.3155 (1.5474) ce_loss 0.9736 (1.1714) teacher_loss 0.6335 (0.8689) loss_zs_kd 1.0003 (0.9178) loss_oracle 0.6820 (0.6785) acc 62.5000 (56.5625) kd_loss 0.8637 (0.8494) lr 1.1874e-03 eta 0:21:29
epoch [24/50] batch [40/319] time 0.146 (0.124) data 0.000 (0.015) loss 2.1100 (1.5802) ce_loss 1.4219 (1.1665) teacher_loss 1.4165 (0.8967) loss_zs_kd 0.8321 (0.9164) loss_oracle 0.6935 (0.6836) acc 43.7500 (55.8594) kd_loss 0.8475 (0.8448) lr 1.1874e-03 eta 0:17:44
epoch [24/50] batch [60/319] time 0.112 (0.112) data 0.001 (0.010) loss 1.5839 (1.6108) ce_loss 1.2754 (1.1914) teacher_loss 0.8800 (0.9382) loss_zs_kd 0.9737 (0.8847) loss_oracle 0.7040 (0.6726) acc 50.0000 (54.8958) kd_loss 0.8604 (0.8397) lr 1.1874e-03 eta 0:16:00
epoch [24/50] batch [80/319] time 0.094 (0.109) data 0.000 (0.008) loss 1.7453 (1.6110) ce_loss 1.3340 (1.1860) teacher_loss 0.9777 (0.9351) loss_zs_kd 0.9087 (0.8655) loss_oracle 0.7676 (0.6759) acc 43.7500 (55.3125) kd_loss 0.7778 (0.8358) lr 1.1874e-03 eta 0:15:33
epoch [24/50] batch [100/319] time 0.112 (0.109) data 0.000 (0.006) loss 1.9275 (1.6128) ce_loss 1.5527 (1.1788) teacher_loss 1.3140 (0.9402) loss_zs_kd 0.8801 (0.8495) loss_oracle 0.6135 (0.6726) acc 37.5000 (55.2812) kd_loss 0.8178 (0.8344) lr 1.1874e-03 eta 0:15:24
epoch [24/50] batch [120/319] time 0.086 (0.109) data 0.000 (0.005) loss 1.6169 (1.6249) ce_loss 1.1992 (1.1835) teacher_loss 0.9674 (0.9533) loss_zs_kd 0.7497 (0.8431) loss_oracle 0.6495 (0.6716) acc 53.1250 (54.7656) kd_loss 0.8162 (0.8320) lr 1.1874e-03 eta 0:15:25
epoch [24/50] batch [140/319] time 0.102 (0.108) data 0.000 (0.005) loss 1.4732 (1.6169) ce_loss 0.9824 (1.1799) teacher_loss 0.8782 (0.9493) loss_zs_kd 0.9445 (0.8322) loss_oracle 0.5950 (0.6676) acc 71.8750 (54.9330) kd_loss 0.8068 (0.8313) lr 1.1874e-03 eta 0:15:16
epoch [24/50] batch [160/319] time 0.101 (0.108) data 0.000 (0.004) loss 1.5582 (1.6105) ce_loss 1.3828 (1.1738) teacher_loss 0.8737 (0.9430) loss_zs_kd 0.6544 (0.8291) loss_oracle 0.6845 (0.6675) acc 46.8750 (55.0586) kd_loss 0.8253 (0.8299) lr 1.1874e-03 eta 0:15:12
epoch [24/50] batch [180/319] time 0.102 (0.108) data 0.000 (0.004) loss 1.7447 (1.6116) ce_loss 1.3584 (1.1770) teacher_loss 1.1424 (0.9456) loss_zs_kd 0.7478 (0.8355) loss_oracle 0.6023 (0.6660) acc 56.2500 (55.2431) kd_loss 0.7560 (0.8282) lr 1.1874e-03 eta 0:15:08
epoch [24/50] batch [200/319] time 0.103 (0.107) data 0.000 (0.003) loss 1.4840 (1.6056) ce_loss 1.1895 (1.1742) teacher_loss 0.8559 (0.9410) loss_zs_kd 0.7972 (0.8304) loss_oracle 0.6281 (0.6645) acc 59.3750 (55.4531) kd_loss 0.8115 (0.8279) lr 1.1874e-03 eta 0:15:03
epoch [24/50] batch [220/319] time 0.105 (0.107) data 0.000 (0.003) loss 1.7477 (1.6027) ce_loss 1.3037 (1.1732) teacher_loss 1.1256 (0.9376) loss_zs_kd 0.9095 (0.8300) loss_oracle 0.6221 (0.6651) acc 53.1250 (55.4688) kd_loss 0.8899 (0.8282) lr 1.1874e-03 eta 0:15:00
epoch [24/50] batch [240/319] time 0.109 (0.107) data 0.000 (0.003) loss 1.8722 (1.5985) ce_loss 1.3750 (1.1681) teacher_loss 1.1846 (0.9345) loss_zs_kd 0.8922 (0.8276) loss_oracle 0.6875 (0.6640) acc 46.8750 (55.5729) kd_loss 0.8659 (0.8287) lr 1.1874e-03 eta 0:14:57
epoch [24/50] batch [260/319] time 0.108 (0.107) data 0.000 (0.003) loss 1.7600 (1.5975) ce_loss 1.3486 (1.1671) teacher_loss 1.1394 (0.9330) loss_zs_kd 0.6466 (0.8267) loss_oracle 0.6206 (0.6645) acc 46.8750 (55.6370) kd_loss 0.8309 (0.8294) lr 1.1874e-03 eta 0:14:54
epoch [24/50] batch [280/319] time 0.112 (0.107) data 0.000 (0.002) loss 1.7267 (1.5961) ce_loss 1.2686 (1.1697) teacher_loss 1.1016 (0.9315) loss_zs_kd 0.6869 (0.8289) loss_oracle 0.6251 (0.6646) acc 46.8750 (55.6250) kd_loss 0.8634 (0.8297) lr 1.1874e-03 eta 0:14:51
epoch [24/50] batch [300/319] time 0.120 (0.107) data 0.000 (0.002) loss 1.3769 (1.5950) ce_loss 0.9604 (1.1665) teacher_loss 0.7711 (0.9314) loss_zs_kd 0.9811 (0.8277) loss_oracle 0.6059 (0.6636) acc 62.5000 (55.7188) kd_loss 0.8761 (0.8289) lr 1.1874e-03 eta 0:14:48
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,787
* accuracy: 63.7%
* error: 36.3%
* macro_f1: 55.3%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,197
* accuracy: 53.4%
* error: 46.6%
* macro_f1: 22.6%
******* Domain 2 best val acc:      63.7%, epoch: 24 *******
******* Domain 2 best val test acc: 53.4%, epoch: 24 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [25/50] batch [20/319] time 0.085 (0.127) data 0.000 (0.029) loss 1.5772 (1.5554) ce_loss 1.1982 (1.1085) teacher_loss 0.9676 (0.9185) loss_zs_kd 0.8364 (0.8481) loss_oracle 0.6096 (0.6369) acc 65.6250 (59.8438) kd_loss 0.8209 (0.8334) lr 1.1253e-03 eta 0:17:30
epoch [25/50] batch [40/319] time 0.064 (0.117) data 0.000 (0.015) loss 1.6734 (1.5981) ce_loss 1.2031 (1.1248) teacher_loss 1.1216 (0.9629) loss_zs_kd 0.6445 (0.8035) loss_oracle 0.5518 (0.6352) acc 62.5000 (58.1250) kd_loss 0.8124 (0.8240) lr 1.1253e-03 eta 0:16:03
epoch [25/50] batch [60/319] time 0.110 (0.109) data 0.001 (0.010) loss 1.8171 (1.5971) ce_loss 1.2002 (1.1262) teacher_loss 1.2818 (0.9623) loss_zs_kd 0.9400 (0.7832) loss_oracle 0.5353 (0.6348) acc 53.1250 (57.0312) kd_loss 0.8577 (0.8238) lr 1.1253e-03 eta 0:14:55
epoch [25/50] batch [80/319] time 0.099 (0.107) data 0.000 (0.007) loss 1.6280 (1.6091) ce_loss 1.0908 (1.1305) teacher_loss 0.9994 (0.9760) loss_zs_kd 0.7842 (0.7885) loss_oracle 0.6286 (0.6332) acc 50.0000 (56.9531) kd_loss 0.7717 (0.8240) lr 1.1253e-03 eta 0:14:40
epoch [25/50] batch [100/319] time 0.110 (0.107) data 0.000 (0.006) loss 1.7955 (1.5974) ce_loss 1.2656 (1.1168) teacher_loss 1.2580 (0.9812) loss_zs_kd 0.7640 (0.7965) loss_oracle 0.5375 (0.6162) acc 62.5000 (57.4375) kd_loss 0.8096 (0.8257) lr 1.1253e-03 eta 0:14:34
epoch [25/50] batch [120/319] time 0.105 (0.106) data 0.000 (0.005) loss 1.4133 (1.5935) ce_loss 1.0332 (1.1164) teacher_loss 0.8973 (0.9869) loss_zs_kd 1.0110 (0.7947) loss_oracle 0.5160 (0.6065) acc 62.5000 (57.7083) kd_loss 0.8066 (0.8231) lr 1.1253e-03 eta 0:14:27
epoch [25/50] batch [140/319] time 0.104 (0.106) data 0.000 (0.004) loss 1.3923 (1.5874) ce_loss 1.0234 (1.1085) teacher_loss 0.7792 (0.9811) loss_zs_kd 0.9541 (0.7963) loss_oracle 0.6131 (0.6063) acc 59.3750 (58.1473) kd_loss 0.8987 (0.8230) lr 1.1253e-03 eta 0:14:22
epoch [25/50] batch [160/319] time 0.097 (0.106) data 0.000 (0.004) loss 1.4621 (1.5863) ce_loss 1.0938 (1.1087) teacher_loss 0.7910 (0.9763) loss_zs_kd 0.9427 (0.7996) loss_oracle 0.6711 (0.6100) acc 65.6250 (58.1445) kd_loss 0.8470 (0.8245) lr 1.1253e-03 eta 0:14:18
epoch [25/50] batch [180/319] time 0.116 (0.106) data 0.000 (0.004) loss 1.5249 (1.5808) ce_loss 1.0713 (1.1058) teacher_loss 0.8419 (0.9663) loss_zs_kd 0.7508 (0.8087) loss_oracle 0.6831 (0.6145) acc 56.2500 (58.2118) kd_loss 0.8191 (0.8231) lr 1.1253e-03 eta 0:14:16
epoch [25/50] batch [200/319] time 0.091 (0.106) data 0.000 (0.003) loss 1.6950 (1.5766) ce_loss 1.1367 (1.1046) teacher_loss 1.0112 (0.9576) loss_zs_kd 0.9104 (0.8228) loss_oracle 0.6838 (0.6190) acc 46.8750 (58.0781) kd_loss 0.7844 (0.8239) lr 1.1253e-03 eta 0:14:15
epoch [25/50] batch [220/319] time 0.103 (0.105) data 0.000 (0.003) loss 1.4455 (1.5807) ce_loss 1.0000 (1.1085) teacher_loss 0.8621 (0.9574) loss_zs_kd 0.9989 (0.8316) loss_oracle 0.5834 (0.6232) acc 50.0000 (57.9403) kd_loss 0.8098 (0.8247) lr 1.1253e-03 eta 0:14:09
epoch [25/50] batch [240/319] time 0.117 (0.105) data 0.000 (0.003) loss 1.8047 (1.5760) ce_loss 1.2725 (1.1036) teacher_loss 1.0797 (0.9473) loss_zs_kd 0.9890 (0.8390) loss_oracle 0.7250 (0.6286) acc 50.0000 (58.0339) kd_loss 0.8306 (0.8265) lr 1.1253e-03 eta 0:14:07
epoch [25/50] batch [260/319] time 0.094 (0.105) data 0.000 (0.003) loss 1.5607 (1.5785) ce_loss 1.2432 (1.1035) teacher_loss 0.8132 (0.9464) loss_zs_kd 0.9841 (0.8481) loss_oracle 0.7475 (0.6321) acc 40.6250 (57.9567) kd_loss 0.8207 (0.8272) lr 1.1253e-03 eta 0:14:04
epoch [25/50] batch [280/319] time 0.085 (0.105) data 0.000 (0.002) loss 1.5343 (1.5746) ce_loss 1.1123 (1.1051) teacher_loss 0.9595 (0.9412) loss_zs_kd 0.7987 (0.8487) loss_oracle 0.5748 (0.6334) acc 56.2500 (57.9241) kd_loss 0.7927 (0.8283) lr 1.1253e-03 eta 0:14:00
epoch [25/50] batch [300/319] time 0.069 (0.104) data 0.000 (0.002) loss 1.4899 (1.5742) ce_loss 1.1553 (1.1065) teacher_loss 0.9745 (0.9397) loss_zs_kd 0.8179 (0.8509) loss_oracle 0.5153 (0.6345) acc 56.2500 (57.9062) kd_loss 0.7421 (0.8277) lr 1.1253e-03 eta 0:13:51
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,745
* accuracy: 62.7%
* error: 37.3%
* macro_f1: 54.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,193
* accuracy: 53.3%
* error: 46.7%
* macro_f1: 23.4%
******* Domain 2 best val acc:      63.7%, epoch: 24 *******
******* Domain 2 best val test acc: 53.4%, epoch: 24 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [26/50] batch [20/319] time 0.170 (0.145) data 0.000 (0.037) loss 1.4428 (1.6051) ce_loss 1.1602 (1.1978) teacher_loss 0.9113 (0.9759) loss_zs_kd 0.6356 (0.8372) loss_oracle 0.5315 (0.6292) acc 50.0000 (53.2812) kd_loss 0.8152 (0.8292) lr 1.0628e-03 eta 0:19:10
epoch [26/50] batch [40/319] time 0.175 (0.128) data 0.000 (0.019) loss 1.5511 (1.5959) ce_loss 1.0693 (1.1978) teacher_loss 0.9213 (0.9521) loss_zs_kd 0.9346 (0.8254) loss_oracle 0.6297 (0.6439) acc 59.3750 (54.1406) kd_loss 0.8358 (0.8323) lr 1.0628e-03 eta 0:16:55
epoch [26/50] batch [60/319] time 0.077 (0.121) data 0.001 (0.013) loss 1.6809 (1.5631) ce_loss 1.0986 (1.1603) teacher_loss 0.9370 (0.9216) loss_zs_kd 0.7741 (0.8454) loss_oracle 0.7439 (0.6415) acc 62.5000 (56.1979) kd_loss 0.8438 (0.8315) lr 1.0628e-03 eta 0:15:59
epoch [26/50] batch [80/319] time 0.101 (0.117) data 0.000 (0.009) loss 1.6524 (1.5680) ce_loss 1.1846 (1.1733) teacher_loss 0.9124 (0.9227) loss_zs_kd 1.1463 (0.8653) loss_oracle 0.7400 (0.6453) acc 59.3750 (55.5078) kd_loss 0.8199 (0.8326) lr 1.0628e-03 eta 0:15:19
epoch [26/50] batch [100/319] time 0.102 (0.114) data 0.000 (0.008) loss 1.6576 (1.5780) ce_loss 1.1221 (1.1733) teacher_loss 0.9716 (0.9230) loss_zs_kd 0.7770 (0.8769) loss_oracle 0.6861 (0.6550) acc 53.1250 (55.8750) kd_loss 0.8124 (0.8340) lr 1.0628e-03 eta 0:14:55
epoch [26/50] batch [120/319] time 0.107 (0.112) data 0.000 (0.006) loss 1.5171 (1.5634) ce_loss 1.1162 (1.1630) teacher_loss 0.8397 (0.9060) loss_zs_kd 0.9354 (0.8831) loss_oracle 0.6774 (0.6573) acc 59.3750 (56.3281) kd_loss 0.8548 (0.8379) lr 1.0628e-03 eta 0:14:41
epoch [26/50] batch [140/319] time 0.103 (0.111) data 0.000 (0.006) loss 1.6252 (1.5632) ce_loss 1.2061 (1.1537) teacher_loss 0.9892 (0.9041) loss_zs_kd 0.8980 (0.8852) loss_oracle 0.6360 (0.6592) acc 56.2500 (56.5625) kd_loss 0.8558 (0.8386) lr 1.0628e-03 eta 0:14:30
epoch [26/50] batch [160/319] time 0.104 (0.110) data 0.000 (0.005) loss 1.4927 (1.5616) ce_loss 0.9429 (1.1471) teacher_loss 0.7641 (0.9003) loss_zs_kd 0.8146 (0.8833) loss_oracle 0.7286 (0.6613) acc 65.6250 (56.5820) kd_loss 0.8417 (0.8380) lr 1.0628e-03 eta 0:14:22
epoch [26/50] batch [180/319] time 0.105 (0.110) data 0.000 (0.004) loss 1.3575 (1.5571) ce_loss 0.9531 (1.1441) teacher_loss 0.7085 (0.8988) loss_zs_kd 0.8823 (0.8836) loss_oracle 0.6490 (0.6584) acc 62.5000 (56.4236) kd_loss 0.8166 (0.8382) lr 1.0628e-03 eta 0:14:16
epoch [26/50] batch [200/319] time 0.099 (0.109) data 0.000 (0.004) loss 1.8434 (1.5592) ce_loss 1.3750 (1.1409) teacher_loss 1.1865 (0.9033) loss_zs_kd 0.7618 (0.8792) loss_oracle 0.6568 (0.6559) acc 43.7500 (56.3438) kd_loss 0.8089 (0.8369) lr 1.0628e-03 eta 0:14:09
epoch [26/50] batch [220/319] time 0.107 (0.109) data 0.000 (0.004) loss 1.2158 (1.5614) ce_loss 0.7349 (1.1397) teacher_loss 0.7246 (0.9068) loss_zs_kd 0.6605 (0.8757) loss_oracle 0.4911 (0.6546) acc 71.8750 (56.4489) kd_loss 0.6953 (0.8350) lr 1.0628e-03 eta 0:14:04
epoch [26/50] batch [240/319] time 0.097 (0.108) data 0.000 (0.003) loss 1.5062 (1.5658) ce_loss 1.1143 (1.1382) teacher_loss 0.8519 (0.9102) loss_zs_kd 0.8676 (0.8706) loss_oracle 0.6543 (0.6556) acc 75.0000 (56.5625) kd_loss 0.8136 (0.8338) lr 1.0628e-03 eta 0:13:59
epoch [26/50] batch [260/319] time 0.103 (0.108) data 0.000 (0.003) loss 1.5111 (1.5628) ce_loss 0.9731 (1.1339) teacher_loss 0.8951 (0.9074) loss_zs_kd 0.7344 (0.8698) loss_oracle 0.6160 (0.6554) acc 62.5000 (56.7788) kd_loss 0.8562 (0.8343) lr 1.0628e-03 eta 0:13:54
epoch [26/50] batch [280/319] time 0.081 (0.108) data 0.000 (0.003) loss 1.5876 (1.5669) ce_loss 0.9448 (1.1353) teacher_loss 0.8961 (0.9106) loss_zs_kd 0.7539 (0.8690) loss_oracle 0.6915 (0.6563) acc 68.7500 (56.6741) kd_loss 0.8278 (0.8336) lr 1.0628e-03 eta 0:13:53
epoch [26/50] batch [300/319] time 0.092 (0.108) data 0.000 (0.003) loss 2.0632 (1.5728) ce_loss 1.6182 (1.1396) teacher_loss 1.3898 (0.9161) loss_zs_kd 0.8680 (0.8641) loss_oracle 0.6734 (0.6567) acc 40.6250 (56.5000) kd_loss 0.8572 (0.8341) lr 1.0628e-03 eta 0:13:47
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,796
* accuracy: 63.9%
* error: 36.1%
* macro_f1: 55.7%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,062
* accuracy: 52.0%
* error: 48.0%
* macro_f1: 22.9%
******* Domain 2 best val acc:      63.9%, epoch: 26 *******
******* Domain 2 best val test acc: 52.0%, epoch: 26 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [27/50] batch [20/319] time 0.143 (0.123) data 0.000 (0.028) loss 1.2849 (1.5599) ce_loss 0.9731 (1.1212) teacher_loss 0.6807 (0.9138) loss_zs_kd 0.6180 (0.8319) loss_oracle 0.6042 (0.6461) acc 56.2500 (54.3750) kd_loss 0.8548 (0.8381) lr 1.0000e-03 eta 0:15:42
epoch [27/50] batch [40/319] time 0.078 (0.123) data 0.001 (0.014) loss 1.3520 (1.5652) ce_loss 0.9873 (1.1263) teacher_loss 0.6313 (0.9112) loss_zs_kd 1.0735 (0.8536) loss_oracle 0.7208 (0.6540) acc 68.7500 (55.4688) kd_loss 0.7861 (0.8260) lr 1.0000e-03 eta 0:15:34
epoch [27/50] batch [60/319] time 0.080 (0.112) data 0.001 (0.010) loss 1.3798 (1.5360) ce_loss 1.0059 (1.1039) teacher_loss 0.7151 (0.8867) loss_zs_kd 1.0288 (0.8409) loss_oracle 0.6647 (0.6493) acc 62.5000 (57.3958) kd_loss 0.8578 (0.8257) lr 1.0000e-03 eta 0:14:14
epoch [27/50] batch [80/319] time 0.104 (0.108) data 0.000 (0.007) loss 1.7993 (1.5424) ce_loss 1.4189 (1.1034) teacher_loss 1.0741 (0.8922) loss_zs_kd 0.8539 (0.8357) loss_oracle 0.7253 (0.6502) acc 50.0000 (57.7344) kd_loss 0.8497 (0.8258) lr 1.0000e-03 eta 0:13:41
epoch [27/50] batch [100/319] time 0.104 (0.107) data 0.000 (0.006) loss 1.3876 (1.5364) ce_loss 0.9067 (1.0921) teacher_loss 0.7882 (0.8945) loss_zs_kd 0.9158 (0.8430) loss_oracle 0.5994 (0.6419) acc 68.7500 (58.3750) kd_loss 0.8761 (0.8227) lr 1.0000e-03 eta 0:13:31
epoch [27/50] batch [120/319] time 0.113 (0.107) data 0.000 (0.005) loss 1.4572 (1.5392) ce_loss 0.9707 (1.0916) teacher_loss 0.8307 (0.8992) loss_zs_kd 1.0067 (0.8617) loss_oracle 0.6266 (0.6400) acc 68.7500 (58.3073) kd_loss 0.8541 (0.8224) lr 1.0000e-03 eta 0:13:25
epoch [27/50] batch [140/319] time 0.111 (0.107) data 0.000 (0.004) loss 1.5249 (1.5409) ce_loss 1.0713 (1.0944) teacher_loss 0.8372 (0.9004) loss_zs_kd 0.9767 (0.8695) loss_oracle 0.6877 (0.6405) acc 56.2500 (57.9464) kd_loss 0.8001 (0.8219) lr 1.0000e-03 eta 0:13:21
epoch [27/50] batch [160/319] time 0.101 (0.106) data 0.000 (0.004) loss 1.3325 (1.5345) ce_loss 0.8750 (1.0928) teacher_loss 0.7648 (0.8944) loss_zs_kd 0.9791 (0.8875) loss_oracle 0.5677 (0.6401) acc 62.5000 (58.0469) kd_loss 0.8051 (0.8233) lr 1.0000e-03 eta 0:13:17
epoch [27/50] batch [180/319] time 0.102 (0.106) data 0.000 (0.003) loss 1.3429 (1.5377) ce_loss 0.8604 (1.0956) teacher_loss 0.7391 (0.8977) loss_zs_kd 0.8730 (0.8914) loss_oracle 0.6039 (0.6400) acc 65.6250 (58.0035) kd_loss 0.8278 (0.8247) lr 1.0000e-03 eta 0:13:12
epoch [27/50] batch [200/319] time 0.107 (0.106) data 0.000 (0.003) loss 1.4265 (1.5406) ce_loss 1.0078 (1.0991) teacher_loss 0.7285 (0.8976) loss_zs_kd 1.1714 (0.8995) loss_oracle 0.6981 (0.6431) acc 56.2500 (57.8594) kd_loss 0.8523 (0.8251) lr 1.0000e-03 eta 0:13:08
epoch [27/50] batch [220/319] time 0.109 (0.106) data 0.000 (0.003) loss 1.6879 (1.5383) ce_loss 1.1387 (1.1019) teacher_loss 0.9112 (0.8900) loss_zs_kd 0.9468 (0.9053) loss_oracle 0.7768 (0.6482) acc 53.1250 (57.7131) kd_loss 0.8404 (0.8280) lr 1.0000e-03 eta 0:13:06
epoch [27/50] batch [240/319] time 0.103 (0.106) data 0.000 (0.003) loss 1.7282 (1.5450) ce_loss 1.2764 (1.1090) teacher_loss 0.9835 (0.8934) loss_zs_kd 0.7855 (0.9081) loss_oracle 0.7447 (0.6515) acc 43.7500 (57.5000) kd_loss 0.8819 (0.8289) lr 1.0000e-03 eta 0:13:03
epoch [27/50] batch [260/319] time 0.112 (0.106) data 0.000 (0.002) loss 1.4446 (1.5450) ce_loss 1.0322 (1.1107) teacher_loss 0.7002 (0.8900) loss_zs_kd 0.9986 (0.9058) loss_oracle 0.7444 (0.6550) acc 59.3750 (57.4880) kd_loss 0.8484 (0.8290) lr 1.0000e-03 eta 0:13:01
epoch [27/50] batch [280/319] time 0.104 (0.105) data 0.000 (0.002) loss 1.8732 (1.5521) ce_loss 1.5000 (1.1170) teacher_loss 1.1398 (0.8943) loss_zs_kd 1.0401 (0.9046) loss_oracle 0.7334 (0.6578) acc 34.3750 (57.2656) kd_loss 0.8557 (0.8294) lr 1.0000e-03 eta 0:12:57
epoch [27/50] batch [300/319] time 0.091 (0.105) data 0.000 (0.002) loss 1.8350 (1.5492) ce_loss 1.3936 (1.1176) teacher_loss 1.1568 (0.8907) loss_zs_kd 1.0521 (0.9000) loss_oracle 0.6782 (0.6585) acc 46.8750 (57.2083) kd_loss 0.8388 (0.8299) lr 1.0000e-03 eta 0:12:55
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,777
* accuracy: 63.4%
* error: 36.6%
* macro_f1: 55.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,064
* accuracy: 52.0%
* error: 48.0%
* macro_f1: 23.6%
******* Domain 2 best val acc:      63.9%, epoch: 26 *******
******* Domain 2 best val test acc: 52.0%, epoch: 26 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [28/50] batch [20/319] time 0.084 (0.167) data 0.000 (0.039) loss 1.3875 (1.5017) ce_loss 1.0596 (1.0902) teacher_loss 0.7484 (0.8252) loss_zs_kd 1.0200 (0.9180) loss_oracle 0.6391 (0.6765) acc 59.3750 (56.4062) kd_loss 0.8615 (0.8437) lr 9.3721e-04 eta 0:20:25
epoch [28/50] batch [40/319] time 0.087 (0.126) data 0.000 (0.020) loss 1.6861 (1.5127) ce_loss 1.1816 (1.0865) teacher_loss 1.0115 (0.8449) loss_zs_kd 1.0428 (0.8979) loss_oracle 0.6746 (0.6679) acc 53.1250 (58.2812) kd_loss 0.9054 (0.8457) lr 9.3721e-04 eta 0:15:17
epoch [28/50] batch [60/319] time 0.107 (0.119) data 0.001 (0.013) loss 1.4481 (1.5489) ce_loss 1.0508 (1.1150) teacher_loss 0.7513 (0.8721) loss_zs_kd 0.9415 (0.9155) loss_oracle 0.6968 (0.6769) acc 59.3750 (57.1354) kd_loss 0.8261 (0.8436) lr 9.3721e-04 eta 0:14:25
epoch [28/50] batch [80/319] time 0.101 (0.115) data 0.000 (0.010) loss 1.5488 (1.5313) ce_loss 1.1719 (1.1077) teacher_loss 0.8725 (0.8515) loss_zs_kd 0.8954 (0.9186) loss_oracle 0.6763 (0.6797) acc 43.7500 (57.1484) kd_loss 0.8455 (0.8455) lr 9.3721e-04 eta 0:13:54
epoch [28/50] batch [100/319] time 0.100 (0.115) data 0.000 (0.008) loss 1.5898 (1.5319) ce_loss 1.1504 (1.1105) teacher_loss 0.8941 (0.8510) loss_zs_kd 1.0807 (0.9430) loss_oracle 0.6958 (0.6809) acc 46.8750 (57.4375) kd_loss 0.8238 (0.8441) lr 9.3721e-04 eta 0:13:53
epoch [28/50] batch [120/319] time 0.100 (0.113) data 0.000 (0.007) loss 1.4779 (1.5273) ce_loss 1.1025 (1.1045) teacher_loss 0.7881 (0.8500) loss_zs_kd 1.0666 (0.9454) loss_oracle 0.6898 (0.6772) acc 59.3750 (57.6042) kd_loss 0.8099 (0.8431) lr 9.3721e-04 eta 0:13:36
epoch [28/50] batch [140/319] time 0.101 (0.112) data 0.000 (0.006) loss 1.5203 (1.5319) ce_loss 1.0723 (1.1090) teacher_loss 0.8572 (0.8563) loss_zs_kd 0.9837 (0.9416) loss_oracle 0.6631 (0.6756) acc 53.1250 (57.6116) kd_loss 0.7894 (0.8415) lr 9.3721e-04 eta 0:13:24
epoch [28/50] batch [160/319] time 0.099 (0.111) data 0.000 (0.005) loss 1.2005 (1.5267) ce_loss 0.8379 (1.1054) teacher_loss 0.5883 (0.8521) loss_zs_kd 1.1328 (0.9310) loss_oracle 0.6122 (0.6746) acc 62.5000 (57.4414) kd_loss 0.8366 (0.8403) lr 9.3721e-04 eta 0:13:15
epoch [28/50] batch [180/319] time 0.094 (0.110) data 0.000 (0.005) loss 1.4195 (1.5181) ce_loss 0.9341 (1.0953) teacher_loss 0.7310 (0.8442) loss_zs_kd 0.9124 (0.9287) loss_oracle 0.6885 (0.6739) acc 65.6250 (57.9688) kd_loss 0.8359 (0.8394) lr 9.3721e-04 eta 0:13:07
epoch [28/50] batch [200/319] time 0.102 (0.110) data 0.000 (0.004) loss 1.6231 (1.5235) ce_loss 1.3340 (1.0981) teacher_loss 0.9210 (0.8491) loss_zs_kd 0.9188 (0.9298) loss_oracle 0.7021 (0.6743) acc 40.6250 (57.9688) kd_loss 0.8157 (0.8403) lr 9.3721e-04 eta 0:13:01
epoch [28/50] batch [220/319] time 0.118 (0.109) data 0.000 (0.004) loss 1.8727 (1.5285) ce_loss 1.2070 (1.1033) teacher_loss 1.1399 (0.8540) loss_zs_kd 0.8519 (0.9324) loss_oracle 0.7327 (0.6746) acc 56.2500 (57.8125) kd_loss 0.8958 (0.8411) lr 9.3721e-04 eta 0:12:55
epoch [28/50] batch [240/319] time 0.101 (0.109) data 0.000 (0.003) loss 1.4122 (1.5274) ce_loss 1.1143 (1.1019) teacher_loss 0.7923 (0.8534) loss_zs_kd 1.0178 (0.9396) loss_oracle 0.6199 (0.6741) acc 56.2500 (57.7604) kd_loss 0.8452 (0.8404) lr 9.3721e-04 eta 0:12:51
epoch [28/50] batch [260/319] time 0.100 (0.108) data 0.000 (0.003) loss 1.3707 (1.5226) ce_loss 0.9082 (1.1035) teacher_loss 0.6722 (0.8487) loss_zs_kd 1.1099 (0.9432) loss_oracle 0.6986 (0.6739) acc 65.6250 (57.7043) kd_loss 0.9047 (0.8394) lr 9.3721e-04 eta 0:12:46
epoch [28/50] batch [280/319] time 0.111 (0.108) data 0.000 (0.003) loss 1.3752 (1.5204) ce_loss 0.9775 (1.1038) teacher_loss 0.7218 (0.8485) loss_zs_kd 0.9732 (0.9471) loss_oracle 0.6534 (0.6719) acc 65.6250 (57.6562) kd_loss 0.8535 (0.8391) lr 9.3721e-04 eta 0:12:42
epoch [28/50] batch [300/319] time 0.107 (0.108) data 0.000 (0.003) loss 1.6840 (1.5216) ce_loss 1.3340 (1.1076) teacher_loss 0.9792 (0.8499) loss_zs_kd 0.8388 (0.9488) loss_oracle 0.7048 (0.6717) acc 46.8750 (57.6354) kd_loss 0.8291 (0.8384) lr 9.3721e-04 eta 0:12:38
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,717
* accuracy: 62.1%
* error: 37.9%
* macro_f1: 54.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,412
* accuracy: 45.3%
* error: 54.7%
* macro_f1: 21.7%
******* Domain 2 best val acc:      63.9%, epoch: 26 *******
******* Domain 2 best val test acc: 52.0%, epoch: 26 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [29/50] batch [20/319] time 0.066 (0.129) data 0.000 (0.038) loss 1.6553 (1.5442) ce_loss 1.4521 (1.1400) teacher_loss 0.9621 (0.8925) loss_zs_kd 0.7998 (0.8166) loss_oracle 0.6933 (0.6516) acc 43.7500 (57.9688) kd_loss 0.8378 (0.8302) lr 8.7467e-04 eta 0:15:03
epoch [29/50] batch [40/319] time 0.107 (0.118) data 0.000 (0.019) loss 1.4219 (1.5154) ce_loss 1.0957 (1.1252) teacher_loss 0.7964 (0.8596) loss_zs_kd 0.8787 (0.8440) loss_oracle 0.6255 (0.6557) acc 71.8750 (57.8125) kd_loss 0.8220 (0.8290) lr 8.7467e-04 eta 0:13:43
epoch [29/50] batch [60/319] time 0.106 (0.111) data 0.001 (0.013) loss 1.3255 (1.5226) ce_loss 0.9692 (1.1310) teacher_loss 0.6244 (0.8607) loss_zs_kd 0.9226 (0.8695) loss_oracle 0.7011 (0.6619) acc 62.5000 (57.7604) kd_loss 0.8444 (0.8341) lr 8.7467e-04 eta 0:12:51
epoch [29/50] batch [80/319] time 0.095 (0.108) data 0.000 (0.010) loss 1.4774 (1.5156) ce_loss 1.0527 (1.1271) teacher_loss 0.7783 (0.8588) loss_zs_kd 1.0525 (0.8925) loss_oracle 0.6991 (0.6568) acc 68.7500 (58.3984) kd_loss 0.8420 (0.8329) lr 8.7467e-04 eta 0:12:26
epoch [29/50] batch [100/319] time 0.106 (0.107) data 0.000 (0.008) loss 1.6261 (1.5176) ce_loss 1.0840 (1.1231) teacher_loss 1.0034 (0.8573) loss_zs_kd 1.2095 (0.9049) loss_oracle 0.6227 (0.6603) acc 59.3750 (58.4688) kd_loss 0.7905 (0.8350) lr 8.7467e-04 eta 0:12:19
epoch [29/50] batch [120/319] time 0.093 (0.105) data 0.000 (0.006) loss 1.3348 (1.5146) ce_loss 1.0195 (1.1172) teacher_loss 0.7540 (0.8546) loss_zs_kd 0.8492 (0.9100) loss_oracle 0.5808 (0.6601) acc 65.6250 (58.3594) kd_loss 0.8374 (0.8342) lr 8.7467e-04 eta 0:12:01
epoch [29/50] batch [140/319] time 0.108 (0.104) data 0.000 (0.006) loss 1.8119 (1.5174) ce_loss 1.3740 (1.1122) teacher_loss 1.1138 (0.8594) loss_zs_kd 1.1125 (0.9148) loss_oracle 0.6982 (0.6580) acc 43.7500 (58.5268) kd_loss 0.8384 (0.8348) lr 8.7467e-04 eta 0:11:54
epoch [29/50] batch [160/319] time 0.090 (0.103) data 0.000 (0.005) loss 1.9898 (1.5303) ce_loss 1.1699 (1.1201) teacher_loss 1.3050 (0.8717) loss_zs_kd 0.7825 (0.9166) loss_oracle 0.6849 (0.6586) acc 59.3750 (58.3008) kd_loss 0.8318 (0.8333) lr 8.7467e-04 eta 0:11:45
epoch [29/50] batch [180/319] time 0.105 (0.102) data 0.000 (0.004) loss 1.5994 (1.5370) ce_loss 1.1689 (1.1192) teacher_loss 0.9418 (0.8799) loss_zs_kd 0.6158 (0.9124) loss_oracle 0.6577 (0.6571) acc 56.2500 (58.1424) kd_loss 0.8796 (0.8323) lr 8.7467e-04 eta 0:11:39
epoch [29/50] batch [200/319] time 0.088 (0.102) data 0.000 (0.004) loss 1.5016 (1.5436) ce_loss 1.1270 (1.1225) teacher_loss 0.8843 (0.8893) loss_zs_kd 0.9483 (0.9066) loss_oracle 0.6173 (0.6542) acc 56.2500 (58.0469) kd_loss 0.8361 (0.8320) lr 8.7467e-04 eta 0:11:37
epoch [29/50] batch [220/319] time 0.080 (0.102) data 0.000 (0.004) loss 1.9605 (1.5417) ce_loss 1.4951 (1.1202) teacher_loss 1.3006 (0.8885) loss_zs_kd 0.7743 (0.8967) loss_oracle 0.6598 (0.6533) acc 40.6250 (57.9830) kd_loss 0.7777 (0.8317) lr 8.7467e-04 eta 0:11:35
epoch [29/50] batch [240/319] time 0.094 (0.102) data 0.000 (0.003) loss 1.6593 (1.5427) ce_loss 1.1738 (1.1183) teacher_loss 1.0112 (0.8891) loss_zs_kd 1.0746 (0.9062) loss_oracle 0.6482 (0.6535) acc 62.5000 (58.1771) kd_loss 0.7805 (0.8317) lr 8.7467e-04 eta 0:11:30
epoch [29/50] batch [260/319] time 0.098 (0.101) data 0.000 (0.003) loss 1.4157 (1.5462) ce_loss 1.0010 (1.1197) teacher_loss 0.8596 (0.8936) loss_zs_kd 1.1223 (0.9155) loss_oracle 0.5561 (0.6526) acc 65.6250 (58.0529) kd_loss 0.8109 (0.8322) lr 8.7467e-04 eta 0:11:23
epoch [29/50] batch [280/319] time 0.085 (0.100) data 0.000 (0.003) loss 1.5559 (1.5447) ce_loss 1.1855 (1.1174) teacher_loss 0.8595 (0.8949) loss_zs_kd 1.0771 (0.9246) loss_oracle 0.6964 (0.6498) acc 56.2500 (58.1920) kd_loss 0.8566 (0.8310) lr 8.7467e-04 eta 0:11:15
epoch [29/50] batch [300/319] time 0.107 (0.100) data 0.000 (0.003) loss 1.7270 (1.5467) ce_loss 1.3145 (1.1178) teacher_loss 1.1502 (0.8983) loss_zs_kd 1.0112 (0.9297) loss_oracle 0.5768 (0.6484) acc 46.8750 (58.1771) kd_loss 0.7555 (0.8304) lr 8.7467e-04 eta 0:11:10
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,758
* accuracy: 63.0%
* error: 37.0%
* macro_f1: 55.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,534
* accuracy: 56.8%
* error: 43.2%
* macro_f1: 23.7%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      63.9%, epoch: 26 *******
******* Domain 2 best val test acc: 52.0%, epoch: 26 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [30/50] batch [20/319] time 0.071 (0.124) data 0.000 (0.029) loss 1.2961 (1.5685) ce_loss 0.9297 (1.1821) teacher_loss 0.5961 (0.9023) loss_zs_kd 1.0200 (0.9754) loss_oracle 0.7000 (0.6662) acc 65.6250 (56.5625) kd_loss 0.8536 (0.8486) lr 8.1262e-04 eta 0:13:49
epoch [30/50] batch [40/319] time 0.109 (0.111) data 0.000 (0.014) loss 1.3060 (1.5763) ce_loss 1.1299 (1.1539) teacher_loss 0.5795 (0.9116) loss_zs_kd 0.9557 (1.0155) loss_oracle 0.7265 (0.6647) acc 56.2500 (56.2500) kd_loss 0.8862 (0.8532) lr 8.1262e-04 eta 0:12:22
epoch [30/50] batch [60/319] time 0.104 (0.109) data 0.000 (0.010) loss 1.4269 (1.5690) ce_loss 1.0039 (1.1365) teacher_loss 0.7981 (0.9134) loss_zs_kd 1.0295 (1.0122) loss_oracle 0.6288 (0.6557) acc 65.6250 (57.1354) kd_loss 0.8654 (0.8505) lr 8.1262e-04 eta 0:12:04
epoch [30/50] batch [80/319] time 0.105 (0.108) data 0.001 (0.007) loss 1.6419 (1.5752) ce_loss 1.1846 (1.1300) teacher_loss 1.0015 (0.9156) loss_zs_kd 0.8061 (1.0084) loss_oracle 0.6405 (0.6596) acc 59.3750 (57.2656) kd_loss 0.8278 (0.8467) lr 8.1262e-04 eta 0:11:52
epoch [30/50] batch [100/319] time 0.104 (0.107) data 0.000 (0.006) loss 1.4772 (1.5801) ce_loss 0.9331 (1.1294) teacher_loss 0.8947 (0.9205) loss_zs_kd 1.0205 (0.9951) loss_oracle 0.5825 (0.6596) acc 65.6250 (57.3750) kd_loss 0.8446 (0.8429) lr 8.1262e-04 eta 0:11:46
epoch [30/50] batch [120/319] time 0.103 (0.107) data 0.000 (0.005) loss 1.7487 (1.5821) ce_loss 1.1289 (1.1287) teacher_loss 0.9941 (0.9259) loss_zs_kd 0.9420 (0.9835) loss_oracle 0.7546 (0.6562) acc 59.3750 (57.4740) kd_loss 0.8969 (0.8425) lr 8.1262e-04 eta 0:11:41
epoch [30/50] batch [140/319] time 0.094 (0.106) data 0.000 (0.004) loss 1.4384 (1.5728) ce_loss 0.8901 (1.1202) teacher_loss 0.6828 (0.9162) loss_zs_kd 0.8476 (0.9704) loss_oracle 0.7556 (0.6566) acc 65.6250 (57.7455) kd_loss 0.8134 (0.8398) lr 8.1262e-04 eta 0:11:32
epoch [30/50] batch [160/319] time 0.082 (0.103) data 0.000 (0.004) loss 1.4039 (1.5690) ce_loss 1.1240 (1.1160) teacher_loss 0.7298 (0.9157) loss_zs_kd 0.6182 (0.9534) loss_oracle 0.6741 (0.6533) acc 56.2500 (57.7734) kd_loss 0.8213 (0.8372) lr 8.1262e-04 eta 0:11:16
epoch [30/50] batch [180/319] time 0.090 (0.101) data 0.000 (0.003) loss 1.5252 (1.5627) ce_loss 1.0586 (1.1136) teacher_loss 0.8749 (0.9130) loss_zs_kd 0.9460 (0.9448) loss_oracle 0.6503 (0.6497) acc 59.3750 (57.5868) kd_loss 0.8434 (0.8389) lr 8.1262e-04 eta 0:11:00
epoch [30/50] batch [200/319] time 0.107 (0.100) data 0.000 (0.003) loss 1.5975 (1.5557) ce_loss 1.0654 (1.1071) teacher_loss 0.9728 (0.9068) loss_zs_kd 0.9653 (0.9473) loss_oracle 0.6247 (0.6489) acc 62.5000 (57.8594) kd_loss 0.9118 (0.8395) lr 8.1262e-04 eta 0:10:49
epoch [30/50] batch [220/319] time 0.095 (0.101) data 0.000 (0.003) loss 1.5559 (1.5561) ce_loss 0.9277 (1.1071) teacher_loss 0.8839 (0.9043) loss_zs_kd 1.0021 (0.9564) loss_oracle 0.6720 (0.6517) acc 71.8750 (58.0256) kd_loss 0.9148 (0.8400) lr 8.1262e-04 eta 0:10:51
epoch [30/50] batch [240/319] time 0.099 (0.101) data 0.000 (0.003) loss 1.5861 (1.5628) ce_loss 1.1318 (1.1156) teacher_loss 0.9558 (0.9114) loss_zs_kd 0.9130 (0.9566) loss_oracle 0.6303 (0.6514) acc 56.2500 (57.4609) kd_loss 0.8851 (0.8403) lr 8.1262e-04 eta 0:10:51
epoch [30/50] batch [260/319] time 0.095 (0.101) data 0.000 (0.002) loss 1.5351 (1.5601) ce_loss 1.1641 (1.1184) teacher_loss 0.9552 (0.9119) loss_zs_kd 0.8127 (0.9499) loss_oracle 0.5799 (0.6482) acc 50.0000 (57.2115) kd_loss 0.7943 (0.8385) lr 8.1262e-04 eta 0:10:50
epoch [30/50] batch [280/319] time 0.106 (0.102) data 0.000 (0.002) loss 1.5535 (1.5567) ce_loss 1.0576 (1.1131) teacher_loss 0.9253 (0.9097) loss_zs_kd 0.8096 (0.9463) loss_oracle 0.6282 (0.6470) acc 56.2500 (57.3996) kd_loss 0.8312 (0.8382) lr 8.1262e-04 eta 0:10:52
epoch [30/50] batch [300/319] time 0.102 (0.102) data 0.000 (0.002) loss 1.8731 (1.5554) ce_loss 1.5127 (1.1122) teacher_loss 1.1997 (0.9094) loss_zs_kd 0.8892 (0.9431) loss_oracle 0.6734 (0.6460) acc 37.5000 (57.4375) kd_loss 0.8748 (0.8385) lr 8.1262e-04 eta 0:10:50
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,816
* accuracy: 64.3%
* error: 35.7%
* macro_f1: 56.3%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,348
* accuracy: 54.9%
* error: 45.1%
* macro_f1: 23.4%
******* Domain 2 best val acc:      64.3%, epoch: 30 *******
******* Domain 2 best val test acc: 54.9%, epoch: 30 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [31/50] batch [20/319] time 0.078 (0.137) data 0.000 (0.029) loss 1.3379 (1.4396) ce_loss 0.9712 (1.0145) teacher_loss 0.7404 (0.8082) loss_zs_kd 1.1202 (0.9442) loss_oracle 0.5975 (0.6314) acc 62.5000 (60.7812) kd_loss 0.8173 (0.8292) lr 7.5131e-04 eta 0:14:31
epoch [31/50] batch [40/319] time 0.081 (0.117) data 0.000 (0.015) loss 1.3658 (1.4716) ce_loss 1.0879 (1.0371) teacher_loss 0.8088 (0.8300) loss_zs_kd 0.8659 (0.9707) loss_oracle 0.5570 (0.6416) acc 56.2500 (60.0781) kd_loss 0.7769 (0.8316) lr 7.5131e-04 eta 0:12:22
epoch [31/50] batch [60/319] time 0.099 (0.110) data 0.001 (0.010) loss 1.4717 (1.5111) ce_loss 1.0996 (1.0643) teacher_loss 0.9201 (0.8715) loss_zs_kd 0.9413 (0.9599) loss_oracle 0.5516 (0.6395) acc 59.3750 (59.2188) kd_loss 0.8461 (0.8288) lr 7.5131e-04 eta 0:11:36
epoch [31/50] batch [80/319] time 0.109 (0.109) data 0.000 (0.007) loss 1.5629 (1.5234) ce_loss 1.3164 (1.0879) teacher_loss 0.9311 (0.8800) loss_zs_kd 0.8567 (0.9506) loss_oracle 0.6318 (0.6434) acc 43.7500 (58.0859) kd_loss 0.7868 (0.8294) lr 7.5131e-04 eta 0:11:23
epoch [31/50] batch [100/319] time 0.098 (0.107) data 0.000 (0.006) loss 1.5890 (1.5240) ce_loss 1.2197 (1.0880) teacher_loss 0.9212 (0.8742) loss_zs_kd 1.1462 (0.9509) loss_oracle 0.6678 (0.6498) acc 59.3750 (58.3438) kd_loss 0.8246 (0.8286) lr 7.5131e-04 eta 0:11:14
epoch [31/50] batch [120/319] time 0.097 (0.105) data 0.000 (0.005) loss 1.3749 (1.5341) ce_loss 1.0127 (1.0981) teacher_loss 0.6804 (0.8839) loss_zs_kd 0.8642 (0.9431) loss_oracle 0.6944 (0.6502) acc 50.0000 (57.8125) kd_loss 0.8410 (0.8317) lr 7.5131e-04 eta 0:10:57
epoch [31/50] batch [140/319] time 0.075 (0.104) data 0.000 (0.004) loss 1.4217 (1.5422) ce_loss 1.0693 (1.1077) teacher_loss 0.7604 (0.8909) loss_zs_kd 1.0934 (0.9441) loss_oracle 0.6614 (0.6513) acc 62.5000 (57.1652) kd_loss 0.8321 (0.8324) lr 7.5131e-04 eta 0:10:49
epoch [31/50] batch [160/319] time 0.090 (0.101) data 0.000 (0.004) loss 1.7440 (1.5442) ce_loss 1.0986 (1.1056) teacher_loss 1.1417 (0.8947) loss_zs_kd 1.0848 (0.9557) loss_oracle 0.6024 (0.6495) acc 59.3750 (57.3633) kd_loss 0.8946 (0.8330) lr 7.5131e-04 eta 0:10:29
epoch [31/50] batch [180/319] time 0.080 (0.099) data 0.000 (0.003) loss 1.7752 (1.5497) ce_loss 1.3623 (1.1107) teacher_loss 1.1545 (0.8993) loss_zs_kd 0.9582 (0.9607) loss_oracle 0.6206 (0.6504) acc 59.3750 (57.4306) kd_loss 0.8544 (0.8330) lr 7.5131e-04 eta 0:10:13
epoch [31/50] batch [200/319] time 0.086 (0.097) data 0.000 (0.003) loss 1.4484 (1.5513) ce_loss 1.1914 (1.1129) teacher_loss 0.8021 (0.8998) loss_zs_kd 0.9707 (0.9680) loss_oracle 0.6462 (0.6515) acc 53.1250 (57.3750) kd_loss 0.7960 (0.8333) lr 7.5131e-04 eta 0:09:59
epoch [31/50] batch [220/319] time 0.082 (0.096) data 0.000 (0.003) loss 1.4071 (1.5533) ce_loss 0.9839 (1.1122) teacher_loss 0.7681 (0.9018) loss_zs_kd 1.1572 (0.9693) loss_oracle 0.6389 (0.6514) acc 71.8750 (57.4290) kd_loss 0.8530 (0.8332) lr 7.5131e-04 eta 0:09:49
epoch [31/50] batch [240/319] time 0.099 (0.095) data 0.000 (0.003) loss 1.4669 (1.5498) ce_loss 1.1738 (1.1105) teacher_loss 0.8911 (0.9018) loss_zs_kd 0.6847 (0.9649) loss_oracle 0.5758 (0.6480) acc 56.2500 (57.4609) kd_loss 0.8215 (0.8314) lr 7.5131e-04 eta 0:09:42
epoch [31/50] batch [260/319] time 0.103 (0.095) data 0.000 (0.002) loss 1.5403 (1.5457) ce_loss 1.2588 (1.1084) teacher_loss 0.9333 (0.8974) loss_zs_kd 1.0939 (0.9647) loss_oracle 0.6070 (0.6483) acc 53.1250 (57.5361) kd_loss 0.8283 (0.8319) lr 7.5131e-04 eta 0:09:40
epoch [31/50] batch [280/319] time 0.097 (0.095) data 0.000 (0.002) loss 1.5808 (1.5502) ce_loss 1.1484 (1.1141) teacher_loss 0.9588 (0.9021) loss_zs_kd 1.0823 (0.9659) loss_oracle 0.6221 (0.6481) acc 40.6250 (57.1317) kd_loss 0.8540 (0.8323) lr 7.5131e-04 eta 0:09:39
epoch [31/50] batch [300/319] time 0.070 (0.095) data 0.000 (0.002) loss 1.1928 (1.5522) ce_loss 0.8228 (1.1153) teacher_loss 0.5490 (0.9044) loss_zs_kd 0.9339 (0.9663) loss_oracle 0.6438 (0.6478) acc 68.7500 (57.1667) kd_loss 0.8152 (0.8314) lr 7.5131e-04 eta 0:09:35
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,729
* accuracy: 62.3%
* error: 37.7%
* macro_f1: 54.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,377
* accuracy: 55.2%
* error: 44.8%
* macro_f1: 22.7%
******* Domain 2 best val acc:      64.3%, epoch: 30 *******
******* Domain 2 best val test acc: 54.9%, epoch: 30 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [32/50] batch [20/319] time 0.065 (0.137) data 0.000 (0.028) loss 1.5465 (1.5582) ce_loss 1.0664 (1.1302) teacher_loss 1.0334 (0.9253) loss_zs_kd 1.2290 (0.9959) loss_oracle 0.5131 (0.6330) acc 56.2500 (55.0000) kd_loss 0.8434 (0.8277) lr 6.9098e-04 eta 0:13:45
epoch [32/50] batch [40/319] time 0.086 (0.111) data 0.000 (0.014) loss 1.5670 (1.5356) ce_loss 1.1875 (1.1245) teacher_loss 1.0331 (0.9115) loss_zs_kd 0.8430 (0.9637) loss_oracle 0.5340 (0.6240) acc 53.1250 (56.7969) kd_loss 0.8344 (0.8265) lr 6.9098e-04 eta 0:11:10
epoch [32/50] batch [60/319] time 0.112 (0.109) data 0.001 (0.009) loss 1.4558 (1.5247) ce_loss 1.0342 (1.1119) teacher_loss 0.7142 (0.8903) loss_zs_kd 0.8899 (0.9888) loss_oracle 0.7416 (0.6345) acc 68.7500 (57.6562) kd_loss 0.8764 (0.8335) lr 6.9098e-04 eta 0:10:52
epoch [32/50] batch [80/319] time 0.105 (0.107) data 0.000 (0.007) loss 1.3780 (1.5344) ce_loss 1.0273 (1.1083) teacher_loss 0.6681 (0.8905) loss_zs_kd 1.0665 (0.9935) loss_oracle 0.7099 (0.6439) acc 53.1250 (57.4219) kd_loss 0.8757 (0.8355) lr 6.9098e-04 eta 0:10:40
epoch [32/50] batch [100/319] time 0.107 (0.106) data 0.000 (0.006) loss 1.3526 (1.5486) ce_loss 0.9844 (1.1193) teacher_loss 0.7301 (0.9007) loss_zs_kd 0.8542 (0.9844) loss_oracle 0.6225 (0.6479) acc 62.5000 (57.3438) kd_loss 0.8413 (0.8360) lr 6.9098e-04 eta 0:10:33
epoch [32/50] batch [120/319] time 0.106 (0.105) data 0.000 (0.005) loss 1.4559 (1.5400) ce_loss 1.1562 (1.1142) teacher_loss 0.7399 (0.8885) loss_zs_kd 1.0331 (0.9680) loss_oracle 0.7160 (0.6515) acc 59.3750 (57.6302) kd_loss 0.7945 (0.8372) lr 6.9098e-04 eta 0:10:24
epoch [32/50] batch [140/319] time 0.108 (0.106) data 0.000 (0.004) loss 1.5312 (1.5380) ce_loss 1.0986 (1.1123) teacher_loss 0.8445 (0.8849) loss_zs_kd 1.1297 (0.9605) loss_oracle 0.6868 (0.6532) acc 50.0000 (57.5223) kd_loss 0.8753 (0.8364) lr 6.9098e-04 eta 0:10:25
epoch [32/50] batch [160/319] time 0.100 (0.105) data 0.000 (0.004) loss 1.7452 (1.5407) ce_loss 1.2178 (1.1146) teacher_loss 1.1009 (0.8893) loss_zs_kd 0.8548 (0.9599) loss_oracle 0.6443 (0.6514) acc 53.1250 (57.6172) kd_loss 0.8758 (0.8362) lr 6.9098e-04 eta 0:10:21
epoch [32/50] batch [180/319] time 0.103 (0.105) data 0.001 (0.003) loss 1.7830 (1.5405) ce_loss 1.4463 (1.1137) teacher_loss 1.1279 (0.8892) loss_zs_kd 0.7746 (0.9589) loss_oracle 0.6551 (0.6513) acc 40.6250 (57.5868) kd_loss 0.8466 (0.8355) lr 6.9098e-04 eta 0:10:17
epoch [32/50] batch [200/319] time 0.106 (0.105) data 0.000 (0.003) loss 1.5690 (1.5455) ce_loss 1.0928 (1.1121) teacher_loss 0.8859 (0.8926) loss_zs_kd 0.8271 (0.9568) loss_oracle 0.6831 (0.6529) acc 53.1250 (57.7188) kd_loss 0.8214 (0.8343) lr 6.9098e-04 eta 0:10:14
epoch [32/50] batch [220/319] time 0.106 (0.105) data 0.000 (0.003) loss 1.7200 (1.5493) ce_loss 1.1416 (1.1087) teacher_loss 0.9486 (0.8937) loss_zs_kd 0.7310 (0.9473) loss_oracle 0.7714 (0.6556) acc 46.8750 (57.8551) kd_loss 0.8244 (0.8339) lr 6.9098e-04 eta 0:10:11
epoch [32/50] batch [240/319] time 0.101 (0.105) data 0.000 (0.003) loss 1.5496 (1.5555) ce_loss 0.9858 (1.1130) teacher_loss 0.8001 (0.8999) loss_zs_kd 0.7712 (0.9377) loss_oracle 0.7495 (0.6555) acc 62.5000 (57.5260) kd_loss 0.8220 (0.8332) lr 6.9098e-04 eta 0:10:08
epoch [32/50] batch [260/319] time 0.109 (0.105) data 0.000 (0.002) loss 1.6059 (1.5635) ce_loss 1.0322 (1.1169) teacher_loss 0.9027 (0.9081) loss_zs_kd 0.9615 (0.9339) loss_oracle 0.7032 (0.6554) acc 65.6250 (57.3678) kd_loss 0.8031 (0.8333) lr 6.9098e-04 eta 0:10:06
epoch [32/50] batch [280/319] time 0.112 (0.104) data 0.000 (0.002) loss 1.6793 (1.5710) ce_loss 1.3262 (1.1206) teacher_loss 1.0909 (0.9164) loss_zs_kd 0.8167 (0.9296) loss_oracle 0.5884 (0.6546) acc 56.2500 (57.2433) kd_loss 0.8443 (0.8328) lr 6.9098e-04 eta 0:10:04
epoch [32/50] batch [300/319] time 0.106 (0.104) data 0.000 (0.002) loss 1.5106 (1.5723) ce_loss 1.0195 (1.1161) teacher_loss 0.8544 (0.9167) loss_zs_kd 0.7525 (0.9326) loss_oracle 0.6561 (0.6555) acc 68.7500 (57.4062) kd_loss 0.8596 (0.8320) lr 6.9098e-04 eta 0:10:01
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,803
* accuracy: 64.0%
* error: 36.0%
* macro_f1: 56.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,795
* accuracy: 49.3%
* error: 50.7%
* macro_f1: 22.4%
******* Domain 2 best val acc:      64.3%, epoch: 30 *******
******* Domain 2 best val test acc: 54.9%, epoch: 30 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [33/50] batch [20/319] time 0.080 (0.148) data 0.000 (0.035) loss 1.9524 (1.6541) ce_loss 1.4395 (1.0917) teacher_loss 1.2198 (1.0042) loss_zs_kd 0.9210 (0.9299) loss_oracle 0.7327 (0.6500) acc 50.0000 (59.2188) kd_loss 0.8433 (0.8144) lr 6.3188e-04 eta 0:14:09
epoch [33/50] batch [40/319] time 0.099 (0.122) data 0.000 (0.017) loss 1.4957 (1.6362) ce_loss 1.0195 (1.0926) teacher_loss 0.8547 (0.9906) loss_zs_kd 0.9386 (0.9064) loss_oracle 0.6411 (0.6457) acc 62.5000 (60.0781) kd_loss 0.8790 (0.8222) lr 6.3188e-04 eta 0:11:35
epoch [33/50] batch [60/319] time 0.091 (0.113) data 0.000 (0.012) loss 1.0921 (1.6231) ce_loss 0.7983 (1.0949) teacher_loss 0.4697 (0.9834) loss_zs_kd 0.6869 (0.8920) loss_oracle 0.6224 (0.6396) acc 68.7500 (59.6354) kd_loss 0.8159 (0.8234) lr 6.3188e-04 eta 0:10:41
epoch [33/50] batch [80/319] time 0.100 (0.109) data 0.000 (0.009) loss 1.5441 (1.6066) ce_loss 1.0312 (1.0854) teacher_loss 0.8516 (0.9641) loss_zs_kd 1.0129 (0.8924) loss_oracle 0.6925 (0.6426) acc 62.5000 (60.1953) kd_loss 0.8268 (0.8223) lr 6.3188e-04 eta 0:10:19
epoch [33/50] batch [100/319] time 0.104 (0.108) data 0.000 (0.007) loss 1.7321 (1.6029) ce_loss 1.2344 (1.0902) teacher_loss 1.0515 (0.9588) loss_zs_kd 0.8067 (0.8861) loss_oracle 0.6806 (0.6441) acc 46.8750 (59.4375) kd_loss 0.7767 (0.8213) lr 6.3188e-04 eta 0:10:08
epoch [33/50] batch [120/319] time 0.106 (0.107) data 0.000 (0.006) loss 1.8782 (1.5974) ce_loss 1.2871 (1.0888) teacher_loss 1.1815 (0.9561) loss_zs_kd 0.8574 (0.8786) loss_oracle 0.6966 (0.6413) acc 53.1250 (59.1406) kd_loss 0.8505 (0.8204) lr 6.3188e-04 eta 0:10:03
epoch [33/50] batch [140/319] time 0.102 (0.107) data 0.000 (0.005) loss 1.4048 (1.5940) ce_loss 1.0518 (1.0828) teacher_loss 0.9032 (0.9552) loss_zs_kd 1.0594 (0.8781) loss_oracle 0.5016 (0.6389) acc 53.1250 (58.9286) kd_loss 0.7906 (0.8220) lr 6.3188e-04 eta 0:09:58
epoch [33/50] batch [160/319] time 0.092 (0.106) data 0.001 (0.005) loss 1.2184 (1.5975) ce_loss 0.7593 (1.0845) teacher_loss 0.5601 (0.9567) loss_zs_kd 0.7757 (0.8826) loss_oracle 0.6583 (0.6408) acc 75.0000 (58.6914) kd_loss 0.8217 (0.8211) lr 6.3188e-04 eta 0:09:51
epoch [33/50] batch [180/319] time 0.103 (0.105) data 0.000 (0.004) loss 1.7097 (1.6122) ce_loss 1.1162 (1.0967) teacher_loss 1.1511 (0.9711) loss_zs_kd 1.3369 (0.8755) loss_oracle 0.5586 (0.6411) acc 62.5000 (58.0382) kd_loss 0.8447 (0.8223) lr 6.3188e-04 eta 0:09:45
epoch [33/50] batch [200/319] time 0.112 (0.105) data 0.000 (0.004) loss 1.4768 (1.6112) ce_loss 0.9390 (1.0976) teacher_loss 0.8104 (0.9690) loss_zs_kd 1.2945 (0.8778) loss_oracle 0.6665 (0.6422) acc 59.3750 (58.0781) kd_loss 0.8555 (0.8228) lr 6.3188e-04 eta 0:09:42
epoch [33/50] batch [220/319] time 0.112 (0.105) data 0.000 (0.003) loss 1.3565 (1.6082) ce_loss 0.8989 (1.0944) teacher_loss 0.6813 (0.9650) loss_zs_kd 0.7518 (0.8710) loss_oracle 0.6752 (0.6432) acc 62.5000 (58.0966) kd_loss 0.8100 (0.8207) lr 6.3188e-04 eta 0:09:41
epoch [33/50] batch [240/319] time 0.108 (0.105) data 0.000 (0.003) loss 1.5931 (1.6113) ce_loss 1.0703 (1.0957) teacher_loss 0.9411 (0.9645) loss_zs_kd 0.9428 (0.8672) loss_oracle 0.6519 (0.6469) acc 62.5000 (57.9427) kd_loss 0.8166 (0.8213) lr 6.3188e-04 eta 0:09:38
epoch [33/50] batch [260/319] time 0.096 (0.105) data 0.000 (0.003) loss 1.7877 (1.6184) ce_loss 1.2100 (1.1020) teacher_loss 1.0447 (0.9706) loss_zs_kd 0.7004 (0.8613) loss_oracle 0.7431 (0.6478) acc 53.1250 (57.7404) kd_loss 0.7852 (0.8206) lr 6.3188e-04 eta 0:09:36
epoch [33/50] batch [280/319] time 0.106 (0.105) data 0.000 (0.003) loss 1.2971 (1.6153) ce_loss 0.7910 (1.0988) teacher_loss 0.6808 (0.9684) loss_zs_kd 0.7877 (0.8580) loss_oracle 0.6164 (0.6469) acc 68.7500 (57.8348) kd_loss 0.8486 (0.8195) lr 6.3188e-04 eta 0:09:33
epoch [33/50] batch [300/319] time 0.108 (0.105) data 0.000 (0.003) loss 1.3116 (1.6181) ce_loss 0.8042 (1.1023) teacher_loss 0.6749 (0.9698) loss_zs_kd 0.7202 (0.8543) loss_oracle 0.6368 (0.6483) acc 75.0000 (57.7604) kd_loss 0.8045 (0.8195) lr 6.3188e-04 eta 0:09:31
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,840
* accuracy: 64.9%
* error: 35.1%
* macro_f1: 56.9%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,896
* accuracy: 50.3%
* error: 49.7%
* macro_f1: 23.0%
******* Domain 2 best val acc:      64.9%, epoch: 33 *******
******* Domain 2 best val test acc: 50.3%, epoch: 33 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [34/50] batch [20/319] time 0.107 (0.129) data 0.000 (0.028) loss 1.9695 (1.6725) ce_loss 1.3652 (1.1197) teacher_loss 1.3618 (1.0052) loss_zs_kd 0.7640 (0.7971) loss_oracle 0.6077 (0.6673) acc 50.0000 (57.5000) kd_loss 0.7800 (0.8052) lr 5.7422e-04 eta 0:11:35
epoch [34/50] batch [40/319] time 0.106 (0.115) data 0.000 (0.014) loss 1.4321 (1.6401) ce_loss 1.0547 (1.1005) teacher_loss 0.8381 (0.9913) loss_zs_kd 0.6532 (0.8191) loss_oracle 0.5939 (0.6488) acc 53.1250 (57.5781) kd_loss 0.8179 (0.8100) lr 5.7422e-04 eta 0:10:20
epoch [34/50] batch [60/319] time 0.105 (0.111) data 0.001 (0.009) loss 1.6630 (1.5963) ce_loss 1.2422 (1.0792) teacher_loss 1.0684 (0.9607) loss_zs_kd 0.7674 (0.8315) loss_oracle 0.5946 (0.6356) acc 50.0000 (58.8021) kd_loss 0.7905 (0.8118) lr 5.7422e-04 eta 0:09:57
epoch [34/50] batch [80/319] time 0.104 (0.109) data 0.000 (0.007) loss 1.7807 (1.5869) ce_loss 1.2617 (1.0753) teacher_loss 1.0973 (0.9546) loss_zs_kd 0.9050 (0.8222) loss_oracle 0.6834 (0.6323) acc 59.3750 (58.8672) kd_loss 0.8165 (0.8109) lr 5.7422e-04 eta 0:09:44
epoch [34/50] batch [100/319] time 0.106 (0.108) data 0.000 (0.006) loss 1.6255 (1.5959) ce_loss 1.0342 (1.0782) teacher_loss 1.0206 (0.9686) loss_zs_kd 0.7955 (0.8341) loss_oracle 0.6049 (0.6272) acc 71.8750 (58.7812) kd_loss 0.7974 (0.8113) lr 5.7422e-04 eta 0:09:34
epoch [34/50] batch [120/319] time 0.087 (0.106) data 0.000 (0.005) loss 1.7205 (1.5871) ce_loss 1.1182 (1.0666) teacher_loss 1.0205 (0.9614) loss_zs_kd 0.8385 (0.8334) loss_oracle 0.7000 (0.6257) acc 56.2500 (59.1146) kd_loss 0.7953 (0.8117) lr 5.7422e-04 eta 0:09:23
epoch [34/50] batch [140/319] time 0.094 (0.104) data 0.000 (0.004) loss 1.8007 (1.5920) ce_loss 1.2559 (1.0707) teacher_loss 1.1557 (0.9682) loss_zs_kd 0.8120 (0.8375) loss_oracle 0.6450 (0.6238) acc 46.8750 (58.9062) kd_loss 0.8245 (0.8130) lr 5.7422e-04 eta 0:09:09
epoch [34/50] batch [160/319] time 0.104 (0.103) data 0.000 (0.004) loss 1.6179 (1.5911) ce_loss 1.1172 (1.0721) teacher_loss 1.0315 (0.9706) loss_zs_kd 0.9083 (0.8451) loss_oracle 0.5864 (0.6205) acc 59.3750 (59.1406) kd_loss 0.8154 (0.8123) lr 5.7422e-04 eta 0:09:02
epoch [34/50] batch [180/319] time 0.100 (0.103) data 0.000 (0.003) loss 1.5680 (1.5944) ce_loss 1.1475 (1.0760) teacher_loss 0.8925 (0.9750) loss_zs_kd 1.1225 (0.8551) loss_oracle 0.6755 (0.6194) acc 62.5000 (58.9410) kd_loss 0.8907 (0.8136) lr 5.7422e-04 eta 0:09:01
epoch [34/50] batch [200/319] time 0.098 (0.103) data 0.000 (0.003) loss 1.4940 (1.6028) ce_loss 1.0156 (1.0822) teacher_loss 0.9207 (0.9857) loss_zs_kd 0.6922 (0.8503) loss_oracle 0.5733 (0.6171) acc 65.6250 (58.6562) kd_loss 0.7748 (0.8145) lr 5.7422e-04 eta 0:08:59
epoch [34/50] batch [220/319] time 0.104 (0.103) data 0.000 (0.003) loss 1.4323 (1.6009) ce_loss 0.8154 (1.0803) teacher_loss 0.8110 (0.9843) loss_zs_kd 0.8813 (0.8509) loss_oracle 0.6213 (0.6167) acc 75.0000 (58.7500) kd_loss 0.8836 (0.8150) lr 5.7422e-04 eta 0:08:57
epoch [34/50] batch [240/319] time 0.100 (0.103) data 0.000 (0.003) loss 1.8058 (1.6028) ce_loss 1.2148 (1.0787) teacher_loss 1.1796 (0.9834) loss_zs_kd 0.9629 (0.8497) loss_oracle 0.6262 (0.6194) acc 56.2500 (58.9062) kd_loss 0.7599 (0.8159) lr 5.7422e-04 eta 0:08:55
epoch [34/50] batch [260/319] time 0.098 (0.103) data 0.000 (0.002) loss 1.3295 (1.5983) ce_loss 0.8203 (1.0743) teacher_loss 0.6361 (0.9765) loss_zs_kd 0.7700 (0.8476) loss_oracle 0.6934 (0.6219) acc 59.3750 (59.1346) kd_loss 0.7967 (0.8167) lr 5.7422e-04 eta 0:08:53
epoch [34/50] batch [280/319] time 0.100 (0.103) data 0.000 (0.002) loss 1.3946 (1.5949) ce_loss 0.7925 (1.0710) teacher_loss 0.7022 (0.9707) loss_zs_kd 1.0216 (0.8504) loss_oracle 0.6923 (0.6242) acc 81.2500 (59.1518) kd_loss 0.8906 (0.8180) lr 5.7422e-04 eta 0:08:51
epoch [34/50] batch [300/319] time 0.108 (0.104) data 0.001 (0.002) loss 1.5580 (1.5970) ce_loss 1.1016 (1.0727) teacher_loss 0.9631 (0.9710) loss_zs_kd 1.0364 (0.8547) loss_oracle 0.5949 (0.6260) acc 62.5000 (59.0521) kd_loss 0.8113 (0.8191) lr 5.7422e-04 eta 0:08:51
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,815
* accuracy: 64.3%
* error: 35.7%
* macro_f1: 56.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,731
* accuracy: 48.6%
* error: 51.4%
* macro_f1: 21.9%
******* Domain 2 best val acc:      64.9%, epoch: 33 *******
******* Domain 2 best val test acc: 50.3%, epoch: 33 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [35/50] batch [20/319] time 0.101 (0.123) data 0.000 (0.027) loss 1.6538 (1.5912) ce_loss 1.2197 (1.0493) teacher_loss 1.0271 (0.9693) loss_zs_kd 0.8472 (0.8383) loss_oracle 0.6267 (0.6219) acc 50.0000 (60.3125) kd_loss 0.8291 (0.8182) lr 5.1825e-04 eta 0:10:26
epoch [35/50] batch [40/319] time 0.108 (0.111) data 0.000 (0.014) loss 1.4937 (1.5927) ce_loss 0.9683 (1.0468) teacher_loss 0.9052 (0.9513) loss_zs_kd 0.9134 (0.8474) loss_oracle 0.5885 (0.6414) acc 65.6250 (60.5469) kd_loss 0.8119 (0.8208) lr 5.1825e-04 eta 0:09:21
epoch [35/50] batch [60/319] time 0.091 (0.108) data 0.001 (0.009) loss 1.7095 (1.6167) ce_loss 1.0654 (1.0683) teacher_loss 1.0015 (0.9691) loss_zs_kd 0.8258 (0.8362) loss_oracle 0.7079 (0.6477) acc 65.6250 (59.6354) kd_loss 0.8562 (0.8237) lr 5.1825e-04 eta 0:09:04
epoch [35/50] batch [80/319] time 0.112 (0.107) data 0.000 (0.007) loss 1.6808 (1.6037) ce_loss 1.1553 (1.0572) teacher_loss 1.0002 (0.9581) loss_zs_kd 0.8246 (0.8419) loss_oracle 0.6806 (0.6456) acc 59.3750 (60.0781) kd_loss 0.8024 (0.8241) lr 5.1825e-04 eta 0:08:58
epoch [35/50] batch [100/319] time 0.096 (0.106) data 0.000 (0.006) loss 1.6953 (1.5946) ce_loss 1.1660 (1.0502) teacher_loss 1.0671 (0.9428) loss_zs_kd 0.9840 (0.8424) loss_oracle 0.6282 (0.6517) acc 62.5000 (60.2500) kd_loss 0.8269 (0.8261) lr 5.1825e-04 eta 0:08:52
epoch [35/50] batch [120/319] time 0.105 (0.105) data 0.000 (0.005) loss 1.7673 (1.5955) ce_loss 1.0635 (1.0538) teacher_loss 1.1089 (0.9439) loss_zs_kd 0.9816 (0.8433) loss_oracle 0.6584 (0.6515) acc 68.7500 (60.0781) kd_loss 0.7573 (0.8241) lr 5.1825e-04 eta 0:08:45
epoch [35/50] batch [140/319] time 0.109 (0.105) data 0.001 (0.004) loss 1.4108 (1.5894) ce_loss 1.1367 (1.0478) teacher_loss 0.7425 (0.9370) loss_zs_kd 0.8226 (0.8447) loss_oracle 0.6682 (0.6524) acc 53.1250 (60.1562) kd_loss 0.9027 (0.8252) lr 5.1825e-04 eta 0:08:43
epoch [35/50] batch [160/319] time 0.125 (0.105) data 0.000 (0.004) loss 1.7225 (1.5884) ce_loss 1.1816 (1.0506) teacher_loss 1.1024 (0.9360) loss_zs_kd 0.9353 (0.8521) loss_oracle 0.6202 (0.6525) acc 50.0000 (59.8828) kd_loss 0.7924 (0.8253) lr 5.1825e-04 eta 0:08:41
epoch [35/50] batch [180/319] time 0.102 (0.105) data 0.000 (0.003) loss 1.6548 (1.5951) ce_loss 1.1953 (1.0617) teacher_loss 1.0123 (0.9460) loss_zs_kd 0.7473 (0.8541) loss_oracle 0.6425 (0.6491) acc 56.2500 (59.4444) kd_loss 0.8365 (0.8251) lr 5.1825e-04 eta 0:08:37
epoch [35/50] batch [200/319] time 0.097 (0.105) data 0.000 (0.003) loss 1.5817 (1.6048) ce_loss 1.0381 (1.0708) teacher_loss 0.9781 (0.9551) loss_zs_kd 0.6221 (0.8542) loss_oracle 0.6036 (0.6497) acc 62.5000 (59.2500) kd_loss 0.8208 (0.8245) lr 5.1825e-04 eta 0:08:35
epoch [35/50] batch [220/319] time 0.111 (0.105) data 0.000 (0.003) loss 1.9442 (1.5977) ce_loss 1.2754 (1.0654) teacher_loss 1.3141 (0.9465) loss_zs_kd 0.8037 (0.8551) loss_oracle 0.6302 (0.6512) acc 53.1250 (59.4034) kd_loss 0.7956 (0.8241) lr 5.1825e-04 eta 0:08:33
epoch [35/50] batch [240/319] time 0.103 (0.105) data 0.000 (0.003) loss 1.3983 (1.5989) ce_loss 1.0488 (1.0684) teacher_loss 0.7736 (0.9476) loss_zs_kd 0.8582 (0.8559) loss_oracle 0.6247 (0.6513) acc 56.2500 (59.3620) kd_loss 0.8761 (0.8243) lr 5.1825e-04 eta 0:08:30
epoch [35/50] batch [260/319] time 0.106 (0.105) data 0.000 (0.002) loss 1.2562 (1.5931) ce_loss 0.7617 (1.0662) teacher_loss 0.6039 (0.9402) loss_zs_kd 0.9086 (0.8586) loss_oracle 0.6523 (0.6529) acc 81.2500 (59.3990) kd_loss 0.8442 (0.8241) lr 5.1825e-04 eta 0:08:27
epoch [35/50] batch [280/319] time 0.098 (0.105) data 0.000 (0.002) loss 1.6382 (1.5949) ce_loss 1.1094 (1.0689) teacher_loss 0.9355 (0.9404) loss_zs_kd 1.0526 (0.8688) loss_oracle 0.7027 (0.6545) acc 59.3750 (59.2969) kd_loss 0.9454 (0.8254) lr 5.1825e-04 eta 0:08:25
epoch [35/50] batch [300/319] time 0.118 (0.105) data 0.000 (0.002) loss 1.3606 (1.5904) ce_loss 0.9897 (1.0673) teacher_loss 0.7441 (0.9365) loss_zs_kd 0.8935 (0.8753) loss_oracle 0.6165 (0.6539) acc 59.3750 (59.3958) kd_loss 0.8046 (0.8251) lr 5.1825e-04 eta 0:08:22
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,848
* accuracy: 65.1%
* error: 34.9%
* macro_f1: 57.9%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,225
* accuracy: 53.7%
* error: 46.3%
* macro_f1: 23.4%
******* Domain 2 best val acc:      65.1%, epoch: 35 *******
******* Domain 2 best val test acc: 53.7%, epoch: 35 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [36/50] batch [20/319] time 0.114 (0.119) data 0.000 (0.028) loss 1.5799 (1.6094) ce_loss 1.0488 (1.1118) teacher_loss 0.9707 (0.9605) loss_zs_kd 0.6765 (0.9261) loss_oracle 0.6092 (0.6489) acc 62.5000 (57.1875) kd_loss 0.8097 (0.8362) lr 4.6417e-04 eta 0:09:26
epoch [36/50] batch [40/319] time 0.106 (0.110) data 0.000 (0.014) loss 1.5880 (1.6220) ce_loss 1.0693 (1.1287) teacher_loss 0.9108 (0.9716) loss_zs_kd 0.8849 (0.9224) loss_oracle 0.6772 (0.6504) acc 56.2500 (56.3281) kd_loss 0.8419 (0.8373) lr 4.6417e-04 eta 0:08:43
epoch [36/50] batch [60/319] time 0.103 (0.108) data 0.001 (0.009) loss 1.4477 (1.6022) ce_loss 0.9995 (1.1022) teacher_loss 0.8797 (0.9544) loss_zs_kd 1.2220 (0.9152) loss_oracle 0.5680 (0.6478) acc 65.6250 (57.9688) kd_loss 0.8124 (0.8288) lr 4.6417e-04 eta 0:08:29
epoch [36/50] batch [80/319] time 0.101 (0.107) data 0.000 (0.007) loss 1.6448 (1.6102) ce_loss 1.0137 (1.1114) teacher_loss 0.9846 (0.9639) loss_zs_kd 0.9603 (0.8979) loss_oracle 0.6602 (0.6463) acc 59.3750 (56.9922) kd_loss 0.8238 (0.8290) lr 4.6417e-04 eta 0:08:22
epoch [36/50] batch [100/319] time 0.094 (0.106) data 0.000 (0.006) loss 1.5054 (1.5942) ce_loss 1.1006 (1.1030) teacher_loss 0.7663 (0.9517) loss_zs_kd 1.0910 (0.8882) loss_oracle 0.7390 (0.6424) acc 53.1250 (57.4688) kd_loss 0.8641 (0.8266) lr 4.6417e-04 eta 0:08:18
epoch [36/50] batch [120/319] time 0.097 (0.106) data 0.000 (0.005) loss 1.5683 (1.5894) ce_loss 0.9907 (1.0995) teacher_loss 0.9086 (0.9480) loss_zs_kd 0.9135 (0.8859) loss_oracle 0.6597 (0.6414) acc 62.5000 (57.8646) kd_loss 0.8228 (0.8264) lr 4.6417e-04 eta 0:08:13
epoch [36/50] batch [140/319] time 0.131 (0.106) data 0.000 (0.004) loss 1.6682 (1.5794) ce_loss 1.0371 (1.0910) teacher_loss 0.9829 (0.9412) loss_zs_kd 0.7529 (0.8909) loss_oracle 0.6853 (0.6382) acc 62.5000 (58.2366) kd_loss 0.8415 (0.8270) lr 4.6417e-04 eta 0:08:13
epoch [36/50] batch [160/319] time 0.099 (0.106) data 0.000 (0.004) loss 1.7119 (1.5766) ce_loss 1.0000 (1.0878) teacher_loss 0.9759 (0.9346) loss_zs_kd 0.7560 (0.8971) loss_oracle 0.7360 (0.6420) acc 62.5000 (58.2617) kd_loss 0.8386 (0.8276) lr 4.6417e-04 eta 0:08:10
epoch [36/50] batch [180/319] time 0.100 (0.106) data 0.000 (0.003) loss 1.7371 (1.5717) ce_loss 1.2812 (1.0845) teacher_loss 1.0599 (0.9280) loss_zs_kd 0.9788 (0.8957) loss_oracle 0.6772 (0.6438) acc 46.8750 (58.5069) kd_loss 0.8679 (0.8283) lr 4.6417e-04 eta 0:08:08
epoch [36/50] batch [200/319] time 0.105 (0.106) data 0.000 (0.003) loss 1.4938 (1.5731) ce_loss 0.9771 (1.0871) teacher_loss 0.8364 (0.9250) loss_zs_kd 0.8109 (0.8971) loss_oracle 0.6574 (0.6481) acc 62.5000 (58.6406) kd_loss 0.8194 (0.8298) lr 4.6417e-04 eta 0:08:05
epoch [36/50] batch [220/319] time 0.100 (0.106) data 0.000 (0.003) loss 1.5574 (1.5730) ce_loss 0.9565 (1.0859) teacher_loss 0.9449 (0.9235) loss_zs_kd 1.0670 (0.9066) loss_oracle 0.6125 (0.6495) acc 59.3750 (58.6790) kd_loss 0.8347 (0.8302) lr 4.6417e-04 eta 0:08:02
epoch [36/50] batch [240/319] time 0.104 (0.105) data 0.000 (0.003) loss 1.5431 (1.5751) ce_loss 1.0723 (1.0881) teacher_loss 0.8597 (0.9242) loss_zs_kd 1.1582 (0.9148) loss_oracle 0.6834 (0.6508) acc 53.1250 (58.5807) kd_loss 0.8346 (0.8299) lr 4.6417e-04 eta 0:07:59
epoch [36/50] batch [260/319] time 0.111 (0.105) data 0.000 (0.002) loss 1.6650 (1.5748) ce_loss 1.2773 (1.0880) teacher_loss 1.0408 (0.9244) loss_zs_kd 0.6780 (0.9149) loss_oracle 0.6242 (0.6504) acc 46.8750 (58.2452) kd_loss 0.8205 (0.8290) lr 4.6417e-04 eta 0:07:56
epoch [36/50] batch [280/319] time 0.108 (0.105) data 0.000 (0.002) loss 1.6625 (1.5724) ce_loss 1.3467 (1.0897) teacher_loss 0.9951 (0.9212) loss_zs_kd 0.8202 (0.9120) loss_oracle 0.6674 (0.6511) acc 46.8750 (58.0357) kd_loss 0.8213 (0.8286) lr 4.6417e-04 eta 0:07:53
epoch [36/50] batch [300/319] time 0.104 (0.105) data 0.000 (0.002) loss 1.7694 (1.5736) ce_loss 1.3623 (1.0892) teacher_loss 1.0797 (0.9216) loss_zs_kd 0.9479 (0.9150) loss_oracle 0.6897 (0.6520) acc 46.8750 (58.2292) kd_loss 0.8752 (0.8296) lr 4.6417e-04 eta 0:07:51
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,821
* accuracy: 64.4%
* error: 35.6%
* macro_f1: 57.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,012
* accuracy: 51.5%
* error: 48.5%
* macro_f1: 24.7%
******* Domain 2 best val acc:      65.1%, epoch: 35 *******
******* Domain 2 best val test acc: 53.7%, epoch: 35 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [37/50] batch [20/319] time 0.101 (0.136) data 0.000 (0.031) loss 1.5564 (1.5149) ce_loss 1.0273 (1.0552) teacher_loss 0.8969 (0.8571) loss_zs_kd 1.2290 (0.9227) loss_oracle 0.6595 (0.6578) acc 59.3750 (59.0625) kd_loss 0.8715 (0.8282) lr 4.1221e-04 eta 0:10:03
epoch [37/50] batch [40/319] time 0.098 (0.118) data 0.000 (0.016) loss 1.7398 (1.5093) ce_loss 1.3184 (1.0605) teacher_loss 1.0432 (0.8466) loss_zs_kd 0.8179 (0.9107) loss_oracle 0.6967 (0.6627) acc 59.3750 (60.2344) kd_loss 0.8877 (0.8329) lr 4.1221e-04 eta 0:08:43
epoch [37/50] batch [60/319] time 0.108 (0.114) data 0.000 (0.010) loss 1.4092 (1.5306) ce_loss 1.0381 (1.0801) teacher_loss 0.7258 (0.8706) loss_zs_kd 1.2427 (0.9178) loss_oracle 0.6834 (0.6599) acc 59.3750 (59.1146) kd_loss 0.8362 (0.8328) lr 4.1221e-04 eta 0:08:22
epoch [37/50] batch [80/319] time 0.117 (0.112) data 0.001 (0.008) loss 1.6062 (1.5465) ce_loss 1.3740 (1.0962) teacher_loss 0.8925 (0.8856) loss_zs_kd 0.9484 (0.9336) loss_oracle 0.7137 (0.6610) acc 43.7500 (58.3203) kd_loss 0.8932 (0.8344) lr 4.1221e-04 eta 0:08:09
epoch [37/50] batch [100/319] time 0.106 (0.110) data 0.000 (0.006) loss 1.6302 (1.5384) ce_loss 1.0996 (1.0904) teacher_loss 0.9596 (0.8782) loss_zs_kd 0.9317 (0.9387) loss_oracle 0.6707 (0.6602) acc 62.5000 (58.2500) kd_loss 0.8156 (0.8394) lr 4.1221e-04 eta 0:08:01
epoch [37/50] batch [120/319] time 0.099 (0.109) data 0.000 (0.005) loss 1.7383 (1.5426) ce_loss 1.2598 (1.0907) teacher_loss 0.9926 (0.8806) loss_zs_kd 1.0315 (0.9463) loss_oracle 0.7457 (0.6620) acc 56.2500 (58.5156) kd_loss 0.8956 (0.8426) lr 4.1221e-04 eta 0:07:54
epoch [37/50] batch [140/319] time 0.098 (0.109) data 0.000 (0.005) loss 1.3351 (1.5420) ce_loss 0.8994 (1.0893) teacher_loss 0.6227 (0.8786) loss_zs_kd 1.0557 (0.9586) loss_oracle 0.7124 (0.6634) acc 65.6250 (58.3259) kd_loss 0.8520 (0.8443) lr 4.1221e-04 eta 0:07:50
epoch [37/50] batch [160/319] time 0.108 (0.108) data 0.000 (0.004) loss 1.7410 (1.5465) ce_loss 1.1689 (1.0915) teacher_loss 1.0580 (0.8838) loss_zs_kd 1.0336 (0.9621) loss_oracle 0.6830 (0.6627) acc 46.8750 (58.1445) kd_loss 0.8160 (0.8444) lr 4.1221e-04 eta 0:07:46
epoch [37/50] batch [180/319] time 0.109 (0.108) data 0.000 (0.004) loss 1.5748 (1.5475) ce_loss 1.0840 (1.0939) teacher_loss 0.8462 (0.8834) loss_zs_kd 1.2921 (0.9671) loss_oracle 0.7286 (0.6641) acc 59.3750 (58.0208) kd_loss 0.8296 (0.8454) lr 4.1221e-04 eta 0:07:42
epoch [37/50] batch [200/319] time 0.109 (0.108) data 0.000 (0.003) loss 1.4469 (1.5433) ce_loss 1.0928 (1.0905) teacher_loss 0.7976 (0.8806) loss_zs_kd 0.9769 (0.9652) loss_oracle 0.6493 (0.6627) acc 62.5000 (58.2969) kd_loss 0.8211 (0.8448) lr 4.1221e-04 eta 0:07:39
epoch [37/50] batch [220/319] time 0.129 (0.107) data 0.000 (0.003) loss 1.8045 (1.5381) ce_loss 1.3184 (1.0855) teacher_loss 1.0681 (0.8743) loss_zs_kd 0.8973 (0.9580) loss_oracle 0.7364 (0.6638) acc 46.8750 (58.4659) kd_loss 0.8601 (0.8434) lr 4.1221e-04 eta 0:07:35
epoch [37/50] batch [240/319] time 0.115 (0.107) data 0.000 (0.003) loss 1.5083 (1.5359) ce_loss 1.0488 (1.0801) teacher_loss 0.8426 (0.8720) loss_zs_kd 0.8595 (0.9521) loss_oracle 0.6657 (0.6640) acc 59.3750 (58.4766) kd_loss 0.8547 (0.8424) lr 4.1221e-04 eta 0:07:33
epoch [37/50] batch [260/319] time 0.108 (0.107) data 0.001 (0.003) loss 1.5999 (1.5464) ce_loss 1.3115 (1.0874) teacher_loss 0.9758 (0.8824) loss_zs_kd 0.8294 (0.9459) loss_oracle 0.6242 (0.6640) acc 40.6250 (58.0769) kd_loss 0.8027 (0.8412) lr 4.1221e-04 eta 0:07:30
epoch [37/50] batch [280/319] time 0.091 (0.107) data 0.000 (0.002) loss 1.4767 (1.5486) ce_loss 0.9976 (1.0901) teacher_loss 0.8642 (0.8837) loss_zs_kd 0.7877 (0.9440) loss_oracle 0.6125 (0.6649) acc 65.6250 (58.0469) kd_loss 0.8099 (0.8403) lr 4.1221e-04 eta 0:07:28
epoch [37/50] batch [300/319] time 0.101 (0.107) data 0.000 (0.002) loss 1.3864 (1.5476) ce_loss 1.1211 (1.0882) teacher_loss 0.6520 (0.8807) loss_zs_kd 0.9699 (0.9439) loss_oracle 0.7344 (0.6669) acc 56.2500 (58.1146) kd_loss 0.8666 (0.8401) lr 4.1221e-04 eta 0:07:24
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,779
* accuracy: 63.5%
* error: 36.5%
* macro_f1: 56.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,515
* accuracy: 46.4%
* error: 53.6%
* macro_f1: 22.5%
******* Domain 2 best val acc:      65.1%, epoch: 35 *******
******* Domain 2 best val test acc: 53.7%, epoch: 35 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [38/50] batch [20/319] time 0.066 (0.132) data 0.000 (0.034) loss 1.5281 (1.5877) ce_loss 0.9795 (1.1199) teacher_loss 0.8855 (0.9284) loss_zs_kd 1.0759 (0.8780) loss_oracle 0.6426 (0.6593) acc 68.7500 (57.9688) kd_loss 0.8372 (0.8455) lr 3.6258e-04 eta 0:09:04
epoch [38/50] batch [40/319] time 0.113 (0.115) data 0.000 (0.017) loss 1.5973 (1.5771) ce_loss 1.1396 (1.0962) teacher_loss 0.9680 (0.9159) loss_zs_kd 0.6934 (0.8766) loss_oracle 0.6293 (0.6611) acc 59.3750 (58.5156) kd_loss 0.8408 (0.8399) lr 3.6258e-04 eta 0:07:50
epoch [38/50] batch [60/319] time 0.099 (0.109) data 0.000 (0.012) loss 1.7839 (1.5935) ce_loss 1.2051 (1.1222) teacher_loss 1.2120 (0.9374) loss_zs_kd 1.0257 (0.8745) loss_oracle 0.5719 (0.6562) acc 65.6250 (57.3438) kd_loss 0.8272 (0.8367) lr 3.6258e-04 eta 0:07:26
epoch [38/50] batch [80/319] time 0.104 (0.108) data 0.000 (0.009) loss 1.6639 (1.5847) ce_loss 1.3125 (1.1093) teacher_loss 0.9793 (0.9236) loss_zs_kd 1.1750 (0.8832) loss_oracle 0.6847 (0.6611) acc 50.0000 (57.6172) kd_loss 0.8292 (0.8373) lr 3.6258e-04 eta 0:07:17
epoch [38/50] batch [100/319] time 0.106 (0.107) data 0.000 (0.007) loss 1.4677 (1.5723) ce_loss 1.0410 (1.1018) teacher_loss 0.8193 (0.9131) loss_zs_kd 1.0998 (0.8987) loss_oracle 0.6484 (0.6592) acc 62.5000 (58.1562) kd_loss 0.8057 (0.8359) lr 3.6258e-04 eta 0:07:12
epoch [38/50] batch [120/319] time 0.108 (0.106) data 0.000 (0.006) loss 1.5588 (1.5677) ce_loss 0.8784 (1.0991) teacher_loss 0.8529 (0.9079) loss_zs_kd 0.9606 (0.8970) loss_oracle 0.7058 (0.6598) acc 65.6250 (58.3854) kd_loss 0.8545 (0.8354) lr 3.6258e-04 eta 0:07:08
epoch [38/50] batch [140/319] time 0.105 (0.106) data 0.000 (0.005) loss 1.6735 (1.5728) ce_loss 1.2412 (1.1065) teacher_loss 1.0716 (0.9164) loss_zs_kd 0.9508 (0.9003) loss_oracle 0.6018 (0.6564) acc 56.2500 (58.0357) kd_loss 0.7455 (0.8335) lr 3.6258e-04 eta 0:07:03
epoch [38/50] batch [160/319] time 0.104 (0.105) data 0.000 (0.004) loss 1.3933 (1.5705) ce_loss 1.0723 (1.1048) teacher_loss 0.7220 (0.9142) loss_zs_kd 0.7188 (0.8970) loss_oracle 0.6713 (0.6563) acc 62.5000 (58.0469) kd_loss 0.8676 (0.8325) lr 3.6258e-04 eta 0:07:00
epoch [38/50] batch [180/319] time 0.105 (0.105) data 0.000 (0.004) loss 1.5291 (1.5732) ce_loss 1.0244 (1.1088) teacher_loss 0.8938 (0.9152) loss_zs_kd 0.9466 (0.8956) loss_oracle 0.6353 (0.6581) acc 59.3750 (57.6910) kd_loss 0.8883 (0.8345) lr 3.6258e-04 eta 0:06:56
epoch [38/50] batch [200/319] time 0.092 (0.105) data 0.000 (0.004) loss 1.5870 (1.5716) ce_loss 1.1309 (1.1142) teacher_loss 0.9126 (0.9129) loss_zs_kd 0.9586 (0.9033) loss_oracle 0.6744 (0.6587) acc 46.8750 (57.1719) kd_loss 0.8272 (0.8351) lr 3.6258e-04 eta 0:06:53
epoch [38/50] batch [220/319] time 0.097 (0.104) data 0.000 (0.003) loss 1.7256 (1.5697) ce_loss 1.1162 (1.1106) teacher_loss 1.1016 (0.9101) loss_zs_kd 0.8141 (0.9065) loss_oracle 0.6240 (0.6595) acc 65.6250 (57.1449) kd_loss 0.8120 (0.8342) lr 3.6258e-04 eta 0:06:50
epoch [38/50] batch [240/319] time 0.086 (0.104) data 0.000 (0.003) loss 1.3235 (1.5636) ce_loss 0.9502 (1.1031) teacher_loss 0.6859 (0.9036) loss_zs_kd 0.7374 (0.9101) loss_oracle 0.6376 (0.6600) acc 56.2500 (57.2656) kd_loss 0.8375 (0.8346) lr 3.6258e-04 eta 0:06:46
epoch [38/50] batch [260/319] time 0.101 (0.103) data 0.000 (0.003) loss 1.8851 (1.5638) ce_loss 1.5254 (1.1042) teacher_loss 1.2020 (0.9041) loss_zs_kd 1.1590 (0.9118) loss_oracle 0.6831 (0.6597) acc 40.6250 (57.2356) kd_loss 0.8487 (0.8339) lr 3.6258e-04 eta 0:06:42
epoch [38/50] batch [280/319] time 0.101 (0.103) data 0.000 (0.003) loss 1.2557 (1.5584) ce_loss 0.9102 (1.1041) teacher_loss 0.6721 (0.8997) loss_zs_kd 0.9250 (0.9132) loss_oracle 0.5835 (0.6587) acc 62.5000 (57.1652) kd_loss 0.8483 (0.8345) lr 3.6258e-04 eta 0:06:39
epoch [38/50] batch [300/319] time 0.102 (0.103) data 0.000 (0.002) loss 1.8538 (1.5602) ce_loss 1.3975 (1.1051) teacher_loss 1.1602 (0.9016) loss_zs_kd 1.0054 (0.9160) loss_oracle 0.6936 (0.6586) acc 53.1250 (57.2083) kd_loss 0.8574 (0.8359) lr 3.6258e-04 eta 0:06:37
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,841
* accuracy: 64.9%
* error: 35.1%
* macro_f1: 57.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,220
* accuracy: 53.6%
* error: 46.4%
* macro_f1: 23.8%
******* Domain 2 best val acc:      65.1%, epoch: 35 *******
******* Domain 2 best val test acc: 53.7%, epoch: 35 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [39/50] batch [20/319] time 0.064 (0.127) data 0.000 (0.037) loss 1.4791 (1.5300) ce_loss 0.9395 (1.0383) teacher_loss 0.8729 (0.8789) loss_zs_kd 0.9794 (0.9183) loss_oracle 0.6062 (0.6510) acc 62.5000 (64.5312) kd_loss 0.8141 (0.8452) lr 3.1545e-04 eta 0:08:03
epoch [39/50] batch [40/319] time 0.087 (0.107) data 0.000 (0.019) loss 1.7877 (1.5274) ce_loss 1.3408 (1.0570) teacher_loss 1.1206 (0.8787) loss_zs_kd 0.8968 (0.9390) loss_oracle 0.6671 (0.6486) acc 53.1250 (61.6406) kd_loss 0.8358 (0.8459) lr 3.1545e-04 eta 0:06:46
epoch [39/50] batch [60/319] time 0.087 (0.100) data 0.000 (0.013) loss 1.3682 (1.5168) ce_loss 0.8818 (1.0636) teacher_loss 0.7566 (0.8725) loss_zs_kd 0.7695 (0.9326) loss_oracle 0.6117 (0.6443) acc 59.3750 (60.7812) kd_loss 0.8048 (0.8450) lr 3.1545e-04 eta 0:06:17
epoch [39/50] batch [80/319] time 0.096 (0.099) data 0.000 (0.010) loss 1.5573 (1.5270) ce_loss 1.1543 (1.0723) teacher_loss 0.9143 (0.8845) loss_zs_kd 1.1404 (0.9353) loss_oracle 0.6430 (0.6425) acc 65.6250 (59.8047) kd_loss 0.8694 (0.8414) lr 3.1545e-04 eta 0:06:09
epoch [39/50] batch [100/319] time 0.097 (0.100) data 0.000 (0.008) loss 1.9825 (1.5341) ce_loss 1.4131 (1.0780) teacher_loss 1.3079 (0.8923) loss_zs_kd 0.8475 (0.9186) loss_oracle 0.6746 (0.6418) acc 46.8750 (59.3750) kd_loss 0.8178 (0.8387) lr 3.1545e-04 eta 0:06:11
epoch [39/50] batch [120/319] time 0.089 (0.099) data 0.000 (0.006) loss 1.7062 (1.5272) ce_loss 1.2129 (1.0750) teacher_loss 1.1383 (0.8840) loss_zs_kd 0.6388 (0.9076) loss_oracle 0.5679 (0.6432) acc 68.7500 (59.6094) kd_loss 0.8182 (0.8399) lr 3.1545e-04 eta 0:06:06
epoch [39/50] batch [140/319] time 0.105 (0.099) data 0.000 (0.006) loss 1.3764 (1.5276) ce_loss 0.9243 (1.0753) teacher_loss 0.6749 (0.8816) loss_zs_kd 1.1848 (0.9105) loss_oracle 0.7015 (0.6460) acc 65.6250 (59.7545) kd_loss 0.8903 (0.8427) lr 3.1545e-04 eta 0:06:04
epoch [39/50] batch [160/319] time 0.097 (0.100) data 0.000 (0.005) loss 1.4804 (1.5252) ce_loss 0.8989 (1.0701) teacher_loss 0.7415 (0.8755) loss_zs_kd 1.1554 (0.9125) loss_oracle 0.7389 (0.6497) acc 62.5000 (59.6875) kd_loss 0.8644 (0.8431) lr 3.1545e-04 eta 0:06:05
epoch [39/50] batch [180/319] time 0.106 (0.100) data 0.000 (0.004) loss 1.4956 (1.5270) ce_loss 1.1475 (1.0735) teacher_loss 0.7046 (0.8759) loss_zs_kd 0.9367 (0.9134) loss_oracle 0.7910 (0.6511) acc 53.1250 (59.2361) kd_loss 0.8526 (0.8438) lr 3.1545e-04 eta 0:06:05
epoch [39/50] batch [200/319] time 0.108 (0.101) data 0.000 (0.004) loss 1.2725 (1.5234) ce_loss 0.9277 (1.0718) teacher_loss 0.5891 (0.8717) loss_zs_kd 0.8064 (0.9153) loss_oracle 0.6834 (0.6517) acc 71.8750 (59.2344) kd_loss 0.8943 (0.8430) lr 3.1545e-04 eta 0:06:05
epoch [39/50] batch [220/319] time 0.094 (0.100) data 0.000 (0.004) loss 1.4084 (1.5213) ce_loss 1.0137 (1.0687) teacher_loss 0.7668 (0.8699) loss_zs_kd 1.0915 (0.9236) loss_oracle 0.6416 (0.6514) acc 68.7500 (59.4886) kd_loss 0.9214 (0.8441) lr 3.1545e-04 eta 0:06:02
epoch [39/50] batch [240/319] time 0.098 (0.101) data 0.000 (0.003) loss 1.6823 (1.5276) ce_loss 1.3418 (1.0741) teacher_loss 1.0711 (0.8749) loss_zs_kd 1.0471 (0.9317) loss_oracle 0.6112 (0.6527) acc 40.6250 (59.3880) kd_loss 0.8749 (0.8441) lr 3.1545e-04 eta 0:06:00
epoch [39/50] batch [260/319] time 0.108 (0.101) data 0.000 (0.003) loss 1.5083 (1.5272) ce_loss 0.9351 (1.0737) teacher_loss 0.8341 (0.8760) loss_zs_kd 0.9563 (0.9362) loss_oracle 0.6742 (0.6512) acc 65.6250 (59.4351) kd_loss 0.8081 (0.8446) lr 3.1545e-04 eta 0:05:59
epoch [39/50] batch [280/319] time 0.107 (0.101) data 0.000 (0.003) loss 1.8376 (1.5288) ce_loss 1.4629 (1.0780) teacher_loss 1.1857 (0.8759) loss_zs_kd 0.9717 (0.9398) loss_oracle 0.6519 (0.6530) acc 53.1250 (59.3192) kd_loss 0.8328 (0.8448) lr 3.1545e-04 eta 0:05:58
epoch [39/50] batch [300/319] time 0.109 (0.101) data 0.000 (0.003) loss 1.5672 (1.5321) ce_loss 1.1357 (1.0808) teacher_loss 0.9258 (0.8783) loss_zs_kd 1.3764 (0.9476) loss_oracle 0.6414 (0.6537) acc 53.1250 (59.0938) kd_loss 0.8261 (0.8448) lr 3.1545e-04 eta 0:05:56
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,826
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 56.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,018
* accuracy: 51.5%
* error: 48.5%
* macro_f1: 22.5%
******* Domain 2 best val acc:      65.1%, epoch: 35 *******
******* Domain 2 best val test acc: 53.7%, epoch: 35 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [40/50] batch [20/319] time 0.131 (0.122) data 0.000 (0.028) loss 1.5127 (1.4827) ce_loss 1.0752 (1.0247) teacher_loss 0.8893 (0.8355) loss_zs_kd 0.7697 (0.9281) loss_oracle 0.6234 (0.6472) acc 59.3750 (61.7188) kd_loss 0.8926 (0.8481) lr 2.7103e-04 eta 0:07:04
epoch [40/50] batch [40/319] time 0.090 (0.105) data 0.000 (0.014) loss 1.4745 (1.5234) ce_loss 0.9814 (1.0878) teacher_loss 0.7775 (0.8676) loss_zs_kd 0.8192 (0.9493) loss_oracle 0.6969 (0.6558) acc 62.5000 (58.5156) kd_loss 0.8958 (0.8542) lr 2.7103e-04 eta 0:06:03
epoch [40/50] batch [60/319] time 0.113 (0.103) data 0.001 (0.009) loss 1.4978 (1.5368) ce_loss 1.1582 (1.0922) teacher_loss 0.8517 (0.8719) loss_zs_kd 0.9114 (0.9638) loss_oracle 0.6461 (0.6649) acc 56.2500 (58.4375) kd_loss 0.8761 (0.8547) lr 2.7103e-04 eta 0:05:54
epoch [40/50] batch [80/319] time 0.096 (0.102) data 0.000 (0.007) loss 1.3209 (1.5091) ce_loss 0.9902 (1.0736) teacher_loss 0.7278 (0.8444) loss_zs_kd 0.8821 (0.9721) loss_oracle 0.5931 (0.6647) acc 56.2500 (58.9453) kd_loss 0.8183 (0.8536) lr 2.7103e-04 eta 0:05:49
epoch [40/50] batch [100/319] time 0.097 (0.101) data 0.000 (0.006) loss 1.5995 (1.5178) ce_loss 0.9980 (1.0781) teacher_loss 0.9093 (0.8484) loss_zs_kd 0.7033 (0.9627) loss_oracle 0.6902 (0.6694) acc 62.5000 (58.8125) kd_loss 0.8537 (0.8512) lr 2.7103e-04 eta 0:05:45
epoch [40/50] batch [120/319] time 0.108 (0.102) data 0.000 (0.005) loss 1.3009 (1.5112) ce_loss 0.9067 (1.0695) teacher_loss 0.5849 (0.8430) loss_zs_kd 1.1512 (0.9690) loss_oracle 0.7160 (0.6682) acc 59.3750 (58.9062) kd_loss 0.8810 (0.8515) lr 2.7103e-04 eta 0:05:44
epoch [40/50] batch [140/319] time 0.096 (0.102) data 0.000 (0.004) loss 1.5376 (1.5186) ce_loss 1.1064 (1.0776) teacher_loss 0.9055 (0.8511) loss_zs_kd 0.9590 (0.9661) loss_oracle 0.6321 (0.6675) acc 62.5000 (58.8170) kd_loss 0.9082 (0.8512) lr 2.7103e-04 eta 0:05:42
epoch [40/50] batch [160/319] time 0.100 (0.102) data 0.000 (0.004) loss 1.5261 (1.5137) ce_loss 1.1357 (1.0747) teacher_loss 0.8768 (0.8483) loss_zs_kd 0.9700 (0.9734) loss_oracle 0.6493 (0.6654) acc 50.0000 (58.8672) kd_loss 0.8648 (0.8522) lr 2.7103e-04 eta 0:05:40
epoch [40/50] batch [180/319] time 0.103 (0.102) data 0.000 (0.003) loss 1.8309 (1.5138) ce_loss 1.4053 (1.0747) teacher_loss 1.1120 (0.8505) loss_zs_kd 0.8755 (0.9725) loss_oracle 0.7189 (0.6633) acc 53.1250 (58.7674) kd_loss 0.8677 (0.8530) lr 2.7103e-04 eta 0:05:38
epoch [40/50] batch [200/319] time 0.115 (0.102) data 0.000 (0.003) loss 1.4829 (1.5249) ce_loss 1.0488 (1.0841) teacher_loss 0.7869 (0.8619) loss_zs_kd 0.8344 (0.9670) loss_oracle 0.6960 (0.6630) acc 65.6250 (58.4219) kd_loss 0.8201 (0.8545) lr 2.7103e-04 eta 0:05:37
epoch [40/50] batch [220/319] time 0.108 (0.102) data 0.000 (0.003) loss 1.6095 (1.5269) ce_loss 1.2773 (1.0888) teacher_loss 0.9108 (0.8654) loss_zs_kd 1.0763 (0.9654) loss_oracle 0.6988 (0.6615) acc 43.7500 (58.3097) kd_loss 0.8994 (0.8549) lr 2.7103e-04 eta 0:05:35
epoch [40/50] batch [240/319] time 0.102 (0.102) data 0.000 (0.003) loss 1.8217 (1.5293) ce_loss 1.2188 (1.0867) teacher_loss 1.0966 (0.8663) loss_zs_kd 0.8835 (0.9652) loss_oracle 0.7251 (0.6630) acc 53.1250 (58.5417) kd_loss 0.8579 (0.8559) lr 2.7103e-04 eta 0:05:33
epoch [40/50] batch [260/319] time 0.101 (0.102) data 0.000 (0.002) loss 1.5626 (1.5305) ce_loss 1.2158 (1.0879) teacher_loss 0.8963 (0.8684) loss_zs_kd 1.0815 (0.9660) loss_oracle 0.6662 (0.6621) acc 53.1250 (58.4736) kd_loss 0.7931 (0.8556) lr 2.7103e-04 eta 0:05:31
epoch [40/50] batch [280/319] time 0.106 (0.102) data 0.000 (0.002) loss 1.5400 (1.5332) ce_loss 1.1465 (1.0882) teacher_loss 0.9491 (0.8730) loss_zs_kd 0.7500 (0.9617) loss_oracle 0.5909 (0.6602) acc 59.3750 (58.3817) kd_loss 0.8577 (0.8562) lr 2.7103e-04 eta 0:05:30
epoch [40/50] batch [300/319] time 0.103 (0.102) data 0.000 (0.002) loss 1.7980 (1.5361) ce_loss 1.1943 (1.0908) teacher_loss 1.1306 (0.8764) loss_zs_kd 0.8547 (0.9598) loss_oracle 0.6674 (0.6596) acc 56.2500 (58.3750) kd_loss 0.8443 (0.8567) lr 2.7103e-04 eta 0:05:28
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,820
* accuracy: 64.4%
* error: 35.6%
* macro_f1: 56.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,193
* accuracy: 53.3%
* error: 46.7%
* macro_f1: 23.0%
******* Domain 2 best val acc:      65.1%, epoch: 35 *******
******* Domain 2 best val test acc: 53.7%, epoch: 35 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [41/50] batch [20/319] time 0.139 (0.154) data 0.000 (0.035) loss 1.4953 (1.5342) ce_loss 0.9683 (1.0735) teacher_loss 0.8693 (0.8528) loss_zs_kd 1.1017 (0.9969) loss_oracle 0.6260 (0.6814) acc 68.7500 (57.8125) kd_loss 0.7966 (0.8611) lr 2.2949e-04 eta 0:08:09
epoch [41/50] batch [40/319] time 0.112 (0.119) data 0.000 (0.018) loss 1.7079 (1.5370) ce_loss 1.1221 (1.0849) teacher_loss 1.0141 (0.8597) loss_zs_kd 1.3126 (0.9865) loss_oracle 0.6938 (0.6774) acc 65.6250 (58.7500) kd_loss 0.7855 (0.8559) lr 2.2949e-04 eta 0:06:14
epoch [41/50] batch [60/319] time 0.107 (0.114) data 0.001 (0.012) loss 1.5816 (1.5438) ce_loss 1.1270 (1.0906) teacher_loss 0.9031 (0.8681) loss_zs_kd 0.9250 (0.9818) loss_oracle 0.6785 (0.6757) acc 59.3750 (58.0729) kd_loss 0.8929 (0.8597) lr 2.2949e-04 eta 0:05:56
epoch [41/50] batch [80/319] time 0.104 (0.111) data 0.000 (0.009) loss 1.3459 (1.5386) ce_loss 1.0752 (1.0883) teacher_loss 0.7087 (0.8641) loss_zs_kd 1.1647 (0.9987) loss_oracle 0.6372 (0.6745) acc 53.1250 (58.7109) kd_loss 0.8501 (0.8619) lr 2.2949e-04 eta 0:05:45
epoch [41/50] batch [100/319] time 0.103 (0.110) data 0.000 (0.007) loss 1.4468 (1.5401) ce_loss 0.9243 (1.0904) teacher_loss 0.7671 (0.8661) loss_zs_kd 0.9927 (1.0014) loss_oracle 0.6798 (0.6741) acc 62.5000 (58.8438) kd_loss 0.8912 (0.8618) lr 2.2949e-04 eta 0:05:39
epoch [41/50] batch [120/319] time 0.109 (0.109) data 0.000 (0.006) loss 1.2900 (1.5471) ce_loss 0.9785 (1.0918) teacher_loss 0.5735 (0.8724) loss_zs_kd 0.8626 (1.0014) loss_oracle 0.7165 (0.6747) acc 65.6250 (58.5938) kd_loss 0.8577 (0.8629) lr 2.2949e-04 eta 0:05:34
epoch [41/50] batch [140/319] time 0.107 (0.108) data 0.000 (0.005) loss 1.2886 (1.5448) ce_loss 0.8369 (1.0847) teacher_loss 0.6349 (0.8695) loss_zs_kd 0.9562 (0.9981) loss_oracle 0.6537 (0.6753) acc 68.7500 (59.2634) kd_loss 0.8390 (0.8623) lr 2.2949e-04 eta 0:05:30
epoch [41/50] batch [160/319] time 0.102 (0.108) data 0.000 (0.005) loss 1.5455 (1.5476) ce_loss 1.1289 (1.0858) teacher_loss 0.8802 (0.8750) loss_zs_kd 0.8720 (0.9928) loss_oracle 0.6653 (0.6726) acc 56.2500 (59.0234) kd_loss 0.8525 (0.8587) lr 2.2949e-04 eta 0:05:27
epoch [41/50] batch [180/319] time 0.113 (0.108) data 0.000 (0.004) loss 1.1864 (1.5435) ce_loss 1.0420 (1.0852) teacher_loss 0.6698 (0.8729) loss_zs_kd 0.9848 (0.9910) loss_oracle 0.5166 (0.6706) acc 59.3750 (59.0972) kd_loss 0.8291 (0.8582) lr 2.2949e-04 eta 0:05:24
epoch [41/50] batch [200/319] time 0.106 (0.107) data 0.000 (0.004) loss 1.3421 (1.5371) ce_loss 1.0010 (1.0797) teacher_loss 0.6781 (0.8681) loss_zs_kd 0.9480 (0.9850) loss_oracle 0.6640 (0.6690) acc 59.3750 (59.2031) kd_loss 0.8647 (0.8576) lr 2.2949e-04 eta 0:05:21
epoch [41/50] batch [220/319] time 0.105 (0.107) data 0.000 (0.003) loss 1.6470 (1.5347) ce_loss 1.3047 (1.0758) teacher_loss 0.8906 (0.8663) loss_zs_kd 0.9416 (0.9854) loss_oracle 0.7565 (0.6684) acc 53.1250 (59.3466) kd_loss 0.8734 (0.8576) lr 2.2949e-04 eta 0:05:17
epoch [41/50] batch [240/319] time 0.115 (0.107) data 0.000 (0.003) loss 1.5303 (1.5355) ce_loss 1.0518 (1.0764) teacher_loss 0.8574 (0.8683) loss_zs_kd 0.7771 (0.9841) loss_oracle 0.6729 (0.6672) acc 50.0000 (59.2969) kd_loss 0.8132 (0.8565) lr 2.2949e-04 eta 0:05:15
epoch [41/50] batch [260/319] time 0.108 (0.107) data 0.000 (0.003) loss 1.6043 (1.5377) ce_loss 1.0977 (1.0787) teacher_loss 0.9503 (0.8715) loss_zs_kd 0.9650 (0.9782) loss_oracle 0.6540 (0.6662) acc 56.2500 (59.0625) kd_loss 0.8342 (0.8554) lr 2.2949e-04 eta 0:05:12
epoch [41/50] batch [280/319] time 0.107 (0.107) data 0.000 (0.003) loss 1.5939 (1.5404) ce_loss 0.9521 (1.0824) teacher_loss 0.8868 (0.8749) loss_zs_kd 0.9025 (0.9786) loss_oracle 0.7071 (0.6655) acc 65.6250 (58.7946) kd_loss 0.8311 (0.8553) lr 2.2949e-04 eta 0:05:11
epoch [41/50] batch [300/319] time 0.106 (0.107) data 0.000 (0.003) loss 1.6378 (1.5389) ce_loss 1.0361 (1.0807) teacher_loss 0.9536 (0.8737) loss_zs_kd 0.8306 (0.9749) loss_oracle 0.6842 (0.6652) acc 65.6250 (58.8333) kd_loss 0.8802 (0.8545) lr 2.2949e-04 eta 0:05:09
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,850
* accuracy: 65.1%
* error: 34.9%
* macro_f1: 56.4%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,011
* accuracy: 51.5%
* error: 48.5%
* macro_f1: 22.4%
******* Domain 2 best val acc:      65.1%, epoch: 41 *******
******* Domain 2 best val test acc: 51.5%, epoch: 41 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [42/50] batch [20/319] time 0.075 (0.149) data 0.000 (0.031) loss 1.6579 (1.5422) ce_loss 1.2285 (1.1037) teacher_loss 0.9367 (0.9023) loss_zs_kd 1.2131 (0.8962) loss_oracle 0.7212 (0.6399) acc 53.1250 (57.0312) kd_loss 0.8674 (0.8596) lr 1.9098e-04 eta 0:07:04
epoch [42/50] batch [40/319] time 0.099 (0.125) data 0.000 (0.016) loss 1.2308 (1.5514) ce_loss 0.8223 (1.0996) teacher_loss 0.5593 (0.9040) loss_zs_kd 0.8637 (0.9116) loss_oracle 0.6716 (0.6474) acc 71.8750 (58.2812) kd_loss 0.8204 (0.8534) lr 1.9098e-04 eta 0:05:53
epoch [42/50] batch [60/319] time 0.100 (0.118) data 0.001 (0.011) loss 1.5516 (1.5585) ce_loss 1.0488 (1.1028) teacher_loss 0.9387 (0.9105) loss_zs_kd 0.8884 (0.9162) loss_oracle 0.6128 (0.6481) acc 59.3750 (58.1250) kd_loss 0.8556 (0.8490) lr 1.9098e-04 eta 0:05:32
epoch [42/50] batch [80/319] time 0.103 (0.115) data 0.000 (0.008) loss 1.6549 (1.5551) ce_loss 1.2461 (1.1014) teacher_loss 0.8718 (0.9033) loss_zs_kd 0.8642 (0.9223) loss_oracle 0.7831 (0.6518) acc 31.2500 (57.9688) kd_loss 0.8440 (0.8473) lr 1.9098e-04 eta 0:05:22
epoch [42/50] batch [100/319] time 0.088 (0.113) data 0.000 (0.007) loss 2.0113 (1.5617) ce_loss 1.4053 (1.1097) teacher_loss 1.3739 (0.9120) loss_zs_kd 1.0566 (0.9256) loss_oracle 0.6373 (0.6497) acc 46.8750 (57.5625) kd_loss 0.9185 (0.8475) lr 1.9098e-04 eta 0:05:14
epoch [42/50] batch [120/319] time 0.105 (0.112) data 0.000 (0.005) loss 1.6047 (1.5480) ce_loss 1.1670 (1.0960) teacher_loss 0.9448 (0.8980) loss_zs_kd 0.9907 (0.9379) loss_oracle 0.6599 (0.6500) acc 56.2500 (58.2292) kd_loss 0.8602 (0.8469) lr 1.9098e-04 eta 0:05:07
epoch [42/50] batch [140/319] time 0.099 (0.111) data 0.000 (0.005) loss 1.0717 (1.5548) ce_loss 0.7256 (1.0956) teacher_loss 0.5148 (0.9044) loss_zs_kd 1.0624 (0.9425) loss_oracle 0.5569 (0.6504) acc 71.8750 (57.9688) kd_loss 0.8050 (0.8442) lr 1.9098e-04 eta 0:05:03
epoch [42/50] batch [160/319] time 0.093 (0.110) data 0.000 (0.004) loss 1.8701 (1.5554) ce_loss 1.3066 (1.0971) teacher_loss 1.2517 (0.9033) loss_zs_kd 1.1535 (0.9425) loss_oracle 0.6185 (0.6521) acc 56.2500 (57.8320) kd_loss 0.8708 (0.8453) lr 1.9098e-04 eta 0:04:59
epoch [42/50] batch [180/319] time 0.105 (0.110) data 0.000 (0.004) loss 1.5500 (1.5520) ce_loss 1.0713 (1.0967) teacher_loss 0.8877 (0.9014) loss_zs_kd 1.0235 (0.9529) loss_oracle 0.6622 (0.6505) acc 65.6250 (58.2292) kd_loss 0.7757 (0.8447) lr 1.9098e-04 eta 0:04:55
epoch [42/50] batch [200/319] time 0.102 (0.109) data 0.000 (0.003) loss 1.4581 (1.5478) ce_loss 1.0293 (1.0917) teacher_loss 0.8454 (0.8967) loss_zs_kd 0.9062 (0.9561) loss_oracle 0.6127 (0.6511) acc 59.3750 (58.4219) kd_loss 0.8303 (0.8452) lr 1.9098e-04 eta 0:04:52
epoch [42/50] batch [220/319] time 0.094 (0.108) data 0.000 (0.003) loss 1.6375 (1.5421) ce_loss 1.1455 (1.0870) teacher_loss 0.9909 (0.8883) loss_zs_kd 0.7927 (0.9616) loss_oracle 0.6466 (0.6538) acc 56.2500 (58.5653) kd_loss 0.8745 (0.8445) lr 1.9098e-04 eta 0:04:46
epoch [42/50] batch [240/319] time 0.096 (0.107) data 0.000 (0.003) loss 1.7324 (1.5414) ce_loss 1.2227 (1.0841) teacher_loss 1.1196 (0.8866) loss_zs_kd 0.9731 (0.9627) loss_oracle 0.6128 (0.6548) acc 53.1250 (58.5938) kd_loss 0.8531 (0.8434) lr 1.9098e-04 eta 0:04:40
epoch [42/50] batch [260/319] time 0.115 (0.106) data 0.000 (0.003) loss 1.6153 (1.5390) ce_loss 1.1787 (1.0833) teacher_loss 1.0065 (0.8827) loss_zs_kd 1.0498 (0.9603) loss_oracle 0.6088 (0.6563) acc 53.1250 (58.5938) kd_loss 0.8580 (0.8430) lr 1.9098e-04 eta 0:04:36
epoch [42/50] batch [280/319] time 0.111 (0.106) data 0.000 (0.003) loss 1.6742 (1.5382) ce_loss 1.1875 (1.0831) teacher_loss 1.0343 (0.8819) loss_zs_kd 0.8169 (0.9635) loss_oracle 0.6399 (0.6563) acc 65.6250 (58.7165) kd_loss 0.8548 (0.8432) lr 1.9098e-04 eta 0:04:33
epoch [42/50] batch [300/319] time 0.098 (0.105) data 0.000 (0.002) loss 1.5000 (1.5420) ce_loss 1.0664 (1.0852) teacher_loss 0.8489 (0.8854) loss_zs_kd 1.1027 (0.9679) loss_oracle 0.6511 (0.6567) acc 56.2500 (58.7604) kd_loss 0.8894 (0.8426) lr 1.9098e-04 eta 0:04:31
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,838
* accuracy: 64.8%
* error: 35.2%
* macro_f1: 56.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,045
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 22.5%
******* Domain 2 best val acc:      65.1%, epoch: 41 *******
******* Domain 2 best val test acc: 51.5%, epoch: 41 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [43/50] batch [20/319] time 0.069 (0.136) data 0.000 (0.028) loss 1.4041 (1.4918) ce_loss 0.9307 (1.0362) teacher_loss 0.7342 (0.8392) loss_zs_kd 1.2453 (0.9795) loss_oracle 0.6699 (0.6526) acc 65.6250 (60.7812) kd_loss 0.8415 (0.8305) lr 1.5567e-04 eta 0:05:45
epoch [43/50] batch [40/319] time 0.100 (0.111) data 0.000 (0.014) loss 1.9585 (1.5352) ce_loss 1.3740 (1.0708) teacher_loss 1.2191 (0.8760) loss_zs_kd 0.8987 (0.9542) loss_oracle 0.7394 (0.6592) acc 46.8750 (58.5156) kd_loss 0.7940 (0.8361) lr 1.5567e-04 eta 0:04:39
epoch [43/50] batch [60/319] time 0.093 (0.108) data 0.001 (0.009) loss 1.8082 (1.5268) ce_loss 1.3369 (1.0714) teacher_loss 1.2153 (0.8750) loss_zs_kd 0.9343 (0.9525) loss_oracle 0.5930 (0.6518) acc 43.7500 (57.7083) kd_loss 0.8189 (0.8393) lr 1.5567e-04 eta 0:04:29
epoch [43/50] batch [80/319] time 0.111 (0.107) data 0.000 (0.007) loss 1.4478 (1.5338) ce_loss 0.9487 (1.0765) teacher_loss 0.7118 (0.8762) loss_zs_kd 1.1106 (0.9515) loss_oracle 0.7360 (0.6577) acc 71.8750 (58.6328) kd_loss 0.8986 (0.8369) lr 1.5567e-04 eta 0:04:24
epoch [43/50] batch [100/319] time 0.086 (0.105) data 0.000 (0.006) loss 1.2603 (1.5279) ce_loss 0.9590 (1.0705) teacher_loss 0.6299 (0.8690) loss_zs_kd 0.8710 (0.9437) loss_oracle 0.6304 (0.6589) acc 56.2500 (58.5000) kd_loss 0.8195 (0.8347) lr 1.5567e-04 eta 0:04:17
epoch [43/50] batch [120/319] time 0.100 (0.102) data 0.000 (0.005) loss 1.4952 (1.5322) ce_loss 0.9478 (1.0737) teacher_loss 0.8591 (0.8717) loss_zs_kd 0.9313 (0.9372) loss_oracle 0.6360 (0.6605) acc 56.2500 (58.8542) kd_loss 0.8148 (0.8372) lr 1.5567e-04 eta 0:04:08
epoch [43/50] batch [140/319] time 0.088 (0.100) data 0.000 (0.004) loss 1.6963 (1.5334) ce_loss 1.3662 (1.0770) teacher_loss 1.0119 (0.8741) loss_zs_kd 0.8122 (0.9447) loss_oracle 0.6844 (0.6592) acc 46.8750 (58.7500) kd_loss 0.8701 (0.8367) lr 1.5567e-04 eta 0:04:01
epoch [43/50] batch [160/319] time 0.092 (0.099) data 0.000 (0.004) loss 1.5147 (1.5311) ce_loss 1.0322 (1.0734) teacher_loss 0.8171 (0.8699) loss_zs_kd 0.9361 (0.9475) loss_oracle 0.6976 (0.6612) acc 59.3750 (58.7500) kd_loss 0.8355 (0.8363) lr 1.5567e-04 eta 0:03:57
epoch [43/50] batch [180/319] time 0.085 (0.098) data 0.000 (0.003) loss 1.4550 (1.5386) ce_loss 1.1025 (1.0790) teacher_loss 0.8475 (0.8784) loss_zs_kd 0.8536 (0.9477) loss_oracle 0.6075 (0.6602) acc 62.5000 (58.9236) kd_loss 0.8324 (0.8360) lr 1.5567e-04 eta 0:03:52
epoch [43/50] batch [200/319] time 0.103 (0.097) data 0.000 (0.003) loss 1.6681 (1.5424) ce_loss 1.1191 (1.0804) teacher_loss 0.9246 (0.8810) loss_zs_kd 0.8635 (0.9500) loss_oracle 0.7434 (0.6614) acc 50.0000 (58.8906) kd_loss 0.8253 (0.8374) lr 1.5567e-04 eta 0:03:48
epoch [43/50] batch [220/319] time 0.079 (0.096) data 0.000 (0.003) loss 1.9086 (1.5478) ce_loss 1.2393 (1.0868) teacher_loss 1.2859 (0.8881) loss_zs_kd 1.0259 (0.9435) loss_oracle 0.6226 (0.6596) acc 56.2500 (58.6932) kd_loss 0.8596 (0.8367) lr 1.5567e-04 eta 0:03:43
epoch [43/50] batch [240/319] time 0.100 (0.095) data 0.000 (0.003) loss 1.6422 (1.5478) ce_loss 1.0781 (1.0850) teacher_loss 0.8782 (0.8887) loss_zs_kd 1.1339 (0.9438) loss_oracle 0.7640 (0.6591) acc 53.1250 (58.7500) kd_loss 0.8571 (0.8372) lr 1.5567e-04 eta 0:03:39
epoch [43/50] batch [260/319] time 0.108 (0.095) data 0.000 (0.002) loss 1.3939 (1.5456) ce_loss 1.0039 (1.0836) teacher_loss 0.7918 (0.8881) loss_zs_kd 1.1132 (0.9456) loss_oracle 0.6021 (0.6575) acc 68.7500 (58.9303) kd_loss 0.8614 (0.8380) lr 1.5567e-04 eta 0:03:38
epoch [43/50] batch [280/319] time 0.112 (0.096) data 0.000 (0.002) loss 1.3947 (1.5397) ce_loss 1.0195 (1.0811) teacher_loss 0.7127 (0.8834) loss_zs_kd 1.0211 (0.9455) loss_oracle 0.6820 (0.6563) acc 62.5000 (58.9174) kd_loss 0.8777 (0.8372) lr 1.5567e-04 eta 0:03:38
epoch [43/50] batch [300/319] time 0.094 (0.096) data 0.000 (0.002) loss 1.5624 (1.5400) ce_loss 1.0996 (1.0783) teacher_loss 0.9191 (0.8824) loss_zs_kd 0.6973 (0.9464) loss_oracle 0.6433 (0.6576) acc 65.6250 (59.0104) kd_loss 0.8219 (0.8365) lr 1.5567e-04 eta 0:03:36
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,836
* accuracy: 64.8%
* error: 35.2%
* macro_f1: 56.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,159
* accuracy: 53.0%
* error: 47.0%
* macro_f1: 22.6%
******* Domain 2 best val acc:      65.1%, epoch: 41 *******
******* Domain 2 best val test acc: 51.5%, epoch: 41 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [44/50] batch [20/319] time 0.074 (0.133) data 0.000 (0.030) loss 1.9492 (1.5764) ce_loss 1.2568 (1.0779) teacher_loss 1.2321 (0.8956) loss_zs_kd 0.9211 (0.9627) loss_oracle 0.7171 (0.6808) acc 56.2500 (60.7812) kd_loss 0.8144 (0.8341) lr 1.2369e-04 eta 0:04:53
epoch [44/50] batch [40/319] time 0.104 (0.117) data 0.000 (0.015) loss 1.8840 (1.5877) ce_loss 1.2354 (1.0944) teacher_loss 1.2556 (0.9180) loss_zs_kd 0.7740 (0.9529) loss_oracle 0.6284 (0.6696) acc 56.2500 (59.1406) kd_loss 0.8700 (0.8276) lr 1.2369e-04 eta 0:04:17
epoch [44/50] batch [60/319] time 0.099 (0.113) data 0.001 (0.010) loss 1.1709 (1.5649) ce_loss 0.8022 (1.0828) teacher_loss 0.5144 (0.8989) loss_zs_kd 1.0475 (0.9442) loss_oracle 0.6565 (0.6660) acc 71.8750 (59.2708) kd_loss 0.8450 (0.8303) lr 1.2369e-04 eta 0:04:06
epoch [44/50] batch [80/319] time 0.118 (0.112) data 0.000 (0.008) loss 1.4107 (1.5482) ce_loss 0.9990 (1.0741) teacher_loss 0.8602 (0.8866) loss_zs_kd 1.1396 (0.9450) loss_oracle 0.5505 (0.6616) acc 62.5000 (59.4922) kd_loss 0.7105 (0.8309) lr 1.2369e-04 eta 0:04:01
epoch [44/50] batch [100/319] time 0.100 (0.109) data 0.000 (0.006) loss 1.6395 (1.5460) ce_loss 1.0381 (1.0744) teacher_loss 0.9664 (0.8861) loss_zs_kd 0.8422 (0.9506) loss_oracle 0.6731 (0.6599) acc 62.5000 (59.5312) kd_loss 0.8563 (0.8322) lr 1.2369e-04 eta 0:03:52
epoch [44/50] batch [120/319] time 0.107 (0.108) data 0.000 (0.005) loss 1.7414 (1.5601) ce_loss 1.2500 (1.0879) teacher_loss 1.1361 (0.9007) loss_zs_kd 0.9202 (0.9372) loss_oracle 0.6053 (0.6594) acc 56.2500 (58.8542) kd_loss 0.8071 (0.8350) lr 1.2369e-04 eta 0:03:47
epoch [44/50] batch [140/319] time 0.095 (0.107) data 0.000 (0.004) loss 1.6539 (1.5629) ce_loss 1.2119 (1.0937) teacher_loss 1.1224 (0.9071) loss_zs_kd 0.9261 (0.9256) loss_oracle 0.5315 (0.6558) acc 50.0000 (58.7054) kd_loss 0.8072 (0.8357) lr 1.2369e-04 eta 0:03:44
epoch [44/50] batch [160/319] time 0.099 (0.107) data 0.000 (0.004) loss 1.6653 (1.5677) ce_loss 1.0703 (1.0962) teacher_loss 1.0196 (0.9108) loss_zs_kd 0.7778 (0.9273) loss_oracle 0.6457 (0.6569) acc 62.5000 (58.7109) kd_loss 0.8473 (0.8365) lr 1.2369e-04 eta 0:03:41
epoch [44/50] batch [180/319] time 0.107 (0.107) data 0.001 (0.004) loss 1.8229 (1.5707) ce_loss 1.2178 (1.0997) teacher_loss 1.1647 (0.9137) loss_zs_kd 0.7362 (0.9260) loss_oracle 0.6582 (0.6570) acc 53.1250 (58.3854) kd_loss 0.8672 (0.8360) lr 1.2369e-04 eta 0:03:38
epoch [44/50] batch [200/319] time 0.092 (0.106) data 0.000 (0.003) loss 1.2139 (1.5673) ce_loss 0.7676 (1.0971) teacher_loss 0.5312 (0.9101) loss_zs_kd 0.7624 (0.9295) loss_oracle 0.6827 (0.6572) acc 68.7500 (58.3750) kd_loss 0.8879 (0.8378) lr 1.2369e-04 eta 0:03:36
epoch [44/50] batch [220/319] time 0.106 (0.106) data 0.000 (0.003) loss 1.3872 (1.5642) ce_loss 0.9497 (1.0960) teacher_loss 0.7119 (0.9063) loss_zs_kd 0.9999 (0.9343) loss_oracle 0.6753 (0.6579) acc 59.3750 (58.3949) kd_loss 0.8403 (0.8378) lr 1.2369e-04 eta 0:03:33
epoch [44/50] batch [240/319] time 0.107 (0.106) data 0.000 (0.003) loss 1.8351 (1.5598) ce_loss 1.1680 (1.0899) teacher_loss 1.0981 (0.9030) loss_zs_kd 1.2211 (0.9375) loss_oracle 0.7370 (0.6569) acc 75.0000 (58.6328) kd_loss 0.8386 (0.8377) lr 1.2369e-04 eta 0:03:30
epoch [44/50] batch [260/319] time 0.094 (0.105) data 0.001 (0.003) loss 1.6393 (1.5590) ce_loss 1.1885 (1.0893) teacher_loss 0.9898 (0.9021) loss_zs_kd 0.8828 (0.9365) loss_oracle 0.6495 (0.6569) acc 50.0000 (58.5096) kd_loss 0.8018 (0.8377) lr 1.2369e-04 eta 0:03:27
epoch [44/50] batch [280/319] time 0.104 (0.105) data 0.000 (0.002) loss 1.7608 (1.5571) ce_loss 1.2471 (1.0879) teacher_loss 1.0312 (0.9008) loss_zs_kd 0.8864 (0.9346) loss_oracle 0.7296 (0.6563) acc 53.1250 (58.6384) kd_loss 0.8398 (0.8379) lr 1.2369e-04 eta 0:03:25
epoch [44/50] batch [300/319] time 0.117 (0.105) data 0.000 (0.002) loss 1.6279 (1.5557) ce_loss 1.1152 (1.0889) teacher_loss 0.9476 (0.8993) loss_zs_kd 0.8925 (0.9345) loss_oracle 0.6803 (0.6564) acc 65.6250 (58.5833) kd_loss 0.7684 (0.8381) lr 1.2369e-04 eta 0:03:23
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,847
* accuracy: 65.0%
* error: 35.0%
* macro_f1: 57.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,060
* accuracy: 52.0%
* error: 48.0%
* macro_f1: 22.7%
******* Domain 2 best val acc:      65.1%, epoch: 41 *******
******* Domain 2 best val test acc: 51.5%, epoch: 41 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [45/50] batch [20/319] time 0.089 (0.125) data 0.000 (0.028) loss 1.3616 (1.5000) ce_loss 0.9375 (1.0374) teacher_loss 0.6830 (0.8319) loss_zs_kd 0.6320 (0.9189) loss_oracle 0.6785 (0.6681) acc 62.5000 (60.4688) kd_loss 0.7796 (0.8380) lr 9.5173e-05 eta 0:03:56
epoch [45/50] batch [40/319] time 0.108 (0.110) data 0.000 (0.014) loss 1.5068 (1.5332) ce_loss 1.1777 (1.0780) teacher_loss 0.9458 (0.8723) loss_zs_kd 0.8636 (0.9167) loss_oracle 0.5610 (0.6609) acc 62.5000 (60.0000) kd_loss 0.8593 (0.8371) lr 9.5173e-05 eta 0:03:25
epoch [45/50] batch [60/319] time 0.097 (0.107) data 0.000 (0.010) loss 1.4168 (1.5406) ce_loss 0.9736 (1.0936) teacher_loss 0.7614 (0.8836) loss_zs_kd 1.0739 (0.9408) loss_oracle 0.6554 (0.6570) acc 75.0000 (59.1667) kd_loss 0.8697 (0.8429) lr 9.5173e-05 eta 0:03:17
epoch [45/50] batch [80/319] time 0.112 (0.105) data 0.000 (0.007) loss 1.6460 (1.5294) ce_loss 1.2334 (1.0839) teacher_loss 0.9131 (0.8737) loss_zs_kd 1.0804 (0.9392) loss_oracle 0.7329 (0.6558) acc 46.8750 (59.4141) kd_loss 0.8446 (0.8447) lr 9.5173e-05 eta 0:03:13
epoch [45/50] batch [100/319] time 0.108 (0.104) data 0.000 (0.006) loss 1.6574 (1.5308) ce_loss 0.9331 (1.0771) teacher_loss 0.9490 (0.8755) loss_zs_kd 0.8135 (0.9402) loss_oracle 0.7083 (0.6553) acc 68.7500 (58.9375) kd_loss 0.9504 (0.8473) lr 9.5173e-05 eta 0:03:09
epoch [45/50] batch [120/319] time 0.105 (0.104) data 0.000 (0.005) loss 1.5446 (1.5344) ce_loss 1.1514 (1.0784) teacher_loss 0.9135 (0.8745) loss_zs_kd 0.7549 (0.9333) loss_oracle 0.6311 (0.6599) acc 50.0000 (58.5677) kd_loss 0.7590 (0.8474) lr 9.5173e-05 eta 0:03:06
epoch [45/50] batch [140/319] time 0.098 (0.103) data 0.000 (0.004) loss 1.5193 (1.5236) ce_loss 0.9819 (1.0673) teacher_loss 0.8160 (0.8643) loss_zs_kd 0.9254 (0.9388) loss_oracle 0.7032 (0.6593) acc 65.6250 (59.0402) kd_loss 0.9331 (0.8492) lr 9.5173e-05 eta 0:03:03
epoch [45/50] batch [160/319] time 0.116 (0.104) data 0.000 (0.004) loss 1.4544 (1.5167) ce_loss 0.9238 (1.0614) teacher_loss 0.8572 (0.8574) loss_zs_kd 0.8055 (0.9355) loss_oracle 0.5973 (0.6593) acc 59.3750 (59.3164) kd_loss 0.8215 (0.8484) lr 9.5173e-05 eta 0:03:02
epoch [45/50] batch [180/319] time 0.111 (0.104) data 0.000 (0.003) loss 1.3925 (1.5147) ce_loss 0.9458 (1.0567) teacher_loss 0.7718 (0.8550) loss_zs_kd 1.0087 (0.9418) loss_oracle 0.6207 (0.6597) acc 65.6250 (59.6875) kd_loss 0.7925 (0.8493) lr 9.5173e-05 eta 0:03:00
epoch [45/50] batch [200/319] time 0.087 (0.103) data 0.000 (0.003) loss 1.5667 (1.5173) ce_loss 1.2451 (1.0623) teacher_loss 0.8205 (0.8567) loss_zs_kd 0.8178 (0.9340) loss_oracle 0.7461 (0.6607) acc 46.8750 (59.5000) kd_loss 0.8381 (0.8489) lr 9.5173e-05 eta 0:02:56
epoch [45/50] batch [220/319] time 0.093 (0.103) data 0.000 (0.003) loss 1.3048 (1.5214) ce_loss 0.8955 (1.0668) teacher_loss 0.5574 (0.8582) loss_zs_kd 0.7706 (0.9330) loss_oracle 0.7474 (0.6631) acc 65.6250 (59.3182) kd_loss 0.8785 (0.8486) lr 9.5173e-05 eta 0:02:53
epoch [45/50] batch [240/319] time 0.082 (0.102) data 0.000 (0.003) loss 1.6299 (1.5181) ce_loss 1.3682 (1.0663) teacher_loss 0.8698 (0.8546) loss_zs_kd 1.1396 (0.9341) loss_oracle 0.7601 (0.6635) acc 37.5000 (59.2839) kd_loss 0.8832 (0.8481) lr 9.5173e-05 eta 0:02:50
epoch [45/50] batch [260/319] time 0.093 (0.101) data 0.000 (0.002) loss 1.6107 (1.5303) ce_loss 1.1777 (1.0769) teacher_loss 0.9373 (0.8666) loss_zs_kd 0.9696 (0.9333) loss_oracle 0.6734 (0.6637) acc 59.3750 (58.8702) kd_loss 0.8236 (0.8477) lr 9.5173e-05 eta 0:02:47
epoch [45/50] batch [280/319] time 0.105 (0.101) data 0.000 (0.002) loss 1.3375 (1.5355) ce_loss 0.8516 (1.0776) teacher_loss 0.6959 (0.8731) loss_zs_kd 1.1232 (0.9339) loss_oracle 0.6416 (0.6624) acc 65.6250 (58.7946) kd_loss 0.8612 (0.8460) lr 9.5173e-05 eta 0:02:45
epoch [45/50] batch [300/319] time 0.100 (0.101) data 0.000 (0.002) loss 1.4575 (1.5341) ce_loss 0.8823 (1.0741) teacher_loss 0.8115 (0.8720) loss_zs_kd 0.7907 (0.9347) loss_oracle 0.6460 (0.6621) acc 59.3750 (59.0104) kd_loss 0.8277 (0.8454) lr 9.5173e-05 eta 0:02:43
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,867
* accuracy: 65.5%
* error: 34.5%
* macro_f1: 57.4%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,115
* accuracy: 52.5%
* error: 47.5%
* macro_f1: 22.5%
******* Domain 2 best val acc:      65.5%, epoch: 45 *******
******* Domain 2 best val test acc: 52.5%, epoch: 45 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [46/50] batch [20/319] time 0.104 (0.125) data 0.000 (0.028) loss 1.5559 (1.4884) ce_loss 1.1484 (1.0181) teacher_loss 0.9118 (0.8415) loss_zs_kd 0.9137 (0.9627) loss_oracle 0.6441 (0.6470) acc 46.8750 (60.3125) kd_loss 0.8244 (0.8322) lr 7.0224e-05 eta 0:03:16
epoch [46/50] batch [40/319] time 0.106 (0.115) data 0.000 (0.014) loss 1.6944 (1.5072) ce_loss 1.2158 (1.0457) teacher_loss 1.0522 (0.8516) loss_zs_kd 0.9262 (0.9535) loss_oracle 0.6423 (0.6556) acc 50.0000 (59.7656) kd_loss 0.8728 (0.8433) lr 7.0224e-05 eta 0:02:58
epoch [46/50] batch [60/319] time 0.099 (0.111) data 0.001 (0.009) loss 1.4120 (1.4926) ce_loss 1.1562 (1.0426) teacher_loss 0.8239 (0.8431) loss_zs_kd 1.0042 (0.9710) loss_oracle 0.5882 (0.6496) acc 56.2500 (60.3646) kd_loss 0.8621 (0.8468) lr 7.0224e-05 eta 0:02:50
epoch [46/50] batch [80/319] time 0.105 (0.109) data 0.000 (0.007) loss 1.4466 (1.4951) ce_loss 0.9673 (1.0430) teacher_loss 0.7744 (0.8447) loss_zs_kd 0.8120 (0.9767) loss_oracle 0.6723 (0.6504) acc 75.0000 (60.5469) kd_loss 0.7994 (0.8466) lr 7.0224e-05 eta 0:02:45
epoch [46/50] batch [100/319] time 0.097 (0.108) data 0.000 (0.006) loss 1.1315 (1.4961) ce_loss 0.8066 (1.0443) teacher_loss 0.5367 (0.8436) loss_zs_kd 0.8417 (0.9765) loss_oracle 0.5947 (0.6525) acc 62.5000 (60.4688) kd_loss 0.8203 (0.8491) lr 7.0224e-05 eta 0:02:41
epoch [46/50] batch [120/319] time 0.096 (0.107) data 0.000 (0.005) loss 1.5160 (1.4993) ce_loss 0.9282 (1.0420) teacher_loss 0.8141 (0.8454) loss_zs_kd 0.9927 (0.9685) loss_oracle 0.7019 (0.6539) acc 62.5000 (60.4167) kd_loss 0.8893 (0.8464) lr 7.0224e-05 eta 0:02:37
epoch [46/50] batch [140/319] time 0.096 (0.106) data 0.000 (0.004) loss 1.5357 (1.5095) ce_loss 0.8838 (1.0541) teacher_loss 0.8508 (0.8530) loss_zs_kd 0.7187 (0.9641) loss_oracle 0.6849 (0.6565) acc 78.1250 (59.8214) kd_loss 0.8330 (0.8464) lr 7.0224e-05 eta 0:02:33
epoch [46/50] batch [160/319] time 0.106 (0.105) data 0.000 (0.004) loss 1.2777 (1.5044) ce_loss 0.9390 (1.0502) teacher_loss 0.6136 (0.8471) loss_zs_kd 0.8043 (0.9635) loss_oracle 0.6641 (0.6573) acc 59.3750 (60.0977) kd_loss 0.8716 (0.8477) lr 7.0224e-05 eta 0:02:31
epoch [46/50] batch [180/319] time 0.106 (0.105) data 0.000 (0.003) loss 1.5788 (1.5135) ce_loss 1.0459 (1.0553) teacher_loss 0.9250 (0.8560) loss_zs_kd 0.8103 (0.9639) loss_oracle 0.6538 (0.6575) acc 62.5000 (60.1042) kd_loss 0.8581 (0.8477) lr 7.0224e-05 eta 0:02:28
epoch [46/50] batch [200/319] time 0.091 (0.105) data 0.000 (0.003) loss 1.4887 (1.5150) ce_loss 1.0625 (1.0538) teacher_loss 0.9172 (0.8569) loss_zs_kd 0.8565 (0.9658) loss_oracle 0.5715 (0.6581) acc 56.2500 (60.0625) kd_loss 0.8075 (0.8481) lr 7.0224e-05 eta 0:02:26
epoch [46/50] batch [220/319] time 0.101 (0.105) data 0.000 (0.003) loss 1.7271 (1.5225) ce_loss 1.2510 (1.0624) teacher_loss 1.1171 (0.8646) loss_zs_kd 0.9659 (0.9614) loss_oracle 0.6100 (0.6578) acc 50.0000 (59.7301) kd_loss 0.8298 (0.8475) lr 7.0224e-05 eta 0:02:23
epoch [46/50] batch [240/319] time 0.105 (0.104) data 0.000 (0.003) loss 1.3754 (1.5254) ce_loss 0.9468 (1.0624) teacher_loss 0.7480 (0.8660) loss_zs_kd 0.8356 (0.9603) loss_oracle 0.6274 (0.6595) acc 68.7500 (59.7396) kd_loss 0.7736 (0.8487) lr 7.0224e-05 eta 0:02:21
epoch [46/50] batch [260/319] time 0.110 (0.105) data 0.000 (0.002) loss 1.5074 (1.5252) ce_loss 0.9189 (1.0641) teacher_loss 0.8742 (0.8665) loss_zs_kd 1.0164 (0.9596) loss_oracle 0.6333 (0.6587) acc 65.6250 (59.7236) kd_loss 0.9194 (0.8476) lr 7.0224e-05 eta 0:02:19
epoch [46/50] batch [280/319] time 0.097 (0.105) data 0.000 (0.002) loss 1.6895 (1.5289) ce_loss 1.2754 (1.0664) teacher_loss 0.9935 (0.8705) loss_zs_kd 0.7928 (0.9584) loss_oracle 0.6960 (0.6584) acc 50.0000 (59.5759) kd_loss 0.8307 (0.8462) lr 7.0224e-05 eta 0:02:17
epoch [46/50] batch [300/319] time 0.101 (0.105) data 0.000 (0.002) loss 1.5148 (1.5261) ce_loss 1.2637 (1.0654) teacher_loss 0.8153 (0.8685) loss_zs_kd 1.0010 (0.9571) loss_oracle 0.6994 (0.6576) acc 46.8750 (59.6042) kd_loss 0.8182 (0.8458) lr 7.0224e-05 eta 0:02:15
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,868
* accuracy: 65.5%
* error: 34.5%
* macro_f1: 57.4%
Checkpoint saved to icml/multi-dg/oracle/06_nouse_ema_and_0.0zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,105
* accuracy: 52.4%
* error: 47.6%
* macro_f1: 22.7%
******* Domain 2 best val acc:      65.5%, epoch: 46 *******
******* Domain 2 best val test acc: 52.4%, epoch: 46 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [47/50] batch [20/319] time 0.106 (0.142) data 0.000 (0.025) loss 1.5283 (1.5834) ce_loss 0.9463 (1.1109) teacher_loss 0.8218 (0.9360) loss_zs_kd 0.9041 (0.9310) loss_oracle 0.7065 (0.6474) acc 68.7500 (57.3438) kd_loss 0.8165 (0.8412) lr 4.8943e-05 eta 0:02:58
epoch [47/50] batch [40/319] time 0.101 (0.124) data 0.000 (0.013) loss 1.5095 (1.5645) ce_loss 1.0361 (1.1101) teacher_loss 0.8061 (0.9091) loss_zs_kd 0.8920 (0.9258) loss_oracle 0.7034 (0.6554) acc 59.3750 (57.1094) kd_loss 0.8596 (0.8421) lr 4.8943e-05 eta 0:02:32
epoch [47/50] batch [60/319] time 0.111 (0.117) data 0.001 (0.009) loss 1.7058 (1.5510) ce_loss 1.0684 (1.1027) teacher_loss 0.9686 (0.8893) loss_zs_kd 1.1673 (0.9517) loss_oracle 0.7372 (0.6617) acc 62.5000 (57.3438) kd_loss 0.9655 (0.8434) lr 4.8943e-05 eta 0:02:22
epoch [47/50] batch [80/319] time 0.091 (0.112) data 0.000 (0.006) loss 1.5260 (1.5494) ce_loss 1.0264 (1.1001) teacher_loss 0.9954 (0.8869) loss_zs_kd 0.7408 (0.9370) loss_oracle 0.5305 (0.6625) acc 50.0000 (57.7344) kd_loss 0.7466 (0.8419) lr 4.8943e-05 eta 0:02:13
epoch [47/50] batch [100/319] time 0.093 (0.107) data 0.000 (0.005) loss 1.3003 (1.5483) ce_loss 0.8862 (1.0921) teacher_loss 0.6249 (0.8916) loss_zs_kd 0.9535 (0.9395) loss_oracle 0.6754 (0.6568) acc 56.2500 (58.4375) kd_loss 0.8155 (0.8418) lr 4.8943e-05 eta 0:02:05
epoch [47/50] batch [120/319] time 0.088 (0.105) data 0.000 (0.004) loss 1.3861 (1.5329) ce_loss 0.9658 (1.0793) teacher_loss 0.6474 (0.8752) loss_zs_kd 0.7887 (0.9451) loss_oracle 0.7387 (0.6577) acc 56.2500 (58.5417) kd_loss 0.8614 (0.8443) lr 4.8943e-05 eta 0:02:00
epoch [47/50] batch [140/319] time 0.101 (0.103) data 0.000 (0.004) loss 1.8945 (1.5238) ce_loss 1.3633 (1.0717) teacher_loss 1.1231 (0.8663) loss_zs_kd 1.0507 (0.9455) loss_oracle 0.7713 (0.6575) acc 50.0000 (58.9509) kd_loss 0.8062 (0.8435) lr 4.8943e-05 eta 0:01:57
epoch [47/50] batch [160/319] time 0.093 (0.103) data 0.000 (0.003) loss 1.4264 (1.5183) ce_loss 0.9507 (1.0699) teacher_loss 0.8596 (0.8628) loss_zs_kd 0.6966 (0.9475) loss_oracle 0.5668 (0.6554) acc 71.8750 (58.8672) kd_loss 0.8236 (0.8431) lr 4.8943e-05 eta 0:01:54
epoch [47/50] batch [180/319] time 0.107 (0.102) data 0.000 (0.003) loss 1.4009 (1.5189) ce_loss 1.0703 (1.0743) teacher_loss 0.7885 (0.8630) loss_zs_kd 1.0260 (0.9508) loss_oracle 0.6124 (0.6558) acc 50.0000 (58.4028) kd_loss 0.8340 (0.8450) lr 4.8943e-05 eta 0:01:52
epoch [47/50] batch [200/319] time 0.100 (0.102) data 0.000 (0.003) loss 1.6621 (1.5153) ce_loss 1.1191 (1.0686) teacher_loss 1.0019 (0.8590) loss_zs_kd 1.1334 (0.9464) loss_oracle 0.6602 (0.6563) acc 56.2500 (58.8750) kd_loss 0.8426 (0.8446) lr 4.8943e-05 eta 0:01:50
epoch [47/50] batch [220/319] time 0.101 (0.102) data 0.000 (0.003) loss 1.2558 (1.5132) ce_loss 1.0000 (1.0664) teacher_loss 0.6453 (0.8583) loss_zs_kd 0.8596 (0.9511) loss_oracle 0.6106 (0.6549) acc 68.7500 (59.0341) kd_loss 0.8351 (0.8447) lr 4.8943e-05 eta 0:01:48
epoch [47/50] batch [240/319] time 0.095 (0.102) data 0.000 (0.002) loss 1.2986 (1.5187) ce_loss 0.7734 (1.0725) teacher_loss 0.6742 (0.8638) loss_zs_kd 0.8813 (0.9516) loss_oracle 0.6243 (0.6549) acc 81.2500 (58.8542) kd_loss 0.8787 (0.8446) lr 4.8943e-05 eta 0:01:46
epoch [47/50] batch [260/319] time 0.102 (0.103) data 0.000 (0.002) loss 1.8395 (1.5237) ce_loss 1.2168 (1.0747) teacher_loss 1.1141 (0.8678) loss_zs_kd 0.8166 (0.9506) loss_oracle 0.7254 (0.6559) acc 56.2500 (58.9423) kd_loss 0.8355 (0.8445) lr 4.8943e-05 eta 0:01:44
epoch [47/50] batch [280/319] time 0.094 (0.102) data 0.000 (0.002) loss 1.8224 (1.5233) ce_loss 0.9438 (1.0733) teacher_loss 1.1113 (0.8677) loss_zs_kd 0.7653 (0.9514) loss_oracle 0.7111 (0.6556) acc 62.5000 (58.8281) kd_loss 0.8698 (0.8432) lr 4.8943e-05 eta 0:01:41
epoch [47/50] batch [300/319] time 0.083 (0.101) data 0.000 (0.002) loss 1.3159 (1.5255) ce_loss 0.8271 (1.0721) teacher_loss 0.6754 (0.8696) loss_zs_kd 0.8985 (0.9518) loss_oracle 0.6406 (0.6560) acc 68.7500 (58.9062) kd_loss 0.9153 (0.8429) lr 4.8943e-05 eta 0:01:38
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,861
* accuracy: 65.3%
* error: 34.7%
* macro_f1: 57.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,085
* accuracy: 52.2%
* error: 47.8%
* macro_f1: 22.6%
******* Domain 2 best val acc:      65.5%, epoch: 46 *******
******* Domain 2 best val test acc: 52.4%, epoch: 46 *******
******* Domain 2 best test acc:     56.8%, epoch: 29 *******
epoch [48/50] batch [20/319] time 0.085 (0.123) data 0.000 (0.027) loss 1.4968 (1.5789) ce_loss 0.9707 (1.1348) teacher_loss 0.9374 (0.9417) loss_zs_kd 0.7683 (0.9395) loss_oracle 0.5594 (0.6372) acc 65.6250 (58.2812) kd_loss 0.7137 (0.8254) lr 3.1417e-05 eta 0:01:54
epoch [48/50] batch [40/319] time 0.105 (0.108) data 0.000 (0.013) loss 1.3555 (1.5674) ce_loss 1.0527 (1.1331) teacher_loss 0.7188 (0.9147) loss_zs_kd 0.9127 (0.9479) loss_oracle 0.6367 (0.6527) acc 59.3750 (57.8125) kd_loss 0.7911 (0.8352) lr 3.1417e-05 eta 0:01:38
epoch [48/50] batch [60/319] time 0.099 (0.104) data 0.001 (0.009) loss 1.6134 (1.5484) ce_loss 1.1055 (1.1192) teacher_loss 0.9475 (0.9008) loss_zs_kd 0.6999 (0.9485) loss_oracle 0.6659 (0.6476) acc 62.5000 (58.4896) kd_loss 0.8214 (0.8376) lr 3.1417e-05 eta 0:01:33
epoch [48/50] batch [80/319] time 0.101 (0.103) data 0.000 (0.007) loss 1.4663 (1.5283) ce_loss 0.9907 (1.0969) teacher_loss 0.8753 (0.8756) loss_zs_kd 0.8648 (0.9531) loss_oracle 0.5909 (0.6528) acc 56.2500 (59.1406) kd_loss 0.7890 (0.8406) lr 3.1417e-05 eta 0:01:30
epoch [48/50] batch [100/319] time 0.091 (0.103) data 0.000 (0.006) loss 1.5237 (1.5253) ce_loss 1.0791 (1.0880) teacher_loss 0.8186 (0.8703) loss_zs_kd 0.8331 (0.9571) loss_oracle 0.7052 (0.6550) acc 59.3750 (59.1250) kd_loss 0.9031 (0.8411) lr 3.1417e-05 eta 0:01:27
