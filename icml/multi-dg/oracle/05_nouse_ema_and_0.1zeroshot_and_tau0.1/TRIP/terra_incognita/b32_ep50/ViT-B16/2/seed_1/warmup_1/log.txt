Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_100', 'location_43', 'location_46']
Target     ['location_38']
# classes  10
# train_x  10,216
# val      4,378
# test     9,736
---------  ----------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/319] time 0.120 (0.173) data 0.000 (0.037) loss 1.4528 (2.2180) ce_loss 1.2510 (2.0156) teacher_loss 1.2520 (2.0154) loss_zs_kd 0.0003 (0.0001) loss_oracle 0.2008 (0.2026) acc 59.3750 (37.0312) kd_loss 0.9663 (0.9473) lr 1.0000e-05 eta 0:45:59
epoch [1/50] batch [40/319] time 0.090 (0.146) data 0.000 (0.019) loss 1.7731 (2.1133) ce_loss 1.5752 (1.9125) teacher_loss 1.5748 (1.9122) loss_zs_kd 0.0015 (0.0003) loss_oracle 0.1981 (0.2010) acc 56.2500 (39.7656) kd_loss 0.9098 (0.9289) lr 1.0000e-05 eta 0:38:35
epoch [1/50] batch [60/319] time 0.090 (0.138) data 0.000 (0.013) loss 2.3750 (2.1439) ce_loss 2.1699 (1.9406) teacher_loss 2.1725 (1.9404) loss_zs_kd 0.0027 (0.0008) loss_oracle 0.2022 (0.2034) acc 31.2500 (39.1667) kd_loss 0.9491 (0.9341) lr 1.0000e-05 eta 0:36:32
epoch [1/50] batch [80/319] time 0.125 (0.136) data 0.000 (0.010) loss 2.2034 (2.1284) ce_loss 1.9766 (1.9218) teacher_loss 1.9705 (1.9215) loss_zs_kd 0.0040 (0.0015) loss_oracle 0.2326 (0.2067) acc 43.7500 (38.7891) kd_loss 0.9220 (0.9328) lr 1.0000e-05 eta 0:35:58
epoch [1/50] batch [100/319] time 0.138 (0.132) data 0.000 (0.008) loss 2.4012 (2.0960) ce_loss 2.1699 (1.8832) teacher_loss 2.1711 (1.8829) loss_zs_kd 0.0075 (0.0025) loss_oracle 0.2294 (0.2128) acc 25.0000 (39.3438) kd_loss 1.0049 (0.9304) lr 1.0000e-05 eta 0:34:58
epoch [1/50] batch [120/319] time 0.086 (0.130) data 0.000 (0.006) loss 2.0809 (2.0980) ce_loss 1.8662 (1.8811) teacher_loss 1.8673 (1.8810) loss_zs_kd 0.0062 (0.0034) loss_oracle 0.2130 (0.2166) acc 40.6250 (39.5312) kd_loss 0.8682 (0.9287) lr 1.0000e-05 eta 0:34:21
epoch [1/50] batch [140/319] time 0.139 (0.129) data 0.000 (0.006) loss 2.2295 (2.0974) ce_loss 2.0527 (1.8809) teacher_loss 2.0528 (1.8810) loss_zs_kd 0.0101 (0.0044) loss_oracle 0.1757 (0.2159) acc 37.5000 (39.4643) kd_loss 0.8189 (0.9264) lr 1.0000e-05 eta 0:34:04
epoch [1/50] batch [160/319] time 0.154 (0.132) data 0.000 (0.005) loss 2.0288 (2.0919) ce_loss 1.8301 (1.8770) teacher_loss 1.8270 (1.8771) loss_zs_kd 0.0130 (0.0056) loss_oracle 0.2004 (0.2142) acc 34.3750 (39.6289) kd_loss 0.9067 (0.9246) lr 1.0000e-05 eta 0:34:45
epoch [1/50] batch [180/319] time 0.153 (0.132) data 0.000 (0.004) loss 2.3776 (2.0880) ce_loss 2.1777 (1.8737) teacher_loss 2.1797 (1.8739) loss_zs_kd 0.0225 (0.0070) loss_oracle 0.1956 (0.2134) acc 28.1250 (39.5660) kd_loss 0.8526 (0.9231) lr 1.0000e-05 eta 0:34:40
epoch [1/50] batch [200/319] time 0.194 (0.133) data 0.001 (0.004) loss 2.2381 (2.0847) ce_loss 1.9980 (1.8694) teacher_loss 1.9941 (1.8694) loss_zs_kd 0.0234 (0.0085) loss_oracle 0.2417 (0.2144) acc 31.2500 (39.5312) kd_loss 0.9753 (0.9231) lr 1.0000e-05 eta 0:34:48
epoch [1/50] batch [220/319] time 0.199 (0.134) data 0.000 (0.004) loss 1.9841 (2.0939) ce_loss 1.7217 (1.8752) teacher_loss 1.7185 (1.8753) loss_zs_kd 0.0303 (0.0102) loss_oracle 0.2626 (0.2176) acc 46.8750 (39.1477) kd_loss 0.9457 (0.9234) lr 1.0000e-05 eta 0:35:12
epoch [1/50] batch [240/319] time 0.134 (0.139) data 0.000 (0.003) loss 2.1843 (2.1039) ce_loss 1.9375 (1.8818) teacher_loss 1.9343 (1.8820) loss_zs_kd 0.0415 (0.0120) loss_oracle 0.2459 (0.2207) acc 28.1250 (38.8411) kd_loss 0.8970 (0.9253) lr 1.0000e-05 eta 0:36:16
epoch [1/50] batch [260/319] time 0.098 (0.135) data 0.000 (0.003) loss 2.2426 (2.1038) ce_loss 1.9736 (1.8792) teacher_loss 1.9810 (1.8794) loss_zs_kd 0.0372 (0.0138) loss_oracle 0.2578 (0.2230) acc 37.5000 (38.7380) kd_loss 0.8932 (0.9254) lr 1.0000e-05 eta 0:35:23
epoch [1/50] batch [280/319] time 0.128 (0.133) data 0.000 (0.003) loss 2.3412 (2.1037) ce_loss 2.0703 (1.8755) teacher_loss 2.0900 (1.8757) loss_zs_kd 0.0532 (0.0158) loss_oracle 0.2458 (0.2264) acc 31.2500 (38.7612) kd_loss 0.9505 (0.9254) lr 1.0000e-05 eta 0:34:44
epoch [1/50] batch [300/319] time 0.080 (0.131) data 0.000 (0.003) loss 2.5457 (2.1021) ce_loss 2.2891 (1.8714) teacher_loss 2.2919 (1.8717) loss_zs_kd 0.0511 (0.0180) loss_oracle 0.2486 (0.2286) acc 31.2500 (38.7500) kd_loss 0.9075 (0.9252) lr 1.0000e-05 eta 0:34:11
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 1,763
* accuracy: 40.3%
* error: 59.7%
* macro_f1: 25.2%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,094
* accuracy: 31.8%
* error: 68.2%
* macro_f1: 11.9%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      40.3%, epoch: 1 *******
******* Domain 2 best val test acc: 31.8%, epoch: 1 *******
******* Domain 2 best test acc:     31.8%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/ana
epoch [2/50] batch [20/319] time 0.087 (0.137) data 0.000 (0.032) loss 2.2455 (2.1530) ce_loss 1.6533 (1.6419) teacher_loss 1.5104 (1.6014) loss_zs_kd 0.2891 (0.2547) loss_oracle 0.7062 (0.5261) acc 43.7500 (41.2500) kd_loss 1.0014 (0.9702) lr 2.0000e-03 eta 0:35:41
epoch [2/50] batch [40/319] time 0.060 (0.114) data 0.000 (0.016) loss 2.6346 (2.2296) ce_loss 1.9941 (1.6199) teacher_loss 1.8174 (1.5399) loss_zs_kd 0.4781 (0.3017) loss_oracle 0.7695 (0.6595) acc 25.0000 (42.1094) kd_loss 0.9649 (0.9986) lr 2.0000e-03 eta 0:29:37
epoch [2/50] batch [60/319] time 0.165 (0.119) data 0.000 (0.011) loss 2.3778 (2.2552) ce_loss 1.7402 (1.6119) teacher_loss 1.3953 (1.4962) loss_zs_kd 0.2808 (0.3229) loss_oracle 0.9544 (0.7267) acc 40.6250 (41.9792) kd_loss 1.0494 (1.0081) lr 2.0000e-03 eta 0:30:48
epoch [2/50] batch [80/319] time 0.180 (0.120) data 0.000 (0.008) loss 2.3368 (2.2627) ce_loss 1.5537 (1.5942) teacher_loss 1.6294 (1.4697) loss_zs_kd 0.2148 (0.3239) loss_oracle 0.6859 (0.7605) acc 43.7500 (42.7734) kd_loss 1.0612 (1.0151) lr 2.0000e-03 eta 0:31:05
epoch [2/50] batch [100/319] time 0.181 (0.130) data 0.000 (0.006) loss 2.2294 (2.2336) ce_loss 1.6660 (1.5820) teacher_loss 1.5492 (1.4795) loss_zs_kd 0.1962 (0.3142) loss_oracle 0.6605 (0.7227) acc 37.5000 (42.5000) kd_loss 1.0223 (1.0212) lr 2.0000e-03 eta 0:33:37
epoch [2/50] batch [120/319] time 0.073 (0.122) data 0.000 (0.005) loss 1.8872 (2.2244) ce_loss 1.2803 (1.5749) teacher_loss 1.2678 (1.4729) loss_zs_kd 0.3342 (0.3131) loss_oracle 0.5860 (0.7202) acc 56.2500 (42.2396) kd_loss 1.0289 (1.0249) lr 2.0000e-03 eta 0:31:39
epoch [2/50] batch [140/319] time 0.104 (0.118) data 0.000 (0.005) loss 2.4280 (2.2056) ce_loss 1.6768 (1.5624) teacher_loss 1.7847 (1.4662) loss_zs_kd 0.3352 (0.3143) loss_oracle 0.6098 (0.7080) acc 40.6250 (42.4107) kd_loss 0.9734 (1.0230) lr 2.0000e-03 eta 0:30:34
epoch [2/50] batch [160/319] time 0.137 (0.117) data 0.000 (0.004) loss 2.2442 (2.1981) ce_loss 1.3721 (1.5436) teacher_loss 1.3748 (1.4518) loss_zs_kd 0.2557 (0.3151) loss_oracle 0.8438 (0.7148) acc 62.5000 (43.2422) kd_loss 1.0890 (1.0242) lr 2.0000e-03 eta 0:30:06
epoch [2/50] batch [180/319] time 0.153 (0.120) data 0.000 (0.004) loss 2.3905 (2.2045) ce_loss 1.4951 (1.5363) teacher_loss 1.6056 (1.4466) loss_zs_kd 0.3257 (0.3146) loss_oracle 0.7523 (0.7265) acc 43.7500 (43.3333) kd_loss 0.9674 (1.0236) lr 2.0000e-03 eta 0:30:54
epoch [2/50] batch [200/319] time 0.152 (0.123) data 0.000 (0.003) loss 2.0540 (2.2008) ce_loss 1.3076 (1.5282) teacher_loss 1.3324 (1.4412) loss_zs_kd 0.2974 (0.3129) loss_oracle 0.6919 (0.7284) acc 50.0000 (43.4844) kd_loss 0.9986 (1.0234) lr 2.0000e-03 eta 0:31:40
epoch [2/50] batch [220/319] time 0.149 (0.126) data 0.000 (0.003) loss 2.5096 (2.2013) ce_loss 1.7021 (1.5237) teacher_loss 1.7102 (1.4356) loss_zs_kd 0.2990 (0.3132) loss_oracle 0.7695 (0.7344) acc 25.0000 (43.3665) kd_loss 1.0405 (1.0226) lr 2.0000e-03 eta 0:32:19
epoch [2/50] batch [240/319] time 0.148 (0.128) data 0.000 (0.003) loss 1.8483 (2.1998) ce_loss 1.1807 (1.5124) teacher_loss 1.0085 (1.4241) loss_zs_kd 0.3480 (0.3139) loss_oracle 0.8050 (0.7444) acc 50.0000 (43.7240) kd_loss 0.9910 (1.0218) lr 2.0000e-03 eta 0:32:50
epoch [2/50] batch [260/319] time 0.154 (0.129) data 0.000 (0.003) loss 1.8716 (2.1841) ce_loss 1.3018 (1.4953) teacher_loss 1.1159 (1.4050) loss_zs_kd 0.3082 (0.3177) loss_oracle 0.7249 (0.7473) acc 50.0000 (44.2788) kd_loss 0.9748 (1.0190) lr 2.0000e-03 eta 0:32:58
epoch [2/50] batch [280/319] time 0.146 (0.130) data 0.000 (0.002) loss 2.0288 (2.1840) ce_loss 1.3604 (1.4915) teacher_loss 1.1429 (1.4024) loss_zs_kd 0.2459 (0.3164) loss_oracle 0.8613 (0.7500) acc 43.7500 (44.2746) kd_loss 1.0014 (1.0158) lr 2.0000e-03 eta 0:33:19
epoch [2/50] batch [300/319] time 0.153 (0.132) data 0.000 (0.002) loss 1.8818 (2.1835) ce_loss 1.2920 (1.4880) teacher_loss 1.1353 (1.3991) loss_zs_kd 0.3236 (0.3163) loss_oracle 0.7141 (0.7527) acc 50.0000 (44.2708) kd_loss 0.9312 (1.0125) lr 2.0000e-03 eta 0:33:39
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,117
* accuracy: 48.4%
* error: 51.6%
* macro_f1: 36.4%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 2,760
* accuracy: 28.3%
* error: 71.7%
* macro_f1: 17.4%
******* Domain 2 best val acc:      48.4%, epoch: 2 *******
******* Domain 2 best val test acc: 28.3%, epoch: 2 *******
******* Domain 2 best test acc:     31.8%, epoch: 1 *******
epoch [3/50] batch [20/319] time 0.137 (0.132) data 0.000 (0.031) loss 1.8008 (2.0452) ce_loss 1.0928 (1.3055) teacher_loss 0.9984 (1.2060) loss_zs_kd 0.2750 (0.3325) loss_oracle 0.7749 (0.8060) acc 53.1250 (47.8125) kd_loss 0.9833 (0.9540) lr 1.9980e-03 eta 0:33:30
epoch [3/50] batch [40/319] time 0.081 (0.118) data 0.000 (0.015) loss 1.9430 (2.0438) ce_loss 1.2520 (1.3293) teacher_loss 1.2252 (1.2417) loss_zs_kd 0.3682 (0.3381) loss_oracle 0.6809 (0.7683) acc 59.3750 (47.3438) kd_loss 0.9253 (0.9526) lr 1.9980e-03 eta 0:30:01
epoch [3/50] batch [60/319] time 0.096 (0.114) data 0.000 (0.010) loss 1.6859 (2.0334) ce_loss 1.0029 (1.3225) teacher_loss 0.9168 (1.2389) loss_zs_kd 0.3579 (0.3556) loss_oracle 0.7333 (0.7590) acc 68.7500 (48.5938) kd_loss 0.9599 (0.9471) lr 1.9980e-03 eta 0:28:58
epoch [3/50] batch [80/319] time 0.083 (0.111) data 0.000 (0.008) loss 1.8064 (2.0480) ce_loss 1.2129 (1.3391) teacher_loss 0.9576 (1.2493) loss_zs_kd 0.3475 (0.3527) loss_oracle 0.8141 (0.7634) acc 53.1250 (48.2422) kd_loss 0.9492 (0.9460) lr 1.9980e-03 eta 0:28:13
epoch [3/50] batch [100/319] time 0.095 (0.110) data 0.000 (0.006) loss 1.9595 (2.0535) ce_loss 1.2764 (1.3491) teacher_loss 1.2235 (1.2596) loss_zs_kd 0.3179 (0.3487) loss_oracle 0.7042 (0.7591) acc 46.8750 (47.4688) kd_loss 0.9317 (0.9392) lr 1.9980e-03 eta 0:27:53
epoch [3/50] batch [120/319] time 0.160 (0.117) data 0.000 (0.005) loss 2.2113 (2.0552) ce_loss 1.4355 (1.3480) teacher_loss 1.4557 (1.2686) loss_zs_kd 0.3501 (0.3452) loss_oracle 0.7206 (0.7520) acc 40.6250 (47.5521) kd_loss 0.9626 (0.9384) lr 1.9980e-03 eta 0:29:30
epoch [3/50] batch [140/319] time 0.121 (0.119) data 0.000 (0.005) loss 1.8405 (2.0490) ce_loss 1.0527 (1.3393) teacher_loss 1.0311 (1.2671) loss_zs_kd 0.3439 (0.3510) loss_oracle 0.7750 (0.7468) acc 62.5000 (48.0134) kd_loss 0.9711 (0.9359) lr 1.9980e-03 eta 0:30:08
epoch [3/50] batch [160/319] time 0.143 (0.119) data 0.000 (0.004) loss 1.9539 (2.0331) ce_loss 1.2021 (1.3348) teacher_loss 1.1644 (1.2600) loss_zs_kd 0.4194 (0.3590) loss_oracle 0.7475 (0.7372) acc 56.2500 (48.2617) kd_loss 0.9728 (0.9378) lr 1.9980e-03 eta 0:30:07
epoch [3/50] batch [180/319] time 0.107 (0.119) data 0.000 (0.004) loss 2.1986 (2.0330) ce_loss 1.4023 (1.3387) teacher_loss 1.4303 (1.2619) loss_zs_kd 0.3775 (0.3646) loss_oracle 0.7306 (0.7346) acc 50.0000 (48.0208) kd_loss 0.9614 (0.9344) lr 1.9980e-03 eta 0:30:00
epoch [3/50] batch [200/319] time 0.143 (0.122) data 0.000 (0.003) loss 1.9143 (2.0168) ce_loss 1.3496 (1.3371) teacher_loss 1.2897 (1.2564) loss_zs_kd 0.4346 (0.3656) loss_oracle 0.5812 (0.7238) acc 46.8750 (48.1406) kd_loss 1.0147 (0.9327) lr 1.9980e-03 eta 0:30:40
epoch [3/50] batch [220/319] time 0.143 (0.123) data 0.000 (0.003) loss 1.8158 (2.0076) ce_loss 1.3740 (1.3358) teacher_loss 1.1575 (1.2555) loss_zs_kd 0.3424 (0.3677) loss_oracle 0.6240 (0.7153) acc 28.1250 (48.1534) kd_loss 0.9691 (0.9324) lr 1.9980e-03 eta 0:30:55
epoch [3/50] batch [240/319] time 0.156 (0.124) data 0.000 (0.003) loss 2.1996 (1.9896) ce_loss 1.6680 (1.3320) teacher_loss 1.4469 (1.2456) loss_zs_kd 0.5807 (0.3812) loss_oracle 0.6946 (0.7059) acc 40.6250 (48.5286) kd_loss 1.0783 (0.9368) lr 1.9980e-03 eta 0:31:10
epoch [3/50] batch [260/319] time 0.113 (0.126) data 0.000 (0.003) loss 1.9952 (1.9781) ce_loss 1.2900 (1.3326) teacher_loss 1.2945 (1.2413) loss_zs_kd 0.4586 (0.3895) loss_oracle 0.6548 (0.6978) acc 50.0000 (48.6178) kd_loss 1.0189 (0.9422) lr 1.9980e-03 eta 0:31:35
epoch [3/50] batch [280/319] time 0.196 (0.127) data 0.000 (0.002) loss 2.0508 (1.9767) ce_loss 1.3896 (1.3292) teacher_loss 1.2664 (1.2411) loss_zs_kd 0.4493 (0.3958) loss_oracle 0.7395 (0.6961) acc 37.5000 (48.5938) kd_loss 0.8946 (0.9389) lr 1.9980e-03 eta 0:31:52
epoch [3/50] batch [300/319] time 0.190 (0.128) data 0.000 (0.002) loss 1.7095 (1.9768) ce_loss 1.0713 (1.3290) teacher_loss 0.9645 (1.2412) loss_zs_kd 0.3155 (0.3991) loss_oracle 0.7134 (0.6957) acc 59.3750 (48.6667) kd_loss 0.8970 (0.9361) lr 1.9980e-03 eta 0:32:02
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,271
* accuracy: 51.9%
* error: 48.1%
* macro_f1: 41.0%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,771
* accuracy: 38.7%
* error: 61.3%
* macro_f1: 21.6%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      51.9%, epoch: 3 *******
******* Domain 2 best val test acc: 38.7%, epoch: 3 *******
******* Domain 2 best test acc:     38.7%, epoch: 3 *******
epoch [4/50] batch [20/319] time 0.150 (0.183) data 0.000 (0.033) loss 1.7522 (1.8353) ce_loss 1.4053 (1.3232) teacher_loss 1.1502 (1.1831) loss_zs_kd 0.4552 (0.4092) loss_oracle 0.5565 (0.6113) acc 40.6250 (46.5625) kd_loss 0.9877 (0.9260) lr 1.9921e-03 eta 0:45:32
epoch [4/50] batch [40/319] time 0.140 (0.167) data 0.000 (0.017) loss 1.6584 (1.8016) ce_loss 1.2227 (1.2999) teacher_loss 1.1174 (1.1656) loss_zs_kd 0.3849 (0.4342) loss_oracle 0.5026 (0.5925) acc 46.8750 (47.5000) kd_loss 1.0409 (0.9422) lr 1.9921e-03 eta 0:41:33
epoch [4/50] batch [60/319] time 0.150 (0.161) data 0.001 (0.011) loss 1.9058 (1.7843) ce_loss 1.4102 (1.2754) teacher_loss 1.3230 (1.1539) loss_zs_kd 0.4903 (0.4554) loss_oracle 0.5338 (0.5848) acc 56.2500 (49.2708) kd_loss 0.9355 (0.9420) lr 1.9921e-03 eta 0:40:07
epoch [4/50] batch [80/319] time 0.072 (0.150) data 0.000 (0.008) loss 1.7908 (1.7873) ce_loss 1.2764 (1.2806) teacher_loss 1.1885 (1.1544) loss_zs_kd 0.5838 (0.4693) loss_oracle 0.5439 (0.5860) acc 53.1250 (49.2188) kd_loss 1.0609 (0.9463) lr 1.9921e-03 eta 0:37:10
epoch [4/50] batch [100/319] time 0.189 (0.153) data 0.000 (0.007) loss 1.9453 (1.7882) ce_loss 1.2812 (1.2749) teacher_loss 1.2516 (1.1500) loss_zs_kd 0.5576 (0.5051) loss_oracle 0.6380 (0.5877) acc 53.1250 (49.5938) kd_loss 0.9959 (0.9531) lr 1.9921e-03 eta 0:37:52
epoch [4/50] batch [120/319] time 0.173 (0.151) data 0.000 (0.006) loss 1.8976 (1.8001) ce_loss 1.3242 (1.2750) teacher_loss 1.1868 (1.1541) loss_zs_kd 0.5527 (0.5130) loss_oracle 0.6555 (0.5947) acc 50.0000 (49.6094) kd_loss 0.8891 (0.9418) lr 1.9921e-03 eta 0:37:27
epoch [4/50] batch [140/319] time 0.095 (0.150) data 0.000 (0.005) loss 2.1376 (1.8161) ce_loss 1.4893 (1.2771) teacher_loss 1.4258 (1.1650) loss_zs_kd 0.4321 (0.5089) loss_oracle 0.6686 (0.6002) acc 43.7500 (49.9107) kd_loss 0.8818 (0.9275) lr 1.9921e-03 eta 0:37:11
epoch [4/50] batch [160/319] time 0.153 (0.150) data 0.000 (0.004) loss 2.3886 (1.8275) ce_loss 1.7031 (1.2767) teacher_loss 1.6597 (1.1734) loss_zs_kd 0.4507 (0.4947) loss_oracle 0.6838 (0.6046) acc 31.2500 (50.1172) kd_loss 0.8962 (0.9176) lr 1.9921e-03 eta 0:37:04
epoch [4/50] batch [180/319] time 0.090 (0.147) data 0.000 (0.004) loss 1.7713 (1.8260) ce_loss 1.2715 (1.2741) teacher_loss 1.1782 (1.1758) loss_zs_kd 0.4145 (0.4930) loss_oracle 0.5517 (0.6009) acc 62.5000 (50.0521) kd_loss 0.9131 (0.9198) lr 1.9921e-03 eta 0:36:16
epoch [4/50] batch [200/319] time 0.120 (0.147) data 0.000 (0.004) loss 1.7753 (1.8320) ce_loss 1.2598 (1.2719) teacher_loss 1.1610 (1.1797) loss_zs_kd 0.3933 (0.4860) loss_oracle 0.5750 (0.6037) acc 46.8750 (50.3594) kd_loss 0.8678 (0.9125) lr 1.9921e-03 eta 0:36:12
epoch [4/50] batch [220/319] time 0.101 (0.144) data 0.000 (0.003) loss 1.7922 (1.8290) ce_loss 1.2666 (1.2678) teacher_loss 1.2457 (1.1787) loss_zs_kd 0.4991 (0.4814) loss_oracle 0.4965 (0.6021) acc 53.1250 (50.7102) kd_loss 0.9319 (0.9095) lr 1.9921e-03 eta 0:35:21
epoch [4/50] batch [240/319] time 0.136 (0.141) data 0.000 (0.003) loss 1.8316 (1.8268) ce_loss 1.3105 (1.2679) teacher_loss 1.1869 (1.1793) loss_zs_kd 0.5151 (0.4852) loss_oracle 0.5932 (0.5990) acc 53.1250 (50.8724) kd_loss 0.8356 (0.9133) lr 1.9921e-03 eta 0:34:42
epoch [4/50] batch [260/319] time 0.086 (0.139) data 0.000 (0.003) loss 1.9005 (1.8227) ce_loss 1.3613 (1.2672) teacher_loss 1.2900 (1.1790) loss_zs_kd 0.6438 (0.4908) loss_oracle 0.5461 (0.5946) acc 40.6250 (51.1659) kd_loss 0.8753 (0.9179) lr 1.9921e-03 eta 0:34:04
epoch [4/50] batch [280/319] time 0.077 (0.137) data 0.000 (0.003) loss 1.7132 (1.8161) ce_loss 1.1738 (1.2617) teacher_loss 1.1231 (1.1756) loss_zs_kd 0.4925 (0.4903) loss_oracle 0.5408 (0.5914) acc 50.0000 (51.4621) kd_loss 0.8224 (0.9181) lr 1.9921e-03 eta 0:33:33
epoch [4/50] batch [300/319] time 0.111 (0.135) data 0.000 (0.002) loss 1.5485 (1.8078) ce_loss 1.0576 (1.2562) teacher_loss 0.9225 (1.1698) loss_zs_kd 0.7356 (0.4931) loss_oracle 0.5525 (0.5887) acc 62.5000 (51.6667) kd_loss 0.9943 (0.9189) lr 1.9921e-03 eta 0:33:04
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,434
* accuracy: 55.6%
* error: 44.4%
* macro_f1: 43.6%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,279
* accuracy: 44.0%
* error: 56.0%
* macro_f1: 21.1%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      55.6%, epoch: 4 *******
******* Domain 2 best val test acc: 44.0%, epoch: 4 *******
******* Domain 2 best test acc:     44.0%, epoch: 4 *******
epoch [5/50] batch [20/319] time 0.078 (0.153) data 0.000 (0.032) loss 1.8281 (1.7873) ce_loss 1.3135 (1.2293) teacher_loss 1.1196 (1.1119) loss_zs_kd 0.4870 (0.5621) loss_oracle 0.6598 (0.6192) acc 46.8750 (50.1562) kd_loss 1.1818 (1.0271) lr 1.9823e-03 eta 0:37:26
epoch [5/50] batch [40/319] time 0.125 (0.125) data 0.000 (0.016) loss 1.6368 (1.7797) ce_loss 1.0469 (1.2259) teacher_loss 1.0551 (1.1388) loss_zs_kd 0.5593 (0.5786) loss_oracle 0.5257 (0.5831) acc 62.5000 (51.4062) kd_loss 0.9466 (1.0108) lr 1.9823e-03 eta 0:30:29
epoch [5/50] batch [60/319] time 0.151 (0.122) data 0.000 (0.011) loss 1.6151 (1.7831) ce_loss 1.0586 (1.2360) teacher_loss 0.9739 (1.1376) loss_zs_kd 0.6209 (0.5790) loss_oracle 0.5791 (0.5876) acc 62.5000 (51.0417) kd_loss 0.8047 (0.9626) lr 1.9823e-03 eta 0:29:39
epoch [5/50] batch [80/319] time 0.156 (0.126) data 0.000 (0.008) loss 1.5554 (1.7749) ce_loss 0.9619 (1.2215) teacher_loss 0.9568 (1.1382) loss_zs_kd 0.4165 (0.5527) loss_oracle 0.5569 (0.5814) acc 71.8750 (51.9922) kd_loss 1.0409 (0.9542) lr 1.9823e-03 eta 0:30:38
epoch [5/50] batch [100/319] time 0.151 (0.131) data 0.000 (0.007) loss 1.8904 (1.7639) ce_loss 1.3105 (1.2155) teacher_loss 1.2919 (1.1375) loss_zs_kd 0.5051 (0.5396) loss_oracle 0.5480 (0.5724) acc 40.6250 (52.3438) kd_loss 0.8656 (0.9571) lr 1.9823e-03 eta 0:31:51
epoch [5/50] batch [120/319] time 0.143 (0.134) data 0.000 (0.005) loss 1.5801 (1.7678) ce_loss 1.1738 (1.2257) teacher_loss 1.1153 (1.1490) loss_zs_kd 0.4854 (0.5337) loss_oracle 0.4162 (0.5654) acc 56.2500 (51.8750) kd_loss 1.0452 (0.9615) lr 1.9823e-03 eta 0:32:34
epoch [5/50] batch [140/319] time 0.153 (0.137) data 0.000 (0.005) loss 2.0263 (1.7574) ce_loss 1.4727 (1.2202) teacher_loss 1.4970 (1.1475) loss_zs_kd 0.4814 (0.5383) loss_oracle 0.4811 (0.5561) acc 43.7500 (52.2098) kd_loss 1.0140 (0.9761) lr 1.9823e-03 eta 0:33:08
epoch [5/50] batch [160/319] time 0.145 (0.139) data 0.000 (0.004) loss 1.7016 (1.7415) ce_loss 1.3223 (1.2157) teacher_loss 1.1191 (1.1403) loss_zs_kd 0.6118 (0.5459) loss_oracle 0.5213 (0.5466) acc 46.8750 (52.5000) kd_loss 0.9901 (0.9857) lr 1.9823e-03 eta 0:33:32
epoch [5/50] batch [180/319] time 0.136 (0.140) data 0.000 (0.004) loss 1.2717 (1.7260) ce_loss 0.9175 (1.2062) teacher_loss 0.7384 (1.1262) loss_zs_kd 0.6799 (0.5574) loss_oracle 0.4653 (0.5441) acc 71.8750 (53.3507) kd_loss 1.0536 (0.9893) lr 1.9823e-03 eta 0:33:43
epoch [5/50] batch [200/319] time 0.151 (0.140) data 0.000 (0.003) loss 1.8381 (1.7262) ce_loss 1.1475 (1.2053) teacher_loss 1.1179 (1.1246) loss_zs_kd 0.7002 (0.5582) loss_oracle 0.6502 (0.5458) acc 59.3750 (53.5000) kd_loss 0.9522 (0.9878) lr 1.9823e-03 eta 0:33:49
epoch [5/50] batch [220/319] time 0.145 (0.141) data 0.000 (0.003) loss 1.5895 (1.7276) ce_loss 1.0479 (1.2068) teacher_loss 1.0301 (1.1255) loss_zs_kd 0.4404 (0.5570) loss_oracle 0.5153 (0.5464) acc 62.5000 (53.2955) kd_loss 0.9723 (0.9867) lr 1.9823e-03 eta 0:33:52
epoch [5/50] batch [240/319] time 0.087 (0.141) data 0.000 (0.003) loss 1.4611 (1.7305) ce_loss 1.0508 (1.2109) teacher_loss 0.9383 (1.1312) loss_zs_kd 0.4300 (0.5558) loss_oracle 0.4798 (0.5437) acc 50.0000 (53.1250) kd_loss 0.8795 (0.9901) lr 1.9823e-03 eta 0:33:55
epoch [5/50] batch [260/319] time 0.162 (0.140) data 0.000 (0.003) loss 2.0009 (1.7354) ce_loss 1.4297 (1.2128) teacher_loss 1.3585 (1.1346) loss_zs_kd 0.5977 (0.5519) loss_oracle 0.5826 (0.5456) acc 46.8750 (52.8606) kd_loss 0.8824 (0.9829) lr 1.9823e-03 eta 0:33:40
epoch [5/50] batch [280/319] time 0.150 (0.141) data 0.000 (0.002) loss 1.2105 (1.7336) ce_loss 0.8203 (1.2101) teacher_loss 0.6468 (1.1324) loss_zs_kd 0.3496 (0.5522) loss_oracle 0.5288 (0.5459) acc 56.2500 (52.9576) kd_loss 0.9905 (0.9758) lr 1.9823e-03 eta 0:33:48
epoch [5/50] batch [300/319] time 0.197 (0.140) data 0.000 (0.002) loss 1.8521 (1.7337) ce_loss 1.2129 (1.2096) teacher_loss 1.1894 (1.1324) loss_zs_kd 0.6003 (0.5533) loss_oracle 0.6027 (0.5460) acc 46.8750 (53.0000) kd_loss 0.8892 (0.9727) lr 1.9823e-03 eta 0:33:39
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,407
* accuracy: 55.0%
* error: 45.0%
* macro_f1: 46.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,803
* accuracy: 39.1%
* error: 60.9%
* macro_f1: 22.0%
******* Domain 2 best val acc:      55.6%, epoch: 4 *******
******* Domain 2 best val test acc: 44.0%, epoch: 4 *******
******* Domain 2 best test acc:     44.0%, epoch: 4 *******
epoch [6/50] batch [20/319] time 0.153 (0.183) data 0.000 (0.032) loss 2.0826 (1.6295) ce_loss 1.4385 (1.1685) teacher_loss 1.3967 (1.0605) loss_zs_kd 0.6480 (0.6055) loss_oracle 0.6211 (0.5085) acc 34.3750 (55.3125) kd_loss 0.8949 (1.0091) lr 1.9686e-03 eta 0:43:43
epoch [6/50] batch [40/319] time 0.154 (0.167) data 0.000 (0.016) loss 1.7485 (1.6502) ce_loss 1.2383 (1.1505) teacher_loss 1.2209 (1.0563) loss_zs_kd 0.5741 (0.5875) loss_oracle 0.4702 (0.5352) acc 50.0000 (56.2500) kd_loss 0.8532 (0.9689) lr 1.9686e-03 eta 0:39:46
epoch [6/50] batch [60/319] time 0.159 (0.162) data 0.000 (0.011) loss 1.8809 (1.6933) ce_loss 1.2568 (1.1700) teacher_loss 1.2140 (1.0888) loss_zs_kd 0.5429 (0.5650) loss_oracle 0.6126 (0.5480) acc 56.2500 (55.2604) kd_loss 0.8462 (0.9339) lr 1.9686e-03 eta 0:38:36
epoch [6/50] batch [80/319] time 0.113 (0.152) data 0.000 (0.008) loss 1.8466 (1.7074) ce_loss 1.3184 (1.1767) teacher_loss 1.2380 (1.1002) loss_zs_kd 0.5384 (0.5606) loss_oracle 0.5548 (0.5512) acc 53.1250 (55.0391) kd_loss 0.9226 (0.9133) lr 1.9686e-03 eta 0:36:02
epoch [6/50] batch [100/319] time 0.139 (0.144) data 0.000 (0.006) loss 1.6298 (1.7204) ce_loss 1.0342 (1.1890) teacher_loss 1.0154 (1.1125) loss_zs_kd 0.5595 (0.5483) loss_oracle 0.5585 (0.5531) acc 62.5000 (54.5938) kd_loss 0.8773 (0.9075) lr 1.9686e-03 eta 0:34:05
epoch [6/50] batch [120/319] time 0.138 (0.143) data 0.000 (0.005) loss 1.5378 (1.7149) ce_loss 1.1514 (1.1863) teacher_loss 0.9457 (1.1079) loss_zs_kd 0.6645 (0.5574) loss_oracle 0.5257 (0.5512) acc 62.5000 (54.8958) kd_loss 1.0671 (0.9109) lr 1.9686e-03 eta 0:33:49
epoch [6/50] batch [140/319] time 0.064 (0.143) data 0.000 (0.005) loss 1.7700 (1.6959) ce_loss 1.3428 (1.1844) teacher_loss 1.2212 (1.0994) loss_zs_kd 0.6602 (0.5697) loss_oracle 0.4828 (0.5395) acc 53.1250 (54.9777) kd_loss 1.0543 (0.9317) lr 1.9686e-03 eta 0:33:46
epoch [6/50] batch [160/319] time 0.184 (0.143) data 0.000 (0.004) loss 1.6024 (1.6879) ce_loss 1.1191 (1.1853) teacher_loss 1.1634 (1.0988) loss_zs_kd 0.5123 (0.5866) loss_oracle 0.3878 (0.5304) acc 59.3750 (55.0391) kd_loss 1.1636 (0.9539) lr 1.9686e-03 eta 0:33:46
epoch [6/50] batch [180/319] time 0.185 (0.144) data 0.000 (0.004) loss 1.9975 (1.6894) ce_loss 1.3896 (1.1906) teacher_loss 1.4086 (1.1042) loss_zs_kd 0.5921 (0.5871) loss_oracle 0.5298 (0.5264) acc 53.1250 (54.9306) kd_loss 1.2375 (0.9797) lr 1.9686e-03 eta 0:34:01
epoch [6/50] batch [200/319] time 0.084 (0.145) data 0.000 (0.003) loss 1.6167 (1.6800) ce_loss 1.2344 (1.1906) teacher_loss 1.1772 (1.1026) loss_zs_kd 0.5105 (0.5789) loss_oracle 0.3885 (0.5195) acc 53.1250 (55.2188) kd_loss 1.1248 (0.9980) lr 1.9686e-03 eta 0:34:11
epoch [6/50] batch [220/319] time 0.139 (0.142) data 0.000 (0.003) loss 1.6007 (1.6725) ce_loss 1.0986 (1.1881) teacher_loss 1.0302 (1.0978) loss_zs_kd 0.5727 (0.5843) loss_oracle 0.5133 (0.5162) acc 65.6250 (55.4261) kd_loss 1.0841 (1.0121) lr 1.9686e-03 eta 0:33:34
epoch [6/50] batch [240/319] time 0.135 (0.140) data 0.000 (0.003) loss 1.9918 (1.6723) ce_loss 1.3926 (1.1901) teacher_loss 1.4616 (1.1018) loss_zs_kd 0.5860 (0.5855) loss_oracle 0.4717 (0.5120) acc 43.7500 (55.3516) kd_loss 1.0422 (1.0153) lr 1.9686e-03 eta 0:32:55
epoch [6/50] batch [260/319] time 0.138 (0.138) data 0.000 (0.003) loss 1.5409 (1.6741) ce_loss 0.9883 (1.1920) teacher_loss 0.9822 (1.1048) loss_zs_kd 0.5907 (0.5842) loss_oracle 0.4996 (0.5108) acc 56.2500 (55.0841) kd_loss 0.9317 (1.0119) lr 1.9686e-03 eta 0:32:23
epoch [6/50] batch [280/319] time 0.153 (0.138) data 0.000 (0.002) loss 1.6803 (1.6746) ce_loss 1.2285 (1.1916) teacher_loss 1.1568 (1.1047) loss_zs_kd 0.5290 (0.5861) loss_oracle 0.4706 (0.5113) acc 50.0000 (55.0000) kd_loss 0.9876 (1.0081) lr 1.9686e-03 eta 0:32:29
epoch [6/50] batch [300/319] time 0.156 (0.139) data 0.000 (0.002) loss 1.5247 (1.6755) ce_loss 1.1846 (1.1946) teacher_loss 0.9679 (1.1072) loss_zs_kd 0.6631 (0.5855) loss_oracle 0.4905 (0.5098) acc 59.3750 (55.0521) kd_loss 1.0833 (1.0070) lr 1.9686e-03 eta 0:32:38
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,602
* accuracy: 59.4%
* error: 40.6%
* macro_f1: 49.3%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,226
* accuracy: 53.7%
* error: 46.3%
* macro_f1: 22.8%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      59.4%, epoch: 6 *******
******* Domain 2 best val test acc: 53.7%, epoch: 6 *******
******* Domain 2 best test acc:     53.7%, epoch: 6 *******
epoch [7/50] batch [20/319] time 0.184 (0.224) data 0.000 (0.029) loss 1.2992 (1.6150) ce_loss 0.8032 (1.1393) teacher_loss 0.7874 (1.0738) loss_zs_kd 0.5765 (0.6028) loss_oracle 0.4541 (0.4809) acc 62.5000 (59.3750) kd_loss 1.1615 (1.0861) lr 1.9511e-03 eta 0:52:16
epoch [7/50] batch [40/319] time 0.155 (0.173) data 0.000 (0.015) loss 1.9055 (1.6322) ce_loss 1.5156 (1.1809) teacher_loss 1.3449 (1.0862) loss_zs_kd 0.7471 (0.6493) loss_oracle 0.4858 (0.4811) acc 56.2500 (56.9531) kd_loss 1.2021 (1.1326) lr 1.9511e-03 eta 0:40:25
epoch [7/50] batch [60/319] time 0.147 (0.166) data 0.000 (0.010) loss 1.6386 (1.6202) ce_loss 1.1396 (1.1725) teacher_loss 0.9563 (1.0544) loss_zs_kd 0.6995 (0.6507) loss_oracle 0.6124 (0.5007) acc 53.1250 (56.6146) kd_loss 0.9083 (1.0897) lr 1.9511e-03 eta 0:38:35
epoch [7/50] batch [80/319] time 0.153 (0.162) data 0.000 (0.007) loss 1.6030 (1.6461) ce_loss 1.1104 (1.1858) teacher_loss 1.0722 (1.0718) loss_zs_kd 0.5328 (0.6439) loss_oracle 0.4775 (0.5098) acc 59.3750 (55.7031) kd_loss 0.8189 (1.0403) lr 1.9511e-03 eta 0:37:46
epoch [7/50] batch [100/319] time 0.150 (0.160) data 0.000 (0.006) loss 1.6727 (1.6603) ce_loss 1.2207 (1.1982) teacher_loss 1.1794 (1.0905) loss_zs_kd 0.5060 (0.6260) loss_oracle 0.4426 (0.5073) acc 59.3750 (55.1875) kd_loss 1.0058 (1.0157) lr 1.9511e-03 eta 0:37:14
epoch [7/50] batch [120/319] time 0.159 (0.158) data 0.000 (0.005) loss 1.9530 (1.6667) ce_loss 1.4385 (1.1976) teacher_loss 1.3184 (1.0933) loss_zs_kd 0.6554 (0.6239) loss_oracle 0.5690 (0.5110) acc 46.8750 (54.4792) kd_loss 0.8189 (0.9888) lr 1.9511e-03 eta 0:36:32
epoch [7/50] batch [140/319] time 0.117 (0.155) data 0.000 (0.004) loss 1.3544 (1.6738) ce_loss 1.1240 (1.1945) teacher_loss 0.8516 (1.0955) loss_zs_kd 0.5323 (0.6186) loss_oracle 0.4497 (0.5164) acc 53.1250 (54.8438) kd_loss 0.9526 (0.9644) lr 1.9511e-03 eta 0:35:48
epoch [7/50] batch [160/319] time 0.090 (0.150) data 0.000 (0.004) loss 1.5577 (1.6739) ce_loss 1.1650 (1.1965) teacher_loss 0.9315 (1.0959) loss_zs_kd 0.4876 (0.6050) loss_oracle 0.5773 (0.5176) acc 53.1250 (54.4531) kd_loss 0.9930 (0.9649) lr 1.9511e-03 eta 0:34:37
epoch [7/50] batch [180/319] time 0.137 (0.146) data 0.000 (0.003) loss 1.7083 (1.6780) ce_loss 1.2207 (1.2034) teacher_loss 1.1688 (1.0957) loss_zs_kd 0.6048 (0.6051) loss_oracle 0.4791 (0.5218) acc 53.1250 (53.9583) kd_loss 1.0366 (0.9748) lr 1.9511e-03 eta 0:33:45
epoch [7/50] batch [200/319] time 0.121 (0.143) data 0.000 (0.003) loss 2.1313 (1.6792) ce_loss 1.5449 (1.2027) teacher_loss 1.3927 (1.0860) loss_zs_kd 0.8284 (0.6050) loss_oracle 0.6557 (0.5327) acc 40.6250 (53.8281) kd_loss 1.1070 (0.9831) lr 1.9511e-03 eta 0:32:53
epoch [7/50] batch [220/319] time 0.127 (0.140) data 0.000 (0.003) loss 1.8154 (1.6778) ce_loss 1.2324 (1.1943) teacher_loss 1.1347 (1.0758) loss_zs_kd 0.6760 (0.6105) loss_oracle 0.6131 (0.5409) acc 53.1250 (54.2614) kd_loss 0.9601 (0.9810) lr 1.9511e-03 eta 0:32:14
epoch [7/50] batch [240/319] time 0.152 (0.140) data 0.000 (0.003) loss 1.5654 (1.6776) ce_loss 1.2500 (1.1921) teacher_loss 0.9672 (1.0762) loss_zs_kd 0.5693 (0.6082) loss_oracle 0.5412 (0.5407) acc 53.1250 (54.2708) kd_loss 1.0312 (0.9787) lr 1.9511e-03 eta 0:32:10
epoch [7/50] batch [260/319] time 0.094 (0.139) data 0.000 (0.002) loss 1.3854 (1.6744) ce_loss 1.0459 (1.1939) teacher_loss 0.8274 (1.0795) loss_zs_kd 0.6470 (0.6051) loss_oracle 0.4932 (0.5344) acc 62.5000 (54.1827) kd_loss 1.1782 (0.9854) lr 1.9511e-03 eta 0:31:58
epoch [7/50] batch [280/319] time 0.078 (0.137) data 0.000 (0.002) loss 1.5568 (1.6667) ce_loss 1.1191 (1.1943) teacher_loss 0.9429 (1.0749) loss_zs_kd 0.7407 (0.6132) loss_oracle 0.5398 (0.5305) acc 59.3750 (54.2857) kd_loss 1.1562 (0.9931) lr 1.9511e-03 eta 0:31:29
epoch [7/50] batch [300/319] time 0.141 (0.136) data 0.000 (0.002) loss 1.7971 (1.6639) ce_loss 1.2832 (1.1923) teacher_loss 1.1262 (1.0749) loss_zs_kd 0.6600 (0.6120) loss_oracle 0.6049 (0.5278) acc 37.5000 (54.3958) kd_loss 1.0280 (0.9971) lr 1.9511e-03 eta 0:31:08
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,624
* accuracy: 59.9%
* error: 40.1%
* macro_f1: 51.9%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,128
* accuracy: 52.7%
* error: 47.3%
* macro_f1: 22.0%
******* Domain 2 best val acc:      59.9%, epoch: 7 *******
******* Domain 2 best val test acc: 52.7%, epoch: 7 *******
******* Domain 2 best test acc:     53.7%, epoch: 6 *******
epoch [8/50] batch [20/319] time 0.092 (0.154) data 0.000 (0.025) loss 1.8515 (1.5920) ce_loss 1.4131 (1.2427) teacher_loss 1.3198 (1.0559) loss_zs_kd 0.7302 (0.7172) loss_oracle 0.4587 (0.4644) acc 50.0000 (52.6562) kd_loss 1.2466 (1.1741) lr 1.9298e-03 eta 0:35:15
epoch [8/50] batch [40/319] time 0.151 (0.137) data 0.000 (0.013) loss 1.3983 (1.5958) ce_loss 0.9541 (1.2220) teacher_loss 0.8735 (1.0484) loss_zs_kd 0.6251 (0.7084) loss_oracle 0.4624 (0.4766) acc 65.6250 (54.1406) kd_loss 1.1021 (1.1623) lr 1.9298e-03 eta 0:31:16
epoch [8/50] batch [60/319] time 0.156 (0.142) data 0.001 (0.009) loss 1.6820 (1.6017) ce_loss 1.2139 (1.1927) teacher_loss 1.1181 (1.0471) loss_zs_kd 0.6385 (0.6903) loss_oracle 0.5000 (0.4856) acc 56.2500 (55.0000) kd_loss 0.8965 (1.1077) lr 1.9298e-03 eta 0:32:24
epoch [8/50] batch [80/319] time 0.157 (0.146) data 0.000 (0.007) loss 1.5824 (1.6015) ce_loss 1.1299 (1.1736) teacher_loss 1.0767 (1.0464) loss_zs_kd 0.4361 (0.6475) loss_oracle 0.4621 (0.4903) acc 62.5000 (55.8594) kd_loss 1.0158 (1.0677) lr 1.9298e-03 eta 0:33:04
epoch [8/50] batch [100/319] time 0.136 (0.141) data 0.000 (0.005) loss 1.4322 (1.6093) ce_loss 1.0537 (1.1770) teacher_loss 0.9010 (1.0565) loss_zs_kd 0.6914 (0.6355) loss_oracle 0.4621 (0.4892) acc 59.3750 (55.8438) kd_loss 1.0774 (1.0543) lr 1.9298e-03 eta 0:31:53
epoch [8/50] batch [120/319] time 0.091 (0.135) data 0.000 (0.004) loss 1.8089 (1.5941) ce_loss 1.3398 (1.1640) teacher_loss 1.1769 (1.0423) loss_zs_kd 0.9151 (0.6466) loss_oracle 0.5405 (0.4872) acc 53.1250 (56.5625) kd_loss 1.0850 (1.0583) lr 1.9298e-03 eta 0:30:29
epoch [8/50] batch [140/319] time 0.155 (0.135) data 0.000 (0.004) loss 1.6658 (1.5862) ce_loss 1.1084 (1.1660) teacher_loss 1.0928 (1.0339) loss_zs_kd 1.0425 (0.6617) loss_oracle 0.4688 (0.4861) acc 68.7500 (56.4286) kd_loss 1.1024 (1.0605) lr 1.9298e-03 eta 0:30:30
epoch [8/50] batch [160/319] time 0.119 (0.134) data 0.000 (0.003) loss 1.8560 (1.5879) ce_loss 1.2227 (1.1692) teacher_loss 1.2998 (1.0393) loss_zs_kd 0.6174 (0.6682) loss_oracle 0.4945 (0.4818) acc 53.1250 (56.3086) kd_loss 1.2388 (1.0697) lr 1.9298e-03 eta 0:30:10
epoch [8/50] batch [180/319] time 0.090 (0.131) data 0.000 (0.003) loss 1.6265 (1.5913) ce_loss 1.3779 (1.1731) teacher_loss 1.1116 (1.0456) loss_zs_kd 0.5883 (0.6681) loss_oracle 0.4561 (0.4789) acc 50.0000 (56.3194) kd_loss 1.1540 (1.0817) lr 1.9298e-03 eta 0:29:30
epoch [8/50] batch [200/319] time 0.100 (0.129) data 0.000 (0.003) loss 1.4866 (1.5842) ce_loss 1.0859 (1.1676) teacher_loss 0.9344 (1.0401) loss_zs_kd 0.8165 (0.6651) loss_oracle 0.4705 (0.4776) acc 56.2500 (56.0781) kd_loss 1.0546 (1.0888) lr 1.9298e-03 eta 0:29:04
epoch [8/50] batch [220/319] time 0.189 (0.128) data 0.000 (0.003) loss 1.2538 (1.5796) ce_loss 0.9146 (1.1652) teacher_loss 0.7425 (1.0370) loss_zs_kd 0.7506 (0.6695) loss_oracle 0.4362 (0.4756) acc 62.5000 (56.1080) kd_loss 1.0517 (1.0910) lr 1.9298e-03 eta 0:28:50
epoch [8/50] batch [240/319] time 0.168 (0.129) data 0.000 (0.002) loss 1.7553 (1.5748) ce_loss 1.2598 (1.1605) teacher_loss 1.2252 (1.0319) loss_zs_kd 0.6003 (0.6716) loss_oracle 0.4701 (0.4757) acc 59.3750 (56.4062) kd_loss 1.0871 (1.0917) lr 1.9298e-03 eta 0:28:56
epoch [8/50] batch [260/319] time 0.189 (0.133) data 0.000 (0.002) loss 1.6967 (1.5718) ce_loss 1.3564 (1.1599) teacher_loss 1.1594 (1.0302) loss_zs_kd 0.7395 (0.6754) loss_oracle 0.4634 (0.4741) acc 56.2500 (56.4303) kd_loss 0.9964 (1.0903) lr 1.9298e-03 eta 0:29:55
epoch [8/50] batch [280/319] time 0.094 (0.132) data 0.000 (0.002) loss 1.7661 (1.5695) ce_loss 1.3027 (1.1552) teacher_loss 1.2270 (1.0266) loss_zs_kd 0.5815 (0.6757) loss_oracle 0.4809 (0.4753) acc 37.5000 (56.5513) kd_loss 0.9063 (1.0828) lr 1.9298e-03 eta 0:29:27
epoch [8/50] batch [300/319] time 0.155 (0.132) data 0.000 (0.002) loss 1.8651 (1.5813) ce_loss 1.3330 (1.1601) teacher_loss 1.2884 (1.0358) loss_zs_kd 0.4390 (0.6703) loss_oracle 0.5328 (0.4785) acc 46.8750 (56.3125) kd_loss 0.7984 (1.0700) lr 1.9298e-03 eta 0:29:34
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,666
* accuracy: 60.9%
* error: 39.1%
* macro_f1: 51.6%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,184
* accuracy: 53.2%
* error: 46.8%
* macro_f1: 22.3%
******* Domain 2 best val acc:      60.9%, epoch: 8 *******
******* Domain 2 best val test acc: 53.2%, epoch: 8 *******
******* Domain 2 best test acc:     53.7%, epoch: 6 *******
epoch [9/50] batch [20/319] time 0.149 (0.172) data 0.000 (0.025) loss 1.3108 (1.5273) ce_loss 1.0557 (1.0962) teacher_loss 0.7806 (0.9808) loss_zs_kd 0.6475 (0.6886) loss_oracle 0.4655 (0.4777) acc 53.1250 (58.1250) kd_loss 1.0337 (1.0336) lr 1.9048e-03 eta 0:38:24
epoch [9/50] batch [40/319] time 0.155 (0.152) data 0.000 (0.013) loss 1.4945 (1.5272) ce_loss 1.0918 (1.0784) teacher_loss 0.9189 (0.9711) loss_zs_kd 0.7513 (0.6737) loss_oracle 0.5005 (0.4887) acc 62.5000 (59.5312) kd_loss 1.0068 (1.0272) lr 1.9048e-03 eta 0:33:53
epoch [9/50] batch [60/319] time 0.072 (0.138) data 0.000 (0.008) loss 1.7530 (1.5493) ce_loss 1.2080 (1.1072) teacher_loss 1.1612 (0.9951) loss_zs_kd 0.6416 (0.6645) loss_oracle 0.5276 (0.4877) acc 50.0000 (58.5938) kd_loss 1.0419 (1.0318) lr 1.9048e-03 eta 0:30:40
epoch [9/50] batch [80/319] time 0.064 (0.146) data 0.000 (0.006) loss 1.7232 (1.5690) ce_loss 1.1152 (1.1252) teacher_loss 1.1124 (1.0089) loss_zs_kd 0.6306 (0.6694) loss_oracle 0.5477 (0.4931) acc 59.3750 (58.0469) kd_loss 1.0934 (1.0457) lr 1.9048e-03 eta 0:32:24
epoch [9/50] batch [100/319] time 0.186 (0.145) data 0.000 (0.005) loss 1.7500 (1.5798) ce_loss 1.2979 (1.1282) teacher_loss 1.1619 (1.0218) loss_zs_kd 0.5458 (0.6488) loss_oracle 0.5334 (0.4931) acc 46.8750 (58.1562) kd_loss 1.0057 (1.0552) lr 1.9048e-03 eta 0:32:09
epoch [9/50] batch [120/319] time 0.126 (0.144) data 0.000 (0.004) loss 1.6529 (1.5829) ce_loss 1.1943 (1.1410) teacher_loss 1.1584 (1.0277) loss_zs_kd 0.6197 (0.6491) loss_oracle 0.4325 (0.4903) acc 59.3750 (57.6823) kd_loss 1.1065 (1.0627) lr 1.9048e-03 eta 0:31:55
epoch [9/50] batch [140/319] time 0.096 (0.140) data 0.000 (0.004) loss 1.9915 (1.5878) ce_loss 1.5117 (1.1476) teacher_loss 1.4672 (1.0338) loss_zs_kd 0.6086 (0.6529) loss_oracle 0.4634 (0.4887) acc 40.6250 (57.3661) kd_loss 1.0200 (1.0560) lr 1.9048e-03 eta 0:30:56
epoch [9/50] batch [160/319] time 0.147 (0.140) data 0.000 (0.003) loss 1.7568 (1.5800) ce_loss 1.1377 (1.1414) teacher_loss 1.2134 (1.0279) loss_zs_kd 0.7616 (0.6589) loss_oracle 0.4672 (0.4863) acc 68.7500 (57.6172) kd_loss 1.1117 (1.0598) lr 1.9048e-03 eta 0:30:52
epoch [9/50] batch [180/319] time 0.149 (0.141) data 0.000 (0.003) loss 1.4735 (1.5723) ce_loss 1.1494 (1.1390) teacher_loss 0.9355 (1.0228) loss_zs_kd 0.8406 (0.6645) loss_oracle 0.4540 (0.4831) acc 59.3750 (57.5000) kd_loss 1.1190 (1.0661) lr 1.9048e-03 eta 0:31:08
epoch [9/50] batch [200/319] time 0.162 (0.142) data 0.000 (0.003) loss 1.5963 (1.5712) ce_loss 1.1055 (1.1413) teacher_loss 1.0525 (1.0236) loss_zs_kd 0.6550 (0.6687) loss_oracle 0.4782 (0.4807) acc 56.2500 (57.2656) kd_loss 1.1289 (1.0693) lr 1.9048e-03 eta 0:31:11
epoch [9/50] batch [220/319] time 0.156 (0.143) data 0.000 (0.003) loss 1.4560 (1.5761) ce_loss 1.1748 (1.1435) teacher_loss 0.9882 (1.0270) loss_zs_kd 0.6092 (0.6676) loss_oracle 0.4069 (0.4824) acc 40.6250 (57.1307) kd_loss 1.1917 (1.0798) lr 1.9048e-03 eta 0:31:21
epoch [9/50] batch [240/319] time 0.092 (0.140) data 0.000 (0.002) loss 1.5837 (1.5745) ce_loss 1.2812 (1.1453) teacher_loss 0.9334 (1.0255) loss_zs_kd 0.8850 (0.6681) loss_oracle 0.5618 (0.4821) acc 50.0000 (57.0833) kd_loss 1.2011 (1.0888) lr 1.9048e-03 eta 0:30:45
epoch [9/50] batch [260/319] time 0.115 (0.138) data 0.000 (0.002) loss 1.7705 (1.5686) ce_loss 1.1924 (1.1442) teacher_loss 1.2509 (1.0208) loss_zs_kd 0.6832 (0.6729) loss_oracle 0.4512 (0.4805) acc 53.1250 (57.0673) kd_loss 1.2123 (1.0960) lr 1.9048e-03 eta 0:30:11
epoch [9/50] batch [280/319] time 0.122 (0.136) data 0.000 (0.002) loss 1.4836 (1.5727) ce_loss 1.0088 (1.1516) teacher_loss 0.7861 (1.0243) loss_zs_kd 0.7280 (0.6712) loss_oracle 0.6246 (0.4813) acc 59.3750 (56.6295) kd_loss 1.1040 (1.1011) lr 1.9048e-03 eta 0:29:43
epoch [9/50] batch [300/319] time 0.135 (0.134) data 0.000 (0.002) loss 1.8618 (1.5707) ce_loss 1.4033 (1.1534) teacher_loss 1.2158 (1.0215) loss_zs_kd 0.7229 (0.6728) loss_oracle 0.5737 (0.4820) acc 50.0000 (56.4583) kd_loss 1.1157 (1.1047) lr 1.9048e-03 eta 0:29:13
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,667
* accuracy: 60.9%
* error: 39.1%
* macro_f1: 52.5%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,660
* accuracy: 47.9%
* error: 52.1%
* macro_f1: 22.1%
******* Domain 2 best val acc:      60.9%, epoch: 9 *******
******* Domain 2 best val test acc: 47.9%, epoch: 9 *******
******* Domain 2 best test acc:     53.7%, epoch: 6 *******
epoch [10/50] batch [20/319] time 0.167 (0.163) data 0.000 (0.024) loss 1.8792 (1.6660) ce_loss 1.3789 (1.2008) teacher_loss 1.2571 (1.1028) loss_zs_kd 0.6375 (0.6050) loss_oracle 0.5583 (0.5027) acc 37.5000 (53.4375) kd_loss 0.9195 (0.9518) lr 1.8763e-03 eta 0:35:29
epoch [10/50] batch [40/319] time 0.151 (0.158) data 0.000 (0.012) loss 1.6801 (1.6665) ce_loss 1.1533 (1.1814) teacher_loss 1.0999 (1.0728) loss_zs_kd 0.5506 (0.6045) loss_oracle 0.5252 (0.5333) acc 53.1250 (53.4375) kd_loss 0.8778 (0.9235) lr 1.8763e-03 eta 0:34:14
epoch [10/50] batch [60/319] time 0.140 (0.150) data 0.001 (0.008) loss 2.0231 (1.6440) ce_loss 1.4990 (1.1729) teacher_loss 1.4713 (1.0577) loss_zs_kd 0.6163 (0.5952) loss_oracle 0.4902 (0.5268) acc 43.7500 (53.6979) kd_loss 1.0460 (0.9489) lr 1.8763e-03 eta 0:32:38
epoch [10/50] batch [80/319] time 0.155 (0.142) data 0.000 (0.006) loss 1.2571 (1.6270) ce_loss 0.9927 (1.1742) teacher_loss 0.7249 (1.0557) loss_zs_kd 0.6218 (0.5953) loss_oracle 0.4700 (0.5117) acc 59.3750 (53.4766) kd_loss 1.0116 (0.9722) lr 1.8763e-03 eta 0:30:39
epoch [10/50] batch [100/319] time 0.152 (0.141) data 0.000 (0.005) loss 1.3090 (1.6159) ce_loss 0.8896 (1.1808) teacher_loss 0.8668 (1.0557) loss_zs_kd 0.5792 (0.6083) loss_oracle 0.3843 (0.4994) acc 78.1250 (53.6250) kd_loss 1.2006 (1.0004) lr 1.8763e-03 eta 0:30:26
epoch [10/50] batch [120/319] time 0.143 (0.140) data 0.000 (0.004) loss 1.5813 (1.5959) ce_loss 1.1689 (1.1746) teacher_loss 1.0527 (1.0466) loss_zs_kd 0.6357 (0.6185) loss_oracle 0.4650 (0.4874) acc 56.2500 (54.3229) kd_loss 1.1418 (1.0331) lr 1.8763e-03 eta 0:30:15
epoch [10/50] batch [140/319] time 0.092 (0.137) data 0.000 (0.004) loss 1.3971 (1.5844) ce_loss 1.0400 (1.1642) teacher_loss 0.8818 (1.0402) loss_zs_kd 0.7206 (0.6216) loss_oracle 0.4432 (0.4821) acc 59.3750 (54.6875) kd_loss 1.1373 (1.0508) lr 1.8763e-03 eta 0:29:27
epoch [10/50] batch [160/319] time 0.125 (0.134) data 0.000 (0.003) loss 1.7928 (1.5844) ce_loss 1.2109 (1.1601) teacher_loss 1.1945 (1.0427) loss_zs_kd 0.7175 (0.6239) loss_oracle 0.5266 (0.4793) acc 53.1250 (55.2148) kd_loss 0.9816 (1.0552) lr 1.8763e-03 eta 0:28:50
epoch [10/50] batch [180/319] time 0.096 (0.131) data 0.000 (0.003) loss 1.5259 (1.5989) ce_loss 1.0752 (1.1671) teacher_loss 0.9383 (1.0532) loss_zs_kd 0.5412 (0.6260) loss_oracle 0.5334 (0.4831) acc 59.3750 (55.1910) kd_loss 0.9995 (1.0545) lr 1.8763e-03 eta 0:28:13
epoch [10/50] batch [200/319] time 0.091 (0.129) data 0.000 (0.003) loss 1.3982 (1.6052) ce_loss 0.8306 (1.1658) teacher_loss 0.7676 (1.0570) loss_zs_kd 0.5108 (0.6153) loss_oracle 0.5795 (0.4867) acc 75.0000 (55.2188) kd_loss 0.9717 (1.0474) lr 1.8763e-03 eta 0:27:41
epoch [10/50] batch [220/319] time 0.087 (0.126) data 0.000 (0.002) loss 1.5753 (1.6155) ce_loss 0.9893 (1.1654) teacher_loss 0.9220 (1.0631) loss_zs_kd 0.4875 (0.6080) loss_oracle 0.6045 (0.4916) acc 59.3750 (55.3409) kd_loss 0.8091 (1.0322) lr 1.8763e-03 eta 0:27:04
epoch [10/50] batch [240/319] time 0.119 (0.125) data 0.000 (0.002) loss 1.6802 (1.6300) ce_loss 1.1377 (1.1695) teacher_loss 1.1010 (1.0729) loss_zs_kd 0.6236 (0.6046) loss_oracle 0.5168 (0.4966) acc 59.3750 (55.3125) kd_loss 0.9162 (1.0157) lr 1.8763e-03 eta 0:26:39
epoch [10/50] batch [260/319] time 0.094 (0.122) data 0.000 (0.002) loss 1.6226 (1.6358) ce_loss 1.2041 (1.1701) teacher_loss 1.0688 (1.0762) loss_zs_kd 0.6151 (0.5991) loss_oracle 0.4923 (0.4997) acc 53.1250 (55.1923) kd_loss 0.9538 (1.0064) lr 1.8763e-03 eta 0:26:10
epoch [10/50] batch [280/319] time 0.139 (0.121) data 0.000 (0.002) loss 1.7322 (1.6352) ce_loss 1.2285 (1.1656) teacher_loss 1.1623 (1.0750) loss_zs_kd 0.5671 (0.5974) loss_oracle 0.5132 (0.5006) acc 46.8750 (55.3906) kd_loss 0.8931 (0.9973) lr 1.8763e-03 eta 0:25:54
epoch [10/50] batch [300/319] time 0.111 (0.120) data 0.000 (0.002) loss 1.7720 (1.6384) ce_loss 1.2832 (1.1646) teacher_loss 1.1538 (1.0754) loss_zs_kd 0.5601 (0.5960) loss_oracle 0.5622 (0.5034) acc 53.1250 (55.5000) kd_loss 0.7681 (0.9890) lr 1.8763e-03 eta 0:25:39
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,652
* accuracy: 60.6%
* error: 39.4%
* macro_f1: 52.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,234
* accuracy: 53.8%
* error: 46.2%
* macro_f1: 23.0%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      60.9%, epoch: 9 *******
******* Domain 2 best val test acc: 47.9%, epoch: 9 *******
******* Domain 2 best test acc:     53.8%, epoch: 10 *******
epoch [11/50] batch [20/319] time 0.142 (0.143) data 0.000 (0.025) loss 1.4422 (1.6260) ce_loss 1.0654 (1.1267) teacher_loss 0.9003 (1.0566) loss_zs_kd 0.5385 (0.5648) loss_oracle 0.4880 (0.5129) acc 62.5000 (58.9062) kd_loss 1.0650 (0.9940) lr 1.8443e-03 eta 0:30:20
epoch [11/50] batch [40/319] time 0.147 (0.148) data 0.000 (0.012) loss 1.4290 (1.5863) ce_loss 0.9658 (1.1213) teacher_loss 0.8536 (1.0206) loss_zs_kd 0.6816 (0.6167) loss_oracle 0.5072 (0.5040) acc 71.8750 (58.2812) kd_loss 1.0824 (1.0112) lr 1.8443e-03 eta 0:31:16
epoch [11/50] batch [60/319] time 0.122 (0.140) data 0.001 (0.008) loss 1.7124 (1.5817) ce_loss 1.2480 (1.1265) teacher_loss 1.0821 (1.0136) loss_zs_kd 0.8489 (0.6550) loss_oracle 0.5453 (0.5026) acc 59.3750 (58.5417) kd_loss 1.1592 (1.0368) lr 1.8443e-03 eta 0:29:33
epoch [11/50] batch [80/319] time 0.145 (0.133) data 0.000 (0.006) loss 1.7391 (1.5818) ce_loss 1.3848 (1.1323) teacher_loss 1.1983 (1.0178) loss_zs_kd 0.7903 (0.6627) loss_oracle 0.4617 (0.4977) acc 53.1250 (58.2031) kd_loss 1.1685 (1.0596) lr 1.8443e-03 eta 0:28:09
epoch [11/50] batch [100/319] time 0.121 (0.129) data 0.000 (0.005) loss 1.5265 (1.5809) ce_loss 1.1611 (1.1470) teacher_loss 1.0681 (1.0279) loss_zs_kd 0.6272 (0.6746) loss_oracle 0.3956 (0.4855) acc 59.3750 (57.7188) kd_loss 1.2349 (1.0855) lr 1.8443e-03 eta 0:27:12
epoch [11/50] batch [120/319] time 0.143 (0.126) data 0.000 (0.004) loss 1.4634 (1.5748) ce_loss 1.0146 (1.1517) teacher_loss 0.9424 (1.0254) loss_zs_kd 0.7625 (0.6888) loss_oracle 0.4447 (0.4805) acc 62.5000 (57.3438) kd_loss 1.0671 (1.0999) lr 1.8443e-03 eta 0:26:38
epoch [11/50] batch [140/319] time 0.096 (0.124) data 0.000 (0.004) loss 1.9409 (1.5754) ce_loss 1.3457 (1.1542) teacher_loss 1.4038 (1.0277) loss_zs_kd 0.7969 (0.6934) loss_oracle 0.4574 (0.4784) acc 40.6250 (57.2768) kd_loss 1.0615 (1.1071) lr 1.8443e-03 eta 0:26:07
epoch [11/50] batch [160/319] time 0.156 (0.126) data 0.000 (0.003) loss 1.2515 (1.5809) ce_loss 0.7920 (1.1554) teacher_loss 0.6211 (1.0330) loss_zs_kd 0.6652 (0.6901) loss_oracle 0.5639 (0.4789) acc 75.0000 (57.2266) kd_loss 1.1767 (1.1082) lr 1.8443e-03 eta 0:26:33
epoch [11/50] batch [180/319] time 0.093 (0.127) data 0.000 (0.003) loss 1.5916 (1.5793) ce_loss 1.0674 (1.1522) teacher_loss 1.0149 (1.0339) loss_zs_kd 0.6629 (0.6899) loss_oracle 0.5104 (0.4764) acc 65.6250 (57.2917) kd_loss 1.0790 (1.1093) lr 1.8443e-03 eta 0:26:37
epoch [11/50] batch [200/319] time 0.093 (0.125) data 0.000 (0.003) loss 1.5655 (1.5748) ce_loss 1.1348 (1.1477) teacher_loss 1.0874 (1.0323) loss_zs_kd 0.7754 (0.6938) loss_oracle 0.4006 (0.4731) acc 59.3750 (57.4062) kd_loss 1.0838 (1.1135) lr 1.8443e-03 eta 0:26:15
epoch [11/50] batch [220/319] time 0.200 (0.123) data 0.000 (0.002) loss 1.7269 (1.5724) ce_loss 1.2578 (1.1450) teacher_loss 1.2606 (1.0309) loss_zs_kd 0.7424 (0.6932) loss_oracle 0.3921 (0.4722) acc 46.8750 (57.5142) kd_loss 1.2151 (1.1199) lr 1.8443e-03 eta 0:25:45
epoch [11/50] batch [240/319] time 0.085 (0.127) data 0.000 (0.002) loss 1.4016 (1.5636) ce_loss 1.1514 (1.1383) teacher_loss 0.9253 (1.0230) loss_zs_kd 0.7351 (0.6915) loss_oracle 0.4027 (0.4714) acc 53.1250 (57.6562) kd_loss 1.1725 (1.1219) lr 1.8443e-03 eta 0:26:26
epoch [11/50] batch [260/319] time 0.187 (0.130) data 0.000 (0.002) loss 1.7110 (1.5638) ce_loss 1.0781 (1.1376) teacher_loss 1.0591 (1.0213) loss_zs_kd 0.8286 (0.6972) loss_oracle 0.5691 (0.4728) acc 56.2500 (57.5000) kd_loss 1.0522 (1.1202) lr 1.8443e-03 eta 0:27:09
epoch [11/50] batch [280/319] time 0.085 (0.129) data 0.000 (0.002) loss 1.8176 (1.5651) ce_loss 1.2881 (1.1341) teacher_loss 1.2063 (1.0214) loss_zs_kd 0.5794 (0.6939) loss_oracle 0.5533 (0.4743) acc 53.1250 (57.7121) kd_loss 1.0004 (1.1146) lr 1.8443e-03 eta 0:26:55
epoch [11/50] batch [300/319] time 0.134 (0.129) data 0.000 (0.002) loss 2.1570 (1.5723) ce_loss 1.6895 (1.1380) teacher_loss 1.6042 (1.0270) loss_zs_kd 0.5703 (0.6883) loss_oracle 0.4958 (0.4765) acc 37.5000 (57.5208) kd_loss 1.0316 (1.1062) lr 1.8443e-03 eta 0:26:44
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,627
* accuracy: 60.0%
* error: 40.0%
* macro_f1: 53.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,311
* accuracy: 54.6%
* error: 45.4%
* macro_f1: 23.0%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      60.9%, epoch: 9 *******
******* Domain 2 best val test acc: 47.9%, epoch: 9 *******
******* Domain 2 best test acc:     54.6%, epoch: 11 *******
epoch [12/50] batch [20/319] time 0.142 (0.175) data 0.000 (0.026) loss 1.3767 (1.5385) ce_loss 1.0850 (1.1539) teacher_loss 0.8822 (0.9844) loss_zs_kd 0.6497 (0.7244) loss_oracle 0.4295 (0.4817) acc 56.2500 (57.0312) kd_loss 1.0936 (1.1040) lr 1.8090e-03 eta 0:36:14
epoch [12/50] batch [40/319] time 0.140 (0.162) data 0.000 (0.013) loss 1.2603 (1.5494) ce_loss 0.9819 (1.1574) teacher_loss 0.7494 (0.9969) loss_zs_kd 0.7085 (0.7169) loss_oracle 0.4401 (0.4808) acc 65.6250 (55.7031) kd_loss 1.0478 (1.0991) lr 1.8090e-03 eta 0:33:34
epoch [12/50] batch [60/319] time 0.166 (0.149) data 0.000 (0.009) loss 1.7023 (1.5783) ce_loss 1.2061 (1.1737) teacher_loss 1.1444 (1.0185) loss_zs_kd 0.6231 (0.7278) loss_oracle 0.4956 (0.4871) acc 56.2500 (55.8854) kd_loss 0.9028 (1.0760) lr 1.8090e-03 eta 0:30:47
epoch [12/50] batch [80/319] time 0.068 (0.153) data 0.000 (0.007) loss 1.4035 (1.5785) ce_loss 0.8726 (1.1575) teacher_loss 0.8250 (1.0151) loss_zs_kd 0.5921 (0.7182) loss_oracle 0.5193 (0.4916) acc 65.6250 (56.3672) kd_loss 0.7488 (1.0299) lr 1.8090e-03 eta 0:31:32
epoch [12/50] batch [100/319] time 0.192 (0.152) data 0.000 (0.005) loss 1.6624 (1.6095) ce_loss 1.2471 (1.1681) teacher_loss 1.1503 (1.0375) loss_zs_kd 0.6839 (0.6919) loss_oracle 0.4436 (0.5028) acc 56.2500 (56.1562) kd_loss 0.8338 (0.9907) lr 1.8090e-03 eta 0:31:21
epoch [12/50] batch [120/319] time 0.079 (0.149) data 0.000 (0.005) loss 1.7334 (1.6248) ce_loss 1.2275 (1.1697) teacher_loss 1.1845 (1.0526) loss_zs_kd 0.4786 (0.6675) loss_oracle 0.5010 (0.5054) acc 50.0000 (56.1458) kd_loss 0.8732 (0.9663) lr 1.8090e-03 eta 0:30:36
epoch [12/50] batch [140/319] time 0.137 (0.144) data 0.001 (0.004) loss 1.5596 (1.6104) ce_loss 1.1338 (1.1551) teacher_loss 1.0098 (1.0423) loss_zs_kd 0.6747 (0.6570) loss_oracle 0.4824 (0.5024) acc 71.8750 (56.9420) kd_loss 1.0507 (0.9644) lr 1.8090e-03 eta 0:29:34
epoch [12/50] batch [160/319] time 0.079 (0.139) data 0.000 (0.003) loss 1.5859 (1.6045) ce_loss 1.1504 (1.1466) teacher_loss 1.0746 (1.0411) loss_zs_kd 0.8178 (0.6545) loss_oracle 0.4295 (0.4980) acc 50.0000 (57.5195) kd_loss 1.0760 (0.9819) lr 1.8090e-03 eta 0:28:31
epoch [12/50] batch [180/319] time 0.121 (0.137) data 0.000 (0.003) loss 1.4186 (1.5934) ce_loss 1.1377 (1.1440) teacher_loss 0.8372 (1.0343) loss_zs_kd 0.6737 (0.6646) loss_oracle 0.5141 (0.4926) acc 62.5000 (57.7257) kd_loss 1.1764 (0.9985) lr 1.8090e-03 eta 0:28:02
epoch [12/50] batch [200/319] time 0.146 (0.138) data 0.000 (0.003) loss 1.7367 (1.5866) ce_loss 1.2617 (1.1428) teacher_loss 1.1205 (1.0287) loss_zs_kd 0.6653 (0.6686) loss_oracle 0.5496 (0.4910) acc 46.8750 (57.7656) kd_loss 1.0385 (1.0100) lr 1.8090e-03 eta 0:28:05
epoch [12/50] batch [220/319] time 0.090 (0.137) data 0.000 (0.003) loss 1.4794 (1.5812) ce_loss 0.9204 (1.1402) teacher_loss 0.9738 (1.0217) loss_zs_kd 0.6976 (0.6819) loss_oracle 0.4358 (0.4914) acc 56.2500 (57.7557) kd_loss 1.0682 (1.0233) lr 1.8090e-03 eta 0:27:53
epoch [12/50] batch [240/319] time 0.140 (0.137) data 0.000 (0.002) loss 1.5647 (1.5808) ce_loss 1.1318 (1.1396) teacher_loss 0.9460 (1.0185) loss_zs_kd 0.8667 (0.6928) loss_oracle 0.5320 (0.4930) acc 53.1250 (57.7083) kd_loss 1.1731 (1.0346) lr 1.8090e-03 eta 0:27:56
epoch [12/50] batch [260/319] time 0.150 (0.139) data 0.000 (0.002) loss 1.4994 (1.5718) ce_loss 1.0576 (1.1350) teacher_loss 0.9659 (1.0087) loss_zs_kd 0.7330 (0.6962) loss_oracle 0.4601 (0.4934) acc 62.5000 (57.9928) kd_loss 1.0918 (1.0469) lr 1.8090e-03 eta 0:28:07
epoch [12/50] batch [280/319] time 0.137 (0.139) data 0.000 (0.002) loss 1.5041 (1.5718) ce_loss 0.8325 (1.1354) teacher_loss 0.9197 (1.0078) loss_zs_kd 0.6202 (0.6971) loss_oracle 0.5224 (0.4943) acc 65.6250 (57.7344) kd_loss 1.0414 (1.0488) lr 1.8090e-03 eta 0:28:15
epoch [12/50] batch [300/319] time 0.102 (0.138) data 0.000 (0.002) loss 1.7106 (1.5708) ce_loss 1.2627 (1.1323) teacher_loss 1.2275 (1.0076) loss_zs_kd 0.6321 (0.6963) loss_oracle 0.4199 (0.4936) acc 50.0000 (57.7188) kd_loss 0.9109 (1.0481) lr 1.8090e-03 eta 0:27:52
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,778
* accuracy: 63.5%
* error: 36.5%
* macro_f1: 55.0%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,039
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 23.2%
******* Domain 2 best val acc:      63.5%, epoch: 12 *******
******* Domain 2 best val test acc: 51.8%, epoch: 12 *******
******* Domain 2 best test acc:     54.6%, epoch: 11 *******
epoch [13/50] batch [20/319] time 0.142 (0.176) data 0.000 (0.025) loss 1.6959 (1.7102) ce_loss 1.1182 (1.1902) teacher_loss 1.0900 (1.1081) loss_zs_kd 0.7054 (0.6432) loss_oracle 0.5354 (0.5378) acc 53.1250 (57.6562) kd_loss 0.7533 (0.8753) lr 1.7705e-03 eta 0:35:26
epoch [13/50] batch [40/319] time 0.153 (0.163) data 0.000 (0.012) loss 1.8601 (1.5995) ce_loss 1.4043 (1.1163) teacher_loss 1.3068 (1.0250) loss_zs_kd 0.6462 (0.6384) loss_oracle 0.4887 (0.5106) acc 50.0000 (58.8281) kd_loss 1.0613 (0.9192) lr 1.7705e-03 eta 0:32:55
epoch [13/50] batch [60/319] time 0.152 (0.160) data 0.000 (0.008) loss 1.8280 (1.6027) ce_loss 1.4014 (1.1376) teacher_loss 1.3266 (1.0296) loss_zs_kd 0.7161 (0.6562) loss_oracle 0.4298 (0.5075) acc 46.8750 (57.8125) kd_loss 1.0450 (0.9631) lr 1.7705e-03 eta 0:32:10
epoch [13/50] batch [80/319] time 0.098 (0.152) data 0.000 (0.006) loss 1.4140 (1.5897) ce_loss 0.8857 (1.1441) teacher_loss 0.8668 (1.0256) loss_zs_kd 0.6595 (0.6758) loss_oracle 0.4812 (0.4965) acc 75.0000 (57.3438) kd_loss 1.1764 (1.0061) lr 1.7705e-03 eta 0:30:29
epoch [13/50] batch [100/319] time 0.087 (0.144) data 0.000 (0.005) loss 1.6762 (1.5879) ce_loss 1.1523 (1.1418) teacher_loss 1.0757 (1.0310) loss_zs_kd 0.6376 (0.6748) loss_oracle 0.5368 (0.4894) acc 53.1250 (57.3438) kd_loss 1.1226 (1.0236) lr 1.7705e-03 eta 0:28:56
epoch [13/50] batch [120/319] time 0.098 (0.139) data 0.000 (0.004) loss 1.5892 (1.5807) ce_loss 1.1455 (1.1353) teacher_loss 0.9987 (1.0284) loss_zs_kd 0.5609 (0.6727) loss_oracle 0.5345 (0.4850) acc 40.6250 (57.4219) kd_loss 1.1084 (1.0343) lr 1.7705e-03 eta 0:27:48
epoch [13/50] batch [140/319] time 0.134 (0.136) data 0.000 (0.004) loss 1.8820 (1.5790) ce_loss 1.3965 (1.1349) teacher_loss 1.3623 (1.0285) loss_zs_kd 0.6777 (0.6693) loss_oracle 0.4520 (0.4836) acc 46.8750 (57.5446) kd_loss 1.0543 (1.0428) lr 1.7705e-03 eta 0:27:12
epoch [13/50] batch [160/319] time 0.136 (0.136) data 0.000 (0.003) loss 1.7188 (1.5765) ce_loss 1.2656 (1.1349) teacher_loss 1.1485 (1.0223) loss_zs_kd 0.7952 (0.6705) loss_oracle 0.4909 (0.4872) acc 56.2500 (57.6562) kd_loss 1.0285 (1.0499) lr 1.7705e-03 eta 0:27:00
epoch [13/50] batch [180/319] time 0.125 (0.134) data 0.000 (0.003) loss 1.3959 (1.5933) ce_loss 0.9160 (1.1395) teacher_loss 0.8703 (1.0302) loss_zs_kd 0.6330 (0.6735) loss_oracle 0.4623 (0.4958) acc 62.5000 (57.7083) kd_loss 1.0540 (1.0468) lr 1.7705e-03 eta 0:26:42
epoch [13/50] batch [200/319] time 0.100 (0.133) data 0.000 (0.003) loss 1.8139 (1.6002) ce_loss 1.2998 (1.1424) teacher_loss 1.1963 (1.0339) loss_zs_kd 0.6047 (0.6721) loss_oracle 0.5571 (0.4991) acc 50.0000 (57.4375) kd_loss 1.0202 (1.0437) lr 1.7705e-03 eta 0:26:23
epoch [13/50] batch [220/319] time 0.124 (0.132) data 0.000 (0.002) loss 1.7199 (1.5971) ce_loss 1.2109 (1.1362) teacher_loss 1.2510 (1.0288) loss_zs_kd 0.7360 (0.6730) loss_oracle 0.3953 (0.5010) acc 53.1250 (57.6420) kd_loss 1.1404 (1.0458) lr 1.7705e-03 eta 0:26:07
epoch [13/50] batch [240/319] time 0.153 (0.133) data 0.000 (0.002) loss 1.2444 (1.5983) ce_loss 0.9434 (1.1385) teacher_loss 0.6991 (1.0286) loss_zs_kd 0.7759 (0.6825) loss_oracle 0.4678 (0.5014) acc 71.8750 (57.5260) kd_loss 0.9877 (1.0498) lr 1.7705e-03 eta 0:26:19
epoch [13/50] batch [260/319] time 0.109 (0.132) data 0.000 (0.002) loss 1.4888 (1.5951) ce_loss 1.2891 (1.1410) teacher_loss 0.9401 (1.0230) loss_zs_kd 0.8302 (0.6875) loss_oracle 0.4657 (0.5033) acc 31.2500 (57.3317) kd_loss 1.2238 (1.0552) lr 1.7705e-03 eta 0:26:06
epoch [13/50] batch [280/319] time 0.077 (0.130) data 0.000 (0.002) loss 1.3817 (1.5897) ce_loss 0.9912 (1.1419) teacher_loss 0.9531 (1.0180) loss_zs_kd 0.8689 (0.6932) loss_oracle 0.3417 (0.5024) acc 59.3750 (57.2879) kd_loss 0.9555 (1.0621) lr 1.7705e-03 eta 0:25:43
epoch [13/50] batch [300/319] time 0.111 (0.129) data 0.000 (0.002) loss 1.5661 (1.5839) ce_loss 1.2051 (1.1407) teacher_loss 0.9780 (1.0129) loss_zs_kd 0.8121 (0.6959) loss_oracle 0.5069 (0.5014) acc 50.0000 (57.2500) kd_loss 1.2266 (1.0697) lr 1.7705e-03 eta 0:25:25
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,657
* accuracy: 60.7%
* error: 39.3%
* macro_f1: 52.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,299
* accuracy: 54.4%
* error: 45.6%
* macro_f1: 23.2%
******* Domain 2 best val acc:      63.5%, epoch: 12 *******
******* Domain 2 best val test acc: 51.8%, epoch: 12 *******
******* Domain 2 best test acc:     54.6%, epoch: 11 *******
epoch [14/50] batch [20/319] time 0.160 (0.176) data 0.000 (0.028) loss 1.4852 (1.5522) ce_loss 1.1523 (1.1706) teacher_loss 0.9081 (1.0005) loss_zs_kd 0.9059 (0.6977) loss_oracle 0.4866 (0.4819) acc 62.5000 (54.2188) kd_loss 1.2991 (1.2021) lr 1.7290e-03 eta 0:34:35
epoch [14/50] batch [40/319] time 0.155 (0.164) data 0.000 (0.014) loss 1.5927 (1.5220) ce_loss 0.9961 (1.1651) teacher_loss 1.0539 (0.9715) loss_zs_kd 0.6976 (0.7572) loss_oracle 0.4690 (0.4747) acc 65.6250 (54.2969) kd_loss 1.2256 (1.1945) lr 1.7290e-03 eta 0:32:14
epoch [14/50] batch [60/319] time 0.131 (0.156) data 0.000 (0.010) loss 1.4116 (1.5221) ce_loss 1.0449 (1.1697) teacher_loss 0.8635 (0.9808) loss_zs_kd 1.0451 (0.7575) loss_oracle 0.4436 (0.4655) acc 59.3750 (54.2188) kd_loss 1.1407 (1.1735) lr 1.7290e-03 eta 0:30:29
epoch [14/50] batch [80/319] time 0.132 (0.152) data 0.000 (0.007) loss 1.7579 (1.5217) ce_loss 1.3711 (1.1628) teacher_loss 1.1830 (0.9796) loss_zs_kd 0.8423 (0.7524) loss_oracle 0.4907 (0.4668) acc 50.0000 (54.7266) kd_loss 0.9938 (1.1459) lr 1.7290e-03 eta 0:29:36
epoch [14/50] batch [100/319] time 0.081 (0.141) data 0.000 (0.006) loss 1.3563 (1.5458) ce_loss 0.9473 (1.1620) teacher_loss 0.7843 (0.9979) loss_zs_kd 0.6533 (0.7467) loss_oracle 0.5066 (0.4732) acc 59.3750 (54.7812) kd_loss 0.9377 (1.1050) lr 1.7290e-03 eta 0:27:29
epoch [14/50] batch [120/319] time 0.099 (0.134) data 0.000 (0.005) loss 1.4573 (1.5520) ce_loss 1.0146 (1.1555) teacher_loss 0.9040 (0.9988) loss_zs_kd 0.7765 (0.7397) loss_oracle 0.4757 (0.4792) acc 68.7500 (55.2344) kd_loss 0.8901 (1.0738) lr 1.7290e-03 eta 0:26:02
epoch [14/50] batch [140/319] time 0.141 (0.136) data 0.000 (0.004) loss 1.7564 (1.5552) ce_loss 1.3877 (1.1509) teacher_loss 1.1287 (0.9974) loss_zs_kd 0.7916 (0.7366) loss_oracle 0.5486 (0.4841) acc 56.2500 (55.6473) kd_loss 1.0459 (1.0552) lr 1.7290e-03 eta 0:26:24
epoch [14/50] batch [160/319] time 0.155 (0.137) data 0.000 (0.004) loss 1.6957 (1.5597) ce_loss 1.2139 (1.1541) teacher_loss 1.1711 (1.0028) loss_zs_kd 0.7225 (0.7424) loss_oracle 0.4523 (0.4826) acc 56.2500 (55.6641) kd_loss 1.0658 (1.0580) lr 1.7290e-03 eta 0:26:35
epoch [14/50] batch [180/319] time 0.174 (0.134) data 0.000 (0.003) loss 1.4362 (1.5539) ce_loss 1.0645 (1.1492) teacher_loss 0.8460 (0.9972) loss_zs_kd 0.7248 (0.7484) loss_oracle 0.5178 (0.4818) acc 53.1250 (56.0938) kd_loss 0.9780 (1.0568) lr 1.7290e-03 eta 0:25:53
epoch [14/50] batch [200/319] time 0.074 (0.137) data 0.000 (0.003) loss 1.4526 (1.5508) ce_loss 1.0020 (1.1444) teacher_loss 0.8924 (0.9943) loss_zs_kd 0.8766 (0.7525) loss_oracle 0.4726 (0.4813) acc 62.5000 (56.3906) kd_loss 1.0234 (1.0559) lr 1.7290e-03 eta 0:26:26
epoch [14/50] batch [220/319] time 0.190 (0.138) data 0.000 (0.003) loss 1.3866 (1.5489) ce_loss 1.1094 (1.1436) teacher_loss 0.9177 (0.9937) loss_zs_kd 0.6323 (0.7482) loss_oracle 0.4056 (0.4805) acc 56.2500 (56.5057) kd_loss 1.1541 (1.0535) lr 1.7290e-03 eta 0:26:44
epoch [14/50] batch [240/319] time 0.087 (0.138) data 0.000 (0.003) loss 1.4418 (1.5439) ce_loss 1.1084 (1.1407) teacher_loss 0.9328 (0.9898) loss_zs_kd 0.7909 (0.7442) loss_oracle 0.4300 (0.4797) acc 62.5000 (56.6016) kd_loss 0.9189 (1.0511) lr 1.7290e-03 eta 0:26:32
epoch [14/50] batch [260/319] time 0.084 (0.136) data 0.000 (0.002) loss 1.3145 (1.5396) ce_loss 0.9893 (1.1383) teacher_loss 0.7729 (0.9857) loss_zs_kd 0.7075 (0.7417) loss_oracle 0.4709 (0.4798) acc 65.6250 (56.6827) kd_loss 1.0336 (1.0552) lr 1.7290e-03 eta 0:26:07
epoch [14/50] batch [280/319] time 0.137 (0.134) data 0.000 (0.002) loss 1.3437 (1.5338) ce_loss 1.1631 (1.1367) teacher_loss 0.8724 (0.9817) loss_zs_kd 0.7075 (0.7441) loss_oracle 0.4005 (0.4777) acc 59.3750 (56.8304) kd_loss 1.1669 (1.0600) lr 1.7290e-03 eta 0:25:49
epoch [14/50] batch [300/319] time 0.080 (0.134) data 0.000 (0.002) loss 1.5269 (1.5299) ce_loss 1.2080 (1.1358) teacher_loss 0.9269 (0.9780) loss_zs_kd 0.7700 (0.7464) loss_oracle 0.5230 (0.4772) acc 50.0000 (56.9062) kd_loss 1.0450 (1.0624) lr 1.7290e-03 eta 0:25:36
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,641
* accuracy: 60.3%
* error: 39.7%
* macro_f1: 52.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,157
* accuracy: 53.0%
* error: 47.0%
* macro_f1: 22.7%
******* Domain 2 best val acc:      63.5%, epoch: 12 *******
******* Domain 2 best val test acc: 51.8%, epoch: 12 *******
******* Domain 2 best test acc:     54.6%, epoch: 11 *******
epoch [15/50] batch [20/319] time 0.142 (0.175) data 0.000 (0.024) loss 1.7154 (1.5524) ce_loss 1.4473 (1.1541) teacher_loss 1.2032 (0.9919) loss_zs_kd 0.6955 (0.7309) loss_oracle 0.4426 (0.4873) acc 40.6250 (56.8750) kd_loss 1.1417 (1.0450) lr 1.6845e-03 eta 0:33:31
epoch [15/50] batch [40/319] time 0.177 (0.154) data 0.000 (0.012) loss 1.2736 (1.5283) ce_loss 1.0283 (1.1314) teacher_loss 0.7429 (0.9582) loss_zs_kd 0.6569 (0.7503) loss_oracle 0.4650 (0.4950) acc 56.2500 (57.4219) kd_loss 0.9171 (1.0203) lr 1.6845e-03 eta 0:29:23
epoch [15/50] batch [60/319] time 0.069 (0.150) data 0.000 (0.008) loss 1.5704 (1.5363) ce_loss 1.2773 (1.1346) teacher_loss 1.0429 (0.9690) loss_zs_kd 0.8992 (0.7613) loss_oracle 0.4376 (0.4912) acc 46.8750 (57.0312) kd_loss 0.9645 (1.0198) lr 1.6845e-03 eta 0:28:38
epoch [15/50] batch [80/319] time 0.189 (0.159) data 0.000 (0.006) loss 1.4413 (1.5523) ce_loss 0.9614 (1.1334) teacher_loss 0.8536 (0.9813) loss_zs_kd 0.6426 (0.7522) loss_oracle 0.5235 (0.4958) acc 56.2500 (57.2266) kd_loss 0.9910 (0.9976) lr 1.6845e-03 eta 0:30:09
epoch [15/50] batch [100/319] time 0.090 (0.149) data 0.000 (0.005) loss 1.5796 (1.5540) ce_loss 1.0361 (1.1244) teacher_loss 1.0689 (0.9855) loss_zs_kd 0.5035 (0.7329) loss_oracle 0.4603 (0.4952) acc 59.3750 (57.7812) kd_loss 0.9101 (0.9765) lr 1.6845e-03 eta 0:28:15
epoch [15/50] batch [120/319] time 0.081 (0.140) data 0.000 (0.004) loss 1.2407 (1.5516) ce_loss 0.9590 (1.1249) teacher_loss 0.7249 (0.9870) loss_zs_kd 0.7162 (0.7203) loss_oracle 0.4442 (0.4925) acc 65.6250 (57.7604) kd_loss 1.1787 (0.9814) lr 1.6845e-03 eta 0:26:35
epoch [15/50] batch [140/319] time 0.082 (0.135) data 0.000 (0.004) loss 1.5811 (1.5463) ce_loss 1.2236 (1.1246) teacher_loss 1.0111 (0.9847) loss_zs_kd 0.9926 (0.7318) loss_oracle 0.4707 (0.4884) acc 62.5000 (57.9911) kd_loss 1.2060 (1.0067) lr 1.6845e-03 eta 0:25:35
epoch [15/50] batch [160/319] time 0.141 (0.132) data 0.000 (0.003) loss 1.1978 (1.5410) ce_loss 0.9556 (1.1190) teacher_loss 0.6961 (0.9803) loss_zs_kd 0.7061 (0.7336) loss_oracle 0.4312 (0.4874) acc 75.0000 (58.2812) kd_loss 1.2138 (1.0232) lr 1.6845e-03 eta 0:24:49
epoch [15/50] batch [180/319] time 0.088 (0.129) data 0.000 (0.003) loss 1.5814 (1.5307) ce_loss 1.1104 (1.1073) teacher_loss 1.0951 (0.9695) loss_zs_kd 0.6257 (0.7325) loss_oracle 0.4237 (0.4879) acc 62.5000 (58.6979) kd_loss 1.0143 (1.0238) lr 1.6845e-03 eta 0:24:21
epoch [15/50] batch [200/319] time 0.096 (0.127) data 0.000 (0.003) loss 1.6342 (1.5436) ce_loss 1.3740 (1.1200) teacher_loss 1.1406 (0.9798) loss_zs_kd 0.7234 (0.7351) loss_oracle 0.4213 (0.4902) acc 53.1250 (58.2188) kd_loss 1.1345 (1.0293) lr 1.6845e-03 eta 0:23:53
epoch [15/50] batch [220/319] time 0.108 (0.126) data 0.000 (0.002) loss 1.6529 (1.5455) ce_loss 1.1836 (1.1226) teacher_loss 1.1199 (0.9818) loss_zs_kd 0.7133 (0.7353) loss_oracle 0.4617 (0.4901) acc 56.2500 (57.9403) kd_loss 0.9757 (1.0276) lr 1.6845e-03 eta 0:23:34
epoch [15/50] batch [240/319] time 0.089 (0.124) data 0.000 (0.002) loss 1.5484 (1.5488) ce_loss 1.0566 (1.1215) teacher_loss 0.9314 (0.9854) loss_zs_kd 0.6881 (0.7300) loss_oracle 0.5482 (0.4904) acc 68.7500 (58.1771) kd_loss 0.9036 (1.0167) lr 1.6845e-03 eta 0:23:18
epoch [15/50] batch [260/319] time 0.106 (0.123) data 0.000 (0.002) loss 1.6186 (1.5568) ce_loss 1.1074 (1.1271) teacher_loss 1.0705 (0.9940) loss_zs_kd 0.6375 (0.7252) loss_oracle 0.4844 (0.4902) acc 43.7500 (57.9087) kd_loss 1.1397 (1.0139) lr 1.6845e-03 eta 0:22:59
epoch [15/50] batch [280/319] time 0.109 (0.122) data 0.000 (0.002) loss 1.4445 (1.5576) ce_loss 1.0811 (1.1310) teacher_loss 0.7914 (0.9956) loss_zs_kd 0.7788 (0.7227) loss_oracle 0.5752 (0.4897) acc 62.5000 (57.7455) kd_loss 1.0970 (1.0217) lr 1.6845e-03 eta 0:22:43
epoch [15/50] batch [300/319] time 0.095 (0.120) data 0.000 (0.002) loss 1.6269 (1.5530) ce_loss 1.1963 (1.1293) teacher_loss 1.0372 (0.9914) loss_zs_kd 0.8240 (0.7250) loss_oracle 0.5074 (0.4891) acc 56.2500 (57.9479) kd_loss 1.0760 (1.0312) lr 1.6845e-03 eta 0:22:27
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,633
* accuracy: 60.1%
* error: 39.9%
* macro_f1: 54.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,351
* accuracy: 55.0%
* error: 45.0%
* macro_f1: 24.1%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      63.5%, epoch: 12 *******
******* Domain 2 best val test acc: 51.8%, epoch: 12 *******
******* Domain 2 best test acc:     55.0%, epoch: 15 *******
epoch [16/50] batch [20/319] time 0.077 (0.104) data 0.000 (0.025) loss 1.2096 (1.4976) ce_loss 0.9019 (1.1567) teacher_loss 0.6924 (0.9464) loss_zs_kd 0.8002 (0.7790) loss_oracle 0.4372 (0.4733) acc 59.3750 (55.9375) kd_loss 1.1948 (1.1359) lr 1.6374e-03 eta 0:19:20
epoch [16/50] batch [40/319] time 0.064 (0.089) data 0.000 (0.012) loss 1.8274 (1.5055) ce_loss 1.3242 (1.1487) teacher_loss 1.2780 (0.9443) loss_zs_kd 0.8256 (0.8152) loss_oracle 0.4669 (0.4797) acc 53.1250 (56.4062) kd_loss 1.1697 (1.1497) lr 1.6374e-03 eta 0:16:33
epoch [16/50] batch [60/319] time 0.083 (0.085) data 0.000 (0.008) loss 1.3097 (1.5143) ce_loss 0.9033 (1.1437) teacher_loss 0.7875 (0.9546) loss_zs_kd 0.7145 (0.7899) loss_oracle 0.4508 (0.4807) acc 71.8750 (56.6667) kd_loss 1.2690 (1.1788) lr 1.6374e-03 eta 0:15:44
epoch [16/50] batch [80/319] time 0.084 (0.083) data 0.000 (0.006) loss 1.4882 (1.5209) ce_loss 1.0615 (1.1442) teacher_loss 0.9343 (0.9584) loss_zs_kd 0.8118 (0.7781) loss_oracle 0.4727 (0.4847) acc 59.3750 (57.3828) kd_loss 1.1602 (1.1697) lr 1.6374e-03 eta 0:15:25
epoch [16/50] batch [100/319] time 0.063 (0.083) data 0.000 (0.005) loss 1.3913 (1.5248) ce_loss 1.1816 (1.1491) teacher_loss 0.8725 (0.9607) loss_zs_kd 0.6920 (0.7783) loss_oracle 0.4495 (0.4863) acc 53.1250 (57.0000) kd_loss 1.1102 (1.1551) lr 1.6374e-03 eta 0:15:18
epoch [16/50] batch [120/319] time 0.141 (0.084) data 0.000 (0.004) loss 1.4705 (1.5182) ce_loss 1.0166 (1.1464) teacher_loss 0.9426 (0.9531) loss_zs_kd 0.8902 (0.7847) loss_oracle 0.4389 (0.4866) acc 68.7500 (57.0833) kd_loss 1.2258 (1.1539) lr 1.6374e-03 eta 0:15:30
epoch [16/50] batch [140/319] time 0.089 (0.088) data 0.000 (0.004) loss 1.4107 (1.5339) ce_loss 0.9561 (1.1560) teacher_loss 0.7524 (0.9674) loss_zs_kd 0.8043 (0.7798) loss_oracle 0.5780 (0.4885) acc 71.8750 (56.5402) kd_loss 1.1856 (1.1539) lr 1.6374e-03 eta 0:16:08
epoch [16/50] batch [160/319] time 0.141 (0.096) data 0.000 (0.003) loss 1.2609 (1.5403) ce_loss 0.9932 (1.1595) teacher_loss 0.7479 (0.9713) loss_zs_kd 0.7797 (0.7778) loss_oracle 0.4351 (0.4913) acc 65.6250 (56.4258) kd_loss 1.2004 (1.1462) lr 1.6374e-03 eta 0:17:31
epoch [16/50] batch [180/319] time 0.153 (0.102) data 0.000 (0.003) loss 1.5862 (1.5374) ce_loss 1.1143 (1.1523) teacher_loss 1.0410 (0.9688) loss_zs_kd 0.7614 (0.7786) loss_oracle 0.4690 (0.4907) acc 56.2500 (56.7535) kd_loss 1.3471 (1.1522) lr 1.6374e-03 eta 0:18:38
epoch [16/50] batch [200/319] time 0.092 (0.106) data 0.000 (0.003) loss 1.4963 (1.5362) ce_loss 1.2686 (1.1571) teacher_loss 1.0107 (0.9663) loss_zs_kd 0.6940 (0.7792) loss_oracle 0.4162 (0.4920) acc 53.1250 (56.5156) kd_loss 1.1096 (1.1587) lr 1.6374e-03 eta 0:19:27
epoch [16/50] batch [220/319] time 0.100 (0.106) data 0.000 (0.002) loss 1.4862 (1.5403) ce_loss 1.0615 (1.1570) teacher_loss 0.9128 (0.9715) loss_zs_kd 0.6661 (0.7748) loss_oracle 0.5068 (0.4913) acc 46.8750 (56.5767) kd_loss 1.0929 (1.1597) lr 1.6374e-03 eta 0:19:22
epoch [16/50] batch [240/319] time 0.110 (0.105) data 0.000 (0.002) loss 1.5311 (1.5434) ce_loss 1.0615 (1.1576) teacher_loss 0.8897 (0.9723) loss_zs_kd 0.9309 (0.7720) loss_oracle 0.5483 (0.4939) acc 68.7500 (56.6667) kd_loss 1.1953 (1.1618) lr 1.6374e-03 eta 0:19:06
epoch [16/50] batch [260/319] time 0.132 (0.105) data 0.000 (0.002) loss 1.5268 (1.5446) ce_loss 1.0322 (1.1575) teacher_loss 0.9513 (0.9721) loss_zs_kd 0.7581 (0.7683) loss_oracle 0.4997 (0.4956) acc 53.1250 (56.5385) kd_loss 1.1006 (1.1623) lr 1.6374e-03 eta 0:19:02
epoch [16/50] batch [280/319] time 0.101 (0.105) data 0.000 (0.002) loss 1.7093 (1.5482) ce_loss 1.4492 (1.1620) teacher_loss 1.1063 (0.9732) loss_zs_kd 0.7617 (0.7682) loss_oracle 0.5268 (0.4982) acc 43.7500 (56.2054) kd_loss 1.2137 (1.1599) lr 1.6374e-03 eta 0:19:03
epoch [16/50] batch [300/319] time 0.098 (0.105) data 0.000 (0.002) loss 1.6888 (1.5488) ce_loss 1.0693 (1.1578) teacher_loss 1.0363 (0.9698) loss_zs_kd 0.8113 (0.7702) loss_oracle 0.5713 (0.5019) acc 56.2500 (56.3646) kd_loss 0.8884 (1.1560) lr 1.6374e-03 eta 0:18:57
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,750
* accuracy: 62.8%
* error: 37.2%
* macro_f1: 53.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,111
* accuracy: 52.5%
* error: 47.5%
* macro_f1: 21.9%
******* Domain 2 best val acc:      63.5%, epoch: 12 *******
******* Domain 2 best val test acc: 51.8%, epoch: 12 *******
******* Domain 2 best test acc:     55.0%, epoch: 15 *******
epoch [17/50] batch [20/319] time 0.137 (0.153) data 0.000 (0.032) loss 1.4500 (1.4829) ce_loss 0.8960 (1.0563) teacher_loss 0.7670 (0.8693) loss_zs_kd 1.0712 (0.7614) loss_oracle 0.5759 (0.5375) acc 68.7500 (59.0625) kd_loss 1.0312 (1.0068) lr 1.5878e-03 eta 0:27:40
epoch [17/50] batch [40/319] time 0.152 (0.147) data 0.000 (0.016) loss 1.7043 (1.5265) ce_loss 1.1729 (1.0859) teacher_loss 1.0584 (0.9152) loss_zs_kd 0.7753 (0.7696) loss_oracle 0.5683 (0.5343) acc 59.3750 (59.1406) kd_loss 1.1438 (1.0337) lr 1.5878e-03 eta 0:26:27
epoch [17/50] batch [60/319] time 0.161 (0.149) data 0.000 (0.011) loss 1.9289 (1.5468) ce_loss 1.3916 (1.0916) teacher_loss 1.3436 (0.9347) loss_zs_kd 0.6807 (0.7565) loss_oracle 0.5172 (0.5364) acc 56.2500 (60.0000) kd_loss 0.9774 (1.0296) lr 1.5878e-03 eta 0:26:47
epoch [17/50] batch [80/319] time 0.103 (0.141) data 0.000 (0.008) loss 1.2764 (1.5322) ce_loss 0.9810 (1.0892) teacher_loss 0.7186 (0.9305) loss_zs_kd 0.8447 (0.7576) loss_oracle 0.4733 (0.5260) acc 50.0000 (59.1406) kd_loss 1.1261 (1.0293) lr 1.5878e-03 eta 0:25:13
epoch [17/50] batch [100/319] time 0.097 (0.132) data 0.000 (0.006) loss 1.7166 (1.5396) ce_loss 1.2080 (1.1027) teacher_loss 1.1480 (0.9433) loss_zs_kd 0.9735 (0.7594) loss_oracle 0.4712 (0.5203) acc 56.2500 (58.4062) kd_loss 1.0746 (1.0339) lr 1.5878e-03 eta 0:23:33
epoch [17/50] batch [120/319] time 0.115 (0.128) data 0.000 (0.005) loss 1.4297 (1.5478) ce_loss 1.0205 (1.1168) teacher_loss 0.8962 (0.9554) loss_zs_kd 0.7888 (0.7524) loss_oracle 0.4546 (0.5172) acc 43.7500 (58.0469) kd_loss 1.1447 (1.0338) lr 1.5878e-03 eta 0:22:51
epoch [17/50] batch [140/319] time 0.160 (0.129) data 0.000 (0.005) loss 1.7645 (1.5521) ce_loss 1.3584 (1.1227) teacher_loss 1.1416 (0.9612) loss_zs_kd 0.7600 (0.7546) loss_oracle 0.5469 (0.5155) acc 46.8750 (57.9688) kd_loss 1.1373 (1.0476) lr 1.5878e-03 eta 0:22:56
epoch [17/50] batch [160/319] time 0.142 (0.131) data 0.000 (0.004) loss 1.2482 (1.5550) ce_loss 0.7837 (1.1197) teacher_loss 0.6971 (0.9605) loss_zs_kd 0.6838 (0.7507) loss_oracle 0.4828 (0.5194) acc 81.2500 (58.4180) kd_loss 1.0751 (1.0577) lr 1.5878e-03 eta 0:23:23
epoch [17/50] batch [180/319] time 0.157 (0.134) data 0.001 (0.004) loss 1.3675 (1.5556) ce_loss 0.9399 (1.1206) teacher_loss 0.7510 (0.9619) loss_zs_kd 0.8193 (0.7538) loss_oracle 0.5345 (0.5183) acc 59.3750 (58.1944) kd_loss 1.0663 (1.0652) lr 1.5878e-03 eta 0:23:44
epoch [17/50] batch [200/319] time 0.158 (0.135) data 0.000 (0.003) loss 1.2686 (1.5630) ce_loss 0.8823 (1.1233) teacher_loss 0.7265 (0.9694) loss_zs_kd 0.7320 (0.7527) loss_oracle 0.4689 (0.5184) acc 62.5000 (57.9688) kd_loss 1.1334 (1.0687) lr 1.5878e-03 eta 0:24:01
epoch [17/50] batch [220/319] time 0.164 (0.137) data 0.000 (0.003) loss 1.7923 (1.5740) ce_loss 0.9819 (1.1292) teacher_loss 1.2091 (0.9834) loss_zs_kd 0.8759 (0.7478) loss_oracle 0.4956 (0.5158) acc 65.6250 (57.6847) kd_loss 1.1373 (1.0699) lr 1.5878e-03 eta 0:24:16
epoch [17/50] batch [240/319] time 0.152 (0.138) data 0.001 (0.003) loss 1.6539 (1.5678) ce_loss 1.2998 (1.1294) teacher_loss 0.9703 (0.9797) loss_zs_kd 0.8975 (0.7455) loss_oracle 0.5939 (0.5136) acc 50.0000 (57.6432) kd_loss 1.2932 (1.0783) lr 1.5878e-03 eta 0:24:25
epoch [17/50] batch [260/319] time 0.114 (0.137) data 0.000 (0.003) loss 1.6423 (1.5663) ce_loss 1.3447 (1.1334) teacher_loss 1.0943 (0.9782) loss_zs_kd 0.8777 (0.7495) loss_oracle 0.4602 (0.5132) acc 46.8750 (57.4880) kd_loss 1.2169 (1.0919) lr 1.5878e-03 eta 0:24:10
epoch [17/50] batch [280/319] time 0.159 (0.137) data 0.000 (0.002) loss 1.2121 (1.5656) ce_loss 0.7988 (1.1354) teacher_loss 0.6281 (0.9783) loss_zs_kd 0.7686 (0.7499) loss_oracle 0.5071 (0.5124) acc 75.0000 (57.2879) kd_loss 1.2539 (1.1034) lr 1.5878e-03 eta 0:24:06
epoch [17/50] batch [300/319] time 0.075 (0.137) data 0.000 (0.002) loss 1.5948 (1.5652) ce_loss 1.1250 (1.1346) teacher_loss 1.0096 (0.9797) loss_zs_kd 0.7622 (0.7484) loss_oracle 0.5090 (0.5106) acc 59.3750 (57.3750) kd_loss 1.1462 (1.1107) lr 1.5878e-03 eta 0:24:06
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,589
* accuracy: 59.1%
* error: 40.9%
* macro_f1: 53.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,108
* accuracy: 52.5%
* error: 47.5%
* macro_f1: 23.1%
******* Domain 2 best val acc:      63.5%, epoch: 12 *******
******* Domain 2 best val test acc: 51.8%, epoch: 12 *******
******* Domain 2 best test acc:     55.0%, epoch: 15 *******
epoch [18/50] batch [20/319] time 0.115 (0.161) data 0.000 (0.024) loss 1.5557 (1.5157) ce_loss 1.0625 (1.1366) teacher_loss 0.9671 (0.9569) loss_zs_kd 0.6729 (0.7286) loss_oracle 0.5213 (0.4859) acc 59.3750 (55.0000) kd_loss 1.0410 (1.1085) lr 1.5358e-03 eta 0:28:13
epoch [18/50] batch [40/319] time 0.091 (0.134) data 0.000 (0.012) loss 1.5407 (1.5335) ce_loss 0.9985 (1.1227) teacher_loss 0.9356 (0.9680) loss_zs_kd 0.7216 (0.7213) loss_oracle 0.5329 (0.4934) acc 53.1250 (57.3438) kd_loss 1.0493 (1.1056) lr 1.5358e-03 eta 0:23:24
epoch [18/50] batch [60/319] time 0.089 (0.127) data 0.000 (0.008) loss 1.5390 (1.5492) ce_loss 1.0723 (1.1095) teacher_loss 0.9934 (0.9797) loss_zs_kd 0.6776 (0.7037) loss_oracle 0.4778 (0.4991) acc 59.3750 (58.3333) kd_loss 0.8918 (1.0541) lr 1.5358e-03 eta 0:22:04
epoch [18/50] batch [80/319] time 0.158 (0.124) data 0.000 (0.006) loss 1.3557 (1.5634) ce_loss 0.9062 (1.1129) teacher_loss 0.8484 (0.9926) loss_zs_kd 0.7526 (0.6940) loss_oracle 0.4321 (0.5014) acc 62.5000 (58.4375) kd_loss 0.9522 (1.0313) lr 1.5358e-03 eta 0:21:34
epoch [18/50] batch [100/319] time 0.113 (0.124) data 0.000 (0.005) loss 1.3407 (1.5539) ce_loss 0.9204 (1.1129) teacher_loss 0.7564 (0.9843) loss_zs_kd 0.7378 (0.7006) loss_oracle 0.5105 (0.4996) acc 59.3750 (58.5312) kd_loss 1.2853 (1.0514) lr 1.5358e-03 eta 0:21:34
epoch [18/50] batch [120/319] time 0.132 (0.121) data 0.000 (0.004) loss 1.4667 (1.5583) ce_loss 1.2363 (1.1215) teacher_loss 0.9688 (0.9859) loss_zs_kd 1.0246 (0.7199) loss_oracle 0.3955 (0.5004) acc 50.0000 (58.2552) kd_loss 1.0982 (1.0655) lr 1.5358e-03 eta 0:20:55
epoch [18/50] batch [140/319] time 0.110 (0.119) data 0.000 (0.004) loss 1.3461 (1.5499) ce_loss 1.1094 (1.1219) teacher_loss 0.6947 (0.9799) loss_zs_kd 0.7806 (0.7230) loss_oracle 0.5733 (0.4977) acc 59.3750 (58.1920) kd_loss 1.2756 (1.0794) lr 1.5358e-03 eta 0:20:32
epoch [18/50] batch [160/319] time 0.078 (0.117) data 0.000 (0.003) loss 1.5091 (1.5555) ce_loss 1.3398 (1.1308) teacher_loss 0.9750 (0.9845) loss_zs_kd 0.7551 (0.7240) loss_oracle 0.4586 (0.4986) acc 37.5000 (57.7148) kd_loss 1.1947 (1.0865) lr 1.5358e-03 eta 0:20:11
epoch [18/50] batch [180/319] time 0.086 (0.116) data 0.000 (0.003) loss 1.5318 (1.5492) ce_loss 1.2109 (1.1308) teacher_loss 0.9833 (0.9773) loss_zs_kd 0.8278 (0.7284) loss_oracle 0.4657 (0.4990) acc 43.7500 (57.6736) kd_loss 1.2820 (1.0976) lr 1.5358e-03 eta 0:20:05
epoch [18/50] batch [200/319] time 0.086 (0.116) data 0.000 (0.003) loss 1.6743 (1.5500) ce_loss 1.1230 (1.1339) teacher_loss 0.9695 (0.9755) loss_zs_kd 0.7483 (0.7347) loss_oracle 0.6300 (0.5010) acc 62.5000 (57.6406) kd_loss 1.2585 (1.1078) lr 1.5358e-03 eta 0:19:55
epoch [18/50] batch [220/319] time 0.190 (0.116) data 0.000 (0.002) loss 1.5436 (1.5515) ce_loss 1.1953 (1.1379) teacher_loss 0.9887 (0.9746) loss_zs_kd 0.7410 (0.7358) loss_oracle 0.4808 (0.5033) acc 59.3750 (57.5426) kd_loss 1.1413 (1.1159) lr 1.5358e-03 eta 0:19:52
epoch [18/50] batch [240/319] time 0.069 (0.117) data 0.000 (0.002) loss 1.5473 (1.5477) ce_loss 1.1895 (1.1403) teacher_loss 1.0217 (0.9713) loss_zs_kd 0.6716 (0.7374) loss_oracle 0.4585 (0.5027) acc 53.1250 (57.3307) kd_loss 1.3033 (1.1242) lr 1.5358e-03 eta 0:20:03
epoch [18/50] batch [260/319] time 0.191 (0.120) data 0.000 (0.002) loss 1.6147 (1.5426) ce_loss 1.1279 (1.1387) teacher_loss 1.0661 (0.9664) loss_zs_kd 0.8914 (0.7428) loss_oracle 0.4594 (0.5019) acc 53.1250 (57.2115) kd_loss 1.0383 (1.1262) lr 1.5358e-03 eta 0:20:26
epoch [18/50] batch [280/319] time 0.124 (0.120) data 0.000 (0.002) loss 1.8327 (1.5475) ce_loss 1.3193 (1.1428) teacher_loss 1.0633 (0.9707) loss_zs_kd 0.6853 (0.7449) loss_oracle 0.7009 (0.5023) acc 46.8750 (57.0089) kd_loss 1.2622 (1.1297) lr 1.5358e-03 eta 0:20:31
epoch [18/50] batch [300/319] time 0.097 (0.119) data 0.000 (0.002) loss 1.2385 (1.5496) ce_loss 0.9214 (1.1453) teacher_loss 0.7229 (0.9738) loss_zs_kd 0.8719 (0.7460) loss_oracle 0.4284 (0.5013) acc 71.8750 (56.8438) kd_loss 1.2084 (1.1333) lr 1.5358e-03 eta 0:20:17
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,723
* accuracy: 62.2%
* error: 37.8%
* macro_f1: 54.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,241
* accuracy: 53.8%
* error: 46.2%
* macro_f1: 22.9%
******* Domain 2 best val acc:      63.5%, epoch: 12 *******
******* Domain 2 best val test acc: 51.8%, epoch: 12 *******
******* Domain 2 best test acc:     55.0%, epoch: 15 *******
epoch [19/50] batch [20/319] time 0.144 (0.173) data 0.000 (0.028) loss 1.2879 (1.5074) ce_loss 0.8882 (1.1032) teacher_loss 0.8451 (0.9420) loss_zs_kd 0.6822 (0.7416) loss_oracle 0.3745 (0.4913) acc 68.7500 (58.4375) kd_loss 1.1392 (1.1328) lr 1.4818e-03 eta 0:29:21
epoch [19/50] batch [40/319] time 0.128 (0.140) data 0.000 (0.014) loss 1.5469 (1.5096) ce_loss 1.0332 (1.1201) teacher_loss 0.8986 (0.9293) loss_zs_kd 0.7989 (0.7782) loss_oracle 0.5684 (0.5025) acc 56.2500 (57.1875) kd_loss 1.0920 (1.1729) lr 1.4818e-03 eta 0:23:48
epoch [19/50] batch [60/319] time 0.134 (0.131) data 0.000 (0.009) loss 1.4032 (1.5062) ce_loss 1.0557 (1.1327) teacher_loss 0.7953 (0.9230) loss_zs_kd 0.6035 (0.7940) loss_oracle 0.5476 (0.5039) acc 62.5000 (57.0312) kd_loss 1.0751 (1.1933) lr 1.4818e-03 eta 0:22:13
epoch [19/50] batch [80/319] time 0.197 (0.126) data 0.000 (0.007) loss 1.5752 (1.5224) ce_loss 1.3379 (1.1377) teacher_loss 0.9581 (0.9331) loss_zs_kd 0.8144 (0.7828) loss_oracle 0.5357 (0.5110) acc 50.0000 (57.0703) kd_loss 1.3046 (1.2060) lr 1.4818e-03 eta 0:21:11
epoch [19/50] batch [100/319] time 0.079 (0.131) data 0.000 (0.006) loss 1.6401 (1.5391) ce_loss 1.1611 (1.1485) teacher_loss 1.0594 (0.9457) loss_zs_kd 0.7444 (0.7740) loss_oracle 0.5062 (0.5161) acc 59.3750 (56.4688) kd_loss 1.2530 (1.2123) lr 1.4818e-03 eta 0:22:05
epoch [19/50] batch [120/319] time 0.192 (0.136) data 0.000 (0.005) loss 1.8370 (1.5548) ce_loss 1.3203 (1.1493) teacher_loss 1.1600 (0.9485) loss_zs_kd 0.6625 (0.7675) loss_oracle 0.6108 (0.5296) acc 59.3750 (56.8490) kd_loss 1.2349 (1.2062) lr 1.4818e-03 eta 0:22:47
epoch [19/50] batch [140/319] time 0.088 (0.135) data 0.000 (0.004) loss 1.3495 (1.5762) ce_loss 1.0225 (1.1553) teacher_loss 0.6979 (0.9504) loss_zs_kd 0.7626 (0.7718) loss_oracle 0.5753 (0.5486) acc 65.6250 (56.6071) kd_loss 1.0602 (1.1991) lr 1.4818e-03 eta 0:22:40
epoch [19/50] batch [160/319] time 0.101 (0.132) data 0.000 (0.004) loss 1.6292 (1.5737) ce_loss 1.1719 (1.1533) teacher_loss 1.0366 (0.9458) loss_zs_kd 0.6723 (0.7709) loss_oracle 0.5254 (0.5508) acc 53.1250 (56.5820) kd_loss 1.1517 (1.1920) lr 1.4818e-03 eta 0:22:02
epoch [19/50] batch [180/319] time 0.140 (0.130) data 0.000 (0.003) loss 1.3863 (1.5651) ce_loss 1.0703 (1.1451) teacher_loss 0.8171 (0.9426) loss_zs_kd 0.7015 (0.7655) loss_oracle 0.4990 (0.5460) acc 62.5000 (56.9618) kd_loss 1.1659 (1.1851) lr 1.4818e-03 eta 0:21:39
epoch [19/50] batch [200/319] time 0.088 (0.127) data 0.000 (0.003) loss 1.3898 (1.5580) ce_loss 1.0820 (1.1399) teacher_loss 0.8267 (0.9416) loss_zs_kd 0.7384 (0.7675) loss_oracle 0.4893 (0.5397) acc 50.0000 (57.3438) kd_loss 1.2466 (1.1812) lr 1.4818e-03 eta 0:21:12
epoch [19/50] batch [220/319] time 0.110 (0.126) data 0.000 (0.003) loss 1.5600 (1.5460) ce_loss 1.2070 (1.1321) teacher_loss 1.0628 (0.9369) loss_zs_kd 0.6885 (0.7687) loss_oracle 0.4283 (0.5322) acc 50.0000 (57.6847) kd_loss 1.0562 (1.1759) lr 1.4818e-03 eta 0:20:55
epoch [19/50] batch [240/319] time 0.117 (0.125) data 0.000 (0.002) loss 1.7265 (1.5439) ce_loss 1.2383 (1.1327) teacher_loss 1.0617 (0.9391) loss_zs_kd 0.7209 (0.7660) loss_oracle 0.5927 (0.5281) acc 53.1250 (57.6172) kd_loss 1.1356 (1.1726) lr 1.4818e-03 eta 0:20:41
epoch [19/50] batch [260/319] time 0.087 (0.123) data 0.000 (0.002) loss 1.8160 (1.5435) ce_loss 1.3389 (1.1316) teacher_loss 1.2544 (0.9433) loss_zs_kd 0.6463 (0.7622) loss_oracle 0.4969 (0.5239) acc 50.0000 (57.6082) kd_loss 1.1931 (1.1727) lr 1.4818e-03 eta 0:20:25
epoch [19/50] batch [280/319] time 0.080 (0.122) data 0.000 (0.002) loss 1.3645 (1.5420) ce_loss 0.9541 (1.1308) teacher_loss 0.7638 (0.9435) loss_zs_kd 0.7188 (0.7599) loss_oracle 0.5288 (0.5225) acc 68.7500 (57.5893) kd_loss 1.1023 (1.1740) lr 1.4818e-03 eta 0:20:12
epoch [19/50] batch [300/319] time 0.080 (0.121) data 0.000 (0.002) loss 1.6166 (1.5410) ce_loss 1.2500 (1.1308) teacher_loss 1.0374 (0.9420) loss_zs_kd 0.7406 (0.7620) loss_oracle 0.5051 (0.5228) acc 53.1250 (57.5729) kd_loss 1.0726 (1.1728) lr 1.4818e-03 eta 0:20:00
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,744
* accuracy: 62.7%
* error: 37.3%
* macro_f1: 55.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,360
* accuracy: 55.1%
* error: 44.9%
* macro_f1: 24.2%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      63.5%, epoch: 12 *******
******* Domain 2 best val test acc: 51.8%, epoch: 12 *******
******* Domain 2 best test acc:     55.1%, epoch: 19 *******
epoch [20/50] batch [20/319] time 0.087 (0.155) data 0.000 (0.026) loss 1.6769 (1.6308) ce_loss 1.1523 (1.1502) teacher_loss 1.0867 (0.9971) loss_zs_kd 0.6222 (0.7558) loss_oracle 0.5280 (0.5582) acc 43.7500 (57.0312) kd_loss 1.1211 (1.1460) lr 1.4258e-03 eta 0:25:26
epoch [20/50] batch [40/319] time 0.078 (0.126) data 0.000 (0.013) loss 1.5429 (1.5831) ce_loss 1.0293 (1.1295) teacher_loss 0.9519 (0.9612) loss_zs_kd 0.6263 (0.7144) loss_oracle 0.5284 (0.5505) acc 53.1250 (56.7969) kd_loss 1.2131 (1.1787) lr 1.4258e-03 eta 0:20:43
epoch [20/50] batch [60/319] time 0.132 (0.119) data 0.000 (0.009) loss 1.2563 (1.5828) ce_loss 0.9028 (1.1523) teacher_loss 0.7114 (0.9741) loss_zs_kd 0.5849 (0.7343) loss_oracle 0.4864 (0.5353) acc 65.6250 (56.7708) kd_loss 1.0759 (1.1711) lr 1.4258e-03 eta 0:19:34
epoch [20/50] batch [80/319] time 0.083 (0.117) data 0.000 (0.007) loss 1.4443 (1.5655) ce_loss 0.9575 (1.1298) teacher_loss 0.9141 (0.9676) loss_zs_kd 0.9208 (0.7423) loss_oracle 0.4381 (0.5237) acc 65.6250 (57.5391) kd_loss 1.1231 (1.1618) lr 1.4258e-03 eta 0:19:10
epoch [20/50] batch [100/319] time 0.083 (0.116) data 0.001 (0.005) loss 1.6137 (1.5610) ce_loss 1.1104 (1.1179) teacher_loss 1.0576 (0.9680) loss_zs_kd 0.6468 (0.7343) loss_oracle 0.4915 (0.5195) acc 53.1250 (57.5312) kd_loss 1.0871 (1.1425) lr 1.4258e-03 eta 0:18:59
epoch [20/50] batch [120/319] time 0.096 (0.115) data 0.000 (0.005) loss 1.4699 (1.5502) ce_loss 1.1396 (1.1080) teacher_loss 1.0129 (0.9604) loss_zs_kd 0.7865 (0.7340) loss_oracle 0.3784 (0.5163) acc 46.8750 (57.9688) kd_loss 1.1736 (1.1421) lr 1.4258e-03 eta 0:18:42
epoch [20/50] batch [140/319] time 0.094 (0.114) data 0.000 (0.004) loss 1.3611 (1.5500) ce_loss 1.0039 (1.1104) teacher_loss 0.7864 (0.9599) loss_zs_kd 0.6532 (0.7400) loss_oracle 0.5094 (0.5162) acc 59.3750 (57.6562) kd_loss 1.0958 (1.1406) lr 1.4258e-03 eta 0:18:32
epoch [20/50] batch [160/319] time 0.079 (0.112) data 0.000 (0.003) loss 1.4269 (1.5440) ce_loss 1.0762 (1.1068) teacher_loss 0.8113 (0.9559) loss_zs_kd 0.8367 (0.7374) loss_oracle 0.5319 (0.5144) acc 56.2500 (57.8906) kd_loss 1.2466 (1.1444) lr 1.4258e-03 eta 0:18:08
epoch [20/50] batch [180/319] time 0.082 (0.111) data 0.000 (0.003) loss 1.5671 (1.5472) ce_loss 1.3076 (1.1156) teacher_loss 0.9439 (0.9596) loss_zs_kd 0.8769 (0.7369) loss_oracle 0.5355 (0.5139) acc 46.8750 (57.4653) kd_loss 1.3041 (1.1563) lr 1.4258e-03 eta 0:17:57
epoch [20/50] batch [200/319] time 0.087 (0.111) data 0.000 (0.003) loss 1.7269 (1.5504) ce_loss 1.1602 (1.1223) teacher_loss 1.0865 (0.9583) loss_zs_kd 0.8946 (0.7392) loss_oracle 0.5509 (0.5182) acc 68.7500 (57.2344) kd_loss 1.1356 (1.1640) lr 1.4258e-03 eta 0:17:54
epoch [20/50] batch [220/319] time 0.096 (0.110) data 0.000 (0.003) loss 1.7051 (1.5497) ce_loss 1.1211 (1.1245) teacher_loss 1.1544 (0.9571) loss_zs_kd 0.7641 (0.7418) loss_oracle 0.4743 (0.5184) acc 68.7500 (57.3295) kd_loss 1.1384 (1.1660) lr 1.4258e-03 eta 0:17:48
epoch [20/50] batch [240/319] time 0.132 (0.109) data 0.000 (0.002) loss 1.4795 (1.5517) ce_loss 1.2158 (1.1278) teacher_loss 0.9389 (0.9609) loss_zs_kd 0.6853 (0.7427) loss_oracle 0.4720 (0.5165) acc 46.8750 (57.2266) kd_loss 1.1708 (1.1647) lr 1.4258e-03 eta 0:17:35
epoch [20/50] batch [260/319] time 0.117 (0.109) data 0.000 (0.002) loss 1.5169 (1.5466) ce_loss 1.0762 (1.1232) teacher_loss 0.9665 (0.9577) loss_zs_kd 0.7008 (0.7447) loss_oracle 0.4803 (0.5145) acc 50.0000 (57.4399) kd_loss 1.0999 (1.1659) lr 1.4258e-03 eta 0:17:33
epoch [20/50] batch [280/319] time 0.139 (0.109) data 0.000 (0.002) loss 1.5640 (1.5455) ce_loss 1.1445 (1.1255) teacher_loss 0.9883 (0.9583) loss_zs_kd 0.7941 (0.7474) loss_oracle 0.4963 (0.5125) acc 65.6250 (57.3772) kd_loss 1.1645 (1.1635) lr 1.4258e-03 eta 0:17:30
epoch [20/50] batch [300/319] time 0.082 (0.110) data 0.000 (0.002) loss 1.2325 (1.5424) ce_loss 1.0684 (1.1263) teacher_loss 0.7263 (0.9574) loss_zs_kd 0.9871 (0.7486) loss_oracle 0.4075 (0.5102) acc 59.3750 (57.4062) kd_loss 1.1571 (1.1640) lr 1.4258e-03 eta 0:17:35
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,707
* accuracy: 61.8%
* error: 38.2%
* macro_f1: 54.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,336
* accuracy: 54.8%
* error: 45.2%
* macro_f1: 23.4%
******* Domain 2 best val acc:      63.5%, epoch: 12 *******
******* Domain 2 best val test acc: 51.8%, epoch: 12 *******
******* Domain 2 best test acc:     55.1%, epoch: 19 *******
epoch [21/50] batch [20/319] time 0.082 (0.143) data 0.000 (0.032) loss 1.4406 (1.4686) ce_loss 1.0752 (1.0926) teacher_loss 0.8456 (0.9314) loss_zs_kd 0.9035 (0.7223) loss_oracle 0.5047 (0.4650) acc 56.2500 (57.1875) kd_loss 1.1313 (1.1601) lr 1.3681e-03 eta 0:22:42
epoch [21/50] batch [40/319] time 0.080 (0.126) data 0.000 (0.016) loss 1.6250 (1.4922) ce_loss 1.1709 (1.1121) teacher_loss 1.0452 (0.9496) loss_zs_kd 0.7075 (0.7491) loss_oracle 0.5090 (0.4677) acc 50.0000 (56.6406) kd_loss 1.1622 (1.1472) lr 1.3681e-03 eta 0:19:59
epoch [21/50] batch [60/319] time 0.083 (0.122) data 0.000 (0.011) loss 1.4646 (1.4966) ce_loss 1.0898 (1.1150) teacher_loss 0.8428 (0.9466) loss_zs_kd 0.9563 (0.7773) loss_oracle 0.5262 (0.4723) acc 62.5000 (56.5625) kd_loss 1.1768 (1.1412) lr 1.3681e-03 eta 0:19:17
epoch [21/50] batch [80/319] time 0.085 (0.121) data 0.000 (0.008) loss 1.0845 (1.5014) ce_loss 0.8838 (1.1163) teacher_loss 0.5917 (0.9482) loss_zs_kd 0.5978 (0.7631) loss_oracle 0.4331 (0.4769) acc 68.7500 (56.7969) kd_loss 1.0894 (1.1201) lr 1.3681e-03 eta 0:19:09
epoch [21/50] batch [100/319] time 0.129 (0.120) data 0.000 (0.007) loss 1.4016 (1.5189) ce_loss 1.0781 (1.1167) teacher_loss 0.7102 (0.9556) loss_zs_kd 0.7191 (0.7500) loss_oracle 0.6195 (0.4883) acc 62.5000 (56.8750) kd_loss 1.2554 (1.1105) lr 1.3681e-03 eta 0:18:51
epoch [21/50] batch [120/319] time 0.135 (0.118) data 0.000 (0.006) loss 1.5219 (1.5207) ce_loss 0.9575 (1.1140) teacher_loss 0.8535 (0.9494) loss_zs_kd 0.6878 (0.7431) loss_oracle 0.5996 (0.4969) acc 56.2500 (56.9010) kd_loss 1.0370 (1.1133) lr 1.3681e-03 eta 0:18:39
epoch [21/50] batch [140/319] time 0.114 (0.117) data 0.000 (0.005) loss 1.5249 (1.5133) ce_loss 1.1865 (1.1082) teacher_loss 0.8661 (0.9355) loss_zs_kd 0.9004 (0.7404) loss_oracle 0.5688 (0.5037) acc 53.1250 (57.1875) kd_loss 1.1377 (1.1207) lr 1.3681e-03 eta 0:18:22
epoch [21/50] batch [160/319] time 0.146 (0.119) data 0.000 (0.004) loss 1.4921 (1.5245) ce_loss 1.0391 (1.1114) teacher_loss 0.9147 (0.9461) loss_zs_kd 0.7380 (0.7365) loss_oracle 0.5036 (0.5047) acc 59.3750 (57.1680) kd_loss 1.0914 (1.1191) lr 1.3681e-03 eta 0:18:37
epoch [21/50] batch [180/319] time 0.145 (0.121) data 0.000 (0.004) loss 1.6267 (1.5280) ce_loss 1.2051 (1.1086) teacher_loss 1.0621 (0.9537) loss_zs_kd 0.7434 (0.7288) loss_oracle 0.4903 (0.5015) acc 46.8750 (57.3785) kd_loss 1.0771 (1.1116) lr 1.3681e-03 eta 0:18:59
epoch [21/50] batch [200/319] time 0.126 (0.121) data 0.000 (0.003) loss 1.7580 (1.5318) ce_loss 1.4902 (1.1112) teacher_loss 1.2149 (0.9583) loss_zs_kd 0.8456 (0.7248) loss_oracle 0.4585 (0.5010) acc 50.0000 (57.5000) kd_loss 1.1315 (1.1060) lr 1.3681e-03 eta 0:18:54
epoch [21/50] batch [220/319] time 0.101 (0.120) data 0.000 (0.003) loss 1.4510 (1.5271) ce_loss 1.0654 (1.1091) teacher_loss 0.8715 (0.9551) loss_zs_kd 0.6672 (0.7279) loss_oracle 0.5128 (0.4992) acc 59.3750 (57.7273) kd_loss 1.0793 (1.1082) lr 1.3681e-03 eta 0:18:45
epoch [21/50] batch [240/319] time 0.155 (0.120) data 0.000 (0.003) loss 1.2300 (1.5259) ce_loss 0.9253 (1.1082) teacher_loss 0.7748 (0.9561) loss_zs_kd 0.7396 (0.7248) loss_oracle 0.3812 (0.4974) acc 56.2500 (57.7604) kd_loss 1.0781 (1.1023) lr 1.3681e-03 eta 0:18:41
epoch [21/50] batch [260/319] time 0.132 (0.121) data 0.000 (0.003) loss 1.6622 (1.5337) ce_loss 1.1846 (1.1136) teacher_loss 1.0305 (0.9643) loss_zs_kd 0.8622 (0.7243) loss_oracle 0.5455 (0.4970) acc 56.2500 (57.5721) kd_loss 1.0636 (1.0920) lr 1.3681e-03 eta 0:18:46
epoch [21/50] batch [280/319] time 0.092 (0.121) data 0.000 (0.002) loss 1.4237 (1.5397) ce_loss 1.0820 (1.1152) teacher_loss 0.9545 (0.9708) loss_zs_kd 0.5865 (0.7210) loss_oracle 0.4106 (0.4968) acc 59.3750 (57.6116) kd_loss 1.1829 (1.0904) lr 1.3681e-03 eta 0:18:40
epoch [21/50] batch [300/319] time 0.078 (0.120) data 0.000 (0.002) loss 1.1407 (1.5333) ce_loss 0.9658 (1.1134) teacher_loss 0.6392 (0.9653) loss_zs_kd 0.7396 (0.7171) loss_oracle 0.4275 (0.4963) acc 62.5000 (57.7500) kd_loss 1.2435 (1.0976) lr 1.3681e-03 eta 0:18:34
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,665
* accuracy: 60.9%
* error: 39.1%
* macro_f1: 54.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,326
* accuracy: 54.7%
* error: 45.3%
* macro_f1: 24.5%
******* Domain 2 best val acc:      63.5%, epoch: 12 *******
******* Domain 2 best val test acc: 51.8%, epoch: 12 *******
******* Domain 2 best test acc:     55.1%, epoch: 19 *******
epoch [22/50] batch [20/319] time 0.109 (0.143) data 0.000 (0.031) loss 1.5173 (1.4794) ce_loss 1.0244 (1.1125) teacher_loss 0.9181 (0.9082) loss_zs_kd 0.9727 (0.8090) loss_oracle 0.5019 (0.4903) acc 65.6250 (58.5938) kd_loss 1.0426 (1.1656) lr 1.3090e-03 eta 0:21:59
epoch [22/50] batch [40/319] time 0.149 (0.127) data 0.000 (0.016) loss 1.5028 (1.4744) ce_loss 1.0381 (1.0904) teacher_loss 0.9330 (0.9101) loss_zs_kd 0.8488 (0.7898) loss_oracle 0.4849 (0.4853) acc 59.3750 (59.7656) kd_loss 1.0248 (1.1316) lr 1.3090e-03 eta 0:19:28
epoch [22/50] batch [60/319] time 0.147 (0.124) data 0.000 (0.010) loss 1.3566 (1.5030) ce_loss 0.9678 (1.0972) teacher_loss 0.8356 (0.9376) loss_zs_kd 0.6799 (0.7595) loss_oracle 0.4529 (0.4895) acc 68.7500 (59.1146) kd_loss 0.9440 (1.1053) lr 1.3090e-03 eta 0:18:59
epoch [22/50] batch [80/319] time 0.159 (0.131) data 0.000 (0.008) loss 1.7983 (1.4934) ce_loss 1.4600 (1.0966) teacher_loss 1.2822 (0.9317) loss_zs_kd 0.7945 (0.7556) loss_oracle 0.4367 (0.4862) acc 53.1250 (59.1797) kd_loss 1.0964 (1.1064) lr 1.3090e-03 eta 0:20:00
epoch [22/50] batch [100/319] time 0.142 (0.135) data 0.000 (0.006) loss 1.4208 (1.5022) ce_loss 0.9795 (1.0989) teacher_loss 0.8383 (0.9401) loss_zs_kd 0.7283 (0.7599) loss_oracle 0.5097 (0.4862) acc 59.3750 (58.9688) kd_loss 1.2442 (1.1130) lr 1.3090e-03 eta 0:20:34
epoch [22/50] batch [120/319] time 0.120 (0.134) data 0.000 (0.005) loss 1.8356 (1.5030) ce_loss 1.5078 (1.0986) teacher_loss 1.3497 (0.9424) loss_zs_kd 0.7196 (0.7532) loss_oracle 0.4139 (0.4853) acc 43.7500 (59.1667) kd_loss 1.2715 (1.1226) lr 1.3090e-03 eta 0:20:20
epoch [22/50] batch [140/319] time 0.152 (0.136) data 0.000 (0.005) loss 1.5883 (1.5109) ce_loss 1.1309 (1.0989) teacher_loss 1.0234 (0.9472) loss_zs_kd 0.6997 (0.7597) loss_oracle 0.4950 (0.4877) acc 59.3750 (59.0625) kd_loss 1.0939 (1.1292) lr 1.3090e-03 eta 0:20:40
epoch [22/50] batch [160/319] time 0.076 (0.137) data 0.000 (0.004) loss 1.5183 (1.5165) ce_loss 1.1709 (1.1036) teacher_loss 0.9559 (0.9516) loss_zs_kd 0.5803 (0.7546) loss_oracle 0.5044 (0.4894) acc 62.5000 (58.9844) kd_loss 1.1341 (1.1342) lr 1.3090e-03 eta 0:20:43
epoch [22/50] batch [180/319] time 0.192 (0.138) data 0.000 (0.004) loss 2.0653 (1.5153) ce_loss 1.4023 (1.0983) teacher_loss 1.5604 (0.9493) loss_zs_kd 0.7054 (0.7495) loss_oracle 0.4344 (0.4910) acc 37.5000 (59.0799) kd_loss 1.1817 (1.1335) lr 1.3090e-03 eta 0:20:47
epoch [22/50] batch [200/319] time 0.193 (0.138) data 0.000 (0.003) loss 1.5267 (1.5220) ce_loss 1.1553 (1.1035) teacher_loss 1.0035 (0.9539) loss_zs_kd 0.6397 (0.7389) loss_oracle 0.4592 (0.4942) acc 65.6250 (59.0000) kd_loss 1.1516 (1.1316) lr 1.3090e-03 eta 0:20:45
epoch [22/50] batch [220/319] time 0.067 (0.139) data 0.000 (0.003) loss 1.2864 (1.5241) ce_loss 0.8066 (1.1052) teacher_loss 0.7326 (0.9566) loss_zs_kd 0.6816 (0.7343) loss_oracle 0.4856 (0.4941) acc 75.0000 (58.8920) kd_loss 1.1531 (1.1344) lr 1.3090e-03 eta 0:20:58
epoch [22/50] batch [240/319] time 0.119 (0.137) data 0.000 (0.003) loss 1.8128 (1.5218) ce_loss 1.3584 (1.1040) teacher_loss 1.1882 (0.9542) loss_zs_kd 0.8135 (0.7355) loss_oracle 0.5432 (0.4940) acc 59.3750 (58.8672) kd_loss 1.2145 (1.1370) lr 1.3090e-03 eta 0:20:32
epoch [22/50] batch [260/319] time 0.096 (0.135) data 0.000 (0.003) loss 1.6513 (1.5307) ce_loss 1.2119 (1.1099) teacher_loss 0.9975 (0.9637) loss_zs_kd 0.5701 (0.7327) loss_oracle 0.5968 (0.4937) acc 53.1250 (58.4976) kd_loss 1.1951 (1.1390) lr 1.3090e-03 eta 0:20:17
epoch [22/50] batch [280/319] time 0.150 (0.136) data 0.000 (0.002) loss 1.3258 (1.5302) ce_loss 0.8833 (1.1091) teacher_loss 0.6669 (0.9638) loss_zs_kd 0.6801 (0.7289) loss_oracle 0.5909 (0.4935) acc 71.8750 (58.4040) kd_loss 1.0971 (1.1397) lr 1.3090e-03 eta 0:20:24
epoch [22/50] batch [300/319] time 0.137 (0.137) data 0.000 (0.002) loss 1.6246 (1.5345) ce_loss 1.1270 (1.1123) teacher_loss 0.9817 (0.9657) loss_zs_kd 0.7817 (0.7280) loss_oracle 0.5647 (0.4961) acc 65.6250 (58.1146) kd_loss 1.1028 (1.1354) lr 1.3090e-03 eta 0:20:30
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,822
* accuracy: 64.5%
* error: 35.5%
* macro_f1: 56.8%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,240
* accuracy: 53.8%
* error: 46.2%
* macro_f1: 23.3%
******* Domain 2 best val acc:      64.5%, epoch: 22 *******
******* Domain 2 best val test acc: 53.8%, epoch: 22 *******
******* Domain 2 best test acc:     55.1%, epoch: 19 *******
epoch [23/50] batch [20/319] time 0.201 (0.175) data 0.000 (0.028) loss 1.7008 (1.5771) ce_loss 1.2754 (1.1248) teacher_loss 1.1506 (0.9373) loss_zs_kd 0.6619 (0.7501) loss_oracle 0.4840 (0.5648) acc 50.0000 (57.8125) kd_loss 0.8650 (0.9978) lr 1.2487e-03 eta 0:26:03
epoch [23/50] batch [40/319] time 0.190 (0.160) data 0.000 (0.014) loss 1.5432 (1.5889) ce_loss 1.0557 (1.1293) teacher_loss 0.9567 (0.9440) loss_zs_kd 0.8091 (0.7151) loss_oracle 0.5056 (0.5734) acc 59.3750 (56.9531) kd_loss 1.0579 (1.0484) lr 1.2487e-03 eta 0:23:40
epoch [23/50] batch [60/319] time 0.068 (0.162) data 0.000 (0.009) loss 1.4464 (1.5438) ce_loss 1.2783 (1.1118) teacher_loss 0.9146 (0.9241) loss_zs_kd 0.7951 (0.7296) loss_oracle 0.4523 (0.5468) acc 46.8750 (57.5000) kd_loss 1.2311 (1.0864) lr 1.2487e-03 eta 0:23:54
epoch [23/50] batch [80/319] time 0.143 (0.147) data 0.000 (0.007) loss 1.6281 (1.5495) ce_loss 1.1104 (1.1139) teacher_loss 1.0482 (0.9401) loss_zs_kd 0.7168 (0.7327) loss_oracle 0.5082 (0.5361) acc 59.3750 (57.9688) kd_loss 1.0185 (1.0840) lr 1.2487e-03 eta 0:21:37
epoch [23/50] batch [100/319] time 0.114 (0.139) data 0.000 (0.006) loss 1.4529 (1.5528) ce_loss 1.0439 (1.1142) teacher_loss 0.8646 (0.9506) loss_zs_kd 0.7116 (0.7243) loss_oracle 0.5171 (0.5297) acc 68.7500 (57.9688) kd_loss 1.0202 (1.0778) lr 1.2487e-03 eta 0:20:27
epoch [23/50] batch [120/319] time 0.089 (0.134) data 0.001 (0.005) loss 1.5839 (1.5451) ce_loss 1.0703 (1.1070) teacher_loss 1.0555 (0.9523) loss_zs_kd 0.6217 (0.7100) loss_oracle 0.4662 (0.5219) acc 56.2500 (58.1510) kd_loss 1.0413 (1.0717) lr 1.2487e-03 eta 0:19:40
epoch [23/50] batch [140/319] time 0.090 (0.130) data 0.000 (0.004) loss 1.4696 (1.5431) ce_loss 0.9663 (1.1043) teacher_loss 0.8146 (0.9537) loss_zs_kd 0.7007 (0.7100) loss_oracle 0.5849 (0.5185) acc 75.0000 (58.6161) kd_loss 1.2708 (1.0743) lr 1.2487e-03 eta 0:18:58
epoch [23/50] batch [160/319] time 0.135 (0.128) data 0.000 (0.004) loss 1.4443 (1.5424) ce_loss 0.9731 (1.1017) teacher_loss 0.8468 (0.9582) loss_zs_kd 0.7376 (0.7191) loss_oracle 0.5237 (0.5123) acc 59.3750 (58.8672) kd_loss 1.1887 (1.0810) lr 1.2487e-03 eta 0:18:42
epoch [23/50] batch [180/319] time 0.106 (0.126) data 0.000 (0.003) loss 1.6729 (1.5372) ce_loss 1.2451 (1.1017) teacher_loss 1.1592 (0.9568) loss_zs_kd 0.6824 (0.7232) loss_oracle 0.4455 (0.5081) acc 50.0000 (58.6285) kd_loss 1.1241 (1.0894) lr 1.2487e-03 eta 0:18:21
epoch [23/50] batch [200/319] time 0.082 (0.124) data 0.000 (0.003) loss 1.1700 (1.5357) ce_loss 0.7275 (1.1022) teacher_loss 0.7105 (0.9575) loss_zs_kd 0.5657 (0.7228) loss_oracle 0.4030 (0.5059) acc 78.1250 (58.7500) kd_loss 1.0615 (1.0969) lr 1.2487e-03 eta 0:18:04
epoch [23/50] batch [220/319] time 0.142 (0.123) data 0.000 (0.003) loss 1.5705 (1.5326) ce_loss 1.3457 (1.1026) teacher_loss 1.0208 (0.9568) loss_zs_kd 0.8803 (0.7280) loss_oracle 0.4617 (0.5029) acc 59.3750 (58.7784) kd_loss 1.2584 (1.1048) lr 1.2487e-03 eta 0:17:52
epoch [23/50] batch [240/319] time 0.085 (0.122) data 0.000 (0.002) loss 1.6372 (1.5374) ce_loss 1.2246 (1.1096) teacher_loss 1.0339 (0.9645) loss_zs_kd 0.7121 (0.7254) loss_oracle 0.5321 (0.5003) acc 56.2500 (58.6458) kd_loss 1.2183 (1.1089) lr 1.2487e-03 eta 0:17:40
epoch [23/50] batch [260/319] time 0.129 (0.121) data 0.000 (0.002) loss 1.6622 (1.5427) ce_loss 1.1133 (1.1134) teacher_loss 1.0352 (0.9687) loss_zs_kd 0.6787 (0.7241) loss_oracle 0.5591 (0.5016) acc 59.3750 (58.4135) kd_loss 1.0161 (1.1119) lr 1.2487e-03 eta 0:17:30
epoch [23/50] batch [280/319] time 0.140 (0.121) data 0.000 (0.002) loss 1.3760 (1.5428) ce_loss 0.9761 (1.1130) teacher_loss 0.8053 (0.9680) loss_zs_kd 0.7786 (0.7244) loss_oracle 0.4928 (0.5023) acc 62.5000 (58.5045) kd_loss 1.2837 (1.1130) lr 1.2487e-03 eta 0:17:23
epoch [23/50] batch [300/319] time 0.083 (0.122) data 0.000 (0.002) loss 1.4771 (1.5398) ce_loss 1.1406 (1.1134) teacher_loss 0.9393 (0.9659) loss_zs_kd 0.8684 (0.7254) loss_oracle 0.4510 (0.5013) acc 56.2500 (58.3854) kd_loss 1.1477 (1.1176) lr 1.2487e-03 eta 0:17:29
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,636
* accuracy: 60.2%
* error: 39.8%
* macro_f1: 54.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,438
* accuracy: 55.9%
* error: 44.1%
* macro_f1: 25.0%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      64.5%, epoch: 22 *******
******* Domain 2 best val test acc: 53.8%, epoch: 22 *******
******* Domain 2 best test acc:     55.9%, epoch: 23 *******
epoch [24/50] batch [20/319] time 0.102 (0.133) data 0.000 (0.026) loss 1.3133 (1.4475) ce_loss 1.0791 (1.1814) teacher_loss 0.7929 (0.8899) loss_zs_kd 0.8551 (0.8105) loss_oracle 0.4349 (0.4766) acc 56.2500 (54.5312) kd_loss 1.1808 (1.1990) lr 1.1874e-03 eta 0:19:03
epoch [24/50] batch [40/319] time 0.088 (0.120) data 0.000 (0.013) loss 1.9817 (1.4762) ce_loss 1.4141 (1.1632) teacher_loss 1.3123 (0.8976) loss_zs_kd 0.7183 (0.8018) loss_oracle 0.5975 (0.4984) acc 46.8750 (55.9375) kd_loss 1.1004 (1.1895) lr 1.1874e-03 eta 0:17:05
epoch [24/50] batch [60/319] time 0.144 (0.118) data 0.001 (0.009) loss 1.5554 (1.5149) ce_loss 1.2676 (1.1710) teacher_loss 0.9073 (0.9261) loss_zs_kd 0.8949 (0.7839) loss_oracle 0.5587 (0.5105) acc 43.7500 (55.2604) kd_loss 1.1147 (1.1753) lr 1.1874e-03 eta 0:16:53
epoch [24/50] batch [80/319] time 0.135 (0.115) data 0.000 (0.007) loss 1.5582 (1.5236) ce_loss 1.2744 (1.1658) teacher_loss 0.9464 (0.9268) loss_zs_kd 0.9360 (0.7720) loss_oracle 0.5182 (0.5195) acc 56.2500 (55.8594) kd_loss 1.0456 (1.1693) lr 1.1874e-03 eta 0:16:22
epoch [24/50] batch [100/319] time 0.106 (0.113) data 0.000 (0.005) loss 2.1892 (1.5283) ce_loss 1.4658 (1.1613) teacher_loss 1.5117 (0.9241) loss_zs_kd 0.9089 (0.7665) loss_oracle 0.5867 (0.5276) acc 43.7500 (55.4062) kd_loss 1.1796 (1.1635) lr 1.1874e-03 eta 0:16:02
epoch [24/50] batch [120/319] time 0.101 (0.113) data 0.000 (0.005) loss 1.5689 (1.5410) ce_loss 1.2188 (1.1640) teacher_loss 1.0246 (0.9384) loss_zs_kd 0.7667 (0.7634) loss_oracle 0.4675 (0.5263) acc 56.2500 (55.3385) kd_loss 1.1528 (1.1599) lr 1.1874e-03 eta 0:15:59
epoch [24/50] batch [140/319] time 0.146 (0.114) data 0.000 (0.004) loss 1.4647 (1.5356) ce_loss 0.9951 (1.1557) teacher_loss 0.8100 (0.9388) loss_zs_kd 0.8176 (0.7536) loss_oracle 0.5729 (0.5214) acc 68.7500 (55.8259) kd_loss 1.0304 (1.1564) lr 1.1874e-03 eta 0:16:05
epoch [24/50] batch [160/319] time 0.140 (0.114) data 0.000 (0.003) loss 1.5023 (1.5312) ce_loss 1.4111 (1.1488) teacher_loss 0.9565 (0.9355) loss_zs_kd 0.5470 (0.7444) loss_oracle 0.4911 (0.5213) acc 40.6250 (56.0938) kd_loss 1.2367 (1.1512) lr 1.1874e-03 eta 0:16:03
epoch [24/50] batch [180/319] time 0.135 (0.113) data 0.000 (0.003) loss 1.8008 (1.5387) ce_loss 1.2939 (1.1514) teacher_loss 1.2295 (0.9376) loss_zs_kd 0.7010 (0.7516) loss_oracle 0.5012 (0.5259) acc 56.2500 (56.0764) kd_loss 1.1056 (1.1500) lr 1.1874e-03 eta 0:15:54
epoch [24/50] batch [200/319] time 0.137 (0.113) data 0.000 (0.003) loss 1.6783 (1.5443) ce_loss 1.1719 (1.1474) teacher_loss 1.0101 (0.9347) loss_zs_kd 0.6733 (0.7518) loss_oracle 0.6009 (0.5344) acc 59.3750 (56.2188) kd_loss 1.1650 (1.1506) lr 1.1874e-03 eta 0:15:52
epoch [24/50] batch [220/319] time 0.087 (0.113) data 0.000 (0.003) loss 1.8522 (1.5505) ce_loss 1.1191 (1.1461) teacher_loss 1.1413 (0.9369) loss_zs_kd 0.7993 (0.7491) loss_oracle 0.6311 (0.5387) acc 62.5000 (56.2926) kd_loss 1.1346 (1.1511) lr 1.1874e-03 eta 0:15:45
epoch [24/50] batch [240/319] time 0.077 (0.111) data 0.000 (0.002) loss 1.7848 (1.5525) ce_loss 1.3408 (1.1402) teacher_loss 1.1595 (0.9354) loss_zs_kd 0.8586 (0.7505) loss_oracle 0.5394 (0.5420) acc 40.6250 (56.6276) kd_loss 1.0590 (1.1526) lr 1.1874e-03 eta 0:15:31
epoch [24/50] batch [260/319] time 0.078 (0.110) data 0.000 (0.002) loss 1.9434 (1.5538) ce_loss 1.3838 (1.1401) teacher_loss 1.2951 (0.9359) loss_zs_kd 0.5775 (0.7502) loss_oracle 0.5905 (0.5429) acc 53.1250 (56.7067) kd_loss 1.1299 (1.1525) lr 1.1874e-03 eta 0:15:19
epoch [24/50] batch [280/319] time 0.104 (0.109) data 0.000 (0.002) loss 1.7699 (1.5537) ce_loss 1.3301 (1.1401) teacher_loss 1.1840 (0.9373) loss_zs_kd 0.7014 (0.7513) loss_oracle 0.5157 (0.5412) acc 34.3750 (56.7411) kd_loss 1.1643 (1.1541) lr 1.1874e-03 eta 0:15:07
epoch [24/50] batch [300/319] time 0.066 (0.108) data 0.000 (0.002) loss 1.3108 (1.5502) ce_loss 1.0020 (1.1374) teacher_loss 0.7958 (0.9353) loss_zs_kd 0.8233 (0.7490) loss_oracle 0.4326 (0.5400) acc 65.6250 (56.9479) kd_loss 1.2138 (1.1553) lr 1.1874e-03 eta 0:14:59
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,748
* accuracy: 62.8%
* error: 37.2%
* macro_f1: 55.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,206
* accuracy: 53.5%
* error: 46.5%
* macro_f1: 23.9%
******* Domain 2 best val acc:      64.5%, epoch: 22 *******
******* Domain 2 best val test acc: 53.8%, epoch: 22 *******
******* Domain 2 best test acc:     55.9%, epoch: 23 *******
epoch [25/50] batch [20/319] time 0.146 (0.146) data 0.000 (0.031) loss 1.4245 (1.5571) ce_loss 1.0762 (1.1266) teacher_loss 0.9006 (0.9740) loss_zs_kd 0.7155 (0.7478) loss_oracle 0.4523 (0.5083) acc 56.2500 (58.7500) kd_loss 1.1218 (1.1980) lr 1.1253e-03 eta 0:20:08
epoch [25/50] batch [40/319] time 0.107 (0.120) data 0.000 (0.016) loss 1.7119 (1.5719) ce_loss 1.2871 (1.1441) teacher_loss 1.0841 (0.9849) loss_zs_kd 0.7053 (0.7383) loss_oracle 0.5573 (0.5132) acc 40.6250 (56.9531) kd_loss 1.1449 (1.1935) lr 1.1253e-03 eta 0:16:27
epoch [25/50] batch [60/319] time 0.083 (0.111) data 0.000 (0.010) loss 1.8778 (1.5622) ce_loss 1.2607 (1.1447) teacher_loss 1.4048 (0.9835) loss_zs_kd 0.7737 (0.7253) loss_oracle 0.3957 (0.5062) acc 59.3750 (56.4583) kd_loss 1.1215 (1.1886) lr 1.1253e-03 eta 0:15:14
epoch [25/50] batch [80/319] time 0.105 (0.109) data 0.000 (0.008) loss 1.2638 (1.5484) ce_loss 1.0273 (1.1461) teacher_loss 0.7939 (0.9791) loss_zs_kd 0.6898 (0.7203) loss_oracle 0.4009 (0.4973) acc 56.2500 (56.5234) kd_loss 1.1173 (1.1931) lr 1.1253e-03 eta 0:14:56
epoch [25/50] batch [100/319] time 0.075 (0.108) data 0.000 (0.006) loss 1.7417 (1.5392) ce_loss 1.1943 (1.1369) teacher_loss 1.1539 (0.9649) loss_zs_kd 0.7236 (0.7228) loss_oracle 0.5155 (0.5020) acc 59.3750 (57.1875) kd_loss 1.2176 (1.1999) lr 1.1253e-03 eta 0:14:45
epoch [25/50] batch [120/319] time 0.124 (0.109) data 0.000 (0.005) loss 1.4528 (1.5492) ce_loss 1.1348 (1.1419) teacher_loss 0.8598 (0.9672) loss_zs_kd 0.9201 (0.7276) loss_oracle 0.5010 (0.5092) acc 56.2500 (57.0312) kd_loss 1.1014 (1.2021) lr 1.1253e-03 eta 0:14:51
epoch [25/50] batch [140/319] time 0.112 (0.110) data 0.000 (0.005) loss 1.5932 (1.5486) ce_loss 1.2051 (1.1375) teacher_loss 1.0263 (0.9665) loss_zs_kd 0.7898 (0.7281) loss_oracle 0.4879 (0.5093) acc 50.0000 (56.9866) kd_loss 1.1580 (1.1929) lr 1.1253e-03 eta 0:14:54
epoch [25/50] batch [160/319] time 0.150 (0.110) data 0.000 (0.004) loss 1.5782 (1.5473) ce_loss 1.1572 (1.1375) teacher_loss 0.9539 (0.9655) loss_zs_kd 0.7898 (0.7220) loss_oracle 0.5453 (0.5097) acc 65.6250 (57.2266) kd_loss 1.1238 (1.1854) lr 1.1253e-03 eta 0:14:57
epoch [25/50] batch [180/319] time 0.150 (0.115) data 0.000 (0.004) loss 1.4160 (1.5428) ce_loss 1.0430 (1.1293) teacher_loss 0.8691 (0.9641) loss_zs_kd 0.6815 (0.7246) loss_oracle 0.4787 (0.5062) acc 59.3750 (57.8646) kd_loss 1.1335 (1.1791) lr 1.1253e-03 eta 0:15:33
epoch [25/50] batch [200/319] time 0.143 (0.115) data 0.000 (0.003) loss 1.5833 (1.5410) ce_loss 1.1221 (1.1242) teacher_loss 0.9626 (0.9618) loss_zs_kd 0.7726 (0.7321) loss_oracle 0.5434 (0.5059) acc 50.0000 (58.0625) kd_loss 0.9664 (1.1731) lr 1.1253e-03 eta 0:15:30
epoch [25/50] batch [220/319] time 0.134 (0.114) data 0.000 (0.003) loss 1.6288 (1.5461) ce_loss 1.0186 (1.1260) teacher_loss 0.9576 (0.9656) loss_zs_kd 0.7506 (0.7323) loss_oracle 0.5962 (0.5072) acc 53.1250 (58.0540) kd_loss 1.1589 (1.1669) lr 1.1253e-03 eta 0:15:22
epoch [25/50] batch [240/319] time 0.119 (0.114) data 0.000 (0.003) loss 1.7763 (1.5446) ce_loss 1.2305 (1.1193) teacher_loss 1.1457 (0.9622) loss_zs_kd 0.8204 (0.7321) loss_oracle 0.5485 (0.5093) acc 43.7500 (58.3203) kd_loss 1.1405 (1.1622) lr 1.1253e-03 eta 0:15:15
epoch [25/50] batch [260/319] time 0.105 (0.113) data 0.000 (0.003) loss 1.5431 (1.5494) ce_loss 1.1729 (1.1187) teacher_loss 0.9525 (0.9639) loss_zs_kd 0.8172 (0.7343) loss_oracle 0.5088 (0.5120) acc 43.7500 (58.2091) kd_loss 1.2410 (1.1578) lr 1.1253e-03 eta 0:15:10
epoch [25/50] batch [280/319] time 0.081 (0.113) data 0.000 (0.002) loss 1.8490 (1.5526) ce_loss 1.2549 (1.1175) teacher_loss 1.1318 (0.9632) loss_zs_kd 0.7366 (0.7357) loss_oracle 0.6435 (0.5158) acc 56.2500 (58.2924) kd_loss 1.0800 (1.1549) lr 1.1253e-03 eta 0:15:04
epoch [25/50] batch [300/319] time 0.191 (0.114) data 0.000 (0.002) loss 1.5889 (1.5571) ce_loss 1.0811 (1.1170) teacher_loss 0.9848 (0.9654) loss_zs_kd 0.6233 (0.7331) loss_oracle 0.5418 (0.5184) acc 65.6250 (58.2188) kd_loss 1.0677 (1.1523) lr 1.1253e-03 eta 0:15:10
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,833
* accuracy: 64.7%
* error: 35.3%
* macro_f1: 57.0%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,381
* accuracy: 55.3%
* error: 44.7%
* macro_f1: 24.0%
******* Domain 2 best val acc:      64.7%, epoch: 25 *******
******* Domain 2 best val test acc: 55.3%, epoch: 25 *******
******* Domain 2 best test acc:     55.9%, epoch: 23 *******
epoch [26/50] batch [20/319] time 0.122 (0.173) data 0.000 (0.032) loss 1.6811 (1.6647) ce_loss 1.2227 (1.1409) teacher_loss 1.1190 (1.0720) loss_zs_kd 0.5724 (0.7300) loss_oracle 0.5049 (0.5196) acc 56.2500 (55.7812) kd_loss 1.1120 (1.1356) lr 1.0628e-03 eta 0:22:56
epoch [26/50] batch [40/319] time 0.152 (0.157) data 0.000 (0.016) loss 1.4696 (1.6239) ce_loss 1.0020 (1.1137) teacher_loss 0.9383 (1.0204) loss_zs_kd 0.7916 (0.7238) loss_oracle 0.4522 (0.5310) acc 62.5000 (56.4844) kd_loss 1.0870 (1.1417) lr 1.0628e-03 eta 0:20:45
epoch [26/50] batch [60/319] time 0.127 (0.151) data 0.000 (0.011) loss 1.5750 (1.5930) ce_loss 1.0654 (1.0985) teacher_loss 0.9636 (0.9892) loss_zs_kd 0.6465 (0.7350) loss_oracle 0.5468 (0.5303) acc 65.6250 (57.7083) kd_loss 1.0648 (1.1414) lr 1.0628e-03 eta 0:19:52
epoch [26/50] batch [80/319] time 0.140 (0.142) data 0.000 (0.008) loss 1.4981 (1.5962) ce_loss 1.0918 (1.1062) teacher_loss 0.9312 (0.9962) loss_zs_kd 0.8841 (0.7325) loss_oracle 0.4785 (0.5268) acc 68.7500 (58.0078) kd_loss 1.1501 (1.1450) lr 1.0628e-03 eta 0:18:44
epoch [26/50] batch [100/319] time 0.143 (0.138) data 0.000 (0.007) loss 1.6392 (1.5849) ce_loss 1.0977 (1.1050) teacher_loss 1.0112 (0.9905) loss_zs_kd 0.7036 (0.7356) loss_oracle 0.5577 (0.5208) acc 50.0000 (58.1875) kd_loss 1.2040 (1.1406) lr 1.0628e-03 eta 0:18:04
epoch [26/50] batch [120/319] time 0.076 (0.135) data 0.000 (0.006) loss 1.7308 (1.5769) ce_loss 1.1641 (1.0985) teacher_loss 1.1367 (0.9843) loss_zs_kd 0.7329 (0.7436) loss_oracle 0.5209 (0.5183) acc 50.0000 (58.6198) kd_loss 1.1436 (1.1436) lr 1.0628e-03 eta 0:17:38
epoch [26/50] batch [140/319] time 0.149 (0.132) data 0.000 (0.005) loss 1.5747 (1.5695) ce_loss 1.1406 (1.0958) teacher_loss 1.1000 (0.9809) loss_zs_kd 0.7649 (0.7415) loss_oracle 0.3982 (0.5145) acc 56.2500 (58.5045) kd_loss 1.0871 (1.1505) lr 1.0628e-03 eta 0:17:15
epoch [26/50] batch [160/319] time 0.189 (0.132) data 0.000 (0.004) loss 1.3731 (1.5625) ce_loss 1.0469 (1.0937) teacher_loss 0.9256 (0.9764) loss_zs_kd 0.6934 (0.7416) loss_oracle 0.3782 (0.5119) acc 62.5000 (58.5938) kd_loss 1.2402 (1.1573) lr 1.0628e-03 eta 0:17:07
epoch [26/50] batch [180/319] time 0.071 (0.130) data 0.000 (0.004) loss 1.4108 (1.5597) ce_loss 0.9360 (1.0935) teacher_loss 0.8031 (0.9747) loss_zs_kd 0.7259 (0.7445) loss_oracle 0.5351 (0.5105) acc 62.5000 (58.6285) kd_loss 1.0431 (1.1534) lr 1.0628e-03 eta 0:16:52
epoch [26/50] batch [200/319] time 0.171 (0.134) data 0.000 (0.003) loss 1.8394 (1.5516) ce_loss 1.3379 (1.0930) teacher_loss 1.2077 (0.9699) loss_zs_kd 0.7349 (0.7460) loss_oracle 0.5583 (0.5071) acc 43.7500 (58.6719) kd_loss 1.0910 (1.1478) lr 1.0628e-03 eta 0:17:18
epoch [26/50] batch [220/319] time 0.141 (0.132) data 0.000 (0.003) loss 1.3130 (1.5497) ce_loss 0.8560 (1.0955) teacher_loss 0.7672 (0.9665) loss_zs_kd 0.6182 (0.7544) loss_oracle 0.4840 (0.5077) acc 65.6250 (58.5653) kd_loss 1.1300 (1.1487) lr 1.0628e-03 eta 0:17:07
epoch [26/50] batch [240/319] time 0.137 (0.131) data 0.000 (0.003) loss 1.4304 (1.5456) ce_loss 1.2061 (1.0991) teacher_loss 0.8060 (0.9614) loss_zs_kd 0.8092 (0.7567) loss_oracle 0.5435 (0.5085) acc 59.3750 (58.4896) kd_loss 1.1992 (1.1507) lr 1.0628e-03 eta 0:16:52
epoch [26/50] batch [260/319] time 0.081 (0.129) data 0.000 (0.003) loss 1.3193 (1.5412) ce_loss 0.9492 (1.0976) teacher_loss 0.7176 (0.9556) loss_zs_kd 0.7300 (0.7612) loss_oracle 0.5287 (0.5095) acc 62.5000 (58.7380) kd_loss 1.0165 (1.1496) lr 1.0628e-03 eta 0:16:33
epoch [26/50] batch [280/319] time 0.090 (0.127) data 0.000 (0.003) loss 1.4756 (1.5453) ce_loss 0.9263 (1.1010) teacher_loss 0.8762 (0.9587) loss_zs_kd 0.6389 (0.7603) loss_oracle 0.5354 (0.5105) acc 62.5000 (58.5603) kd_loss 1.1218 (1.1495) lr 1.0628e-03 eta 0:16:15
epoch [26/50] batch [300/319] time 0.097 (0.126) data 0.000 (0.002) loss 2.1519 (1.5521) ce_loss 1.6504 (1.1050) teacher_loss 1.4050 (0.9622) loss_zs_kd 0.8133 (0.7554) loss_oracle 0.6655 (0.5143) acc 31.2500 (58.2812) kd_loss 1.1839 (1.1483) lr 1.0628e-03 eta 0:16:03
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,814
* accuracy: 64.3%
* error: 35.7%
* macro_f1: 55.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,980
* accuracy: 51.2%
* error: 48.8%
* macro_f1: 22.6%
******* Domain 2 best val acc:      64.7%, epoch: 25 *******
******* Domain 2 best val test acc: 55.3%, epoch: 25 *******
******* Domain 2 best test acc:     55.9%, epoch: 23 *******
epoch [27/50] batch [20/319] time 0.106 (0.140) data 0.000 (0.028) loss 1.3561 (1.5270) ce_loss 0.9619 (1.1085) teacher_loss 0.9039 (0.9430) loss_zs_kd 0.5672 (0.7462) loss_oracle 0.3954 (0.5093) acc 65.6250 (57.9688) kd_loss 1.1191 (1.1066) lr 1.0000e-03 eta 0:17:51
epoch [27/50] batch [40/319] time 0.181 (0.123) data 0.000 (0.014) loss 1.4362 (1.5325) ce_loss 0.8521 (1.1041) teacher_loss 0.8108 (0.9505) loss_zs_kd 0.8900 (0.7591) loss_oracle 0.5364 (0.5061) acc 71.8750 (58.8281) kd_loss 0.9851 (1.0936) lr 1.0000e-03 eta 0:15:39
epoch [27/50] batch [60/319] time 0.073 (0.135) data 0.000 (0.009) loss 1.6191 (1.5162) ce_loss 0.9473 (1.0798) teacher_loss 1.0089 (0.9406) loss_zs_kd 0.8707 (0.7401) loss_oracle 0.5231 (0.5016) acc 75.0000 (60.2083) kd_loss 1.0749 (1.0828) lr 1.0000e-03 eta 0:17:09
epoch [27/50] batch [80/319] time 0.207 (0.145) data 0.000 (0.007) loss 1.7030 (1.5129) ce_loss 1.2520 (1.0707) teacher_loss 1.1287 (0.9311) loss_zs_kd 0.8855 (0.7503) loss_oracle 0.4858 (0.5069) acc 50.0000 (60.5469) kd_loss 1.0941 (1.0906) lr 1.0000e-03 eta 0:18:16
epoch [27/50] batch [100/319] time 0.145 (0.140) data 0.000 (0.006) loss 1.4852 (1.5192) ce_loss 0.9307 (1.0664) teacher_loss 0.9330 (0.9319) loss_zs_kd 0.8581 (0.7659) loss_oracle 0.4664 (0.5107) acc 65.6250 (60.7188) kd_loss 1.1806 (1.0848) lr 1.0000e-03 eta 0:17:39
epoch [27/50] batch [120/319] time 0.093 (0.136) data 0.000 (0.005) loss 1.4525 (1.5222) ce_loss 1.0918 (1.0760) teacher_loss 0.9024 (0.9388) loss_zs_kd 0.8632 (0.7703) loss_oracle 0.4638 (0.5063) acc 62.5000 (60.4427) kd_loss 1.0635 (1.0933) lr 1.0000e-03 eta 0:17:04
epoch [27/50] batch [140/319] time 0.133 (0.132) data 0.000 (0.004) loss 1.4015 (1.5218) ce_loss 1.0361 (1.0795) teacher_loss 0.8129 (0.9347) loss_zs_kd 0.7618 (0.7748) loss_oracle 0.5124 (0.5096) acc 53.1250 (60.2455) kd_loss 1.1738 (1.0954) lr 1.0000e-03 eta 0:16:35
epoch [27/50] batch [160/319] time 0.095 (0.131) data 0.000 (0.004) loss 1.2818 (1.5190) ce_loss 0.9395 (1.0781) teacher_loss 0.6841 (0.9305) loss_zs_kd 0.8065 (0.7876) loss_oracle 0.5171 (0.5097) acc 62.5000 (60.2734) kd_loss 1.1723 (1.1002) lr 1.0000e-03 eta 0:16:19
epoch [27/50] batch [180/319] time 0.089 (0.129) data 0.000 (0.003) loss 1.3003 (1.5178) ce_loss 0.9419 (1.0791) teacher_loss 0.6555 (0.9294) loss_zs_kd 0.7091 (0.7942) loss_oracle 0.5739 (0.5090) acc 71.8750 (60.3299) kd_loss 1.2467 (1.1000) lr 1.0000e-03 eta 0:16:02
epoch [27/50] batch [200/319] time 0.145 (0.128) data 0.000 (0.003) loss 1.3078 (1.5188) ce_loss 0.9102 (1.0824) teacher_loss 0.7201 (0.9313) loss_zs_kd 0.9444 (0.7979) loss_oracle 0.4932 (0.5078) acc 65.6250 (60.1875) kd_loss 1.1509 (1.1018) lr 1.0000e-03 eta 0:15:52
epoch [27/50] batch [220/319] time 0.142 (0.127) data 0.000 (0.003) loss 1.5890 (1.5209) ce_loss 1.1436 (1.0856) teacher_loss 1.0252 (0.9351) loss_zs_kd 0.7866 (0.7975) loss_oracle 0.4852 (0.5061) acc 53.1250 (60.0710) kd_loss 1.0331 (1.1049) lr 1.0000e-03 eta 0:15:43
epoch [27/50] batch [240/319] time 0.112 (0.126) data 0.000 (0.002) loss 1.7911 (1.5254) ce_loss 1.1914 (1.0905) teacher_loss 1.1188 (0.9391) loss_zs_kd 0.7341 (0.7963) loss_oracle 0.5989 (0.5066) acc 50.0000 (59.8958) kd_loss 1.1353 (1.1055) lr 1.0000e-03 eta 0:15:32
epoch [27/50] batch [260/319] time 0.145 (0.126) data 0.000 (0.002) loss 1.3698 (1.5228) ce_loss 1.0273 (1.0915) teacher_loss 0.8836 (0.9389) loss_zs_kd 0.8199 (0.7906) loss_oracle 0.4042 (0.5048) acc 65.6250 (59.8197) kd_loss 1.1788 (1.1072) lr 1.0000e-03 eta 0:15:35
epoch [27/50] batch [280/319] time 0.160 (0.128) data 0.000 (0.002) loss 1.7454 (1.5260) ce_loss 1.3389 (1.0944) teacher_loss 1.1256 (0.9425) loss_zs_kd 0.8522 (0.7848) loss_oracle 0.5345 (0.5050) acc 40.6250 (59.6317) kd_loss 1.1459 (1.1087) lr 1.0000e-03 eta 0:15:46
epoch [27/50] batch [300/319] time 0.148 (0.130) data 0.000 (0.002) loss 1.9011 (1.5255) ce_loss 1.4375 (1.0936) teacher_loss 1.1742 (0.9414) loss_zs_kd 0.9006 (0.7792) loss_oracle 0.6368 (0.5062) acc 46.8750 (59.5104) kd_loss 1.1106 (1.1110) lr 1.0000e-03 eta 0:15:55
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,761
* accuracy: 63.1%
* error: 36.9%
* macro_f1: 56.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,521
* accuracy: 56.7%
* error: 43.3%
* macro_f1: 26.0%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      64.7%, epoch: 25 *******
******* Domain 2 best val test acc: 55.3%, epoch: 25 *******
******* Domain 2 best test acc:     56.7%, epoch: 27 *******
epoch [28/50] batch [20/319] time 0.124 (0.174) data 0.000 (0.033) loss 1.7845 (1.5818) ce_loss 1.0684 (1.1254) teacher_loss 1.0832 (0.9572) loss_zs_kd 0.7814 (0.7501) loss_oracle 0.6232 (0.5495) acc 65.6250 (57.0312) kd_loss 1.0738 (1.2243) lr 9.3721e-04 eta 0:21:15
epoch [28/50] batch [40/319] time 0.086 (0.142) data 0.000 (0.017) loss 1.6907 (1.5664) ce_loss 1.1680 (1.1062) teacher_loss 1.1495 (0.9604) loss_zs_kd 0.7665 (0.7192) loss_oracle 0.4645 (0.5342) acc 56.2500 (59.0625) kd_loss 1.1799 (1.1981) lr 9.3721e-04 eta 0:17:13
epoch [28/50] batch [60/319] time 0.122 (0.133) data 0.001 (0.011) loss 1.3828 (1.5859) ce_loss 1.0840 (1.1239) teacher_loss 0.8144 (0.9795) loss_zs_kd 0.7199 (0.7195) loss_oracle 0.4965 (0.5345) acc 62.5000 (57.9167) kd_loss 1.2489 (1.1968) lr 9.3721e-04 eta 0:16:11
epoch [28/50] batch [80/319] time 0.136 (0.127) data 0.000 (0.008) loss 1.4797 (1.5535) ce_loss 1.2559 (1.1106) teacher_loss 0.8792 (0.9432) loss_zs_kd 0.7400 (0.7177) loss_oracle 0.5265 (0.5385) acc 43.7500 (58.3984) kd_loss 1.2493 (1.2061) lr 9.3721e-04 eta 0:15:23
epoch [28/50] batch [100/319] time 0.156 (0.128) data 0.000 (0.007) loss 1.4795 (1.5435) ce_loss 1.1680 (1.1100) teacher_loss 0.8251 (0.9357) loss_zs_kd 0.8483 (0.7417) loss_oracle 0.5696 (0.5336) acc 53.1250 (59.0000) kd_loss 1.1783 (1.2063) lr 9.3721e-04 eta 0:15:27
epoch [28/50] batch [120/319] time 0.126 (0.131) data 0.000 (0.006) loss 1.4854 (1.5331) ce_loss 1.0449 (1.1095) teacher_loss 0.9251 (0.9293) loss_zs_kd 0.9482 (0.7533) loss_oracle 0.4654 (0.5284) acc 68.7500 (58.7760) kd_loss 1.2412 (1.2105) lr 9.3721e-04 eta 0:15:44
epoch [28/50] batch [140/319] time 0.094 (0.128) data 0.000 (0.005) loss 1.2730 (1.5252) ce_loss 1.0479 (1.1130) teacher_loss 0.7447 (0.9289) loss_zs_kd 0.8725 (0.7626) loss_oracle 0.4411 (0.5200) acc 50.0000 (58.7277) kd_loss 1.2594 (1.2128) lr 9.3721e-04 eta 0:15:18
epoch [28/50] batch [160/319] time 0.137 (0.126) data 0.000 (0.004) loss 1.3835 (1.5180) ce_loss 0.8940 (1.1121) teacher_loss 0.8290 (0.9311) loss_zs_kd 0.8978 (0.7558) loss_oracle 0.4647 (0.5113) acc 65.6250 (58.6914) kd_loss 1.2712 (1.2147) lr 9.3721e-04 eta 0:15:07
epoch [28/50] batch [180/319] time 0.137 (0.126) data 0.000 (0.004) loss 1.3376 (1.5063) ce_loss 1.0137 (1.1048) teacher_loss 0.7786 (0.9212) loss_zs_kd 0.6825 (0.7530) loss_oracle 0.4908 (0.5098) acc 56.2500 (58.9410) kd_loss 1.2291 (1.2165) lr 9.3721e-04 eta 0:14:59
epoch [28/50] batch [200/319] time 0.087 (0.127) data 0.000 (0.003) loss 1.7345 (1.5143) ce_loss 1.1904 (1.1085) teacher_loss 1.1028 (0.9274) loss_zs_kd 0.7364 (0.7555) loss_oracle 0.5581 (0.5114) acc 56.2500 (58.8125) kd_loss 1.2220 (1.2209) lr 9.3721e-04 eta 0:15:06
epoch [28/50] batch [220/319] time 0.083 (0.126) data 0.000 (0.003) loss 1.5870 (1.5203) ce_loss 1.2109 (1.1114) teacher_loss 1.0686 (0.9323) loss_zs_kd 0.7026 (0.7565) loss_oracle 0.4481 (0.5124) acc 50.0000 (58.5227) kd_loss 1.1732 (1.2256) lr 9.3721e-04 eta 0:14:54
epoch [28/50] batch [240/319] time 0.127 (0.126) data 0.000 (0.003) loss 1.5798 (1.5266) ce_loss 1.1182 (1.1106) teacher_loss 1.0093 (0.9349) loss_zs_kd 0.7505 (0.7593) loss_oracle 0.4954 (0.5158) acc 62.5000 (58.5026) kd_loss 1.2142 (1.2289) lr 9.3721e-04 eta 0:14:51
epoch [28/50] batch [260/319] time 0.098 (0.125) data 0.000 (0.003) loss 1.3550 (1.5252) ce_loss 1.0000 (1.1101) teacher_loss 0.7433 (0.9318) loss_zs_kd 0.7957 (0.7600) loss_oracle 0.5322 (0.5174) acc 65.6250 (58.4495) kd_loss 1.2769 (1.2266) lr 9.3721e-04 eta 0:14:43
epoch [28/50] batch [280/319] time 0.134 (0.124) data 0.000 (0.003) loss 1.5074 (1.5238) ce_loss 1.0684 (1.1078) teacher_loss 0.9216 (0.9298) loss_zs_kd 0.8193 (0.7636) loss_oracle 0.5039 (0.5176) acc 65.6250 (58.4598) kd_loss 1.3434 (1.2262) lr 9.3721e-04 eta 0:14:36
epoch [28/50] batch [300/319] time 0.195 (0.124) data 0.000 (0.002) loss 1.9028 (1.5296) ce_loss 1.3672 (1.1103) teacher_loss 1.1785 (0.9325) loss_zs_kd 0.7184 (0.7646) loss_oracle 0.6525 (0.5207) acc 50.0000 (58.3854) kd_loss 1.3157 (1.2304) lr 9.3721e-04 eta 0:14:35
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,726
* accuracy: 62.3%
* error: 37.7%
* macro_f1: 55.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,618
* accuracy: 57.7%
* error: 42.3%
* macro_f1: 25.8%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      64.7%, epoch: 25 *******
******* Domain 2 best val test acc: 55.3%, epoch: 25 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
epoch [29/50] batch [20/319] time 0.129 (0.150) data 0.000 (0.030) loss 1.7662 (1.5656) ce_loss 1.4512 (1.1086) teacher_loss 1.0881 (0.9268) loss_zs_kd 0.6945 (0.7047) loss_oracle 0.6087 (0.5682) acc 43.7500 (59.2188) kd_loss 1.2196 (1.2243) lr 8.7467e-04 eta 0:17:26
epoch [29/50] batch [40/319] time 0.092 (0.138) data 0.000 (0.015) loss 1.5512 (1.5762) ce_loss 1.1387 (1.1026) teacher_loss 1.0570 (0.9546) loss_zs_kd 0.6464 (0.6903) loss_oracle 0.4295 (0.5525) acc 62.5000 (59.7656) kd_loss 1.2521 (1.2006) lr 8.7467e-04 eta 0:16:01
epoch [29/50] batch [60/319] time 0.143 (0.131) data 0.001 (0.010) loss 1.4158 (1.5658) ce_loss 1.0342 (1.1150) teacher_loss 0.8061 (0.9537) loss_zs_kd 0.7953 (0.7002) loss_oracle 0.5301 (0.5421) acc 53.1250 (59.0104) kd_loss 1.1311 (1.2065) lr 8.7467e-04 eta 0:15:09
epoch [29/50] batch [80/319] time 0.160 (0.136) data 0.000 (0.008) loss 1.3691 (1.5709) ce_loss 1.0078 (1.1147) teacher_loss 0.8218 (0.9563) loss_zs_kd 0.7958 (0.7146) loss_oracle 0.4678 (0.5431) acc 59.3750 (59.1016) kd_loss 1.0451 (1.2081) lr 8.7467e-04 eta 0:15:45
epoch [29/50] batch [100/319] time 0.150 (0.139) data 0.000 (0.006) loss 1.5761 (1.5586) ce_loss 1.1475 (1.1091) teacher_loss 0.9780 (0.9516) loss_zs_kd 0.7998 (0.7150) loss_oracle 0.5181 (0.5355) acc 56.2500 (59.1562) kd_loss 1.1138 (1.2039) lr 8.7467e-04 eta 0:16:02
epoch [29/50] batch [120/319] time 0.152 (0.141) data 0.000 (0.005) loss 1.5419 (1.5559) ce_loss 1.0430 (1.1066) teacher_loss 0.9533 (0.9513) loss_zs_kd 0.5904 (0.7155) loss_oracle 0.5296 (0.5331) acc 56.2500 (58.9062) kd_loss 1.3022 (1.1983) lr 8.7467e-04 eta 0:16:15
epoch [29/50] batch [140/319] time 0.081 (0.140) data 0.000 (0.004) loss 1.9180 (1.5522) ce_loss 1.3877 (1.1002) teacher_loss 1.2988 (0.9530) loss_zs_kd 0.7768 (0.7113) loss_oracle 0.5415 (0.5281) acc 37.5000 (59.0179) kd_loss 1.1438 (1.1936) lr 8.7467e-04 eta 0:16:02
epoch [29/50] batch [160/319] time 0.189 (0.143) data 0.000 (0.004) loss 1.7371 (1.5634) ce_loss 1.1875 (1.1078) teacher_loss 1.1291 (0.9624) loss_zs_kd 0.5932 (0.7128) loss_oracle 0.5487 (0.5297) acc 56.2500 (58.3789) kd_loss 1.1853 (1.1897) lr 8.7467e-04 eta 0:16:17
epoch [29/50] batch [180/319] time 0.190 (0.140) data 0.000 (0.004) loss 1.6582 (1.5668) ce_loss 1.1738 (1.1092) teacher_loss 1.1315 (0.9653) loss_zs_kd 0.5492 (0.7132) loss_oracle 0.4717 (0.5302) acc 59.3750 (58.2292) kd_loss 1.1786 (1.1850) lr 8.7467e-04 eta 0:15:55
epoch [29/50] batch [200/319] time 0.083 (0.143) data 0.000 (0.003) loss 1.6611 (1.5776) ce_loss 1.2129 (1.1157) teacher_loss 1.1357 (0.9753) loss_zs_kd 0.7719 (0.7115) loss_oracle 0.4483 (0.5311) acc 46.8750 (58.0000) kd_loss 1.1249 (1.1803) lr 8.7467e-04 eta 0:16:14
epoch [29/50] batch [220/319] time 0.147 (0.143) data 0.000 (0.003) loss 1.9622 (1.5767) ce_loss 1.4785 (1.1135) teacher_loss 1.3554 (0.9749) loss_zs_kd 0.6676 (0.7042) loss_oracle 0.5400 (0.5314) acc 43.7500 (57.9403) kd_loss 1.1782 (1.1779) lr 8.7467e-04 eta 0:16:13
epoch [29/50] batch [240/319] time 0.088 (0.141) data 0.000 (0.003) loss 1.7608 (1.5782) ce_loss 1.1826 (1.1120) teacher_loss 1.2338 (0.9770) loss_zs_kd 0.8368 (0.7090) loss_oracle 0.4433 (0.5303) acc 59.3750 (58.2031) kd_loss 1.0549 (1.1744) lr 8.7467e-04 eta 0:15:56
epoch [29/50] batch [260/319] time 0.158 (0.140) data 0.000 (0.003) loss 1.5096 (1.5841) ce_loss 0.9546 (1.1140) teacher_loss 0.9307 (0.9801) loss_zs_kd 0.7711 (0.7101) loss_oracle 0.5018 (0.5330) acc 65.6250 (57.9688) kd_loss 1.1058 (1.1714) lr 8.7467e-04 eta 0:15:46
epoch [29/50] batch [280/319] time 0.160 (0.141) data 0.000 (0.002) loss 1.5495 (1.5891) ce_loss 1.1074 (1.1149) teacher_loss 1.0421 (0.9834) loss_zs_kd 0.6675 (0.7095) loss_oracle 0.4407 (0.5347) acc 56.2500 (57.9576) kd_loss 1.3068 (1.1710) lr 8.7467e-04 eta 0:15:48
epoch [29/50] batch [300/319] time 0.153 (0.142) data 0.000 (0.002) loss 1.5882 (1.5890) ce_loss 1.2471 (1.1147) teacher_loss 0.9117 (0.9844) loss_zs_kd 0.7432 (0.7080) loss_oracle 0.6022 (0.5338) acc 46.8750 (58.0833) kd_loss 1.2330 (1.1698) lr 8.7467e-04 eta 0:15:50
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,831
* accuracy: 64.7%
* error: 35.3%
* macro_f1: 56.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,408
* accuracy: 55.5%
* error: 44.5%
* macro_f1: 23.8%
******* Domain 2 best val acc:      64.7%, epoch: 25 *******
******* Domain 2 best val test acc: 55.3%, epoch: 25 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
epoch [30/50] batch [20/319] time 0.076 (0.186) data 0.000 (0.027) loss 1.4481 (1.6341) ce_loss 0.9990 (1.1787) teacher_loss 0.8323 (1.0103) loss_zs_kd 0.6718 (0.6874) loss_oracle 0.5487 (0.5551) acc 56.2500 (53.9062) kd_loss 1.2312 (1.1769) lr 8.1262e-04 eta 0:20:42
epoch [30/50] batch [40/319] time 0.185 (0.179) data 0.000 (0.014) loss 1.7305 (1.6435) ce_loss 1.0684 (1.1546) teacher_loss 0.9691 (1.0146) loss_zs_kd 0.6953 (0.7104) loss_oracle 0.6919 (0.5579) acc 59.3750 (55.4688) kd_loss 1.1289 (1.1358) lr 8.1262e-04 eta 0:19:53
epoch [30/50] batch [60/319] time 0.132 (0.159) data 0.000 (0.009) loss 1.4395 (1.6312) ce_loss 1.0713 (1.1423) teacher_loss 0.8939 (1.0006) loss_zs_kd 0.7700 (0.7119) loss_oracle 0.4685 (0.5594) acc 68.7500 (56.0417) kd_loss 1.1067 (1.1273) lr 8.1262e-04 eta 0:17:37
epoch [30/50] batch [80/319] time 0.088 (0.146) data 0.000 (0.007) loss 1.5133 (1.6145) ce_loss 1.1387 (1.1318) teacher_loss 0.9013 (0.9932) loss_zs_kd 0.6325 (0.7184) loss_oracle 0.5488 (0.5494) acc 53.1250 (56.3281) kd_loss 1.2598 (1.1232) lr 8.1262e-04 eta 0:16:07
epoch [30/50] batch [100/319] time 0.146 (0.143) data 0.000 (0.006) loss 1.4756 (1.6088) ce_loss 0.9692 (1.1312) teacher_loss 0.8392 (0.9912) loss_zs_kd 0.7555 (0.7138) loss_oracle 0.5609 (0.5462) acc 65.6250 (56.1250) kd_loss 1.0698 (1.1225) lr 8.1262e-04 eta 0:15:42
epoch [30/50] batch [120/319] time 0.146 (0.145) data 0.000 (0.005) loss 1.4367 (1.6054) ce_loss 1.1055 (1.1351) teacher_loss 0.8762 (0.9921) loss_zs_kd 0.7467 (0.7164) loss_oracle 0.4858 (0.5416) acc 62.5000 (56.3281) kd_loss 1.0998 (1.1211) lr 8.1262e-04 eta 0:15:51
epoch [30/50] batch [140/319] time 0.139 (0.146) data 0.000 (0.004) loss 1.3558 (1.5881) ce_loss 0.8569 (1.1233) teacher_loss 0.8110 (0.9811) loss_zs_kd 0.7035 (0.7191) loss_oracle 0.4745 (0.5351) acc 62.5000 (57.1429) kd_loss 1.1225 (1.1262) lr 8.1262e-04 eta 0:15:55
epoch [30/50] batch [160/319] time 0.142 (0.146) data 0.000 (0.004) loss 1.5488 (1.5861) ce_loss 1.1357 (1.1193) teacher_loss 1.0242 (0.9787) loss_zs_kd 0.4997 (0.7177) loss_oracle 0.4746 (0.5356) acc 53.1250 (57.3633) kd_loss 1.1141 (1.1326) lr 8.1262e-04 eta 0:15:56
epoch [30/50] batch [180/319] time 0.089 (0.141) data 0.000 (0.003) loss 1.4316 (1.5891) ce_loss 1.0215 (1.1147) teacher_loss 0.8126 (0.9814) loss_zs_kd 0.7298 (0.7099) loss_oracle 0.5460 (0.5368) acc 59.3750 (57.2049) kd_loss 1.1684 (1.1273) lr 8.1262e-04 eta 0:15:22
epoch [30/50] batch [200/319] time 0.088 (0.137) data 0.000 (0.003) loss 1.6091 (1.5873) ce_loss 1.0615 (1.1083) teacher_loss 1.0367 (0.9785) loss_zs_kd 0.6944 (0.7100) loss_oracle 0.5029 (0.5378) acc 56.2500 (57.6719) kd_loss 1.0578 (1.1212) lr 8.1262e-04 eta 0:14:53
epoch [30/50] batch [220/319] time 0.085 (0.135) data 0.000 (0.003) loss 1.3992 (1.5890) ce_loss 0.9199 (1.1064) teacher_loss 0.8147 (0.9772) loss_zs_kd 0.6951 (0.7114) loss_oracle 0.5150 (0.5407) acc 71.8750 (58.0256) kd_loss 1.2675 (1.1270) lr 8.1262e-04 eta 0:14:35
epoch [30/50] batch [240/319] time 0.129 (0.133) data 0.000 (0.002) loss 1.5344 (1.5932) ce_loss 1.0156 (1.1109) teacher_loss 0.8576 (0.9823) loss_zs_kd 0.7364 (0.7129) loss_oracle 0.6031 (0.5396) acc 65.6250 (57.8385) kd_loss 1.2909 (1.1319) lr 8.1262e-04 eta 0:14:20
epoch [30/50] batch [260/319] time 0.099 (0.131) data 0.000 (0.002) loss 1.5173 (1.5884) ce_loss 1.1436 (1.1101) teacher_loss 0.9117 (0.9790) loss_zs_kd 0.7043 (0.7155) loss_oracle 0.5351 (0.5378) acc 62.5000 (58.0048) kd_loss 1.1824 (1.1366) lr 8.1262e-04 eta 0:14:05
epoch [30/50] batch [280/319] time 0.108 (0.130) data 0.000 (0.002) loss 1.4809 (1.5844) ce_loss 1.0801 (1.1051) teacher_loss 0.9866 (0.9756) loss_zs_kd 0.7188 (0.7172) loss_oracle 0.4225 (0.5370) acc 56.2500 (58.2254) kd_loss 1.3305 (1.1417) lr 8.1262e-04 eta 0:13:52
epoch [30/50] batch [300/319] time 0.089 (0.129) data 0.000 (0.002) loss 1.9047 (1.5836) ce_loss 1.4121 (1.1018) teacher_loss 1.3493 (0.9737) loss_zs_kd 0.6701 (0.7173) loss_oracle 0.4883 (0.5381) acc 46.8750 (58.4062) kd_loss 1.2672 (1.1466) lr 8.1262e-04 eta 0:13:43
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,839
* accuracy: 64.8%
* error: 35.2%
* macro_f1: 57.7%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,356
* accuracy: 55.0%
* error: 45.0%
* macro_f1: 25.6%
******* Domain 2 best val acc:      64.8%, epoch: 30 *******
******* Domain 2 best val test acc: 55.0%, epoch: 30 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
epoch [31/50] batch [20/319] time 0.100 (0.144) data 0.000 (0.029) loss 1.4565 (1.5608) ce_loss 0.9263 (1.0274) teacher_loss 0.7825 (0.8826) loss_zs_kd 0.8314 (0.7617) loss_oracle 0.5908 (0.6020) acc 81.2500 (63.2812) kd_loss 1.1531 (1.2073) lr 7.5131e-04 eta 0:15:16
epoch [31/50] batch [40/319] time 0.119 (0.129) data 0.000 (0.015) loss 1.6074 (1.6026) ce_loss 1.1328 (1.0532) teacher_loss 0.9663 (0.9306) loss_zs_kd 0.5827 (0.7539) loss_oracle 0.5828 (0.5966) acc 56.2500 (61.7188) kd_loss 1.0986 (1.1850) lr 7.5131e-04 eta 0:13:38
epoch [31/50] batch [60/319] time 0.089 (0.123) data 0.000 (0.010) loss 1.7614 (1.6212) ce_loss 1.2041 (1.0717) teacher_loss 1.0026 (0.9515) loss_zs_kd 0.7362 (0.7349) loss_oracle 0.6852 (0.5963) acc 53.1250 (60.0000) kd_loss 1.2351 (1.1874) lr 7.5131e-04 eta 0:12:57
epoch [31/50] batch [80/319] time 0.152 (0.126) data 0.000 (0.007) loss 1.7559 (1.6277) ce_loss 1.2588 (1.0751) teacher_loss 1.0850 (0.9607) loss_zs_kd 0.7796 (0.7314) loss_oracle 0.5929 (0.5939) acc 43.7500 (59.9219) kd_loss 1.1279 (1.1842) lr 7.5131e-04 eta 0:13:16
epoch [31/50] batch [100/319] time 0.157 (0.132) data 0.000 (0.006) loss 1.6287 (1.6217) ce_loss 1.2490 (1.0720) teacher_loss 0.9697 (0.9615) loss_zs_kd 0.8218 (0.7236) loss_oracle 0.5769 (0.5879) acc 46.8750 (59.8750) kd_loss 1.2518 (1.1834) lr 7.5131e-04 eta 0:13:46
epoch [31/50] batch [120/319] time 0.157 (0.135) data 0.000 (0.005) loss 1.4208 (1.6195) ce_loss 0.9263 (1.0778) teacher_loss 0.9404 (0.9672) loss_zs_kd 0.6041 (0.7230) loss_oracle 0.4200 (0.5800) acc 68.7500 (59.6615) kd_loss 1.1666 (1.1843) lr 7.5131e-04 eta 0:14:06
epoch [31/50] batch [140/319] time 0.120 (0.137) data 0.000 (0.004) loss 1.5973 (1.6248) ce_loss 1.0332 (1.0860) teacher_loss 0.8999 (0.9681) loss_zs_kd 0.6793 (0.7249) loss_oracle 0.6295 (0.5842) acc 59.3750 (58.9509) kd_loss 1.2495 (1.1836) lr 7.5131e-04 eta 0:14:17
epoch [31/50] batch [160/319] time 0.149 (0.137) data 0.000 (0.004) loss 1.7338 (1.6267) ce_loss 1.2139 (1.0863) teacher_loss 1.0150 (0.9624) loss_zs_kd 0.7895 (0.7329) loss_oracle 0.6399 (0.5910) acc 50.0000 (58.7500) kd_loss 1.1137 (1.1825) lr 7.5131e-04 eta 0:14:12
epoch [31/50] batch [180/319] time 0.157 (0.139) data 0.000 (0.003) loss 1.6521 (1.6344) ce_loss 1.4668 (1.0949) teacher_loss 1.0942 (0.9632) loss_zs_kd 0.6860 (0.7325) loss_oracle 0.4893 (0.5980) acc 53.1250 (58.2986) kd_loss 1.2513 (1.1835) lr 7.5131e-04 eta 0:14:21
epoch [31/50] batch [200/319] time 0.157 (0.140) data 0.000 (0.003) loss 1.4499 (1.6377) ce_loss 1.1250 (1.0984) teacher_loss 0.8803 (0.9646) loss_zs_kd 0.7484 (0.7376) loss_oracle 0.4947 (0.5994) acc 50.0000 (58.4688) kd_loss 1.1885 (1.1814) lr 7.5131e-04 eta 0:14:26
epoch [31/50] batch [220/319] time 0.154 (0.141) data 0.000 (0.003) loss 1.4068 (1.6385) ce_loss 0.9014 (1.0981) teacher_loss 0.7261 (0.9628) loss_zs_kd 0.9343 (0.7375) loss_oracle 0.5873 (0.6020) acc 65.6250 (58.5653) kd_loss 1.3820 (1.1827) lr 7.5131e-04 eta 0:14:30
epoch [31/50] batch [240/319] time 0.154 (0.139) data 0.000 (0.003) loss 1.7601 (1.6395) ce_loss 1.1416 (1.0988) teacher_loss 1.0648 (0.9618) loss_zs_kd 0.5515 (0.7349) loss_oracle 0.6401 (0.6042) acc 53.1250 (58.5547) kd_loss 1.2057 (1.1825) lr 7.5131e-04 eta 0:14:16
epoch [31/50] batch [260/319] time 0.067 (0.141) data 0.000 (0.002) loss 1.5989 (1.6415) ce_loss 1.1992 (1.0992) teacher_loss 0.9063 (0.9599) loss_zs_kd 0.7853 (0.7321) loss_oracle 0.6141 (0.6084) acc 50.0000 (58.4976) kd_loss 1.0665 (1.1827) lr 7.5131e-04 eta 0:14:25
epoch [31/50] batch [280/319] time 0.141 (0.140) data 0.000 (0.002) loss 1.6623 (1.6480) ce_loss 1.0303 (1.1064) teacher_loss 0.8710 (0.9660) loss_zs_kd 0.7606 (0.7304) loss_oracle 0.7152 (0.6089) acc 53.1250 (58.1473) kd_loss 1.0490 (1.1808) lr 7.5131e-04 eta 0:14:12
epoch [31/50] batch [300/319] time 0.083 (0.140) data 0.000 (0.002) loss 1.3571 (1.6510) ce_loss 0.8389 (1.1097) teacher_loss 0.7887 (0.9678) loss_zs_kd 0.7042 (0.7301) loss_oracle 0.4980 (0.6102) acc 75.0000 (57.9792) kd_loss 1.1248 (1.1774) lr 7.5131e-04 eta 0:14:13
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,808
* accuracy: 64.1%
* error: 35.9%
* macro_f1: 56.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,189
* accuracy: 53.3%
* error: 46.7%
* macro_f1: 24.5%
******* Domain 2 best val acc:      64.8%, epoch: 30 *******
******* Domain 2 best val test acc: 55.0%, epoch: 30 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
epoch [32/50] batch [20/319] time 0.141 (0.141) data 0.000 (0.026) loss 1.5170 (1.6695) ce_loss 1.0898 (1.1379) teacher_loss 0.8392 (1.0038) loss_zs_kd 0.8780 (0.7316) loss_oracle 0.5900 (0.5926) acc 53.1250 (54.0625) kd_loss 1.1405 (1.1419) lr 6.9098e-04 eta 0:14:10
epoch [32/50] batch [40/319] time 0.136 (0.125) data 0.000 (0.013) loss 1.8907 (1.6511) ce_loss 1.2148 (1.1351) teacher_loss 1.1987 (0.9859) loss_zs_kd 0.7013 (0.7154) loss_oracle 0.6219 (0.5936) acc 40.6250 (55.3125) kd_loss 1.2058 (1.1681) lr 6.9098e-04 eta 0:12:30
epoch [32/50] batch [60/319] time 0.142 (0.119) data 0.000 (0.009) loss 1.5466 (1.6367) ce_loss 0.9692 (1.1254) teacher_loss 0.8810 (0.9657) loss_zs_kd 0.6139 (0.7243) loss_oracle 0.6042 (0.5985) acc 68.7500 (56.3021) kd_loss 1.2429 (1.1804) lr 6.9098e-04 eta 0:11:56
epoch [32/50] batch [80/319] time 0.152 (0.128) data 0.000 (0.007) loss 1.5447 (1.6280) ce_loss 1.0811 (1.1199) teacher_loss 0.7716 (0.9472) loss_zs_kd 0.7368 (0.7314) loss_oracle 0.6994 (0.6077) acc 46.8750 (56.6797) kd_loss 1.2544 (1.1814) lr 6.9098e-04 eta 0:12:43
epoch [32/50] batch [100/319] time 0.074 (0.131) data 0.000 (0.005) loss 1.5268 (1.6372) ce_loss 1.0469 (1.1305) teacher_loss 0.7826 (0.9547) loss_zs_kd 0.5995 (0.7282) loss_oracle 0.6842 (0.6096) acc 56.2500 (56.3750) kd_loss 1.3084 (1.1858) lr 6.9098e-04 eta 0:13:02
epoch [32/50] batch [120/319] time 0.192 (0.135) data 0.000 (0.004) loss 1.5905 (1.6387) ce_loss 1.1699 (1.1285) teacher_loss 0.8118 (0.9447) loss_zs_kd 0.8343 (0.7248) loss_oracle 0.6953 (0.6215) acc 50.0000 (56.5365) kd_loss 1.2400 (1.1915) lr 6.9098e-04 eta 0:13:20
epoch [32/50] batch [140/319] time 0.185 (0.135) data 0.000 (0.004) loss 1.8360 (1.6413) ce_loss 1.1152 (1.1241) teacher_loss 1.1126 (0.9435) loss_zs_kd 0.8681 (0.7282) loss_oracle 0.6366 (0.6249) acc 53.1250 (56.7411) kd_loss 1.1824 (1.1930) lr 6.9098e-04 eta 0:13:19
epoch [32/50] batch [160/319] time 0.107 (0.138) data 0.000 (0.003) loss 1.7499 (1.6469) ce_loss 1.2617 (1.1290) teacher_loss 1.0962 (0.9467) loss_zs_kd 0.7511 (0.7303) loss_oracle 0.5786 (0.6272) acc 56.2500 (56.6016) kd_loss 1.2130 (1.1968) lr 6.9098e-04 eta 0:13:32
epoch [32/50] batch [180/319] time 0.137 (0.134) data 0.000 (0.003) loss 1.6184 (1.6442) ce_loss 1.1973 (1.1253) teacher_loss 1.0307 (0.9428) loss_zs_kd 0.6759 (0.7325) loss_oracle 0.5201 (0.6281) acc 50.0000 (56.9444) kd_loss 1.0511 (1.1954) lr 6.9098e-04 eta 0:13:09
epoch [32/50] batch [200/319] time 0.118 (0.132) data 0.000 (0.003) loss 1.6750 (1.6483) ce_loss 1.0898 (1.1232) teacher_loss 0.9664 (0.9430) loss_zs_kd 0.6651 (0.7338) loss_oracle 0.6421 (0.6319) acc 53.1250 (57.2031) kd_loss 1.2574 (1.1959) lr 6.9098e-04 eta 0:12:54
epoch [32/50] batch [220/319] time 0.142 (0.131) data 0.000 (0.003) loss 1.6222 (1.6448) ce_loss 1.1416 (1.1191) teacher_loss 0.9422 (0.9386) loss_zs_kd 0.5987 (0.7324) loss_oracle 0.6201 (0.6330) acc 40.6250 (57.3580) kd_loss 1.1872 (1.1937) lr 6.9098e-04 eta 0:12:42
epoch [32/50] batch [240/319] time 0.078 (0.129) data 0.000 (0.002) loss 1.4208 (1.6446) ce_loss 0.9639 (1.1210) teacher_loss 0.7518 (0.9426) loss_zs_kd 0.6530 (0.7283) loss_oracle 0.6037 (0.6291) acc 62.5000 (57.2526) kd_loss 1.2428 (1.1937) lr 6.9098e-04 eta 0:12:30
epoch [32/50] batch [260/319] time 0.138 (0.128) data 0.000 (0.002) loss 1.7319 (1.6475) ce_loss 1.0635 (1.1227) teacher_loss 1.0957 (0.9464) loss_zs_kd 0.7282 (0.7305) loss_oracle 0.5633 (0.6280) acc 53.1250 (57.0793) kd_loss 1.0294 (1.1928) lr 6.9098e-04 eta 0:12:20
epoch [32/50] batch [280/319] time 0.139 (0.126) data 0.000 (0.002) loss 1.8442 (1.6479) ce_loss 1.2129 (1.1221) teacher_loss 1.2807 (0.9502) loss_zs_kd 0.6961 (0.7310) loss_oracle 0.4939 (0.6246) acc 56.2500 (57.2098) kd_loss 1.1250 (1.1920) lr 6.9098e-04 eta 0:12:11
epoch [32/50] batch [300/319] time 0.118 (0.125) data 0.000 (0.002) loss 1.2764 (1.6442) ce_loss 1.0674 (1.1200) teacher_loss 0.7890 (0.9489) loss_zs_kd 0.5645 (0.7338) loss_oracle 0.4310 (0.6219) acc 65.6250 (57.3542) kd_loss 1.1571 (1.1944) lr 6.9098e-04 eta 0:11:59
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,820
* accuracy: 64.4%
* error: 35.6%
* macro_f1: 56.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,341
* accuracy: 54.9%
* error: 45.1%
* macro_f1: 24.3%
******* Domain 2 best val acc:      64.8%, epoch: 30 *******
******* Domain 2 best val test acc: 55.0%, epoch: 30 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
epoch [33/50] batch [20/319] time 0.188 (0.186) data 0.000 (0.033) loss 1.9293 (1.6404) ce_loss 1.4385 (1.1170) teacher_loss 1.2340 (0.9690) loss_zs_kd 0.7150 (0.7407) loss_oracle 0.6238 (0.5974) acc 50.0000 (57.3438) kd_loss 1.1714 (1.2033) lr 6.3188e-04 eta 0:17:46
epoch [33/50] batch [40/319] time 0.090 (0.165) data 0.000 (0.016) loss 1.8586 (1.6478) ce_loss 1.1465 (1.1257) teacher_loss 1.1718 (0.9698) loss_zs_kd 0.8683 (0.7172) loss_oracle 0.6001 (0.6063) acc 56.2500 (57.6562) kd_loss 1.2600 (1.2155) lr 6.3188e-04 eta 0:15:43
epoch [33/50] batch [60/319] time 0.134 (0.149) data 0.000 (0.011) loss 1.4872 (1.6574) ce_loss 0.9170 (1.1228) teacher_loss 0.6022 (0.9519) loss_zs_kd 0.5939 (0.7165) loss_oracle 0.8256 (0.6339) acc 62.5000 (57.4479) kd_loss 1.1623 (1.2090) lr 6.3188e-04 eta 0:14:06
epoch [33/50] batch [80/319] time 0.154 (0.150) data 0.000 (0.008) loss 1.6798 (1.6561) ce_loss 1.1025 (1.1160) teacher_loss 0.8355 (0.9395) loss_zs_kd 0.7519 (0.7213) loss_oracle 0.7691 (0.6444) acc 56.2500 (57.5391) kd_loss 1.1169 (1.1973) lr 6.3188e-04 eta 0:14:07
epoch [33/50] batch [100/319] time 0.106 (0.149) data 0.000 (0.007) loss 1.7931 (1.6581) ce_loss 1.2920 (1.1203) teacher_loss 1.1899 (0.9376) loss_zs_kd 0.6322 (0.7134) loss_oracle 0.5401 (0.6491) acc 46.8750 (57.0625) kd_loss 1.0358 (1.1776) lr 6.3188e-04 eta 0:14:01
epoch [33/50] batch [120/319] time 0.111 (0.144) data 0.000 (0.006) loss 2.0312 (1.6635) ce_loss 1.3096 (1.1156) teacher_loss 1.3565 (0.9413) loss_zs_kd 0.6613 (0.7059) loss_oracle 0.6086 (0.6516) acc 53.1250 (57.1615) kd_loss 1.0068 (1.1678) lr 6.3188e-04 eta 0:13:29
epoch [33/50] batch [140/319] time 0.125 (0.139) data 0.000 (0.005) loss 1.5423 (1.6606) ce_loss 1.0361 (1.1093) teacher_loss 0.8000 (0.9378) loss_zs_kd 0.8037 (0.7038) loss_oracle 0.6619 (0.6525) acc 59.3750 (57.1652) kd_loss 1.0720 (1.1623) lr 6.3188e-04 eta 0:12:55
epoch [33/50] batch [160/319] time 0.098 (0.135) data 0.000 (0.004) loss 1.4562 (1.6610) ce_loss 0.8149 (1.1078) teacher_loss 0.6279 (0.9370) loss_zs_kd 0.6349 (0.7078) loss_oracle 0.7648 (0.6532) acc 75.0000 (57.1680) kd_loss 1.0722 (1.1575) lr 6.3188e-04 eta 0:12:32
epoch [33/50] batch [180/319] time 0.124 (0.133) data 0.000 (0.004) loss 1.4175 (1.6686) ce_loss 1.0732 (1.1190) teacher_loss 0.8502 (0.9431) loss_zs_kd 0.9784 (0.7065) loss_oracle 0.4695 (0.6548) acc 59.3750 (56.6319) kd_loss 1.1668 (1.1584) lr 6.3188e-04 eta 0:12:22
epoch [33/50] batch [200/319] time 0.159 (0.135) data 0.000 (0.003) loss 1.4761 (1.6684) ce_loss 0.9355 (1.1190) teacher_loss 0.7431 (0.9398) loss_zs_kd 1.0347 (0.7119) loss_oracle 0.6296 (0.6574) acc 71.8750 (56.7656) kd_loss 1.2944 (1.1618) lr 6.3188e-04 eta 0:12:26
epoch [33/50] batch [220/319] time 0.088 (0.133) data 0.000 (0.003) loss 1.4547 (1.6657) ce_loss 0.9893 (1.1158) teacher_loss 0.6957 (0.9337) loss_zs_kd 0.6472 (0.7127) loss_oracle 0.6943 (0.6608) acc 65.6250 (56.7898) kd_loss 1.2158 (1.1608) lr 6.3188e-04 eta 0:12:13
epoch [33/50] batch [240/319] time 0.080 (0.131) data 0.000 (0.003) loss 1.8023 (1.6660) ce_loss 1.1797 (1.1173) teacher_loss 0.9144 (0.9307) loss_zs_kd 0.8903 (0.7156) loss_oracle 0.7989 (0.6637) acc 53.1250 (56.7578) kd_loss 1.1545 (1.1617) lr 6.3188e-04 eta 0:11:58
epoch [33/50] batch [260/319] time 0.144 (0.129) data 0.000 (0.003) loss 1.6452 (1.6700) ce_loss 1.2002 (1.1205) teacher_loss 0.9837 (0.9361) loss_zs_kd 0.6312 (0.7157) loss_oracle 0.5984 (0.6623) acc 46.8750 (56.5625) kd_loss 1.0505 (1.1598) lr 6.3188e-04 eta 0:11:45
epoch [33/50] batch [280/319] time 0.142 (0.128) data 0.000 (0.003) loss 1.2705 (1.6700) ce_loss 0.8076 (1.1177) teacher_loss 0.7384 (0.9360) loss_zs_kd 0.5896 (0.7130) loss_oracle 0.4731 (0.6627) acc 71.8750 (56.6406) kd_loss 1.0389 (1.1595) lr 6.3188e-04 eta 0:11:40
epoch [33/50] batch [300/319] time 0.142 (0.127) data 0.000 (0.002) loss 1.5174 (1.6712) ce_loss 0.8838 (1.1207) teacher_loss 0.7112 (0.9366) loss_zs_kd 0.6342 (0.7094) loss_oracle 0.7428 (0.6636) acc 68.7500 (56.5000) kd_loss 1.1413 (1.1605) lr 6.3188e-04 eta 0:11:33
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,769
* accuracy: 63.2%
* error: 36.8%
* macro_f1: 57.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,937
* accuracy: 50.7%
* error: 49.3%
* macro_f1: 23.0%
******* Domain 2 best val acc:      64.8%, epoch: 30 *******
******* Domain 2 best val test acc: 55.0%, epoch: 30 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
epoch [34/50] batch [20/319] time 0.072 (0.089) data 0.000 (0.023) loss 1.9845 (1.6884) ce_loss 1.4727 (1.1434) teacher_loss 1.1284 (0.9596) loss_zs_kd 0.7237 (0.6812) loss_oracle 0.7837 (0.6607) acc 53.1250 (55.4688) kd_loss 1.0886 (1.0685) lr 5.7422e-04 eta 0:07:59
epoch [34/50] batch [40/319] time 0.087 (0.086) data 0.000 (0.011) loss 1.5183 (1.7046) ce_loss 1.1025 (1.1346) teacher_loss 0.8427 (0.9396) loss_zs_kd 0.5757 (0.7059) loss_oracle 0.6180 (0.6943) acc 56.2500 (55.5469) kd_loss 1.0107 (1.0787) lr 5.7422e-04 eta 0:07:40
epoch [34/50] batch [60/319] time 0.084 (0.085) data 0.001 (0.008) loss 1.6960 (1.6752) ce_loss 1.2607 (1.1040) teacher_loss 0.9665 (0.9227) loss_zs_kd 0.6970 (0.7108) loss_oracle 0.6598 (0.6814) acc 40.6250 (56.7708) kd_loss 1.0788 (1.0667) lr 5.7422e-04 eta 0:07:33
epoch [34/50] batch [80/319] time 0.085 (0.088) data 0.000 (0.006) loss 1.8440 (1.6732) ce_loss 1.2070 (1.1022) teacher_loss 1.0180 (0.9176) loss_zs_kd 0.7415 (0.6997) loss_oracle 0.7519 (0.6856) acc 53.1250 (56.5234) kd_loss 1.0003 (1.0678) lr 5.7422e-04 eta 0:07:52
epoch [34/50] batch [100/319] time 0.080 (0.088) data 0.000 (0.005) loss 1.7903 (1.6740) ce_loss 1.1533 (1.1033) teacher_loss 0.9044 (0.9188) loss_zs_kd 0.7019 (0.7090) loss_oracle 0.8157 (0.6844) acc 46.8750 (56.7812) kd_loss 1.2528 (1.0659) lr 5.7422e-04 eta 0:07:48
epoch [34/50] batch [120/319] time 0.082 (0.087) data 0.000 (0.004) loss 1.7362 (1.6623) ce_loss 1.2275 (1.0924) teacher_loss 0.9412 (0.9047) loss_zs_kd 0.6985 (0.7102) loss_oracle 0.7251 (0.6865) acc 50.0000 (56.8490) kd_loss 1.1170 (1.0697) lr 5.7422e-04 eta 0:07:42
epoch [34/50] batch [140/319] time 0.064 (0.085) data 0.000 (0.003) loss 1.8963 (1.6655) ce_loss 1.3096 (1.0956) teacher_loss 0.9900 (0.9048) loss_zs_kd 0.6849 (0.7089) loss_oracle 0.8379 (0.6898) acc 46.8750 (56.8750) kd_loss 1.1415 (1.0757) lr 5.7422e-04 eta 0:07:31
epoch [34/50] batch [160/319] time 0.080 (0.083) data 0.000 (0.003) loss 1.6510 (1.6684) ce_loss 1.0879 (1.1015) teacher_loss 1.0174 (0.9062) loss_zs_kd 0.7876 (0.7112) loss_oracle 0.5549 (0.6911) acc 59.3750 (56.8555) kd_loss 1.1166 (1.0810) lr 5.7422e-04 eta 0:07:17
epoch [34/50] batch [180/319] time 0.066 (0.081) data 0.000 (0.003) loss 1.6193 (1.6713) ce_loss 1.1553 (1.1071) teacher_loss 0.9318 (0.9120) loss_zs_kd 0.8628 (0.7150) loss_oracle 0.6012 (0.6878) acc 59.3750 (56.5451) kd_loss 1.0404 (1.0874) lr 5.7422e-04 eta 0:07:05
epoch [34/50] batch [200/319] time 0.068 (0.079) data 0.000 (0.003) loss 1.6188 (1.6792) ce_loss 1.0508 (1.1164) teacher_loss 0.8134 (0.9218) loss_zs_kd 0.5360 (0.7114) loss_oracle 0.7518 (0.6862) acc 56.2500 (56.2656) kd_loss 1.0053 (1.0930) lr 5.7422e-04 eta 0:06:55
epoch [34/50] batch [220/319] time 0.074 (0.078) data 0.000 (0.002) loss 1.5517 (1.6802) ce_loss 0.8174 (1.1166) teacher_loss 0.7245 (0.9209) loss_zs_kd 0.8155 (0.7133) loss_oracle 0.7457 (0.6880) acc 68.7500 (56.3778) kd_loss 1.0656 (1.0922) lr 5.7422e-04 eta 0:06:47
epoch [34/50] batch [240/319] time 0.084 (0.079) data 0.000 (0.002) loss 1.7306 (1.6780) ce_loss 1.2139 (1.1152) teacher_loss 1.1508 (0.9187) loss_zs_kd 0.7848 (0.7138) loss_oracle 0.5013 (0.6880) acc 56.2500 (56.6146) kd_loss 1.1206 (1.0920) lr 5.7422e-04 eta 0:06:46
epoch [34/50] batch [260/319] time 0.092 (0.079) data 0.000 (0.002) loss 1.4949 (1.6723) ce_loss 0.9536 (1.1097) teacher_loss 0.7498 (0.9165) loss_zs_kd 0.6969 (0.7111) loss_oracle 0.6754 (0.6847) acc 65.6250 (56.8750) kd_loss 1.1761 (1.0948) lr 5.7422e-04 eta 0:06:46
epoch [34/50] batch [280/319] time 0.088 (0.079) data 0.000 (0.002) loss 1.3711 (1.6716) ce_loss 0.7915 (1.1061) teacher_loss 0.7213 (0.9175) loss_zs_kd 0.8092 (0.7127) loss_oracle 0.5689 (0.6828) acc 71.8750 (57.0201) kd_loss 1.1794 (1.1003) lr 5.7422e-04 eta 0:06:45
epoch [34/50] batch [300/319] time 0.105 (0.080) data 0.000 (0.002) loss 1.7843 (1.6720) ce_loss 1.1523 (1.1073) teacher_loss 0.9960 (0.9188) loss_zs_kd 0.8005 (0.7127) loss_oracle 0.7082 (0.6820) acc 53.1250 (56.9479) kd_loss 1.2115 (1.1072) lr 5.7422e-04 eta 0:06:48
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,815
* accuracy: 64.3%
* error: 35.7%
* macro_f1: 57.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,403
* accuracy: 55.5%
* error: 44.5%
* macro_f1: 24.4%
******* Domain 2 best val acc:      64.8%, epoch: 30 *******
******* Domain 2 best val test acc: 55.0%, epoch: 30 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
epoch [35/50] batch [20/319] time 0.088 (0.137) data 0.000 (0.036) loss 1.7623 (1.6858) ce_loss 1.3184 (1.0984) teacher_loss 0.9705 (0.9442) loss_zs_kd 0.6895 (0.7181) loss_oracle 0.7229 (0.6698) acc 43.7500 (58.4375) kd_loss 1.2912 (1.2173) lr 5.1825e-04 eta 0:11:34
epoch [35/50] batch [40/319] time 0.083 (0.113) data 0.001 (0.018) loss 1.5796 (1.6567) ce_loss 1.0488 (1.0925) teacher_loss 0.8937 (0.9189) loss_zs_kd 0.8507 (0.7222) loss_oracle 0.6009 (0.6656) acc 56.2500 (58.2031) kd_loss 1.1464 (1.1844) lr 5.1825e-04 eta 0:09:31
epoch [35/50] batch [60/319] time 0.081 (0.113) data 0.000 (0.012) loss 1.5688 (1.6692) ce_loss 1.0439 (1.1042) teacher_loss 0.9268 (0.9468) loss_zs_kd 0.6968 (0.7042) loss_oracle 0.5724 (0.6519) acc 59.3750 (58.0729) kd_loss 1.2190 (1.1711) lr 5.1825e-04 eta 0:09:29
epoch [35/50] batch [80/319] time 0.090 (0.111) data 0.000 (0.009) loss 1.6407 (1.6612) ce_loss 1.1318 (1.0965) teacher_loss 0.9920 (0.9325) loss_zs_kd 0.7074 (0.7091) loss_oracle 0.5779 (0.6578) acc 56.2500 (58.0469) kd_loss 1.0845 (1.1675) lr 5.1825e-04 eta 0:09:19
epoch [35/50] batch [100/319] time 0.070 (0.110) data 0.000 (0.007) loss 1.8592 (1.6628) ce_loss 1.1230 (1.0900) teacher_loss 1.0700 (0.9249) loss_zs_kd 0.8749 (0.7117) loss_oracle 0.7017 (0.6667) acc 62.5000 (58.1875) kd_loss 1.2148 (1.1681) lr 5.1825e-04 eta 0:09:09
epoch [35/50] batch [120/319] time 0.082 (0.105) data 0.000 (0.006) loss 1.7849 (1.6598) ce_loss 1.0459 (1.0907) teacher_loss 0.9449 (0.9206) loss_zs_kd 0.7912 (0.7149) loss_oracle 0.7609 (0.6677) acc 65.6250 (57.9167) kd_loss 1.1650 (1.1648) lr 5.1825e-04 eta 0:08:41
epoch [35/50] batch [140/319] time 0.089 (0.107) data 0.000 (0.005) loss 1.8578 (1.6529) ce_loss 1.1865 (1.0805) teacher_loss 0.9940 (0.9119) loss_zs_kd 0.7176 (0.7201) loss_oracle 0.7920 (0.6690) acc 50.0000 (58.4598) kd_loss 1.2726 (1.1648) lr 5.1825e-04 eta 0:08:48
epoch [35/50] batch [160/319] time 0.088 (0.108) data 0.000 (0.005) loss 1.6601 (1.6579) ce_loss 1.1914 (1.0828) teacher_loss 1.1018 (0.9142) loss_zs_kd 0.7457 (0.7255) loss_oracle 0.4838 (0.6712) acc 53.1250 (58.0859) kd_loss 1.1014 (1.1680) lr 5.1825e-04 eta 0:08:53
epoch [35/50] batch [180/319] time 0.089 (0.109) data 0.000 (0.004) loss 1.7707 (1.6649) ce_loss 1.2998 (1.0951) teacher_loss 1.0328 (0.9185) loss_zs_kd 0.6110 (0.7268) loss_oracle 0.6767 (0.6737) acc 50.0000 (57.6215) kd_loss 1.1597 (1.1721) lr 5.1825e-04 eta 0:08:55
epoch [35/50] batch [200/319] time 0.097 (0.110) data 0.000 (0.004) loss 1.7434 (1.6742) ce_loss 1.1348 (1.1048) teacher_loss 1.0169 (0.9242) loss_zs_kd 0.6326 (0.7301) loss_oracle 0.6632 (0.6770) acc 62.5000 (57.2500) kd_loss 1.2283 (1.1764) lr 5.1825e-04 eta 0:09:00
epoch [35/50] batch [220/319] time 0.080 (0.111) data 0.000 (0.004) loss 1.7306 (1.6722) ce_loss 1.3223 (1.1011) teacher_loss 1.0053 (0.9191) loss_zs_kd 0.6748 (0.7332) loss_oracle 0.6578 (0.6797) acc 43.7500 (57.3153) kd_loss 1.0961 (1.1815) lr 5.1825e-04 eta 0:09:00
epoch [35/50] batch [240/319] time 0.072 (0.111) data 0.000 (0.003) loss 1.8860 (1.6794) ce_loss 1.0986 (1.1049) teacher_loss 1.0574 (0.9202) loss_zs_kd 0.7569 (0.7326) loss_oracle 0.7528 (0.6859) acc 59.3750 (57.2786) kd_loss 1.3060 (1.1877) lr 5.1825e-04 eta 0:08:59
epoch [35/50] batch [260/319] time 0.094 (0.109) data 0.000 (0.003) loss 1.5757 (1.6811) ce_loss 0.7925 (1.1044) teacher_loss 0.7503 (0.9165) loss_zs_kd 0.6840 (0.7307) loss_oracle 0.7570 (0.6915) acc 75.0000 (57.2596) kd_loss 1.3150 (1.1905) lr 5.1825e-04 eta 0:08:49
epoch [35/50] batch [280/319] time 0.102 (0.109) data 0.000 (0.003) loss 2.1520 (1.6896) ce_loss 1.2314 (1.1076) teacher_loss 1.0271 (0.9213) loss_zs_kd 0.7318 (0.7317) loss_oracle 1.0518 (0.6951) acc 50.0000 (57.1763) kd_loss 1.2962 (1.1923) lr 5.1825e-04 eta 0:08:44
epoch [35/50] batch [300/319] time 0.099 (0.108) data 0.000 (0.003) loss 1.5283 (1.6904) ce_loss 1.0059 (1.1072) teacher_loss 0.7702 (0.9195) loss_zs_kd 0.6303 (0.7299) loss_oracle 0.6951 (0.6979) acc 56.2500 (57.3438) kd_loss 1.2713 (1.1920) lr 5.1825e-04 eta 0:08:40
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,825
* accuracy: 64.5%
* error: 35.5%
* macro_f1: 57.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,333
* accuracy: 54.8%
* error: 45.2%
* macro_f1: 24.6%
******* Domain 2 best val acc:      64.8%, epoch: 30 *******
******* Domain 2 best val test acc: 55.0%, epoch: 30 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
epoch [36/50] batch [20/319] time 0.106 (0.136) data 0.000 (0.033) loss 1.6533 (1.8081) ce_loss 1.0137 (1.1523) teacher_loss 1.0101 (1.0023) loss_zs_kd 0.5051 (0.7075) loss_oracle 0.5927 (0.7351) acc 62.5000 (55.1562) kd_loss 1.1296 (1.2100) lr 4.6417e-04 eta 0:10:50
epoch [36/50] batch [40/319] time 0.088 (0.115) data 0.000 (0.017) loss 1.7829 (1.8203) ce_loss 1.1777 (1.1805) teacher_loss 0.9919 (0.9933) loss_zs_kd 0.6678 (0.7121) loss_oracle 0.7243 (0.7558) acc 53.1250 (53.5938) kd_loss 1.2876 (1.2237) lr 4.6417e-04 eta 0:09:05
epoch [36/50] batch [60/319] time 0.110 (0.110) data 0.000 (0.011) loss 1.6029 (1.8011) ce_loss 1.0146 (1.1527) teacher_loss 0.8970 (0.9763) loss_zs_kd 0.8696 (0.7144) loss_oracle 0.6190 (0.7534) acc 59.3750 (55.3646) kd_loss 1.1786 (1.2201) lr 4.6417e-04 eta 0:08:40
epoch [36/50] batch [80/319] time 0.079 (0.110) data 0.000 (0.008) loss 1.7596 (1.8011) ce_loss 1.0996 (1.1549) teacher_loss 0.9292 (0.9873) loss_zs_kd 0.8114 (0.7021) loss_oracle 0.7492 (0.7436) acc 62.5000 (55.2344) kd_loss 1.3467 (1.2247) lr 4.6417e-04 eta 0:08:38
epoch [36/50] batch [100/319] time 0.080 (0.111) data 0.000 (0.007) loss 1.7978 (1.7916) ce_loss 1.1006 (1.1441) teacher_loss 0.8678 (0.9749) loss_zs_kd 0.9335 (0.7061) loss_oracle 0.8367 (0.7461) acc 59.3750 (55.6562) kd_loss 1.2708 (1.2223) lr 4.6417e-04 eta 0:08:38
epoch [36/50] batch [120/319] time 0.090 (0.107) data 0.000 (0.006) loss 1.6195 (1.7847) ce_loss 1.0566 (1.1369) teacher_loss 0.7772 (0.9700) loss_zs_kd 0.6963 (0.7062) loss_oracle 0.7727 (0.7442) acc 56.2500 (55.9896) kd_loss 1.1730 (1.2188) lr 4.6417e-04 eta 0:08:19
epoch [36/50] batch [140/319] time 0.132 (0.107) data 0.000 (0.005) loss 1.6841 (1.7712) ce_loss 1.0908 (1.1269) teacher_loss 0.8871 (0.9647) loss_zs_kd 0.5588 (0.7064) loss_oracle 0.7411 (0.7359) acc 65.6250 (56.5402) kd_loss 1.0573 (1.2128) lr 4.6417e-04 eta 0:08:18
epoch [36/50] batch [160/319] time 0.130 (0.108) data 0.000 (0.004) loss 1.7259 (1.7653) ce_loss 1.0986 (1.1231) teacher_loss 0.9163 (0.9586) loss_zs_kd 0.5485 (0.7067) loss_oracle 0.7548 (0.7361) acc 68.7500 (56.7383) kd_loss 1.2378 (1.2086) lr 4.6417e-04 eta 0:08:18
epoch [36/50] batch [180/319] time 0.077 (0.108) data 0.000 (0.004) loss 1.8749 (1.7606) ce_loss 1.3389 (1.1192) teacher_loss 1.0352 (0.9508) loss_zs_kd 0.7078 (0.7037) loss_oracle 0.7689 (0.7395) acc 40.6250 (56.6840) kd_loss 1.2270 (1.2041) lr 4.6417e-04 eta 0:08:18
epoch [36/50] batch [200/319] time 0.076 (0.108) data 0.000 (0.004) loss 1.5970 (1.7597) ce_loss 0.8999 (1.1190) teacher_loss 0.8126 (0.9504) loss_zs_kd 0.6631 (0.7047) loss_oracle 0.7181 (0.7389) acc 68.7500 (56.6719) kd_loss 1.2063 (1.2016) lr 4.6417e-04 eta 0:08:16
epoch [36/50] batch [220/319] time 0.083 (0.107) data 0.001 (0.003) loss 1.7481 (1.7601) ce_loss 0.9868 (1.1205) teacher_loss 0.9749 (0.9501) loss_zs_kd 0.8148 (0.7116) loss_oracle 0.6917 (0.7389) acc 65.6250 (56.4915) kd_loss 1.0881 (1.1987) lr 4.6417e-04 eta 0:08:10
epoch [36/50] batch [240/319] time 0.168 (0.109) data 0.000 (0.003) loss 1.7123 (1.7571) ce_loss 1.0459 (1.1199) teacher_loss 0.8716 (0.9462) loss_zs_kd 0.9761 (0.7196) loss_oracle 0.7430 (0.7389) acc 59.3750 (56.6146) kd_loss 1.3114 (1.1972) lr 4.6417e-04 eta 0:08:13
epoch [36/50] batch [260/319] time 0.084 (0.107) data 0.000 (0.003) loss 1.8106 (1.7556) ce_loss 1.2236 (1.1197) teacher_loss 0.9602 (0.9446) loss_zs_kd 0.6234 (0.7257) loss_oracle 0.7880 (0.7385) acc 50.0000 (56.5505) kd_loss 1.2333 (1.1942) lr 4.6417e-04 eta 0:08:04
epoch [36/50] batch [280/319] time 0.117 (0.107) data 0.000 (0.003) loss 1.6150 (1.7535) ce_loss 1.3271 (1.1183) teacher_loss 0.8497 (0.9430) loss_zs_kd 0.6651 (0.7273) loss_oracle 0.6987 (0.7377) acc 50.0000 (56.5960) kd_loss 1.2324 (1.1915) lr 4.6417e-04 eta 0:08:00
epoch [36/50] batch [300/319] time 0.110 (0.106) data 0.000 (0.002) loss 1.7782 (1.7528) ce_loss 1.2656 (1.1166) teacher_loss 1.1323 (0.9446) loss_zs_kd 0.8127 (0.7295) loss_oracle 0.5646 (0.7352) acc 50.0000 (56.6875) kd_loss 1.1716 (1.1897) lr 4.6417e-04 eta 0:07:56
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,861
* accuracy: 65.3%
* error: 34.7%
* macro_f1: 58.1%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema_and_0.1zeroshot_and_tau0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,359
* accuracy: 55.0%
* error: 45.0%
* macro_f1: 24.0%
******* Domain 2 best val acc:      65.3%, epoch: 36 *******
******* Domain 2 best val test acc: 55.0%, epoch: 36 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
epoch [37/50] batch [20/319] time 0.102 (0.139) data 0.000 (0.028) loss 1.8914 (1.6961) ce_loss 1.0771 (1.0692) teacher_loss 0.9830 (0.8977) loss_zs_kd 0.9314 (0.7395) loss_oracle 0.8153 (0.7245) acc 50.0000 (58.5938) kd_loss 1.2363 (1.1767) lr 4.1221e-04 eta 0:10:16
epoch [37/50] batch [40/319] time 0.075 (0.117) data 0.000 (0.014) loss 1.9643 (1.7117) ce_loss 1.2100 (1.0601) teacher_loss 1.0651 (0.9029) loss_zs_kd 0.6175 (0.7297) loss_oracle 0.8375 (0.7358) acc 59.3750 (60.2344) kd_loss 1.2554 (1.1877) lr 4.1221e-04 eta 0:08:39
epoch [37/50] batch [60/319] time 0.082 (0.108) data 0.000 (0.010) loss 1.6410 (1.7422) ce_loss 1.0752 (1.0825) teacher_loss 0.8280 (0.9186) loss_zs_kd 0.8613 (0.7296) loss_oracle 0.7268 (0.7506) acc 50.0000 (58.7500) kd_loss 1.2579 (1.2005) lr 4.1221e-04 eta 0:07:55
epoch [37/50] batch [80/319] time 0.072 (0.108) data 0.000 (0.007) loss 1.8388 (1.7708) ce_loss 1.3252 (1.1036) teacher_loss 1.0968 (0.9393) loss_zs_kd 0.7211 (0.7323) loss_oracle 0.6699 (0.7583) acc 37.5000 (58.0469) kd_loss 1.1550 (1.1976) lr 4.1221e-04 eta 0:07:55
epoch [37/50] batch [100/319] time 0.073 (0.109) data 0.000 (0.006) loss 1.7808 (1.7681) ce_loss 1.1338 (1.1006) teacher_loss 0.9631 (0.9371) loss_zs_kd 0.7065 (0.7299) loss_oracle 0.7470 (0.7579) acc 62.5000 (58.0000) kd_loss 1.0274 (1.1903) lr 4.1221e-04 eta 0:07:54
epoch [37/50] batch [120/319] time 0.070 (0.107) data 0.000 (0.005) loss 1.8922 (1.7693) ce_loss 1.2002 (1.1004) teacher_loss 0.9833 (0.9412) loss_zs_kd 0.8394 (0.7322) loss_oracle 0.8250 (0.7549) acc 56.2500 (58.3594) kd_loss 1.1386 (1.1857) lr 4.1221e-04 eta 0:07:44
epoch [37/50] batch [140/319] time 0.172 (0.104) data 0.000 (0.004) loss 1.5723 (1.7622) ce_loss 0.9492 (1.0978) teacher_loss 0.7346 (0.9333) loss_zs_kd 0.6817 (0.7373) loss_oracle 0.7695 (0.7552) acc 65.6250 (58.3929) kd_loss 1.2228 (1.1856) lr 4.1221e-04 eta 0:07:31
epoch [37/50] batch [160/319] time 0.144 (0.104) data 0.000 (0.004) loss 1.7748 (1.7667) ce_loss 1.2139 (1.1061) teacher_loss 1.0868 (0.9368) loss_zs_kd 0.6737 (0.7320) loss_oracle 0.6207 (0.7567) acc 59.3750 (58.0078) kd_loss 1.0713 (1.1844) lr 4.1221e-04 eta 0:07:29
epoch [37/50] batch [180/319] time 0.087 (0.105) data 0.000 (0.003) loss 1.6292 (1.7637) ce_loss 1.1211 (1.1093) teacher_loss 0.8290 (0.9327) loss_zs_kd 0.8947 (0.7303) loss_oracle 0.7107 (0.7580) acc 62.5000 (57.9167) kd_loss 1.1139 (1.1872) lr 4.1221e-04 eta 0:07:29
epoch [37/50] batch [200/319] time 0.156 (0.105) data 0.000 (0.003) loss 1.7888 (1.7609) ce_loss 1.1855 (1.1085) teacher_loss 0.9661 (0.9312) loss_zs_kd 0.7029 (0.7286) loss_oracle 0.7525 (0.7568) acc 53.1250 (57.9688) kd_loss 1.1506 (1.1895) lr 4.1221e-04 eta 0:07:28
epoch [37/50] batch [220/319] time 0.175 (0.106) data 0.000 (0.003) loss 1.8721 (1.7548) ce_loss 1.2910 (1.1063) teacher_loss 1.1066 (0.9246) loss_zs_kd 0.6778 (0.7265) loss_oracle 0.6977 (0.7575) acc 50.0000 (57.8835) kd_loss 1.2194 (1.1903) lr 4.1221e-04 eta 0:07:29
epoch [37/50] batch [240/319] time 0.085 (0.106) data 0.000 (0.003) loss 1.9003 (1.7497) ce_loss 1.0537 (1.1030) teacher_loss 0.9215 (0.9190) loss_zs_kd 0.8452 (0.7268) loss_oracle 0.8943 (0.7580) acc 50.0000 (57.8125) kd_loss 1.2413 (1.1937) lr 4.1221e-04 eta 0:07:27
epoch [37/50] batch [260/319] time 0.081 (0.107) data 0.000 (0.002) loss 1.8707 (1.7550) ce_loss 1.3838 (1.1132) teacher_loss 1.0497 (0.9217) loss_zs_kd 0.7257 (0.7281) loss_oracle 0.7484 (0.7605) acc 53.1250 (57.2716) kd_loss 1.1401 (1.1932) lr 4.1221e-04 eta 0:07:29
epoch [37/50] batch [280/319] time 0.104 (0.106) data 0.000 (0.002) loss 1.5746 (1.7523) ce_loss 1.0996 (1.1153) teacher_loss 0.7276 (0.9200) loss_zs_kd 0.6549 (0.7269) loss_oracle 0.7815 (0.7596) acc 68.7500 (57.2321) kd_loss 1.2439 (1.1912) lr 4.1221e-04 eta 0:07:24
epoch [37/50] batch [300/319] time 0.099 (0.106) data 0.000 (0.002) loss 1.5403 (1.7438) ce_loss 1.2090 (1.1144) teacher_loss 0.7806 (0.9144) loss_zs_kd 0.7453 (0.7289) loss_oracle 0.6852 (0.7566) acc 50.0000 (57.1458) kd_loss 1.3284 (1.1898) lr 4.1221e-04 eta 0:07:21
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,759
* accuracy: 63.0%
* error: 37.0%
* macro_f1: 56.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,672
* accuracy: 48.0%
* error: 52.0%
* macro_f1: 22.4%
******* Domain 2 best val acc:      65.3%, epoch: 36 *******
******* Domain 2 best val test acc: 55.0%, epoch: 36 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
epoch [38/50] batch [20/319] time 0.105 (0.133) data 0.000 (0.026) loss 1.5525 (1.7133) ce_loss 1.0098 (1.1548) teacher_loss 0.7299 (0.9427) loss_zs_kd 0.7927 (0.7111) loss_oracle 0.7433 (0.6995) acc 62.5000 (52.5000) kd_loss 1.2141 (1.1709) lr 3.6258e-04 eta 0:09:09
epoch [38/50] batch [40/319] time 0.107 (0.119) data 0.000 (0.013) loss 1.5603 (1.7048) ce_loss 1.1992 (1.1307) teacher_loss 0.9278 (0.9241) loss_zs_kd 0.5449 (0.6984) loss_oracle 0.5780 (0.7108) acc 59.3750 (55.7812) kd_loss 1.1208 (1.1643) lr 3.6258e-04 eta 0:08:06
epoch [38/50] batch [60/319] time 0.083 (0.107) data 0.000 (0.009) loss 2.0064 (1.7459) ce_loss 1.2559 (1.1508) teacher_loss 1.3625 (0.9583) loss_zs_kd 0.7753 (0.7008) loss_oracle 0.5664 (0.7175) acc 59.3750 (55.5208) kd_loss 1.0311 (1.1637) lr 3.6258e-04 eta 0:07:19
epoch [38/50] batch [80/319] time 0.068 (0.103) data 0.000 (0.007) loss 2.2053 (1.7362) ce_loss 1.3428 (1.1369) teacher_loss 1.2544 (0.9424) loss_zs_kd 0.9444 (0.7093) loss_oracle 0.8564 (0.7228) acc 46.8750 (55.9766) kd_loss 1.1405 (1.1718) lr 3.6258e-04 eta 0:06:57
epoch [38/50] batch [100/319] time 0.070 (0.101) data 0.000 (0.005) loss 1.5970 (1.7397) ce_loss 1.0840 (1.1313) teacher_loss 0.7688 (0.9366) loss_zs_kd 0.8318 (0.7219) loss_oracle 0.7451 (0.7310) acc 65.6250 (56.5312) kd_loss 1.1227 (1.1746) lr 3.6258e-04 eta 0:06:49
epoch [38/50] batch [120/319] time 0.086 (0.100) data 0.000 (0.005) loss 1.5602 (1.7396) ce_loss 0.9082 (1.1305) teacher_loss 0.6912 (0.9335) loss_zs_kd 0.7311 (0.7174) loss_oracle 0.7958 (0.7343) acc 71.8750 (56.7969) kd_loss 1.1422 (1.1752) lr 3.6258e-04 eta 0:06:40
epoch [38/50] batch [140/319] time 0.075 (0.102) data 0.000 (0.004) loss 1.7957 (1.7483) ce_loss 1.2676 (1.1374) teacher_loss 1.1487 (0.9406) loss_zs_kd 0.7217 (0.7179) loss_oracle 0.5747 (0.7359) acc 50.0000 (56.4732) kd_loss 1.1587 (1.1812) lr 3.6258e-04 eta 0:06:47
epoch [38/50] batch [160/319] time 0.083 (0.099) data 0.000 (0.003) loss 1.4630 (1.7358) ce_loss 1.0889 (1.1334) teacher_loss 0.7646 (0.9306) loss_zs_kd 0.6098 (0.7180) loss_oracle 0.6374 (0.7335) acc 56.2500 (56.6797) kd_loss 1.3131 (1.1899) lr 3.6258e-04 eta 0:06:34
epoch [38/50] batch [180/319] time 0.075 (0.099) data 0.000 (0.003) loss 1.6649 (1.7375) ce_loss 1.0967 (1.1354) teacher_loss 0.9049 (0.9332) loss_zs_kd 0.7606 (0.7214) loss_oracle 0.6839 (0.7322) acc 56.2500 (56.5104) kd_loss 1.0686 (1.1940) lr 3.6258e-04 eta 0:06:33
epoch [38/50] batch [200/319] time 0.075 (0.099) data 0.000 (0.003) loss 1.7254 (1.7431) ce_loss 1.2051 (1.1417) teacher_loss 0.8966 (0.9349) loss_zs_kd 0.8097 (0.7291) loss_oracle 0.7478 (0.7353) acc 40.6250 (55.9531) kd_loss 1.3482 (1.1981) lr 3.6258e-04 eta 0:06:28
epoch [38/50] batch [220/319] time 0.075 (0.100) data 0.000 (0.003) loss 1.8270 (1.7378) ce_loss 1.1172 (1.1379) teacher_loss 1.0105 (0.9271) loss_zs_kd 0.6540 (0.7299) loss_oracle 0.7511 (0.7377) acc 65.6250 (55.8665) kd_loss 1.1410 (1.2013) lr 3.6258e-04 eta 0:06:31
epoch [38/50] batch [240/319] time 0.111 (0.101) data 0.000 (0.002) loss 1.6868 (1.7390) ce_loss 0.9873 (1.1315) teacher_loss 0.7912 (0.9258) loss_zs_kd 0.6059 (0.7339) loss_oracle 0.8350 (0.7398) acc 56.2500 (56.3151) kd_loss 1.1992 (1.2006) lr 3.6258e-04 eta 0:06:35
epoch [38/50] batch [260/319] time 0.091 (0.101) data 0.000 (0.002) loss 2.2358 (1.7436) ce_loss 1.5488 (1.1328) teacher_loss 1.3297 (0.9273) loss_zs_kd 0.9131 (0.7359) loss_oracle 0.8148 (0.7427) acc 43.7500 (56.1659) kd_loss 1.2370 (1.2012) lr 3.6258e-04 eta 0:06:32
epoch [38/50] batch [280/319] time 0.073 (0.102) data 0.000 (0.002) loss 1.6812 (1.7480) ce_loss 1.0322 (1.1349) teacher_loss 0.7934 (0.9263) loss_zs_kd 0.7593 (0.7372) loss_oracle 0.8119 (0.7480) acc 56.2500 (56.0379) kd_loss 1.3462 (1.2053) lr 3.6258e-04 eta 0:06:33
epoch [38/50] batch [300/319] time 0.069 (0.103) data 0.000 (0.002) loss 2.1176 (1.7539) ce_loss 1.4463 (1.1367) teacher_loss 1.1166 (0.9295) loss_zs_kd 0.8210 (0.7391) loss_oracle 0.9190 (0.7505) acc 43.7500 (55.8750) kd_loss 1.1711 (1.2052) lr 3.6258e-04 eta 0:06:34
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,779
* accuracy: 63.5%
* error: 36.5%
* macro_f1: 56.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,293
* accuracy: 54.4%
* error: 45.6%
* macro_f1: 24.9%
******* Domain 2 best val acc:      65.3%, epoch: 36 *******
******* Domain 2 best val test acc: 55.0%, epoch: 36 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
epoch [39/50] batch [20/319] time 0.099 (0.120) data 0.000 (0.027) loss 1.5822 (1.8302) ce_loss 1.0264 (1.1108) teacher_loss 0.7558 (0.9571) loss_zs_kd 0.7520 (0.7162) loss_oracle 0.7512 (0.8015) acc 62.5000 (59.3750) kd_loss 1.1840 (1.2358) lr 3.1545e-04 eta 0:07:36
epoch [39/50] batch [40/319] time 0.091 (0.107) data 0.000 (0.013) loss 1.9832 (1.8039) ce_loss 1.2461 (1.1137) teacher_loss 1.0876 (0.9370) loss_zs_kd 0.6540 (0.7311) loss_oracle 0.8302 (0.7938) acc 46.8750 (57.7344) kd_loss 1.1897 (1.2200) lr 3.1545e-04 eta 0:06:44
epoch [39/50] batch [60/319] time 0.090 (0.100) data 0.000 (0.009) loss 1.6861 (1.7992) ce_loss 0.9849 (1.1241) teacher_loss 0.8453 (0.9444) loss_zs_kd 0.5494 (0.7209) loss_oracle 0.7859 (0.7828) acc 59.3750 (57.5521) kd_loss 1.1352 (1.2187) lr 3.1545e-04 eta 0:06:18
epoch [39/50] batch [80/319] time 0.092 (0.098) data 0.000 (0.007) loss 1.6505 (1.7768) ce_loss 1.2871 (1.1311) teacher_loss 0.8344 (0.9304) loss_zs_kd 0.8945 (0.7205) loss_oracle 0.7267 (0.7743) acc 56.2500 (56.7969) kd_loss 1.1713 (1.2159) lr 3.1545e-04 eta 0:06:06
epoch [39/50] batch [100/319] time 0.064 (0.095) data 0.000 (0.006) loss 2.1315 (1.7837) ce_loss 1.5635 (1.1343) teacher_loss 1.2443 (0.9370) loss_zs_kd 0.7158 (0.7188) loss_oracle 0.8156 (0.7748) acc 37.5000 (56.4375) kd_loss 1.2608 (1.2166) lr 3.1545e-04 eta 0:05:52
epoch [39/50] batch [120/319] time 0.075 (0.090) data 0.000 (0.005) loss 1.6276 (1.7821) ce_loss 1.2354 (1.1332) teacher_loss 0.9142 (0.9336) loss_zs_kd 0.6016 (0.7165) loss_oracle 0.6533 (0.7768) acc 62.5000 (56.4062) kd_loss 1.1862 (1.2170) lr 3.1545e-04 eta 0:05:33
epoch [39/50] batch [140/319] time 0.058 (0.092) data 0.000 (0.004) loss 1.7363 (1.7761) ce_loss 1.0791 (1.1314) teacher_loss 0.8780 (0.9345) loss_zs_kd 0.8761 (0.7157) loss_oracle 0.7706 (0.7700) acc 62.5000 (56.6518) kd_loss 1.2288 (1.2151) lr 3.1545e-04 eta 0:05:37
epoch [39/50] batch [160/319] time 0.164 (0.093) data 0.000 (0.004) loss 1.6008 (1.7693) ce_loss 0.9990 (1.1237) teacher_loss 0.8089 (0.9300) loss_zs_kd 0.8880 (0.7139) loss_oracle 0.7030 (0.7679) acc 56.2500 (56.8359) kd_loss 1.1235 (1.2129) lr 3.1545e-04 eta 0:05:40
epoch [39/50] batch [180/319] time 0.074 (0.095) data 0.000 (0.003) loss 1.5693 (1.7654) ce_loss 1.1279 (1.1266) teacher_loss 0.6639 (0.9290) loss_zs_kd 0.7873 (0.7107) loss_oracle 0.8267 (0.7653) acc 62.5000 (56.5625) kd_loss 1.2566 (1.2081) lr 3.1545e-04 eta 0:05:45
epoch [39/50] batch [200/319] time 0.090 (0.094) data 0.000 (0.003) loss 1.7448 (1.7642) ce_loss 1.0498 (1.1261) teacher_loss 0.8109 (0.9256) loss_zs_kd 0.5604 (0.7082) loss_oracle 0.8779 (0.7678) acc 62.5000 (56.5938) kd_loss 1.1911 (1.2086) lr 3.1545e-04 eta 0:05:39
epoch [39/50] batch [220/319] time 0.157 (0.096) data 0.000 (0.003) loss 1.5004 (1.7605) ce_loss 1.0430 (1.1226) teacher_loss 0.8514 (0.9242) loss_zs_kd 0.7941 (0.7108) loss_oracle 0.5696 (0.7652) acc 62.5000 (56.8608) kd_loss 1.2070 (1.2075) lr 3.1545e-04 eta 0:05:44
epoch [39/50] batch [240/319] time 0.170 (0.098) data 0.000 (0.003) loss 1.8188 (1.7606) ce_loss 1.4756 (1.1266) teacher_loss 1.0544 (0.9282) loss_zs_kd 0.7926 (0.7134) loss_oracle 0.6851 (0.7611) acc 37.5000 (56.6536) kd_loss 1.1921 (1.2034) lr 3.1545e-04 eta 0:05:50
epoch [39/50] batch [260/319] time 0.075 (0.099) data 0.000 (0.002) loss 1.5866 (1.7597) ce_loss 0.9512 (1.1244) teacher_loss 0.8437 (0.9291) loss_zs_kd 0.6248 (0.7134) loss_oracle 0.6804 (0.7593) acc 62.5000 (56.5865) kd_loss 1.0553 (1.2020) lr 3.1545e-04 eta 0:05:52
epoch [39/50] batch [280/319] time 0.080 (0.100) data 0.000 (0.002) loss 1.8948 (1.7591) ce_loss 1.4678 (1.1276) teacher_loss 1.1464 (0.9322) loss_zs_kd 0.7198 (0.7113) loss_oracle 0.6765 (0.7557) acc 43.7500 (56.4955) kd_loss 1.0952 (1.2000) lr 3.1545e-04 eta 0:05:54
epoch [39/50] batch [300/319] time 0.076 (0.101) data 0.000 (0.002) loss 2.0042 (1.7596) ce_loss 1.2197 (1.1289) teacher_loss 0.9762 (0.9332) loss_zs_kd 0.9124 (0.7127) loss_oracle 0.9367 (0.7552) acc 46.8750 (56.4583) kd_loss 1.2846 (1.1991) lr 3.1545e-04 eta 0:05:56
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,769
* accuracy: 63.2%
* error: 36.8%
* macro_f1: 56.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,907
* accuracy: 50.4%
* error: 49.6%
* macro_f1: 23.7%
******* Domain 2 best val acc:      65.3%, epoch: 36 *******
******* Domain 2 best val test acc: 55.0%, epoch: 36 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
epoch [40/50] batch [20/319] time 0.097 (0.141) data 0.000 (0.030) loss 1.8605 (1.6188) ce_loss 1.1904 (1.0640) teacher_loss 1.0782 (0.8637) loss_zs_kd 0.6012 (0.6771) loss_oracle 0.7222 (0.6874) acc 50.0000 (59.8438) kd_loss 1.2749 (1.1625) lr 2.7103e-04 eta 0:08:10
epoch [40/50] batch [40/319] time 0.105 (0.122) data 0.000 (0.015) loss 1.7532 (1.6802) ce_loss 1.1025 (1.1255) teacher_loss 0.9318 (0.9112) loss_zs_kd 0.6320 (0.7062) loss_oracle 0.7582 (0.6984) acc 56.2500 (55.9375) kd_loss 1.2214 (1.1780) lr 2.7103e-04 eta 0:07:04
epoch [40/50] batch [60/319] time 0.102 (0.116) data 0.000 (0.010) loss 1.8118 (1.6922) ce_loss 1.2275 (1.1364) teacher_loss 0.9631 (0.9053) loss_zs_kd 0.7936 (0.7232) loss_oracle 0.7693 (0.7146) acc 46.8750 (55.3646) kd_loss 1.2145 (1.1847) lr 2.7103e-04 eta 0:06:40
epoch [40/50] batch [80/319] time 0.113 (0.113) data 0.000 (0.008) loss 1.8878 (1.6864) ce_loss 1.1016 (1.1175) teacher_loss 0.9053 (0.8893) loss_zs_kd 0.6577 (0.7289) loss_oracle 0.9167 (0.7242) acc 56.2500 (55.9766) kd_loss 1.2160 (1.1854) lr 2.7103e-04 eta 0:06:28
epoch [40/50] batch [100/319] time 0.099 (0.111) data 0.000 (0.006) loss 1.6765 (1.6909) ce_loss 0.9395 (1.1253) teacher_loss 0.8452 (0.8895) loss_zs_kd 0.5341 (0.7215) loss_oracle 0.7779 (0.7293) acc 56.2500 (55.6250) kd_loss 1.1146 (1.1859) lr 2.7103e-04 eta 0:06:19
epoch [40/50] batch [120/319] time 0.086 (0.107) data 0.000 (0.005) loss 1.4282 (1.6862) ce_loss 0.9658 (1.1152) teacher_loss 0.7194 (0.8898) loss_zs_kd 0.8405 (0.7234) loss_oracle 0.6248 (0.7241) acc 65.6250 (56.2240) kd_loss 1.1578 (1.1792) lr 2.7103e-04 eta 0:06:03
epoch [40/50] batch [140/319] time 0.157 (0.106) data 0.000 (0.005) loss 1.8897 (1.6978) ce_loss 1.1895 (1.1229) teacher_loss 1.1912 (0.9031) loss_zs_kd 0.6904 (0.7181) loss_oracle 0.6294 (0.7229) acc 50.0000 (55.8705) kd_loss 1.1709 (1.1721) lr 2.7103e-04 eta 0:05:58
epoch [40/50] batch [160/319] time 0.165 (0.107) data 0.000 (0.004) loss 1.4611 (1.6946) ce_loss 1.0713 (1.1187) teacher_loss 0.7639 (0.9005) loss_zs_kd 0.7337 (0.7229) loss_oracle 0.6238 (0.7219) acc 59.3750 (56.0156) kd_loss 1.1682 (1.1685) lr 2.7103e-04 eta 0:05:57
epoch [40/50] batch [180/319] time 0.069 (0.105) data 0.000 (0.004) loss 2.0410 (1.6987) ce_loss 1.4795 (1.1191) teacher_loss 1.2660 (0.9071) loss_zs_kd 0.6664 (0.7204) loss_oracle 0.7084 (0.7196) acc 40.6250 (55.7292) kd_loss 1.2161 (1.1661) lr 2.7103e-04 eta 0:05:50
epoch [40/50] batch [200/319] time 0.080 (0.105) data 0.000 (0.003) loss 1.6445 (1.7089) ce_loss 1.0215 (1.1303) teacher_loss 0.9466 (0.9184) loss_zs_kd 0.6476 (0.7165) loss_oracle 0.6331 (0.7188) acc 71.8750 (55.4844) kd_loss 0.9872 (1.1661) lr 2.7103e-04 eta 0:05:46
epoch [40/50] batch [220/319] time 0.142 (0.103) data 0.000 (0.003) loss 1.9924 (1.7165) ce_loss 1.3564 (1.1358) teacher_loss 1.0972 (0.9262) loss_zs_kd 0.8028 (0.7167) loss_oracle 0.8150 (0.7186) acc 43.7500 (55.3693) kd_loss 1.0807 (1.1669) lr 2.7103e-04 eta 0:05:39
epoch [40/50] batch [240/319] time 0.086 (0.104) data 0.000 (0.003) loss 2.0158 (1.7133) ce_loss 1.2832 (1.1336) teacher_loss 1.1002 (0.9237) loss_zs_kd 0.6185 (0.7156) loss_oracle 0.8538 (0.7180) acc 53.1250 (55.5599) kd_loss 1.2649 (1.1649) lr 2.7103e-04 eta 0:05:41
epoch [40/50] batch [260/319] time 0.175 (0.106) data 0.000 (0.003) loss 1.7986 (1.7137) ce_loss 1.1992 (1.1329) teacher_loss 0.9995 (0.9262) loss_zs_kd 0.8188 (0.7159) loss_oracle 0.7173 (0.7159) acc 46.8750 (55.6731) kd_loss 1.0392 (1.1643) lr 2.7103e-04 eta 0:05:43
epoch [40/50] batch [280/319] time 0.082 (0.107) data 0.000 (0.002) loss 1.9805 (1.7181) ce_loss 1.1768 (1.1343) teacher_loss 1.0815 (0.9305) loss_zs_kd 0.5434 (0.7135) loss_oracle 0.8446 (0.7163) acc 53.1250 (55.6808) kd_loss 1.1316 (1.1632) lr 2.7103e-04 eta 0:05:44
epoch [40/50] batch [300/319] time 0.086 (0.107) data 0.000 (0.002) loss 1.9603 (1.7209) ce_loss 1.2744 (1.1370) teacher_loss 1.0552 (0.9329) loss_zs_kd 0.5989 (0.7113) loss_oracle 0.8452 (0.7169) acc 50.0000 (55.7188) kd_loss 1.1642 (1.1637) lr 2.7103e-04 eta 0:05:44
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,764
* accuracy: 63.1%
* error: 36.9%
* macro_f1: 56.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,981
* accuracy: 51.2%
* error: 48.8%
* macro_f1: 24.6%
******* Domain 2 best val acc:      65.3%, epoch: 36 *******
******* Domain 2 best val test acc: 55.0%, epoch: 36 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
epoch [41/50] batch [20/319] time 0.099 (0.132) data 0.000 (0.027) loss 1.8210 (1.7603) ce_loss 1.2041 (1.1434) teacher_loss 0.8550 (0.9300) loss_zs_kd 0.8506 (0.7268) loss_oracle 0.8809 (0.7576) acc 43.7500 (55.6250) kd_loss 1.2173 (1.1951) lr 2.2949e-04 eta 0:06:58
epoch [41/50] batch [40/319] time 0.103 (0.118) data 0.000 (0.014) loss 1.8541 (1.7676) ce_loss 1.1992 (1.1571) teacher_loss 0.9458 (0.9302) loss_zs_kd 0.9798 (0.7342) loss_oracle 0.8103 (0.7640) acc 50.0000 (54.5312) kd_loss 1.1658 (1.1958) lr 2.2949e-04 eta 0:06:11
epoch [41/50] batch [60/319] time 0.095 (0.113) data 0.000 (0.009) loss 1.8026 (1.7677) ce_loss 1.2812 (1.1618) teacher_loss 0.8895 (0.9397) loss_zs_kd 0.6757 (0.7249) loss_oracle 0.8455 (0.7555) acc 53.1250 (54.1667) kd_loss 1.1351 (1.1834) lr 2.2949e-04 eta 0:05:55
epoch [41/50] batch [80/319] time 0.104 (0.111) data 0.001 (0.007) loss 1.8118 (1.7556) ce_loss 1.4014 (1.1603) teacher_loss 0.9108 (0.9358) loss_zs_kd 0.7976 (0.7356) loss_oracle 0.8213 (0.7463) acc 37.5000 (54.4531) kd_loss 1.2459 (1.1720) lr 2.2949e-04 eta 0:05:43
epoch [41/50] batch [100/319] time 0.102 (0.110) data 0.000 (0.006) loss 1.6602 (1.7414) ce_loss 0.9448 (1.1602) teacher_loss 0.9127 (0.9308) loss_zs_kd 0.7487 (0.7399) loss_oracle 0.6726 (0.7366) acc 71.8750 (55.0938) kd_loss 1.1273 (1.1684) lr 2.2949e-04 eta 0:05:39
epoch [41/50] batch [120/319] time 0.080 (0.107) data 0.000 (0.005) loss 1.5106 (1.7487) ce_loss 1.0645 (1.1594) teacher_loss 0.7342 (0.9388) loss_zs_kd 0.6003 (0.7378) loss_oracle 0.7164 (0.7361) acc 56.2500 (54.8698) kd_loss 1.0909 (1.1660) lr 2.2949e-04 eta 0:05:28
epoch [41/50] batch [140/319] time 0.166 (0.105) data 0.000 (0.004) loss 1.5051 (1.7390) ce_loss 0.9971 (1.1516) teacher_loss 0.7048 (0.9333) loss_zs_kd 0.6385 (0.7330) loss_oracle 0.7365 (0.7323) acc 62.5000 (55.6696) kd_loss 1.1136 (1.1632) lr 2.2949e-04 eta 0:05:21
epoch [41/50] batch [160/319] time 0.159 (0.107) data 0.000 (0.004) loss 1.7171 (1.7439) ce_loss 1.2178 (1.1504) teacher_loss 0.9006 (0.9351) loss_zs_kd 0.6867 (0.7271) loss_oracle 0.7478 (0.7360) acc 56.2500 (55.7031) kd_loss 1.2310 (1.1633) lr 2.2949e-04 eta 0:05:24
epoch [41/50] batch [180/319] time 0.090 (0.109) data 0.000 (0.003) loss 1.6814 (1.7403) ce_loss 1.0791 (1.1473) teacher_loss 0.8645 (0.9339) loss_zs_kd 0.7324 (0.7259) loss_oracle 0.7436 (0.7338) acc 56.2500 (55.9549) kd_loss 1.1053 (1.1638) lr 2.2949e-04 eta 0:05:26
epoch [41/50] batch [200/319] time 0.081 (0.106) data 0.000 (0.003) loss 1.6443 (1.7342) ce_loss 1.0791 (1.1405) teacher_loss 0.8748 (0.9279) loss_zs_kd 0.7091 (0.7220) loss_oracle 0.6985 (0.7341) acc 46.8750 (56.1406) kd_loss 1.2926 (1.1638) lr 2.2949e-04 eta 0:05:17
epoch [41/50] batch [220/319] time 0.098 (0.106) data 0.000 (0.003) loss 1.9763 (1.7327) ce_loss 1.4199 (1.1371) teacher_loss 1.0291 (0.9256) loss_zs_kd 0.8032 (0.7208) loss_oracle 0.8669 (0.7350) acc 43.7500 (56.3636) kd_loss 1.1658 (1.1640) lr 2.2949e-04 eta 0:05:14
epoch [41/50] batch [240/319] time 0.085 (0.107) data 0.001 (0.002) loss 1.8968 (1.7301) ce_loss 1.1309 (1.1362) teacher_loss 1.0741 (0.9245) loss_zs_kd 0.6852 (0.7203) loss_oracle 0.7542 (0.7335) acc 56.2500 (56.4453) kd_loss 1.1865 (1.1658) lr 2.2949e-04 eta 0:05:14
epoch [41/50] batch [260/319] time 0.158 (0.108) data 0.000 (0.002) loss 1.7179 (1.7338) ce_loss 1.1064 (1.1366) teacher_loss 0.9744 (0.9274) loss_zs_kd 0.6815 (0.7195) loss_oracle 0.6753 (0.7345) acc 56.2500 (56.3221) kd_loss 1.1472 (1.1653) lr 2.2949e-04 eta 0:05:16
epoch [41/50] batch [280/319] time 0.172 (0.109) data 0.000 (0.002) loss 1.6138 (1.7375) ce_loss 0.9883 (1.1377) teacher_loss 0.7776 (0.9298) loss_zs_kd 0.5877 (0.7194) loss_oracle 0.7775 (0.7358) acc 65.6250 (56.0714) kd_loss 1.0522 (1.1670) lr 2.2949e-04 eta 0:05:16
epoch [41/50] batch [300/319] time 0.147 (0.109) data 0.000 (0.002) loss 1.6555 (1.7341) ce_loss 1.1084 (1.1375) teacher_loss 0.8946 (0.9267) loss_zs_kd 0.6082 (0.7163) loss_oracle 0.7001 (0.7357) acc 53.1250 (56.0104) kd_loss 1.1957 (1.1673) lr 2.2949e-04 eta 0:05:14
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,760
* accuracy: 63.0%
* error: 37.0%
* macro_f1: 56.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,780
* accuracy: 49.1%
* error: 50.9%
* macro_f1: 24.0%
******* Domain 2 best val acc:      65.3%, epoch: 36 *******
******* Domain 2 best val test acc: 55.0%, epoch: 36 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
epoch [42/50] batch [20/319] time 0.111 (0.116) data 0.000 (0.025) loss 1.8488 (1.7415) ce_loss 1.3242 (1.1467) teacher_loss 0.9626 (0.9537) loss_zs_kd 0.8129 (0.6471) loss_oracle 0.8049 (0.7230) acc 50.0000 (54.8438) kd_loss 1.1489 (1.1976) lr 1.9098e-04 eta 0:05:31
epoch [42/50] batch [40/319] time 0.096 (0.104) data 0.000 (0.013) loss 1.5263 (1.7415) ce_loss 0.8652 (1.1523) teacher_loss 0.5972 (0.9287) loss_zs_kd 0.6072 (0.6633) loss_oracle 0.8684 (0.7465) acc 75.0000 (55.0000) kd_loss 1.3035 (1.1967) lr 1.9098e-04 eta 0:04:54
epoch [42/50] batch [60/319] time 0.106 (0.105) data 0.000 (0.008) loss 1.9254 (1.7629) ce_loss 1.2461 (1.1641) teacher_loss 1.1390 (0.9460) loss_zs_kd 0.5586 (0.6667) loss_oracle 0.7306 (0.7502) acc 56.2500 (55.0521) kd_loss 1.2845 (1.1965) lr 1.9098e-04 eta 0:04:53
epoch [42/50] batch [80/319] time 0.099 (0.105) data 0.000 (0.006) loss 1.7475 (1.7523) ce_loss 1.3311 (1.1632) teacher_loss 0.9087 (0.9431) loss_zs_kd 0.6048 (0.6731) loss_oracle 0.7783 (0.7419) acc 34.3750 (54.4922) kd_loss 1.1894 (1.1909) lr 1.9098e-04 eta 0:04:51
epoch [42/50] batch [100/319] time 0.100 (0.104) data 0.000 (0.005) loss 2.3058 (1.7650) ce_loss 1.2812 (1.1675) teacher_loss 1.5914 (0.9538) loss_zs_kd 0.7743 (0.6797) loss_oracle 0.6369 (0.7433) acc 59.3750 (54.5000) kd_loss 1.3292 (1.1920) lr 1.9098e-04 eta 0:04:48
epoch [42/50] batch [120/319] time 0.076 (0.101) data 0.000 (0.004) loss 1.5837 (1.7556) ce_loss 1.1504 (1.1560) teacher_loss 0.8594 (0.9451) loss_zs_kd 0.7833 (0.6874) loss_oracle 0.6459 (0.7418) acc 53.1250 (55.0521) kd_loss 1.2231 (1.1863) lr 1.9098e-04 eta 0:04:38
epoch [42/50] batch [140/319] time 0.093 (0.101) data 0.000 (0.004) loss 1.3909 (1.7519) ce_loss 0.7710 (1.1562) teacher_loss 0.6910 (0.9466) loss_zs_kd 0.7997 (0.6896) loss_oracle 0.6199 (0.7363) acc 68.7500 (55.1562) kd_loss 1.1213 (1.1802) lr 1.9098e-04 eta 0:04:35
epoch [42/50] batch [160/319] time 0.175 (0.103) data 0.000 (0.003) loss 2.0528 (1.7494) ce_loss 1.3145 (1.1562) teacher_loss 1.2720 (0.9433) loss_zs_kd 0.7750 (0.6897) loss_oracle 0.7033 (0.7371) acc 46.8750 (55.1758) kd_loss 1.1753 (1.1792) lr 1.9098e-04 eta 0:04:39
epoch [42/50] batch [180/319] time 0.210 (0.104) data 0.000 (0.003) loss 1.6511 (1.7486) ce_loss 1.0498 (1.1560) teacher_loss 0.8919 (0.9395) loss_zs_kd 0.6974 (0.6968) loss_oracle 0.6894 (0.7394) acc 59.3750 (55.1910) kd_loss 1.1525 (1.1768) lr 1.9098e-04 eta 0:04:40
epoch [42/50] batch [200/319] time 0.084 (0.103) data 0.000 (0.003) loss 1.6418 (1.7405) ce_loss 1.1084 (1.1493) teacher_loss 0.9728 (0.9350) loss_zs_kd 0.5381 (0.6967) loss_oracle 0.6151 (0.7358) acc 53.1250 (55.3594) kd_loss 1.1418 (1.1738) lr 1.9098e-04 eta 0:04:35
epoch [42/50] batch [220/319] time 0.146 (0.102) data 0.000 (0.003) loss 1.8608 (1.7346) ce_loss 1.2305 (1.1448) teacher_loss 1.0555 (0.9293) loss_zs_kd 0.5528 (0.7007) loss_oracle 0.7501 (0.7352) acc 59.3750 (55.4261) kd_loss 1.0764 (1.1722) lr 1.9098e-04 eta 0:04:31
epoch [42/50] batch [240/319] time 0.089 (0.102) data 0.000 (0.002) loss 1.7971 (1.7303) ce_loss 1.3340 (1.1402) teacher_loss 0.9149 (0.9256) loss_zs_kd 0.7102 (0.7021) loss_oracle 0.8112 (0.7345) acc 50.0000 (55.7161) kd_loss 1.2069 (1.1689) lr 1.9098e-04 eta 0:04:27
epoch [42/50] batch [260/319] time 0.087 (0.101) data 0.000 (0.002) loss 1.8325 (1.7263) ce_loss 1.2598 (1.1380) teacher_loss 1.0821 (0.9196) loss_zs_kd 0.8098 (0.7035) loss_oracle 0.6694 (0.7363) acc 53.1250 (55.8413) kd_loss 1.1933 (1.1697) lr 1.9098e-04 eta 0:04:23
epoch [42/50] batch [280/319] time 0.179 (0.102) data 0.000 (0.002) loss 1.7650 (1.7258) ce_loss 1.1436 (1.1383) teacher_loss 0.9880 (0.9193) loss_zs_kd 0.6185 (0.7076) loss_oracle 0.7152 (0.7357) acc 53.1250 (55.8259) kd_loss 1.0579 (1.1695) lr 1.9098e-04 eta 0:04:25
epoch [42/50] batch [300/319] time 0.174 (0.103) data 0.000 (0.002) loss 1.8874 (1.7288) ce_loss 1.1816 (1.1396) teacher_loss 0.9591 (0.9205) loss_zs_kd 0.8114 (0.7112) loss_oracle 0.8472 (0.7372) acc 50.0000 (55.8646) kd_loss 1.2104 (1.1687) lr 1.9098e-04 eta 0:04:25
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,812
* accuracy: 64.2%
* error: 35.8%
* macro_f1: 57.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,994
* accuracy: 51.3%
* error: 48.7%
* macro_f1: 23.7%
******* Domain 2 best val acc:      65.3%, epoch: 36 *******
******* Domain 2 best val test acc: 55.0%, epoch: 36 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
epoch [43/50] batch [20/319] time 0.103 (0.133) data 0.000 (0.026) loss 1.6441 (1.6698) ce_loss 0.9976 (1.0862) teacher_loss 0.9210 (0.9217) loss_zs_kd 0.9109 (0.7253) loss_oracle 0.6320 (0.6756) acc 59.3750 (58.2812) kd_loss 1.1717 (1.1331) lr 1.5567e-04 eta 0:05:35
epoch [43/50] batch [40/319] time 0.116 (0.119) data 0.000 (0.013) loss 2.1487 (1.7013) ce_loss 1.4834 (1.1302) teacher_loss 1.3862 (0.9261) loss_zs_kd 0.6807 (0.7102) loss_oracle 0.6944 (0.7042) acc 40.6250 (55.0781) kd_loss 1.0930 (1.1360) lr 1.5567e-04 eta 0:04:58
epoch [43/50] batch [60/319] time 0.107 (0.114) data 0.001 (0.009) loss 2.0112 (1.6978) ce_loss 1.3027 (1.1192) teacher_loss 1.1687 (0.9119) loss_zs_kd 0.7448 (0.7144) loss_oracle 0.7680 (0.7144) acc 50.0000 (55.6250) kd_loss 1.0702 (1.1314) lr 1.5567e-04 eta 0:04:43
epoch [43/50] batch [80/319] time 0.109 (0.112) data 0.000 (0.007) loss 1.4492 (1.6971) ce_loss 0.8721 (1.1255) teacher_loss 0.7412 (0.9085) loss_zs_kd 0.8036 (0.7179) loss_oracle 0.6277 (0.7169) acc 78.1250 (55.6250) kd_loss 1.1675 (1.1367) lr 1.5567e-04 eta 0:04:36
epoch [43/50] batch [100/319] time 0.118 (0.109) data 0.000 (0.005) loss 1.6181 (1.6906) ce_loss 1.1182 (1.1205) teacher_loss 0.7826 (0.9013) loss_zs_kd 0.6099 (0.7182) loss_oracle 0.7746 (0.7175) acc 50.0000 (55.7812) kd_loss 1.2336 (1.1359) lr 1.5567e-04 eta 0:04:27
epoch [43/50] batch [120/319] time 0.108 (0.108) data 0.000 (0.005) loss 1.5082 (1.6999) ce_loss 0.9565 (1.1236) teacher_loss 0.8343 (0.9036) loss_zs_kd 0.6740 (0.7153) loss_oracle 0.6064 (0.7247) acc 59.3750 (55.7292) kd_loss 1.2180 (1.1435) lr 1.5567e-04 eta 0:04:23
epoch [43/50] batch [140/319] time 0.101 (0.107) data 0.000 (0.004) loss 1.9581 (1.7030) ce_loss 1.4111 (1.1279) teacher_loss 1.0930 (0.9038) loss_zs_kd 0.5959 (0.7211) loss_oracle 0.8055 (0.7271) acc 43.7500 (55.5804) kd_loss 1.1305 (1.1437) lr 1.5567e-04 eta 0:04:18
epoch [43/50] batch [160/319] time 0.083 (0.105) data 0.000 (0.004) loss 1.7486 (1.7081) ce_loss 1.1357 (1.1233) teacher_loss 0.7912 (0.9052) loss_zs_kd 0.7412 (0.7255) loss_oracle 0.8832 (0.7304) acc 53.1250 (55.9375) kd_loss 1.2762 (1.1488) lr 1.5567e-04 eta 0:04:11
epoch [43/50] batch [180/319] time 0.217 (0.105) data 0.000 (0.003) loss 1.5960 (1.7129) ce_loss 1.1465 (1.1283) teacher_loss 0.9474 (0.9143) loss_zs_kd 0.6338 (0.7243) loss_oracle 0.5851 (0.7261) acc 59.3750 (56.0243) kd_loss 1.1410 (1.1450) lr 1.5567e-04 eta 0:04:09
epoch [43/50] batch [200/319] time 0.184 (0.106) data 0.000 (0.003) loss 1.6286 (1.7123) ce_loss 1.0684 (1.1274) teacher_loss 0.8891 (0.9134) loss_zs_kd 0.7134 (0.7247) loss_oracle 0.6681 (0.7264) acc 56.2500 (56.1094) kd_loss 1.1339 (1.1440) lr 1.5567e-04 eta 0:04:10
epoch [43/50] batch [220/319] time 0.074 (0.107) data 0.000 (0.003) loss 1.8888 (1.7170) ce_loss 1.2451 (1.1329) teacher_loss 1.1161 (0.9202) loss_zs_kd 0.7986 (0.7206) loss_oracle 0.6928 (0.7247) acc 53.1250 (55.9091) kd_loss 1.2372 (1.1448) lr 1.5567e-04 eta 0:04:09
epoch [43/50] batch [240/319] time 0.075 (0.105) data 0.000 (0.002) loss 1.7628 (1.7149) ce_loss 1.1465 (1.1320) teacher_loss 0.9183 (0.9196) loss_zs_kd 0.8550 (0.7205) loss_oracle 0.7590 (0.7233) acc 56.2500 (55.9635) kd_loss 1.1123 (1.1430) lr 1.5567e-04 eta 0:04:02
epoch [43/50] batch [260/319] time 0.081 (0.106) data 0.000 (0.002) loss 1.5321 (1.7116) ce_loss 1.0566 (1.1298) teacher_loss 0.7699 (0.9185) loss_zs_kd 0.9365 (0.7203) loss_oracle 0.6686 (0.7211) acc 65.6250 (56.1178) kd_loss 1.1996 (1.1452) lr 1.5567e-04 eta 0:04:03
epoch [43/50] batch [280/319] time 0.166 (0.107) data 0.000 (0.002) loss 1.4979 (1.7064) ce_loss 0.8970 (1.1275) teacher_loss 0.7854 (0.9139) loss_zs_kd 0.7239 (0.7210) loss_oracle 0.6401 (0.7204) acc 68.7500 (56.2165) kd_loss 1.0841 (1.1440) lr 1.5567e-04 eta 0:04:03
epoch [43/50] batch [300/319] time 0.175 (0.108) data 0.000 (0.002) loss 1.8429 (1.7056) ce_loss 1.1729 (1.1261) teacher_loss 1.0314 (0.9119) loss_zs_kd 0.5872 (0.7219) loss_oracle 0.7527 (0.7215) acc 62.5000 (56.1458) kd_loss 1.0435 (1.1456) lr 1.5567e-04 eta 0:04:03
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,839
* accuracy: 64.8%
* error: 35.2%
* macro_f1: 57.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,105
* accuracy: 52.4%
* error: 47.6%
* macro_f1: 23.6%
******* Domain 2 best val acc:      65.3%, epoch: 36 *******
******* Domain 2 best val test acc: 55.0%, epoch: 36 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
epoch [44/50] batch [20/319] time 0.095 (0.145) data 0.000 (0.036) loss 1.8736 (1.6892) ce_loss 1.2705 (1.1079) teacher_loss 1.1298 (0.8912) loss_zs_kd 0.6816 (0.7468) loss_oracle 0.6757 (0.7234) acc 50.0000 (57.6562) kd_loss 1.0995 (1.1598) lr 1.2369e-04 eta 0:05:21
epoch [44/50] batch [40/319] time 0.109 (0.124) data 0.000 (0.018) loss 1.8179 (1.7225) ce_loss 1.1768 (1.1249) teacher_loss 1.0922 (0.9189) loss_zs_kd 0.5759 (0.7454) loss_oracle 0.6682 (0.7290) acc 59.3750 (57.1094) kd_loss 1.0411 (1.1470) lr 1.2369e-04 eta 0:04:32
epoch [44/50] batch [60/319] time 0.111 (0.118) data 0.001 (0.012) loss 1.2544 (1.6958) ce_loss 0.8042 (1.1097) teacher_loss 0.5606 (0.9041) loss_zs_kd 0.7939 (0.7353) loss_oracle 0.6144 (0.7182) acc 71.8750 (57.6562) kd_loss 1.0576 (1.1370) lr 1.2369e-04 eta 0:04:15
epoch [44/50] batch [80/319] time 0.113 (0.114) data 0.000 (0.009) loss 1.7226 (1.6944) ce_loss 1.1592 (1.1047) teacher_loss 0.9414 (0.9016) loss_zs_kd 0.7732 (0.7367) loss_oracle 0.7039 (0.7191) acc 59.3750 (57.8516) kd_loss 1.1109 (1.1426) lr 1.2369e-04 eta 0:04:06
epoch [44/50] batch [100/319] time 0.109 (0.112) data 0.000 (0.007) loss 1.7358 (1.7059) ce_loss 1.1299 (1.1128) teacher_loss 0.8892 (0.9101) loss_zs_kd 0.6106 (0.7397) loss_oracle 0.7855 (0.7218) acc 59.3750 (57.5625) kd_loss 1.2002 (1.1498) lr 1.2369e-04 eta 0:03:59
epoch [44/50] batch [120/319] time 0.115 (0.111) data 0.000 (0.006) loss 1.7883 (1.7146) ce_loss 1.3057 (1.1289) teacher_loss 1.0013 (0.9212) loss_zs_kd 0.7066 (0.7306) loss_oracle 0.7163 (0.7203) acc 43.7500 (56.9010) kd_loss 1.1727 (1.1543) lr 1.2369e-04 eta 0:03:54
epoch [44/50] batch [140/319] time 0.077 (0.109) data 0.000 (0.005) loss 1.8295 (1.7244) ce_loss 1.2354 (1.1341) teacher_loss 0.9827 (0.9248) loss_zs_kd 0.7278 (0.7269) loss_oracle 0.7740 (0.7269) acc 46.8750 (56.4732) kd_loss 1.0863 (1.1555) lr 1.2369e-04 eta 0:03:48
epoch [44/50] batch [160/319] time 0.155 (0.108) data 0.000 (0.005) loss 1.6215 (1.7211) ce_loss 1.1172 (1.1358) teacher_loss 0.8033 (0.9238) loss_zs_kd 0.6327 (0.7279) loss_oracle 0.7550 (0.7245) acc 46.8750 (56.5820) kd_loss 1.1604 (1.1520) lr 1.2369e-04 eta 0:03:44
epoch [44/50] batch [180/319] time 0.182 (0.108) data 0.000 (0.004) loss 1.8445 (1.7247) ce_loss 1.2432 (1.1412) teacher_loss 1.1135 (0.9271) loss_zs_kd 0.5723 (0.7266) loss_oracle 0.6738 (0.7250) acc 46.8750 (56.1458) kd_loss 1.1529 (1.1528) lr 1.2369e-04 eta 0:03:42
epoch [44/50] batch [200/319] time 0.170 (0.109) data 0.000 (0.004) loss 1.2639 (1.7191) ce_loss 0.7290 (1.1382) teacher_loss 0.5812 (0.9221) loss_zs_kd 0.6989 (0.7310) loss_oracle 0.6129 (0.7239) acc 75.0000 (56.0781) kd_loss 1.1335 (1.1515) lr 1.2369e-04 eta 0:03:42
epoch [44/50] batch [220/319] time 0.078 (0.108) data 0.000 (0.004) loss 1.6672 (1.7177) ce_loss 1.0430 (1.1372) teacher_loss 0.8041 (0.9186) loss_zs_kd 0.7356 (0.7353) loss_oracle 0.7896 (0.7256) acc 62.5000 (55.9091) kd_loss 1.1609 (1.1525) lr 1.2369e-04 eta 0:03:36
epoch [44/50] batch [240/319] time 0.168 (0.108) data 0.000 (0.003) loss 1.9241 (1.7156) ce_loss 1.0859 (1.1331) teacher_loss 1.1915 (0.9150) loss_zs_kd 0.9259 (0.7359) loss_oracle 0.6400 (0.7271) acc 71.8750 (56.1979) kd_loss 1.2724 (1.1534) lr 1.2369e-04 eta 0:03:34
epoch [44/50] batch [260/319] time 0.163 (0.108) data 0.000 (0.003) loss 1.6995 (1.7139) ce_loss 1.2900 (1.1331) teacher_loss 0.8014 (0.9137) loss_zs_kd 0.6654 (0.7339) loss_oracle 0.8316 (0.7267) acc 50.0000 (56.0216) kd_loss 1.3090 (1.1552) lr 1.2369e-04 eta 0:03:32
epoch [44/50] batch [280/319] time 0.082 (0.107) data 0.000 (0.003) loss 1.8816 (1.7144) ce_loss 1.2852 (1.1322) teacher_loss 1.0489 (0.9139) loss_zs_kd 0.6167 (0.7318) loss_oracle 0.7709 (0.7273) acc 50.0000 (56.0379) kd_loss 1.1733 (1.1549) lr 1.2369e-04 eta 0:03:29
epoch [44/50] batch [300/319] time 0.162 (0.108) data 0.000 (0.003) loss 1.5471 (1.7115) ce_loss 1.0615 (1.1323) teacher_loss 0.8637 (0.9126) loss_zs_kd 0.7093 (0.7303) loss_oracle 0.6125 (0.7259) acc 65.6250 (56.0625) kd_loss 0.9927 (1.1540) lr 1.2369e-04 eta 0:03:28
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,790
* accuracy: 63.7%
* error: 36.3%
* macro_f1: 56.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,873
* accuracy: 50.1%
* error: 49.9%
* macro_f1: 23.4%
******* Domain 2 best val acc:      65.3%, epoch: 36 *******
******* Domain 2 best val test acc: 55.0%, epoch: 36 *******
******* Domain 2 best test acc:     57.7%, epoch: 28 *******
