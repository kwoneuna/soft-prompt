Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_100', 'location_43', 'location_46']
Target     ['location_38']
# classes  10
# train_x  10,216
# val      4,378
# test     9,736
---------  ----------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/319] time 0.097 (0.163) data 0.000 (0.040) loss 1.2658 (2.0283) ce_loss 1.2549 (2.0158) teacher_loss 1.2528 (2.0152) loss_zs_kd 0.0002 (0.0001) loss_oracle 0.0131 (0.0131) acc 59.3750 (36.8750) kd_loss 0.9628 (0.9466) lr 1.0000e-05 eta 0:43:08
epoch [1/50] batch [40/319] time 0.113 (0.130) data 0.000 (0.020) loss 1.5918 (1.9295) ce_loss 1.5752 (1.9126) teacher_loss 1.5746 (1.9121) loss_zs_kd 0.0015 (0.0003) loss_oracle 0.0172 (0.0175) acc 56.2500 (39.8438) kd_loss 0.9064 (0.9283) lr 1.0000e-05 eta 0:34:29
epoch [1/50] batch [60/319] time 0.101 (0.121) data 0.000 (0.013) loss 2.2030 (1.9614) ce_loss 2.1699 (1.9407) teacher_loss 2.1716 (1.9404) loss_zs_kd 0.0026 (0.0008) loss_oracle 0.0313 (0.0210) acc 31.2500 (39.2708) kd_loss 0.9491 (0.9336) lr 1.0000e-05 eta 0:32:06
epoch [1/50] batch [80/319] time 0.090 (0.117) data 0.000 (0.010) loss 2.0648 (1.9507) ce_loss 1.9766 (1.9221) teacher_loss 1.9702 (1.9215) loss_zs_kd 0.0041 (0.0015) loss_oracle 0.0946 (0.0291) acc 43.7500 (38.8672) kd_loss 0.9235 (0.9324) lr 1.0000e-05 eta 0:30:50
epoch [1/50] batch [100/319] time 0.114 (0.114) data 0.000 (0.008) loss 2.2918 (1.9281) ce_loss 2.1680 (1.8832) teacher_loss 2.1710 (1.8828) loss_zs_kd 0.0083 (0.0025) loss_oracle 0.1208 (0.0453) acc 25.0000 (39.4688) kd_loss 1.0048 (0.9303) lr 1.0000e-05 eta 0:30:03
epoch [1/50] batch [120/319] time 0.101 (0.112) data 0.000 (0.007) loss 1.9356 (1.9360) ce_loss 1.8662 (1.8809) teacher_loss 1.8661 (1.8809) loss_zs_kd 0.0065 (0.0035) loss_oracle 0.0696 (0.0552) acc 40.6250 (39.6354) kd_loss 0.8698 (0.9287) lr 1.0000e-05 eta 0:29:28
epoch [1/50] batch [140/319] time 0.111 (0.111) data 0.000 (0.006) loss 2.0861 (1.9358) ce_loss 2.0508 (1.8808) teacher_loss 2.0505 (1.8808) loss_zs_kd 0.0103 (0.0045) loss_oracle 0.0356 (0.0550) acc 37.5000 (39.5759) kd_loss 0.8176 (0.9264) lr 1.0000e-05 eta 0:29:08
epoch [1/50] batch [160/319] time 0.097 (0.110) data 0.000 (0.005) loss 1.8624 (1.9289) ce_loss 1.8281 (1.8767) teacher_loss 1.8241 (1.8768) loss_zs_kd 0.0138 (0.0058) loss_oracle 0.0383 (0.0521) acc 34.3750 (39.7070) kd_loss 0.9074 (0.9246) lr 1.0000e-05 eta 0:28:52
epoch [1/50] batch [180/319] time 0.107 (0.109) data 0.000 (0.005) loss 2.2243 (1.9253) ce_loss 2.1719 (1.8733) teacher_loss 2.1712 (1.8734) loss_zs_kd 0.0238 (0.0073) loss_oracle 0.0531 (0.0519) acc 28.1250 (39.6181) kd_loss 0.8519 (0.9231) lr 1.0000e-05 eta 0:28:38
epoch [1/50] batch [200/319] time 0.101 (0.108) data 0.000 (0.004) loss 2.1189 (1.9246) ce_loss 1.9922 (1.8687) teacher_loss 1.9913 (1.8687) loss_zs_kd 0.0248 (0.0089) loss_oracle 0.1275 (0.0559) acc 31.2500 (39.5625) kd_loss 0.9751 (0.9231) lr 1.0000e-05 eta 0:28:25
epoch [1/50] batch [220/319] time 0.101 (0.108) data 0.000 (0.004) loss 1.8467 (1.9369) ce_loss 1.7139 (1.8743) teacher_loss 1.7087 (1.8743) loss_zs_kd 0.0326 (0.0108) loss_oracle 0.1380 (0.0626) acc 50.0000 (39.1903) kd_loss 0.9470 (0.9235) lr 1.0000e-05 eta 0:28:16
epoch [1/50] batch [240/319] time 0.091 (0.107) data 0.000 (0.004) loss 2.0592 (1.9497) ce_loss 1.9336 (1.8807) teacher_loss 1.9297 (1.8808) loss_zs_kd 0.0452 (0.0128) loss_oracle 0.1295 (0.0689) acc 28.1250 (38.8802) kd_loss 0.8989 (0.9254) lr 1.0000e-05 eta 0:28:05
epoch [1/50] batch [260/319] time 0.086 (0.105) data 0.000 (0.003) loss 2.1488 (1.9523) ce_loss 1.9736 (1.8779) teacher_loss 1.9806 (1.8779) loss_zs_kd 0.0415 (0.0149) loss_oracle 0.1682 (0.0744) acc 40.6250 (38.8221) kd_loss 0.8925 (0.9255) lr 1.0000e-05 eta 0:27:34
epoch [1/50] batch [280/319] time 0.074 (0.106) data 0.000 (0.003) loss 2.3236 (1.9577) ce_loss 2.0684 (1.8739) teacher_loss 2.0918 (1.8740) loss_zs_kd 0.0606 (0.0172) loss_oracle 0.2317 (0.0837) acc 31.2500 (38.8393) kd_loss 0.9579 (0.9256) lr 1.0000e-05 eta 0:27:44
epoch [1/50] batch [300/319] time 0.077 (0.107) data 0.000 (0.003) loss 2.4446 (1.9606) ce_loss 2.2773 (1.8695) teacher_loss 2.2817 (1.8698) loss_zs_kd 0.0592 (0.0197) loss_oracle 0.1629 (0.0909) acc 31.2500 (38.8229) kd_loss 0.9081 (0.9255) lr 1.0000e-05 eta 0:27:49
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 1,774
* accuracy: 40.5%
* error: 59.5%
* macro_f1: 26.1%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,206
* accuracy: 32.9%
* error: 67.1%
* macro_f1: 14.2%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      40.5%, epoch: 1 *******
******* Domain 2 best val test acc: 32.9%, epoch: 1 *******
******* Domain 2 best test acc:     32.9%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/ana
epoch [2/50] batch [20/319] time 0.100 (0.128) data 0.000 (0.032) loss 2.5669 (2.4342) ce_loss 1.7549 (1.7048) teacher_loss 1.5941 (1.6725) loss_zs_kd 0.6244 (0.4990) loss_oracle 0.9729 (0.7617) acc 28.1250 (37.1875) kd_loss 1.0149 (0.9900) lr 2.0000e-03 eta 0:33:17
epoch [2/50] batch [40/319] time 0.108 (0.116) data 0.000 (0.016) loss 2.8530 (2.5104) ce_loss 2.0410 (1.6998) teacher_loss 1.8791 (1.6267) loss_zs_kd 0.4792 (0.6267) loss_oracle 0.9739 (0.8836) acc 28.1250 (37.3438) kd_loss 1.0269 (1.0142) lr 2.0000e-03 eta 0:30:05
epoch [2/50] batch [60/319] time 0.096 (0.111) data 0.000 (0.011) loss 2.5178 (2.5073) ce_loss 1.7637 (1.6676) teacher_loss 1.4907 (1.5795) loss_zs_kd 0.3677 (0.5531) loss_oracle 1.0270 (0.9278) acc 34.3750 (38.1771) kd_loss 1.0465 (1.0225) lr 2.0000e-03 eta 0:28:47
epoch [2/50] batch [80/319] time 0.103 (0.109) data 0.000 (0.008) loss 2.2219 (2.4597) ce_loss 1.4922 (1.6215) teacher_loss 1.4039 (1.5474) loss_zs_kd 0.4397 (0.4996) loss_oracle 0.8180 (0.9123) acc 53.1250 (39.7266) kd_loss 1.0173 (1.0271) lr 2.0000e-03 eta 0:28:16
epoch [2/50] batch [100/319] time 0.107 (0.108) data 0.000 (0.007) loss 2.3314 (2.4189) ce_loss 1.6992 (1.6021) teacher_loss 1.5053 (1.5340) loss_zs_kd 0.3950 (0.4825) loss_oracle 0.8261 (0.8849) acc 34.3750 (40.1562) kd_loss 1.0543 (1.0371) lr 2.0000e-03 eta 0:27:53
epoch [2/50] batch [120/319] time 0.092 (0.105) data 0.000 (0.006) loss 1.9089 (2.3905) ce_loss 1.2090 (1.5816) teacher_loss 1.0762 (1.5135) loss_zs_kd 0.3804 (0.4770) loss_oracle 0.8327 (0.8769) acc 62.5000 (40.5990) kd_loss 1.0704 (1.0387) lr 2.0000e-03 eta 0:27:12
epoch [2/50] batch [140/319] time 0.114 (0.105) data 0.000 (0.005) loss 2.4594 (2.3723) ce_loss 1.7275 (1.5756) teacher_loss 1.5408 (1.4995) loss_zs_kd 0.5189 (0.4757) loss_oracle 0.9186 (0.8728) acc 37.5000 (40.6473) kd_loss 1.0744 (1.0414) lr 2.0000e-03 eta 0:27:02
epoch [2/50] batch [160/319] time 0.098 (0.103) data 0.000 (0.004) loss 2.3299 (2.3554) ce_loss 1.4639 (1.5605) teacher_loss 1.3376 (1.4779) loss_zs_kd 0.4631 (0.4842) loss_oracle 0.9923 (0.8775) acc 46.8750 (41.5625) kd_loss 1.1046 (1.0466) lr 2.0000e-03 eta 0:26:35
epoch [2/50] batch [180/319] time 0.089 (0.102) data 0.000 (0.004) loss 2.6035 (2.3644) ce_loss 1.6377 (1.5620) teacher_loss 1.4945 (1.4709) loss_zs_kd 0.6379 (0.5004) loss_oracle 1.1090 (0.8935) acc 28.1250 (41.5799) kd_loss 1.0961 (1.0499) lr 2.0000e-03 eta 0:26:20
epoch [2/50] batch [200/319] time 0.092 (0.101) data 0.000 (0.003) loss 2.3617 (2.3689) ce_loss 1.4834 (1.5640) teacher_loss 1.3736 (1.4652) loss_zs_kd 0.6674 (0.5202) loss_oracle 0.9881 (0.9037) acc 53.1250 (41.5938) kd_loss 1.0562 (1.0504) lr 2.0000e-03 eta 0:25:59
epoch [2/50] batch [220/319] time 0.103 (0.100) data 0.000 (0.003) loss 2.6386 (2.3639) ce_loss 1.7549 (1.5604) teacher_loss 1.6519 (1.4562) loss_zs_kd 0.3932 (0.5216) loss_oracle 0.9867 (0.9078) acc 31.2500 (41.3920) kd_loss 1.0530 (1.0491) lr 2.0000e-03 eta 0:25:46
epoch [2/50] batch [240/319] time 0.071 (0.100) data 0.000 (0.003) loss 1.9149 (2.3493) ce_loss 1.1445 (1.5489) teacher_loss 0.9756 (1.4395) loss_zs_kd 0.4891 (0.5131) loss_oracle 0.9394 (0.9098) acc 53.1250 (41.8359) kd_loss 1.0461 (1.0485) lr 2.0000e-03 eta 0:25:34
epoch [2/50] batch [260/319] time 0.140 (0.098) data 0.000 (0.003) loss 2.2229 (2.3325) ce_loss 1.4609 (1.5383) teacher_loss 1.2935 (1.4174) loss_zs_kd 0.4363 (0.5144) loss_oracle 0.9295 (0.9151) acc 46.8750 (42.1274) kd_loss 1.0397 (1.0467) lr 2.0000e-03 eta 0:25:12
epoch [2/50] batch [280/319] time 0.063 (0.099) data 0.000 (0.003) loss 2.2133 (2.3243) ce_loss 1.4121 (1.5348) teacher_loss 1.3513 (1.4105) loss_zs_kd 0.4167 (0.5123) loss_oracle 0.8620 (0.9138) acc 46.8750 (42.2545) kd_loss 1.0204 (1.0451) lr 2.0000e-03 eta 0:25:22
epoch [2/50] batch [300/319] time 0.068 (0.099) data 0.000 (0.002) loss 1.9876 (2.3172) ce_loss 1.3057 (1.5321) teacher_loss 1.1027 (1.4058) loss_zs_kd 0.4758 (0.5136) loss_oracle 0.8848 (0.9115) acc 50.0000 (42.2396) kd_loss 1.0122 (1.0425) lr 2.0000e-03 eta 0:25:10
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,092
* accuracy: 47.8%
* error: 52.2%
* macro_f1: 36.4%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,474
* accuracy: 46.0%
* error: 54.0%
* macro_f1: 17.8%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      47.8%, epoch: 2 *******
******* Domain 2 best val test acc: 46.0%, epoch: 2 *******
******* Domain 2 best test acc:     46.0%, epoch: 2 *******
epoch [3/50] batch [20/319] time 0.098 (0.127) data 0.000 (0.024) loss 1.8459 (2.0334) ce_loss 1.1084 (1.3254) teacher_loss 1.0089 (1.1996) loss_zs_kd 0.4173 (0.5066) loss_oracle 0.8370 (0.8338) acc 56.2500 (50.7812) kd_loss 0.9855 (1.0026) lr 1.9980e-03 eta 0:32:23
epoch [3/50] batch [40/319] time 0.096 (0.115) data 0.000 (0.012) loss 2.0084 (2.0853) ce_loss 1.3135 (1.3546) teacher_loss 1.1386 (1.2312) loss_zs_kd 0.5511 (0.5177) loss_oracle 0.8698 (0.8541) acc 50.0000 (49.1406) kd_loss 1.0064 (1.0034) lr 1.9980e-03 eta 0:29:22
epoch [3/50] batch [60/319] time 0.096 (0.111) data 0.001 (0.008) loss 1.9589 (2.0716) ce_loss 1.2168 (1.3576) teacher_loss 1.0183 (1.2170) loss_zs_kd 0.5972 (0.5319) loss_oracle 0.9406 (0.8546) acc 53.1250 (48.8021) kd_loss 0.9807 (0.9968) lr 1.9980e-03 eta 0:28:14
epoch [3/50] batch [80/319] time 0.099 (0.109) data 0.000 (0.006) loss 1.9253 (2.0783) ce_loss 1.1602 (1.3636) teacher_loss 1.0648 (1.2203) loss_zs_kd 0.4949 (0.5477) loss_oracle 0.8605 (0.8580) acc 62.5000 (48.1641) kd_loss 0.9504 (0.9905) lr 1.9980e-03 eta 0:27:35
epoch [3/50] batch [100/319] time 0.099 (0.108) data 0.000 (0.005) loss 2.0635 (2.0835) ce_loss 1.1738 (1.3658) teacher_loss 1.1631 (1.2232) loss_zs_kd 0.5140 (0.5394) loss_oracle 0.9004 (0.8603) acc 65.6250 (48.5312) kd_loss 0.8754 (0.9804) lr 1.9980e-03 eta 0:27:19
epoch [3/50] batch [120/319] time 0.110 (0.107) data 0.000 (0.004) loss 2.2598 (2.0796) ce_loss 1.4814 (1.3614) teacher_loss 1.4155 (1.2221) loss_zs_kd 0.5278 (0.5376) loss_oracle 0.8443 (0.8575) acc 43.7500 (48.9583) kd_loss 0.9683 (0.9754) lr 1.9980e-03 eta 0:27:10
epoch [3/50] batch [140/319] time 0.102 (0.107) data 0.000 (0.004) loss 1.7953 (2.0709) ce_loss 1.1064 (1.3550) teacher_loss 0.9843 (1.2162) loss_zs_kd 0.5412 (0.5402) loss_oracle 0.8110 (0.8547) acc 65.6250 (49.1741) kd_loss 0.9744 (0.9723) lr 1.9980e-03 eta 0:27:00
epoch [3/50] batch [160/319] time 0.108 (0.106) data 0.000 (0.003) loss 1.9428 (2.0599) ce_loss 1.2080 (1.3533) teacher_loss 1.0907 (1.2056) loss_zs_kd 0.6872 (0.5506) loss_oracle 0.8521 (0.8543) acc 59.3750 (49.0039) kd_loss 0.9633 (0.9705) lr 1.9980e-03 eta 0:26:50
epoch [3/50] batch [180/319] time 0.096 (0.106) data 0.000 (0.003) loss 2.2175 (2.0566) ce_loss 1.3535 (1.3531) teacher_loss 1.3458 (1.2072) loss_zs_kd 0.4451 (0.5584) loss_oracle 0.8716 (0.8494) acc 50.0000 (48.9410) kd_loss 0.9516 (0.9685) lr 1.9980e-03 eta 0:26:40
epoch [3/50] batch [200/319] time 0.100 (0.106) data 0.000 (0.003) loss 2.1063 (2.0557) ce_loss 1.3574 (1.3516) teacher_loss 1.2523 (1.2038) loss_zs_kd 0.6085 (0.5541) loss_oracle 0.8540 (0.8519) acc 56.2500 (48.8594) kd_loss 0.9674 (0.9659) lr 1.9980e-03 eta 0:26:36
epoch [3/50] batch [220/319] time 0.103 (0.105) data 0.000 (0.002) loss 1.9185 (2.0525) ce_loss 1.4092 (1.3545) teacher_loss 1.0375 (1.1981) loss_zs_kd 0.5229 (0.5610) loss_oracle 0.8810 (0.8544) acc 31.2500 (48.6364) kd_loss 0.9873 (0.9644) lr 1.9980e-03 eta 0:26:29
epoch [3/50] batch [240/319] time 0.095 (0.105) data 0.000 (0.002) loss 2.1876 (2.0482) ce_loss 1.5508 (1.3510) teacher_loss 1.2734 (1.1913) loss_zs_kd 0.7482 (0.5682) loss_oracle 0.9143 (0.8570) acc 43.7500 (48.8281) kd_loss 0.9642 (0.9629) lr 1.9980e-03 eta 0:26:25
epoch [3/50] batch [260/319] time 0.088 (0.104) data 0.000 (0.002) loss 2.0265 (2.0497) ce_loss 1.2432 (1.3499) teacher_loss 1.1891 (1.1940) loss_zs_kd 0.6348 (0.5755) loss_oracle 0.8374 (0.8557) acc 53.1250 (48.9663) kd_loss 0.9345 (0.9609) lr 1.9980e-03 eta 0:26:07
epoch [3/50] batch [280/319] time 0.082 (0.104) data 0.000 (0.002) loss 1.9438 (2.0442) ce_loss 1.3447 (1.3478) teacher_loss 1.0264 (1.1880) loss_zs_kd 0.7511 (0.5862) loss_oracle 0.9174 (0.8563) acc 50.0000 (48.9509) kd_loss 0.9612 (0.9591) lr 1.9980e-03 eta 0:26:02
epoch [3/50] batch [300/319] time 0.081 (0.104) data 0.000 (0.002) loss 1.7537 (2.0406) ce_loss 1.1836 (1.3484) teacher_loss 0.8957 (1.1851) loss_zs_kd 0.8643 (0.6008) loss_oracle 0.8581 (0.8555) acc 56.2500 (49.1146) kd_loss 0.9495 (0.9576) lr 1.9980e-03 eta 0:26:00
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,119
* accuracy: 48.4%
* error: 51.6%
* macro_f1: 38.1%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,203
* accuracy: 53.4%
* error: 46.6%
* macro_f1: 20.8%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      48.4%, epoch: 3 *******
******* Domain 2 best val test acc: 53.4%, epoch: 3 *******
******* Domain 2 best test acc:     53.4%, epoch: 3 *******
epoch [4/50] batch [20/319] time 0.105 (0.135) data 0.000 (0.027) loss 2.0115 (1.9587) ce_loss 1.4707 (1.3905) teacher_loss 1.1251 (1.1037) loss_zs_kd 0.9057 (0.8968) loss_oracle 0.8864 (0.8550) acc 34.3750 (44.3750) kd_loss 0.8939 (0.9237) lr 1.9921e-03 eta 0:33:47
epoch [4/50] batch [40/319] time 0.094 (0.120) data 0.000 (0.014) loss 1.9240 (1.9514) ce_loss 1.2773 (1.3567) teacher_loss 1.1174 (1.0986) loss_zs_kd 0.7519 (0.9202) loss_oracle 0.8066 (0.8528) acc 46.8750 (45.7812) kd_loss 0.9770 (0.9292) lr 1.9921e-03 eta 0:29:48
epoch [4/50] batch [60/319] time 0.114 (0.115) data 0.000 (0.009) loss 1.9773 (1.9413) ce_loss 1.5254 (1.3330) teacher_loss 1.1650 (1.0896) loss_zs_kd 0.9526 (0.8840) loss_oracle 0.8123 (0.8517) acc 46.8750 (48.3333) kd_loss 0.9597 (0.9266) lr 1.9921e-03 eta 0:28:31
epoch [4/50] batch [80/319] time 0.110 (0.112) data 0.000 (0.007) loss 2.1088 (1.9481) ce_loss 1.3398 (1.3423) teacher_loss 1.3068 (1.1003) loss_zs_kd 0.7487 (0.8621) loss_oracle 0.8021 (0.8478) acc 56.2500 (48.1641) kd_loss 0.9039 (0.9243) lr 1.9921e-03 eta 0:27:44
epoch [4/50] batch [100/319] time 0.108 (0.110) data 0.000 (0.006) loss 2.1838 (1.9441) ce_loss 1.3604 (1.3393) teacher_loss 1.3597 (1.0979) loss_zs_kd 0.8047 (0.8476) loss_oracle 0.8241 (0.8462) acc 43.7500 (48.5000) kd_loss 0.9040 (0.9213) lr 1.9921e-03 eta 0:27:21
epoch [4/50] batch [120/319] time 0.092 (0.109) data 0.000 (0.005) loss 2.0246 (1.9433) ce_loss 1.4629 (1.3367) teacher_loss 1.1958 (1.1003) loss_zs_kd 0.7336 (0.8360) loss_oracle 0.8289 (0.8430) acc 50.0000 (48.7500) kd_loss 0.8888 (0.9177) lr 1.9921e-03 eta 0:27:05
epoch [4/50] batch [140/319] time 0.104 (0.109) data 0.000 (0.004) loss 2.2222 (1.9436) ce_loss 1.3916 (1.3324) teacher_loss 1.4310 (1.1053) loss_zs_kd 1.0365 (0.8423) loss_oracle 0.7912 (0.8383) acc 50.0000 (49.1518) kd_loss 0.8783 (0.9160) lr 1.9921e-03 eta 0:26:51
epoch [4/50] batch [160/319] time 0.115 (0.108) data 0.000 (0.004) loss 2.3114 (1.9411) ce_loss 1.5947 (1.3335) teacher_loss 1.5602 (1.1100) loss_zs_kd 0.9891 (0.8481) loss_oracle 0.7512 (0.8310) acc 34.3750 (49.1992) kd_loss 0.9608 (0.9160) lr 1.9921e-03 eta 0:26:43
epoch [4/50] batch [180/319] time 0.111 (0.108) data 0.000 (0.003) loss 1.9349 (1.9385) ce_loss 1.2695 (1.3295) teacher_loss 1.1589 (1.1158) loss_zs_kd 0.7348 (0.8506) loss_oracle 0.7760 (0.8227) acc 53.1250 (49.1493) kd_loss 0.8970 (0.9173) lr 1.9921e-03 eta 0:26:35
epoch [4/50] batch [200/319] time 0.098 (0.107) data 0.000 (0.003) loss 1.8374 (1.9394) ce_loss 1.2227 (1.3218) teacher_loss 1.0796 (1.1222) loss_zs_kd 0.7518 (0.8441) loss_oracle 0.7578 (0.8172) acc 56.2500 (49.5938) kd_loss 0.8965 (0.9153) lr 1.9921e-03 eta 0:26:26
epoch [4/50] batch [220/319] time 0.098 (0.107) data 0.000 (0.003) loss 1.9837 (1.9329) ce_loss 1.2832 (1.3123) teacher_loss 1.2412 (1.1204) loss_zs_kd 0.8722 (0.8401) loss_oracle 0.7425 (0.8124) acc 46.8750 (50.0284) kd_loss 0.8568 (0.9129) lr 1.9921e-03 eta 0:26:19
epoch [4/50] batch [240/319] time 0.104 (0.106) data 0.000 (0.002) loss 2.0290 (1.9333) ce_loss 1.2178 (1.3113) teacher_loss 1.2614 (1.1240) loss_zs_kd 0.8114 (0.8386) loss_oracle 0.7675 (0.8093) acc 53.1250 (50.0651) kd_loss 0.8307 (0.9111) lr 1.9921e-03 eta 0:26:04
epoch [4/50] batch [260/319] time 0.103 (0.105) data 0.000 (0.002) loss 2.1367 (1.9352) ce_loss 1.3711 (1.3117) teacher_loss 1.2866 (1.1269) loss_zs_kd 0.9639 (0.8396) loss_oracle 0.8501 (0.8083) acc 46.8750 (49.9880) kd_loss 0.8712 (0.9080) lr 1.9921e-03 eta 0:25:53
epoch [4/50] batch [280/319] time 0.131 (0.104) data 0.000 (0.002) loss 1.8797 (1.9316) ce_loss 1.3467 (1.3073) teacher_loss 1.0981 (1.1250) loss_zs_kd 0.8178 (0.8392) loss_oracle 0.7816 (0.8067) acc 46.8750 (50.1339) kd_loss 0.8317 (0.9048) lr 1.9921e-03 eta 0:25:28
epoch [4/50] batch [300/319] time 0.175 (0.105) data 0.000 (0.002) loss 1.7065 (1.9269) ce_loss 1.1113 (1.3010) teacher_loss 0.8976 (1.1218) loss_zs_kd 0.9963 (0.8392) loss_oracle 0.8089 (0.8052) acc 59.3750 (50.3229) kd_loss 0.9016 (0.9036) lr 1.9921e-03 eta 0:25:46
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,253
* accuracy: 51.5%
* error: 48.5%
* macro_f1: 41.1%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,146
* accuracy: 52.9%
* error: 47.1%
* macro_f1: 19.0%
******* Domain 2 best val acc:      51.5%, epoch: 4 *******
******* Domain 2 best val test acc: 52.9%, epoch: 4 *******
******* Domain 2 best test acc:     53.4%, epoch: 3 *******
epoch [5/50] batch [20/319] time 0.099 (0.128) data 0.000 (0.024) loss 1.8692 (1.8860) ce_loss 1.2793 (1.2859) teacher_loss 1.1239 (1.1006) loss_zs_kd 0.8057 (0.8886) loss_oracle 0.7453 (0.7854) acc 50.0000 (49.6875) kd_loss 0.8772 (0.8785) lr 1.9823e-03 eta 0:31:09
epoch [5/50] batch [40/319] time 0.097 (0.116) data 0.000 (0.012) loss 1.5697 (1.8851) ce_loss 1.0156 (1.2901) teacher_loss 0.7861 (1.1145) loss_zs_kd 0.9112 (0.9206) loss_oracle 0.7836 (0.7707) acc 56.2500 (49.8438) kd_loss 0.9060 (0.8670) lr 1.9823e-03 eta 0:28:21
epoch [5/50] batch [60/319] time 0.114 (0.113) data 0.000 (0.008) loss 1.8124 (1.8964) ce_loss 1.1914 (1.2872) teacher_loss 0.9940 (1.1260) loss_zs_kd 0.9991 (0.8988) loss_oracle 0.8183 (0.7704) acc 56.2500 (49.8438) kd_loss 0.8365 (0.8664) lr 1.9823e-03 eta 0:27:24
epoch [5/50] batch [80/319] time 0.100 (0.110) data 0.000 (0.006) loss 1.5909 (1.8884) ce_loss 1.0264 (1.2725) teacher_loss 0.7618 (1.1154) loss_zs_kd 0.7968 (0.8969) loss_oracle 0.8291 (0.7730) acc 68.7500 (50.8984) kd_loss 0.8630 (0.8588) lr 1.9823e-03 eta 0:26:47
epoch [5/50] batch [100/319] time 0.095 (0.109) data 0.000 (0.005) loss 1.8878 (1.8791) ce_loss 1.3047 (1.2674) teacher_loss 1.1273 (1.1023) loss_zs_kd 0.9688 (0.9092) loss_oracle 0.7604 (0.7768) acc 46.8750 (51.4062) kd_loss 0.9102 (0.8574) lr 1.9823e-03 eta 0:26:24
epoch [5/50] batch [120/319] time 0.097 (0.107) data 0.000 (0.004) loss 1.8593 (1.8853) ce_loss 1.2090 (1.2701) teacher_loss 1.1232 (1.1141) loss_zs_kd 0.7293 (0.8946) loss_oracle 0.7361 (0.7712) acc 46.8750 (51.2760) kd_loss 0.9039 (0.8573) lr 1.9823e-03 eta 0:25:58
epoch [5/50] batch [140/319] time 0.106 (0.107) data 0.000 (0.004) loss 2.1389 (1.8770) ce_loss 1.5361 (1.2623) teacher_loss 1.4051 (1.1113) loss_zs_kd 0.8207 (0.8903) loss_oracle 0.7338 (0.7657) acc 34.3750 (51.7857) kd_loss 0.9251 (0.8616) lr 1.9823e-03 eta 0:25:48
epoch [5/50] batch [160/319] time 0.102 (0.106) data 0.000 (0.003) loss 1.9418 (1.8765) ce_loss 1.3369 (1.2533) teacher_loss 1.2800 (1.1156) loss_zs_kd 0.7655 (0.8818) loss_oracle 0.6618 (0.7609) acc 50.0000 (52.2852) kd_loss 1.0439 (0.8744) lr 1.9823e-03 eta 0:25:38
epoch [5/50] batch [180/319] time 0.100 (0.106) data 0.000 (0.003) loss 1.6630 (1.8721) ce_loss 1.0557 (1.2489) teacher_loss 0.9638 (1.1184) loss_zs_kd 0.9505 (0.8782) loss_oracle 0.6992 (0.7536) acc 65.6250 (52.5347) kd_loss 1.0062 (0.8885) lr 1.9823e-03 eta 0:25:33
epoch [5/50] batch [200/319] time 0.108 (0.106) data 0.000 (0.003) loss 1.8471 (1.8715) ce_loss 1.1855 (1.2462) teacher_loss 1.0838 (1.1212) loss_zs_kd 0.9333 (0.8712) loss_oracle 0.7633 (0.7503) acc 62.5000 (52.8438) kd_loss 0.9709 (0.8928) lr 1.9823e-03 eta 0:25:27
epoch [5/50] batch [220/319] time 0.102 (0.105) data 0.000 (0.002) loss 1.7405 (1.8786) ce_loss 1.0098 (1.2459) teacher_loss 0.9894 (1.1266) loss_zs_kd 0.8029 (0.8621) loss_oracle 0.7510 (0.7520) acc 71.8750 (52.9403) kd_loss 0.9754 (0.9011) lr 1.9823e-03 eta 0:25:22
epoch [5/50] batch [240/319] time 0.098 (0.105) data 0.000 (0.002) loss 1.9361 (1.8892) ce_loss 1.1387 (1.2494) teacher_loss 1.0768 (1.1322) loss_zs_kd 0.6923 (0.8582) loss_oracle 0.8593 (0.7570) acc 50.0000 (52.8125) kd_loss 0.9601 (0.9089) lr 1.9823e-03 eta 0:25:16
epoch [5/50] batch [260/319] time 0.098 (0.105) data 0.000 (0.002) loss 2.0954 (1.8966) ce_loss 1.3867 (1.2526) teacher_loss 1.4198 (1.1342) loss_zs_kd 0.9696 (0.8588) loss_oracle 0.6756 (0.7624) acc 50.0000 (52.5120) kd_loss 0.9380 (0.9127) lr 1.9823e-03 eta 0:25:10
epoch [5/50] batch [280/319] time 0.078 (0.104) data 0.000 (0.002) loss 1.4717 (1.8959) ce_loss 0.8560 (1.2519) teacher_loss 0.7771 (1.1350) loss_zs_kd 0.5607 (0.8544) loss_oracle 0.6946 (0.7609) acc 65.6250 (52.5558) kd_loss 0.9902 (0.9154) lr 1.9823e-03 eta 0:24:51
epoch [5/50] batch [300/319] time 0.163 (0.103) data 0.000 (0.002) loss 1.9840 (1.8944) ce_loss 1.2891 (1.2481) teacher_loss 1.2678 (1.1365) loss_zs_kd 0.7188 (0.8478) loss_oracle 0.7162 (0.7580) acc 53.1250 (52.7708) kd_loss 0.8747 (0.9134) lr 1.9823e-03 eta 0:24:42
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,676
* accuracy: 61.1%
* error: 38.9%
* macro_f1: 51.3%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,566
* accuracy: 46.9%
* error: 53.1%
* macro_f1: 20.9%
******* Domain 2 best val acc:      61.1%, epoch: 5 *******
******* Domain 2 best val test acc: 46.9%, epoch: 5 *******
******* Domain 2 best test acc:     53.4%, epoch: 3 *******
epoch [6/50] batch [20/319] time 0.100 (0.130) data 0.000 (0.028) loss 1.9257 (1.7907) ce_loss 1.3740 (1.1520) teacher_loss 1.1871 (1.0992) loss_zs_kd 0.8320 (0.7728) loss_oracle 0.7386 (0.6914) acc 37.5000 (56.8750) kd_loss 0.9411 (0.9156) lr 1.9686e-03 eta 0:31:09
epoch [6/50] batch [40/319] time 0.103 (0.116) data 0.000 (0.014) loss 1.8282 (1.7660) ce_loss 1.2803 (1.1441) teacher_loss 1.0845 (1.0538) loss_zs_kd 0.7921 (0.7877) loss_oracle 0.7436 (0.7122) acc 50.0000 (57.0312) kd_loss 0.8657 (0.9025) lr 1.9686e-03 eta 0:27:42
epoch [6/50] batch [60/319] time 0.106 (0.112) data 0.001 (0.010) loss 1.9021 (1.7995) ce_loss 1.2529 (1.1712) teacher_loss 1.2121 (1.0869) loss_zs_kd 0.7803 (0.7775) loss_oracle 0.6899 (0.7125) acc 46.8750 (55.2604) kd_loss 0.9159 (0.8956) lr 1.9686e-03 eta 0:26:47
epoch [6/50] batch [80/319] time 0.101 (0.111) data 0.000 (0.007) loss 1.8538 (1.8070) ce_loss 1.2578 (1.1757) teacher_loss 1.1973 (1.0981) loss_zs_kd 0.7880 (0.7742) loss_oracle 0.6565 (0.7089) acc 59.3750 (54.7656) kd_loss 0.9048 (0.8978) lr 1.9686e-03 eta 0:26:23
epoch [6/50] batch [100/319] time 0.103 (0.110) data 0.000 (0.006) loss 1.8484 (1.8245) ce_loss 1.0195 (1.1865) teacher_loss 1.0144 (1.1156) loss_zs_kd 0.8184 (0.7638) loss_oracle 0.8340 (0.7089) acc 68.7500 (54.6562) kd_loss 0.9468 (0.9003) lr 1.9686e-03 eta 0:26:02
epoch [6/50] batch [120/319] time 0.110 (0.109) data 0.000 (0.005) loss 1.8569 (1.8349) ce_loss 1.1973 (1.1860) teacher_loss 1.0565 (1.1115) loss_zs_kd 0.9541 (0.7755) loss_oracle 0.8004 (0.7233) acc 56.2500 (55.1042) kd_loss 0.9342 (0.9068) lr 1.9686e-03 eta 0:25:55
epoch [6/50] batch [140/319] time 0.100 (0.109) data 0.000 (0.004) loss 2.1274 (1.8443) ce_loss 1.3516 (1.1847) teacher_loss 1.3222 (1.1088) loss_zs_kd 0.7956 (0.7854) loss_oracle 0.8052 (0.7355) acc 50.0000 (55.2902) kd_loss 0.8507 (0.9047) lr 1.9686e-03 eta 0:25:45
epoch [6/50] batch [160/319] time 0.103 (0.108) data 0.000 (0.004) loss 1.8412 (1.8451) ce_loss 1.1348 (1.1887) teacher_loss 1.0852 (1.1014) loss_zs_kd 0.7594 (0.7986) loss_oracle 0.7560 (0.7437) acc 62.5000 (55.3125) kd_loss 0.9624 (0.9051) lr 1.9686e-03 eta 0:25:34
epoch [6/50] batch [180/319] time 0.099 (0.108) data 0.001 (0.003) loss 2.1045 (1.8553) ce_loss 1.4326 (1.1962) teacher_loss 1.3273 (1.1085) loss_zs_kd 0.8176 (0.8000) loss_oracle 0.7773 (0.7468) acc 50.0000 (55.2083) kd_loss 0.8659 (0.9052) lr 1.9686e-03 eta 0:25:28
epoch [6/50] batch [200/319] time 0.108 (0.108) data 0.000 (0.003) loss 1.7842 (1.8487) ce_loss 1.1279 (1.1924) teacher_loss 1.0670 (1.1039) loss_zs_kd 0.7285 (0.7917) loss_oracle 0.7172 (0.7447) acc 62.5000 (55.3438) kd_loss 0.8855 (0.9036) lr 1.9686e-03 eta 0:25:24
epoch [6/50] batch [220/319] time 0.094 (0.107) data 0.000 (0.003) loss 1.7671 (1.8497) ce_loss 1.0898 (1.1903) teacher_loss 1.0074 (1.1044) loss_zs_kd 0.8321 (0.7995) loss_oracle 0.7598 (0.7453) acc 65.6250 (55.4261) kd_loss 0.9654 (0.9045) lr 1.9686e-03 eta 0:25:17
epoch [6/50] batch [240/319] time 0.112 (0.107) data 0.000 (0.003) loss 2.1341 (1.8547) ce_loss 1.3975 (1.1939) teacher_loss 1.4383 (1.1117) loss_zs_kd 0.7641 (0.7973) loss_oracle 0.6959 (0.7431) acc 34.3750 (55.2604) kd_loss 0.8704 (0.9041) lr 1.9686e-03 eta 0:25:16
epoch [6/50] batch [260/319] time 0.105 (0.107) data 0.000 (0.002) loss 1.6510 (1.8512) ce_loss 1.0264 (1.1944) teacher_loss 0.8988 (1.1104) loss_zs_kd 0.7988 (0.7923) loss_oracle 0.7522 (0.7408) acc 53.1250 (55.2524) kd_loss 0.9691 (0.9046) lr 1.9686e-03 eta 0:25:11
epoch [6/50] batch [280/319] time 0.081 (0.106) data 0.000 (0.002) loss 1.7494 (1.8495) ce_loss 1.1377 (1.1974) teacher_loss 1.0645 (1.1113) loss_zs_kd 0.7006 (0.7905) loss_oracle 0.6849 (0.7381) acc 53.1250 (55.0446) kd_loss 0.9098 (0.9052) lr 1.9686e-03 eta 0:24:51
epoch [6/50] batch [300/319] time 0.091 (0.106) data 0.000 (0.002) loss 1.7541 (1.8482) ce_loss 1.2588 (1.2021) teacher_loss 1.0006 (1.1099) loss_zs_kd 0.8069 (0.7850) loss_oracle 0.7535 (0.7383) acc 53.1250 (54.7188) kd_loss 0.8985 (0.9035) lr 1.9686e-03 eta 0:24:49
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,702
* accuracy: 61.7%
* error: 38.3%
* macro_f1: 53.1%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,994
* accuracy: 51.3%
* error: 48.7%
* macro_f1: 22.1%
******* Domain 2 best val acc:      61.7%, epoch: 6 *******
******* Domain 2 best val test acc: 51.3%, epoch: 6 *******
******* Domain 2 best test acc:     53.4%, epoch: 3 *******
epoch [7/50] batch [20/319] time 0.104 (0.141) data 0.000 (0.033) loss 1.4942 (1.7880) ce_loss 0.8628 (1.1621) teacher_loss 0.7209 (1.0672) loss_zs_kd 0.7846 (0.7698) loss_oracle 0.7733 (0.7209) acc 68.7500 (59.8438) kd_loss 0.8716 (0.8666) lr 1.9511e-03 eta 0:32:57
epoch [7/50] batch [40/319] time 0.103 (0.122) data 0.000 (0.017) loss 2.1048 (1.8230) ce_loss 1.4170 (1.1912) teacher_loss 1.3597 (1.1057) loss_zs_kd 0.8105 (0.7677) loss_oracle 0.7452 (0.7173) acc 56.2500 (57.5000) kd_loss 0.8692 (0.8628) lr 1.9511e-03 eta 0:28:32
epoch [7/50] batch [60/319] time 0.099 (0.116) data 0.000 (0.011) loss 1.7395 (1.7803) ce_loss 1.1396 (1.1812) teacher_loss 0.9606 (1.0644) loss_zs_kd 0.8591 (0.7812) loss_oracle 0.7788 (0.7160) acc 59.3750 (57.3438) kd_loss 0.8860 (0.8660) lr 1.9511e-03 eta 0:27:01
epoch [7/50] batch [80/319] time 0.109 (0.113) data 0.000 (0.008) loss 1.8021 (1.7782) ce_loss 1.1494 (1.1873) teacher_loss 1.0678 (1.0666) loss_zs_kd 0.7475 (0.7861) loss_oracle 0.7343 (0.7116) acc 53.1250 (56.5234) kd_loss 0.8257 (0.8653) lr 1.9511e-03 eta 0:26:18
epoch [7/50] batch [100/319] time 0.109 (0.111) data 0.000 (0.007) loss 1.8004 (1.7822) ce_loss 1.2324 (1.2037) teacher_loss 1.0699 (1.0714) loss_zs_kd 0.7605 (0.7868) loss_oracle 0.7305 (0.7107) acc 62.5000 (55.3438) kd_loss 0.8643 (0.8695) lr 1.9511e-03 eta 0:25:52
epoch [7/50] batch [120/319] time 0.107 (0.110) data 0.000 (0.006) loss 2.1383 (1.7774) ce_loss 1.4980 (1.2064) teacher_loss 1.4285 (1.0614) loss_zs_kd 0.8192 (0.7945) loss_oracle 0.7098 (0.7160) acc 40.6250 (54.6094) kd_loss 0.8652 (0.8707) lr 1.9511e-03 eta 0:25:33
epoch [7/50] batch [140/319] time 0.114 (0.110) data 0.000 (0.005) loss 1.7475 (1.7810) ce_loss 1.1465 (1.2070) teacher_loss 1.0737 (1.0627) loss_zs_kd 0.7229 (0.7916) loss_oracle 0.6738 (0.7183) acc 50.0000 (54.4643) kd_loss 0.9161 (0.8722) lr 1.9511e-03 eta 0:25:29
epoch [7/50] batch [160/319] time 0.099 (0.109) data 0.000 (0.004) loss 1.6149 (1.7827) ce_loss 0.9932 (1.2055) teacher_loss 0.9341 (1.0678) loss_zs_kd 0.7225 (0.7885) loss_oracle 0.6808 (0.7149) acc 68.7500 (54.3164) kd_loss 0.8660 (0.8752) lr 1.9511e-03 eta 0:25:19
epoch [7/50] batch [180/319] time 0.114 (0.109) data 0.000 (0.004) loss 1.7062 (1.7901) ce_loss 1.2979 (1.2077) teacher_loss 1.0446 (1.0784) loss_zs_kd 0.8733 (0.7953) loss_oracle 0.6616 (0.7117) acc 50.0000 (54.2188) kd_loss 0.9463 (0.8768) lr 1.9511e-03 eta 0:25:06
epoch [7/50] batch [200/319] time 0.102 (0.108) data 0.000 (0.004) loss 2.1897 (1.7872) ce_loss 1.4219 (1.2009) teacher_loss 1.3976 (1.0734) loss_zs_kd 0.9987 (0.7994) loss_oracle 0.7921 (0.7138) acc 46.8750 (54.5938) kd_loss 0.9363 (0.8809) lr 1.9511e-03 eta 0:24:58
epoch [7/50] batch [220/319] time 0.117 (0.108) data 0.000 (0.003) loss 2.0086 (1.7877) ce_loss 1.1172 (1.1966) teacher_loss 1.1962 (1.0656) loss_zs_kd 0.9627 (0.8087) loss_oracle 0.8124 (0.7221) acc 59.3750 (54.8722) kd_loss 0.9192 (0.8842) lr 1.9511e-03 eta 0:24:50
epoch [7/50] batch [240/319] time 0.101 (0.107) data 0.000 (0.003) loss 2.0723 (1.7928) ce_loss 1.2109 (1.1976) teacher_loss 1.3008 (1.0659) loss_zs_kd 0.8685 (0.8207) loss_oracle 0.7715 (0.7269) acc 53.1250 (54.7396) kd_loss 0.8649 (0.8849) lr 1.9511e-03 eta 0:24:33
epoch [7/50] batch [260/319] time 0.096 (0.106) data 0.000 (0.003) loss 1.7128 (1.7968) ce_loss 0.9985 (1.1972) teacher_loss 0.9911 (1.0699) loss_zs_kd 0.7461 (0.8169) loss_oracle 0.7217 (0.7269) acc 68.7500 (54.7476) kd_loss 0.8663 (0.8824) lr 1.9511e-03 eta 0:24:19
epoch [7/50] batch [280/319] time 0.087 (0.104) data 0.000 (0.003) loss 1.7669 (1.7997) ce_loss 1.1064 (1.1963) teacher_loss 0.9861 (1.0720) loss_zs_kd 0.9522 (0.8155) loss_oracle 0.7808 (0.7276) acc 59.3750 (54.9554) kd_loss 0.8414 (0.8795) lr 1.9511e-03 eta 0:23:52
epoch [7/50] batch [300/319] time 0.133 (0.105) data 0.000 (0.002) loss 1.7318 (1.7990) ce_loss 1.2861 (1.1936) teacher_loss 1.0246 (1.0713) loss_zs_kd 0.8720 (0.8128) loss_oracle 0.7072 (0.7277) acc 43.7500 (54.9896) kd_loss 0.8549 (0.8780) lr 1.9511e-03 eta 0:24:00
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,738
* accuracy: 62.5%
* error: 37.5%
* macro_f1: 54.1%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,947
* accuracy: 50.8%
* error: 49.2%
* macro_f1: 21.2%
******* Domain 2 best val acc:      62.5%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     53.4%, epoch: 3 *******
epoch [8/50] batch [20/319] time 0.100 (0.131) data 0.000 (0.026) loss 1.9717 (1.8842) ce_loss 1.3916 (1.2309) teacher_loss 1.1942 (1.1386) loss_zs_kd 0.7658 (0.7232) loss_oracle 0.7775 (0.7456) acc 43.7500 (54.3750) kd_loss 0.9211 (0.8917) lr 1.9298e-03 eta 0:29:48
epoch [8/50] batch [40/319] time 0.109 (0.117) data 0.000 (0.013) loss 1.6456 (1.8546) ce_loss 1.0391 (1.1945) teacher_loss 0.8232 (1.0881) loss_zs_kd 0.8730 (0.7930) loss_oracle 0.8224 (0.7665) acc 53.1250 (55.0000) kd_loss 0.8802 (0.8914) lr 1.9298e-03 eta 0:26:36
epoch [8/50] batch [60/319] time 0.119 (0.113) data 0.000 (0.009) loss 1.7641 (1.8486) ce_loss 1.2354 (1.1900) teacher_loss 1.0489 (1.0774) loss_zs_kd 0.7718 (0.7940) loss_oracle 0.7152 (0.7712) acc 62.5000 (55.1562) kd_loss 0.8653 (0.8885) lr 1.9298e-03 eta 0:25:40
epoch [8/50] batch [80/319] time 0.099 (0.111) data 0.000 (0.007) loss 1.8273 (1.8290) ce_loss 1.1807 (1.1791) teacher_loss 1.0532 (1.0645) loss_zs_kd 0.6618 (0.7801) loss_oracle 0.7741 (0.7645) acc 43.7500 (54.9609) kd_loss 0.8530 (0.8813) lr 1.9298e-03 eta 0:25:09
epoch [8/50] batch [100/319] time 0.110 (0.110) data 0.000 (0.005) loss 1.7222 (1.8359) ce_loss 0.9766 (1.1821) teacher_loss 0.9066 (1.0755) loss_zs_kd 0.8122 (0.7800) loss_oracle 0.8155 (0.7604) acc 65.6250 (54.8750) kd_loss 0.8338 (0.8724) lr 1.9298e-03 eta 0:24:52
epoch [8/50] batch [120/319] time 0.100 (0.109) data 0.000 (0.005) loss 2.0228 (1.8307) ce_loss 1.3066 (1.1709) teacher_loss 1.2938 (1.0714) loss_zs_kd 0.9034 (0.7789) loss_oracle 0.7290 (0.7594) acc 62.5000 (55.5208) kd_loss 0.8506 (0.8696) lr 1.9298e-03 eta 0:24:39
epoch [8/50] batch [140/319] time 0.098 (0.108) data 0.000 (0.004) loss 1.8635 (1.8383) ce_loss 1.0879 (1.1717) teacher_loss 1.1233 (1.0807) loss_zs_kd 0.9831 (0.7739) loss_oracle 0.7402 (0.7576) acc 59.3750 (55.6250) kd_loss 0.8317 (0.8643) lr 1.9298e-03 eta 0:24:28
epoch [8/50] batch [160/319] time 0.105 (0.108) data 0.000 (0.003) loss 1.9388 (1.8377) ce_loss 1.2549 (1.1731) teacher_loss 1.1670 (1.0841) loss_zs_kd 0.6883 (0.7736) loss_oracle 0.7718 (0.7536) acc 56.2500 (55.7031) kd_loss 0.9055 (0.8580) lr 1.9298e-03 eta 0:24:20
epoch [8/50] batch [180/319] time 0.096 (0.107) data 0.000 (0.003) loss 2.0026 (1.8348) ce_loss 1.2842 (1.1744) teacher_loss 1.3403 (1.0853) loss_zs_kd 0.7406 (0.7835) loss_oracle 0.6623 (0.7495) acc 50.0000 (55.8681) kd_loss 0.7419 (0.8540) lr 1.9298e-03 eta 0:24:12
epoch [8/50] batch [200/319] time 0.111 (0.107) data 0.000 (0.003) loss 1.7579 (1.8267) ce_loss 1.1768 (1.1705) teacher_loss 1.0084 (1.0808) loss_zs_kd 1.0248 (0.7896) loss_oracle 0.7495 (0.7459) acc 53.1250 (55.8438) kd_loss 0.7970 (0.8524) lr 1.9298e-03 eta 0:24:05
epoch [8/50] batch [220/319] time 0.107 (0.105) data 0.000 (0.003) loss 1.5744 (1.8234) ce_loss 0.9077 (1.1707) teacher_loss 0.8761 (1.0778) loss_zs_kd 0.8812 (0.7929) loss_oracle 0.6983 (0.7455) acc 62.5000 (55.7670) kd_loss 0.8486 (0.8527) lr 1.9298e-03 eta 0:23:36
epoch [8/50] batch [240/319] time 0.109 (0.105) data 0.000 (0.002) loss 2.1676 (1.8142) ce_loss 1.3916 (1.1689) teacher_loss 1.4073 (1.0696) loss_zs_kd 0.8195 (0.7970) loss_oracle 0.7603 (0.7446) acc 53.1250 (55.7943) kd_loss 0.8464 (0.8516) lr 1.9298e-03 eta 0:23:32
epoch [8/50] batch [260/319] time 0.091 (0.104) data 0.000 (0.002) loss 2.0170 (1.8107) ce_loss 1.4609 (1.1688) teacher_loss 1.3033 (1.0660) loss_zs_kd 0.8667 (0.8012) loss_oracle 0.7138 (0.7447) acc 43.7500 (55.7572) kd_loss 0.8556 (0.8508) lr 1.9298e-03 eta 0:23:24
epoch [8/50] batch [280/319] time 0.169 (0.104) data 0.000 (0.002) loss 2.0236 (1.8057) ce_loss 1.2646 (1.1663) teacher_loss 1.3489 (1.0611) loss_zs_kd 0.7603 (0.8024) loss_oracle 0.6747 (0.7446) acc 43.7500 (55.5915) kd_loss 0.8402 (0.8505) lr 1.9298e-03 eta 0:23:10
epoch [8/50] batch [300/319] time 0.158 (0.104) data 0.000 (0.002) loss 2.0652 (1.8104) ce_loss 1.4873 (1.1706) teacher_loss 1.3162 (1.0673) loss_zs_kd 0.7211 (0.8050) loss_oracle 0.7489 (0.7431) acc 50.0000 (55.5104) kd_loss 0.8509 (0.8506) lr 1.9298e-03 eta 0:23:15
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,508
* accuracy: 57.3%
* error: 42.7%
* macro_f1: 50.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,341
* accuracy: 54.9%
* error: 45.1%
* macro_f1: 21.5%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      62.5%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     54.9%, epoch: 8 *******
epoch [9/50] batch [20/319] time 0.102 (0.136) data 0.000 (0.029) loss 1.6026 (1.6967) ce_loss 1.0469 (1.1324) teacher_loss 0.8763 (0.9659) loss_zs_kd 0.9097 (0.9453) loss_oracle 0.7263 (0.7308) acc 56.2500 (55.4688) kd_loss 0.8594 (0.8631) lr 1.9048e-03 eta 0:30:13
epoch [9/50] batch [40/319] time 0.091 (0.119) data 0.000 (0.015) loss 1.6504 (1.7189) ce_loss 1.1328 (1.1085) teacher_loss 0.9000 (0.9780) loss_zs_kd 0.9440 (0.9358) loss_oracle 0.7504 (0.7409) acc 56.2500 (58.1250) kd_loss 0.8361 (0.8588) lr 1.9048e-03 eta 0:26:26
epoch [9/50] batch [60/319] time 0.115 (0.114) data 0.000 (0.010) loss 1.9274 (1.7531) ce_loss 1.2959 (1.1297) teacher_loss 1.1586 (1.0100) loss_zs_kd 0.8408 (0.9055) loss_oracle 0.7687 (0.7431) acc 46.8750 (56.9792) kd_loss 0.8609 (0.8560) lr 1.9048e-03 eta 0:25:21
epoch [9/50] batch [80/319] time 0.098 (0.112) data 0.000 (0.008) loss 1.8272 (1.7689) ce_loss 1.2061 (1.1476) teacher_loss 1.0777 (1.0232) loss_zs_kd 0.8345 (0.9094) loss_oracle 0.7495 (0.7458) acc 56.2500 (56.3281) kd_loss 0.8571 (0.8509) lr 1.9048e-03 eta 0:24:49
epoch [9/50] batch [100/319] time 0.098 (0.110) data 0.000 (0.006) loss 1.8800 (1.7751) ce_loss 1.2725 (1.1493) teacher_loss 1.1636 (1.0291) loss_zs_kd 0.6662 (0.8808) loss_oracle 0.7164 (0.7461) acc 50.0000 (56.5938) kd_loss 0.7852 (0.8465) lr 1.9048e-03 eta 0:24:27
epoch [9/50] batch [120/319] time 0.102 (0.109) data 0.000 (0.005) loss 1.7701 (1.7850) ce_loss 1.1934 (1.1597) teacher_loss 1.0511 (1.0432) loss_zs_kd 0.6312 (0.8549) loss_oracle 0.7190 (0.7418) acc 56.2500 (56.2760) kd_loss 0.8476 (0.8399) lr 1.9048e-03 eta 0:24:11
epoch [9/50] batch [140/319] time 0.105 (0.109) data 0.000 (0.004) loss 2.2623 (1.7963) ce_loss 1.4824 (1.1641) teacher_loss 1.5493 (1.0592) loss_zs_kd 0.7318 (0.8397) loss_oracle 0.7130 (0.7371) acc 37.5000 (55.7366) kd_loss 0.8374 (0.8344) lr 1.9048e-03 eta 0:23:59
epoch [9/50] batch [160/319] time 0.112 (0.108) data 0.000 (0.004) loss 1.8123 (1.7912) ce_loss 1.1406 (1.1568) teacher_loss 1.0582 (1.0553) loss_zs_kd 0.8212 (0.8329) loss_oracle 0.7541 (0.7359) acc 56.2500 (56.1914) kd_loss 0.8573 (0.8333) lr 1.9048e-03 eta 0:23:52
epoch [9/50] batch [180/319] time 0.113 (0.108) data 0.000 (0.003) loss 1.5465 (1.7809) ce_loss 1.1318 (1.1499) teacher_loss 0.7908 (1.0454) loss_zs_kd 0.9951 (0.8379) loss_oracle 0.7557 (0.7355) acc 59.3750 (56.4236) kd_loss 0.8255 (0.8333) lr 1.9048e-03 eta 0:23:46
epoch [9/50] batch [200/319] time 0.110 (0.108) data 0.000 (0.003) loss 1.6375 (1.7791) ce_loss 1.0928 (1.1514) teacher_loss 0.9317 (1.0441) loss_zs_kd 0.8174 (0.8459) loss_oracle 0.7058 (0.7350) acc 59.3750 (56.4844) kd_loss 0.8375 (0.8334) lr 1.9048e-03 eta 0:23:39
epoch [9/50] batch [220/319] time 0.104 (0.107) data 0.000 (0.003) loss 1.6089 (1.7737) ce_loss 1.1953 (1.1505) teacher_loss 0.8207 (1.0369) loss_zs_kd 0.8386 (0.8470) loss_oracle 0.7882 (0.7368) acc 37.5000 (56.3210) kd_loss 0.8805 (0.8345) lr 1.9048e-03 eta 0:23:31
epoch [9/50] batch [240/319] time 0.107 (0.107) data 0.000 (0.003) loss 1.8751 (1.7776) ce_loss 1.4326 (1.1542) teacher_loss 1.0927 (1.0388) loss_zs_kd 1.1154 (0.8542) loss_oracle 0.7824 (0.7388) acc 43.7500 (56.2109) kd_loss 0.8382 (0.8355) lr 1.9048e-03 eta 0:23:26
epoch [9/50] batch [260/319] time 0.086 (0.106) data 0.000 (0.002) loss 1.7527 (1.7764) ce_loss 1.1504 (1.1560) teacher_loss 1.0616 (1.0387) loss_zs_kd 0.8300 (0.8617) loss_oracle 0.6911 (0.7377) acc 53.1250 (56.0096) kd_loss 0.8526 (0.8367) lr 1.9048e-03 eta 0:23:14
epoch [9/50] batch [280/319] time 0.172 (0.105) data 0.000 (0.002) loss 1.7401 (1.7834) ce_loss 1.0723 (1.1633) teacher_loss 0.9525 (1.0454) loss_zs_kd 1.0350 (0.8664) loss_oracle 0.7875 (0.7380) acc 65.6250 (55.8147) kd_loss 0.8619 (0.8373) lr 1.9048e-03 eta 0:22:56
epoch [9/50] batch [300/319] time 0.070 (0.105) data 0.000 (0.002) loss 1.8684 (1.7832) ce_loss 1.3164 (1.1634) teacher_loss 1.1391 (1.0451) loss_zs_kd 0.8319 (0.8683) loss_oracle 0.7293 (0.7380) acc 56.2500 (55.8333) kd_loss 0.8015 (0.8376) lr 1.9048e-03 eta 0:22:52
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,686
* accuracy: 61.4%
* error: 38.6%
* macro_f1: 51.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,474
* accuracy: 56.2%
* error: 43.8%
* macro_f1: 21.7%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      62.5%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.2%, epoch: 9 *******
epoch [10/50] batch [20/319] time 0.110 (0.134) data 0.000 (0.031) loss 1.9407 (1.8253) ce_loss 1.3398 (1.1979) teacher_loss 1.2424 (1.1096) loss_zs_kd 0.7892 (0.7713) loss_oracle 0.6983 (0.7157) acc 43.7500 (53.5938) kd_loss 0.7873 (0.8338) lr 1.8763e-03 eta 0:29:07
epoch [10/50] batch [40/319] time 0.100 (0.119) data 0.000 (0.016) loss 1.9493 (1.8130) ce_loss 1.1797 (1.1743) teacher_loss 1.2012 (1.0988) loss_zs_kd 0.6572 (0.7355) loss_oracle 0.7481 (0.7142) acc 59.3750 (54.4531) kd_loss 0.8551 (0.8370) lr 1.8763e-03 eta 0:25:54
epoch [10/50] batch [60/319] time 0.101 (0.114) data 0.001 (0.011) loss 2.0975 (1.8034) ce_loss 1.3887 (1.1608) teacher_loss 1.3976 (1.0868) loss_zs_kd 0.6413 (0.7128) loss_oracle 0.7000 (0.7166) acc 43.7500 (54.9479) kd_loss 0.7728 (0.8331) lr 1.8763e-03 eta 0:24:45
epoch [10/50] batch [80/319] time 0.108 (0.112) data 0.000 (0.008) loss 1.5729 (1.8107) ce_loss 0.9375 (1.1649) teacher_loss 0.7960 (1.0909) loss_zs_kd 0.6324 (0.6958) loss_oracle 0.7770 (0.7198) acc 68.7500 (54.9609) kd_loss 0.7655 (0.8257) lr 1.8763e-03 eta 0:24:13
epoch [10/50] batch [100/319] time 0.100 (0.110) data 0.000 (0.006) loss 1.6080 (1.8224) ce_loss 0.9277 (1.1724) teacher_loss 0.8475 (1.1019) loss_zs_kd 0.5477 (0.6901) loss_oracle 0.7605 (0.7205) acc 71.8750 (54.8125) kd_loss 0.8219 (0.8220) lr 1.8763e-03 eta 0:23:49
epoch [10/50] batch [120/319] time 0.111 (0.109) data 0.000 (0.005) loss 1.8289 (1.8216) ce_loss 1.1533 (1.1685) teacher_loss 1.0824 (1.0988) loss_zs_kd 0.6524 (0.6868) loss_oracle 0.7464 (0.7228) acc 56.2500 (55.1042) kd_loss 0.8373 (0.8201) lr 1.8763e-03 eta 0:23:34
epoch [10/50] batch [140/319] time 0.102 (0.108) data 0.000 (0.005) loss 1.7777 (1.8122) ce_loss 1.1484 (1.1606) teacher_loss 1.0332 (1.0883) loss_zs_kd 0.6274 (0.6842) loss_oracle 0.7444 (0.7239) acc 43.7500 (55.3348) kd_loss 0.7581 (0.8175) lr 1.8763e-03 eta 0:23:22
epoch [10/50] batch [160/319] time 0.106 (0.108) data 0.000 (0.004) loss 1.8031 (1.8079) ce_loss 1.1572 (1.1546) teacher_loss 1.0955 (1.0844) loss_zs_kd 0.8477 (0.6881) loss_oracle 0.7076 (0.7235) acc 50.0000 (56.0156) kd_loss 0.7681 (0.8173) lr 1.8763e-03 eta 0:23:13
epoch [10/50] batch [180/319] time 0.104 (0.107) data 0.000 (0.004) loss 1.8871 (1.8167) ce_loss 1.1836 (1.1605) teacher_loss 1.1080 (1.0921) loss_zs_kd 0.5626 (0.6946) loss_oracle 0.7791 (0.7246) acc 62.5000 (56.0590) kd_loss 0.8052 (0.8179) lr 1.8763e-03 eta 0:22:56
epoch [10/50] batch [200/319] time 0.108 (0.107) data 0.000 (0.003) loss 1.5199 (1.8151) ce_loss 0.8311 (1.1591) teacher_loss 0.8089 (1.0914) loss_zs_kd 0.6309 (0.6872) loss_oracle 0.7110 (0.7237) acc 71.8750 (56.0469) kd_loss 0.7986 (0.8169) lr 1.8763e-03 eta 0:22:52
epoch [10/50] batch [220/319] time 0.098 (0.106) data 0.000 (0.003) loss 1.5516 (1.8101) ce_loss 0.9883 (1.1590) teacher_loss 0.8452 (1.0884) loss_zs_kd 0.7725 (0.6926) loss_oracle 0.7064 (0.7217) acc 59.3750 (56.2784) kd_loss 0.8387 (0.8192) lr 1.8763e-03 eta 0:22:48
epoch [10/50] batch [240/319] time 0.109 (0.106) data 0.000 (0.003) loss 1.8514 (1.8101) ce_loss 1.0664 (1.1621) teacher_loss 1.1483 (1.0901) loss_zs_kd 0.8743 (0.7043) loss_oracle 0.7031 (0.7200) acc 62.5000 (56.1458) kd_loss 0.8383 (0.8207) lr 1.8763e-03 eta 0:22:44
epoch [10/50] batch [260/319] time 0.103 (0.106) data 0.000 (0.003) loss 1.8304 (1.8066) ce_loss 1.1045 (1.1636) teacher_loss 1.0875 (1.0862) loss_zs_kd 1.0108 (0.7140) loss_oracle 0.7429 (0.7204) acc 59.3750 (56.0457) kd_loss 0.8551 (0.8212) lr 1.8763e-03 eta 0:22:40
epoch [10/50] batch [280/319] time 0.111 (0.106) data 0.000 (0.002) loss 1.7446 (1.7985) ce_loss 1.1055 (1.1587) teacher_loss 0.9977 (1.0780) loss_zs_kd 0.8689 (0.7262) loss_oracle 0.7469 (0.7204) acc 53.1250 (56.0826) kd_loss 0.7853 (0.8220) lr 1.8763e-03 eta 0:22:35
epoch [10/50] batch [300/319] time 0.082 (0.104) data 0.000 (0.002) loss 1.8307 (1.7981) ce_loss 1.1943 (1.1582) teacher_loss 1.0569 (1.0768) loss_zs_kd 0.7962 (0.7339) loss_oracle 0.7738 (0.7213) acc 56.2500 (56.0312) kd_loss 0.7827 (0.8218) lr 1.8763e-03 eta 0:22:12
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,651
* accuracy: 60.6%
* error: 39.4%
* macro_f1: 52.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,298
* accuracy: 54.4%
* error: 45.6%
* macro_f1: 21.2%
******* Domain 2 best val acc:      62.5%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.2%, epoch: 9 *******
epoch [11/50] batch [20/319] time 0.111 (0.129) data 0.000 (0.025) loss 1.6971 (1.6775) ce_loss 1.0928 (1.1027) teacher_loss 0.9503 (0.9485) loss_zs_kd 0.7923 (0.7705) loss_oracle 0.7468 (0.7290) acc 53.1250 (57.0312) kd_loss 0.8619 (0.8233) lr 1.8443e-03 eta 0:27:27
epoch [11/50] batch [40/319] time 0.103 (0.115) data 0.000 (0.013) loss 1.5490 (1.7075) ce_loss 0.9873 (1.1107) teacher_loss 0.7890 (0.9675) loss_zs_kd 0.8103 (0.8239) loss_oracle 0.7600 (0.7400) acc 59.3750 (56.4062) kd_loss 0.8503 (0.8292) lr 1.8443e-03 eta 0:24:17
epoch [11/50] batch [60/319] time 0.097 (0.109) data 0.001 (0.009) loss 1.9089 (1.7161) ce_loss 1.2051 (1.1235) teacher_loss 1.1454 (0.9704) loss_zs_kd 1.0204 (0.8359) loss_oracle 0.7635 (0.7457) acc 53.1250 (56.4062) kd_loss 0.8781 (0.8317) lr 1.8443e-03 eta 0:23:07
epoch [11/50] batch [80/319] time 0.097 (0.107) data 0.000 (0.007) loss 2.0433 (1.7244) ce_loss 1.3525 (1.1305) teacher_loss 1.2638 (0.9717) loss_zs_kd 1.0546 (0.8498) loss_oracle 0.7796 (0.7527) acc 53.1250 (56.8359) kd_loss 0.8098 (0.8340) lr 1.8443e-03 eta 0:22:39
epoch [11/50] batch [100/319] time 0.097 (0.104) data 0.000 (0.005) loss 1.7472 (1.7359) ce_loss 1.1279 (1.1437) teacher_loss 0.9851 (0.9796) loss_zs_kd 0.8260 (0.8621) loss_oracle 0.7620 (0.7563) acc 59.3750 (56.4375) kd_loss 0.8635 (0.8355) lr 1.8443e-03 eta 0:21:57
epoch [11/50] batch [120/319] time 0.096 (0.104) data 0.000 (0.004) loss 1.7677 (1.7417) ce_loss 1.0664 (1.1489) teacher_loss 0.9936 (0.9839) loss_zs_kd 0.8787 (0.8684) loss_oracle 0.7741 (0.7578) acc 59.3750 (55.9115) kd_loss 0.7979 (0.8348) lr 1.8443e-03 eta 0:21:53
epoch [11/50] batch [140/319] time 0.099 (0.102) data 0.000 (0.004) loss 2.0998 (1.7389) ce_loss 1.3828 (1.1490) teacher_loss 1.3143 (0.9807) loss_zs_kd 1.0507 (0.8681) loss_oracle 0.7855 (0.7582) acc 43.7500 (56.3616) kd_loss 0.8502 (0.8330) lr 1.8443e-03 eta 0:21:31
epoch [11/50] batch [160/319] time 0.105 (0.102) data 0.000 (0.003) loss 1.4005 (1.7461) ce_loss 0.8003 (1.1544) teacher_loss 0.6819 (0.9886) loss_zs_kd 0.6796 (0.8603) loss_oracle 0.7186 (0.7574) acc 65.6250 (56.0156) kd_loss 0.8033 (0.8305) lr 1.8443e-03 eta 0:21:28
epoch [11/50] batch [180/319] time 0.112 (0.102) data 0.000 (0.003) loss 1.7212 (1.7482) ce_loss 1.2041 (1.1555) teacher_loss 1.0414 (0.9923) loss_zs_kd 0.5964 (0.8393) loss_oracle 0.6799 (0.7560) acc 50.0000 (55.8507) kd_loss 0.7972 (0.8299) lr 1.8443e-03 eta 0:21:28
epoch [11/50] batch [200/319] time 0.100 (0.102) data 0.000 (0.003) loss 1.6685 (1.7450) ce_loss 1.1484 (1.1539) teacher_loss 0.9131 (0.9901) loss_zs_kd 0.7492 (0.8274) loss_oracle 0.7553 (0.7550) acc 62.5000 (55.9531) kd_loss 0.8655 (0.8304) lr 1.8443e-03 eta 0:21:22
epoch [11/50] batch [220/319] time 0.098 (0.102) data 0.000 (0.003) loss 1.8699 (1.7426) ce_loss 1.3232 (1.1509) teacher_loss 1.1399 (0.9890) loss_zs_kd 0.6470 (0.8120) loss_oracle 0.7300 (0.7536) acc 50.0000 (56.0938) kd_loss 0.8297 (0.8288) lr 1.8443e-03 eta 0:21:13
epoch [11/50] batch [240/319] time 0.090 (0.101) data 0.000 (0.002) loss 1.7042 (1.7389) ce_loss 1.0869 (1.1442) teacher_loss 0.9770 (0.9863) loss_zs_kd 0.5776 (0.7980) loss_oracle 0.7272 (0.7527) acc 65.6250 (56.3932) kd_loss 0.7563 (0.8266) lr 1.8443e-03 eta 0:21:03
epoch [11/50] batch [260/319] time 0.084 (0.100) data 0.000 (0.002) loss 1.4416 (1.7389) ce_loss 1.1416 (1.1454) teacher_loss 0.7060 (0.9868) loss_zs_kd 0.8514 (0.7925) loss_oracle 0.7355 (0.7521) acc 43.7500 (56.1538) kd_loss 0.8286 (0.8257) lr 1.8443e-03 eta 0:20:51
epoch [11/50] batch [280/319] time 0.090 (0.099) data 0.000 (0.002) loss 1.8908 (1.7354) ce_loss 1.3389 (1.1420) teacher_loss 1.1105 (0.9844) loss_zs_kd 0.6785 (0.7871) loss_oracle 0.7803 (0.7510) acc 46.8750 (56.3058) kd_loss 0.8597 (0.8261) lr 1.8443e-03 eta 0:20:41
epoch [11/50] batch [300/319] time 0.071 (0.099) data 0.000 (0.002) loss 2.3296 (1.7391) ce_loss 1.7031 (1.1472) teacher_loss 1.5257 (0.9881) loss_zs_kd 0.7739 (0.7847) loss_oracle 0.8039 (0.7510) acc 43.7500 (56.0521) kd_loss 0.8296 (0.8266) lr 1.8443e-03 eta 0:20:27
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,611
* accuracy: 59.6%
* error: 40.4%
* macro_f1: 51.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,353
* accuracy: 55.0%
* error: 45.0%
* macro_f1: 22.0%
******* Domain 2 best val acc:      62.5%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.2%, epoch: 9 *******
epoch [12/50] batch [20/319] time 0.097 (0.131) data 0.000 (0.027) loss 1.6589 (1.7363) ce_loss 1.0693 (1.1570) teacher_loss 0.9339 (0.9864) loss_zs_kd 0.6423 (0.8288) loss_oracle 0.7249 (0.7499) acc 59.3750 (54.8438) kd_loss 0.8709 (0.8359) lr 1.8090e-03 eta 0:27:05
epoch [12/50] batch [40/319] time 0.099 (0.118) data 0.000 (0.014) loss 1.4124 (1.7386) ce_loss 0.9243 (1.1689) teacher_loss 0.6798 (0.9892) loss_zs_kd 0.6882 (0.7410) loss_oracle 0.7326 (0.7494) acc 62.5000 (53.5156) kd_loss 0.8261 (0.8315) lr 1.8090e-03 eta 0:24:24
epoch [12/50] batch [60/319] time 0.104 (0.113) data 0.001 (0.009) loss 1.9089 (1.7703) ce_loss 1.3584 (1.1832) teacher_loss 1.1555 (1.0216) loss_zs_kd 0.5603 (0.7273) loss_oracle 0.7534 (0.7486) acc 50.0000 (53.4375) kd_loss 0.8355 (0.8236) lr 1.8090e-03 eta 0:23:22
epoch [12/50] batch [80/319] time 0.106 (0.111) data 0.000 (0.007) loss 1.7083 (1.7633) ce_loss 0.9756 (1.1728) teacher_loss 0.8964 (1.0162) loss_zs_kd 0.5676 (0.7128) loss_oracle 0.8119 (0.7471) acc 65.6250 (54.0234) kd_loss 0.8523 (0.8218) lr 1.8090e-03 eta 0:22:55
epoch [12/50] batch [100/319] time 0.104 (0.110) data 0.000 (0.006) loss 1.6669 (1.7727) ce_loss 1.2539 (1.1883) teacher_loss 0.8993 (1.0249) loss_zs_kd 0.7097 (0.6977) loss_oracle 0.7676 (0.7478) acc 53.1250 (53.6875) kd_loss 0.8368 (0.8196) lr 1.8090e-03 eta 0:22:36
epoch [12/50] batch [120/319] time 0.090 (0.109) data 0.000 (0.005) loss 1.7423 (1.7755) ce_loss 1.2656 (1.1906) teacher_loss 1.0198 (1.0300) loss_zs_kd 0.7039 (0.6953) loss_oracle 0.7225 (0.7454) acc 50.0000 (54.0104) kd_loss 0.7976 (0.8201) lr 1.8090e-03 eta 0:22:22
epoch [12/50] batch [140/319] time 0.104 (0.108) data 0.000 (0.004) loss 1.9577 (1.7655) ce_loss 1.2266 (1.1759) teacher_loss 1.2394 (1.0243) loss_zs_kd 0.8678 (0.7096) loss_oracle 0.7183 (0.7412) acc 62.5000 (55.0000) kd_loss 0.8745 (0.8203) lr 1.8090e-03 eta 0:22:03
epoch [12/50] batch [160/319] time 0.102 (0.107) data 0.000 (0.004) loss 1.7731 (1.7596) ce_loss 1.2500 (1.1701) teacher_loss 1.1010 (1.0242) loss_zs_kd 0.8324 (0.7173) loss_oracle 0.6721 (0.7354) acc 46.8750 (55.3906) kd_loss 0.8214 (0.8225) lr 1.8090e-03 eta 0:21:56
epoch [12/50] batch [180/319] time 0.116 (0.107) data 0.000 (0.003) loss 1.6161 (1.7544) ce_loss 1.0801 (1.1678) teacher_loss 0.9529 (1.0245) loss_zs_kd 0.7626 (0.7276) loss_oracle 0.6632 (0.7300) acc 59.3750 (55.7118) kd_loss 0.8285 (0.8236) lr 1.8090e-03 eta 0:21:51
epoch [12/50] batch [200/319] time 0.100 (0.107) data 0.000 (0.003) loss 1.8311 (1.7520) ce_loss 1.1758 (1.1628) teacher_loss 1.1275 (1.0234) loss_zs_kd 0.8056 (0.7341) loss_oracle 0.7036 (0.7285) acc 40.6250 (55.7812) kd_loss 0.8355 (0.8256) lr 1.8090e-03 eta 0:21:47
epoch [12/50] batch [220/319] time 0.114 (0.107) data 0.000 (0.003) loss 1.5343 (1.7447) ce_loss 0.9580 (1.1583) teacher_loss 0.8301 (1.0176) loss_zs_kd 0.7382 (0.7536) loss_oracle 0.7042 (0.7270) acc 56.2500 (55.9801) kd_loss 0.8263 (0.8259) lr 1.8090e-03 eta 0:21:41
epoch [12/50] batch [240/319] time 0.101 (0.106) data 0.000 (0.003) loss 1.5204 (1.7418) ce_loss 1.0781 (1.1550) teacher_loss 0.8459 (1.0156) loss_zs_kd 0.8934 (0.7570) loss_oracle 0.6745 (0.7262) acc 59.3750 (56.1589) kd_loss 0.8818 (0.8257) lr 1.8090e-03 eta 0:21:36
epoch [12/50] batch [260/319] time 0.109 (0.107) data 0.000 (0.002) loss 1.6504 (1.7383) ce_loss 1.0596 (1.1486) teacher_loss 0.8892 (1.0127) loss_zs_kd 0.6145 (0.7521) loss_oracle 0.7611 (0.7256) acc 62.5000 (56.4663) kd_loss 0.8093 (0.8256) lr 1.8090e-03 eta 0:21:37
epoch [12/50] batch [280/319] time 0.102 (0.106) data 0.000 (0.002) loss 1.4735 (1.7387) ce_loss 0.9102 (1.1466) teacher_loss 0.7786 (1.0131) loss_zs_kd 0.6244 (0.7460) loss_oracle 0.6949 (0.7256) acc 59.3750 (56.4397) kd_loss 0.8119 (0.8258) lr 1.8090e-03 eta 0:21:31
epoch [12/50] batch [300/319] time 0.080 (0.105) data 0.000 (0.002) loss 1.8289 (1.7364) ce_loss 1.2275 (1.1417) teacher_loss 1.0865 (1.0107) loss_zs_kd 0.6595 (0.7453) loss_oracle 0.7424 (0.7257) acc 53.1250 (56.5625) kd_loss 0.8646 (0.8256) lr 1.8090e-03 eta 0:21:15
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,667
* accuracy: 60.9%
* error: 39.1%
* macro_f1: 53.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,272
* accuracy: 54.1%
* error: 45.9%
* macro_f1: 21.8%
******* Domain 2 best val acc:      62.5%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.2%, epoch: 9 *******
epoch [13/50] batch [20/319] time 0.116 (0.138) data 0.000 (0.030) loss 1.7227 (1.7749) ce_loss 1.1357 (1.1925) teacher_loss 0.9949 (1.0572) loss_zs_kd 0.9378 (0.8225) loss_oracle 0.7277 (0.7176) acc 53.1250 (55.4688) kd_loss 0.8254 (0.8143) lr 1.7705e-03 eta 0:27:51
epoch [13/50] batch [40/319] time 0.105 (0.119) data 0.000 (0.015) loss 2.0839 (1.7270) ce_loss 1.4541 (1.1178) teacher_loss 1.3430 (1.0134) loss_zs_kd 0.8605 (0.8177) loss_oracle 0.7409 (0.7136) acc 50.0000 (57.8125) kd_loss 0.8514 (0.8176) lr 1.7705e-03 eta 0:23:55
epoch [13/50] batch [60/319] time 0.106 (0.114) data 0.000 (0.010) loss 2.2281 (1.7493) ce_loss 1.5635 (1.1345) teacher_loss 1.5708 (1.0379) loss_zs_kd 0.7915 (0.8129) loss_oracle 0.6573 (0.7114) acc 46.8750 (57.6042) kd_loss 0.8250 (0.8207) lr 1.7705e-03 eta 0:22:54
epoch [13/50] batch [80/319] time 0.092 (0.109) data 0.000 (0.008) loss 1.4495 (1.7551) ce_loss 0.8711 (1.1431) teacher_loss 0.7881 (1.0553) loss_zs_kd 0.6233 (0.7878) loss_oracle 0.6614 (0.6998) acc 59.3750 (56.7578) kd_loss 0.8335 (0.8259) lr 1.7705e-03 eta 0:21:55
epoch [13/50] batch [100/319] time 0.106 (0.107) data 0.000 (0.006) loss 1.7256 (1.7477) ce_loss 1.2275 (1.1416) teacher_loss 1.1000 (1.0495) loss_zs_kd 0.7854 (0.7870) loss_oracle 0.6256 (0.6981) acc 46.8750 (56.2812) kd_loss 0.8343 (0.8279) lr 1.7705e-03 eta 0:21:23
epoch [13/50] batch [120/319] time 0.105 (0.107) data 0.000 (0.005) loss 1.7479 (1.7407) ce_loss 1.1484 (1.1347) teacher_loss 1.0333 (1.0415) loss_zs_kd 0.7140 (0.7925) loss_oracle 0.7146 (0.6992) acc 50.0000 (56.5104) kd_loss 0.8571 (0.8278) lr 1.7705e-03 eta 0:21:22
epoch [13/50] batch [140/319] time 0.124 (0.107) data 0.000 (0.004) loss 1.9840 (1.7421) ce_loss 1.3457 (1.1344) teacher_loss 1.2889 (1.0394) loss_zs_kd 0.7955 (0.7883) loss_oracle 0.6951 (0.7028) acc 56.2500 (56.7188) kd_loss 0.8530 (0.8269) lr 1.7705e-03 eta 0:21:21
epoch [13/50] batch [160/319] time 0.110 (0.107) data 0.000 (0.004) loss 1.7765 (1.7353) ce_loss 1.2002 (1.1317) teacher_loss 1.0862 (1.0300) loss_zs_kd 0.9163 (0.7885) loss_oracle 0.6903 (0.7052) acc 53.1250 (56.5820) kd_loss 0.8321 (0.8260) lr 1.7705e-03 eta 0:21:16
epoch [13/50] batch [180/319] time 0.102 (0.106) data 0.001 (0.004) loss 1.7191 (1.7369) ce_loss 1.0342 (1.1369) teacher_loss 0.9516 (1.0267) loss_zs_kd 0.8975 (0.8002) loss_oracle 0.7675 (0.7102) acc 68.7500 (56.5799) kd_loss 0.7993 (0.8255) lr 1.7705e-03 eta 0:21:00
epoch [13/50] batch [200/319] time 0.110 (0.105) data 0.000 (0.003) loss 1.8007 (1.7367) ce_loss 1.2539 (1.1423) teacher_loss 1.0653 (1.0234) loss_zs_kd 0.7812 (0.8040) loss_oracle 0.7354 (0.7133) acc 53.1250 (56.4844) kd_loss 0.8138 (0.8247) lr 1.7705e-03 eta 0:20:54
epoch [13/50] batch [220/319] time 0.095 (0.105) data 0.000 (0.003) loss 1.7862 (1.7301) ce_loss 1.2559 (1.1425) teacher_loss 0.9979 (1.0127) loss_zs_kd 1.0023 (0.8080) loss_oracle 0.7883 (0.7174) acc 50.0000 (56.3636) kd_loss 0.8247 (0.8245) lr 1.7705e-03 eta 0:20:49
epoch [13/50] batch [240/319] time 0.094 (0.105) data 0.000 (0.003) loss 1.5551 (1.7260) ce_loss 0.9058 (1.1437) teacher_loss 0.7954 (1.0067) loss_zs_kd 0.9835 (0.8170) loss_oracle 0.7597 (0.7193) acc 71.8750 (56.3281) kd_loss 0.8672 (0.8250) lr 1.7705e-03 eta 0:20:46
epoch [13/50] batch [260/319] time 0.103 (0.104) data 0.000 (0.003) loss 1.7755 (1.7217) ce_loss 1.2031 (1.1475) teacher_loss 0.9679 (0.9986) loss_zs_kd 0.8991 (0.8280) loss_oracle 0.8076 (0.7231) acc 53.1250 (56.2260) kd_loss 0.8577 (0.8263) lr 1.7705e-03 eta 0:20:38
epoch [13/50] batch [280/319] time 0.098 (0.103) data 0.000 (0.002) loss 1.6800 (1.7184) ce_loss 1.0918 (1.1482) teacher_loss 0.8920 (0.9927) loss_zs_kd 0.9367 (0.8283) loss_oracle 0.7880 (0.7257) acc 65.6250 (56.1161) kd_loss 0.8260 (0.8277) lr 1.7705e-03 eta 0:20:20
epoch [13/50] batch [300/319] time 0.071 (0.103) data 0.000 (0.002) loss 1.7505 (1.7151) ce_loss 1.1650 (1.1464) teacher_loss 0.9966 (0.9875) loss_zs_kd 0.7865 (0.8271) loss_oracle 0.7539 (0.7276) acc 56.2500 (56.2083) kd_loss 0.8363 (0.8287) lr 1.7705e-03 eta 0:20:22
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,609
* accuracy: 59.6%
* error: 40.4%
* macro_f1: 51.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,477
* accuracy: 56.3%
* error: 43.7%
* macro_f1: 22.3%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      62.5%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [14/50] batch [20/319] time 0.101 (0.131) data 0.000 (0.027) loss 1.5924 (1.6832) ce_loss 1.0166 (1.1291) teacher_loss 0.8518 (0.9474) loss_zs_kd 1.0608 (0.8502) loss_oracle 0.7406 (0.7358) acc 75.0000 (56.4062) kd_loss 0.8745 (0.8471) lr 1.7290e-03 eta 0:25:39
epoch [14/50] batch [40/319] time 0.093 (0.117) data 0.000 (0.014) loss 1.9347 (1.6749) ce_loss 1.0508 (1.1269) teacher_loss 1.2038 (0.9240) loss_zs_kd 0.9033 (0.9495) loss_oracle 0.7310 (0.7509) acc 68.7500 (57.0312) kd_loss 0.8911 (0.8420) lr 1.7290e-03 eta 0:22:54
epoch [14/50] batch [60/319] time 0.105 (0.112) data 0.001 (0.009) loss 1.5404 (1.6997) ce_loss 1.0352 (1.1468) teacher_loss 0.8810 (0.9557) loss_zs_kd 1.2810 (0.9743) loss_oracle 0.6595 (0.7440) acc 56.2500 (55.2604) kd_loss 0.8386 (0.8410) lr 1.7290e-03 eta 0:21:58
epoch [14/50] batch [80/319] time 0.112 (0.110) data 0.000 (0.007) loss 1.7728 (1.7048) ce_loss 1.3477 (1.1529) teacher_loss 1.0540 (0.9693) loss_zs_kd 0.9889 (0.9577) loss_oracle 0.7189 (0.7355) acc 43.7500 (54.7656) kd_loss 0.8682 (0.8426) lr 1.7290e-03 eta 0:21:34
epoch [14/50] batch [100/319] time 0.114 (0.110) data 0.000 (0.006) loss 1.3681 (1.7147) ce_loss 0.9253 (1.1579) teacher_loss 0.6227 (0.9781) loss_zs_kd 0.9711 (0.9622) loss_oracle 0.7454 (0.7366) acc 56.2500 (53.9688) kd_loss 0.8510 (0.8439) lr 1.7290e-03 eta 0:21:25
epoch [14/50] batch [120/319] time 0.108 (0.109) data 0.000 (0.005) loss 1.6156 (1.7210) ce_loss 1.0303 (1.1579) teacher_loss 0.8774 (0.9841) loss_zs_kd 1.0632 (0.9694) loss_oracle 0.7381 (0.7369) acc 56.2500 (53.9844) kd_loss 0.8427 (0.8452) lr 1.7290e-03 eta 0:21:11
epoch [14/50] batch [140/319] time 0.104 (0.108) data 0.000 (0.004) loss 2.0326 (1.7258) ce_loss 1.5322 (1.1587) teacher_loss 1.3024 (0.9935) loss_zs_kd 0.8578 (0.9635) loss_oracle 0.7302 (0.7322) acc 37.5000 (53.7500) kd_loss 0.8316 (0.8444) lr 1.7290e-03 eta 0:20:59
epoch [14/50] batch [160/319] time 0.109 (0.107) data 0.000 (0.004) loss 1.7480 (1.7327) ce_loss 1.2275 (1.1636) teacher_loss 1.0609 (1.0048) loss_zs_kd 0.7890 (0.9487) loss_oracle 0.6870 (0.7279) acc 46.8750 (53.8867) kd_loss 0.8304 (0.8449) lr 1.7290e-03 eta 0:20:49
epoch [14/50] batch [180/319] time 0.107 (0.107) data 0.000 (0.003) loss 1.7105 (1.7298) ce_loss 1.0898 (1.1607) teacher_loss 0.9796 (1.0025) loss_zs_kd 0.8335 (0.9404) loss_oracle 0.7309 (0.7273) acc 59.3750 (54.2014) kd_loss 0.8520 (0.8458) lr 1.7290e-03 eta 0:20:42
epoch [14/50] batch [200/319] time 0.094 (0.107) data 0.000 (0.003) loss 1.6206 (1.7262) ce_loss 1.0273 (1.1525) teacher_loss 0.8784 (0.9971) loss_zs_kd 0.8978 (0.9381) loss_oracle 0.7422 (0.7291) acc 68.7500 (54.8750) kd_loss 0.8254 (0.8473) lr 1.7290e-03 eta 0:20:36
epoch [14/50] batch [220/319] time 0.096 (0.106) data 0.000 (0.003) loss 1.6917 (1.7287) ce_loss 1.1045 (1.1525) teacher_loss 0.9629 (0.9995) loss_zs_kd 0.8293 (0.9341) loss_oracle 0.7288 (0.7292) acc 56.2500 (55.0568) kd_loss 0.8445 (0.8466) lr 1.7290e-03 eta 0:20:30
epoch [14/50] batch [240/319] time 0.104 (0.106) data 0.000 (0.003) loss 1.6854 (1.7283) ce_loss 1.0918 (1.1494) teacher_loss 0.9697 (1.0005) loss_zs_kd 0.8851 (0.9262) loss_oracle 0.7158 (0.7278) acc 62.5000 (55.1953) kd_loss 0.8187 (0.8464) lr 1.7290e-03 eta 0:20:25
epoch [14/50] batch [260/319] time 0.094 (0.106) data 0.000 (0.002) loss 1.5476 (1.7268) ce_loss 1.0059 (1.1457) teacher_loss 0.8518 (0.9998) loss_zs_kd 0.7210 (0.9168) loss_oracle 0.6957 (0.7270) acc 62.5000 (55.4447) kd_loss 0.8344 (0.8452) lr 1.7290e-03 eta 0:20:21
epoch [14/50] batch [280/319] time 0.096 (0.106) data 0.000 (0.002) loss 1.5942 (1.7214) ce_loss 1.0859 (1.1422) teacher_loss 0.8492 (0.9959) loss_zs_kd 0.8705 (0.9161) loss_oracle 0.7450 (0.7254) acc 53.1250 (55.6808) kd_loss 0.8283 (0.8438) lr 1.7290e-03 eta 0:20:16
epoch [14/50] batch [300/319] time 0.085 (0.104) data 0.000 (0.002) loss 1.8263 (1.7202) ce_loss 1.3135 (1.1428) teacher_loss 1.0524 (0.9939) loss_zs_kd 0.9021 (0.9131) loss_oracle 0.7738 (0.7263) acc 50.0000 (55.8750) kd_loss 0.8356 (0.8439) lr 1.7290e-03 eta 0:19:59
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,537
* accuracy: 57.9%
* error: 42.1%
* macro_f1: 51.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,199
* accuracy: 53.4%
* error: 46.6%
* macro_f1: 21.4%
******* Domain 2 best val acc:      62.5%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [15/50] batch [20/319] time 0.104 (0.127) data 0.000 (0.025) loss 2.1205 (1.7968) ce_loss 1.5518 (1.1787) teacher_loss 1.4462 (1.0678) loss_zs_kd 0.8566 (0.9323) loss_oracle 0.6743 (0.7290) acc 37.5000 (55.1562) kd_loss 0.8698 (0.8438) lr 1.6845e-03 eta 0:24:14
epoch [15/50] batch [40/319] time 0.093 (0.112) data 0.000 (0.013) loss 1.4575 (1.7378) ce_loss 0.9824 (1.1473) teacher_loss 0.7409 (1.0140) loss_zs_kd 0.8543 (0.9245) loss_oracle 0.7166 (0.7238) acc 59.3750 (55.8594) kd_loss 0.7941 (0.8338) lr 1.6845e-03 eta 0:21:18
epoch [15/50] batch [60/319] time 0.093 (0.109) data 0.000 (0.009) loss 1.7147 (1.7264) ce_loss 1.3115 (1.1461) teacher_loss 0.9864 (0.9998) loss_zs_kd 1.0513 (0.9348) loss_oracle 0.7283 (0.7266) acc 46.8750 (55.8854) kd_loss 0.7923 (0.8370) lr 1.6845e-03 eta 0:20:43
epoch [15/50] batch [80/319] time 0.098 (0.107) data 0.000 (0.006) loss 1.6119 (1.7309) ce_loss 1.0186 (1.1490) teacher_loss 0.9212 (1.0015) loss_zs_kd 0.9332 (0.9563) loss_oracle 0.6907 (0.7294) acc 56.2500 (55.6250) kd_loss 0.7995 (0.8371) lr 1.6845e-03 eta 0:20:20
epoch [15/50] batch [100/319] time 0.093 (0.106) data 0.000 (0.005) loss 1.6169 (1.7168) ce_loss 0.9912 (1.1424) teacher_loss 0.8755 (0.9865) loss_zs_kd 0.7576 (0.9481) loss_oracle 0.7413 (0.7303) acc 59.3750 (56.0938) kd_loss 0.8422 (0.8360) lr 1.6845e-03 eta 0:20:11
epoch [15/50] batch [120/319] time 0.108 (0.106) data 0.000 (0.004) loss 1.4377 (1.7146) ce_loss 0.9575 (1.1449) teacher_loss 0.7140 (0.9798) loss_zs_kd 0.9823 (0.9408) loss_oracle 0.7237 (0.7348) acc 68.7500 (56.0417) kd_loss 0.8377 (0.8355) lr 1.6845e-03 eta 0:20:04
epoch [15/50] batch [140/319] time 0.103 (0.105) data 0.000 (0.004) loss 1.7612 (1.7060) ce_loss 1.2314 (1.1450) teacher_loss 1.0053 (0.9686) loss_zs_kd 1.2575 (0.9440) loss_oracle 0.7559 (0.7374) acc 56.2500 (56.2946) kd_loss 0.8768 (0.8346) lr 1.6845e-03 eta 0:19:48
epoch [15/50] batch [160/319] time 0.105 (0.104) data 0.000 (0.003) loss 1.6672 (1.6976) ce_loss 1.1133 (1.1387) teacher_loss 0.8611 (0.9580) loss_zs_kd 1.0388 (0.9690) loss_oracle 0.8061 (0.7396) acc 62.5000 (56.4062) kd_loss 0.8545 (0.8345) lr 1.6845e-03 eta 0:19:41
epoch [15/50] batch [180/319] time 0.107 (0.104) data 0.000 (0.003) loss 1.6053 (1.6862) ce_loss 1.1777 (1.1319) teacher_loss 0.8256 (0.9451) loss_zs_kd 0.8177 (0.9692) loss_oracle 0.7797 (0.7411) acc 62.5000 (56.6319) kd_loss 0.8014 (0.8342) lr 1.6845e-03 eta 0:19:39
epoch [15/50] batch [200/319] time 0.104 (0.105) data 0.000 (0.003) loss 2.0393 (1.6970) ce_loss 1.4873 (1.1395) teacher_loss 1.2533 (0.9572) loss_zs_kd 0.8349 (0.9691) loss_oracle 0.7859 (0.7398) acc 50.0000 (56.5625) kd_loss 0.8165 (0.8342) lr 1.6845e-03 eta 0:19:40
epoch [15/50] batch [220/319] time 0.106 (0.105) data 0.000 (0.003) loss 1.8587 (1.7057) ce_loss 1.2559 (1.1414) teacher_loss 1.1722 (0.9669) loss_zs_kd 0.8062 (0.9572) loss_oracle 0.6865 (0.7387) acc 50.0000 (56.6051) kd_loss 0.7816 (0.8324) lr 1.6845e-03 eta 0:19:37
epoch [15/50] batch [240/319] time 0.096 (0.105) data 0.000 (0.002) loss 1.5530 (1.7064) ce_loss 1.0342 (1.1400) teacher_loss 0.8246 (0.9681) loss_zs_kd 0.8290 (0.9416) loss_oracle 0.7284 (0.7383) acc 59.3750 (56.6797) kd_loss 0.7737 (0.8299) lr 1.6845e-03 eta 0:19:35
epoch [15/50] batch [260/319] time 0.094 (0.104) data 0.000 (0.002) loss 1.8308 (1.7152) ce_loss 1.1221 (1.1438) teacher_loss 1.0860 (0.9781) loss_zs_kd 0.7309 (0.9334) loss_oracle 0.7448 (0.7371) acc 50.0000 (56.4062) kd_loss 0.8139 (0.8283) lr 1.6845e-03 eta 0:19:32
epoch [15/50] batch [280/319] time 0.123 (0.105) data 0.000 (0.002) loss 1.5830 (1.7224) ce_loss 1.1182 (1.1475) teacher_loss 0.8311 (0.9857) loss_zs_kd 0.8250 (0.9244) loss_oracle 0.7519 (0.7367) acc 53.1250 (56.2946) kd_loss 0.8115 (0.8277) lr 1.6845e-03 eta 0:19:31
epoch [15/50] batch [300/319] time 0.086 (0.103) data 0.000 (0.002) loss 1.9613 (1.7218) ce_loss 1.2236 (1.1433) teacher_loss 1.2494 (0.9863) loss_zs_kd 0.7649 (0.9144) loss_oracle 0.7119 (0.7355) acc 50.0000 (56.5729) kd_loss 0.7896 (0.8282) lr 1.6845e-03 eta 0:19:16
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,693
* accuracy: 61.5%
* error: 38.5%
* macro_f1: 53.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,851
* accuracy: 49.8%
* error: 50.2%
* macro_f1: 21.3%
******* Domain 2 best val acc:      62.5%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [16/50] batch [20/319] time 0.100 (0.130) data 0.000 (0.026) loss 1.5817 (1.7025) ce_loss 0.8916 (1.1417) teacher_loss 0.8192 (0.9526) loss_zs_kd 0.7711 (0.8153) loss_oracle 0.7625 (0.7500) acc 68.7500 (57.0312) kd_loss 0.7997 (0.8152) lr 1.6374e-03 eta 0:24:05
epoch [16/50] batch [40/319] time 0.118 (0.117) data 0.000 (0.013) loss 1.9464 (1.7080) ce_loss 1.4697 (1.1301) teacher_loss 1.1242 (0.9500) loss_zs_kd 0.6723 (0.8300) loss_oracle 0.8222 (0.7580) acc 43.7500 (58.2812) kd_loss 0.8067 (0.8243) lr 1.6374e-03 eta 0:21:40
epoch [16/50] batch [60/319] time 0.116 (0.112) data 0.000 (0.009) loss 1.5062 (1.6911) ce_loss 0.8726 (1.1402) teacher_loss 0.7415 (0.9320) loss_zs_kd 1.0115 (0.8441) loss_oracle 0.7647 (0.7591) acc 59.3750 (57.6042) kd_loss 0.8340 (0.8283) lr 1.6374e-03 eta 0:20:42
epoch [16/50] batch [80/319] time 0.116 (0.110) data 0.000 (0.007) loss 1.6610 (1.6975) ce_loss 1.0137 (1.1368) teacher_loss 0.9625 (0.9404) loss_zs_kd 0.8899 (0.8553) loss_oracle 0.6984 (0.7571) acc 56.2500 (57.6172) kd_loss 0.8108 (0.8276) lr 1.6374e-03 eta 0:20:16
epoch [16/50] batch [100/319] time 0.085 (0.107) data 0.000 (0.005) loss 1.8467 (1.7114) ce_loss 1.2441 (1.1449) teacher_loss 1.1282 (0.9560) loss_zs_kd 0.6698 (0.8542) loss_oracle 0.7184 (0.7555) acc 50.0000 (57.0000) kd_loss 0.8135 (0.8281) lr 1.6374e-03 eta 0:19:46
epoch [16/50] batch [120/319] time 0.094 (0.105) data 0.000 (0.005) loss 1.6446 (1.7081) ce_loss 1.0664 (1.1391) teacher_loss 0.8991 (0.9529) loss_zs_kd 0.9715 (0.8524) loss_oracle 0.7455 (0.7552) acc 56.2500 (57.3177) kd_loss 0.8318 (0.8275) lr 1.6374e-03 eta 0:19:14
epoch [16/50] batch [140/319] time 0.111 (0.103) data 0.000 (0.004) loss 1.5843 (1.7204) ce_loss 0.8589 (1.1506) teacher_loss 0.7993 (0.9655) loss_zs_kd 0.8972 (0.8552) loss_oracle 0.7850 (0.7549) acc 71.8750 (56.7634) kd_loss 0.8107 (0.8276) lr 1.6374e-03 eta 0:19:00
epoch [16/50] batch [160/319] time 0.103 (0.103) data 0.000 (0.004) loss 1.4809 (1.7275) ce_loss 0.9995 (1.1593) teacher_loss 0.7315 (0.9745) loss_zs_kd 0.9092 (0.8587) loss_oracle 0.7494 (0.7530) acc 62.5000 (56.2695) kd_loss 0.8232 (0.8281) lr 1.6374e-03 eta 0:18:58
epoch [16/50] batch [180/319] time 0.105 (0.104) data 0.000 (0.003) loss 1.5782 (1.7277) ce_loss 1.0957 (1.1533) teacher_loss 0.8137 (0.9735) loss_zs_kd 0.7137 (0.8557) loss_oracle 0.7646 (0.7542) acc 50.0000 (56.1458) kd_loss 0.8854 (0.8274) lr 1.6374e-03 eta 0:18:57
epoch [16/50] batch [200/319] time 0.109 (0.103) data 0.000 (0.003) loss 1.6420 (1.7261) ce_loss 1.1133 (1.1553) teacher_loss 0.9175 (0.9726) loss_zs_kd 0.8524 (0.8542) loss_oracle 0.7246 (0.7535) acc 65.6250 (55.7500) kd_loss 0.8265 (0.8278) lr 1.6374e-03 eta 0:18:54
epoch [16/50] batch [220/319] time 0.115 (0.104) data 0.000 (0.003) loss 1.7101 (1.7216) ce_loss 1.0283 (1.1533) teacher_loss 0.9215 (0.9695) loss_zs_kd 0.8534 (0.8654) loss_oracle 0.7887 (0.7521) acc 59.3750 (55.7955) kd_loss 0.8505 (0.8281) lr 1.6374e-03 eta 0:18:53
epoch [16/50] batch [240/319] time 0.104 (0.103) data 0.000 (0.002) loss 1.6622 (1.7228) ce_loss 1.1396 (1.1560) teacher_loss 0.8920 (0.9704) loss_zs_kd 1.1441 (0.8740) loss_oracle 0.7702 (0.7524) acc 46.8750 (55.6771) kd_loss 0.7790 (0.8276) lr 1.6374e-03 eta 0:18:50
epoch [16/50] batch [260/319] time 0.099 (0.103) data 0.000 (0.002) loss 1.4781 (1.7238) ce_loss 1.0225 (1.1573) teacher_loss 0.6822 (0.9717) loss_zs_kd 0.7902 (0.8676) loss_oracle 0.7959 (0.7521) acc 53.1250 (55.6370) kd_loss 0.7989 (0.8279) lr 1.6374e-03 eta 0:18:47
epoch [16/50] batch [280/319] time 0.112 (0.104) data 0.000 (0.002) loss 2.0004 (1.7223) ce_loss 1.4316 (1.1592) teacher_loss 1.2937 (0.9706) loss_zs_kd 0.9445 (0.8699) loss_oracle 0.7067 (0.7517) acc 37.5000 (55.6362) kd_loss 0.8333 (0.8289) lr 1.6374e-03 eta 0:18:46
epoch [16/50] batch [300/319] time 0.097 (0.104) data 0.000 (0.002) loss 1.7202 (1.7174) ce_loss 1.1885 (1.1563) teacher_loss 0.8832 (0.9643) loss_zs_kd 0.7992 (0.8726) loss_oracle 0.8370 (0.7531) acc 53.1250 (55.7188) kd_loss 0.8593 (0.8296) lr 1.6374e-03 eta 0:18:44
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,620
* accuracy: 59.8%
* error: 40.2%
* macro_f1: 51.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,835
* accuracy: 49.7%
* error: 50.3%
* macro_f1: 20.9%
******* Domain 2 best val acc:      62.5%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [17/50] batch [20/319] time 0.105 (0.137) data 0.000 (0.028) loss 1.5214 (1.5653) ce_loss 0.9536 (1.0962) teacher_loss 0.7447 (0.8071) loss_zs_kd 1.3036 (0.8284) loss_oracle 0.7766 (0.7581) acc 59.3750 (56.4062) kd_loss 0.8502 (0.8332) lr 1.5878e-03 eta 0:24:40
epoch [17/50] batch [40/319] time 0.098 (0.119) data 0.000 (0.014) loss 1.5470 (1.6024) ce_loss 1.0889 (1.1310) teacher_loss 0.8264 (0.8461) loss_zs_kd 1.0400 (0.9046) loss_oracle 0.7206 (0.7562) acc 59.3750 (55.7031) kd_loss 0.7949 (0.8407) lr 1.5878e-03 eta 0:21:24
epoch [17/50] batch [60/319] time 0.104 (0.115) data 0.000 (0.010) loss 1.9286 (1.6112) ce_loss 1.3984 (1.1392) teacher_loss 1.2030 (0.8525) loss_zs_kd 0.7541 (0.9061) loss_oracle 0.7256 (0.7587) acc 53.1250 (56.3542) kd_loss 0.8468 (0.8382) lr 1.5878e-03 eta 0:20:36
epoch [17/50] batch [80/319] time 0.106 (0.112) data 0.000 (0.007) loss 1.5178 (1.6046) ce_loss 0.8589 (1.1339) teacher_loss 0.8288 (0.8452) loss_zs_kd 1.0312 (0.8897) loss_oracle 0.6891 (0.7594) acc 68.7500 (56.7969) kd_loss 0.8000 (0.8359) lr 1.5878e-03 eta 0:20:06
epoch [17/50] batch [100/319] time 0.100 (0.110) data 0.000 (0.006) loss 1.5431 (1.6055) ce_loss 1.2148 (1.1413) teacher_loss 0.7546 (0.8464) loss_zs_kd 1.1157 (0.8862) loss_oracle 0.7885 (0.7591) acc 50.0000 (56.5625) kd_loss 0.8093 (0.8372) lr 1.5878e-03 eta 0:19:40
epoch [17/50] batch [120/319] time 0.115 (0.109) data 0.000 (0.005) loss 1.7344 (1.6196) ce_loss 1.0293 (1.1528) teacher_loss 1.0125 (0.8596) loss_zs_kd 1.2203 (0.9065) loss_oracle 0.7219 (0.7600) acc 53.1250 (56.1198) kd_loss 0.8762 (0.8367) lr 1.5878e-03 eta 0:19:28
epoch [17/50] batch [140/319] time 0.108 (0.108) data 0.000 (0.004) loss 1.8966 (1.6357) ce_loss 1.2285 (1.1572) teacher_loss 1.1604 (0.8759) loss_zs_kd 0.9958 (0.9192) loss_oracle 0.7363 (0.7598) acc 53.1250 (55.8482) kd_loss 0.8235 (0.8362) lr 1.5878e-03 eta 0:19:17
epoch [17/50] batch [160/319] time 0.116 (0.107) data 0.000 (0.004) loss 1.4054 (1.6417) ce_loss 0.8721 (1.1506) teacher_loss 0.6421 (0.8814) loss_zs_kd 0.8229 (0.9162) loss_oracle 0.7633 (0.7604) acc 65.6250 (56.0352) kd_loss 0.8683 (0.8368) lr 1.5878e-03 eta 0:19:06
epoch [17/50] batch [180/319] time 0.101 (0.107) data 0.000 (0.003) loss 1.4095 (1.6402) ce_loss 0.9941 (1.1498) teacher_loss 0.5903 (0.8795) loss_zs_kd 1.1170 (0.9133) loss_oracle 0.8192 (0.7607) acc 65.6250 (55.9549) kd_loss 0.8748 (0.8359) lr 1.5878e-03 eta 0:18:59
epoch [17/50] batch [200/319] time 0.115 (0.107) data 0.000 (0.003) loss 1.4727 (1.6439) ce_loss 0.8452 (1.1510) teacher_loss 0.7192 (0.8839) loss_zs_kd 0.9444 (0.9156) loss_oracle 0.7535 (0.7600) acc 84.3750 (56.1875) kd_loss 0.8368 (0.8370) lr 1.5878e-03 eta 0:18:54
epoch [17/50] batch [220/319] time 0.106 (0.106) data 0.000 (0.003) loss 1.6406 (1.6543) ce_loss 1.0527 (1.1576) teacher_loss 0.9047 (0.8957) loss_zs_kd 1.0660 (0.9111) loss_oracle 0.7359 (0.7586) acc 59.3750 (55.9943) kd_loss 0.8179 (0.8366) lr 1.5878e-03 eta 0:18:50
epoch [17/50] batch [240/319] time 0.098 (0.106) data 0.000 (0.003) loss 1.9061 (1.6531) ce_loss 1.2734 (1.1561) teacher_loss 1.1240 (0.8940) loss_zs_kd 1.0468 (0.9074) loss_oracle 0.7821 (0.7591) acc 46.8750 (56.0547) kd_loss 0.8313 (0.8363) lr 1.5878e-03 eta 0:18:45
epoch [17/50] batch [260/319] time 0.109 (0.106) data 0.000 (0.002) loss 1.5680 (1.6524) ce_loss 1.1855 (1.1545) teacher_loss 0.7863 (0.8924) loss_zs_kd 1.0392 (0.9099) loss_oracle 0.7818 (0.7601) acc 50.0000 (56.1298) kd_loss 0.8874 (0.8373) lr 1.5878e-03 eta 0:18:42
epoch [17/50] batch [280/319] time 0.112 (0.106) data 0.000 (0.002) loss 1.3259 (1.6509) ce_loss 0.8643 (1.1525) teacher_loss 0.5386 (0.8911) loss_zs_kd 0.9997 (0.9096) loss_oracle 0.7874 (0.7598) acc 59.3750 (56.0714) kd_loss 0.8176 (0.8378) lr 1.5878e-03 eta 0:18:38
epoch [17/50] batch [300/319] time 0.094 (0.106) data 0.000 (0.002) loss 1.8312 (1.6519) ce_loss 1.1973 (1.1516) teacher_loss 1.0483 (0.8916) loss_zs_kd 1.1100 (0.9146) loss_oracle 0.7829 (0.7603) acc 56.2500 (56.2083) kd_loss 0.8576 (0.8375) lr 1.5878e-03 eta 0:18:32
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,713
* accuracy: 62.0%
* error: 38.0%
* macro_f1: 52.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,295
* accuracy: 54.4%
* error: 45.6%
* macro_f1: 21.2%
******* Domain 2 best val acc:      62.5%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [18/50] batch [20/319] time 0.096 (0.132) data 0.000 (0.036) loss 1.5629 (1.6413) ce_loss 1.0693 (1.0798) teacher_loss 0.8180 (0.8904) loss_zs_kd 0.9894 (1.0278) loss_oracle 0.7450 (0.7508) acc 59.3750 (59.6875) kd_loss 0.8248 (0.8273) lr 1.5358e-03 eta 0:23:06
epoch [18/50] batch [40/319] time 0.096 (0.114) data 0.000 (0.018) loss 1.6196 (1.6428) ce_loss 1.0635 (1.1053) teacher_loss 0.8777 (0.8882) loss_zs_kd 0.9504 (1.0266) loss_oracle 0.7419 (0.7546) acc 50.0000 (57.8906) kd_loss 0.7688 (0.8289) lr 1.5358e-03 eta 0:19:59
epoch [18/50] batch [60/319] time 0.096 (0.108) data 0.001 (0.012) loss 1.6133 (1.6359) ce_loss 1.1797 (1.1197) teacher_loss 0.8377 (0.8751) loss_zs_kd 0.9190 (0.9797) loss_oracle 0.7756 (0.7608) acc 53.1250 (56.8229) kd_loss 0.8014 (0.8291) lr 1.5358e-03 eta 0:18:49
epoch [18/50] batch [80/319] time 0.109 (0.107) data 0.000 (0.009) loss 1.3950 (1.6373) ce_loss 0.9658 (1.1261) teacher_loss 0.6315 (0.8779) loss_zs_kd 0.9354 (0.9623) loss_oracle 0.7635 (0.7594) acc 68.7500 (56.9141) kd_loss 0.8016 (0.8308) lr 1.5358e-03 eta 0:18:38
epoch [18/50] batch [100/319] time 0.099 (0.106) data 0.000 (0.007) loss 1.3489 (1.6300) ce_loss 0.7241 (1.1337) teacher_loss 0.5472 (0.8686) loss_zs_kd 0.9683 (0.9603) loss_oracle 0.8017 (0.7614) acc 75.0000 (56.5938) kd_loss 0.8429 (0.8340) lr 1.5358e-03 eta 0:18:28
epoch [18/50] batch [120/319] time 0.093 (0.106) data 0.000 (0.006) loss 1.5060 (1.6365) ce_loss 1.2607 (1.1490) teacher_loss 0.7560 (0.8784) loss_zs_kd 1.2157 (0.9507) loss_oracle 0.7500 (0.7581) acc 53.1250 (56.0417) kd_loss 0.8169 (0.8315) lr 1.5358e-03 eta 0:18:24
epoch [18/50] batch [140/319] time 0.111 (0.105) data 0.000 (0.005) loss 1.5672 (1.6352) ce_loss 0.9150 (1.1482) teacher_loss 0.8330 (0.8758) loss_zs_kd 0.9471 (0.9368) loss_oracle 0.7342 (0.7593) acc 71.8750 (55.8036) kd_loss 0.8351 (0.8311) lr 1.5358e-03 eta 0:18:14
epoch [18/50] batch [160/319] time 0.106 (0.105) data 0.000 (0.005) loss 1.8493 (1.6454) ce_loss 1.2852 (1.1590) teacher_loss 1.0350 (0.8869) loss_zs_kd 0.7969 (0.9190) loss_oracle 0.8143 (0.7585) acc 50.0000 (55.4688) kd_loss 0.8246 (0.8314) lr 1.5358e-03 eta 0:18:09
epoch [18/50] batch [180/319] time 0.118 (0.105) data 0.000 (0.004) loss 1.8021 (1.6446) ce_loss 1.2314 (1.1616) teacher_loss 1.0050 (0.8854) loss_zs_kd 0.8921 (0.9094) loss_oracle 0.7971 (0.7592) acc 53.1250 (55.3646) kd_loss 0.8534 (0.8308) lr 1.5358e-03 eta 0:18:07
epoch [18/50] batch [200/319] time 0.104 (0.105) data 0.000 (0.004) loss 1.7992 (1.6486) ce_loss 1.1777 (1.1675) teacher_loss 1.0438 (0.8889) loss_zs_kd 0.8371 (0.9040) loss_oracle 0.7554 (0.7597) acc 46.8750 (55.1250) kd_loss 0.8543 (0.8312) lr 1.5358e-03 eta 0:18:03
epoch [18/50] batch [220/319] time 0.107 (0.105) data 0.000 (0.003) loss 1.7000 (1.6471) ce_loss 1.1631 (1.1716) teacher_loss 0.9449 (0.8884) loss_zs_kd 0.8797 (0.8991) loss_oracle 0.7552 (0.7587) acc 53.1250 (54.8722) kd_loss 0.7979 (0.8308) lr 1.5358e-03 eta 0:18:00
epoch [18/50] batch [240/319] time 0.103 (0.105) data 0.000 (0.003) loss 1.4523 (1.6427) ce_loss 1.0664 (1.1702) teacher_loss 0.6868 (0.8844) loss_zs_kd 0.9364 (0.9050) loss_oracle 0.7654 (0.7583) acc 62.5000 (54.9089) kd_loss 0.8395 (0.8312) lr 1.5358e-03 eta 0:17:56
epoch [18/50] batch [260/319] time 0.099 (0.105) data 0.000 (0.003) loss 1.7246 (1.6396) ce_loss 1.1074 (1.1674) teacher_loss 1.0467 (0.8817) loss_zs_kd 1.1342 (0.9158) loss_oracle 0.6779 (0.7579) acc 53.1250 (55.0120) kd_loss 0.8571 (0.8312) lr 1.5358e-03 eta 0:17:53
epoch [18/50] batch [280/319] time 0.094 (0.105) data 0.000 (0.003) loss 1.8686 (1.6457) ce_loss 1.2617 (1.1690) teacher_loss 1.1161 (0.8880) loss_zs_kd 0.8284 (0.9200) loss_oracle 0.7524 (0.7577) acc 50.0000 (55.0558) kd_loss 0.8030 (0.8312) lr 1.5358e-03 eta 0:17:51
epoch [18/50] batch [300/319] time 0.103 (0.104) data 0.000 (0.003) loss 1.4547 (1.6505) ce_loss 0.9336 (1.1714) teacher_loss 0.6721 (0.8932) loss_zs_kd 0.9574 (0.9156) loss_oracle 0.7826 (0.7573) acc 68.7500 (55.0729) kd_loss 0.8344 (0.8299) lr 1.5358e-03 eta 0:17:48
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,732
* accuracy: 62.4%
* error: 37.6%
* macro_f1: 54.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,853
* accuracy: 49.8%
* error: 50.2%
* macro_f1: 21.5%
******* Domain 2 best val acc:      62.5%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [19/50] batch [20/319] time 0.085 (0.132) data 0.000 (0.030) loss 1.6066 (1.6445) ce_loss 0.8784 (1.1267) teacher_loss 0.8888 (0.9004) loss_zs_kd 0.8688 (0.8147) loss_oracle 0.7179 (0.7441) acc 65.6250 (56.7188) kd_loss 0.7705 (0.8249) lr 1.4818e-03 eta 0:22:28
epoch [19/50] batch [40/319] time 0.113 (0.117) data 0.000 (0.015) loss 1.6251 (1.6653) ce_loss 1.1133 (1.1430) teacher_loss 0.8650 (0.9249) loss_zs_kd 0.7650 (0.8175) loss_oracle 0.7601 (0.7404) acc 53.1250 (56.4844) kd_loss 0.7933 (0.8243) lr 1.4818e-03 eta 0:19:51
epoch [19/50] batch [60/319] time 0.108 (0.113) data 0.000 (0.010) loss 1.6839 (1.6662) ce_loss 0.9297 (1.1617) teacher_loss 0.9712 (0.9257) loss_zs_kd 0.5739 (0.8130) loss_oracle 0.7127 (0.7404) acc 75.0000 (55.8333) kd_loss 0.7699 (0.8243) lr 1.4818e-03 eta 0:19:08
epoch [19/50] batch [80/319] time 0.103 (0.111) data 0.000 (0.008) loss 1.8788 (1.6840) ce_loss 1.3320 (1.1870) teacher_loss 1.1535 (0.9407) loss_zs_kd 0.8144 (0.7923) loss_oracle 0.7253 (0.7433) acc 40.6250 (54.7266) kd_loss 0.7637 (0.8225) lr 1.4818e-03 eta 0:18:41
epoch [19/50] batch [100/319] time 0.099 (0.110) data 0.000 (0.006) loss 1.5966 (1.6901) ce_loss 1.2578 (1.1995) teacher_loss 0.8480 (0.9462) loss_zs_kd 0.8217 (0.7923) loss_oracle 0.7485 (0.7439) acc 56.2500 (53.7812) kd_loss 0.8167 (0.8226) lr 1.4818e-03 eta 0:18:30
epoch [19/50] batch [120/319] time 0.099 (0.109) data 0.000 (0.005) loss 1.7482 (1.6891) ce_loss 1.5078 (1.2003) teacher_loss 1.0377 (0.9451) loss_zs_kd 0.6586 (0.7901) loss_oracle 0.7105 (0.7441) acc 34.3750 (53.9323) kd_loss 0.8145 (0.8218) lr 1.4818e-03 eta 0:18:19
epoch [19/50] batch [140/319] time 0.104 (0.108) data 0.000 (0.004) loss 1.6211 (1.6902) ce_loss 1.1826 (1.2039) teacher_loss 0.8560 (0.9457) loss_zs_kd 0.9063 (0.8002) loss_oracle 0.7651 (0.7445) acc 56.2500 (53.8170) kd_loss 0.8420 (0.8217) lr 1.4818e-03 eta 0:18:11
epoch [19/50] batch [160/319] time 0.108 (0.108) data 0.000 (0.004) loss 1.7459 (1.6892) ce_loss 1.3076 (1.1966) teacher_loss 1.0351 (0.9432) loss_zs_kd 0.7069 (0.8020) loss_oracle 0.7108 (0.7459) acc 40.6250 (53.9258) kd_loss 0.8284 (0.8214) lr 1.4818e-03 eta 0:18:06
epoch [19/50] batch [180/319] time 0.101 (0.108) data 0.000 (0.004) loss 1.6105 (1.6834) ce_loss 0.8828 (1.1922) teacher_loss 0.8440 (0.9381) loss_zs_kd 0.8121 (0.7967) loss_oracle 0.7665 (0.7453) acc 78.1250 (54.0799) kd_loss 0.8616 (0.8218) lr 1.4818e-03 eta 0:17:58
epoch [19/50] batch [200/319] time 0.111 (0.107) data 0.000 (0.003) loss 1.6285 (1.6826) ce_loss 1.2285 (1.1908) teacher_loss 0.8865 (0.9351) loss_zs_kd 0.8111 (0.8075) loss_oracle 0.7420 (0.7475) acc 50.0000 (54.0781) kd_loss 0.8165 (0.8221) lr 1.4818e-03 eta 0:17:54
epoch [19/50] batch [220/319] time 0.112 (0.107) data 0.000 (0.003) loss 1.7550 (1.6768) ce_loss 1.3164 (1.1837) teacher_loss 1.0107 (0.9292) loss_zs_kd 0.7183 (0.8119) loss_oracle 0.7443 (0.7476) acc 46.8750 (54.5170) kd_loss 0.8691 (0.8226) lr 1.4818e-03 eta 0:17:50
epoch [19/50] batch [240/319] time 0.113 (0.107) data 0.000 (0.003) loss 1.7647 (1.6794) ce_loss 1.2949 (1.1814) teacher_loss 1.0769 (0.9333) loss_zs_kd 0.7644 (0.8117) loss_oracle 0.6878 (0.7461) acc 53.1250 (54.6875) kd_loss 0.8142 (0.8227) lr 1.4818e-03 eta 0:17:48
epoch [19/50] batch [260/319] time 0.103 (0.107) data 0.000 (0.003) loss 2.0359 (1.6850) ce_loss 1.4180 (1.1786) teacher_loss 1.2725 (0.9388) loss_zs_kd 0.6506 (0.8143) loss_oracle 0.7633 (0.7462) acc 50.0000 (54.8798) kd_loss 0.8150 (0.8225) lr 1.4818e-03 eta 0:17:44
epoch [19/50] batch [280/319] time 0.105 (0.107) data 0.000 (0.002) loss 1.5312 (1.6847) ce_loss 1.0938 (1.1765) teacher_loss 0.7826 (0.9386) loss_zs_kd 0.8335 (0.8149) loss_oracle 0.7486 (0.7460) acc 59.3750 (54.7768) kd_loss 0.8051 (0.8218) lr 1.4818e-03 eta 0:17:41
epoch [19/50] batch [300/319] time 0.106 (0.107) data 0.000 (0.002) loss 1.6010 (1.6825) ce_loss 1.2734 (1.1741) teacher_loss 0.8824 (0.9369) loss_zs_kd 0.9463 (0.8246) loss_oracle 0.7185 (0.7456) acc 53.1250 (54.8542) kd_loss 0.7763 (0.8213) lr 1.4818e-03 eta 0:17:37
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,724
* accuracy: 62.2%
* error: 37.8%
* macro_f1: 54.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,146
* accuracy: 52.9%
* error: 47.1%
* macro_f1: 22.1%
******* Domain 2 best val acc:      62.5%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [20/50] batch [20/319] time 0.097 (0.136) data 0.000 (0.035) loss 1.5896 (1.6344) ce_loss 1.0664 (1.1492) teacher_loss 0.7914 (0.8727) loss_zs_kd 0.9687 (1.0113) loss_oracle 0.7982 (0.7617) acc 53.1250 (58.1250) kd_loss 0.8275 (0.8331) lr 1.4258e-03 eta 0:22:19
epoch [20/50] batch [40/319] time 0.099 (0.118) data 0.000 (0.018) loss 1.5505 (1.6376) ce_loss 1.1611 (1.1404) teacher_loss 0.7880 (0.8778) loss_zs_kd 0.8646 (0.9921) loss_oracle 0.7626 (0.7598) acc 56.2500 (57.4219) kd_loss 0.8802 (0.8302) lr 1.4258e-03 eta 0:19:18
epoch [20/50] batch [60/319] time 0.107 (0.113) data 0.001 (0.012) loss 1.4017 (1.6838) ce_loss 0.9238 (1.1746) teacher_loss 0.6410 (0.9262) loss_zs_kd 0.7091 (0.9598) loss_oracle 0.7607 (0.7576) acc 68.7500 (56.0417) kd_loss 0.7537 (0.8262) lr 1.4258e-03 eta 0:18:30
epoch [20/50] batch [80/319] time 0.114 (0.110) data 0.000 (0.009) loss 1.6237 (1.6919) ce_loss 1.0820 (1.1683) teacher_loss 0.8829 (0.9374) loss_zs_kd 1.0740 (0.9636) loss_oracle 0.7408 (0.7546) acc 56.2500 (55.8984) kd_loss 0.8250 (0.8257) lr 1.4258e-03 eta 0:18:02
epoch [20/50] batch [100/319] time 0.111 (0.109) data 0.000 (0.007) loss 1.6493 (1.6987) ce_loss 1.1592 (1.1645) teacher_loss 0.8765 (0.9464) loss_zs_kd 0.9178 (0.9607) loss_oracle 0.7728 (0.7524) acc 56.2500 (55.8125) kd_loss 0.7788 (0.8223) lr 1.4258e-03 eta 0:17:49
epoch [20/50] batch [120/319] time 0.101 (0.108) data 0.000 (0.006) loss 1.5341 (1.6971) ce_loss 1.2490 (1.1602) teacher_loss 0.8094 (0.9444) loss_zs_kd 0.8793 (0.9559) loss_oracle 0.7247 (0.7526) acc 53.1250 (55.6510) kd_loss 0.7828 (0.8186) lr 1.4258e-03 eta 0:17:35
epoch [20/50] batch [140/319] time 0.099 (0.107) data 0.000 (0.005) loss 1.6358 (1.6952) ce_loss 1.1064 (1.1637) teacher_loss 0.8700 (0.9403) loss_zs_kd 0.8815 (0.9600) loss_oracle 0.7658 (0.7548) acc 50.0000 (55.3348) kd_loss 0.8281 (0.8196) lr 1.4258e-03 eta 0:17:27
epoch [20/50] batch [160/319] time 0.111 (0.107) data 0.000 (0.005) loss 1.5422 (1.6894) ce_loss 0.9336 (1.1567) teacher_loss 0.7943 (0.9356) loss_zs_kd 0.9773 (0.9528) loss_oracle 0.7480 (0.7538) acc 68.7500 (55.5273) kd_loss 0.8219 (0.8201) lr 1.4258e-03 eta 0:17:19
epoch [20/50] batch [180/319] time 0.092 (0.106) data 0.000 (0.004) loss 1.8621 (1.6946) ce_loss 1.2021 (1.1622) teacher_loss 1.0818 (0.9415) loss_zs_kd 0.7848 (0.9334) loss_oracle 0.7803 (0.7531) acc 46.8750 (55.0000) kd_loss 0.8766 (0.8205) lr 1.4258e-03 eta 0:17:11
epoch [20/50] batch [200/319] time 0.089 (0.106) data 0.000 (0.004) loss 1.8605 (1.6970) ce_loss 1.1650 (1.1643) teacher_loss 1.1935 (0.9441) loss_zs_kd 1.1248 (0.9202) loss_oracle 0.6670 (0.7528) acc 65.6250 (55.0625) kd_loss 0.7838 (0.8205) lr 1.4258e-03 eta 0:17:04
epoch [20/50] batch [220/319] time 0.091 (0.105) data 0.000 (0.003) loss 1.7966 (1.6984) ce_loss 1.2842 (1.1619) teacher_loss 1.0611 (0.9450) loss_zs_kd 0.8875 (0.9158) loss_oracle 0.7355 (0.7535) acc 62.5000 (55.0568) kd_loss 0.8262 (0.8201) lr 1.4258e-03 eta 0:16:55
epoch [20/50] batch [240/319] time 0.102 (0.104) data 0.000 (0.003) loss 1.8071 (1.7068) ce_loss 1.1865 (1.1659) teacher_loss 1.0842 (0.9526) loss_zs_kd 0.8007 (0.9070) loss_oracle 0.7229 (0.7542) acc 59.3750 (54.8568) kd_loss 0.7894 (0.8190) lr 1.4258e-03 eta 0:16:46
epoch [20/50] batch [260/319] time 0.082 (0.104) data 0.000 (0.003) loss 1.6988 (1.7108) ce_loss 1.0654 (1.1619) teacher_loss 0.9323 (0.9566) loss_zs_kd 0.6950 (0.8963) loss_oracle 0.7665 (0.7542) acc 59.3750 (55.1082) kd_loss 0.8248 (0.8187) lr 1.4258e-03 eta 0:16:43
epoch [20/50] batch [280/319] time 0.109 (0.104) data 0.000 (0.003) loss 1.8277 (1.7170) ce_loss 1.2920 (1.1652) teacher_loss 1.0378 (0.9626) loss_zs_kd 0.8757 (0.8875) loss_oracle 0.7898 (0.7544) acc 59.3750 (55.1786) kd_loss 0.8212 (0.8183) lr 1.4258e-03 eta 0:16:39
epoch [20/50] batch [300/319] time 0.083 (0.104) data 0.000 (0.003) loss 1.7042 (1.7224) ce_loss 1.1172 (1.1651) teacher_loss 0.9718 (0.9677) loss_zs_kd 1.0895 (0.8823) loss_oracle 0.7324 (0.7546) acc 59.3750 (55.3646) kd_loss 0.7778 (0.8177) lr 1.4258e-03 eta 0:16:35
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,590
* accuracy: 59.2%
* error: 40.8%
* macro_f1: 52.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,054
* accuracy: 51.9%
* error: 48.1%
* macro_f1: 22.5%
******* Domain 2 best val acc:      62.5%, epoch: 7 *******
******* Domain 2 best val test acc: 50.8%, epoch: 7 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [21/50] batch [20/319] time 0.092 (0.125) data 0.000 (0.029) loss 1.7075 (1.7048) ce_loss 1.1221 (1.1753) teacher_loss 0.9215 (0.9468) loss_zs_kd 1.0124 (0.8998) loss_oracle 0.7860 (0.7580) acc 56.2500 (52.0312) kd_loss 0.8037 (0.8256) lr 1.3681e-03 eta 0:19:50
epoch [21/50] batch [40/319] time 0.098 (0.110) data 0.001 (0.015) loss 1.7671 (1.7426) ce_loss 1.2510 (1.1996) teacher_loss 1.0326 (0.9848) loss_zs_kd 0.6447 (0.8598) loss_oracle 0.7345 (0.7578) acc 53.1250 (52.1875) kd_loss 0.7861 (0.8181) lr 1.3681e-03 eta 0:17:32
epoch [21/50] batch [60/319] time 0.077 (0.106) data 0.000 (0.010) loss 1.6104 (1.7482) ce_loss 1.2686 (1.2186) teacher_loss 0.8148 (0.9887) loss_zs_kd 1.0251 (0.8619) loss_oracle 0.7957 (0.7595) acc 50.0000 (52.1875) kd_loss 0.8197 (0.8195) lr 1.3681e-03 eta 0:16:46
epoch [21/50] batch [80/319] time 0.088 (0.103) data 0.000 (0.008) loss 1.4675 (1.7542) ce_loss 0.9062 (1.2266) teacher_loss 0.7822 (0.9960) loss_zs_kd 0.7315 (0.8429) loss_oracle 0.6853 (0.7582) acc 68.7500 (52.0312) kd_loss 0.8219 (0.8188) lr 1.3681e-03 eta 0:16:21
epoch [21/50] batch [100/319] time 0.100 (0.103) data 0.000 (0.006) loss 1.6014 (1.7593) ce_loss 1.2354 (1.2284) teacher_loss 0.8103 (1.0023) loss_zs_kd 0.6950 (0.8282) loss_oracle 0.7910 (0.7570) acc 53.1250 (51.8438) kd_loss 0.8286 (0.8186) lr 1.3681e-03 eta 0:16:18
epoch [21/50] batch [120/319] time 0.103 (0.103) data 0.000 (0.005) loss 1.5852 (1.7478) ce_loss 1.0225 (1.2168) teacher_loss 0.8470 (0.9901) loss_zs_kd 0.7837 (0.8215) loss_oracle 0.7382 (0.7576) acc 59.3750 (52.2656) kd_loss 0.8097 (0.8187) lr 1.3681e-03 eta 0:16:16
epoch [21/50] batch [140/319] time 0.106 (0.104) data 0.000 (0.004) loss 1.7992 (1.7458) ce_loss 1.3379 (1.2026) teacher_loss 1.0316 (0.9878) loss_zs_kd 0.9013 (0.8192) loss_oracle 0.7676 (0.7580) acc 40.6250 (52.7455) kd_loss 0.8059 (0.8172) lr 1.3681e-03 eta 0:16:17
epoch [21/50] batch [160/319] time 0.109 (0.104) data 0.000 (0.004) loss 1.6325 (1.7453) ce_loss 1.0576 (1.1961) teacher_loss 0.8934 (0.9904) loss_zs_kd 0.9526 (0.8124) loss_oracle 0.7391 (0.7549) acc 65.6250 (53.4375) kd_loss 0.7413 (0.8162) lr 1.3681e-03 eta 0:16:16
epoch [21/50] batch [180/319] time 0.109 (0.104) data 0.000 (0.004) loss 1.7794 (1.7354) ce_loss 1.2246 (1.1898) teacher_loss 1.0021 (0.9810) loss_zs_kd 0.8234 (0.8116) loss_oracle 0.7773 (0.7544) acc 53.1250 (53.7674) kd_loss 0.8339 (0.8169) lr 1.3681e-03 eta 0:16:15
epoch [21/50] batch [200/319] time 0.105 (0.104) data 0.000 (0.003) loss 1.9354 (1.7305) ce_loss 1.3604 (1.1864) teacher_loss 1.2561 (0.9767) loss_zs_kd 0.8785 (0.8162) loss_oracle 0.6794 (0.7538) acc 50.0000 (53.7969) kd_loss 0.8021 (0.8181) lr 1.3681e-03 eta 0:16:12
epoch [21/50] batch [220/319] time 0.106 (0.104) data 0.000 (0.003) loss 1.5253 (1.7233) ce_loss 1.0850 (1.1799) teacher_loss 0.8040 (0.9689) loss_zs_kd 0.8002 (0.8272) loss_oracle 0.7213 (0.7543) acc 53.1250 (54.1761) kd_loss 0.8153 (0.8193) lr 1.3681e-03 eta 0:16:09
epoch [21/50] batch [240/319] time 0.107 (0.104) data 0.000 (0.003) loss 1.5681 (1.7180) ce_loss 1.0605 (1.1751) teacher_loss 0.8119 (0.9633) loss_zs_kd 0.8806 (0.8287) loss_oracle 0.7563 (0.7547) acc 56.2500 (54.4792) kd_loss 0.8759 (0.8203) lr 1.3681e-03 eta 0:16:07
epoch [21/50] batch [260/319] time 0.112 (0.104) data 0.000 (0.003) loss 1.7560 (1.7223) ce_loss 1.2715 (1.1775) teacher_loss 0.9923 (0.9676) loss_zs_kd 0.8739 (0.8287) loss_oracle 0.7637 (0.7547) acc 40.6250 (54.2668) kd_loss 0.7888 (0.8207) lr 1.3681e-03 eta 0:16:04
epoch [21/50] batch [280/319] time 0.101 (0.104) data 0.000 (0.002) loss 1.6146 (1.7213) ce_loss 1.0967 (1.1771) teacher_loss 0.8563 (0.9682) loss_zs_kd 0.6735 (0.8240) loss_oracle 0.7583 (0.7531) acc 59.3750 (54.1183) kd_loss 0.8484 (0.8221) lr 1.3681e-03 eta 0:16:02
epoch [21/50] batch [300/319] time 0.079 (0.103) data 0.000 (0.002) loss 1.4687 (1.7136) ce_loss 0.9771 (1.1752) teacher_loss 0.6444 (0.9605) loss_zs_kd 0.8250 (0.8191) loss_oracle 0.8244 (0.7531) acc 59.3750 (54.2500) kd_loss 0.8646 (0.8233) lr 1.3681e-03 eta 0:15:50
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,757
* accuracy: 63.0%
* error: 37.0%
* macro_f1: 54.9%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,800
* accuracy: 49.3%
* error: 50.7%
* macro_f1: 21.1%
******* Domain 2 best val acc:      63.0%, epoch: 21 *******
******* Domain 2 best val test acc: 49.3%, epoch: 21 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [22/50] batch [20/319] time 0.110 (0.121) data 0.000 (0.026) loss 1.6217 (1.6292) ce_loss 1.2061 (1.1254) teacher_loss 0.8574 (0.8762) loss_zs_kd 1.0344 (0.8911) loss_oracle 0.7643 (0.7529) acc 50.0000 (57.6562) kd_loss 0.8699 (0.8304) lr 1.3090e-03 eta 0:18:37
epoch [22/50] batch [40/319] time 0.092 (0.110) data 0.000 (0.013) loss 1.7480 (1.6325) ce_loss 1.2363 (1.1286) teacher_loss 0.9826 (0.8784) loss_zs_kd 0.9041 (0.8488) loss_oracle 0.7654 (0.7542) acc 46.8750 (56.6406) kd_loss 0.8464 (0.8262) lr 1.3090e-03 eta 0:16:57
epoch [22/50] batch [60/319] time 0.097 (0.107) data 0.001 (0.009) loss 1.4868 (1.6512) ce_loss 1.0889 (1.1504) teacher_loss 0.7336 (0.8978) loss_zs_kd 0.8589 (0.8307) loss_oracle 0.7532 (0.7534) acc 59.3750 (55.8854) kd_loss 0.8083 (0.8307) lr 1.3090e-03 eta 0:16:25
epoch [22/50] batch [80/319] time 0.107 (0.106) data 0.000 (0.007) loss 1.9602 (1.6495) ce_loss 1.5957 (1.1554) teacher_loss 1.2070 (0.8974) loss_zs_kd 0.9678 (0.8451) loss_oracle 0.7532 (0.7521) acc 40.6250 (55.9375) kd_loss 0.8617 (0.8299) lr 1.3090e-03 eta 0:16:11
epoch [22/50] batch [100/319] time 0.102 (0.105) data 0.000 (0.005) loss 1.5145 (1.6505) ce_loss 1.2588 (1.1691) teacher_loss 0.7413 (0.9008) loss_zs_kd 0.7889 (0.8562) loss_oracle 0.7732 (0.7498) acc 43.7500 (55.1250) kd_loss 0.8711 (0.8307) lr 1.3090e-03 eta 0:16:03
epoch [22/50] batch [120/319] time 0.097 (0.104) data 0.000 (0.005) loss 1.9080 (1.6426) ce_loss 1.5879 (1.1779) teacher_loss 1.1963 (0.8929) loss_zs_kd 1.0435 (0.8632) loss_oracle 0.7118 (0.7497) acc 53.1250 (54.7917) kd_loss 0.8740 (0.8326) lr 1.3090e-03 eta 0:15:53
epoch [22/50] batch [140/319] time 0.096 (0.104) data 0.000 (0.004) loss 1.6970 (1.6424) ce_loss 1.1367 (1.1831) teacher_loss 0.9644 (0.8919) loss_zs_kd 0.8688 (0.9028) loss_oracle 0.7326 (0.7505) acc 53.1250 (54.6429) kd_loss 0.8176 (0.8378) lr 1.3090e-03 eta 0:15:48
epoch [22/50] batch [160/319] time 0.107 (0.104) data 0.000 (0.004) loss 1.7311 (1.6413) ce_loss 1.2031 (1.1829) teacher_loss 1.0850 (0.8911) loss_zs_kd 0.7160 (0.9067) loss_oracle 0.6461 (0.7502) acc 53.1250 (54.6680) kd_loss 0.7828 (0.8431) lr 1.3090e-03 eta 0:15:46
epoch [22/50] batch [180/319] time 0.102 (0.104) data 0.000 (0.003) loss 1.9382 (1.6344) ce_loss 1.2969 (1.1736) teacher_loss 1.2022 (0.8825) loss_zs_kd 0.9322 (0.9092) loss_oracle 0.7360 (0.7519) acc 50.0000 (54.8611) kd_loss 0.8733 (0.8419) lr 1.3090e-03 eta 0:15:42
epoch [22/50] batch [200/319] time 0.103 (0.104) data 0.000 (0.003) loss 1.6796 (1.6334) ce_loss 1.2783 (1.1760) teacher_loss 0.9025 (0.8836) loss_zs_kd 0.7911 (0.8999) loss_oracle 0.7771 (0.7498) acc 53.1250 (54.9375) kd_loss 0.8160 (0.8399) lr 1.3090e-03 eta 0:15:39
epoch [22/50] batch [220/319] time 0.107 (0.104) data 0.000 (0.003) loss 1.6798 (1.6363) ce_loss 0.9932 (1.1754) teacher_loss 0.9534 (0.8873) loss_zs_kd 0.7610 (0.8958) loss_oracle 0.7264 (0.7490) acc 71.8750 (55.0710) kd_loss 0.8259 (0.8402) lr 1.3090e-03 eta 0:15:37
epoch [22/50] batch [240/319] time 0.111 (0.104) data 0.000 (0.002) loss 1.7263 (1.6314) ce_loss 1.4131 (1.1687) teacher_loss 1.0134 (0.8824) loss_zs_kd 0.9825 (0.8972) loss_oracle 0.7129 (0.7490) acc 46.8750 (55.2865) kd_loss 0.8108 (0.8404) lr 1.3090e-03 eta 0:15:35
epoch [22/50] batch [260/319] time 0.109 (0.104) data 0.000 (0.002) loss 1.8350 (1.6402) ce_loss 1.1582 (1.1702) teacher_loss 1.1474 (0.8918) loss_zs_kd 0.7809 (0.8979) loss_oracle 0.6875 (0.7484) acc 59.3750 (55.2284) kd_loss 0.7956 (0.8401) lr 1.3090e-03 eta 0:15:32
epoch [22/50] batch [280/319] time 0.095 (0.104) data 0.000 (0.002) loss 1.3257 (1.6405) ce_loss 0.9224 (1.1649) teacher_loss 0.5810 (0.8935) loss_zs_kd 0.7281 (0.8916) loss_oracle 0.7448 (0.7470) acc 65.6250 (55.4129) kd_loss 0.7801 (0.8390) lr 1.3090e-03 eta 0:15:28
epoch [22/50] batch [300/319] time 0.082 (0.102) data 0.000 (0.002) loss 1.6283 (1.6445) ce_loss 1.1748 (1.1655) teacher_loss 0.9164 (0.8985) loss_zs_kd 1.0051 (0.8890) loss_oracle 0.7119 (0.7460) acc 56.2500 (55.3542) kd_loss 0.8398 (0.8377) lr 1.3090e-03 eta 0:15:16
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,675
* accuracy: 61.1%
* error: 38.9%
* macro_f1: 53.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,208
* accuracy: 43.2%
* error: 56.8%
* macro_f1: 22.0%
******* Domain 2 best val acc:      63.0%, epoch: 21 *******
******* Domain 2 best val test acc: 49.3%, epoch: 21 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [23/50] batch [20/319] time 0.116 (0.132) data 0.000 (0.026) loss 1.9767 (1.7109) ce_loss 1.2969 (1.1760) teacher_loss 1.1819 (0.9655) loss_zs_kd 0.7586 (0.8159) loss_oracle 0.7948 (0.7454) acc 50.0000 (53.2812) kd_loss 0.8515 (0.8259) lr 1.2487e-03 eta 0:19:33
epoch [23/50] batch [40/319] time 0.118 (0.117) data 0.000 (0.013) loss 1.6094 (1.7161) ce_loss 1.1270 (1.1821) teacher_loss 0.8570 (0.9703) loss_zs_kd 0.9725 (0.7916) loss_oracle 0.7524 (0.7457) acc 56.2500 (53.9062) kd_loss 0.7992 (0.8216) lr 1.2487e-03 eta 0:17:22
epoch [23/50] batch [60/319] time 0.095 (0.113) data 0.000 (0.009) loss 1.6846 (1.6758) ce_loss 1.2080 (1.1503) teacher_loss 0.9553 (0.9309) loss_zs_kd 0.9185 (0.8165) loss_oracle 0.7293 (0.7449) acc 50.0000 (55.8333) kd_loss 0.7717 (0.8254) lr 1.2487e-03 eta 0:16:38
epoch [23/50] batch [80/319] time 0.111 (0.111) data 0.000 (0.007) loss 1.6476 (1.6859) ce_loss 1.0332 (1.1500) teacher_loss 0.8702 (0.9385) loss_zs_kd 0.8225 (0.8169) loss_oracle 0.7774 (0.7474) acc 59.3750 (55.5859) kd_loss 0.7272 (0.8232) lr 1.2487e-03 eta 0:16:20
epoch [23/50] batch [100/319] time 0.098 (0.110) data 0.000 (0.005) loss 1.5333 (1.6904) ce_loss 0.9990 (1.1541) teacher_loss 0.8249 (0.9447) loss_zs_kd 0.9752 (0.8105) loss_oracle 0.7084 (0.7457) acc 68.7500 (55.0000) kd_loss 0.7392 (0.8222) lr 1.2487e-03 eta 0:16:07
epoch [23/50] batch [120/319] time 0.113 (0.109) data 0.000 (0.005) loss 1.7282 (1.6878) ce_loss 1.1562 (1.1471) teacher_loss 0.9824 (0.9426) loss_zs_kd 0.7819 (0.8059) loss_oracle 0.7458 (0.7452) acc 59.3750 (55.2083) kd_loss 0.7946 (0.8238) lr 1.2487e-03 eta 0:15:58
epoch [23/50] batch [140/319] time 0.105 (0.109) data 0.000 (0.004) loss 1.5260 (1.6838) ce_loss 1.1885 (1.1475) teacher_loss 0.7540 (0.9386) loss_zs_kd 0.6849 (0.8049) loss_oracle 0.7720 (0.7452) acc 50.0000 (55.2455) kd_loss 0.8173 (0.8235) lr 1.2487e-03 eta 0:15:54
epoch [23/50] batch [160/319] time 0.093 (0.108) data 0.000 (0.004) loss 1.5895 (1.6764) ce_loss 1.0039 (1.1468) teacher_loss 0.8450 (0.9299) loss_zs_kd 0.8257 (0.8172) loss_oracle 0.7445 (0.7465) acc 68.7500 (55.3125) kd_loss 0.8342 (0.8267) lr 1.2487e-03 eta 0:15:47
epoch [23/50] batch [180/319] time 0.102 (0.108) data 0.000 (0.003) loss 1.8184 (1.6754) ce_loss 1.2803 (1.1478) teacher_loss 1.0854 (0.9280) loss_zs_kd 0.7518 (0.8222) loss_oracle 0.7330 (0.7474) acc 40.6250 (55.0174) kd_loss 0.7989 (0.8264) lr 1.2487e-03 eta 0:15:41
epoch [23/50] batch [200/319] time 0.129 (0.107) data 0.000 (0.003) loss 1.2838 (1.6751) ce_loss 0.8164 (1.1500) teacher_loss 0.4725 (0.9260) loss_zs_kd 0.6352 (0.8214) loss_oracle 0.8112 (0.7491) acc 68.7500 (55.0938) kd_loss 0.8180 (0.8267) lr 1.2487e-03 eta 0:15:37
epoch [23/50] batch [220/319] time 0.109 (0.107) data 0.000 (0.003) loss 1.9623 (1.6755) ce_loss 1.4268 (1.1515) teacher_loss 1.2002 (0.9255) loss_zs_kd 0.8631 (0.8254) loss_oracle 0.7620 (0.7500) acc 50.0000 (55.1989) kd_loss 0.8333 (0.8284) lr 1.2487e-03 eta 0:15:31
epoch [23/50] batch [240/319] time 0.109 (0.107) data 0.000 (0.002) loss 1.6808 (1.6810) ce_loss 1.2295 (1.1587) teacher_loss 0.9074 (0.9305) loss_zs_kd 0.7757 (0.8218) loss_oracle 0.7734 (0.7505) acc 56.2500 (55.1693) kd_loss 0.7893 (0.8273) lr 1.2487e-03 eta 0:15:29
epoch [23/50] batch [260/319] time 0.117 (0.107) data 0.000 (0.002) loss 1.7953 (1.6843) ce_loss 1.2529 (1.1612) teacher_loss 1.0100 (0.9332) loss_zs_kd 0.8489 (0.8231) loss_oracle 0.7852 (0.7511) acc 50.0000 (55.3005) kd_loss 0.8479 (0.8273) lr 1.2487e-03 eta 0:15:27
epoch [23/50] batch [280/319] time 0.101 (0.107) data 0.000 (0.002) loss 1.3380 (1.6846) ce_loss 1.0010 (1.1625) teacher_loss 0.6523 (0.9326) loss_zs_kd 0.9929 (0.8241) loss_oracle 0.6857 (0.7520) acc 53.1250 (55.1451) kd_loss 0.8598 (0.8274) lr 1.2487e-03 eta 0:15:22
epoch [23/50] batch [300/319] time 0.083 (0.105) data 0.000 (0.002) loss 1.8293 (1.6841) ce_loss 1.2363 (1.1653) teacher_loss 1.0455 (0.9310) loss_zs_kd 0.9950 (0.8261) loss_oracle 0.7838 (0.7531) acc 56.2500 (55.1354) kd_loss 0.8304 (0.8278) lr 1.2487e-03 eta 0:15:09
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,778
* accuracy: 63.5%
* error: 36.5%
* macro_f1: 56.3%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,116
* accuracy: 52.5%
* error: 47.5%
* macro_f1: 22.5%
******* Domain 2 best val acc:      63.5%, epoch: 23 *******
******* Domain 2 best val test acc: 52.5%, epoch: 23 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [24/50] batch [20/319] time 0.117 (0.132) data 0.000 (0.028) loss 1.4071 (1.6314) ce_loss 0.9756 (1.1694) teacher_loss 0.6335 (0.8689) loss_zs_kd 1.0003 (0.9178) loss_oracle 0.7737 (0.7625) acc 62.5000 (56.2500) kd_loss 0.8695 (0.8501) lr 1.1874e-03 eta 0:18:54
epoch [24/50] batch [40/319] time 0.106 (0.118) data 0.000 (0.014) loss 2.1961 (1.6609) ce_loss 1.4189 (1.1639) teacher_loss 1.4165 (0.8967) loss_zs_kd 0.8321 (0.9164) loss_oracle 0.7796 (0.7643) acc 43.7500 (55.6250) kd_loss 0.8462 (0.8447) lr 1.1874e-03 eta 0:16:54
epoch [24/50] batch [60/319] time 0.107 (0.114) data 0.000 (0.009) loss 1.6531 (1.6953) ce_loss 1.2715 (1.1888) teacher_loss 0.8800 (0.9382) loss_zs_kd 0.9737 (0.8847) loss_oracle 0.7731 (0.7571) acc 50.0000 (54.8958) kd_loss 0.8546 (0.8389) lr 1.1874e-03 eta 0:16:17
epoch [24/50] batch [80/319] time 0.098 (0.112) data 0.000 (0.007) loss 1.8012 (1.6929) ce_loss 1.3311 (1.1835) teacher_loss 0.9777 (0.9351) loss_zs_kd 0.9087 (0.8655) loss_oracle 0.8235 (0.7578) acc 43.7500 (55.3516) kd_loss 0.7763 (0.8346) lr 1.1874e-03 eta 0:15:52
epoch [24/50] batch [100/319] time 0.113 (0.111) data 0.000 (0.006) loss 2.0512 (1.6968) ce_loss 1.5469 (1.1764) teacher_loss 1.3140 (0.9402) loss_zs_kd 0.8801 (0.8495) loss_oracle 0.7372 (0.7565) acc 37.5000 (55.2188) kd_loss 0.8126 (0.8332) lr 1.1874e-03 eta 0:15:41
epoch [24/50] batch [120/319] time 0.108 (0.110) data 0.000 (0.005) loss 1.7102 (1.7100) ce_loss 1.1973 (1.1812) teacher_loss 0.9674 (0.9533) loss_zs_kd 0.7497 (0.8431) loss_oracle 0.7428 (0.7567) acc 53.1250 (54.7396) kd_loss 0.8118 (0.8306) lr 1.1874e-03 eta 0:15:32
epoch [24/50] batch [140/319] time 0.102 (0.109) data 0.000 (0.004) loss 1.6033 (1.7040) ce_loss 0.9810 (1.1777) teacher_loss 0.8782 (0.9493) loss_zs_kd 0.9445 (0.8322) loss_oracle 0.7251 (0.7547) acc 71.8750 (54.9330) kd_loss 0.8049 (0.8300) lr 1.1874e-03 eta 0:15:24
epoch [24/50] batch [160/319] time 0.110 (0.109) data 0.000 (0.004) loss 1.6463 (1.6976) ce_loss 1.3770 (1.1716) teacher_loss 0.8737 (0.9430) loss_zs_kd 0.6544 (0.8291) loss_oracle 0.7726 (0.7546) acc 46.8750 (55.0586) kd_loss 0.8222 (0.8288) lr 1.1874e-03 eta 0:15:17
epoch [24/50] batch [180/319] time 0.097 (0.108) data 0.001 (0.003) loss 1.8712 (1.6996) ce_loss 1.3555 (1.1748) teacher_loss 1.1424 (0.9456) loss_zs_kd 0.7478 (0.8355) loss_oracle 0.7289 (0.7540) acc 56.2500 (55.2778) kd_loss 0.7534 (0.8271) lr 1.1874e-03 eta 0:15:12
epoch [24/50] batch [200/319] time 0.091 (0.107) data 0.001 (0.003) loss 1.5945 (1.6944) ce_loss 1.1846 (1.1720) teacher_loss 0.8559 (0.9410) loss_zs_kd 0.7972 (0.8304) loss_oracle 0.7386 (0.7533) acc 59.3750 (55.4531) kd_loss 0.8086 (0.8269) lr 1.1874e-03 eta 0:15:00
epoch [24/50] batch [220/319] time 0.091 (0.106) data 0.000 (0.003) loss 1.8596 (1.6911) ce_loss 1.2979 (1.1709) teacher_loss 1.1256 (0.9376) loss_zs_kd 0.9095 (0.8300) loss_oracle 0.7340 (0.7535) acc 53.1250 (55.4972) kd_loss 0.8878 (0.8273) lr 1.1874e-03 eta 0:14:49
epoch [24/50] batch [240/319] time 0.104 (0.105) data 0.000 (0.003) loss 1.9531 (1.6872) ce_loss 1.3730 (1.1658) teacher_loss 1.1846 (0.9345) loss_zs_kd 0.8922 (0.8276) loss_oracle 0.7685 (0.7527) acc 46.8750 (55.6250) kd_loss 0.8681 (0.8278) lr 1.1874e-03 eta 0:14:39
epoch [24/50] batch [260/319] time 0.098 (0.105) data 0.000 (0.002) loss 1.8605 (1.6858) ce_loss 1.3447 (1.1648) teacher_loss 1.1394 (0.9330) loss_zs_kd 0.6466 (0.8267) loss_oracle 0.7211 (0.7528) acc 50.0000 (55.6971) kd_loss 0.8291 (0.8285) lr 1.1874e-03 eta 0:14:36
epoch [24/50] batch [280/319] time 0.095 (0.105) data 0.000 (0.002) loss 1.8189 (1.6840) ce_loss 1.2676 (1.1673) teacher_loss 1.1016 (0.9315) loss_zs_kd 0.6869 (0.8289) loss_oracle 0.7174 (0.7525) acc 46.8750 (55.6808) kd_loss 0.8627 (0.8289) lr 1.1874e-03 eta 0:14:33
epoch [24/50] batch [300/319] time 0.077 (0.104) data 0.000 (0.002) loss 1.4791 (1.6833) ce_loss 0.9595 (1.1641) teacher_loss 0.7711 (0.9314) loss_zs_kd 0.9811 (0.8277) loss_oracle 0.7081 (0.7519) acc 62.5000 (55.7708) kd_loss 0.8782 (0.8282) lr 1.1874e-03 eta 0:14:24
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,781
* accuracy: 63.5%
* error: 36.5%
* macro_f1: 55.2%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,202
* accuracy: 53.4%
* error: 46.6%
* macro_f1: 22.5%
******* Domain 2 best val acc:      63.5%, epoch: 24 *******
******* Domain 2 best val test acc: 53.4%, epoch: 24 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [25/50] batch [20/319] time 0.101 (0.133) data 0.000 (0.026) loss 1.6976 (1.6612) ce_loss 1.1963 (1.1075) teacher_loss 0.9676 (0.9185) loss_zs_kd 0.8364 (0.8481) loss_oracle 0.7300 (0.7427) acc 65.6250 (59.8438) kd_loss 0.8244 (0.8358) lr 1.1253e-03 eta 0:18:17
epoch [25/50] batch [40/319] time 0.102 (0.118) data 0.000 (0.013) loss 1.8195 (1.7041) ce_loss 1.2021 (1.1239) teacher_loss 1.1216 (0.9629) loss_zs_kd 0.6445 (0.8035) loss_oracle 0.6979 (0.7412) acc 62.5000 (58.2812) kd_loss 0.8168 (0.8259) lr 1.1253e-03 eta 0:16:10
epoch [25/50] batch [60/319] time 0.095 (0.113) data 0.001 (0.009) loss 1.9537 (1.7018) ce_loss 1.2002 (1.1253) teacher_loss 1.2818 (0.9623) loss_zs_kd 0.9400 (0.7832) loss_oracle 0.6719 (0.7395) acc 53.1250 (57.0312) kd_loss 0.8615 (0.8258) lr 1.1253e-03 eta 0:15:30
epoch [25/50] batch [80/319] time 0.086 (0.107) data 0.000 (0.007) loss 1.7497 (1.7144) ce_loss 1.0928 (1.1297) teacher_loss 0.9994 (0.9760) loss_zs_kd 0.7842 (0.7885) loss_oracle 0.7503 (0.7384) acc 50.0000 (56.9922) kd_loss 0.7738 (0.8263) lr 1.1253e-03 eta 0:14:39
epoch [25/50] batch [100/319] time 0.082 (0.103) data 0.000 (0.005) loss 1.9441 (1.7110) ce_loss 1.2646 (1.1163) teacher_loss 1.2580 (0.9812) loss_zs_kd 0.7640 (0.7965) loss_oracle 0.6861 (0.7298) acc 62.5000 (57.4688) kd_loss 0.8165 (0.8290) lr 1.1253e-03 eta 0:14:05
epoch [25/50] batch [120/319] time 0.074 (0.100) data 0.000 (0.005) loss 1.5838 (1.7117) ce_loss 1.0312 (1.1161) teacher_loss 0.8973 (0.9869) loss_zs_kd 1.0110 (0.7947) loss_oracle 0.6866 (0.7247) acc 62.5000 (57.7344) kd_loss 0.8113 (0.8266) lr 1.1253e-03 eta 0:13:40
epoch [25/50] batch [140/319] time 0.082 (0.099) data 0.000 (0.004) loss 1.5002 (1.7055) ce_loss 1.0234 (1.1082) teacher_loss 0.7792 (0.9811) loss_zs_kd 0.9541 (0.7963) loss_oracle 0.7211 (0.7243) acc 56.2500 (58.1250) kd_loss 0.9001 (0.8265) lr 1.1253e-03 eta 0:13:24
epoch [25/50] batch [160/319] time 0.090 (0.097) data 0.000 (0.004) loss 1.5507 (1.7023) ce_loss 1.0908 (1.1082) teacher_loss 0.7910 (0.9763) loss_zs_kd 0.9427 (0.7996) loss_oracle 0.7597 (0.7259) acc 68.7500 (58.1055) kd_loss 0.8476 (0.8278) lr 1.1253e-03 eta 0:13:10
epoch [25/50] batch [180/319] time 0.104 (0.097) data 0.000 (0.003) loss 1.6109 (1.6947) ce_loss 1.0713 (1.1053) teacher_loss 0.8419 (0.9663) loss_zs_kd 0.7508 (0.8087) loss_oracle 0.7691 (0.7283) acc 56.2500 (58.0903) kd_loss 0.8198 (0.8261) lr 1.1253e-03 eta 0:13:05
epoch [25/50] batch [200/319] time 0.104 (0.097) data 0.000 (0.003) loss 1.7597 (1.6883) ce_loss 1.1387 (1.1039) teacher_loss 1.0112 (0.9576) loss_zs_kd 0.9104 (0.8228) loss_oracle 0.7486 (0.7306) acc 46.8750 (57.9844) kd_loss 0.7880 (0.8267) lr 1.1253e-03 eta 0:13:06
epoch [25/50] batch [220/319] time 0.113 (0.098) data 0.000 (0.003) loss 1.5718 (1.6904) ce_loss 1.0000 (1.1079) teacher_loss 0.8621 (0.9574) loss_zs_kd 0.9989 (0.8316) loss_oracle 0.7097 (0.7329) acc 53.1250 (57.8551) kd_loss 0.8113 (0.8274) lr 1.1253e-03 eta 0:13:08
epoch [25/50] batch [240/319] time 0.113 (0.098) data 0.000 (0.002) loss 1.8621 (1.6828) ce_loss 1.2695 (1.1030) teacher_loss 1.0797 (0.9473) loss_zs_kd 0.9890 (0.8390) loss_oracle 0.7824 (0.7354) acc 50.0000 (57.9688) kd_loss 0.8264 (0.8291) lr 1.1253e-03 eta 0:13:09
epoch [25/50] batch [260/319] time 0.096 (0.098) data 0.000 (0.002) loss 1.6172 (1.6834) ce_loss 1.2402 (1.1028) teacher_loss 0.8132 (0.9464) loss_zs_kd 0.9841 (0.8481) loss_oracle 0.8040 (0.7370) acc 40.6250 (57.9327) kd_loss 0.8157 (0.8296) lr 1.1253e-03 eta 0:13:10
epoch [25/50] batch [280/319] time 0.088 (0.098) data 0.000 (0.002) loss 1.6570 (1.6790) ce_loss 1.1143 (1.1044) teacher_loss 0.9595 (0.9412) loss_zs_kd 0.7987 (0.8487) loss_oracle 0.6975 (0.7378) acc 56.2500 (57.9241) kd_loss 0.7942 (0.8304) lr 1.1253e-03 eta 0:13:07
epoch [25/50] batch [300/319] time 0.088 (0.098) data 0.000 (0.002) loss 1.6692 (1.6784) ce_loss 1.1523 (1.1057) teacher_loss 0.9745 (0.9397) loss_zs_kd 0.8179 (0.8509) loss_oracle 0.6947 (0.7386) acc 56.2500 (57.8854) kd_loss 0.7421 (0.8298) lr 1.1253e-03 eta 0:13:02
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,743
* accuracy: 62.7%
* error: 37.3%
* macro_f1: 54.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,206
* accuracy: 53.5%
* error: 46.5%
* macro_f1: 23.3%
******* Domain 2 best val acc:      63.5%, epoch: 24 *******
******* Domain 2 best val test acc: 53.4%, epoch: 24 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [26/50] batch [20/319] time 0.103 (0.128) data 0.000 (0.025) loss 1.6008 (1.7071) ce_loss 1.1572 (1.1961) teacher_loss 0.9113 (0.9759) loss_zs_kd 0.6356 (0.8372) loss_oracle 0.6895 (0.7312) acc 50.0000 (53.1250) kd_loss 0.8145 (0.8282) lr 1.0628e-03 eta 0:17:01
epoch [26/50] batch [40/319] time 0.101 (0.117) data 0.000 (0.013) loss 1.6402 (1.6901) ce_loss 1.0693 (1.1951) teacher_loss 0.9213 (0.9521) loss_zs_kd 0.9346 (0.8254) loss_oracle 0.7189 (0.7381) acc 59.3750 (54.2969) kd_loss 0.8346 (0.8309) lr 1.0628e-03 eta 0:15:29
epoch [26/50] batch [60/319] time 0.105 (0.114) data 0.001 (0.009) loss 1.7269 (1.6585) ce_loss 1.0947 (1.1578) teacher_loss 0.9370 (0.9216) loss_zs_kd 0.7741 (0.8454) loss_oracle 0.7899 (0.7369) acc 65.6250 (56.2500) kd_loss 0.8410 (0.8302) lr 1.0628e-03 eta 0:14:59
epoch [26/50] batch [80/319] time 0.111 (0.111) data 0.000 (0.007) loss 1.7029 (1.6619) ce_loss 1.1816 (1.1703) teacher_loss 0.9124 (0.9227) loss_zs_kd 1.1463 (0.8653) loss_oracle 0.7904 (0.7392) acc 59.3750 (55.5078) kd_loss 0.8170 (0.8314) lr 1.0628e-03 eta 0:14:33
epoch [26/50] batch [100/319] time 0.112 (0.109) data 0.000 (0.005) loss 1.7214 (1.6683) ce_loss 1.1191 (1.1704) teacher_loss 0.9716 (0.9230) loss_zs_kd 0.7770 (0.8769) loss_oracle 0.7498 (0.7453) acc 53.1250 (55.8750) kd_loss 0.8113 (0.8329) lr 1.0628e-03 eta 0:14:21
epoch [26/50] batch [120/319] time 0.110 (0.109) data 0.000 (0.004) loss 1.6113 (1.6521) ce_loss 1.1162 (1.1600) teacher_loss 0.8397 (0.9060) loss_zs_kd 0.9354 (0.8831) loss_oracle 0.7717 (0.7461) acc 56.2500 (56.3281) kd_loss 0.8575 (0.8370) lr 1.0628e-03 eta 0:14:12
epoch [26/50] batch [140/319] time 0.097 (0.108) data 0.000 (0.004) loss 1.7070 (1.6511) ce_loss 1.2021 (1.1508) teacher_loss 0.9892 (0.9041) loss_zs_kd 0.8980 (0.8852) loss_oracle 0.7178 (0.7471) acc 56.2500 (56.5848) kd_loss 0.8558 (0.8382) lr 1.0628e-03 eta 0:14:05
epoch [26/50] batch [160/319] time 0.104 (0.107) data 0.000 (0.003) loss 1.5365 (1.6487) ce_loss 0.9414 (1.1444) teacher_loss 0.7641 (0.9003) loss_zs_kd 0.8146 (0.8833) loss_oracle 0.7724 (0.7483) acc 65.6250 (56.6211) kd_loss 0.8394 (0.8377) lr 1.0628e-03 eta 0:13:58
epoch [26/50] batch [180/319] time 0.103 (0.107) data 0.000 (0.003) loss 1.4325 (1.6456) ce_loss 0.9565 (1.1415) teacher_loss 0.7085 (0.8988) loss_zs_kd 0.8823 (0.8836) loss_oracle 0.7240 (0.7468) acc 62.5000 (56.4757) kd_loss 0.8261 (0.8381) lr 1.0628e-03 eta 0:13:53
epoch [26/50] batch [200/319] time 0.104 (0.106) data 0.000 (0.003) loss 1.9535 (1.6489) ce_loss 1.3711 (1.1384) teacher_loss 1.1865 (0.9033) loss_zs_kd 0.7618 (0.8792) loss_oracle 0.7669 (0.7457) acc 43.7500 (56.3594) kd_loss 0.8101 (0.8370) lr 1.0628e-03 eta 0:13:47
epoch [26/50] batch [220/319] time 0.111 (0.106) data 0.000 (0.003) loss 1.4192 (1.6519) ce_loss 0.7354 (1.1374) teacher_loss 0.7246 (0.9068) loss_zs_kd 0.6605 (0.8757) loss_oracle 0.6945 (0.7451) acc 75.0000 (56.5057) kd_loss 0.7006 (0.8351) lr 1.0628e-03 eta 0:13:44
epoch [26/50] batch [240/319] time 0.103 (0.106) data 0.000 (0.002) loss 1.5830 (1.6559) ce_loss 1.1162 (1.1360) teacher_loss 0.8519 (0.9102) loss_zs_kd 0.8676 (0.8706) loss_oracle 0.7311 (0.7457) acc 75.0000 (56.6016) kd_loss 0.8174 (0.8340) lr 1.0628e-03 eta 0:13:39
epoch [26/50] batch [260/319] time 0.109 (0.106) data 0.000 (0.002) loss 1.6167 (1.6528) ce_loss 0.9741 (1.1318) teacher_loss 0.8951 (0.9074) loss_zs_kd 0.7344 (0.8698) loss_oracle 0.7216 (0.7454) acc 59.3750 (56.8029) kd_loss 0.8623 (0.8345) lr 1.0628e-03 eta 0:13:36
epoch [26/50] batch [280/319] time 0.118 (0.106) data 0.000 (0.002) loss 1.6540 (1.6562) ce_loss 0.9453 (1.1331) teacher_loss 0.8961 (0.9106) loss_zs_kd 0.7539 (0.8690) loss_oracle 0.7579 (0.7456) acc 68.7500 (56.6629) kd_loss 0.8321 (0.8338) lr 1.0628e-03 eta 0:13:33
epoch [26/50] batch [300/319] time 0.081 (0.105) data 0.000 (0.002) loss 2.1260 (1.6618) ce_loss 1.6113 (1.1375) teacher_loss 1.3898 (0.9161) loss_zs_kd 0.8680 (0.8641) loss_oracle 0.7362 (0.7457) acc 40.6250 (56.5000) kd_loss 0.8544 (0.8342) lr 1.0628e-03 eta 0:13:26
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,795
* accuracy: 63.8%
* error: 36.2%
* macro_f1: 55.7%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,075
* accuracy: 52.1%
* error: 47.9%
* macro_f1: 22.7%
******* Domain 2 best val acc:      63.8%, epoch: 26 *******
******* Domain 2 best val test acc: 52.1%, epoch: 26 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [27/50] batch [20/319] time 0.099 (0.126) data 0.000 (0.026) loss 1.3806 (1.6553) ce_loss 0.9731 (1.1211) teacher_loss 0.6807 (0.9138) loss_zs_kd 0.6180 (0.8319) loss_oracle 0.7000 (0.7414) acc 56.2500 (54.5312) kd_loss 0.8575 (0.8393) lr 1.0000e-03 eta 0:16:04
epoch [27/50] batch [40/319] time 0.098 (0.113) data 0.000 (0.013) loss 1.4295 (1.6583) ce_loss 0.9844 (1.1250) teacher_loss 0.6313 (0.9112) loss_zs_kd 1.0735 (0.8536) loss_oracle 0.7982 (0.7471) acc 68.7500 (55.8594) kd_loss 0.7824 (0.8261) lr 1.0000e-03 eta 0:14:22
epoch [27/50] batch [60/319] time 0.096 (0.109) data 0.000 (0.009) loss 1.4598 (1.6322) ce_loss 1.0059 (1.1023) teacher_loss 0.7151 (0.8867) loss_zs_kd 1.0288 (0.8409) loss_oracle 0.7448 (0.7455) acc 62.5000 (57.7083) kd_loss 0.8592 (0.8260) lr 1.0000e-03 eta 0:13:48
epoch [27/50] batch [80/319] time 0.098 (0.107) data 0.000 (0.007) loss 1.8658 (1.6375) ce_loss 1.4150 (1.1016) teacher_loss 1.0741 (0.8922) loss_zs_kd 0.8539 (0.8357) loss_oracle 0.7917 (0.7453) acc 50.0000 (58.0078) kd_loss 0.8463 (0.8262) lr 1.0000e-03 eta 0:13:28
epoch [27/50] batch [100/319] time 0.098 (0.106) data 0.000 (0.005) loss 1.5006 (1.6343) ce_loss 0.9048 (1.0906) teacher_loss 0.7882 (0.8945) loss_zs_kd 0.9158 (0.8430) loss_oracle 0.7124 (0.7398) acc 65.6250 (58.5625) kd_loss 0.8832 (0.8235) lr 1.0000e-03 eta 0:13:20
epoch [27/50] batch [120/319] time 0.097 (0.105) data 0.000 (0.005) loss 1.5745 (1.6385) ce_loss 0.9712 (1.0903) teacher_loss 0.8307 (0.8992) loss_zs_kd 1.0067 (0.8617) loss_oracle 0.7439 (0.7393) acc 68.7500 (58.3854) kd_loss 0.8619 (0.8236) lr 1.0000e-03 eta 0:13:10
epoch [27/50] batch [140/319] time 0.114 (0.105) data 0.000 (0.004) loss 1.6008 (1.6406) ce_loss 1.0713 (1.0932) teacher_loss 0.8372 (0.9004) loss_zs_kd 0.9767 (0.8695) loss_oracle 0.7635 (0.7402) acc 56.2500 (58.0580) kd_loss 0.7991 (0.8232) lr 1.0000e-03 eta 0:13:06
epoch [27/50] batch [160/319] time 0.100 (0.105) data 0.000 (0.004) loss 1.4875 (1.6339) ce_loss 0.8784 (1.0917) teacher_loss 0.7648 (0.8944) loss_zs_kd 0.9791 (0.8875) loss_oracle 0.7227 (0.7395) acc 62.5000 (58.1641) kd_loss 0.8129 (0.8247) lr 1.0000e-03 eta 0:13:06
epoch [27/50] batch [180/319] time 0.102 (0.105) data 0.000 (0.003) loss 1.4191 (1.6365) ce_loss 0.8604 (1.0944) teacher_loss 0.7391 (0.8977) loss_zs_kd 0.8730 (0.8914) loss_oracle 0.6800 (0.7388) acc 68.7500 (58.1771) kd_loss 0.8291 (0.8260) lr 1.0000e-03 eta 0:13:02
epoch [27/50] batch [200/319] time 0.098 (0.104) data 0.000 (0.003) loss 1.5113 (1.6385) ce_loss 1.0068 (1.0980) teacher_loss 0.7285 (0.8976) loss_zs_kd 1.1714 (0.8995) loss_oracle 0.7828 (0.7409) acc 56.2500 (57.9688) kd_loss 0.8535 (0.8263) lr 1.0000e-03 eta 0:12:52
epoch [27/50] batch [220/319] time 0.089 (0.103) data 0.000 (0.003) loss 1.6975 (1.6332) ce_loss 1.1348 (1.1006) teacher_loss 0.9112 (0.8900) loss_zs_kd 0.9468 (0.9053) loss_oracle 0.7863 (0.7432) acc 53.1250 (57.8551) kd_loss 0.8371 (0.8290) lr 1.0000e-03 eta 0:12:44
epoch [27/50] batch [240/319] time 0.102 (0.103) data 0.000 (0.002) loss 1.7603 (1.6385) ce_loss 1.2705 (1.1076) teacher_loss 0.9835 (0.8934) loss_zs_kd 0.7855 (0.9081) loss_oracle 0.7769 (0.7451) acc 43.7500 (57.6302) kd_loss 0.8771 (0.8296) lr 1.0000e-03 eta 0:12:40
epoch [27/50] batch [260/319] time 0.097 (0.102) data 0.000 (0.002) loss 1.4983 (1.6366) ce_loss 1.0283 (1.1092) teacher_loss 0.7002 (0.8900) loss_zs_kd 0.9986 (0.9058) loss_oracle 0.7981 (0.7466) acc 59.3750 (57.6562) kd_loss 0.8464 (0.8297) lr 1.0000e-03 eta 0:12:35
epoch [27/50] batch [280/319] time 0.109 (0.102) data 0.000 (0.002) loss 1.9225 (1.6420) ce_loss 1.4980 (1.1153) teacher_loss 1.1398 (0.8943) loss_zs_kd 1.0401 (0.9046) loss_oracle 0.7828 (0.7477) acc 34.3750 (57.4330) kd_loss 0.8562 (0.8301) lr 1.0000e-03 eta 0:12:32
epoch [27/50] batch [300/319] time 0.095 (0.102) data 0.000 (0.002) loss 1.9066 (1.6389) ce_loss 1.3926 (1.1158) teacher_loss 1.1568 (0.8907) loss_zs_kd 1.0521 (0.9000) loss_oracle 0.7497 (0.7482) acc 46.8750 (57.3750) kd_loss 0.8342 (0.8305) lr 1.0000e-03 eta 0:12:29
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,771
* accuracy: 63.3%
* error: 36.7%
* macro_f1: 55.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,094
* accuracy: 52.3%
* error: 47.7%
* macro_f1: 23.6%
******* Domain 2 best val acc:      63.8%, epoch: 26 *******
******* Domain 2 best val test acc: 52.1%, epoch: 26 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [28/50] batch [20/319] time 0.095 (0.136) data 0.000 (0.032) loss 1.5021 (1.5817) ce_loss 1.0576 (1.0877) teacher_loss 0.7484 (0.8252) loss_zs_kd 1.0200 (0.9180) loss_oracle 0.7537 (0.7565) acc 59.3750 (56.4062) kd_loss 0.8657 (0.8452) lr 9.3721e-04 eta 0:16:37
epoch [28/50] batch [40/319] time 0.107 (0.120) data 0.000 (0.016) loss 1.7493 (1.5953) ce_loss 1.1807 (1.0841) teacher_loss 1.0115 (0.8449) loss_zs_kd 1.0428 (0.8979) loss_oracle 0.7379 (0.7504) acc 53.1250 (58.6719) kd_loss 0.9062 (0.8471) lr 9.3721e-04 eta 0:14:38
epoch [28/50] batch [60/319] time 0.103 (0.115) data 0.001 (0.011) loss 1.5328 (1.6286) ce_loss 1.0508 (1.1134) teacher_loss 0.7513 (0.8721) loss_zs_kd 0.9415 (0.9155) loss_oracle 0.7815 (0.7565) acc 56.2500 (57.3438) kd_loss 0.8316 (0.8453) lr 9.3721e-04 eta 0:13:56
epoch [28/50] batch [80/319] time 0.106 (0.112) data 0.000 (0.008) loss 1.6330 (1.6102) ce_loss 1.1709 (1.1063) teacher_loss 0.8725 (0.8515) loss_zs_kd 0.8954 (0.9186) loss_oracle 0.7605 (0.7587) acc 43.7500 (57.2656) kd_loss 0.8464 (0.8474) lr 9.3721e-04 eta 0:13:32
epoch [28/50] batch [100/319] time 0.101 (0.110) data 0.000 (0.007) loss 1.6704 (1.6111) ce_loss 1.1436 (1.1090) teacher_loss 0.8941 (0.8510) loss_zs_kd 1.0807 (0.9430) loss_oracle 0.7763 (0.7601) acc 46.8750 (57.6562) kd_loss 0.8228 (0.8458) lr 9.3721e-04 eta 0:13:12
epoch [28/50] batch [120/319] time 0.109 (0.108) data 0.000 (0.006) loss 1.5579 (1.6077) ce_loss 1.0957 (1.1030) teacher_loss 0.7881 (0.8500) loss_zs_kd 1.0666 (0.9454) loss_oracle 0.7698 (0.7577) acc 59.3750 (57.7344) kd_loss 0.8082 (0.8448) lr 9.3721e-04 eta 0:12:59
epoch [28/50] batch [140/319] time 0.095 (0.107) data 0.000 (0.005) loss 1.6146 (1.6134) ce_loss 1.0684 (1.1075) teacher_loss 0.8572 (0.8563) loss_zs_kd 0.9837 (0.9416) loss_oracle 0.7574 (0.7571) acc 53.1250 (57.7232) kd_loss 0.7861 (0.8432) lr 9.3721e-04 eta 0:12:52
epoch [28/50] batch [160/319] time 0.100 (0.107) data 0.000 (0.004) loss 1.3163 (1.6082) ce_loss 0.8384 (1.1039) teacher_loss 0.5883 (0.8521) loss_zs_kd 1.1328 (0.9310) loss_oracle 0.7280 (0.7561) acc 65.6250 (57.5781) kd_loss 0.8404 (0.8420) lr 9.3721e-04 eta 0:12:46
epoch [28/50] batch [180/319] time 0.103 (0.106) data 0.000 (0.004) loss 1.5085 (1.6004) ce_loss 0.9355 (1.0939) teacher_loss 0.7310 (0.8442) loss_zs_kd 0.9124 (0.9287) loss_oracle 0.7775 (0.7562) acc 65.6250 (58.0556) kd_loss 0.8378 (0.8412) lr 9.3721e-04 eta 0:12:41
epoch [28/50] batch [200/319] time 0.109 (0.106) data 0.000 (0.003) loss 1.7039 (1.6053) ce_loss 1.3252 (1.0967) teacher_loss 0.9210 (0.8491) loss_zs_kd 0.9188 (0.9298) loss_oracle 0.7829 (0.7562) acc 40.6250 (58.0625) kd_loss 0.8111 (0.8420) lr 9.3721e-04 eta 0:12:36
epoch [28/50] batch [220/319] time 0.104 (0.106) data 0.000 (0.003) loss 1.9229 (1.6098) ce_loss 1.2061 (1.1018) teacher_loss 1.1399 (0.8540) loss_zs_kd 0.8519 (0.9324) loss_oracle 0.7829 (0.7558) acc 56.2500 (57.9119) kd_loss 0.8965 (0.8427) lr 9.3721e-04 eta 0:12:31
epoch [28/50] batch [240/319] time 0.101 (0.106) data 0.000 (0.003) loss 1.5391 (1.6092) ce_loss 1.1143 (1.1004) teacher_loss 0.7923 (0.8534) loss_zs_kd 1.0178 (0.9396) loss_oracle 0.7468 (0.7558) acc 56.2500 (57.9297) kd_loss 0.8498 (0.8420) lr 9.3721e-04 eta 0:12:30
epoch [28/50] batch [260/319] time 0.106 (0.106) data 0.000 (0.003) loss 1.4403 (1.6047) ce_loss 0.9082 (1.1019) teacher_loss 0.6722 (0.8487) loss_zs_kd 1.1099 (0.9432) loss_oracle 0.7681 (0.7560) acc 62.5000 (57.8486) kd_loss 0.9077 (0.8410) lr 9.3721e-04 eta 0:12:27
epoch [28/50] batch [280/319] time 0.094 (0.105) data 0.000 (0.003) loss 1.4660 (1.6036) ce_loss 0.9717 (1.1022) teacher_loss 0.7218 (0.8485) loss_zs_kd 0.9732 (0.9471) loss_oracle 0.7442 (0.7551) acc 65.6250 (57.7902) kd_loss 0.8553 (0.8408) lr 9.3721e-04 eta 0:12:23
epoch [28/50] batch [300/319] time 0.102 (0.105) data 0.000 (0.002) loss 1.7421 (1.6049) ce_loss 1.3330 (1.1060) teacher_loss 0.9792 (0.8499) loss_zs_kd 0.8388 (0.9488) loss_oracle 0.7629 (0.7550) acc 46.8750 (57.7396) kd_loss 0.8287 (0.8401) lr 9.3721e-04 eta 0:12:19
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,726
* accuracy: 62.3%
* error: 37.7%
* macro_f1: 55.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,465
* accuracy: 45.9%
* error: 54.1%
* macro_f1: 21.6%
******* Domain 2 best val acc:      63.8%, epoch: 26 *******
******* Domain 2 best val test acc: 52.1%, epoch: 26 *******
******* Domain 2 best test acc:     56.3%, epoch: 13 *******
epoch [29/50] batch [20/319] time 0.106 (0.131) data 0.000 (0.023) loss 1.7192 (1.6308) ce_loss 1.4434 (1.1361) teacher_loss 0.9621 (0.8925) loss_zs_kd 0.7998 (0.8166) loss_oracle 0.7571 (0.7383) acc 43.7500 (57.9688) kd_loss 0.8316 (0.8295) lr 8.7467e-04 eta 0:15:14
epoch [29/50] batch [40/319] time 0.103 (0.118) data 0.000 (0.012) loss 1.5390 (1.6024) ce_loss 1.0928 (1.1218) teacher_loss 0.7964 (0.8596) loss_zs_kd 0.8787 (0.8440) loss_oracle 0.7426 (0.7428) acc 68.7500 (57.6562) kd_loss 0.8289 (0.8297) lr 8.7467e-04 eta 0:13:40
epoch [29/50] batch [60/319] time 0.112 (0.113) data 0.000 (0.008) loss 1.3951 (1.6069) ce_loss 0.9688 (1.1278) teacher_loss 0.6244 (0.8607) loss_zs_kd 0.9226 (0.8695) loss_oracle 0.7706 (0.7462) acc 59.3750 (57.6562) kd_loss 0.8434 (0.8349) lr 8.7467e-04 eta 0:13:07
epoch [29/50] batch [80/319] time 0.094 (0.109) data 0.000 (0.006) loss 1.5466 (1.6026) ce_loss 1.0557 (1.1241) teacher_loss 0.7783 (0.8588) loss_zs_kd 1.0525 (0.8925) loss_oracle 0.7684 (0.7438) acc 68.7500 (58.3594) kd_loss 0.8416 (0.8337) lr 8.7467e-04 eta 0:12:39
epoch [29/50] batch [100/319] time 0.086 (0.105) data 0.000 (0.005) loss 1.7236 (1.6023) ce_loss 1.0859 (1.1203) teacher_loss 1.0034 (0.8573) loss_zs_kd 1.2095 (0.9049) loss_oracle 0.7203 (0.7450) acc 59.3750 (58.3438) kd_loss 0.7962 (0.8361) lr 8.7467e-04 eta 0:12:08
epoch [29/50] batch [120/319] time 0.100 (0.103) data 0.000 (0.004) loss 1.4798 (1.6003) ce_loss 1.0225 (1.1148) teacher_loss 0.7540 (0.8546) loss_zs_kd 0.8492 (0.9100) loss_oracle 0.7258 (0.7457) acc 65.6250 (58.2552) kd_loss 0.8413 (0.8355) lr 8.7467e-04 eta 0:11:50
epoch [29/50] batch [140/319] time 0.100 (0.101) data 0.000 (0.003) loss 1.8711 (1.6045) ce_loss 1.3672 (1.1098) teacher_loss 1.1138 (0.8594) loss_zs_kd 1.1125 (0.9148) loss_oracle 0.7574 (0.7451) acc 46.8750 (58.4375) kd_loss 0.8357 (0.8362) lr 8.7467e-04 eta 0:11:37
epoch [29/50] batch [160/319] time 0.109 (0.101) data 0.000 (0.003) loss 2.0590 (1.6174) ce_loss 1.1660 (1.1176) teacher_loss 1.3050 (0.8717) loss_zs_kd 0.7825 (0.9166) loss_oracle 0.7541 (0.7457) acc 59.3750 (58.2422) kd_loss 0.8312 (0.8349) lr 8.7467e-04 eta 0:11:34
epoch [29/50] batch [180/319] time 0.099 (0.101) data 0.000 (0.003) loss 1.6699 (1.6256) ce_loss 1.1709 (1.1170) teacher_loss 0.9418 (0.8799) loss_zs_kd 0.6158 (0.9124) loss_oracle 0.7282 (0.7457) acc 56.2500 (58.1771) kd_loss 0.8835 (0.8341) lr 8.7467e-04 eta 0:11:31
epoch [29/50] batch [200/319] time 0.110 (0.101) data 0.000 (0.002) loss 1.5978 (1.6333) ce_loss 1.1250 (1.1204) teacher_loss 0.8843 (0.8893) loss_zs_kd 0.9483 (0.9066) loss_oracle 0.7135 (0.7440) acc 56.2500 (58.0625) kd_loss 0.8411 (0.8339) lr 8.7467e-04 eta 0:11:30
epoch [29/50] batch [220/319] time 0.108 (0.101) data 0.000 (0.002) loss 2.0631 (1.6322) ce_loss 1.4912 (1.1182) teacher_loss 1.3006 (0.8885) loss_zs_kd 0.7743 (0.8967) loss_oracle 0.7625 (0.7438) acc 40.6250 (58.0256) kd_loss 0.7774 (0.8338) lr 8.7467e-04 eta 0:11:29
epoch [29/50] batch [240/319] time 0.102 (0.102) data 0.000 (0.002) loss 1.7551 (1.6333) ce_loss 1.1758 (1.1164) teacher_loss 1.0112 (0.8891) loss_zs_kd 1.0746 (0.9062) loss_oracle 0.7439 (0.7441) acc 62.5000 (58.2292) kd_loss 0.7825 (0.8339) lr 8.7467e-04 eta 0:11:28
epoch [29/50] batch [260/319] time 0.110 (0.102) data 0.000 (0.002) loss 1.5610 (1.6374) ce_loss 1.0059 (1.1179) teacher_loss 0.8596 (0.8936) loss_zs_kd 1.1223 (0.9155) loss_oracle 0.7014 (0.7438) acc 65.6250 (58.1010) kd_loss 0.8244 (0.8346) lr 8.7467e-04 eta 0:11:27
epoch [29/50] batch [280/319] time 0.082 (0.101) data 0.000 (0.002) loss 1.6182 (1.6376) ce_loss 1.1816 (1.1159) teacher_loss 0.8595 (0.8949) loss_zs_kd 1.0771 (0.9246) loss_oracle 0.7587 (0.7427) acc 56.2500 (58.2478) kd_loss 0.8550 (0.8336) lr 8.7467e-04 eta 0:11:23
epoch [29/50] batch [300/319] time 0.094 (0.101) data 0.000 (0.002) loss 1.8573 (1.6407) ce_loss 1.3174 (1.1164) teacher_loss 1.1502 (0.8983) loss_zs_kd 1.0112 (0.9297) loss_oracle 0.7071 (0.7424) acc 46.8750 (58.2292) kd_loss 0.7641 (0.8332) lr 8.7467e-04 eta 0:11:19
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,760
* accuracy: 63.0%
* error: 37.0%
* macro_f1: 55.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,545
* accuracy: 57.0%
* error: 43.0%
* macro_f1: 23.7%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      63.8%, epoch: 26 *******
******* Domain 2 best val test acc: 52.1%, epoch: 26 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [30/50] batch [20/319] time 0.093 (0.118) data 0.000 (0.024) loss 1.3768 (1.6523) ce_loss 0.9263 (1.1804) teacher_loss 0.5961 (0.9023) loss_zs_kd 1.0200 (0.9754) loss_oracle 0.7807 (0.7500) acc 68.7500 (57.1875) kd_loss 0.8542 (0.8501) lr 8.1262e-04 eta 0:13:09
epoch [30/50] batch [40/319] time 0.094 (0.107) data 0.000 (0.012) loss 1.3704 (1.6628) ce_loss 1.1318 (1.1523) teacher_loss 0.5795 (0.9116) loss_zs_kd 0.9557 (1.0155) loss_oracle 0.7909 (0.7512) acc 56.2500 (56.7969) kd_loss 0.8867 (0.8556) lr 8.1262e-04 eta 0:11:54
epoch [30/50] batch [60/319] time 0.105 (0.106) data 0.000 (0.008) loss 1.5254 (1.6608) ce_loss 1.0049 (1.1357) teacher_loss 0.7981 (0.9134) loss_zs_kd 1.0295 (1.0122) loss_oracle 0.7273 (0.7474) acc 65.6250 (57.7604) kd_loss 0.8710 (0.8534) lr 8.1262e-04 eta 0:11:40
epoch [30/50] batch [80/319] time 0.096 (0.104) data 0.000 (0.006) loss 1.7145 (1.6638) ce_loss 1.1816 (1.1291) teacher_loss 1.0015 (0.9156) loss_zs_kd 0.8061 (1.0084) loss_oracle 0.7130 (0.7482) acc 59.3750 (57.8125) kd_loss 0.8283 (0.8493) lr 8.1262e-04 eta 0:11:29
epoch [30/50] batch [100/319] time 0.099 (0.103) data 0.000 (0.005) loss 1.6210 (1.6695) ce_loss 0.9360 (1.1286) teacher_loss 0.8947 (0.9205) loss_zs_kd 1.0205 (0.9951) loss_oracle 0.7263 (0.7490) acc 65.6250 (57.7188) kd_loss 0.8465 (0.8455) lr 8.1262e-04 eta 0:11:21
epoch [30/50] batch [120/319] time 0.106 (0.103) data 0.000 (0.004) loss 1.7852 (1.6728) ce_loss 1.1279 (1.1278) teacher_loss 0.9941 (0.9259) loss_zs_kd 0.9420 (0.9835) loss_oracle 0.7911 (0.7469) acc 59.3750 (57.6823) kd_loss 0.8909 (0.8447) lr 8.1262e-04 eta 0:11:18
epoch [30/50] batch [140/319] time 0.086 (0.100) data 0.000 (0.004) loss 1.4850 (1.6625) ce_loss 0.8926 (1.1193) teacher_loss 0.6828 (0.9162) loss_zs_kd 0.8476 (0.9704) loss_oracle 0.8022 (0.7463) acc 65.6250 (57.9241) kd_loss 0.8148 (0.8419) lr 8.1262e-04 eta 0:10:57
epoch [30/50] batch [160/319] time 0.082 (0.098) data 0.000 (0.003) loss 1.4615 (1.6598) ce_loss 1.1240 (1.1151) teacher_loss 0.7298 (0.9157) loss_zs_kd 0.6182 (0.9534) loss_oracle 0.7317 (0.7441) acc 56.2500 (57.9492) kd_loss 0.8249 (0.8393) lr 8.1262e-04 eta 0:10:42
epoch [30/50] batch [180/319] time 0.081 (0.097) data 0.000 (0.003) loss 1.6170 (1.6552) ce_loss 1.0566 (1.1127) teacher_loss 0.8749 (0.9130) loss_zs_kd 0.9460 (0.9448) loss_oracle 0.7420 (0.7422) acc 59.3750 (57.7778) kd_loss 0.8485 (0.8410) lr 8.1262e-04 eta 0:10:30
epoch [30/50] batch [200/319] time 0.088 (0.098) data 0.000 (0.003) loss 1.6886 (1.6484) ce_loss 1.0635 (1.1063) teacher_loss 0.9728 (0.9068) loss_zs_kd 0.9653 (0.9473) loss_oracle 0.7159 (0.7417) acc 62.5000 (58.0312) kd_loss 0.9174 (0.8415) lr 8.1262e-04 eta 0:10:36
epoch [30/50] batch [220/319] time 0.079 (0.096) data 0.000 (0.002) loss 1.6193 (1.6473) ce_loss 0.9268 (1.1061) teacher_loss 0.8839 (0.9043) loss_zs_kd 1.0021 (0.9564) loss_oracle 0.7354 (0.7430) acc 71.8750 (58.1960) kd_loss 0.9173 (0.8419) lr 8.1262e-04 eta 0:10:24
epoch [30/50] batch [240/319] time 0.081 (0.095) data 0.000 (0.002) loss 1.6858 (1.6539) ce_loss 1.1270 (1.1144) teacher_loss 0.9558 (0.9114) loss_zs_kd 0.9130 (0.9566) loss_oracle 0.7301 (0.7425) acc 56.2500 (57.6172) kd_loss 0.8798 (0.8419) lr 8.1262e-04 eta 0:10:15
epoch [30/50] batch [260/319] time 0.091 (0.094) data 0.000 (0.002) loss 1.6624 (1.6526) ce_loss 1.1611 (1.1170) teacher_loss 0.9552 (0.9119) loss_zs_kd 0.8127 (0.9499) loss_oracle 0.7072 (0.7407) acc 50.0000 (57.3798) kd_loss 0.7987 (0.8400) lr 8.1262e-04 eta 0:10:07
epoch [30/50] batch [280/319] time 0.087 (0.094) data 0.000 (0.002) loss 1.6522 (1.6494) ce_loss 1.0576 (1.1118) teacher_loss 0.9253 (0.9097) loss_zs_kd 0.8096 (0.9463) loss_oracle 0.7269 (0.7397) acc 56.2500 (57.5223) kd_loss 0.8343 (0.8398) lr 8.1262e-04 eta 0:10:01
epoch [30/50] batch [300/319] time 0.087 (0.094) data 0.000 (0.002) loss 1.9299 (1.6483) ce_loss 1.5127 (1.1109) teacher_loss 1.1997 (0.9094) loss_zs_kd 0.8892 (0.9431) loss_oracle 0.7302 (0.7389) acc 34.3750 (57.5521) kd_loss 0.8700 (0.8401) lr 8.1262e-04 eta 0:09:58
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,818
* accuracy: 64.4%
* error: 35.6%
* macro_f1: 56.2%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,351
* accuracy: 55.0%
* error: 45.0%
* macro_f1: 23.3%
******* Domain 2 best val acc:      64.4%, epoch: 30 *******
******* Domain 2 best val test acc: 55.0%, epoch: 30 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [31/50] batch [20/319] time 0.088 (0.113) data 0.000 (0.027) loss 1.4744 (1.5420) ce_loss 0.9722 (1.0138) teacher_loss 0.7404 (0.8082) loss_zs_kd 1.1202 (0.9442) loss_oracle 0.7340 (0.7338) acc 62.5000 (60.6250) kd_loss 0.8242 (0.8317) lr 7.5131e-04 eta 0:11:59
epoch [31/50] batch [40/319] time 0.083 (0.099) data 0.000 (0.014) loss 1.5076 (1.5696) ce_loss 1.0898 (1.0363) teacher_loss 0.8088 (0.8300) loss_zs_kd 0.8659 (0.9707) loss_oracle 0.6989 (0.7397) acc 56.2500 (60.0781) kd_loss 0.7833 (0.8341) lr 7.5131e-04 eta 0:10:26
epoch [31/50] batch [60/319] time 0.080 (0.092) data 0.000 (0.009) loss 1.5965 (1.6076) ce_loss 1.0977 (1.0632) teacher_loss 0.9201 (0.8715) loss_zs_kd 0.9413 (0.9599) loss_oracle 0.6764 (0.7361) acc 56.2500 (59.2708) kd_loss 0.8474 (0.8305) lr 7.5131e-04 eta 0:09:42
epoch [31/50] batch [80/319] time 0.083 (0.090) data 0.000 (0.007) loss 1.6297 (1.6160) ce_loss 1.3154 (1.0866) teacher_loss 0.9311 (0.8800) loss_zs_kd 0.8567 (0.9506) loss_oracle 0.6987 (0.7360) acc 40.6250 (58.1641) kd_loss 0.7875 (0.8302) lr 7.5131e-04 eta 0:09:26
epoch [31/50] batch [100/319] time 0.086 (0.089) data 0.000 (0.006) loss 1.6831 (1.6147) ce_loss 1.2178 (1.0866) teacher_loss 0.9212 (0.8742) loss_zs_kd 1.1462 (0.9509) loss_oracle 0.7619 (0.7405) acc 59.3750 (58.3125) kd_loss 0.8235 (0.8295) lr 7.5131e-04 eta 0:09:19
epoch [31/50] batch [120/319] time 0.080 (0.088) data 0.000 (0.005) loss 1.4248 (1.6242) ce_loss 1.0098 (1.0965) teacher_loss 0.6804 (0.8839) loss_zs_kd 0.8642 (0.9431) loss_oracle 0.7443 (0.7402) acc 50.0000 (57.7865) kd_loss 0.8441 (0.8325) lr 7.5131e-04 eta 0:09:11
epoch [31/50] batch [140/319] time 0.084 (0.088) data 0.000 (0.004) loss 1.5002 (1.6317) ce_loss 1.0664 (1.1060) teacher_loss 0.7604 (0.8909) loss_zs_kd 1.0934 (0.9441) loss_oracle 0.7398 (0.7408) acc 62.5000 (57.1429) kd_loss 0.8337 (0.8331) lr 7.5131e-04 eta 0:09:06
epoch [31/50] batch [160/319] time 0.086 (0.087) data 0.000 (0.004) loss 1.8284 (1.6347) ce_loss 1.0967 (1.1039) teacher_loss 1.1417 (0.8947) loss_zs_kd 1.0848 (0.9557) loss_oracle 0.6867 (0.7401) acc 59.3750 (57.4023) kd_loss 0.8943 (0.8337) lr 7.5131e-04 eta 0:09:02
epoch [31/50] batch [180/319] time 0.090 (0.087) data 0.000 (0.003) loss 1.8893 (1.6399) ce_loss 1.3604 (1.1091) teacher_loss 1.1545 (0.8993) loss_zs_kd 0.9582 (0.9607) loss_oracle 0.7347 (0.7406) acc 59.3750 (57.5174) kd_loss 0.8591 (0.8339) lr 7.5131e-04 eta 0:08:59
epoch [31/50] batch [200/319] time 0.095 (0.087) data 0.000 (0.003) loss 1.5199 (1.6411) ce_loss 1.1895 (1.1114) teacher_loss 0.8021 (0.8998) loss_zs_kd 0.9707 (0.9680) loss_oracle 0.7178 (0.7413) acc 53.1250 (57.4062) kd_loss 0.7937 (0.8342) lr 7.5131e-04 eta 0:08:55
epoch [31/50] batch [220/319] time 0.084 (0.086) data 0.000 (0.003) loss 1.5199 (1.6434) ce_loss 0.9814 (1.1108) teacher_loss 0.7681 (0.9018) loss_zs_kd 1.1572 (0.9693) loss_oracle 0.7517 (0.7415) acc 68.7500 (57.4432) kd_loss 0.8557 (0.8341) lr 7.5131e-04 eta 0:08:52
epoch [31/50] batch [240/319] time 0.087 (0.086) data 0.000 (0.003) loss 1.5891 (1.6417) ce_loss 1.1758 (1.1091) teacher_loss 0.8911 (0.9018) loss_zs_kd 0.6847 (0.9649) loss_oracle 0.6980 (0.7399) acc 56.2500 (57.4740) kd_loss 0.8248 (0.8324) lr 7.5131e-04 eta 0:08:50
epoch [31/50] batch [260/319] time 0.094 (0.087) data 0.000 (0.002) loss 1.6669 (1.6378) ce_loss 1.2549 (1.1070) teacher_loss 0.9333 (0.8974) loss_zs_kd 1.0939 (0.9647) loss_oracle 0.7336 (0.7404) acc 53.1250 (57.5841) kd_loss 0.8315 (0.8330) lr 7.5131e-04 eta 0:08:52
epoch [31/50] batch [280/319] time 0.091 (0.087) data 0.000 (0.002) loss 1.6786 (1.6424) ce_loss 1.1445 (1.1127) teacher_loss 0.9588 (0.9021) loss_zs_kd 1.0823 (0.9659) loss_oracle 0.7198 (0.7403) acc 43.7500 (57.1763) kd_loss 0.8583 (0.8334) lr 7.5131e-04 eta 0:08:51
epoch [31/50] batch [300/319] time 0.096 (0.087) data 0.000 (0.002) loss 1.2795 (1.6449) ce_loss 0.8232 (1.1139) teacher_loss 0.5490 (0.9044) loss_zs_kd 0.9339 (0.9663) loss_oracle 0.7305 (0.7405) acc 68.7500 (57.2083) kd_loss 0.8210 (0.8325) lr 7.5131e-04 eta 0:08:48
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,721
* accuracy: 62.2%
* error: 37.8%
* macro_f1: 53.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,387
* accuracy: 55.3%
* error: 44.7%
* macro_f1: 22.7%
******* Domain 2 best val acc:      64.4%, epoch: 30 *******
******* Domain 2 best val test acc: 55.0%, epoch: 30 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [32/50] batch [20/319] time 0.083 (0.117) data 0.000 (0.027) loss 1.7013 (1.6621) ce_loss 1.0654 (1.1317) teacher_loss 1.0334 (0.9253) loss_zs_kd 1.2290 (0.9959) loss_oracle 0.6679 (0.7369) acc 56.2500 (55.1562) kd_loss 0.8518 (0.8312) lr 6.9098e-04 eta 0:11:45
epoch [32/50] batch [40/319] time 0.079 (0.100) data 0.000 (0.013) loss 1.7323 (1.6412) ce_loss 1.1885 (1.1241) teacher_loss 1.0331 (0.9115) loss_zs_kd 0.8430 (0.9637) loss_oracle 0.6992 (0.7296) acc 53.1250 (56.7188) kd_loss 0.8434 (0.8298) lr 6.9098e-04 eta 0:09:59
epoch [32/50] batch [60/319] time 0.094 (0.095) data 0.001 (0.009) loss 1.4922 (1.6241) ce_loss 1.0312 (1.1113) teacher_loss 0.7142 (0.8903) loss_zs_kd 0.8899 (0.9888) loss_oracle 0.7780 (0.7338) acc 65.6250 (57.7083) kd_loss 0.8777 (0.8362) lr 6.9098e-04 eta 0:09:27
epoch [32/50] batch [80/319] time 0.085 (0.094) data 0.000 (0.007) loss 1.4276 (1.6301) ce_loss 1.0264 (1.1073) teacher_loss 0.6681 (0.8905) loss_zs_kd 1.0665 (0.9935) loss_oracle 0.7596 (0.7396) acc 53.1250 (57.5391) kd_loss 0.8745 (0.8378) lr 6.9098e-04 eta 0:09:20
epoch [32/50] batch [100/319] time 0.087 (0.092) data 0.000 (0.006) loss 1.4735 (1.6428) ce_loss 0.9800 (1.1182) teacher_loss 0.7301 (0.9007) loss_zs_kd 0.8542 (0.9844) loss_oracle 0.7434 (0.7421) acc 62.5000 (57.4062) kd_loss 0.8422 (0.8380) lr 6.9098e-04 eta 0:09:06
epoch [32/50] batch [120/319] time 0.085 (0.091) data 0.000 (0.005) loss 1.5088 (1.6317) ce_loss 1.1475 (1.1129) teacher_loss 0.7399 (0.8885) loss_zs_kd 1.0331 (0.9680) loss_oracle 0.7689 (0.7432) acc 59.3750 (57.5781) kd_loss 0.7922 (0.8392) lr 6.9098e-04 eta 0:08:59
epoch [32/50] batch [140/319] time 0.087 (0.091) data 0.000 (0.004) loss 1.5762 (1.6290) ce_loss 1.1006 (1.1108) teacher_loss 0.8445 (0.8849) loss_zs_kd 1.1297 (0.9605) loss_oracle 0.7317 (0.7441) acc 50.0000 (57.5446) kd_loss 0.8761 (0.8384) lr 6.9098e-04 eta 0:09:00
epoch [32/50] batch [160/319] time 0.085 (0.090) data 0.000 (0.004) loss 1.8251 (1.6324) ce_loss 1.2119 (1.1130) teacher_loss 1.1009 (0.8893) loss_zs_kd 0.8548 (0.9599) loss_oracle 0.7243 (0.7431) acc 53.1250 (57.6172) kd_loss 0.8689 (0.8380) lr 6.9098e-04 eta 0:08:53
epoch [32/50] batch [180/319] time 0.084 (0.090) data 0.000 (0.003) loss 1.8847 (1.6325) ce_loss 1.4424 (1.1120) teacher_loss 1.1279 (0.8892) loss_zs_kd 0.7746 (0.9589) loss_oracle 0.7568 (0.7433) acc 40.6250 (57.5521) kd_loss 0.8411 (0.8372) lr 6.9098e-04 eta 0:08:52
epoch [32/50] batch [200/319] time 0.081 (0.090) data 0.000 (0.003) loss 1.6586 (1.6367) ce_loss 1.0889 (1.1104) teacher_loss 0.8859 (0.8926) loss_zs_kd 0.8271 (0.9568) loss_oracle 0.7727 (0.7441) acc 56.2500 (57.7188) kd_loss 0.8224 (0.8358) lr 6.9098e-04 eta 0:08:45
epoch [32/50] batch [220/319] time 0.077 (0.089) data 0.000 (0.003) loss 1.7631 (1.6388) ce_loss 1.1377 (1.1069) teacher_loss 0.9486 (0.8937) loss_zs_kd 0.7310 (0.9473) loss_oracle 0.8145 (0.7450) acc 46.8750 (57.7983) kd_loss 0.8148 (0.8349) lr 6.9098e-04 eta 0:08:41
epoch [32/50] batch [240/319] time 0.078 (0.089) data 0.000 (0.003) loss 1.5935 (1.6445) ce_loss 0.9800 (1.1110) teacher_loss 0.8001 (0.8999) loss_zs_kd 0.7712 (0.9377) loss_oracle 0.7933 (0.7446) acc 62.5000 (57.5000) kd_loss 0.8226 (0.8338) lr 6.9098e-04 eta 0:08:36
epoch [32/50] batch [260/319] time 0.095 (0.089) data 0.000 (0.002) loss 1.6773 (1.6525) ce_loss 1.0352 (1.1148) teacher_loss 0.9027 (0.9081) loss_zs_kd 0.9615 (0.9339) loss_oracle 0.7746 (0.7444) acc 65.6250 (57.3558) kd_loss 0.8035 (0.8336) lr 6.9098e-04 eta 0:08:34
epoch [32/50] batch [280/319] time 0.090 (0.089) data 0.000 (0.002) loss 1.7712 (1.6598) ce_loss 1.3242 (1.1186) teacher_loss 1.0909 (0.9164) loss_zs_kd 0.8167 (0.9296) loss_oracle 0.6803 (0.7434) acc 56.2500 (57.2321) kd_loss 0.8451 (0.8327) lr 6.9098e-04 eta 0:08:32
epoch [32/50] batch [300/319] time 0.079 (0.089) data 0.000 (0.002) loss 1.5800 (1.6608) ce_loss 1.0166 (1.1142) teacher_loss 0.8544 (0.9167) loss_zs_kd 0.7525 (0.9326) loss_oracle 0.7256 (0.7441) acc 68.7500 (57.4062) kd_loss 0.8611 (0.8317) lr 6.9098e-04 eta 0:08:29
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,810
* accuracy: 64.2%
* error: 35.8%
* macro_f1: 56.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,835
* accuracy: 49.7%
* error: 50.3%
* macro_f1: 22.5%
******* Domain 2 best val acc:      64.4%, epoch: 30 *******
******* Domain 2 best val test acc: 55.0%, epoch: 30 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [33/50] batch [20/319] time 0.096 (0.110) data 0.000 (0.023) loss 1.9942 (1.7411) ce_loss 1.4414 (1.0917) teacher_loss 1.2198 (1.0042) loss_zs_kd 0.9210 (0.9299) loss_oracle 0.7744 (0.7370) acc 50.0000 (59.3750) kd_loss 0.8409 (0.8116) lr 6.3188e-04 eta 0:10:31
epoch [33/50] batch [40/319] time 0.082 (0.099) data 0.000 (0.012) loss 1.5883 (1.7265) ce_loss 1.0195 (1.0921) teacher_loss 0.8547 (0.9906) loss_zs_kd 0.9386 (0.9064) loss_oracle 0.7336 (0.7359) acc 62.5000 (60.3125) kd_loss 0.8802 (0.8204) lr 6.3188e-04 eta 0:09:21
epoch [33/50] batch [60/319] time 0.082 (0.093) data 0.001 (0.008) loss 1.1937 (1.7168) ce_loss 0.7979 (1.0941) teacher_loss 0.4697 (0.9834) loss_zs_kd 0.6869 (0.8920) loss_oracle 0.7239 (0.7333) acc 68.7500 (59.8438) kd_loss 0.8154 (0.8215) lr 6.3188e-04 eta 0:08:47
epoch [33/50] batch [80/319] time 0.083 (0.090) data 0.000 (0.006) loss 1.5685 (1.6994) ce_loss 1.0293 (1.0846) teacher_loss 0.8516 (0.9641) loss_zs_kd 1.0129 (0.8924) loss_oracle 0.7169 (0.7354) acc 62.5000 (60.3516) kd_loss 0.8235 (0.8209) lr 6.3188e-04 eta 0:08:31
epoch [33/50] batch [100/319] time 0.088 (0.089) data 0.000 (0.005) loss 1.8245 (1.6952) ce_loss 1.2305 (1.0892) teacher_loss 1.0515 (0.9588) loss_zs_kd 0.8067 (0.8861) loss_oracle 0.7730 (0.7364) acc 46.8750 (59.5938) kd_loss 0.7692 (0.8197) lr 6.3188e-04 eta 0:08:20
epoch [33/50] batch [120/319] time 0.082 (0.088) data 0.000 (0.004) loss 1.9462 (1.6917) ce_loss 1.2861 (1.0879) teacher_loss 1.1815 (0.9561) loss_zs_kd 0.8574 (0.8786) loss_oracle 0.7647 (0.7356) acc 53.1250 (59.2969) kd_loss 0.8497 (0.8192) lr 6.3188e-04 eta 0:08:14
epoch [33/50] batch [140/319] time 0.082 (0.088) data 0.000 (0.004) loss 1.5669 (1.6887) ce_loss 1.0527 (1.0821) teacher_loss 0.9032 (0.9552) loss_zs_kd 1.0594 (0.8781) loss_oracle 0.6637 (0.7335) acc 53.1250 (59.1071) kd_loss 0.8042 (0.8210) lr 6.3188e-04 eta 0:08:10
epoch [33/50] batch [160/319] time 0.083 (0.087) data 0.000 (0.003) loss 1.3190 (1.6919) ce_loss 0.7598 (1.0839) teacher_loss 0.5601 (0.9567) loss_zs_kd 0.7757 (0.8826) loss_oracle 0.7589 (0.7352) acc 75.0000 (58.7891) kd_loss 0.8189 (0.8199) lr 6.3188e-04 eta 0:08:06
epoch [33/50] batch [180/319] time 0.081 (0.087) data 0.000 (0.003) loss 1.8524 (1.7067) ce_loss 1.1113 (1.0959) teacher_loss 1.1511 (0.9711) loss_zs_kd 1.3369 (0.8755) loss_oracle 0.7013 (0.7356) acc 62.5000 (58.1424) kd_loss 0.8353 (0.8208) lr 6.3188e-04 eta 0:08:01
epoch [33/50] batch [200/319] time 0.083 (0.086) data 0.000 (0.003) loss 1.5625 (1.7050) ce_loss 0.9336 (1.0968) teacher_loss 0.8104 (0.9690) loss_zs_kd 1.2945 (0.8778) loss_oracle 0.7522 (0.7360) acc 59.3750 (58.1875) kd_loss 0.8505 (0.8209) lr 6.3188e-04 eta 0:07:58
epoch [33/50] batch [220/319] time 0.085 (0.086) data 0.000 (0.002) loss 1.4425 (1.7013) ce_loss 0.8916 (1.0934) teacher_loss 0.6813 (0.9650) loss_zs_kd 0.7518 (0.8710) loss_oracle 0.7613 (0.7363) acc 59.3750 (58.2244) kd_loss 0.8020 (0.8185) lr 6.3188e-04 eta 0:07:55
epoch [33/50] batch [240/319] time 0.090 (0.086) data 0.001 (0.002) loss 1.6734 (1.7026) ce_loss 1.0723 (1.0946) teacher_loss 0.9411 (0.9645) loss_zs_kd 0.9428 (0.8672) loss_oracle 0.7322 (0.7381) acc 62.5000 (58.0339) kd_loss 0.8037 (0.8185) lr 6.3188e-04 eta 0:07:53
epoch [33/50] batch [260/319] time 0.082 (0.086) data 0.000 (0.002) loss 1.8446 (1.7093) ce_loss 1.2109 (1.1008) teacher_loss 1.0447 (0.9706) loss_zs_kd 0.7004 (0.8613) loss_oracle 0.7999 (0.7387) acc 53.1250 (57.8245) kd_loss 0.7777 (0.8176) lr 6.3188e-04 eta 0:07:51
epoch [33/50] batch [280/319] time 0.081 (0.086) data 0.000 (0.002) loss 1.3955 (1.7066) ce_loss 0.7935 (1.0976) teacher_loss 0.6808 (0.9684) loss_zs_kd 0.7877 (0.8580) loss_oracle 0.7148 (0.7382) acc 68.7500 (57.9353) kd_loss 0.8480 (0.8164) lr 6.3188e-04 eta 0:07:49
epoch [33/50] batch [300/319] time 0.076 (0.086) data 0.000 (0.002) loss 1.4214 (1.7085) ce_loss 0.8037 (1.1010) teacher_loss 0.6749 (0.9698) loss_zs_kd 0.7202 (0.8543) loss_oracle 0.7466 (0.7386) acc 75.0000 (57.8646) kd_loss 0.8021 (0.8164) lr 6.3188e-04 eta 0:07:50
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,839
* accuracy: 64.8%
* error: 35.2%
* macro_f1: 56.7%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,943
* accuracy: 50.8%
* error: 49.2%
* macro_f1: 23.0%
******* Domain 2 best val acc:      64.8%, epoch: 33 *******
******* Domain 2 best val test acc: 50.8%, epoch: 33 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [34/50] batch [20/319] time 0.103 (0.140) data 0.000 (0.035) loss 2.0934 (1.7559) ce_loss 1.3613 (1.1174) teacher_loss 1.3618 (1.0052) loss_zs_kd 0.7640 (0.7971) loss_oracle 0.7316 (0.7507) acc 50.0000 (57.5000) kd_loss 0.7695 (0.8005) lr 5.7422e-04 eta 0:12:38
epoch [34/50] batch [40/319] time 0.079 (0.121) data 0.000 (0.017) loss 1.5376 (1.7316) ce_loss 1.0527 (1.0990) teacher_loss 0.8381 (0.9913) loss_zs_kd 0.6532 (0.8191) loss_oracle 0.6995 (0.7402) acc 53.1250 (57.8125) kd_loss 0.8211 (0.8072) lr 5.7422e-04 eta 0:10:53
epoch [34/50] batch [60/319] time 0.087 (0.114) data 0.000 (0.012) loss 1.7727 (1.6931) ce_loss 1.2412 (1.0785) teacher_loss 1.0684 (0.9607) loss_zs_kd 0.7674 (0.8315) loss_oracle 0.7043 (0.7324) acc 50.0000 (59.0104) kd_loss 0.7950 (0.8111) lr 5.7422e-04 eta 0:10:10
epoch [34/50] batch [80/319] time 0.101 (0.109) data 0.000 (0.009) loss 1.8624 (1.6855) ce_loss 1.2627 (1.0747) teacher_loss 1.0973 (0.9546) loss_zs_kd 0.9050 (0.8222) loss_oracle 0.7651 (0.7309) acc 59.3750 (59.1016) kd_loss 0.8148 (0.8111) lr 5.7422e-04 eta 0:09:40
epoch [34/50] batch [100/319] time 0.096 (0.106) data 0.000 (0.007) loss 1.7421 (1.6973) ce_loss 1.0322 (1.0779) teacher_loss 1.0206 (0.9686) loss_zs_kd 0.7955 (0.8341) loss_oracle 0.7215 (0.7287) acc 68.7500 (58.9062) kd_loss 0.7967 (0.8122) lr 5.7422e-04 eta 0:09:25
epoch [34/50] batch [120/319] time 0.099 (0.106) data 0.000 (0.006) loss 1.7917 (1.6887) ce_loss 1.1152 (1.0662) teacher_loss 1.0205 (0.9614) loss_zs_kd 0.8385 (0.8334) loss_oracle 0.7712 (0.7273) acc 56.2500 (59.1667) kd_loss 0.7903 (0.8126) lr 5.7422e-04 eta 0:09:20
epoch [34/50] batch [140/319] time 0.091 (0.104) data 0.000 (0.005) loss 1.8998 (1.6949) ce_loss 1.2510 (1.0705) teacher_loss 1.1557 (0.9682) loss_zs_kd 0.8120 (0.8375) loss_oracle 0.7442 (0.7267) acc 46.8750 (58.9732) kd_loss 0.8226 (0.8144) lr 5.7422e-04 eta 0:09:07
epoch [34/50] batch [160/319] time 0.072 (0.104) data 0.000 (0.005) loss 1.7406 (1.6960) ce_loss 1.1211 (1.0719) teacher_loss 1.0315 (0.9706) loss_zs_kd 0.9083 (0.8451) loss_oracle 0.7091 (0.7254) acc 56.2500 (59.1797) kd_loss 0.8180 (0.8140) lr 5.7422e-04 eta 0:09:06
epoch [34/50] batch [180/319] time 0.078 (0.103) data 0.000 (0.004) loss 1.6438 (1.6997) ce_loss 1.1523 (1.0760) teacher_loss 0.8925 (0.9750) loss_zs_kd 1.1225 (0.8551) loss_oracle 0.7513 (0.7246) acc 62.5000 (58.9236) kd_loss 0.8970 (0.8157) lr 5.7422e-04 eta 0:09:00
epoch [34/50] batch [200/319] time 0.169 (0.104) data 0.000 (0.004) loss 1.6354 (1.7089) ce_loss 1.0215 (1.0822) teacher_loss 0.9207 (0.9857) loss_zs_kd 0.6922 (0.8503) loss_oracle 0.7148 (0.7232) acc 65.6250 (58.6875) kd_loss 0.7857 (0.8169) lr 5.7422e-04 eta 0:09:02
epoch [34/50] batch [220/319] time 0.087 (0.103) data 0.000 (0.003) loss 1.5216 (1.7074) ce_loss 0.8149 (1.0804) teacher_loss 0.8110 (0.9843) loss_zs_kd 0.8813 (0.8509) loss_oracle 0.7106 (0.7231) acc 71.8750 (58.7642) kd_loss 0.8832 (0.8175) lr 5.7422e-04 eta 0:08:57
epoch [34/50] batch [240/319] time 0.077 (0.103) data 0.000 (0.003) loss 1.9234 (1.7070) ce_loss 1.2158 (1.0788) teacher_loss 1.1796 (0.9834) loss_zs_kd 0.9629 (0.8497) loss_oracle 0.7438 (0.7236) acc 56.2500 (58.8802) kd_loss 0.7547 (0.8180) lr 5.7422e-04 eta 0:08:53
epoch [34/50] batch [260/319] time 0.175 (0.104) data 0.000 (0.003) loss 1.4134 (1.7011) ce_loss 0.8247 (1.0745) teacher_loss 0.6361 (0.9765) loss_zs_kd 0.7700 (0.8476) loss_oracle 0.7772 (0.7246) acc 59.3750 (59.1226) kd_loss 0.7949 (0.8184) lr 5.7422e-04 eta 0:08:54
epoch [34/50] batch [280/319] time 0.091 (0.104) data 0.000 (0.003) loss 1.4423 (1.6964) ce_loss 0.7915 (1.0712) teacher_loss 0.7022 (0.9707) loss_zs_kd 1.0216 (0.8504) loss_oracle 0.7401 (0.7257) acc 81.2500 (59.1406) kd_loss 0.8924 (0.8195) lr 5.7422e-04 eta 0:08:55
epoch [34/50] batch [300/319] time 0.071 (0.105) data 0.000 (0.003) loss 1.6570 (1.6974) ce_loss 1.0977 (1.0728) teacher_loss 0.9631 (0.9710) loss_zs_kd 1.0364 (0.8547) loss_oracle 0.6940 (0.7263) acc 62.5000 (59.0417) kd_loss 0.8087 (0.8203) lr 5.7422e-04 eta 0:08:55
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,812
* accuracy: 64.2%
* error: 35.8%
* macro_f1: 56.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,747
* accuracy: 48.8%
* error: 51.2%
* macro_f1: 21.8%
******* Domain 2 best val acc:      64.8%, epoch: 33 *******
******* Domain 2 best val test acc: 50.8%, epoch: 33 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [35/50] batch [20/319] time 0.097 (0.141) data 0.000 (0.034) loss 1.7423 (1.6894) ce_loss 1.2188 (1.0490) teacher_loss 1.0271 (0.9693) loss_zs_kd 0.8472 (0.8383) loss_oracle 0.7152 (0.7200) acc 46.8750 (60.4688) kd_loss 0.8229 (0.8155) lr 5.1825e-04 eta 0:11:56
epoch [35/50] batch [40/319] time 0.103 (0.122) data 0.000 (0.017) loss 1.6159 (1.6831) ce_loss 0.9653 (1.0461) teacher_loss 0.9052 (0.9513) loss_zs_kd 0.9134 (0.8474) loss_oracle 0.7107 (0.7318) acc 65.6250 (60.7812) kd_loss 0.8064 (0.8174) lr 5.1825e-04 eta 0:10:19
epoch [35/50] batch [60/319] time 0.109 (0.116) data 0.001 (0.011) loss 1.7738 (1.7037) ce_loss 1.0654 (1.0679) teacher_loss 1.0015 (0.9691) loss_zs_kd 0.8258 (0.8362) loss_oracle 0.7723 (0.7347) acc 65.6250 (59.6875) kd_loss 0.8597 (0.8210) lr 5.1825e-04 eta 0:09:46
epoch [35/50] batch [80/319] time 0.104 (0.114) data 0.000 (0.009) loss 1.7604 (1.6918) ce_loss 1.1523 (1.0569) teacher_loss 1.0002 (0.9581) loss_zs_kd 0.8246 (0.8419) loss_oracle 0.7602 (0.7337) acc 59.3750 (60.0781) kd_loss 0.8015 (0.8216) lr 5.1825e-04 eta 0:09:30
epoch [35/50] batch [100/319] time 0.121 (0.112) data 0.000 (0.007) loss 1.8155 (1.6804) ce_loss 1.1660 (1.0501) teacher_loss 1.0671 (0.9428) loss_zs_kd 0.9840 (0.8424) loss_oracle 0.7483 (0.7375) acc 62.5000 (60.2500) kd_loss 0.8309 (0.8241) lr 5.1825e-04 eta 0:09:20
epoch [35/50] batch [120/319] time 0.114 (0.111) data 0.000 (0.006) loss 1.8860 (1.6817) ce_loss 1.0586 (1.0535) teacher_loss 1.1089 (0.9439) loss_zs_kd 0.9816 (0.8433) loss_oracle 0.7771 (0.7377) acc 68.7500 (59.9479) kd_loss 0.7643 (0.8225) lr 5.1825e-04 eta 0:09:12
epoch [35/50] batch [140/319] time 0.157 (0.111) data 0.000 (0.005) loss 1.4772 (1.6756) ce_loss 1.1357 (1.0476) teacher_loss 0.7425 (0.9370) loss_zs_kd 0.8226 (0.8447) loss_oracle 0.7346 (0.7385) acc 53.1250 (60.0670) kd_loss 0.9082 (0.8239) lr 5.1825e-04 eta 0:09:10
epoch [35/50] batch [160/319] time 0.086 (0.107) data 0.000 (0.004) loss 1.8249 (1.6746) ce_loss 1.1797 (1.0504) teacher_loss 1.1024 (0.9360) loss_zs_kd 0.9353 (0.8521) loss_oracle 0.7226 (0.7386) acc 53.1250 (59.8242) kd_loss 0.7885 (0.8240) lr 5.1825e-04 eta 0:08:50
epoch [35/50] batch [180/319] time 0.071 (0.108) data 0.000 (0.004) loss 1.7540 (1.6825) ce_loss 1.1943 (1.0614) teacher_loss 1.0123 (0.9460) loss_zs_kd 0.7473 (0.8541) loss_oracle 0.7417 (0.7365) acc 56.2500 (59.3229) kd_loss 0.8414 (0.8240) lr 5.1825e-04 eta 0:08:50
epoch [35/50] batch [200/319] time 0.078 (0.107) data 0.000 (0.004) loss 1.6683 (1.6921) ce_loss 1.0400 (1.0704) teacher_loss 0.9781 (0.9551) loss_zs_kd 0.6221 (0.8542) loss_oracle 0.6903 (0.7370) acc 62.5000 (59.1250) kd_loss 0.8100 (0.8233) lr 5.1825e-04 eta 0:08:43
epoch [35/50] batch [220/319] time 0.067 (0.107) data 0.000 (0.003) loss 2.0343 (1.6843) ce_loss 1.2666 (1.0648) teacher_loss 1.3141 (0.9465) loss_zs_kd 0.8037 (0.8551) loss_oracle 0.7203 (0.7379) acc 50.0000 (59.3182) kd_loss 0.7883 (0.8229) lr 5.1825e-04 eta 0:08:44
epoch [35/50] batch [240/319] time 0.080 (0.105) data 0.000 (0.003) loss 1.4713 (1.6852) ce_loss 1.0498 (1.0677) teacher_loss 0.7736 (0.9476) loss_zs_kd 0.8582 (0.8559) loss_oracle 0.6976 (0.7377) acc 53.1250 (59.2839) kd_loss 0.8763 (0.8232) lr 5.1825e-04 eta 0:08:32
epoch [35/50] batch [260/319] time 0.092 (0.105) data 0.000 (0.003) loss 1.3503 (1.6787) ce_loss 0.7671 (1.0655) teacher_loss 0.6039 (0.9402) loss_zs_kd 0.9086 (0.8586) loss_oracle 0.7464 (0.7384) acc 81.2500 (59.3389) kd_loss 0.8543 (0.8231) lr 5.1825e-04 eta 0:08:26
epoch [35/50] batch [280/319] time 0.139 (0.104) data 0.000 (0.003) loss 1.6874 (1.6797) ce_loss 1.1074 (1.0681) teacher_loss 0.9355 (0.9404) loss_zs_kd 1.0526 (0.8688) loss_oracle 0.7519 (0.7393) acc 56.2500 (59.2299) kd_loss 0.9480 (0.8246) lr 5.1825e-04 eta 0:08:23
epoch [35/50] batch [300/319] time 0.142 (0.105) data 0.000 (0.003) loss 1.4576 (1.6753) ce_loss 0.9888 (1.0663) teacher_loss 0.7441 (0.9365) loss_zs_kd 0.8935 (0.8753) loss_oracle 0.7135 (0.7388) acc 59.3750 (59.3438) kd_loss 0.8222 (0.8244) lr 5.1825e-04 eta 0:08:22
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,855
* accuracy: 65.2%
* error: 34.8%
* macro_f1: 58.0%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,287
* accuracy: 54.3%
* error: 45.7%
* macro_f1: 23.4%
******* Domain 2 best val acc:      65.2%, epoch: 35 *******
******* Domain 2 best val test acc: 54.3%, epoch: 35 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [36/50] batch [20/319] time 0.092 (0.131) data 0.000 (0.032) loss 1.6954 (1.7013) ce_loss 1.0547 (1.1124) teacher_loss 0.9707 (0.9605) loss_zs_kd 0.6765 (0.9261) loss_oracle 0.7247 (0.7408) acc 62.5000 (57.3438) kd_loss 0.8147 (0.8400) lr 4.6417e-04 eta 0:10:24
epoch [36/50] batch [40/319] time 0.111 (0.117) data 0.000 (0.016) loss 1.6731 (1.7088) ce_loss 1.0674 (1.1278) teacher_loss 0.9108 (0.9716) loss_zs_kd 0.8849 (0.9224) loss_oracle 0.7623 (0.7372) acc 56.2500 (56.6406) kd_loss 0.8502 (0.8396) lr 4.6417e-04 eta 0:09:17
epoch [36/50] batch [60/319] time 0.093 (0.113) data 0.000 (0.011) loss 1.5815 (1.6912) ce_loss 0.9980 (1.1014) teacher_loss 0.8797 (0.9544) loss_zs_kd 1.2220 (0.9152) loss_oracle 0.7018 (0.7368) acc 62.5000 (58.2812) kd_loss 0.8040 (0.8310) lr 4.6417e-04 eta 0:08:54
epoch [36/50] batch [80/319] time 0.106 (0.111) data 0.000 (0.008) loss 1.7220 (1.6989) ce_loss 1.0146 (1.1108) teacher_loss 0.9846 (0.9639) loss_zs_kd 0.9603 (0.8979) loss_oracle 0.7374 (0.7350) acc 59.3750 (57.1484) kd_loss 0.8259 (0.8315) lr 4.6417e-04 eta 0:08:41
epoch [36/50] batch [100/319] time 0.102 (0.110) data 0.000 (0.007) loss 1.5510 (1.6840) ce_loss 1.0977 (1.1024) teacher_loss 0.7663 (0.9517) loss_zs_kd 1.0910 (0.8882) loss_oracle 0.7847 (0.7323) acc 53.1250 (57.5625) kd_loss 0.8596 (0.8301) lr 4.6417e-04 eta 0:08:33
epoch [36/50] batch [120/319] time 0.094 (0.109) data 0.000 (0.006) loss 1.6278 (1.6795) ce_loss 0.9888 (1.0987) teacher_loss 0.9086 (0.9480) loss_zs_kd 0.9135 (0.8859) loss_oracle 0.7193 (0.7315) acc 59.3750 (57.8646) kd_loss 0.8179 (0.8300) lr 4.6417e-04 eta 0:08:26
epoch [36/50] batch [140/319] time 0.107 (0.107) data 0.000 (0.005) loss 1.7473 (1.6706) ce_loss 1.0391 (1.0902) teacher_loss 0.9829 (0.9412) loss_zs_kd 0.7529 (0.8909) loss_oracle 0.7644 (0.7294) acc 62.5000 (58.2143) kd_loss 0.8544 (0.8309) lr 4.6417e-04 eta 0:08:18
epoch [36/50] batch [160/319] time 0.091 (0.106) data 0.000 (0.004) loss 1.7501 (1.6660) ce_loss 1.0020 (1.0871) teacher_loss 0.9759 (0.9346) loss_zs_kd 0.7560 (0.8971) loss_oracle 0.7742 (0.7314) acc 65.6250 (58.2422) kd_loss 0.8453 (0.8313) lr 4.6417e-04 eta 0:08:11
epoch [36/50] batch [180/319] time 0.110 (0.104) data 0.000 (0.004) loss 1.8054 (1.6609) ce_loss 1.2666 (1.0834) teacher_loss 1.0599 (0.9280) loss_zs_kd 0.9788 (0.8957) loss_oracle 0.7455 (0.7329) acc 46.8750 (58.5243) kd_loss 0.8603 (0.8320) lr 4.6417e-04 eta 0:07:58
epoch [36/50] batch [200/319] time 0.110 (0.105) data 0.000 (0.003) loss 1.5958 (1.6606) ce_loss 0.9731 (1.0857) teacher_loss 0.8364 (0.9250) loss_zs_kd 0.8109 (0.8971) loss_oracle 0.7593 (0.7356) acc 62.5000 (58.5938) kd_loss 0.8320 (0.8335) lr 4.6417e-04 eta 0:08:01
epoch [36/50] batch [220/319] time 0.164 (0.107) data 0.000 (0.003) loss 1.6460 (1.6600) ce_loss 0.9644 (1.0843) teacher_loss 0.9449 (0.9235) loss_zs_kd 1.0670 (0.9066) loss_oracle 0.7011 (0.7364) acc 56.2500 (58.6080) kd_loss 0.8454 (0.8338) lr 4.6417e-04 eta 0:08:08
epoch [36/50] batch [240/319] time 0.099 (0.106) data 0.000 (0.003) loss 1.5937 (1.6613) ce_loss 1.0684 (1.0865) teacher_loss 0.8597 (0.9242) loss_zs_kd 1.1582 (0.9148) loss_oracle 0.7340 (0.7370) acc 56.2500 (58.5417) kd_loss 0.8139 (0.8329) lr 4.6417e-04 eta 0:08:04
epoch [36/50] batch [260/319] time 0.144 (0.107) data 0.000 (0.003) loss 1.7534 (1.6614) ce_loss 1.2725 (1.0865) teacher_loss 1.0408 (0.9244) loss_zs_kd 0.6780 (0.9149) loss_oracle 0.7126 (0.7370) acc 46.8750 (58.1971) kd_loss 0.8026 (0.8319) lr 4.6417e-04 eta 0:08:02
epoch [36/50] batch [280/319] time 0.078 (0.106) data 0.000 (0.003) loss 1.7576 (1.6588) ce_loss 1.3398 (1.0880) teacher_loss 0.9951 (0.9212) loss_zs_kd 0.8202 (0.9120) loss_oracle 0.7625 (0.7375) acc 46.8750 (58.0134) kd_loss 0.8248 (0.8312) lr 4.6417e-04 eta 0:07:57
epoch [36/50] batch [300/319] time 0.074 (0.106) data 0.000 (0.002) loss 1.8415 (1.6598) ce_loss 1.3525 (1.0874) teacher_loss 1.0797 (0.9216) loss_zs_kd 0.9479 (0.9150) loss_oracle 0.7618 (0.7381) acc 46.8750 (58.2083) kd_loss 0.8687 (0.8320) lr 4.6417e-04 eta 0:07:56
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,823
* accuracy: 64.5%
* error: 35.5%
* macro_f1: 57.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,109
* accuracy: 52.5%
* error: 47.5%
* macro_f1: 24.5%
******* Domain 2 best val acc:      65.2%, epoch: 35 *******
******* Domain 2 best val test acc: 54.3%, epoch: 35 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [37/50] batch [20/319] time 0.116 (0.144) data 0.000 (0.034) loss 1.6360 (1.6046) ce_loss 1.0244 (1.0545) teacher_loss 0.8969 (0.8571) loss_zs_kd 1.2290 (0.9227) loss_oracle 0.7391 (0.7475) acc 59.3750 (59.3750) kd_loss 0.8779 (0.8352) lr 4.1221e-04 eta 0:10:41
epoch [37/50] batch [40/319] time 0.105 (0.123) data 0.000 (0.017) loss 1.7978 (1.5946) ce_loss 1.3252 (1.0591) teacher_loss 1.0432 (0.8466) loss_zs_kd 0.8179 (0.9107) loss_oracle 0.7547 (0.7480) acc 59.3750 (60.3906) kd_loss 0.9077 (0.8393) lr 4.1221e-04 eta 0:09:05
epoch [37/50] batch [60/319] time 0.106 (0.117) data 0.001 (0.012) loss 1.4855 (1.6169) ce_loss 1.0332 (1.0784) teacher_loss 0.7258 (0.8706) loss_zs_kd 1.2427 (0.9178) loss_oracle 0.7597 (0.7462) acc 59.3750 (59.2708) kd_loss 0.8424 (0.8390) lr 4.1221e-04 eta 0:08:35
epoch [37/50] batch [80/319] time 0.093 (0.112) data 0.000 (0.009) loss 1.6718 (1.6314) ce_loss 1.3701 (1.0945) teacher_loss 0.8925 (0.8856) loss_zs_kd 0.9484 (0.9336) loss_oracle 0.7794 (0.7458) acc 43.7500 (58.3203) kd_loss 0.8905 (0.8398) lr 4.1221e-04 eta 0:08:10
epoch [37/50] batch [100/319] time 0.109 (0.111) data 0.000 (0.007) loss 1.7031 (1.6220) ce_loss 1.1094 (1.0884) teacher_loss 0.9596 (0.8782) loss_zs_kd 0.9317 (0.9387) loss_oracle 0.7435 (0.7438) acc 62.5000 (58.2500) kd_loss 0.8305 (0.8448) lr 4.1221e-04 eta 0:08:02
epoch [37/50] batch [120/319] time 0.097 (0.109) data 0.000 (0.006) loss 1.7677 (1.6249) ce_loss 1.2510 (1.0886) teacher_loss 0.9926 (0.8806) loss_zs_kd 1.0315 (0.9463) loss_oracle 0.7752 (0.7443) acc 56.2500 (58.4635) kd_loss 0.8819 (0.8476) lr 4.1221e-04 eta 0:07:54
epoch [37/50] batch [140/319] time 0.110 (0.108) data 0.000 (0.005) loss 1.3959 (1.6235) ce_loss 0.9009 (1.0872) teacher_loss 0.6227 (0.8786) loss_zs_kd 1.0557 (0.9586) loss_oracle 0.7732 (0.7449) acc 65.6250 (58.2812) kd_loss 0.8547 (0.8489) lr 4.1221e-04 eta 0:07:49
epoch [37/50] batch [160/319] time 0.103 (0.108) data 0.000 (0.005) loss 1.7795 (1.6282) ce_loss 1.1611 (1.0893) teacher_loss 1.0580 (0.8838) loss_zs_kd 1.0336 (0.9621) loss_oracle 0.7215 (0.7444) acc 46.8750 (58.1250) kd_loss 0.8096 (0.8486) lr 4.1221e-04 eta 0:07:43
epoch [37/50] batch [180/319] time 0.084 (0.106) data 0.000 (0.004) loss 1.6344 (1.6287) ce_loss 1.0791 (1.0917) teacher_loss 0.8462 (0.8834) loss_zs_kd 1.2921 (0.9671) loss_oracle 0.7882 (0.7453) acc 59.3750 (58.0035) kd_loss 0.8297 (0.8494) lr 4.1221e-04 eta 0:07:32
epoch [37/50] batch [200/319] time 0.080 (0.106) data 0.000 (0.004) loss 1.5527 (1.6256) ce_loss 1.0850 (1.0883) teacher_loss 0.7976 (0.8806) loss_zs_kd 0.9769 (0.9652) loss_oracle 0.7550 (0.7450) acc 65.6250 (58.2969) kd_loss 0.8270 (0.8489) lr 4.1221e-04 eta 0:07:30
epoch [37/50] batch [220/319] time 0.082 (0.107) data 0.000 (0.003) loss 1.8476 (1.6199) ce_loss 1.3066 (1.0832) teacher_loss 1.0681 (0.8743) loss_zs_kd 0.8973 (0.9580) loss_oracle 0.7796 (0.7457) acc 46.8750 (58.4375) kd_loss 0.8631 (0.8476) lr 4.1221e-04 eta 0:07:32
epoch [37/50] batch [240/319] time 0.170 (0.108) data 0.000 (0.003) loss 1.5967 (1.6180) ce_loss 1.0498 (1.0777) teacher_loss 0.8426 (0.8720) loss_zs_kd 0.8595 (0.9521) loss_oracle 0.7541 (0.7460) acc 59.3750 (58.4766) kd_loss 0.8543 (0.8465) lr 4.1221e-04 eta 0:07:35
epoch [37/50] batch [260/319] time 0.082 (0.106) data 0.000 (0.003) loss 1.7215 (1.6281) ce_loss 1.2959 (1.0849) teacher_loss 0.9758 (0.8824) loss_zs_kd 0.8294 (0.9459) loss_oracle 0.7458 (0.7458) acc 40.6250 (58.1010) kd_loss 0.7903 (0.8451) lr 4.1221e-04 eta 0:07:27
epoch [37/50] batch [280/319] time 0.079 (0.107) data 0.000 (0.003) loss 1.5913 (1.6303) ce_loss 0.9995 (1.0874) teacher_loss 0.8642 (0.8837) loss_zs_kd 0.7877 (0.9440) loss_oracle 0.7271 (0.7466) acc 65.6250 (58.0804) kd_loss 0.8062 (0.8441) lr 4.1221e-04 eta 0:07:27
epoch [37/50] batch [300/319] time 0.160 (0.108) data 0.000 (0.003) loss 1.4275 (1.6286) ce_loss 1.1084 (1.0854) teacher_loss 0.6520 (0.8807) loss_zs_kd 0.9699 (0.9439) loss_oracle 0.7755 (0.7479) acc 53.1250 (58.1667) kd_loss 0.8649 (0.8437) lr 4.1221e-04 eta 0:07:28
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,780
* accuracy: 63.5%
* error: 36.5%
* macro_f1: 56.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,641
* accuracy: 47.7%
* error: 52.3%
* macro_f1: 22.5%
******* Domain 2 best val acc:      65.2%, epoch: 35 *******
******* Domain 2 best val test acc: 54.3%, epoch: 35 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [38/50] batch [20/319] time 0.092 (0.133) data 0.000 (0.025) loss 1.6248 (1.6746) ce_loss 0.9785 (1.1161) teacher_loss 0.8855 (0.9284) loss_zs_kd 1.0759 (0.8780) loss_oracle 0.7393 (0.7462) acc 65.6250 (58.4375) kd_loss 0.8399 (0.8529) lr 3.6258e-04 eta 0:09:07
epoch [38/50] batch [40/319] time 0.116 (0.119) data 0.000 (0.013) loss 1.6876 (1.6650) ce_loss 1.1396 (1.0930) teacher_loss 0.9680 (0.9159) loss_zs_kd 0.6934 (0.8766) loss_oracle 0.7196 (0.7491) acc 59.3750 (59.0625) kd_loss 0.8425 (0.8447) lr 3.6258e-04 eta 0:08:10
epoch [38/50] batch [60/319] time 0.109 (0.114) data 0.001 (0.009) loss 1.9340 (1.6831) ce_loss 1.2090 (1.1194) teacher_loss 1.2120 (0.9374) loss_zs_kd 1.0257 (0.8745) loss_oracle 0.7220 (0.7457) acc 65.6250 (57.4479) kd_loss 0.8469 (0.8419) lr 3.6258e-04 eta 0:07:45
epoch [38/50] batch [80/319] time 0.105 (0.111) data 0.000 (0.007) loss 1.7143 (1.6701) ce_loss 1.3018 (1.1061) teacher_loss 0.9793 (0.9236) loss_zs_kd 1.1750 (0.8832) loss_oracle 0.7351 (0.7465) acc 50.0000 (57.7734) kd_loss 0.8200 (0.8413) lr 3.6258e-04 eta 0:07:33
epoch [38/50] batch [100/319] time 0.090 (0.110) data 0.000 (0.005) loss 1.5669 (1.6580) ce_loss 1.0283 (1.0983) teacher_loss 0.8193 (0.9131) loss_zs_kd 1.0998 (0.8987) loss_oracle 0.7476 (0.7449) acc 62.5000 (58.2812) kd_loss 0.8067 (0.8392) lr 3.6258e-04 eta 0:07:24
epoch [38/50] batch [120/319] time 0.096 (0.108) data 0.000 (0.004) loss 1.6031 (1.6528) ce_loss 0.8774 (1.0953) teacher_loss 0.8529 (0.9079) loss_zs_kd 0.9606 (0.8970) loss_oracle 0.7501 (0.7449) acc 65.6250 (58.5677) kd_loss 0.8515 (0.8381) lr 3.6258e-04 eta 0:07:13
epoch [38/50] batch [140/319] time 0.092 (0.106) data 0.000 (0.004) loss 1.7807 (1.6596) ce_loss 1.2305 (1.1026) teacher_loss 1.0716 (0.9164) loss_zs_kd 0.9508 (0.9003) loss_oracle 0.7091 (0.7432) acc 56.2500 (58.2812) kd_loss 0.7404 (0.8360) lr 3.6258e-04 eta 0:07:06
epoch [38/50] batch [160/319] time 0.096 (0.106) data 0.000 (0.003) loss 1.4716 (1.6580) ce_loss 1.0684 (1.1011) teacher_loss 0.7220 (0.9142) loss_zs_kd 0.7188 (0.8970) loss_oracle 0.7495 (0.7438) acc 62.5000 (58.3203) kd_loss 0.8716 (0.8358) lr 3.6258e-04 eta 0:07:01
epoch [38/50] batch [180/319] time 0.077 (0.104) data 0.000 (0.003) loss 1.5887 (1.6590) ce_loss 1.0195 (1.1049) teacher_loss 0.8938 (0.9152) loss_zs_kd 0.9466 (0.8956) loss_oracle 0.6949 (0.7438) acc 59.3750 (57.9340) kd_loss 0.8777 (0.8374) lr 3.6258e-04 eta 0:06:52
epoch [38/50] batch [200/319] time 0.133 (0.104) data 0.000 (0.003) loss 1.6493 (1.6568) ce_loss 1.1230 (1.1104) teacher_loss 0.9126 (0.9129) loss_zs_kd 0.9586 (0.9033) loss_oracle 0.7366 (0.7439) acc 50.0000 (57.4688) kd_loss 0.8203 (0.8377) lr 3.6258e-04 eta 0:06:49
epoch [38/50] batch [220/319] time 0.170 (0.104) data 0.000 (0.003) loss 1.8653 (1.6549) ce_loss 1.1191 (1.1068) teacher_loss 1.1016 (0.9101) loss_zs_kd 0.8141 (0.9065) loss_oracle 0.7637 (0.7447) acc 62.5000 (57.4716) kd_loss 0.8183 (0.8370) lr 3.6258e-04 eta 0:06:49
epoch [38/50] batch [240/319] time 0.075 (0.104) data 0.000 (0.002) loss 1.4283 (1.6490) ce_loss 0.9473 (1.0995) teacher_loss 0.6859 (0.9036) loss_zs_kd 0.7374 (0.9101) loss_oracle 0.7424 (0.7454) acc 56.2500 (57.5781) kd_loss 0.8594 (0.8376) lr 3.6258e-04 eta 0:06:47
epoch [38/50] batch [260/319] time 0.076 (0.104) data 0.000 (0.002) loss 1.9442 (1.6491) ce_loss 1.5146 (1.1005) teacher_loss 1.2020 (0.9041) loss_zs_kd 1.1590 (0.9118) loss_oracle 0.7422 (0.7450) acc 40.6250 (57.5361) kd_loss 0.8518 (0.8369) lr 3.6258e-04 eta 0:06:45
epoch [38/50] batch [280/319] time 0.087 (0.103) data 0.000 (0.002) loss 1.3771 (1.6436) ce_loss 0.9077 (1.1005) teacher_loss 0.6721 (0.8997) loss_zs_kd 0.9250 (0.9132) loss_oracle 0.7049 (0.7439) acc 62.5000 (57.4219) kd_loss 0.8619 (0.8376) lr 3.6258e-04 eta 0:06:37
epoch [38/50] batch [300/319] time 0.075 (0.104) data 0.000 (0.002) loss 1.9091 (1.6451) ce_loss 1.3848 (1.1016) teacher_loss 1.1602 (0.9016) loss_zs_kd 1.0054 (0.9160) loss_oracle 0.7489 (0.7435) acc 53.1250 (57.4375) kd_loss 0.8523 (0.8391) lr 3.6258e-04 eta 0:06:38
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,846
* accuracy: 65.0%
* error: 35.0%
* macro_f1: 57.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,279
* accuracy: 54.2%
* error: 45.8%
* macro_f1: 23.7%
******* Domain 2 best val acc:      65.2%, epoch: 35 *******
******* Domain 2 best val test acc: 54.3%, epoch: 35 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [39/50] batch [20/319] time 0.101 (0.129) data 0.000 (0.025) loss 1.6014 (1.6201) ce_loss 0.9351 (1.0379) teacher_loss 0.8729 (0.8789) loss_zs_kd 0.9794 (0.9183) loss_oracle 0.7284 (0.7412) acc 62.5000 (64.8438) kd_loss 0.8231 (0.8532) lr 3.1545e-04 eta 0:08:10
epoch [39/50] batch [40/319] time 0.123 (0.116) data 0.000 (0.012) loss 1.8750 (1.6168) ce_loss 1.3408 (1.0557) teacher_loss 1.1206 (0.8787) loss_zs_kd 0.8968 (0.9390) loss_oracle 0.7544 (0.7381) acc 53.1250 (61.6406) kd_loss 0.8477 (0.8522) lr 3.1545e-04 eta 0:07:19
epoch [39/50] batch [60/319] time 0.100 (0.110) data 0.001 (0.008) loss 1.4767 (1.6074) ce_loss 0.8843 (1.0623) teacher_loss 0.7566 (0.8725) loss_zs_kd 0.7695 (0.9326) loss_oracle 0.7201 (0.7349) acc 59.3750 (60.6771) kd_loss 0.8348 (0.8514) lr 3.1545e-04 eta 0:06:54
epoch [39/50] batch [80/319] time 0.097 (0.108) data 0.000 (0.006) loss 1.6446 (1.6175) ce_loss 1.1553 (1.0701) teacher_loss 0.9143 (0.8845) loss_zs_kd 1.1404 (0.9353) loss_oracle 0.7303 (0.7330) acc 62.5000 (59.8047) kd_loss 0.8708 (0.8467) lr 3.1545e-04 eta 0:06:45
epoch [39/50] batch [100/319] time 0.101 (0.107) data 0.000 (0.005) loss 2.0654 (1.6252) ce_loss 1.4014 (1.0756) teacher_loss 1.3079 (0.8923) loss_zs_kd 0.8475 (0.9186) loss_oracle 0.7574 (0.7329) acc 46.8750 (59.3438) kd_loss 0.8051 (0.8445) lr 3.1545e-04 eta 0:06:39
epoch [39/50] batch [120/319] time 0.098 (0.106) data 0.000 (0.004) loss 1.8244 (1.6181) ce_loss 1.2139 (1.0728) teacher_loss 1.1383 (0.8840) loss_zs_kd 0.6388 (0.9076) loss_oracle 0.6861 (0.7341) acc 68.7500 (59.4792) kd_loss 0.8211 (0.8458) lr 3.1545e-04 eta 0:06:34
epoch [39/50] batch [140/319] time 0.108 (0.106) data 0.000 (0.004) loss 1.4251 (1.6169) ce_loss 0.9194 (1.0731) teacher_loss 0.6749 (0.8816) loss_zs_kd 1.1848 (0.9105) loss_oracle 0.7502 (0.7353) acc 65.6250 (59.6205) kd_loss 0.8788 (0.8482) lr 3.1545e-04 eta 0:06:32
epoch [39/50] batch [160/319] time 0.104 (0.106) data 0.000 (0.003) loss 1.5126 (1.6132) ce_loss 0.8945 (1.0682) teacher_loss 0.7415 (0.8755) loss_zs_kd 1.1554 (0.9125) loss_oracle 0.7711 (0.7377) acc 62.5000 (59.4531) kd_loss 0.8532 (0.8488) lr 3.1545e-04 eta 0:06:29
epoch [39/50] batch [180/319] time 0.101 (0.106) data 0.000 (0.003) loss 1.4912 (1.6138) ce_loss 1.1191 (1.0713) teacher_loss 0.7046 (0.8759) loss_zs_kd 0.9367 (0.9134) loss_oracle 0.7866 (0.7379) acc 53.1250 (58.9757) kd_loss 0.8214 (0.8488) lr 3.1545e-04 eta 0:06:25
epoch [39/50] batch [200/319] time 0.089 (0.104) data 0.000 (0.003) loss 1.3468 (1.6103) ce_loss 0.9365 (1.0698) teacher_loss 0.5891 (0.8717) loss_zs_kd 0.8064 (0.9153) loss_oracle 0.7576 (0.7386) acc 71.8750 (59.0000) kd_loss 0.9110 (0.8480) lr 3.1545e-04 eta 0:06:17
epoch [39/50] batch [220/319] time 0.079 (0.104) data 0.000 (0.003) loss 1.4916 (1.6082) ce_loss 1.0107 (1.0668) teacher_loss 0.7668 (0.8699) loss_zs_kd 1.0915 (0.9236) loss_oracle 0.7249 (0.7383) acc 68.7500 (59.3324) kd_loss 0.9218 (0.8492) lr 3.1545e-04 eta 0:06:15
epoch [39/50] batch [240/319] time 0.127 (0.104) data 0.000 (0.002) loss 1.7541 (1.6140) ce_loss 1.3311 (1.0720) teacher_loss 1.0711 (0.8749) loss_zs_kd 1.0471 (0.9317) loss_oracle 0.6830 (0.7391) acc 40.6250 (59.2318) kd_loss 0.8607 (0.8490) lr 3.1545e-04 eta 0:06:14
epoch [39/50] batch [260/319] time 0.077 (0.105) data 0.000 (0.002) loss 1.5945 (1.6143) ce_loss 0.9351 (1.0716) teacher_loss 0.8341 (0.8760) loss_zs_kd 0.9563 (0.9362) loss_oracle 0.7604 (0.7383) acc 65.6250 (59.2548) kd_loss 0.8197 (0.8498) lr 3.1545e-04 eta 0:06:15
epoch [39/50] batch [280/319] time 0.083 (0.105) data 0.000 (0.002) loss 1.9343 (1.6150) ce_loss 1.4551 (1.0758) teacher_loss 1.1857 (0.8759) loss_zs_kd 0.9717 (0.9398) loss_oracle 0.7486 (0.7391) acc 53.1250 (59.1518) kd_loss 0.8431 (0.8497) lr 3.1545e-04 eta 0:06:11
epoch [39/50] batch [300/319] time 0.080 (0.103) data 0.000 (0.002) loss 1.6687 (1.6177) ce_loss 1.1240 (1.0786) teacher_loss 0.9258 (0.8783) loss_zs_kd 1.3764 (0.9476) loss_oracle 0.7429 (0.7394) acc 53.1250 (58.8958) kd_loss 0.8281 (0.8496) lr 3.1545e-04 eta 0:06:04
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,814
* accuracy: 64.3%
* error: 35.7%
* macro_f1: 56.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,107
* accuracy: 52.5%
* error: 47.5%
* macro_f1: 22.5%
******* Domain 2 best val acc:      65.2%, epoch: 35 *******
******* Domain 2 best val test acc: 54.3%, epoch: 35 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [40/50] batch [20/319] time 0.099 (0.134) data 0.000 (0.033) loss 1.6138 (1.5753) ce_loss 1.0791 (1.0246) teacher_loss 0.8893 (0.8355) loss_zs_kd 0.7697 (0.9281) loss_oracle 0.7245 (0.7398) acc 59.3750 (62.0312) kd_loss 0.8952 (0.8560) lr 2.7103e-04 eta 0:07:48
epoch [40/50] batch [40/319] time 0.101 (0.117) data 0.000 (0.017) loss 1.5569 (1.6079) ce_loss 0.9834 (1.0861) teacher_loss 0.7775 (0.8676) loss_zs_kd 0.8192 (0.9493) loss_oracle 0.7794 (0.7403) acc 65.6250 (58.6719) kd_loss 0.9093 (0.8601) lr 2.7103e-04 eta 0:06:44
epoch [40/50] batch [60/319] time 0.096 (0.112) data 0.001 (0.011) loss 1.6016 (1.6174) ce_loss 1.1523 (1.0886) teacher_loss 0.8517 (0.8719) loss_zs_kd 0.9114 (0.9638) loss_oracle 0.7499 (0.7455) acc 56.2500 (58.6979) kd_loss 0.8677 (0.8581) lr 2.7103e-04 eta 0:06:25
epoch [40/50] batch [80/319] time 0.091 (0.107) data 0.000 (0.008) loss 1.4282 (1.5884) ce_loss 0.9844 (1.0699) teacher_loss 0.7278 (0.8444) loss_zs_kd 0.8821 (0.9721) loss_oracle 0.7004 (0.7441) acc 53.1250 (59.1797) kd_loss 0.8343 (0.8571) lr 2.7103e-04 eta 0:06:06
epoch [40/50] batch [100/319] time 0.101 (0.106) data 0.000 (0.007) loss 1.6734 (1.5949) ce_loss 1.0039 (1.0739) teacher_loss 0.9093 (0.8484) loss_zs_kd 0.7033 (0.9627) loss_oracle 0.7641 (0.7465) acc 62.5000 (58.9688) kd_loss 0.8745 (0.8551) lr 2.7103e-04 eta 0:06:00
epoch [40/50] batch [120/319] time 0.089 (0.105) data 0.000 (0.006) loss 1.3594 (1.5895) ce_loss 0.9033 (1.0658) teacher_loss 0.5849 (0.8430) loss_zs_kd 1.1512 (0.9690) loss_oracle 0.7745 (0.7465) acc 62.5000 (59.1146) kd_loss 0.8717 (0.8559) lr 2.7103e-04 eta 0:05:57
epoch [40/50] batch [140/319] time 0.102 (0.104) data 0.000 (0.005) loss 1.6088 (1.5971) ce_loss 1.1035 (1.0738) teacher_loss 0.9055 (0.8511) loss_zs_kd 0.9590 (0.9661) loss_oracle 0.7033 (0.7460) acc 56.2500 (58.9286) kd_loss 0.9127 (0.8557) lr 2.7103e-04 eta 0:05:49
epoch [40/50] batch [160/319] time 0.100 (0.104) data 0.000 (0.004) loss 1.6089 (1.5930) ce_loss 1.1211 (1.0708) teacher_loss 0.8768 (0.8483) loss_zs_kd 0.9700 (0.9734) loss_oracle 0.7321 (0.7447) acc 50.0000 (59.0430) kd_loss 0.8547 (0.8564) lr 2.7103e-04 eta 0:05:47
epoch [40/50] batch [180/319] time 0.097 (0.104) data 0.000 (0.004) loss 1.8775 (1.5942) ce_loss 1.3955 (1.0710) teacher_loss 1.1120 (0.8505) loss_zs_kd 0.8755 (0.9725) loss_oracle 0.7655 (0.7436) acc 59.3750 (58.9410) kd_loss 0.8508 (0.8574) lr 2.7103e-04 eta 0:05:44
epoch [40/50] batch [200/319] time 0.081 (0.102) data 0.000 (0.004) loss 1.5465 (1.6053) ce_loss 1.0508 (1.0802) teacher_loss 0.7869 (0.8619) loss_zs_kd 0.8344 (0.9670) loss_oracle 0.7596 (0.7434) acc 65.6250 (58.7031) kd_loss 0.8140 (0.8588) lr 2.7103e-04 eta 0:05:39
epoch [40/50] batch [220/319] time 0.187 (0.102) data 0.000 (0.003) loss 1.6848 (1.6080) ce_loss 1.2783 (1.0849) teacher_loss 0.9108 (0.8654) loss_zs_kd 1.0763 (0.9654) loss_oracle 0.7740 (0.7427) acc 43.7500 (58.5085) kd_loss 0.9059 (0.8591) lr 2.7103e-04 eta 0:05:35
epoch [40/50] batch [240/319] time 0.164 (0.102) data 0.000 (0.003) loss 1.8935 (1.6097) ce_loss 1.2246 (1.0830) teacher_loss 1.0966 (0.8663) loss_zs_kd 0.8835 (0.9652) loss_oracle 0.7969 (0.7434) acc 53.1250 (58.6849) kd_loss 0.8617 (0.8600) lr 2.7103e-04 eta 0:05:34
epoch [40/50] batch [260/319] time 0.166 (0.103) data 0.000 (0.003) loss 1.6485 (1.6115) ce_loss 1.2100 (1.0845) teacher_loss 0.8963 (0.8684) loss_zs_kd 1.0815 (0.9660) loss_oracle 0.7522 (0.7431) acc 53.1250 (58.6058) kd_loss 0.7849 (0.8599) lr 2.7103e-04 eta 0:05:35
epoch [40/50] batch [280/319] time 0.086 (0.103) data 0.000 (0.003) loss 1.6372 (1.6147) ce_loss 1.1484 (1.0851) teacher_loss 0.9491 (0.8730) loss_zs_kd 0.7500 (0.9617) loss_oracle 0.6881 (0.7416) acc 59.3750 (58.5156) kd_loss 0.8785 (0.8606) lr 2.7103e-04 eta 0:05:31
epoch [40/50] batch [300/319] time 0.139 (0.102) data 0.000 (0.002) loss 1.8593 (1.6179) ce_loss 1.1826 (1.0877) teacher_loss 1.1306 (0.8764) loss_zs_kd 0.8547 (0.9598) loss_oracle 0.7288 (0.7414) acc 56.2500 (58.5312) kd_loss 0.8419 (0.8612) lr 2.7103e-04 eta 0:05:26
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,825
* accuracy: 64.5%
* error: 35.5%
* macro_f1: 56.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,257
* accuracy: 54.0%
* error: 46.0%
* macro_f1: 23.0%
******* Domain 2 best val acc:      65.2%, epoch: 35 *******
******* Domain 2 best val test acc: 54.3%, epoch: 35 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [41/50] batch [20/319] time 0.116 (0.140) data 0.000 (0.034) loss 1.6071 (1.6089) ce_loss 0.9604 (1.0705) teacher_loss 0.8693 (0.8528) loss_zs_kd 1.1017 (0.9969) loss_oracle 0.7378 (0.7561) acc 68.7500 (57.5000) kd_loss 0.7956 (0.8629) lr 2.2949e-04 eta 0:07:22
epoch [41/50] batch [40/319] time 0.100 (0.121) data 0.000 (0.017) loss 1.7813 (1.6099) ce_loss 1.1221 (1.0815) teacher_loss 1.0141 (0.8597) loss_zs_kd 1.3126 (0.9865) loss_oracle 0.7672 (0.7503) acc 65.6250 (58.9062) kd_loss 0.7835 (0.8574) lr 2.2949e-04 eta 0:06:20
epoch [41/50] batch [60/319] time 0.094 (0.115) data 0.000 (0.011) loss 1.6399 (1.6173) ce_loss 1.1250 (1.0878) teacher_loss 0.9031 (0.8681) loss_zs_kd 0.9250 (0.9818) loss_oracle 0.7368 (0.7492) acc 59.3750 (58.2812) kd_loss 0.8898 (0.8620) lr 2.2949e-04 eta 0:05:59
epoch [41/50] batch [80/319] time 0.090 (0.112) data 0.000 (0.009) loss 1.4284 (1.6127) ce_loss 1.0596 (1.0862) teacher_loss 0.7087 (0.8641) loss_zs_kd 1.1647 (0.9987) loss_oracle 0.7197 (0.7485) acc 56.2500 (58.8281) kd_loss 0.8380 (0.8633) lr 2.2949e-04 eta 0:05:48
epoch [41/50] batch [100/319] time 0.095 (0.111) data 0.000 (0.007) loss 1.5111 (1.6142) ce_loss 0.9258 (1.0880) teacher_loss 0.7671 (0.8661) loss_zs_kd 0.9927 (1.0014) loss_oracle 0.7440 (0.7481) acc 65.6250 (59.1562) kd_loss 0.9018 (0.8634) lr 2.2949e-04 eta 0:05:42
epoch [41/50] batch [120/319] time 0.103 (0.110) data 0.000 (0.006) loss 1.3579 (1.6213) ce_loss 0.9839 (1.0899) teacher_loss 0.5735 (0.8724) loss_zs_kd 0.8626 (1.0014) loss_oracle 0.7844 (0.7488) acc 65.6250 (58.8281) kd_loss 0.8742 (0.8657) lr 2.2949e-04 eta 0:05:37
epoch [41/50] batch [140/319] time 0.099 (0.109) data 0.000 (0.005) loss 1.3774 (1.6181) ce_loss 0.8374 (1.0833) teacher_loss 0.6349 (0.8695) loss_zs_kd 0.9562 (0.9981) loss_oracle 0.7425 (0.7486) acc 65.6250 (59.4196) kd_loss 0.8442 (0.8658) lr 2.2949e-04 eta 0:05:31
epoch [41/50] batch [160/319] time 0.108 (0.108) data 0.000 (0.004) loss 1.6338 (1.6232) ce_loss 1.1133 (1.0844) teacher_loss 0.8802 (0.8750) loss_zs_kd 0.8720 (0.9928) loss_oracle 0.7536 (0.7482) acc 53.1250 (59.2188) kd_loss 0.8591 (0.8621) lr 2.2949e-04 eta 0:05:28
epoch [41/50] batch [180/319] time 0.103 (0.108) data 0.000 (0.004) loss 1.3483 (1.6202) ce_loss 1.0527 (1.0835) teacher_loss 0.6698 (0.8729) loss_zs_kd 0.9848 (0.9910) loss_oracle 0.6785 (0.7473) acc 59.3750 (59.2188) kd_loss 0.8551 (0.8616) lr 2.2949e-04 eta 0:05:24
epoch [41/50] batch [200/319] time 0.109 (0.108) data 0.000 (0.004) loss 1.4288 (1.6143) ce_loss 1.0020 (1.0781) teacher_loss 0.6781 (0.8681) loss_zs_kd 0.9480 (0.9850) loss_oracle 0.7507 (0.7462) acc 56.2500 (59.3125) kd_loss 0.8579 (0.8615) lr 2.2949e-04 eta 0:05:21
epoch [41/50] batch [220/319] time 0.082 (0.107) data 0.000 (0.003) loss 1.6744 (1.6125) ce_loss 1.2930 (1.0743) teacher_loss 0.8906 (0.8663) loss_zs_kd 0.9416 (0.9854) loss_oracle 0.7838 (0.7462) acc 50.0000 (59.4460) kd_loss 0.8406 (0.8615) lr 2.2949e-04 eta 0:05:17
epoch [41/50] batch [240/319] time 0.108 (0.105) data 0.000 (0.003) loss 1.5989 (1.6141) ce_loss 1.0518 (1.0746) teacher_loss 0.8574 (0.8683) loss_zs_kd 0.7771 (0.9841) loss_oracle 0.7415 (0.7458) acc 53.1250 (59.3750) kd_loss 0.8177 (0.8603) lr 2.2949e-04 eta 0:05:10
epoch [41/50] batch [260/319] time 0.073 (0.106) data 0.000 (0.003) loss 1.7066 (1.6168) ce_loss 1.0986 (1.0769) teacher_loss 0.9503 (0.8715) loss_zs_kd 0.9650 (0.9782) loss_oracle 0.7563 (0.7453) acc 56.2500 (59.1106) kd_loss 0.8445 (0.8594) lr 2.2949e-04 eta 0:05:09
epoch [41/50] batch [280/319] time 0.079 (0.105) data 0.000 (0.003) loss 1.6845 (1.6197) ce_loss 0.9517 (1.0805) teacher_loss 0.8868 (0.8749) loss_zs_kd 0.9025 (0.9786) loss_oracle 0.7977 (0.7448) acc 68.7500 (58.8058) kd_loss 0.8343 (0.8591) lr 2.2949e-04 eta 0:05:06
epoch [41/50] batch [300/319] time 0.165 (0.105) data 0.000 (0.003) loss 1.7177 (1.6185) ce_loss 1.0410 (1.0787) teacher_loss 0.9536 (0.8737) loss_zs_kd 0.8306 (0.9749) loss_oracle 0.7642 (0.7448) acc 68.7500 (58.8438) kd_loss 0.9016 (0.8585) lr 2.2949e-04 eta 0:05:04
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,856
* accuracy: 65.2%
* error: 34.8%
* macro_f1: 56.3%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,107
* accuracy: 52.5%
* error: 47.5%
* macro_f1: 22.3%
******* Domain 2 best val acc:      65.2%, epoch: 41 *******
******* Domain 2 best val test acc: 52.5%, epoch: 41 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [42/50] batch [20/319] time 0.092 (0.129) data 0.000 (0.028) loss 1.7016 (1.6339) ce_loss 1.2207 (1.1009) teacher_loss 0.9367 (0.9023) loss_zs_kd 1.2131 (0.8962) loss_oracle 0.7649 (0.7316) acc 53.1250 (56.7188) kd_loss 0.8592 (0.8654) lr 1.9098e-04 eta 0:06:09
epoch [42/50] batch [40/319] time 0.091 (0.112) data 0.000 (0.014) loss 1.3096 (1.6366) ce_loss 0.8242 (1.0960) teacher_loss 0.5593 (0.9040) loss_zs_kd 0.8637 (0.9116) loss_oracle 0.7504 (0.7326) acc 71.8750 (58.1250) kd_loss 0.8289 (0.8572) lr 1.9098e-04 eta 0:05:16
epoch [42/50] batch [60/319] time 0.098 (0.108) data 0.001 (0.010) loss 1.6470 (1.6438) ce_loss 1.0518 (1.0995) teacher_loss 0.9387 (0.9105) loss_zs_kd 0.8884 (0.9162) loss_oracle 0.7082 (0.7333) acc 56.2500 (57.8646) kd_loss 0.8681 (0.8535) lr 1.9098e-04 eta 0:05:04
epoch [42/50] batch [80/319] time 0.089 (0.105) data 0.000 (0.007) loss 1.6700 (1.6393) ce_loss 1.2363 (1.0983) teacher_loss 0.8718 (0.9033) loss_zs_kd 0.8642 (0.9223) loss_oracle 0.7982 (0.7360) acc 28.1250 (57.6562) kd_loss 0.8355 (0.8514) lr 1.9098e-04 eta 0:04:53
epoch [42/50] batch [100/319] time 0.107 (0.103) data 0.000 (0.006) loss 2.0939 (1.6466) ce_loss 1.4189 (1.1067) teacher_loss 1.3739 (0.9120) loss_zs_kd 1.0566 (0.9256) loss_oracle 0.7199 (0.7346) acc 43.7500 (57.4375) kd_loss 0.9378 (0.8518) lr 1.9098e-04 eta 0:04:45
epoch [42/50] batch [120/319] time 0.109 (0.103) data 0.000 (0.005) loss 1.6936 (1.6337) ce_loss 1.1631 (1.0931) teacher_loss 0.9448 (0.8980) loss_zs_kd 0.9907 (0.9379) loss_oracle 0.7487 (0.7357) acc 56.2500 (58.2292) kd_loss 0.8717 (0.8523) lr 1.9098e-04 eta 0:04:43
epoch [42/50] batch [140/319] time 0.105 (0.103) data 0.000 (0.004) loss 1.2148 (1.6408) ce_loss 0.7231 (1.0926) teacher_loss 0.5148 (0.9044) loss_zs_kd 1.0624 (0.9425) loss_oracle 0.7000 (0.7364) acc 68.7500 (58.0134) kd_loss 0.8123 (0.8491) lr 1.9098e-04 eta 0:04:41
epoch [42/50] batch [160/319] time 0.107 (0.103) data 0.000 (0.004) loss 1.9601 (1.6404) ce_loss 1.3096 (1.0944) teacher_loss 1.2517 (0.9033) loss_zs_kd 1.1535 (0.9425) loss_oracle 0.7084 (0.7371) acc 56.2500 (57.9492) kd_loss 0.8678 (0.8501) lr 1.9098e-04 eta 0:04:39
epoch [42/50] batch [180/319] time 0.099 (0.104) data 0.000 (0.003) loss 1.6553 (1.6377) ce_loss 1.0771 (1.0939) teacher_loss 0.8877 (0.9014) loss_zs_kd 1.0235 (0.9529) loss_oracle 0.7675 (0.7363) acc 65.6250 (58.4028) kd_loss 0.8013 (0.8498) lr 1.9098e-04 eta 0:04:38
epoch [42/50] batch [200/319] time 0.093 (0.104) data 0.000 (0.003) loss 1.5691 (1.6335) ce_loss 1.0312 (1.0889) teacher_loss 0.8454 (0.8967) loss_zs_kd 0.9062 (0.9561) loss_oracle 0.7237 (0.7368) acc 56.2500 (58.6250) kd_loss 0.8367 (0.8508) lr 1.9098e-04 eta 0:04:36
epoch [42/50] batch [220/319] time 0.101 (0.103) data 0.000 (0.003) loss 1.7156 (1.6269) ce_loss 1.1387 (1.0841) teacher_loss 0.9909 (0.8883) loss_zs_kd 0.7927 (0.9616) loss_oracle 0.7247 (0.7386) acc 56.2500 (58.8494) kd_loss 0.8863 (0.8499) lr 1.9098e-04 eta 0:04:34
epoch [42/50] batch [240/319] time 0.087 (0.103) data 0.000 (0.003) loss 1.8299 (1.6259) ce_loss 1.2129 (1.0815) teacher_loss 1.1196 (0.8866) loss_zs_kd 0.9731 (0.9627) loss_oracle 0.7103 (0.7393) acc 56.2500 (58.8672) kd_loss 0.8552 (0.8488) lr 1.9098e-04 eta 0:04:29
epoch [42/50] batch [260/319] time 0.057 (0.102) data 0.000 (0.002) loss 1.6998 (1.6229) ce_loss 1.1758 (1.0804) teacher_loss 1.0065 (0.8827) loss_zs_kd 1.0498 (0.9603) loss_oracle 0.6933 (0.7401) acc 53.1250 (58.8341) kd_loss 0.8529 (0.8482) lr 1.9098e-04 eta 0:04:25
epoch [42/50] batch [280/319] time 0.057 (0.100) data 0.000 (0.002) loss 1.7692 (1.6220) ce_loss 1.1787 (1.0802) teacher_loss 1.0343 (0.8819) loss_zs_kd 0.8169 (0.9635) loss_oracle 0.7348 (0.7401) acc 65.6250 (58.9286) kd_loss 0.8617 (0.8482) lr 1.9098e-04 eta 0:04:20
epoch [42/50] batch [300/319] time 0.085 (0.099) data 0.000 (0.002) loss 1.5869 (1.6256) ce_loss 1.0674 (1.0823) teacher_loss 0.8489 (0.8854) loss_zs_kd 1.1027 (0.9679) loss_oracle 0.7380 (0.7403) acc 56.2500 (58.9271) kd_loss 0.8664 (0.8474) lr 1.9098e-04 eta 0:04:14
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,827
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 56.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,157
* accuracy: 53.0%
* error: 47.0%
* macro_f1: 22.5%
******* Domain 2 best val acc:      65.2%, epoch: 41 *******
******* Domain 2 best val test acc: 52.5%, epoch: 41 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [43/50] batch [20/319] time 0.107 (0.138) data 0.000 (0.032) loss 1.4870 (1.5780) ce_loss 0.9297 (1.0329) teacher_loss 0.7342 (0.8392) loss_zs_kd 1.2453 (0.9795) loss_oracle 0.7528 (0.7388) acc 65.6250 (61.4062) kd_loss 0.8350 (0.8367) lr 1.5567e-04 eta 0:05:48
epoch [43/50] batch [40/319] time 0.099 (0.115) data 0.000 (0.016) loss 2.0069 (1.6176) ce_loss 1.3613 (1.0667) teacher_loss 1.2191 (0.8760) loss_zs_kd 0.8987 (0.9542) loss_oracle 0.7878 (0.7416) acc 46.8750 (59.2188) kd_loss 0.7879 (0.8394) lr 1.5567e-04 eta 0:04:49
epoch [43/50] batch [60/319] time 0.076 (0.107) data 0.000 (0.011) loss 1.9292 (1.6128) ce_loss 1.3447 (1.0683) teacher_loss 1.2153 (0.8750) loss_zs_kd 0.9343 (0.9525) loss_oracle 0.7140 (0.7377) acc 43.7500 (58.2812) kd_loss 0.8310 (0.8445) lr 1.5567e-04 eta 0:04:26
epoch [43/50] batch [80/319] time 0.114 (0.103) data 0.000 (0.008) loss 1.4833 (1.6167) ce_loss 0.9482 (1.0734) teacher_loss 0.7118 (0.8762) loss_zs_kd 1.1106 (0.9515) loss_oracle 0.7716 (0.7405) acc 78.1250 (59.0234) kd_loss 0.9084 (0.8423) lr 1.5567e-04 eta 0:04:15
epoch [43/50] batch [100/319] time 0.108 (0.104) data 0.000 (0.007) loss 1.3654 (1.6108) ce_loss 0.9565 (1.0671) teacher_loss 0.6299 (0.8690) loss_zs_kd 0.8710 (0.9437) loss_oracle 0.7355 (0.7418) acc 56.2500 (59.0312) kd_loss 0.8319 (0.8409) lr 1.5567e-04 eta 0:04:14
epoch [43/50] batch [120/319] time 0.106 (0.104) data 0.000 (0.006) loss 1.6126 (1.6144) ce_loss 0.9463 (1.0703) teacher_loss 0.8591 (0.8717) loss_zs_kd 0.9313 (0.9372) loss_oracle 0.7535 (0.7427) acc 56.2500 (59.4271) kd_loss 0.8350 (0.8435) lr 1.5567e-04 eta 0:04:12
epoch [43/50] batch [140/319] time 0.094 (0.102) data 0.000 (0.005) loss 1.7659 (1.6155) ce_loss 1.3555 (1.0734) teacher_loss 1.0119 (0.8741) loss_zs_kd 0.8122 (0.9447) loss_oracle 0.7540 (0.7413) acc 46.8750 (59.2857) kd_loss 0.8680 (0.8429) lr 1.5567e-04 eta 0:04:06
epoch [43/50] batch [160/319] time 0.105 (0.102) data 0.000 (0.004) loss 1.5710 (1.6124) ce_loss 1.0225 (1.0699) teacher_loss 0.8171 (0.8699) loss_zs_kd 0.9361 (0.9475) loss_oracle 0.7540 (0.7425) acc 56.2500 (59.2383) kd_loss 0.8238 (0.8424) lr 1.5567e-04 eta 0:04:04
epoch [43/50] batch [180/319] time 0.103 (0.102) data 0.000 (0.004) loss 1.5626 (1.6209) ce_loss 1.1045 (1.0757) teacher_loss 0.8475 (0.8784) loss_zs_kd 0.8536 (0.9477) loss_oracle 0.7151 (0.7425) acc 62.5000 (59.3056) kd_loss 0.8553 (0.8427) lr 1.5567e-04 eta 0:04:02
epoch [43/50] batch [200/319] time 0.120 (0.103) data 0.001 (0.003) loss 1.7059 (1.6235) ce_loss 1.1172 (1.0772) teacher_loss 0.9246 (0.8810) loss_zs_kd 0.8635 (0.9500) loss_oracle 0.7812 (0.7425) acc 53.1250 (59.2344) kd_loss 0.8168 (0.8439) lr 1.5567e-04 eta 0:04:01
epoch [43/50] batch [220/319] time 0.099 (0.103) data 0.000 (0.003) loss 2.0437 (1.6294) ce_loss 1.2305 (1.0835) teacher_loss 1.2859 (0.8881) loss_zs_kd 1.0259 (0.9435) loss_oracle 0.7578 (0.7412) acc 56.2500 (58.9773) kd_loss 0.8702 (0.8430) lr 1.5567e-04 eta 0:03:59
epoch [43/50] batch [240/319] time 0.105 (0.103) data 0.000 (0.003) loss 1.6589 (1.6301) ce_loss 1.0664 (1.0818) teacher_loss 0.8782 (0.8887) loss_zs_kd 1.1339 (0.9438) loss_oracle 0.7807 (0.7414) acc 53.1250 (59.0234) kd_loss 0.8610 (0.8438) lr 1.5567e-04 eta 0:03:57
epoch [43/50] batch [260/319] time 0.100 (0.103) data 0.000 (0.003) loss 1.5077 (1.6290) ce_loss 0.9990 (1.0805) teacher_loss 0.7918 (0.8881) loss_zs_kd 1.1132 (0.9456) loss_oracle 0.7159 (0.7409) acc 75.0000 (59.1947) kd_loss 0.8719 (0.8450) lr 1.5567e-04 eta 0:03:56
epoch [43/50] batch [280/319] time 0.080 (0.102) data 0.000 (0.003) loss 1.4782 (1.6236) ce_loss 1.0342 (1.0779) teacher_loss 0.7127 (0.8834) loss_zs_kd 1.0211 (0.9455) loss_oracle 0.7655 (0.7402) acc 62.5000 (59.1741) kd_loss 0.9157 (0.8442) lr 1.5567e-04 eta 0:03:52
epoch [43/50] batch [300/319] time 0.171 (0.102) data 0.000 (0.002) loss 1.6587 (1.6233) ce_loss 1.0938 (1.0750) teacher_loss 0.9191 (0.8824) loss_zs_kd 0.6973 (0.9464) loss_oracle 0.7396 (0.7409) acc 65.6250 (59.2708) kd_loss 0.8246 (0.8432) lr 1.5567e-04 eta 0:03:49
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,843
* accuracy: 64.9%
* error: 35.1%
* macro_f1: 56.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,227
* accuracy: 53.7%
* error: 46.3%
* macro_f1: 22.6%
******* Domain 2 best val acc:      65.2%, epoch: 41 *******
******* Domain 2 best val test acc: 52.5%, epoch: 41 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [44/50] batch [20/319] time 0.103 (0.133) data 0.000 (0.028) loss 2.0047 (1.6496) ce_loss 1.2549 (1.0734) teacher_loss 1.2321 (0.8956) loss_zs_kd 0.9211 (0.9627) loss_oracle 0.7726 (0.7540) acc 59.3750 (60.9375) kd_loss 0.8226 (0.8381) lr 1.2369e-04 eta 0:04:53
epoch [44/50] batch [40/319] time 0.103 (0.117) data 0.000 (0.014) loss 1.9757 (1.6678) ce_loss 1.2383 (1.0921) teacher_loss 1.2556 (0.9180) loss_zs_kd 0.7740 (0.9529) loss_oracle 0.7201 (0.7497) acc 53.1250 (59.0625) kd_loss 0.8810 (0.8322) lr 1.2369e-04 eta 0:04:17
epoch [44/50] batch [60/319] time 0.107 (0.113) data 0.000 (0.009) loss 1.2452 (1.6485) ce_loss 0.8066 (1.0809) teacher_loss 0.5144 (0.8989) loss_zs_kd 1.0475 (0.9442) loss_oracle 0.7308 (0.7496) acc 71.8750 (59.1667) kd_loss 0.8654 (0.8373) lr 1.2369e-04 eta 0:04:05
epoch [44/50] batch [80/319] time 0.114 (0.111) data 0.000 (0.007) loss 1.5756 (1.6330) ce_loss 0.9976 (1.0721) teacher_loss 0.8602 (0.8866) loss_zs_kd 1.1396 (0.9450) loss_oracle 0.7154 (0.7464) acc 62.5000 (59.3750) kd_loss 0.7275 (0.8380) lr 1.2369e-04 eta 0:03:58
epoch [44/50] batch [100/319] time 0.103 (0.108) data 0.000 (0.006) loss 1.6869 (1.6307) ce_loss 1.0312 (1.0717) teacher_loss 0.9664 (0.8861) loss_zs_kd 0.8422 (0.9506) loss_oracle 0.7204 (0.7445) acc 62.5000 (59.5000) kd_loss 0.8591 (0.8386) lr 1.2369e-04 eta 0:03:50
epoch [44/50] batch [120/319] time 0.108 (0.107) data 0.000 (0.005) loss 1.8808 (1.6456) ce_loss 1.2393 (1.0846) teacher_loss 1.1361 (0.9007) loss_zs_kd 0.9202 (0.9372) loss_oracle 0.7447 (0.7449) acc 59.3750 (58.8542) kd_loss 0.8158 (0.8410) lr 1.2369e-04 eta 0:03:46
epoch [44/50] batch [140/319] time 0.102 (0.107) data 0.000 (0.004) loss 1.7975 (1.6495) ce_loss 1.2129 (1.0905) teacher_loss 1.1224 (0.9071) loss_zs_kd 0.9261 (0.9256) loss_oracle 0.6751 (0.7424) acc 46.8750 (58.6607) kd_loss 0.8265 (0.8421) lr 1.2369e-04 eta 0:03:43
epoch [44/50] batch [160/319] time 0.103 (0.106) data 0.000 (0.004) loss 1.7516 (1.6529) ce_loss 1.0605 (1.0932) teacher_loss 1.0196 (0.9108) loss_zs_kd 0.7778 (0.9273) loss_oracle 0.7320 (0.7421) acc 62.5000 (58.6133) kd_loss 0.8417 (0.8425) lr 1.2369e-04 eta 0:03:40
epoch [44/50] batch [180/319] time 0.087 (0.104) data 0.000 (0.003) loss 1.9112 (1.6559) ce_loss 1.2148 (1.0966) teacher_loss 1.1647 (0.9137) loss_zs_kd 0.7362 (0.9260) loss_oracle 0.7465 (0.7422) acc 53.1250 (58.2986) kd_loss 0.8861 (0.8422) lr 1.2369e-04 eta 0:03:34
epoch [44/50] batch [200/319] time 0.107 (0.104) data 0.000 (0.003) loss 1.2837 (1.6517) ce_loss 0.7612 (1.0941) teacher_loss 0.5312 (0.9101) loss_zs_kd 0.7624 (0.9295) loss_oracle 0.7525 (0.7416) acc 68.7500 (58.3594) kd_loss 0.8966 (0.8439) lr 1.2369e-04 eta 0:03:31
epoch [44/50] batch [220/319] time 0.099 (0.104) data 0.000 (0.003) loss 1.4585 (1.6476) ce_loss 0.9409 (1.0928) teacher_loss 0.7119 (0.9063) loss_zs_kd 0.9999 (0.9343) loss_oracle 0.7467 (0.7414) acc 59.3750 (58.2812) kd_loss 0.8323 (0.8436) lr 1.2369e-04 eta 0:03:29
epoch [44/50] batch [240/319] time 0.101 (0.104) data 0.000 (0.003) loss 1.8641 (1.6438) ce_loss 1.1719 (1.0870) teacher_loss 1.0981 (0.9030) loss_zs_kd 1.2211 (0.9375) loss_oracle 0.7660 (0.7409) acc 68.7500 (58.5677) kd_loss 0.8357 (0.8439) lr 1.2369e-04 eta 0:03:26
epoch [44/50] batch [260/319] time 0.110 (0.104) data 0.000 (0.002) loss 1.6836 (1.6429) ce_loss 1.1758 (1.0864) teacher_loss 0.9898 (0.9021) loss_zs_kd 0.8828 (0.9365) loss_oracle 0.6938 (0.7408) acc 53.1250 (58.4976) kd_loss 0.7883 (0.8438) lr 1.2369e-04 eta 0:03:24
epoch [44/50] batch [280/319] time 0.107 (0.103) data 0.000 (0.002) loss 1.8266 (1.6413) ce_loss 1.2480 (1.0851) teacher_loss 1.0312 (0.9008) loss_zs_kd 0.8864 (0.9346) loss_oracle 0.7954 (0.7406) acc 50.0000 (58.6384) kd_loss 0.8550 (0.8443) lr 1.2369e-04 eta 0:03:21
epoch [44/50] batch [300/319] time 0.086 (0.102) data 0.000 (0.002) loss 1.7318 (1.6399) ce_loss 1.1201 (1.0861) teacher_loss 0.9476 (0.8993) loss_zs_kd 0.8925 (0.9345) loss_oracle 0.7842 (0.7407) acc 65.6250 (58.5312) kd_loss 0.7838 (0.8445) lr 1.2369e-04 eta 0:03:16
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,849
* accuracy: 65.1%
* error: 34.9%
* macro_f1: 56.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,161
* accuracy: 53.0%
* error: 47.0%
* macro_f1: 22.7%
******* Domain 2 best val acc:      65.2%, epoch: 41 *******
******* Domain 2 best val test acc: 52.5%, epoch: 41 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [45/50] batch [20/319] time 0.109 (0.129) data 0.000 (0.026) loss 1.4431 (1.5780) ce_loss 0.9302 (1.0352) teacher_loss 0.6830 (0.8319) loss_zs_kd 0.6320 (0.9189) loss_oracle 0.7601 (0.7461) acc 65.6250 (59.8438) kd_loss 0.7890 (0.8465) lr 9.5173e-05 eta 0:04:03
epoch [45/50] batch [40/319] time 0.101 (0.115) data 0.000 (0.013) loss 1.6300 (1.6158) ce_loss 1.1797 (1.0757) teacher_loss 0.9458 (0.8723) loss_zs_kd 0.8636 (0.9167) loss_oracle 0.6842 (0.7436) acc 65.6250 (59.6094) kd_loss 0.8776 (0.8475) lr 9.5173e-05 eta 0:03:36
epoch [45/50] batch [60/319] time 0.119 (0.111) data 0.000 (0.009) loss 1.5117 (1.6224) ce_loss 0.9678 (1.0902) teacher_loss 0.7614 (0.8836) loss_zs_kd 1.0739 (0.9408) loss_oracle 0.7503 (0.7388) acc 71.8750 (59.1146) kd_loss 0.8928 (0.8508) lr 9.5173e-05 eta 0:03:26
epoch [45/50] batch [80/319] time 0.086 (0.109) data 0.000 (0.007) loss 1.7012 (1.6131) ce_loss 1.2188 (1.0810) teacher_loss 0.9131 (0.8737) loss_zs_kd 1.0804 (0.9392) loss_oracle 0.7882 (0.7395) acc 53.1250 (59.3750) kd_loss 0.8417 (0.8531) lr 9.5173e-05 eta 0:03:20
epoch [45/50] batch [100/319] time 0.096 (0.107) data 0.000 (0.005) loss 1.7110 (1.6147) ce_loss 0.9434 (1.0743) teacher_loss 0.9490 (0.8755) loss_zs_kd 0.8135 (0.9402) loss_oracle 0.7620 (0.7392) acc 65.6250 (58.9688) kd_loss 0.9637 (0.8548) lr 9.5173e-05 eta 0:03:14
epoch [45/50] batch [120/319] time 0.108 (0.106) data 0.000 (0.004) loss 1.6678 (1.6166) ce_loss 1.1426 (1.0755) teacher_loss 0.9135 (0.8745) loss_zs_kd 0.7549 (0.9333) loss_oracle 0.7543 (0.7421) acc 50.0000 (58.6979) kd_loss 0.7636 (0.8547) lr 9.5173e-05 eta 0:03:10
epoch [45/50] batch [140/319] time 0.091 (0.106) data 0.000 (0.004) loss 1.5741 (1.6061) ce_loss 0.9824 (1.0646) teacher_loss 0.8160 (0.8643) loss_zs_kd 0.9254 (0.9388) loss_oracle 0.7580 (0.7418) acc 68.7500 (59.3080) kd_loss 0.9361 (0.8567) lr 9.5173e-05 eta 0:03:07
epoch [45/50] batch [160/319] time 0.107 (0.106) data 0.000 (0.003) loss 1.5732 (1.5996) ce_loss 0.9229 (1.0584) teacher_loss 0.8572 (0.8574) loss_zs_kd 0.8055 (0.9355) loss_oracle 0.7160 (0.7422) acc 62.5000 (59.5703) kd_loss 0.8476 (0.8560) lr 9.5173e-05 eta 0:03:05
epoch [45/50] batch [180/319] time 0.097 (0.105) data 0.000 (0.003) loss 1.4619 (1.5971) ce_loss 0.9424 (1.0537) teacher_loss 0.7718 (0.8550) loss_zs_kd 1.0087 (0.9418) loss_oracle 0.6901 (0.7420) acc 65.6250 (59.9479) kd_loss 0.7790 (0.8562) lr 9.5173e-05 eta 0:03:02
epoch [45/50] batch [200/319] time 0.098 (0.105) data 0.000 (0.003) loss 1.6054 (1.5986) ce_loss 1.2256 (1.0590) teacher_loss 0.8205 (0.8567) loss_zs_kd 0.8178 (0.9340) loss_oracle 0.7849 (0.7420) acc 50.0000 (59.7812) kd_loss 0.8323 (0.8551) lr 9.5173e-05 eta 0:02:59
epoch [45/50] batch [220/319] time 0.093 (0.104) data 0.000 (0.003) loss 1.3442 (1.6012) ce_loss 0.8877 (1.0635) teacher_loss 0.5574 (0.8582) loss_zs_kd 0.7706 (0.9330) loss_oracle 0.7868 (0.7430) acc 65.6250 (59.5739) kd_loss 0.8776 (0.8544) lr 9.5173e-05 eta 0:02:57
epoch [45/50] batch [240/319] time 0.099 (0.104) data 0.000 (0.002) loss 1.6336 (1.5979) ce_loss 1.3516 (1.0628) teacher_loss 0.8698 (0.8546) loss_zs_kd 1.1396 (0.9341) loss_oracle 0.7638 (0.7434) acc 37.5000 (59.4922) kd_loss 0.8656 (0.8538) lr 9.5173e-05 eta 0:02:54
epoch [45/50] batch [260/319] time 0.106 (0.104) data 0.000 (0.002) loss 1.6782 (1.6102) ce_loss 1.1621 (1.0733) teacher_loss 0.9373 (0.8666) loss_zs_kd 0.9696 (0.9333) loss_oracle 0.7409 (0.7436) acc 59.3750 (59.0986) kd_loss 0.8074 (0.8533) lr 9.5173e-05 eta 0:02:51
epoch [45/50] batch [280/319] time 0.090 (0.104) data 0.000 (0.002) loss 1.4363 (1.6167) ce_loss 0.8496 (1.0742) teacher_loss 0.6959 (0.8731) loss_zs_kd 1.1232 (0.9339) loss_oracle 0.7404 (0.7436) acc 68.7500 (59.0179) kd_loss 0.8840 (0.8519) lr 9.5173e-05 eta 0:02:49
epoch [45/50] batch [300/319] time 0.082 (0.103) data 0.000 (0.002) loss 1.5665 (1.6157) ce_loss 0.8848 (1.0709) teacher_loss 0.8115 (0.8720) loss_zs_kd 0.7907 (0.9347) loss_oracle 0.7550 (0.7437) acc 62.5000 (59.1771) kd_loss 0.8438 (0.8516) lr 9.5173e-05 eta 0:02:46
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,867
* accuracy: 65.5%
* error: 34.5%
* macro_f1: 57.2%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,207
* accuracy: 53.5%
* error: 46.5%
* macro_f1: 22.7%
******* Domain 2 best val acc:      65.5%, epoch: 45 *******
******* Domain 2 best val test acc: 53.5%, epoch: 45 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [46/50] batch [20/319] time 0.097 (0.131) data 0.000 (0.026) loss 1.6459 (1.5844) ce_loss 1.1309 (1.0147) teacher_loss 0.9118 (0.8415) loss_zs_kd 0.9137 (0.9627) loss_oracle 0.7341 (0.7429) acc 46.8750 (60.7812) kd_loss 0.8146 (0.8387) lr 7.0224e-05 eta 0:03:26
epoch [46/50] batch [40/319] time 0.090 (0.113) data 0.000 (0.013) loss 1.7935 (1.5958) ce_loss 1.2227 (1.0426) teacher_loss 1.0522 (0.8516) loss_zs_kd 0.9262 (0.9535) loss_oracle 0.7414 (0.7442) acc 46.8750 (60.0000) kd_loss 0.8872 (0.8495) lr 7.0224e-05 eta 0:02:56
epoch [46/50] batch [60/319] time 0.102 (0.108) data 0.000 (0.009) loss 1.4979 (1.5823) ce_loss 1.1357 (1.0391) teacher_loss 0.8239 (0.8431) loss_zs_kd 1.0042 (0.9710) loss_oracle 0.6741 (0.7393) acc 59.3750 (60.7812) kd_loss 0.8459 (0.8516) lr 7.0224e-05 eta 0:02:45
epoch [46/50] batch [80/319] time 0.093 (0.106) data 0.000 (0.007) loss 1.5444 (1.5833) ce_loss 0.9712 (1.0395) teacher_loss 0.7744 (0.8447) loss_zs_kd 0.8120 (0.9767) loss_oracle 0.7700 (0.7386) acc 71.8750 (60.9766) kd_loss 0.8139 (0.8527) lr 7.0224e-05 eta 0:02:40
epoch [46/50] batch [100/319] time 0.108 (0.106) data 0.000 (0.005) loss 1.2367 (1.5827) ce_loss 0.8042 (1.0410) teacher_loss 0.5367 (0.8436) loss_zs_kd 0.8417 (0.9765) loss_oracle 0.7000 (0.7390) acc 68.7500 (60.7500) kd_loss 0.8327 (0.8548) lr 7.0224e-05 eta 0:02:38
epoch [46/50] batch [120/319] time 0.098 (0.105) data 0.000 (0.005) loss 1.5599 (1.5858) ce_loss 0.9224 (1.0388) teacher_loss 0.8141 (0.8454) loss_zs_kd 0.9927 (0.9685) loss_oracle 0.7458 (0.7404) acc 65.6250 (60.7812) kd_loss 0.8939 (0.8522) lr 7.0224e-05 eta 0:02:35
epoch [46/50] batch [140/319] time 0.099 (0.104) data 0.000 (0.004) loss 1.5924 (1.5936) ce_loss 0.8809 (1.0507) teacher_loss 0.8508 (0.8530) loss_zs_kd 0.7187 (0.9641) loss_oracle 0.7417 (0.7406) acc 75.0000 (60.1339) kd_loss 0.8408 (0.8519) lr 7.0224e-05 eta 0:02:32
epoch [46/50] batch [160/319] time 0.099 (0.104) data 0.000 (0.004) loss 1.3781 (1.5881) ce_loss 0.9526 (1.0469) teacher_loss 0.6136 (0.8471) loss_zs_kd 0.8043 (0.9635) loss_oracle 0.7645 (0.7410) acc 56.2500 (60.3516) kd_loss 0.9102 (0.8536) lr 7.0224e-05 eta 0:02:29
epoch [46/50] batch [180/319] time 0.087 (0.104) data 0.000 (0.003) loss 1.6356 (1.5963) ce_loss 1.0332 (1.0522) teacher_loss 0.9250 (0.8560) loss_zs_kd 0.8103 (0.9639) loss_oracle 0.7106 (0.7404) acc 62.5000 (60.2604) kd_loss 0.8543 (0.8532) lr 7.0224e-05 eta 0:02:26
epoch [46/50] batch [200/319] time 0.105 (0.103) data 0.000 (0.003) loss 1.6050 (1.5976) ce_loss 1.0576 (1.0506) teacher_loss 0.9172 (0.8569) loss_zs_kd 0.8565 (0.9658) loss_oracle 0.6877 (0.7407) acc 56.2500 (60.2500) kd_loss 0.8087 (0.8534) lr 7.0224e-05 eta 0:02:24
epoch [46/50] batch [220/319] time 0.095 (0.104) data 0.000 (0.003) loss 1.8377 (1.6053) ce_loss 1.2607 (1.0592) teacher_loss 1.1171 (0.8646) loss_zs_kd 0.9659 (0.9614) loss_oracle 0.7207 (0.7406) acc 50.0000 (59.9432) kd_loss 0.8433 (0.8529) lr 7.0224e-05 eta 0:02:22
epoch [46/50] batch [240/319] time 0.102 (0.104) data 0.000 (0.002) loss 1.4796 (1.6073) ce_loss 0.9453 (1.0594) teacher_loss 0.7480 (0.8660) loss_zs_kd 0.8356 (0.9603) loss_oracle 0.7316 (0.7413) acc 68.7500 (59.9740) kd_loss 0.7776 (0.8539) lr 7.0224e-05 eta 0:02:20
epoch [46/50] batch [260/319] time 0.112 (0.104) data 0.000 (0.002) loss 1.6019 (1.6074) ce_loss 0.9199 (1.0612) teacher_loss 0.8742 (0.8665) loss_zs_kd 1.0164 (0.9596) loss_oracle 0.7278 (0.7410) acc 65.6250 (59.9760) kd_loss 0.9350 (0.8530) lr 7.0224e-05 eta 0:02:18
epoch [46/50] batch [280/319] time 0.109 (0.104) data 0.000 (0.002) loss 1.7695 (1.6114) ce_loss 1.2725 (1.0637) teacher_loss 0.9935 (0.8705) loss_zs_kd 0.7928 (0.9584) loss_oracle 0.7760 (0.7409) acc 50.0000 (59.8549) kd_loss 0.8393 (0.8518) lr 7.0224e-05 eta 0:02:16
epoch [46/50] batch [300/319] time 0.109 (0.104) data 0.000 (0.002) loss 1.5769 (1.6091) ce_loss 1.2520 (1.0627) teacher_loss 0.8153 (0.8685) loss_zs_kd 1.0010 (0.9571) loss_oracle 0.7616 (0.7407) acc 43.7500 (59.8750) kd_loss 0.8176 (0.8517) lr 7.0224e-05 eta 0:02:14
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,872
* accuracy: 65.6%
* error: 34.4%
* macro_f1: 57.4%
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,195
* accuracy: 53.4%
* error: 46.6%
* macro_f1: 22.7%
******* Domain 2 best val acc:      65.6%, epoch: 46 *******
******* Domain 2 best val test acc: 53.4%, epoch: 46 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [47/50] batch [20/319] time 0.120 (0.139) data 0.000 (0.031) loss 1.6024 (1.6739) ce_loss 0.9414 (1.1073) teacher_loss 0.8218 (0.9360) loss_zs_kd 0.9041 (0.9310) loss_oracle 0.7806 (0.7378) acc 68.7500 (57.6562) kd_loss 0.8371 (0.8490) lr 4.8943e-05 eta 0:02:54
epoch [47/50] batch [40/319] time 0.111 (0.122) data 0.000 (0.016) loss 1.5576 (1.6500) ce_loss 1.0293 (1.1062) teacher_loss 0.8061 (0.9091) loss_zs_kd 0.8920 (0.9258) loss_oracle 0.7515 (0.7409) acc 62.5000 (57.3438) kd_loss 0.8652 (0.8480) lr 4.8943e-05 eta 0:02:30
epoch [47/50] batch [60/319] time 0.110 (0.117) data 0.000 (0.010) loss 1.7480 (1.6305) ce_loss 1.0635 (1.0993) teacher_loss 0.9686 (0.8893) loss_zs_kd 1.1673 (0.9517) loss_oracle 0.7793 (0.7412) acc 62.5000 (57.3958) kd_loss 0.9751 (0.8489) lr 4.8943e-05 eta 0:02:21
epoch [47/50] batch [80/319] time 0.114 (0.115) data 0.000 (0.008) loss 1.6722 (1.6290) ce_loss 1.0146 (1.0963) teacher_loss 0.9954 (0.8869) loss_zs_kd 0.7408 (0.9370) loss_oracle 0.6768 (0.7422) acc 53.1250 (57.6953) kd_loss 0.7589 (0.8470) lr 4.8943e-05 eta 0:02:17
epoch [47/50] batch [100/319] time 0.113 (0.113) data 0.000 (0.006) loss 1.3750 (1.6313) ce_loss 0.8853 (1.0882) teacher_loss 0.6249 (0.8916) loss_zs_kd 0.9535 (0.9395) loss_oracle 0.7501 (0.7397) acc 53.1250 (58.2500) kd_loss 0.8231 (0.8473) lr 4.8943e-05 eta 0:02:13
epoch [47/50] batch [120/319] time 0.095 (0.112) data 0.000 (0.005) loss 1.4254 (1.6156) ce_loss 0.9653 (1.0756) teacher_loss 0.6474 (0.8752) loss_zs_kd 0.7887 (0.9451) loss_oracle 0.7780 (0.7404) acc 56.2500 (58.4635) kd_loss 0.8851 (0.8504) lr 4.8943e-05 eta 0:02:09
epoch [47/50] batch [140/319] time 0.106 (0.111) data 0.000 (0.005) loss 1.9080 (1.6062) ce_loss 1.3545 (1.0681) teacher_loss 1.1231 (0.8663) loss_zs_kd 1.0507 (0.9455) loss_oracle 0.7849 (0.7399) acc 50.0000 (58.8616) kd_loss 0.7851 (0.8493) lr 4.8943e-05 eta 0:02:05
epoch [47/50] batch [160/319] time 0.103 (0.110) data 0.000 (0.004) loss 1.5608 (1.6014) ce_loss 0.9492 (1.0663) teacher_loss 0.8596 (0.8628) loss_zs_kd 0.6966 (0.9475) loss_oracle 0.7011 (0.7386) acc 71.8750 (58.8867) kd_loss 0.8518 (0.8492) lr 4.8943e-05 eta 0:02:02
epoch [47/50] batch [180/319] time 0.098 (0.109) data 0.000 (0.004) loss 1.5019 (1.6013) ce_loss 1.0566 (1.0706) teacher_loss 0.7885 (0.8630) loss_zs_kd 1.0260 (0.9508) loss_oracle 0.7134 (0.7382) acc 46.8750 (58.4028) kd_loss 0.8324 (0.8507) lr 4.8943e-05 eta 0:01:59
epoch [47/50] batch [200/319] time 0.093 (0.109) data 0.000 (0.003) loss 1.7856 (1.5980) ce_loss 1.1230 (1.0651) teacher_loss 1.0019 (0.8590) loss_zs_kd 1.1334 (0.9464) loss_oracle 0.7837 (0.7390) acc 53.1250 (58.8281) kd_loss 0.8690 (0.8504) lr 4.8943e-05 eta 0:01:56
epoch [47/50] batch [220/319] time 0.104 (0.108) data 0.000 (0.003) loss 1.3811 (1.5968) ce_loss 0.9888 (1.0630) teacher_loss 0.6453 (0.8583) loss_zs_kd 0.8596 (0.9511) loss_oracle 0.7359 (0.7384) acc 68.7500 (59.0483) kd_loss 0.8338 (0.8506) lr 4.8943e-05 eta 0:01:54
epoch [47/50] batch [240/319] time 0.092 (0.108) data 0.000 (0.003) loss 1.3916 (1.6020) ce_loss 0.7725 (1.0691) teacher_loss 0.6742 (0.8638) loss_zs_kd 0.8813 (0.9516) loss_oracle 0.7174 (0.7382) acc 81.2500 (58.8802) kd_loss 0.8833 (0.8504) lr 4.8943e-05 eta 0:01:51
epoch [47/50] batch [260/319] time 0.107 (0.108) data 0.000 (0.003) loss 1.8928 (1.6067) ce_loss 1.2207 (1.0715) teacher_loss 1.1141 (0.8678) loss_zs_kd 0.8166 (0.9506) loss_oracle 0.7787 (0.7389) acc 53.1250 (58.9062) kd_loss 0.8367 (0.8504) lr 4.8943e-05 eta 0:01:49
epoch [47/50] batch [280/319] time 0.086 (0.107) data 0.000 (0.002) loss 1.8591 (1.6066) ce_loss 0.9429 (1.0700) teacher_loss 1.1113 (0.8677) loss_zs_kd 0.7653 (0.9514) loss_oracle 0.7479 (0.7389) acc 68.7500 (58.9062) kd_loss 0.8476 (0.8490) lr 4.8943e-05 eta 0:01:46
epoch [47/50] batch [300/319] time 0.090 (0.106) data 0.000 (0.002) loss 1.4243 (1.6089) ce_loss 0.8320 (1.0689) teacher_loss 0.6754 (0.8696) loss_zs_kd 0.8985 (0.9518) loss_oracle 0.7489 (0.7393) acc 68.7500 (59.0104) kd_loss 0.9485 (0.8486) lr 4.8943e-05 eta 0:01:43
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,870
* accuracy: 65.6%
* error: 34.4%
* macro_f1: 57.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,182
* accuracy: 53.2%
* error: 46.8%
* macro_f1: 22.6%
******* Domain 2 best val acc:      65.6%, epoch: 46 *******
******* Domain 2 best val test acc: 53.4%, epoch: 46 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [48/50] batch [20/319] time 0.111 (0.137) data 0.000 (0.027) loss 1.6162 (1.6734) ce_loss 0.9697 (1.1324) teacher_loss 0.9374 (0.9417) loss_zs_kd 0.7683 (0.9395) loss_oracle 0.6787 (0.7317) acc 65.6250 (57.5000) kd_loss 0.7296 (0.8317) lr 3.1417e-05 eta 0:02:08
epoch [48/50] batch [40/319] time 0.111 (0.121) data 0.000 (0.014) loss 1.4863 (1.6527) ce_loss 1.0547 (1.1298) teacher_loss 0.7188 (0.9147) loss_zs_kd 0.9127 (0.9479) loss_oracle 0.7675 (0.7380) acc 59.3750 (57.5000) kd_loss 0.8086 (0.8382) lr 3.1417e-05 eta 0:01:51
epoch [48/50] batch [60/319] time 0.105 (0.115) data 0.000 (0.009) loss 1.7053 (1.6349) ce_loss 1.1006 (1.1158) teacher_loss 0.9475 (0.9008) loss_zs_kd 0.6999 (0.9485) loss_oracle 0.7578 (0.7341) acc 62.5000 (58.5417) kd_loss 0.8356 (0.8415) lr 3.1417e-05 eta 0:01:43
epoch [48/50] batch [80/319] time 0.091 (0.109) data 0.000 (0.007) loss 1.5960 (1.6134) ce_loss 0.9868 (1.0938) teacher_loss 0.8753 (0.8756) loss_zs_kd 0.8648 (0.9531) loss_oracle 0.7207 (0.7378) acc 56.2500 (59.0625) kd_loss 0.8009 (0.8452) lr 3.1417e-05 eta 0:01:35
epoch [48/50] batch [100/319] time 0.095 (0.106) data 0.000 (0.006) loss 1.5657 (1.6079) ce_loss 1.0684 (1.0843) teacher_loss 0.8186 (0.8703) loss_zs_kd 0.8331 (0.9571) loss_oracle 0.7471 (0.7376) acc 59.3750 (59.3438) kd_loss 0.8905 (0.8449) lr 3.1417e-05 eta 0:01:30
epoch [48/50] batch [120/319] time 0.094 (0.104) data 0.000 (0.005) loss 1.6554 (1.6027) ce_loss 1.0039 (1.0730) teacher_loss 0.9216 (0.8633) loss_zs_kd 0.8247 (0.9544) loss_oracle 0.7338 (0.7394) acc 62.5000 (59.7917) kd_loss 0.8874 (0.8473) lr 3.1417e-05 eta 0:01:26
epoch [48/50] batch [140/319] time 0.088 (0.102) data 0.000 (0.004) loss 1.7251 (1.6028) ce_loss 1.2344 (1.0720) teacher_loss 0.9405 (0.8627) loss_zs_kd 0.8781 (0.9554) loss_oracle 0.7846 (0.7401) acc 59.3750 (59.7098) kd_loss 0.8726 (0.8500) lr 3.1417e-05 eta 0:01:23
epoch [48/50] batch [160/319] time 0.120 (0.101) data 0.000 (0.004) loss 1.3396 (1.5985) ce_loss 0.8462 (1.0636) teacher_loss 0.6298 (0.8576) loss_zs_kd 1.1613 (0.9521) loss_oracle 0.7098 (0.7409) acc 65.6250 (60.0000) kd_loss 0.8693 (0.8511) lr 3.1417e-05 eta 0:01:20
epoch [48/50] batch [180/319] time 0.092 (0.100) data 0.000 (0.003) loss 1.5955 (1.6034) ce_loss 0.9097 (1.0703) teacher_loss 0.8999 (0.8627) loss_zs_kd 1.0123 (0.9478) loss_oracle 0.6956 (0.7408) acc 71.8750 (59.5312) kd_loss 0.8110 (0.8494) lr 3.1417e-05 eta 0:01:17
epoch [48/50] batch [200/319] time 0.111 (0.100) data 0.000 (0.003) loss 1.8926 (1.6102) ce_loss 1.4404 (1.0747) teacher_loss 1.1514 (0.8688) loss_zs_kd 0.8192 (0.9525) loss_oracle 0.7411 (0.7414) acc 40.6250 (59.2500) kd_loss 0.8522 (0.8504) lr 3.1417e-05 eta 0:01:15
epoch [48/50] batch [220/319] time 0.098 (0.100) data 0.000 (0.003) loss 1.4875 (1.6104) ce_loss 0.8599 (1.0753) teacher_loss 0.7665 (0.8685) loss_zs_kd 0.7925 (0.9520) loss_oracle 0.7210 (0.7419) acc 65.6250 (59.2045) kd_loss 0.8232 (0.8508) lr 3.1417e-05 eta 0:01:13
epoch [48/50] batch [240/319] time 0.108 (0.100) data 0.000 (0.003) loss 1.8661 (1.6145) ce_loss 1.2705 (1.0766) teacher_loss 1.1222 (0.8725) loss_zs_kd 0.9773 (0.9503) loss_oracle 0.7439 (0.7420) acc 53.1250 (59.1797) kd_loss 0.8121 (0.8509) lr 3.1417e-05 eta 0:01:12
epoch [48/50] batch [260/319] time 0.111 (0.101) data 0.000 (0.002) loss 1.7191 (1.6108) ce_loss 1.1650 (1.0744) teacher_loss 1.0367 (0.8689) loss_zs_kd 1.2414 (0.9528) loss_oracle 0.6824 (0.7419) acc 59.3750 (59.2788) kd_loss 0.8629 (0.8516) lr 3.1417e-05 eta 0:01:10
epoch [48/50] batch [280/319] time 0.088 (0.101) data 0.001 (0.002) loss 1.9621 (1.6082) ce_loss 1.5518 (1.0714) teacher_loss 1.2690 (0.8662) loss_zs_kd 0.9982 (0.9485) loss_oracle 0.6932 (0.7420) acc 43.7500 (59.5201) kd_loss 0.7816 (0.8508) lr 3.1417e-05 eta 0:01:08
epoch [48/50] batch [300/319] time 0.157 (0.100) data 0.000 (0.002) loss 1.5905 (1.6102) ce_loss 0.9272 (1.0712) teacher_loss 0.8550 (0.8679) loss_zs_kd 0.9221 (0.9454) loss_oracle 0.7355 (0.7422) acc 62.5000 (59.5521) kd_loss 0.8524 (0.8494) lr 3.1417e-05 eta 0:01:05
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,865
* accuracy: 65.4%
* error: 34.6%
* macro_f1: 57.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,189
* accuracy: 53.3%
* error: 46.7%
* macro_f1: 22.7%
******* Domain 2 best val acc:      65.6%, epoch: 46 *******
******* Domain 2 best val test acc: 53.4%, epoch: 46 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [49/50] batch [20/319] time 0.100 (0.135) data 0.000 (0.029) loss 1.5399 (1.5924) ce_loss 0.9956 (1.0701) teacher_loss 0.7795 (0.8390) loss_zs_kd 0.9041 (0.9646) loss_oracle 0.7604 (0.7534) acc 62.5000 (57.9688) kd_loss 0.8672 (0.8347) lr 1.7713e-05 eta 0:01:23
epoch [49/50] batch [40/319] time 0.103 (0.119) data 0.000 (0.015) loss 1.7797 (1.6176) ce_loss 1.0703 (1.0598) teacher_loss 1.1071 (0.8757) loss_zs_kd 0.9171 (0.9552) loss_oracle 0.6726 (0.7419) acc 56.2500 (58.9844) kd_loss 0.8476 (0.8352) lr 1.7713e-05 eta 0:01:11
epoch [49/50] batch [60/319] time 0.109 (0.110) data 0.001 (0.010) loss 1.3944 (1.6209) ce_loss 0.7412 (1.0712) teacher_loss 0.6032 (0.8777) loss_zs_kd 0.7727 (0.9511) loss_oracle 0.7912 (0.7432) acc 75.0000 (58.9062) kd_loss 0.8827 (0.8411) lr 1.7713e-05 eta 0:01:03
epoch [49/50] batch [80/319] time 0.099 (0.108) data 0.000 (0.008) loss 1.6680 (1.6274) ce_loss 1.1279 (1.0765) teacher_loss 0.9913 (0.8862) loss_zs_kd 1.0004 (0.9384) loss_oracle 0.6767 (0.7413) acc 43.7500 (59.5312) kd_loss 0.8581 (0.8475) lr 1.7713e-05 eta 0:01:00
epoch [49/50] batch [100/319] time 0.103 (0.107) data 0.000 (0.006) loss 1.5155 (1.6067) ce_loss 0.9702 (1.0586) teacher_loss 0.8481 (0.8659) loss_zs_kd 1.1048 (0.9350) loss_oracle 0.6674 (0.7408) acc 62.5000 (60.2500) kd_loss 0.8131 (0.8496) lr 1.7713e-05 eta 0:00:57
epoch [49/50] batch [120/319] time 0.110 (0.106) data 0.000 (0.005) loss 1.4097 (1.6165) ce_loss 0.8496 (1.0716) teacher_loss 0.6409 (0.8775) loss_zs_kd 1.0618 (0.9334) loss_oracle 0.7689 (0.7390) acc 71.8750 (59.6875) kd_loss 0.8691 (0.8513) lr 1.7713e-05 eta 0:00:55
epoch [49/50] batch [140/319] time 0.100 (0.106) data 0.000 (0.004) loss 1.4623 (1.6113) ce_loss 1.0146 (1.0693) teacher_loss 0.7482 (0.8731) loss_zs_kd 0.8439 (0.9374) loss_oracle 0.7140 (0.7382) acc 68.7500 (59.9777) kd_loss 0.8543 (0.8512) lr 1.7713e-05 eta 0:00:52
epoch [49/50] batch [160/319] time 0.094 (0.106) data 0.000 (0.004) loss 1.2669 (1.6128) ce_loss 0.8589 (1.0659) teacher_loss 0.5859 (0.8752) loss_zs_kd 0.8758 (0.9415) loss_oracle 0.6810 (0.7376) acc 75.0000 (59.8438) kd_loss 0.8353 (0.8495) lr 1.7713e-05 eta 0:00:50
epoch [49/50] batch [180/319] time 0.100 (0.106) data 0.000 (0.003) loss 1.5616 (1.6233) ce_loss 1.0850 (1.0751) teacher_loss 0.8355 (0.8860) loss_zs_kd 0.8144 (0.9428) loss_oracle 0.7261 (0.7373) acc 62.5000 (59.4618) kd_loss 0.8759 (0.8482) lr 1.7713e-05 eta 0:00:48
epoch [49/50] batch [200/319] time 0.106 (0.105) data 0.000 (0.003) loss 1.4651 (1.6260) ce_loss 0.9697 (1.0768) teacher_loss 0.6863 (0.8884) loss_zs_kd 1.0759 (0.9463) loss_oracle 0.7789 (0.7375) acc 53.1250 (59.3438) kd_loss 0.8750 (0.8468) lr 1.7713e-05 eta 0:00:46
epoch [49/50] batch [220/319] time 0.112 (0.105) data 0.000 (0.003) loss 1.7504 (1.6236) ce_loss 1.1914 (1.0770) teacher_loss 1.0035 (0.8866) loss_zs_kd 0.9120 (0.9470) loss_oracle 0.7469 (0.7370) acc 53.1250 (59.1761) kd_loss 0.8439 (0.8476) lr 1.7713e-05 eta 0:00:43
epoch [49/50] batch [240/319] time 0.109 (0.105) data 0.000 (0.003) loss 1.5438 (1.6288) ce_loss 0.9438 (1.0799) teacher_loss 0.7899 (0.8910) loss_zs_kd 1.0198 (0.9489) loss_oracle 0.7538 (0.7378) acc 59.3750 (59.2708) kd_loss 0.8260 (0.8484) lr 1.7713e-05 eta 0:00:41
epoch [49/50] batch [260/319] time 0.097 (0.105) data 0.000 (0.003) loss 1.5588 (1.6262) ce_loss 1.2021 (1.0763) teacher_loss 0.7806 (0.8889) loss_zs_kd 0.9876 (0.9477) loss_oracle 0.7782 (0.7374) acc 56.2500 (59.3149) kd_loss 0.8138 (0.8485) lr 1.7713e-05 eta 0:00:39
epoch [49/50] batch [280/319] time 0.103 (0.105) data 0.000 (0.002) loss 1.2497 (1.6266) ce_loss 0.8013 (1.0780) teacher_loss 0.5350 (0.8892) loss_zs_kd 0.9182 (0.9464) loss_oracle 0.7147 (0.7374) acc 62.5000 (59.0960) kd_loss 0.9292 (0.8480) lr 1.7713e-05 eta 0:00:37
epoch [49/50] batch [300/319] time 0.085 (0.105) data 0.000 (0.002) loss 1.4900 (1.6189) ce_loss 0.9272 (1.0704) teacher_loss 0.7705 (0.8812) loss_zs_kd 1.0495 (0.9497) loss_oracle 0.7195 (0.7378) acc 65.6250 (59.3854) kd_loss 0.8034 (0.8484) lr 1.7713e-05 eta 0:00:35
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,868
* accuracy: 65.5%
* error: 34.5%
* macro_f1: 57.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,193
* accuracy: 53.3%
* error: 46.7%
* macro_f1: 22.7%
******* Domain 2 best val acc:      65.6%, epoch: 46 *******
******* Domain 2 best val test acc: 53.4%, epoch: 46 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
epoch [50/50] batch [20/319] time 0.102 (0.124) data 0.000 (0.027) loss 1.3187 (1.6698) ce_loss 0.9521 (1.0967) teacher_loss 0.6190 (0.9300) loss_zs_kd 0.9499 (0.9456) loss_oracle 0.6997 (0.7398) acc 65.6250 (57.0312) kd_loss 0.8983 (0.8527) lr 7.8853e-06 eta 0:00:37
epoch [50/50] batch [40/319] time 0.090 (0.109) data 0.000 (0.013) loss 1.7052 (1.6376) ce_loss 1.0039 (1.0728) teacher_loss 0.9544 (0.8991) loss_zs_kd 1.3246 (0.9480) loss_oracle 0.7508 (0.7385) acc 68.7500 (58.2812) kd_loss 0.8638 (0.8467) lr 7.8853e-06 eta 0:00:30
epoch [50/50] batch [60/319] time 0.092 (0.103) data 0.000 (0.009) loss 1.5975 (1.6349) ce_loss 0.9326 (1.0695) teacher_loss 0.8480 (0.8958) loss_zs_kd 0.9298 (0.9531) loss_oracle 0.7495 (0.7391) acc 65.6250 (59.3750) kd_loss 0.8329 (0.8528) lr 7.8853e-06 eta 0:00:26
epoch [50/50] batch [80/319] time 0.092 (0.100) data 0.000 (0.007) loss 1.4484 (1.6153) ce_loss 1.0830 (1.0600) teacher_loss 0.7465 (0.8770) loss_zs_kd 0.7929 (0.9464) loss_oracle 0.7019 (0.7382) acc 53.1250 (59.6094) kd_loss 0.8384 (0.8562) lr 7.8853e-06 eta 0:00:23
epoch [50/50] batch [100/319] time 0.083 (0.097) data 0.000 (0.006) loss 1.7990 (1.6282) ce_loss 1.2441 (1.0703) teacher_loss 1.0522 (0.8898) loss_zs_kd 0.8336 (0.9414) loss_oracle 0.7468 (0.7385) acc 62.5000 (59.2188) kd_loss 0.9115 (0.8537) lr 7.8853e-06 eta 0:00:21
epoch [50/50] batch [120/319] time 0.088 (0.096) data 0.000 (0.005) loss 1.7776 (1.6239) ce_loss 1.1992 (1.0722) teacher_loss 0.9912 (0.8832) loss_zs_kd 0.7456 (0.9346) loss_oracle 0.7864 (0.7407) acc 65.6250 (59.1146) kd_loss 0.8309 (0.8519) lr 7.8853e-06 eta 0:00:19
epoch [50/50] batch [140/319] time 0.090 (0.095) data 0.000 (0.004) loss 1.3483 (1.6212) ce_loss 0.7617 (1.0703) teacher_loss 0.6719 (0.8804) loss_zs_kd 0.9461 (0.9356) loss_oracle 0.6764 (0.7408) acc 75.0000 (59.0848) kd_loss 0.9407 (0.8529) lr 7.8853e-06 eta 0:00:17
epoch [50/50] batch [160/319] time 0.085 (0.095) data 0.000 (0.004) loss 1.6833 (1.6299) ce_loss 1.0391 (1.0767) teacher_loss 0.9508 (0.8876) loss_zs_kd 0.7837 (0.9423) loss_oracle 0.7325 (0.7422) acc 59.3750 (58.6719) kd_loss 0.8342 (0.8514) lr 7.8853e-06 eta 0:00:15
epoch [50/50] batch [180/319] time 0.089 (0.094) data 0.000 (0.003) loss 1.4245 (1.6268) ce_loss 1.0273 (1.0772) teacher_loss 0.7262 (0.8849) loss_zs_kd 1.1514 (0.9454) loss_oracle 0.6983 (0.7419) acc 56.2500 (58.5590) kd_loss 0.9188 (0.8518) lr 7.8853e-06 eta 0:00:13
epoch [50/50] batch [200/319] time 0.107 (0.094) data 0.000 (0.003) loss 1.5050 (1.6300) ce_loss 1.0713 (1.0798) teacher_loss 0.7673 (0.8882) loss_zs_kd 0.9540 (0.9463) loss_oracle 0.7377 (0.7418) acc 68.7500 (58.7500) kd_loss 0.8283 (0.8529) lr 7.8853e-06 eta 0:00:11
epoch [50/50] batch [220/319] time 0.101 (0.095) data 0.000 (0.003) loss 1.5537 (1.6258) ce_loss 0.8652 (1.0753) teacher_loss 0.8157 (0.8834) loss_zs_kd 0.9913 (0.9470) loss_oracle 0.7379 (0.7424) acc 71.8750 (58.7074) kd_loss 0.8146 (0.8514) lr 7.8853e-06 eta 0:00:09
epoch [50/50] batch [240/319] time 0.107 (0.096) data 0.000 (0.002) loss 1.6360 (1.6182) ce_loss 1.2559 (1.0707) teacher_loss 0.9436 (0.8756) loss_zs_kd 0.7358 (0.9434) loss_oracle 0.6923 (0.7426) acc 53.1250 (58.9193) kd_loss 0.9464 (0.8509) lr 7.8853e-06 eta 0:00:07
epoch [50/50] batch [260/319] time 0.096 (0.096) data 0.000 (0.002) loss 1.4252 (1.6210) ce_loss 0.9590 (1.0719) teacher_loss 0.6861 (0.8785) loss_zs_kd 1.0644 (0.9445) loss_oracle 0.7391 (0.7425) acc 68.7500 (58.9303) kd_loss 0.8677 (0.8504) lr 7.8853e-06 eta 0:00:05
epoch [50/50] batch [280/319] time 0.100 (0.097) data 0.000 (0.002) loss 2.2032 (1.6188) ce_loss 1.4590 (1.0708) teacher_loss 1.4936 (0.8761) loss_zs_kd 0.8484 (0.9427) loss_oracle 0.7096 (0.7427) acc 40.6250 (59.1741) kd_loss 0.8858 (0.8495) lr 7.8853e-06 eta 0:00:03
epoch [50/50] batch [300/319] time 0.095 (0.097) data 0.000 (0.002) loss 1.6790 (1.6135) ce_loss 1.2334 (1.0682) teacher_loss 0.9190 (0.8710) loss_zs_kd 1.0599 (0.9431) loss_oracle 0.7600 (0.7425) acc 56.2500 (59.3750) kd_loss 0.8353 (0.8496) lr 7.8853e-06 eta 0:00:01
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,865
* accuracy: 65.4%
* error: 34.6%
* macro_f1: 57.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,195
* accuracy: 53.4%
* error: 46.6%
* macro_f1: 22.7%
******* Domain 2 best val acc:      65.6%, epoch: 46 *******
******* Domain 2 best val test acc: 53.4%, epoch: 46 *******
******* Domain 2 best test acc:     57.0%, epoch: 29 *******
Checkpoint saved to icml/multi-dg/oracle/07_nouse_ema_and_0.0zeroshot_and_tau0.1_alpha0.9/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:47:34
