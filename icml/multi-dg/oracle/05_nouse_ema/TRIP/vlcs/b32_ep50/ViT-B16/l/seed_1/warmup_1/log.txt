Loading trainer: TRIP
Loading dataset: SPG_VLCS
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------
Dataset    SPG_VLCS
Source     ['caltech', 'pascal', 'sun']
Target     ['labelme']
# classes  5
# train_x  5,651
# val      2,422
# test     2,656
---------  ----------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/oracle/05_nouse_ema/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/176] time 0.127 (0.171) data 0.000 (0.017) loss 0.5805 (0.7137) ce_loss 0.3704 (0.5077) teacher_loss 0.3717 (0.5075) loss_zs_kd 0.0000 (0.0000) loss_oracle 0.2088 (0.2062) acc 81.2500 (80.6250) kd_loss 0.9844 (0.9748) lr 1.0000e-05 eta 0:25:01
epoch [1/50] batch [40/176] time 0.098 (0.134) data 0.000 (0.009) loss 0.7336 (0.7314) ce_loss 0.5273 (0.5271) teacher_loss 0.5277 (0.5271) loss_zs_kd 0.0001 (0.0000) loss_oracle 0.2058 (0.2043) acc 81.2500 (80.6250) kd_loss 0.9775 (0.9663) lr 1.0000e-05 eta 0:19:36
epoch [1/50] batch [60/176] time 0.138 (0.127) data 0.000 (0.006) loss 0.7304 (0.7350) ce_loss 0.5229 (0.5302) teacher_loss 0.5224 (0.5302) loss_zs_kd 0.0002 (0.0001) loss_oracle 0.2079 (0.2048) acc 78.1250 (81.1458) kd_loss 0.9839 (0.9684) lr 1.0000e-05 eta 0:18:29
epoch [1/50] batch [80/176] time 0.095 (0.123) data 0.000 (0.004) loss 0.6630 (0.7324) ce_loss 0.4558 (0.5279) teacher_loss 0.4546 (0.5278) loss_zs_kd 0.0003 (0.0001) loss_oracle 0.2083 (0.2046) acc 87.5000 (81.6016) kd_loss 0.9907 (0.9679) lr 1.0000e-05 eta 0:17:55
epoch [1/50] batch [100/176] time 0.112 (0.121) data 0.000 (0.004) loss 0.5589 (0.7240) ce_loss 0.3638 (0.5197) teacher_loss 0.3657 (0.5196) loss_zs_kd 0.0006 (0.0002) loss_oracle 0.1929 (0.2043) acc 87.5000 (81.9688) kd_loss 0.9249 (0.9667) lr 1.0000e-05 eta 0:17:35
epoch [1/50] batch [120/176] time 0.135 (0.120) data 0.000 (0.003) loss 0.4504 (0.7230) ce_loss 0.2434 (0.5182) teacher_loss 0.2444 (0.5180) loss_zs_kd 0.0006 (0.0002) loss_oracle 0.2057 (0.2048) acc 93.7500 (81.9531) kd_loss 0.9751 (0.9687) lr 1.0000e-05 eta 0:17:23
epoch [1/50] batch [140/176] time 0.089 (0.120) data 0.000 (0.003) loss 0.8633 (0.7337) ce_loss 0.6470 (0.5294) teacher_loss 0.6524 (0.5293) loss_zs_kd 0.0008 (0.0003) loss_oracle 0.2104 (0.2042) acc 78.1250 (81.5402) kd_loss 0.9942 (0.9659) lr 1.0000e-05 eta 0:17:19
epoch [1/50] batch [160/176] time 0.103 (0.119) data 0.000 (0.002) loss 0.5354 (0.7324) ce_loss 0.3203 (0.5278) teacher_loss 0.3212 (0.5278) loss_zs_kd 0.0005 (0.0004) loss_oracle 0.2139 (0.2044) acc 87.5000 (81.3867) kd_loss 1.0108 (0.9667) lr 1.0000e-05 eta 0:17:09
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,074
* accuracy: 85.6%
* error: 14.4%
* macro_f1: 88.0%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,828
* accuracy: 68.8%
* error: 31.2%
* macro_f1: 61.4%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain l best val acc:      85.6%, epoch: 1 *******
******* Domain l best val test acc: 68.8%, epoch: 1 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/oracle/05_nouse_ema/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/ana
epoch [2/50] batch [20/176] time 0.111 (0.143) data 0.000 (0.018) loss 0.9256 (0.8442) ce_loss 0.5581 (0.5246) teacher_loss 0.5718 (0.5312) loss_zs_kd 0.0702 (0.0535) loss_oracle 0.3187 (0.2863) acc 78.1250 (79.6875) kd_loss 1.0050 (0.9840) lr 2.0000e-03 eta 0:20:33
epoch [2/50] batch [40/176] time 0.097 (0.127) data 0.000 (0.009) loss 0.9978 (0.8952) ce_loss 0.5366 (0.4942) teacher_loss 0.5228 (0.4941) loss_zs_kd 0.0894 (0.0646) loss_oracle 0.4303 (0.3688) acc 75.0000 (81.2500) kd_loss 0.9731 (1.0002) lr 2.0000e-03 eta 0:18:10
epoch [2/50] batch [60/176] time 0.091 (0.117) data 0.000 (0.006) loss 1.1649 (0.9103) ce_loss 0.4167 (0.4841) teacher_loss 0.4319 (0.4868) loss_zs_kd 0.0509 (0.0682) loss_oracle 0.7076 (0.3894) acc 84.3750 (81.9271) kd_loss 1.0214 (1.0068) lr 2.0000e-03 eta 0:16:44
epoch [2/50] batch [80/176] time 0.076 (0.113) data 0.000 (0.005) loss 1.1527 (0.9342) ce_loss 0.6743 (0.4718) teacher_loss 0.6675 (0.4684) loss_zs_kd 0.1055 (0.0723) loss_oracle 0.4325 (0.4297) acc 81.2500 (82.3047) kd_loss 0.9732 (1.0101) lr 2.0000e-03 eta 0:16:01
epoch [2/50] batch [100/176] time 0.131 (0.112) data 0.000 (0.004) loss 1.0979 (0.9232) ce_loss 0.7803 (0.4710) teacher_loss 0.7206 (0.4620) loss_zs_kd 0.0749 (0.0752) loss_oracle 0.3398 (0.4236) acc 75.0000 (82.5938) kd_loss 0.9854 (1.0123) lr 2.0000e-03 eta 0:15:52
epoch [2/50] batch [120/176] time 0.081 (0.111) data 0.000 (0.003) loss 0.7948 (0.8984) ce_loss 0.4124 (0.4634) teacher_loss 0.4270 (0.4544) loss_zs_kd 0.0870 (0.0758) loss_oracle 0.3242 (0.4061) acc 84.3750 (82.9427) kd_loss 1.0289 (1.0112) lr 2.0000e-03 eta 0:15:42
epoch [2/50] batch [140/176] time 0.107 (0.110) data 0.000 (0.003) loss 0.5828 (0.8833) ce_loss 0.2422 (0.4565) teacher_loss 0.2469 (0.4482) loss_zs_kd 0.0392 (0.0756) loss_oracle 0.3162 (0.3973) acc 90.6250 (83.3929) kd_loss 1.0338 (1.0097) lr 2.0000e-03 eta 0:15:36
epoch [2/50] batch [160/176] time 0.084 (0.110) data 0.000 (0.002) loss 0.6624 (0.8742) ce_loss 0.2954 (0.4499) teacher_loss 0.3033 (0.4407) loss_zs_kd 0.0342 (0.0780) loss_oracle 0.3420 (0.3945) acc 90.6250 (83.7109) kd_loss 1.0069 (1.0094) lr 2.0000e-03 eta 0:15:29
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,163
* accuracy: 89.3%
* error: 10.7%
* macro_f1: 91.3%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,686
* accuracy: 63.5%
* error: 36.5%
* macro_f1: 60.2%
******* Domain l best val acc:      89.3%, epoch: 2 *******
******* Domain l best val test acc: 63.5%, epoch: 2 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [3/50] batch [20/176] time 0.152 (0.150) data 0.000 (0.016) loss 1.1518 (0.7961) ce_loss 0.7461 (0.4375) teacher_loss 0.6827 (0.4118) loss_zs_kd 0.1325 (0.0802) loss_oracle 0.4029 (0.3443) acc 68.7500 (83.2812) kd_loss 0.9913 (0.9993) lr 1.9980e-03 eta 0:21:02
epoch [3/50] batch [40/176] time 0.112 (0.133) data 0.000 (0.008) loss 0.8258 (0.8133) ce_loss 0.3652 (0.4299) teacher_loss 0.3956 (0.4132) loss_zs_kd 0.0867 (0.0823) loss_oracle 0.3868 (0.3590) acc 87.5000 (83.8281) kd_loss 0.9810 (0.9965) lr 1.9980e-03 eta 0:18:37
epoch [3/50] batch [60/176] time 0.100 (0.120) data 0.000 (0.005) loss 0.8775 (0.7778) ce_loss 0.5869 (0.4054) teacher_loss 0.5586 (0.3925) loss_zs_kd 0.0888 (0.0841) loss_oracle 0.2745 (0.3432) acc 81.2500 (85.2604) kd_loss 0.9968 (0.9965) lr 1.9980e-03 eta 0:16:43
epoch [3/50] batch [80/176] time 0.093 (0.113) data 0.000 (0.004) loss 0.5537 (0.7563) ce_loss 0.2737 (0.3934) teacher_loss 0.2456 (0.3814) loss_zs_kd 0.0545 (0.0818) loss_oracle 0.2809 (0.3340) acc 84.3750 (85.8594) kd_loss 0.9796 (0.9924) lr 1.9980e-03 eta 0:15:43
epoch [3/50] batch [100/176] time 0.111 (0.111) data 0.000 (0.003) loss 0.7019 (0.7533) ce_loss 0.3457 (0.4002) teacher_loss 0.3396 (0.3895) loss_zs_kd 0.1054 (0.0823) loss_oracle 0.3095 (0.3227) acc 84.3750 (85.6250) kd_loss 1.0047 (0.9894) lr 1.9980e-03 eta 0:15:30
epoch [3/50] batch [120/176] time 0.088 (0.112) data 0.000 (0.003) loss 0.6093 (0.7460) ce_loss 0.3174 (0.3986) teacher_loss 0.2740 (0.3874) loss_zs_kd 0.1191 (0.0829) loss_oracle 0.2758 (0.3172) acc 84.3750 (85.7031) kd_loss 0.9747 (0.9913) lr 1.9980e-03 eta 0:15:31
epoch [3/50] batch [140/176] time 0.096 (0.111) data 0.000 (0.002) loss 0.6442 (0.7408) ce_loss 0.2563 (0.3958) teacher_loss 0.2620 (0.3833) loss_zs_kd 0.0846 (0.0844) loss_oracle 0.3398 (0.3153) acc 90.6250 (85.8929) kd_loss 0.9874 (0.9916) lr 1.9980e-03 eta 0:15:23
epoch [3/50] batch [160/176] time 0.112 (0.111) data 0.000 (0.002) loss 0.6641 (0.7471) ce_loss 0.3320 (0.4006) teacher_loss 0.2844 (0.3864) loss_zs_kd 0.0982 (0.0856) loss_oracle 0.3306 (0.3179) acc 84.3750 (85.9766) kd_loss 1.0133 (0.9908) lr 1.9980e-03 eta 0:15:23
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,175
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 91.7%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,733
* accuracy: 65.2%
* error: 34.8%
* macro_f1: 60.9%
******* Domain l best val acc:      89.8%, epoch: 3 *******
******* Domain l best val test acc: 65.2%, epoch: 3 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [4/50] batch [20/176] time 0.136 (0.134) data 0.000 (0.015) loss 0.6704 (0.7728) ce_loss 0.3228 (0.4138) teacher_loss 0.2933 (0.3850) loss_zs_kd 0.0930 (0.1009) loss_oracle 0.3305 (0.3373) acc 93.7500 (86.5625) kd_loss 1.0504 (1.0042) lr 1.9921e-03 eta 0:18:22
epoch [4/50] batch [40/176] time 0.084 (0.126) data 0.000 (0.007) loss 0.6593 (0.7630) ce_loss 0.3167 (0.3877) teacher_loss 0.2817 (0.3595) loss_zs_kd 0.0690 (0.0960) loss_oracle 0.3430 (0.3555) acc 90.6250 (86.6406) kd_loss 1.0535 (1.0231) lr 1.9921e-03 eta 0:17:17
epoch [4/50] batch [60/176] time 0.136 (0.126) data 0.001 (0.005) loss 0.6888 (0.7620) ce_loss 0.3923 (0.3968) teacher_loss 0.2814 (0.3612) loss_zs_kd 0.0986 (0.0958) loss_oracle 0.3581 (0.3529) acc 75.0000 (85.7812) kd_loss 1.0845 (1.0343) lr 1.9921e-03 eta 0:17:13
epoch [4/50] batch [80/176] time 0.137 (0.123) data 0.000 (0.004) loss 0.8302 (0.7577) ce_loss 0.4656 (0.3968) teacher_loss 0.4819 (0.3626) loss_zs_kd 0.1186 (0.0949) loss_oracle 0.2890 (0.3476) acc 75.0000 (85.7031) kd_loss 0.9862 (1.0364) lr 1.9921e-03 eta 0:16:49
epoch [4/50] batch [100/176] time 0.099 (0.122) data 0.000 (0.003) loss 0.5875 (0.7543) ce_loss 0.2456 (0.4023) teacher_loss 0.2270 (0.3652) loss_zs_kd 0.0838 (0.0958) loss_oracle 0.3185 (0.3412) acc 87.5000 (85.3125) kd_loss 1.0362 (1.0318) lr 1.9921e-03 eta 0:16:34
epoch [4/50] batch [120/176] time 0.131 (0.121) data 0.000 (0.003) loss 0.5259 (0.7585) ce_loss 0.1749 (0.4090) teacher_loss 0.1722 (0.3719) loss_zs_kd 0.0912 (0.0976) loss_oracle 0.3080 (0.3378) acc 93.7500 (85.2604) kd_loss 1.0217 (1.0259) lr 1.9921e-03 eta 0:16:22
epoch [4/50] batch [140/176] time 0.100 (0.120) data 0.000 (0.002) loss 0.8788 (0.7553) ce_loss 0.6387 (0.4106) teacher_loss 0.4943 (0.3701) loss_zs_kd 0.1321 (0.1023) loss_oracle 0.3184 (0.3340) acc 78.1250 (85.2679) kd_loss 0.9434 (1.0216) lr 1.9921e-03 eta 0:16:14
epoch [4/50] batch [160/176] time 0.085 (0.118) data 0.000 (0.002) loss 0.5266 (0.7497) ce_loss 0.2622 (0.4064) teacher_loss 0.1998 (0.3663) loss_zs_kd 0.1157 (0.1034) loss_oracle 0.2690 (0.3317) acc 93.7500 (85.7031) kd_loss 0.9520 (1.0196) lr 1.9921e-03 eta 0:16:00
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,174
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 91.8%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,708
* accuracy: 64.3%
* error: 35.7%
* macro_f1: 60.0%
******* Domain l best val acc:      89.8%, epoch: 3 *******
******* Domain l best val test acc: 65.2%, epoch: 3 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [5/50] batch [20/176] time 0.131 (0.140) data 0.000 (0.014) loss 0.6273 (0.6855) ce_loss 0.3179 (0.3860) teacher_loss 0.3023 (0.3139) loss_zs_kd 0.1023 (0.1113) loss_oracle 0.2739 (0.3160) acc 87.5000 (85.4688) kd_loss 1.0274 (1.0441) lr 1.9823e-03 eta 0:18:48
epoch [5/50] batch [40/176] time 0.076 (0.134) data 0.000 (0.007) loss 0.6622 (0.6833) ce_loss 0.3279 (0.3893) teacher_loss 0.3129 (0.3270) loss_zs_kd 0.1028 (0.1069) loss_oracle 0.2979 (0.3029) acc 93.7500 (86.0156) kd_loss 1.0135 (1.0345) lr 1.9823e-03 eta 0:18:00
epoch [5/50] batch [60/176] time 0.063 (0.134) data 0.000 (0.005) loss 0.4757 (0.6558) ce_loss 0.2083 (0.3664) teacher_loss 0.1475 (0.3151) loss_zs_kd 0.0670 (0.1005) loss_oracle 0.2947 (0.2905) acc 96.8750 (87.5521) kd_loss 1.0392 (1.0243) lr 1.9823e-03 eta 0:17:54
epoch [5/50] batch [80/176] time 0.085 (0.127) data 0.000 (0.004) loss 0.7052 (0.6808) ce_loss 0.4233 (0.3874) teacher_loss 0.3642 (0.3303) loss_zs_kd 0.1167 (0.1025) loss_oracle 0.2826 (0.2993) acc 84.3750 (86.7578) kd_loss 1.0611 (1.0244) lr 1.9823e-03 eta 0:17:00
epoch [5/50] batch [100/176] time 0.123 (0.125) data 0.000 (0.003) loss 0.5996 (0.6789) ce_loss 0.3389 (0.3907) teacher_loss 0.2740 (0.3334) loss_zs_kd 0.0856 (0.1035) loss_oracle 0.2828 (0.2937) acc 84.3750 (86.4375) kd_loss 1.0502 (1.0227) lr 1.9823e-03 eta 0:16:35
epoch [5/50] batch [120/176] time 0.090 (0.122) data 0.000 (0.003) loss 0.7393 (0.6819) ce_loss 0.3813 (0.3965) teacher_loss 0.4257 (0.3393) loss_zs_kd 0.0901 (0.1055) loss_oracle 0.2685 (0.2899) acc 81.2500 (86.2760) kd_loss 0.9998 (1.0218) lr 1.9823e-03 eta 0:16:16
epoch [5/50] batch [140/176] time 0.089 (0.121) data 0.000 (0.002) loss 0.5408 (0.6840) ce_loss 0.2335 (0.3975) teacher_loss 0.2079 (0.3430) loss_zs_kd 0.0842 (0.1035) loss_oracle 0.2908 (0.2893) acc 100.0000 (86.5402) kd_loss 1.0768 (1.0235) lr 1.9823e-03 eta 0:16:00
epoch [5/50] batch [160/176] time 0.091 (0.120) data 0.000 (0.002) loss 0.5550 (0.6867) ce_loss 0.3123 (0.3994) teacher_loss 0.2859 (0.3489) loss_zs_kd 0.0809 (0.1024) loss_oracle 0.2286 (0.2866) acc 87.5000 (86.2500) kd_loss 1.0358 (1.0224) lr 1.9823e-03 eta 0:15:53
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,174
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 91.7%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,767
* accuracy: 66.5%
* error: 33.5%
* macro_f1: 61.2%
******* Domain l best val acc:      89.8%, epoch: 3 *******
******* Domain l best val test acc: 65.2%, epoch: 3 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [6/50] batch [20/176] time 0.095 (0.106) data 0.000 (0.013) loss 0.5471 (0.6994) ce_loss 0.1752 (0.3695) teacher_loss 0.1749 (0.3427) loss_zs_kd 0.0941 (0.0897) loss_oracle 0.3252 (0.3119) acc 93.7500 (87.0312) kd_loss 1.0813 (1.0082) lr 1.9686e-03 eta 0:14:00
epoch [6/50] batch [40/176] time 0.085 (0.100) data 0.000 (0.007) loss 0.6606 (0.7410) ce_loss 0.3518 (0.3911) teacher_loss 0.3367 (0.3680) loss_zs_kd 0.0751 (0.0971) loss_oracle 0.2863 (0.3245) acc 84.3750 (85.8594) kd_loss 1.0210 (0.9992) lr 1.9686e-03 eta 0:13:04
epoch [6/50] batch [60/176] time 0.085 (0.097) data 0.000 (0.004) loss 0.5666 (0.7420) ce_loss 0.2546 (0.3954) teacher_loss 0.2528 (0.3775) loss_zs_kd 0.0821 (0.0947) loss_oracle 0.2728 (0.3172) acc 93.7500 (85.9896) kd_loss 1.0200 (0.9940) lr 1.9686e-03 eta 0:12:43
epoch [6/50] batch [80/176] time 0.078 (0.094) data 0.000 (0.003) loss 0.4761 (0.7185) ce_loss 0.2142 (0.3829) teacher_loss 0.1740 (0.3652) loss_zs_kd 0.0686 (0.0949) loss_oracle 0.2679 (0.3058) acc 93.7500 (86.7188) kd_loss 1.0398 (0.9938) lr 1.9686e-03 eta 0:12:20
epoch [6/50] batch [100/176] time 0.087 (0.094) data 0.000 (0.003) loss 0.7721 (0.7177) ce_loss 0.4595 (0.3891) teacher_loss 0.4068 (0.3692) loss_zs_kd 0.1204 (0.0959) loss_oracle 0.3051 (0.3006) acc 84.3750 (86.6250) kd_loss 1.0164 (0.9966) lr 1.9686e-03 eta 0:12:12
epoch [6/50] batch [120/176] time 0.074 (0.093) data 0.001 (0.002) loss 0.8128 (0.7172) ce_loss 0.5410 (0.3901) teacher_loss 0.4627 (0.3685) loss_zs_kd 0.0982 (0.0984) loss_oracle 0.3010 (0.2995) acc 78.1250 (86.3802) kd_loss 1.0231 (0.9979) lr 1.9686e-03 eta 0:12:08
epoch [6/50] batch [140/176] time 0.080 (0.093) data 0.000 (0.002) loss 0.7785 (0.7105) ce_loss 0.4465 (0.3897) teacher_loss 0.4703 (0.3670) loss_zs_kd 0.1025 (0.0978) loss_oracle 0.2570 (0.2946) acc 87.5000 (86.6071) kd_loss 0.9596 (0.9978) lr 1.9686e-03 eta 0:12:00
epoch [6/50] batch [160/176] time 0.082 (0.093) data 0.000 (0.002) loss 0.7922 (0.7110) ce_loss 0.4626 (0.3925) teacher_loss 0.4212 (0.3700) loss_zs_kd 0.1231 (0.0972) loss_oracle 0.3094 (0.2924) acc 84.3750 (86.4062) kd_loss 0.9869 (0.9978) lr 1.9686e-03 eta 0:11:59
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,177
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 91.8%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,714
* accuracy: 64.5%
* error: 35.5%
* macro_f1: 59.2%
******* Domain l best val acc:      89.9%, epoch: 6 *******
******* Domain l best val test acc: 64.5%, epoch: 6 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [7/50] batch [20/176] time 0.089 (0.118) data 0.000 (0.015) loss 0.7413 (0.6646) ce_loss 0.4160 (0.3679) teacher_loss 0.4239 (0.3480) loss_zs_kd 0.0837 (0.0916) loss_oracle 0.2755 (0.2708) acc 87.5000 (87.8125) kd_loss 1.0632 (1.0153) lr 1.9511e-03 eta 0:15:08
epoch [7/50] batch [40/176] time 0.084 (0.106) data 0.000 (0.007) loss 0.6328 (0.6723) ce_loss 0.2803 (0.3670) teacher_loss 0.2955 (0.3447) loss_zs_kd 0.1080 (0.0903) loss_oracle 0.2834 (0.2825) acc 87.5000 (87.0312) kd_loss 1.0316 (1.0165) lr 1.9511e-03 eta 0:13:35
epoch [7/50] batch [60/176] time 0.079 (0.100) data 0.000 (0.005) loss 0.6921 (0.7167) ce_loss 0.3535 (0.4034) teacher_loss 0.3441 (0.3821) loss_zs_kd 0.0866 (0.0910) loss_oracle 0.3047 (0.2891) acc 84.3750 (86.0417) kd_loss 1.0085 (1.0149) lr 1.9511e-03 eta 0:12:45
epoch [7/50] batch [80/176] time 0.120 (0.097) data 0.000 (0.004) loss 0.4453 (0.7234) ce_loss 0.1406 (0.4045) teacher_loss 0.1315 (0.3843) loss_zs_kd 0.0924 (0.0919) loss_oracle 0.2676 (0.2932) acc 96.8750 (85.5859) kd_loss 0.9786 (1.0092) lr 1.9511e-03 eta 0:12:25
epoch [7/50] batch [100/176] time 0.084 (0.097) data 0.000 (0.003) loss 0.7568 (0.7134) ce_loss 0.4463 (0.3959) teacher_loss 0.4263 (0.3797) loss_zs_kd 0.1118 (0.0926) loss_oracle 0.2746 (0.2874) acc 81.2500 (86.0625) kd_loss 0.9978 (1.0045) lr 1.9511e-03 eta 0:12:17
epoch [7/50] batch [120/176] time 0.105 (0.101) data 0.000 (0.003) loss 0.9127 (0.7119) ce_loss 0.6323 (0.3967) teacher_loss 0.6055 (0.3830) loss_zs_kd 0.0533 (0.0919) loss_oracle 0.2805 (0.2829) acc 71.8750 (86.1979) kd_loss 1.0214 (1.0025) lr 1.9511e-03 eta 0:12:50
epoch [7/50] batch [140/176] time 0.067 (0.104) data 0.000 (0.002) loss 0.8391 (0.7166) ce_loss 0.5322 (0.4009) teacher_loss 0.5307 (0.3878) loss_zs_kd 0.0733 (0.0910) loss_oracle 0.2718 (0.2834) acc 84.3750 (86.1161) kd_loss 0.9436 (1.0020) lr 1.9511e-03 eta 0:13:09
epoch [7/50] batch [160/176] time 0.071 (0.108) data 0.000 (0.002) loss 0.8665 (0.7183) ce_loss 0.5854 (0.4002) teacher_loss 0.5770 (0.3873) loss_zs_kd 0.0825 (0.0919) loss_oracle 0.2482 (0.2851) acc 78.1250 (85.9961) kd_loss 0.9350 (0.9991) lr 1.9511e-03 eta 0:13:35
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,170
* accuracy: 89.6%
* error: 10.4%
* macro_f1: 91.7%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,724
* accuracy: 64.9%
* error: 35.1%
* macro_f1: 59.8%
******* Domain l best val acc:      89.9%, epoch: 6 *******
******* Domain l best val test acc: 64.5%, epoch: 6 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [8/50] batch [20/176] time 0.078 (0.123) data 0.000 (0.016) loss 0.5798 (0.6429) ce_loss 0.2529 (0.3564) teacher_loss 0.2246 (0.3419) loss_zs_kd 0.0796 (0.0937) loss_oracle 0.3154 (0.2542) acc 90.6250 (88.1250) kd_loss 1.0415 (0.9896) lr 1.9298e-03 eta 0:15:30
epoch [8/50] batch [40/176] time 0.087 (0.113) data 0.000 (0.008) loss 0.5738 (0.6601) ce_loss 0.3215 (0.3710) teacher_loss 0.3298 (0.3598) loss_zs_kd 0.0618 (0.0910) loss_oracle 0.2131 (0.2547) acc 90.6250 (87.5000) kd_loss 0.9365 (0.9980) lr 1.9298e-03 eta 0:14:08
epoch [8/50] batch [60/176] time 0.078 (0.108) data 0.000 (0.005) loss 0.6954 (0.6716) ce_loss 0.3694 (0.3752) teacher_loss 0.3518 (0.3634) loss_zs_kd 0.1171 (0.0935) loss_oracle 0.2850 (0.2614) acc 90.6250 (87.2396) kd_loss 1.0302 (0.9977) lr 1.9298e-03 eta 0:13:28
epoch [8/50] batch [80/176] time 0.080 (0.105) data 0.000 (0.004) loss 0.6320 (0.6749) ce_loss 0.3115 (0.3751) teacher_loss 0.3128 (0.3669) loss_zs_kd 0.0624 (0.0928) loss_oracle 0.2881 (0.2615) acc 93.7500 (87.3438) kd_loss 1.0591 (0.9988) lr 1.9298e-03 eta 0:13:07
epoch [8/50] batch [100/176] time 0.086 (0.104) data 0.000 (0.003) loss 0.6515 (0.6794) ce_loss 0.3164 (0.3757) teacher_loss 0.3122 (0.3675) loss_zs_kd 0.0800 (0.0915) loss_oracle 0.2993 (0.2661) acc 87.5000 (87.0312) kd_loss 1.0362 (1.0003) lr 1.9298e-03 eta 0:12:55
epoch [8/50] batch [120/176] time 0.115 (0.103) data 0.000 (0.003) loss 0.7620 (0.6865) ce_loss 0.4590 (0.3786) teacher_loss 0.4427 (0.3706) loss_zs_kd 0.0988 (0.0911) loss_oracle 0.2699 (0.2705) acc 78.1250 (86.8750) kd_loss 0.9452 (1.0008) lr 1.9298e-03 eta 0:12:47
epoch [8/50] batch [140/176] time 0.087 (0.104) data 0.000 (0.002) loss 0.7068 (0.6880) ce_loss 0.3494 (0.3792) teacher_loss 0.3276 (0.3707) loss_zs_kd 0.0874 (0.0912) loss_oracle 0.3355 (0.2718) acc 84.3750 (86.7411) kd_loss 1.0459 (0.9987) lr 1.9298e-03 eta 0:12:48
epoch [8/50] batch [160/176] time 0.108 (0.103) data 0.000 (0.002) loss 0.7777 (0.6923) ce_loss 0.4170 (0.3821) teacher_loss 0.3950 (0.3720) loss_zs_kd 0.1163 (0.0930) loss_oracle 0.3246 (0.2738) acc 87.5000 (86.7383) kd_loss 0.9772 (0.9972) lr 1.9298e-03 eta 0:12:42
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,172
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 91.7%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,659
* accuracy: 62.5%
* error: 37.5%
* macro_f1: 58.3%
******* Domain l best val acc:      89.9%, epoch: 6 *******
******* Domain l best val test acc: 64.5%, epoch: 6 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [9/50] batch [20/176] time 0.069 (0.110) data 0.000 (0.012) loss 0.6995 (0.6954) ce_loss 0.4050 (0.4003) teacher_loss 0.3809 (0.3836) loss_zs_kd 0.1066 (0.0873) loss_oracle 0.2654 (0.2681) acc 81.2500 (85.1562) kd_loss 0.9475 (0.9897) lr 1.9048e-03 eta 0:13:31
epoch [9/50] batch [40/176] time 0.110 (0.102) data 0.000 (0.006) loss 1.0243 (0.7324) ce_loss 0.6484 (0.4227) teacher_loss 0.6557 (0.4069) loss_zs_kd 0.0961 (0.0875) loss_oracle 0.3206 (0.2818) acc 71.8750 (84.5312) kd_loss 1.0182 (1.0012) lr 1.9048e-03 eta 0:12:26
epoch [9/50] batch [60/176] time 0.133 (0.099) data 0.001 (0.004) loss 0.6242 (0.7161) ce_loss 0.3245 (0.4036) teacher_loss 0.3025 (0.3884) loss_zs_kd 0.0766 (0.0903) loss_oracle 0.2835 (0.2825) acc 87.5000 (85.4167) kd_loss 0.9144 (0.9980) lr 1.9048e-03 eta 0:12:04
epoch [9/50] batch [80/176] time 0.093 (0.101) data 0.000 (0.003) loss 0.6965 (0.7129) ce_loss 0.3906 (0.4037) teacher_loss 0.3894 (0.3893) loss_zs_kd 0.1293 (0.0915) loss_oracle 0.2424 (0.2778) acc 87.5000 (86.0156) kd_loss 0.8763 (0.9960) lr 1.9048e-03 eta 0:12:18
epoch [9/50] batch [100/176] time 0.086 (0.103) data 0.000 (0.003) loss 0.6519 (0.7054) ce_loss 0.3298 (0.4012) teacher_loss 0.3268 (0.3843) loss_zs_kd 0.1189 (0.0920) loss_oracle 0.2656 (0.2751) acc 93.7500 (86.4375) kd_loss 1.0187 (0.9978) lr 1.9048e-03 eta 0:12:31
epoch [9/50] batch [120/176] time 0.090 (0.105) data 0.000 (0.002) loss 0.8580 (0.7089) ce_loss 0.5298 (0.4056) teacher_loss 0.5229 (0.3874) loss_zs_kd 0.1095 (0.0943) loss_oracle 0.2804 (0.2743) acc 84.3750 (86.3021) kd_loss 0.9331 (0.9975) lr 1.9048e-03 eta 0:12:45
epoch [9/50] batch [140/176] time 0.137 (0.107) data 0.000 (0.002) loss 0.5379 (0.6995) ce_loss 0.2463 (0.3983) teacher_loss 0.2311 (0.3797) loss_zs_kd 0.0936 (0.0941) loss_oracle 0.2601 (0.2728) acc 96.8750 (86.5179) kd_loss 1.0751 (0.9990) lr 1.9048e-03 eta 0:12:56
epoch [9/50] batch [160/176] time 0.132 (0.108) data 0.000 (0.002) loss 0.7799 (0.7004) ce_loss 0.4541 (0.4009) teacher_loss 0.4660 (0.3812) loss_zs_kd 0.0878 (0.0943) loss_oracle 0.2701 (0.2720) acc 87.5000 (86.2500) kd_loss 0.9845 (1.0007) lr 1.9048e-03 eta 0:13:01
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,175
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 91.8%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,645
* accuracy: 61.9%
* error: 38.1%
* macro_f1: 58.1%
******* Domain l best val acc:      89.9%, epoch: 6 *******
******* Domain l best val test acc: 64.5%, epoch: 6 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [10/50] batch [20/176] time 0.095 (0.135) data 0.000 (0.016) loss 0.8311 (0.7099) ce_loss 0.4758 (0.4114) teacher_loss 0.5100 (0.3733) loss_zs_kd 0.1007 (0.1064) loss_oracle 0.2708 (0.2834) acc 75.0000 (83.7500) kd_loss 1.0170 (1.0166) lr 1.8763e-03 eta 0:16:12
epoch [10/50] batch [40/176] time 0.118 (0.119) data 0.000 (0.008) loss 0.6936 (0.6804) ce_loss 0.3704 (0.3770) teacher_loss 0.3603 (0.3449) loss_zs_kd 0.0758 (0.1055) loss_oracle 0.2954 (0.2828) acc 81.2500 (85.1562) kd_loss 1.0508 (1.0095) lr 1.8763e-03 eta 0:14:14
epoch [10/50] batch [60/176] time 0.133 (0.114) data 0.001 (0.005) loss 0.7223 (0.6892) ce_loss 0.3875 (0.3809) teacher_loss 0.3988 (0.3566) loss_zs_kd 0.1324 (0.1023) loss_oracle 0.2573 (0.2815) acc 90.6250 (85.6250) kd_loss 1.0053 (1.0070) lr 1.8763e-03 eta 0:13:39
epoch [10/50] batch [80/176] time 0.076 (0.112) data 0.001 (0.004) loss 0.8101 (0.6932) ce_loss 0.4602 (0.3807) teacher_loss 0.4680 (0.3600) loss_zs_kd 0.0721 (0.1000) loss_oracle 0.3061 (0.2832) acc 87.5000 (85.6641) kd_loss 0.9789 (1.0035) lr 1.8763e-03 eta 0:13:20
epoch [10/50] batch [100/176] time 0.081 (0.111) data 0.000 (0.003) loss 0.8595 (0.7032) ce_loss 0.5078 (0.3913) teacher_loss 0.4807 (0.3724) loss_zs_kd 0.1330 (0.0990) loss_oracle 0.3123 (0.2813) acc 87.5000 (85.6250) kd_loss 0.9973 (1.0004) lr 1.8763e-03 eta 0:13:08
epoch [10/50] batch [120/176] time 0.076 (0.110) data 0.000 (0.003) loss 0.8632 (0.6999) ce_loss 0.5869 (0.3898) teacher_loss 0.5148 (0.3708) loss_zs_kd 0.0749 (0.0974) loss_oracle 0.3110 (0.2804) acc 75.0000 (85.7292) kd_loss 1.0114 (0.9963) lr 1.8763e-03 eta 0:13:02
epoch [10/50] batch [140/176] time 0.094 (0.110) data 0.000 (0.002) loss 0.7087 (0.7030) ce_loss 0.3875 (0.3914) teacher_loss 0.3594 (0.3717) loss_zs_kd 0.0887 (0.0978) loss_oracle 0.3050 (0.2824) acc 87.5000 (85.6027) kd_loss 1.0304 (0.9957) lr 1.8763e-03 eta 0:12:58
epoch [10/50] batch [160/176] time 0.132 (0.111) data 0.000 (0.002) loss 0.6008 (0.7023) ce_loss 0.3049 (0.3913) teacher_loss 0.3061 (0.3719) loss_zs_kd 0.0627 (0.0966) loss_oracle 0.2633 (0.2822) acc 93.7500 (85.6641) kd_loss 1.0464 (0.9969) lr 1.8763e-03 eta 0:13:00
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,173
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 91.7%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,683
* accuracy: 63.4%
* error: 36.6%
* macro_f1: 58.7%
******* Domain l best val acc:      89.9%, epoch: 6 *******
******* Domain l best val test acc: 64.5%, epoch: 6 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [11/50] batch [20/176] time 0.135 (0.128) data 0.000 (0.014) loss 0.7957 (0.7397) ce_loss 0.4583 (0.4254) teacher_loss 0.4514 (0.4151) loss_zs_kd 0.1340 (0.1040) loss_oracle 0.2773 (0.2727) acc 90.6250 (85.3125) kd_loss 0.9368 (1.0068) lr 1.8443e-03 eta 0:14:59
epoch [11/50] batch [40/176] time 0.088 (0.118) data 0.000 (0.007) loss 0.7896 (0.6982) ce_loss 0.4272 (0.3950) teacher_loss 0.4365 (0.3874) loss_zs_kd 0.0956 (0.0965) loss_oracle 0.3053 (0.2625) acc 87.5000 (86.9531) kd_loss 1.0608 (1.0084) lr 1.8443e-03 eta 0:13:48
epoch [11/50] batch [60/176] time 0.113 (0.116) data 0.000 (0.005) loss 0.7640 (0.7069) ce_loss 0.4700 (0.4031) teacher_loss 0.4067 (0.3900) loss_zs_kd 0.1356 (0.1003) loss_oracle 0.2895 (0.2668) acc 84.3750 (86.5625) kd_loss 1.0113 (1.0026) lr 1.8443e-03 eta 0:13:27
epoch [11/50] batch [80/176] time 0.080 (0.114) data 0.000 (0.004) loss 0.8464 (0.7128) ce_loss 0.5449 (0.4032) teacher_loss 0.5313 (0.3897) loss_zs_kd 0.0844 (0.0972) loss_oracle 0.2729 (0.2745) acc 87.5000 (86.6016) kd_loss 0.8867 (1.0021) lr 1.8443e-03 eta 0:13:13
epoch [11/50] batch [100/176] time 0.138 (0.114) data 0.000 (0.003) loss 0.7400 (0.7012) ce_loss 0.4246 (0.3860) teacher_loss 0.4424 (0.3762) loss_zs_kd 0.0551 (0.0943) loss_oracle 0.2701 (0.2779) acc 84.3750 (87.3750) kd_loss 1.0728 (1.0010) lr 1.8443e-03 eta 0:13:09
epoch [11/50] batch [120/176] time 0.087 (0.112) data 0.000 (0.003) loss 0.5626 (0.7025) ce_loss 0.2505 (0.3850) teacher_loss 0.2243 (0.3763) loss_zs_kd 0.0806 (0.0931) loss_oracle 0.2980 (0.2797) acc 90.6250 (87.3177) kd_loss 0.9903 (1.0004) lr 1.8443e-03 eta 0:12:57
epoch [11/50] batch [140/176] time 0.084 (0.110) data 0.000 (0.002) loss 0.8270 (0.7094) ce_loss 0.4250 (0.3899) teacher_loss 0.4405 (0.3816) loss_zs_kd 0.0826 (0.0921) loss_oracle 0.3451 (0.2818) acc 84.3750 (87.0982) kd_loss 1.0201 (0.9975) lr 1.8443e-03 eta 0:12:41
epoch [11/50] batch [160/176] time 0.149 (0.110) data 0.000 (0.002) loss 0.5543 (0.7164) ce_loss 0.2629 (0.3959) teacher_loss 0.2680 (0.3872) loss_zs_kd 0.1042 (0.0917) loss_oracle 0.2342 (0.2833) acc 93.7500 (86.8750) kd_loss 0.9031 (0.9968) lr 1.8443e-03 eta 0:12:33
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,182
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.0%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,765
* accuracy: 66.5%
* error: 33.5%
* macro_f1: 60.4%
******* Domain l best val acc:      90.1%, epoch: 11 *******
******* Domain l best val test acc: 66.5%, epoch: 11 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [12/50] batch [20/176] time 0.194 (0.154) data 0.000 (0.017) loss 0.5736 (0.7163) ce_loss 0.2690 (0.3920) teacher_loss 0.2502 (0.3804) loss_zs_kd 0.0682 (0.0946) loss_oracle 0.2893 (0.2886) acc 90.6250 (85.4688) kd_loss 0.9723 (1.0070) lr 1.8090e-03 eta 0:17:35
epoch [12/50] batch [40/176] time 0.135 (0.146) data 0.000 (0.008) loss 0.8603 (0.7145) ce_loss 0.5322 (0.3953) teacher_loss 0.5272 (0.3782) loss_zs_kd 0.0606 (0.0911) loss_oracle 0.3028 (0.2908) acc 84.3750 (85.7812) kd_loss 1.0168 (1.0020) lr 1.8090e-03 eta 0:16:36
epoch [12/50] batch [60/176] time 0.131 (0.139) data 0.001 (0.006) loss 0.9075 (0.7198) ce_loss 0.5884 (0.3935) teacher_loss 0.5764 (0.3777) loss_zs_kd 0.1078 (0.0943) loss_oracle 0.2772 (0.2950) acc 81.2500 (85.9896) kd_loss 0.9802 (1.0037) lr 1.8090e-03 eta 0:15:47
epoch [12/50] batch [80/176] time 0.097 (0.131) data 0.000 (0.004) loss 0.6488 (0.7116) ce_loss 0.2903 (0.3878) teacher_loss 0.2941 (0.3729) loss_zs_kd 0.0964 (0.0925) loss_oracle 0.3065 (0.2924) acc 93.7500 (86.4453) kd_loss 1.0399 (1.0021) lr 1.8090e-03 eta 0:14:45
epoch [12/50] batch [100/176] time 0.137 (0.126) data 0.000 (0.004) loss 0.5490 (0.7159) ce_loss 0.2488 (0.3895) teacher_loss 0.2235 (0.3750) loss_zs_kd 0.0499 (0.0934) loss_oracle 0.3006 (0.2942) acc 90.6250 (86.3750) kd_loss 1.0184 (0.9981) lr 1.8090e-03 eta 0:14:13
epoch [12/50] batch [120/176] time 0.095 (0.123) data 0.000 (0.003) loss 0.5502 (0.7111) ce_loss 0.2433 (0.3844) teacher_loss 0.2267 (0.3707) loss_zs_kd 0.0490 (0.0924) loss_oracle 0.2990 (0.2942) acc 93.7500 (86.5885) kd_loss 1.0101 (0.9974) lr 1.8090e-03 eta 0:13:48
epoch [12/50] batch [140/176] time 0.131 (0.120) data 0.000 (0.003) loss 1.0258 (0.7128) ce_loss 0.5835 (0.3831) teacher_loss 0.6165 (0.3710) loss_zs_kd 0.0803 (0.0922) loss_oracle 0.3692 (0.2957) acc 78.1250 (86.6295) kd_loss 0.9955 (0.9963) lr 1.8090e-03 eta 0:13:29
epoch [12/50] batch [160/176] time 0.126 (0.118) data 0.000 (0.002) loss 0.7707 (0.7140) ce_loss 0.4187 (0.3843) teacher_loss 0.4011 (0.3727) loss_zs_kd 0.0856 (0.0919) loss_oracle 0.3268 (0.2953) acc 81.2500 (86.5625) kd_loss 0.9699 (0.9949) lr 1.8090e-03 eta 0:13:12
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,179
* accuracy: 90.0%
* error: 10.0%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,687
* accuracy: 63.5%
* error: 36.5%
* macro_f1: 58.6%
******* Domain l best val acc:      90.1%, epoch: 11 *******
******* Domain l best val test acc: 66.5%, epoch: 11 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [13/50] batch [20/176] time 0.143 (0.135) data 0.000 (0.015) loss 0.8889 (0.7518) ce_loss 0.5444 (0.4221) teacher_loss 0.5266 (0.4136) loss_zs_kd 0.0671 (0.0797) loss_oracle 0.3288 (0.2984) acc 81.2500 (85.4688) kd_loss 1.0434 (0.9993) lr 1.7705e-03 eta 0:14:57
epoch [13/50] batch [40/176] time 0.087 (0.122) data 0.000 (0.008) loss 0.7168 (0.7194) ce_loss 0.3315 (0.3937) teacher_loss 0.3434 (0.3819) loss_zs_kd 0.0799 (0.0815) loss_oracle 0.3334 (0.2968) acc 84.3750 (86.2500) kd_loss 1.0213 (0.9951) lr 1.7705e-03 eta 0:13:31
epoch [13/50] batch [60/176] time 0.079 (0.112) data 0.001 (0.005) loss 0.5826 (0.7220) ce_loss 0.2494 (0.3894) teacher_loss 0.2434 (0.3767) loss_zs_kd 0.0772 (0.0840) loss_oracle 0.3005 (0.3033) acc 93.7500 (86.4062) kd_loss 0.9787 (0.9994) lr 1.7705e-03 eta 0:12:23
epoch [13/50] batch [80/176] time 0.084 (0.108) data 0.000 (0.004) loss 0.6192 (0.7451) ce_loss 0.2871 (0.4066) teacher_loss 0.2613 (0.3934) loss_zs_kd 0.0908 (0.0866) loss_oracle 0.3125 (0.3084) acc 93.7500 (85.7812) kd_loss 0.9672 (0.9960) lr 1.7705e-03 eta 0:11:51
epoch [13/50] batch [100/176] time 0.085 (0.106) data 0.000 (0.003) loss 0.4967 (0.7420) ce_loss 0.1722 (0.4031) teacher_loss 0.1688 (0.3890) loss_zs_kd 0.0919 (0.0871) loss_oracle 0.2820 (0.3094) acc 96.8750 (85.8125) kd_loss 1.0218 (0.9969) lr 1.7705e-03 eta 0:11:35
epoch [13/50] batch [120/176] time 0.095 (0.103) data 0.000 (0.003) loss 0.6793 (0.7339) ce_loss 0.3809 (0.3967) teacher_loss 0.3636 (0.3837) loss_zs_kd 0.0669 (0.0857) loss_oracle 0.2823 (0.3074) acc 84.3750 (86.2760) kd_loss 0.9720 (0.9984) lr 1.7705e-03 eta 0:11:15
epoch [13/50] batch [140/176] time 0.091 (0.101) data 0.000 (0.002) loss 0.6636 (0.7342) ce_loss 0.3748 (0.3973) teacher_loss 0.3731 (0.3849) loss_zs_kd 0.0753 (0.0874) loss_oracle 0.2529 (0.3055) acc 78.1250 (86.1384) kd_loss 0.9182 (0.9968) lr 1.7705e-03 eta 0:11:03
epoch [13/50] batch [160/176] time 0.128 (0.101) data 0.000 (0.002) loss 0.7437 (0.7274) ce_loss 0.4492 (0.3912) teacher_loss 0.4202 (0.3792) loss_zs_kd 0.0647 (0.0871) loss_oracle 0.2911 (0.3047) acc 75.0000 (86.2695) kd_loss 1.0319 (0.9947) lr 1.7705e-03 eta 0:10:58
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,171
* accuracy: 89.6%
* error: 10.4%
* macro_f1: 91.7%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,735
* accuracy: 65.3%
* error: 34.7%
* macro_f1: 59.6%
******* Domain l best val acc:      90.1%, epoch: 11 *******
******* Domain l best val test acc: 66.5%, epoch: 11 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [14/50] batch [20/176] time 0.150 (0.136) data 0.000 (0.012) loss 0.7711 (0.7246) ce_loss 0.3970 (0.3823) teacher_loss 0.4556 (0.3741) loss_zs_kd 0.0958 (0.1002) loss_oracle 0.2676 (0.3003) acc 93.7500 (86.8750) kd_loss 0.9612 (0.9698) lr 1.7290e-03 eta 0:14:44
epoch [14/50] batch [40/176] time 0.100 (0.125) data 0.000 (0.006) loss 0.7307 (0.7384) ce_loss 0.3831 (0.3963) teacher_loss 0.3259 (0.3902) loss_zs_kd 0.1178 (0.0960) loss_oracle 0.3459 (0.3002) acc 87.5000 (86.2500) kd_loss 0.9354 (0.9692) lr 1.7290e-03 eta 0:13:30
epoch [14/50] batch [60/176] time 0.140 (0.121) data 0.000 (0.004) loss 0.9197 (0.7371) ce_loss 0.5439 (0.3935) teacher_loss 0.5333 (0.3881) loss_zs_kd 0.1262 (0.0923) loss_oracle 0.3233 (0.3029) acc 71.8750 (86.7188) kd_loss 0.9710 (0.9786) lr 1.7290e-03 eta 0:13:03
epoch [14/50] batch [80/176] time 0.142 (0.120) data 0.000 (0.003) loss 0.7620 (0.7467) ce_loss 0.4578 (0.4037) teacher_loss 0.4610 (0.3988) loss_zs_kd 0.0860 (0.0895) loss_oracle 0.2579 (0.3032) acc 87.5000 (86.4844) kd_loss 0.8994 (0.9799) lr 1.7290e-03 eta 0:12:53
epoch [14/50] batch [100/176] time 0.064 (0.121) data 0.000 (0.003) loss 0.5387 (0.7357) ce_loss 0.2070 (0.3966) teacher_loss 0.2056 (0.3917) loss_zs_kd 0.1021 (0.0895) loss_oracle 0.2821 (0.2993) acc 93.7500 (86.5312) kd_loss 0.9933 (0.9768) lr 1.7290e-03 eta 0:12:58
epoch [14/50] batch [120/176] time 0.066 (0.123) data 0.000 (0.002) loss 0.5706 (0.7342) ce_loss 0.2544 (0.3963) teacher_loss 0.2516 (0.3908) loss_zs_kd 0.0809 (0.0905) loss_oracle 0.2786 (0.2981) acc 90.6250 (86.2760) kd_loss 0.9737 (0.9786) lr 1.7290e-03 eta 0:13:06
epoch [14/50] batch [140/176] time 0.078 (0.118) data 0.000 (0.002) loss 0.5636 (0.7329) ce_loss 0.1786 (0.3951) teacher_loss 0.1988 (0.3888) loss_zs_kd 0.0992 (0.0914) loss_oracle 0.3152 (0.2984) acc 93.7500 (86.3839) kd_loss 0.9712 (0.9791) lr 1.7290e-03 eta 0:12:30
epoch [14/50] batch [160/176] time 0.100 (0.116) data 0.000 (0.002) loss 0.5740 (0.7278) ce_loss 0.2651 (0.3926) teacher_loss 0.2841 (0.3864) loss_zs_kd 0.0982 (0.0922) loss_oracle 0.2408 (0.2953) acc 93.7500 (86.5625) kd_loss 1.0357 (0.9806) lr 1.7290e-03 eta 0:12:14
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,182
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,678
* accuracy: 63.2%
* error: 36.8%
* macro_f1: 58.0%
******* Domain l best val acc:      90.1%, epoch: 11 *******
******* Domain l best val test acc: 66.5%, epoch: 11 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [15/50] batch [20/176] time 0.134 (0.133) data 0.000 (0.015) loss 0.7788 (0.7378) ce_loss 0.4277 (0.4014) teacher_loss 0.4256 (0.3933) loss_zs_kd 0.0877 (0.0872) loss_oracle 0.3093 (0.3009) acc 78.1250 (86.7188) kd_loss 0.9561 (0.9821) lr 1.6845e-03 eta 0:13:58
epoch [15/50] batch [40/176] time 0.136 (0.127) data 0.000 (0.008) loss 0.7680 (0.7201) ce_loss 0.3667 (0.3845) teacher_loss 0.3834 (0.3717) loss_zs_kd 0.1505 (0.0914) loss_oracle 0.3093 (0.3026) acc 84.3750 (86.7188) kd_loss 0.9712 (0.9874) lr 1.6845e-03 eta 0:13:18
epoch [15/50] batch [60/176] time 0.138 (0.123) data 0.001 (0.005) loss 0.5945 (0.7069) ce_loss 0.2578 (0.3818) teacher_loss 0.2587 (0.3678) loss_zs_kd 0.0763 (0.0897) loss_oracle 0.2977 (0.2943) acc 90.6250 (86.5625) kd_loss 0.9945 (0.9840) lr 1.6845e-03 eta 0:12:51
epoch [15/50] batch [80/176] time 0.136 (0.121) data 0.000 (0.004) loss 0.6944 (0.7143) ce_loss 0.3735 (0.3882) teacher_loss 0.3390 (0.3713) loss_zs_kd 0.0628 (0.0937) loss_oracle 0.3240 (0.2961) acc 90.6250 (86.2109) kd_loss 0.9528 (0.9826) lr 1.6845e-03 eta 0:12:36
epoch [15/50] batch [100/176] time 0.106 (0.120) data 0.000 (0.003) loss 0.7126 (0.7126) ce_loss 0.4392 (0.3846) teacher_loss 0.4269 (0.3671) loss_zs_kd 0.1041 (0.0973) loss_oracle 0.2337 (0.2969) acc 84.3750 (86.3438) kd_loss 0.9393 (0.9836) lr 1.6845e-03 eta 0:12:27
epoch [15/50] batch [120/176] time 0.120 (0.119) data 0.000 (0.003) loss 0.5733 (0.7091) ce_loss 0.2695 (0.3809) teacher_loss 0.2403 (0.3632) loss_zs_kd 0.1263 (0.0980) loss_oracle 0.2699 (0.2969) acc 93.7500 (86.4844) kd_loss 1.0259 (0.9863) lr 1.6845e-03 eta 0:12:18
epoch [15/50] batch [140/176] time 0.096 (0.117) data 0.000 (0.002) loss 0.6471 (0.7065) ce_loss 0.3452 (0.3787) teacher_loss 0.3034 (0.3617) loss_zs_kd 0.0633 (0.0971) loss_oracle 0.3120 (0.2962) acc 81.2500 (86.6295) kd_loss 1.0255 (0.9852) lr 1.6845e-03 eta 0:12:05
epoch [15/50] batch [160/176] time 0.110 (0.116) data 0.000 (0.002) loss 0.8038 (0.7060) ce_loss 0.4460 (0.3784) teacher_loss 0.4185 (0.3612) loss_zs_kd 0.0907 (0.0961) loss_oracle 0.3399 (0.2968) acc 75.0000 (86.5820) kd_loss 1.0880 (0.9885) lr 1.6845e-03 eta 0:11:55
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,179
* accuracy: 90.0%
* error: 10.0%
* macro_f1: 91.9%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,673
* accuracy: 63.0%
* error: 37.0%
* macro_f1: 58.4%
******* Domain l best val acc:      90.1%, epoch: 11 *******
******* Domain l best val test acc: 66.5%, epoch: 11 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [16/50] batch [20/176] time 0.084 (0.137) data 0.000 (0.014) loss 1.0093 (0.7205) ce_loss 0.6621 (0.3925) teacher_loss 0.6682 (0.3661) loss_zs_kd 0.1294 (0.0979) loss_oracle 0.2764 (0.3055) acc 68.7500 (84.5312) kd_loss 1.0388 (1.0098) lr 1.6374e-03 eta 0:13:59
epoch [16/50] batch [40/176] time 0.092 (0.123) data 0.000 (0.007) loss 0.7269 (0.7150) ce_loss 0.3860 (0.3807) teacher_loss 0.3713 (0.3621) loss_zs_kd 0.1054 (0.0970) loss_oracle 0.3029 (0.3044) acc 90.6250 (85.5469) kd_loss 1.0104 (0.9943) lr 1.6374e-03 eta 0:12:35
epoch [16/50] batch [60/176] time 0.106 (0.118) data 0.001 (0.005) loss 0.5548 (0.7213) ce_loss 0.2646 (0.3897) teacher_loss 0.2275 (0.3696) loss_zs_kd 0.0891 (0.0963) loss_oracle 0.2828 (0.3035) acc 93.7500 (85.7812) kd_loss 0.9818 (0.9940) lr 1.6374e-03 eta 0:11:58
epoch [16/50] batch [80/176] time 0.091 (0.116) data 0.000 (0.004) loss 0.8119 (0.7267) ce_loss 0.5264 (0.3953) teacher_loss 0.5221 (0.3782) loss_zs_kd 0.0694 (0.0976) loss_oracle 0.2551 (0.2997) acc 78.1250 (85.7422) kd_loss 0.9712 (0.9929) lr 1.6374e-03 eta 0:11:46
epoch [16/50] batch [100/176] time 0.073 (0.115) data 0.000 (0.003) loss 0.5929 (0.7206) ce_loss 0.3474 (0.3916) teacher_loss 0.3117 (0.3761) loss_zs_kd 0.0423 (0.0961) loss_oracle 0.2600 (0.2965) acc 84.3750 (85.9375) kd_loss 0.8625 (0.9886) lr 1.6374e-03 eta 0:11:36
epoch [16/50] batch [120/176] time 0.137 (0.118) data 0.000 (0.003) loss 0.6137 (0.7141) ce_loss 0.3074 (0.3881) teacher_loss 0.2887 (0.3721) loss_zs_kd 0.1249 (0.0960) loss_oracle 0.2626 (0.2940) acc 87.5000 (85.9115) kd_loss 0.9927 (0.9898) lr 1.6374e-03 eta 0:11:53
epoch [16/50] batch [140/176] time 0.081 (0.118) data 0.000 (0.002) loss 0.6408 (0.7028) ce_loss 0.3386 (0.3779) teacher_loss 0.2970 (0.3623) loss_zs_kd 0.0868 (0.0948) loss_oracle 0.3004 (0.2931) acc 84.3750 (86.4955) kd_loss 1.0020 (0.9886) lr 1.6374e-03 eta 0:11:49
epoch [16/50] batch [160/176] time 0.075 (0.119) data 0.001 (0.002) loss 0.6498 (0.7014) ce_loss 0.3491 (0.3773) teacher_loss 0.3092 (0.3611) loss_zs_kd 0.0729 (0.0944) loss_oracle 0.3041 (0.2931) acc 87.5000 (86.6016) kd_loss 0.9972 (0.9892) lr 1.6374e-03 eta 0:11:54
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,182
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,689
* accuracy: 63.6%
* error: 36.4%
* macro_f1: 58.6%
******* Domain l best val acc:      90.1%, epoch: 11 *******
******* Domain l best val test acc: 66.5%, epoch: 11 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [17/50] batch [20/176] time 0.097 (0.138) data 0.000 (0.015) loss 0.6463 (0.7389) ce_loss 0.3083 (0.4135) teacher_loss 0.2660 (0.3975) loss_zs_kd 0.0958 (0.0926) loss_oracle 0.3324 (0.2951) acc 93.7500 (85.9375) kd_loss 1.0467 (0.9924) lr 1.5878e-03 eta 0:13:40
epoch [17/50] batch [40/176] time 0.076 (0.121) data 0.000 (0.008) loss 0.5053 (0.7172) ce_loss 0.2173 (0.3924) teacher_loss 0.1972 (0.3782) loss_zs_kd 0.0880 (0.0918) loss_oracle 0.2640 (0.2931) acc 96.8750 (86.7969) kd_loss 1.0870 (1.0033) lr 1.5878e-03 eta 0:12:01
epoch [17/50] batch [60/176] time 0.086 (0.116) data 0.001 (0.005) loss 0.7471 (0.7252) ce_loss 0.3794 (0.3964) teacher_loss 0.3703 (0.3825) loss_zs_kd 0.0622 (0.0938) loss_oracle 0.3457 (0.2957) acc 87.5000 (86.9792) kd_loss 0.9535 (0.9976) lr 1.5878e-03 eta 0:11:29
epoch [17/50] batch [80/176] time 0.087 (0.115) data 0.000 (0.004) loss 0.7118 (0.7286) ce_loss 0.3416 (0.3967) teacher_loss 0.3554 (0.3841) loss_zs_kd 0.1044 (0.0947) loss_oracle 0.3042 (0.2971) acc 87.5000 (86.9531) kd_loss 1.0025 (0.9948) lr 1.5878e-03 eta 0:11:19
epoch [17/50] batch [100/176] time 0.139 (0.114) data 0.000 (0.003) loss 0.6258 (0.7326) ce_loss 0.3354 (0.3967) teacher_loss 0.3070 (0.3880) loss_zs_kd 0.0939 (0.0935) loss_oracle 0.2718 (0.2979) acc 84.3750 (87.0938) kd_loss 0.9408 (0.9968) lr 1.5878e-03 eta 0:11:08
epoch [17/50] batch [120/176] time 0.140 (0.112) data 0.000 (0.003) loss 0.6683 (0.7309) ce_loss 0.3640 (0.3964) teacher_loss 0.3325 (0.3874) loss_zs_kd 0.0940 (0.0925) loss_oracle 0.2888 (0.2972) acc 90.6250 (86.8490) kd_loss 1.0500 (0.9964) lr 1.5878e-03 eta 0:10:57
epoch [17/50] batch [140/176] time 0.082 (0.111) data 0.000 (0.002) loss 0.7545 (0.7263) ce_loss 0.3906 (0.3937) teacher_loss 0.3819 (0.3827) loss_zs_kd 0.1228 (0.0925) loss_oracle 0.3112 (0.2974) acc 87.5000 (86.8973) kd_loss 1.0415 (0.9944) lr 1.5878e-03 eta 0:10:49
epoch [17/50] batch [160/176] time 0.100 (0.110) data 0.000 (0.002) loss 0.7124 (0.7184) ce_loss 0.3733 (0.3885) teacher_loss 0.3494 (0.3753) loss_zs_kd 0.1020 (0.0929) loss_oracle 0.3120 (0.2967) acc 87.5000 (86.9531) kd_loss 1.0084 (0.9913) lr 1.5878e-03 eta 0:10:43
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,180
* accuracy: 90.0%
* error: 10.0%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,716
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 59.3%
******* Domain l best val acc:      90.1%, epoch: 11 *******
******* Domain l best val test acc: 66.5%, epoch: 11 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [18/50] batch [20/176] time 0.088 (0.108) data 0.000 (0.014) loss 0.6233 (0.6863) ce_loss 0.2986 (0.3667) teacher_loss 0.2710 (0.3547) loss_zs_kd 0.0913 (0.1004) loss_oracle 0.3066 (0.2814) acc 93.7500 (87.8125) kd_loss 0.9588 (0.9903) lr 1.5358e-03 eta 0:10:22
epoch [18/50] batch [40/176] time 0.117 (0.098) data 0.000 (0.007) loss 0.7824 (0.6727) ce_loss 0.4749 (0.3574) teacher_loss 0.4634 (0.3393) loss_zs_kd 0.1143 (0.1016) loss_oracle 0.2619 (0.2826) acc 78.1250 (88.0469) kd_loss 1.0158 (0.9918) lr 1.5358e-03 eta 0:09:25
epoch [18/50] batch [60/176] time 0.129 (0.098) data 0.000 (0.005) loss 0.7005 (0.7116) ce_loss 0.3308 (0.3870) teacher_loss 0.3065 (0.3668) loss_zs_kd 0.1568 (0.1042) loss_oracle 0.3156 (0.2927) acc 87.5000 (86.3021) kd_loss 0.9954 (0.9905) lr 1.5358e-03 eta 0:09:22
epoch [18/50] batch [80/176] time 0.079 (0.098) data 0.000 (0.004) loss 0.6061 (0.7186) ce_loss 0.3186 (0.3939) teacher_loss 0.3406 (0.3743) loss_zs_kd 0.0583 (0.1023) loss_oracle 0.2363 (0.2931) acc 87.5000 (86.2109) kd_loss 0.9796 (0.9871) lr 1.5358e-03 eta 0:09:20
epoch [18/50] batch [100/176] time 0.067 (0.098) data 0.000 (0.003) loss 0.7260 (0.7158) ce_loss 0.3442 (0.3913) teacher_loss 0.3189 (0.3732) loss_zs_kd 0.1103 (0.1010) loss_oracle 0.3519 (0.2920) acc 84.3750 (86.1250) kd_loss 1.0344 (0.9857) lr 1.5358e-03 eta 0:09:19
epoch [18/50] batch [120/176] time 0.113 (0.099) data 0.000 (0.003) loss 0.7159 (0.7121) ce_loss 0.4089 (0.3888) teacher_loss 0.4331 (0.3707) loss_zs_kd 0.0782 (0.0998) loss_oracle 0.2436 (0.2915) acc 87.5000 (86.3802) kd_loss 0.9658 (0.9842) lr 1.5358e-03 eta 0:09:21
epoch [18/50] batch [140/176] time 0.110 (0.100) data 0.000 (0.002) loss 0.5113 (0.7031) ce_loss 0.2186 (0.3814) teacher_loss 0.2237 (0.3634) loss_zs_kd 0.0922 (0.0971) loss_oracle 0.2416 (0.2911) acc 96.8750 (86.8080) kd_loss 1.0003 (0.9839) lr 1.5358e-03 eta 0:09:24
epoch [18/50] batch [160/176] time 0.119 (0.100) data 0.000 (0.002) loss 0.7419 (0.7026) ce_loss 0.4128 (0.3812) teacher_loss 0.4032 (0.3632) loss_zs_kd 0.1101 (0.0971) loss_oracle 0.2837 (0.2908) acc 81.2500 (86.9531) kd_loss 0.9524 (0.9823) lr 1.5358e-03 eta 0:09:24
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,180
* accuracy: 90.0%
* error: 10.0%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,716
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 58.9%
******* Domain l best val acc:      90.1%, epoch: 11 *******
******* Domain l best val test acc: 66.5%, epoch: 11 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [19/50] batch [20/176] time 0.128 (0.132) data 0.000 (0.013) loss 1.0206 (0.7280) ce_loss 0.6733 (0.4135) teacher_loss 0.6841 (0.4058) loss_zs_kd 0.1023 (0.0919) loss_oracle 0.2853 (0.2763) acc 78.1250 (85.0000) kd_loss 1.0177 (0.9840) lr 1.4818e-03 eta 0:12:22
epoch [19/50] batch [40/176] time 0.124 (0.122) data 0.000 (0.007) loss 0.6018 (0.7249) ce_loss 0.2389 (0.4023) teacher_loss 0.2042 (0.3944) loss_zs_kd 0.0969 (0.0956) loss_oracle 0.3491 (0.2826) acc 93.7500 (85.4688) kd_loss 0.9149 (0.9811) lr 1.4818e-03 eta 0:11:23
epoch [19/50] batch [60/176] time 0.083 (0.117) data 0.001 (0.005) loss 0.6543 (0.7211) ce_loss 0.3223 (0.4025) teacher_loss 0.3256 (0.3940) loss_zs_kd 0.0776 (0.0918) loss_oracle 0.2899 (0.2812) acc 93.7500 (85.3646) kd_loss 0.8865 (0.9773) lr 1.4818e-03 eta 0:10:54
epoch [19/50] batch [80/176] time 0.097 (0.116) data 0.000 (0.004) loss 0.6221 (0.7076) ce_loss 0.3491 (0.3872) teacher_loss 0.3113 (0.3791) loss_zs_kd 0.0699 (0.0909) loss_oracle 0.2759 (0.2830) acc 84.3750 (86.4453) kd_loss 0.9604 (0.9794) lr 1.4818e-03 eta 0:10:43
epoch [19/50] batch [100/176] time 0.085 (0.113) data 0.000 (0.003) loss 0.7993 (0.7115) ce_loss 0.5415 (0.3884) teacher_loss 0.4753 (0.3801) loss_zs_kd 0.0696 (0.0909) loss_oracle 0.2892 (0.2859) acc 78.1250 (86.5000) kd_loss 0.9865 (0.9819) lr 1.4818e-03 eta 0:10:24
epoch [19/50] batch [120/176] time 0.097 (0.112) data 0.000 (0.002) loss 0.7384 (0.7089) ce_loss 0.4563 (0.3858) teacher_loss 0.4491 (0.3769) loss_zs_kd 0.0868 (0.0908) loss_oracle 0.2459 (0.2866) acc 81.2500 (86.7448) kd_loss 1.0062 (0.9821) lr 1.4818e-03 eta 0:10:15
epoch [19/50] batch [140/176] time 0.116 (0.111) data 0.000 (0.002) loss 0.6428 (0.7051) ce_loss 0.3042 (0.3812) teacher_loss 0.3044 (0.3723) loss_zs_kd 0.0961 (0.0922) loss_oracle 0.2905 (0.2867) acc 93.7500 (87.0312) kd_loss 1.0018 (0.9801) lr 1.4818e-03 eta 0:10:06
epoch [19/50] batch [160/176] time 0.078 (0.110) data 0.000 (0.002) loss 0.7879 (0.6988) ce_loss 0.4778 (0.3730) teacher_loss 0.4930 (0.3649) loss_zs_kd 0.1140 (0.0936) loss_oracle 0.2379 (0.2871) acc 81.2500 (87.3438) kd_loss 0.9949 (0.9794) lr 1.4818e-03 eta 0:10:03
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,184
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 92.1%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,697
* accuracy: 63.9%
* error: 36.1%
* macro_f1: 59.1%
******* Domain l best val acc:      90.2%, epoch: 19 *******
******* Domain l best val test acc: 63.9%, epoch: 19 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [20/50] batch [20/176] time 0.099 (0.119) data 0.000 (0.015) loss 0.7198 (0.6873) ce_loss 0.3118 (0.3651) teacher_loss 0.3348 (0.3555) loss_zs_kd 0.1060 (0.0886) loss_oracle 0.3320 (0.2875) acc 87.5000 (87.9688) kd_loss 0.9865 (0.9752) lr 1.4258e-03 eta 0:10:47
epoch [20/50] batch [40/176] time 0.089 (0.116) data 0.000 (0.008) loss 0.4991 (0.6810) ce_loss 0.1843 (0.3585) teacher_loss 0.1823 (0.3482) loss_zs_kd 0.0529 (0.0878) loss_oracle 0.2904 (0.2888) acc 96.8750 (87.6562) kd_loss 0.9887 (0.9738) lr 1.4258e-03 eta 0:10:27
epoch [20/50] batch [60/176] time 0.138 (0.115) data 0.001 (0.005) loss 0.6696 (0.6925) ce_loss 0.3323 (0.3622) teacher_loss 0.3549 (0.3525) loss_zs_kd 0.0808 (0.0910) loss_oracle 0.2743 (0.2945) acc 90.6250 (87.6042) kd_loss 0.9887 (0.9790) lr 1.4258e-03 eta 0:10:19
epoch [20/50] batch [80/176] time 0.081 (0.113) data 0.000 (0.004) loss 0.6690 (0.6996) ce_loss 0.3850 (0.3655) teacher_loss 0.3798 (0.3590) loss_zs_kd 0.0784 (0.0909) loss_oracle 0.2500 (0.2951) acc 87.5000 (87.7344) kd_loss 0.9725 (0.9783) lr 1.4258e-03 eta 0:10:07
epoch [20/50] batch [100/176] time 0.087 (0.112) data 0.000 (0.003) loss 0.7170 (0.7029) ce_loss 0.3914 (0.3687) teacher_loss 0.4021 (0.3624) loss_zs_kd 0.0624 (0.0897) loss_oracle 0.2837 (0.2956) acc 84.3750 (87.5938) kd_loss 0.9477 (0.9776) lr 1.4258e-03 eta 0:09:59
epoch [20/50] batch [120/176] time 0.099 (0.112) data 0.000 (0.003) loss 0.7316 (0.7024) ce_loss 0.4014 (0.3696) teacher_loss 0.3718 (0.3613) loss_zs_kd 0.1304 (0.0926) loss_oracle 0.2946 (0.2948) acc 87.5000 (87.5000) kd_loss 0.9306 (0.9774) lr 1.4258e-03 eta 0:09:56
epoch [20/50] batch [140/176] time 0.097 (0.111) data 0.000 (0.002) loss 0.8443 (0.7010) ce_loss 0.4236 (0.3683) teacher_loss 0.4405 (0.3587) loss_zs_kd 0.1532 (0.0936) loss_oracle 0.3271 (0.2954) acc 84.3750 (87.4107) kd_loss 0.9322 (0.9773) lr 1.4258e-03 eta 0:09:52
epoch [20/50] batch [160/176] time 0.088 (0.111) data 0.000 (0.002) loss 0.6508 (0.7036) ce_loss 0.2849 (0.3716) teacher_loss 0.2746 (0.3615) loss_zs_kd 0.0891 (0.0948) loss_oracle 0.3316 (0.2948) acc 90.6250 (87.2461) kd_loss 0.9696 (0.9756) lr 1.4258e-03 eta 0:09:49
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,182
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,715
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 59.0%
******* Domain l best val acc:      90.2%, epoch: 19 *******
******* Domain l best val test acc: 63.9%, epoch: 19 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [21/50] batch [20/176] time 0.077 (0.114) data 0.000 (0.013) loss 0.6203 (0.7199) ce_loss 0.2673 (0.3860) teacher_loss 0.2572 (0.3749) loss_zs_kd 0.0843 (0.0935) loss_oracle 0.3209 (0.2982) acc 90.6250 (87.5000) kd_loss 0.9745 (0.9772) lr 1.3681e-03 eta 0:10:00
epoch [21/50] batch [40/176] time 0.111 (0.116) data 0.000 (0.006) loss 0.5817 (0.6911) ce_loss 0.2131 (0.3629) teacher_loss 0.2344 (0.3527) loss_zs_kd 0.0703 (0.0901) loss_oracle 0.3121 (0.2933) acc 93.7500 (87.8125) kd_loss 1.0236 (0.9804) lr 1.3681e-03 eta 0:10:06
epoch [21/50] batch [60/176] time 0.080 (0.117) data 0.001 (0.004) loss 0.6815 (0.6954) ce_loss 0.3684 (0.3704) teacher_loss 0.3440 (0.3592) loss_zs_kd 0.1205 (0.0915) loss_oracle 0.2773 (0.2905) acc 96.8750 (87.6562) kd_loss 0.9441 (0.9788) lr 1.3681e-03 eta 0:10:08
epoch [21/50] batch [80/176] time 0.179 (0.121) data 0.000 (0.003) loss 0.7078 (0.7008) ce_loss 0.4128 (0.3755) teacher_loss 0.3931 (0.3651) loss_zs_kd 0.1011 (0.0919) loss_oracle 0.2641 (0.2898) acc 96.8750 (87.6562) kd_loss 0.9674 (0.9818) lr 1.3681e-03 eta 0:10:28
epoch [21/50] batch [100/176] time 0.095 (0.116) data 0.000 (0.003) loss 0.6213 (0.7033) ce_loss 0.2898 (0.3780) teacher_loss 0.2682 (0.3673) loss_zs_kd 0.1283 (0.0922) loss_oracle 0.2889 (0.2899) acc 93.7500 (87.3125) kd_loss 0.9892 (0.9797) lr 1.3681e-03 eta 0:10:02
epoch [21/50] batch [120/176] time 0.133 (0.114) data 0.000 (0.002) loss 0.8794 (0.7119) ce_loss 0.5303 (0.3871) teacher_loss 0.5171 (0.3747) loss_zs_kd 0.0663 (0.0920) loss_oracle 0.3292 (0.2912) acc 81.2500 (86.9010) kd_loss 1.0400 (0.9783) lr 1.3681e-03 eta 0:09:47
epoch [21/50] batch [140/176] time 0.137 (0.113) data 0.000 (0.002) loss 0.5289 (0.7041) ce_loss 0.2080 (0.3805) teacher_loss 0.2175 (0.3686) loss_zs_kd 0.0740 (0.0925) loss_oracle 0.2744 (0.2892) acc 93.7500 (87.2768) kd_loss 0.9907 (0.9771) lr 1.3681e-03 eta 0:09:41
epoch [21/50] batch [160/176] time 0.088 (0.112) data 0.000 (0.002) loss 0.5906 (0.7018) ce_loss 0.2881 (0.3800) teacher_loss 0.2689 (0.3676) loss_zs_kd 0.1054 (0.0922) loss_oracle 0.2689 (0.2881) acc 87.5000 (86.9922) kd_loss 0.9381 (0.9789) lr 1.3681e-03 eta 0:09:33
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,183
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,706
* accuracy: 64.2%
* error: 35.8%
* macro_f1: 59.1%
******* Domain l best val acc:      90.2%, epoch: 19 *******
******* Domain l best val test acc: 63.9%, epoch: 19 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [22/50] batch [20/176] time 0.113 (0.106) data 0.000 (0.011) loss 0.6909 (0.7131) ce_loss 0.3728 (0.3899) teacher_loss 0.3731 (0.3810) loss_zs_kd 0.0639 (0.1006) loss_oracle 0.2858 (0.2817) acc 84.3750 (85.0000) kd_loss 0.9802 (0.9837) lr 1.3090e-03 eta 0:09:00
epoch [22/50] batch [40/176] time 0.125 (0.099) data 0.000 (0.006) loss 0.7114 (0.7029) ce_loss 0.4658 (0.3901) teacher_loss 0.4293 (0.3764) loss_zs_kd 0.0572 (0.0953) loss_oracle 0.2536 (0.2789) acc 78.1250 (85.2344) kd_loss 0.9863 (0.9774) lr 1.3090e-03 eta 0:08:23
epoch [22/50] batch [60/176] time 0.125 (0.099) data 0.001 (0.004) loss 0.6554 (0.7019) ce_loss 0.3015 (0.3877) teacher_loss 0.2836 (0.3737) loss_zs_kd 0.1031 (0.0910) loss_oracle 0.3202 (0.2827) acc 87.5000 (85.9896) kd_loss 1.0430 (0.9839) lr 1.3090e-03 eta 0:08:21
epoch [22/50] batch [80/176] time 0.111 (0.098) data 0.000 (0.003) loss 0.6389 (0.7006) ce_loss 0.3464 (0.3836) teacher_loss 0.3477 (0.3695) loss_zs_kd 0.0895 (0.0918) loss_oracle 0.2465 (0.2852) acc 93.7500 (86.3672) kd_loss 1.0080 (0.9878) lr 1.3090e-03 eta 0:08:13
epoch [22/50] batch [100/176] time 0.109 (0.100) data 0.000 (0.002) loss 0.6411 (0.7013) ce_loss 0.3511 (0.3882) teacher_loss 0.3034 (0.3696) loss_zs_kd 0.1065 (0.0938) loss_oracle 0.2844 (0.2848) acc 87.5000 (86.5312) kd_loss 0.9343 (0.9860) lr 1.3090e-03 eta 0:08:18
epoch [22/50] batch [120/176] time 0.078 (0.100) data 0.000 (0.002) loss 0.9683 (0.7032) ce_loss 0.6450 (0.3883) teacher_loss 0.6047 (0.3677) loss_zs_kd 0.1384 (0.0967) loss_oracle 0.2944 (0.2873) acc 81.2500 (86.3021) kd_loss 0.9800 (0.9875) lr 1.3090e-03 eta 0:08:17
epoch [22/50] batch [140/176] time 0.086 (0.100) data 0.001 (0.002) loss 0.5620 (0.6959) ce_loss 0.2612 (0.3827) teacher_loss 0.2688 (0.3624) loss_zs_kd 0.0852 (0.0959) loss_oracle 0.2506 (0.2856) acc 93.7500 (86.5402) kd_loss 1.0175 (0.9868) lr 1.3090e-03 eta 0:08:14
epoch [22/50] batch [160/176] time 0.077 (0.099) data 0.000 (0.002) loss 0.7608 (0.6980) ce_loss 0.4377 (0.3845) teacher_loss 0.4174 (0.3640) loss_zs_kd 0.0903 (0.0944) loss_oracle 0.2983 (0.2868) acc 81.2500 (86.6016) kd_loss 1.0035 (0.9867) lr 1.3090e-03 eta 0:08:07
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,182
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,767
* accuracy: 66.5%
* error: 33.5%
* macro_f1: 60.0%
******* Domain l best val acc:      90.2%, epoch: 19 *******
******* Domain l best val test acc: 63.9%, epoch: 19 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [23/50] batch [20/176] time 0.100 (0.119) data 0.000 (0.014) loss 0.7357 (0.7291) ce_loss 0.4009 (0.4037) teacher_loss 0.3996 (0.3858) loss_zs_kd 0.0835 (0.0865) loss_oracle 0.2943 (0.3000) acc 84.3750 (84.3750) kd_loss 1.0195 (0.9903) lr 1.2487e-03 eta 0:09:46
epoch [23/50] batch [40/176] time 0.113 (0.111) data 0.000 (0.007) loss 0.7602 (0.7114) ce_loss 0.4424 (0.3834) teacher_loss 0.4030 (0.3616) loss_zs_kd 0.0914 (0.0918) loss_oracle 0.3116 (0.3040) acc 78.1250 (85.4688) kd_loss 1.0060 (0.9885) lr 1.2487e-03 eta 0:09:01
epoch [23/50] batch [60/176] time 0.137 (0.107) data 0.000 (0.005) loss 0.7184 (0.7199) ce_loss 0.4136 (0.3878) teacher_loss 0.3874 (0.3667) loss_zs_kd 0.0816 (0.0936) loss_oracle 0.2902 (0.3064) acc 84.3750 (85.8854) kd_loss 0.9981 (0.9874) lr 1.2487e-03 eta 0:08:42
epoch [23/50] batch [80/176] time 0.118 (0.106) data 0.000 (0.004) loss 0.8470 (0.7239) ce_loss 0.5166 (0.3907) teacher_loss 0.5084 (0.3688) loss_zs_kd 0.0764 (0.0940) loss_oracle 0.3004 (0.3081) acc 78.1250 (86.0547) kd_loss 1.0147 (0.9897) lr 1.2487e-03 eta 0:08:35
epoch [23/50] batch [100/176] time 0.138 (0.106) data 0.000 (0.003) loss 0.8121 (0.7156) ce_loss 0.5381 (0.3837) teacher_loss 0.4803 (0.3607) loss_zs_kd 0.1154 (0.0941) loss_oracle 0.2741 (0.3079) acc 78.1250 (86.2812) kd_loss 0.8860 (0.9887) lr 1.2487e-03 eta 0:08:31
epoch [23/50] batch [120/176] time 0.086 (0.105) data 0.000 (0.003) loss 0.4861 (0.7147) ce_loss 0.1976 (0.3829) teacher_loss 0.1559 (0.3613) loss_zs_kd 0.0676 (0.0951) loss_oracle 0.2964 (0.3058) acc 93.7500 (86.5885) kd_loss 0.9451 (0.9877) lr 1.2487e-03 eta 0:08:24
epoch [23/50] batch [140/176] time 0.166 (0.105) data 0.000 (0.002) loss 0.6453 (0.7155) ce_loss 0.3101 (0.3840) teacher_loss 0.2923 (0.3623) loss_zs_kd 0.1125 (0.0955) loss_oracle 0.2968 (0.3056) acc 90.6250 (86.6741) kd_loss 1.0179 (0.9884) lr 1.2487e-03 eta 0:08:24
epoch [23/50] batch [160/176] time 0.090 (0.111) data 0.000 (0.002) loss 0.6562 (0.7088) ce_loss 0.3005 (0.3781) teacher_loss 0.2923 (0.3574) loss_zs_kd 0.1012 (0.0947) loss_oracle 0.3133 (0.3041) acc 96.8750 (86.9727) kd_loss 1.0152 (0.9873) lr 1.2487e-03 eta 0:08:47
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,178
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 91.9%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,679
* accuracy: 63.2%
* error: 36.8%
* macro_f1: 58.5%
******* Domain l best val acc:      90.2%, epoch: 19 *******
******* Domain l best val test acc: 63.9%, epoch: 19 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [24/50] batch [20/176] time 0.117 (0.126) data 0.000 (0.014) loss 0.7254 (0.6909) ce_loss 0.3066 (0.3502) teacher_loss 0.3040 (0.3323) loss_zs_kd 0.1412 (0.1081) loss_oracle 0.3508 (0.3046) acc 90.6250 (88.5938) kd_loss 1.0248 (0.9860) lr 1.1874e-03 eta 0:09:54
epoch [24/50] batch [40/176] time 0.091 (0.109) data 0.000 (0.007) loss 0.5420 (0.6772) ce_loss 0.2629 (0.3447) teacher_loss 0.2320 (0.3234) loss_zs_kd 0.1113 (0.1035) loss_oracle 0.2544 (0.3021) acc 93.7500 (88.1250) kd_loss 0.8566 (0.9867) lr 1.1874e-03 eta 0:08:32
epoch [24/50] batch [60/176] time 0.090 (0.104) data 0.001 (0.005) loss 0.6717 (0.7043) ce_loss 0.3333 (0.3694) teacher_loss 0.3172 (0.3454) loss_zs_kd 0.0887 (0.1062) loss_oracle 0.3102 (0.3058) acc 87.5000 (87.3438) kd_loss 0.9820 (0.9868) lr 1.1874e-03 eta 0:08:09
epoch [24/50] batch [80/176] time 0.088 (0.102) data 0.000 (0.004) loss 0.6306 (0.7028) ce_loss 0.2908 (0.3715) teacher_loss 0.3134 (0.3461) loss_zs_kd 0.0633 (0.1028) loss_oracle 0.2856 (0.3053) acc 93.7500 (87.1094) kd_loss 0.9997 (0.9869) lr 1.1874e-03 eta 0:07:56
epoch [24/50] batch [100/176] time 0.088 (0.101) data 0.000 (0.003) loss 0.4854 (0.6982) ce_loss 0.1887 (0.3696) teacher_loss 0.1847 (0.3452) loss_zs_kd 0.0546 (0.1017) loss_oracle 0.2734 (0.3021) acc 96.8750 (87.3750) kd_loss 0.9577 (0.9878) lr 1.1874e-03 eta 0:07:48
epoch [24/50] batch [120/176] time 0.119 (0.100) data 0.000 (0.003) loss 0.5315 (0.6974) ce_loss 0.2720 (0.3681) teacher_loss 0.2300 (0.3461) loss_zs_kd 0.0731 (0.1001) loss_oracle 0.2650 (0.3012) acc 90.6250 (87.3698) kd_loss 0.9819 (0.9883) lr 1.1874e-03 eta 0:07:42
epoch [24/50] batch [140/176] time 0.089 (0.100) data 0.000 (0.002) loss 0.6062 (0.6920) ce_loss 0.3018 (0.3637) teacher_loss 0.2686 (0.3415) loss_zs_kd 0.1013 (0.0996) loss_oracle 0.2870 (0.3007) acc 90.6250 (87.4330) kd_loss 0.9921 (0.9871) lr 1.1874e-03 eta 0:07:39
epoch [24/50] batch [160/176] time 0.138 (0.100) data 0.000 (0.002) loss 0.8365 (0.6976) ce_loss 0.4790 (0.3693) teacher_loss 0.4838 (0.3467) loss_zs_kd 0.0824 (0.1010) loss_oracle 0.3115 (0.3004) acc 84.3750 (87.1094) kd_loss 0.9680 (0.9862) lr 1.1874e-03 eta 0:07:40
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,177
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 91.9%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,706
* accuracy: 64.2%
* error: 35.8%
* macro_f1: 59.2%
******* Domain l best val acc:      90.2%, epoch: 19 *******
******* Domain l best val test acc: 63.9%, epoch: 19 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [25/50] batch [20/176] time 0.102 (0.108) data 0.000 (0.014) loss 0.7481 (0.6902) ce_loss 0.4172 (0.3668) teacher_loss 0.3980 (0.3376) loss_zs_kd 0.0930 (0.0977) loss_oracle 0.3036 (0.3037) acc 87.5000 (87.1875) kd_loss 1.0021 (0.9920) lr 1.1253e-03 eta 0:08:10
epoch [25/50] batch [40/176] time 0.131 (0.104) data 0.001 (0.007) loss 0.7097 (0.6975) ce_loss 0.3350 (0.3676) teacher_loss 0.3400 (0.3458) loss_zs_kd 0.1110 (0.0979) loss_oracle 0.3141 (0.3027) acc 87.5000 (87.1875) kd_loss 0.9871 (0.9904) lr 1.1253e-03 eta 0:07:51
epoch [25/50] batch [60/176] time 0.094 (0.103) data 0.001 (0.005) loss 0.7221 (0.6942) ce_loss 0.4185 (0.3622) teacher_loss 0.3655 (0.3383) loss_zs_kd 0.0904 (0.0977) loss_oracle 0.3115 (0.3071) acc 84.3750 (87.8125) kd_loss 0.9381 (0.9869) lr 1.1253e-03 eta 0:07:44
epoch [25/50] batch [80/176] time 0.082 (0.104) data 0.000 (0.004) loss 0.6635 (0.7002) ce_loss 0.3306 (0.3617) teacher_loss 0.3199 (0.3404) loss_zs_kd 0.0925 (0.0986) loss_oracle 0.2973 (0.3104) acc 84.3750 (87.7344) kd_loss 0.9439 (0.9852) lr 1.1253e-03 eta 0:07:47
epoch [25/50] batch [100/176] time 0.119 (0.105) data 0.000 (0.003) loss 0.7723 (0.7075) ce_loss 0.3950 (0.3693) teacher_loss 0.3718 (0.3487) loss_zs_kd 0.0796 (0.0979) loss_oracle 0.3607 (0.3098) acc 90.6250 (87.2500) kd_loss 0.9595 (0.9848) lr 1.1253e-03 eta 0:07:49
epoch [25/50] batch [120/176] time 0.082 (0.107) data 0.000 (0.003) loss 0.9125 (0.7153) ce_loss 0.6050 (0.3775) teacher_loss 0.6123 (0.3584) loss_zs_kd 0.0618 (0.0966) loss_oracle 0.2693 (0.3086) acc 78.1250 (87.0312) kd_loss 1.0368 (0.9858) lr 1.1253e-03 eta 0:07:55
epoch [25/50] batch [140/176] time 0.122 (0.107) data 0.000 (0.002) loss 0.5613 (0.7206) ce_loss 0.2443 (0.3813) teacher_loss 0.2310 (0.3637) loss_zs_kd 0.0591 (0.0968) loss_oracle 0.3008 (0.3085) acc 87.5000 (86.8080) kd_loss 1.0272 (0.9880) lr 1.1253e-03 eta 0:07:56
epoch [25/50] batch [160/176] time 0.135 (0.108) data 0.000 (0.002) loss 0.8138 (0.7206) ce_loss 0.4883 (0.3821) teacher_loss 0.4920 (0.3654) loss_zs_kd 0.0701 (0.0966) loss_oracle 0.2867 (0.3069) acc 87.5000 (86.8164) kd_loss 0.9092 (0.9858) lr 1.1253e-03 eta 0:07:56
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,181
* accuracy: 90.0%
* error: 10.0%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,731
* accuracy: 65.2%
* error: 34.8%
* macro_f1: 59.5%
******* Domain l best val acc:      90.2%, epoch: 19 *******
******* Domain l best val test acc: 63.9%, epoch: 19 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [26/50] batch [20/176] time 0.156 (0.145) data 0.000 (0.014) loss 0.7505 (0.6935) ce_loss 0.4688 (0.3514) teacher_loss 0.4563 (0.3504) loss_zs_kd 0.0891 (0.1037) loss_oracle 0.2496 (0.2913) acc 87.5000 (89.8438) kd_loss 0.9554 (0.9869) lr 1.0628e-03 eta 0:10:35
epoch [26/50] batch [40/176] time 0.066 (0.130) data 0.000 (0.007) loss 0.8787 (0.7285) ce_loss 0.5347 (0.3893) teacher_loss 0.5224 (0.3800) loss_zs_kd 0.1050 (0.0995) loss_oracle 0.3037 (0.2987) acc 78.1250 (87.8125) kd_loss 0.9946 (0.9915) lr 1.0628e-03 eta 0:09:27
epoch [26/50] batch [60/176] time 0.069 (0.130) data 0.000 (0.005) loss 0.6861 (0.7300) ce_loss 0.3813 (0.3917) teacher_loss 0.3769 (0.3870) loss_zs_kd 0.0751 (0.0969) loss_oracle 0.2717 (0.2945) acc 84.3750 (87.2396) kd_loss 0.9827 (0.9870) lr 1.0628e-03 eta 0:09:25
epoch [26/50] batch [80/176] time 0.100 (0.123) data 0.000 (0.004) loss 0.6214 (0.7330) ce_loss 0.3018 (0.3919) teacher_loss 0.3081 (0.3881) loss_zs_kd 0.1007 (0.0982) loss_oracle 0.2629 (0.2958) acc 84.3750 (86.9922) kd_loss 1.0184 (0.9857) lr 1.0628e-03 eta 0:08:51
epoch [26/50] batch [100/176] time 0.117 (0.118) data 0.000 (0.003) loss 0.7171 (0.7357) ce_loss 0.2915 (0.3952) teacher_loss 0.3049 (0.3898) loss_zs_kd 0.1536 (0.0979) loss_oracle 0.3355 (0.2969) acc 84.3750 (86.4062) kd_loss 1.0367 (0.9885) lr 1.0628e-03 eta 0:08:28
epoch [26/50] batch [120/176] time 0.101 (0.116) data 0.000 (0.003) loss 0.5654 (0.7286) ce_loss 0.2368 (0.3880) teacher_loss 0.2161 (0.3818) loss_zs_kd 0.0700 (0.0957) loss_oracle 0.3143 (0.2989) acc 90.6250 (86.6406) kd_loss 0.9999 (0.9902) lr 1.0628e-03 eta 0:08:14
epoch [26/50] batch [140/176] time 0.108 (0.114) data 0.000 (0.002) loss 0.7894 (0.7241) ce_loss 0.4495 (0.3836) teacher_loss 0.4352 (0.3766) loss_zs_kd 0.1325 (0.0957) loss_oracle 0.2880 (0.2997) acc 90.6250 (86.8750) kd_loss 0.9762 (0.9887) lr 1.0628e-03 eta 0:08:05
epoch [26/50] batch [160/176] time 0.093 (0.113) data 0.000 (0.002) loss 0.5732 (0.7184) ce_loss 0.2354 (0.3792) teacher_loss 0.2415 (0.3716) loss_zs_kd 0.0717 (0.0952) loss_oracle 0.2959 (0.2992) acc 93.7500 (87.0312) kd_loss 0.9582 (0.9883) lr 1.0628e-03 eta 0:07:58
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,184
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,712
* accuracy: 64.5%
* error: 35.5%
* macro_f1: 59.2%
******* Domain l best val acc:      90.2%, epoch: 19 *******
******* Domain l best val test acc: 63.9%, epoch: 19 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [27/50] batch [20/176] time 0.108 (0.114) data 0.000 (0.012) loss 0.6044 (0.7132) ce_loss 0.1899 (0.3494) teacher_loss 0.1993 (0.3427) loss_zs_kd 0.1307 (0.1008) loss_oracle 0.3398 (0.3201) acc 93.7500 (88.4375) kd_loss 0.9873 (1.0017) lr 1.0000e-03 eta 0:07:58
epoch [27/50] batch [40/176] time 0.075 (0.105) data 0.000 (0.006) loss 0.5256 (0.7095) ce_loss 0.1227 (0.3394) teacher_loss 0.1187 (0.3326) loss_zs_kd 0.0484 (0.0960) loss_oracle 0.3827 (0.3290) acc 96.8750 (88.7500) kd_loss 1.0559 (0.9984) lr 1.0000e-03 eta 0:07:20
epoch [27/50] batch [60/176] time 0.086 (0.104) data 0.000 (0.004) loss 0.8379 (0.7294) ce_loss 0.3840 (0.3569) teacher_loss 0.3732 (0.3497) loss_zs_kd 0.1465 (0.0969) loss_oracle 0.3914 (0.3313) acc 84.3750 (87.8125) kd_loss 1.0808 (0.9951) lr 1.0000e-03 eta 0:07:14
epoch [27/50] batch [80/176] time 0.130 (0.105) data 0.000 (0.003) loss 0.6512 (0.7259) ce_loss 0.2776 (0.3577) teacher_loss 0.2764 (0.3487) loss_zs_kd 0.1529 (0.1003) loss_oracle 0.2984 (0.3270) acc 96.8750 (87.7734) kd_loss 0.9733 (0.9939) lr 1.0000e-03 eta 0:07:15
epoch [27/50] batch [100/176] time 0.085 (0.104) data 0.000 (0.003) loss 0.6351 (0.7206) ce_loss 0.3105 (0.3568) teacher_loss 0.2773 (0.3472) loss_zs_kd 0.0913 (0.1002) loss_oracle 0.3122 (0.3232) acc 87.5000 (87.6875) kd_loss 0.9925 (0.9951) lr 1.0000e-03 eta 0:07:10
epoch [27/50] batch [120/176] time 0.086 (0.105) data 0.000 (0.002) loss 0.7462 (0.7186) ce_loss 0.3472 (0.3577) teacher_loss 0.3545 (0.3469) loss_zs_kd 0.1373 (0.1004) loss_oracle 0.3230 (0.3214) acc 81.2500 (87.4479) kd_loss 0.9984 (0.9968) lr 1.0000e-03 eta 0:07:12
epoch [27/50] batch [140/176] time 0.133 (0.106) data 0.000 (0.002) loss 0.6254 (0.7236) ce_loss 0.2400 (0.3650) teacher_loss 0.2554 (0.3541) loss_zs_kd 0.0807 (0.0993) loss_oracle 0.3296 (0.3199) acc 90.6250 (87.0089) kd_loss 0.9937 (0.9949) lr 1.0000e-03 eta 0:07:14
epoch [27/50] batch [160/176] time 0.132 (0.107) data 0.000 (0.002) loss 0.8291 (0.7264) ce_loss 0.5366 (0.3710) teacher_loss 0.4562 (0.3580) loss_zs_kd 0.1137 (0.0995) loss_oracle 0.3161 (0.3186) acc 90.6250 (86.7188) kd_loss 0.9696 (0.9938) lr 1.0000e-03 eta 0:07:14
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,180
* accuracy: 90.0%
* error: 10.0%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,694
* accuracy: 63.8%
* error: 36.2%
* macro_f1: 58.6%
******* Domain l best val acc:      90.2%, epoch: 19 *******
******* Domain l best val test acc: 63.9%, epoch: 19 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [28/50] batch [20/176] time 0.094 (0.116) data 0.000 (0.014) loss 0.6708 (0.6856) ce_loss 0.2764 (0.3521) teacher_loss 0.2627 (0.3402) loss_zs_kd 0.0899 (0.0974) loss_oracle 0.3631 (0.2967) acc 93.7500 (88.7500) kd_loss 0.9522 (0.9888) lr 9.3721e-04 eta 0:07:49
epoch [28/50] batch [40/176] time 0.110 (0.111) data 0.000 (0.007) loss 0.6150 (0.7004) ce_loss 0.2156 (0.3660) teacher_loss 0.2427 (0.3522) loss_zs_kd 0.0734 (0.0963) loss_oracle 0.3355 (0.3000) acc 93.7500 (87.2656) kd_loss 1.0264 (0.9880) lr 9.3721e-04 eta 0:07:23
epoch [28/50] batch [60/176] time 0.140 (0.113) data 0.000 (0.005) loss 0.8800 (0.7170) ce_loss 0.5742 (0.3749) teacher_loss 0.5464 (0.3619) loss_zs_kd 0.0862 (0.0945) loss_oracle 0.2905 (0.3079) acc 81.2500 (86.7188) kd_loss 0.9255 (0.9935) lr 9.3721e-04 eta 0:07:28
epoch [28/50] batch [80/176] time 0.098 (0.112) data 0.000 (0.004) loss 0.6762 (0.7174) ce_loss 0.2913 (0.3721) teacher_loss 0.2751 (0.3609) loss_zs_kd 0.0730 (0.0931) loss_oracle 0.3646 (0.3099) acc 87.5000 (86.6406) kd_loss 1.0039 (0.9917) lr 9.3721e-04 eta 0:07:22
epoch [28/50] batch [100/176] time 0.174 (0.117) data 0.000 (0.003) loss 0.4993 (0.7156) ce_loss 0.1793 (0.3704) teacher_loss 0.1595 (0.3606) loss_zs_kd 0.0860 (0.0927) loss_oracle 0.2969 (0.3086) acc 93.7500 (86.7188) kd_loss 0.9901 (0.9906) lr 9.3721e-04 eta 0:07:42
epoch [28/50] batch [120/176] time 0.169 (0.118) data 0.001 (0.003) loss 0.8337 (0.7171) ce_loss 0.5176 (0.3743) teacher_loss 0.5100 (0.3635) loss_zs_kd 0.1037 (0.0936) loss_oracle 0.2718 (0.3068) acc 87.5000 (86.8229) kd_loss 0.9596 (0.9924) lr 9.3721e-04 eta 0:07:42
epoch [28/50] batch [140/176] time 0.137 (0.120) data 0.001 (0.002) loss 0.7325 (0.7145) ce_loss 0.3462 (0.3708) teacher_loss 0.3490 (0.3610) loss_zs_kd 0.1196 (0.0935) loss_oracle 0.3237 (0.3068) acc 81.2500 (86.7634) kd_loss 1.0407 (0.9920) lr 9.3721e-04 eta 0:07:48
epoch [28/50] batch [160/176] time 0.131 (0.118) data 0.000 (0.002) loss 0.5858 (0.7152) ce_loss 0.2825 (0.3706) teacher_loss 0.2715 (0.3606) loss_zs_kd 0.0774 (0.0936) loss_oracle 0.2756 (0.3078) acc 87.5000 (86.8555) kd_loss 1.0099 (0.9907) lr 9.3721e-04 eta 0:07:40
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,183
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,752
* accuracy: 66.0%
* error: 34.0%
* macro_f1: 59.7%
******* Domain l best val acc:      90.2%, epoch: 19 *******
******* Domain l best val test acc: 63.9%, epoch: 19 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [29/50] batch [20/176] time 0.120 (0.124) data 0.000 (0.012) loss 0.7282 (0.7236) ce_loss 0.3850 (0.3824) teacher_loss 0.3617 (0.3692) loss_zs_kd 0.1090 (0.0936) loss_oracle 0.3120 (0.3076) acc 87.5000 (86.5625) kd_loss 1.0620 (0.9898) lr 8.7467e-04 eta 0:07:56
epoch [29/50] batch [40/176] time 0.083 (0.115) data 0.000 (0.006) loss 0.6802 (0.7230) ce_loss 0.3311 (0.3783) teacher_loss 0.3553 (0.3680) loss_zs_kd 0.0876 (0.0939) loss_oracle 0.2811 (0.3082) acc 90.6250 (86.7188) kd_loss 1.0049 (0.9966) lr 8.7467e-04 eta 0:07:22
epoch [29/50] batch [60/176] time 0.120 (0.117) data 0.001 (0.004) loss 0.9554 (0.7247) ce_loss 0.6030 (0.3817) teacher_loss 0.5931 (0.3727) loss_zs_kd 0.1282 (0.0949) loss_oracle 0.2983 (0.3045) acc 78.1250 (86.8229) kd_loss 0.9535 (0.9888) lr 8.7467e-04 eta 0:07:25
epoch [29/50] batch [80/176] time 0.120 (0.115) data 0.001 (0.003) loss 0.7924 (0.7264) ce_loss 0.4133 (0.3810) teacher_loss 0.3851 (0.3731) loss_zs_kd 0.0720 (0.0927) loss_oracle 0.3713 (0.3069) acc 87.5000 (87.0703) kd_loss 1.0397 (0.9890) lr 8.7467e-04 eta 0:07:17
epoch [29/50] batch [100/176] time 0.135 (0.116) data 0.000 (0.003) loss 0.8974 (0.7341) ce_loss 0.5728 (0.3870) teacher_loss 0.5385 (0.3784) loss_zs_kd 0.0614 (0.0922) loss_oracle 0.3281 (0.3097) acc 84.3750 (86.7812) kd_loss 0.9874 (0.9891) lr 8.7467e-04 eta 0:07:15
epoch [29/50] batch [120/176] time 0.094 (0.116) data 0.000 (0.002) loss 0.6262 (0.7299) ce_loss 0.2903 (0.3827) teacher_loss 0.2507 (0.3737) loss_zs_kd 0.1100 (0.0940) loss_oracle 0.3205 (0.3092) acc 93.7500 (86.9010) kd_loss 0.9573 (0.9873) lr 8.7467e-04 eta 0:07:15
epoch [29/50] batch [140/176] time 0.131 (0.116) data 0.000 (0.002) loss 0.8614 (0.7303) ce_loss 0.4229 (0.3805) teacher_loss 0.4398 (0.3724) loss_zs_kd 0.0952 (0.0931) loss_oracle 0.3740 (0.3114) acc 90.6250 (86.8527) kd_loss 0.9916 (0.9881) lr 8.7467e-04 eta 0:07:14
epoch [29/50] batch [160/176] time 0.135 (0.116) data 0.000 (0.002) loss 0.7222 (0.7302) ce_loss 0.2983 (0.3777) teacher_loss 0.3009 (0.3699) loss_zs_kd 0.1216 (0.0935) loss_oracle 0.3604 (0.3136) acc 96.8750 (87.1484) kd_loss 0.9917 (0.9869) lr 8.7467e-04 eta 0:07:11
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,188
* accuracy: 90.3%
* error: 9.7%
* macro_f1: 92.3%
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,766
* accuracy: 66.5%
* error: 33.5%
* macro_f1: 60.0%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [30/50] batch [20/176] time 0.090 (0.115) data 0.000 (0.016) loss 0.6087 (0.7143) ce_loss 0.2888 (0.3723) teacher_loss 0.2623 (0.3636) loss_zs_kd 0.0698 (0.0897) loss_oracle 0.3116 (0.3059) acc 87.5000 (87.8125) kd_loss 1.0324 (0.9871) lr 8.1262e-04 eta 0:07:02
epoch [30/50] batch [40/176] time 0.089 (0.107) data 0.000 (0.008) loss 0.6037 (0.7045) ce_loss 0.3064 (0.3622) teacher_loss 0.3072 (0.3552) loss_zs_kd 0.0734 (0.0896) loss_oracle 0.2598 (0.3044) acc 87.5000 (87.5781) kd_loss 0.9924 (0.9868) lr 8.1262e-04 eta 0:06:30
epoch [30/50] batch [60/176] time 0.090 (0.103) data 0.000 (0.006) loss 0.5415 (0.7025) ce_loss 0.2966 (0.3661) teacher_loss 0.2641 (0.3564) loss_zs_kd 0.0762 (0.0875) loss_oracle 0.2393 (0.3023) acc 93.7500 (87.7604) kd_loss 0.9537 (0.9872) lr 8.1262e-04 eta 0:06:13
epoch [30/50] batch [80/176] time 0.076 (0.100) data 0.000 (0.004) loss 0.7656 (0.7140) ce_loss 0.4187 (0.3749) teacher_loss 0.4191 (0.3646) loss_zs_kd 0.0696 (0.0891) loss_oracle 0.3117 (0.3048) acc 84.3750 (87.4609) kd_loss 1.0338 (0.9896) lr 8.1262e-04 eta 0:06:00
epoch [30/50] batch [100/176] time 0.137 (0.099) data 0.000 (0.003) loss 0.6052 (0.7221) ce_loss 0.3025 (0.3823) teacher_loss 0.3132 (0.3722) loss_zs_kd 0.0898 (0.0922) loss_oracle 0.2472 (0.3037) acc 90.6250 (86.9375) kd_loss 0.8925 (0.9903) lr 8.1262e-04 eta 0:05:56
epoch [30/50] batch [120/176] time 0.078 (0.099) data 0.000 (0.003) loss 0.7352 (0.7221) ce_loss 0.3872 (0.3828) teacher_loss 0.3771 (0.3723) loss_zs_kd 0.0891 (0.0929) loss_oracle 0.3136 (0.3033) acc 90.6250 (86.8229) kd_loss 1.0224 (0.9912) lr 8.1262e-04 eta 0:05:54
epoch [30/50] batch [140/176] time 0.142 (0.097) data 0.000 (0.002) loss 0.5670 (0.7198) ce_loss 0.3149 (0.3824) teacher_loss 0.2821 (0.3719) loss_zs_kd 0.0722 (0.0930) loss_oracle 0.2487 (0.3014) acc 90.6250 (86.8527) kd_loss 0.9522 (0.9915) lr 8.1262e-04 eta 0:05:46
epoch [30/50] batch [160/176] time 0.146 (0.102) data 0.000 (0.002) loss 0.5286 (0.7111) ce_loss 0.2007 (0.3760) teacher_loss 0.1795 (0.3658) loss_zs_kd 0.1247 (0.0924) loss_oracle 0.2868 (0.2991) acc 96.8750 (86.9727) kd_loss 0.9721 (0.9900) lr 8.1262e-04 eta 0:06:00
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,181
* accuracy: 90.0%
* error: 10.0%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,719
* accuracy: 64.7%
* error: 35.3%
* macro_f1: 59.3%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [31/50] batch [20/176] time 0.080 (0.106) data 0.000 (0.011) loss 0.5217 (0.6743) ce_loss 0.1946 (0.3372) teacher_loss 0.1915 (0.3328) loss_zs_kd 0.1278 (0.0894) loss_oracle 0.2663 (0.2968) acc 93.7500 (88.1250) kd_loss 1.0251 (0.9950) lr 7.5131e-04 eta 0:06:12
epoch [31/50] batch [40/176] time 0.074 (0.105) data 0.000 (0.006) loss 0.7355 (0.6932) ce_loss 0.4038 (0.3581) teacher_loss 0.3923 (0.3470) loss_zs_kd 0.0969 (0.0964) loss_oracle 0.2948 (0.2980) acc 87.5000 (87.8125) kd_loss 1.0102 (0.9871) lr 7.5131e-04 eta 0:06:05
epoch [31/50] batch [60/176] time 0.119 (0.104) data 0.001 (0.004) loss 0.9154 (0.7128) ce_loss 0.5083 (0.3717) teacher_loss 0.5125 (0.3615) loss_zs_kd 0.1099 (0.0975) loss_oracle 0.3479 (0.3026) acc 75.0000 (87.0833) kd_loss 1.0271 (0.9905) lr 7.5131e-04 eta 0:05:59
epoch [31/50] batch [80/176] time 0.102 (0.104) data 0.000 (0.003) loss 0.7441 (0.7161) ce_loss 0.3801 (0.3772) teacher_loss 0.4037 (0.3668) loss_zs_kd 0.1228 (0.0948) loss_oracle 0.2790 (0.3019) acc 87.5000 (86.7969) kd_loss 1.0002 (0.9930) lr 7.5131e-04 eta 0:05:57
epoch [31/50] batch [100/176] time 0.095 (0.104) data 0.000 (0.002) loss 0.8734 (0.7113) ce_loss 0.4822 (0.3757) teacher_loss 0.4950 (0.3654) loss_zs_kd 0.1161 (0.0942) loss_oracle 0.3203 (0.2987) acc 78.1250 (86.8438) kd_loss 1.0144 (0.9891) lr 7.5131e-04 eta 0:05:55
epoch [31/50] batch [120/176] time 0.126 (0.104) data 0.000 (0.002) loss 0.6034 (0.7071) ce_loss 0.2703 (0.3719) teacher_loss 0.2667 (0.3621) loss_zs_kd 0.0715 (0.0932) loss_oracle 0.3009 (0.2984) acc 87.5000 (87.0833) kd_loss 1.0215 (0.9888) lr 7.5131e-04 eta 0:05:53
epoch [31/50] batch [140/176] time 0.090 (0.104) data 0.000 (0.002) loss 0.4659 (0.7041) ce_loss 0.1385 (0.3697) teacher_loss 0.1389 (0.3606) loss_zs_kd 0.0555 (0.0933) loss_oracle 0.2993 (0.2968) acc 100.0000 (87.2098) kd_loss 1.0024 (0.9909) lr 7.5131e-04 eta 0:05:52
epoch [31/50] batch [160/176] time 0.134 (0.105) data 0.000 (0.002) loss 0.7531 (0.7038) ce_loss 0.4473 (0.3703) teacher_loss 0.4363 (0.3616) loss_zs_kd 0.1032 (0.0943) loss_oracle 0.2653 (0.2951) acc 93.7500 (87.2852) kd_loss 1.0149 (0.9889) lr 7.5131e-04 eta 0:05:53
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,185
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,705
* accuracy: 64.2%
* error: 35.8%
* macro_f1: 59.1%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [32/50] batch [20/176] time 0.074 (0.130) data 0.000 (0.014) loss 0.5953 (0.7341) ce_loss 0.2996 (0.3906) teacher_loss 0.2621 (0.3805) loss_zs_kd 0.0833 (0.1012) loss_oracle 0.2915 (0.3030) acc 87.5000 (87.3438) kd_loss 0.9695 (0.9850) lr 6.9098e-04 eta 0:07:11
epoch [32/50] batch [40/176] time 0.134 (0.123) data 0.000 (0.007) loss 0.5505 (0.7151) ce_loss 0.2257 (0.3799) teacher_loss 0.2255 (0.3632) loss_zs_kd 0.1129 (0.1022) loss_oracle 0.2685 (0.3009) acc 93.7500 (87.8125) kd_loss 0.9290 (0.9886) lr 6.9098e-04 eta 0:06:44
epoch [32/50] batch [60/176] time 0.118 (0.120) data 0.001 (0.005) loss 1.1435 (0.7261) ce_loss 0.7637 (0.3853) teacher_loss 0.7734 (0.3673) loss_zs_kd 0.0987 (0.1051) loss_oracle 0.3208 (0.3063) acc 81.2500 (87.3958) kd_loss 0.9784 (0.9935) lr 6.9098e-04 eta 0:06:33
epoch [32/50] batch [80/176] time 0.109 (0.117) data 0.001 (0.004) loss 0.8944 (0.7230) ce_loss 0.5781 (0.3756) teacher_loss 0.5660 (0.3603) loss_zs_kd 0.0788 (0.1038) loss_oracle 0.2889 (0.3108) acc 71.8750 (87.6172) kd_loss 1.0126 (0.9947) lr 6.9098e-04 eta 0:06:23
epoch [32/50] batch [100/176] time 0.084 (0.119) data 0.000 (0.003) loss 0.8968 (0.7283) ce_loss 0.5684 (0.3817) teacher_loss 0.5620 (0.3682) loss_zs_kd 0.0894 (0.1028) loss_oracle 0.2901 (0.3087) acc 65.6250 (87.1562) kd_loss 1.0293 (0.9916) lr 6.9098e-04 eta 0:06:24
epoch [32/50] batch [120/176] time 0.097 (0.117) data 0.000 (0.003) loss 0.8229 (0.7222) ce_loss 0.4661 (0.3765) teacher_loss 0.4698 (0.3646) loss_zs_kd 0.1442 (0.1009) loss_oracle 0.2811 (0.3072) acc 75.0000 (87.2135) kd_loss 1.0570 (0.9943) lr 6.9098e-04 eta 0:06:15
epoch [32/50] batch [140/176] time 0.137 (0.117) data 0.000 (0.002) loss 0.6194 (0.7169) ce_loss 0.2666 (0.3717) teacher_loss 0.2554 (0.3603) loss_zs_kd 0.0670 (0.0992) loss_oracle 0.3305 (0.3070) acc 87.5000 (87.3438) kd_loss 1.0295 (0.9941) lr 6.9098e-04 eta 0:06:15
epoch [32/50] batch [160/176] time 0.089 (0.117) data 0.000 (0.002) loss 0.5942 (0.7168) ce_loss 0.3086 (0.3727) teacher_loss 0.2816 (0.3617) loss_zs_kd 0.0834 (0.0986) loss_oracle 0.2709 (0.3058) acc 84.3750 (87.2266) kd_loss 0.9646 (0.9929) lr 6.9098e-04 eta 0:06:13
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,185
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 92.2%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,728
* accuracy: 65.1%
* error: 34.9%
* macro_f1: 59.8%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [33/50] batch [20/176] time 0.117 (0.128) data 0.000 (0.013) loss 0.7961 (0.7179) ce_loss 0.4648 (0.3793) teacher_loss 0.4435 (0.3643) loss_zs_kd 0.0727 (0.0945) loss_oracle 0.3163 (0.3064) acc 87.5000 (86.8750) kd_loss 1.0338 (0.9815) lr 6.3188e-04 eta 0:06:42
epoch [33/50] batch [40/176] time 0.086 (0.113) data 0.000 (0.007) loss 0.7135 (0.7233) ce_loss 0.3103 (0.3788) teacher_loss 0.3173 (0.3675) loss_zs_kd 0.1138 (0.0951) loss_oracle 0.3393 (0.3083) acc 90.6250 (86.3281) kd_loss 1.0275 (0.9908) lr 6.3188e-04 eta 0:05:53
epoch [33/50] batch [60/176] time 0.133 (0.111) data 0.000 (0.004) loss 0.6067 (0.7151) ce_loss 0.2810 (0.3706) teacher_loss 0.2741 (0.3579) loss_zs_kd 0.0731 (0.0949) loss_oracle 0.2960 (0.3097) acc 87.5000 (86.8229) kd_loss 0.9943 (0.9917) lr 6.3188e-04 eta 0:05:46
epoch [33/50] batch [80/176] time 0.142 (0.113) data 0.000 (0.003) loss 0.7448 (0.7326) ce_loss 0.3484 (0.3848) teacher_loss 0.3285 (0.3728) loss_zs_kd 0.1208 (0.0951) loss_oracle 0.3560 (0.3122) acc 90.6250 (86.5234) kd_loss 1.0173 (0.9979) lr 6.3188e-04 eta 0:05:48
epoch [33/50] batch [100/176] time 0.135 (0.112) data 0.000 (0.003) loss 0.5329 (0.7297) ce_loss 0.2299 (0.3826) teacher_loss 0.2173 (0.3708) loss_zs_kd 0.1009 (0.0949) loss_oracle 0.2651 (0.3115) acc 90.6250 (86.5938) kd_loss 0.9038 (0.9969) lr 6.3188e-04 eta 0:05:44
epoch [33/50] batch [120/176] time 0.123 (0.112) data 0.000 (0.002) loss 0.5793 (0.7297) ce_loss 0.2881 (0.3849) teacher_loss 0.2557 (0.3718) loss_zs_kd 0.0846 (0.0950) loss_oracle 0.2813 (0.3104) acc 90.6250 (86.5625) kd_loss 1.0338 (0.9968) lr 6.3188e-04 eta 0:05:40
epoch [33/50] batch [140/176] time 0.098 (0.112) data 0.000 (0.002) loss 0.5854 (0.7244) ce_loss 0.2051 (0.3782) teacher_loss 0.1794 (0.3662) loss_zs_kd 0.0797 (0.0945) loss_oracle 0.3661 (0.3110) acc 90.6250 (86.7634) kd_loss 1.0577 (0.9965) lr 6.3188e-04 eta 0:05:38
epoch [33/50] batch [160/176] time 0.102 (0.112) data 0.000 (0.002) loss 0.8923 (0.7291) ce_loss 0.5063 (0.3804) teacher_loss 0.5069 (0.3690) loss_zs_kd 0.1158 (0.0944) loss_oracle 0.3275 (0.3130) acc 78.1250 (86.4062) kd_loss 0.9213 (0.9954) lr 6.3188e-04 eta 0:05:36
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,185
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,678
* accuracy: 63.2%
* error: 36.8%
* macro_f1: 58.6%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [34/50] batch [20/176] time 0.108 (0.114) data 0.001 (0.012) loss 0.6896 (0.7165) ce_loss 0.3132 (0.3691) teacher_loss 0.3136 (0.3481) loss_zs_kd 0.1037 (0.1006) loss_oracle 0.3242 (0.3182) acc 93.7500 (87.1875) kd_loss 0.9979 (0.9937) lr 5.7422e-04 eta 0:05:37
epoch [34/50] batch [40/176] time 0.145 (0.114) data 0.000 (0.006) loss 0.8293 (0.7300) ce_loss 0.4814 (0.3776) teacher_loss 0.4441 (0.3620) loss_zs_kd 0.0493 (0.0953) loss_oracle 0.3606 (0.3204) acc 75.0000 (87.0312) kd_loss 0.9950 (0.9976) lr 5.7422e-04 eta 0:05:37
epoch [34/50] batch [60/176] time 0.097 (0.113) data 0.001 (0.004) loss 0.7624 (0.7115) ce_loss 0.3369 (0.3572) teacher_loss 0.3321 (0.3431) loss_zs_kd 0.1036 (0.0960) loss_oracle 0.3785 (0.3204) acc 90.6250 (87.9167) kd_loss 0.9711 (0.9950) lr 5.7422e-04 eta 0:05:30
epoch [34/50] batch [80/176] time 0.136 (0.116) data 0.000 (0.003) loss 0.7545 (0.7246) ce_loss 0.3901 (0.3701) teacher_loss 0.3825 (0.3585) loss_zs_kd 0.1383 (0.0970) loss_oracle 0.3029 (0.3176) acc 84.3750 (86.9922) kd_loss 0.9500 (0.9948) lr 5.7422e-04 eta 0:05:36
epoch [34/50] batch [100/176] time 0.102 (0.116) data 0.000 (0.003) loss 0.8320 (0.7214) ce_loss 0.4783 (0.3708) teacher_loss 0.4507 (0.3595) loss_zs_kd 0.1036 (0.0970) loss_oracle 0.3296 (0.3134) acc 81.2500 (86.8125) kd_loss 1.0124 (0.9944) lr 5.7422e-04 eta 0:05:34
epoch [34/50] batch [120/176] time 0.138 (0.115) data 0.000 (0.002) loss 0.7494 (0.7230) ce_loss 0.4280 (0.3743) teacher_loss 0.4172 (0.3639) loss_zs_kd 0.0858 (0.0964) loss_oracle 0.2892 (0.3109) acc 87.5000 (86.6927) kd_loss 1.0300 (0.9971) lr 5.7422e-04 eta 0:05:31
epoch [34/50] batch [140/176] time 0.133 (0.117) data 0.000 (0.002) loss 0.5877 (0.7158) ce_loss 0.2874 (0.3711) teacher_loss 0.2504 (0.3599) loss_zs_kd 0.1128 (0.0969) loss_oracle 0.2809 (0.3074) acc 93.7500 (86.7188) kd_loss 0.9578 (0.9962) lr 5.7422e-04 eta 0:05:33
epoch [34/50] batch [160/176] time 0.100 (0.117) data 0.000 (0.002) loss 0.7977 (0.7150) ce_loss 0.4690 (0.3734) teacher_loss 0.4501 (0.3621) loss_zs_kd 0.0658 (0.0971) loss_oracle 0.3147 (0.3044) acc 78.1250 (86.5234) kd_loss 1.0383 (0.9952) lr 5.7422e-04 eta 0:05:30
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,187
* accuracy: 90.3%
* error: 9.7%
* macro_f1: 92.2%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,711
* accuracy: 64.4%
* error: 35.6%
* macro_f1: 59.1%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [35/50] batch [20/176] time 0.086 (0.127) data 0.001 (0.017) loss 0.8208 (0.6726) ce_loss 0.5186 (0.3488) teacher_loss 0.5175 (0.3373) loss_zs_kd 0.1062 (0.0984) loss_oracle 0.2502 (0.2862) acc 78.1250 (87.9688) kd_loss 0.9024 (1.0002) lr 5.1825e-04 eta 0:05:54
epoch [35/50] batch [40/176] time 0.078 (0.134) data 0.000 (0.009) loss 0.6963 (0.6921) ce_loss 0.3792 (0.3624) teacher_loss 0.3413 (0.3478) loss_zs_kd 0.0732 (0.0979) loss_oracle 0.3185 (0.2953) acc 87.5000 (88.0469) kd_loss 1.0094 (1.0007) lr 5.1825e-04 eta 0:06:10
epoch [35/50] batch [60/176] time 0.136 (0.126) data 0.002 (0.006) loss 0.5218 (0.6899) ce_loss 0.1453 (0.3533) teacher_loss 0.1697 (0.3393) loss_zs_kd 0.0992 (0.0985) loss_oracle 0.3025 (0.3014) acc 100.0000 (88.8542) kd_loss 1.0222 (1.0020) lr 5.1825e-04 eta 0:05:47
epoch [35/50] batch [80/176] time 0.138 (0.123) data 0.000 (0.004) loss 0.7163 (0.6875) ce_loss 0.3938 (0.3531) teacher_loss 0.3940 (0.3391) loss_zs_kd 0.1187 (0.0983) loss_oracle 0.2630 (0.2992) acc 96.8750 (88.5156) kd_loss 0.9424 (0.9979) lr 5.1825e-04 eta 0:05:37
epoch [35/50] batch [100/176] time 0.132 (0.122) data 0.000 (0.004) loss 0.5524 (0.6890) ce_loss 0.2480 (0.3549) teacher_loss 0.2279 (0.3412) loss_zs_kd 0.0560 (0.1002) loss_oracle 0.2965 (0.2976) acc 84.3750 (88.0000) kd_loss 0.9548 (0.9992) lr 5.1825e-04 eta 0:05:30
epoch [35/50] batch [120/176] time 0.134 (0.120) data 0.000 (0.003) loss 0.7396 (0.6907) ce_loss 0.3862 (0.3582) teacher_loss 0.3656 (0.3435) loss_zs_kd 0.0934 (0.0995) loss_oracle 0.3273 (0.2974) acc 87.5000 (87.7604) kd_loss 0.9981 (1.0000) lr 5.1825e-04 eta 0:05:24
epoch [35/50] batch [140/176] time 0.093 (0.120) data 0.000 (0.003) loss 0.7340 (0.7009) ce_loss 0.3896 (0.3694) teacher_loss 0.3962 (0.3548) loss_zs_kd 0.1114 (0.0996) loss_oracle 0.2821 (0.2963) acc 87.5000 (87.4107) kd_loss 0.9993 (0.9995) lr 5.1825e-04 eta 0:05:21
epoch [35/50] batch [160/176] time 0.094 (0.119) data 0.000 (0.002) loss 0.8271 (0.7076) ce_loss 0.4780 (0.3751) teacher_loss 0.4780 (0.3612) loss_zs_kd 0.1192 (0.0998) loss_oracle 0.2895 (0.2966) acc 78.1250 (87.2070) kd_loss 1.0271 (0.9989) lr 5.1825e-04 eta 0:05:16
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,183
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,691
* accuracy: 63.7%
* error: 36.3%
* macro_f1: 59.0%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [36/50] batch [20/176] time 0.135 (0.140) data 0.000 (0.014) loss 0.7171 (0.7001) ce_loss 0.3579 (0.3701) teacher_loss 0.3128 (0.3542) loss_zs_kd 0.1111 (0.1094) loss_oracle 0.3487 (0.2912) acc 90.6250 (87.6562) kd_loss 0.9742 (0.9830) lr 4.6417e-04 eta 0:06:05
epoch [36/50] batch [40/176] time 0.144 (0.128) data 0.000 (0.007) loss 0.5974 (0.6888) ce_loss 0.2781 (0.3587) teacher_loss 0.2561 (0.3475) loss_zs_kd 0.0827 (0.0999) loss_oracle 0.2999 (0.2913) acc 90.6250 (88.1250) kd_loss 0.9889 (0.9863) lr 4.6417e-04 eta 0:05:32
epoch [36/50] batch [60/176] time 0.126 (0.125) data 0.001 (0.005) loss 0.7513 (0.6922) ce_loss 0.4856 (0.3664) teacher_loss 0.4994 (0.3564) loss_zs_kd 0.1095 (0.0982) loss_oracle 0.1972 (0.2867) acc 87.5000 (88.1250) kd_loss 0.8777 (0.9882) lr 4.6417e-04 eta 0:05:23
epoch [36/50] batch [80/176] time 0.085 (0.122) data 0.000 (0.004) loss 1.0039 (0.7012) ce_loss 0.7051 (0.3754) teacher_loss 0.6415 (0.3640) loss_zs_kd 0.0841 (0.0992) loss_oracle 0.3204 (0.2876) acc 81.2500 (87.5000) kd_loss 1.0135 (0.9916) lr 4.6417e-04 eta 0:05:11
epoch [36/50] batch [100/176] time 0.138 (0.120) data 0.000 (0.003) loss 0.6775 (0.6927) ce_loss 0.2991 (0.3672) teacher_loss 0.2942 (0.3552) loss_zs_kd 0.0935 (0.0982) loss_oracle 0.3365 (0.2885) acc 87.5000 (87.6562) kd_loss 1.0292 (0.9929) lr 4.6417e-04 eta 0:05:04
epoch [36/50] batch [120/176] time 0.091 (0.117) data 0.000 (0.003) loss 0.6245 (0.6911) ce_loss 0.3152 (0.3676) teacher_loss 0.3110 (0.3550) loss_zs_kd 0.0652 (0.0981) loss_oracle 0.2809 (0.2870) acc 84.3750 (87.6562) kd_loss 1.0107 (0.9946) lr 4.6417e-04 eta 0:04:55
epoch [36/50] batch [140/176] time 0.078 (0.114) data 0.000 (0.002) loss 0.7460 (0.6861) ce_loss 0.4561 (0.3629) teacher_loss 0.4441 (0.3489) loss_zs_kd 0.0876 (0.0981) loss_oracle 0.2581 (0.2881) acc 84.3750 (87.8571) kd_loss 0.9003 (0.9934) lr 4.6417e-04 eta 0:04:44
epoch [36/50] batch [160/176] time 0.095 (0.112) data 0.000 (0.002) loss 0.6482 (0.6879) ce_loss 0.3022 (0.3642) teacher_loss 0.2953 (0.3507) loss_zs_kd 0.0648 (0.0973) loss_oracle 0.3206 (0.2885) acc 90.6250 (87.6758) kd_loss 1.0199 (0.9937) lr 4.6417e-04 eta 0:04:38
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,184
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,703
* accuracy: 64.1%
* error: 35.9%
* macro_f1: 58.9%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [37/50] batch [20/176] time 0.081 (0.123) data 0.000 (0.015) loss 0.7560 (0.6801) ce_loss 0.3770 (0.3415) teacher_loss 0.3735 (0.3300) loss_zs_kd 0.1331 (0.1012) loss_oracle 0.3160 (0.2996) acc 87.5000 (88.4375) kd_loss 1.0342 (0.9927) lr 4.1221e-04 eta 0:04:59
epoch [37/50] batch [40/176] time 0.144 (0.131) data 0.000 (0.008) loss 0.7075 (0.6920) ce_loss 0.3818 (0.3569) teacher_loss 0.3818 (0.3421) loss_zs_kd 0.1157 (0.0965) loss_oracle 0.2679 (0.3016) acc 84.3750 (87.8125) kd_loss 0.8930 (0.9900) lr 4.1221e-04 eta 0:05:18
epoch [37/50] batch [60/176] time 0.132 (0.130) data 0.000 (0.005) loss 0.6083 (0.6974) ce_loss 0.2484 (0.3636) teacher_loss 0.2089 (0.3482) loss_zs_kd 0.0806 (0.0948) loss_oracle 0.3592 (0.3018) acc 93.7500 (87.7604) kd_loss 1.0437 (0.9880) lr 4.1221e-04 eta 0:05:11
epoch [37/50] batch [80/176] time 0.092 (0.127) data 0.000 (0.004) loss 0.6649 (0.7016) ce_loss 0.3098 (0.3691) teacher_loss 0.3200 (0.3533) loss_zs_kd 0.0931 (0.0973) loss_oracle 0.2983 (0.2996) acc 87.5000 (87.2266) kd_loss 0.9646 (0.9887) lr 4.1221e-04 eta 0:05:02
epoch [37/50] batch [100/176] time 0.116 (0.122) data 0.000 (0.003) loss 0.8267 (0.7062) ce_loss 0.5288 (0.3757) teacher_loss 0.4719 (0.3605) loss_zs_kd 0.0999 (0.0951) loss_oracle 0.3048 (0.2980) acc 78.1250 (86.8750) kd_loss 0.9800 (0.9925) lr 4.1221e-04 eta 0:04:47
epoch [37/50] batch [120/176] time 0.115 (0.118) data 0.000 (0.003) loss 0.6057 (0.7076) ce_loss 0.3054 (0.3786) teacher_loss 0.2966 (0.3622) loss_zs_kd 0.0871 (0.0956) loss_oracle 0.2655 (0.2976) acc 90.6250 (86.7969) kd_loss 1.0209 (0.9921) lr 4.1221e-04 eta 0:04:35
epoch [37/50] batch [140/176] time 0.101 (0.114) data 0.000 (0.002) loss 0.6256 (0.7119) ce_loss 0.3303 (0.3827) teacher_loss 0.3044 (0.3666) loss_zs_kd 0.1219 (0.0972) loss_oracle 0.2602 (0.2967) acc 84.3750 (86.4062) kd_loss 0.9977 (0.9923) lr 4.1221e-04 eta 0:04:25
epoch [37/50] batch [160/176] time 0.095 (0.112) data 0.000 (0.002) loss 0.5632 (0.7065) ce_loss 0.2705 (0.3793) teacher_loss 0.2203 (0.3636) loss_zs_kd 0.0931 (0.0963) loss_oracle 0.2964 (0.2948) acc 90.6250 (86.6992) kd_loss 0.9603 (0.9913) lr 4.1221e-04 eta 0:04:17
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,185
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,708
* accuracy: 64.3%
* error: 35.7%
* macro_f1: 59.0%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [38/50] batch [20/176] time 0.127 (0.124) data 0.001 (0.014) loss 0.7783 (0.7339) ce_loss 0.4548 (0.3879) teacher_loss 0.4647 (0.3764) loss_zs_kd 0.1221 (0.1151) loss_oracle 0.2525 (0.3000) acc 81.2500 (87.0312) kd_loss 0.9919 (0.9845) lr 3.6258e-04 eta 0:04:42
epoch [38/50] batch [40/176] time 0.081 (0.112) data 0.000 (0.007) loss 0.5785 (0.7268) ce_loss 0.3064 (0.3887) teacher_loss 0.2463 (0.3791) loss_zs_kd 0.0745 (0.1066) loss_oracle 0.2950 (0.2945) acc 90.6250 (86.8750) kd_loss 1.0042 (0.9866) lr 3.6258e-04 eta 0:04:10
epoch [38/50] batch [60/176] time 0.083 (0.108) data 0.000 (0.005) loss 0.8024 (0.6954) ce_loss 0.4812 (0.3612) teacher_loss 0.4254 (0.3497) loss_zs_kd 0.1070 (0.1008) loss_oracle 0.3236 (0.2953) acc 75.0000 (87.8125) kd_loss 1.0291 (0.9917) lr 3.6258e-04 eta 0:04:01
epoch [38/50] batch [80/176] time 0.112 (0.105) data 0.000 (0.004) loss 0.6588 (0.6944) ce_loss 0.3062 (0.3623) teacher_loss 0.3100 (0.3509) loss_zs_kd 0.1002 (0.0997) loss_oracle 0.2986 (0.2937) acc 84.3750 (87.7734) kd_loss 1.0484 (0.9914) lr 3.6258e-04 eta 0:03:52
epoch [38/50] batch [100/176] time 0.133 (0.104) data 0.000 (0.003) loss 0.8821 (0.6991) ce_loss 0.5791 (0.3696) teacher_loss 0.5680 (0.3578) loss_zs_kd 0.0943 (0.0991) loss_oracle 0.2670 (0.2917) acc 81.2500 (87.3438) kd_loss 0.9809 (0.9918) lr 3.6258e-04 eta 0:03:47
epoch [38/50] batch [120/176] time 0.087 (0.102) data 0.000 (0.003) loss 0.8617 (0.6918) ce_loss 0.5435 (0.3619) teacher_loss 0.5325 (0.3503) loss_zs_kd 0.0954 (0.0976) loss_oracle 0.2815 (0.2927) acc 84.3750 (87.8646) kd_loss 1.0207 (0.9934) lr 3.6258e-04 eta 0:03:41
epoch [38/50] batch [140/176] time 0.134 (0.102) data 0.000 (0.002) loss 0.7663 (0.6916) ce_loss 0.4490 (0.3623) teacher_loss 0.4245 (0.3504) loss_zs_kd 0.0975 (0.0973) loss_oracle 0.2930 (0.2925) acc 87.5000 (87.8571) kd_loss 0.9804 (0.9934) lr 3.6258e-04 eta 0:03:39
epoch [38/50] batch [160/176] time 0.099 (0.102) data 0.000 (0.002) loss 0.7222 (0.6936) ce_loss 0.4937 (0.3659) teacher_loss 0.4414 (0.3535) loss_zs_kd 0.1174 (0.0968) loss_oracle 0.2221 (0.2916) acc 78.1250 (87.7539) kd_loss 1.0252 (0.9932) lr 3.6258e-04 eta 0:03:36
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,186
* accuracy: 90.3%
* error: 9.7%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,716
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 59.4%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [39/50] batch [20/176] time 0.088 (0.136) data 0.000 (0.015) loss 0.6589 (0.6665) ce_loss 0.4165 (0.3453) teacher_loss 0.3675 (0.3282) loss_zs_kd 0.1087 (0.0996) loss_oracle 0.2371 (0.2885) acc 87.5000 (88.1250) kd_loss 0.9975 (0.9926) lr 3.1545e-04 eta 0:04:45
epoch [39/50] batch [40/176] time 0.129 (0.127) data 0.000 (0.008) loss 0.4824 (0.6730) ce_loss 0.1903 (0.3581) teacher_loss 0.1671 (0.3377) loss_zs_kd 0.0730 (0.0948) loss_oracle 0.2788 (0.2879) acc 96.8750 (87.2656) kd_loss 0.9717 (0.9980) lr 3.1545e-04 eta 0:04:23
epoch [39/50] batch [60/176] time 0.097 (0.123) data 0.001 (0.005) loss 0.6900 (0.6736) ce_loss 0.3398 (0.3554) teacher_loss 0.3409 (0.3358) loss_zs_kd 0.0871 (0.0981) loss_oracle 0.3056 (0.2887) acc 87.5000 (87.7083) kd_loss 0.9612 (1.0035) lr 3.1545e-04 eta 0:04:13
epoch [39/50] batch [80/176] time 0.115 (0.120) data 0.000 (0.004) loss 0.6155 (0.6913) ce_loss 0.2181 (0.3719) teacher_loss 0.2047 (0.3528) loss_zs_kd 0.1076 (0.0986) loss_oracle 0.3570 (0.2892) acc 90.6250 (86.9531) kd_loss 1.0484 (1.0034) lr 3.1545e-04 eta 0:04:02
epoch [39/50] batch [100/176] time 0.149 (0.115) data 0.000 (0.003) loss 0.5128 (0.6910) ce_loss 0.2286 (0.3711) teacher_loss 0.1908 (0.3522) loss_zs_kd 0.0713 (0.0999) loss_oracle 0.2863 (0.2888) acc 90.6250 (87.0938) kd_loss 1.0641 (1.0044) lr 3.1545e-04 eta 0:03:51
epoch [39/50] batch [120/176] time 0.159 (0.121) data 0.000 (0.003) loss 0.7588 (0.6910) ce_loss 0.4021 (0.3686) teacher_loss 0.3820 (0.3501) loss_zs_kd 0.1181 (0.1010) loss_oracle 0.3177 (0.2904) acc 87.5000 (87.2135) kd_loss 0.9435 (1.0037) lr 3.1545e-04 eta 0:04:00
epoch [39/50] batch [140/176] time 0.128 (0.122) data 0.000 (0.002) loss 0.8546 (0.6934) ce_loss 0.5059 (0.3710) teacher_loss 0.4672 (0.3521) loss_zs_kd 0.1230 (0.1009) loss_oracle 0.3259 (0.2909) acc 84.3750 (87.2545) kd_loss 0.9900 (1.0022) lr 3.1545e-04 eta 0:03:59
epoch [39/50] batch [160/176] time 0.082 (0.119) data 0.001 (0.002) loss 0.6856 (0.6949) ce_loss 0.3818 (0.3728) teacher_loss 0.3513 (0.3539) loss_zs_kd 0.1028 (0.1016) loss_oracle 0.2829 (0.2902) acc 84.3750 (87.0508) kd_loss 0.9324 (1.0007) lr 3.1545e-04 eta 0:03:51
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,185
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,713
* accuracy: 64.5%
* error: 35.5%
* macro_f1: 59.4%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [40/50] batch [20/176] time 0.091 (0.117) data 0.000 (0.013) loss 0.5212 (0.6743) ce_loss 0.2075 (0.3520) teacher_loss 0.2194 (0.3319) loss_zs_kd 0.0708 (0.1038) loss_oracle 0.2664 (0.2905) acc 93.7500 (87.1875) kd_loss 1.0041 (0.9875) lr 2.7103e-04 eta 0:03:43
epoch [40/50] batch [40/176] time 0.107 (0.109) data 0.000 (0.007) loss 0.7895 (0.7071) ce_loss 0.4626 (0.3852) teacher_loss 0.4614 (0.3661) loss_zs_kd 0.0833 (0.1028) loss_oracle 0.2864 (0.2896) acc 75.0000 (85.9375) kd_loss 0.9833 (0.9919) lr 2.7103e-04 eta 0:03:26
epoch [40/50] batch [60/176] time 0.088 (0.104) data 0.000 (0.004) loss 0.7568 (0.7216) ce_loss 0.4531 (0.3986) teacher_loss 0.4147 (0.3821) loss_zs_kd 0.1060 (0.1025) loss_oracle 0.2891 (0.2882) acc 87.5000 (85.9375) kd_loss 1.0339 (0.9921) lr 2.7103e-04 eta 0:03:15
epoch [40/50] batch [80/176] time 0.079 (0.101) data 0.000 (0.003) loss 0.5481 (0.7156) ce_loss 0.2323 (0.3934) teacher_loss 0.2301 (0.3782) loss_zs_kd 0.0719 (0.1028) loss_oracle 0.2820 (0.2860) acc 93.7500 (85.9375) kd_loss 0.9835 (0.9900) lr 2.7103e-04 eta 0:03:07
epoch [40/50] batch [100/176] time 0.116 (0.100) data 0.000 (0.003) loss 0.6296 (0.7028) ce_loss 0.2588 (0.3787) teacher_loss 0.2457 (0.3645) loss_zs_kd 0.0971 (0.1007) loss_oracle 0.3354 (0.2880) acc 87.5000 (86.6875) kd_loss 1.0241 (0.9926) lr 2.7103e-04 eta 0:03:03
epoch [40/50] batch [120/176] time 0.090 (0.098) data 0.000 (0.002) loss 0.6849 (0.6941) ce_loss 0.3120 (0.3702) teacher_loss 0.3186 (0.3565) loss_zs_kd 0.0722 (0.0985) loss_oracle 0.3302 (0.2883) acc 87.5000 (86.9010) kd_loss 1.0070 (0.9944) lr 2.7103e-04 eta 0:02:57
epoch [40/50] batch [140/176] time 0.088 (0.096) data 0.000 (0.002) loss 0.6697 (0.6939) ce_loss 0.3423 (0.3690) teacher_loss 0.3247 (0.3545) loss_zs_kd 0.0910 (0.0982) loss_oracle 0.2994 (0.2903) acc 87.5000 (87.1205) kd_loss 0.9601 (0.9948) lr 2.7103e-04 eta 0:02:52
epoch [40/50] batch [160/176] time 0.077 (0.095) data 0.000 (0.002) loss 0.5834 (0.6972) ce_loss 0.3181 (0.3716) teacher_loss 0.2539 (0.3574) loss_zs_kd 0.0887 (0.0976) loss_oracle 0.2851 (0.2910) acc 93.7500 (87.0703) kd_loss 1.0030 (0.9936) lr 2.7103e-04 eta 0:02:49
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,185
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,708
* accuracy: 64.3%
* error: 35.7%
* macro_f1: 59.3%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [41/50] batch [20/176] time 0.107 (0.122) data 0.000 (0.014) loss 0.9139 (0.7098) ce_loss 0.5640 (0.3732) teacher_loss 0.5749 (0.3617) loss_zs_kd 0.1096 (0.0849) loss_oracle 0.2842 (0.3057) acc 78.1250 (87.6562) kd_loss 0.9670 (0.9912) lr 2.2949e-04 eta 0:03:31
epoch [41/50] batch [40/176] time 0.094 (0.107) data 0.000 (0.007) loss 0.8086 (0.6927) ce_loss 0.4951 (0.3577) teacher_loss 0.4632 (0.3436) loss_zs_kd 0.0893 (0.0935) loss_oracle 0.3007 (0.3023) acc 75.0000 (87.6562) kd_loss 1.0549 (0.9989) lr 2.2949e-04 eta 0:03:03
epoch [41/50] batch [60/176] time 0.089 (0.100) data 0.000 (0.005) loss 0.7099 (0.6934) ce_loss 0.3672 (0.3593) teacher_loss 0.3903 (0.3456) loss_zs_kd 0.1139 (0.0957) loss_oracle 0.2626 (0.2999) acc 90.6250 (87.3958) kd_loss 0.9526 (0.9975) lr 2.2949e-04 eta 0:02:49
epoch [41/50] batch [80/176] time 0.091 (0.097) data 0.000 (0.004) loss 0.6209 (0.6907) ce_loss 0.3362 (0.3603) teacher_loss 0.3149 (0.3443) loss_zs_kd 0.0614 (0.0942) loss_oracle 0.2753 (0.2994) acc 87.5000 (87.6562) kd_loss 0.9862 (0.9986) lr 2.2949e-04 eta 0:02:42
epoch [41/50] batch [100/176] time 0.096 (0.095) data 0.000 (0.003) loss 0.6383 (0.6880) ce_loss 0.2927 (0.3560) teacher_loss 0.2841 (0.3403) loss_zs_kd 0.0805 (0.0941) loss_oracle 0.3140 (0.3007) acc 90.6250 (87.8438) kd_loss 0.9686 (0.9974) lr 2.2949e-04 eta 0:02:37
epoch [41/50] batch [120/176] time 0.098 (0.094) data 0.000 (0.003) loss 0.6637 (0.6919) ce_loss 0.3318 (0.3600) teacher_loss 0.3105 (0.3434) loss_zs_kd 0.1064 (0.0952) loss_oracle 0.3000 (0.3009) acc 87.5000 (87.3958) kd_loss 0.9914 (0.9960) lr 2.2949e-04 eta 0:02:33
epoch [41/50] batch [140/176] time 0.087 (0.093) data 0.000 (0.002) loss 0.6441 (0.6938) ce_loss 0.3025 (0.3627) teacher_loss 0.2987 (0.3455) loss_zs_kd 0.1321 (0.0959) loss_oracle 0.2794 (0.3003) acc 93.7500 (87.2545) kd_loss 0.9450 (0.9964) lr 2.2949e-04 eta 0:02:30
epoch [41/50] batch [160/176] time 0.085 (0.093) data 0.000 (0.002) loss 0.7531 (0.6991) ce_loss 0.4380 (0.3686) teacher_loss 0.4220 (0.3514) loss_zs_kd 0.0895 (0.0952) loss_oracle 0.2864 (0.3001) acc 84.3750 (87.0703) kd_loss 1.0304 (0.9961) lr 2.2949e-04 eta 0:02:28
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,185
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,709
* accuracy: 64.3%
* error: 35.7%
* macro_f1: 59.2%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [42/50] batch [20/176] time 0.138 (0.114) data 0.000 (0.015) loss 0.7261 (0.6777) ce_loss 0.4104 (0.3527) teacher_loss 0.3777 (0.3323) loss_zs_kd 0.1078 (0.1021) loss_oracle 0.2945 (0.2944) acc 87.5000 (88.9062) kd_loss 0.9810 (0.9967) lr 1.9098e-04 eta 0:02:58
epoch [42/50] batch [40/176] time 0.151 (0.128) data 0.000 (0.008) loss 0.4598 (0.6715) ce_loss 0.2159 (0.3429) teacher_loss 0.1904 (0.3256) loss_zs_kd 0.0856 (0.0995) loss_oracle 0.2266 (0.2961) acc 96.8750 (89.2188) kd_loss 0.9359 (0.9958) lr 1.9098e-04 eta 0:03:17
epoch [42/50] batch [60/176] time 0.177 (0.124) data 0.001 (0.005) loss 0.7762 (0.6859) ce_loss 0.4280 (0.3592) teacher_loss 0.3820 (0.3393) loss_zs_kd 0.0738 (0.0984) loss_oracle 0.3573 (0.2973) acc 84.3750 (87.9167) kd_loss 1.0346 (0.9987) lr 1.9098e-04 eta 0:03:08
epoch [42/50] batch [80/176] time 0.092 (0.118) data 0.000 (0.004) loss 0.5343 (0.6832) ce_loss 0.1857 (0.3542) teacher_loss 0.1750 (0.3369) loss_zs_kd 0.1054 (0.0981) loss_oracle 0.3066 (0.2972) acc 96.8750 (88.2812) kd_loss 1.0284 (1.0005) lr 1.9098e-04 eta 0:02:57
epoch [42/50] batch [100/176] time 0.087 (0.112) data 0.000 (0.003) loss 0.8685 (0.6862) ce_loss 0.5591 (0.3617) teacher_loss 0.5389 (0.3455) loss_zs_kd 0.0963 (0.0974) loss_oracle 0.2815 (0.2920) acc 71.8750 (88.0312) kd_loss 1.0245 (0.9959) lr 1.9098e-04 eta 0:02:45
epoch [42/50] batch [120/176] time 0.076 (0.109) data 0.000 (0.003) loss 0.7676 (0.6882) ce_loss 0.4802 (0.3614) teacher_loss 0.4637 (0.3458) loss_zs_kd 0.1056 (0.0985) loss_oracle 0.2510 (0.2931) acc 87.5000 (87.9688) kd_loss 0.9522 (0.9967) lr 1.9098e-04 eta 0:02:39
epoch [42/50] batch [140/176] time 0.121 (0.108) data 0.000 (0.002) loss 0.8164 (0.6958) ce_loss 0.4194 (0.3688) teacher_loss 0.3846 (0.3537) loss_zs_kd 0.1372 (0.0977) loss_oracle 0.3633 (0.2933) acc 84.3750 (87.7902) kd_loss 1.0216 (0.9971) lr 1.9098e-04 eta 0:02:35
epoch [42/50] batch [160/176] time 0.110 (0.107) data 0.000 (0.002) loss 0.6682 (0.6943) ce_loss 0.3008 (0.3663) teacher_loss 0.2919 (0.3517) loss_zs_kd 0.1493 (0.0976) loss_oracle 0.3017 (0.2937) acc 87.5000 (87.9688) kd_loss 0.9768 (0.9978) lr 1.9098e-04 eta 0:02:32
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,182
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,707
* accuracy: 64.3%
* error: 35.7%
* macro_f1: 59.2%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [43/50] batch [20/176] time 0.103 (0.121) data 0.000 (0.015) loss 0.5730 (0.6956) ce_loss 0.3081 (0.3683) teacher_loss 0.2702 (0.3482) loss_zs_kd 0.0834 (0.1063) loss_oracle 0.2611 (0.2942) acc 90.6250 (85.7812) kd_loss 0.9663 (0.9909) lr 1.5567e-04 eta 0:02:47
epoch [43/50] batch [40/176] time 0.085 (0.116) data 0.000 (0.007) loss 0.6174 (0.6777) ce_loss 0.2761 (0.3523) teacher_loss 0.3078 (0.3338) loss_zs_kd 0.0900 (0.1008) loss_oracle 0.2646 (0.2935) acc 90.6250 (87.0312) kd_loss 1.0172 (0.9968) lr 1.5567e-04 eta 0:02:39
epoch [43/50] batch [60/176] time 0.113 (0.113) data 0.001 (0.005) loss 0.7482 (0.6863) ce_loss 0.4524 (0.3608) teacher_loss 0.4280 (0.3450) loss_zs_kd 0.0779 (0.0982) loss_oracle 0.2813 (0.2922) acc 81.2500 (87.0833) kd_loss 1.0036 (0.9962) lr 1.5567e-04 eta 0:02:32
epoch [43/50] batch [80/176] time 0.091 (0.109) data 0.000 (0.004) loss 0.5890 (0.6815) ce_loss 0.2290 (0.3533) teacher_loss 0.2259 (0.3375) loss_zs_kd 0.0910 (0.0973) loss_oracle 0.3176 (0.2954) acc 93.7500 (87.4219) kd_loss 0.9873 (0.9963) lr 1.5567e-04 eta 0:02:25
epoch [43/50] batch [100/176] time 0.110 (0.108) data 0.000 (0.003) loss 0.6465 (0.6848) ce_loss 0.2783 (0.3543) teacher_loss 0.2833 (0.3396) loss_zs_kd 0.1384 (0.0988) loss_oracle 0.2940 (0.2957) acc 93.7500 (87.4688) kd_loss 0.9819 (0.9969) lr 1.5567e-04 eta 0:02:21
epoch [43/50] batch [120/176] time 0.088 (0.107) data 0.000 (0.003) loss 0.6184 (0.6902) ce_loss 0.3086 (0.3609) teacher_loss 0.2668 (0.3451) loss_zs_kd 0.1062 (0.0980) loss_oracle 0.2985 (0.2961) acc 90.6250 (87.2917) kd_loss 1.0212 (0.9992) lr 1.5567e-04 eta 0:02:18
epoch [43/50] batch [140/176] time 0.089 (0.105) data 0.000 (0.002) loss 0.8903 (0.6929) ce_loss 0.5918 (0.3635) teacher_loss 0.5817 (0.3473) loss_zs_kd 0.1113 (0.0977) loss_oracle 0.2530 (0.2967) acc 84.3750 (87.2098) kd_loss 0.9381 (0.9986) lr 1.5567e-04 eta 0:02:13
epoch [43/50] batch [160/176] time 0.143 (0.106) data 0.000 (0.002) loss 0.7333 (0.7006) ce_loss 0.3931 (0.3713) teacher_loss 0.3705 (0.3560) loss_zs_kd 0.1514 (0.0986) loss_oracle 0.2870 (0.2953) acc 90.6250 (86.9727) kd_loss 1.0080 (0.9965) lr 1.5567e-04 eta 0:02:11
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,186
* accuracy: 90.3%
* error: 9.7%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,708
* accuracy: 64.3%
* error: 35.7%
* macro_f1: 59.4%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [44/50] batch [20/176] time 0.139 (0.130) data 0.000 (0.016) loss 0.6547 (0.6688) ce_loss 0.3425 (0.3440) teacher_loss 0.3304 (0.3316) loss_zs_kd 0.0922 (0.0992) loss_oracle 0.2782 (0.2876) acc 84.3750 (88.2812) kd_loss 1.0365 (0.9990) lr 1.2369e-04 eta 0:02:37
epoch [44/50] batch [40/176] time 0.112 (0.119) data 0.000 (0.008) loss 0.7198 (0.6974) ce_loss 0.4160 (0.3630) teacher_loss 0.4039 (0.3519) loss_zs_kd 0.1101 (0.0983) loss_oracle 0.2609 (0.2964) acc 87.5000 (86.6406) kd_loss 0.9993 (0.9996) lr 1.2369e-04 eta 0:02:21
epoch [44/50] batch [60/176] time 0.099 (0.114) data 0.001 (0.006) loss 0.6002 (0.6918) ce_loss 0.2800 (0.3569) teacher_loss 0.2854 (0.3444) loss_zs_kd 0.0486 (0.0967) loss_oracle 0.2906 (0.2991) acc 87.5000 (87.1354) kd_loss 1.0217 (1.0049) lr 1.2369e-04 eta 0:02:13
epoch [44/50] batch [80/176] time 0.139 (0.115) data 0.000 (0.004) loss 0.7185 (0.6949) ce_loss 0.4346 (0.3611) teacher_loss 0.4127 (0.3470) loss_zs_kd 0.0921 (0.0976) loss_oracle 0.2597 (0.2992) acc 81.2500 (87.5391) kd_loss 0.9650 (1.0006) lr 1.2369e-04 eta 0:02:12
epoch [44/50] batch [100/176] time 0.175 (0.119) data 0.000 (0.003) loss 0.5673 (0.6985) ce_loss 0.2350 (0.3655) teacher_loss 0.2249 (0.3514) loss_zs_kd 0.1070 (0.0979) loss_oracle 0.2890 (0.2982) acc 93.7500 (87.3125) kd_loss 0.9003 (0.9989) lr 1.2369e-04 eta 0:02:14
epoch [44/50] batch [120/176] time 0.072 (0.120) data 0.000 (0.003) loss 0.6986 (0.7028) ce_loss 0.3389 (0.3694) teacher_loss 0.3286 (0.3555) loss_zs_kd 0.1096 (0.0973) loss_oracle 0.3152 (0.2986) acc 84.3750 (87.1094) kd_loss 1.0228 (1.0020) lr 1.2369e-04 eta 0:02:13
epoch [44/50] batch [140/176] time 0.077 (0.123) data 0.000 (0.003) loss 0.5648 (0.7070) ce_loss 0.2427 (0.3731) teacher_loss 0.2472 (0.3583) loss_zs_kd 0.0678 (0.0966) loss_oracle 0.2837 (0.3004) acc 93.7500 (86.9420) kd_loss 0.9757 (0.9994) lr 1.2369e-04 eta 0:02:13
epoch [44/50] batch [160/176] time 0.136 (0.122) data 0.000 (0.002) loss 0.6015 (0.7065) ce_loss 0.2397 (0.3722) teacher_loss 0.2218 (0.3575) loss_zs_kd 0.1901 (0.0972) loss_oracle 0.2847 (0.3004) acc 93.7500 (87.1094) kd_loss 1.0100 (0.9988) lr 1.2369e-04 eta 0:02:10
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,183
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.0%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,716
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 59.3%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [45/50] batch [20/176] time 0.135 (0.130) data 0.000 (0.014) loss 0.8266 (0.7249) ce_loss 0.5205 (0.3963) teacher_loss 0.4973 (0.3819) loss_zs_kd 0.1010 (0.0936) loss_oracle 0.2788 (0.2961) acc 78.1250 (84.8438) kd_loss 0.9739 (1.0053) lr 9.5173e-05 eta 0:02:15
epoch [45/50] batch [40/176] time 0.081 (0.118) data 0.000 (0.007) loss 0.6364 (0.7024) ce_loss 0.3088 (0.3735) teacher_loss 0.2874 (0.3612) loss_zs_kd 0.0961 (0.0918) loss_oracle 0.3009 (0.2953) acc 90.6250 (86.5625) kd_loss 0.9584 (0.9982) lr 9.5173e-05 eta 0:02:00
epoch [45/50] batch [60/176] time 0.129 (0.111) data 0.001 (0.005) loss 0.7663 (0.7031) ce_loss 0.3674 (0.3713) teacher_loss 0.3575 (0.3605) loss_zs_kd 0.1155 (0.0929) loss_oracle 0.3511 (0.2961) acc 90.6250 (87.2917) kd_loss 1.0303 (0.9993) lr 9.5173e-05 eta 0:01:50
epoch [45/50] batch [80/176] time 0.095 (0.109) data 0.001 (0.004) loss 0.7679 (0.7204) ce_loss 0.4863 (0.3859) teacher_loss 0.4580 (0.3742) loss_zs_kd 0.1011 (0.0981) loss_oracle 0.2594 (0.2972) acc 87.5000 (86.5234) kd_loss 0.9577 (0.9983) lr 9.5173e-05 eta 0:01:46
epoch [45/50] batch [100/176] time 0.112 (0.109) data 0.000 (0.003) loss 0.7650 (0.7117) ce_loss 0.3862 (0.3787) teacher_loss 0.4264 (0.3671) loss_zs_kd 0.0791 (0.0968) loss_oracle 0.2991 (0.2962) acc 87.5000 (86.6875) kd_loss 0.9950 (0.9991) lr 9.5173e-05 eta 0:01:44
epoch [45/50] batch [120/176] time 0.093 (0.109) data 0.000 (0.003) loss 0.5782 (0.7090) ce_loss 0.2830 (0.3765) teacher_loss 0.2759 (0.3651) loss_zs_kd 0.0795 (0.0970) loss_oracle 0.2626 (0.2954) acc 93.7500 (86.8750) kd_loss 0.9783 (0.9994) lr 9.5173e-05 eta 0:01:42
epoch [45/50] batch [140/176] time 0.100 (0.110) data 0.000 (0.002) loss 0.7732 (0.7060) ce_loss 0.4214 (0.3731) teacher_loss 0.4122 (0.3614) loss_zs_kd 0.0739 (0.0966) loss_oracle 0.3240 (0.2963) acc 84.3750 (86.9196) kd_loss 1.0227 (1.0002) lr 9.5173e-05 eta 0:01:40
epoch [45/50] batch [160/176] time 0.118 (0.111) data 0.000 (0.002) loss 1.1094 (0.7099) ce_loss 0.8179 (0.3767) teacher_loss 0.8676 (0.3654) loss_zs_kd 0.1011 (0.0961) loss_oracle 0.1913 (0.2965) acc 71.8750 (86.8164) kd_loss 0.9581 (0.9994) lr 9.5173e-05 eta 0:01:39
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,183
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,717
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 59.2%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [46/50] batch [20/176] time 0.105 (0.124) data 0.000 (0.013) loss 0.8681 (0.7173) ce_loss 0.4937 (0.3641) teacher_loss 0.4651 (0.3549) loss_zs_kd 0.1322 (0.1056) loss_oracle 0.3369 (0.3096) acc 84.3750 (87.3438) kd_loss 1.0290 (1.0113) lr 7.0224e-05 eta 0:01:46
epoch [46/50] batch [40/176] time 0.081 (0.120) data 0.000 (0.007) loss 0.7006 (0.7041) ce_loss 0.4045 (0.3627) teacher_loss 0.3868 (0.3539) loss_zs_kd 0.0754 (0.0990) loss_oracle 0.2761 (0.3007) acc 84.3750 (87.5781) kd_loss 0.9934 (0.9941) lr 7.0224e-05 eta 0:01:40
epoch [46/50] batch [60/176] time 0.133 (0.119) data 0.000 (0.005) loss 0.5570 (0.6930) ce_loss 0.2388 (0.3574) teacher_loss 0.2386 (0.3489) loss_zs_kd 0.0596 (0.0952) loss_oracle 0.2886 (0.2965) acc 93.7500 (87.9167) kd_loss 0.9420 (0.9957) lr 7.0224e-05 eta 0:01:37
epoch [46/50] batch [80/176] time 0.120 (0.118) data 0.000 (0.003) loss 0.6573 (0.6852) ce_loss 0.3137 (0.3516) teacher_loss 0.2826 (0.3431) loss_zs_kd 0.1196 (0.0947) loss_oracle 0.3149 (0.2947) acc 93.7500 (88.0859) kd_loss 1.0671 (0.9951) lr 7.0224e-05 eta 0:01:34
epoch [46/50] batch [100/176] time 0.079 (0.115) data 0.000 (0.003) loss 0.5477 (0.6754) ce_loss 0.2693 (0.3456) teacher_loss 0.2556 (0.3361) loss_zs_kd 0.0758 (0.0936) loss_oracle 0.2542 (0.2925) acc 87.5000 (88.3750) kd_loss 1.0025 (0.9964) lr 7.0224e-05 eta 0:01:29
epoch [46/50] batch [120/176] time 0.111 (0.113) data 0.000 (0.002) loss 0.6447 (0.6797) ce_loss 0.3298 (0.3518) teacher_loss 0.3058 (0.3405) loss_zs_kd 0.0950 (0.0923) loss_oracle 0.2914 (0.2930) acc 87.5000 (88.1510) kd_loss 0.9357 (0.9966) lr 7.0224e-05 eta 0:01:25
epoch [46/50] batch [140/176] time 0.163 (0.120) data 0.000 (0.002) loss 0.6512 (0.6783) ce_loss 0.3228 (0.3509) teacher_loss 0.3135 (0.3386) loss_zs_kd 0.0998 (0.0940) loss_oracle 0.2879 (0.2927) acc 90.6250 (88.2812) kd_loss 1.0467 (0.9950) lr 7.0224e-05 eta 0:01:28
epoch [46/50] batch [160/176] time 0.152 (0.119) data 0.001 (0.002) loss 0.6538 (0.6784) ce_loss 0.3921 (0.3522) teacher_loss 0.3308 (0.3393) loss_zs_kd 0.0981 (0.0947) loss_oracle 0.2740 (0.2918) acc 84.3750 (87.9102) kd_loss 1.0412 (0.9957) lr 7.0224e-05 eta 0:01:25
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,183
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,714
* accuracy: 64.5%
* error: 35.5%
* macro_f1: 59.3%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [47/50] batch [20/176] time 0.138 (0.108) data 0.000 (0.012) loss 0.6721 (0.7313) ce_loss 0.3289 (0.4116) teacher_loss 0.3291 (0.3940) loss_zs_kd 0.0945 (0.0941) loss_oracle 0.2958 (0.2902) acc 90.6250 (87.1875) kd_loss 1.0054 (0.9852) lr 4.8943e-05 eta 0:01:13
epoch [47/50] batch [40/176] time 0.085 (0.100) data 0.000 (0.006) loss 0.8442 (0.7270) ce_loss 0.4314 (0.4036) teacher_loss 0.4450 (0.3853) loss_zs_kd 0.1092 (0.0946) loss_oracle 0.3445 (0.2945) acc 84.3750 (85.9375) kd_loss 1.0651 (0.9923) lr 4.8943e-05 eta 0:01:06
epoch [47/50] batch [60/176] time 0.138 (0.098) data 0.001 (0.004) loss 0.6328 (0.7133) ce_loss 0.3101 (0.3876) teacher_loss 0.3166 (0.3705) loss_zs_kd 0.1045 (0.0948) loss_oracle 0.2640 (0.2955) acc 87.5000 (86.5104) kd_loss 0.9557 (0.9973) lr 4.8943e-05 eta 0:01:02
epoch [47/50] batch [80/176] time 0.099 (0.098) data 0.000 (0.003) loss 0.9429 (0.7168) ce_loss 0.6284 (0.3911) teacher_loss 0.6183 (0.3744) loss_zs_kd 0.0909 (0.0931) loss_oracle 0.2792 (0.2959) acc 78.1250 (86.2109) kd_loss 1.0379 (0.9989) lr 4.8943e-05 eta 0:01:01
epoch [47/50] batch [100/176] time 0.095 (0.097) data 0.000 (0.003) loss 0.6361 (0.7055) ce_loss 0.3296 (0.3769) teacher_loss 0.3333 (0.3619) loss_zs_kd 0.1078 (0.0947) loss_oracle 0.2488 (0.2963) acc 93.7500 (86.7188) kd_loss 0.9433 (0.9955) lr 4.8943e-05 eta 0:00:58
epoch [47/50] batch [120/176] time 0.092 (0.099) data 0.000 (0.002) loss 0.6941 (0.7034) ce_loss 0.3118 (0.3726) teacher_loss 0.2807 (0.3576) loss_zs_kd 0.1170 (0.0958) loss_oracle 0.3549 (0.2980) acc 87.5000 (87.0052) kd_loss 1.0142 (0.9941) lr 4.8943e-05 eta 0:00:57
epoch [47/50] batch [140/176] time 0.149 (0.099) data 0.001 (0.002) loss 0.5806 (0.7017) ce_loss 0.2006 (0.3687) teacher_loss 0.1870 (0.3549) loss_zs_kd 0.0934 (0.0971) loss_oracle 0.3469 (0.2983) acc 93.7500 (87.0089) kd_loss 1.0270 (0.9971) lr 4.8943e-05 eta 0:00:56
epoch [47/50] batch [160/176] time 0.083 (0.101) data 0.000 (0.002) loss 0.5558 (0.6976) ce_loss 0.2334 (0.3659) teacher_loss 0.2069 (0.3519) loss_zs_kd 0.0865 (0.0968) loss_oracle 0.3056 (0.2973) acc 93.7500 (87.0508) kd_loss 1.0127 (0.9974) lr 4.8943e-05 eta 0:00:55
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,184
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,715
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 59.3%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [48/50] batch [20/176] time 0.081 (0.119) data 0.000 (0.017) loss 0.7504 (0.7382) ce_loss 0.3586 (0.4026) teacher_loss 0.3628 (0.3851) loss_zs_kd 0.1320 (0.0981) loss_oracle 0.3216 (0.3040) acc 87.5000 (83.9062) kd_loss 0.9764 (0.9906) lr 3.1417e-05 eta 0:01:00
epoch [48/50] batch [40/176] time 0.087 (0.114) data 0.000 (0.009) loss 0.7158 (0.7372) ce_loss 0.3850 (0.4005) teacher_loss 0.4009 (0.3867) loss_zs_kd 0.1141 (0.0989) loss_oracle 0.2579 (0.3010) acc 87.5000 (85.0000) kd_loss 1.0013 (0.9888) lr 3.1417e-05 eta 0:00:55
epoch [48/50] batch [60/176] time 0.124 (0.113) data 0.000 (0.006) loss 0.8194 (0.7267) ce_loss 0.5078 (0.3877) teacher_loss 0.4809 (0.3751) loss_zs_kd 0.1506 (0.1016) loss_oracle 0.2632 (0.3009) acc 78.1250 (85.6771) kd_loss 0.9410 (0.9871) lr 3.1417e-05 eta 0:00:52
epoch [48/50] batch [80/176] time 0.119 (0.111) data 0.001 (0.004) loss 0.6771 (0.7346) ce_loss 0.3330 (0.3973) teacher_loss 0.3361 (0.3840) loss_zs_kd 0.0742 (0.1001) loss_oracle 0.3038 (0.3005) acc 87.5000 (86.0156) kd_loss 1.0158 (0.9873) lr 3.1417e-05 eta 0:00:49
epoch [48/50] batch [100/176] time 0.114 (0.111) data 0.000 (0.004) loss 0.6708 (0.7296) ce_loss 0.3452 (0.3928) teacher_loss 0.3117 (0.3794) loss_zs_kd 0.1556 (0.1000) loss_oracle 0.2813 (0.3002) acc 90.6250 (86.2812) kd_loss 1.0079 (0.9912) lr 3.1417e-05 eta 0:00:47
epoch [48/50] batch [120/176] time 0.142 (0.111) data 0.000 (0.003) loss 0.5819 (0.7295) ce_loss 0.2625 (0.3918) teacher_loss 0.2497 (0.3791) loss_zs_kd 0.0957 (0.0992) loss_oracle 0.2844 (0.3008) acc 87.5000 (86.4323) kd_loss 0.9564 (0.9934) lr 3.1417e-05 eta 0:00:45
epoch [48/50] batch [140/176] time 0.084 (0.110) data 0.000 (0.003) loss 0.7017 (0.7271) ce_loss 0.4146 (0.3899) teacher_loss 0.4165 (0.3780) loss_zs_kd 0.0674 (0.0982) loss_oracle 0.2516 (0.3000) acc 87.5000 (86.4286) kd_loss 1.0143 (0.9943) lr 3.1417e-05 eta 0:00:42
epoch [48/50] batch [160/176] time 0.142 (0.112) data 0.000 (0.002) loss 0.7458 (0.7225) ce_loss 0.3381 (0.3884) teacher_loss 0.3380 (0.3761) loss_zs_kd 0.0962 (0.0971) loss_oracle 0.3597 (0.2978) acc 87.5000 (86.5625) kd_loss 1.0439 (0.9916) lr 3.1417e-05 eta 0:00:41
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,183
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,715
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 59.3%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [49/50] batch [20/176] time 0.100 (0.138) data 0.000 (0.014) loss 0.7486 (0.6300) ce_loss 0.3420 (0.2989) teacher_loss 0.3526 (0.2873) loss_zs_kd 0.0762 (0.0869) loss_oracle 0.3579 (0.2992) acc 87.5000 (90.9375) kd_loss 1.0086 (0.9964) lr 1.7713e-05 eta 0:00:45
epoch [49/50] batch [40/176] time 0.088 (0.124) data 0.000 (0.007) loss 0.7321 (0.6597) ce_loss 0.3330 (0.3291) teacher_loss 0.3280 (0.3093) loss_zs_kd 0.1112 (0.0985) loss_oracle 0.3484 (0.3012) acc 87.5000 (89.2969) kd_loss 1.0556 (0.9956) lr 1.7713e-05 eta 0:00:38
epoch [49/50] batch [60/176] time 0.084 (0.121) data 0.001 (0.005) loss 0.8545 (0.6860) ce_loss 0.5024 (0.3504) teacher_loss 0.5027 (0.3335) loss_zs_kd 0.0898 (0.0987) loss_oracle 0.3070 (0.3031) acc 75.0000 (88.1771) kd_loss 0.9971 (0.9963) lr 1.7713e-05 eta 0:00:35
epoch [49/50] batch [80/176] time 0.130 (0.118) data 0.000 (0.004) loss 0.6048 (0.6803) ce_loss 0.2391 (0.3494) teacher_loss 0.2573 (0.3336) loss_zs_kd 0.0637 (0.0971) loss_oracle 0.3157 (0.2982) acc 93.7500 (88.3203) kd_loss 0.9956 (0.9929) lr 1.7713e-05 eta 0:00:31
epoch [49/50] batch [100/176] time 0.086 (0.116) data 0.000 (0.003) loss 0.4517 (0.6792) ce_loss 0.1625 (0.3487) teacher_loss 0.1644 (0.3338) loss_zs_kd 0.0972 (0.0975) loss_oracle 0.2387 (0.2967) acc 100.0000 (88.0625) kd_loss 0.9702 (0.9933) lr 1.7713e-05 eta 0:00:29
epoch [49/50] batch [120/176] time 0.109 (0.117) data 0.000 (0.003) loss 0.6408 (0.6844) ce_loss 0.3157 (0.3539) teacher_loss 0.3076 (0.3403) loss_zs_kd 0.0897 (0.0968) loss_oracle 0.2883 (0.2957) acc 90.6250 (87.7083) kd_loss 0.9598 (0.9938) lr 1.7713e-05 eta 0:00:27
epoch [49/50] batch [140/176] time 0.123 (0.116) data 0.000 (0.002) loss 0.8348 (0.6902) ce_loss 0.4922 (0.3598) teacher_loss 0.4767 (0.3464) loss_zs_kd 0.1068 (0.0977) loss_oracle 0.3047 (0.2950) acc 84.3750 (87.5670) kd_loss 0.9886 (0.9937) lr 1.7713e-05 eta 0:00:24
epoch [49/50] batch [160/176] time 0.140 (0.116) data 0.000 (0.002) loss 0.7648 (0.6902) ce_loss 0.3960 (0.3596) teacher_loss 0.4389 (0.3464) loss_zs_kd 0.1015 (0.0987) loss_oracle 0.2751 (0.2945) acc 93.7500 (87.4805) kd_loss 0.9759 (0.9925) lr 1.7713e-05 eta 0:00:22
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,184
* accuracy: 90.2%
* error: 9.8%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,716
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 59.3%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
epoch [50/50] batch [20/176] time 0.108 (0.114) data 0.000 (0.014) loss 0.5685 (0.6604) ce_loss 0.2321 (0.3291) teacher_loss 0.2296 (0.3110) loss_zs_kd 0.0857 (0.0984) loss_oracle 0.2960 (0.3002) acc 93.7500 (88.4375) kd_loss 0.9917 (0.9801) lr 7.8853e-06 eta 0:00:17
epoch [50/50] batch [40/176] time 0.077 (0.105) data 0.000 (0.007) loss 0.7866 (0.6801) ce_loss 0.4783 (0.3458) teacher_loss 0.4657 (0.3329) loss_zs_kd 0.0849 (0.0979) loss_oracle 0.2784 (0.2982) acc 84.3750 (87.6562) kd_loss 1.0241 (0.9926) lr 7.8853e-06 eta 0:00:14
epoch [50/50] batch [60/176] time 0.088 (0.101) data 0.001 (0.005) loss 0.6749 (0.6721) ce_loss 0.3784 (0.3453) teacher_loss 0.3262 (0.3301) loss_zs_kd 0.0879 (0.0966) loss_oracle 0.3048 (0.2937) acc 87.5000 (87.5521) kd_loss 1.0026 (0.9840) lr 7.8853e-06 eta 0:00:11
epoch [50/50] batch [80/176] time 0.121 (0.099) data 0.000 (0.004) loss 0.8037 (0.6844) ce_loss 0.4949 (0.3579) teacher_loss 0.4890 (0.3435) loss_zs_kd 0.0763 (0.0956) loss_oracle 0.2765 (0.2931) acc 78.1250 (87.3828) kd_loss 1.0103 (0.9855) lr 7.8853e-06 eta 0:00:09
epoch [50/50] batch [100/176] time 0.100 (0.097) data 0.000 (0.003) loss 0.6128 (0.6848) ce_loss 0.2900 (0.3565) teacher_loss 0.2870 (0.3405) loss_zs_kd 0.0812 (0.0961) loss_oracle 0.2852 (0.2963) acc 87.5000 (87.5312) kd_loss 0.8946 (0.9877) lr 7.8853e-06 eta 0:00:07
epoch [50/50] batch [120/176] time 0.135 (0.097) data 0.000 (0.003) loss 0.7275 (0.6945) ce_loss 0.4451 (0.3647) teacher_loss 0.4228 (0.3481) loss_zs_kd 0.1020 (0.0984) loss_oracle 0.2537 (0.2972) acc 90.6250 (87.2135) kd_loss 1.0205 (0.9884) lr 7.8853e-06 eta 0:00:05
epoch [50/50] batch [140/176] time 0.087 (0.097) data 0.000 (0.002) loss 0.6456 (0.7019) ce_loss 0.3245 (0.3733) teacher_loss 0.3340 (0.3572) loss_zs_kd 0.0855 (0.0981) loss_oracle 0.2688 (0.2956) acc 90.6250 (87.0536) kd_loss 0.9593 (0.9900) lr 7.8853e-06 eta 0:00:03
epoch [50/50] batch [160/176] time 0.089 (0.097) data 0.000 (0.002) loss 0.6585 (0.6992) ce_loss 0.3030 (0.3709) teacher_loss 0.2895 (0.3550) loss_zs_kd 0.0864 (0.0971) loss_oracle 0.3258 (0.2957) acc 90.6250 (87.2070) kd_loss 0.9931 (0.9925) lr 7.8853e-06 eta 0:00:01
Evaluate on the *val* set
=> result
* total: 2,422
* correct: 2,183
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.1%
Evaluate on the *test* set
=> result
* total: 2,656
* correct: 1,717
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 59.3%
******* Domain l best val acc:      90.3%, epoch: 29 *******
******* Domain l best val test acc: 66.5%, epoch: 29 *******
******* Domain l best test acc:     68.8%, epoch: 1 *******
Checkpoint saved to icml/multi-dg/oracle/05_nouse_ema/TRIP/vlcs/b32_ep50/ViT-B16/l/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:20:45
