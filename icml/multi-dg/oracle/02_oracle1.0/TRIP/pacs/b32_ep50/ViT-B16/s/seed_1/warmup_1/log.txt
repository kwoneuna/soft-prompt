Loading trainer: TRIP
Loading dataset: SPG_PACS
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ------------------------------------
Dataset    SPG_PACS
Source     ['art_painting', 'cartoon', 'photo']
Target     ['sketch']
# classes  7
# train_x  4,241
# val      1,821
# test     3,928
---------  ------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/132] time 0.078 (0.133) data 0.000 (0.023) loss 0.1689 (0.2720) ce_loss 0.1688 (0.2716) teacher_loss 0.1687 (0.2717) loss_zs_kd 0.0000 (0.0000) loss_oracle 0.0002 (0.0004) acc 96.8750 (90.0000) kd_loss 0.0007 (0.0014) lr 1.0000e-05 eta 0:14:35
epoch [1/50] batch [40/132] time 0.083 (0.109) data 0.000 (0.012) loss 0.2077 (0.2598) ce_loss 0.2074 (0.2595) teacher_loss 0.2074 (0.2595) loss_zs_kd 0.0001 (0.0000) loss_oracle 0.0003 (0.0003) acc 93.7500 (90.9375) kd_loss 0.0010 (0.0011) lr 1.0000e-05 eta 0:11:54
epoch [1/50] batch [60/132] time 0.079 (0.100) data 0.000 (0.008) loss 0.4267 (0.2504) ce_loss 0.4268 (0.2501) teacher_loss 0.4261 (0.2501) loss_zs_kd 0.0004 (0.0001) loss_oracle 0.0004 (0.0003) acc 81.2500 (91.2500) kd_loss 0.0014 (0.0011) lr 1.0000e-05 eta 0:10:57
epoch [1/50] batch [80/132] time 0.081 (0.097) data 0.000 (0.006) loss 0.3852 (0.2517) ce_loss 0.3850 (0.2514) teacher_loss 0.3846 (0.2513) loss_zs_kd 0.0004 (0.0001) loss_oracle 0.0004 (0.0003) acc 84.3750 (91.3672) kd_loss 0.0016 (0.0012) lr 1.0000e-05 eta 0:10:31
epoch [1/50] batch [100/132] time 0.095 (0.095) data 0.000 (0.005) loss 0.1748 (0.2585) ce_loss 0.1741 (0.2581) teacher_loss 0.1741 (0.2581) loss_zs_kd 0.0005 (0.0002) loss_oracle 0.0004 (0.0003) acc 90.6250 (91.3750) kd_loss 0.0016 (0.0012) lr 1.0000e-05 eta 0:10:16
epoch [1/50] batch [120/132] time 0.092 (0.094) data 0.000 (0.004) loss 0.3607 (0.2580) ce_loss 0.3604 (0.2576) teacher_loss 0.3600 (0.2575) loss_zs_kd 0.0002 (0.0002) loss_oracle 0.0006 (0.0004) acc 87.5000 (91.4062) kd_loss 0.0024 (0.0013) lr 1.0000e-05 eta 0:10:11
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,800
* accuracy: 98.8%
* error: 1.2%
* macro_f1: 98.9%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,472
* accuracy: 88.4%
* error: 11.6%
* macro_f1: 90.7%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain s best val acc:      98.8%, epoch: 1 *******
******* Domain s best val test acc: 88.4%, epoch: 1 *******
******* Domain s best test acc:     88.4%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/ana
epoch [2/50] batch [20/132] time 0.090 (0.112) data 0.000 (0.024) loss 0.1074 (0.2564) ce_loss 0.1005 (0.2433) teacher_loss 0.1001 (0.2432) loss_zs_kd 0.0106 (0.0231) loss_oracle 0.0020 (0.0016) acc 96.8750 (92.0312) kd_loss 0.0047 (0.0038) lr 2.0000e-03 eta 0:12:00
epoch [2/50] batch [40/132] time 0.088 (0.101) data 0.000 (0.012) loss 0.4224 (0.2388) ce_loss 0.4070 (0.2253) teacher_loss 0.4062 (0.2251) loss_zs_kd 0.0222 (0.0227) loss_oracle 0.0051 (0.0024) acc 90.6250 (92.7344) kd_loss 0.0112 (0.0056) lr 2.0000e-03 eta 0:10:51
epoch [2/50] batch [60/132] time 0.069 (0.096) data 0.000 (0.008) loss 0.3505 (0.2347) ce_loss 0.3228 (0.2181) teacher_loss 0.3205 (0.2177) loss_zs_kd 0.0390 (0.0251) loss_oracle 0.0105 (0.0045) acc 87.5000 (93.0208) kd_loss 0.0242 (0.0094) lr 2.0000e-03 eta 0:10:17
epoch [2/50] batch [80/132] time 0.084 (0.093) data 0.001 (0.006) loss 0.1801 (0.2390) ce_loss 0.1193 (0.2141) teacher_loss 0.1165 (0.2126) loss_zs_kd 0.0303 (0.0273) loss_oracle 0.0484 (0.0127) acc 96.8750 (92.9688) kd_loss 0.0730 (0.0186) lr 2.0000e-03 eta 0:09:52
epoch [2/50] batch [100/132] time 0.082 (0.090) data 0.000 (0.005) loss 0.4709 (0.2583) ce_loss 0.2559 (0.2118) teacher_loss 0.2298 (0.2082) loss_zs_kd 0.0289 (0.0294) loss_oracle 0.2267 (0.0354) acc 93.7500 (93.1250) kd_loss 0.2430 (0.0445) lr 2.0000e-03 eta 0:09:33
epoch [2/50] batch [120/132] time 0.077 (0.089) data 0.000 (0.004) loss 0.5072 (0.2801) ce_loss 0.1901 (0.2103) teacher_loss 0.1756 (0.2048) loss_zs_kd 0.0216 (0.0287) loss_oracle 0.3208 (0.0609) acc 90.6250 (93.0990) kd_loss 0.3792 (0.0778) lr 2.0000e-03 eta 0:09:27
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,803
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.0%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,504
* accuracy: 89.2%
* error: 10.8%
* macro_f1: 91.6%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain s best val acc:      99.0%, epoch: 2 *******
******* Domain s best val test acc: 89.2%, epoch: 2 *******
******* Domain s best test acc:     89.2%, epoch: 2 *******
epoch [3/50] batch [20/132] time 0.087 (0.123) data 0.000 (0.025) loss 0.7812 (0.5683) ce_loss 0.4001 (0.2030) teacher_loss 0.3707 (0.1800) loss_zs_kd 0.0363 (0.0292) loss_oracle 0.3924 (0.3737) acc 84.3750 (93.1250) kd_loss 0.6479 (0.6042) lr 1.9980e-03 eta 0:12:54
epoch [3/50] batch [40/132] time 0.083 (0.102) data 0.000 (0.013) loss 0.4364 (0.5792) ce_loss 0.2445 (0.2188) teacher_loss 0.2304 (0.1929) loss_zs_kd 0.0373 (0.0325) loss_oracle 0.1873 (0.3700) acc 93.7500 (92.5781) kd_loss 0.4836 (0.6045) lr 1.9980e-03 eta 0:10:44
epoch [3/50] batch [60/132] time 0.088 (0.095) data 0.000 (0.008) loss 0.5288 (0.5417) ce_loss 0.2069 (0.2153) teacher_loss 0.1478 (0.1860) loss_zs_kd 0.0258 (0.0335) loss_oracle 0.3681 (0.3390) acc 90.6250 (92.7604) kd_loss 0.5672 (0.5693) lr 1.9980e-03 eta 0:09:58
epoch [3/50] batch [80/132] time 0.087 (0.093) data 0.000 (0.006) loss 0.5318 (0.5286) ce_loss 0.2854 (0.2124) teacher_loss 0.2024 (0.1789) loss_zs_kd 0.0433 (0.0370) loss_oracle 0.3078 (0.3312) acc 87.5000 (92.7734) kd_loss 0.5311 (0.5588) lr 1.9980e-03 eta 0:09:42
epoch [3/50] batch [100/132] time 0.090 (0.092) data 0.000 (0.005) loss 0.4407 (0.5180) ce_loss 0.1228 (0.2123) teacher_loss 0.1111 (0.1776) loss_zs_kd 0.0282 (0.0385) loss_oracle 0.3155 (0.3212) acc 96.8750 (92.6875) kd_loss 0.6204 (0.5570) lr 1.9980e-03 eta 0:09:33
epoch [3/50] batch [120/132] time 0.072 (0.091) data 0.000 (0.004) loss 0.4612 (0.5100) ce_loss 0.1990 (0.2100) teacher_loss 0.1663 (0.1770) loss_zs_kd 0.0467 (0.0399) loss_oracle 0.2716 (0.3130) acc 96.8750 (92.9167) kd_loss 0.6203 (0.5648) lr 1.9980e-03 eta 0:09:23
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,805
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,525
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 92.0%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain s best val acc:      99.1%, epoch: 3 *******
******* Domain s best val test acc: 89.7%, epoch: 3 *******
******* Domain s best test acc:     89.7%, epoch: 3 *******
epoch [4/50] batch [20/132] time 0.085 (0.107) data 0.000 (0.020) loss 0.4653 (0.4946) ce_loss 0.1715 (0.2073) teacher_loss 0.1361 (0.1789) loss_zs_kd 0.0300 (0.0471) loss_oracle 0.3142 (0.2921) acc 96.8750 (93.2812) kd_loss 0.7921 (0.6744) lr 1.9921e-03 eta 0:11:03
epoch [4/50] batch [40/132] time 0.093 (0.097) data 0.001 (0.010) loss 0.8207 (0.5298) ce_loss 0.4873 (0.2165) teacher_loss 0.3431 (0.1826) loss_zs_kd 0.0591 (0.0483) loss_oracle 0.4480 (0.3231) acc 90.6250 (92.8906) kd_loss 0.8442 (0.7213) lr 1.9921e-03 eta 0:09:58
epoch [4/50] batch [60/132] time 0.102 (0.094) data 0.001 (0.007) loss 0.7281 (0.5796) ce_loss 0.2228 (0.2072) teacher_loss 0.1421 (0.1751) loss_zs_kd 0.0503 (0.0486) loss_oracle 0.5608 (0.3802) acc 87.5000 (93.3333) kd_loss 0.9204 (0.7783) lr 1.9921e-03 eta 0:09:36
epoch [4/50] batch [80/132] time 0.089 (0.094) data 0.000 (0.005) loss 0.5098 (0.5745) ce_loss 0.1747 (0.2021) teacher_loss 0.1579 (0.1740) loss_zs_kd 0.0249 (0.0453) loss_oracle 0.3394 (0.3778) acc 93.7500 (93.3984) kd_loss 0.9168 (0.8148) lr 1.9921e-03 eta 0:09:34
epoch [4/50] batch [100/132] time 0.087 (0.093) data 0.000 (0.004) loss 0.7507 (0.5805) ce_loss 0.3699 (0.2111) teacher_loss 0.2982 (0.1813) loss_zs_kd 0.0579 (0.0434) loss_oracle 0.4235 (0.3775) acc 87.5000 (93.0312) kd_loss 0.9630 (0.8406) lr 1.9921e-03 eta 0:09:24
epoch [4/50] batch [120/132] time 0.077 (0.091) data 0.000 (0.004) loss 0.6315 (0.5767) ce_loss 0.3403 (0.2121) teacher_loss 0.2545 (0.1835) loss_zs_kd 0.0413 (0.0424) loss_oracle 0.3564 (0.3720) acc 84.3750 (93.0208) kd_loss 0.8850 (0.8549) lr 1.9921e-03 eta 0:09:14
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,804
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.0%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,528
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 92.0%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain s best val acc:      99.1%, epoch: 3 *******
******* Domain s best val test acc: 89.7%, epoch: 3 *******
******* Domain s best test acc:     89.8%, epoch: 4 *******
epoch [5/50] batch [20/132] time 0.088 (0.102) data 0.001 (0.014) loss 0.6083 (0.6387) ce_loss 0.2028 (0.2257) teacher_loss 0.1801 (0.1858) loss_zs_kd 0.0397 (0.0390) loss_oracle 0.4084 (0.4334) acc 93.7500 (92.8125) kd_loss 0.8693 (0.8864) lr 1.9823e-03 eta 0:10:17
epoch [5/50] batch [40/132] time 0.092 (0.095) data 0.000 (0.007) loss 0.6768 (0.6211) ce_loss 0.2712 (0.2195) teacher_loss 0.2474 (0.1771) loss_zs_kd 0.0318 (0.0445) loss_oracle 0.4135 (0.4217) acc 90.6250 (93.1250) kd_loss 0.8898 (0.8766) lr 1.9823e-03 eta 0:09:33
epoch [5/50] batch [60/132] time 0.078 (0.092) data 0.001 (0.005) loss 0.6851 (0.6236) ce_loss 0.3088 (0.2203) teacher_loss 0.2382 (0.1777) loss_zs_kd 0.0459 (0.0444) loss_oracle 0.4240 (0.4237) acc 87.5000 (92.9167) kd_loss 0.8652 (0.8797) lr 1.9823e-03 eta 0:09:11
epoch [5/50] batch [80/132] time 0.083 (0.090) data 0.000 (0.004) loss 0.8138 (0.6235) ce_loss 0.3760 (0.2149) teacher_loss 0.3540 (0.1770) loss_zs_kd 0.0450 (0.0437) loss_oracle 0.4373 (0.4247) acc 84.3750 (93.0469) kd_loss 0.8837 (0.8800) lr 1.9823e-03 eta 0:09:01
epoch [5/50] batch [100/132] time 0.092 (0.089) data 0.000 (0.003) loss 0.4693 (0.6293) ce_loss 0.0504 (0.2198) teacher_loss 0.0349 (0.1809) loss_zs_kd 0.0270 (0.0427) loss_oracle 0.4209 (0.4270) acc 100.0000 (93.0000) kd_loss 0.8893 (0.8833) lr 1.9823e-03 eta 0:08:53
epoch [5/50] batch [120/132] time 0.074 (0.089) data 0.000 (0.003) loss 0.5706 (0.6285) ce_loss 0.2201 (0.2188) teacher_loss 0.1867 (0.1809) loss_zs_kd 0.0307 (0.0434) loss_oracle 0.3687 (0.4258) acc 93.7500 (92.9948) kd_loss 0.8477 (0.8850) lr 1.9823e-03 eta 0:08:50
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,804
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.0%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,532
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 92.1%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain s best val acc:      99.1%, epoch: 3 *******
******* Domain s best val test acc: 89.7%, epoch: 3 *******
******* Domain s best test acc:     89.9%, epoch: 5 *******
epoch [6/50] batch [20/132] time 0.086 (0.103) data 0.000 (0.014) loss 0.5167 (0.6094) ce_loss 0.0553 (0.2099) teacher_loss 0.0358 (0.1707) loss_zs_kd 0.0370 (0.0398) loss_oracle 0.4624 (0.4188) acc 100.0000 (92.3438) kd_loss 0.8939 (0.8624) lr 1.9686e-03 eta 0:10:09
epoch [6/50] batch [40/132] time 0.079 (0.092) data 0.000 (0.007) loss 0.7007 (0.5933) ce_loss 0.2888 (0.1940) teacher_loss 0.2193 (0.1575) loss_zs_kd 0.0845 (0.0386) loss_oracle 0.4391 (0.4166) acc 87.5000 (93.2812) kd_loss 0.8254 (0.8555) lr 1.9686e-03 eta 0:09:05
epoch [6/50] batch [60/132] time 0.098 (0.090) data 0.001 (0.005) loss 0.4908 (0.6027) ce_loss 0.1288 (0.1955) teacher_loss 0.0881 (0.1596) loss_zs_kd 0.0368 (0.0406) loss_oracle 0.3842 (0.4228) acc 96.8750 (93.3333) kd_loss 0.7573 (0.8506) lr 1.9686e-03 eta 0:08:49
epoch [6/50] batch [80/132] time 0.082 (0.088) data 0.000 (0.004) loss 0.7508 (0.6351) ce_loss 0.2747 (0.2134) teacher_loss 0.2087 (0.1717) loss_zs_kd 0.0736 (0.0441) loss_oracle 0.5053 (0.4413) acc 87.5000 (92.7344) kd_loss 0.9220 (0.8551) lr 1.9686e-03 eta 0:08:35
epoch [6/50] batch [100/132] time 0.087 (0.088) data 0.000 (0.003) loss 0.6082 (0.6422) ce_loss 0.1741 (0.2115) teacher_loss 0.1421 (0.1715) loss_zs_kd 0.0391 (0.0433) loss_oracle 0.4466 (0.4491) acc 93.7500 (92.7500) kd_loss 0.8640 (0.8622) lr 1.9686e-03 eta 0:08:32
epoch [6/50] batch [120/132] time 0.071 (0.087) data 0.000 (0.003) loss 0.7970 (0.6425) ce_loss 0.3606 (0.2042) teacher_loss 0.2722 (0.1646) loss_zs_kd 0.0408 (0.0425) loss_oracle 0.5044 (0.4567) acc 87.5000 (92.9948) kd_loss 0.9151 (0.8685) lr 1.9686e-03 eta 0:08:24
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,807
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.2%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,533
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 92.2%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain s best val acc:      99.2%, epoch: 6 *******
******* Domain s best val test acc: 89.9%, epoch: 6 *******
******* Domain s best test acc:     89.9%, epoch: 6 *******
epoch [7/50] batch [20/132] time 0.085 (0.099) data 0.000 (0.012) loss 0.9245 (0.7007) ce_loss 0.4077 (0.2613) teacher_loss 0.3982 (0.2111) loss_zs_kd 0.0554 (0.0498) loss_oracle 0.4987 (0.4647) acc 87.5000 (91.0938) kd_loss 0.8602 (0.8831) lr 1.9511e-03 eta 0:09:35
epoch [7/50] batch [40/132] time 0.081 (0.094) data 0.000 (0.006) loss 0.5540 (0.7105) ce_loss 0.0217 (0.2347) teacher_loss 0.0121 (0.1844) loss_zs_kd 0.0227 (0.0499) loss_oracle 0.5305 (0.5011) acc 100.0000 (91.5625) kd_loss 0.9220 (0.8817) lr 1.9511e-03 eta 0:09:00
epoch [7/50] batch [60/132] time 0.084 (0.090) data 0.001 (0.004) loss 0.7389 (0.6922) ce_loss 0.1982 (0.2152) teacher_loss 0.1966 (0.1729) loss_zs_kd 0.0506 (0.0476) loss_oracle 0.5171 (0.4956) acc 93.7500 (92.3438) kd_loss 0.8587 (0.8776) lr 1.9511e-03 eta 0:08:39
epoch [7/50] batch [80/132] time 0.091 (0.090) data 0.000 (0.003) loss 0.7661 (0.6879) ce_loss 0.2377 (0.2096) teacher_loss 0.2516 (0.1719) loss_zs_kd 0.0282 (0.0447) loss_oracle 0.5005 (0.4936) acc 93.7500 (92.7734) kd_loss 0.8397 (0.8720) lr 1.9511e-03 eta 0:08:36
epoch [7/50] batch [100/132] time 0.067 (0.090) data 0.000 (0.003) loss 0.5515 (0.6946) ce_loss 0.0759 (0.2127) teacher_loss 0.0688 (0.1744) loss_zs_kd 0.0275 (0.0435) loss_oracle 0.4690 (0.4985) acc 96.8750 (92.7500) kd_loss 0.7913 (0.8643) lr 1.9511e-03 eta 0:08:31
epoch [7/50] batch [120/132] time 0.081 (0.089) data 0.000 (0.002) loss 0.6824 (0.6908) ce_loss 0.2737 (0.2146) teacher_loss 0.2401 (0.1761) loss_zs_kd 0.0311 (0.0435) loss_oracle 0.4268 (0.4929) acc 90.6250 (92.7083) kd_loss 0.8490 (0.8575) lr 1.9511e-03 eta 0:08:25
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,806
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.1%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,538
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.3%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain s best val acc:      99.2%, epoch: 6 *******
******* Domain s best val test acc: 89.9%, epoch: 6 *******
******* Domain s best test acc:     90.1%, epoch: 7 *******
epoch [8/50] batch [20/132] time 0.084 (0.095) data 0.000 (0.012) loss 0.6554 (0.6229) ce_loss 0.1827 (0.1758) teacher_loss 0.1406 (0.1445) loss_zs_kd 0.0551 (0.0531) loss_oracle 0.4872 (0.4518) acc 93.7500 (94.0625) kd_loss 0.8915 (0.8491) lr 1.9298e-03 eta 0:08:58
epoch [8/50] batch [40/132] time 0.091 (0.089) data 0.001 (0.006) loss 0.4864 (0.6110) ce_loss 0.0704 (0.1837) teacher_loss 0.0446 (0.1521) loss_zs_kd 0.0405 (0.0498) loss_oracle 0.4216 (0.4340) acc 100.0000 (93.9844) kd_loss 0.7774 (0.8247) lr 1.9298e-03 eta 0:08:21
epoch [8/50] batch [60/132] time 0.085 (0.088) data 0.000 (0.004) loss 0.5464 (0.6052) ce_loss 0.1703 (0.1865) teacher_loss 0.0899 (0.1534) loss_zs_kd 0.0402 (0.0496) loss_oracle 0.4363 (0.4270) acc 96.8750 (94.2188) kd_loss 0.8848 (0.8271) lr 1.9298e-03 eta 0:08:12
epoch [8/50] batch [80/132] time 0.086 (0.087) data 0.000 (0.003) loss 0.5763 (0.6039) ce_loss 0.1986 (0.1880) teacher_loss 0.1511 (0.1526) loss_zs_kd 0.0570 (0.0485) loss_oracle 0.3967 (0.4270) acc 93.7500 (93.9453) kd_loss 0.7912 (0.8269) lr 1.9298e-03 eta 0:08:08
epoch [8/50] batch [100/132] time 0.084 (0.087) data 0.000 (0.003) loss 0.5167 (0.5994) ce_loss 0.1234 (0.1843) teacher_loss 0.0985 (0.1496) loss_zs_kd 0.0398 (0.0488) loss_oracle 0.3983 (0.4255) acc 96.8750 (94.0312) kd_loss 0.7951 (0.8261) lr 1.9298e-03 eta 0:08:02
epoch [8/50] batch [120/132] time 0.074 (0.086) data 0.000 (0.002) loss 0.6467 (0.6029) ce_loss 0.1898 (0.1874) teacher_loss 0.1196 (0.1505) loss_zs_kd 0.0741 (0.0491) loss_oracle 0.4900 (0.4279) acc 93.7500 (93.9323) kd_loss 0.9121 (0.8303) lr 1.9298e-03 eta 0:07:59
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,805
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,511
* accuracy: 89.4%
* error: 10.6%
* macro_f1: 91.8%
******* Domain s best val acc:      99.2%, epoch: 6 *******
******* Domain s best val test acc: 89.9%, epoch: 6 *******
******* Domain s best test acc:     90.1%, epoch: 7 *******
epoch [9/50] batch [20/132] time 0.090 (0.111) data 0.000 (0.020) loss 0.6429 (0.5906) ce_loss 0.2136 (0.2060) teacher_loss 0.2059 (0.1497) loss_zs_kd 0.0588 (0.0505) loss_oracle 0.4075 (0.4156) acc 93.7500 (93.5938) kd_loss 0.7886 (0.8398) lr 1.9048e-03 eta 0:10:12
epoch [9/50] batch [40/132] time 0.083 (0.099) data 0.000 (0.010) loss 0.5940 (0.6003) ce_loss 0.2311 (0.2159) teacher_loss 0.1760 (0.1660) loss_zs_kd 0.0454 (0.0502) loss_oracle 0.3953 (0.4092) acc 87.5000 (92.8906) kd_loss 0.8981 (0.8390) lr 1.9048e-03 eta 0:09:06
epoch [9/50] batch [60/132] time 0.084 (0.094) data 0.000 (0.007) loss 0.6422 (0.6064) ce_loss 0.3679 (0.2238) teacher_loss 0.2621 (0.1767) loss_zs_kd 0.0582 (0.0510) loss_oracle 0.3510 (0.4042) acc 84.3750 (92.5521) kd_loss 0.7682 (0.8425) lr 1.9048e-03 eta 0:08:34
epoch [9/50] batch [80/132] time 0.085 (0.091) data 0.000 (0.005) loss 0.7954 (0.6156) ce_loss 0.3684 (0.2331) teacher_loss 0.2085 (0.1812) loss_zs_kd 0.1072 (0.0522) loss_oracle 0.5333 (0.4082) acc 87.5000 (91.9531) kd_loss 0.8930 (0.8461) lr 1.9048e-03 eta 0:08:16
epoch [9/50] batch [100/132] time 0.085 (0.090) data 0.000 (0.004) loss 0.5877 (0.6061) ce_loss 0.2715 (0.2224) teacher_loss 0.2226 (0.1731) loss_zs_kd 0.0462 (0.0519) loss_oracle 0.3420 (0.4070) acc 90.6250 (92.2812) kd_loss 0.7049 (0.8376) lr 1.9048e-03 eta 0:08:08
epoch [9/50] batch [120/132] time 0.081 (0.089) data 0.000 (0.004) loss 0.6951 (0.6201) ce_loss 0.3669 (0.2327) teacher_loss 0.2157 (0.1825) loss_zs_kd 0.1395 (0.0547) loss_oracle 0.4097 (0.4102) acc 87.5000 (92.0312) kd_loss 0.8394 (0.8411) lr 1.9048e-03 eta 0:08:02
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.2%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,502
* accuracy: 89.2%
* error: 10.8%
* macro_f1: 91.7%
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.1%, epoch: 7 *******
epoch [10/50] batch [20/132] time 0.092 (0.099) data 0.000 (0.014) loss 0.6517 (0.6581) ce_loss 0.3049 (0.2559) teacher_loss 0.2067 (0.1912) loss_zs_kd 0.0616 (0.0535) loss_oracle 0.4142 (0.4401) acc 90.6250 (91.2500) kd_loss 0.8187 (0.8522) lr 1.8763e-03 eta 0:08:55
epoch [10/50] batch [40/132] time 0.088 (0.091) data 0.000 (0.007) loss 0.5178 (0.6080) ce_loss 0.1683 (0.2032) teacher_loss 0.1600 (0.1487) loss_zs_kd 0.0494 (0.0544) loss_oracle 0.3331 (0.4322) acc 93.7500 (93.1250) kd_loss 0.7658 (0.8419) lr 1.8763e-03 eta 0:08:08
epoch [10/50] batch [60/132] time 0.083 (0.088) data 0.000 (0.005) loss 0.6703 (0.6138) ce_loss 0.2345 (0.2010) teacher_loss 0.2273 (0.1471) loss_zs_kd 0.0607 (0.0544) loss_oracle 0.4128 (0.4394) acc 90.6250 (93.2292) kd_loss 0.9259 (0.8582) lr 1.8763e-03 eta 0:07:50
epoch [10/50] batch [80/132] time 0.084 (0.086) data 0.000 (0.004) loss 0.6505 (0.6067) ce_loss 0.2173 (0.1915) teacher_loss 0.1685 (0.1390) loss_zs_kd 0.0516 (0.0544) loss_oracle 0.4561 (0.4405) acc 93.7500 (93.8281) kd_loss 0.8965 (0.8605) lr 1.8763e-03 eta 0:07:40
epoch [10/50] batch [100/132] time 0.089 (0.086) data 0.000 (0.003) loss 0.6406 (0.6089) ce_loss 0.3152 (0.2009) teacher_loss 0.2337 (0.1440) loss_zs_kd 0.0541 (0.0551) loss_oracle 0.3798 (0.4373) acc 87.5000 (93.4375) kd_loss 0.7894 (0.8577) lr 1.8763e-03 eta 0:07:35
epoch [10/50] batch [120/132] time 0.071 (0.085) data 0.000 (0.003) loss 0.8204 (0.6121) ce_loss 0.3406 (0.2054) teacher_loss 0.2892 (0.1474) loss_zs_kd 0.0926 (0.0568) loss_oracle 0.4849 (0.4363) acc 87.5000 (93.1510) kd_loss 0.8818 (0.8571) lr 1.8763e-03 eta 0:07:31
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,801
* accuracy: 98.9%
* error: 1.1%
* macro_f1: 98.9%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,508
* accuracy: 89.3%
* error: 10.7%
* macro_f1: 91.4%
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.1%, epoch: 7 *******
epoch [11/50] batch [20/132] time 0.093 (0.103) data 0.000 (0.019) loss 0.6896 (0.6366) ce_loss 0.2120 (0.2107) teacher_loss 0.1609 (0.1524) loss_zs_kd 0.0682 (0.0539) loss_oracle 0.4946 (0.4573) acc 90.6250 (92.8125) kd_loss 0.9599 (0.9030) lr 1.8443e-03 eta 0:09:02
epoch [11/50] batch [40/132] time 0.083 (0.093) data 0.000 (0.009) loss 0.6249 (0.6290) ce_loss 0.1682 (0.2071) teacher_loss 0.1725 (0.1463) loss_zs_kd 0.0438 (0.0549) loss_oracle 0.4305 (0.4552) acc 90.6250 (92.7344) kd_loss 0.8605 (0.9103) lr 1.8443e-03 eta 0:08:04
epoch [11/50] batch [60/132] time 0.097 (0.091) data 0.001 (0.006) loss 0.7690 (0.6328) ce_loss 0.3145 (0.2095) teacher_loss 0.2417 (0.1453) loss_zs_kd 0.0663 (0.0549) loss_oracle 0.4941 (0.4600) acc 84.3750 (92.9167) kd_loss 0.9273 (0.9042) lr 1.8443e-03 eta 0:07:52
epoch [11/50] batch [80/132] time 0.086 (0.089) data 0.000 (0.005) loss 0.5282 (0.6338) ce_loss 0.1058 (0.2002) teacher_loss 0.0386 (0.1403) loss_zs_kd 0.0720 (0.0563) loss_oracle 0.4535 (0.4653) acc 100.0000 (93.3594) kd_loss 0.8928 (0.9044) lr 1.8443e-03 eta 0:07:42
epoch [11/50] batch [100/132] time 0.085 (0.089) data 0.000 (0.004) loss 0.6926 (0.6397) ce_loss 0.2317 (0.2081) teacher_loss 0.1707 (0.1449) loss_zs_kd 0.0443 (0.0558) loss_oracle 0.4997 (0.4670) acc 90.6250 (93.0000) kd_loss 0.9902 (0.9040) lr 1.8443e-03 eta 0:07:39
epoch [11/50] batch [120/132] time 0.076 (0.088) data 0.000 (0.003) loss 0.7049 (0.6408) ce_loss 0.2688 (0.2107) teacher_loss 0.1913 (0.1471) loss_zs_kd 0.0868 (0.0572) loss_oracle 0.4702 (0.4652) acc 93.7500 (92.9688) kd_loss 0.8788 (0.9045) lr 1.8443e-03 eta 0:07:34
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,806
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.1%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,507
* accuracy: 89.3%
* error: 10.7%
* macro_f1: 91.5%
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.1%, epoch: 7 *******
epoch [12/50] batch [20/132] time 0.088 (0.104) data 0.000 (0.017) loss 0.6748 (0.5975) ce_loss 0.1998 (0.1820) teacher_loss 0.1750 (0.1255) loss_zs_kd 0.0348 (0.0473) loss_oracle 0.4824 (0.4483) acc 93.7500 (94.2188) kd_loss 0.8905 (0.9140) lr 1.8090e-03 eta 0:08:55
epoch [12/50] batch [40/132] time 0.087 (0.095) data 0.000 (0.009) loss 0.6552 (0.6200) ce_loss 0.2791 (0.2064) teacher_loss 0.1671 (0.1410) loss_zs_kd 0.0721 (0.0525) loss_oracle 0.4520 (0.4527) acc 93.7500 (93.1250) kd_loss 0.8606 (0.9116) lr 1.8090e-03 eta 0:08:07
epoch [12/50] batch [60/132] time 0.091 (0.092) data 0.000 (0.006) loss 0.9255 (0.6415) ce_loss 0.4480 (0.2231) teacher_loss 0.3188 (0.1505) loss_zs_kd 0.1181 (0.0564) loss_oracle 0.5477 (0.4627) acc 81.2500 (92.4479) kd_loss 0.9561 (0.9099) lr 1.8090e-03 eta 0:07:48
epoch [12/50] batch [80/132] time 0.092 (0.090) data 0.000 (0.004) loss 0.6439 (0.6483) ce_loss 0.2108 (0.2209) teacher_loss 0.1219 (0.1494) loss_zs_kd 0.0649 (0.0557) loss_oracle 0.4896 (0.4711) acc 90.6250 (92.5781) kd_loss 0.8990 (0.9121) lr 1.8090e-03 eta 0:07:36
epoch [12/50] batch [100/132] time 0.089 (0.089) data 0.000 (0.004) loss 0.6247 (0.6492) ce_loss 0.1957 (0.2209) teacher_loss 0.1664 (0.1503) loss_zs_kd 0.0535 (0.0558) loss_oracle 0.4315 (0.4710) acc 93.7500 (92.5312) kd_loss 0.8501 (0.9110) lr 1.8090e-03 eta 0:07:27
epoch [12/50] batch [120/132] time 0.071 (0.088) data 0.000 (0.003) loss 0.6365 (0.6486) ce_loss 0.1809 (0.2190) teacher_loss 0.0784 (0.1472) loss_zs_kd 0.0855 (0.0576) loss_oracle 0.5153 (0.4727) acc 90.6250 (92.7344) kd_loss 0.9715 (0.9137) lr 1.8090e-03 eta 0:07:21
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,803
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.0%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,531
* accuracy: 89.9%
* error: 10.1%
* macro_f1: 91.9%
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.1%, epoch: 7 *******
epoch [13/50] batch [20/132] time 0.080 (0.094) data 0.000 (0.016) loss 0.6255 (0.6473) ce_loss 0.2712 (0.2294) teacher_loss 0.1439 (0.1534) loss_zs_kd 0.0625 (0.0541) loss_oracle 0.4504 (0.4668) acc 93.7500 (93.1250) kd_loss 0.9161 (0.9070) lr 1.7705e-03 eta 0:07:47
epoch [13/50] batch [40/132] time 0.082 (0.085) data 0.000 (0.008) loss 0.6795 (0.6594) ce_loss 0.2164 (0.2240) teacher_loss 0.1802 (0.1436) loss_zs_kd 0.0758 (0.0629) loss_oracle 0.4613 (0.4844) acc 90.6250 (92.7344) kd_loss 0.8181 (0.9156) lr 1.7705e-03 eta 0:07:01
epoch [13/50] batch [60/132] time 0.067 (0.082) data 0.000 (0.005) loss 0.7127 (0.6681) ce_loss 0.2061 (0.2258) teacher_loss 0.1424 (0.1444) loss_zs_kd 0.0575 (0.0631) loss_oracle 0.5416 (0.4922) acc 93.7500 (92.7604) kd_loss 0.9553 (0.9211) lr 1.7705e-03 eta 0:06:48
epoch [13/50] batch [80/132] time 0.089 (0.082) data 0.001 (0.004) loss 0.7121 (0.6648) ce_loss 0.2839 (0.2172) teacher_loss 0.1431 (0.1380) loss_zs_kd 0.0931 (0.0624) loss_oracle 0.5225 (0.4956) acc 90.6250 (93.0078) kd_loss 0.9606 (0.9184) lr 1.7705e-03 eta 0:06:46
epoch [13/50] batch [100/132] time 0.070 (0.082) data 0.000 (0.003) loss 0.6402 (0.6672) ce_loss 0.1465 (0.2194) teacher_loss 0.0960 (0.1351) loss_zs_kd 0.0644 (0.0640) loss_oracle 0.5120 (0.5000) acc 93.7500 (92.8125) kd_loss 0.8497 (0.9176) lr 1.7705e-03 eta 0:06:40
epoch [13/50] batch [120/132] time 0.074 (0.081) data 0.000 (0.003) loss 0.5865 (0.6662) ce_loss 0.1370 (0.2180) teacher_loss 0.0832 (0.1336) loss_zs_kd 0.0382 (0.0651) loss_oracle 0.4843 (0.5001) acc 96.8750 (92.7083) kd_loss 0.9424 (0.9190) lr 1.7705e-03 eta 0:06:38
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,804
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.0%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,524
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 91.8%
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.1%, epoch: 7 *******
epoch [14/50] batch [20/132] time 0.082 (0.105) data 0.000 (0.016) loss 0.7524 (0.6841) ce_loss 0.2935 (0.2569) teacher_loss 0.2265 (0.1637) loss_zs_kd 0.0807 (0.0726) loss_oracle 0.4855 (0.4841) acc 93.7500 (91.7188) kd_loss 0.9162 (0.9148) lr 1.7290e-03 eta 0:08:28
epoch [14/50] batch [40/132] time 0.090 (0.097) data 0.000 (0.008) loss 0.4744 (0.6499) ce_loss 0.0635 (0.2205) teacher_loss 0.0356 (0.1307) loss_zs_kd 0.0354 (0.0698) loss_oracle 0.4211 (0.4843) acc 100.0000 (92.8125) kd_loss 0.8704 (0.9081) lr 1.7290e-03 eta 0:07:48
epoch [14/50] batch [60/132] time 0.085 (0.094) data 0.000 (0.006) loss 0.6389 (0.6400) ce_loss 0.1339 (0.2072) teacher_loss 0.1056 (0.1187) loss_zs_kd 0.0556 (0.0670) loss_oracle 0.5055 (0.4878) acc 93.7500 (93.1250) kd_loss 0.9131 (0.9137) lr 1.7290e-03 eta 0:07:33
epoch [14/50] batch [80/132] time 0.083 (0.093) data 0.000 (0.004) loss 0.6544 (0.6441) ce_loss 0.1584 (0.2110) teacher_loss 0.0561 (0.1190) loss_zs_kd 0.0817 (0.0686) loss_oracle 0.5575 (0.4908) acc 96.8750 (92.8516) kd_loss 0.9379 (0.9163) lr 1.7290e-03 eta 0:07:24
epoch [14/50] batch [100/132] time 0.087 (0.092) data 0.000 (0.003) loss 0.6868 (0.6452) ce_loss 0.1489 (0.2028) teacher_loss 0.1011 (0.1141) loss_zs_kd 0.0879 (0.0687) loss_oracle 0.5417 (0.4968) acc 93.7500 (93.1875) kd_loss 0.8600 (0.9158) lr 1.7290e-03 eta 0:07:18
epoch [14/50] batch [120/132] time 0.076 (0.091) data 0.000 (0.003) loss 0.6338 (0.6534) ce_loss 0.2428 (0.2040) teacher_loss 0.1147 (0.1177) loss_zs_kd 0.0311 (0.0682) loss_oracle 0.5036 (0.5016) acc 90.6250 (93.0469) kd_loss 0.9323 (0.9169) lr 1.7290e-03 eta 0:07:11
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,806
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.1%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,525
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 91.9%
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.1%, epoch: 7 *******
epoch [15/50] batch [20/132] time 0.087 (0.101) data 0.000 (0.015) loss 0.8127 (0.6640) ce_loss 0.4495 (0.1989) teacher_loss 0.1954 (0.1144) loss_zs_kd 0.0915 (0.0633) loss_oracle 0.5716 (0.5179) acc 84.3750 (92.9688) kd_loss 0.9545 (0.9205) lr 1.6845e-03 eta 0:07:57
epoch [15/50] batch [40/132] time 0.091 (0.092) data 0.000 (0.007) loss 0.4920 (0.6685) ce_loss 0.0685 (0.2271) teacher_loss 0.0589 (0.1353) loss_zs_kd 0.0386 (0.0659) loss_oracle 0.4137 (0.5002) acc 100.0000 (92.1094) kd_loss 0.7946 (0.9102) lr 1.6845e-03 eta 0:07:15
epoch [15/50] batch [60/132] time 0.095 (0.091) data 0.000 (0.005) loss 0.5567 (0.6502) ce_loss 0.1781 (0.2120) teacher_loss 0.0828 (0.1299) loss_zs_kd 0.0491 (0.0642) loss_oracle 0.4494 (0.4883) acc 93.7500 (92.6562) kd_loss 0.8737 (0.9015) lr 1.6845e-03 eta 0:07:05
epoch [15/50] batch [80/132] time 0.081 (0.090) data 0.000 (0.004) loss 0.6271 (0.6423) ce_loss 0.1584 (0.2104) teacher_loss 0.1154 (0.1262) loss_zs_kd 0.0812 (0.0640) loss_oracle 0.4710 (0.4842) acc 93.7500 (92.8516) kd_loss 0.9380 (0.9005) lr 1.6845e-03 eta 0:06:59
epoch [15/50] batch [100/132] time 0.083 (0.089) data 0.000 (0.003) loss 0.6520 (0.6268) ce_loss 0.2744 (0.2039) teacher_loss 0.2092 (0.1220) loss_zs_kd 0.0517 (0.0619) loss_oracle 0.4169 (0.4739) acc 90.6250 (93.1875) kd_loss 0.8188 (0.8919) lr 1.6845e-03 eta 0:06:53
epoch [15/50] batch [120/132] time 0.075 (0.088) data 0.000 (0.003) loss 0.6882 (0.6222) ce_loss 0.2291 (0.1997) teacher_loss 0.1922 (0.1222) loss_zs_kd 0.0395 (0.0605) loss_oracle 0.4763 (0.4697) acc 93.7500 (93.2552) kd_loss 0.8950 (0.8918) lr 1.6845e-03 eta 0:06:48
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,805
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,549
* accuracy: 90.4%
* error: 9.6%
* macro_f1: 92.4%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [16/50] batch [20/132] time 0.074 (0.102) data 0.000 (0.019) loss 0.5398 (0.6388) ce_loss 0.1250 (0.2418) teacher_loss 0.1245 (0.1589) loss_zs_kd 0.0708 (0.0599) loss_oracle 0.3799 (0.4499) acc 96.8750 (91.8750) kd_loss 0.7712 (0.8695) lr 1.6374e-03 eta 0:07:50
epoch [16/50] batch [40/132] time 0.084 (0.093) data 0.000 (0.010) loss 0.5195 (0.6390) ce_loss 0.0688 (0.2120) teacher_loss 0.0522 (0.1379) loss_zs_kd 0.0357 (0.0590) loss_oracle 0.4495 (0.4716) acc 96.8750 (93.1250) kd_loss 0.8388 (0.8895) lr 1.6374e-03 eta 0:07:05
epoch [16/50] batch [60/132] time 0.070 (0.089) data 0.000 (0.007) loss 0.7121 (0.6418) ce_loss 0.3066 (0.2165) teacher_loss 0.1156 (0.1357) loss_zs_kd 0.1094 (0.0606) loss_oracle 0.5418 (0.4757) acc 87.5000 (92.8646) kd_loss 0.9952 (0.8948) lr 1.6374e-03 eta 0:06:46
epoch [16/50] batch [80/132] time 0.076 (0.087) data 0.000 (0.005) loss 0.6678 (0.6441) ce_loss 0.1581 (0.2181) teacher_loss 0.1553 (0.1360) loss_zs_kd 0.0668 (0.0611) loss_oracle 0.4790 (0.4776) acc 93.7500 (92.6953) kd_loss 0.8860 (0.8985) lr 1.6374e-03 eta 0:06:35
epoch [16/50] batch [100/132] time 0.072 (0.085) data 0.000 (0.004) loss 0.6183 (0.6490) ce_loss 0.1747 (0.2177) teacher_loss 0.1008 (0.1359) loss_zs_kd 0.0516 (0.0626) loss_oracle 0.4916 (0.4817) acc 93.7500 (92.6562) kd_loss 0.8090 (0.9008) lr 1.6374e-03 eta 0:06:24
epoch [16/50] batch [120/132] time 0.070 (0.084) data 0.000 (0.003) loss 0.5656 (0.6506) ce_loss 0.1453 (0.2193) teacher_loss 0.0739 (0.1348) loss_zs_kd 0.0519 (0.0630) loss_oracle 0.4658 (0.4843) acc 93.7500 (92.4740) kd_loss 0.8563 (0.8985) lr 1.6374e-03 eta 0:06:15
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,806
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.1%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,513
* accuracy: 89.4%
* error: 10.6%
* macro_f1: 91.7%
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [17/50] batch [20/132] time 0.094 (0.108) data 0.002 (0.019) loss 0.5470 (0.6314) ce_loss 0.0424 (0.1980) teacher_loss 0.0358 (0.1207) loss_zs_kd 0.0433 (0.0502) loss_oracle 0.4895 (0.4856) acc 100.0000 (93.7500) kd_loss 0.9171 (0.8741) lr 1.5878e-03 eta 0:08:03
epoch [17/50] batch [40/132] time 0.081 (0.098) data 0.000 (0.010) loss 0.6309 (0.6468) ce_loss 0.2585 (0.2238) teacher_loss 0.1312 (0.1371) loss_zs_kd 0.0773 (0.0606) loss_oracle 0.4611 (0.4794) acc 90.6250 (92.4219) kd_loss 0.8712 (0.8748) lr 1.5878e-03 eta 0:07:15
epoch [17/50] batch [60/132] time 0.079 (0.093) data 0.000 (0.007) loss 0.5709 (0.6489) ce_loss 0.1754 (0.2253) teacher_loss 0.0897 (0.1345) loss_zs_kd 0.0566 (0.0611) loss_oracle 0.4529 (0.4839) acc 90.6250 (92.3438) kd_loss 0.8730 (0.8833) lr 1.5878e-03 eta 0:06:51
epoch [17/50] batch [80/132] time 0.084 (0.091) data 0.000 (0.005) loss 0.5355 (0.6431) ce_loss 0.0778 (0.2176) teacher_loss 0.0553 (0.1323) loss_zs_kd 0.0216 (0.0622) loss_oracle 0.4694 (0.4797) acc 93.7500 (92.5781) kd_loss 0.8859 (0.8853) lr 1.5878e-03 eta 0:06:39
epoch [17/50] batch [100/132] time 0.084 (0.090) data 0.000 (0.004) loss 0.4920 (0.6393) ce_loss 0.1731 (0.2175) teacher_loss 0.1206 (0.1320) loss_zs_kd 0.0671 (0.0635) loss_oracle 0.3378 (0.4755) acc 93.7500 (92.7188) kd_loss 0.7357 (0.8866) lr 1.5878e-03 eta 0:06:34
epoch [17/50] batch [120/132] time 0.075 (0.089) data 0.000 (0.003) loss 0.4814 (0.6340) ce_loss 0.0878 (0.2104) teacher_loss 0.0414 (0.1307) loss_zs_kd 0.0535 (0.0617) loss_oracle 0.4132 (0.4725) acc 96.8750 (92.8906) kd_loss 0.8874 (0.8896) lr 1.5878e-03 eta 0:06:28
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,803
* accuracy: 99.0%
* error: 1.0%
* macro_f1: 99.0%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,508
* accuracy: 89.3%
* error: 10.7%
* macro_f1: 91.6%
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [18/50] batch [20/132] time 0.079 (0.104) data 0.000 (0.016) loss 0.5421 (0.6132) ce_loss 0.1871 (0.2238) teacher_loss 0.1047 (0.1589) loss_zs_kd 0.0480 (0.0573) loss_oracle 0.4135 (0.4257) acc 93.7500 (92.5000) kd_loss 0.8700 (0.8847) lr 1.5358e-03 eta 0:07:31
epoch [18/50] batch [40/132] time 0.084 (0.096) data 0.000 (0.008) loss 0.6936 (0.6030) ce_loss 0.3401 (0.2065) teacher_loss 0.2092 (0.1463) loss_zs_kd 0.0588 (0.0559) loss_oracle 0.4550 (0.4287) acc 87.5000 (92.9688) kd_loss 0.8893 (0.8840) lr 1.5358e-03 eta 0:06:52
epoch [18/50] batch [60/132] time 0.090 (0.091) data 0.000 (0.006) loss 0.4508 (0.5936) ce_loss 0.0313 (0.1972) teacher_loss 0.0198 (0.1389) loss_zs_kd 0.0235 (0.0538) loss_oracle 0.4192 (0.4278) acc 100.0000 (93.3854) kd_loss 0.8530 (0.8757) lr 1.5358e-03 eta 0:06:29
epoch [18/50] batch [80/132] time 0.085 (0.088) data 0.000 (0.004) loss 0.5343 (0.6074) ce_loss 0.2271 (0.2100) teacher_loss 0.1215 (0.1462) loss_zs_kd 0.0561 (0.0547) loss_oracle 0.3847 (0.4339) acc 96.8750 (93.0469) kd_loss 0.8730 (0.8757) lr 1.5358e-03 eta 0:06:16
epoch [18/50] batch [100/132] time 0.078 (0.085) data 0.000 (0.004) loss 0.5027 (0.6035) ce_loss 0.0863 (0.2013) teacher_loss 0.0396 (0.1409) loss_zs_kd 0.0454 (0.0542) loss_oracle 0.4404 (0.4354) acc 96.8750 (93.2500) kd_loss 0.8897 (0.8745) lr 1.5358e-03 eta 0:06:03
epoch [18/50] batch [120/132] time 0.070 (0.083) data 0.000 (0.003) loss 0.5225 (0.6038) ce_loss 0.1965 (0.2015) teacher_loss 0.1207 (0.1429) loss_zs_kd 0.0399 (0.0545) loss_oracle 0.3819 (0.4336) acc 90.6250 (93.2552) kd_loss 0.7960 (0.8671) lr 1.5358e-03 eta 0:05:53
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,807
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.2%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,514
* accuracy: 89.5%
* error: 10.5%
* macro_f1: 91.8%
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [19/50] batch [20/132] time 0.072 (0.099) data 0.000 (0.020) loss 0.5928 (0.6263) ce_loss 0.3333 (0.2244) teacher_loss 0.1268 (0.1525) loss_zs_kd 0.0968 (0.0557) loss_oracle 0.4176 (0.4460) acc 90.6250 (92.3438) kd_loss 0.7734 (0.8596) lr 1.4818e-03 eta 0:06:57
epoch [19/50] batch [40/132] time 0.080 (0.089) data 0.000 (0.010) loss 0.4099 (0.6037) ce_loss 0.0134 (0.1932) teacher_loss 0.0143 (0.1309) loss_zs_kd 0.0181 (0.0553) loss_oracle 0.3866 (0.4452) acc 100.0000 (93.5156) kd_loss 0.7890 (0.8531) lr 1.4818e-03 eta 0:06:13
epoch [19/50] batch [60/132] time 0.079 (0.086) data 0.001 (0.007) loss 0.7016 (0.5985) ce_loss 0.2450 (0.1970) teacher_loss 0.2131 (0.1391) loss_zs_kd 0.0482 (0.0543) loss_oracle 0.4643 (0.4323) acc 93.7500 (93.2292) kd_loss 0.8469 (0.8456) lr 1.4818e-03 eta 0:05:58
epoch [19/50] batch [80/132] time 0.089 (0.085) data 0.000 (0.005) loss 0.4589 (0.5823) ce_loss 0.0681 (0.1884) teacher_loss 0.0460 (0.1340) loss_zs_kd 0.0394 (0.0524) loss_oracle 0.3932 (0.4221) acc 96.8750 (93.5938) kd_loss 0.8350 (0.8446) lr 1.4818e-03 eta 0:05:50
epoch [19/50] batch [100/132] time 0.091 (0.083) data 0.000 (0.004) loss 0.7208 (0.5804) ce_loss 0.3503 (0.1913) teacher_loss 0.3439 (0.1384) loss_zs_kd 0.0764 (0.0519) loss_oracle 0.3387 (0.4161) acc 90.6250 (93.6875) kd_loss 0.8711 (0.8519) lr 1.4818e-03 eta 0:05:43
epoch [19/50] batch [120/132] time 0.078 (0.084) data 0.000 (0.004) loss 0.6373 (0.5833) ce_loss 0.3718 (0.1982) teacher_loss 0.2546 (0.1449) loss_zs_kd 0.0716 (0.0526) loss_oracle 0.3469 (0.4121) acc 90.6250 (93.6719) kd_loss 0.8263 (0.8530) lr 1.4818e-03 eta 0:05:43
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,807
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.2%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,527
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 92.0%
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [20/50] batch [20/132] time 0.062 (0.095) data 0.000 (0.018) loss 0.3791 (0.5400) ce_loss 0.0379 (0.1830) teacher_loss 0.0238 (0.1329) loss_zs_kd 0.0289 (0.0471) loss_oracle 0.3409 (0.3836) acc 100.0000 (94.0625) kd_loss 0.7888 (0.8604) lr 1.4258e-03 eta 0:06:25
epoch [20/50] batch [40/132] time 0.082 (0.082) data 0.000 (0.009) loss 0.5548 (0.5529) ce_loss 0.1666 (0.1837) teacher_loss 0.1586 (0.1373) loss_zs_kd 0.0408 (0.0496) loss_oracle 0.3758 (0.3908) acc 93.7500 (94.2188) kd_loss 0.8303 (0.8590) lr 1.4258e-03 eta 0:05:32
epoch [20/50] batch [60/132] time 0.072 (0.079) data 0.001 (0.006) loss 0.5939 (0.5514) ce_loss 0.2318 (0.1800) teacher_loss 0.1353 (0.1337) loss_zs_kd 0.0648 (0.0495) loss_oracle 0.4262 (0.3930) acc 93.7500 (94.2708) kd_loss 0.8840 (0.8592) lr 1.4258e-03 eta 0:05:17
epoch [20/50] batch [80/132] time 0.084 (0.079) data 0.000 (0.005) loss 0.6771 (0.5509) ce_loss 0.2939 (0.1794) teacher_loss 0.2783 (0.1309) loss_zs_kd 0.0315 (0.0492) loss_oracle 0.3831 (0.3954) acc 90.6250 (94.2969) kd_loss 0.8470 (0.8591) lr 1.4258e-03 eta 0:05:16
epoch [20/50] batch [100/132] time 0.059 (0.078) data 0.000 (0.004) loss 0.6963 (0.5636) ce_loss 0.2391 (0.1861) teacher_loss 0.2398 (0.1349) loss_zs_kd 0.0592 (0.0500) loss_oracle 0.4269 (0.4037) acc 87.5000 (93.9375) kd_loss 0.9815 (0.8664) lr 1.4258e-03 eta 0:05:09
epoch [20/50] batch [120/132] time 0.064 (0.076) data 0.000 (0.003) loss 0.5049 (0.5713) ce_loss 0.0886 (0.1895) teacher_loss 0.0664 (0.1356) loss_zs_kd 0.0657 (0.0510) loss_oracle 0.4057 (0.4102) acc 100.0000 (93.8021) kd_loss 0.8799 (0.8676) lr 1.4258e-03 eta 0:05:03
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,806
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.1%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,518
* accuracy: 89.6%
* error: 10.4%
* macro_f1: 91.9%
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [21/50] batch [20/132] time 0.081 (0.093) data 0.000 (0.014) loss 0.7127 (0.6294) ce_loss 0.2607 (0.2189) teacher_loss 0.1489 (0.1501) loss_zs_kd 0.0847 (0.0653) loss_oracle 0.5215 (0.4466) acc 90.6250 (92.5000) kd_loss 0.9254 (0.9065) lr 1.3681e-03 eta 0:06:06
epoch [21/50] batch [40/132] time 0.076 (0.085) data 0.000 (0.007) loss 0.5397 (0.6174) ce_loss 0.0753 (0.2018) teacher_loss 0.0421 (0.1429) loss_zs_kd 0.0613 (0.0637) loss_oracle 0.4670 (0.4427) acc 100.0000 (92.9688) kd_loss 0.8954 (0.8749) lr 1.3681e-03 eta 0:05:35
epoch [21/50] batch [60/132] time 0.080 (0.083) data 0.001 (0.005) loss 0.6309 (0.6137) ce_loss 0.2145 (0.2047) teacher_loss 0.1378 (0.1427) loss_zs_kd 0.0579 (0.0607) loss_oracle 0.4641 (0.4407) acc 93.7500 (93.0729) kd_loss 0.8700 (0.8757) lr 1.3681e-03 eta 0:05:24
epoch [21/50] batch [80/132] time 0.082 (0.082) data 0.000 (0.004) loss 0.9362 (0.6121) ce_loss 0.4688 (0.2016) teacher_loss 0.2922 (0.1405) loss_zs_kd 0.0570 (0.0591) loss_oracle 0.6155 (0.4421) acc 84.3750 (93.2812) kd_loss 0.9999 (0.8793) lr 1.3681e-03 eta 0:05:19
epoch [21/50] batch [100/132] time 0.066 (0.081) data 0.000 (0.003) loss 0.6312 (0.6121) ce_loss 0.3145 (0.2108) teacher_loss 0.2390 (0.1448) loss_zs_kd 0.0588 (0.0599) loss_oracle 0.3629 (0.4374) acc 87.5000 (93.0625) kd_loss 0.8732 (0.8794) lr 1.3681e-03 eta 0:05:14
epoch [21/50] batch [120/132] time 0.078 (0.081) data 0.000 (0.003) loss 0.5849 (0.6097) ce_loss 0.1748 (0.2106) teacher_loss 0.1779 (0.1444) loss_zs_kd 0.0374 (0.0591) loss_oracle 0.3884 (0.4357) acc 93.7500 (92.9427) kd_loss 0.8693 (0.8836) lr 1.3681e-03 eta 0:05:12
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,804
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.0%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,548
* accuracy: 90.3%
* error: 9.7%
* macro_f1: 92.4%
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [22/50] batch [20/132] time 0.080 (0.101) data 0.000 (0.017) loss 0.7426 (0.5963) ce_loss 0.3840 (0.1894) teacher_loss 0.3177 (0.1233) loss_zs_kd 0.0423 (0.0581) loss_oracle 0.4037 (0.4440) acc 87.5000 (93.4375) kd_loss 0.9044 (0.8892) lr 1.3090e-03 eta 0:06:26
epoch [22/50] batch [40/132] time 0.086 (0.093) data 0.000 (0.009) loss 0.6690 (0.5966) ce_loss 0.2661 (0.1960) teacher_loss 0.1716 (0.1251) loss_zs_kd 0.0705 (0.0560) loss_oracle 0.4621 (0.4435) acc 87.5000 (93.3594) kd_loss 0.9286 (0.8901) lr 1.3090e-03 eta 0:05:53
epoch [22/50] batch [60/132] time 0.083 (0.090) data 0.001 (0.006) loss 0.5089 (0.5968) ce_loss 0.1028 (0.1962) teacher_loss 0.0448 (0.1278) loss_zs_kd 0.0416 (0.0597) loss_oracle 0.4433 (0.4391) acc 93.7500 (93.4375) kd_loss 0.8457 (0.8821) lr 1.3090e-03 eta 0:05:38
epoch [22/50] batch [80/132] time 0.080 (0.088) data 0.000 (0.004) loss 0.5333 (0.5969) ce_loss 0.2067 (0.1961) teacher_loss 0.1325 (0.1295) loss_zs_kd 0.0579 (0.0579) loss_oracle 0.3719 (0.4384) acc 93.7500 (93.4766) kd_loss 0.7954 (0.8825) lr 1.3090e-03 eta 0:05:30
epoch [22/50] batch [100/132] time 0.081 (0.087) data 0.000 (0.004) loss 0.5088 (0.5945) ce_loss 0.0361 (0.1889) teacher_loss 0.0180 (0.1253) loss_zs_kd 0.0560 (0.0564) loss_oracle 0.4628 (0.4410) acc 100.0000 (93.8125) kd_loss 0.8941 (0.8853) lr 1.3090e-03 eta 0:05:24
epoch [22/50] batch [120/132] time 0.074 (0.086) data 0.000 (0.003) loss 0.6285 (0.5965) ce_loss 0.2632 (0.1890) teacher_loss 0.2116 (0.1269) loss_zs_kd 0.0560 (0.0566) loss_oracle 0.3889 (0.4413) acc 90.6250 (93.8281) kd_loss 0.7859 (0.8857) lr 1.3090e-03 eta 0:05:18
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.2%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,538
* accuracy: 90.1%
* error: 9.9%
* macro_f1: 92.1%
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [23/50] batch [20/132] time 0.086 (0.109) data 0.000 (0.018) loss 0.8171 (0.6307) ce_loss 0.3914 (0.2143) teacher_loss 0.3966 (0.1551) loss_zs_kd 0.0734 (0.0605) loss_oracle 0.3838 (0.4453) acc 84.3750 (92.1875) kd_loss 0.8624 (0.8850) lr 1.2487e-03 eta 0:06:39
epoch [23/50] batch [40/132] time 0.082 (0.098) data 0.000 (0.009) loss 0.5478 (0.6067) ce_loss 0.1364 (0.2065) teacher_loss 0.1170 (0.1479) loss_zs_kd 0.0529 (0.0557) loss_oracle 0.4044 (0.4310) acc 96.8750 (92.7344) kd_loss 0.8418 (0.8807) lr 1.2487e-03 eta 0:05:56
epoch [23/50] batch [60/132] time 0.077 (0.093) data 0.001 (0.006) loss 0.5128 (0.5978) ce_loss 0.0920 (0.1986) teacher_loss 0.0546 (0.1405) loss_zs_kd 0.0332 (0.0523) loss_oracle 0.4416 (0.4312) acc 96.8750 (93.1771) kd_loss 0.8811 (0.8818) lr 1.2487e-03 eta 0:05:36
epoch [23/50] batch [80/132] time 0.078 (0.090) data 0.000 (0.005) loss 0.5653 (0.6039) ce_loss 0.1266 (0.2048) teacher_loss 0.0710 (0.1412) loss_zs_kd 0.0449 (0.0539) loss_oracle 0.4718 (0.4358) acc 96.8750 (92.9688) kd_loss 0.8854 (0.8839) lr 1.2487e-03 eta 0:05:25
epoch [23/50] batch [100/132] time 0.078 (0.088) data 0.000 (0.004) loss 0.4290 (0.6061) ce_loss 0.0215 (0.2043) teacher_loss 0.0270 (0.1396) loss_zs_kd 0.0262 (0.0541) loss_oracle 0.3889 (0.4394) acc 100.0000 (92.9688) kd_loss 0.8562 (0.8861) lr 1.2487e-03 eta 0:05:17
epoch [23/50] batch [120/132] time 0.074 (0.087) data 0.000 (0.003) loss 0.5403 (0.6106) ce_loss 0.1147 (0.2080) teacher_loss 0.0916 (0.1407) loss_zs_kd 0.0485 (0.0559) loss_oracle 0.4245 (0.4419) acc 96.8750 (92.8125) kd_loss 0.7949 (0.8869) lr 1.2487e-03 eta 0:05:11
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,804
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.0%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,522
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 91.9%
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [24/50] batch [20/132] time 0.087 (0.104) data 0.000 (0.016) loss 0.5963 (0.6030) ce_loss 0.2328 (0.2061) teacher_loss 0.0778 (0.1295) loss_zs_kd 0.1208 (0.0648) loss_oracle 0.4581 (0.4411) acc 93.7500 (93.2812) kd_loss 0.9520 (0.9060) lr 1.1874e-03 eta 0:06:09
epoch [24/50] batch [40/132] time 0.092 (0.094) data 0.000 (0.008) loss 0.6318 (0.6160) ce_loss 0.1490 (0.2106) teacher_loss 0.0581 (0.1316) loss_zs_kd 0.0437 (0.0652) loss_oracle 0.5519 (0.4518) acc 93.7500 (92.7344) kd_loss 0.9452 (0.9117) lr 1.1874e-03 eta 0:05:32
epoch [24/50] batch [60/132] time 0.084 (0.092) data 0.000 (0.006) loss 0.7796 (0.6208) ce_loss 0.3567 (0.2068) teacher_loss 0.2659 (0.1353) loss_zs_kd 0.0392 (0.0645) loss_oracle 0.4940 (0.4533) acc 87.5000 (93.1771) kd_loss 0.9628 (0.9047) lr 1.1874e-03 eta 0:05:22
epoch [24/50] batch [80/132] time 0.097 (0.091) data 0.000 (0.004) loss 0.6196 (0.6240) ce_loss 0.1274 (0.2101) teacher_loss 0.1109 (0.1390) loss_zs_kd 0.0506 (0.0636) loss_oracle 0.4834 (0.4532) acc 96.8750 (92.7734) kd_loss 0.9349 (0.8996) lr 1.1874e-03 eta 0:05:18
epoch [24/50] batch [100/132] time 0.093 (0.090) data 0.000 (0.003) loss 0.6382 (0.6126) ce_loss 0.2852 (0.1994) teacher_loss 0.2197 (0.1342) loss_zs_kd 0.0675 (0.0618) loss_oracle 0.3847 (0.4475) acc 93.7500 (93.2500) kd_loss 0.8817 (0.8976) lr 1.1874e-03 eta 0:05:13
epoch [24/50] batch [120/132] time 0.086 (0.090) data 0.001 (0.003) loss 0.5292 (0.6050) ce_loss 0.1525 (0.1952) teacher_loss 0.0950 (0.1334) loss_zs_kd 0.0731 (0.0582) loss_oracle 0.3976 (0.4425) acc 96.8750 (93.3594) kd_loss 0.7952 (0.8972) lr 1.1874e-03 eta 0:05:08
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,807
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.2%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,493
* accuracy: 88.9%
* error: 11.1%
* macro_f1: 91.3%
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [25/50] batch [20/132] time 0.075 (0.094) data 0.000 (0.017) loss 0.5736 (0.5686) ce_loss 0.1658 (0.1785) teacher_loss 0.0842 (0.1263) loss_zs_kd 0.0544 (0.0434) loss_oracle 0.4623 (0.4206) acc 96.8750 (94.0625) kd_loss 0.8675 (0.8766) lr 1.1253e-03 eta 0:05:21
epoch [25/50] batch [40/132] time 0.081 (0.086) data 0.000 (0.009) loss 0.7024 (0.5847) ce_loss 0.2935 (0.1912) teacher_loss 0.2326 (0.1322) loss_zs_kd 0.0328 (0.0454) loss_oracle 0.4534 (0.4298) acc 90.6250 (93.6719) kd_loss 0.9745 (0.8716) lr 1.1253e-03 eta 0:04:51
epoch [25/50] batch [60/132] time 0.079 (0.083) data 0.000 (0.006) loss 0.7648 (0.5899) ce_loss 0.3516 (0.1880) teacher_loss 0.2348 (0.1276) loss_zs_kd 0.1007 (0.0489) loss_oracle 0.4797 (0.4378) acc 84.3750 (93.9062) kd_loss 0.8419 (0.8729) lr 1.1253e-03 eta 0:04:39
epoch [25/50] batch [80/132] time 0.089 (0.082) data 0.000 (0.004) loss 0.5169 (0.5949) ce_loss 0.1570 (0.1907) teacher_loss 0.0919 (0.1294) loss_zs_kd 0.0505 (0.0490) loss_oracle 0.3997 (0.4410) acc 96.8750 (93.7891) kd_loss 0.8800 (0.8719) lr 1.1253e-03 eta 0:04:35
epoch [25/50] batch [100/132] time 0.075 (0.081) data 0.000 (0.004) loss 0.6623 (0.5957) ce_loss 0.1479 (0.1891) teacher_loss 0.1226 (0.1294) loss_zs_kd 0.0668 (0.0507) loss_oracle 0.5063 (0.4410) acc 93.7500 (94.0000) kd_loss 0.8714 (0.8723) lr 1.1253e-03 eta 0:04:30
epoch [25/50] batch [120/132] time 0.077 (0.081) data 0.001 (0.003) loss 0.6154 (0.5993) ce_loss 0.2162 (0.1939) teacher_loss 0.1925 (0.1310) loss_zs_kd 0.0564 (0.0521) loss_oracle 0.3947 (0.4422) acc 93.7500 (93.6979) kd_loss 0.8769 (0.8736) lr 1.1253e-03 eta 0:04:27
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,519
* accuracy: 89.6%
* error: 10.4%
* macro_f1: 91.8%
******* Domain s best val acc:      99.3%, epoch: 9 *******
******* Domain s best val test acc: 89.2%, epoch: 9 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [26/50] batch [20/132] time 0.083 (0.105) data 0.000 (0.019) loss 0.4624 (0.5731) ce_loss 0.1296 (0.1583) teacher_loss 0.0766 (0.1103) loss_zs_kd 0.0475 (0.0463) loss_oracle 0.3621 (0.4397) acc 93.7500 (94.6875) kd_loss 0.8137 (0.8818) lr 1.0628e-03 eta 0:05:44
epoch [26/50] batch [40/132] time 0.089 (0.094) data 0.000 (0.010) loss 0.7428 (0.6071) ce_loss 0.4177 (0.2010) teacher_loss 0.2790 (0.1458) loss_zs_kd 0.0637 (0.0515) loss_oracle 0.4320 (0.4355) acc 87.5000 (93.5156) kd_loss 0.8324 (0.8834) lr 1.0628e-03 eta 0:05:06
epoch [26/50] batch [60/132] time 0.082 (0.091) data 0.000 (0.007) loss 0.6704 (0.6250) ce_loss 0.2252 (0.2139) teacher_loss 0.1759 (0.1551) loss_zs_kd 0.0482 (0.0546) loss_oracle 0.4704 (0.4427) acc 93.7500 (92.9688) kd_loss 0.8825 (0.8833) lr 1.0628e-03 eta 0:04:54
epoch [26/50] batch [80/132] time 0.091 (0.090) data 0.000 (0.005) loss 0.6029 (0.6315) ce_loss 0.1166 (0.2145) teacher_loss 0.0886 (0.1557) loss_zs_kd 0.0876 (0.0573) loss_oracle 0.4706 (0.4472) acc 96.8750 (92.9297) kd_loss 0.8638 (0.8804) lr 1.0628e-03 eta 0:04:48
epoch [26/50] batch [100/132] time 0.085 (0.089) data 0.000 (0.004) loss 0.4370 (0.6322) ce_loss 0.1182 (0.2148) teacher_loss 0.0513 (0.1573) loss_zs_kd 0.0385 (0.0558) loss_oracle 0.3664 (0.4470) acc 93.7500 (92.9375) kd_loss 0.8056 (0.8753) lr 1.0628e-03 eta 0:04:45
epoch [26/50] batch [120/132] time 0.072 (0.089) data 0.000 (0.003) loss 0.5338 (0.6297) ce_loss 0.1016 (0.2125) teacher_loss 0.0763 (0.1542) loss_zs_kd 0.0372 (0.0549) loss_oracle 0.4389 (0.4482) acc 100.0000 (92.9167) kd_loss 0.8039 (0.8746) lr 1.0628e-03 eta 0:04:41
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,810
* accuracy: 99.4%
* error: 0.6%
* macro_f1: 99.4%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,529
* accuracy: 89.8%
* error: 10.2%
* macro_f1: 92.1%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [27/50] batch [20/132] time 0.088 (0.101) data 0.000 (0.015) loss 0.6099 (0.6336) ce_loss 0.1753 (0.2071) teacher_loss 0.0903 (0.1478) loss_zs_kd 0.0296 (0.0585) loss_oracle 0.5048 (0.4566) acc 96.8750 (92.1875) kd_loss 0.9715 (0.8740) lr 1.0000e-03 eta 0:05:17
epoch [27/50] batch [40/132] time 0.103 (0.095) data 0.000 (0.008) loss 0.5362 (0.6306) ce_loss 0.0974 (0.1974) teacher_loss 0.0750 (0.1437) loss_zs_kd 0.0329 (0.0585) loss_oracle 0.4448 (0.4576) acc 96.8750 (92.6562) kd_loss 0.9733 (0.8769) lr 1.0000e-03 eta 0:04:56
epoch [27/50] batch [60/132] time 0.095 (0.094) data 0.001 (0.005) loss 0.5157 (0.6327) ce_loss 0.0368 (0.2010) teacher_loss 0.0381 (0.1425) loss_zs_kd 0.0551 (0.0574) loss_oracle 0.4500 (0.4615) acc 100.0000 (92.9167) kd_loss 0.8915 (0.8806) lr 1.0000e-03 eta 0:04:51
epoch [27/50] batch [80/132] time 0.085 (0.092) data 0.000 (0.004) loss 0.5371 (0.6284) ce_loss 0.1204 (0.1950) teacher_loss 0.0790 (0.1384) loss_zs_kd 0.0560 (0.0571) loss_oracle 0.4301 (0.4615) acc 96.8750 (93.1250) kd_loss 0.8338 (0.8842) lr 1.0000e-03 eta 0:04:45
epoch [27/50] batch [100/132] time 0.091 (0.091) data 0.000 (0.003) loss 0.7420 (0.6351) ce_loss 0.2018 (0.2003) teacher_loss 0.2067 (0.1437) loss_zs_kd 0.0358 (0.0561) loss_oracle 0.5174 (0.4634) acc 90.6250 (92.9375) kd_loss 0.8705 (0.8893) lr 1.0000e-03 eta 0:04:39
epoch [27/50] batch [120/132] time 0.081 (0.090) data 0.000 (0.003) loss 0.5632 (0.6375) ce_loss 0.1084 (0.2009) teacher_loss 0.0835 (0.1440) loss_zs_kd 0.0449 (0.0550) loss_oracle 0.4573 (0.4660) acc 96.8750 (92.9948) kd_loss 1.0152 (0.8954) lr 1.0000e-03 eta 0:04:34
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,500
* accuracy: 89.1%
* error: 10.9%
* macro_f1: 91.5%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [28/50] batch [20/132] time 0.084 (0.104) data 0.000 (0.015) loss 0.6148 (0.6738) ce_loss 0.1821 (0.1954) teacher_loss 0.0818 (0.1244) loss_zs_kd 0.0540 (0.0547) loss_oracle 0.5060 (0.5220) acc 93.7500 (93.5938) kd_loss 1.0080 (0.9343) lr 9.3721e-04 eta 0:05:12
epoch [28/50] batch [40/132] time 0.091 (0.096) data 0.001 (0.007) loss 0.7230 (0.6787) ce_loss 0.2590 (0.2027) teacher_loss 0.1672 (0.1365) loss_zs_kd 0.0844 (0.0570) loss_oracle 0.5136 (0.5137) acc 90.6250 (93.3594) kd_loss 0.9400 (0.9313) lr 9.3721e-04 eta 0:04:46
epoch [28/50] batch [60/132] time 0.087 (0.092) data 0.001 (0.005) loss 0.5794 (0.6751) ce_loss 0.0369 (0.2033) teacher_loss 0.0232 (0.1431) loss_zs_kd 0.0342 (0.0555) loss_oracle 0.5391 (0.5043) acc 100.0000 (93.2292) kd_loss 0.9473 (0.9333) lr 9.3721e-04 eta 0:04:33
epoch [28/50] batch [80/132] time 0.088 (0.091) data 0.001 (0.004) loss 0.9841 (0.6728) ce_loss 0.5796 (0.2056) teacher_loss 0.3644 (0.1429) loss_zs_kd 0.0724 (0.0545) loss_oracle 0.5835 (0.5027) acc 78.1250 (93.0859) kd_loss 1.0522 (0.9313) lr 9.3721e-04 eta 0:04:27
epoch [28/50] batch [100/132] time 0.086 (0.090) data 0.000 (0.003) loss 0.6138 (0.6629) ce_loss 0.1482 (0.1959) teacher_loss 0.0912 (0.1350) loss_zs_kd 0.0593 (0.0543) loss_oracle 0.4930 (0.5008) acc 93.7500 (93.5938) kd_loss 0.9314 (0.9299) lr 9.3721e-04 eta 0:04:24
epoch [28/50] batch [120/132] time 0.073 (0.089) data 0.000 (0.003) loss 0.5751 (0.6640) ce_loss 0.1924 (0.1957) teacher_loss 0.0615 (0.1352) loss_zs_kd 0.0727 (0.0543) loss_oracle 0.4772 (0.5016) acc 93.7500 (93.5938) kd_loss 0.9376 (0.9304) lr 9.3721e-04 eta 0:04:20
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,806
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.2%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,494
* accuracy: 89.0%
* error: 11.0%
* macro_f1: 91.4%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [29/50] batch [20/132] time 0.080 (0.108) data 0.000 (0.019) loss 0.6325 (0.6706) ce_loss 0.1787 (0.2061) teacher_loss 0.1690 (0.1432) loss_zs_kd 0.0364 (0.0487) loss_oracle 0.4453 (0.5030) acc 93.7500 (93.1250) kd_loss 0.9093 (0.9525) lr 8.7467e-04 eta 0:05:11
epoch [29/50] batch [40/132] time 0.084 (0.097) data 0.000 (0.010) loss 0.6110 (0.6847) ce_loss 0.0717 (0.2340) teacher_loss 0.0479 (0.1585) loss_zs_kd 0.0459 (0.0511) loss_oracle 0.5401 (0.5007) acc 96.8750 (92.6562) kd_loss 0.9689 (0.9561) lr 8.7467e-04 eta 0:04:38
epoch [29/50] batch [60/132] time 0.091 (0.094) data 0.001 (0.007) loss 0.7934 (0.6736) ce_loss 0.3257 (0.2109) teacher_loss 0.2281 (0.1441) loss_zs_kd 0.0488 (0.0524) loss_oracle 0.5409 (0.5033) acc 90.6250 (93.0729) kd_loss 0.9793 (0.9580) lr 8.7467e-04 eta 0:04:26
epoch [29/50] batch [80/132] time 0.087 (0.092) data 0.000 (0.005) loss 0.4987 (0.6665) ce_loss 0.0484 (0.2066) teacher_loss 0.0311 (0.1426) loss_zs_kd 0.0591 (0.0540) loss_oracle 0.4380 (0.4969) acc 100.0000 (93.2422) kd_loss 0.9362 (0.9569) lr 8.7467e-04 eta 0:04:20
epoch [29/50] batch [100/132] time 0.089 (0.091) data 0.001 (0.004) loss 0.7219 (0.6604) ce_loss 0.2979 (0.2033) teacher_loss 0.1691 (0.1391) loss_zs_kd 0.0733 (0.0541) loss_oracle 0.5161 (0.4942) acc 90.6250 (93.0938) kd_loss 0.8859 (0.9556) lr 8.7467e-04 eta 0:04:15
epoch [29/50] batch [120/132] time 0.078 (0.091) data 0.000 (0.004) loss 0.7963 (0.6593) ce_loss 0.2297 (0.2024) teacher_loss 0.2133 (0.1360) loss_zs_kd 0.0593 (0.0548) loss_oracle 0.5533 (0.4959) acc 93.7500 (93.2292) kd_loss 0.9936 (0.9579) lr 8.7467e-04 eta 0:04:12
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,805
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,492
* accuracy: 88.9%
* error: 11.1%
* macro_f1: 91.4%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [30/50] batch [20/132] time 0.078 (0.101) data 0.000 (0.018) loss 0.6739 (0.6367) ce_loss 0.0957 (0.1861) teacher_loss 0.0843 (0.1227) loss_zs_kd 0.0657 (0.0606) loss_oracle 0.5568 (0.4838) acc 96.8750 (93.9062) kd_loss 0.9915 (0.9563) lr 8.1262e-04 eta 0:04:38
epoch [30/50] batch [40/132] time 0.057 (0.088) data 0.000 (0.009) loss 0.4541 (0.6551) ce_loss 0.0534 (0.2013) teacher_loss 0.0300 (0.1292) loss_zs_kd 0.0468 (0.0610) loss_oracle 0.4007 (0.4954) acc 96.8750 (93.2812) kd_loss 0.9564 (0.9629) lr 8.1262e-04 eta 0:04:01
epoch [30/50] batch [60/132] time 0.082 (0.085) data 0.001 (0.006) loss 0.7939 (0.6663) ce_loss 0.3718 (0.2142) teacher_loss 0.2390 (0.1367) loss_zs_kd 0.0822 (0.0636) loss_oracle 0.5138 (0.4977) acc 84.3750 (92.9688) kd_loss 0.9428 (0.9639) lr 8.1262e-04 eta 0:03:50
epoch [30/50] batch [80/132] time 0.085 (0.082) data 0.000 (0.005) loss 0.6557 (0.6669) ce_loss 0.2446 (0.2134) teacher_loss 0.1403 (0.1375) loss_zs_kd 0.0676 (0.0632) loss_oracle 0.4816 (0.4978) acc 90.6250 (92.9297) kd_loss 0.9649 (0.9693) lr 8.1262e-04 eta 0:03:41
epoch [30/50] batch [100/132] time 0.077 (0.081) data 0.000 (0.004) loss 0.8072 (0.6659) ce_loss 0.3071 (0.2078) teacher_loss 0.3125 (0.1347) loss_zs_kd 0.0427 (0.0630) loss_oracle 0.4734 (0.4998) acc 90.6250 (93.1875) kd_loss 1.0017 (0.9685) lr 8.1262e-04 eta 0:03:36
epoch [30/50] batch [120/132] time 0.076 (0.081) data 0.000 (0.003) loss 0.6767 (0.6674) ce_loss 0.1963 (0.2102) teacher_loss 0.1664 (0.1356) loss_zs_kd 0.0658 (0.0632) loss_oracle 0.4774 (0.5002) acc 93.7500 (93.1510) kd_loss 0.8735 (0.9670) lr 8.1262e-04 eta 0:03:34
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,807
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.2%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,503
* accuracy: 89.2%
* error: 10.8%
* macro_f1: 91.6%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [31/50] batch [20/132] time 0.081 (0.100) data 0.000 (0.016) loss 0.7304 (0.6974) ce_loss 0.2891 (0.2242) teacher_loss 0.1854 (0.1437) loss_zs_kd 0.0498 (0.0615) loss_oracle 0.5201 (0.5229) acc 93.7500 (91.8750) kd_loss 0.9282 (0.9772) lr 7.5131e-04 eta 0:04:22
epoch [31/50] batch [40/132] time 0.085 (0.091) data 0.000 (0.008) loss 0.6581 (0.6924) ce_loss 0.2174 (0.2157) teacher_loss 0.1213 (0.1388) loss_zs_kd 0.0623 (0.0641) loss_oracle 0.5056 (0.5215) acc 93.7500 (92.4219) kd_loss 1.0481 (0.9748) lr 7.5131e-04 eta 0:03:57
epoch [31/50] batch [60/132] time 0.084 (0.089) data 0.000 (0.005) loss 0.7909 (0.6922) ce_loss 0.3079 (0.2158) teacher_loss 0.2612 (0.1404) loss_zs_kd 0.0566 (0.0646) loss_oracle 0.5015 (0.5194) acc 87.5000 (92.5000) kd_loss 0.9102 (0.9691) lr 7.5131e-04 eta 0:03:48
epoch [31/50] batch [80/132] time 0.084 (0.087) data 0.000 (0.004) loss 0.5165 (0.6812) ce_loss 0.0949 (0.2076) teacher_loss 0.0595 (0.1331) loss_zs_kd 0.0285 (0.0620) loss_oracle 0.4427 (0.5171) acc 93.7500 (92.7734) kd_loss 0.8749 (0.9679) lr 7.5131e-04 eta 0:03:42
epoch [31/50] batch [100/132] time 0.084 (0.086) data 0.000 (0.003) loss 0.5299 (0.6785) ce_loss 0.0830 (0.2057) teacher_loss 0.0460 (0.1315) loss_zs_kd 0.0355 (0.0616) loss_oracle 0.4661 (0.5162) acc 96.8750 (92.7812) kd_loss 0.8568 (0.9664) lr 7.5131e-04 eta 0:03:39
epoch [31/50] batch [120/132] time 0.076 (0.086) data 0.000 (0.003) loss 0.6212 (0.6762) ce_loss 0.2959 (0.2057) teacher_loss 0.1992 (0.1320) loss_zs_kd 0.0304 (0.0621) loss_oracle 0.4068 (0.5131) acc 93.7500 (92.9427) kd_loss 0.9503 (0.9668) lr 7.5131e-04 eta 0:03:36
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.2%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,522
* accuracy: 89.7%
* error: 10.3%
* macro_f1: 92.0%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [32/50] batch [20/132] time 0.075 (0.095) data 0.000 (0.015) loss 0.5927 (0.6800) ce_loss 0.1077 (0.1783) teacher_loss 0.0775 (0.1269) loss_zs_kd 0.0459 (0.0643) loss_oracle 0.4923 (0.5209) acc 100.0000 (94.3750) kd_loss 0.9239 (0.9554) lr 6.9098e-04 eta 0:03:55
epoch [32/50] batch [40/132] time 0.082 (0.083) data 0.000 (0.008) loss 0.6652 (0.7011) ce_loss 0.2124 (0.2031) teacher_loss 0.1132 (0.1336) loss_zs_kd 0.0686 (0.0635) loss_oracle 0.5177 (0.5357) acc 93.7500 (93.2812) kd_loss 0.9504 (0.9734) lr 6.9098e-04 eta 0:03:24
epoch [32/50] batch [60/132] time 0.071 (0.079) data 0.000 (0.005) loss 0.6408 (0.7077) ce_loss 0.0714 (0.2048) teacher_loss 0.0651 (0.1310) loss_zs_kd 0.0706 (0.0630) loss_oracle 0.5404 (0.5451) acc 100.0000 (93.2812) kd_loss 1.0136 (0.9780) lr 6.9098e-04 eta 0:03:13
epoch [32/50] batch [80/132] time 0.085 (0.077) data 0.000 (0.004) loss 0.8155 (0.7100) ce_loss 0.2930 (0.2020) teacher_loss 0.1777 (0.1286) loss_zs_kd 0.1256 (0.0639) loss_oracle 0.5750 (0.5495) acc 87.5000 (93.3984) kd_loss 1.0076 (0.9805) lr 6.9098e-04 eta 0:03:07
epoch [32/50] batch [100/132] time 0.066 (0.075) data 0.000 (0.003) loss 0.7221 (0.7196) ce_loss 0.2764 (0.2082) teacher_loss 0.0689 (0.1322) loss_zs_kd 0.0961 (0.0649) loss_oracle 0.6052 (0.5549) acc 93.7500 (93.2188) kd_loss 0.9930 (0.9840) lr 6.9098e-04 eta 0:03:01
epoch [32/50] batch [120/132] time 0.065 (0.074) data 0.000 (0.003) loss 0.5461 (0.7248) ce_loss 0.0394 (0.2141) teacher_loss 0.0236 (0.1356) loss_zs_kd 0.0488 (0.0652) loss_oracle 0.4982 (0.5565) acc 100.0000 (92.9427) kd_loss 0.9626 (0.9841) lr 6.9098e-04 eta 0:02:57
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,496
* accuracy: 89.0%
* error: 11.0%
* macro_f1: 91.5%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [33/50] batch [20/132] time 0.088 (0.093) data 0.000 (0.014) loss 0.5985 (0.7100) ce_loss 0.1676 (0.2047) teacher_loss 0.0666 (0.1352) loss_zs_kd 0.0402 (0.0672) loss_oracle 0.5118 (0.5411) acc 93.7500 (92.8125) kd_loss 1.0065 (0.9695) lr 6.3188e-04 eta 0:03:38
epoch [33/50] batch [40/132] time 0.077 (0.086) data 0.000 (0.007) loss 0.6484 (0.7145) ce_loss 0.1655 (0.1998) teacher_loss 0.1336 (0.1262) loss_zs_kd 0.0425 (0.0671) loss_oracle 0.4936 (0.5548) acc 93.7500 (92.9688) kd_loss 0.9588 (0.9773) lr 6.3188e-04 eta 0:03:19
epoch [33/50] batch [60/132] time 0.090 (0.083) data 0.000 (0.005) loss 0.7311 (0.7121) ce_loss 0.2942 (0.1987) teacher_loss 0.1427 (0.1245) loss_zs_kd 0.0593 (0.0638) loss_oracle 0.5587 (0.5558) acc 90.6250 (93.0208) kd_loss 0.9926 (0.9777) lr 6.3188e-04 eta 0:03:11
epoch [33/50] batch [80/132] time 0.083 (0.084) data 0.000 (0.004) loss 0.6726 (0.6980) ce_loss 0.2448 (0.1908) teacher_loss 0.1499 (0.1172) loss_zs_kd 0.0550 (0.0625) loss_oracle 0.4952 (0.5496) acc 87.5000 (93.3594) kd_loss 0.9821 (0.9761) lr 6.3188e-04 eta 0:03:12
epoch [33/50] batch [100/132] time 0.085 (0.084) data 0.000 (0.003) loss 0.6592 (0.6976) ce_loss 0.1855 (0.1964) teacher_loss 0.1187 (0.1221) loss_zs_kd 0.0602 (0.0626) loss_oracle 0.5104 (0.5442) acc 93.7500 (93.1875) kd_loss 1.0301 (0.9751) lr 6.3188e-04 eta 0:03:11
epoch [33/50] batch [120/132] time 0.083 (0.084) data 0.000 (0.003) loss 0.6168 (0.6979) ce_loss 0.2561 (0.2027) teacher_loss 0.1104 (0.1273) loss_zs_kd 0.0530 (0.0627) loss_oracle 0.4799 (0.5392) acc 93.7500 (92.9948) kd_loss 1.0176 (0.9753) lr 6.3188e-04 eta 0:03:10
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,805
* accuracy: 99.1%
* error: 0.9%
* macro_f1: 99.1%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,483
* accuracy: 88.7%
* error: 11.3%
* macro_f1: 91.2%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [34/50] batch [20/132] time 0.080 (0.099) data 0.000 (0.020) loss 0.7338 (0.6475) ce_loss 0.2479 (0.1813) teacher_loss 0.1386 (0.1037) loss_zs_kd 0.0433 (0.0593) loss_oracle 0.5736 (0.5141) acc 90.6250 (94.2188) kd_loss 0.9725 (0.9741) lr 5.7422e-04 eta 0:03:40
epoch [34/50] batch [40/132] time 0.070 (0.090) data 0.000 (0.010) loss 0.7563 (0.6584) ce_loss 0.2837 (0.1862) teacher_loss 0.2175 (0.1126) loss_zs_kd 0.0681 (0.0614) loss_oracle 0.5048 (0.5151) acc 87.5000 (94.0625) kd_loss 0.9916 (0.9634) lr 5.7422e-04 eta 0:03:18
epoch [34/50] batch [60/132] time 0.066 (0.087) data 0.000 (0.007) loss 0.5564 (0.6541) ce_loss 0.1425 (0.1753) teacher_loss 0.1049 (0.1091) loss_zs_kd 0.0330 (0.0589) loss_oracle 0.4349 (0.5156) acc 93.7500 (94.5312) kd_loss 0.9400 (0.9607) lr 5.7422e-04 eta 0:03:09
epoch [34/50] batch [80/132] time 0.060 (0.081) data 0.000 (0.005) loss 0.6611 (0.6667) ce_loss 0.0635 (0.1830) teacher_loss 0.0305 (0.1174) loss_zs_kd 0.0464 (0.0592) loss_oracle 0.6073 (0.5197) acc 100.0000 (94.3750) kd_loss 1.0083 (0.9628) lr 5.7422e-04 eta 0:02:55
epoch [34/50] batch [100/132] time 0.082 (0.080) data 0.000 (0.004) loss 0.7897 (0.6760) ce_loss 0.4163 (0.1919) teacher_loss 0.2752 (0.1230) loss_zs_kd 0.0528 (0.0594) loss_oracle 0.4881 (0.5233) acc 87.5000 (93.8438) kd_loss 0.9371 (0.9630) lr 5.7422e-04 eta 0:02:51
epoch [34/50] batch [120/132] time 0.077 (0.080) data 0.000 (0.003) loss 0.6349 (0.6842) ce_loss 0.3044 (0.1972) teacher_loss 0.1320 (0.1261) loss_zs_kd 0.0788 (0.0599) loss_oracle 0.4634 (0.5282) acc 93.7500 (93.7500) kd_loss 0.9652 (0.9671) lr 5.7422e-04 eta 0:02:50
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,807
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.2%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,488
* accuracy: 88.8%
* error: 11.2%
* macro_f1: 91.3%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [35/50] batch [20/132] time 0.083 (0.104) data 0.000 (0.017) loss 0.9079 (0.6895) ce_loss 0.4153 (0.2072) teacher_loss 0.3154 (0.1269) loss_zs_kd 0.0594 (0.0537) loss_oracle 0.5627 (0.5357) acc 84.3750 (93.5938) kd_loss 0.9217 (0.9584) lr 5.1825e-04 eta 0:03:37
epoch [35/50] batch [40/132] time 0.091 (0.096) data 0.000 (0.009) loss 0.6316 (0.6773) ce_loss 0.1362 (0.1920) teacher_loss 0.0740 (0.1200) loss_zs_kd 0.0750 (0.0584) loss_oracle 0.5201 (0.5281) acc 96.8750 (94.0625) kd_loss 0.9650 (0.9556) lr 5.1825e-04 eta 0:03:18
epoch [35/50] batch [60/132] time 0.080 (0.091) data 0.000 (0.006) loss 0.6555 (0.6748) ce_loss 0.1589 (0.1970) teacher_loss 0.1162 (0.1245) loss_zs_kd 0.0576 (0.0576) loss_oracle 0.5105 (0.5216) acc 93.7500 (93.8021) kd_loss 0.9664 (0.9584) lr 5.1825e-04 eta 0:03:07
epoch [35/50] batch [80/132] time 0.091 (0.089) data 0.000 (0.005) loss 0.5683 (0.6800) ce_loss 0.1864 (0.1965) teacher_loss 0.1034 (0.1241) loss_zs_kd 0.0541 (0.0575) loss_oracle 0.4379 (0.5271) acc 93.7500 (93.9062) kd_loss 0.9148 (0.9632) lr 5.1825e-04 eta 0:03:01
epoch [35/50] batch [100/132] time 0.080 (0.088) data 0.000 (0.004) loss 0.5769 (0.6732) ce_loss 0.1155 (0.1920) teacher_loss 0.0938 (0.1212) loss_zs_kd 0.0627 (0.0572) loss_oracle 0.4517 (0.5234) acc 93.7500 (93.9688) kd_loss 0.9054 (0.9666) lr 5.1825e-04 eta 0:02:57
epoch [35/50] batch [120/132] time 0.074 (0.087) data 0.000 (0.003) loss 0.7055 (0.6734) ce_loss 0.2834 (0.1900) teacher_loss 0.1554 (0.1208) loss_zs_kd 0.0712 (0.0571) loss_oracle 0.5145 (0.5241) acc 90.6250 (93.8542) kd_loss 0.9426 (0.9662) lr 5.1825e-04 eta 0:02:53
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,488
* accuracy: 88.8%
* error: 11.2%
* macro_f1: 91.3%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [36/50] batch [20/132] time 0.083 (0.098) data 0.000 (0.014) loss 0.6608 (0.6558) ce_loss 0.1476 (0.1811) teacher_loss 0.1252 (0.1232) loss_zs_kd 0.0518 (0.0559) loss_oracle 0.5097 (0.5046) acc 90.6250 (93.5938) kd_loss 1.0046 (0.9527) lr 4.6417e-04 eta 0:03:12
epoch [36/50] batch [40/132] time 0.085 (0.091) data 0.000 (0.007) loss 0.5531 (0.6472) ce_loss 0.0865 (0.1829) teacher_loss 0.0779 (0.1216) loss_zs_kd 0.0576 (0.0552) loss_oracle 0.4464 (0.4980) acc 96.8750 (93.5938) kd_loss 0.8861 (0.9534) lr 4.6417e-04 eta 0:02:56
epoch [36/50] batch [60/132] time 0.082 (0.089) data 0.000 (0.005) loss 0.6870 (0.6505) ce_loss 0.1757 (0.1852) teacher_loss 0.1402 (0.1244) loss_zs_kd 0.0517 (0.0553) loss_oracle 0.5210 (0.4985) acc 93.7500 (93.5417) kd_loss 1.0091 (0.9606) lr 4.6417e-04 eta 0:02:51
epoch [36/50] batch [80/132] time 0.085 (0.089) data 0.000 (0.004) loss 0.4710 (0.6484) ce_loss 0.0516 (0.1833) teacher_loss 0.0208 (0.1221) loss_zs_kd 0.0337 (0.0554) loss_oracle 0.4333 (0.4986) acc 100.0000 (93.6719) kd_loss 0.9178 (0.9569) lr 4.6417e-04 eta 0:02:48
epoch [36/50] batch [100/132] time 0.084 (0.089) data 0.000 (0.003) loss 0.7499 (0.6527) ce_loss 0.3857 (0.1857) teacher_loss 0.1966 (0.1248) loss_zs_kd 0.0832 (0.0555) loss_oracle 0.5117 (0.5001) acc 87.5000 (93.6562) kd_loss 0.9811 (0.9577) lr 4.6417e-04 eta 0:02:46
epoch [36/50] batch [120/132] time 0.072 (0.088) data 0.000 (0.003) loss 0.6246 (0.6557) ce_loss 0.1677 (0.1894) teacher_loss 0.1299 (0.1239) loss_zs_kd 0.0466 (0.0570) loss_oracle 0.4714 (0.5033) acc 93.7500 (93.4635) kd_loss 0.8569 (0.9573) lr 4.6417e-04 eta 0:02:43
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,806
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.2%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,491
* accuracy: 88.9%
* error: 11.1%
* macro_f1: 91.4%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [37/50] batch [20/132] time 0.077 (0.092) data 0.000 (0.013) loss 0.9294 (0.6943) ce_loss 0.5596 (0.2238) teacher_loss 0.3690 (0.1469) loss_zs_kd 0.1078 (0.0628) loss_oracle 0.5065 (0.5160) acc 81.2500 (91.5625) kd_loss 0.9388 (0.9581) lr 4.1221e-04 eta 0:02:47
epoch [37/50] batch [40/132] time 0.068 (0.084) data 0.000 (0.007) loss 0.6069 (0.6881) ce_loss 0.1240 (0.2203) teacher_loss 0.1218 (0.1489) loss_zs_kd 0.0298 (0.0599) loss_oracle 0.4702 (0.5092) acc 96.8750 (92.2656) kd_loss 0.9540 (0.9514) lr 4.1221e-04 eta 0:02:31
epoch [37/50] batch [60/132] time 0.089 (0.083) data 0.001 (0.004) loss 0.6044 (0.6831) ce_loss 0.0975 (0.2101) teacher_loss 0.0589 (0.1418) loss_zs_kd 0.0357 (0.0589) loss_oracle 0.5277 (0.5118) acc 96.8750 (92.8125) kd_loss 1.0171 (0.9556) lr 4.1221e-04 eta 0:02:29
epoch [37/50] batch [80/132] time 0.079 (0.084) data 0.001 (0.003) loss 0.6696 (0.6810) ce_loss 0.1072 (0.2097) teacher_loss 0.0572 (0.1406) loss_zs_kd 0.0834 (0.0592) loss_oracle 0.5707 (0.5109) acc 100.0000 (92.9297) kd_loss 1.0409 (0.9546) lr 4.1221e-04 eta 0:02:28
epoch [37/50] batch [100/132] time 0.083 (0.085) data 0.000 (0.003) loss 0.8617 (0.6837) ce_loss 0.2683 (0.2095) teacher_loss 0.2206 (0.1415) loss_zs_kd 0.0517 (0.0586) loss_oracle 0.6152 (0.5129) acc 93.7500 (92.9688) kd_loss 0.9433 (0.9549) lr 4.1221e-04 eta 0:02:27
epoch [37/50] batch [120/132] time 0.077 (0.085) data 0.000 (0.002) loss 0.5814 (0.6852) ce_loss 0.0625 (0.2066) teacher_loss 0.0489 (0.1389) loss_zs_kd 0.0442 (0.0596) loss_oracle 0.5104 (0.5166) acc 100.0000 (93.0469) kd_loss 0.9985 (0.9572) lr 4.1221e-04 eta 0:02:26
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,807
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.2%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,488
* accuracy: 88.8%
* error: 11.2%
* macro_f1: 91.4%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [38/50] batch [20/132] time 0.085 (0.098) data 0.000 (0.014) loss 0.7246 (0.6864) ce_loss 0.4292 (0.2036) teacher_loss 0.2384 (0.1352) loss_zs_kd 0.0659 (0.0529) loss_oracle 0.4533 (0.5247) acc 90.6250 (93.7500) kd_loss 0.9345 (0.9627) lr 3.6258e-04 eta 0:02:46
epoch [38/50] batch [40/132] time 0.088 (0.091) data 0.001 (0.007) loss 0.5530 (0.6995) ce_loss 0.1794 (0.2156) teacher_loss 0.0921 (0.1479) loss_zs_kd 0.0334 (0.0552) loss_oracle 0.4442 (0.5241) acc 96.8750 (92.8906) kd_loss 0.9693 (0.9573) lr 3.6258e-04 eta 0:02:32
epoch [38/50] batch [60/132] time 0.088 (0.090) data 0.000 (0.005) loss 0.6954 (0.6860) ce_loss 0.2018 (0.2053) teacher_loss 0.1193 (0.1398) loss_zs_kd 0.0809 (0.0532) loss_oracle 0.5357 (0.5196) acc 96.8750 (92.9688) kd_loss 0.9500 (0.9576) lr 3.6258e-04 eta 0:02:28
epoch [38/50] batch [80/132] time 0.085 (0.088) data 0.000 (0.004) loss 0.6556 (0.6856) ce_loss 0.1230 (0.2039) teacher_loss 0.0385 (0.1397) loss_zs_kd 0.0433 (0.0547) loss_oracle 0.5954 (0.5186) acc 96.8750 (92.8906) kd_loss 0.9962 (0.9527) lr 3.6258e-04 eta 0:02:23
epoch [38/50] batch [100/132] time 0.079 (0.088) data 0.000 (0.003) loss 0.6090 (0.6856) ce_loss 0.1543 (0.2028) teacher_loss 0.0933 (0.1378) loss_zs_kd 0.0615 (0.0550) loss_oracle 0.4850 (0.5204) acc 93.7500 (93.0625) kd_loss 0.9300 (0.9519) lr 3.6258e-04 eta 0:02:21
epoch [38/50] batch [120/132] time 0.081 (0.087) data 0.000 (0.003) loss 0.7336 (0.6836) ce_loss 0.1934 (0.2009) teacher_loss 0.1290 (0.1357) loss_zs_kd 0.0891 (0.0559) loss_oracle 0.5600 (0.5201) acc 93.7500 (93.2031) kd_loss 0.9951 (0.9552) lr 3.6258e-04 eta 0:02:18
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,806
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.2%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,491
* accuracy: 88.9%
* error: 11.1%
* macro_f1: 91.4%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [39/50] batch [20/132] time 0.078 (0.107) data 0.000 (0.019) loss 0.7203 (0.6382) ce_loss 0.2177 (0.1627) teacher_loss 0.1383 (0.1120) loss_zs_kd 0.0485 (0.0507) loss_oracle 0.5578 (0.5008) acc 90.6250 (93.9062) kd_loss 0.9523 (0.9461) lr 3.1545e-04 eta 0:02:47
epoch [39/50] batch [40/132] time 0.089 (0.097) data 0.000 (0.010) loss 0.7424 (0.6633) ce_loss 0.2402 (0.1835) teacher_loss 0.2472 (0.1297) loss_zs_kd 0.0622 (0.0526) loss_oracle 0.4640 (0.5073) acc 93.7500 (93.8281) kd_loss 0.8691 (0.9382) lr 3.1545e-04 eta 0:02:29
epoch [39/50] batch [60/132] time 0.092 (0.093) data 0.000 (0.006) loss 0.7133 (0.6701) ce_loss 0.1492 (0.1985) teacher_loss 0.1255 (0.1413) loss_zs_kd 0.0494 (0.0556) loss_oracle 0.5631 (0.5009) acc 96.8750 (93.3333) kd_loss 1.0212 (0.9342) lr 3.1545e-04 eta 0:02:21
epoch [39/50] batch [80/132] time 0.086 (0.091) data 0.000 (0.005) loss 0.5140 (0.6675) ce_loss 0.0719 (0.1948) teacher_loss 0.0218 (0.1390) loss_zs_kd 0.0481 (0.0551) loss_oracle 0.4681 (0.5009) acc 96.8750 (93.3594) kd_loss 0.9306 (0.9383) lr 3.1545e-04 eta 0:02:16
epoch [39/50] batch [100/132] time 0.098 (0.090) data 0.000 (0.004) loss 0.8120 (0.6601) ce_loss 0.2245 (0.1953) teacher_loss 0.2560 (0.1364) loss_zs_kd 0.0664 (0.0539) loss_oracle 0.5228 (0.4967) acc 96.8750 (93.4688) kd_loss 0.9219 (0.9400) lr 3.1545e-04 eta 0:02:13
epoch [39/50] batch [120/132] time 0.084 (0.090) data 0.000 (0.003) loss 0.6436 (0.6585) ce_loss 0.1351 (0.1909) teacher_loss 0.1059 (0.1344) loss_zs_kd 0.0519 (0.0544) loss_oracle 0.5118 (0.4969) acc 96.8750 (93.7240) kd_loss 0.9113 (0.9412) lr 3.1545e-04 eta 0:02:11
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,484
* accuracy: 88.7%
* error: 11.3%
* macro_f1: 91.3%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [40/50] batch [20/132] time 0.087 (0.103) data 0.000 (0.013) loss 0.6106 (0.6535) ce_loss 0.1841 (0.2043) teacher_loss 0.1265 (0.1439) loss_zs_kd 0.0662 (0.0522) loss_oracle 0.4511 (0.4835) acc 96.8750 (93.5938) kd_loss 1.0177 (0.9535) lr 2.7103e-04 eta 0:02:27
epoch [40/50] batch [40/132] time 0.086 (0.096) data 0.000 (0.007) loss 0.5902 (0.6437) ce_loss 0.2272 (0.1953) teacher_loss 0.1039 (0.1357) loss_zs_kd 0.0673 (0.0525) loss_oracle 0.4526 (0.4817) acc 90.6250 (93.5156) kd_loss 0.8953 (0.9509) lr 2.7103e-04 eta 0:02:15
epoch [40/50] batch [60/132] time 0.082 (0.092) data 0.001 (0.005) loss 0.6498 (0.6332) ce_loss 0.2603 (0.1845) teacher_loss 0.2019 (0.1258) loss_zs_kd 0.0552 (0.0533) loss_oracle 0.4203 (0.4807) acc 90.6250 (93.8542) kd_loss 0.9321 (0.9476) lr 2.7103e-04 eta 0:02:08
epoch [40/50] batch [80/132] time 0.089 (0.090) data 0.000 (0.004) loss 0.6086 (0.6346) ce_loss 0.1841 (0.1884) teacher_loss 0.0940 (0.1312) loss_zs_kd 0.0528 (0.0544) loss_oracle 0.4882 (0.4763) acc 93.7500 (93.6719) kd_loss 0.9216 (0.9387) lr 2.7103e-04 eta 0:02:04
epoch [40/50] batch [100/132] time 0.087 (0.090) data 0.001 (0.003) loss 0.6244 (0.6365) ce_loss 0.1937 (0.1891) teacher_loss 0.1670 (0.1338) loss_zs_kd 0.0554 (0.0530) loss_oracle 0.4297 (0.4762) acc 93.7500 (93.6250) kd_loss 0.9295 (0.9373) lr 2.7103e-04 eta 0:02:01
epoch [40/50] batch [120/132] time 0.082 (0.090) data 0.000 (0.003) loss 0.5195 (0.6328) ce_loss 0.1051 (0.1867) teacher_loss 0.0364 (0.1318) loss_zs_kd 0.0434 (0.0521) loss_oracle 0.4613 (0.4749) acc 93.7500 (93.8281) kd_loss 0.9400 (0.9349) lr 2.7103e-04 eta 0:01:59
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,480
* accuracy: 88.6%
* error: 11.4%
* macro_f1: 91.2%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [41/50] batch [20/132] time 0.087 (0.106) data 0.000 (0.014) loss 0.7081 (0.6580) ce_loss 0.1818 (0.2251) teacher_loss 0.2134 (0.1620) loss_zs_kd 0.0629 (0.0538) loss_oracle 0.4633 (0.4692) acc 90.6250 (92.1875) kd_loss 0.8853 (0.9267) lr 2.2949e-04 eta 0:02:17
epoch [41/50] batch [40/132] time 0.087 (0.098) data 0.000 (0.007) loss 0.7874 (0.6475) ce_loss 0.4670 (0.2093) teacher_loss 0.3437 (0.1509) loss_zs_kd 0.0772 (0.0527) loss_oracle 0.4051 (0.4703) acc 78.1250 (92.8906) kd_loss 0.8807 (0.9279) lr 2.2949e-04 eta 0:02:05
epoch [41/50] batch [60/132] time 0.083 (0.095) data 0.001 (0.005) loss 0.6491 (0.6393) ce_loss 0.3657 (0.2052) teacher_loss 0.2136 (0.1437) loss_zs_kd 0.0618 (0.0528) loss_oracle 0.4046 (0.4692) acc 90.6250 (92.9167) kd_loss 0.8508 (0.9276) lr 2.2949e-04 eta 0:01:59
epoch [41/50] batch [80/132] time 0.100 (0.094) data 0.000 (0.004) loss 0.5743 (0.6408) ce_loss 0.0584 (0.2000) teacher_loss 0.0401 (0.1408) loss_zs_kd 0.0411 (0.0542) loss_oracle 0.5136 (0.4729) acc 100.0000 (93.0859) kd_loss 0.9793 (0.9281) lr 2.2949e-04 eta 0:01:56
epoch [41/50] batch [100/132] time 0.089 (0.093) data 0.000 (0.003) loss 0.6209 (0.6426) ce_loss 0.1750 (0.2022) teacher_loss 0.1316 (0.1468) loss_zs_kd 0.0645 (0.0542) loss_oracle 0.4571 (0.4687) acc 96.8750 (93.0000) kd_loss 0.9418 (0.9268) lr 2.2949e-04 eta 0:01:53
epoch [41/50] batch [120/132] time 0.081 (0.092) data 0.000 (0.003) loss 0.5786 (0.6408) ce_loss 0.1131 (0.1999) teacher_loss 0.0917 (0.1434) loss_zs_kd 0.0440 (0.0539) loss_oracle 0.4650 (0.4705) acc 96.8750 (93.2552) kd_loss 0.9265 (0.9259) lr 2.2949e-04 eta 0:01:50
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,479
* accuracy: 88.6%
* error: 11.4%
* macro_f1: 91.1%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [42/50] batch [20/132] time 0.086 (0.101) data 0.000 (0.013) loss 0.6193 (0.6333) ce_loss 0.1571 (0.2208) teacher_loss 0.1587 (0.1509) loss_zs_kd 0.0490 (0.0459) loss_oracle 0.4361 (0.4594) acc 93.7500 (92.9688) kd_loss 0.9294 (0.9313) lr 1.9098e-04 eta 0:01:58
epoch [42/50] batch [40/132] time 0.089 (0.095) data 0.000 (0.007) loss 0.5036 (0.6399) ce_loss 0.0496 (0.1969) teacher_loss 0.0275 (0.1376) loss_zs_kd 0.0480 (0.0489) loss_oracle 0.4520 (0.4778) acc 100.0000 (93.9844) kd_loss 0.8933 (0.9352) lr 1.9098e-04 eta 0:01:49
epoch [42/50] batch [60/132] time 0.093 (0.093) data 0.002 (0.005) loss 0.6040 (0.6389) ce_loss 0.1902 (0.2040) teacher_loss 0.1187 (0.1349) loss_zs_kd 0.0569 (0.0538) loss_oracle 0.4569 (0.4771) acc 93.7500 (93.2292) kd_loss 0.9217 (0.9375) lr 1.9098e-04 eta 0:01:45
epoch [42/50] batch [80/132] time 0.087 (0.093) data 0.001 (0.004) loss 0.6141 (0.6372) ce_loss 0.1854 (0.1977) teacher_loss 0.1174 (0.1278) loss_zs_kd 0.0517 (0.0531) loss_oracle 0.4708 (0.4829) acc 93.7500 (93.4766) kd_loss 1.0179 (0.9430) lr 1.9098e-04 eta 0:01:42
epoch [42/50] batch [100/132] time 0.089 (0.092) data 0.000 (0.003) loss 0.5808 (0.6372) ce_loss 0.1752 (0.1984) teacher_loss 0.1420 (0.1299) loss_zs_kd 0.0608 (0.0545) loss_oracle 0.4083 (0.4800) acc 93.7500 (93.3750) kd_loss 0.9601 (0.9423) lr 1.9098e-04 eta 0:01:39
epoch [42/50] batch [120/132] time 0.082 (0.091) data 0.000 (0.002) loss 0.6619 (0.6387) ce_loss 0.1875 (0.1982) teacher_loss 0.1040 (0.1305) loss_zs_kd 0.0683 (0.0555) loss_oracle 0.5237 (0.4805) acc 93.7500 (93.3333) kd_loss 0.9170 (0.9391) lr 1.9098e-04 eta 0:01:37
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,806
* accuracy: 99.2%
* error: 0.8%
* macro_f1: 99.2%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,481
* accuracy: 88.6%
* error: 11.4%
* macro_f1: 91.2%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [43/50] batch [20/132] time 0.094 (0.111) data 0.000 (0.017) loss 0.7195 (0.6740) ce_loss 0.1699 (0.2280) teacher_loss 0.1647 (0.1666) loss_zs_kd 0.0558 (0.0632) loss_oracle 0.5268 (0.4759) acc 93.7500 (91.5625) kd_loss 0.9570 (0.9464) lr 1.5567e-04 eta 0:01:55
epoch [43/50] batch [40/132] time 0.089 (0.098) data 0.000 (0.008) loss 0.6029 (0.6515) ce_loss 0.2368 (0.2036) teacher_loss 0.1194 (0.1395) loss_zs_kd 0.0851 (0.0569) loss_oracle 0.4410 (0.4835) acc 96.8750 (93.0469) kd_loss 0.9356 (0.9458) lr 1.5567e-04 eta 0:01:39
epoch [43/50] batch [60/132] time 0.086 (0.093) data 0.000 (0.006) loss 0.7875 (0.6621) ce_loss 0.2883 (0.2150) teacher_loss 0.2707 (0.1453) loss_zs_kd 0.0624 (0.0560) loss_oracle 0.4856 (0.4888) acc 90.6250 (92.8646) kd_loss 0.8867 (0.9395) lr 1.5567e-04 eta 0:01:32
epoch [43/50] batch [80/132] time 0.089 (0.091) data 0.000 (0.004) loss 0.5728 (0.6577) ce_loss 0.0746 (0.2098) teacher_loss 0.0529 (0.1407) loss_zs_kd 0.0437 (0.0571) loss_oracle 0.4980 (0.4885) acc 100.0000 (93.0469) kd_loss 0.9311 (0.9347) lr 1.5567e-04 eta 0:01:28
epoch [43/50] batch [100/132] time 0.080 (0.090) data 0.000 (0.004) loss 0.6117 (0.6593) ce_loss 0.1925 (0.2103) teacher_loss 0.1305 (0.1415) loss_zs_kd 0.0588 (0.0573) loss_oracle 0.4517 (0.4891) acc 93.7500 (93.0625) kd_loss 0.8900 (0.9310) lr 1.5567e-04 eta 0:01:25
epoch [43/50] batch [120/132] time 0.070 (0.089) data 0.000 (0.003) loss 0.5427 (0.6566) ce_loss 0.1327 (0.2079) teacher_loss 0.0546 (0.1402) loss_zs_kd 0.0538 (0.0576) loss_oracle 0.4612 (0.4876) acc 96.8750 (93.1250) kd_loss 0.9667 (0.9305) lr 1.5567e-04 eta 0:01:23
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,482
* accuracy: 88.6%
* error: 11.4%
* macro_f1: 91.2%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [44/50] batch [20/132] time 0.077 (0.106) data 0.000 (0.019) loss 0.7242 (0.6361) ce_loss 0.2517 (0.1817) teacher_loss 0.1960 (0.1241) loss_zs_kd 0.0497 (0.0581) loss_oracle 0.5034 (0.4829) acc 90.6250 (94.2188) kd_loss 0.9600 (0.9401) lr 1.2369e-04 eta 0:01:35
epoch [44/50] batch [40/132] time 0.079 (0.095) data 0.000 (0.010) loss 0.5729 (0.6415) ce_loss 0.0893 (0.1859) teacher_loss 0.0547 (0.1278) loss_zs_kd 0.0414 (0.0577) loss_oracle 0.4975 (0.4849) acc 96.8750 (93.7500) kd_loss 0.9238 (0.9311) lr 1.2369e-04 eta 0:01:23
epoch [44/50] batch [60/132] time 0.075 (0.091) data 0.001 (0.007) loss 0.6581 (0.6525) ce_loss 0.2448 (0.2029) teacher_loss 0.1184 (0.1384) loss_zs_kd 0.0525 (0.0576) loss_oracle 0.5135 (0.4853) acc 93.7500 (93.2812) kd_loss 0.9815 (0.9309) lr 1.2369e-04 eta 0:01:18
epoch [44/50] batch [80/132] time 0.074 (0.088) data 0.000 (0.005) loss 0.7530 (0.6509) ce_loss 0.1893 (0.1992) teacher_loss 0.1387 (0.1365) loss_zs_kd 0.0518 (0.0571) loss_oracle 0.5883 (0.4859) acc 93.7500 (93.5156) kd_loss 1.0372 (0.9325) lr 1.2369e-04 eta 0:01:14
epoch [44/50] batch [100/132] time 0.086 (0.087) data 0.000 (0.004) loss 0.5940 (0.6465) ce_loss 0.2058 (0.1962) teacher_loss 0.0957 (0.1332) loss_zs_kd 0.0614 (0.0566) loss_oracle 0.4676 (0.4850) acc 93.7500 (93.6562) kd_loss 0.9155 (0.9327) lr 1.2369e-04 eta 0:01:11
epoch [44/50] batch [120/132] time 0.082 (0.086) data 0.000 (0.003) loss 0.8152 (0.6503) ce_loss 0.4336 (0.1990) teacher_loss 0.3315 (0.1364) loss_zs_kd 0.0735 (0.0568) loss_oracle 0.4469 (0.4855) acc 90.6250 (93.5938) kd_loss 0.9163 (0.9331) lr 1.2369e-04 eta 0:01:08
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,809
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,485
* accuracy: 88.7%
* error: 11.3%
* macro_f1: 91.3%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [45/50] batch [20/132] time 0.092 (0.102) data 0.000 (0.019) loss 0.6232 (0.6433) ce_loss 0.2212 (0.2004) teacher_loss 0.1492 (0.1365) loss_zs_kd 0.0628 (0.0582) loss_oracle 0.4426 (0.4777) acc 90.6250 (93.9062) kd_loss 0.8246 (0.9168) lr 9.5173e-05 eta 0:01:18
epoch [45/50] batch [40/132] time 0.077 (0.091) data 0.000 (0.010) loss 0.6574 (0.6418) ce_loss 0.1772 (0.1836) teacher_loss 0.1186 (0.1308) loss_zs_kd 0.0809 (0.0565) loss_oracle 0.4984 (0.4827) acc 96.8750 (94.1406) kd_loss 0.9138 (0.9273) lr 9.5173e-05 eta 0:01:08
epoch [45/50] batch [60/132] time 0.081 (0.088) data 0.001 (0.006) loss 0.4923 (0.6432) ce_loss 0.0113 (0.1916) teacher_loss 0.0057 (0.1316) loss_zs_kd 0.0344 (0.0557) loss_oracle 0.4693 (0.4837) acc 100.0000 (94.1146) kd_loss 0.9439 (0.9220) lr 9.5173e-05 eta 0:01:04
epoch [45/50] batch [80/132] time 0.082 (0.088) data 0.000 (0.005) loss 0.5835 (0.6493) ce_loss 0.0441 (0.2004) teacher_loss 0.0440 (0.1392) loss_zs_kd 0.0510 (0.0583) loss_oracle 0.5140 (0.4809) acc 100.0000 (93.6328) kd_loss 0.9289 (0.9237) lr 9.5173e-05 eta 0:01:02
epoch [45/50] batch [100/132] time 0.085 (0.087) data 0.000 (0.004) loss 0.4986 (0.6495) ce_loss 0.1847 (0.2035) teacher_loss 0.0810 (0.1386) loss_zs_kd 0.0202 (0.0587) loss_oracle 0.4075 (0.4816) acc 96.8750 (93.3438) kd_loss 0.8365 (0.9232) lr 9.5173e-05 eta 0:00:59
epoch [45/50] batch [120/132] time 0.078 (0.086) data 0.000 (0.003) loss 0.5602 (0.6512) ce_loss 0.1114 (0.2048) teacher_loss 0.1025 (0.1407) loss_zs_kd 0.0489 (0.0593) loss_oracle 0.4332 (0.4809) acc 96.8750 (93.2031) kd_loss 0.8833 (0.9239) lr 9.5173e-05 eta 0:00:57
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,489
* accuracy: 88.8%
* error: 11.2%
* macro_f1: 91.4%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [46/50] batch [20/132] time 0.092 (0.102) data 0.000 (0.016) loss 0.5774 (0.6163) ce_loss 0.1017 (0.1841) teacher_loss 0.0562 (0.1260) loss_zs_kd 0.0430 (0.0599) loss_oracle 0.4997 (0.4604) acc 93.7500 (93.4375) kd_loss 0.8594 (0.9271) lr 7.0224e-05 eta 0:01:05
epoch [46/50] batch [40/132] time 0.090 (0.095) data 0.000 (0.008) loss 0.7242 (0.6156) ce_loss 0.4033 (0.1904) teacher_loss 0.2516 (0.1283) loss_zs_kd 0.0965 (0.0583) loss_oracle 0.4243 (0.4581) acc 81.2500 (93.0469) kd_loss 0.9282 (0.9202) lr 7.0224e-05 eta 0:00:58
epoch [46/50] batch [60/132] time 0.089 (0.094) data 0.001 (0.006) loss 0.5549 (0.6284) ce_loss 0.0588 (0.1951) teacher_loss 0.0550 (0.1315) loss_zs_kd 0.0269 (0.0568) loss_oracle 0.4865 (0.4685) acc 100.0000 (93.1250) kd_loss 0.8986 (0.9203) lr 7.0224e-05 eta 0:00:56
epoch [46/50] batch [80/132] time 0.090 (0.093) data 0.001 (0.004) loss 0.6050 (0.6284) ce_loss 0.1748 (0.1926) teacher_loss 0.1468 (0.1314) loss_zs_kd 0.0400 (0.0566) loss_oracle 0.4382 (0.4687) acc 96.8750 (93.3984) kd_loss 0.9232 (0.9204) lr 7.0224e-05 eta 0:00:53
epoch [46/50] batch [100/132] time 0.094 (0.092) data 0.001 (0.004) loss 0.5545 (0.6246) ce_loss 0.1144 (0.1875) teacher_loss 0.0515 (0.1284) loss_zs_kd 0.0330 (0.0547) loss_oracle 0.4866 (0.4689) acc 96.8750 (93.6250) kd_loss 0.8802 (0.9203) lr 7.0224e-05 eta 0:00:51
epoch [46/50] batch [120/132] time 0.083 (0.092) data 0.000 (0.003) loss 0.8019 (0.6305) ce_loss 0.2089 (0.1915) teacher_loss 0.2087 (0.1315) loss_zs_kd 0.0218 (0.0552) loss_oracle 0.5823 (0.4714) acc 93.7500 (93.3333) kd_loss 0.9380 (0.9172) lr 7.0224e-05 eta 0:00:49
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,484
* accuracy: 88.7%
* error: 11.3%
* macro_f1: 91.2%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [47/50] batch [20/132] time 0.088 (0.105) data 0.000 (0.015) loss 0.5688 (0.6414) ce_loss 0.1165 (0.2023) teacher_loss 0.1029 (0.1435) loss_zs_kd 0.0449 (0.0550) loss_oracle 0.4435 (0.4704) acc 96.8750 (93.4375) kd_loss 0.8835 (0.9178) lr 4.8943e-05 eta 0:00:53
epoch [47/50] batch [40/132] time 0.080 (0.096) data 0.000 (0.008) loss 0.4775 (0.6649) ce_loss 0.0542 (0.2159) teacher_loss 0.0433 (0.1521) loss_zs_kd 0.0330 (0.0566) loss_oracle 0.4177 (0.4844) acc 100.0000 (92.5781) kd_loss 0.8614 (0.9179) lr 4.8943e-05 eta 0:00:46
epoch [47/50] batch [60/132] time 0.085 (0.093) data 0.001 (0.005) loss 0.4907 (0.6551) ce_loss 0.0541 (0.2162) teacher_loss 0.0442 (0.1507) loss_zs_kd 0.0575 (0.0570) loss_oracle 0.4177 (0.4759) acc 100.0000 (92.7604) kd_loss 0.9141 (0.9169) lr 4.8943e-05 eta 0:00:43
epoch [47/50] batch [80/132] time 0.082 (0.092) data 0.000 (0.004) loss 0.9182 (0.6502) ce_loss 0.5869 (0.2114) teacher_loss 0.3804 (0.1494) loss_zs_kd 0.0508 (0.0565) loss_oracle 0.5124 (0.4726) acc 84.3750 (92.9297) kd_loss 0.9124 (0.9170) lr 4.8943e-05 eta 0:00:41
epoch [47/50] batch [100/132] time 0.089 (0.092) data 0.000 (0.003) loss 0.8311 (0.6489) ce_loss 0.3228 (0.2093) teacher_loss 0.2024 (0.1469) loss_zs_kd 0.0896 (0.0554) loss_oracle 0.5839 (0.4744) acc 90.6250 (93.0312) kd_loss 0.9281 (0.9150) lr 4.8943e-05 eta 0:00:39
epoch [47/50] batch [120/132] time 0.082 (0.092) data 0.000 (0.003) loss 0.6289 (0.6460) ce_loss 0.2913 (0.2048) teacher_loss 0.1915 (0.1427) loss_zs_kd 0.0546 (0.0565) loss_oracle 0.4101 (0.4751) acc 93.7500 (93.1771) kd_loss 0.9423 (0.9161) lr 4.8943e-05 eta 0:00:37
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,484
* accuracy: 88.7%
* error: 11.3%
* macro_f1: 91.2%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [48/50] batch [20/132] time 0.084 (0.101) data 0.000 (0.016) loss 0.5359 (0.6439) ce_loss 0.1040 (0.2046) teacher_loss 0.0233 (0.1426) loss_zs_kd 0.0571 (0.0555) loss_oracle 0.4840 (0.4735) acc 96.8750 (92.5000) kd_loss 0.9240 (0.9057) lr 3.1417e-05 eta 0:00:37
epoch [48/50] batch [40/132] time 0.094 (0.093) data 0.000 (0.008) loss 0.8864 (0.6328) ce_loss 0.4998 (0.1879) teacher_loss 0.3279 (0.1279) loss_zs_kd 0.0902 (0.0555) loss_oracle 0.5134 (0.4771) acc 84.3750 (93.4375) kd_loss 0.9354 (0.9162) lr 3.1417e-05 eta 0:00:32
epoch [48/50] batch [60/132] time 0.085 (0.089) data 0.001 (0.006) loss 0.6221 (0.6270) ce_loss 0.1971 (0.1836) teacher_loss 0.1151 (0.1278) loss_zs_kd 0.0379 (0.0541) loss_oracle 0.4880 (0.4721) acc 93.7500 (93.5417) kd_loss 0.8938 (0.9083) lr 3.1417e-05 eta 0:00:30
epoch [48/50] batch [80/132] time 0.081 (0.088) data 0.000 (0.004) loss 0.5837 (0.6316) ce_loss 0.1433 (0.1915) teacher_loss 0.0586 (0.1311) loss_zs_kd 0.0323 (0.0543) loss_oracle 0.5090 (0.4734) acc 96.8750 (93.3984) kd_loss 0.9461 (0.9126) lr 3.1417e-05 eta 0:00:27
epoch [48/50] batch [100/132] time 0.084 (0.087) data 0.000 (0.003) loss 0.6314 (0.6326) ce_loss 0.2094 (0.1923) teacher_loss 0.1299 (0.1337) loss_zs_kd 0.0471 (0.0541) loss_oracle 0.4779 (0.4719) acc 90.6250 (93.3438) kd_loss 0.8859 (0.9098) lr 3.1417e-05 eta 0:00:25
epoch [48/50] batch [120/132] time 0.072 (0.087) data 0.000 (0.003) loss 0.5302 (0.6350) ce_loss 0.0987 (0.1980) teacher_loss 0.0537 (0.1387) loss_zs_kd 0.0478 (0.0545) loss_oracle 0.4526 (0.4690) acc 96.8750 (93.1250) kd_loss 0.8231 (0.9083) lr 3.1417e-05 eta 0:00:23
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,483
* accuracy: 88.7%
* error: 11.3%
* macro_f1: 91.2%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [49/50] batch [20/132] time 0.095 (0.104) data 0.000 (0.016) loss 0.7047 (0.6377) ce_loss 0.2837 (0.1989) teacher_loss 0.2586 (0.1492) loss_zs_kd 0.0564 (0.0480) loss_oracle 0.4178 (0.4646) acc 90.6250 (93.5938) kd_loss 0.8669 (0.9132) lr 1.7713e-05 eta 0:00:25
epoch [49/50] batch [40/132] time 0.081 (0.098) data 0.001 (0.008) loss 0.6558 (0.6614) ce_loss 0.2421 (0.2101) teacher_loss 0.2026 (0.1523) loss_zs_kd 0.0445 (0.0544) loss_oracle 0.4310 (0.4819) acc 90.6250 (92.7344) kd_loss 0.8321 (0.9051) lr 1.7713e-05 eta 0:00:21
epoch [49/50] batch [60/132] time 0.085 (0.094) data 0.001 (0.006) loss 0.7144 (0.6564) ce_loss 0.3462 (0.2095) teacher_loss 0.2489 (0.1526) loss_zs_kd 0.0670 (0.0526) loss_oracle 0.4319 (0.4775) acc 90.6250 (92.9167) kd_loss 0.9049 (0.9037) lr 1.7713e-05 eta 0:00:19
epoch [49/50] batch [80/132] time 0.076 (0.093) data 0.000 (0.004) loss 0.5273 (0.6469) ce_loss 0.1820 (0.2032) teacher_loss 0.0773 (0.1455) loss_zs_kd 0.0426 (0.0534) loss_oracle 0.4287 (0.4746) acc 93.7500 (92.9688) kd_loss 0.9347 (0.9022) lr 1.7713e-05 eta 0:00:17
epoch [49/50] batch [100/132] time 0.087 (0.091) data 0.000 (0.004) loss 0.6054 (0.6485) ce_loss 0.1124 (0.2081) teacher_loss 0.0928 (0.1506) loss_zs_kd 0.0686 (0.0554) loss_oracle 0.4783 (0.4702) acc 96.8750 (92.8750) kd_loss 0.9282 (0.9023) lr 1.7713e-05 eta 0:00:14
epoch [49/50] batch [120/132] time 0.079 (0.090) data 0.000 (0.003) loss 0.5477 (0.6416) ce_loss 0.0735 (0.2030) teacher_loss 0.0631 (0.1472) loss_zs_kd 0.0292 (0.0538) loss_oracle 0.4700 (0.4675) acc 100.0000 (93.0990) kd_loss 0.9431 (0.9039) lr 1.7713e-05 eta 0:00:12
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,484
* accuracy: 88.7%
* error: 11.3%
* macro_f1: 91.2%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
epoch [50/50] batch [20/132] time 0.082 (0.107) data 0.000 (0.017) loss 0.8861 (0.6138) ce_loss 0.5645 (0.1907) teacher_loss 0.3795 (0.1316) loss_zs_kd 0.0584 (0.0573) loss_oracle 0.4774 (0.4535) acc 81.2500 (93.4375) kd_loss 0.9428 (0.9038) lr 7.8853e-06 eta 0:00:11
epoch [50/50] batch [40/132] time 0.086 (0.096) data 0.000 (0.009) loss 0.5513 (0.5948) ce_loss 0.0803 (0.1635) teacher_loss 0.0807 (0.1109) loss_zs_kd 0.0400 (0.0524) loss_oracle 0.4506 (0.4576) acc 100.0000 (94.7656) kd_loss 0.8370 (0.9037) lr 7.8853e-06 eta 0:00:08
epoch [50/50] batch [60/132] time 0.081 (0.092) data 0.001 (0.006) loss 0.5640 (0.6026) ce_loss 0.0500 (0.1761) teacher_loss 0.0220 (0.1190) loss_zs_kd 0.0503 (0.0535) loss_oracle 0.5169 (0.4568) acc 100.0000 (93.9583) kd_loss 0.9175 (0.9020) lr 7.8853e-06 eta 0:00:06
epoch [50/50] batch [80/132] time 0.085 (0.089) data 0.000 (0.004) loss 0.6120 (0.6096) ce_loss 0.1559 (0.1798) teacher_loss 0.0542 (0.1252) loss_zs_kd 0.0619 (0.0546) loss_oracle 0.5268 (0.4570) acc 96.8750 (93.7109) kd_loss 0.9256 (0.9038) lr 7.8853e-06 eta 0:00:04
epoch [50/50] batch [100/132] time 0.090 (0.089) data 0.000 (0.004) loss 0.5582 (0.6195) ce_loss 0.1212 (0.1848) teacher_loss 0.0697 (0.1302) loss_zs_kd 0.0664 (0.0541) loss_oracle 0.4554 (0.4622) acc 96.8750 (93.6875) kd_loss 0.8881 (0.9054) lr 7.8853e-06 eta 0:00:02
epoch [50/50] batch [120/132] time 0.087 (0.088) data 0.001 (0.003) loss 0.5058 (0.6186) ce_loss 0.0627 (0.1857) teacher_loss 0.0532 (0.1290) loss_zs_kd 0.0360 (0.0545) loss_oracle 0.4346 (0.4623) acc 96.8750 (93.6719) kd_loss 0.9288 (0.9049) lr 7.8853e-06 eta 0:00:01
Evaluate on the *val* set
=> result
* total: 1,821
* correct: 1,808
* accuracy: 99.3%
* error: 0.7%
* macro_f1: 99.3%
Evaluate on the *test* set
=> result
* total: 3,928
* correct: 3,483
* accuracy: 88.7%
* error: 11.3%
* macro_f1: 91.2%
******* Domain s best val acc:      99.4%, epoch: 26 *******
******* Domain s best val test acc: 89.8%, epoch: 26 *******
******* Domain s best test acc:     90.4%, epoch: 15 *******
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/s/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:13:59
