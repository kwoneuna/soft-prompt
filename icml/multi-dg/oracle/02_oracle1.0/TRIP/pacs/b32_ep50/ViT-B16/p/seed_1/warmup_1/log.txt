Loading trainer: TRIP
Loading dataset: SPG_PACS
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------------------------------------
Dataset    SPG_PACS
Source     ['art_painting', 'cartoon', 'sketch']
Target     ['photo']
# classes  7
# train_x  5,823
# val      2,497
# test     1,670
---------  -------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/181] time 0.089 (0.126) data 0.000 (0.018) loss 0.6402 (0.5732) ce_loss 0.6392 (0.5724) teacher_loss 0.6399 (0.5725) loss_zs_kd 0.0001 (0.0000) loss_oracle 0.0003 (0.0006) acc 71.8750 (79.0625) kd_loss 0.0009 (0.0024) lr 1.0000e-05 eta 0:18:58
epoch [1/50] batch [40/181] time 0.105 (0.105) data 0.000 (0.009) loss 0.8236 (0.5701) ce_loss 0.8232 (0.5696) teacher_loss 0.8228 (0.5696) loss_zs_kd 0.0012 (0.0002) loss_oracle 0.0001 (0.0004) acc 75.0000 (79.6094) kd_loss 0.0005 (0.0016) lr 1.0000e-05 eta 0:15:43
epoch [1/50] batch [60/181] time 0.082 (0.097) data 0.000 (0.006) loss 0.7319 (0.5606) ce_loss 0.7310 (0.5600) teacher_loss 0.7302 (0.5600) loss_zs_kd 0.0030 (0.0006) loss_oracle 0.0003 (0.0004) acc 78.1250 (80.1042) kd_loss 0.0010 (0.0014) lr 1.0000e-05 eta 0:14:33
epoch [1/50] batch [80/181] time 0.080 (0.094) data 0.000 (0.005) loss 0.4355 (0.5528) ce_loss 0.4331 (0.5519) teacher_loss 0.4329 (0.5519) loss_zs_kd 0.0042 (0.0012) loss_oracle 0.0005 (0.0004) acc 84.3750 (80.3516) kd_loss 0.0016 (0.0014) lr 1.0000e-05 eta 0:14:05
epoch [1/50] batch [100/181] time 0.093 (0.092) data 0.000 (0.004) loss 0.4763 (0.5420) ce_loss 0.4729 (0.5406) teacher_loss 0.4729 (0.5406) loss_zs_kd 0.0057 (0.0019) loss_oracle 0.0006 (0.0004) acc 87.5000 (80.6875) kd_loss 0.0019 (0.0015) lr 1.0000e-05 eta 0:13:45
epoch [1/50] batch [120/181] time 0.086 (0.091) data 0.000 (0.003) loss 0.5668 (0.5260) ce_loss 0.5625 (0.5243) teacher_loss 0.5621 (0.5243) loss_zs_kd 0.0070 (0.0026) loss_oracle 0.0012 (0.0005) acc 81.2500 (81.6146) kd_loss 0.0044 (0.0017) lr 1.0000e-05 eta 0:13:35
epoch [1/50] batch [140/181] time 0.087 (0.091) data 0.001 (0.003) loss 0.3319 (0.5219) ce_loss 0.3267 (0.5197) teacher_loss 0.3265 (0.5196) loss_zs_kd 0.0076 (0.0034) loss_oracle 0.0016 (0.0006) acc 84.3750 (81.8973) kd_loss 0.0055 (0.0022) lr 1.0000e-05 eta 0:13:30
epoch [1/50] batch [160/181] time 0.089 (0.091) data 0.000 (0.003) loss 0.3560 (0.5129) ce_loss 0.3489 (0.5102) teacher_loss 0.3483 (0.5101) loss_zs_kd 0.0094 (0.0041) loss_oracle 0.0031 (0.0008) acc 90.6250 (82.1875) kd_loss 0.0107 (0.0030) lr 1.0000e-05 eta 0:13:30
epoch [1/50] batch [180/181] time 0.075 (0.090) data 0.000 (0.002) loss 0.6252 (0.5127) ce_loss 0.6157 (0.5093) teacher_loss 0.6143 (0.5091) loss_zs_kd 0.0144 (0.0049) loss_oracle 0.0037 (0.0012) acc 81.2500 (82.2222) kd_loss 0.0126 (0.0041) lr 1.0000e-05 eta 0:13:21
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,367
* accuracy: 94.8%
* error: 5.2%
* macro_f1: 95.4%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,669
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain p best val acc:      94.8%, epoch: 1 *******
******* Domain p best val test acc: 99.9%, epoch: 1 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/ana
epoch [2/50] batch [20/181] time 0.059 (0.098) data 0.000 (0.025) loss 0.5952 (0.6097) ce_loss 0.4556 (0.5288) teacher_loss 0.4300 (0.5193) loss_zs_kd 0.0530 (0.0610) loss_oracle 0.1386 (0.0599) acc 87.5000 (82.5000) kd_loss 0.2680 (0.0810) lr 2.0000e-03 eta 0:14:24
epoch [2/50] batch [40/181] time 0.070 (0.085) data 0.000 (0.012) loss 0.5410 (0.6810) ce_loss 0.3113 (0.4821) teacher_loss 0.2939 (0.4596) loss_zs_kd 0.0453 (0.0505) loss_oracle 0.2244 (0.1961) acc 90.6250 (83.5156) kd_loss 0.4107 (0.3134) lr 2.0000e-03 eta 0:12:26
epoch [2/50] batch [60/181] time 0.066 (0.082) data 0.000 (0.008) loss 0.7719 (0.7505) ce_loss 0.3955 (0.4877) teacher_loss 0.3614 (0.4513) loss_zs_kd 0.0518 (0.0478) loss_oracle 0.3846 (0.2753) acc 87.5000 (83.1250) kd_loss 0.6633 (0.4221) lr 2.0000e-03 eta 0:12:01
epoch [2/50] batch [80/181] time 0.078 (0.079) data 0.000 (0.006) loss 0.9377 (0.7756) ce_loss 0.5542 (0.4878) teacher_loss 0.4866 (0.4452) loss_zs_kd 0.0339 (0.0465) loss_oracle 0.4342 (0.3071) acc 81.2500 (83.1641) kd_loss 0.7777 (0.5029) lr 2.0000e-03 eta 0:11:36
epoch [2/50] batch [100/181] time 0.068 (0.078) data 0.000 (0.005) loss 0.5759 (0.7954) ce_loss 0.2949 (0.4836) teacher_loss 0.2506 (0.4377) loss_zs_kd 0.0244 (0.0437) loss_oracle 0.3132 (0.3358) acc 90.6250 (83.2188) kd_loss 0.8178 (0.5646) lr 2.0000e-03 eta 0:11:19
epoch [2/50] batch [120/181] time 0.081 (0.078) data 0.000 (0.004) loss 0.6955 (0.7902) ce_loss 0.3494 (0.4807) teacher_loss 0.2877 (0.4314) loss_zs_kd 0.0340 (0.0432) loss_oracle 0.3908 (0.3372) acc 87.5000 (83.3594) kd_loss 0.7304 (0.5996) lr 2.0000e-03 eta 0:11:20
epoch [2/50] batch [140/181] time 0.063 (0.078) data 0.000 (0.004) loss 0.9908 (0.7881) ce_loss 0.7686 (0.4772) teacher_loss 0.5097 (0.4196) loss_zs_kd 0.0855 (0.0455) loss_oracle 0.4384 (0.3458) acc 68.7500 (83.5045) kd_loss 0.8489 (0.6224) lr 2.0000e-03 eta 0:11:18
epoch [2/50] batch [160/181] time 0.084 (0.078) data 0.000 (0.003) loss 0.7266 (0.8036) ce_loss 0.3330 (0.4843) teacher_loss 0.2491 (0.4140) loss_zs_kd 0.0819 (0.0509) loss_oracle 0.4365 (0.3642) acc 87.5000 (83.2812) kd_loss 0.7955 (0.6462) lr 2.0000e-03 eta 0:11:17
epoch [2/50] batch [180/181] time 0.068 (0.077) data 0.000 (0.003) loss 0.7837 (0.8139) ce_loss 0.4170 (0.4822) teacher_loss 0.2463 (0.4083) loss_zs_kd 0.0697 (0.0530) loss_oracle 0.5026 (0.3790) acc 87.5000 (83.2292) kd_loss 0.8225 (0.6652) lr 2.0000e-03 eta 0:11:11
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,363
* accuracy: 94.6%
* error: 5.4%
* macro_f1: 95.3%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      94.8%, epoch: 1 *******
******* Domain p best val test acc: 99.9%, epoch: 1 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [3/50] batch [20/181] time 0.068 (0.093) data 0.000 (0.014) loss 0.8664 (0.8703) ce_loss 0.4333 (0.4190) teacher_loss 0.2525 (0.2848) loss_zs_kd 0.0797 (0.0834) loss_oracle 0.5741 (0.5438) acc 84.3750 (84.0625) kd_loss 0.8510 (0.8404) lr 1.9980e-03 eta 0:13:28
epoch [3/50] batch [40/181] time 0.082 (0.085) data 0.000 (0.007) loss 0.9515 (0.8815) ce_loss 0.5156 (0.4272) teacher_loss 0.4286 (0.3043) loss_zs_kd 0.0680 (0.0784) loss_oracle 0.4889 (0.5380) acc 81.2500 (84.3750) kd_loss 0.7360 (0.8374) lr 1.9980e-03 eta 0:12:14
epoch [3/50] batch [60/181] time 0.071 (0.084) data 0.000 (0.005) loss 0.9650 (0.8885) ce_loss 0.5811 (0.4500) teacher_loss 0.4471 (0.3192) loss_zs_kd 0.0855 (0.0787) loss_oracle 0.4752 (0.5299) acc 78.1250 (83.0729) kd_loss 0.8654 (0.8377) lr 1.9980e-03 eta 0:12:01
epoch [3/50] batch [80/181] time 0.084 (0.085) data 0.000 (0.004) loss 0.9647 (0.8725) ce_loss 0.5083 (0.4484) teacher_loss 0.4043 (0.3285) loss_zs_kd 0.0606 (0.0770) loss_oracle 0.5300 (0.5055) acc 78.1250 (83.3594) kd_loss 0.8396 (0.8228) lr 1.9980e-03 eta 0:12:08
epoch [3/50] batch [100/181] time 0.077 (0.084) data 0.000 (0.003) loss 0.5438 (0.8658) ce_loss 0.1556 (0.4471) teacher_loss 0.1289 (0.3293) loss_zs_kd 0.0546 (0.0764) loss_oracle 0.3876 (0.4983) acc 96.8750 (83.3125) kd_loss 0.7607 (0.8215) lr 1.9980e-03 eta 0:12:00
epoch [3/50] batch [120/181] time 0.084 (0.084) data 0.000 (0.003) loss 0.9721 (0.8634) ce_loss 0.4651 (0.4480) teacher_loss 0.4149 (0.3317) loss_zs_kd 0.0542 (0.0763) loss_oracle 0.5301 (0.4936) acc 81.2500 (83.5417) kd_loss 0.8629 (0.8184) lr 1.9980e-03 eta 0:11:56
epoch [3/50] batch [140/181] time 0.066 (0.083) data 0.000 (0.002) loss 0.8263 (0.8655) ce_loss 0.4529 (0.4537) teacher_loss 0.3235 (0.3370) loss_zs_kd 0.0624 (0.0753) loss_oracle 0.4716 (0.4908) acc 84.3750 (83.2589) kd_loss 0.8452 (0.8190) lr 1.9980e-03 eta 0:11:46
epoch [3/50] batch [160/181] time 0.082 (0.083) data 0.000 (0.002) loss 0.7534 (0.8568) ce_loss 0.4187 (0.4525) teacher_loss 0.3634 (0.3396) loss_zs_kd 0.0520 (0.0735) loss_oracle 0.3640 (0.4805) acc 81.2500 (83.3008) kd_loss 0.8248 (0.8184) lr 1.9980e-03 eta 0:11:44
epoch [3/50] batch [180/181] time 0.076 (0.082) data 0.000 (0.002) loss 0.7630 (0.8516) ce_loss 0.3738 (0.4558) teacher_loss 0.1942 (0.3407) loss_zs_kd 0.1050 (0.0735) loss_oracle 0.5164 (0.4742) acc 87.5000 (83.2118) kd_loss 0.8584 (0.8170) lr 1.9980e-03 eta 0:11:36
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,376
* accuracy: 95.2%
* error: 4.8%
* macro_f1: 95.8%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,669
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.2%, epoch: 3 *******
******* Domain p best val test acc: 99.9%, epoch: 3 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [4/50] batch [20/181] time 0.084 (0.093) data 0.000 (0.013) loss 0.5517 (0.8152) ce_loss 0.1755 (0.4341) teacher_loss 0.1040 (0.3245) loss_zs_kd 0.0519 (0.0932) loss_oracle 0.4217 (0.4441) acc 90.6250 (83.5938) kd_loss 0.8416 (0.8032) lr 1.9921e-03 eta 0:13:11
epoch [4/50] batch [40/181] time 0.091 (0.090) data 0.000 (0.007) loss 1.1054 (0.8528) ce_loss 0.6416 (0.4600) teacher_loss 0.5601 (0.3452) loss_zs_kd 0.0877 (0.0844) loss_oracle 0.5014 (0.4654) acc 78.1250 (83.2812) kd_loss 0.8477 (0.8350) lr 1.9921e-03 eta 0:12:38
epoch [4/50] batch [60/181] time 0.090 (0.088) data 0.000 (0.005) loss 0.9655 (0.8554) ce_loss 0.5693 (0.4593) teacher_loss 0.4222 (0.3379) loss_zs_kd 0.0929 (0.0842) loss_oracle 0.4968 (0.4753) acc 81.2500 (83.5938) kd_loss 0.8528 (0.8457) lr 1.9921e-03 eta 0:12:24
epoch [4/50] batch [80/181] time 0.073 (0.087) data 0.000 (0.004) loss 0.7363 (0.8512) ce_loss 0.3762 (0.4534) teacher_loss 0.2690 (0.3383) loss_zs_kd 0.0418 (0.0808) loss_oracle 0.4464 (0.4724) acc 87.5000 (83.8672) kd_loss 0.9196 (0.8513) lr 1.9921e-03 eta 0:12:12
epoch [4/50] batch [100/181] time 0.065 (0.085) data 0.000 (0.003) loss 1.0023 (0.8569) ce_loss 0.5352 (0.4631) teacher_loss 0.4857 (0.3468) loss_zs_kd 0.1107 (0.0802) loss_oracle 0.4613 (0.4700) acc 81.2500 (83.5312) kd_loss 0.8363 (0.8494) lr 1.9921e-03 eta 0:11:55
epoch [4/50] batch [120/181] time 0.080 (0.083) data 0.000 (0.002) loss 0.7919 (0.8691) ce_loss 0.3933 (0.4773) teacher_loss 0.2939 (0.3581) loss_zs_kd 0.0730 (0.0802) loss_oracle 0.4615 (0.4708) acc 81.2500 (82.9167) kd_loss 0.8264 (0.8472) lr 1.9921e-03 eta 0:11:38
epoch [4/50] batch [140/181] time 0.058 (0.082) data 0.000 (0.002) loss 0.8264 (0.8595) ce_loss 0.4646 (0.4668) teacher_loss 0.3257 (0.3503) loss_zs_kd 0.0718 (0.0785) loss_oracle 0.4648 (0.4699) acc 81.2500 (83.1250) kd_loss 0.8939 (0.8449) lr 1.9921e-03 eta 0:11:24
epoch [4/50] batch [160/181] time 0.065 (0.080) data 0.000 (0.002) loss 0.8263 (0.8586) ce_loss 0.3425 (0.4631) teacher_loss 0.3350 (0.3475) loss_zs_kd 0.0603 (0.0787) loss_oracle 0.4612 (0.4718) acc 87.5000 (83.3008) kd_loss 0.7876 (0.8446) lr 1.9921e-03 eta 0:11:11
epoch [4/50] batch [180/181] time 0.080 (0.080) data 0.000 (0.002) loss 1.0183 (0.8581) ce_loss 0.6318 (0.4605) teacher_loss 0.5246 (0.3476) loss_zs_kd 0.0839 (0.0788) loss_oracle 0.4518 (0.4711) acc 87.5000 (83.3854) kd_loss 0.8180 (0.8427) lr 1.9921e-03 eta 0:11:10
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,384
* accuracy: 95.5%
* error: 4.5%
* macro_f1: 96.1%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.5%, epoch: 4 *******
******* Domain p best val test acc: 99.9%, epoch: 4 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [5/50] batch [20/181] time 0.074 (0.096) data 0.000 (0.016) loss 0.7375 (0.8841) ce_loss 0.2991 (0.4598) teacher_loss 0.2566 (0.3781) loss_zs_kd 0.0586 (0.0727) loss_oracle 0.4516 (0.4697) acc 90.6250 (82.1875) kd_loss 0.8472 (0.8350) lr 1.9823e-03 eta 0:13:13
epoch [5/50] batch [40/181] time 0.082 (0.086) data 0.000 (0.008) loss 0.8898 (0.8588) ce_loss 0.4458 (0.4293) teacher_loss 0.3812 (0.3408) loss_zs_kd 0.0803 (0.0717) loss_oracle 0.4684 (0.4821) acc 81.2500 (83.8281) kd_loss 0.8822 (0.8413) lr 1.9823e-03 eta 0:11:52
epoch [5/50] batch [60/181] time 0.090 (0.084) data 0.001 (0.006) loss 0.7003 (0.8732) ce_loss 0.3037 (0.4410) teacher_loss 0.2408 (0.3521) loss_zs_kd 0.0790 (0.0799) loss_oracle 0.4200 (0.4811) acc 87.5000 (83.6458) kd_loss 0.8331 (0.8481) lr 1.9823e-03 eta 0:11:36
epoch [5/50] batch [80/181] time 0.081 (0.083) data 0.001 (0.004) loss 0.8495 (0.8763) ce_loss 0.4341 (0.4363) teacher_loss 0.3627 (0.3571) loss_zs_kd 0.0775 (0.0790) loss_oracle 0.4480 (0.4798) acc 87.5000 (84.0234) kd_loss 0.8279 (0.8542) lr 1.9823e-03 eta 0:11:26
epoch [5/50] batch [100/181] time 0.085 (0.084) data 0.000 (0.003) loss 0.8095 (0.8799) ce_loss 0.3181 (0.4411) teacher_loss 0.2918 (0.3585) loss_zs_kd 0.0881 (0.0792) loss_oracle 0.4737 (0.4818) acc 87.5000 (83.8125) kd_loss 0.8614 (0.8549) lr 1.9823e-03 eta 0:11:29
epoch [5/50] batch [120/181] time 0.078 (0.084) data 0.000 (0.003) loss 0.8575 (0.8848) ce_loss 0.3875 (0.4447) teacher_loss 0.3339 (0.3644) loss_zs_kd 0.0583 (0.0791) loss_oracle 0.4945 (0.4808) acc 84.3750 (83.5938) kd_loss 0.8366 (0.8507) lr 1.9823e-03 eta 0:11:25
epoch [5/50] batch [140/181] time 0.068 (0.083) data 0.000 (0.003) loss 0.7823 (0.8838) ce_loss 0.3093 (0.4460) teacher_loss 0.2601 (0.3629) loss_zs_kd 0.0942 (0.0808) loss_oracle 0.4751 (0.4806) acc 90.6250 (83.6384) kd_loss 0.8514 (0.8477) lr 1.9823e-03 eta 0:11:20
epoch [5/50] batch [160/181] time 0.091 (0.083) data 0.000 (0.002) loss 0.7080 (0.8777) ce_loss 0.2837 (0.4461) teacher_loss 0.2274 (0.3617) loss_zs_kd 0.0584 (0.0805) loss_oracle 0.4514 (0.4757) acc 84.3750 (83.6914) kd_loss 0.8942 (0.8448) lr 1.9823e-03 eta 0:11:18
epoch [5/50] batch [180/181] time 0.075 (0.083) data 0.000 (0.002) loss 1.0029 (0.8776) ce_loss 0.3845 (0.4445) teacher_loss 0.3566 (0.3598) loss_zs_kd 0.1081 (0.0799) loss_oracle 0.5922 (0.4779) acc 84.3750 (83.9410) kd_loss 0.9277 (0.8473) lr 1.9823e-03 eta 0:11:12
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,384
* accuracy: 95.5%
* error: 4.5%
* macro_f1: 96.1%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.5%, epoch: 4 *******
******* Domain p best val test acc: 99.9%, epoch: 4 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [6/50] batch [20/181] time 0.087 (0.109) data 0.000 (0.014) loss 0.8070 (0.9050) ce_loss 0.3555 (0.4111) teacher_loss 0.2291 (0.3093) loss_zs_kd 0.1100 (0.0929) loss_oracle 0.5228 (0.5493) acc 90.6250 (85.7812) kd_loss 0.8534 (0.9145) lr 1.9686e-03 eta 0:14:43
epoch [6/50] batch [40/181] time 0.087 (0.100) data 0.000 (0.007) loss 0.6714 (0.8808) ce_loss 0.2834 (0.3914) teacher_loss 0.1432 (0.2923) loss_zs_kd 0.0595 (0.0926) loss_oracle 0.4985 (0.5422) acc 87.5000 (85.7812) kd_loss 0.9228 (0.9190) lr 1.9686e-03 eta 0:13:26
epoch [6/50] batch [60/181] time 0.086 (0.096) data 0.000 (0.005) loss 0.9308 (0.8760) ce_loss 0.4397 (0.3934) teacher_loss 0.3306 (0.2963) loss_zs_kd 0.0834 (0.0911) loss_oracle 0.5584 (0.5342) acc 84.3750 (85.7812) kd_loss 0.9750 (0.9231) lr 1.9686e-03 eta 0:12:53
epoch [6/50] batch [80/181] time 0.094 (0.094) data 0.001 (0.004) loss 0.9729 (0.8863) ce_loss 0.4338 (0.3921) teacher_loss 0.3533 (0.2988) loss_zs_kd 0.1114 (0.0910) loss_oracle 0.5639 (0.5420) acc 81.2500 (85.9375) kd_loss 0.9157 (0.9288) lr 1.9686e-03 eta 0:12:40
epoch [6/50] batch [100/181] time 0.087 (0.093) data 0.000 (0.003) loss 1.1433 (0.9010) ce_loss 0.6333 (0.4010) teacher_loss 0.4142 (0.3042) loss_zs_kd 0.1006 (0.0931) loss_oracle 0.6788 (0.5503) acc 81.2500 (85.6250) kd_loss 1.0174 (0.9351) lr 1.9686e-03 eta 0:12:30
epoch [6/50] batch [120/181] time 0.091 (0.092) data 0.000 (0.003) loss 1.1915 (0.9058) ce_loss 0.6313 (0.4029) teacher_loss 0.5451 (0.3036) loss_zs_kd 0.1089 (0.0928) loss_oracle 0.5920 (0.5558) acc 81.2500 (85.5990) kd_loss 0.9749 (0.9387) lr 1.9686e-03 eta 0:12:22
epoch [6/50] batch [140/181] time 0.088 (0.092) data 0.000 (0.002) loss 1.0541 (0.9257) ce_loss 0.4910 (0.4174) teacher_loss 0.3003 (0.3126) loss_zs_kd 0.1427 (0.0959) loss_oracle 0.6824 (0.5652) acc 81.2500 (85.0446) kd_loss 1.1183 (0.9490) lr 1.9686e-03 eta 0:12:20
epoch [6/50] batch [160/181] time 0.084 (0.092) data 0.000 (0.002) loss 0.9067 (0.9366) ce_loss 0.3674 (0.4237) teacher_loss 0.3188 (0.3134) loss_zs_kd 0.0862 (0.0979) loss_oracle 0.5448 (0.5743) acc 81.2500 (84.9414) kd_loss 1.0461 (0.9591) lr 1.9686e-03 eta 0:12:14
epoch [6/50] batch [180/181] time 0.082 (0.091) data 0.001 (0.002) loss 0.8258 (0.9348) ce_loss 0.3394 (0.4262) teacher_loss 0.2439 (0.3139) loss_zs_kd 0.0854 (0.0997) loss_oracle 0.5392 (0.5710) acc 84.3750 (84.7569) kd_loss 0.9417 (0.9637) lr 1.9686e-03 eta 0:12:03
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,387
* accuracy: 95.6%
* error: 4.4%
* macro_f1: 96.1%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.6%, epoch: 6 *******
******* Domain p best val test acc: 99.9%, epoch: 6 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [7/50] batch [20/181] time 0.093 (0.101) data 0.001 (0.015) loss 0.9162 (0.9447) ce_loss 0.3623 (0.4315) teacher_loss 0.2630 (0.3152) loss_zs_kd 0.1046 (0.1159) loss_oracle 0.6010 (0.5715) acc 90.6250 (82.9688) kd_loss 0.9577 (0.9943) lr 1.9511e-03 eta 0:13:23
epoch [7/50] batch [40/181] time 0.099 (0.094) data 0.000 (0.007) loss 0.8085 (0.9428) ce_loss 0.3174 (0.4313) teacher_loss 0.2277 (0.3188) loss_zs_kd 0.0662 (0.1081) loss_oracle 0.5478 (0.5699) acc 87.5000 (83.2031) kd_loss 0.9737 (0.9932) lr 1.9511e-03 eta 0:12:20
epoch [7/50] batch [60/181] time 0.087 (0.091) data 0.000 (0.005) loss 1.0962 (0.9327) ce_loss 0.5811 (0.4263) teacher_loss 0.4174 (0.3065) loss_zs_kd 0.1408 (0.1083) loss_oracle 0.6084 (0.5720) acc 71.8750 (83.9062) kd_loss 0.9548 (0.9865) lr 1.9511e-03 eta 0:11:56
epoch [7/50] batch [80/181] time 0.083 (0.090) data 0.000 (0.004) loss 0.8720 (0.9293) ce_loss 0.3232 (0.4207) teacher_loss 0.3204 (0.3009) loss_zs_kd 0.0834 (0.1069) loss_oracle 0.5099 (0.5749) acc 87.5000 (84.2969) kd_loss 0.9575 (0.9776) lr 1.9511e-03 eta 0:11:46
epoch [7/50] batch [100/181] time 0.078 (0.089) data 0.000 (0.003) loss 1.0647 (0.9314) ce_loss 0.5723 (0.4183) teacher_loss 0.4443 (0.2968) loss_zs_kd 0.0872 (0.1064) loss_oracle 0.5769 (0.5814) acc 81.2500 (84.5000) kd_loss 1.0201 (0.9738) lr 1.9511e-03 eta 0:11:39
epoch [7/50] batch [120/181] time 0.085 (0.089) data 0.000 (0.003) loss 1.0206 (0.9396) ce_loss 0.4604 (0.4218) teacher_loss 0.2559 (0.3017) loss_zs_kd 0.1065 (0.1040) loss_oracle 0.7114 (0.5859) acc 81.2500 (84.4271) kd_loss 1.0192 (0.9698) lr 1.9511e-03 eta 0:11:35
epoch [7/50] batch [140/181] time 0.086 (0.088) data 0.000 (0.002) loss 1.0145 (0.9521) ce_loss 0.5688 (0.4259) teacher_loss 0.3186 (0.3038) loss_zs_kd 0.0909 (0.1044) loss_oracle 0.6504 (0.5961) acc 78.1250 (84.1518) kd_loss 1.0071 (0.9721) lr 1.9511e-03 eta 0:11:31
epoch [7/50] batch [160/181] time 0.093 (0.088) data 0.000 (0.002) loss 1.0444 (0.9682) ce_loss 0.2883 (0.4237) teacher_loss 0.2188 (0.3033) loss_zs_kd 0.1007 (0.1040) loss_oracle 0.7752 (0.6129) acc 87.5000 (84.1992) kd_loss 1.0200 (0.9786) lr 1.9511e-03 eta 0:11:29
epoch [7/50] batch [180/181] time 0.082 (0.088) data 0.000 (0.002) loss 0.8090 (0.9728) ce_loss 0.4009 (0.4224) teacher_loss 0.1634 (0.3028) loss_zs_kd 0.0695 (0.1036) loss_oracle 0.6109 (0.6183) acc 87.5000 (84.2188) kd_loss 1.0826 (0.9863) lr 1.9511e-03 eta 0:11:25
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,379
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.9%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,669
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.6%, epoch: 6 *******
******* Domain p best val test acc: 99.9%, epoch: 6 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [8/50] batch [20/181] time 0.084 (0.093) data 0.000 (0.013) loss 1.2476 (1.1171) ce_loss 0.5767 (0.4541) teacher_loss 0.4086 (0.3160) loss_zs_kd 0.0737 (0.1347) loss_oracle 0.8022 (0.7338) acc 84.3750 (83.9062) kd_loss 1.0125 (1.0299) lr 1.9298e-03 eta 0:11:59
epoch [8/50] batch [40/181] time 0.080 (0.089) data 0.000 (0.006) loss 1.0356 (1.1105) ce_loss 0.2324 (0.4365) teacher_loss 0.1833 (0.3156) loss_zs_kd 0.1027 (0.1132) loss_oracle 0.8010 (0.7383) acc 96.8750 (84.0625) kd_loss 1.0353 (1.0309) lr 1.9298e-03 eta 0:11:28
epoch [8/50] batch [60/181] time 0.089 (0.088) data 0.001 (0.004) loss 1.0337 (1.1170) ce_loss 0.4050 (0.4552) teacher_loss 0.3596 (0.3322) loss_zs_kd 0.0878 (0.1106) loss_oracle 0.6301 (0.7295) acc 87.5000 (82.9688) kd_loss 0.9874 (1.0326) lr 1.9298e-03 eta 0:11:19
epoch [8/50] batch [80/181] time 0.090 (0.088) data 0.000 (0.003) loss 0.9789 (1.0964) ce_loss 0.4924 (0.4483) teacher_loss 0.2340 (0.3229) loss_zs_kd 0.0761 (0.1072) loss_oracle 0.7069 (0.7199) acc 75.0000 (82.8125) kd_loss 1.0665 (1.0344) lr 1.9298e-03 eta 0:11:14
epoch [8/50] batch [100/181] time 0.082 (0.088) data 0.000 (0.003) loss 1.2430 (1.0927) ce_loss 0.5698 (0.4432) teacher_loss 0.4746 (0.3181) loss_zs_kd 0.0872 (0.1075) loss_oracle 0.7248 (0.7209) acc 78.1250 (83.0000) kd_loss 0.9483 (1.0314) lr 1.9298e-03 eta 0:11:13
epoch [8/50] batch [120/181] time 0.082 (0.087) data 0.000 (0.002) loss 1.0926 (1.0848) ce_loss 0.5332 (0.4364) teacher_loss 0.3408 (0.3129) loss_zs_kd 0.0754 (0.1025) loss_oracle 0.7141 (0.7206) acc 84.3750 (83.4115) kd_loss 1.0109 (1.0293) lr 1.9298e-03 eta 0:11:07
epoch [8/50] batch [140/181] time 0.086 (0.087) data 0.000 (0.002) loss 1.0556 (1.0799) ce_loss 0.4419 (0.4359) teacher_loss 0.2946 (0.3116) loss_zs_kd 0.0866 (0.1010) loss_oracle 0.7178 (0.7178) acc 84.3750 (83.5491) kd_loss 1.0587 (1.0290) lr 1.9298e-03 eta 0:11:05
epoch [8/50] batch [160/181] time 0.089 (0.087) data 0.000 (0.002) loss 1.2585 (1.0798) ce_loss 0.6743 (0.4386) teacher_loss 0.4253 (0.3129) loss_zs_kd 0.1479 (0.1010) loss_oracle 0.7593 (0.7164) acc 84.3750 (83.5938) kd_loss 1.0110 (1.0256) lr 1.9298e-03 eta 0:11:05
epoch [8/50] batch [180/181] time 0.070 (0.087) data 0.000 (0.002) loss 1.1161 (1.0836) ce_loss 0.3928 (0.4454) teacher_loss 0.3500 (0.3170) loss_zs_kd 0.0787 (0.1019) loss_oracle 0.7268 (0.7156) acc 90.6250 (83.4028) kd_loss 0.9945 (1.0222) lr 1.9298e-03 eta 0:10:57
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,379
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.9%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,666
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      95.6%, epoch: 6 *******
******* Domain p best val test acc: 99.9%, epoch: 6 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [9/50] batch [20/181] time 0.077 (0.101) data 0.000 (0.018) loss 1.0298 (1.0609) ce_loss 0.4260 (0.4703) teacher_loss 0.3078 (0.2984) loss_zs_kd 0.1577 (0.1198) loss_oracle 0.6432 (0.7026) acc 87.5000 (82.3438) kd_loss 1.0134 (0.9984) lr 1.9048e-03 eta 0:12:46
epoch [9/50] batch [40/181] time 0.089 (0.090) data 0.001 (0.009) loss 0.9543 (1.0650) ce_loss 0.4343 (0.4769) teacher_loss 0.2673 (0.3045) loss_zs_kd 0.0895 (0.1171) loss_oracle 0.6422 (0.7019) acc 87.5000 (82.3438) kd_loss 1.0330 (0.9947) lr 1.9048e-03 eta 0:11:17
epoch [9/50] batch [60/181] time 0.086 (0.088) data 0.001 (0.006) loss 0.9328 (1.0636) ce_loss 0.3384 (0.4739) teacher_loss 0.1978 (0.3172) loss_zs_kd 0.0859 (0.1086) loss_oracle 0.6921 (0.6920) acc 84.3750 (81.9271) kd_loss 0.9592 (0.9885) lr 1.9048e-03 eta 0:11:05
epoch [9/50] batch [80/181] time 0.091 (0.088) data 0.000 (0.005) loss 1.0208 (1.0614) ce_loss 0.3132 (0.4698) teacher_loss 0.3077 (0.3177) loss_zs_kd 0.0791 (0.1050) loss_oracle 0.6736 (0.6912) acc 90.6250 (82.3828) kd_loss 0.9136 (0.9858) lr 1.9048e-03 eta 0:11:00
epoch [9/50] batch [100/181] time 0.087 (0.088) data 0.000 (0.004) loss 0.9687 (1.0540) ce_loss 0.3403 (0.4663) teacher_loss 0.2491 (0.3153) loss_zs_kd 0.0425 (0.1028) loss_oracle 0.6983 (0.6873) acc 87.5000 (82.3750) kd_loss 1.0122 (0.9830) lr 1.9048e-03 eta 0:11:01
epoch [9/50] batch [120/181] time 0.078 (0.088) data 0.000 (0.003) loss 0.9405 (1.0516) ce_loss 0.4941 (0.4661) teacher_loss 0.3176 (0.3167) loss_zs_kd 0.0870 (0.1034) loss_oracle 0.5793 (0.6832) acc 84.3750 (82.4740) kd_loss 0.9743 (0.9790) lr 1.9048e-03 eta 0:10:56
epoch [9/50] batch [140/181] time 0.082 (0.088) data 0.000 (0.003) loss 0.9194 (1.0521) ce_loss 0.4087 (0.4707) teacher_loss 0.2031 (0.3224) loss_zs_kd 0.0640 (0.1009) loss_oracle 0.6843 (0.6792) acc 87.5000 (82.4554) kd_loss 1.0048 (0.9768) lr 1.9048e-03 eta 0:10:53
epoch [9/50] batch [160/181] time 0.094 (0.088) data 0.000 (0.003) loss 0.9910 (1.0484) ce_loss 0.4607 (0.4684) teacher_loss 0.3374 (0.3211) loss_zs_kd 0.0962 (0.1014) loss_oracle 0.6056 (0.6767) acc 87.5000 (82.6562) kd_loss 0.9120 (0.9724) lr 1.9048e-03 eta 0:10:51
epoch [9/50] batch [180/181] time 0.082 (0.088) data 0.000 (0.002) loss 1.0554 (1.0352) ce_loss 0.5249 (0.4587) teacher_loss 0.4088 (0.3138) loss_zs_kd 0.1156 (0.1005) loss_oracle 0.5888 (0.6711) acc 71.8750 (83.0382) kd_loss 0.9238 (0.9695) lr 1.9048e-03 eta 0:10:50
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,379
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 95.9%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,669
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.6%, epoch: 6 *******
******* Domain p best val test acc: 99.9%, epoch: 6 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [10/50] batch [20/181] time 0.087 (0.112) data 0.000 (0.016) loss 0.8479 (0.9809) ce_loss 0.4329 (0.4872) teacher_loss 0.2406 (0.3358) loss_zs_kd 0.0873 (0.0949) loss_oracle 0.5637 (0.5977) acc 87.5000 (81.8750) kd_loss 0.9684 (0.9292) lr 1.8763e-03 eta 0:13:46
epoch [10/50] batch [40/181] time 0.092 (0.102) data 0.000 (0.008) loss 0.7941 (0.9430) ce_loss 0.2893 (0.4523) teacher_loss 0.2268 (0.3080) loss_zs_kd 0.0937 (0.0954) loss_oracle 0.5204 (0.5872) acc 90.6250 (83.9844) kd_loss 0.8960 (0.9273) lr 1.8763e-03 eta 0:12:32
epoch [10/50] batch [60/181] time 0.093 (0.098) data 0.000 (0.006) loss 0.8219 (0.9173) ce_loss 0.3743 (0.4356) teacher_loss 0.2372 (0.3002) loss_zs_kd 0.0940 (0.0941) loss_oracle 0.5377 (0.5700) acc 90.6250 (84.2708) kd_loss 0.9500 (0.9239) lr 1.8763e-03 eta 0:12:02
epoch [10/50] batch [80/181] time 0.094 (0.096) data 0.000 (0.004) loss 0.7610 (0.9215) ce_loss 0.2378 (0.4480) teacher_loss 0.1225 (0.3042) loss_zs_kd 0.1068 (0.0958) loss_oracle 0.5850 (0.5694) acc 93.7500 (83.7500) kd_loss 0.9113 (0.9248) lr 1.8763e-03 eta 0:11:46
epoch [10/50] batch [100/181] time 0.084 (0.095) data 0.000 (0.004) loss 1.0281 (0.9281) ce_loss 0.5239 (0.4570) teacher_loss 0.3667 (0.3025) loss_zs_kd 0.1872 (0.1001) loss_oracle 0.5678 (0.5755) acc 75.0000 (83.3438) kd_loss 0.8799 (0.9238) lr 1.8763e-03 eta 0:11:34
epoch [10/50] batch [120/181] time 0.098 (0.094) data 0.000 (0.003) loss 0.9783 (0.9338) ce_loss 0.4512 (0.4584) teacher_loss 0.2946 (0.3068) loss_zs_kd 0.0939 (0.1002) loss_oracle 0.6367 (0.5769) acc 84.3750 (83.2552) kd_loss 0.9760 (0.9235) lr 1.8763e-03 eta 0:11:29
epoch [10/50] batch [140/181] time 0.102 (0.094) data 0.000 (0.003) loss 0.9191 (0.9377) ce_loss 0.5239 (0.4613) teacher_loss 0.3191 (0.3100) loss_zs_kd 0.1126 (0.0992) loss_oracle 0.5438 (0.5780) acc 75.0000 (83.1696) kd_loss 0.9584 (0.9206) lr 1.8763e-03 eta 0:11:22
epoch [10/50] batch [160/181] time 0.095 (0.094) data 0.000 (0.002) loss 0.9272 (0.9269) ce_loss 0.6021 (0.4544) teacher_loss 0.2712 (0.3036) loss_zs_kd 0.1057 (0.0993) loss_oracle 0.6032 (0.5737) acc 75.0000 (83.3008) kd_loss 0.9628 (0.9185) lr 1.8763e-03 eta 0:11:24
epoch [10/50] batch [180/181] time 0.082 (0.093) data 0.000 (0.002) loss 0.8506 (0.9244) ce_loss 0.5073 (0.4497) teacher_loss 0.2017 (0.3015) loss_zs_kd 0.0846 (0.0986) loss_oracle 0.6066 (0.5735) acc 78.1250 (83.4201) kd_loss 0.9658 (0.9172) lr 1.8763e-03 eta 0:11:14
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,378
* accuracy: 95.2%
* error: 4.8%
* macro_f1: 95.8%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      95.6%, epoch: 6 *******
******* Domain p best val test acc: 99.9%, epoch: 6 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [11/50] batch [20/181] time 0.080 (0.110) data 0.001 (0.018) loss 1.0979 (0.9220) ce_loss 0.6279 (0.4165) teacher_loss 0.3807 (0.2788) loss_zs_kd 0.1468 (0.1118) loss_oracle 0.6438 (0.5873) acc 68.7500 (83.7500) kd_loss 0.9623 (0.9014) lr 1.8443e-03 eta 0:13:17
epoch [11/50] batch [40/181] time 0.089 (0.101) data 0.000 (0.009) loss 0.9369 (0.9219) ce_loss 0.4395 (0.4328) teacher_loss 0.2335 (0.2750) loss_zs_kd 0.1063 (0.1085) loss_oracle 0.6503 (0.5926) acc 84.3750 (84.4531) kd_loss 0.9953 (0.9098) lr 1.8443e-03 eta 0:12:05
epoch [11/50] batch [60/181] time 0.103 (0.097) data 0.001 (0.006) loss 0.9488 (0.9430) ce_loss 0.5327 (0.4527) teacher_loss 0.3557 (0.2904) loss_zs_kd 0.0791 (0.1064) loss_oracle 0.5535 (0.5993) acc 78.1250 (84.0104) kd_loss 0.9006 (0.9210) lr 1.8443e-03 eta 0:11:38
epoch [11/50] batch [80/181] time 0.093 (0.098) data 0.001 (0.005) loss 0.8508 (0.9300) ce_loss 0.5435 (0.4406) teacher_loss 0.3392 (0.2838) loss_zs_kd 0.0774 (0.1074) loss_oracle 0.4729 (0.5925) acc 84.3750 (84.2578) kd_loss 0.8236 (0.9185) lr 1.8443e-03 eta 0:11:39
epoch [11/50] batch [100/181] time 0.090 (0.097) data 0.000 (0.004) loss 0.8597 (0.9198) ce_loss 0.3030 (0.4266) teacher_loss 0.1501 (0.2775) loss_zs_kd 0.0598 (0.1052) loss_oracle 0.6797 (0.5897) acc 90.6250 (84.9375) kd_loss 1.0363 (0.9135) lr 1.8443e-03 eta 0:11:29
epoch [11/50] batch [120/181] time 0.089 (0.096) data 0.000 (0.003) loss 1.0034 (0.9138) ce_loss 0.5166 (0.4219) teacher_loss 0.3736 (0.2789) loss_zs_kd 0.0975 (0.1011) loss_oracle 0.5811 (0.5843) acc 78.1250 (84.9479) kd_loss 0.8862 (0.9082) lr 1.8443e-03 eta 0:11:22
epoch [11/50] batch [140/181] time 0.083 (0.095) data 0.000 (0.003) loss 0.9631 (0.9174) ce_loss 0.6309 (0.4262) teacher_loss 0.3631 (0.2832) loss_zs_kd 0.0822 (0.1005) loss_oracle 0.5590 (0.5839) acc 81.2500 (84.7768) kd_loss 0.9196 (0.9083) lr 1.8443e-03 eta 0:11:15
epoch [11/50] batch [160/181] time 0.087 (0.094) data 0.000 (0.003) loss 0.8246 (0.9166) ce_loss 0.2937 (0.4265) teacher_loss 0.1900 (0.2855) loss_zs_kd 0.0901 (0.0989) loss_oracle 0.5896 (0.5817) acc 93.7500 (84.7656) kd_loss 0.9534 (0.9056) lr 1.8443e-03 eta 0:11:06
epoch [11/50] batch [180/181] time 0.083 (0.093) data 0.000 (0.002) loss 0.8676 (0.9190) ce_loss 0.4678 (0.4297) teacher_loss 0.2732 (0.2906) loss_zs_kd 0.0806 (0.0983) loss_oracle 0.5541 (0.5793) acc 87.5000 (84.7917) kd_loss 0.9078 (0.9025) lr 1.8443e-03 eta 0:10:58
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,381
* accuracy: 95.4%
* error: 4.6%
* macro_f1: 96.0%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.6%, epoch: 6 *******
******* Domain p best val test acc: 99.9%, epoch: 6 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [12/50] batch [20/181] time 0.081 (0.105) data 0.000 (0.016) loss 1.0016 (0.9142) ce_loss 0.4697 (0.4566) teacher_loss 0.2242 (0.3059) loss_zs_kd 0.1152 (0.1002) loss_oracle 0.7198 (0.5582) acc 75.0000 (82.1875) kd_loss 0.9846 (0.8866) lr 1.8090e-03 eta 0:12:21
epoch [12/50] batch [40/181] time 0.075 (0.092) data 0.000 (0.008) loss 0.9414 (0.8873) ce_loss 0.5684 (0.4197) teacher_loss 0.4649 (0.2840) loss_zs_kd 0.0778 (0.0954) loss_oracle 0.4375 (0.5556) acc 81.2500 (84.3750) kd_loss 0.7968 (0.8867) lr 1.8090e-03 eta 0:10:48
epoch [12/50] batch [60/181] time 0.097 (0.093) data 0.001 (0.005) loss 0.9248 (0.8958) ce_loss 0.5278 (0.4241) teacher_loss 0.2762 (0.2917) loss_zs_kd 0.1206 (0.0938) loss_oracle 0.5883 (0.5571) acc 81.2500 (83.8021) kd_loss 0.9379 (0.8860) lr 1.8090e-03 eta 0:10:47
epoch [12/50] batch [80/181] time 0.081 (0.090) data 0.000 (0.004) loss 0.8470 (0.9087) ce_loss 0.3743 (0.4323) teacher_loss 0.1629 (0.2944) loss_zs_kd 0.1394 (0.0969) loss_oracle 0.6143 (0.5658) acc 90.6250 (83.6328) kd_loss 0.9222 (0.8907) lr 1.8090e-03 eta 0:10:29
epoch [12/50] batch [100/181] time 0.088 (0.089) data 0.000 (0.003) loss 0.7456 (0.9147) ce_loss 0.3628 (0.4321) teacher_loss 0.1547 (0.2905) loss_zs_kd 0.0768 (0.0989) loss_oracle 0.5526 (0.5747) acc 90.6250 (83.2812) kd_loss 0.8360 (0.8962) lr 1.8090e-03 eta 0:10:22
epoch [12/50] batch [120/181] time 0.095 (0.089) data 0.000 (0.003) loss 0.9745 (0.9239) ce_loss 0.3657 (0.4389) teacher_loss 0.3133 (0.2935) loss_zs_kd 0.1205 (0.1000) loss_oracle 0.6010 (0.5804) acc 87.5000 (83.2031) kd_loss 0.8565 (0.8953) lr 1.8090e-03 eta 0:10:20
epoch [12/50] batch [140/181] time 0.116 (0.090) data 0.000 (0.003) loss 0.9578 (0.9325) ce_loss 0.3865 (0.4403) teacher_loss 0.2696 (0.2930) loss_zs_kd 0.1100 (0.1011) loss_oracle 0.6333 (0.5890) acc 87.5000 (83.3036) kd_loss 0.9404 (0.8977) lr 1.8090e-03 eta 0:10:22
epoch [12/50] batch [160/181] time 0.086 (0.090) data 0.000 (0.002) loss 0.9821 (0.9344) ce_loss 0.4780 (0.4365) teacher_loss 0.3302 (0.2902) loss_zs_kd 0.0843 (0.1014) loss_oracle 0.6098 (0.5936) acc 84.3750 (83.5742) kd_loss 0.8675 (0.8977) lr 1.8090e-03 eta 0:10:18
epoch [12/50] batch [180/181] time 0.079 (0.089) data 0.000 (0.002) loss 0.9810 (0.9391) ce_loss 0.4114 (0.4368) teacher_loss 0.2862 (0.2907) loss_zs_kd 0.0982 (0.1008) loss_oracle 0.6457 (0.5980) acc 81.2500 (83.5243) kd_loss 0.9330 (0.8994) lr 1.8090e-03 eta 0:10:12
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,386
* accuracy: 95.6%
* error: 4.4%
* macro_f1: 96.1%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      95.6%, epoch: 6 *******
******* Domain p best val test acc: 99.9%, epoch: 6 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [13/50] batch [20/181] time 0.075 (0.098) data 0.000 (0.018) loss 0.8406 (1.0271) ce_loss 0.3157 (0.4765) teacher_loss 0.1849 (0.2899) loss_zs_kd 0.1070 (0.1189) loss_oracle 0.6023 (0.6778) acc 84.3750 (83.1250) kd_loss 0.9717 (0.9416) lr 1.7705e-03 eta 0:11:13
epoch [13/50] batch [40/181] time 0.082 (0.090) data 0.000 (0.009) loss 0.9116 (0.9853) ce_loss 0.3433 (0.4326) teacher_loss 0.1663 (0.2752) loss_zs_kd 0.0679 (0.1064) loss_oracle 0.7114 (0.6570) acc 90.6250 (84.4531) kd_loss 0.9165 (0.9162) lr 1.7705e-03 eta 0:10:14
epoch [13/50] batch [60/181] time 0.077 (0.088) data 0.000 (0.006) loss 0.9839 (0.9785) ce_loss 0.4431 (0.4304) teacher_loss 0.3050 (0.2816) loss_zs_kd 0.0779 (0.1026) loss_oracle 0.6400 (0.6456) acc 84.3750 (84.7396) kd_loss 0.9086 (0.9137) lr 1.7705e-03 eta 0:09:56
epoch [13/50] batch [80/181] time 0.089 (0.087) data 0.000 (0.005) loss 1.0135 (0.9662) ce_loss 0.5962 (0.4263) teacher_loss 0.3477 (0.2813) loss_zs_kd 0.0905 (0.0990) loss_oracle 0.6206 (0.6354) acc 75.0000 (84.8047) kd_loss 0.8896 (0.9091) lr 1.7705e-03 eta 0:09:52
epoch [13/50] batch [100/181] time 0.076 (0.086) data 0.000 (0.004) loss 0.9776 (0.9708) ce_loss 0.3843 (0.4251) teacher_loss 0.2587 (0.2860) loss_zs_kd 0.1241 (0.1014) loss_oracle 0.6569 (0.6341) acc 87.5000 (84.6875) kd_loss 0.8914 (0.9062) lr 1.7705e-03 eta 0:09:39
epoch [13/50] batch [120/181] time 0.079 (0.085) data 0.000 (0.003) loss 0.9011 (0.9719) ce_loss 0.1682 (0.4262) teacher_loss 0.1705 (0.2864) loss_zs_kd 0.0876 (0.1019) loss_oracle 0.6868 (0.6345) acc 96.8750 (84.5833) kd_loss 0.9530 (0.9075) lr 1.7705e-03 eta 0:09:37
epoch [13/50] batch [140/181] time 0.068 (0.083) data 0.000 (0.003) loss 0.8259 (0.9784) ce_loss 0.2324 (0.4330) teacher_loss 0.1103 (0.2922) loss_zs_kd 0.0970 (0.1024) loss_oracle 0.6671 (0.6350) acc 93.7500 (84.2857) kd_loss 0.9885 (0.9124) lr 1.7705e-03 eta 0:09:22
epoch [13/50] batch [160/181] time 0.083 (0.082) data 0.000 (0.003) loss 1.1785 (0.9790) ce_loss 0.5513 (0.4236) teacher_loss 0.3457 (0.2853) loss_zs_kd 0.1116 (0.1024) loss_oracle 0.7770 (0.6426) acc 78.1250 (84.6289) kd_loss 1.0372 (0.9239) lr 1.7705e-03 eta 0:09:10
epoch [13/50] batch [180/181] time 0.075 (0.081) data 0.000 (0.002) loss 1.0099 (0.9760) ce_loss 0.5459 (0.4210) teacher_loss 0.2969 (0.2818) loss_zs_kd 0.1423 (0.1028) loss_oracle 0.6419 (0.6428) acc 78.1250 (84.6528) kd_loss 0.9434 (0.9323) lr 1.7705e-03 eta 0:09:01
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,382
* accuracy: 95.4%
* error: 4.6%
* macro_f1: 96.0%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.6%, epoch: 6 *******
******* Domain p best val test acc: 99.9%, epoch: 6 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [14/50] batch [20/181] time 0.079 (0.095) data 0.000 (0.017) loss 0.9271 (1.0132) ce_loss 0.3713 (0.4474) teacher_loss 0.2006 (0.2989) loss_zs_kd 0.0578 (0.0982) loss_oracle 0.6976 (0.6653) acc 87.5000 (84.0625) kd_loss 1.0562 (0.9800) lr 1.7290e-03 eta 0:10:35
epoch [14/50] batch [40/181] time 0.085 (0.088) data 0.000 (0.008) loss 0.8553 (1.0132) ce_loss 0.1231 (0.4318) teacher_loss 0.0911 (0.2963) loss_zs_kd 0.0777 (0.1046) loss_oracle 0.7254 (0.6646) acc 96.8750 (84.6875) kd_loss 1.0541 (0.9766) lr 1.7290e-03 eta 0:09:44
epoch [14/50] batch [60/181] time 0.084 (0.088) data 0.001 (0.006) loss 0.8436 (0.9965) ce_loss 0.2908 (0.4351) teacher_loss 0.1825 (0.2962) loss_zs_kd 0.0680 (0.0985) loss_oracle 0.6271 (0.6511) acc 90.6250 (84.5833) kd_loss 0.9817 (0.9609) lr 1.7290e-03 eta 0:09:41
epoch [14/50] batch [80/181] time 0.085 (0.087) data 0.000 (0.004) loss 1.0729 (0.9919) ce_loss 0.5273 (0.4368) teacher_loss 0.3019 (0.2984) loss_zs_kd 0.1142 (0.1006) loss_oracle 0.7139 (0.6433) acc 81.2500 (84.4141) kd_loss 1.0410 (0.9508) lr 1.7290e-03 eta 0:09:36
epoch [14/50] batch [100/181] time 0.088 (0.087) data 0.000 (0.004) loss 1.0633 (0.9841) ce_loss 0.4253 (0.4304) teacher_loss 0.3915 (0.2942) loss_zs_kd 0.0752 (0.0978) loss_oracle 0.6342 (0.6410) acc 84.3750 (84.4062) kd_loss 0.8873 (0.9429) lr 1.7290e-03 eta 0:09:31
epoch [14/50] batch [120/181] time 0.085 (0.086) data 0.000 (0.003) loss 1.0780 (0.9896) ce_loss 0.4126 (0.4273) teacher_loss 0.3939 (0.2970) loss_zs_kd 0.0563 (0.0969) loss_oracle 0.6559 (0.6442) acc 84.3750 (84.5573) kd_loss 0.9296 (0.9385) lr 1.7290e-03 eta 0:09:28
epoch [14/50] batch [140/181] time 0.077 (0.086) data 0.000 (0.003) loss 1.1585 (0.9892) ce_loss 0.6162 (0.4279) teacher_loss 0.4165 (0.2993) loss_zs_kd 0.1305 (0.0965) loss_oracle 0.6768 (0.6416) acc 81.2500 (84.7768) kd_loss 1.0463 (0.9345) lr 1.7290e-03 eta 0:09:24
epoch [14/50] batch [160/181] time 0.087 (0.086) data 0.000 (0.002) loss 1.0758 (0.9896) ce_loss 0.3469 (0.4321) teacher_loss 0.2517 (0.3013) loss_zs_kd 0.0936 (0.0961) loss_oracle 0.7773 (0.6402) acc 84.3750 (84.4922) kd_loss 0.9896 (0.9336) lr 1.7290e-03 eta 0:09:20
epoch [14/50] batch [180/181] time 0.077 (0.085) data 0.000 (0.002) loss 0.9951 (0.9868) ce_loss 0.4778 (0.4300) teacher_loss 0.3024 (0.2976) loss_zs_kd 0.0768 (0.0959) loss_oracle 0.6543 (0.6413) acc 81.2500 (84.5139) kd_loss 1.0249 (0.9383) lr 1.7290e-03 eta 0:09:14
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,380
* accuracy: 95.3%
* error: 4.7%
* macro_f1: 96.0%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.6%, epoch: 6 *******
******* Domain p best val test acc: 99.9%, epoch: 6 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [15/50] batch [20/181] time 0.093 (0.099) data 0.000 (0.016) loss 1.0379 (0.9669) ce_loss 0.5713 (0.4266) teacher_loss 0.3544 (0.2978) loss_zs_kd 0.0971 (0.0983) loss_oracle 0.6349 (0.6200) acc 81.2500 (85.0000) kd_loss 0.8989 (0.9164) lr 1.6845e-03 eta 0:10:44
epoch [15/50] batch [40/181] time 0.080 (0.091) data 0.000 (0.008) loss 0.9620 (0.9832) ce_loss 0.3560 (0.4425) teacher_loss 0.2934 (0.2983) loss_zs_kd 0.0951 (0.1044) loss_oracle 0.6210 (0.6327) acc 87.5000 (83.9844) kd_loss 0.9001 (0.9285) lr 1.6845e-03 eta 0:09:51
epoch [15/50] batch [60/181] time 0.091 (0.091) data 0.001 (0.005) loss 1.0334 (0.9803) ce_loss 0.3513 (0.4266) teacher_loss 0.3025 (0.2942) loss_zs_kd 0.0825 (0.0986) loss_oracle 0.6897 (0.6368) acc 81.2500 (84.2188) kd_loss 0.9795 (0.9322) lr 1.6845e-03 eta 0:09:49
epoch [15/50] batch [80/181] time 0.081 (0.090) data 0.000 (0.004) loss 1.1443 (0.9883) ce_loss 0.4570 (0.4243) teacher_loss 0.3340 (0.2923) loss_zs_kd 0.1039 (0.0962) loss_oracle 0.7584 (0.6479) acc 81.2500 (84.5312) kd_loss 1.0293 (0.9437) lr 1.6845e-03 eta 0:09:41
epoch [15/50] batch [100/181] time 0.093 (0.090) data 0.000 (0.003) loss 0.8320 (0.9910) ce_loss 0.1975 (0.4177) teacher_loss 0.1731 (0.2906) loss_zs_kd 0.0983 (0.0957) loss_oracle 0.6098 (0.6526) acc 96.8750 (84.6875) kd_loss 0.9553 (0.9518) lr 1.6845e-03 eta 0:09:35
epoch [15/50] batch [120/181] time 0.087 (0.089) data 0.000 (0.003) loss 0.9666 (0.9833) ce_loss 0.5410 (0.4046) teacher_loss 0.3255 (0.2815) loss_zs_kd 0.0934 (0.0936) loss_oracle 0.5945 (0.6550) acc 81.2500 (85.3125) kd_loss 0.9233 (0.9532) lr 1.6845e-03 eta 0:09:31
epoch [15/50] batch [140/181] time 0.089 (0.089) data 0.000 (0.003) loss 0.9698 (0.9834) ce_loss 0.3972 (0.4019) teacher_loss 0.2797 (0.2836) loss_zs_kd 0.0948 (0.0933) loss_oracle 0.6427 (0.6531) acc 87.5000 (85.3571) kd_loss 0.9422 (0.9520) lr 1.6845e-03 eta 0:09:28
epoch [15/50] batch [160/181] time 0.085 (0.089) data 0.000 (0.002) loss 1.0118 (0.9840) ce_loss 0.3489 (0.4041) teacher_loss 0.2981 (0.2877) loss_zs_kd 0.0835 (0.0914) loss_oracle 0.6720 (0.6506) acc 87.5000 (85.2148) kd_loss 0.9983 (0.9551) lr 1.6845e-03 eta 0:09:25
epoch [15/50] batch [180/181] time 0.074 (0.088) data 0.000 (0.002) loss 1.2863 (0.9881) ce_loss 0.7769 (0.4084) teacher_loss 0.5514 (0.2893) loss_zs_kd 0.1546 (0.0918) loss_oracle 0.6576 (0.6529) acc 65.6250 (84.9826) kd_loss 1.0165 (0.9615) lr 1.6845e-03 eta 0:09:18
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,387
* accuracy: 95.6%
* error: 4.4%
* macro_f1: 96.2%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.6%, epoch: 6 *******
******* Domain p best val test acc: 99.9%, epoch: 6 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [16/50] batch [20/181] time 0.085 (0.109) data 0.000 (0.016) loss 1.0737 (1.0277) ce_loss 0.6030 (0.4400) teacher_loss 0.4004 (0.3225) loss_zs_kd 0.1161 (0.1111) loss_oracle 0.6152 (0.6497) acc 78.1250 (82.9688) kd_loss 0.9163 (0.9637) lr 1.6374e-03 eta 0:11:28
epoch [16/50] batch [40/181] time 0.092 (0.099) data 0.000 (0.008) loss 1.0676 (1.0129) ce_loss 0.4521 (0.4436) teacher_loss 0.4110 (0.3282) loss_zs_kd 0.1024 (0.1019) loss_oracle 0.6054 (0.6337) acc 81.2500 (82.3438) kd_loss 0.9255 (0.9526) lr 1.6374e-03 eta 0:10:22
epoch [16/50] batch [60/181] time 0.096 (0.096) data 0.001 (0.006) loss 0.9397 (1.0072) ce_loss 0.3018 (0.4265) teacher_loss 0.2857 (0.3285) loss_zs_kd 0.0623 (0.0988) loss_oracle 0.6228 (0.6294) acc 93.7500 (83.5417) kd_loss 0.8768 (0.9372) lr 1.6374e-03 eta 0:10:00
epoch [16/50] batch [80/181] time 0.092 (0.094) data 0.001 (0.004) loss 0.9538 (1.0076) ce_loss 0.4175 (0.4190) teacher_loss 0.3725 (0.3299) loss_zs_kd 0.1070 (0.0941) loss_oracle 0.5278 (0.6307) acc 78.1250 (83.9453) kd_loss 0.8858 (0.9275) lr 1.6374e-03 eta 0:09:45
epoch [16/50] batch [100/181] time 0.086 (0.093) data 0.000 (0.004) loss 1.0507 (1.0210) ce_loss 0.4026 (0.4300) teacher_loss 0.3894 (0.3464) loss_zs_kd 0.0780 (0.0918) loss_oracle 0.6223 (0.6288) acc 84.3750 (83.3750) kd_loss 0.8658 (0.9151) lr 1.6374e-03 eta 0:09:37
epoch [16/50] batch [120/181] time 0.085 (0.092) data 0.000 (0.003) loss 1.3015 (1.0256) ce_loss 0.6172 (0.4316) teacher_loss 0.6064 (0.3486) loss_zs_kd 0.0770 (0.0899) loss_oracle 0.6566 (0.6320) acc 75.0000 (83.5417) kd_loss 0.8438 (0.9088) lr 1.6374e-03 eta 0:09:29
epoch [16/50] batch [140/181] time 0.115 (0.092) data 0.000 (0.003) loss 0.8586 (1.0210) ce_loss 0.4031 (0.4254) teacher_loss 0.2169 (0.3439) loss_zs_kd 0.0761 (0.0882) loss_oracle 0.6037 (0.6329) acc 84.3750 (83.8170) kd_loss 0.8599 (0.9022) lr 1.6374e-03 eta 0:09:27
epoch [16/50] batch [160/181] time 0.085 (0.092) data 0.000 (0.002) loss 0.9604 (1.0227) ce_loss 0.3770 (0.4242) teacher_loss 0.2987 (0.3429) loss_zs_kd 0.0721 (0.0883) loss_oracle 0.6257 (0.6357) acc 87.5000 (84.0039) kd_loss 0.9045 (0.9021) lr 1.6374e-03 eta 0:09:26
epoch [16/50] batch [180/181] time 0.083 (0.091) data 0.000 (0.002) loss 0.8939 (1.0242) ce_loss 0.2578 (0.4198) teacher_loss 0.1934 (0.3405) loss_zs_kd 0.0562 (0.0862) loss_oracle 0.6724 (0.6406) acc 87.5000 (84.3403) kd_loss 0.9558 (0.9063) lr 1.6374e-03 eta 0:09:20
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,385
* accuracy: 95.5%
* error: 4.5%
* macro_f1: 96.1%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.6%, epoch: 6 *******
******* Domain p best val test acc: 99.9%, epoch: 6 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [17/50] batch [20/181] time 0.098 (0.108) data 0.001 (0.020) loss 1.1198 (1.0548) ce_loss 0.4780 (0.4219) teacher_loss 0.3953 (0.3333) loss_zs_kd 0.0923 (0.0951) loss_oracle 0.6784 (0.6739) acc 84.3750 (84.3750) kd_loss 0.9078 (0.9427) lr 1.5878e-03 eta 0:11:04
epoch [17/50] batch [40/181] time 0.073 (0.097) data 0.000 (0.010) loss 1.0111 (1.0299) ce_loss 0.3442 (0.4079) teacher_loss 0.3008 (0.3226) loss_zs_kd 0.0643 (0.0884) loss_oracle 0.6781 (0.6631) acc 87.5000 (84.6875) kd_loss 0.9609 (0.9448) lr 1.5878e-03 eta 0:09:51
epoch [17/50] batch [60/181] time 0.084 (0.092) data 0.001 (0.007) loss 0.7908 (1.0168) ce_loss 0.2465 (0.3998) teacher_loss 0.1947 (0.3213) loss_zs_kd 0.0487 (0.0838) loss_oracle 0.5718 (0.6537) acc 90.6250 (84.8438) kd_loss 1.0204 (0.9553) lr 1.5878e-03 eta 0:09:22
epoch [17/50] batch [80/181] time 0.076 (0.090) data 0.000 (0.005) loss 0.9808 (1.0128) ce_loss 0.3254 (0.4035) teacher_loss 0.2930 (0.3250) loss_zs_kd 0.0735 (0.0832) loss_oracle 0.6510 (0.6462) acc 87.5000 (84.8828) kd_loss 0.9384 (0.9466) lr 1.5878e-03 eta 0:09:07
epoch [17/50] batch [100/181] time 0.081 (0.089) data 0.000 (0.004) loss 0.9791 (1.0027) ce_loss 0.4250 (0.3971) teacher_loss 0.3555 (0.3195) loss_zs_kd 0.0678 (0.0812) loss_oracle 0.5897 (0.6427) acc 87.5000 (85.2812) kd_loss 0.9282 (0.9446) lr 1.5878e-03 eta 0:08:58
epoch [17/50] batch [120/181] time 0.085 (0.089) data 0.000 (0.004) loss 0.9079 (0.9964) ce_loss 0.2632 (0.3926) teacher_loss 0.2558 (0.3165) loss_zs_kd 0.0775 (0.0805) loss_oracle 0.6134 (0.6396) acc 87.5000 (85.5208) kd_loss 0.8273 (0.9364) lr 1.5878e-03 eta 0:08:55
epoch [17/50] batch [140/181] time 0.080 (0.088) data 0.000 (0.003) loss 1.1728 (0.9993) ce_loss 0.5850 (0.4044) teacher_loss 0.4316 (0.3240) loss_zs_kd 0.1212 (0.0814) loss_oracle 0.6807 (0.6345) acc 78.1250 (84.9330) kd_loss 0.9262 (0.9303) lr 1.5878e-03 eta 0:08:51
epoch [17/50] batch [160/181] time 0.078 (0.088) data 0.000 (0.003) loss 0.9607 (1.0008) ce_loss 0.4541 (0.4055) teacher_loss 0.3709 (0.3251) loss_zs_kd 0.1091 (0.0827) loss_oracle 0.5353 (0.6343) acc 84.3750 (84.9805) kd_loss 0.7906 (0.9270) lr 1.5878e-03 eta 0:08:45
epoch [17/50] batch [180/181] time 0.074 (0.087) data 0.000 (0.002) loss 1.0541 (1.0023) ce_loss 0.4141 (0.4053) teacher_loss 0.3265 (0.3260) loss_zs_kd 0.0884 (0.0828) loss_oracle 0.6834 (0.6349) acc 84.3750 (85.0868) kd_loss 0.9573 (0.9237) lr 1.5878e-03 eta 0:08:38
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,383
* accuracy: 95.4%
* error: 4.6%
* macro_f1: 96.0%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.6%, epoch: 6 *******
******* Domain p best val test acc: 99.9%, epoch: 6 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [18/50] batch [20/181] time 0.091 (0.100) data 0.000 (0.017) loss 1.0486 (1.0356) ce_loss 0.5229 (0.4355) teacher_loss 0.3588 (0.3422) loss_zs_kd 0.0828 (0.0851) loss_oracle 0.6483 (0.6509) acc 81.2500 (83.4375) kd_loss 1.0005 (0.9215) lr 1.5358e-03 eta 0:09:55
epoch [18/50] batch [40/181] time 0.079 (0.091) data 0.000 (0.008) loss 1.1539 (1.0522) ce_loss 0.4189 (0.4342) teacher_loss 0.3801 (0.3485) loss_zs_kd 0.1006 (0.0852) loss_oracle 0.7235 (0.6611) acc 81.2500 (83.3594) kd_loss 0.8914 (0.9286) lr 1.5358e-03 eta 0:08:57
epoch [18/50] batch [60/181] time 0.078 (0.087) data 0.000 (0.006) loss 0.9790 (1.0509) ce_loss 0.3076 (0.4283) teacher_loss 0.2360 (0.3431) loss_zs_kd 0.0701 (0.0843) loss_oracle 0.7079 (0.6657) acc 87.5000 (82.9167) kd_loss 1.0106 (0.9416) lr 1.5358e-03 eta 0:08:32
epoch [18/50] batch [80/181] time 0.079 (0.085) data 0.000 (0.004) loss 1.3783 (1.0496) ce_loss 0.8594 (0.4215) teacher_loss 0.7066 (0.3385) loss_zs_kd 0.0848 (0.0833) loss_oracle 0.6293 (0.6695) acc 68.7500 (83.0859) kd_loss 0.8501 (0.9515) lr 1.5358e-03 eta 0:08:22
epoch [18/50] batch [100/181] time 0.081 (0.084) data 0.000 (0.004) loss 0.9752 (1.0482) ce_loss 0.3577 (0.4183) teacher_loss 0.2532 (0.3374) loss_zs_kd 0.0923 (0.0828) loss_oracle 0.6759 (0.6694) acc 84.3750 (83.5938) kd_loss 0.9397 (0.9541) lr 1.5358e-03 eta 0:08:16
epoch [18/50] batch [120/181] time 0.076 (0.083) data 0.000 (0.003) loss 1.2271 (1.0494) ce_loss 0.6689 (0.4206) teacher_loss 0.5065 (0.3377) loss_zs_kd 0.0721 (0.0834) loss_oracle 0.6845 (0.6700) acc 78.1250 (83.5938) kd_loss 1.0327 (0.9606) lr 1.5358e-03 eta 0:08:08
epoch [18/50] batch [140/181] time 0.095 (0.083) data 0.000 (0.003) loss 1.2389 (1.0403) ce_loss 0.5264 (0.4124) teacher_loss 0.5365 (0.3316) loss_zs_kd 0.0894 (0.0832) loss_oracle 0.6576 (0.6671) acc 78.1250 (84.0625) kd_loss 1.0199 (0.9697) lr 1.5358e-03 eta 0:08:05
epoch [18/50] batch [160/181] time 0.075 (0.082) data 0.000 (0.002) loss 0.8799 (1.0395) ce_loss 0.2720 (0.4122) teacher_loss 0.2671 (0.3334) loss_zs_kd 0.0549 (0.0823) loss_oracle 0.5854 (0.6650) acc 87.5000 (84.2188) kd_loss 0.9416 (0.9737) lr 1.5358e-03 eta 0:07:59
epoch [18/50] batch [180/181] time 0.066 (0.081) data 0.000 (0.002) loss 1.1551 (1.0393) ce_loss 0.5234 (0.4120) teacher_loss 0.4586 (0.3337) loss_zs_kd 0.0476 (0.0820) loss_oracle 0.6727 (0.6646) acc 81.2500 (84.3229) kd_loss 1.0338 (0.9788) lr 1.5358e-03 eta 0:07:48
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,390
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.3%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      95.7%, epoch: 18 *******
******* Domain p best val test acc: 99.8%, epoch: 18 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [19/50] batch [20/181] time 0.076 (0.095) data 0.000 (0.014) loss 0.9406 (0.9916) ce_loss 0.4170 (0.3554) teacher_loss 0.3146 (0.2849) loss_zs_kd 0.0854 (0.0838) loss_oracle 0.5833 (0.6648) acc 84.3750 (87.9688) kd_loss 0.9502 (1.0141) lr 1.4818e-03 eta 0:09:09
epoch [19/50] batch [40/181] time 0.067 (0.086) data 0.000 (0.007) loss 0.8972 (1.0080) ce_loss 0.2131 (0.3711) teacher_loss 0.1673 (0.3080) loss_zs_kd 0.0705 (0.0823) loss_oracle 0.6947 (0.6589) acc 87.5000 (86.1719) kd_loss 0.9632 (1.0083) lr 1.4818e-03 eta 0:08:12
epoch [19/50] batch [60/181] time 0.083 (0.085) data 0.001 (0.005) loss 0.9350 (1.0204) ce_loss 0.3208 (0.3909) teacher_loss 0.2178 (0.3189) loss_zs_kd 0.0817 (0.0822) loss_oracle 0.6764 (0.6604) acc 90.6250 (85.4167) kd_loss 1.0396 (1.0135) lr 1.4818e-03 eta 0:08:09
epoch [19/50] batch [80/181] time 0.081 (0.085) data 0.000 (0.004) loss 1.0457 (1.0181) ce_loss 0.3894 (0.3911) teacher_loss 0.3113 (0.3137) loss_zs_kd 0.0901 (0.0850) loss_oracle 0.6894 (0.6619) acc 90.6250 (85.7031) kd_loss 1.0637 (1.0183) lr 1.4818e-03 eta 0:08:05
epoch [19/50] batch [100/181] time 0.082 (0.085) data 0.000 (0.003) loss 1.0034 (1.0324) ce_loss 0.3660 (0.4088) teacher_loss 0.3126 (0.3231) loss_zs_kd 0.0893 (0.0900) loss_oracle 0.6462 (0.6643) acc 87.5000 (85.0000) kd_loss 1.0295 (1.0223) lr 1.4818e-03 eta 0:08:04
epoch [19/50] batch [120/181] time 0.090 (0.085) data 0.000 (0.003) loss 1.0801 (1.0349) ce_loss 0.4529 (0.4172) teacher_loss 0.3333 (0.3280) loss_zs_kd 0.0738 (0.0919) loss_oracle 0.7099 (0.6609) acc 84.3750 (84.5833) kd_loss 1.0250 (1.0214) lr 1.4818e-03 eta 0:08:02
epoch [19/50] batch [140/181] time 0.087 (0.085) data 0.000 (0.002) loss 1.0375 (1.0297) ce_loss 0.5034 (0.4147) teacher_loss 0.3606 (0.3271) loss_zs_kd 0.0652 (0.0910) loss_oracle 0.6443 (0.6570) acc 87.5000 (84.6205) kd_loss 1.0307 (1.0214) lr 1.4818e-03 eta 0:08:00
epoch [19/50] batch [160/181] time 0.089 (0.085) data 0.000 (0.002) loss 1.1343 (1.0248) ce_loss 0.3740 (0.4159) teacher_loss 0.3124 (0.3252) loss_zs_kd 0.1071 (0.0923) loss_oracle 0.7683 (0.6535) acc 87.5000 (84.6094) kd_loss 1.1814 (1.0231) lr 1.4818e-03 eta 0:08:01
epoch [19/50] batch [180/181] time 0.075 (0.085) data 0.000 (0.002) loss 1.1548 (1.0234) ce_loss 0.5942 (0.4152) teacher_loss 0.3926 (0.3214) loss_zs_kd 0.1092 (0.0929) loss_oracle 0.7076 (0.6556) acc 75.0000 (84.6701) kd_loss 1.0859 (1.0290) lr 1.4818e-03 eta 0:07:54
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,387
* accuracy: 95.6%
* error: 4.4%
* macro_f1: 96.2%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.7%, epoch: 18 *******
******* Domain p best val test acc: 99.8%, epoch: 18 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [20/50] batch [20/181] time 0.082 (0.101) data 0.000 (0.017) loss 1.1620 (1.0408) ce_loss 0.5518 (0.4267) teacher_loss 0.4702 (0.2951) loss_zs_kd 0.0922 (0.1153) loss_oracle 0.6457 (0.6881) acc 81.2500 (84.2188) kd_loss 0.9900 (1.0766) lr 1.4258e-03 eta 0:09:23
epoch [20/50] batch [40/181] time 0.085 (0.092) data 0.000 (0.009) loss 0.9205 (1.0057) ce_loss 0.2686 (0.3942) teacher_loss 0.2018 (0.2717) loss_zs_kd 0.0801 (0.1087) loss_oracle 0.6787 (0.6796) acc 93.7500 (85.4688) kd_loss 1.0902 (1.0721) lr 1.4258e-03 eta 0:08:34
epoch [20/50] batch [60/181] time 0.092 (0.090) data 0.001 (0.006) loss 1.0733 (1.0172) ce_loss 0.4624 (0.4011) teacher_loss 0.3381 (0.2796) loss_zs_kd 0.0964 (0.1058) loss_oracle 0.6871 (0.6847) acc 78.1250 (85.5729) kd_loss 1.0361 (1.0732) lr 1.4258e-03 eta 0:08:21
epoch [20/50] batch [80/181] time 0.091 (0.091) data 0.001 (0.005) loss 0.8465 (1.0251) ce_loss 0.2598 (0.3990) teacher_loss 0.1870 (0.2749) loss_zs_kd 0.0752 (0.1062) loss_oracle 0.6219 (0.6970) acc 90.6250 (85.7422) kd_loss 1.0841 (1.0760) lr 1.4258e-03 eta 0:08:24
epoch [20/50] batch [100/181] time 0.086 (0.091) data 0.000 (0.004) loss 1.2414 (1.0210) ce_loss 0.6177 (0.3949) teacher_loss 0.4645 (0.2748) loss_zs_kd 0.1390 (0.1065) loss_oracle 0.7073 (0.6929) acc 78.1250 (85.5938) kd_loss 1.1211 (1.0697) lr 1.4258e-03 eta 0:08:18
epoch [20/50] batch [120/181] time 0.086 (0.090) data 0.000 (0.003) loss 0.8912 (1.0224) ce_loss 0.2690 (0.3986) teacher_loss 0.1776 (0.2777) loss_zs_kd 0.1093 (0.1050) loss_oracle 0.6590 (0.6921) acc 90.6250 (85.4688) kd_loss 0.9627 (1.0618) lr 1.4258e-03 eta 0:08:13
epoch [20/50] batch [140/181] time 0.081 (0.089) data 0.000 (0.003) loss 0.8926 (1.0326) ce_loss 0.3430 (0.4094) teacher_loss 0.1877 (0.2872) loss_zs_kd 0.0983 (0.1054) loss_oracle 0.6557 (0.6927) acc 87.5000 (84.9777) kd_loss 1.0183 (1.0513) lr 1.4258e-03 eta 0:08:06
epoch [20/50] batch [160/181] time 0.092 (0.089) data 0.000 (0.002) loss 0.9945 (1.0359) ce_loss 0.3845 (0.4151) teacher_loss 0.3350 (0.2933) loss_zs_kd 0.0962 (0.1057) loss_oracle 0.6113 (0.6898) acc 90.6250 (84.7070) kd_loss 0.8072 (1.0394) lr 1.4258e-03 eta 0:08:03
epoch [20/50] batch [180/181] time 0.076 (0.088) data 0.000 (0.002) loss 0.8965 (1.0268) ce_loss 0.3779 (0.4107) teacher_loss 0.2448 (0.2915) loss_zs_kd 0.1072 (0.1035) loss_oracle 0.5980 (0.6836) acc 87.5000 (84.9132) kd_loss 0.8837 (1.0256) lr 1.4258e-03 eta 0:07:55
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,393
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.4%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.8%, epoch: 20 *******
******* Domain p best val test acc: 99.9%, epoch: 20 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [21/50] batch [20/181] time 0.080 (0.099) data 0.000 (0.017) loss 0.9857 (1.0056) ce_loss 0.3318 (0.3916) teacher_loss 0.2470 (0.2886) loss_zs_kd 0.0755 (0.0966) loss_oracle 0.7010 (0.6687) acc 84.3750 (85.9375) kd_loss 0.9791 (0.9650) lr 1.3681e-03 eta 0:08:54
epoch [21/50] batch [40/181] time 0.073 (0.089) data 0.000 (0.009) loss 1.0019 (1.0315) ce_loss 0.4636 (0.4159) teacher_loss 0.3188 (0.3014) loss_zs_kd 0.0955 (0.0994) loss_oracle 0.6353 (0.6804) acc 84.3750 (84.2969) kd_loss 1.0359 (0.9937) lr 1.3681e-03 eta 0:07:58
epoch [21/50] batch [60/181] time 0.089 (0.086) data 0.001 (0.006) loss 0.9588 (1.0265) ce_loss 0.3096 (0.4001) teacher_loss 0.2214 (0.2895) loss_zs_kd 0.1103 (0.1005) loss_oracle 0.6823 (0.6867) acc 90.6250 (85.0521) kd_loss 1.0856 (1.0078) lr 1.3681e-03 eta 0:07:43
epoch [21/50] batch [80/181] time 0.089 (0.086) data 0.000 (0.004) loss 0.9511 (1.0247) ce_loss 0.3691 (0.4048) teacher_loss 0.2208 (0.2921) loss_zs_kd 0.1660 (0.0981) loss_oracle 0.6474 (0.6836) acc 87.5000 (84.9219) kd_loss 1.0267 (1.0160) lr 1.3681e-03 eta 0:07:40
epoch [21/50] batch [100/181] time 0.085 (0.086) data 0.000 (0.004) loss 1.0387 (1.0312) ce_loss 0.4172 (0.4108) teacher_loss 0.3162 (0.2922) loss_zs_kd 0.1302 (0.1029) loss_oracle 0.6575 (0.6876) acc 84.3750 (84.5938) kd_loss 1.0223 (1.0202) lr 1.3681e-03 eta 0:07:38
epoch [21/50] batch [120/181] time 0.089 (0.086) data 0.000 (0.003) loss 0.9771 (1.0377) ce_loss 0.3086 (0.4106) teacher_loss 0.2053 (0.2939) loss_zs_kd 0.0711 (0.1012) loss_oracle 0.7363 (0.6932) acc 87.5000 (84.8698) kd_loss 1.1133 (1.0278) lr 1.3681e-03 eta 0:07:36
epoch [21/50] batch [140/181] time 0.087 (0.086) data 0.000 (0.003) loss 1.1653 (1.0488) ce_loss 0.4548 (0.4199) teacher_loss 0.4363 (0.2999) loss_zs_kd 0.1087 (0.1031) loss_oracle 0.6746 (0.6973) acc 84.3750 (84.5312) kd_loss 1.0579 (1.0286) lr 1.3681e-03 eta 0:07:34
epoch [21/50] batch [160/181] time 0.087 (0.086) data 0.000 (0.002) loss 1.1371 (1.0483) ce_loss 0.4441 (0.4181) teacher_loss 0.3244 (0.2983) loss_zs_kd 0.0757 (0.1044) loss_oracle 0.7748 (0.6977) acc 81.2500 (84.5312) kd_loss 1.0392 (1.0265) lr 1.3681e-03 eta 0:07:31
epoch [21/50] batch [180/181] time 0.073 (0.085) data 0.000 (0.002) loss 1.0338 (1.0511) ce_loss 0.3511 (0.4197) teacher_loss 0.3004 (0.2986) loss_zs_kd 0.1118 (0.1038) loss_oracle 0.6775 (0.7006) acc 90.6250 (84.5660) kd_loss 1.0264 (1.0283) lr 1.3681e-03 eta 0:07:25
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,387
* accuracy: 95.6%
* error: 4.4%
* macro_f1: 96.2%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.8%, epoch: 20 *******
******* Domain p best val test acc: 99.9%, epoch: 20 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [22/50] batch [20/181] time 0.082 (0.099) data 0.000 (0.016) loss 1.1249 (1.0517) ce_loss 0.5205 (0.4076) teacher_loss 0.3789 (0.2738) loss_zs_kd 0.0939 (0.1052) loss_oracle 0.6990 (0.7253) acc 81.2500 (85.1562) kd_loss 1.0015 (1.0376) lr 1.3090e-03 eta 0:08:39
epoch [22/50] batch [40/181] time 0.076 (0.090) data 0.000 (0.008) loss 1.0169 (1.0606) ce_loss 0.4026 (0.4171) teacher_loss 0.2638 (0.2817) loss_zs_kd 0.1047 (0.1094) loss_oracle 0.7007 (0.7242) acc 84.3750 (84.4531) kd_loss 1.0349 (1.0422) lr 1.3090e-03 eta 0:07:48
epoch [22/50] batch [60/181] time 0.083 (0.088) data 0.001 (0.005) loss 0.8978 (1.0376) ce_loss 0.2646 (0.4003) teacher_loss 0.1571 (0.2705) loss_zs_kd 0.0813 (0.1068) loss_oracle 0.7000 (0.7138) acc 87.5000 (85.0521) kd_loss 1.0673 (1.0376) lr 1.3090e-03 eta 0:07:35
epoch [22/50] batch [80/181] time 0.082 (0.087) data 0.000 (0.004) loss 1.1260 (1.0361) ce_loss 0.4106 (0.4016) teacher_loss 0.3300 (0.2715) loss_zs_kd 0.1253 (0.1072) loss_oracle 0.7334 (0.7111) acc 84.3750 (84.8828) kd_loss 1.0012 (1.0327) lr 1.3090e-03 eta 0:07:29
epoch [22/50] batch [100/181] time 0.081 (0.087) data 0.000 (0.003) loss 0.9655 (1.0387) ce_loss 0.3201 (0.3954) teacher_loss 0.1921 (0.2678) loss_zs_kd 0.0746 (0.1067) loss_oracle 0.7361 (0.7175) acc 84.3750 (85.0625) kd_loss 0.9870 (1.0312) lr 1.3090e-03 eta 0:07:26
epoch [22/50] batch [120/181] time 0.085 (0.087) data 0.000 (0.003) loss 0.9252 (1.0437) ce_loss 0.3088 (0.3989) teacher_loss 0.2284 (0.2700) loss_zs_kd 0.0717 (0.1071) loss_oracle 0.6610 (0.7202) acc 87.5000 (84.7917) kd_loss 0.9246 (1.0277) lr 1.3090e-03 eta 0:07:24
epoch [22/50] batch [140/181] time 0.102 (0.087) data 0.001 (0.002) loss 1.2123 (1.0432) ce_loss 0.5273 (0.3929) teacher_loss 0.3191 (0.2655) loss_zs_kd 0.1457 (0.1074) loss_oracle 0.8203 (0.7241) acc 78.1250 (84.9777) kd_loss 1.0742 (1.0260) lr 1.3090e-03 eta 0:07:23
epoch [22/50] batch [160/181] time 0.090 (0.087) data 0.000 (0.002) loss 1.1615 (1.0516) ce_loss 0.3406 (0.3982) teacher_loss 0.2090 (0.2677) loss_zs_kd 0.1111 (0.1095) loss_oracle 0.8969 (0.7292) acc 90.6250 (84.7266) kd_loss 1.1033 (1.0281) lr 1.3090e-03 eta 0:07:21
epoch [22/50] batch [180/181] time 0.075 (0.086) data 0.000 (0.002) loss 1.1453 (1.0568) ce_loss 0.5181 (0.4000) teacher_loss 0.3122 (0.2708) loss_zs_kd 0.0952 (0.1087) loss_oracle 0.7855 (0.7316) acc 78.1250 (84.7396) kd_loss 1.0857 (1.0313) lr 1.3090e-03 eta 0:07:16
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,387
* accuracy: 95.6%
* error: 4.4%
* macro_f1: 96.2%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.8%, epoch: 20 *******
******* Domain p best val test acc: 99.9%, epoch: 20 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [23/50] batch [20/181] time 0.092 (0.107) data 0.000 (0.015) loss 1.2565 (1.1011) ce_loss 0.7090 (0.4608) teacher_loss 0.5158 (0.3256) loss_zs_kd 0.1376 (0.1135) loss_oracle 0.6719 (0.7188) acc 71.8750 (83.1250) kd_loss 1.0812 (1.0437) lr 1.2487e-03 eta 0:09:01
epoch [23/50] batch [40/181] time 0.094 (0.098) data 0.000 (0.008) loss 1.0543 (1.0936) ce_loss 0.4067 (0.4592) teacher_loss 0.3158 (0.3185) loss_zs_kd 0.1096 (0.1129) loss_oracle 0.6836 (0.7187) acc 87.5000 (82.8125) kd_loss 1.0790 (1.0488) lr 1.2487e-03 eta 0:08:13
epoch [23/50] batch [60/181] time 0.087 (0.096) data 0.001 (0.005) loss 0.8434 (1.0601) ce_loss 0.2764 (0.4311) teacher_loss 0.2063 (0.3040) loss_zs_kd 0.1007 (0.1116) loss_oracle 0.5868 (0.7002) acc 90.6250 (84.2708) kd_loss 0.9542 (1.0389) lr 1.2487e-03 eta 0:07:59
epoch [23/50] batch [80/181] time 0.090 (0.095) data 0.000 (0.004) loss 0.8214 (1.0457) ce_loss 0.2854 (0.4242) teacher_loss 0.2062 (0.2997) loss_zs_kd 0.0624 (0.1081) loss_oracle 0.5839 (0.6920) acc 87.5000 (84.5703) kd_loss 0.9469 (1.0286) lr 1.2487e-03 eta 0:07:55
epoch [23/50] batch [100/181] time 0.093 (0.095) data 0.000 (0.003) loss 0.9670 (1.0372) ce_loss 0.4316 (0.4226) teacher_loss 0.2288 (0.2955) loss_zs_kd 0.1037 (0.1058) loss_oracle 0.6864 (0.6889) acc 81.2500 (84.7500) kd_loss 1.0100 (1.0189) lr 1.2487e-03 eta 0:07:50
epoch [23/50] batch [120/181] time 0.092 (0.094) data 0.000 (0.003) loss 0.7924 (1.0295) ce_loss 0.2979 (0.4201) teacher_loss 0.1648 (0.2891) loss_zs_kd 0.1260 (0.1065) loss_oracle 0.5646 (0.6871) acc 87.5000 (84.7396) kd_loss 0.9517 (1.0107) lr 1.2487e-03 eta 0:07:45
epoch [23/50] batch [140/181] time 0.099 (0.094) data 0.002 (0.002) loss 0.8983 (1.0279) ce_loss 0.2952 (0.4219) teacher_loss 0.2046 (0.2873) loss_zs_kd 0.1018 (0.1081) loss_oracle 0.6428 (0.6865) acc 90.6250 (84.6875) kd_loss 0.8817 (1.0051) lr 1.2487e-03 eta 0:07:42
epoch [23/50] batch [160/181] time 0.086 (0.094) data 0.000 (0.002) loss 1.0936 (1.0309) ce_loss 0.3965 (0.4253) teacher_loss 0.2609 (0.2890) loss_zs_kd 0.1161 (0.1102) loss_oracle 0.7747 (0.6869) acc 84.3750 (84.4336) kd_loss 1.0281 (1.0000) lr 1.2487e-03 eta 0:07:39
epoch [23/50] batch [180/181] time 0.082 (0.093) data 0.000 (0.002) loss 1.0552 (1.0265) ce_loss 0.5044 (0.4198) teacher_loss 0.3388 (0.2835) loss_zs_kd 0.0950 (0.1103) loss_oracle 0.6689 (0.6879) acc 81.2500 (84.6007) kd_loss 1.0505 (0.9994) lr 1.2487e-03 eta 0:07:33
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,391
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.8%, epoch: 20 *******
******* Domain p best val test acc: 99.9%, epoch: 20 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [24/50] batch [20/181] time 0.091 (0.108) data 0.000 (0.017) loss 1.0396 (0.9469) ce_loss 0.5005 (0.3634) teacher_loss 0.2674 (0.2302) loss_zs_kd 0.1477 (0.1155) loss_oracle 0.6984 (0.6589) acc 78.1250 (86.0938) kd_loss 0.9470 (0.9635) lr 1.1874e-03 eta 0:08:47
epoch [24/50] batch [40/181] time 0.087 (0.099) data 0.000 (0.009) loss 0.9138 (0.9747) ce_loss 0.4636 (0.4207) teacher_loss 0.3450 (0.2714) loss_zs_kd 0.1427 (0.1165) loss_oracle 0.4975 (0.6450) acc 84.3750 (84.2969) kd_loss 0.9900 (0.9642) lr 1.1874e-03 eta 0:07:58
epoch [24/50] batch [60/181] time 0.093 (0.096) data 0.001 (0.006) loss 1.0407 (0.9853) ce_loss 0.5444 (0.4183) teacher_loss 0.4080 (0.2730) loss_zs_kd 0.1067 (0.1174) loss_oracle 0.5794 (0.6536) acc 81.2500 (84.3750) kd_loss 0.9985 (0.9778) lr 1.1874e-03 eta 0:07:43
epoch [24/50] batch [80/181] time 0.089 (0.095) data 0.000 (0.005) loss 1.0325 (0.9863) ce_loss 0.3669 (0.4190) teacher_loss 0.1905 (0.2730) loss_zs_kd 0.1583 (0.1161) loss_oracle 0.7629 (0.6553) acc 87.5000 (84.4922) kd_loss 1.0721 (0.9757) lr 1.1874e-03 eta 0:07:35
epoch [24/50] batch [100/181] time 0.086 (0.094) data 0.000 (0.004) loss 0.9039 (0.9947) ce_loss 0.2822 (0.4232) teacher_loss 0.1353 (0.2797) loss_zs_kd 0.0809 (0.1151) loss_oracle 0.7281 (0.6575) acc 87.5000 (84.4062) kd_loss 1.0563 (0.9711) lr 1.1874e-03 eta 0:07:30
epoch [24/50] batch [120/181] time 0.096 (0.094) data 0.001 (0.003) loss 1.0691 (0.9897) ce_loss 0.4417 (0.4153) teacher_loss 0.3283 (0.2720) loss_zs_kd 0.1361 (0.1141) loss_oracle 0.6727 (0.6607) acc 90.6250 (84.7396) kd_loss 0.9009 (0.9687) lr 1.1874e-03 eta 0:07:25
epoch [24/50] batch [140/181] time 0.087 (0.093) data 0.000 (0.003) loss 0.8654 (0.9899) ce_loss 0.2430 (0.4172) teacher_loss 0.2375 (0.2746) loss_zs_kd 0.0585 (0.1129) loss_oracle 0.5987 (0.6588) acc 93.7500 (84.6429) kd_loss 0.9006 (0.9633) lr 1.1874e-03 eta 0:07:20
epoch [24/50] batch [160/181] time 0.094 (0.092) data 0.000 (0.002) loss 1.1577 (0.9878) ce_loss 0.4041 (0.4120) teacher_loss 0.2921 (0.2723) loss_zs_kd 0.1183 (0.1109) loss_oracle 0.8065 (0.6600) acc 84.3750 (84.9023) kd_loss 1.0464 (0.9626) lr 1.1874e-03 eta 0:07:15
epoch [24/50] batch [180/181] time 0.081 (0.091) data 0.000 (0.002) loss 0.9465 (0.9895) ce_loss 0.3865 (0.4125) teacher_loss 0.2701 (0.2726) loss_zs_kd 0.1332 (0.1119) loss_oracle 0.6098 (0.6610) acc 90.6250 (84.7743) kd_loss 0.8817 (0.9613) lr 1.1874e-03 eta 0:07:10
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,393
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.4%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.8%, epoch: 20 *******
******* Domain p best val test acc: 99.9%, epoch: 20 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [25/50] batch [20/181] time 0.082 (0.093) data 0.000 (0.012) loss 0.8960 (1.0206) ce_loss 0.3865 (0.4721) teacher_loss 0.1900 (0.3079) loss_zs_kd 0.0986 (0.1168) loss_oracle 0.6567 (0.6543) acc 84.3750 (82.9688) kd_loss 0.9618 (0.9560) lr 1.1253e-03 eta 0:07:14
epoch [25/50] batch [40/181] time 0.077 (0.087) data 0.000 (0.006) loss 0.8663 (0.9967) ce_loss 0.1804 (0.4304) teacher_loss 0.1025 (0.2777) loss_zs_kd 0.1588 (0.1216) loss_oracle 0.6844 (0.6582) acc 93.7500 (83.3594) kd_loss 1.0507 (0.9666) lr 1.1253e-03 eta 0:06:46
epoch [25/50] batch [60/181] time 0.082 (0.086) data 0.000 (0.004) loss 1.2695 (0.9920) ce_loss 0.7358 (0.4171) teacher_loss 0.4018 (0.2656) loss_zs_kd 0.1623 (0.1214) loss_oracle 0.7865 (0.6657) acc 75.0000 (84.0104) kd_loss 1.0547 (0.9691) lr 1.1253e-03 eta 0:06:40
epoch [25/50] batch [80/181] time 0.087 (0.087) data 0.000 (0.003) loss 0.9193 (0.9786) ce_loss 0.4648 (0.4080) teacher_loss 0.2172 (0.2563) loss_zs_kd 0.1167 (0.1208) loss_oracle 0.6438 (0.6618) acc 78.1250 (84.3750) kd_loss 0.9507 (0.9685) lr 1.1253e-03 eta 0:06:40
epoch [25/50] batch [100/181] time 0.089 (0.087) data 0.000 (0.003) loss 0.9433 (0.9850) ce_loss 0.3562 (0.4112) teacher_loss 0.2272 (0.2601) loss_zs_kd 0.1534 (0.1196) loss_oracle 0.6395 (0.6652) acc 87.5000 (84.3438) kd_loss 1.0315 (0.9728) lr 1.1253e-03 eta 0:06:39
epoch [25/50] batch [120/181] time 0.091 (0.087) data 0.000 (0.002) loss 0.9630 (0.9942) ce_loss 0.4209 (0.4180) teacher_loss 0.2629 (0.2679) loss_zs_kd 0.1207 (0.1201) loss_oracle 0.6397 (0.6663) acc 90.6250 (84.2448) kd_loss 0.8852 (0.9732) lr 1.1253e-03 eta 0:06:40
epoch [25/50] batch [140/181] time 0.078 (0.087) data 0.000 (0.002) loss 0.8984 (0.9900) ce_loss 0.3989 (0.4124) teacher_loss 0.2505 (0.2648) loss_zs_kd 0.1014 (0.1194) loss_oracle 0.5973 (0.6655) acc 84.3750 (84.4866) kd_loss 0.9411 (0.9760) lr 1.1253e-03 eta 0:06:36
epoch [25/50] batch [160/181] time 0.081 (0.087) data 0.000 (0.002) loss 0.9063 (0.9937) ce_loss 0.2384 (0.4152) teacher_loss 0.1244 (0.2678) loss_zs_kd 0.0756 (0.1176) loss_oracle 0.7441 (0.6671) acc 87.5000 (84.4531) kd_loss 1.0753 (0.9770) lr 1.1253e-03 eta 0:06:36
epoch [25/50] batch [180/181] time 0.083 (0.087) data 0.000 (0.002) loss 0.9935 (0.9899) ce_loss 0.4075 (0.4111) teacher_loss 0.2429 (0.2657) loss_zs_kd 0.0947 (0.1162) loss_oracle 0.7032 (0.6661) acc 84.3750 (84.6528) kd_loss 1.0008 (0.9778) lr 1.1253e-03 eta 0:06:31
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,389
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      95.8%, epoch: 20 *******
******* Domain p best val test acc: 99.9%, epoch: 20 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [26/50] batch [20/181] time 0.092 (0.101) data 0.000 (0.015) loss 1.1370 (0.9807) ce_loss 0.5332 (0.4143) teacher_loss 0.4021 (0.2763) loss_zs_kd 0.1413 (0.1047) loss_oracle 0.6643 (0.6520) acc 81.2500 (84.0625) kd_loss 0.9390 (0.9771) lr 1.0628e-03 eta 0:07:33
epoch [26/50] batch [40/181] time 0.082 (0.090) data 0.001 (0.007) loss 0.7647 (0.9993) ce_loss 0.1995 (0.4174) teacher_loss 0.1583 (0.2710) loss_zs_kd 0.0677 (0.1105) loss_oracle 0.5726 (0.6730) acc 90.6250 (83.9844) kd_loss 0.9443 (0.9862) lr 1.0628e-03 eta 0:06:41
epoch [26/50] batch [60/181] time 0.084 (0.086) data 0.001 (0.005) loss 0.9929 (1.0010) ce_loss 0.3669 (0.4225) teacher_loss 0.2501 (0.2721) loss_zs_kd 0.1045 (0.1176) loss_oracle 0.6905 (0.6701) acc 84.3750 (83.9583) kd_loss 0.9550 (0.9814) lr 1.0628e-03 eta 0:06:21
epoch [26/50] batch [80/181] time 0.072 (0.083) data 0.000 (0.004) loss 0.9881 (0.9831) ce_loss 0.5259 (0.4136) teacher_loss 0.3160 (0.2607) loss_zs_kd 0.1037 (0.1181) loss_oracle 0.6203 (0.6633) acc 84.3750 (84.3750) kd_loss 0.9768 (0.9739) lr 1.0628e-03 eta 0:06:10
epoch [26/50] batch [100/181] time 0.081 (0.083) data 0.000 (0.003) loss 0.8380 (0.9951) ce_loss 0.2229 (0.4289) teacher_loss 0.1495 (0.2706) loss_zs_kd 0.0826 (0.1215) loss_oracle 0.6472 (0.6638) acc 93.7500 (83.6875) kd_loss 0.9710 (0.9743) lr 1.0628e-03 eta 0:06:06
epoch [26/50] batch [120/181] time 0.089 (0.084) data 0.000 (0.003) loss 0.9827 (0.9912) ce_loss 0.3840 (0.4209) teacher_loss 0.2252 (0.2690) loss_zs_kd 0.1132 (0.1219) loss_oracle 0.7009 (0.6612) acc 84.3750 (84.1667) kd_loss 1.0109 (0.9746) lr 1.0628e-03 eta 0:06:10
epoch [26/50] batch [140/181] time 0.080 (0.084) data 0.000 (0.002) loss 1.0897 (0.9905) ce_loss 0.5386 (0.4249) teacher_loss 0.3051 (0.2734) loss_zs_kd 0.1779 (0.1200) loss_oracle 0.6956 (0.6571) acc 81.2500 (83.9732) kd_loss 1.0438 (0.9728) lr 1.0628e-03 eta 0:06:07
epoch [26/50] batch [160/181] time 0.091 (0.085) data 0.001 (0.002) loss 0.9515 (0.9896) ce_loss 0.3442 (0.4209) teacher_loss 0.2630 (0.2733) loss_zs_kd 0.0964 (0.1180) loss_oracle 0.6402 (0.6573) acc 90.6250 (84.2383) kd_loss 0.9830 (0.9757) lr 1.0628e-03 eta 0:06:10
epoch [26/50] batch [180/181] time 0.077 (0.084) data 0.000 (0.002) loss 0.7721 (0.9817) ce_loss 0.3286 (0.4158) teacher_loss 0.1739 (0.2698) loss_zs_kd 0.0794 (0.1153) loss_oracle 0.5586 (0.6543) acc 84.3750 (84.3403) kd_loss 0.9706 (0.9786) lr 1.0628e-03 eta 0:06:06
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,389
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.8%, epoch: 20 *******
******* Domain p best val test acc: 99.9%, epoch: 20 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [27/50] batch [20/181] time 0.071 (0.097) data 0.000 (0.019) loss 0.9167 (0.9537) ce_loss 0.4353 (0.3832) teacher_loss 0.2836 (0.2592) loss_zs_kd 0.0809 (0.1089) loss_oracle 0.5927 (0.6400) acc 81.2500 (86.2500) kd_loss 0.9283 (1.0017) lr 1.0000e-03 eta 0:06:57
epoch [27/50] batch [40/181] time 0.082 (0.084) data 0.000 (0.010) loss 1.0702 (0.9744) ce_loss 0.4893 (0.4054) teacher_loss 0.3183 (0.2798) loss_zs_kd 0.0915 (0.1115) loss_oracle 0.7061 (0.6388) acc 87.5000 (85.1562) kd_loss 1.1177 (0.9967) lr 1.0000e-03 eta 0:05:59
epoch [27/50] batch [60/181] time 0.065 (0.079) data 0.001 (0.007) loss 1.0300 (0.9951) ce_loss 0.3672 (0.4056) teacher_loss 0.2781 (0.2927) loss_zs_kd 0.1288 (0.1123) loss_oracle 0.6876 (0.6463) acc 87.5000 (85.0521) kd_loss 1.0914 (1.0046) lr 1.0000e-03 eta 0:05:39
epoch [27/50] batch [80/181] time 0.085 (0.077) data 0.000 (0.005) loss 1.1036 (0.9872) ce_loss 0.4968 (0.4026) teacher_loss 0.3373 (0.2870) loss_zs_kd 0.1324 (0.1123) loss_oracle 0.7001 (0.6441) acc 84.3750 (85.3125) kd_loss 1.0413 (1.0077) lr 1.0000e-03 eta 0:05:29
epoch [27/50] batch [100/181] time 0.067 (0.076) data 0.000 (0.004) loss 0.9470 (0.9924) ce_loss 0.3369 (0.4100) teacher_loss 0.2328 (0.2933) loss_zs_kd 0.1014 (0.1129) loss_oracle 0.6635 (0.6427) acc 90.6250 (85.3750) kd_loss 1.0921 (1.0127) lr 1.0000e-03 eta 0:05:21
epoch [27/50] batch [120/181] time 0.071 (0.076) data 0.000 (0.003) loss 0.9414 (0.9890) ce_loss 0.2988 (0.3988) teacher_loss 0.1898 (0.2865) loss_zs_kd 0.0766 (0.1109) loss_oracle 0.7134 (0.6470) acc 87.5000 (85.5729) kd_loss 1.0953 (1.0156) lr 1.0000e-03 eta 0:05:20
epoch [27/50] batch [140/181] time 0.079 (0.076) data 0.000 (0.003) loss 1.1253 (0.9961) ce_loss 0.4238 (0.4005) teacher_loss 0.2703 (0.2867) loss_zs_kd 0.1209 (0.1094) loss_oracle 0.7946 (0.6547) acc 84.3750 (85.4464) kd_loss 1.0869 (1.0193) lr 1.0000e-03 eta 0:05:19
epoch [27/50] batch [160/181] time 0.079 (0.076) data 0.000 (0.003) loss 1.0214 (0.9934) ce_loss 0.5830 (0.3962) teacher_loss 0.3693 (0.2796) loss_zs_kd 0.1193 (0.1094) loss_oracle 0.5924 (0.6591) acc 75.0000 (85.7031) kd_loss 0.9670 (1.0216) lr 1.0000e-03 eta 0:05:17
epoch [27/50] batch [180/181] time 0.075 (0.076) data 0.000 (0.002) loss 0.9745 (1.0017) ce_loss 0.2974 (0.3974) teacher_loss 0.1996 (0.2805) loss_zs_kd 0.1237 (0.1095) loss_oracle 0.7130 (0.6665) acc 90.6250 (85.5556) kd_loss 0.9693 (1.0224) lr 1.0000e-03 eta 0:05:16
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,387
* accuracy: 95.6%
* error: 4.4%
* macro_f1: 96.2%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.8%, epoch: 20 *******
******* Domain p best val test acc: 99.9%, epoch: 20 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [28/50] batch [20/181] time 0.085 (0.104) data 0.000 (0.018) loss 1.2025 (0.9616) ce_loss 0.5303 (0.3413) teacher_loss 0.3630 (0.2254) loss_zs_kd 0.1159 (0.0982) loss_oracle 0.7816 (0.6871) acc 81.2500 (86.8750) kd_loss 1.1095 (1.0122) lr 9.3721e-04 eta 0:07:09
epoch [28/50] batch [40/181] time 0.099 (0.093) data 0.001 (0.009) loss 0.8516 (1.0047) ce_loss 0.3120 (0.3733) teacher_loss 0.2166 (0.2479) loss_zs_kd 0.1293 (0.1029) loss_oracle 0.5703 (0.7053) acc 90.6250 (86.0156) kd_loss 1.0425 (1.0210) lr 9.3721e-04 eta 0:06:25
epoch [28/50] batch [60/181] time 0.086 (0.090) data 0.001 (0.006) loss 1.0024 (0.9996) ce_loss 0.4199 (0.3727) teacher_loss 0.2414 (0.2477) loss_zs_kd 0.1499 (0.1059) loss_oracle 0.6861 (0.6989) acc 81.2500 (85.8854) kd_loss 1.0516 (1.0222) lr 9.3721e-04 eta 0:06:09
epoch [28/50] batch [80/181] time 0.077 (0.088) data 0.000 (0.005) loss 1.0668 (1.0073) ce_loss 0.5278 (0.3820) teacher_loss 0.3369 (0.2545) loss_zs_kd 0.1154 (0.1086) loss_oracle 0.6722 (0.6985) acc 81.2500 (85.6250) kd_loss 1.0623 (1.0259) lr 9.3721e-04 eta 0:06:00
epoch [28/50] batch [100/181] time 0.081 (0.087) data 0.000 (0.004) loss 1.3084 (1.0109) ce_loss 0.8296 (0.3864) teacher_loss 0.5202 (0.2541) loss_zs_kd 0.1253 (0.1110) loss_oracle 0.7256 (0.7013) acc 81.2500 (85.7500) kd_loss 1.0641 (1.0255) lr 9.3721e-04 eta 0:05:55
epoch [28/50] batch [120/181] time 0.098 (0.088) data 0.000 (0.003) loss 1.0490 (1.0120) ce_loss 0.4819 (0.3919) teacher_loss 0.2610 (0.2588) loss_zs_kd 0.1076 (0.1119) loss_oracle 0.7342 (0.6972) acc 81.2500 (85.6250) kd_loss 1.0419 (1.0269) lr 9.3721e-04 eta 0:05:53
epoch [28/50] batch [140/181] time 0.086 (0.087) data 0.000 (0.003) loss 0.8323 (1.0111) ce_loss 0.2064 (0.3877) teacher_loss 0.1292 (0.2576) loss_zs_kd 0.0916 (0.1118) loss_oracle 0.6573 (0.6976) acc 93.7500 (86.0491) kd_loss 1.0309 (1.0293) lr 9.3721e-04 eta 0:05:51
epoch [28/50] batch [160/181] time 0.083 (0.087) data 0.000 (0.003) loss 1.0790 (1.0172) ce_loss 0.3862 (0.3962) teacher_loss 0.2697 (0.2643) loss_zs_kd 0.1212 (0.1117) loss_oracle 0.7487 (0.6971) acc 84.3750 (85.6250) kd_loss 1.0411 (1.0306) lr 9.3721e-04 eta 0:05:49
epoch [28/50] batch [180/181] time 0.078 (0.086) data 0.000 (0.002) loss 1.1581 (1.0178) ce_loss 0.5952 (0.3985) teacher_loss 0.3868 (0.2646) loss_zs_kd 0.1253 (0.1115) loss_oracle 0.7086 (0.6974) acc 78.1250 (85.6424) kd_loss 1.0143 (1.0302) lr 9.3721e-04 eta 0:05:43
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,388
* accuracy: 95.6%
* error: 4.4%
* macro_f1: 96.2%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.8%, epoch: 20 *******
******* Domain p best val test acc: 99.9%, epoch: 20 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [29/50] batch [20/181] time 0.088 (0.100) data 0.000 (0.017) loss 1.0300 (1.0475) ce_loss 0.5117 (0.4191) teacher_loss 0.3146 (0.2848) loss_zs_kd 0.0974 (0.1117) loss_oracle 0.6667 (0.7069) acc 87.5000 (83.9062) kd_loss 1.0787 (1.0157) lr 8.7467e-04 eta 0:06:37
epoch [29/50] batch [40/181] time 0.093 (0.093) data 0.000 (0.009) loss 1.2257 (1.0456) ce_loss 0.6270 (0.4151) teacher_loss 0.4369 (0.2789) loss_zs_kd 0.1340 (0.1169) loss_oracle 0.7219 (0.7083) acc 75.0000 (84.5312) kd_loss 0.9277 (1.0225) lr 8.7467e-04 eta 0:06:05
epoch [29/50] batch [60/181] time 0.087 (0.091) data 0.001 (0.006) loss 1.0729 (1.0395) ce_loss 0.5239 (0.4100) teacher_loss 0.3951 (0.2744) loss_zs_kd 0.0959 (0.1142) loss_oracle 0.6299 (0.7079) acc 78.1250 (84.6875) kd_loss 1.0263 (1.0210) lr 8.7467e-04 eta 0:05:57
epoch [29/50] batch [80/181] time 0.088 (0.090) data 0.000 (0.004) loss 0.7972 (1.0218) ce_loss 0.2434 (0.4002) teacher_loss 0.1638 (0.2689) loss_zs_kd 0.1014 (0.1118) loss_oracle 0.5826 (0.6970) acc 90.6250 (85.2734) kd_loss 0.9519 (1.0132) lr 8.7467e-04 eta 0:05:50
epoch [29/50] batch [100/181] time 0.084 (0.089) data 0.000 (0.004) loss 1.1880 (1.0215) ce_loss 0.5088 (0.3959) teacher_loss 0.3324 (0.2672) loss_zs_kd 0.1384 (0.1112) loss_oracle 0.7865 (0.6986) acc 84.3750 (85.4062) kd_loss 1.0188 (1.0150) lr 8.7467e-04 eta 0:05:44
epoch [29/50] batch [120/181] time 0.084 (0.088) data 0.000 (0.003) loss 1.0969 (1.0224) ce_loss 0.4211 (0.3926) teacher_loss 0.3184 (0.2650) loss_zs_kd 0.1594 (0.1102) loss_oracle 0.6988 (0.7023) acc 84.3750 (85.7031) kd_loss 0.9149 (1.0142) lr 8.7467e-04 eta 0:05:38
epoch [29/50] batch [140/181] time 0.084 (0.087) data 0.000 (0.003) loss 1.3718 (1.0256) ce_loss 0.7344 (0.3969) teacher_loss 0.5283 (0.2657) loss_zs_kd 0.1259 (0.1105) loss_oracle 0.7805 (0.7046) acc 65.6250 (85.4241) kd_loss 0.9809 (1.0109) lr 8.7467e-04 eta 0:05:35
epoch [29/50] batch [160/181] time 0.084 (0.087) data 0.000 (0.002) loss 0.8623 (1.0242) ce_loss 0.1622 (0.3971) teacher_loss 0.0745 (0.2655) loss_zs_kd 0.0891 (0.1101) loss_oracle 0.7432 (0.7036) acc 96.8750 (85.5469) kd_loss 1.0453 (1.0116) lr 8.7467e-04 eta 0:05:33
epoch [29/50] batch [180/181] time 0.081 (0.087) data 0.000 (0.002) loss 1.0576 (1.0234) ce_loss 0.5698 (0.3953) teacher_loss 0.3620 (0.2642) loss_zs_kd 0.1399 (0.1093) loss_oracle 0.6256 (0.7045) acc 75.0000 (85.5035) kd_loss 1.0253 (1.0148) lr 8.7467e-04 eta 0:05:29
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,387
* accuracy: 95.6%
* error: 4.4%
* macro_f1: 96.2%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.8%, epoch: 20 *******
******* Domain p best val test acc: 99.9%, epoch: 20 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [30/50] batch [20/181] time 0.084 (0.102) data 0.000 (0.016) loss 0.9961 (1.0051) ce_loss 0.4309 (0.3774) teacher_loss 0.2528 (0.2556) loss_zs_kd 0.1102 (0.1064) loss_oracle 0.6883 (0.6963) acc 90.6250 (85.4688) kd_loss 0.9875 (1.0312) lr 8.1262e-04 eta 0:06:24
epoch [30/50] batch [40/181] time 0.082 (0.094) data 0.000 (0.008) loss 0.8986 (1.0056) ce_loss 0.2856 (0.3972) teacher_loss 0.1083 (0.2683) loss_zs_kd 0.1274 (0.1087) loss_oracle 0.7267 (0.6830) acc 90.6250 (84.8438) kd_loss 0.9941 (1.0265) lr 8.1262e-04 eta 0:05:55
epoch [30/50] batch [60/181] time 0.079 (0.091) data 0.001 (0.006) loss 1.0389 (1.0103) ce_loss 0.3394 (0.4068) teacher_loss 0.1951 (0.2777) loss_zs_kd 0.1035 (0.1108) loss_oracle 0.7920 (0.6772) acc 87.5000 (84.3750) kd_loss 1.0085 (1.0209) lr 8.1262e-04 eta 0:05:40
epoch [30/50] batch [80/181] time 0.087 (0.089) data 0.000 (0.004) loss 1.1236 (1.0043) ce_loss 0.5420 (0.4035) teacher_loss 0.3485 (0.2758) loss_zs_kd 0.0891 (0.1094) loss_oracle 0.7306 (0.6738) acc 78.1250 (84.4922) kd_loss 1.0693 (1.0201) lr 8.1262e-04 eta 0:05:33
epoch [30/50] batch [100/181] time 0.096 (0.088) data 0.000 (0.003) loss 0.8845 (1.0038) ce_loss 0.3149 (0.4088) teacher_loss 0.2016 (0.2760) loss_zs_kd 0.1002 (0.1119) loss_oracle 0.6329 (0.6719) acc 84.3750 (84.6250) kd_loss 1.0312 (1.0200) lr 8.1262e-04 eta 0:05:27
epoch [30/50] batch [120/181] time 0.080 (0.089) data 0.000 (0.003) loss 0.9580 (1.0009) ce_loss 0.3933 (0.4047) teacher_loss 0.2493 (0.2730) loss_zs_kd 0.0878 (0.1122) loss_oracle 0.6648 (0.6718) acc 81.2500 (84.7135) kd_loss 1.0056 (1.0202) lr 8.1262e-04 eta 0:05:26
epoch [30/50] batch [140/181] time 0.097 (0.089) data 0.000 (0.003) loss 0.7808 (1.0003) ce_loss 0.1343 (0.4019) teacher_loss 0.0806 (0.2717) loss_zs_kd 0.0689 (0.1123) loss_oracle 0.6657 (0.6724) acc 96.8750 (84.7991) kd_loss 1.0182 (1.0229) lr 8.1262e-04 eta 0:05:25
epoch [30/50] batch [160/181] time 0.093 (0.089) data 0.000 (0.002) loss 0.8885 (1.0012) ce_loss 0.2705 (0.4026) teacher_loss 0.1948 (0.2715) loss_zs_kd 0.0966 (0.1125) loss_oracle 0.6455 (0.6735) acc 90.6250 (84.7070) kd_loss 0.9617 (1.0274) lr 8.1262e-04 eta 0:05:24
epoch [30/50] batch [180/181] time 0.081 (0.088) data 0.000 (0.002) loss 1.0447 (0.9965) ce_loss 0.4895 (0.3970) teacher_loss 0.3334 (0.2691) loss_zs_kd 0.1133 (0.1130) loss_oracle 0.6547 (0.6709) acc 81.2500 (85.0347) kd_loss 1.0696 (1.0342) lr 8.1262e-04 eta 0:05:19
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,394
* accuracy: 95.9%
* error: 4.1%
* macro_f1: 96.4%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.9%, epoch: 30 *******
******* Domain p best val test acc: 99.9%, epoch: 30 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [31/50] batch [20/181] time 0.092 (0.109) data 0.000 (0.020) loss 1.1536 (0.9557) ce_loss 0.4524 (0.3521) teacher_loss 0.3279 (0.2493) loss_zs_kd 0.1504 (0.1108) loss_oracle 0.7504 (0.6510) acc 81.2500 (86.7188) kd_loss 1.1085 (1.1089) lr 7.5131e-04 eta 0:06:31
epoch [31/50] batch [40/181] time 0.080 (0.097) data 0.000 (0.010) loss 0.8595 (0.9824) ce_loss 0.3113 (0.3926) teacher_loss 0.1637 (0.2767) loss_zs_kd 0.1232 (0.1140) loss_oracle 0.6342 (0.6487) acc 87.5000 (85.7812) kd_loss 1.1374 (1.1109) lr 7.5131e-04 eta 0:05:47
epoch [31/50] batch [60/181] time 0.083 (0.093) data 0.000 (0.007) loss 1.0144 (0.9780) ce_loss 0.3464 (0.3973) teacher_loss 0.2606 (0.2735) loss_zs_kd 0.0931 (0.1167) loss_oracle 0.7073 (0.6462) acc 87.5000 (85.5729) kd_loss 1.1394 (1.1120) lr 7.5131e-04 eta 0:05:31
epoch [31/50] batch [80/181] time 0.088 (0.091) data 0.000 (0.005) loss 0.9963 (0.9671) ce_loss 0.3401 (0.3833) teacher_loss 0.2215 (0.2638) loss_zs_kd 0.0771 (0.1140) loss_oracle 0.7362 (0.6463) acc 87.5000 (86.1328) kd_loss 1.0924 (1.1174) lr 7.5131e-04 eta 0:05:21
epoch [31/50] batch [100/181] time 0.082 (0.090) data 0.000 (0.004) loss 0.8767 (0.9599) ce_loss 0.1343 (0.3748) teacher_loss 0.0876 (0.2552) loss_zs_kd 0.0594 (0.1149) loss_oracle 0.7594 (0.6472) acc 96.8750 (86.3438) kd_loss 1.2182 (1.1234) lr 7.5131e-04 eta 0:05:16
epoch [31/50] batch [120/181] time 0.072 (0.089) data 0.001 (0.004) loss 0.8368 (0.9636) ce_loss 0.1617 (0.3805) teacher_loss 0.1158 (0.2586) loss_zs_kd 0.0581 (0.1145) loss_oracle 0.6919 (0.6477) acc 93.7500 (86.0677) kd_loss 1.2321 (1.1285) lr 7.5131e-04 eta 0:05:11
epoch [31/50] batch [140/181] time 0.085 (0.088) data 0.000 (0.003) loss 0.8818 (0.9669) ce_loss 0.2161 (0.3852) teacher_loss 0.1938 (0.2602) loss_zs_kd 0.1330 (0.1166) loss_oracle 0.6215 (0.6484) acc 96.8750 (85.8705) kd_loss 1.1387 (1.1307) lr 7.5131e-04 eta 0:05:06
epoch [31/50] batch [160/181] time 0.095 (0.088) data 0.000 (0.003) loss 1.0825 (0.9675) ce_loss 0.4790 (0.3864) teacher_loss 0.3437 (0.2591) loss_zs_kd 0.1208 (0.1178) loss_oracle 0.6784 (0.6495) acc 81.2500 (85.8203) kd_loss 1.1253 (1.1317) lr 7.5131e-04 eta 0:05:03
epoch [31/50] batch [180/181] time 0.066 (0.086) data 0.000 (0.002) loss 0.8824 (0.9620) ce_loss 0.3899 (0.3836) teacher_loss 0.1900 (0.2566) loss_zs_kd 0.1229 (0.1173) loss_oracle 0.6309 (0.6467) acc 87.5000 (85.9201) kd_loss 1.0720 (1.1311) lr 7.5131e-04 eta 0:04:55
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,391
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      95.9%, epoch: 30 *******
******* Domain p best val test acc: 99.9%, epoch: 30 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [32/50] batch [20/181] time 0.080 (0.101) data 0.000 (0.014) loss 0.9131 (0.9446) ce_loss 0.3340 (0.3985) teacher_loss 0.2157 (0.2590) loss_zs_kd 0.1128 (0.1130) loss_oracle 0.6410 (0.6291) acc 87.5000 (85.3125) kd_loss 1.0853 (1.1356) lr 6.9098e-04 eta 0:05:45
epoch [32/50] batch [40/181] time 0.080 (0.091) data 0.000 (0.007) loss 0.7903 (0.9608) ce_loss 0.1860 (0.4059) teacher_loss 0.1224 (0.2665) loss_zs_kd 0.1009 (0.1134) loss_oracle 0.6175 (0.6376) acc 93.7500 (85.0000) kd_loss 1.0808 (1.1318) lr 6.9098e-04 eta 0:05:09
epoch [32/50] batch [60/181] time 0.083 (0.089) data 0.001 (0.005) loss 1.1506 (0.9679) ce_loss 0.5630 (0.4110) teacher_loss 0.4056 (0.2704) loss_zs_kd 0.1157 (0.1157) loss_oracle 0.6872 (0.6396) acc 84.3750 (85.2083) kd_loss 1.1151 (1.1365) lr 6.9098e-04 eta 0:04:59
epoch [32/50] batch [80/181] time 0.094 (0.088) data 0.000 (0.004) loss 0.8590 (0.9629) ce_loss 0.3201 (0.4057) teacher_loss 0.2213 (0.2605) loss_zs_kd 0.1135 (0.1187) loss_oracle 0.5810 (0.6431) acc 90.6250 (85.3906) kd_loss 1.0814 (1.1342) lr 6.9098e-04 eta 0:04:57
epoch [32/50] batch [100/181] time 0.093 (0.087) data 0.000 (0.003) loss 0.8402 (0.9756) ce_loss 0.2183 (0.4045) teacher_loss 0.1822 (0.2612) loss_zs_kd 0.1292 (0.1214) loss_oracle 0.5934 (0.6537) acc 90.6250 (85.3438) kd_loss 0.9624 (1.1252) lr 6.9098e-04 eta 0:04:51
epoch [32/50] batch [120/181] time 0.090 (0.087) data 0.000 (0.003) loss 0.8545 (0.9702) ce_loss 0.4646 (0.4032) teacher_loss 0.2508 (0.2569) loss_zs_kd 0.0943 (0.1221) loss_oracle 0.5565 (0.6523) acc 84.3750 (85.3125) kd_loss 0.9267 (1.1154) lr 6.9098e-04 eta 0:04:50
epoch [32/50] batch [140/181] time 0.094 (0.087) data 0.001 (0.002) loss 0.9655 (0.9735) ce_loss 0.3237 (0.3981) teacher_loss 0.2000 (0.2537) loss_zs_kd 0.1335 (0.1216) loss_oracle 0.6988 (0.6590) acc 87.5000 (85.5580) kd_loss 1.1014 (1.1125) lr 6.9098e-04 eta 0:04:48
epoch [32/50] batch [160/181] time 0.091 (0.087) data 0.000 (0.002) loss 1.1933 (0.9729) ce_loss 0.4802 (0.3924) teacher_loss 0.3564 (0.2513) loss_zs_kd 0.1335 (0.1199) loss_oracle 0.7702 (0.6617) acc 78.1250 (85.9375) kd_loss 1.1281 (1.1066) lr 6.9098e-04 eta 0:04:46
epoch [32/50] batch [180/181] time 0.075 (0.087) data 0.000 (0.002) loss 0.7110 (0.9769) ce_loss 0.1755 (0.3968) teacher_loss 0.0982 (0.2551) loss_zs_kd 0.0668 (0.1192) loss_oracle 0.5795 (0.6621) acc 93.7500 (85.5208) kd_loss 1.1339 (1.1000) lr 6.9098e-04 eta 0:04:42
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,397
* accuracy: 96.0%
* error: 4.0%
* macro_f1: 96.5%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.0%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [33/50] batch [20/181] time 0.084 (0.105) data 0.001 (0.019) loss 0.8688 (0.9633) ce_loss 0.3259 (0.3845) teacher_loss 0.1800 (0.2432) loss_zs_kd 0.1383 (0.1148) loss_oracle 0.6197 (0.6627) acc 90.6250 (87.1875) kd_loss 1.1066 (1.0575) lr 6.3188e-04 eta 0:05:38
epoch [33/50] batch [40/181] time 0.084 (0.094) data 0.000 (0.010) loss 0.9651 (0.9768) ce_loss 0.4753 (0.3958) teacher_loss 0.2864 (0.2579) loss_zs_kd 0.1222 (0.1155) loss_oracle 0.6176 (0.6612) acc 87.5000 (86.6406) kd_loss 1.0580 (1.0525) lr 6.3188e-04 eta 0:05:03
epoch [33/50] batch [60/181] time 0.087 (0.091) data 0.001 (0.007) loss 0.9943 (0.9932) ce_loss 0.3894 (0.4290) teacher_loss 0.2741 (0.2819) loss_zs_kd 0.1571 (0.1171) loss_oracle 0.6416 (0.6528) acc 87.5000 (85.0521) kd_loss 1.1438 (1.0488) lr 6.3188e-04 eta 0:04:52
epoch [33/50] batch [80/181] time 0.082 (0.091) data 0.000 (0.005) loss 0.8965 (0.9951) ce_loss 0.2637 (0.4283) teacher_loss 0.1518 (0.2803) loss_zs_kd 0.1186 (0.1195) loss_oracle 0.6854 (0.6550) acc 96.8750 (85.0000) kd_loss 1.0642 (1.0392) lr 6.3188e-04 eta 0:04:47
epoch [33/50] batch [100/181] time 0.089 (0.089) data 0.000 (0.004) loss 0.8422 (0.9990) ce_loss 0.3025 (0.4309) teacher_loss 0.1492 (0.2845) loss_zs_kd 0.0812 (0.1217) loss_oracle 0.6524 (0.6536) acc 87.5000 (84.8125) kd_loss 1.0773 (1.0389) lr 6.3188e-04 eta 0:04:41
epoch [33/50] batch [120/181] time 0.090 (0.088) data 0.001 (0.003) loss 1.0078 (0.9987) ce_loss 0.5049 (0.4229) teacher_loss 0.2739 (0.2788) loss_zs_kd 0.1402 (0.1193) loss_oracle 0.6638 (0.6603) acc 81.2500 (85.0000) kd_loss 0.9289 (1.0366) lr 6.3188e-04 eta 0:04:36
epoch [33/50] batch [140/181] time 0.082 (0.087) data 0.000 (0.003) loss 0.7192 (1.0010) ce_loss 0.1153 (0.4245) teacher_loss 0.0719 (0.2810) loss_zs_kd 0.0761 (0.1196) loss_oracle 0.6093 (0.6602) acc 96.8750 (84.7545) kd_loss 0.9748 (1.0333) lr 6.3188e-04 eta 0:04:32
epoch [33/50] batch [160/181] time 0.089 (0.087) data 0.000 (0.003) loss 0.8166 (0.9913) ce_loss 0.2184 (0.4119) teacher_loss 0.1428 (0.2754) loss_zs_kd 0.0875 (0.1173) loss_oracle 0.6300 (0.6573) acc 93.7500 (85.4102) kd_loss 0.9407 (1.0317) lr 6.3188e-04 eta 0:04:29
epoch [33/50] batch [180/181] time 0.077 (0.086) data 0.001 (0.002) loss 0.9282 (0.9908) ce_loss 0.3611 (0.4104) teacher_loss 0.2490 (0.2767) loss_zs_kd 0.1308 (0.1161) loss_oracle 0.6138 (0.6561) acc 84.3750 (85.3646) kd_loss 1.0021 (1.0265) lr 6.3188e-04 eta 0:04:26
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,394
* accuracy: 95.9%
* error: 4.1%
* macro_f1: 96.4%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.0%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [34/50] batch [20/181] time 0.080 (0.103) data 0.000 (0.019) loss 0.8889 (0.9674) ce_loss 0.2338 (0.4012) teacher_loss 0.1750 (0.2835) loss_zs_kd 0.0996 (0.1019) loss_oracle 0.6641 (0.6330) acc 93.7500 (85.6250) kd_loss 0.9934 (0.9765) lr 5.7422e-04 eta 0:05:15
epoch [34/50] batch [40/181] time 0.083 (0.095) data 0.000 (0.010) loss 0.8926 (0.9655) ce_loss 0.3494 (0.4148) teacher_loss 0.2495 (0.2894) loss_zs_kd 0.0852 (0.1064) loss_oracle 0.6005 (0.6229) acc 84.3750 (84.5312) kd_loss 0.9149 (0.9716) lr 5.7422e-04 eta 0:04:48
epoch [34/50] batch [60/181] time 0.081 (0.092) data 0.001 (0.007) loss 0.8930 (0.9475) ce_loss 0.3020 (0.4013) teacher_loss 0.2536 (0.2832) loss_zs_kd 0.1089 (0.1093) loss_oracle 0.5850 (0.6096) acc 90.6250 (85.3125) kd_loss 0.9288 (0.9701) lr 5.7422e-04 eta 0:04:36
epoch [34/50] batch [80/181] time 0.083 (0.089) data 0.001 (0.005) loss 0.8639 (0.9441) ce_loss 0.3057 (0.4052) teacher_loss 0.2328 (0.2882) loss_zs_kd 0.0936 (0.1102) loss_oracle 0.5842 (0.6009) acc 87.5000 (85.0781) kd_loss 0.8905 (0.9615) lr 5.7422e-04 eta 0:04:27
epoch [34/50] batch [100/181] time 0.081 (0.088) data 0.000 (0.004) loss 0.7718 (0.9474) ce_loss 0.1677 (0.4054) teacher_loss 0.1350 (0.2927) loss_zs_kd 0.0714 (0.1103) loss_oracle 0.6011 (0.5995) acc 93.7500 (85.0312) kd_loss 0.9434 (0.9624) lr 5.7422e-04 eta 0:04:22
epoch [34/50] batch [120/181] time 0.081 (0.088) data 0.000 (0.003) loss 0.8298 (0.9390) ce_loss 0.2622 (0.3926) teacher_loss 0.1525 (0.2872) loss_zs_kd 0.0953 (0.1078) loss_oracle 0.6296 (0.5979) acc 87.5000 (85.5208) kd_loss 1.0459 (0.9708) lr 5.7422e-04 eta 0:04:19
epoch [34/50] batch [140/181] time 0.076 (0.087) data 0.000 (0.003) loss 1.0984 (0.9458) ce_loss 0.4978 (0.3849) teacher_loss 0.4002 (0.2842) loss_zs_kd 0.1281 (0.1070) loss_oracle 0.6342 (0.6080) acc 84.3750 (85.8259) kd_loss 1.1282 (0.9843) lr 5.7422e-04 eta 0:04:15
epoch [34/50] batch [160/181] time 0.083 (0.086) data 0.000 (0.003) loss 1.0250 (0.9559) ce_loss 0.4653 (0.3866) teacher_loss 0.3292 (0.2855) loss_zs_kd 0.1167 (0.1064) loss_oracle 0.6374 (0.6173) acc 78.1250 (85.8594) kd_loss 1.0291 (0.9952) lr 5.7422e-04 eta 0:04:11
epoch [34/50] batch [180/181] time 0.074 (0.085) data 0.000 (0.002) loss 0.9530 (0.9603) ce_loss 0.3403 (0.3822) teacher_loss 0.2808 (0.2827) loss_zs_kd 0.0849 (0.1066) loss_oracle 0.6298 (0.6243) acc 87.5000 (86.0938) kd_loss 1.0902 (1.0056) lr 5.7422e-04 eta 0:04:06
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,390
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.0%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [35/50] batch [20/181] time 0.074 (0.099) data 0.000 (0.016) loss 1.2347 (1.0401) ce_loss 0.6035 (0.3675) teacher_loss 0.4385 (0.2618) loss_zs_kd 0.0793 (0.0963) loss_oracle 0.7565 (0.7301) acc 81.2500 (87.0312) kd_loss 1.1067 (1.1000) lr 5.1825e-04 eta 0:04:44
epoch [35/50] batch [40/181] time 0.086 (0.088) data 0.000 (0.008) loss 1.2112 (1.0611) ce_loss 0.6362 (0.4127) teacher_loss 0.4496 (0.2849) loss_zs_kd 0.1015 (0.1087) loss_oracle 0.7108 (0.7219) acc 81.2500 (85.0000) kd_loss 1.0731 (1.0969) lr 5.1825e-04 eta 0:04:10
epoch [35/50] batch [60/181] time 0.068 (0.085) data 0.000 (0.006) loss 1.3622 (1.0698) ce_loss 0.7256 (0.4027) teacher_loss 0.5573 (0.2811) loss_zs_kd 0.1052 (0.1103) loss_oracle 0.7523 (0.7336) acc 75.0000 (85.4688) kd_loss 1.0778 (1.1015) lr 5.1825e-04 eta 0:04:01
epoch [35/50] batch [80/181] time 0.080 (0.083) data 0.000 (0.004) loss 0.9491 (1.0676) ce_loss 0.3853 (0.4085) teacher_loss 0.2102 (0.2813) loss_zs_kd 0.1485 (0.1121) loss_oracle 0.6647 (0.7303) acc 87.5000 (85.3906) kd_loss 1.0174 (1.1008) lr 5.1825e-04 eta 0:03:53
epoch [35/50] batch [100/181] time 0.070 (0.082) data 0.001 (0.003) loss 1.0941 (1.0636) ce_loss 0.3447 (0.3970) teacher_loss 0.2507 (0.2712) loss_zs_kd 0.1203 (0.1106) loss_oracle 0.7833 (0.7371) acc 87.5000 (85.6250) kd_loss 1.0729 (1.1043) lr 5.1825e-04 eta 0:03:48
epoch [35/50] batch [120/181] time 0.083 (0.080) data 0.000 (0.003) loss 0.9391 (1.0601) ce_loss 0.1732 (0.3953) teacher_loss 0.1302 (0.2703) loss_zs_kd 0.0651 (0.1087) loss_oracle 0.7764 (0.7354) acc 96.8750 (85.8073) kd_loss 1.1393 (1.1039) lr 5.1825e-04 eta 0:03:43
epoch [35/50] batch [140/181] time 0.072 (0.079) data 0.000 (0.003) loss 1.1591 (1.0630) ce_loss 0.4543 (0.4012) teacher_loss 0.3097 (0.2744) loss_zs_kd 0.1045 (0.1106) loss_oracle 0.7972 (0.7333) acc 87.5000 (85.5580) kd_loss 1.1438 (1.1011) lr 5.1825e-04 eta 0:03:38
epoch [35/50] batch [160/181] time 0.078 (0.079) data 0.000 (0.002) loss 0.9467 (1.0566) ce_loss 0.3010 (0.3954) teacher_loss 0.1415 (0.2696) loss_zs_kd 0.0971 (0.1093) loss_oracle 0.7567 (0.7324) acc 87.5000 (85.8594) kd_loss 1.0785 (1.1010) lr 5.1825e-04 eta 0:03:35
epoch [35/50] batch [180/181] time 0.076 (0.078) data 0.000 (0.002) loss 1.0784 (1.0528) ce_loss 0.4233 (0.3958) teacher_loss 0.2813 (0.2687) loss_zs_kd 0.1190 (0.1092) loss_oracle 0.7377 (0.7295) acc 78.1250 (85.8681) kd_loss 1.0829 (1.1006) lr 5.1825e-04 eta 0:03:32
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,390
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.0%, epoch: 32 *******
******* Domain p best val test acc: 99.9%, epoch: 32 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [36/50] batch [20/181] time 0.082 (0.104) data 0.000 (0.016) loss 0.9953 (1.0960) ce_loss 0.2920 (0.4264) teacher_loss 0.1751 (0.2779) loss_zs_kd 0.0949 (0.1234) loss_oracle 0.7727 (0.7564) acc 93.7500 (84.8438) kd_loss 1.0895 (1.0813) lr 4.6417e-04 eta 0:04:39
epoch [36/50] batch [40/181] time 0.088 (0.094) data 0.000 (0.008) loss 1.0422 (1.0809) ce_loss 0.4255 (0.4219) teacher_loss 0.2617 (0.2778) loss_zs_kd 0.1164 (0.1194) loss_oracle 0.7223 (0.7434) acc 81.2500 (84.9219) kd_loss 1.0678 (1.0849) lr 4.6417e-04 eta 0:04:12
epoch [36/50] batch [60/181] time 0.083 (0.092) data 0.001 (0.005) loss 1.0394 (1.0715) ce_loss 0.4956 (0.4038) teacher_loss 0.3180 (0.2678) loss_zs_kd 0.1204 (0.1161) loss_oracle 0.6612 (0.7457) acc 84.3750 (85.4167) kd_loss 1.0510 (1.0817) lr 4.6417e-04 eta 0:04:04
epoch [36/50] batch [80/181] time 0.082 (0.090) data 0.000 (0.004) loss 1.0089 (1.0606) ce_loss 0.2886 (0.3914) teacher_loss 0.1933 (0.2618) loss_zs_kd 0.1049 (0.1148) loss_oracle 0.7632 (0.7414) acc 90.6250 (85.7812) kd_loss 1.0678 (1.0837) lr 4.6417e-04 eta 0:03:58
epoch [36/50] batch [100/181] time 0.084 (0.090) data 0.000 (0.003) loss 1.2513 (1.0522) ce_loss 0.5010 (0.3830) teacher_loss 0.3890 (0.2570) loss_zs_kd 0.1425 (0.1145) loss_oracle 0.7910 (0.7379) acc 87.5000 (86.1875) kd_loss 1.0868 (1.0832) lr 4.6417e-04 eta 0:03:54
epoch [36/50] batch [120/181] time 0.085 (0.089) data 0.000 (0.003) loss 1.0120 (1.0507) ce_loss 0.3860 (0.3825) teacher_loss 0.2478 (0.2577) loss_zs_kd 0.1237 (0.1124) loss_oracle 0.7023 (0.7368) acc 90.6250 (86.0938) kd_loss 1.0097 (1.0823) lr 4.6417e-04 eta 0:03:50
epoch [36/50] batch [140/181] time 0.080 (0.088) data 0.000 (0.002) loss 0.8800 (1.0489) ce_loss 0.2437 (0.3828) teacher_loss 0.1441 (0.2600) loss_zs_kd 0.1201 (0.1124) loss_oracle 0.6759 (0.7327) acc 93.7500 (86.0714) kd_loss 1.0817 (1.0798) lr 4.6417e-04 eta 0:03:46
epoch [36/50] batch [160/181] time 0.066 (0.088) data 0.000 (0.002) loss 0.8710 (1.0404) ce_loss 0.3411 (0.3774) teacher_loss 0.2069 (0.2579) loss_zs_kd 0.0720 (0.1104) loss_oracle 0.6281 (0.7273) acc 84.3750 (86.3477) kd_loss 0.9253 (1.0759) lr 4.6417e-04 eta 0:03:45
epoch [36/50] batch [180/181] time 0.074 (0.087) data 0.000 (0.002) loss 1.0392 (1.0365) ce_loss 0.5024 (0.3783) teacher_loss 0.3284 (0.2614) loss_zs_kd 0.1479 (0.1094) loss_oracle 0.6368 (0.7204) acc 81.2500 (86.3194) kd_loss 1.0652 (1.0698) lr 4.6417e-04 eta 0:03:41
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,401
* accuracy: 96.2%
* error: 3.8%
* macro_f1: 96.7%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.2%, epoch: 36 *******
******* Domain p best val test acc: 99.9%, epoch: 36 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [37/50] batch [20/181] time 0.079 (0.103) data 0.000 (0.019) loss 0.9084 (0.9938) ce_loss 0.2532 (0.3802) teacher_loss 0.2033 (0.2885) loss_zs_kd 0.0786 (0.1012) loss_oracle 0.6658 (0.6546) acc 90.6250 (86.2500) kd_loss 1.0825 (1.0321) lr 4.1221e-04 eta 0:04:18
epoch [37/50] batch [40/181] time 0.079 (0.089) data 0.000 (0.010) loss 0.9146 (0.9888) ce_loss 0.3586 (0.3949) teacher_loss 0.2186 (0.2980) loss_zs_kd 0.0718 (0.1038) loss_oracle 0.6601 (0.6390) acc 87.5000 (85.3125) kd_loss 1.0507 (1.0137) lr 4.1221e-04 eta 0:03:41
epoch [37/50] batch [60/181] time 0.079 (0.087) data 0.001 (0.007) loss 0.8071 (0.9873) ce_loss 0.3506 (0.4032) teacher_loss 0.2110 (0.3047) loss_zs_kd 0.0986 (0.1055) loss_oracle 0.5469 (0.6298) acc 90.6250 (85.3646) kd_loss 0.9812 (1.0000) lr 4.1221e-04 eta 0:03:35
epoch [37/50] batch [80/181] time 0.079 (0.086) data 0.000 (0.005) loss 0.9660 (0.9817) ce_loss 0.3960 (0.4009) teacher_loss 0.2453 (0.3009) loss_zs_kd 0.0927 (0.1077) loss_oracle 0.6743 (0.6269) acc 78.1250 (85.3125) kd_loss 0.9861 (0.9960) lr 4.1221e-04 eta 0:03:32
epoch [37/50] batch [100/181] time 0.093 (0.086) data 0.000 (0.004) loss 1.1355 (0.9883) ce_loss 0.5713 (0.4038) teacher_loss 0.4358 (0.3065) loss_zs_kd 0.1767 (0.1088) loss_oracle 0.6113 (0.6274) acc 84.3750 (85.3750) kd_loss 0.9974 (0.9917) lr 4.1221e-04 eta 0:03:29
epoch [37/50] batch [120/181] time 0.086 (0.086) data 0.000 (0.003) loss 0.9633 (0.9878) ce_loss 0.3003 (0.4052) teacher_loss 0.3020 (0.3070) loss_zs_kd 0.1047 (0.1088) loss_oracle 0.6089 (0.6264) acc 87.5000 (85.2604) kd_loss 0.9962 (0.9928) lr 4.1221e-04 eta 0:03:27
epoch [37/50] batch [140/181] time 0.090 (0.086) data 0.000 (0.003) loss 1.0917 (0.9861) ce_loss 0.5801 (0.4048) teacher_loss 0.4629 (0.3079) loss_zs_kd 0.1318 (0.1081) loss_oracle 0.5629 (0.6241) acc 81.2500 (85.3348) kd_loss 0.9477 (0.9883) lr 4.1221e-04 eta 0:03:25
epoch [37/50] batch [160/181] time 0.087 (0.086) data 0.000 (0.003) loss 1.0284 (0.9852) ce_loss 0.4480 (0.4034) teacher_loss 0.3538 (0.3079) loss_zs_kd 0.1242 (0.1061) loss_oracle 0.6125 (0.6243) acc 87.5000 (85.3516) kd_loss 1.0302 (0.9853) lr 4.1221e-04 eta 0:03:24
epoch [37/50] batch [180/181] time 0.075 (0.085) data 0.000 (0.002) loss 1.2290 (0.9843) ce_loss 0.4802 (0.4026) teacher_loss 0.4666 (0.3080) loss_zs_kd 0.1125 (0.1048) loss_oracle 0.7061 (0.6240) acc 81.2500 (85.5382) kd_loss 0.9858 (0.9826) lr 4.1221e-04 eta 0:03:20
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,391
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.2%, epoch: 36 *******
******* Domain p best val test acc: 99.9%, epoch: 36 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [38/50] batch [20/181] time 0.082 (0.093) data 0.000 (0.013) loss 1.0109 (1.0249) ce_loss 0.3843 (0.3925) teacher_loss 0.3248 (0.3125) loss_zs_kd 0.0790 (0.0881) loss_oracle 0.6466 (0.6684) acc 84.3750 (86.0938) kd_loss 0.9489 (0.9908) lr 3.6258e-04 eta 0:03:35
epoch [38/50] batch [40/181] time 0.084 (0.085) data 0.000 (0.007) loss 0.9339 (0.9986) ce_loss 0.4102 (0.4026) teacher_loss 0.2743 (0.3161) loss_zs_kd 0.0462 (0.0864) loss_oracle 0.6365 (0.6393) acc 84.3750 (85.8594) kd_loss 0.9489 (0.9777) lr 3.6258e-04 eta 0:03:15
epoch [38/50] batch [60/181] time 0.098 (0.085) data 0.001 (0.005) loss 0.9765 (0.9954) ce_loss 0.3042 (0.3928) teacher_loss 0.2121 (0.3075) loss_zs_kd 0.0678 (0.0865) loss_oracle 0.7305 (0.6446) acc 87.5000 (85.8333) kd_loss 0.9909 (0.9742) lr 3.6258e-04 eta 0:03:15
epoch [38/50] batch [80/181] time 0.083 (0.085) data 0.000 (0.004) loss 1.0721 (0.9896) ce_loss 0.4700 (0.3956) teacher_loss 0.3609 (0.3044) loss_zs_kd 0.1378 (0.0872) loss_oracle 0.6423 (0.6415) acc 78.1250 (85.7031) kd_loss 1.0386 (0.9684) lr 3.6258e-04 eta 0:03:14
epoch [38/50] batch [100/181] time 0.084 (0.086) data 0.000 (0.003) loss 1.2603 (0.9958) ce_loss 0.7661 (0.4037) teacher_loss 0.5893 (0.3091) loss_zs_kd 0.1395 (0.0898) loss_oracle 0.6013 (0.6418) acc 65.6250 (85.2188) kd_loss 0.9441 (0.9653) lr 3.6258e-04 eta 0:03:12
epoch [38/50] batch [120/181] time 0.083 (0.086) data 0.000 (0.002) loss 1.0967 (1.0005) ce_loss 0.5107 (0.4066) teacher_loss 0.3338 (0.3081) loss_zs_kd 0.0817 (0.0927) loss_oracle 0.7220 (0.6460) acc 84.3750 (85.1562) kd_loss 0.9901 (0.9656) lr 3.6258e-04 eta 0:03:11
epoch [38/50] batch [140/181] time 0.076 (0.085) data 0.000 (0.002) loss 0.9180 (0.9998) ce_loss 0.2786 (0.4022) teacher_loss 0.2164 (0.3036) loss_zs_kd 0.0647 (0.0931) loss_oracle 0.6692 (0.6496) acc 90.6250 (85.3348) kd_loss 1.0044 (0.9672) lr 3.6258e-04 eta 0:03:08
epoch [38/50] batch [160/181] time 0.082 (0.085) data 0.000 (0.002) loss 0.8713 (1.0007) ce_loss 0.3569 (0.4069) teacher_loss 0.2293 (0.3029) loss_zs_kd 0.1037 (0.0964) loss_oracle 0.5901 (0.6496) acc 90.6250 (85.1367) kd_loss 1.0005 (0.9682) lr 3.6258e-04 eta 0:03:07
epoch [38/50] batch [180/181] time 0.075 (0.085) data 0.000 (0.002) loss 0.8141 (0.9940) ce_loss 0.1978 (0.3995) teacher_loss 0.1215 (0.2956) loss_zs_kd 0.0805 (0.0969) loss_oracle 0.6523 (0.6499) acc 96.8750 (85.4861) kd_loss 0.9710 (0.9688) lr 3.6258e-04 eta 0:03:03
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,393
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.4%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.2%, epoch: 36 *******
******* Domain p best val test acc: 99.9%, epoch: 36 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [39/50] batch [20/181] time 0.096 (0.107) data 0.001 (0.017) loss 0.9968 (0.9313) ce_loss 0.3806 (0.3106) teacher_loss 0.2712 (0.2291) loss_zs_kd 0.1417 (0.0996) loss_oracle 0.6547 (0.6523) acc 90.6250 (89.6875) kd_loss 1.0052 (0.9770) lr 3.1545e-04 eta 0:03:49
epoch [39/50] batch [40/181] time 0.095 (0.097) data 0.000 (0.009) loss 1.0403 (0.9726) ce_loss 0.4761 (0.3723) teacher_loss 0.2944 (0.2635) loss_zs_kd 0.1259 (0.1004) loss_oracle 0.6829 (0.6589) acc 81.2500 (87.4219) kd_loss 0.9167 (0.9664) lr 3.1545e-04 eta 0:03:26
epoch [39/50] batch [60/181] time 0.084 (0.094) data 0.001 (0.006) loss 1.0243 (0.9840) ce_loss 0.4646 (0.3858) teacher_loss 0.3186 (0.2685) loss_zs_kd 0.1044 (0.1027) loss_oracle 0.6534 (0.6642) acc 87.5000 (86.1979) kd_loss 0.8955 (0.9649) lr 3.1545e-04 eta 0:03:18
epoch [39/50] batch [80/181] time 0.088 (0.093) data 0.000 (0.005) loss 0.8549 (0.9980) ce_loss 0.2322 (0.3981) teacher_loss 0.1474 (0.2750) loss_zs_kd 0.0859 (0.1083) loss_oracle 0.6646 (0.6688) acc 93.7500 (85.3516) kd_loss 0.9928 (0.9685) lr 3.1545e-04 eta 0:03:13
epoch [39/50] batch [100/181] time 0.082 (0.092) data 0.000 (0.004) loss 1.0863 (1.0015) ce_loss 0.4646 (0.3973) teacher_loss 0.3082 (0.2740) loss_zs_kd 0.1416 (0.1102) loss_oracle 0.7073 (0.6725) acc 78.1250 (85.2188) kd_loss 1.0068 (0.9663) lr 3.1545e-04 eta 0:03:10
epoch [39/50] batch [120/181] time 0.102 (0.091) data 0.001 (0.003) loss 0.9052 (1.0029) ce_loss 0.2432 (0.3959) teacher_loss 0.1817 (0.2743) loss_zs_kd 0.0957 (0.1099) loss_oracle 0.6757 (0.6737) acc 93.7500 (85.3385) kd_loss 1.0137 (0.9615) lr 3.1545e-04 eta 0:03:07
epoch [39/50] batch [140/181] time 0.083 (0.091) data 0.000 (0.003) loss 1.1609 (1.0056) ce_loss 0.5010 (0.3985) teacher_loss 0.3305 (0.2762) loss_zs_kd 0.1517 (0.1100) loss_oracle 0.7546 (0.6744) acc 84.3750 (85.3125) kd_loss 0.9457 (0.9587) lr 3.1545e-04 eta 0:03:04
epoch [39/50] batch [160/181] time 0.083 (0.090) data 0.000 (0.002) loss 0.9972 (1.0043) ce_loss 0.4099 (0.3965) teacher_loss 0.2725 (0.2740) loss_zs_kd 0.1307 (0.1104) loss_oracle 0.6593 (0.6751) acc 84.3750 (85.4883) kd_loss 0.9099 (0.9597) lr 3.1545e-04 eta 0:03:01
epoch [39/50] batch [180/181] time 0.076 (0.089) data 0.000 (0.002) loss 0.8352 (1.0016) ce_loss 0.1456 (0.3953) teacher_loss 0.0850 (0.2721) loss_zs_kd 0.0493 (0.1102) loss_oracle 0.7256 (0.6744) acc 93.7500 (85.4688) kd_loss 0.9490 (0.9586) lr 3.1545e-04 eta 0:02:56
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,395
* accuracy: 95.9%
* error: 4.1%
* macro_f1: 96.5%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.2%, epoch: 36 *******
******* Domain p best val test acc: 99.9%, epoch: 36 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [40/50] batch [20/181] time 0.079 (0.102) data 0.000 (0.016) loss 0.8052 (1.0070) ce_loss 0.1500 (0.4072) teacher_loss 0.0916 (0.3004) loss_zs_kd 0.1031 (0.1088) loss_oracle 0.6621 (0.6521) acc 90.6250 (85.4688) kd_loss 0.9265 (0.9170) lr 2.7103e-04 eta 0:03:20
epoch [40/50] batch [40/181] time 0.090 (0.093) data 0.000 (0.008) loss 1.0522 (1.0057) ce_loss 0.4358 (0.4169) teacher_loss 0.2873 (0.2884) loss_zs_kd 0.1408 (0.1194) loss_oracle 0.6945 (0.6576) acc 78.1250 (84.4531) kd_loss 0.9397 (0.9295) lr 2.7103e-04 eta 0:03:01
epoch [40/50] batch [60/181] time 0.082 (0.091) data 0.001 (0.006) loss 0.8492 (0.9885) ce_loss 0.2607 (0.3965) teacher_loss 0.1582 (0.2767) loss_zs_kd 0.0798 (0.1127) loss_oracle 0.6511 (0.6554) acc 93.7500 (85.4167) kd_loss 1.0298 (0.9301) lr 2.7103e-04 eta 0:02:55
epoch [40/50] batch [80/181] time 0.087 (0.090) data 0.000 (0.004) loss 1.0219 (0.9861) ce_loss 0.4697 (0.3989) teacher_loss 0.3174 (0.2779) loss_zs_kd 0.1187 (0.1121) loss_oracle 0.6452 (0.6521) acc 84.3750 (85.4688) kd_loss 0.9196 (0.9328) lr 2.7103e-04 eta 0:02:52
epoch [40/50] batch [100/181] time 0.088 (0.089) data 0.000 (0.004) loss 1.1631 (0.9805) ce_loss 0.5986 (0.3902) teacher_loss 0.3961 (0.2725) loss_zs_kd 0.1023 (0.1098) loss_oracle 0.7159 (0.6532) acc 78.1250 (85.8750) kd_loss 0.9481 (0.9339) lr 2.7103e-04 eta 0:02:49
epoch [40/50] batch [120/181] time 0.092 (0.089) data 0.000 (0.003) loss 0.9585 (0.9706) ce_loss 0.3855 (0.3821) teacher_loss 0.2855 (0.2650) loss_zs_kd 0.1260 (0.1102) loss_oracle 0.6101 (0.6506) acc 93.7500 (86.0156) kd_loss 0.9266 (0.9331) lr 2.7103e-04 eta 0:02:46
epoch [40/50] batch [140/181] time 0.087 (0.089) data 0.000 (0.003) loss 1.0342 (0.9674) ce_loss 0.4988 (0.3810) teacher_loss 0.3816 (0.2633) loss_zs_kd 0.1123 (0.1106) loss_oracle 0.5964 (0.6487) acc 78.1250 (85.9598) kd_loss 0.8745 (0.9368) lr 2.7103e-04 eta 0:02:44
epoch [40/50] batch [160/181] time 0.089 (0.088) data 0.000 (0.002) loss 1.0223 (0.9623) ce_loss 0.6343 (0.3819) teacher_loss 0.3551 (0.2640) loss_zs_kd 0.1609 (0.1102) loss_oracle 0.5868 (0.6432) acc 78.1250 (85.9180) kd_loss 0.9263 (0.9350) lr 2.7103e-04 eta 0:02:42
epoch [40/50] batch [180/181] time 0.074 (0.088) data 0.000 (0.002) loss 1.0108 (0.9647) ce_loss 0.4038 (0.3858) teacher_loss 0.2697 (0.2659) loss_zs_kd 0.0949 (0.1109) loss_oracle 0.6937 (0.6434) acc 87.5000 (85.7465) kd_loss 0.9497 (0.9362) lr 2.7103e-04 eta 0:02:38
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,399
* accuracy: 96.1%
* error: 3.9%
* macro_f1: 96.6%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.2%, epoch: 36 *******
******* Domain p best val test acc: 99.9%, epoch: 36 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [41/50] batch [20/181] time 0.083 (0.109) data 0.000 (0.021) loss 1.1016 (0.9677) ce_loss 0.5625 (0.3872) teacher_loss 0.3469 (0.2713) loss_zs_kd 0.1330 (0.1092) loss_oracle 0.6881 (0.6418) acc 81.2500 (86.8750) kd_loss 0.9320 (0.9636) lr 2.2949e-04 eta 0:03:15
epoch [41/50] batch [40/181] time 0.084 (0.097) data 0.000 (0.011) loss 0.8790 (0.9554) ce_loss 0.4031 (0.3736) teacher_loss 0.2428 (0.2576) loss_zs_kd 0.1125 (0.1138) loss_oracle 0.5799 (0.6409) acc 84.3750 (86.7969) kd_loss 0.9210 (0.9873) lr 2.2949e-04 eta 0:02:51
epoch [41/50] batch [60/181] time 0.080 (0.093) data 0.001 (0.007) loss 0.9638 (0.9559) ce_loss 0.3484 (0.3681) teacher_loss 0.1920 (0.2453) loss_zs_kd 0.2159 (0.1182) loss_oracle 0.6638 (0.6515) acc 96.8750 (86.6667) kd_loss 1.0343 (1.0086) lr 2.2949e-04 eta 0:02:42
epoch [41/50] batch [80/181] time 0.085 (0.091) data 0.000 (0.005) loss 0.7731 (0.9522) ce_loss 0.2537 (0.3633) teacher_loss 0.1417 (0.2423) loss_zs_kd 0.1120 (0.1167) loss_oracle 0.5754 (0.6516) acc 96.8750 (86.9922) kd_loss 1.0529 (1.0180) lr 2.2949e-04 eta 0:02:37
epoch [41/50] batch [100/181] time 0.089 (0.091) data 0.000 (0.004) loss 1.1307 (0.9642) ce_loss 0.5098 (0.3730) teacher_loss 0.3499 (0.2489) loss_zs_kd 0.1135 (0.1174) loss_oracle 0.7241 (0.6566) acc 81.2500 (86.4688) kd_loss 1.1357 (1.0235) lr 2.2949e-04 eta 0:02:35
epoch [41/50] batch [120/181] time 0.084 (0.090) data 0.000 (0.004) loss 1.0083 (0.9636) ce_loss 0.5039 (0.3782) teacher_loss 0.2657 (0.2480) loss_zs_kd 0.1034 (0.1176) loss_oracle 0.6909 (0.6569) acc 87.5000 (86.2760) kd_loss 1.0183 (1.0274) lr 2.2949e-04 eta 0:02:32
epoch [41/50] batch [140/181] time 0.083 (0.089) data 0.000 (0.003) loss 0.9816 (0.9660) ce_loss 0.2925 (0.3811) teacher_loss 0.1968 (0.2474) loss_zs_kd 0.1292 (0.1184) loss_oracle 0.7202 (0.6594) acc 93.7500 (86.1830) kd_loss 1.1263 (1.0307) lr 2.2949e-04 eta 0:02:29
epoch [41/50] batch [160/181] time 0.089 (0.089) data 0.000 (0.003) loss 1.1840 (0.9718) ce_loss 0.5186 (0.3852) teacher_loss 0.3832 (0.2486) loss_zs_kd 0.1520 (0.1203) loss_oracle 0.7248 (0.6630) acc 81.2500 (86.0547) kd_loss 1.1096 (1.0347) lr 2.2949e-04 eta 0:02:26
epoch [41/50] batch [180/181] time 0.066 (0.087) data 0.000 (0.003) loss 0.8902 (0.9726) ce_loss 0.4197 (0.3852) teacher_loss 0.2423 (0.2482) loss_zs_kd 0.1054 (0.1214) loss_oracle 0.5952 (0.6637) acc 87.5000 (86.0417) kd_loss 1.0198 (1.0376) lr 2.2949e-04 eta 0:02:22
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,394
* accuracy: 95.9%
* error: 4.1%
* macro_f1: 96.4%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.2%, epoch: 36 *******
******* Domain p best val test acc: 99.9%, epoch: 36 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [42/50] batch [20/181] time 0.086 (0.097) data 0.000 (0.014) loss 0.7244 (0.9646) ce_loss 0.0801 (0.3586) teacher_loss 0.0547 (0.2338) loss_zs_kd 0.0624 (0.1134) loss_oracle 0.6386 (0.6742) acc 100.0000 (87.0312) kd_loss 1.1194 (1.0786) lr 1.9098e-04 eta 0:02:36
epoch [42/50] batch [40/181] time 0.084 (0.090) data 0.000 (0.007) loss 0.9194 (0.9742) ce_loss 0.2415 (0.3814) teacher_loss 0.1451 (0.2502) loss_zs_kd 0.0980 (0.1171) loss_oracle 0.7253 (0.6655) acc 93.7500 (85.5469) kd_loss 1.1360 (1.0780) lr 1.9098e-04 eta 0:02:23
epoch [42/50] batch [60/181] time 0.084 (0.089) data 0.000 (0.005) loss 1.1498 (0.9846) ce_loss 0.6909 (0.4042) teacher_loss 0.4761 (0.2710) loss_zs_kd 0.1629 (0.1155) loss_oracle 0.5923 (0.6558) acc 78.1250 (84.8438) kd_loss 1.0584 (1.0744) lr 1.9098e-04 eta 0:02:19
epoch [42/50] batch [80/181] time 0.083 (0.088) data 0.000 (0.004) loss 0.8936 (0.9664) ce_loss 0.3757 (0.3900) teacher_loss 0.1817 (0.2576) loss_zs_kd 0.1433 (0.1153) loss_oracle 0.6402 (0.6512) acc 90.6250 (85.5469) kd_loss 1.0728 (1.0752) lr 1.9098e-04 eta 0:02:16
epoch [42/50] batch [100/181] time 0.084 (0.088) data 0.000 (0.003) loss 0.9526 (0.9641) ce_loss 0.3184 (0.3878) teacher_loss 0.1845 (0.2587) loss_zs_kd 0.1085 (0.1167) loss_oracle 0.7138 (0.6470) acc 87.5000 (85.8750) kd_loss 1.0941 (1.0764) lr 1.9098e-04 eta 0:02:14
epoch [42/50] batch [120/181] time 0.080 (0.088) data 0.000 (0.003) loss 0.9546 (0.9557) ce_loss 0.4319 (0.3823) teacher_loss 0.3184 (0.2573) loss_zs_kd 0.1289 (0.1159) loss_oracle 0.5718 (0.6404) acc 81.2500 (86.0677) kd_loss 1.0043 (1.0790) lr 1.9098e-04 eta 0:02:12
epoch [42/50] batch [140/181] time 0.082 (0.087) data 0.000 (0.002) loss 0.8544 (0.9554) ce_loss 0.3210 (0.3897) teacher_loss 0.2011 (0.2627) loss_zs_kd 0.1165 (0.1159) loss_oracle 0.5951 (0.6348) acc 87.5000 (85.7812) kd_loss 1.2016 (1.0810) lr 1.9098e-04 eta 0:02:09
epoch [42/50] batch [160/181] time 0.084 (0.087) data 0.000 (0.002) loss 1.0275 (0.9524) ce_loss 0.4297 (0.3875) teacher_loss 0.3244 (0.2633) loss_zs_kd 0.1197 (0.1157) loss_oracle 0.6432 (0.6312) acc 84.3750 (85.8008) kd_loss 1.1436 (1.0852) lr 1.9098e-04 eta 0:02:08
epoch [42/50] batch [180/181] time 0.075 (0.086) data 0.000 (0.002) loss 0.9765 (0.9498) ce_loss 0.4197 (0.3865) teacher_loss 0.3628 (0.2659) loss_zs_kd 0.0824 (0.1161) loss_oracle 0.5725 (0.6258) acc 81.2500 (85.9549) kd_loss 1.1482 (1.0872) lr 1.9098e-04 eta 0:02:05
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,394
* accuracy: 95.9%
* error: 4.1%
* macro_f1: 96.4%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.2%, epoch: 36 *******
******* Domain p best val test acc: 99.9%, epoch: 36 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [43/50] batch [20/181] time 0.090 (0.109) data 0.000 (0.020) loss 1.0229 (0.9415) ce_loss 0.4141 (0.3619) teacher_loss 0.4320 (0.2920) loss_zs_kd 0.1512 (0.1148) loss_oracle 0.5153 (0.5921) acc 84.3750 (85.9375) kd_loss 1.1085 (1.1345) lr 1.5567e-04 eta 0:02:36
epoch [43/50] batch [40/181] time 0.080 (0.097) data 0.000 (0.010) loss 0.9119 (0.9172) ce_loss 0.3872 (0.3646) teacher_loss 0.3731 (0.2977) loss_zs_kd 0.1150 (0.1111) loss_oracle 0.4813 (0.5639) acc 90.6250 (87.1875) kd_loss 1.1634 (1.1325) lr 1.5567e-04 eta 0:02:17
epoch [43/50] batch [60/181] time 0.088 (0.094) data 0.001 (0.007) loss 0.8905 (0.9286) ce_loss 0.5005 (0.3733) teacher_loss 0.3549 (0.3039) loss_zs_kd 0.1378 (0.1127) loss_oracle 0.4667 (0.5683) acc 84.3750 (86.8750) kd_loss 1.1033 (1.1495) lr 1.5567e-04 eta 0:02:10
epoch [43/50] batch [80/181] time 0.087 (0.092) data 0.000 (0.005) loss 0.7651 (0.9239) ce_loss 0.2377 (0.3645) teacher_loss 0.2086 (0.2967) loss_zs_kd 0.1032 (0.1110) loss_oracle 0.5049 (0.5717) acc 93.7500 (87.4609) kd_loss 1.2343 (1.1595) lr 1.5567e-04 eta 0:02:05
epoch [43/50] batch [100/181] time 0.093 (0.091) data 0.000 (0.004) loss 1.0015 (0.9267) ce_loss 0.2737 (0.3726) teacher_loss 0.2224 (0.3072) loss_zs_kd 0.1134 (0.1084) loss_oracle 0.7225 (0.5653) acc 96.8750 (86.9062) kd_loss 1.2436 (1.1716) lr 1.5567e-04 eta 0:02:02
epoch [43/50] batch [120/181] time 0.084 (0.090) data 0.000 (0.004) loss 0.8709 (0.9321) ce_loss 0.2822 (0.3796) teacher_loss 0.2165 (0.3113) loss_zs_kd 0.1113 (0.1073) loss_oracle 0.5987 (0.5671) acc 90.6250 (86.5104) kd_loss 1.2728 (1.1795) lr 1.5567e-04 eta 0:01:59
epoch [43/50] batch [140/181] time 0.085 (0.089) data 0.001 (0.003) loss 0.7454 (0.9316) ce_loss 0.2440 (0.3785) teacher_loss 0.2042 (0.3120) loss_zs_kd 0.0929 (0.1086) loss_oracle 0.4948 (0.5653) acc 90.6250 (86.5402) kd_loss 1.1885 (1.1848) lr 1.5567e-04 eta 0:01:56
epoch [43/50] batch [160/181] time 0.092 (0.089) data 0.000 (0.003) loss 0.9085 (0.9387) ce_loss 0.3882 (0.3843) teacher_loss 0.3199 (0.3188) loss_zs_kd 0.1094 (0.1091) loss_oracle 0.5339 (0.5654) acc 78.1250 (86.3281) kd_loss 1.2268 (1.1903) lr 1.5567e-04 eta 0:01:54
epoch [43/50] batch [180/181] time 0.075 (0.088) data 0.000 (0.002) loss 0.8973 (0.9368) ce_loss 0.2264 (0.3859) teacher_loss 0.2427 (0.3214) loss_zs_kd 0.0919 (0.1087) loss_oracle 0.6087 (0.5611) acc 87.5000 (86.1979) kd_loss 1.2742 (1.1960) lr 1.5567e-04 eta 0:01:51
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,395
* accuracy: 95.9%
* error: 4.1%
* macro_f1: 96.5%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.2%, epoch: 36 *******
******* Domain p best val test acc: 99.9%, epoch: 36 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [44/50] batch [20/181] time 0.082 (0.101) data 0.000 (0.014) loss 0.9603 (0.8974) ce_loss 0.4636 (0.3784) teacher_loss 0.3360 (0.3114) loss_zs_kd 0.1270 (0.1050) loss_oracle 0.5609 (0.5335) acc 81.2500 (86.7188) kd_loss 1.2359 (1.2275) lr 1.2369e-04 eta 0:02:05
epoch [44/50] batch [40/181] time 0.088 (0.094) data 0.000 (0.007) loss 0.9029 (0.9101) ce_loss 0.3110 (0.3871) teacher_loss 0.3626 (0.3179) loss_zs_kd 0.0891 (0.1074) loss_oracle 0.4957 (0.5385) acc 87.5000 (85.8594) kd_loss 1.1874 (1.2216) lr 1.2369e-04 eta 0:01:54
epoch [44/50] batch [60/181] time 0.088 (0.091) data 0.001 (0.005) loss 0.8874 (0.9123) ce_loss 0.3838 (0.3856) teacher_loss 0.2511 (0.3148) loss_zs_kd 0.1141 (0.1057) loss_oracle 0.5793 (0.5447) acc 84.3750 (85.7292) kd_loss 1.2219 (1.2292) lr 1.2369e-04 eta 0:01:49
epoch [44/50] batch [80/181] time 0.086 (0.090) data 0.000 (0.004) loss 1.2626 (0.9124) ce_loss 0.5859 (0.3801) teacher_loss 0.4988 (0.3156) loss_zs_kd 0.1176 (0.1040) loss_oracle 0.7049 (0.5447) acc 78.1250 (85.8984) kd_loss 1.2129 (1.2310) lr 1.2369e-04 eta 0:01:46
epoch [44/50] batch [100/181] time 0.089 (0.089) data 0.000 (0.003) loss 0.7926 (0.9176) ce_loss 0.2095 (0.3845) teacher_loss 0.1817 (0.3208) loss_zs_kd 0.0977 (0.1034) loss_oracle 0.5621 (0.5451) acc 87.5000 (85.7188) kd_loss 1.2013 (1.2273) lr 1.2369e-04 eta 0:01:44
epoch [44/50] batch [120/181] time 0.094 (0.089) data 0.000 (0.003) loss 1.1748 (0.9226) ce_loss 0.6313 (0.3912) teacher_loss 0.4802 (0.3275) loss_zs_kd 0.1170 (0.1021) loss_oracle 0.6360 (0.5441) acc 78.1250 (85.3646) kd_loss 1.2651 (1.2276) lr 1.2369e-04 eta 0:01:41
epoch [44/50] batch [140/181] time 0.087 (0.088) data 0.000 (0.002) loss 0.7645 (0.9280) ce_loss 0.3745 (0.3970) teacher_loss 0.2358 (0.3325) loss_zs_kd 0.0898 (0.1025) loss_oracle 0.4838 (0.5442) acc 90.6250 (85.2009) kd_loss 1.2759 (1.2250) lr 1.2369e-04 eta 0:01:39
epoch [44/50] batch [160/181] time 0.087 (0.088) data 0.000 (0.002) loss 1.2917 (0.9289) ce_loss 0.5869 (0.3992) teacher_loss 0.5724 (0.3347) loss_zs_kd 0.1606 (0.1022) loss_oracle 0.6390 (0.5431) acc 78.1250 (85.2148) kd_loss 1.2564 (1.2235) lr 1.2369e-04 eta 0:01:37
epoch [44/50] batch [180/181] time 0.075 (0.087) data 0.000 (0.002) loss 0.7679 (0.9191) ce_loss 0.2969 (0.3908) teacher_loss 0.1836 (0.3267) loss_zs_kd 0.0944 (0.1007) loss_oracle 0.5371 (0.5421) acc 87.5000 (85.4514) kd_loss 1.1805 (1.2222) lr 1.2369e-04 eta 0:01:34
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,394
* accuracy: 95.9%
* error: 4.1%
* macro_f1: 96.5%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.2%, epoch: 36 *******
******* Domain p best val test acc: 99.9%, epoch: 36 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [45/50] batch [20/181] time 0.085 (0.103) data 0.000 (0.018) loss 0.7942 (0.8981) ce_loss 0.1952 (0.3715) teacher_loss 0.1532 (0.3192) loss_zs_kd 0.0884 (0.0916) loss_oracle 0.5968 (0.5330) acc 93.7500 (86.7188) kd_loss 1.1797 (1.2270) lr 9.5173e-05 eta 0:01:50
epoch [45/50] batch [40/181] time 0.079 (0.094) data 0.000 (0.009) loss 0.8109 (0.8948) ce_loss 0.3584 (0.3609) teacher_loss 0.2818 (0.2994) loss_zs_kd 0.1486 (0.0969) loss_oracle 0.4548 (0.5470) acc 87.5000 (87.7344) kd_loss 1.2494 (1.2145) lr 9.5173e-05 eta 0:01:37
epoch [45/50] batch [60/181] time 0.091 (0.091) data 0.000 (0.006) loss 1.0978 (0.9140) ce_loss 0.5356 (0.3820) teacher_loss 0.4025 (0.3188) loss_zs_kd 0.1449 (0.0976) loss_oracle 0.6228 (0.5464) acc 78.1250 (86.5625) kd_loss 1.1982 (1.2139) lr 9.5173e-05 eta 0:01:33
epoch [45/50] batch [80/181] time 0.084 (0.091) data 0.000 (0.005) loss 0.8713 (0.8988) ce_loss 0.3982 (0.3763) teacher_loss 0.2529 (0.3123) loss_zs_kd 0.0916 (0.0948) loss_oracle 0.5726 (0.5392) acc 81.2500 (86.4844) kd_loss 1.1831 (1.2123) lr 9.5173e-05 eta 0:01:31
epoch [45/50] batch [100/181] time 0.085 (0.089) data 0.000 (0.004) loss 0.8711 (0.8992) ce_loss 0.3989 (0.3804) teacher_loss 0.3851 (0.3155) loss_zs_kd 0.0775 (0.0938) loss_oracle 0.4473 (0.5367) acc 87.5000 (86.3438) kd_loss 1.2699 (1.2147) lr 9.5173e-05 eta 0:01:28
epoch [45/50] batch [120/181] time 0.090 (0.089) data 0.001 (0.003) loss 0.8017 (0.9006) ce_loss 0.2871 (0.3801) teacher_loss 0.2728 (0.3154) loss_zs_kd 0.0672 (0.0940) loss_oracle 0.4953 (0.5382) acc 90.6250 (86.4062) kd_loss 1.2201 (1.2134) lr 9.5173e-05 eta 0:01:25
epoch [45/50] batch [140/181] time 0.088 (0.088) data 0.000 (0.003) loss 0.8333 (0.9055) ce_loss 0.3630 (0.3888) teacher_loss 0.2867 (0.3207) loss_zs_kd 0.1183 (0.0954) loss_oracle 0.4875 (0.5370) acc 84.3750 (86.0491) kd_loss 1.2370 (1.2116) lr 9.5173e-05 eta 0:01:23
epoch [45/50] batch [160/181] time 0.088 (0.088) data 0.000 (0.003) loss 0.9746 (0.9087) ce_loss 0.4519 (0.3881) teacher_loss 0.3680 (0.3189) loss_zs_kd 0.1226 (0.0952) loss_oracle 0.5453 (0.5422) acc 81.2500 (85.9961) kd_loss 1.1979 (1.2102) lr 9.5173e-05 eta 0:01:21
epoch [45/50] batch [180/181] time 0.079 (0.087) data 0.000 (0.002) loss 0.9007 (0.9136) ce_loss 0.3108 (0.3954) teacher_loss 0.2611 (0.3218) loss_zs_kd 0.0820 (0.0960) loss_oracle 0.5986 (0.5439) acc 87.5000 (85.6597) kd_loss 1.1854 (1.2106) lr 9.5173e-05 eta 0:01:18
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,390
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.2%, epoch: 36 *******
******* Domain p best val test acc: 99.9%, epoch: 36 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [46/50] batch [20/181] time 0.080 (0.105) data 0.000 (0.020) loss 0.8148 (0.8463) ce_loss 0.2632 (0.3316) teacher_loss 0.1929 (0.2674) loss_zs_kd 0.0937 (0.0884) loss_oracle 0.5751 (0.5346) acc 90.6250 (87.5000) kd_loss 1.2036 (1.2175) lr 7.0224e-05 eta 0:01:33
epoch [46/50] batch [40/181] time 0.077 (0.094) data 0.000 (0.010) loss 1.0744 (0.8814) ce_loss 0.4792 (0.3680) teacher_loss 0.3685 (0.2892) loss_zs_kd 0.0869 (0.0948) loss_oracle 0.6624 (0.5447) acc 87.5000 (86.1719) kd_loss 1.2007 (1.2108) lr 7.0224e-05 eta 0:01:21
epoch [46/50] batch [60/181] time 0.085 (0.092) data 0.001 (0.007) loss 0.8797 (0.8923) ce_loss 0.3459 (0.3819) teacher_loss 0.2106 (0.2994) loss_zs_kd 0.0829 (0.0969) loss_oracle 0.6276 (0.5445) acc 84.3750 (85.3646) kd_loss 1.1917 (1.2033) lr 7.0224e-05 eta 0:01:17
epoch [46/50] batch [80/181] time 0.086 (0.090) data 0.000 (0.005) loss 0.8111 (0.9006) ce_loss 0.3494 (0.3877) teacher_loss 0.2477 (0.3038) loss_zs_kd 0.1039 (0.0990) loss_oracle 0.5114 (0.5474) acc 90.6250 (85.3906) kd_loss 1.1511 (1.2045) lr 7.0224e-05 eta 0:01:14
epoch [46/50] batch [100/181] time 0.087 (0.089) data 0.001 (0.004) loss 0.7428 (0.8890) ce_loss 0.3184 (0.3802) teacher_loss 0.2220 (0.3006) loss_zs_kd 0.0742 (0.0980) loss_oracle 0.4837 (0.5394) acc 87.5000 (85.6875) kd_loss 1.2407 (1.2055) lr 7.0224e-05 eta 0:01:11
epoch [46/50] batch [120/181] time 0.083 (0.089) data 0.000 (0.004) loss 0.9028 (0.8942) ce_loss 0.4978 (0.3879) teacher_loss 0.3931 (0.3065) loss_zs_kd 0.0951 (0.0993) loss_oracle 0.4621 (0.5380) acc 87.5000 (85.5990) kd_loss 1.2132 (1.2038) lr 7.0224e-05 eta 0:01:09
epoch [46/50] batch [140/181] time 0.091 (0.088) data 0.001 (0.003) loss 0.8339 (0.8939) ce_loss 0.3293 (0.3850) teacher_loss 0.2333 (0.3027) loss_zs_kd 0.0892 (0.0994) loss_oracle 0.5560 (0.5414) acc 90.6250 (85.7143) kd_loss 1.1597 (1.2030) lr 7.0224e-05 eta 0:01:07
epoch [46/50] batch [160/181] time 0.084 (0.088) data 0.000 (0.003) loss 0.9119 (0.8975) ce_loss 0.4575 (0.3865) teacher_loss 0.3830 (0.3055) loss_zs_kd 0.1173 (0.0995) loss_oracle 0.4703 (0.5422) acc 84.3750 (85.7617) kd_loss 1.2327 (1.2040) lr 7.0224e-05 eta 0:01:05
epoch [46/50] batch [180/181] time 0.077 (0.087) data 0.000 (0.003) loss 0.9128 (0.8962) ce_loss 0.3357 (0.3838) teacher_loss 0.2770 (0.3047) loss_zs_kd 0.0908 (0.0988) loss_oracle 0.5904 (0.5421) acc 84.3750 (85.7292) kd_loss 1.1632 (1.2047) lr 7.0224e-05 eta 0:01:03
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,391
* accuracy: 95.8%
* error: 4.2%
* macro_f1: 96.4%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,668
* accuracy: 99.9%
* error: 0.1%
* macro_f1: 99.9%
******* Domain p best val acc:      96.2%, epoch: 36 *******
******* Domain p best val test acc: 99.9%, epoch: 36 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [47/50] batch [20/181] time 0.081 (0.102) data 0.000 (0.014) loss 0.8942 (0.9423) ce_loss 0.4216 (0.4337) teacher_loss 0.2859 (0.3437) loss_zs_kd 0.0831 (0.1004) loss_oracle 0.5668 (0.5484) acc 81.2500 (83.4375) kd_loss 1.2360 (1.1983) lr 4.8943e-05 eta 0:01:11
epoch [47/50] batch [40/181] time 0.088 (0.091) data 0.000 (0.007) loss 0.8546 (0.9086) ce_loss 0.4897 (0.4135) teacher_loss 0.3379 (0.3269) loss_zs_kd 0.1327 (0.0982) loss_oracle 0.4503 (0.5327) acc 87.5000 (84.9219) kd_loss 1.1797 (1.2034) lr 4.8943e-05 eta 0:01:02
epoch [47/50] batch [60/181] time 0.087 (0.089) data 0.001 (0.005) loss 0.8803 (0.9004) ce_loss 0.3928 (0.4092) teacher_loss 0.3280 (0.3204) loss_zs_kd 0.0849 (0.0954) loss_oracle 0.5099 (0.5323) acc 84.3750 (85.1042) kd_loss 1.2402 (1.2064) lr 4.8943e-05 eta 0:00:59
epoch [47/50] batch [80/181] time 0.084 (0.088) data 0.000 (0.004) loss 0.7052 (0.8870) ce_loss 0.2258 (0.3920) teacher_loss 0.1572 (0.3081) loss_zs_kd 0.0896 (0.0954) loss_oracle 0.5032 (0.5312) acc 90.6250 (85.6641) kd_loss 1.2247 (1.2037) lr 4.8943e-05 eta 0:00:56
epoch [47/50] batch [100/181] time 0.084 (0.088) data 0.000 (0.003) loss 0.8878 (0.8924) ce_loss 0.3721 (0.3985) teacher_loss 0.2714 (0.3100) loss_zs_kd 0.1005 (0.0953) loss_oracle 0.5661 (0.5348) acc 87.5000 (85.4375) kd_loss 1.2296 (1.2018) lr 4.8943e-05 eta 0:00:55
epoch [47/50] batch [120/181] time 0.086 (0.088) data 0.000 (0.003) loss 0.7570 (0.8939) ce_loss 0.3181 (0.3997) teacher_loss 0.2417 (0.3101) loss_zs_kd 0.1183 (0.0966) loss_oracle 0.4562 (0.5355) acc 93.7500 (85.2865) kd_loss 1.2104 (1.2007) lr 4.8943e-05 eta 0:00:53
epoch [47/50] batch [140/181] time 0.085 (0.088) data 0.000 (0.002) loss 0.6789 (0.8865) ce_loss 0.2561 (0.3922) teacher_loss 0.1716 (0.3023) loss_zs_kd 0.0665 (0.0963) loss_oracle 0.4741 (0.5360) acc 90.6250 (85.6473) kd_loss 1.1866 (1.1984) lr 4.8943e-05 eta 0:00:51
epoch [47/50] batch [160/181] time 0.085 (0.088) data 0.000 (0.002) loss 0.6181 (0.8929) ce_loss 0.1444 (0.3941) teacher_loss 0.1256 (0.3058) loss_zs_kd 0.0583 (0.0970) loss_oracle 0.4634 (0.5385) acc 93.7500 (85.4688) kd_loss 1.2324 (1.1988) lr 4.8943e-05 eta 0:00:49
epoch [47/50] batch [180/181] time 0.075 (0.087) data 0.000 (0.002) loss 0.6871 (0.8864) ce_loss 0.1567 (0.3862) teacher_loss 0.0975 (0.3005) loss_zs_kd 0.0803 (0.0966) loss_oracle 0.5494 (0.5376) acc 96.8750 (85.8333) kd_loss 1.1722 (1.1988) lr 4.8943e-05 eta 0:00:47
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,389
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.2%, epoch: 36 *******
******* Domain p best val test acc: 99.9%, epoch: 36 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [48/50] batch [20/181] time 0.079 (0.104) data 0.000 (0.018) loss 0.6462 (0.8721) ce_loss 0.1497 (0.3862) teacher_loss 0.1120 (0.2862) loss_zs_kd 0.0592 (0.1062) loss_oracle 0.5046 (0.5328) acc 96.8750 (86.2500) kd_loss 1.2121 (1.1880) lr 3.1417e-05 eta 0:00:54
epoch [48/50] batch [40/181] time 0.081 (0.093) data 0.000 (0.009) loss 0.8926 (0.8736) ce_loss 0.5454 (0.3859) teacher_loss 0.4206 (0.2952) loss_zs_kd 0.1203 (0.0999) loss_oracle 0.4119 (0.5285) acc 78.1250 (85.9375) kd_loss 1.1762 (1.1954) lr 3.1417e-05 eta 0:00:46
epoch [48/50] batch [60/181] time 0.089 (0.091) data 0.001 (0.006) loss 0.8307 (0.8853) ce_loss 0.3970 (0.3882) teacher_loss 0.2584 (0.3027) loss_zs_kd 0.1463 (0.1013) loss_oracle 0.4992 (0.5319) acc 78.1250 (85.7292) kd_loss 1.1585 (1.1933) lr 3.1417e-05 eta 0:00:43
epoch [48/50] batch [80/181] time 0.095 (0.089) data 0.001 (0.005) loss 0.9791 (0.8883) ce_loss 0.4702 (0.3978) teacher_loss 0.3768 (0.3090) loss_zs_kd 0.1162 (0.1009) loss_oracle 0.5442 (0.5289) acc 81.2500 (85.1953) kd_loss 1.2201 (1.1914) lr 3.1417e-05 eta 0:00:41
epoch [48/50] batch [100/181] time 0.088 (0.089) data 0.000 (0.004) loss 0.7896 (0.8890) ce_loss 0.1459 (0.3952) teacher_loss 0.1229 (0.3067) loss_zs_kd 0.0561 (0.0999) loss_oracle 0.6386 (0.5323) acc 93.7500 (85.4062) kd_loss 1.1873 (1.1919) lr 3.1417e-05 eta 0:00:39
epoch [48/50] batch [120/181] time 0.082 (0.088) data 0.000 (0.003) loss 0.9758 (0.8918) ce_loss 0.4617 (0.3948) teacher_loss 0.3574 (0.3074) loss_zs_kd 0.0843 (0.0992) loss_oracle 0.5763 (0.5348) acc 81.2500 (85.3646) kd_loss 1.1590 (1.1929) lr 3.1417e-05 eta 0:00:37
epoch [48/50] batch [140/181] time 0.089 (0.088) data 0.000 (0.003) loss 0.9898 (0.8896) ce_loss 0.4753 (0.3934) teacher_loss 0.4481 (0.3067) loss_zs_kd 0.0892 (0.0997) loss_oracle 0.4971 (0.5331) acc 78.1250 (85.4241) kd_loss 1.2078 (1.1927) lr 3.1417e-05 eta 0:00:35
epoch [48/50] batch [160/181] time 0.089 (0.088) data 0.000 (0.003) loss 0.9194 (0.8918) ce_loss 0.5625 (0.3954) teacher_loss 0.4891 (0.3084) loss_zs_kd 0.0895 (0.1010) loss_oracle 0.3855 (0.5328) acc 81.2500 (85.2148) kd_loss 1.2020 (1.1929) lr 3.1417e-05 eta 0:00:33
epoch [48/50] batch [180/181] time 0.074 (0.087) data 0.000 (0.002) loss 0.9210 (0.8913) ce_loss 0.5215 (0.3952) teacher_loss 0.4225 (0.3073) loss_zs_kd 0.0962 (0.1010) loss_oracle 0.4504 (0.5334) acc 81.2500 (85.2778) kd_loss 1.2312 (1.1937) lr 3.1417e-05 eta 0:00:31
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,389
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.2%, epoch: 36 *******
******* Domain p best val test acc: 99.9%, epoch: 36 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [49/50] batch [20/181] time 0.084 (0.095) data 0.000 (0.013) loss 0.8601 (0.8418) ce_loss 0.3557 (0.3694) teacher_loss 0.2949 (0.2720) loss_zs_kd 0.0977 (0.0856) loss_oracle 0.5164 (0.5270) acc 84.3750 (86.0938) kd_loss 1.1833 (1.2017) lr 1.7713e-05 eta 0:00:32
epoch [49/50] batch [40/181] time 0.081 (0.088) data 0.000 (0.007) loss 1.0444 (0.8653) ce_loss 0.5635 (0.3751) teacher_loss 0.4601 (0.2834) loss_zs_kd 0.0945 (0.0936) loss_oracle 0.5371 (0.5351) acc 81.2500 (86.0938) kd_loss 1.2051 (1.2022) lr 1.7713e-05 eta 0:00:28
epoch [49/50] batch [60/181] time 0.086 (0.086) data 0.001 (0.005) loss 1.0603 (0.8831) ce_loss 0.5234 (0.3898) teacher_loss 0.4844 (0.3027) loss_zs_kd 0.1194 (0.0975) loss_oracle 0.5162 (0.5317) acc 78.1250 (85.2604) kd_loss 1.2055 (1.2001) lr 1.7713e-05 eta 0:00:25
epoch [49/50] batch [80/181] time 0.081 (0.085) data 0.000 (0.003) loss 0.8019 (0.8816) ce_loss 0.3245 (0.3917) teacher_loss 0.2235 (0.3009) loss_zs_kd 0.0895 (0.0989) loss_oracle 0.5337 (0.5312) acc 87.5000 (85.2734) kd_loss 1.1862 (1.2002) lr 1.7713e-05 eta 0:00:23
epoch [49/50] batch [100/181] time 0.081 (0.085) data 0.000 (0.003) loss 1.0553 (0.8923) ce_loss 0.6079 (0.4044) teacher_loss 0.4100 (0.3113) loss_zs_kd 0.1346 (0.1006) loss_oracle 0.5780 (0.5307) acc 81.2500 (84.7500) kd_loss 1.2151 (1.1970) lr 1.7713e-05 eta 0:00:22
epoch [49/50] batch [120/181] time 0.086 (0.085) data 0.000 (0.002) loss 0.7423 (0.8854) ce_loss 0.3149 (0.3982) teacher_loss 0.2255 (0.3051) loss_zs_kd 0.0656 (0.0984) loss_oracle 0.4839 (0.5312) acc 90.6250 (85.2083) kd_loss 1.1617 (1.1957) lr 1.7713e-05 eta 0:00:20
epoch [49/50] batch [140/181] time 0.087 (0.085) data 0.000 (0.002) loss 0.9906 (0.8864) ce_loss 0.5518 (0.3981) teacher_loss 0.4304 (0.3044) loss_zs_kd 0.0986 (0.0983) loss_oracle 0.5108 (0.5328) acc 75.0000 (85.2679) kd_loss 1.2090 (1.1959) lr 1.7713e-05 eta 0:00:18
epoch [49/50] batch [160/181] time 0.084 (0.085) data 0.000 (0.002) loss 1.0018 (0.8902) ce_loss 0.5293 (0.4001) teacher_loss 0.5104 (0.3084) loss_zs_kd 0.1144 (0.0985) loss_oracle 0.4342 (0.5326) acc 81.2500 (85.1758) kd_loss 1.2363 (1.1949) lr 1.7713e-05 eta 0:00:17
epoch [49/50] batch [180/181] time 0.075 (0.084) data 0.000 (0.002) loss 0.7719 (0.8856) ce_loss 0.3784 (0.3945) teacher_loss 0.3015 (0.3047) loss_zs_kd 0.0935 (0.0986) loss_oracle 0.4236 (0.5316) acc 90.6250 (85.4514) kd_loss 1.1700 (1.1943) lr 1.7713e-05 eta 0:00:15
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,389
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.2%, epoch: 36 *******
******* Domain p best val test acc: 99.9%, epoch: 36 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
epoch [50/50] batch [20/181] time 0.084 (0.101) data 0.000 (0.014) loss 1.0140 (0.8663) ce_loss 0.5498 (0.3697) teacher_loss 0.3928 (0.2775) loss_zs_kd 0.1581 (0.0964) loss_oracle 0.5422 (0.5407) acc 75.0000 (87.1875) kd_loss 1.1938 (1.2050) lr 7.8853e-06 eta 0:00:16
epoch [50/50] batch [40/181] time 0.083 (0.094) data 0.000 (0.007) loss 0.9647 (0.8886) ce_loss 0.5117 (0.3818) teacher_loss 0.3904 (0.2980) loss_zs_kd 0.1498 (0.0958) loss_oracle 0.4993 (0.5427) acc 81.2500 (86.5625) kd_loss 1.1556 (1.2012) lr 7.8853e-06 eta 0:00:13
epoch [50/50] batch [60/181] time 0.088 (0.092) data 0.000 (0.005) loss 0.9347 (0.8847) ce_loss 0.5195 (0.3837) teacher_loss 0.4053 (0.3000) loss_zs_kd 0.0715 (0.0957) loss_oracle 0.4935 (0.5368) acc 75.0000 (86.0938) kd_loss 1.1913 (1.1975) lr 7.8853e-06 eta 0:00:11
epoch [50/50] batch [80/181] time 0.083 (0.090) data 0.000 (0.004) loss 0.8098 (0.8807) ce_loss 0.4236 (0.3924) teacher_loss 0.2859 (0.3007) loss_zs_kd 0.1016 (0.0991) loss_oracle 0.4732 (0.5305) acc 81.2500 (85.7812) kd_loss 1.1841 (1.1957) lr 7.8853e-06 eta 0:00:09
epoch [50/50] batch [100/181] time 0.088 (0.089) data 0.001 (0.003) loss 0.8874 (0.8941) ce_loss 0.3655 (0.3993) teacher_loss 0.3000 (0.3089) loss_zs_kd 0.1251 (0.0988) loss_oracle 0.5248 (0.5357) acc 90.6250 (85.5938) kd_loss 1.1930 (1.1941) lr 7.8853e-06 eta 0:00:07
epoch [50/50] batch [120/181] time 0.084 (0.089) data 0.001 (0.003) loss 0.5269 (0.8884) ce_loss 0.1151 (0.3972) teacher_loss 0.0696 (0.3032) loss_zs_kd 0.0861 (0.1000) loss_oracle 0.4143 (0.5353) acc 100.0000 (85.7552) kd_loss 1.2359 (1.1933) lr 7.8853e-06 eta 0:00:05
epoch [50/50] batch [140/181] time 0.093 (0.088) data 0.000 (0.002) loss 0.7028 (0.8858) ce_loss 0.2031 (0.3946) teacher_loss 0.1728 (0.3020) loss_zs_kd 0.0887 (0.0994) loss_oracle 0.4857 (0.5340) acc 93.7500 (86.0045) kd_loss 1.2061 (1.1939) lr 7.8853e-06 eta 0:00:03
epoch [50/50] batch [160/181] time 0.085 (0.088) data 0.000 (0.002) loss 0.8097 (0.8819) ce_loss 0.3811 (0.3915) teacher_loss 0.2655 (0.2996) loss_zs_kd 0.1150 (0.0985) loss_oracle 0.4867 (0.5330) acc 87.5000 (85.9570) kd_loss 1.1792 (1.1946) lr 7.8853e-06 eta 0:00:01
epoch [50/50] batch [180/181] time 0.078 (0.087) data 0.000 (0.002) loss 1.0036 (0.8808) ce_loss 0.5327 (0.3906) teacher_loss 0.3697 (0.2969) loss_zs_kd 0.1239 (0.0986) loss_oracle 0.5721 (0.5346) acc 78.1250 (86.0069) kd_loss 1.2104 (1.1933) lr 7.8853e-06 eta 0:00:00
Evaluate on the *val* set
=> result
* total: 2,497
* correct: 2,389
* accuracy: 95.7%
* error: 4.3%
* macro_f1: 96.3%
Evaluate on the *test* set
=> result
* total: 1,670
* correct: 1,667
* accuracy: 99.8%
* error: 0.2%
* macro_f1: 99.8%
******* Domain p best val acc:      96.2%, epoch: 36 *******
******* Domain p best val test acc: 99.9%, epoch: 36 *******
******* Domain p best test acc:     99.9%, epoch: 1 *******
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/pacs/b32_ep50/ViT-B16/p/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:16:40
