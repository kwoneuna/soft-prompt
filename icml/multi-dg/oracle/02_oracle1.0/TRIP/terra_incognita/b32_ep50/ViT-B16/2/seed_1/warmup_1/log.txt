Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_100', 'location_43', 'location_46']
Target     ['location_38']
# classes  10
# train_x  10,216
# val      4,378
# test     9,736
---------  ----------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/319] time 0.079 (0.130) data 0.000 (0.029) loss 1.2538 (2.0168) ce_loss 1.2539 (2.0159) teacher_loss 1.2535 (2.0159) loss_zs_kd 0.0002 (0.0001) loss_oracle 0.0002 (0.0008) acc 59.3750 (37.0312) kd_loss 0.0007 (0.0033) lr 1.0000e-05 eta 0:34:30
epoch [1/50] batch [40/319] time 0.078 (0.105) data 0.000 (0.015) loss 1.5753 (1.9132) ce_loss 1.5742 (1.9125) teacher_loss 1.5741 (1.9124) loss_zs_kd 0.0015 (0.0003) loss_oracle 0.0005 (0.0007) acc 56.2500 (39.7656) kd_loss 0.0020 (0.0026) lr 1.0000e-05 eta 0:27:58
epoch [1/50] batch [60/319] time 0.088 (0.096) data 0.000 (0.010) loss 2.1729 (1.9416) ce_loss 2.1719 (1.9406) teacher_loss 2.1714 (1.9407) loss_zs_kd 0.0024 (0.0007) loss_oracle 0.0003 (0.0006) acc 31.2500 (39.2188) kd_loss 0.0010 (0.0022) lr 1.0000e-05 eta 0:25:25
epoch [1/50] batch [80/319] time 0.090 (0.092) data 0.000 (0.008) loss 1.9736 (1.9235) ce_loss 1.9717 (1.9224) teacher_loss 1.9713 (1.9224) loss_zs_kd 0.0034 (0.0013) loss_oracle 0.0005 (0.0005) acc 43.7500 (38.7891) kd_loss 0.0015 (0.0019) lr 1.0000e-05 eta 0:24:22
epoch [1/50] batch [100/319] time 0.080 (0.089) data 0.000 (0.006) loss 2.1777 (1.8855) ce_loss 2.1758 (1.8839) teacher_loss 2.1739 (1.8839) loss_zs_kd 0.0065 (0.0022) loss_oracle 0.0005 (0.0005) acc 25.0000 (39.3438) kd_loss 0.0014 (0.0019) lr 1.0000e-05 eta 0:23:37
epoch [1/50] batch [120/319] time 0.075 (0.088) data 0.000 (0.005) loss 1.8792 (1.8842) ce_loss 1.8760 (1.8822) teacher_loss 1.8755 (1.8822) loss_zs_kd 0.0052 (0.0029) loss_oracle 0.0011 (0.0006) acc 40.6250 (39.5052) kd_loss 0.0035 (0.0019) lr 1.0000e-05 eta 0:23:05
epoch [1/50] batch [140/319] time 0.081 (0.086) data 0.000 (0.004) loss 2.0693 (1.8851) ce_loss 2.0625 (1.8828) teacher_loss 2.0633 (1.8826) loss_zs_kd 0.0082 (0.0037) loss_oracle 0.0018 (0.0007) acc 37.5000 (39.4420) kd_loss 0.0052 (0.0022) lr 1.0000e-05 eta 0:22:43
epoch [1/50] batch [160/319] time 0.081 (0.086) data 0.000 (0.004) loss 1.8444 (1.8824) ce_loss 1.8369 (1.8794) teacher_loss 1.8371 (1.8792) loss_zs_kd 0.0110 (0.0048) loss_oracle 0.0018 (0.0008) acc 34.3750 (39.5898) kd_loss 0.0038 (0.0025) lr 1.0000e-05 eta 0:22:38
epoch [1/50] batch [180/319] time 0.086 (0.085) data 0.000 (0.003) loss 2.1984 (1.8801) ce_loss 2.1875 (1.8765) teacher_loss 2.1873 (1.8763) loss_zs_kd 0.0177 (0.0058) loss_oracle 0.0023 (0.0009) acc 28.1250 (39.5139) kd_loss 0.0055 (0.0027) lr 1.0000e-05 eta 0:22:27
epoch [1/50] batch [200/319] time 0.091 (0.085) data 0.001 (0.003) loss 2.0065 (1.8770) ce_loss 1.9961 (1.8726) teacher_loss 1.9941 (1.8724) loss_zs_kd 0.0180 (0.0069) loss_oracle 0.0034 (0.0011) acc 31.2500 (39.5312) kd_loss 0.0087 (0.0032) lr 1.0000e-05 eta 0:22:20
epoch [1/50] batch [220/319] time 0.080 (0.085) data 0.000 (0.003) loss 1.7622 (1.8846) ce_loss 1.7480 (1.8793) teacher_loss 1.7459 (1.8790) loss_zs_kd 0.0215 (0.0082) loss_oracle 0.0055 (0.0014) acc 40.6250 (39.1477) kd_loss 0.0163 (0.0040) lr 1.0000e-05 eta 0:22:15
epoch [1/50] batch [240/319] time 0.088 (0.085) data 0.000 (0.003) loss 1.9692 (1.8928) ce_loss 1.9453 (1.8865) teacher_loss 1.9450 (1.8862) loss_zs_kd 0.0299 (0.0094) loss_oracle 0.0092 (0.0019) acc 28.1250 (38.8151) kd_loss 0.0259 (0.0052) lr 1.0000e-05 eta 0:22:11
epoch [1/50] batch [260/319] time 0.079 (0.085) data 0.000 (0.003) loss 1.9922 (1.8920) ce_loss 1.9727 (1.8847) teacher_loss 1.9694 (1.8842) loss_zs_kd 0.0258 (0.0106) loss_oracle 0.0099 (0.0025) acc 37.5000 (38.6899) kd_loss 0.0261 (0.0070) lr 1.0000e-05 eta 0:22:06
epoch [1/50] batch [280/319] time 0.087 (0.085) data 0.000 (0.002) loss 2.0999 (1.8905) ce_loss 2.0742 (1.8818) teacher_loss 2.0689 (1.8812) loss_zs_kd 0.0335 (0.0119) loss_oracle 0.0142 (0.0034) acc 31.2500 (38.6830) kd_loss 0.0406 (0.0094) lr 1.0000e-05 eta 0:22:04
epoch [1/50] batch [300/319] time 0.087 (0.084) data 0.000 (0.002) loss 2.3540 (1.8890) ce_loss 2.3223 (1.8786) teacher_loss 2.3162 (1.8777) loss_zs_kd 0.0331 (0.0132) loss_oracle 0.0213 (0.0046) acc 28.1250 (38.6250) kd_loss 0.0569 (0.0128) lr 1.0000e-05 eta 0:22:00
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 1,744
* accuracy: 39.8%
* error: 60.2%
* macro_f1: 24.2%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 2,836
* accuracy: 29.1%
* error: 70.9%
* macro_f1: 11.2%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      39.8%, epoch: 1 *******
******* Domain 2 best val test acc: 29.1%, epoch: 1 *******
******* Domain 2 best test acc:     29.1%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/ana
epoch [2/50] batch [20/319] time 0.083 (0.106) data 0.000 (0.025) loss 2.0055 (1.8018) ce_loss 1.7461 (1.6526) teacher_loss 1.6865 (1.6196) loss_zs_kd 0.1394 (0.1499) loss_oracle 0.2492 (0.1073) acc 37.5000 (39.8438) kd_loss 0.6010 (0.2518) lr 2.0000e-03 eta 0:27:32
epoch [2/50] batch [40/319] time 0.087 (0.093) data 0.000 (0.013) loss 2.4118 (1.8845) ce_loss 2.1426 (1.6452) teacher_loss 2.0597 (1.5962) loss_zs_kd 0.1412 (0.1560) loss_oracle 0.2815 (0.2102) acc 31.2500 (41.0938) kd_loss 0.7544 (0.5251) lr 2.0000e-03 eta 0:24:03
epoch [2/50] batch [60/319] time 0.074 (0.088) data 0.000 (0.009) loss 1.9761 (1.8849) ce_loss 1.7334 (1.6406) teacher_loss 1.4517 (1.5598) loss_zs_kd 0.1124 (0.1478) loss_oracle 0.4681 (0.2512) acc 34.3750 (41.5625) kd_loss 1.0223 (0.6563) lr 2.0000e-03 eta 0:22:47
epoch [2/50] batch [80/319] time 0.082 (0.086) data 0.000 (0.007) loss 1.9125 (1.8885) ce_loss 1.7109 (1.6392) teacher_loss 1.4840 (1.5333) loss_zs_kd 0.1141 (0.1414) loss_oracle 0.3715 (0.2845) acc 31.2500 (41.7578) kd_loss 1.0061 (0.7330) lr 2.0000e-03 eta 0:22:09
epoch [2/50] batch [100/319] time 0.088 (0.085) data 0.000 (0.005) loss 1.9302 (1.8911) ce_loss 1.7588 (1.6460) teacher_loss 1.4709 (1.5149) loss_zs_kd 0.1348 (0.1404) loss_oracle 0.3919 (0.3059) acc 37.5000 (41.8125) kd_loss 0.9760 (0.7817) lr 2.0000e-03 eta 0:22:00
epoch [2/50] batch [120/319] time 0.082 (0.085) data 0.000 (0.004) loss 1.6087 (1.8859) ce_loss 1.4053 (1.6450) teacher_loss 1.0506 (1.4881) loss_zs_kd 0.1458 (0.1419) loss_oracle 0.4852 (0.3268) acc 56.2500 (41.5625) kd_loss 1.0219 (0.8161) lr 2.0000e-03 eta 0:21:59
epoch [2/50] batch [140/319] time 0.071 (0.084) data 0.000 (0.004) loss 2.2289 (1.8965) ce_loss 1.8555 (1.6413) teacher_loss 1.6139 (1.4721) loss_zs_kd 0.1457 (0.1426) loss_oracle 0.5420 (0.3531) acc 46.8750 (41.3170) kd_loss 0.8983 (0.8383) lr 2.0000e-03 eta 0:21:46
epoch [2/50] batch [160/319] time 0.083 (0.084) data 0.000 (0.003) loss 1.8179 (1.8992) ce_loss 1.4111 (1.6310) teacher_loss 1.2495 (1.4508) loss_zs_kd 0.1353 (0.1446) loss_oracle 0.5008 (0.3761) acc 50.0000 (41.8750) kd_loss 0.9612 (0.8556) lr 2.0000e-03 eta 0:21:43
epoch [2/50] batch [180/319] time 0.084 (0.084) data 0.000 (0.003) loss 2.1236 (1.9034) ce_loss 1.6064 (1.6291) teacher_loss 1.5276 (1.4406) loss_zs_kd 0.2050 (0.1446) loss_oracle 0.4935 (0.3905) acc 46.8750 (41.8229) kd_loss 0.9807 (0.8668) lr 2.0000e-03 eta 0:21:38
epoch [2/50] batch [200/319] time 0.090 (0.084) data 0.000 (0.003) loss 1.8269 (1.9029) ce_loss 1.4209 (1.6275) teacher_loss 1.2839 (1.4295) loss_zs_kd 0.1566 (0.1455) loss_oracle 0.4646 (0.4007) acc 53.1250 (41.9062) kd_loss 0.9299 (0.8745) lr 2.0000e-03 eta 0:21:40
epoch [2/50] batch [220/319] time 0.081 (0.084) data 0.000 (0.003) loss 2.2082 (1.9051) ce_loss 1.8633 (1.6299) teacher_loss 1.5712 (1.4189) loss_zs_kd 0.1444 (0.1475) loss_oracle 0.5647 (0.4125) acc 25.0000 (41.5341) kd_loss 0.9421 (0.8809) lr 2.0000e-03 eta 0:21:39
epoch [2/50] batch [240/319] time 0.083 (0.084) data 0.000 (0.002) loss 1.7525 (1.9059) ce_loss 1.3340 (1.6242) teacher_loss 1.0823 (1.4063) loss_zs_kd 0.1671 (0.1484) loss_oracle 0.5866 (0.4254) acc 46.8750 (41.6016) kd_loss 0.9400 (0.8858) lr 2.0000e-03 eta 0:21:37
epoch [2/50] batch [260/319] time 0.082 (0.084) data 0.000 (0.002) loss 1.7845 (1.8984) ce_loss 1.5732 (1.6113) teacher_loss 1.1287 (1.3875) loss_zs_kd 0.1388 (0.1493) loss_oracle 0.5863 (0.4363) acc 43.7500 (41.9952) kd_loss 0.9620 (0.8886) lr 2.0000e-03 eta 0:21:35
epoch [2/50] batch [280/319] time 0.079 (0.084) data 0.000 (0.002) loss 1.7507 (1.8978) ce_loss 1.5469 (1.6085) teacher_loss 1.1706 (1.3799) loss_zs_kd 0.1423 (0.1508) loss_oracle 0.5089 (0.4426) acc 43.7500 (42.1205) kd_loss 0.8801 (0.8882) lr 2.0000e-03 eta 0:21:33
epoch [2/50] batch [300/319] time 0.080 (0.084) data 0.000 (0.002) loss 1.8386 (1.8989) ce_loss 1.4395 (1.6092) teacher_loss 1.2217 (1.3757) loss_zs_kd 0.2041 (0.1528) loss_oracle 0.5148 (0.4468) acc 40.6250 (41.9583) kd_loss 0.8149 (0.8869) lr 2.0000e-03 eta 0:21:32
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 1,901
* accuracy: 43.4%
* error: 56.6%
* macro_f1: 30.5%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 2,674
* accuracy: 27.5%
* error: 72.5%
* macro_f1: 13.8%
******* Domain 2 best val acc:      43.4%, epoch: 2 *******
******* Domain 2 best val test acc: 27.5%, epoch: 2 *******
******* Domain 2 best test acc:     29.1%, epoch: 1 *******
epoch [3/50] batch [20/319] time 0.087 (0.122) data 0.000 (0.029) loss 1.6180 (1.8591) ce_loss 1.2393 (1.4879) teacher_loss 0.9925 (1.1834) loss_zs_kd 0.1398 (0.1746) loss_oracle 0.5557 (0.5883) acc 50.0000 (42.5000) kd_loss 0.8603 (0.8640) lr 1.9980e-03 eta 0:31:08
epoch [3/50] batch [40/319] time 0.074 (0.099) data 0.000 (0.015) loss 1.7790 (1.8486) ce_loss 1.4678 (1.5094) teacher_loss 1.2327 (1.2044) loss_zs_kd 0.1591 (0.1790) loss_oracle 0.4667 (0.5547) acc 50.0000 (42.8125) kd_loss 0.8728 (0.8625) lr 1.9980e-03 eta 0:25:17
epoch [3/50] batch [60/319] time 0.075 (0.093) data 0.001 (0.010) loss 1.6282 (1.8281) ce_loss 1.2227 (1.5100) teacher_loss 1.0566 (1.2045) loss_zs_kd 0.1593 (0.1775) loss_oracle 0.4920 (0.5348) acc 59.3750 (43.6458) kd_loss 0.8635 (0.8606) lr 1.9980e-03 eta 0:23:40
epoch [3/50] batch [80/319] time 0.080 (0.091) data 0.000 (0.008) loss 1.7276 (1.8271) ce_loss 1.5156 (1.5233) teacher_loss 0.9833 (1.2080) loss_zs_kd 0.1825 (0.1811) loss_oracle 0.6531 (0.5286) acc 43.7500 (43.2031) kd_loss 0.8987 (0.8540) lr 1.9980e-03 eta 0:23:06
epoch [3/50] batch [100/319] time 0.083 (0.089) data 0.000 (0.006) loss 1.7146 (1.8231) ce_loss 1.3760 (1.5216) teacher_loss 1.2161 (1.2095) loss_zs_kd 0.2294 (0.1827) loss_oracle 0.3838 (0.5222) acc 50.0000 (43.3750) kd_loss 0.8073 (0.8467) lr 1.9980e-03 eta 0:22:36
epoch [3/50] batch [120/319] time 0.086 (0.088) data 0.000 (0.005) loss 1.8676 (1.8183) ce_loss 1.6143 (1.5185) teacher_loss 1.3678 (1.2101) loss_zs_kd 0.1692 (0.1816) loss_oracle 0.4151 (0.5174) acc 46.8750 (43.6979) kd_loss 0.7958 (0.8419) lr 1.9980e-03 eta 0:22:20
epoch [3/50] batch [140/319] time 0.092 (0.087) data 0.001 (0.004) loss 1.6252 (1.8133) ce_loss 1.3223 (1.5158) teacher_loss 0.9985 (1.2055) loss_zs_kd 0.1702 (0.1829) loss_oracle 0.5416 (0.5163) acc 56.2500 (43.8170) kd_loss 0.8468 (0.8392) lr 1.9980e-03 eta 0:22:05
epoch [3/50] batch [160/319] time 0.085 (0.087) data 0.000 (0.004) loss 1.6549 (1.8109) ce_loss 1.2588 (1.5165) teacher_loss 1.0205 (1.2010) loss_zs_kd 0.2055 (0.1849) loss_oracle 0.5316 (0.5175) acc 59.3750 (43.9062) kd_loss 0.8126 (0.8354) lr 1.9980e-03 eta 0:21:58
epoch [3/50] batch [180/319] time 0.093 (0.087) data 0.000 (0.003) loss 1.7721 (1.8110) ce_loss 1.4668 (1.5215) teacher_loss 1.2427 (1.1990) loss_zs_kd 0.2311 (0.1900) loss_oracle 0.4138 (0.5170) acc 46.8750 (43.5764) kd_loss 0.8247 (0.8337) lr 1.9980e-03 eta 0:21:54
epoch [3/50] batch [200/319] time 0.077 (0.086) data 0.000 (0.003) loss 1.7446 (1.8003) ce_loss 1.4463 (1.5165) teacher_loss 1.1847 (1.1924) loss_zs_kd 0.2546 (0.1938) loss_oracle 0.4325 (0.5110) acc 37.5000 (43.6250) kd_loss 0.8036 (0.8317) lr 1.9980e-03 eta 0:21:46
epoch [3/50] batch [220/319] time 0.081 (0.086) data 0.000 (0.003) loss 1.7774 (1.7968) ce_loss 1.7334 (1.5186) teacher_loss 1.1503 (1.1885) loss_zs_kd 0.1898 (0.1976) loss_oracle 0.5322 (0.5095) acc 34.3750 (43.5653) kd_loss 0.8164 (0.8293) lr 1.9980e-03 eta 0:21:43
epoch [3/50] batch [240/319] time 0.085 (0.086) data 0.000 (0.003) loss 2.1683 (1.7944) ce_loss 1.8613 (1.5144) teacher_loss 1.4474 (1.1808) loss_zs_kd 0.2815 (0.2022) loss_oracle 0.5802 (0.5126) acc 31.2500 (43.7370) kd_loss 0.7472 (0.8277) lr 1.9980e-03 eta 0:21:37
epoch [3/50] batch [260/319] time 0.087 (0.086) data 0.000 (0.002) loss 1.7135 (1.7965) ce_loss 1.5830 (1.5160) teacher_loss 1.0980 (1.1799) loss_zs_kd 0.2687 (0.2062) loss_oracle 0.4812 (0.5135) acc 40.6250 (43.6899) kd_loss 0.7684 (0.8252) lr 1.9980e-03 eta 0:21:34
epoch [3/50] batch [280/319] time 0.094 (0.086) data 0.000 (0.002) loss 1.7343 (1.7922) ce_loss 1.5176 (1.5100) teacher_loss 1.0649 (1.1717) loss_zs_kd 0.2674 (0.2100) loss_oracle 0.5356 (0.5154) acc 50.0000 (43.8504) kd_loss 0.7714 (0.8240) lr 1.9980e-03 eta 0:21:36
epoch [3/50] batch [300/319] time 0.078 (0.086) data 0.000 (0.002) loss 1.5618 (1.7914) ce_loss 1.2930 (1.5083) teacher_loss 0.8749 (1.1686) loss_zs_kd 0.2262 (0.2135) loss_oracle 0.5739 (0.5161) acc 53.1250 (43.9062) kd_loss 0.8389 (0.8228) lr 1.9980e-03 eta 0:21:35
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 1,967
* accuracy: 44.9%
* error: 55.1%
* macro_f1: 34.2%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,342
* accuracy: 34.3%
* error: 65.7%
* macro_f1: 16.3%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      44.9%, epoch: 3 *******
******* Domain 2 best val test acc: 34.3%, epoch: 3 *******
******* Domain 2 best test acc:     34.3%, epoch: 3 *******
epoch [4/50] batch [20/319] time 0.093 (0.117) data 0.000 (0.030) loss 1.7322 (1.6964) ce_loss 1.5508 (1.4496) teacher_loss 1.1151 (1.0635) loss_zs_kd 0.3032 (0.2800) loss_oracle 0.4656 (0.4929) acc 50.0000 (45.1562) kd_loss 0.7632 (0.7854) lr 1.9921e-03 eta 0:29:12
epoch [4/50] batch [40/319] time 0.081 (0.099) data 0.000 (0.015) loss 1.5914 (1.6943) ce_loss 1.2803 (1.4268) teacher_loss 1.0122 (1.0556) loss_zs_kd 0.2906 (0.2873) loss_oracle 0.4339 (0.4951) acc 43.7500 (44.9219) kd_loss 0.7813 (0.7911) lr 1.9921e-03 eta 0:24:41
epoch [4/50] batch [60/319] time 0.083 (0.094) data 0.000 (0.010) loss 2.0385 (1.6817) ce_loss 1.5469 (1.4033) teacher_loss 1.2449 (1.0429) loss_zs_kd 0.3098 (0.2875) loss_oracle 0.6387 (0.4950) acc 56.2500 (46.3542) kd_loss 0.8718 (0.7930) lr 1.9921e-03 eta 0:23:22
epoch [4/50] batch [80/319] time 0.075 (0.091) data 0.000 (0.008) loss 1.6530 (1.6927) ce_loss 1.3994 (1.4147) teacher_loss 1.0345 (1.0465) loss_zs_kd 0.3112 (0.2986) loss_oracle 0.4628 (0.4970) acc 53.1250 (45.8984) kd_loss 0.7384 (0.7931) lr 1.9921e-03 eta 0:22:40
epoch [4/50] batch [100/319] time 0.086 (0.089) data 0.000 (0.006) loss 1.5977 (1.6952) ce_loss 1.2402 (1.4169) teacher_loss 0.9659 (1.0501) loss_zs_kd 0.3086 (0.3027) loss_oracle 0.4776 (0.4938) acc 56.2500 (45.8750) kd_loss 0.8292 (0.7914) lr 1.9921e-03 eta 0:22:03
epoch [4/50] batch [120/319] time 0.080 (0.088) data 0.000 (0.005) loss 1.7092 (1.6944) ce_loss 1.4248 (1.4245) teacher_loss 0.9801 (1.0494) loss_zs_kd 0.3708 (0.3073) loss_oracle 0.5437 (0.4914) acc 43.7500 (45.2865) kd_loss 0.8956 (0.7912) lr 1.9921e-03 eta 0:21:49
epoch [4/50] batch [140/319] time 0.086 (0.088) data 0.000 (0.004) loss 1.9880 (1.6966) ce_loss 1.6201 (1.4219) teacher_loss 1.3242 (1.0472) loss_zs_kd 0.3215 (0.3122) loss_oracle 0.5030 (0.4933) acc 40.6250 (45.6250) kd_loss 0.7912 (0.7952) lr 1.9921e-03 eta 0:21:39
epoch [4/50] batch [160/319] time 0.072 (0.087) data 0.000 (0.004) loss 2.2212 (1.6990) ce_loss 2.0781 (1.4216) teacher_loss 1.4829 (1.0429) loss_zs_kd 0.3365 (0.3154) loss_oracle 0.5701 (0.4985) acc 21.8750 (45.7227) kd_loss 0.7573 (0.7974) lr 1.9921e-03 eta 0:21:24
epoch [4/50] batch [180/319] time 0.079 (0.086) data 0.000 (0.004) loss 1.6916 (1.6996) ce_loss 1.4922 (1.4219) teacher_loss 1.0828 (1.0412) loss_zs_kd 0.2733 (0.3183) loss_oracle 0.4722 (0.4993) acc 46.8750 (45.4514) kd_loss 0.7698 (0.7976) lr 1.9921e-03 eta 0:21:11
epoch [4/50] batch [200/319] time 0.076 (0.085) data 0.000 (0.003) loss 1.7696 (1.7018) ce_loss 1.3965 (1.4172) teacher_loss 1.0163 (1.0391) loss_zs_kd 0.2994 (0.3186) loss_oracle 0.6037 (0.5034) acc 37.5000 (45.7969) kd_loss 0.7908 (0.7968) lr 1.9921e-03 eta 0:21:02
epoch [4/50] batch [220/319] time 0.076 (0.085) data 0.001 (0.003) loss 1.9056 (1.7045) ce_loss 1.4111 (1.4130) teacher_loss 1.2288 (1.0376) loss_zs_kd 0.3272 (0.3189) loss_oracle 0.5132 (0.5075) acc 53.1250 (45.9233) kd_loss 0.8103 (0.7964) lr 1.9921e-03 eta 0:20:49
epoch [4/50] batch [240/319] time 0.093 (0.085) data 0.000 (0.003) loss 1.8339 (1.7086) ce_loss 1.4746 (1.4129) teacher_loss 1.0723 (1.0392) loss_zs_kd 0.3216 (0.3180) loss_oracle 0.6008 (0.5105) acc 50.0000 (45.9245) kd_loss 0.8258 (0.7964) lr 1.9921e-03 eta 0:20:47
epoch [4/50] batch [260/319] time 0.078 (0.084) data 0.000 (0.003) loss 1.8619 (1.7136) ce_loss 1.5498 (1.4146) teacher_loss 1.1763 (1.0418) loss_zs_kd 0.3659 (0.3204) loss_oracle 0.5027 (0.5115) acc 31.2500 (45.8413) kd_loss 0.7795 (0.7961) lr 1.9921e-03 eta 0:20:42
epoch [4/50] batch [280/319] time 0.084 (0.084) data 0.000 (0.002) loss 1.6226 (1.7111) ce_loss 1.3447 (1.4066) teacher_loss 0.8567 (1.0350) loss_zs_kd 0.3429 (0.3201) loss_oracle 0.5944 (0.5160) acc 50.0000 (46.1049) kd_loss 0.8856 (0.7998) lr 1.9921e-03 eta 0:20:39
epoch [4/50] batch [300/319] time 0.085 (0.084) data 0.000 (0.002) loss 1.7712 (1.7107) ce_loss 1.3516 (1.4027) teacher_loss 1.0342 (1.0311) loss_zs_kd 0.3995 (0.3200) loss_oracle 0.5372 (0.5196) acc 50.0000 (46.3333) kd_loss 0.8047 (0.8028) lr 1.9921e-03 eta 0:20:37
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,075
* accuracy: 47.4%
* error: 52.6%
* macro_f1: 37.8%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,111
* accuracy: 42.2%
* error: 57.8%
* macro_f1: 17.2%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      47.4%, epoch: 4 *******
******* Domain 2 best val test acc: 42.2%, epoch: 4 *******
******* Domain 2 best test acc:     42.2%, epoch: 4 *******
epoch [5/50] batch [20/319] time 0.088 (0.120) data 0.000 (0.030) loss 1.6911 (1.7044) ce_loss 1.4824 (1.4012) teacher_loss 1.0521 (1.0296) loss_zs_kd 0.2505 (0.3190) loss_oracle 0.5137 (0.5154) acc 53.1250 (45.6250) kd_loss 0.8592 (0.8000) lr 1.9823e-03 eta 0:29:15
epoch [5/50] batch [40/319] time 0.097 (0.101) data 0.000 (0.015) loss 1.6302 (1.7223) ce_loss 1.1504 (1.3905) teacher_loss 0.8239 (1.0258) loss_zs_kd 0.4122 (0.3308) loss_oracle 0.6002 (0.5311) acc 59.3750 (46.0156) kd_loss 0.8031 (0.7954) lr 1.9823e-03 eta 0:24:35
epoch [5/50] batch [60/319] time 0.081 (0.094) data 0.000 (0.010) loss 1.5415 (1.7211) ce_loss 1.2578 (1.3962) teacher_loss 0.9240 (1.0218) loss_zs_kd 0.3834 (0.3365) loss_oracle 0.4258 (0.5311) acc 53.1250 (45.6771) kd_loss 0.7839 (0.7911) lr 1.9823e-03 eta 0:22:50
epoch [5/50] batch [80/319] time 0.078 (0.091) data 0.000 (0.008) loss 1.4499 (1.7077) ce_loss 1.0947 (1.3839) teacher_loss 0.7506 (1.0020) loss_zs_kd 0.2815 (0.3391) loss_oracle 0.5585 (0.5361) acc 56.2500 (46.5234) kd_loss 0.8358 (0.7989) lr 1.9823e-03 eta 0:22:03
epoch [5/50] batch [100/319] time 0.080 (0.089) data 0.000 (0.006) loss 1.8459 (1.6981) ce_loss 1.3857 (1.3803) teacher_loss 1.0555 (0.9873) loss_zs_kd 0.4310 (0.3473) loss_oracle 0.5749 (0.5371) acc 46.8750 (46.7812) kd_loss 0.8648 (0.8054) lr 1.9823e-03 eta 0:21:35
epoch [5/50] batch [120/319] time 0.071 (0.087) data 0.000 (0.005) loss 1.5342 (1.7006) ce_loss 1.3066 (1.3928) teacher_loss 0.8077 (0.9774) loss_zs_kd 0.3813 (0.3542) loss_oracle 0.5358 (0.5460) acc 40.6250 (46.1719) kd_loss 0.8478 (0.8159) lr 1.9823e-03 eta 0:21:02
epoch [5/50] batch [140/319] time 0.090 (0.086) data 0.000 (0.004) loss 1.8617 (1.6971) ce_loss 1.4854 (1.3956) teacher_loss 1.0954 (0.9630) loss_zs_kd 0.4165 (0.3628) loss_oracle 0.5581 (0.5527) acc 46.8750 (46.3393) kd_loss 0.8434 (0.8215) lr 1.9823e-03 eta 0:20:50
epoch [5/50] batch [160/319] time 0.080 (0.086) data 0.000 (0.004) loss 1.7835 (1.6938) ce_loss 1.4629 (1.3952) teacher_loss 1.0326 (0.9597) loss_zs_kd 0.4306 (0.3613) loss_oracle 0.5356 (0.5534) acc 46.8750 (46.4258) kd_loss 0.7918 (0.8222) lr 1.9823e-03 eta 0:20:48
epoch [5/50] batch [180/319] time 0.080 (0.086) data 0.000 (0.004) loss 1.4756 (1.6896) ce_loss 1.1123 (1.3905) teacher_loss 0.7037 (0.9569) loss_zs_kd 0.3399 (0.3593) loss_oracle 0.6020 (0.5531) acc 56.2500 (46.7014) kd_loss 0.8651 (0.8209) lr 1.9823e-03 eta 0:20:46
epoch [5/50] batch [200/319] time 0.081 (0.086) data 0.000 (0.003) loss 1.6812 (1.6877) ce_loss 1.3311 (1.3889) teacher_loss 1.0196 (0.9587) loss_zs_kd 0.3636 (0.3556) loss_oracle 0.4797 (0.5512) acc 62.5000 (46.9531) kd_loss 0.7759 (0.8190) lr 1.9823e-03 eta 0:20:43
epoch [5/50] batch [220/319] time 0.081 (0.086) data 0.000 (0.003) loss 1.4266 (1.6873) ce_loss 1.2021 (1.3903) teacher_loss 0.8092 (0.9621) loss_zs_kd 0.2505 (0.3534) loss_oracle 0.4922 (0.5484) acc 50.0000 (46.9176) kd_loss 0.7637 (0.8163) lr 1.9823e-03 eta 0:20:39
epoch [5/50] batch [240/319] time 0.089 (0.086) data 0.000 (0.003) loss 1.4496 (1.6888) ce_loss 1.2070 (1.3966) teacher_loss 0.7174 (0.9656) loss_zs_kd 0.3418 (0.3509) loss_oracle 0.5613 (0.5478) acc 50.0000 (46.6536) kd_loss 0.7580 (0.8154) lr 1.9823e-03 eta 0:20:36
epoch [5/50] batch [260/319] time 0.080 (0.086) data 0.000 (0.003) loss 1.7685 (1.6903) ce_loss 1.5225 (1.4000) teacher_loss 1.0799 (0.9679) loss_zs_kd 0.3322 (0.3504) loss_oracle 0.5225 (0.5473) acc 40.6250 (46.5865) kd_loss 0.7840 (0.8133) lr 1.9823e-03 eta 0:20:33
epoch [5/50] batch [280/319] time 0.077 (0.085) data 0.000 (0.002) loss 1.2766 (1.6875) ce_loss 1.0938 (1.3975) teacher_loss 0.5918 (0.9678) loss_zs_kd 0.2137 (0.3483) loss_oracle 0.5779 (0.5455) acc 53.1250 (46.7076) kd_loss 0.7996 (0.8102) lr 1.9823e-03 eta 0:20:28
epoch [5/50] batch [300/319] time 0.076 (0.085) data 0.000 (0.002) loss 1.6663 (1.6887) ce_loss 1.2900 (1.3991) teacher_loss 1.1274 (0.9709) loss_zs_kd 0.2714 (0.3472) loss_oracle 0.4032 (0.5442) acc 34.3750 (46.7083) kd_loss 0.6556 (0.8065) lr 1.9823e-03 eta 0:20:20
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,126
* accuracy: 48.6%
* error: 51.4%
* macro_f1: 38.1%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,705
* accuracy: 38.1%
* error: 61.9%
* macro_f1: 18.4%
******* Domain 2 best val acc:      48.6%, epoch: 5 *******
******* Domain 2 best val test acc: 38.1%, epoch: 5 *******
******* Domain 2 best test acc:     42.2%, epoch: 4 *******
epoch [6/50] batch [20/319] time 0.087 (0.115) data 0.000 (0.029) loss 1.9739 (1.6858) ce_loss 1.6836 (1.3562) teacher_loss 1.3585 (1.0832) loss_zs_kd 0.2473 (0.2455) loss_oracle 0.4918 (0.4799) acc 31.2500 (49.3750) kd_loss 0.6328 (0.6806) lr 1.9686e-03 eta 0:27:24
epoch [6/50] batch [40/319] time 0.079 (0.100) data 0.000 (0.015) loss 1.7724 (1.6732) ce_loss 1.4658 (1.3329) teacher_loss 1.1365 (1.0731) loss_zs_kd 0.2539 (0.2449) loss_oracle 0.5089 (0.4777) acc 46.8750 (49.6875) kd_loss 0.6555 (0.6683) lr 1.9686e-03 eta 0:23:45
epoch [6/50] batch [60/319] time 0.081 (0.094) data 0.000 (0.010) loss 1.7756 (1.6910) ce_loss 1.4434 (1.3425) teacher_loss 1.2476 (1.0995) loss_zs_kd 0.2242 (0.2408) loss_oracle 0.4159 (0.4711) acc 37.5000 (49.4271) kd_loss 0.6727 (0.6664) lr 1.9686e-03 eta 0:22:29
epoch [6/50] batch [80/319] time 0.077 (0.090) data 0.001 (0.007) loss 1.8197 (1.6953) ce_loss 1.4033 (1.3482) teacher_loss 1.2691 (1.1118) loss_zs_kd 0.2271 (0.2364) loss_oracle 0.4370 (0.4653) acc 50.0000 (48.6719) kd_loss 0.6428 (0.6625) lr 1.9686e-03 eta 0:21:27
epoch [6/50] batch [100/319] time 0.085 (0.089) data 0.001 (0.006) loss 1.6110 (1.7119) ce_loss 1.2324 (1.3706) teacher_loss 1.0282 (1.1351) loss_zs_kd 0.2028 (0.2285) loss_oracle 0.4814 (0.4626) acc 59.3750 (47.8125) kd_loss 0.6784 (0.6618) lr 1.9686e-03 eta 0:21:04
epoch [6/50] batch [120/319] time 0.083 (0.087) data 0.000 (0.005) loss 1.7957 (1.7044) ce_loss 1.3652 (1.3689) teacher_loss 1.2256 (1.1337) loss_zs_kd 0.2506 (0.2264) loss_oracle 0.4447 (0.4576) acc 53.1250 (47.8646) kd_loss 0.6167 (0.6580) lr 1.9686e-03 eta 0:20:43
epoch [6/50] batch [140/319] time 0.079 (0.086) data 0.000 (0.004) loss 1.7624 (1.7016) ce_loss 1.3896 (1.3653) teacher_loss 1.2374 (1.1309) loss_zs_kd 0.2132 (0.2243) loss_oracle 0.4184 (0.4586) acc 46.8750 (48.3705) kd_loss 0.6421 (0.6570) lr 1.9686e-03 eta 0:20:29
epoch [6/50] batch [160/319] time 0.081 (0.086) data 0.000 (0.004) loss 1.4767 (1.7038) ce_loss 1.2324 (1.3651) teacher_loss 0.9778 (1.1334) loss_zs_kd 0.1558 (0.2242) loss_oracle 0.4210 (0.4582) acc 53.1250 (48.4180) kd_loss 0.6475 (0.6536) lr 1.9686e-03 eta 0:20:20
epoch [6/50] batch [180/319] time 0.082 (0.086) data 0.000 (0.003) loss 1.8219 (1.7046) ce_loss 1.4717 (1.3702) teacher_loss 1.3336 (1.1380) loss_zs_kd 0.2257 (0.2235) loss_oracle 0.3755 (0.4549) acc 50.0000 (48.2292) kd_loss 0.5913 (0.6527) lr 1.9686e-03 eta 0:20:16
epoch [6/50] batch [200/319] time 0.078 (0.086) data 0.000 (0.003) loss 1.5301 (1.6973) ce_loss 1.2422 (1.3654) teacher_loss 0.9964 (1.1364) loss_zs_kd 0.2135 (0.2213) loss_oracle 0.4270 (0.4502) acc 53.1250 (48.5781) kd_loss 0.6535 (0.6504) lr 1.9686e-03 eta 0:20:12
epoch [6/50] batch [220/319] time 0.094 (0.086) data 0.000 (0.003) loss 1.6294 (1.6920) ce_loss 1.2686 (1.3645) teacher_loss 1.1407 (1.1335) loss_zs_kd 0.2199 (0.2217) loss_oracle 0.3787 (0.4476) acc 53.1250 (48.4375) kd_loss 0.5870 (0.6503) lr 1.9686e-03 eta 0:20:10
epoch [6/50] batch [240/319] time 0.090 (0.086) data 0.000 (0.003) loss 1.8080 (1.6895) ce_loss 1.5176 (1.3684) teacher_loss 1.3137 (1.1360) loss_zs_kd 0.2489 (0.2219) loss_oracle 0.3699 (0.4426) acc 50.0000 (48.3203) kd_loss 0.6212 (0.6493) lr 1.9686e-03 eta 0:20:06
epoch [6/50] batch [260/319] time 0.075 (0.085) data 0.000 (0.002) loss 1.5243 (1.6871) ce_loss 1.2070 (1.3700) teacher_loss 0.9904 (1.1353) loss_zs_kd 0.2482 (0.2243) loss_oracle 0.4098 (0.4396) acc 50.0000 (48.1490) kd_loss 0.6656 (0.6490) lr 1.9686e-03 eta 0:20:00
epoch [6/50] batch [280/319] time 0.077 (0.085) data 0.000 (0.002) loss 1.5580 (1.6834) ce_loss 1.2764 (1.3680) teacher_loss 1.0212 (1.1309) loss_zs_kd 0.2311 (0.2282) loss_oracle 0.4213 (0.4384) acc 53.1250 (48.1473) kd_loss 0.7265 (0.6518) lr 1.9686e-03 eta 0:19:49
epoch [6/50] batch [300/319] time 0.075 (0.084) data 0.000 (0.002) loss 1.6258 (1.6816) ce_loss 1.4404 (1.3677) teacher_loss 1.0534 (1.1304) loss_zs_kd 0.2819 (0.2295) loss_oracle 0.4314 (0.4365) acc 46.8750 (48.2396) kd_loss 0.7652 (0.6540) lr 1.9686e-03 eta 0:19:39
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,236
* accuracy: 51.1%
* error: 48.9%
* macro_f1: 41.2%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,233
* accuracy: 43.5%
* error: 56.5%
* macro_f1: 17.6%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     43.5%, epoch: 6 *******
epoch [7/50] batch [20/319] time 0.078 (0.138) data 0.000 (0.045) loss 1.3933 (1.5755) ce_loss 1.0332 (1.2719) teacher_loss 0.7870 (1.0079) loss_zs_kd 0.3078 (0.3045) loss_oracle 0.4524 (0.4154) acc 59.3750 (51.5625) kd_loss 0.7606 (0.7525) lr 1.9511e-03 eta 0:32:16
epoch [7/50] batch [40/319] time 0.091 (0.110) data 0.000 (0.023) loss 1.8547 (1.5998) ce_loss 1.6074 (1.3084) teacher_loss 1.2523 (1.0184) loss_zs_kd 0.3373 (0.3178) loss_oracle 0.4338 (0.4226) acc 46.8750 (49.9219) kd_loss 0.8911 (0.7806) lr 1.9511e-03 eta 0:25:37
epoch [7/50] batch [60/319] time 0.077 (0.101) data 0.001 (0.015) loss 1.6340 (1.5804) ce_loss 1.3057 (1.2983) teacher_loss 1.0543 (0.9954) loss_zs_kd 0.3131 (0.3195) loss_oracle 0.4231 (0.4252) acc 53.1250 (50.9375) kd_loss 0.9324 (0.8093) lr 1.9511e-03 eta 0:23:28
epoch [7/50] batch [80/319] time 0.083 (0.096) data 0.000 (0.012) loss 1.5120 (1.5811) ce_loss 1.1484 (1.3166) teacher_loss 0.9555 (0.9906) loss_zs_kd 0.3589 (0.3259) loss_oracle 0.3770 (0.4275) acc 59.3750 (50.5859) kd_loss 0.7479 (0.8246) lr 1.9511e-03 eta 0:22:20
epoch [7/50] batch [100/319] time 0.083 (0.094) data 0.000 (0.009) loss 1.4437 (1.5824) ce_loss 1.3730 (1.3371) teacher_loss 0.8246 (0.9890) loss_zs_kd 0.3863 (0.3304) loss_oracle 0.4259 (0.4282) acc 50.0000 (49.7500) kd_loss 0.8914 (0.8264) lr 1.9511e-03 eta 0:21:53
epoch [7/50] batch [120/319] time 0.079 (0.092) data 0.000 (0.008) loss 1.7691 (1.5805) ce_loss 1.7656 (1.3428) teacher_loss 1.1136 (0.9798) loss_zs_kd 0.3498 (0.3385) loss_oracle 0.4806 (0.4315) acc 43.7500 (49.7135) kd_loss 0.8548 (0.8308) lr 1.9511e-03 eta 0:21:22
epoch [7/50] batch [140/319] time 0.072 (0.090) data 0.000 (0.007) loss 1.5194 (1.5757) ce_loss 1.2949 (1.3505) teacher_loss 0.8525 (0.9661) loss_zs_kd 0.3373 (0.3438) loss_oracle 0.4983 (0.4377) acc 46.8750 (49.3304) kd_loss 0.9153 (0.8398) lr 1.9511e-03 eta 0:20:55
epoch [7/50] batch [160/319] time 0.089 (0.089) data 0.000 (0.006) loss 1.4298 (1.5747) ce_loss 1.1826 (1.3513) teacher_loss 0.7803 (0.9587) loss_zs_kd 0.3240 (0.3462) loss_oracle 0.4875 (0.4429) acc 43.7500 (49.2383) kd_loss 0.8283 (0.8441) lr 1.9511e-03 eta 0:20:31
epoch [7/50] batch [180/319] time 0.075 (0.088) data 0.000 (0.005) loss 1.5679 (1.5794) ce_loss 1.4229 (1.3613) teacher_loss 0.9070 (0.9572) loss_zs_kd 0.3829 (0.3485) loss_oracle 0.4694 (0.4480) acc 46.8750 (48.9062) kd_loss 0.8958 (0.8497) lr 1.9511e-03 eta 0:20:15
epoch [7/50] batch [200/319] time 0.084 (0.087) data 0.000 (0.005) loss 1.9207 (1.5741) ce_loss 1.6035 (1.3582) teacher_loss 1.2351 (0.9493) loss_zs_kd 0.4441 (0.3498) loss_oracle 0.4635 (0.4499) acc 46.8750 (48.9375) kd_loss 0.7902 (0.8522) lr 1.9511e-03 eta 0:19:57
epoch [7/50] batch [220/319] time 0.066 (0.085) data 0.000 (0.004) loss 1.6940 (1.5684) ce_loss 1.3564 (1.3514) teacher_loss 0.9729 (0.9371) loss_zs_kd 0.3462 (0.3513) loss_oracle 0.5480 (0.4557) acc 43.7500 (49.2614) kd_loss 0.9336 (0.8590) lr 1.9511e-03 eta 0:19:38
epoch [7/50] batch [240/319] time 0.067 (0.084) data 0.000 (0.004) loss 1.6491 (1.5704) ce_loss 1.5254 (1.3538) teacher_loss 0.9782 (0.9328) loss_zs_kd 0.3660 (0.3537) loss_oracle 0.4879 (0.4608) acc 46.8750 (49.2188) kd_loss 0.8613 (0.8650) lr 1.9511e-03 eta 0:19:12
epoch [7/50] batch [260/319] time 0.092 (0.083) data 0.000 (0.004) loss 1.5492 (1.5764) ce_loss 1.3486 (1.3604) teacher_loss 0.8972 (0.9373) loss_zs_kd 0.3015 (0.3518) loss_oracle 0.5013 (0.4632) acc 56.2500 (49.1827) kd_loss 0.9789 (0.8715) lr 1.9511e-03 eta 0:19:01
epoch [7/50] batch [280/319] time 0.079 (0.083) data 0.000 (0.003) loss 1.5556 (1.5787) ce_loss 1.3604 (1.3609) teacher_loss 0.9297 (0.9388) loss_zs_kd 0.3089 (0.3502) loss_oracle 0.4715 (0.4648) acc 68.7500 (49.1518) kd_loss 1.0111 (0.8765) lr 1.9511e-03 eta 0:18:59
epoch [7/50] batch [300/319] time 0.061 (0.083) data 0.000 (0.003) loss 1.6472 (1.5817) ce_loss 1.7441 (1.3621) teacher_loss 0.9761 (0.9401) loss_zs_kd 0.3575 (0.3486) loss_oracle 0.4924 (0.4673) acc 25.0000 (49.0625) kd_loss 0.8815 (0.8809) lr 1.9511e-03 eta 0:18:57
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,155
* accuracy: 49.2%
* error: 50.8%
* macro_f1: 38.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,860
* accuracy: 39.6%
* error: 60.4%
* macro_f1: 15.5%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     43.5%, epoch: 6 *******
epoch [8/50] batch [20/319] time 0.067 (0.103) data 0.000 (0.031) loss 1.9459 (1.6720) ce_loss 1.6113 (1.4613) teacher_loss 1.3133 (1.0161) loss_zs_kd 0.3185 (0.3152) loss_oracle 0.4733 (0.4983) acc 37.5000 (44.3750) kd_loss 0.9577 (0.9637) lr 1.9298e-03 eta 0:23:36
epoch [8/50] batch [40/319] time 0.063 (0.084) data 0.000 (0.016) loss 1.3497 (1.6350) ce_loss 1.2764 (1.4309) teacher_loss 0.6312 (0.9684) loss_zs_kd 0.3249 (0.3251) loss_oracle 0.5561 (0.5041) acc 46.8750 (46.9531) kd_loss 0.8533 (0.9590) lr 1.9298e-03 eta 0:19:11
epoch [8/50] batch [60/319] time 0.074 (0.078) data 0.001 (0.011) loss 1.6564 (1.6070) ce_loss 1.4219 (1.4032) teacher_loss 0.9808 (0.9437) loss_zs_kd 0.3471 (0.3285) loss_oracle 0.5020 (0.4990) acc 40.6250 (47.8646) kd_loss 0.9158 (0.9498) lr 1.9298e-03 eta 0:17:42
epoch [8/50] batch [80/319] time 0.081 (0.079) data 0.000 (0.008) loss 1.6533 (1.5869) ce_loss 1.3984 (1.3890) teacher_loss 1.0204 (0.9263) loss_zs_kd 0.2931 (0.3249) loss_oracle 0.4864 (0.4981) acc 46.8750 (48.1250) kd_loss 0.8728 (0.9364) lr 1.9298e-03 eta 0:17:59
epoch [8/50] batch [100/319] time 0.079 (0.080) data 0.000 (0.006) loss 1.3827 (1.5921) ce_loss 1.3125 (1.4027) teacher_loss 0.8163 (0.9349) loss_zs_kd 0.3592 (0.3259) loss_oracle 0.3869 (0.4942) acc 53.1250 (47.7500) kd_loss 0.8432 (0.9311) lr 1.9298e-03 eta 0:18:06
epoch [8/50] batch [120/319] time 0.085 (0.080) data 0.000 (0.005) loss 1.7689 (1.5836) ce_loss 1.6543 (1.3953) teacher_loss 1.0471 (0.9246) loss_zs_kd 0.4260 (0.3295) loss_oracle 0.5088 (0.4943) acc 34.3750 (47.8906) kd_loss 0.8598 (0.9226) lr 1.9298e-03 eta 0:18:08
epoch [8/50] batch [140/319] time 0.067 (0.080) data 0.000 (0.005) loss 1.5828 (1.5876) ce_loss 1.6191 (1.3968) teacher_loss 0.8913 (0.9293) loss_zs_kd 0.3536 (0.3307) loss_oracle 0.5147 (0.4929) acc 37.5000 (47.9688) kd_loss 0.9405 (0.9133) lr 1.9298e-03 eta 0:18:04
epoch [8/50] batch [160/319] time 0.069 (0.079) data 0.000 (0.004) loss 1.7015 (1.5892) ce_loss 1.5332 (1.4008) teacher_loss 0.9536 (0.9335) loss_zs_kd 0.3576 (0.3297) loss_oracle 0.5691 (0.4909) acc 34.3750 (47.9102) kd_loss 0.9965 (0.9097) lr 1.9298e-03 eta 0:17:45
epoch [8/50] batch [180/319] time 0.079 (0.078) data 0.000 (0.004) loss 1.6373 (1.5956) ce_loss 1.5010 (1.4042) teacher_loss 1.0688 (0.9422) loss_zs_kd 0.3088 (0.3307) loss_oracle 0.4141 (0.4881) acc 50.0000 (47.7604) kd_loss 0.8846 (0.9094) lr 1.9298e-03 eta 0:17:31
epoch [8/50] batch [200/319] time 0.088 (0.078) data 0.000 (0.003) loss 1.6074 (1.5880) ce_loss 1.5566 (1.3989) teacher_loss 0.9338 (0.9386) loss_zs_kd 0.3855 (0.3276) loss_oracle 0.4809 (0.4856) acc 37.5000 (47.6719) kd_loss 0.8450 (0.9072) lr 1.9298e-03 eta 0:17:39
epoch [8/50] batch [220/319] time 0.085 (0.079) data 0.000 (0.003) loss 1.4421 (1.5898) ce_loss 1.1582 (1.3993) teacher_loss 0.7280 (0.9401) loss_zs_kd 0.3306 (0.3285) loss_oracle 0.5488 (0.4854) acc 62.5000 (47.7415) kd_loss 0.9462 (0.9029) lr 1.9298e-03 eta 0:17:45
epoch [8/50] batch [240/319] time 0.085 (0.080) data 0.000 (0.003) loss 1.7073 (1.5858) ce_loss 1.5381 (1.3944) teacher_loss 1.0302 (0.9381) loss_zs_kd 0.3015 (0.3275) loss_oracle 0.5264 (0.4839) acc 40.6250 (47.9167) kd_loss 0.9052 (0.8985) lr 1.9298e-03 eta 0:17:52
epoch [8/50] batch [260/319] time 0.078 (0.080) data 0.000 (0.003) loss 1.8813 (1.5850) ce_loss 1.6064 (1.3934) teacher_loss 1.1773 (0.9372) loss_zs_kd 0.4027 (0.3285) loss_oracle 0.5026 (0.4835) acc 37.5000 (48.0168) kd_loss 0.8652 (0.8965) lr 1.9298e-03 eta 0:17:53
epoch [8/50] batch [280/319] time 0.083 (0.080) data 0.000 (0.002) loss 1.6236 (1.5813) ce_loss 1.4102 (1.3881) teacher_loss 1.0346 (0.9347) loss_zs_kd 0.2660 (0.3288) loss_oracle 0.4560 (0.4822) acc 40.6250 (48.0357) kd_loss 0.7124 (0.8921) lr 1.9298e-03 eta 0:17:54
epoch [8/50] batch [300/319] time 0.077 (0.080) data 0.000 (0.002) loss 1.7020 (1.5855) ce_loss 1.5967 (1.3947) teacher_loss 1.0030 (0.9391) loss_zs_kd 0.3013 (0.3292) loss_oracle 0.5483 (0.4818) acc 37.5000 (47.8646) kd_loss 0.8516 (0.8895) lr 1.9298e-03 eta 0:17:56
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,128
* accuracy: 48.6%
* error: 51.4%
* macro_f1: 36.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,829
* accuracy: 39.3%
* error: 60.7%
* macro_f1: 16.0%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     43.5%, epoch: 6 *******
epoch [9/50] batch [20/319] time 0.063 (0.096) data 0.000 (0.026) loss 1.5188 (1.5566) ce_loss 1.2627 (1.3529) teacher_loss 0.9657 (0.9373) loss_zs_kd 0.2978 (0.3306) loss_oracle 0.4042 (0.4540) acc 50.0000 (47.6562) kd_loss 0.7268 (0.8161) lr 1.9048e-03 eta 0:21:18
epoch [9/50] batch [40/319] time 0.074 (0.081) data 0.000 (0.013) loss 1.6077 (1.5443) ce_loss 1.1768 (1.3375) teacher_loss 0.9908 (0.9211) loss_zs_kd 0.3447 (0.3242) loss_oracle 0.4445 (0.4611) acc 56.2500 (49.3750) kd_loss 0.7081 (0.8034) lr 1.9048e-03 eta 0:18:00
epoch [9/50] batch [60/319] time 0.086 (0.081) data 0.000 (0.009) loss 1.5926 (1.5563) ce_loss 1.4756 (1.3674) teacher_loss 1.0258 (0.9314) loss_zs_kd 0.3683 (0.3262) loss_oracle 0.3826 (0.4618) acc 43.7500 (48.3333) kd_loss 0.8202 (0.8054) lr 1.9048e-03 eta 0:18:05
epoch [9/50] batch [80/319] time 0.081 (0.083) data 0.000 (0.007) loss 1.6628 (1.5696) ce_loss 1.2656 (1.3817) teacher_loss 1.0921 (0.9438) loss_zs_kd 0.2978 (0.3268) loss_oracle 0.4217 (0.4625) acc 59.3750 (48.0078) kd_loss 0.8071 (0.8030) lr 1.9048e-03 eta 0:18:19
epoch [9/50] batch [100/319] time 0.075 (0.083) data 0.000 (0.005) loss 1.6801 (1.5679) ce_loss 1.5654 (1.3785) teacher_loss 1.0442 (0.9412) loss_zs_kd 0.2959 (0.3239) loss_oracle 0.4879 (0.4647) acc 46.8750 (48.5938) kd_loss 0.7636 (0.7990) lr 1.9048e-03 eta 0:18:17
epoch [9/50] batch [120/319] time 0.080 (0.083) data 0.000 (0.005) loss 1.5789 (1.5743) ce_loss 1.6191 (1.3938) teacher_loss 0.8347 (0.9449) loss_zs_kd 0.3023 (0.3243) loss_oracle 0.5931 (0.4672) acc 40.6250 (48.0729) kd_loss 0.9162 (0.8007) lr 1.9048e-03 eta 0:18:17
epoch [9/50] batch [140/319] time 0.092 (0.082) data 0.000 (0.004) loss 1.8872 (1.5813) ce_loss 1.7373 (1.4038) teacher_loss 1.2845 (0.9477) loss_zs_kd 0.3668 (0.3269) loss_oracle 0.4192 (0.4701) acc 34.3750 (47.7232) kd_loss 0.7954 (0.8011) lr 1.9048e-03 eta 0:18:11
epoch [9/50] batch [160/319] time 0.083 (0.083) data 0.000 (0.004) loss 1.5799 (1.5760) ce_loss 1.5332 (1.3986) teacher_loss 0.8666 (0.9394) loss_zs_kd 0.3551 (0.3321) loss_oracle 0.5358 (0.4705) acc 43.7500 (48.0078) kd_loss 0.8866 (0.8034) lr 1.9048e-03 eta 0:18:12
epoch [9/50] batch [180/319] time 0.080 (0.083) data 0.000 (0.003) loss 1.5578 (1.5711) ce_loss 1.4941 (1.3958) teacher_loss 0.9948 (0.9344) loss_zs_kd 0.3845 (0.3351) loss_oracle 0.3707 (0.4692) acc 46.8750 (47.9861) kd_loss 0.8143 (0.8055) lr 1.9048e-03 eta 0:18:12
epoch [9/50] batch [200/319] time 0.081 (0.082) data 0.000 (0.003) loss 1.4835 (1.5699) ce_loss 1.3076 (1.3948) teacher_loss 0.9029 (0.9339) loss_zs_kd 0.2827 (0.3359) loss_oracle 0.4392 (0.4680) acc 46.8750 (48.1406) kd_loss 0.7992 (0.8053) lr 1.9048e-03 eta 0:18:04
epoch [9/50] batch [220/319] time 0.085 (0.082) data 0.001 (0.003) loss 1.4448 (1.5676) ce_loss 1.1016 (1.3927) teacher_loss 0.9060 (0.9307) loss_zs_kd 0.3041 (0.3361) loss_oracle 0.3868 (0.4689) acc 56.2500 (48.2955) kd_loss 0.8068 (0.8052) lr 1.9048e-03 eta 0:18:03
epoch [9/50] batch [240/319] time 0.070 (0.082) data 0.000 (0.002) loss 1.6681 (1.5644) ce_loss 1.3623 (1.3872) teacher_loss 0.9285 (0.9262) loss_zs_kd 0.3897 (0.3359) loss_oracle 0.5448 (0.4702) acc 50.0000 (48.4766) kd_loss 0.8465 (0.8044) lr 1.9048e-03 eta 0:18:00
epoch [9/50] batch [260/319] time 0.079 (0.082) data 0.000 (0.002) loss 1.6976 (1.5622) ce_loss 1.4141 (1.3864) teacher_loss 1.0529 (0.9232) loss_zs_kd 0.3541 (0.3369) loss_oracle 0.4676 (0.4705) acc 50.0000 (48.4856) kd_loss 0.8721 (0.8058) lr 1.9048e-03 eta 0:17:54
epoch [9/50] batch [280/319] time 0.089 (0.082) data 0.000 (0.002) loss 1.4237 (1.5656) ce_loss 1.2227 (1.3931) teacher_loss 0.7978 (0.9265) loss_zs_kd 0.3861 (0.3385) loss_oracle 0.4329 (0.4699) acc 53.1250 (48.3929) kd_loss 0.8711 (0.8104) lr 1.9048e-03 eta 0:17:54
epoch [9/50] batch [300/319] time 0.077 (0.082) data 0.000 (0.002) loss 1.6929 (1.5634) ce_loss 1.7168 (1.3937) teacher_loss 0.9911 (0.9230) loss_zs_kd 0.3589 (0.3399) loss_oracle 0.5223 (0.4704) acc 43.7500 (48.3333) kd_loss 0.8884 (0.8143) lr 1.9048e-03 eta 0:17:55
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,219
* accuracy: 50.7%
* error: 49.3%
* macro_f1: 38.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,086
* accuracy: 42.0%
* error: 58.0%
* macro_f1: 16.1%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     43.5%, epoch: 6 *******
epoch [10/50] batch [20/319] time 0.075 (0.115) data 0.000 (0.033) loss 1.6826 (1.5220) ce_loss 1.6787 (1.4068) teacher_loss 0.9808 (0.8737) loss_zs_kd 0.4068 (0.3773) loss_oracle 0.4984 (0.4597) acc 37.5000 (47.1875) kd_loss 1.0316 (0.8959) lr 1.8763e-03 eta 0:25:06
epoch [10/50] batch [40/319] time 0.089 (0.096) data 0.000 (0.017) loss 1.5550 (1.5323) ce_loss 1.4912 (1.4033) teacher_loss 0.9626 (0.8789) loss_zs_kd 0.3412 (0.3729) loss_oracle 0.4218 (0.4669) acc 46.8750 (47.1094) kd_loss 0.9584 (0.9189) lr 1.8763e-03 eta 0:20:56
epoch [10/50] batch [60/319] time 0.095 (0.093) data 0.000 (0.011) loss 1.6251 (1.5278) ce_loss 1.6260 (1.3901) teacher_loss 0.9521 (0.8677) loss_zs_kd 0.3737 (0.3718) loss_oracle 0.4861 (0.4742) acc 46.8750 (48.0208) kd_loss 0.8999 (0.9232) lr 1.8763e-03 eta 0:20:04
epoch [10/50] batch [80/319] time 0.086 (0.089) data 0.000 (0.008) loss 1.3942 (1.5217) ce_loss 1.0898 (1.3797) teacher_loss 0.7534 (0.8675) loss_zs_kd 0.3377 (0.3691) loss_oracle 0.4720 (0.4695) acc 68.7500 (48.6328) kd_loss 0.9689 (0.9230) lr 1.8763e-03 eta 0:19:19
epoch [10/50] batch [100/319] time 0.080 (0.088) data 0.000 (0.007) loss 1.3382 (1.5313) ce_loss 0.9951 (1.3888) teacher_loss 0.6971 (0.8735) loss_zs_kd 0.3506 (0.3706) loss_oracle 0.4659 (0.4725) acc 65.6250 (48.2500) kd_loss 0.9770 (0.9298) lr 1.8763e-03 eta 0:19:06
epoch [10/50] batch [120/319] time 0.079 (0.087) data 0.000 (0.006) loss 1.4758 (1.5277) ce_loss 1.2881 (1.3862) teacher_loss 0.7889 (0.8664) loss_zs_kd 0.4162 (0.3770) loss_oracle 0.4788 (0.4727) acc 50.0000 (48.3333) kd_loss 0.9893 (0.9354) lr 1.8763e-03 eta 0:18:51
epoch [10/50] batch [140/319] time 0.079 (0.087) data 0.000 (0.005) loss 1.3796 (1.5210) ce_loss 1.2783 (1.3738) teacher_loss 0.6668 (0.8522) loss_zs_kd 0.4401 (0.3818) loss_oracle 0.4927 (0.4778) acc 46.8750 (48.8393) kd_loss 0.8979 (0.9455) lr 1.8763e-03 eta 0:18:40
epoch [10/50] batch [160/319] time 0.085 (0.086) data 0.000 (0.004) loss 1.6406 (1.5147) ce_loss 1.5830 (1.3667) teacher_loss 0.9558 (0.8450) loss_zs_kd 0.3885 (0.3824) loss_oracle 0.4905 (0.4786) acc 34.3750 (49.1211) kd_loss 1.0084 (0.9495) lr 1.8763e-03 eta 0:18:34
epoch [10/50] batch [180/319] time 0.079 (0.086) data 0.000 (0.004) loss 1.4614 (1.5213) ce_loss 1.1875 (1.3738) teacher_loss 0.9108 (0.8495) loss_zs_kd 0.3599 (0.3861) loss_oracle 0.3706 (0.4788) acc 53.1250 (48.9757) kd_loss 1.0362 (0.9545) lr 1.8763e-03 eta 0:18:29
epoch [10/50] batch [200/319] time 0.080 (0.086) data 0.000 (0.004) loss 1.2607 (1.5188) ce_loss 0.9243 (1.3726) teacher_loss 0.5565 (0.8442) loss_zs_kd 0.3969 (0.3874) loss_oracle 0.5058 (0.4809) acc 75.0000 (49.0938) kd_loss 1.0268 (0.9588) lr 1.8763e-03 eta 0:18:24
epoch [10/50] batch [220/319] time 0.077 (0.086) data 0.000 (0.003) loss 1.2735 (1.5220) ce_loss 1.2090 (1.3743) teacher_loss 0.6427 (0.8444) loss_zs_kd 0.3646 (0.3879) loss_oracle 0.4485 (0.4836) acc 43.7500 (48.8778) kd_loss 1.0056 (0.9628) lr 1.8763e-03 eta 0:18:19
epoch [10/50] batch [240/319] time 0.084 (0.086) data 0.000 (0.003) loss 1.6140 (1.5260) ce_loss 1.3672 (1.3819) teacher_loss 0.9585 (0.8493) loss_zs_kd 0.3637 (0.3884) loss_oracle 0.4737 (0.4825) acc 56.2500 (48.5807) kd_loss 0.9917 (0.9647) lr 1.8763e-03 eta 0:18:18
epoch [10/50] batch [260/319] time 0.087 (0.086) data 0.000 (0.003) loss 1.5240 (1.5259) ce_loss 1.4814 (1.3844) teacher_loss 0.7833 (0.8514) loss_zs_kd 0.4112 (0.3882) loss_oracle 0.5350 (0.4803) acc 50.0000 (48.4014) kd_loss 0.9851 (0.9659) lr 1.8763e-03 eta 0:18:17
epoch [10/50] batch [280/319] time 0.082 (0.086) data 0.000 (0.003) loss 1.5867 (1.5229) ce_loss 1.5576 (1.3828) teacher_loss 0.8172 (0.8511) loss_zs_kd 0.3968 (0.3871) loss_oracle 0.5711 (0.4782) acc 43.7500 (48.3594) kd_loss 0.9444 (0.9662) lr 1.8763e-03 eta 0:18:14
epoch [10/50] batch [300/319] time 0.081 (0.085) data 0.000 (0.002) loss 1.7416 (1.5223) ce_loss 1.6523 (1.3819) teacher_loss 1.0604 (0.8513) loss_zs_kd 0.3755 (0.3867) loss_oracle 0.4934 (0.4777) acc 37.5000 (48.3021) kd_loss 0.9639 (0.9639) lr 1.8763e-03 eta 0:18:11
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,099
* accuracy: 47.9%
* error: 52.1%
* macro_f1: 39.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,431
* accuracy: 45.5%
* error: 54.5%
* macro_f1: 17.3%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [11/50] batch [20/319] time 0.075 (0.112) data 0.000 (0.029) loss 1.3492 (1.4721) ce_loss 1.3623 (1.3511) teacher_loss 0.7766 (0.8074) loss_zs_kd 0.3477 (0.3837) loss_oracle 0.3988 (0.4728) acc 46.8750 (47.5000) kd_loss 0.9451 (0.9714) lr 1.8443e-03 eta 0:23:42
epoch [11/50] batch [40/319] time 0.085 (0.095) data 0.000 (0.015) loss 1.3560 (1.4851) ce_loss 1.1123 (1.3654) teacher_loss 0.7480 (0.8098) loss_zs_kd 0.3402 (0.3856) loss_oracle 0.4379 (0.4826) acc 62.5000 (47.3438) kd_loss 0.9058 (0.9618) lr 1.8443e-03 eta 0:20:11
epoch [11/50] batch [60/319] time 0.087 (0.092) data 0.001 (0.010) loss 1.6571 (1.4992) ce_loss 1.5410 (1.3741) teacher_loss 0.9009 (0.8274) loss_zs_kd 0.4628 (0.3900) loss_oracle 0.5249 (0.4768) acc 34.3750 (46.8229) kd_loss 1.0070 (0.9578) lr 1.8443e-03 eta 0:19:27
epoch [11/50] batch [80/319] time 0.076 (0.090) data 0.000 (0.007) loss 1.6879 (1.4969) ce_loss 1.5889 (1.3805) teacher_loss 1.0591 (0.8360) loss_zs_kd 0.4023 (0.3892) loss_oracle 0.4276 (0.4663) acc 43.7500 (47.0312) kd_loss 0.9895 (0.9553) lr 1.8443e-03 eta 0:18:56
epoch [11/50] batch [100/319] time 0.082 (0.088) data 0.000 (0.006) loss 1.3577 (1.5046) ce_loss 1.1631 (1.3881) teacher_loss 0.8049 (0.8474) loss_zs_kd 0.3333 (0.3848) loss_oracle 0.3862 (0.4647) acc 59.3750 (47.2812) kd_loss 0.8753 (0.9532) lr 1.8443e-03 eta 0:18:32
epoch [11/50] batch [120/319] time 0.079 (0.087) data 0.000 (0.005) loss 1.5371 (1.5123) ce_loss 1.3789 (1.3920) teacher_loss 0.8319 (0.8551) loss_zs_kd 0.3508 (0.3844) loss_oracle 0.5297 (0.4650) acc 50.0000 (47.4740) kd_loss 0.9323 (0.9590) lr 1.8443e-03 eta 0:18:21
epoch [11/50] batch [140/319] time 0.083 (0.087) data 0.000 (0.004) loss 1.7637 (1.5172) ce_loss 1.7539 (1.3905) teacher_loss 1.1217 (0.8599) loss_zs_kd 0.4178 (0.3833) loss_oracle 0.4332 (0.4657) acc 28.1250 (47.8795) kd_loss 1.0288 (0.9625) lr 1.8443e-03 eta 0:18:17
epoch [11/50] batch [160/319] time 0.078 (0.087) data 0.000 (0.004) loss 1.1861 (1.5229) ce_loss 1.0645 (1.3939) teacher_loss 0.6539 (0.8681) loss_zs_kd 0.3231 (0.3811) loss_oracle 0.3706 (0.4642) acc 53.1250 (47.5195) kd_loss 1.0261 (0.9647) lr 1.8443e-03 eta 0:18:12
epoch [11/50] batch [180/319] time 0.086 (0.087) data 0.000 (0.003) loss 1.6367 (1.5232) ce_loss 1.4902 (1.3932) teacher_loss 0.9126 (0.8695) loss_zs_kd 0.3336 (0.3796) loss_oracle 0.5573 (0.4639) acc 37.5000 (47.7083) kd_loss 1.0864 (0.9711) lr 1.8443e-03 eta 0:18:09
epoch [11/50] batch [200/319] time 0.088 (0.086) data 0.000 (0.003) loss 1.5950 (1.5203) ce_loss 1.4658 (1.3905) teacher_loss 0.9163 (0.8671) loss_zs_kd 0.3857 (0.3800) loss_oracle 0.4858 (0.4632) acc 40.6250 (47.9062) kd_loss 0.9420 (0.9738) lr 1.8443e-03 eta 0:18:03
epoch [11/50] batch [220/319] time 0.087 (0.086) data 0.000 (0.003) loss 1.6078 (1.5131) ce_loss 1.4502 (1.3855) teacher_loss 0.9963 (0.8633) loss_zs_kd 0.3864 (0.3767) loss_oracle 0.4183 (0.4615) acc 46.8750 (48.0540) kd_loss 0.8994 (0.9770) lr 1.8443e-03 eta 0:17:58
epoch [11/50] batch [240/319] time 0.079 (0.086) data 0.000 (0.003) loss 1.3091 (1.5077) ce_loss 1.2363 (1.3751) teacher_loss 0.7347 (0.8585) loss_zs_kd 0.3581 (0.3751) loss_oracle 0.3953 (0.4617) acc 53.1250 (48.5286) kd_loss 0.9542 (0.9791) lr 1.8443e-03 eta 0:17:53
epoch [11/50] batch [260/319] time 0.083 (0.085) data 0.000 (0.002) loss 1.4655 (1.5090) ce_loss 1.4307 (1.3759) teacher_loss 0.6932 (0.8586) loss_zs_kd 0.4568 (0.3754) loss_oracle 0.5438 (0.4627) acc 37.5000 (48.2812) kd_loss 0.9526 (0.9804) lr 1.8443e-03 eta 0:17:47
epoch [11/50] batch [280/319] time 0.086 (0.085) data 0.000 (0.002) loss 1.5979 (1.5069) ce_loss 1.6221 (1.3727) teacher_loss 1.0189 (0.8588) loss_zs_kd 0.3304 (0.3733) loss_oracle 0.4137 (0.4614) acc 40.6250 (48.3259) kd_loss 0.9958 (0.9805) lr 1.8443e-03 eta 0:17:45
epoch [11/50] batch [300/319] time 0.090 (0.085) data 0.000 (0.002) loss 1.8985 (1.5097) ce_loss 1.7676 (1.3759) teacher_loss 1.3180 (0.8635) loss_zs_kd 0.3667 (0.3713) loss_oracle 0.3972 (0.4606) acc 31.2500 (48.2083) kd_loss 0.9588 (0.9822) lr 1.8443e-03 eta 0:17:44
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,082
* accuracy: 47.6%
* error: 52.4%
* macro_f1: 34.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,599
* accuracy: 37.0%
* error: 63.0%
* macro_f1: 15.0%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [12/50] batch [20/319] time 0.084 (0.120) data 0.000 (0.032) loss 1.3746 (1.4943) ce_loss 1.2637 (1.3857) teacher_loss 0.7821 (0.8755) loss_zs_kd 0.3446 (0.3452) loss_oracle 0.4202 (0.4462) acc 50.0000 (48.4375) kd_loss 0.9163 (0.9899) lr 1.8090e-03 eta 0:24:48
epoch [12/50] batch [40/319] time 0.082 (0.101) data 0.000 (0.016) loss 1.3227 (1.5022) ce_loss 1.1465 (1.4018) teacher_loss 0.6689 (0.8699) loss_zs_kd 0.3876 (0.3562) loss_oracle 0.4600 (0.4542) acc 53.1250 (47.1094) kd_loss 1.0071 (0.9979) lr 1.8090e-03 eta 0:20:54
epoch [12/50] batch [60/319] time 0.080 (0.095) data 0.001 (0.011) loss 1.6355 (1.5276) ce_loss 1.5195 (1.4116) teacher_loss 1.0284 (0.8802) loss_zs_kd 0.3486 (0.3672) loss_oracle 0.4328 (0.4637) acc 53.1250 (47.0312) kd_loss 0.9677 (0.9936) lr 1.8090e-03 eta 0:19:39
epoch [12/50] batch [80/319] time 0.089 (0.092) data 0.000 (0.008) loss 1.2718 (1.5233) ce_loss 1.1689 (1.3998) teacher_loss 0.6975 (0.8708) loss_zs_kd 0.3233 (0.3680) loss_oracle 0.4126 (0.4685) acc 56.2500 (46.8359) kd_loss 0.9697 (0.9913) lr 1.8090e-03 eta 0:18:58
epoch [12/50] batch [100/319] time 0.093 (0.091) data 0.000 (0.007) loss 1.6158 (1.5361) ce_loss 1.6006 (1.4102) teacher_loss 0.8253 (0.8795) loss_zs_kd 0.3848 (0.3639) loss_oracle 0.5981 (0.4746) acc 46.8750 (46.4688) kd_loss 1.0018 (0.9917) lr 1.8090e-03 eta 0:18:44
epoch [12/50] batch [120/319] time 0.085 (0.090) data 0.000 (0.006) loss 1.7100 (1.5421) ce_loss 1.7549 (1.4163) teacher_loss 0.9522 (0.8867) loss_zs_kd 0.3223 (0.3596) loss_oracle 0.5966 (0.4755) acc 31.2500 (46.4062) kd_loss 1.0972 (0.9910) lr 1.8090e-03 eta 0:18:32
epoch [12/50] batch [140/319] time 0.075 (0.089) data 0.000 (0.005) loss 1.6471 (1.5349) ce_loss 1.5107 (1.4048) teacher_loss 0.9157 (0.8798) loss_zs_kd 0.3913 (0.3601) loss_oracle 0.5357 (0.4750) acc 43.7500 (47.0089) kd_loss 0.9839 (0.9879) lr 1.8090e-03 eta 0:18:10
epoch [12/50] batch [160/319] time 0.083 (0.088) data 0.000 (0.004) loss 1.7205 (1.5319) ce_loss 1.4971 (1.4040) teacher_loss 1.0075 (0.8781) loss_zs_kd 0.4220 (0.3590) loss_oracle 0.5020 (0.4742) acc 46.8750 (47.1094) kd_loss 0.9778 (0.9857) lr 1.8090e-03 eta 0:17:59
epoch [12/50] batch [180/319] time 0.084 (0.087) data 0.000 (0.004) loss 1.5186 (1.5345) ce_loss 1.5264 (1.4032) teacher_loss 0.8759 (0.8724) loss_zs_kd 0.3796 (0.3621) loss_oracle 0.4529 (0.4810) acc 31.2500 (46.8750) kd_loss 0.9011 (0.9889) lr 1.8090e-03 eta 0:17:51
epoch [12/50] batch [200/319] time 0.083 (0.087) data 0.000 (0.003) loss 1.6939 (1.5376) ce_loss 1.6592 (1.4009) teacher_loss 0.9710 (0.8739) loss_zs_kd 0.3010 (0.3610) loss_oracle 0.5723 (0.4832) acc 34.3750 (47.1875) kd_loss 0.9745 (0.9882) lr 1.8090e-03 eta 0:17:40
epoch [12/50] batch [220/319] time 0.084 (0.086) data 0.000 (0.003) loss 1.3880 (1.5420) ce_loss 1.1201 (1.3989) teacher_loss 0.7689 (0.8723) loss_zs_kd 0.3063 (0.3631) loss_oracle 0.4660 (0.4882) acc 53.1250 (46.8182) kd_loss 0.9759 (0.9850) lr 1.8090e-03 eta 0:17:35
epoch [12/50] batch [240/319] time 0.090 (0.086) data 0.000 (0.003) loss 1.5598 (1.5444) ce_loss 1.5225 (1.3971) teacher_loss 0.9316 (0.8764) loss_zs_kd 0.3666 (0.3613) loss_oracle 0.4449 (0.4874) acc 46.8750 (46.9531) kd_loss 0.9046 (0.9821) lr 1.8090e-03 eta 0:17:31
epoch [12/50] batch [260/319] time 0.086 (0.086) data 0.000 (0.003) loss 1.4333 (1.5431) ce_loss 1.2979 (1.3921) teacher_loss 0.8161 (0.8754) loss_zs_kd 0.2946 (0.3585) loss_oracle 0.4698 (0.4885) acc 50.0000 (47.0793) kd_loss 0.8993 (0.9814) lr 1.8090e-03 eta 0:17:25
epoch [12/50] batch [280/319] time 0.084 (0.086) data 0.000 (0.003) loss 1.3646 (1.5440) ce_loss 1.2373 (1.3903) teacher_loss 0.7399 (0.8784) loss_zs_kd 0.2929 (0.3549) loss_oracle 0.4783 (0.4881) acc 53.1250 (47.2210) kd_loss 0.8974 (0.9771) lr 1.8090e-03 eta 0:17:23
epoch [12/50] batch [300/319] time 0.083 (0.086) data 0.000 (0.002) loss 1.6113 (1.5434) ce_loss 1.4814 (1.3882) teacher_loss 0.9215 (0.8778) loss_zs_kd 0.4320 (0.3543) loss_oracle 0.4738 (0.4884) acc 50.0000 (47.3333) kd_loss 0.8214 (0.9721) lr 1.8090e-03 eta 0:17:20
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,100
* accuracy: 48.0%
* error: 52.0%
* macro_f1: 35.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,351
* accuracy: 34.4%
* error: 65.6%
* macro_f1: 14.4%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [13/50] batch [20/319] time 0.075 (0.114) data 0.000 (0.024) loss 1.3910 (1.5843) ce_loss 1.2910 (1.4916) teacher_loss 0.7047 (0.8932) loss_zs_kd 0.3765 (0.3624) loss_oracle 0.4981 (0.5100) acc 62.5000 (45.1562) kd_loss 0.9397 (0.9415) lr 1.7705e-03 eta 0:23:02
epoch [13/50] batch [40/319] time 0.075 (0.097) data 0.000 (0.012) loss 1.7985 (1.5219) ce_loss 1.5557 (1.3877) teacher_loss 1.0952 (0.8537) loss_zs_kd 0.3645 (0.3537) loss_oracle 0.5210 (0.4914) acc 46.8750 (48.3594) kd_loss 0.9617 (0.9351) lr 1.7705e-03 eta 0:19:34
epoch [13/50] batch [60/319] time 0.087 (0.092) data 0.000 (0.008) loss 1.8202 (1.5386) ce_loss 1.5947 (1.4063) teacher_loss 1.1471 (0.8786) loss_zs_kd 0.3820 (0.3525) loss_oracle 0.4821 (0.4837) acc 40.6250 (48.1771) kd_loss 0.9670 (0.9331) lr 1.7705e-03 eta 0:18:34
epoch [13/50] batch [80/319] time 0.074 (0.089) data 0.000 (0.006) loss 1.2646 (1.5409) ce_loss 1.2100 (1.4109) teacher_loss 0.7061 (0.8883) loss_zs_kd 0.2931 (0.3548) loss_oracle 0.4119 (0.4753) acc 50.0000 (47.1484) kd_loss 0.8722 (0.9391) lr 1.7705e-03 eta 0:17:54
epoch [13/50] batch [100/319] time 0.093 (0.088) data 0.000 (0.005) loss 1.5310 (1.5300) ce_loss 1.5391 (1.4079) teacher_loss 0.8738 (0.8855) loss_zs_kd 0.3709 (0.3549) loss_oracle 0.4717 (0.4671) acc 37.5000 (47.3438) kd_loss 0.9014 (0.9390) lr 1.7705e-03 eta 0:17:37
epoch [13/50] batch [120/319] time 0.087 (0.088) data 0.000 (0.004) loss 1.4699 (1.5227) ce_loss 1.5098 (1.4036) teacher_loss 0.8523 (0.8801) loss_zs_kd 0.3187 (0.3565) loss_oracle 0.4583 (0.4644) acc 43.7500 (47.6042) kd_loss 0.9522 (0.9425) lr 1.7705e-03 eta 0:17:30
epoch [13/50] batch [140/319] time 0.085 (0.087) data 0.000 (0.004) loss 1.7687 (1.5217) ce_loss 1.5254 (1.4085) teacher_loss 1.2029 (0.8818) loss_zs_kd 0.3788 (0.3548) loss_oracle 0.3764 (0.4625) acc 34.3750 (47.3661) kd_loss 0.9159 (0.9473) lr 1.7705e-03 eta 0:17:24
epoch [13/50] batch [160/319] time 0.089 (0.087) data 0.000 (0.003) loss 1.5500 (1.5191) ce_loss 1.5010 (1.4051) teacher_loss 0.9329 (0.8790) loss_zs_kd 0.4091 (0.3555) loss_oracle 0.4126 (0.4624) acc 46.8750 (47.3633) kd_loss 0.9469 (0.9471) lr 1.7705e-03 eta 0:17:18
epoch [13/50] batch [180/319] time 0.081 (0.087) data 0.000 (0.003) loss 1.3748 (1.5165) ce_loss 1.2734 (1.4074) teacher_loss 0.7599 (0.8798) loss_zs_kd 0.3138 (0.3564) loss_oracle 0.4580 (0.4586) acc 56.2500 (47.2049) kd_loss 1.0006 (0.9442) lr 1.7705e-03 eta 0:17:14
epoch [13/50] batch [200/319] time 0.096 (0.086) data 0.000 (0.003) loss 1.5442 (1.5168) ce_loss 1.5078 (1.4135) teacher_loss 0.9140 (0.8817) loss_zs_kd 0.3621 (0.3582) loss_oracle 0.4491 (0.4560) acc 50.0000 (47.0156) kd_loss 0.9308 (0.9430) lr 1.7705e-03 eta 0:17:08
epoch [13/50] batch [220/319] time 0.076 (0.086) data 0.000 (0.002) loss 1.6265 (1.5129) ce_loss 1.5732 (1.4094) teacher_loss 0.8853 (0.8763) loss_zs_kd 0.3991 (0.3594) loss_oracle 0.5416 (0.4569) acc 34.3750 (46.9744) kd_loss 0.9964 (0.9418) lr 1.7705e-03 eta 0:17:01
epoch [13/50] batch [240/319] time 0.088 (0.086) data 0.000 (0.002) loss 1.3967 (1.5143) ce_loss 1.2910 (1.4105) teacher_loss 0.8351 (0.8766) loss_zs_kd 0.3098 (0.3617) loss_oracle 0.4066 (0.4568) acc 59.3750 (46.7839) kd_loss 0.9353 (0.9421) lr 1.7705e-03 eta 0:16:56
epoch [13/50] batch [260/319] time 0.085 (0.085) data 0.000 (0.002) loss 1.5265 (1.5123) ce_loss 1.3125 (1.4091) teacher_loss 0.9767 (0.8767) loss_zs_kd 0.3963 (0.3618) loss_oracle 0.3517 (0.4547) acc 46.8750 (46.9111) kd_loss 0.9074 (0.9398) lr 1.7705e-03 eta 0:16:52
epoch [13/50] batch [280/319] time 0.089 (0.085) data 0.001 (0.002) loss 1.4025 (1.5103) ce_loss 1.5225 (1.4107) teacher_loss 0.7961 (0.8775) loss_zs_kd 0.3788 (0.3589) loss_oracle 0.4170 (0.4533) acc 28.1250 (46.7746) kd_loss 0.8070 (0.9392) lr 1.7705e-03 eta 0:16:50
epoch [13/50] batch [300/319] time 0.079 (0.085) data 0.000 (0.002) loss 1.4922 (1.5068) ce_loss 1.3018 (1.4089) teacher_loss 0.8909 (0.8738) loss_zs_kd 0.3710 (0.3589) loss_oracle 0.4158 (0.4535) acc 53.1250 (46.7500) kd_loss 0.8579 (0.9354) lr 1.7705e-03 eta 0:16:46
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,028
* accuracy: 46.3%
* error: 53.7%
* macro_f1: 34.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,372
* accuracy: 34.6%
* error: 65.4%
* macro_f1: 14.4%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [14/50] batch [20/319] time 0.083 (0.114) data 0.000 (0.029) loss 1.4449 (1.5120) ce_loss 1.3057 (1.4086) teacher_loss 0.8269 (0.8785) loss_zs_kd 0.3753 (0.3462) loss_oracle 0.4303 (0.4604) acc 50.0000 (47.0312) kd_loss 0.8524 (0.8680) lr 1.7290e-03 eta 0:22:20
epoch [14/50] batch [40/319] time 0.083 (0.096) data 0.000 (0.014) loss 1.3582 (1.5149) ce_loss 1.3213 (1.3996) teacher_loss 0.7692 (0.8868) loss_zs_kd 0.3103 (0.3427) loss_oracle 0.4338 (0.4568) acc 50.0000 (46.7188) kd_loss 0.8109 (0.8602) lr 1.7290e-03 eta 0:18:50
epoch [14/50] batch [60/319] time 0.084 (0.092) data 0.001 (0.010) loss 1.5631 (1.5188) ce_loss 1.3545 (1.4011) teacher_loss 0.9166 (0.8955) loss_zs_kd 0.4409 (0.3430) loss_oracle 0.4261 (0.4518) acc 46.8750 (46.4583) kd_loss 0.8382 (0.8554) lr 1.7290e-03 eta 0:17:57
epoch [14/50] batch [80/319] time 0.087 (0.090) data 0.000 (0.007) loss 1.6495 (1.5209) ce_loss 1.6748 (1.4104) teacher_loss 1.0310 (0.8950) loss_zs_kd 0.3656 (0.3434) loss_oracle 0.4357 (0.4542) acc 40.6250 (46.4453) kd_loss 0.7806 (0.8560) lr 1.7290e-03 eta 0:17:35
epoch [14/50] batch [100/319] time 0.083 (0.088) data 0.000 (0.006) loss 1.4182 (1.5323) ce_loss 1.3291 (1.4204) teacher_loss 0.7624 (0.8988) loss_zs_kd 0.3446 (0.3469) loss_oracle 0.4835 (0.4601) acc 43.7500 (46.1250) kd_loss 0.8801 (0.8587) lr 1.7290e-03 eta 0:17:09
epoch [14/50] batch [120/319] time 0.079 (0.087) data 0.000 (0.005) loss 1.4877 (1.5302) ce_loss 1.1406 (1.4135) teacher_loss 0.8443 (0.8941) loss_zs_kd 0.3508 (0.3501) loss_oracle 0.4680 (0.4611) acc 62.5000 (45.8854) kd_loss 0.9171 (0.8627) lr 1.7290e-03 eta 0:16:58
epoch [14/50] batch [140/319] time 0.090 (0.087) data 0.000 (0.004) loss 1.7585 (1.5294) ce_loss 1.5059 (1.4151) teacher_loss 1.0521 (0.8950) loss_zs_kd 0.3799 (0.3479) loss_oracle 0.5165 (0.4604) acc 46.8750 (45.7143) kd_loss 0.8584 (0.8613) lr 1.7290e-03 eta 0:16:56
epoch [14/50] batch [160/319] time 0.091 (0.087) data 0.000 (0.004) loss 1.6871 (1.5388) ce_loss 1.5791 (1.4268) teacher_loss 1.0824 (0.8988) loss_zs_kd 0.3217 (0.3509) loss_oracle 0.4439 (0.4646) acc 40.6250 (45.6250) kd_loss 0.8367 (0.8631) lr 1.7290e-03 eta 0:16:51
epoch [14/50] batch [180/319] time 0.080 (0.086) data 0.000 (0.003) loss 1.5330 (1.5353) ce_loss 1.3682 (1.4204) teacher_loss 0.9352 (0.8958) loss_zs_kd 0.3476 (0.3528) loss_oracle 0.4240 (0.4631) acc 46.8750 (46.1285) kd_loss 0.8457 (0.8648) lr 1.7290e-03 eta 0:16:44
epoch [14/50] batch [200/319] time 0.084 (0.086) data 0.000 (0.003) loss 1.4041 (1.5302) ce_loss 1.3115 (1.4119) teacher_loss 0.7030 (0.8888) loss_zs_kd 0.4223 (0.3534) loss_oracle 0.4899 (0.4647) acc 50.0000 (46.5781) kd_loss 0.8405 (0.8681) lr 1.7290e-03 eta 0:16:40
epoch [14/50] batch [220/319] time 0.080 (0.086) data 0.000 (0.003) loss 1.4609 (1.5278) ce_loss 1.4521 (1.4085) teacher_loss 0.7989 (0.8862) loss_zs_kd 0.3436 (0.3546) loss_oracle 0.4902 (0.4643) acc 53.1250 (46.9034) kd_loss 0.8960 (0.8689) lr 1.7290e-03 eta 0:16:35
epoch [14/50] batch [240/319] time 0.088 (0.086) data 0.000 (0.003) loss 1.5713 (1.5259) ce_loss 1.5400 (1.4033) teacher_loss 0.8768 (0.8842) loss_zs_kd 0.3868 (0.3549) loss_oracle 0.5011 (0.4643) acc 43.7500 (47.1615) kd_loss 0.9437 (0.8705) lr 1.7290e-03 eta 0:16:32
epoch [14/50] batch [260/319] time 0.085 (0.086) data 0.000 (0.002) loss 1.4721 (1.5245) ce_loss 1.3711 (1.4018) teacher_loss 0.7368 (0.8802) loss_zs_kd 0.3842 (0.3559) loss_oracle 0.5432 (0.4664) acc 50.0000 (47.3077) kd_loss 0.9481 (0.8728) lr 1.7290e-03 eta 0:16:29
epoch [14/50] batch [280/319] time 0.082 (0.086) data 0.000 (0.002) loss 1.4715 (1.5215) ce_loss 1.4170 (1.3989) teacher_loss 0.8338 (0.8764) loss_zs_kd 0.3483 (0.3575) loss_oracle 0.4636 (0.4663) acc 46.8750 (47.3661) kd_loss 0.8436 (0.8746) lr 1.7290e-03 eta 0:16:25
epoch [14/50] batch [300/319] time 0.086 (0.085) data 0.000 (0.002) loss 1.4763 (1.5197) ce_loss 1.3760 (1.3979) teacher_loss 0.9450 (0.8752) loss_zs_kd 0.3541 (0.3564) loss_oracle 0.3541 (0.4663) acc 43.7500 (47.3646) kd_loss 0.7735 (0.8742) lr 1.7290e-03 eta 0:16:20
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,104
* accuracy: 48.1%
* error: 51.9%
* macro_f1: 35.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,779
* accuracy: 38.8%
* error: 61.2%
* macro_f1: 15.4%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [15/50] batch [20/319] time 0.083 (0.113) data 0.000 (0.025) loss 1.6490 (1.5261) ce_loss 1.5869 (1.4311) teacher_loss 1.1007 (0.9050) loss_zs_kd 0.2989 (0.3515) loss_oracle 0.3989 (0.4453) acc 37.5000 (45.1562) kd_loss 0.8436 (0.8547) lr 1.6845e-03 eta 0:21:38
epoch [15/50] batch [40/319] time 0.081 (0.099) data 0.000 (0.013) loss 1.4538 (1.5226) ce_loss 1.3574 (1.4378) teacher_loss 0.8162 (0.8794) loss_zs_kd 0.3102 (0.3597) loss_oracle 0.4825 (0.4634) acc 43.7500 (44.4531) kd_loss 0.8483 (0.8699) lr 1.6845e-03 eta 0:18:54
epoch [15/50] batch [60/319] time 0.087 (0.094) data 0.000 (0.009) loss 1.7119 (1.5135) ce_loss 1.4258 (1.4219) teacher_loss 0.9895 (0.8661) loss_zs_kd 0.4347 (0.3716) loss_oracle 0.5051 (0.4616) acc 34.3750 (45.0521) kd_loss 0.8168 (0.8642) lr 1.6845e-03 eta 0:17:49
epoch [15/50] batch [80/319] time 0.082 (0.090) data 0.000 (0.006) loss 1.3772 (1.5133) ce_loss 1.1709 (1.4097) teacher_loss 0.7564 (0.8638) loss_zs_kd 0.3758 (0.3729) loss_oracle 0.4329 (0.4630) acc 59.3750 (45.8594) kd_loss 0.9160 (0.8694) lr 1.6845e-03 eta 0:17:11
epoch [15/50] batch [100/319] time 0.081 (0.089) data 0.000 (0.005) loss 1.2579 (1.5020) ce_loss 1.1377 (1.4064) teacher_loss 0.6838 (0.8543) loss_zs_kd 0.3477 (0.3750) loss_oracle 0.4002 (0.4602) acc 56.2500 (46.0312) kd_loss 0.8284 (0.8688) lr 1.6845e-03 eta 0:16:56
epoch [15/50] batch [120/319] time 0.084 (0.088) data 0.000 (0.004) loss 1.3898 (1.4978) ce_loss 1.1992 (1.4003) teacher_loss 0.7254 (0.8485) loss_zs_kd 0.3703 (0.3769) loss_oracle 0.4793 (0.4608) acc 56.2500 (46.4323) kd_loss 0.8675 (0.8699) lr 1.6845e-03 eta 0:16:45
epoch [15/50] batch [140/319] time 0.072 (0.087) data 0.000 (0.004) loss 1.6165 (1.4943) ce_loss 1.3965 (1.3967) teacher_loss 0.8530 (0.8457) loss_zs_kd 0.4794 (0.3770) loss_oracle 0.5238 (0.4601) acc 43.7500 (46.5402) kd_loss 1.0078 (0.8699) lr 1.6845e-03 eta 0:16:31
epoch [15/50] batch [160/319] time 0.086 (0.086) data 0.000 (0.003) loss 1.2238 (1.4863) ce_loss 1.0820 (1.3857) teacher_loss 0.6564 (0.8355) loss_zs_kd 0.3709 (0.3791) loss_oracle 0.3819 (0.4612) acc 68.7500 (46.8750) kd_loss 0.8198 (0.8712) lr 1.6845e-03 eta 0:16:18
epoch [15/50] batch [180/319] time 0.082 (0.086) data 0.000 (0.003) loss 1.3758 (1.4743) ce_loss 1.3105 (1.3709) teacher_loss 0.8202 (0.8246) loss_zs_kd 0.2987 (0.3810) loss_oracle 0.4063 (0.4592) acc 50.0000 (47.5347) kd_loss 0.8577 (0.8688) lr 1.6845e-03 eta 0:16:14
epoch [15/50] batch [200/319] time 0.082 (0.086) data 0.000 (0.003) loss 1.6185 (1.4845) ce_loss 1.5176 (1.3793) teacher_loss 1.0449 (0.8367) loss_zs_kd 0.3847 (0.3818) loss_oracle 0.3813 (0.4568) acc 43.7500 (47.5625) kd_loss 0.7722 (0.8682) lr 1.6845e-03 eta 0:16:09
epoch [15/50] batch [220/319] time 0.091 (0.085) data 0.000 (0.003) loss 1.5283 (1.4869) ce_loss 1.4971 (1.3804) teacher_loss 0.8671 (0.8409) loss_zs_kd 0.3600 (0.3824) loss_oracle 0.4811 (0.4548) acc 43.7500 (47.4574) kd_loss 0.9922 (0.8671) lr 1.6845e-03 eta 0:16:01
epoch [15/50] batch [240/319] time 0.086 (0.085) data 0.000 (0.002) loss 1.5359 (1.4866) ce_loss 1.2256 (1.3783) teacher_loss 0.8331 (0.8421) loss_zs_kd 0.4109 (0.3821) loss_oracle 0.4974 (0.4535) acc 46.8750 (47.3438) kd_loss 0.7974 (0.8638) lr 1.6845e-03 eta 0:15:59
epoch [15/50] batch [260/319] time 0.081 (0.085) data 0.000 (0.002) loss 1.4063 (1.4911) ce_loss 1.2695 (1.3826) teacher_loss 0.7652 (0.8477) loss_zs_kd 0.3842 (0.3833) loss_oracle 0.4490 (0.4518) acc 46.8750 (47.2115) kd_loss 0.9097 (0.8624) lr 1.6845e-03 eta 0:15:57
epoch [15/50] batch [280/319] time 0.090 (0.085) data 0.001 (0.002) loss 1.3800 (1.4930) ce_loss 1.3242 (1.3829) teacher_loss 0.7736 (0.8511) loss_zs_kd 0.3759 (0.3833) loss_oracle 0.4184 (0.4502) acc 43.7500 (47.3214) kd_loss 0.8221 (0.8606) lr 1.6845e-03 eta 0:15:55
epoch [15/50] batch [300/319] time 0.082 (0.085) data 0.000 (0.002) loss 1.6045 (1.4876) ce_loss 1.4434 (1.3778) teacher_loss 0.9925 (0.8494) loss_zs_kd 0.3633 (0.3814) loss_oracle 0.4304 (0.4475) acc 43.7500 (47.6458) kd_loss 0.8085 (0.8593) lr 1.6845e-03 eta 0:15:52
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,126
* accuracy: 48.6%
* error: 51.4%
* macro_f1: 38.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,747
* accuracy: 38.5%
* error: 61.5%
* macro_f1: 16.3%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [16/50] batch [20/319] time 0.080 (0.112) data 0.000 (0.030) loss 1.2675 (1.4579) ce_loss 1.0840 (1.3497) teacher_loss 0.6203 (0.8260) loss_zs_kd 0.4048 (0.4073) loss_oracle 0.4448 (0.4282) acc 56.2500 (48.4375) kd_loss 0.8406 (0.8440) lr 1.6374e-03 eta 0:20:48
epoch [16/50] batch [40/319] time 0.079 (0.095) data 0.000 (0.015) loss 1.7099 (1.4560) ce_loss 1.8359 (1.3495) teacher_loss 0.9850 (0.8296) loss_zs_kd 0.3687 (0.3964) loss_oracle 0.5405 (0.4282) acc 37.5000 (49.8438) kd_loss 0.8709 (0.8468) lr 1.6374e-03 eta 0:17:32
epoch [16/50] batch [60/319] time 0.079 (0.090) data 0.000 (0.010) loss 1.1661 (1.4442) ce_loss 1.0781 (1.3492) teacher_loss 0.5026 (0.8088) loss_zs_kd 0.4128 (0.3956) loss_oracle 0.4571 (0.4376) acc 59.3750 (48.9062) kd_loss 0.9009 (0.8545) lr 1.6374e-03 eta 0:16:35
epoch [16/50] batch [80/319] time 0.086 (0.087) data 0.000 (0.008) loss 1.4396 (1.4466) ce_loss 1.3838 (1.3522) teacher_loss 0.7602 (0.8033) loss_zs_kd 0.4432 (0.3982) loss_oracle 0.4578 (0.4442) acc 40.6250 (49.3750) kd_loss 0.8355 (0.8615) lr 1.6374e-03 eta 0:16:05
epoch [16/50] batch [100/319] time 0.079 (0.086) data 0.000 (0.006) loss 1.4570 (1.4541) ce_loss 1.3760 (1.3655) teacher_loss 0.8922 (0.8160) loss_zs_kd 0.3188 (0.3966) loss_oracle 0.4055 (0.4398) acc 50.0000 (48.8438) kd_loss 0.8056 (0.8638) lr 1.6374e-03 eta 0:15:48
epoch [16/50] batch [120/319] time 0.080 (0.085) data 0.000 (0.005) loss 1.4153 (1.4455) ce_loss 1.3770 (1.3534) teacher_loss 0.7840 (0.8097) loss_zs_kd 0.3710 (0.3951) loss_oracle 0.4458 (0.4383) acc 50.0000 (49.3490) kd_loss 0.8525 (0.8632) lr 1.6374e-03 eta 0:15:39
epoch [16/50] batch [140/319] time 0.084 (0.085) data 0.000 (0.005) loss 1.2819 (1.4564) ce_loss 1.1982 (1.3642) teacher_loss 0.5807 (0.8230) loss_zs_kd 0.4648 (0.3914) loss_oracle 0.4687 (0.4377) acc 50.0000 (48.8170) kd_loss 0.7968 (0.8605) lr 1.6374e-03 eta 0:15:37
epoch [16/50] batch [160/319] time 0.080 (0.085) data 0.000 (0.004) loss 1.2695 (1.4643) ce_loss 1.1787 (1.3729) teacher_loss 0.6332 (0.8279) loss_zs_kd 0.4155 (0.3959) loss_oracle 0.4286 (0.4385) acc 56.2500 (48.4766) kd_loss 0.9003 (0.8624) lr 1.6374e-03 eta 0:15:33
epoch [16/50] batch [180/319] time 0.079 (0.085) data 0.000 (0.004) loss 1.3756 (1.4588) ce_loss 1.3086 (1.3651) teacher_loss 0.7502 (0.8213) loss_zs_kd 0.3701 (0.3949) loss_oracle 0.4403 (0.4401) acc 50.0000 (48.8715) kd_loss 0.7859 (0.8640) lr 1.6374e-03 eta 0:15:31
epoch [16/50] batch [200/319] time 0.080 (0.085) data 0.000 (0.003) loss 1.3352 (1.4588) ce_loss 1.2510 (1.3662) teacher_loss 0.7140 (0.8207) loss_zs_kd 0.3535 (0.3943) loss_oracle 0.4445 (0.4409) acc 56.2500 (48.6250) kd_loss 0.8704 (0.8639) lr 1.6374e-03 eta 0:15:27
epoch [16/50] batch [220/319] time 0.075 (0.084) data 0.000 (0.003) loss 1.4042 (1.4599) ce_loss 1.2891 (1.3673) teacher_loss 0.8186 (0.8224) loss_zs_kd 0.3428 (0.3939) loss_oracle 0.4141 (0.4406) acc 50.0000 (48.5653) kd_loss 0.9523 (0.8638) lr 1.6374e-03 eta 0:15:18
epoch [16/50] batch [240/319] time 0.084 (0.084) data 0.000 (0.003) loss 1.4885 (1.4628) ce_loss 1.3818 (1.3695) teacher_loss 0.7358 (0.8216) loss_zs_kd 0.4318 (0.3967) loss_oracle 0.5368 (0.4429) acc 50.0000 (48.4115) kd_loss 0.8299 (0.8640) lr 1.6374e-03 eta 0:15:14
epoch [16/50] batch [260/319] time 0.081 (0.084) data 0.000 (0.003) loss 1.3737 (1.4639) ce_loss 1.2070 (1.3710) teacher_loss 0.6320 (0.8222) loss_zs_kd 0.4266 (0.3956) loss_oracle 0.5285 (0.4440) acc 53.1250 (48.3774) kd_loss 0.9669 (0.8637) lr 1.6374e-03 eta 0:15:11
epoch [16/50] batch [280/319] time 0.086 (0.084) data 0.000 (0.002) loss 1.6898 (1.4686) ce_loss 1.3740 (1.3708) teacher_loss 1.1084 (0.8263) loss_zs_kd 0.3969 (0.3954) loss_oracle 0.3830 (0.4446) acc 50.0000 (48.5045) kd_loss 0.8214 (0.8639) lr 1.6374e-03 eta 0:15:09
epoch [16/50] batch [300/319] time 0.084 (0.084) data 0.000 (0.002) loss 1.5290 (1.4681) ce_loss 1.4014 (1.3695) teacher_loss 0.7727 (0.8239) loss_zs_kd 0.4536 (0.3950) loss_oracle 0.5295 (0.4467) acc 50.0000 (48.4896) kd_loss 0.8314 (0.8638) lr 1.6374e-03 eta 0:15:09
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,061
* accuracy: 47.1%
* error: 52.9%
* macro_f1: 35.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,373
* accuracy: 34.6%
* error: 65.4%
* macro_f1: 14.6%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [17/50] batch [20/319] time 0.076 (0.118) data 0.000 (0.032) loss 1.5591 (1.4616) ce_loss 1.2549 (1.3431) teacher_loss 0.8272 (0.8147) loss_zs_kd 0.4721 (0.3809) loss_oracle 0.4959 (0.4565) acc 56.2500 (50.3125) kd_loss 0.9003 (0.8783) lr 1.5878e-03 eta 0:21:18
epoch [17/50] batch [40/319] time 0.086 (0.099) data 0.000 (0.016) loss 1.4643 (1.4824) ce_loss 1.3477 (1.3544) teacher_loss 0.8372 (0.8176) loss_zs_kd 0.3953 (0.4008) loss_oracle 0.4294 (0.4645) acc 50.0000 (50.1562) kd_loss 0.8427 (0.8802) lr 1.5878e-03 eta 0:17:53
epoch [17/50] batch [60/319] time 0.088 (0.094) data 0.000 (0.011) loss 1.7193 (1.4946) ce_loss 1.6260 (1.3468) teacher_loss 1.2080 (0.8256) loss_zs_kd 0.3527 (0.3990) loss_oracle 0.3350 (0.4694) acc 46.8750 (50.1042) kd_loss 0.7545 (0.8839) lr 1.5878e-03 eta 0:16:57
epoch [17/50] batch [80/319] time 0.083 (0.092) data 0.000 (0.008) loss 1.2276 (1.4774) ce_loss 1.0469 (1.3348) teacher_loss 0.7090 (0.8135) loss_zs_kd 0.4053 (0.3961) loss_oracle 0.3160 (0.4658) acc 62.5000 (50.6250) kd_loss 0.8269 (0.8822) lr 1.5878e-03 eta 0:16:33
epoch [17/50] batch [100/319] time 0.081 (0.090) data 0.000 (0.007) loss 1.5252 (1.4820) ce_loss 1.3887 (1.3425) teacher_loss 0.8722 (0.8209) loss_zs_kd 0.4340 (0.3905) loss_oracle 0.4360 (0.4658) acc 43.7500 (50.0938) kd_loss 0.8676 (0.8837) lr 1.5878e-03 eta 0:16:10
epoch [17/50] batch [120/319] time 0.081 (0.089) data 0.000 (0.006) loss 1.3596 (1.4901) ce_loss 1.3643 (1.3538) teacher_loss 0.7352 (0.8329) loss_zs_kd 0.3985 (0.3886) loss_oracle 0.4251 (0.4629) acc 40.6250 (49.8177) kd_loss 0.7855 (0.8854) lr 1.5878e-03 eta 0:15:51
epoch [17/50] batch [140/319] time 0.082 (0.088) data 0.000 (0.005) loss 1.6354 (1.4930) ce_loss 1.4287 (1.3621) teacher_loss 0.9264 (0.8292) loss_zs_kd 0.4846 (0.3950) loss_oracle 0.4667 (0.4663) acc 50.0000 (49.3750) kd_loss 1.0263 (0.8915) lr 1.5878e-03 eta 0:15:44
epoch [17/50] batch [160/319] time 0.083 (0.088) data 0.001 (0.004) loss 1.3541 (1.4933) ce_loss 1.1328 (1.3650) teacher_loss 0.6218 (0.8242) loss_zs_kd 0.3720 (0.3992) loss_oracle 0.5463 (0.4695) acc 46.8750 (49.1406) kd_loss 0.9445 (0.8961) lr 1.5878e-03 eta 0:15:37
epoch [17/50] batch [180/319] time 0.086 (0.087) data 0.000 (0.004) loss 1.3474 (1.4913) ce_loss 1.2051 (1.3623) teacher_loss 0.6195 (0.8201) loss_zs_kd 0.4181 (0.4045) loss_oracle 0.5188 (0.4689) acc 53.1250 (49.0104) kd_loss 0.9834 (0.8999) lr 1.5878e-03 eta 0:15:30
epoch [17/50] batch [200/319] time 0.084 (0.087) data 0.000 (0.003) loss 1.2365 (1.4908) ce_loss 1.0527 (1.3615) teacher_loss 0.5659 (0.8179) loss_zs_kd 0.4103 (0.4080) loss_oracle 0.4654 (0.4689) acc 65.6250 (49.1875) kd_loss 0.9178 (0.9012) lr 1.5878e-03 eta 0:15:24
epoch [17/50] batch [220/319] time 0.083 (0.087) data 0.000 (0.003) loss 1.4086 (1.4919) ce_loss 1.3203 (1.3669) teacher_loss 0.7917 (0.8221) loss_zs_kd 0.4640 (0.4091) loss_oracle 0.3850 (0.4653) acc 56.2500 (49.0199) kd_loss 0.8802 (0.9016) lr 1.5878e-03 eta 0:15:21
epoch [17/50] batch [240/319] time 0.079 (0.086) data 0.000 (0.003) loss 1.5394 (1.4881) ce_loss 1.5635 (1.3676) teacher_loss 0.8674 (0.8216) loss_zs_kd 0.4610 (0.4089) loss_oracle 0.4414 (0.4621) acc 40.6250 (48.9062) kd_loss 0.8297 (0.9020) lr 1.5878e-03 eta 0:15:14
epoch [17/50] batch [260/319] time 0.083 (0.086) data 0.000 (0.003) loss 1.4770 (1.4860) ce_loss 1.5557 (1.3707) teacher_loss 0.8203 (0.8237) loss_zs_kd 0.4417 (0.4094) loss_oracle 0.4359 (0.4575) acc 43.7500 (48.7019) kd_loss 0.8763 (0.9020) lr 1.5878e-03 eta 0:15:10
epoch [17/50] batch [280/319] time 0.086 (0.086) data 0.000 (0.003) loss 1.1484 (1.4792) ce_loss 1.0869 (1.3681) teacher_loss 0.5572 (0.8229) loss_zs_kd 0.3762 (0.4074) loss_oracle 0.4031 (0.4526) acc 56.2500 (48.7946) kd_loss 0.9347 (0.9024) lr 1.5878e-03 eta 0:15:08
epoch [17/50] batch [300/319] time 0.085 (0.086) data 0.000 (0.002) loss 1.4607 (1.4747) ce_loss 1.4150 (1.3681) teacher_loss 0.7948 (0.8230) loss_zs_kd 0.4257 (0.4060) loss_oracle 0.4530 (0.4488) acc 46.8750 (48.7396) kd_loss 0.8715 (0.9020) lr 1.5878e-03 eta 0:15:05
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,068
* accuracy: 47.2%
* error: 52.8%
* macro_f1: 36.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,269
* accuracy: 33.6%
* error: 66.4%
* macro_f1: 15.4%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [18/50] batch [20/319] time 0.076 (0.107) data 0.000 (0.024) loss 1.2674 (1.3971) ce_loss 1.2041 (1.3189) teacher_loss 0.7101 (0.8333) loss_zs_kd 0.3463 (0.3652) loss_oracle 0.3841 (0.3812) acc 56.2500 (51.5625) kd_loss 0.8636 (0.8963) lr 1.5358e-03 eta 0:18:41
epoch [18/50] batch [40/319] time 0.087 (0.095) data 0.000 (0.012) loss 1.3325 (1.3965) ce_loss 1.2041 (1.3122) teacher_loss 0.7749 (0.8394) loss_zs_kd 0.3736 (0.3640) loss_oracle 0.3708 (0.3751) acc 43.7500 (50.6250) kd_loss 0.8617 (0.8755) lr 1.5358e-03 eta 0:16:40
epoch [18/50] batch [60/319] time 0.084 (0.092) data 0.000 (0.008) loss 1.3928 (1.3849) ce_loss 1.4883 (1.3276) teacher_loss 0.8401 (0.8242) loss_zs_kd 0.3929 (0.3678) loss_oracle 0.3562 (0.3767) acc 43.7500 (49.7917) kd_loss 0.9072 (0.8762) lr 1.5358e-03 eta 0:15:59
epoch [18/50] batch [80/319] time 0.083 (0.089) data 0.000 (0.006) loss 1.3605 (1.3948) ce_loss 1.4014 (1.3401) teacher_loss 0.7253 (0.8333) loss_zs_kd 0.3873 (0.3702) loss_oracle 0.4415 (0.3764) acc 43.7500 (48.9062) kd_loss 0.9301 (0.8763) lr 1.5358e-03 eta 0:15:33
epoch [18/50] batch [100/319] time 0.080 (0.088) data 0.000 (0.005) loss 1.1811 (1.3987) ce_loss 0.9150 (1.3461) teacher_loss 0.6729 (0.8388) loss_zs_kd 0.3517 (0.3699) loss_oracle 0.3324 (0.3749) acc 71.8750 (48.8125) kd_loss 0.8913 (0.8785) lr 1.5358e-03 eta 0:15:18
epoch [18/50] batch [120/319] time 0.079 (0.088) data 0.000 (0.004) loss 1.5259 (1.4068) ce_loss 1.6211 (1.3595) teacher_loss 0.8705 (0.8498) loss_zs_kd 0.4717 (0.3695) loss_oracle 0.4195 (0.3723) acc 46.8750 (48.6458) kd_loss 0.8530 (0.8783) lr 1.5358e-03 eta 0:15:16
epoch [18/50] batch [140/319] time 0.085 (0.088) data 0.000 (0.004) loss 1.3335 (1.4021) ce_loss 1.2861 (1.3560) teacher_loss 0.8234 (0.8477) loss_zs_kd 0.3882 (0.3701) loss_oracle 0.3159 (0.3693) acc 50.0000 (48.7723) kd_loss 0.9511 (0.8801) lr 1.5358e-03 eta 0:15:09
epoch [18/50] batch [160/319] time 0.094 (0.087) data 0.000 (0.003) loss 1.4205 (1.4048) ce_loss 1.5762 (1.3620) teacher_loss 0.9200 (0.8531) loss_zs_kd 0.3604 (0.3682) loss_oracle 0.3203 (0.3676) acc 46.8750 (48.8867) kd_loss 0.8964 (0.8795) lr 1.5358e-03 eta 0:15:03
epoch [18/50] batch [180/319] time 0.081 (0.087) data 0.000 (0.003) loss 1.4492 (1.4045) ce_loss 1.3672 (1.3648) teacher_loss 0.9531 (0.8536) loss_zs_kd 0.3933 (0.3689) loss_oracle 0.2995 (0.3664) acc 46.8750 (48.7500) kd_loss 0.7991 (0.8784) lr 1.5358e-03 eta 0:14:57
epoch [18/50] batch [200/319] time 0.084 (0.086) data 0.000 (0.003) loss 1.3905 (1.4054) ce_loss 1.4043 (1.3666) teacher_loss 0.8681 (0.8552) loss_zs_kd 0.3367 (0.3670) loss_oracle 0.3540 (0.3667) acc 40.6250 (48.8438) kd_loss 0.9292 (0.8795) lr 1.5358e-03 eta 0:14:48
epoch [18/50] batch [220/319] time 0.086 (0.086) data 0.000 (0.002) loss 1.5723 (1.4081) ce_loss 1.3740 (1.3702) teacher_loss 1.0719 (0.8567) loss_zs_kd 0.3923 (0.3678) loss_oracle 0.3043 (0.3675) acc 53.1250 (48.5938) kd_loss 0.8774 (0.8807) lr 1.5358e-03 eta 0:14:46
epoch [18/50] batch [240/319] time 0.084 (0.086) data 0.000 (0.002) loss 1.3537 (1.4087) ce_loss 1.4619 (1.3722) teacher_loss 0.8272 (0.8572) loss_zs_kd 0.3051 (0.3662) loss_oracle 0.3740 (0.3684) acc 46.8750 (48.7109) kd_loss 0.9101 (0.8811) lr 1.5358e-03 eta 0:14:42
epoch [18/50] batch [260/319] time 0.074 (0.085) data 0.000 (0.002) loss 1.5575 (1.4104) ce_loss 1.5059 (1.3743) teacher_loss 0.9009 (0.8579) loss_zs_kd 0.4189 (0.3663) loss_oracle 0.4472 (0.3693) acc 50.0000 (48.5938) kd_loss 0.8665 (0.8797) lr 1.5358e-03 eta 0:14:35
epoch [18/50] batch [280/319] time 0.082 (0.085) data 0.000 (0.002) loss 1.4550 (1.4157) ce_loss 1.3955 (1.3811) teacher_loss 0.9648 (0.8617) loss_zs_kd 0.3393 (0.3672) loss_oracle 0.3206 (0.3704) acc 50.0000 (48.4040) kd_loss 0.7660 (0.8788) lr 1.5358e-03 eta 0:14:33
epoch [18/50] batch [300/319] time 0.077 (0.085) data 0.000 (0.002) loss 1.4608 (1.4201) ce_loss 1.3193 (1.3839) teacher_loss 0.7785 (0.8644) loss_zs_kd 0.4038 (0.3665) loss_oracle 0.4805 (0.3725) acc 53.1250 (48.3021) kd_loss 0.8353 (0.8759) lr 1.5358e-03 eta 0:14:29
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,187
* accuracy: 50.0%
* error: 50.0%
* macro_f1: 38.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,368
* accuracy: 34.6%
* error: 65.4%
* macro_f1: 15.1%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [19/50] batch [20/319] time 0.087 (0.117) data 0.000 (0.029) loss 1.3544 (1.4692) ce_loss 1.1074 (1.3574) teacher_loss 0.8192 (0.8447) loss_zs_kd 0.3383 (0.3701) loss_oracle 0.3660 (0.4395) acc 56.2500 (50.1562) kd_loss 0.8051 (0.8444) lr 1.4818e-03 eta 0:19:51
epoch [19/50] batch [40/319] time 0.081 (0.100) data 0.000 (0.014) loss 1.4135 (1.4619) ce_loss 1.2744 (1.3537) teacher_loss 0.8878 (0.8582) loss_zs_kd 0.3511 (0.3637) loss_oracle 0.3501 (0.4219) acc 46.8750 (50.0781) kd_loss 0.8167 (0.8378) lr 1.4818e-03 eta 0:16:52
epoch [19/50] batch [60/319] time 0.081 (0.093) data 0.001 (0.010) loss 1.2887 (1.4764) ce_loss 0.9624 (1.3509) teacher_loss 0.7786 (0.8642) loss_zs_kd 0.2890 (0.3711) loss_oracle 0.3655 (0.4267) acc 62.5000 (49.3229) kd_loss 0.8216 (0.8306) lr 1.4818e-03 eta 0:15:46
epoch [19/50] batch [80/319] time 0.091 (0.091) data 0.000 (0.007) loss 1.4556 (1.4801) ce_loss 1.3379 (1.3527) teacher_loss 0.9204 (0.8698) loss_zs_kd 0.4081 (0.3594) loss_oracle 0.3312 (0.4306) acc 46.8750 (49.6094) kd_loss 0.6825 (0.8209) lr 1.4818e-03 eta 0:15:22
epoch [19/50] batch [100/319] time 0.074 (0.090) data 0.000 (0.006) loss 1.5816 (1.4973) ce_loss 1.4033 (1.3604) teacher_loss 0.8756 (0.8765) loss_zs_kd 0.3928 (0.3663) loss_oracle 0.5097 (0.4377) acc 53.1250 (48.9688) kd_loss 0.8138 (0.8181) lr 1.4818e-03 eta 0:15:04
epoch [19/50] batch [120/319] time 0.080 (0.088) data 0.000 (0.005) loss 1.6926 (1.5016) ce_loss 1.7520 (1.3620) teacher_loss 1.0177 (0.8763) loss_zs_kd 0.3269 (0.3677) loss_oracle 0.5115 (0.4415) acc 31.2500 (48.7500) kd_loss 0.7971 (0.8175) lr 1.4818e-03 eta 0:14:52
epoch [19/50] batch [140/319] time 0.081 (0.088) data 0.000 (0.004) loss 1.5694 (1.5044) ce_loss 1.2783 (1.3601) teacher_loss 0.8413 (0.8762) loss_zs_kd 0.3228 (0.3677) loss_oracle 0.5668 (0.4444) acc 50.0000 (48.6384) kd_loss 0.8499 (0.8181) lr 1.4818e-03 eta 0:14:40
epoch [19/50] batch [160/319] time 0.058 (0.085) data 0.000 (0.004) loss 1.5230 (1.5028) ce_loss 1.6416 (1.3544) teacher_loss 0.9132 (0.8724) loss_zs_kd 0.3330 (0.3701) loss_oracle 0.4433 (0.4453) acc 37.5000 (48.6328) kd_loss 0.8201 (0.8185) lr 1.4818e-03 eta 0:14:15
epoch [19/50] batch [180/319] time 0.081 (0.085) data 0.000 (0.003) loss 1.3203 (1.4969) ce_loss 1.0479 (1.3481) teacher_loss 0.7420 (0.8626) loss_zs_kd 0.3809 (0.3718) loss_oracle 0.3878 (0.4484) acc 65.6250 (49.0278) kd_loss 0.8723 (0.8226) lr 1.4818e-03 eta 0:14:08
epoch [19/50] batch [200/319] time 0.081 (0.084) data 0.000 (0.003) loss 1.4779 (1.4968) ce_loss 1.4033 (1.3486) teacher_loss 0.7380 (0.8558) loss_zs_kd 0.4060 (0.3759) loss_oracle 0.5369 (0.4530) acc 40.6250 (48.9219) kd_loss 0.8970 (0.8271) lr 1.4818e-03 eta 0:14:05
epoch [19/50] batch [220/319] time 0.088 (0.084) data 0.000 (0.003) loss 1.4027 (1.4915) ce_loss 1.3076 (1.3420) teacher_loss 0.7257 (0.8464) loss_zs_kd 0.3897 (0.3790) loss_oracle 0.4821 (0.4556) acc 56.2500 (49.2756) kd_loss 0.8730 (0.8306) lr 1.4818e-03 eta 0:13:58
epoch [19/50] batch [240/319] time 0.081 (0.084) data 0.000 (0.003) loss 1.6453 (1.4901) ce_loss 1.4307 (1.3427) teacher_loss 0.9324 (0.8428) loss_zs_kd 0.3971 (0.3819) loss_oracle 0.5144 (0.4563) acc 56.2500 (49.4271) kd_loss 0.9368 (0.8342) lr 1.4818e-03 eta 0:13:57
epoch [19/50] batch [260/319] time 0.074 (0.084) data 0.000 (0.002) loss 1.6847 (1.4894) ce_loss 1.5000 (1.3427) teacher_loss 0.9490 (0.8398) loss_zs_kd 0.3870 (0.3843) loss_oracle 0.5422 (0.4574) acc 56.2500 (49.3870) kd_loss 0.8207 (0.8361) lr 1.4818e-03 eta 0:13:53
epoch [19/50] batch [280/319] time 0.081 (0.084) data 0.000 (0.002) loss 1.3601 (1.4851) ce_loss 1.2246 (1.3431) teacher_loss 0.6441 (0.8347) loss_zs_kd 0.4159 (0.3872) loss_oracle 0.5081 (0.4568) acc 53.1250 (49.2746) kd_loss 0.9422 (0.8385) lr 1.4818e-03 eta 0:13:50
epoch [19/50] batch [300/319] time 0.078 (0.084) data 0.000 (0.002) loss 1.5492 (1.4814) ce_loss 1.3975 (1.3436) teacher_loss 0.8299 (0.8310) loss_zs_kd 0.4188 (0.3893) loss_oracle 0.5099 (0.4557) acc 43.7500 (49.3125) kd_loss 0.9317 (0.8407) lr 1.4818e-03 eta 0:13:48
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,226
* accuracy: 50.8%
* error: 49.2%
* macro_f1: 40.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,700
* accuracy: 38.0%
* error: 62.0%
* macro_f1: 17.6%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [20/50] batch [20/319] time 0.086 (0.121) data 0.000 (0.032) loss 1.5438 (1.4495) ce_loss 1.2764 (1.3505) teacher_loss 0.8714 (0.7656) loss_zs_kd 0.3926 (0.4313) loss_oracle 0.4760 (0.4682) acc 43.7500 (49.3750) kd_loss 0.8113 (0.8761) lr 1.4258e-03 eta 0:19:52
epoch [20/50] batch [40/319] time 0.084 (0.103) data 0.000 (0.016) loss 1.3172 (1.4313) ce_loss 1.1865 (1.3404) teacher_loss 0.6874 (0.7583) loss_zs_kd 0.3598 (0.4173) loss_oracle 0.4500 (0.4644) acc 50.0000 (49.7656) kd_loss 0.8549 (0.8831) lr 1.4258e-03 eta 0:16:54
epoch [20/50] batch [60/319] time 0.076 (0.096) data 0.000 (0.011) loss 1.1946 (1.4465) ce_loss 1.0312 (1.3653) teacher_loss 0.6220 (0.7799) loss_zs_kd 0.3033 (0.4087) loss_oracle 0.4210 (0.4622) acc 59.3750 (48.8542) kd_loss 0.9206 (0.8794) lr 1.4258e-03 eta 0:15:47
epoch [20/50] batch [80/319] time 0.077 (0.093) data 0.000 (0.008) loss 1.3908 (1.4344) ce_loss 1.3027 (1.3559) teacher_loss 0.6495 (0.7698) loss_zs_kd 0.5255 (0.4114) loss_oracle 0.4786 (0.4589) acc 53.1250 (49.1797) kd_loss 0.9084 (0.8802) lr 1.4258e-03 eta 0:15:12
epoch [20/50] batch [100/319] time 0.088 (0.091) data 0.000 (0.007) loss 1.3466 (1.4235) ce_loss 1.2188 (1.3475) teacher_loss 0.7240 (0.7569) loss_zs_kd 0.4228 (0.4155) loss_oracle 0.4112 (0.4588) acc 62.5000 (49.4688) kd_loss 0.8460 (0.8840) lr 1.4258e-03 eta 0:14:54
epoch [20/50] batch [120/319] time 0.083 (0.090) data 0.000 (0.006) loss 1.3513 (1.4186) ce_loss 1.3857 (1.3393) teacher_loss 0.7093 (0.7493) loss_zs_kd 0.4107 (0.4141) loss_oracle 0.4366 (0.4622) acc 43.7500 (49.6354) kd_loss 0.8978 (0.8878) lr 1.4258e-03 eta 0:14:39
epoch [20/50] batch [140/319] time 0.085 (0.089) data 0.000 (0.005) loss 1.3353 (1.4221) ce_loss 1.0977 (1.3429) teacher_loss 0.6522 (0.7468) loss_zs_kd 0.4200 (0.4190) loss_oracle 0.4731 (0.4658) acc 59.3750 (49.5089) kd_loss 0.8344 (0.8878) lr 1.4258e-03 eta 0:14:29
epoch [20/50] batch [160/319] time 0.081 (0.089) data 0.000 (0.004) loss 1.3128 (1.4255) ce_loss 1.1455 (1.3419) teacher_loss 0.6700 (0.7488) loss_zs_kd 0.4295 (0.4180) loss_oracle 0.4280 (0.4677) acc 62.5000 (49.5117) kd_loss 0.9860 (0.8904) lr 1.4258e-03 eta 0:14:22
epoch [20/50] batch [180/319] time 0.087 (0.088) data 0.000 (0.004) loss 1.5829 (1.4331) ce_loss 1.3936 (1.3503) teacher_loss 0.8680 (0.7538) loss_zs_kd 0.4320 (0.4175) loss_oracle 0.4989 (0.4706) acc 40.6250 (49.0972) kd_loss 0.9148 (0.8919) lr 1.4258e-03 eta 0:14:16
epoch [20/50] batch [200/319] time 0.078 (0.088) data 0.000 (0.003) loss 1.5722 (1.4344) ce_loss 1.4746 (1.3536) teacher_loss 0.8586 (0.7520) loss_zs_kd 0.5063 (0.4182) loss_oracle 0.4605 (0.4734) acc 53.1250 (49.0000) kd_loss 0.8929 (0.8918) lr 1.4258e-03 eta 0:14:10
epoch [20/50] batch [220/319] time 0.085 (0.087) data 0.000 (0.003) loss 1.3881 (1.4343) ce_loss 1.3076 (1.3514) teacher_loss 0.7440 (0.7490) loss_zs_kd 0.3692 (0.4206) loss_oracle 0.4595 (0.4750) acc 56.2500 (49.2756) kd_loss 0.8969 (0.8927) lr 1.4258e-03 eta 0:14:05
epoch [20/50] batch [240/319] time 0.081 (0.087) data 0.000 (0.003) loss 1.5136 (1.4385) ce_loss 1.2070 (1.3587) teacher_loss 0.7729 (0.7520) loss_zs_kd 0.4153 (0.4201) loss_oracle 0.5330 (0.4765) acc 56.2500 (49.1536) kd_loss 0.9198 (0.8924) lr 1.4258e-03 eta 0:14:01
epoch [20/50] batch [260/319] time 0.074 (0.087) data 0.000 (0.003) loss 1.4086 (1.4363) ce_loss 1.1650 (1.3546) teacher_loss 0.7365 (0.7506) loss_zs_kd 0.3749 (0.4196) loss_oracle 0.4847 (0.4759) acc 53.1250 (49.2909) kd_loss 0.8551 (0.8910) lr 1.4258e-03 eta 0:13:53
epoch [20/50] batch [280/319] time 0.072 (0.086) data 0.000 (0.003) loss 1.4062 (1.4384) ce_loss 1.3271 (1.3545) teacher_loss 0.7462 (0.7531) loss_zs_kd 0.4059 (0.4188) loss_oracle 0.4570 (0.4758) acc 53.1250 (49.3973) kd_loss 0.9267 (0.8894) lr 1.4258e-03 eta 0:13:46
epoch [20/50] batch [300/319] time 0.086 (0.086) data 0.000 (0.002) loss 1.4718 (1.4379) ce_loss 1.3740 (1.3541) teacher_loss 0.8189 (0.7549) loss_zs_kd 0.4275 (0.4174) loss_oracle 0.4392 (0.4743) acc 50.0000 (49.5312) kd_loss 0.8871 (0.8888) lr 1.4258e-03 eta 0:13:41
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,142
* accuracy: 48.9%
* error: 51.1%
* macro_f1: 37.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,909
* accuracy: 40.1%
* error: 59.9%
* macro_f1: 16.1%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [21/50] batch [20/319] time 0.081 (0.113) data 0.000 (0.028) loss 1.5112 (1.4755) ce_loss 1.4590 (1.3619) teacher_loss 0.6984 (0.7535) loss_zs_kd 0.4857 (0.4465) loss_oracle 0.5699 (0.4988) acc 40.6250 (47.5000) kd_loss 0.9641 (0.8739) lr 1.3681e-03 eta 0:17:58
epoch [21/50] batch [40/319] time 0.082 (0.099) data 0.000 (0.014) loss 1.4828 (1.4712) ce_loss 1.2910 (1.3641) teacher_loss 0.8062 (0.7656) loss_zs_kd 0.3783 (0.4333) loss_oracle 0.4874 (0.4890) acc 53.1250 (47.8125) kd_loss 0.7875 (0.8728) lr 1.3681e-03 eta 0:15:39
epoch [21/50] batch [60/319] time 0.080 (0.092) data 0.000 (0.010) loss 1.5416 (1.4745) ce_loss 1.2734 (1.3584) teacher_loss 0.6487 (0.7582) loss_zs_kd 0.5005 (0.4361) loss_oracle 0.6427 (0.4983) acc 43.7500 (48.0729) kd_loss 0.9395 (0.8813) lr 1.3681e-03 eta 0:14:35
epoch [21/50] batch [80/319] time 0.076 (0.090) data 0.000 (0.007) loss 1.1761 (1.4682) ce_loss 1.0234 (1.3570) teacher_loss 0.5526 (0.7590) loss_zs_kd 0.3625 (0.4315) loss_oracle 0.4422 (0.4934) acc 62.5000 (48.0859) kd_loss 0.8664 (0.8819) lr 1.3681e-03 eta 0:14:09
epoch [21/50] batch [100/319] time 0.080 (0.088) data 0.000 (0.006) loss 1.4133 (1.4702) ce_loss 1.2666 (1.3562) teacher_loss 0.7508 (0.7648) loss_zs_kd 0.4032 (0.4246) loss_oracle 0.4609 (0.4931) acc 62.5000 (48.3125) kd_loss 0.9011 (0.8813) lr 1.3681e-03 eta 0:13:51
epoch [21/50] batch [120/319] time 0.079 (0.087) data 0.000 (0.005) loss 1.4062 (1.4720) ce_loss 1.2344 (1.3452) teacher_loss 0.6644 (0.7657) loss_zs_kd 0.3698 (0.4266) loss_oracle 0.5569 (0.4930) acc 46.8750 (48.6719) kd_loss 0.8988 (0.8772) lr 1.3681e-03 eta 0:13:41
epoch [21/50] batch [140/319] time 0.085 (0.087) data 0.000 (0.004) loss 1.6331 (1.4670) ce_loss 1.4824 (1.3357) teacher_loss 0.9069 (0.7618) loss_zs_kd 0.4898 (0.4237) loss_oracle 0.4813 (0.4934) acc 40.6250 (49.0848) kd_loss 0.7918 (0.8789) lr 1.3681e-03 eta 0:13:35
epoch [21/50] batch [160/319] time 0.084 (0.086) data 0.000 (0.004) loss 1.4221 (1.4672) ce_loss 1.1680 (1.3266) teacher_loss 0.8290 (0.7688) loss_zs_kd 0.3653 (0.4207) loss_oracle 0.4104 (0.4881) acc 56.2500 (49.5898) kd_loss 0.8965 (0.8753) lr 1.3681e-03 eta 0:13:26
epoch [21/50] batch [180/319] time 0.091 (0.086) data 0.000 (0.003) loss 1.5723 (1.4663) ce_loss 1.3906 (1.3220) teacher_loss 0.8984 (0.7677) loss_zs_kd 0.4494 (0.4193) loss_oracle 0.4492 (0.4889) acc 43.7500 (49.5486) kd_loss 0.8124 (0.8749) lr 1.3681e-03 eta 0:13:24
epoch [21/50] batch [200/319] time 0.087 (0.086) data 0.000 (0.003) loss 1.7003 (1.4726) ce_loss 1.5840 (1.3284) teacher_loss 0.9642 (0.7717) loss_zs_kd 0.4901 (0.4194) loss_oracle 0.4911 (0.4912) acc 53.1250 (49.3438) kd_loss 0.9119 (0.8781) lr 1.3681e-03 eta 0:13:22
epoch [21/50] batch [220/319] time 0.079 (0.086) data 0.000 (0.003) loss 1.5147 (1.4721) ce_loss 1.3281 (1.3300) teacher_loss 0.8470 (0.7698) loss_zs_kd 0.3540 (0.4204) loss_oracle 0.4906 (0.4921) acc 43.7500 (49.4744) kd_loss 0.8752 (0.8785) lr 1.3681e-03 eta 0:13:20
epoch [21/50] batch [240/319] time 0.085 (0.085) data 0.000 (0.003) loss 1.1868 (1.4700) ce_loss 1.2012 (1.3295) teacher_loss 0.5769 (0.7698) loss_zs_kd 0.3957 (0.4189) loss_oracle 0.4121 (0.4907) acc 53.1250 (49.5443) kd_loss 0.9478 (0.8792) lr 1.3681e-03 eta 0:13:12
epoch [21/50] batch [260/319] time 0.084 (0.085) data 0.000 (0.002) loss 1.5910 (1.4782) ce_loss 1.5410 (1.3380) teacher_loss 0.7990 (0.7783) loss_zs_kd 0.4759 (0.4193) loss_oracle 0.5540 (0.4902) acc 34.3750 (49.2909) kd_loss 0.8417 (0.8779) lr 1.3681e-03 eta 0:13:11
epoch [21/50] batch [280/319] time 0.090 (0.085) data 0.000 (0.002) loss 1.4187 (1.4802) ce_loss 1.3477 (1.3412) teacher_loss 0.7795 (0.7807) loss_zs_kd 0.4049 (0.4196) loss_oracle 0.4368 (0.4898) acc 50.0000 (49.1629) kd_loss 0.8499 (0.8769) lr 1.3681e-03 eta 0:13:08
epoch [21/50] batch [300/319] time 0.082 (0.085) data 0.000 (0.002) loss 1.3323 (1.4789) ce_loss 1.1230 (1.3376) teacher_loss 0.7103 (0.7807) loss_zs_kd 0.4065 (0.4184) loss_oracle 0.4188 (0.4890) acc 56.2500 (49.3646) kd_loss 0.8837 (0.8758) lr 1.3681e-03 eta 0:13:05
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,147
* accuracy: 49.0%
* error: 51.0%
* macro_f1: 38.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,694
* accuracy: 37.9%
* error: 62.1%
* macro_f1: 15.8%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [22/50] batch [20/319] time 0.087 (0.108) data 0.000 (0.023) loss 1.5845 (1.4591) ce_loss 1.4697 (1.3032) teacher_loss 0.7314 (0.7598) loss_zs_kd 0.5019 (0.4102) loss_oracle 0.6022 (0.4942) acc 40.6250 (50.0000) kd_loss 0.9063 (0.8819) lr 1.3090e-03 eta 0:16:34
epoch [22/50] batch [40/319] time 0.083 (0.096) data 0.000 (0.012) loss 1.4656 (1.4517) ce_loss 1.3369 (1.3094) teacher_loss 0.8046 (0.7576) loss_zs_kd 0.4437 (0.4086) loss_oracle 0.4391 (0.4898) acc 40.6250 (49.4531) kd_loss 0.8184 (0.8723) lr 1.3090e-03 eta 0:14:48
epoch [22/50] batch [60/319] time 0.080 (0.093) data 0.000 (0.008) loss 1.2789 (1.4554) ce_loss 1.1357 (1.3180) teacher_loss 0.6318 (0.7718) loss_zs_kd 0.3790 (0.4024) loss_oracle 0.4576 (0.4824) acc 56.2500 (48.8542) kd_loss 0.8964 (0.8683) lr 1.3090e-03 eta 0:14:15
epoch [22/50] batch [80/319] time 0.097 (0.091) data 0.001 (0.006) loss 1.8676 (1.4541) ce_loss 1.6768 (1.3167) teacher_loss 1.1757 (0.7755) loss_zs_kd 0.4101 (0.4023) loss_oracle 0.4869 (0.4774) acc 31.2500 (49.2188) kd_loss 0.7973 (0.8686) lr 1.3090e-03 eta 0:13:56
epoch [22/50] batch [100/319] time 0.084 (0.089) data 0.000 (0.005) loss 1.3103 (1.4618) ce_loss 1.2676 (1.3231) teacher_loss 0.5983 (0.7800) loss_zs_kd 0.3997 (0.4026) loss_oracle 0.5122 (0.4806) acc 46.8750 (49.1562) kd_loss 0.8765 (0.8708) lr 1.3090e-03 eta 0:13:33
epoch [22/50] batch [120/319] time 0.088 (0.088) data 0.000 (0.004) loss 1.7054 (1.4566) ce_loss 1.6025 (1.3192) teacher_loss 1.0838 (0.7786) loss_zs_kd 0.4024 (0.4028) loss_oracle 0.4204 (0.4767) acc 46.8750 (49.3229) kd_loss 0.8519 (0.8680) lr 1.3090e-03 eta 0:13:26
epoch [22/50] batch [140/319] time 0.085 (0.087) data 0.000 (0.004) loss 1.4836 (1.4680) ce_loss 1.4248 (1.3243) teacher_loss 0.7939 (0.7867) loss_zs_kd 0.3744 (0.4064) loss_oracle 0.5025 (0.4781) acc 43.7500 (49.1964) kd_loss 0.8868 (0.8651) lr 1.3090e-03 eta 0:13:16
epoch [22/50] batch [160/319] time 0.080 (0.087) data 0.000 (0.003) loss 1.5829 (1.4670) ce_loss 1.4316 (1.3263) teacher_loss 0.8981 (0.7903) loss_zs_kd 0.3528 (0.4037) loss_oracle 0.5084 (0.4749) acc 46.8750 (49.2188) kd_loss 0.8440 (0.8637) lr 1.3090e-03 eta 0:13:12
epoch [22/50] batch [180/319] time 0.077 (0.086) data 0.000 (0.003) loss 1.6926 (1.4602) ce_loss 1.5459 (1.3191) teacher_loss 1.0535 (0.7866) loss_zs_kd 0.4346 (0.4020) loss_oracle 0.4218 (0.4726) acc 46.8750 (49.6181) kd_loss 0.8610 (0.8643) lr 1.3090e-03 eta 0:13:02
epoch [22/50] batch [200/319] time 0.087 (0.086) data 0.000 (0.003) loss 1.3903 (1.4600) ce_loss 1.2988 (1.3187) teacher_loss 0.7357 (0.7875) loss_zs_kd 0.4045 (0.4025) loss_oracle 0.4524 (0.4713) acc 43.7500 (49.5625) kd_loss 0.9157 (0.8640) lr 1.3090e-03 eta 0:12:56
epoch [22/50] batch [220/319] time 0.079 (0.086) data 0.000 (0.002) loss 1.2109 (1.4583) ce_loss 1.0703 (1.3184) teacher_loss 0.6339 (0.7878) loss_zs_kd 0.3529 (0.4027) loss_oracle 0.4006 (0.4692) acc 68.7500 (49.6875) kd_loss 0.8134 (0.8645) lr 1.3090e-03 eta 0:12:54
epoch [22/50] batch [240/319] time 0.084 (0.085) data 0.001 (0.002) loss 1.6454 (1.4560) ce_loss 1.5264 (1.3181) teacher_loss 0.9240 (0.7849) loss_zs_kd 0.4567 (0.4031) loss_oracle 0.4931 (0.4696) acc 43.7500 (49.6875) kd_loss 0.8845 (0.8670) lr 1.3090e-03 eta 0:12:50
epoch [22/50] batch [260/319] time 0.082 (0.085) data 0.000 (0.002) loss 1.5043 (1.4568) ce_loss 1.4893 (1.3225) teacher_loss 0.7733 (0.7847) loss_zs_kd 0.4192 (0.4050) loss_oracle 0.5214 (0.4696) acc 37.5000 (49.4832) kd_loss 0.9072 (0.8683) lr 1.3090e-03 eta 0:12:45
epoch [22/50] batch [280/319] time 0.081 (0.084) data 0.000 (0.002) loss 1.1994 (1.4530) ce_loss 1.1211 (1.3199) teacher_loss 0.4314 (0.7805) loss_zs_kd 0.4480 (0.4060) loss_oracle 0.5440 (0.4696) acc 53.1250 (49.7210) kd_loss 0.9591 (0.8703) lr 1.3090e-03 eta 0:12:37
epoch [22/50] batch [300/319] time 0.084 (0.084) data 0.000 (0.002) loss 1.5435 (1.4554) ce_loss 1.4150 (1.3226) teacher_loss 0.8225 (0.7783) loss_zs_kd 0.5024 (0.4087) loss_oracle 0.4698 (0.4727) acc 50.0000 (49.5312) kd_loss 0.8810 (0.8728) lr 1.3090e-03 eta 0:12:33
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,167
* accuracy: 49.5%
* error: 50.5%
* macro_f1: 39.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,800
* accuracy: 39.0%
* error: 61.0%
* macro_f1: 15.5%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [23/50] batch [20/319] time 0.080 (0.118) data 0.000 (0.033) loss 1.6968 (1.4258) ce_loss 1.4775 (1.3445) teacher_loss 0.9610 (0.7163) loss_zs_kd 0.3966 (0.4293) loss_oracle 0.5375 (0.4949) acc 40.6250 (47.1875) kd_loss 0.8160 (0.9086) lr 1.2487e-03 eta 0:17:29
epoch [23/50] batch [40/319] time 0.074 (0.098) data 0.000 (0.017) loss 1.4794 (1.4340) ce_loss 1.3955 (1.3493) teacher_loss 0.6916 (0.7268) loss_zs_kd 0.4655 (0.4202) loss_oracle 0.5550 (0.4970) acc 53.1250 (47.8906) kd_loss 0.9375 (0.9125) lr 1.2487e-03 eta 0:14:27
epoch [23/50] batch [60/319] time 0.085 (0.092) data 0.000 (0.011) loss 1.5708 (1.4227) ce_loss 1.3828 (1.3365) teacher_loss 0.8678 (0.7119) loss_zs_kd 0.4778 (0.4272) loss_oracle 0.4641 (0.4972) acc 43.7500 (49.3229) kd_loss 0.8232 (0.9182) lr 1.2487e-03 eta 0:13:36
epoch [23/50] batch [80/319] time 0.078 (0.089) data 0.000 (0.008) loss 1.3932 (1.4237) ce_loss 1.3096 (1.3327) teacher_loss 0.6434 (0.7139) loss_zs_kd 0.4348 (0.4274) loss_oracle 0.5325 (0.4961) acc 50.0000 (49.4922) kd_loss 0.8790 (0.9133) lr 1.2487e-03 eta 0:13:10
epoch [23/50] batch [100/319] time 0.074 (0.088) data 0.000 (0.007) loss 1.4687 (1.4340) ce_loss 1.3877 (1.3399) teacher_loss 0.7348 (0.7203) loss_zs_kd 0.4396 (0.4313) loss_oracle 0.5142 (0.4981) acc 56.2500 (49.2500) kd_loss 1.0166 (0.9092) lr 1.2487e-03 eta 0:12:56
epoch [23/50] batch [120/319] time 0.083 (0.087) data 0.000 (0.006) loss 1.4614 (1.4318) ce_loss 1.3145 (1.3330) teacher_loss 0.7518 (0.7216) loss_zs_kd 0.3844 (0.4284) loss_oracle 0.5173 (0.4959) acc 50.0000 (49.3229) kd_loss 0.9061 (0.9074) lr 1.2487e-03 eta 0:12:43
epoch [23/50] batch [140/319] time 0.078 (0.086) data 0.000 (0.005) loss 1.3481 (1.4313) ce_loss 1.4258 (1.3339) teacher_loss 0.5808 (0.7229) loss_zs_kd 0.3948 (0.4269) loss_oracle 0.5699 (0.4950) acc 40.6250 (49.3973) kd_loss 0.9373 (0.9051) lr 1.2487e-03 eta 0:12:38
epoch [23/50] batch [160/319] time 0.083 (0.086) data 0.000 (0.004) loss 1.3379 (1.4386) ce_loss 1.1240 (1.3429) teacher_loss 0.5795 (0.7273) loss_zs_kd 0.4782 (0.4280) loss_oracle 0.5194 (0.4972) acc 56.2500 (49.1602) kd_loss 0.8769 (0.9061) lr 1.2487e-03 eta 0:12:35
epoch [23/50] batch [180/319] time 0.081 (0.086) data 0.000 (0.004) loss 1.4430 (1.4391) ce_loss 1.4756 (1.3441) teacher_loss 0.7806 (0.7281) loss_zs_kd 0.4332 (0.4295) loss_oracle 0.4458 (0.4963) acc 43.7500 (49.2014) kd_loss 0.8645 (0.9065) lr 1.2487e-03 eta 0:12:34
epoch [23/50] batch [200/319] time 0.084 (0.086) data 0.000 (0.004) loss 1.0633 (1.4391) ce_loss 0.9609 (1.3440) teacher_loss 0.4549 (0.7293) loss_zs_kd 0.3227 (0.4307) loss_oracle 0.4470 (0.4945) acc 59.3750 (49.1562) kd_loss 0.8551 (0.9063) lr 1.2487e-03 eta 0:12:27
epoch [23/50] batch [220/319] time 0.083 (0.086) data 0.000 (0.003) loss 1.5889 (1.4407) ce_loss 1.5508 (1.3466) teacher_loss 0.7939 (0.7305) loss_zs_kd 0.4700 (0.4309) loss_oracle 0.5601 (0.4948) acc 46.8750 (49.0341) kd_loss 0.9612 (0.9077) lr 1.2487e-03 eta 0:12:25
epoch [23/50] batch [240/319] time 0.074 (0.085) data 0.000 (0.003) loss 1.2970 (1.4449) ce_loss 1.4561 (1.3521) teacher_loss 0.5853 (0.7351) loss_zs_kd 0.4178 (0.4306) loss_oracle 0.5028 (0.4945) acc 46.8750 (49.1927) kd_loss 0.9247 (0.9070) lr 1.2487e-03 eta 0:12:19
epoch [23/50] batch [260/319] time 0.082 (0.085) data 0.000 (0.003) loss 1.4337 (1.4452) ce_loss 1.4082 (1.3525) teacher_loss 0.7069 (0.7347) loss_zs_kd 0.4386 (0.4319) loss_oracle 0.5075 (0.4946) acc 40.6250 (49.3149) kd_loss 0.9149 (0.9076) lr 1.2487e-03 eta 0:12:15
epoch [23/50] batch [280/319] time 0.088 (0.085) data 0.000 (0.003) loss 1.2781 (1.4442) ce_loss 1.2568 (1.3519) teacher_loss 0.5636 (0.7342) loss_zs_kd 0.4512 (0.4327) loss_oracle 0.4889 (0.4936) acc 50.0000 (49.3527) kd_loss 0.9393 (0.9068) lr 1.2487e-03 eta 0:12:13
epoch [23/50] batch [300/319] time 0.084 (0.085) data 0.000 (0.002) loss 1.4818 (1.4425) ce_loss 1.4258 (1.3524) teacher_loss 0.7724 (0.7334) loss_zs_kd 0.4436 (0.4317) loss_oracle 0.4876 (0.4932) acc 46.8750 (49.4375) kd_loss 0.9595 (0.9069) lr 1.2487e-03 eta 0:12:10
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,094
* accuracy: 47.8%
* error: 52.2%
* macro_f1: 37.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,602
* accuracy: 37.0%
* error: 63.0%
* macro_f1: 14.8%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [24/50] batch [20/319] time 0.085 (0.109) data 0.000 (0.025) loss 1.3733 (1.4755) ce_loss 1.3105 (1.3989) teacher_loss 0.6539 (0.7845) loss_zs_kd 0.4777 (0.4343) loss_oracle 0.4806 (0.4739) acc 50.0000 (47.9688) kd_loss 0.9888 (0.9094) lr 1.1874e-03 eta 0:15:40
epoch [24/50] batch [40/319] time 0.074 (0.094) data 0.000 (0.013) loss 1.7953 (1.4531) ce_loss 1.5166 (1.3794) teacher_loss 1.1443 (0.7598) loss_zs_kd 0.3638 (0.4257) loss_oracle 0.4692 (0.4805) acc 46.8750 (48.6719) kd_loss 0.7717 (0.9178) lr 1.1874e-03 eta 0:13:25
epoch [24/50] batch [60/319] time 0.082 (0.089) data 0.001 (0.008) loss 1.5973 (1.4665) ce_loss 1.4785 (1.3908) teacher_loss 0.8834 (0.7831) loss_zs_kd 0.4856 (0.4172) loss_oracle 0.4711 (0.4748) acc 40.6250 (47.8646) kd_loss 0.8250 (0.9063) lr 1.1874e-03 eta 0:12:41
epoch [24/50] batch [80/319] time 0.082 (0.087) data 0.000 (0.006) loss 1.5110 (1.4551) ce_loss 1.5098 (1.3814) teacher_loss 0.7270 (0.7697) loss_zs_kd 0.5347 (0.4185) loss_oracle 0.5166 (0.4762) acc 43.7500 (48.5547) kd_loss 0.8671 (0.9075) lr 1.1874e-03 eta 0:12:21
epoch [24/50] batch [100/319] time 0.083 (0.086) data 0.000 (0.005) loss 1.7753 (1.4522) ce_loss 1.6729 (1.3696) teacher_loss 0.9744 (0.7616) loss_zs_kd 0.4947 (0.4208) loss_oracle 0.5536 (0.4802) acc 34.3750 (48.6250) kd_loss 0.9106 (0.9094) lr 1.1874e-03 eta 0:12:13
epoch [24/50] batch [120/319] time 0.078 (0.086) data 0.000 (0.004) loss 1.4034 (1.4573) ce_loss 1.2998 (1.3772) teacher_loss 0.7820 (0.7671) loss_zs_kd 0.4538 (0.4215) loss_oracle 0.3945 (0.4794) acc 59.3750 (48.1510) kd_loss 0.8855 (0.9103) lr 1.1874e-03 eta 0:12:08
epoch [24/50] batch [140/319] time 0.084 (0.086) data 0.000 (0.004) loss 1.4346 (1.4543) ce_loss 1.1865 (1.3743) teacher_loss 0.6852 (0.7648) loss_zs_kd 0.4525 (0.4175) loss_oracle 0.5232 (0.4808) acc 59.3750 (48.6384) kd_loss 1.0641 (0.9134) lr 1.1874e-03 eta 0:12:04
epoch [24/50] batch [160/319] time 0.093 (0.085) data 0.000 (0.003) loss 1.5177 (1.4486) ce_loss 1.5303 (1.3660) teacher_loss 0.7249 (0.7553) loss_zs_kd 0.3909 (0.4181) loss_oracle 0.5974 (0.4843) acc 34.3750 (49.0430) kd_loss 0.8717 (0.9160) lr 1.1874e-03 eta 0:12:00
epoch [24/50] batch [180/319] time 0.081 (0.085) data 0.000 (0.003) loss 1.6023 (1.4545) ce_loss 1.6436 (1.3685) teacher_loss 0.8470 (0.7563) loss_zs_kd 0.3946 (0.4205) loss_oracle 0.5580 (0.4879) acc 43.7500 (48.8194) kd_loss 0.9668 (0.9194) lr 1.1874e-03 eta 0:11:58
epoch [24/50] batch [200/319] time 0.084 (0.085) data 0.000 (0.003) loss 1.4777 (1.4516) ce_loss 1.3086 (1.3648) teacher_loss 0.6597 (0.7501) loss_zs_kd 0.4248 (0.4222) loss_oracle 0.6057 (0.4904) acc 53.1250 (49.0625) kd_loss 1.0141 (0.9212) lr 1.1874e-03 eta 0:11:56
epoch [24/50] batch [220/319] time 0.092 (0.085) data 0.000 (0.003) loss 1.4940 (1.4501) ce_loss 1.2500 (1.3638) teacher_loss 0.7987 (0.7478) loss_zs_kd 0.4200 (0.4230) loss_oracle 0.4853 (0.4908) acc 46.8750 (49.1051) kd_loss 0.9086 (0.9239) lr 1.1874e-03 eta 0:11:53
epoch [24/50] batch [240/319] time 0.080 (0.085) data 0.000 (0.002) loss 1.5648 (1.4487) ce_loss 1.4941 (1.3601) teacher_loss 0.8938 (0.7458) loss_zs_kd 0.4759 (0.4238) loss_oracle 0.4330 (0.4910) acc 37.5000 (49.1276) kd_loss 0.8733 (0.9227) lr 1.1874e-03 eta 0:11:49
epoch [24/50] batch [260/319] time 0.083 (0.085) data 0.000 (0.002) loss 1.6586 (1.4504) ce_loss 1.7012 (1.3633) teacher_loss 0.8954 (0.7457) loss_zs_kd 0.3907 (0.4238) loss_oracle 0.5679 (0.4929) acc 40.6250 (49.2428) kd_loss 0.8961 (0.9214) lr 1.1874e-03 eta 0:11:47
epoch [24/50] batch [280/319] time 0.078 (0.084) data 0.000 (0.002) loss 1.5003 (1.4512) ce_loss 1.4072 (1.3645) teacher_loss 0.8044 (0.7462) loss_zs_kd 0.4183 (0.4244) loss_oracle 0.4867 (0.4928) acc 34.3750 (49.2188) kd_loss 0.8443 (0.9194) lr 1.1874e-03 eta 0:11:43
epoch [24/50] batch [300/319] time 0.082 (0.084) data 0.000 (0.002) loss 1.2642 (1.4476) ce_loss 1.1816 (1.3640) teacher_loss 0.5829 (0.7450) loss_zs_kd 0.4306 (0.4230) loss_oracle 0.4660 (0.4911) acc 53.1250 (49.3021) kd_loss 0.9823 (0.9208) lr 1.1874e-03 eta 0:11:41
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,196
* accuracy: 50.2%
* error: 49.8%
* macro_f1: 37.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,743
* accuracy: 38.4%
* error: 61.6%
* macro_f1: 15.1%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [25/50] batch [20/319] time 0.078 (0.117) data 0.000 (0.031) loss 1.3937 (1.4597) ce_loss 1.3564 (1.3910) teacher_loss 0.7261 (0.7485) loss_zs_kd 0.4231 (0.4213) loss_oracle 0.4561 (0.5005) acc 53.1250 (50.3125) kd_loss 0.9016 (0.9209) lr 1.1253e-03 eta 0:16:10
epoch [25/50] batch [40/319] time 0.087 (0.099) data 0.000 (0.016) loss 1.4763 (1.4616) ce_loss 1.3594 (1.3892) teacher_loss 0.8524 (0.7652) loss_zs_kd 0.4116 (0.4143) loss_oracle 0.4180 (0.4893) acc 43.7500 (49.4531) kd_loss 0.9247 (0.9192) lr 1.1253e-03 eta 0:13:35
epoch [25/50] batch [60/319] time 0.087 (0.094) data 0.000 (0.010) loss 1.5732 (1.4508) ce_loss 1.7070 (1.3871) teacher_loss 0.7871 (0.7582) loss_zs_kd 0.4650 (0.4144) loss_oracle 0.5536 (0.4854) acc 34.3750 (48.9062) kd_loss 1.0315 (0.9127) lr 1.1253e-03 eta 0:12:54
epoch [25/50] batch [80/319] time 0.080 (0.092) data 0.000 (0.008) loss 1.3696 (1.4489) ce_loss 1.1260 (1.3815) teacher_loss 0.6724 (0.7559) loss_zs_kd 0.4197 (0.4156) loss_oracle 0.4874 (0.4852) acc 56.2500 (49.1797) kd_loss 0.9227 (0.9143) lr 1.1253e-03 eta 0:12:32
epoch [25/50] batch [100/319] time 0.093 (0.089) data 0.000 (0.006) loss 1.6857 (1.4394) ce_loss 1.4150 (1.3642) teacher_loss 0.9471 (0.7489) loss_zs_kd 0.4370 (0.4135) loss_oracle 0.5201 (0.4837) acc 53.1250 (49.8125) kd_loss 0.8367 (0.9194) lr 1.1253e-03 eta 0:12:09
epoch [25/50] batch [120/319] time 0.086 (0.088) data 0.000 (0.005) loss 1.4025 (1.4450) ce_loss 1.3682 (1.3722) teacher_loss 0.6786 (0.7569) loss_zs_kd 0.4843 (0.4116) loss_oracle 0.4817 (0.4823) acc 53.1250 (49.6615) kd_loss 0.9532 (0.9197) lr 1.1253e-03 eta 0:12:00
epoch [25/50] batch [140/319] time 0.081 (0.088) data 0.000 (0.005) loss 1.3756 (1.4401) ce_loss 1.4883 (1.3705) teacher_loss 0.5851 (0.7549) loss_zs_kd 0.4561 (0.4097) loss_oracle 0.5624 (0.4804) acc 46.8750 (49.6875) kd_loss 0.9964 (0.9207) lr 1.1253e-03 eta 0:11:54
epoch [25/50] batch [160/319] time 0.083 (0.087) data 0.000 (0.004) loss 1.5440 (1.4397) ce_loss 1.5498 (1.3752) teacher_loss 0.8332 (0.7550) loss_zs_kd 0.4385 (0.4111) loss_oracle 0.4916 (0.4792) acc 34.3750 (49.5508) kd_loss 0.8562 (0.9199) lr 1.1253e-03 eta 0:11:49
epoch [25/50] batch [180/319] time 0.091 (0.087) data 0.000 (0.004) loss 1.3040 (1.4349) ce_loss 1.2832 (1.3731) teacher_loss 0.6973 (0.7537) loss_zs_kd 0.3890 (0.4103) loss_oracle 0.4122 (0.4760) acc 46.8750 (49.5139) kd_loss 0.8643 (0.9199) lr 1.1253e-03 eta 0:11:45
epoch [25/50] batch [200/319] time 0.078 (0.087) data 0.000 (0.003) loss 1.4690 (1.4329) ce_loss 1.3799 (1.3695) teacher_loss 0.7886 (0.7497) loss_zs_kd 0.4312 (0.4128) loss_oracle 0.4647 (0.4767) acc 40.6250 (49.4844) kd_loss 0.8845 (0.9208) lr 1.1253e-03 eta 0:11:40
epoch [25/50] batch [220/319] time 0.082 (0.086) data 0.000 (0.003) loss 1.3970 (1.4349) ce_loss 1.3105 (1.3734) teacher_loss 0.6565 (0.7513) loss_zs_kd 0.4080 (0.4126) loss_oracle 0.5365 (0.4772) acc 50.0000 (49.3608) kd_loss 1.0218 (0.9217) lr 1.1253e-03 eta 0:11:37
epoch [25/50] batch [240/319] time 0.090 (0.086) data 0.000 (0.003) loss 1.5631 (1.4301) ce_loss 1.4844 (1.3677) teacher_loss 0.9065 (0.7458) loss_zs_kd 0.4517 (0.4143) loss_oracle 0.4307 (0.4772) acc 31.2500 (49.3359) kd_loss 0.8330 (0.9223) lr 1.1253e-03 eta 0:11:34
epoch [25/50] batch [260/319] time 0.084 (0.086) data 0.000 (0.003) loss 1.5250 (1.4311) ce_loss 1.5059 (1.3686) teacher_loss 0.7844 (0.7463) loss_zs_kd 0.4625 (0.4152) loss_oracle 0.5093 (0.4773) acc 40.6250 (49.2668) kd_loss 0.8950 (0.9218) lr 1.1253e-03 eta 0:11:32
epoch [25/50] batch [280/319] time 0.083 (0.086) data 0.000 (0.002) loss 1.5593 (1.4304) ce_loss 1.4316 (1.3688) teacher_loss 0.8926 (0.7457) loss_zs_kd 0.4296 (0.4153) loss_oracle 0.4519 (0.4770) acc 59.3750 (49.2857) kd_loss 0.9068 (0.9200) lr 1.1253e-03 eta 0:11:30
epoch [25/50] batch [300/319] time 0.078 (0.086) data 0.000 (0.002) loss 1.4367 (1.4310) ce_loss 1.4941 (1.3706) teacher_loss 0.8036 (0.7487) loss_zs_kd 0.3574 (0.4137) loss_oracle 0.4544 (0.4755) acc 56.2500 (49.4062) kd_loss 0.8980 (0.9199) lr 1.1253e-03 eta 0:11:26
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,178
* accuracy: 49.7%
* error: 50.3%
* macro_f1: 37.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,860
* accuracy: 39.6%
* error: 60.4%
* macro_f1: 15.0%
******* Domain 2 best val acc:      51.1%, epoch: 6 *******
******* Domain 2 best val test acc: 43.5%, epoch: 6 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [26/50] batch [20/319] time 0.081 (0.111) data 0.000 (0.024) loss 1.4323 (1.4919) ce_loss 1.3975 (1.4297) teacher_loss 0.8585 (0.7991) loss_zs_kd 0.3538 (0.4191) loss_oracle 0.3970 (0.4833) acc 50.0000 (47.5000) kd_loss 0.8658 (0.8917) lr 1.0628e-03 eta 0:14:45
epoch [26/50] batch [40/319] time 0.092 (0.098) data 0.000 (0.012) loss 1.4073 (1.4539) ce_loss 1.2158 (1.4110) teacher_loss 0.7379 (0.7632) loss_zs_kd 0.4302 (0.4112) loss_oracle 0.4544 (0.4851) acc 53.1250 (47.5781) kd_loss 0.9377 (0.9015) lr 1.0628e-03 eta 0:12:54
epoch [26/50] batch [60/319] time 0.083 (0.093) data 0.000 (0.008) loss 1.4124 (1.4364) ce_loss 1.3359 (1.3876) teacher_loss 0.7339 (0.7423) loss_zs_kd 0.3855 (0.4148) loss_oracle 0.4858 (0.4867) acc 50.0000 (48.9062) kd_loss 0.8720 (0.9083) lr 1.0628e-03 eta 0:12:15
epoch [26/50] batch [80/319] time 0.083 (0.091) data 0.000 (0.006) loss 1.5590 (1.4418) ce_loss 1.4404 (1.3956) teacher_loss 0.8111 (0.7464) loss_zs_kd 0.4901 (0.4165) loss_oracle 0.5028 (0.4871) acc 56.2500 (48.5547) kd_loss 0.9825 (0.9100) lr 1.0628e-03 eta 0:11:57
epoch [26/50] batch [100/319] time 0.082 (0.089) data 0.000 (0.005) loss 1.3099 (1.4392) ce_loss 1.2598 (1.3917) teacher_loss 0.5887 (0.7425) loss_zs_kd 0.4306 (0.4206) loss_oracle 0.5059 (0.4864) acc 56.2500 (49.0312) kd_loss 0.9121 (0.9086) lr 1.0628e-03 eta 0:11:43
epoch [26/50] batch [120/319] time 0.083 (0.088) data 0.001 (0.004) loss 1.5136 (1.4339) ce_loss 1.3721 (1.3812) teacher_loss 0.8771 (0.7424) loss_zs_kd 0.4055 (0.4188) loss_oracle 0.4337 (0.4820) acc 40.6250 (49.5833) kd_loss 0.8701 (0.9053) lr 1.0628e-03 eta 0:11:28
epoch [26/50] batch [140/319] time 0.078 (0.087) data 0.000 (0.004) loss 1.4224 (1.4278) ce_loss 1.4951 (1.3723) teacher_loss 0.8080 (0.7425) loss_zs_kd 0.3870 (0.4144) loss_oracle 0.4208 (0.4781) acc 43.7500 (49.6875) kd_loss 0.8977 (0.9028) lr 1.0628e-03 eta 0:11:20
epoch [26/50] batch [160/319] time 0.082 (0.086) data 0.000 (0.003) loss 1.1830 (1.4229) ce_loss 1.1182 (1.3640) teacher_loss 0.5493 (0.7413) loss_zs_kd 0.4034 (0.4109) loss_oracle 0.4320 (0.4761) acc 62.5000 (49.6094) kd_loss 0.8833 (0.9010) lr 1.0628e-03 eta 0:11:14
epoch [26/50] batch [180/319] time 0.082 (0.086) data 0.000 (0.003) loss 1.2914 (1.4245) ce_loss 1.2656 (1.3609) teacher_loss 0.6689 (0.7447) loss_zs_kd 0.3748 (0.4098) loss_oracle 0.4350 (0.4749) acc 59.3750 (49.5660) kd_loss 0.9309 (0.8985) lr 1.0628e-03 eta 0:11:12
epoch [26/50] batch [200/319] time 0.082 (0.086) data 0.000 (0.003) loss 1.7554 (1.4262) ce_loss 1.4551 (1.3609) teacher_loss 1.0607 (0.7468) loss_zs_kd 0.3770 (0.4089) loss_oracle 0.5062 (0.4749) acc 43.7500 (49.5469) kd_loss 0.8227 (0.8976) lr 1.0628e-03 eta 0:11:11
epoch [26/50] batch [220/319] time 0.078 (0.086) data 0.000 (0.002) loss 1.2126 (1.4310) ce_loss 1.0605 (1.3610) teacher_loss 0.6488 (0.7500) loss_zs_kd 0.2965 (0.4095) loss_oracle 0.4155 (0.4763) acc 62.5000 (49.4318) kd_loss 0.9182 (0.8965) lr 1.0628e-03 eta 0:11:08
epoch [26/50] batch [240/319] time 0.082 (0.086) data 0.000 (0.002) loss 1.4096 (1.4317) ce_loss 1.2588 (1.3611) teacher_loss 0.7992 (0.7536) loss_zs_kd 0.3907 (0.4063) loss_oracle 0.4151 (0.4749) acc 65.6250 (49.5052) kd_loss 0.8800 (0.8951) lr 1.0628e-03 eta 0:11:04
epoch [26/50] batch [260/319] time 0.080 (0.086) data 0.000 (0.002) loss 1.2910 (1.4330) ce_loss 1.1660 (1.3611) teacher_loss 0.7119 (0.7539) loss_zs_kd 0.3659 (0.4054) loss_oracle 0.3962 (0.4764) acc 56.2500 (49.5913) kd_loss 0.8205 (0.8939) lr 1.0628e-03 eta 0:11:00
epoch [26/50] batch [280/319] time 0.079 (0.086) data 0.000 (0.002) loss 1.3417 (1.4368) ce_loss 1.1328 (1.3628) teacher_loss 0.7462 (0.7580) loss_zs_kd 0.3581 (0.4053) loss_oracle 0.4164 (0.4761) acc 62.5000 (49.5871) kd_loss 0.7857 (0.8912) lr 1.0628e-03 eta 0:10:58
epoch [26/50] batch [300/319] time 0.086 (0.085) data 0.000 (0.002) loss 1.8824 (1.4407) ce_loss 1.9336 (1.3652) teacher_loss 1.2120 (0.7626) loss_zs_kd 0.3938 (0.4038) loss_oracle 0.4735 (0.4762) acc 31.2500 (49.4479) kd_loss 0.8978 (0.8899) lr 1.0628e-03 eta 0:10:52
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,265
* accuracy: 51.7%
* error: 48.3%
* macro_f1: 39.4%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,877
* accuracy: 39.8%
* error: 60.2%
* macro_f1: 15.0%
******* Domain 2 best val acc:      51.7%, epoch: 26 *******
******* Domain 2 best val test acc: 39.8%, epoch: 26 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [27/50] batch [20/319] time 0.071 (0.110) data 0.000 (0.029) loss 1.1897 (1.4470) ce_loss 1.1748 (1.3550) teacher_loss 0.6318 (0.8019) loss_zs_kd 0.3247 (0.3726) loss_oracle 0.3955 (0.4587) acc 59.3750 (50.0000) kd_loss 0.8829 (0.8497) lr 1.0000e-03 eta 0:14:03
epoch [27/50] batch [40/319] time 0.084 (0.094) data 0.000 (0.015) loss 1.3297 (1.4485) ce_loss 1.3682 (1.3660) teacher_loss 0.5967 (0.7968) loss_zs_kd 0.4318 (0.3808) loss_oracle 0.5171 (0.4614) acc 56.2500 (49.9219) kd_loss 0.9262 (0.8581) lr 1.0000e-03 eta 0:11:57
epoch [27/50] batch [60/319] time 0.080 (0.089) data 0.000 (0.010) loss 1.4252 (1.4252) ce_loss 1.1426 (1.3386) teacher_loss 0.7331 (0.7684) loss_zs_kd 0.4505 (0.3897) loss_oracle 0.4669 (0.4619) acc 62.5000 (51.3542) kd_loss 0.8005 (0.8601) lr 1.0000e-03 eta 0:11:17
epoch [27/50] batch [80/319] time 0.080 (0.087) data 0.000 (0.007) loss 1.5807 (1.4220) ce_loss 1.5752 (1.3302) teacher_loss 0.9251 (0.7637) loss_zs_kd 0.4287 (0.3879) loss_oracle 0.4413 (0.4643) acc 43.7500 (51.8750) kd_loss 0.8590 (0.8667) lr 1.0000e-03 eta 0:11:02
epoch [27/50] batch [100/319] time 0.083 (0.085) data 0.000 (0.006) loss 1.4507 (1.4268) ce_loss 1.3486 (1.3286) teacher_loss 0.7507 (0.7631) loss_zs_kd 0.4007 (0.3892) loss_oracle 0.4996 (0.4690) acc 53.1250 (51.4375) kd_loss 0.9159 (0.8693) lr 1.0000e-03 eta 0:10:44
epoch [27/50] batch [120/319] time 0.083 (0.085) data 0.000 (0.005) loss 1.3771 (1.4293) ce_loss 1.1387 (1.3357) teacher_loss 0.7271 (0.7634) loss_zs_kd 0.4516 (0.3947) loss_oracle 0.4242 (0.4686) acc 62.5000 (51.3542) kd_loss 0.8889 (0.8746) lr 1.0000e-03 eta 0:10:41
epoch [27/50] batch [140/319] time 0.070 (0.084) data 0.001 (0.004) loss 1.2805 (1.4269) ce_loss 1.2334 (1.3370) teacher_loss 0.6506 (0.7612) loss_zs_kd 0.3761 (0.3960) loss_oracle 0.4418 (0.4677) acc 53.1250 (51.1384) kd_loss 0.9370 (0.8745) lr 1.0000e-03 eta 0:10:32
epoch [27/50] batch [160/319] time 0.076 (0.083) data 0.000 (0.004) loss 1.2203 (1.4249) ce_loss 1.0527 (1.3406) teacher_loss 0.5866 (0.7560) loss_zs_kd 0.4127 (0.3987) loss_oracle 0.4274 (0.4695) acc 62.5000 (51.2109) kd_loss 0.9405 (0.8776) lr 1.0000e-03 eta 0:10:23
epoch [27/50] batch [180/319] time 0.066 (0.083) data 0.000 (0.003) loss 1.1839 (1.4264) ce_loss 1.0244 (1.3449) teacher_loss 0.5694 (0.7579) loss_zs_kd 0.3928 (0.3995) loss_oracle 0.4181 (0.4688) acc 65.6250 (50.9201) kd_loss 0.9237 (0.8797) lr 1.0000e-03 eta 0:10:16
epoch [27/50] batch [200/319] time 0.072 (0.082) data 0.000 (0.003) loss 1.2420 (1.4271) ce_loss 1.2852 (1.3477) teacher_loss 0.5558 (0.7555) loss_zs_kd 0.4637 (0.4022) loss_oracle 0.4544 (0.4704) acc 53.1250 (50.8750) kd_loss 0.9793 (0.8828) lr 1.0000e-03 eta 0:10:13
epoch [27/50] batch [220/319] time 0.081 (0.082) data 0.001 (0.003) loss 1.4110 (1.4249) ce_loss 1.3369 (1.3480) teacher_loss 0.7658 (0.7519) loss_zs_kd 0.4471 (0.4048) loss_oracle 0.4217 (0.4706) acc 43.7500 (50.7812) kd_loss 0.8557 (0.8855) lr 1.0000e-03 eta 0:10:09
epoch [27/50] batch [240/319] time 0.075 (0.082) data 0.000 (0.003) loss 1.4814 (1.4291) ce_loss 1.5635 (1.3561) teacher_loss 0.7959 (0.7519) loss_zs_kd 0.4377 (0.4071) loss_oracle 0.4666 (0.4737) acc 46.8750 (50.5078) kd_loss 0.8503 (0.8878) lr 1.0000e-03 eta 0:10:05
epoch [27/50] batch [260/319] time 0.079 (0.081) data 0.000 (0.002) loss 1.4303 (1.4280) ce_loss 1.3623 (1.3551) teacher_loss 0.6735 (0.7516) loss_zs_kd 0.4353 (0.4068) loss_oracle 0.5391 (0.4729) acc 53.1250 (50.5529) kd_loss 0.8645 (0.8886) lr 1.0000e-03 eta 0:10:01
epoch [27/50] batch [280/319] time 0.087 (0.081) data 0.000 (0.002) loss 1.6823 (1.4299) ce_loss 1.5576 (1.3572) teacher_loss 0.9789 (0.7540) loss_zs_kd 0.4658 (0.4073) loss_oracle 0.4705 (0.4723) acc 37.5000 (50.4576) kd_loss 0.8470 (0.8888) lr 1.0000e-03 eta 0:09:59
epoch [27/50] batch [300/319] time 0.080 (0.081) data 0.000 (0.002) loss 1.7777 (1.4268) ce_loss 1.8037 (1.3553) teacher_loss 1.0894 (0.7512) loss_zs_kd 0.4975 (0.4071) loss_oracle 0.4395 (0.4721) acc 37.5000 (50.3229) kd_loss 0.8699 (0.8898) lr 1.0000e-03 eta 0:09:58
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,245
* accuracy: 51.3%
* error: 48.7%
* macro_f1: 39.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,039
* accuracy: 41.5%
* error: 58.5%
* macro_f1: 16.1%
******* Domain 2 best val acc:      51.7%, epoch: 26 *******
******* Domain 2 best val test acc: 39.8%, epoch: 26 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [28/50] batch [20/319] time 0.077 (0.111) data 0.000 (0.027) loss 1.4076 (1.3985) ce_loss 1.2402 (1.3376) teacher_loss 0.7317 (0.7227) loss_zs_kd 0.4252 (0.4225) loss_oracle 0.4633 (0.4646) acc 53.1250 (50.1562) kd_loss 0.8562 (0.9210) lr 9.3721e-04 eta 0:13:33
epoch [28/50] batch [40/319] time 0.085 (0.095) data 0.000 (0.014) loss 1.5623 (1.3985) ce_loss 1.4873 (1.3342) teacher_loss 0.8360 (0.7353) loss_zs_kd 0.4204 (0.4060) loss_oracle 0.5161 (0.4602) acc 50.0000 (51.0938) kd_loss 0.8979 (0.9169) lr 9.3721e-04 eta 0:11:33
epoch [28/50] batch [60/319] time 0.084 (0.090) data 0.001 (0.009) loss 1.3631 (1.4332) ce_loss 1.1777 (1.3521) teacher_loss 0.6822 (0.7630) loss_zs_kd 0.4495 (0.4085) loss_oracle 0.4561 (0.4659) acc 65.6250 (50.2083) kd_loss 0.9471 (0.9132) lr 9.3721e-04 eta 0:10:58
epoch [28/50] batch [80/319] time 0.079 (0.089) data 0.000 (0.007) loss 1.4567 (1.4185) ce_loss 1.4658 (1.3394) teacher_loss 0.8071 (0.7482) loss_zs_kd 0.3990 (0.4064) loss_oracle 0.4501 (0.4671) acc 46.8750 (50.8203) kd_loss 0.9450 (0.9163) lr 9.3721e-04 eta 0:10:46
epoch [28/50] batch [100/319] time 0.087 (0.088) data 0.000 (0.006) loss 1.4831 (1.4247) ce_loss 1.3936 (1.3486) teacher_loss 0.7565 (0.7548) loss_zs_kd 0.4490 (0.4058) loss_oracle 0.5021 (0.4671) acc 46.8750 (50.2500) kd_loss 0.8800 (0.9185) lr 9.3721e-04 eta 0:10:37
epoch [28/50] batch [120/319] time 0.089 (0.088) data 0.000 (0.005) loss 1.4379 (1.4160) ce_loss 1.3496 (1.3403) teacher_loss 0.8251 (0.7470) loss_zs_kd 0.4516 (0.4058) loss_oracle 0.3870 (0.4661) acc 43.7500 (50.3646) kd_loss 0.7693 (0.9140) lr 9.3721e-04 eta 0:10:31
epoch [28/50] batch [140/319] time 0.088 (0.087) data 0.000 (0.004) loss 1.4299 (1.4146) ce_loss 1.3662 (1.3428) teacher_loss 0.6862 (0.7472) loss_zs_kd 0.4142 (0.4052) loss_oracle 0.5366 (0.4647) acc 43.7500 (50.3125) kd_loss 0.9586 (0.9154) lr 9.3721e-04 eta 0:10:28
epoch [28/50] batch [160/319] time 0.089 (0.087) data 0.000 (0.004) loss 1.3704 (1.4133) ce_loss 0.9951 (1.3420) teacher_loss 0.6302 (0.7440) loss_zs_kd 0.4641 (0.4064) loss_oracle 0.5081 (0.4662) acc 53.1250 (50.2344) kd_loss 0.9091 (0.9146) lr 9.3721e-04 eta 0:10:25
epoch [28/50] batch [180/319] time 0.082 (0.087) data 0.000 (0.003) loss 1.3831 (1.4054) ce_loss 1.1621 (1.3310) teacher_loss 0.7285 (0.7375) loss_zs_kd 0.3741 (0.4047) loss_oracle 0.4677 (0.4656) acc 59.3750 (50.7118) kd_loss 0.8050 (0.9147) lr 9.3721e-04 eta 0:10:21
epoch [28/50] batch [200/319] time 0.082 (0.086) data 0.000 (0.003) loss 1.5475 (1.4100) ce_loss 1.6025 (1.3339) teacher_loss 0.9178 (0.7426) loss_zs_kd 0.3878 (0.4045) loss_oracle 0.4358 (0.4651) acc 40.6250 (50.7500) kd_loss 0.8661 (0.9134) lr 9.3721e-04 eta 0:10:16
epoch [28/50] batch [220/319] time 0.083 (0.086) data 0.000 (0.003) loss 1.5008 (1.4144) ce_loss 1.4209 (1.3435) teacher_loss 0.8926 (0.7460) loss_zs_kd 0.3896 (0.4042) loss_oracle 0.4134 (0.4663) acc 50.0000 (50.3693) kd_loss 0.9115 (0.9148) lr 9.3721e-04 eta 0:10:14
epoch [28/50] batch [240/319] time 0.083 (0.086) data 0.000 (0.003) loss 1.4193 (1.4151) ce_loss 1.1514 (1.3409) teacher_loss 0.6882 (0.7455) loss_zs_kd 0.4375 (0.4053) loss_oracle 0.5124 (0.4669) acc 59.3750 (50.5078) kd_loss 0.9685 (0.9152) lr 9.3721e-04 eta 0:10:10
epoch [28/50] batch [260/319] time 0.077 (0.086) data 0.000 (0.002) loss 1.3291 (1.4135) ce_loss 1.2539 (1.3422) teacher_loss 0.5473 (0.7433) loss_zs_kd 0.4532 (0.4066) loss_oracle 0.5552 (0.4669) acc 53.1250 (50.4567) kd_loss 1.0032 (0.9163) lr 9.3721e-04 eta 0:10:08
epoch [28/50] batch [280/319] time 0.091 (0.086) data 0.000 (0.002) loss 1.3994 (1.4146) ce_loss 1.4619 (1.3434) teacher_loss 0.7629 (0.7436) loss_zs_kd 0.3730 (0.4061) loss_oracle 0.4500 (0.4679) acc 40.6250 (50.4018) kd_loss 0.9126 (0.9185) lr 9.3721e-04 eta 0:10:05
epoch [28/50] batch [300/319] time 0.088 (0.086) data 0.000 (0.002) loss 1.4847 (1.4164) ce_loss 1.4688 (1.3445) teacher_loss 0.7878 (0.7450) loss_zs_kd 0.4346 (0.4058) loss_oracle 0.4796 (0.4685) acc 56.2500 (50.4688) kd_loss 0.8853 (0.9178) lr 9.3721e-04 eta 0:10:03
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,213
* accuracy: 50.5%
* error: 49.5%
* macro_f1: 38.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,741
* accuracy: 38.4%
* error: 61.6%
* macro_f1: 15.4%
******* Domain 2 best val acc:      51.7%, epoch: 26 *******
******* Domain 2 best val test acc: 39.8%, epoch: 26 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [29/50] batch [20/319] time 0.088 (0.121) data 0.000 (0.032) loss 1.6481 (1.3812) ce_loss 1.6670 (1.3196) teacher_loss 0.8970 (0.7287) loss_zs_kd 0.4307 (0.3934) loss_oracle 0.5358 (0.4558) acc 34.3750 (53.4375) kd_loss 0.8800 (0.9015) lr 8.7467e-04 eta 0:14:07
epoch [29/50] batch [40/319] time 0.090 (0.103) data 0.000 (0.016) loss 1.3299 (1.4041) ce_loss 1.4014 (1.3354) teacher_loss 0.7061 (0.7480) loss_zs_kd 0.3915 (0.3907) loss_oracle 0.4280 (0.4608) acc 56.2500 (52.1094) kd_loss 1.0108 (0.9171) lr 8.7467e-04 eta 0:12:01
epoch [29/50] batch [60/319] time 0.094 (0.098) data 0.002 (0.011) loss 1.3005 (1.4098) ce_loss 1.1641 (1.3406) teacher_loss 0.5977 (0.7447) loss_zs_kd 0.4067 (0.3951) loss_oracle 0.4995 (0.4675) acc 56.2500 (51.6146) kd_loss 0.9309 (0.9191) lr 8.7467e-04 eta 0:11:21
epoch [29/50] batch [80/319] time 0.088 (0.095) data 0.000 (0.008) loss 1.3558 (1.4135) ce_loss 1.2559 (1.3454) teacher_loss 0.7120 (0.7496) loss_zs_kd 0.4201 (0.3990) loss_oracle 0.4338 (0.4644) acc 46.8750 (51.0938) kd_loss 0.9288 (0.9147) lr 8.7467e-04 eta 0:10:56
epoch [29/50] batch [100/319] time 0.079 (0.093) data 0.000 (0.007) loss 1.5742 (1.4125) ce_loss 1.4492 (1.3471) teacher_loss 0.8895 (0.7511) loss_zs_kd 0.4066 (0.3977) loss_oracle 0.4814 (0.4625) acc 40.6250 (50.5312) kd_loss 0.8769 (0.9126) lr 8.7467e-04 eta 0:10:41
epoch [29/50] batch [120/319] time 0.084 (0.090) data 0.000 (0.006) loss 1.3269 (1.4113) ce_loss 1.3389 (1.3469) teacher_loss 0.7284 (0.7539) loss_zs_kd 0.3314 (0.3935) loss_oracle 0.4328 (0.4607) acc 56.2500 (50.6250) kd_loss 0.9391 (0.9087) lr 8.7467e-04 eta 0:10:22
epoch [29/50] batch [140/319] time 0.088 (0.089) data 0.000 (0.005) loss 1.5510 (1.4094) ce_loss 1.4824 (1.3436) teacher_loss 0.8839 (0.7549) loss_zs_kd 0.3840 (0.3911) loss_oracle 0.4752 (0.4590) acc 50.0000 (50.9598) kd_loss 0.9767 (0.9101) lr 8.7467e-04 eta 0:10:14
epoch [29/50] batch [160/319] time 0.080 (0.088) data 0.000 (0.004) loss 1.3576 (1.4179) ce_loss 1.3125 (1.3501) teacher_loss 0.7560 (0.7624) loss_zs_kd 0.3287 (0.3906) loss_oracle 0.4372 (0.4602) acc 53.1250 (50.5664) kd_loss 0.9710 (0.9064) lr 8.7467e-04 eta 0:10:06
epoch [29/50] batch [180/319] time 0.081 (0.088) data 0.000 (0.004) loss 1.4713 (1.4231) ce_loss 1.5547 (1.3547) teacher_loss 0.8396 (0.7652) loss_zs_kd 0.3524 (0.3907) loss_oracle 0.4555 (0.4626) acc 56.2500 (50.4340) kd_loss 0.8726 (0.9063) lr 8.7467e-04 eta 0:10:00
epoch [29/50] batch [200/319] time 0.083 (0.088) data 0.000 (0.003) loss 1.6289 (1.4300) ce_loss 1.5576 (1.3627) teacher_loss 0.8310 (0.7691) loss_zs_kd 0.4310 (0.3925) loss_oracle 0.5825 (0.4647) acc 43.7500 (50.2969) kd_loss 0.9299 (0.9049) lr 8.7467e-04 eta 0:09:57
epoch [29/50] batch [220/319] time 0.083 (0.087) data 0.000 (0.003) loss 1.7038 (1.4286) ce_loss 1.8008 (1.3619) teacher_loss 0.9713 (0.7680) loss_zs_kd 0.3907 (0.3909) loss_oracle 0.5371 (0.4651) acc 31.2500 (50.2273) kd_loss 0.7668 (0.9037) lr 8.7467e-04 eta 0:09:54
epoch [29/50] batch [240/319] time 0.089 (0.087) data 0.000 (0.003) loss 1.6196 (1.4300) ce_loss 1.2695 (1.3602) teacher_loss 1.0004 (0.7688) loss_zs_kd 0.4811 (0.3925) loss_oracle 0.3787 (0.4649) acc 56.2500 (50.4297) kd_loss 0.8352 (0.9030) lr 8.7467e-04 eta 0:09:49
epoch [29/50] batch [260/319] time 0.089 (0.087) data 0.000 (0.003) loss 1.4273 (1.4325) ce_loss 1.1953 (1.3627) teacher_loss 0.7245 (0.7709) loss_zs_kd 0.4186 (0.3922) loss_oracle 0.4935 (0.4655) acc 53.1250 (50.2404) kd_loss 0.9330 (0.9030) lr 8.7467e-04 eta 0:09:46
epoch [29/50] batch [280/319] time 0.084 (0.086) data 0.000 (0.003) loss 1.4253 (1.4338) ce_loss 1.5264 (1.3652) teacher_loss 0.6931 (0.7700) loss_zs_kd 0.3963 (0.3933) loss_oracle 0.5341 (0.4671) acc 34.3750 (49.9888) kd_loss 0.8856 (0.9042) lr 8.7467e-04 eta 0:09:41
epoch [29/50] batch [300/319] time 0.075 (0.086) data 0.000 (0.002) loss 1.4925 (1.4350) ce_loss 1.6387 (1.3662) teacher_loss 0.8012 (0.7703) loss_zs_kd 0.4482 (0.3930) loss_oracle 0.4672 (0.4681) acc 37.5000 (50.0312) kd_loss 0.9052 (0.9054) lr 8.7467e-04 eta 0:09:35
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,227
* accuracy: 50.9%
* error: 49.1%
* macro_f1: 39.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,682
* accuracy: 37.8%
* error: 62.2%
* macro_f1: 14.9%
******* Domain 2 best val acc:      51.7%, epoch: 26 *******
******* Domain 2 best val test acc: 39.8%, epoch: 26 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [30/50] batch [20/319] time 0.085 (0.114) data 0.000 (0.024) loss 1.2201 (1.4817) ce_loss 1.1006 (1.4241) teacher_loss 0.6318 (0.8123) loss_zs_kd 0.3816 (0.4009) loss_oracle 0.3975 (0.4690) acc 59.3750 (46.0938) kd_loss 0.8117 (0.8929) lr 8.1262e-04 eta 0:12:44
epoch [30/50] batch [40/319] time 0.078 (0.100) data 0.000 (0.012) loss 1.3273 (1.4700) ce_loss 1.3652 (1.4058) teacher_loss 0.6569 (0.7895) loss_zs_kd 0.4305 (0.4042) loss_oracle 0.4551 (0.4784) acc 56.2500 (48.2812) kd_loss 0.9336 (0.9134) lr 8.1262e-04 eta 0:11:04
epoch [30/50] batch [60/319] time 0.087 (0.095) data 0.000 (0.008) loss 1.4293 (1.4631) ce_loss 1.4736 (1.4001) teacher_loss 0.7177 (0.7771) loss_zs_kd 0.4212 (0.4083) loss_oracle 0.5010 (0.4818) acc 50.0000 (47.8646) kd_loss 0.9447 (0.9149) lr 8.1262e-04 eta 0:10:27
epoch [30/50] batch [80/319] time 0.082 (0.091) data 0.000 (0.006) loss 1.4935 (1.4635) ce_loss 1.4844 (1.3899) teacher_loss 0.7795 (0.7815) loss_zs_kd 0.3491 (0.4048) loss_oracle 0.5395 (0.4797) acc 43.7500 (48.1250) kd_loss 0.9693 (0.9200) lr 8.1262e-04 eta 0:10:04
epoch [30/50] batch [100/319] time 0.078 (0.089) data 0.000 (0.005) loss 1.4588 (1.4634) ce_loss 1.2236 (1.3878) teacher_loss 0.8000 (0.7792) loss_zs_kd 0.4227 (0.4043) loss_oracle 0.4475 (0.4820) acc 59.3750 (48.3125) kd_loss 0.9272 (0.9239) lr 8.1262e-04 eta 0:09:45
epoch [30/50] batch [120/319] time 0.090 (0.088) data 0.000 (0.004) loss 1.4974 (1.4643) ce_loss 1.3398 (1.3875) teacher_loss 0.8422 (0.7862) loss_zs_kd 0.3743 (0.4013) loss_oracle 0.4680 (0.4775) acc 53.1250 (48.6198) kd_loss 0.9064 (0.9227) lr 8.1262e-04 eta 0:09:39
epoch [30/50] batch [140/319] time 0.080 (0.087) data 0.000 (0.004) loss 1.1640 (1.4515) ce_loss 0.9702 (1.3746) teacher_loss 0.5345 (0.7762) loss_zs_kd 0.3776 (0.3991) loss_oracle 0.4408 (0.4757) acc 59.3750 (49.3304) kd_loss 0.9178 (0.9237) lr 8.1262e-04 eta 0:09:32
epoch [30/50] batch [160/319] time 0.086 (0.087) data 0.000 (0.003) loss 1.4140 (1.4457) ce_loss 1.4658 (1.3704) teacher_loss 0.7938 (0.7735) loss_zs_kd 0.3454 (0.3970) loss_oracle 0.4475 (0.4737) acc 43.7500 (49.4727) kd_loss 0.9034 (0.9230) lr 8.1262e-04 eta 0:09:28
epoch [30/50] batch [180/319] time 0.081 (0.087) data 0.000 (0.003) loss 1.4073 (1.4417) ce_loss 1.2871 (1.3654) teacher_loss 0.7797 (0.7728) loss_zs_kd 0.3988 (0.3945) loss_oracle 0.4282 (0.4716) acc 46.8750 (49.7222) kd_loss 0.9623 (0.9225) lr 8.1262e-04 eta 0:09:25
epoch [30/50] batch [200/319] time 0.085 (0.086) data 0.000 (0.003) loss 1.4968 (1.4363) ce_loss 1.3828 (1.3588) teacher_loss 0.7629 (0.7688) loss_zs_kd 0.3926 (0.3932) loss_oracle 0.5375 (0.4709) acc 46.8750 (49.8906) kd_loss 0.9723 (0.9249) lr 8.1262e-04 eta 0:09:21
epoch [30/50] batch [220/319] time 0.080 (0.086) data 0.000 (0.002) loss 1.2252 (1.4379) ce_loss 1.0605 (1.3580) teacher_loss 0.6025 (0.7691) loss_zs_kd 0.3534 (0.3948) loss_oracle 0.4460 (0.4714) acc 71.8750 (49.7017) kd_loss 0.9985 (0.9247) lr 8.1262e-04 eta 0:09:17
epoch [30/50] batch [240/319] time 0.086 (0.086) data 0.000 (0.002) loss 1.4177 (1.4442) ce_loss 1.1777 (1.3654) teacher_loss 0.6189 (0.7748) loss_zs_kd 0.3927 (0.3937) loss_oracle 0.6024 (0.4725) acc 46.8750 (49.3620) kd_loss 0.9823 (0.9244) lr 8.1262e-04 eta 0:09:15
epoch [30/50] batch [260/319] time 0.078 (0.086) data 0.000 (0.002) loss 1.4052 (1.4434) ce_loss 1.3096 (1.3656) teacher_loss 0.8444 (0.7764) loss_zs_kd 0.3445 (0.3922) loss_oracle 0.3886 (0.4708) acc 37.5000 (49.1346) kd_loss 0.7849 (0.9230) lr 8.1262e-04 eta 0:09:13
epoch [30/50] batch [280/319] time 0.081 (0.086) data 0.000 (0.002) loss 1.3915 (1.4397) ce_loss 1.3164 (1.3608) teacher_loss 0.7726 (0.7752) loss_zs_kd 0.3666 (0.3903) loss_oracle 0.4357 (0.4693) acc 46.8750 (49.3750) kd_loss 0.8700 (0.9246) lr 8.1262e-04 eta 0:09:10
epoch [30/50] batch [300/319] time 0.079 (0.086) data 0.000 (0.002) loss 1.6305 (1.4366) ce_loss 1.5469 (1.3567) teacher_loss 0.9790 (0.7741) loss_zs_kd 0.3937 (0.3899) loss_oracle 0.4547 (0.4676) acc 43.7500 (49.5312) kd_loss 0.8350 (0.9239) lr 8.1262e-04 eta 0:09:08
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,251
* accuracy: 51.4%
* error: 48.6%
* macro_f1: 40.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,743
* accuracy: 38.4%
* error: 61.6%
* macro_f1: 16.6%
******* Domain 2 best val acc:      51.7%, epoch: 26 *******
******* Domain 2 best val test acc: 39.8%, epoch: 26 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [31/50] batch [20/319] time 0.071 (0.116) data 0.000 (0.028) loss 1.3852 (1.3669) ce_loss 1.4727 (1.2508) teacher_loss 0.6679 (0.7358) loss_zs_kd 0.4080 (0.3854) loss_oracle 0.5133 (0.4384) acc 43.7500 (53.1250) kd_loss 1.0691 (0.9026) lr 7.5131e-04 eta 0:12:16
epoch [31/50] batch [40/319] time 0.082 (0.097) data 0.000 (0.014) loss 1.4296 (1.3918) ce_loss 1.3271 (1.3042) teacher_loss 0.8455 (0.7570) loss_zs_kd 0.3474 (0.3879) loss_oracle 0.4104 (0.4409) acc 53.1250 (52.1094) kd_loss 0.8690 (0.9211) lr 7.5131e-04 eta 0:10:15
epoch [31/50] batch [60/319] time 0.096 (0.093) data 0.001 (0.010) loss 1.3295 (1.4116) ce_loss 1.1387 (1.3220) teacher_loss 0.7589 (0.7824) loss_zs_kd 0.3748 (0.3896) loss_oracle 0.3832 (0.4344) acc 56.2500 (50.9375) kd_loss 1.0373 (0.9207) lr 7.5131e-04 eta 0:09:46
epoch [31/50] batch [80/319] time 0.086 (0.091) data 0.000 (0.007) loss 1.3644 (1.4110) ce_loss 1.6113 (1.3215) teacher_loss 0.7539 (0.7803) loss_zs_kd 0.3667 (0.3870) loss_oracle 0.4272 (0.4372) acc 37.5000 (50.9375) kd_loss 0.9771 (0.9205) lr 7.5131e-04 eta 0:09:31
epoch [31/50] batch [100/319] time 0.083 (0.089) data 0.001 (0.006) loss 1.5505 (1.4093) ce_loss 1.4346 (1.3193) teacher_loss 0.8145 (0.7727) loss_zs_kd 0.4307 (0.3887) loss_oracle 0.5207 (0.4423) acc 46.8750 (51.1875) kd_loss 0.8875 (0.9156) lr 7.5131e-04 eta 0:09:16
epoch [31/50] batch [120/319] time 0.087 (0.088) data 0.000 (0.005) loss 1.3359 (1.4173) ce_loss 1.2998 (1.3307) teacher_loss 0.6667 (0.7776) loss_zs_kd 0.3384 (0.3859) loss_oracle 0.5000 (0.4468) acc 50.0000 (50.5990) kd_loss 0.9118 (0.9222) lr 7.5131e-04 eta 0:09:07
epoch [31/50] batch [140/319] time 0.082 (0.087) data 0.000 (0.004) loss 1.3818 (1.4224) ce_loss 1.2598 (1.3399) teacher_loss 0.7779 (0.7808) loss_zs_kd 0.3567 (0.3879) loss_oracle 0.4256 (0.4477) acc 43.7500 (49.7545) kd_loss 1.0191 (0.9221) lr 7.5131e-04 eta 0:09:02
epoch [31/50] batch [160/319] time 0.084 (0.087) data 0.000 (0.004) loss 1.5336 (1.4271) ce_loss 1.4883 (1.3435) teacher_loss 0.9613 (0.7813) loss_zs_kd 0.3818 (0.3917) loss_oracle 0.3814 (0.4500) acc 40.6250 (49.6094) kd_loss 0.9015 (0.9231) lr 7.5131e-04 eta 0:08:58
epoch [31/50] batch [180/319] time 0.078 (0.086) data 0.000 (0.003) loss 1.6509 (1.4322) ce_loss 1.8516 (1.3518) teacher_loss 0.9554 (0.7869) loss_zs_kd 0.3523 (0.3904) loss_oracle 0.5194 (0.4501) acc 37.5000 (49.3924) kd_loss 0.9987 (0.9243) lr 7.5131e-04 eta 0:08:52
epoch [31/50] batch [200/319] time 0.081 (0.085) data 0.000 (0.003) loss 1.4391 (1.4363) ce_loss 1.4883 (1.3588) teacher_loss 0.7934 (0.7888) loss_zs_kd 0.4102 (0.3918) loss_oracle 0.4406 (0.4516) acc 50.0000 (49.1406) kd_loss 0.9260 (0.9267) lr 7.5131e-04 eta 0:08:46
epoch [31/50] batch [220/319] time 0.082 (0.085) data 0.000 (0.003) loss 1.2598 (1.4359) ce_loss 1.1533 (1.3577) teacher_loss 0.5814 (0.7879) loss_zs_kd 0.4531 (0.3916) loss_oracle 0.4519 (0.4521) acc 62.5000 (49.4318) kd_loss 0.9695 (0.9275) lr 7.5131e-04 eta 0:08:44
epoch [31/50] batch [240/319] time 0.090 (0.085) data 0.001 (0.003) loss 1.3334 (1.4365) ce_loss 1.2559 (1.3578) teacher_loss 0.8202 (0.7913) loss_zs_kd 0.3155 (0.3900) loss_oracle 0.3554 (0.4502) acc 53.1250 (49.3490) kd_loss 0.9602 (0.9282) lr 7.5131e-04 eta 0:08:42
epoch [31/50] batch [260/319] time 0.084 (0.085) data 0.000 (0.002) loss 1.5090 (1.4351) ce_loss 1.3809 (1.3568) teacher_loss 0.8500 (0.7918) loss_zs_kd 0.3770 (0.3883) loss_oracle 0.4705 (0.4492) acc 50.0000 (49.2788) kd_loss 0.8836 (0.9288) lr 7.5131e-04 eta 0:08:40
epoch [31/50] batch [280/319] time 0.092 (0.085) data 0.000 (0.002) loss 1.3820 (1.4410) ce_loss 1.2881 (1.3634) teacher_loss 0.7059 (0.7985) loss_zs_kd 0.3799 (0.3889) loss_oracle 0.4861 (0.4481) acc 43.7500 (48.9844) kd_loss 1.0284 (0.9298) lr 7.5131e-04 eta 0:08:39
epoch [31/50] batch [300/319] time 0.080 (0.085) data 0.000 (0.002) loss 1.2384 (1.4444) ce_loss 1.1943 (1.3656) teacher_loss 0.6495 (0.8025) loss_zs_kd 0.3620 (0.3889) loss_oracle 0.4079 (0.4475) acc 62.5000 (48.9896) kd_loss 1.0323 (0.9305) lr 7.5131e-04 eta 0:08:37
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,279
* accuracy: 52.1%
* error: 47.9%
* macro_f1: 40.0%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,045
* accuracy: 41.5%
* error: 58.5%
* macro_f1: 15.6%
******* Domain 2 best val acc:      52.1%, epoch: 31 *******
******* Domain 2 best val test acc: 41.5%, epoch: 31 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [32/50] batch [20/319] time 0.080 (0.117) data 0.000 (0.031) loss 1.3375 (1.4467) ce_loss 1.3906 (1.3454) teacher_loss 0.7640 (0.8474) loss_zs_kd 0.4214 (0.3754) loss_oracle 0.3628 (0.4116) acc 40.6250 (48.9062) kd_loss 0.9995 (0.9497) lr 6.9098e-04 eta 0:11:49
epoch [32/50] batch [40/319] time 0.078 (0.101) data 0.000 (0.016) loss 1.5516 (1.4564) ce_loss 1.5146 (1.3690) teacher_loss 0.9475 (0.8497) loss_zs_kd 0.3695 (0.3698) loss_oracle 0.4193 (0.4218) acc 37.5000 (48.2812) kd_loss 0.9034 (0.9564) lr 6.9098e-04 eta 0:10:05
epoch [32/50] batch [60/319] time 0.079 (0.095) data 0.000 (0.010) loss 1.2790 (1.4532) ce_loss 1.1250 (1.3607) teacher_loss 0.7323 (0.8412) loss_zs_kd 0.3141 (0.3742) loss_oracle 0.3896 (0.4249) acc 53.1250 (49.2708) kd_loss 0.9076 (0.9528) lr 6.9098e-04 eta 0:09:28
epoch [32/50] batch [80/319] time 0.072 (0.091) data 0.000 (0.008) loss 1.4015 (1.4545) ce_loss 1.1934 (1.3586) teacher_loss 0.7602 (0.8433) loss_zs_kd 0.3727 (0.3716) loss_oracle 0.4550 (0.4254) acc 53.1250 (49.1797) kd_loss 0.9550 (0.9483) lr 6.9098e-04 eta 0:09:04
epoch [32/50] batch [100/319] time 0.079 (0.089) data 0.000 (0.006) loss 1.4367 (1.4579) ce_loss 1.3252 (1.3702) teacher_loss 0.8514 (0.8538) loss_zs_kd 0.3266 (0.3658) loss_oracle 0.4220 (0.4212) acc 53.1250 (48.8750) kd_loss 0.8444 (0.9439) lr 6.9098e-04 eta 0:08:51
epoch [32/50] batch [120/319] time 0.060 (0.085) data 0.000 (0.005) loss 1.3788 (1.4495) ce_loss 1.3047 (1.3574) teacher_loss 0.7750 (0.8444) loss_zs_kd 0.4209 (0.3672) loss_oracle 0.3934 (0.4215) acc 50.0000 (49.1146) kd_loss 0.8725 (0.9410) lr 6.9098e-04 eta 0:08:24
epoch [32/50] batch [140/319] time 0.082 (0.082) data 0.000 (0.005) loss 1.5293 (1.4469) ce_loss 1.4814 (1.3590) teacher_loss 0.9668 (0.8419) loss_zs_kd 0.3963 (0.3654) loss_oracle 0.3644 (0.4223) acc 43.7500 (48.7500) kd_loss 0.8683 (0.9359) lr 6.9098e-04 eta 0:08:08
epoch [32/50] batch [160/319] time 0.060 (0.080) data 0.000 (0.004) loss 1.6195 (1.4528) ce_loss 1.4609 (1.3670) teacher_loss 0.9353 (0.8448) loss_zs_kd 0.3642 (0.3645) loss_oracle 0.5022 (0.4257) acc 43.7500 (48.5352) kd_loss 0.8565 (0.9300) lr 6.9098e-04 eta 0:07:54
epoch [32/50] batch [180/319] time 0.062 (0.079) data 0.000 (0.004) loss 1.4595 (1.4507) ce_loss 1.5791 (1.3639) teacher_loss 0.9091 (0.8412) loss_zs_kd 0.3458 (0.3646) loss_oracle 0.3774 (0.4272) acc 43.7500 (48.8021) kd_loss 0.8861 (0.9274) lr 6.9098e-04 eta 0:07:46
epoch [32/50] batch [200/319] time 0.062 (0.078) data 0.000 (0.003) loss 1.4259 (1.4508) ce_loss 1.4941 (1.3604) teacher_loss 0.8128 (0.8396) loss_zs_kd 0.2935 (0.3644) loss_oracle 0.4664 (0.4290) acc 46.8750 (49.1562) kd_loss 0.8241 (0.9234) lr 6.9098e-04 eta 0:07:36
epoch [32/50] batch [220/319] time 0.070 (0.077) data 0.000 (0.003) loss 1.4220 (1.4466) ce_loss 1.3096 (1.3543) teacher_loss 0.8553 (0.8325) loss_zs_kd 0.3141 (0.3645) loss_oracle 0.4096 (0.4318) acc 46.8750 (49.3182) kd_loss 0.8286 (0.9212) lr 6.9098e-04 eta 0:07:26
epoch [32/50] batch [240/319] time 0.058 (0.075) data 0.000 (0.003) loss 1.1126 (1.4458) ce_loss 1.0049 (1.3550) teacher_loss 0.6126 (0.8327) loss_zs_kd 0.3223 (0.3646) loss_oracle 0.3389 (0.4308) acc 62.5000 (49.3750) kd_loss 0.9188 (0.9180) lr 6.9098e-04 eta 0:07:16
epoch [32/50] batch [260/319] time 0.064 (0.074) data 0.000 (0.003) loss 1.4348 (1.4492) ce_loss 1.3555 (1.3588) teacher_loss 0.7844 (0.8362) loss_zs_kd 0.3641 (0.3634) loss_oracle 0.4684 (0.4313) acc 56.2500 (49.2668) kd_loss 0.9527 (0.9149) lr 6.9098e-04 eta 0:07:09
epoch [32/50] batch [280/319] time 0.067 (0.073) data 0.000 (0.002) loss 1.4904 (1.4515) ce_loss 1.5234 (1.3636) teacher_loss 0.8961 (0.8365) loss_zs_kd 0.3537 (0.3634) loss_oracle 0.4174 (0.4333) acc 53.1250 (49.1741) kd_loss 0.7999 (0.9122) lr 6.9098e-04 eta 0:07:03
epoch [32/50] batch [300/319] time 0.087 (0.074) data 0.000 (0.002) loss 1.3527 (1.4511) ce_loss 1.2793 (1.3621) teacher_loss 0.8286 (0.8332) loss_zs_kd 0.2766 (0.3655) loss_oracle 0.3858 (0.4351) acc 56.2500 (49.4583) kd_loss 0.9233 (0.9086) lr 6.9098e-04 eta 0:07:05
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,232
* accuracy: 51.0%
* error: 49.0%
* macro_f1: 38.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,483
* accuracy: 35.8%
* error: 64.2%
* macro_f1: 15.1%
******* Domain 2 best val acc:      52.1%, epoch: 31 *******
******* Domain 2 best val test acc: 41.5%, epoch: 31 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [33/50] batch [20/319] time 0.084 (0.116) data 0.000 (0.026) loss 1.7469 (1.4926) ce_loss 1.7148 (1.3703) teacher_loss 1.0472 (0.8363) loss_zs_kd 0.3296 (0.3831) loss_oracle 0.5349 (0.4647) acc 37.5000 (49.8438) kd_loss 0.8387 (0.8186) lr 6.3188e-04 eta 0:11:01
epoch [33/50] batch [40/319] time 0.088 (0.097) data 0.000 (0.013) loss 1.4495 (1.4855) ce_loss 1.3174 (1.3786) teacher_loss 0.7515 (0.8229) loss_zs_kd 0.4286 (0.3732) loss_oracle 0.4838 (0.4759) acc 46.8750 (50.6250) kd_loss 0.9031 (0.8280) lr 6.3188e-04 eta 0:09:12
epoch [33/50] batch [60/319] time 0.083 (0.093) data 0.000 (0.009) loss 1.1561 (1.4832) ce_loss 1.0088 (1.3705) teacher_loss 0.5269 (0.8166) loss_zs_kd 0.3201 (0.3726) loss_oracle 0.4691 (0.4803) acc 59.3750 (50.0000) kd_loss 0.7167 (0.8302) lr 6.3188e-04 eta 0:08:50
epoch [33/50] batch [80/319] time 0.085 (0.091) data 0.000 (0.007) loss 1.4758 (1.4775) ce_loss 1.3086 (1.3576) teacher_loss 0.7258 (0.8052) loss_zs_kd 0.4438 (0.3791) loss_oracle 0.5280 (0.4828) acc 56.2500 (50.5859) kd_loss 0.8440 (0.8308) lr 6.3188e-04 eta 0:08:36
epoch [33/50] batch [100/319] time 0.082 (0.090) data 0.000 (0.005) loss 1.5903 (1.4747) ce_loss 1.5449 (1.3625) teacher_loss 0.9124 (0.8023) loss_zs_kd 0.3808 (0.3797) loss_oracle 0.4875 (0.4825) acc 50.0000 (49.9062) kd_loss 0.8368 (0.8308) lr 6.3188e-04 eta 0:08:28
epoch [33/50] batch [120/319] time 0.087 (0.089) data 0.000 (0.005) loss 1.7726 (1.4742) ce_loss 1.5713 (1.3611) teacher_loss 1.0160 (0.8030) loss_zs_kd 0.3535 (0.3776) loss_oracle 0.5799 (0.4824) acc 46.8750 (49.7396) kd_loss 0.8149 (0.8330) lr 6.3188e-04 eta 0:08:21
epoch [33/50] batch [140/319] time 0.091 (0.088) data 0.001 (0.004) loss 1.4477 (1.4754) ce_loss 1.3223 (1.3606) teacher_loss 0.7934 (0.8045) loss_zs_kd 0.4182 (0.3781) loss_oracle 0.4452 (0.4819) acc 46.8750 (49.8214) kd_loss 0.8566 (0.8310) lr 6.3188e-04 eta 0:08:15
epoch [33/50] batch [160/319] time 0.082 (0.088) data 0.000 (0.003) loss 1.1740 (1.4766) ce_loss 1.0059 (1.3601) teacher_loss 0.5462 (0.8061) loss_zs_kd 0.3634 (0.3797) loss_oracle 0.4460 (0.4806) acc 62.5000 (49.5898) kd_loss 0.8425 (0.8304) lr 6.3188e-04 eta 0:08:11
epoch [33/50] batch [180/319] time 0.075 (0.087) data 0.000 (0.003) loss 1.5828 (1.4837) ce_loss 1.5176 (1.3697) teacher_loss 0.8743 (0.8156) loss_zs_kd 0.4944 (0.3791) loss_oracle 0.4613 (0.4786) acc 50.0000 (49.1319) kd_loss 0.8842 (0.8313) lr 6.3188e-04 eta 0:08:06
epoch [33/50] batch [200/319] time 0.085 (0.087) data 0.000 (0.003) loss 1.4260 (1.4849) ce_loss 1.2734 (1.3692) teacher_loss 0.6283 (0.8142) loss_zs_kd 0.4573 (0.3801) loss_oracle 0.5691 (0.4807) acc 56.2500 (49.4062) kd_loss 0.9531 (0.8333) lr 6.3188e-04 eta 0:08:01
epoch [33/50] batch [220/319] time 0.085 (0.087) data 0.000 (0.003) loss 1.2989 (1.4810) ce_loss 1.0654 (1.3605) teacher_loss 0.6350 (0.8088) loss_zs_kd 0.3346 (0.3805) loss_oracle 0.4965 (0.4820) acc 59.3750 (49.7159) kd_loss 0.7659 (0.8323) lr 6.3188e-04 eta 0:07:57
epoch [33/50] batch [240/319] time 0.090 (0.086) data 0.000 (0.002) loss 1.5392 (1.4845) ce_loss 1.4629 (1.3598) teacher_loss 0.7389 (0.8105) loss_zs_kd 0.4589 (0.3809) loss_oracle 0.5709 (0.4835) acc 53.1250 (49.6484) kd_loss 0.9092 (0.8309) lr 6.3188e-04 eta 0:07:54
epoch [33/50] batch [260/319] time 0.077 (0.086) data 0.000 (0.002) loss 1.5229 (1.4858) ce_loss 1.5137 (1.3604) teacher_loss 0.8487 (0.8125) loss_zs_kd 0.3789 (0.3803) loss_oracle 0.4847 (0.4832) acc 43.7500 (49.5913) kd_loss 0.8408 (0.8307) lr 6.3188e-04 eta 0:07:49
epoch [33/50] batch [280/319] time 0.081 (0.085) data 0.000 (0.002) loss 1.3316 (1.4842) ce_loss 1.0762 (1.3552) teacher_loss 0.7279 (0.8118) loss_zs_kd 0.3383 (0.3791) loss_oracle 0.4346 (0.4828) acc 65.6250 (49.7656) kd_loss 0.8272 (0.8285) lr 6.3188e-04 eta 0:07:45
epoch [33/50] batch [300/319] time 0.083 (0.085) data 0.000 (0.002) loss 1.2538 (1.4862) ce_loss 1.0342 (1.3589) teacher_loss 0.6411 (0.8130) loss_zs_kd 0.3277 (0.3785) loss_oracle 0.4489 (0.4839) acc 68.7500 (49.7292) kd_loss 0.8403 (0.8277) lr 6.3188e-04 eta 0:07:43
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,277
* accuracy: 52.0%
* error: 48.0%
* macro_f1: 40.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,582
* accuracy: 36.8%
* error: 63.2%
* macro_f1: 15.6%
******* Domain 2 best val acc:      52.1%, epoch: 31 *******
******* Domain 2 best val test acc: 41.5%, epoch: 31 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [34/50] batch [20/319] time 0.084 (0.119) data 0.000 (0.029) loss 1.7774 (1.4878) ce_loss 1.5508 (1.3431) teacher_loss 1.1422 (0.8177) loss_zs_kd 0.4045 (0.3793) loss_oracle 0.4330 (0.4804) acc 46.8750 (50.1562) kd_loss 0.7306 (0.8172) lr 5.7422e-04 eta 0:10:40
epoch [34/50] batch [40/319] time 0.082 (0.100) data 0.000 (0.015) loss 1.4067 (1.4894) ce_loss 1.3047 (1.3438) teacher_loss 0.8134 (0.8154) loss_zs_kd 0.3017 (0.3876) loss_oracle 0.4424 (0.4802) acc 46.8750 (49.3750) kd_loss 0.8639 (0.8159) lr 5.7422e-04 eta 0:08:59
epoch [34/50] batch [60/319] time 0.089 (0.093) data 0.001 (0.010) loss 1.5674 (1.4740) ce_loss 1.4756 (1.3158) teacher_loss 0.9072 (0.7972) loss_zs_kd 0.3518 (0.3861) loss_oracle 0.4844 (0.4837) acc 43.7500 (50.9375) kd_loss 0.8858 (0.8202) lr 5.7422e-04 eta 0:08:18
epoch [34/50] batch [80/319] time 0.089 (0.091) data 0.000 (0.007) loss 1.5759 (1.4673) ce_loss 1.4482 (1.3122) teacher_loss 0.8956 (0.7929) loss_zs_kd 0.4155 (0.3800) loss_oracle 0.4725 (0.4844) acc 46.8750 (50.6250) kd_loss 0.8136 (0.8255) lr 5.7422e-04 eta 0:08:06
epoch [34/50] batch [100/319] time 0.087 (0.090) data 0.000 (0.006) loss 1.4495 (1.4701) ce_loss 1.3936 (1.3090) teacher_loss 0.7275 (0.7971) loss_zs_kd 0.3825 (0.3819) loss_oracle 0.5308 (0.4821) acc 40.6250 (50.5625) kd_loss 0.7986 (0.8286) lr 5.7422e-04 eta 0:07:58
epoch [34/50] batch [120/319] time 0.077 (0.089) data 0.000 (0.005) loss 1.4044 (1.4531) ce_loss 1.3867 (1.3024) teacher_loss 0.7881 (0.7835) loss_zs_kd 0.3894 (0.3811) loss_oracle 0.4216 (0.4791) acc 46.8750 (50.6771) kd_loss 0.9834 (0.8346) lr 5.7422e-04 eta 0:07:51
epoch [34/50] batch [140/319] time 0.081 (0.088) data 0.000 (0.004) loss 1.6313 (1.4561) ce_loss 1.5254 (1.3058) teacher_loss 0.9670 (0.7869) loss_zs_kd 0.3893 (0.3811) loss_oracle 0.4696 (0.4786) acc 40.6250 (50.3348) kd_loss 0.9399 (0.8379) lr 5.7422e-04 eta 0:07:46
epoch [34/50] batch [160/319] time 0.082 (0.088) data 0.000 (0.004) loss 1.5269 (1.4596) ce_loss 1.3486 (1.3101) teacher_loss 0.7833 (0.7903) loss_zs_kd 0.4453 (0.3828) loss_oracle 0.5209 (0.4779) acc 40.6250 (50.2148) kd_loss 0.8937 (0.8392) lr 5.7422e-04 eta 0:07:43
epoch [34/50] batch [180/319] time 0.090 (0.088) data 0.000 (0.003) loss 1.4804 (1.4610) ce_loss 1.2559 (1.3121) teacher_loss 0.7870 (0.7921) loss_zs_kd 0.5246 (0.3856) loss_oracle 0.4310 (0.4762) acc 56.2500 (50.3472) kd_loss 0.9028 (0.8421) lr 5.7422e-04 eta 0:07:39
epoch [34/50] batch [200/319] time 0.080 (0.087) data 0.001 (0.003) loss 1.3048 (1.4610) ce_loss 1.2969 (1.3207) teacher_loss 0.7052 (0.7929) loss_zs_kd 0.3340 (0.3856) loss_oracle 0.4326 (0.4753) acc 50.0000 (50.2500) kd_loss 0.9529 (0.8479) lr 5.7422e-04 eta 0:07:32
epoch [34/50] batch [220/319] time 0.092 (0.086) data 0.000 (0.003) loss 1.2513 (1.4603) ce_loss 1.0996 (1.3230) teacher_loss 0.5556 (0.7891) loss_zs_kd 0.4390 (0.3888) loss_oracle 0.4762 (0.4768) acc 62.5000 (50.2131) kd_loss 0.8967 (0.8526) lr 5.7422e-04 eta 0:07:27
epoch [34/50] batch [240/319] time 0.079 (0.085) data 0.000 (0.003) loss 1.4578 (1.4553) ce_loss 1.2754 (1.3227) teacher_loss 0.8685 (0.7843) loss_zs_kd 0.4262 (0.3902) loss_oracle 0.3762 (0.4760) acc 59.3750 (50.3776) kd_loss 0.9074 (0.8562) lr 5.7422e-04 eta 0:07:22
epoch [34/50] batch [260/319] time 0.078 (0.085) data 0.000 (0.002) loss 1.2357 (1.4487) ce_loss 1.1055 (1.3156) teacher_loss 0.6220 (0.7785) loss_zs_kd 0.3794 (0.3900) loss_oracle 0.4240 (0.4751) acc 53.1250 (50.7212) kd_loss 0.8627 (0.8579) lr 5.7422e-04 eta 0:07:19
epoch [34/50] batch [280/319] time 0.081 (0.085) data 0.000 (0.002) loss 1.2747 (1.4449) ce_loss 1.0527 (1.3135) teacher_loss 0.6000 (0.7752) loss_zs_kd 0.4094 (0.3902) loss_oracle 0.4701 (0.4745) acc 71.8750 (50.7701) kd_loss 0.9309 (0.8598) lr 5.7422e-04 eta 0:07:17
epoch [34/50] batch [300/319] time 0.085 (0.085) data 0.000 (0.002) loss 1.5282 (1.4445) ce_loss 1.4326 (1.3185) teacher_loss 0.8620 (0.7744) loss_zs_kd 0.4195 (0.3920) loss_oracle 0.4564 (0.4742) acc 43.7500 (50.6562) kd_loss 0.8518 (0.8626) lr 5.7422e-04 eta 0:07:15
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,287
* accuracy: 52.2%
* error: 47.8%
* macro_f1: 40.8%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,822
* accuracy: 39.3%
* error: 60.7%
* macro_f1: 15.4%
******* Domain 2 best val acc:      52.2%, epoch: 34 *******
******* Domain 2 best val test acc: 39.3%, epoch: 34 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [35/50] batch [20/319] time 0.080 (0.112) data 0.000 (0.028) loss 1.5579 (1.4089) ce_loss 1.4805 (1.3365) teacher_loss 0.8556 (0.7410) loss_zs_kd 0.4278 (0.4055) loss_oracle 0.4884 (0.4652) acc 43.7500 (50.0000) kd_loss 0.8707 (0.9049) lr 5.1825e-04 eta 0:09:31
epoch [35/50] batch [40/319] time 0.085 (0.097) data 0.000 (0.014) loss 1.4020 (1.4124) ce_loss 1.3418 (1.3323) teacher_loss 0.7016 (0.7391) loss_zs_kd 0.3950 (0.4049) loss_oracle 0.5029 (0.4709) acc 43.7500 (50.3125) kd_loss 0.9447 (0.9089) lr 5.1825e-04 eta 0:08:12
epoch [35/50] batch [60/319] time 0.081 (0.092) data 0.000 (0.009) loss 1.3200 (1.4193) ce_loss 1.2451 (1.3418) teacher_loss 0.6675 (0.7555) loss_zs_kd 0.3866 (0.3975) loss_oracle 0.4592 (0.4650) acc 50.0000 (50.2604) kd_loss 0.9605 (0.9045) lr 5.1825e-04 eta 0:07:44
epoch [35/50] batch [80/319] time 0.084 (0.090) data 0.001 (0.007) loss 1.4576 (1.4149) ce_loss 1.4941 (1.3377) teacher_loss 0.7674 (0.7480) loss_zs_kd 0.3858 (0.3986) loss_oracle 0.4973 (0.4677) acc 53.1250 (50.3906) kd_loss 0.9811 (0.9060) lr 5.1825e-04 eta 0:07:33
epoch [35/50] batch [100/319] time 0.080 (0.089) data 0.000 (0.006) loss 1.5191 (1.4053) ce_loss 1.4014 (1.3274) teacher_loss 0.8333 (0.7392) loss_zs_kd 0.4753 (0.4022) loss_oracle 0.4482 (0.4651) acc 53.1250 (50.6562) kd_loss 0.8272 (0.9052) lr 5.1825e-04 eta 0:07:23
epoch [35/50] batch [120/319] time 0.083 (0.088) data 0.000 (0.005) loss 1.4828 (1.4079) ce_loss 1.3115 (1.3321) teacher_loss 0.8125 (0.7403) loss_zs_kd 0.4092 (0.4022) loss_oracle 0.4657 (0.4665) acc 56.2500 (50.6510) kd_loss 0.7765 (0.9037) lr 5.1825e-04 eta 0:07:16
epoch [35/50] batch [140/319] time 0.086 (0.087) data 0.000 (0.004) loss 1.3372 (1.4032) ce_loss 1.3105 (1.3205) teacher_loss 0.7418 (0.7365) loss_zs_kd 0.3832 (0.4003) loss_oracle 0.4038 (0.4666) acc 56.2500 (51.2277) kd_loss 1.0296 (0.9031) lr 5.1825e-04 eta 0:07:12
epoch [35/50] batch [160/319] time 0.077 (0.087) data 0.000 (0.004) loss 1.4539 (1.4073) ce_loss 1.2129 (1.3210) teacher_loss 0.8288 (0.7410) loss_zs_kd 0.4466 (0.4020) loss_oracle 0.4018 (0.4653) acc 56.2500 (50.6641) kd_loss 0.8425 (0.8992) lr 5.1825e-04 eta 0:07:07
epoch [35/50] batch [180/319] time 0.084 (0.086) data 0.000 (0.003) loss 1.5319 (1.4145) ce_loss 1.5566 (1.3329) teacher_loss 0.9417 (0.7492) loss_zs_kd 0.3335 (0.4021) loss_oracle 0.4234 (0.4643) acc 43.7500 (50.3646) kd_loss 0.8564 (0.9000) lr 5.1825e-04 eta 0:07:02
epoch [35/50] batch [200/319] time 0.082 (0.086) data 0.000 (0.003) loss 1.4101 (1.4202) ce_loss 1.1855 (1.3412) teacher_loss 0.7672 (0.7549) loss_zs_kd 0.3741 (0.4030) loss_oracle 0.4558 (0.4638) acc 56.2500 (50.0000) kd_loss 0.8091 (0.9002) lr 5.1825e-04 eta 0:07:00
epoch [35/50] batch [220/319] time 0.092 (0.086) data 0.000 (0.003) loss 1.6482 (1.4166) ce_loss 1.5801 (1.3382) teacher_loss 0.8793 (0.7488) loss_zs_kd 0.4271 (0.4043) loss_oracle 0.5553 (0.4656) acc 37.5000 (50.0142) kd_loss 0.9368 (0.9016) lr 5.1825e-04 eta 0:06:58
epoch [35/50] batch [240/319] time 0.082 (0.086) data 0.000 (0.003) loss 1.3240 (1.4171) ce_loss 1.1855 (1.3393) teacher_loss 0.7088 (0.7494) loss_zs_kd 0.4294 (0.4052) loss_oracle 0.4004 (0.4651) acc 53.1250 (49.8828) kd_loss 0.8795 (0.9012) lr 5.1825e-04 eta 0:06:56
epoch [35/50] batch [260/319] time 0.069 (0.085) data 0.000 (0.002) loss 1.0799 (1.4127) ce_loss 0.9038 (1.3351) teacher_loss 0.4257 (0.7445) loss_zs_kd 0.4705 (0.4060) loss_oracle 0.4190 (0.4651) acc 75.0000 (49.9159) kd_loss 0.9397 (0.9017) lr 5.1825e-04 eta 0:06:51
epoch [35/50] batch [280/319] time 0.079 (0.085) data 0.000 (0.002) loss 1.5819 (1.4168) ce_loss 1.5166 (1.3394) teacher_loss 0.8463 (0.7471) loss_zs_kd 0.4325 (0.4069) loss_oracle 0.5193 (0.4663) acc 46.8750 (49.7321) kd_loss 0.9190 (0.9020) lr 5.1825e-04 eta 0:06:48
epoch [35/50] batch [300/319] time 0.083 (0.084) data 0.000 (0.002) loss 1.1687 (1.4153) ce_loss 1.1768 (1.3376) teacher_loss 0.5488 (0.7456) loss_zs_kd 0.4035 (0.4073) loss_oracle 0.4182 (0.4661) acc 53.1250 (49.9792) kd_loss 0.9420 (0.9026) lr 5.1825e-04 eta 0:06:45
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,285
* accuracy: 52.2%
* error: 47.8%
* macro_f1: 39.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,042
* accuracy: 41.5%
* error: 58.5%
* macro_f1: 15.3%
******* Domain 2 best val acc:      52.2%, epoch: 34 *******
******* Domain 2 best val test acc: 39.3%, epoch: 34 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [36/50] batch [20/319] time 0.084 (0.115) data 0.000 (0.026) loss 1.3486 (1.4425) ce_loss 1.1504 (1.3447) teacher_loss 0.7087 (0.7523) loss_zs_kd 0.3502 (0.4206) loss_oracle 0.4648 (0.4799) acc 59.3750 (49.5312) kd_loss 0.8763 (0.8932) lr 4.6417e-04 eta 0:09:05
epoch [36/50] batch [40/319] time 0.087 (0.100) data 0.000 (0.013) loss 1.4506 (1.4548) ce_loss 1.3828 (1.3764) teacher_loss 0.7548 (0.7651) loss_zs_kd 0.3856 (0.4234) loss_oracle 0.5030 (0.4780) acc 37.5000 (47.7344) kd_loss 0.9386 (0.8964) lr 4.6417e-04 eta 0:07:55
epoch [36/50] batch [60/319] time 0.081 (0.095) data 0.001 (0.009) loss 1.5755 (1.4390) ce_loss 1.3350 (1.3508) teacher_loss 0.7820 (0.7561) loss_zs_kd 0.4709 (0.4194) loss_oracle 0.5580 (0.4732) acc 46.8750 (49.3229) kd_loss 0.8684 (0.8989) lr 4.6417e-04 eta 0:07:30
epoch [36/50] batch [80/319] time 0.082 (0.093) data 0.000 (0.007) loss 1.4567 (1.4391) ce_loss 1.2568 (1.3557) teacher_loss 0.7222 (0.7603) loss_zs_kd 0.4371 (0.4115) loss_oracle 0.5160 (0.4730) acc 53.1250 (49.2969) kd_loss 0.9466 (0.9005) lr 4.6417e-04 eta 0:07:17
epoch [36/50] batch [100/319] time 0.083 (0.091) data 0.000 (0.006) loss 1.3986 (1.4336) ce_loss 1.3291 (1.3455) teacher_loss 0.6482 (0.7553) loss_zs_kd 0.4941 (0.4103) loss_oracle 0.5034 (0.4731) acc 46.8750 (50.0000) kd_loss 0.9498 (0.9021) lr 4.6417e-04 eta 0:07:05
epoch [36/50] batch [120/319] time 0.087 (0.090) data 0.000 (0.005) loss 1.2978 (1.4264) ce_loss 1.2275 (1.3382) teacher_loss 0.6105 (0.7486) loss_zs_kd 0.3739 (0.4090) loss_oracle 0.5003 (0.4733) acc 50.0000 (50.4688) kd_loss 0.8595 (0.9031) lr 4.6417e-04 eta 0:06:58
epoch [36/50] batch [140/319] time 0.086 (0.089) data 0.000 (0.004) loss 1.5229 (1.4250) ce_loss 1.3242 (1.3380) teacher_loss 0.8445 (0.7482) loss_zs_kd 0.3708 (0.4087) loss_oracle 0.4930 (0.4725) acc 53.1250 (50.5134) kd_loss 0.8540 (0.9046) lr 4.6417e-04 eta 0:06:54
epoch [36/50] batch [160/319] time 0.085 (0.089) data 0.000 (0.004) loss 1.2891 (1.4237) ce_loss 1.2148 (1.3368) teacher_loss 0.7138 (0.7471) loss_zs_kd 0.3507 (0.4084) loss_oracle 0.4000 (0.4725) acc 62.5000 (50.5664) kd_loss 0.8782 (0.9046) lr 4.6417e-04 eta 0:06:49
epoch [36/50] batch [180/319] time 0.084 (0.088) data 0.000 (0.003) loss 1.5834 (1.4184) ce_loss 1.5303 (1.3389) teacher_loss 0.8723 (0.7450) loss_zs_kd 0.4344 (0.4052) loss_oracle 0.4939 (0.4708) acc 40.6250 (50.6597) kd_loss 0.8981 (0.9072) lr 4.6417e-04 eta 0:06:46
epoch [36/50] batch [200/319] time 0.083 (0.088) data 0.000 (0.003) loss 1.2547 (1.4177) ce_loss 1.1270 (1.3396) teacher_loss 0.6268 (0.7443) loss_zs_kd 0.3992 (0.4071) loss_oracle 0.4283 (0.4699) acc 59.3750 (50.7031) kd_loss 0.9298 (0.9092) lr 4.6417e-04 eta 0:06:43
epoch [36/50] batch [220/319] time 0.085 (0.088) data 0.000 (0.003) loss 1.3270 (1.4211) ce_loss 1.1836 (1.3454) teacher_loss 0.7113 (0.7448) loss_zs_kd 0.4193 (0.4079) loss_oracle 0.4061 (0.4724) acc 56.2500 (50.4403) kd_loss 0.9276 (0.9120) lr 4.6417e-04 eta 0:06:40
epoch [36/50] batch [240/319] time 0.083 (0.088) data 0.000 (0.002) loss 1.3825 (1.4238) ce_loss 1.5703 (1.3478) teacher_loss 0.6315 (0.7449) loss_zs_kd 0.5100 (0.4103) loss_oracle 0.4960 (0.4737) acc 43.7500 (50.5078) kd_loss 1.0039 (0.9105) lr 4.6417e-04 eta 0:06:37
epoch [36/50] batch [260/319] time 0.087 (0.087) data 0.000 (0.002) loss 1.5493 (1.4263) ce_loss 1.5615 (1.3507) teacher_loss 0.7562 (0.7446) loss_zs_kd 0.3902 (0.4108) loss_oracle 0.5980 (0.4763) acc 43.7500 (50.3846) kd_loss 0.8343 (0.9093) lr 4.6417e-04 eta 0:06:35
epoch [36/50] batch [280/319] time 0.080 (0.087) data 0.000 (0.002) loss 1.5601 (1.4254) ce_loss 1.5244 (1.3518) teacher_loss 0.8531 (0.7430) loss_zs_kd 0.4020 (0.4102) loss_oracle 0.5060 (0.4773) acc 37.5000 (50.1228) kd_loss 0.8349 (0.9080) lr 4.6417e-04 eta 0:06:32
epoch [36/50] batch [300/319] time 0.075 (0.087) data 0.000 (0.002) loss 1.5463 (1.4260) ce_loss 1.5859 (1.3528) teacher_loss 0.8592 (0.7422) loss_zs_kd 0.4197 (0.4111) loss_oracle 0.4773 (0.4783) acc 50.0000 (50.2812) kd_loss 0.8757 (0.9086) lr 4.6417e-04 eta 0:06:29
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,237
* accuracy: 51.1%
* error: 48.9%
* macro_f1: 39.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,921
* accuracy: 40.3%
* error: 59.7%
* macro_f1: 15.9%
******* Domain 2 best val acc:      52.2%, epoch: 34 *******
******* Domain 2 best val test acc: 39.3%, epoch: 34 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [37/50] batch [20/319] time 0.085 (0.115) data 0.000 (0.031) loss 1.4646 (1.3949) ce_loss 1.3496 (1.2927) teacher_loss 0.6948 (0.7258) loss_zs_kd 0.4671 (0.4095) loss_oracle 0.5362 (0.4644) acc 37.5000 (53.7500) kd_loss 0.9339 (0.9070) lr 4.1221e-04 eta 0:08:30
epoch [37/50] batch [40/319] time 0.083 (0.099) data 0.000 (0.016) loss 1.5887 (1.4001) ce_loss 1.4746 (1.3216) teacher_loss 0.9618 (0.7096) loss_zs_kd 0.3734 (0.4114) loss_oracle 0.4401 (0.4848) acc 50.0000 (52.8906) kd_loss 0.9188 (0.9222) lr 4.1221e-04 eta 0:07:19
epoch [37/50] batch [60/319] time 0.089 (0.095) data 0.001 (0.011) loss 1.3967 (1.4182) ce_loss 1.3623 (1.3392) teacher_loss 0.6197 (0.7278) loss_zs_kd 0.4467 (0.4117) loss_oracle 0.5536 (0.4845) acc 50.0000 (52.1354) kd_loss 1.0117 (0.9186) lr 4.1221e-04 eta 0:06:57
epoch [37/50] batch [80/319] time 0.083 (0.092) data 0.000 (0.008) loss 1.6733 (1.4317) ce_loss 1.6133 (1.3514) teacher_loss 0.9278 (0.7444) loss_zs_kd 0.4175 (0.4129) loss_oracle 0.5367 (0.4809) acc 40.6250 (51.3672) kd_loss 0.9927 (0.9137) lr 4.1221e-04 eta 0:06:43
epoch [37/50] batch [100/319] time 0.072 (0.089) data 0.000 (0.007) loss 1.4580 (1.4241) ce_loss 1.3818 (1.3529) teacher_loss 0.8650 (0.7375) loss_zs_kd 0.4510 (0.4138) loss_oracle 0.3675 (0.4797) acc 50.0000 (50.8125) kd_loss 0.8651 (0.9154) lr 4.1221e-04 eta 0:06:29
epoch [37/50] batch [120/319] time 0.084 (0.088) data 0.000 (0.005) loss 1.6290 (1.4298) ce_loss 1.6143 (1.3460) teacher_loss 0.9184 (0.7460) loss_zs_kd 0.4331 (0.4115) loss_oracle 0.4941 (0.4780) acc 50.0000 (51.0938) kd_loss 0.9056 (0.9077) lr 4.1221e-04 eta 0:06:23
epoch [37/50] batch [140/319] time 0.076 (0.088) data 0.000 (0.005) loss 1.4084 (1.4321) ce_loss 1.1240 (1.3476) teacher_loss 0.7111 (0.7478) loss_zs_kd 0.3950 (0.4103) loss_oracle 0.4999 (0.4792) acc 50.0000 (50.9152) kd_loss 0.8159 (0.9037) lr 4.1221e-04 eta 0:06:20
epoch [37/50] batch [160/319] time 0.081 (0.087) data 0.000 (0.004) loss 1.6122 (1.4364) ce_loss 1.4150 (1.3498) teacher_loss 0.9329 (0.7499) loss_zs_kd 0.3948 (0.4114) loss_oracle 0.4819 (0.4808) acc 50.0000 (50.8203) kd_loss 0.7795 (0.9028) lr 4.1221e-04 eta 0:06:13
epoch [37/50] batch [180/319] time 0.087 (0.086) data 0.000 (0.004) loss 1.5625 (1.4369) ce_loss 1.4951 (1.3496) teacher_loss 0.8384 (0.7508) loss_zs_kd 0.4273 (0.4121) loss_oracle 0.5104 (0.4801) acc 46.8750 (50.6597) kd_loss 1.0271 (0.9028) lr 4.1221e-04 eta 0:06:08
epoch [37/50] batch [200/319] time 0.080 (0.086) data 0.000 (0.003) loss 1.3873 (1.4321) ce_loss 1.4043 (1.3444) teacher_loss 0.6867 (0.7489) loss_zs_kd 0.3834 (0.4111) loss_oracle 0.5089 (0.4776) acc 56.2500 (50.8594) kd_loss 1.0095 (0.9022) lr 4.1221e-04 eta 0:06:05
epoch [37/50] batch [220/319] time 0.083 (0.086) data 0.000 (0.003) loss 1.7328 (1.4286) ce_loss 1.4180 (1.3421) teacher_loss 1.1110 (0.7467) loss_zs_kd 0.3925 (0.4095) loss_oracle 0.4256 (0.4771) acc 43.7500 (50.8523) kd_loss 0.7128 (0.9013) lr 4.1221e-04 eta 0:06:03
epoch [37/50] batch [240/319] time 0.085 (0.086) data 0.000 (0.003) loss 1.6218 (1.4233) ce_loss 1.3779 (1.3393) teacher_loss 0.8241 (0.7415) loss_zs_kd 0.4451 (0.4091) loss_oracle 0.5752 (0.4773) acc 43.7500 (50.7682) kd_loss 0.9271 (0.9022) lr 4.1221e-04 eta 0:06:01
epoch [37/50] batch [260/319] time 0.087 (0.085) data 0.000 (0.003) loss 1.5104 (1.4300) ce_loss 1.4834 (1.3481) teacher_loss 0.8024 (0.7461) loss_zs_kd 0.3837 (0.4102) loss_oracle 0.5162 (0.4788) acc 34.3750 (50.4087) kd_loss 0.9660 (0.9028) lr 4.1221e-04 eta 0:05:58
epoch [37/50] batch [280/319] time 0.086 (0.085) data 0.000 (0.003) loss 1.4175 (1.4306) ce_loss 1.3428 (1.3480) teacher_loss 0.7105 (0.7474) loss_zs_kd 0.3964 (0.4100) loss_oracle 0.5087 (0.4782) acc 62.5000 (50.5357) kd_loss 0.9809 (0.9037) lr 4.1221e-04 eta 0:05:56
epoch [37/50] batch [300/319] time 0.083 (0.085) data 0.000 (0.002) loss 1.4011 (1.4272) ce_loss 1.4551 (1.3437) teacher_loss 0.7919 (0.7450) loss_zs_kd 0.3835 (0.4101) loss_oracle 0.4175 (0.4772) acc 50.0000 (50.5938) kd_loss 0.9487 (0.9048) lr 4.1221e-04 eta 0:05:55
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,270
* accuracy: 51.9%
* error: 48.1%
* macro_f1: 39.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,857
* accuracy: 39.6%
* error: 60.4%
* macro_f1: 14.9%
******* Domain 2 best val acc:      52.2%, epoch: 34 *******
******* Domain 2 best val test acc: 39.3%, epoch: 34 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [38/50] batch [20/319] time 0.083 (0.117) data 0.000 (0.027) loss 1.3784 (1.4189) ce_loss 1.1738 (1.3229) teacher_loss 0.7201 (0.7552) loss_zs_kd 0.4291 (0.3999) loss_oracle 0.4438 (0.4638) acc 62.5000 (51.4062) kd_loss 0.8884 (0.9447) lr 3.6258e-04 eta 0:08:04
epoch [38/50] batch [40/319] time 0.078 (0.098) data 0.000 (0.013) loss 1.4191 (1.4091) ce_loss 1.4717 (1.3314) teacher_loss 0.8192 (0.7496) loss_zs_kd 0.3437 (0.3945) loss_oracle 0.4281 (0.4621) acc 50.0000 (51.2500) kd_loss 0.9463 (0.9321) lr 3.6258e-04 eta 0:06:41
epoch [38/50] batch [60/319] time 0.091 (0.092) data 0.000 (0.009) loss 1.5851 (1.4343) ce_loss 1.4834 (1.3524) teacher_loss 0.9027 (0.7736) loss_zs_kd 0.4247 (0.3984) loss_oracle 0.4701 (0.4615) acc 50.0000 (50.4167) kd_loss 0.9138 (0.9290) lr 3.6258e-04 eta 0:06:17
epoch [38/50] batch [80/319] time 0.087 (0.089) data 0.000 (0.007) loss 1.6011 (1.4185) ce_loss 1.4922 (1.3436) teacher_loss 0.8551 (0.7536) loss_zs_kd 0.5578 (0.4036) loss_oracle 0.4671 (0.4631) acc 37.5000 (50.2344) kd_loss 0.8065 (0.9328) lr 3.6258e-04 eta 0:05:59
epoch [38/50] batch [100/319] time 0.084 (0.087) data 0.000 (0.006) loss 1.4361 (1.4205) ce_loss 1.4502 (1.3399) teacher_loss 0.6805 (0.7441) loss_zs_kd 0.4208 (0.4097) loss_oracle 0.5452 (0.4715) acc 53.1250 (50.7188) kd_loss 0.9506 (0.9335) lr 3.6258e-04 eta 0:05:51
epoch [38/50] batch [120/319] time 0.082 (0.086) data 0.000 (0.005) loss 1.4125 (1.4216) ce_loss 1.0264 (1.3390) teacher_loss 0.7247 (0.7449) loss_zs_kd 0.3922 (0.4080) loss_oracle 0.4916 (0.4727) acc 59.3750 (50.5990) kd_loss 0.9893 (0.9357) lr 3.6258e-04 eta 0:05:48
epoch [38/50] batch [140/319] time 0.084 (0.086) data 0.000 (0.004) loss 1.5280 (1.4286) ce_loss 1.5752 (1.3526) teacher_loss 0.8624 (0.7508) loss_zs_kd 0.4038 (0.4083) loss_oracle 0.4638 (0.4737) acc 53.1250 (49.7768) kd_loss 0.9615 (0.9374) lr 3.6258e-04 eta 0:05:46
epoch [38/50] batch [160/319] time 0.081 (0.086) data 0.000 (0.004) loss 1.2992 (1.4268) ce_loss 1.2725 (1.3552) teacher_loss 0.6979 (0.7497) loss_zs_kd 0.3495 (0.4077) loss_oracle 0.4265 (0.4732) acc 43.7500 (49.7461) kd_loss 0.9637 (0.9389) lr 3.6258e-04 eta 0:05:42
epoch [38/50] batch [180/319] time 0.081 (0.086) data 0.000 (0.003) loss 1.4652 (1.4303) ce_loss 1.3662 (1.3569) teacher_loss 0.7407 (0.7518) loss_zs_kd 0.3864 (0.4070) loss_oracle 0.5313 (0.4750) acc 28.1250 (49.0972) kd_loss 0.8481 (0.9337) lr 3.6258e-04 eta 0:05:39
epoch [38/50] batch [200/319] time 0.076 (0.086) data 0.000 (0.003) loss 1.4624 (1.4319) ce_loss 1.3359 (1.3637) teacher_loss 0.7821 (0.7536) loss_zs_kd 0.4400 (0.4083) loss_oracle 0.4603 (0.4741) acc 50.0000 (48.8750) kd_loss 0.8419 (0.9334) lr 3.6258e-04 eta 0:05:37
epoch [38/50] batch [220/319] time 0.081 (0.085) data 0.000 (0.003) loss 1.3638 (1.4272) ce_loss 1.4160 (1.3596) teacher_loss 0.6882 (0.7513) loss_zs_kd 0.3811 (0.4070) loss_oracle 0.4850 (0.4723) acc 62.5000 (48.9489) kd_loss 0.9696 (0.9332) lr 3.6258e-04 eta 0:05:34
epoch [38/50] batch [240/319] time 0.085 (0.085) data 0.000 (0.002) loss 1.2203 (1.4236) ce_loss 1.0674 (1.3530) teacher_loss 0.6942 (0.7475) loss_zs_kd 0.3348 (0.4070) loss_oracle 0.3587 (0.4725) acc 62.5000 (49.1536) kd_loss 0.8384 (0.9356) lr 3.6258e-04 eta 0:05:31
epoch [38/50] batch [260/319] time 0.085 (0.085) data 0.000 (0.002) loss 1.7105 (1.4260) ce_loss 1.6973 (1.3561) teacher_loss 0.9173 (0.7498) loss_zs_kd 0.4702 (0.4065) loss_oracle 0.5581 (0.4730) acc 37.5000 (49.0505) kd_loss 0.8526 (0.9346) lr 3.6258e-04 eta 0:05:29
epoch [38/50] batch [280/319] time 0.086 (0.085) data 0.000 (0.002) loss 1.2328 (1.4241) ce_loss 1.1221 (1.3566) teacher_loss 0.6164 (0.7493) loss_zs_kd 0.4160 (0.4066) loss_oracle 0.4084 (0.4715) acc 59.3750 (49.0960) kd_loss 0.8877 (0.9352) lr 3.6258e-04 eta 0:05:27
epoch [38/50] batch [300/319] time 0.088 (0.085) data 0.000 (0.002) loss 1.7045 (1.4255) ce_loss 1.7432 (1.3592) teacher_loss 0.9500 (0.7508) loss_zs_kd 0.4292 (0.4068) loss_oracle 0.5400 (0.4713) acc 34.3750 (49.0104) kd_loss 0.9777 (0.9331) lr 3.6258e-04 eta 0:05:25
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,305
* accuracy: 52.6%
* error: 47.4%
* macro_f1: 39.7%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,048
* accuracy: 41.6%
* error: 58.4%
* macro_f1: 15.2%
******* Domain 2 best val acc:      52.6%, epoch: 38 *******
******* Domain 2 best val test acc: 41.6%, epoch: 38 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [39/50] batch [20/319] time 0.084 (0.118) data 0.000 (0.027) loss 1.3727 (1.3733) ce_loss 1.3574 (1.2821) teacher_loss 0.6853 (0.7205) loss_zs_kd 0.4161 (0.4146) loss_oracle 0.4794 (0.4456) acc 50.0000 (53.5938) kd_loss 1.0099 (0.9255) lr 3.1545e-04 eta 0:07:28
epoch [39/50] batch [40/319] time 0.085 (0.100) data 0.000 (0.014) loss 1.5719 (1.3940) ce_loss 1.6328 (1.3123) teacher_loss 0.8879 (0.7324) loss_zs_kd 0.3679 (0.4105) loss_oracle 0.5000 (0.4563) acc 43.7500 (51.4844) kd_loss 1.0472 (0.9275) lr 3.1545e-04 eta 0:06:17
epoch [39/50] batch [60/319] time 0.084 (0.094) data 0.000 (0.009) loss 1.1814 (1.3981) ce_loss 1.1953 (1.3264) teacher_loss 0.5622 (0.7377) loss_zs_kd 0.3739 (0.4029) loss_oracle 0.4322 (0.4590) acc 56.2500 (50.6771) kd_loss 0.9391 (0.9275) lr 3.1545e-04 eta 0:05:55
epoch [39/50] batch [80/319] time 0.088 (0.092) data 0.000 (0.007) loss 1.5964 (1.3982) ce_loss 1.7012 (1.3328) teacher_loss 0.8454 (0.7387) loss_zs_kd 0.4557 (0.4038) loss_oracle 0.5231 (0.4576) acc 34.3750 (50.2344) kd_loss 0.9156 (0.9226) lr 3.1545e-04 eta 0:05:44
epoch [39/50] batch [100/319] time 0.079 (0.090) data 0.000 (0.006) loss 1.7270 (1.3995) ce_loss 1.8574 (1.3419) teacher_loss 0.9419 (0.7413) loss_zs_kd 0.4658 (0.4016) loss_oracle 0.5522 (0.4573) acc 28.1250 (49.7812) kd_loss 0.8628 (0.9193) lr 3.1545e-04 eta 0:05:35
epoch [39/50] batch [120/319] time 0.083 (0.089) data 0.000 (0.005) loss 1.5639 (1.3890) ce_loss 1.3447 (1.3322) teacher_loss 0.8973 (0.7324) loss_zs_kd 0.3506 (0.4014) loss_oracle 0.4914 (0.4559) acc 50.0000 (50.3125) kd_loss 0.8924 (0.9201) lr 3.1545e-04 eta 0:05:29
epoch [39/50] batch [140/319] time 0.072 (0.087) data 0.000 (0.004) loss 1.3369 (1.3899) ce_loss 1.2637 (1.3370) teacher_loss 0.4987 (0.7301) loss_zs_kd 0.4700 (0.4012) loss_oracle 0.6032 (0.4592) acc 71.8750 (50.5580) kd_loss 0.9506 (0.9201) lr 3.1545e-04 eta 0:05:21
epoch [39/50] batch [160/319] time 0.093 (0.086) data 0.000 (0.004) loss 1.3808 (1.3841) ce_loss 1.2891 (1.3282) teacher_loss 0.7527 (0.7266) loss_zs_kd 0.4318 (0.4011) loss_oracle 0.4121 (0.4570) acc 37.5000 (50.9961) kd_loss 0.8237 (0.9191) lr 3.1545e-04 eta 0:05:16
epoch [39/50] batch [180/319] time 0.080 (0.086) data 0.000 (0.003) loss 1.3557 (1.3856) ce_loss 1.5449 (1.3330) teacher_loss 0.6281 (0.7290) loss_zs_kd 0.4227 (0.4000) loss_oracle 0.5162 (0.4566) acc 40.6250 (50.7812) kd_loss 0.9257 (0.9188) lr 3.1545e-04 eta 0:05:13
epoch [39/50] batch [200/319] time 0.091 (0.086) data 0.000 (0.003) loss 1.1546 (1.3821) ce_loss 1.1592 (1.3323) teacher_loss 0.5456 (0.7258) loss_zs_kd 0.3821 (0.3997) loss_oracle 0.4180 (0.4564) acc 68.7500 (50.8281) kd_loss 1.0338 (0.9209) lr 3.1545e-04 eta 0:05:11
epoch [39/50] batch [220/319] time 0.084 (0.086) data 0.000 (0.003) loss 1.3779 (1.3827) ce_loss 1.2441 (1.3296) teacher_loss 0.7225 (0.7247) loss_zs_kd 0.4340 (0.4016) loss_oracle 0.4385 (0.4572) acc 56.2500 (50.9517) kd_loss 0.8886 (0.9210) lr 3.1545e-04 eta 0:05:08
epoch [39/50] batch [240/319] time 0.087 (0.085) data 0.000 (0.003) loss 1.6895 (1.3879) ce_loss 1.7139 (1.3352) teacher_loss 0.9017 (0.7279) loss_zs_kd 0.4662 (0.4027) loss_oracle 0.5546 (0.4587) acc 46.8750 (50.9505) kd_loss 0.9852 (0.9212) lr 3.1545e-04 eta 0:05:06
epoch [39/50] batch [260/319] time 0.079 (0.086) data 0.000 (0.002) loss 1.3020 (1.3894) ce_loss 1.1680 (1.3326) teacher_loss 0.7147 (0.7287) loss_zs_kd 0.3583 (0.4030) loss_oracle 0.4082 (0.4592) acc 56.2500 (50.9375) kd_loss 0.8470 (0.9219) lr 3.1545e-04 eta 0:05:05
epoch [39/50] batch [280/319] time 0.082 (0.085) data 0.000 (0.002) loss 1.6408 (1.3933) ce_loss 1.6533 (1.3361) teacher_loss 1.0620 (0.7330) loss_zs_kd 0.4050 (0.4031) loss_oracle 0.3762 (0.4588) acc 50.0000 (50.8817) kd_loss 1.0012 (0.9212) lr 3.1545e-04 eta 0:05:03
epoch [39/50] batch [300/319] time 0.080 (0.086) data 0.000 (0.002) loss 1.4332 (1.3953) ce_loss 1.3086 (1.3378) teacher_loss 0.7534 (0.7356) loss_zs_kd 0.4516 (0.4035) loss_oracle 0.4540 (0.4579) acc 46.8750 (50.7812) kd_loss 0.9535 (0.9204) lr 3.1545e-04 eta 0:05:01
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,245
* accuracy: 51.3%
* error: 48.7%
* macro_f1: 39.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,879
* accuracy: 39.8%
* error: 60.2%
* macro_f1: 15.8%
******* Domain 2 best val acc:      52.6%, epoch: 38 *******
******* Domain 2 best val test acc: 41.6%, epoch: 38 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [40/50] batch [20/319] time 0.088 (0.114) data 0.000 (0.030) loss 1.3788 (1.3522) ce_loss 1.2754 (1.2948) teacher_loss 0.7834 (0.7040) loss_zs_kd 0.3630 (0.3827) loss_oracle 0.4140 (0.4568) acc 53.1250 (53.2812) kd_loss 0.9408 (0.9367) lr 2.7103e-04 eta 0:06:38
epoch [40/50] batch [40/319] time 0.085 (0.100) data 0.000 (0.015) loss 1.3044 (1.4084) ce_loss 1.1494 (1.3566) teacher_loss 0.5934 (0.7481) loss_zs_kd 0.3717 (0.3975) loss_oracle 0.5251 (0.4616) acc 56.2500 (50.9375) kd_loss 0.9992 (0.9239) lr 2.7103e-04 eta 0:05:45
epoch [40/50] batch [60/319] time 0.088 (0.095) data 0.000 (0.010) loss 1.4063 (1.4168) ce_loss 1.5010 (1.3644) teacher_loss 0.6777 (0.7461) loss_zs_kd 0.4768 (0.4036) loss_oracle 0.4902 (0.4689) acc 40.6250 (49.6354) kd_loss 0.8597 (0.9145) lr 2.7103e-04 eta 0:05:27
epoch [40/50] batch [80/319] time 0.084 (0.092) data 0.000 (0.008) loss 1.1862 (1.4054) ce_loss 1.1279 (1.3348) teacher_loss 0.5735 (0.7359) loss_zs_kd 0.3744 (0.4033) loss_oracle 0.4255 (0.4678) acc 59.3750 (50.2734) kd_loss 0.9950 (0.9142) lr 2.7103e-04 eta 0:05:14
epoch [40/50] batch [100/319] time 0.082 (0.089) data 0.000 (0.006) loss 1.2357 (1.4018) ce_loss 1.1562 (1.3381) teacher_loss 0.6265 (0.7341) loss_zs_kd 0.3375 (0.3996) loss_oracle 0.4405 (0.4679) acc 50.0000 (50.0938) kd_loss 0.9264 (0.9169) lr 2.7103e-04 eta 0:05:03
epoch [40/50] batch [120/319] time 0.088 (0.087) data 0.000 (0.005) loss 1.3674 (1.3998) ce_loss 1.3887 (1.3273) teacher_loss 0.6193 (0.7313) loss_zs_kd 0.4453 (0.3998) loss_oracle 0.5255 (0.4686) acc 56.2500 (50.5729) kd_loss 0.9439 (0.9158) lr 2.7103e-04 eta 0:04:55
epoch [40/50] batch [140/319] time 0.083 (0.087) data 0.000 (0.005) loss 1.4323 (1.4019) ce_loss 1.3350 (1.3327) teacher_loss 0.8110 (0.7365) loss_zs_kd 0.3748 (0.3971) loss_oracle 0.4340 (0.4669) acc 40.6250 (50.1562) kd_loss 0.8896 (0.9136) lr 2.7103e-04 eta 0:04:52
epoch [40/50] batch [160/319] time 0.083 (0.087) data 0.000 (0.004) loss 1.4667 (1.3978) ce_loss 1.4863 (1.3296) teacher_loss 0.7416 (0.7334) loss_zs_kd 0.4051 (0.3997) loss_oracle 0.5225 (0.4646) acc 40.6250 (50.3516) kd_loss 1.0206 (0.9131) lr 2.7103e-04 eta 0:04:49
epoch [40/50] batch [180/319] time 0.079 (0.086) data 0.000 (0.004) loss 1.5629 (1.3998) ce_loss 1.7129 (1.3338) teacher_loss 0.9516 (0.7340) loss_zs_kd 0.3901 (0.4002) loss_oracle 0.4162 (0.4658) acc 46.8750 (50.3299) kd_loss 0.9818 (0.9121) lr 2.7103e-04 eta 0:04:47
epoch [40/50] batch [200/319] time 0.085 (0.086) data 0.000 (0.003) loss 1.2811 (1.4103) ce_loss 1.2432 (1.3457) teacher_loss 0.7193 (0.7446) loss_zs_kd 0.3942 (0.3998) loss_oracle 0.3647 (0.4658) acc 59.3750 (49.9531) kd_loss 0.8143 (0.9090) lr 2.7103e-04 eta 0:04:44
epoch [40/50] batch [220/319] time 0.084 (0.085) data 0.000 (0.003) loss 1.6012 (1.4139) ce_loss 1.5605 (1.3522) teacher_loss 0.9378 (0.7497) loss_zs_kd 0.4297 (0.3997) loss_oracle 0.4485 (0.4644) acc 34.3750 (49.6023) kd_loss 0.8330 (0.9069) lr 2.7103e-04 eta 0:04:41
epoch [40/50] batch [240/319] time 0.083 (0.085) data 0.000 (0.003) loss 1.6343 (1.4135) ce_loss 1.4297 (1.3495) teacher_loss 1.0230 (0.7493) loss_zs_kd 0.3887 (0.3999) loss_oracle 0.4169 (0.4642) acc 53.1250 (49.5833) kd_loss 0.8477 (0.9050) lr 2.7103e-04 eta 0:04:37
epoch [40/50] batch [260/319] time 0.086 (0.085) data 0.001 (0.003) loss 1.4629 (1.4144) ce_loss 1.4941 (1.3491) teacher_loss 0.7254 (0.7503) loss_zs_kd 0.4420 (0.4003) loss_oracle 0.5166 (0.4640) acc 43.7500 (49.5553) kd_loss 0.9111 (0.9027) lr 2.7103e-04 eta 0:04:35
epoch [40/50] batch [280/319] time 0.074 (0.085) data 0.000 (0.002) loss 1.4589 (1.4181) ce_loss 1.2295 (1.3506) teacher_loss 0.9114 (0.7547) loss_zs_kd 0.3335 (0.3989) loss_oracle 0.3807 (0.4639) acc 59.3750 (49.5982) kd_loss 0.7272 (0.9001) lr 2.7103e-04 eta 0:04:34
epoch [40/50] batch [300/319] time 0.078 (0.085) data 0.000 (0.002) loss 1.4534 (1.4202) ce_loss 1.3750 (1.3556) teacher_loss 0.8222 (0.7574) loss_zs_kd 0.3889 (0.3989) loss_oracle 0.4367 (0.4634) acc 46.8750 (49.6667) kd_loss 0.8725 (0.8994) lr 2.7103e-04 eta 0:04:31
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,227
* accuracy: 50.9%
* error: 49.1%
* macro_f1: 39.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,812
* accuracy: 39.2%
* error: 60.8%
* macro_f1: 15.1%
******* Domain 2 best val acc:      52.6%, epoch: 38 *******
******* Domain 2 best val test acc: 41.6%, epoch: 38 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [41/50] batch [20/319] time 0.083 (0.121) data 0.000 (0.032) loss 1.4242 (1.4219) ce_loss 1.3428 (1.4050) teacher_loss 0.6584 (0.7313) loss_zs_kd 0.4438 (0.4151) loss_oracle 0.5439 (0.4831) acc 50.0000 (46.4062) kd_loss 0.8847 (0.9016) lr 2.2949e-04 eta 0:06:24
epoch [41/50] batch [40/319] time 0.079 (0.103) data 0.000 (0.016) loss 1.5284 (1.4398) ce_loss 1.3926 (1.4013) teacher_loss 0.7985 (0.7479) loss_zs_kd 0.5003 (0.4145) loss_oracle 0.4797 (0.4847) acc 46.8750 (46.5625) kd_loss 0.8591 (0.9025) lr 2.2949e-04 eta 0:05:23
epoch [41/50] batch [60/319] time 0.086 (0.097) data 0.000 (0.011) loss 1.3907 (1.4380) ce_loss 1.3418 (1.3931) teacher_loss 0.7485 (0.7594) loss_zs_kd 0.3931 (0.4084) loss_oracle 0.4456 (0.4744) acc 53.1250 (47.6562) kd_loss 0.8853 (0.9029) lr 2.2949e-04 eta 0:05:03
epoch [41/50] batch [80/319] time 0.083 (0.094) data 0.000 (0.008) loss 1.4627 (1.4364) ce_loss 1.5410 (1.3845) teacher_loss 0.7374 (0.7581) loss_zs_kd 0.4091 (0.4106) loss_oracle 0.5207 (0.4730) acc 34.3750 (48.2812) kd_loss 0.9443 (0.9062) lr 2.2949e-04 eta 0:04:51
epoch [41/50] batch [100/319] time 0.086 (0.092) data 0.000 (0.007) loss 1.3079 (1.4344) ce_loss 1.0801 (1.3828) teacher_loss 0.7248 (0.7587) loss_zs_kd 0.3859 (0.4090) loss_oracle 0.3901 (0.4712) acc 75.0000 (49.0938) kd_loss 0.9548 (0.9074) lr 2.2949e-04 eta 0:04:44
epoch [41/50] batch [120/319] time 0.082 (0.090) data 0.000 (0.006) loss 1.2260 (1.4369) ce_loss 1.1094 (1.3709) teacher_loss 0.6363 (0.7627) loss_zs_kd 0.3568 (0.4050) loss_oracle 0.4112 (0.4717) acc 59.3750 (49.1927) kd_loss 0.9142 (0.9056) lr 2.2949e-04 eta 0:04:37
epoch [41/50] batch [140/319] time 0.084 (0.090) data 0.000 (0.005) loss 1.3191 (1.4318) ce_loss 1.0430 (1.3616) teacher_loss 0.6468 (0.7602) loss_zs_kd 0.3601 (0.4036) loss_oracle 0.4923 (0.4698) acc 56.2500 (49.8661) kd_loss 0.7929 (0.9071) lr 2.2949e-04 eta 0:04:33
epoch [41/50] batch [160/319] time 0.081 (0.089) data 0.000 (0.004) loss 1.4061 (1.4300) ce_loss 1.5664 (1.3585) teacher_loss 0.7264 (0.7597) loss_zs_kd 0.4233 (0.4014) loss_oracle 0.4681 (0.4696) acc 43.7500 (50.1758) kd_loss 0.9819 (0.9060) lr 2.2949e-04 eta 0:04:29
epoch [41/50] batch [180/319] time 0.090 (0.088) data 0.000 (0.004) loss 1.3967 (1.4302) ce_loss 1.4229 (1.3563) teacher_loss 0.7127 (0.7574) loss_zs_kd 0.4042 (0.4017) loss_oracle 0.4819 (0.4719) acc 50.0000 (50.2778) kd_loss 0.9759 (0.9056) lr 2.2949e-04 eta 0:04:25
epoch [41/50] batch [200/319] time 0.086 (0.088) data 0.000 (0.003) loss 1.2945 (1.4236) ce_loss 1.2861 (1.3505) teacher_loss 0.5626 (0.7511) loss_zs_kd 0.4130 (0.4005) loss_oracle 0.5254 (0.4723) acc 46.8750 (50.2656) kd_loss 0.9441 (0.9061) lr 2.2949e-04 eta 0:04:21
epoch [41/50] batch [220/319] time 0.080 (0.087) data 0.000 (0.003) loss 1.5422 (1.4224) ce_loss 1.5537 (1.3486) teacher_loss 0.8338 (0.7501) loss_zs_kd 0.4401 (0.4008) loss_oracle 0.4883 (0.4719) acc 37.5000 (50.3693) kd_loss 0.8600 (0.9047) lr 2.2949e-04 eta 0:04:19
epoch [41/50] batch [240/319] time 0.082 (0.087) data 0.000 (0.003) loss 1.4001 (1.4200) ce_loss 1.3154 (1.3454) teacher_loss 0.7958 (0.7495) loss_zs_kd 0.3609 (0.4006) loss_oracle 0.4239 (0.4701) acc 43.7500 (50.4427) kd_loss 0.9005 (0.9031) lr 2.2949e-04 eta 0:04:16
epoch [41/50] batch [260/319] time 0.081 (0.087) data 0.000 (0.003) loss 1.3202 (1.4204) ce_loss 1.2529 (1.3477) teacher_loss 0.7073 (0.7498) loss_zs_kd 0.3835 (0.4007) loss_oracle 0.4211 (0.4702) acc 40.6250 (50.3125) kd_loss 0.9258 (0.9035) lr 2.2949e-04 eta 0:04:14
epoch [41/50] batch [280/319] time 0.086 (0.087) data 0.000 (0.003) loss 1.3474 (1.4211) ce_loss 1.1514 (1.3469) teacher_loss 0.7301 (0.7506) loss_zs_kd 0.3259 (0.4008) loss_oracle 0.4544 (0.4700) acc 53.1250 (50.1451) kd_loss 0.7620 (0.9033) lr 2.2949e-04 eta 0:04:12
epoch [41/50] batch [300/319] time 0.085 (0.086) data 0.000 (0.002) loss 1.2657 (1.4194) ce_loss 1.0322 (1.3415) teacher_loss 0.6190 (0.7495) loss_zs_kd 0.3651 (0.3999) loss_oracle 0.4642 (0.4699) acc 56.2500 (50.1458) kd_loss 0.8111 (0.9017) lr 2.2949e-04 eta 0:04:09
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,263
* accuracy: 51.7%
* error: 48.3%
* macro_f1: 39.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,872
* accuracy: 39.8%
* error: 60.2%
* macro_f1: 15.1%
******* Domain 2 best val acc:      52.6%, epoch: 38 *******
******* Domain 2 best val test acc: 41.6%, epoch: 38 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [42/50] batch [20/319] time 0.080 (0.111) data 0.000 (0.026) loss 1.6396 (1.4285) ce_loss 1.5430 (1.3782) teacher_loss 0.8565 (0.7766) loss_zs_kd 0.4481 (0.3810) loss_oracle 0.5590 (0.4615) acc 31.2500 (47.8125) kd_loss 0.8585 (0.9075) lr 1.9098e-04 eta 0:05:15
epoch [42/50] batch [40/319] time 0.088 (0.097) data 0.000 (0.013) loss 1.2049 (1.4258) ce_loss 1.0840 (1.3645) teacher_loss 0.5041 (0.7596) loss_zs_kd 0.3749 (0.3914) loss_oracle 0.5133 (0.4705) acc 65.6250 (48.7500) kd_loss 0.9527 (0.9141) lr 1.9098e-04 eta 0:04:33
epoch [42/50] batch [60/319] time 0.082 (0.093) data 0.000 (0.009) loss 1.4603 (1.4272) ce_loss 1.3584 (1.3676) teacher_loss 0.7734 (0.7578) loss_zs_kd 0.3672 (0.3933) loss_oracle 0.5032 (0.4727) acc 53.1250 (49.3750) kd_loss 0.9366 (0.9189) lr 1.9098e-04 eta 0:04:20
epoch [42/50] batch [80/319] time 0.088 (0.090) data 0.000 (0.007) loss 1.4381 (1.4305) ce_loss 1.4717 (1.3789) teacher_loss 0.7717 (0.7587) loss_zs_kd 0.3916 (0.3963) loss_oracle 0.4706 (0.4736) acc 40.6250 (49.4531) kd_loss 0.8113 (0.9135) lr 1.9098e-04 eta 0:04:11
epoch [42/50] batch [100/319] time 0.090 (0.089) data 0.000 (0.005) loss 1.8282 (1.4419) ce_loss 1.4199 (1.3898) teacher_loss 1.1584 (0.7655) loss_zs_kd 0.4327 (0.4014) loss_oracle 0.4534 (0.4757) acc 53.1250 (49.0312) kd_loss 0.8462 (0.9089) lr 1.9098e-04 eta 0:04:07
epoch [42/50] batch [120/319] time 0.086 (0.087) data 0.000 (0.005) loss 1.5596 (1.4299) ce_loss 1.4678 (1.3672) teacher_loss 0.8709 (0.7558) loss_zs_kd 0.4283 (0.4029) loss_oracle 0.4746 (0.4727) acc 43.7500 (49.5573) kd_loss 0.8530 (0.9085) lr 1.9098e-04 eta 0:04:00
epoch [42/50] batch [140/319] time 0.084 (0.086) data 0.000 (0.004) loss 1.2689 (1.4285) ce_loss 1.1611 (1.3643) teacher_loss 0.4921 (0.7527) loss_zs_kd 0.4328 (0.4043) loss_oracle 0.5603 (0.4737) acc 53.1250 (49.6429) kd_loss 0.8555 (0.9060) lr 1.9098e-04 eta 0:03:55
epoch [42/50] batch [160/319] time 0.075 (0.086) data 0.000 (0.003) loss 1.6722 (1.4267) ce_loss 1.4189 (1.3567) teacher_loss 0.9558 (0.7518) loss_zs_kd 0.4676 (0.4048) loss_oracle 0.4826 (0.4725) acc 43.7500 (49.5898) kd_loss 0.9277 (0.9061) lr 1.9098e-04 eta 0:03:51
epoch [42/50] batch [180/319] time 0.081 (0.085) data 0.000 (0.003) loss 1.3730 (1.4263) ce_loss 1.2393 (1.3604) teacher_loss 0.6946 (0.7513) loss_zs_kd 0.4341 (0.4075) loss_oracle 0.4614 (0.4713) acc 59.3750 (49.5139) kd_loss 0.9608 (0.9084) lr 1.9098e-04 eta 0:03:48
epoch [42/50] batch [200/319] time 0.078 (0.085) data 0.000 (0.003) loss 1.4067 (1.4226) ce_loss 1.2871 (1.3561) teacher_loss 0.7768 (0.7480) loss_zs_kd 0.3458 (0.4065) loss_oracle 0.4570 (0.4714) acc 43.7500 (49.5000) kd_loss 0.8850 (0.9094) lr 1.9098e-04 eta 0:03:46
epoch [42/50] batch [220/319] time 0.079 (0.085) data 0.000 (0.003) loss 1.3371 (1.4207) ce_loss 1.2715 (1.3496) teacher_loss 0.7532 (0.7452) loss_zs_kd 0.3531 (0.4067) loss_oracle 0.4073 (0.4722) acc 56.2500 (49.6733) kd_loss 0.8390 (0.9091) lr 1.9098e-04 eta 0:03:44
epoch [42/50] batch [240/319] time 0.086 (0.085) data 0.000 (0.002) loss 1.5408 (1.4184) ce_loss 1.4766 (1.3489) teacher_loss 0.8331 (0.7427) loss_zs_kd 0.3978 (0.4058) loss_oracle 0.5087 (0.4729) acc 46.8750 (49.5833) kd_loss 0.8616 (0.9079) lr 1.9098e-04 eta 0:03:43
epoch [42/50] batch [260/319] time 0.080 (0.085) data 0.000 (0.002) loss 1.6162 (1.4159) ce_loss 1.5938 (1.3476) teacher_loss 0.8089 (0.7397) loss_zs_kd 0.4625 (0.4057) loss_oracle 0.5761 (0.4734) acc 40.6250 (49.5433) kd_loss 0.8981 (0.9081) lr 1.9098e-04 eta 0:03:41
epoch [42/50] batch [280/319] time 0.090 (0.084) data 0.000 (0.002) loss 1.4050 (1.4164) ce_loss 1.2979 (1.3471) teacher_loss 0.8297 (0.7405) loss_zs_kd 0.3688 (0.4064) loss_oracle 0.3910 (0.4728) acc 59.3750 (49.5647) kd_loss 0.8305 (0.9061) lr 1.9098e-04 eta 0:03:38
epoch [42/50] batch [300/319] time 0.077 (0.084) data 0.000 (0.002) loss 1.3771 (1.4191) ce_loss 1.1592 (1.3490) teacher_loss 0.6780 (0.7419) loss_zs_kd 0.4393 (0.4075) loss_oracle 0.4794 (0.4735) acc 53.1250 (49.5625) kd_loss 0.8330 (0.9053) lr 1.9098e-04 eta 0:03:36
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,301
* accuracy: 52.6%
* error: 47.4%
* macro_f1: 40.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,970
* accuracy: 40.8%
* error: 59.2%
* macro_f1: 15.2%
******* Domain 2 best val acc:      52.6%, epoch: 38 *******
******* Domain 2 best val test acc: 41.6%, epoch: 38 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [43/50] batch [20/319] time 0.071 (0.101) data 0.000 (0.027) loss 1.3812 (1.4050) ce_loss 1.3789 (1.3525) teacher_loss 0.6364 (0.7271) loss_zs_kd 0.4948 (0.4068) loss_oracle 0.4974 (0.4745) acc 56.2500 (51.2500) kd_loss 0.9693 (0.9184) lr 1.5567e-04 eta 0:04:15
epoch [43/50] batch [40/319] time 0.084 (0.090) data 0.000 (0.013) loss 1.6704 (1.4252) ce_loss 1.7070 (1.3769) teacher_loss 0.9694 (0.7338) loss_zs_kd 0.4075 (0.4061) loss_oracle 0.4973 (0.4883) acc 37.5000 (48.1250) kd_loss 0.9075 (0.9163) lr 1.5567e-04 eta 0:03:45
epoch [43/50] batch [60/319] time 0.080 (0.087) data 0.000 (0.009) loss 1.6339 (1.4193) ce_loss 1.3115 (1.3540) teacher_loss 0.9637 (0.7356) loss_zs_kd 0.4424 (0.4058) loss_oracle 0.4490 (0.4808) acc 46.8750 (48.5938) kd_loss 0.8410 (0.9028) lr 1.5567e-04 eta 0:03:36
epoch [43/50] batch [80/319] time 0.070 (0.085) data 0.000 (0.007) loss 1.3977 (1.4280) ce_loss 1.1641 (1.3632) teacher_loss 0.7090 (0.7427) loss_zs_kd 0.3983 (0.4067) loss_oracle 0.4896 (0.4819) acc 62.5000 (48.3203) kd_loss 0.8973 (0.9010) lr 1.5567e-04 eta 0:03:30
epoch [43/50] batch [100/319] time 0.093 (0.084) data 0.000 (0.006) loss 1.3316 (1.4198) ce_loss 1.2852 (1.3564) teacher_loss 0.6535 (0.7379) loss_zs_kd 0.3784 (0.4064) loss_oracle 0.4890 (0.4788) acc 53.1250 (49.0938) kd_loss 0.8994 (0.8960) lr 1.5567e-04 eta 0:03:26
epoch [43/50] batch [120/319] time 0.079 (0.084) data 0.000 (0.005) loss 1.3396 (1.4172) ce_loss 1.1816 (1.3554) teacher_loss 0.7274 (0.7364) loss_zs_kd 0.3931 (0.4052) loss_oracle 0.4156 (0.4782) acc 46.8750 (49.1146) kd_loss 0.7836 (0.8963) lr 1.5567e-04 eta 0:03:24
epoch [43/50] batch [140/319] time 0.078 (0.084) data 0.000 (0.004) loss 1.6541 (1.4228) ce_loss 1.6875 (1.3628) teacher_loss 0.9951 (0.7398) loss_zs_kd 0.3566 (0.4076) loss_oracle 0.4807 (0.4792) acc 28.1250 (48.3705) kd_loss 0.8579 (0.8944) lr 1.5567e-04 eta 0:03:22
epoch [43/50] batch [160/319] time 0.082 (0.084) data 0.000 (0.004) loss 1.3096 (1.4182) ce_loss 1.3418 (1.3592) teacher_loss 0.6253 (0.7339) loss_zs_kd 0.4232 (0.4092) loss_oracle 0.4728 (0.4797) acc 37.5000 (48.6133) kd_loss 0.8470 (0.8974) lr 1.5567e-04 eta 0:03:20
epoch [43/50] batch [180/319] time 0.082 (0.083) data 0.000 (0.003) loss 1.3870 (1.4229) ce_loss 1.4805 (1.3634) teacher_loss 0.7680 (0.7395) loss_zs_kd 0.3733 (0.4086) loss_oracle 0.4324 (0.4791) acc 50.0000 (48.8021) kd_loss 0.9115 (0.9000) lr 1.5567e-04 eta 0:03:17
epoch [43/50] batch [200/319] time 0.080 (0.083) data 0.000 (0.003) loss 1.4724 (1.4212) ce_loss 1.2490 (1.3594) teacher_loss 0.8560 (0.7387) loss_zs_kd 0.3718 (0.4089) loss_oracle 0.4304 (0.4780) acc 40.6250 (48.7812) kd_loss 0.8112 (0.9019) lr 1.5567e-04 eta 0:03:14
epoch [43/50] batch [220/319] time 0.078 (0.082) data 0.000 (0.003) loss 1.5396 (1.4244) ce_loss 1.4736 (1.3644) teacher_loss 0.8536 (0.7443) loss_zs_kd 0.4001 (0.4074) loss_oracle 0.4860 (0.4764) acc 43.7500 (48.7216) kd_loss 0.8918 (0.9021) lr 1.5567e-04 eta 0:03:11
epoch [43/50] batch [240/319] time 0.085 (0.082) data 0.000 (0.002) loss 1.3149 (1.4211) ce_loss 1.2041 (1.3592) teacher_loss 0.6404 (0.7419) loss_zs_kd 0.4735 (0.4074) loss_oracle 0.4377 (0.4755) acc 53.1250 (48.9714) kd_loss 0.8212 (0.9029) lr 1.5567e-04 eta 0:03:10
epoch [43/50] batch [260/319] time 0.085 (0.083) data 0.001 (0.002) loss 1.4309 (1.4215) ce_loss 1.1523 (1.3574) teacher_loss 0.6726 (0.7417) loss_zs_kd 0.4660 (0.4073) loss_oracle 0.5254 (0.4761) acc 59.3750 (49.0625) kd_loss 0.8080 (0.9037) lr 1.5567e-04 eta 0:03:09
epoch [43/50] batch [280/319] time 0.085 (0.083) data 0.000 (0.002) loss 1.4992 (1.4190) ce_loss 1.3154 (1.3547) teacher_loss 0.8295 (0.7394) loss_zs_kd 0.3957 (0.4069) loss_oracle 0.4719 (0.4762) acc 56.2500 (49.3192) kd_loss 0.8621 (0.9019) lr 1.5567e-04 eta 0:03:07
epoch [43/50] batch [300/319] time 0.084 (0.083) data 0.000 (0.002) loss 1.4374 (1.4185) ce_loss 1.3174 (1.3522) teacher_loss 0.7928 (0.7392) loss_zs_kd 0.3713 (0.4070) loss_oracle 0.4589 (0.4758) acc 46.8750 (49.3646) kd_loss 0.9528 (0.9015) lr 1.5567e-04 eta 0:03:06
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,263
* accuracy: 51.7%
* error: 48.3%
* macro_f1: 39.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,977
* accuracy: 40.8%
* error: 59.2%
* macro_f1: 15.3%
******* Domain 2 best val acc:      52.6%, epoch: 38 *******
******* Domain 2 best val test acc: 41.6%, epoch: 38 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [44/50] batch [20/319] time 0.078 (0.113) data 0.000 (0.027) loss 1.5597 (1.4118) ce_loss 1.3828 (1.3263) teacher_loss 0.8966 (0.7299) loss_zs_kd 0.4028 (0.4003) loss_oracle 0.4617 (0.4817) acc 43.7500 (48.4375) kd_loss 0.7697 (0.9053) lr 1.2369e-04 eta 0:04:11
epoch [44/50] batch [40/319] time 0.075 (0.094) data 0.000 (0.014) loss 1.5677 (1.4194) ce_loss 1.4141 (1.3384) teacher_loss 1.0165 (0.7456) loss_zs_kd 0.3406 (0.4032) loss_oracle 0.3809 (0.4722) acc 46.8750 (49.1406) kd_loss 0.7517 (0.8823) lr 1.2369e-04 eta 0:03:26
epoch [44/50] batch [60/319] time 0.075 (0.089) data 0.001 (0.009) loss 1.1066 (1.4087) ce_loss 1.1836 (1.3278) teacher_loss 0.4739 (0.7425) loss_zs_kd 0.3695 (0.3978) loss_oracle 0.4480 (0.4673) acc 53.1250 (50.0000) kd_loss 1.0107 (0.8941) lr 1.2369e-04 eta 0:03:12
epoch [44/50] batch [80/319] time 0.086 (0.087) data 0.000 (0.007) loss 1.4944 (1.4022) ce_loss 1.4590 (1.3260) teacher_loss 0.7311 (0.7355) loss_zs_kd 0.4202 (0.3989) loss_oracle 0.5531 (0.4672) acc 53.1250 (50.6250) kd_loss 1.0671 (0.8981) lr 1.2369e-04 eta 0:03:08
epoch [44/50] batch [100/319] time 0.074 (0.085) data 0.000 (0.006) loss 1.4695 (1.4068) ce_loss 1.3408 (1.3322) teacher_loss 0.7395 (0.7376) loss_zs_kd 0.3787 (0.4013) loss_oracle 0.5407 (0.4685) acc 43.7500 (50.0000) kd_loss 0.9392 (0.9014) lr 1.2369e-04 eta 0:03:01
epoch [44/50] batch [120/319] time 0.082 (0.085) data 0.000 (0.005) loss 1.4482 (1.4147) ce_loss 1.6123 (1.3471) teacher_loss 0.7389 (0.7485) loss_zs_kd 0.4333 (0.3988) loss_oracle 0.4927 (0.4669) acc 46.8750 (49.7656) kd_loss 0.9279 (0.8959) lr 1.2369e-04 eta 0:02:58
epoch [44/50] batch [140/319] time 0.080 (0.084) data 0.000 (0.004) loss 1.4995 (1.4167) ce_loss 1.5850 (1.3481) teacher_loss 0.8062 (0.7528) loss_zs_kd 0.3769 (0.3982) loss_oracle 0.5048 (0.4648) acc 43.7500 (49.6429) kd_loss 0.8321 (0.8925) lr 1.2369e-04 eta 0:02:56
epoch [44/50] batch [160/319] time 0.080 (0.084) data 0.000 (0.004) loss 1.3985 (1.4210) ce_loss 1.4053 (1.3464) teacher_loss 0.7682 (0.7558) loss_zs_kd 0.3667 (0.3992) loss_oracle 0.4469 (0.4656) acc 46.8750 (49.5117) kd_loss 0.8794 (0.8904) lr 1.2369e-04 eta 0:02:55
epoch [44/50] batch [180/319] time 0.088 (0.084) data 0.000 (0.003) loss 1.5397 (1.4250) ce_loss 1.4072 (1.3541) teacher_loss 0.9273 (0.7571) loss_zs_kd 0.3530 (0.3996) loss_oracle 0.4359 (0.4681) acc 46.8750 (49.0104) kd_loss 0.8142 (0.8917) lr 1.2369e-04 eta 0:02:53
epoch [44/50] batch [200/319] time 0.090 (0.085) data 0.000 (0.003) loss 1.0604 (1.4222) ce_loss 0.9546 (1.3532) teacher_loss 0.3808 (0.7524) loss_zs_kd 0.3527 (0.4015) loss_oracle 0.5033 (0.4690) acc 62.5000 (49.1406) kd_loss 0.8422 (0.8930) lr 1.2369e-04 eta 0:02:51
epoch [44/50] batch [220/319] time 0.072 (0.084) data 0.000 (0.003) loss 1.3555 (1.4207) ce_loss 1.1709 (1.3542) teacher_loss 0.6771 (0.7481) loss_zs_kd 0.4089 (0.4036) loss_oracle 0.4739 (0.4708) acc 53.1250 (49.1903) kd_loss 0.8286 (0.8939) lr 1.2369e-04 eta 0:02:49
epoch [44/50] batch [240/319] time 0.081 (0.084) data 0.000 (0.002) loss 1.6600 (1.4194) ce_loss 1.4873 (1.3507) teacher_loss 0.9107 (0.7455) loss_zs_kd 0.4782 (0.4048) loss_oracle 0.5103 (0.4716) acc 65.6250 (49.5052) kd_loss 0.9638 (0.8961) lr 1.2369e-04 eta 0:02:46
epoch [44/50] batch [260/319] time 0.077 (0.084) data 0.000 (0.002) loss 1.5182 (1.4198) ce_loss 1.3984 (1.3482) teacher_loss 0.7441 (0.7447) loss_zs_kd 0.3878 (0.4047) loss_oracle 0.5802 (0.4728) acc 50.0000 (49.3870) kd_loss 0.9157 (0.8966) lr 1.2369e-04 eta 0:02:45
epoch [44/50] batch [280/319] time 0.079 (0.083) data 0.000 (0.002) loss 1.6438 (1.4203) ce_loss 1.5703 (1.3460) teacher_loss 0.9491 (0.7452) loss_zs_kd 0.3622 (0.4043) loss_oracle 0.5136 (0.4729) acc 40.6250 (49.5647) kd_loss 0.9116 (0.8971) lr 1.2369e-04 eta 0:02:42
epoch [44/50] batch [300/319] time 0.080 (0.083) data 0.000 (0.002) loss 1.4765 (1.4206) ce_loss 1.2822 (1.3459) teacher_loss 0.8437 (0.7467) loss_zs_kd 0.3970 (0.4038) loss_oracle 0.4343 (0.4720) acc 56.2500 (49.5938) kd_loss 0.8049 (0.8962) lr 1.2369e-04 eta 0:02:40
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,256
* accuracy: 51.5%
* error: 48.5%
* macro_f1: 39.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,905
* accuracy: 40.1%
* error: 59.9%
* macro_f1: 15.0%
******* Domain 2 best val acc:      52.6%, epoch: 38 *******
******* Domain 2 best val test acc: 41.6%, epoch: 38 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [45/50] batch [20/319] time 0.078 (0.119) data 0.000 (0.033) loss 1.3451 (1.3857) ce_loss 1.2305 (1.3174) teacher_loss 0.6739 (0.7210) loss_zs_kd 0.3160 (0.3997) loss_oracle 0.5133 (0.4648) acc 62.5000 (51.8750) kd_loss 0.8737 (0.9111) lr 9.5173e-05 eta 0:03:44
epoch [45/50] batch [40/319] time 0.078 (0.101) data 0.000 (0.017) loss 1.4053 (1.4038) ce_loss 1.3574 (1.3374) teacher_loss 0.7756 (0.7354) loss_zs_kd 0.3597 (0.3999) loss_oracle 0.4499 (0.4685) acc 50.0000 (50.7031) kd_loss 0.9693 (0.9109) lr 9.5173e-05 eta 0:03:08
epoch [45/50] batch [60/319] time 0.085 (0.094) data 0.000 (0.011) loss 1.4826 (1.4228) ce_loss 1.4375 (1.3590) teacher_loss 0.8099 (0.7543) loss_zs_kd 0.4233 (0.4060) loss_oracle 0.4611 (0.4654) acc 53.1250 (49.3750) kd_loss 0.8482 (0.9058) lr 9.5173e-05 eta 0:02:54
epoch [45/50] batch [80/319] time 0.075 (0.091) data 0.000 (0.008) loss 1.5189 (1.4175) ce_loss 1.4287 (1.3448) teacher_loss 0.7694 (0.7472) loss_zs_kd 0.4795 (0.4040) loss_oracle 0.5098 (0.4682) acc 53.1250 (50.1172) kd_loss 0.9634 (0.9063) lr 9.5173e-05 eta 0:02:46
epoch [45/50] batch [100/319] time 0.073 (0.088) data 0.000 (0.007) loss 1.3426 (1.4100) ce_loss 1.1367 (1.3421) teacher_loss 0.6915 (0.7389) loss_zs_kd 0.3747 (0.4046) loss_oracle 0.4637 (0.4688) acc 59.3750 (49.6875) kd_loss 0.8703 (0.9077) lr 9.5173e-05 eta 0:02:39
epoch [45/50] batch [120/319] time 0.082 (0.086) data 0.000 (0.006) loss 1.4735 (1.4077) ce_loss 1.2910 (1.3418) teacher_loss 0.7747 (0.7386) loss_zs_kd 0.3418 (0.4012) loss_oracle 0.5280 (0.4685) acc 46.8750 (49.4531) kd_loss 0.9204 (0.9087) lr 9.5173e-05 eta 0:02:33
epoch [45/50] batch [140/319] time 0.084 (0.085) data 0.000 (0.005) loss 1.2899 (1.4030) ce_loss 1.2373 (1.3327) teacher_loss 0.6755 (0.7353) loss_zs_kd 0.3709 (0.3999) loss_oracle 0.4289 (0.4678) acc 50.0000 (49.6652) kd_loss 0.9103 (0.9056) lr 9.5173e-05 eta 0:02:31
epoch [45/50] batch [160/319] time 0.084 (0.085) data 0.000 (0.004) loss 1.2049 (1.3967) ce_loss 1.1523 (1.3263) teacher_loss 0.6556 (0.7322) loss_zs_kd 0.3617 (0.3975) loss_oracle 0.3685 (0.4657) acc 53.1250 (49.6875) kd_loss 0.8917 (0.9067) lr 9.5173e-05 eta 0:02:29
epoch [45/50] batch [180/319] time 0.085 (0.085) data 0.000 (0.004) loss 1.3474 (1.3971) ce_loss 1.1855 (1.3211) teacher_loss 0.7030 (0.7298) loss_zs_kd 0.4806 (0.3996) loss_oracle 0.4042 (0.4675) acc 53.1250 (49.8090) kd_loss 0.8556 (0.9077) lr 9.5173e-05 eta 0:02:27
epoch [45/50] batch [200/319] time 0.077 (0.084) data 0.000 (0.004) loss 1.4187 (1.4000) ce_loss 1.5020 (1.3285) teacher_loss 0.7324 (0.7322) loss_zs_kd 0.3981 (0.3985) loss_oracle 0.4873 (0.4685) acc 31.2500 (49.5625) kd_loss 0.8233 (0.9047) lr 9.5173e-05 eta 0:02:24
epoch [45/50] batch [220/319] time 0.086 (0.084) data 0.000 (0.003) loss 1.1456 (1.4007) ce_loss 0.9976 (1.3295) teacher_loss 0.4586 (0.7331) loss_zs_kd 0.3419 (0.3979) loss_oracle 0.5160 (0.4686) acc 59.3750 (49.4744) kd_loss 0.9300 (0.9054) lr 9.5173e-05 eta 0:02:22
epoch [45/50] batch [240/319] time 0.089 (0.084) data 0.000 (0.003) loss 1.5812 (1.3981) ce_loss 1.7002 (1.3299) teacher_loss 0.8941 (0.7300) loss_zs_kd 0.4210 (0.3980) loss_oracle 0.4765 (0.4691) acc 28.1250 (49.4010) kd_loss 0.8813 (0.9074) lr 9.5173e-05 eta 0:02:21
epoch [45/50] batch [260/319] time 0.081 (0.084) data 0.000 (0.003) loss 1.6519 (1.4056) ce_loss 1.5215 (1.3412) teacher_loss 0.8830 (0.7370) loss_zs_kd 0.4112 (0.3981) loss_oracle 0.5633 (0.4695) acc 40.6250 (49.1466) kd_loss 0.7748 (0.9095) lr 9.5173e-05 eta 0:02:19
epoch [45/50] batch [280/319] time 0.081 (0.084) data 0.000 (0.003) loss 1.1801 (1.4061) ce_loss 1.0508 (1.3412) teacher_loss 0.5874 (0.7388) loss_zs_kd 0.4020 (0.3985) loss_oracle 0.3917 (0.4680) acc 62.5000 (49.1853) kd_loss 0.9173 (0.9085) lr 9.5173e-05 eta 0:02:17
epoch [45/50] batch [300/319] time 0.074 (0.084) data 0.000 (0.002) loss 1.1989 (1.4040) ce_loss 1.0029 (1.3362) teacher_loss 0.6347 (0.7370) loss_zs_kd 0.3189 (0.3988) loss_oracle 0.4048 (0.4676) acc 59.3750 (49.3646) kd_loss 0.9244 (0.9078) lr 9.5173e-05 eta 0:02:15
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,261
* accuracy: 51.6%
* error: 48.4%
* macro_f1: 39.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,986
* accuracy: 40.9%
* error: 59.1%
* macro_f1: 15.2%
******* Domain 2 best val acc:      52.6%, epoch: 38 *******
******* Domain 2 best val test acc: 41.6%, epoch: 38 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [46/50] batch [20/319] time 0.075 (0.110) data 0.000 (0.027) loss 1.4058 (1.3577) ce_loss 1.4863 (1.2667) teacher_loss 0.6967 (0.6977) loss_zs_kd 0.3899 (0.4068) loss_oracle 0.5143 (0.4567) acc 43.7500 (52.1875) kd_loss 0.8867 (0.9000) lr 7.0224e-05 eta 0:02:53
epoch [46/50] batch [40/319] time 0.092 (0.095) data 0.000 (0.013) loss 1.5399 (1.3899) ce_loss 1.4131 (1.2998) teacher_loss 0.8405 (0.7252) loss_zs_kd 0.3923 (0.4037) loss_oracle 0.5032 (0.4629) acc 46.8750 (51.3281) kd_loss 0.8381 (0.9065) lr 7.0224e-05 eta 0:02:27
epoch [46/50] batch [60/319] time 0.079 (0.091) data 0.000 (0.009) loss 1.4201 (1.3958) ce_loss 1.4033 (1.3159) teacher_loss 0.7395 (0.7215) loss_zs_kd 0.3895 (0.4041) loss_oracle 0.4858 (0.4722) acc 56.2500 (50.7292) kd_loss 0.8695 (0.9092) lr 7.0224e-05 eta 0:02:18
epoch [46/50] batch [80/319] time 0.080 (0.089) data 0.000 (0.007) loss 1.3710 (1.4024) ce_loss 1.3320 (1.3245) teacher_loss 0.7218 (0.7247) loss_zs_kd 0.3491 (0.4056) loss_oracle 0.4746 (0.4749) acc 56.2500 (50.9375) kd_loss 0.9256 (0.9151) lr 7.0224e-05 eta 0:02:14
epoch [46/50] batch [100/319] time 0.074 (0.088) data 0.000 (0.006) loss 1.1896 (1.4016) ce_loss 1.1279 (1.3310) teacher_loss 0.5412 (0.7209) loss_zs_kd 0.3849 (0.4070) loss_oracle 0.4560 (0.4772) acc 46.8750 (50.5938) kd_loss 0.9812 (0.9199) lr 7.0224e-05 eta 0:02:11
epoch [46/50] batch [120/319] time 0.072 (0.086) data 0.000 (0.005) loss 1.4108 (1.3943) ce_loss 1.3379 (1.3229) teacher_loss 0.7839 (0.7170) loss_zs_kd 0.3696 (0.4051) loss_oracle 0.4422 (0.4747) acc 53.1250 (50.5729) kd_loss 0.9219 (0.9168) lr 7.0224e-05 eta 0:02:06
epoch [46/50] batch [140/319] time 0.084 (0.084) data 0.000 (0.004) loss 1.2232 (1.3986) ce_loss 1.0186 (1.3336) teacher_loss 0.6398 (0.7208) loss_zs_kd 0.3042 (0.4052) loss_oracle 0.4313 (0.4752) acc 65.6250 (50.0893) kd_loss 0.8464 (0.9164) lr 7.0224e-05 eta 0:02:02
epoch [46/50] batch [160/319] time 0.081 (0.084) data 0.000 (0.004) loss 1.1430 (1.3943) ce_loss 1.0020 (1.3256) teacher_loss 0.5725 (0.7186) loss_zs_kd 0.3239 (0.4058) loss_oracle 0.4085 (0.4728) acc 68.7500 (50.4297) kd_loss 0.8823 (0.9142) lr 7.0224e-05 eta 0:02:01
epoch [46/50] batch [180/319] time 0.073 (0.085) data 0.000 (0.003) loss 1.4755 (1.3976) ce_loss 1.3184 (1.3279) teacher_loss 0.7403 (0.7215) loss_zs_kd 0.3810 (0.4067) loss_oracle 0.5447 (0.4727) acc 53.1250 (50.5729) kd_loss 0.8855 (0.9121) lr 7.0224e-05 eta 0:01:59
epoch [46/50] batch [200/319] time 0.082 (0.084) data 0.000 (0.003) loss 1.4040 (1.3969) ce_loss 1.2656 (1.3280) teacher_loss 0.7655 (0.7212) loss_zs_kd 0.3792 (0.4070) loss_oracle 0.4489 (0.4722) acc 43.7500 (50.4844) kd_loss 0.7638 (0.9109) lr 7.0224e-05 eta 0:01:57
epoch [46/50] batch [220/319] time 0.087 (0.084) data 0.000 (0.003) loss 1.5119 (1.4031) ce_loss 1.3340 (1.3356) teacher_loss 0.9249 (0.7296) loss_zs_kd 0.4128 (0.4055) loss_oracle 0.3806 (0.4708) acc 50.0000 (50.0426) kd_loss 0.9194 (0.9096) lr 7.0224e-05 eta 0:01:55
epoch [46/50] batch [240/319] time 0.084 (0.084) data 0.000 (0.002) loss 1.2652 (1.4048) ce_loss 1.3379 (1.3369) teacher_loss 0.6362 (0.7304) loss_zs_kd 0.3763 (0.4062) loss_oracle 0.4409 (0.4713) acc 53.1250 (49.9870) kd_loss 0.9248 (0.9080) lr 7.0224e-05 eta 0:01:54
epoch [46/50] batch [260/319] time 0.082 (0.084) data 0.000 (0.002) loss 1.3180 (1.4044) ce_loss 1.1963 (1.3367) teacher_loss 0.6032 (0.7305) loss_zs_kd 0.3934 (0.4065) loss_oracle 0.5181 (0.4706) acc 59.3750 (49.8918) kd_loss 0.9855 (0.9084) lr 7.0224e-05 eta 0:01:52
epoch [46/50] batch [280/319] time 0.075 (0.084) data 0.000 (0.002) loss 1.4462 (1.4069) ce_loss 1.4131 (1.3385) teacher_loss 0.8243 (0.7346) loss_zs_kd 0.3675 (0.4061) loss_oracle 0.4382 (0.4693) acc 43.7500 (49.7433) kd_loss 0.8700 (0.9092) lr 7.0224e-05 eta 0:01:50
epoch [46/50] batch [300/319] time 0.075 (0.084) data 0.000 (0.002) loss 1.5809 (1.4052) ce_loss 1.6299 (1.3365) teacher_loss 0.8879 (0.7330) loss_zs_kd 0.4190 (0.4052) loss_oracle 0.4835 (0.4696) acc 37.5000 (49.7188) kd_loss 0.8428 (0.9083) lr 7.0224e-05 eta 0:01:48
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,263
* accuracy: 51.7%
* error: 48.3%
* macro_f1: 39.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,935
* accuracy: 40.4%
* error: 59.6%
* macro_f1: 15.1%
******* Domain 2 best val acc:      52.6%, epoch: 38 *******
******* Domain 2 best val test acc: 41.6%, epoch: 38 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [47/50] batch [20/319] time 0.080 (0.112) data 0.000 (0.025) loss 1.2876 (1.4468) ce_loss 1.2891 (1.3704) teacher_loss 0.5662 (0.7757) loss_zs_kd 0.3912 (0.3981) loss_oracle 0.5259 (0.4720) acc 53.1250 (50.4688) kd_loss 0.9649 (0.9041) lr 4.8943e-05 eta 0:02:20
epoch [47/50] batch [40/319] time 0.083 (0.098) data 0.000 (0.013) loss 1.3805 (1.4259) ce_loss 1.4229 (1.3687) teacher_loss 0.7379 (0.7611) loss_zs_kd 0.4130 (0.3974) loss_oracle 0.4361 (0.4661) acc 53.1250 (49.6094) kd_loss 0.9434 (0.9027) lr 4.8943e-05 eta 0:02:01
epoch [47/50] batch [60/319] time 0.091 (0.094) data 0.001 (0.009) loss 1.4313 (1.4202) ce_loss 1.2891 (1.3691) teacher_loss 0.7366 (0.7475) loss_zs_kd 0.4178 (0.4012) loss_oracle 0.4858 (0.4721) acc 53.1250 (48.8021) kd_loss 0.8627 (0.9075) lr 4.8943e-05 eta 0:01:54
epoch [47/50] batch [80/319] time 0.082 (0.092) data 0.000 (0.007) loss 1.3827 (1.4156) ce_loss 1.1768 (1.3642) teacher_loss 0.8128 (0.7500) loss_zs_kd 0.3581 (0.3999) loss_oracle 0.3908 (0.4656) acc 37.5000 (48.9062) kd_loss 0.8072 (0.9052) lr 4.8943e-05 eta 0:01:49
epoch [47/50] batch [100/319] time 0.086 (0.090) data 0.000 (0.005) loss 1.2206 (1.4168) ce_loss 1.1816 (1.3607) teacher_loss 0.5564 (0.7499) loss_zs_kd 0.3928 (0.4019) loss_oracle 0.4677 (0.4659) acc 50.0000 (49.3438) kd_loss 0.9019 (0.9009) lr 4.8943e-05 eta 0:01:46
epoch [47/50] batch [120/319] time 0.089 (0.089) data 0.000 (0.004) loss 1.2286 (1.4096) ce_loss 1.0938 (1.3477) teacher_loss 0.6345 (0.7420) loss_zs_kd 0.3498 (0.4021) loss_oracle 0.4192 (0.4666) acc 50.0000 (49.7396) kd_loss 0.8476 (0.8999) lr 4.8943e-05 eta 0:01:43
epoch [47/50] batch [140/319] time 0.075 (0.088) data 0.000 (0.004) loss 1.5551 (1.4066) ce_loss 1.6592 (1.3437) teacher_loss 0.9312 (0.7384) loss_zs_kd 0.4000 (0.4017) loss_oracle 0.4239 (0.4673) acc 31.2500 (49.7321) kd_loss 0.8931 (0.9009) lr 4.8943e-05 eta 0:01:40
epoch [47/50] batch [160/319] time 0.084 (0.087) data 0.000 (0.003) loss 1.1318 (1.4034) ce_loss 1.1592 (1.3395) teacher_loss 0.6343 (0.7353) loss_zs_kd 0.3060 (0.4019) loss_oracle 0.3446 (0.4672) acc 68.7500 (49.7070) kd_loss 0.9651 (0.9013) lr 4.8943e-05 eta 0:01:37
epoch [47/50] batch [180/319] time 0.077 (0.087) data 0.000 (0.003) loss 1.4715 (1.4100) ce_loss 1.4629 (1.3481) teacher_loss 0.7155 (0.7405) loss_zs_kd 0.4188 (0.4031) loss_oracle 0.5466 (0.4679) acc 40.6250 (49.3056) kd_loss 0.8658 (0.9005) lr 4.8943e-05 eta 0:01:35
epoch [47/50] batch [200/319] time 0.082 (0.087) data 0.000 (0.003) loss 1.5198 (1.4040) ce_loss 1.3975 (1.3404) teacher_loss 0.8181 (0.7360) loss_zs_kd 0.3653 (0.4019) loss_oracle 0.5191 (0.4671) acc 59.3750 (50.0000) kd_loss 1.0641 (0.9008) lr 4.8943e-05 eta 0:01:33
epoch [47/50] batch [220/319] time 0.084 (0.086) data 0.000 (0.003) loss 1.2721 (1.4030) ce_loss 1.2422 (1.3403) teacher_loss 0.5887 (0.7340) loss_zs_kd 0.4138 (0.4027) loss_oracle 0.4765 (0.4676) acc 56.2500 (49.8864) kd_loss 0.8672 (0.9018) lr 4.8943e-05 eta 0:01:31
epoch [47/50] batch [240/319] time 0.079 (0.086) data 0.000 (0.002) loss 1.1673 (1.4080) ce_loss 1.0332 (1.3439) teacher_loss 0.5435 (0.7377) loss_zs_kd 0.3886 (0.4035) loss_oracle 0.4295 (0.4686) acc 65.6250 (49.7396) kd_loss 0.8836 (0.9025) lr 4.8943e-05 eta 0:01:29
epoch [47/50] batch [260/319] time 0.080 (0.086) data 0.000 (0.002) loss 1.5818 (1.4120) ce_loss 1.5020 (1.3453) teacher_loss 0.9202 (0.7417) loss_zs_kd 0.3515 (0.4033) loss_oracle 0.4858 (0.4686) acc 46.8750 (49.5913) kd_loss 0.9386 (0.9018) lr 4.8943e-05 eta 0:01:27
epoch [47/50] batch [280/319] time 0.078 (0.086) data 0.000 (0.002) loss 1.5221 (1.4118) ce_loss 1.2031 (1.3414) teacher_loss 0.9107 (0.7412) loss_zs_kd 0.3571 (0.4036) loss_oracle 0.4329 (0.4688) acc 50.0000 (49.7433) kd_loss 0.8731 (0.9021) lr 4.8943e-05 eta 0:01:25
epoch [47/50] batch [300/319] time 0.084 (0.085) data 0.000 (0.002) loss 1.2224 (1.4100) ce_loss 1.1328 (1.3422) teacher_loss 0.6017 (0.7399) loss_zs_kd 0.3555 (0.4032) loss_oracle 0.4430 (0.4685) acc 53.1250 (49.7917) kd_loss 1.0054 (0.9038) lr 4.8943e-05 eta 0:01:23
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,265
* accuracy: 51.7%
* error: 48.3%
* macro_f1: 39.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,919
* accuracy: 40.3%
* error: 59.7%
* macro_f1: 15.1%
******* Domain 2 best val acc:      52.6%, epoch: 38 *******
******* Domain 2 best val test acc: 41.6%, epoch: 38 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [48/50] batch [20/319] time 0.088 (0.115) data 0.000 (0.032) loss 1.4289 (1.4536) ce_loss 1.2168 (1.3959) teacher_loss 0.8280 (0.7836) loss_zs_kd 0.3709 (0.3904) loss_oracle 0.4155 (0.4748) acc 53.1250 (47.5000) kd_loss 0.8089 (0.9123) lr 3.1417e-05 eta 0:01:47
epoch [48/50] batch [40/319] time 0.085 (0.098) data 0.000 (0.016) loss 1.4064 (1.4660) ce_loss 1.3770 (1.4017) teacher_loss 0.7874 (0.7946) loss_zs_kd 0.3475 (0.3960) loss_oracle 0.4452 (0.4734) acc 46.8750 (46.7969) kd_loss 0.8568 (0.9024) lr 3.1417e-05 eta 0:01:29
epoch [48/50] batch [60/319] time 0.093 (0.094) data 0.000 (0.011) loss 1.3871 (1.4493) ce_loss 1.2305 (1.4045) teacher_loss 0.7496 (0.7769) loss_zs_kd 0.3226 (0.3980) loss_oracle 0.4761 (0.4734) acc 56.2500 (47.0833) kd_loss 0.9387 (0.9086) lr 3.1417e-05 eta 0:01:24
epoch [48/50] batch [80/319] time 0.080 (0.090) data 0.000 (0.008) loss 1.3519 (1.4329) ce_loss 1.3086 (1.3845) teacher_loss 0.6875 (0.7614) loss_zs_kd 0.4076 (0.3991) loss_oracle 0.4607 (0.4720) acc 46.8750 (48.1250) kd_loss 0.8985 (0.9153) lr 3.1417e-05 eta 0:01:19
epoch [48/50] batch [100/319] time 0.081 (0.089) data 0.000 (0.007) loss 1.3895 (1.4230) ce_loss 1.3584 (1.3750) teacher_loss 0.6974 (0.7500) loss_zs_kd 0.3750 (0.4005) loss_oracle 0.5047 (0.4728) acc 50.0000 (48.6562) kd_loss 0.9591 (0.9183) lr 3.1417e-05 eta 0:01:15
epoch [48/50] batch [120/319] time 0.083 (0.088) data 0.000 (0.006) loss 1.3771 (1.4096) ce_loss 1.2588 (1.3569) teacher_loss 0.6815 (0.7400) loss_zs_kd 0.3688 (0.3982) loss_oracle 0.5112 (0.4704) acc 59.3750 (49.2188) kd_loss 0.9893 (0.9158) lr 3.1417e-05 eta 0:01:13
epoch [48/50] batch [140/319] time 0.077 (0.087) data 0.000 (0.005) loss 1.5487 (1.4076) ce_loss 1.3525 (1.3492) teacher_loss 0.8959 (0.7385) loss_zs_kd 0.4022 (0.4007) loss_oracle 0.4517 (0.4687) acc 50.0000 (49.5089) kd_loss 0.9270 (0.9128) lr 3.1417e-05 eta 0:01:11
epoch [48/50] batch [160/319] time 0.078 (0.087) data 0.000 (0.004) loss 1.2462 (1.4038) ce_loss 0.9795 (1.3420) teacher_loss 0.5425 (0.7364) loss_zs_kd 0.4494 (0.3992) loss_oracle 0.4789 (0.4678) acc 68.7500 (49.9219) kd_loss 1.0198 (0.9112) lr 3.1417e-05 eta 0:01:09
epoch [48/50] batch [180/319] time 0.081 (0.086) data 0.000 (0.004) loss 1.2936 (1.4066) ce_loss 1.2920 (1.3455) teacher_loss 0.5844 (0.7376) loss_zs_kd 0.4029 (0.3995) loss_oracle 0.5078 (0.4692) acc 53.1250 (49.6007) kd_loss 0.9230 (0.9114) lr 3.1417e-05 eta 0:01:06
epoch [48/50] batch [200/319] time 0.082 (0.086) data 0.000 (0.003) loss 1.6400 (1.4116) ce_loss 1.6387 (1.3488) teacher_loss 1.0430 (0.7419) loss_zs_kd 0.3888 (0.4018) loss_oracle 0.4025 (0.4688) acc 46.8750 (49.3281) kd_loss 0.8983 (0.9092) lr 3.1417e-05 eta 0:01:05
epoch [48/50] batch [220/319] time 0.081 (0.086) data 0.000 (0.003) loss 1.1450 (1.4101) ce_loss 1.0527 (1.3446) teacher_loss 0.5681 (0.7411) loss_zs_kd 0.3486 (0.4015) loss_oracle 0.4026 (0.4682) acc 59.3750 (49.6165) kd_loss 0.8082 (0.9096) lr 3.1417e-05 eta 0:01:03
epoch [48/50] batch [240/319] time 0.082 (0.086) data 0.000 (0.003) loss 1.6442 (1.4107) ce_loss 1.6475 (1.3439) teacher_loss 0.9317 (0.7421) loss_zs_kd 0.4084 (0.4012) loss_oracle 0.5083 (0.4681) acc 40.6250 (49.9089) kd_loss 0.8311 (0.9087) lr 3.1417e-05 eta 0:01:01
epoch [48/50] batch [260/319] time 0.088 (0.085) data 0.000 (0.003) loss 1.7007 (1.4115) ce_loss 1.7744 (1.3487) teacher_loss 0.8748 (0.7412) loss_zs_kd 0.4626 (0.4022) loss_oracle 0.5946 (0.4692) acc 34.3750 (49.6635) kd_loss 1.0708 (0.9100) lr 3.1417e-05 eta 0:00:59
epoch [48/50] batch [280/319] time 0.081 (0.085) data 0.000 (0.003) loss 1.7736 (1.4062) ce_loss 1.5869 (1.3435) teacher_loss 1.0708 (0.7375) loss_zs_kd 0.4248 (0.4009) loss_oracle 0.4904 (0.4683) acc 43.7500 (49.9665) kd_loss 0.8987 (0.9106) lr 3.1417e-05 eta 0:00:57
epoch [48/50] batch [300/319] time 0.088 (0.085) data 0.000 (0.002) loss 1.3759 (1.4035) ce_loss 1.1553 (1.3414) teacher_loss 0.7424 (0.7356) loss_zs_kd 0.3672 (0.3998) loss_oracle 0.4499 (0.4681) acc 46.8750 (49.9583) kd_loss 0.9019 (0.9093) lr 3.1417e-05 eta 0:00:56
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,268
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 39.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,942
* accuracy: 40.5%
* error: 59.5%
* macro_f1: 15.1%
******* Domain 2 best val acc:      52.6%, epoch: 38 *******
******* Domain 2 best val test acc: 41.6%, epoch: 38 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [49/50] batch [20/319] time 0.077 (0.117) data 0.000 (0.030) loss 1.2955 (1.3826) ce_loss 1.2324 (1.3507) teacher_loss 0.6940 (0.7205) loss_zs_kd 0.3815 (0.4132) loss_oracle 0.4108 (0.4555) acc 46.8750 (49.5312) kd_loss 0.8404 (0.8966) lr 1.7713e-05 eta 0:01:12
epoch [49/50] batch [40/319] time 0.079 (0.099) data 0.000 (0.015) loss 1.3242 (1.4007) ce_loss 1.2930 (1.3387) teacher_loss 0.7036 (0.7297) loss_zs_kd 0.4002 (0.4082) loss_oracle 0.4205 (0.4668) acc 53.1250 (49.1406) kd_loss 0.9906 (0.8919) lr 1.7713e-05 eta 0:00:59
epoch [49/50] batch [60/319] time 0.083 (0.091) data 0.000 (0.010) loss 1.0889 (1.4061) ce_loss 0.9043 (1.3394) teacher_loss 0.4921 (0.7307) loss_zs_kd 0.3418 (0.4053) loss_oracle 0.4259 (0.4727) acc 68.7500 (50.1042) kd_loss 0.8775 (0.8974) lr 1.7713e-05 eta 0:00:52
epoch [49/50] batch [80/319] time 0.087 (0.090) data 0.000 (0.008) loss 1.3743 (1.4008) ce_loss 1.3262 (1.3407) teacher_loss 0.7099 (0.7286) loss_zs_kd 0.4084 (0.4018) loss_oracle 0.4602 (0.4713) acc 43.7500 (50.3125) kd_loss 0.9437 (0.9057) lr 1.7713e-05 eta 0:00:50
epoch [49/50] batch [100/319] time 0.083 (0.088) data 0.000 (0.006) loss 1.3052 (1.3913) ce_loss 1.1904 (1.3218) teacher_loss 0.6652 (0.7221) loss_zs_kd 0.4160 (0.3999) loss_oracle 0.4320 (0.4693) acc 59.3750 (51.1875) kd_loss 0.9300 (0.9061) lr 1.7713e-05 eta 0:00:47
epoch [49/50] batch [120/319] time 0.082 (0.088) data 0.000 (0.005) loss 1.1742 (1.3991) ce_loss 0.9761 (1.3334) teacher_loss 0.5290 (0.7302) loss_zs_kd 0.4325 (0.3997) loss_oracle 0.4289 (0.4690) acc 59.3750 (50.5990) kd_loss 0.9155 (0.9074) lr 1.7713e-05 eta 0:00:45
epoch [49/50] batch [140/319] time 0.079 (0.087) data 0.000 (0.004) loss 1.5203 (1.3984) ce_loss 1.2910 (1.3320) teacher_loss 0.8241 (0.7305) loss_zs_kd 0.3657 (0.3991) loss_oracle 0.5134 (0.4683) acc 53.1250 (50.9152) kd_loss 0.8762 (0.9098) lr 1.7713e-05 eta 0:00:43
epoch [49/50] batch [160/319] time 0.077 (0.087) data 0.000 (0.004) loss 1.1910 (1.4023) ce_loss 1.0889 (1.3329) teacher_loss 0.4961 (0.7329) loss_zs_kd 0.3946 (0.4009) loss_oracle 0.4976 (0.4689) acc 62.5000 (50.8203) kd_loss 1.0185 (0.9101) lr 1.7713e-05 eta 0:00:41
epoch [49/50] batch [180/319] time 0.090 (0.087) data 0.000 (0.004) loss 1.3738 (1.4103) ce_loss 1.4697 (1.3432) teacher_loss 0.7393 (0.7400) loss_zs_kd 0.3809 (0.4023) loss_oracle 0.4441 (0.4691) acc 40.6250 (50.3646) kd_loss 0.8138 (0.9092) lr 1.7713e-05 eta 0:00:39
epoch [49/50] batch [200/319] time 0.083 (0.087) data 0.000 (0.003) loss 1.4166 (1.4131) ce_loss 1.2471 (1.3485) teacher_loss 0.7269 (0.7420) loss_zs_kd 0.4157 (0.4037) loss_oracle 0.4818 (0.4693) acc 46.8750 (50.1094) kd_loss 0.8091 (0.9091) lr 1.7713e-05 eta 0:00:37
epoch [49/50] batch [220/319] time 0.079 (0.086) data 0.000 (0.003) loss 1.5080 (1.4161) ce_loss 1.5098 (1.3522) teacher_loss 0.8298 (0.7423) loss_zs_kd 0.3943 (0.4039) loss_oracle 0.4811 (0.4719) acc 43.7500 (49.8864) kd_loss 0.8111 (0.9094) lr 1.7713e-05 eta 0:00:35
epoch [49/50] batch [240/319] time 0.068 (0.085) data 0.000 (0.003) loss 1.4072 (1.4183) ce_loss 1.5146 (1.3547) teacher_loss 0.6858 (0.7441) loss_zs_kd 0.4398 (0.4043) loss_oracle 0.5015 (0.4720) acc 43.7500 (49.5573) kd_loss 0.9343 (0.9091) lr 1.7713e-05 eta 0:00:33
epoch [49/50] batch [260/319] time 0.080 (0.085) data 0.000 (0.003) loss 1.4053 (1.4144) ce_loss 1.4707 (1.3500) teacher_loss 0.6947 (0.7413) loss_zs_kd 0.4058 (0.4038) loss_oracle 0.5077 (0.4712) acc 50.0000 (49.7236) kd_loss 1.0465 (0.9104) lr 1.7713e-05 eta 0:00:32
epoch [49/50] batch [280/319] time 0.086 (0.085) data 0.000 (0.002) loss 1.0879 (1.4148) ce_loss 0.9473 (1.3513) teacher_loss 0.4766 (0.7422) loss_zs_kd 0.4020 (0.4038) loss_oracle 0.4103 (0.4707) acc 62.5000 (49.7098) kd_loss 0.8117 (0.9086) lr 1.7713e-05 eta 0:00:30
epoch [49/50] batch [300/319] time 0.086 (0.085) data 0.000 (0.002) loss 1.2087 (1.4097) ce_loss 1.0391 (1.3436) teacher_loss 0.6109 (0.7369) loss_zs_kd 0.3883 (0.4037) loss_oracle 0.4036 (0.4710) acc 65.6250 (50.0833) kd_loss 0.8742 (0.9106) lr 1.7713e-05 eta 0:00:28
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,268
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 39.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,942
* accuracy: 40.5%
* error: 59.5%
* macro_f1: 15.1%
******* Domain 2 best val acc:      52.6%, epoch: 38 *******
******* Domain 2 best val test acc: 41.6%, epoch: 38 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
epoch [50/50] batch [20/319] time 0.080 (0.112) data 0.000 (0.032) loss 1.2737 (1.4308) ce_loss 1.2471 (1.3260) teacher_loss 0.5714 (0.7633) loss_zs_kd 0.4067 (0.4042) loss_oracle 0.4990 (0.4654) acc 53.1250 (50.9375) kd_loss 0.9514 (0.9104) lr 7.8853e-06 eta 0:00:33
epoch [50/50] batch [40/319] time 0.077 (0.094) data 0.000 (0.016) loss 1.5445 (1.4291) ce_loss 1.4922 (1.3511) teacher_loss 0.7317 (0.7599) loss_zs_kd 0.4716 (0.3991) loss_oracle 0.5770 (0.4696) acc 46.8750 (50.4688) kd_loss 0.9306 (0.9123) lr 7.8853e-06 eta 0:00:26
epoch [50/50] batch [60/319] time 0.079 (0.091) data 0.000 (0.011) loss 1.3409 (1.4239) ce_loss 1.0762 (1.3426) teacher_loss 0.6990 (0.7516) loss_zs_kd 0.4047 (0.4021) loss_oracle 0.4396 (0.4712) acc 50.0000 (49.7396) kd_loss 0.8549 (0.9089) lr 7.8853e-06 eta 0:00:23
epoch [50/50] batch [80/319] time 0.061 (0.088) data 0.000 (0.008) loss 1.3407 (1.4068) ce_loss 1.3174 (1.3362) teacher_loss 0.6484 (0.7347) loss_zs_kd 0.3676 (0.3992) loss_oracle 0.5084 (0.4725) acc 46.8750 (49.5703) kd_loss 0.9890 (0.9139) lr 7.8853e-06 eta 0:00:20
epoch [50/50] batch [100/319] time 0.071 (0.085) data 0.000 (0.007) loss 1.4409 (1.4148) ce_loss 1.3105 (1.3381) teacher_loss 0.8996 (0.7447) loss_zs_kd 0.3762 (0.4000) loss_oracle 0.3531 (0.4701) acc 50.0000 (49.3125) kd_loss 0.8679 (0.9081) lr 7.8853e-06 eta 0:00:18
epoch [50/50] batch [120/319] time 0.084 (0.083) data 0.000 (0.006) loss 1.4439 (1.4118) ce_loss 1.3721 (1.3325) teacher_loss 0.8280 (0.7427) loss_zs_kd 0.3317 (0.3993) loss_oracle 0.4500 (0.4695) acc 59.3750 (49.7917) kd_loss 0.9258 (0.9067) lr 7.8853e-06 eta 0:00:16
epoch [50/50] batch [140/319] time 0.080 (0.083) data 0.000 (0.005) loss 1.2740 (1.4111) ce_loss 1.0391 (1.3335) teacher_loss 0.6690 (0.7424) loss_zs_kd 0.3622 (0.3993) loss_oracle 0.4239 (0.4690) acc 65.6250 (49.8214) kd_loss 0.9447 (0.9035) lr 7.8853e-06 eta 0:00:14
epoch [50/50] batch [160/319] time 0.061 (0.081) data 0.000 (0.004) loss 1.3396 (1.4134) ce_loss 1.3213 (1.3346) teacher_loss 0.7193 (0.7459) loss_zs_kd 0.3581 (0.4006) loss_oracle 0.4413 (0.4672) acc 53.1250 (49.8438) kd_loss 0.8569 (0.9026) lr 7.8853e-06 eta 0:00:12
epoch [50/50] batch [180/319] time 0.081 (0.081) data 0.000 (0.004) loss 1.3521 (1.4149) ce_loss 1.2197 (1.3388) teacher_loss 0.6409 (0.7472) loss_zs_kd 0.4563 (0.4011) loss_oracle 0.4831 (0.4672) acc 50.0000 (49.7743) kd_loss 0.8653 (0.9024) lr 7.8853e-06 eta 0:00:11
epoch [50/50] batch [200/319] time 0.079 (0.081) data 0.000 (0.003) loss 1.4418 (1.4182) ce_loss 1.4258 (1.3407) teacher_loss 0.7322 (0.7498) loss_zs_kd 0.3760 (0.4013) loss_oracle 0.5216 (0.4677) acc 46.8750 (49.7969) kd_loss 0.9055 (0.9021) lr 7.8853e-06 eta 0:00:09
epoch [50/50] batch [220/319] time 0.091 (0.081) data 0.000 (0.003) loss 1.2818 (1.4127) ce_loss 1.1953 (1.3368) teacher_loss 0.6735 (0.7451) loss_zs_kd 0.3355 (0.4019) loss_oracle 0.4405 (0.4667) acc 65.6250 (49.9858) kd_loss 0.8969 (0.9024) lr 7.8853e-06 eta 0:00:08
epoch [50/50] batch [240/319] time 0.090 (0.081) data 0.001 (0.003) loss 1.4063 (1.4080) ce_loss 1.3809 (1.3335) teacher_loss 0.8648 (0.7412) loss_zs_kd 0.3048 (0.4008) loss_oracle 0.3891 (0.4664) acc 56.2500 (49.9609) kd_loss 0.9036 (0.9015) lr 7.8853e-06 eta 0:00:06
epoch [50/50] batch [260/319] time 0.095 (0.082) data 0.000 (0.003) loss 1.2830 (1.4083) ce_loss 1.3301 (1.3387) teacher_loss 0.6412 (0.7413) loss_zs_kd 0.3855 (0.4011) loss_oracle 0.4490 (0.4665) acc 50.0000 (49.9519) kd_loss 0.9173 (0.9012) lr 7.8853e-06 eta 0:00:04
epoch [50/50] batch [280/319] time 0.082 (0.082) data 0.000 (0.003) loss 1.8248 (1.4053) ce_loss 1.7168 (1.3341) teacher_loss 1.0885 (0.7387) loss_zs_kd 0.4289 (0.4004) loss_oracle 0.5219 (0.4664) acc 34.3750 (50.0670) kd_loss 0.9293 (0.9025) lr 7.8853e-06 eta 0:00:03
epoch [50/50] batch [300/319] time 0.086 (0.082) data 0.000 (0.002) loss 1.5452 (1.4027) ce_loss 1.5820 (1.3326) teacher_loss 0.7997 (0.7352) loss_zs_kd 0.4305 (0.4006) loss_oracle 0.5302 (0.4672) acc 50.0000 (50.2708) kd_loss 1.0298 (0.9016) lr 7.8853e-06 eta 0:00:01
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,268
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 39.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,946
* accuracy: 40.5%
* error: 59.5%
* macro_f1: 15.2%
******* Domain 2 best val acc:      52.6%, epoch: 38 *******
******* Domain 2 best val test acc: 41.6%, epoch: 38 *******
******* Domain 2 best test acc:     45.5%, epoch: 10 *******
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:41:39
