Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ---------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_38', 'location_43', 'location_46']
Target     ['location_100']
# classes  10
# train_x  13,713
# val      5,876
# test     4,741
---------  ---------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/428] time 0.083 (0.135) data 0.000 (0.034) loss 2.5099 (2.4758) ce_loss 2.5078 (2.4749) teacher_loss 2.5092 (2.4747) loss_zs_kd 0.0003 (0.0001) loss_oracle 0.0006 (0.0010) acc 31.2500 (23.4375) kd_loss 0.0021 (0.0040) lr 1.0000e-05 eta 0:48:11
epoch [1/50] batch [40/428] time 0.087 (0.111) data 0.000 (0.017) loss 2.4998 (2.4023) ce_loss 2.4980 (2.4014) teacher_loss 2.4987 (2.4015) loss_zs_kd 0.0016 (0.0004) loss_oracle 0.0002 (0.0007) acc 18.7500 (25.7031) kd_loss 0.0008 (0.0025) lr 1.0000e-05 eta 0:39:33
epoch [1/50] batch [60/428] time 0.080 (0.103) data 0.000 (0.012) loss 2.5742 (2.3800) ce_loss 2.5723 (2.3789) teacher_loss 2.5715 (2.3789) loss_zs_kd 0.0042 (0.0013) loss_oracle 0.0006 (0.0005) acc 28.1250 (26.2500) kd_loss 0.0018 (0.0019) lr 1.0000e-05 eta 0:36:38
epoch [1/50] batch [80/428] time 0.073 (0.098) data 0.000 (0.009) loss 2.2820 (2.3582) ce_loss 2.2773 (2.3565) teacher_loss 2.2779 (2.3564) loss_zs_kd 0.0071 (0.0026) loss_oracle 0.0005 (0.0005) acc 31.2500 (26.5625) kd_loss 0.0016 (0.0018) lr 1.0000e-05 eta 0:34:56
epoch [1/50] batch [100/428] time 0.080 (0.095) data 0.000 (0.007) loss 2.3547 (2.3365) ce_loss 2.3496 (2.3340) teacher_loss 2.3485 (2.3338) loss_zs_kd 0.0114 (0.0044) loss_oracle 0.0005 (0.0005) acc 28.1250 (27.0312) kd_loss 0.0014 (0.0018) lr 1.0000e-05 eta 0:33:45
epoch [1/50] batch [120/428] time 0.093 (0.092) data 0.001 (0.006) loss 2.2949 (2.3163) ce_loss 2.2812 (2.3126) teacher_loss 2.2827 (2.3125) loss_zs_kd 0.0228 (0.0065) loss_oracle 0.0009 (0.0005) acc 37.5000 (27.7083) kd_loss 0.0021 (0.0017) lr 1.0000e-05 eta 0:32:44
epoch [1/50] batch [140/428] time 0.089 (0.092) data 0.000 (0.005) loss 2.2429 (2.3157) ce_loss 2.2266 (2.3107) teacher_loss 2.2264 (2.3105) loss_zs_kd 0.0307 (0.0091) loss_oracle 0.0011 (0.0006) acc 21.8750 (27.7455) kd_loss 0.0027 (0.0018) lr 1.0000e-05 eta 0:32:27
epoch [1/50] batch [160/428] time 0.086 (0.091) data 0.000 (0.005) loss 2.1419 (2.2925) ce_loss 2.1211 (2.2856) teacher_loss 2.1207 (2.2853) loss_zs_kd 0.0389 (0.0130) loss_oracle 0.0018 (0.0006) acc 37.5000 (28.1641) kd_loss 0.0044 (0.0019) lr 1.0000e-05 eta 0:32:11
epoch [1/50] batch [180/428] time 0.079 (0.090) data 0.000 (0.004) loss 2.4260 (2.2679) ce_loss 2.3828 (2.2576) teacher_loss 2.3834 (2.2574) loss_zs_kd 0.0804 (0.0196) loss_oracle 0.0024 (0.0008) acc 25.0000 (28.7674) kd_loss 0.0049 (0.0021) lr 1.0000e-05 eta 0:31:58
epoch [1/50] batch [200/428] time 0.092 (0.090) data 0.001 (0.004) loss 2.0249 (2.2505) ce_loss 1.9717 (2.2367) teacher_loss 1.9708 (2.2363) loss_zs_kd 0.1001 (0.0263) loss_oracle 0.0041 (0.0010) acc 37.5000 (29.2500) kd_loss 0.0070 (0.0026) lr 1.0000e-05 eta 0:31:49
epoch [1/50] batch [220/428] time 0.084 (0.089) data 0.000 (0.003) loss 2.5380 (2.2389) ce_loss 2.4766 (2.2199) teacher_loss 2.4742 (2.2192) loss_zs_kd 0.1035 (0.0350) loss_oracle 0.0120 (0.0022) acc 34.3750 (29.7159) kd_loss 0.0238 (0.0042) lr 1.0000e-05 eta 0:31:32
epoch [1/50] batch [240/428] time 0.088 (0.089) data 0.001 (0.003) loss 2.2212 (2.2332) ce_loss 2.0918 (2.2063) teacher_loss 2.0933 (2.2054) loss_zs_kd 0.1581 (0.0448) loss_oracle 0.0488 (0.0054) acc 31.2500 (29.9349) kd_loss 0.1168 (0.0093) lr 1.0000e-05 eta 0:31:20
epoch [1/50] batch [260/428] time 0.079 (0.088) data 0.000 (0.003) loss 2.6540 (2.2268) ce_loss 2.5215 (2.1911) teacher_loss 2.5310 (2.1901) loss_zs_kd 0.1275 (0.0530) loss_oracle 0.0593 (0.0102) acc 34.3750 (30.2284) kd_loss 0.1398 (0.0210) lr 1.0000e-05 eta 0:31:06
epoch [1/50] batch [280/428] time 0.080 (0.088) data 0.000 (0.003) loss 1.8915 (2.2166) ce_loss 1.6846 (2.1706) teacher_loss 1.6585 (2.1691) loss_zs_kd 0.2246 (0.0638) loss_oracle 0.1207 (0.0155) acc 53.1250 (30.6473) kd_loss 0.2328 (0.0351) lr 1.0000e-05 eta 0:30:56
epoch [1/50] batch [300/428] time 0.103 (0.088) data 0.001 (0.003) loss 2.6285 (2.2120) ce_loss 2.2852 (2.1536) teacher_loss 2.2188 (2.1493) loss_zs_kd 0.3041 (0.0728) loss_oracle 0.2576 (0.0263) acc 25.0000 (31.1667) kd_loss 0.2953 (0.0513) lr 1.0000e-05 eta 0:30:51
epoch [1/50] batch [320/428] time 0.077 (0.088) data 0.000 (0.002) loss 2.1982 (2.2121) ce_loss 1.7949 (2.1368) teacher_loss 1.6602 (2.1279) loss_zs_kd 0.2718 (0.0837) loss_oracle 0.4020 (0.0424) acc 40.6250 (31.5625) kd_loss 0.5819 (0.0757) lr 1.0000e-05 eta 0:30:53
epoch [1/50] batch [340/428] time 0.089 (0.088) data 0.000 (0.002) loss 2.5028 (2.2172) ce_loss 2.0254 (2.1227) teacher_loss 1.7900 (2.1067) loss_zs_kd 0.2863 (0.0934) loss_oracle 0.5697 (0.0638) acc 34.3750 (31.8290) kd_loss 0.6962 (0.1050) lr 1.0000e-05 eta 0:30:46
epoch [1/50] batch [360/428] time 0.088 (0.088) data 0.000 (0.002) loss 2.2200 (2.2241) ce_loss 1.8154 (2.1107) teacher_loss 1.5775 (2.0851) loss_zs_kd 0.2994 (0.1032) loss_oracle 0.4929 (0.0874) acc 56.2500 (32.0139) kd_loss 0.7164 (0.1391) lr 1.0000e-05 eta 0:30:41
epoch [1/50] batch [380/428] time 0.082 (0.087) data 0.000 (0.002) loss 2.6287 (2.2325) ce_loss 2.2715 (2.1056) teacher_loss 1.9392 (2.0681) loss_zs_kd 0.3838 (0.1129) loss_oracle 0.4976 (0.1080) acc 25.0000 (32.0559) kd_loss 0.7462 (0.1695) lr 1.0000e-05 eta 0:30:38
epoch [1/50] batch [400/428] time 0.078 (0.087) data 0.000 (0.002) loss 2.2214 (2.2341) ce_loss 1.8486 (2.0977) teacher_loss 1.5084 (2.0486) loss_zs_kd 0.4043 (0.1222) loss_oracle 0.5109 (0.1244) acc 34.3750 (32.1641) kd_loss 0.8086 (0.1976) lr 1.0000e-05 eta 0:30:34
epoch [1/50] batch [420/428] time 0.078 (0.087) data 0.000 (0.002) loss 2.4360 (2.2305) ce_loss 2.1504 (2.0878) teacher_loss 1.8138 (2.0247) loss_zs_kd 0.4220 (0.1310) loss_oracle 0.4111 (0.1403) acc 31.2500 (32.3214) kd_loss 0.7154 (0.2247) lr 1.0000e-05 eta 0:30:28
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,123
* accuracy: 36.1%
* error: 63.9%
* macro_f1: 24.8%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,652
* accuracy: 55.9%
* error: 44.1%
* macro_f1: 26.3%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 1 best val acc:      36.1%, epoch: 1 *******
******* Domain 1 best val test acc: 55.9%, epoch: 1 *******
******* Domain 1 best test acc:     55.9%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/ana
epoch [2/50] batch [20/428] time 0.092 (0.119) data 0.000 (0.031) loss 1.9322 (2.0697) ce_loss 1.8770 (1.9251) teacher_loss 1.4376 (1.5670) loss_zs_kd 0.3723 (0.2825) loss_oracle 0.3085 (0.3615) acc 28.1250 (33.1250) kd_loss 0.8431 (0.8096) lr 2.0000e-03 eta 0:41:33
epoch [2/50] batch [40/428] time 0.071 (0.099) data 0.000 (0.016) loss 1.9125 (1.9875) ce_loss 1.7539 (1.8594) teacher_loss 1.4808 (1.4919) loss_zs_kd 0.3179 (0.3131) loss_oracle 0.2727 (0.3391) acc 43.7500 (34.7656) kd_loss 0.7525 (0.8179) lr 2.0000e-03 eta 0:34:25
epoch [2/50] batch [60/428] time 0.082 (0.090) data 0.000 (0.011) loss 1.9768 (1.9543) ce_loss 2.0176 (1.8335) teacher_loss 1.4093 (1.4568) loss_zs_kd 0.3628 (0.3225) loss_oracle 0.3861 (0.3363) acc 28.1250 (34.7917) kd_loss 0.8586 (0.8155) lr 2.0000e-03 eta 0:31:22
epoch [2/50] batch [80/428] time 0.088 (0.088) data 0.000 (0.008) loss 1.9364 (1.9208) ce_loss 1.7852 (1.7881) teacher_loss 1.4017 (1.4092) loss_zs_kd 0.3379 (0.3271) loss_oracle 0.3658 (0.3481) acc 25.0000 (36.4062) kd_loss 0.7879 (0.8199) lr 2.0000e-03 eta 0:30:47
epoch [2/50] batch [100/428] time 0.089 (0.088) data 0.000 (0.006) loss 1.7430 (1.9050) ce_loss 1.6914 (1.7647) teacher_loss 1.0844 (1.3746) loss_zs_kd 0.3995 (0.3333) loss_oracle 0.4589 (0.3638) acc 25.0000 (36.3125) kd_loss 0.9093 (0.8261) lr 2.0000e-03 eta 0:30:39
epoch [2/50] batch [120/428] time 0.088 (0.087) data 0.000 (0.005) loss 2.0779 (1.8950) ce_loss 1.8311 (1.7562) teacher_loss 1.5903 (1.3566) loss_zs_kd 0.4012 (0.3443) loss_oracle 0.2870 (0.3662) acc 37.5000 (36.3281) kd_loss 0.7159 (0.8265) lr 2.0000e-03 eta 0:30:18
epoch [2/50] batch [140/428] time 0.085 (0.087) data 0.000 (0.005) loss 1.6264 (1.8631) ce_loss 1.5166 (1.7391) teacher_loss 0.9159 (1.3253) loss_zs_kd 0.3912 (0.3465) loss_oracle 0.5149 (0.3645) acc 40.6250 (36.6741) kd_loss 0.8867 (0.8345) lr 2.0000e-03 eta 0:30:07
epoch [2/50] batch [160/428] time 0.092 (0.087) data 0.000 (0.004) loss 1.7418 (1.8503) ce_loss 1.6289 (1.7246) teacher_loss 1.0590 (1.2966) loss_zs_kd 0.4761 (0.3593) loss_oracle 0.4448 (0.3740) acc 40.6250 (37.1289) kd_loss 0.9726 (0.8416) lr 2.0000e-03 eta 0:30:02
epoch [2/50] batch [180/428] time 0.081 (0.087) data 0.000 (0.004) loss 1.7487 (1.8451) ce_loss 1.7500 (1.7237) teacher_loss 0.9389 (1.2775) loss_zs_kd 0.3920 (0.3672) loss_oracle 0.6138 (0.3840) acc 31.2500 (36.8403) kd_loss 0.9075 (0.8474) lr 2.0000e-03 eta 0:30:01
epoch [2/50] batch [200/428] time 0.077 (0.086) data 0.000 (0.003) loss 1.9234 (1.8468) ce_loss 1.9854 (1.7233) teacher_loss 1.1143 (1.2630) loss_zs_kd 0.3820 (0.3713) loss_oracle 0.6181 (0.3981) acc 37.5000 (36.8438) kd_loss 0.9672 (0.8522) lr 2.0000e-03 eta 0:29:55
epoch [2/50] batch [220/428] time 0.079 (0.086) data 0.000 (0.003) loss 1.8454 (1.8392) ce_loss 1.6475 (1.7075) teacher_loss 1.1542 (1.2405) loss_zs_kd 0.3103 (0.3740) loss_oracle 0.5360 (0.4117) acc 28.1250 (37.3153) kd_loss 0.9313 (0.8581) lr 2.0000e-03 eta 0:29:34
epoch [2/50] batch [240/428] time 0.084 (0.085) data 0.000 (0.003) loss 1.8427 (1.8345) ce_loss 1.6240 (1.7004) teacher_loss 1.1607 (1.2250) loss_zs_kd 0.4015 (0.3763) loss_oracle 0.4813 (0.4213) acc 34.3750 (37.4479) kd_loss 0.9307 (0.8638) lr 2.0000e-03 eta 0:29:30
epoch [2/50] batch [260/428] time 0.089 (0.085) data 0.000 (0.003) loss 1.5714 (1.8329) ce_loss 1.3604 (1.6946) teacher_loss 0.7884 (1.2095) loss_zs_kd 0.3636 (0.3812) loss_oracle 0.6012 (0.4328) acc 50.0000 (37.6803) kd_loss 1.0351 (0.8703) lr 2.0000e-03 eta 0:29:30
epoch [2/50] batch [280/428] time 0.084 (0.086) data 0.000 (0.002) loss 1.7648 (1.8411) ce_loss 1.4180 (1.6984) teacher_loss 1.0384 (1.2066) loss_zs_kd 0.4690 (0.3857) loss_oracle 0.4919 (0.4417) acc 53.1250 (37.4665) kd_loss 0.9187 (0.8753) lr 2.0000e-03 eta 0:29:30
epoch [2/50] batch [300/428] time 0.095 (0.086) data 0.000 (0.002) loss 1.9320 (1.8402) ce_loss 1.7324 (1.6966) teacher_loss 1.2462 (1.1985) loss_zs_kd 0.3783 (0.3870) loss_oracle 0.4966 (0.4482) acc 43.7500 (37.3854) kd_loss 0.9055 (0.8801) lr 2.0000e-03 eta 0:29:27
epoch [2/50] batch [320/428] time 0.090 (0.086) data 0.000 (0.002) loss 1.8868 (1.8350) ce_loss 1.7617 (1.6928) teacher_loss 1.0037 (1.1891) loss_zs_kd 0.4226 (0.3863) loss_oracle 0.6718 (0.4528) acc 40.6250 (37.5781) kd_loss 0.9777 (0.8846) lr 2.0000e-03 eta 0:29:25
epoch [2/50] batch [340/428] time 0.085 (0.085) data 0.000 (0.002) loss 1.7068 (1.8365) ce_loss 1.4043 (1.6883) teacher_loss 0.9282 (1.1780) loss_zs_kd 0.4303 (0.3913) loss_oracle 0.5634 (0.4628) acc 50.0000 (37.6838) kd_loss 0.9148 (0.8890) lr 2.0000e-03 eta 0:29:19
epoch [2/50] batch [360/428] time 0.080 (0.085) data 0.000 (0.002) loss 1.5702 (1.8364) ce_loss 1.2705 (1.6819) teacher_loss 0.8606 (1.1688) loss_zs_kd 0.3110 (0.3925) loss_oracle 0.5542 (0.4713) acc 46.8750 (37.8299) kd_loss 0.9842 (0.8921) lr 2.0000e-03 eta 0:29:17
epoch [2/50] batch [380/428] time 0.080 (0.085) data 0.000 (0.002) loss 1.8077 (1.8412) ce_loss 1.4268 (1.6796) teacher_loss 0.8611 (1.1662) loss_zs_kd 0.4373 (0.3925) loss_oracle 0.7280 (0.4788) acc 46.8750 (37.7385) kd_loss 0.9962 (0.8950) lr 2.0000e-03 eta 0:29:15
epoch [2/50] batch [400/428] time 0.082 (0.085) data 0.000 (0.002) loss 1.9863 (1.8462) ce_loss 1.6035 (1.6797) teacher_loss 1.1745 (1.1641) loss_zs_kd 0.4125 (0.3921) loss_oracle 0.6055 (0.4860) acc 34.3750 (37.6641) kd_loss 0.9390 (0.8979) lr 2.0000e-03 eta 0:29:14
epoch [2/50] batch [420/428] time 0.076 (0.085) data 0.000 (0.002) loss 1.8459 (1.8491) ce_loss 1.5205 (1.6761) teacher_loss 1.0142 (1.1585) loss_zs_kd 0.3625 (0.3932) loss_oracle 0.6504 (0.4939) acc 43.7500 (37.8497) kd_loss 0.9174 (0.9004) lr 2.0000e-03 eta 0:29:11
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,573
* accuracy: 43.8%
* error: 56.2%
* macro_f1: 31.2%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,686
* accuracy: 56.7%
* error: 43.3%
* macro_f1: 27.6%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 1 best val acc:      43.8%, epoch: 2 *******
******* Domain 1 best val test acc: 56.7%, epoch: 2 *******
******* Domain 1 best test acc:     56.7%, epoch: 2 *******
epoch [3/50] batch [20/428] time 0.092 (0.112) data 0.000 (0.030) loss 1.9071 (1.9112) ce_loss 1.7754 (1.5849) teacher_loss 1.1350 (1.0872) loss_zs_kd 0.3429 (0.4057) loss_oracle 0.6006 (0.6211) acc 21.8750 (41.4062) kd_loss 0.9113 (0.9397) lr 1.9980e-03 eta 0:38:20
epoch [3/50] batch [40/428] time 0.086 (0.098) data 0.000 (0.015) loss 1.7595 (1.9086) ce_loss 1.6738 (1.6117) teacher_loss 1.0458 (1.0904) loss_zs_kd 0.3928 (0.3980) loss_oracle 0.5172 (0.6193) acc 43.7500 (41.0156) kd_loss 0.8364 (0.9310) lr 1.9980e-03 eta 0:33:38
epoch [3/50] batch [60/428] time 0.088 (0.095) data 0.000 (0.010) loss 2.0330 (1.9076) ce_loss 1.7969 (1.6252) teacher_loss 1.2125 (1.1082) loss_zs_kd 0.3455 (0.3960) loss_oracle 0.6477 (0.6014) acc 37.5000 (40.2604) kd_loss 0.9035 (0.9233) lr 1.9980e-03 eta 0:32:18
epoch [3/50] batch [80/428] time 0.090 (0.092) data 0.000 (0.008) loss 1.8071 (1.9017) ce_loss 1.7656 (1.6331) teacher_loss 1.0661 (1.1076) loss_zs_kd 0.4046 (0.3949) loss_oracle 0.5386 (0.5967) acc 31.2500 (39.9219) kd_loss 0.8659 (0.9150) lr 1.9980e-03 eta 0:31:17
epoch [3/50] batch [100/428] time 0.086 (0.090) data 0.000 (0.006) loss 2.2779 (1.8970) ce_loss 1.9805 (1.6317) teacher_loss 1.5102 (1.1135) loss_zs_kd 0.3930 (0.3878) loss_oracle 0.5712 (0.5896) acc 31.2500 (39.6562) kd_loss 0.8584 (0.9051) lr 1.9980e-03 eta 0:30:42
epoch [3/50] batch [120/428] time 0.078 (0.089) data 0.000 (0.005) loss 1.9611 (1.8790) ce_loss 1.8896 (1.6255) teacher_loss 1.1944 (1.0979) loss_zs_kd 0.4047 (0.3925) loss_oracle 0.5644 (0.5849) acc 25.0000 (39.3229) kd_loss 0.8860 (0.9003) lr 1.9980e-03 eta 0:30:27
epoch [3/50] batch [140/428] time 0.085 (0.088) data 0.000 (0.004) loss 1.7884 (1.8586) ce_loss 1.5117 (1.6220) teacher_loss 0.8975 (1.0840) loss_zs_kd 0.5149 (0.3976) loss_oracle 0.6334 (0.5758) acc 40.6250 (39.1518) kd_loss 0.8337 (0.8956) lr 1.9980e-03 eta 0:30:01
epoch [3/50] batch [160/428] time 0.084 (0.087) data 0.000 (0.004) loss 1.8397 (1.8531) ce_loss 1.4863 (1.6198) teacher_loss 1.0389 (1.0785) loss_zs_kd 0.5071 (0.4033) loss_oracle 0.5473 (0.5729) acc 46.8750 (38.9062) kd_loss 0.8694 (0.8911) lr 1.9980e-03 eta 0:29:40
epoch [3/50] batch [180/428] time 0.087 (0.087) data 0.000 (0.004) loss 1.7788 (1.8444) ce_loss 1.4199 (1.6160) teacher_loss 0.9090 (1.0666) loss_zs_kd 0.4639 (0.4108) loss_oracle 0.6378 (0.5723) acc 50.0000 (38.6632) kd_loss 0.9440 (0.8902) lr 1.9980e-03 eta 0:29:29
epoch [3/50] batch [200/428] time 0.081 (0.087) data 0.000 (0.003) loss 1.9126 (1.8508) ce_loss 1.6865 (1.6200) teacher_loss 1.0476 (1.0673) loss_zs_kd 0.3968 (0.4171) loss_oracle 0.6666 (0.5749) acc 40.6250 (38.7031) kd_loss 0.9083 (0.8880) lr 1.9980e-03 eta 0:29:23
epoch [3/50] batch [220/428] time 0.083 (0.086) data 0.000 (0.003) loss 1.8686 (1.8500) ce_loss 1.8574 (1.6205) teacher_loss 0.9749 (1.0613) loss_zs_kd 0.4986 (0.4212) loss_oracle 0.6444 (0.5780) acc 37.5000 (38.7500) kd_loss 0.9136 (0.8859) lr 1.9980e-03 eta 0:29:14
epoch [3/50] batch [240/428] time 0.088 (0.086) data 0.000 (0.003) loss 1.6411 (1.8457) ce_loss 1.5186 (1.6162) teacher_loss 0.6814 (1.0517) loss_zs_kd 0.5437 (0.4250) loss_oracle 0.6878 (0.5815) acc 40.6250 (38.9193) kd_loss 0.8842 (0.8858) lr 1.9980e-03 eta 0:29:03
epoch [3/50] batch [260/428] time 0.083 (0.086) data 0.000 (0.003) loss 1.9875 (1.8419) ce_loss 1.8828 (1.6117) teacher_loss 1.1970 (1.0436) loss_zs_kd 0.4633 (0.4284) loss_oracle 0.5588 (0.5841) acc 34.3750 (39.2548) kd_loss 0.8723 (0.8845) lr 1.9980e-03 eta 0:29:00
epoch [3/50] batch [280/428] time 0.087 (0.086) data 0.000 (0.002) loss 1.7440 (1.8448) ce_loss 1.5605 (1.6113) teacher_loss 0.8889 (1.0422) loss_zs_kd 0.5371 (0.4293) loss_oracle 0.5865 (0.5879) acc 43.7500 (39.3527) kd_loss 0.8444 (0.8833) lr 1.9980e-03 eta 0:28:54
epoch [3/50] batch [300/428] time 0.084 (0.086) data 0.000 (0.002) loss 1.7597 (1.8400) ce_loss 1.4297 (1.6080) teacher_loss 0.8741 (1.0347) loss_zs_kd 0.5291 (0.4315) loss_oracle 0.6211 (0.5895) acc 56.2500 (39.5625) kd_loss 0.8651 (0.8821) lr 1.9980e-03 eta 0:28:52
epoch [3/50] batch [320/428] time 0.088 (0.086) data 0.000 (0.002) loss 1.3958 (1.8354) ce_loss 1.2236 (1.6048) teacher_loss 0.6664 (1.0283) loss_zs_kd 0.4437 (0.4328) loss_oracle 0.5076 (0.5907) acc 50.0000 (39.5703) kd_loss 0.9205 (0.8811) lr 1.9980e-03 eta 0:28:53
epoch [3/50] batch [340/428] time 0.099 (0.086) data 0.001 (0.002) loss 1.8223 (1.8312) ce_loss 1.6172 (1.6042) teacher_loss 1.0718 (1.0262) loss_zs_kd 0.4417 (0.4328) loss_oracle 0.5295 (0.5886) acc 43.7500 (39.5864) kd_loss 0.8136 (0.8797) lr 1.9980e-03 eta 0:28:51
epoch [3/50] batch [360/428] time 0.081 (0.086) data 0.000 (0.002) loss 1.8580 (1.8289) ce_loss 1.6748 (1.6032) teacher_loss 1.1492 (1.0239) loss_zs_kd 0.3742 (0.4324) loss_oracle 0.5217 (0.5888) acc 34.3750 (39.7222) kd_loss 0.7897 (0.8785) lr 1.9980e-03 eta 0:28:49
epoch [3/50] batch [380/428] time 0.076 (0.086) data 0.000 (0.002) loss 2.0213 (1.8272) ce_loss 1.8438 (1.6012) teacher_loss 1.2299 (1.0247) loss_zs_kd 0.4282 (0.4310) loss_oracle 0.5772 (0.5870) acc 40.6250 (39.7780) kd_loss 0.8098 (0.8758) lr 1.9980e-03 eta 0:28:46
epoch [3/50] batch [400/428] time 0.075 (0.085) data 0.000 (0.002) loss 1.6995 (1.8263) ce_loss 1.6016 (1.6019) teacher_loss 1.0741 (1.0269) loss_zs_kd 0.4552 (0.4312) loss_oracle 0.3978 (0.5839) acc 43.7500 (39.8516) kd_loss 0.7763 (0.8731) lr 1.9980e-03 eta 0:28:38
epoch [3/50] batch [420/428] time 0.077 (0.085) data 0.000 (0.002) loss 1.8559 (1.8209) ce_loss 1.6367 (1.5974) teacher_loss 1.0496 (1.0251) loss_zs_kd 0.5479 (0.4307) loss_oracle 0.5323 (0.5805) acc 37.5000 (39.9777) kd_loss 0.8805 (0.8706) lr 1.9980e-03 eta 0:28:34
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,736
* accuracy: 46.6%
* error: 53.4%
* macro_f1: 33.7%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,671
* accuracy: 56.3%
* error: 43.7%
* macro_f1: 28.7%
******* Domain 1 best val acc:      46.6%, epoch: 3 *******
******* Domain 1 best val test acc: 56.3%, epoch: 3 *******
******* Domain 1 best test acc:     56.7%, epoch: 2 *******
epoch [4/50] batch [20/428] time 0.087 (0.107) data 0.000 (0.023) loss 1.9931 (1.7867) ce_loss 1.7969 (1.5621) teacher_loss 1.3059 (1.0761) loss_zs_kd 0.3956 (0.3997) loss_oracle 0.4894 (0.5107) acc 43.7500 (40.3125) kd_loss 0.7233 (0.7923) lr 1.9921e-03 eta 0:35:59
epoch [4/50] batch [40/428] time 0.078 (0.095) data 0.000 (0.011) loss 1.9984 (1.8336) ce_loss 1.5566 (1.6013) teacher_loss 1.2889 (1.1290) loss_zs_kd 0.3871 (0.3859) loss_oracle 0.5159 (0.5117) acc 46.8750 (39.2188) kd_loss 0.7854 (0.7858) lr 1.9921e-03 eta 0:31:53
epoch [4/50] batch [60/428] time 0.093 (0.091) data 0.001 (0.008) loss 1.8770 (1.8202) ce_loss 1.6855 (1.5834) teacher_loss 1.2526 (1.1296) loss_zs_kd 0.3537 (0.3816) loss_oracle 0.4476 (0.4997) acc 37.5000 (40.8333) kd_loss 0.8219 (0.7844) lr 1.9921e-03 eta 0:30:25
epoch [4/50] batch [80/428] time 0.097 (0.089) data 0.001 (0.006) loss 1.8493 (1.8204) ce_loss 1.6572 (1.5865) teacher_loss 1.2225 (1.1422) loss_zs_kd 0.3416 (0.3735) loss_oracle 0.4561 (0.4915) acc 37.5000 (40.5859) kd_loss 0.7967 (0.7872) lr 1.9921e-03 eta 0:29:51
epoch [4/50] batch [100/428] time 0.079 (0.089) data 0.000 (0.005) loss 1.7220 (1.8225) ce_loss 1.4863 (1.5843) teacher_loss 1.0369 (1.1478) loss_zs_kd 0.3840 (0.3786) loss_oracle 0.4930 (0.4854) acc 46.8750 (41.0938) kd_loss 0.8029 (0.7888) lr 1.9921e-03 eta 0:29:33
epoch [4/50] batch [120/428] time 0.086 (0.088) data 0.000 (0.004) loss 1.8968 (1.8091) ce_loss 1.4814 (1.5664) teacher_loss 1.2342 (1.1297) loss_zs_kd 0.3870 (0.3799) loss_oracle 0.4690 (0.4894) acc 40.6250 (41.8490) kd_loss 0.7783 (0.7955) lr 1.9921e-03 eta 0:29:25
epoch [4/50] batch [140/428] time 0.084 (0.088) data 0.000 (0.004) loss 1.6337 (1.8006) ce_loss 1.3906 (1.5546) teacher_loss 1.0132 (1.1163) loss_zs_kd 0.3749 (0.3814) loss_oracle 0.4331 (0.4935) acc 56.2500 (42.1429) kd_loss 0.7732 (0.7984) lr 1.9921e-03 eta 0:29:13
epoch [4/50] batch [160/428] time 0.085 (0.087) data 0.000 (0.003) loss 1.8104 (1.8040) ce_loss 1.5850 (1.5597) teacher_loss 1.0488 (1.1117) loss_zs_kd 0.3165 (0.3861) loss_oracle 0.6034 (0.4993) acc 46.8750 (42.0117) kd_loss 0.8495 (0.8060) lr 1.9921e-03 eta 0:29:01
epoch [4/50] batch [180/428] time 0.086 (0.087) data 0.000 (0.003) loss 2.0091 (1.8039) ce_loss 1.6738 (1.5548) teacher_loss 1.2103 (1.1052) loss_zs_kd 0.4139 (0.3871) loss_oracle 0.5919 (0.5052) acc 37.5000 (42.2743) kd_loss 0.8728 (0.8133) lr 1.9921e-03 eta 0:28:54
epoch [4/50] batch [200/428] time 0.080 (0.087) data 0.000 (0.003) loss 1.7081 (1.7961) ce_loss 1.4297 (1.5500) teacher_loss 1.0532 (1.0941) loss_zs_kd 0.3913 (0.3882) loss_oracle 0.4592 (0.5080) acc 40.6250 (42.5938) kd_loss 0.7535 (0.8159) lr 1.9921e-03 eta 0:28:52
epoch [4/50] batch [220/428] time 0.085 (0.087) data 0.000 (0.002) loss 1.8532 (1.7988) ce_loss 1.5166 (1.5565) teacher_loss 1.2010 (1.0897) loss_zs_kd 0.4332 (0.3945) loss_oracle 0.4356 (0.5119) acc 46.8750 (42.1023) kd_loss 0.7403 (0.8191) lr 1.9921e-03 eta 0:28:49
epoch [4/50] batch [240/428] time 0.077 (0.087) data 0.000 (0.002) loss 1.8213 (1.7929) ce_loss 1.4834 (1.5499) teacher_loss 1.0285 (1.0750) loss_zs_kd 0.5214 (0.4006) loss_oracle 0.5321 (0.5176) acc 43.7500 (42.4609) kd_loss 0.8789 (0.8277) lr 1.9921e-03 eta 0:28:42
epoch [4/50] batch [260/428] time 0.088 (0.087) data 0.000 (0.002) loss 1.9139 (1.7832) ce_loss 1.7598 (1.5488) teacher_loss 1.1986 (1.0623) loss_zs_kd 0.4995 (0.4047) loss_oracle 0.4655 (0.5186) acc 37.5000 (42.5962) kd_loss 0.8418 (0.8345) lr 1.9921e-03 eta 0:28:43
epoch [4/50] batch [280/428] time 0.090 (0.087) data 0.000 (0.002) loss 1.7364 (1.7733) ce_loss 1.5547 (1.5434) teacher_loss 0.9196 (1.0504) loss_zs_kd 0.5320 (0.4076) loss_oracle 0.5508 (0.5191) acc 53.1250 (43.0246) kd_loss 0.8746 (0.8390) lr 1.9921e-03 eta 0:28:36
epoch [4/50] batch [300/428] time 0.082 (0.086) data 0.000 (0.002) loss 1.6679 (1.7724) ce_loss 1.5420 (1.5445) teacher_loss 0.7666 (1.0446) loss_zs_kd 0.4847 (0.4120) loss_oracle 0.6590 (0.5217) acc 46.8750 (43.1250) kd_loss 0.8962 (0.8413) lr 1.9921e-03 eta 0:28:30
epoch [4/50] batch [320/428] time 0.090 (0.086) data 0.000 (0.002) loss 1.7791 (1.7683) ce_loss 1.6504 (1.5417) teacher_loss 0.9835 (1.0372) loss_zs_kd 0.5215 (0.4158) loss_oracle 0.5349 (0.5232) acc 40.6250 (43.1152) kd_loss 0.8287 (0.8405) lr 1.9921e-03 eta 0:28:28
epoch [4/50] batch [340/428] time 0.086 (0.086) data 0.000 (0.002) loss 1.8833 (1.7666) ce_loss 1.7637 (1.5402) teacher_loss 0.9907 (1.0319) loss_zs_kd 0.5104 (0.4184) loss_oracle 0.6374 (0.5255) acc 40.6250 (43.1342) kd_loss 0.8188 (0.8397) lr 1.9921e-03 eta 0:28:25
epoch [4/50] batch [360/428] time 0.083 (0.086) data 0.000 (0.002) loss 1.8076 (1.7671) ce_loss 1.4990 (1.5372) teacher_loss 1.1088 (1.0336) loss_zs_kd 0.3901 (0.4189) loss_oracle 0.5036 (0.5241) acc 34.3750 (43.2205) kd_loss 0.7865 (0.8362) lr 1.9921e-03 eta 0:28:22
epoch [4/50] batch [380/428] time 0.086 (0.086) data 0.000 (0.002) loss 1.6119 (1.7653) ce_loss 1.4717 (1.5309) teacher_loss 0.9575 (1.0330) loss_zs_kd 0.4798 (0.4201) loss_oracle 0.4145 (0.5222) acc 46.8750 (43.4704) kd_loss 0.7710 (0.8332) lr 1.9921e-03 eta 0:28:19
epoch [4/50] batch [400/428] time 0.084 (0.086) data 0.000 (0.001) loss 1.9430 (1.7651) ce_loss 1.7510 (1.5283) teacher_loss 1.2798 (1.0349) loss_zs_kd 0.4064 (0.4205) loss_oracle 0.4601 (0.5200) acc 28.1250 (43.6875) kd_loss 0.8430 (0.8314) lr 1.9921e-03 eta 0:28:15
epoch [4/50] batch [420/428] time 0.076 (0.086) data 0.000 (0.001) loss 1.5077 (1.7635) ce_loss 1.2480 (1.5233) teacher_loss 0.8541 (1.0352) loss_zs_kd 0.4056 (0.4215) loss_oracle 0.4508 (0.5175) acc 62.5000 (43.9732) kd_loss 0.8419 (0.8308) lr 1.9921e-03 eta 0:28:12
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,940
* accuracy: 50.0%
* error: 50.0%
* macro_f1: 34.8%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,384
* accuracy: 50.3%
* error: 49.7%
* macro_f1: 31.3%
******* Domain 1 best val acc:      50.0%, epoch: 4 *******
******* Domain 1 best val test acc: 50.3%, epoch: 4 *******
******* Domain 1 best test acc:     56.7%, epoch: 2 *******
epoch [5/50] batch [20/428] time 0.078 (0.114) data 0.000 (0.034) loss 1.5344 (1.7360) ce_loss 1.3340 (1.3956) teacher_loss 0.8949 (1.0131) loss_zs_kd 0.3536 (0.4511) loss_oracle 0.4627 (0.4974) acc 59.3750 (50.4688) kd_loss 0.7958 (0.8241) lr 1.9823e-03 eta 0:37:26
epoch [5/50] batch [40/428] time 0.083 (0.097) data 0.000 (0.017) loss 1.8234 (1.7206) ce_loss 1.6768 (1.3877) teacher_loss 1.2219 (1.0105) loss_zs_kd 0.4208 (0.4397) loss_oracle 0.3911 (0.4902) acc 40.6250 (49.6094) kd_loss 0.7291 (0.8201) lr 1.9823e-03 eta 0:31:52
epoch [5/50] batch [60/428] time 0.087 (0.093) data 0.000 (0.012) loss 1.6319 (1.7054) ce_loss 1.3760 (1.3837) teacher_loss 0.9729 (1.0023) loss_zs_kd 0.4152 (0.4395) loss_oracle 0.4513 (0.4833) acc 46.8750 (49.8958) kd_loss 0.7786 (0.8126) lr 1.9823e-03 eta 0:30:29
epoch [5/50] batch [80/428] time 0.089 (0.091) data 0.000 (0.009) loss 1.9014 (1.7272) ce_loss 1.7520 (1.4091) teacher_loss 1.2225 (1.0305) loss_zs_kd 0.4165 (0.4293) loss_oracle 0.4707 (0.4821) acc 34.3750 (48.7500) kd_loss 0.7586 (0.8085) lr 1.9823e-03 eta 0:29:35
epoch [5/50] batch [100/428] time 0.086 (0.089) data 0.000 (0.007) loss 1.6380 (1.7370) ce_loss 1.3750 (1.4274) teacher_loss 0.9766 (1.0508) loss_zs_kd 0.3756 (0.4196) loss_oracle 0.4736 (0.4763) acc 59.3750 (47.7812) kd_loss 0.8002 (0.8012) lr 1.9823e-03 eta 0:28:56
epoch [5/50] batch [120/428] time 0.084 (0.088) data 0.000 (0.006) loss 1.9626 (1.7344) ce_loss 1.7227 (1.4307) teacher_loss 1.2795 (1.0491) loss_zs_kd 0.4473 (0.4142) loss_oracle 0.4594 (0.4782) acc 31.2500 (47.8385) kd_loss 0.7790 (0.7933) lr 1.9823e-03 eta 0:28:44
epoch [5/50] batch [140/428] time 0.079 (0.088) data 0.000 (0.005) loss 1.5952 (1.7286) ce_loss 1.2949 (1.4234) teacher_loss 1.0199 (1.0504) loss_zs_kd 0.3160 (0.4072) loss_oracle 0.4173 (0.4745) acc 53.1250 (47.9018) kd_loss 0.6801 (0.7876) lr 1.9823e-03 eta 0:28:36
epoch [5/50] batch [160/428] time 0.084 (0.087) data 0.000 (0.005) loss 1.8791 (1.7453) ce_loss 1.6826 (1.4403) teacher_loss 1.2043 (1.0709) loss_zs_kd 0.3260 (0.4014) loss_oracle 0.5118 (0.4737) acc 37.5000 (47.3047) kd_loss 0.7493 (0.7783) lr 1.9823e-03 eta 0:28:27
epoch [5/50] batch [180/428] time 0.091 (0.087) data 0.000 (0.004) loss 1.5636 (1.7435) ce_loss 1.2969 (1.4408) teacher_loss 1.0093 (1.0776) loss_zs_kd 0.3468 (0.3964) loss_oracle 0.3808 (0.4677) acc 50.0000 (47.5174) kd_loss 0.6866 (0.7689) lr 1.9823e-03 eta 0:28:23
epoch [5/50] batch [200/428] time 0.082 (0.087) data 0.000 (0.004) loss 1.6237 (1.7412) ce_loss 1.2812 (1.4423) teacher_loss 1.0780 (1.0856) loss_zs_kd 0.2839 (0.3899) loss_oracle 0.4038 (0.4606) acc 65.6250 (47.5156) kd_loss 0.6601 (0.7613) lr 1.9823e-03 eta 0:28:15
epoch [5/50] batch [220/428] time 0.095 (0.087) data 0.000 (0.003) loss 1.6340 (1.7417) ce_loss 1.3955 (1.4447) teacher_loss 1.0449 (1.0936) loss_zs_kd 0.4082 (0.3843) loss_oracle 0.3851 (0.4560) acc 46.8750 (47.2727) kd_loss 0.6742 (0.7558) lr 1.9823e-03 eta 0:28:10
epoch [5/50] batch [240/428] time 0.092 (0.087) data 0.000 (0.003) loss 1.8985 (1.7406) ce_loss 1.7705 (1.4485) teacher_loss 1.2700 (1.0969) loss_zs_kd 0.3886 (0.3832) loss_oracle 0.4342 (0.4522) acc 31.2500 (47.3828) kd_loss 0.6944 (0.7507) lr 1.9823e-03 eta 0:28:04
epoch [5/50] batch [260/428] time 0.086 (0.087) data 0.000 (0.003) loss 1.6841 (1.7376) ce_loss 1.3408 (1.4478) teacher_loss 1.0922 (1.0989) loss_zs_kd 0.3737 (0.3805) loss_oracle 0.4051 (0.4484) acc 53.1250 (47.3077) kd_loss 0.6379 (0.7463) lr 1.9823e-03 eta 0:28:01
epoch [5/50] batch [280/428] time 0.083 (0.087) data 0.000 (0.003) loss 1.4100 (1.7313) ce_loss 1.1074 (1.4467) teacher_loss 0.8794 (1.0986) loss_zs_kd 0.2756 (0.3776) loss_oracle 0.3928 (0.4439) acc 71.8750 (47.5112) kd_loss 0.7270 (0.7432) lr 1.9823e-03 eta 0:27:59
epoch [5/50] batch [300/428] time 0.084 (0.086) data 0.000 (0.003) loss 1.7969 (1.7276) ce_loss 1.4639 (1.4463) teacher_loss 1.2438 (1.0983) loss_zs_kd 0.3958 (0.3753) loss_oracle 0.3552 (0.4416) acc 59.3750 (47.4271) kd_loss 0.6407 (0.7408) lr 1.9823e-03 eta 0:27:54
epoch [5/50] batch [320/428] time 0.092 (0.086) data 0.000 (0.002) loss 1.8519 (1.7267) ce_loss 1.7129 (1.4480) teacher_loss 1.2125 (1.1011) loss_zs_kd 0.3505 (0.3739) loss_oracle 0.4642 (0.4386) acc 25.0000 (47.2559) kd_loss 0.6710 (0.7367) lr 1.9823e-03 eta 0:27:52
epoch [5/50] batch [340/428] time 0.084 (0.086) data 0.000 (0.002) loss 1.5936 (1.7264) ce_loss 1.3398 (1.4481) teacher_loss 1.0821 (1.1037) loss_zs_kd 0.2871 (0.3726) loss_oracle 0.3680 (0.4364) acc 56.2500 (47.3897) kd_loss 0.7382 (0.7340) lr 1.9823e-03 eta 0:27:49
epoch [5/50] batch [360/428] time 0.082 (0.086) data 0.000 (0.002) loss 1.1883 (1.7208) ce_loss 1.0420 (1.4462) teacher_loss 0.7808 (1.1035) loss_zs_kd 0.2854 (0.3721) loss_oracle 0.2648 (0.4313) acc 68.7500 (47.5174) kd_loss 0.6294 (0.7303) lr 1.9823e-03 eta 0:27:46
epoch [5/50] batch [380/428] time 0.082 (0.086) data 0.000 (0.002) loss 1.8811 (1.7142) ce_loss 1.6035 (1.4447) teacher_loss 1.3199 (1.1015) loss_zs_kd 0.4202 (0.3722) loss_oracle 0.3512 (0.4265) acc 40.6250 (47.4507) kd_loss 0.6236 (0.7269) lr 1.9823e-03 eta 0:27:44
epoch [5/50] batch [400/428] time 0.082 (0.086) data 0.000 (0.002) loss 1.5525 (1.7115) ce_loss 1.3545 (1.4456) teacher_loss 1.0145 (1.1031) loss_zs_kd 0.2869 (0.3710) loss_oracle 0.3946 (0.4230) acc 40.6250 (47.4453) kd_loss 0.7116 (0.7252) lr 1.9823e-03 eta 0:27:41
epoch [5/50] batch [420/428] time 0.077 (0.086) data 0.000 (0.002) loss 1.4984 (1.7064) ce_loss 1.3311 (1.4449) teacher_loss 1.0391 (1.1032) loss_zs_kd 0.3164 (0.3690) loss_oracle 0.3011 (0.4186) acc 50.0000 (47.4702) kd_loss 0.6673 (0.7230) lr 1.9823e-03 eta 0:27:37
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,953
* accuracy: 50.3%
* error: 49.7%
* macro_f1: 35.6%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,449
* accuracy: 51.7%
* error: 48.3%
* macro_f1: 30.1%
******* Domain 1 best val acc:      50.3%, epoch: 5 *******
******* Domain 1 best val test acc: 51.7%, epoch: 5 *******
******* Domain 1 best test acc:     56.7%, epoch: 2 *******
epoch [6/50] batch [20/428] time 0.085 (0.119) data 0.001 (0.034) loss 1.8724 (1.6406) ce_loss 1.6729 (1.3843) teacher_loss 1.1939 (1.0549) loss_zs_kd 0.4121 (0.3943) loss_oracle 0.4725 (0.3885) acc 50.0000 (48.5938) kd_loss 0.6909 (0.7029) lr 1.9686e-03 eta 0:38:18
epoch [6/50] batch [40/428] time 0.085 (0.102) data 0.000 (0.017) loss 1.5273 (1.6437) ce_loss 1.4229 (1.3871) teacher_loss 0.8733 (1.0603) loss_zs_kd 0.4555 (0.3951) loss_oracle 0.4262 (0.3858) acc 40.6250 (49.2188) kd_loss 0.7034 (0.6969) lr 1.9686e-03 eta 0:32:38
epoch [6/50] batch [60/428] time 0.078 (0.097) data 0.001 (0.012) loss 1.8377 (1.6636) ce_loss 1.5801 (1.4069) teacher_loss 1.1037 (1.0726) loss_zs_kd 0.3940 (0.3999) loss_oracle 0.5370 (0.3910) acc 46.8750 (48.3854) kd_loss 0.8565 (0.7112) lr 1.9686e-03 eta 0:30:54
epoch [6/50] batch [80/428] time 0.092 (0.092) data 0.000 (0.009) loss 1.6438 (1.6763) ce_loss 1.4268 (1.4197) teacher_loss 1.0277 (1.0823) loss_zs_kd 0.4769 (0.4044) loss_oracle 0.3776 (0.3918) acc 37.5000 (47.6562) kd_loss 0.7239 (0.7162) lr 1.9686e-03 eta 0:29:31
epoch [6/50] batch [100/428] time 0.088 (0.091) data 0.000 (0.007) loss 1.5585 (1.6702) ce_loss 1.2119 (1.4182) teacher_loss 0.9398 (1.0711) loss_zs_kd 0.4900 (0.4082) loss_oracle 0.3737 (0.3950) acc 50.0000 (47.8750) kd_loss 0.6759 (0.7237) lr 1.9686e-03 eta 0:29:03
epoch [6/50] batch [120/428] time 0.082 (0.090) data 0.000 (0.006) loss 1.6948 (1.6609) ce_loss 1.4648 (1.4045) teacher_loss 1.0696 (1.0572) loss_zs_kd 0.4671 (0.4144) loss_oracle 0.3917 (0.3965) acc 56.2500 (48.8802) kd_loss 0.7423 (0.7246) lr 1.9686e-03 eta 0:28:44
epoch [6/50] batch [140/428] time 0.079 (0.089) data 0.000 (0.005) loss 1.7324 (1.6640) ce_loss 1.3652 (1.4036) teacher_loss 0.9878 (1.0515) loss_zs_kd 0.4594 (0.4202) loss_oracle 0.5149 (0.4024) acc 40.6250 (48.9509) kd_loss 0.7903 (0.7269) lr 1.9686e-03 eta 0:28:30
epoch [6/50] batch [160/428] time 0.093 (0.089) data 0.000 (0.005) loss 2.0017 (1.6707) ce_loss 1.9141 (1.4126) teacher_loss 1.2922 (1.0491) loss_zs_kd 0.4794 (0.4247) loss_oracle 0.4698 (0.4092) acc 21.8750 (48.5547) kd_loss 0.7205 (0.7311) lr 1.9686e-03 eta 0:28:13
epoch [6/50] batch [180/428] time 0.081 (0.088) data 0.000 (0.004) loss 1.5345 (1.6752) ce_loss 1.2080 (1.4161) teacher_loss 0.8663 (1.0411) loss_zs_kd 0.4500 (0.4330) loss_oracle 0.4432 (0.4176) acc 65.6250 (48.5417) kd_loss 0.7286 (0.7354) lr 1.9686e-03 eta 0:28:02
epoch [6/50] batch [200/428] time 0.087 (0.088) data 0.000 (0.004) loss 1.4926 (1.6730) ce_loss 1.1299 (1.4130) teacher_loss 0.8101 (1.0377) loss_zs_kd 0.4536 (0.4334) loss_oracle 0.4556 (0.4186) acc 62.5000 (48.7188) kd_loss 0.7005 (0.7342) lr 1.9686e-03 eta 0:27:47
epoch [6/50] batch [220/428] time 0.082 (0.087) data 0.000 (0.003) loss 1.9001 (1.6777) ce_loss 1.7041 (1.4116) teacher_loss 1.1846 (1.0369) loss_zs_kd 0.3979 (0.4324) loss_oracle 0.5165 (0.4246) acc 50.0000 (48.9915) kd_loss 0.7231 (0.7350) lr 1.9686e-03 eta 0:27:43
epoch [6/50] batch [240/428] time 0.084 (0.087) data 0.000 (0.003) loss 1.7452 (1.6833) ce_loss 1.3066 (1.4090) teacher_loss 0.9594 (1.0335) loss_zs_kd 0.4747 (0.4331) loss_oracle 0.5484 (0.4333) acc 62.5000 (49.2708) kd_loss 0.7562 (0.7395) lr 1.9686e-03 eta 0:27:39
epoch [6/50] batch [260/428] time 0.080 (0.087) data 0.000 (0.003) loss 1.8544 (1.6898) ce_loss 1.5566 (1.4102) teacher_loss 1.0677 (1.0315) loss_zs_kd 0.4137 (0.4329) loss_oracle 0.5798 (0.4418) acc 50.0000 (49.1466) kd_loss 0.8560 (0.7451) lr 1.9686e-03 eta 0:27:34
epoch [6/50] batch [280/428] time 0.083 (0.087) data 0.000 (0.003) loss 1.5618 (1.6956) ce_loss 1.3145 (1.4144) teacher_loss 0.8261 (1.0277) loss_zs_kd 0.4255 (0.4365) loss_oracle 0.5230 (0.4496) acc 56.2500 (49.0737) kd_loss 0.8467 (0.7502) lr 1.9686e-03 eta 0:27:30
epoch [6/50] batch [300/428] time 0.091 (0.087) data 0.000 (0.003) loss 1.8095 (1.6982) ce_loss 1.5986 (1.4163) teacher_loss 1.0014 (1.0215) loss_zs_kd 0.4846 (0.4384) loss_oracle 0.5658 (0.4576) acc 43.7500 (49.0000) kd_loss 0.8265 (0.7560) lr 1.9686e-03 eta 0:27:20
epoch [6/50] batch [320/428] time 0.076 (0.086) data 0.000 (0.002) loss 2.3357 (1.7051) ce_loss 1.8984 (1.4196) teacher_loss 1.5338 (1.0195) loss_zs_kd 0.4407 (0.4404) loss_oracle 0.5815 (0.4654) acc 37.5000 (48.9355) kd_loss 0.8309 (0.7624) lr 1.9686e-03 eta 0:27:13
epoch [6/50] batch [340/428] time 0.083 (0.086) data 0.000 (0.002) loss 1.6329 (1.7036) ce_loss 1.2646 (1.4195) teacher_loss 0.8480 (1.0130) loss_zs_kd 0.4019 (0.4402) loss_oracle 0.5839 (0.4705) acc 56.2500 (48.9522) kd_loss 0.8811 (0.7670) lr 1.9686e-03 eta 0:27:05
epoch [6/50] batch [360/428] time 0.076 (0.086) data 0.000 (0.002) loss 1.5762 (1.7070) ce_loss 1.2354 (1.4232) teacher_loss 0.7889 (1.0094) loss_zs_kd 0.4409 (0.4416) loss_oracle 0.5669 (0.4768) acc 59.3750 (48.7934) kd_loss 0.8486 (0.7721) lr 1.9686e-03 eta 0:27:02
epoch [6/50] batch [380/428] time 0.088 (0.086) data 0.000 (0.002) loss 1.8088 (1.7081) ce_loss 1.6309 (1.4258) teacher_loss 1.1523 (1.0070) loss_zs_kd 0.4494 (0.4426) loss_oracle 0.4318 (0.4798) acc 37.5000 (48.7993) kd_loss 0.8314 (0.7757) lr 1.9686e-03 eta 0:26:59
epoch [6/50] batch [400/428] time 0.087 (0.086) data 0.000 (0.002) loss 1.6295 (1.7051) ce_loss 1.3408 (1.4217) teacher_loss 0.8133 (0.9993) loss_zs_kd 0.3971 (0.4439) loss_oracle 0.6176 (0.4839) acc 56.2500 (48.8516) kd_loss 0.8680 (0.7796) lr 1.9686e-03 eta 0:26:55
epoch [6/50] batch [420/428] time 0.079 (0.086) data 0.000 (0.002) loss 1.4505 (1.7076) ce_loss 1.3486 (1.4260) teacher_loss 0.7709 (0.9980) loss_zs_kd 0.4735 (0.4445) loss_oracle 0.4428 (0.4874) acc 43.7500 (48.6682) kd_loss 0.7691 (0.7825) lr 1.9686e-03 eta 0:26:53
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,921
* accuracy: 49.7%
* error: 50.3%
* macro_f1: 34.9%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,580
* accuracy: 54.4%
* error: 45.6%
* macro_f1: 32.1%
******* Domain 1 best val acc:      50.3%, epoch: 5 *******
******* Domain 1 best val test acc: 51.7%, epoch: 5 *******
******* Domain 1 best test acc:     56.7%, epoch: 2 *******
epoch [7/50] batch [20/428] time 0.084 (0.115) data 0.000 (0.025) loss 1.8358 (1.7162) ce_loss 1.4707 (1.3542) teacher_loss 1.0280 (0.9241) loss_zs_kd 0.5196 (0.4642) loss_oracle 0.5480 (0.5600) acc 50.0000 (51.0938) kd_loss 0.8862 (0.8417) lr 1.9511e-03 eta 0:36:01
epoch [7/50] batch [40/428] time 0.086 (0.099) data 0.000 (0.013) loss 1.6096 (1.7479) ce_loss 1.2822 (1.3824) teacher_loss 0.7901 (0.9491) loss_zs_kd 0.4522 (0.4547) loss_oracle 0.5934 (0.5715) acc 56.2500 (51.0156) kd_loss 0.8074 (0.8352) lr 1.9511e-03 eta 0:31:00
epoch [7/50] batch [60/428] time 0.092 (0.093) data 0.001 (0.008) loss 1.7778 (1.7390) ce_loss 1.4551 (1.3827) teacher_loss 1.0364 (0.9473) loss_zs_kd 0.4668 (0.4522) loss_oracle 0.5080 (0.5656) acc 46.8750 (50.8333) kd_loss 0.8060 (0.8328) lr 1.9511e-03 eta 0:29:14
epoch [7/50] batch [80/428] time 0.085 (0.091) data 0.000 (0.006) loss 1.7265 (1.7420) ce_loss 1.4092 (1.3796) teacher_loss 1.0152 (0.9517) loss_zs_kd 0.4568 (0.4532) loss_oracle 0.4829 (0.5636) acc 56.2500 (51.2109) kd_loss 0.7901 (0.8299) lr 1.9511e-03 eta 0:28:33
epoch [7/50] batch [100/428] time 0.080 (0.090) data 0.000 (0.005) loss 1.3673 (1.7336) ce_loss 1.0771 (1.3768) teacher_loss 0.7402 (0.9597) loss_zs_kd 0.4302 (0.4516) loss_oracle 0.4120 (0.5481) acc 62.5000 (51.3750) kd_loss 0.8061 (0.8211) lr 1.9511e-03 eta 0:28:00
epoch [7/50] batch [120/428] time 0.085 (0.088) data 0.000 (0.004) loss 1.7540 (1.7322) ce_loss 1.4824 (1.3697) teacher_loss 1.1222 (0.9680) loss_zs_kd 0.4420 (0.4440) loss_oracle 0.4108 (0.5422) acc 37.5000 (51.0417) kd_loss 0.7091 (0.8158) lr 1.9511e-03 eta 0:27:34
epoch [7/50] batch [140/428] time 0.088 (0.088) data 0.000 (0.004) loss 2.4564 (1.7513) ce_loss 1.9609 (1.3850) teacher_loss 1.6258 (0.9880) loss_zs_kd 0.4682 (0.4432) loss_oracle 0.5965 (0.5417) acc 25.0000 (50.3348) kd_loss 0.8006 (0.8135) lr 1.9511e-03 eta 0:27:22
epoch [7/50] batch [160/428] time 0.081 (0.087) data 0.000 (0.003) loss 1.7574 (1.7530) ce_loss 1.3760 (1.3788) teacher_loss 0.9847 (0.9868) loss_zs_kd 0.4473 (0.4461) loss_oracle 0.5491 (0.5432) acc 40.6250 (50.5273) kd_loss 0.7538 (0.8138) lr 1.9511e-03 eta 0:27:11
epoch [7/50] batch [180/428] time 0.083 (0.087) data 0.000 (0.003) loss 1.9875 (1.7607) ce_loss 1.2988 (1.3787) teacher_loss 1.1292 (0.9918) loss_zs_kd 0.4309 (0.4457) loss_oracle 0.6428 (0.5460) acc 62.5000 (50.2778) kd_loss 0.8384 (0.8130) lr 1.9511e-03 eta 0:27:02
epoch [7/50] batch [200/428] time 0.074 (0.086) data 0.000 (0.003) loss 1.6759 (1.7682) ce_loss 1.1035 (1.3803) teacher_loss 0.8833 (0.9983) loss_zs_kd 0.4464 (0.4434) loss_oracle 0.5694 (0.5482) acc 68.7500 (50.4844) kd_loss 0.7703 (0.8120) lr 1.9511e-03 eta 0:26:49
epoch [7/50] batch [220/428] time 0.089 (0.086) data 0.000 (0.003) loss 1.8844 (1.7724) ce_loss 1.6123 (1.3819) teacher_loss 1.0288 (1.0001) loss_zs_kd 0.4984 (0.4440) loss_oracle 0.6064 (0.5503) acc 40.6250 (50.3267) kd_loss 0.7831 (0.8122) lr 1.9511e-03 eta 0:26:42
epoch [7/50] batch [240/428] time 0.087 (0.086) data 0.000 (0.002) loss 2.3053 (1.7826) ce_loss 1.6396 (1.3860) teacher_loss 1.3163 (1.0029) loss_zs_kd 0.5706 (0.4478) loss_oracle 0.7038 (0.5558) acc 46.8750 (50.0781) kd_loss 0.8417 (0.8152) lr 1.9511e-03 eta 0:26:37
epoch [7/50] batch [260/428] time 0.084 (0.086) data 0.000 (0.002) loss 1.7284 (1.7926) ce_loss 1.3291 (1.3923) teacher_loss 0.8584 (1.0088) loss_zs_kd 0.5078 (0.4463) loss_oracle 0.6161 (0.5606) acc 46.8750 (49.7716) kd_loss 0.8641 (0.8156) lr 1.9511e-03 eta 0:26:33
epoch [7/50] batch [280/428] time 0.077 (0.085) data 0.000 (0.002) loss 2.1083 (1.7992) ce_loss 1.7666 (1.3976) teacher_loss 1.2266 (1.0090) loss_zs_kd 0.5129 (0.4488) loss_oracle 0.6253 (0.5657) acc 37.5000 (49.4308) kd_loss 0.8949 (0.8170) lr 1.9511e-03 eta 0:26:23
epoch [7/50] batch [300/428] time 0.092 (0.085) data 0.000 (0.002) loss 1.6056 (1.8042) ce_loss 1.0986 (1.3993) teacher_loss 0.8102 (1.0083) loss_zs_kd 0.3610 (0.4492) loss_oracle 0.6149 (0.5713) acc 62.5000 (49.2917) kd_loss 0.8652 (0.8185) lr 1.9511e-03 eta 0:26:19
epoch [7/50] batch [320/428] time 0.088 (0.085) data 0.000 (0.002) loss 1.9510 (1.8083) ce_loss 1.6924 (1.4055) teacher_loss 1.0833 (1.0077) loss_zs_kd 0.4096 (0.4486) loss_oracle 0.6629 (0.5763) acc 50.0000 (49.1211) kd_loss 0.7937 (0.8193) lr 1.9511e-03 eta 0:26:17
epoch [7/50] batch [340/428] time 0.093 (0.085) data 0.000 (0.002) loss 1.8913 (1.8129) ce_loss 1.5430 (1.4103) teacher_loss 1.0270 (1.0097) loss_zs_kd 0.4699 (0.4460) loss_oracle 0.6293 (0.5802) acc 46.8750 (48.8695) kd_loss 0.8309 (0.8198) lr 1.9511e-03 eta 0:26:16
epoch [7/50] batch [360/428] time 0.086 (0.085) data 0.000 (0.002) loss 1.8276 (1.8180) ce_loss 1.4844 (1.4143) teacher_loss 0.9618 (1.0107) loss_zs_kd 0.3848 (0.4442) loss_oracle 0.6733 (0.5852) acc 43.7500 (48.5764) kd_loss 0.8438 (0.8202) lr 1.9511e-03 eta 0:26:15
epoch [7/50] batch [380/428] time 0.079 (0.085) data 0.000 (0.002) loss 1.6992 (1.8205) ce_loss 1.4189 (1.4159) teacher_loss 0.8261 (1.0100) loss_zs_kd 0.3837 (0.4425) loss_oracle 0.6813 (0.5892) acc 50.0000 (48.4293) kd_loss 0.8639 (0.8207) lr 1.9511e-03 eta 0:26:11
epoch [7/50] batch [400/428] time 0.085 (0.085) data 0.000 (0.002) loss 2.2457 (1.8257) ce_loss 1.9336 (1.4199) teacher_loss 1.3750 (1.0122) loss_zs_kd 0.3858 (0.4410) loss_oracle 0.6779 (0.5930) acc 28.1250 (48.2344) kd_loss 0.8446 (0.8215) lr 1.9511e-03 eta 0:26:09
epoch [7/50] batch [420/428] time 0.076 (0.085) data 0.001 (0.001) loss 1.6070 (1.8272) ce_loss 1.1885 (1.4230) teacher_loss 0.7715 (1.0105) loss_zs_kd 0.4130 (0.4387) loss_oracle 0.6289 (0.5974) acc 56.2500 (47.9911) kd_loss 0.8269 (0.8222) lr 1.9511e-03 eta 0:26:04
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,450
* accuracy: 41.7%
* error: 58.3%
* macro_f1: 31.2%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,590
* accuracy: 54.6%
* error: 45.4%
* macro_f1: 28.3%
******* Domain 1 best val acc:      50.3%, epoch: 5 *******
******* Domain 1 best val test acc: 51.7%, epoch: 5 *******
******* Domain 1 best test acc:     56.7%, epoch: 2 *******
epoch [8/50] batch [20/428] time 0.088 (0.108) data 0.000 (0.024) loss 1.6953 (1.8813) ce_loss 1.2920 (1.5080) teacher_loss 0.8445 (1.0361) loss_zs_kd 0.3590 (0.3698) loss_oracle 0.6713 (0.6602) acc 43.7500 (41.8750) kd_loss 0.8300 (0.8230) lr 1.9298e-03 eta 0:33:06
epoch [8/50] batch [40/428] time 0.083 (0.096) data 0.000 (0.012) loss 1.9057 (1.8920) ce_loss 1.5078 (1.5015) teacher_loss 1.1421 (1.0590) loss_zs_kd 0.3597 (0.3635) loss_oracle 0.5837 (0.6512) acc 40.6250 (42.8125) kd_loss 0.8210 (0.8233) lr 1.9298e-03 eta 0:29:16
epoch [8/50] batch [60/428] time 0.081 (0.092) data 0.001 (0.008) loss 1.7164 (1.8937) ce_loss 1.3262 (1.5164) teacher_loss 0.8923 (1.0730) loss_zs_kd 0.3442 (0.3640) loss_oracle 0.6520 (0.6387) acc 50.0000 (42.9167) kd_loss 0.8219 (0.8218) lr 1.9298e-03 eta 0:28:04
epoch [8/50] batch [80/428] time 0.085 (0.089) data 0.000 (0.006) loss 2.2512 (1.9157) ce_loss 1.8545 (1.5304) teacher_loss 1.3780 (1.0847) loss_zs_kd 0.3657 (0.3683) loss_oracle 0.6903 (0.6469) acc 40.6250 (43.2031) kd_loss 0.8270 (0.8243) lr 1.9298e-03 eta 0:27:12
epoch [8/50] batch [100/428] time 0.079 (0.087) data 0.000 (0.005) loss 2.1241 (1.9224) ce_loss 1.8809 (1.5464) teacher_loss 1.1990 (1.0864) loss_zs_kd 0.4060 (0.3674) loss_oracle 0.7221 (0.6523) acc 37.5000 (42.4375) kd_loss 0.7990 (0.8244) lr 1.9298e-03 eta 0:26:37
epoch [8/50] batch [120/428] time 0.077 (0.086) data 0.000 (0.004) loss 1.6582 (1.9185) ce_loss 1.3496 (1.5340) teacher_loss 0.8226 (1.0789) loss_zs_kd 0.3294 (0.3655) loss_oracle 0.6708 (0.6569) acc 50.0000 (42.8646) kd_loss 0.8324 (0.8232) lr 1.9298e-03 eta 0:26:09
epoch [8/50] batch [140/428] time 0.078 (0.085) data 0.000 (0.004) loss 2.2256 (1.9210) ce_loss 1.7598 (1.5409) teacher_loss 1.3580 (1.0820) loss_zs_kd 0.3423 (0.3617) loss_oracle 0.6964 (0.6582) acc 34.3750 (42.5000) kd_loss 0.8062 (0.8197) lr 1.9298e-03 eta 0:25:56
epoch [8/50] batch [160/428] time 0.086 (0.085) data 0.000 (0.003) loss 2.0589 (1.9188) ce_loss 1.6592 (1.5416) teacher_loss 1.1131 (1.0744) loss_zs_kd 0.3941 (0.3650) loss_oracle 0.7487 (0.6618) acc 53.1250 (42.2461) kd_loss 0.8512 (0.8184) lr 1.9298e-03 eta 0:25:56
epoch [8/50] batch [180/428] time 0.081 (0.085) data 0.000 (0.003) loss 1.8394 (1.9165) ce_loss 1.6279 (1.5397) teacher_loss 1.0622 (1.0714) loss_zs_kd 0.3441 (0.3649) loss_oracle 0.6052 (0.6626) acc 37.5000 (42.2222) kd_loss 0.7474 (0.8147) lr 1.9298e-03 eta 0:25:51
epoch [8/50] batch [200/428] time 0.073 (0.085) data 0.000 (0.003) loss 1.8944 (1.9116) ce_loss 1.6855 (1.5321) teacher_loss 1.1068 (1.0669) loss_zs_kd 0.4039 (0.3679) loss_oracle 0.5857 (0.6607) acc 37.5000 (42.3750) kd_loss 0.8126 (0.8112) lr 1.9298e-03 eta 0:25:43
epoch [8/50] batch [220/428] time 0.083 (0.084) data 0.000 (0.002) loss 1.9258 (1.9073) ce_loss 1.5830 (1.5263) teacher_loss 1.1278 (1.0642) loss_zs_kd 0.4134 (0.3714) loss_oracle 0.5913 (0.6574) acc 40.6250 (42.4858) kd_loss 0.7526 (0.8068) lr 1.9298e-03 eta 0:25:36
epoch [8/50] batch [240/428] time 0.083 (0.084) data 0.000 (0.002) loss 1.8142 (1.9028) ce_loss 1.3125 (1.5170) teacher_loss 0.9762 (1.0614) loss_zs_kd 0.4001 (0.3735) loss_oracle 0.6380 (0.6547) acc 65.6250 (42.9297) kd_loss 0.7772 (0.8022) lr 1.9298e-03 eta 0:25:33
epoch [8/50] batch [260/428] time 0.085 (0.084) data 0.000 (0.002) loss 1.7098 (1.8943) ce_loss 1.3770 (1.5081) teacher_loss 0.9512 (1.0551) loss_zs_kd 0.3925 (0.3759) loss_oracle 0.5623 (0.6513) acc 50.0000 (43.2091) kd_loss 0.7438 (0.7986) lr 1.9298e-03 eta 0:25:32
epoch [8/50] batch [280/428] time 0.081 (0.084) data 0.000 (0.002) loss 1.8597 (1.8875) ce_loss 1.5107 (1.5009) teacher_loss 1.0337 (1.0498) loss_zs_kd 0.3823 (0.3785) loss_oracle 0.6348 (0.6485) acc 43.7500 (43.6049) kd_loss 0.7588 (0.7954) lr 1.9298e-03 eta 0:25:29
epoch [8/50] batch [300/428] time 0.082 (0.084) data 0.000 (0.002) loss 1.8698 (1.8855) ce_loss 1.3896 (1.4960) teacher_loss 1.0584 (1.0493) loss_zs_kd 0.4219 (0.3813) loss_oracle 0.6005 (0.6456) acc 53.1250 (43.9167) kd_loss 0.7286 (0.7916) lr 1.9298e-03 eta 0:25:28
epoch [8/50] batch [320/428] time 0.080 (0.084) data 0.000 (0.002) loss 1.7634 (1.8765) ce_loss 1.4189 (1.4908) teacher_loss 0.8888 (1.0415) loss_zs_kd 0.5090 (0.3852) loss_oracle 0.6201 (0.6423) acc 50.0000 (44.1016) kd_loss 0.7321 (0.7902) lr 1.9298e-03 eta 0:25:26
epoch [8/50] batch [340/428] time 0.085 (0.084) data 0.000 (0.002) loss 1.5594 (1.8701) ce_loss 1.2275 (1.4879) teacher_loss 0.6991 (1.0359) loss_zs_kd 0.5754 (0.3903) loss_oracle 0.5726 (0.6391) acc 56.2500 (44.2555) kd_loss 0.7630 (0.7895) lr 1.9298e-03 eta 0:25:21
epoch [8/50] batch [360/428] time 0.087 (0.084) data 0.000 (0.002) loss 1.6611 (1.8615) ce_loss 1.3975 (1.4810) teacher_loss 0.8234 (1.0277) loss_zs_kd 0.4169 (0.3955) loss_oracle 0.6292 (0.6361) acc 53.1250 (44.5920) kd_loss 0.7641 (0.7887) lr 1.9298e-03 eta 0:25:18
epoch [8/50] batch [380/428] time 0.084 (0.084) data 0.000 (0.002) loss 1.6464 (1.8516) ce_loss 1.3301 (1.4761) teacher_loss 0.9390 (1.0206) loss_zs_kd 0.4449 (0.3993) loss_oracle 0.4850 (0.6313) acc 43.7500 (44.8849) kd_loss 0.7736 (0.7886) lr 1.9298e-03 eta 0:25:14
epoch [8/50] batch [400/428] time 0.072 (0.084) data 0.000 (0.001) loss 1.3249 (1.8430) ce_loss 0.9365 (1.4724) teacher_loss 0.5117 (1.0157) loss_zs_kd 0.4768 (0.4025) loss_oracle 0.5748 (0.6261) acc 65.6250 (45.0000) kd_loss 0.8181 (0.7890) lr 1.9298e-03 eta 0:25:11
epoch [8/50] batch [420/428] time 0.078 (0.084) data 0.000 (0.001) loss 1.6777 (1.8344) ce_loss 1.5273 (1.4684) teacher_loss 1.0238 (1.0119) loss_zs_kd 0.3674 (0.4051) loss_oracle 0.4701 (0.6200) acc 50.0000 (45.2009) kd_loss 0.7683 (0.7892) lr 1.9298e-03 eta 0:25:08
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,855
* accuracy: 48.6%
* error: 51.4%
* macro_f1: 36.5%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,625
* accuracy: 55.4%
* error: 44.6%
* macro_f1: 30.2%
******* Domain 1 best val acc:      50.3%, epoch: 5 *******
******* Domain 1 best val test acc: 51.7%, epoch: 5 *******
******* Domain 1 best test acc:     56.7%, epoch: 2 *******
epoch [9/50] batch [20/428] time 0.075 (0.105) data 0.000 (0.033) loss 1.4557 (1.6512) ce_loss 1.1914 (1.3763) teacher_loss 0.7003 (0.9280) loss_zs_kd 0.5002 (0.4561) loss_oracle 0.5053 (0.4951) acc 53.1250 (50.7812) kd_loss 0.7654 (0.7764) lr 1.9048e-03 eta 0:31:19
epoch [9/50] batch [40/428] time 0.091 (0.094) data 0.000 (0.017) loss 1.7035 (1.6484) ce_loss 1.5518 (1.4040) teacher_loss 0.9597 (0.9328) loss_zs_kd 0.4667 (0.4547) loss_oracle 0.5104 (0.4882) acc 43.7500 (48.7500) kd_loss 0.7680 (0.7863) lr 1.9048e-03 eta 0:28:14
epoch [9/50] batch [60/428] time 0.086 (0.091) data 0.000 (0.011) loss 1.5502 (1.6582) ce_loss 1.1338 (1.4094) teacher_loss 0.8416 (0.9451) loss_zs_kd 0.4449 (0.4515) loss_oracle 0.4861 (0.4873) acc 59.3750 (48.6979) kd_loss 0.8667 (0.7951) lr 1.9048e-03 eta 0:27:13
epoch [9/50] batch [80/428] time 0.091 (0.090) data 0.000 (0.008) loss 1.6616 (1.6500) ce_loss 1.3643 (1.3973) teacher_loss 0.9499 (0.9465) loss_zs_kd 0.4968 (0.4540) loss_oracle 0.4632 (0.4766) acc 56.2500 (49.4922) kd_loss 0.8643 (0.8010) lr 1.9048e-03 eta 0:26:52
epoch [9/50] batch [100/428] time 0.086 (0.089) data 0.000 (0.007) loss 1.6108 (1.6510) ce_loss 1.5244 (1.4007) teacher_loss 0.9160 (0.9537) loss_zs_kd 0.4375 (0.4569) loss_oracle 0.4761 (0.4689) acc 43.7500 (49.3438) kd_loss 0.8932 (0.8057) lr 1.9048e-03 eta 0:26:31
epoch [9/50] batch [120/428] time 0.087 (0.089) data 0.000 (0.006) loss 1.5753 (1.6458) ce_loss 1.4355 (1.3969) teacher_loss 0.9725 (0.9471) loss_zs_kd 0.4861 (0.4618) loss_oracle 0.3597 (0.4677) acc 43.7500 (49.6615) kd_loss 0.8621 (0.8174) lr 1.9048e-03 eta 0:26:21
epoch [9/50] batch [140/428] time 0.097 (0.088) data 0.000 (0.005) loss 1.7718 (1.6433) ce_loss 1.5830 (1.4008) teacher_loss 1.0649 (0.9426) loss_zs_kd 0.5032 (0.4670) loss_oracle 0.4553 (0.4671) acc 43.7500 (49.5982) kd_loss 0.9763 (0.8268) lr 1.9048e-03 eta 0:26:12
epoch [9/50] batch [160/428] time 0.077 (0.088) data 0.000 (0.004) loss 1.8440 (1.6437) ce_loss 1.7021 (1.4070) teacher_loss 1.1747 (0.9406) loss_zs_kd 0.4766 (0.4721) loss_oracle 0.4310 (0.4671) acc 40.6250 (49.5898) kd_loss 1.0821 (0.8387) lr 1.9048e-03 eta 0:25:59
epoch [9/50] batch [180/428] time 0.077 (0.087) data 0.000 (0.004) loss 1.8799 (1.6486) ce_loss 1.6924 (1.4105) teacher_loss 1.1400 (0.9453) loss_zs_kd 0.4899 (0.4717) loss_oracle 0.4949 (0.4675) acc 46.8750 (49.7396) kd_loss 1.0198 (0.8466) lr 1.9048e-03 eta 0:25:46
epoch [9/50] batch [200/428] time 0.082 (0.087) data 0.000 (0.004) loss 1.5767 (1.6503) ce_loss 1.3848 (1.4199) teacher_loss 0.9033 (0.9461) loss_zs_kd 0.4513 (0.4759) loss_oracle 0.4477 (0.4662) acc 62.5000 (49.5469) kd_loss 1.0162 (0.8523) lr 1.9048e-03 eta 0:25:39
epoch [9/50] batch [220/428] time 0.086 (0.086) data 0.000 (0.003) loss 1.7080 (1.6478) ce_loss 1.3125 (1.4211) teacher_loss 0.9551 (0.9472) loss_zs_kd 0.5580 (0.4743) loss_oracle 0.4739 (0.4634) acc 53.1250 (49.5881) kd_loss 0.8401 (0.8585) lr 1.9048e-03 eta 0:25:34
epoch [9/50] batch [240/428] time 0.078 (0.087) data 0.000 (0.003) loss 1.7063 (1.6444) ce_loss 1.4424 (1.4249) teacher_loss 0.9111 (0.9448) loss_zs_kd 0.4643 (0.4752) loss_oracle 0.5630 (0.4620) acc 59.3750 (49.5703) kd_loss 0.9966 (0.8650) lr 1.9048e-03 eta 0:25:34
epoch [9/50] batch [260/428] time 0.079 (0.086) data 0.000 (0.003) loss 1.7722 (1.6466) ce_loss 1.7109 (1.4337) teacher_loss 1.0175 (0.9494) loss_zs_kd 0.5530 (0.4744) loss_oracle 0.4782 (0.4600) acc 43.7500 (49.1587) kd_loss 0.8727 (0.8719) lr 1.9048e-03 eta 0:25:22
epoch [9/50] batch [280/428] time 0.086 (0.086) data 0.000 (0.003) loss 1.4860 (1.6449) ce_loss 1.3604 (1.4342) teacher_loss 0.8482 (0.9469) loss_zs_kd 0.4447 (0.4764) loss_oracle 0.4154 (0.4598) acc 50.0000 (49.2299) kd_loss 0.9637 (0.8768) lr 1.9048e-03 eta 0:25:19
epoch [9/50] batch [300/428] time 0.079 (0.086) data 0.000 (0.002) loss 1.6897 (1.6436) ce_loss 1.5469 (1.4354) teacher_loss 0.9518 (0.9455) loss_zs_kd 0.5456 (0.4774) loss_oracle 0.4652 (0.4594) acc 40.6250 (49.1354) kd_loss 0.9197 (0.8797) lr 1.9048e-03 eta 0:25:18
epoch [9/50] batch [320/428] time 0.079 (0.086) data 0.000 (0.002) loss 1.6902 (1.6388) ce_loss 1.6045 (1.4359) teacher_loss 0.9377 (0.9385) loss_zs_kd 0.4373 (0.4764) loss_oracle 0.5339 (0.4621) acc 40.6250 (49.2090) kd_loss 0.9087 (0.8831) lr 1.9048e-03 eta 0:25:17
epoch [9/50] batch [340/428] time 0.082 (0.086) data 0.000 (0.002) loss 1.6598 (1.6403) ce_loss 1.5068 (1.4418) teacher_loss 1.1001 (0.9415) loss_zs_kd 0.3860 (0.4736) loss_oracle 0.3667 (0.4620) acc 43.7500 (48.9338) kd_loss 0.8929 (0.8825) lr 1.9048e-03 eta 0:25:13
epoch [9/50] batch [360/428] time 0.087 (0.086) data 0.000 (0.002) loss 1.6715 (1.6410) ce_loss 1.3730 (1.4438) teacher_loss 0.9616 (0.9422) loss_zs_kd 0.4638 (0.4720) loss_oracle 0.4780 (0.4628) acc 40.6250 (48.9236) kd_loss 0.8293 (0.8817) lr 1.9048e-03 eta 0:25:12
epoch [9/50] batch [380/428] time 0.081 (0.086) data 0.000 (0.002) loss 1.7436 (1.6450) ce_loss 1.5557 (1.4508) teacher_loss 1.0913 (0.9460) loss_zs_kd 0.4271 (0.4707) loss_oracle 0.4388 (0.4636) acc 43.7500 (48.7253) kd_loss 0.8578 (0.8812) lr 1.9048e-03 eta 0:25:08
epoch [9/50] batch [400/428] time 0.083 (0.086) data 0.000 (0.002) loss 1.9011 (1.6495) ce_loss 1.7783 (1.4589) teacher_loss 1.0943 (0.9488) loss_zs_kd 0.5228 (0.4701) loss_oracle 0.5454 (0.4656) acc 40.6250 (48.3672) kd_loss 0.9145 (0.8808) lr 1.9048e-03 eta 0:25:04
epoch [9/50] batch [420/428] time 0.087 (0.086) data 0.000 (0.002) loss 1.4612 (1.6492) ce_loss 1.2939 (1.4590) teacher_loss 0.7601 (0.9482) loss_zs_kd 0.4012 (0.4695) loss_oracle 0.5005 (0.4663) acc 46.8750 (48.2887) kd_loss 0.7663 (0.8787) lr 1.9048e-03 eta 0:25:03
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,670
* accuracy: 45.4%
* error: 54.6%
* macro_f1: 33.8%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,744
* accuracy: 57.9%
* error: 42.1%
* macro_f1: 30.5%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 1 best val acc:      50.3%, epoch: 5 *******
******* Domain 1 best val test acc: 51.7%, epoch: 5 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [10/50] batch [20/428] time 0.090 (0.110) data 0.000 (0.025) loss 1.7546 (1.6885) ce_loss 1.6094 (1.5269) teacher_loss 1.0135 (0.9594) loss_zs_kd 0.5060 (0.4525) loss_oracle 0.4881 (0.5029) acc 34.3750 (45.1562) kd_loss 0.8534 (0.8228) lr 1.8763e-03 eta 0:32:10
epoch [10/50] batch [40/428] time 0.084 (0.096) data 0.000 (0.013) loss 1.5344 (1.7214) ce_loss 1.2246 (1.5164) teacher_loss 0.7772 (0.9848) loss_zs_kd 0.4053 (0.4428) loss_oracle 0.5546 (0.5153) acc 56.2500 (45.7812) kd_loss 0.7729 (0.8184) lr 1.8763e-03 eta 0:27:57
epoch [10/50] batch [60/428] time 0.090 (0.092) data 0.001 (0.008) loss 1.7164 (1.7089) ce_loss 1.4141 (1.4935) teacher_loss 1.0526 (0.9762) loss_zs_kd 0.3745 (0.4288) loss_oracle 0.4766 (0.5183) acc 43.7500 (47.5521) kd_loss 0.7754 (0.8124) lr 1.8763e-03 eta 0:26:51
epoch [10/50] batch [80/428] time 0.088 (0.091) data 0.001 (0.006) loss 1.8786 (1.7095) ce_loss 1.4844 (1.4983) teacher_loss 1.0297 (0.9706) loss_zs_kd 0.5268 (0.4382) loss_oracle 0.5855 (0.5198) acc 53.1250 (47.3438) kd_loss 0.8376 (0.8117) lr 1.8763e-03 eta 0:26:22
epoch [10/50] batch [100/428] time 0.081 (0.089) data 0.000 (0.005) loss 1.5705 (1.7115) ce_loss 1.4062 (1.5024) teacher_loss 0.8482 (0.9730) loss_zs_kd 0.4307 (0.4384) loss_oracle 0.5069 (0.5193) acc 43.7500 (46.7500) kd_loss 0.8636 (0.8068) lr 1.8763e-03 eta 0:26:00
epoch [10/50] batch [120/428] time 0.083 (0.088) data 0.000 (0.004) loss 1.7771 (1.7084) ce_loss 1.3682 (1.5108) teacher_loss 1.0083 (0.9676) loss_zs_kd 0.5099 (0.4410) loss_oracle 0.5139 (0.5203) acc 56.2500 (46.2500) kd_loss 0.7447 (0.8074) lr 1.8763e-03 eta 0:25:38
epoch [10/50] batch [140/428] time 0.086 (0.088) data 0.000 (0.004) loss 1.5728 (1.7019) ce_loss 1.4199 (1.5091) teacher_loss 0.9547 (0.9574) loss_zs_kd 0.4055 (0.4428) loss_oracle 0.4153 (0.5231) acc 40.6250 (46.2946) kd_loss 0.8325 (0.8057) lr 1.8763e-03 eta 0:25:28
epoch [10/50] batch [160/428] time 0.082 (0.087) data 0.000 (0.003) loss 1.4969 (1.7005) ce_loss 1.2773 (1.5049) teacher_loss 0.8524 (0.9549) loss_zs_kd 0.3654 (0.4435) loss_oracle 0.4618 (0.5238) acc 53.1250 (46.4648) kd_loss 0.8367 (0.8047) lr 1.8763e-03 eta 0:25:19
epoch [10/50] batch [180/428] time 0.079 (0.087) data 0.000 (0.003) loss 1.6981 (1.7023) ce_loss 1.4844 (1.5072) teacher_loss 0.9437 (0.9559) loss_zs_kd 0.4284 (0.4455) loss_oracle 0.5402 (0.5236) acc 59.3750 (46.7535) kd_loss 0.8198 (0.8040) lr 1.8763e-03 eta 0:25:14
epoch [10/50] batch [200/428] time 0.078 (0.086) data 0.000 (0.003) loss 1.5695 (1.6942) ce_loss 1.5020 (1.5039) teacher_loss 0.8098 (0.9498) loss_zs_kd 0.4246 (0.4421) loss_oracle 0.5474 (0.5234) acc 34.3750 (46.7344) kd_loss 0.8301 (0.8044) lr 1.8763e-03 eta 0:24:56
epoch [10/50] batch [220/428] time 0.077 (0.086) data 0.000 (0.002) loss 1.5046 (1.6903) ce_loss 1.4570 (1.5093) teacher_loss 0.7110 (0.9428) loss_zs_kd 0.5072 (0.4444) loss_oracle 0.5400 (0.5253) acc 43.7500 (46.4915) kd_loss 0.8764 (0.8048) lr 1.8763e-03 eta 0:24:44
epoch [10/50] batch [240/428] time 0.078 (0.085) data 0.000 (0.002) loss 1.9340 (1.6909) ce_loss 1.9111 (1.5117) teacher_loss 1.1062 (0.9398) loss_zs_kd 0.5135 (0.4469) loss_oracle 0.5711 (0.5277) acc 31.2500 (46.2500) kd_loss 0.8354 (0.8047) lr 1.8763e-03 eta 0:24:35
epoch [10/50] batch [260/428] time 0.085 (0.085) data 0.000 (0.002) loss 1.7474 (1.6861) ce_loss 1.6738 (1.5118) teacher_loss 0.8592 (0.9309) loss_zs_kd 0.5790 (0.4503) loss_oracle 0.5987 (0.5301) acc 43.7500 (46.3582) kd_loss 0.8650 (0.8053) lr 1.8763e-03 eta 0:24:30
epoch [10/50] batch [280/428] time 0.083 (0.085) data 0.000 (0.002) loss 1.5248 (1.6806) ce_loss 1.6748 (1.5081) teacher_loss 0.7517 (0.9209) loss_zs_kd 0.4067 (0.4531) loss_oracle 0.5698 (0.5331) acc 46.8750 (46.4621) kd_loss 0.8329 (0.8062) lr 1.8763e-03 eta 0:24:26
epoch [10/50] batch [300/428] time 0.078 (0.085) data 0.000 (0.002) loss 1.3305 (1.6762) ce_loss 1.1104 (1.5080) teacher_loss 0.5677 (0.9145) loss_zs_kd 0.4615 (0.4551) loss_oracle 0.5321 (0.5341) acc 62.5000 (46.4583) kd_loss 0.7587 (0.8077) lr 1.8763e-03 eta 0:24:22
epoch [10/50] batch [320/428] time 0.082 (0.085) data 0.000 (0.002) loss 1.3774 (1.6703) ce_loss 1.0811 (1.5000) teacher_loss 0.6591 (0.9077) loss_zs_kd 0.4595 (0.4567) loss_oracle 0.4885 (0.5342) acc 59.3750 (46.6309) kd_loss 0.8449 (0.8088) lr 1.8763e-03 eta 0:24:22
epoch [10/50] batch [340/428] time 0.084 (0.085) data 0.000 (0.002) loss 2.0960 (1.6733) ce_loss 1.7158 (1.5025) teacher_loss 1.3063 (0.9083) loss_zs_kd 0.4869 (0.4602) loss_oracle 0.5463 (0.5349) acc 46.8750 (46.4890) kd_loss 0.7939 (0.8099) lr 1.8763e-03 eta 0:24:21
epoch [10/50] batch [360/428] time 0.085 (0.085) data 0.000 (0.002) loss 1.5514 (1.6712) ce_loss 1.4482 (1.4984) teacher_loss 0.7416 (0.9040) loss_zs_kd 0.4773 (0.4633) loss_oracle 0.5711 (0.5356) acc 43.7500 (46.5885) kd_loss 0.7851 (0.8108) lr 1.8763e-03 eta 0:24:19
epoch [10/50] batch [380/428] time 0.083 (0.085) data 0.000 (0.002) loss 2.1211 (1.6692) ce_loss 2.0215 (1.4934) teacher_loss 1.2995 (0.9003) loss_zs_kd 0.4656 (0.4649) loss_oracle 0.5888 (0.5365) acc 34.3750 (46.7928) kd_loss 0.7486 (0.8104) lr 1.8763e-03 eta 0:24:17
epoch [10/50] batch [400/428] time 0.082 (0.085) data 0.000 (0.001) loss 1.7084 (1.6674) ce_loss 1.7842 (1.4932) teacher_loss 0.8594 (0.8972) loss_zs_kd 0.5502 (0.4660) loss_oracle 0.5739 (0.5371) acc 25.0000 (46.6953) kd_loss 0.8223 (0.8101) lr 1.8763e-03 eta 0:24:13
epoch [10/50] batch [420/428] time 0.080 (0.085) data 0.000 (0.001) loss 1.6510 (1.6685) ce_loss 1.5645 (1.4947) teacher_loss 0.8673 (0.8976) loss_zs_kd 0.4589 (0.4656) loss_oracle 0.5543 (0.5381) acc 46.8750 (46.5923) kd_loss 0.8049 (0.8109) lr 1.8763e-03 eta 0:24:12
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,771
* accuracy: 47.2%
* error: 52.8%
* macro_f1: 34.0%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,677
* accuracy: 56.5%
* error: 43.5%
* macro_f1: 30.9%
******* Domain 1 best val acc:      50.3%, epoch: 5 *******
******* Domain 1 best val test acc: 51.7%, epoch: 5 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [11/50] batch [20/428] time 0.085 (0.106) data 0.000 (0.025) loss 1.6995 (1.6539) ce_loss 1.6230 (1.4636) teacher_loss 0.8214 (0.8536) loss_zs_kd 0.5199 (0.4842) loss_oracle 0.6181 (0.5582) acc 40.6250 (47.6562) kd_loss 0.8315 (0.8009) lr 1.8443e-03 eta 0:30:14
epoch [11/50] batch [40/428] time 0.079 (0.095) data 0.000 (0.012) loss 1.7072 (1.6122) ce_loss 1.6758 (1.4434) teacher_loss 0.8991 (0.8181) loss_zs_kd 0.5031 (0.4859) loss_oracle 0.5565 (0.5511) acc 40.6250 (48.6719) kd_loss 0.8132 (0.8100) lr 1.8443e-03 eta 0:26:55
epoch [11/50] batch [60/428] time 0.083 (0.090) data 0.000 (0.008) loss 1.5997 (1.6102) ce_loss 1.2793 (1.4612) teacher_loss 0.7752 (0.8149) loss_zs_kd 0.5447 (0.4905) loss_oracle 0.5522 (0.5500) acc 43.7500 (47.7083) kd_loss 0.7720 (0.8153) lr 1.8443e-03 eta 0:25:41
epoch [11/50] batch [80/428] time 0.074 (0.089) data 0.000 (0.006) loss 1.6908 (1.6049) ce_loss 1.4834 (1.4707) teacher_loss 0.9135 (0.8126) loss_zs_kd 0.4467 (0.4810) loss_oracle 0.5539 (0.5518) acc 50.0000 (47.1484) kd_loss 0.7220 (0.8147) lr 1.8443e-03 eta 0:25:08
epoch [11/50] batch [100/428] time 0.088 (0.087) data 0.000 (0.005) loss 1.4124 (1.6118) ce_loss 1.3018 (1.4795) teacher_loss 0.6541 (0.8209) loss_zs_kd 0.4982 (0.4791) loss_oracle 0.5092 (0.5514) acc 56.2500 (46.4375) kd_loss 0.7865 (0.8139) lr 1.8443e-03 eta 0:24:41
epoch [11/50] batch [120/428] time 0.085 (0.087) data 0.000 (0.004) loss 1.6536 (1.6077) ce_loss 1.6133 (1.4871) teacher_loss 0.8549 (0.8188) loss_zs_kd 0.4829 (0.4751) loss_oracle 0.5572 (0.5514) acc 43.7500 (46.4583) kd_loss 0.8575 (0.8178) lr 1.8443e-03 eta 0:24:30
epoch [11/50] batch [140/428] time 0.092 (0.086) data 0.000 (0.004) loss 1.8521 (1.6132) ce_loss 1.7852 (1.4952) teacher_loss 0.9935 (0.8235) loss_zs_kd 0.5350 (0.4759) loss_oracle 0.5911 (0.5518) acc 46.8750 (46.1607) kd_loss 0.7511 (0.8163) lr 1.8443e-03 eta 0:24:28
epoch [11/50] batch [160/428] time 0.085 (0.086) data 0.000 (0.003) loss 1.7704 (1.6175) ce_loss 1.7822 (1.5034) teacher_loss 0.9975 (0.8263) loss_zs_kd 0.4754 (0.4788) loss_oracle 0.5352 (0.5518) acc 40.6250 (45.8789) kd_loss 0.8800 (0.8189) lr 1.8443e-03 eta 0:24:19
epoch [11/50] batch [180/428] time 0.084 (0.086) data 0.000 (0.003) loss 1.6572 (1.6187) ce_loss 1.3896 (1.5046) teacher_loss 0.8421 (0.8285) loss_zs_kd 0.5233 (0.4789) loss_oracle 0.5535 (0.5508) acc 43.7500 (45.6424) kd_loss 0.7853 (0.8167) lr 1.8443e-03 eta 0:24:13
epoch [11/50] batch [200/428] time 0.078 (0.085) data 0.000 (0.003) loss 1.5933 (1.6208) ce_loss 1.6963 (1.5099) teacher_loss 0.8118 (0.8297) loss_zs_kd 0.4560 (0.4793) loss_oracle 0.5535 (0.5515) acc 50.0000 (45.5625) kd_loss 0.8390 (0.8187) lr 1.8443e-03 eta 0:24:03
epoch [11/50] batch [220/428] time 0.082 (0.085) data 0.000 (0.003) loss 1.5930 (1.6202) ce_loss 1.4766 (1.5134) teacher_loss 0.8155 (0.8289) loss_zs_kd 0.4728 (0.4808) loss_oracle 0.5411 (0.5509) acc 46.8750 (45.4830) kd_loss 0.7952 (0.8201) lr 1.8443e-03 eta 0:23:57
epoch [11/50] batch [240/428] time 0.081 (0.085) data 0.000 (0.002) loss 1.6997 (1.6215) ce_loss 1.7949 (1.5145) teacher_loss 0.8035 (0.8277) loss_zs_kd 0.5434 (0.4811) loss_oracle 0.6245 (0.5533) acc 34.3750 (45.6250) kd_loss 0.8283 (0.8222) lr 1.8443e-03 eta 0:23:54
epoch [11/50] batch [260/428] time 0.072 (0.085) data 0.000 (0.002) loss 1.7245 (1.6253) ce_loss 1.5303 (1.5217) teacher_loss 0.9308 (0.8324) loss_zs_kd 0.4927 (0.4806) loss_oracle 0.5473 (0.5526) acc 46.8750 (45.3486) kd_loss 0.7884 (0.8221) lr 1.8443e-03 eta 0:23:47
epoch [11/50] batch [280/428] time 0.079 (0.085) data 0.000 (0.002) loss 1.5505 (1.6239) ce_loss 1.3350 (1.5209) teacher_loss 0.7551 (0.8325) loss_zs_kd 0.5426 (0.4802) loss_oracle 0.5241 (0.5513) acc 53.1250 (45.5915) kd_loss 0.7958 (0.8218) lr 1.8443e-03 eta 0:23:44
epoch [11/50] batch [300/428] time 0.090 (0.085) data 0.000 (0.002) loss 1.7855 (1.6253) ce_loss 1.6338 (1.5255) teacher_loss 1.0413 (0.8354) loss_zs_kd 0.4598 (0.4790) loss_oracle 0.5144 (0.5504) acc 43.7500 (45.4792) kd_loss 0.8113 (0.8215) lr 1.8443e-03 eta 0:23:43
epoch [11/50] batch [320/428] time 0.084 (0.085) data 0.000 (0.002) loss 1.5898 (1.6257) ce_loss 1.4453 (1.5266) teacher_loss 0.8008 (0.8375) loss_zs_kd 0.5077 (0.4779) loss_oracle 0.5352 (0.5492) acc 46.8750 (45.5273) kd_loss 0.8137 (0.8215) lr 1.8443e-03 eta 0:23:41
epoch [11/50] batch [340/428] time 0.084 (0.085) data 0.000 (0.002) loss 1.5743 (1.6236) ce_loss 1.7129 (1.5241) teacher_loss 0.8083 (0.8357) loss_zs_kd 0.4483 (0.4770) loss_oracle 0.5419 (0.5494) acc 31.2500 (45.7077) kd_loss 0.9190 (0.8214) lr 1.8443e-03 eta 0:23:41
epoch [11/50] batch [360/428] time 0.064 (0.085) data 0.000 (0.002) loss 1.5384 (1.6220) ce_loss 1.5918 (1.5238) teacher_loss 0.8237 (0.8353) loss_zs_kd 0.4546 (0.4770) loss_oracle 0.4874 (0.5483) acc 34.3750 (45.7465) kd_loss 0.9237 (0.8215) lr 1.8443e-03 eta 0:23:39
epoch [11/50] batch [380/428] time 0.083 (0.084) data 0.000 (0.002) loss 1.7069 (1.6220) ce_loss 1.5029 (1.5232) teacher_loss 0.9098 (0.8390) loss_zs_kd 0.4861 (0.4748) loss_oracle 0.5541 (0.5456) acc 50.0000 (45.8388) kd_loss 0.7863 (0.8214) lr 1.8443e-03 eta 0:23:33
epoch [11/50] batch [400/428] time 0.082 (0.084) data 0.000 (0.002) loss 1.6250 (1.6248) ce_loss 1.3291 (1.5241) teacher_loss 0.8563 (0.8440) loss_zs_kd 0.4853 (0.4723) loss_oracle 0.5261 (0.5447) acc 56.2500 (45.8359) kd_loss 0.7313 (0.8199) lr 1.8443e-03 eta 0:23:32
epoch [11/50] batch [420/428] time 0.086 (0.084) data 0.000 (0.001) loss 1.6432 (1.6253) ce_loss 1.2949 (1.5239) teacher_loss 0.9195 (0.8460) loss_zs_kd 0.4197 (0.4704) loss_oracle 0.5139 (0.5441) acc 50.0000 (45.9003) kd_loss 0.7457 (0.8200) lr 1.8443e-03 eta 0:23:30
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,807
* accuracy: 47.8%
* error: 52.2%
* macro_f1: 33.2%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,444
* accuracy: 51.6%
* error: 48.4%
* macro_f1: 30.6%
******* Domain 1 best val acc:      50.3%, epoch: 5 *******
******* Domain 1 best val test acc: 51.7%, epoch: 5 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [12/50] batch [20/428] time 0.080 (0.110) data 0.000 (0.026) loss 1.5453 (1.6322) ce_loss 1.2109 (1.5346) teacher_loss 0.8391 (0.8959) loss_zs_kd 0.4196 (0.4379) loss_oracle 0.4964 (0.5173) acc 62.5000 (47.6562) kd_loss 0.7429 (0.8402) lr 1.8090e-03 eta 0:30:30
epoch [12/50] batch [40/428] time 0.077 (0.094) data 0.000 (0.013) loss 1.5942 (1.6313) ce_loss 1.9082 (1.5425) teacher_loss 0.8189 (0.9081) loss_zs_kd 0.5029 (0.4321) loss_oracle 0.5238 (0.5071) acc 31.2500 (46.4062) kd_loss 0.9060 (0.8713) lr 1.8090e-03 eta 0:26:01
epoch [12/50] batch [60/428] time 0.074 (0.089) data 0.001 (0.009) loss 1.7401 (1.6526) ce_loss 1.6738 (1.5288) teacher_loss 1.0214 (0.9343) loss_zs_kd 0.3566 (0.4285) loss_oracle 0.5404 (0.5040) acc 31.2500 (46.1458) kd_loss 0.9899 (0.8732) lr 1.8090e-03 eta 0:24:39
epoch [12/50] batch [80/428] time 0.080 (0.087) data 0.000 (0.007) loss 1.5924 (1.6703) ce_loss 1.3018 (1.5187) teacher_loss 0.8255 (0.9483) loss_zs_kd 0.4614 (0.4242) loss_oracle 0.5362 (0.5099) acc 59.3750 (46.7188) kd_loss 0.8657 (0.8778) lr 1.8090e-03 eta 0:24:07
epoch [12/50] batch [100/428] time 0.088 (0.087) data 0.000 (0.005) loss 1.9501 (1.6807) ce_loss 1.6514 (1.5211) teacher_loss 1.2375 (0.9616) loss_zs_kd 0.4213 (0.4215) loss_oracle 0.5019 (0.5083) acc 43.7500 (46.6875) kd_loss 0.8450 (0.8873) lr 1.8090e-03 eta 0:23:58
epoch [12/50] batch [120/428] time 0.086 (0.086) data 0.000 (0.005) loss 1.6494 (1.6903) ce_loss 1.2529 (1.5363) teacher_loss 0.9738 (0.9736) loss_zs_kd 0.3799 (0.4201) loss_oracle 0.4857 (0.5067) acc 50.0000 (46.5625) kd_loss 0.8121 (0.8946) lr 1.8090e-03 eta 0:23:53
epoch [12/50] batch [140/428] time 0.078 (0.086) data 0.000 (0.004) loss 1.5885 (1.6913) ce_loss 1.4062 (1.5239) teacher_loss 0.9105 (0.9805) loss_zs_kd 0.3510 (0.4152) loss_oracle 0.5024 (0.5032) acc 59.3750 (46.9196) kd_loss 0.9951 (0.9021) lr 1.8090e-03 eta 0:23:41
epoch [12/50] batch [160/428] time 0.082 (0.086) data 0.000 (0.003) loss 1.7817 (1.7037) ce_loss 1.5400 (1.5197) teacher_loss 0.9833 (0.9913) loss_zs_kd 0.4372 (0.4126) loss_oracle 0.5798 (0.5061) acc 43.7500 (47.1484) kd_loss 1.0046 (0.9083) lr 1.8090e-03 eta 0:23:36
epoch [12/50] batch [180/428] time 0.072 (0.085) data 0.000 (0.003) loss 1.5352 (1.7096) ce_loss 1.1846 (1.5142) teacher_loss 0.8899 (0.9917) loss_zs_kd 0.3821 (0.4153) loss_oracle 0.4543 (0.5103) acc 59.3750 (47.4653) kd_loss 1.0110 (0.9174) lr 1.8090e-03 eta 0:23:30
epoch [12/50] batch [200/428] time 0.073 (0.085) data 0.000 (0.003) loss 1.8197 (1.7164) ce_loss 1.4961 (1.5115) teacher_loss 1.1126 (0.9957) loss_zs_kd 0.4391 (0.4163) loss_oracle 0.4876 (0.5125) acc 46.8750 (47.6406) kd_loss 0.9875 (0.9253) lr 1.8090e-03 eta 0:23:23
epoch [12/50] batch [220/428] time 0.076 (0.085) data 0.000 (0.003) loss 1.6667 (1.7226) ce_loss 1.3418 (1.5123) teacher_loss 1.0540 (1.0034) loss_zs_kd 0.3270 (0.4134) loss_oracle 0.4492 (0.5125) acc 43.7500 (47.4290) kd_loss 1.0562 (0.9357) lr 1.8090e-03 eta 0:23:13
epoch [12/50] batch [240/428] time 0.083 (0.085) data 0.000 (0.002) loss 1.8573 (1.7283) ce_loss 1.6836 (1.5138) teacher_loss 1.2165 (1.0142) loss_zs_kd 0.3274 (0.4102) loss_oracle 0.4771 (0.5090) acc 46.8750 (47.3438) kd_loss 1.0538 (0.9451) lr 1.8090e-03 eta 0:23:10
epoch [12/50] batch [260/428] time 0.084 (0.085) data 0.000 (0.002) loss 1.4509 (1.7306) ce_loss 1.2158 (1.5136) teacher_loss 0.8229 (1.0192) loss_zs_kd 0.3402 (0.4094) loss_oracle 0.4580 (0.5067) acc 62.5000 (47.4880) kd_loss 1.1236 (0.9536) lr 1.8090e-03 eta 0:23:09
epoch [12/50] batch [280/428] time 0.084 (0.085) data 0.000 (0.002) loss 1.7397 (1.7323) ce_loss 1.5176 (1.5166) teacher_loss 0.9904 (1.0257) loss_zs_kd 0.4252 (0.4081) loss_oracle 0.5367 (0.5026) acc 46.8750 (47.3661) kd_loss 1.0175 (0.9593) lr 1.8090e-03 eta 0:23:07
epoch [12/50] batch [300/428] time 0.087 (0.085) data 0.000 (0.002) loss 1.6885 (1.7342) ce_loss 1.4111 (1.5129) teacher_loss 0.8953 (1.0297) loss_zs_kd 0.4816 (0.4067) loss_oracle 0.5524 (0.5012) acc 53.1250 (47.4896) kd_loss 1.0570 (0.9642) lr 1.8090e-03 eta 0:23:06
epoch [12/50] batch [320/428] time 0.082 (0.084) data 0.000 (0.002) loss 1.6055 (1.7341) ce_loss 1.3096 (1.5117) teacher_loss 0.9067 (1.0324) loss_zs_kd 0.3772 (0.4065) loss_oracle 0.5103 (0.4984) acc 65.6250 (47.4219) kd_loss 1.0676 (0.9700) lr 1.8090e-03 eta 0:22:58
epoch [12/50] batch [340/428] time 0.078 (0.084) data 0.000 (0.002) loss 1.9423 (1.7327) ce_loss 1.7939 (1.5091) teacher_loss 1.4547 (1.0365) loss_zs_kd 0.3060 (0.4033) loss_oracle 0.3346 (0.4945) acc 43.7500 (47.5000) kd_loss 0.9723 (0.9739) lr 1.8090e-03 eta 0:22:52
epoch [12/50] batch [360/428] time 0.082 (0.084) data 0.000 (0.002) loss 1.4788 (1.7290) ce_loss 1.0605 (1.5039) teacher_loss 0.7895 (1.0360) loss_zs_kd 0.3925 (0.4018) loss_oracle 0.4930 (0.4921) acc 59.3750 (47.7344) kd_loss 1.1191 (0.9769) lr 1.8090e-03 eta 0:22:43
epoch [12/50] batch [380/428] time 0.068 (0.083) data 0.000 (0.002) loss 1.8719 (1.7275) ce_loss 1.6826 (1.5028) teacher_loss 1.1996 (1.0381) loss_zs_kd 0.3494 (0.4005) loss_oracle 0.4976 (0.4891) acc 34.3750 (47.5822) kd_loss 0.8813 (0.9782) lr 1.8090e-03 eta 0:22:32
epoch [12/50] batch [400/428] time 0.094 (0.083) data 0.000 (0.002) loss 1.4487 (1.7275) ce_loss 1.4268 (1.5019) teacher_loss 0.8464 (1.0399) loss_zs_kd 0.3905 (0.4007) loss_oracle 0.4070 (0.4873) acc 50.0000 (47.5391) kd_loss 1.1313 (0.9803) lr 1.8090e-03 eta 0:22:26
epoch [12/50] batch [420/428] time 0.086 (0.083) data 0.000 (0.002) loss 1.7763 (1.7298) ce_loss 1.5889 (1.5050) teacher_loss 1.1941 (1.0435) loss_zs_kd 0.3301 (0.4006) loss_oracle 0.4171 (0.4860) acc 40.6250 (47.4182) kd_loss 1.0853 (0.9815) lr 1.8090e-03 eta 0:22:25
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,762
* accuracy: 47.0%
* error: 53.0%
* macro_f1: 30.3%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,394
* accuracy: 50.5%
* error: 49.5%
* macro_f1: 26.8%
******* Domain 1 best val acc:      50.3%, epoch: 5 *******
******* Domain 1 best val test acc: 51.7%, epoch: 5 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [13/50] batch [20/428] time 0.086 (0.113) data 0.001 (0.024) loss 1.6129 (1.7562) ce_loss 1.3252 (1.6197) teacher_loss 0.9660 (1.0830) loss_zs_kd 0.4890 (0.4361) loss_oracle 0.4024 (0.4551) acc 56.2500 (44.0625) kd_loss 0.9794 (1.0261) lr 1.7705e-03 eta 0:30:34
epoch [13/50] batch [40/428] time 0.081 (0.099) data 0.000 (0.012) loss 1.8972 (1.7512) ce_loss 1.6963 (1.5612) teacher_loss 1.1546 (1.0884) loss_zs_kd 0.4093 (0.4314) loss_oracle 0.5379 (0.4472) acc 43.7500 (46.4844) kd_loss 1.0934 (1.0332) lr 1.7705e-03 eta 0:26:38
epoch [13/50] batch [60/428] time 0.083 (0.094) data 0.000 (0.008) loss 1.7829 (1.7142) ce_loss 1.4639 (1.5328) teacher_loss 1.2058 (1.0675) loss_zs_kd 0.3705 (0.4107) loss_oracle 0.3918 (0.4414) acc 46.8750 (46.9271) kd_loss 0.9879 (1.0344) lr 1.7705e-03 eta 0:25:16
epoch [13/50] batch [80/428] time 0.082 (0.091) data 0.000 (0.006) loss 1.6867 (1.7145) ce_loss 1.5654 (1.5350) teacher_loss 1.0986 (1.0722) loss_zs_kd 0.3404 (0.4059) loss_oracle 0.4179 (0.4394) acc 43.7500 (46.4453) kd_loss 1.0092 (1.0352) lr 1.7705e-03 eta 0:24:38
epoch [13/50] batch [100/428] time 0.078 (0.089) data 0.000 (0.005) loss 1.6583 (1.7090) ce_loss 1.4512 (1.5265) teacher_loss 1.0815 (1.0687) loss_zs_kd 0.4461 (0.4037) loss_oracle 0.3538 (0.4383) acc 37.5000 (46.4688) kd_loss 0.9902 (1.0277) lr 1.7705e-03 eta 0:23:55
epoch [13/50] batch [120/428] time 0.087 (0.088) data 0.000 (0.004) loss 1.6079 (1.7095) ce_loss 1.3389 (1.5246) teacher_loss 1.0230 (1.0727) loss_zs_kd 0.3349 (0.4006) loss_oracle 0.4175 (0.4365) acc 59.3750 (46.6406) kd_loss 0.9577 (1.0210) lr 1.7705e-03 eta 0:23:33
epoch [13/50] batch [140/428] time 0.093 (0.088) data 0.000 (0.004) loss 1.5745 (1.7007) ce_loss 1.2949 (1.5089) teacher_loss 0.8818 (1.0637) loss_zs_kd 0.3908 (0.4011) loss_oracle 0.4973 (0.4364) acc 56.2500 (47.2768) kd_loss 1.1622 (1.0168) lr 1.7705e-03 eta 0:23:33
epoch [13/50] batch [160/428] time 0.085 (0.087) data 0.000 (0.003) loss 1.5737 (1.7035) ce_loss 1.2744 (1.5179) teacher_loss 0.9240 (1.0679) loss_zs_kd 0.3734 (0.3973) loss_oracle 0.4631 (0.4370) acc 50.0000 (46.9727) kd_loss 1.0705 (1.0119) lr 1.7705e-03 eta 0:23:27
epoch [13/50] batch [180/428] time 0.081 (0.087) data 0.000 (0.003) loss 1.5066 (1.6943) ce_loss 1.2314 (1.5077) teacher_loss 0.7817 (1.0547) loss_zs_kd 0.4604 (0.4012) loss_oracle 0.4948 (0.4390) acc 71.8750 (47.4132) kd_loss 0.9868 (1.0081) lr 1.7705e-03 eta 0:23:13
epoch [13/50] batch [200/428] time 0.082 (0.086) data 0.000 (0.003) loss 1.4911 (1.6919) ce_loss 1.4072 (1.5028) teacher_loss 0.7835 (1.0481) loss_zs_kd 0.4311 (0.4008) loss_oracle 0.4921 (0.4434) acc 50.0000 (47.3125) kd_loss 0.9701 (1.0031) lr 1.7705e-03 eta 0:23:06
epoch [13/50] batch [220/428] time 0.085 (0.086) data 0.000 (0.002) loss 1.7028 (1.6889) ce_loss 1.4561 (1.5000) teacher_loss 1.0130 (1.0446) loss_zs_kd 0.3895 (0.4004) loss_oracle 0.4951 (0.4441) acc 53.1250 (47.4858) kd_loss 1.0182 (0.9991) lr 1.7705e-03 eta 0:22:57
epoch [13/50] batch [240/428] time 0.100 (0.086) data 0.001 (0.002) loss 1.5238 (1.6836) ce_loss 1.2500 (1.4936) teacher_loss 0.7800 (1.0388) loss_zs_kd 0.4927 (0.3990) loss_oracle 0.4975 (0.4452) acc 59.3750 (47.5651) kd_loss 0.8864 (0.9952) lr 1.7705e-03 eta 0:23:02
epoch [13/50] batch [260/428] time 0.079 (0.086) data 0.000 (0.002) loss 1.7863 (1.6849) ce_loss 2.0430 (1.4957) teacher_loss 1.1736 (1.0394) loss_zs_kd 0.3250 (0.3991) loss_oracle 0.4503 (0.4459) acc 37.5000 (47.4639) kd_loss 1.0099 (0.9901) lr 1.7705e-03 eta 0:22:59
epoch [13/50] batch [280/428] time 0.076 (0.086) data 0.000 (0.002) loss 1.8228 (1.6841) ce_loss 1.7705 (1.4981) teacher_loss 1.1819 (1.0382) loss_zs_kd 0.3118 (0.3973) loss_oracle 0.4850 (0.4472) acc 37.5000 (47.3438) kd_loss 0.9319 (0.9847) lr 1.7705e-03 eta 0:22:53
epoch [13/50] batch [300/428] time 0.081 (0.085) data 0.000 (0.002) loss 1.7217 (1.6853) ce_loss 1.7529 (1.5000) teacher_loss 0.9454 (1.0368) loss_zs_kd 0.4470 (0.3971) loss_oracle 0.5528 (0.4499) acc 31.2500 (47.1354) kd_loss 0.9344 (0.9801) lr 1.7705e-03 eta 0:22:43
epoch [13/50] batch [320/428] time 0.081 (0.085) data 0.000 (0.002) loss 1.8494 (1.6823) ce_loss 1.3711 (1.4978) teacher_loss 1.1395 (1.0324) loss_zs_kd 0.4132 (0.3979) loss_oracle 0.5033 (0.4509) acc 53.1250 (47.1582) kd_loss 0.9036 (0.9750) lr 1.7705e-03 eta 0:22:40
epoch [13/50] batch [340/428] time 0.070 (0.085) data 0.000 (0.002) loss 1.6086 (1.6842) ce_loss 1.2979 (1.5003) teacher_loss 0.8788 (1.0323) loss_zs_kd 0.4354 (0.3991) loss_oracle 0.5121 (0.4523) acc 56.2500 (47.0496) kd_loss 0.8922 (0.9696) lr 1.7705e-03 eta 0:22:27
epoch [13/50] batch [360/428] time 0.070 (0.084) data 0.000 (0.002) loss 1.8035 (1.6845) ce_loss 1.7314 (1.5002) teacher_loss 1.0625 (1.0297) loss_zs_kd 0.3504 (0.3985) loss_oracle 0.5657 (0.4555) acc 40.6250 (46.9271) kd_loss 0.8648 (0.9640) lr 1.7705e-03 eta 0:22:16
epoch [13/50] batch [380/428] time 0.085 (0.084) data 0.000 (0.002) loss 1.8034 (1.6858) ce_loss 1.5449 (1.5006) teacher_loss 1.0069 (1.0281) loss_zs_kd 0.4116 (0.3992) loss_oracle 0.5906 (0.4580) acc 50.0000 (46.9161) kd_loss 0.8898 (0.9593) lr 1.7705e-03 eta 0:22:07
epoch [13/50] batch [400/428] time 0.085 (0.084) data 0.000 (0.001) loss 1.8556 (1.6824) ce_loss 1.6357 (1.4983) teacher_loss 1.1307 (1.0245) loss_zs_kd 0.3859 (0.3980) loss_oracle 0.5320 (0.4589) acc 43.7500 (46.9766) kd_loss 0.9033 (0.9537) lr 1.7705e-03 eta 0:22:05
epoch [13/50] batch [420/428] time 0.080 (0.084) data 0.000 (0.001) loss 1.7809 (1.6828) ce_loss 1.6328 (1.4987) teacher_loss 1.0701 (1.0222) loss_zs_kd 0.3461 (0.3982) loss_oracle 0.5378 (0.4615) acc 31.2500 (46.9494) kd_loss 0.8294 (0.9486) lr 1.7705e-03 eta 0:22:04
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,538
* accuracy: 43.2%
* error: 56.8%
* macro_f1: 32.0%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,735
* accuracy: 57.7%
* error: 42.3%
* macro_f1: 28.6%
******* Domain 1 best val acc:      50.3%, epoch: 5 *******
******* Domain 1 best val test acc: 51.7%, epoch: 5 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [14/50] batch [20/428] time 0.072 (0.121) data 0.000 (0.034) loss 1.8239 (1.7505) ce_loss 1.3320 (1.5587) teacher_loss 1.0444 (1.0197) loss_zs_kd 0.4304 (0.4088) loss_oracle 0.5642 (0.5264) acc 59.3750 (44.8438) kd_loss 0.8626 (0.8609) lr 1.7290e-03 eta 0:31:55
epoch [14/50] batch [40/428] time 0.089 (0.102) data 0.000 (0.017) loss 1.7912 (1.6879) ce_loss 1.6787 (1.4795) teacher_loss 1.1553 (0.9731) loss_zs_kd 0.4519 (0.3967) loss_oracle 0.4100 (0.5165) acc 40.6250 (47.6562) kd_loss 0.7685 (0.8665) lr 1.7290e-03 eta 0:26:53
epoch [14/50] batch [60/428] time 0.093 (0.096) data 0.001 (0.011) loss 1.5330 (1.6704) ce_loss 1.2812 (1.4718) teacher_loss 0.7425 (0.9577) loss_zs_kd 0.3699 (0.3949) loss_oracle 0.6055 (0.5152) acc 56.2500 (47.2396) kd_loss 0.8388 (0.8639) lr 1.7290e-03 eta 0:25:11
epoch [14/50] batch [80/428] time 0.082 (0.093) data 0.000 (0.009) loss 1.3608 (1.6675) ce_loss 0.9937 (1.4749) teacher_loss 0.6855 (0.9533) loss_zs_kd 0.3489 (0.4010) loss_oracle 0.5009 (0.5138) acc 75.0000 (47.6172) kd_loss 0.8406 (0.8661) lr 1.7290e-03 eta 0:24:21
epoch [14/50] batch [100/428] time 0.077 (0.091) data 0.000 (0.007) loss 1.7359 (1.6674) ce_loss 1.6436 (1.4733) teacher_loss 1.0111 (0.9480) loss_zs_kd 0.4055 (0.4090) loss_oracle 0.5220 (0.5149) acc 37.5000 (47.7500) kd_loss 0.9433 (0.8746) lr 1.7290e-03 eta 0:23:51
epoch [14/50] batch [120/428] time 0.087 (0.090) data 0.000 (0.006) loss 1.5604 (1.6651) ce_loss 1.2334 (1.4680) teacher_loss 0.7121 (0.9415) loss_zs_kd 0.4947 (0.4201) loss_oracle 0.6010 (0.5136) acc 46.8750 (47.8646) kd_loss 1.0566 (0.8840) lr 1.7290e-03 eta 0:23:34
epoch [14/50] batch [140/428] time 0.093 (0.089) data 0.000 (0.005) loss 1.5479 (1.6665) ce_loss 1.3340 (1.4652) teacher_loss 0.8435 (0.9471) loss_zs_kd 0.4561 (0.4200) loss_oracle 0.4764 (0.5094) acc 53.1250 (47.8125) kd_loss 0.8337 (0.8861) lr 1.7290e-03 eta 0:23:23
epoch [14/50] batch [160/428] time 0.084 (0.089) data 0.000 (0.004) loss 1.5316 (1.6652) ce_loss 1.2021 (1.4545) teacher_loss 0.8446 (0.9414) loss_zs_kd 0.4937 (0.4267) loss_oracle 0.4401 (0.5105) acc 53.1250 (48.0078) kd_loss 0.9235 (0.8924) lr 1.7290e-03 eta 0:23:14
epoch [14/50] batch [180/428] time 0.078 (0.088) data 0.000 (0.004) loss 1.8331 (1.6699) ce_loss 1.4219 (1.4516) teacher_loss 0.9679 (0.9424) loss_zs_kd 0.4563 (0.4335) loss_oracle 0.6371 (0.5108) acc 53.1250 (48.1597) kd_loss 1.0137 (0.8983) lr 1.7290e-03 eta 0:23:04
epoch [14/50] batch [200/428] time 0.089 (0.088) data 0.000 (0.004) loss 1.6644 (1.6811) ce_loss 1.5596 (1.4471) teacher_loss 0.8779 (0.9447) loss_zs_kd 0.4932 (0.4389) loss_oracle 0.5399 (0.5169) acc 34.3750 (48.4219) kd_loss 0.9491 (0.9050) lr 1.7290e-03 eta 0:22:52
epoch [14/50] batch [220/428] time 0.084 (0.088) data 0.000 (0.003) loss 1.7994 (1.6908) ce_loss 1.5049 (1.4486) teacher_loss 1.0120 (0.9493) loss_zs_kd 0.4781 (0.4433) loss_oracle 0.5484 (0.5199) acc 53.1250 (48.2386) kd_loss 0.8635 (0.9040) lr 1.7290e-03 eta 0:22:49
epoch [14/50] batch [240/428] time 0.086 (0.088) data 0.000 (0.003) loss 1.4544 (1.6936) ce_loss 1.1230 (1.4399) teacher_loss 0.7116 (0.9461) loss_zs_kd 0.4170 (0.4461) loss_oracle 0.5343 (0.5244) acc 59.3750 (48.4245) kd_loss 0.8828 (0.9049) lr 1.7290e-03 eta 0:22:45
epoch [14/50] batch [260/428] time 0.084 (0.087) data 0.000 (0.003) loss 1.6625 (1.6950) ce_loss 1.1104 (1.4360) teacher_loss 0.8636 (0.9436) loss_zs_kd 0.4415 (0.4475) loss_oracle 0.5781 (0.5276) acc 65.6250 (48.4375) kd_loss 0.9144 (0.9075) lr 1.7290e-03 eta 0:22:40
epoch [14/50] batch [280/428] time 0.085 (0.087) data 0.000 (0.003) loss 1.6080 (1.6927) ce_loss 1.3027 (1.4314) teacher_loss 0.8187 (0.9358) loss_zs_kd 0.4902 (0.4522) loss_oracle 0.5442 (0.5308) acc 56.2500 (48.4152) kd_loss 0.9150 (0.9105) lr 1.7290e-03 eta 0:22:35
epoch [14/50] batch [300/428] time 0.084 (0.087) data 0.000 (0.003) loss 1.8305 (1.6989) ce_loss 1.3408 (1.4315) teacher_loss 0.9466 (0.9363) loss_zs_kd 0.5497 (0.4541) loss_oracle 0.6091 (0.5355) acc 43.7500 (48.2396) kd_loss 0.9181 (0.9107) lr 1.7290e-03 eta 0:22:31
epoch [14/50] batch [320/428] time 0.080 (0.087) data 0.000 (0.002) loss 1.6301 (1.7036) ce_loss 1.1963 (1.4345) teacher_loss 0.7764 (0.9375) loss_zs_kd 0.4142 (0.4543) loss_oracle 0.6466 (0.5389) acc 59.3750 (47.9980) kd_loss 1.0109 (0.9111) lr 1.7290e-03 eta 0:22:27
epoch [14/50] batch [340/428] time 0.092 (0.087) data 0.000 (0.002) loss 1.5756 (1.7072) ce_loss 1.2500 (1.4311) teacher_loss 0.7625 (0.9344) loss_zs_kd 0.4475 (0.4581) loss_oracle 0.5894 (0.5437) acc 53.1250 (48.0147) kd_loss 0.9102 (0.9124) lr 1.7290e-03 eta 0:22:26
epoch [14/50] batch [360/428] time 0.084 (0.087) data 0.000 (0.002) loss 1.8311 (1.7108) ce_loss 1.4639 (1.4315) teacher_loss 1.0148 (0.9348) loss_zs_kd 0.4358 (0.4583) loss_oracle 0.5983 (0.5468) acc 50.0000 (47.8993) kd_loss 0.8925 (0.9116) lr 1.7290e-03 eta 0:22:23
epoch [14/50] batch [380/428] time 0.086 (0.087) data 0.000 (0.002) loss 1.9609 (1.7130) ce_loss 1.8350 (1.4303) teacher_loss 1.1476 (0.9329) loss_zs_kd 0.4631 (0.4594) loss_oracle 0.5818 (0.5504) acc 28.1250 (47.9934) kd_loss 0.8581 (0.9090) lr 1.7290e-03 eta 0:22:19
epoch [14/50] batch [400/428] time 0.078 (0.087) data 0.000 (0.002) loss 1.9371 (1.7151) ce_loss 1.4580 (1.4312) teacher_loss 1.0789 (0.9326) loss_zs_kd 0.4840 (0.4585) loss_oracle 0.6162 (0.5532) acc 50.0000 (47.8594) kd_loss 0.8650 (0.9079) lr 1.7290e-03 eta 0:22:16
epoch [14/50] batch [420/428] time 0.082 (0.086) data 0.000 (0.002) loss 1.9435 (1.7196) ce_loss 1.7646 (1.4351) teacher_loss 1.1492 (0.9338) loss_zs_kd 0.5374 (0.4597) loss_oracle 0.5256 (0.5559) acc 37.5000 (47.6414) kd_loss 0.7303 (0.9051) lr 1.7290e-03 eta 0:22:08
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,726
* accuracy: 46.4%
* error: 53.6%
* macro_f1: 35.4%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,674
* accuracy: 56.4%
* error: 43.6%
* macro_f1: 28.9%
******* Domain 1 best val acc:      50.3%, epoch: 5 *******
******* Domain 1 best val test acc: 51.7%, epoch: 5 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [15/50] batch [20/428] time 0.087 (0.120) data 0.000 (0.033) loss 1.5309 (1.7211) ce_loss 1.3574 (1.3918) teacher_loss 0.7125 (0.8693) loss_zs_kd 0.4337 (0.4659) loss_oracle 0.6015 (0.6189) acc 46.8750 (49.2188) kd_loss 0.8089 (0.8426) lr 1.6845e-03 eta 0:30:42
epoch [15/50] batch [40/428] time 0.081 (0.102) data 0.000 (0.017) loss 1.8315 (1.7188) ce_loss 1.2061 (1.4338) teacher_loss 0.9517 (0.8777) loss_zs_kd 0.5270 (0.4621) loss_oracle 0.6164 (0.6101) acc 62.5000 (47.6562) kd_loss 0.7677 (0.8463) lr 1.6845e-03 eta 0:26:08
epoch [15/50] batch [60/428] time 0.064 (0.095) data 0.000 (0.011) loss 1.8291 (1.7353) ce_loss 1.6592 (1.4585) teacher_loss 0.9653 (0.8980) loss_zs_kd 0.5423 (0.4623) loss_oracle 0.5927 (0.6062) acc 34.3750 (45.6250) kd_loss 0.8163 (0.8445) lr 1.6845e-03 eta 0:24:11
epoch [15/50] batch [80/428] time 0.088 (0.090) data 0.000 (0.009) loss 1.9391 (1.7326) ce_loss 1.6455 (1.4409) teacher_loss 1.0792 (0.8956) loss_zs_kd 0.4605 (0.4612) loss_oracle 0.6296 (0.6064) acc 40.6250 (46.7188) kd_loss 0.7859 (0.8392) lr 1.6845e-03 eta 0:23:00
epoch [15/50] batch [100/428] time 0.078 (0.089) data 0.000 (0.007) loss 1.9196 (1.7358) ce_loss 1.5469 (1.4389) teacher_loss 1.0385 (0.9000) loss_zs_kd 0.5532 (0.4627) loss_oracle 0.6046 (0.6044) acc 37.5000 (47.3125) kd_loss 0.8292 (0.8304) lr 1.6845e-03 eta 0:22:42
epoch [15/50] batch [120/428] time 0.076 (0.087) data 0.000 (0.006) loss 1.9291 (1.7368) ce_loss 1.4102 (1.4338) teacher_loss 1.1909 (0.9048) loss_zs_kd 0.3865 (0.4615) loss_oracle 0.5449 (0.6012) acc 37.5000 (47.5260) kd_loss 0.6982 (0.8235) lr 1.6845e-03 eta 0:22:12
epoch [15/50] batch [140/428] time 0.076 (0.086) data 0.000 (0.005) loss 1.8639 (1.7331) ce_loss 1.4883 (1.4364) teacher_loss 1.0059 (0.9071) loss_zs_kd 0.4697 (0.4568) loss_oracle 0.6232 (0.5976) acc 53.1250 (47.4330) kd_loss 0.7676 (0.8193) lr 1.6845e-03 eta 0:21:47
epoch [15/50] batch [160/428] time 0.081 (0.085) data 0.000 (0.004) loss 1.6983 (1.7344) ce_loss 1.4746 (1.4368) teacher_loss 0.8902 (0.9080) loss_zs_kd 0.4663 (0.4577) loss_oracle 0.5749 (0.5975) acc 53.1250 (47.5195) kd_loss 0.8231 (0.8156) lr 1.6845e-03 eta 0:21:38
epoch [15/50] batch [180/428] time 0.084 (0.085) data 0.000 (0.004) loss 1.7842 (1.7328) ce_loss 1.7471 (1.4360) teacher_loss 1.0439 (0.9100) loss_zs_kd 0.4683 (0.4568) loss_oracle 0.5062 (0.5944) acc 31.2500 (47.6215) kd_loss 0.7881 (0.8107) lr 1.6845e-03 eta 0:21:28
epoch [15/50] batch [200/428] time 0.087 (0.085) data 0.000 (0.004) loss 1.4139 (1.7268) ce_loss 1.2285 (1.4344) teacher_loss 0.6615 (0.9083) loss_zs_kd 0.4703 (0.4554) loss_oracle 0.5172 (0.5908) acc 53.1250 (47.7656) kd_loss 0.7859 (0.8086) lr 1.6845e-03 eta 0:21:28
epoch [15/50] batch [220/428] time 0.082 (0.085) data 0.000 (0.003) loss 1.8338 (1.7262) ce_loss 1.5215 (1.4335) teacher_loss 1.0554 (0.9095) loss_zs_kd 0.4599 (0.4565) loss_oracle 0.5485 (0.5884) acc 50.0000 (47.8835) kd_loss 0.7672 (0.8054) lr 1.6845e-03 eta 0:21:25
epoch [15/50] batch [240/428] time 0.082 (0.085) data 0.000 (0.003) loss 1.7120 (1.7226) ce_loss 1.6113 (1.4286) teacher_loss 0.8536 (0.9080) loss_zs_kd 0.4968 (0.4567) loss_oracle 0.6100 (0.5863) acc 37.5000 (48.1250) kd_loss 0.8069 (0.8021) lr 1.6845e-03 eta 0:21:23
epoch [15/50] batch [260/428] time 0.081 (0.085) data 0.000 (0.003) loss 1.7508 (1.7198) ce_loss 1.6094 (1.4247) teacher_loss 0.9393 (0.9062) loss_zs_kd 0.5274 (0.4562) loss_oracle 0.5478 (0.5855) acc 37.5000 (48.1611) kd_loss 0.7940 (0.7994) lr 1.6845e-03 eta 0:21:23
epoch [15/50] batch [280/428] time 0.083 (0.085) data 0.000 (0.003) loss 1.8437 (1.7169) ce_loss 1.4336 (1.4209) teacher_loss 1.0469 (0.9049) loss_zs_kd 0.4821 (0.4571) loss_oracle 0.5558 (0.5834) acc 56.2500 (48.3371) kd_loss 0.7601 (0.7975) lr 1.6845e-03 eta 0:21:19
epoch [15/50] batch [300/428] time 0.084 (0.085) data 0.000 (0.002) loss 1.6614 (1.7132) ce_loss 1.5010 (1.4176) teacher_loss 0.9673 (0.9030) loss_zs_kd 0.3808 (0.4572) loss_oracle 0.5037 (0.5816) acc 43.7500 (48.2812) kd_loss 0.7718 (0.7960) lr 1.6845e-03 eta 0:21:18
epoch [15/50] batch [320/428] time 0.085 (0.085) data 0.000 (0.002) loss 2.0321 (1.7142) ce_loss 1.7617 (1.4194) teacher_loss 1.2483 (0.9061) loss_zs_kd 0.4923 (0.4574) loss_oracle 0.5377 (0.5794) acc 37.5000 (48.1152) kd_loss 0.6418 (0.7928) lr 1.6845e-03 eta 0:21:17
epoch [15/50] batch [340/428] time 0.086 (0.085) data 0.000 (0.002) loss 1.6391 (1.7161) ce_loss 1.3115 (1.4216) teacher_loss 0.8962 (0.9088) loss_zs_kd 0.4305 (0.4589) loss_oracle 0.5276 (0.5779) acc 46.8750 (48.0147) kd_loss 0.7630 (0.7909) lr 1.6845e-03 eta 0:21:16
epoch [15/50] batch [360/428] time 0.071 (0.084) data 0.000 (0.002) loss 1.8198 (1.7160) ce_loss 1.5986 (1.4235) teacher_loss 1.0183 (0.9098) loss_zs_kd 0.4660 (0.4597) loss_oracle 0.5685 (0.5763) acc 40.6250 (47.9340) kd_loss 0.7589 (0.7886) lr 1.6845e-03 eta 0:21:03
epoch [15/50] batch [380/428] time 0.076 (0.083) data 0.000 (0.002) loss 1.7850 (1.7140) ce_loss 1.5488 (1.4217) teacher_loss 0.9875 (0.9091) loss_zs_kd 0.4764 (0.4600) loss_oracle 0.5593 (0.5749) acc 40.6250 (47.9770) kd_loss 0.8032 (0.7875) lr 1.6845e-03 eta 0:20:53
epoch [15/50] batch [400/428] time 0.089 (0.083) data 0.000 (0.002) loss 1.8341 (1.7123) ce_loss 1.5146 (1.4206) teacher_loss 1.0850 (0.9094) loss_zs_kd 0.4483 (0.4592) loss_oracle 0.5249 (0.5733) acc 46.8750 (48.0312) kd_loss 0.6806 (0.7851) lr 1.6845e-03 eta 0:20:52
epoch [15/50] batch [420/428] time 0.082 (0.083) data 0.000 (0.002) loss 1.6600 (1.7108) ce_loss 1.2480 (1.4191) teacher_loss 0.9800 (0.9107) loss_zs_kd 0.3767 (0.4573) loss_oracle 0.4917 (0.5714) acc 53.1250 (48.0804) kd_loss 0.7128 (0.7836) lr 1.6845e-03 eta 0:20:50
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,799
* accuracy: 47.6%
* error: 52.4%
* macro_f1: 33.4%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,502
* accuracy: 52.8%
* error: 47.2%
* macro_f1: 28.6%
******* Domain 1 best val acc:      50.3%, epoch: 5 *******
******* Domain 1 best val test acc: 51.7%, epoch: 5 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [16/50] batch [20/428] time 0.075 (0.098) data 0.000 (0.026) loss 1.8956 (1.6958) ce_loss 1.9873 (1.4168) teacher_loss 1.1618 (0.9370) loss_zs_kd 0.5004 (0.4579) loss_oracle 0.4836 (0.5298) acc 28.1250 (47.1875) kd_loss 0.7681 (0.7492) lr 1.6374e-03 eta 0:24:23
epoch [16/50] batch [40/428] time 0.081 (0.089) data 0.000 (0.013) loss 1.6402 (1.6966) ce_loss 1.4443 (1.4194) teacher_loss 0.8556 (0.9341) loss_zs_kd 0.4208 (0.4581) loss_oracle 0.5742 (0.5334) acc 43.7500 (47.3438) kd_loss 0.7355 (0.7404) lr 1.6374e-03 eta 0:22:15
epoch [16/50] batch [60/428] time 0.089 (0.088) data 0.000 (0.009) loss 1.8282 (1.6953) ce_loss 1.6387 (1.4318) teacher_loss 1.0591 (0.9291) loss_zs_kd 0.4830 (0.4597) loss_oracle 0.5276 (0.5364) acc 43.7500 (46.8229) kd_loss 0.7564 (0.7500) lr 1.6374e-03 eta 0:21:55
epoch [16/50] batch [80/428] time 0.087 (0.087) data 0.000 (0.007) loss 1.5286 (1.6862) ce_loss 1.3301 (1.4116) teacher_loss 0.7939 (0.9110) loss_zs_kd 0.4222 (0.4751) loss_oracle 0.5236 (0.5377) acc 46.8750 (47.6562) kd_loss 0.8312 (0.7571) lr 1.6374e-03 eta 0:21:38
epoch [16/50] batch [100/428] time 0.080 (0.086) data 0.000 (0.005) loss 1.9697 (1.6844) ce_loss 1.5664 (1.4056) teacher_loss 1.0950 (0.9084) loss_zs_kd 0.5578 (0.4724) loss_oracle 0.5958 (0.5398) acc 53.1250 (48.0000) kd_loss 0.6912 (0.7563) lr 1.6374e-03 eta 0:21:24
epoch [16/50] batch [120/428] time 0.089 (0.085) data 0.000 (0.005) loss 1.7228 (1.6857) ce_loss 1.3467 (1.4109) teacher_loss 0.9987 (0.9161) loss_zs_kd 0.4281 (0.4676) loss_oracle 0.5100 (0.5359) acc 50.0000 (47.7344) kd_loss 0.7820 (0.7551) lr 1.6374e-03 eta 0:21:04
epoch [16/50] batch [140/428] time 0.083 (0.085) data 0.000 (0.004) loss 1.4692 (1.6739) ce_loss 1.2529 (1.3965) teacher_loss 0.6937 (0.9074) loss_zs_kd 0.5541 (0.4679) loss_oracle 0.4985 (0.5327) acc 50.0000 (48.4821) kd_loss 0.6284 (0.7556) lr 1.6374e-03 eta 0:21:04
epoch [16/50] batch [160/428] time 0.079 (0.085) data 0.000 (0.004) loss 1.6358 (1.6720) ce_loss 1.2686 (1.3892) teacher_loss 0.9352 (0.9066) loss_zs_kd 0.4537 (0.4692) loss_oracle 0.4738 (0.5308) acc 53.1250 (48.8867) kd_loss 0.7449 (0.7532) lr 1.6374e-03 eta 0:21:05
epoch [16/50] batch [180/428] time 0.078 (0.085) data 0.000 (0.003) loss 1.5146 (1.6703) ce_loss 1.3584 (1.3902) teacher_loss 0.7059 (0.9045) loss_zs_kd 0.4950 (0.4677) loss_oracle 0.5612 (0.5320) acc 50.0000 (48.7847) kd_loss 0.7906 (0.7529) lr 1.6374e-03 eta 0:21:00
epoch [16/50] batch [200/428] time 0.076 (0.085) data 0.000 (0.003) loss 1.3532 (1.6761) ce_loss 1.0889 (1.3983) teacher_loss 0.5949 (0.9111) loss_zs_kd 0.4612 (0.4673) loss_oracle 0.5277 (0.5314) acc 56.2500 (48.3594) kd_loss 0.7695 (0.7520) lr 1.6374e-03 eta 0:20:55
epoch [16/50] batch [220/428] time 0.077 (0.084) data 0.000 (0.003) loss 1.5553 (1.6783) ce_loss 1.2910 (1.3992) teacher_loss 0.7969 (0.9142) loss_zs_kd 0.4417 (0.4651) loss_oracle 0.5376 (0.5316) acc 56.2500 (48.2812) kd_loss 0.7290 (0.7507) lr 1.6374e-03 eta 0:20:44
epoch [16/50] batch [240/428] time 0.070 (0.084) data 0.000 (0.002) loss 1.6533 (1.6764) ce_loss 1.3037 (1.3948) teacher_loss 0.9418 (0.9139) loss_zs_kd 0.4228 (0.4635) loss_oracle 0.5002 (0.5308) acc 46.8750 (48.5286) kd_loss 0.5779 (0.7490) lr 1.6374e-03 eta 0:20:36
epoch [16/50] batch [260/428] time 0.081 (0.084) data 0.000 (0.002) loss 1.8111 (1.6784) ce_loss 1.5518 (1.3952) teacher_loss 1.1269 (0.9168) loss_zs_kd 0.3818 (0.4625) loss_oracle 0.4934 (0.5303) acc 28.1250 (48.5817) kd_loss 0.7040 (0.7492) lr 1.6374e-03 eta 0:20:31
epoch [16/50] batch [280/428] time 0.091 (0.084) data 0.000 (0.002) loss 1.9053 (1.6810) ce_loss 1.7500 (1.3953) teacher_loss 1.1576 (0.9214) loss_zs_kd 0.4679 (0.4616) loss_oracle 0.5137 (0.5287) acc 28.1250 (48.5938) kd_loss 0.8498 (0.7482) lr 1.6374e-03 eta 0:20:28
epoch [16/50] batch [300/428] time 0.079 (0.084) data 0.000 (0.002) loss 1.7644 (1.6812) ce_loss 1.4014 (1.3916) teacher_loss 1.0961 (0.9236) loss_zs_kd 0.4234 (0.4615) loss_oracle 0.4567 (0.5268) acc 50.0000 (48.8021) kd_loss 0.7686 (0.7475) lr 1.6374e-03 eta 0:20:29
epoch [16/50] batch [320/428] time 0.089 (0.084) data 0.000 (0.002) loss 1.8325 (1.6836) ce_loss 1.4512 (1.3934) teacher_loss 1.0806 (0.9287) loss_zs_kd 0.4431 (0.4593) loss_oracle 0.5303 (0.5253) acc 46.8750 (48.7891) kd_loss 0.7277 (0.7487) lr 1.6374e-03 eta 0:20:30
epoch [16/50] batch [340/428] time 0.085 (0.084) data 0.000 (0.002) loss 1.7045 (1.6816) ce_loss 1.2109 (1.3914) teacher_loss 0.9651 (0.9278) loss_zs_kd 0.4644 (0.4578) loss_oracle 0.5071 (0.5249) acc 62.5000 (48.7684) kd_loss 0.6875 (0.7492) lr 1.6374e-03 eta 0:20:30
epoch [16/50] batch [360/428] time 0.086 (0.084) data 0.000 (0.002) loss 1.7953 (1.6834) ce_loss 1.4199 (1.3884) teacher_loss 1.0466 (0.9310) loss_zs_kd 0.4795 (0.4551) loss_oracle 0.5089 (0.5249) acc 56.2500 (49.0365) kd_loss 0.7628 (0.7493) lr 1.6374e-03 eta 0:20:28
epoch [16/50] batch [380/428] time 0.084 (0.084) data 0.000 (0.002) loss 1.6505 (1.6843) ce_loss 1.3828 (1.3890) teacher_loss 0.8574 (0.9327) loss_zs_kd 0.4578 (0.4541) loss_oracle 0.5642 (0.5245) acc 50.0000 (48.9638) kd_loss 0.8140 (0.7517) lr 1.6374e-03 eta 0:20:28
epoch [16/50] batch [400/428] time 0.082 (0.084) data 0.000 (0.002) loss 1.7446 (1.6847) ce_loss 1.3613 (1.3865) teacher_loss 0.9512 (0.9336) loss_zs_kd 0.4306 (0.4533) loss_oracle 0.5781 (0.5245) acc 50.0000 (49.0703) kd_loss 0.9078 (0.7535) lr 1.6374e-03 eta 0:20:27
epoch [16/50] batch [420/428] time 0.079 (0.084) data 0.000 (0.002) loss 1.7196 (1.6875) ce_loss 1.3193 (1.3875) teacher_loss 0.9110 (0.9367) loss_zs_kd 0.5407 (0.4525) loss_oracle 0.5382 (0.5246) acc 56.2500 (49.0327) kd_loss 0.8252 (0.7557) lr 1.6374e-03 eta 0:20:25
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,898
* accuracy: 49.3%
* error: 50.7%
* macro_f1: 37.4%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,707
* accuracy: 57.1%
* error: 42.9%
* macro_f1: 32.8%
******* Domain 1 best val acc:      50.3%, epoch: 5 *******
******* Domain 1 best val test acc: 51.7%, epoch: 5 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [17/50] batch [20/428] time 0.082 (0.114) data 0.000 (0.027) loss 1.5582 (1.6871) ce_loss 1.2803 (1.3281) teacher_loss 0.7822 (0.9388) loss_zs_kd 0.4825 (0.4427) loss_oracle 0.5347 (0.5270) acc 56.2500 (50.0000) kd_loss 0.8085 (0.7981) lr 1.5878e-03 eta 0:27:30
epoch [17/50] batch [40/428] time 0.090 (0.099) data 0.000 (0.014) loss 1.6218 (1.7079) ce_loss 1.2568 (1.3540) teacher_loss 0.9754 (0.9550) loss_zs_kd 0.4203 (0.4368) loss_oracle 0.4363 (0.5345) acc 56.2500 (49.4531) kd_loss 0.7158 (0.8053) lr 1.5878e-03 eta 0:23:52
epoch [17/50] batch [60/428] time 0.072 (0.092) data 0.000 (0.009) loss 1.7354 (1.6966) ce_loss 1.3389 (1.3496) teacher_loss 0.9493 (0.9450) loss_zs_kd 0.4119 (0.4263) loss_oracle 0.5802 (0.5385) acc 50.0000 (49.2708) kd_loss 0.8652 (0.8126) lr 1.5878e-03 eta 0:22:16
epoch [17/50] batch [80/428] time 0.079 (0.089) data 0.000 (0.007) loss 1.6585 (1.6956) ce_loss 1.3945 (1.3547) teacher_loss 1.0159 (0.9462) loss_zs_kd 0.3798 (0.4267) loss_oracle 0.4527 (0.5360) acc 43.7500 (49.6094) kd_loss 0.7300 (0.8073) lr 1.5878e-03 eta 0:21:21
epoch [17/50] batch [100/428] time 0.075 (0.087) data 0.000 (0.006) loss 1.5789 (1.6905) ce_loss 1.3184 (1.3547) teacher_loss 0.7847 (0.9404) loss_zs_kd 0.4777 (0.4303) loss_oracle 0.5553 (0.5349) acc 50.0000 (49.6875) kd_loss 0.8435 (0.8070) lr 1.5878e-03 eta 0:20:53
epoch [17/50] batch [120/428] time 0.081 (0.086) data 0.001 (0.005) loss 1.8106 (1.6918) ce_loss 1.5771 (1.3719) teacher_loss 1.0314 (0.9411) loss_zs_kd 0.4814 (0.4337) loss_oracle 0.5385 (0.5338) acc 34.3750 (49.2969) kd_loss 0.8722 (0.8080) lr 1.5878e-03 eta 0:20:38
epoch [17/50] batch [140/428] time 0.084 (0.085) data 0.000 (0.004) loss 1.6359 (1.6800) ce_loss 1.5566 (1.3704) teacher_loss 0.8344 (0.9316) loss_zs_kd 0.4943 (0.4317) loss_oracle 0.5544 (0.5326) acc 40.6250 (49.4866) kd_loss 0.8184 (0.8052) lr 1.5878e-03 eta 0:20:29
epoch [17/50] batch [160/428] time 0.083 (0.085) data 0.000 (0.004) loss 2.0214 (1.6819) ce_loss 1.7197 (1.3746) teacher_loss 1.2790 (0.9326) loss_zs_kd 0.5081 (0.4349) loss_oracle 0.4883 (0.5319) acc 34.3750 (49.4336) kd_loss 0.7311 (0.8029) lr 1.5878e-03 eta 0:20:20
epoch [17/50] batch [180/428] time 0.090 (0.085) data 0.000 (0.003) loss 1.6482 (1.6861) ce_loss 1.5869 (1.3845) teacher_loss 0.9023 (0.9332) loss_zs_kd 0.4100 (0.4390) loss_oracle 0.5409 (0.5334) acc 37.5000 (48.9236) kd_loss 0.8463 (0.7976) lr 1.5878e-03 eta 0:20:20
epoch [17/50] batch [200/428] time 0.076 (0.085) data 0.000 (0.003) loss 1.4205 (1.6829) ce_loss 1.1719 (1.3827) teacher_loss 0.6573 (0.9292) loss_zs_kd 0.4544 (0.4422) loss_oracle 0.5360 (0.5326) acc 59.3750 (48.8906) kd_loss 0.7146 (0.7916) lr 1.5878e-03 eta 0:20:13
epoch [17/50] batch [220/428] time 0.086 (0.084) data 0.000 (0.003) loss 1.7444 (1.6811) ce_loss 1.4492 (1.3834) teacher_loss 0.9332 (0.9251) loss_zs_kd 0.4592 (0.4428) loss_oracle 0.5817 (0.5346) acc 50.0000 (48.9347) kd_loss 0.8438 (0.7870) lr 1.5878e-03 eta 0:20:10
epoch [17/50] batch [240/428] time 0.085 (0.085) data 0.000 (0.002) loss 1.5951 (1.6814) ce_loss 1.3008 (1.3879) teacher_loss 0.8237 (0.9276) loss_zs_kd 0.4909 (0.4405) loss_oracle 0.5260 (0.5336) acc 56.2500 (48.7370) kd_loss 0.7651 (0.7828) lr 1.5878e-03 eta 0:20:10
epoch [17/50] batch [260/428] time 0.077 (0.084) data 0.000 (0.002) loss 1.7925 (1.6824) ce_loss 1.4990 (1.3934) teacher_loss 0.9919 (0.9291) loss_zs_kd 0.4530 (0.4396) loss_oracle 0.5740 (0.5335) acc 40.6250 (48.5457) kd_loss 0.7503 (0.7793) lr 1.5878e-03 eta 0:20:01
epoch [17/50] batch [280/428] time 0.080 (0.084) data 0.000 (0.002) loss 1.7006 (1.6839) ce_loss 1.4473 (1.3976) teacher_loss 0.9420 (0.9300) loss_zs_kd 0.4612 (0.4402) loss_oracle 0.5280 (0.5338) acc 40.6250 (48.3705) kd_loss 0.8067 (0.7764) lr 1.5878e-03 eta 0:19:54
epoch [17/50] batch [300/428] time 0.081 (0.084) data 0.000 (0.002) loss 1.6882 (1.6822) ce_loss 1.3555 (1.3977) teacher_loss 0.8075 (0.9281) loss_zs_kd 0.5520 (0.4406) loss_oracle 0.6048 (0.5338) acc 43.7500 (48.3438) kd_loss 0.7626 (0.7734) lr 1.5878e-03 eta 0:19:51
epoch [17/50] batch [320/428] time 0.091 (0.084) data 0.001 (0.002) loss 1.8366 (1.6782) ce_loss 1.6260 (1.3929) teacher_loss 1.0976 (0.9248) loss_zs_kd 0.4439 (0.4409) loss_oracle 0.5170 (0.5330) acc 43.7500 (48.6523) kd_loss 0.6796 (0.7695) lr 1.5878e-03 eta 0:19:52
epoch [17/50] batch [340/428] time 0.083 (0.084) data 0.000 (0.002) loss 1.5049 (1.6792) ce_loss 1.1719 (1.3931) teacher_loss 0.7728 (0.9273) loss_zs_kd 0.4247 (0.4394) loss_oracle 0.5198 (0.5323) acc 62.5000 (48.4926) kd_loss 0.7258 (0.7647) lr 1.5878e-03 eta 0:19:51
epoch [17/50] batch [360/428] time 0.080 (0.084) data 0.000 (0.002) loss 1.7455 (1.6819) ce_loss 1.3037 (1.3952) teacher_loss 1.0360 (0.9304) loss_zs_kd 0.3955 (0.4391) loss_oracle 0.5118 (0.5320) acc 53.1250 (48.4462) kd_loss 0.6567 (0.7619) lr 1.5878e-03 eta 0:19:49
epoch [17/50] batch [380/428] time 0.084 (0.084) data 0.000 (0.002) loss 1.5753 (1.6810) ce_loss 1.2139 (1.3955) teacher_loss 0.8199 (0.9298) loss_zs_kd 0.4413 (0.4382) loss_oracle 0.5347 (0.5321) acc 56.2500 (48.4622) kd_loss 0.7589 (0.7601) lr 1.5878e-03 eta 0:19:49
epoch [17/50] batch [400/428] time 0.081 (0.084) data 0.000 (0.002) loss 1.6899 (1.6829) ce_loss 1.4121 (1.3954) teacher_loss 0.9392 (0.9319) loss_zs_kd 0.4325 (0.4374) loss_oracle 0.5345 (0.5323) acc 56.2500 (48.5469) kd_loss 0.7927 (0.7571) lr 1.5878e-03 eta 0:19:48
epoch [17/50] batch [420/428] time 0.082 (0.084) data 0.000 (0.002) loss 1.6482 (1.6845) ce_loss 1.1709 (1.3973) teacher_loss 0.7902 (0.9335) loss_zs_kd 0.4494 (0.4373) loss_oracle 0.6333 (0.5324) acc 59.3750 (48.5193) kd_loss 0.8282 (0.7553) lr 1.5878e-03 eta 0:19:46
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,918
* accuracy: 49.7%
* error: 50.3%
* macro_f1: 37.0%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,620
* accuracy: 55.3%
* error: 44.7%
* macro_f1: 29.8%
******* Domain 1 best val acc:      50.3%, epoch: 5 *******
******* Domain 1 best val test acc: 51.7%, epoch: 5 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [18/50] batch [20/428] time 0.083 (0.106) data 0.000 (0.024) loss 1.5760 (1.5882) ce_loss 1.3018 (1.2979) teacher_loss 0.8746 (0.8198) loss_zs_kd 0.3539 (0.4488) loss_oracle 0.5245 (0.5440) acc 53.1250 (52.6562) kd_loss 0.6657 (0.6982) lr 1.5358e-03 eta 0:24:58
epoch [18/50] batch [40/428] time 0.062 (0.089) data 0.000 (0.012) loss 1.5427 (1.6332) ce_loss 1.1523 (1.3521) teacher_loss 0.8042 (0.8780) loss_zs_kd 0.4281 (0.4379) loss_oracle 0.5245 (0.5362) acc 56.2500 (50.7031) kd_loss 0.7195 (0.7093) lr 1.5358e-03 eta 0:20:48
epoch [18/50] batch [60/428] time 0.082 (0.084) data 0.001 (0.008) loss 1.8823 (1.6394) ce_loss 1.7988 (1.3528) teacher_loss 1.1512 (0.8858) loss_zs_kd 0.4657 (0.4419) loss_oracle 0.4983 (0.5326) acc 43.7500 (50.9896) kd_loss 0.7140 (0.7060) lr 1.5358e-03 eta 0:19:40
epoch [18/50] batch [80/428] time 0.076 (0.084) data 0.000 (0.006) loss 1.8803 (1.6570) ce_loss 1.8281 (1.3717) teacher_loss 1.1990 (0.9041) loss_zs_kd 0.3895 (0.4422) loss_oracle 0.4865 (0.5318) acc 46.8750 (50.0781) kd_loss 0.7313 (0.7096) lr 1.5358e-03 eta 0:19:43
epoch [18/50] batch [100/428] time 0.081 (0.084) data 0.000 (0.005) loss 1.2892 (1.6568) ce_loss 1.0234 (1.3754) teacher_loss 0.5891 (0.9102) loss_zs_kd 0.3896 (0.4351) loss_oracle 0.5052 (0.5290) acc 62.5000 (49.5312) kd_loss 0.7210 (0.7089) lr 1.5358e-03 eta 0:19:39
epoch [18/50] batch [120/428] time 0.083 (0.084) data 0.000 (0.004) loss 1.6276 (1.6561) ce_loss 1.4141 (1.3718) teacher_loss 0.9392 (0.9142) loss_zs_kd 0.3838 (0.4313) loss_oracle 0.4964 (0.5263) acc 46.8750 (49.9219) kd_loss 0.6922 (0.7083) lr 1.5358e-03 eta 0:19:32
epoch [18/50] batch [140/428] time 0.084 (0.084) data 0.000 (0.004) loss 1.4275 (1.6576) ce_loss 1.1475 (1.3743) teacher_loss 0.7620 (0.9158) loss_zs_kd 0.3902 (0.4303) loss_oracle 0.4704 (0.5266) acc 56.2500 (49.9330) kd_loss 0.7855 (0.7111) lr 1.5358e-03 eta 0:19:33
epoch [18/50] batch [160/428] time 0.094 (0.084) data 0.000 (0.003) loss 1.5769 (1.6573) ce_loss 1.4111 (1.3723) teacher_loss 0.8439 (0.9156) loss_zs_kd 0.4000 (0.4309) loss_oracle 0.5330 (0.5262) acc 50.0000 (50.3125) kd_loss 0.7440 (0.7097) lr 1.5358e-03 eta 0:19:34
epoch [18/50] batch [180/428] time 0.086 (0.084) data 0.000 (0.003) loss 1.7425 (1.6575) ce_loss 1.5088 (1.3713) teacher_loss 1.0185 (0.9141) loss_zs_kd 0.3845 (0.4309) loss_oracle 0.5317 (0.5279) acc 50.0000 (50.3993) kd_loss 0.6867 (0.7127) lr 1.5358e-03 eta 0:19:32
epoch [18/50] batch [200/428] time 0.084 (0.084) data 0.000 (0.003) loss 1.4803 (1.6510) ce_loss 1.1504 (1.3698) teacher_loss 0.7483 (0.9094) loss_zs_kd 0.3913 (0.4282) loss_oracle 0.5363 (0.5275) acc 59.3750 (50.3906) kd_loss 0.6472 (0.7154) lr 1.5358e-03 eta 0:19:30
epoch [18/50] batch [220/428] time 0.091 (0.084) data 0.000 (0.002) loss 1.8490 (1.6542) ce_loss 1.5107 (1.3735) teacher_loss 1.0299 (0.9102) loss_zs_kd 0.4712 (0.4318) loss_oracle 0.5834 (0.5281) acc 46.8750 (50.3409) kd_loss 0.7638 (0.7163) lr 1.5358e-03 eta 0:19:29
epoch [18/50] batch [240/428] time 0.083 (0.084) data 0.000 (0.002) loss 1.5152 (1.6581) ce_loss 1.3252 (1.3802) teacher_loss 0.7712 (0.9150) loss_zs_kd 0.3799 (0.4316) loss_oracle 0.5541 (0.5273) acc 56.2500 (50.0391) kd_loss 0.7624 (0.7149) lr 1.5358e-03 eta 0:19:28
epoch [18/50] batch [260/428] time 0.092 (0.085) data 0.001 (0.002) loss 2.0220 (1.6570) ce_loss 1.8252 (1.3811) teacher_loss 1.2497 (0.9131) loss_zs_kd 0.4193 (0.4305) loss_oracle 0.5627 (0.5286) acc 37.5000 (50.0120) kd_loss 0.6925 (0.7167) lr 1.5358e-03 eta 0:19:32
epoch [18/50] batch [280/428] time 0.080 (0.085) data 0.000 (0.002) loss 1.5342 (1.6508) ce_loss 1.3672 (1.3811) teacher_loss 0.7282 (0.9064) loss_zs_kd 0.4563 (0.4304) loss_oracle 0.5779 (0.5292) acc 53.1250 (50.0000) kd_loss 0.7915 (0.7193) lr 1.5358e-03 eta 0:19:31
epoch [18/50] batch [300/428] time 0.088 (0.084) data 0.000 (0.002) loss 1.5523 (1.6527) ce_loss 1.2412 (1.3835) teacher_loss 0.8428 (0.9073) loss_zs_kd 0.4670 (0.4322) loss_oracle 0.4760 (0.5293) acc 50.0000 (49.8125) kd_loss 0.7224 (0.7197) lr 1.5358e-03 eta 0:19:26
epoch [18/50] batch [320/428] time 0.082 (0.084) data 0.000 (0.002) loss 1.6569 (1.6536) ce_loss 1.3857 (1.3850) teacher_loss 0.9675 (0.9070) loss_zs_kd 0.3884 (0.4340) loss_oracle 0.4951 (0.5296) acc 56.2500 (49.6680) kd_loss 0.6413 (0.7210) lr 1.5358e-03 eta 0:19:24
epoch [18/50] batch [340/428] time 0.076 (0.084) data 0.000 (0.002) loss 1.5045 (1.6541) ce_loss 1.2295 (1.3848) teacher_loss 0.8249 (0.9076) loss_zs_kd 0.4073 (0.4353) loss_oracle 0.4759 (0.5289) acc 53.1250 (49.6599) kd_loss 0.6970 (0.7201) lr 1.5358e-03 eta 0:19:17
epoch [18/50] batch [360/428] time 0.085 (0.084) data 0.000 (0.002) loss 1.5175 (1.6519) ce_loss 1.4092 (1.3837) teacher_loss 0.8325 (0.9064) loss_zs_kd 0.3857 (0.4348) loss_oracle 0.4922 (0.5281) acc 50.0000 (49.7830) kd_loss 0.7984 (0.7221) lr 1.5358e-03 eta 0:19:13
epoch [18/50] batch [380/428] time 0.085 (0.084) data 0.000 (0.002) loss 1.7506 (1.6517) ce_loss 1.6133 (1.3849) teacher_loss 1.0299 (0.9054) loss_zs_kd 0.4068 (0.4357) loss_oracle 0.5172 (0.5284) acc 34.3750 (49.7862) kd_loss 0.7953 (0.7251) lr 1.5358e-03 eta 0:19:12
epoch [18/50] batch [400/428] time 0.087 (0.084) data 0.000 (0.001) loss 1.5098 (1.6511) ce_loss 1.2441 (1.3850) teacher_loss 0.7365 (0.9056) loss_zs_kd 0.3902 (0.4354) loss_oracle 0.5782 (0.5278) acc 53.1250 (49.6719) kd_loss 0.7608 (0.7260) lr 1.5358e-03 eta 0:19:11
epoch [18/50] batch [420/428] time 0.080 (0.084) data 0.000 (0.001) loss 1.6851 (1.6496) ce_loss 1.5762 (1.3849) teacher_loss 0.9892 (0.9050) loss_zs_kd 0.3993 (0.4346) loss_oracle 0.4963 (0.5273) acc 43.7500 (49.8214) kd_loss 0.7917 (0.7278) lr 1.5358e-03 eta 0:19:10
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,907
* accuracy: 49.5%
* error: 50.5%
* macro_f1: 37.4%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,700
* accuracy: 57.0%
* error: 43.0%
* macro_f1: 31.8%
******* Domain 1 best val acc:      50.3%, epoch: 5 *******
******* Domain 1 best val test acc: 51.7%, epoch: 5 *******
******* Domain 1 best test acc:     57.9%, epoch: 9 *******
epoch [19/50] batch [20/428] time 0.081 (0.114) data 0.000 (0.029) loss 1.5142 (1.6633) ce_loss 1.2324 (1.3740) teacher_loss 0.7032 (0.9079) loss_zs_kd 0.4834 (0.4525) loss_oracle 0.5693 (0.5291) acc 62.5000 (51.0938) kd_loss 0.8178 (0.7505) lr 1.4818e-03 eta 0:26:01
epoch [19/50] batch [40/428] time 0.081 (0.096) data 0.000 (0.015) loss 1.5285 (1.6868) ce_loss 1.3193 (1.4078) teacher_loss 0.8191 (0.9295) loss_zs_kd 0.3848 (0.4498) loss_oracle 0.5171 (0.5324) acc 46.8750 (48.4375) kd_loss 0.6700 (0.7567) lr 1.4818e-03 eta 0:21:46
epoch [19/50] batch [60/428] time 0.077 (0.090) data 0.001 (0.010) loss 1.5958 (1.6970) ce_loss 1.3203 (1.4185) teacher_loss 0.9289 (0.9440) loss_zs_kd 0.3972 (0.4518) loss_oracle 0.4683 (0.5271) acc 50.0000 (47.7083) kd_loss 0.6711 (0.7539) lr 1.4818e-03 eta 0:20:22
epoch [19/50] batch [80/428] time 0.079 (0.087) data 0.000 (0.007) loss 1.5782 (1.6765) ce_loss 1.2959 (1.3940) teacher_loss 0.8298 (0.9239) loss_zs_kd 0.4453 (0.4519) loss_oracle 0.5257 (0.5266) acc 50.0000 (48.5156) kd_loss 0.6999 (0.7541) lr 1.4818e-03 eta 0:19:38
epoch [19/50] batch [100/428] time 0.090 (0.087) data 0.000 (0.006) loss 1.7493 (1.6773) ce_loss 1.2695 (1.3940) teacher_loss 1.0498 (0.9213) loss_zs_kd 0.4466 (0.4523) loss_oracle 0.4762 (0.5299) acc 53.1250 (48.4688) kd_loss 0.6942 (0.7568) lr 1.4818e-03 eta 0:19:36
epoch [19/50] batch [120/428] time 0.077 (0.087) data 0.000 (0.005) loss 1.6518 (1.6667) ce_loss 1.4141 (1.3816) teacher_loss 0.8164 (0.9122) loss_zs_kd 0.5373 (0.4518) loss_oracle 0.5668 (0.5286) acc 43.7500 (49.0625) kd_loss 0.7684 (0.7543) lr 1.4818e-03 eta 0:19:34
epoch [19/50] batch [140/428] time 0.080 (0.085) data 0.000 (0.004) loss 1.5291 (1.6653) ce_loss 1.0615 (1.3795) teacher_loss 0.8125 (0.9127) loss_zs_kd 0.4369 (0.4526) loss_oracle 0.4981 (0.5264) acc 68.7500 (49.6429) kd_loss 0.6693 (0.7497) lr 1.4818e-03 eta 0:19:18
epoch [19/50] batch [160/428] time 0.075 (0.085) data 0.000 (0.004) loss 1.7826 (1.6614) ce_loss 1.6396 (1.3831) teacher_loss 1.0305 (0.9122) loss_zs_kd 0.4360 (0.4491) loss_oracle 0.5341 (0.5246) acc 34.3750 (49.5312) kd_loss 0.8937 (0.7500) lr 1.4818e-03 eta 0:19:16
epoch [19/50] batch [180/428] time 0.086 (0.085) data 0.000 (0.003) loss 1.4723 (1.6574) ce_loss 1.1592 (1.3792) teacher_loss 0.7831 (0.9097) loss_zs_kd 0.4246 (0.4495) loss_oracle 0.4770 (0.5230) acc 53.1250 (49.2708) kd_loss 0.6237 (0.7507) lr 1.4818e-03 eta 0:19:12
epoch [19/50] batch [200/428] time 0.085 (0.085) data 0.000 (0.003) loss 1.5138 (1.6603) ce_loss 1.1357 (1.3784) teacher_loss 0.7617 (0.9149) loss_zs_kd 0.4601 (0.4486) loss_oracle 0.5220 (0.5210) acc 56.2500 (49.4844) kd_loss 0.7640 (0.7503) lr 1.4818e-03 eta 0:19:11
epoch [19/50] batch [220/428] time 0.082 (0.085) data 0.000 (0.003) loss 1.5024 (1.6653) ce_loss 1.2197 (1.3823) teacher_loss 0.7732 (0.9220) loss_zs_kd 0.4192 (0.4462) loss_oracle 0.5196 (0.5202) acc 56.2500 (49.4460) kd_loss 0.6520 (0.7467) lr 1.4818e-03 eta 0:19:09
epoch [19/50] batch [240/428] time 0.086 (0.085) data 0.000 (0.003) loss 1.5920 (1.6613) ce_loss 1.2324 (1.3773) teacher_loss 0.8995 (0.9189) loss_zs_kd 0.4287 (0.4465) loss_oracle 0.4782 (0.5192) acc 53.1250 (49.4401) kd_loss 0.7100 (0.7447) lr 1.4818e-03 eta 0:19:08
epoch [19/50] batch [260/428] time 0.088 (0.085) data 0.000 (0.002) loss 1.7519 (1.6595) ce_loss 1.5898 (1.3747) teacher_loss 1.0161 (0.9188) loss_zs_kd 0.4630 (0.4468) loss_oracle 0.5043 (0.5173) acc 37.5000 (49.6034) kd_loss 0.7072 (0.7423) lr 1.4818e-03 eta 0:19:06
epoch [19/50] batch [280/428] time 0.083 (0.085) data 0.000 (0.002) loss 1.7068 (1.6581) ce_loss 1.4766 (1.3747) teacher_loss 0.9698 (0.9162) loss_zs_kd 0.4984 (0.4484) loss_oracle 0.4878 (0.5176) acc 40.6250 (49.4085) kd_loss 0.7572 (0.7432) lr 1.4818e-03 eta 0:19:05
epoch [19/50] batch [300/428] time 0.089 (0.085) data 0.000 (0.002) loss 1.2741 (1.6582) ce_loss 1.2207 (1.3761) teacher_loss 0.5797 (0.9170) loss_zs_kd 0.4382 (0.4493) loss_oracle 0.4753 (0.5166) acc 56.2500 (49.4792) kd_loss 0.7446 (0.7405) lr 1.4818e-03 eta 0:19:04
epoch [19/50] batch [320/428] time 0.084 (0.085) data 0.000 (0.002) loss 1.5865 (1.6585) ce_loss 1.3174 (1.3763) teacher_loss 0.8587 (0.9184) loss_zs_kd 0.4471 (0.4501) loss_oracle 0.5043 (0.5151) acc 56.2500 (49.4531) kd_loss 0.8187 (0.7385) lr 1.4818e-03 eta 0:19:01
epoch [19/50] batch [340/428] time 0.093 (0.085) data 0.000 (0.002) loss 1.9292 (1.6559) ce_loss 1.6494 (1.3750) teacher_loss 1.0722 (0.9154) loss_zs_kd 0.5210 (0.4514) loss_oracle 0.5965 (0.5148) acc 34.3750 (49.5404) kd_loss 0.7496 (0.7401) lr 1.4818e-03 eta 0:18:59
epoch [19/50] batch [360/428] time 0.082 (0.085) data 0.000 (0.002) loss 1.5920 (1.6557) ce_loss 1.3096 (1.3759) teacher_loss 0.8856 (0.9142) loss_zs_kd 0.4328 (0.4536) loss_oracle 0.4900 (0.5147) acc 43.7500 (49.4965) kd_loss 0.7622 (0.7411) lr 1.4818e-03 eta 0:18:57
epoch [19/50] batch [380/428] time 0.085 (0.085) data 0.000 (0.002) loss 1.7796 (1.6549) ce_loss 1.4727 (1.3754) teacher_loss 0.9821 (0.9130) loss_zs_kd 0.5547 (0.4553) loss_oracle 0.5201 (0.5143) acc 40.6250 (49.4408) kd_loss 0.8345 (0.7424) lr 1.4818e-03 eta 0:18:55
epoch [19/50] batch [400/428] time 0.080 (0.085) data 0.000 (0.002) loss 1.4473 (1.6537) ce_loss 1.2842 (1.3746) teacher_loss 0.7615 (0.9122) loss_zs_kd 0.4218 (0.4555) loss_oracle 0.4749 (0.5137) acc 53.1250 (49.5078) kd_loss 0.8533 (0.7450) lr 1.4818e-03 eta 0:18:53
epoch [19/50] batch [420/428] time 0.083 (0.085) data 0.000 (0.002) loss 1.6047 (1.6520) ce_loss 1.3340 (1.3736) teacher_loss 0.9417 (0.9106) loss_zs_kd 0.4742 (0.4568) loss_oracle 0.4258 (0.5130) acc 43.7500 (49.5685) kd_loss 0.6969 (0.7464) lr 1.4818e-03 eta 0:18:50
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,793
* accuracy: 47.5%
* error: 52.5%
* macro_f1: 35.9%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,748
* accuracy: 58.0%
* error: 42.0%
* macro_f1: 32.1%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 1 best val acc:      50.3%, epoch: 5 *******
******* Domain 1 best val test acc: 51.7%, epoch: 5 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [20/50] batch [20/428] time 0.075 (0.110) data 0.000 (0.025) loss 1.4646 (1.5987) ce_loss 1.1748 (1.3408) teacher_loss 0.8152 (0.8523) loss_zs_kd 0.4327 (0.4645) loss_oracle 0.4330 (0.5141) acc 56.2500 (52.3438) kd_loss 0.6398 (0.7791) lr 1.4258e-03 eta 0:24:15
epoch [20/50] batch [40/428] time 0.079 (0.096) data 0.000 (0.013) loss 1.6400 (1.5863) ce_loss 1.4248 (1.3531) teacher_loss 0.7677 (0.8394) loss_zs_kd 0.5545 (0.4708) loss_oracle 0.5950 (0.5115) acc 46.8750 (50.1562) kd_loss 0.9596 (0.7842) lr 1.4258e-03 eta 0:21:03
epoch [20/50] batch [60/428] time 0.085 (0.091) data 0.001 (0.009) loss 1.3521 (1.5843) ce_loss 1.0420 (1.3515) teacher_loss 0.6148 (0.8316) loss_zs_kd 0.4779 (0.4867) loss_oracle 0.4984 (0.5093) acc 65.6250 (49.6354) kd_loss 0.6462 (0.7769) lr 1.4258e-03 eta 0:20:07
epoch [20/50] batch [80/428] time 0.072 (0.089) data 0.000 (0.006) loss 1.8536 (1.5930) ce_loss 1.3838 (1.3510) teacher_loss 1.0898 (0.8372) loss_zs_kd 0.5058 (0.4923) loss_oracle 0.5109 (0.5097) acc 40.6250 (50.0781) kd_loss 0.7401 (0.7772) lr 1.4258e-03 eta 0:19:32
epoch [20/50] batch [100/428] time 0.090 (0.088) data 0.001 (0.005) loss 1.6841 (1.5942) ce_loss 1.4756 (1.3661) teacher_loss 0.8742 (0.8371) loss_zs_kd 0.5652 (0.4932) loss_oracle 0.5273 (0.5106) acc 46.8750 (49.6875) kd_loss 0.8095 (0.7848) lr 1.4258e-03 eta 0:19:14
epoch [20/50] batch [120/428] time 0.088 (0.087) data 0.000 (0.004) loss 1.4779 (1.5899) ce_loss 1.1445 (1.3682) teacher_loss 0.6834 (0.8309) loss_zs_kd 0.4783 (0.4929) loss_oracle 0.5554 (0.5126) acc 59.3750 (49.6615) kd_loss 0.8294 (0.7867) lr 1.4258e-03 eta 0:19:00
epoch [20/50] batch [140/428] time 0.094 (0.087) data 0.000 (0.004) loss 1.7234 (1.5928) ce_loss 1.3018 (1.3755) teacher_loss 0.8403 (0.8295) loss_zs_kd 0.6367 (0.4961) loss_oracle 0.5647 (0.5153) acc 56.2500 (49.3304) kd_loss 0.7120 (0.7877) lr 1.4258e-03 eta 0:18:57
epoch [20/50] batch [160/428] time 0.082 (0.087) data 0.000 (0.003) loss 1.5448 (1.5883) ce_loss 1.4453 (1.3662) teacher_loss 0.8031 (0.8234) loss_zs_kd 0.4985 (0.4988) loss_oracle 0.4924 (0.5155) acc 46.8750 (49.5898) kd_loss 0.7492 (0.7835) lr 1.4258e-03 eta 0:18:54
epoch [20/50] batch [180/428] time 0.082 (0.086) data 0.000 (0.003) loss 1.7806 (1.5945) ce_loss 1.5498 (1.3761) teacher_loss 1.0216 (0.8326) loss_zs_kd 0.5357 (0.4956) loss_oracle 0.4911 (0.5142) acc 34.3750 (49.2708) kd_loss 0.7247 (0.7810) lr 1.4258e-03 eta 0:18:50
epoch [20/50] batch [200/428] time 0.081 (0.086) data 0.000 (0.003) loss 1.5631 (1.5964) ce_loss 1.3496 (1.3762) teacher_loss 0.8756 (0.8359) loss_zs_kd 0.3683 (0.4930) loss_oracle 0.5034 (0.5139) acc 43.7500 (49.2500) kd_loss 0.7262 (0.7771) lr 1.4258e-03 eta 0:18:46
epoch [20/50] batch [220/428] time 0.084 (0.086) data 0.000 (0.003) loss 1.5750 (1.5960) ce_loss 1.3086 (1.3773) teacher_loss 0.8398 (0.8369) loss_zs_kd 0.4980 (0.4935) loss_oracle 0.4862 (0.5124) acc 50.0000 (49.2756) kd_loss 0.7170 (0.7734) lr 1.4258e-03 eta 0:18:43
epoch [20/50] batch [240/428] time 0.075 (0.086) data 0.000 (0.002) loss 1.9525 (1.6021) ce_loss 1.6680 (1.3816) teacher_loss 1.2398 (0.8465) loss_zs_kd 0.4586 (0.4887) loss_oracle 0.4834 (0.5112) acc 28.1250 (49.1667) kd_loss 0.6099 (0.7694) lr 1.4258e-03 eta 0:18:36
epoch [20/50] batch [260/428] time 0.085 (0.085) data 0.000 (0.002) loss 1.9236 (1.6040) ce_loss 1.6230 (1.3835) teacher_loss 1.2223 (0.8488) loss_zs_kd 0.4856 (0.4888) loss_oracle 0.4585 (0.5108) acc 46.8750 (48.9784) kd_loss 0.6487 (0.7662) lr 1.4258e-03 eta 0:18:31
epoch [20/50] batch [280/428] time 0.088 (0.085) data 0.000 (0.002) loss 1.5353 (1.6031) ce_loss 1.3623 (1.3815) teacher_loss 0.8533 (0.8480) loss_zs_kd 0.4088 (0.4890) loss_oracle 0.4776 (0.5106) acc 50.0000 (49.0067) kd_loss 0.7566 (0.7651) lr 1.4258e-03 eta 0:18:27
epoch [20/50] batch [300/428] time 0.083 (0.085) data 0.000 (0.002) loss 1.6641 (1.6050) ce_loss 1.4941 (1.3829) teacher_loss 0.8803 (0.8512) loss_zs_kd 0.5181 (0.4880) loss_oracle 0.5248 (0.5098) acc 50.0000 (49.0833) kd_loss 0.8520 (0.7631) lr 1.4258e-03 eta 0:18:26
epoch [20/50] batch [320/428] time 0.079 (0.085) data 0.000 (0.002) loss 1.5716 (1.6059) ce_loss 1.1973 (1.3845) teacher_loss 0.8385 (0.8544) loss_zs_kd 0.4642 (0.4853) loss_oracle 0.5010 (0.5088) acc 56.2500 (49.0332) kd_loss 0.7015 (0.7612) lr 1.4258e-03 eta 0:18:20
epoch [20/50] batch [340/428] time 0.084 (0.085) data 0.000 (0.002) loss 1.5859 (1.6033) ce_loss 1.4326 (1.3845) teacher_loss 0.8314 (0.8541) loss_zs_kd 0.4585 (0.4825) loss_oracle 0.5253 (0.5079) acc 40.6250 (49.0257) kd_loss 0.8094 (0.7612) lr 1.4258e-03 eta 0:18:17
epoch [20/50] batch [360/428] time 0.088 (0.085) data 0.000 (0.002) loss 1.5233 (1.6030) ce_loss 1.4570 (1.3855) teacher_loss 0.8791 (0.8546) loss_zs_kd 0.4053 (0.4820) loss_oracle 0.4415 (0.5073) acc 43.7500 (49.0451) kd_loss 0.7151 (0.7607) lr 1.4258e-03 eta 0:18:16
epoch [20/50] batch [380/428] time 0.084 (0.085) data 0.000 (0.002) loss 1.4221 (1.6041) ce_loss 1.3389 (1.3892) teacher_loss 0.6912 (0.8560) loss_zs_kd 0.4737 (0.4824) loss_oracle 0.4941 (0.5069) acc 50.0000 (48.8569) kd_loss 0.7205 (0.7595) lr 1.4258e-03 eta 0:18:14
epoch [20/50] batch [400/428] time 0.093 (0.085) data 0.000 (0.002) loss 1.4149 (1.6068) ce_loss 1.1943 (1.3883) teacher_loss 0.7443 (0.8595) loss_zs_kd 0.4231 (0.4813) loss_oracle 0.4590 (0.5067) acc 50.0000 (48.8906) kd_loss 0.7369 (0.7572) lr 1.4258e-03 eta 0:18:12
epoch [20/50] batch [420/428] time 0.079 (0.085) data 0.000 (0.001) loss 1.5291 (1.6081) ce_loss 1.2539 (1.3883) teacher_loss 0.7914 (0.8618) loss_zs_kd 0.4508 (0.4794) loss_oracle 0.5123 (0.5066) acc 53.1250 (48.9211) kd_loss 0.7398 (0.7556) lr 1.4258e-03 eta 0:18:09
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,971
* accuracy: 50.6%
* error: 49.4%
* macro_f1: 38.6%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,700
* accuracy: 57.0%
* error: 43.0%
* macro_f1: 32.6%
******* Domain 1 best val acc:      50.6%, epoch: 20 *******
******* Domain 1 best val test acc: 57.0%, epoch: 20 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [21/50] batch [20/428] time 0.089 (0.114) data 0.001 (0.031) loss 1.7129 (1.6578) ce_loss 1.5928 (1.4533) teacher_loss 0.9829 (0.9304) loss_zs_kd 0.5184 (0.4687) loss_oracle 0.4708 (0.4930) acc 37.5000 (47.3438) kd_loss 0.7989 (0.7771) lr 1.3681e-03 eta 0:24:23
epoch [21/50] batch [40/428] time 0.080 (0.099) data 0.000 (0.016) loss 1.4735 (1.6047) ce_loss 1.3652 (1.3970) teacher_loss 0.6788 (0.8737) loss_zs_kd 0.5160 (0.4626) loss_oracle 0.5367 (0.4997) acc 46.8750 (49.2969) kd_loss 0.7459 (0.7538) lr 1.3681e-03 eta 0:21:08
epoch [21/50] batch [60/428] time 0.072 (0.092) data 0.000 (0.011) loss 1.6746 (1.6069) ce_loss 1.4316 (1.3912) teacher_loss 0.9713 (0.8732) loss_zs_kd 0.4024 (0.4621) loss_oracle 0.5021 (0.5026) acc 50.0000 (49.8438) kd_loss 0.7419 (0.7428) lr 1.3681e-03 eta 0:19:41
epoch [21/50] batch [80/428] time 0.084 (0.090) data 0.000 (0.008) loss 1.4312 (1.6088) ce_loss 1.1055 (1.3863) teacher_loss 0.6523 (0.8744) loss_zs_kd 0.4454 (0.4621) loss_oracle 0.5562 (0.5033) acc 56.2500 (49.3359) kd_loss 0.7307 (0.7354) lr 1.3681e-03 eta 0:19:10
epoch [21/50] batch [100/428] time 0.086 (0.089) data 0.000 (0.006) loss 1.6484 (1.6170) ce_loss 1.2988 (1.3894) teacher_loss 0.9435 (0.8821) loss_zs_kd 0.4842 (0.4614) loss_oracle 0.4628 (0.5042) acc 56.2500 (49.0000) kd_loss 0.7653 (0.7403) lr 1.3681e-03 eta 0:18:52
epoch [21/50] batch [120/428] time 0.079 (0.088) data 0.000 (0.005) loss 1.6519 (1.6159) ce_loss 1.4219 (1.3914) teacher_loss 0.8895 (0.8809) loss_zs_kd 0.5491 (0.4646) loss_oracle 0.4879 (0.5026) acc 43.7500 (48.6979) kd_loss 0.7645 (0.7452) lr 1.3681e-03 eta 0:18:42
epoch [21/50] batch [140/428] time 0.081 (0.088) data 0.000 (0.005) loss 1.5904 (1.6150) ce_loss 1.3018 (1.3843) teacher_loss 0.8812 (0.8797) loss_zs_kd 0.4348 (0.4627) loss_oracle 0.4918 (0.5040) acc 50.0000 (48.6830) kd_loss 0.5524 (0.7441) lr 1.3681e-03 eta 0:18:32
epoch [21/50] batch [160/428] time 0.082 (0.087) data 0.000 (0.004) loss 1.4632 (1.6151) ce_loss 1.0615 (1.3701) teacher_loss 0.6726 (0.8786) loss_zs_kd 0.4944 (0.4598) loss_oracle 0.5434 (0.5065) acc 59.3750 (49.3164) kd_loss 0.7293 (0.7418) lr 1.3681e-03 eta 0:18:23
epoch [21/50] batch [180/428] time 0.079 (0.087) data 0.000 (0.004) loss 1.5020 (1.6213) ce_loss 1.3701 (1.3719) teacher_loss 0.7521 (0.8827) loss_zs_kd 0.4894 (0.4603) loss_oracle 0.5052 (0.5085) acc 50.0000 (49.3924) kd_loss 0.7655 (0.7431) lr 1.3681e-03 eta 0:18:15
epoch [21/50] batch [200/428] time 0.079 (0.086) data 0.000 (0.003) loss 1.2827 (1.6186) ce_loss 1.1094 (1.3680) teacher_loss 0.5878 (0.8786) loss_zs_kd 0.4278 (0.4586) loss_oracle 0.4809 (0.5108) acc 59.3750 (49.6250) kd_loss 0.7129 (0.7446) lr 1.3681e-03 eta 0:18:09
epoch [21/50] batch [220/428] time 0.084 (0.086) data 0.000 (0.003) loss 1.5372 (1.6172) ce_loss 1.2949 (1.3614) teacher_loss 0.8280 (0.8761) loss_zs_kd 0.3907 (0.4562) loss_oracle 0.5138 (0.5131) acc 53.1250 (49.8295) kd_loss 0.8277 (0.7459) lr 1.3681e-03 eta 0:18:07
epoch [21/50] batch [240/428] time 0.081 (0.086) data 0.000 (0.003) loss 1.7591 (1.6251) ce_loss 1.3838 (1.3676) teacher_loss 1.0062 (0.8822) loss_zs_kd 0.4547 (0.4563) loss_oracle 0.5255 (0.5148) acc 50.0000 (49.4141) kd_loss 0.6776 (0.7468) lr 1.3681e-03 eta 0:18:03
epoch [21/50] batch [260/428] time 0.083 (0.086) data 0.000 (0.003) loss 1.5045 (1.6238) ce_loss 1.2500 (1.3638) teacher_loss 0.7898 (0.8809) loss_zs_kd 0.4115 (0.4561) loss_oracle 0.5090 (0.5149) acc 40.6250 (49.4471) kd_loss 0.6414 (0.7448) lr 1.3681e-03 eta 0:18:01
epoch [21/50] batch [280/428] time 0.087 (0.086) data 0.000 (0.002) loss 1.8259 (1.6296) ce_loss 1.3516 (1.3669) teacher_loss 1.0822 (0.8867) loss_zs_kd 0.4629 (0.4554) loss_oracle 0.5123 (0.5152) acc 56.2500 (49.4420) kd_loss 0.8054 (0.7443) lr 1.3681e-03 eta 0:17:59
epoch [21/50] batch [300/428] time 0.086 (0.086) data 0.000 (0.002) loss 1.6007 (1.6306) ce_loss 1.2393 (1.3696) teacher_loss 0.9401 (0.8878) loss_zs_kd 0.4429 (0.4538) loss_oracle 0.4391 (0.5159) acc 65.6250 (49.2604) kd_loss 0.6608 (0.7465) lr 1.3681e-03 eta 0:17:57
epoch [21/50] batch [320/428] time 0.081 (0.086) data 0.000 (0.002) loss 1.4691 (1.6318) ce_loss 1.3291 (1.3693) teacher_loss 0.6876 (0.8876) loss_zs_kd 0.4737 (0.4534) loss_oracle 0.5447 (0.5175) acc 46.8750 (49.2676) kd_loss 0.9695 (0.7506) lr 1.3681e-03 eta 0:17:55
epoch [21/50] batch [340/428] time 0.082 (0.085) data 0.000 (0.002) loss 1.7329 (1.6351) ce_loss 1.6191 (1.3740) teacher_loss 1.0675 (0.8906) loss_zs_kd 0.4492 (0.4533) loss_oracle 0.4408 (0.5179) acc 40.6250 (49.0993) kd_loss 0.7111 (0.7517) lr 1.3681e-03 eta 0:17:48
epoch [21/50] batch [360/428] time 0.086 (0.085) data 0.000 (0.002) loss 1.5338 (1.6380) ce_loss 1.3213 (1.3765) teacher_loss 0.9275 (0.8946) loss_zs_kd 0.3592 (0.4527) loss_oracle 0.4267 (0.5170) acc 43.7500 (48.8628) kd_loss 0.7733 (0.7522) lr 1.3681e-03 eta 0:17:47
epoch [21/50] batch [380/428] time 0.077 (0.085) data 0.000 (0.002) loss 1.7238 (1.6397) ce_loss 1.4297 (1.3775) teacher_loss 0.9707 (0.8969) loss_zs_kd 0.5293 (0.4525) loss_oracle 0.4884 (0.5166) acc 46.8750 (48.8651) kd_loss 0.8372 (0.7521) lr 1.3681e-03 eta 0:17:42
epoch [21/50] batch [400/428] time 0.095 (0.085) data 0.000 (0.002) loss 1.6666 (1.6400) ce_loss 1.3379 (1.3778) teacher_loss 0.8443 (0.8957) loss_zs_kd 0.4775 (0.4543) loss_oracle 0.5836 (0.5171) acc 46.8750 (48.8516) kd_loss 0.8611 (0.7540) lr 1.3681e-03 eta 0:17:38
epoch [21/50] batch [420/428] time 0.080 (0.085) data 0.001 (0.002) loss 1.7968 (1.6373) ce_loss 1.6318 (1.3747) teacher_loss 1.1275 (0.8931) loss_zs_kd 0.4456 (0.4547) loss_oracle 0.4464 (0.5169) acc 50.0000 (49.0625) kd_loss 0.8179 (0.7563) lr 1.3681e-03 eta 0:17:32
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,961
* accuracy: 50.4%
* error: 49.6%
* macro_f1: 37.9%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,649
* accuracy: 55.9%
* error: 44.1%
* macro_f1: 30.6%
******* Domain 1 best val acc:      50.6%, epoch: 20 *******
******* Domain 1 best val test acc: 57.0%, epoch: 20 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [22/50] batch [20/428] time 0.076 (0.108) data 0.000 (0.027) loss 1.3816 (1.6201) ce_loss 1.1611 (1.3644) teacher_loss 0.6319 (0.8863) loss_zs_kd 0.4206 (0.4471) loss_oracle 0.5394 (0.5103) acc 43.7500 (51.7188) kd_loss 0.7731 (0.7641) lr 1.3090e-03 eta 0:22:13
epoch [22/50] batch [40/428] time 0.084 (0.096) data 0.000 (0.014) loss 1.7519 (1.6329) ce_loss 1.2920 (1.3479) teacher_loss 0.8642 (0.8832) loss_zs_kd 0.5216 (0.4582) loss_oracle 0.6269 (0.5207) acc 56.2500 (50.9375) kd_loss 0.8046 (0.7739) lr 1.3090e-03 eta 0:19:45
epoch [22/50] batch [60/428] time 0.086 (0.092) data 0.001 (0.009) loss 1.7321 (1.6637) ce_loss 1.2861 (1.3910) teacher_loss 0.8866 (0.9083) loss_zs_kd 0.5468 (0.4627) loss_oracle 0.5721 (0.5241) acc 50.0000 (49.0104) kd_loss 0.8231 (0.7796) lr 1.3090e-03 eta 0:19:01
epoch [22/50] batch [80/428] time 0.087 (0.091) data 0.000 (0.007) loss 1.6814 (1.6560) ce_loss 1.3848 (1.3928) teacher_loss 0.9083 (0.9019) loss_zs_kd 0.4615 (0.4621) loss_oracle 0.5424 (0.5230) acc 56.2500 (49.2578) kd_loss 0.7365 (0.7752) lr 1.3090e-03 eta 0:18:36
epoch [22/50] batch [100/428] time 0.085 (0.090) data 0.000 (0.006) loss 1.4039 (1.6436) ce_loss 1.2041 (1.3871) teacher_loss 0.5955 (0.8877) loss_zs_kd 0.5062 (0.4628) loss_oracle 0.5553 (0.5245) acc 65.6250 (49.7188) kd_loss 0.7552 (0.7748) lr 1.3090e-03 eta 0:18:22
epoch [22/50] batch [120/428] time 0.091 (0.089) data 0.000 (0.005) loss 1.3914 (1.6506) ce_loss 1.3730 (1.3927) teacher_loss 0.6908 (0.8958) loss_zs_kd 0.4343 (0.4596) loss_oracle 0.4834 (0.5250) acc 50.0000 (49.5052) kd_loss 0.8144 (0.7731) lr 1.3090e-03 eta 0:18:11
epoch [22/50] batch [140/428] time 0.082 (0.088) data 0.000 (0.004) loss 1.5611 (1.6386) ce_loss 1.3672 (1.3812) teacher_loss 0.8588 (0.8837) loss_zs_kd 0.4761 (0.4604) loss_oracle 0.4643 (0.5247) acc 46.8750 (49.9554) kd_loss 0.7756 (0.7723) lr 1.3090e-03 eta 0:18:03
epoch [22/50] batch [160/428] time 0.086 (0.088) data 0.000 (0.004) loss 1.4812 (1.6304) ce_loss 1.3340 (1.3693) teacher_loss 0.7817 (0.8743) loss_zs_kd 0.4467 (0.4620) loss_oracle 0.4761 (0.5252) acc 43.7500 (50.3320) kd_loss 0.6279 (0.7687) lr 1.3090e-03 eta 0:18:00
epoch [22/50] batch [180/428] time 0.092 (0.088) data 0.000 (0.003) loss 1.8331 (1.6319) ce_loss 1.7549 (1.3699) teacher_loss 1.0495 (0.8748) loss_zs_kd 0.5288 (0.4617) loss_oracle 0.5192 (0.5262) acc 40.6250 (50.3646) kd_loss 0.7739 (0.7710) lr 1.3090e-03 eta 0:17:56
epoch [22/50] batch [200/428] time 0.081 (0.087) data 0.000 (0.003) loss 1.5632 (1.6318) ce_loss 1.3350 (1.3709) teacher_loss 0.8115 (0.8745) loss_zs_kd 0.4971 (0.4619) loss_oracle 0.5032 (0.5264) acc 37.5000 (50.2812) kd_loss 0.7716 (0.7688) lr 1.3090e-03 eta 0:17:47
epoch [22/50] batch [220/428] time 0.081 (0.087) data 0.000 (0.003) loss 1.7223 (1.6272) ce_loss 1.5029 (1.3707) teacher_loss 1.0194 (0.8717) loss_zs_kd 0.3932 (0.4607) loss_oracle 0.5062 (0.5252) acc 37.5000 (50.2273) kd_loss 0.7983 (0.7705) lr 1.3090e-03 eta 0:17:44
epoch [22/50] batch [240/428] time 0.092 (0.087) data 0.000 (0.003) loss 1.7281 (1.6263) ce_loss 1.5098 (1.3702) teacher_loss 1.0144 (0.8729) loss_zs_kd 0.4217 (0.4588) loss_oracle 0.5028 (0.5239) acc 37.5000 (50.1823) kd_loss 0.7426 (0.7708) lr 1.3090e-03 eta 0:17:38
epoch [22/50] batch [260/428] time 0.082 (0.087) data 0.000 (0.002) loss 1.5888 (1.6315) ce_loss 1.3193 (1.3731) teacher_loss 0.8385 (0.8792) loss_zs_kd 0.4392 (0.4575) loss_oracle 0.5307 (0.5235) acc 56.2500 (50.0841) kd_loss 0.7809 (0.7680) lr 1.3090e-03 eta 0:17:32
epoch [22/50] batch [280/428] time 0.086 (0.086) data 0.000 (0.002) loss 1.8309 (1.6357) ce_loss 1.3447 (1.3769) teacher_loss 0.9570 (0.8852) loss_zs_kd 0.4910 (0.4561) loss_oracle 0.6285 (0.5225) acc 50.0000 (49.7991) kd_loss 0.7503 (0.7648) lr 1.3090e-03 eta 0:17:29
epoch [22/50] batch [300/428] time 0.085 (0.086) data 0.000 (0.002) loss 1.6128 (1.6361) ce_loss 1.4717 (1.3741) teacher_loss 0.8166 (0.8873) loss_zs_kd 0.5114 (0.4538) loss_oracle 0.5405 (0.5219) acc 34.3750 (49.9375) kd_loss 0.7376 (0.7604) lr 1.3090e-03 eta 0:17:23
epoch [22/50] batch [320/428] time 0.075 (0.086) data 0.000 (0.002) loss 1.4093 (1.6317) ce_loss 1.2070 (1.3698) teacher_loss 0.6861 (0.8852) loss_zs_kd 0.4364 (0.4519) loss_oracle 0.5050 (0.5205) acc 56.2500 (50.0391) kd_loss 0.7724 (0.7571) lr 1.3090e-03 eta 0:17:20
epoch [22/50] batch [340/428] time 0.085 (0.086) data 0.000 (0.002) loss 1.6292 (1.6327) ce_loss 1.1982 (1.3705) teacher_loss 0.8990 (0.8875) loss_zs_kd 0.4050 (0.4501) loss_oracle 0.5278 (0.5201) acc 59.3750 (50.0092) kd_loss 0.6911 (0.7539) lr 1.3090e-03 eta 0:17:15
epoch [22/50] batch [360/428] time 0.069 (0.086) data 0.000 (0.002) loss 1.5571 (1.6340) ce_loss 1.3252 (1.3705) teacher_loss 0.8543 (0.8901) loss_zs_kd 0.4171 (0.4478) loss_oracle 0.4942 (0.5200) acc 40.6250 (49.9479) kd_loss 0.6433 (0.7513) lr 1.3090e-03 eta 0:17:12
epoch [22/50] batch [380/428] time 0.090 (0.086) data 0.000 (0.002) loss 1.5696 (1.6335) ce_loss 1.3848 (1.3699) teacher_loss 0.9091 (0.8910) loss_zs_kd 0.3767 (0.4462) loss_oracle 0.4721 (0.5194) acc 43.7500 (49.9260) kd_loss 0.6993 (0.7471) lr 1.3090e-03 eta 0:17:10
epoch [22/50] batch [400/428] time 0.090 (0.085) data 0.000 (0.002) loss 1.6806 (1.6383) ce_loss 1.4033 (1.3723) teacher_loss 0.9840 (0.8960) loss_zs_kd 0.4426 (0.4454) loss_oracle 0.4753 (0.5196) acc 43.7500 (49.8281) kd_loss 0.7055 (0.7444) lr 1.3090e-03 eta 0:17:04
epoch [22/50] batch [420/428] time 0.082 (0.085) data 0.000 (0.002) loss 1.6571 (1.6383) ce_loss 1.2617 (1.3717) teacher_loss 0.8795 (0.8964) loss_zs_kd 0.5132 (0.4448) loss_oracle 0.5210 (0.5194) acc 46.8750 (49.8661) kd_loss 0.7152 (0.7420) lr 1.3090e-03 eta 0:17:00
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,948
* accuracy: 50.2%
* error: 49.8%
* macro_f1: 36.8%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,687
* accuracy: 56.7%
* error: 43.3%
* macro_f1: 28.6%
******* Domain 1 best val acc:      50.6%, epoch: 20 *******
******* Domain 1 best val test acc: 57.0%, epoch: 20 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [23/50] batch [20/428] time 0.084 (0.114) data 0.000 (0.029) loss 1.6823 (1.6547) ce_loss 1.3154 (1.3344) teacher_loss 0.9237 (0.9325) loss_zs_kd 0.4567 (0.4087) loss_oracle 0.5303 (0.5179) acc 53.1250 (52.1875) kd_loss 0.6831 (0.7056) lr 1.2487e-03 eta 0:22:44
epoch [23/50] batch [40/428] time 0.084 (0.099) data 0.000 (0.014) loss 1.4303 (1.6461) ce_loss 1.2314 (1.3596) teacher_loss 0.7475 (0.9273) loss_zs_kd 0.4347 (0.4171) loss_oracle 0.4655 (0.5102) acc 59.3750 (51.7188) kd_loss 0.7558 (0.7173) lr 1.2487e-03 eta 0:19:41
epoch [23/50] batch [60/428] time 0.084 (0.094) data 0.001 (0.010) loss 1.6586 (1.6443) ce_loss 1.5518 (1.3566) teacher_loss 0.8915 (0.9188) loss_zs_kd 0.3965 (0.4333) loss_oracle 0.5689 (0.5088) acc 50.0000 (52.0312) kd_loss 0.7550 (0.7152) lr 1.2487e-03 eta 0:18:44
epoch [23/50] batch [80/428] time 0.080 (0.092) data 0.000 (0.007) loss 1.9526 (1.6656) ce_loss 1.5723 (1.3875) teacher_loss 1.2328 (0.9413) loss_zs_kd 0.4310 (0.4325) loss_oracle 0.5044 (0.5081) acc 34.3750 (50.3516) kd_loss 0.7007 (0.7149) lr 1.2487e-03 eta 0:18:13
epoch [23/50] batch [100/428] time 0.086 (0.091) data 0.000 (0.006) loss 1.6945 (1.6705) ce_loss 1.3721 (1.3904) teacher_loss 0.9187 (0.9403) loss_zs_kd 0.4648 (0.4340) loss_oracle 0.5434 (0.5132) acc 56.2500 (50.0000) kd_loss 0.7328 (0.7216) lr 1.2487e-03 eta 0:17:55
epoch [23/50] batch [120/428] time 0.080 (0.090) data 0.000 (0.005) loss 1.6382 (1.6686) ce_loss 1.4160 (1.3898) teacher_loss 0.8783 (0.9377) loss_zs_kd 0.4408 (0.4350) loss_oracle 0.5395 (0.5134) acc 56.2500 (49.8177) kd_loss 0.8128 (0.7237) lr 1.2487e-03 eta 0:17:42
epoch [23/50] batch [140/428] time 0.078 (0.089) data 0.000 (0.004) loss 2.0096 (1.6664) ce_loss 1.5244 (1.3890) teacher_loss 1.2997 (0.9350) loss_zs_kd 0.4322 (0.4356) loss_oracle 0.4938 (0.5136) acc 43.7500 (49.3527) kd_loss 0.6101 (0.7256) lr 1.2487e-03 eta 0:17:30
epoch [23/50] batch [160/428] time 0.093 (0.088) data 0.000 (0.004) loss 1.6019 (1.6648) ce_loss 1.3096 (1.3863) teacher_loss 0.9043 (0.9306) loss_zs_kd 0.4228 (0.4383) loss_oracle 0.4862 (0.5150) acc 56.2500 (49.4141) kd_loss 0.6899 (0.7243) lr 1.2487e-03 eta 0:17:22
epoch [23/50] batch [180/428] time 0.086 (0.088) data 0.000 (0.003) loss 1.4417 (1.6562) ce_loss 1.0742 (1.3807) teacher_loss 0.7385 (0.9211) loss_zs_kd 0.4023 (0.4385) loss_oracle 0.5021 (0.5158) acc 59.3750 (49.4444) kd_loss 0.6074 (0.7230) lr 1.2487e-03 eta 0:17:18
epoch [23/50] batch [200/428] time 0.083 (0.088) data 0.000 (0.003) loss 1.5549 (1.6492) ce_loss 1.2207 (1.3734) teacher_loss 0.8384 (0.9134) loss_zs_kd 0.4530 (0.4404) loss_oracle 0.4900 (0.5156) acc 62.5000 (49.7031) kd_loss 0.6401 (0.7208) lr 1.2487e-03 eta 0:17:13
epoch [23/50] batch [220/428] time 0.085 (0.087) data 0.000 (0.003) loss 1.6318 (1.6503) ce_loss 1.3838 (1.3748) teacher_loss 0.9803 (0.9152) loss_zs_kd 0.3761 (0.4370) loss_oracle 0.4634 (0.5166) acc 53.1250 (49.7017) kd_loss 0.6084 (0.7215) lr 1.2487e-03 eta 0:17:06
epoch [23/50] batch [240/428] time 0.079 (0.087) data 0.000 (0.003) loss 1.7338 (1.6470) ce_loss 1.6074 (1.3708) teacher_loss 0.9756 (0.9112) loss_zs_kd 0.4773 (0.4380) loss_oracle 0.5196 (0.5168) acc 40.6250 (49.7917) kd_loss 0.6802 (0.7208) lr 1.2487e-03 eta 0:17:02
epoch [23/50] batch [260/428] time 0.093 (0.087) data 0.000 (0.002) loss 1.8167 (1.6478) ce_loss 1.5264 (1.3725) teacher_loss 1.0895 (0.9129) loss_zs_kd 0.4338 (0.4376) loss_oracle 0.5103 (0.5161) acc 31.2500 (49.6514) kd_loss 0.7747 (0.7183) lr 1.2487e-03 eta 0:17:00
epoch [23/50] batch [280/428] time 0.082 (0.087) data 0.000 (0.002) loss 1.3575 (1.6443) ce_loss 1.1455 (1.3681) teacher_loss 0.6112 (0.9103) loss_zs_kd 0.3921 (0.4368) loss_oracle 0.5502 (0.5156) acc 62.5000 (49.8103) kd_loss 0.8125 (0.7184) lr 1.2487e-03 eta 0:16:56
epoch [23/50] batch [300/428] time 0.090 (0.087) data 0.000 (0.002) loss 1.4818 (1.6421) ce_loss 1.2051 (1.3681) teacher_loss 0.7398 (0.9102) loss_zs_kd 0.4847 (0.4355) loss_oracle 0.4996 (0.5141) acc 53.1250 (49.8021) kd_loss 0.6901 (0.7177) lr 1.2487e-03 eta 0:16:54
epoch [23/50] batch [320/428] time 0.082 (0.087) data 0.000 (0.002) loss 1.8022 (1.6434) ce_loss 1.5127 (1.3692) teacher_loss 1.0205 (0.9120) loss_zs_kd 0.4676 (0.4365) loss_oracle 0.5479 (0.5131) acc 34.3750 (49.7852) kd_loss 0.8082 (0.7175) lr 1.2487e-03 eta 0:16:50
epoch [23/50] batch [340/428] time 0.088 (0.086) data 0.000 (0.002) loss 1.5775 (1.6397) ce_loss 1.4590 (1.3694) teacher_loss 0.8819 (0.9089) loss_zs_kd 0.4091 (0.4368) loss_oracle 0.4910 (0.5124) acc 56.2500 (49.7978) kd_loss 0.7647 (0.7190) lr 1.2487e-03 eta 0:16:46
epoch [23/50] batch [360/428] time 0.085 (0.086) data 0.000 (0.002) loss 1.8909 (1.6390) ce_loss 1.6523 (1.3656) teacher_loss 1.0837 (0.9068) loss_zs_kd 0.4229 (0.4385) loss_oracle 0.5958 (0.5130) acc 28.1250 (49.8611) kd_loss 0.8621 (0.7192) lr 1.2487e-03 eta 0:16:43
epoch [23/50] batch [380/428] time 0.096 (0.086) data 0.000 (0.002) loss 1.3977 (1.6354) ce_loss 1.1289 (1.3621) teacher_loss 0.7288 (0.9037) loss_zs_kd 0.3512 (0.4376) loss_oracle 0.4933 (0.5129) acc 56.2500 (50.0164) kd_loss 0.6977 (0.7202) lr 1.2487e-03 eta 0:16:38
epoch [23/50] batch [400/428] time 0.077 (0.086) data 0.000 (0.002) loss 1.3187 (1.6339) ce_loss 1.2227 (1.3603) teacher_loss 0.6370 (0.9021) loss_zs_kd 0.3988 (0.4382) loss_oracle 0.4823 (0.5127) acc 65.6250 (50.0781) kd_loss 0.8183 (0.7231) lr 1.2487e-03 eta 0:16:36
epoch [23/50] batch [420/428] time 0.082 (0.086) data 0.000 (0.002) loss 1.6220 (1.6352) ce_loss 1.1826 (1.3621) teacher_loss 0.8222 (0.9037) loss_zs_kd 0.4079 (0.4379) loss_oracle 0.5959 (0.5125) acc 56.2500 (50.0595) kd_loss 0.8772 (0.7242) lr 1.2487e-03 eta 0:16:34
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,968
* accuracy: 50.5%
* error: 49.5%
* macro_f1: 37.6%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,603
* accuracy: 54.9%
* error: 45.1%
* macro_f1: 29.0%
******* Domain 1 best val acc:      50.6%, epoch: 20 *******
******* Domain 1 best val test acc: 57.0%, epoch: 20 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [24/50] batch [20/428] time 0.081 (0.114) data 0.000 (0.027) loss 1.5697 (1.6046) ce_loss 1.2666 (1.3431) teacher_loss 0.7883 (0.8606) loss_zs_kd 0.4838 (0.4552) loss_oracle 0.5395 (0.5164) acc 53.1250 (51.0938) kd_loss 0.7083 (0.7520) lr 1.1874e-03 eta 0:21:51
epoch [24/50] batch [40/428] time 0.077 (0.095) data 0.000 (0.013) loss 1.7189 (1.6062) ce_loss 1.4795 (1.3310) teacher_loss 0.9947 (0.8691) loss_zs_kd 0.4153 (0.4463) loss_oracle 0.5166 (0.5139) acc 43.7500 (51.0156) kd_loss 0.7883 (0.7518) lr 1.1874e-03 eta 0:18:16
epoch [24/50] batch [60/428] time 0.093 (0.092) data 0.001 (0.009) loss 1.9575 (1.6092) ce_loss 1.6738 (1.3317) teacher_loss 1.1871 (0.8688) loss_zs_kd 0.4121 (0.4390) loss_oracle 0.5643 (0.5210) acc 31.2500 (50.8333) kd_loss 0.7602 (0.7531) lr 1.1874e-03 eta 0:17:35
epoch [24/50] batch [80/428] time 0.087 (0.089) data 0.000 (0.007) loss 1.9987 (1.6176) ce_loss 1.6533 (1.3389) teacher_loss 1.2322 (0.8757) loss_zs_kd 0.4867 (0.4402) loss_oracle 0.5232 (0.5218) acc 37.5000 (50.4688) kd_loss 0.7388 (0.7538) lr 1.1874e-03 eta 0:17:06
epoch [24/50] batch [100/428] time 0.085 (0.089) data 0.000 (0.006) loss 1.4724 (1.6136) ce_loss 1.3271 (1.3329) teacher_loss 0.7568 (0.8700) loss_zs_kd 0.4049 (0.4396) loss_oracle 0.5132 (0.5238) acc 43.7500 (50.5625) kd_loss 0.8015 (0.7530) lr 1.1874e-03 eta 0:16:54
epoch [24/50] batch [120/428] time 0.088 (0.088) data 0.000 (0.005) loss 1.5883 (1.6258) ce_loss 1.4180 (1.3467) teacher_loss 0.8271 (0.8808) loss_zs_kd 0.4117 (0.4393) loss_oracle 0.5553 (0.5254) acc 46.8750 (49.7917) kd_loss 0.7836 (0.7490) lr 1.1874e-03 eta 0:16:42
epoch [24/50] batch [140/428] time 0.077 (0.087) data 0.000 (0.004) loss 1.8598 (1.6376) ce_loss 1.4209 (1.3492) teacher_loss 1.1091 (0.8903) loss_zs_kd 0.4859 (0.4420) loss_oracle 0.5077 (0.5263) acc 43.7500 (49.5536) kd_loss 0.7593 (0.7434) lr 1.1874e-03 eta 0:16:29
epoch [24/50] batch [160/428] time 0.082 (0.086) data 0.000 (0.004) loss 1.4369 (1.6328) ce_loss 1.1689 (1.3462) teacher_loss 0.6564 (0.8892) loss_zs_kd 0.4391 (0.4383) loss_oracle 0.5610 (0.5244) acc 53.1250 (49.6094) kd_loss 0.7148 (0.7400) lr 1.1874e-03 eta 0:16:17
epoch [24/50] batch [180/428] time 0.077 (0.085) data 0.000 (0.003) loss 1.6672 (1.6352) ce_loss 1.3281 (1.3520) teacher_loss 0.8475 (0.8910) loss_zs_kd 0.5267 (0.4396) loss_oracle 0.5564 (0.5244) acc 53.1250 (49.4618) kd_loss 0.7369 (0.7401) lr 1.1874e-03 eta 0:16:10
epoch [24/50] batch [200/428] time 0.080 (0.084) data 0.000 (0.003) loss 1.5750 (1.6378) ce_loss 1.3750 (1.3557) teacher_loss 0.8695 (0.8918) loss_zs_kd 0.4489 (0.4399) loss_oracle 0.4811 (0.5261) acc 50.0000 (49.5625) kd_loss 0.7463 (0.7430) lr 1.1874e-03 eta 0:15:59
epoch [24/50] batch [220/428] time 0.073 (0.084) data 0.000 (0.003) loss 1.7559 (1.6424) ce_loss 1.4482 (1.3607) teacher_loss 1.1170 (0.8961) loss_zs_kd 0.3623 (0.4394) loss_oracle 0.4577 (0.5266) acc 50.0000 (49.5170) kd_loss 0.6763 (0.7442) lr 1.1874e-03 eta 0:15:57
epoch [24/50] batch [240/428] time 0.085 (0.084) data 0.000 (0.002) loss 1.7470 (1.6471) ce_loss 1.6123 (1.3704) teacher_loss 1.0584 (0.9029) loss_zs_kd 0.4317 (0.4382) loss_oracle 0.4727 (0.5251) acc 46.8750 (49.0625) kd_loss 0.7285 (0.7460) lr 1.1874e-03 eta 0:15:55
epoch [24/50] batch [260/428] time 0.087 (0.085) data 0.000 (0.002) loss 1.8481 (1.6448) ce_loss 1.5459 (1.3682) teacher_loss 1.1115 (0.9012) loss_zs_kd 0.4366 (0.4399) loss_oracle 0.5183 (0.5236) acc 34.3750 (48.9543) kd_loss 0.7551 (0.7445) lr 1.1874e-03 eta 0:15:54
epoch [24/50] batch [280/428] time 0.088 (0.085) data 0.000 (0.002) loss 1.6625 (1.6464) ce_loss 1.5117 (1.3715) teacher_loss 0.8836 (0.9019) loss_zs_kd 0.4883 (0.4414) loss_oracle 0.5347 (0.5238) acc 40.6250 (48.8393) kd_loss 0.7604 (0.7457) lr 1.1874e-03 eta 0:15:55
epoch [24/50] batch [300/428] time 0.083 (0.085) data 0.000 (0.002) loss 1.4485 (1.6461) ce_loss 1.1953 (1.3737) teacher_loss 0.7266 (0.9024) loss_zs_kd 0.4271 (0.4407) loss_oracle 0.5083 (0.5234) acc 62.5000 (48.7917) kd_loss 0.7201 (0.7472) lr 1.1874e-03 eta 0:15:54
epoch [24/50] batch [320/428] time 0.084 (0.084) data 0.000 (0.002) loss 1.5014 (1.6482) ce_loss 1.2900 (1.3749) teacher_loss 0.7725 (0.9035) loss_zs_kd 0.4327 (0.4417) loss_oracle 0.5126 (0.5238) acc 59.3750 (48.9258) kd_loss 0.6857 (0.7474) lr 1.1874e-03 eta 0:15:47
epoch [24/50] batch [340/428] time 0.079 (0.084) data 0.000 (0.002) loss 1.5527 (1.6447) ce_loss 1.3467 (1.3742) teacher_loss 0.8470 (0.8993) loss_zs_kd 0.4104 (0.4416) loss_oracle 0.5005 (0.5247) acc 50.0000 (48.9154) kd_loss 0.5807 (0.7490) lr 1.1874e-03 eta 0:15:42
epoch [24/50] batch [360/428] time 0.084 (0.084) data 0.000 (0.002) loss 1.4039 (1.6455) ce_loss 1.1406 (1.3773) teacher_loss 0.7192 (0.8990) loss_zs_kd 0.4145 (0.4420) loss_oracle 0.4774 (0.5255) acc 56.2500 (48.8368) kd_loss 0.6479 (0.7505) lr 1.1874e-03 eta 0:15:40
epoch [24/50] batch [380/428] time 0.079 (0.084) data 0.000 (0.002) loss 1.6407 (1.6418) ce_loss 1.4453 (1.3743) teacher_loss 0.8663 (0.8942) loss_zs_kd 0.4704 (0.4435) loss_oracle 0.5393 (0.5259) acc 46.8750 (49.0378) kd_loss 0.7423 (0.7506) lr 1.1874e-03 eta 0:15:37
epoch [24/50] batch [400/428] time 0.084 (0.084) data 0.000 (0.002) loss 1.6264 (1.6427) ce_loss 1.3281 (1.3738) teacher_loss 0.8578 (0.8948) loss_zs_kd 0.4140 (0.4434) loss_oracle 0.5616 (0.5262) acc 46.8750 (49.0469) kd_loss 0.7211 (0.7494) lr 1.1874e-03 eta 0:15:33
epoch [24/50] batch [420/428] time 0.078 (0.084) data 0.000 (0.002) loss 1.5157 (1.6425) ce_loss 1.3027 (1.3751) teacher_loss 0.7241 (0.8949) loss_zs_kd 0.4133 (0.4430) loss_oracle 0.5849 (0.5262) acc 46.8750 (48.9286) kd_loss 0.8230 (0.7478) lr 1.1874e-03 eta 0:15:31
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,043
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 38.7%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,486
* accuracy: 52.4%
* error: 47.6%
* macro_f1: 28.4%
******* Domain 1 best val acc:      51.8%, epoch: 24 *******
******* Domain 1 best val test acc: 52.4%, epoch: 24 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [25/50] batch [20/428] time 0.098 (0.114) data 0.000 (0.027) loss 2.2052 (1.6802) ce_loss 1.9062 (1.4145) teacher_loss 1.3532 (0.9595) loss_zs_kd 0.5323 (0.4282) loss_oracle 0.5858 (0.5066) acc 34.3750 (47.0312) kd_loss 0.6953 (0.6992) lr 1.1253e-03 eta 0:21:01
epoch [25/50] batch [40/428] time 0.085 (0.100) data 0.000 (0.014) loss 1.6195 (1.6537) ce_loss 1.4141 (1.3950) teacher_loss 0.8400 (0.9139) loss_zs_kd 0.4937 (0.4386) loss_oracle 0.5327 (0.5205) acc 50.0000 (49.5312) kd_loss 0.7158 (0.7218) lr 1.1253e-03 eta 0:18:27
epoch [25/50] batch [60/428] time 0.083 (0.094) data 0.000 (0.009) loss 1.6928 (1.6552) ce_loss 1.3564 (1.3917) teacher_loss 1.0409 (0.9131) loss_zs_kd 0.4026 (0.4459) loss_oracle 0.4506 (0.5192) acc 53.1250 (49.5833) kd_loss 0.6885 (0.7287) lr 1.1253e-03 eta 0:17:18
epoch [25/50] batch [80/428] time 0.082 (0.091) data 0.000 (0.007) loss 1.5112 (1.6551) ce_loss 1.2480 (1.3938) teacher_loss 0.7437 (0.9064) loss_zs_kd 0.4746 (0.4509) loss_oracle 0.5302 (0.5233) acc 59.3750 (49.0625) kd_loss 0.7750 (0.7389) lr 1.1253e-03 eta 0:16:46
epoch [25/50] batch [100/428] time 0.088 (0.090) data 0.000 (0.006) loss 1.7445 (1.6515) ce_loss 1.3633 (1.3945) teacher_loss 0.9521 (0.8989) loss_zs_kd 0.5205 (0.4577) loss_oracle 0.5322 (0.5237) acc 46.8750 (49.3438) kd_loss 0.8116 (0.7461) lr 1.1253e-03 eta 0:16:31
epoch [25/50] batch [120/428] time 0.086 (0.089) data 0.000 (0.005) loss 1.7013 (1.6442) ce_loss 1.4238 (1.3871) teacher_loss 0.9669 (0.8904) loss_zs_kd 0.4163 (0.4584) loss_oracle 0.5263 (0.5246) acc 43.7500 (49.4531) kd_loss 0.8914 (0.7522) lr 1.1253e-03 eta 0:16:22
epoch [25/50] batch [140/428] time 0.095 (0.089) data 0.000 (0.004) loss 1.9563 (1.6381) ce_loss 1.9580 (1.3903) teacher_loss 1.2196 (0.8802) loss_zs_kd 0.4855 (0.4619) loss_oracle 0.4939 (0.5269) acc 31.2500 (49.2188) kd_loss 0.8018 (0.7595) lr 1.1253e-03 eta 0:16:16
epoch [25/50] batch [160/428] time 0.080 (0.088) data 0.000 (0.004) loss 1.4744 (1.6363) ce_loss 1.3232 (1.3853) teacher_loss 0.7307 (0.8797) loss_zs_kd 0.4271 (0.4588) loss_oracle 0.5302 (0.5272) acc 56.2500 (49.6289) kd_loss 0.8834 (0.7579) lr 1.1253e-03 eta 0:16:08
epoch [25/50] batch [180/428] time 0.076 (0.088) data 0.000 (0.003) loss 1.4797 (1.6349) ce_loss 1.2510 (1.3803) teacher_loss 0.7221 (0.8817) loss_zs_kd 0.4684 (0.4543) loss_oracle 0.5234 (0.5260) acc 65.6250 (50.0000) kd_loss 0.8634 (0.7556) lr 1.1253e-03 eta 0:16:00
epoch [25/50] batch [200/428] time 0.095 (0.088) data 0.000 (0.003) loss 1.7685 (1.6388) ce_loss 1.5049 (1.3873) teacher_loss 1.0236 (0.8874) loss_zs_kd 0.4704 (0.4533) loss_oracle 0.5097 (0.5248) acc 37.5000 (49.7500) kd_loss 0.7645 (0.7568) lr 1.1253e-03 eta 0:15:58
epoch [25/50] batch [220/428] time 0.086 (0.088) data 0.000 (0.003) loss 1.4881 (1.6393) ce_loss 1.0664 (1.3850) teacher_loss 0.7483 (0.8882) loss_zs_kd 0.5025 (0.4539) loss_oracle 0.4885 (0.5242) acc 65.6250 (49.8295) kd_loss 0.7017 (0.7585) lr 1.1253e-03 eta 0:15:54
epoch [25/50] batch [240/428] time 0.086 (0.087) data 0.000 (0.003) loss 1.4926 (1.6391) ce_loss 1.3135 (1.3847) teacher_loss 0.6913 (0.8888) loss_zs_kd 0.3992 (0.4524) loss_oracle 0.6018 (0.5241) acc 50.0000 (49.7266) kd_loss 0.9060 (0.7590) lr 1.1253e-03 eta 0:15:51
epoch [25/50] batch [260/428] time 0.082 (0.087) data 0.000 (0.002) loss 1.4268 (1.6390) ce_loss 1.1172 (1.3821) teacher_loss 0.7252 (0.8896) loss_zs_kd 0.4185 (0.4517) loss_oracle 0.4924 (0.5235) acc 59.3750 (49.7837) kd_loss 0.7692 (0.7596) lr 1.1253e-03 eta 0:15:49
epoch [25/50] batch [280/428] time 0.089 (0.087) data 0.000 (0.002) loss 1.5987 (1.6400) ce_loss 1.5303 (1.3842) teacher_loss 0.8490 (0.8918) loss_zs_kd 0.4251 (0.4515) loss_oracle 0.5371 (0.5224) acc 34.3750 (49.6429) kd_loss 0.9280 (0.7592) lr 1.1253e-03 eta 0:15:46
epoch [25/50] batch [300/428] time 0.082 (0.087) data 0.000 (0.002) loss 1.5875 (1.6390) ce_loss 1.2480 (1.3810) teacher_loss 0.8825 (0.8913) loss_zs_kd 0.4943 (0.4508) loss_oracle 0.4579 (0.5223) acc 65.6250 (49.9167) kd_loss 0.6952 (0.7589) lr 1.1253e-03 eta 0:15:40
epoch [25/50] batch [320/428] time 0.087 (0.087) data 0.000 (0.002) loss 1.6332 (1.6371) ce_loss 1.3945 (1.3784) teacher_loss 0.9530 (0.8906) loss_zs_kd 0.3782 (0.4500) loss_oracle 0.4911 (0.5216) acc 46.8750 (49.9902) kd_loss 0.7486 (0.7587) lr 1.1253e-03 eta 0:15:36
epoch [25/50] batch [340/428] time 0.085 (0.087) data 0.000 (0.002) loss 1.4769 (1.6357) ce_loss 1.2051 (1.3772) teacher_loss 0.6850 (0.8886) loss_zs_kd 0.4464 (0.4504) loss_oracle 0.5687 (0.5218) acc 59.3750 (50.0735) kd_loss 0.7531 (0.7590) lr 1.1253e-03 eta 0:15:33
epoch [25/50] batch [360/428] time 0.085 (0.086) data 0.000 (0.002) loss 1.2890 (1.6339) ce_loss 1.2109 (1.3770) teacher_loss 0.6618 (0.8868) loss_zs_kd 0.3839 (0.4504) loss_oracle 0.4353 (0.5220) acc 56.2500 (50.1389) kd_loss 0.7973 (0.7594) lr 1.1253e-03 eta 0:15:29
epoch [25/50] batch [380/428] time 0.077 (0.086) data 0.000 (0.002) loss 1.6306 (1.6341) ce_loss 1.3789 (1.3786) teacher_loss 0.9695 (0.8877) loss_zs_kd 0.3792 (0.4497) loss_oracle 0.4715 (0.5215) acc 53.1250 (49.9671) kd_loss 0.7313 (0.7614) lr 1.1253e-03 eta 0:15:26
epoch [25/50] batch [400/428] time 0.093 (0.086) data 0.000 (0.002) loss 1.5652 (1.6322) ce_loss 1.2256 (1.3767) teacher_loss 0.8999 (0.8859) loss_zs_kd 0.4383 (0.4499) loss_oracle 0.4461 (0.5213) acc 56.2500 (50.0625) kd_loss 0.6783 (0.7613) lr 1.1253e-03 eta 0:15:23
epoch [25/50] batch [420/428] time 0.085 (0.086) data 0.000 (0.002) loss 1.8085 (1.6322) ce_loss 1.4336 (1.3761) teacher_loss 1.0853 (0.8864) loss_zs_kd 0.4003 (0.4495) loss_oracle 0.5231 (0.5210) acc 46.8750 (50.1116) kd_loss 0.5678 (0.7599) lr 1.1253e-03 eta 0:15:21
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,014
* accuracy: 51.3%
* error: 48.7%
* macro_f1: 38.3%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,568
* accuracy: 54.2%
* error: 45.8%
* macro_f1: 30.4%
******* Domain 1 best val acc:      51.8%, epoch: 24 *******
******* Domain 1 best val test acc: 52.4%, epoch: 24 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [26/50] batch [20/428] time 0.081 (0.119) data 0.000 (0.030) loss 1.6935 (1.6301) ce_loss 1.5332 (1.3773) teacher_loss 0.9296 (0.8724) loss_zs_kd 0.4961 (0.4718) loss_oracle 0.5159 (0.5217) acc 40.6250 (47.6562) kd_loss 0.7399 (0.7383) lr 1.0628e-03 eta 0:21:14
epoch [26/50] batch [40/428] time 0.081 (0.102) data 0.000 (0.015) loss 1.6335 (1.6372) ce_loss 1.2412 (1.3872) teacher_loss 0.9302 (0.8888) loss_zs_kd 0.4401 (0.4582) loss_oracle 0.4832 (0.5193) acc 46.8750 (48.8281) kd_loss 0.7218 (0.7443) lr 1.0628e-03 eta 0:18:08
epoch [26/50] batch [60/428] time 0.091 (0.096) data 0.001 (0.010) loss 1.9480 (1.6294) ce_loss 1.4043 (1.3782) teacher_loss 1.1851 (0.8883) loss_zs_kd 0.4353 (0.4571) loss_oracle 0.5452 (0.5126) acc 50.0000 (49.4792) kd_loss 0.7228 (0.7467) lr 1.0628e-03 eta 0:16:58
epoch [26/50] batch [80/428] time 0.081 (0.093) data 0.000 (0.008) loss 1.5876 (1.6445) ce_loss 1.4043 (1.3790) teacher_loss 0.8095 (0.9016) loss_zs_kd 0.4610 (0.4560) loss_oracle 0.5476 (0.5149) acc 43.7500 (49.5312) kd_loss 0.7476 (0.7394) lr 1.0628e-03 eta 0:16:29
epoch [26/50] batch [100/428] time 0.085 (0.092) data 0.000 (0.006) loss 1.3426 (1.6331) ce_loss 1.0820 (1.3669) teacher_loss 0.6435 (0.8948) loss_zs_kd 0.4154 (0.4480) loss_oracle 0.4914 (0.5143) acc 56.2500 (49.6875) kd_loss 0.6867 (0.7371) lr 1.0628e-03 eta 0:16:12
epoch [26/50] batch [120/428] time 0.080 (0.089) data 0.000 (0.005) loss 1.5388 (1.6263) ce_loss 1.2979 (1.3581) teacher_loss 0.7376 (0.8879) loss_zs_kd 0.4319 (0.4474) loss_oracle 0.5852 (0.5147) acc 53.1250 (50.0521) kd_loss 0.9046 (0.7348) lr 1.0628e-03 eta 0:15:46
epoch [26/50] batch [140/428] time 0.080 (0.089) data 0.000 (0.005) loss 1.6811 (1.6259) ce_loss 1.5703 (1.3561) teacher_loss 0.8865 (0.8901) loss_zs_kd 0.4595 (0.4464) loss_oracle 0.5648 (0.5126) acc 43.7500 (50.0000) kd_loss 0.8106 (0.7317) lr 1.0628e-03 eta 0:15:36
epoch [26/50] batch [160/428] time 0.083 (0.088) data 0.000 (0.004) loss 1.6038 (1.6190) ce_loss 1.2217 (1.3517) teacher_loss 0.8900 (0.8835) loss_zs_kd 0.4782 (0.4455) loss_oracle 0.4747 (0.5128) acc 50.0000 (50.5273) kd_loss 0.6412 (0.7344) lr 1.0628e-03 eta 0:15:29
epoch [26/50] batch [180/428] time 0.076 (0.088) data 0.000 (0.004) loss 1.6626 (1.6227) ce_loss 1.4092 (1.3517) teacher_loss 0.9352 (0.8863) loss_zs_kd 0.4105 (0.4476) loss_oracle 0.5221 (0.5126) acc 46.8750 (50.4688) kd_loss 0.7701 (0.7350) lr 1.0628e-03 eta 0:15:22
epoch [26/50] batch [200/428] time 0.075 (0.087) data 0.000 (0.003) loss 1.8190 (1.6278) ce_loss 1.7393 (1.3602) teacher_loss 1.1628 (0.8904) loss_zs_kd 0.3684 (0.4480) loss_oracle 0.4720 (0.5134) acc 28.1250 (49.8281) kd_loss 0.7416 (0.7391) lr 1.0628e-03 eta 0:15:14
epoch [26/50] batch [220/428] time 0.080 (0.087) data 0.000 (0.003) loss 1.5234 (1.6352) ce_loss 1.2383 (1.3705) teacher_loss 0.7981 (0.8980) loss_zs_kd 0.4242 (0.4483) loss_oracle 0.5131 (0.5130) acc 56.2500 (49.5739) kd_loss 0.6856 (0.7413) lr 1.0628e-03 eta 0:15:09
epoch [26/50] batch [240/428] time 0.071 (0.086) data 0.000 (0.003) loss 1.6824 (1.6334) ce_loss 1.2910 (1.3685) teacher_loss 0.9010 (0.8976) loss_zs_kd 0.5046 (0.4475) loss_oracle 0.5291 (0.5121) acc 46.8750 (49.7005) kd_loss 0.6602 (0.7421) lr 1.0628e-03 eta 0:15:03
epoch [26/50] batch [260/428] time 0.081 (0.086) data 0.000 (0.003) loss 1.8295 (1.6296) ce_loss 1.5674 (1.3659) teacher_loss 1.1086 (0.8928) loss_zs_kd 0.4805 (0.4494) loss_oracle 0.4806 (0.5121) acc 40.6250 (49.8798) kd_loss 0.8079 (0.7436) lr 1.0628e-03 eta 0:15:00
epoch [26/50] batch [280/428] time 0.084 (0.086) data 0.000 (0.002) loss 1.4393 (1.6256) ce_loss 1.2959 (1.3638) teacher_loss 0.6990 (0.8894) loss_zs_kd 0.4461 (0.4487) loss_oracle 0.5173 (0.5119) acc 56.2500 (49.9107) kd_loss 0.7659 (0.7457) lr 1.0628e-03 eta 0:14:53
epoch [26/50] batch [300/428] time 0.080 (0.086) data 0.000 (0.002) loss 1.5751 (1.6228) ce_loss 1.3438 (1.3602) teacher_loss 0.7550 (0.8859) loss_zs_kd 0.4453 (0.4499) loss_oracle 0.5975 (0.5119) acc 59.3750 (50.0104) kd_loss 0.6988 (0.7460) lr 1.0628e-03 eta 0:14:51
epoch [26/50] batch [320/428] time 0.084 (0.085) data 0.000 (0.002) loss 1.6074 (1.6208) ce_loss 1.1826 (1.3607) teacher_loss 0.8871 (0.8827) loss_zs_kd 0.4386 (0.4514) loss_oracle 0.5010 (0.5125) acc 56.2500 (50.1758) kd_loss 0.7755 (0.7472) lr 1.0628e-03 eta 0:14:44
epoch [26/50] batch [340/428] time 0.083 (0.085) data 0.000 (0.002) loss 1.8367 (1.6260) ce_loss 1.6807 (1.3648) teacher_loss 1.0875 (0.8873) loss_zs_kd 0.4875 (0.4524) loss_oracle 0.5055 (0.5125) acc 34.3750 (50.1654) kd_loss 0.7737 (0.7478) lr 1.0628e-03 eta 0:14:43
epoch [26/50] batch [360/428] time 0.077 (0.085) data 0.000 (0.002) loss 1.7835 (1.6254) ce_loss 1.4766 (1.3637) teacher_loss 1.0061 (0.8872) loss_zs_kd 0.5144 (0.4520) loss_oracle 0.5203 (0.5122) acc 46.8750 (50.3646) kd_loss 0.6593 (0.7477) lr 1.0628e-03 eta 0:14:38
epoch [26/50] batch [380/428] time 0.080 (0.085) data 0.000 (0.002) loss 1.6597 (1.6270) ce_loss 1.4971 (1.3664) teacher_loss 0.9665 (0.8883) loss_zs_kd 0.4532 (0.4532) loss_oracle 0.4666 (0.5121) acc 53.1250 (50.3289) kd_loss 0.6995 (0.7504) lr 1.0628e-03 eta 0:14:35
epoch [26/50] batch [400/428] time 0.080 (0.085) data 0.000 (0.002) loss 1.6762 (1.6272) ce_loss 1.4561 (1.3653) teacher_loss 0.7811 (0.8886) loss_zs_kd 0.4901 (0.4542) loss_oracle 0.6501 (0.5115) acc 40.6250 (50.3438) kd_loss 0.8626 (0.7499) lr 1.0628e-03 eta 0:14:31
epoch [26/50] batch [420/428] time 0.081 (0.085) data 0.000 (0.002) loss 1.4683 (1.6268) ce_loss 1.1719 (1.3649) teacher_loss 0.7869 (0.8883) loss_zs_kd 0.4396 (0.4545) loss_oracle 0.4617 (0.5112) acc 59.3750 (50.3795) kd_loss 0.6730 (0.7494) lr 1.0628e-03 eta 0:14:28
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,999
* accuracy: 51.0%
* error: 49.0%
* macro_f1: 38.5%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,568
* accuracy: 54.2%
* error: 45.8%
* macro_f1: 30.5%
******* Domain 1 best val acc:      51.8%, epoch: 24 *******
******* Domain 1 best val test acc: 52.4%, epoch: 24 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [27/50] batch [20/428] time 0.089 (0.105) data 0.000 (0.030) loss 1.6996 (1.6648) ce_loss 1.5303 (1.3734) teacher_loss 0.9378 (0.9290) loss_zs_kd 0.4670 (0.4678) loss_oracle 0.5283 (0.5019) acc 46.8750 (52.1875) kd_loss 0.7140 (0.7151) lr 1.0000e-03 eta 0:17:54
epoch [27/50] batch [40/428] time 0.078 (0.094) data 0.000 (0.015) loss 1.9825 (1.6491) ce_loss 1.6338 (1.3445) teacher_loss 1.2665 (0.9149) loss_zs_kd 0.4151 (0.4633) loss_oracle 0.5084 (0.5025) acc 53.1250 (52.4219) kd_loss 0.7308 (0.7280) lr 1.0000e-03 eta 0:16:05
epoch [27/50] batch [60/428] time 0.078 (0.091) data 0.001 (0.010) loss 1.7848 (1.6322) ce_loss 1.3701 (1.3421) teacher_loss 1.0737 (0.8989) loss_zs_kd 0.4441 (0.4552) loss_oracle 0.4891 (0.5057) acc 46.8750 (51.7188) kd_loss 0.5449 (0.7282) lr 1.0000e-03 eta 0:15:25
epoch [27/50] batch [80/428] time 0.079 (0.089) data 0.000 (0.008) loss 1.6854 (1.6371) ce_loss 1.5410 (1.3439) teacher_loss 0.9947 (0.9038) loss_zs_kd 0.4255 (0.4568) loss_oracle 0.4780 (0.5049) acc 40.6250 (51.4062) kd_loss 0.7484 (0.7314) lr 1.0000e-03 eta 0:15:04
epoch [27/50] batch [100/428] time 0.083 (0.088) data 0.000 (0.006) loss 1.6711 (1.6354) ce_loss 1.3359 (1.3404) teacher_loss 0.9683 (0.9071) loss_zs_kd 0.4239 (0.4539) loss_oracle 0.4909 (0.5013) acc 53.1250 (51.1250) kd_loss 0.6249 (0.7245) lr 1.0000e-03 eta 0:14:51
epoch [27/50] batch [120/428] time 0.081 (0.087) data 0.000 (0.005) loss 1.6516 (1.6246) ce_loss 1.2061 (1.3309) teacher_loss 0.8978 (0.8999) loss_zs_kd 0.5000 (0.4520) loss_oracle 0.5038 (0.4987) acc 56.2500 (51.4062) kd_loss 0.7099 (0.7206) lr 1.0000e-03 eta 0:14:47
epoch [27/50] batch [140/428] time 0.075 (0.087) data 0.000 (0.005) loss 1.5286 (1.6179) ce_loss 1.2139 (1.3235) teacher_loss 0.8046 (0.8926) loss_zs_kd 0.4170 (0.4558) loss_oracle 0.5155 (0.4974) acc 53.1250 (51.8304) kd_loss 0.7916 (0.7186) lr 1.0000e-03 eta 0:14:36
epoch [27/50] batch [160/428] time 0.071 (0.086) data 0.000 (0.004) loss 1.4876 (1.6146) ce_loss 1.2764 (1.3253) teacher_loss 0.7240 (0.8905) loss_zs_kd 0.5251 (0.4556) loss_oracle 0.5011 (0.4962) acc 59.3750 (51.9336) kd_loss 0.8182 (0.7185) lr 1.0000e-03 eta 0:14:29
epoch [27/50] batch [180/428] time 0.082 (0.085) data 0.000 (0.004) loss 1.5780 (1.6130) ce_loss 1.3105 (1.3274) teacher_loss 0.8410 (0.8885) loss_zs_kd 0.4412 (0.4581) loss_oracle 0.5165 (0.4955) acc 59.3750 (51.9444) kd_loss 0.7329 (0.7177) lr 1.0000e-03 eta 0:14:22
epoch [27/50] batch [200/428] time 0.081 (0.085) data 0.000 (0.003) loss 1.4360 (1.6139) ce_loss 1.0586 (1.3279) teacher_loss 0.7586 (0.8920) loss_zs_kd 0.3578 (0.4563) loss_oracle 0.4986 (0.4938) acc 56.2500 (51.7500) kd_loss 0.6142 (0.7168) lr 1.0000e-03 eta 0:14:13
epoch [27/50] batch [220/428] time 0.089 (0.084) data 0.000 (0.003) loss 1.6637 (1.6188) ce_loss 1.6299 (1.3360) teacher_loss 0.9595 (0.8968) loss_zs_kd 0.4458 (0.4582) loss_oracle 0.4813 (0.4930) acc 43.7500 (51.5909) kd_loss 0.7402 (0.7159) lr 1.0000e-03 eta 0:14:09
epoch [27/50] batch [240/428] time 0.080 (0.085) data 0.000 (0.003) loss 1.7343 (1.6192) ce_loss 1.5537 (1.3378) teacher_loss 0.9887 (0.8966) loss_zs_kd 0.4857 (0.4592) loss_oracle 0.5027 (0.4930) acc 46.8750 (51.4062) kd_loss 0.7496 (0.7175) lr 1.0000e-03 eta 0:14:08
epoch [27/50] batch [260/428] time 0.079 (0.084) data 0.000 (0.003) loss 1.6466 (1.6210) ce_loss 1.2266 (1.3383) teacher_loss 0.9507 (0.8984) loss_zs_kd 0.5085 (0.4604) loss_oracle 0.4416 (0.4924) acc 65.6250 (51.3462) kd_loss 0.7692 (0.7177) lr 1.0000e-03 eta 0:14:03
epoch [27/50] batch [280/428] time 0.084 (0.084) data 0.000 (0.002) loss 1.6605 (1.6220) ce_loss 1.3926 (1.3387) teacher_loss 0.9657 (0.8996) loss_zs_kd 0.4620 (0.4596) loss_oracle 0.4638 (0.4926) acc 56.2500 (51.4955) kd_loss 0.7293 (0.7162) lr 1.0000e-03 eta 0:14:01
epoch [27/50] batch [300/428] time 0.070 (0.084) data 0.000 (0.002) loss 1.5925 (1.6219) ce_loss 1.4141 (1.3387) teacher_loss 0.8564 (0.9008) loss_zs_kd 0.4604 (0.4586) loss_oracle 0.5060 (0.4917) acc 46.8750 (51.5521) kd_loss 0.6685 (0.7142) lr 1.0000e-03 eta 0:13:58
epoch [27/50] batch [320/428] time 0.083 (0.084) data 0.000 (0.002) loss 1.6934 (1.6217) ce_loss 1.5361 (1.3381) teacher_loss 0.9510 (0.9008) loss_zs_kd 0.5079 (0.4592) loss_oracle 0.4885 (0.4913) acc 50.0000 (51.6016) kd_loss 0.7243 (0.7148) lr 1.0000e-03 eta 0:13:55
epoch [27/50] batch [340/428] time 0.084 (0.084) data 0.000 (0.002) loss 1.6586 (1.6231) ce_loss 1.3779 (1.3407) teacher_loss 0.9632 (0.9035) loss_zs_kd 0.4583 (0.4595) loss_oracle 0.4661 (0.4898) acc 50.0000 (51.5349) kd_loss 0.7197 (0.7144) lr 1.0000e-03 eta 0:13:52
epoch [27/50] batch [360/428] time 0.082 (0.084) data 0.000 (0.002) loss 1.6576 (1.6241) ce_loss 1.3926 (1.3427) teacher_loss 0.9343 (0.9055) loss_zs_kd 0.4774 (0.4589) loss_oracle 0.4846 (0.4891) acc 59.3750 (51.5017) kd_loss 0.6593 (0.7134) lr 1.0000e-03 eta 0:13:49
epoch [27/50] batch [380/428] time 0.083 (0.084) data 0.000 (0.002) loss 1.6546 (1.6229) ce_loss 1.2090 (1.3423) teacher_loss 1.0076 (0.9054) loss_zs_kd 0.4379 (0.4579) loss_oracle 0.4281 (0.4885) acc 43.7500 (51.4720) kd_loss 0.6190 (0.7139) lr 1.0000e-03 eta 0:13:48
epoch [27/50] batch [400/428] time 0.083 (0.084) data 0.000 (0.002) loss 1.7461 (1.6248) ce_loss 1.6523 (1.3409) teacher_loss 1.0227 (0.9074) loss_zs_kd 0.4840 (0.4579) loss_oracle 0.4814 (0.4885) acc 37.5000 (51.5547) kd_loss 0.8568 (0.7140) lr 1.0000e-03 eta 0:13:46
epoch [27/50] batch [420/428] time 0.075 (0.084) data 0.000 (0.002) loss 1.5769 (1.6238) ce_loss 1.5010 (1.3402) teacher_loss 0.9673 (0.9080) loss_zs_kd 0.3608 (0.4574) loss_oracle 0.4292 (0.4870) acc 46.8750 (51.7113) kd_loss 0.7582 (0.7129) lr 1.0000e-03 eta 0:13:43
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,142
* accuracy: 53.5%
* error: 46.5%
* macro_f1: 38.9%
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,462
* accuracy: 51.9%
* error: 48.1%
* macro_f1: 27.6%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [28/50] batch [20/428] time 0.085 (0.114) data 0.000 (0.028) loss 1.8102 (1.5931) ce_loss 1.4395 (1.2863) teacher_loss 1.1380 (0.8671) loss_zs_kd 0.4332 (0.4784) loss_oracle 0.4556 (0.4867) acc 53.1250 (53.5938) kd_loss 0.6861 (0.7016) lr 9.3721e-04 eta 0:18:43
epoch [28/50] batch [40/428] time 0.083 (0.096) data 0.000 (0.014) loss 1.8761 (1.6327) ce_loss 1.5840 (1.3313) teacher_loss 1.2383 (0.9252) loss_zs_kd 0.4485 (0.4571) loss_oracle 0.4135 (0.4790) acc 46.8750 (52.0312) kd_loss 0.7298 (0.6945) lr 9.3721e-04 eta 0:15:39
epoch [28/50] batch [60/428] time 0.089 (0.092) data 0.001 (0.009) loss 1.6392 (1.6342) ce_loss 1.3574 (1.3233) teacher_loss 0.9116 (0.9232) loss_zs_kd 0.4760 (0.4562) loss_oracle 0.4896 (0.4829) acc 53.1250 (52.4479) kd_loss 0.7403 (0.6914) lr 9.3721e-04 eta 0:15:01
epoch [28/50] batch [80/428] time 0.078 (0.090) data 0.000 (0.007) loss 1.5386 (1.6200) ce_loss 1.1045 (1.3102) teacher_loss 0.8179 (0.9118) loss_zs_kd 0.4413 (0.4510) loss_oracle 0.5000 (0.4827) acc 59.3750 (52.8125) kd_loss 0.6477 (0.6926) lr 9.3721e-04 eta 0:14:43
epoch [28/50] batch [100/428] time 0.089 (0.089) data 0.000 (0.006) loss 1.4839 (1.6272) ce_loss 1.2607 (1.3155) teacher_loss 0.7564 (0.9191) loss_zs_kd 0.4579 (0.4510) loss_oracle 0.4985 (0.4826) acc 56.2500 (52.6875) kd_loss 0.7626 (0.6929) lr 9.3721e-04 eta 0:14:30
epoch [28/50] batch [120/428] time 0.088 (0.089) data 0.000 (0.005) loss 1.8397 (1.6379) ce_loss 1.5645 (1.3238) teacher_loss 1.1292 (0.9303) loss_zs_kd 0.3988 (0.4471) loss_oracle 0.5111 (0.4841) acc 43.7500 (52.2135) kd_loss 0.6863 (0.6932) lr 9.3721e-04 eta 0:14:25
epoch [28/50] batch [140/428] time 0.083 (0.088) data 0.000 (0.004) loss 1.5713 (1.6390) ce_loss 1.2275 (1.3264) teacher_loss 0.8470 (0.9321) loss_zs_kd 0.4976 (0.4453) loss_oracle 0.4755 (0.4843) acc 59.3750 (51.9196) kd_loss 0.7652 (0.6930) lr 9.3721e-04 eta 0:14:12
epoch [28/50] batch [160/428] time 0.088 (0.088) data 0.000 (0.004) loss 1.5822 (1.6420) ce_loss 1.2139 (1.3308) teacher_loss 0.8075 (0.9326) loss_zs_kd 0.4769 (0.4474) loss_oracle 0.5363 (0.4857) acc 56.2500 (51.7383) kd_loss 0.7929 (0.6978) lr 9.3721e-04 eta 0:14:07
epoch [28/50] batch [180/428] time 0.079 (0.087) data 0.000 (0.003) loss 1.6171 (1.6415) ce_loss 1.1094 (1.3271) teacher_loss 0.9179 (0.9293) loss_zs_kd 0.5574 (0.4500) loss_oracle 0.4204 (0.4872) acc 53.1250 (51.5625) kd_loss 0.6857 (0.7011) lr 9.3721e-04 eta 0:14:04
epoch [28/50] batch [200/428] time 0.086 (0.087) data 0.000 (0.003) loss 1.6489 (1.6412) ce_loss 1.3662 (1.3264) teacher_loss 0.9217 (0.9267) loss_zs_kd 0.4218 (0.4515) loss_oracle 0.5163 (0.4887) acc 40.6250 (51.4688) kd_loss 0.7064 (0.7049) lr 9.3721e-04 eta 0:13:55
epoch [28/50] batch [220/428] time 0.085 (0.086) data 0.001 (0.003) loss 2.1079 (1.6469) ce_loss 1.7158 (1.3355) teacher_loss 1.3478 (0.9316) loss_zs_kd 0.4631 (0.4509) loss_oracle 0.5286 (0.4898) acc 43.7500 (51.3636) kd_loss 0.6939 (0.7102) lr 9.3721e-04 eta 0:13:51
epoch [28/50] batch [240/428] time 0.084 (0.086) data 0.000 (0.003) loss 1.4956 (1.6417) ce_loss 1.0986 (1.3296) teacher_loss 0.7326 (0.9251) loss_zs_kd 0.4897 (0.4534) loss_oracle 0.5181 (0.4899) acc 56.2500 (51.6146) kd_loss 0.6512 (0.7128) lr 9.3721e-04 eta 0:13:48
epoch [28/50] batch [260/428] time 0.076 (0.086) data 0.000 (0.002) loss 1.7007 (1.6385) ce_loss 1.4131 (1.3240) teacher_loss 0.9906 (0.9194) loss_zs_kd 0.4318 (0.4549) loss_oracle 0.4941 (0.4916) acc 46.8750 (51.6947) kd_loss 0.7218 (0.7171) lr 9.3721e-04 eta 0:13:46
epoch [28/50] batch [280/428] time 0.086 (0.086) data 0.000 (0.002) loss 1.8040 (1.6361) ce_loss 1.5381 (1.3255) teacher_loss 1.0512 (0.9161) loss_zs_kd 0.4515 (0.4556) loss_oracle 0.5270 (0.4922) acc 37.5000 (51.6629) kd_loss 0.6922 (0.7218) lr 9.3721e-04 eta 0:13:44
epoch [28/50] batch [300/428] time 0.082 (0.086) data 0.000 (0.002) loss 1.5396 (1.6365) ce_loss 1.0762 (1.3260) teacher_loss 0.8236 (0.9149) loss_zs_kd 0.5068 (0.4574) loss_oracle 0.4626 (0.4930) acc 62.5000 (51.5729) kd_loss 0.6491 (0.7247) lr 9.3721e-04 eta 0:13:43
epoch [28/50] batch [320/428] time 0.083 (0.086) data 0.000 (0.002) loss 1.5953 (1.6368) ce_loss 1.2451 (1.3290) teacher_loss 0.8650 (0.9140) loss_zs_kd 0.4627 (0.4591) loss_oracle 0.4989 (0.4933) acc 62.5000 (51.5723) kd_loss 0.8608 (0.7313) lr 9.3721e-04 eta 0:13:40
epoch [28/50] batch [340/428] time 0.084 (0.086) data 0.000 (0.002) loss 1.4904 (1.6375) ce_loss 1.2568 (1.3307) teacher_loss 0.7991 (0.9133) loss_zs_kd 0.4292 (0.4612) loss_oracle 0.4767 (0.4936) acc 53.1250 (51.4246) kd_loss 0.8556 (0.7379) lr 9.3721e-04 eta 0:13:38
epoch [28/50] batch [360/428] time 0.086 (0.086) data 0.000 (0.002) loss 1.2674 (1.6376) ce_loss 0.8306 (1.3323) teacher_loss 0.6083 (0.9126) loss_zs_kd 0.3815 (0.4621) loss_oracle 0.4684 (0.4939) acc 68.7500 (51.4670) kd_loss 0.6878 (0.7412) lr 9.3721e-04 eta 0:13:34
epoch [28/50] batch [380/428] time 0.086 (0.086) data 0.000 (0.002) loss 1.4737 (1.6355) ce_loss 1.2207 (1.3324) teacher_loss 0.7024 (0.9103) loss_zs_kd 0.5217 (0.4620) loss_oracle 0.5104 (0.4942) acc 59.3750 (51.4803) kd_loss 0.8995 (0.7463) lr 9.3721e-04 eta 0:13:30
epoch [28/50] batch [400/428] time 0.091 (0.086) data 0.000 (0.002) loss 1.9908 (1.6365) ce_loss 1.7695 (1.3329) teacher_loss 1.2066 (0.9103) loss_zs_kd 0.4378 (0.4627) loss_oracle 0.5653 (0.4949) acc 46.8750 (51.4922) kd_loss 0.9148 (0.7498) lr 9.3721e-04 eta 0:13:27
epoch [28/50] batch [420/428] time 0.077 (0.085) data 0.000 (0.002) loss 1.6791 (1.6377) ce_loss 1.1797 (1.3354) teacher_loss 0.9450 (0.9103) loss_zs_kd 0.4892 (0.4628) loss_oracle 0.4895 (0.4960) acc 50.0000 (51.4658) kd_loss 0.7349 (0.7547) lr 9.3721e-04 eta 0:13:23
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,990
* accuracy: 50.9%
* error: 49.1%
* macro_f1: 37.1%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,441
* accuracy: 51.5%
* error: 48.5%
* macro_f1: 30.8%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [29/50] batch [20/428] time 0.081 (0.113) data 0.000 (0.026) loss 1.7349 (1.6767) ce_loss 1.2695 (1.3754) teacher_loss 1.0617 (0.9318) loss_zs_kd 0.4609 (0.4915) loss_oracle 0.4427 (0.4991) acc 56.2500 (49.3750) kd_loss 0.7328 (0.8061) lr 8.7467e-04 eta 0:17:39
epoch [29/50] batch [40/428] time 0.084 (0.099) data 0.000 (0.013) loss 1.5564 (1.6320) ce_loss 1.3750 (1.3417) teacher_loss 0.9125 (0.8923) loss_zs_kd 0.4246 (0.4884) loss_oracle 0.4316 (0.4955) acc 46.8750 (50.0781) kd_loss 0.7855 (0.8253) lr 8.7467e-04 eta 0:15:27
epoch [29/50] batch [60/428] time 0.085 (0.094) data 0.001 (0.009) loss 1.6140 (1.6293) ce_loss 1.6309 (1.3302) teacher_loss 0.9365 (0.8975) loss_zs_kd 0.3866 (0.4738) loss_oracle 0.4843 (0.4949) acc 34.3750 (51.8750) kd_loss 0.9237 (0.8197) lr 8.7467e-04 eta 0:14:38
epoch [29/50] batch [80/428] time 0.078 (0.092) data 0.000 (0.007) loss 1.5657 (1.6282) ce_loss 1.2744 (1.3392) teacher_loss 0.6831 (0.8898) loss_zs_kd 0.6016 (0.4796) loss_oracle 0.5818 (0.4986) acc 53.1250 (51.6016) kd_loss 0.9007 (0.8286) lr 8.7467e-04 eta 0:14:15
epoch [29/50] batch [100/428] time 0.091 (0.090) data 0.000 (0.005) loss 1.5585 (1.6205) ce_loss 1.2266 (1.3280) teacher_loss 0.7542 (0.8839) loss_zs_kd 0.4842 (0.4820) loss_oracle 0.5623 (0.4956) acc 46.8750 (51.5625) kd_loss 0.8819 (0.8293) lr 8.7467e-04 eta 0:13:55
epoch [29/50] batch [120/428] time 0.077 (0.089) data 0.000 (0.005) loss 1.6397 (1.6294) ce_loss 1.4355 (1.3439) teacher_loss 0.9055 (0.8901) loss_zs_kd 0.5139 (0.4840) loss_oracle 0.4773 (0.4972) acc 56.2500 (51.0938) kd_loss 0.7126 (0.8329) lr 8.7467e-04 eta 0:13:46
epoch [29/50] batch [140/428] time 0.086 (0.088) data 0.000 (0.004) loss 1.5166 (1.6300) ce_loss 1.2451 (1.3488) teacher_loss 0.7685 (0.8885) loss_zs_kd 0.4467 (0.4846) loss_oracle 0.5248 (0.4992) acc 59.3750 (50.9375) kd_loss 0.7980 (0.8358) lr 8.7467e-04 eta 0:13:39
epoch [29/50] batch [160/428] time 0.095 (0.088) data 0.000 (0.003) loss 1.7028 (1.6321) ce_loss 1.4717 (1.3595) teacher_loss 0.9415 (0.8923) loss_zs_kd 0.5108 (0.4842) loss_oracle 0.5060 (0.4978) acc 40.6250 (50.6055) kd_loss 0.9664 (0.8435) lr 8.7467e-04 eta 0:13:36
epoch [29/50] batch [180/428] time 0.081 (0.088) data 0.000 (0.003) loss 1.3726 (1.6311) ce_loss 1.1748 (1.3608) teacher_loss 0.6341 (0.8906) loss_zs_kd 0.4989 (0.4839) loss_oracle 0.4890 (0.4985) acc 53.1250 (50.5208) kd_loss 0.8917 (0.8460) lr 8.7467e-04 eta 0:13:31
epoch [29/50] batch [200/428] time 0.082 (0.088) data 0.000 (0.003) loss 1.5339 (1.6267) ce_loss 1.2275 (1.3551) teacher_loss 0.7873 (0.8865) loss_zs_kd 0.4162 (0.4837) loss_oracle 0.5385 (0.4984) acc 62.5000 (50.9531) kd_loss 0.9024 (0.8430) lr 8.7467e-04 eta 0:13:27
epoch [29/50] batch [220/428] time 0.083 (0.087) data 0.000 (0.003) loss 1.6959 (1.6246) ce_loss 1.3652 (1.3505) teacher_loss 0.8967 (0.8854) loss_zs_kd 0.5422 (0.4806) loss_oracle 0.5280 (0.4990) acc 46.8750 (51.0653) kd_loss 0.8266 (0.8399) lr 8.7467e-04 eta 0:13:21
epoch [29/50] batch [240/428] time 0.089 (0.087) data 0.000 (0.002) loss 1.6284 (1.6260) ce_loss 1.4688 (1.3496) teacher_loss 0.8506 (0.8860) loss_zs_kd 0.4507 (0.4784) loss_oracle 0.5524 (0.5008) acc 43.7500 (51.0286) kd_loss 0.8044 (0.8373) lr 8.7467e-04 eta 0:13:18
epoch [29/50] batch [260/428] time 0.083 (0.087) data 0.000 (0.002) loss 1.4604 (1.6263) ce_loss 1.2168 (1.3529) teacher_loss 0.7241 (0.8851) loss_zs_kd 0.4434 (0.4777) loss_oracle 0.5146 (0.5024) acc 53.1250 (50.8654) kd_loss 0.8602 (0.8368) lr 8.7467e-04 eta 0:13:15
epoch [29/50] batch [280/428] time 0.076 (0.087) data 0.000 (0.002) loss 1.8213 (1.6293) ce_loss 1.6045 (1.3570) teacher_loss 1.0420 (0.8881) loss_zs_kd 0.4586 (0.4769) loss_oracle 0.5500 (0.5027) acc 43.7500 (50.7366) kd_loss 0.8190 (0.8334) lr 8.7467e-04 eta 0:13:13
epoch [29/50] batch [300/428] time 0.087 (0.086) data 0.000 (0.002) loss 1.7996 (1.6316) ce_loss 1.7090 (1.3584) teacher_loss 0.9375 (0.8884) loss_zs_kd 0.5730 (0.4770) loss_oracle 0.5756 (0.5047) acc 31.2500 (50.5938) kd_loss 0.8671 (0.8316) lr 8.7467e-04 eta 0:13:06
epoch [29/50] batch [320/428] time 0.084 (0.086) data 0.000 (0.002) loss 1.4149 (1.6293) ce_loss 1.1289 (1.3572) teacher_loss 0.6441 (0.8859) loss_zs_kd 0.4847 (0.4765) loss_oracle 0.5284 (0.5052) acc 56.2500 (50.6836) kd_loss 0.8719 (0.8310) lr 8.7467e-04 eta 0:13:04
epoch [29/50] batch [340/428] time 0.083 (0.086) data 0.000 (0.002) loss 1.5094 (1.6286) ce_loss 1.1348 (1.3563) teacher_loss 0.7648 (0.8843) loss_zs_kd 0.4631 (0.4761) loss_oracle 0.5130 (0.5063) acc 59.3750 (50.6985) kd_loss 0.8225 (0.8306) lr 8.7467e-04 eta 0:13:01
epoch [29/50] batch [360/428] time 0.076 (0.086) data 0.000 (0.002) loss 1.5745 (1.6326) ce_loss 1.3184 (1.3592) teacher_loss 0.7828 (0.8875) loss_zs_kd 0.4512 (0.4755) loss_oracle 0.5661 (0.5074) acc 53.1250 (50.5729) kd_loss 0.9407 (0.8314) lr 8.7467e-04 eta 0:12:58
epoch [29/50] batch [380/428] time 0.085 (0.086) data 0.000 (0.002) loss 1.5990 (1.6341) ce_loss 1.4160 (1.3595) teacher_loss 0.8955 (0.8890) loss_zs_kd 0.4046 (0.4749) loss_oracle 0.5011 (0.5077) acc 46.8750 (50.6086) kd_loss 0.8477 (0.8308) lr 8.7467e-04 eta 0:12:55
epoch [29/50] batch [400/428] time 0.074 (0.086) data 0.000 (0.002) loss 1.6827 (1.6366) ce_loss 1.2217 (1.3620) teacher_loss 0.9945 (0.8908) loss_zs_kd 0.4438 (0.4746) loss_oracle 0.4663 (0.5085) acc 62.5000 (50.6250) kd_loss 0.7099 (0.8322) lr 8.7467e-04 eta 0:12:52
epoch [29/50] batch [420/428] time 0.076 (0.085) data 0.000 (0.002) loss 1.6312 (1.6368) ce_loss 1.4326 (1.3636) teacher_loss 0.8310 (0.8904) loss_zs_kd 0.4761 (0.4738) loss_oracle 0.5621 (0.5095) acc 40.6250 (50.4539) kd_loss 0.9245 (0.8339) lr 8.7467e-04 eta 0:12:48
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,074
* accuracy: 52.3%
* error: 47.7%
* macro_f1: 37.4%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,266
* accuracy: 47.8%
* error: 52.2%
* macro_f1: 29.9%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [30/50] batch [20/428] time 0.080 (0.117) data 0.000 (0.030) loss 1.4879 (1.6689) ce_loss 1.4326 (1.4016) teacher_loss 0.7156 (0.9266) loss_zs_kd 0.4436 (0.4701) loss_oracle 0.5505 (0.5072) acc 40.6250 (48.9062) kd_loss 0.9324 (0.8485) lr 8.1262e-04 eta 0:17:27
epoch [30/50] batch [40/428] time 0.087 (0.098) data 0.000 (0.015) loss 1.7953 (1.6699) ce_loss 1.5146 (1.3939) teacher_loss 1.0373 (0.9326) loss_zs_kd 0.5256 (0.4676) loss_oracle 0.4952 (0.5035) acc 46.8750 (49.6094) kd_loss 0.7530 (0.8589) lr 8.1262e-04 eta 0:14:38
epoch [30/50] batch [60/428] time 0.084 (0.094) data 0.000 (0.010) loss 1.7327 (1.6587) ce_loss 1.5830 (1.3862) teacher_loss 0.9944 (0.9296) loss_zs_kd 0.3984 (0.4606) loss_oracle 0.5392 (0.4988) acc 50.0000 (50.4167) kd_loss 0.8991 (0.8455) lr 8.1262e-04 eta 0:13:57
epoch [30/50] batch [80/428] time 0.082 (0.091) data 0.000 (0.008) loss 1.4351 (1.6572) ce_loss 1.2480 (1.3768) teacher_loss 0.7272 (0.9262) loss_zs_kd 0.4374 (0.4635) loss_oracle 0.4892 (0.4992) acc 59.3750 (51.0938) kd_loss 0.8929 (0.8348) lr 8.1262e-04 eta 0:13:34
epoch [30/50] batch [100/428] time 0.076 (0.089) data 0.000 (0.006) loss 1.6251 (1.6594) ce_loss 1.4053 (1.3825) teacher_loss 0.9047 (0.9240) loss_zs_kd 0.4765 (0.4652) loss_oracle 0.4822 (0.5028) acc 46.8750 (51.2500) kd_loss 0.8203 (0.8339) lr 8.1262e-04 eta 0:13:08
epoch [30/50] batch [120/428] time 0.087 (0.087) data 0.000 (0.005) loss 1.2459 (1.6527) ce_loss 1.1152 (1.3824) teacher_loss 0.5602 (0.9157) loss_zs_kd 0.4566 (0.4661) loss_oracle 0.4574 (0.5039) acc 68.7500 (51.1979) kd_loss 0.7355 (0.8305) lr 8.1262e-04 eta 0:12:54
epoch [30/50] batch [140/428] time 0.088 (0.087) data 0.000 (0.005) loss 1.5548 (1.6416) ce_loss 1.2754 (1.3719) teacher_loss 0.8519 (0.9054) loss_zs_kd 0.4920 (0.4656) loss_oracle 0.4569 (0.5034) acc 50.0000 (51.4732) kd_loss 0.7787 (0.8277) lr 8.1262e-04 eta 0:12:50
epoch [30/50] batch [160/428] time 0.084 (0.087) data 0.000 (0.004) loss 1.7419 (1.6414) ce_loss 1.5674 (1.3771) teacher_loss 1.0345 (0.9059) loss_zs_kd 0.3791 (0.4625) loss_oracle 0.5178 (0.5042) acc 40.6250 (51.0156) kd_loss 0.7604 (0.8289) lr 8.1262e-04 eta 0:12:45
epoch [30/50] batch [180/428] time 0.088 (0.087) data 0.000 (0.004) loss 1.4945 (1.6403) ce_loss 1.4131 (1.3755) teacher_loss 0.6974 (0.9006) loss_zs_kd 0.3993 (0.4652) loss_oracle 0.5974 (0.5071) acc 59.3750 (51.1458) kd_loss 0.8923 (0.8279) lr 8.1262e-04 eta 0:12:43
epoch [30/50] batch [200/428] time 0.083 (0.086) data 0.000 (0.003) loss 1.7467 (1.6398) ce_loss 1.4893 (1.3764) teacher_loss 0.8810 (0.8977) loss_zs_kd 0.5389 (0.4673) loss_oracle 0.5962 (0.5085) acc 34.3750 (51.0000) kd_loss 0.9087 (0.8284) lr 8.1262e-04 eta 0:12:40
epoch [30/50] batch [220/428] time 0.076 (0.086) data 0.000 (0.003) loss 1.5093 (1.6327) ce_loss 1.2939 (1.3674) teacher_loss 0.7426 (0.8891) loss_zs_kd 0.5364 (0.4683) loss_oracle 0.4984 (0.5095) acc 40.6250 (51.0795) kd_loss 0.8554 (0.8260) lr 8.1262e-04 eta 0:12:36
epoch [30/50] batch [240/428] time 0.074 (0.086) data 0.000 (0.003) loss 1.5817 (1.6381) ce_loss 1.4854 (1.3729) teacher_loss 0.8024 (0.8927) loss_zs_kd 0.4744 (0.4684) loss_oracle 0.5421 (0.5113) acc 40.6250 (51.0026) kd_loss 0.7882 (0.8253) lr 8.1262e-04 eta 0:12:31
epoch [30/50] batch [260/428] time 0.079 (0.085) data 0.000 (0.003) loss 1.3846 (1.6325) ce_loss 1.1924 (1.3661) teacher_loss 0.7543 (0.8876) loss_zs_kd 0.4027 (0.4666) loss_oracle 0.4289 (0.5115) acc 56.2500 (51.1298) kd_loss 0.6343 (0.8223) lr 8.1262e-04 eta 0:12:23
epoch [30/50] batch [280/428] time 0.082 (0.085) data 0.000 (0.002) loss 1.6548 (1.6322) ce_loss 1.1211 (1.3646) teacher_loss 0.9808 (0.8883) loss_zs_kd 0.4289 (0.4659) loss_oracle 0.4595 (0.5110) acc 65.6250 (51.1161) kd_loss 0.5775 (0.8197) lr 8.1262e-04 eta 0:12:21
epoch [30/50] batch [300/428] time 0.090 (0.085) data 0.000 (0.002) loss 1.4631 (1.6321) ce_loss 1.0723 (1.3654) teacher_loss 0.8357 (0.8883) loss_zs_kd 0.4204 (0.4645) loss_oracle 0.4172 (0.5115) acc 62.5000 (51.2188) kd_loss 0.6335 (0.8183) lr 8.1262e-04 eta 0:12:20
epoch [30/50] batch [320/428] time 0.089 (0.085) data 0.000 (0.002) loss 1.6207 (1.6319) ce_loss 1.2734 (1.3667) teacher_loss 0.8096 (0.8892) loss_zs_kd 0.5249 (0.4635) loss_oracle 0.5487 (0.5110) acc 59.3750 (51.2012) kd_loss 0.8757 (0.8166) lr 8.1262e-04 eta 0:12:18
epoch [30/50] batch [340/428] time 0.089 (0.085) data 0.000 (0.002) loss 1.4847 (1.6312) ce_loss 1.4199 (1.3671) teacher_loss 0.7144 (0.8887) loss_zs_kd 0.4871 (0.4625) loss_oracle 0.5268 (0.5113) acc 56.2500 (51.2592) kd_loss 0.8212 (0.8158) lr 8.1262e-04 eta 0:12:16
epoch [30/50] batch [360/428] time 0.082 (0.085) data 0.000 (0.002) loss 1.5229 (1.6345) ce_loss 1.3076 (1.3689) teacher_loss 0.8224 (0.8911) loss_zs_kd 0.4732 (0.4628) loss_oracle 0.4639 (0.5120) acc 43.7500 (51.2500) kd_loss 0.8711 (0.8148) lr 8.1262e-04 eta 0:12:15
epoch [30/50] batch [380/428] time 0.094 (0.085) data 0.000 (0.002) loss 1.6531 (1.6338) ce_loss 1.3066 (1.3685) teacher_loss 0.9644 (0.8903) loss_zs_kd 0.4943 (0.4627) loss_oracle 0.4416 (0.5121) acc 56.2500 (51.2747) kd_loss 0.7448 (0.8139) lr 8.1262e-04 eta 0:12:13
epoch [30/50] batch [400/428] time 0.086 (0.085) data 0.000 (0.002) loss 1.4934 (1.6317) ce_loss 1.3047 (1.3659) teacher_loss 0.7688 (0.8888) loss_zs_kd 0.3730 (0.4625) loss_oracle 0.5380 (0.5117) acc 53.1250 (51.3203) kd_loss 0.8667 (0.8111) lr 8.1262e-04 eta 0:12:11
epoch [30/50] batch [420/428] time 0.078 (0.085) data 0.000 (0.002) loss 1.7439 (1.6344) ce_loss 1.5010 (1.3683) teacher_loss 1.0540 (0.8903) loss_zs_kd 0.3471 (0.4620) loss_oracle 0.5164 (0.5131) acc 50.0000 (51.2351) kd_loss 0.7542 (0.8094) lr 8.1262e-04 eta 0:12:09
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,949
* accuracy: 50.2%
* error: 49.8%
* macro_f1: 37.8%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,627
* accuracy: 55.4%
* error: 44.6%
* macro_f1: 32.3%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [31/50] batch [20/428] time 0.072 (0.111) data 0.000 (0.026) loss 1.9023 (1.6936) ce_loss 1.5449 (1.4318) teacher_loss 1.1122 (0.9513) loss_zs_kd 0.5144 (0.4632) loss_oracle 0.5329 (0.5107) acc 43.7500 (47.5000) kd_loss 0.7718 (0.7867) lr 7.5131e-04 eta 0:15:50
epoch [31/50] batch [40/428] time 0.086 (0.096) data 0.000 (0.013) loss 1.4608 (1.6638) ce_loss 1.3281 (1.3972) teacher_loss 0.7335 (0.9206) loss_zs_kd 0.4521 (0.4689) loss_oracle 0.5013 (0.5088) acc 50.0000 (49.5312) kd_loss 0.7730 (0.7910) lr 7.5131e-04 eta 0:13:38
epoch [31/50] batch [60/428] time 0.077 (0.090) data 0.000 (0.009) loss 1.5764 (1.6591) ce_loss 1.3770 (1.3959) teacher_loss 0.8341 (0.9143) loss_zs_kd 0.4813 (0.4631) loss_oracle 0.5016 (0.5133) acc 43.7500 (49.0104) kd_loss 0.9331 (0.8023) lr 7.5131e-04 eta 0:12:48
epoch [31/50] batch [80/428] time 0.084 (0.088) data 0.000 (0.007) loss 1.6321 (1.6634) ce_loss 1.3711 (1.3906) teacher_loss 0.9342 (0.9215) loss_zs_kd 0.3860 (0.4653) loss_oracle 0.5048 (0.5093) acc 43.7500 (49.4141) kd_loss 0.8136 (0.7932) lr 7.5131e-04 eta 0:12:25
epoch [31/50] batch [100/428] time 0.084 (0.088) data 0.000 (0.005) loss 1.6651 (1.6670) ce_loss 1.5703 (1.3974) teacher_loss 0.9174 (0.9240) loss_zs_kd 0.4890 (0.4670) loss_oracle 0.5032 (0.5095) acc 40.6250 (49.2500) kd_loss 0.9267 (0.7930) lr 7.5131e-04 eta 0:12:22
epoch [31/50] batch [120/428] time 0.087 (0.087) data 0.000 (0.005) loss 1.4852 (1.6511) ce_loss 1.2178 (1.3798) teacher_loss 0.6586 (0.9098) loss_zs_kd 0.5005 (0.4671) loss_oracle 0.5764 (0.5078) acc 50.0000 (50.3646) kd_loss 0.8916 (0.7914) lr 7.5131e-04 eta 0:12:14
epoch [31/50] batch [140/428] time 0.073 (0.086) data 0.000 (0.004) loss 1.5041 (1.6484) ce_loss 1.2266 (1.3744) teacher_loss 0.7382 (0.9049) loss_zs_kd 0.4505 (0.4738) loss_oracle 0.5406 (0.5066) acc 56.2500 (50.6027) kd_loss 0.9064 (0.7931) lr 7.5131e-04 eta 0:12:07
epoch [31/50] batch [160/428] time 0.085 (0.086) data 0.000 (0.003) loss 1.7021 (1.6430) ce_loss 1.2480 (1.3682) teacher_loss 0.9533 (0.8983) loss_zs_kd 0.4973 (0.4759) loss_oracle 0.5001 (0.5067) acc 53.1250 (50.7422) kd_loss 0.6857 (0.7885) lr 7.5131e-04 eta 0:12:04
epoch [31/50] batch [180/428] time 0.083 (0.086) data 0.000 (0.003) loss 1.6198 (1.6370) ce_loss 1.4023 (1.3597) teacher_loss 0.8619 (0.8956) loss_zs_kd 0.4595 (0.4751) loss_oracle 0.5282 (0.5039) acc 50.0000 (50.9201) kd_loss 0.7157 (0.7820) lr 7.5131e-04 eta 0:11:59
epoch [31/50] batch [200/428] time 0.082 (0.086) data 0.000 (0.003) loss 1.6702 (1.6356) ce_loss 1.5000 (1.3650) teacher_loss 0.9147 (0.8929) loss_zs_kd 0.4705 (0.4782) loss_oracle 0.5203 (0.5036) acc 53.1250 (50.8750) kd_loss 0.7651 (0.7790) lr 7.5131e-04 eta 0:11:59
epoch [31/50] batch [220/428] time 0.092 (0.086) data 0.000 (0.003) loss 1.6992 (1.6307) ce_loss 1.4521 (1.3616) teacher_loss 1.0074 (0.8882) loss_zs_kd 0.4766 (0.4814) loss_oracle 0.4536 (0.5018) acc 50.0000 (50.9801) kd_loss 0.7030 (0.7749) lr 7.5131e-04 eta 0:11:56
epoch [31/50] batch [240/428] time 0.088 (0.086) data 0.000 (0.002) loss 1.5127 (1.6274) ce_loss 1.2832 (1.3605) teacher_loss 0.7060 (0.8846) loss_zs_kd 0.5756 (0.4831) loss_oracle 0.5189 (0.5014) acc 59.3750 (50.9505) kd_loss 0.8234 (0.7720) lr 7.5131e-04 eta 0:11:53
epoch [31/50] batch [260/428] time 0.094 (0.086) data 0.000 (0.002) loss 1.4674 (1.6279) ce_loss 1.0615 (1.3611) teacher_loss 0.7945 (0.8838) loss_zs_kd 0.4437 (0.4854) loss_oracle 0.4511 (0.5013) acc 65.6250 (51.0457) kd_loss 0.6833 (0.7713) lr 7.5131e-04 eta 0:11:51
epoch [31/50] batch [280/428] time 0.088 (0.086) data 0.000 (0.002) loss 1.5944 (1.6304) ce_loss 1.4521 (1.3640) teacher_loss 0.8239 (0.8858) loss_zs_kd 0.4942 (0.4845) loss_oracle 0.5234 (0.5024) acc 43.7500 (50.8594) kd_loss 0.7787 (0.7720) lr 7.5131e-04 eta 0:11:49
epoch [31/50] batch [300/428] time 0.084 (0.086) data 0.000 (0.002) loss 1.3146 (1.6247) ce_loss 1.0605 (1.3593) teacher_loss 0.5816 (0.8792) loss_zs_kd 0.4901 (0.4863) loss_oracle 0.4880 (0.5024) acc 68.7500 (51.0521) kd_loss 0.7903 (0.7707) lr 7.5131e-04 eta 0:11:47
epoch [31/50] batch [320/428] time 0.087 (0.086) data 0.000 (0.002) loss 1.6882 (1.6218) ce_loss 1.4229 (1.3583) teacher_loss 0.9785 (0.8768) loss_zs_kd 0.5199 (0.4868) loss_oracle 0.4497 (0.5017) acc 50.0000 (51.0742) kd_loss 0.6484 (0.7707) lr 7.5131e-04 eta 0:11:45
epoch [31/50] batch [340/428] time 0.089 (0.086) data 0.000 (0.002) loss 1.4684 (1.6206) ce_loss 1.2783 (1.3562) teacher_loss 0.7027 (0.8762) loss_zs_kd 0.5968 (0.4864) loss_oracle 0.4673 (0.5013) acc 53.1250 (51.1029) kd_loss 0.6956 (0.7683) lr 7.5131e-04 eta 0:11:43
epoch [31/50] batch [360/428] time 0.082 (0.086) data 0.000 (0.002) loss 1.4121 (1.6181) ce_loss 1.2979 (1.3551) teacher_loss 0.6816 (0.8732) loss_zs_kd 0.4267 (0.4863) loss_oracle 0.5171 (0.5017) acc 46.8750 (51.1806) kd_loss 0.8062 (0.7677) lr 7.5131e-04 eta 0:11:41
epoch [31/50] batch [380/428] time 0.089 (0.086) data 0.000 (0.002) loss 1.7478 (1.6160) ce_loss 1.6221 (1.3560) teacher_loss 1.0065 (0.8708) loss_zs_kd 0.5510 (0.4868) loss_oracle 0.4659 (0.5019) acc 50.0000 (51.1102) kd_loss 0.7070 (0.7676) lr 7.5131e-04 eta 0:11:40
epoch [31/50] batch [400/428] time 0.082 (0.086) data 0.000 (0.002) loss 1.3941 (1.6141) ce_loss 1.1348 (1.3530) teacher_loss 0.5860 (0.8683) loss_zs_kd 0.5807 (0.4873) loss_oracle 0.5177 (0.5022) acc 56.2500 (51.2422) kd_loss 0.7338 (0.7657) lr 7.5131e-04 eta 0:11:38
epoch [31/50] batch [420/428] time 0.076 (0.085) data 0.000 (0.002) loss 1.7677 (1.6134) ce_loss 1.5732 (1.3493) teacher_loss 1.0448 (0.8677) loss_zs_kd 0.5004 (0.4873) loss_oracle 0.4727 (0.5020) acc 46.8750 (51.3914) kd_loss 0.7747 (0.7637) lr 7.5131e-04 eta 0:11:34
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,068
* accuracy: 52.2%
* error: 47.8%
* macro_f1: 40.5%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,666
* accuracy: 56.2%
* error: 43.8%
* macro_f1: 32.2%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [32/50] batch [20/428] time 0.076 (0.106) data 0.000 (0.025) loss 1.2418 (1.5935) ce_loss 0.9575 (1.3543) teacher_loss 0.5644 (0.8474) loss_zs_kd 0.4011 (0.4870) loss_oracle 0.4769 (0.5026) acc 65.6250 (49.2188) kd_loss 0.7771 (0.7734) lr 6.9098e-04 eta 0:14:23
epoch [32/50] batch [40/428] time 0.083 (0.093) data 0.000 (0.012) loss 1.5926 (1.5881) ce_loss 1.3018 (1.3343) teacher_loss 0.8802 (0.8465) loss_zs_kd 0.5145 (0.4959) loss_oracle 0.4551 (0.4937) acc 50.0000 (49.9219) kd_loss 0.7717 (0.7557) lr 6.9098e-04 eta 0:12:35
epoch [32/50] batch [60/428] time 0.083 (0.091) data 0.001 (0.008) loss 1.4677 (1.5832) ce_loss 1.1973 (1.3119) teacher_loss 0.6920 (0.8350) loss_zs_kd 0.4974 (0.5020) loss_oracle 0.5270 (0.4972) acc 59.3750 (50.8854) kd_loss 0.7768 (0.7527) lr 6.9098e-04 eta 0:12:10
epoch [32/50] batch [80/428] time 0.086 (0.089) data 0.000 (0.006) loss 1.5207 (1.5751) ce_loss 1.1982 (1.3125) teacher_loss 0.7629 (0.8247) loss_zs_kd 0.5244 (0.5009) loss_oracle 0.4957 (0.4999) acc 65.6250 (51.4844) kd_loss 0.7419 (0.7553) lr 6.9098e-04 eta 0:11:57
epoch [32/50] batch [100/428] time 0.089 (0.088) data 0.000 (0.005) loss 1.5434 (1.5798) ce_loss 1.4131 (1.3232) teacher_loss 0.8333 (0.8304) loss_zs_kd 0.4957 (0.4981) loss_oracle 0.4623 (0.5003) acc 56.2500 (51.5938) kd_loss 0.7679 (0.7586) lr 6.9098e-04 eta 0:11:48
epoch [32/50] batch [120/428] time 0.084 (0.088) data 0.000 (0.004) loss 1.4256 (1.5858) ce_loss 1.4238 (1.3361) teacher_loss 0.7191 (0.8381) loss_zs_kd 0.4340 (0.4924) loss_oracle 0.4895 (0.5015) acc 46.8750 (51.1198) kd_loss 0.8807 (0.7545) lr 6.9098e-04 eta 0:11:42
epoch [32/50] batch [140/428] time 0.079 (0.087) data 0.000 (0.004) loss 1.5045 (1.5834) ce_loss 1.1162 (1.3362) teacher_loss 0.7682 (0.8367) loss_zs_kd 0.5537 (0.4922) loss_oracle 0.4594 (0.5006) acc 68.7500 (51.3616) kd_loss 0.6548 (0.7516) lr 6.9098e-04 eta 0:11:34
epoch [32/50] batch [160/428] time 0.087 (0.087) data 0.000 (0.003) loss 1.3627 (1.5904) ce_loss 1.2080 (1.3425) teacher_loss 0.5748 (0.8444) loss_zs_kd 0.4365 (0.4879) loss_oracle 0.5697 (0.5021) acc 50.0000 (50.8984) kd_loss 0.9363 (0.7501) lr 6.9098e-04 eta 0:11:32
epoch [32/50] batch [180/428] time 0.089 (0.087) data 0.000 (0.003) loss 1.5607 (1.5963) ce_loss 1.3623 (1.3451) teacher_loss 0.8166 (0.8511) loss_zs_kd 0.5063 (0.4873) loss_oracle 0.4909 (0.5016) acc 53.1250 (50.9201) kd_loss 0.6968 (0.7505) lr 6.9098e-04 eta 0:11:29
epoch [32/50] batch [200/428] time 0.087 (0.086) data 0.000 (0.003) loss 1.4070 (1.5991) ce_loss 0.9854 (1.3512) teacher_loss 0.6949 (0.8535) loss_zs_kd 0.5272 (0.4870) loss_oracle 0.4485 (0.5021) acc 62.5000 (50.8594) kd_loss 0.7303 (0.7520) lr 6.9098e-04 eta 0:11:25
epoch [32/50] batch [220/428] time 0.084 (0.086) data 0.000 (0.003) loss 1.5614 (1.6012) ce_loss 1.5342 (1.3516) teacher_loss 0.7990 (0.8553) loss_zs_kd 0.4593 (0.4862) loss_oracle 0.5328 (0.5028) acc 40.6250 (50.7812) kd_loss 0.9000 (0.7502) lr 6.9098e-04 eta 0:11:22
epoch [32/50] batch [240/428] time 0.081 (0.086) data 0.000 (0.002) loss 1.7235 (1.5974) ce_loss 1.6133 (1.3520) teacher_loss 0.9310 (0.8508) loss_zs_kd 0.5068 (0.4866) loss_oracle 0.5392 (0.5033) acc 53.1250 (50.7943) kd_loss 0.8630 (0.7520) lr 6.9098e-04 eta 0:11:20
epoch [32/50] batch [260/428] time 0.083 (0.086) data 0.000 (0.002) loss 1.3175 (1.5988) ce_loss 1.2617 (1.3557) teacher_loss 0.6326 (0.8522) loss_zs_kd 0.4473 (0.4875) loss_oracle 0.4613 (0.5028) acc 53.1250 (50.5769) kd_loss 0.8887 (0.7545) lr 6.9098e-04 eta 0:11:18
epoch [32/50] batch [280/428] time 0.085 (0.086) data 0.000 (0.002) loss 1.8964 (1.5976) ce_loss 1.7168 (1.3565) teacher_loss 1.2241 (0.8508) loss_zs_kd 0.4068 (0.4868) loss_oracle 0.4689 (0.5034) acc 50.0000 (50.6585) kd_loss 0.7543 (0.7553) lr 6.9098e-04 eta 0:11:15
epoch [32/50] batch [300/428] time 0.076 (0.086) data 0.000 (0.002) loss 1.5602 (1.5987) ce_loss 1.4590 (1.3566) teacher_loss 0.8352 (0.8513) loss_zs_kd 0.3990 (0.4850) loss_oracle 0.5255 (0.5049) acc 43.7500 (50.5833) kd_loss 0.8923 (0.7552) lr 6.9098e-04 eta 0:11:13
epoch [32/50] batch [320/428] time 0.083 (0.086) data 0.000 (0.002) loss 1.7235 (1.5975) ce_loss 1.4209 (1.3546) teacher_loss 1.0122 (0.8503) loss_zs_kd 0.4772 (0.4846) loss_oracle 0.4727 (0.5050) acc 46.8750 (50.7617) kd_loss 0.7296 (0.7557) lr 6.9098e-04 eta 0:11:10
epoch [32/50] batch [340/428] time 0.083 (0.086) data 0.000 (0.002) loss 1.3701 (1.5982) ce_loss 1.3564 (1.3536) teacher_loss 0.6878 (0.8514) loss_zs_kd 0.4128 (0.4839) loss_oracle 0.4759 (0.5049) acc 46.8750 (50.7812) kd_loss 0.7266 (0.7565) lr 6.9098e-04 eta 0:11:08
epoch [32/50] batch [360/428] time 0.079 (0.086) data 0.000 (0.002) loss 1.5526 (1.5990) ce_loss 1.4492 (1.3547) teacher_loss 0.8013 (0.8529) loss_zs_kd 0.4822 (0.4829) loss_oracle 0.5102 (0.5047) acc 46.8750 (50.8073) kd_loss 0.7424 (0.7562) lr 6.9098e-04 eta 0:11:06
epoch [32/50] batch [380/428] time 0.087 (0.086) data 0.000 (0.002) loss 1.5660 (1.5998) ce_loss 1.5293 (1.3575) teacher_loss 0.8463 (0.8534) loss_zs_kd 0.4392 (0.4830) loss_oracle 0.5001 (0.5049) acc 40.6250 (50.6990) kd_loss 0.9657 (0.7574) lr 6.9098e-04 eta 0:11:03
epoch [32/50] batch [400/428] time 0.086 (0.086) data 0.000 (0.002) loss 1.4997 (1.5995) ce_loss 1.1973 (1.3568) teacher_loss 0.8437 (0.8522) loss_zs_kd 0.4141 (0.4838) loss_oracle 0.4490 (0.5055) acc 65.6250 (50.8359) kd_loss 0.7512 (0.7594) lr 6.9098e-04 eta 0:11:01
epoch [32/50] batch [420/428] time 0.080 (0.085) data 0.000 (0.001) loss 1.5939 (1.6012) ce_loss 1.5322 (1.3589) teacher_loss 0.7181 (0.8540) loss_zs_kd 0.4929 (0.4832) loss_oracle 0.6294 (0.5056) acc 56.2500 (50.8333) kd_loss 1.0236 (0.7605) lr 6.9098e-04 eta 0:10:58
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 3,022
* accuracy: 51.4%
* error: 48.6%
* macro_f1: 39.0%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,539
* accuracy: 53.6%
* error: 46.4%
* macro_f1: 29.4%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [33/50] batch [20/428] time 0.073 (0.106) data 0.000 (0.027) loss 1.4909 (1.5933) ce_loss 1.2920 (1.3550) teacher_loss 0.8121 (0.8502) loss_zs_kd 0.3918 (0.4658) loss_oracle 0.4829 (0.5101) acc 56.2500 (49.0625) kd_loss 0.9632 (0.8235) lr 6.3188e-04 eta 0:13:32
epoch [33/50] batch [40/428] time 0.093 (0.094) data 0.000 (0.013) loss 1.4997 (1.6301) ce_loss 1.3018 (1.3716) teacher_loss 0.7915 (0.8865) loss_zs_kd 0.4746 (0.4687) loss_oracle 0.4709 (0.5093) acc 56.2500 (48.9844) kd_loss 0.8054 (0.7986) lr 6.3188e-04 eta 0:11:58
epoch [33/50] batch [60/428] time 0.084 (0.091) data 0.001 (0.009) loss 1.5418 (1.6211) ce_loss 1.5059 (1.3658) teacher_loss 0.8235 (0.8752) loss_zs_kd 0.4383 (0.4756) loss_oracle 0.4992 (0.5081) acc 50.0000 (50.0000) kd_loss 0.9164 (0.8112) lr 6.3188e-04 eta 0:11:35
epoch [33/50] batch [80/428] time 0.076 (0.089) data 0.000 (0.007) loss 1.5673 (1.6236) ce_loss 1.1123 (1.3684) teacher_loss 0.8972 (0.8839) loss_zs_kd 0.3647 (0.4725) loss_oracle 0.4877 (0.5034) acc 53.1250 (50.0391) kd_loss 0.7154 (0.8020) lr 6.3188e-04 eta 0:11:17
epoch [33/50] batch [100/428] time 0.078 (0.087) data 0.000 (0.006) loss 1.6483 (1.6243) ce_loss 1.4668 (1.3769) teacher_loss 0.9436 (0.8879) loss_zs_kd 0.4322 (0.4708) loss_oracle 0.4886 (0.5010) acc 46.8750 (49.7500) kd_loss 0.7826 (0.7952) lr 6.3188e-04 eta 0:11:02
epoch [33/50] batch [120/428] time 0.092 (0.087) data 0.000 (0.005) loss 1.6200 (1.6259) ce_loss 1.3096 (1.3742) teacher_loss 0.9567 (0.8925) loss_zs_kd 0.4203 (0.4711) loss_oracle 0.4532 (0.4979) acc 53.1250 (49.9479) kd_loss 0.6937 (0.7909) lr 6.3188e-04 eta 0:10:58
epoch [33/50] batch [140/428] time 0.087 (0.086) data 0.000 (0.004) loss 1.5620 (1.6177) ce_loss 1.1514 (1.3700) teacher_loss 0.8919 (0.8905) loss_zs_kd 0.4202 (0.4665) loss_oracle 0.4600 (0.4940) acc 62.5000 (50.0000) kd_loss 0.6360 (0.7903) lr 6.3188e-04 eta 0:10:51
epoch [33/50] batch [160/428] time 0.080 (0.086) data 0.000 (0.004) loss 1.4558 (1.6118) ce_loss 1.3350 (1.3606) teacher_loss 0.7360 (0.8851) loss_zs_kd 0.4327 (0.4651) loss_oracle 0.5034 (0.4941) acc 53.1250 (50.4688) kd_loss 0.7199 (0.7891) lr 6.3188e-04 eta 0:10:45
epoch [33/50] batch [180/428] time 0.079 (0.085) data 0.000 (0.003) loss 1.7487 (1.6160) ce_loss 1.7090 (1.3684) teacher_loss 1.0109 (0.8910) loss_zs_kd 0.4790 (0.4626) loss_oracle 0.4983 (0.4936) acc 34.3750 (50.1562) kd_loss 0.8653 (0.7863) lr 6.3188e-04 eta 0:10:41
epoch [33/50] batch [200/428] time 0.085 (0.085) data 0.000 (0.003) loss 1.7208 (1.6131) ce_loss 1.3311 (1.3661) teacher_loss 0.9731 (0.8874) loss_zs_kd 0.4971 (0.4619) loss_oracle 0.4992 (0.4947) acc 53.1250 (50.2500) kd_loss 0.8526 (0.7866) lr 6.3188e-04 eta 0:10:37
epoch [33/50] batch [220/428] time 0.082 (0.085) data 0.000 (0.003) loss 1.6854 (1.6122) ce_loss 1.3857 (1.3644) teacher_loss 0.9345 (0.8848) loss_zs_kd 0.4681 (0.4621) loss_oracle 0.5169 (0.4963) acc 46.8750 (50.2983) kd_loss 0.8348 (0.7857) lr 6.3188e-04 eta 0:10:33
epoch [33/50] batch [240/428] time 0.080 (0.085) data 0.000 (0.002) loss 1.8110 (1.6124) ce_loss 1.3574 (1.3628) teacher_loss 1.0354 (0.8842) loss_zs_kd 0.5080 (0.4606) loss_oracle 0.5216 (0.4978) acc 53.1250 (50.3255) kd_loss 0.6253 (0.7862) lr 6.3188e-04 eta 0:10:32
epoch [33/50] batch [260/428] time 0.081 (0.085) data 0.000 (0.002) loss 1.4795 (1.6106) ce_loss 1.1094 (1.3583) teacher_loss 0.7957 (0.8834) loss_zs_kd 0.3993 (0.4590) loss_oracle 0.4842 (0.4976) acc 56.2500 (50.5048) kd_loss 0.7538 (0.7857) lr 6.3188e-04 eta 0:10:29
epoch [33/50] batch [280/428] time 0.081 (0.085) data 0.000 (0.002) loss 1.5898 (1.6166) ce_loss 1.3105 (1.3598) teacher_loss 0.8723 (0.8897) loss_zs_kd 0.4699 (0.4587) loss_oracle 0.4826 (0.4976) acc 59.3750 (50.5134) kd_loss 0.7452 (0.7864) lr 6.3188e-04 eta 0:10:27
epoch [33/50] batch [300/428] time 0.082 (0.084) data 0.000 (0.002) loss 1.7166 (1.6185) ce_loss 1.5010 (1.3579) teacher_loss 0.9894 (0.8916) loss_zs_kd 0.4677 (0.4581) loss_oracle 0.4933 (0.4979) acc 40.6250 (50.5417) kd_loss 0.9014 (0.7868) lr 6.3188e-04 eta 0:10:24
epoch [33/50] batch [320/428] time 0.080 (0.084) data 0.000 (0.002) loss 1.6996 (1.6199) ce_loss 1.5078 (1.3580) teacher_loss 0.9568 (0.8931) loss_zs_kd 0.5043 (0.4583) loss_oracle 0.4906 (0.4976) acc 40.6250 (50.4590) kd_loss 0.7474 (0.7873) lr 6.3188e-04 eta 0:10:22
epoch [33/50] batch [340/428] time 0.092 (0.084) data 0.000 (0.002) loss 1.5213 (1.6229) ce_loss 1.1484 (1.3604) teacher_loss 0.7740 (0.8972) loss_zs_kd 0.4472 (0.4571) loss_oracle 0.5237 (0.4972) acc 62.5000 (50.3401) kd_loss 0.8319 (0.7868) lr 6.3188e-04 eta 0:10:21
epoch [33/50] batch [360/428] time 0.091 (0.084) data 0.000 (0.002) loss 1.4700 (1.6237) ce_loss 1.1855 (1.3614) teacher_loss 0.7659 (0.8989) loss_zs_kd 0.4842 (0.4562) loss_oracle 0.4620 (0.4967) acc 65.6250 (50.3385) kd_loss 0.6939 (0.7844) lr 6.3188e-04 eta 0:10:20
epoch [33/50] batch [380/428] time 0.082 (0.084) data 0.000 (0.002) loss 1.5340 (1.6252) ce_loss 1.2588 (1.3598) teacher_loss 0.8082 (0.9004) loss_zs_kd 0.4867 (0.4552) loss_oracle 0.4824 (0.4973) acc 59.3750 (50.3947) kd_loss 0.9096 (0.7852) lr 6.3188e-04 eta 0:10:18
epoch [33/50] batch [400/428] time 0.087 (0.084) data 0.001 (0.002) loss 1.7167 (1.6263) ce_loss 1.4346 (1.3594) teacher_loss 1.0250 (0.9020) loss_zs_kd 0.4552 (0.4552) loss_oracle 0.4641 (0.4967) acc 59.3750 (50.3594) kd_loss 0.7260 (0.7844) lr 6.3188e-04 eta 0:10:16
epoch [33/50] batch [420/428] time 0.076 (0.084) data 0.000 (0.002) loss 1.4721 (1.6244) ce_loss 1.1680 (1.3569) teacher_loss 0.6023 (0.9000) loss_zs_kd 0.4845 (0.4546) loss_oracle 0.6275 (0.4972) acc 59.3750 (50.5729) kd_loss 0.9412 (0.7850) lr 6.3188e-04 eta 0:10:14
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,964
* accuracy: 50.4%
* error: 49.6%
* macro_f1: 37.2%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,474
* accuracy: 52.2%
* error: 47.8%
* macro_f1: 28.4%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [34/50] batch [20/428] time 0.091 (0.113) data 0.000 (0.026) loss 1.5370 (1.6080) ce_loss 1.1035 (1.2676) teacher_loss 0.7295 (0.8865) loss_zs_kd 0.4697 (0.4531) loss_oracle 0.5727 (0.4949) acc 53.1250 (54.0625) kd_loss 0.8163 (0.7737) lr 5.7422e-04 eta 0:13:38
epoch [34/50] batch [40/428] time 0.085 (0.099) data 0.000 (0.013) loss 1.6375 (1.6301) ce_loss 1.2871 (1.3161) teacher_loss 0.8645 (0.9004) loss_zs_kd 0.4969 (0.4522) loss_oracle 0.5246 (0.5036) acc 56.2500 (52.4219) kd_loss 0.7285 (0.7916) lr 5.7422e-04 eta 0:11:54
epoch [34/50] batch [60/428] time 0.087 (0.093) data 0.001 (0.009) loss 1.4736 (1.6125) ce_loss 1.1973 (1.3275) teacher_loss 0.7772 (0.8851) loss_zs_kd 0.4398 (0.4484) loss_oracle 0.4765 (0.5032) acc 62.5000 (51.1458) kd_loss 0.8396 (0.7921) lr 5.7422e-04 eta 0:11:13
epoch [34/50] batch [80/428] time 0.081 (0.091) data 0.000 (0.007) loss 1.6300 (1.6126) ce_loss 1.3877 (1.3303) teacher_loss 0.9118 (0.8845) loss_zs_kd 0.4842 (0.4506) loss_oracle 0.4762 (0.5028) acc 46.8750 (51.0547) kd_loss 0.7338 (0.7918) lr 5.7422e-04 eta 0:10:54
epoch [34/50] batch [100/428] time 0.085 (0.090) data 0.000 (0.005) loss 1.8060 (1.6125) ce_loss 1.5303 (1.3251) teacher_loss 1.0655 (0.8820) loss_zs_kd 0.5052 (0.4559) loss_oracle 0.4878 (0.5026) acc 46.8750 (51.6250) kd_loss 0.9051 (0.8032) lr 5.7422e-04 eta 0:10:42
epoch [34/50] batch [120/428] time 0.086 (0.089) data 0.000 (0.005) loss 1.8334 (1.6227) ce_loss 1.5996 (1.3390) teacher_loss 1.0852 (0.8914) loss_zs_kd 0.4339 (0.4552) loss_oracle 0.5313 (0.5038) acc 50.0000 (50.8594) kd_loss 0.8230 (0.8052) lr 5.7422e-04 eta 0:10:36
epoch [34/50] batch [140/428] time 0.085 (0.088) data 0.000 (0.004) loss 1.6379 (1.6338) ce_loss 1.4229 (1.3513) teacher_loss 0.8672 (0.8987) loss_zs_kd 0.4654 (0.4571) loss_oracle 0.5380 (0.5065) acc 59.3750 (50.6473) kd_loss 0.9631 (0.8128) lr 5.7422e-04 eta 0:10:28
epoch [34/50] batch [160/428] time 0.088 (0.088) data 0.000 (0.003) loss 1.7334 (1.6359) ce_loss 1.3389 (1.3544) teacher_loss 0.9946 (0.8972) loss_zs_kd 0.4184 (0.4615) loss_oracle 0.5296 (0.5079) acc 50.0000 (50.2930) kd_loss 0.7855 (0.8153) lr 5.7422e-04 eta 0:10:24
epoch [34/50] batch [180/428] time 0.084 (0.087) data 0.000 (0.003) loss 1.4672 (1.6405) ce_loss 1.2812 (1.3649) teacher_loss 0.6982 (0.8981) loss_zs_kd 0.4886 (0.4629) loss_oracle 0.5247 (0.5110) acc 53.1250 (49.8090) kd_loss 0.9012 (0.8224) lr 5.7422e-04 eta 0:10:20
epoch [34/50] batch [200/428] time 0.093 (0.087) data 0.000 (0.003) loss 1.5999 (1.6415) ce_loss 1.4453 (1.3680) teacher_loss 0.8824 (0.8953) loss_zs_kd 0.4994 (0.4655) loss_oracle 0.4678 (0.5135) acc 50.0000 (49.6094) kd_loss 0.8998 (0.8277) lr 5.7422e-04 eta 0:10:17
epoch [34/50] batch [220/428] time 0.085 (0.087) data 0.000 (0.003) loss 1.8185 (1.6422) ce_loss 1.7383 (1.3699) teacher_loss 1.0608 (0.8940) loss_zs_kd 0.5183 (0.4662) loss_oracle 0.4986 (0.5151) acc 37.5000 (49.3608) kd_loss 0.8581 (0.8312) lr 5.7422e-04 eta 0:10:14
epoch [34/50] batch [240/428] time 0.080 (0.087) data 0.000 (0.002) loss 1.5592 (1.6393) ce_loss 1.3867 (1.3692) teacher_loss 0.8451 (0.8912) loss_zs_kd 0.4343 (0.4646) loss_oracle 0.4970 (0.5158) acc 53.1250 (49.5443) kd_loss 0.9374 (0.8352) lr 5.7422e-04 eta 0:10:12
epoch [34/50] batch [260/428] time 0.080 (0.087) data 0.000 (0.002) loss 1.3750 (1.6403) ce_loss 1.1182 (1.3708) teacher_loss 0.7370 (0.8903) loss_zs_kd 0.4196 (0.4660) loss_oracle 0.4282 (0.5170) acc 59.3750 (49.3149) kd_loss 0.8538 (0.8356) lr 5.7422e-04 eta 0:10:09
epoch [34/50] batch [280/428] time 0.089 (0.087) data 0.000 (0.002) loss 1.7072 (1.6426) ce_loss 1.4648 (1.3733) teacher_loss 1.0528 (0.8925) loss_zs_kd 0.3977 (0.4656) loss_oracle 0.4556 (0.5173) acc 53.1250 (49.2857) kd_loss 0.9104 (0.8367) lr 5.7422e-04 eta 0:10:05
epoch [34/50] batch [300/428] time 0.074 (0.086) data 0.000 (0.002) loss 1.6140 (1.6391) ce_loss 1.3047 (1.3746) teacher_loss 0.7666 (0.8883) loss_zs_kd 0.4480 (0.4652) loss_oracle 0.6234 (0.5181) acc 56.2500 (49.3438) kd_loss 0.9320 (0.8407) lr 5.7422e-04 eta 0:09:59
epoch [34/50] batch [320/428] time 0.076 (0.086) data 0.000 (0.002) loss 1.5710 (1.6379) ce_loss 1.3574 (1.3741) teacher_loss 0.8145 (0.8862) loss_zs_kd 0.4670 (0.4651) loss_oracle 0.5231 (0.5191) acc 37.5000 (49.3262) kd_loss 0.7952 (0.8417) lr 5.7422e-04 eta 0:09:54
epoch [34/50] batch [340/428] time 0.090 (0.085) data 0.000 (0.002) loss 1.7286 (1.6344) ce_loss 1.5264 (1.3743) teacher_loss 0.9241 (0.8814) loss_zs_kd 0.5044 (0.4663) loss_oracle 0.5523 (0.5198) acc 46.8750 (49.3199) kd_loss 0.8511 (0.8417) lr 5.7422e-04 eta 0:09:52
epoch [34/50] batch [360/428] time 0.084 (0.085) data 0.000 (0.002) loss 1.5154 (1.6325) ce_loss 1.3398 (1.3727) teacher_loss 0.7667 (0.8787) loss_zs_kd 0.4603 (0.4671) loss_oracle 0.5185 (0.5202) acc 50.0000 (49.4097) kd_loss 0.8418 (0.8438) lr 5.7422e-04 eta 0:09:49
epoch [34/50] batch [380/428] time 0.091 (0.085) data 0.000 (0.002) loss 1.5327 (1.6317) ce_loss 1.7373 (1.3709) teacher_loss 0.7774 (0.8790) loss_zs_kd 0.4489 (0.4663) loss_oracle 0.5309 (0.5196) acc 40.6250 (49.4984) kd_loss 0.8667 (0.8412) lr 5.7422e-04 eta 0:09:48
epoch [34/50] batch [400/428] time 0.089 (0.085) data 0.000 (0.002) loss 1.6449 (1.6282) ce_loss 1.3145 (1.3673) teacher_loss 0.8809 (0.8768) loss_zs_kd 0.4346 (0.4646) loss_oracle 0.5468 (0.5190) acc 59.3750 (49.7109) kd_loss 0.8395 (0.8404) lr 5.7422e-04 eta 0:09:47
epoch [34/50] batch [420/428] time 0.085 (0.085) data 0.000 (0.002) loss 1.4565 (1.6298) ce_loss 1.1055 (1.3689) teacher_loss 0.7258 (0.8786) loss_zs_kd 0.3979 (0.4633) loss_oracle 0.5317 (0.5195) acc 56.2500 (49.6205) kd_loss 0.8401 (0.8399) lr 5.7422e-04 eta 0:09:45
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,880
* accuracy: 49.0%
* error: 51.0%
* macro_f1: 36.5%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,650
* accuracy: 55.9%
* error: 44.1%
* macro_f1: 30.8%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [35/50] batch [20/428] time 0.080 (0.114) data 0.000 (0.026) loss 1.5098 (1.6354) ce_loss 1.2471 (1.4015) teacher_loss 0.7828 (0.8935) loss_zs_kd 0.4084 (0.4451) loss_oracle 0.5228 (0.5193) acc 56.2500 (46.5625) kd_loss 0.7792 (0.8260) lr 5.1825e-04 eta 0:12:56
epoch [35/50] batch [40/428] time 0.091 (0.098) data 0.000 (0.013) loss 1.5482 (1.6622) ce_loss 1.1807 (1.4126) teacher_loss 0.8062 (0.9185) loss_zs_kd 0.4316 (0.4411) loss_oracle 0.5262 (0.5231) acc 53.1250 (47.7344) kd_loss 0.7857 (0.8270) lr 5.1825e-04 eta 0:11:10
epoch [35/50] batch [60/428] time 0.083 (0.094) data 0.001 (0.009) loss 1.6651 (1.6306) ce_loss 1.5869 (1.3893) teacher_loss 0.8863 (0.8909) loss_zs_kd 0.4749 (0.4446) loss_oracle 0.5413 (0.5173) acc 40.6250 (48.6979) kd_loss 0.8068 (0.8240) lr 5.1825e-04 eta 0:10:36
epoch [35/50] batch [80/428] time 0.087 (0.092) data 0.000 (0.007) loss 1.5962 (1.6259) ce_loss 1.4473 (1.3811) teacher_loss 0.8752 (0.8813) loss_zs_kd 0.5547 (0.4535) loss_oracle 0.4437 (0.5178) acc 46.8750 (49.5312) kd_loss 0.9111 (0.8330) lr 5.1825e-04 eta 0:10:19
epoch [35/50] batch [100/428] time 0.084 (0.090) data 0.000 (0.005) loss 1.3846 (1.6218) ce_loss 1.4062 (1.3815) teacher_loss 0.7185 (0.8743) loss_zs_kd 0.3954 (0.4575) loss_oracle 0.4685 (0.5187) acc 46.8750 (49.4688) kd_loss 1.0231 (0.8365) lr 5.1825e-04 eta 0:10:09
epoch [35/50] batch [120/428] time 0.086 (0.089) data 0.000 (0.005) loss 1.8002 (1.6042) ce_loss 1.5801 (1.3632) teacher_loss 1.0481 (0.8575) loss_zs_kd 0.5043 (0.4573) loss_oracle 0.5000 (0.5181) acc 46.8750 (50.1042) kd_loss 0.9039 (0.8373) lr 5.1825e-04 eta 0:10:01
epoch [35/50] batch [140/428] time 0.086 (0.089) data 0.000 (0.004) loss 1.3866 (1.6060) ce_loss 1.2314 (1.3673) teacher_loss 0.6436 (0.8599) loss_zs_kd 0.4445 (0.4597) loss_oracle 0.5207 (0.5162) acc 53.1250 (50.0893) kd_loss 0.8599 (0.8392) lr 5.1825e-04 eta 0:09:56
epoch [35/50] batch [160/428] time 0.081 (0.088) data 0.000 (0.004) loss 1.5246 (1.6022) ce_loss 1.2031 (1.3661) teacher_loss 0.8412 (0.8591) loss_zs_kd 0.4113 (0.4592) loss_oracle 0.4778 (0.5136) acc 62.5000 (50.1172) kd_loss 0.7656 (0.8381) lr 5.1825e-04 eta 0:09:51
epoch [35/50] batch [180/428] time 0.084 (0.088) data 0.000 (0.003) loss 1.5248 (1.5997) ce_loss 1.4492 (1.3674) teacher_loss 0.8019 (0.8557) loss_zs_kd 0.5652 (0.4608) loss_oracle 0.4404 (0.5135) acc 50.0000 (50.2431) kd_loss 0.8494 (0.8391) lr 5.1825e-04 eta 0:09:48
epoch [35/50] batch [200/428] time 0.084 (0.088) data 0.000 (0.003) loss 1.4884 (1.6017) ce_loss 1.2461 (1.3686) teacher_loss 0.7775 (0.8566) loss_zs_kd 0.4675 (0.4650) loss_oracle 0.4772 (0.5127) acc 46.8750 (50.2812) kd_loss 0.7891 (0.8403) lr 5.1825e-04 eta 0:09:41
epoch [35/50] batch [220/428] time 0.088 (0.087) data 0.000 (0.003) loss 1.4620 (1.6068) ce_loss 1.3730 (1.3805) teacher_loss 0.5819 (0.8594) loss_zs_kd 0.5406 (0.4684) loss_oracle 0.6098 (0.5131) acc 50.0000 (49.9716) kd_loss 0.9351 (0.8425) lr 5.1825e-04 eta 0:09:39
epoch [35/50] batch [240/428] time 0.081 (0.087) data 0.000 (0.002) loss 1.8722 (1.6080) ce_loss 1.6650 (1.3850) teacher_loss 1.1448 (0.8584) loss_zs_kd 0.5663 (0.4716) loss_oracle 0.4442 (0.5138) acc 34.3750 (49.6745) kd_loss 0.7543 (0.8459) lr 5.1825e-04 eta 0:09:36
epoch [35/50] batch [260/428] time 0.085 (0.087) data 0.000 (0.002) loss 1.5194 (1.6041) ce_loss 1.2510 (1.3811) teacher_loss 0.8361 (0.8562) loss_zs_kd 0.4313 (0.4705) loss_oracle 0.4676 (0.5127) acc 53.1250 (49.8798) kd_loss 0.6674 (0.8454) lr 5.1825e-04 eta 0:09:33
epoch [35/50] batch [280/428] time 0.084 (0.087) data 0.000 (0.002) loss 1.3917 (1.5999) ce_loss 1.2314 (1.3777) teacher_loss 0.6451 (0.8521) loss_zs_kd 0.5035 (0.4720) loss_oracle 0.4948 (0.5118) acc 62.5000 (49.9665) kd_loss 0.9402 (0.8448) lr 5.1825e-04 eta 0:09:30
epoch [35/50] batch [300/428] time 0.085 (0.087) data 0.001 (0.002) loss 1.4609 (1.6024) ce_loss 1.2188 (1.3793) teacher_loss 0.7035 (0.8532) loss_zs_kd 0.4416 (0.4730) loss_oracle 0.5366 (0.5127) acc 59.3750 (49.9375) kd_loss 0.8549 (0.8462) lr 5.1825e-04 eta 0:09:27
epoch [35/50] batch [320/428] time 0.087 (0.086) data 0.000 (0.002) loss 1.5321 (1.6024) ce_loss 1.4736 (1.3789) teacher_loss 0.7896 (0.8532) loss_zs_kd 0.4840 (0.4746) loss_oracle 0.5005 (0.5119) acc 56.2500 (50.0293) kd_loss 0.8679 (0.8450) lr 5.1825e-04 eta 0:09:23
epoch [35/50] batch [340/428] time 0.086 (0.086) data 0.000 (0.002) loss 1.6608 (1.6031) ce_loss 1.4951 (1.3805) teacher_loss 0.9468 (0.8528) loss_zs_kd 0.4917 (0.4743) loss_oracle 0.4682 (0.5131) acc 50.0000 (49.9357) kd_loss 0.7426 (0.8444) lr 5.1825e-04 eta 0:09:21
epoch [35/50] batch [360/428] time 0.089 (0.086) data 0.000 (0.002) loss 1.6477 (1.6028) ce_loss 1.3945 (1.3815) teacher_loss 0.9633 (0.8535) loss_zs_kd 0.4732 (0.4736) loss_oracle 0.4479 (0.5125) acc 43.7500 (49.9045) kd_loss 0.7653 (0.8433) lr 5.1825e-04 eta 0:09:18
epoch [35/50] batch [380/428] time 0.089 (0.086) data 0.000 (0.002) loss 1.5501 (1.5979) ce_loss 1.3086 (1.3775) teacher_loss 0.7721 (0.8500) loss_zs_kd 0.4458 (0.4726) loss_oracle 0.5550 (0.5115) acc 62.5000 (50.1234) kd_loss 0.8045 (0.8401) lr 5.1825e-04 eta 0:09:16
epoch [35/50] batch [400/428] time 0.083 (0.086) data 0.000 (0.002) loss 1.3987 (1.5977) ce_loss 1.1426 (1.3805) teacher_loss 0.6683 (0.8484) loss_zs_kd 0.4784 (0.4734) loss_oracle 0.4912 (0.5126) acc 59.3750 (49.9219) kd_loss 0.9008 (0.8413) lr 5.1825e-04 eta 0:09:14
epoch [35/50] batch [420/428] time 0.082 (0.086) data 0.000 (0.002) loss 1.4353 (1.5974) ce_loss 1.4219 (1.3810) teacher_loss 0.7130 (0.8486) loss_zs_kd 0.4679 (0.4732) loss_oracle 0.4884 (0.5122) acc 50.0000 (49.8735) kd_loss 0.8247 (0.8392) lr 5.1825e-04 eta 0:09:12
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,885
* accuracy: 49.1%
* error: 50.9%
* macro_f1: 35.7%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,687
* accuracy: 56.7%
* error: 43.3%
* macro_f1: 31.5%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [36/50] batch [20/428] time 0.079 (0.116) data 0.000 (0.030) loss 1.5554 (1.5401) ce_loss 1.2773 (1.3682) teacher_loss 0.8723 (0.7999) loss_zs_kd 0.4529 (0.4590) loss_oracle 0.4567 (0.5107) acc 50.0000 (52.3438) kd_loss 0.7731 (0.8030) lr 4.6417e-04 eta 0:12:22
epoch [36/50] batch [40/428] time 0.074 (0.098) data 0.000 (0.015) loss 1.3732 (1.5664) ce_loss 1.3301 (1.4017) teacher_loss 0.6504 (0.8126) loss_zs_kd 0.4449 (0.4673) loss_oracle 0.5004 (0.5202) acc 43.7500 (49.7656) kd_loss 0.8353 (0.8207) lr 4.6417e-04 eta 0:10:27
epoch [36/50] batch [60/428] time 0.077 (0.090) data 0.001 (0.010) loss 1.8585 (1.5653) ce_loss 1.5303 (1.3908) teacher_loss 1.0554 (0.8126) loss_zs_kd 0.4936 (0.4683) loss_oracle 0.5562 (0.5185) acc 40.6250 (49.7396) kd_loss 0.8059 (0.8259) lr 4.6417e-04 eta 0:09:34
epoch [36/50] batch [80/428] time 0.078 (0.088) data 0.000 (0.008) loss 1.8657 (1.5637) ce_loss 1.6123 (1.3888) teacher_loss 0.9543 (0.8091) loss_zs_kd 0.5909 (0.4694) loss_oracle 0.6159 (0.5199) acc 40.6250 (49.4531) kd_loss 0.8237 (0.8214) lr 4.6417e-04 eta 0:09:20
epoch [36/50] batch [100/428] time 0.083 (0.086) data 0.000 (0.006) loss 1.4708 (1.5597) ce_loss 1.0723 (1.3858) teacher_loss 0.7594 (0.8040) loss_zs_kd 0.4532 (0.4701) loss_oracle 0.4848 (0.5206) acc 59.3750 (49.4375) kd_loss 0.6643 (0.8161) lr 4.6417e-04 eta 0:09:01
epoch [36/50] batch [120/428] time 0.082 (0.083) data 0.000 (0.005) loss 1.6280 (1.5617) ce_loss 1.5820 (1.3870) teacher_loss 0.8316 (0.8015) loss_zs_kd 0.5168 (0.4725) loss_oracle 0.5380 (0.5239) acc 37.5000 (49.2188) kd_loss 0.7816 (0.8170) lr 4.6417e-04 eta 0:08:44
epoch [36/50] batch [140/428] time 0.084 (0.082) data 0.000 (0.004) loss 2.0386 (1.5623) ce_loss 1.7734 (1.3827) teacher_loss 1.1030 (0.7990) loss_zs_kd 0.5123 (0.4745) loss_oracle 0.6795 (0.5261) acc 43.7500 (49.3973) kd_loss 0.9962 (0.8158) lr 4.6417e-04 eta 0:08:36
epoch [36/50] batch [160/428] time 0.082 (0.083) data 0.000 (0.004) loss 1.3597 (1.5585) ce_loss 1.1934 (1.3721) teacher_loss 0.5549 (0.7957) loss_zs_kd 0.5649 (0.4757) loss_oracle 0.5224 (0.5250) acc 59.3750 (49.9609) kd_loss 0.8319 (0.8121) lr 4.6417e-04 eta 0:08:36
epoch [36/50] batch [180/428] time 0.091 (0.083) data 0.000 (0.004) loss 1.3488 (1.5597) ce_loss 1.1084 (1.3750) teacher_loss 0.5880 (0.7974) loss_zs_kd 0.4753 (0.4759) loss_oracle 0.5231 (0.5244) acc 59.3750 (50.0521) kd_loss 0.7430 (0.8118) lr 4.6417e-04 eta 0:08:36
epoch [36/50] batch [200/428] time 0.080 (0.083) data 0.000 (0.003) loss 1.2765 (1.5593) ce_loss 1.0068 (1.3694) teacher_loss 0.5842 (0.7974) loss_zs_kd 0.4737 (0.4767) loss_oracle 0.4555 (0.5235) acc 59.3750 (50.4844) kd_loss 0.7423 (0.8091) lr 4.6417e-04 eta 0:08:36
epoch [36/50] batch [220/428] time 0.083 (0.083) data 0.000 (0.003) loss 1.7640 (1.5587) ce_loss 1.5059 (1.3704) teacher_loss 0.9717 (0.7973) loss_zs_kd 0.4952 (0.4747) loss_oracle 0.5447 (0.5241) acc 53.1250 (50.4830) kd_loss 0.9234 (0.8122) lr 4.6417e-04 eta 0:08:31
epoch [36/50] batch [240/428] time 0.075 (0.082) data 0.000 (0.003) loss 1.5470 (1.5630) ce_loss 1.1914 (1.3727) teacher_loss 0.7492 (0.8008) loss_zs_kd 0.4823 (0.4764) loss_oracle 0.5566 (0.5239) acc 40.6250 (50.3776) kd_loss 0.7566 (0.8099) lr 4.6417e-04 eta 0:08:27
epoch [36/50] batch [260/428] time 0.079 (0.082) data 0.000 (0.003) loss 1.7902 (1.5687) ce_loss 1.5479 (1.3804) teacher_loss 0.9648 (0.8050) loss_zs_kd 0.5035 (0.4790) loss_oracle 0.5736 (0.5242) acc 37.5000 (50.0481) kd_loss 0.7738 (0.8099) lr 4.6417e-04 eta 0:08:23
epoch [36/50] batch [280/428] time 0.070 (0.081) data 0.000 (0.002) loss 1.7351 (1.5661) ce_loss 1.5107 (1.3763) teacher_loss 0.9794 (0.8014) loss_zs_kd 0.4893 (0.4815) loss_oracle 0.5110 (0.5239) acc 53.1250 (50.1451) kd_loss 0.7152 (0.8087) lr 4.6417e-04 eta 0:08:20
epoch [36/50] batch [300/428] time 0.085 (0.081) data 0.000 (0.002) loss 1.8431 (1.5687) ce_loss 1.8457 (1.3803) teacher_loss 1.0173 (0.8048) loss_zs_kd 0.4646 (0.4810) loss_oracle 0.5935 (0.5234) acc 34.3750 (49.9688) kd_loss 0.9804 (0.8082) lr 4.6417e-04 eta 0:08:14
epoch [36/50] batch [320/428] time 0.082 (0.081) data 0.000 (0.002) loss 1.2533 (1.5677) ce_loss 0.8452 (1.3778) teacher_loss 0.4398 (0.8043) loss_zs_kd 0.5731 (0.4815) loss_oracle 0.5269 (0.5227) acc 78.1250 (49.9902) kd_loss 0.7884 (0.8083) lr 4.6417e-04 eta 0:08:14
epoch [36/50] batch [340/428] time 0.081 (0.081) data 0.000 (0.002) loss 1.5831 (1.5685) ce_loss 1.3955 (1.3793) teacher_loss 0.8566 (0.8049) loss_zs_kd 0.5643 (0.4824) loss_oracle 0.4443 (0.5225) acc 62.5000 (49.9724) kd_loss 0.6682 (0.8088) lr 4.6417e-04 eta 0:08:14
epoch [36/50] batch [360/428] time 0.086 (0.082) data 0.000 (0.002) loss 1.4128 (1.5677) ce_loss 1.3145 (1.3798) teacher_loss 0.6120 (0.8038) loss_zs_kd 0.5112 (0.4835) loss_oracle 0.5452 (0.5221) acc 59.3750 (50.0868) kd_loss 1.0640 (0.8104) lr 4.6417e-04 eta 0:08:14
epoch [36/50] batch [380/428] time 0.075 (0.082) data 0.000 (0.002) loss 1.6141 (1.5671) ce_loss 1.5615 (1.3817) teacher_loss 0.8919 (0.8032) loss_zs_kd 0.4667 (0.4838) loss_oracle 0.4889 (0.5220) acc 46.8750 (50.0740) kd_loss 0.8129 (0.8116) lr 4.6417e-04 eta 0:08:13
epoch [36/50] batch [400/428] time 0.092 (0.082) data 0.000 (0.002) loss 1.6316 (1.5670) ce_loss 1.4639 (1.3821) teacher_loss 0.8606 (0.8043) loss_zs_kd 0.4566 (0.4828) loss_oracle 0.5427 (0.5213) acc 53.1250 (50.1250) kd_loss 0.8690 (0.8110) lr 4.6417e-04 eta 0:08:12
epoch [36/50] batch [420/428] time 0.081 (0.082) data 0.000 (0.002) loss 1.6390 (1.5680) ce_loss 1.4766 (1.3827) teacher_loss 0.8427 (0.8050) loss_zs_kd 0.5129 (0.4829) loss_oracle 0.5399 (0.5215) acc 50.0000 (50.1042) kd_loss 0.9113 (0.8116) lr 4.6417e-04 eta 0:08:11
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,939
* accuracy: 50.0%
* error: 50.0%
* macro_f1: 37.1%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,662
* accuracy: 56.1%
* error: 43.9%
* macro_f1: 31.3%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [37/50] batch [20/428] time 0.070 (0.116) data 0.000 (0.024) loss 1.4631 (1.5808) ce_loss 1.5146 (1.4298) teacher_loss 0.6353 (0.8033) loss_zs_kd 0.5161 (0.4968) loss_oracle 0.5697 (0.5290) acc 46.8750 (46.0938) kd_loss 0.8363 (0.8257) lr 4.1221e-04 eta 0:11:30
epoch [37/50] batch [40/428] time 0.079 (0.096) data 0.000 (0.012) loss 1.5724 (1.6112) ce_loss 1.4873 (1.4547) teacher_loss 0.8276 (0.8421) loss_zs_kd 0.4379 (0.4944) loss_oracle 0.5259 (0.5219) acc 46.8750 (46.0938) kd_loss 0.8374 (0.8160) lr 4.1221e-04 eta 0:09:29
epoch [37/50] batch [60/428] time 0.077 (0.093) data 0.001 (0.008) loss 1.5381 (1.6068) ce_loss 1.6143 (1.4628) teacher_loss 0.7028 (0.8359) loss_zs_kd 0.5600 (0.4904) loss_oracle 0.5552 (0.5257) acc 28.1250 (46.0938) kd_loss 0.8918 (0.8181) lr 4.1221e-04 eta 0:09:11
epoch [37/50] batch [80/428] time 0.079 (0.089) data 0.000 (0.006) loss 1.8271 (1.6083) ce_loss 1.7119 (1.4550) teacher_loss 1.0390 (0.8395) loss_zs_kd 0.6007 (0.4896) loss_oracle 0.4878 (0.5240) acc 37.5000 (46.6016) kd_loss 0.7473 (0.8185) lr 4.1221e-04 eta 0:08:43
epoch [37/50] batch [100/428] time 0.093 (0.088) data 0.000 (0.005) loss 1.7180 (1.5977) ce_loss 1.6602 (1.4337) teacher_loss 0.9968 (0.8342) loss_zs_kd 0.5048 (0.4868) loss_oracle 0.4688 (0.5201) acc 43.7500 (47.4375) kd_loss 0.8749 (0.8124) lr 4.1221e-04 eta 0:08:37
epoch [37/50] batch [120/428] time 0.085 (0.087) data 0.000 (0.004) loss 1.7981 (1.5939) ce_loss 1.6777 (1.4247) teacher_loss 1.0373 (0.8334) loss_zs_kd 0.5355 (0.4827) loss_oracle 0.4931 (0.5191) acc 40.6250 (47.7344) kd_loss 0.7322 (0.8147) lr 4.1221e-04 eta 0:08:30
epoch [37/50] batch [140/428] time 0.089 (0.087) data 0.000 (0.004) loss 1.7342 (1.5952) ce_loss 1.5059 (1.4244) teacher_loss 0.9981 (0.8369) loss_zs_kd 0.4558 (0.4796) loss_oracle 0.5082 (0.5185) acc 43.7500 (47.7679) kd_loss 0.6917 (0.8165) lr 4.1221e-04 eta 0:08:27
epoch [37/50] batch [160/428] time 0.076 (0.086) data 0.000 (0.003) loss 1.4817 (1.5853) ce_loss 1.5088 (1.4161) teacher_loss 0.7291 (0.8274) loss_zs_kd 0.4618 (0.4794) loss_oracle 0.5216 (0.5182) acc 56.2500 (48.1055) kd_loss 0.8876 (0.8188) lr 4.1221e-04 eta 0:08:22
epoch [37/50] batch [180/428] time 0.083 (0.086) data 0.000 (0.003) loss 2.0888 (1.5851) ce_loss 1.7441 (1.4092) teacher_loss 1.3291 (0.8265) loss_zs_kd 0.5213 (0.4814) loss_oracle 0.4991 (0.5179) acc 34.3750 (48.4896) kd_loss 0.8109 (0.8158) lr 4.1221e-04 eta 0:08:19
epoch [37/50] batch [200/428] time 0.082 (0.086) data 0.000 (0.003) loss 1.3700 (1.5862) ce_loss 1.1299 (1.4063) teacher_loss 0.6050 (0.8268) loss_zs_kd 0.4676 (0.4826) loss_oracle 0.5312 (0.5181) acc 59.3750 (48.6406) kd_loss 0.7942 (0.8175) lr 4.1221e-04 eta 0:08:18
epoch [37/50] batch [220/428] time 0.098 (0.086) data 0.000 (0.002) loss 1.6280 (1.5839) ce_loss 1.3438 (1.4029) teacher_loss 0.7741 (0.8259) loss_zs_kd 0.5573 (0.4812) loss_oracle 0.5753 (0.5174) acc 53.1250 (48.8636) kd_loss 0.8546 (0.8164) lr 4.1221e-04 eta 0:08:16
epoch [37/50] batch [240/428] time 0.094 (0.086) data 0.000 (0.002) loss 1.5387 (1.5811) ce_loss 1.3193 (1.3985) teacher_loss 0.7357 (0.8230) loss_zs_kd 0.4384 (0.4809) loss_oracle 0.5838 (0.5177) acc 56.2500 (49.0885) kd_loss 0.8540 (0.8186) lr 4.1221e-04 eta 0:08:14
epoch [37/50] batch [260/428] time 0.084 (0.086) data 0.000 (0.002) loss 1.5400 (1.5751) ce_loss 1.4092 (1.3920) teacher_loss 0.8285 (0.8178) loss_zs_kd 0.3821 (0.4794) loss_oracle 0.5204 (0.5177) acc 53.1250 (49.2428) kd_loss 0.8554 (0.8197) lr 4.1221e-04 eta 0:08:11
epoch [37/50] batch [280/428] time 0.087 (0.086) data 0.000 (0.002) loss 1.5425 (1.5744) ce_loss 1.4932 (1.3890) teacher_loss 0.8088 (0.8179) loss_zs_kd 0.4843 (0.4804) loss_oracle 0.4915 (0.5163) acc 43.7500 (49.3862) kd_loss 0.8208 (0.8175) lr 4.1221e-04 eta 0:08:09
epoch [37/50] batch [300/428] time 0.084 (0.086) data 0.000 (0.002) loss 1.5212 (1.5729) ce_loss 1.3125 (1.3874) teacher_loss 0.7213 (0.8158) loss_zs_kd 0.4689 (0.4805) loss_oracle 0.5655 (0.5168) acc 56.2500 (49.5833) kd_loss 0.7991 (0.8194) lr 4.1221e-04 eta 0:08:07
epoch [37/50] batch [320/428] time 0.084 (0.086) data 0.000 (0.002) loss 1.4286 (1.5752) ce_loss 1.3721 (1.3892) teacher_loss 0.7277 (0.8177) loss_zs_kd 0.4429 (0.4811) loss_oracle 0.4794 (0.5169) acc 43.7500 (49.6387) kd_loss 0.7940 (0.8179) lr 4.1221e-04 eta 0:08:06
epoch [37/50] batch [340/428] time 0.084 (0.086) data 0.000 (0.002) loss 1.2810 (1.5757) ce_loss 1.0879 (1.3898) teacher_loss 0.5039 (0.8177) loss_zs_kd 0.5095 (0.4811) loss_oracle 0.5224 (0.5174) acc 62.5000 (49.6691) kd_loss 0.8251 (0.8188) lr 4.1221e-04 eta 0:08:03
epoch [37/50] batch [360/428] time 0.093 (0.086) data 0.000 (0.002) loss 1.5159 (1.5743) ce_loss 1.3896 (1.3879) teacher_loss 0.7635 (0.8167) loss_zs_kd 0.5121 (0.4813) loss_oracle 0.4963 (0.5170) acc 50.0000 (49.6788) kd_loss 0.9177 (0.8191) lr 4.1221e-04 eta 0:08:02
epoch [37/50] batch [380/428] time 0.087 (0.086) data 0.000 (0.002) loss 1.4600 (1.5777) ce_loss 1.1748 (1.3898) teacher_loss 0.7348 (0.8200) loss_zs_kd 0.4645 (0.4811) loss_oracle 0.4929 (0.5172) acc 62.5000 (49.6053) kd_loss 0.8970 (0.8196) lr 4.1221e-04 eta 0:08:00
epoch [37/50] batch [400/428] time 0.084 (0.086) data 0.000 (0.001) loss 1.4102 (1.5739) ce_loss 1.2773 (1.3850) teacher_loss 0.6717 (0.8165) loss_zs_kd 0.4321 (0.4805) loss_oracle 0.5224 (0.5172) acc 56.2500 (49.7734) kd_loss 0.8802 (0.8191) lr 4.1221e-04 eta 0:07:59
epoch [37/50] batch [420/428] time 0.087 (0.086) data 0.000 (0.001) loss 1.4871 (1.5737) ce_loss 1.4180 (1.3837) teacher_loss 0.7677 (0.8160) loss_zs_kd 0.4945 (0.4806) loss_oracle 0.4722 (0.5173) acc 40.6250 (49.9107) kd_loss 0.8532 (0.8198) lr 4.1221e-04 eta 0:07:57
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,882
* accuracy: 49.0%
* error: 51.0%
* macro_f1: 36.0%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,637
* accuracy: 55.6%
* error: 44.4%
* macro_f1: 30.3%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [38/50] batch [20/428] time 0.063 (0.105) data 0.000 (0.030) loss 1.6131 (1.5096) ce_loss 1.3555 (1.3272) teacher_loss 0.8925 (0.7717) loss_zs_kd 0.3914 (0.4537) loss_oracle 0.5249 (0.5111) acc 59.3750 (53.7500) kd_loss 0.9957 (0.8517) lr 3.6258e-04 eta 0:09:41
epoch [38/50] batch [40/428] time 0.069 (0.084) data 0.000 (0.015) loss 1.5514 (1.5179) ce_loss 1.3945 (1.3391) teacher_loss 0.8172 (0.7732) loss_zs_kd 0.4624 (0.4680) loss_oracle 0.5030 (0.5107) acc 43.7500 (51.7188) kd_loss 0.8056 (0.8293) lr 3.6258e-04 eta 0:07:45
epoch [38/50] batch [60/428] time 0.078 (0.078) data 0.001 (0.010) loss 1.6926 (1.5409) ce_loss 1.3350 (1.3484) teacher_loss 0.9495 (0.7958) loss_zs_kd 0.4962 (0.4701) loss_oracle 0.4950 (0.5101) acc 50.0000 (50.3646) kd_loss 0.8403 (0.8212) lr 3.6258e-04 eta 0:07:11
epoch [38/50] batch [80/428] time 0.072 (0.078) data 0.000 (0.008) loss 1.8174 (1.5414) ce_loss 1.6816 (1.3475) teacher_loss 1.0985 (0.7951) loss_zs_kd 0.4645 (0.4759) loss_oracle 0.4867 (0.5083) acc 25.0000 (50.7812) kd_loss 0.7853 (0.8184) lr 3.6258e-04 eta 0:07:09
epoch [38/50] batch [100/428] time 0.081 (0.079) data 0.000 (0.006) loss 1.3676 (1.5400) ce_loss 1.1846 (1.3479) teacher_loss 0.5675 (0.7939) loss_zs_kd 0.4664 (0.4760) loss_oracle 0.5669 (0.5082) acc 53.1250 (51.1562) kd_loss 0.7837 (0.8191) lr 3.6258e-04 eta 0:07:11
epoch [38/50] batch [120/428] time 0.087 (0.080) data 0.000 (0.005) loss 1.6020 (1.5423) ce_loss 1.4277 (1.3499) teacher_loss 0.7977 (0.7920) loss_zs_kd 0.4360 (0.4775) loss_oracle 0.5862 (0.5116) acc 46.8750 (50.9896) kd_loss 0.9130 (0.8218) lr 3.6258e-04 eta 0:07:15
epoch [38/50] batch [140/428] time 0.090 (0.081) data 0.000 (0.005) loss 1.4386 (1.5529) ce_loss 1.2471 (1.3564) teacher_loss 0.6692 (0.8003) loss_zs_kd 0.4814 (0.4792) loss_oracle 0.5287 (0.5130) acc 50.0000 (50.9375) kd_loss 0.9045 (0.8195) lr 3.6258e-04 eta 0:07:17
epoch [38/50] batch [160/428] time 0.085 (0.081) data 0.000 (0.004) loss 1.5173 (1.5553) ce_loss 1.4434 (1.3618) teacher_loss 0.7067 (0.8052) loss_zs_kd 0.5182 (0.4768) loss_oracle 0.5515 (0.5116) acc 53.1250 (50.7422) kd_loss 0.8377 (0.8182) lr 3.6258e-04 eta 0:07:18
epoch [38/50] batch [180/428] time 0.083 (0.082) data 0.000 (0.004) loss 1.4231 (1.5515) ce_loss 1.2686 (1.3575) teacher_loss 0.7441 (0.8011) loss_zs_kd 0.4670 (0.4762) loss_oracle 0.4455 (0.5123) acc 53.1250 (50.7465) kd_loss 0.6836 (0.8214) lr 3.6258e-04 eta 0:07:18
epoch [38/50] batch [200/428] time 0.078 (0.082) data 0.000 (0.003) loss 1.5814 (1.5569) ce_loss 1.4746 (1.3634) teacher_loss 0.8509 (0.8061) loss_zs_kd 0.4127 (0.4767) loss_oracle 0.5241 (0.5125) acc 56.2500 (50.6875) kd_loss 0.8341 (0.8212) lr 3.6258e-04 eta 0:07:19
epoch [38/50] batch [220/428] time 0.080 (0.082) data 0.000 (0.003) loss 1.5161 (1.5546) ce_loss 1.3799 (1.3622) teacher_loss 0.7308 (0.8017) loss_zs_kd 0.5281 (0.4786) loss_oracle 0.5213 (0.5136) acc 43.7500 (50.7812) kd_loss 0.8239 (0.8231) lr 3.6258e-04 eta 0:07:19
epoch [38/50] batch [240/428] time 0.084 (0.082) data 0.000 (0.003) loss 1.4857 (1.5572) ce_loss 1.4141 (1.3624) teacher_loss 0.7013 (0.8034) loss_zs_kd 0.4797 (0.4802) loss_oracle 0.5445 (0.5137) acc 59.3750 (50.7943) kd_loss 0.8398 (0.8198) lr 3.6258e-04 eta 0:07:18
epoch [38/50] batch [260/428] time 0.085 (0.082) data 0.000 (0.003) loss 1.5997 (1.5564) ce_loss 1.2666 (1.3608) teacher_loss 0.8651 (0.8031) loss_zs_kd 0.5469 (0.4807) loss_oracle 0.4611 (0.5129) acc 56.2500 (50.7812) kd_loss 0.6119 (0.8179) lr 3.6258e-04 eta 0:07:17
epoch [38/50] batch [280/428] time 0.078 (0.082) data 0.000 (0.002) loss 1.6816 (1.5598) ce_loss 1.4219 (1.3635) teacher_loss 0.9151 (0.8067) loss_zs_kd 0.4934 (0.4798) loss_oracle 0.5199 (0.5132) acc 40.6250 (50.6027) kd_loss 0.9179 (0.8155) lr 3.6258e-04 eta 0:07:15
epoch [38/50] batch [300/428] time 0.081 (0.082) data 0.000 (0.002) loss 1.4766 (1.5625) ce_loss 1.1768 (1.3659) teacher_loss 0.7421 (0.8097) loss_zs_kd 0.4234 (0.4788) loss_oracle 0.5229 (0.5134) acc 53.1250 (50.3333) kd_loss 0.6837 (0.8148) lr 3.6258e-04 eta 0:07:12
epoch [38/50] batch [320/428] time 0.077 (0.082) data 0.000 (0.002) loss 1.5940 (1.5621) ce_loss 1.5117 (1.3659) teacher_loss 0.8129 (0.8095) loss_zs_kd 0.4638 (0.4783) loss_oracle 0.5493 (0.5135) acc 37.5000 (50.3809) kd_loss 0.7980 (0.8153) lr 3.6258e-04 eta 0:07:11
epoch [38/50] batch [340/428] time 0.087 (0.082) data 0.000 (0.002) loss 1.7434 (1.5637) ce_loss 1.6836 (1.3682) teacher_loss 0.9852 (0.8106) loss_zs_kd 0.4551 (0.4787) loss_oracle 0.5307 (0.5137) acc 43.7500 (50.3768) kd_loss 0.8050 (0.8171) lr 3.6258e-04 eta 0:07:10
epoch [38/50] batch [360/428] time 0.082 (0.082) data 0.000 (0.002) loss 1.3233 (1.5637) ce_loss 1.2607 (1.3709) teacher_loss 0.6531 (0.8110) loss_zs_kd 0.4067 (0.4793) loss_oracle 0.4669 (0.5130) acc 53.1250 (50.2170) kd_loss 1.0173 (0.8187) lr 3.6258e-04 eta 0:07:08
epoch [38/50] batch [380/428] time 0.085 (0.083) data 0.000 (0.002) loss 1.5269 (1.5640) ce_loss 1.3047 (1.3727) teacher_loss 0.7932 (0.8109) loss_zs_kd 0.5292 (0.4807) loss_oracle 0.4690 (0.5127) acc 68.7500 (50.1809) kd_loss 0.8487 (0.8200) lr 3.6258e-04 eta 0:07:07
epoch [38/50] batch [400/428] time 0.082 (0.083) data 0.000 (0.002) loss 1.4423 (1.5666) ce_loss 1.2500 (1.3773) teacher_loss 0.6687 (0.8130) loss_zs_kd 0.4921 (0.4819) loss_oracle 0.5275 (0.5127) acc 53.1250 (50.0469) kd_loss 0.7540 (0.8201) lr 3.6258e-04 eta 0:07:06
epoch [38/50] batch [420/428] time 0.078 (0.083) data 0.000 (0.002) loss 1.3624 (1.5648) ce_loss 1.2480 (1.3750) teacher_loss 0.5892 (0.8110) loss_zs_kd 0.4640 (0.4817) loss_oracle 0.5412 (0.5130) acc 56.2500 (50.1414) kd_loss 0.8678 (0.8204) lr 3.6258e-04 eta 0:07:05
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,929
* accuracy: 49.8%
* error: 50.2%
* macro_f1: 36.8%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,595
* accuracy: 54.7%
* error: 45.3%
* macro_f1: 29.5%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [39/50] batch [20/428] time 0.086 (0.111) data 0.000 (0.024) loss 1.5874 (1.5096) ce_loss 1.4141 (1.3532) teacher_loss 0.8401 (0.7444) loss_zs_kd 0.5359 (0.4892) loss_oracle 0.4794 (0.5206) acc 43.7500 (49.5312) kd_loss 0.7369 (0.8314) lr 3.1545e-04 eta 0:09:26
epoch [39/50] batch [40/428] time 0.081 (0.094) data 0.000 (0.012) loss 1.6930 (1.5604) ce_loss 1.4902 (1.3919) teacher_loss 0.9806 (0.7993) loss_zs_kd 0.4669 (0.4883) loss_oracle 0.4790 (0.5170) acc 53.1250 (48.6719) kd_loss 0.7872 (0.8312) lr 3.1545e-04 eta 0:08:01
epoch [39/50] batch [60/428] time 0.089 (0.091) data 0.001 (0.008) loss 1.6978 (1.5660) ce_loss 1.4844 (1.3891) teacher_loss 0.8575 (0.8047) loss_zs_kd 0.5138 (0.4872) loss_oracle 0.5835 (0.5176) acc 50.0000 (48.3333) kd_loss 0.9667 (0.8263) lr 3.1545e-04 eta 0:07:43
epoch [39/50] batch [80/428] time 0.084 (0.090) data 0.000 (0.006) loss 1.7447 (1.5716) ce_loss 1.5771 (1.3909) teacher_loss 0.9943 (0.8125) loss_zs_kd 0.5072 (0.4886) loss_oracle 0.4969 (0.5148) acc 40.6250 (48.7891) kd_loss 0.8726 (0.8217) lr 3.1545e-04 eta 0:07:33
epoch [39/50] batch [100/428] time 0.094 (0.089) data 0.000 (0.005) loss 1.3706 (1.5648) ce_loss 1.1377 (1.3785) teacher_loss 0.6192 (0.8054) loss_zs_kd 0.4843 (0.4894) loss_oracle 0.5092 (0.5147) acc 59.3750 (49.3750) kd_loss 0.9121 (0.8238) lr 3.1545e-04 eta 0:07:26
epoch [39/50] batch [120/428] time 0.084 (0.088) data 0.000 (0.004) loss 1.4820 (1.5662) ce_loss 1.3906 (1.3809) teacher_loss 0.8064 (0.8068) loss_zs_kd 0.4742 (0.4917) loss_oracle 0.4385 (0.5136) acc 50.0000 (49.4531) kd_loss 0.7261 (0.8281) lr 3.1545e-04 eta 0:07:21
epoch [39/50] batch [140/428] time 0.084 (0.087) data 0.000 (0.004) loss 1.5753 (1.5641) ce_loss 1.4365 (1.3750) teacher_loss 0.8056 (0.8049) loss_zs_kd 0.4936 (0.4921) loss_oracle 0.5229 (0.5131) acc 43.7500 (49.8438) kd_loss 0.7932 (0.8271) lr 3.1545e-04 eta 0:07:12
epoch [39/50] batch [160/428] time 0.098 (0.087) data 0.000 (0.003) loss 1.6601 (1.5616) ce_loss 1.5811 (1.3728) teacher_loss 0.9629 (0.8017) loss_zs_kd 0.4166 (0.4922) loss_oracle 0.4890 (0.5138) acc 43.7500 (50.0000) kd_loss 0.8281 (0.8273) lr 3.1545e-04 eta 0:07:10
epoch [39/50] batch [180/428] time 0.075 (0.086) data 0.000 (0.003) loss 1.3316 (1.5595) ce_loss 1.1748 (1.3702) teacher_loss 0.6300 (0.7996) loss_zs_kd 0.4627 (0.4910) loss_oracle 0.4702 (0.5145) acc 56.2500 (49.9479) kd_loss 0.8764 (0.8294) lr 3.1545e-04 eta 0:07:04
epoch [39/50] batch [200/428] time 0.086 (0.085) data 0.000 (0.003) loss 1.7538 (1.5602) ce_loss 1.5664 (1.3698) teacher_loss 0.9199 (0.8004) loss_zs_kd 0.5754 (0.4913) loss_oracle 0.5461 (0.5141) acc 46.8750 (49.8906) kd_loss 0.8681 (0.8279) lr 3.1545e-04 eta 0:07:01
epoch [39/50] batch [220/428] time 0.082 (0.085) data 0.000 (0.002) loss 1.6019 (1.5644) ce_loss 1.4355 (1.3745) teacher_loss 0.8697 (0.8057) loss_zs_kd 0.4603 (0.4901) loss_oracle 0.5021 (0.5136) acc 50.0000 (49.7869) kd_loss 0.8542 (0.8281) lr 3.1545e-04 eta 0:06:58
epoch [39/50] batch [240/428] time 0.083 (0.085) data 0.000 (0.002) loss 1.8260 (1.5651) ce_loss 1.4648 (1.3722) teacher_loss 1.0634 (0.8080) loss_zs_kd 0.4547 (0.4895) loss_oracle 0.5352 (0.5123) acc 56.2500 (49.8438) kd_loss 0.7392 (0.8265) lr 3.1545e-04 eta 0:06:56
epoch [39/50] batch [260/428] time 0.080 (0.085) data 0.000 (0.002) loss 1.5110 (1.5620) ce_loss 1.3359 (1.3721) teacher_loss 0.8148 (0.8057) loss_zs_kd 0.4557 (0.4894) loss_oracle 0.4683 (0.5116) acc 50.0000 (49.8317) kd_loss 0.8053 (0.8295) lr 3.1545e-04 eta 0:06:53
epoch [39/50] batch [280/428] time 0.087 (0.085) data 0.000 (0.002) loss 1.7580 (1.5606) ce_loss 1.4814 (1.3719) teacher_loss 1.0679 (0.8058) loss_zs_kd 0.4444 (0.4888) loss_oracle 0.4679 (0.5104) acc 46.8750 (49.8326) kd_loss 0.7572 (0.8292) lr 3.1545e-04 eta 0:06:50
epoch [39/50] batch [300/428] time 0.089 (0.085) data 0.000 (0.002) loss 1.5186 (1.5635) ce_loss 1.4336 (1.3753) teacher_loss 0.7936 (0.8105) loss_zs_kd 0.4767 (0.4876) loss_oracle 0.4866 (0.5091) acc 50.0000 (49.7604) kd_loss 0.8290 (0.8279) lr 3.1545e-04 eta 0:06:49
epoch [39/50] batch [320/428] time 0.088 (0.085) data 0.000 (0.002) loss 1.4488 (1.5615) ce_loss 1.2549 (1.3721) teacher_loss 0.7433 (0.8092) loss_zs_kd 0.4132 (0.4868) loss_oracle 0.4989 (0.5089) acc 56.2500 (49.9414) kd_loss 0.8756 (0.8277) lr 3.1545e-04 eta 0:06:47
epoch [39/50] batch [340/428] time 0.080 (0.085) data 0.000 (0.002) loss 1.5690 (1.5628) ce_loss 1.3760 (1.3731) teacher_loss 0.8026 (0.8104) loss_zs_kd 0.5685 (0.4872) loss_oracle 0.4821 (0.5088) acc 50.0000 (49.8713) kd_loss 0.8318 (0.8257) lr 3.1545e-04 eta 0:06:46
epoch [39/50] batch [360/428] time 0.081 (0.085) data 0.000 (0.002) loss 1.6485 (1.5606) ce_loss 1.3428 (1.3713) teacher_loss 0.7874 (0.8072) loss_zs_kd 0.4914 (0.4873) loss_oracle 0.6154 (0.5098) acc 56.2500 (49.8958) kd_loss 0.9612 (0.8270) lr 3.1545e-04 eta 0:06:43
epoch [39/50] batch [380/428] time 0.091 (0.084) data 0.000 (0.002) loss 1.7020 (1.5623) ce_loss 1.5020 (1.3756) teacher_loss 0.9363 (0.8087) loss_zs_kd 0.5084 (0.4869) loss_oracle 0.5115 (0.5102) acc 43.7500 (49.8273) kd_loss 0.7714 (0.8280) lr 3.1545e-04 eta 0:06:41
epoch [39/50] batch [400/428] time 0.080 (0.084) data 0.000 (0.001) loss 1.8588 (1.5646) ce_loss 1.6846 (1.3784) teacher_loss 1.0383 (0.8119) loss_zs_kd 0.4750 (0.4861) loss_oracle 0.5830 (0.5097) acc 31.2500 (49.7109) kd_loss 0.8008 (0.8271) lr 3.1545e-04 eta 0:06:39
epoch [39/50] batch [420/428] time 0.078 (0.084) data 0.000 (0.001) loss 1.7645 (1.5655) ce_loss 1.6123 (1.3791) teacher_loss 1.0371 (0.8137) loss_zs_kd 0.4424 (0.4852) loss_oracle 0.5063 (0.5092) acc 50.0000 (49.7693) kd_loss 0.9492 (0.8266) lr 3.1545e-04 eta 0:06:37
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,879
* accuracy: 49.0%
* error: 51.0%
* macro_f1: 35.8%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,639
* accuracy: 55.7%
* error: 44.3%
* macro_f1: 29.8%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [40/50] batch [20/428] time 0.081 (0.116) data 0.000 (0.027) loss 1.6174 (1.5427) ce_loss 1.5938 (1.3483) teacher_loss 0.8591 (0.7892) loss_zs_kd 0.4525 (0.4737) loss_oracle 0.5321 (0.5167) acc 37.5000 (49.8438) kd_loss 0.9300 (0.8657) lr 2.7103e-04 eta 0:09:05
epoch [40/50] batch [40/428] time 0.092 (0.100) data 0.000 (0.014) loss 1.6637 (1.5485) ce_loss 1.5420 (1.3643) teacher_loss 0.9453 (0.7901) loss_zs_kd 0.4407 (0.4836) loss_oracle 0.4981 (0.5167) acc 31.2500 (49.1406) kd_loss 0.8145 (0.8452) lr 2.7103e-04 eta 0:07:48
epoch [40/50] batch [60/428] time 0.084 (0.096) data 0.001 (0.009) loss 1.4478 (1.5461) ce_loss 1.2158 (1.3660) teacher_loss 0.7809 (0.7953) loss_zs_kd 0.3905 (0.4822) loss_oracle 0.4717 (0.5098) acc 62.5000 (49.5312) kd_loss 0.9487 (0.8473) lr 2.7103e-04 eta 0:07:24
epoch [40/50] batch [80/428] time 0.089 (0.093) data 0.000 (0.007) loss 1.7755 (1.5419) ce_loss 1.6045 (1.3528) teacher_loss 0.9632 (0.7958) loss_zs_kd 0.4875 (0.4820) loss_oracle 0.5685 (0.5051) acc 46.8750 (50.5469) kd_loss 0.8214 (0.8381) lr 2.7103e-04 eta 0:07:09
epoch [40/50] batch [100/428] time 0.090 (0.091) data 0.000 (0.006) loss 1.4001 (1.5420) ce_loss 1.1631 (1.3548) teacher_loss 0.7294 (0.7965) loss_zs_kd 0.4453 (0.4788) loss_oracle 0.4481 (0.5061) acc 56.2500 (50.3750) kd_loss 0.8368 (0.8355) lr 2.7103e-04 eta 0:07:00
epoch [40/50] batch [120/428] time 0.086 (0.090) data 0.000 (0.005) loss 1.4812 (1.5418) ce_loss 1.2568 (1.3510) teacher_loss 0.7139 (0.7968) loss_zs_kd 0.4717 (0.4798) loss_oracle 0.5314 (0.5051) acc 59.3750 (50.5990) kd_loss 0.7897 (0.8360) lr 2.7103e-04 eta 0:06:54
epoch [40/50] batch [140/428] time 0.085 (0.090) data 0.000 (0.004) loss 1.5016 (1.5389) ce_loss 1.5400 (1.3475) teacher_loss 0.7515 (0.7950) loss_zs_kd 0.4548 (0.4793) loss_oracle 0.5228 (0.5043) acc 40.6250 (50.7812) kd_loss 0.9980 (0.8365) lr 2.7103e-04 eta 0:06:49
epoch [40/50] batch [160/428] time 0.088 (0.089) data 0.000 (0.004) loss 1.9664 (1.5449) ce_loss 2.0078 (1.3593) teacher_loss 1.2731 (0.8023) loss_zs_kd 0.4722 (0.4777) loss_oracle 0.4571 (0.5038) acc 28.1250 (50.6445) kd_loss 0.8331 (0.8353) lr 2.7103e-04 eta 0:06:45
epoch [40/50] batch [180/428] time 0.088 (0.089) data 0.000 (0.003) loss 1.6187 (1.5454) ce_loss 1.4258 (1.3614) teacher_loss 0.9356 (0.8028) loss_zs_kd 0.4457 (0.4795) loss_oracle 0.4602 (0.5029) acc 43.7500 (50.3472) kd_loss 0.8009 (0.8383) lr 2.7103e-04 eta 0:06:41
epoch [40/50] batch [200/428] time 0.075 (0.088) data 0.000 (0.003) loss 1.6187 (1.5471) ce_loss 1.4795 (1.3662) teacher_loss 0.9279 (0.8050) loss_zs_kd 0.5361 (0.4792) loss_oracle 0.4227 (0.5024) acc 59.3750 (50.2031) kd_loss 0.7470 (0.8357) lr 2.7103e-04 eta 0:06:37
epoch [40/50] batch [220/428] time 0.093 (0.088) data 0.000 (0.003) loss 1.4815 (1.5469) ce_loss 1.2568 (1.3678) teacher_loss 0.7460 (0.8042) loss_zs_kd 0.4826 (0.4801) loss_oracle 0.4942 (0.5026) acc 53.1250 (50.2415) kd_loss 0.7088 (0.8352) lr 2.7103e-04 eta 0:06:35
epoch [40/50] batch [240/428] time 0.094 (0.088) data 0.000 (0.003) loss 1.5060 (1.5450) ce_loss 1.3350 (1.3660) teacher_loss 0.7449 (0.8017) loss_zs_kd 0.4742 (0.4812) loss_oracle 0.5240 (0.5026) acc 40.6250 (50.2734) kd_loss 0.9390 (0.8359) lr 2.7103e-04 eta 0:06:33
epoch [40/50] batch [260/428] time 0.087 (0.088) data 0.000 (0.002) loss 1.4571 (1.5476) ce_loss 1.1797 (1.3675) teacher_loss 0.7514 (0.8031) loss_zs_kd 0.4053 (0.4831) loss_oracle 0.5030 (0.5030) acc 53.1250 (50.2764) kd_loss 0.8530 (0.8357) lr 2.7103e-04 eta 0:06:29
epoch [40/50] batch [280/428] time 0.085 (0.088) data 0.000 (0.002) loss 1.3635 (1.5497) ce_loss 1.2158 (1.3693) teacher_loss 0.6096 (0.8044) loss_zs_kd 0.5060 (0.4825) loss_oracle 0.5009 (0.5041) acc 53.1250 (50.1004) kd_loss 0.8958 (0.8379) lr 2.7103e-04 eta 0:06:27
epoch [40/50] batch [300/428] time 0.088 (0.087) data 0.000 (0.002) loss 1.5149 (1.5513) ce_loss 1.3867 (1.3727) teacher_loss 0.7448 (0.8047) loss_zs_kd 0.5021 (0.4824) loss_oracle 0.5190 (0.5054) acc 40.6250 (50.0729) kd_loss 0.9983 (0.8392) lr 2.7103e-04 eta 0:06:24
epoch [40/50] batch [320/428] time 0.082 (0.087) data 0.000 (0.002) loss 1.6068 (1.5514) ce_loss 1.3643 (1.3702) teacher_loss 0.8674 (0.8048) loss_zs_kd 0.4452 (0.4832) loss_oracle 0.5168 (0.5050) acc 50.0000 (50.2930) kd_loss 0.8173 (0.8385) lr 2.7103e-04 eta 0:06:21
epoch [40/50] batch [340/428] time 0.083 (0.087) data 0.000 (0.002) loss 1.6052 (1.5501) ce_loss 1.4326 (1.3703) teacher_loss 0.9043 (0.8038) loss_zs_kd 0.4641 (0.4830) loss_oracle 0.4688 (0.5048) acc 43.7500 (50.3217) kd_loss 0.7422 (0.8393) lr 2.7103e-04 eta 0:06:19
epoch [40/50] batch [360/428] time 0.079 (0.087) data 0.000 (0.002) loss 1.6939 (1.5523) ce_loss 1.4316 (1.3701) teacher_loss 0.8786 (0.8053) loss_zs_kd 0.4973 (0.4835) loss_oracle 0.5666 (0.5052) acc 43.7500 (50.2344) kd_loss 0.8321 (0.8376) lr 2.7103e-04 eta 0:06:16
epoch [40/50] batch [380/428] time 0.082 (0.087) data 0.000 (0.002) loss 1.7401 (1.5506) ce_loss 1.5420 (1.3684) teacher_loss 0.9196 (0.8034) loss_zs_kd 0.4922 (0.4832) loss_oracle 0.5745 (0.5057) acc 46.8750 (50.2961) kd_loss 0.8586 (0.8385) lr 2.7103e-04 eta 0:06:14
epoch [40/50] batch [400/428] time 0.089 (0.086) data 0.000 (0.002) loss 1.6108 (1.5523) ce_loss 1.4102 (1.3712) teacher_loss 0.8248 (0.8043) loss_zs_kd 0.4530 (0.4828) loss_oracle 0.5595 (0.5066) acc 53.1250 (50.2578) kd_loss 0.9905 (0.8396) lr 2.7103e-04 eta 0:06:12
epoch [40/50] batch [420/428] time 0.078 (0.086) data 0.000 (0.002) loss 1.6977 (1.5529) ce_loss 1.6768 (1.3728) teacher_loss 0.9489 (0.8042) loss_zs_kd 0.4864 (0.4836) loss_oracle 0.5056 (0.5069) acc 28.1250 (50.1860) kd_loss 0.9103 (0.8387) lr 2.7103e-04 eta 0:06:09
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,967
* accuracy: 50.5%
* error: 49.5%
* macro_f1: 36.8%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,588
* accuracy: 54.6%
* error: 45.4%
* macro_f1: 30.3%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [41/50] batch [20/428] time 0.077 (0.115) data 0.000 (0.029) loss 1.5382 (1.5542) ce_loss 1.1582 (1.3331) teacher_loss 0.7933 (0.8017) loss_zs_kd 0.4511 (0.4972) loss_oracle 0.5193 (0.5039) acc 62.5000 (51.0938) kd_loss 0.7951 (0.8273) lr 2.2949e-04 eta 0:08:08
epoch [41/50] batch [40/428] time 0.080 (0.100) data 0.000 (0.014) loss 1.4585 (1.5566) ce_loss 1.2627 (1.3728) teacher_loss 0.6900 (0.8011) loss_zs_kd 0.5228 (0.4984) loss_oracle 0.5071 (0.5063) acc 59.3750 (50.2344) kd_loss 0.7783 (0.8444) lr 2.2949e-04 eta 0:07:04
epoch [41/50] batch [60/428] time 0.081 (0.095) data 0.000 (0.010) loss 1.3671 (1.5763) ce_loss 1.1289 (1.3905) teacher_loss 0.6284 (0.8190) loss_zs_kd 0.4977 (0.5039) loss_oracle 0.4899 (0.5053) acc 56.2500 (48.4896) kd_loss 0.7478 (0.8419) lr 2.2949e-04 eta 0:06:38
epoch [41/50] batch [80/428] time 0.085 (0.092) data 0.000 (0.007) loss 1.6225 (1.5666) ce_loss 1.4990 (1.3933) teacher_loss 0.8066 (0.8111) loss_zs_kd 0.5049 (0.5031) loss_oracle 0.5635 (0.5040) acc 50.0000 (47.9688) kd_loss 0.9064 (0.8436) lr 2.2949e-04 eta 0:06:24
epoch [41/50] batch [100/428] time 0.089 (0.090) data 0.000 (0.006) loss 1.4902 (1.5614) ce_loss 1.4443 (1.3910) teacher_loss 0.7522 (0.8084) loss_zs_kd 0.4908 (0.5036) loss_oracle 0.4926 (0.5013) acc 46.8750 (48.3125) kd_loss 0.9102 (0.8410) lr 2.2949e-04 eta 0:06:17
epoch [41/50] batch [120/428] time 0.081 (0.089) data 0.000 (0.005) loss 1.3313 (1.5596) ce_loss 1.1709 (1.3903) teacher_loss 0.6509 (0.8079) loss_zs_kd 0.4467 (0.4999) loss_oracle 0.4570 (0.5017) acc 53.1250 (48.4375) kd_loss 0.7810 (0.8418) lr 2.2949e-04 eta 0:06:11
epoch [41/50] batch [140/428] time 0.083 (0.089) data 0.000 (0.004) loss 1.8414 (1.5593) ce_loss 1.6123 (1.3889) teacher_loss 1.0671 (0.8061) loss_zs_kd 0.5560 (0.4999) loss_oracle 0.4963 (0.5031) acc 37.5000 (48.5268) kd_loss 0.6536 (0.8370) lr 2.2949e-04 eta 0:06:07
epoch [41/50] batch [160/428] time 0.090 (0.088) data 0.000 (0.004) loss 1.5931 (1.5600) ce_loss 1.4355 (1.3884) teacher_loss 0.9031 (0.8086) loss_zs_kd 0.4314 (0.4972) loss_oracle 0.4743 (0.5028) acc 40.6250 (48.5742) kd_loss 0.8846 (0.8370) lr 2.2949e-04 eta 0:06:04
epoch [41/50] batch [180/428] time 0.085 (0.088) data 0.000 (0.003) loss 1.3721 (1.5589) ce_loss 1.3047 (1.3860) teacher_loss 0.6322 (0.8078) loss_zs_kd 0.4667 (0.4969) loss_oracle 0.5066 (0.5027) acc 59.3750 (49.0451) kd_loss 0.8382 (0.8371) lr 2.2949e-04 eta 0:06:01
epoch [41/50] batch [200/428] time 0.085 (0.088) data 0.000 (0.003) loss 1.4893 (1.5559) ce_loss 1.3398 (1.3810) teacher_loss 0.7311 (0.8052) loss_zs_kd 0.5285 (0.4946) loss_oracle 0.4940 (0.5034) acc 50.0000 (49.2031) kd_loss 0.8085 (0.8382) lr 2.2949e-04 eta 0:05:58
epoch [41/50] batch [220/428] time 0.082 (0.088) data 0.000 (0.003) loss 1.8692 (1.5575) ce_loss 1.4531 (1.3786) teacher_loss 1.1326 (0.8069) loss_zs_kd 0.4894 (0.4937) loss_oracle 0.4919 (0.5038) acc 53.1250 (49.2472) kd_loss 0.6625 (0.8374) lr 2.2949e-04 eta 0:05:56
epoch [41/50] batch [240/428] time 0.092 (0.088) data 0.000 (0.003) loss 1.4471 (1.5563) ce_loss 1.0957 (1.3754) teacher_loss 0.7583 (0.8057) loss_zs_kd 0.4236 (0.4927) loss_oracle 0.4771 (0.5042) acc 56.2500 (49.3620) kd_loss 0.7256 (0.8356) lr 2.2949e-04 eta 0:05:54
epoch [41/50] batch [260/428] time 0.086 (0.088) data 0.000 (0.002) loss 1.6967 (1.5571) ce_loss 1.3877 (1.3749) teacher_loss 0.9935 (0.8057) loss_zs_kd 0.4629 (0.4923) loss_oracle 0.4718 (0.5052) acc 40.6250 (49.2788) kd_loss 0.6214 (0.8335) lr 2.2949e-04 eta 0:05:52
epoch [41/50] batch [280/428] time 0.090 (0.087) data 0.000 (0.002) loss 1.5244 (1.5572) ce_loss 1.4053 (1.3738) teacher_loss 0.7767 (0.8059) loss_zs_kd 0.4544 (0.4904) loss_oracle 0.5205 (0.5061) acc 43.7500 (49.3192) kd_loss 0.8088 (0.8328) lr 2.2949e-04 eta 0:05:49
epoch [41/50] batch [300/428] time 0.082 (0.087) data 0.000 (0.002) loss 1.6298 (1.5546) ce_loss 1.3574 (1.3704) teacher_loss 0.8659 (0.8045) loss_zs_kd 0.5413 (0.4898) loss_oracle 0.4932 (0.5052) acc 43.7500 (49.4479) kd_loss 0.6463 (0.8300) lr 2.2949e-04 eta 0:05:47
epoch [41/50] batch [320/428] time 0.080 (0.087) data 0.000 (0.002) loss 1.4757 (1.5565) ce_loss 1.4043 (1.3749) teacher_loss 0.7006 (0.8075) loss_zs_kd 0.4889 (0.4877) loss_oracle 0.5307 (0.5051) acc 46.8750 (49.2969) kd_loss 0.8258 (0.8291) lr 2.2949e-04 eta 0:05:45
epoch [41/50] batch [340/428] time 0.079 (0.087) data 0.000 (0.002) loss 1.5342 (1.5570) ce_loss 1.3926 (1.3750) teacher_loss 0.7963 (0.8070) loss_zs_kd 0.4762 (0.4886) loss_oracle 0.4998 (0.5057) acc 53.1250 (49.4485) kd_loss 0.7421 (0.8275) lr 2.2949e-04 eta 0:05:42
epoch [41/50] batch [360/428] time 0.082 (0.087) data 0.000 (0.002) loss 1.3346 (1.5519) ce_loss 1.0713 (1.3695) teacher_loss 0.6093 (0.8025) loss_zs_kd 0.4226 (0.4882) loss_oracle 0.5140 (0.5053) acc 59.3750 (49.6875) kd_loss 0.8137 (0.8270) lr 2.2949e-04 eta 0:05:40
epoch [41/50] batch [380/428] time 0.082 (0.087) data 0.000 (0.002) loss 1.1716 (1.5518) ce_loss 1.0986 (1.3709) teacher_loss 0.4925 (0.8023) loss_zs_kd 0.3754 (0.4880) loss_oracle 0.4914 (0.5055) acc 53.1250 (49.6464) kd_loss 0.8683 (0.8272) lr 2.2949e-04 eta 0:05:38
epoch [41/50] batch [400/428] time 0.077 (0.087) data 0.000 (0.002) loss 1.4826 (1.5540) ce_loss 1.1191 (1.3727) teacher_loss 0.7325 (0.8051) loss_zs_kd 0.5010 (0.4875) loss_oracle 0.4996 (0.5051) acc 65.6250 (49.5781) kd_loss 0.8461 (0.8250) lr 2.2949e-04 eta 0:05:36
epoch [41/50] batch [420/428] time 0.078 (0.086) data 0.000 (0.002) loss 1.4439 (1.5579) ce_loss 1.2588 (1.3763) teacher_loss 0.7272 (0.8084) loss_zs_kd 0.4663 (0.4880) loss_oracle 0.4835 (0.5055) acc 53.1250 (49.4048) kd_loss 0.7561 (0.8242) lr 2.2949e-04 eta 0:05:33
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,939
* accuracy: 50.0%
* error: 50.0%
* macro_f1: 36.6%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,543
* accuracy: 53.6%
* error: 46.4%
* macro_f1: 29.6%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [42/50] batch [20/428] time 0.083 (0.108) data 0.000 (0.024) loss 1.4993 (1.5369) ce_loss 1.4473 (1.3457) teacher_loss 0.8375 (0.7930) loss_zs_kd 0.3746 (0.4838) loss_oracle 0.4745 (0.5020) acc 43.7500 (47.8125) kd_loss 0.8860 (0.8117) lr 1.9098e-04 eta 0:06:55
epoch [42/50] batch [40/428] time 0.073 (0.094) data 0.000 (0.012) loss 1.6323 (1.5732) ce_loss 1.6357 (1.3846) teacher_loss 0.8383 (0.8281) loss_zs_kd 0.5141 (0.4842) loss_oracle 0.5369 (0.5030) acc 37.5000 (48.5938) kd_loss 0.8240 (0.8205) lr 1.9098e-04 eta 0:05:57
epoch [42/50] batch [60/428] time 0.095 (0.091) data 0.001 (0.008) loss 1.7211 (1.5705) ce_loss 1.6777 (1.3784) teacher_loss 0.9518 (0.8294) loss_zs_kd 0.5180 (0.4820) loss_oracle 0.5103 (0.5000) acc 37.5000 (49.0104) kd_loss 0.9107 (0.8138) lr 1.9098e-04 eta 0:05:44
epoch [42/50] batch [80/428] time 0.081 (0.089) data 0.000 (0.006) loss 1.2026 (1.5619) ce_loss 1.0156 (1.3656) teacher_loss 0.5015 (0.8223) loss_zs_kd 0.4711 (0.4776) loss_oracle 0.4656 (0.5008) acc 62.5000 (49.4922) kd_loss 0.9696 (0.8114) lr 1.9098e-04 eta 0:05:35
epoch [42/50] batch [100/428] time 0.083 (0.088) data 0.000 (0.005) loss 1.6913 (1.5600) ce_loss 1.6416 (1.3661) teacher_loss 0.9461 (0.8189) loss_zs_kd 0.4416 (0.4789) loss_oracle 0.5244 (0.5017) acc 37.5000 (49.5625) kd_loss 1.0216 (0.8168) lr 1.9098e-04 eta 0:05:30
epoch [42/50] batch [120/428] time 0.093 (0.087) data 0.000 (0.004) loss 1.5691 (1.5609) ce_loss 1.4365 (1.3726) teacher_loss 0.8085 (0.8167) loss_zs_kd 0.4649 (0.4825) loss_oracle 0.5282 (0.5030) acc 50.0000 (49.7656) kd_loss 0.9898 (0.8222) lr 1.9098e-04 eta 0:05:26
epoch [42/50] batch [140/428] time 0.087 (0.087) data 0.000 (0.004) loss 1.7043 (1.5620) ce_loss 1.5859 (1.3741) teacher_loss 1.0198 (0.8173) loss_zs_kd 0.4512 (0.4825) loss_oracle 0.4588 (0.5034) acc 37.5000 (49.8661) kd_loss 0.8263 (0.8224) lr 1.9098e-04 eta 0:05:23
epoch [42/50] batch [160/428] time 0.079 (0.086) data 0.000 (0.003) loss 1.6626 (1.5623) ce_loss 1.4277 (1.3763) teacher_loss 0.8082 (0.8168) loss_zs_kd 0.5472 (0.4838) loss_oracle 0.5809 (0.5036) acc 46.8750 (49.7852) kd_loss 0.8717 (0.8269) lr 1.9098e-04 eta 0:05:19
epoch [42/50] batch [180/428] time 0.092 (0.086) data 0.000 (0.003) loss 1.7876 (1.5607) ce_loss 1.5703 (1.3810) teacher_loss 1.0455 (0.8137) loss_zs_kd 0.5066 (0.4857) loss_oracle 0.4888 (0.5042) acc 43.7500 (49.6528) kd_loss 0.6733 (0.8297) lr 1.9098e-04 eta 0:05:16
epoch [42/50] batch [200/428] time 0.079 (0.086) data 0.000 (0.003) loss 1.4274 (1.5532) ce_loss 1.2432 (1.3723) teacher_loss 0.5946 (0.8057) loss_zs_kd 0.4465 (0.4863) loss_oracle 0.6095 (0.5044) acc 56.2500 (50.0000) kd_loss 1.0182 (0.8294) lr 1.9098e-04 eta 0:05:13
epoch [42/50] batch [220/428] time 0.090 (0.086) data 0.000 (0.002) loss 1.4388 (1.5529) ce_loss 1.2051 (1.3739) teacher_loss 0.7417 (0.8040) loss_zs_kd 0.4879 (0.4882) loss_oracle 0.4531 (0.5048) acc 59.3750 (50.1420) kd_loss 0.7163 (0.8275) lr 1.9098e-04 eta 0:05:11
epoch [42/50] batch [240/428] time 0.079 (0.086) data 0.000 (0.002) loss 1.3991 (1.5543) ce_loss 1.3135 (1.3754) teacher_loss 0.6371 (0.8033) loss_zs_kd 0.4269 (0.4884) loss_oracle 0.5486 (0.5068) acc 53.1250 (50.0651) kd_loss 0.8613 (0.8279) lr 1.9098e-04 eta 0:05:09
epoch [42/50] batch [260/428] time 0.082 (0.085) data 0.000 (0.002) loss 1.6498 (1.5514) ce_loss 1.6455 (1.3695) teacher_loss 0.9280 (0.7994) loss_zs_kd 0.4766 (0.4888) loss_oracle 0.4835 (0.5077) acc 46.8750 (50.2644) kd_loss 0.8023 (0.8271) lr 1.9098e-04 eta 0:05:06
epoch [42/50] batch [280/428] time 0.092 (0.085) data 0.000 (0.002) loss 1.5739 (1.5544) ce_loss 1.5088 (1.3722) teacher_loss 0.8830 (0.8020) loss_zs_kd 0.4678 (0.4898) loss_oracle 0.4569 (0.5075) acc 40.6250 (50.1562) kd_loss 0.7476 (0.8259) lr 1.9098e-04 eta 0:05:05
epoch [42/50] batch [300/428] time 0.078 (0.085) data 0.000 (0.002) loss 1.3871 (1.5545) ce_loss 1.1309 (1.3699) teacher_loss 0.6370 (0.8031) loss_zs_kd 0.4774 (0.4894) loss_oracle 0.5115 (0.5068) acc 53.1250 (50.1667) kd_loss 0.8613 (0.8243) lr 1.9098e-04 eta 0:05:03
epoch [42/50] batch [320/428] time 0.087 (0.085) data 0.000 (0.002) loss 1.6830 (1.5559) ce_loss 1.4502 (1.3706) teacher_loss 0.8935 (0.8050) loss_zs_kd 0.5154 (0.4876) loss_oracle 0.5319 (0.5072) acc 40.6250 (50.0684) kd_loss 0.8646 (0.8247) lr 1.9098e-04 eta 0:05:01
epoch [42/50] batch [340/428] time 0.086 (0.085) data 0.000 (0.002) loss 1.5574 (1.5572) ce_loss 1.2764 (1.3722) teacher_loss 0.7927 (0.8061) loss_zs_kd 0.4996 (0.4875) loss_oracle 0.5149 (0.5073) acc 56.2500 (49.9357) kd_loss 0.8282 (0.8234) lr 1.9098e-04 eta 0:05:00
epoch [42/50] batch [360/428] time 0.084 (0.085) data 0.000 (0.002) loss 1.3451 (1.5561) ce_loss 1.0967 (1.3707) teacher_loss 0.5804 (0.8046) loss_zs_kd 0.5180 (0.4878) loss_oracle 0.5057 (0.5076) acc 59.3750 (50.0781) kd_loss 0.8738 (0.8246) lr 1.9098e-04 eta 0:04:58
epoch [42/50] batch [380/428] time 0.094 (0.086) data 0.000 (0.002) loss 1.5130 (1.5546) ce_loss 1.3105 (1.3661) teacher_loss 0.7655 (0.8038) loss_zs_kd 0.4672 (0.4867) loss_oracle 0.5140 (0.5075) acc 50.0000 (50.2549) kd_loss 0.7332 (0.8233) lr 1.9098e-04 eta 0:04:56
epoch [42/50] batch [400/428] time 0.080 (0.085) data 0.000 (0.001) loss 1.5965 (1.5546) ce_loss 1.3096 (1.3659) teacher_loss 0.8211 (0.8036) loss_zs_kd 0.5500 (0.4860) loss_oracle 0.5004 (0.5080) acc 56.2500 (50.2188) kd_loss 0.6978 (0.8220) lr 1.9098e-04 eta 0:04:55
epoch [42/50] batch [420/428] time 0.076 (0.085) data 0.000 (0.001) loss 1.3925 (1.5545) ce_loss 1.3115 (1.3643) teacher_loss 0.6537 (0.8040) loss_zs_kd 0.4649 (0.4854) loss_oracle 0.5063 (0.5078) acc 65.6250 (50.2976) kd_loss 0.9892 (0.8217) lr 1.9098e-04 eta 0:04:52
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,972
* accuracy: 50.6%
* error: 49.4%
* macro_f1: 37.5%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,570
* accuracy: 54.2%
* error: 45.8%
* macro_f1: 30.0%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [43/50] batch [20/428] time 0.082 (0.090) data 0.000 (0.025) loss 1.7085 (1.5867) ce_loss 1.4639 (1.3700) teacher_loss 0.9734 (0.8428) loss_zs_kd 0.5512 (0.4859) loss_oracle 0.4595 (0.5009) acc 37.5000 (50.9375) kd_loss 0.7621 (0.7860) lr 1.5567e-04 eta 0:05:07
epoch [43/50] batch [40/428] time 0.089 (0.087) data 0.000 (0.012) loss 1.7754 (1.5648) ce_loss 1.5312 (1.3623) teacher_loss 1.0678 (0.8286) loss_zs_kd 0.4608 (0.4779) loss_oracle 0.4773 (0.4973) acc 46.8750 (51.3281) kd_loss 0.7975 (0.7901) lr 1.5567e-04 eta 0:04:56
epoch [43/50] batch [60/428] time 0.078 (0.085) data 0.001 (0.008) loss 1.4695 (1.5353) ce_loss 1.3379 (1.3401) teacher_loss 0.7572 (0.7982) loss_zs_kd 0.4226 (0.4770) loss_oracle 0.5009 (0.4985) acc 50.0000 (51.5104) kd_loss 0.8032 (0.8038) lr 1.5567e-04 eta 0:04:46
epoch [43/50] batch [80/428] time 0.087 (0.085) data 0.000 (0.006) loss 1.6877 (1.5620) ce_loss 1.5732 (1.3703) teacher_loss 0.9031 (0.8173) loss_zs_kd 0.5345 (0.4828) loss_oracle 0.5174 (0.5033) acc 40.6250 (50.0000) kd_loss 0.7326 (0.8045) lr 1.5567e-04 eta 0:04:44
epoch [43/50] batch [100/428] time 0.087 (0.085) data 0.000 (0.005) loss 1.6568 (1.5630) ce_loss 1.6523 (1.3640) teacher_loss 0.9326 (0.8172) loss_zs_kd 0.4819 (0.4826) loss_oracle 0.4832 (0.5046) acc 37.5000 (50.2500) kd_loss 0.8272 (0.8012) lr 1.5567e-04 eta 0:04:42
epoch [43/50] batch [120/428] time 0.079 (0.085) data 0.000 (0.004) loss 1.6097 (1.5635) ce_loss 1.3320 (1.3622) teacher_loss 0.7898 (0.8190) loss_zs_kd 0.4600 (0.4838) loss_oracle 0.5899 (0.5026) acc 65.6250 (50.6250) kd_loss 0.9338 (0.8023) lr 1.5567e-04 eta 0:04:41
epoch [43/50] batch [140/428] time 0.087 (0.085) data 0.000 (0.004) loss 1.6606 (1.5635) ce_loss 1.3594 (1.3631) teacher_loss 0.8851 (0.8165) loss_zs_kd 0.5367 (0.4846) loss_oracle 0.5072 (0.5047) acc 50.0000 (50.6473) kd_loss 0.7602 (0.8061) lr 1.5567e-04 eta 0:04:39
epoch [43/50] batch [160/428] time 0.083 (0.085) data 0.000 (0.003) loss 1.5684 (1.5664) ce_loss 1.3311 (1.3658) teacher_loss 0.8336 (0.8215) loss_zs_kd 0.4158 (0.4831) loss_oracle 0.5269 (0.5034) acc 53.1250 (50.3906) kd_loss 0.7650 (0.8059) lr 1.5567e-04 eta 0:04:37
epoch [43/50] batch [180/428] time 0.082 (0.085) data 0.000 (0.003) loss 1.2424 (1.5667) ce_loss 1.0840 (1.3669) teacher_loss 0.5848 (0.8243) loss_zs_kd 0.4205 (0.4819) loss_oracle 0.4474 (0.5014) acc 59.3750 (50.4340) kd_loss 0.8459 (0.8080) lr 1.5567e-04 eta 0:04:34
epoch [43/50] batch [200/428] time 0.077 (0.084) data 0.000 (0.003) loss 1.5662 (1.5676) ce_loss 1.3848 (1.3704) teacher_loss 0.8618 (0.8242) loss_zs_kd 0.4678 (0.4816) loss_oracle 0.4705 (0.5027) acc 56.2500 (50.3750) kd_loss 0.8717 (0.8130) lr 1.5567e-04 eta 0:04:30
epoch [43/50] batch [220/428] time 0.082 (0.083) data 0.000 (0.002) loss 1.5572 (1.5685) ce_loss 1.5068 (1.3696) teacher_loss 0.8362 (0.8249) loss_zs_kd 0.4048 (0.4813) loss_oracle 0.5186 (0.5030) acc 40.6250 (50.5114) kd_loss 0.7477 (0.8129) lr 1.5567e-04 eta 0:04:27
epoch [43/50] batch [240/428] time 0.091 (0.084) data 0.000 (0.002) loss 1.5404 (1.5662) ce_loss 1.3809 (1.3675) teacher_loss 0.7256 (0.8225) loss_zs_kd 0.4499 (0.4816) loss_oracle 0.5899 (0.5029) acc 43.7500 (50.5729) kd_loss 0.8842 (0.8109) lr 1.5567e-04 eta 0:04:26
epoch [43/50] batch [260/428] time 0.100 (0.084) data 0.000 (0.002) loss 1.4051 (1.5679) ce_loss 1.3398 (1.3677) teacher_loss 0.7156 (0.8241) loss_zs_kd 0.4204 (0.4817) loss_oracle 0.4794 (0.5030) acc 50.0000 (50.6611) kd_loss 0.8766 (0.8096) lr 1.5567e-04 eta 0:04:24
epoch [43/50] batch [280/428] time 0.090 (0.084) data 0.000 (0.002) loss 1.5607 (1.5687) ce_loss 1.6445 (1.3702) teacher_loss 0.8314 (0.8263) loss_zs_kd 0.4167 (0.4807) loss_oracle 0.5210 (0.5020) acc 28.1250 (50.4241) kd_loss 0.9161 (0.8071) lr 1.5567e-04 eta 0:04:23
epoch [43/50] batch [300/428] time 0.083 (0.084) data 0.000 (0.002) loss 1.3259 (1.5678) ce_loss 1.1875 (1.3689) teacher_loss 0.6254 (0.8264) loss_zs_kd 0.5276 (0.4801) loss_oracle 0.4367 (0.5014) acc 59.3750 (50.4479) kd_loss 0.8024 (0.8064) lr 1.5567e-04 eta 0:04:22
epoch [43/50] batch [320/428] time 0.081 (0.084) data 0.000 (0.002) loss 1.4785 (1.5665) ce_loss 1.0703 (1.3688) teacher_loss 0.7717 (0.8254) loss_zs_kd 0.4186 (0.4798) loss_oracle 0.4975 (0.5012) acc 59.3750 (50.3711) kd_loss 0.8015 (0.8069) lr 1.5567e-04 eta 0:04:19
epoch [43/50] batch [340/428] time 0.082 (0.084) data 0.000 (0.002) loss 1.2777 (1.5621) ce_loss 1.0420 (1.3628) teacher_loss 0.5613 (0.8204) loss_zs_kd 0.4544 (0.4797) loss_oracle 0.4892 (0.5019) acc 53.1250 (50.5607) kd_loss 0.7126 (0.8085) lr 1.5567e-04 eta 0:04:17
epoch [43/50] batch [360/428] time 0.081 (0.083) data 0.000 (0.002) loss 1.6723 (1.5613) ce_loss 1.6260 (1.3643) teacher_loss 0.8990 (0.8190) loss_zs_kd 0.4542 (0.4794) loss_oracle 0.5462 (0.5026) acc 31.2500 (50.3299) kd_loss 0.8586 (0.8102) lr 1.5567e-04 eta 0:04:15
epoch [43/50] batch [380/428] time 0.081 (0.083) data 0.000 (0.002) loss 1.8336 (1.5618) ce_loss 1.4727 (1.3641) teacher_loss 1.1066 (0.8193) loss_zs_kd 0.4756 (0.4799) loss_oracle 0.4892 (0.5025) acc 40.6250 (50.4523) kd_loss 0.6307 (0.8103) lr 1.5567e-04 eta 0:04:13
epoch [43/50] batch [400/428] time 0.087 (0.083) data 0.000 (0.001) loss 1.3165 (1.5608) ce_loss 1.2725 (1.3636) teacher_loss 0.5757 (0.8180) loss_zs_kd 0.4339 (0.4796) loss_oracle 0.5239 (0.5030) acc 53.1250 (50.3750) kd_loss 1.0584 (0.8115) lr 1.5567e-04 eta 0:04:11
epoch [43/50] batch [420/428] time 0.086 (0.083) data 0.000 (0.001) loss 1.3997 (1.5589) ce_loss 1.1758 (1.3625) teacher_loss 0.6333 (0.8169) loss_zs_kd 0.5064 (0.4782) loss_oracle 0.5133 (0.5030) acc 62.5000 (50.4241) kd_loss 0.9060 (0.8118) lr 1.5567e-04 eta 0:04:10
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,962
* accuracy: 50.4%
* error: 49.6%
* macro_f1: 37.5%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,598
* accuracy: 54.8%
* error: 45.2%
* macro_f1: 30.1%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [44/50] batch [20/428] time 0.080 (0.117) data 0.000 (0.027) loss 1.7164 (1.5479) ce_loss 1.6260 (1.3547) teacher_loss 0.9920 (0.8186) loss_zs_kd 0.4542 (0.4852) loss_oracle 0.4973 (0.4868) acc 43.7500 (49.8438) kd_loss 0.8715 (0.7905) lr 1.2369e-04 eta 0:05:47
epoch [44/50] batch [40/428] time 0.084 (0.101) data 0.000 (0.014) loss 1.8686 (1.5539) ce_loss 1.6221 (1.3539) teacher_loss 0.9827 (0.8052) loss_zs_kd 0.5686 (0.4856) loss_oracle 0.6016 (0.5060) acc 43.7500 (49.2969) kd_loss 0.9003 (0.8010) lr 1.2369e-04 eta 0:04:57
epoch [44/50] batch [60/428] time 0.082 (0.096) data 0.001 (0.009) loss 1.5295 (1.5641) ce_loss 1.2939 (1.3561) teacher_loss 0.8147 (0.8140) loss_zs_kd 0.4243 (0.4866) loss_oracle 0.5026 (0.5069) acc 50.0000 (50.1042) kd_loss 0.6497 (0.7905) lr 1.2369e-04 eta 0:04:40
epoch [44/50] batch [80/428] time 0.076 (0.092) data 0.000 (0.007) loss 1.7814 (1.5675) ce_loss 1.5693 (1.3651) teacher_loss 1.0146 (0.8176) loss_zs_kd 0.4721 (0.4834) loss_oracle 0.5308 (0.5082) acc 40.6250 (49.6094) kd_loss 0.8473 (0.7887) lr 1.2369e-04 eta 0:04:28
epoch [44/50] batch [100/428] time 0.090 (0.090) data 0.000 (0.006) loss 1.5821 (1.5634) ce_loss 1.4277 (1.3642) teacher_loss 0.8958 (0.8166) loss_zs_kd 0.4187 (0.4805) loss_oracle 0.4769 (0.5066) acc 46.8750 (49.8125) kd_loss 0.7478 (0.7921) lr 1.2369e-04 eta 0:04:20
epoch [44/50] batch [120/428] time 0.077 (0.089) data 0.000 (0.005) loss 1.4023 (1.5613) ce_loss 1.1113 (1.3692) teacher_loss 0.6304 (0.8158) loss_zs_kd 0.4622 (0.4798) loss_oracle 0.5407 (0.5056) acc 56.2500 (49.9219) kd_loss 0.8393 (0.7971) lr 1.2369e-04 eta 0:04:16
epoch [44/50] batch [140/428] time 0.081 (0.089) data 0.000 (0.004) loss 1.3749 (1.5621) ce_loss 1.1914 (1.3696) teacher_loss 0.6312 (0.8155) loss_zs_kd 0.5131 (0.4803) loss_oracle 0.4871 (0.5065) acc 59.3750 (50.0670) kd_loss 0.8410 (0.8002) lr 1.2369e-04 eta 0:04:13
epoch [44/50] batch [160/428] time 0.083 (0.088) data 0.000 (0.004) loss 1.3713 (1.5587) ce_loss 1.0361 (1.3645) teacher_loss 0.7237 (0.8115) loss_zs_kd 0.4610 (0.4825) loss_oracle 0.4171 (0.5059) acc 68.7500 (50.0391) kd_loss 0.6974 (0.7979) lr 1.2369e-04 eta 0:04:10
epoch [44/50] batch [180/428] time 0.082 (0.088) data 0.000 (0.003) loss 1.5080 (1.5613) ce_loss 1.3359 (1.3692) teacher_loss 0.8031 (0.8138) loss_zs_kd 0.4943 (0.4842) loss_oracle 0.4577 (0.5053) acc 53.1250 (49.8438) kd_loss 0.9095 (0.8003) lr 1.2369e-04 eta 0:04:07
epoch [44/50] batch [200/428] time 0.085 (0.087) data 0.000 (0.003) loss 1.5157 (1.5603) ce_loss 1.3838 (1.3675) teacher_loss 0.8217 (0.8139) loss_zs_kd 0.4749 (0.4844) loss_oracle 0.4566 (0.5042) acc 50.0000 (49.9219) kd_loss 0.7625 (0.7987) lr 1.2369e-04 eta 0:04:04
epoch [44/50] batch [220/428] time 0.078 (0.087) data 0.000 (0.003) loss 1.3598 (1.5562) ce_loss 1.0273 (1.3611) teacher_loss 0.6080 (0.8100) loss_zs_kd 0.5014 (0.4847) loss_oracle 0.5011 (0.5038) acc 68.7500 (50.3977) kd_loss 0.8564 (0.8007) lr 1.2369e-04 eta 0:04:00
epoch [44/50] batch [240/428] time 0.084 (0.087) data 0.000 (0.002) loss 1.7403 (1.5542) ce_loss 1.3018 (1.3597) teacher_loss 0.9590 (0.8077) loss_zs_kd 0.4972 (0.4845) loss_oracle 0.5327 (0.5043) acc 43.7500 (50.2995) kd_loss 0.7287 (0.8001) lr 1.2369e-04 eta 0:03:58
epoch [44/50] batch [260/428] time 0.078 (0.087) data 0.000 (0.002) loss 1.5396 (1.5547) ce_loss 1.4160 (1.3610) teacher_loss 0.7748 (0.8084) loss_zs_kd 0.4438 (0.4837) loss_oracle 0.5428 (0.5045) acc 56.2500 (50.2644) kd_loss 0.9461 (0.8031) lr 1.2369e-04 eta 0:03:56
epoch [44/50] batch [280/428] time 0.085 (0.086) data 0.000 (0.002) loss 1.4153 (1.5561) ce_loss 1.0420 (1.3628) teacher_loss 0.7565 (0.8095) loss_zs_kd 0.4264 (0.4839) loss_oracle 0.4457 (0.5047) acc 62.5000 (50.1674) kd_loss 0.6743 (0.8035) lr 1.2369e-04 eta 0:03:54
epoch [44/50] batch [300/428] time 0.093 (0.086) data 0.000 (0.002) loss 1.5739 (1.5553) ce_loss 1.3535 (1.3626) teacher_loss 0.8630 (0.8088) loss_zs_kd 0.4491 (0.4830) loss_oracle 0.4864 (0.5050) acc 43.7500 (50.0104) kd_loss 0.7838 (0.8063) lr 1.2369e-04 eta 0:03:53
epoch [44/50] batch [320/428] time 0.081 (0.086) data 0.000 (0.002) loss 1.6141 (1.5557) ce_loss 1.3613 (1.3621) teacher_loss 0.9231 (0.8100) loss_zs_kd 0.4685 (0.4824) loss_oracle 0.4567 (0.5045) acc 62.5000 (50.2246) kd_loss 0.7692 (0.8060) lr 1.2369e-04 eta 0:03:51
epoch [44/50] batch [340/428] time 0.081 (0.086) data 0.000 (0.002) loss 1.5808 (1.5553) ce_loss 1.2627 (1.3619) teacher_loss 0.8484 (0.8099) loss_zs_kd 0.4522 (0.4823) loss_oracle 0.5063 (0.5043) acc 43.7500 (50.1838) kd_loss 0.6938 (0.8064) lr 1.2369e-04 eta 0:03:49
epoch [44/50] batch [360/428] time 0.088 (0.086) data 0.001 (0.002) loss 1.6572 (1.5571) ce_loss 1.4150 (1.3627) teacher_loss 0.8911 (0.8121) loss_zs_kd 0.4880 (0.4823) loss_oracle 0.5221 (0.5038) acc 50.0000 (50.1910) kd_loss 0.7764 (0.8066) lr 1.2369e-04 eta 0:03:47
epoch [44/50] batch [380/428] time 0.087 (0.086) data 0.000 (0.002) loss 1.3532 (1.5573) ce_loss 1.1582 (1.3628) teacher_loss 0.5730 (0.8120) loss_zs_kd 0.4600 (0.4819) loss_oracle 0.5503 (0.5044) acc 56.2500 (50.3207) kd_loss 0.8849 (0.8072) lr 1.2369e-04 eta 0:03:45
epoch [44/50] batch [400/428] time 0.086 (0.086) data 0.000 (0.002) loss 1.6304 (1.5541) ce_loss 1.6484 (1.3597) teacher_loss 0.9069 (0.8091) loss_zs_kd 0.4739 (0.4813) loss_oracle 0.4865 (0.5044) acc 46.8750 (50.3984) kd_loss 0.9800 (0.8072) lr 1.2369e-04 eta 0:03:43
epoch [44/50] batch [420/428] time 0.078 (0.086) data 0.000 (0.002) loss 1.3617 (1.5540) ce_loss 1.0898 (1.3571) teacher_loss 0.7076 (0.8090) loss_zs_kd 0.4587 (0.4814) loss_oracle 0.4248 (0.5043) acc 62.5000 (50.6250) kd_loss 0.7021 (0.8068) lr 1.2369e-04 eta 0:03:41
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,957
* accuracy: 50.3%
* error: 49.7%
* macro_f1: 36.6%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,591
* accuracy: 54.7%
* error: 45.3%
* macro_f1: 29.9%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [45/50] batch [20/428] time 0.080 (0.112) data 0.000 (0.026) loss 1.4639 (1.5521) ce_loss 1.3252 (1.3487) teacher_loss 0.7239 (0.8085) loss_zs_kd 0.4749 (0.4843) loss_oracle 0.5025 (0.5014) acc 59.3750 (52.6562) kd_loss 0.9400 (0.8040) lr 9.5173e-05 eta 0:04:44
epoch [45/50] batch [40/428] time 0.089 (0.097) data 0.000 (0.013) loss 1.4086 (1.5343) ce_loss 1.3281 (1.3369) teacher_loss 0.6725 (0.7985) loss_zs_kd 0.4624 (0.4760) loss_oracle 0.5049 (0.4979) acc 43.7500 (51.4844) kd_loss 0.8963 (0.8092) lr 9.5173e-05 eta 0:04:04
epoch [45/50] batch [60/428] time 0.087 (0.093) data 0.001 (0.009) loss 1.6557 (1.5549) ce_loss 1.3438 (1.3614) teacher_loss 0.9085 (0.8139) loss_zs_kd 0.5295 (0.4812) loss_oracle 0.4825 (0.5003) acc 43.7500 (50.4167) kd_loss 0.7555 (0.8066) lr 9.5173e-05 eta 0:03:52
epoch [45/50] batch [80/428] time 0.060 (0.090) data 0.000 (0.007) loss 1.4233 (1.5408) ce_loss 1.2031 (1.3453) teacher_loss 0.7222 (0.8021) loss_zs_kd 0.3930 (0.4807) loss_oracle 0.5046 (0.4983) acc 53.1250 (50.9766) kd_loss 0.8709 (0.8119) lr 9.5173e-05 eta 0:03:43
epoch [45/50] batch [100/428] time 0.082 (0.088) data 0.000 (0.005) loss 1.5550 (1.5404) ce_loss 1.5518 (1.3513) teacher_loss 0.7562 (0.7976) loss_zs_kd 0.5548 (0.4820) loss_oracle 0.5214 (0.5018) acc 40.6250 (51.4375) kd_loss 0.9764 (0.8218) lr 9.5173e-05 eta 0:03:36
epoch [45/50] batch [120/428] time 0.083 (0.087) data 0.000 (0.004) loss 1.5657 (1.5408) ce_loss 1.6006 (1.3576) teacher_loss 0.7506 (0.7957) loss_zs_kd 0.5038 (0.4836) loss_oracle 0.5632 (0.5033) acc 40.6250 (51.1198) kd_loss 0.8667 (0.8237) lr 9.5173e-05 eta 0:03:32
epoch [45/50] batch [140/428] time 0.080 (0.086) data 0.000 (0.004) loss 1.5047 (1.5444) ce_loss 1.3418 (1.3587) teacher_loss 0.7405 (0.7994) loss_zs_kd 0.5021 (0.4816) loss_oracle 0.5131 (0.5042) acc 50.0000 (51.0938) kd_loss 0.8367 (0.8187) lr 9.5173e-05 eta 0:03:29
epoch [45/50] batch [160/428] time 0.082 (0.086) data 0.000 (0.003) loss 1.5515 (1.5502) ce_loss 1.3994 (1.3685) teacher_loss 0.7918 (0.8061) loss_zs_kd 0.4949 (0.4808) loss_oracle 0.5123 (0.5037) acc 46.8750 (50.5469) kd_loss 0.8020 (0.8174) lr 9.5173e-05 eta 0:03:27
epoch [45/50] batch [180/428] time 0.086 (0.086) data 0.000 (0.003) loss 1.5320 (1.5524) ce_loss 1.3018 (1.3699) teacher_loss 0.7458 (0.8089) loss_zs_kd 0.4450 (0.4801) loss_oracle 0.5637 (0.5035) acc 50.0000 (50.3125) kd_loss 0.9609 (0.8209) lr 9.5173e-05 eta 0:03:24
epoch [45/50] batch [200/428] time 0.087 (0.086) data 0.000 (0.003) loss 1.4523 (1.5490) ce_loss 1.3320 (1.3633) teacher_loss 0.6659 (0.8060) loss_zs_kd 0.5191 (0.4792) loss_oracle 0.5268 (0.5035) acc 50.0000 (50.3906) kd_loss 0.8326 (0.8192) lr 9.5173e-05 eta 0:03:23
epoch [45/50] batch [220/428] time 0.085 (0.086) data 0.000 (0.003) loss 1.5081 (1.5477) ce_loss 1.2441 (1.3590) teacher_loss 0.8309 (0.8038) loss_zs_kd 0.4590 (0.4805) loss_oracle 0.4477 (0.5037) acc 53.1250 (50.3409) kd_loss 0.6391 (0.8190) lr 9.5173e-05 eta 0:03:21
epoch [45/50] batch [240/428] time 0.074 (0.086) data 0.000 (0.002) loss 1.4071 (1.5478) ce_loss 1.2715 (1.3623) teacher_loss 0.6475 (0.8035) loss_zs_kd 0.4745 (0.4802) loss_oracle 0.5224 (0.5042) acc 56.2500 (50.1953) kd_loss 0.8101 (0.8211) lr 9.5173e-05 eta 0:03:19
epoch [45/50] batch [260/428] time 0.076 (0.085) data 0.000 (0.002) loss 1.5170 (1.5507) ce_loss 1.4453 (1.3638) teacher_loss 0.7753 (0.8067) loss_zs_kd 0.4668 (0.4797) loss_oracle 0.5083 (0.5041) acc 56.2500 (50.0120) kd_loss 0.9396 (0.8203) lr 9.5173e-05 eta 0:03:16
epoch [45/50] batch [280/428] time 0.086 (0.085) data 0.000 (0.002) loss 1.4449 (1.5500) ce_loss 1.1484 (1.3598) teacher_loss 0.6888 (0.8062) loss_zs_kd 0.5221 (0.4793) loss_oracle 0.4950 (0.5042) acc 50.0000 (50.1004) kd_loss 0.7058 (0.8164) lr 9.5173e-05 eta 0:03:14
epoch [45/50] batch [300/428] time 0.075 (0.085) data 0.000 (0.002) loss 1.5946 (1.5499) ce_loss 1.3809 (1.3582) teacher_loss 0.7979 (0.8068) loss_zs_kd 0.4439 (0.4790) loss_oracle 0.5747 (0.5036) acc 43.7500 (50.1771) kd_loss 0.8593 (0.8135) lr 9.5173e-05 eta 0:03:12
epoch [45/50] batch [320/428] time 0.071 (0.085) data 0.000 (0.002) loss 1.4092 (1.5470) ce_loss 1.2002 (1.3576) teacher_loss 0.7132 (0.8037) loss_zs_kd 0.4251 (0.4800) loss_oracle 0.4834 (0.5033) acc 50.0000 (50.1465) kd_loss 0.8672 (0.8153) lr 9.5173e-05 eta 0:03:10
epoch [45/50] batch [340/428] time 0.084 (0.084) data 0.000 (0.002) loss 1.5831 (1.5487) ce_loss 1.4092 (1.3613) teacher_loss 0.8175 (0.8053) loss_zs_kd 0.5140 (0.4802) loss_oracle 0.5086 (0.5032) acc 59.3750 (50.0368) kd_loss 0.7869 (0.8155) lr 9.5173e-05 eta 0:03:08
epoch [45/50] batch [360/428] time 0.085 (0.084) data 0.000 (0.002) loss 1.4610 (1.5491) ce_loss 1.1504 (1.3602) teacher_loss 0.7439 (0.8059) loss_zs_kd 0.4299 (0.4799) loss_oracle 0.5021 (0.5032) acc 62.5000 (50.0608) kd_loss 0.7327 (0.8150) lr 9.5173e-05 eta 0:03:06
epoch [45/50] batch [380/428] time 0.081 (0.085) data 0.000 (0.002) loss 1.6034 (1.5496) ce_loss 1.4873 (1.3587) teacher_loss 0.9139 (0.8062) loss_zs_kd 0.4451 (0.4800) loss_oracle 0.4670 (0.5034) acc 46.8750 (50.0740) kd_loss 0.8390 (0.8145) lr 9.5173e-05 eta 0:03:05
epoch [45/50] batch [400/428] time 0.076 (0.084) data 0.000 (0.002) loss 1.5403 (1.5474) ce_loss 1.4268 (1.3565) teacher_loss 0.8265 (0.8043) loss_zs_kd 0.4739 (0.4799) loss_oracle 0.4768 (0.5032) acc 46.8750 (50.1484) kd_loss 0.8552 (0.8161) lr 9.5173e-05 eta 0:03:02
epoch [45/50] batch [420/428] time 0.073 (0.084) data 0.000 (0.001) loss 1.4436 (1.5491) ce_loss 1.2207 (1.3589) teacher_loss 0.6928 (0.8061) loss_zs_kd 0.4704 (0.4793) loss_oracle 0.5157 (0.5034) acc 56.2500 (50.1488) kd_loss 0.8235 (0.8160) lr 9.5173e-05 eta 0:03:00
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,949
* accuracy: 50.2%
* error: 49.8%
* macro_f1: 36.7%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,567
* accuracy: 54.1%
* error: 45.9%
* macro_f1: 29.7%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [46/50] batch [20/428] time 0.088 (0.117) data 0.000 (0.027) loss 1.5621 (1.5478) ce_loss 1.3574 (1.3977) teacher_loss 0.8334 (0.7907) loss_zs_kd 0.4493 (0.4958) loss_oracle 0.5041 (0.5093) acc 46.8750 (49.0625) kd_loss 0.8762 (0.8583) lr 7.0224e-05 eta 0:04:08
epoch [46/50] batch [40/428] time 0.085 (0.101) data 0.000 (0.014) loss 1.7665 (1.5618) ce_loss 1.5234 (1.3853) teacher_loss 0.9687 (0.8101) loss_zs_kd 0.5773 (0.5020) loss_oracle 0.5092 (0.5007) acc 50.0000 (49.1406) kd_loss 0.7938 (0.8412) lr 7.0224e-05 eta 0:03:32
epoch [46/50] batch [60/428] time 0.077 (0.094) data 0.001 (0.009) loss 1.4948 (1.5350) ce_loss 1.2832 (1.3544) teacher_loss 0.7484 (0.7848) loss_zs_kd 0.5106 (0.4952) loss_oracle 0.4911 (0.5026) acc 50.0000 (50.1042) kd_loss 0.7191 (0.8353) lr 7.0224e-05 eta 0:03:14
epoch [46/50] batch [80/428] time 0.086 (0.090) data 0.000 (0.007) loss 1.4364 (1.5416) ce_loss 1.4863 (1.3558) teacher_loss 0.6440 (0.7960) loss_zs_kd 0.4738 (0.4869) loss_oracle 0.5554 (0.5022) acc 50.0000 (49.9219) kd_loss 0.9069 (0.8307) lr 7.0224e-05 eta 0:03:05
epoch [46/50] batch [100/428] time 0.079 (0.088) data 0.000 (0.006) loss 1.4990 (1.5489) ce_loss 1.3926 (1.3615) teacher_loss 0.8135 (0.8026) loss_zs_kd 0.4695 (0.4862) loss_oracle 0.4507 (0.5031) acc 46.8750 (49.8750) kd_loss 0.7842 (0.8266) lr 7.0224e-05 eta 0:03:00
epoch [46/50] batch [120/428] time 0.094 (0.088) data 0.000 (0.005) loss 1.7330 (1.5533) ce_loss 1.4814 (1.3625) teacher_loss 0.9555 (0.8079) loss_zs_kd 0.5074 (0.4832) loss_oracle 0.5238 (0.5038) acc 43.7500 (50.1302) kd_loss 0.8483 (0.8240) lr 7.0224e-05 eta 0:02:57
epoch [46/50] batch [140/428] time 0.085 (0.087) data 0.000 (0.004) loss 1.5177 (1.5582) ce_loss 1.3604 (1.3716) teacher_loss 0.8162 (0.8119) loss_zs_kd 0.5081 (0.4847) loss_oracle 0.4475 (0.5040) acc 46.8750 (49.6205) kd_loss 0.8327 (0.8252) lr 7.0224e-05 eta 0:02:54
epoch [46/50] batch [160/428] time 0.086 (0.087) data 0.001 (0.004) loss 1.6899 (1.5610) ce_loss 1.5498 (1.3703) teacher_loss 0.9444 (0.8152) loss_zs_kd 0.4588 (0.4833) loss_oracle 0.5161 (0.5041) acc 56.2500 (49.8047) kd_loss 0.9137 (0.8245) lr 7.0224e-05 eta 0:02:51
epoch [46/50] batch [180/428] time 0.088 (0.086) data 0.000 (0.003) loss 1.7766 (1.5611) ce_loss 1.6289 (1.3738) teacher_loss 1.0651 (0.8161) loss_zs_kd 0.5370 (0.4842) loss_oracle 0.4429 (0.5030) acc 37.5000 (49.5660) kd_loss 0.8062 (0.8259) lr 7.0224e-05 eta 0:02:49
epoch [46/50] batch [200/428] time 0.083 (0.086) data 0.000 (0.003) loss 1.2594 (1.5664) ce_loss 0.9937 (1.3801) teacher_loss 0.5556 (0.8206) loss_zs_kd 0.4207 (0.4848) loss_oracle 0.4934 (0.5033) acc 65.6250 (49.4844) kd_loss 0.6897 (0.8256) lr 7.0224e-05 eta 0:02:47
epoch [46/50] batch [220/428] time 0.083 (0.086) data 0.000 (0.003) loss 1.8007 (1.5641) ce_loss 1.7197 (1.3816) teacher_loss 0.9699 (0.8180) loss_zs_kd 0.5081 (0.4839) loss_oracle 0.5768 (0.5041) acc 40.6250 (49.3892) kd_loss 0.9354 (0.8299) lr 7.0224e-05 eta 0:02:45
epoch [46/50] batch [240/428] time 0.092 (0.086) data 0.000 (0.003) loss 2.0423 (1.5653) ce_loss 1.9277 (1.3839) teacher_loss 1.3755 (0.8187) loss_zs_kd 0.4436 (0.4830) loss_oracle 0.4451 (0.5051) acc 37.5000 (49.4661) kd_loss 0.6297 (0.8312) lr 7.0224e-05 eta 0:02:43
epoch [46/50] batch [260/428] time 0.084 (0.086) data 0.000 (0.002) loss 1.6509 (1.5631) ce_loss 1.4707 (1.3796) teacher_loss 0.8287 (0.8176) loss_zs_kd 0.5335 (0.4829) loss_oracle 0.5554 (0.5041) acc 43.7500 (49.5433) kd_loss 0.8665 (0.8294) lr 7.0224e-05 eta 0:02:41
epoch [46/50] batch [280/428] time 0.085 (0.086) data 0.000 (0.002) loss 1.6684 (1.5614) ce_loss 1.6016 (1.3783) teacher_loss 0.8904 (0.8161) loss_zs_kd 0.4889 (0.4813) loss_oracle 0.5335 (0.5046) acc 46.8750 (49.4643) kd_loss 0.8949 (0.8300) lr 7.0224e-05 eta 0:02:39
epoch [46/50] batch [300/428] time 0.085 (0.086) data 0.000 (0.002) loss 1.3847 (1.5583) ce_loss 1.0732 (1.3757) teacher_loss 0.5904 (0.8141) loss_zs_kd 0.5021 (0.4806) loss_oracle 0.5433 (0.5039) acc 53.1250 (49.5833) kd_loss 0.8234 (0.8285) lr 7.0224e-05 eta 0:02:37
epoch [46/50] batch [320/428] time 0.081 (0.085) data 0.000 (0.002) loss 1.6786 (1.5583) ce_loss 1.4766 (1.3754) teacher_loss 0.9396 (0.8139) loss_zs_kd 0.3906 (0.4800) loss_oracle 0.5437 (0.5044) acc 50.0000 (49.6680) kd_loss 0.8463 (0.8277) lr 7.0224e-05 eta 0:02:35
epoch [46/50] batch [340/428] time 0.085 (0.085) data 0.000 (0.002) loss 1.5249 (1.5581) ce_loss 1.4814 (1.3727) teacher_loss 0.7612 (0.8138) loss_zs_kd 0.4926 (0.4806) loss_oracle 0.5173 (0.5041) acc 43.7500 (49.8070) kd_loss 0.8851 (0.8262) lr 7.0224e-05 eta 0:02:33
epoch [46/50] batch [360/428] time 0.082 (0.086) data 0.000 (0.002) loss 1.4326 (1.5583) ce_loss 1.1016 (1.3730) teacher_loss 0.7630 (0.8146) loss_zs_kd 0.4104 (0.4803) loss_oracle 0.4644 (0.5035) acc 56.2500 (49.8611) kd_loss 0.7364 (0.8257) lr 7.0224e-05 eta 0:02:32
epoch [46/50] batch [380/428] time 0.085 (0.086) data 0.000 (0.002) loss 1.5856 (1.5552) ce_loss 1.4131 (1.3690) teacher_loss 0.8185 (0.8113) loss_zs_kd 0.4755 (0.4804) loss_oracle 0.5294 (0.5037) acc 50.0000 (50.0576) kd_loss 0.8852 (0.8239) lr 7.0224e-05 eta 0:02:30
epoch [46/50] batch [400/428] time 0.075 (0.085) data 0.000 (0.002) loss 1.5943 (1.5554) ce_loss 1.2998 (1.3695) teacher_loss 0.8761 (0.8113) loss_zs_kd 0.4460 (0.4813) loss_oracle 0.4952 (0.5034) acc 53.1250 (49.9922) kd_loss 0.7752 (0.8227) lr 7.0224e-05 eta 0:02:28
epoch [46/50] batch [420/428] time 0.079 (0.085) data 0.000 (0.002) loss 1.3591 (1.5540) ce_loss 0.9995 (1.3678) teacher_loss 0.7531 (0.8092) loss_zs_kd 0.3728 (0.4818) loss_oracle 0.4195 (0.5039) acc 62.5000 (50.1190) kd_loss 0.7195 (0.8235) lr 7.0224e-05 eta 0:02:26
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,951
* accuracy: 50.2%
* error: 49.8%
* macro_f1: 36.5%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,568
* accuracy: 54.2%
* error: 45.8%
* macro_f1: 30.2%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [47/50] batch [20/428] time 0.081 (0.112) data 0.000 (0.026) loss 1.8588 (1.5952) ce_loss 1.5215 (1.4013) teacher_loss 1.0998 (0.8557) loss_zs_kd 0.5098 (0.4620) loss_oracle 0.5040 (0.5085) acc 40.6250 (49.0625) kd_loss 0.7957 (0.8207) lr 4.8943e-05 eta 0:03:09
epoch [47/50] batch [40/428] time 0.082 (0.099) data 0.000 (0.013) loss 1.7649 (1.5940) ce_loss 1.5107 (1.3936) teacher_loss 0.9143 (0.8473) loss_zs_kd 0.5065 (0.4736) loss_oracle 0.5974 (0.5099) acc 37.5000 (49.2969) kd_loss 0.8706 (0.8217) lr 4.8943e-05 eta 0:02:45
epoch [47/50] batch [60/428] time 0.079 (0.095) data 0.000 (0.009) loss 1.3515 (1.5869) ce_loss 1.0449 (1.3788) teacher_loss 0.6332 (0.8423) loss_zs_kd 0.3804 (0.4738) loss_oracle 0.5281 (0.5077) acc 59.3750 (50.0000) kd_loss 0.9309 (0.8255) lr 4.8943e-05 eta 0:02:36
epoch [47/50] batch [80/428] time 0.080 (0.092) data 0.000 (0.007) loss 1.6482 (1.5842) ce_loss 1.3809 (1.3781) teacher_loss 0.9380 (0.8378) loss_zs_kd 0.4844 (0.4818) loss_oracle 0.4681 (0.5055) acc 50.0000 (49.9219) kd_loss 0.7541 (0.8143) lr 4.8943e-05 eta 0:02:30
epoch [47/50] batch [100/428] time 0.082 (0.091) data 0.000 (0.005) loss 1.7805 (1.5744) ce_loss 1.7520 (1.3769) teacher_loss 0.9405 (0.8248) loss_zs_kd 0.4651 (0.4834) loss_oracle 0.6074 (0.5079) acc 40.6250 (49.8438) kd_loss 0.8830 (0.8223) lr 4.8943e-05 eta 0:02:26
epoch [47/50] batch [120/428] time 0.096 (0.091) data 0.000 (0.005) loss 1.4434 (1.5767) ce_loss 1.2588 (1.3811) teacher_loss 0.7230 (0.8284) loss_zs_kd 0.4520 (0.4835) loss_oracle 0.4944 (0.5065) acc 50.0000 (49.5573) kd_loss 0.7659 (0.8221) lr 4.8943e-05 eta 0:02:24
epoch [47/50] batch [140/428] time 0.088 (0.089) data 0.000 (0.004) loss 1.5234 (1.5649) ce_loss 1.3184 (1.3700) teacher_loss 0.7928 (0.8190) loss_zs_kd 0.4173 (0.4822) loss_oracle 0.5220 (0.5048) acc 46.8750 (50.1562) kd_loss 0.7814 (0.8240) lr 4.8943e-05 eta 0:02:20
epoch [47/50] batch [160/428] time 0.084 (0.089) data 0.000 (0.004) loss 1.6103 (1.5626) ce_loss 1.2959 (1.3668) teacher_loss 0.8553 (0.8155) loss_zs_kd 0.4548 (0.4820) loss_oracle 0.5276 (0.5061) acc 65.6250 (50.1562) kd_loss 0.8105 (0.8251) lr 4.8943e-05 eta 0:02:17
epoch [47/50] batch [180/428] time 0.081 (0.088) data 0.000 (0.003) loss 1.5207 (1.5567) ce_loss 1.3711 (1.3593) teacher_loss 0.7591 (0.8098) loss_zs_kd 0.4922 (0.4827) loss_oracle 0.5155 (0.5055) acc 53.1250 (50.4167) kd_loss 0.8454 (0.8258) lr 4.8943e-05 eta 0:02:15
epoch [47/50] batch [200/428] time 0.082 (0.088) data 0.000 (0.003) loss 1.5487 (1.5533) ce_loss 1.4971 (1.3573) teacher_loss 0.8508 (0.8071) loss_zs_kd 0.4794 (0.4827) loss_oracle 0.4582 (0.5048) acc 34.3750 (50.3906) kd_loss 0.9211 (0.8269) lr 4.8943e-05 eta 0:02:12
epoch [47/50] batch [220/428] time 0.085 (0.088) data 0.000 (0.003) loss 1.3898 (1.5504) ce_loss 1.1230 (1.3552) teacher_loss 0.6433 (0.8045) loss_zs_kd 0.5085 (0.4826) loss_oracle 0.4923 (0.5046) acc 56.2500 (50.4261) kd_loss 0.8435 (0.8261) lr 4.8943e-05 eta 0:02:11
epoch [47/50] batch [240/428] time 0.084 (0.088) data 0.000 (0.002) loss 1.6860 (1.5475) ce_loss 1.2275 (1.3535) teacher_loss 0.9072 (0.8017) loss_zs_kd 0.5224 (0.4824) loss_oracle 0.5176 (0.5046) acc 56.2500 (50.4036) kd_loss 0.6654 (0.8260) lr 4.8943e-05 eta 0:02:08
epoch [47/50] batch [260/428] time 0.086 (0.087) data 0.000 (0.002) loss 1.5907 (1.5486) ce_loss 1.5264 (1.3570) teacher_loss 0.8394 (0.8026) loss_zs_kd 0.5048 (0.4828) loss_oracle 0.4988 (0.5046) acc 37.5000 (50.1562) kd_loss 0.8291 (0.8284) lr 4.8943e-05 eta 0:02:06
epoch [47/50] batch [280/428] time 0.091 (0.087) data 0.000 (0.002) loss 1.5836 (1.5479) ce_loss 1.3682 (1.3551) teacher_loss 0.8346 (0.8011) loss_zs_kd 0.4681 (0.4841) loss_oracle 0.5150 (0.5048) acc 50.0000 (50.4576) kd_loss 0.7607 (0.8277) lr 4.8943e-05 eta 0:02:05
epoch [47/50] batch [300/428] time 0.084 (0.087) data 0.000 (0.002) loss 1.7632 (1.5458) ce_loss 1.8047 (1.3535) teacher_loss 1.0431 (0.7987) loss_zs_kd 0.4860 (0.4835) loss_oracle 0.4771 (0.5053) acc 34.3750 (50.5312) kd_loss 0.7991 (0.8285) lr 4.8943e-05 eta 0:02:02
epoch [47/50] batch [320/428] time 0.083 (0.087) data 0.000 (0.002) loss 1.4836 (1.5434) ce_loss 1.1055 (1.3530) teacher_loss 0.7859 (0.7952) loss_zs_kd 0.4479 (0.4849) loss_oracle 0.4738 (0.5058) acc 68.7500 (50.4297) kd_loss 0.8002 (0.8302) lr 4.8943e-05 eta 0:02:00
epoch [47/50] batch [340/428] time 0.081 (0.087) data 0.000 (0.002) loss 1.6247 (1.5453) ce_loss 1.3516 (1.3554) teacher_loss 0.8499 (0.7965) loss_zs_kd 0.5217 (0.4859) loss_oracle 0.5139 (0.5058) acc 37.5000 (50.2849) kd_loss 0.7302 (0.8288) lr 4.8943e-05 eta 0:01:58
epoch [47/50] batch [360/428] time 0.085 (0.087) data 0.000 (0.002) loss 1.4546 (1.5469) ce_loss 1.2363 (1.3578) teacher_loss 0.7128 (0.7989) loss_zs_kd 0.4354 (0.4846) loss_oracle 0.5241 (0.5058) acc 50.0000 (50.1562) kd_loss 0.8361 (0.8282) lr 4.8943e-05 eta 0:01:57
epoch [47/50] batch [380/428] time 0.081 (0.087) data 0.000 (0.002) loss 1.5723 (1.5447) ce_loss 1.3213 (1.3550) teacher_loss 0.7899 (0.7969) loss_zs_kd 0.5012 (0.4839) loss_oracle 0.5317 (0.5058) acc 53.1250 (50.3618) kd_loss 0.8536 (0.8292) lr 4.8943e-05 eta 0:01:55
epoch [47/50] batch [400/428] time 0.087 (0.086) data 0.000 (0.002) loss 1.4068 (1.5438) ce_loss 1.1416 (1.3544) teacher_loss 0.6704 (0.7959) loss_zs_kd 0.4849 (0.4840) loss_oracle 0.4940 (0.5059) acc 59.3750 (50.3438) kd_loss 0.7929 (0.8291) lr 4.8943e-05 eta 0:01:53
epoch [47/50] batch [420/428] time 0.078 (0.086) data 0.000 (0.002) loss 1.6673 (1.5456) ce_loss 1.4785 (1.3557) teacher_loss 0.8844 (0.7979) loss_zs_kd 0.5263 (0.4843) loss_oracle 0.5198 (0.5055) acc 40.6250 (50.2753) kd_loss 0.7621 (0.8283) lr 4.8943e-05 eta 0:01:51
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,955
* accuracy: 50.3%
* error: 49.7%
* macro_f1: 36.6%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,570
* accuracy: 54.2%
* error: 45.8%
* macro_f1: 30.1%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [48/50] batch [20/428] time 0.083 (0.110) data 0.000 (0.029) loss 1.4508 (1.4747) ce_loss 1.2852 (1.3023) teacher_loss 0.7855 (0.7401) loss_zs_kd 0.4015 (0.4764) loss_oracle 0.4646 (0.4964) acc 53.1250 (52.5000) kd_loss 0.7761 (0.8079) lr 3.1417e-05 eta 0:02:18
epoch [48/50] batch [40/428] time 0.093 (0.098) data 0.000 (0.014) loss 1.6112 (1.5500) ce_loss 1.3330 (1.3718) teacher_loss 0.8744 (0.8078) loss_zs_kd 0.4222 (0.4817) loss_oracle 0.5258 (0.5014) acc 40.6250 (49.2969) kd_loss 0.8720 (0.8114) lr 3.1417e-05 eta 0:02:01
epoch [48/50] batch [60/428] time 0.085 (0.094) data 0.001 (0.010) loss 1.5025 (1.5366) ce_loss 1.3086 (1.3604) teacher_loss 0.7437 (0.7974) loss_zs_kd 0.4602 (0.4814) loss_oracle 0.5288 (0.4985) acc 56.2500 (49.9479) kd_loss 0.8655 (0.8136) lr 3.1417e-05 eta 0:01:55
epoch [48/50] batch [80/428] time 0.092 (0.091) data 0.000 (0.007) loss 1.3554 (1.5281) ce_loss 1.4033 (1.3496) teacher_loss 0.7054 (0.7914) loss_zs_kd 0.3550 (0.4788) loss_oracle 0.4724 (0.4973) acc 46.8750 (50.5469) kd_loss 0.7626 (0.8110) lr 3.1417e-05 eta 0:01:49
epoch [48/50] batch [100/428] time 0.090 (0.090) data 0.000 (0.006) loss 1.4251 (1.5293) ce_loss 1.1885 (1.3411) teacher_loss 0.6759 (0.7973) loss_zs_kd 0.5138 (0.4751) loss_oracle 0.4924 (0.4944) acc 56.2500 (50.9688) kd_loss 0.8268 (0.8049) lr 3.1417e-05 eta 0:01:46
epoch [48/50] batch [120/428] time 0.077 (0.089) data 0.000 (0.005) loss 1.2890 (1.5362) ce_loss 1.0596 (1.3449) teacher_loss 0.5730 (0.8027) loss_zs_kd 0.4350 (0.4749) loss_oracle 0.4985 (0.4960) acc 62.5000 (51.1458) kd_loss 0.7669 (0.8055) lr 3.1417e-05 eta 0:01:43
epoch [48/50] batch [140/428] time 0.089 (0.088) data 0.000 (0.004) loss 1.5313 (1.5384) ce_loss 1.3184 (1.3513) teacher_loss 0.7505 (0.8046) loss_zs_kd 0.5558 (0.4765) loss_oracle 0.5029 (0.4956) acc 50.0000 (50.7589) kd_loss 0.7775 (0.8053) lr 3.1417e-05 eta 0:01:40
epoch [48/50] batch [160/428] time 0.083 (0.088) data 0.000 (0.004) loss 1.6113 (1.5356) ce_loss 1.3262 (1.3531) teacher_loss 0.8324 (0.8005) loss_zs_kd 0.5122 (0.4774) loss_oracle 0.5228 (0.4965) acc 62.5000 (50.8984) kd_loss 0.7729 (0.8083) lr 3.1417e-05 eta 0:01:38
epoch [48/50] batch [180/428] time 0.080 (0.087) data 0.000 (0.003) loss 1.4945 (1.5382) ce_loss 1.4092 (1.3575) teacher_loss 0.6625 (0.8029) loss_zs_kd 0.5713 (0.4781) loss_oracle 0.5463 (0.4962) acc 50.0000 (50.6424) kd_loss 0.8169 (0.8080) lr 3.1417e-05 eta 0:01:35
epoch [48/50] batch [200/428] time 0.082 (0.086) data 0.000 (0.003) loss 1.6015 (1.5395) ce_loss 1.3916 (1.3588) teacher_loss 0.8213 (0.8024) loss_zs_kd 0.5448 (0.4810) loss_oracle 0.5078 (0.4966) acc 56.2500 (50.4531) kd_loss 0.8388 (0.8069) lr 3.1417e-05 eta 0:01:33
epoch [48/50] batch [220/428] time 0.084 (0.086) data 0.000 (0.003) loss 1.5551 (1.5375) ce_loss 1.3389 (1.3598) teacher_loss 0.7457 (0.8006) loss_zs_kd 0.4631 (0.4800) loss_oracle 0.5779 (0.4969) acc 59.3750 (50.3693) kd_loss 0.7918 (0.8075) lr 3.1417e-05 eta 0:01:31
epoch [48/50] batch [240/428] time 0.089 (0.086) data 0.000 (0.003) loss 1.4652 (1.5429) ce_loss 1.2373 (1.3649) teacher_loss 0.6695 (0.8045) loss_zs_kd 0.5477 (0.4806) loss_oracle 0.5219 (0.4982) acc 65.6250 (50.2474) kd_loss 0.8388 (0.8090) lr 3.1417e-05 eta 0:01:29
epoch [48/50] batch [260/428] time 0.082 (0.086) data 0.000 (0.002) loss 1.7258 (1.5454) ce_loss 1.4072 (1.3679) teacher_loss 0.9727 (0.8068) loss_zs_kd 0.5817 (0.4801) loss_oracle 0.4622 (0.4986) acc 59.3750 (50.1562) kd_loss 0.8367 (0.8109) lr 3.1417e-05 eta 0:01:27
epoch [48/50] batch [280/428] time 0.090 (0.086) data 0.000 (0.002) loss 1.5944 (1.5481) ce_loss 1.4795 (1.3683) teacher_loss 0.8326 (0.8079) loss_zs_kd 0.4810 (0.4802) loss_oracle 0.5213 (0.5001) acc 50.0000 (50.0893) kd_loss 0.7725 (0.8130) lr 3.1417e-05 eta 0:01:26
epoch [48/50] batch [300/428] time 0.084 (0.086) data 0.000 (0.002) loss 1.4808 (1.5460) ce_loss 1.3301 (1.3630) teacher_loss 0.6706 (0.8061) loss_zs_kd 0.4993 (0.4800) loss_oracle 0.5606 (0.4999) acc 53.1250 (50.2500) kd_loss 0.8698 (0.8115) lr 3.1417e-05 eta 0:01:24
epoch [48/50] batch [320/428] time 0.090 (0.086) data 0.000 (0.002) loss 1.6272 (1.5467) ce_loss 1.3799 (1.3632) teacher_loss 0.7994 (0.8057) loss_zs_kd 0.5627 (0.4816) loss_oracle 0.5465 (0.5002) acc 40.6250 (50.2637) kd_loss 0.8368 (0.8110) lr 3.1417e-05 eta 0:01:22
epoch [48/50] batch [340/428] time 0.083 (0.086) data 0.000 (0.002) loss 1.6268 (1.5463) ce_loss 1.4062 (1.3633) teacher_loss 0.8950 (0.8044) loss_zs_kd 0.4857 (0.4817) loss_oracle 0.4890 (0.5011) acc 34.3750 (50.1930) kd_loss 0.7751 (0.8132) lr 3.1417e-05 eta 0:01:20
epoch [48/50] batch [360/428] time 0.083 (0.085) data 0.000 (0.002) loss 1.4024 (1.5459) ce_loss 1.2393 (1.3629) teacher_loss 0.6936 (0.8032) loss_zs_kd 0.4541 (0.4812) loss_oracle 0.4817 (0.5020) acc 46.8750 (50.1910) kd_loss 0.7165 (0.8136) lr 3.1417e-05 eta 0:01:18
epoch [48/50] batch [380/428] time 0.079 (0.085) data 0.000 (0.002) loss 1.8080 (1.5458) ce_loss 1.5635 (1.3611) teacher_loss 0.9737 (0.8032) loss_zs_kd 0.5114 (0.4812) loss_oracle 0.5786 (0.5020) acc 43.7500 (50.2961) kd_loss 0.8870 (0.8138) lr 3.1417e-05 eta 0:01:16
epoch [48/50] batch [400/428] time 0.088 (0.085) data 0.000 (0.002) loss 1.3019 (1.5466) ce_loss 1.0225 (1.3638) teacher_loss 0.5302 (0.8037) loss_zs_kd 0.5424 (0.4821) loss_oracle 0.5005 (0.5019) acc 62.5000 (50.1094) kd_loss 0.9021 (0.8150) lr 3.1417e-05 eta 0:01:14
epoch [48/50] batch [420/428] time 0.077 (0.084) data 0.000 (0.002) loss 1.6524 (1.5467) ce_loss 1.4287 (1.3660) teacher_loss 0.8504 (0.8035) loss_zs_kd 0.5096 (0.4822) loss_oracle 0.5472 (0.5021) acc 53.1250 (50.0074) kd_loss 0.8551 (0.8151) lr 3.1417e-05 eta 0:01:12
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,949
* accuracy: 50.2%
* error: 49.8%
* macro_f1: 36.4%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,570
* accuracy: 54.2%
* error: 45.8%
* macro_f1: 30.1%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [49/50] batch [20/428] time 0.081 (0.106) data 0.000 (0.023) loss 1.2647 (1.6235) ce_loss 1.0889 (1.4204) teacher_loss 0.5395 (0.8530) loss_zs_kd 0.4312 (0.4949) loss_oracle 0.5096 (0.5231) acc 53.1250 (49.2188) kd_loss 0.7061 (0.8228) lr 1.7713e-05 eta 0:01:28
epoch [49/50] batch [40/428] time 0.087 (0.095) data 0.000 (0.012) loss 1.3622 (1.5972) ce_loss 1.1914 (1.4043) teacher_loss 0.5107 (0.8396) loss_zs_kd 0.5444 (0.4914) loss_oracle 0.5793 (0.5119) acc 53.1250 (49.2188) kd_loss 1.0206 (0.8233) lr 1.7713e-05 eta 0:01:17
epoch [49/50] batch [60/428] time 0.086 (0.092) data 0.001 (0.008) loss 1.4797 (1.5903) ce_loss 1.1992 (1.3944) teacher_loss 0.7279 (0.8383) loss_zs_kd 0.4935 (0.4868) loss_oracle 0.5050 (0.5087) acc 62.5000 (49.4792) kd_loss 0.8494 (0.8221) lr 1.7713e-05 eta 0:01:12
epoch [49/50] batch [80/428] time 0.089 (0.090) data 0.000 (0.006) loss 1.6112 (1.5874) ce_loss 1.3652 (1.3895) teacher_loss 0.8625 (0.8402) loss_zs_kd 0.4945 (0.4830) loss_oracle 0.5015 (0.5057) acc 46.8750 (49.9219) kd_loss 0.8182 (0.8293) lr 1.7713e-05 eta 0:01:09
epoch [49/50] batch [100/428] time 0.085 (0.089) data 0.000 (0.005) loss 1.3773 (1.5836) ce_loss 1.1553 (1.3956) teacher_loss 0.6115 (0.8359) loss_zs_kd 0.4487 (0.4829) loss_oracle 0.5414 (0.5062) acc 56.2500 (49.6250) kd_loss 0.7405 (0.8313) lr 1.7713e-05 eta 0:01:07
epoch [49/50] batch [120/428] time 0.096 (0.088) data 0.001 (0.004) loss 1.7292 (1.5823) ce_loss 1.5293 (1.4023) teacher_loss 0.9472 (0.8377) loss_zs_kd 0.4698 (0.4790) loss_oracle 0.5471 (0.5052) acc 46.8750 (49.1146) kd_loss 0.8230 (0.8297) lr 1.7713e-05 eta 0:01:04
epoch [49/50] batch [140/428] time 0.076 (0.087) data 0.000 (0.004) loss 1.7152 (1.5859) ce_loss 1.6143 (1.4143) teacher_loss 0.9044 (0.8405) loss_zs_kd 0.5119 (0.4797) loss_oracle 0.5548 (0.5055) acc 40.6250 (48.7723) kd_loss 0.8319 (0.8296) lr 1.7713e-05 eta 0:01:02
epoch [49/50] batch [160/428] time 0.070 (0.087) data 0.000 (0.003) loss 1.5557 (1.5753) ce_loss 1.5117 (1.4021) teacher_loss 0.8306 (0.8302) loss_zs_kd 0.4882 (0.4796) loss_oracle 0.4810 (0.5053) acc 46.8750 (49.2969) kd_loss 0.7225 (0.8292) lr 1.7713e-05 eta 0:01:00
epoch [49/50] batch [180/428] time 0.084 (0.086) data 0.000 (0.003) loss 1.3700 (1.5752) ce_loss 1.0820 (1.3959) teacher_loss 0.6367 (0.8322) loss_zs_kd 0.4809 (0.4790) loss_oracle 0.4929 (0.5035) acc 65.6250 (49.5660) kd_loss 0.8137 (0.8279) lr 1.7713e-05 eta 0:00:58
epoch [49/50] batch [200/428] time 0.088 (0.086) data 0.000 (0.003) loss 1.4413 (1.5725) ce_loss 1.2715 (1.3882) teacher_loss 0.7561 (0.8288) loss_zs_kd 0.4306 (0.4786) loss_oracle 0.4699 (0.5044) acc 53.1250 (49.7812) kd_loss 0.8340 (0.8266) lr 1.7713e-05 eta 0:00:56
epoch [49/50] batch [220/428] time 0.082 (0.086) data 0.000 (0.002) loss 1.2738 (1.5621) ce_loss 0.8101 (1.3759) teacher_loss 0.5452 (0.8193) loss_zs_kd 0.5058 (0.4789) loss_oracle 0.4757 (0.5033) acc 68.7500 (50.2557) kd_loss 0.7134 (0.8286) lr 1.7713e-05 eta 0:00:54
epoch [49/50] batch [240/428] time 0.085 (0.086) data 0.000 (0.002) loss 1.6192 (1.5630) ce_loss 1.4258 (1.3736) teacher_loss 0.8144 (0.8191) loss_zs_kd 0.4644 (0.4790) loss_oracle 0.5726 (0.5044) acc 40.6250 (50.2995) kd_loss 0.9784 (0.8299) lr 1.7713e-05 eta 0:00:52
epoch [49/50] batch [260/428] time 0.093 (0.086) data 0.000 (0.002) loss 1.6188 (1.5621) ce_loss 1.5078 (1.3738) teacher_loss 0.8352 (0.8182) loss_zs_kd 0.5128 (0.4794) loss_oracle 0.5272 (0.5042) acc 46.8750 (50.1923) kd_loss 0.8652 (0.8289) lr 1.7713e-05 eta 0:00:50
epoch [49/50] batch [280/428] time 0.083 (0.086) data 0.000 (0.002) loss 1.4140 (1.5611) ce_loss 1.2109 (1.3739) teacher_loss 0.7195 (0.8160) loss_zs_kd 0.4454 (0.4807) loss_oracle 0.4717 (0.5048) acc 59.3750 (50.1228) kd_loss 0.8288 (0.8273) lr 1.7713e-05 eta 0:00:49
epoch [49/50] batch [300/428] time 0.080 (0.085) data 0.000 (0.002) loss 1.3832 (1.5558) ce_loss 1.2188 (1.3684) teacher_loss 0.6184 (0.8113) loss_zs_kd 0.4710 (0.4810) loss_oracle 0.5292 (0.5040) acc 53.1250 (50.2604) kd_loss 0.7960 (0.8260) lr 1.7713e-05 eta 0:00:47
epoch [49/50] batch [320/428] time 0.086 (0.085) data 0.000 (0.002) loss 1.4399 (1.5541) ce_loss 1.2393 (1.3685) teacher_loss 0.7534 (0.8098) loss_zs_kd 0.4891 (0.4813) loss_oracle 0.4419 (0.5037) acc 59.3750 (50.1758) kd_loss 0.7402 (0.8259) lr 1.7713e-05 eta 0:00:45
epoch [49/50] batch [340/428] time 0.093 (0.086) data 0.001 (0.002) loss 1.5283 (1.5544) ce_loss 1.5430 (1.3693) teacher_loss 0.6727 (0.8091) loss_zs_kd 0.5704 (0.4827) loss_oracle 0.5704 (0.5039) acc 46.8750 (50.1838) kd_loss 0.8055 (0.8265) lr 1.7713e-05 eta 0:00:44
epoch [49/50] batch [360/428] time 0.078 (0.086) data 0.000 (0.002) loss 1.3355 (1.5531) ce_loss 1.0674 (1.3672) teacher_loss 0.5288 (0.8072) loss_zs_kd 0.4743 (0.4826) loss_oracle 0.5696 (0.5047) acc 59.3750 (50.2604) kd_loss 0.8616 (0.8267) lr 1.7713e-05 eta 0:00:42
epoch [49/50] batch [380/428] time 0.078 (0.085) data 0.000 (0.002) loss 1.1921 (1.5536) ce_loss 0.8921 (1.3685) teacher_loss 0.5035 (0.8075) loss_zs_kd 0.4017 (0.4829) loss_oracle 0.4878 (0.5047) acc 71.8750 (50.1398) kd_loss 0.7436 (0.8271) lr 1.7713e-05 eta 0:00:40
epoch [49/50] batch [400/428] time 0.084 (0.085) data 0.000 (0.001) loss 1.5337 (1.5508) ce_loss 1.3457 (1.3654) teacher_loss 0.8189 (0.8047) loss_zs_kd 0.4654 (0.4830) loss_oracle 0.4821 (0.5046) acc 50.0000 (50.2578) kd_loss 0.7237 (0.8251) lr 1.7713e-05 eta 0:00:38
epoch [49/50] batch [420/428] time 0.078 (0.085) data 0.000 (0.001) loss 1.3626 (1.5512) ce_loss 1.2754 (1.3665) teacher_loss 0.6025 (0.8049) loss_zs_kd 0.5123 (0.4830) loss_oracle 0.5039 (0.5048) acc 53.1250 (50.2381) kd_loss 0.9137 (0.8253) lr 1.7713e-05 eta 0:00:37
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,957
* accuracy: 50.3%
* error: 49.7%
* macro_f1: 36.6%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,564
* accuracy: 54.1%
* error: 45.9%
* macro_f1: 30.1%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
epoch [50/50] batch [20/428] time 0.075 (0.099) data 0.000 (0.024) loss 1.5043 (1.5408) ce_loss 1.2119 (1.3252) teacher_loss 0.7616 (0.7863) loss_zs_kd 0.5141 (0.4772) loss_oracle 0.4856 (0.5159) acc 56.2500 (53.2812) kd_loss 0.7175 (0.8280) lr 7.8853e-06 eta 0:00:40
epoch [50/50] batch [40/428] time 0.079 (0.091) data 0.000 (0.012) loss 1.7182 (1.5412) ce_loss 1.5312 (1.3512) teacher_loss 0.9452 (0.7952) loss_zs_kd 0.5128 (0.4804) loss_oracle 0.5165 (0.5058) acc 40.6250 (50.3125) kd_loss 0.8094 (0.8291) lr 7.8853e-06 eta 0:00:35
epoch [50/50] batch [60/428] time 0.073 (0.086) data 0.000 (0.008) loss 1.5643 (1.5490) ce_loss 1.1777 (1.3511) teacher_loss 0.7981 (0.8016) loss_zs_kd 0.4372 (0.4835) loss_oracle 0.5475 (0.5056) acc 53.1250 (49.8958) kd_loss 0.8171 (0.8220) lr 7.8853e-06 eta 0:00:31
epoch [50/50] batch [80/428] time 0.079 (0.086) data 0.000 (0.006) loss 1.5978 (1.5608) ce_loss 1.4229 (1.3613) teacher_loss 0.7727 (0.8143) loss_zs_kd 0.5215 (0.4836) loss_oracle 0.5643 (0.5047) acc 50.0000 (49.6484) kd_loss 0.8861 (0.8141) lr 7.8853e-06 eta 0:00:29
epoch [50/50] batch [100/428] time 0.079 (0.085) data 0.000 (0.005) loss 1.7047 (1.5592) ce_loss 1.6230 (1.3539) teacher_loss 0.9491 (0.8122) loss_zs_kd 0.4947 (0.4845) loss_oracle 0.5083 (0.5048) acc 40.6250 (50.1562) kd_loss 0.7715 (0.8086) lr 7.8853e-06 eta 0:00:28
epoch [50/50] batch [120/428] time 0.082 (0.085) data 0.000 (0.004) loss 1.4276 (1.5509) ce_loss 1.4004 (1.3510) teacher_loss 0.6806 (0.8049) loss_zs_kd 0.5212 (0.4846) loss_oracle 0.4864 (0.5037) acc 43.7500 (49.9740) kd_loss 0.9769 (0.8083) lr 7.8853e-06 eta 0:00:26
epoch [50/50] batch [140/428] time 0.081 (0.085) data 0.000 (0.004) loss 1.7668 (1.5536) ce_loss 1.7637 (1.3545) teacher_loss 0.9394 (0.8098) loss_zs_kd 0.5227 (0.4846) loss_oracle 0.5661 (0.5015) acc 40.6250 (49.9330) kd_loss 0.9735 (0.8040) lr 7.8853e-06 eta 0:00:24
epoch [50/50] batch [160/428] time 0.080 (0.085) data 0.000 (0.003) loss 1.6353 (1.5576) ce_loss 1.3604 (1.3619) teacher_loss 0.8966 (0.8129) loss_zs_kd 0.5725 (0.4857) loss_oracle 0.4524 (0.5018) acc 53.1250 (49.9609) kd_loss 0.8691 (0.8083) lr 7.8853e-06 eta 0:00:22
epoch [50/50] batch [180/428] time 0.092 (0.084) data 0.000 (0.003) loss 1.7814 (1.5592) ce_loss 1.4590 (1.3648) teacher_loss 1.0263 (0.8152) loss_zs_kd 0.4263 (0.4845) loss_oracle 0.5418 (0.5018) acc 53.1250 (50.0347) kd_loss 0.7288 (0.8103) lr 7.8853e-06 eta 0:00:20
epoch [50/50] batch [200/428] time 0.079 (0.084) data 0.000 (0.003) loss 1.6689 (1.5560) ce_loss 1.4336 (1.3636) teacher_loss 0.8837 (0.8114) loss_zs_kd 0.5313 (0.4834) loss_oracle 0.5196 (0.5029) acc 40.6250 (50.2031) kd_loss 0.7146 (0.8110) lr 7.8853e-06 eta 0:00:19
epoch [50/50] batch [220/428] time 0.083 (0.084) data 0.000 (0.002) loss 1.3882 (1.5531) ce_loss 1.1533 (1.3629) teacher_loss 0.7319 (0.8100) loss_zs_kd 0.4174 (0.4827) loss_oracle 0.4476 (0.5018) acc 53.1250 (50.0426) kd_loss 0.6485 (0.8100) lr 7.8853e-06 eta 0:00:17
epoch [50/50] batch [240/428] time 0.082 (0.083) data 0.000 (0.002) loss 1.4812 (1.5533) ce_loss 1.3691 (1.3613) teacher_loss 0.7702 (0.8093) loss_zs_kd 0.4464 (0.4827) loss_oracle 0.4878 (0.5026) acc 43.7500 (50.0651) kd_loss 0.7250 (0.8114) lr 7.8853e-06 eta 0:00:15
epoch [50/50] batch [260/428] time 0.079 (0.083) data 0.000 (0.002) loss 1.4959 (1.5538) ce_loss 1.5332 (1.3649) teacher_loss 0.8015 (0.8118) loss_zs_kd 0.4708 (0.4820) loss_oracle 0.4590 (0.5011) acc 37.5000 (49.8317) kd_loss 0.8900 (0.8123) lr 7.8853e-06 eta 0:00:14
epoch [50/50] batch [280/428] time 0.081 (0.083) data 0.000 (0.002) loss 1.5762 (1.5516) ce_loss 1.4053 (1.3631) teacher_loss 0.7551 (0.8084) loss_zs_kd 0.5885 (0.4827) loss_oracle 0.5268 (0.5018) acc 43.7500 (49.9330) kd_loss 0.8677 (0.8146) lr 7.8853e-06 eta 0:00:12
epoch [50/50] batch [300/428] time 0.079 (0.083) data 0.000 (0.002) loss 1.6358 (1.5504) ce_loss 1.2852 (1.3595) teacher_loss 0.9798 (0.8086) loss_zs_kd 0.3868 (0.4822) loss_oracle 0.4626 (0.5007) acc 50.0000 (50.0833) kd_loss 0.7313 (0.8142) lr 7.8853e-06 eta 0:00:10
epoch [50/50] batch [320/428] time 0.077 (0.083) data 0.000 (0.002) loss 1.7662 (1.5512) ce_loss 1.4688 (1.3606) teacher_loss 1.0516 (0.8084) loss_zs_kd 0.4915 (0.4827) loss_oracle 0.4688 (0.5015) acc 43.7500 (50.0684) kd_loss 0.8456 (0.8157) lr 7.8853e-06 eta 0:00:08
epoch [50/50] batch [340/428] time 0.084 (0.083) data 0.000 (0.002) loss 1.6940 (1.5546) ce_loss 1.5664 (1.3644) teacher_loss 0.9616 (0.8124) loss_zs_kd 0.4749 (0.4826) loss_oracle 0.4950 (0.5009) acc 34.3750 (49.9908) kd_loss 0.9482 (0.8164) lr 7.8853e-06 eta 0:00:07
epoch [50/50] batch [360/428] time 0.092 (0.083) data 0.000 (0.002) loss 1.5014 (1.5562) ce_loss 1.2373 (1.3675) teacher_loss 0.7646 (0.8144) loss_zs_kd 0.4742 (0.4820) loss_oracle 0.4998 (0.5008) acc 62.5000 (49.9219) kd_loss 0.7181 (0.8162) lr 7.8853e-06 eta 0:00:05
epoch [50/50] batch [380/428] time 0.083 (0.083) data 0.000 (0.002) loss 1.4778 (1.5556) ce_loss 1.4170 (1.3675) teacher_loss 0.7818 (0.8132) loss_zs_kd 0.4505 (0.4823) loss_oracle 0.4708 (0.5013) acc 46.8750 (49.8438) kd_loss 0.9730 (0.8160) lr 7.8853e-06 eta 0:00:03
epoch [50/50] batch [400/428] time 0.078 (0.083) data 0.000 (0.001) loss 1.5905 (1.5514) ce_loss 1.4102 (1.3634) teacher_loss 0.8163 (0.8084) loss_zs_kd 0.5248 (0.4830) loss_oracle 0.5119 (0.5015) acc 40.6250 (49.9531) kd_loss 0.7146 (0.8177) lr 7.8853e-06 eta 0:00:02
epoch [50/50] batch [420/428] time 0.079 (0.083) data 0.000 (0.001) loss 1.3008 (1.5506) ce_loss 1.1533 (1.3633) teacher_loss 0.5843 (0.8074) loss_zs_kd 0.4998 (0.4828) loss_oracle 0.4666 (0.5017) acc 59.3750 (49.9330) kd_loss 1.0216 (0.8184) lr 7.8853e-06 eta 0:00:00
Evaluate on the *val* set
=> result
* total: 5,876
* correct: 2,952
* accuracy: 50.2%
* error: 49.8%
* macro_f1: 36.5%
Evaluate on the *test* set
=> result
* total: 4,741
* correct: 2,572
* accuracy: 54.3%
* error: 45.7%
* macro_f1: 30.1%
******* Domain 1 best val acc:      53.5%, epoch: 27 *******
******* Domain 1 best val test acc: 51.9%, epoch: 27 *******
******* Domain 1 best test acc:     58.0%, epoch: 19 *******
Checkpoint saved to icml/multi-dg/oracle/02_oracle1.0/TRIP/terra_incognita/b32_ep50/ViT-B16/1/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:45:13
