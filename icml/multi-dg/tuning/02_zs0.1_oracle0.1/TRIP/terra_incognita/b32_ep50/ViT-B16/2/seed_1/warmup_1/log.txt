Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_100', 'location_43', 'location_46']
Target     ['location_38']
# classes  10
# train_x  10,216
# val      4,378
# test     9,736
---------  ----------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/319] time 0.130 (0.179) data 0.000 (0.041) loss 1.2536 (2.0187) ce_loss 1.2529 (2.0153) loss_zs_kd 0.0002 (0.0001) loss_oracle -0.0002 (-0.0001) acc 59.3750 (37.0312) kd_loss 0.0007 (0.0034) lr 1.0000e-05 eta 0:47:39
epoch [1/50] batch [40/319] time 0.075 (0.130) data 0.000 (0.021) loss 1.5763 (1.9147) ce_loss 1.5742 (1.9122) loss_zs_kd 0.0015 (0.0003) loss_oracle -0.0002 (-0.0001) acc 56.2500 (39.7656) kd_loss 0.0020 (0.0026) lr 1.0000e-05 eta 0:34:26
epoch [1/50] batch [60/319] time 0.184 (0.116) data 0.000 (0.014) loss 2.1731 (1.9427) ce_loss 2.1719 (1.9405) loss_zs_kd 0.0026 (0.0007) loss_oracle -0.0000 (-0.0001) acc 31.2500 (39.2188) kd_loss 0.0009 (0.0022) lr 1.0000e-05 eta 0:30:40
epoch [1/50] batch [80/319] time 0.073 (0.113) data 0.000 (0.010) loss 1.9743 (1.9241) ce_loss 1.9727 (1.9220) loss_zs_kd 0.0037 (0.0014) loss_oracle -0.0001 (-0.0001) acc 43.7500 (38.8281) kd_loss 0.0013 (0.0019) lr 1.0000e-05 eta 0:29:53
epoch [1/50] batch [100/319] time 0.079 (0.113) data 0.000 (0.008) loss 2.1719 (1.8854) ce_loss 2.1699 (1.8834) loss_zs_kd 0.0070 (0.0023) loss_oracle -0.0001 (-0.0001) acc 25.0000 (39.3750) kd_loss 0.0013 (0.0018) lr 1.0000e-05 eta 0:29:54
epoch [1/50] batch [120/319] time 0.078 (0.114) data 0.000 (0.007) loss 1.8702 (1.8835) ce_loss 1.8672 (1.8814) loss_zs_kd 0.0062 (0.0032) loss_oracle -0.0001 (-0.0001) acc 40.6250 (39.5312) kd_loss 0.0024 (0.0018) lr 1.0000e-05 eta 0:29:58
epoch [1/50] batch [140/319] time 0.081 (0.114) data 0.000 (0.006) loss 2.0591 (1.8837) ce_loss 2.0547 (1.8814) loss_zs_kd 0.0098 (0.0042) loss_oracle -0.0001 (-0.0001) acc 37.5000 (39.4866) kd_loss 0.0035 (0.0019) lr 1.0000e-05 eta 0:30:02
epoch [1/50] batch [160/319] time 0.072 (0.114) data 0.000 (0.005) loss 1.8347 (1.8801) ce_loss 1.8311 (1.8775) loss_zs_kd 0.0129 (0.0054) loss_oracle -0.0001 (-0.0001) acc 34.3750 (39.6289) kd_loss 0.0023 (0.0021) lr 1.0000e-05 eta 0:29:58
epoch [1/50] batch [180/319] time 0.062 (0.113) data 0.000 (0.005) loss 2.1814 (1.8770) ce_loss 2.1758 (1.8742) loss_zs_kd 0.0217 (0.0068) loss_oracle -0.0001 (-0.0001) acc 28.1250 (39.5660) kd_loss 0.0035 (0.0021) lr 1.0000e-05 eta 0:29:48
epoch [1/50] batch [200/319] time 0.079 (0.109) data 0.000 (0.004) loss 2.0015 (1.8730) ce_loss 1.9941 (1.8699) loss_zs_kd 0.0225 (0.0082) loss_oracle 0.0000 (-0.0001) acc 31.2500 (39.5156) kd_loss 0.0051 (0.0023) lr 1.0000e-05 eta 0:28:39
epoch [1/50] batch [220/319] time 0.107 (0.108) data 0.000 (0.004) loss 1.7328 (1.8795) ce_loss 1.7236 (1.8759) loss_zs_kd 0.0286 (0.0099) loss_oracle 0.0001 (-0.0001) acc 50.0000 (39.1477) kd_loss 0.0063 (0.0026) lr 1.0000e-05 eta 0:28:15
epoch [1/50] batch [240/319] time 0.108 (0.107) data 0.000 (0.004) loss 1.9479 (1.8867) ce_loss 1.9365 (1.8826) loss_zs_kd 0.0397 (0.0116) loss_oracle 0.0001 (-0.0000) acc 28.1250 (38.8281) kd_loss 0.0074 (0.0030) lr 1.0000e-05 eta 0:27:56
epoch [1/50] batch [260/319] time 0.108 (0.106) data 0.000 (0.003) loss 1.9827 (1.8849) ce_loss 1.9736 (1.8801) loss_zs_kd 0.0353 (0.0133) loss_oracle 0.0002 (-0.0000) acc 37.5000 (38.7380) kd_loss 0.0055 (0.0034) lr 1.0000e-05 eta 0:27:47
epoch [1/50] batch [280/319] time 0.094 (0.106) data 0.000 (0.003) loss 2.0865 (1.8819) ce_loss 2.0703 (1.8765) loss_zs_kd 0.0490 (0.0152) loss_oracle 0.0002 (-0.0000) acc 31.2500 (38.7500) kd_loss 0.0113 (0.0039) lr 1.0000e-05 eta 0:27:41
epoch [1/50] batch [300/319] time 0.106 (0.106) data 0.000 (0.003) loss 2.3018 (1.8788) ce_loss 2.2891 (1.8726) loss_zs_kd 0.0492 (0.0172) loss_oracle 0.0002 (-0.0000) acc 31.2500 (38.7292) kd_loss 0.0078 (0.0045) lr 1.0000e-05 eta 0:27:36
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 1,764
* accuracy: 40.3%
* error: 59.7%
* macro_f1: 25.2%
Checkpoint saved to icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,077
* accuracy: 31.6%
* error: 68.4%
* macro_f1: 11.9%
Checkpoint saved to icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      40.3%, epoch: 1 *******
******* Domain 2 best val test acc: 31.6%, epoch: 1 *******
******* Domain 2 best test acc:     31.6%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/ana
epoch [2/50] batch [20/319] time 0.097 (0.150) data 0.000 (0.033) loss 2.0324 (1.7734) ce_loss 1.7285 (1.6418) loss_zs_kd 0.1731 (0.1969) loss_oracle 0.1352 (0.0512) acc 43.7500 (39.3750) kd_loss 0.2730 (0.1068) lr 2.0000e-03 eta 0:39:05
epoch [2/50] batch [40/319] time 0.090 (0.134) data 0.000 (0.017) loss 2.3692 (1.8545) ce_loss 2.0430 (1.6118) loss_zs_kd 0.2354 (0.2295) loss_oracle 0.2154 (0.1264) acc 28.1250 (41.2500) kd_loss 0.2812 (0.2071) lr 2.0000e-03 eta 0:34:43
epoch [2/50] batch [60/319] time 0.082 (0.120) data 0.000 (0.011) loss 1.9299 (1.8679) ce_loss 1.5010 (1.5737) loss_zs_kd 0.2686 (0.2460) loss_oracle 0.2573 (0.1686) acc 40.6250 (42.3438) kd_loss 0.3763 (0.2527) lr 2.0000e-03 eta 0:31:12
epoch [2/50] batch [80/319] time 0.075 (0.115) data 0.000 (0.008) loss 1.8962 (1.8654) ce_loss 1.4639 (1.5355) loss_zs_kd 0.3171 (0.2614) loss_oracle 0.2401 (0.2322) acc 34.3750 (43.3203) kd_loss 0.3766 (0.2805) lr 2.0000e-03 eta 0:29:54
epoch [2/50] batch [100/319] time 0.075 (0.115) data 0.000 (0.007) loss 1.9745 (1.8709) ce_loss 1.5117 (1.5151) loss_zs_kd 0.3961 (0.2884) loss_oracle 0.3295 (0.2348) acc 40.6250 (43.5000) kd_loss 0.3902 (0.3035) lr 2.0000e-03 eta 0:29:38
epoch [2/50] batch [120/319] time 0.073 (0.114) data 0.000 (0.006) loss 1.7395 (1.8768) ce_loss 1.1104 (1.4889) loss_zs_kd 0.4209 (0.3221) loss_oracle 0.5936 (0.2713) acc 59.3750 (44.1667) kd_loss 0.5277 (0.3285) lr 2.0000e-03 eta 0:29:33
epoch [2/50] batch [140/319] time 0.080 (0.114) data 0.000 (0.005) loss 2.3195 (1.8998) ce_loss 1.6611 (1.4751) loss_zs_kd 0.4296 (0.3403) loss_oracle 0.4392 (0.2812) acc 31.2500 (44.8214) kd_loss 0.5715 (0.3626) lr 2.0000e-03 eta 0:29:27
epoch [2/50] batch [160/319] time 0.075 (0.114) data 0.000 (0.004) loss 2.1128 (1.9269) ce_loss 1.3535 (1.4575) loss_zs_kd 0.3472 (0.3564) loss_oracle 0.2507 (0.2987) acc 56.2500 (45.6250) kd_loss 0.6995 (0.4039) lr 2.0000e-03 eta 0:29:22
epoch [2/50] batch [180/319] time 0.075 (0.114) data 0.000 (0.004) loss 2.3818 (1.9546) ce_loss 1.5254 (1.4492) loss_zs_kd 0.5543 (0.3661) loss_oracle 0.6313 (0.3102) acc 40.6250 (46.0590) kd_loss 0.7379 (0.4377) lr 2.0000e-03 eta 0:29:20
epoch [2/50] batch [200/319] time 0.074 (0.113) data 0.000 (0.004) loss 2.1186 (1.9814) ce_loss 1.2900 (1.4429) loss_zs_kd 0.4859 (0.3757) loss_oracle 0.3560 (0.3278) acc 50.0000 (46.1719) kd_loss 0.7443 (0.4682) lr 2.0000e-03 eta 0:28:57
epoch [2/50] batch [220/319] time 0.080 (0.110) data 0.000 (0.003) loss 2.4883 (2.0051) ce_loss 1.6143 (1.4348) loss_zs_kd 0.4227 (0.3876) loss_oracle 0.4616 (0.3392) acc 37.5000 (46.1932) kd_loss 0.7856 (0.4976) lr 2.0000e-03 eta 0:28:07
epoch [2/50] batch [240/319] time 0.104 (0.109) data 0.000 (0.003) loss 2.0412 (2.0211) ce_loss 1.0381 (1.4213) loss_zs_kd 0.5828 (0.3985) loss_oracle 0.5357 (0.3595) acc 53.1250 (46.7708) kd_loss 0.8913 (0.5240) lr 2.0000e-03 eta 0:27:51
epoch [2/50] batch [260/319] time 0.108 (0.108) data 0.000 (0.003) loss 2.2806 (2.0336) ce_loss 1.2207 (1.4036) loss_zs_kd 0.4218 (0.4089) loss_oracle 0.6798 (0.3828) acc 50.0000 (47.4399) kd_loss 0.9497 (0.5508) lr 2.0000e-03 eta 0:27:39
epoch [2/50] batch [280/319] time 0.099 (0.108) data 0.000 (0.003) loss 2.1821 (2.0533) ce_loss 1.1631 (1.3975) loss_zs_kd 0.4436 (0.4166) loss_oracle 0.8841 (0.4127) acc 50.0000 (47.6339) kd_loss 0.8863 (0.5728) lr 2.0000e-03 eta 0:27:32
epoch [2/50] batch [300/319] time 0.107 (0.107) data 0.000 (0.002) loss 2.1218 (2.0717) ce_loss 1.2070 (1.3944) loss_zs_kd 0.4902 (0.4273) loss_oracle 0.4604 (0.4247) acc 50.0000 (47.7708) kd_loss 0.8197 (0.5920) lr 2.0000e-03 eta 0:27:25
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,373
* accuracy: 54.2%
* error: 45.8%
* macro_f1: 43.3%
Checkpoint saved to icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,422
* accuracy: 45.4%
* error: 54.6%
* macro_f1: 23.1%
Checkpoint saved to icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      54.2%, epoch: 2 *******
******* Domain 2 best val test acc: 45.4%, epoch: 2 *******
******* Domain 2 best test acc:     45.4%, epoch: 2 *******
epoch [3/50] batch [20/319] time 0.138 (0.125) data 0.000 (0.031) loss 2.0242 (2.1861) ce_loss 1.0361 (1.2065) loss_zs_kd 0.4222 (0.6190) loss_oracle 0.7241 (0.6740) acc 53.1250 (54.0625) kd_loss 0.8734 (0.8502) lr 1.9980e-03 eta 0:31:52
epoch [3/50] batch [40/319] time 0.163 (0.115) data 0.000 (0.015) loss 2.3068 (2.2119) ce_loss 1.2461 (1.2346) loss_zs_kd 0.5322 (0.5946) loss_oracle 0.6935 (0.6595) acc 65.6250 (53.2031) kd_loss 0.9382 (0.8519) lr 1.9980e-03 eta 0:29:21
epoch [3/50] batch [60/319] time 0.073 (0.112) data 0.000 (0.010) loss 2.0278 (2.2190) ce_loss 1.0225 (1.2362) loss_zs_kd 0.5258 (0.5966) loss_oracle 0.4821 (0.6639) acc 65.6250 (53.3333) kd_loss 0.9045 (0.8567) lr 1.9980e-03 eta 0:28:30
epoch [3/50] batch [80/319] time 0.073 (0.113) data 0.000 (0.008) loss 2.0262 (2.2288) ce_loss 1.0537 (1.2466) loss_zs_kd 0.4760 (0.5988) loss_oracle 0.6510 (0.6501) acc 56.2500 (52.5781) kd_loss 0.8598 (0.8572) lr 1.9980e-03 eta 0:28:39
epoch [3/50] batch [100/319] time 0.072 (0.107) data 0.000 (0.006) loss 2.2523 (2.2319) ce_loss 1.2344 (1.2502) loss_zs_kd 0.6612 (0.5914) loss_oracle 0.7110 (0.6642) acc 56.2500 (53.1562) kd_loss 0.8807 (0.8561) lr 1.9980e-03 eta 0:27:02
epoch [3/50] batch [120/319] time 0.150 (0.103) data 0.000 (0.005) loss 2.4445 (2.2341) ce_loss 1.4082 (1.2474) loss_zs_kd 0.5924 (0.5874) loss_oracle 0.8068 (0.6791) acc 43.7500 (53.4115) kd_loss 0.8964 (0.8600) lr 1.9980e-03 eta 0:26:03
epoch [3/50] batch [140/319] time 0.059 (0.100) data 0.000 (0.005) loss 2.0543 (2.2334) ce_loss 1.0020 (1.2420) loss_zs_kd 0.5742 (0.5886) loss_oracle 0.6718 (0.6819) acc 62.5000 (53.3259) kd_loss 0.9277 (0.8643) lr 1.9980e-03 eta 0:25:21
epoch [3/50] batch [160/319] time 0.088 (0.102) data 0.000 (0.004) loss 2.2142 (2.2365) ce_loss 1.0986 (1.2397) loss_zs_kd 0.6738 (0.5973) loss_oracle 0.8163 (0.6959) acc 59.3750 (53.3398) kd_loss 0.9666 (0.8674) lr 1.9980e-03 eta 0:25:47
epoch [3/50] batch [180/319] time 0.166 (0.104) data 0.000 (0.004) loss 2.3163 (2.2441) ce_loss 1.3281 (1.2426) loss_zs_kd 0.5104 (0.6025) loss_oracle 0.8766 (0.7070) acc 43.7500 (53.1944) kd_loss 0.8494 (0.8705) lr 1.9980e-03 eta 0:26:12
epoch [3/50] batch [200/319] time 0.080 (0.104) data 0.000 (0.003) loss 2.2302 (2.2459) ce_loss 1.2129 (1.2406) loss_zs_kd 0.6500 (0.6087) loss_oracle 0.8349 (0.7151) acc 53.1250 (53.2188) kd_loss 0.8688 (0.8729) lr 1.9980e-03 eta 0:26:16
epoch [3/50] batch [220/319] time 0.084 (0.105) data 0.000 (0.003) loss 2.2133 (2.2494) ce_loss 1.1953 (1.2411) loss_zs_kd 0.5290 (0.6074) loss_oracle 1.0685 (0.7354) acc 37.5000 (53.2244) kd_loss 0.8583 (0.8740) lr 1.9980e-03 eta 0:26:28
epoch [3/50] batch [240/319] time 0.077 (0.106) data 0.000 (0.003) loss 2.5102 (2.2491) ce_loss 1.5684 (1.2387) loss_zs_kd 0.7745 (0.6098) loss_oracle 0.7415 (0.7480) acc 43.7500 (53.3073) kd_loss 0.7902 (0.8746) lr 1.9980e-03 eta 0:26:37
epoch [3/50] batch [260/319] time 0.078 (0.104) data 0.000 (0.003) loss 2.2662 (2.2547) ce_loss 1.2607 (1.2417) loss_zs_kd 0.6062 (0.6151) loss_oracle 0.9615 (0.7639) acc 40.6250 (53.2933) kd_loss 0.8487 (0.8751) lr 1.9980e-03 eta 0:26:10
epoch [3/50] batch [280/319] time 0.115 (0.104) data 0.000 (0.002) loss 2.2688 (2.2543) ce_loss 1.2334 (1.2390) loss_zs_kd 0.4809 (0.6174) loss_oracle 0.9114 (0.7730) acc 46.8750 (53.2812) kd_loss 0.8962 (0.8763) lr 1.9980e-03 eta 0:25:59
epoch [3/50] batch [300/319] time 0.100 (0.104) data 0.000 (0.002) loss 2.0090 (2.2541) ce_loss 0.9478 (1.2381) loss_zs_kd 0.5218 (0.6225) loss_oracle 1.0311 (0.7800) acc 65.6250 (53.4167) kd_loss 0.9060 (0.8757) lr 1.9980e-03 eta 0:25:54
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,549
* accuracy: 58.2%
* error: 41.8%
* macro_f1: 47.8%
Checkpoint saved to icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,688
* accuracy: 48.2%
* error: 51.8%
* macro_f1: 23.1%
Checkpoint saved to icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      58.2%, epoch: 3 *******
******* Domain 2 best val test acc: 48.2%, epoch: 3 *******
******* Domain 2 best test acc:     48.2%, epoch: 3 *******
epoch [4/50] batch [20/319] time 0.104 (0.134) data 0.000 (0.032) loss 2.2574 (2.2347) ce_loss 1.3057 (1.2232) loss_zs_kd 0.6104 (0.6117) loss_oracle 0.7867 (0.7032) acc 53.1250 (53.4375) kd_loss 0.8121 (0.8800) lr 1.9921e-03 eta 0:33:29
epoch [4/50] batch [40/319] time 0.092 (0.116) data 0.000 (0.016) loss 2.2071 (2.2451) ce_loss 1.1709 (1.2171) loss_zs_kd 0.5571 (0.6128) loss_oracle 0.9241 (0.8041) acc 46.8750 (52.5000) kd_loss 0.8881 (0.8863) lr 1.9921e-03 eta 0:28:47
epoch [4/50] batch [60/319] time 0.087 (0.105) data 0.000 (0.011) loss 2.6004 (2.2359) ce_loss 1.5088 (1.1984) loss_zs_kd 0.7047 (0.6242) loss_oracle 0.7768 (0.8379) acc 43.7500 (53.6979) kd_loss 0.9435 (0.8913) lr 1.9921e-03 eta 0:26:07
epoch [4/50] batch [80/319] time 0.161 (0.105) data 0.000 (0.008) loss 2.3155 (2.2353) ce_loss 1.2686 (1.2002) loss_zs_kd 0.6725 (0.6511) loss_oracle 0.8158 (0.8500) acc 65.6250 (53.9453) kd_loss 0.8981 (0.8849) lr 1.9921e-03 eta 0:26:07
epoch [4/50] batch [100/319] time 0.092 (0.107) data 0.000 (0.007) loss 2.3305 (2.2350) ce_loss 1.3447 (1.2029) loss_zs_kd 0.6866 (0.6572) loss_oracle 0.9452 (0.8567) acc 53.1250 (53.8750) kd_loss 0.8226 (0.8807) lr 1.9921e-03 eta 0:26:40
epoch [4/50] batch [120/319] time 0.072 (0.110) data 0.000 (0.005) loss 2.2301 (2.2300) ce_loss 1.1836 (1.2008) loss_zs_kd 0.6508 (0.6618) loss_oracle 0.7997 (0.8625) acc 59.3750 (54.3750) kd_loss 0.9014 (0.8768) lr 1.9921e-03 eta 0:27:09
epoch [4/50] batch [140/319] time 0.085 (0.105) data 0.000 (0.005) loss 2.3906 (2.2275) ce_loss 1.3672 (1.1989) loss_zs_kd 0.6969 (0.6664) loss_oracle 0.8775 (0.8679) acc 53.1250 (54.9554) kd_loss 0.8660 (0.8752) lr 1.9921e-03 eta 0:26:03
epoch [4/50] batch [160/319] time 0.077 (0.102) data 0.000 (0.004) loss 2.5420 (2.2276) ce_loss 1.6045 (1.2000) loss_zs_kd 0.6894 (0.6612) loss_oracle 0.7243 (0.8684) acc 40.6250 (54.9805) kd_loss 0.7962 (0.8746) lr 1.9921e-03 eta 0:25:11
epoch [4/50] batch [180/319] time 0.077 (0.103) data 0.000 (0.004) loss 2.2081 (2.2256) ce_loss 1.2617 (1.1982) loss_zs_kd 0.5210 (0.6619) loss_oracle 0.8706 (0.8704) acc 56.2500 (55.0347) kd_loss 0.8072 (0.8742) lr 1.9921e-03 eta 0:25:27
epoch [4/50] batch [200/319] time 0.079 (0.104) data 0.000 (0.003) loss 2.1549 (2.2205) ce_loss 1.1436 (1.1944) loss_zs_kd 0.6174 (0.6606) loss_oracle 0.8993 (0.8665) acc 56.2500 (55.3438) kd_loss 0.8597 (0.8734) lr 1.9921e-03 eta 0:25:42
epoch [4/50] batch [220/319] time 0.095 (0.106) data 0.000 (0.003) loss 2.2234 (2.2132) ce_loss 1.2217 (1.1895) loss_zs_kd 0.7189 (0.6616) loss_oracle 0.8970 (0.8737) acc 50.0000 (55.5966) kd_loss 0.8401 (0.8702) lr 1.9921e-03 eta 0:26:01
epoch [4/50] batch [240/319] time 0.163 (0.106) data 0.000 (0.003) loss 2.2200 (2.2141) ce_loss 1.1689 (1.1906) loss_zs_kd 0.6432 (0.6618) loss_oracle 0.9962 (0.8763) acc 56.2500 (55.5859) kd_loss 0.8871 (0.8697) lr 1.9921e-03 eta 0:25:57
epoch [4/50] batch [260/319] time 0.093 (0.105) data 0.000 (0.003) loss 2.2141 (2.2152) ce_loss 1.2432 (1.1923) loss_zs_kd 0.7685 (0.6680) loss_oracle 0.9003 (0.8812) acc 46.8750 (55.5409) kd_loss 0.8040 (0.8680) lr 1.9921e-03 eta 0:25:54
epoch [4/50] batch [280/319] time 0.179 (0.107) data 0.000 (0.003) loss 2.1595 (2.2095) ce_loss 1.1211 (1.1873) loss_zs_kd 0.6497 (0.6658) loss_oracle 0.8240 (0.8810) acc 65.6250 (55.8929) kd_loss 0.8910 (0.8675) lr 1.9921e-03 eta 0:26:09
epoch [4/50] batch [300/319] time 0.076 (0.105) data 0.000 (0.002) loss 2.0419 (2.2050) ce_loss 0.9619 (1.1827) loss_zs_kd 0.8193 (0.6652) loss_oracle 0.9369 (0.8831) acc 68.7500 (56.0938) kd_loss 0.9044 (0.8675) lr 1.9921e-03 eta 0:25:47
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,670
* accuracy: 61.0%
* error: 39.0%
* macro_f1: 50.8%
Checkpoint saved to icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,372
* accuracy: 55.2%
* error: 44.8%
* macro_f1: 22.1%
Checkpoint saved to icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      61.0%, epoch: 4 *******
******* Domain 2 best val test acc: 55.2%, epoch: 4 *******
******* Domain 2 best test acc:     55.2%, epoch: 4 *******
epoch [5/50] batch [20/319] time 0.099 (0.149) data 0.000 (0.046) loss 2.1671 (2.1854) ce_loss 1.1504 (1.1786) loss_zs_kd 0.5269 (0.6454) loss_oracle 0.7156 (0.9833) acc 56.2500 (53.9062) kd_loss 0.8925 (0.8439) lr 1.9823e-03 eta 0:36:21
epoch [5/50] batch [40/319] time 0.102 (0.126) data 0.000 (0.023) loss 1.8990 (2.1863) ce_loss 0.9282 (1.1770) loss_zs_kd 0.6807 (0.6552) loss_oracle 0.9297 (0.9593) acc 65.6250 (53.7500) kd_loss 0.8098 (0.8479) lr 1.9823e-03 eta 0:30:47
epoch [5/50] batch [60/319] time 0.088 (0.114) data 0.000 (0.015) loss 2.0669 (2.1919) ce_loss 1.0293 (1.1780) loss_zs_kd 0.8428 (0.6640) loss_oracle 1.0553 (0.9695) acc 68.7500 (54.4271) kd_loss 0.8478 (0.8505) lr 1.9823e-03 eta 0:27:45
epoch [5/50] batch [80/319] time 0.085 (0.107) data 0.000 (0.012) loss 2.0192 (2.1830) ce_loss 0.9238 (1.1644) loss_zs_kd 0.5327 (0.6628) loss_oracle 1.0550 (0.9758) acc 71.8750 (54.8828) kd_loss 0.9366 (0.8547) lr 1.9823e-03 eta 0:26:01
epoch [5/50] batch [100/319] time 0.073 (0.108) data 0.000 (0.009) loss 2.3887 (2.1752) ce_loss 1.3203 (1.1566) loss_zs_kd 0.6625 (0.6655) loss_oracle 0.9081 (0.9706) acc 43.7500 (55.1562) kd_loss 0.9113 (0.8550) lr 1.9823e-03 eta 0:26:14
epoch [5/50] batch [120/319] time 0.079 (0.108) data 0.000 (0.008) loss 2.1985 (2.1839) ce_loss 1.1377 (1.1633) loss_zs_kd 0.6873 (0.6626) loss_oracle 0.8586 (0.9583) acc 59.3750 (54.8698) kd_loss 0.9063 (0.8585) lr 1.9823e-03 eta 0:26:14
epoch [5/50] batch [140/319] time 0.073 (0.107) data 0.000 (0.007) loss 2.4605 (2.1774) ce_loss 1.4609 (1.1586) loss_zs_kd 0.5797 (0.6751) loss_oracle 1.1219 (0.9589) acc 40.6250 (55.0670) kd_loss 0.8294 (0.8554) lr 1.9823e-03 eta 0:25:52
epoch [5/50] batch [160/319] time 0.080 (0.104) data 0.000 (0.006) loss 2.3057 (2.1729) ce_loss 1.2812 (1.1554) loss_zs_kd 0.6968 (0.6702) loss_oracle 0.8431 (0.9488) acc 46.8750 (55.4102) kd_loss 0.8704 (0.8555) lr 1.9823e-03 eta 0:25:05
epoch [5/50] batch [180/319] time 0.083 (0.105) data 0.000 (0.005) loss 1.9350 (2.1636) ce_loss 0.8950 (1.1487) loss_zs_kd 0.6990 (0.6721) loss_oracle 0.9718 (0.9486) acc 65.6250 (55.7118) kd_loss 0.8729 (0.8529) lr 1.9823e-03 eta 0:25:26
epoch [5/50] batch [200/319] time 0.073 (0.105) data 0.000 (0.005) loss 2.0722 (2.1612) ce_loss 1.0361 (1.1480) loss_zs_kd 0.8993 (0.6681) loss_oracle 0.8633 (0.9492) acc 62.5000 (55.9531) kd_loss 0.8598 (0.8514) lr 1.9823e-03 eta 0:25:19
epoch [5/50] batch [220/319] time 0.146 (0.106) data 0.000 (0.004) loss 1.8006 (2.1601) ce_loss 0.9463 (1.1503) loss_zs_kd 0.5089 (0.6679) loss_oracle 0.9784 (0.9427) acc 59.3750 (55.9091) kd_loss 0.7056 (0.8488) lr 1.9823e-03 eta 0:25:34
epoch [5/50] batch [240/319] time 0.181 (0.107) data 0.000 (0.004) loss 1.9868 (2.1630) ce_loss 1.0156 (1.1552) loss_zs_kd 0.5312 (0.6655) loss_oracle 1.0442 (0.9396) acc 65.6250 (55.8854) kd_loss 0.8136 (0.8473) lr 1.9823e-03 eta 0:25:42
epoch [5/50] batch [260/319] time 0.079 (0.107) data 0.000 (0.004) loss 2.3482 (2.1661) ce_loss 1.3477 (1.1571) loss_zs_kd 0.7397 (0.6639) loss_oracle 1.0235 (0.9391) acc 37.5000 (55.8053) kd_loss 0.8242 (0.8488) lr 1.9823e-03 eta 0:25:43
epoch [5/50] batch [280/319] time 0.147 (0.108) data 0.000 (0.004) loss 1.8183 (2.1642) ce_loss 0.7500 (1.1545) loss_zs_kd 0.4179 (0.6619) loss_oracle 1.0457 (0.9426) acc 75.0000 (55.9933) kd_loss 0.9219 (0.8492) lr 1.9823e-03 eta 0:25:53
epoch [5/50] batch [300/319] time 0.085 (0.107) data 0.000 (0.003) loss 2.2003 (2.1665) ce_loss 1.2109 (1.1546) loss_zs_kd 0.6233 (0.6653) loss_oracle 0.8760 (0.9439) acc 53.1250 (55.9896) kd_loss 0.8394 (0.8509) lr 1.9823e-03 eta 0:25:40
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,742
* accuracy: 62.6%
* error: 37.4%
* macro_f1: 51.0%
Checkpoint saved to icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,889
* accuracy: 50.2%
* error: 49.8%
* macro_f1: 21.8%
******* Domain 2 best val acc:      62.6%, epoch: 5 *******
******* Domain 2 best val test acc: 50.2%, epoch: 5 *******
******* Domain 2 best test acc:     55.2%, epoch: 4 *******
epoch [6/50] batch [20/319] time 0.092 (0.133) data 0.000 (0.039) loss 2.3813 (2.1568) ce_loss 1.4092 (1.1030) loss_zs_kd 0.6954 (0.6990) loss_oracle 1.0095 (0.9546) acc 43.7500 (60.7812) kd_loss 0.8017 (0.8884) lr 1.9686e-03 eta 0:31:46
epoch [6/50] batch [40/319] time 0.082 (0.111) data 0.000 (0.020) loss 2.1317 (2.1212) ce_loss 1.1621 (1.0861) loss_zs_kd 0.6644 (0.6942) loss_oracle 0.8906 (0.9759) acc 56.2500 (60.3125) kd_loss 0.8141 (0.8681) lr 1.9686e-03 eta 0:26:32
epoch [6/50] batch [60/319] time 0.091 (0.106) data 0.000 (0.013) loss 2.2349 (2.1340) ce_loss 1.2676 (1.1127) loss_zs_kd 0.6655 (0.6714) loss_oracle 0.9414 (0.9866) acc 43.7500 (58.3854) kd_loss 0.8067 (0.8555) lr 1.9686e-03 eta 0:25:09
epoch [6/50] batch [80/319] time 0.083 (0.101) data 0.000 (0.010) loss 2.2552 (2.1384) ce_loss 1.2725 (1.1212) loss_zs_kd 0.6066 (0.6759) loss_oracle 0.9582 (0.9888) acc 65.6250 (57.6953) kd_loss 0.8263 (0.8507) lr 1.9686e-03 eta 0:23:57
epoch [6/50] batch [100/319] time 0.065 (0.100) data 0.000 (0.008) loss 2.0685 (2.1562) ce_loss 1.0586 (1.1361) loss_zs_kd 0.7050 (0.6642) loss_oracle 1.0427 (1.0041) acc 59.3750 (56.7812) kd_loss 0.8351 (0.8533) lr 1.9686e-03 eta 0:23:51
epoch [6/50] batch [120/319] time 0.086 (0.100) data 0.000 (0.007) loss 2.1343 (2.1472) ce_loss 1.0869 (1.1325) loss_zs_kd 0.7433 (0.6687) loss_oracle 1.0244 (1.0126) acc 68.7500 (57.1094) kd_loss 0.8707 (0.8466) lr 1.9686e-03 eta 0:23:42
epoch [6/50] batch [140/319] time 0.152 (0.102) data 0.000 (0.006) loss 2.3339 (2.1440) ce_loss 1.2939 (1.1290) loss_zs_kd 0.6277 (0.6681) loss_oracle 0.9484 (1.0096) acc 53.1250 (57.5000) kd_loss 0.8823 (0.8472) lr 1.9686e-03 eta 0:24:09
epoch [6/50] batch [160/319] time 0.088 (0.101) data 0.000 (0.005) loss 2.0546 (2.1434) ce_loss 1.0498 (1.1293) loss_zs_kd 0.5202 (0.6721) loss_oracle 1.2456 (1.0046) acc 56.2500 (57.4219) kd_loss 0.8282 (0.8464) lr 1.9686e-03 eta 0:23:51
epoch [6/50] batch [180/319] time 0.083 (0.099) data 0.000 (0.005) loss 2.3000 (2.1490) ce_loss 1.3545 (1.1356) loss_zs_kd 0.7297 (0.6715) loss_oracle 1.0535 (1.0032) acc 46.8750 (56.9965) kd_loss 0.7672 (0.8460) lr 1.9686e-03 eta 0:23:25
epoch [6/50] batch [200/319] time 0.086 (0.098) data 0.000 (0.004) loss 2.1239 (2.1468) ce_loss 1.1270 (1.1346) loss_zs_kd 0.6138 (0.6655) loss_oracle 0.9658 (1.0048) acc 53.1250 (57.1406) kd_loss 0.8390 (0.8452) lr 1.9686e-03 eta 0:23:02
epoch [6/50] batch [220/319] time 0.083 (0.099) data 0.000 (0.004) loss 2.0617 (2.1439) ce_loss 1.1035 (1.1336) loss_zs_kd 0.6565 (0.6702) loss_oracle 0.9508 (1.0046) acc 62.5000 (57.2585) kd_loss 0.7974 (0.8429) lr 1.9686e-03 eta 0:23:22
epoch [6/50] batch [240/319] time 0.076 (0.101) data 0.000 (0.004) loss 2.3614 (2.1457) ce_loss 1.3965 (1.1368) loss_zs_kd 0.7082 (0.6688) loss_oracle 0.9807 (1.0074) acc 34.3750 (57.0833) kd_loss 0.7960 (0.8413) lr 1.9686e-03 eta 0:23:41
epoch [6/50] batch [260/319] time 0.147 (0.102) data 0.000 (0.003) loss 1.8897 (2.1442) ce_loss 0.9448 (1.1371) loss_zs_kd 0.7575 (0.6717) loss_oracle 1.1872 (1.0111) acc 62.5000 (57.1514) kd_loss 0.7504 (0.8389) lr 1.9686e-03 eta 0:23:58
epoch [6/50] batch [280/319] time 0.076 (0.103) data 0.000 (0.003) loss 2.1165 (2.1434) ce_loss 1.1719 (1.1375) loss_zs_kd 0.5866 (0.6746) loss_oracle 1.2547 (1.0133) acc 46.8750 (57.0982) kd_loss 0.7605 (0.8370) lr 1.9686e-03 eta 0:24:06
epoch [6/50] batch [300/319] time 0.081 (0.104) data 0.000 (0.003) loss 2.1334 (2.1457) ce_loss 1.1094 (1.1409) loss_zs_kd 0.7012 (0.6712) loss_oracle 1.1418 (1.0150) acc 68.7500 (57.0833) kd_loss 0.8397 (0.8362) lr 1.9686e-03 eta 0:24:18
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,747
* accuracy: 62.7%
* error: 37.3%
* macro_f1: 51.5%
Checkpoint saved to icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,020
* accuracy: 51.6%
* error: 48.4%
* macro_f1: 21.8%
******* Domain 2 best val acc:      62.7%, epoch: 6 *******
******* Domain 2 best val test acc: 51.6%, epoch: 6 *******
******* Domain 2 best test acc:     55.2%, epoch: 4 *******
epoch [7/50] batch [20/319] time 0.106 (0.150) data 0.000 (0.048) loss 1.7129 (2.0579) ce_loss 0.7314 (1.0935) loss_zs_kd 0.6340 (0.6488) loss_oracle 1.0707 (1.0114) acc 75.0000 (61.4062) kd_loss 0.8110 (0.7984) lr 1.9511e-03 eta 0:34:56
epoch [7/50] batch [40/319] time 0.099 (0.128) data 0.000 (0.024) loss 2.3832 (2.1032) ce_loss 1.4395 (1.1407) loss_zs_kd 0.7420 (0.6427) loss_oracle 1.0409 (1.0007) acc 53.1250 (58.6719) kd_loss 0.7654 (0.7982) lr 1.9511e-03 eta 0:29:56
epoch [7/50] batch [60/319] time 0.105 (0.120) data 0.001 (0.016) loss 2.1013 (2.0938) ce_loss 1.1133 (1.1277) loss_zs_kd 0.7109 (0.6551) loss_oracle 0.9368 (1.0153) acc 62.5000 (58.8021) kd_loss 0.8232 (0.7990) lr 1.9511e-03 eta 0:28:02
epoch [7/50] batch [80/319] time 0.078 (0.114) data 0.000 (0.012) loss 2.0318 (2.1051) ce_loss 1.0703 (1.1414) loss_zs_kd 0.6318 (0.6440) loss_oracle 1.1051 (1.0254) acc 68.7500 (58.0469) kd_loss 0.7878 (0.7967) lr 1.9511e-03 eta 0:26:27
epoch [7/50] batch [100/319] time 0.091 (0.108) data 0.000 (0.010) loss 2.1584 (2.1143) ce_loss 1.1553 (1.1522) loss_zs_kd 0.6318 (0.6428) loss_oracle 1.1651 (1.0457) acc 59.3750 (57.5625) kd_loss 0.8234 (0.7933) lr 1.9511e-03 eta 0:25:03
epoch [7/50] batch [120/319] time 0.078 (0.107) data 0.000 (0.008) loss 2.3524 (2.1116) ce_loss 1.4111 (1.1482) loss_zs_kd 0.6894 (0.6582) loss_oracle 1.0268 (1.0418) acc 59.3750 (57.5000) kd_loss 0.7696 (0.7933) lr 1.9511e-03 eta 0:24:43
epoch [7/50] batch [140/319] time 0.089 (0.106) data 0.000 (0.007) loss 1.9952 (2.1064) ce_loss 1.0107 (1.1421) loss_zs_kd 0.7252 (0.6605) loss_oracle 0.9408 (1.0298) acc 56.2500 (57.9241) kd_loss 0.8179 (0.7953) lr 1.9511e-03 eta 0:24:36
epoch [7/50] batch [160/319] time 0.171 (0.108) data 0.000 (0.006) loss 2.0007 (2.1072) ce_loss 1.0547 (1.1421) loss_zs_kd 0.5431 (0.6605) loss_oracle 1.0980 (1.0305) acc 62.5000 (57.5977) kd_loss 0.7819 (0.7961) lr 1.9511e-03 eta 0:24:59
epoch [7/50] batch [180/319] time 0.086 (0.107) data 0.000 (0.006) loss 2.1388 (2.1099) ce_loss 1.2158 (1.1457) loss_zs_kd 0.6560 (0.6664) loss_oracle 0.9933 (1.0340) acc 59.3750 (57.5347) kd_loss 0.7581 (0.7942) lr 1.9511e-03 eta 0:24:37
epoch [7/50] batch [200/319] time 0.083 (0.105) data 0.000 (0.005) loss 2.4144 (2.1073) ce_loss 1.4619 (1.1417) loss_zs_kd 0.8559 (0.6724) loss_oracle 1.0933 (1.0424) acc 53.1250 (57.7188) kd_loss 0.7575 (0.7942) lr 1.9511e-03 eta 0:24:08
epoch [7/50] batch [220/319] time 0.078 (0.106) data 0.000 (0.005) loss 2.1045 (2.1012) ce_loss 1.0967 (1.1326) loss_zs_kd 0.7398 (0.6705) loss_oracle 0.9579 (1.0448) acc 62.5000 (58.0682) kd_loss 0.8381 (0.7971) lr 1.9511e-03 eta 0:24:22
epoch [7/50] batch [240/319] time 0.078 (0.107) data 0.000 (0.004) loss 2.2068 (2.1005) ce_loss 1.2266 (1.1314) loss_zs_kd 0.6543 (0.6736) loss_oracle 1.1929 (1.0478) acc 50.0000 (58.0339) kd_loss 0.7955 (0.7970) lr 1.9511e-03 eta 0:24:30
epoch [7/50] batch [260/319] time 0.078 (0.107) data 0.000 (0.004) loss 1.9211 (2.1026) ce_loss 0.9780 (1.1325) loss_zs_kd 0.6648 (0.6724) loss_oracle 1.0430 (1.0588) acc 68.7500 (57.9327) kd_loss 0.7723 (0.7970) lr 1.9511e-03 eta 0:24:36
epoch [7/50] batch [280/319] time 0.085 (0.108) data 0.000 (0.004) loss 2.0472 (2.1036) ce_loss 1.0156 (1.1325) loss_zs_kd 0.7519 (0.6716) loss_oracle 1.1177 (1.0639) acc 59.3750 (57.9911) kd_loss 0.8446 (0.7975) lr 1.9511e-03 eta 0:24:39
epoch [7/50] batch [300/319] time 0.084 (0.108) data 0.000 (0.003) loss 2.0599 (2.0998) ce_loss 1.1855 (1.1298) loss_zs_kd 0.7670 (0.6712) loss_oracle 0.9322 (1.0650) acc 50.0000 (58.1250) kd_loss 0.7044 (0.7964) lr 1.9511e-03 eta 0:24:43
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,778
* accuracy: 63.5%
* error: 36.5%
* macro_f1: 54.7%
Checkpoint saved to icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,229
* accuracy: 53.7%
* error: 46.3%
* macro_f1: 23.3%
******* Domain 2 best val acc:      63.5%, epoch: 7 *******
******* Domain 2 best val test acc: 53.7%, epoch: 7 *******
******* Domain 2 best test acc:     55.2%, epoch: 4 *******
epoch [8/50] batch [20/319] time 0.082 (0.143) data 0.000 (0.050) loss 2.2462 (2.1257) ce_loss 1.3691 (1.1771) loss_zs_kd 0.6466 (0.6128) loss_oracle 1.1719 (1.1487) acc 50.0000 (55.7812) kd_loss 0.6952 (0.7725) lr 1.9298e-03 eta 0:32:43
epoch [8/50] batch [40/319] time 0.094 (0.116) data 0.000 (0.025) loss 1.9275 (2.1042) ce_loss 0.9263 (1.1366) loss_zs_kd 0.6635 (0.6594) loss_oracle 1.0840 (1.1166) acc 59.3750 (56.0938) kd_loss 0.8264 (0.7900) lr 1.9298e-03 eta 0:26:30
epoch [8/50] batch [60/319] time 0.085 (0.109) data 0.000 (0.017) loss 2.0550 (2.0803) ce_loss 1.1074 (1.1166) loss_zs_kd 0.6681 (0.6685) loss_oracle 1.1327 (1.1003) acc 62.5000 (56.9792) kd_loss 0.7675 (0.7868) lr 1.9298e-03 eta 0:24:45
epoch [8/50] batch [80/319] time 0.082 (0.105) data 0.000 (0.013) loss 1.9954 (2.0614) ce_loss 1.0654 (1.1003) loss_zs_kd 0.5688 (0.6574) loss_oracle 1.1433 (1.1068) acc 59.3750 (57.8906) kd_loss 0.7588 (0.7847) lr 1.9298e-03 eta 0:23:46
epoch [8/50] batch [100/319] time 0.064 (0.100) data 0.000 (0.010) loss 1.9592 (2.0699) ce_loss 0.9028 (1.1071) loss_zs_kd 0.7402 (0.6675) loss_oracle 1.2124 (1.0996) acc 62.5000 (57.5938) kd_loss 0.8611 (0.7861) lr 1.9298e-03 eta 0:22:45
epoch [8/50] batch [120/319] time 0.090 (0.098) data 0.000 (0.009) loss 2.2374 (2.0613) ce_loss 1.2432 (1.0999) loss_zs_kd 0.8514 (0.6710) loss_oracle 0.9335 (1.0879) acc 53.1250 (58.5156) kd_loss 0.8158 (0.7855) lr 1.9298e-03 eta 0:22:06
epoch [8/50] batch [140/319] time 0.077 (0.098) data 0.000 (0.007) loss 2.0675 (2.0651) ce_loss 1.0938 (1.1044) loss_zs_kd 0.8608 (0.6699) loss_oracle 1.1320 (1.1024) acc 65.6250 (58.3036) kd_loss 0.7745 (0.7835) lr 1.9298e-03 eta 0:22:04
epoch [8/50] batch [160/319] time 0.066 (0.099) data 0.000 (0.007) loss 2.1383 (2.0700) ce_loss 1.1787 (1.1072) loss_zs_kd 0.5968 (0.6716) loss_oracle 1.1503 (1.1188) acc 56.2500 (58.2812) kd_loss 0.7849 (0.7838) lr 1.9298e-03 eta 0:22:18
epoch [8/50] batch [180/319] time 0.208 (0.100) data 0.001 (0.006) loss 2.2258 (2.0743) ce_loss 1.2910 (1.1110) loss_zs_kd 0.5925 (0.6775) loss_oracle 1.2518 (1.1227) acc 56.2500 (58.3507) kd_loss 0.7504 (0.7832) lr 1.9298e-03 eta 0:22:29
epoch [8/50] batch [200/319] time 0.073 (0.098) data 0.000 (0.005) loss 2.0020 (2.0713) ce_loss 1.0908 (1.1082) loss_zs_kd 0.8199 (0.6749) loss_oracle 1.1072 (1.1234) acc 53.1250 (58.1875) kd_loss 0.7185 (0.7833) lr 1.9298e-03 eta 0:22:00
epoch [8/50] batch [220/319] time 0.083 (0.096) data 0.000 (0.005) loss 1.8294 (2.0690) ce_loss 0.7773 (1.1079) loss_zs_kd 0.7890 (0.6760) loss_oracle 1.1698 (1.1232) acc 71.8750 (58.3239) kd_loss 0.8561 (0.7812) lr 1.9298e-03 eta 0:21:41
epoch [8/50] batch [240/319] time 0.072 (0.097) data 0.000 (0.004) loss 2.1803 (2.0674) ce_loss 1.2617 (1.1054) loss_zs_kd 0.6999 (0.6775) loss_oracle 1.0953 (1.1268) acc 56.2500 (58.5677) kd_loss 0.7391 (0.7815) lr 1.9298e-03 eta 0:21:45
epoch [8/50] batch [260/319] time 0.080 (0.097) data 0.000 (0.004) loss 2.2785 (2.0690) ce_loss 1.3066 (1.1057) loss_zs_kd 0.7570 (0.6778) loss_oracle 1.0254 (1.1299) acc 50.0000 (58.5337) kd_loss 0.7936 (0.7825) lr 1.9298e-03 eta 0:21:44
epoch [8/50] batch [280/319] time 0.168 (0.098) data 0.000 (0.004) loss 2.1669 (2.0670) ce_loss 1.2002 (1.1022) loss_zs_kd 0.5964 (0.6792) loss_oracle 0.9708 (1.1274) acc 50.0000 (58.5938) kd_loss 0.8100 (0.7841) lr 1.9298e-03 eta 0:21:58
epoch [8/50] batch [300/319] time 0.083 (0.099) data 0.000 (0.004) loss 2.2430 (2.0728) ce_loss 1.3301 (1.1072) loss_zs_kd 0.5449 (0.6786) loss_oracle 1.1899 (1.1306) acc 50.0000 (58.4688) kd_loss 0.7395 (0.7846) lr 1.9298e-03 eta 0:22:12
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,816
* accuracy: 64.3%
* error: 35.7%
* macro_f1: 52.5%
Checkpoint saved to icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,320
* accuracy: 54.6%
* error: 45.4%
* macro_f1: 23.2%
******* Domain 2 best val acc:      64.3%, epoch: 8 *******
******* Domain 2 best val test acc: 54.6%, epoch: 8 *******
******* Domain 2 best test acc:     55.2%, epoch: 4 *******
epoch [9/50] batch [20/319] time 0.104 (0.165) data 0.000 (0.058) loss 1.9181 (2.0260) ce_loss 0.9150 (1.0403) loss_zs_kd 0.7201 (0.7450) loss_oracle 1.1885 (1.1388) acc 62.5000 (59.0625) kd_loss 0.8122 (0.7973) lr 1.9048e-03 eta 0:36:41
epoch [9/50] batch [40/319] time 0.121 (0.135) data 0.000 (0.029) loss 2.0363 (2.0191) ce_loss 1.0566 (1.0333) loss_zs_kd 0.8120 (0.7333) loss_oracle 1.1282 (1.1381) acc 56.2500 (59.6875) kd_loss 0.7856 (0.7986) lr 1.9048e-03 eta 0:30:04
epoch [9/50] batch [60/319] time 0.089 (0.124) data 0.000 (0.020) loss 2.1864 (2.0554) ce_loss 1.2041 (1.0635) loss_zs_kd 0.7011 (0.7113) loss_oracle 1.1935 (1.1719) acc 53.1250 (59.1146) kd_loss 0.7929 (0.8036) lr 1.9048e-03 eta 0:27:39
epoch [9/50] batch [80/319] time 0.109 (0.118) data 0.001 (0.015) loss 2.1900 (2.0748) ce_loss 1.1270 (1.0818) loss_zs_kd 0.6322 (0.7019) loss_oracle 1.2424 (1.1817) acc 62.5000 (59.0234) kd_loss 0.8756 (0.8046) lr 1.9048e-03 eta 0:26:13
epoch [9/50] batch [100/319] time 0.109 (0.116) data 0.000 (0.012) loss 2.3026 (2.0783) ce_loss 1.2959 (1.0845) loss_zs_kd 0.5410 (0.6887) loss_oracle 1.2348 (1.1793) acc 53.1250 (59.4375) kd_loss 0.8291 (0.8070) lr 1.9048e-03 eta 0:25:38
epoch [9/50] batch [120/319] time 0.111 (0.114) data 0.000 (0.010) loss 2.0935 (2.0950) ce_loss 1.0762 (1.0992) loss_zs_kd 0.5695 (0.6784) loss_oracle 1.0217 (1.1821) acc 65.6250 (59.1667) kd_loss 0.8582 (0.8097) lr 1.9048e-03 eta 0:25:10
epoch [9/50] batch [140/319] time 0.084 (0.110) data 0.000 (0.009) loss 2.3579 (2.1034) ce_loss 1.4229 (1.1059) loss_zs_kd 0.6587 (0.6780) loss_oracle 1.2082 (1.1925) acc 34.3750 (58.8170) kd_loss 0.7484 (0.8104) lr 1.9048e-03 eta 0:24:24
epoch [9/50] batch [160/319] time 0.087 (0.107) data 0.000 (0.008) loss 2.1015 (2.0958) ce_loss 1.1260 (1.0991) loss_zs_kd 0.7558 (0.6880) loss_oracle 1.0497 (1.1853) acc 62.5000 (59.1016) kd_loss 0.7950 (0.8094) lr 1.9048e-03 eta 0:23:40
epoch [9/50] batch [180/319] time 0.094 (0.107) data 0.000 (0.007) loss 2.0102 (2.0890) ce_loss 1.0322 (1.0960) loss_zs_kd 0.7419 (0.6905) loss_oracle 1.2938 (1.1763) acc 68.7500 (59.1146) kd_loss 0.7744 (0.8064) lr 1.9048e-03 eta 0:23:34
epoch [9/50] batch [200/319] time 0.099 (0.108) data 0.000 (0.006) loss 2.1211 (2.0866) ce_loss 1.1172 (1.0977) loss_zs_kd 0.5451 (0.6899) loss_oracle 1.3458 (1.1803) acc 56.2500 (59.0781) kd_loss 0.8149 (0.8019) lr 1.9048e-03 eta 0:23:42
epoch [9/50] batch [220/319] time 0.081 (0.109) data 0.000 (0.006) loss 2.0206 (2.0827) ce_loss 1.0635 (1.0962) loss_zs_kd 0.5452 (0.6857) loss_oracle 1.1670 (1.1824) acc 50.0000 (58.9915) kd_loss 0.7859 (0.7998) lr 1.9048e-03 eta 0:23:53
epoch [9/50] batch [240/319] time 0.089 (0.107) data 0.000 (0.005) loss 2.1693 (2.0811) ce_loss 1.2129 (1.0974) loss_zs_kd 0.8030 (0.6830) loss_oracle 1.1379 (1.1823) acc 53.1250 (59.1016) kd_loss 0.7623 (0.7971) lr 1.9048e-03 eta 0:23:22
epoch [9/50] batch [260/319] time 0.074 (0.106) data 0.000 (0.005) loss 2.0797 (2.0760) ce_loss 1.1338 (1.0959) loss_zs_kd 0.6688 (0.6840) loss_oracle 1.1814 (1.1803) acc 56.2500 (59.0986) kd_loss 0.7609 (0.7937) lr 1.9048e-03 eta 0:23:14
epoch [9/50] batch [280/319] time 0.088 (0.106) data 0.000 (0.004) loss 1.9115 (2.0795) ce_loss 0.9487 (1.1020) loss_zs_kd 0.7673 (0.6819) loss_oracle 1.1524 (1.1820) acc 68.7500 (58.9174) kd_loss 0.7708 (0.7911) lr 1.9048e-03 eta 0:23:16
epoch [9/50] batch [300/319] time 0.155 (0.106) data 0.000 (0.004) loss 2.2299 (2.0777) ce_loss 1.3174 (1.1016) loss_zs_kd 0.7173 (0.6827) loss_oracle 1.0846 (1.1837) acc 56.2500 (58.8229) kd_loss 0.7323 (0.7894) lr 1.9048e-03 eta 0:23:12
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,828
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 52.7%
Checkpoint saved to icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,328
* accuracy: 54.7%
* error: 45.3%
* macro_f1: 24.4%
******* Domain 2 best val acc:      64.6%, epoch: 9 *******
******* Domain 2 best val test acc: 54.7%, epoch: 9 *******
******* Domain 2 best test acc:     55.2%, epoch: 4 *******
epoch [10/50] batch [20/319] time 0.104 (0.168) data 0.000 (0.066) loss 2.3927 (2.0751) ce_loss 1.3965 (1.1349) loss_zs_kd 0.6642 (0.6737) loss_oracle 1.3535 (1.2211) acc 53.1250 (60.4688) kd_loss 0.7945 (0.7508) lr 1.8763e-03 eta 0:36:29
epoch [10/50] batch [40/319] time 0.094 (0.135) data 0.000 (0.033) loss 2.1644 (2.0681) ce_loss 1.2119 (1.1263) loss_zs_kd 0.6212 (0.6691) loss_oracle 1.1055 (1.2188) acc 59.3750 (58.5156) kd_loss 0.7798 (0.7530) lr 1.8763e-03 eta 0:29:14
epoch [10/50] batch [60/319] time 0.105 (0.123) data 0.000 (0.022) loss 2.2180 (2.0602) ce_loss 1.2617 (1.1125) loss_zs_kd 0.6875 (0.6678) loss_oracle 1.2134 (1.2185) acc 56.2500 (58.3854) kd_loss 0.7662 (0.7590) lr 1.8763e-03 eta 0:26:38
epoch [10/50] batch [80/319] time 0.113 (0.117) data 0.000 (0.017) loss 1.8716 (2.0676) ce_loss 0.9419 (1.1180) loss_zs_kd 0.6349 (0.6626) loss_oracle 1.0922 (1.2168) acc 68.7500 (58.0859) kd_loss 0.7570 (0.7616) lr 1.8763e-03 eta 0:25:25
epoch [10/50] batch [100/319] time 0.101 (0.114) data 0.000 (0.013) loss 1.8265 (2.0774) ce_loss 0.8662 (1.1265) loss_zs_kd 0.5563 (0.6651) loss_oracle 1.3286 (1.2249) acc 68.7500 (57.6562) kd_loss 0.7718 (0.7619) lr 1.8763e-03 eta 0:24:45
epoch [10/50] batch [120/319] time 0.109 (0.112) data 0.000 (0.011) loss 2.0474 (2.0718) ce_loss 1.0977 (1.1213) loss_zs_kd 0.6323 (0.6669) loss_oracle 1.2675 (1.2255) acc 56.2500 (57.9688) kd_loss 0.7598 (0.7612) lr 1.8763e-03 eta 0:24:14
epoch [10/50] batch [140/319] time 0.093 (0.110) data 0.000 (0.010) loss 1.8821 (2.0585) ce_loss 0.9219 (1.1090) loss_zs_kd 0.7159 (0.6663) loss_oracle 1.1551 (1.2138) acc 68.7500 (58.6384) kd_loss 0.7732 (0.7614) lr 1.8763e-03 eta 0:23:46
epoch [10/50] batch [160/319] time 0.088 (0.107) data 0.000 (0.008) loss 2.1408 (2.0536) ce_loss 1.2109 (1.1055) loss_zs_kd 0.6944 (0.6622) loss_oracle 1.1430 (1.2120) acc 59.3750 (58.9453) kd_loss 0.7462 (0.7607) lr 1.8763e-03 eta 0:23:01
epoch [10/50] batch [180/319] time 0.084 (0.104) data 0.000 (0.008) loss 2.0613 (2.0630) ce_loss 1.0967 (1.1143) loss_zs_kd 0.4910 (0.6630) loss_oracle 1.2770 (1.2097) acc 65.6250 (58.7847) kd_loss 0.7878 (0.7614) lr 1.8763e-03 eta 0:22:25
epoch [10/50] batch [200/319] time 0.094 (0.106) data 0.000 (0.007) loss 1.7199 (2.0619) ce_loss 0.7832 (1.1121) loss_zs_kd 0.5864 (0.6587) loss_oracle 1.3087 (1.2163) acc 78.1250 (58.8750) kd_loss 0.7472 (0.7623) lr 1.8763e-03 eta 0:22:43
epoch [10/50] batch [220/319] time 0.155 (0.107) data 0.000 (0.006) loss 1.9809 (2.0639) ce_loss 1.0088 (1.1123) loss_zs_kd 0.5907 (0.6616) loss_oracle 1.2893 (1.2161) acc 50.0000 (58.9347) kd_loss 0.7841 (0.7638) lr 1.8763e-03 eta 0:22:54
epoch [10/50] batch [240/319] time 0.080 (0.106) data 0.000 (0.006) loss 1.9502 (2.0658) ce_loss 1.0654 (1.1148) loss_zs_kd 0.7191 (0.6655) loss_oracle 1.1441 (1.2139) acc 59.3750 (58.8281) kd_loss 0.6985 (0.7630) lr 1.8763e-03 eta 0:22:43
epoch [10/50] batch [260/319] time 0.079 (0.104) data 0.000 (0.005) loss 2.0496 (2.0675) ce_loss 1.1270 (1.1159) loss_zs_kd 0.7085 (0.6660) loss_oracle 1.2952 (1.2156) acc 53.1250 (58.6298) kd_loss 0.7223 (0.7635) lr 1.8763e-03 eta 0:22:19
epoch [10/50] batch [280/319] time 0.079 (0.104) data 0.000 (0.005) loss 2.1317 (2.0630) ce_loss 1.1592 (1.1105) loss_zs_kd 0.7668 (0.6699) loss_oracle 1.2605 (1.2192) acc 50.0000 (58.7612) kd_loss 0.7698 (0.7636) lr 1.8763e-03 eta 0:22:08
epoch [10/50] batch [300/319] time 0.056 (0.104) data 0.000 (0.005) loss 2.1007 (2.0617) ce_loss 1.1572 (1.1089) loss_zs_kd 0.6782 (0.6706) loss_oracle 1.2129 (1.2201) acc 53.1250 (58.7500) kd_loss 0.7544 (0.7638) lr 1.8763e-03 eta 0:22:06
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,764
* accuracy: 63.1%
* error: 36.9%
* macro_f1: 55.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,261
* accuracy: 54.0%
* error: 46.0%
* macro_f1: 22.9%
******* Domain 2 best val acc:      64.6%, epoch: 9 *******
******* Domain 2 best val test acc: 54.7%, epoch: 9 *******
******* Domain 2 best test acc:     55.2%, epoch: 4 *******
epoch [11/50] batch [20/319] time 0.083 (0.149) data 0.000 (0.062) loss 1.9283 (2.0245) ce_loss 1.0059 (1.0722) loss_zs_kd 0.5958 (0.6068) loss_oracle 1.1915 (1.2826) acc 53.1250 (59.2188) kd_loss 0.7437 (0.7633) lr 1.8443e-03 eta 0:31:43
epoch [11/50] batch [40/319] time 0.082 (0.116) data 0.000 (0.031) loss 1.9259 (2.0255) ce_loss 0.9644 (1.0722) loss_zs_kd 0.6116 (0.6431) loss_oracle 1.1939 (1.2596) acc 65.6250 (59.1406) kd_loss 0.7810 (0.7630) lr 1.8443e-03 eta 0:24:34
epoch [11/50] batch [60/319] time 0.082 (0.105) data 0.001 (0.021) loss 2.0457 (2.0226) ce_loss 1.1357 (1.0742) loss_zs_kd 0.9569 (0.6722) loss_oracle 1.1638 (1.2467) acc 62.5000 (59.5312) kd_loss 0.6979 (0.7565) lr 1.8443e-03 eta 0:22:11
epoch [11/50] batch [80/319] time 0.084 (0.098) data 0.000 (0.016) loss 2.2419 (2.0370) ce_loss 1.3418 (1.0880) loss_zs_kd 0.7802 (0.6730) loss_oracle 1.3999 (1.2580) acc 53.1250 (59.0625) kd_loss 0.6821 (0.7558) lr 1.8443e-03 eta 0:20:45
epoch [11/50] batch [100/319] time 0.087 (0.095) data 0.001 (0.013) loss 1.8838 (2.0427) ce_loss 1.0107 (1.0989) loss_zs_kd 0.5272 (0.6635) loss_oracle 1.3563 (1.2699) acc 71.8750 (58.9688) kd_loss 0.6847 (0.7505) lr 1.8443e-03 eta 0:20:03
epoch [11/50] batch [120/319] time 0.090 (0.093) data 0.000 (0.011) loss 1.9263 (2.0392) ce_loss 1.0225 (1.0986) loss_zs_kd 0.6834 (0.6709) loss_oracle 1.1430 (1.2595) acc 62.5000 (58.9844) kd_loss 0.7212 (0.7476) lr 1.8443e-03 eta 0:19:39
epoch [11/50] batch [140/319] time 0.081 (0.092) data 0.000 (0.009) loss 2.3963 (2.0378) ce_loss 1.4229 (1.0990) loss_zs_kd 0.8103 (0.6745) loss_oracle 1.3160 (1.2583) acc 46.8750 (59.1518) kd_loss 0.7608 (0.7456) lr 1.8443e-03 eta 0:19:19
epoch [11/50] batch [160/319] time 0.080 (0.090) data 0.000 (0.008) loss 1.5683 (2.0390) ce_loss 0.6577 (1.1020) loss_zs_kd 0.6999 (0.6791) loss_oracle 1.1657 (1.2536) acc 78.1250 (58.9258) kd_loss 0.7241 (0.7437) lr 1.8443e-03 eta 0:18:58
epoch [11/50] batch [180/319] time 0.086 (0.089) data 0.000 (0.007) loss 2.0966 (2.0402) ce_loss 1.1133 (1.1010) loss_zs_kd 0.6707 (0.6783) loss_oracle 1.1259 (1.2526) acc 56.2500 (58.8021) kd_loss 0.8037 (0.7460) lr 1.8443e-03 eta 0:18:42
epoch [11/50] batch [200/319] time 0.081 (0.089) data 0.000 (0.006) loss 2.0530 (2.0356) ce_loss 1.1064 (1.0968) loss_zs_kd 0.7691 (0.6811) loss_oracle 1.2102 (1.2492) acc 59.3750 (58.9531) kd_loss 0.7486 (0.7457) lr 1.8443e-03 eta 0:18:34
epoch [11/50] batch [220/319] time 0.083 (0.088) data 0.000 (0.006) loss 2.0909 (2.0316) ce_loss 1.1846 (1.0918) loss_zs_kd 0.7223 (0.6779) loss_oracle 1.0410 (1.2473) acc 50.0000 (59.0767) kd_loss 0.7300 (0.7473) lr 1.8443e-03 eta 0:18:23
epoch [11/50] batch [240/319] time 0.060 (0.087) data 0.000 (0.005) loss 1.9659 (2.0258) ce_loss 1.0039 (1.0844) loss_zs_kd 0.5874 (0.6778) loss_oracle 1.3836 (1.2472) acc 62.5000 (59.2057) kd_loss 0.7649 (0.7490) lr 1.8443e-03 eta 0:18:09
epoch [11/50] batch [260/319] time 0.062 (0.086) data 0.000 (0.005) loss 1.9085 (2.0251) ce_loss 0.9897 (1.0832) loss_zs_kd 0.8700 (0.6828) loss_oracle 0.9468 (1.2421) acc 53.1250 (59.1707) kd_loss 0.7371 (0.7494) lr 1.8443e-03 eta 0:17:57
epoch [11/50] batch [280/319] time 0.063 (0.085) data 0.000 (0.005) loss 2.1122 (2.0216) ce_loss 1.1582 (1.0804) loss_zs_kd 0.6090 (0.6813) loss_oracle 1.2699 (1.2399) acc 53.1250 (59.2746) kd_loss 0.7661 (0.7491) lr 1.8443e-03 eta 0:17:35
epoch [11/50] batch [300/319] time 0.082 (0.086) data 0.000 (0.004) loss 2.5195 (2.0241) ce_loss 1.6611 (1.0846) loss_zs_kd 0.6571 (0.6799) loss_oracle 1.1787 (1.2355) acc 37.5000 (59.0208) kd_loss 0.6748 (0.7479) lr 1.8443e-03 eta 0:17:53
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,841
* accuracy: 64.9%
* error: 35.1%
* macro_f1: 54.8%
Checkpoint saved to icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,945
* accuracy: 50.8%
* error: 49.2%
* macro_f1: 21.0%
******* Domain 2 best val acc:      64.9%, epoch: 11 *******
******* Domain 2 best val test acc: 50.8%, epoch: 11 *******
******* Domain 2 best test acc:     55.2%, epoch: 4 *******
epoch [12/50] batch [20/319] time 0.101 (0.168) data 0.000 (0.062) loss 1.8433 (2.0314) ce_loss 0.9468 (1.0977) loss_zs_kd 0.5808 (0.6681) loss_oracle 1.1552 (1.1598) acc 68.7500 (59.3750) kd_loss 0.7229 (0.7510) lr 1.8090e-03 eta 0:34:41
epoch [12/50] batch [40/319] time 0.107 (0.135) data 0.000 (0.031) loss 1.9170 (2.0476) ce_loss 0.9082 (1.1006) loss_zs_kd 0.7389 (0.6576) loss_oracle 1.3793 (1.1659) acc 65.6250 (58.3594) kd_loss 0.7970 (0.7647) lr 1.8090e-03 eta 0:27:50
epoch [12/50] batch [60/319] time 0.115 (0.125) data 0.000 (0.021) loss 2.1540 (2.0679) ce_loss 1.1777 (1.1140) loss_zs_kd 0.6526 (0.6769) loss_oracle 1.2379 (1.1711) acc 59.3750 (58.0208) kd_loss 0.7873 (0.7691) lr 1.8090e-03 eta 0:25:46
epoch [12/50] batch [80/319] time 0.102 (0.119) data 0.000 (0.016) loss 1.9320 (2.0663) ce_loss 0.9072 (1.1054) loss_zs_kd 0.5856 (0.6827) loss_oracle 1.3213 (1.1837) acc 65.6250 (58.3594) kd_loss 0.8341 (0.7743) lr 1.8090e-03 eta 0:24:37
epoch [12/50] batch [100/319] time 0.114 (0.116) data 0.000 (0.013) loss 2.0981 (2.0756) ce_loss 1.1377 (1.1141) loss_zs_kd 0.8090 (0.6712) loss_oracle 1.0682 (1.1841) acc 59.3750 (58.2188) kd_loss 0.7727 (0.7760) lr 1.8090e-03 eta 0:23:55
epoch [12/50] batch [120/319] time 0.087 (0.114) data 0.000 (0.011) loss 2.0673 (2.0784) ce_loss 1.0801 (1.1170) loss_zs_kd 0.6188 (0.6680) loss_oracle 1.0347 (1.1825) acc 59.3750 (58.1510) kd_loss 0.8219 (0.7763) lr 1.8090e-03 eta 0:23:26
epoch [12/50] batch [140/319] time 0.110 (0.113) data 0.000 (0.009) loss 2.1465 (2.0638) ce_loss 1.1406 (1.1031) loss_zs_kd 0.6899 (0.6699) loss_oracle 1.2527 (1.1845) acc 71.8750 (59.0402) kd_loss 0.8116 (0.7753) lr 1.8090e-03 eta 0:23:06
epoch [12/50] batch [160/319] time 0.106 (0.112) data 0.000 (0.008) loss 2.0952 (2.0564) ce_loss 1.1504 (1.0974) loss_zs_kd 0.7565 (0.6692) loss_oracle 1.1552 (1.1893) acc 56.2500 (59.2969) kd_loss 0.7536 (0.7732) lr 1.8090e-03 eta 0:22:52
epoch [12/50] batch [180/319] time 0.106 (0.111) data 0.000 (0.007) loss 2.0248 (2.0549) ce_loss 1.0195 (1.0950) loss_zs_kd 0.6203 (0.6723) loss_oracle 1.1699 (1.1936) acc 68.7500 (59.4965) kd_loss 0.8262 (0.7734) lr 1.8090e-03 eta 0:22:40
epoch [12/50] batch [200/319] time 0.107 (0.111) data 0.000 (0.006) loss 2.1183 (2.0506) ce_loss 1.1699 (1.0913) loss_zs_kd 0.6886 (0.6686) loss_oracle 1.1684 (1.1949) acc 46.8750 (59.5312) kd_loss 0.7626 (0.7729) lr 1.8090e-03 eta 0:22:34
epoch [12/50] batch [220/319] time 0.111 (0.110) data 0.000 (0.006) loss 1.7396 (2.0448) ce_loss 0.8525 (1.0862) loss_zs_kd 0.6067 (0.6804) loss_oracle 0.9841 (1.1959) acc 65.6250 (59.5455) kd_loss 0.7279 (0.7710) lr 1.8090e-03 eta 0:22:23
epoch [12/50] batch [240/319] time 0.102 (0.109) data 0.000 (0.005) loss 2.0892 (2.0451) ce_loss 1.0488 (1.0871) loss_zs_kd 0.7607 (0.6808) loss_oracle 1.2231 (1.1962) acc 56.2500 (59.5703) kd_loss 0.8420 (0.7703) lr 1.8090e-03 eta 0:22:14
epoch [12/50] batch [260/319] time 0.114 (0.109) data 0.000 (0.005) loss 1.9457 (2.0378) ce_loss 1.0195 (1.0805) loss_zs_kd 0.6002 (0.6773) loss_oracle 1.1841 (1.1995) acc 68.7500 (59.8678) kd_loss 0.7478 (0.7696) lr 1.8090e-03 eta 0:22:07
epoch [12/50] batch [280/319] time 0.081 (0.108) data 0.000 (0.005) loss 1.8037 (2.0373) ce_loss 0.7876 (1.0805) loss_zs_kd 0.6605 (0.6767) loss_oracle 1.2180 (1.2033) acc 65.6250 (59.8214) kd_loss 0.8283 (0.7688) lr 1.8090e-03 eta 0:21:54
epoch [12/50] batch [300/319] time 0.062 (0.106) data 0.000 (0.004) loss 2.1542 (2.0334) ce_loss 1.1885 (1.0773) loss_zs_kd 0.6313 (0.6752) loss_oracle 1.2999 (1.2058) acc 43.7500 (59.7500) kd_loss 0.7726 (0.7680) lr 1.8090e-03 eta 0:21:29
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,861
* accuracy: 65.3%
* error: 34.7%
* macro_f1: 56.3%
Checkpoint saved to icml/multi-dg/tuning/02_zs0.1_oracle0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,962
* accuracy: 51.0%
* error: 49.0%
* macro_f1: 23.3%
******* Domain 2 best val acc:      65.3%, epoch: 12 *******
******* Domain 2 best val test acc: 51.0%, epoch: 12 *******
******* Domain 2 best test acc:     55.2%, epoch: 4 *******
epoch [13/50] batch [20/319] time 0.102 (0.168) data 0.000 (0.067) loss 2.0585 (2.0570) ce_loss 1.1045 (1.1176) loss_zs_kd 0.8108 (0.7460) loss_oracle 1.2779 (1.2588) acc 53.1250 (59.5312) kd_loss 0.7451 (0.7389) lr 1.7705e-03 eta 0:33:50
epoch [13/50] batch [40/319] time 0.118 (0.136) data 0.000 (0.033) loss 2.2972 (2.0040) ce_loss 1.4316 (1.0653) loss_zs_kd 0.6614 (0.7038) loss_oracle 1.1363 (1.2748) acc 50.0000 (60.0000) kd_loss 0.6858 (0.7409) lr 1.7705e-03 eta 0:27:26
epoch [13/50] batch [60/319] time 0.094 (0.126) data 0.000 (0.022) loss 2.3519 (2.0222) ce_loss 1.4463 (1.0844) loss_zs_kd 0.6904 (0.6883) loss_oracle 1.2365 (1.2749) acc 59.3750 (59.6875) kd_loss 0.7129 (0.7415) lr 1.7705e-03 eta 0:25:15
epoch [13/50] batch [80/319] time 0.102 (0.120) data 0.000 (0.017) loss 1.7529 (2.0334) ce_loss 0.8169 (1.0920) loss_zs_kd 0.5767 (0.6883) loss_oracle 1.4050 (1.2753) acc 75.0000 (59.2578) kd_loss 0.7379 (0.7451) lr 1.7705e-03 eta 0:24:08
epoch [13/50] batch [100/319] time 0.096 (0.117) data 0.000 (0.014) loss 2.0810 (2.0265) ce_loss 1.1377 (1.0883) loss_zs_kd 0.6560 (0.6886) loss_oracle 1.3850 (1.2801) acc 50.0000 (59.2812) kd_loss 0.7392 (0.7413) lr 1.7705e-03 eta 0:23:27
epoch [13/50] batch [120/319] time 0.100 (0.115) data 0.000 (0.011) loss 2.0272 (2.0232) ce_loss 1.0781 (1.0818) loss_zs_kd 0.5883 (0.6977) loss_oracle 1.2270 (1.2754) acc 56.2500 (59.5573) kd_loss 0.7676 (0.7441) lr 1.7705e-03 eta 0:22:57
epoch [13/50] batch [140/319] time 0.105 (0.113) data 0.000 (0.010) loss 2.3366 (2.0255) ce_loss 1.4668 (1.0842) loss_zs_kd 0.7871 (0.6923) loss_oracle 1.1505 (1.2697) acc 46.8750 (59.6652) kd_loss 0.6761 (0.7452) lr 1.7705e-03 eta 0:22:39
epoch [13/50] batch [160/319] time 0.096 (0.112) data 0.000 (0.009) loss 2.1391 (2.0227) ce_loss 1.2070 (1.0818) loss_zs_kd 0.6788 (0.6883) loss_oracle 1.2256 (1.2697) acc 59.3750 (59.8242) kd_loss 0.7416 (0.7451) lr 1.7705e-03 eta 0:22:24
epoch [13/50] batch [180/319] time 0.114 (0.111) data 0.000 (0.008) loss 1.9102 (2.0272) ce_loss 1.0020 (1.0882) loss_zs_kd 0.6857 (0.6896) loss_oracle 1.1317 (1.2684) acc 65.6250 (59.8611) kd_loss 0.7265 (0.7433) lr 1.7705e-03 eta 0:22:05
epoch [13/50] batch [200/319] time 0.103 (0.110) data 0.000 (0.007) loss 2.1111 (2.0264) ce_loss 1.2031 (1.0914) loss_zs_kd 0.6234 (0.6883) loss_oracle 1.2932 (1.2607) acc 65.6250 (59.7969) kd_loss 0.7163 (0.7401) lr 1.7705e-03 eta 0:21:55
epoch [13/50] batch [220/319] time 0.104 (0.110) data 0.000 (0.006) loss 2.1616 (2.0213) ce_loss 1.2109 (1.0873) loss_zs_kd 0.7963 (0.6894) loss_oracle 1.1032 (1.2560) acc 56.2500 (59.9148) kd_loss 0.7607 (0.7395) lr 1.7705e-03 eta 0:21:45
epoch [13/50] batch [240/319] time 0.105 (0.109) data 0.000 (0.006) loss 1.7763 (2.0198) ce_loss 0.8872 (1.0875) loss_zs_kd 0.6243 (0.6926) loss_oracle 1.1874 (1.2479) acc 71.8750 (59.7917) kd_loss 0.7079 (0.7382) lr 1.7705e-03 eta 0:21:38
epoch [13/50] batch [260/319] time 0.102 (0.109) data 0.000 (0.005) loss 2.0150 (2.0199) ce_loss 1.1074 (1.0878) loss_zs_kd 0.6810 (0.6933) loss_oracle 1.2209 (1.2440) acc 56.2500 (59.6154) kd_loss 0.7174 (0.7383) lr 1.7705e-03 eta 0:21:31
epoch [13/50] batch [280/319] time 0.099 (0.109) data 0.000 (0.005) loss 1.9839 (2.0168) ce_loss 1.0957 (1.0869) loss_zs_kd 0.7396 (0.6879) loss_oracle 1.1651 (1.2406) acc 62.5000 (59.6763) kd_loss 0.6977 (0.7370) lr 1.7705e-03 eta 0:21:24
epoch [13/50] batch [300/319] time 0.099 (0.108) data 0.000 (0.005) loss 1.9786 (2.0129) ce_loss 1.0566 (1.0844) loss_zs_kd 0.7151 (0.6864) loss_oracle 1.3420 (1.2388) acc 59.3750 (59.7500) kd_loss 0.7162 (0.7360) lr 1.7705e-03 eta 0:21:19
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,851
* accuracy: 65.1%
* error: 34.9%
* macro_f1: 55.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,013
* accuracy: 51.5%
* error: 48.5%
* macro_f1: 22.8%
******* Domain 2 best val acc:      65.3%, epoch: 12 *******
******* Domain 2 best val test acc: 51.0%, epoch: 12 *******
******* Domain 2 best test acc:     55.2%, epoch: 4 *******
epoch [14/50] batch [20/319] time 0.090 (0.148) data 0.000 (0.056) loss 1.7881 (2.0074) ce_loss 0.9014 (1.0898) loss_zs_kd 0.8809 (0.6578) loss_oracle 1.0780 (1.2002) acc 75.0000 (59.5312) kd_loss 0.6908 (0.7319) lr 1.7290e-03 eta 0:29:08
epoch [14/50] batch [40/319] time 0.104 (0.124) data 0.000 (0.028) loss 1.9938 (1.9811) ce_loss 1.0439 (1.0706) loss_zs_kd 0.6323 (0.6983) loss_oracle 1.1381 (1.1752) acc 56.2500 (61.0938) kd_loss 0.7728 (0.7231) lr 1.7290e-03 eta 0:24:14
epoch [14/50] batch [60/319] time 0.109 (0.117) data 0.000 (0.019) loss 1.9807 (1.9864) ce_loss 0.9985 (1.0751) loss_zs_kd 0.9069 (0.6970) loss_oracle 1.1232 (1.1878) acc 65.6250 (60.9375) kd_loss 0.7792 (0.7228) lr 1.7290e-03 eta 0:22:58
epoch [14/50] batch [80/319] time 0.110 (0.114) data 0.000 (0.014) loss 2.1207 (1.9874) ce_loss 1.2432 (1.0758) loss_zs_kd 0.7271 (0.6906) loss_oracle 1.1608 (1.1969) acc 56.2500 (60.3516) kd_loss 0.6888 (0.7229) lr 1.7290e-03 eta 0:22:14
epoch [14/50] batch [100/319] time 0.107 (0.112) data 0.000 (0.011) loss 1.6723 (1.9902) ce_loss 0.8354 (1.0808) loss_zs_kd 0.7044 (0.6994) loss_oracle 1.1234 (1.1783) acc 75.0000 (59.7812) kd_loss 0.6541 (0.7216) lr 1.7290e-03 eta 0:21:47
epoch [14/50] batch [120/319] time 0.109 (0.110) data 0.000 (0.010) loss 1.9043 (1.9918) ce_loss 0.9785 (1.0789) loss_zs_kd 0.7141 (0.7018) loss_oracle 1.2118 (1.1792) acc 71.8750 (60.0260) kd_loss 0.7332 (0.7248) lr 1.7290e-03 eta 0:21:29
epoch [14/50] batch [140/319] time 0.111 (0.109) data 0.000 (0.008) loss 2.1560 (1.9915) ce_loss 1.3486 (1.0811) loss_zs_kd 0.6742 (0.6980) loss_oracle 1.1467 (1.1769) acc 56.2500 (59.4420) kd_loss 0.6253 (0.7229) lr 1.7290e-03 eta 0:21:13
epoch [14/50] batch [160/319] time 0.114 (0.108) data 0.000 (0.007) loss 2.0976 (2.0018) ce_loss 1.1523 (1.0883) loss_zs_kd 0.6559 (0.6956) loss_oracle 1.1367 (1.1739) acc 56.2500 (59.0820) kd_loss 0.7660 (0.7265) lr 1.7290e-03 eta 0:21:00
epoch [14/50] batch [180/319] time 0.105 (0.108) data 0.000 (0.006) loss 1.9026 (1.9955) ce_loss 0.9771 (1.0826) loss_zs_kd 0.6634 (0.6984) loss_oracle 1.1039 (1.1634) acc 59.3750 (59.4271) kd_loss 0.7488 (0.7267) lr 1.7290e-03 eta 0:20:52
epoch [14/50] batch [200/319] time 0.110 (0.107) data 0.000 (0.006) loss 1.8129 (1.9904) ce_loss 0.9536 (1.0770) loss_zs_kd 0.8266 (0.6986) loss_oracle 1.2621 (1.1661) acc 65.6250 (59.7500) kd_loss 0.6504 (0.7270) lr 1.7290e-03 eta 0:20:45
epoch [14/50] batch [220/319] time 0.099 (0.107) data 0.000 (0.005) loss 1.9579 (1.9926) ce_loss 0.9795 (1.0789) loss_zs_kd 0.6872 (0.6953) loss_oracle 1.2594 (1.1700) acc 62.5000 (59.5455) kd_loss 0.7838 (0.7271) lr 1.7290e-03 eta 0:20:39
epoch [14/50] batch [240/319] time 0.104 (0.107) data 0.000 (0.005) loss 2.0255 (1.9923) ce_loss 1.0713 (1.0765) loss_zs_kd 0.7218 (0.6912) loss_oracle 1.1322 (1.1688) acc 71.8750 (59.6094) kd_loss 0.7689 (0.7298) lr 1.7290e-03 eta 0:20:34
epoch [14/50] batch [260/319] time 0.101 (0.107) data 0.000 (0.005) loss 1.8051 (1.9922) ce_loss 0.9194 (1.0748) loss_zs_kd 0.6617 (0.6905) loss_oracle 1.2040 (1.1648) acc 68.7500 (59.7115) kd_loss 0.6991 (0.7318) lr 1.7290e-03 eta 0:20:30
epoch [14/50] batch [280/319] time 0.098 (0.106) data 0.000 (0.004) loss 1.9932 (1.9894) ce_loss 1.0537 (1.0723) loss_zs_kd 0.6395 (0.6928) loss_oracle 1.1757 (1.1599) acc 53.1250 (59.9888) kd_loss 0.7579 (0.7318) lr 1.7290e-03 eta 0:20:26
epoch [14/50] batch [300/319] time 0.108 (0.106) data 0.000 (0.004) loss 2.0544 (1.9898) ce_loss 1.1475 (1.0726) loss_zs_kd 0.6990 (0.6912) loss_oracle 1.0926 (1.1570) acc 53.1250 (60.0521) kd_loss 0.7278 (0.7324) lr 1.7290e-03 eta 0:20:21
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,776
* accuracy: 63.4%
* error: 36.6%
* macro_f1: 55.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,063
* accuracy: 52.0%
* error: 48.0%
* macro_f1: 22.0%
******* Domain 2 best val acc:      65.3%, epoch: 12 *******
******* Domain 2 best val test acc: 51.0%, epoch: 12 *******
******* Domain 2 best test acc:     55.2%, epoch: 4 *******
epoch [15/50] batch [20/319] time 0.078 (0.180) data 0.000 (0.082) loss 2.3385 (2.0047) ce_loss 1.3770 (1.1031) loss_zs_kd 0.6396 (0.6753) loss_oracle 1.2604 (1.1886) acc 53.1250 (59.8438) kd_loss 0.7715 (0.7152) lr 1.6845e-03 eta 0:34:24
epoch [15/50] batch [40/319] time 0.092 (0.133) data 0.000 (0.041) loss 1.8418 (1.9717) ce_loss 0.9106 (1.0711) loss_zs_kd 0.6197 (0.7056) loss_oracle 1.1635 (1.1739) acc 59.3750 (60.3125) kd_loss 0.7528 (0.7127) lr 1.6845e-03 eta 0:25:25
