Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_100', 'location_43', 'location_46']
Target     ['location_38']
# classes  10
# train_x  10,216
# val      4,378
# test     9,736
---------  ----------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/319] time 0.071 (0.134) data 0.000 (0.036) loss 1.2561 (2.0206) ce_loss 1.2539 (2.0161) loss_zs_kd 0.0002 (0.0001) loss_oracle 0.0029 (0.0023) acc 59.3750 (37.0312) kd_loss 0.0007 (0.0033) lr 1.0000e-05 eta 0:35:33
epoch [1/50] batch [40/319] time 0.087 (0.108) data 0.000 (0.018) loss 1.5760 (1.9162) ce_loss 1.5732 (1.9125) loss_zs_kd 0.0016 (0.0003) loss_oracle 0.0015 (0.0024) acc 56.2500 (39.7656) kd_loss 0.0020 (0.0026) lr 1.0000e-05 eta 0:28:42
epoch [1/50] batch [60/319] time 0.075 (0.099) data 0.000 (0.012) loss 2.1743 (1.9440) ce_loss 2.1719 (1.9406) loss_zs_kd 0.0025 (0.0007) loss_oracle 0.0030 (0.0024) acc 31.2500 (39.1667) kd_loss 0.0009 (0.0022) lr 1.0000e-05 eta 0:26:13
epoch [1/50] batch [80/319] time 0.086 (0.093) data 0.000 (0.009) loss 1.9763 (1.9252) ce_loss 1.9736 (1.9220) loss_zs_kd 0.0039 (0.0014) loss_oracle 0.0028 (0.0026) acc 43.7500 (38.7891) kd_loss 0.0013 (0.0019) lr 1.0000e-05 eta 0:24:41
epoch [1/50] batch [100/319] time 0.087 (0.091) data 0.000 (0.007) loss 2.1720 (1.8865) ce_loss 2.1699 (1.8833) loss_zs_kd 0.0075 (0.0024) loss_oracle 0.0015 (0.0027) acc 25.0000 (39.3438) kd_loss 0.0013 (0.0018) lr 1.0000e-05 eta 0:24:08
epoch [1/50] batch [120/319] time 0.078 (0.089) data 0.000 (0.006) loss 1.8730 (1.8844) ce_loss 1.8691 (1.8812) loss_zs_kd 0.0060 (0.0033) loss_oracle 0.0031 (0.0028) acc 40.6250 (39.5312) kd_loss 0.0023 (0.0018) lr 1.0000e-05 eta 0:23:28
epoch [1/50] batch [140/319] time 0.084 (0.087) data 0.000 (0.005) loss 2.0556 (1.8843) ce_loss 2.0508 (1.8810) loss_zs_kd 0.0103 (0.0043) loss_oracle 0.0027 (0.0028) acc 37.5000 (39.4866) kd_loss 0.0035 (0.0019) lr 1.0000e-05 eta 0:23:00
epoch [1/50] batch [160/319] time 0.081 (0.086) data 0.000 (0.005) loss 1.8308 (1.8806) ce_loss 1.8262 (1.8770) loss_zs_kd 0.0141 (0.0056) loss_oracle 0.0046 (0.0030) acc 34.3750 (39.6289) kd_loss 0.0024 (0.0021) lr 1.0000e-05 eta 0:22:44
epoch [1/50] batch [180/319] time 0.087 (0.086) data 0.000 (0.004) loss 2.1828 (1.8774) ce_loss 2.1758 (1.8737) loss_zs_kd 0.0232 (0.0071) loss_oracle 0.0071 (0.0031) acc 28.1250 (39.5833) kd_loss 0.0034 (0.0021) lr 1.0000e-05 eta 0:22:35
epoch [1/50] batch [200/319] time 0.082 (0.086) data 0.000 (0.004) loss 2.0025 (1.8731) ce_loss 1.9961 (1.8692) loss_zs_kd 0.0239 (0.0086) loss_oracle 0.0029 (0.0034) acc 31.2500 (39.5312) kd_loss 0.0050 (0.0023) lr 1.0000e-05 eta 0:22:30
epoch [1/50] batch [220/319] time 0.082 (0.086) data 0.000 (0.004) loss 1.7273 (1.8793) ce_loss 1.7188 (1.8750) loss_zs_kd 0.0307 (0.0104) loss_oracle 0.0041 (0.0035) acc 50.0000 (39.1477) kd_loss 0.0065 (0.0026) lr 1.0000e-05 eta 0:22:27
epoch [1/50] batch [240/319] time 0.082 (0.086) data 0.000 (0.003) loss 1.9448 (1.8864) ce_loss 1.9336 (1.8815) loss_zs_kd 0.0429 (0.0123) loss_oracle 0.0073 (0.0038) acc 28.1250 (38.8411) kd_loss 0.0075 (0.0030) lr 1.0000e-05 eta 0:22:24
epoch [1/50] batch [260/319] time 0.078 (0.085) data 0.001 (0.003) loss 1.9877 (1.8844) ce_loss 1.9756 (1.8788) loss_zs_kd 0.0391 (0.0142) loss_oracle 0.0130 (0.0042) acc 40.6250 (38.7740) kd_loss 0.0056 (0.0034) lr 1.0000e-05 eta 0:22:16
epoch [1/50] batch [280/319] time 0.081 (0.085) data 0.000 (0.003) loss 2.0867 (1.8813) ce_loss 2.0684 (1.8750) loss_zs_kd 0.0573 (0.0164) loss_oracle 0.0145 (0.0049) acc 31.2500 (38.7946) kd_loss 0.0111 (0.0039) lr 1.0000e-05 eta 0:22:10
epoch [1/50] batch [300/319] time 0.089 (0.085) data 0.000 (0.003) loss 2.3020 (1.8782) ce_loss 2.2793 (1.8707) loss_zs_kd 0.0567 (0.0188) loss_oracle 0.0289 (0.0058) acc 31.2500 (38.7812) kd_loss 0.0083 (0.0045) lr 1.0000e-05 eta 0:22:09
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 1,772
* accuracy: 40.5%
* error: 59.5%
* macro_f1: 26.1%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,172
* accuracy: 32.6%
* error: 67.4%
* macro_f1: 12.1%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      40.5%, epoch: 1 *******
******* Domain 2 best val test acc: 32.6%, epoch: 1 *******
******* Domain 2 best test acc:     32.6%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/ana
epoch [2/50] batch [20/319] time 0.082 (0.123) data 0.000 (0.036) loss 2.5942 (2.1024) ce_loss 1.6758 (1.6299) loss_zs_kd 0.4971 (0.2790) loss_oracle 1.0063 (0.6531) acc 40.6250 (39.6875) kd_loss 0.4152 (0.1459) lr 2.0000e-03 eta 0:31:53
epoch [2/50] batch [40/319] time 0.097 (0.103) data 0.000 (0.018) loss 3.2966 (2.4622) ce_loss 1.9648 (1.5946) loss_zs_kd 0.5811 (0.4541) loss_oracle 1.1025 (0.8522) acc 28.1250 (41.5625) kd_loss 0.7805 (0.4415) lr 2.0000e-03 eta 0:26:44
epoch [2/50] batch [60/319] time 0.087 (0.096) data 0.001 (0.012) loss 3.0094 (2.6193) ce_loss 1.4600 (1.5531) loss_zs_kd 0.6872 (0.5225) loss_oracle 1.0830 (0.9337) acc 34.3750 (42.9167) kd_loss 1.0079 (0.5993) lr 2.0000e-03 eta 0:24:51
epoch [2/50] batch [80/319] time 0.086 (0.093) data 0.000 (0.009) loss 2.9050 (2.6745) ce_loss 1.4111 (1.5095) loss_zs_kd 0.7076 (0.5589) loss_oracle 1.0894 (0.9740) acc 43.7500 (44.4531) kd_loss 0.9491 (0.6781) lr 2.0000e-03 eta 0:24:00
epoch [2/50] batch [100/319] time 0.087 (0.091) data 0.000 (0.007) loss 2.7675 (2.7029) ce_loss 1.3623 (1.4822) loss_zs_kd 0.8291 (0.6082) loss_oracle 1.0875 (0.9971) acc 50.0000 (45.1562) kd_loss 0.8614 (0.7221) lr 2.0000e-03 eta 0:23:27
epoch [2/50] batch [120/319] time 0.086 (0.089) data 0.000 (0.006) loss 2.5143 (2.7086) ce_loss 1.0469 (1.4526) loss_zs_kd 0.9859 (0.6732) loss_oracle 1.0978 (1.0112) acc 75.0000 (46.3542) kd_loss 0.9185 (0.7504) lr 2.0000e-03 eta 0:22:53
epoch [2/50] batch [140/319] time 0.081 (0.088) data 0.000 (0.005) loss 2.9191 (2.7200) ce_loss 1.5596 (1.4384) loss_zs_kd 0.8008 (0.7149) loss_oracle 1.0612 (1.0197) acc 34.3750 (47.0089) kd_loss 0.8289 (0.7717) lr 2.0000e-03 eta 0:22:41
epoch [2/50] batch [160/319] time 0.080 (0.088) data 0.000 (0.005) loss 2.7192 (2.7277) ce_loss 1.2490 (1.4238) loss_zs_kd 0.7638 (0.7344) loss_oracle 1.0865 (1.0273) acc 56.2500 (47.4609) kd_loss 0.9269 (0.7903) lr 2.0000e-03 eta 0:22:35
epoch [2/50] batch [180/319] time 0.073 (0.087) data 0.000 (0.004) loss 3.0827 (2.7377) ce_loss 1.6006 (1.4174) loss_zs_kd 1.0422 (0.7507) loss_oracle 1.1312 (1.0332) acc 43.7500 (47.9688) kd_loss 0.9165 (0.8037) lr 2.0000e-03 eta 0:22:22
epoch [2/50] batch [200/319] time 0.079 (0.087) data 0.000 (0.004) loss 2.7425 (2.7428) ce_loss 1.2783 (1.4089) loss_zs_kd 0.8340 (0.7638) loss_oracle 1.0472 (1.0365) acc 50.0000 (48.1562) kd_loss 0.9406 (0.8156) lr 2.0000e-03 eta 0:22:17
epoch [2/50] batch [220/319] time 0.094 (0.086) data 0.000 (0.004) loss 2.8314 (2.7470) ce_loss 1.4141 (1.4001) loss_zs_kd 0.9395 (0.7847) loss_oracle 1.0265 (1.0390) acc 50.0000 (48.2670) kd_loss 0.9041 (0.8274) lr 2.0000e-03 eta 0:22:10
epoch [2/50] batch [240/319] time 0.089 (0.086) data 0.000 (0.003) loss 2.5703 (2.7473) ce_loss 1.0420 (1.3878) loss_zs_kd 0.9812 (0.8071) loss_oracle 1.0914 (1.0433) acc 50.0000 (48.6068) kd_loss 0.9826 (0.8378) lr 2.0000e-03 eta 0:22:03
epoch [2/50] batch [260/319] time 0.076 (0.086) data 0.000 (0.003) loss 2.7462 (2.7424) ce_loss 1.1953 (1.3712) loss_zs_kd 0.9151 (0.8210) loss_oracle 1.1227 (1.0483) acc 56.2500 (49.1106) kd_loss 0.9896 (0.8470) lr 2.0000e-03 eta 0:21:57
epoch [2/50] batch [280/319] time 0.077 (0.085) data 0.000 (0.003) loss 2.6821 (2.7424) ce_loss 1.1865 (1.3646) loss_zs_kd 0.8595 (0.8364) loss_oracle 1.1009 (1.0515) acc 46.8750 (49.2634) kd_loss 0.9451 (0.8521) lr 2.0000e-03 eta 0:21:52
epoch [2/50] batch [300/319] time 0.082 (0.085) data 0.000 (0.003) loss 2.6372 (2.7460) ce_loss 1.1797 (1.3618) loss_zs_kd 0.9820 (0.8534) loss_oracle 1.1010 (1.0543) acc 56.2500 (49.3333) kd_loss 0.9070 (0.8570) lr 2.0000e-03 eta 0:21:47
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,422
* accuracy: 55.3%
* error: 44.7%
* macro_f1: 45.6%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,591
* accuracy: 47.2%
* error: 52.8%
* macro_f1: 24.7%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      55.3%, epoch: 2 *******
******* Domain 2 best val test acc: 47.2%, epoch: 2 *******
******* Domain 2 best test acc:     47.2%, epoch: 2 *******
epoch [3/50] batch [20/319] time 0.080 (0.108) data 0.000 (0.032) loss 2.6038 (2.6681) ce_loss 1.0605 (1.1741) loss_zs_kd 0.9183 (1.1211) loss_oracle 1.1173 (1.1006) acc 53.1250 (55.9375) kd_loss 0.9846 (0.9436) lr 1.9980e-03 eta 0:27:37
epoch [3/50] batch [40/319] time 0.088 (0.095) data 0.000 (0.016) loss 2.6428 (2.6781) ce_loss 1.1289 (1.1883) loss_zs_kd 1.1043 (1.1203) loss_oracle 1.1353 (1.1060) acc 75.0000 (54.7656) kd_loss 0.9463 (0.9368) lr 1.9980e-03 eta 0:24:17
epoch [3/50] batch [60/319] time 0.075 (0.093) data 0.000 (0.011) loss 2.4395 (2.6821) ce_loss 0.9263 (1.1945) loss_zs_kd 1.0523 (1.1219) loss_oracle 1.1069 (1.1056) acc 62.5000 (55.1042) kd_loss 0.9598 (0.9348) lr 1.9980e-03 eta 0:23:39
epoch [3/50] batch [80/319] time 0.096 (0.091) data 0.000 (0.008) loss 2.5746 (2.6991) ce_loss 1.0264 (1.2089) loss_zs_kd 1.0297 (1.1267) loss_oracle 1.0920 (1.1091) acc 62.5000 (54.5703) kd_loss 1.0022 (0.9357) lr 1.9980e-03 eta 0:23:04
epoch [3/50] batch [100/319] time 0.091 (0.090) data 0.000 (0.007) loss 2.7876 (2.6996) ce_loss 1.2715 (1.2151) loss_zs_kd 1.3820 (1.1408) loss_oracle 1.1329 (1.1078) acc 43.7500 (54.6250) kd_loss 0.9497 (0.9306) lr 1.9980e-03 eta 0:22:48
epoch [3/50] batch [120/319] time 0.078 (0.089) data 0.000 (0.006) loss 3.0248 (2.7045) ce_loss 1.5029 (1.2184) loss_zs_kd 1.2318 (1.1418) loss_oracle 1.1549 (1.1102) acc 31.2500 (54.4531) kd_loss 0.9444 (0.9310) lr 1.9980e-03 eta 0:22:28
epoch [3/50] batch [140/319] time 0.074 (0.088) data 0.000 (0.005) loss 2.5350 (2.7027) ce_loss 1.0059 (1.2140) loss_zs_kd 1.1114 (1.1373) loss_oracle 1.1133 (1.1128) acc 68.7500 (54.1964) kd_loss 0.9725 (0.9323) lr 1.9980e-03 eta 0:22:07
epoch [3/50] batch [160/319] time 0.074 (0.086) data 0.000 (0.004) loss 2.6069 (2.7020) ce_loss 1.0107 (1.2123) loss_zs_kd 1.3085 (1.1504) loss_oracle 1.1659 (1.1161) acc 62.5000 (54.1797) kd_loss 1.0132 (0.9317) lr 1.9980e-03 eta 0:21:38
epoch [3/50] batch [180/319] time 0.076 (0.085) data 0.000 (0.004) loss 2.7356 (2.7042) ce_loss 1.2559 (1.2124) loss_zs_kd 1.3520 (1.1819) loss_oracle 1.1457 (1.1188) acc 46.8750 (54.1146) kd_loss 0.9069 (0.9324) lr 1.9980e-03 eta 0:21:33
epoch [3/50] batch [200/319] time 0.077 (0.085) data 0.000 (0.003) loss 2.7085 (2.6994) ce_loss 1.2578 (1.2090) loss_zs_kd 1.3543 (1.1881) loss_oracle 1.0832 (1.1205) acc 37.5000 (54.1719) kd_loss 0.9091 (0.9301) lr 1.9980e-03 eta 0:21:29
epoch [3/50] batch [220/319] time 0.074 (0.085) data 0.000 (0.003) loss 2.7125 (2.7026) ce_loss 1.1367 (1.2097) loss_zs_kd 1.0493 (1.1897) loss_oracle 1.1318 (1.1223) acc 50.0000 (54.2188) kd_loss 1.0098 (0.9318) lr 1.9980e-03 eta 0:21:18
epoch [3/50] batch [240/319] time 0.078 (0.084) data 0.000 (0.003) loss 2.9337 (2.7013) ce_loss 1.4971 (1.2070) loss_zs_kd 1.4068 (1.1892) loss_oracle 1.1186 (1.1244) acc 43.7500 (54.4661) kd_loss 0.8773 (0.9321) lr 1.9980e-03 eta 0:21:13
epoch [3/50] batch [260/319] time 0.088 (0.084) data 0.000 (0.003) loss 2.7796 (2.7025) ce_loss 1.2529 (1.2089) loss_zs_kd 1.0674 (1.1939) loss_oracle 1.0673 (1.1253) acc 53.1250 (54.4471) kd_loss 0.9931 (0.9309) lr 1.9980e-03 eta 0:21:11
epoch [3/50] batch [280/319] time 0.081 (0.084) data 0.000 (0.003) loss 2.6280 (2.7021) ce_loss 1.1445 (1.2075) loss_zs_kd 0.9796 (1.1901) loss_oracle 1.1650 (1.1269) acc 68.7500 (54.5201) kd_loss 0.9010 (0.9311) lr 1.9980e-03 eta 0:21:09
epoch [3/50] batch [300/319] time 0.083 (0.084) data 0.000 (0.002) loss 2.5485 (2.7032) ce_loss 0.9224 (1.2067) loss_zs_kd 1.1357 (1.1918) loss_oracle 1.1777 (1.1285) acc 68.7500 (54.6875) kd_loss 1.0372 (0.9322) lr 1.9980e-03 eta 0:21:07
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,531
* accuracy: 57.8%
* error: 42.2%
* macro_f1: 47.5%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,552
* accuracy: 46.8%
* error: 53.2%
* macro_f1: 22.5%
******* Domain 2 best val acc:      57.8%, epoch: 3 *******
******* Domain 2 best val test acc: 46.8%, epoch: 3 *******
******* Domain 2 best test acc:     47.2%, epoch: 2 *******
epoch [4/50] batch [20/319] time 0.088 (0.121) data 0.000 (0.045) loss 2.7657 (2.6856) ce_loss 1.2627 (1.1928) loss_zs_kd 1.2152 (1.2559) loss_oracle 1.0629 (1.1408) acc 46.8750 (52.6562) kd_loss 0.9716 (0.9223) lr 1.9921e-03 eta 0:30:06
epoch [4/50] batch [40/319] time 0.072 (0.101) data 0.000 (0.023) loss 2.7317 (2.7023) ce_loss 1.1289 (1.1925) loss_zs_kd 1.1438 (1.2440) loss_oracle 1.1612 (1.1460) acc 46.8750 (52.3438) kd_loss 1.0222 (0.9368) lr 1.9921e-03 eta 0:25:16
epoch [4/50] batch [60/319] time 0.082 (0.094) data 0.000 (0.015) loss 2.9853 (2.6879) ce_loss 1.4229 (1.1741) loss_zs_kd 1.3119 (1.2271) loss_oracle 1.1539 (1.1470) acc 40.6250 (54.0104) kd_loss 0.9855 (0.9404) lr 1.9921e-03 eta 0:23:16
epoch [4/50] batch [80/319] time 0.075 (0.090) data 0.000 (0.011) loss 2.7903 (2.6845) ce_loss 1.2471 (1.1715) loss_zs_kd 1.2078 (1.2446) loss_oracle 1.1628 (1.1486) acc 53.1250 (54.6875) kd_loss 0.9618 (0.9387) lr 1.9921e-03 eta 0:22:21
epoch [4/50] batch [100/319] time 0.088 (0.089) data 0.000 (0.009) loss 2.8389 (2.6900) ce_loss 1.3135 (1.1759) loss_zs_kd 1.1614 (1.2598) loss_oracle 1.1415 (1.1481) acc 59.3750 (54.6562) kd_loss 0.9547 (0.9400) lr 1.9921e-03 eta 0:22:02
epoch [4/50] batch [120/319] time 0.083 (0.088) data 0.000 (0.008) loss 2.6255 (2.6824) ce_loss 1.1172 (1.1720) loss_zs_kd 1.3286 (1.2757) loss_oracle 1.1654 (1.1487) acc 62.5000 (55.1302) kd_loss 0.9256 (0.9360) lr 1.9921e-03 eta 0:21:54
epoch [4/50] batch [140/319] time 0.086 (0.088) data 0.000 (0.007) loss 2.9902 (2.6861) ce_loss 1.4434 (1.1744) loss_zs_kd 1.3746 (1.2831) loss_oracle 1.1720 (1.1492) acc 50.0000 (55.3571) kd_loss 0.9608 (0.9372) lr 1.9921e-03 eta 0:21:46
epoch [4/50] batch [160/319] time 0.081 (0.087) data 0.000 (0.006) loss 3.0685 (2.6853) ce_loss 1.5537 (1.1751) loss_zs_kd 1.4310 (1.2682) loss_oracle 1.1282 (1.1485) acc 43.7500 (55.5469) kd_loss 0.9506 (0.9359) lr 1.9921e-03 eta 0:21:37
epoch [4/50] batch [180/319] time 0.077 (0.087) data 0.000 (0.005) loss 2.7052 (2.6833) ce_loss 1.2051 (1.1735) loss_zs_kd 1.0857 (1.2737) loss_oracle 1.1333 (1.1475) acc 56.2500 (55.4688) kd_loss 0.9335 (0.9361) lr 1.9921e-03 eta 0:21:22
epoch [4/50] batch [200/319] time 0.081 (0.086) data 0.000 (0.005) loss 2.5766 (2.6807) ce_loss 1.0830 (1.1702) loss_zs_kd 1.3945 (1.2776) loss_oracle 1.1569 (1.1475) acc 65.6250 (55.6875) kd_loss 0.9151 (0.9368) lr 1.9921e-03 eta 0:21:08
epoch [4/50] batch [220/319] time 0.085 (0.086) data 0.000 (0.004) loss 2.7043 (2.6715) ce_loss 1.1738 (1.1633) loss_zs_kd 1.4543 (1.2836) loss_oracle 1.1599 (1.1466) acc 62.5000 (56.0653) kd_loss 0.9505 (0.9348) lr 1.9921e-03 eta 0:21:05
epoch [4/50] batch [240/319] time 0.079 (0.086) data 0.000 (0.004) loss 2.6448 (2.6746) ce_loss 1.1357 (1.1661) loss_zs_kd 1.3373 (1.2915) loss_oracle 1.1692 (1.1467) acc 68.7500 (56.0807) kd_loss 0.9245 (0.9352) lr 1.9921e-03 eta 0:21:02
epoch [4/50] batch [260/319] time 0.100 (0.086) data 0.000 (0.004) loss 2.7158 (2.6763) ce_loss 1.2119 (1.1670) loss_zs_kd 1.6123 (1.3004) loss_oracle 1.1387 (1.1468) acc 46.8750 (56.0096) kd_loss 0.9345 (0.9359) lr 1.9921e-03 eta 0:21:03
epoch [4/50] batch [280/319] time 0.078 (0.086) data 0.000 (0.003) loss 2.6697 (2.6715) ce_loss 1.1318 (1.1630) loss_zs_kd 1.2836 (1.2997) loss_oracle 1.1229 (1.1466) acc 62.5000 (56.2946) kd_loss 0.9764 (0.9352) lr 1.9921e-03 eta 0:20:59
epoch [4/50] batch [300/319] time 0.071 (0.085) data 0.000 (0.003) loss 2.5132 (2.6690) ce_loss 0.9180 (1.1599) loss_zs_kd 1.4880 (1.2995) loss_oracle 1.1575 (1.1462) acc 71.8750 (56.3229) kd_loss 1.0165 (0.9360) lr 1.9921e-03 eta 0:20:43
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,705
* accuracy: 61.8%
* error: 38.2%
* macro_f1: 53.0%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,110
* accuracy: 52.5%
* error: 47.5%
* macro_f1: 22.8%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      61.8%, epoch: 4 *******
******* Domain 2 best val test acc: 52.5%, epoch: 4 *******
******* Domain 2 best test acc:     52.5%, epoch: 4 *******
epoch [5/50] batch [20/319] time 0.081 (0.140) data 0.000 (0.059) loss 2.6260 (2.6524) ce_loss 1.0713 (1.1465) loss_zs_kd 1.1916 (1.2845) loss_oracle 1.1305 (1.1418) acc 62.5000 (54.2188) kd_loss 0.9894 (0.9349) lr 1.9823e-03 eta 0:34:18
epoch [5/50] batch [40/319] time 0.086 (0.112) data 0.000 (0.030) loss 2.4396 (2.6578) ce_loss 0.9912 (1.1567) loss_zs_kd 1.4533 (1.3493) loss_oracle 1.1462 (1.1381) acc 68.7500 (54.3750) kd_loss 0.8753 (0.9321) lr 1.9823e-03 eta 0:27:25
epoch [5/50] batch [60/319] time 0.072 (0.102) data 0.000 (0.020) loss 2.4429 (2.6635) ce_loss 0.9927 (1.1568) loss_zs_kd 1.7077 (1.3750) loss_oracle 1.1039 (1.1370) acc 71.8750 (55.0521) kd_loss 0.8983 (0.9382) lr 1.9823e-03 eta 0:24:53
epoch [5/50] batch [80/319] time 0.077 (0.098) data 0.000 (0.015) loss 2.4336 (2.6454) ce_loss 0.9331 (1.1398) loss_zs_kd 1.2149 (1.3764) loss_oracle 1.1419 (1.1372) acc 62.5000 (56.2500) kd_loss 0.9295 (0.9370) lr 1.9823e-03 eta 0:23:43
epoch [5/50] batch [100/319] time 0.059 (0.090) data 0.000 (0.012) loss 2.8831 (2.6366) ce_loss 1.2910 (1.1328) loss_zs_kd 1.4425 (1.3771) loss_oracle 1.1580 (1.1362) acc 43.7500 (56.5938) kd_loss 1.0131 (0.9357) lr 1.9823e-03 eta 0:21:58
epoch [5/50] batch [120/319] time 0.065 (0.086) data 0.000 (0.010) loss 2.7331 (2.6415) ce_loss 1.1719 (1.1388) loss_zs_kd 1.5261 (1.3854) loss_oracle 1.1066 (1.1341) acc 56.2500 (56.4844) kd_loss 1.0079 (0.9356) lr 1.9823e-03 eta 0:20:46
epoch [5/50] batch [140/319] time 0.086 (0.083) data 0.000 (0.009) loss 2.9759 (2.6360) ce_loss 1.5234 (1.1336) loss_zs_kd 1.1374 (1.4043) loss_oracle 1.0587 (1.1328) acc 37.5000 (56.5625) kd_loss 0.9231 (0.9359) lr 1.9823e-03 eta 0:20:11
epoch [5/50] batch [160/319] time 0.081 (0.082) data 0.000 (0.008) loss 2.7336 (2.6297) ce_loss 1.1855 (1.1290) loss_zs_kd 1.3232 (1.4012) loss_oracle 1.1625 (1.1313) acc 56.2500 (57.0117) kd_loss 0.9668 (0.9351) lr 1.9823e-03 eta 0:19:47
epoch [5/50] batch [180/319] time 0.085 (0.082) data 0.000 (0.007) loss 2.3837 (2.6232) ce_loss 0.9097 (1.1243) loss_zs_kd 1.5989 (1.4003) loss_oracle 1.1113 (1.1298) acc 65.6250 (57.2743) kd_loss 0.9184 (0.9340) lr 1.9823e-03 eta 0:19:43
epoch [5/50] batch [200/319] time 0.074 (0.082) data 0.000 (0.006) loss 2.4581 (2.6214) ce_loss 1.0439 (1.1243) loss_zs_kd 1.8578 (1.4029) loss_oracle 1.1398 (1.1275) acc 62.5000 (57.4531) kd_loss 0.8443 (0.9334) lr 1.9823e-03 eta 0:19:42
epoch [5/50] batch [220/319] time 0.085 (0.082) data 0.000 (0.006) loss 2.4631 (2.6198) ce_loss 0.9624 (1.1254) loss_zs_kd 1.2676 (1.4083) loss_oracle 1.1315 (1.1263) acc 53.1250 (57.4290) kd_loss 0.9350 (0.9313) lr 1.9823e-03 eta 0:19:45
epoch [5/50] batch [240/319] time 0.086 (0.082) data 0.000 (0.005) loss 2.4718 (2.6228) ce_loss 1.0176 (1.1288) loss_zs_kd 1.3999 (1.4092) loss_oracle 1.0963 (1.1245) acc 59.3750 (57.3698) kd_loss 0.9061 (0.9317) lr 1.9823e-03 eta 0:19:45
epoch [5/50] batch [260/319] time 0.082 (0.082) data 0.000 (0.005) loss 2.8096 (2.6224) ce_loss 1.3057 (1.1297) loss_zs_kd 1.5671 (1.4162) loss_oracle 1.0977 (1.1229) acc 40.6250 (57.2115) kd_loss 0.9551 (0.9313) lr 1.9823e-03 eta 0:19:44
epoch [5/50] batch [280/319] time 0.083 (0.082) data 0.000 (0.004) loss 2.1650 (2.6195) ce_loss 0.6836 (1.1274) loss_zs_kd 1.1594 (1.4108) loss_oracle 1.1412 (1.1226) acc 81.2500 (57.3214) kd_loss 0.9108 (0.9308) lr 1.9823e-03 eta 0:19:43
epoch [5/50] batch [300/319] time 0.093 (0.082) data 0.000 (0.004) loss 2.6189 (2.6209) ce_loss 1.1982 (1.1283) loss_zs_kd 1.4006 (1.4093) loss_oracle 1.0885 (1.1217) acc 56.2500 (57.3438) kd_loss 0.8765 (0.9318) lr 1.9823e-03 eta 0:19:44
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,799
* accuracy: 63.9%
* error: 36.1%
* macro_f1: 54.2%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,812
* accuracy: 49.4%
* error: 50.6%
* macro_f1: 23.8%
******* Domain 2 best val acc:      63.9%, epoch: 5 *******
******* Domain 2 best val test acc: 49.4%, epoch: 5 *******
******* Domain 2 best test acc:     52.5%, epoch: 4 *******
epoch [6/50] batch [20/319] time 0.083 (0.133) data 0.000 (0.049) loss 2.8247 (2.5518) ce_loss 1.3232 (1.0834) loss_zs_kd 1.7407 (1.4989) loss_oracle 1.0803 (1.0981) acc 53.1250 (61.5625) kd_loss 0.9613 (0.9194) lr 1.9686e-03 eta 0:31:46
epoch [6/50] batch [40/319] time 0.085 (0.109) data 0.000 (0.025) loss 2.7258 (2.5268) ce_loss 1.1963 (1.0595) loss_zs_kd 1.2593 (1.4871) loss_oracle 1.1006 (1.0963) acc 50.0000 (61.7969) kd_loss 0.9792 (0.9192) lr 1.9686e-03 eta 0:26:04
epoch [6/50] batch [60/319] time 0.097 (0.102) data 0.001 (0.017) loss 2.8136 (2.5627) ce_loss 1.2588 (1.0923) loss_zs_kd 1.3966 (1.4659) loss_oracle 1.1058 (1.0935) acc 50.0000 (59.5833) kd_loss 1.0020 (0.9237) lr 1.9686e-03 eta 0:24:16
epoch [6/50] batch [80/319] time 0.085 (0.098) data 0.000 (0.013) loss 2.6402 (2.5725) ce_loss 1.1787 (1.1005) loss_zs_kd 1.3486 (1.4406) loss_oracle 1.0736 (1.0910) acc 62.5000 (58.8672) kd_loss 0.9247 (0.9265) lr 1.9686e-03 eta 0:23:14
epoch [6/50] batch [100/319] time 0.089 (0.095) data 0.000 (0.010) loss 2.5375 (2.5887) ce_loss 1.0361 (1.1115) loss_zs_kd 1.5597 (1.4100) loss_oracle 1.0547 (1.0882) acc 59.3750 (58.5625) kd_loss 0.9740 (0.9331) lr 1.9686e-03 eta 0:22:38
epoch [6/50] batch [120/319] time 0.072 (0.093) data 0.000 (0.008) loss 2.5881 (2.5838) ce_loss 1.0879 (1.1099) loss_zs_kd 1.5152 (1.4151) loss_oracle 1.0564 (1.0832) acc 71.8750 (58.9323) kd_loss 0.9720 (0.9323) lr 1.9686e-03 eta 0:22:08
epoch [6/50] batch [140/319] time 0.094 (0.092) data 0.000 (0.007) loss 2.6456 (2.5763) ce_loss 1.2783 (1.1047) loss_zs_kd 1.4342 (1.4151) loss_oracle 1.0518 (1.0773) acc 53.1250 (59.1964) kd_loss 0.8414 (0.9330) lr 1.9686e-03 eta 0:21:50
epoch [6/50] batch [160/319] time 0.092 (0.092) data 0.000 (0.006) loss 2.5252 (2.5733) ce_loss 1.0430 (1.1035) loss_zs_kd 1.5107 (1.4306) loss_oracle 1.0558 (1.0731) acc 53.1250 (58.9062) kd_loss 0.9543 (0.9332) lr 1.9686e-03 eta 0:21:41
epoch [6/50] batch [180/319] time 0.097 (0.092) data 0.000 (0.006) loss 2.6636 (2.5796) ce_loss 1.3232 (1.1125) loss_zs_kd 1.4819 (1.4437) loss_oracle 0.9993 (1.0692) acc 53.1250 (58.6285) kd_loss 0.8408 (0.9325) lr 1.9686e-03 eta 0:21:46
epoch [6/50] batch [200/319] time 0.080 (0.092) data 0.000 (0.005) loss 2.3951 (2.5728) ce_loss 1.0342 (1.1094) loss_zs_kd 1.2243 (1.4371) loss_oracle 1.0230 (1.0651) acc 56.2500 (58.7812) kd_loss 0.8494 (0.9309) lr 1.9686e-03 eta 0:21:43
epoch [6/50] batch [220/319] time 0.079 (0.091) data 0.000 (0.005) loss 2.4670 (2.5692) ce_loss 1.0703 (1.1080) loss_zs_kd 1.2897 (1.4418) loss_oracle 1.0692 (1.0611) acc 59.3750 (58.8920) kd_loss 0.8621 (0.9306) lr 1.9686e-03 eta 0:21:31
epoch [6/50] batch [240/319] time 0.087 (0.091) data 0.000 (0.004) loss 2.7940 (2.5686) ce_loss 1.2949 (1.1103) loss_zs_kd 1.3763 (1.4389) loss_oracle 1.0588 (1.0574) acc 46.8750 (58.7630) kd_loss 0.9697 (0.9296) lr 1.9686e-03 eta 0:21:21
epoch [6/50] batch [260/319] time 0.086 (0.090) data 0.000 (0.004) loss 2.3334 (2.5658) ce_loss 0.8726 (1.1093) loss_zs_kd 1.6412 (1.4449) loss_oracle 1.0137 (1.0540) acc 62.5000 (58.7500) kd_loss 0.9540 (0.9295) lr 1.9686e-03 eta 0:21:14
epoch [6/50] batch [280/319] time 0.067 (0.090) data 0.000 (0.004) loss 2.6936 (2.5662) ce_loss 1.1875 (1.1104) loss_zs_kd 1.3489 (1.4514) loss_oracle 1.0285 (1.0504) acc 46.8750 (58.6830) kd_loss 0.9918 (0.9307) lr 1.9686e-03 eta 0:21:02
epoch [6/50] batch [300/319] time 0.076 (0.089) data 0.000 (0.004) loss 2.4566 (2.5703) ce_loss 1.0752 (1.1146) loss_zs_kd 1.5562 (1.4513) loss_oracle 0.9769 (1.0463) acc 68.7500 (58.6146) kd_loss 0.8930 (0.9326) lr 1.9686e-03 eta 0:20:47
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,778
* accuracy: 63.5%
* error: 36.5%
* macro_f1: 55.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,144
* accuracy: 52.8%
* error: 47.2%
* macro_f1: 24.2%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      63.9%, epoch: 5 *******
******* Domain 2 best val test acc: 49.4%, epoch: 5 *******
******* Domain 2 best test acc:     52.8%, epoch: 6 *******
epoch [7/50] batch [20/319] time 0.081 (0.139) data 0.000 (0.060) loss 1.9969 (2.4994) ce_loss 0.6978 (1.0798) loss_zs_kd 1.5411 (1.4800) loss_oracle 0.9517 (0.9765) acc 71.8750 (61.4062) kd_loss 0.8233 (0.9314) lr 1.9511e-03 eta 0:32:31
epoch [7/50] batch [40/319] time 0.077 (0.113) data 0.000 (0.030) loss 2.8639 (2.5338) ce_loss 1.4092 (1.1192) loss_zs_kd 1.5917 (1.4390) loss_oracle 0.9713 (0.9757) acc 50.0000 (58.4375) kd_loss 0.9690 (0.9267) lr 1.9511e-03 eta 0:26:26
epoch [7/50] batch [60/319] time 0.086 (0.104) data 0.001 (0.020) loss 2.4732 (2.5256) ce_loss 1.0762 (1.1087) loss_zs_kd 1.3165 (1.4233) loss_oracle 0.9131 (0.9695) acc 65.6250 (58.8021) kd_loss 0.9405 (0.9322) lr 1.9511e-03 eta 0:24:06
epoch [7/50] batch [80/319] time 0.092 (0.099) data 0.000 (0.015) loss 2.4597 (2.5335) ce_loss 1.0654 (1.1197) loss_zs_kd 1.3240 (1.4115) loss_oracle 0.9228 (0.9600) acc 59.3750 (58.1641) kd_loss 0.9329 (0.9338) lr 1.9511e-03 eta 0:22:57
epoch [7/50] batch [100/319] time 0.084 (0.096) data 0.000 (0.012) loss 2.5981 (2.5440) ce_loss 1.0947 (1.1282) loss_zs_kd 1.4176 (1.4242) loss_oracle 0.9890 (0.9573) acc 59.3750 (57.7188) kd_loss 1.0089 (0.9372) lr 1.9511e-03 eta 0:22:12
epoch [7/50] batch [120/319] time 0.082 (0.094) data 0.000 (0.010) loss 2.7642 (2.5352) ce_loss 1.3193 (1.1224) loss_zs_kd 1.4710 (1.4286) loss_oracle 0.9237 (0.9522) acc 56.2500 (57.6823) kd_loss 0.9830 (0.9367) lr 1.9511e-03 eta 0:21:42
epoch [7/50] batch [140/319] time 0.087 (0.092) data 0.000 (0.009) loss 2.2540 (2.5287) ce_loss 0.8965 (1.1160) loss_zs_kd 1.4098 (1.4270) loss_oracle 0.8911 (0.9473) acc 62.5000 (58.2366) kd_loss 0.9120 (0.9391) lr 1.9511e-03 eta 0:21:20
epoch [7/50] batch [160/319] time 0.078 (0.091) data 0.000 (0.008) loss 2.1965 (2.5260) ce_loss 0.9785 (1.1167) loss_zs_kd 1.3003 (1.4208) loss_oracle 0.8594 (0.9422) acc 65.6250 (58.2227) kd_loss 0.7883 (0.9382) lr 1.9511e-03 eta 0:20:58
epoch [7/50] batch [180/319] time 0.085 (0.090) data 0.000 (0.007) loss 2.3958 (2.5264) ce_loss 1.0918 (1.1207) loss_zs_kd 1.3349 (1.4323) loss_oracle 0.9134 (0.9376) acc 59.3750 (58.0382) kd_loss 0.8473 (0.9368) lr 1.9511e-03 eta 0:20:45
epoch [7/50] batch [200/319] time 0.072 (0.089) data 0.000 (0.006) loss 2.8674 (2.5164) ce_loss 1.5176 (1.1153) loss_zs_kd 1.6706 (1.4343) loss_oracle 0.8499 (0.9328) acc 53.1250 (58.2500) kd_loss 0.9249 (0.9347) lr 1.9511e-03 eta 0:20:30
epoch [7/50] batch [220/319] time 0.084 (0.088) data 0.000 (0.006) loss 2.4458 (2.5040) ce_loss 1.0459 (1.1055) loss_zs_kd 1.6457 (1.4313) loss_oracle 0.9641 (0.9291) acc 59.3750 (58.6790) kd_loss 0.9178 (0.9340) lr 1.9511e-03 eta 0:20:18
epoch [7/50] batch [240/319] time 0.083 (0.088) data 0.000 (0.005) loss 2.4615 (2.4988) ce_loss 1.1016 (1.1029) loss_zs_kd 1.5403 (1.4378) loss_oracle 0.8427 (0.9250) acc 59.3750 (58.7370) kd_loss 0.9386 (0.9334) lr 1.9511e-03 eta 0:20:11
epoch [7/50] batch [260/319] time 0.081 (0.087) data 0.000 (0.005) loss 2.2907 (2.4971) ce_loss 0.9204 (1.1045) loss_zs_kd 1.6371 (1.4479) loss_oracle 0.8759 (0.9198) acc 68.7500 (58.5817) kd_loss 0.9323 (0.9327) lr 1.9511e-03 eta 0:19:58
epoch [7/50] batch [280/319] time 0.085 (0.086) data 0.000 (0.005) loss 2.3931 (2.4958) ce_loss 0.9570 (1.1066) loss_zs_kd 1.7196 (1.4548) loss_oracle 0.9046 (0.9149) acc 68.7500 (58.6049) kd_loss 0.9838 (0.9317) lr 1.9511e-03 eta 0:19:49
epoch [7/50] batch [300/319] time 0.086 (0.086) data 0.000 (0.004) loss 2.5552 (2.4905) ce_loss 1.1182 (1.1040) loss_zs_kd 1.7011 (1.4616) loss_oracle 0.9064 (0.9109) acc 62.5000 (58.7188) kd_loss 0.9838 (0.9310) lr 1.9511e-03 eta 0:19:42
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,860
* accuracy: 65.3%
* error: 34.7%
* macro_f1: 58.2%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,395
* accuracy: 55.4%
* error: 44.6%
* macro_f1: 24.4%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      65.3%, epoch: 7 *******
******* Domain 2 best val test acc: 55.4%, epoch: 7 *******
******* Domain 2 best test acc:     55.4%, epoch: 7 *******
epoch [8/50] batch [20/319] time 0.088 (0.166) data 0.000 (0.077) loss 2.6638 (2.4799) ce_loss 1.3848 (1.1525) loss_zs_kd 1.5103 (1.4722) loss_oracle 0.8182 (0.8346) acc 46.8750 (56.4062) kd_loss 0.8699 (0.9101) lr 1.9298e-03 eta 0:37:51
epoch [8/50] batch [40/319] time 0.072 (0.123) data 0.000 (0.039) loss 2.2194 (2.4447) ce_loss 0.9473 (1.1150) loss_zs_kd 1.3941 (1.5189) loss_oracle 0.8131 (0.8307) acc 59.3750 (56.2500) kd_loss 0.8656 (0.9143) lr 1.9298e-03 eta 0:27:59
epoch [8/50] batch [60/319] time 0.079 (0.108) data 0.000 (0.026) loss 2.3659 (2.4245) ce_loss 1.0781 (1.1013) loss_zs_kd 1.4456 (1.5156) loss_oracle 0.7985 (0.8274) acc 62.5000 (56.8750) kd_loss 0.8885 (0.9095) lr 1.9298e-03 eta 0:24:30
epoch [8/50] batch [80/319] time 0.083 (0.101) data 0.000 (0.019) loss 2.3120 (2.4050) ce_loss 0.9932 (1.0863) loss_zs_kd 1.2928 (1.4811) loss_oracle 0.7739 (0.8232) acc 59.3750 (57.7344) kd_loss 0.9318 (0.9071) lr 1.9298e-03 eta 0:22:54
epoch [8/50] batch [100/319] time 0.088 (0.098) data 0.000 (0.016) loss 2.2145 (2.4162) ce_loss 0.9028 (1.0939) loss_zs_kd 1.6259 (1.4894) loss_oracle 0.8631 (0.8219) acc 68.7500 (57.5625) kd_loss 0.8801 (0.9113) lr 1.9298e-03 eta 0:22:09
epoch [8/50] batch [120/319] time 0.080 (0.095) data 0.000 (0.013) loss 2.6030 (2.3987) ce_loss 1.2539 (1.0849) loss_zs_kd 1.7654 (1.4857) loss_oracle 0.8671 (0.8201) acc 62.5000 (58.3594) kd_loss 0.9156 (0.9039) lr 1.9298e-03 eta 0:21:31
epoch [8/50] batch [140/319] time 0.077 (0.093) data 0.000 (0.011) loss 2.3263 (2.4004) ce_loss 1.0752 (1.0913) loss_zs_kd 1.7186 (1.4817) loss_oracle 0.8836 (0.8181) acc 62.5000 (57.8348) kd_loss 0.8093 (0.9001) lr 1.9298e-03 eta 0:21:04
epoch [8/50] batch [160/319] time 0.074 (0.092) data 0.000 (0.010) loss 2.5995 (2.3979) ce_loss 1.2051 (1.0928) loss_zs_kd 1.2650 (1.4695) loss_oracle 0.7986 (0.8158) acc 46.8750 (58.1445) kd_loss 0.9951 (0.8972) lr 1.9298e-03 eta 0:20:45
epoch [8/50] batch [180/319] time 0.090 (0.090) data 0.000 (0.009) loss 2.4142 (2.4000) ce_loss 1.2646 (1.0973) loss_zs_kd 1.4895 (1.4839) loss_oracle 0.7781 (0.8137) acc 59.3750 (58.2118) kd_loss 0.7605 (0.8957) lr 1.9298e-03 eta 0:20:22
epoch [8/50] batch [200/319] time 0.086 (0.090) data 0.000 (0.008) loss 2.3315 (2.3958) ce_loss 1.0303 (1.0934) loss_zs_kd 1.6727 (1.4856) loss_oracle 0.7928 (0.8085) acc 65.6250 (58.2188) kd_loss 0.9048 (0.8982) lr 1.9298e-03 eta 0:20:14
epoch [8/50] batch [220/319] time 0.091 (0.089) data 0.000 (0.007) loss 1.9752 (2.3952) ce_loss 0.7383 (1.0936) loss_zs_kd 1.5706 (1.4858) loss_oracle 0.7809 (0.8055) acc 75.0000 (58.3949) kd_loss 0.8465 (0.8988) lr 1.9298e-03 eta 0:20:06
epoch [8/50] batch [240/319] time 0.089 (0.089) data 0.000 (0.007) loss 2.6177 (2.3898) ce_loss 1.3174 (1.0901) loss_zs_kd 1.2842 (1.4833) loss_oracle 0.8138 (0.8020) acc 62.5000 (58.6849) kd_loss 0.8934 (0.8987) lr 1.9298e-03 eta 0:19:57
epoch [8/50] batch [260/319] time 0.084 (0.089) data 0.000 (0.006) loss 2.6657 (2.3898) ce_loss 1.3379 (1.0904) loss_zs_kd 1.5939 (1.4833) loss_oracle 0.7594 (0.7985) acc 56.2500 (58.7380) kd_loss 0.9481 (0.9001) lr 1.9298e-03 eta 0:19:52
epoch [8/50] batch [280/319] time 0.090 (0.089) data 0.000 (0.006) loss 2.5329 (2.3865) ce_loss 1.2441 (1.0870) loss_zs_kd 1.4368 (1.4806) loss_oracle 0.7467 (0.7955) acc 40.6250 (58.8281) kd_loss 0.9154 (0.9017) lr 1.9298e-03 eta 0:19:52
epoch [8/50] batch [300/319] time 0.079 (0.089) data 0.000 (0.005) loss 2.7355 (2.3912) ce_loss 1.3408 (1.0921) loss_zs_kd 1.2643 (1.4803) loss_oracle 0.8610 (0.7939) acc 46.8750 (58.6979) kd_loss 0.9642 (0.9021) lr 1.9298e-03 eta 0:19:47
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,873
* accuracy: 65.6%
* error: 34.4%
* macro_f1: 56.4%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,501
* accuracy: 56.5%
* error: 43.5%
* macro_f1: 25.0%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      65.6%, epoch: 8 *******
******* Domain 2 best val test acc: 56.5%, epoch: 8 *******
******* Domain 2 best test acc:     56.5%, epoch: 8 *******
epoch [9/50] batch [20/319] time 0.080 (0.173) data 0.000 (0.082) loss 2.0819 (2.2655) ce_loss 0.8921 (1.0057) loss_zs_kd 1.7460 (1.5755) loss_oracle 0.6820 (0.7685) acc 71.8750 (61.2500) kd_loss 0.8488 (0.8755) lr 1.9048e-03 eta 0:38:41
epoch [9/50] batch [40/319] time 0.080 (0.129) data 0.000 (0.041) loss 2.0756 (2.2470) ce_loss 0.9702 (1.0068) loss_zs_kd 1.6125 (1.5573) loss_oracle 0.7290 (0.7521) acc 65.6250 (61.5625) kd_loss 0.7408 (0.8642) lr 1.9048e-03 eta 0:28:37
epoch [9/50] batch [60/319] time 0.090 (0.114) data 0.000 (0.028) loss 2.5629 (2.2821) ce_loss 1.1787 (1.0439) loss_zs_kd 1.4515 (1.5264) loss_oracle 0.7856 (0.7450) acc 53.1250 (60.4688) kd_loss 0.9914 (0.8657) lr 1.9048e-03 eta 0:25:21
epoch [9/50] batch [80/319] time 0.079 (0.107) data 0.000 (0.021) loss 2.2951 (2.2988) ce_loss 1.0293 (1.0621) loss_zs_kd 1.3509 (1.5178) loss_oracle 0.7314 (0.7379) acc 68.7500 (60.3125) kd_loss 0.9001 (0.8677) lr 1.9048e-03 eta 0:23:41
epoch [9/50] batch [100/319] time 0.087 (0.103) data 0.000 (0.017) loss 2.3703 (2.2889) ce_loss 1.2939 (1.0641) loss_zs_kd 1.2614 (1.4924) loss_oracle 0.6471 (0.7304) acc 50.0000 (60.4062) kd_loss 0.7528 (0.8596) lr 1.9048e-03 eta 0:22:44
epoch [9/50] batch [120/319] time 0.090 (0.100) data 0.000 (0.014) loss 2.3690 (2.3107) ce_loss 1.0889 (1.0809) loss_zs_kd 1.2975 (1.4781) loss_oracle 0.7471 (0.7291) acc 75.0000 (60.2083) kd_loss 0.9065 (0.8652) lr 1.9048e-03 eta 0:22:09
epoch [9/50] batch [140/319] time 0.106 (0.099) data 0.001 (0.012) loss 2.7670 (2.3170) ce_loss 1.4395 (1.0877) loss_zs_kd 1.4771 (1.4836) loss_oracle 0.7000 (0.7296) acc 46.8750 (59.6205) kd_loss 0.9775 (0.8645) lr 1.9048e-03 eta 0:21:58
epoch [9/50] batch [160/319] time 0.109 (0.099) data 0.001 (0.011) loss 2.2532 (2.3032) ce_loss 1.0869 (1.0807) loss_zs_kd 1.4181 (1.4987) loss_oracle 0.7404 (0.7267) acc 65.6250 (60.0977) kd_loss 0.7961 (0.8592) lr 1.9048e-03 eta 0:21:50
epoch [9/50] batch [180/319] time 0.109 (0.099) data 0.001 (0.009) loss 2.1811 (2.2983) ce_loss 1.0137 (1.0765) loss_zs_kd 1.7496 (1.5004) loss_oracle 0.7421 (0.7286) acc 65.6250 (60.0000) kd_loss 0.7964 (0.8575) lr 1.9048e-03 eta 0:21:50
epoch [9/50] batch [200/319] time 0.088 (0.098) data 0.000 (0.009) loss 2.2671 (2.2988) ce_loss 1.1611 (1.0782) loss_zs_kd 1.4893 (1.5102) loss_oracle 0.7267 (0.7289) acc 56.2500 (60.0156) kd_loss 0.7426 (0.8561) lr 1.9048e-03 eta 0:21:30
epoch [9/50] batch [220/319] time 0.077 (0.097) data 0.000 (0.008) loss 2.3623 (2.2987) ce_loss 1.1064 (1.0780) loss_zs_kd 1.3479 (1.5061) loss_oracle 0.6759 (0.7291) acc 50.0000 (59.8011) kd_loss 0.9180 (0.8561) lr 1.9048e-03 eta 0:21:13
epoch [9/50] batch [240/319] time 0.087 (0.096) data 0.000 (0.007) loss 2.2626 (2.2962) ce_loss 1.1768 (1.0797) loss_zs_kd 1.7453 (1.5027) loss_oracle 0.6693 (0.7284) acc 56.2500 (59.7135) kd_loss 0.7512 (0.8523) lr 1.9048e-03 eta 0:20:59
epoch [9/50] batch [260/319] time 0.083 (0.095) data 0.000 (0.007) loss 2.2749 (2.2933) ce_loss 1.1250 (1.0778) loss_zs_kd 1.4292 (1.5043) loss_oracle 0.7783 (0.7310) acc 53.1250 (59.7236) kd_loss 0.7607 (0.8500) lr 1.9048e-03 eta 0:20:44
epoch [9/50] batch [280/319] time 0.079 (0.094) data 0.000 (0.006) loss 2.1287 (2.2986) ce_loss 0.8760 (1.0839) loss_zs_kd 1.5273 (1.5008) loss_oracle 0.7229 (0.7312) acc 71.8750 (59.4754) kd_loss 0.8912 (0.8491) lr 1.9048e-03 eta 0:20:32
epoch [9/50] batch [300/319] time 0.081 (0.093) data 0.000 (0.006) loss 2.5282 (2.2971) ce_loss 1.2617 (1.0825) loss_zs_kd 1.5641 (1.5018) loss_oracle 0.6739 (0.7324) acc 53.1250 (59.3438) kd_loss 0.9295 (0.8484) lr 1.9048e-03 eta 0:20:18
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,863
* accuracy: 65.4%
* error: 34.6%
* macro_f1: 56.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,372
* accuracy: 55.2%
* error: 44.8%
* macro_f1: 25.6%
******* Domain 2 best val acc:      65.6%, epoch: 8 *******
******* Domain 2 best val test acc: 56.5%, epoch: 8 *******
******* Domain 2 best test acc:     56.5%, epoch: 8 *******
epoch [10/50] batch [20/319] time 0.078 (0.166) data 0.000 (0.079) loss 2.5117 (2.3055) ce_loss 1.3818 (1.1216) loss_zs_kd 1.4315 (1.4489) loss_oracle 0.6900 (0.7092) acc 50.0000 (57.0312) kd_loss 0.7848 (0.8293) lr 1.8763e-03 eta 0:36:02
epoch [10/50] batch [40/319] time 0.084 (0.124) data 0.000 (0.040) loss 2.2314 (2.2785) ce_loss 1.1309 (1.1063) loss_zs_kd 1.3020 (1.4169) loss_oracle 0.6831 (0.7087) acc 56.2500 (56.7188) kd_loss 0.7590 (0.8179) lr 1.8763e-03 eta 0:26:56
epoch [10/50] batch [60/319] time 0.090 (0.110) data 0.001 (0.027) loss 2.3935 (2.2614) ce_loss 1.3184 (1.0958) loss_zs_kd 1.5079 (1.4125) loss_oracle 0.7161 (0.7126) acc 59.3750 (57.5000) kd_loss 0.7171 (0.8092) lr 1.8763e-03 eta 0:23:56
epoch [10/50] batch [80/319] time 0.084 (0.103) data 0.000 (0.020) loss 1.9797 (2.2706) ce_loss 0.8828 (1.1022) loss_zs_kd 1.3036 (1.4046) loss_oracle 0.6239 (0.7113) acc 65.6250 (57.6562) kd_loss 0.7849 (0.8127) lr 1.8763e-03 eta 0:22:20
epoch [10/50] batch [100/319] time 0.078 (0.098) data 0.000 (0.016) loss 2.0958 (2.2793) ce_loss 0.9116 (1.1091) loss_zs_kd 1.2757 (1.4030) loss_oracle 0.7329 (0.7130) acc 68.7500 (57.2500) kd_loss 0.8177 (0.8137) lr 1.8763e-03 eta 0:21:10
epoch [10/50] batch [120/319] time 0.091 (0.096) data 0.000 (0.013) loss 2.2206 (2.2709) ce_loss 1.0518 (1.0999) loss_zs_kd 1.4712 (1.4092) loss_oracle 0.7603 (0.7139) acc 65.6250 (57.9167) kd_loss 0.7887 (0.8140) lr 1.8763e-03 eta 0:20:43
epoch [10/50] batch [140/319] time 0.056 (0.094) data 0.000 (0.012) loss 2.0155 (2.2549) ce_loss 0.8979 (1.0882) loss_zs_kd 1.4807 (1.4181) loss_oracle 0.7715 (0.7133) acc 65.6250 (58.4375) kd_loss 0.7318 (0.8101) lr 1.8763e-03 eta 0:20:11
epoch [10/50] batch [160/319] time 0.091 (0.092) data 0.000 (0.010) loss 2.2505 (2.2470) ce_loss 1.1748 (1.0847) loss_zs_kd 1.5866 (1.4250) loss_oracle 0.6378 (0.7115) acc 46.8750 (58.5742) kd_loss 0.7568 (0.8065) lr 1.8763e-03 eta 0:19:45
epoch [10/50] batch [180/319] time 0.075 (0.091) data 0.000 (0.009) loss 2.3716 (2.2583) ce_loss 1.1514 (1.0935) loss_zs_kd 1.4078 (1.4403) loss_oracle 0.6650 (0.7146) acc 65.6250 (58.4549) kd_loss 0.8877 (0.8076) lr 1.8763e-03 eta 0:19:31
epoch [10/50] batch [200/319] time 0.079 (0.090) data 0.000 (0.008) loss 1.8634 (2.2516) ce_loss 0.7534 (1.0887) loss_zs_kd 1.4680 (1.4450) loss_oracle 0.6534 (0.7134) acc 75.0000 (58.5000) kd_loss 0.7833 (0.8062) lr 1.8763e-03 eta 0:19:13
epoch [10/50] batch [220/319] time 0.086 (0.089) data 0.000 (0.007) loss 2.0197 (2.2497) ce_loss 0.9619 (1.0888) loss_zs_kd 1.4339 (1.4585) loss_oracle 0.6249 (0.7119) acc 59.3750 (58.6648) kd_loss 0.7453 (0.8049) lr 1.8763e-03 eta 0:19:04
epoch [10/50] batch [240/319] time 0.090 (0.089) data 0.000 (0.007) loss 2.1524 (2.2498) ce_loss 1.0322 (1.0923) loss_zs_kd 1.5671 (1.4706) loss_oracle 0.7775 (0.7103) acc 65.6250 (58.6849) kd_loss 0.7315 (0.8024) lr 1.8763e-03 eta 0:18:58
epoch [10/50] batch [260/319] time 0.083 (0.088) data 0.000 (0.006) loss 2.2655 (2.2486) ce_loss 1.1240 (1.0926) loss_zs_kd 1.7220 (1.4825) loss_oracle 0.7100 (0.7095) acc 56.2500 (58.7380) kd_loss 0.7865 (0.8012) lr 1.8763e-03 eta 0:18:51
epoch [10/50] batch [280/319] time 0.088 (0.088) data 0.000 (0.006) loss 2.1877 (2.2418) ce_loss 1.0576 (1.0882) loss_zs_kd 1.5924 (1.4884) loss_oracle 0.7607 (0.7073) acc 50.0000 (58.8170) kd_loss 0.7497 (0.8000) lr 1.8763e-03 eta 0:18:47
epoch [10/50] batch [300/319] time 0.085 (0.088) data 0.000 (0.006) loss 2.3772 (2.2381) ce_loss 1.1484 (1.0866) loss_zs_kd 1.4285 (1.4891) loss_oracle 0.6443 (0.7050) acc 59.3750 (58.8542) kd_loss 0.9066 (0.7990) lr 1.8763e-03 eta 0:18:38
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,765
* accuracy: 63.2%
* error: 36.8%
* macro_f1: 57.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,633
* accuracy: 57.9%
* error: 42.1%
* macro_f1: 26.5%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      65.6%, epoch: 8 *******
******* Domain 2 best val test acc: 56.5%, epoch: 8 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [11/50] batch [20/319] time 0.081 (0.158) data 0.000 (0.071) loss 2.1589 (2.2361) ce_loss 1.0273 (1.0693) loss_zs_kd 1.4661 (1.5305) loss_oracle 0.6849 (0.6863) acc 56.2500 (60.3125) kd_loss 0.7891 (0.8236) lr 1.8443e-03 eta 0:33:28
epoch [11/50] batch [40/319] time 0.084 (0.118) data 0.000 (0.035) loss 1.9750 (2.2141) ce_loss 0.8984 (1.0673) loss_zs_kd 1.5196 (1.6065) loss_oracle 0.6864 (0.6808) acc 71.8750 (59.6094) kd_loss 0.7333 (0.8064) lr 1.8443e-03 eta 0:25:01
epoch [11/50] batch [60/319] time 0.076 (0.106) data 0.000 (0.024) loss 2.3490 (2.2170) ce_loss 1.0820 (1.0655) loss_zs_kd 1.9363 (1.6207) loss_oracle 0.6760 (0.6954) acc 65.6250 (59.8438) kd_loss 0.9289 (0.8038) lr 1.8443e-03 eta 0:22:24
epoch [11/50] batch [80/319] time 0.082 (0.101) data 0.000 (0.018) loss 2.4935 (2.2245) ce_loss 1.2617 (1.0726) loss_zs_kd 1.8190 (1.6333) loss_oracle 0.7085 (0.6968) acc 53.1250 (59.3750) kd_loss 0.8775 (0.8034) lr 1.8443e-03 eta 0:21:15
epoch [11/50] batch [100/319] time 0.078 (0.097) data 0.000 (0.014) loss 1.9818 (2.2247) ce_loss 1.0234 (1.0804) loss_zs_kd 1.5132 (1.6212) loss_oracle 0.6609 (0.6948) acc 68.7500 (59.6250) kd_loss 0.6280 (0.7969) lr 1.8443e-03 eta 0:20:24
epoch [11/50] batch [120/319] time 0.082 (0.094) data 0.000 (0.012) loss 2.0376 (2.2220) ce_loss 1.0420 (1.0815) loss_zs_kd 1.6588 (1.6349) loss_oracle 0.7003 (0.6914) acc 65.6250 (59.7396) kd_loss 0.6454 (0.7948) lr 1.8443e-03 eta 0:19:52
epoch [11/50] batch [140/319] time 0.082 (0.093) data 0.000 (0.010) loss 2.9021 (2.2198) ce_loss 1.5410 (1.0831) loss_zs_kd 1.5755 (1.6207) loss_oracle 0.6784 (0.6892) acc 40.6250 (59.8214) kd_loss 1.0218 (0.7921) lr 1.8443e-03 eta 0:19:32
epoch [11/50] batch [160/319] time 0.086 (0.092) data 0.000 (0.009) loss 1.8422 (2.2203) ce_loss 0.6860 (1.0842) loss_zs_kd 1.5598 (1.6231) loss_oracle 0.7110 (0.6872) acc 71.8750 (59.5508) kd_loss 0.8007 (0.7925) lr 1.8443e-03 eta 0:19:17
epoch [11/50] batch [180/319] time 0.090 (0.091) data 0.000 (0.008) loss 2.4303 (2.2186) ce_loss 1.2080 (1.0842) loss_zs_kd 1.5711 (1.6154) loss_oracle 0.6989 (0.6847) acc 62.5000 (59.5486) kd_loss 0.8728 (0.7920) lr 1.8443e-03 eta 0:19:06
epoch [11/50] batch [200/319] time 0.090 (0.091) data 0.000 (0.007) loss 2.2919 (2.2145) ce_loss 1.0723 (1.0801) loss_zs_kd 1.4476 (1.6153) loss_oracle 0.6945 (0.6871) acc 59.3750 (59.8594) kd_loss 0.8724 (0.7908) lr 1.8443e-03 eta 0:18:58
epoch [11/50] batch [220/319] time 0.088 (0.090) data 0.001 (0.007) loss 2.3021 (2.2094) ce_loss 1.1250 (1.0735) loss_zs_kd 1.6496 (1.5986) loss_oracle 0.6970 (0.6870) acc 56.2500 (59.9574) kd_loss 0.8286 (0.7924) lr 1.8443e-03 eta 0:18:52
epoch [11/50] batch [240/319] time 0.075 (0.090) data 0.000 (0.006) loss 2.0712 (2.1992) ce_loss 0.9604 (1.0655) loss_zs_kd 1.5341 (1.5952) loss_oracle 0.6504 (0.6875) acc 65.6250 (60.1432) kd_loss 0.7856 (0.7900) lr 1.8443e-03 eta 0:18:51
epoch [11/50] batch [260/319] time 0.081 (0.090) data 0.000 (0.006) loss 2.1482 (2.2002) ce_loss 0.8867 (1.0633) loss_zs_kd 1.8571 (1.5949) loss_oracle 0.6924 (0.6892) acc 65.6250 (60.1562) kd_loss 0.9153 (0.7922) lr 1.8443e-03 eta 0:18:42
epoch [11/50] batch [280/319] time 0.085 (0.089) data 0.000 (0.005) loss 2.3285 (2.1986) ce_loss 1.1191 (1.0609) loss_zs_kd 1.5026 (1.5937) loss_oracle 0.8560 (0.6908) acc 53.1250 (60.2455) kd_loss 0.7813 (0.7923) lr 1.8443e-03 eta 0:18:35
epoch [11/50] batch [300/319] time 0.075 (0.089) data 0.000 (0.005) loss 2.8320 (2.2038) ce_loss 1.6211 (1.0647) loss_zs_kd 1.6670 (1.5880) loss_oracle 0.6992 (0.6915) acc 40.6250 (59.9792) kd_loss 0.8614 (0.7933) lr 1.8443e-03 eta 0:18:28
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,879
* accuracy: 65.8%
* error: 34.2%
* macro_f1: 56.8%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,592
* accuracy: 47.2%
* error: 52.8%
* macro_f1: 21.3%
******* Domain 2 best val acc:      65.8%, epoch: 11 *******
******* Domain 2 best val test acc: 47.2%, epoch: 11 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [12/50] batch [20/319] time 0.081 (0.149) data 0.000 (0.070) loss 2.1017 (2.2499) ce_loss 1.0020 (1.0853) loss_zs_kd 1.4560 (1.5530) loss_oracle 0.6823 (0.7193) acc 62.5000 (60.1562) kd_loss 0.7586 (0.8049) lr 1.8090e-03 eta 0:30:53
epoch [12/50] batch [40/319] time 0.083 (0.117) data 0.000 (0.035) loss 1.9017 (2.2341) ce_loss 0.8687 (1.0812) loss_zs_kd 1.5747 (1.5359) loss_oracle 0.7243 (0.7081) acc 62.5000 (59.2188) kd_loss 0.6709 (0.7988) lr 1.8090e-03 eta 0:24:06
epoch [12/50] batch [60/319] time 0.081 (0.106) data 0.000 (0.024) loss 2.3947 (2.2432) ce_loss 1.2217 (1.0897) loss_zs_kd 1.3983 (1.5438) loss_oracle 0.7700 (0.7083) acc 43.7500 (58.8021) kd_loss 0.7880 (0.7993) lr 1.8090e-03 eta 0:21:47
epoch [12/50] batch [80/319] time 0.096 (0.100) data 0.000 (0.018) loss 2.0595 (2.2299) ce_loss 0.9043 (1.0786) loss_zs_kd 1.4087 (1.5645) loss_oracle 0.6357 (0.7035) acc 62.5000 (59.4922) kd_loss 0.8374 (0.7995) lr 1.8090e-03 eta 0:20:40
epoch [12/50] batch [100/319] time 0.078 (0.098) data 0.000 (0.014) loss 2.1488 (2.2412) ce_loss 1.0928 (1.0892) loss_zs_kd 1.6944 (1.5490) loss_oracle 0.6452 (0.7047) acc 59.3750 (59.2500) kd_loss 0.7334 (0.7996) lr 1.8090e-03 eta 0:20:04
epoch [12/50] batch [120/319] time 0.085 (0.096) data 0.000 (0.012) loss 2.1579 (2.2468) ce_loss 1.0439 (1.0939) loss_zs_kd 1.4083 (1.5604) loss_oracle 0.6442 (0.7060) acc 59.3750 (59.0365) kd_loss 0.7919 (0.7999) lr 1.8090e-03 eta 0:19:41
epoch [12/50] batch [140/319] time 0.082 (0.094) data 0.000 (0.010) loss 2.2415 (2.2291) ce_loss 1.1475 (1.0812) loss_zs_kd 1.5067 (1.5533) loss_oracle 0.7312 (0.7027) acc 68.7500 (59.7098) kd_loss 0.7284 (0.7965) lr 1.8090e-03 eta 0:19:20
epoch [12/50] batch [160/319] time 0.088 (0.092) data 0.000 (0.009) loss 2.2759 (2.2192) ce_loss 1.1719 (1.0744) loss_zs_kd 1.7934 (1.5454) loss_oracle 0.8618 (0.7021) acc 56.2500 (60.0781) kd_loss 0.6731 (0.7938) lr 1.8090e-03 eta 0:18:53
epoch [12/50] batch [180/319] time 0.083 (0.091) data 0.000 (0.008) loss 2.3751 (2.2192) ce_loss 0.9907 (1.0740) loss_zs_kd 1.7382 (1.5622) loss_oracle 0.7164 (0.7004) acc 68.7500 (60.1562) kd_loss 1.0262 (0.7950) lr 1.8090e-03 eta 0:18:41
epoch [12/50] batch [200/319] time 0.083 (0.091) data 0.000 (0.007) loss 2.3056 (2.2169) ce_loss 1.0811 (1.0696) loss_zs_kd 1.5724 (1.5654) loss_oracle 0.7943 (0.7029) acc 53.1250 (60.4219) kd_loss 0.8274 (0.7958) lr 1.8090e-03 eta 0:18:30
epoch [12/50] batch [220/319] time 0.079 (0.090) data 0.000 (0.007) loss 2.0431 (2.2174) ce_loss 0.8257 (1.0648) loss_zs_kd 1.5068 (1.5873) loss_oracle 0.7504 (0.7089) acc 59.3750 (60.5398) kd_loss 0.8422 (0.7981) lr 1.8090e-03 eta 0:18:16
epoch [12/50] batch [240/319] time 0.092 (0.089) data 0.000 (0.006) loss 2.1871 (2.2247) ce_loss 1.0312 (1.0657) loss_zs_kd 1.8511 (1.5866) loss_oracle 0.6694 (0.7138) acc 59.3750 (60.4818) kd_loss 0.8211 (0.8020) lr 1.8090e-03 eta 0:18:07
epoch [12/50] batch [260/319] time 0.083 (0.089) data 0.000 (0.006) loss 2.0809 (2.2202) ce_loss 0.9917 (1.0598) loss_zs_kd 1.4426 (1.5885) loss_oracle 0.6844 (0.7152) acc 75.0000 (60.7812) kd_loss 0.7470 (0.8028) lr 1.8090e-03 eta 0:18:02
epoch [12/50] batch [280/319] time 0.083 (0.089) data 0.000 (0.005) loss 1.9430 (2.2218) ce_loss 0.7275 (1.0601) loss_zs_kd 1.4918 (1.5838) loss_oracle 0.7529 (0.7155) acc 68.7500 (60.7031) kd_loss 0.8390 (0.8040) lr 1.8090e-03 eta 0:17:56
epoch [12/50] batch [300/319] time 0.085 (0.088) data 0.000 (0.005) loss 2.3566 (2.2183) ce_loss 1.1807 (1.0568) loss_zs_kd 1.6592 (1.5821) loss_oracle 0.6377 (0.7151) acc 50.0000 (60.7292) kd_loss 0.8571 (0.8039) lr 1.8090e-03 eta 0:17:52
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,886
* accuracy: 65.9%
* error: 34.1%
* macro_f1: 58.4%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,733
* accuracy: 48.6%
* error: 51.4%
* macro_f1: 24.5%
******* Domain 2 best val acc:      65.9%, epoch: 12 *******
******* Domain 2 best val test acc: 48.6%, epoch: 12 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [13/50] batch [20/319] time 0.080 (0.188) data 0.000 (0.100) loss 2.3680 (2.3345) ce_loss 1.0420 (1.1095) loss_zs_kd 1.6362 (1.6074) loss_oracle 0.7393 (0.7429) acc 50.0000 (60.3125) kd_loss 0.9563 (0.8535) lr 1.7705e-03 eta 0:37:58
epoch [13/50] batch [40/319] time 0.094 (0.137) data 0.000 (0.050) loss 2.6384 (2.2512) ce_loss 1.5488 (1.0526) loss_zs_kd 1.5261 (1.5747) loss_oracle 0.8326 (0.7312) acc 50.0000 (60.7031) kd_loss 0.6733 (0.8331) lr 1.7705e-03 eta 0:27:31
epoch [13/50] batch [60/319] time 0.086 (0.120) data 0.000 (0.034) loss 2.8998 (2.2538) ce_loss 1.4746 (1.0658) loss_zs_kd 1.6128 (1.5830) loss_oracle 0.8145 (0.7268) acc 50.0000 (60.1562) kd_loss 1.0179 (0.8245) lr 1.7705e-03 eta 0:24:06
epoch [13/50] batch [80/319] time 0.080 (0.111) data 0.000 (0.025) loss 1.8541 (2.2649) ce_loss 0.7183 (1.0731) loss_zs_kd 1.4234 (1.5887) loss_oracle 0.6887 (0.7190) acc 81.2500 (59.8828) kd_loss 0.7915 (0.8323) lr 1.7705e-03 eta 0:22:18
epoch [13/50] batch [100/319] time 0.084 (0.106) data 0.000 (0.020) loss 2.1502 (2.2479) ce_loss 1.0615 (1.0681) loss_zs_kd 1.5916 (1.5902) loss_oracle 0.5944 (0.7131) acc 56.2500 (60.0625) kd_loss 0.7915 (0.8233) lr 1.7705e-03 eta 0:21:18
epoch [13/50] batch [120/319] time 0.082 (0.103) data 0.000 (0.017) loss 2.1400 (2.2370) ce_loss 1.0049 (1.0607) loss_zs_kd 1.4295 (1.5890) loss_oracle 0.6484 (0.7065) acc 65.6250 (60.6510) kd_loss 0.8110 (0.8231) lr 1.7705e-03 eta 0:20:34
epoch [13/50] batch [140/319] time 0.090 (0.100) data 0.000 (0.015) loss 2.5746 (2.2425) ce_loss 1.4375 (1.0618) loss_zs_kd 1.8422 (1.5804) loss_oracle 0.7463 (0.7092) acc 53.1250 (60.5804) kd_loss 0.7639 (0.8260) lr 1.7705e-03 eta 0:19:58
epoch [13/50] batch [160/319] time 0.086 (0.098) data 0.000 (0.013) loss 2.4570 (2.2410) ce_loss 1.1553 (1.0601) loss_zs_kd 1.7132 (1.5860) loss_oracle 0.7792 (0.7113) acc 62.5000 (60.5859) kd_loss 0.9122 (0.8252) lr 1.7705e-03 eta 0:19:34
epoch [13/50] batch [180/319] time 0.085 (0.097) data 0.000 (0.011) loss 2.0158 (2.2446) ce_loss 0.9453 (1.0677) loss_zs_kd 1.4820 (1.5963) loss_oracle 0.6960 (0.7125) acc 65.6250 (60.4514) kd_loss 0.7225 (0.8206) lr 1.7705e-03 eta 0:19:16
epoch [13/50] batch [200/319] time 0.086 (0.096) data 0.000 (0.010) loss 2.5026 (2.2465) ce_loss 1.2197 (1.0714) loss_zs_kd 1.6231 (1.5983) loss_oracle 0.7367 (0.7141) acc 56.2500 (60.4844) kd_loss 0.9145 (0.8180) lr 1.7705e-03 eta 0:18:59
epoch [13/50] batch [220/319] time 0.084 (0.095) data 0.000 (0.009) loss 2.2982 (2.2350) ce_loss 1.1758 (1.0672) loss_zs_kd 1.7264 (1.6012) loss_oracle 0.7314 (0.7115) acc 53.1250 (60.5682) kd_loss 0.7567 (0.8120) lr 1.7705e-03 eta 0:18:46
epoch [13/50] batch [240/319] time 0.096 (0.094) data 0.000 (0.009) loss 2.0508 (2.2361) ce_loss 0.8081 (1.0678) loss_zs_kd 1.5020 (1.6052) loss_oracle 0.6351 (0.7118) acc 71.8750 (60.4688) kd_loss 0.9252 (0.8124) lr 1.7705e-03 eta 0:18:36
epoch [13/50] batch [260/319] time 0.085 (0.093) data 0.000 (0.008) loss 2.1845 (2.2388) ce_loss 1.0420 (1.0694) loss_zs_kd 1.6379 (1.6026) loss_oracle 0.6227 (0.7114) acc 56.2500 (60.3365) kd_loss 0.8312 (0.8138) lr 1.7705e-03 eta 0:18:22
epoch [13/50] batch [280/319] time 0.083 (0.092) data 0.000 (0.007) loss 2.3271 (2.2423) ce_loss 1.0664 (1.0693) loss_zs_kd 1.6767 (1.5932) loss_oracle 0.6899 (0.7110) acc 62.5000 (60.3348) kd_loss 0.9158 (0.8175) lr 1.7705e-03 eta 0:18:11
epoch [13/50] batch [300/319] time 0.077 (0.092) data 0.000 (0.007) loss 2.0563 (2.2377) ce_loss 1.0029 (1.0661) loss_zs_kd 1.4971 (1.5849) loss_oracle 0.7099 (0.7094) acc 62.5000 (60.4479) kd_loss 0.6984 (0.8169) lr 1.7705e-03 eta 0:18:02
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,895
* accuracy: 66.1%
* error: 33.9%
* macro_f1: 57.7%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,123
* accuracy: 52.6%
* error: 47.4%
* macro_f1: 24.3%
******* Domain 2 best val acc:      66.1%, epoch: 13 *******
******* Domain 2 best val test acc: 52.6%, epoch: 13 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [14/50] batch [20/319] time 0.079 (0.171) data 0.000 (0.078) loss 2.1202 (2.2900) ce_loss 0.8931 (1.0696) loss_zs_kd 1.6901 (1.4830) loss_oracle 0.7145 (0.7137) acc 75.0000 (58.5938) kd_loss 0.8699 (0.8635) lr 1.7290e-03 eta 0:33:38
epoch [14/50] batch [40/319] time 0.084 (0.128) data 0.000 (0.039) loss 2.0044 (2.2603) ce_loss 1.0020 (1.0551) loss_zs_kd 1.3237 (1.5219) loss_oracle 0.7089 (0.7148) acc 62.5000 (60.1562) kd_loss 0.6480 (0.8479) lr 1.7290e-03 eta 0:25:09
epoch [14/50] batch [60/319] time 0.084 (0.115) data 0.000 (0.026) loss 2.2984 (2.2666) ce_loss 1.0078 (1.0579) loss_zs_kd 1.8964 (1.5683) loss_oracle 0.8136 (0.7259) acc 62.5000 (59.5833) kd_loss 0.8838 (0.8458) lr 1.7290e-03 eta 0:22:27
epoch [14/50] batch [80/319] time 0.080 (0.107) data 0.000 (0.020) loss 2.4006 (2.2524) ce_loss 1.1904 (1.0549) loss_zs_kd 1.6860 (1.5683) loss_oracle 0.7266 (0.7230) acc 56.2500 (59.6484) kd_loss 0.8468 (0.8360) lr 1.7290e-03 eta 0:20:57
epoch [14/50] batch [100/319] time 0.082 (0.103) data 0.000 (0.016) loss 1.9086 (2.2539) ce_loss 0.7764 (1.0577) loss_zs_kd 1.7539 (1.5911) loss_oracle 0.6505 (0.7171) acc 75.0000 (59.4688) kd_loss 0.8070 (0.8377) lr 1.7290e-03 eta 0:20:02
epoch [14/50] batch [120/319] time 0.093 (0.100) data 0.000 (0.013) loss 1.9955 (2.2471) ce_loss 0.9116 (1.0581) loss_zs_kd 1.6036 (1.5996) loss_oracle 0.6059 (0.7137) acc 71.8750 (59.8438) kd_loss 0.7810 (0.8321) lr 1.7290e-03 eta 0:19:23
epoch [14/50] batch [140/319] time 0.093 (0.098) data 0.000 (0.011) loss 2.5565 (2.2401) ce_loss 1.4131 (1.0598) loss_zs_kd 1.6033 (1.5906) loss_oracle 0.6482 (0.7117) acc 53.1250 (59.8214) kd_loss 0.8193 (0.8244) lr 1.7290e-03 eta 0:19:00
epoch [14/50] batch [160/319] time 0.088 (0.096) data 0.000 (0.010) loss 2.4050 (2.2448) ce_loss 1.1660 (1.0649) loss_zs_kd 1.4817 (1.5923) loss_oracle 0.8576 (0.7130) acc 56.2500 (59.7852) kd_loss 0.8102 (0.8234) lr 1.7290e-03 eta 0:18:39
epoch [14/50] batch [180/319] time 0.084 (0.095) data 0.000 (0.009) loss 2.1117 (2.2450) ce_loss 0.9341 (1.0618) loss_zs_kd 1.4947 (1.5929) loss_oracle 0.8152 (0.7194) acc 68.7500 (60.1562) kd_loss 0.7700 (0.8235) lr 1.7290e-03 eta 0:18:23
epoch [14/50] batch [200/319] time 0.090 (0.093) data 0.000 (0.008) loss 2.0832 (2.2392) ce_loss 1.0156 (1.0563) loss_zs_kd 2.0288 (1.6029) loss_oracle 0.7301 (0.7225) acc 65.6250 (60.3125) kd_loss 0.7025 (0.8217) lr 1.7290e-03 eta 0:18:04
epoch [14/50] batch [220/319] time 0.077 (0.093) data 0.000 (0.007) loss 2.0301 (2.2395) ce_loss 0.9282 (1.0580) loss_zs_kd 1.6818 (1.6097) loss_oracle 0.6594 (0.7231) acc 65.6250 (60.1705) kd_loss 0.7721 (0.8199) lr 1.7290e-03 eta 0:17:52
epoch [14/50] batch [240/319] time 0.085 (0.092) data 0.000 (0.007) loss 2.2712 (2.2341) ce_loss 1.1475 (1.0557) loss_zs_kd 1.5626 (1.6115) loss_oracle 0.6944 (0.7182) acc 62.5000 (60.1302) kd_loss 0.7765 (0.8193) lr 1.7290e-03 eta 0:17:41
epoch [14/50] batch [260/319] time 0.082 (0.092) data 0.000 (0.006) loss 2.1105 (2.2326) ce_loss 0.9336 (1.0549) loss_zs_kd 1.4569 (1.6070) loss_oracle 0.6439 (0.7171) acc 68.7500 (60.2404) kd_loss 0.8549 (0.8192) lr 1.7290e-03 eta 0:17:39
epoch [14/50] batch [280/319] time 0.086 (0.091) data 0.000 (0.006) loss 2.2936 (2.2299) ce_loss 1.0674 (1.0522) loss_zs_kd 1.5980 (1.6051) loss_oracle 0.7741 (0.7170) acc 53.1250 (60.4688) kd_loss 0.8392 (0.8192) lr 1.7290e-03 eta 0:17:31
epoch [14/50] batch [300/319] time 0.087 (0.091) data 0.000 (0.005) loss 2.3837 (2.2302) ce_loss 1.2148 (1.0522) loss_zs_kd 1.5204 (1.6007) loss_oracle 0.7060 (0.7175) acc 46.8750 (60.5104) kd_loss 0.8158 (0.8192) lr 1.7290e-03 eta 0:17:24
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,684
* accuracy: 61.3%
* error: 38.7%
* macro_f1: 55.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,117
* accuracy: 52.6%
* error: 47.4%
* macro_f1: 23.2%
******* Domain 2 best val acc:      66.1%, epoch: 13 *******
******* Domain 2 best val test acc: 52.6%, epoch: 13 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [15/50] batch [20/319] time 0.078 (0.163) data 0.000 (0.081) loss 2.6904 (2.2832) ce_loss 1.5420 (1.0910) loss_zs_kd 1.5822 (1.5476) loss_oracle 0.8312 (0.7411) acc 43.7500 (60.0000) kd_loss 0.7328 (0.8217) lr 1.6845e-03 eta 0:31:11
epoch [15/50] batch [40/319] time 0.074 (0.122) data 0.000 (0.041) loss 2.1379 (2.2533) ce_loss 0.9009 (1.0618) loss_zs_kd 1.5479 (1.5878) loss_oracle 0.6698 (0.7259) acc 68.7500 (60.8594) kd_loss 0.9021 (0.8286) lr 1.6845e-03 eta 0:23:18
epoch [15/50] batch [60/319] time 0.077 (0.109) data 0.000 (0.027) loss 2.2402 (2.2436) ce_loss 1.1279 (1.0570) loss_zs_kd 1.8952 (1.6431) loss_oracle 0.7429 (0.7249) acc 46.8750 (60.3125) kd_loss 0.7408 (0.8242) lr 1.6845e-03 eta 0:20:40
epoch [15/50] batch [80/319] time 0.084 (0.102) data 0.000 (0.020) loss 1.9704 (2.2268) ce_loss 0.7979 (1.0543) loss_zs_kd 1.5910 (1.6346) loss_oracle 0.8788 (0.7236) acc 75.0000 (60.7812) kd_loss 0.7331 (0.8107) lr 1.6845e-03 eta 0:19:22
epoch [15/50] batch [100/319] time 0.085 (0.097) data 0.000 (0.016) loss 2.0845 (2.2118) ce_loss 0.9341 (1.0468) loss_zs_kd 1.3706 (1.6241) loss_oracle 0.7190 (0.7146) acc 71.8750 (61.3125) kd_loss 0.7909 (0.8077) lr 1.6845e-03 eta 0:18:29
epoch [15/50] batch [120/319] time 0.084 (0.095) data 0.000 (0.014) loss 2.1070 (2.2138) ce_loss 0.9458 (1.0542) loss_zs_kd 1.5776 (1.5975) loss_oracle 0.6777 (0.7107) acc 65.6250 (61.3542) kd_loss 0.8224 (0.8042) lr 1.6845e-03 eta 0:17:58
epoch [15/50] batch [140/319] time 0.080 (0.093) data 0.000 (0.012) loss 2.3916 (2.2151) ce_loss 1.1543 (1.0531) loss_zs_kd 2.1128 (1.6097) loss_oracle 0.7950 (0.7140) acc 46.8750 (61.4732) kd_loss 0.8398 (0.8050) lr 1.6845e-03 eta 0:17:35
epoch [15/50] batch [160/319] time 0.093 (0.092) data 0.001 (0.010) loss 1.8839 (2.2024) ce_loss 0.9087 (1.0421) loss_zs_kd 1.4935 (1.6126) loss_oracle 0.6141 (0.7135) acc 78.1250 (61.7578) kd_loss 0.6682 (0.8036) lr 1.6845e-03 eta 0:17:23
epoch [15/50] batch [180/319] time 0.082 (0.091) data 0.000 (0.009) loss 2.5052 (2.1927) ce_loss 1.1826 (1.0314) loss_zs_kd 1.3445 (1.6047) loss_oracle 0.8012 (0.7117) acc 56.2500 (62.1354) kd_loss 0.9220 (0.8054) lr 1.6845e-03 eta 0:17:13
epoch [15/50] batch [200/319] time 0.085 (0.091) data 0.000 (0.008) loss 2.5072 (2.2065) ce_loss 1.3887 (1.0434) loss_zs_kd 1.6324 (1.6125) loss_oracle 0.7317 (0.7155) acc 50.0000 (61.7188) kd_loss 0.7527 (0.8054) lr 1.6845e-03 eta 0:17:03
epoch [15/50] batch [220/319] time 0.071 (0.090) data 0.000 (0.008) loss 2.2649 (2.2124) ce_loss 1.2617 (1.0474) loss_zs_kd 1.5907 (1.6130) loss_oracle 0.5983 (0.7142) acc 53.1250 (61.3636) kd_loss 0.7040 (0.8079) lr 1.6845e-03 eta 0:16:53
epoch [15/50] batch [240/319] time 0.084 (0.089) data 0.000 (0.007) loss 2.1245 (2.2124) ce_loss 0.9136 (1.0454) loss_zs_kd 1.7669 (1.6102) loss_oracle 0.6698 (0.7141) acc 71.8750 (61.5885) kd_loss 0.8760 (0.8099) lr 1.6845e-03 eta 0:16:44
epoch [15/50] batch [260/319] time 0.081 (0.089) data 0.000 (0.006) loss 2.2446 (2.2180) ce_loss 1.0840 (1.0505) loss_zs_kd 1.5965 (1.6178) loss_oracle 0.6602 (0.7122) acc 46.8750 (61.2861) kd_loss 0.8305 (0.8114) lr 1.6845e-03 eta 0:16:38
epoch [15/50] batch [280/319] time 0.083 (0.088) data 0.000 (0.006) loss 2.2511 (2.2237) ce_loss 0.9360 (1.0553) loss_zs_kd 1.5655 (1.6188) loss_oracle 0.7216 (0.7125) acc 68.7500 (61.0826) kd_loss 0.9543 (0.8121) lr 1.6845e-03 eta 0:16:30
epoch [15/50] batch [300/319] time 0.085 (0.088) data 0.000 (0.006) loss 2.4003 (2.2230) ce_loss 1.1543 (1.0528) loss_zs_kd 1.5984 (1.6133) loss_oracle 0.7632 (0.7142) acc 53.1250 (61.2604) kd_loss 0.8644 (0.8131) lr 1.6845e-03 eta 0:16:26
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,938
* accuracy: 67.1%
* error: 32.9%
* macro_f1: 58.6%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,357
* accuracy: 55.0%
* error: 45.0%
* macro_f1: 24.2%
******* Domain 2 best val acc:      67.1%, epoch: 15 *******
******* Domain 2 best val test acc: 55.0%, epoch: 15 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [16/50] batch [20/319] time 0.085 (0.144) data 0.000 (0.062) loss 1.8796 (2.2159) ce_loss 0.7749 (1.0505) loss_zs_kd 1.4604 (1.6381) loss_oracle 0.6029 (0.7228) acc 71.8750 (60.7812) kd_loss 0.8033 (0.8039) lr 1.6374e-03 eta 0:26:47
epoch [16/50] batch [40/319] time 0.097 (0.116) data 0.000 (0.031) loss 2.3354 (2.2014) ce_loss 1.1641 (1.0360) loss_zs_kd 1.4920 (1.5918) loss_oracle 0.7624 (0.7141) acc 59.3750 (61.4062) kd_loss 0.7902 (0.8084) lr 1.6374e-03 eta 0:21:27
epoch [16/50] batch [60/319] time 0.078 (0.105) data 0.000 (0.021) loss 1.8397 (2.1978) ce_loss 0.7720 (1.0351) loss_zs_kd 1.5736 (1.6105) loss_oracle 0.7403 (0.7104) acc 68.7500 (61.0938) kd_loss 0.6976 (0.8075) lr 1.6374e-03 eta 0:19:24
epoch [16/50] batch [80/319] time 0.088 (0.100) data 0.000 (0.016) loss 2.1264 (2.1968) ce_loss 0.9829 (1.0377) loss_zs_kd 1.5678 (1.5775) loss_oracle 0.7342 (0.7077) acc 62.5000 (61.4062) kd_loss 0.7764 (0.8053) lr 1.6374e-03 eta 0:18:29
epoch [16/50] batch [100/319] time 0.076 (0.097) data 0.000 (0.013) loss 2.2380 (2.2011) ce_loss 1.0996 (1.0416) loss_zs_kd 1.3378 (1.5857) loss_oracle 0.7385 (0.7135) acc 56.2500 (60.8438) kd_loss 0.7691 (0.8027) lr 1.6374e-03 eta 0:17:58
epoch [16/50] batch [120/319] time 0.093 (0.095) data 0.001 (0.011) loss 2.0096 (2.1894) ce_loss 0.8623 (1.0345) loss_zs_kd 1.8836 (1.5813) loss_oracle 0.6253 (0.7081) acc 59.3750 (61.4583) kd_loss 0.8347 (0.8009) lr 1.6374e-03 eta 0:17:32
epoch [16/50] batch [140/319] time 0.089 (0.094) data 0.000 (0.009) loss 1.7940 (2.2043) ce_loss 0.7959 (1.0469) loss_zs_kd 1.9058 (1.5904) loss_oracle 0.6708 (0.7097) acc 75.0000 (61.0045) kd_loss 0.6627 (0.8026) lr 1.6374e-03 eta 0:17:18
epoch [16/50] batch [160/319] time 0.084 (0.093) data 0.000 (0.008) loss 1.9349 (2.2164) ce_loss 0.8179 (1.0553) loss_zs_kd 1.6832 (1.6011) loss_oracle 0.7014 (0.7096) acc 68.7500 (60.7227) kd_loss 0.7663 (0.8063) lr 1.6374e-03 eta 0:17:07
epoch [16/50] batch [180/319] time 0.084 (0.092) data 0.000 (0.007) loss 2.1856 (2.2085) ce_loss 0.9336 (1.0486) loss_zs_kd 1.5818 (1.5990) loss_oracle 0.6621 (0.7104) acc 71.8750 (61.2153) kd_loss 0.9210 (0.8048) lr 1.6374e-03 eta 0:16:53
epoch [16/50] batch [200/319] time 0.076 (0.091) data 0.000 (0.007) loss 2.2515 (2.2072) ce_loss 1.0205 (1.0483) loss_zs_kd 1.3769 (1.5976) loss_oracle 0.7110 (0.7074) acc 68.7500 (61.0781) kd_loss 0.8755 (0.8051) lr 1.6374e-03 eta 0:16:36
epoch [16/50] batch [220/319] time 0.084 (0.090) data 0.000 (0.006) loss 2.1844 (2.2067) ce_loss 0.8716 (1.0490) loss_zs_kd 1.5506 (1.6006) loss_oracle 0.8212 (0.7068) acc 62.5000 (60.9233) kd_loss 0.9022 (0.8042) lr 1.6374e-03 eta 0:16:24
epoch [16/50] batch [240/319] time 0.092 (0.090) data 0.001 (0.005) loss 2.0092 (2.2078) ce_loss 0.9390 (1.0510) loss_zs_kd 2.0876 (1.6136) loss_oracle 0.7094 (0.7063) acc 65.6250 (60.9115) kd_loss 0.7155 (0.8036) lr 1.6374e-03 eta 0:16:18
epoch [16/50] batch [260/319] time 0.094 (0.089) data 0.000 (0.005) loss 1.9631 (2.2101) ce_loss 0.8037 (1.0530) loss_zs_kd 1.5915 (1.6124) loss_oracle 0.7104 (0.7060) acc 68.7500 (60.8293) kd_loss 0.8042 (0.8041) lr 1.6374e-03 eta 0:16:13
epoch [16/50] batch [280/319] time 0.086 (0.089) data 0.000 (0.005) loss 2.5071 (2.2142) ce_loss 1.2832 (1.0561) loss_zs_kd 1.4038 (1.6052) loss_oracle 0.7538 (0.7058) acc 46.8750 (60.6920) kd_loss 0.8470 (0.8051) lr 1.6374e-03 eta 0:16:09
epoch [16/50] batch [300/319] time 0.089 (0.089) data 0.000 (0.004) loss 2.2189 (2.2143) ce_loss 1.0537 (1.0546) loss_zs_kd 1.6136 (1.6053) loss_oracle 0.7418 (0.7066) acc 65.6250 (60.7812) kd_loss 0.7943 (0.8064) lr 1.6374e-03 eta 0:16:05
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,841
* accuracy: 64.9%
* error: 35.1%
* macro_f1: 57.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,078
* accuracy: 52.2%
* error: 47.8%
* macro_f1: 22.4%
******* Domain 2 best val acc:      67.1%, epoch: 15 *******
******* Domain 2 best val test acc: 55.0%, epoch: 15 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [17/50] batch [20/319] time 0.083 (0.189) data 0.000 (0.096) loss 2.0067 (2.1469) ce_loss 0.8267 (0.9809) loss_zs_kd 1.9350 (1.6140) loss_oracle 0.6570 (0.6770) acc 71.8750 (61.5625) kd_loss 0.8515 (0.8275) lr 1.5878e-03 eta 0:34:01
epoch [17/50] batch [40/319] time 0.076 (0.135) data 0.000 (0.048) loss 2.1218 (2.1628) ce_loss 1.0137 (1.0170) loss_zs_kd 1.6074 (1.6654) loss_oracle 0.6894 (0.6960) acc 53.1250 (61.4062) kd_loss 0.7634 (0.7978) lr 1.5878e-03 eta 0:24:17
epoch [17/50] batch [60/319] time 0.088 (0.117) data 0.000 (0.032) loss 2.3655 (2.1756) ce_loss 1.3105 (1.0250) loss_zs_kd 1.4138 (1.6128) loss_oracle 0.7010 (0.7041) acc 59.3750 (61.9271) kd_loss 0.7044 (0.7986) lr 1.5878e-03 eta 0:21:00
epoch [17/50] batch [80/319] time 0.085 (0.109) data 0.000 (0.024) loss 2.1529 (2.1792) ce_loss 0.8784 (1.0215) loss_zs_kd 1.7083 (1.5956) loss_oracle 0.7123 (0.7001) acc 62.5000 (61.9531) kd_loss 0.9183 (0.8077) lr 1.5878e-03 eta 0:19:31
epoch [17/50] batch [100/319] time 0.078 (0.103) data 0.000 (0.019) loss 2.2690 (2.1948) ce_loss 1.1025 (1.0370) loss_zs_kd 1.7467 (1.5837) loss_oracle 0.7048 (0.6970) acc 65.6250 (61.2500) kd_loss 0.8141 (0.8093) lr 1.5878e-03 eta 0:18:28
epoch [17/50] batch [120/319] time 0.080 (0.099) data 0.000 (0.016) loss 2.1378 (2.2047) ce_loss 0.9258 (1.0479) loss_zs_kd 1.6340 (1.5798) loss_oracle 0.7719 (0.6977) acc 46.8750 (60.6510) kd_loss 0.8261 (0.8080) lr 1.5878e-03 eta 0:17:40
epoch [17/50] batch [140/319] time 0.089 (0.099) data 0.000 (0.014) loss 2.3265 (2.2056) ce_loss 1.1562 (1.0496) loss_zs_kd 1.6378 (1.5946) loss_oracle 0.7855 (0.6984) acc 50.0000 (60.6920) kd_loss 0.7775 (0.8067) lr 1.5878e-03 eta 0:17:36
epoch [17/50] batch [160/319] time 0.084 (0.097) data 0.000 (0.012) loss 1.8522 (2.2034) ce_loss 0.7490 (1.0441) loss_zs_kd 1.7114 (1.5941) loss_oracle 0.7059 (0.7032) acc 68.7500 (60.8984) kd_loss 0.7502 (0.8077) lr 1.5878e-03 eta 0:17:14
epoch [17/50] batch [180/319] time 0.084 (0.096) data 0.000 (0.011) loss 2.0087 (2.2027) ce_loss 0.9067 (1.0446) loss_zs_kd 1.8309 (1.6038) loss_oracle 0.6968 (0.7072) acc 56.2500 (61.0069) kd_loss 0.7536 (0.8046) lr 1.5878e-03 eta 0:16:59
epoch [17/50] batch [200/319] time 0.079 (0.094) data 0.000 (0.010) loss 1.8117 (2.1996) ce_loss 0.7573 (1.0449) loss_zs_kd 1.6900 (1.6095) loss_oracle 0.6737 (0.7048) acc 71.8750 (61.0156) kd_loss 0.7175 (0.8023) lr 1.5878e-03 eta 0:16:45
epoch [17/50] batch [220/319] time 0.084 (0.093) data 0.000 (0.009) loss 1.9882 (2.2083) ce_loss 0.9302 (1.0524) loss_zs_kd 2.0895 (1.6176) loss_oracle 0.6495 (0.7049) acc 59.3750 (60.6250) kd_loss 0.7332 (0.8034) lr 1.5878e-03 eta 0:16:32
epoch [17/50] batch [240/319] time 0.095 (0.093) data 0.000 (0.008) loss 2.3068 (2.2083) ce_loss 1.0918 (1.0524) loss_zs_kd 1.9036 (1.6163) loss_oracle 0.7970 (0.7046) acc 59.3750 (60.4948) kd_loss 0.8165 (0.8036) lr 1.5878e-03 eta 0:16:22
epoch [17/50] batch [260/319] time 0.086 (0.092) data 0.000 (0.008) loss 2.3405 (2.2121) ce_loss 1.0322 (1.0530) loss_zs_kd 1.6700 (1.6215) loss_oracle 0.8011 (0.7078) acc 65.6250 (60.2284) kd_loss 0.9077 (0.8052) lr 1.5878e-03 eta 0:16:11
epoch [17/50] batch [280/319] time 0.082 (0.091) data 0.000 (0.007) loss 2.0258 (2.2115) ce_loss 0.7720 (1.0522) loss_zs_kd 1.8813 (1.6212) loss_oracle 0.6681 (0.7088) acc 62.5000 (60.1116) kd_loss 0.9198 (0.8049) lr 1.5878e-03 eta 0:16:02
epoch [17/50] batch [300/319] time 0.076 (0.091) data 0.000 (0.007) loss 2.2225 (2.2086) ce_loss 1.1592 (1.0518) loss_zs_kd 1.7604 (1.6273) loss_oracle 0.6211 (0.7078) acc 56.2500 (60.1354) kd_loss 0.7528 (0.8029) lr 1.5878e-03 eta 0:15:56
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,849
* accuracy: 65.1%
* error: 34.9%
* macro_f1: 57.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,810
* accuracy: 49.4%
* error: 50.6%
* macro_f1: 23.6%
******* Domain 2 best val acc:      67.1%, epoch: 15 *******
******* Domain 2 best val test acc: 55.0%, epoch: 15 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [18/50] batch [20/319] time 0.081 (0.166) data 0.000 (0.081) loss 2.2313 (2.1884) ce_loss 0.9531 (1.0365) loss_zs_kd 1.5383 (1.6495) loss_oracle 0.7461 (0.7159) acc 62.5000 (59.8438) kd_loss 0.9051 (0.7939) lr 1.5358e-03 eta 0:29:02
epoch [18/50] batch [40/319] time 0.078 (0.124) data 0.000 (0.041) loss 2.0317 (2.1618) ce_loss 0.8579 (1.0393) loss_zs_kd 1.7370 (1.6485) loss_oracle 0.6649 (0.6961) acc 56.2500 (60.4688) kd_loss 0.8413 (0.7745) lr 1.5358e-03 eta 0:21:44
epoch [18/50] batch [60/319] time 0.077 (0.110) data 0.000 (0.027) loss 2.1851 (2.1526) ce_loss 1.0986 (1.0214) loss_zs_kd 1.7582 (1.6679) loss_oracle 0.6896 (0.6989) acc 56.2500 (61.4062) kd_loss 0.7416 (0.7817) lr 1.5358e-03 eta 0:19:11
epoch [18/50] batch [80/319] time 0.088 (0.103) data 0.000 (0.020) loss 2.0394 (2.1631) ce_loss 0.8066 (1.0288) loss_zs_kd 1.6922 (1.6703) loss_oracle 0.7367 (0.7042) acc 68.7500 (60.9375) kd_loss 0.8644 (0.7821) lr 1.5358e-03 eta 0:17:55
epoch [18/50] batch [100/319] time 0.085 (0.099) data 0.000 (0.016) loss 1.8254 (2.1724) ce_loss 0.7612 (1.0327) loss_zs_kd 1.7033 (1.6750) loss_oracle 0.6844 (0.7096) acc 68.7500 (61.0625) kd_loss 0.7220 (0.7849) lr 1.5358e-03 eta 0:17:16
epoch [18/50] batch [120/319] time 0.080 (0.097) data 0.000 (0.014) loss 2.1185 (2.1803) ce_loss 1.0771 (1.0416) loss_zs_kd 2.1304 (1.6854) loss_oracle 0.6680 (0.7117) acc 56.2500 (61.2240) kd_loss 0.7073 (0.7828) lr 1.5358e-03 eta 0:16:46
epoch [18/50] batch [140/319] time 0.081 (0.094) data 0.000 (0.012) loss 2.0036 (2.1803) ce_loss 0.8462 (1.0402) loss_zs_kd 1.5216 (1.6770) loss_oracle 0.7918 (0.7127) acc 71.8750 (61.2500) kd_loss 0.7616 (0.7837) lr 1.5358e-03 eta 0:16:21
epoch [18/50] batch [160/319] time 0.079 (0.093) data 0.000 (0.010) loss 2.2722 (2.1884) ce_loss 1.1396 (1.0477) loss_zs_kd 1.6687 (1.6555) loss_oracle 0.7037 (0.7134) acc 50.0000 (60.8398) kd_loss 0.7807 (0.7840) lr 1.5358e-03 eta 0:15:59
epoch [18/50] batch [180/319] time 0.083 (0.091) data 0.000 (0.009) loss 2.2556 (2.1876) ce_loss 1.1484 (1.0473) loss_zs_kd 1.5915 (1.6453) loss_oracle 0.8290 (0.7121) acc 56.2500 (60.9375) kd_loss 0.6927 (0.7843) lr 1.5358e-03 eta 0:15:41
epoch [18/50] batch [200/319] time 0.082 (0.090) data 0.000 (0.008) loss 2.3600 (2.1935) ce_loss 1.0352 (1.0490) loss_zs_kd 1.6629 (1.6427) loss_oracle 0.8281 (0.7131) acc 68.7500 (60.9219) kd_loss 0.9108 (0.7880) lr 1.5358e-03 eta 0:15:32
epoch [18/50] batch [220/319] time 0.083 (0.090) data 0.000 (0.008) loss 2.4923 (2.2000) ce_loss 1.2334 (1.0522) loss_zs_kd 1.7348 (1.6465) loss_oracle 0.7897 (0.7160) acc 53.1250 (60.7812) kd_loss 0.8640 (0.7897) lr 1.5358e-03 eta 0:15:26
epoch [18/50] batch [240/319] time 0.085 (0.089) data 0.000 (0.007) loss 2.0609 (2.1979) ce_loss 0.9785 (1.0501) loss_zs_kd 1.5177 (1.6440) loss_oracle 0.7257 (0.7164) acc 56.2500 (60.6771) kd_loss 0.7195 (0.7896) lr 1.5358e-03 eta 0:15:19
epoch [18/50] batch [260/319] time 0.078 (0.089) data 0.000 (0.006) loss 2.1753 (2.1952) ce_loss 1.1064 (1.0484) loss_zs_kd 1.8455 (1.6506) loss_oracle 0.7449 (0.7165) acc 50.0000 (60.6971) kd_loss 0.6964 (0.7886) lr 1.5358e-03 eta 0:15:12
epoch [18/50] batch [280/319] time 0.091 (0.089) data 0.000 (0.006) loss 2.2272 (2.1982) ce_loss 1.0889 (1.0515) loss_zs_kd 1.5784 (1.6491) loss_oracle 0.7361 (0.7180) acc 56.2500 (60.5804) kd_loss 0.7703 (0.7877) lr 1.5358e-03 eta 0:15:08
epoch [18/50] batch [300/319] time 0.080 (0.088) data 0.000 (0.006) loss 2.0487 (2.2029) ce_loss 0.8228 (1.0545) loss_zs_kd 1.7340 (1.6497) loss_oracle 0.7094 (0.7180) acc 62.5000 (60.3854) kd_loss 0.8712 (0.7895) lr 1.5358e-03 eta 0:15:01
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,930
* accuracy: 66.9%
* error: 33.1%
* macro_f1: 58.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,091
* accuracy: 52.3%
* error: 47.7%
* macro_f1: 22.3%
******* Domain 2 best val acc:      67.1%, epoch: 15 *******
******* Domain 2 best val test acc: 55.0%, epoch: 15 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [19/50] batch [20/319] time 0.090 (0.188) data 0.000 (0.097) loss 1.9753 (2.1861) ce_loss 0.8594 (1.0140) loss_zs_kd 1.4596 (1.6214) loss_oracle 0.6473 (0.7080) acc 65.6250 (60.9375) kd_loss 0.7922 (0.8181) lr 1.4818e-03 eta 0:31:59
epoch [19/50] batch [40/319] time 0.096 (0.137) data 0.000 (0.049) loss 2.1273 (2.1959) ce_loss 1.0088 (1.0285) loss_zs_kd 1.5392 (1.6031) loss_oracle 0.6813 (0.7176) acc 62.5000 (60.1562) kd_loss 0.7779 (0.8085) lr 1.4818e-03 eta 0:23:14
epoch [19/50] batch [60/319] time 0.078 (0.119) data 0.000 (0.033) loss 2.3633 (2.2044) ce_loss 1.0684 (1.0376) loss_zs_kd 1.3150 (1.6072) loss_oracle 0.7274 (0.7209) acc 56.2500 (60.1562) kd_loss 0.9313 (0.8064) lr 1.4818e-03 eta 0:20:07
epoch [19/50] batch [80/319] time 0.084 (0.111) data 0.000 (0.025) loss 2.4479 (2.2100) ce_loss 1.3125 (1.0449) loss_zs_kd 1.7965 (1.5794) loss_oracle 0.7679 (0.7197) acc 40.6250 (60.3125) kd_loss 0.7515 (0.8053) lr 1.4818e-03 eta 0:18:40
epoch [19/50] batch [100/319] time 0.077 (0.105) data 0.000 (0.020) loss 2.0683 (2.2082) ce_loss 1.0713 (1.0500) loss_zs_kd 1.6881 (1.5795) loss_oracle 0.6820 (0.7147) acc 56.2500 (60.4688) kd_loss 0.6560 (0.8009) lr 1.4818e-03 eta 0:17:42
epoch [19/50] batch [120/319] time 0.087 (0.102) data 0.000 (0.016) loss 2.3628 (2.1913) ce_loss 1.2529 (1.0437) loss_zs_kd 1.4054 (1.5927) loss_oracle 0.6497 (0.7085) acc 46.8750 (60.6250) kd_loss 0.7850 (0.7933) lr 1.4818e-03 eta 0:17:04
epoch [19/50] batch [140/319] time 0.091 (0.099) data 0.000 (0.014) loss 2.1317 (2.1887) ce_loss 0.9551 (1.0438) loss_zs_kd 1.6142 (1.5890) loss_oracle 0.7236 (0.7046) acc 59.3750 (60.7366) kd_loss 0.8148 (0.7926) lr 1.4818e-03 eta 0:16:32
epoch [19/50] batch [160/319] time 0.090 (0.097) data 0.000 (0.012) loss 2.1176 (2.1836) ce_loss 1.0205 (1.0389) loss_zs_kd 1.4679 (1.5938) loss_oracle 0.7692 (0.7082) acc 50.0000 (60.8398) kd_loss 0.7125 (0.7906) lr 1.4818e-03 eta 0:16:10
epoch [19/50] batch [180/319] time 0.083 (0.095) data 0.000 (0.011) loss 1.9564 (2.1766) ce_loss 0.9775 (1.0343) loss_zs_kd 1.4003 (1.5849) loss_oracle 0.6243 (0.7079) acc 71.8750 (61.2674) kd_loss 0.6667 (0.7884) lr 1.4818e-03 eta 0:15:56
epoch [19/50] batch [200/319] time 0.083 (0.094) data 0.000 (0.010) loss 2.1128 (2.1732) ce_loss 0.9878 (1.0324) loss_zs_kd 1.5183 (1.5845) loss_oracle 0.6891 (0.7072) acc 62.5000 (61.5312) kd_loss 0.7804 (0.7872) lr 1.4818e-03 eta 0:15:44
epoch [19/50] batch [220/319] time 0.079 (0.093) data 0.000 (0.009) loss 2.2931 (2.1691) ce_loss 1.1270 (1.0274) loss_zs_kd 1.5481 (1.5843) loss_oracle 0.7061 (0.7058) acc 59.3750 (61.7330) kd_loss 0.8132 (0.7888) lr 1.4818e-03 eta 0:15:33
epoch [19/50] batch [240/319] time 0.088 (0.093) data 0.000 (0.008) loss 2.3957 (2.1692) ce_loss 1.1719 (1.0278) loss_zs_kd 1.5333 (1.5835) loss_oracle 0.7629 (0.7039) acc 59.3750 (61.6667) kd_loss 0.8424 (0.7895) lr 1.4818e-03 eta 0:15:24
epoch [19/50] batch [260/319] time 0.083 (0.092) data 0.000 (0.008) loss 2.5639 (2.1723) ce_loss 1.2070 (1.0296) loss_zs_kd 1.6135 (1.5869) loss_oracle 0.7969 (0.7060) acc 65.6250 (61.6466) kd_loss 0.9585 (0.7897) lr 1.4818e-03 eta 0:15:17
epoch [19/50] batch [280/319] time 0.083 (0.092) data 0.000 (0.007) loss 2.1506 (2.1719) ce_loss 0.9346 (1.0288) loss_zs_kd 1.4557 (1.5878) loss_oracle 0.7012 (0.7074) acc 65.6250 (61.7076) kd_loss 0.8654 (0.7894) lr 1.4818e-03 eta 0:15:11
epoch [19/50] batch [300/319] time 0.085 (0.091) data 0.000 (0.007) loss 2.4141 (2.1743) ce_loss 1.2197 (1.0306) loss_zs_kd 1.6604 (1.5988) loss_oracle 0.6669 (0.7071) acc 43.7500 (61.6667) kd_loss 0.8609 (0.7901) lr 1.4818e-03 eta 0:15:04
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,842
* accuracy: 64.9%
* error: 35.1%
* macro_f1: 59.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,358
* accuracy: 55.0%
* error: 45.0%
* macro_f1: 24.3%
******* Domain 2 best val acc:      67.1%, epoch: 15 *******
******* Domain 2 best val test acc: 55.0%, epoch: 15 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [20/50] batch [20/319] time 0.076 (0.190) data 0.000 (0.106) loss 2.1943 (2.1855) ce_loss 1.0244 (1.0293) loss_zs_kd 1.7496 (1.7532) loss_oracle 0.6782 (0.7213) acc 59.3750 (61.4062) kd_loss 0.8308 (0.7955) lr 1.4258e-03 eta 0:31:11
epoch [20/50] batch [40/319] time 0.077 (0.134) data 0.000 (0.053) loss 2.1929 (2.1803) ce_loss 0.9790 (1.0225) loss_zs_kd 1.3399 (1.6779) loss_oracle 0.6760 (0.7056) acc 53.1250 (62.2656) kd_loss 0.8759 (0.8050) lr 1.4258e-03 eta 0:21:55
epoch [20/50] batch [60/319] time 0.078 (0.116) data 0.000 (0.036) loss 1.9357 (2.2106) ce_loss 0.8135 (1.0489) loss_zs_kd 1.3037 (1.6312) loss_oracle 0.7005 (0.7143) acc 68.7500 (61.5104) kd_loss 0.7719 (0.8046) lr 1.4258e-03 eta 0:18:58
epoch [20/50] batch [80/319] time 0.082 (0.109) data 0.000 (0.027) loss 1.9148 (2.2013) ce_loss 0.8579 (1.0376) loss_zs_kd 1.8969 (1.6433) loss_oracle 0.6424 (0.7162) acc 75.0000 (61.9531) kd_loss 0.7357 (0.8056) lr 1.4258e-03 eta 0:17:50
epoch [20/50] batch [100/319] time 0.081 (0.104) data 0.000 (0.021) loss 2.0624 (2.1898) ce_loss 0.9360 (1.0323) loss_zs_kd 1.6801 (1.6410) loss_oracle 0.7126 (0.7143) acc 65.6250 (62.1250) kd_loss 0.7701 (0.8003) lr 1.4258e-03 eta 0:16:58
epoch [20/50] batch [120/319] time 0.077 (0.100) data 0.000 (0.018) loss 2.1938 (2.1808) ce_loss 1.0645 (1.0256) loss_zs_kd 1.6596 (1.6433) loss_oracle 0.7102 (0.7123) acc 46.8750 (61.9271) kd_loss 0.7743 (0.7990) lr 1.4258e-03 eta 0:16:17
epoch [20/50] batch [140/319] time 0.083 (0.098) data 0.000 (0.015) loss 2.0224 (2.1727) ce_loss 0.9648 (1.0257) loss_zs_kd 1.6644 (1.6594) loss_oracle 0.5763 (0.7067) acc 65.6250 (62.1205) kd_loss 0.7694 (0.7937) lr 1.4258e-03 eta 0:15:51
epoch [20/50] batch [160/319] time 0.086 (0.096) data 0.000 (0.014) loss 1.8845 (2.1712) ce_loss 0.9150 (1.0255) loss_zs_kd 1.7432 (1.6578) loss_oracle 0.7114 (0.7046) acc 68.7500 (61.9922) kd_loss 0.6138 (0.7933) lr 1.4258e-03 eta 0:15:35
epoch [20/50] batch [180/319] time 0.078 (0.095) data 0.000 (0.012) loss 2.5636 (2.1807) ce_loss 1.1885 (1.0326) loss_zs_kd 1.6462 (1.6447) loss_oracle 0.8267 (0.7059) acc 46.8750 (61.5972) kd_loss 0.9618 (0.7951) lr 1.4258e-03 eta 0:15:21
epoch [20/50] batch [200/319] time 0.082 (0.094) data 0.000 (0.011) loss 2.2623 (2.1809) ce_loss 1.0674 (1.0313) loss_zs_kd 1.8426 (1.6390) loss_oracle 0.7975 (0.7115) acc 68.7500 (61.4219) kd_loss 0.7962 (0.7939) lr 1.4258e-03 eta 0:15:06
epoch [20/50] batch [220/319] time 0.080 (0.093) data 0.000 (0.010) loss 2.1784 (2.1804) ce_loss 1.0596 (1.0304) loss_zs_kd 1.6082 (1.6392) loss_oracle 0.7173 (0.7121) acc 68.7500 (61.6051) kd_loss 0.7602 (0.7939) lr 1.4258e-03 eta 0:14:56
epoch [20/50] batch [240/319] time 0.080 (0.092) data 0.000 (0.009) loss 2.4701 (2.1849) ce_loss 1.1279 (1.0336) loss_zs_kd 1.5312 (1.6386) loss_oracle 0.8100 (0.7129) acc 59.3750 (61.6276) kd_loss 0.9372 (0.7948) lr 1.4258e-03 eta 0:14:44
epoch [20/50] batch [260/319] time 0.084 (0.091) data 0.000 (0.008) loss 2.1879 (2.1804) ce_loss 1.0254 (1.0291) loss_zs_kd 1.3197 (1.6336) loss_oracle 0.5995 (0.7116) acc 56.2500 (61.8389) kd_loss 0.8627 (0.7955) lr 1.4258e-03 eta 0:14:38
epoch [20/50] batch [280/319] time 0.088 (0.091) data 0.000 (0.008) loss 2.1893 (2.1856) ce_loss 1.0713 (1.0311) loss_zs_kd 1.7637 (1.6305) loss_oracle 0.8400 (0.7125) acc 68.7500 (61.7188) kd_loss 0.6980 (0.7982) lr 1.4258e-03 eta 0:14:34
epoch [20/50] batch [300/319] time 0.076 (0.090) data 0.000 (0.007) loss 2.0711 (2.1878) ce_loss 0.9980 (1.0338) loss_zs_kd 2.0114 (1.6321) loss_oracle 0.6728 (0.7126) acc 62.5000 (61.6875) kd_loss 0.7367 (0.7976) lr 1.4258e-03 eta 0:14:27
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,868
* accuracy: 65.5%
* error: 34.5%
* macro_f1: 58.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,355
* accuracy: 55.0%
* error: 45.0%
* macro_f1: 24.7%
******* Domain 2 best val acc:      67.1%, epoch: 15 *******
******* Domain 2 best val test acc: 55.0%, epoch: 15 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [21/50] batch [20/319] time 0.086 (0.174) data 0.000 (0.087) loss 2.2663 (2.1319) ce_loss 1.0742 (0.9803) loss_zs_kd 1.8557 (1.7392) loss_oracle 0.7044 (0.7023) acc 56.2500 (63.9062) kd_loss 0.8399 (0.8005) lr 1.3681e-03 eta 0:27:45
epoch [21/50] batch [40/319] time 0.081 (0.127) data 0.000 (0.044) loss 2.2061 (2.1611) ce_loss 1.1416 (1.0220) loss_zs_kd 1.4323 (1.6771) loss_oracle 0.6278 (0.6881) acc 59.3750 (62.3438) kd_loss 0.7506 (0.7950) lr 1.3681e-03 eta 0:20:08
epoch [21/50] batch [60/319] time 0.078 (0.111) data 0.000 (0.029) loss 1.9510 (2.1646) ce_loss 0.8809 (1.0237) loss_zs_kd 2.0498 (1.6963) loss_oracle 0.6662 (0.6963) acc 75.0000 (62.3438) kd_loss 0.7370 (0.7928) lr 1.3681e-03 eta 0:17:35
epoch [21/50] batch [80/319] time 0.074 (0.103) data 0.000 (0.022) loss 1.7981 (2.1636) ce_loss 0.7676 (1.0271) loss_zs_kd 1.4950 (1.7038) loss_oracle 0.7879 (0.7011) acc 81.2500 (61.9531) kd_loss 0.6366 (0.7860) lr 1.3681e-03 eta 0:16:17
epoch [21/50] batch [100/319] time 0.079 (0.098) data 0.000 (0.018) loss 2.0860 (2.1646) ce_loss 0.9507 (1.0303) loss_zs_kd 1.6583 (1.6808) loss_oracle 0.6646 (0.7036) acc 56.2500 (61.6562) kd_loss 0.8030 (0.7824) lr 1.3681e-03 eta 0:15:28
epoch [21/50] batch [120/319] time 0.081 (0.095) data 0.000 (0.015) loss 2.0160 (2.1653) ce_loss 0.9048 (1.0252) loss_zs_kd 1.6001 (1.6811) loss_oracle 0.6031 (0.7132) acc 65.6250 (61.7708) kd_loss 0.8097 (0.7835) lr 1.3681e-03 eta 0:14:57
epoch [21/50] batch [140/319] time 0.084 (0.093) data 0.000 (0.013) loss 2.3265 (2.1609) ce_loss 1.1211 (1.0184) loss_zs_kd 1.7392 (1.6730) loss_oracle 0.8048 (0.7158) acc 56.2500 (62.1875) kd_loss 0.8030 (0.7846) lr 1.3681e-03 eta 0:14:38
epoch [21/50] batch [160/319] time 0.071 (0.091) data 0.000 (0.011) loss 2.1462 (2.1644) ce_loss 1.0078 (1.0237) loss_zs_kd 1.5275 (1.6601) loss_oracle 0.7944 (0.7160) acc 68.7500 (62.0312) kd_loss 0.7411 (0.7826) lr 1.3681e-03 eta 0:14:18
epoch [21/50] batch [180/319] time 0.085 (0.090) data 0.000 (0.010) loss 2.3124 (2.1652) ce_loss 1.0537 (1.0218) loss_zs_kd 1.5583 (1.6516) loss_oracle 0.6711 (0.7159) acc 65.6250 (61.9792) kd_loss 0.9231 (0.7854) lr 1.3681e-03 eta 0:14:08
epoch [21/50] batch [200/319] time 0.072 (0.089) data 0.000 (0.009) loss 2.5154 (2.1710) ce_loss 1.4150 (1.0264) loss_zs_kd 1.7863 (1.6546) loss_oracle 0.6935 (0.7176) acc 53.1250 (61.8281) kd_loss 0.7536 (0.7857) lr 1.3681e-03 eta 0:13:57
epoch [21/50] batch [220/319] time 0.080 (0.088) data 0.000 (0.008) loss 2.2266 (2.1678) ce_loss 0.9385 (1.0256) loss_zs_kd 1.5429 (1.6602) loss_oracle 0.7225 (0.7185) acc 71.8750 (62.1307) kd_loss 0.9269 (0.7830) lr 1.3681e-03 eta 0:13:47
epoch [21/50] batch [240/319] time 0.081 (0.088) data 0.000 (0.008) loss 1.8388 (2.1677) ce_loss 0.8628 (1.0241) loss_zs_kd 1.8419 (1.6640) loss_oracle 0.6179 (0.7185) acc 56.2500 (62.1615) kd_loss 0.6671 (0.7843) lr 1.3681e-03 eta 0:13:40
epoch [21/50] batch [260/319] time 0.088 (0.087) data 0.000 (0.007) loss 2.1379 (2.1808) ce_loss 1.0830 (1.0315) loss_zs_kd 1.8562 (1.6696) loss_oracle 0.6476 (0.7217) acc 53.1250 (61.7188) kd_loss 0.7311 (0.7885) lr 1.3681e-03 eta 0:13:33
epoch [21/50] batch [280/319] time 0.090 (0.087) data 0.000 (0.006) loss 2.0322 (2.1871) ce_loss 0.9238 (1.0342) loss_zs_kd 1.5844 (1.6711) loss_oracle 0.7947 (0.7254) acc 68.7500 (61.5960) kd_loss 0.7111 (0.7901) lr 1.3681e-03 eta 0:13:31
epoch [21/50] batch [300/319] time 0.074 (0.087) data 0.000 (0.006) loss 2.1185 (2.1876) ce_loss 0.8340 (1.0316) loss_zs_kd 1.8549 (1.6719) loss_oracle 0.7429 (0.7276) acc 62.5000 (61.5625) kd_loss 0.9131 (0.7923) lr 1.3681e-03 eta 0:13:27
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,838
* accuracy: 64.8%
* error: 35.2%
* macro_f1: 58.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,152
* accuracy: 52.9%
* error: 47.1%
* macro_f1: 22.7%
******* Domain 2 best val acc:      67.1%, epoch: 15 *******
******* Domain 2 best val test acc: 55.0%, epoch: 15 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [22/50] batch [20/319] time 0.071 (0.192) data 0.000 (0.109) loss 1.9735 (2.1250) ce_loss 0.8760 (0.9990) loss_zs_kd 1.9001 (1.7125) loss_oracle 0.7923 (0.7333) acc 71.8750 (63.4375) kd_loss 0.7013 (0.7593) lr 1.3090e-03 eta 0:29:28
epoch [22/50] batch [40/319] time 0.090 (0.138) data 0.000 (0.055) loss 2.0537 (2.1269) ce_loss 1.0469 (0.9986) loss_zs_kd 1.8144 (1.7512) loss_oracle 0.6353 (0.7181) acc 59.3750 (62.5000) kd_loss 0.6892 (0.7693) lr 1.3090e-03 eta 0:21:07
epoch [22/50] batch [60/319] time 0.080 (0.121) data 0.000 (0.037) loss 2.0999 (2.1576) ce_loss 0.8975 (1.0125) loss_zs_kd 1.6487 (1.7243) loss_oracle 0.7619 (0.7316) acc 68.7500 (61.9792) kd_loss 0.8215 (0.7792) lr 1.3090e-03 eta 0:18:33
epoch [22/50] batch [80/319] time 0.077 (0.111) data 0.000 (0.027) loss 2.5097 (2.1627) ce_loss 1.2686 (1.0106) loss_zs_kd 1.9537 (1.7526) loss_oracle 0.8365 (0.7338) acc 59.3750 (62.3438) kd_loss 0.8229 (0.7852) lr 1.3090e-03 eta 0:16:59
epoch [22/50] batch [100/319] time 0.085 (0.105) data 0.000 (0.022) loss 2.0121 (2.1703) ce_loss 0.8828 (1.0136) loss_zs_kd 1.6235 (1.7439) loss_oracle 0.6916 (0.7342) acc 62.5000 (61.9375) kd_loss 0.7835 (0.7895) lr 1.3090e-03 eta 0:16:05
epoch [22/50] batch [120/319] time 0.081 (0.102) data 0.000 (0.018) loss 2.6568 (2.1682) ce_loss 1.4346 (1.0118) loss_zs_kd 1.7834 (1.7510) loss_oracle 0.7073 (0.7364) acc 43.7500 (62.1094) kd_loss 0.8686 (0.7882) lr 1.3090e-03 eta 0:15:29
epoch [22/50] batch [140/319] time 0.084 (0.099) data 0.000 (0.016) loss 2.2774 (2.1802) ce_loss 1.0488 (1.0174) loss_zs_kd 1.6871 (1.7737) loss_oracle 0.7532 (0.7408) acc 62.5000 (62.1652) kd_loss 0.8520 (0.7923) lr 1.3090e-03 eta 0:15:05
epoch [22/50] batch [160/319] time 0.102 (0.097) data 0.000 (0.014) loss 2.3971 (2.1841) ce_loss 1.1348 (1.0208) loss_zs_kd 1.6349 (1.7639) loss_oracle 0.7615 (0.7417) acc 62.5000 (61.9531) kd_loss 0.8816 (0.7925) lr 1.3090e-03 eta 0:14:45
epoch [22/50] batch [180/319] time 0.078 (0.096) data 0.000 (0.012) loss 2.6026 (2.1798) ce_loss 1.3965 (1.0146) loss_zs_kd 2.0681 (1.7783) loss_oracle 0.8209 (0.7423) acc 46.8750 (62.1354) kd_loss 0.7957 (0.7940) lr 1.3090e-03 eta 0:14:30
epoch [22/50] batch [200/319] time 0.083 (0.095) data 0.000 (0.011) loss 2.1945 (2.1866) ce_loss 1.0977 (1.0196) loss_zs_kd 1.6679 (1.7811) loss_oracle 0.5532 (0.7442) acc 62.5000 (62.2344) kd_loss 0.8203 (0.7949) lr 1.3090e-03 eta 0:14:17
epoch [22/50] batch [220/319] time 0.082 (0.094) data 0.000 (0.010) loss 2.0546 (2.1895) ce_loss 0.7983 (1.0207) loss_zs_kd 1.7061 (1.7791) loss_oracle 0.7868 (0.7456) acc 75.0000 (62.3011) kd_loss 0.8629 (0.7960) lr 1.3090e-03 eta 0:14:06
epoch [22/50] batch [240/319] time 0.083 (0.093) data 0.000 (0.009) loss 2.4732 (2.1889) ce_loss 1.1982 (1.0175) loss_zs_kd 1.8415 (1.7796) loss_oracle 0.7972 (0.7459) acc 59.3750 (62.3568) kd_loss 0.8764 (0.7984) lr 1.3090e-03 eta 0:13:59
epoch [22/50] batch [260/319] time 0.082 (0.092) data 0.000 (0.009) loss 2.1937 (2.1918) ce_loss 1.0225 (1.0224) loss_zs_kd 1.6650 (1.7813) loss_oracle 0.7534 (0.7456) acc 59.3750 (62.1995) kd_loss 0.7946 (0.7966) lr 1.3090e-03 eta 0:13:51
epoch [22/50] batch [280/319] time 0.092 (0.092) data 0.000 (0.008) loss 1.8512 (2.1908) ce_loss 0.6533 (1.0214) loss_zs_kd 1.5056 (1.7698) loss_oracle 0.7339 (0.7460) acc 81.2500 (62.1652) kd_loss 0.8310 (0.7963) lr 1.3090e-03 eta 0:13:45
epoch [22/50] batch [300/319] time 0.087 (0.091) data 0.000 (0.008) loss 2.1139 (2.1929) ce_loss 0.9331 (1.0244) loss_zs_kd 2.0672 (1.7688) loss_oracle 0.8412 (0.7449) acc 68.7500 (62.0729) kd_loss 0.7602 (0.7960) lr 1.3090e-03 eta 0:13:38
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,943
* accuracy: 67.2%
* error: 32.8%
* macro_f1: 59.4%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,362
* accuracy: 55.1%
* error: 44.9%
* macro_f1: 24.7%
******* Domain 2 best val acc:      67.2%, epoch: 22 *******
******* Domain 2 best val test acc: 55.1%, epoch: 22 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [23/50] batch [20/319] time 0.087 (0.216) data 0.000 (0.128) loss 2.5076 (2.1823) ce_loss 1.1416 (1.0333) loss_zs_kd 1.4525 (1.6676) loss_oracle 0.8634 (0.7451) acc 59.3750 (62.5000) kd_loss 0.9342 (0.7764) lr 1.2487e-03 eta 0:32:02
epoch [23/50] batch [40/319] time 0.085 (0.149) data 0.000 (0.064) loss 2.0771 (2.2126) ce_loss 0.8984 (1.0336) loss_zs_kd 1.8264 (1.6382) loss_oracle 0.7146 (0.7754) acc 68.7500 (60.9375) kd_loss 0.8214 (0.7913) lr 1.2487e-03 eta 0:22:07
epoch [23/50] batch [60/319] time 0.085 (0.128) data 0.000 (0.043) loss 2.2377 (2.1792) ce_loss 1.1201 (1.0083) loss_zs_kd 1.7047 (1.6621) loss_oracle 0.9703 (0.7773) acc 62.5000 (61.9271) kd_loss 0.6324 (0.7822) lr 1.2487e-03 eta 0:18:53
epoch [23/50] batch [80/319] time 0.085 (0.117) data 0.000 (0.032) loss 2.0861 (2.1782) ce_loss 0.9365 (1.0093) loss_zs_kd 1.7776 (1.6856) loss_oracle 0.7315 (0.7681) acc 65.6250 (61.9141) kd_loss 0.7838 (0.7848) lr 1.2487e-03 eta 0:17:17
epoch [23/50] batch [100/319] time 0.071 (0.110) data 0.000 (0.026) loss 2.0020 (2.1746) ce_loss 0.8911 (1.0107) loss_zs_kd 1.7237 (1.6844) loss_oracle 0.6405 (0.7665) acc 75.0000 (62.0312) kd_loss 0.7906 (0.7806) lr 1.2487e-03 eta 0:16:11
epoch [23/50] batch [120/319] time 0.078 (0.105) data 0.000 (0.022) loss 2.0862 (2.1668) ce_loss 0.9814 (1.0072) loss_zs_kd 1.5626 (1.6954) loss_oracle 0.7027 (0.7648) acc 65.6250 (62.0573) kd_loss 0.7534 (0.7772) lr 1.2487e-03 eta 0:15:26
epoch [23/50] batch [140/319] time 0.074 (0.102) data 0.000 (0.019) loss 2.0258 (2.1702) ce_loss 0.8716 (1.0100) loss_zs_kd 1.5894 (1.7043) loss_oracle 0.7191 (0.7635) acc 71.8750 (62.2545) kd_loss 0.7947 (0.7785) lr 1.2487e-03 eta 0:14:53
epoch [23/50] batch [160/319] time 0.078 (0.099) data 0.000 (0.016) loss 2.2326 (2.1708) ce_loss 0.9609 (1.0109) loss_zs_kd 1.8344 (1.7111) loss_oracle 0.8780 (0.7627) acc 59.3750 (62.2852) kd_loss 0.8327 (0.7785) lr 1.2487e-03 eta 0:14:26
epoch [23/50] batch [180/319] time 0.085 (0.097) data 0.000 (0.014) loss 2.2110 (2.1762) ce_loss 1.0654 (1.0136) loss_zs_kd 1.6503 (1.7238) loss_oracle 0.7685 (0.7598) acc 56.2500 (62.0312) kd_loss 0.7613 (0.7827) lr 1.2487e-03 eta 0:14:07
epoch [23/50] batch [200/319] time 0.082 (0.096) data 0.000 (0.013) loss 1.7308 (2.1782) ce_loss 0.6240 (1.0147) loss_zs_kd 1.6978 (1.7285) loss_oracle 0.7566 (0.7585) acc 81.2500 (62.3281) kd_loss 0.7285 (0.7843) lr 1.2487e-03 eta 0:13:55
epoch [23/50] batch [220/319] time 0.091 (0.095) data 0.000 (0.012) loss 2.4189 (2.1778) ce_loss 1.3115 (1.0157) loss_zs_kd 1.8678 (1.7399) loss_oracle 0.7444 (0.7584) acc 50.0000 (62.2017) kd_loss 0.7352 (0.7829) lr 1.2487e-03 eta 0:13:44
epoch [23/50] batch [240/319] time 0.081 (0.094) data 0.000 (0.011) loss 2.2217 (2.1849) ce_loss 1.0762 (1.0225) loss_zs_kd 1.7148 (1.7346) loss_oracle 0.7301 (0.7565) acc 62.5000 (62.1224) kd_loss 0.7805 (0.7842) lr 1.2487e-03 eta 0:13:37
epoch [23/50] batch [260/319] time 0.078 (0.093) data 0.000 (0.010) loss 2.3228 (2.1890) ce_loss 1.0264 (1.0262) loss_zs_kd 1.6142 (1.7353) loss_oracle 0.8306 (0.7558) acc 62.5000 (61.8510) kd_loss 0.8811 (0.7849) lr 1.2487e-03 eta 0:13:29
epoch [23/50] batch [280/319] time 0.084 (0.093) data 0.000 (0.009) loss 2.0354 (2.1851) ce_loss 0.8330 (1.0249) loss_zs_kd 1.8788 (1.7382) loss_oracle 0.7304 (0.7536) acc 68.7500 (61.8527) kd_loss 0.8372 (0.7834) lr 1.2487e-03 eta 0:13:22
epoch [23/50] batch [300/319] time 0.084 (0.092) data 0.000 (0.009) loss 2.1354 (2.1821) ce_loss 1.0146 (1.0245) loss_zs_kd 1.7013 (1.7366) loss_oracle 0.8008 (0.7520) acc 59.3750 (61.9062) kd_loss 0.7204 (0.7816) lr 1.2487e-03 eta 0:13:16
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,835
* accuracy: 64.8%
* error: 35.2%
* macro_f1: 58.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,274
* accuracy: 54.2%
* error: 45.8%
* macro_f1: 24.7%
******* Domain 2 best val acc:      67.2%, epoch: 22 *******
******* Domain 2 best val test acc: 55.1%, epoch: 22 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [24/50] batch [20/319] time 0.069 (0.156) data 0.000 (0.078) loss 1.9358 (2.2008) ce_loss 0.8813 (1.0509) loss_zs_kd 1.7612 (1.7829) loss_oracle 0.7005 (0.7030) acc 68.7500 (61.8750) kd_loss 0.7042 (0.7984) lr 1.1874e-03 eta 0:22:24
epoch [24/50] batch [40/319] time 0.081 (0.117) data 0.000 (0.039) loss 2.5406 (2.1782) ce_loss 1.2988 (1.0347) loss_zs_kd 1.6292 (1.7631) loss_oracle 0.8456 (0.7011) acc 50.0000 (61.4062) kd_loss 0.8190 (0.7929) lr 1.1874e-03 eta 0:16:43
epoch [24/50] batch [60/319] time 0.082 (0.105) data 0.000 (0.026) loss 2.1933 (2.2008) ce_loss 1.1084 (1.0557) loss_zs_kd 2.0760 (1.7528) loss_oracle 0.7314 (0.7180) acc 53.1250 (60.8854) kd_loss 0.7192 (0.7861) lr 1.1874e-03 eta 0:14:57
epoch [24/50] batch [80/319] time 0.086 (0.099) data 0.000 (0.020) loss 2.2533 (2.1777) ce_loss 1.1104 (1.0429) loss_zs_kd 1.9843 (1.7595) loss_oracle 0.6907 (0.7142) acc 56.2500 (61.3672) kd_loss 0.7976 (0.7777) lr 1.1874e-03 eta 0:14:08
epoch [24/50] batch [100/319] time 0.086 (0.097) data 0.000 (0.016) loss 2.4763 (2.1798) ce_loss 1.3496 (1.0449) loss_zs_kd 1.9452 (1.7710) loss_oracle 0.7311 (0.7177) acc 46.8750 (61.6562) kd_loss 0.7611 (0.7761) lr 1.1874e-03 eta 0:13:45
epoch [24/50] batch [120/319] time 0.085 (0.097) data 0.000 (0.013) loss 2.2507 (2.1934) ce_loss 1.1074 (1.0526) loss_zs_kd 1.7322 (1.7764) loss_oracle 0.6794 (0.7275) acc 50.0000 (61.1979) kd_loss 0.8036 (0.7771) lr 1.1874e-03 eta 0:13:47
epoch [24/50] batch [140/319] time 0.068 (0.094) data 0.001 (0.011) loss 2.1503 (2.1829) ce_loss 0.9541 (1.0452) loss_zs_kd 1.7814 (1.7606) loss_oracle 0.7549 (0.7277) acc 71.8750 (61.6295) kd_loss 0.8187 (0.7739) lr 1.1874e-03 eta 0:13:17
epoch [24/50] batch [160/319] time 0.069 (0.091) data 0.000 (0.010) loss 2.5041 (2.1752) ce_loss 1.2383 (1.0379) loss_zs_kd 1.5486 (1.7469) loss_oracle 0.9538 (0.7258) acc 53.1250 (61.9336) kd_loss 0.7889 (0.7745) lr 1.1874e-03 eta 0:12:45
epoch [24/50] batch [180/319] time 0.064 (0.088) data 0.000 (0.009) loss 2.0595 (2.1807) ce_loss 1.1523 (1.0396) loss_zs_kd 1.6507 (1.7535) loss_oracle 0.5871 (0.7283) acc 62.5000 (61.6319) kd_loss 0.6136 (0.7770) lr 1.1874e-03 eta 0:12:18
epoch [24/50] batch [200/319] time 0.072 (0.085) data 0.000 (0.008) loss 2.1254 (2.1769) ce_loss 0.9834 (1.0360) loss_zs_kd 1.6621 (1.7484) loss_oracle 0.7857 (0.7306) acc 65.6250 (61.7344) kd_loss 0.7492 (0.7755) lr 1.1874e-03 eta 0:11:57
epoch [24/50] batch [220/319] time 0.066 (0.083) data 0.000 (0.007) loss 2.1961 (2.1780) ce_loss 1.1387 (1.0358) loss_zs_kd 1.6356 (1.7443) loss_oracle 0.7587 (0.7346) acc 59.3750 (61.7614) kd_loss 0.6781 (0.7749) lr 1.1874e-03 eta 0:11:40
epoch [24/50] batch [240/319] time 0.075 (0.082) data 0.000 (0.007) loss 2.4151 (2.1760) ce_loss 1.3115 (1.0319) loss_zs_kd 1.9138 (1.7420) loss_oracle 0.7415 (0.7372) acc 46.8750 (61.7708) kd_loss 0.7329 (0.7755) lr 1.1874e-03 eta 0:11:25
epoch [24/50] batch [260/319] time 0.062 (0.081) data 0.000 (0.006) loss 2.4469 (2.1769) ce_loss 1.2607 (1.0324) loss_zs_kd 1.3991 (1.7348) loss_oracle 0.8013 (0.7375) acc 59.3750 (61.7308) kd_loss 0.7855 (0.7758) lr 1.1874e-03 eta 0:11:12
epoch [24/50] batch [280/319] time 0.068 (0.079) data 0.000 (0.006) loss 2.4931 (2.1743) ce_loss 1.1689 (1.0332) loss_zs_kd 1.6223 (1.7347) loss_oracle 0.7513 (0.7382) acc 43.7500 (61.7076) kd_loss 0.9485 (0.7720) lr 1.1874e-03 eta 0:11:01
epoch [24/50] batch [300/319] time 0.061 (0.078) data 0.000 (0.006) loss 2.0781 (2.1730) ce_loss 1.0166 (1.0314) loss_zs_kd 1.8328 (1.7293) loss_oracle 0.6380 (0.7388) acc 62.5000 (61.8125) kd_loss 0.7425 (0.7723) lr 1.1874e-03 eta 0:10:51
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,881
* accuracy: 65.8%
* error: 34.2%
* macro_f1: 57.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,064
* accuracy: 52.0%
* error: 48.0%
* macro_f1: 23.0%
******* Domain 2 best val acc:      67.2%, epoch: 22 *******
******* Domain 2 best val test acc: 55.1%, epoch: 22 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [25/50] batch [20/319] time 0.064 (0.182) data 0.000 (0.121) loss 2.2830 (2.1944) ce_loss 0.9956 (1.0296) loss_zs_kd 1.6959 (1.6644) loss_oracle 0.8857 (0.7321) acc 65.6250 (62.8125) kd_loss 0.8446 (0.7988) lr 1.1253e-03 eta 0:25:08
epoch [25/50] batch [40/319] time 0.083 (0.131) data 0.000 (0.060) loss 2.5403 (2.2208) ce_loss 1.2812 (1.0461) loss_zs_kd 1.6410 (1.6976) loss_oracle 0.6741 (0.7425) acc 43.7500 (61.5625) kd_loss 0.9220 (0.8035) lr 1.1253e-03 eta 0:18:00
epoch [25/50] batch [60/319] time 0.084 (0.115) data 0.000 (0.040) loss 2.2104 (2.2029) ce_loss 1.0537 (1.0374) loss_zs_kd 1.8558 (1.6853) loss_oracle 0.7137 (0.7345) acc 65.6250 (61.5104) kd_loss 0.7999 (0.7982) lr 1.1253e-03 eta 0:15:43
epoch [25/50] batch [80/319] time 0.080 (0.107) data 0.000 (0.030) loss 2.0777 (2.1973) ce_loss 0.9258 (1.0360) loss_zs_kd 1.7557 (1.6922) loss_oracle 0.7715 (0.7356) acc 65.6250 (61.3281) kd_loss 0.7662 (0.7935) lr 1.1253e-03 eta 0:14:35
epoch [25/50] batch [100/319] time 0.081 (0.101) data 0.000 (0.024) loss 2.3660 (2.1843) ce_loss 1.2705 (1.0283) loss_zs_kd 1.7674 (1.6972) loss_oracle 0.7813 (0.7378) acc 53.1250 (61.4062) kd_loss 0.7048 (0.7871) lr 1.1253e-03 eta 0:13:50
epoch [25/50] batch [120/319] time 0.081 (0.098) data 0.000 (0.020) loss 2.1928 (2.1872) ce_loss 1.0039 (1.0333) loss_zs_kd 1.9622 (1.6888) loss_oracle 0.7092 (0.7401) acc 59.3750 (61.5885) kd_loss 0.8343 (0.7839) lr 1.1253e-03 eta 0:13:21
epoch [25/50] batch [140/319] time 0.086 (0.096) data 0.000 (0.017) loss 1.8981 (2.1806) ce_loss 0.9287 (1.0295) loss_zs_kd 1.7531 (1.6876) loss_oracle 0.6484 (0.7396) acc 59.3750 (61.6518) kd_loss 0.6451 (0.7812) lr 1.1253e-03 eta 0:13:02
epoch [25/50] batch [160/319] time 0.090 (0.094) data 0.000 (0.015) loss 2.2171 (2.1831) ce_loss 1.0088 (1.0310) loss_zs_kd 1.8555 (1.6842) loss_oracle 0.7548 (0.7404) acc 78.1250 (61.8359) kd_loss 0.8310 (0.7818) lr 1.1253e-03 eta 0:12:48
epoch [25/50] batch [180/319] time 0.088 (0.093) data 0.000 (0.014) loss 2.0791 (2.1762) ce_loss 0.9922 (1.0250) loss_zs_kd 1.4815 (1.6908) loss_oracle 0.6467 (0.7409) acc 59.3750 (62.0139) kd_loss 0.7636 (0.7808) lr 1.1253e-03 eta 0:12:38
epoch [25/50] batch [200/319] time 0.078 (0.092) data 0.000 (0.012) loss 2.3424 (2.1756) ce_loss 1.1309 (1.0224) loss_zs_kd 1.8557 (1.7034) loss_oracle 0.6757 (0.7410) acc 50.0000 (62.1406) kd_loss 0.8737 (0.7827) lr 1.1253e-03 eta 0:12:25
epoch [25/50] batch [220/319] time 0.089 (0.091) data 0.000 (0.011) loss 2.1713 (2.1829) ce_loss 0.9795 (1.0265) loss_zs_kd 1.7761 (1.7071) loss_oracle 0.8856 (0.7425) acc 56.2500 (62.0170) kd_loss 0.7490 (0.7851) lr 1.1253e-03 eta 0:12:16
epoch [25/50] batch [240/319] time 0.083 (0.091) data 0.000 (0.010) loss 2.4291 (2.1772) ce_loss 1.2041 (1.0214) loss_zs_kd 1.8805 (1.7133) loss_oracle 0.7221 (0.7407) acc 56.2500 (62.2786) kd_loss 0.8640 (0.7855) lr 1.1253e-03 eta 0:12:09
epoch [25/50] batch [260/319] time 0.079 (0.090) data 0.000 (0.010) loss 2.2469 (2.1815) ce_loss 1.1172 (1.0232) loss_zs_kd 1.8880 (1.7202) loss_oracle 0.6685 (0.7418) acc 53.1250 (62.0433) kd_loss 0.7954 (0.7874) lr 1.1253e-03 eta 0:12:03
epoch [25/50] batch [280/319] time 0.080 (0.090) data 0.000 (0.009) loss 2.3607 (2.1816) ce_loss 1.2148 (1.0238) loss_zs_kd 1.7586 (1.7244) loss_oracle 0.7938 (0.7421) acc 46.8750 (61.8862) kd_loss 0.7490 (0.7868) lr 1.1253e-03 eta 0:11:58
epoch [25/50] batch [300/319] time 0.078 (0.089) data 0.000 (0.008) loss 2.2995 (2.1831) ce_loss 1.0322 (1.0261) loss_zs_kd 1.6402 (1.7222) loss_oracle 0.7569 (0.7411) acc 59.3750 (61.8438) kd_loss 0.8888 (0.7864) lr 1.1253e-03 eta 0:11:53
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,942
* accuracy: 67.2%
* error: 32.8%
* macro_f1: 60.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,243
* accuracy: 53.9%
* error: 46.1%
* macro_f1: 23.4%
******* Domain 2 best val acc:      67.2%, epoch: 22 *******
******* Domain 2 best val test acc: 55.1%, epoch: 22 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [26/50] batch [20/319] time 0.086 (0.231) data 0.000 (0.138) loss 2.2338 (2.2016) ce_loss 1.1387 (1.0912) loss_zs_kd 1.5244 (1.7224) loss_oracle 0.7219 (0.7155) acc 56.2500 (56.8750) kd_loss 0.7342 (0.7526) lr 1.0628e-03 eta 0:30:40
epoch [26/50] batch [40/319] time 0.082 (0.157) data 0.000 (0.069) loss 2.0675 (2.1896) ce_loss 0.9180 (1.0524) loss_zs_kd 1.8391 (1.7177) loss_oracle 0.7595 (0.7238) acc 62.5000 (58.5156) kd_loss 0.7698 (0.7754) lr 1.0628e-03 eta 0:20:42
epoch [26/50] batch [60/319] time 0.083 (0.132) data 0.000 (0.046) loss 2.2200 (2.1677) ce_loss 1.0410 (1.0290) loss_zs_kd 1.5468 (1.7060) loss_oracle 0.7588 (0.7194) acc 59.3750 (60.2604) kd_loss 0.7996 (0.7790) lr 1.0628e-03 eta 0:17:28
epoch [26/50] batch [80/319] time 0.080 (0.120) data 0.000 (0.035) loss 2.2745 (2.1706) ce_loss 1.0332 (1.0301) loss_zs_kd 2.0143 (1.7241) loss_oracle 0.6913 (0.7299) acc 65.6250 (60.7031) kd_loss 0.8956 (0.7755) lr 1.0628e-03 eta 0:15:46
epoch [26/50] batch [100/319] time 0.076 (0.112) data 0.000 (0.028) loss 2.0848 (2.1733) ce_loss 1.0098 (1.0306) loss_zs_kd 1.7512 (1.7408) loss_oracle 0.6601 (0.7274) acc 62.5000 (61.2812) kd_loss 0.7449 (0.7789) lr 1.0628e-03 eta 0:14:45
epoch [26/50] batch [120/319] time 0.087 (0.107) data 0.000 (0.023) loss 2.3580 (2.1728) ce_loss 1.1436 (1.0255) loss_zs_kd 1.7686 (1.7476) loss_oracle 0.7916 (0.7333) acc 50.0000 (61.5104) kd_loss 0.8187 (0.7807) lr 1.0628e-03 eta 0:14:04
epoch [26/50] batch [140/319] time 0.086 (0.104) data 0.000 (0.020) loss 2.3199 (2.1697) ce_loss 1.0156 (1.0215) loss_zs_kd 1.7179 (1.7452) loss_oracle 0.8267 (0.7340) acc 62.5000 (61.5625) kd_loss 0.8909 (0.7812) lr 1.0628e-03 eta 0:13:33
epoch [26/50] batch [160/319] time 0.082 (0.101) data 0.000 (0.018) loss 1.8976 (2.1623) ce_loss 0.8564 (1.0165) loss_zs_kd 1.6341 (1.7321) loss_oracle 0.7099 (0.7359) acc 75.0000 (61.6602) kd_loss 0.6862 (0.7779) lr 1.0628e-03 eta 0:13:12
epoch [26/50] batch [180/319] time 0.076 (0.099) data 0.000 (0.016) loss 1.9363 (2.1619) ce_loss 0.8198 (1.0167) loss_zs_kd 1.8263 (1.7296) loss_oracle 0.7023 (0.7357) acc 68.7500 (61.8576) kd_loss 0.7653 (0.7773) lr 1.0628e-03 eta 0:12:53
epoch [26/50] batch [200/319] time 0.078 (0.097) data 0.000 (0.014) loss 2.5495 (2.1641) ce_loss 1.2793 (1.0172) loss_zs_kd 1.6216 (1.7243) loss_oracle 0.7792 (0.7374) acc 46.8750 (61.7500) kd_loss 0.8806 (0.7783) lr 1.0628e-03 eta 0:12:35
epoch [26/50] batch [220/319] time 0.082 (0.096) data 0.000 (0.013) loss 1.8384 (2.1691) ce_loss 0.7227 (1.0211) loss_zs_kd 1.3751 (1.7247) loss_oracle 0.7405 (0.7373) acc 68.7500 (61.6335) kd_loss 0.7455 (0.7793) lr 1.0628e-03 eta 0:12:24
epoch [26/50] batch [240/319] time 0.072 (0.094) data 0.000 (0.012) loss 2.1944 (2.1690) ce_loss 0.9985 (1.0237) loss_zs_kd 1.7589 (1.7195) loss_oracle 0.6994 (0.7350) acc 56.2500 (61.4583) kd_loss 0.8462 (0.7778) lr 1.0628e-03 eta 0:12:09
epoch [26/50] batch [260/319] time 0.088 (0.093) data 0.000 (0.011) loss 2.1625 (2.1654) ce_loss 0.9033 (1.0196) loss_zs_kd 1.6085 (1.7199) loss_oracle 0.6988 (0.7355) acc 75.0000 (61.7067) kd_loss 0.9098 (0.7781) lr 1.0628e-03 eta 0:12:00
epoch [26/50] batch [280/319] time 0.076 (0.092) data 0.000 (0.010) loss 2.2004 (2.1706) ce_loss 0.9648 (1.0237) loss_zs_kd 1.5643 (1.7203) loss_oracle 0.7941 (0.7377) acc 59.3750 (61.6295) kd_loss 0.8385 (0.7781) lr 1.0628e-03 eta 0:11:51
epoch [26/50] batch [300/319] time 0.085 (0.092) data 0.000 (0.009) loss 2.7992 (2.1766) ce_loss 1.6484 (1.0279) loss_zs_kd 1.8214 (1.7189) loss_oracle 0.7917 (0.7399) acc 34.3750 (61.3750) kd_loss 0.7549 (0.7787) lr 1.0628e-03 eta 0:11:44
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,945
* accuracy: 67.3%
* error: 32.7%
* macro_f1: 59.8%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,333
* accuracy: 54.8%
* error: 45.2%
* macro_f1: 23.9%
******* Domain 2 best val acc:      67.3%, epoch: 26 *******
******* Domain 2 best val test acc: 54.8%, epoch: 26 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [27/50] batch [20/319] time 0.073 (0.230) data 0.000 (0.148) loss 1.8743 (2.2074) ce_loss 0.8516 (1.0274) loss_zs_kd 1.3822 (1.6488) loss_oracle 0.6411 (0.7586) acc 65.6250 (61.0938) kd_loss 0.7022 (0.8006) lr 1.0000e-03 eta 0:29:15
epoch [27/50] batch [40/319] time 0.081 (0.155) data 0.000 (0.074) loss 1.9005 (2.1835) ce_loss 0.7910 (1.0271) loss_zs_kd 1.9214 (1.6877) loss_oracle 0.6789 (0.7495) acc 71.8750 (61.2500) kd_loss 0.7700 (0.7817) lr 1.0000e-03 eta 0:19:40
epoch [27/50] batch [60/319] time 0.079 (0.129) data 0.000 (0.049) loss 2.3594 (2.1536) ce_loss 0.9429 (0.9995) loss_zs_kd 1.8159 (1.6711) loss_oracle 0.7538 (0.7446) acc 68.7500 (62.5521) kd_loss 1.0396 (0.7818) lr 1.0000e-03 eta 0:16:22
epoch [27/50] batch [80/319] time 0.079 (0.117) data 0.000 (0.037) loss 2.3967 (2.1382) ce_loss 1.2471 (0.9955) loss_zs_kd 1.8394 (1.6511) loss_oracle 0.7945 (0.7386) acc 56.2500 (63.0859) kd_loss 0.7524 (0.7734) lr 1.0000e-03 eta 0:14:43
epoch [27/50] batch [100/319] time 0.080 (0.109) data 0.000 (0.030) loss 1.8519 (2.1405) ce_loss 0.8672 (0.9927) loss_zs_kd 1.8212 (1.6670) loss_oracle 0.7297 (0.7413) acc 71.8750 (62.9375) kd_loss 0.6198 (0.7770) lr 1.0000e-03 eta 0:13:45
epoch [27/50] batch [120/319] time 0.082 (0.105) data 0.000 (0.025) loss 2.0199 (2.1473) ce_loss 0.9834 (0.9997) loss_zs_kd 1.7558 (1.6750) loss_oracle 0.7635 (0.7429) acc 62.5000 (62.6302) kd_loss 0.6548 (0.7761) lr 1.0000e-03 eta 0:13:09
epoch [27/50] batch [140/319] time 0.093 (0.102) data 0.000 (0.021) loss 2.1322 (2.1549) ce_loss 0.9702 (1.0044) loss_zs_kd 1.4920 (1.6766) loss_oracle 0.8624 (0.7454) acc 65.6250 (62.5670) kd_loss 0.7308 (0.7779) lr 1.0000e-03 eta 0:12:45
epoch [27/50] batch [160/319] time 0.076 (0.099) data 0.000 (0.019) loss 1.7571 (2.1530) ce_loss 0.7622 (0.9990) loss_zs_kd 1.6289 (1.6862) loss_oracle 0.5642 (0.7458) acc 75.0000 (62.7344) kd_loss 0.7128 (0.7811) lr 1.0000e-03 eta 0:12:23
epoch [27/50] batch [180/319] time 0.072 (0.097) data 0.000 (0.017) loss 2.0356 (2.1588) ce_loss 0.8618 (1.0012) loss_zs_kd 1.7488 (1.6959) loss_oracle 0.7460 (0.7446) acc 68.7500 (62.8472) kd_loss 0.8008 (0.7853) lr 1.0000e-03 eta 0:12:03
epoch [27/50] batch [200/319] time 0.088 (0.096) data 0.000 (0.015) loss 1.8174 (2.1603) ce_loss 0.7466 (1.0023) loss_zs_kd 2.0297 (1.7114) loss_oracle 0.7108 (0.7445) acc 68.7500 (62.7656) kd_loss 0.7154 (0.7858) lr 1.0000e-03 eta 0:11:52
epoch [27/50] batch [220/319] time 0.090 (0.094) data 0.000 (0.014) loss 2.2741 (2.1650) ce_loss 1.0361 (1.0057) loss_zs_kd 1.8623 (1.7226) loss_oracle 0.6959 (0.7434) acc 53.1250 (62.6847) kd_loss 0.8901 (0.7875) lr 1.0000e-03 eta 0:11:40
epoch [27/50] batch [240/319] time 0.079 (0.093) data 0.000 (0.013) loss 2.3066 (2.1714) ce_loss 1.1699 (1.0105) loss_zs_kd 1.7575 (1.7269) loss_oracle 0.7194 (0.7457) acc 56.2500 (62.6562) kd_loss 0.7770 (0.7881) lr 1.0000e-03 eta 0:11:32
epoch [27/50] batch [260/319] time 0.083 (0.093) data 0.000 (0.012) loss 2.1009 (2.1724) ce_loss 0.9141 (1.0107) loss_zs_kd 1.6845 (1.7269) loss_oracle 0.6669 (0.7466) acc 62.5000 (62.6442) kd_loss 0.8533 (0.7884) lr 1.0000e-03 eta 0:11:24
epoch [27/50] batch [280/319] time 0.086 (0.092) data 0.000 (0.011) loss 2.5933 (2.1751) ce_loss 1.3320 (1.0145) loss_zs_kd 1.8354 (1.7280) loss_oracle 0.8533 (0.7453) acc 40.6250 (62.3661) kd_loss 0.8346 (0.7880) lr 1.0000e-03 eta 0:11:18
epoch [27/50] batch [300/319] time 0.086 (0.092) data 0.000 (0.010) loss 2.4675 (2.1722) ce_loss 1.3301 (1.0130) loss_zs_kd 2.1116 (1.7296) loss_oracle 0.7500 (0.7430) acc 53.1250 (62.3542) kd_loss 0.7624 (0.7877) lr 1.0000e-03 eta 0:11:13
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,950
* accuracy: 67.4%
* error: 32.6%
* macro_f1: 60.4%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,574
* accuracy: 57.3%
* error: 42.7%
* macro_f1: 26.9%
******* Domain 2 best val acc:      67.4%, epoch: 27 *******
******* Domain 2 best val test acc: 57.3%, epoch: 27 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [28/50] batch [20/319] time 0.082 (0.186) data 0.000 (0.104) loss 2.1690 (2.1719) ce_loss 0.9775 (0.9991) loss_zs_kd 1.8776 (1.8205) loss_oracle 0.7948 (0.7539) acc 78.1250 (63.5938) kd_loss 0.7941 (0.7958) lr 9.3721e-04 eta 0:22:42
epoch [28/50] batch [40/319] time 0.078 (0.135) data 0.000 (0.052) loss 2.2063 (2.1599) ce_loss 1.0869 (0.9891) loss_zs_kd 2.0584 (1.7697) loss_oracle 0.6731 (0.7438) acc 59.3750 (63.2812) kd_loss 0.7828 (0.7989) lr 9.3721e-04 eta 0:16:27
epoch [28/50] batch [60/319] time 0.082 (0.118) data 0.000 (0.035) loss 1.9457 (2.1785) ce_loss 0.9399 (1.0195) loss_zs_kd 1.8075 (1.7902) loss_oracle 0.6325 (0.7383) acc 71.8750 (61.9271) kd_loss 0.6895 (0.7899) lr 9.3721e-04 eta 0:14:21
epoch [28/50] batch [80/319] time 0.087 (0.110) data 0.000 (0.026) loss 2.0752 (2.1610) ce_loss 1.0596 (1.0018) loss_zs_kd 1.5333 (1.7487) loss_oracle 0.6222 (0.7404) acc 53.1250 (62.5391) kd_loss 0.7046 (0.7890) lr 9.3721e-04 eta 0:13:17
epoch [28/50] batch [100/319] time 0.094 (0.105) data 0.000 (0.021) loss 2.1905 (2.1668) ce_loss 1.0225 (1.0090) loss_zs_kd 1.7938 (1.7572) loss_oracle 0.7184 (0.7392) acc 59.3750 (62.5000) kd_loss 0.8089 (0.7882) lr 9.3721e-04 eta 0:12:41
epoch [28/50] batch [120/319] time 0.088 (0.101) data 0.001 (0.018) loss 1.9516 (2.1590) ce_loss 0.9619 (1.0033) loss_zs_kd 1.8666 (1.7512) loss_oracle 0.6882 (0.7371) acc 65.6250 (62.5000) kd_loss 0.6456 (0.7872) lr 9.3721e-04 eta 0:12:12
epoch [28/50] batch [140/319] time 0.081 (0.099) data 0.000 (0.015) loss 2.0213 (2.1710) ce_loss 0.9077 (1.0087) loss_zs_kd 1.9545 (1.7474) loss_oracle 0.8305 (0.7405) acc 65.6250 (62.5223) kd_loss 0.6983 (0.7920) lr 9.3721e-04 eta 0:11:52
epoch [28/50] batch [160/319] time 0.093 (0.097) data 0.000 (0.013) loss 1.8187 (2.1619) ce_loss 0.7983 (1.0066) loss_zs_kd 1.7955 (1.7428) loss_oracle 0.6995 (0.7381) acc 65.6250 (62.5977) kd_loss 0.6707 (0.7862) lr 9.3721e-04 eta 0:11:37
epoch [28/50] batch [180/319] time 0.084 (0.096) data 0.000 (0.012) loss 1.9385 (2.1542) ce_loss 0.9248 (1.0008) loss_zs_kd 1.6302 (1.7434) loss_oracle 0.7377 (0.7380) acc 68.7500 (62.8472) kd_loss 0.6448 (0.7844) lr 9.3721e-04 eta 0:11:24
epoch [28/50] batch [200/319] time 0.081 (0.094) data 0.000 (0.011) loss 2.4149 (2.1572) ce_loss 1.1182 (1.0052) loss_zs_kd 1.7497 (1.7432) loss_oracle 0.8085 (0.7370) acc 43.7500 (62.9219) kd_loss 0.8925 (0.7835) lr 9.3721e-04 eta 0:11:14
epoch [28/50] batch [220/319] time 0.084 (0.094) data 0.000 (0.010) loss 2.4196 (2.1612) ce_loss 1.1592 (1.0081) loss_zs_kd 1.7977 (1.7484) loss_oracle 0.8475 (0.7366) acc 53.1250 (62.6420) kd_loss 0.8366 (0.7847) lr 9.3721e-04 eta 0:11:06
epoch [28/50] batch [240/319] time 0.081 (0.093) data 0.000 (0.009) loss 2.2898 (2.1576) ce_loss 1.1162 (1.0081) loss_zs_kd 1.6511 (1.7524) loss_oracle 0.7971 (0.7350) acc 65.6250 (62.6042) kd_loss 0.7751 (0.7820) lr 9.3721e-04 eta 0:10:59
epoch [28/50] batch [260/319] time 0.084 (0.092) data 0.000 (0.008) loss 1.9835 (2.1558) ce_loss 0.8486 (1.0064) loss_zs_kd 1.5694 (1.7529) loss_oracle 0.7628 (0.7341) acc 68.7500 (62.6562) kd_loss 0.7534 (0.7824) lr 9.3721e-04 eta 0:10:53
epoch [28/50] batch [280/319] time 0.081 (0.092) data 0.000 (0.008) loss 2.0069 (2.1560) ce_loss 0.8105 (1.0058) loss_zs_kd 1.8014 (1.7539) loss_oracle 0.7724 (0.7334) acc 78.1250 (62.6339) kd_loss 0.8102 (0.7836) lr 9.3721e-04 eta 0:10:47
epoch [28/50] batch [300/319] time 0.103 (0.091) data 0.000 (0.007) loss 2.4489 (2.1601) ce_loss 1.1943 (1.0076) loss_zs_kd 1.6264 (1.7515) loss_oracle 0.8251 (0.7342) acc 56.2500 (62.4896) kd_loss 0.8420 (0.7854) lr 9.3721e-04 eta 0:10:42
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,962
* accuracy: 67.7%
* error: 32.3%
* macro_f1: 60.3%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,316
* accuracy: 54.6%
* error: 45.4%
* macro_f1: 24.8%
******* Domain 2 best val acc:      67.7%, epoch: 28 *******
******* Domain 2 best val test acc: 54.6%, epoch: 28 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [29/50] batch [20/319] time 0.084 (0.218) data 0.000 (0.133) loss 2.5093 (2.1738) ce_loss 1.2158 (0.9941) loss_zs_kd 1.6953 (1.7541) loss_oracle 0.7936 (0.7305) acc 53.1250 (63.1250) kd_loss 0.8966 (0.8145) lr 8.7467e-04 eta 0:25:23
epoch [29/50] batch [40/319] time 0.084 (0.151) data 0.000 (0.067) loss 2.0248 (2.1661) ce_loss 1.0059 (1.0005) loss_zs_kd 1.6847 (1.7480) loss_oracle 0.6955 (0.7357) acc 75.0000 (63.5938) kd_loss 0.6712 (0.7977) lr 8.7467e-04 eta 0:17:32
epoch [29/50] batch [60/319] time 0.081 (0.129) data 0.000 (0.045) loss 2.0268 (2.1752) ce_loss 0.8794 (1.0133) loss_zs_kd 1.6742 (1.7493) loss_oracle 0.7298 (0.7339) acc 62.5000 (63.2812) kd_loss 0.7825 (0.7949) lr 8.7467e-04 eta 0:14:56
epoch [29/50] batch [80/319] time 0.093 (0.118) data 0.001 (0.033) loss 2.2253 (2.1702) ce_loss 0.9688 (1.0130) loss_zs_kd 1.8894 (1.7255) loss_oracle 0.8329 (0.7302) acc 68.7500 (63.4766) kd_loss 0.8401 (0.7921) lr 8.7467e-04 eta 0:13:41
epoch [29/50] batch [100/319] time 0.078 (0.112) data 0.000 (0.027) loss 2.2756 (2.1681) ce_loss 1.0898 (1.0110) loss_zs_kd 1.7556 (1.7169) loss_oracle 0.6975 (0.7262) acc 62.5000 (63.3750) kd_loss 0.8370 (0.7940) lr 8.7467e-04 eta 0:12:51
epoch [29/50] batch [120/319] time 0.091 (0.107) data 0.001 (0.022) loss 2.0240 (2.1606) ce_loss 1.0410 (1.0066) loss_zs_kd 1.4303 (1.7132) loss_oracle 0.6373 (0.7188) acc 62.5000 (63.4375) kd_loss 0.6643 (0.7946) lr 8.7467e-04 eta 0:12:17
epoch [29/50] batch [140/319] time 0.080 (0.103) data 0.000 (0.019) loss 2.3761 (2.1509) ce_loss 1.2012 (1.0015) loss_zs_kd 1.8344 (1.7063) loss_oracle 0.7398 (0.7183) acc 37.5000 (63.3929) kd_loss 0.8050 (0.7902) lr 8.7467e-04 eta 0:11:51
epoch [29/50] batch [160/319] time 0.078 (0.101) data 0.000 (0.017) loss 2.2471 (2.1599) ce_loss 1.0977 (1.0095) loss_zs_kd 1.5815 (1.7109) loss_oracle 0.7997 (0.7209) acc 56.2500 (62.9688) kd_loss 0.7495 (0.7900) lr 8.7467e-04 eta 0:11:33
epoch [29/50] batch [180/319] time 0.080 (0.099) data 0.000 (0.015) loss 2.3980 (2.1610) ce_loss 1.1201 (1.0103) loss_zs_kd 1.4192 (1.7194) loss_oracle 0.8649 (0.7229) acc 56.2500 (62.7778) kd_loss 0.8454 (0.7892) lr 8.7467e-04 eta 0:11:18
epoch [29/50] batch [200/319] time 0.089 (0.098) data 0.000 (0.014) loss 2.2143 (2.1679) ce_loss 1.0762 (1.0156) loss_zs_kd 1.8077 (1.7210) loss_oracle 0.6351 (0.7250) acc 62.5000 (62.8594) kd_loss 0.8206 (0.7897) lr 8.7467e-04 eta 0:11:07
epoch [29/50] batch [220/319] time 0.090 (0.097) data 0.000 (0.012) loss 2.4399 (2.1646) ce_loss 1.2646 (1.0142) loss_zs_kd 1.6904 (1.7172) loss_oracle 0.7180 (0.7235) acc 53.1250 (62.9119) kd_loss 0.8163 (0.7886) lr 8.7467e-04 eta 0:10:57
epoch [29/50] batch [240/319] time 0.087 (0.095) data 0.000 (0.011) loss 2.2119 (2.1624) ce_loss 1.1475 (1.0141) loss_zs_kd 1.9083 (1.7275) loss_oracle 0.7019 (0.7252) acc 59.3750 (62.9036) kd_loss 0.7135 (0.7857) lr 8.7467e-04 eta 0:10:46
epoch [29/50] batch [260/319] time 0.088 (0.094) data 0.000 (0.011) loss 2.0738 (2.1688) ce_loss 0.9775 (1.0186) loss_zs_kd 1.9475 (1.7308) loss_oracle 0.7316 (0.7276) acc 59.3750 (62.6322) kd_loss 0.7304 (0.7863) lr 8.7467e-04 eta 0:10:37
epoch [29/50] batch [280/319] time 0.077 (0.093) data 0.000 (0.010) loss 2.0052 (2.1677) ce_loss 0.9561 (1.0184) loss_zs_kd 1.8585 (1.7385) loss_oracle 0.6673 (0.7296) acc 78.1250 (62.6674) kd_loss 0.7155 (0.7845) lr 8.7467e-04 eta 0:10:29
epoch [29/50] batch [300/319] time 0.089 (0.093) data 0.001 (0.009) loss 2.2347 (2.1701) ce_loss 1.1074 (1.0199) loss_zs_kd 1.7465 (1.7330) loss_oracle 0.7575 (0.7295) acc 53.1250 (62.6458) kd_loss 0.7485 (0.7854) lr 8.7467e-04 eta 0:10:22
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,959
* accuracy: 67.6%
* error: 32.4%
* macro_f1: 60.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,394
* accuracy: 55.4%
* error: 44.6%
* macro_f1: 23.1%
******* Domain 2 best val acc:      67.7%, epoch: 28 *******
******* Domain 2 best val test acc: 54.6%, epoch: 28 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [30/50] batch [20/319] time 0.083 (0.219) data 0.000 (0.129) loss 1.8788 (2.2098) ce_loss 0.8120 (1.0575) loss_zs_kd 1.7157 (1.7605) loss_oracle 0.7651 (0.7338) acc 65.6250 (64.3750) kd_loss 0.6842 (0.7854) lr 8.1262e-04 eta 0:24:24
epoch [30/50] batch [40/319] time 0.082 (0.152) data 0.000 (0.065) loss 2.0633 (2.1911) ce_loss 0.9639 (1.0523) loss_zs_kd 1.7731 (1.7435) loss_oracle 0.6911 (0.7240) acc 59.3750 (62.5781) kd_loss 0.7539 (0.7767) lr 8.1262e-04 eta 0:16:51
epoch [30/50] batch [60/319] time 0.080 (0.128) data 0.000 (0.043) loss 2.1075 (2.1902) ce_loss 0.9023 (1.0453) loss_zs_kd 1.7319 (1.7462) loss_oracle 0.7647 (0.7244) acc 62.5000 (62.1354) kd_loss 0.8228 (0.7828) lr 8.1262e-04 eta 0:14:13
epoch [30/50] batch [80/319] time 0.072 (0.115) data 0.000 (0.033) loss 2.3983 (2.1910) ce_loss 1.0879 (1.0439) loss_zs_kd 1.6136 (1.7387) loss_oracle 0.8008 (0.7267) acc 53.1250 (61.4844) kd_loss 0.9101 (0.7838) lr 8.1262e-04 eta 0:12:41
epoch [30/50] batch [100/319] time 0.078 (0.108) data 0.000 (0.026) loss 2.1474 (2.1902) ce_loss 0.9668 (1.0433) loss_zs_kd 1.7974 (1.7374) loss_oracle 0.7406 (0.7232) acc 62.5000 (61.5938) kd_loss 0.8103 (0.7853) lr 8.1262e-04 eta 0:11:49
epoch [30/50] batch [120/319] time 0.089 (0.103) data 0.000 (0.022) loss 2.2449 (2.1941) ce_loss 1.0781 (1.0427) loss_zs_kd 1.8186 (1.7391) loss_oracle 0.7641 (0.7301) acc 59.3750 (61.2500) kd_loss 0.7848 (0.7863) lr 8.1262e-04 eta 0:11:18
epoch [30/50] batch [140/319] time 0.077 (0.100) data 0.000 (0.019) loss 2.0083 (2.1812) ce_loss 0.7627 (1.0298) loss_zs_kd 1.6950 (1.7462) loss_oracle 0.7241 (0.7265) acc 68.7500 (61.8750) kd_loss 0.8836 (0.7882) lr 8.1262e-04 eta 0:10:53
epoch [30/50] batch [160/319] time 0.093 (0.097) data 0.000 (0.016) loss 2.0790 (2.1743) ce_loss 1.0010 (1.0258) loss_zs_kd 1.6159 (1.7398) loss_oracle 0.6991 (0.7248) acc 59.3750 (62.0508) kd_loss 0.7285 (0.7861) lr 8.1262e-04 eta 0:10:35
epoch [30/50] batch [180/319] time 0.092 (0.096) data 0.000 (0.015) loss 2.0185 (2.1715) ce_loss 0.9375 (1.0228) loss_zs_kd 1.8257 (1.7323) loss_oracle 0.7642 (0.7270) acc 62.5000 (62.0833) kd_loss 0.6989 (0.7852) lr 8.1262e-04 eta 0:10:25
epoch [30/50] batch [200/319] time 0.072 (0.094) data 0.000 (0.013) loss 2.2125 (2.1677) ce_loss 1.0264 (1.0173) loss_zs_kd 1.6176 (1.7266) loss_oracle 0.6486 (0.7290) acc 62.5000 (62.2812) kd_loss 0.8618 (0.7859) lr 8.1262e-04 eta 0:10:10
epoch [30/50] batch [220/319] time 0.086 (0.093) data 0.000 (0.012) loss 2.0204 (2.1683) ce_loss 0.8936 (1.0161) loss_zs_kd 1.7427 (1.7316) loss_oracle 0.7086 (0.7295) acc 71.8750 (62.5142) kd_loss 0.7726 (0.7875) lr 8.1262e-04 eta 0:10:03
epoch [30/50] batch [240/319] time 0.086 (0.092) data 0.000 (0.011) loss 2.2195 (2.1766) ce_loss 0.9214 (1.0214) loss_zs_kd 1.7150 (1.7324) loss_oracle 0.8594 (0.7306) acc 68.7500 (62.3438) kd_loss 0.8685 (0.7899) lr 8.1262e-04 eta 0:09:55
epoch [30/50] batch [260/319] time 0.081 (0.092) data 0.000 (0.010) loss 2.2613 (2.1769) ce_loss 1.0059 (1.0192) loss_zs_kd 1.5673 (1.7294) loss_oracle 0.7572 (0.7339) acc 62.5000 (62.5481) kd_loss 0.8768 (0.7908) lr 8.1262e-04 eta 0:09:49
epoch [30/50] batch [280/319] time 0.083 (0.091) data 0.000 (0.010) loss 2.0770 (2.1717) ce_loss 1.0488 (1.0151) loss_zs_kd 1.5335 (1.7267) loss_oracle 0.5938 (0.7334) acc 59.3750 (62.6562) kd_loss 0.7313 (0.7899) lr 8.1262e-04 eta 0:09:44
epoch [30/50] batch [300/319] time 0.087 (0.091) data 0.000 (0.009) loss 2.7073 (2.1706) ce_loss 1.4473 (1.0131) loss_zs_kd 1.5274 (1.7258) loss_oracle 0.7921 (0.7338) acc 46.8750 (62.8229) kd_loss 0.8640 (0.7906) lr 8.1262e-04 eta 0:09:39
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,944
* accuracy: 67.2%
* error: 32.8%
* macro_f1: 60.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,180
* accuracy: 53.2%
* error: 46.8%
* macro_f1: 24.3%
******* Domain 2 best val acc:      67.7%, epoch: 28 *******
******* Domain 2 best val test acc: 54.6%, epoch: 28 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [31/50] batch [20/319] time 0.089 (0.194) data 0.000 (0.107) loss 1.9688 (2.1152) ce_loss 0.8052 (0.9389) loss_zs_kd 1.7594 (1.7683) loss_oracle 0.6999 (0.7455) acc 71.8750 (66.2500) kd_loss 0.8137 (0.8035) lr 7.5131e-04 eta 0:20:31
epoch [31/50] batch [40/319] time 0.085 (0.139) data 0.000 (0.053) loss 2.1764 (2.1252) ce_loss 1.0283 (0.9722) loss_zs_kd 1.4486 (1.7719) loss_oracle 0.7410 (0.7260) acc 56.2500 (64.0625) kd_loss 0.7775 (0.7900) lr 7.5131e-04 eta 0:14:38
epoch [31/50] batch [60/319] time 0.082 (0.121) data 0.000 (0.036) loss 2.2490 (2.1527) ce_loss 1.1143 (0.9980) loss_zs_kd 1.7305 (1.7533) loss_oracle 0.7344 (0.7310) acc 56.2500 (63.2292) kd_loss 0.7676 (0.7892) lr 7.5131e-04 eta 0:12:43
epoch [31/50] batch [80/319] time 0.092 (0.112) data 0.000 (0.027) loss 2.4238 (2.1663) ce_loss 1.1318 (1.0065) loss_zs_kd 1.7645 (1.7516) loss_oracle 0.7795 (0.7348) acc 43.7500 (62.7734) kd_loss 0.9022 (0.7924) lr 7.5131e-04 eta 0:11:45
epoch [31/50] batch [100/319] time 0.075 (0.106) data 0.000 (0.022) loss 2.2209 (2.1608) ce_loss 1.2119 (1.0027) loss_zs_kd 1.8769 (1.7476) loss_oracle 0.6689 (0.7278) acc 53.1250 (63.2188) kd_loss 0.6745 (0.7942) lr 7.5131e-04 eta 0:11:03
epoch [31/50] batch [120/319] time 0.075 (0.102) data 0.000 (0.018) loss 1.9663 (2.1683) ce_loss 0.7983 (1.0103) loss_zs_kd 1.4056 (1.7336) loss_oracle 0.6372 (0.7279) acc 68.7500 (62.8125) kd_loss 0.8493 (0.7941) lr 7.5131e-04 eta 0:10:36
epoch [31/50] batch [140/319] time 0.079 (0.099) data 0.000 (0.015) loss 2.2098 (2.1735) ce_loss 1.0059 (1.0136) loss_zs_kd 1.7222 (1.7392) loss_oracle 0.7069 (0.7291) acc 62.5000 (62.5446) kd_loss 0.8505 (0.7953) lr 7.5131e-04 eta 0:10:17
epoch [31/50] batch [160/319] time 0.083 (0.097) data 0.000 (0.014) loss 2.2864 (2.1696) ce_loss 1.0986 (1.0121) loss_zs_kd 1.7734 (1.7432) loss_oracle 0.7538 (0.7307) acc 65.6250 (62.5391) kd_loss 0.8109 (0.7921) lr 7.5131e-04 eta 0:10:02
epoch [31/50] batch [180/319] time 0.077 (0.095) data 0.000 (0.012) loss 2.5221 (2.1795) ce_loss 1.3037 (1.0163) loss_zs_kd 1.7197 (1.7336) loss_oracle 0.8051 (0.7373) acc 53.1250 (62.2396) kd_loss 0.8158 (0.7945) lr 7.5131e-04 eta 0:09:51
epoch [31/50] batch [200/319] time 0.086 (0.094) data 0.000 (0.011) loss 1.9639 (2.1821) ce_loss 1.0127 (1.0179) loss_zs_kd 1.9745 (1.7357) loss_oracle 0.6001 (0.7379) acc 62.5000 (62.0938) kd_loss 0.6512 (0.7952) lr 7.5131e-04 eta 0:09:40
epoch [31/50] batch [220/319] time 0.077 (0.093) data 0.000 (0.010) loss 1.9850 (2.1787) ce_loss 0.7812 (1.0161) loss_zs_kd 1.8428 (1.7345) loss_oracle 0.8190 (0.7391) acc 84.3750 (62.3153) kd_loss 0.7943 (0.7930) lr 7.5131e-04 eta 0:09:33
epoch [31/50] batch [240/319] time 0.074 (0.092) data 0.000 (0.009) loss 2.2803 (2.1801) ce_loss 1.1113 (1.0158) loss_zs_kd 1.5051 (1.7263) loss_oracle 0.6832 (0.7405) acc 62.5000 (62.2526) kd_loss 0.8274 (0.7941) lr 7.5131e-04 eta 0:09:24
epoch [31/50] batch [260/319] time 0.088 (0.091) data 0.000 (0.008) loss 2.3337 (2.1760) ce_loss 0.9785 (1.0112) loss_zs_kd 1.7372 (1.7206) loss_oracle 0.8195 (0.7417) acc 65.6250 (62.4279) kd_loss 0.9454 (0.7939) lr 7.5131e-04 eta 0:09:18
epoch [31/50] batch [280/319] time 0.092 (0.091) data 0.000 (0.008) loss 2.2065 (2.1854) ce_loss 1.0059 (1.0189) loss_zs_kd 1.8613 (1.7214) loss_oracle 0.7197 (0.7434) acc 53.1250 (61.9754) kd_loss 0.8407 (0.7948) lr 7.5131e-04 eta 0:09:12
epoch [31/50] batch [300/319] time 0.082 (0.090) data 0.000 (0.007) loss 1.8911 (2.1891) ce_loss 0.6851 (1.0211) loss_zs_kd 1.5804 (1.7228) loss_oracle 0.6713 (0.7450) acc 78.1250 (62.0729) kd_loss 0.8704 (0.7955) lr 7.5131e-04 eta 0:09:08
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,000
* accuracy: 68.5%
* error: 31.5%
* macro_f1: 60.1%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,272
* accuracy: 54.1%
* error: 45.9%
* macro_f1: 24.4%
******* Domain 2 best val acc:      68.5%, epoch: 31 *******
******* Domain 2 best val test acc: 54.1%, epoch: 31 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [32/50] batch [20/319] time 0.083 (0.211) data 0.000 (0.123) loss 2.2021 (2.2363) ce_loss 1.0088 (1.0461) loss_zs_kd 1.9321 (1.7025) loss_oracle 0.7788 (0.7234) acc 59.3750 (60.7812) kd_loss 0.8039 (0.8285) lr 6.9098e-04 eta 0:21:15
epoch [32/50] batch [40/319] time 0.080 (0.148) data 0.000 (0.062) loss 2.1658 (2.2301) ce_loss 1.1162 (1.0414) loss_zs_kd 1.8022 (1.7055) loss_oracle 0.6000 (0.7302) acc 56.2500 (60.7812) kd_loss 0.7496 (0.8236) lr 6.9098e-04 eta 0:14:51
epoch [32/50] batch [60/319] time 0.083 (0.123) data 0.000 (0.041) loss 2.0261 (2.2086) ce_loss 0.8574 (1.0265) loss_zs_kd 1.5971 (1.7243) loss_oracle 0.7164 (0.7313) acc 71.8750 (62.2917) kd_loss 0.8104 (0.8164) lr 6.9098e-04 eta 0:12:17
epoch [32/50] batch [80/319] time 0.085 (0.113) data 0.000 (0.031) loss 2.2217 (2.2042) ce_loss 0.9360 (1.0200) loss_zs_kd 1.6288 (1.7154) loss_oracle 0.8373 (0.7375) acc 59.3750 (61.7969) kd_loss 0.8670 (0.8154) lr 6.9098e-04 eta 0:11:15
epoch [32/50] batch [100/319] time 0.078 (0.107) data 0.000 (0.025) loss 1.9147 (2.2098) ce_loss 0.7690 (1.0252) loss_zs_kd 1.7321 (1.7216) loss_oracle 0.8311 (0.7429) acc 71.8750 (61.5625) kd_loss 0.7301 (0.8132) lr 6.9098e-04 eta 0:10:37
epoch [32/50] batch [120/319] time 0.082 (0.103) data 0.000 (0.021) loss 2.2698 (2.2016) ce_loss 1.0322 (1.0205) loss_zs_kd 1.8911 (1.7167) loss_oracle 0.8340 (0.7418) acc 56.2500 (61.8750) kd_loss 0.8205 (0.8101) lr 6.9098e-04 eta 0:10:10
epoch [32/50] batch [140/319] time 0.086 (0.100) data 0.000 (0.018) loss 2.2792 (2.2024) ce_loss 1.0527 (1.0182) loss_zs_kd 2.1264 (1.7231) loss_oracle 0.7585 (0.7440) acc 46.8750 (61.7634) kd_loss 0.8472 (0.8121) lr 6.9098e-04 eta 0:09:50
epoch [32/50] batch [160/319] time 0.080 (0.098) data 0.000 (0.016) loss 2.1437 (2.2007) ce_loss 1.0303 (1.0211) loss_zs_kd 1.5007 (1.7162) loss_oracle 0.6656 (0.7423) acc 62.5000 (61.6797) kd_loss 0.7807 (0.8084) lr 6.9098e-04 eta 0:09:38
epoch [32/50] batch [180/319] time 0.075 (0.096) data 0.000 (0.014) loss 2.5456 (2.2044) ce_loss 1.1299 (1.0195) loss_zs_kd 1.5430 (1.7156) loss_oracle 0.7606 (0.7440) acc 59.3750 (61.9444) kd_loss 1.0354 (0.8129) lr 6.9098e-04 eta 0:09:25
epoch [32/50] batch [200/319] time 0.080 (0.095) data 0.000 (0.013) loss 2.1802 (2.2007) ce_loss 0.9531 (1.0171) loss_zs_kd 1.5835 (1.7156) loss_oracle 0.7295 (0.7437) acc 59.3750 (62.0000) kd_loss 0.8623 (0.8117) lr 6.9098e-04 eta 0:09:16
epoch [32/50] batch [220/319] time 0.071 (0.095) data 0.000 (0.011) loss 2.3466 (2.1962) ce_loss 1.0205 (1.0132) loss_zs_kd 1.5093 (1.7153) loss_oracle 0.8329 (0.7432) acc 53.1250 (62.0455) kd_loss 0.9097 (0.8114) lr 6.9098e-04 eta 0:09:15
epoch [32/50] batch [240/319] time 0.077 (0.094) data 0.000 (0.011) loss 2.0509 (2.1965) ce_loss 0.8169 (1.0149) loss_zs_kd 1.8210 (1.7143) loss_oracle 0.8293 (0.7427) acc 65.6250 (62.1484) kd_loss 0.8194 (0.8103) lr 6.9098e-04 eta 0:09:06
epoch [32/50] batch [260/319] time 0.082 (0.093) data 0.000 (0.010) loss 2.1610 (2.1990) ce_loss 1.0400 (1.0185) loss_zs_kd 1.7154 (1.7196) loss_oracle 0.5693 (0.7420) acc 65.6250 (62.1875) kd_loss 0.8363 (0.8095) lr 6.9098e-04 eta 0:09:00
epoch [32/50] batch [280/319] time 0.084 (0.092) data 0.000 (0.009) loss 2.3404 (2.2002) ce_loss 1.0801 (1.0197) loss_zs_kd 1.7328 (1.7184) loss_oracle 0.8005 (0.7425) acc 68.7500 (62.1540) kd_loss 0.8601 (0.8092) lr 6.9098e-04 eta 0:08:54
epoch [32/50] batch [300/319] time 0.086 (0.092) data 0.000 (0.008) loss 1.9940 (2.1940) ce_loss 0.9829 (1.0172) loss_zs_kd 1.5099 (1.7239) loss_oracle 0.6158 (0.7406) acc 62.5000 (62.1146) kd_loss 0.7032 (0.8066) lr 6.9098e-04 eta 0:08:49
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,994
* accuracy: 68.4%
* error: 31.6%
* macro_f1: 60.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,400
* accuracy: 55.5%
* error: 44.5%
* macro_f1: 24.1%
******* Domain 2 best val acc:      68.5%, epoch: 31 *******
******* Domain 2 best val test acc: 54.1%, epoch: 31 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [33/50] batch [20/319] time 0.080 (0.185) data 0.000 (0.100) loss 2.6569 (2.2009) ce_loss 1.3271 (1.0120) loss_zs_kd 1.7186 (1.7384) loss_oracle 0.7937 (0.7637) acc 50.0000 (63.7500) kd_loss 0.9329 (0.8070) lr 6.3188e-04 eta 0:17:37
epoch [33/50] batch [40/319] time 0.099 (0.135) data 0.000 (0.050) loss 2.0516 (2.2053) ce_loss 1.0186 (1.0188) loss_zs_kd 1.7742 (1.7153) loss_oracle 0.5943 (0.7730) acc 62.5000 (62.8906) kd_loss 0.7359 (0.8000) lr 6.3188e-04 eta 0:12:47
epoch [33/50] batch [60/319] time 0.081 (0.118) data 0.000 (0.034) loss 1.6844 (2.1937) ce_loss 0.6465 (1.0129) loss_zs_kd 1.5358 (1.7029) loss_oracle 0.6793 (0.7696) acc 75.0000 (63.8021) kd_loss 0.6982 (0.7960) lr 6.3188e-04 eta 0:11:08
epoch [33/50] batch [80/319] time 0.084 (0.109) data 0.000 (0.025) loss 2.1560 (2.1791) ce_loss 0.9028 (1.0004) loss_zs_kd 1.9067 (1.7292) loss_oracle 0.6953 (0.7660) acc 71.8750 (64.9219) kd_loss 0.9055 (0.7957) lr 6.3188e-04 eta 0:10:16
epoch [33/50] batch [100/319] time 0.093 (0.104) data 0.000 (0.020) loss 2.2545 (2.1747) ce_loss 1.1094 (0.9987) loss_zs_kd 1.5474 (1.7312) loss_oracle 0.7026 (0.7620) acc 56.2500 (64.5312) kd_loss 0.7938 (0.7950) lr 6.3188e-04 eta 0:09:46
epoch [33/50] batch [120/319] time 0.096 (0.101) data 0.000 (0.017) loss 2.5530 (2.1802) ce_loss 1.2627 (0.9982) loss_zs_kd 1.7788 (1.7319) loss_oracle 0.7631 (0.7634) acc 53.1250 (64.2448) kd_loss 0.9088 (0.8004) lr 6.3188e-04 eta 0:09:28
epoch [33/50] batch [140/319] time 0.081 (0.099) data 0.000 (0.015) loss 2.0432 (2.1761) ce_loss 0.9521 (0.9953) loss_zs_kd 1.7527 (1.7296) loss_oracle 0.7815 (0.7607) acc 62.5000 (64.0179) kd_loss 0.7003 (0.8005) lr 6.3188e-04 eta 0:09:12
epoch [33/50] batch [160/319] time 0.079 (0.096) data 0.000 (0.013) loss 1.7924 (2.1800) ce_loss 0.7314 (0.9982) loss_zs_kd 1.5678 (1.7343) loss_oracle 0.6260 (0.7594) acc 71.8750 (63.8867) kd_loss 0.7479 (0.8020) lr 6.3188e-04 eta 0:08:58
epoch [33/50] batch [180/319] time 0.082 (0.095) data 0.000 (0.011) loss 2.2936 (2.1931) ce_loss 1.0957 (1.0098) loss_zs_kd 2.3215 (1.7371) loss_oracle 0.8162 (0.7609) acc 59.3750 (63.2986) kd_loss 0.7899 (0.8028) lr 6.3188e-04 eta 0:08:47
epoch [33/50] batch [200/319] time 0.083 (0.093) data 0.000 (0.010) loss 1.9498 (2.1898) ce_loss 0.8306 (1.0086) loss_zs_kd 2.1175 (1.7414) loss_oracle 0.7339 (0.7597) acc 71.8750 (63.3438) kd_loss 0.7523 (0.8013) lr 6.3188e-04 eta 0:08:38
epoch [33/50] batch [220/319] time 0.073 (0.092) data 0.000 (0.009) loss 1.8944 (2.1863) ce_loss 0.7437 (1.0028) loss_zs_kd 1.6557 (1.7340) loss_oracle 0.7294 (0.7640) acc 65.6250 (63.2955) kd_loss 0.7860 (0.8016) lr 6.3188e-04 eta 0:08:29
epoch [33/50] batch [240/319] time 0.087 (0.091) data 0.000 (0.009) loss 2.0686 (2.1872) ce_loss 0.8960 (1.0022) loss_zs_kd 1.9362 (1.7381) loss_oracle 0.7007 (0.7623) acc 65.6250 (63.0729) kd_loss 0.8223 (0.8038) lr 6.3188e-04 eta 0:08:21
epoch [33/50] batch [260/319] time 0.092 (0.091) data 0.000 (0.008) loss 2.1318 (2.1914) ce_loss 1.0430 (1.0081) loss_zs_kd 1.5708 (1.7341) loss_oracle 0.7022 (0.7631) acc 59.3750 (62.6923) kd_loss 0.7377 (0.8018) lr 6.3188e-04 eta 0:08:17
epoch [33/50] batch [280/319] time 0.081 (0.090) data 0.000 (0.007) loss 1.8471 (2.1880) ce_loss 0.7734 (1.0069) loss_zs_kd 1.5513 (1.7366) loss_oracle 0.6663 (0.7630) acc 68.7500 (62.7567) kd_loss 0.7405 (0.7996) lr 6.3188e-04 eta 0:08:12
epoch [33/50] batch [300/319] time 0.086 (0.090) data 0.000 (0.007) loss 2.0258 (2.1900) ce_loss 0.7568 (1.0090) loss_zs_kd 1.6170 (1.7351) loss_oracle 0.8380 (0.7619) acc 71.8750 (62.6458) kd_loss 0.8500 (0.8000) lr 6.3188e-04 eta 0:08:08
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,964
* accuracy: 67.7%
* error: 32.3%
* macro_f1: 60.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,400
* accuracy: 55.5%
* error: 44.5%
* macro_f1: 24.5%
******* Domain 2 best val acc:      68.5%, epoch: 31 *******
******* Domain 2 best val test acc: 54.1%, epoch: 31 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [34/50] batch [20/319] time 0.077 (0.210) data 0.000 (0.132) loss 2.3709 (2.1981) ce_loss 1.2949 (1.0226) loss_zs_kd 1.8288 (1.7314) loss_oracle 0.7330 (0.7792) acc 62.5000 (60.9375) kd_loss 0.7095 (0.7860) lr 5.7422e-04 eta 0:18:55
epoch [34/50] batch [40/319] time 0.078 (0.145) data 0.000 (0.066) loss 2.2513 (2.2049) ce_loss 0.9727 (1.0076) loss_zs_kd 1.5662 (1.7752) loss_oracle 0.8122 (0.7747) acc 59.3750 (62.1875) kd_loss 0.8726 (0.8099) lr 5.7422e-04 eta 0:12:59
epoch [34/50] batch [60/319] time 0.083 (0.125) data 0.000 (0.044) loss 2.3731 (2.1884) ce_loss 1.1787 (0.9909) loss_zs_kd 1.8302 (1.7743) loss_oracle 0.7381 (0.7639) acc 46.8750 (62.3958) kd_loss 0.8254 (0.8155) lr 5.7422e-04 eta 0:11:07
epoch [34/50] batch [80/319] time 0.089 (0.115) data 0.000 (0.033) loss 2.3558 (2.1853) ce_loss 1.2119 (0.9893) loss_zs_kd 1.7817 (1.7514) loss_oracle 0.6646 (0.7617) acc 65.6250 (62.3438) kd_loss 0.8115 (0.8151) lr 5.7422e-04 eta 0:10:12
epoch [34/50] batch [100/319] time 0.077 (0.108) data 0.000 (0.027) loss 1.8677 (2.1897) ce_loss 0.9561 (1.0004) loss_zs_kd 1.7825 (1.7669) loss_oracle 0.6295 (0.7538) acc 75.0000 (62.1250) kd_loss 0.5969 (0.8124) lr 5.7422e-04 eta 0:09:34
epoch [34/50] batch [120/319] time 0.075 (0.103) data 0.000 (0.022) loss 2.0356 (2.1757) ce_loss 0.9751 (0.9854) loss_zs_kd 1.7019 (1.7615) loss_oracle 0.6983 (0.7554) acc 71.8750 (62.6042) kd_loss 0.7113 (0.8127) lr 5.7422e-04 eta 0:09:05
epoch [34/50] batch [140/319] time 0.077 (0.100) data 0.000 (0.019) loss 2.3148 (2.1812) ce_loss 1.1514 (0.9887) loss_zs_kd 1.5828 (1.7637) loss_oracle 0.7582 (0.7576) acc 53.1250 (62.5223) kd_loss 0.7843 (0.8138) lr 5.7422e-04 eta 0:08:46
epoch [34/50] batch [160/319] time 0.091 (0.097) data 0.000 (0.017) loss 2.2378 (2.1835) ce_loss 1.1416 (0.9956) loss_zs_kd 1.7815 (1.7658) loss_oracle 0.6818 (0.7568) acc 50.0000 (62.5000) kd_loss 0.7553 (0.8095) lr 5.7422e-04 eta 0:08:32
epoch [34/50] batch [180/319] time 0.086 (0.096) data 0.000 (0.015) loss 2.2355 (2.1841) ce_loss 1.1299 (1.0022) loss_zs_kd 2.0480 (1.7688) loss_oracle 0.7303 (0.7543) acc 59.3750 (62.5000) kd_loss 0.7405 (0.8048) lr 5.7422e-04 eta 0:08:23
epoch [34/50] batch [200/319] time 0.077 (0.095) data 0.000 (0.013) loss 1.9685 (2.1877) ce_loss 0.9160 (1.0087) loss_zs_kd 1.6243 (1.7681) loss_oracle 0.7694 (0.7531) acc 71.8750 (62.1094) kd_loss 0.6678 (0.8024) lr 5.7422e-04 eta 0:08:15
epoch [34/50] batch [220/319] time 0.086 (0.094) data 0.000 (0.012) loss 1.6609 (2.1830) ce_loss 0.6016 (1.0078) loss_zs_kd 1.8461 (1.7730) loss_oracle 0.6568 (0.7513) acc 84.3750 (62.2301) kd_loss 0.7309 (0.7996) lr 5.7422e-04 eta 0:08:07
epoch [34/50] batch [240/319] time 0.084 (0.093) data 0.000 (0.011) loss 2.3914 (2.1793) ce_loss 1.1494 (1.0053) loss_zs_kd 1.7893 (1.7718) loss_oracle 0.8310 (0.7510) acc 53.1250 (62.4089) kd_loss 0.8264 (0.7986) lr 5.7422e-04 eta 0:08:01
epoch [34/50] batch [260/319] time 0.085 (0.092) data 0.000 (0.010) loss 1.8052 (2.1734) ce_loss 0.7085 (1.0008) loss_zs_kd 1.6465 (1.7696) loss_oracle 0.6009 (0.7475) acc 75.0000 (62.6923) kd_loss 0.7962 (0.7989) lr 5.7422e-04 eta 0:07:57
epoch [34/50] batch [280/319] time 0.083 (0.092) data 0.000 (0.010) loss 1.8793 (2.1668) ce_loss 0.7461 (0.9982) loss_zs_kd 1.8237 (1.7693) loss_oracle 0.7454 (0.7456) acc 81.2500 (62.7679) kd_loss 0.7605 (0.7958) lr 5.7422e-04 eta 0:07:52
epoch [34/50] batch [300/319] time 0.081 (0.091) data 0.000 (0.009) loss 2.0389 (2.1673) ce_loss 1.0342 (0.9990) loss_zs_kd 1.9128 (1.7692) loss_oracle 0.7019 (0.7464) acc 68.7500 (62.7500) kd_loss 0.6537 (0.7951) lr 5.7422e-04 eta 0:07:48
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,005
* accuracy: 68.6%
* error: 31.4%
* macro_f1: 61.9%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,267
* accuracy: 54.1%
* error: 45.9%
* macro_f1: 24.2%
******* Domain 2 best val acc:      68.6%, epoch: 34 *******
******* Domain 2 best val test acc: 54.1%, epoch: 34 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [35/50] batch [20/319] time 0.080 (0.269) data 0.000 (0.182) loss 2.3262 (2.1348) ce_loss 1.0957 (0.9952) loss_zs_kd 1.7532 (1.8099) loss_oracle 0.7415 (0.7052) acc 53.1250 (64.2188) kd_loss 0.8598 (0.7869) lr 5.1825e-04 eta 0:22:48
epoch [35/50] batch [40/319] time 0.073 (0.175) data 0.000 (0.091) loss 2.0737 (2.1317) ce_loss 0.9541 (0.9875) loss_zs_kd 1.9184 (1.7956) loss_oracle 0.6988 (0.7176) acc 68.7500 (64.1406) kd_loss 0.7702 (0.7854) lr 5.1825e-04 eta 0:14:45
epoch [35/50] batch [60/319] time 0.086 (0.144) data 0.000 (0.061) loss 2.1862 (2.1527) ce_loss 1.0098 (1.0011) loss_zs_kd 1.8924 (1.7863) loss_oracle 0.7954 (0.7152) acc 65.6250 (63.2292) kd_loss 0.7787 (0.7940) lr 5.1825e-04 eta 0:12:08
epoch [35/50] batch [80/319] time 0.077 (0.129) data 0.000 (0.046) loss 2.0660 (2.1374) ce_loss 1.0361 (0.9921) loss_zs_kd 1.7147 (1.7859) loss_oracle 0.6764 (0.7231) acc 65.6250 (63.9062) kd_loss 0.6916 (0.7837) lr 5.1825e-04 eta 0:10:48
epoch [35/50] batch [100/319] time 0.080 (0.119) data 0.000 (0.037) loss 2.1899 (2.1349) ce_loss 1.0957 (0.9835) loss_zs_kd 2.0130 (1.7942) loss_oracle 0.7546 (0.7240) acc 65.6250 (64.3750) kd_loss 0.7169 (0.7894) lr 5.1825e-04 eta 0:09:55
epoch [35/50] batch [120/319] time 0.076 (0.113) data 0.000 (0.030) loss 2.1093 (2.1388) ce_loss 0.9658 (0.9883) loss_zs_kd 1.8321 (1.7933) loss_oracle 0.7583 (0.7261) acc 68.7500 (63.9323) kd_loss 0.7644 (0.7874) lr 5.1825e-04 eta 0:09:22
epoch [35/50] batch [140/319] time 0.079 (0.108) data 0.000 (0.026) loss 2.1351 (2.1348) ce_loss 1.0293 (0.9846) loss_zs_kd 1.6384 (1.8019) loss_oracle 0.6706 (0.7244) acc 62.5000 (63.8616) kd_loss 0.7705 (0.7880) lr 5.1825e-04 eta 0:08:57
epoch [35/50] batch [160/319] time 0.084 (0.105) data 0.000 (0.023) loss 2.2344 (2.1380) ce_loss 1.1113 (0.9864) loss_zs_kd 1.7823 (1.8094) loss_oracle 0.7244 (0.7248) acc 62.5000 (63.7305) kd_loss 0.7609 (0.7891) lr 5.1825e-04 eta 0:08:40
epoch [35/50] batch [180/319] time 0.085 (0.103) data 0.000 (0.020) loss 2.3232 (2.1498) ce_loss 1.2676 (0.9958) loss_zs_kd 1.5986 (1.8092) loss_oracle 0.7256 (0.7270) acc 53.1250 (63.5243) kd_loss 0.6929 (0.7905) lr 5.1825e-04 eta 0:08:27
epoch [35/50] batch [200/319] time 0.085 (0.101) data 0.000 (0.018) loss 2.2345 (2.1606) ce_loss 1.1201 (1.0044) loss_zs_kd 1.5490 (1.8077) loss_oracle 0.6470 (0.7295) acc 53.1250 (63.0312) kd_loss 0.7909 (0.7914) lr 5.1825e-04 eta 0:08:14
epoch [35/50] batch [220/319] time 0.091 (0.099) data 0.000 (0.017) loss 2.2986 (2.1555) ce_loss 1.1748 (0.9973) loss_zs_kd 1.6712 (1.8015) loss_oracle 0.6834 (0.7315) acc 62.5000 (63.4659) kd_loss 0.7821 (0.7925) lr 5.1825e-04 eta 0:08:04
epoch [35/50] batch [240/319] time 0.081 (0.098) data 0.000 (0.015) loss 2.2138 (2.1610) ce_loss 0.9771 (0.9992) loss_zs_kd 1.9766 (1.7966) loss_oracle 0.7298 (0.7340) acc 59.3750 (63.3464) kd_loss 0.8718 (0.7948) lr 5.1825e-04 eta 0:07:56
epoch [35/50] batch [260/319] time 0.077 (0.096) data 0.000 (0.014) loss 1.8822 (2.1579) ce_loss 0.7280 (0.9960) loss_zs_kd 1.6674 (1.7922) loss_oracle 0.7715 (0.7339) acc 81.2500 (63.3654) kd_loss 0.7684 (0.7949) lr 5.1825e-04 eta 0:07:46
epoch [35/50] batch [280/319] time 0.086 (0.096) data 0.000 (0.013) loss 2.3147 (2.1597) ce_loss 1.0889 (0.9991) loss_zs_kd 1.9665 (1.7961) loss_oracle 0.7384 (0.7352) acc 59.3750 (63.2143) kd_loss 0.8566 (0.7930) lr 5.1825e-04 eta 0:07:41
epoch [35/50] batch [300/319] time 0.075 (0.095) data 0.000 (0.012) loss 2.0074 (2.1580) ce_loss 0.8345 (0.9979) loss_zs_kd 1.7883 (1.7970) loss_oracle 0.6804 (0.7356) acc 71.8750 (63.3438) kd_loss 0.8327 (0.7923) lr 5.1825e-04 eta 0:07:35
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,898
* accuracy: 66.2%
* error: 33.8%
* macro_f1: 60.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,445
* accuracy: 55.9%
* error: 44.1%
* macro_f1: 25.2%
******* Domain 2 best val acc:      68.6%, epoch: 34 *******
******* Domain 2 best val test acc: 54.1%, epoch: 34 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [36/50] batch [20/319] time 0.083 (0.259) data 0.000 (0.172) loss 2.2219 (2.2007) ce_loss 1.0078 (1.0611) loss_zs_kd 1.3841 (1.8862) loss_oracle 0.8070 (0.7202) acc 59.3750 (59.8438) kd_loss 0.8106 (0.7795) lr 4.6417e-04 eta 0:20:33
epoch [36/50] batch [40/319] time 0.078 (0.170) data 0.000 (0.086) loss 2.3187 (2.2139) ce_loss 1.0898 (1.0655) loss_zs_kd 1.7017 (1.8724) loss_oracle 0.7344 (0.7302) acc 53.1250 (60.3125) kd_loss 0.8616 (0.7833) lr 4.6417e-04 eta 0:13:26
epoch [36/50] batch [60/319] time 0.092 (0.142) data 0.000 (0.058) loss 2.2778 (2.1773) ce_loss 0.9917 (1.0326) loss_zs_kd 1.9857 (1.8690) loss_oracle 0.7313 (0.7322) acc 68.7500 (61.9792) kd_loss 0.9205 (0.7785) lr 4.6417e-04 eta 0:11:09
epoch [36/50] batch [80/319] time 0.083 (0.128) data 0.000 (0.043) loss 1.9346 (2.1803) ce_loss 0.9795 (1.0367) loss_zs_kd 1.8732 (1.8455) loss_oracle 0.6932 (0.7347) acc 65.6250 (61.4453) kd_loss 0.6085 (0.7763) lr 4.6417e-04 eta 0:10:00
epoch [36/50] batch [100/319] time 0.085 (0.119) data 0.000 (0.035) loss 1.9688 (2.1659) ce_loss 0.9126 (1.0262) loss_zs_kd 2.1202 (1.8302) loss_oracle 0.6846 (0.7311) acc 75.0000 (61.8125) kd_loss 0.7139 (0.7742) lr 4.6417e-04 eta 0:09:19
epoch [36/50] batch [120/319] time 0.083 (0.114) data 0.000 (0.029) loss 2.0741 (2.1695) ce_loss 0.9268 (1.0256) loss_zs_kd 1.9183 (1.8197) loss_oracle 0.6733 (0.7288) acc 65.6250 (61.7969) kd_loss 0.8107 (0.7795) lr 4.6417e-04 eta 0:08:51
epoch [36/50] batch [140/319] time 0.080 (0.109) data 0.000 (0.025) loss 2.1354 (2.1642) ce_loss 0.8853 (1.0187) loss_zs_kd 1.6410 (1.8168) loss_oracle 0.6857 (0.7259) acc 65.6250 (61.9866) kd_loss 0.9073 (0.7826) lr 4.6417e-04 eta 0:08:25
epoch [36/50] batch [160/319] time 0.081 (0.105) data 0.000 (0.022) loss 2.1919 (2.1620) ce_loss 0.9395 (1.0129) loss_zs_kd 1.5186 (1.8119) loss_oracle 0.7681 (0.7267) acc 71.8750 (62.3242) kd_loss 0.8684 (0.7857) lr 4.6417e-04 eta 0:08:05
epoch [36/50] batch [180/319] time 0.088 (0.102) data 0.000 (0.019) loss 2.2401 (2.1586) ce_loss 1.1465 (1.0076) loss_zs_kd 2.0170 (1.8060) loss_oracle 0.6820 (0.7283) acc 56.2500 (62.6215) kd_loss 0.7526 (0.7868) lr 4.6417e-04 eta 0:07:51
epoch [36/50] batch [200/319] time 0.087 (0.101) data 0.001 (0.018) loss 2.2289 (2.1655) ce_loss 0.8657 (1.0087) loss_zs_kd 1.7372 (1.8090) loss_oracle 0.8641 (0.7317) acc 65.6250 (62.4219) kd_loss 0.9311 (0.7910) lr 4.6417e-04 eta 0:07:41
epoch [36/50] batch [220/319] time 0.084 (0.099) data 0.000 (0.016) loss 2.1338 (2.1616) ce_loss 0.9507 (1.0060) loss_zs_kd 1.9607 (1.8154) loss_oracle 0.6727 (0.7323) acc 62.5000 (62.4574) kd_loss 0.8467 (0.7894) lr 4.6417e-04 eta 0:07:33
epoch [36/50] batch [240/319] time 0.085 (0.098) data 0.000 (0.015) loss 2.1967 (2.1627) ce_loss 0.8647 (1.0075) loss_zs_kd 1.8536 (1.8215) loss_oracle 0.9178 (0.7339) acc 65.6250 (62.3828) kd_loss 0.8731 (0.7882) lr 4.6417e-04 eta 0:07:25
epoch [36/50] batch [260/319] time 0.082 (0.097) data 0.000 (0.014) loss 2.2213 (2.1660) ce_loss 1.0078 (1.0075) loss_zs_kd 1.6391 (1.8212) loss_oracle 0.8189 (0.7368) acc 65.6250 (62.1755) kd_loss 0.8040 (0.7901) lr 4.6417e-04 eta 0:07:19
epoch [36/50] batch [280/319] time 0.084 (0.096) data 0.000 (0.013) loss 2.3435 (2.1687) ce_loss 1.2070 (1.0066) loss_zs_kd 1.7437 (1.8189) loss_oracle 0.7685 (0.7366) acc 65.6250 (62.0982) kd_loss 0.7523 (0.7938) lr 4.6417e-04 eta 0:07:12
epoch [36/50] batch [300/319] time 0.081 (0.095) data 0.000 (0.012) loss 2.3793 (2.1690) ce_loss 1.2070 (1.0054) loss_zs_kd 1.9031 (1.8181) loss_oracle 0.7526 (0.7377) acc 46.8750 (62.2812) kd_loss 0.7959 (0.7948) lr 4.6417e-04 eta 0:07:07
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,984
* accuracy: 68.2%
* error: 31.8%
* macro_f1: 61.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,583
* accuracy: 57.3%
* error: 42.7%
* macro_f1: 25.9%
******* Domain 2 best val acc:      68.6%, epoch: 34 *******
******* Domain 2 best val test acc: 54.1%, epoch: 34 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [37/50] batch [20/319] time 0.083 (0.272) data 0.000 (0.183) loss 2.0206 (2.1286) ce_loss 0.8379 (0.9654) loss_zs_kd 1.9723 (1.7575) loss_oracle 0.8728 (0.7562) acc 59.3750 (64.2188) kd_loss 0.7463 (0.7851) lr 4.1221e-04 eta 0:20:07
epoch [37/50] batch [40/319] time 0.087 (0.177) data 0.000 (0.092) loss 2.4135 (2.1052) ce_loss 1.1963 (0.9599) loss_zs_kd 1.6954 (1.7373) loss_oracle 0.7581 (0.7348) acc 53.1250 (64.8438) kd_loss 0.8382 (0.7778) lr 4.1221e-04 eta 0:13:03
epoch [37/50] batch [60/319] time 0.083 (0.146) data 0.000 (0.061) loss 1.9184 (2.1259) ce_loss 0.7915 (0.9752) loss_zs_kd 1.9384 (1.7407) loss_oracle 0.8310 (0.7423) acc 75.0000 (64.4792) kd_loss 0.7114 (0.7796) lr 4.1221e-04 eta 0:10:42
epoch [37/50] batch [80/319] time 0.088 (0.131) data 0.000 (0.046) loss 2.2845 (2.1618) ce_loss 1.1191 (0.9985) loss_zs_kd 1.7136 (1.7652) loss_oracle 0.6808 (0.7416) acc 56.2500 (63.7109) kd_loss 0.8249 (0.7924) lr 4.1221e-04 eta 0:09:32
epoch [37/50] batch [100/319] time 0.090 (0.121) data 0.000 (0.037) loss 2.3175 (2.1503) ce_loss 1.2363 (0.9902) loss_zs_kd 1.8262 (1.7597) loss_oracle 0.6804 (0.7332) acc 50.0000 (63.8750) kd_loss 0.7409 (0.7935) lr 4.1221e-04 eta 0:08:46
epoch [37/50] batch [120/319] time 0.076 (0.113) data 0.000 (0.031) loss 2.3687 (2.1516) ce_loss 1.1455 (0.9939) loss_zs_kd 1.7865 (1.7664) loss_oracle 0.7446 (0.7303) acc 56.2500 (63.6458) kd_loss 0.8509 (0.7925) lr 4.1221e-04 eta 0:08:12
epoch [37/50] batch [140/319] time 0.070 (0.108) data 0.000 (0.026) loss 1.9619 (2.1474) ce_loss 0.8228 (0.9916) loss_zs_kd 1.7018 (1.7806) loss_oracle 0.7697 (0.7301) acc 59.3750 (63.5491) kd_loss 0.7543 (0.7907) lr 4.1221e-04 eta 0:07:46
epoch [37/50] batch [160/319] time 0.081 (0.104) data 0.000 (0.023) loss 2.2549 (2.1522) ce_loss 1.0762 (0.9960) loss_zs_kd 1.6743 (1.7810) loss_oracle 0.7670 (0.7374) acc 59.3750 (63.3984) kd_loss 0.7953 (0.7875) lr 4.1221e-04 eta 0:07:28
epoch [37/50] batch [180/319] time 0.082 (0.102) data 0.000 (0.021) loss 2.2119 (2.1596) ce_loss 1.0947 (1.0001) loss_zs_kd 1.9708 (1.7871) loss_oracle 0.7081 (0.7394) acc 65.6250 (63.2812) kd_loss 0.7631 (0.7897) lr 4.1221e-04 eta 0:07:15
epoch [37/50] batch [200/319] time 0.075 (0.099) data 0.000 (0.019) loss 2.2748 (2.1583) ce_loss 0.9751 (0.9974) loss_zs_kd 1.8410 (1.7913) loss_oracle 0.8152 (0.7395) acc 68.7500 (63.3281) kd_loss 0.8921 (0.7911) lr 4.1221e-04 eta 0:07:03
epoch [37/50] batch [220/319] time 0.084 (0.098) data 0.000 (0.017) loss 2.2716 (2.1522) ce_loss 1.1465 (0.9921) loss_zs_kd 1.7389 (1.7892) loss_oracle 0.7010 (0.7386) acc 62.5000 (63.5227) kd_loss 0.7746 (0.7908) lr 4.1221e-04 eta 0:06:54
epoch [37/50] batch [240/319] time 0.089 (0.097) data 0.000 (0.015) loss 2.0005 (2.1486) ce_loss 0.9419 (0.9860) loss_zs_kd 1.7284 (1.7882) loss_oracle 0.7219 (0.7397) acc 68.7500 (63.6068) kd_loss 0.6976 (0.7928) lr 4.1221e-04 eta 0:06:47
epoch [37/50] batch [260/319] time 0.087 (0.096) data 0.000 (0.014) loss 2.3965 (2.1566) ce_loss 1.1553 (0.9940) loss_zs_kd 1.8817 (1.7901) loss_oracle 0.7061 (0.7403) acc 59.3750 (63.2332) kd_loss 0.8881 (0.7925) lr 4.1221e-04 eta 0:06:42
epoch [37/50] batch [280/319] time 0.096 (0.095) data 0.001 (0.013) loss 2.1107 (2.1608) ce_loss 0.9526 (0.9961) loss_zs_kd 1.6755 (1.7913) loss_oracle 0.7244 (0.7403) acc 56.2500 (63.0915) kd_loss 0.7959 (0.7945) lr 4.1221e-04 eta 0:06:37
epoch [37/50] batch [300/319] time 0.065 (0.094) data 0.000 (0.012) loss 2.0206 (2.1567) ce_loss 0.9834 (0.9944) loss_zs_kd 1.9465 (1.7931) loss_oracle 0.6453 (0.7410) acc 68.7500 (63.1875) kd_loss 0.7145 (0.7918) lr 4.1221e-04 eta 0:06:31
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,998
* accuracy: 68.5%
* error: 31.5%
* macro_f1: 61.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,370
* accuracy: 55.2%
* error: 44.8%
* macro_f1: 24.8%
******* Domain 2 best val acc:      68.6%, epoch: 34 *******
******* Domain 2 best val test acc: 54.1%, epoch: 34 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [38/50] batch [20/319] time 0.083 (0.285) data 0.000 (0.205) loss 2.0742 (2.1880) ce_loss 0.9141 (1.0323) loss_zs_kd 2.1435 (1.7785) loss_oracle 0.7573 (0.7521) acc 68.7500 (62.0312) kd_loss 0.7815 (0.7797) lr 3.6258e-04 eta 0:19:37
epoch [38/50] batch [40/319] time 0.079 (0.184) data 0.000 (0.103) loss 2.1806 (2.1838) ce_loss 1.0830 (1.0096) loss_zs_kd 1.8320 (1.7890) loss_oracle 0.6813 (0.7588) acc 65.6250 (62.9688) kd_loss 0.7570 (0.7948) lr 3.6258e-04 eta 0:12:36
epoch [38/50] batch [60/319] time 0.086 (0.151) data 0.000 (0.069) loss 2.2563 (2.2075) ce_loss 1.1729 (1.0417) loss_zs_kd 2.0828 (1.7908) loss_oracle 0.7657 (0.7524) acc 68.7500 (62.1875) kd_loss 0.7006 (0.7896) lr 3.6258e-04 eta 0:10:18
epoch [38/50] batch [80/319] time 0.084 (0.134) data 0.000 (0.051) loss 2.3318 (2.1840) ce_loss 1.1250 (1.0201) loss_zs_kd 2.1608 (1.7960) loss_oracle 0.8686 (0.7482) acc 59.3750 (62.9297) kd_loss 0.7725 (0.7898) lr 3.6258e-04 eta 0:09:04
epoch [38/50] batch [100/319] time 0.084 (0.124) data 0.000 (0.041) loss 2.1706 (2.1807) ce_loss 0.8936 (1.0112) loss_zs_kd 1.7889 (1.8083) loss_oracle 0.7869 (0.7505) acc 71.8750 (63.0000) kd_loss 0.8836 (0.7943) lr 3.6258e-04 eta 0:08:21
epoch [38/50] batch [120/319] time 0.075 (0.116) data 0.000 (0.034) loss 2.0085 (2.1843) ce_loss 0.8945 (1.0120) loss_zs_kd 1.9506 (1.8021) loss_oracle 0.7432 (0.7542) acc 65.6250 (62.5260) kd_loss 0.7423 (0.7953) lr 3.6258e-04 eta 0:07:48
epoch [38/50] batch [140/319] time 0.081 (0.111) data 0.000 (0.030) loss 2.2135 (2.1904) ce_loss 1.1367 (1.0141) loss_zs_kd 1.8740 (1.8033) loss_oracle 0.5954 (0.7542) acc 46.8750 (62.2768) kd_loss 0.7791 (0.7992) lr 3.6258e-04 eta 0:07:26
epoch [38/50] batch [160/319] time 0.077 (0.107) data 0.000 (0.026) loss 2.1886 (2.1871) ce_loss 1.0127 (1.0129) loss_zs_kd 1.6788 (1.7982) loss_oracle 0.6701 (0.7515) acc 56.2500 (62.1875) kd_loss 0.8409 (0.7984) lr 3.6258e-04 eta 0:07:07
epoch [38/50] batch [180/319] time 0.085 (0.104) data 0.000 (0.023) loss 2.2367 (2.1920) ce_loss 0.9292 (1.0155) loss_zs_kd 1.6745 (1.7959) loss_oracle 0.8813 (0.7539) acc 65.6250 (62.1701) kd_loss 0.8669 (0.7995) lr 3.6258e-04 eta 0:06:52
epoch [38/50] batch [200/319] time 0.073 (0.102) data 0.000 (0.021) loss 2.2104 (2.1943) ce_loss 1.0010 (1.0179) loss_zs_kd 1.7834 (1.7990) loss_oracle 0.7992 (0.7544) acc 53.1250 (61.7656) kd_loss 0.8098 (0.7992) lr 3.6258e-04 eta 0:06:42
epoch [38/50] batch [220/319] time 0.088 (0.100) data 0.000 (0.019) loss 2.1094 (2.1904) ce_loss 0.9541 (1.0130) loss_zs_kd 1.7156 (1.7948) loss_oracle 0.7900 (0.7564) acc 68.7500 (61.9602) kd_loss 0.7603 (0.7992) lr 3.6258e-04 eta 0:06:33
epoch [38/50] batch [240/319] time 0.089 (0.099) data 0.000 (0.017) loss 1.9083 (2.1834) ce_loss 0.7251 (1.0081) loss_zs_kd 1.6738 (1.8002) loss_oracle 0.7796 (0.7561) acc 68.7500 (62.1875) kd_loss 0.7934 (0.7972) lr 3.6258e-04 eta 0:06:25
epoch [38/50] batch [260/319] time 0.076 (0.098) data 0.000 (0.016) loss 2.7046 (2.1832) ce_loss 1.4209 (1.0078) loss_zs_kd 1.9556 (1.7974) loss_oracle 0.7717 (0.7553) acc 43.7500 (62.1755) kd_loss 0.8978 (0.7978) lr 3.6258e-04 eta 0:06:19
epoch [38/50] batch [280/319] time 0.081 (0.097) data 0.000 (0.015) loss 1.8043 (2.1817) ce_loss 0.7866 (1.0073) loss_zs_kd 1.6085 (1.8003) loss_oracle 0.6168 (0.7543) acc 68.7500 (62.0759) kd_loss 0.7093 (0.7973) lr 3.6258e-04 eta 0:06:13
epoch [38/50] batch [300/319] time 0.083 (0.096) data 0.000 (0.014) loss 2.1839 (2.1808) ce_loss 1.1318 (1.0073) loss_zs_kd 1.7069 (1.8013) loss_oracle 0.6980 (0.7519) acc 71.8750 (62.1667) kd_loss 0.7030 (0.7975) lr 3.6258e-04 eta 0:06:07
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,954
* accuracy: 67.5%
* error: 32.5%
* macro_f1: 60.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,546
* accuracy: 57.0%
* error: 43.0%
* macro_f1: 25.4%
******* Domain 2 best val acc:      68.6%, epoch: 34 *******
******* Domain 2 best val test acc: 54.1%, epoch: 34 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [39/50] batch [20/319] time 0.089 (0.225) data 0.000 (0.138) loss 2.0205 (2.1278) ce_loss 0.9219 (0.9917) loss_zs_kd 2.0427 (1.8058) loss_oracle 0.7630 (0.7260) acc 65.6250 (66.4062) kd_loss 0.7172 (0.7731) lr 3.1545e-04 eta 0:14:16
epoch [39/50] batch [40/319] time 0.075 (0.155) data 0.000 (0.069) loss 2.5799 (2.1438) ce_loss 1.2822 (0.9931) loss_zs_kd 1.6870 (1.8148) loss_oracle 0.7565 (0.7277) acc 53.1250 (64.8438) kd_loss 0.9194 (0.7868) lr 3.1545e-04 eta 0:09:45
epoch [39/50] batch [60/319] time 0.076 (0.130) data 0.000 (0.046) loss 1.8514 (2.1432) ce_loss 0.7754 (0.9914) loss_zs_kd 1.8452 (1.8140) loss_oracle 0.7299 (0.7331) acc 75.0000 (64.1667) kd_loss 0.7111 (0.7852) lr 3.1545e-04 eta 0:08:08
epoch [39/50] batch [80/319] time 0.081 (0.118) data 0.000 (0.035) loss 2.1658 (2.1475) ce_loss 1.0459 (0.9903) loss_zs_kd 2.0181 (1.8213) loss_oracle 0.6768 (0.7431) acc 62.5000 (63.8672) kd_loss 0.7815 (0.7856) lr 3.1545e-04 eta 0:07:23
epoch [39/50] batch [100/319] time 0.087 (0.112) data 0.000 (0.028) loss 2.3576 (2.1602) ce_loss 1.2930 (0.9978) loss_zs_kd 1.8905 (1.8150) loss_oracle 0.7416 (0.7455) acc 53.1250 (63.3438) kd_loss 0.6938 (0.7897) lr 3.1545e-04 eta 0:06:55
epoch [39/50] batch [120/319] time 0.080 (0.107) data 0.000 (0.023) loss 2.2571 (2.1460) ce_loss 1.1328 (0.9940) loss_zs_kd 1.4673 (1.8119) loss_oracle 0.7597 (0.7382) acc 62.5000 (63.5156) kd_loss 0.7444 (0.7830) lr 3.1545e-04 eta 0:06:35
epoch [39/50] batch [140/319] time 0.080 (0.103) data 0.000 (0.020) loss 1.9517 (2.1400) ce_loss 0.7695 (0.9915) loss_zs_kd 1.9454 (1.8073) loss_oracle 0.6954 (0.7385) acc 68.7500 (63.7723) kd_loss 0.8345 (0.7793) lr 3.1545e-04 eta 0:06:19
epoch [39/50] batch [160/319] time 0.072 (0.099) data 0.000 (0.017) loss 1.9551 (2.1342) ce_loss 0.8311 (0.9871) loss_zs_kd 2.1442 (1.8108) loss_oracle 0.7636 (0.7381) acc 62.5000 (63.6719) kd_loss 0.7422 (0.7780) lr 3.1545e-04 eta 0:06:04
epoch [39/50] batch [180/319] time 0.083 (0.096) data 0.000 (0.016) loss 2.1299 (2.1415) ce_loss 0.8291 (0.9886) loss_zs_kd 1.9215 (1.8058) loss_oracle 0.8198 (0.7414) acc 78.1250 (63.4549) kd_loss 0.8910 (0.7821) lr 3.1545e-04 eta 0:05:51
epoch [39/50] batch [200/319] time 0.083 (0.095) data 0.000 (0.014) loss 2.1349 (2.1409) ce_loss 1.0137 (0.9868) loss_zs_kd 1.5118 (1.7957) loss_oracle 0.7415 (0.7402) acc 75.0000 (63.6562) kd_loss 0.7505 (0.7840) lr 3.1545e-04 eta 0:05:45
epoch [39/50] batch [220/319] time 0.072 (0.094) data 0.000 (0.013) loss 2.1940 (2.1396) ce_loss 0.9272 (0.9849) loss_zs_kd 1.7926 (1.7932) loss_oracle 0.8711 (0.7375) acc 78.1250 (63.7642) kd_loss 0.8312 (0.7860) lr 3.1545e-04 eta 0:05:38
epoch [39/50] batch [240/319] time 0.083 (0.093) data 0.000 (0.012) loss 2.4172 (2.1437) ce_loss 1.2588 (0.9881) loss_zs_kd 1.7876 (1.7894) loss_oracle 0.7200 (0.7381) acc 50.0000 (63.5938) kd_loss 0.7984 (0.7865) lr 3.1545e-04 eta 0:05:33
epoch [39/50] batch [260/319] time 0.082 (0.092) data 0.000 (0.011) loss 1.9434 (2.1475) ce_loss 0.8369 (0.9895) loss_zs_kd 1.6389 (1.7906) loss_oracle 0.6554 (0.7394) acc 68.7500 (63.4736) kd_loss 0.7788 (0.7884) lr 3.1545e-04 eta 0:05:26
epoch [39/50] batch [280/319] time 0.084 (0.091) data 0.000 (0.010) loss 2.6833 (2.1513) ce_loss 1.4668 (0.9939) loss_zs_kd 1.7830 (1.7868) loss_oracle 0.8627 (0.7409) acc 46.8750 (63.3147) kd_loss 0.7852 (0.7869) lr 3.1545e-04 eta 0:05:23
epoch [39/50] batch [300/319] time 0.079 (0.091) data 0.000 (0.009) loss 2.0964 (2.1526) ce_loss 0.9746 (0.9962) loss_zs_kd 1.9277 (1.7880) loss_oracle 0.7242 (0.7406) acc 68.7500 (63.3229) kd_loss 0.7596 (0.7861) lr 3.1545e-04 eta 0:05:19
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,997
* accuracy: 68.5%
* error: 31.5%
* macro_f1: 60.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,436
* accuracy: 55.8%
* error: 44.2%
* macro_f1: 24.5%
******* Domain 2 best val acc:      68.6%, epoch: 34 *******
******* Domain 2 best val test acc: 54.1%, epoch: 34 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [40/50] batch [20/319] time 0.079 (0.194) data 0.000 (0.110) loss 2.3869 (2.0780) ce_loss 1.1133 (0.9357) loss_zs_kd 1.5504 (1.7440) loss_oracle 0.7376 (0.7069) acc 56.2500 (66.4062) kd_loss 0.9048 (0.7889) lr 2.7103e-04 eta 0:11:17
epoch [40/50] batch [40/319] time 0.086 (0.138) data 0.000 (0.055) loss 1.9542 (2.1388) ce_loss 0.9233 (0.9932) loss_zs_kd 1.5878 (1.7717) loss_oracle 0.7308 (0.7290) acc 65.6250 (63.6719) kd_loss 0.6654 (0.7811) lr 2.7103e-04 eta 0:07:59
epoch [40/50] batch [60/319] time 0.094 (0.121) data 0.000 (0.037) loss 2.1396 (2.1528) ce_loss 0.9395 (0.9945) loss_zs_kd 1.9662 (1.7894) loss_oracle 0.7847 (0.7387) acc 56.2500 (64.0104) kd_loss 0.8078 (0.7890) lr 2.7103e-04 eta 0:06:57
epoch [40/50] batch [80/319] time 0.079 (0.110) data 0.000 (0.028) loss 2.2112 (2.1434) ce_loss 1.0010 (0.9742) loss_zs_kd 1.5542 (1.7940) loss_oracle 0.8126 (0.7470) acc 56.2500 (64.2188) kd_loss 0.8039 (0.7957) lr 2.7103e-04 eta 0:06:17
epoch [40/50] batch [100/319] time 0.088 (0.105) data 0.000 (0.022) loss 2.0915 (2.1456) ce_loss 0.9209 (0.9765) loss_zs_kd 1.4955 (1.7754) loss_oracle 0.7620 (0.7419) acc 65.6250 (64.0000) kd_loss 0.7896 (0.7982) lr 2.7103e-04 eta 0:05:59
epoch [40/50] batch [120/319] time 0.086 (0.102) data 0.000 (0.019) loss 1.8858 (2.1418) ce_loss 0.7661 (0.9722) loss_zs_kd 1.8907 (1.7831) loss_oracle 0.7426 (0.7419) acc 75.0000 (64.0104) kd_loss 0.7483 (0.7987) lr 2.7103e-04 eta 0:05:45
epoch [40/50] batch [140/319] time 0.089 (0.100) data 0.000 (0.016) loss 2.3158 (2.1534) ce_loss 1.1426 (0.9828) loss_zs_kd 1.8887 (1.7717) loss_oracle 0.7314 (0.7467) acc 62.5000 (63.8170) kd_loss 0.8075 (0.7972) lr 2.7103e-04 eta 0:05:35
epoch [40/50] batch [160/319] time 0.082 (0.098) data 0.000 (0.014) loss 2.1761 (2.1494) ce_loss 0.9458 (0.9787) loss_zs_kd 1.8114 (1.7797) loss_oracle 0.8553 (0.7478) acc 62.5000 (63.8281) kd_loss 0.8027 (0.7968) lr 2.7103e-04 eta 0:05:26
epoch [40/50] batch [180/319] time 0.075 (0.095) data 0.000 (0.013) loss 2.5572 (2.1481) ce_loss 1.3516 (0.9792) loss_zs_kd 1.7249 (1.7855) loss_oracle 0.7572 (0.7453) acc 56.2500 (63.6632) kd_loss 0.8270 (0.7963) lr 2.7103e-04 eta 0:05:17
epoch [40/50] batch [200/319] time 0.074 (0.094) data 0.000 (0.011) loss 2.0174 (2.1599) ce_loss 0.9873 (0.9917) loss_zs_kd 1.7316 (1.7810) loss_oracle 0.6126 (0.7467) acc 56.2500 (63.2188) kd_loss 0.7238 (0.7949) lr 2.7103e-04 eta 0:05:10
epoch [40/50] batch [220/319] time 0.088 (0.092) data 0.000 (0.010) loss 2.2660 (2.1668) ce_loss 1.1123 (0.9978) loss_zs_kd 1.8830 (1.7825) loss_oracle 0.6527 (0.7453) acc 53.1250 (62.8267) kd_loss 0.8273 (0.7964) lr 2.7103e-04 eta 0:05:03
epoch [40/50] batch [240/319] time 0.078 (0.091) data 0.000 (0.009) loss 2.3946 (2.1685) ce_loss 1.1768 (0.9961) loss_zs_kd 1.6251 (1.7822) loss_oracle 0.7004 (0.7471) acc 56.2500 (62.9948) kd_loss 0.8676 (0.7988) lr 2.7103e-04 eta 0:04:58
epoch [40/50] batch [260/319] time 0.084 (0.091) data 0.000 (0.009) loss 2.4087 (2.1701) ce_loss 1.0732 (0.9969) loss_zs_kd 1.8710 (1.7847) loss_oracle 0.7248 (0.7457) acc 62.5000 (62.9207) kd_loss 0.9731 (0.8004) lr 2.7103e-04 eta 0:04:54
epoch [40/50] batch [280/319] time 0.076 (0.090) data 0.000 (0.008) loss 2.5029 (2.1732) ce_loss 1.2031 (0.9995) loss_zs_kd 1.7267 (1.7839) loss_oracle 0.7634 (0.7444) acc 56.2500 (62.7679) kd_loss 0.9180 (0.8015) lr 2.7103e-04 eta 0:04:49
epoch [40/50] batch [300/319] time 0.084 (0.089) data 0.000 (0.008) loss 2.2542 (2.1768) ce_loss 1.1895 (1.0023) loss_zs_kd 1.6764 (1.7854) loss_oracle 0.7259 (0.7446) acc 56.2500 (62.7292) kd_loss 0.7018 (0.8023) lr 2.7103e-04 eta 0:04:46
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,967
* accuracy: 67.8%
* error: 32.2%
* macro_f1: 60.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,255
* accuracy: 54.0%
* error: 46.0%
* macro_f1: 24.4%
******* Domain 2 best val acc:      68.6%, epoch: 34 *******
******* Domain 2 best val test acc: 54.1%, epoch: 34 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [41/50] batch [20/319] time 0.079 (0.211) data 0.000 (0.127) loss 2.2015 (2.1673) ce_loss 0.8838 (0.9790) loss_zs_kd 1.9121 (1.8529) loss_oracle 0.9317 (0.7701) acc 65.6250 (62.9688) kd_loss 0.8519 (0.8033) lr 2.2949e-04 eta 0:11:08
epoch [41/50] batch [40/319] time 0.073 (0.140) data 0.000 (0.063) loss 2.2436 (2.1807) ce_loss 1.0293 (0.9926) loss_zs_kd 2.1191 (1.8610) loss_oracle 0.7456 (0.7747) acc 65.6250 (62.8125) kd_loss 0.8415 (0.8008) lr 2.2949e-04 eta 0:07:21
epoch [41/50] batch [60/319] time 0.063 (0.117) data 0.000 (0.042) loss 2.1699 (2.1851) ce_loss 1.0840 (1.0093) loss_zs_kd 1.5918 (1.8415) loss_oracle 0.6459 (0.7576) acc 56.2500 (62.0833) kd_loss 0.7629 (0.7970) lr 2.2949e-04 eta 0:06:04
epoch [41/50] batch [80/319] time 0.067 (0.104) data 0.000 (0.032) loss 2.1561 (2.1872) ce_loss 1.0078 (1.0129) loss_zs_kd 1.8156 (1.8431) loss_oracle 0.7689 (0.7463) acc 53.1250 (61.9922) kd_loss 0.7639 (0.8012) lr 2.2949e-04 eta 0:05:23
epoch [41/50] batch [100/319] time 0.060 (0.096) data 0.000 (0.026) loss 1.9888 (2.1818) ce_loss 0.8784 (1.0122) loss_zs_kd 1.6367 (1.8363) loss_oracle 0.7522 (0.7429) acc 68.7500 (62.2500) kd_loss 0.7343 (0.7982) lr 2.2949e-04 eta 0:04:57
epoch [41/50] batch [120/319] time 0.063 (0.091) data 0.000 (0.021) loss 2.0667 (2.1874) ce_loss 0.8223 (1.0165) loss_zs_kd 1.7303 (1.8303) loss_oracle 0.7069 (0.7423) acc 71.8750 (62.2656) kd_loss 0.8910 (0.7998) lr 2.2949e-04 eta 0:04:39
epoch [41/50] batch [140/319] time 0.078 (0.088) data 0.000 (0.018) loss 1.9677 (2.1846) ce_loss 0.8203 (1.0111) loss_zs_kd 1.8206 (1.8210) loss_oracle 0.6882 (0.7463) acc 68.7500 (62.7679) kd_loss 0.8033 (0.8003) lr 2.2949e-04 eta 0:04:27
epoch [41/50] batch [160/319] time 0.075 (0.087) data 0.000 (0.016) loss 2.1940 (2.1864) ce_loss 1.0322 (1.0116) loss_zs_kd 1.6362 (1.8072) loss_oracle 0.7292 (0.7486) acc 56.2500 (62.6758) kd_loss 0.7972 (0.8005) lr 2.2949e-04 eta 0:04:22
epoch [41/50] batch [180/319] time 0.094 (0.086) data 0.000 (0.014) loss 2.2961 (2.1872) ce_loss 0.9785 (1.0106) loss_zs_kd 1.7931 (1.7999) loss_oracle 0.7494 (0.7512) acc 65.6250 (62.7951) kd_loss 0.9428 (0.8009) lr 2.2949e-04 eta 0:04:18
epoch [41/50] batch [200/319] time 0.078 (0.085) data 0.000 (0.013) loss 2.0389 (2.1832) ce_loss 0.9053 (1.0052) loss_zs_kd 1.7203 (1.7914) loss_oracle 0.7281 (0.7508) acc 65.6250 (62.9531) kd_loss 0.7696 (0.8026) lr 2.2949e-04 eta 0:04:15
epoch [41/50] batch [220/319] time 0.080 (0.086) data 0.000 (0.012) loss 2.4289 (2.1796) ce_loss 1.0908 (1.0020) loss_zs_kd 1.9581 (1.7912) loss_oracle 0.7873 (0.7509) acc 59.3750 (63.1250) kd_loss 0.9444 (0.8022) lr 2.2949e-04 eta 0:04:14
epoch [41/50] batch [240/319] time 0.083 (0.086) data 0.000 (0.011) loss 2.0554 (2.1760) ce_loss 1.0273 (1.0018) loss_zs_kd 1.7821 (1.7911) loss_oracle 0.6681 (0.7495) acc 53.1250 (63.1380) kd_loss 0.6940 (0.7995) lr 2.2949e-04 eta 0:04:12
epoch [41/50] batch [260/319] time 0.087 (0.085) data 0.000 (0.010) loss 2.2246 (2.1764) ce_loss 1.0234 (1.0031) loss_zs_kd 1.8185 (1.7923) loss_oracle 0.6915 (0.7470) acc 59.3750 (62.9207) kd_loss 0.8554 (0.7998) lr 2.2949e-04 eta 0:04:10
epoch [41/50] batch [280/319] time 0.085 (0.085) data 0.000 (0.009) loss 2.0456 (2.1822) ce_loss 0.8359 (1.0050) loss_zs_kd 1.5699 (1.7927) loss_oracle 0.8109 (0.7478) acc 78.1250 (62.7679) kd_loss 0.8042 (0.8033) lr 2.2949e-04 eta 0:04:07
epoch [41/50] batch [300/319] time 0.077 (0.085) data 0.000 (0.009) loss 2.1814 (2.1795) ce_loss 0.9780 (1.0022) loss_zs_kd 1.7413 (1.7922) loss_oracle 0.6828 (0.7469) acc 65.6250 (62.8542) kd_loss 0.8620 (0.8038) lr 2.2949e-04 eta 0:04:05
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,965
* accuracy: 67.7%
* error: 32.3%
* macro_f1: 60.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,324
* accuracy: 54.7%
* error: 45.3%
* macro_f1: 24.1%
******* Domain 2 best val acc:      68.6%, epoch: 34 *******
******* Domain 2 best val test acc: 54.1%, epoch: 34 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [42/50] batch [20/319] time 0.082 (0.265) data 0.000 (0.179) loss 2.3782 (2.2153) ce_loss 1.1064 (1.0298) loss_zs_kd 1.8642 (1.6749) loss_oracle 0.7454 (0.7243) acc 59.3750 (61.5625) kd_loss 0.8991 (0.8234) lr 1.9098e-04 eta 0:12:35
epoch [42/50] batch [40/319] time 0.086 (0.172) data 0.000 (0.089) loss 1.7822 (2.1873) ce_loss 0.7129 (1.0176) loss_zs_kd 1.7390 (1.7123) loss_oracle 0.5978 (0.7303) acc 75.0000 (62.3438) kd_loss 0.7704 (0.8046) lr 1.9098e-04 eta 0:08:06
epoch [42/50] batch [60/319] time 0.090 (0.142) data 0.000 (0.060) loss 2.2000 (2.1962) ce_loss 1.0723 (1.0211) loss_zs_kd 1.5388 (1.7276) loss_oracle 0.7720 (0.7395) acc 53.1250 (61.6146) kd_loss 0.7417 (0.8054) lr 1.9098e-04 eta 0:06:39
epoch [42/50] batch [80/319] time 0.083 (0.128) data 0.000 (0.045) loss 2.2763 (2.1947) ce_loss 1.0195 (1.0166) loss_zs_kd 1.6239 (1.7408) loss_oracle 0.7893 (0.7431) acc 53.1250 (61.7578) kd_loss 0.8621 (0.8065) lr 1.9098e-04 eta 0:05:56
epoch [42/50] batch [100/319] time 0.085 (0.120) data 0.000 (0.036) loss 2.7640 (2.2075) ce_loss 1.4922 (1.0248) loss_zs_kd 1.8853 (1.7548) loss_oracle 0.7317 (0.7444) acc 43.7500 (61.5000) kd_loss 0.9060 (0.8105) lr 1.9098e-04 eta 0:05:31
epoch [42/50] batch [120/319] time 0.083 (0.114) data 0.000 (0.030) loss 2.0438 (2.1962) ce_loss 0.9907 (1.0141) loss_zs_kd 1.9189 (1.7716) loss_oracle 0.7414 (0.7437) acc 65.6250 (61.7188) kd_loss 0.6824 (0.8103) lr 1.9098e-04 eta 0:05:13
epoch [42/50] batch [140/319] time 0.088 (0.110) data 0.000 (0.026) loss 1.8636 (2.2013) ce_loss 0.5864 (1.0126) loss_zs_kd 1.9851 (1.7791) loss_oracle 0.7833 (0.7465) acc 81.2500 (61.6295) kd_loss 0.8855 (0.8154) lr 1.9098e-04 eta 0:04:59
epoch [42/50] batch [160/319] time 0.081 (0.106) data 0.000 (0.023) loss 2.5080 (2.2004) ce_loss 1.3145 (1.0149) loss_zs_kd 1.9023 (1.7770) loss_oracle 0.7207 (0.7466) acc 53.1250 (61.6211) kd_loss 0.8332 (0.8122) lr 1.9098e-04 eta 0:04:48
epoch [42/50] batch [180/319] time 0.084 (0.104) data 0.000 (0.020) loss 2.1653 (2.1997) ce_loss 1.0312 (1.0148) loss_zs_kd 1.6875 (1.7803) loss_oracle 0.7315 (0.7458) acc 62.5000 (61.8750) kd_loss 0.7683 (0.8120) lr 1.9098e-04 eta 0:04:39
epoch [42/50] batch [200/319] time 0.089 (0.102) data 0.000 (0.018) loss 2.3219 (2.1938) ce_loss 1.0059 (1.0097) loss_zs_kd 1.6162 (1.7783) loss_oracle 0.8713 (0.7465) acc 59.3750 (61.9844) kd_loss 0.8804 (0.8109) lr 1.9098e-04 eta 0:04:32
epoch [42/50] batch [220/319] time 0.085 (0.102) data 0.000 (0.017) loss 2.4232 (2.1932) ce_loss 1.0996 (1.0058) loss_zs_kd 1.5170 (1.7798) loss_oracle 0.8010 (0.7484) acc 59.3750 (62.1449) kd_loss 0.9231 (0.8133) lr 1.9098e-04 eta 0:04:29
epoch [42/50] batch [240/319] time 0.078 (0.100) data 0.000 (0.015) loss 2.2156 (2.1904) ce_loss 1.0957 (1.0026) loss_zs_kd 1.8576 (1.7832) loss_oracle 0.8041 (0.7486) acc 62.5000 (62.3698) kd_loss 0.7179 (0.8136) lr 1.9098e-04 eta 0:04:24
epoch [42/50] batch [260/319] time 0.087 (0.099) data 0.000 (0.014) loss 2.3294 (2.1872) ce_loss 1.1152 (1.0005) loss_zs_kd 1.8119 (1.7853) loss_oracle 0.7156 (0.7479) acc 53.1250 (62.4639) kd_loss 0.8564 (0.8127) lr 1.9098e-04 eta 0:04:19
epoch [42/50] batch [280/319] time 0.090 (0.098) data 0.000 (0.013) loss 2.3851 (2.1873) ce_loss 1.1201 (1.0004) loss_zs_kd 1.6606 (1.7914) loss_oracle 0.9031 (0.7507) acc 62.5000 (62.6116) kd_loss 0.8134 (0.8116) lr 1.9098e-04 eta 0:04:14
epoch [42/50] batch [300/319] time 0.077 (0.097) data 0.000 (0.012) loss 2.1273 (2.1901) ce_loss 1.0010 (1.0027) loss_zs_kd 1.9187 (1.7953) loss_oracle 0.7853 (0.7522) acc 62.5000 (62.6250) kd_loss 0.7337 (0.8113) lr 1.9098e-04 eta 0:04:10
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,000
* accuracy: 68.5%
* error: 31.5%
* macro_f1: 61.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,399
* accuracy: 55.5%
* error: 44.5%
* macro_f1: 24.7%
******* Domain 2 best val acc:      68.6%, epoch: 34 *******
******* Domain 2 best val test acc: 54.1%, epoch: 34 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [43/50] batch [20/319] time 0.073 (0.267) data 0.000 (0.187) loss 2.0164 (2.1079) ce_loss 0.9082 (0.9628) loss_zs_kd 2.2109 (1.8162) loss_oracle 0.7220 (0.7547) acc 62.5000 (64.6875) kd_loss 0.7472 (0.7677) lr 1.5567e-04 eta 0:11:16
epoch [43/50] batch [40/319] time 0.089 (0.177) data 0.000 (0.094) loss 2.4749 (2.1462) ce_loss 1.3145 (0.9882) loss_zs_kd 1.7323 (1.8004) loss_oracle 0.7918 (0.7500) acc 53.1250 (63.0469) kd_loss 0.7646 (0.7830) lr 1.5567e-04 eta 0:07:23
epoch [43/50] batch [60/319] time 0.076 (0.146) data 0.000 (0.063) loss 2.6239 (2.1594) ce_loss 1.3115 (0.9774) loss_zs_kd 1.8603 (1.8070) loss_oracle 0.7623 (0.7535) acc 50.0000 (63.6458) kd_loss 0.9312 (0.8053) lr 1.5567e-04 eta 0:06:03
epoch [43/50] batch [80/319] time 0.076 (0.130) data 0.000 (0.047) loss 1.9007 (2.1638) ce_loss 0.7910 (0.9813) loss_zs_kd 1.9125 (1.8121) loss_oracle 0.7632 (0.7525) acc 81.2500 (63.9453) kd_loss 0.7280 (0.8062) lr 1.5567e-04 eta 0:05:21
epoch [43/50] batch [100/319] time 0.078 (0.121) data 0.000 (0.038) loss 1.9794 (2.1640) ce_loss 0.8472 (0.9761) loss_zs_kd 1.7583 (1.8022) loss_oracle 0.6922 (0.7510) acc 65.6250 (64.0625) kd_loss 0.7861 (0.8124) lr 1.5567e-04 eta 0:04:55
epoch [43/50] batch [120/319] time 0.084 (0.115) data 0.000 (0.031) loss 2.0708 (2.1644) ce_loss 0.9727 (0.9795) loss_zs_kd 1.9132 (1.7975) loss_oracle 0.7988 (0.7518) acc 62.5000 (64.1667) kd_loss 0.6988 (0.8090) lr 1.5567e-04 eta 0:04:38
epoch [43/50] batch [140/319] time 0.094 (0.110) data 0.000 (0.027) loss 2.4323 (2.1692) ce_loss 1.2520 (0.9845) loss_zs_kd 1.5876 (1.8025) loss_oracle 0.7943 (0.7510) acc 50.0000 (63.7054) kd_loss 0.7832 (0.8093) lr 1.5567e-04 eta 0:04:25
epoch [43/50] batch [160/319] time 0.082 (0.107) data 0.000 (0.024) loss 1.8503 (2.1626) ce_loss 0.7998 (0.9796) loss_zs_kd 2.1381 (1.8051) loss_oracle 0.7317 (0.7514) acc 68.7500 (63.8477) kd_loss 0.6847 (0.8073) lr 1.5567e-04 eta 0:04:15
epoch [43/50] batch [180/319] time 0.076 (0.104) data 0.000 (0.021) loss 1.9321 (2.1712) ce_loss 0.9702 (0.9889) loss_zs_kd 1.6911 (1.8019) loss_oracle 0.6478 (0.7528) acc 68.7500 (63.6979) kd_loss 0.6380 (0.8059) lr 1.5567e-04 eta 0:04:06
epoch [43/50] batch [200/319] time 0.084 (0.101) data 0.000 (0.019) loss 2.2837 (2.1730) ce_loss 1.1260 (0.9923) loss_zs_kd 1.7855 (1.8048) loss_oracle 0.6925 (0.7475) acc 50.0000 (63.4531) kd_loss 0.8115 (0.8069) lr 1.5567e-04 eta 0:03:58
epoch [43/50] batch [220/319] time 0.083 (0.100) data 0.000 (0.017) loss 2.2967 (2.1803) ce_loss 1.1309 (0.9974) loss_zs_kd 1.9805 (1.7979) loss_oracle 0.7604 (0.7488) acc 56.2500 (63.1250) kd_loss 0.7857 (0.8085) lr 1.5567e-04 eta 0:03:52
epoch [43/50] batch [240/319] time 0.088 (0.098) data 0.000 (0.016) loss 2.0890 (2.1781) ce_loss 1.0010 (0.9964) loss_zs_kd 2.0690 (1.7974) loss_oracle 0.6442 (0.7476) acc 56.2500 (63.2552) kd_loss 0.7660 (0.8079) lr 1.5567e-04 eta 0:03:47
epoch [43/50] batch [260/319] time 0.081 (0.097) data 0.000 (0.015) loss 2.1323 (2.1780) ce_loss 0.9058 (0.9961) loss_zs_kd 1.9329 (1.7961) loss_oracle 0.7379 (0.7522) acc 75.0000 (63.2812) kd_loss 0.8576 (0.8058) lr 1.5567e-04 eta 0:03:43
epoch [43/50] batch [280/319] time 0.084 (0.097) data 0.000 (0.014) loss 2.0564 (2.1712) ce_loss 0.8496 (0.9919) loss_zs_kd 1.7914 (1.7946) loss_oracle 0.8249 (0.7502) acc 68.7500 (63.3036) kd_loss 0.7943 (0.8042) lr 1.5567e-04 eta 0:03:39
epoch [43/50] batch [300/319] time 0.089 (0.096) data 0.000 (0.013) loss 2.1524 (2.1710) ce_loss 1.0459 (0.9906) loss_zs_kd 1.6304 (1.7957) loss_oracle 0.6764 (0.7526) acc 62.5000 (63.3229) kd_loss 0.7683 (0.8042) lr 1.5567e-04 eta 0:03:35
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,989
* accuracy: 68.3%
* error: 31.7%
* macro_f1: 60.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,428
* accuracy: 55.8%
* error: 44.2%
* macro_f1: 24.3%
******* Domain 2 best val acc:      68.6%, epoch: 34 *******
******* Domain 2 best val test acc: 54.1%, epoch: 34 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [44/50] batch [20/319] time 0.078 (0.291) data 0.000 (0.203) loss 2.3831 (2.1433) ce_loss 1.2080 (0.9637) loss_zs_kd 1.7122 (1.8343) loss_oracle 0.8660 (0.7751) acc 56.2500 (65.7812) kd_loss 0.7421 (0.7921) lr 1.2369e-04 eta 0:10:44
epoch [44/50] batch [40/319] time 0.088 (0.188) data 0.000 (0.102) loss 2.2755 (2.1741) ce_loss 1.1387 (0.9923) loss_zs_kd 1.5147 (1.8118) loss_oracle 0.7919 (0.7534) acc 62.5000 (63.9062) kd_loss 0.7409 (0.8051) lr 1.2369e-04 eta 0:06:51
epoch [44/50] batch [60/319] time 0.081 (0.151) data 0.000 (0.068) loss 1.8438 (2.1717) ce_loss 0.6509 (0.9875) loss_zs_kd 1.8337 (1.8027) loss_oracle 0.6659 (0.7460) acc 84.3750 (63.7500) kd_loss 0.8599 (0.8111) lr 1.2369e-04 eta 0:05:29
epoch [44/50] batch [80/319] time 0.094 (0.134) data 0.000 (0.051) loss 2.1143 (2.1527) ce_loss 1.0703 (0.9799) loss_zs_kd 1.7549 (1.8097) loss_oracle 0.6657 (0.7405) acc 65.6250 (64.2188) kd_loss 0.7112 (0.8025) lr 1.2369e-04 eta 0:04:49
epoch [44/50] batch [100/319] time 0.078 (0.124) data 0.000 (0.041) loss 2.2188 (2.1493) ce_loss 1.0303 (0.9859) loss_zs_kd 1.7114 (1.8081) loss_oracle 0.7230 (0.7447) acc 59.3750 (63.6875) kd_loss 0.8270 (0.7911) lr 1.2369e-04 eta 0:04:23
epoch [44/50] batch [120/319] time 0.075 (0.116) data 0.000 (0.034) loss 2.2538 (2.1669) ce_loss 1.0938 (1.0006) loss_zs_kd 1.7114 (1.7976) loss_oracle 0.8071 (0.7502) acc 59.3750 (63.1510) kd_loss 0.7565 (0.7912) lr 1.2369e-04 eta 0:04:05
epoch [44/50] batch [140/319] time 0.088 (0.111) data 0.000 (0.029) loss 2.0914 (2.1735) ce_loss 0.9771 (1.0022) loss_zs_kd 1.6675 (1.7953) loss_oracle 0.7229 (0.7551) acc 62.5000 (62.8795) kd_loss 0.7529 (0.7938) lr 1.2369e-04 eta 0:03:51
epoch [44/50] batch [160/319] time 0.084 (0.107) data 0.000 (0.026) loss 2.2908 (2.1784) ce_loss 0.9897 (1.0026) loss_zs_kd 1.6809 (1.8002) loss_oracle 0.7903 (0.7529) acc 62.5000 (62.8516) kd_loss 0.9059 (0.7994) lr 1.2369e-04 eta 0:03:41
epoch [44/50] batch [180/319] time 0.079 (0.104) data 0.000 (0.023) loss 2.3104 (2.1860) ce_loss 1.0986 (1.0063) loss_zs_kd 1.5754 (1.7987) loss_oracle 0.6864 (0.7552) acc 56.2500 (62.5174) kd_loss 0.8685 (0.8021) lr 1.2369e-04 eta 0:03:34
epoch [44/50] batch [200/319] time 0.085 (0.102) data 0.000 (0.021) loss 1.7270 (2.1869) ce_loss 0.5220 (1.0033) loss_zs_kd 1.5908 (1.8047) loss_oracle 0.7891 (0.7557) acc 87.5000 (62.6562) kd_loss 0.8104 (0.8058) lr 1.2369e-04 eta 0:03:27
epoch [44/50] batch [220/319] time 0.085 (0.100) data 0.000 (0.019) loss 1.8981 (2.1848) ce_loss 0.8843 (1.0019) loss_zs_kd 1.7746 (1.8050) loss_oracle 0.7061 (0.7536) acc 62.5000 (62.6847) kd_loss 0.6608 (0.8061) lr 1.2369e-04 eta 0:03:21
epoch [44/50] batch [240/319] time 0.075 (0.098) data 0.000 (0.017) loss 2.4191 (2.1800) ce_loss 1.0498 (0.9966) loss_zs_kd 2.1177 (1.8067) loss_oracle 0.8187 (0.7536) acc 75.0000 (63.0729) kd_loss 0.9599 (0.8066) lr 1.2369e-04 eta 0:03:16
epoch [44/50] batch [260/319] time 0.075 (0.097) data 0.000 (0.016) loss 2.3169 (2.1837) ce_loss 1.0596 (0.9966) loss_zs_kd 1.7188 (1.8036) loss_oracle 0.6741 (0.7534) acc 68.7500 (63.1010) kd_loss 0.9203 (0.8104) lr 1.2369e-04 eta 0:03:11
epoch [44/50] batch [280/319] time 0.078 (0.096) data 0.000 (0.015) loss 2.3331 (2.1834) ce_loss 1.1348 (0.9969) loss_zs_kd 1.8162 (1.8019) loss_oracle 0.7694 (0.7538) acc 53.1250 (63.1585) kd_loss 0.8136 (0.8095) lr 1.2369e-04 eta 0:03:06
epoch [44/50] batch [300/319] time 0.086 (0.095) data 0.000 (0.014) loss 2.1806 (2.1865) ce_loss 0.9541 (0.9977) loss_zs_kd 1.9430 (1.7970) loss_oracle 0.6937 (0.7548) acc 56.2500 (63.1458) kd_loss 0.8797 (0.8113) lr 1.2369e-04 eta 0:03:03
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,996
* accuracy: 68.4%
* error: 31.6%
* macro_f1: 60.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,337
* accuracy: 54.8%
* error: 45.2%
* macro_f1: 24.7%
******* Domain 2 best val acc:      68.6%, epoch: 34 *******
******* Domain 2 best val test acc: 54.1%, epoch: 34 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [45/50] batch [20/319] time 0.080 (0.262) data 0.000 (0.172) loss 2.0020 (2.1222) ce_loss 0.8242 (0.9628) loss_zs_kd 1.4979 (1.7711) loss_oracle 0.7297 (0.7232) acc 75.0000 (65.3125) kd_loss 0.8129 (0.7978) lr 9.5173e-05 eta 0:08:16
epoch [45/50] batch [40/319] time 0.085 (0.171) data 0.000 (0.086) loss 2.3536 (2.1709) ce_loss 1.0879 (0.9877) loss_zs_kd 1.6755 (1.7654) loss_oracle 0.8214 (0.7415) acc 59.3750 (64.0625) kd_loss 0.8550 (0.8124) lr 9.5173e-05 eta 0:05:20
epoch [45/50] batch [60/319] time 0.084 (0.142) data 0.000 (0.058) loss 2.2230 (2.1797) ce_loss 1.0488 (0.9999) loss_zs_kd 1.9987 (1.7904) loss_oracle 0.7618 (0.7404) acc 65.6250 (63.9062) kd_loss 0.7932 (0.8095) lr 9.5173e-05 eta 0:04:22
epoch [45/50] batch [80/319] time 0.076 (0.127) data 0.000 (0.043) loss 2.3360 (2.1828) ce_loss 1.0547 (0.9938) loss_zs_kd 1.7869 (1.7798) loss_oracle 0.9182 (0.7523) acc 56.2500 (63.7500) kd_loss 0.8222 (0.8128) lr 9.5173e-05 eta 0:03:53
epoch [45/50] batch [100/319] time 0.088 (0.119) data 0.000 (0.035) loss 2.0260 (2.1750) ce_loss 0.8906 (0.9874) loss_zs_kd 1.7668 (1.7774) loss_oracle 0.7311 (0.7498) acc 65.6250 (63.7812) kd_loss 0.7698 (0.8127) lr 9.5173e-05 eta 0:03:35
epoch [45/50] batch [120/319] time 0.088 (0.112) data 0.000 (0.029) loss 2.3595 (2.1741) ce_loss 1.0371 (0.9883) loss_zs_kd 1.5141 (1.7689) loss_oracle 0.7498 (0.7505) acc 56.2500 (63.3854) kd_loss 0.9475 (0.8105) lr 9.5173e-05 eta 0:03:21
epoch [45/50] batch [140/319] time 0.079 (0.109) data 0.000 (0.025) loss 2.1538 (2.1621) ce_loss 0.9429 (0.9776) loss_zs_kd 1.5430 (1.7725) loss_oracle 0.9202 (0.7508) acc 68.7500 (63.8393) kd_loss 0.7508 (0.8091) lr 9.5173e-05 eta 0:03:12
epoch [45/50] batch [160/319] time 0.099 (0.106) data 0.001 (0.022) loss 1.9415 (2.1575) ce_loss 0.9067 (0.9727) loss_zs_kd 1.7287 (1.7642) loss_oracle 0.7263 (0.7531) acc 68.7500 (64.0234) kd_loss 0.6716 (0.8082) lr 9.5173e-05 eta 0:03:05
epoch [45/50] batch [180/319] time 0.082 (0.103) data 0.000 (0.019) loss 2.1223 (2.1532) ce_loss 0.9448 (0.9711) loss_zs_kd 2.0114 (1.7695) loss_oracle 0.7084 (0.7539) acc 59.3750 (64.1146) kd_loss 0.8232 (0.8051) lr 9.5173e-05 eta 0:02:59
epoch [45/50] batch [200/319] time 0.081 (0.101) data 0.000 (0.018) loss 2.2294 (2.1578) ce_loss 1.0342 (0.9769) loss_zs_kd 1.5989 (1.7636) loss_oracle 0.7886 (0.7536) acc 56.2500 (63.8594) kd_loss 0.8009 (0.8041) lr 9.5173e-05 eta 0:02:53
epoch [45/50] batch [220/319] time 0.076 (0.099) data 0.000 (0.016) loss 1.9368 (2.1632) ce_loss 0.7417 (0.9790) loss_zs_kd 1.6258 (1.7584) loss_oracle 0.6523 (0.7543) acc 68.7500 (63.6932) kd_loss 0.8690 (0.8070) lr 9.5173e-05 eta 0:02:47
epoch [45/50] batch [240/319] time 0.081 (0.098) data 0.000 (0.015) loss 2.4560 (2.1623) ce_loss 1.2432 (0.9772) loss_zs_kd 1.9260 (1.7605) loss_oracle 0.7535 (0.7545) acc 40.6250 (63.6328) kd_loss 0.8361 (0.8079) lr 9.5173e-05 eta 0:02:43
epoch [45/50] batch [260/319] time 0.095 (0.096) data 0.000 (0.014) loss 2.2944 (2.1738) ce_loss 1.1084 (0.9868) loss_zs_kd 2.0188 (1.7629) loss_oracle 0.6912 (0.7545) acc 59.3750 (63.3053) kd_loss 0.8404 (0.8097) lr 9.5173e-05 eta 0:02:39
epoch [45/50] batch [280/319] time 0.087 (0.096) data 0.000 (0.013) loss 2.0278 (2.1742) ce_loss 0.7881 (0.9896) loss_zs_kd 1.8642 (1.7662) loss_oracle 0.8196 (0.7530) acc 68.7500 (63.2143) kd_loss 0.8300 (0.8081) lr 9.5173e-05 eta 0:02:36
epoch [45/50] batch [300/319] time 0.081 (0.095) data 0.001 (0.012) loss 1.8399 (2.1708) ce_loss 0.7822 (0.9875) loss_zs_kd 1.5783 (1.7672) loss_oracle 0.7685 (0.7522) acc 78.1250 (63.4583) kd_loss 0.6734 (0.8072) lr 9.5173e-05 eta 0:02:33
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,997
* accuracy: 68.5%
* error: 31.5%
* macro_f1: 61.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,408
* accuracy: 55.5%
* error: 44.5%
* macro_f1: 24.7%
******* Domain 2 best val acc:      68.6%, epoch: 34 *******
******* Domain 2 best val test acc: 54.1%, epoch: 34 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [46/50] batch [20/319] time 0.082 (0.213) data 0.000 (0.127) loss 2.1043 (2.1042) ce_loss 1.0332 (0.9375) loss_zs_kd 1.8293 (1.7972) loss_oracle 0.6332 (0.7329) acc 53.1250 (65.1562) kd_loss 0.7545 (0.8003) lr 7.0224e-05 eta 0:05:35
epoch [46/50] batch [40/319] time 0.087 (0.150) data 0.000 (0.064) loss 2.2912 (2.1464) ce_loss 1.0771 (0.9661) loss_zs_kd 1.9617 (1.7872) loss_oracle 0.6969 (0.7451) acc 65.6250 (64.2969) kd_loss 0.8656 (0.8077) lr 7.0224e-05 eta 0:03:53
epoch [46/50] batch [60/319] time 0.080 (0.128) data 0.000 (0.043) loss 2.3681 (2.1507) ce_loss 1.0684 (0.9641) loss_zs_kd 1.8560 (1.7887) loss_oracle 0.8005 (0.7574) acc 62.5000 (64.4792) kd_loss 0.8995 (0.8078) lr 7.0224e-05 eta 0:03:16
epoch [46/50] batch [80/319] time 0.094 (0.116) data 0.000 (0.032) loss 2.1790 (2.1495) ce_loss 0.9194 (0.9673) loss_zs_kd 1.6125 (1.7877) loss_oracle 0.7738 (0.7593) acc 68.7500 (64.9609) kd_loss 0.8727 (0.8025) lr 7.0224e-05 eta 0:02:56
epoch [46/50] batch [100/319] time 0.089 (0.110) data 0.000 (0.026) loss 1.9016 (2.1490) ce_loss 0.7100 (0.9648) loss_zs_kd 1.5478 (1.7888) loss_oracle 0.7253 (0.7583) acc 75.0000 (64.4688) kd_loss 0.8290 (0.8050) lr 7.0224e-05 eta 0:02:45
epoch [46/50] batch [120/319] time 0.084 (0.105) data 0.000 (0.021) loss 2.0130 (2.1443) ce_loss 0.9619 (0.9631) loss_zs_kd 1.8161 (1.7805) loss_oracle 0.6402 (0.7569) acc 68.7500 (64.4792) kd_loss 0.7310 (0.8028) lr 7.0224e-05 eta 0:02:35
epoch [46/50] batch [140/319] time 0.082 (0.102) data 0.000 (0.018) loss 2.1261 (2.1609) ce_loss 0.8105 (0.9753) loss_zs_kd 1.3666 (1.7733) loss_oracle 0.9017 (0.7585) acc 71.8750 (63.9062) kd_loss 0.8647 (0.8064) lr 7.0224e-05 eta 0:02:28
epoch [46/50] batch [160/319] time 0.087 (0.100) data 0.000 (0.016) loss 1.9954 (2.1545) ce_loss 0.7808 (0.9711) loss_zs_kd 1.5581 (1.7821) loss_oracle 0.7137 (0.7567) acc 65.6250 (64.1797) kd_loss 0.8578 (0.8051) lr 7.0224e-05 eta 0:02:23
epoch [46/50] batch [180/319] time 0.080 (0.098) data 0.000 (0.014) loss 2.3039 (2.1570) ce_loss 0.9521 (0.9740) loss_zs_kd 1.6116 (1.7832) loss_oracle 0.8923 (0.7567) acc 62.5000 (63.9931) kd_loss 0.9056 (0.8046) lr 7.0224e-05 eta 0:02:18
epoch [46/50] batch [200/319] time 0.094 (0.097) data 0.000 (0.013) loss 2.1677 (2.1589) ce_loss 1.0430 (0.9736) loss_zs_kd 1.6233 (1.7839) loss_oracle 0.7630 (0.7578) acc 46.8750 (63.9844) kd_loss 0.7433 (0.8065) lr 7.0224e-05 eta 0:02:14
epoch [46/50] batch [220/319] time 0.082 (0.096) data 0.000 (0.012) loss 2.1999 (2.1644) ce_loss 1.2578 (0.9818) loss_zs_kd 1.8868 (1.7788) loss_oracle 0.6776 (0.7570) acc 46.8750 (63.6364) kd_loss 0.6033 (0.8041) lr 7.0224e-05 eta 0:02:11
epoch [46/50] batch [240/319] time 0.074 (0.094) data 0.000 (0.011) loss 1.9587 (2.1654) ce_loss 0.8589 (0.9834) loss_zs_kd 1.6595 (1.7781) loss_oracle 0.5914 (0.7549) acc 68.7500 (63.4505) kd_loss 0.8041 (0.8046) lr 7.0224e-05 eta 0:02:07
epoch [46/50] batch [260/319] time 0.076 (0.093) data 0.000 (0.010) loss 1.9823 (2.1638) ce_loss 0.8477 (0.9837) loss_zs_kd 1.7267 (1.7774) loss_oracle 0.7194 (0.7533) acc 71.8750 (63.5216) kd_loss 0.7749 (0.8035) lr 7.0224e-05 eta 0:02:04
epoch [46/50] batch [280/319] time 0.082 (0.092) data 0.001 (0.009) loss 2.4041 (2.1687) ce_loss 1.1719 (0.9875) loss_zs_kd 1.6893 (1.7762) loss_oracle 0.7746 (0.7536) acc 53.1250 (63.2701) kd_loss 0.8449 (0.8044) lr 7.0224e-05 eta 0:02:01
epoch [46/50] batch [300/319] time 0.078 (0.092) data 0.000 (0.009) loss 2.3038 (2.1675) ce_loss 1.0518 (0.9856) loss_zs_kd 1.8273 (1.7741) loss_oracle 0.7658 (0.7540) acc 65.6250 (63.3125) kd_loss 0.8692 (0.8049) lr 7.0224e-05 eta 0:01:58
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,009
* accuracy: 68.7%
* error: 31.3%
* macro_f1: 61.3%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,375
* accuracy: 55.2%
* error: 44.8%
* macro_f1: 24.7%
******* Domain 2 best val acc:      68.7%, epoch: 46 *******
******* Domain 2 best val test acc: 55.2%, epoch: 46 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [47/50] batch [20/319] time 0.088 (0.270) data 0.000 (0.185) loss 1.9154 (2.2095) ce_loss 0.8018 (1.0061) loss_zs_kd 1.5862 (1.7569) loss_oracle 0.6732 (0.7648) acc 81.2500 (64.0625) kd_loss 0.7771 (0.8210) lr 4.8943e-05 eta 0:05:39
epoch [47/50] batch [40/319] time 0.078 (0.175) data 0.000 (0.093) loss 2.0384 (2.1954) ce_loss 0.9951 (1.0136) loss_zs_kd 2.1323 (1.7627) loss_oracle 0.7847 (0.7535) acc 59.3750 (62.8906) kd_loss 0.6509 (0.8051) lr 4.8943e-05 eta 0:03:36
epoch [47/50] batch [60/319] time 0.082 (0.143) data 0.000 (0.062) loss 2.2311 (2.2011) ce_loss 0.9556 (1.0059) loss_zs_kd 1.9121 (1.7904) loss_oracle 0.8267 (0.7518) acc 71.8750 (62.9688) kd_loss 0.8621 (0.8193) lr 4.8943e-05 eta 0:02:53
epoch [47/50] batch [80/319] time 0.079 (0.128) data 0.000 (0.046) loss 2.1390 (2.2021) ce_loss 1.0312 (1.0075) loss_zs_kd 1.7110 (1.7754) loss_oracle 0.7869 (0.7523) acc 53.1250 (62.5391) kd_loss 0.7142 (0.8185) lr 4.8943e-05 eta 0:02:32
epoch [47/50] batch [100/319] time 0.084 (0.119) data 0.000 (0.037) loss 2.0030 (2.1941) ce_loss 0.8140 (1.0053) loss_zs_kd 1.6118 (1.7748) loss_oracle 0.7139 (0.7527) acc 62.5000 (62.6250) kd_loss 0.8321 (0.8124) lr 4.8943e-05 eta 0:02:19
epoch [47/50] batch [120/319] time 0.077 (0.112) data 0.000 (0.031) loss 1.9673 (2.1847) ce_loss 0.8804 (0.9937) loss_zs_kd 1.7041 (1.7848) loss_oracle 0.6673 (0.7541) acc 56.2500 (62.7604) kd_loss 0.7533 (0.8140) lr 4.8943e-05 eta 0:02:09
epoch [47/50] batch [140/319] time 0.079 (0.108) data 0.000 (0.027) loss 2.3899 (2.1768) ce_loss 1.2891 (0.9891) loss_zs_kd 1.9468 (1.7855) loss_oracle 0.6689 (0.7521) acc 43.7500 (62.8125) kd_loss 0.7664 (0.8116) lr 4.8943e-05 eta 0:02:02
epoch [47/50] batch [160/319] time 0.087 (0.104) data 0.000 (0.023) loss 1.9293 (2.1744) ce_loss 0.8438 (0.9855) loss_zs_kd 1.4849 (1.7878) loss_oracle 0.7347 (0.7546) acc 68.7500 (63.0859) kd_loss 0.7182 (0.8116) lr 4.8943e-05 eta 0:01:56
epoch [47/50] batch [180/319] time 0.079 (0.102) data 0.000 (0.021) loss 1.9629 (2.1788) ce_loss 0.8823 (0.9882) loss_zs_kd 1.9799 (1.7898) loss_oracle 0.6365 (0.7526) acc 53.1250 (63.1250) kd_loss 0.7624 (0.8143) lr 4.8943e-05 eta 0:01:52
epoch [47/50] batch [200/319] time 0.080 (0.101) data 0.000 (0.019) loss 2.2952 (2.1700) ce_loss 1.1338 (0.9822) loss_zs_kd 1.8453 (1.7828) loss_oracle 0.7499 (0.7513) acc 56.2500 (63.2500) kd_loss 0.7865 (0.8121) lr 4.8943e-05 eta 0:01:48
epoch [47/50] batch [220/319] time 0.081 (0.099) data 0.000 (0.017) loss 2.1508 (2.1676) ce_loss 0.8662 (0.9811) loss_zs_kd 1.6213 (1.7831) loss_oracle 0.7444 (0.7523) acc 62.5000 (63.3807) kd_loss 0.9124 (0.8104) lr 4.8943e-05 eta 0:01:44
epoch [47/50] batch [240/319] time 0.084 (0.098) data 0.000 (0.016) loss 1.9130 (2.1731) ce_loss 0.7139 (0.9856) loss_zs_kd 1.9047 (1.7801) loss_oracle 0.7450 (0.7553) acc 81.2500 (63.3333) kd_loss 0.8267 (0.8098) lr 4.8943e-05 eta 0:01:41
epoch [47/50] batch [260/319] time 0.083 (0.097) data 0.000 (0.014) loss 2.1597 (2.1739) ce_loss 1.1777 (0.9884) loss_zs_kd 1.5894 (1.7803) loss_oracle 0.6362 (0.7540) acc 53.1250 (63.3534) kd_loss 0.6639 (0.8084) lr 4.8943e-05 eta 0:01:38
epoch [47/50] batch [280/319] time 0.094 (0.096) data 0.000 (0.013) loss 2.1522 (2.1746) ce_loss 0.9771 (0.9882) loss_zs_kd 1.6990 (1.7807) loss_oracle 0.8540 (0.7531) acc 62.5000 (63.1808) kd_loss 0.7481 (0.8099) lr 4.8943e-05 eta 0:01:35
epoch [47/50] batch [300/319] time 0.083 (0.095) data 0.000 (0.013) loss 1.8801 (2.1695) ce_loss 0.7612 (0.9864) loss_zs_kd 1.7230 (1.7798) loss_oracle 0.8881 (0.7521) acc 71.8750 (63.2396) kd_loss 0.6748 (0.8071) lr 4.8943e-05 eta 0:01:32
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,013
* accuracy: 68.8%
* error: 31.2%
* macro_f1: 61.4%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,393
* accuracy: 55.4%
* error: 44.6%
* macro_f1: 24.7%
******* Domain 2 best val acc:      68.8%, epoch: 47 *******
******* Domain 2 best val test acc: 55.4%, epoch: 47 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [48/50] batch [20/319] time 0.091 (0.217) data 0.000 (0.132) loss 2.1224 (2.2562) ce_loss 1.0039 (1.0674) loss_zs_kd 1.5742 (1.7514) loss_oracle 0.6280 (0.7534) acc 53.1250 (57.8125) kd_loss 0.8045 (0.8122) lr 3.1417e-05 eta 0:03:23
epoch [48/50] batch [40/319] time 0.090 (0.150) data 0.000 (0.066) loss 2.1549 (2.2439) ce_loss 0.8750 (1.0488) loss_zs_kd 1.7665 (1.7674) loss_oracle 0.6790 (0.7601) acc 75.0000 (60.0000) kd_loss 0.9404 (0.8150) lr 3.1417e-05 eta 0:02:17
epoch [48/50] batch [60/319] time 0.086 (0.128) data 0.000 (0.044) loss 2.1948 (2.2263) ce_loss 0.9800 (1.0330) loss_zs_kd 1.4233 (1.7651) loss_oracle 0.7406 (0.7605) acc 68.7500 (61.7708) kd_loss 0.8445 (0.8131) lr 3.1417e-05 eta 0:01:55
epoch [48/50] batch [80/319] time 0.083 (0.117) data 0.000 (0.033) loss 1.9848 (2.1951) ce_loss 0.9258 (1.0105) loss_zs_kd 1.7434 (1.7729) loss_oracle 0.7403 (0.7601) acc 78.1250 (63.0859) kd_loss 0.6889 (0.8045) lr 3.1417e-05 eta 0:01:42
epoch [48/50] batch [100/319] time 0.076 (0.110) data 0.000 (0.027) loss 2.3217 (2.1894) ce_loss 0.8042 (0.9953) loss_zs_kd 1.7914 (1.7753) loss_oracle 0.8443 (0.7581) acc 62.5000 (63.0000) kd_loss 1.0954 (0.8151) lr 3.1417e-05 eta 0:01:34
epoch [48/50] batch [120/319] time 0.084 (0.106) data 0.000 (0.022) loss 2.0619 (2.1781) ce_loss 0.9458 (0.9860) loss_zs_kd 1.5747 (1.7749) loss_oracle 0.7699 (0.7572) acc 68.7500 (63.4115) kd_loss 0.7312 (0.8135) lr 3.1417e-05 eta 0:01:29
epoch [48/50] batch [140/319] time 0.084 (0.104) data 0.000 (0.019) loss 2.3601 (2.1731) ce_loss 1.2354 (0.9853) loss_zs_kd 1.7902 (1.7777) loss_oracle 0.8405 (0.7560) acc 62.5000 (63.8616) kd_loss 0.7046 (0.8098) lr 3.1417e-05 eta 0:01:24
epoch [48/50] batch [160/319] time 0.086 (0.101) data 0.000 (0.017) loss 2.1179 (2.1627) ce_loss 0.8096 (0.9795) loss_zs_kd 1.9597 (1.7774) loss_oracle 0.9132 (0.7554) acc 65.6250 (64.1992) kd_loss 0.8517 (0.8055) lr 3.1417e-05 eta 0:01:20
epoch [48/50] batch [180/319] time 0.083 (0.100) data 0.000 (0.015) loss 2.1882 (2.1739) ce_loss 0.9312 (0.9852) loss_zs_kd 1.9896 (1.7756) loss_oracle 0.7110 (0.7591) acc 68.7500 (64.0104) kd_loss 0.9016 (0.8091) lr 3.1417e-05 eta 0:01:17
epoch [48/50] batch [200/319] time 0.087 (0.098) data 0.000 (0.014) loss 2.7005 (2.1763) ce_loss 1.4414 (0.9891) loss_zs_kd 1.5709 (1.7820) loss_oracle 0.7371 (0.7580) acc 43.7500 (63.8125) kd_loss 0.8905 (0.8083) lr 3.1417e-05 eta 0:01:14
epoch [48/50] batch [220/319] time 0.085 (0.097) data 0.000 (0.012) loss 1.8450 (2.1783) ce_loss 0.8086 (0.9898) loss_zs_kd 1.6229 (1.7800) loss_oracle 0.7004 (0.7608) acc 71.8750 (63.7074) kd_loss 0.6863 (0.8081) lr 3.1417e-05 eta 0:01:11
epoch [48/50] batch [240/319] time 0.096 (0.096) data 0.000 (0.011) loss 2.4651 (2.1803) ce_loss 1.1074 (0.9907) loss_zs_kd 1.6735 (1.7807) loss_oracle 0.7262 (0.7613) acc 68.7500 (63.6589) kd_loss 0.9945 (0.8090) lr 3.1417e-05 eta 0:01:09
epoch [48/50] batch [260/319] time 0.080 (0.095) data 0.000 (0.010) loss 2.4266 (2.1792) ce_loss 1.1416 (0.9882) loss_zs_kd 1.8932 (1.7843) loss_oracle 0.8186 (0.7603) acc 59.3750 (63.7019) kd_loss 0.8757 (0.8108) lr 3.1417e-05 eta 0:01:06
epoch [48/50] batch [280/319] time 0.096 (0.094) data 0.000 (0.010) loss 2.6395 (2.1771) ce_loss 1.4951 (0.9869) loss_zs_kd 1.6650 (1.7814) loss_oracle 0.7501 (0.7578) acc 46.8750 (63.7835) kd_loss 0.7693 (0.8113) lr 3.1417e-05 eta 0:01:03
epoch [48/50] batch [300/319] time 0.084 (0.094) data 0.000 (0.009) loss 1.9125 (2.1756) ce_loss 0.8999 (0.9868) loss_zs_kd 1.6170 (1.7797) loss_oracle 0.7087 (0.7569) acc 68.7500 (63.8646) kd_loss 0.6583 (0.8103) lr 3.1417e-05 eta 0:01:01
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,007
* accuracy: 68.7%
* error: 31.3%
* macro_f1: 61.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,404
* accuracy: 55.5%
* error: 44.5%
* macro_f1: 24.7%
******* Domain 2 best val acc:      68.8%, epoch: 47 *******
******* Domain 2 best val test acc: 55.4%, epoch: 47 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [49/50] batch [20/319] time 0.088 (0.292) data 0.000 (0.206) loss 2.3633 (2.1794) ce_loss 0.9595 (0.9608) loss_zs_kd 1.7087 (1.8152) loss_oracle 0.9850 (0.7667) acc 65.6250 (63.5938) kd_loss 0.9113 (0.8352) lr 1.7713e-05 eta 0:03:00
epoch [49/50] batch [40/319] time 0.076 (0.189) data 0.000 (0.103) loss 2.2286 (2.1737) ce_loss 1.0439 (0.9798) loss_zs_kd 1.8411 (1.8053) loss_oracle 0.7234 (0.7598) acc 50.0000 (63.0469) kd_loss 0.8230 (0.8140) lr 1.7713e-05 eta 0:01:52
epoch [49/50] batch [60/319] time 0.085 (0.153) data 0.000 (0.069) loss 1.9254 (2.1763) ce_loss 0.6704 (0.9863) loss_zs_kd 1.5636 (1.7913) loss_oracle 0.8258 (0.7535) acc 75.0000 (63.6458) kd_loss 0.8421 (0.8132) lr 1.7713e-05 eta 0:01:28
epoch [49/50] batch [80/319] time 0.083 (0.136) data 0.000 (0.052) loss 2.2707 (2.1772) ce_loss 1.0938 (0.9896) loss_zs_kd 1.7471 (1.7686) loss_oracle 0.6417 (0.7469) acc 53.1250 (63.8672) kd_loss 0.8561 (0.8141) lr 1.7713e-05 eta 0:01:15
epoch [49/50] batch [100/319] time 0.079 (0.125) data 0.000 (0.041) loss 1.8655 (2.1634) ce_loss 0.8677 (0.9755) loss_zs_kd 1.9357 (1.7635) loss_oracle 0.6659 (0.7458) acc 71.8750 (64.0938) kd_loss 0.6649 (0.8150) lr 1.7713e-05 eta 0:01:07
epoch [49/50] batch [120/319] time 0.081 (0.118) data 0.000 (0.035) loss 1.8767 (2.1802) ce_loss 0.8979 (0.9864) loss_zs_kd 1.9190 (1.7642) loss_oracle 0.6677 (0.7509) acc 56.2500 (63.2552) kd_loss 0.6449 (0.8184) lr 1.7713e-05 eta 0:01:00
epoch [49/50] batch [140/319] time 0.090 (0.113) data 0.000 (0.030) loss 2.0405 (2.1787) ce_loss 0.8472 (0.9852) loss_zs_kd 1.6550 (1.7647) loss_oracle 0.8582 (0.7517) acc 75.0000 (63.5714) kd_loss 0.7643 (0.8177) lr 1.7713e-05 eta 0:00:56
epoch [49/50] batch [160/319] time 0.079 (0.110) data 0.000 (0.026) loss 1.9348 (2.1765) ce_loss 0.7861 (0.9845) loss_zs_kd 1.7321 (1.7676) loss_oracle 0.7343 (0.7526) acc 71.8750 (63.3594) kd_loss 0.7815 (0.8157) lr 1.7713e-05 eta 0:00:52
epoch [49/50] batch [180/319] time 0.092 (0.108) data 0.000 (0.023) loss 2.2891 (2.1840) ce_loss 1.0186 (0.9927) loss_zs_kd 1.7950 (1.7692) loss_oracle 0.7044 (0.7528) acc 59.3750 (62.8993) kd_loss 0.9184 (0.8149) lr 1.7713e-05 eta 0:00:49
epoch [49/50] batch [200/319] time 0.080 (0.105) data 0.000 (0.021) loss 2.0489 (2.1815) ce_loss 0.9165 (0.9925) loss_zs_kd 2.0252 (1.7773) loss_oracle 0.7259 (0.7511) acc 62.5000 (62.9531) kd_loss 0.7695 (0.8135) lr 1.7713e-05 eta 0:00:46
epoch [49/50] batch [220/319] time 0.081 (0.103) data 0.000 (0.019) loss 2.3356 (2.1803) ce_loss 1.1426 (0.9927) loss_zs_kd 1.7098 (1.7769) loss_oracle 0.6558 (0.7503) acc 62.5000 (62.9119) kd_loss 0.8651 (0.8125) lr 1.7713e-05 eta 0:00:42
epoch [49/50] batch [240/319] time 0.074 (0.101) data 0.000 (0.017) loss 1.9586 (2.1842) ce_loss 0.8555 (0.9947) loss_zs_kd 1.9461 (1.7819) loss_oracle 0.6904 (0.7523) acc 65.6250 (63.0078) kd_loss 0.7580 (0.8133) lr 1.7713e-05 eta 0:00:40
epoch [49/50] batch [260/319] time 0.074 (0.099) data 0.000 (0.016) loss 2.2927 (2.1822) ce_loss 1.0039 (0.9936) loss_zs_kd 1.6533 (1.7802) loss_oracle 0.7816 (0.7531) acc 59.3750 (62.9567) kd_loss 0.8980 (0.8121) lr 1.7713e-05 eta 0:00:37
epoch [49/50] batch [280/319] time 0.095 (0.098) data 0.000 (0.015) loss 1.7529 (2.1807) ce_loss 0.7559 (0.9935) loss_zs_kd 1.7598 (1.7802) loss_oracle 0.7002 (0.7535) acc 65.6250 (62.9018) kd_loss 0.6469 (0.8104) lr 1.7713e-05 eta 0:00:35
epoch [49/50] batch [300/319] time 0.080 (0.097) data 0.000 (0.014) loss 2.0095 (2.1709) ce_loss 0.8867 (0.9860) loss_zs_kd 1.9852 (1.7807) loss_oracle 0.8142 (0.7535) acc 68.7500 (63.2500) kd_loss 0.7156 (0.8082) lr 1.7713e-05 eta 0:00:32
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,006
* accuracy: 68.7%
* error: 31.3%
* macro_f1: 61.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,401
* accuracy: 55.5%
* error: 44.5%
* macro_f1: 24.7%
******* Domain 2 best val acc:      68.8%, epoch: 47 *******
******* Domain 2 best val test acc: 55.4%, epoch: 47 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
epoch [50/50] batch [20/319] time 0.079 (0.261) data 0.000 (0.183) loss 2.0428 (2.2258) ce_loss 0.8677 (1.0453) loss_zs_kd 1.9034 (1.7934) loss_oracle 0.6821 (0.7633) acc 68.7500 (61.7188) kd_loss 0.8340 (0.7988) lr 7.8853e-06 eta 0:01:17
epoch [50/50] batch [40/319] time 0.087 (0.171) data 0.000 (0.092) loss 1.9433 (2.2129) ce_loss 0.9014 (1.0170) loss_zs_kd 2.1340 (1.7781) loss_oracle 0.6995 (0.7708) acc 65.6250 (62.4219) kd_loss 0.6921 (0.8105) lr 7.8853e-06 eta 0:00:47
epoch [50/50] batch [60/319] time 0.078 (0.141) data 0.000 (0.061) loss 1.9367 (2.1963) ce_loss 0.9204 (1.0029) loss_zs_kd 1.8913 (1.7871) loss_oracle 0.6342 (0.7616) acc 62.5000 (62.9688) kd_loss 0.6992 (0.8126) lr 7.8853e-06 eta 0:00:36
epoch [50/50] batch [80/319] time 0.083 (0.127) data 0.000 (0.046) loss 2.2505 (2.1752) ce_loss 0.9995 (0.9914) loss_zs_kd 1.6578 (1.7783) loss_oracle 0.7144 (0.7489) acc 62.5000 (63.2422) kd_loss 0.8938 (0.8093) lr 7.8853e-06 eta 0:00:30
epoch [50/50] batch [100/319] time 0.083 (0.119) data 0.000 (0.037) loss 2.5777 (2.1833) ce_loss 1.2549 (1.0048) loss_zs_kd 1.7587 (1.7810) loss_oracle 0.6066 (0.7437) acc 59.3750 (62.9688) kd_loss 1.0195 (0.8067) lr 7.8853e-06 eta 0:00:26
epoch [50/50] batch [120/319] time 0.088 (0.114) data 0.000 (0.031) loss 2.2148 (2.1814) ce_loss 1.0762 (1.0010) loss_zs_kd 1.4418 (1.7719) loss_oracle 0.6415 (0.7412) acc 62.5000 (63.2031) kd_loss 0.8179 (0.8099) lr 7.8853e-06 eta 0:00:22
epoch [50/50] batch [140/319] time 0.089 (0.109) data 0.000 (0.026) loss 1.8884 (2.1843) ce_loss 0.7012 (0.9973) loss_zs_kd 1.6902 (1.7710) loss_oracle 0.7203 (0.7490) acc 81.2500 (63.3036) kd_loss 0.8271 (0.8125) lr 7.8853e-06 eta 0:00:19
epoch [50/50] batch [160/319] time 0.079 (0.106) data 0.000 (0.023) loss 2.2889 (2.1920) ce_loss 0.9775 (1.0029) loss_zs_kd 1.5821 (1.7746) loss_oracle 0.7672 (0.7522) acc 62.5000 (62.6172) kd_loss 0.9278 (0.8130) lr 7.8853e-06 eta 0:00:16
epoch [50/50] batch [180/319] time 0.080 (0.104) data 0.000 (0.021) loss 2.1526 (2.1895) ce_loss 0.8174 (1.0039) loss_zs_kd 1.9345 (1.7748) loss_oracle 0.7341 (0.7509) acc 71.8750 (62.5000) kd_loss 0.9682 (0.8101) lr 7.8853e-06 eta 0:00:14
epoch [50/50] batch [200/319] time 0.083 (0.102) data 0.001 (0.019) loss 2.2220 (2.1945) ce_loss 1.0479 (1.0081) loss_zs_kd 1.7658 (1.7740) loss_oracle 0.7153 (0.7515) acc 65.6250 (62.7969) kd_loss 0.8165 (0.8107) lr 7.8853e-06 eta 0:00:12
epoch [50/50] batch [220/319] time 0.089 (0.100) data 0.000 (0.017) loss 2.1842 (2.1839) ce_loss 0.8540 (1.0021) loss_zs_kd 1.8517 (1.7772) loss_oracle 0.8884 (0.7491) acc 65.6250 (63.0966) kd_loss 0.8861 (0.8072) lr 7.8853e-06 eta 0:00:09
epoch [50/50] batch [240/319] time 0.087 (0.099) data 0.000 (0.016) loss 2.3625 (2.1788) ce_loss 1.2012 (0.9967) loss_zs_kd 1.5485 (1.7734) loss_oracle 0.8139 (0.7492) acc 56.2500 (63.2031) kd_loss 0.7544 (0.8075) lr 7.8853e-06 eta 0:00:07
epoch [50/50] batch [260/319] time 0.083 (0.097) data 0.000 (0.014) loss 2.1269 (2.1802) ce_loss 0.8638 (0.9971) loss_zs_kd 1.6960 (1.7728) loss_oracle 0.7736 (0.7501) acc 65.6250 (63.2332) kd_loss 0.8764 (0.8080) lr 7.8853e-06 eta 0:00:05
epoch [50/50] batch [280/319] time 0.083 (0.097) data 0.001 (0.013) loss 2.7411 (2.1797) ce_loss 1.4219 (0.9946) loss_zs_kd 1.7715 (1.7691) loss_oracle 0.7564 (0.7491) acc 50.0000 (63.3594) kd_loss 0.9410 (0.8105) lr 7.8853e-06 eta 0:00:03
epoch [50/50] batch [300/319] time 0.080 (0.096) data 0.000 (0.013) loss 2.3752 (2.1752) ce_loss 1.1182 (0.9912) loss_zs_kd 1.9059 (1.7691) loss_oracle 0.8268 (0.7497) acc 53.1250 (63.4583) kd_loss 0.8436 (0.8092) lr 7.8853e-06 eta 0:00:01
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,003
* accuracy: 68.6%
* error: 31.4%
* macro_f1: 61.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,400
* accuracy: 55.5%
* error: 44.5%
* macro_f1: 24.7%
******* Domain 2 best val acc:      68.8%, epoch: 47 *******
******* Domain 2 best val test acc: 55.4%, epoch: 47 *******
******* Domain 2 best test acc:     57.9%, epoch: 10 *******
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.1tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:47:41
