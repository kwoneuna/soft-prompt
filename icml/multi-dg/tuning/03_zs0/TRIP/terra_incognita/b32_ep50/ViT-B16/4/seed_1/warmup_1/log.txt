Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_100', 'location_38', 'location_43']
Target     ['location_46']
# classes  10
# train_x  12,912
# val      5,535
# test     5,883
---------  ----------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/403] time 0.075 (0.138) data 0.000 (0.033) loss 2.2085 (2.1847) ce_loss 2.2070 (2.1817) loss_zs_kd 0.0003 (0.0001) loss_oracle -0.0000 (-0.0001) acc 34.3750 (32.1875) kd_loss 0.0014 (0.0031) lr 1.0000e-05 eta 0:46:26
epoch [1/50] batch [40/403] time 0.080 (0.109) data 0.000 (0.016) loss 2.4304 (2.2317) ce_loss 2.4297 (2.2298) loss_zs_kd 0.0026 (0.0007) loss_oracle -0.0002 (-0.0001) acc 31.2500 (31.8750) kd_loss 0.0008 (0.0019) lr 1.0000e-05 eta 0:36:23
epoch [1/50] batch [60/403] time 0.075 (0.099) data 0.000 (0.011) loss 2.3229 (2.2084) ce_loss 2.3223 (2.2069) loss_zs_kd 0.0083 (0.0020) loss_oracle -0.0001 (-0.0001) acc 18.7500 (32.7083) kd_loss 0.0007 (0.0016) lr 1.0000e-05 eta 0:32:59
epoch [1/50] batch [80/403] time 0.083 (0.095) data 0.000 (0.008) loss 2.4711 (2.1775) ce_loss 2.4707 (2.1761) loss_zs_kd 0.0176 (0.0043) loss_oracle -0.0000 (-0.0001) acc 31.2500 (33.1641) kd_loss 0.0004 (0.0014) lr 1.0000e-05 eta 0:31:41
epoch [1/50] batch [100/403] time 0.086 (0.093) data 0.000 (0.007) loss 2.4969 (2.1711) ce_loss 2.4961 (2.1700) loss_zs_kd 0.0310 (0.0080) loss_oracle 0.0001 (-0.0001) acc 25.0000 (33.1875) kd_loss 0.0007 (0.0012) lr 1.0000e-05 eta 0:31:01
epoch [1/50] batch [120/403] time 0.089 (0.092) data 0.000 (0.006) loss 2.3316 (2.1530) ce_loss 2.3301 (2.1519) loss_zs_kd 0.0568 (0.0139) loss_oracle 0.0002 (-0.0001) acc 28.1250 (33.5156) kd_loss 0.0014 (0.0012) lr 1.0000e-05 eta 0:30:36
epoch [1/50] batch [140/403] time 0.081 (0.090) data 0.000 (0.005) loss 1.5722 (2.1113) ce_loss 1.5684 (2.1100) loss_zs_kd 0.1076 (0.0253) loss_oracle 0.0035 (0.0001) acc 56.2500 (34.3973) kd_loss 0.0021 (0.0012) lr 1.0000e-05 eta 0:30:08
epoch [1/50] batch [160/403] time 0.086 (0.090) data 0.000 (0.004) loss 2.1518 (2.0704) ce_loss 2.1016 (2.0670) loss_zs_kd 0.4165 (0.0537) loss_oracle 0.0646 (0.0029) acc 34.3750 (35.4492) kd_loss 0.0180 (0.0020) lr 1.0000e-05 eta 0:29:51
epoch [1/50] batch [180/403] time 0.085 (0.089) data 0.000 (0.004) loss 1.6851 (2.0376) ce_loss 1.5967 (2.0292) loss_zs_kd 0.6343 (0.0940) loss_oracle 0.0474 (0.0048) acc 43.7500 (36.3194) kd_loss 0.0647 (0.0060) lr 1.0000e-05 eta 0:29:41
epoch [1/50] batch [200/403] time 0.090 (0.089) data 0.000 (0.004) loss 1.8917 (2.0167) ce_loss 1.7217 (1.9962) loss_zs_kd 0.4368 (0.1291) loss_oracle 0.0149 (0.0075) acc 40.6250 (36.8594) kd_loss 0.1626 (0.0168) lr 1.0000e-05 eta 0:29:30
epoch [1/50] batch [220/403] time 0.084 (0.088) data 0.000 (0.003) loss 1.8465 (1.9990) ce_loss 1.5674 (1.9601) loss_zs_kd 0.5266 (0.1604) loss_oracle 0.0186 (0.0080) acc 43.7500 (37.5142) kd_loss 0.2698 (0.0349) lr 1.0000e-05 eta 0:29:16
epoch [1/50] batch [240/403] time 0.091 (0.088) data 0.000 (0.003) loss 1.8611 (1.9954) ce_loss 1.5039 (1.9339) loss_zs_kd 0.6854 (0.1910) loss_oracle 0.0210 (0.0097) acc 40.6250 (37.9818) kd_loss 0.3467 (0.0567) lr 1.0000e-05 eta 0:29:12
epoch [1/50] batch [260/403] time 0.127 (0.089) data 0.000 (0.003) loss 2.5797 (2.0008) ce_loss 2.0371 (1.9109) loss_zs_kd 0.6785 (0.2160) loss_oracle 0.1175 (0.0123) acc 25.0000 (38.2212) kd_loss 0.4838 (0.0837) lr 1.0000e-05 eta 0:29:26
epoch [1/50] batch [280/403] time 0.086 (0.089) data 0.000 (0.003) loss 2.2242 (2.0197) ce_loss 1.6514 (1.8947) loss_zs_kd 0.6971 (0.2398) loss_oracle 0.1355 (0.0184) acc 50.0000 (38.6384) kd_loss 0.5050 (0.1158) lr 1.0000e-05 eta 0:29:20
epoch [1/50] batch [300/403] time 0.093 (0.088) data 0.000 (0.002) loss 2.7955 (2.0451) ce_loss 1.9648 (1.8771) loss_zs_kd 0.6337 (0.2625) loss_oracle 0.2758 (0.0282) acc 37.5000 (39.1042) kd_loss 0.6928 (0.1539) lr 1.0000e-05 eta 0:29:10
epoch [1/50] batch [320/403] time 0.085 (0.088) data 0.000 (0.002) loss 2.7890 (2.0855) ce_loss 1.7754 (1.8715) loss_zs_kd 0.6436 (0.2797) loss_oracle 0.3845 (0.0397) acc 37.5000 (39.1992) kd_loss 0.8213 (0.1942) lr 1.0000e-05 eta 0:29:02
epoch [1/50] batch [340/403] time 0.079 (0.088) data 0.000 (0.002) loss 2.4144 (2.1176) ce_loss 1.3682 (1.8568) loss_zs_kd 0.5737 (0.2937) loss_oracle 0.1470 (0.0529) acc 50.0000 (39.4669) kd_loss 0.9727 (0.2343) lr 1.0000e-05 eta 0:28:54
epoch [1/50] batch [360/403] time 0.084 (0.087) data 0.000 (0.002) loss 2.4915 (2.1474) ce_loss 1.4385 (1.8496) loss_zs_kd 0.5565 (0.3082) loss_oracle 0.1502 (0.0562) acc 46.8750 (39.6267) kd_loss 0.9779 (0.2697) lr 1.0000e-05 eta 0:28:50
epoch [1/50] batch [380/403] time 0.078 (0.087) data 0.000 (0.002) loss 2.5150 (2.1744) ce_loss 1.5098 (1.8405) loss_zs_kd 0.5649 (0.3218) loss_oracle 0.1773 (0.0618) acc 40.6250 (39.7368) kd_loss 0.9166 (0.3029) lr 1.0000e-05 eta 0:28:44
epoch [1/50] batch [400/403] time 0.080 (0.087) data 0.000 (0.002) loss 3.1861 (2.2000) ce_loss 2.0332 (1.8318) loss_zs_kd 0.6984 (0.3342) loss_oracle 0.3271 (0.0676) acc 28.1250 (39.8672) kd_loss 0.9893 (0.3344) lr 1.0000e-05 eta 0:28:33
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 2,713
* accuracy: 49.0%
* error: 51.0%
* macro_f1: 35.5%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 1,964
* accuracy: 33.4%
* error: 66.6%
* macro_f1: 24.0%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      49.0%, epoch: 1 *******
******* Domain 4 best val test acc: 33.4%, epoch: 1 *******
******* Domain 4 best test acc:     33.4%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/ana
epoch [2/50] batch [20/403] time 0.082 (0.091) data 0.000 (0.027) loss 2.6006 (2.7438) ce_loss 1.4766 (1.6997) loss_zs_kd 0.8090 (0.5322) loss_oracle 0.5431 (0.2773) acc 53.1250 (43.5938) kd_loss 0.8525 (0.9054) lr 2.0000e-03 eta 0:29:55
epoch [2/50] batch [40/403] time 0.084 (0.088) data 0.000 (0.014) loss 2.0307 (2.5089) ce_loss 1.2979 (1.5276) loss_zs_kd 0.8656 (0.6545) loss_oracle 0.2770 (0.2964) acc 46.8750 (48.2812) kd_loss 0.5944 (0.8331) lr 2.0000e-03 eta 0:29:02
epoch [2/50] batch [60/403] time 0.084 (0.087) data 0.000 (0.009) loss 2.3333 (2.4007) ce_loss 1.2949 (1.4552) loss_zs_kd 0.5875 (0.7066) loss_oracle 0.3977 (0.3367) acc 56.2500 (49.6354) kd_loss 0.8396 (0.7771) lr 2.0000e-03 eta 0:28:28
epoch [2/50] batch [80/403] time 0.081 (0.087) data 0.000 (0.007) loss 2.5840 (2.4206) ce_loss 1.2910 (1.4291) loss_zs_kd 0.7497 (0.7777) loss_oracle 0.5821 (0.3788) acc 43.7500 (50.6641) kd_loss 1.0020 (0.8021) lr 2.0000e-03 eta 0:28:36
epoch [2/50] batch [100/403] time 0.091 (0.087) data 0.000 (0.006) loss 3.2706 (2.4439) ce_loss 1.9814 (1.3935) loss_zs_kd 1.0786 (0.8260) loss_oracle 0.5542 (0.4240) acc 25.0000 (51.5625) kd_loss 1.0120 (0.8384) lr 2.0000e-03 eta 0:28:29
epoch [2/50] batch [120/403] time 0.091 (0.088) data 0.000 (0.005) loss 2.6413 (2.4440) ce_loss 1.3467 (1.3542) loss_zs_kd 1.0087 (0.8605) loss_oracle 0.5287 (0.4432) acc 56.2500 (52.8646) kd_loss 1.0302 (0.8682) lr 2.0000e-03 eta 0:28:39
epoch [2/50] batch [140/403] time 0.082 (0.088) data 0.000 (0.004) loss 2.3821 (2.4455) ce_loss 1.1660 (1.3285) loss_zs_kd 1.0950 (0.9081) loss_oracle 0.5052 (0.4621) acc 56.2500 (53.5045) kd_loss 0.9635 (0.8859) lr 2.0000e-03 eta 0:28:39
epoch [2/50] batch [160/403] time 0.092 (0.087) data 0.000 (0.004) loss 2.1030 (2.4395) ce_loss 0.9141 (1.3064) loss_zs_kd 1.2743 (0.9341) loss_oracle 0.5227 (0.4748) acc 65.6250 (54.2188) kd_loss 0.9276 (0.8957) lr 2.0000e-03 eta 0:28:31
epoch [2/50] batch [180/403] time 0.087 (0.087) data 0.000 (0.003) loss 2.2484 (2.4209) ce_loss 1.0449 (1.2827) loss_zs_kd 1.3187 (0.9779) loss_oracle 0.5293 (0.4744) acc 62.5000 (55.1562) kd_loss 0.9388 (0.9010) lr 2.0000e-03 eta 0:28:14
epoch [2/50] batch [200/403] time 0.085 (0.086) data 0.000 (0.003) loss 2.3878 (2.4113) ce_loss 1.2061 (1.2691) loss_zs_kd 1.7872 (1.0196) loss_oracle 0.4827 (0.4780) acc 59.3750 (55.7031) kd_loss 0.9404 (0.9032) lr 2.0000e-03 eta 0:28:07
epoch [2/50] batch [220/403] time 0.089 (0.086) data 0.000 (0.003) loss 2.2662 (2.3953) ce_loss 1.1328 (1.2539) loss_zs_kd 1.4910 (1.0380) loss_oracle 0.4980 (0.4772) acc 59.3750 (56.1932) kd_loss 0.8843 (0.9029) lr 2.0000e-03 eta 0:28:04
epoch [2/50] batch [240/403] time 0.075 (0.086) data 0.000 (0.003) loss 2.2071 (2.3819) ce_loss 1.0801 (1.2423) loss_zs_kd 1.0710 (1.0513) loss_oracle 0.4515 (0.4761) acc 53.1250 (56.4062) kd_loss 0.9012 (0.9016) lr 2.0000e-03 eta 0:27:50
epoch [2/50] batch [260/403] time 0.077 (0.085) data 0.000 (0.002) loss 2.1765 (2.3714) ce_loss 1.1055 (1.2349) loss_zs_kd 1.2658 (1.0687) loss_oracle 0.4948 (0.4777) acc 62.5000 (56.5865) kd_loss 0.8236 (0.8977) lr 2.0000e-03 eta 0:27:42
epoch [2/50] batch [280/403] time 0.089 (0.086) data 0.000 (0.002) loss 2.0440 (2.3573) ce_loss 0.9380 (1.2267) loss_zs_kd 1.2761 (1.0886) loss_oracle 0.5170 (0.4762) acc 65.6250 (56.7969) kd_loss 0.8475 (0.8925) lr 2.0000e-03 eta 0:27:51
epoch [2/50] batch [300/403] time 0.086 (0.086) data 0.000 (0.002) loss 2.0844 (2.3427) ce_loss 1.0293 (1.2138) loss_zs_kd 1.5920 (1.1216) loss_oracle 0.4857 (0.4842) acc 62.5000 (57.1042) kd_loss 0.8122 (0.8869) lr 2.0000e-03 eta 0:27:46
epoch [2/50] batch [320/403] time 0.087 (0.086) data 0.000 (0.002) loss 2.6024 (2.3311) ce_loss 1.5703 (1.2055) loss_zs_kd 1.6576 (1.1357) loss_oracle 0.6008 (0.4897) acc 43.7500 (57.4316) kd_loss 0.7317 (0.8807) lr 2.0000e-03 eta 0:27:45
epoch [2/50] batch [340/403] time 0.083 (0.086) data 0.000 (0.002) loss 2.2986 (2.3206) ce_loss 1.2754 (1.1980) loss_zs_kd 1.2453 (1.1589) loss_oracle 0.5138 (0.4948) acc 53.1250 (57.6562) kd_loss 0.7663 (0.8752) lr 2.0000e-03 eta 0:27:40
epoch [2/50] batch [360/403] time 0.077 (0.085) data 0.000 (0.002) loss 2.0298 (2.3147) ce_loss 0.9990 (1.1958) loss_zs_kd 1.1069 (1.1790) loss_oracle 0.4241 (0.4969) acc 68.7500 (57.6128) kd_loss 0.8188 (0.8705) lr 2.0000e-03 eta 0:27:35
epoch [2/50] batch [380/403] time 0.086 (0.085) data 0.000 (0.002) loss 1.9938 (2.3022) ce_loss 0.9199 (1.1881) loss_zs_kd 1.6044 (1.1968) loss_oracle 0.6008 (0.4980) acc 65.6250 (57.8865) kd_loss 0.7734 (0.8651) lr 2.0000e-03 eta 0:27:31
epoch [2/50] batch [400/403] time 0.078 (0.085) data 0.000 (0.002) loss 2.2589 (2.2911) ce_loss 1.2246 (1.1813) loss_zs_kd 1.3763 (1.2127) loss_oracle 0.5734 (0.5002) acc 62.5000 (58.1953) kd_loss 0.7476 (0.8597) lr 2.0000e-03 eta 0:27:27
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,532
* accuracy: 63.8%
* error: 36.2%
* macro_f1: 48.5%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,112
* accuracy: 35.9%
* error: 64.1%
* macro_f1: 25.6%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      63.8%, epoch: 2 *******
******* Domain 4 best val test acc: 35.9%, epoch: 2 *******
******* Domain 4 best test acc:     35.9%, epoch: 2 *******
epoch [3/50] batch [20/403] time 0.073 (0.137) data 0.000 (0.055) loss 2.2112 (2.0729) ce_loss 1.1270 (1.0217) loss_zs_kd 1.7984 (1.6567) loss_oracle 0.6824 (0.6046) acc 59.3750 (63.2812) kd_loss 0.7431 (0.7489) lr 1.9980e-03 eta 0:44:14
epoch [3/50] batch [40/403] time 0.080 (0.109) data 0.000 (0.027) loss 2.1920 (2.0824) ce_loss 1.1553 (1.0437) loss_zs_kd 1.7128 (1.5951) loss_oracle 0.6403 (0.6008) acc 62.5000 (62.0312) kd_loss 0.7166 (0.7382) lr 1.9980e-03 eta 0:35:05
epoch [3/50] batch [60/403] time 0.083 (0.099) data 0.001 (0.018) loss 1.7500 (2.0521) ce_loss 0.7397 (1.0182) loss_zs_kd 1.1472 (1.6189) loss_oracle 0.5740 (0.6010) acc 68.7500 (62.5000) kd_loss 0.7233 (0.7334) lr 1.9980e-03 eta 0:31:54
epoch [3/50] batch [80/403] time 0.083 (0.095) data 0.000 (0.014) loss 2.2966 (2.0524) ce_loss 1.2188 (1.0095) loss_zs_kd 1.2681 (1.6078) loss_oracle 0.7861 (0.6339) acc 59.3750 (62.8906) kd_loss 0.6847 (0.7259) lr 1.9980e-03 eta 0:30:38
epoch [3/50] batch [100/403] time 0.080 (0.094) data 0.000 (0.011) loss 1.8238 (2.0572) ce_loss 0.8149 (1.0175) loss_zs_kd 1.2510 (1.6264) loss_oracle 0.6777 (0.6452) acc 78.1250 (63.1562) kd_loss 0.6700 (0.7171) lr 1.9980e-03 eta 0:30:02
epoch [3/50] batch [120/403] time 0.073 (0.092) data 0.000 (0.009) loss 1.9216 (2.0626) ce_loss 0.8535 (1.0242) loss_zs_kd 1.7350 (1.6406) loss_oracle 0.7357 (0.6556) acc 65.6250 (63.1250) kd_loss 0.7003 (0.7106) lr 1.9980e-03 eta 0:29:26
epoch [3/50] batch [140/403] time 0.083 (0.090) data 0.000 (0.008) loss 1.7531 (2.0564) ce_loss 0.6665 (1.0203) loss_zs_kd 1.7592 (1.6625) loss_oracle 0.7913 (0.6619) acc 71.8750 (63.2143) kd_loss 0.6909 (0.7051) lr 1.9980e-03 eta 0:28:52
epoch [3/50] batch [160/403] time 0.085 (0.089) data 0.000 (0.007) loss 2.0845 (2.0541) ce_loss 1.1250 (1.0241) loss_zs_kd 1.6944 (1.6557) loss_oracle 0.5511 (0.6569) acc 62.5000 (63.2031) kd_loss 0.6839 (0.7016) lr 1.9980e-03 eta 0:28:32
epoch [3/50] batch [180/403] time 0.088 (0.089) data 0.000 (0.006) loss 2.1259 (2.0423) ce_loss 1.1172 (1.0182) loss_zs_kd 1.9379 (1.6710) loss_oracle 0.7151 (0.6530) acc 62.5000 (63.2986) kd_loss 0.6511 (0.6976) lr 1.9980e-03 eta 0:28:22
epoch [3/50] batch [200/403] time 0.082 (0.088) data 0.000 (0.006) loss 2.2632 (2.0482) ce_loss 1.2900 (1.0265) loss_zs_kd 1.7789 (1.6790) loss_oracle 0.6088 (0.6558) acc 65.6250 (63.2812) kd_loss 0.6688 (0.6938) lr 1.9980e-03 eta 0:28:13
epoch [3/50] batch [220/403] time 0.077 (0.088) data 0.000 (0.005) loss 1.9062 (2.0558) ce_loss 0.8516 (1.0337) loss_zs_kd 1.7055 (1.6780) loss_oracle 0.7698 (0.6639) acc 65.6250 (62.8551) kd_loss 0.6697 (0.6901) lr 1.9980e-03 eta 0:27:56
epoch [3/50] batch [240/403] time 0.097 (0.088) data 0.000 (0.005) loss 2.1370 (2.0586) ce_loss 1.1191 (1.0363) loss_zs_kd 1.8841 (1.6835) loss_oracle 0.7716 (0.6709) acc 59.3750 (62.8516) kd_loss 0.6320 (0.6869) lr 1.9980e-03 eta 0:27:54
epoch [3/50] batch [260/403] time 0.085 (0.087) data 0.000 (0.004) loss 2.2657 (2.0546) ce_loss 1.2705 (1.0350) loss_zs_kd 1.5385 (1.6775) loss_oracle 0.6945 (0.6708) acc 53.1250 (62.7404) kd_loss 0.6480 (0.6843) lr 1.9980e-03 eta 0:27:48
epoch [3/50] batch [280/403] time 0.082 (0.087) data 0.000 (0.004) loss 1.6446 (2.0425) ce_loss 0.5898 (1.0255) loss_zs_kd 1.8122 (1.6818) loss_oracle 0.7966 (0.6706) acc 81.2500 (63.0134) kd_loss 0.6565 (0.6817) lr 1.9980e-03 eta 0:27:40
epoch [3/50] batch [300/403] time 0.086 (0.087) data 0.000 (0.004) loss 2.1801 (2.0431) ce_loss 1.0859 (1.0229) loss_zs_kd 1.8296 (1.6922) loss_oracle 0.8792 (0.6824) acc 68.7500 (63.0104) kd_loss 0.6545 (0.6790) lr 1.9980e-03 eta 0:27:36
epoch [3/50] batch [320/403] time 0.074 (0.087) data 0.000 (0.004) loss 1.7797 (2.0473) ce_loss 0.8140 (1.0262) loss_zs_kd 1.2519 (1.6945) loss_oracle 0.6434 (0.6894) acc 71.8750 (62.9102) kd_loss 0.6440 (0.6764) lr 1.9980e-03 eta 0:27:26
epoch [3/50] batch [340/403] time 0.083 (0.086) data 0.000 (0.003) loss 2.0846 (2.0449) ce_loss 1.0166 (1.0246) loss_zs_kd 2.0403 (1.7079) loss_oracle 0.8653 (0.6925) acc 65.6250 (62.9688) kd_loss 0.6353 (0.6740) lr 1.9980e-03 eta 0:27:16
epoch [3/50] batch [360/403] time 0.083 (0.086) data 0.000 (0.003) loss 2.0021 (2.0414) ce_loss 0.9932 (1.0211) loss_zs_kd 2.0577 (1.7150) loss_oracle 0.7687 (0.6974) acc 65.6250 (63.2378) kd_loss 0.6246 (0.6716) lr 1.9980e-03 eta 0:27:12
epoch [3/50] batch [380/403] time 0.094 (0.086) data 0.000 (0.003) loss 1.9494 (2.0354) ce_loss 1.0186 (1.0176) loss_zs_kd 1.8706 (1.7211) loss_oracle 0.5762 (0.6960) acc 59.3750 (63.4211) kd_loss 0.6427 (0.6698) lr 1.9980e-03 eta 0:27:10
epoch [3/50] batch [400/403] time 0.077 (0.086) data 0.000 (0.003) loss 2.2862 (2.0325) ce_loss 1.2256 (1.0160) loss_zs_kd 2.1639 (1.7291) loss_oracle 0.9102 (0.6976) acc 56.2500 (63.5781) kd_loss 0.6055 (0.6677) lr 1.9980e-03 eta 0:27:05
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,751
* accuracy: 67.8%
* error: 32.2%
* macro_f1: 52.6%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,084
* accuracy: 35.4%
* error: 64.6%
* macro_f1: 25.8%
******* Domain 4 best val acc:      67.8%, epoch: 3 *******
******* Domain 4 best val test acc: 35.4%, epoch: 3 *******
******* Domain 4 best test acc:     35.9%, epoch: 2 *******
epoch [4/50] batch [20/403] time 0.092 (0.147) data 0.000 (0.052) loss 1.9610 (1.9918) ce_loss 0.9287 (0.9657) loss_zs_kd 1.4490 (1.8512) loss_oracle 0.7857 (0.8050) acc 68.7500 (64.5312) kd_loss 0.6394 (0.6235) lr 1.9921e-03 eta 0:46:24
epoch [4/50] batch [40/403] time 0.081 (0.114) data 0.000 (0.026) loss 2.0302 (1.9973) ce_loss 1.0439 (0.9758) loss_zs_kd 1.8876 (1.8481) loss_oracle 0.7345 (0.7961) acc 62.5000 (65.0781) kd_loss 0.6190 (0.6234) lr 1.9921e-03 eta 0:35:56
epoch [4/50] batch [60/403] time 0.091 (0.104) data 0.000 (0.018) loss 2.1069 (2.0179) ce_loss 1.0283 (0.9922) loss_zs_kd 1.8700 (1.8685) loss_oracle 0.9549 (0.8049) acc 65.6250 (64.8958) kd_loss 0.6012 (0.6233) lr 1.9921e-03 eta 0:32:52
epoch [4/50] batch [80/403] time 0.075 (0.099) data 0.000 (0.013) loss 1.7721 (2.0149) ce_loss 0.7651 (0.9866) loss_zs_kd 2.1830 (1.8662) loss_oracle 0.7525 (0.8139) acc 78.1250 (65.0391) kd_loss 0.6307 (0.6214) lr 1.9921e-03 eta 0:31:06
epoch [4/50] batch [100/403] time 0.083 (0.095) data 0.000 (0.011) loss 2.2855 (2.0292) ce_loss 1.3359 (1.0069) loss_zs_kd 1.7968 (1.8393) loss_oracle 0.7486 (0.8033) acc 43.7500 (64.0625) kd_loss 0.5753 (0.6207) lr 1.9921e-03 eta 0:29:50
epoch [4/50] batch [120/403] time 0.078 (0.093) data 0.000 (0.009) loss 2.2199 (2.0171) ce_loss 1.1494 (0.9975) loss_zs_kd 1.9634 (1.8468) loss_oracle 0.8953 (0.8042) acc 68.7500 (64.4792) kd_loss 0.6229 (0.6175) lr 1.9921e-03 eta 0:29:01
epoch [4/50] batch [140/403] time 0.087 (0.092) data 0.000 (0.008) loss 1.9697 (2.0158) ce_loss 0.9463 (0.9946) loss_zs_kd 1.8260 (1.8719) loss_oracle 0.8709 (0.8128) acc 71.8750 (64.7545) kd_loss 0.5879 (0.6148) lr 1.9921e-03 eta 0:28:41
epoch [4/50] batch [160/403] time 0.079 (0.091) data 0.000 (0.007) loss 2.1190 (2.0163) ce_loss 1.1963 (0.9969) loss_zs_kd 1.4380 (1.8559) loss_oracle 0.6522 (0.8104) acc 59.3750 (64.7070) kd_loss 0.5966 (0.6142) lr 1.9921e-03 eta 0:28:23
epoch [4/50] batch [180/403] time 0.080 (0.089) data 0.000 (0.006) loss 1.8102 (2.0136) ce_loss 0.8276 (1.0003) loss_zs_kd 2.0273 (1.8703) loss_oracle 0.7442 (0.8008) acc 71.8750 (64.4444) kd_loss 0.6105 (0.6129) lr 1.9921e-03 eta 0:27:58
epoch [4/50] batch [200/403] time 0.084 (0.088) data 0.000 (0.005) loss 2.0074 (2.0120) ce_loss 1.0234 (1.0003) loss_zs_kd 1.6102 (1.8665) loss_oracle 0.7435 (0.7981) acc 56.2500 (64.4688) kd_loss 0.6123 (0.6126) lr 1.9921e-03 eta 0:27:37
epoch [4/50] batch [220/403] time 0.086 (0.088) data 0.000 (0.005) loss 1.7543 (2.0019) ce_loss 0.7300 (0.9915) loss_zs_kd 2.1336 (1.8716) loss_oracle 0.8284 (0.7952) acc 75.0000 (64.6733) kd_loss 0.6102 (0.6128) lr 1.9921e-03 eta 0:27:20
epoch [4/50] batch [240/403] time 0.078 (0.087) data 0.000 (0.005) loss 2.0204 (2.0030) ce_loss 1.0098 (0.9937) loss_zs_kd 1.9322 (1.8635) loss_oracle 0.8103 (0.7933) acc 62.5000 (64.4792) kd_loss 0.6055 (0.6127) lr 1.9921e-03 eta 0:27:14
epoch [4/50] batch [260/403] time 0.080 (0.087) data 0.000 (0.004) loss 1.8702 (2.0022) ce_loss 0.7690 (0.9882) loss_zs_kd 2.4099 (1.8743) loss_oracle 0.9557 (0.8022) acc 71.8750 (64.7115) kd_loss 0.6233 (0.6129) lr 1.9921e-03 eta 0:27:01
epoch [4/50] batch [280/403] time 0.075 (0.086) data 0.000 (0.004) loss 2.2225 (1.9974) ce_loss 1.2646 (0.9815) loss_zs_kd 2.2394 (1.8797) loss_oracle 0.7051 (0.8052) acc 56.2500 (65.0335) kd_loss 0.6053 (0.6133) lr 1.9921e-03 eta 0:26:48
epoch [4/50] batch [300/403] time 0.093 (0.086) data 0.000 (0.004) loss 2.1676 (1.9958) ce_loss 1.2354 (0.9806) loss_zs_kd 1.7023 (1.8836) loss_oracle 0.6665 (0.8036) acc 50.0000 (65.0208) kd_loss 0.5990 (0.6133) lr 1.9921e-03 eta 0:26:45
epoch [4/50] batch [320/403] time 0.082 (0.086) data 0.000 (0.003) loss 1.8668 (1.9962) ce_loss 0.8433 (0.9828) loss_zs_kd 1.6159 (1.8841) loss_oracle 0.7668 (0.8005) acc 75.0000 (65.0293) kd_loss 0.6401 (0.6131) lr 1.9921e-03 eta 0:26:44
epoch [4/50] batch [340/403] time 0.087 (0.086) data 0.000 (0.003) loss 2.2155 (1.9970) ce_loss 1.2061 (0.9834) loss_zs_kd 2.0519 (1.8890) loss_oracle 0.8254 (0.8017) acc 62.5000 (64.9449) kd_loss 0.5967 (0.6128) lr 1.9921e-03 eta 0:26:34
epoch [4/50] batch [360/403] time 0.080 (0.085) data 0.000 (0.003) loss 2.1420 (1.9898) ce_loss 1.1602 (0.9782) loss_zs_kd 2.1330 (1.8927) loss_oracle 0.7205 (0.7986) acc 65.6250 (65.1128) kd_loss 0.6216 (0.6122) lr 1.9921e-03 eta 0:26:27
epoch [4/50] batch [380/403] time 0.081 (0.085) data 0.000 (0.003) loss 2.1338 (1.9927) ce_loss 1.1055 (0.9812) loss_zs_kd 2.4346 (1.9000) loss_oracle 0.8746 (0.7991) acc 56.2500 (65.0000) kd_loss 0.5911 (0.6119) lr 1.9921e-03 eta 0:26:22
epoch [4/50] batch [400/403] time 0.081 (0.085) data 0.000 (0.003) loss 2.5895 (1.9934) ce_loss 1.5342 (0.9801) loss_zs_kd 1.5764 (1.8966) loss_oracle 0.8878 (0.8044) acc 50.0000 (65.0859) kd_loss 0.6115 (0.6111) lr 1.9921e-03 eta 0:26:19
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,816
* accuracy: 68.9%
* error: 31.1%
* macro_f1: 53.7%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,364
* accuracy: 40.2%
* error: 59.8%
* macro_f1: 31.0%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      68.9%, epoch: 4 *******
******* Domain 4 best val test acc: 40.2%, epoch: 4 *******
******* Domain 4 best test acc:     40.2%, epoch: 4 *******
epoch [5/50] batch [20/403] time 0.086 (0.133) data 0.000 (0.047) loss 2.1380 (2.0689) ce_loss 1.1084 (1.0002) loss_zs_kd 2.2256 (1.9119) loss_oracle 0.8465 (0.9298) acc 59.3750 (64.3750) kd_loss 0.6064 (0.6039) lr 1.9823e-03 eta 0:41:12
epoch [5/50] batch [40/403] time 0.077 (0.109) data 0.000 (0.024) loss 2.2582 (2.0578) ce_loss 1.1709 (0.9753) loss_zs_kd 2.2265 (1.9987) loss_oracle 0.9943 (0.9520) acc 62.5000 (65.1562) kd_loss 0.5901 (0.6065) lr 1.9823e-03 eta 0:33:42
epoch [5/50] batch [60/403] time 0.079 (0.099) data 0.001 (0.016) loss 1.9376 (2.0287) ce_loss 0.9702 (0.9547) loss_zs_kd 1.9021 (2.0056) loss_oracle 0.7470 (0.9294) acc 62.5000 (65.6250) kd_loss 0.5939 (0.6093) lr 1.9823e-03 eta 0:30:30
epoch [5/50] batch [80/403] time 0.090 (0.095) data 0.000 (0.012) loss 1.9963 (2.0137) ce_loss 0.9536 (0.9534) loss_zs_kd 2.4346 (2.0001) loss_oracle 0.8750 (0.9005) acc 75.0000 (66.2109) kd_loss 0.6052 (0.6101) lr 1.9823e-03 eta 0:29:08
epoch [5/50] batch [100/403] time 0.080 (0.092) data 0.000 (0.010) loss 1.7393 (2.0016) ce_loss 0.7505 (0.9522) loss_zs_kd 2.2199 (2.0321) loss_oracle 0.8125 (0.8780) acc 68.7500 (65.4375) kd_loss 0.5825 (0.6104) lr 1.9823e-03 eta 0:28:18
epoch [5/50] batch [120/403] time 0.094 (0.091) data 0.000 (0.008) loss 2.1256 (2.0008) ce_loss 1.1689 (0.9533) loss_zs_kd 1.7304 (2.0355) loss_oracle 0.7387 (0.8749) acc 59.3750 (65.6250) kd_loss 0.5873 (0.6100) lr 1.9823e-03 eta 0:27:52
epoch [5/50] batch [140/403] time 0.090 (0.090) data 0.000 (0.007) loss 2.0979 (2.0035) ce_loss 1.0752 (0.9582) loss_zs_kd 2.1771 (2.0187) loss_oracle 0.8939 (0.8708) acc 59.3750 (65.5357) kd_loss 0.5757 (0.6099) lr 1.9823e-03 eta 0:27:37
epoch [5/50] batch [160/403] time 0.082 (0.089) data 0.000 (0.006) loss 2.3877 (2.0088) ce_loss 1.3438 (0.9637) loss_zs_kd 2.0375 (2.0250) loss_oracle 0.8069 (0.8638) acc 50.0000 (65.3711) kd_loss 0.6404 (0.6133) lr 1.9823e-03 eta 0:27:16
epoch [5/50] batch [180/403] time 0.087 (0.089) data 0.000 (0.005) loss 1.6399 (2.0027) ce_loss 0.5962 (0.9577) loss_zs_kd 1.7670 (2.0165) loss_oracle 0.7556 (0.8531) acc 81.2500 (65.5556) kd_loss 0.6659 (0.6185) lr 1.9823e-03 eta 0:27:06
epoch [5/50] batch [200/403] time 0.093 (0.088) data 0.000 (0.005) loss 1.9405 (2.0030) ce_loss 0.9419 (0.9580) loss_zs_kd 1.6961 (2.0074) loss_oracle 0.7557 (0.8451) acc 75.0000 (65.2656) kd_loss 0.6208 (0.6224) lr 1.9823e-03 eta 0:27:01
epoch [5/50] batch [220/403] time 0.080 (0.088) data 0.000 (0.005) loss 1.9799 (2.0010) ce_loss 0.9243 (0.9554) loss_zs_kd 1.9840 (2.0246) loss_oracle 0.7671 (0.8398) acc 62.5000 (65.5398) kd_loss 0.6720 (0.6257) lr 1.9823e-03 eta 0:26:54
epoch [5/50] batch [240/403] time 0.075 (0.088) data 0.000 (0.004) loss 1.8583 (2.0014) ce_loss 0.8018 (0.9579) loss_zs_kd 1.9794 (2.0252) loss_oracle 0.7493 (0.8326) acc 71.8750 (65.3385) kd_loss 0.6819 (0.6271) lr 1.9823e-03 eta 0:26:54
epoch [5/50] batch [260/403] time 0.087 (0.088) data 0.000 (0.004) loss 1.8947 (1.9985) ce_loss 0.8647 (0.9575) loss_zs_kd 1.8888 (2.0145) loss_oracle 0.7712 (0.8283) acc 65.6250 (65.5048) kd_loss 0.6443 (0.6268) lr 1.9823e-03 eta 0:26:40
epoch [5/50] batch [280/403] time 0.085 (0.088) data 0.000 (0.004) loss 1.7889 (2.0012) ce_loss 0.7500 (0.9590) loss_zs_kd 2.2880 (2.0184) loss_oracle 0.9029 (0.8312) acc 78.1250 (65.5357) kd_loss 0.5874 (0.6266) lr 1.9823e-03 eta 0:26:38
epoch [5/50] batch [300/403] time 0.075 (0.087) data 0.000 (0.003) loss 1.8910 (1.9989) ce_loss 0.8857 (0.9582) loss_zs_kd 2.2097 (2.0096) loss_oracle 0.7397 (0.8282) acc 65.6250 (65.5625) kd_loss 0.6354 (0.6266) lr 1.9823e-03 eta 0:26:28
epoch [5/50] batch [320/403] time 0.069 (0.087) data 0.000 (0.003) loss 2.0882 (1.9967) ce_loss 1.1650 (0.9569) loss_zs_kd 2.2155 (2.0193) loss_oracle 0.6595 (0.8264) acc 56.2500 (65.7422) kd_loss 0.5934 (0.6266) lr 1.9823e-03 eta 0:26:22
epoch [5/50] batch [340/403] time 0.079 (0.086) data 0.000 (0.003) loss 1.6728 (1.9951) ce_loss 0.7002 (0.9577) loss_zs_kd 1.8268 (2.0267) loss_oracle 0.7181 (0.8223) acc 84.3750 (65.7996) kd_loss 0.6136 (0.6262) lr 1.9823e-03 eta 0:26:05
epoch [5/50] batch [360/403] time 0.079 (0.085) data 0.000 (0.003) loss 2.2580 (1.9906) ce_loss 1.1895 (0.9537) loss_zs_kd 1.7040 (2.0206) loss_oracle 0.8512 (0.8219) acc 59.3750 (65.9375) kd_loss 0.6429 (0.6259) lr 1.9823e-03 eta 0:25:50
epoch [5/50] batch [380/403] time 0.087 (0.085) data 0.000 (0.003) loss 1.8899 (1.9889) ce_loss 0.8867 (0.9538) loss_zs_kd 2.2219 (2.0232) loss_oracle 0.7919 (0.8190) acc 71.8750 (65.8553) kd_loss 0.6072 (0.6255) lr 1.9823e-03 eta 0:25:46
epoch [5/50] batch [400/403] time 0.081 (0.085) data 0.000 (0.003) loss 2.2522 (1.9914) ce_loss 1.1289 (0.9564) loss_zs_kd 2.0821 (2.0243) loss_oracle 0.9490 (0.8198) acc 53.1250 (65.7031) kd_loss 0.6487 (0.6251) lr 1.9823e-03 eta 0:25:43
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,841
* accuracy: 69.4%
* error: 30.6%
* macro_f1: 53.3%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,308
* accuracy: 39.2%
* error: 60.8%
* macro_f1: 28.5%
******* Domain 4 best val acc:      69.4%, epoch: 5 *******
******* Domain 4 best val test acc: 39.2%, epoch: 5 *******
******* Domain 4 best test acc:     40.2%, epoch: 4 *******
epoch [6/50] batch [20/403] time 0.091 (0.144) data 0.000 (0.058) loss 1.8885 (1.9868) ce_loss 0.7842 (0.9407) loss_zs_kd 2.1164 (2.0626) loss_oracle 0.9517 (0.8550) acc 71.8750 (64.2188) kd_loss 0.6285 (0.6186) lr 1.9686e-03 eta 0:43:30
epoch [6/50] batch [40/403] time 0.085 (0.115) data 0.000 (0.029) loss 2.0577 (2.0035) ce_loss 0.9653 (0.9489) loss_zs_kd 2.1124 (2.0270) loss_oracle 0.9189 (0.8722) acc 65.6250 (64.4531) kd_loss 0.6329 (0.6185) lr 1.9686e-03 eta 0:34:45
epoch [6/50] batch [60/403] time 0.091 (0.106) data 0.000 (0.019) loss 2.2197 (1.9900) ce_loss 1.1943 (0.9447) loss_zs_kd 1.7334 (2.0540) loss_oracle 0.7179 (0.8483) acc 65.6250 (65.2604) kd_loss 0.6664 (0.6211) lr 1.9686e-03 eta 0:31:53
epoch [6/50] batch [80/403] time 0.085 (0.101) data 0.000 (0.015) loss 2.0214 (1.9809) ce_loss 1.0098 (0.9336) loss_zs_kd 1.7684 (2.1020) loss_oracle 0.7625 (0.8414) acc 75.0000 (66.2109) kd_loss 0.6303 (0.6266) lr 1.9686e-03 eta 0:30:23
epoch [6/50] batch [100/403] time 0.081 (0.099) data 0.000 (0.012) loss 1.8966 (1.9916) ce_loss 0.8975 (0.9469) loss_zs_kd 2.2123 (2.1073) loss_oracle 0.7685 (0.8295) acc 68.7500 (65.6562) kd_loss 0.6149 (0.6299) lr 1.9686e-03 eta 0:29:40
epoch [6/50] batch [120/403] time 0.078 (0.095) data 0.000 (0.010) loss 1.8057 (1.9971) ce_loss 0.8232 (0.9528) loss_zs_kd 2.1159 (2.1390) loss_oracle 0.6967 (0.8238) acc 68.7500 (65.4688) kd_loss 0.6341 (0.6324) lr 1.9686e-03 eta 0:28:37
epoch [6/50] batch [140/403] time 0.082 (0.094) data 0.000 (0.008) loss 1.9163 (1.9832) ce_loss 0.8491 (0.9397) loss_zs_kd 1.9943 (2.1278) loss_oracle 0.8513 (0.8178) acc 59.3750 (65.8259) kd_loss 0.6415 (0.6347) lr 1.9686e-03 eta 0:28:05
epoch [6/50] batch [160/403] time 0.069 (0.091) data 0.000 (0.007) loss 2.2057 (1.9802) ce_loss 1.1377 (0.9386) loss_zs_kd 2.3791 (2.1217) loss_oracle 0.7826 (0.8127) acc 50.0000 (65.8008) kd_loss 0.6767 (0.6353) lr 1.9686e-03 eta 0:27:23
epoch [6/50] batch [180/403] time 0.074 (0.090) data 0.000 (0.007) loss 2.2663 (1.9779) ce_loss 1.2402 (0.9378) loss_zs_kd 2.3836 (2.1300) loss_oracle 0.7448 (0.8060) acc 59.3750 (65.9896) kd_loss 0.6537 (0.6371) lr 1.9686e-03 eta 0:27:02
epoch [6/50] batch [200/403] time 0.075 (0.090) data 0.000 (0.006) loss 2.0608 (1.9715) ce_loss 0.9692 (0.9340) loss_zs_kd 2.5338 (2.1199) loss_oracle 0.9484 (0.7998) acc 65.6250 (66.1875) kd_loss 0.6174 (0.6377) lr 1.9686e-03 eta 0:26:47
epoch [6/50] batch [220/403] time 0.072 (0.089) data 0.000 (0.005) loss 1.9184 (1.9756) ce_loss 0.9160 (0.9378) loss_zs_kd 2.0168 (2.1272) loss_oracle 0.6941 (0.8011) acc 65.6250 (66.0795) kd_loss 0.6553 (0.6373) lr 1.9686e-03 eta 0:26:31
epoch [6/50] batch [240/403] time 0.082 (0.088) data 0.000 (0.005) loss 2.0653 (1.9782) ce_loss 1.0615 (0.9408) loss_zs_kd 1.9787 (2.1352) loss_oracle 0.7322 (0.8001) acc 53.1250 (65.9375) kd_loss 0.6377 (0.6373) lr 1.9686e-03 eta 0:26:15
epoch [6/50] batch [260/403] time 0.080 (0.087) data 0.000 (0.005) loss 2.0564 (1.9826) ce_loss 1.0352 (0.9465) loss_zs_kd 2.1535 (2.1266) loss_oracle 0.8680 (0.7980) acc 59.3750 (65.7212) kd_loss 0.5873 (0.6370) lr 1.9686e-03 eta 0:26:03
epoch [6/50] batch [280/403] time 0.079 (0.087) data 0.001 (0.004) loss 2.0122 (1.9812) ce_loss 1.0039 (0.9468) loss_zs_kd 2.1393 (2.1236) loss_oracle 0.7450 (0.7951) acc 53.1250 (65.5580) kd_loss 0.6358 (0.6368) lr 1.9686e-03 eta 0:25:52
epoch [6/50] batch [300/403] time 0.087 (0.087) data 0.000 (0.004) loss 1.9500 (1.9826) ce_loss 0.9229 (0.9477) loss_zs_kd 2.1270 (2.1172) loss_oracle 0.8500 (0.7951) acc 65.6250 (65.6354) kd_loss 0.6022 (0.6373) lr 1.9686e-03 eta 0:25:49
epoch [6/50] batch [320/403] time 0.092 (0.087) data 0.000 (0.004) loss 1.9431 (1.9874) ce_loss 0.8813 (0.9493) loss_zs_kd 1.9311 (2.1088) loss_oracle 0.8022 (0.7999) acc 65.6250 (65.6055) kd_loss 0.6607 (0.6381) lr 1.9686e-03 eta 0:25:44
epoch [6/50] batch [340/403] time 0.095 (0.087) data 0.000 (0.004) loss 1.5726 (1.9895) ce_loss 0.5044 (0.9487) loss_zs_kd 1.4787 (2.0969) loss_oracle 0.7994 (0.8010) acc 87.5000 (65.6250) kd_loss 0.6685 (0.6403) lr 1.9686e-03 eta 0:25:41
epoch [6/50] batch [360/403] time 0.078 (0.086) data 0.000 (0.003) loss 2.3131 (1.9917) ce_loss 1.2451 (0.9515) loss_zs_kd 2.8241 (2.0938) loss_oracle 0.7558 (0.7961) acc 59.3750 (65.5035) kd_loss 0.6901 (0.6421) lr 1.9686e-03 eta 0:25:37
epoch [6/50] batch [380/403] time 0.083 (0.086) data 0.000 (0.003) loss 2.0610 (1.9892) ce_loss 1.0713 (0.9505) loss_zs_kd 1.8508 (2.0861) loss_oracle 0.6797 (0.7901) acc 65.6250 (65.5345) kd_loss 0.6498 (0.6436) lr 1.9686e-03 eta 0:25:35
epoch [6/50] batch [400/403] time 0.079 (0.086) data 0.000 (0.003) loss 1.9378 (1.9912) ce_loss 0.8267 (0.9523) loss_zs_kd 2.1861 (2.0809) loss_oracle 0.7592 (0.7877) acc 75.0000 (65.4844) kd_loss 0.7315 (0.6451) lr 1.9686e-03 eta 0:25:30
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,906
* accuracy: 70.6%
* error: 29.4%
* macro_f1: 57.6%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,344
* accuracy: 39.8%
* error: 60.2%
* macro_f1: 33.1%
******* Domain 4 best val acc:      70.6%, epoch: 6 *******
******* Domain 4 best val test acc: 39.8%, epoch: 6 *******
******* Domain 4 best test acc:     40.2%, epoch: 4 *******
epoch [7/50] batch [20/403] time 0.084 (0.157) data 0.000 (0.068) loss 1.8395 (2.0023) ce_loss 0.7925 (0.9255) loss_zs_kd 2.3549 (1.9949) loss_oracle 0.6984 (0.7776) acc 71.8750 (66.0938) kd_loss 0.6978 (0.6880) lr 1.9511e-03 eta 0:46:27
epoch [7/50] batch [40/403] time 0.082 (0.121) data 0.000 (0.034) loss 1.9834 (2.0019) ce_loss 0.8369 (0.9230) loss_zs_kd 2.0583 (2.0184) loss_oracle 0.8869 (0.7848) acc 65.6250 (66.6406) kd_loss 0.7030 (0.6865) lr 1.9511e-03 eta 0:35:34
epoch [7/50] batch [60/403] time 0.078 (0.108) data 0.000 (0.023) loss 2.0971 (2.0004) ce_loss 1.0400 (0.9241) loss_zs_kd 1.6876 (2.0539) loss_oracle 0.8140 (0.7865) acc 68.7500 (67.1875) kd_loss 0.6501 (0.6831) lr 1.9511e-03 eta 0:31:49
epoch [7/50] batch [80/403] time 0.085 (0.103) data 0.000 (0.017) loss 1.9570 (2.0109) ce_loss 0.8584 (0.9316) loss_zs_kd 2.0729 (2.0371) loss_oracle 0.7927 (0.7874) acc 62.5000 (66.8359) kd_loss 0.7022 (0.6855) lr 1.9511e-03 eta 0:30:14
epoch [7/50] batch [100/403] time 0.078 (0.098) data 0.000 (0.014) loss 2.2468 (1.9991) ce_loss 1.1045 (0.9225) loss_zs_kd 2.6400 (2.0141) loss_oracle 0.8421 (0.7841) acc 62.5000 (67.1562) kd_loss 0.7212 (0.6845) lr 1.9511e-03 eta 0:28:48
epoch [7/50] batch [120/403] time 0.078 (0.095) data 0.000 (0.012) loss 2.1400 (2.0108) ce_loss 1.0938 (0.9309) loss_zs_kd 2.0685 (2.0414) loss_oracle 0.7796 (0.7884) acc 56.2500 (66.7188) kd_loss 0.6565 (0.6857) lr 1.9511e-03 eta 0:27:55
epoch [7/50] batch [140/403] time 0.080 (0.093) data 0.000 (0.010) loss 2.0531 (2.0120) ce_loss 0.9229 (0.9333) loss_zs_kd 2.2908 (2.0533) loss_oracle 0.7349 (0.7797) acc 65.6250 (66.7188) kd_loss 0.7628 (0.6889) lr 1.9511e-03 eta 0:27:11
epoch [7/50] batch [160/403] time 0.091 (0.091) data 0.000 (0.009) loss 1.5619 (1.9968) ce_loss 0.5161 (0.9214) loss_zs_kd 2.3933 (2.0462) loss_oracle 0.7369 (0.7707) acc 81.2500 (67.3242) kd_loss 0.6773 (0.6900) lr 1.9511e-03 eta 0:26:46
epoch [7/50] batch [180/403] time 0.081 (0.091) data 0.000 (0.008) loss 2.0283 (1.9983) ce_loss 0.8940 (0.9219) loss_zs_kd 2.1996 (2.0446) loss_oracle 0.8837 (0.7695) acc 75.0000 (67.1528) kd_loss 0.6924 (0.6917) lr 1.9511e-03 eta 0:26:30
epoch [7/50] batch [200/403] time 0.089 (0.090) data 0.000 (0.007) loss 1.6276 (2.0017) ce_loss 0.5352 (0.9251) loss_zs_kd 1.6687 (2.0338) loss_oracle 0.7083 (0.7638) acc 78.1250 (67.0000) kd_loss 0.7383 (0.6947) lr 1.9511e-03 eta 0:26:14
epoch [7/50] batch [220/403] time 0.079 (0.089) data 0.000 (0.006) loss 1.9427 (2.0006) ce_loss 0.9346 (0.9248) loss_zs_kd 2.3846 (2.0499) loss_oracle 0.6246 (0.7587) acc 68.7500 (66.9176) kd_loss 0.6958 (0.6964) lr 1.9511e-03 eta 0:26:01
epoch [7/50] batch [240/403] time 0.089 (0.089) data 0.000 (0.006) loss 1.9361 (1.9984) ce_loss 0.8677 (0.9266) loss_zs_kd 2.6855 (2.0501) loss_oracle 0.6852 (0.7489) acc 65.6250 (66.9661) kd_loss 0.7258 (0.6974) lr 1.9511e-03 eta 0:25:49
epoch [7/50] batch [260/403] time 0.084 (0.089) data 0.000 (0.005) loss 2.1510 (1.9994) ce_loss 1.1045 (0.9289) loss_zs_kd 2.1868 (2.0555) loss_oracle 0.6174 (0.7444) acc 53.1250 (66.7428) kd_loss 0.7378 (0.6984) lr 1.9511e-03 eta 0:25:46
epoch [7/50] batch [280/403] time 0.086 (0.088) data 0.000 (0.005) loss 2.0504 (1.9977) ce_loss 0.9219 (0.9269) loss_zs_kd 2.0577 (2.0625) loss_oracle 0.7702 (0.7412) acc 71.8750 (66.7746) kd_loss 0.7434 (0.7001) lr 1.9511e-03 eta 0:25:44
epoch [7/50] batch [300/403] time 0.081 (0.088) data 0.000 (0.005) loss 1.8020 (1.9989) ce_loss 0.7627 (0.9290) loss_zs_kd 2.0686 (2.0738) loss_oracle 0.6356 (0.7396) acc 71.8750 (66.6979) kd_loss 0.7215 (0.7001) lr 1.9511e-03 eta 0:25:33
epoch [7/50] batch [320/403] time 0.087 (0.088) data 0.000 (0.005) loss 1.9403 (1.9986) ce_loss 0.9209 (0.9278) loss_zs_kd 2.2737 (2.0935) loss_oracle 0.7131 (0.7395) acc 62.5000 (66.6895) kd_loss 0.6629 (0.7011) lr 1.9511e-03 eta 0:25:27
epoch [7/50] batch [340/403] time 0.084 (0.087) data 0.000 (0.004) loss 1.9477 (1.9960) ce_loss 0.8369 (0.9248) loss_zs_kd 2.3033 (2.0855) loss_oracle 0.7639 (0.7392) acc 62.5000 (66.8750) kd_loss 0.7288 (0.7016) lr 1.9511e-03 eta 0:25:20
epoch [7/50] batch [360/403] time 0.089 (0.087) data 0.000 (0.004) loss 2.4276 (1.9992) ce_loss 1.2842 (0.9282) loss_zs_kd 2.0221 (2.0948) loss_oracle 0.7697 (0.7371) acc 62.5000 (66.7882) kd_loss 0.7585 (0.7024) lr 1.9511e-03 eta 0:25:16
epoch [7/50] batch [380/403] time 0.088 (0.087) data 0.000 (0.004) loss 2.2511 (2.0006) ce_loss 1.1514 (0.9302) loss_zs_kd 1.8354 (2.0993) loss_oracle 0.8147 (0.7356) acc 65.6250 (66.7023) kd_loss 0.6924 (0.7025) lr 1.9511e-03 eta 0:25:12
epoch [7/50] batch [400/403] time 0.080 (0.087) data 0.000 (0.004) loss 2.0720 (2.0026) ce_loss 1.0234 (0.9330) loss_zs_kd 1.9412 (2.0947) loss_oracle 0.6822 (0.7343) acc 65.6250 (66.5469) kd_loss 0.7075 (0.7025) lr 1.9511e-03 eta 0:25:07
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,884
* accuracy: 70.2%
* error: 29.8%
* macro_f1: 55.0%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,353
* accuracy: 40.0%
* error: 60.0%
* macro_f1: 29.5%
******* Domain 4 best val acc:      70.6%, epoch: 6 *******
******* Domain 4 best val test acc: 39.8%, epoch: 6 *******
******* Domain 4 best test acc:     40.2%, epoch: 4 *******
epoch [8/50] batch [20/403] time 0.083 (0.144) data 0.000 (0.059) loss 1.9654 (2.0142) ce_loss 0.9399 (0.9595) loss_zs_kd 2.3243 (2.0132) loss_oracle 0.6643 (0.7054) acc 68.7500 (67.1875) kd_loss 0.6933 (0.7020) lr 1.9298e-03 eta 0:41:35
epoch [8/50] batch [40/403] time 0.077 (0.115) data 0.000 (0.030) loss 1.8735 (2.0278) ce_loss 0.8838 (0.9775) loss_zs_kd 2.2611 (2.0837) loss_oracle 0.6537 (0.7055) acc 59.3750 (65.4688) kd_loss 0.6629 (0.6975) lr 1.9298e-03 eta 0:33:07
epoch [8/50] batch [60/403] time 0.093 (0.104) data 0.000 (0.020) loss 2.3642 (2.0160) ce_loss 1.3613 (0.9636) loss_zs_kd 1.9038 (2.0371) loss_oracle 0.6908 (0.7035) acc 56.2500 (66.1979) kd_loss 0.6575 (0.7006) lr 1.9298e-03 eta 0:29:52
epoch [8/50] batch [80/403] time 0.078 (0.099) data 0.000 (0.015) loss 2.2118 (2.0195) ce_loss 1.1172 (0.9656) loss_zs_kd 2.4543 (2.0557) loss_oracle 0.7052 (0.6996) acc 56.2500 (65.9766) kd_loss 0.7420 (0.7041) lr 1.9298e-03 eta 0:28:21
epoch [8/50] batch [100/403] time 0.080 (0.095) data 0.000 (0.012) loss 2.0263 (2.0160) ce_loss 0.9790 (0.9587) loss_zs_kd 2.2882 (2.0808) loss_oracle 0.7684 (0.7023) acc 71.8750 (66.2812) kd_loss 0.6631 (0.7062) lr 1.9298e-03 eta 0:27:22
epoch [8/50] batch [120/403] time 0.076 (0.093) data 0.000 (0.010) loss 1.9438 (2.0085) ce_loss 0.8896 (0.9519) loss_zs_kd 1.8289 (2.0823) loss_oracle 0.6110 (0.6987) acc 68.7500 (66.1458) kd_loss 0.7487 (0.7073) lr 1.9298e-03 eta 0:26:34
epoch [8/50] batch [140/403] time 0.085 (0.091) data 0.000 (0.009) loss 1.7332 (1.9967) ce_loss 0.6680 (0.9398) loss_zs_kd 2.1921 (2.0693) loss_oracle 0.6648 (0.6941) acc 78.1250 (66.5848) kd_loss 0.7328 (0.7098) lr 1.9298e-03 eta 0:26:08
epoch [8/50] batch [160/403] time 0.091 (0.091) data 0.000 (0.008) loss 1.8506 (1.9931) ce_loss 0.7354 (0.9347) loss_zs_kd 2.1369 (2.0747) loss_oracle 0.8090 (0.6930) acc 78.1250 (66.6406) kd_loss 0.7107 (0.7119) lr 1.9298e-03 eta 0:25:58
epoch [8/50] batch [180/403] time 0.088 (0.090) data 0.000 (0.007) loss 1.6960 (1.9905) ce_loss 0.6768 (0.9311) loss_zs_kd 1.9535 (2.0810) loss_oracle 0.6781 (0.6927) acc 81.2500 (66.7708) kd_loss 0.6802 (0.7130) lr 1.9298e-03 eta 0:25:48
epoch [8/50] batch [200/403] time 0.082 (0.090) data 0.000 (0.006) loss 1.9727 (1.9871) ce_loss 0.9194 (0.9273) loss_zs_kd 1.6905 (2.0931) loss_oracle 0.6396 (0.6936) acc 62.5000 (67.1250) kd_loss 0.7334 (0.7131) lr 1.9298e-03 eta 0:25:41
epoch [8/50] batch [220/403] time 0.092 (0.090) data 0.000 (0.006) loss 2.3343 (1.9919) ce_loss 1.2314 (0.9296) loss_zs_kd 2.1819 (2.0923) loss_oracle 0.6997 (0.6970) acc 56.2500 (67.1307) kd_loss 0.7529 (0.7138) lr 1.9298e-03 eta 0:25:32
epoch [8/50] batch [240/403] time 0.084 (0.089) data 0.000 (0.005) loss 1.8530 (1.9925) ce_loss 0.8687 (0.9288) loss_zs_kd 1.9210 (2.0955) loss_oracle 0.6169 (0.6960) acc 75.0000 (67.2786) kd_loss 0.6759 (0.7157) lr 1.9298e-03 eta 0:25:24
epoch [8/50] batch [260/403] time 0.078 (0.089) data 0.000 (0.005) loss 2.1922 (1.9955) ce_loss 1.1484 (0.9319) loss_zs_kd 2.4543 (2.0843) loss_oracle 0.7027 (0.6956) acc 62.5000 (67.1755) kd_loss 0.6924 (0.7157) lr 1.9298e-03 eta 0:25:16
epoch [8/50] batch [280/403] time 0.083 (0.089) data 0.000 (0.004) loss 1.8419 (1.9935) ce_loss 0.7422 (0.9285) loss_zs_kd 2.3738 (2.0862) loss_oracle 0.7869 (0.6972) acc 78.1250 (67.2991) kd_loss 0.7063 (0.7164) lr 1.9298e-03 eta 0:25:10
epoch [8/50] batch [300/403] time 0.087 (0.088) data 0.000 (0.004) loss 2.0438 (1.9954) ce_loss 0.9824 (0.9280) loss_zs_kd 1.9424 (2.1001) loss_oracle 0.7146 (0.6989) acc 68.7500 (67.1667) kd_loss 0.7041 (0.7179) lr 1.9298e-03 eta 0:25:05
epoch [8/50] batch [320/403] time 0.079 (0.088) data 0.000 (0.004) loss 2.1383 (1.9923) ce_loss 1.0234 (0.9246) loss_zs_kd 2.0063 (2.0866) loss_oracle 0.7358 (0.6961) acc 68.7500 (67.2168) kd_loss 0.7470 (0.7196) lr 1.9298e-03 eta 0:24:59
epoch [8/50] batch [340/403] time 0.082 (0.088) data 0.000 (0.004) loss 1.7091 (1.9918) ce_loss 0.6191 (0.9228) loss_zs_kd 2.2034 (2.0887) loss_oracle 0.6453 (0.6934) acc 78.1250 (67.2610) kd_loss 0.7674 (0.7223) lr 1.9298e-03 eta 0:24:49
epoch [8/50] batch [360/403] time 0.083 (0.087) data 0.000 (0.004) loss 1.8981 (1.9923) ce_loss 0.8408 (0.9235) loss_zs_kd 2.3256 (2.0901) loss_oracle 0.6269 (0.6895) acc 68.7500 (67.0747) kd_loss 0.7438 (0.7240) lr 1.9298e-03 eta 0:24:42
epoch [8/50] batch [380/403] time 0.091 (0.087) data 0.000 (0.003) loss 1.9537 (1.9907) ce_loss 0.8809 (0.9219) loss_zs_kd 2.1809 (2.0882) loss_oracle 0.5998 (0.6863) acc 68.7500 (67.0230) kd_loss 0.7730 (0.7257) lr 1.9298e-03 eta 0:24:39
epoch [8/50] batch [400/403] time 0.078 (0.087) data 0.000 (0.003) loss 2.0627 (1.9891) ce_loss 0.9336 (0.9204) loss_zs_kd 1.7743 (2.0915) loss_oracle 0.6687 (0.6830) acc 71.8750 (67.1016) kd_loss 0.7948 (0.7272) lr 1.9298e-03 eta 0:24:32
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,874
* accuracy: 70.0%
* error: 30.0%
* macro_f1: 56.5%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,281
* accuracy: 38.8%
* error: 61.2%
* macro_f1: 28.8%
******* Domain 4 best val acc:      70.6%, epoch: 6 *******
******* Domain 4 best val test acc: 39.8%, epoch: 6 *******
******* Domain 4 best test acc:     40.2%, epoch: 4 *******
epoch [9/50] batch [20/403] time 0.080 (0.176) data 0.000 (0.083) loss 1.7523 (1.9184) ce_loss 0.6582 (0.8369) loss_zs_kd 1.6413 (2.1874) loss_oracle 0.6382 (0.6588) acc 81.2500 (69.2188) kd_loss 0.7750 (0.7521) lr 1.9048e-03 eta 0:49:29
epoch [9/50] batch [40/403] time 0.081 (0.130) data 0.000 (0.042) loss 2.1963 (1.9448) ce_loss 1.1885 (0.8826) loss_zs_kd 2.1329 (2.0679) loss_oracle 0.5416 (0.6224) acc 65.6250 (68.9844) kd_loss 0.7371 (0.7510) lr 1.9048e-03 eta 0:36:41
epoch [9/50] batch [60/403] time 0.089 (0.115) data 0.000 (0.028) loss 1.8316 (1.9423) ce_loss 0.7744 (0.8834) loss_zs_kd 2.2066 (2.0608) loss_oracle 0.5775 (0.6125) acc 71.8750 (68.5938) kd_loss 0.7684 (0.7526) lr 1.9048e-03 eta 0:32:25
epoch [9/50] batch [80/403] time 0.084 (0.107) data 0.000 (0.021) loss 1.7722 (1.9368) ce_loss 0.7256 (0.8818) loss_zs_kd 2.2276 (2.0488) loss_oracle 0.5569 (0.6063) acc 75.0000 (68.4766) kd_loss 0.7682 (0.7519) lr 1.9048e-03 eta 0:30:04
epoch [9/50] batch [100/403] time 0.080 (0.101) data 0.000 (0.017) loss 1.9150 (1.9433) ce_loss 0.7783 (0.8889) loss_zs_kd 2.5711 (2.0639) loss_oracle 0.6844 (0.6052) acc 75.0000 (67.8750) kd_loss 0.7945 (0.7518) lr 1.9048e-03 eta 0:28:27
epoch [9/50] batch [120/403] time 0.084 (0.099) data 0.001 (0.014) loss 1.7957 (1.9571) ce_loss 0.7524 (0.9027) loss_zs_kd 1.9274 (2.0520) loss_oracle 0.5635 (0.6088) acc 75.0000 (67.5000) kd_loss 0.7615 (0.7500) lr 1.9048e-03 eta 0:27:43
epoch [9/50] batch [140/403] time 0.092 (0.097) data 0.000 (0.012) loss 1.8682 (1.9603) ce_loss 0.8574 (0.9037) loss_zs_kd 1.8984 (2.0621) loss_oracle 0.5898 (0.6146) acc 75.0000 (67.7232) kd_loss 0.7158 (0.7493) lr 1.9048e-03 eta 0:27:03
epoch [9/50] batch [160/403] time 0.077 (0.095) data 0.000 (0.011) loss 1.9197 (1.9673) ce_loss 0.9292 (0.9111) loss_zs_kd 2.2964 (2.0592) loss_oracle 0.6505 (0.6168) acc 65.6250 (67.5000) kd_loss 0.6653 (0.7478) lr 1.9048e-03 eta 0:26:32
epoch [9/50] batch [180/403] time 0.085 (0.094) data 0.000 (0.009) loss 1.8894 (1.9678) ce_loss 0.7944 (0.9090) loss_zs_kd 1.9027 (2.0872) loss_oracle 0.7494 (0.6229) acc 62.5000 (67.6562) kd_loss 0.7203 (0.7473) lr 1.9048e-03 eta 0:26:13
epoch [9/50] batch [200/403] time 0.078 (0.093) data 0.000 (0.009) loss 2.0529 (1.9750) ce_loss 0.9995 (0.9169) loss_zs_kd 1.8437 (2.0817) loss_oracle 0.6569 (0.6248) acc 53.1250 (67.1875) kd_loss 0.7249 (0.7458) lr 1.9048e-03 eta 0:25:52
epoch [9/50] batch [220/403] time 0.081 (0.092) data 0.000 (0.008) loss 1.8702 (1.9768) ce_loss 0.8330 (0.9184) loss_zs_kd 2.0387 (2.0825) loss_oracle 0.6763 (0.6278) acc 71.8750 (67.1875) kd_loss 0.6991 (0.7445) lr 1.9048e-03 eta 0:25:35
epoch [9/50] batch [240/403] time 0.085 (0.091) data 0.000 (0.007) loss 1.6796 (1.9794) ce_loss 0.6685 (0.9203) loss_zs_kd 1.6488 (2.0842) loss_oracle 0.5560 (0.6282) acc 75.0000 (67.1484) kd_loss 0.7331 (0.7450) lr 1.9048e-03 eta 0:25:25
epoch [9/50] batch [260/403] time 0.089 (0.091) data 0.000 (0.007) loss 2.3888 (1.9793) ce_loss 1.2266 (0.9186) loss_zs_kd 2.2304 (2.0891) loss_oracle 0.7223 (0.6298) acc 62.5000 (67.3317) kd_loss 0.8010 (0.7458) lr 1.9048e-03 eta 0:25:16
epoch [9/50] batch [280/403] time 0.082 (0.091) data 0.000 (0.006) loss 1.7447 (1.9830) ce_loss 0.6929 (0.9229) loss_zs_kd 2.1044 (2.0887) loss_oracle 0.7128 (0.6292) acc 71.8750 (67.2433) kd_loss 0.6954 (0.7455) lr 1.9048e-03 eta 0:25:08
epoch [9/50] batch [300/403] time 0.092 (0.090) data 0.000 (0.006) loss 2.0438 (1.9845) ce_loss 0.9136 (0.9242) loss_zs_kd 2.0221 (2.0925) loss_oracle 0.6921 (0.6293) acc 59.3750 (67.0000) kd_loss 0.7842 (0.7457) lr 1.9048e-03 eta 0:25:00
epoch [9/50] batch [320/403] time 0.093 (0.090) data 0.000 (0.005) loss 1.8882 (1.9835) ce_loss 0.8364 (0.9232) loss_zs_kd 1.8919 (2.0848) loss_oracle 0.5977 (0.6291) acc 71.8750 (66.9434) kd_loss 0.7529 (0.7457) lr 1.9048e-03 eta 0:24:48
epoch [9/50] batch [340/403] time 0.089 (0.089) data 0.000 (0.005) loss 1.8549 (1.9802) ce_loss 0.8159 (0.9202) loss_zs_kd 2.2243 (2.0807) loss_oracle 0.5896 (0.6280) acc 71.8750 (67.1048) kd_loss 0.7442 (0.7460) lr 1.9048e-03 eta 0:24:40
epoch [9/50] batch [360/403] time 0.089 (0.089) data 0.000 (0.005) loss 1.7895 (1.9784) ce_loss 0.7207 (0.9188) loss_zs_kd 1.6698 (2.0849) loss_oracle 0.5813 (0.6260) acc 75.0000 (67.1701) kd_loss 0.7781 (0.7466) lr 1.9048e-03 eta 0:24:37
epoch [9/50] batch [380/403] time 0.089 (0.089) data 0.000 (0.005) loss 1.8969 (1.9813) ce_loss 0.8140 (0.9218) loss_zs_kd 1.9304 (2.0883) loss_oracle 0.5923 (0.6243) acc 78.1250 (67.0230) kd_loss 0.7868 (0.7474) lr 1.9048e-03 eta 0:24:32
epoch [9/50] batch [400/403] time 0.081 (0.089) data 0.000 (0.004) loss 1.8724 (1.9808) ce_loss 0.8857 (0.9215) loss_zs_kd 2.1887 (2.0812) loss_oracle 0.5747 (0.6233) acc 71.8750 (67.0391) kd_loss 0.6993 (0.7476) lr 1.9048e-03 eta 0:24:26
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,856
* accuracy: 69.7%
* error: 30.3%
* macro_f1: 53.9%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,221
* accuracy: 37.8%
* error: 62.2%
* macro_f1: 26.8%
******* Domain 4 best val acc:      70.6%, epoch: 6 *******
******* Domain 4 best val test acc: 39.8%, epoch: 6 *******
******* Domain 4 best test acc:     40.2%, epoch: 4 *******
epoch [10/50] batch [20/403] time 0.079 (0.169) data 0.000 (0.085) loss 1.9867 (1.9855) ce_loss 0.9390 (0.9441) loss_zs_kd 2.2493 (2.1880) loss_oracle 0.5849 (0.5999) acc 68.7500 (66.8750) kd_loss 0.7553 (0.7415) lr 1.8763e-03 eta 0:46:21
epoch [10/50] batch [40/403] time 0.088 (0.124) data 0.000 (0.043) loss 2.0192 (1.9622) ce_loss 0.9077 (0.9155) loss_zs_kd 2.2112 (2.1097) loss_oracle 0.6527 (0.5980) acc 59.3750 (67.1875) kd_loss 0.7852 (0.7478) lr 1.8763e-03 eta 0:34:00
epoch [10/50] batch [60/403] time 0.078 (0.110) data 0.000 (0.029) loss 1.7439 (1.9512) ce_loss 0.6260 (0.8997) loss_zs_kd 2.4876 (2.0963) loss_oracle 0.6973 (0.5987) acc 75.0000 (67.6562) kd_loss 0.7693 (0.7522) lr 1.8763e-03 eta 0:30:13
epoch [10/50] batch [80/403] time 0.083 (0.103) data 0.000 (0.021) loss 2.2499 (1.9752) ce_loss 1.1797 (0.9196) loss_zs_kd 1.9366 (2.1008) loss_oracle 0.6061 (0.5991) acc 59.3750 (66.7969) kd_loss 0.7672 (0.7561) lr 1.8763e-03 eta 0:28:11
epoch [10/50] batch [100/403] time 0.084 (0.100) data 0.000 (0.017) loss 1.8732 (1.9617) ce_loss 0.8203 (0.9106) loss_zs_kd 2.2012 (2.1058) loss_oracle 0.6574 (0.5940) acc 68.7500 (67.1875) kd_loss 0.7242 (0.7541) lr 1.8763e-03 eta 0:27:14
epoch [10/50] batch [120/403] time 0.086 (0.097) data 0.000 (0.014) loss 1.8946 (1.9760) ce_loss 0.8198 (0.9248) loss_zs_kd 2.4838 (2.1114) loss_oracle 0.6453 (0.5919) acc 65.6250 (66.7708) kd_loss 0.7521 (0.7553) lr 1.8763e-03 eta 0:26:33
epoch [10/50] batch [140/403] time 0.090 (0.095) data 0.000 (0.012) loss 1.8835 (1.9856) ce_loss 0.8828 (0.9314) loss_zs_kd 2.0170 (2.1169) loss_oracle 0.5485 (0.5918) acc 59.3750 (66.3839) kd_loss 0.7265 (0.7583) lr 1.8763e-03 eta 0:25:52
epoch [10/50] batch [160/403] time 0.085 (0.093) data 0.000 (0.011) loss 2.0459 (1.9849) ce_loss 1.0303 (0.9313) loss_zs_kd 2.7645 (2.1261) loss_oracle 0.5605 (0.5910) acc 62.5000 (66.5820) kd_loss 0.7354 (0.7580) lr 1.8763e-03 eta 0:25:18
epoch [10/50] batch [180/403] time 0.083 (0.092) data 0.000 (0.010) loss 2.4149 (1.9877) ce_loss 1.2959 (0.9347) loss_zs_kd 2.6160 (2.1275) loss_oracle 0.6343 (0.5901) acc 46.8750 (66.4757) kd_loss 0.8019 (0.7580) lr 1.8763e-03 eta 0:25:00
epoch [10/50] batch [200/403] time 0.098 (0.091) data 0.000 (0.009) loss 1.7882 (1.9819) ce_loss 0.7012 (0.9280) loss_zs_kd 1.7220 (2.1215) loss_oracle 0.6410 (0.5907) acc 71.8750 (66.6094) kd_loss 0.7666 (0.7585) lr 1.8763e-03 eta 0:24:42
epoch [10/50] batch [220/403] time 0.080 (0.090) data 0.000 (0.008) loss 2.0176 (1.9826) ce_loss 0.9814 (0.9278) loss_zs_kd 1.5705 (2.1153) loss_oracle 0.6220 (0.5906) acc 65.6250 (66.6335) kd_loss 0.7252 (0.7595) lr 1.8763e-03 eta 0:24:28
epoch [10/50] batch [240/403] time 0.090 (0.090) data 0.000 (0.007) loss 2.2504 (1.9821) ce_loss 1.2002 (0.9271) loss_zs_kd 2.3962 (2.1018) loss_oracle 0.6505 (0.5916) acc 65.6250 (66.6276) kd_loss 0.7250 (0.7592) lr 1.8763e-03 eta 0:24:23
epoch [10/50] batch [260/403] time 0.090 (0.089) data 0.000 (0.007) loss 1.8660 (1.9790) ce_loss 0.7900 (0.9221) loss_zs_kd 2.1022 (2.0991) loss_oracle 0.6026 (0.5928) acc 75.0000 (66.8750) kd_loss 0.7747 (0.7604) lr 1.8763e-03 eta 0:24:10
epoch [10/50] batch [280/403] time 0.094 (0.089) data 0.000 (0.006) loss 2.1441 (1.9795) ce_loss 1.0498 (0.9217) loss_zs_kd 2.6775 (2.1035) loss_oracle 0.6355 (0.5933) acc 65.6250 (66.8973) kd_loss 0.7765 (0.7611) lr 1.8763e-03 eta 0:24:05
epoch [10/50] batch [300/403] time 0.087 (0.089) data 0.000 (0.006) loss 1.9489 (1.9816) ce_loss 0.9292 (0.9241) loss_zs_kd 1.9605 (2.1010) loss_oracle 0.5905 (0.5938) acc 62.5000 (66.8854) kd_loss 0.7245 (0.7607) lr 1.8763e-03 eta 0:24:01
epoch [10/50] batch [320/403] time 0.087 (0.089) data 0.000 (0.006) loss 1.6975 (1.9839) ce_loss 0.6509 (0.9262) loss_zs_kd 2.0690 (2.1021) loss_oracle 0.5552 (0.5942) acc 75.0000 (66.9238) kd_loss 0.7690 (0.7605) lr 1.8763e-03 eta 0:23:54
epoch [10/50] batch [340/403] time 0.079 (0.088) data 0.000 (0.005) loss 2.1199 (1.9857) ce_loss 1.0654 (0.9275) loss_zs_kd 1.8011 (2.0948) loss_oracle 0.6348 (0.5955) acc 62.5000 (66.7371) kd_loss 0.7371 (0.7604) lr 1.8763e-03 eta 0:23:49
epoch [10/50] batch [360/403] time 0.086 (0.088) data 0.000 (0.005) loss 2.3476 (1.9805) ce_loss 1.2559 (0.9227) loss_zs_kd 2.7265 (2.0907) loss_oracle 0.6360 (0.5957) acc 53.1250 (66.9097) kd_loss 0.7737 (0.7599) lr 1.8763e-03 eta 0:23:39
epoch [10/50] batch [380/403] time 0.088 (0.088) data 0.000 (0.005) loss 1.9320 (1.9785) ce_loss 0.9009 (0.9216) loss_zs_kd 2.2838 (2.0868) loss_oracle 0.5813 (0.5957) acc 71.8750 (67.0066) kd_loss 0.7404 (0.7591) lr 1.8763e-03 eta 0:23:35
epoch [10/50] batch [400/403] time 0.084 (0.087) data 0.000 (0.005) loss 1.9890 (1.9771) ce_loss 1.0010 (0.9206) loss_zs_kd 2.0910 (2.0848) loss_oracle 0.5726 (0.5960) acc 59.3750 (66.9844) kd_loss 0.7018 (0.7585) lr 1.8763e-03 eta 0:23:29
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,943
* accuracy: 71.2%
* error: 28.8%
* macro_f1: 58.0%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,354
* accuracy: 40.0%
* error: 60.0%
* macro_f1: 31.9%
******* Domain 4 best val acc:      71.2%, epoch: 10 *******
******* Domain 4 best val test acc: 40.0%, epoch: 10 *******
******* Domain 4 best test acc:     40.2%, epoch: 4 *******
epoch [11/50] batch [20/403] time 0.074 (0.172) data 0.000 (0.083) loss 2.1041 (1.9714) ce_loss 1.0400 (0.9227) loss_zs_kd 2.1703 (2.1290) loss_oracle 0.5475 (0.6132) acc 68.7500 (68.1250) kd_loss 0.7903 (0.7421) lr 1.8443e-03 eta 0:46:06
epoch [11/50] batch [40/403] time 0.077 (0.126) data 0.000 (0.041) loss 1.8645 (1.9759) ce_loss 0.8154 (0.9360) loss_zs_kd 2.0974 (2.1562) loss_oracle 0.5609 (0.5997) acc 71.8750 (67.4219) kd_loss 0.7687 (0.7400) lr 1.8443e-03 eta 0:33:46
epoch [11/50] batch [60/403] time 0.089 (0.111) data 0.001 (0.028) loss 1.9318 (1.9520) ce_loss 0.8789 (0.9168) loss_zs_kd 1.9840 (2.0943) loss_oracle 0.6020 (0.5971) acc 71.8750 (67.1354) kd_loss 0.7519 (0.7367) lr 1.8443e-03 eta 0:29:40
epoch [11/50] batch [80/403] time 0.089 (0.104) data 0.000 (0.021) loss 2.0296 (1.9325) ce_loss 0.9736 (0.9004) loss_zs_kd 2.2774 (2.0605) loss_oracle 0.6287 (0.5974) acc 68.7500 (67.8125) kd_loss 0.7416 (0.7334) lr 1.8443e-03 eta 0:27:55
epoch [11/50] batch [100/403] time 0.097 (0.101) data 0.000 (0.017) loss 1.9250 (1.9488) ce_loss 0.8818 (0.9132) loss_zs_kd 1.6719 (2.0873) loss_oracle 0.6558 (0.6032) acc 71.8750 (67.0312) kd_loss 0.7153 (0.7339) lr 1.8443e-03 eta 0:27:00
epoch [11/50] batch [120/403] time 0.085 (0.098) data 0.000 (0.014) loss 1.9454 (1.9455) ce_loss 0.9072 (0.9097) loss_zs_kd 2.2632 (2.0645) loss_oracle 0.6473 (0.6029) acc 75.0000 (67.2656) kd_loss 0.7145 (0.7343) lr 1.8443e-03 eta 0:26:11
epoch [11/50] batch [140/403] time 0.079 (0.096) data 0.000 (0.012) loss 1.7215 (1.9391) ce_loss 0.6538 (0.9009) loss_zs_kd 2.5902 (2.0682) loss_oracle 0.6000 (0.6008) acc 78.1250 (67.4554) kd_loss 0.7677 (0.7378) lr 1.8443e-03 eta 0:25:38
epoch [11/50] batch [160/403] time 0.086 (0.095) data 0.000 (0.011) loss 1.7855 (1.9378) ce_loss 0.7480 (0.8973) loss_zs_kd 3.0002 (2.0858) loss_oracle 0.5690 (0.5987) acc 75.0000 (67.5195) kd_loss 0.7529 (0.7411) lr 1.8443e-03 eta 0:25:09
epoch [11/50] batch [180/403] time 0.087 (0.094) data 0.000 (0.009) loss 1.9485 (1.9392) ce_loss 0.8960 (0.8984) loss_zs_kd 2.0258 (2.0890) loss_oracle 0.5962 (0.5957) acc 68.7500 (67.5000) kd_loss 0.7544 (0.7429) lr 1.8443e-03 eta 0:24:52
epoch [11/50] batch [200/403] time 0.073 (0.092) data 0.000 (0.009) loss 1.9154 (1.9359) ce_loss 0.8262 (0.8942) loss_zs_kd 2.6443 (2.0874) loss_oracle 0.6529 (0.5948) acc 75.0000 (67.8438) kd_loss 0.7628 (0.7442) lr 1.8443e-03 eta 0:24:32
epoch [11/50] batch [220/403] time 0.088 (0.092) data 0.000 (0.008) loss 1.9919 (1.9463) ce_loss 0.9658 (0.9035) loss_zs_kd 1.7435 (2.0944) loss_oracle 0.6392 (0.5958) acc 65.6250 (67.3722) kd_loss 0.7065 (0.7450) lr 1.8443e-03 eta 0:24:17
epoch [11/50] batch [240/403] time 0.091 (0.091) data 0.000 (0.007) loss 2.0745 (1.9507) ce_loss 1.0518 (0.9058) loss_zs_kd 2.4120 (2.0899) loss_oracle 0.6322 (0.5973) acc 62.5000 (67.4609) kd_loss 0.7067 (0.7463) lr 1.8443e-03 eta 0:24:09
epoch [11/50] batch [260/403] time 0.087 (0.091) data 0.000 (0.007) loss 1.8789 (1.9498) ce_loss 0.8423 (0.9043) loss_zs_kd 2.3062 (2.0874) loss_oracle 0.6474 (0.5977) acc 68.7500 (67.4880) kd_loss 0.7130 (0.7466) lr 1.8443e-03 eta 0:23:59
epoch [11/50] batch [280/403] time 0.084 (0.090) data 0.000 (0.006) loss 1.6908 (1.9520) ce_loss 0.6064 (0.9045) loss_zs_kd 2.4884 (2.0998) loss_oracle 0.6838 (0.6000) acc 84.3750 (67.4330) kd_loss 0.7424 (0.7475) lr 1.8443e-03 eta 0:23:52
epoch [11/50] batch [300/403] time 0.085 (0.090) data 0.000 (0.006) loss 1.7282 (1.9556) ce_loss 0.6914 (0.9066) loss_zs_kd 1.4363 (2.1046) loss_oracle 0.6448 (0.6010) acc 75.0000 (67.4062) kd_loss 0.7144 (0.7485) lr 1.8443e-03 eta 0:23:46
epoch [11/50] batch [320/403] time 0.085 (0.090) data 0.000 (0.005) loss 2.3311 (1.9561) ce_loss 1.2461 (0.9065) loss_zs_kd 2.2517 (2.0973) loss_oracle 0.6247 (0.6016) acc 56.2500 (67.5879) kd_loss 0.7727 (0.7488) lr 1.8443e-03 eta 0:23:39
epoch [11/50] batch [340/403] time 0.082 (0.089) data 0.000 (0.005) loss 2.0235 (1.9593) ce_loss 0.9336 (0.9100) loss_zs_kd 2.5011 (2.0999) loss_oracle 0.6625 (0.6004) acc 68.7500 (67.5460) kd_loss 0.7587 (0.7491) lr 1.8443e-03 eta 0:23:31
epoch [11/50] batch [360/403] time 0.075 (0.089) data 0.000 (0.005) loss 2.0346 (1.9579) ce_loss 0.8892 (0.9081) loss_zs_kd 2.2376 (2.1024) loss_oracle 0.6595 (0.6007) acc 71.8750 (67.6042) kd_loss 0.8157 (0.7495) lr 1.8443e-03 eta 0:23:25
epoch [11/50] batch [380/403] time 0.075 (0.089) data 0.000 (0.005) loss 2.1748 (1.9564) ce_loss 1.1162 (0.9075) loss_zs_kd 2.3098 (2.1019) loss_oracle 0.5365 (0.6003) acc 65.6250 (67.6562) kd_loss 0.7903 (0.7488) lr 1.8443e-03 eta 0:23:14
epoch [11/50] batch [400/403] time 0.068 (0.088) data 0.000 (0.004) loss 1.8709 (1.9574) ce_loss 0.7983 (0.9082) loss_zs_kd 2.2816 (2.1073) loss_oracle 0.6028 (0.6003) acc 78.1250 (67.6562) kd_loss 0.7711 (0.7491) lr 1.8443e-03 eta 0:23:03
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,942
* accuracy: 71.2%
* error: 28.8%
* macro_f1: 56.8%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,461
* accuracy: 41.8%
* error: 58.2%
* macro_f1: 32.0%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      71.2%, epoch: 10 *******
******* Domain 4 best val test acc: 40.0%, epoch: 10 *******
******* Domain 4 best test acc:     41.8%, epoch: 11 *******
epoch [12/50] batch [20/403] time 0.082 (0.157) data 0.000 (0.086) loss 2.0080 (1.9458) ce_loss 1.0020 (0.8960) loss_zs_kd 2.4055 (2.1258) loss_oracle 0.5438 (0.5859) acc 62.5000 (67.1875) kd_loss 0.7341 (0.7568) lr 1.8090e-03 eta 0:41:07
epoch [12/50] batch [40/403] time 0.084 (0.121) data 0.000 (0.043) loss 2.5070 (1.9901) ce_loss 1.4707 (0.9248) loss_zs_kd 2.3758 (2.1348) loss_oracle 0.5875 (0.6082) acc 40.6250 (67.4219) kd_loss 0.7425 (0.7612) lr 1.8090e-03 eta 0:31:40
epoch [12/50] batch [60/403] time 0.084 (0.108) data 0.000 (0.029) loss 1.9685 (1.9844) ce_loss 0.8647 (0.9109) loss_zs_kd 2.2601 (2.1535) loss_oracle 0.6725 (0.6181) acc 68.7500 (67.8125) kd_loss 0.7675 (0.7644) lr 1.8090e-03 eta 0:28:17
epoch [12/50] batch [80/403] time 0.086 (0.101) data 0.000 (0.022) loss 2.3082 (1.9831) ce_loss 1.2402 (0.9090) loss_zs_kd 2.1587 (2.1537) loss_oracle 0.6083 (0.6146) acc 65.6250 (67.5781) kd_loss 0.7638 (0.7667) lr 1.8090e-03 eta 0:26:26
epoch [12/50] batch [100/403] time 0.085 (0.098) data 0.000 (0.017) loss 1.8201 (1.9744) ce_loss 0.7617 (0.9036) loss_zs_kd 2.0929 (2.1280) loss_oracle 0.5614 (0.6112) acc 75.0000 (67.4688) kd_loss 0.7777 (0.7652) lr 1.8090e-03 eta 0:25:35
epoch [12/50] batch [120/403] time 0.082 (0.096) data 0.000 (0.015) loss 2.1947 (1.9735) ce_loss 1.1250 (0.9009) loss_zs_kd 2.6267 (2.1492) loss_oracle 0.6177 (0.6130) acc 65.6250 (67.6823) kd_loss 0.7608 (0.7660) lr 1.8090e-03 eta 0:25:03
epoch [12/50] batch [140/403] time 0.081 (0.094) data 0.000 (0.013) loss 2.0140 (1.9739) ce_loss 0.9634 (0.9032) loss_zs_kd 2.1136 (2.1640) loss_oracle 0.5981 (0.6123) acc 75.0000 (67.7679) kd_loss 0.7515 (0.7646) lr 1.8090e-03 eta 0:24:26
epoch [12/50] batch [160/403] time 0.091 (0.093) data 0.000 (0.011) loss 2.0241 (1.9797) ce_loss 0.8950 (0.9099) loss_zs_kd 2.1585 (2.1589) loss_oracle 0.6385 (0.6106) acc 75.0000 (67.8320) kd_loss 0.8099 (0.7645) lr 1.8090e-03 eta 0:24:09
epoch [12/50] batch [180/403] time 0.078 (0.092) data 0.000 (0.010) loss 2.2040 (1.9846) ce_loss 1.0928 (0.9160) loss_zs_kd 2.8000 (2.1467) loss_oracle 0.6286 (0.6089) acc 59.3750 (67.6736) kd_loss 0.7970 (0.7641) lr 1.8090e-03 eta 0:23:51
epoch [12/50] batch [200/403] time 0.094 (0.091) data 0.000 (0.009) loss 1.9302 (1.9809) ce_loss 0.9365 (0.9149) loss_zs_kd 2.0999 (2.1466) loss_oracle 0.5580 (0.6077) acc 59.3750 (67.5312) kd_loss 0.7147 (0.7622) lr 1.8090e-03 eta 0:23:36
epoch [12/50] batch [220/403] time 0.087 (0.091) data 0.000 (0.008) loss 1.8233 (1.9695) ce_loss 0.7759 (0.9055) loss_zs_kd 2.1748 (2.1503) loss_oracle 0.6178 (0.6067) acc 78.1250 (67.8551) kd_loss 0.7385 (0.7607) lr 1.8090e-03 eta 0:23:29
epoch [12/50] batch [240/403] time 0.081 (0.090) data 0.000 (0.007) loss 1.9409 (1.9702) ce_loss 0.8882 (0.9075) loss_zs_kd 2.3377 (2.1476) loss_oracle 0.5759 (0.6059) acc 62.5000 (67.6302) kd_loss 0.7647 (0.7598) lr 1.8090e-03 eta 0:23:18
epoch [12/50] batch [260/403] time 0.082 (0.090) data 0.000 (0.007) loss 1.9886 (1.9698) ce_loss 0.9619 (0.9091) loss_zs_kd 1.6668 (2.1423) loss_oracle 0.5676 (0.6053) acc 71.8750 (67.6683) kd_loss 0.7430 (0.7580) lr 1.8090e-03 eta 0:23:04
epoch [12/50] batch [280/403] time 0.100 (0.089) data 0.000 (0.006) loss 1.7946 (1.9654) ce_loss 0.7402 (0.9063) loss_zs_kd 2.2428 (2.1357) loss_oracle 0.6350 (0.6049) acc 71.8750 (67.7567) kd_loss 0.7369 (0.7567) lr 1.8090e-03 eta 0:23:01
epoch [12/50] batch [300/403] time 0.086 (0.089) data 0.000 (0.006) loss 1.9953 (1.9642) ce_loss 0.9053 (0.9056) loss_zs_kd 2.0868 (2.1287) loss_oracle 0.6385 (0.6043) acc 62.5000 (67.7500) kd_loss 0.7708 (0.7564) lr 1.8090e-03 eta 0:22:49
epoch [12/50] batch [320/403] time 0.086 (0.089) data 0.000 (0.006) loss 1.7643 (1.9626) ce_loss 0.8130 (0.9042) loss_zs_kd 2.7914 (2.1402) loss_oracle 0.4808 (0.6025) acc 71.8750 (67.8027) kd_loss 0.7110 (0.7572) lr 1.8090e-03 eta 0:22:42
epoch [12/50] batch [340/403] time 0.079 (0.088) data 0.000 (0.005) loss 2.0207 (1.9649) ce_loss 0.9443 (0.9069) loss_zs_kd 2.5091 (2.1491) loss_oracle 0.6487 (0.6016) acc 65.6250 (67.8309) kd_loss 0.7521 (0.7572) lr 1.8090e-03 eta 0:22:34
epoch [12/50] batch [360/403] time 0.085 (0.088) data 0.000 (0.005) loss 2.0250 (1.9652) ce_loss 0.8901 (0.9066) loss_zs_kd 1.8396 (2.1632) loss_oracle 0.7231 (0.6024) acc 68.7500 (67.9080) kd_loss 0.7733 (0.7575) lr 1.8090e-03 eta 0:22:31
epoch [12/50] batch [380/403] time 0.083 (0.088) data 0.000 (0.005) loss 1.9729 (1.9648) ce_loss 0.9233 (0.9053) loss_zs_kd 2.7894 (2.1656) loss_oracle 0.5609 (0.6021) acc 68.7500 (67.9852) kd_loss 0.7691 (0.7584) lr 1.8090e-03 eta 0:22:27
epoch [12/50] batch [400/403] time 0.071 (0.087) data 0.000 (0.005) loss 2.4175 (1.9645) ce_loss 1.2842 (0.9053) loss_zs_kd 1.6958 (2.1631) loss_oracle 0.5915 (0.6012) acc 59.3750 (67.9141) kd_loss 0.8375 (0.7586) lr 1.8090e-03 eta 0:22:18
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,932
* accuracy: 71.0%
* error: 29.0%
* macro_f1: 58.4%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,502
* accuracy: 42.5%
* error: 57.5%
* macro_f1: 31.2%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      71.2%, epoch: 10 *******
******* Domain 4 best val test acc: 40.0%, epoch: 10 *******
******* Domain 4 best test acc:     42.5%, epoch: 12 *******
epoch [13/50] batch [20/403] time 0.090 (0.185) data 0.000 (0.095) loss 1.9088 (1.9751) ce_loss 0.8203 (0.9057) loss_zs_kd 2.0233 (2.0742) loss_oracle 0.6326 (0.5932) acc 65.6250 (67.9688) kd_loss 0.7722 (0.7728) lr 1.7705e-03 eta 0:47:04
epoch [13/50] batch [40/403] time 0.079 (0.134) data 0.000 (0.047) loss 1.9274 (1.9735) ce_loss 0.8550 (0.9085) loss_zs_kd 2.0587 (2.1299) loss_oracle 0.5758 (0.5915) acc 71.8750 (68.5938) kd_loss 0.7845 (0.7693) lr 1.7705e-03 eta 0:34:04
epoch [13/50] batch [60/403] time 0.084 (0.117) data 0.000 (0.032) loss 2.5446 (1.9843) ce_loss 1.4248 (0.9127) loss_zs_kd 2.2489 (2.0786) loss_oracle 0.6496 (0.5955) acc 53.1250 (68.2292) kd_loss 0.7950 (0.7739) lr 1.7705e-03 eta 0:29:49
epoch [13/50] batch [80/403] time 0.081 (0.111) data 0.000 (0.024) loss 2.0330 (1.9808) ce_loss 0.9443 (0.9076) loss_zs_kd 2.1044 (2.0770) loss_oracle 0.5807 (0.6047) acc 62.5000 (67.8516) kd_loss 0.7983 (0.7708) lr 1.7705e-03 eta 0:28:14
epoch [13/50] batch [100/403] time 0.093 (0.107) data 0.000 (0.019) loss 2.0767 (1.9945) ce_loss 1.0439 (0.9198) loss_zs_kd 1.7795 (2.0927) loss_oracle 0.6544 (0.6034) acc 62.5000 (67.7188) kd_loss 0.7055 (0.7730) lr 1.7705e-03 eta 0:27:00
epoch [13/50] batch [120/403] time 0.075 (0.103) data 0.000 (0.016) loss 2.1082 (1.9954) ce_loss 1.0459 (0.9223) loss_zs_kd 2.1648 (2.1159) loss_oracle 0.5811 (0.6039) acc 50.0000 (67.2396) kd_loss 0.7718 (0.7712) lr 1.7705e-03 eta 0:25:57
epoch [13/50] batch [140/403] time 0.082 (0.100) data 0.000 (0.014) loss 1.8809 (1.9861) ce_loss 0.7876 (0.9149) loss_zs_kd 1.9435 (2.1229) loss_oracle 0.6113 (0.6042) acc 71.8750 (67.5000) kd_loss 0.7876 (0.7691) lr 1.7705e-03 eta 0:25:12
epoch [13/50] batch [160/403] time 0.078 (0.098) data 0.000 (0.012) loss 1.8607 (1.9832) ce_loss 0.7588 (0.9118) loss_zs_kd 2.1919 (2.1152) loss_oracle 0.5958 (0.6036) acc 71.8750 (67.6562) kd_loss 0.8040 (0.7696) lr 1.7705e-03 eta 0:24:39
epoch [13/50] batch [180/403] time 0.084 (0.096) data 0.000 (0.011) loss 1.7491 (1.9787) ce_loss 0.6855 (0.9079) loss_zs_kd 2.0661 (2.1100) loss_oracle 0.5828 (0.6063) acc 71.8750 (67.8299) kd_loss 0.7721 (0.7677) lr 1.7705e-03 eta 0:24:11
epoch [13/50] batch [200/403] time 0.086 (0.095) data 0.000 (0.010) loss 1.9499 (1.9817) ce_loss 0.9077 (0.9118) loss_zs_kd 2.1306 (2.0906) loss_oracle 0.5341 (0.6059) acc 68.7500 (67.5312) kd_loss 0.7751 (0.7669) lr 1.7705e-03 eta 0:23:54
epoch [13/50] batch [220/403] time 0.078 (0.094) data 0.000 (0.009) loss 2.2437 (1.9832) ce_loss 1.1641 (0.9133) loss_zs_kd 1.8947 (2.0960) loss_oracle 0.5636 (0.6043) acc 59.3750 (67.3153) kd_loss 0.7979 (0.7678) lr 1.7705e-03 eta 0:23:35
epoch [13/50] batch [240/403] time 0.087 (0.093) data 0.000 (0.008) loss 1.7434 (1.9854) ce_loss 0.6763 (0.9152) loss_zs_kd 1.9708 (2.1001) loss_oracle 0.5458 (0.6046) acc 71.8750 (67.2917) kd_loss 0.7943 (0.7679) lr 1.7705e-03 eta 0:23:23
epoch [13/50] batch [260/403] time 0.083 (0.093) data 0.000 (0.008) loss 1.7729 (1.9802) ce_loss 0.6689 (0.9102) loss_zs_kd 1.8890 (2.0905) loss_oracle 0.5715 (0.6031) acc 78.1250 (67.4399) kd_loss 0.8181 (0.7684) lr 1.7705e-03 eta 0:23:13
epoch [13/50] batch [280/403] time 0.070 (0.092) data 0.000 (0.007) loss 1.9928 (1.9793) ce_loss 0.9253 (0.9094) loss_zs_kd 2.4178 (2.0926) loss_oracle 0.6214 (0.6028) acc 62.5000 (67.3661) kd_loss 0.7568 (0.7685) lr 1.7705e-03 eta 0:22:56
epoch [13/50] batch [300/403] time 0.088 (0.091) data 0.000 (0.007) loss 1.8671 (1.9792) ce_loss 0.6899 (0.9078) loss_zs_kd 1.6519 (2.0930) loss_oracle 0.6938 (0.6038) acc 75.0000 (67.5000) kd_loss 0.8303 (0.7695) lr 1.7705e-03 eta 0:22:45
epoch [13/50] batch [320/403] time 0.083 (0.090) data 0.000 (0.006) loss 1.8725 (1.9846) ce_loss 0.7856 (0.9123) loss_zs_kd 1.8389 (2.0918) loss_oracle 0.6570 (0.6049) acc 62.5000 (67.3242) kd_loss 0.7583 (0.7698) lr 1.7705e-03 eta 0:22:36
epoch [13/50] batch [340/403] time 0.081 (0.090) data 0.000 (0.006) loss 1.6624 (1.9780) ce_loss 0.6094 (0.9051) loss_zs_kd 2.2765 (2.1014) loss_oracle 0.6061 (0.6056) acc 78.1250 (67.6930) kd_loss 0.7499 (0.7700) lr 1.7705e-03 eta 0:22:25
epoch [13/50] batch [360/403] time 0.074 (0.089) data 0.000 (0.005) loss 2.1027 (1.9772) ce_loss 1.0635 (0.9037) loss_zs_kd 1.9330 (2.1086) loss_oracle 0.6304 (0.6073) acc 62.5000 (67.7951) kd_loss 0.7241 (0.7698) lr 1.7705e-03 eta 0:22:14
epoch [13/50] batch [380/403] time 0.086 (0.089) data 0.001 (0.005) loss 1.9932 (1.9754) ce_loss 0.9194 (0.9022) loss_zs_kd 2.1472 (2.1107) loss_oracle 0.5469 (0.6077) acc 71.8750 (67.8701) kd_loss 0.8003 (0.7694) lr 1.7705e-03 eta 0:22:06
epoch [13/50] batch [400/403] time 0.078 (0.088) data 0.000 (0.005) loss 2.0621 (1.9752) ce_loss 0.9810 (0.9022) loss_zs_kd 2.1418 (2.1065) loss_oracle 0.6118 (0.6066) acc 68.7500 (67.8984) kd_loss 0.7752 (0.7697) lr 1.7705e-03 eta 0:21:55
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,993
* accuracy: 72.1%
* error: 27.9%
* macro_f1: 59.5%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,564
* accuracy: 43.6%
* error: 56.4%
* macro_f1: 33.8%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      72.1%, epoch: 13 *******
******* Domain 4 best val test acc: 43.6%, epoch: 13 *******
******* Domain 4 best test acc:     43.6%, epoch: 13 *******
epoch [14/50] batch [20/403] time 0.081 (0.167) data 0.000 (0.084) loss 1.9233 (1.9605) ce_loss 0.8569 (0.9113) loss_zs_kd 1.5159 (2.1307) loss_oracle 0.5476 (0.5744) acc 78.1250 (67.0312) kd_loss 0.7926 (0.7621) lr 1.7290e-03 eta 0:41:26
epoch [14/50] batch [40/403] time 0.081 (0.124) data 0.000 (0.042) loss 1.5913 (1.9806) ce_loss 0.5356 (0.9362) loss_zs_kd 2.1852 (2.1157) loss_oracle 0.5797 (0.5717) acc 87.5000 (65.8594) kd_loss 0.7658 (0.7585) lr 1.7290e-03 eta 0:30:45
epoch [14/50] batch [60/403] time 0.086 (0.111) data 0.000 (0.028) loss 2.1436 (1.9789) ce_loss 0.9907 (0.9344) loss_zs_kd 2.1790 (2.0997) loss_oracle 0.6252 (0.5757) acc 71.8750 (66.6146) kd_loss 0.8403 (0.7566) lr 1.7290e-03 eta 0:27:33
epoch [14/50] batch [80/403] time 0.083 (0.105) data 0.000 (0.021) loss 1.8726 (1.9921) ce_loss 0.8057 (0.9431) loss_zs_kd 2.3838 (2.1240) loss_oracle 0.6522 (0.5827) acc 68.7500 (66.0938) kd_loss 0.7409 (0.7576) lr 1.7290e-03 eta 0:25:58
epoch [14/50] batch [100/403] time 0.086 (0.101) data 0.000 (0.017) loss 2.0469 (1.9853) ce_loss 1.0186 (0.9352) loss_zs_kd 2.1192 (2.1368) loss_oracle 0.5857 (0.5874) acc 62.5000 (66.9062) kd_loss 0.7355 (0.7564) lr 1.7290e-03 eta 0:24:53
epoch [14/50] batch [120/403] time 0.072 (0.098) data 0.000 (0.014) loss 2.0455 (1.9817) ce_loss 0.9619 (0.9302) loss_zs_kd 2.0922 (2.1530) loss_oracle 0.5995 (0.5904) acc 65.6250 (67.2396) kd_loss 0.7838 (0.7563) lr 1.7290e-03 eta 0:24:03
epoch [14/50] batch [140/403] time 0.077 (0.095) data 0.000 (0.012) loss 1.7750 (1.9711) ce_loss 0.6758 (0.9175) loss_zs_kd 2.4828 (2.1617) loss_oracle 0.5932 (0.5924) acc 75.0000 (67.6339) kd_loss 0.8027 (0.7574) lr 1.7290e-03 eta 0:23:29
epoch [14/50] batch [160/403] time 0.100 (0.094) data 0.000 (0.011) loss 2.1144 (1.9743) ce_loss 1.0615 (0.9190) loss_zs_kd 2.1597 (2.1654) loss_oracle 0.6153 (0.5936) acc 53.1250 (67.3633) kd_loss 0.7452 (0.7585) lr 1.7290e-03 eta 0:23:04
epoch [14/50] batch [180/403] time 0.082 (0.093) data 0.000 (0.009) loss 1.9511 (1.9673) ce_loss 0.8735 (0.9107) loss_zs_kd 1.5921 (2.1671) loss_oracle 0.6472 (0.5934) acc 81.2500 (67.7083) kd_loss 0.7540 (0.7599) lr 1.7290e-03 eta 0:22:48
epoch [14/50] batch [200/403] time 0.087 (0.092) data 0.000 (0.009) loss 2.1377 (1.9730) ce_loss 1.0137 (0.9146) loss_zs_kd 1.8606 (2.1564) loss_oracle 0.6259 (0.5959) acc 68.7500 (67.6719) kd_loss 0.8111 (0.7604) lr 1.7290e-03 eta 0:22:38
epoch [14/50] batch [220/403] time 0.083 (0.091) data 0.000 (0.008) loss 2.3892 (1.9759) ce_loss 1.2793 (0.9156) loss_zs_kd 2.2950 (2.1554) loss_oracle 0.6100 (0.5969) acc 62.5000 (67.6420) kd_loss 0.8049 (0.7618) lr 1.7290e-03 eta 0:22:20
epoch [14/50] batch [240/403] time 0.082 (0.091) data 0.000 (0.007) loss 2.3277 (1.9709) ce_loss 1.2549 (0.9098) loss_zs_kd 1.7818 (2.1652) loss_oracle 0.5100 (0.5966) acc 53.1250 (67.8776) kd_loss 0.8178 (0.7627) lr 1.7290e-03 eta 0:22:09
epoch [14/50] batch [260/403] time 0.090 (0.090) data 0.000 (0.007) loss 2.2457 (1.9724) ce_loss 1.1680 (0.9105) loss_zs_kd 2.4026 (2.1530) loss_oracle 0.6360 (0.5961) acc 56.2500 (67.8125) kd_loss 0.7597 (0.7639) lr 1.7290e-03 eta 0:22:00
epoch [14/50] batch [280/403] time 0.079 (0.090) data 0.000 (0.006) loss 1.8407 (1.9727) ce_loss 0.7285 (0.9107) loss_zs_kd 2.1161 (2.1500) loss_oracle 0.6351 (0.5963) acc 78.1250 (67.8571) kd_loss 0.7946 (0.7638) lr 1.7290e-03 eta 0:21:53
epoch [14/50] batch [300/403] time 0.081 (0.089) data 0.000 (0.006) loss 2.0092 (1.9698) ce_loss 1.0059 (0.9094) loss_zs_kd 1.8143 (2.1427) loss_oracle 0.5316 (0.5943) acc 65.6250 (67.8750) kd_loss 0.7375 (0.7632) lr 1.7290e-03 eta 0:21:46
epoch [14/50] batch [320/403] time 0.079 (0.089) data 0.000 (0.005) loss 2.1593 (1.9669) ce_loss 1.0654 (0.9066) loss_zs_kd 2.6771 (2.1454) loss_oracle 0.6532 (0.5943) acc 59.3750 (67.9883) kd_loss 0.7673 (0.7631) lr 1.7290e-03 eta 0:21:36
epoch [14/50] batch [340/403] time 0.079 (0.088) data 0.000 (0.005) loss 1.8160 (1.9647) ce_loss 0.6807 (0.9037) loss_zs_kd 2.5909 (2.1378) loss_oracle 0.7205 (0.5954) acc 78.1250 (67.9779) kd_loss 0.7751 (0.7633) lr 1.7290e-03 eta 0:21:29
epoch [14/50] batch [360/403] time 0.075 (0.088) data 0.000 (0.005) loss 2.1016 (1.9655) ce_loss 1.1230 (0.9047) loss_zs_kd 2.4461 (2.1342) loss_oracle 0.5448 (0.5957) acc 56.2500 (67.9688) kd_loss 0.7061 (0.7629) lr 1.7290e-03 eta 0:21:20
epoch [14/50] batch [380/403] time 0.082 (0.088) data 0.000 (0.005) loss 2.0138 (1.9635) ce_loss 0.9390 (0.9025) loss_zs_kd 1.8432 (2.1365) loss_oracle 0.5601 (0.5963) acc 65.6250 (67.9194) kd_loss 0.7948 (0.7628) lr 1.7290e-03 eta 0:21:12
epoch [14/50] batch [400/403] time 0.077 (0.087) data 0.000 (0.004) loss 2.0218 (1.9590) ce_loss 0.9395 (0.8992) loss_zs_kd 1.9689 (2.1354) loss_oracle 0.5822 (0.5961) acc 68.7500 (68.0859) kd_loss 0.7913 (0.7617) lr 1.7290e-03 eta 0:21:03
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,022
* accuracy: 72.7%
* error: 27.3%
* macro_f1: 61.4%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,523
* accuracy: 42.9%
* error: 57.1%
* macro_f1: 32.3%
******* Domain 4 best val acc:      72.7%, epoch: 14 *******
******* Domain 4 best val test acc: 42.9%, epoch: 14 *******
******* Domain 4 best test acc:     43.6%, epoch: 13 *******
epoch [15/50] batch [20/403] time 0.083 (0.216) data 0.000 (0.133) loss 2.1044 (1.9832) ce_loss 1.0449 (0.9281) loss_zs_kd 2.5060 (2.2010) loss_oracle 0.5837 (0.6121) acc 62.5000 (66.2500) kd_loss 0.7676 (0.7490) lr 1.6845e-03 eta 0:52:15
epoch [15/50] batch [40/403] time 0.086 (0.149) data 0.000 (0.067) loss 1.9301 (1.9829) ce_loss 0.8750 (0.9237) loss_zs_kd 2.5714 (2.2140) loss_oracle 0.6256 (0.6151) acc 65.6250 (67.5781) kd_loss 0.7423 (0.7516) lr 1.6845e-03 eta 0:35:52
epoch [15/50] batch [60/403] time 0.078 (0.127) data 0.001 (0.045) loss 1.8102 (1.9578) ce_loss 0.7964 (0.9061) loss_zs_kd 2.0254 (2.1848) loss_oracle 0.6026 (0.6087) acc 78.1250 (68.3333) kd_loss 0.7126 (0.7474) lr 1.6845e-03 eta 0:30:28
epoch [15/50] batch [80/403] time 0.081 (0.116) data 0.000 (0.033) loss 1.8622 (1.9599) ce_loss 0.8828 (0.9091) loss_zs_kd 1.7795 (2.1778) loss_oracle 0.5971 (0.6054) acc 68.7500 (68.2422) kd_loss 0.6808 (0.7481) lr 1.6845e-03 eta 0:27:49
epoch [15/50] batch [100/403] time 0.084 (0.109) data 0.000 (0.027) loss 1.9961 (1.9634) ce_loss 0.9561 (0.9114) loss_zs_kd 2.5455 (2.1976) loss_oracle 0.6514 (0.6038) acc 62.5000 (68.3438) kd_loss 0.7144 (0.7500) lr 1.6845e-03 eta 0:26:12
epoch [15/50] batch [120/403] time 0.082 (0.104) data 0.000 (0.022) loss 1.8967 (1.9536) ce_loss 0.9634 (0.9004) loss_zs_kd 1.9357 (2.1884) loss_oracle 0.4709 (0.6030) acc 65.6250 (68.4896) kd_loss 0.6979 (0.7517) lr 1.6845e-03 eta 0:25:00
epoch [15/50] batch [140/403] time 0.092 (0.102) data 0.000 (0.019) loss 2.3292 (1.9553) ce_loss 1.1484 (0.9014) loss_zs_kd 1.9954 (2.1937) loss_oracle 0.7330 (0.6023) acc 46.8750 (68.3036) kd_loss 0.8143 (0.7528) lr 1.6845e-03 eta 0:24:22
epoch [15/50] batch [160/403] time 0.086 (0.100) data 0.000 (0.017) loss 1.8202 (1.9494) ce_loss 0.7002 (0.8954) loss_zs_kd 1.7350 (2.1991) loss_oracle 0.6073 (0.6015) acc 78.1250 (68.5938) kd_loss 0.8163 (0.7533) lr 1.6845e-03 eta 0:23:50
epoch [15/50] batch [180/403] time 0.079 (0.097) data 0.000 (0.015) loss 1.8170 (1.9465) ce_loss 0.8110 (0.8917) loss_zs_kd 2.6386 (2.2106) loss_oracle 0.5987 (0.6024) acc 71.8750 (68.5938) kd_loss 0.7066 (0.7536) lr 1.6845e-03 eta 0:23:14
epoch [15/50] batch [200/403] time 0.084 (0.096) data 0.000 (0.014) loss 1.7780 (1.9462) ce_loss 0.7163 (0.8917) loss_zs_kd 2.5475 (2.2100) loss_oracle 0.5632 (0.6005) acc 71.8750 (68.6250) kd_loss 0.7800 (0.7543) lr 1.6845e-03 eta 0:22:50
epoch [15/50] batch [220/403] time 0.089 (0.095) data 0.000 (0.012) loss 1.9797 (1.9504) ce_loss 0.9404 (0.8948) loss_zs_kd 2.0626 (2.2311) loss_oracle 0.6070 (0.5999) acc 59.3750 (68.5511) kd_loss 0.7358 (0.7556) lr 1.6845e-03 eta 0:22:32
epoch [15/50] batch [240/403] time 0.086 (0.094) data 0.000 (0.011) loss 1.8855 (1.9467) ce_loss 0.8276 (0.8904) loss_zs_kd 1.7075 (2.2189) loss_oracle 0.6181 (0.5998) acc 68.7500 (68.5807) kd_loss 0.7488 (0.7564) lr 1.6845e-03 eta 0:22:19
epoch [15/50] batch [260/403] time 0.079 (0.093) data 0.000 (0.010) loss 2.2103 (1.9438) ce_loss 1.1553 (0.8877) loss_zs_kd 2.3261 (2.2048) loss_oracle 0.5970 (0.6002) acc 50.0000 (68.6058) kd_loss 0.7565 (0.7560) lr 1.6845e-03 eta 0:22:07
epoch [15/50] batch [280/403] time 0.088 (0.093) data 0.000 (0.010) loss 1.8376 (1.9425) ce_loss 0.7104 (0.8852) loss_zs_kd 2.0152 (2.2027) loss_oracle 0.6682 (0.6009) acc 81.2500 (68.7277) kd_loss 0.7931 (0.7569) lr 1.6845e-03 eta 0:21:56
epoch [15/50] batch [300/403] time 0.085 (0.092) data 0.000 (0.009) loss 2.0476 (1.9484) ce_loss 1.0088 (0.8922) loss_zs_kd 2.1839 (2.2034) loss_oracle 0.5825 (0.6003) acc 71.8750 (68.6458) kd_loss 0.7476 (0.7561) lr 1.6845e-03 eta 0:21:47
epoch [15/50] batch [320/403] time 0.079 (0.092) data 0.000 (0.009) loss 2.1714 (1.9495) ce_loss 1.0957 (0.8932) loss_zs_kd 1.7674 (2.1954) loss_oracle 0.5949 (0.6019) acc 46.8750 (68.5449) kd_loss 0.7783 (0.7554) lr 1.6845e-03 eta 0:21:38
epoch [15/50] batch [340/403] time 0.083 (0.091) data 0.000 (0.008) loss 2.0586 (1.9528) ce_loss 0.9224 (0.8965) loss_zs_kd 1.9128 (2.1902) loss_oracle 0.6650 (0.6033) acc 62.5000 (68.3732) kd_loss 0.8038 (0.7546) lr 1.6845e-03 eta 0:21:31
epoch [15/50] batch [360/403] time 0.084 (0.091) data 0.000 (0.008) loss 1.7917 (1.9510) ce_loss 0.7935 (0.8943) loss_zs_kd 1.7494 (2.1844) loss_oracle 0.5746 (0.6031) acc 75.0000 (68.4896) kd_loss 0.7109 (0.7552) lr 1.6845e-03 eta 0:21:24
epoch [15/50] batch [380/403] time 0.091 (0.090) data 0.000 (0.007) loss 2.0247 (1.9531) ce_loss 0.9722 (0.8965) loss_zs_kd 1.9965 (2.1841) loss_oracle 0.5748 (0.6032) acc 59.3750 (68.5033) kd_loss 0.7651 (0.7550) lr 1.6845e-03 eta 0:21:17
epoch [15/50] batch [400/403] time 0.077 (0.090) data 0.000 (0.007) loss 1.8782 (1.9507) ce_loss 0.8027 (0.8936) loss_zs_kd 2.0689 (2.1818) loss_oracle 0.6525 (0.6035) acc 71.8750 (68.6484) kd_loss 0.7492 (0.7553) lr 1.6845e-03 eta 0:21:08
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,971
* accuracy: 71.7%
* error: 28.3%
* macro_f1: 58.7%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,441
* accuracy: 41.5%
* error: 58.5%
* macro_f1: 32.1%
******* Domain 4 best val acc:      72.7%, epoch: 14 *******
******* Domain 4 best val test acc: 42.9%, epoch: 14 *******
******* Domain 4 best test acc:     43.6%, epoch: 13 *******
epoch [16/50] batch [20/403] time 0.081 (0.196) data 0.000 (0.108) loss 1.7555 (1.9668) ce_loss 0.7427 (0.9263) loss_zs_kd 1.7731 (1.9684) loss_oracle 0.5552 (0.5752) acc 78.1250 (65.4688) kd_loss 0.7352 (0.7529) lr 1.6374e-03 eta 0:46:01
epoch [16/50] batch [40/403] time 0.083 (0.141) data 0.000 (0.054) loss 1.7806 (1.9909) ce_loss 0.7432 (0.9446) loss_zs_kd 2.0215 (2.0787) loss_oracle 0.6131 (0.5958) acc 71.8750 (66.4844) kd_loss 0.7309 (0.7484) lr 1.6374e-03 eta 0:33:08
epoch [16/50] batch [60/403] time 0.085 (0.123) data 0.000 (0.036) loss 1.8930 (1.9377) ce_loss 0.8647 (0.8898) loss_zs_kd 2.2110 (2.1031) loss_oracle 0.5611 (0.5979) acc 68.7500 (68.6979) kd_loss 0.7477 (0.7489) lr 1.6374e-03 eta 0:28:44
epoch [16/50] batch [80/403] time 0.074 (0.113) data 0.000 (0.027) loss 1.6128 (1.9335) ce_loss 0.7383 (0.8847) loss_zs_kd 1.8612 (2.0612) loss_oracle 0.5725 (0.6034) acc 78.1250 (68.8672) kd_loss 0.5883 (0.7471) lr 1.6374e-03 eta 0:26:23
epoch [16/50] batch [100/403] time 0.082 (0.107) data 0.000 (0.022) loss 2.0780 (1.9351) ce_loss 0.9375 (0.8805) loss_zs_kd 2.5319 (2.0702) loss_oracle 0.6776 (0.6090) acc 65.6250 (68.5938) kd_loss 0.8017 (0.7501) lr 1.6374e-03 eta 0:24:59
epoch [16/50] batch [120/403] time 0.088 (0.104) data 0.000 (0.018) loss 1.9478 (1.9426) ce_loss 0.9185 (0.8856) loss_zs_kd 1.6360 (2.0899) loss_oracle 0.6336 (0.6119) acc 56.2500 (68.1250) kd_loss 0.7125 (0.7511) lr 1.6374e-03 eta 0:24:09
epoch [16/50] batch [140/403] time 0.088 (0.101) data 0.000 (0.016) loss 2.1497 (1.9381) ce_loss 1.0566 (0.8849) loss_zs_kd 1.9510 (2.0885) loss_oracle 0.6546 (0.6091) acc 68.7500 (68.0804) kd_loss 0.7658 (0.7487) lr 1.6374e-03 eta 0:23:31
epoch [16/50] batch [160/403] time 0.074 (0.099) data 0.000 (0.014) loss 2.1588 (1.9356) ce_loss 1.1328 (0.8855) loss_zs_kd 2.1197 (2.0818) loss_oracle 0.6000 (0.6071) acc 59.3750 (68.1641) kd_loss 0.7260 (0.7466) lr 1.6374e-03 eta 0:23:02
epoch [16/50] batch [180/403] time 0.094 (0.098) data 0.000 (0.012) loss 2.1463 (1.9328) ce_loss 1.0664 (0.8847) loss_zs_kd 2.0419 (2.0849) loss_oracle 0.6273 (0.6071) acc 53.1250 (68.1250) kd_loss 0.7662 (0.7446) lr 1.6374e-03 eta 0:22:39
epoch [16/50] batch [200/403] time 0.088 (0.096) data 0.000 (0.011) loss 2.2222 (1.9327) ce_loss 1.0820 (0.8852) loss_zs_kd 2.9006 (2.1011) loss_oracle 0.6806 (0.6085) acc 59.3750 (68.2969) kd_loss 0.7998 (0.7432) lr 1.6374e-03 eta 0:22:16
epoch [16/50] batch [220/403] time 0.092 (0.095) data 0.000 (0.010) loss 1.8559 (1.9348) ce_loss 0.7788 (0.8872) loss_zs_kd 1.7832 (2.1037) loss_oracle 0.5973 (0.6081) acc 71.8750 (68.2244) kd_loss 0.7785 (0.7435) lr 1.6374e-03 eta 0:22:00
epoch [16/50] batch [240/403] time 0.080 (0.094) data 0.000 (0.009) loss 1.5633 (1.9279) ce_loss 0.5933 (0.8815) loss_zs_kd 2.1849 (2.1106) loss_oracle 0.5641 (0.6062) acc 87.5000 (68.3594) kd_loss 0.6879 (0.7433) lr 1.6374e-03 eta 0:21:45
epoch [16/50] batch [260/403] time 0.084 (0.093) data 0.000 (0.009) loss 1.7565 (1.9303) ce_loss 0.7241 (0.8846) loss_zs_kd 1.7917 (2.1203) loss_oracle 0.5955 (0.6061) acc 71.8750 (68.2452) kd_loss 0.7347 (0.7427) lr 1.6374e-03 eta 0:21:30
epoch [16/50] batch [280/403] time 0.085 (0.093) data 0.000 (0.008) loss 2.0675 (1.9302) ce_loss 1.0469 (0.8845) loss_zs_kd 2.5701 (2.1307) loss_oracle 0.5980 (0.6063) acc 68.7500 (68.1696) kd_loss 0.7216 (0.7426) lr 1.6374e-03 eta 0:21:19
epoch [16/50] batch [300/403] time 0.081 (0.092) data 0.000 (0.007) loss 2.0410 (1.9287) ce_loss 1.0879 (0.8839) loss_zs_kd 2.1759 (2.1325) loss_oracle 0.5344 (0.6050) acc 56.2500 (68.2188) kd_loss 0.6859 (0.7423) lr 1.6374e-03 eta 0:21:10
epoch [16/50] batch [320/403] time 0.085 (0.092) data 0.000 (0.007) loss 1.6934 (1.9279) ce_loss 0.7627 (0.8824) loss_zs_kd 2.0074 (2.1335) loss_oracle 0.5162 (0.6050) acc 81.2500 (68.2715) kd_loss 0.6726 (0.7430) lr 1.6374e-03 eta 0:21:04
epoch [16/50] batch [340/403] time 0.081 (0.092) data 0.000 (0.007) loss 2.0460 (1.9291) ce_loss 0.9961 (0.8818) loss_zs_kd 2.3946 (2.1429) loss_oracle 0.6120 (0.6057) acc 65.6250 (68.2904) kd_loss 0.7439 (0.7444) lr 1.6374e-03 eta 0:21:00
epoch [16/50] batch [360/403] time 0.086 (0.091) data 0.000 (0.006) loss 2.2113 (1.9302) ce_loss 1.1416 (0.8818) loss_zs_kd 2.1491 (2.1508) loss_oracle 0.6073 (0.6065) acc 53.1250 (68.2378) kd_loss 0.7660 (0.7452) lr 1.6374e-03 eta 0:20:50
epoch [16/50] batch [380/403] time 0.089 (0.091) data 0.000 (0.006) loss 1.7491 (1.9321) ce_loss 0.6792 (0.8821) loss_zs_kd 2.3160 (2.1565) loss_oracle 0.6161 (0.6080) acc 75.0000 (68.2648) kd_loss 0.7619 (0.7460) lr 1.6374e-03 eta 0:20:45
epoch [16/50] batch [400/403] time 0.078 (0.090) data 0.000 (0.006) loss 1.9023 (1.9322) ce_loss 0.8306 (0.8814) loss_zs_kd 2.1570 (2.1600) loss_oracle 0.6151 (0.6084) acc 71.8750 (68.2500) kd_loss 0.7642 (0.7466) lr 1.6374e-03 eta 0:20:37
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,996
* accuracy: 72.2%
* error: 27.8%
* macro_f1: 59.6%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,420
* accuracy: 41.1%
* error: 58.9%
* macro_f1: 32.0%
******* Domain 4 best val acc:      72.7%, epoch: 14 *******
******* Domain 4 best val test acc: 42.9%, epoch: 14 *******
******* Domain 4 best test acc:     43.6%, epoch: 13 *******
epoch [17/50] batch [20/403] time 0.076 (0.182) data 0.000 (0.096) loss 1.8861 (1.8854) ce_loss 0.8472 (0.8338) loss_zs_kd 1.9944 (2.0990) loss_oracle 0.5239 (0.6022) acc 71.8750 (69.6875) kd_loss 0.7770 (0.7505) lr 1.5878e-03 eta 0:41:24
epoch [17/50] batch [40/403] time 0.079 (0.131) data 0.000 (0.048) loss 2.4027 (1.9409) ce_loss 1.3496 (0.8882) loss_zs_kd 2.5414 (2.1055) loss_oracle 0.5791 (0.5994) acc 50.0000 (68.7500) kd_loss 0.7636 (0.7530) lr 1.5878e-03 eta 0:29:55
epoch [17/50] batch [60/403] time 0.083 (0.114) data 0.000 (0.032) loss 1.8696 (1.9113) ce_loss 0.7422 (0.8535) loss_zs_kd 1.9743 (2.1578) loss_oracle 0.6279 (0.6008) acc 75.0000 (69.0625) kd_loss 0.8135 (0.7574) lr 1.5878e-03 eta 0:25:58
epoch [17/50] batch [80/403] time 0.079 (0.106) data 0.000 (0.024) loss 2.4350 (1.9235) ce_loss 1.4619 (0.8725) loss_zs_kd 1.9903 (2.1632) loss_oracle 0.5714 (0.5991) acc 56.2500 (68.2422) kd_loss 0.6873 (0.7514) lr 1.5878e-03 eta 0:24:02
epoch [17/50] batch [100/403] time 0.082 (0.100) data 0.000 (0.019) loss 1.9120 (1.9305) ce_loss 0.8730 (0.8787) loss_zs_kd 2.0565 (2.1645) loss_oracle 0.4949 (0.5995) acc 68.7500 (68.0312) kd_loss 0.7915 (0.7520) lr 1.5878e-03 eta 0:22:45
epoch [17/50] batch [120/403] time 0.090 (0.097) data 0.000 (0.016) loss 1.9145 (1.9316) ce_loss 0.8481 (0.8774) loss_zs_kd 1.8046 (2.1787) loss_oracle 0.5896 (0.6051) acc 62.5000 (68.1771) kd_loss 0.7715 (0.7517) lr 1.5878e-03 eta 0:21:59
epoch [17/50] batch [140/403] time 0.084 (0.096) data 0.000 (0.014) loss 1.8055 (1.9315) ce_loss 0.7578 (0.8763) loss_zs_kd 1.7114 (2.1928) loss_oracle 0.5900 (0.6102) acc 75.0000 (68.6161) kd_loss 0.7527 (0.7501) lr 1.5878e-03 eta 0:21:35
epoch [17/50] batch [160/403] time 0.089 (0.094) data 0.000 (0.012) loss 1.9197 (1.9282) ce_loss 0.8184 (0.8727) loss_zs_kd 2.2378 (2.1892) loss_oracle 0.6402 (0.6100) acc 68.7500 (68.6328) kd_loss 0.7813 (0.7505) lr 1.5878e-03 eta 0:21:12
epoch [17/50] batch [180/403] time 0.083 (0.093) data 0.000 (0.011) loss 2.1340 (1.9236) ce_loss 1.0166 (0.8702) loss_zs_kd 1.9434 (2.1773) loss_oracle 0.6424 (0.6092) acc 59.3750 (68.9410) kd_loss 0.7962 (0.7488) lr 1.5878e-03 eta 0:20:53
epoch [17/50] batch [200/403] time 0.082 (0.092) data 0.000 (0.010) loss 1.8921 (1.9252) ce_loss 0.7832 (0.8713) loss_zs_kd 1.9793 (2.1613) loss_oracle 0.6274 (0.6096) acc 65.6250 (68.8594) kd_loss 0.7952 (0.7491) lr 1.5878e-03 eta 0:20:42
epoch [17/50] batch [220/403] time 0.083 (0.091) data 0.000 (0.009) loss 1.9920 (1.9311) ce_loss 0.9492 (0.8771) loss_zs_kd 2.0394 (2.1647) loss_oracle 0.6070 (0.6084) acc 59.3750 (68.6648) kd_loss 0.7393 (0.7498) lr 1.5878e-03 eta 0:20:33
epoch [17/50] batch [240/403] time 0.078 (0.091) data 0.000 (0.008) loss 1.8864 (1.9312) ce_loss 0.7861 (0.8764) loss_zs_kd 2.0954 (2.1537) loss_oracle 0.6984 (0.6105) acc 75.0000 (68.7370) kd_loss 0.7510 (0.7495) lr 1.5878e-03 eta 0:20:25
epoch [17/50] batch [260/403] time 0.088 (0.091) data 0.000 (0.008) loss 1.7502 (1.9343) ce_loss 0.6260 (0.8783) loss_zs_kd 2.0609 (2.1483) loss_oracle 0.6647 (0.6107) acc 81.2500 (68.5817) kd_loss 0.7919 (0.7507) lr 1.5878e-03 eta 0:20:16
epoch [17/50] batch [280/403] time 0.092 (0.090) data 0.000 (0.007) loss 2.0297 (1.9371) ce_loss 0.9722 (0.8802) loss_zs_kd 2.1224 (2.1418) loss_oracle 0.6152 (0.6101) acc 65.6250 (68.5268) kd_loss 0.7500 (0.7519) lr 1.5878e-03 eta 0:20:08
epoch [17/50] batch [300/403] time 0.083 (0.090) data 0.000 (0.007) loss 1.9309 (1.9395) ce_loss 0.9155 (0.8833) loss_zs_kd 2.1545 (2.1379) loss_oracle 0.6180 (0.6098) acc 65.6250 (68.4479) kd_loss 0.7064 (0.7513) lr 1.5878e-03 eta 0:20:04
epoch [17/50] batch [320/403] time 0.074 (0.089) data 0.000 (0.006) loss 1.9556 (1.9386) ce_loss 0.9243 (0.8821) loss_zs_kd 2.1686 (2.1411) loss_oracle 0.6258 (0.6098) acc 65.6250 (68.4570) kd_loss 0.7184 (0.7517) lr 1.5878e-03 eta 0:19:44
epoch [17/50] batch [340/403] time 0.080 (0.088) data 0.000 (0.006) loss 2.0211 (1.9392) ce_loss 0.9604 (0.8827) loss_zs_kd 2.1035 (2.1508) loss_oracle 0.6068 (0.6093) acc 65.6250 (68.5018) kd_loss 0.7573 (0.7518) lr 1.5878e-03 eta 0:19:35
epoch [17/50] batch [360/403] time 0.084 (0.088) data 0.000 (0.006) loss 1.8582 (1.9366) ce_loss 0.8091 (0.8811) loss_zs_kd 2.2623 (2.1592) loss_oracle 0.6438 (0.6095) acc 59.3750 (68.5156) kd_loss 0.7272 (0.7507) lr 1.5878e-03 eta 0:19:31
epoch [17/50] batch [380/403] time 0.086 (0.087) data 0.000 (0.005) loss 2.0602 (1.9353) ce_loss 1.0439 (0.8797) loss_zs_kd 2.0916 (2.1616) loss_oracle 0.5724 (0.6100) acc 62.5000 (68.5197) kd_loss 0.7301 (0.7505) lr 1.5878e-03 eta 0:19:21
epoch [17/50] batch [400/403] time 0.079 (0.087) data 0.000 (0.005) loss 2.0779 (1.9387) ce_loss 1.0957 (0.8832) loss_zs_kd 2.6226 (2.1699) loss_oracle 0.6401 (0.6107) acc 59.3750 (68.3672) kd_loss 0.6622 (0.7501) lr 1.5878e-03 eta 0:19:15
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,999
* accuracy: 72.2%
* error: 27.8%
* macro_f1: 60.0%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,381
* accuracy: 40.5%
* error: 59.5%
* macro_f1: 31.0%
******* Domain 4 best val acc:      72.7%, epoch: 14 *******
******* Domain 4 best val test acc: 42.9%, epoch: 14 *******
******* Domain 4 best test acc:     43.6%, epoch: 13 *******
epoch [18/50] batch [20/403] time 0.079 (0.250) data 0.000 (0.162) loss 2.0793 (1.9741) ce_loss 1.0166 (0.9055) loss_zs_kd 1.8603 (2.1646) loss_oracle 0.6139 (0.6431) acc 59.3750 (67.9688) kd_loss 0.7557 (0.7471) lr 1.5358e-03 eta 0:55:15
epoch [18/50] batch [40/403] time 0.082 (0.165) data 0.000 (0.081) loss 1.8519 (1.9700) ce_loss 0.8589 (0.9120) loss_zs_kd 2.0366 (2.1191) loss_oracle 0.5794 (0.6343) acc 65.6250 (67.1875) kd_loss 0.7033 (0.7409) lr 1.5358e-03 eta 0:36:24
epoch [18/50] batch [60/403] time 0.080 (0.137) data 0.000 (0.054) loss 2.0505 (1.9722) ce_loss 1.0576 (0.9182) loss_zs_kd 1.7871 (2.0930) loss_oracle 0.5280 (0.6256) acc 53.1250 (67.2396) kd_loss 0.7289 (0.7412) lr 1.5358e-03 eta 0:30:13
epoch [18/50] batch [80/403] time 0.078 (0.124) data 0.000 (0.041) loss 1.9231 (1.9571) ce_loss 0.8569 (0.9056) loss_zs_kd 2.2284 (2.0981) loss_oracle 0.6129 (0.6209) acc 71.8750 (67.6562) kd_loss 0.7598 (0.7411) lr 1.5358e-03 eta 0:27:15
epoch [18/50] batch [100/403] time 0.100 (0.118) data 0.000 (0.033) loss 1.9319 (1.9567) ce_loss 0.8354 (0.9041) loss_zs_kd 2.3186 (2.1143) loss_oracle 0.6387 (0.6175) acc 68.7500 (67.7500) kd_loss 0.7771 (0.7438) lr 1.5358e-03 eta 0:25:51
epoch [18/50] batch [120/403] time 0.084 (0.112) data 0.000 (0.027) loss 1.7013 (1.9505) ce_loss 0.5977 (0.8941) loss_zs_kd 2.2303 (2.1499) loss_oracle 0.5954 (0.6186) acc 84.3750 (68.0990) kd_loss 0.8059 (0.7472) lr 1.5358e-03 eta 0:24:39
epoch [18/50] batch [140/403] time 0.086 (0.108) data 0.000 (0.023) loss 1.9147 (1.9502) ce_loss 0.9087 (0.8920) loss_zs_kd 2.0187 (2.1439) loss_oracle 0.5856 (0.6170) acc 75.0000 (68.0357) kd_loss 0.7132 (0.7498) lr 1.5358e-03 eta 0:23:41
epoch [18/50] batch [160/403] time 0.081 (0.105) data 0.000 (0.020) loss 2.1568 (1.9559) ce_loss 1.1426 (0.8951) loss_zs_kd 2.2592 (2.1764) loss_oracle 0.6057 (0.6187) acc 65.6250 (67.8320) kd_loss 0.7114 (0.7515) lr 1.5358e-03 eta 0:22:57
epoch [18/50] batch [180/403] time 0.082 (0.103) data 0.000 (0.018) loss 2.1778 (1.9583) ce_loss 1.0068 (0.8953) loss_zs_kd 2.0340 (2.1686) loss_oracle 0.6958 (0.6191) acc 71.8750 (67.8125) kd_loss 0.8231 (0.7535) lr 1.5358e-03 eta 0:22:26
epoch [18/50] batch [200/403] time 0.084 (0.101) data 0.000 (0.016) loss 1.7346 (1.9628) ce_loss 0.6309 (0.8989) loss_zs_kd 2.2618 (2.1680) loss_oracle 0.6356 (0.6189) acc 78.1250 (67.7344) kd_loss 0.7860 (0.7545) lr 1.5358e-03 eta 0:21:57
epoch [18/50] batch [220/403] time 0.078 (0.099) data 0.000 (0.015) loss 1.9394 (1.9589) ce_loss 0.8174 (0.8952) loss_zs_kd 2.2551 (2.1684) loss_oracle 0.6436 (0.6176) acc 68.7500 (67.7841) kd_loss 0.8002 (0.7549) lr 1.5358e-03 eta 0:21:32
epoch [18/50] batch [240/403] time 0.084 (0.098) data 0.000 (0.014) loss 1.8538 (1.9580) ce_loss 0.7168 (0.8927) loss_zs_kd 1.8168 (2.1704) loss_oracle 0.7046 (0.6185) acc 75.0000 (67.9557) kd_loss 0.7847 (0.7560) lr 1.5358e-03 eta 0:21:13
epoch [18/50] batch [260/403] time 0.080 (0.097) data 0.000 (0.013) loss 1.8465 (1.9633) ce_loss 0.7891 (0.8982) loss_zs_kd 2.1427 (2.1709) loss_oracle 0.6642 (0.6201) acc 71.8750 (67.9327) kd_loss 0.7253 (0.7551) lr 1.5358e-03 eta 0:20:59
epoch [18/50] batch [280/403] time 0.079 (0.096) data 0.000 (0.012) loss 1.7839 (1.9574) ce_loss 0.7686 (0.8919) loss_zs_kd 1.5564 (2.1644) loss_oracle 0.6456 (0.6216) acc 71.8750 (68.2366) kd_loss 0.6925 (0.7547) lr 1.5358e-03 eta 0:20:44
epoch [18/50] batch [300/403] time 0.083 (0.095) data 0.000 (0.011) loss 1.9211 (1.9562) ce_loss 0.8286 (0.8913) loss_zs_kd 2.1677 (2.1652) loss_oracle 0.7087 (0.6214) acc 75.0000 (68.1875) kd_loss 0.7381 (0.7541) lr 1.5358e-03 eta 0:20:32
epoch [18/50] batch [320/403] time 0.081 (0.094) data 0.000 (0.010) loss 2.1658 (1.9605) ce_loss 1.0928 (0.8951) loss_zs_kd 2.1155 (2.1670) loss_oracle 0.5946 (0.6221) acc 65.6250 (68.0566) kd_loss 0.7758 (0.7544) lr 1.5358e-03 eta 0:20:21
epoch [18/50] batch [340/403] time 0.079 (0.094) data 0.000 (0.010) loss 2.3330 (1.9601) ce_loss 1.2529 (0.8931) loss_zs_kd 2.4699 (2.1755) loss_oracle 0.6134 (0.6229) acc 53.1250 (68.1066) kd_loss 0.7734 (0.7556) lr 1.5358e-03 eta 0:20:12
epoch [18/50] batch [360/403] time 0.073 (0.093) data 0.000 (0.009) loss 2.0540 (1.9572) ce_loss 0.9868 (0.8894) loss_zs_kd 2.4562 (2.1780) loss_oracle 0.5713 (0.6229) acc 65.6250 (68.2986) kd_loss 0.7816 (0.7563) lr 1.5358e-03 eta 0:20:01
epoch [18/50] batch [380/403] time 0.078 (0.092) data 0.000 (0.009) loss 1.8734 (1.9584) ce_loss 0.8325 (0.8903) loss_zs_kd 2.2527 (2.1842) loss_oracle 0.6615 (0.6231) acc 62.5000 (68.2237) kd_loss 0.7101 (0.7566) lr 1.5358e-03 eta 0:19:51
epoch [18/50] batch [400/403] time 0.078 (0.092) data 0.000 (0.008) loss 2.1455 (1.9559) ce_loss 1.0215 (0.8877) loss_zs_kd 2.1200 (2.1896) loss_oracle 0.6740 (0.6229) acc 65.6250 (68.3047) kd_loss 0.7870 (0.7568) lr 1.5358e-03 eta 0:19:43
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,044
* accuracy: 73.1%
* error: 26.9%
* macro_f1: 60.7%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,533
* accuracy: 43.1%
* error: 56.9%
* macro_f1: 33.2%
******* Domain 4 best val acc:      73.1%, epoch: 18 *******
******* Domain 4 best val test acc: 43.1%, epoch: 18 *******
******* Domain 4 best test acc:     43.6%, epoch: 13 *******
epoch [19/50] batch [20/403] time 0.086 (0.175) data 0.000 (0.085) loss 1.9733 (1.9888) ce_loss 0.8833 (0.9163) loss_zs_kd 2.0416 (2.2566) loss_oracle 0.7198 (0.6374) acc 75.0000 (67.1875) kd_loss 0.7301 (0.7538) lr 1.4818e-03 eta 0:37:34
epoch [19/50] batch [40/403] time 0.093 (0.131) data 0.000 (0.043) loss 1.8332 (1.9858) ce_loss 0.8008 (0.9111) loss_zs_kd 2.1160 (2.2788) loss_oracle 0.6171 (0.6351) acc 75.0000 (67.8125) kd_loss 0.7239 (0.7572) lr 1.4818e-03 eta 0:28:06
epoch [19/50] batch [60/403] time 0.087 (0.117) data 0.000 (0.029) loss 1.7598 (1.9574) ce_loss 0.6880 (0.8842) loss_zs_kd 2.5206 (2.2825) loss_oracle 0.6510 (0.6325) acc 75.0000 (68.9583) kd_loss 0.7463 (0.7569) lr 1.4818e-03 eta 0:24:59
epoch [19/50] batch [80/403] time 0.076 (0.109) data 0.000 (0.022) loss 1.8149 (1.9390) ce_loss 0.7065 (0.8644) loss_zs_kd 2.1368 (2.3026) loss_oracle 0.6648 (0.6328) acc 81.2500 (69.6094) kd_loss 0.7760 (0.7582) lr 1.4818e-03 eta 0:23:12
epoch [19/50] batch [100/403] time 0.086 (0.103) data 0.000 (0.017) loss 1.7830 (1.9501) ce_loss 0.7373 (0.8801) loss_zs_kd 2.8519 (2.2955) loss_oracle 0.5811 (0.6291) acc 78.1250 (68.7188) kd_loss 0.7552 (0.7554) lr 1.4818e-03 eta 0:22:02
epoch [19/50] batch [120/403] time 0.079 (0.100) data 0.000 (0.014) loss 1.9072 (1.9505) ce_loss 0.8433 (0.8814) loss_zs_kd 2.6409 (2.3022) loss_oracle 0.5840 (0.6240) acc 78.1250 (68.5938) kd_loss 0.7719 (0.7572) lr 1.4818e-03 eta 0:21:17
epoch [19/50] batch [140/403] time 0.085 (0.098) data 0.000 (0.012) loss 2.1745 (1.9462) ce_loss 1.0850 (0.8796) loss_zs_kd 2.6408 (2.2665) loss_oracle 0.6551 (0.6205) acc 46.8750 (68.7277) kd_loss 0.7620 (0.7564) lr 1.4818e-03 eta 0:20:54
epoch [19/50] batch [160/403] time 0.083 (0.097) data 0.000 (0.011) loss 1.8718 (1.9377) ce_loss 0.9131 (0.8714) loss_zs_kd 1.7442 (2.2526) loss_oracle 0.5015 (0.6195) acc 62.5000 (69.1602) kd_loss 0.7080 (0.7566) lr 1.4818e-03 eta 0:20:31
epoch [19/50] batch [180/403] time 0.092 (0.095) data 0.000 (0.010) loss 1.9530 (1.9288) ce_loss 0.9272 (0.8632) loss_zs_kd 1.8343 (2.2418) loss_oracle 0.5586 (0.6184) acc 71.8750 (69.1667) kd_loss 0.7464 (0.7564) lr 1.4818e-03 eta 0:20:10
epoch [19/50] batch [200/403] time 0.083 (0.094) data 0.000 (0.009) loss 1.9335 (1.9315) ce_loss 0.8838 (0.8668) loss_zs_kd 2.3638 (2.2353) loss_oracle 0.6271 (0.6177) acc 59.3750 (68.9219) kd_loss 0.7362 (0.7559) lr 1.4818e-03 eta 0:19:56
epoch [19/50] batch [220/403] time 0.080 (0.093) data 0.000 (0.008) loss 1.9882 (1.9229) ce_loss 0.8716 (0.8582) loss_zs_kd 1.9783 (2.2351) loss_oracle 0.6091 (0.6181) acc 78.1250 (69.2045) kd_loss 0.8121 (0.7557) lr 1.4818e-03 eta 0:19:39
epoch [19/50] batch [240/403] time 0.080 (0.092) data 0.000 (0.007) loss 1.9410 (1.9298) ce_loss 0.9121 (0.8659) loss_zs_kd 2.2341 (2.2294) loss_oracle 0.6536 (0.6158) acc 75.0000 (69.0495) kd_loss 0.7021 (0.7560) lr 1.4818e-03 eta 0:19:28
epoch [19/50] batch [260/403] time 0.080 (0.092) data 0.000 (0.007) loss 1.8813 (1.9341) ce_loss 0.8433 (0.8721) loss_zs_kd 3.1115 (2.2394) loss_oracle 0.5875 (0.6145) acc 62.5000 (68.7380) kd_loss 0.7443 (0.7546) lr 1.4818e-03 eta 0:19:17
epoch [19/50] batch [280/403] time 0.082 (0.091) data 0.000 (0.006) loss 1.9957 (1.9372) ce_loss 0.9058 (0.8743) loss_zs_kd 1.5410 (2.2429) loss_oracle 0.6238 (0.6154) acc 65.6250 (68.7946) kd_loss 0.7780 (0.7552) lr 1.4818e-03 eta 0:19:07
epoch [19/50] batch [300/403] time 0.081 (0.090) data 0.000 (0.006) loss 1.5946 (1.9347) ce_loss 0.5425 (0.8701) loss_zs_kd 2.4807 (2.2495) loss_oracle 0.5869 (0.6172) acc 81.2500 (68.9375) kd_loss 0.7586 (0.7560) lr 1.4818e-03 eta 0:18:59
epoch [19/50] batch [320/403] time 0.079 (0.090) data 0.000 (0.006) loss 1.9522 (1.9371) ce_loss 0.9126 (0.8735) loss_zs_kd 2.4337 (2.2464) loss_oracle 0.4944 (0.6166) acc 65.6250 (68.9160) kd_loss 0.7924 (0.7553) lr 1.4818e-03 eta 0:18:50
epoch [19/50] batch [340/403] time 0.086 (0.089) data 0.000 (0.005) loss 1.9744 (1.9388) ce_loss 0.9019 (0.8762) loss_zs_kd 2.0529 (2.2391) loss_oracle 0.6074 (0.6157) acc 65.6250 (68.7132) kd_loss 0.7689 (0.7548) lr 1.4818e-03 eta 0:18:42
epoch [19/50] batch [360/403] time 0.090 (0.089) data 0.000 (0.005) loss 1.7253 (1.9385) ce_loss 0.7178 (0.8763) loss_zs_kd 2.4928 (2.2410) loss_oracle 0.5486 (0.6148) acc 62.5000 (68.6719) kd_loss 0.7332 (0.7548) lr 1.4818e-03 eta 0:18:37
epoch [19/50] batch [380/403] time 0.085 (0.089) data 0.000 (0.005) loss 1.9349 (1.9391) ce_loss 0.7798 (0.8771) loss_zs_kd 2.1410 (2.2300) loss_oracle 0.7296 (0.6147) acc 68.7500 (68.6678) kd_loss 0.7903 (0.7546) lr 1.4818e-03 eta 0:18:32
epoch [19/50] batch [400/403] time 0.081 (0.089) data 0.000 (0.005) loss 2.0706 (1.9393) ce_loss 1.0244 (0.8769) loss_zs_kd 2.4937 (2.2356) loss_oracle 0.6330 (0.6153) acc 65.6250 (68.6094) kd_loss 0.7296 (0.7547) lr 1.4818e-03 eta 0:18:28
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,958
* accuracy: 71.5%
* error: 28.5%
* macro_f1: 58.1%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,446
* accuracy: 41.6%
* error: 58.4%
* macro_f1: 32.2%
******* Domain 4 best val acc:      73.1%, epoch: 18 *******
******* Domain 4 best val test acc: 43.1%, epoch: 18 *******
******* Domain 4 best test acc:     43.6%, epoch: 13 *******
epoch [20/50] batch [20/403] time 0.080 (0.237) data 0.000 (0.154) loss 2.0170 (1.9731) ce_loss 1.0039 (0.9017) loss_zs_kd 2.6770 (2.2908) loss_oracle 0.5317 (0.5867) acc 71.8750 (68.2812) kd_loss 0.7473 (0.7780) lr 1.4258e-03 eta 0:49:11
epoch [20/50] batch [40/403] time 0.081 (0.160) data 0.000 (0.077) loss 1.7845 (1.9126) ce_loss 0.7324 (0.8442) loss_zs_kd 1.7014 (2.2961) loss_oracle 0.5610 (0.5925) acc 75.0000 (70.2344) kd_loss 0.7716 (0.7721) lr 1.4258e-03 eta 0:33:17
epoch [20/50] batch [60/403] time 0.080 (0.135) data 0.000 (0.051) loss 1.9063 (1.9103) ce_loss 0.7959 (0.8439) loss_zs_kd 2.0843 (2.2649) loss_oracle 0.5357 (0.5965) acc 71.8750 (69.8438) kd_loss 0.8426 (0.7681) lr 1.4258e-03 eta 0:28:02
epoch [20/50] batch [80/403] time 0.076 (0.121) data 0.000 (0.039) loss 1.8722 (1.8998) ce_loss 0.8208 (0.8357) loss_zs_kd 2.2021 (2.2638) loss_oracle 0.6182 (0.6005) acc 65.6250 (70.1562) kd_loss 0.7423 (0.7638) lr 1.4258e-03 eta 0:25:07
epoch [20/50] batch [100/403] time 0.085 (0.113) data 0.000 (0.031) loss 1.8791 (1.9258) ce_loss 0.8438 (0.8588) loss_zs_kd 2.7540 (2.2763) loss_oracle 0.5491 (0.6018) acc 62.5000 (69.6562) kd_loss 0.7608 (0.7661) lr 1.4258e-03 eta 0:23:18
epoch [20/50] batch [120/403] time 0.082 (0.107) data 0.000 (0.026) loss 2.0038 (1.9289) ce_loss 0.9287 (0.8595) loss_zs_kd 2.1722 (2.2730) loss_oracle 0.6352 (0.6041) acc 68.7500 (69.7917) kd_loss 0.7575 (0.7674) lr 1.4258e-03 eta 0:22:09
epoch [20/50] batch [140/403] time 0.083 (0.105) data 0.000 (0.022) loss 1.9520 (1.9309) ce_loss 0.8799 (0.8625) loss_zs_kd 3.1088 (2.2741) loss_oracle 0.6229 (0.6031) acc 65.6250 (69.7545) kd_loss 0.7606 (0.7668) lr 1.4258e-03 eta 0:21:31
epoch [20/50] batch [160/403] time 0.086 (0.102) data 0.000 (0.019) loss 2.2348 (1.9357) ce_loss 1.1641 (0.8666) loss_zs_kd 2.5402 (2.2700) loss_oracle 0.6113 (0.6044) acc 53.1250 (69.4141) kd_loss 0.7650 (0.7669) lr 1.4258e-03 eta 0:20:54
epoch [20/50] batch [180/403] time 0.091 (0.100) data 0.000 (0.017) loss 1.6316 (1.9400) ce_loss 0.5864 (0.8709) loss_zs_kd 2.1474 (2.2722) loss_oracle 0.5800 (0.6022) acc 87.5000 (69.4444) kd_loss 0.7552 (0.7680) lr 1.4258e-03 eta 0:20:28
epoch [20/50] batch [200/403] time 0.079 (0.098) data 0.000 (0.016) loss 1.8743 (1.9422) ce_loss 0.7402 (0.8702) loss_zs_kd 2.6943 (2.2769) loss_oracle 0.6268 (0.6030) acc 81.2500 (69.3906) kd_loss 0.8207 (0.7704) lr 1.4258e-03 eta 0:20:04
epoch [20/50] batch [220/403] time 0.083 (0.096) data 0.000 (0.014) loss 2.0646 (1.9441) ce_loss 1.0820 (0.8730) loss_zs_kd 2.2413 (2.2647) loss_oracle 0.5266 (0.6010) acc 59.3750 (69.1335) kd_loss 0.7193 (0.7706) lr 1.4258e-03 eta 0:19:41
epoch [20/50] batch [240/403] time 0.076 (0.095) data 0.000 (0.013) loss 1.9075 (1.9456) ce_loss 0.7803 (0.8752) loss_zs_kd 2.6260 (2.2654) loss_oracle 0.5807 (0.5973) acc 68.7500 (69.0104) kd_loss 0.8369 (0.7717) lr 1.4258e-03 eta 0:19:24
epoch [20/50] batch [260/403] time 0.079 (0.094) data 0.000 (0.012) loss 1.9437 (1.9452) ce_loss 0.8965 (0.8767) loss_zs_kd 1.5843 (2.2573) loss_oracle 0.6525 (0.5962) acc 75.0000 (69.0264) kd_loss 0.7209 (0.7704) lr 1.4258e-03 eta 0:19:10
epoch [20/50] batch [280/403] time 0.088 (0.093) data 0.000 (0.011) loss 2.0547 (1.9462) ce_loss 0.9604 (0.8783) loss_zs_kd 2.4115 (2.2435) loss_oracle 0.6419 (0.5963) acc 65.6250 (68.9844) kd_loss 0.7733 (0.7697) lr 1.4258e-03 eta 0:18:59
epoch [20/50] batch [300/403] time 0.081 (0.093) data 0.000 (0.011) loss 1.7445 (1.9457) ce_loss 0.6802 (0.8779) loss_zs_kd 2.6572 (2.2596) loss_oracle 0.6113 (0.5978) acc 75.0000 (68.9375) kd_loss 0.7586 (0.7689) lr 1.4258e-03 eta 0:18:50
epoch [20/50] batch [320/403] time 0.087 (0.092) data 0.000 (0.010) loss 1.7210 (1.9410) ce_loss 0.7441 (0.8739) loss_zs_kd 1.8898 (2.2563) loss_oracle 0.5004 (0.5989) acc 71.8750 (69.1406) kd_loss 0.7266 (0.7676) lr 1.4258e-03 eta 0:18:37
epoch [20/50] batch [340/403] time 0.075 (0.091) data 0.000 (0.009) loss 1.8865 (1.9397) ce_loss 0.7939 (0.8740) loss_zs_kd 2.1828 (2.2623) loss_oracle 0.6640 (0.5991) acc 75.0000 (69.0717) kd_loss 0.7605 (0.7661) lr 1.4258e-03 eta 0:18:30
epoch [20/50] batch [360/403] time 0.087 (0.091) data 0.000 (0.009) loss 2.0082 (1.9375) ce_loss 0.9531 (0.8729) loss_zs_kd 1.9796 (2.2551) loss_oracle 0.5955 (0.5986) acc 62.5000 (69.0451) kd_loss 0.7573 (0.7654) lr 1.4258e-03 eta 0:18:22
epoch [20/50] batch [380/403] time 0.083 (0.091) data 0.000 (0.008) loss 2.0326 (1.9342) ce_loss 0.9775 (0.8703) loss_zs_kd 1.6196 (2.2458) loss_oracle 0.6041 (0.5982) acc 68.7500 (69.0296) kd_loss 0.7530 (0.7647) lr 1.4258e-03 eta 0:18:16
epoch [20/50] batch [400/403] time 0.075 (0.090) data 0.000 (0.008) loss 1.8757 (1.9353) ce_loss 0.8130 (0.8723) loss_zs_kd 2.3750 (2.2423) loss_oracle 0.5920 (0.5985) acc 78.1250 (68.9922) kd_loss 0.7667 (0.7638) lr 1.4258e-03 eta 0:18:08
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,976
* accuracy: 71.8%
* error: 28.2%
* macro_f1: 59.4%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,488
* accuracy: 42.3%
* error: 57.7%
* macro_f1: 30.8%
******* Domain 4 best val acc:      73.1%, epoch: 18 *******
******* Domain 4 best val test acc: 43.1%, epoch: 18 *******
******* Domain 4 best test acc:     43.6%, epoch: 13 *******
epoch [21/50] batch [20/403] time 0.083 (0.196) data 0.000 (0.109) loss 1.8434 (1.8944) ce_loss 0.7900 (0.8474) loss_zs_kd 2.2724 (2.2339) loss_oracle 0.6362 (0.6128) acc 71.8750 (70.3125) kd_loss 0.7352 (0.7407) lr 1.3681e-03 eta 0:39:29
epoch [21/50] batch [40/403] time 0.087 (0.139) data 0.000 (0.055) loss 2.3416 (1.9376) ce_loss 1.2871 (0.8966) loss_zs_kd 2.1410 (2.2308) loss_oracle 0.6285 (0.6086) acc 65.6250 (68.4375) kd_loss 0.7403 (0.7367) lr 1.3681e-03 eta 0:27:54
epoch [21/50] batch [60/403] time 0.068 (0.120) data 0.000 (0.037) loss 2.0233 (1.9536) ce_loss 0.9019 (0.9140) loss_zs_kd 2.2427 (2.2450) loss_oracle 0.6040 (0.6031) acc 59.3750 (67.2396) kd_loss 0.8195 (0.7381) lr 1.3681e-03 eta 0:23:59
epoch [21/50] batch [80/403] time 0.078 (0.110) data 0.000 (0.027) loss 1.8369 (1.9301) ce_loss 0.7324 (0.8869) loss_zs_kd 2.4362 (2.2235) loss_oracle 0.6528 (0.6050) acc 75.0000 (68.5156) kd_loss 0.7781 (0.7408) lr 1.3681e-03 eta 0:22:06
epoch [21/50] batch [100/403] time 0.081 (0.105) data 0.000 (0.022) loss 1.6169 (1.9316) ce_loss 0.5713 (0.8927) loss_zs_kd 1.7086 (2.2191) loss_oracle 0.5219 (0.5977) acc 78.1250 (68.5000) kd_loss 0.7847 (0.7401) lr 1.3681e-03 eta 0:20:58
epoch [21/50] batch [120/403] time 0.085 (0.101) data 0.000 (0.018) loss 1.9753 (1.9226) ce_loss 0.8789 (0.8873) loss_zs_kd 1.9872 (2.1913) loss_oracle 0.6486 (0.5928) acc 65.6250 (68.6719) kd_loss 0.7720 (0.7389) lr 1.3681e-03 eta 0:20:14
epoch [21/50] batch [140/403] time 0.089 (0.099) data 0.000 (0.016) loss 1.8809 (1.9401) ce_loss 0.8140 (0.9035) loss_zs_kd 1.5851 (2.1748) loss_oracle 0.6842 (0.5928) acc 71.8750 (68.3259) kd_loss 0.7249 (0.7402) lr 1.3681e-03 eta 0:19:43
epoch [21/50] batch [160/403] time 0.090 (0.097) data 0.000 (0.014) loss 1.9536 (1.9364) ce_loss 0.8823 (0.9001) loss_zs_kd 1.9585 (2.1667) loss_oracle 0.5578 (0.5937) acc 65.6250 (68.3789) kd_loss 0.7924 (0.7395) lr 1.3681e-03 eta 0:19:18
epoch [21/50] batch [180/403] time 0.085 (0.096) data 0.000 (0.012) loss 1.9161 (1.9306) ce_loss 0.8369 (0.8939) loss_zs_kd 2.0891 (2.1573) loss_oracle 0.6381 (0.5945) acc 62.5000 (68.4028) kd_loss 0.7602 (0.7395) lr 1.3681e-03 eta 0:18:58
epoch [21/50] batch [200/403] time 0.077 (0.094) data 0.000 (0.011) loss 1.8878 (1.9229) ce_loss 0.8652 (0.8843) loss_zs_kd 1.6435 (2.1649) loss_oracle 0.6147 (0.5963) acc 59.3750 (68.7656) kd_loss 0.7152 (0.7404) lr 1.3681e-03 eta 0:18:41
epoch [21/50] batch [220/403] time 0.084 (0.094) data 0.000 (0.010) loss 1.8295 (1.9196) ce_loss 0.7104 (0.8793) loss_zs_kd 1.9944 (2.1757) loss_oracle 0.6818 (0.5980) acc 71.8750 (68.9205) kd_loss 0.7781 (0.7413) lr 1.3681e-03 eta 0:18:32
epoch [21/50] batch [240/403] time 0.087 (0.093) data 0.000 (0.009) loss 1.9021 (1.9207) ce_loss 0.8989 (0.8799) loss_zs_kd 2.2576 (2.1807) loss_oracle 0.6144 (0.5972) acc 59.3750 (68.9453) kd_loss 0.6960 (0.7422) lr 1.3681e-03 eta 0:18:22
epoch [21/50] batch [260/403] time 0.079 (0.092) data 0.000 (0.009) loss 1.6706 (1.9215) ce_loss 0.5879 (0.8790) loss_zs_kd 2.4259 (2.1862) loss_oracle 0.6692 (0.5978) acc 78.1250 (68.8341) kd_loss 0.7481 (0.7436) lr 1.3681e-03 eta 0:18:12
epoch [21/50] batch [280/403] time 0.088 (0.092) data 0.000 (0.008) loss 1.8859 (1.9230) ce_loss 0.9038 (0.8795) loss_zs_kd 1.8440 (2.1888) loss_oracle 0.5256 (0.5984) acc 62.5000 (68.8281) kd_loss 0.7192 (0.7443) lr 1.3681e-03 eta 0:18:05
epoch [21/50] batch [300/403] time 0.081 (0.091) data 0.000 (0.008) loss 1.9948 (1.9179) ce_loss 0.9619 (0.8747) loss_zs_kd 2.6188 (2.1936) loss_oracle 0.5862 (0.5992) acc 65.6250 (69.0208) kd_loss 0.7398 (0.7436) lr 1.3681e-03 eta 0:17:54
epoch [21/50] batch [320/403] time 0.089 (0.091) data 0.000 (0.007) loss 1.7157 (1.9201) ce_loss 0.6343 (0.8761) loss_zs_kd 2.4320 (2.1930) loss_oracle 0.5887 (0.5993) acc 81.2500 (69.0234) kd_loss 0.7870 (0.7443) lr 1.3681e-03 eta 0:17:46
epoch [21/50] batch [340/403] time 0.078 (0.090) data 0.000 (0.007) loss 1.9861 (1.9209) ce_loss 0.9590 (0.8775) loss_zs_kd 2.7480 (2.1966) loss_oracle 0.6033 (0.5986) acc 62.5000 (68.9062) kd_loss 0.7255 (0.7441) lr 1.3681e-03 eta 0:17:41
epoch [21/50] batch [360/403] time 0.088 (0.090) data 0.000 (0.006) loss 1.9845 (1.9204) ce_loss 0.9604 (0.8762) loss_zs_kd 1.9528 (2.2020) loss_oracle 0.5976 (0.5987) acc 75.0000 (68.8455) kd_loss 0.7253 (0.7448) lr 1.3681e-03 eta 0:17:36
epoch [21/50] batch [380/403] time 0.090 (0.090) data 0.000 (0.006) loss 2.1456 (1.9226) ce_loss 1.1104 (0.8781) loss_zs_kd 2.6739 (2.2148) loss_oracle 0.5505 (0.5993) acc 65.6250 (68.9062) kd_loss 0.7600 (0.7448) lr 1.3681e-03 eta 0:17:32
epoch [21/50] batch [400/403] time 0.077 (0.089) data 0.000 (0.006) loss 1.9194 (1.9219) ce_loss 0.8198 (0.8774) loss_zs_kd 2.6192 (2.2147) loss_oracle 0.6118 (0.5992) acc 68.7500 (68.9766) kd_loss 0.7936 (0.7450) lr 1.3681e-03 eta 0:17:24
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,019
* accuracy: 72.6%
* error: 27.4%
* macro_f1: 59.7%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,487
* accuracy: 42.3%
* error: 57.7%
* macro_f1: 32.2%
******* Domain 4 best val acc:      73.1%, epoch: 18 *******
******* Domain 4 best val test acc: 43.1%, epoch: 18 *******
******* Domain 4 best test acc:     43.6%, epoch: 13 *******
epoch [22/50] batch [20/403] time 0.080 (0.218) data 0.000 (0.131) loss 1.9112 (1.9204) ce_loss 0.8374 (0.8709) loss_zs_kd 2.4739 (2.2099) loss_oracle 0.6840 (0.5973) acc 71.8750 (67.5000) kd_loss 0.7318 (0.7508) lr 1.3090e-03 eta 0:42:22
epoch [22/50] batch [40/403] time 0.087 (0.151) data 0.000 (0.066) loss 2.3103 (1.9125) ce_loss 1.2500 (0.8580) loss_zs_kd 2.5568 (2.3094) loss_oracle 0.6176 (0.5982) acc 50.0000 (68.9062) kd_loss 0.7514 (0.7553) lr 1.3090e-03 eta 0:29:16
epoch [22/50] batch [60/403] time 0.086 (0.129) data 0.000 (0.044) loss 1.9260 (1.9337) ce_loss 0.9019 (0.8819) loss_zs_kd 2.7436 (2.2749) loss_oracle 0.5796 (0.6014) acc 65.6250 (68.3854) kd_loss 0.7343 (0.7511) lr 1.3090e-03 eta 0:25:03
epoch [22/50] batch [80/403] time 0.074 (0.117) data 0.000 (0.033) loss 2.0680 (1.9459) ce_loss 0.9443 (0.8903) loss_zs_kd 2.0846 (2.2865) loss_oracle 0.6299 (0.6024) acc 59.3750 (68.0078) kd_loss 0.8087 (0.7544) lr 1.3090e-03 eta 0:22:43
epoch [22/50] batch [100/403] time 0.080 (0.111) data 0.000 (0.026) loss 1.8256 (1.9324) ce_loss 0.7578 (0.8756) loss_zs_kd 2.3262 (2.2627) loss_oracle 0.6008 (0.6043) acc 71.8750 (68.6875) kd_loss 0.7674 (0.7546) lr 1.3090e-03 eta 0:21:22
epoch [22/50] batch [120/403] time 0.081 (0.106) data 0.000 (0.022) loss 2.0176 (1.9217) ce_loss 0.9521 (0.8614) loss_zs_kd 2.3034 (2.2617) loss_oracle 0.5818 (0.6076) acc 62.5000 (69.0365) kd_loss 0.7746 (0.7565) lr 1.3090e-03 eta 0:20:22
epoch [22/50] batch [140/403] time 0.083 (0.103) data 0.000 (0.019) loss 2.1843 (1.9249) ce_loss 1.1631 (0.8623) loss_zs_kd 2.1202 (2.2684) loss_oracle 0.5805 (0.6086) acc 62.5000 (68.8616) kd_loss 0.7309 (0.7583) lr 1.3090e-03 eta 0:19:44
epoch [22/50] batch [160/403] time 0.076 (0.100) data 0.000 (0.017) loss 1.6503 (1.9208) ce_loss 0.5493 (0.8569) loss_zs_kd 2.2718 (2.2626) loss_oracle 0.5827 (0.6083) acc 78.1250 (69.0820) kd_loss 0.8097 (0.7598) lr 1.3090e-03 eta 0:19:16
epoch [22/50] batch [180/403] time 0.076 (0.098) data 0.000 (0.015) loss 2.1985 (1.9205) ce_loss 1.0811 (0.8565) loss_zs_kd 2.0763 (2.2569) loss_oracle 0.6375 (0.6067) acc 62.5000 (69.1667) kd_loss 0.7988 (0.7606) lr 1.3090e-03 eta 0:18:50
epoch [22/50] batch [200/403] time 0.084 (0.097) data 0.000 (0.013) loss 2.1785 (1.9200) ce_loss 1.0742 (0.8577) loss_zs_kd 2.5339 (2.2644) loss_oracle 0.6562 (0.6063) acc 53.1250 (69.0156) kd_loss 0.7762 (0.7592) lr 1.3090e-03 eta 0:18:29
epoch [22/50] batch [220/403] time 0.084 (0.096) data 0.000 (0.012) loss 1.9929 (1.9202) ce_loss 0.9282 (0.8573) loss_zs_kd 1.7970 (2.2648) loss_oracle 0.6036 (0.6066) acc 65.6250 (69.0057) kd_loss 0.7629 (0.7596) lr 1.3090e-03 eta 0:18:16
epoch [22/50] batch [240/403] time 0.079 (0.095) data 0.000 (0.011) loss 1.7465 (1.9207) ce_loss 0.6782 (0.8588) loss_zs_kd 2.2734 (2.2523) loss_oracle 0.6809 (0.6066) acc 84.3750 (68.9714) kd_loss 0.7278 (0.7586) lr 1.3090e-03 eta 0:18:03
epoch [22/50] batch [260/403] time 0.088 (0.094) data 0.000 (0.010) loss 1.6595 (1.9182) ce_loss 0.6045 (0.8559) loss_zs_kd 2.4226 (2.2565) loss_oracle 0.6106 (0.6064) acc 75.0000 (69.1587) kd_loss 0.7497 (0.7591) lr 1.3090e-03 eta 0:17:52
epoch [22/50] batch [280/403] time 0.094 (0.093) data 0.000 (0.010) loss 1.9018 (1.9187) ce_loss 0.9312 (0.8582) loss_zs_kd 2.3474 (2.2558) loss_oracle 0.5588 (0.6046) acc 59.3750 (69.1741) kd_loss 0.6913 (0.7582) lr 1.3090e-03 eta 0:17:39
epoch [22/50] batch [300/403] time 0.083 (0.092) data 0.000 (0.009) loss 1.5998 (1.9175) ce_loss 0.5630 (0.8585) loss_zs_kd 2.1326 (2.2453) loss_oracle 0.5733 (0.6044) acc 81.2500 (69.2708) kd_loss 0.7501 (0.7568) lr 1.3090e-03 eta 0:17:30
epoch [22/50] batch [320/403] time 0.080 (0.092) data 0.000 (0.008) loss 1.8597 (1.9149) ce_loss 0.7842 (0.8588) loss_zs_kd 2.2751 (2.2355) loss_oracle 0.6815 (0.6027) acc 75.0000 (69.3652) kd_loss 0.7348 (0.7548) lr 1.3090e-03 eta 0:17:20
epoch [22/50] batch [340/403] time 0.078 (0.091) data 0.000 (0.008) loss 2.0354 (1.9157) ce_loss 0.9653 (0.8620) loss_zs_kd 2.2044 (2.2405) loss_oracle 0.5998 (0.6015) acc 68.7500 (69.3474) kd_loss 0.7702 (0.7530) lr 1.3090e-03 eta 0:17:10
epoch [22/50] batch [360/403] time 0.082 (0.090) data 0.000 (0.008) loss 1.8658 (1.9211) ce_loss 0.8657 (0.8686) loss_zs_kd 2.4618 (2.2355) loss_oracle 0.5509 (0.6013) acc 71.8750 (69.0191) kd_loss 0.7247 (0.7518) lr 1.3090e-03 eta 0:17:02
epoch [22/50] batch [380/403] time 0.083 (0.090) data 0.001 (0.007) loss 1.6609 (1.9219) ce_loss 0.6357 (0.8707) loss_zs_kd 2.1939 (2.2302) loss_oracle 0.5717 (0.6012) acc 71.8750 (68.9967) kd_loss 0.7393 (0.7506) lr 1.3090e-03 eta 0:16:54
epoch [22/50] batch [400/403] time 0.077 (0.089) data 0.000 (0.007) loss 1.5551 (1.9215) ce_loss 0.5664 (0.8701) loss_zs_kd 2.2010 (2.2235) loss_oracle 0.4883 (0.6025) acc 71.8750 (69.0625) kd_loss 0.7446 (0.7502) lr 1.3090e-03 eta 0:16:46
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,024
* accuracy: 72.7%
* error: 27.3%
* macro_f1: 60.7%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,393
* accuracy: 40.7%
* error: 59.3%
* macro_f1: 30.8%
******* Domain 4 best val acc:      73.1%, epoch: 18 *******
******* Domain 4 best val test acc: 43.1%, epoch: 18 *******
******* Domain 4 best test acc:     43.6%, epoch: 13 *******
epoch [23/50] batch [20/403] time 0.086 (0.255) data 0.000 (0.169) loss 1.6405 (1.8973) ce_loss 0.5361 (0.8506) loss_zs_kd 2.2316 (2.2182) loss_oracle 0.6725 (0.6073) acc 84.3750 (69.2188) kd_loss 0.7682 (0.7430) lr 1.2487e-03 eta 0:47:52
epoch [23/50] batch [40/403] time 0.079 (0.171) data 0.000 (0.084) loss 1.7138 (1.9329) ce_loss 0.6182 (0.8769) loss_zs_kd 2.2973 (2.2709) loss_oracle 0.6472 (0.6131) acc 75.0000 (68.4375) kd_loss 0.7721 (0.7494) lr 1.2487e-03 eta 0:32:03
epoch [23/50] batch [60/403] time 0.086 (0.142) data 0.000 (0.056) loss 1.9321 (1.9327) ce_loss 0.8809 (0.8749) loss_zs_kd 1.9137 (2.2376) loss_oracle 0.6101 (0.6127) acc 75.0000 (68.8542) kd_loss 0.7462 (0.7513) lr 1.2487e-03 eta 0:26:33
epoch [23/50] batch [80/403] time 0.092 (0.128) data 0.000 (0.042) loss 1.8772 (1.9296) ce_loss 0.8560 (0.8684) loss_zs_kd 2.2881 (2.2645) loss_oracle 0.5680 (0.6143) acc 71.8750 (68.9844) kd_loss 0.7372 (0.7541) lr 1.2487e-03 eta 0:23:50
epoch [23/50] batch [100/403] time 0.088 (0.119) data 0.000 (0.034) loss 1.7072 (1.9305) ce_loss 0.6450 (0.8667) loss_zs_kd 2.1171 (2.2783) loss_oracle 0.6590 (0.6170) acc 81.2500 (69.2188) kd_loss 0.7326 (0.7553) lr 1.2487e-03 eta 0:22:06
epoch [23/50] batch [120/403] time 0.074 (0.112) data 0.000 (0.028) loss 1.8826 (1.9325) ce_loss 0.8862 (0.8693) loss_zs_kd 2.2612 (2.2972) loss_oracle 0.4833 (0.6162) acc 71.8750 (69.0104) kd_loss 0.7547 (0.7552) lr 1.2487e-03 eta 0:20:53
epoch [23/50] batch [140/403] time 0.081 (0.108) data 0.000 (0.024) loss 2.0838 (1.9424) ce_loss 0.9897 (0.8780) loss_zs_kd 2.2238 (2.2781) loss_oracle 0.6103 (0.6167) acc 65.6250 (68.7277) kd_loss 0.7890 (0.7561) lr 1.2487e-03 eta 0:20:06
epoch [23/50] batch [160/403] time 0.081 (0.106) data 0.000 (0.021) loss 1.6382 (1.9388) ce_loss 0.6152 (0.8744) loss_zs_kd 2.3786 (2.2695) loss_oracle 0.5452 (0.6161) acc 81.2500 (69.0430) kd_loss 0.7504 (0.7564) lr 1.2487e-03 eta 0:19:35
epoch [23/50] batch [180/403] time 0.099 (0.104) data 0.000 (0.019) loss 1.8898 (1.9393) ce_loss 0.7822 (0.8746) loss_zs_kd 2.6980 (2.2576) loss_oracle 0.5761 (0.6158) acc 68.7500 (69.0278) kd_loss 0.8196 (0.7568) lr 1.2487e-03 eta 0:19:10
epoch [23/50] batch [200/403] time 0.084 (0.102) data 0.000 (0.017) loss 1.7206 (1.9362) ce_loss 0.6807 (0.8713) loss_zs_kd 2.5892 (2.2603) loss_oracle 0.6452 (0.6165) acc 75.0000 (69.1562) kd_loss 0.7174 (0.7566) lr 1.2487e-03 eta 0:18:49
epoch [23/50] batch [220/403] time 0.080 (0.100) data 0.000 (0.016) loss 1.8834 (1.9368) ce_loss 0.8682 (0.8724) loss_zs_kd 2.5843 (2.2568) loss_oracle 0.6106 (0.6152) acc 65.6250 (69.0483) kd_loss 0.7100 (0.7568) lr 1.2487e-03 eta 0:18:30
epoch [23/50] batch [240/403] time 0.080 (0.099) data 0.000 (0.014) loss 1.7241 (1.9291) ce_loss 0.6572 (0.8651) loss_zs_kd 2.1044 (2.2524) loss_oracle 0.6126 (0.6144) acc 68.7500 (69.2188) kd_loss 0.7606 (0.7568) lr 1.2487e-03 eta 0:18:12
epoch [23/50] batch [260/403] time 0.081 (0.098) data 0.000 (0.013) loss 1.7831 (1.9251) ce_loss 0.8135 (0.8618) loss_zs_kd 2.0076 (2.2595) loss_oracle 0.5707 (0.6138) acc 68.7500 (69.3149) kd_loss 0.6843 (0.7564) lr 1.2487e-03 eta 0:17:58
epoch [23/50] batch [280/403] time 0.085 (0.097) data 0.000 (0.012) loss 2.0159 (1.9303) ce_loss 0.9673 (0.8662) loss_zs_kd 2.2664 (2.2583) loss_oracle 0.5443 (0.6142) acc 62.5000 (69.1629) kd_loss 0.7765 (0.7571) lr 1.2487e-03 eta 0:17:44
epoch [23/50] batch [300/403] time 0.082 (0.096) data 0.000 (0.012) loss 1.6860 (1.9302) ce_loss 0.6270 (0.8660) loss_zs_kd 2.8836 (2.2621) loss_oracle 0.5279 (0.6141) acc 68.7500 (69.1250) kd_loss 0.7951 (0.7571) lr 1.2487e-03 eta 0:17:29
epoch [23/50] batch [320/403] time 0.082 (0.095) data 0.000 (0.011) loss 2.1877 (1.9278) ce_loss 1.1846 (0.8637) loss_zs_kd 2.0522 (2.2656) loss_oracle 0.5927 (0.6143) acc 53.1250 (69.2188) kd_loss 0.7067 (0.7569) lr 1.2487e-03 eta 0:17:21
epoch [23/50] batch [340/403] time 0.082 (0.094) data 0.000 (0.010) loss 1.9067 (1.9309) ce_loss 0.7705 (0.8667) loss_zs_kd 2.4021 (2.2714) loss_oracle 0.6418 (0.6155) acc 75.0000 (69.2188) kd_loss 0.8153 (0.7564) lr 1.2487e-03 eta 0:17:13
epoch [23/50] batch [360/403] time 0.074 (0.094) data 0.000 (0.010) loss 1.8310 (1.9303) ce_loss 0.6694 (0.8658) loss_zs_kd 2.3224 (2.2719) loss_oracle 0.6846 (0.6156) acc 81.2500 (69.2535) kd_loss 0.8193 (0.7567) lr 1.2487e-03 eta 0:17:04
epoch [23/50] batch [380/403] time 0.086 (0.093) data 0.000 (0.009) loss 1.8302 (1.9304) ce_loss 0.7676 (0.8664) loss_zs_kd 1.8116 (2.2597) loss_oracle 0.5669 (0.6150) acc 65.6250 (69.2023) kd_loss 0.7791 (0.7566) lr 1.2487e-03 eta 0:16:56
epoch [23/50] batch [400/403] time 0.076 (0.093) data 0.000 (0.009) loss 2.1644 (1.9323) ce_loss 1.0967 (0.8692) loss_zs_kd 2.4289 (2.2507) loss_oracle 0.6250 (0.6133) acc 62.5000 (69.1250) kd_loss 0.7552 (0.7565) lr 1.2487e-03 eta 0:16:48
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,028
* accuracy: 72.8%
* error: 27.2%
* macro_f1: 61.3%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,578
* accuracy: 43.8%
* error: 56.2%
* macro_f1: 33.3%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      73.1%, epoch: 18 *******
******* Domain 4 best val test acc: 43.1%, epoch: 18 *******
******* Domain 4 best test acc:     43.8%, epoch: 23 *******
epoch [24/50] batch [20/403] time 0.080 (0.211) data 0.000 (0.123) loss 1.8454 (1.9742) ce_loss 0.7402 (0.9065) loss_zs_kd 2.5057 (2.2085) loss_oracle 0.5887 (0.6182) acc 78.1250 (66.5625) kd_loss 0.8108 (0.7586) lr 1.1874e-03 eta 0:38:10
epoch [24/50] batch [40/403] time 0.062 (0.143) data 0.000 (0.061) loss 1.6873 (1.9475) ce_loss 0.6304 (0.8818) loss_zs_kd 1.8649 (2.1244) loss_oracle 0.6148 (0.6135) acc 75.0000 (68.0469) kd_loss 0.7496 (0.7589) lr 1.1874e-03 eta 0:25:52
epoch [24/50] batch [60/403] time 0.080 (0.122) data 0.000 (0.041) loss 1.9559 (1.9356) ce_loss 0.8306 (0.8692) loss_zs_kd 1.7886 (2.1664) loss_oracle 0.6343 (0.6108) acc 68.7500 (69.1667) kd_loss 0.8082 (0.7610) lr 1.1874e-03 eta 0:22:01
epoch [24/50] batch [80/403] time 0.092 (0.113) data 0.000 (0.031) loss 2.4629 (1.9491) ce_loss 1.4326 (0.8846) loss_zs_kd 2.4209 (2.1881) loss_oracle 0.5792 (0.6165) acc 46.8750 (68.6719) kd_loss 0.7407 (0.7562) lr 1.1874e-03 eta 0:20:17
epoch [24/50] batch [100/403] time 0.081 (0.105) data 0.000 (0.025) loss 1.8333 (1.9441) ce_loss 0.7495 (0.8791) loss_zs_kd 1.9861 (2.1685) loss_oracle 0.6448 (0.6177) acc 71.8750 (68.8438) kd_loss 0.7614 (0.7561) lr 1.1874e-03 eta 0:18:46
epoch [24/50] batch [120/403] time 0.086 (0.100) data 0.000 (0.021) loss 1.8314 (1.9434) ce_loss 0.7979 (0.8800) loss_zs_kd 2.3088 (2.1572) loss_oracle 0.5169 (0.6170) acc 59.3750 (68.6979) kd_loss 0.7751 (0.7549) lr 1.1874e-03 eta 0:18:00
epoch [24/50] batch [140/403] time 0.081 (0.098) data 0.000 (0.018) loss 1.9516 (1.9351) ce_loss 0.8618 (0.8722) loss_zs_kd 2.8335 (2.1896) loss_oracle 0.6346 (0.6176) acc 75.0000 (68.9509) kd_loss 0.7725 (0.7541) lr 1.1874e-03 eta 0:17:29
epoch [24/50] batch [160/403] time 0.088 (0.096) data 0.000 (0.016) loss 2.2074 (1.9305) ce_loss 1.1436 (0.8699) loss_zs_kd 2.3423 (2.2016) loss_oracle 0.6007 (0.6154) acc 56.2500 (69.0820) kd_loss 0.7635 (0.7529) lr 1.1874e-03 eta 0:17:08
epoch [24/50] batch [180/403] time 0.088 (0.096) data 0.000 (0.014) loss 2.0042 (1.9341) ce_loss 1.0205 (0.8759) loss_zs_kd 2.5857 (2.2007) loss_oracle 0.6029 (0.6129) acc 68.7500 (68.8542) kd_loss 0.6823 (0.7517) lr 1.1874e-03 eta 0:17:09
epoch [24/50] batch [200/403] time 0.081 (0.095) data 0.000 (0.013) loss 1.9628 (1.9233) ce_loss 0.9136 (0.8655) loss_zs_kd 2.6792 (2.2171) loss_oracle 0.6207 (0.6122) acc 68.7500 (69.3125) kd_loss 0.7389 (0.7516) lr 1.1874e-03 eta 0:16:57
epoch [24/50] batch [220/403] time 0.088 (0.094) data 0.000 (0.011) loss 1.8857 (1.9304) ce_loss 0.9292 (0.8752) loss_zs_kd 2.3537 (2.2163) loss_oracle 0.5562 (0.6091) acc 68.7500 (68.8494) kd_loss 0.6784 (0.7507) lr 1.1874e-03 eta 0:16:42
epoch [24/50] batch [240/403] time 0.071 (0.093) data 0.000 (0.010) loss 1.6894 (1.9249) ce_loss 0.6436 (0.8707) loss_zs_kd 1.7360 (2.2212) loss_oracle 0.6072 (0.6084) acc 81.2500 (69.0885) kd_loss 0.7422 (0.7501) lr 1.1874e-03 eta 0:16:28
epoch [24/50] batch [260/403] time 0.095 (0.092) data 0.000 (0.010) loss 2.0479 (1.9261) ce_loss 1.0264 (0.8716) loss_zs_kd 2.4847 (2.2181) loss_oracle 0.6074 (0.6101) acc 59.3750 (69.1346) kd_loss 0.7178 (0.7495) lr 1.1874e-03 eta 0:16:19
epoch [24/50] batch [280/403] time 0.086 (0.092) data 0.000 (0.009) loss 1.7861 (1.9261) ce_loss 0.7280 (0.8720) loss_zs_kd 2.4174 (2.2169) loss_oracle 0.6052 (0.6091) acc 78.1250 (69.3192) kd_loss 0.7554 (0.7496) lr 1.1874e-03 eta 0:16:11
epoch [24/50] batch [300/403] time 0.085 (0.091) data 0.000 (0.008) loss 1.8331 (1.9300) ce_loss 0.8110 (0.8760) loss_zs_kd 2.1580 (2.2253) loss_oracle 0.6191 (0.6084) acc 71.8750 (69.0938) kd_loss 0.7125 (0.7498) lr 1.1874e-03 eta 0:16:05
epoch [24/50] batch [320/403] time 0.087 (0.091) data 0.000 (0.008) loss 2.3679 (1.9302) ce_loss 1.2373 (0.8763) loss_zs_kd 2.2423 (2.2304) loss_oracle 0.6510 (0.6080) acc 59.3750 (69.0527) kd_loss 0.8051 (0.7500) lr 1.1874e-03 eta 0:15:56
epoch [24/50] batch [340/403] time 0.081 (0.090) data 0.000 (0.007) loss 1.9734 (1.9290) ce_loss 0.8613 (0.8749) loss_zs_kd 2.6526 (2.2408) loss_oracle 0.6878 (0.6085) acc 68.7500 (69.0809) kd_loss 0.7682 (0.7498) lr 1.1874e-03 eta 0:15:51
epoch [24/50] batch [360/403] time 0.083 (0.090) data 0.000 (0.007) loss 1.9072 (1.9310) ce_loss 0.8291 (0.8766) loss_zs_kd 2.1290 (2.2411) loss_oracle 0.5994 (0.6087) acc 68.7500 (69.0104) kd_loss 0.7783 (0.7500) lr 1.1874e-03 eta 0:15:44
epoch [24/50] batch [380/403] time 0.083 (0.089) data 0.001 (0.007) loss 1.9154 (1.9294) ce_loss 0.8945 (0.8753) loss_zs_kd 2.3648 (2.2460) loss_oracle 0.6526 (0.6086) acc 68.7500 (69.0296) kd_loss 0.6946 (0.7498) lr 1.1874e-03 eta 0:15:37
epoch [24/50] batch [400/403] time 0.077 (0.089) data 0.000 (0.006) loss 1.9627 (1.9291) ce_loss 0.8994 (0.8757) loss_zs_kd 1.7436 (2.2541) loss_oracle 0.7030 (0.6079) acc 62.5000 (68.9922) kd_loss 0.7118 (0.7494) lr 1.1874e-03 eta 0:15:32
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,941
* accuracy: 71.2%
* error: 28.8%
* macro_f1: 57.4%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,318
* accuracy: 39.4%
* error: 60.6%
* macro_f1: 28.3%
******* Domain 4 best val acc:      73.1%, epoch: 18 *******
******* Domain 4 best val test acc: 43.1%, epoch: 18 *******
******* Domain 4 best test acc:     43.8%, epoch: 23 *******
epoch [25/50] batch [20/403] time 0.082 (0.240) data 0.000 (0.152) loss 1.8423 (1.9020) ce_loss 0.8228 (0.8527) loss_zs_kd 2.2332 (2.2346) loss_oracle 0.5544 (0.5871) acc 71.8750 (71.4062) kd_loss 0.7423 (0.7557) lr 1.1253e-03 eta 0:41:49
epoch [25/50] batch [40/403] time 0.058 (0.155) data 0.000 (0.076) loss 1.7293 (1.9428) ce_loss 0.7217 (0.8874) loss_zs_kd 2.1670 (2.2323) loss_oracle 0.5634 (0.5902) acc 68.7500 (68.0469) kd_loss 0.7259 (0.7604) lr 1.1253e-03 eta 0:27:02
epoch [25/50] batch [60/403] time 0.083 (0.131) data 0.000 (0.051) loss 2.2097 (1.9394) ce_loss 1.0830 (0.8791) loss_zs_kd 2.4425 (2.2863) loss_oracle 0.6778 (0.6042) acc 62.5000 (68.3854) kd_loss 0.7878 (0.7582) lr 1.1253e-03 eta 0:22:43
epoch [25/50] batch [80/403] time 0.082 (0.119) data 0.000 (0.038) loss 2.0808 (1.9418) ce_loss 1.1123 (0.8804) loss_zs_kd 1.8435 (2.3066) loss_oracle 0.5730 (0.6080) acc 53.1250 (68.1641) kd_loss 0.6820 (0.7574) lr 1.1253e-03 eta 0:20:38
epoch [25/50] batch [100/403] time 0.084 (0.112) data 0.000 (0.031) loss 1.7236 (1.9343) ce_loss 0.6157 (0.8755) loss_zs_kd 2.1914 (2.3270) loss_oracle 0.6384 (0.6078) acc 78.1250 (68.3750) kd_loss 0.7887 (0.7549) lr 1.1253e-03 eta 0:19:23
epoch [25/50] batch [120/403] time 0.079 (0.107) data 0.000 (0.026) loss 1.7896 (1.9150) ce_loss 0.7544 (0.8586) loss_zs_kd 2.3664 (2.3277) loss_oracle 0.5988 (0.6074) acc 71.8750 (69.3229) kd_loss 0.7358 (0.7528) lr 1.1253e-03 eta 0:18:27
epoch [25/50] batch [140/403] time 0.084 (0.103) data 0.000 (0.022) loss 1.8218 (1.9167) ce_loss 0.7310 (0.8593) loss_zs_kd 2.5866 (2.3396) loss_oracle 0.6548 (0.6100) acc 75.0000 (69.1518) kd_loss 0.7634 (0.7524) lr 1.1253e-03 eta 0:17:43
epoch [25/50] batch [160/403] time 0.087 (0.101) data 0.000 (0.019) loss 1.9462 (1.9186) ce_loss 0.9541 (0.8628) loss_zs_kd 1.8483 (2.3254) loss_oracle 0.5127 (0.6077) acc 65.6250 (68.9844) kd_loss 0.7358 (0.7519) lr 1.1253e-03 eta 0:17:17
epoch [25/50] batch [180/403] time 0.081 (0.099) data 0.000 (0.017) loss 1.9763 (1.9200) ce_loss 0.9141 (0.8644) loss_zs_kd 2.2506 (2.3025) loss_oracle 0.5946 (0.6061) acc 68.7500 (69.0799) kd_loss 0.7649 (0.7525) lr 1.1253e-03 eta 0:16:54
epoch [25/50] batch [200/403] time 0.069 (0.097) data 0.000 (0.015) loss 1.6216 (1.9170) ce_loss 0.5728 (0.8654) loss_zs_kd 1.9472 (2.2967) loss_oracle 0.5542 (0.6038) acc 87.5000 (69.1250) kd_loss 0.7717 (0.7497) lr 1.1253e-03 eta 0:16:36
epoch [25/50] batch [220/403] time 0.082 (0.096) data 0.000 (0.014) loss 2.6938 (1.9225) ce_loss 1.6621 (0.8700) loss_zs_kd 2.2084 (2.2903) loss_oracle 0.6076 (0.6051) acc 43.7500 (69.1477) kd_loss 0.7280 (0.7500) lr 1.1253e-03 eta 0:16:20
epoch [25/50] batch [240/403] time 0.086 (0.095) data 0.000 (0.013) loss 1.8154 (1.9197) ce_loss 0.8164 (0.8679) loss_zs_kd 2.0097 (2.2869) loss_oracle 0.5920 (0.6065) acc 68.7500 (69.3359) kd_loss 0.7030 (0.7486) lr 1.1253e-03 eta 0:16:10
epoch [25/50] batch [260/403] time 0.084 (0.094) data 0.000 (0.012) loss 2.0236 (1.9158) ce_loss 0.9189 (0.8643) loss_zs_kd 2.3798 (2.2765) loss_oracle 0.5911 (0.6065) acc 68.7500 (69.5072) kd_loss 0.8091 (0.7481) lr 1.1253e-03 eta 0:16:00
epoch [25/50] batch [280/403] time 0.086 (0.093) data 0.000 (0.011) loss 2.0873 (1.9169) ce_loss 0.9546 (0.8645) loss_zs_kd 2.2506 (2.2802) loss_oracle 0.7303 (0.6083) acc 62.5000 (69.5312) kd_loss 0.7676 (0.7482) lr 1.1253e-03 eta 0:15:51
epoch [25/50] batch [300/403] time 0.081 (0.093) data 0.000 (0.010) loss 2.0911 (1.9204) ce_loss 0.9951 (0.8670) loss_zs_kd 2.4488 (2.2841) loss_oracle 0.6772 (0.6107) acc 59.3750 (69.4062) kd_loss 0.7574 (0.7480) lr 1.1253e-03 eta 0:15:44
epoch [25/50] batch [320/403] time 0.082 (0.092) data 0.000 (0.010) loss 1.6826 (1.9189) ce_loss 0.6069 (0.8651) loss_zs_kd 1.7540 (2.2815) loss_oracle 0.6075 (0.6117) acc 75.0000 (69.4238) kd_loss 0.7719 (0.7479) lr 1.1253e-03 eta 0:15:38
epoch [25/50] batch [340/403] time 0.086 (0.092) data 0.000 (0.009) loss 1.9467 (1.9188) ce_loss 0.8374 (0.8652) loss_zs_kd 2.4250 (2.2797) loss_oracle 0.6424 (0.6126) acc 65.6250 (69.4485) kd_loss 0.7881 (0.7473) lr 1.1253e-03 eta 0:15:30
epoch [25/50] batch [360/403] time 0.084 (0.091) data 0.000 (0.009) loss 1.7839 (1.9174) ce_loss 0.6973 (0.8637) loss_zs_kd 2.9360 (2.2850) loss_oracle 0.6708 (0.6137) acc 78.1250 (69.4965) kd_loss 0.7512 (0.7469) lr 1.1253e-03 eta 0:15:22
epoch [25/50] batch [380/403] time 0.084 (0.090) data 0.000 (0.008) loss 1.8991 (1.9177) ce_loss 0.8086 (0.8640) loss_zs_kd 2.2216 (2.2840) loss_oracle 0.7234 (0.6149) acc 68.7500 (69.4490) kd_loss 0.7288 (0.7462) lr 1.1253e-03 eta 0:15:13
epoch [25/50] batch [400/403] time 0.079 (0.090) data 0.000 (0.008) loss 1.9189 (1.9176) ce_loss 0.8115 (0.8647) loss_zs_kd 2.5316 (2.2837) loss_oracle 0.6545 (0.6155) acc 75.0000 (69.3281) kd_loss 0.7801 (0.7452) lr 1.1253e-03 eta 0:15:05
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,043
* accuracy: 73.0%
* error: 27.0%
* macro_f1: 62.3%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,547
* accuracy: 43.3%
* error: 56.7%
* macro_f1: 32.1%
******* Domain 4 best val acc:      73.1%, epoch: 18 *******
******* Domain 4 best val test acc: 43.1%, epoch: 18 *******
******* Domain 4 best test acc:     43.8%, epoch: 23 *******
epoch [26/50] batch [20/403] time 0.085 (0.212) data 0.000 (0.128) loss 2.0349 (1.9569) ce_loss 0.9917 (0.9123) loss_zs_kd 2.6564 (2.3243) loss_oracle 0.6354 (0.6342) acc 65.6250 (68.5938) kd_loss 0.7255 (0.7275) lr 1.0628e-03 eta 0:35:36
epoch [26/50] batch [40/403] time 0.062 (0.148) data 0.000 (0.064) loss 1.6901 (1.9240) ce_loss 0.6514 (0.8861) loss_zs_kd 2.1486 (2.2753) loss_oracle 0.6675 (0.6192) acc 81.2500 (69.5312) kd_loss 0.7050 (0.7283) lr 1.0628e-03 eta 0:24:45
epoch [26/50] batch [60/403] time 0.075 (0.123) data 0.000 (0.043) loss 1.7873 (1.9137) ce_loss 0.8003 (0.8766) loss_zs_kd 2.4670 (2.3231) loss_oracle 0.6090 (0.6106) acc 75.0000 (69.1667) kd_loss 0.6825 (0.7318) lr 1.0628e-03 eta 0:20:32
epoch [26/50] batch [80/403] time 0.081 (0.112) data 0.000 (0.032) loss 1.9123 (1.9084) ce_loss 0.8213 (0.8732) loss_zs_kd 2.3787 (2.3121) loss_oracle 0.6318 (0.6066) acc 75.0000 (69.6875) kd_loss 0.7751 (0.7319) lr 1.0628e-03 eta 0:18:41
epoch [26/50] batch [100/403] time 0.075 (0.105) data 0.000 (0.026) loss 1.9655 (1.9037) ce_loss 0.9604 (0.8684) loss_zs_kd 1.7100 (2.3225) loss_oracle 0.6245 (0.6054) acc 59.3750 (69.8125) kd_loss 0.6929 (0.7326) lr 1.0628e-03 eta 0:17:30
epoch [26/50] batch [120/403] time 0.084 (0.101) data 0.000 (0.022) loss 2.3306 (1.9048) ce_loss 1.2061 (0.8709) loss_zs_kd 2.3990 (2.3268) loss_oracle 0.6550 (0.6038) acc 46.8750 (69.3490) kd_loss 0.7971 (0.7320) lr 1.0628e-03 eta 0:16:45
epoch [26/50] batch [140/403] time 0.084 (0.099) data 0.000 (0.019) loss 1.7769 (1.8991) ce_loss 0.7207 (0.8679) loss_zs_kd 2.5964 (2.3020) loss_oracle 0.6378 (0.6037) acc 81.2500 (69.3973) kd_loss 0.7373 (0.7293) lr 1.0628e-03 eta 0:16:21
epoch [26/50] batch [160/403] time 0.080 (0.097) data 0.000 (0.016) loss 2.0025 (1.9050) ce_loss 0.9507 (0.8707) loss_zs_kd 2.5979 (2.3149) loss_oracle 0.6396 (0.6053) acc 59.3750 (69.4727) kd_loss 0.7321 (0.7317) lr 1.0628e-03 eta 0:16:01
epoch [26/50] batch [180/403] time 0.081 (0.095) data 0.000 (0.015) loss 1.8723 (1.9016) ce_loss 0.8335 (0.8651) loss_zs_kd 2.0510 (2.3046) loss_oracle 0.6124 (0.6066) acc 75.0000 (69.6875) kd_loss 0.7326 (0.7332) lr 1.0628e-03 eta 0:15:44
epoch [26/50] batch [200/403] time 0.085 (0.094) data 0.000 (0.013) loss 1.7064 (1.9002) ce_loss 0.6533 (0.8612) loss_zs_kd 1.8945 (2.2993) loss_oracle 0.6199 (0.6099) acc 81.2500 (69.8125) kd_loss 0.7432 (0.7341) lr 1.0628e-03 eta 0:15:29
epoch [26/50] batch [220/403] time 0.076 (0.093) data 0.000 (0.012) loss 1.6220 (1.9009) ce_loss 0.6372 (0.8607) loss_zs_kd 2.6618 (2.3081) loss_oracle 0.5467 (0.6103) acc 81.2500 (69.6307) kd_loss 0.7114 (0.7350) lr 1.0628e-03 eta 0:15:17
epoch [26/50] batch [240/403] time 0.087 (0.093) data 0.000 (0.011) loss 1.7524 (1.8986) ce_loss 0.6997 (0.8580) loss_zs_kd 2.3637 (2.3176) loss_oracle 0.5276 (0.6113) acc 78.1250 (69.7917) kd_loss 0.7889 (0.7349) lr 1.0628e-03 eta 0:15:10
epoch [26/50] batch [260/403] time 0.082 (0.092) data 0.000 (0.010) loss 2.0752 (1.9031) ce_loss 1.0352 (0.8613) loss_zs_kd 2.0400 (2.3139) loss_oracle 0.6053 (0.6107) acc 50.0000 (69.4832) kd_loss 0.7374 (0.7364) lr 1.0628e-03 eta 0:15:03
epoch [26/50] batch [280/403] time 0.077 (0.091) data 0.000 (0.009) loss 1.7771 (1.9028) ce_loss 0.7285 (0.8604) loss_zs_kd 2.3287 (2.3121) loss_oracle 0.6222 (0.6110) acc 68.7500 (69.5424) kd_loss 0.7374 (0.7369) lr 1.0628e-03 eta 0:14:52
epoch [26/50] batch [300/403] time 0.081 (0.090) data 0.000 (0.009) loss 1.7938 (1.9052) ce_loss 0.7891 (0.8610) loss_zs_kd 2.2624 (2.3153) loss_oracle 0.5842 (0.6118) acc 75.0000 (69.5521) kd_loss 0.7126 (0.7383) lr 1.0628e-03 eta 0:14:43
epoch [26/50] batch [320/403] time 0.084 (0.090) data 0.000 (0.008) loss 1.8881 (1.9017) ce_loss 0.9219 (0.8574) loss_zs_kd 2.0838 (2.3168) loss_oracle 0.5878 (0.6115) acc 75.0000 (69.7852) kd_loss 0.6724 (0.7386) lr 1.0628e-03 eta 0:14:37
epoch [26/50] batch [340/403] time 0.082 (0.089) data 0.000 (0.008) loss 1.8154 (1.9016) ce_loss 0.7656 (0.8564) loss_zs_kd 2.2776 (2.3197) loss_oracle 0.5600 (0.6128) acc 71.8750 (69.7610) kd_loss 0.7698 (0.7388) lr 1.0628e-03 eta 0:14:30
epoch [26/50] batch [360/403] time 0.092 (0.089) data 0.000 (0.007) loss 2.1301 (1.9065) ce_loss 1.0068 (0.8610) loss_zs_kd 2.6680 (2.3238) loss_oracle 0.6666 (0.6120) acc 53.1250 (69.5399) kd_loss 0.7900 (0.7395) lr 1.0628e-03 eta 0:14:24
epoch [26/50] batch [380/403] time 0.081 (0.089) data 0.000 (0.007) loss 2.0949 (1.9090) ce_loss 0.9990 (0.8630) loss_zs_kd 1.9368 (2.3199) loss_oracle 0.5985 (0.6117) acc 65.6250 (69.5148) kd_loss 0.7967 (0.7402) lr 1.0628e-03 eta 0:14:18
epoch [26/50] batch [400/403] time 0.080 (0.088) data 0.000 (0.007) loss 1.9634 (1.9094) ce_loss 0.8828 (0.8632) loss_zs_kd 2.6727 (2.3193) loss_oracle 0.6991 (0.6120) acc 71.8750 (69.4531) kd_loss 0.7310 (0.7402) lr 1.0628e-03 eta 0:14:11
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,061
* accuracy: 73.4%
* error: 26.6%
* macro_f1: 61.0%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,508
* accuracy: 42.6%
* error: 57.4%
* macro_f1: 33.0%
******* Domain 4 best val acc:      73.4%, epoch: 26 *******
******* Domain 4 best val test acc: 42.6%, epoch: 26 *******
******* Domain 4 best test acc:     43.8%, epoch: 23 *******
epoch [27/50] batch [20/403] time 0.084 (0.247) data 0.000 (0.168) loss 2.0581 (1.9196) ce_loss 0.9673 (0.8563) loss_zs_kd 2.2374 (2.3113) loss_oracle 0.6343 (0.6175) acc 68.7500 (69.3750) kd_loss 0.7736 (0.7545) lr 1.0000e-03 eta 0:39:47
epoch [27/50] batch [40/403] time 0.081 (0.165) data 0.000 (0.084) loss 1.9915 (1.9137) ce_loss 0.8706 (0.8492) loss_zs_kd 2.6945 (2.3075) loss_oracle 0.6346 (0.6155) acc 71.8750 (70.0781) kd_loss 0.8036 (0.7567) lr 1.0000e-03 eta 0:26:30
epoch [27/50] batch [60/403] time 0.078 (0.137) data 0.000 (0.056) loss 1.7983 (1.9124) ce_loss 0.7441 (0.8443) loss_zs_kd 2.3485 (2.3922) loss_oracle 0.6933 (0.6194) acc 75.0000 (69.7396) kd_loss 0.7075 (0.7585) lr 1.0000e-03 eta 0:22:00
epoch [27/50] batch [80/403] time 0.090 (0.125) data 0.000 (0.042) loss 2.1171 (1.9126) ce_loss 1.0684 (0.8455) loss_zs_kd 2.9153 (2.3694) loss_oracle 0.6093 (0.6214) acc 56.2500 (70.0781) kd_loss 0.7441 (0.7565) lr 1.0000e-03 eta 0:19:56
epoch [27/50] batch [100/403] time 0.085 (0.117) data 0.000 (0.034) loss 1.8700 (1.9066) ce_loss 0.8823 (0.8421) loss_zs_kd 2.3600 (2.3745) loss_oracle 0.6355 (0.6206) acc 75.0000 (70.3750) kd_loss 0.6700 (0.7541) lr 1.0000e-03 eta 0:18:41
epoch [27/50] batch [120/403] time 0.097 (0.111) data 0.000 (0.028) loss 1.9816 (1.9118) ce_loss 0.9761 (0.8465) loss_zs_kd 2.3606 (2.3799) loss_oracle 0.5696 (0.6201) acc 65.6250 (70.1042) kd_loss 0.7207 (0.7553) lr 1.0000e-03 eta 0:17:42
epoch [27/50] batch [140/403] time 0.075 (0.107) data 0.000 (0.024) loss 1.9662 (1.9181) ce_loss 0.9131 (0.8550) loss_zs_kd 2.1619 (2.3846) loss_oracle 0.6263 (0.6179) acc 62.5000 (69.6429) kd_loss 0.7400 (0.7542) lr 1.0000e-03 eta 0:17:01
epoch [27/50] batch [160/403] time 0.083 (0.104) data 0.000 (0.021) loss 2.0236 (1.9188) ce_loss 1.0586 (0.8571) loss_zs_kd 2.0909 (2.3832) loss_oracle 0.5435 (0.6181) acc 62.5000 (69.6094) kd_loss 0.6933 (0.7526) lr 1.0000e-03 eta 0:16:31
epoch [27/50] batch [180/403] time 0.077 (0.102) data 0.000 (0.019) loss 2.2246 (1.9155) ce_loss 1.1533 (0.8535) loss_zs_kd 2.3588 (2.3733) loss_oracle 0.6547 (0.6201) acc 65.6250 (69.8438) kd_loss 0.7439 (0.7519) lr 1.0000e-03 eta 0:16:04
epoch [27/50] batch [200/403] time 0.080 (0.100) data 0.000 (0.017) loss 1.9814 (1.9137) ce_loss 0.9038 (0.8521) loss_zs_kd 2.2457 (2.3845) loss_oracle 0.5589 (0.6200) acc 71.8750 (69.7188) kd_loss 0.7982 (0.7516) lr 1.0000e-03 eta 0:15:44
epoch [27/50] batch [220/403] time 0.084 (0.098) data 0.000 (0.016) loss 2.0069 (1.9204) ce_loss 0.9458 (0.8616) loss_zs_kd 1.7858 (2.3854) loss_oracle 0.5214 (0.6170) acc 71.8750 (69.2898) kd_loss 0.8004 (0.7504) lr 1.0000e-03 eta 0:15:23
epoch [27/50] batch [240/403] time 0.093 (0.097) data 0.000 (0.014) loss 2.1484 (1.9205) ce_loss 1.1035 (0.8630) loss_zs_kd 2.1371 (2.3708) loss_oracle 0.5677 (0.6155) acc 62.5000 (69.3359) kd_loss 0.7611 (0.7497) lr 1.0000e-03 eta 0:15:11
epoch [27/50] batch [260/403] time 0.086 (0.096) data 0.000 (0.013) loss 2.0009 (1.9230) ce_loss 0.9438 (0.8659) loss_zs_kd 1.9098 (2.3661) loss_oracle 0.5431 (0.6139) acc 62.5000 (69.2788) kd_loss 0.7855 (0.7501) lr 1.0000e-03 eta 0:15:01
epoch [27/50] batch [280/403] time 0.087 (0.095) data 0.000 (0.012) loss 1.9733 (1.9227) ce_loss 0.9131 (0.8652) loss_zs_kd 2.5408 (2.3665) loss_oracle 0.6674 (0.6141) acc 75.0000 (69.2969) kd_loss 0.7265 (0.7504) lr 1.0000e-03 eta 0:14:52
epoch [27/50] batch [300/403] time 0.080 (0.094) data 0.000 (0.011) loss 1.8944 (1.9222) ce_loss 0.8589 (0.8657) loss_zs_kd 1.9078 (2.3543) loss_oracle 0.6229 (0.6121) acc 75.0000 (69.1875) kd_loss 0.7241 (0.7505) lr 1.0000e-03 eta 0:14:44
epoch [27/50] batch [320/403] time 0.088 (0.094) data 0.000 (0.011) loss 1.7542 (1.9202) ce_loss 0.6895 (0.8637) loss_zs_kd 2.3832 (2.3433) loss_oracle 0.6267 (0.6114) acc 71.8750 (69.2383) kd_loss 0.7513 (0.7508) lr 1.0000e-03 eta 0:14:36
epoch [27/50] batch [340/403] time 0.086 (0.093) data 0.000 (0.010) loss 2.1397 (1.9248) ce_loss 1.0430 (0.8677) loss_zs_kd 2.1823 (2.3394) loss_oracle 0.5648 (0.6110) acc 68.7500 (69.1360) kd_loss 0.8143 (0.7516) lr 1.0000e-03 eta 0:14:30
epoch [27/50] batch [360/403] time 0.089 (0.093) data 0.000 (0.010) loss 2.1483 (1.9241) ce_loss 1.0508 (0.8664) loss_zs_kd 2.5653 (2.3365) loss_oracle 0.6655 (0.6115) acc 59.3750 (69.2448) kd_loss 0.7648 (0.7520) lr 1.0000e-03 eta 0:14:24
epoch [27/50] batch [380/403] time 0.082 (0.092) data 0.000 (0.009) loss 1.7973 (1.9228) ce_loss 0.7344 (0.8649) loss_zs_kd 2.2168 (2.3322) loss_oracle 0.6292 (0.6119) acc 75.0000 (69.3257) kd_loss 0.7483 (0.7520) lr 1.0000e-03 eta 0:14:18
epoch [27/50] batch [400/403] time 0.076 (0.092) data 0.000 (0.009) loss 1.9572 (1.9227) ce_loss 0.9141 (0.8652) loss_zs_kd 2.6986 (2.3269) loss_oracle 0.7345 (0.6117) acc 71.8750 (69.3438) kd_loss 0.6759 (0.7516) lr 1.0000e-03 eta 0:14:11
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,025
* accuracy: 72.7%
* error: 27.3%
* macro_f1: 59.9%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,614
* accuracy: 44.4%
* error: 55.6%
* macro_f1: 33.3%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      73.4%, epoch: 26 *******
******* Domain 4 best val test acc: 42.6%, epoch: 26 *******
******* Domain 4 best test acc:     44.4%, epoch: 27 *******
epoch [28/50] batch [20/403] time 0.082 (0.224) data 0.000 (0.137) loss 1.9953 (1.9305) ce_loss 0.8838 (0.8663) loss_zs_kd 2.8512 (2.3284) loss_oracle 0.6468 (0.6288) acc 56.2500 (69.0625) kd_loss 0.7881 (0.7498) lr 9.3721e-04 eta 0:34:27
epoch [28/50] batch [40/403] time 0.084 (0.154) data 0.000 (0.069) loss 2.1610 (1.9128) ce_loss 1.1309 (0.8573) loss_zs_kd 2.1908 (2.3601) loss_oracle 0.5888 (0.6214) acc 62.5000 (69.6875) kd_loss 0.7357 (0.7448) lr 9.3721e-04 eta 0:23:40
epoch [28/50] batch [60/403] time 0.087 (0.130) data 0.000 (0.046) loss 1.8948 (1.9354) ce_loss 0.8447 (0.8774) loss_zs_kd 2.6290 (2.3605) loss_oracle 0.6146 (0.6180) acc 71.8750 (69.2188) kd_loss 0.7427 (0.7490) lr 9.3721e-04 eta 0:19:55
epoch [28/50] batch [80/403] time 0.088 (0.118) data 0.000 (0.035) loss 1.9218 (1.9066) ce_loss 0.8643 (0.8491) loss_zs_kd 2.4814 (2.3379) loss_oracle 0.5918 (0.6227) acc 68.7500 (70.3906) kd_loss 0.7617 (0.7461) lr 9.3721e-04 eta 0:18:05
epoch [28/50] batch [100/403] time 0.078 (0.110) data 0.000 (0.028) loss 1.9503 (1.9153) ce_loss 0.8955 (0.8587) loss_zs_kd 1.8945 (2.3199) loss_oracle 0.5494 (0.6218) acc 68.7500 (69.7500) kd_loss 0.7801 (0.7457) lr 9.3721e-04 eta 0:16:51
epoch [28/50] batch [120/403] time 0.082 (0.106) data 0.000 (0.023) loss 2.1372 (1.9080) ce_loss 1.0322 (0.8498) loss_zs_kd 2.2543 (2.3276) loss_oracle 0.6355 (0.6243) acc 53.1250 (70.1302) kd_loss 0.7872 (0.7460) lr 9.3721e-04 eta 0:16:10
epoch [28/50] batch [140/403] time 0.076 (0.102) data 0.000 (0.020) loss 1.8218 (1.9012) ce_loss 0.8062 (0.8450) loss_zs_kd 2.3002 (2.3272) loss_oracle 0.6302 (0.6226) acc 68.7500 (70.5357) kd_loss 0.7005 (0.7449) lr 9.3721e-04 eta 0:15:34
epoch [28/50] batch [160/403] time 0.078 (0.100) data 0.000 (0.017) loss 1.4902 (1.9041) ce_loss 0.5044 (0.8488) loss_zs_kd 2.3190 (2.3420) loss_oracle 0.4856 (0.6203) acc 84.3750 (70.1562) kd_loss 0.7430 (0.7451) lr 9.3721e-04 eta 0:15:10
epoch [28/50] batch [180/403] time 0.087 (0.098) data 0.000 (0.016) loss 1.9871 (1.9025) ce_loss 0.9253 (0.8470) loss_zs_kd 2.2035 (2.3520) loss_oracle 0.6376 (0.6205) acc 62.5000 (70.0868) kd_loss 0.7431 (0.7453) lr 9.3721e-04 eta 0:14:54
epoch [28/50] batch [200/403] time 0.088 (0.097) data 0.000 (0.014) loss 1.8830 (1.8977) ce_loss 0.8242 (0.8430) loss_zs_kd 2.3409 (2.3467) loss_oracle 0.6815 (0.6186) acc 65.6250 (70.1406) kd_loss 0.7180 (0.7453) lr 9.3721e-04 eta 0:14:41
epoch [28/50] batch [220/403] time 0.084 (0.096) data 0.000 (0.013) loss 2.2452 (1.9009) ce_loss 1.1201 (0.8470) loss_zs_kd 2.6272 (2.3500) loss_oracle 0.6147 (0.6165) acc 65.6250 (70.0710) kd_loss 0.8178 (0.7456) lr 9.3721e-04 eta 0:14:30
epoch [28/50] batch [240/403] time 0.084 (0.095) data 0.000 (0.012) loss 1.6964 (1.9043) ce_loss 0.6831 (0.8513) loss_zs_kd 2.3670 (2.3408) loss_oracle 0.5876 (0.6148) acc 81.2500 (69.9219) kd_loss 0.7195 (0.7456) lr 9.3721e-04 eta 0:14:19
epoch [28/50] batch [260/403] time 0.099 (0.095) data 0.000 (0.011) loss 1.7664 (1.9028) ce_loss 0.7744 (0.8507) loss_zs_kd 2.1586 (2.3389) loss_oracle 0.5482 (0.6144) acc 71.8750 (69.9519) kd_loss 0.7179 (0.7450) lr 9.3721e-04 eta 0:14:12
epoch [28/50] batch [280/403] time 0.083 (0.094) data 0.000 (0.010) loss 1.5574 (1.9008) ce_loss 0.5020 (0.8487) loss_zs_kd 2.4617 (2.3352) loss_oracle 0.5874 (0.6135) acc 90.6250 (70.1339) kd_loss 0.7617 (0.7454) lr 9.3721e-04 eta 0:14:06
epoch [28/50] batch [300/403] time 0.084 (0.093) data 0.000 (0.009) loss 1.8699 (1.8995) ce_loss 0.7827 (0.8481) loss_zs_kd 2.4703 (2.3367) loss_oracle 0.6506 (0.6125) acc 75.0000 (70.1458) kd_loss 0.7619 (0.7451) lr 9.3721e-04 eta 0:13:58
epoch [28/50] batch [320/403] time 0.088 (0.093) data 0.000 (0.009) loss 1.8385 (1.9007) ce_loss 0.7993 (0.8494) loss_zs_kd 1.5763 (2.3283) loss_oracle 0.6090 (0.6120) acc 68.7500 (70.1465) kd_loss 0.7347 (0.7453) lr 9.3721e-04 eta 0:13:52
epoch [28/50] batch [340/403] time 0.078 (0.092) data 0.000 (0.008) loss 1.5948 (1.9005) ce_loss 0.6787 (0.8504) loss_zs_kd 2.0644 (2.3274) loss_oracle 0.5151 (0.6117) acc 68.7500 (70.1195) kd_loss 0.6586 (0.7442) lr 9.3721e-04 eta 0:13:44
epoch [28/50] batch [360/403] time 0.078 (0.092) data 0.000 (0.008) loss 1.8284 (1.9000) ce_loss 0.8003 (0.8508) loss_zs_kd 1.9536 (2.3239) loss_oracle 0.5909 (0.6108) acc 68.7500 (70.1389) kd_loss 0.7326 (0.7438) lr 9.3721e-04 eta 0:13:36
epoch [28/50] batch [380/403] time 0.084 (0.091) data 0.000 (0.008) loss 1.6050 (1.9006) ce_loss 0.6104 (0.8513) loss_zs_kd 2.1111 (2.3163) loss_oracle 0.5965 (0.6105) acc 78.1250 (70.1727) kd_loss 0.6964 (0.7441) lr 9.3721e-04 eta 0:13:31
epoch [28/50] batch [400/403] time 0.078 (0.091) data 0.000 (0.007) loss 2.1176 (1.9010) ce_loss 1.0703 (0.8521) loss_zs_kd 2.2136 (2.3173) loss_oracle 0.5715 (0.6098) acc 65.6250 (70.0703) kd_loss 0.7616 (0.7440) lr 9.3721e-04 eta 0:13:25
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,035
* accuracy: 72.9%
* error: 27.1%
* macro_f1: 61.1%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,515
* accuracy: 42.8%
* error: 57.2%
* macro_f1: 31.5%
******* Domain 4 best val acc:      73.4%, epoch: 26 *******
******* Domain 4 best val test acc: 42.6%, epoch: 26 *******
******* Domain 4 best test acc:     44.4%, epoch: 27 *******
epoch [29/50] batch [20/403] time 0.079 (0.288) data 0.000 (0.208) loss 1.7750 (1.9063) ce_loss 0.7651 (0.8493) loss_zs_kd 1.9902 (2.4045) loss_oracle 0.5692 (0.6147) acc 71.8750 (71.2500) kd_loss 0.7253 (0.7496) lr 8.7467e-04 eta 0:42:31
epoch [29/50] batch [40/403] time 0.090 (0.188) data 0.000 (0.104) loss 1.9548 (1.9026) ce_loss 0.8823 (0.8497) loss_zs_kd 1.8879 (2.3546) loss_oracle 0.6851 (0.6159) acc 65.6250 (69.6875) kd_loss 0.7299 (0.7449) lr 8.7467e-04 eta 0:27:38
epoch [29/50] batch [60/403] time 0.082 (0.154) data 0.000 (0.070) loss 1.9784 (1.9080) ce_loss 0.9453 (0.8530) loss_zs_kd 2.3481 (2.3041) loss_oracle 0.5103 (0.6157) acc 75.0000 (69.4271) kd_loss 0.7779 (0.7471) lr 8.7467e-04 eta 0:22:38
epoch [29/50] batch [80/403] time 0.092 (0.137) data 0.000 (0.052) loss 2.2396 (1.9046) ce_loss 1.2227 (0.8522) loss_zs_kd 2.5074 (2.3017) loss_oracle 0.5738 (0.6118) acc 62.5000 (69.7266) kd_loss 0.7300 (0.7465) lr 8.7467e-04 eta 0:20:06
epoch [29/50] batch [100/403] time 0.077 (0.126) data 0.000 (0.042) loss 1.8615 (1.9066) ce_loss 0.8364 (0.8556) loss_zs_kd 2.1241 (2.2683) loss_oracle 0.6010 (0.6085) acc 75.0000 (69.7812) kd_loss 0.7245 (0.7467) lr 8.7467e-04 eta 0:18:26
epoch [29/50] batch [120/403] time 0.086 (0.119) data 0.000 (0.035) loss 1.8080 (1.9203) ce_loss 0.7466 (0.8695) loss_zs_kd 1.9465 (2.2747) loss_oracle 0.6382 (0.6093) acc 75.0000 (69.1667) kd_loss 0.7424 (0.7462) lr 8.7467e-04 eta 0:17:20
epoch [29/50] batch [140/403] time 0.092 (0.114) data 0.000 (0.030) loss 1.9358 (1.9125) ce_loss 0.8643 (0.8635) loss_zs_kd 2.5302 (2.2681) loss_oracle 0.5956 (0.6059) acc 68.7500 (69.3080) kd_loss 0.7738 (0.7461) lr 8.7467e-04 eta 0:16:37
epoch [29/50] batch [160/403] time 0.081 (0.110) data 0.000 (0.026) loss 1.7676 (1.9027) ce_loss 0.6924 (0.8573) loss_zs_kd 2.7377 (2.2674) loss_oracle 0.5855 (0.6016) acc 68.7500 (69.4727) kd_loss 0.7824 (0.7446) lr 8.7467e-04 eta 0:16:00
epoch [29/50] batch [180/403] time 0.090 (0.107) data 0.000 (0.023) loss 1.5825 (1.9044) ce_loss 0.4858 (0.8575) loss_zs_kd 2.5536 (2.2856) loss_oracle 0.6406 (0.6042) acc 87.5000 (69.5660) kd_loss 0.7763 (0.7448) lr 8.7467e-04 eta 0:15:31
epoch [29/50] batch [200/403] time 0.089 (0.105) data 0.000 (0.021) loss 1.7594 (1.9009) ce_loss 0.6069 (0.8538) loss_zs_kd 3.3138 (2.3102) loss_oracle 0.6762 (0.6055) acc 75.0000 (69.8438) kd_loss 0.8143 (0.7443) lr 8.7467e-04 eta 0:15:12
epoch [29/50] batch [220/403] time 0.085 (0.104) data 0.000 (0.019) loss 1.7645 (1.9013) ce_loss 0.7153 (0.8519) loss_zs_kd 2.4650 (2.3089) loss_oracle 0.6073 (0.6079) acc 81.2500 (70.0142) kd_loss 0.7456 (0.7454) lr 8.7467e-04 eta 0:14:55
epoch [29/50] batch [240/403] time 0.088 (0.102) data 0.000 (0.018) loss 1.9940 (1.8987) ce_loss 1.0479 (0.8502) loss_zs_kd 2.8394 (2.3158) loss_oracle 0.5059 (0.6067) acc 62.5000 (69.9349) kd_loss 0.6931 (0.7452) lr 8.7467e-04 eta 0:14:40
epoch [29/50] batch [260/403] time 0.097 (0.101) data 0.000 (0.016) loss 1.8206 (1.8993) ce_loss 0.7705 (0.8510) loss_zs_kd 2.2201 (2.3270) loss_oracle 0.6063 (0.6070) acc 71.8750 (69.8798) kd_loss 0.7469 (0.7448) lr 8.7467e-04 eta 0:14:28
epoch [29/50] batch [280/403] time 0.082 (0.099) data 0.000 (0.015) loss 1.6607 (1.8992) ce_loss 0.5942 (0.8505) loss_zs_kd 2.7437 (2.3297) loss_oracle 0.5940 (0.6078) acc 81.2500 (69.9442) kd_loss 0.7695 (0.7449) lr 8.7467e-04 eta 0:14:13
epoch [29/50] batch [300/403] time 0.078 (0.099) data 0.000 (0.014) loss 2.0287 (1.9007) ce_loss 0.9482 (0.8507) loss_zs_kd 2.8132 (2.3387) loss_oracle 0.6225 (0.6087) acc 68.7500 (70.0417) kd_loss 0.7692 (0.7456) lr 8.7467e-04 eta 0:14:04
epoch [29/50] batch [320/403] time 0.083 (0.098) data 0.000 (0.013) loss 2.0496 (1.9013) ce_loss 1.0586 (0.8510) loss_zs_kd 2.1621 (2.3460) loss_oracle 0.5238 (0.6088) acc 65.6250 (69.8535) kd_loss 0.7291 (0.7459) lr 8.7467e-04 eta 0:13:53
epoch [29/50] batch [340/403] time 0.087 (0.097) data 0.000 (0.013) loss 2.0859 (1.9030) ce_loss 1.0420 (0.8539) loss_zs_kd 2.7125 (2.3469) loss_oracle 0.5967 (0.6078) acc 68.7500 (69.7151) kd_loss 0.7456 (0.7452) lr 8.7467e-04 eta 0:13:45
epoch [29/50] batch [360/403] time 0.096 (0.096) data 0.000 (0.012) loss 2.5559 (1.9015) ce_loss 1.4414 (0.8531) loss_zs_kd 2.2130 (2.3490) loss_oracle 0.6800 (0.6073) acc 53.1250 (69.7483) kd_loss 0.7745 (0.7447) lr 8.7467e-04 eta 0:13:37
epoch [29/50] batch [380/403] time 0.086 (0.095) data 0.000 (0.011) loss 1.7939 (1.9063) ce_loss 0.7622 (0.8582) loss_zs_kd 2.5176 (2.3531) loss_oracle 0.6512 (0.6073) acc 62.5000 (69.5148) kd_loss 0.7061 (0.7445) lr 8.7467e-04 eta 0:13:28
epoch [29/50] batch [400/403] time 0.088 (0.095) data 0.000 (0.011) loss 1.8658 (1.9050) ce_loss 0.8496 (0.8579) loss_zs_kd 2.1412 (2.3451) loss_oracle 0.6253 (0.6062) acc 71.8750 (69.6016) kd_loss 0.7036 (0.7440) lr 8.7467e-04 eta 0:13:21
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,042
* accuracy: 73.0%
* error: 27.0%
* macro_f1: 61.7%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,628
* accuracy: 44.7%
* error: 55.3%
* macro_f1: 33.2%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      73.4%, epoch: 26 *******
******* Domain 4 best val test acc: 42.6%, epoch: 26 *******
******* Domain 4 best test acc:     44.7%, epoch: 29 *******
epoch [30/50] batch [20/403] time 0.061 (0.226) data 0.000 (0.158) loss 1.8187 (1.8737) ce_loss 0.7432 (0.8437) loss_zs_kd 2.0015 (2.3963) loss_oracle 0.6308 (0.5910) acc 68.7500 (68.9062) kd_loss 0.7602 (0.7345) lr 8.1262e-04 eta 0:31:49
epoch [30/50] batch [40/403] time 0.084 (0.153) data 0.000 (0.079) loss 1.7394 (1.8848) ce_loss 0.6592 (0.8567) loss_zs_kd 2.4306 (2.3821) loss_oracle 0.6150 (0.5865) acc 78.1250 (68.5938) kd_loss 0.7727 (0.7349) lr 8.1262e-04 eta 0:21:28
epoch [30/50] batch [60/403] time 0.087 (0.131) data 0.000 (0.053) loss 1.9156 (1.8803) ce_loss 0.8276 (0.8562) loss_zs_kd 2.0413 (2.3595) loss_oracle 0.6527 (0.5879) acc 75.0000 (69.0625) kd_loss 0.7616 (0.7301) lr 8.1262e-04 eta 0:18:18
epoch [30/50] batch [80/403] time 0.081 (0.118) data 0.000 (0.040) loss 1.7040 (1.8683) ce_loss 0.6675 (0.8392) loss_zs_kd 2.3845 (2.3386) loss_oracle 0.5320 (0.5926) acc 78.1250 (69.7656) kd_loss 0.7705 (0.7328) lr 8.1262e-04 eta 0:16:33
epoch [30/50] batch [100/403] time 0.088 (0.112) data 0.000 (0.032) loss 1.7557 (1.8647) ce_loss 0.6230 (0.8279) loss_zs_kd 2.5448 (2.3577) loss_oracle 0.6905 (0.5981) acc 75.0000 (70.3750) kd_loss 0.7874 (0.7378) lr 8.1262e-04 eta 0:15:33
epoch [30/50] batch [120/403] time 0.079 (0.107) data 0.000 (0.027) loss 2.0918 (1.8636) ce_loss 1.0479 (0.8255) loss_zs_kd 2.3638 (2.3806) loss_oracle 0.6170 (0.5989) acc 62.5000 (70.0521) kd_loss 0.7354 (0.7386) lr 8.1262e-04 eta 0:14:53
epoch [30/50] batch [140/403] time 0.088 (0.103) data 0.000 (0.023) loss 1.6011 (1.8654) ce_loss 0.6763 (0.8273) loss_zs_kd 1.9634 (2.3668) loss_oracle 0.4937 (0.5972) acc 81.2500 (69.9107) kd_loss 0.6780 (0.7395) lr 8.1262e-04 eta 0:14:20
epoch [30/50] batch [160/403] time 0.099 (0.101) data 0.000 (0.020) loss 1.9578 (1.8683) ce_loss 0.8765 (0.8297) loss_zs_kd 2.6527 (2.3674) loss_oracle 0.5819 (0.5985) acc 68.7500 (69.9805) kd_loss 0.7904 (0.7393) lr 8.1262e-04 eta 0:13:58
epoch [30/50] batch [180/403] time 0.082 (0.099) data 0.000 (0.018) loss 1.6845 (1.8734) ce_loss 0.6523 (0.8331) loss_zs_kd 2.3628 (2.3737) loss_oracle 0.5781 (0.5995) acc 78.1250 (70.0868) kd_loss 0.7431 (0.7406) lr 8.1262e-04 eta 0:13:42
epoch [30/50] batch [200/403] time 0.085 (0.098) data 0.001 (0.016) loss 1.7927 (1.8718) ce_loss 0.8208 (0.8335) loss_zs_kd 1.9304 (2.3611) loss_oracle 0.5357 (0.5960) acc 59.3750 (69.9688) kd_loss 0.7041 (0.7403) lr 8.1262e-04 eta 0:13:27
epoch [30/50] batch [220/403] time 0.085 (0.097) data 0.000 (0.015) loss 1.9991 (1.8741) ce_loss 0.8931 (0.8355) loss_zs_kd 2.5681 (2.3681) loss_oracle 0.6759 (0.5967) acc 65.6250 (69.9006) kd_loss 0.7681 (0.7403) lr 8.1262e-04 eta 0:13:16
epoch [30/50] batch [240/403] time 0.077 (0.095) data 0.000 (0.013) loss 2.0225 (1.8788) ce_loss 1.0684 (0.8433) loss_zs_kd 2.2784 (2.3591) loss_oracle 0.5388 (0.5943) acc 68.7500 (69.8438) kd_loss 0.6848 (0.7384) lr 8.1262e-04 eta 0:13:04
epoch [30/50] batch [260/403] time 0.082 (0.094) data 0.000 (0.012) loss 1.8440 (1.8783) ce_loss 0.7568 (0.8426) loss_zs_kd 2.2692 (2.3606) loss_oracle 0.6616 (0.5948) acc 75.0000 (69.7716) kd_loss 0.7564 (0.7383) lr 8.1262e-04 eta 0:12:52
epoch [30/50] batch [280/403] time 0.078 (0.093) data 0.000 (0.012) loss 2.2369 (1.8839) ce_loss 1.1797 (0.8483) loss_zs_kd 2.5381 (2.3639) loss_oracle 0.5792 (0.5941) acc 53.1250 (69.6987) kd_loss 0.7676 (0.7386) lr 8.1262e-04 eta 0:12:45
epoch [30/50] batch [300/403] time 0.083 (0.093) data 0.000 (0.011) loss 1.9758 (1.8873) ce_loss 0.9639 (0.8514) loss_zs_kd 2.5996 (2.3670) loss_oracle 0.6166 (0.5951) acc 68.7500 (69.6458) kd_loss 0.7036 (0.7384) lr 8.1262e-04 eta 0:12:36
epoch [30/50] batch [320/403] time 0.089 (0.092) data 0.000 (0.010) loss 2.2894 (1.8866) ce_loss 1.1562 (0.8514) loss_zs_kd 2.6322 (2.3590) loss_oracle 0.6700 (0.5941) acc 59.3750 (69.6680) kd_loss 0.7982 (0.7381) lr 8.1262e-04 eta 0:12:29
epoch [30/50] batch [340/403] time 0.085 (0.092) data 0.000 (0.010) loss 1.7469 (1.8878) ce_loss 0.6934 (0.8526) loss_zs_kd 2.2069 (2.3519) loss_oracle 0.5742 (0.5941) acc 78.1250 (69.7335) kd_loss 0.7665 (0.7382) lr 8.1262e-04 eta 0:12:25
epoch [30/50] batch [360/403] time 0.082 (0.091) data 0.000 (0.009) loss 1.9763 (1.8857) ce_loss 0.8638 (0.8508) loss_zs_kd 2.3547 (2.3518) loss_oracle 0.7231 (0.5947) acc 62.5000 (69.8003) kd_loss 0.7510 (0.7376) lr 8.1262e-04 eta 0:12:19
epoch [30/50] batch [380/403] time 0.089 (0.091) data 0.000 (0.009) loss 1.7643 (1.8869) ce_loss 0.7583 (0.8529) loss_zs_kd 2.0426 (2.3536) loss_oracle 0.6175 (0.5944) acc 78.1250 (69.7204) kd_loss 0.6973 (0.7368) lr 8.1262e-04 eta 0:12:14
epoch [30/50] batch [400/403] time 0.080 (0.090) data 0.000 (0.008) loss 1.8690 (1.8853) ce_loss 0.8340 (0.8514) loss_zs_kd 2.6739 (2.3503) loss_oracle 0.6949 (0.5948) acc 65.6250 (69.7578) kd_loss 0.6876 (0.7364) lr 8.1262e-04 eta 0:12:09
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,044
* accuracy: 73.1%
* error: 26.9%
* macro_f1: 61.4%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,673
* accuracy: 45.4%
* error: 54.6%
* macro_f1: 35.1%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      73.4%, epoch: 26 *******
******* Domain 4 best val test acc: 42.6%, epoch: 26 *******
******* Domain 4 best test acc:     45.4%, epoch: 30 *******
epoch [31/50] batch [20/403] time 0.094 (0.222) data 0.000 (0.135) loss 1.7049 (1.8750) ce_loss 0.8296 (0.8646) loss_zs_kd 1.7987 (2.2693) loss_oracle 0.5184 (0.6077) acc 71.8750 (70.0000) kd_loss 0.6162 (0.7066) lr 7.5131e-04 eta 0:29:45
epoch [31/50] batch [40/403] time 0.083 (0.154) data 0.000 (0.068) loss 1.6609 (1.8721) ce_loss 0.6851 (0.8570) loss_zs_kd 2.2824 (2.3205) loss_oracle 0.6231 (0.6066) acc 75.0000 (70.5469) kd_loss 0.6643 (0.7118) lr 7.5131e-04 eta 0:20:31
epoch [31/50] batch [60/403] time 0.084 (0.131) data 0.001 (0.045) loss 1.7357 (1.8773) ce_loss 0.6719 (0.8561) loss_zs_kd 2.3980 (2.3581) loss_oracle 0.6316 (0.6040) acc 81.2500 (69.6354) kd_loss 0.7480 (0.7191) lr 7.5131e-04 eta 0:17:26
epoch [31/50] batch [80/403] time 0.087 (0.119) data 0.000 (0.034) loss 1.9752 (1.8820) ce_loss 1.0312 (0.8556) loss_zs_kd 2.2287 (2.3566) loss_oracle 0.5683 (0.6062) acc 68.7500 (69.9609) kd_loss 0.6599 (0.7233) lr 7.5131e-04 eta 0:15:46
epoch [31/50] batch [100/403] time 0.082 (0.111) data 0.000 (0.027) loss 1.6729 (1.8852) ce_loss 0.6431 (0.8568) loss_zs_kd 2.3181 (2.3463) loss_oracle 0.5905 (0.6074) acc 87.5000 (69.7188) kd_loss 0.7345 (0.7246) lr 7.5131e-04 eta 0:14:44
epoch [31/50] batch [120/403] time 0.077 (0.106) data 0.000 (0.023) loss 1.8652 (1.8853) ce_loss 0.7681 (0.8533) loss_zs_kd 2.4500 (2.3483) loss_oracle 0.6032 (0.6096) acc 78.1250 (70.0260) kd_loss 0.7955 (0.7271) lr 7.5131e-04 eta 0:14:01
epoch [31/50] batch [140/403] time 0.087 (0.103) data 0.000 (0.020) loss 1.9777 (1.8890) ce_loss 0.9575 (0.8558) loss_zs_kd 2.1392 (2.3518) loss_oracle 0.5259 (0.6074) acc 68.7500 (70.2902) kd_loss 0.7572 (0.7295) lr 7.5131e-04 eta 0:13:36
epoch [31/50] batch [160/403] time 0.091 (0.101) data 0.000 (0.017) loss 1.9405 (1.8936) ce_loss 0.8862 (0.8615) loss_zs_kd 2.0606 (2.3658) loss_oracle 0.6006 (0.6038) acc 59.3750 (69.9414) kd_loss 0.7540 (0.7302) lr 7.5131e-04 eta 0:13:15
epoch [31/50] batch [180/403] time 0.085 (0.099) data 0.000 (0.015) loss 1.9126 (1.8925) ce_loss 0.8716 (0.8599) loss_zs_kd 2.6590 (2.3507) loss_oracle 0.5597 (0.6026) acc 75.0000 (69.8438) kd_loss 0.7612 (0.7313) lr 7.5131e-04 eta 0:12:58
epoch [31/50] batch [200/403] time 0.084 (0.098) data 0.000 (0.014) loss 2.0904 (1.8900) ce_loss 1.0303 (0.8566) loss_zs_kd 2.0598 (2.3534) loss_oracle 0.6477 (0.6036) acc 59.3750 (70.1250) kd_loss 0.7363 (0.7316) lr 7.5131e-04 eta 0:12:46
epoch [31/50] batch [220/403] time 0.082 (0.096) data 0.000 (0.013) loss 1.7903 (1.8852) ce_loss 0.8091 (0.8537) loss_zs_kd 2.3162 (2.3495) loss_oracle 0.5631 (0.6030) acc 71.8750 (70.2557) kd_loss 0.6997 (0.7300) lr 7.5131e-04 eta 0:12:34
epoch [31/50] batch [240/403] time 0.081 (0.095) data 0.000 (0.012) loss 1.6895 (1.8831) ce_loss 0.5991 (0.8525) loss_zs_kd 2.5326 (2.3469) loss_oracle 0.6153 (0.6034) acc 78.1250 (70.1823) kd_loss 0.7827 (0.7288) lr 7.5131e-04 eta 0:12:24
epoch [31/50] batch [260/403] time 0.087 (0.094) data 0.000 (0.011) loss 1.6726 (1.8821) ce_loss 0.6689 (0.8531) loss_zs_kd 2.4779 (2.3468) loss_oracle 0.5058 (0.6019) acc 78.1250 (70.1803) kd_loss 0.7508 (0.7280) lr 7.5131e-04 eta 0:12:15
epoch [31/50] batch [280/403] time 0.081 (0.094) data 0.000 (0.010) loss 1.8109 (1.8838) ce_loss 0.7720 (0.8551) loss_zs_kd 2.3646 (2.3476) loss_oracle 0.6498 (0.6011) acc 65.6250 (69.9554) kd_loss 0.7140 (0.7281) lr 7.5131e-04 eta 0:12:08
epoch [31/50] batch [300/403] time 0.082 (0.093) data 0.000 (0.009) loss 2.0525 (1.8833) ce_loss 1.0762 (0.8563) loss_zs_kd 2.4362 (2.3511) loss_oracle 0.5408 (0.5995) acc 65.6250 (70.0625) kd_loss 0.7059 (0.7272) lr 7.5131e-04 eta 0:12:04
epoch [31/50] batch [320/403] time 0.077 (0.094) data 0.000 (0.009) loss 1.9351 (1.8797) ce_loss 0.8345 (0.8536) loss_zs_kd 2.3856 (2.3419) loss_oracle 0.6144 (0.5983) acc 68.7500 (70.1074) kd_loss 0.7935 (0.7270) lr 7.5131e-04 eta 0:12:06
epoch [31/50] batch [340/403] time 0.082 (0.093) data 0.000 (0.008) loss 1.7967 (1.8785) ce_loss 0.7124 (0.8527) loss_zs_kd 2.5448 (2.3407) loss_oracle 0.6642 (0.5975) acc 68.7500 (69.9816) kd_loss 0.7522 (0.7271) lr 7.5131e-04 eta 0:11:59
epoch [31/50] batch [360/403] time 0.098 (0.093) data 0.000 (0.008) loss 1.8827 (1.8784) ce_loss 0.8472 (0.8535) loss_zs_kd 3.0136 (2.3475) loss_oracle 0.5617 (0.5972) acc 62.5000 (69.8524) kd_loss 0.7547 (0.7264) lr 7.5131e-04 eta 0:11:52
epoch [31/50] batch [380/403] time 0.080 (0.092) data 0.000 (0.007) loss 1.9288 (1.8797) ce_loss 0.8252 (0.8541) loss_zs_kd 2.4507 (2.3496) loss_oracle 0.7037 (0.5968) acc 71.8750 (69.8684) kd_loss 0.7518 (0.7273) lr 7.5131e-04 eta 0:11:47
epoch [31/50] batch [400/403] time 0.080 (0.092) data 0.000 (0.007) loss 1.8705 (1.8801) ce_loss 0.9917 (0.8536) loss_zs_kd 2.3589 (2.3553) loss_oracle 0.5755 (0.5979) acc 62.5000 (69.8750) kd_loss 0.5910 (0.7275) lr 7.5131e-04 eta 0:11:42
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,061
* accuracy: 73.4%
* error: 26.6%
* macro_f1: 61.9%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,435
* accuracy: 41.4%
* error: 58.6%
* macro_f1: 29.8%
******* Domain 4 best val acc:      73.4%, epoch: 26 *******
******* Domain 4 best val test acc: 42.6%, epoch: 26 *******
******* Domain 4 best test acc:     45.4%, epoch: 30 *******
epoch [32/50] batch [20/403] time 0.075 (0.198) data 0.000 (0.113) loss 1.8687 (1.8819) ce_loss 0.8105 (0.8514) loss_zs_kd 2.5101 (2.5382) loss_oracle 0.5691 (0.6015) acc 71.8750 (71.0938) kd_loss 0.7736 (0.7297) lr 6.9098e-04 eta 0:25:09
epoch [32/50] batch [40/403] time 0.082 (0.141) data 0.000 (0.057) loss 1.7700 (1.8611) ce_loss 0.7319 (0.8315) loss_zs_kd 2.6773 (2.4267) loss_oracle 0.5972 (0.6031) acc 81.2500 (71.4844) kd_loss 0.7394 (0.7280) lr 6.9098e-04 eta 0:17:57
epoch [32/50] batch [60/403] time 0.081 (0.122) data 0.001 (0.038) loss 1.6928 (1.8732) ce_loss 0.6416 (0.8419) loss_zs_kd 2.7914 (2.4807) loss_oracle 0.6446 (0.5989) acc 87.5000 (70.3646) kd_loss 0.7289 (0.7319) lr 6.9098e-04 eta 0:15:26
epoch [32/50] batch [80/403] time 0.089 (0.112) data 0.000 (0.029) loss 1.8600 (1.8703) ce_loss 0.8101 (0.8409) loss_zs_kd 2.3288 (2.4429) loss_oracle 0.6044 (0.5953) acc 71.8750 (70.1953) kd_loss 0.7477 (0.7318) lr 6.9098e-04 eta 0:14:12
epoch [32/50] batch [100/403] time 0.079 (0.107) data 0.000 (0.023) loss 1.6555 (1.8752) ce_loss 0.6221 (0.8454) loss_zs_kd 1.9871 (2.4429) loss_oracle 0.6211 (0.5939) acc 81.2500 (69.6875) kd_loss 0.7228 (0.7329) lr 6.9098e-04 eta 0:13:25
epoch [32/50] batch [120/403] time 0.089 (0.103) data 0.000 (0.019) loss 1.9280 (1.8795) ce_loss 0.8989 (0.8484) loss_zs_kd 2.6505 (2.4300) loss_oracle 0.6002 (0.5942) acc 75.0000 (69.6875) kd_loss 0.7290 (0.7340) lr 6.9098e-04 eta 0:12:52
epoch [32/50] batch [140/403] time 0.086 (0.100) data 0.000 (0.016) loss 1.9560 (1.8782) ce_loss 0.9023 (0.8437) loss_zs_kd 2.2839 (2.4474) loss_oracle 0.6885 (0.6015) acc 78.1250 (69.8661) kd_loss 0.7094 (0.7338) lr 6.9098e-04 eta 0:12:30
epoch [32/50] batch [160/403] time 0.083 (0.097) data 0.000 (0.014) loss 2.0876 (1.8827) ce_loss 1.0117 (0.8475) loss_zs_kd 2.4809 (2.4432) loss_oracle 0.6006 (0.6012) acc 62.5000 (69.7461) kd_loss 0.7755 (0.7346) lr 6.9098e-04 eta 0:12:10
epoch [32/50] batch [180/403] time 0.080 (0.096) data 0.000 (0.013) loss 1.7032 (1.8836) ce_loss 0.7354 (0.8509) loss_zs_kd 1.8102 (2.4326) loss_oracle 0.5572 (0.6006) acc 78.1250 (69.5312) kd_loss 0.6892 (0.7324) lr 6.9098e-04 eta 0:11:56
epoch [32/50] batch [200/403] time 0.077 (0.094) data 0.000 (0.012) loss 1.7916 (1.8827) ce_loss 0.7378 (0.8511) loss_zs_kd 2.2863 (2.4347) loss_oracle 0.6023 (0.5989) acc 71.8750 (69.3906) kd_loss 0.7527 (0.7321) lr 6.9098e-04 eta 0:11:41
epoch [32/50] batch [220/403] time 0.079 (0.093) data 0.000 (0.011) loss 1.8609 (1.8771) ce_loss 0.7925 (0.8465) loss_zs_kd 2.3311 (2.4377) loss_oracle 0.6776 (0.5983) acc 65.6250 (69.4034) kd_loss 0.7296 (0.7314) lr 6.9098e-04 eta 0:11:32
epoch [32/50] batch [240/403] time 0.082 (0.092) data 0.000 (0.010) loss 1.8515 (1.8800) ce_loss 0.8359 (0.8510) loss_zs_kd 2.1101 (2.4328) loss_oracle 0.5902 (0.5971) acc 65.6250 (69.1927) kd_loss 0.7205 (0.7305) lr 6.9098e-04 eta 0:11:25
epoch [32/50] batch [260/403] time 0.081 (0.092) data 0.000 (0.009) loss 1.8939 (1.8819) ce_loss 0.8672 (0.8534) loss_zs_kd 2.3999 (2.4365) loss_oracle 0.5766 (0.5966) acc 65.6250 (69.0986) kd_loss 0.7384 (0.7302) lr 6.9098e-04 eta 0:11:17
epoch [32/50] batch [280/403] time 0.071 (0.091) data 0.000 (0.008) loss 2.0918 (1.8785) ce_loss 1.0713 (0.8501) loss_zs_kd 2.4876 (2.4345) loss_oracle 0.5733 (0.5972) acc 56.2500 (69.2522) kd_loss 0.7338 (0.7297) lr 6.9098e-04 eta 0:11:08
epoch [32/50] batch [300/403] time 0.082 (0.090) data 0.000 (0.008) loss 2.1984 (1.8729) ce_loss 1.1367 (0.8455) loss_zs_kd 2.3910 (2.4294) loss_oracle 0.6011 (0.5971) acc 62.5000 (69.3958) kd_loss 0.7611 (0.7289) lr 6.9098e-04 eta 0:11:00
epoch [32/50] batch [320/403] time 0.085 (0.089) data 0.000 (0.007) loss 1.9996 (1.8717) ce_loss 1.0498 (0.8461) loss_zs_kd 2.1236 (2.4204) loss_oracle 0.5270 (0.5964) acc 65.6250 (69.4141) kd_loss 0.6863 (0.7275) lr 6.9098e-04 eta 0:10:55
epoch [32/50] batch [340/403] time 0.070 (0.089) data 0.000 (0.007) loss 2.0069 (1.8719) ce_loss 0.9414 (0.8459) loss_zs_kd 1.9183 (2.4129) loss_oracle 0.6080 (0.5970) acc 65.6250 (69.5588) kd_loss 0.7615 (0.7275) lr 6.9098e-04 eta 0:10:51
epoch [32/50] batch [360/403] time 0.078 (0.088) data 0.000 (0.007) loss 1.8686 (1.8721) ce_loss 0.8135 (0.8469) loss_zs_kd 2.4383 (2.4063) loss_oracle 0.5851 (0.5966) acc 71.8750 (69.5660) kd_loss 0.7626 (0.7269) lr 6.9098e-04 eta 0:10:45
epoch [32/50] batch [380/403] time 0.072 (0.088) data 0.000 (0.006) loss 1.9071 (1.8772) ce_loss 0.8276 (0.8500) loss_zs_kd 1.9931 (2.4070) loss_oracle 0.6729 (0.5987) acc 75.0000 (69.4326) kd_loss 0.7430 (0.7279) lr 6.9098e-04 eta 0:10:39
epoch [32/50] batch [400/403] time 0.078 (0.087) data 0.000 (0.006) loss 1.9860 (1.8762) ce_loss 0.9385 (0.8486) loss_zs_kd 2.7003 (2.4069) loss_oracle 0.6551 (0.5993) acc 65.6250 (69.4297) kd_loss 0.7200 (0.7280) lr 6.9098e-04 eta 0:10:33
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,036
* accuracy: 72.9%
* error: 27.1%
* macro_f1: 61.8%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,438
* accuracy: 41.4%
* error: 58.6%
* macro_f1: 33.2%
******* Domain 4 best val acc:      73.4%, epoch: 26 *******
******* Domain 4 best val test acc: 42.6%, epoch: 26 *******
******* Domain 4 best test acc:     45.4%, epoch: 30 *******
epoch [33/50] batch [20/403] time 0.060 (0.264) data 0.000 (0.195) loss 1.8458 (1.9072) ce_loss 0.8428 (0.8907) loss_zs_kd 2.3929 (2.3127) loss_oracle 0.6740 (0.6031) acc 75.0000 (68.2812) kd_loss 0.6660 (0.7150) lr 6.3188e-04 eta 0:31:51
epoch [33/50] batch [40/403] time 0.069 (0.163) data 0.000 (0.098) loss 1.9381 (1.8871) ce_loss 0.8140 (0.8575) loss_zs_kd 2.7172 (2.3504) loss_oracle 0.6593 (0.6041) acc 62.5000 (70.0781) kd_loss 0.7945 (0.7275) lr 6.3188e-04 eta 0:19:37
epoch [33/50] batch [60/403] time 0.087 (0.134) data 0.000 (0.065) loss 1.6597 (1.8732) ce_loss 0.6074 (0.8477) loss_zs_kd 2.0039 (2.3487) loss_oracle 0.6215 (0.5996) acc 75.0000 (70.2083) kd_loss 0.7415 (0.7257) lr 6.3188e-04 eta 0:16:06
epoch [33/50] batch [80/403] time 0.083 (0.122) data 0.000 (0.049) loss 1.8313 (1.8771) ce_loss 0.8306 (0.8550) loss_zs_kd 2.6970 (2.3556) loss_oracle 0.6015 (0.6014) acc 75.0000 (70.0000) kd_loss 0.7000 (0.7214) lr 6.3188e-04 eta 0:14:36
epoch [33/50] batch [100/403] time 0.082 (0.114) data 0.000 (0.039) loss 2.2883 (1.8790) ce_loss 1.2139 (0.8560) loss_zs_kd 3.0069 (2.3576) loss_oracle 0.6770 (0.6044) acc 56.2500 (70.0000) kd_loss 0.7359 (0.7209) lr 6.3188e-04 eta 0:13:35
epoch [33/50] batch [120/403] time 0.079 (0.109) data 0.000 (0.033) loss 1.8676 (1.8783) ce_loss 0.8223 (0.8519) loss_zs_kd 2.4237 (2.3465) loss_oracle 0.6025 (0.6068) acc 71.8750 (70.1042) kd_loss 0.7440 (0.7230) lr 6.3188e-04 eta 0:12:56
epoch [33/50] batch [140/403] time 0.081 (0.105) data 0.000 (0.028) loss 1.3875 (1.8636) ce_loss 0.4233 (0.8375) loss_zs_kd 2.1258 (2.3621) loss_oracle 0.5887 (0.6073) acc 87.5000 (70.4911) kd_loss 0.6699 (0.7225) lr 6.3188e-04 eta 0:12:28
epoch [33/50] batch [160/403] time 0.079 (0.103) data 0.000 (0.025) loss 1.8780 (1.8810) ce_loss 0.8032 (0.8534) loss_zs_kd 2.0678 (2.3487) loss_oracle 0.6694 (0.6078) acc 68.7500 (69.8047) kd_loss 0.7401 (0.7237) lr 6.3188e-04 eta 0:12:09
epoch [33/50] batch [180/403] time 0.078 (0.101) data 0.000 (0.022) loss 1.8833 (1.8790) ce_loss 0.8877 (0.8524) loss_zs_kd 2.8380 (2.3530) loss_oracle 0.6095 (0.6050) acc 75.0000 (69.9132) kd_loss 0.6909 (0.7240) lr 6.3188e-04 eta 0:11:50
epoch [33/50] batch [200/403] time 0.088 (0.099) data 0.000 (0.020) loss 1.7914 (1.8789) ce_loss 0.7334 (0.8511) loss_zs_kd 2.4552 (2.3499) loss_oracle 0.6547 (0.6058) acc 78.1250 (70.0156) kd_loss 0.7306 (0.7250) lr 6.3188e-04 eta 0:11:38
epoch [33/50] batch [220/403] time 0.090 (0.098) data 0.000 (0.018) loss 1.8756 (1.8801) ce_loss 0.8765 (0.8518) loss_zs_kd 2.2866 (2.3502) loss_oracle 0.6215 (0.6057) acc 75.0000 (70.0142) kd_loss 0.6884 (0.7254) lr 6.3188e-04 eta 0:11:27
epoch [33/50] batch [240/403] time 0.088 (0.097) data 0.000 (0.017) loss 1.8341 (1.8790) ce_loss 0.8252 (0.8504) loss_zs_kd 2.5010 (2.3532) loss_oracle 0.5872 (0.6050) acc 62.5000 (70.1172) kd_loss 0.7153 (0.7261) lr 6.3188e-04 eta 0:11:18
epoch [33/50] batch [260/403] time 0.084 (0.096) data 0.000 (0.015) loss 1.8255 (1.8816) ce_loss 0.7935 (0.8506) loss_zs_kd 1.9599 (2.3643) loss_oracle 0.4905 (0.6053) acc 78.1250 (69.9760) kd_loss 0.7868 (0.7283) lr 6.3188e-04 eta 0:11:10
epoch [33/50] batch [280/403] time 0.075 (0.095) data 0.000 (0.014) loss 2.1005 (1.8870) ce_loss 1.1250 (0.8561) loss_zs_kd 2.4832 (2.3725) loss_oracle 0.5157 (0.6059) acc 62.5000 (69.7433) kd_loss 0.7176 (0.7280) lr 6.3188e-04 eta 0:11:00
epoch [33/50] batch [300/403] time 0.085 (0.094) data 0.000 (0.013) loss 1.4854 (1.8885) ce_loss 0.5083 (0.8563) loss_zs_kd 2.8879 (2.3778) loss_oracle 0.5958 (0.6070) acc 84.3750 (69.6562) kd_loss 0.6792 (0.7287) lr 6.3188e-04 eta 0:10:52
epoch [33/50] batch [320/403] time 0.074 (0.093) data 0.000 (0.012) loss 2.0426 (1.8884) ce_loss 0.9775 (0.8555) loss_zs_kd 2.2063 (2.3773) loss_oracle 0.6040 (0.6077) acc 68.7500 (69.5801) kd_loss 0.7631 (0.7290) lr 6.3188e-04 eta 0:10:43
epoch [33/50] batch [340/403] time 0.085 (0.092) data 0.000 (0.012) loss 1.6532 (1.8874) ce_loss 0.6079 (0.8554) loss_zs_kd 2.3039 (2.3761) loss_oracle 0.6348 (0.6074) acc 81.2500 (69.6048) kd_loss 0.7280 (0.7282) lr 6.3188e-04 eta 0:10:37
epoch [33/50] batch [360/403] time 0.080 (0.091) data 0.000 (0.011) loss 1.9799 (1.8918) ce_loss 1.0000 (0.8595) loss_zs_kd 2.3140 (2.3715) loss_oracle 0.5799 (0.6079) acc 56.2500 (69.4531) kd_loss 0.6899 (0.7284) lr 6.3188e-04 eta 0:10:30
epoch [33/50] batch [380/403] time 0.081 (0.091) data 0.000 (0.011) loss 1.6028 (1.8905) ce_loss 0.5381 (0.8586) loss_zs_kd 2.7732 (2.3788) loss_oracle 0.5706 (0.6081) acc 84.3750 (69.6464) kd_loss 0.7794 (0.7278) lr 6.3188e-04 eta 0:10:25
epoch [33/50] batch [400/403] time 0.078 (0.091) data 0.000 (0.010) loss 1.7271 (1.8891) ce_loss 0.7153 (0.8569) loss_zs_kd 2.1494 (2.3791) loss_oracle 0.5614 (0.6084) acc 71.8750 (69.6797) kd_loss 0.7311 (0.7280) lr 6.3188e-04 eta 0:10:20
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,041
* accuracy: 73.0%
* error: 27.0%
* macro_f1: 61.4%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,582
* accuracy: 43.9%
* error: 56.1%
* macro_f1: 34.7%
******* Domain 4 best val acc:      73.4%, epoch: 26 *******
******* Domain 4 best val test acc: 42.6%, epoch: 26 *******
******* Domain 4 best test acc:     45.4%, epoch: 30 *******
epoch [34/50] batch [20/403] time 0.078 (0.280) data 0.000 (0.185) loss 1.9057 (1.8981) ce_loss 0.7856 (0.8642) loss_zs_kd 2.3064 (2.4131) loss_oracle 0.6375 (0.6048) acc 78.1250 (68.4375) kd_loss 0.8013 (0.7315) lr 5.7422e-04 eta 0:31:52
epoch [34/50] batch [40/403] time 0.083 (0.182) data 0.000 (0.093) loss 2.0389 (1.8996) ce_loss 0.9639 (0.8732) loss_zs_kd 2.7685 (2.4854) loss_oracle 0.6416 (0.6014) acc 59.3750 (69.1406) kd_loss 0.7542 (0.7257) lr 5.7422e-04 eta 0:20:38
epoch [34/50] batch [60/403] time 0.090 (0.150) data 0.000 (0.062) loss 1.8000 (1.8839) ce_loss 0.7827 (0.8574) loss_zs_kd 1.9221 (2.4342) loss_oracle 0.5857 (0.6032) acc 75.0000 (69.9479) kd_loss 0.7244 (0.7249) lr 5.7422e-04 eta 0:16:58
epoch [34/50] batch [80/403] time 0.086 (0.133) data 0.000 (0.047) loss 1.9903 (1.8846) ce_loss 0.9985 (0.8592) loss_zs_kd 2.4416 (2.4418) loss_oracle 0.5236 (0.6040) acc 75.0000 (70.3516) kd_loss 0.7300 (0.7234) lr 5.7422e-04 eta 0:15:01
epoch [34/50] batch [100/403] time 0.086 (0.124) data 0.000 (0.037) loss 1.6967 (1.8833) ce_loss 0.6978 (0.8604) loss_zs_kd 1.8257 (2.4198) loss_oracle 0.6328 (0.6022) acc 68.7500 (70.1875) kd_loss 0.6826 (0.7218) lr 5.7422e-04 eta 0:13:55
epoch [34/50] batch [120/403] time 0.081 (0.117) data 0.000 (0.031) loss 2.0651 (1.8880) ce_loss 0.9966 (0.8659) loss_zs_kd 2.8749 (2.3825) loss_oracle 0.6404 (0.6012) acc 65.6250 (70.0521) kd_loss 0.7483 (0.7215) lr 5.7422e-04 eta 0:13:07
epoch [34/50] batch [140/403] time 0.085 (0.112) data 0.000 (0.027) loss 1.8636 (1.8797) ce_loss 0.8125 (0.8559) loss_zs_kd 2.3154 (2.3947) loss_oracle 0.5914 (0.6022) acc 65.6250 (70.3125) kd_loss 0.7554 (0.7228) lr 5.7422e-04 eta 0:12:32
epoch [34/50] batch [160/403] time 0.084 (0.108) data 0.000 (0.023) loss 1.9881 (1.8792) ce_loss 0.9336 (0.8554) loss_zs_kd 2.1731 (2.4010) loss_oracle 0.6090 (0.6018) acc 62.5000 (70.0977) kd_loss 0.7500 (0.7229) lr 5.7422e-04 eta 0:12:05
epoch [34/50] batch [180/403] time 0.100 (0.106) data 0.000 (0.021) loss 1.9913 (1.8758) ce_loss 1.0117 (0.8512) loss_zs_kd 2.7984 (2.4006) loss_oracle 0.5595 (0.6003) acc 62.5000 (70.3819) kd_loss 0.6998 (0.7245) lr 5.7422e-04 eta 0:11:47
epoch [34/50] batch [200/403] time 0.078 (0.104) data 0.000 (0.019) loss 1.8265 (1.8700) ce_loss 0.7720 (0.8461) loss_zs_kd 2.1803 (2.4077) loss_oracle 0.6162 (0.5994) acc 71.8750 (70.4219) kd_loss 0.7464 (0.7242) lr 5.7422e-04 eta 0:11:32
epoch [34/50] batch [220/403] time 0.080 (0.102) data 0.000 (0.017) loss 1.8445 (1.8767) ce_loss 0.7417 (0.8525) loss_zs_kd 2.6746 (2.4066) loss_oracle 0.6167 (0.5980) acc 62.5000 (70.0142) kd_loss 0.7944 (0.7252) lr 5.7422e-04 eta 0:11:14
epoch [34/50] batch [240/403] time 0.080 (0.100) data 0.000 (0.016) loss 2.0147 (1.8770) ce_loss 0.9272 (0.8525) loss_zs_kd 2.4610 (2.4028) loss_oracle 0.5723 (0.5983) acc 62.5000 (69.8958) kd_loss 0.8013 (0.7253) lr 5.7422e-04 eta 0:11:03
epoch [34/50] batch [260/403] time 0.088 (0.099) data 0.000 (0.015) loss 1.8855 (1.8798) ce_loss 0.9009 (0.8537) loss_zs_kd 2.3331 (2.3935) loss_oracle 0.5552 (0.5978) acc 68.7500 (69.8558) kd_loss 0.7070 (0.7272) lr 5.7422e-04 eta 0:10:52
epoch [34/50] batch [280/403] time 0.083 (0.098) data 0.000 (0.014) loss 1.7555 (1.8753) ce_loss 0.7104 (0.8486) loss_zs_kd 2.4070 (2.3823) loss_oracle 0.6466 (0.5975) acc 71.8750 (70.0000) kd_loss 0.7218 (0.7279) lr 5.7422e-04 eta 0:10:42
epoch [34/50] batch [300/403] time 0.085 (0.097) data 0.000 (0.013) loss 2.1376 (1.8747) ce_loss 1.0645 (0.8480) loss_zs_kd 2.1026 (2.3828) loss_oracle 0.6407 (0.5979) acc 62.5000 (70.1458) kd_loss 0.7528 (0.7277) lr 5.7422e-04 eta 0:10:35
epoch [34/50] batch [320/403] time 0.080 (0.096) data 0.000 (0.012) loss 1.8650 (1.8720) ce_loss 0.7505 (0.8446) loss_zs_kd 2.2869 (2.3820) loss_oracle 0.6333 (0.5977) acc 71.8750 (70.2246) kd_loss 0.7979 (0.7286) lr 5.7422e-04 eta 0:10:28
epoch [34/50] batch [340/403] time 0.084 (0.096) data 0.000 (0.011) loss 2.1105 (1.8764) ce_loss 1.1318 (0.8479) loss_zs_kd 2.2850 (2.3812) loss_oracle 0.6166 (0.5982) acc 62.5000 (70.0368) kd_loss 0.6704 (0.7294) lr 5.7422e-04 eta 0:10:22
epoch [34/50] batch [360/403] time 0.083 (0.095) data 0.000 (0.011) loss 1.7868 (1.8751) ce_loss 0.6885 (0.8459) loss_zs_kd 2.3699 (2.3894) loss_oracle 0.6027 (0.5990) acc 81.2500 (70.1215) kd_loss 0.7970 (0.7297) lr 5.7422e-04 eta 0:10:14
epoch [34/50] batch [380/403] time 0.086 (0.094) data 0.000 (0.010) loss 1.9486 (1.8742) ce_loss 0.8726 (0.8449) loss_zs_kd 2.1707 (2.3884) loss_oracle 0.6024 (0.5989) acc 65.6250 (70.2056) kd_loss 0.7748 (0.7298) lr 5.7422e-04 eta 0:10:09
epoch [34/50] batch [400/403] time 0.078 (0.093) data 0.000 (0.010) loss 1.5983 (1.8721) ce_loss 0.6147 (0.8430) loss_zs_kd 2.3724 (2.3915) loss_oracle 0.5508 (0.5996) acc 81.2500 (70.2500) kd_loss 0.7082 (0.7293) lr 5.7422e-04 eta 0:10:03
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,076
* accuracy: 73.6%
* error: 26.4%
* macro_f1: 62.0%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,426
* accuracy: 41.2%
* error: 58.8%
* macro_f1: 29.8%
******* Domain 4 best val acc:      73.6%, epoch: 34 *******
******* Domain 4 best val test acc: 41.2%, epoch: 34 *******
******* Domain 4 best test acc:     45.4%, epoch: 30 *******
epoch [35/50] batch [20/403] time 0.069 (0.228) data 0.000 (0.149) loss 1.6714 (1.8214) ce_loss 0.6587 (0.8120) loss_zs_kd 2.4967 (2.4546) loss_oracle 0.5978 (0.5835) acc 71.8750 (68.9062) kd_loss 0.7138 (0.7176) lr 5.1825e-04 eta 0:24:27
epoch [35/50] batch [40/403] time 0.076 (0.154) data 0.000 (0.075) loss 1.7641 (1.8484) ce_loss 0.6831 (0.8242) loss_zs_kd 1.9526 (2.3969) loss_oracle 0.7041 (0.6025) acc 78.1250 (70.0000) kd_loss 0.7289 (0.7230) lr 5.1825e-04 eta 0:16:24
epoch [35/50] batch [60/403] time 0.073 (0.130) data 0.000 (0.050) loss 1.6962 (1.8714) ce_loss 0.5693 (0.8393) loss_zs_kd 1.9475 (2.3935) loss_oracle 0.6444 (0.6031) acc 81.2500 (69.6875) kd_loss 0.8047 (0.7305) lr 5.1825e-04 eta 0:13:51
epoch [35/50] batch [80/403] time 0.091 (0.119) data 0.000 (0.038) loss 2.2890 (1.8669) ce_loss 1.2412 (0.8323) loss_zs_kd 2.4130 (2.4218) loss_oracle 0.6210 (0.6053) acc 62.5000 (70.5078) kd_loss 0.7373 (0.7319) lr 5.1825e-04 eta 0:12:36
epoch [35/50] batch [100/403] time 0.087 (0.112) data 0.000 (0.030) loss 1.9863 (1.8758) ce_loss 0.9019 (0.8431) loss_zs_kd 2.5183 (2.4316) loss_oracle 0.5914 (0.6060) acc 65.6250 (69.9375) kd_loss 0.7887 (0.7297) lr 5.1825e-04 eta 0:11:54
epoch [35/50] batch [120/403] time 0.082 (0.107) data 0.000 (0.025) loss 1.9931 (1.8729) ce_loss 0.9409 (0.8425) loss_zs_kd 3.0040 (2.4625) loss_oracle 0.6009 (0.6042) acc 65.6250 (69.8438) kd_loss 0.7517 (0.7283) lr 5.1825e-04 eta 0:11:17
epoch [35/50] batch [140/403] time 0.082 (0.103) data 0.000 (0.022) loss 1.7832 (1.8734) ce_loss 0.7886 (0.8444) loss_zs_kd 2.2159 (2.4455) loss_oracle 0.5908 (0.6043) acc 68.7500 (69.9777) kd_loss 0.6992 (0.7269) lr 5.1825e-04 eta 0:10:47
epoch [35/50] batch [160/403] time 0.082 (0.100) data 0.000 (0.019) loss 1.9498 (1.8657) ce_loss 0.9106 (0.8409) loss_zs_kd 2.3468 (2.4336) loss_oracle 0.6221 (0.6015) acc 68.7500 (69.8438) kd_loss 0.7282 (0.7240) lr 5.1825e-04 eta 0:10:31
epoch [35/50] batch [180/403] time 0.087 (0.098) data 0.000 (0.017) loss 1.7312 (1.8618) ce_loss 0.7178 (0.8378) loss_zs_kd 2.7758 (2.4374) loss_oracle 0.6373 (0.6009) acc 71.8750 (70.0347) kd_loss 0.6948 (0.7236) lr 5.1825e-04 eta 0:10:15
epoch [35/50] batch [200/403] time 0.084 (0.097) data 0.000 (0.015) loss 2.1519 (1.8574) ce_loss 1.1064 (0.8316) loss_zs_kd 2.3787 (2.4497) loss_oracle 0.6088 (0.6019) acc 59.3750 (70.1875) kd_loss 0.7411 (0.7248) lr 5.1825e-04 eta 0:10:03
epoch [35/50] batch [220/403] time 0.081 (0.095) data 0.000 (0.014) loss 1.6839 (1.8543) ce_loss 0.5908 (0.8265) loss_zs_kd 1.9865 (2.4511) loss_oracle 0.6128 (0.6028) acc 75.0000 (70.5824) kd_loss 0.7867 (0.7263) lr 5.1825e-04 eta 0:09:52
epoch [35/50] batch [240/403] time 0.084 (0.094) data 0.000 (0.013) loss 2.1504 (1.8552) ce_loss 1.0977 (0.8271) loss_zs_kd 2.5150 (2.4416) loss_oracle 0.6565 (0.6045) acc 62.5000 (70.5990) kd_loss 0.7245 (0.7259) lr 5.1825e-04 eta 0:09:46
epoch [35/50] batch [260/403] time 0.086 (0.094) data 0.000 (0.012) loss 1.6949 (1.8598) ce_loss 0.6162 (0.8311) loss_zs_kd 2.3555 (2.4375) loss_oracle 0.6645 (0.6051) acc 84.3750 (70.4928) kd_loss 0.7464 (0.7261) lr 5.1825e-04 eta 0:09:40
epoch [35/50] batch [280/403] time 0.079 (0.093) data 0.000 (0.011) loss 1.7270 (1.8612) ce_loss 0.6865 (0.8325) loss_zs_kd 2.4223 (2.4394) loss_oracle 0.6337 (0.6058) acc 68.7500 (70.3795) kd_loss 0.7237 (0.7259) lr 5.1825e-04 eta 0:09:33
epoch [35/50] batch [300/403] time 0.085 (0.093) data 0.000 (0.010) loss 1.8961 (1.8600) ce_loss 0.8452 (0.8310) loss_zs_kd 2.4542 (2.4413) loss_oracle 0.6332 (0.6044) acc 71.8750 (70.4479) kd_loss 0.7343 (0.7268) lr 5.1825e-04 eta 0:09:29
epoch [35/50] batch [320/403] time 0.088 (0.092) data 0.000 (0.010) loss 1.7817 (1.8617) ce_loss 0.7793 (0.8329) loss_zs_kd 2.6526 (2.4438) loss_oracle 0.5385 (0.6053) acc 78.1250 (70.4004) kd_loss 0.7332 (0.7261) lr 5.1825e-04 eta 0:09:24
epoch [35/50] batch [340/403] time 0.085 (0.092) data 0.000 (0.009) loss 1.6340 (1.8627) ce_loss 0.6440 (0.8330) loss_zs_kd 2.5183 (2.4406) loss_oracle 0.6392 (0.6055) acc 68.7500 (70.2941) kd_loss 0.6704 (0.7269) lr 5.1825e-04 eta 0:09:20
epoch [35/50] batch [360/403] time 0.079 (0.091) data 0.000 (0.009) loss 1.8702 (1.8646) ce_loss 0.8057 (0.8343) loss_zs_kd 2.2743 (2.4508) loss_oracle 0.5674 (0.6048) acc 71.8750 (70.1823) kd_loss 0.7809 (0.7280) lr 5.1825e-04 eta 0:09:15
epoch [35/50] batch [380/403] time 0.093 (0.091) data 0.000 (0.008) loss 2.1868 (1.8681) ce_loss 1.1045 (0.8368) loss_zs_kd 2.9902 (2.4529) loss_oracle 0.6632 (0.6054) acc 59.3750 (70.0493) kd_loss 0.7508 (0.7286) lr 5.1825e-04 eta 0:09:11
epoch [35/50] batch [400/403] time 0.076 (0.090) data 0.000 (0.008) loss 1.9577 (1.8729) ce_loss 0.9199 (0.8409) loss_zs_kd 1.8025 (2.4399) loss_oracle 0.5994 (0.6051) acc 65.6250 (69.9375) kd_loss 0.7381 (0.7294) lr 5.1825e-04 eta 0:09:06
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,064
* accuracy: 73.4%
* error: 26.6%
* macro_f1: 61.2%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,527
* accuracy: 43.0%
* error: 57.0%
* macro_f1: 32.0%
******* Domain 4 best val acc:      73.6%, epoch: 34 *******
******* Domain 4 best val test acc: 41.2%, epoch: 34 *******
******* Domain 4 best test acc:     45.4%, epoch: 30 *******
epoch [36/50] batch [20/403] time 0.077 (0.284) data 0.000 (0.198) loss 1.6691 (1.9061) ce_loss 0.6851 (0.8825) loss_zs_kd 2.8658 (2.3139) loss_oracle 0.5500 (0.5733) acc 71.8750 (66.2500) kd_loss 0.7090 (0.7370) lr 4.6417e-04 eta 0:28:32
epoch [36/50] batch [40/403] time 0.093 (0.184) data 0.000 (0.099) loss 2.3284 (1.9064) ce_loss 1.2441 (0.8737) loss_zs_kd 2.6373 (2.3775) loss_oracle 0.5726 (0.5803) acc 56.2500 (67.3438) kd_loss 0.7979 (0.7426) lr 4.6417e-04 eta 0:18:24
epoch [36/50] batch [60/403] time 0.081 (0.151) data 0.000 (0.066) loss 2.0579 (1.9013) ce_loss 1.0977 (0.8613) loss_zs_kd 2.4391 (2.3870) loss_oracle 0.5927 (0.5889) acc 68.7500 (68.0208) kd_loss 0.6639 (0.7456) lr 4.6417e-04 eta 0:15:02
epoch [36/50] batch [80/403] time 0.095 (0.134) data 0.000 (0.050) loss 1.8028 (1.8935) ce_loss 0.7700 (0.8538) loss_zs_kd 2.8115 (2.3914) loss_oracle 0.6149 (0.5937) acc 71.8750 (68.9062) kd_loss 0.7253 (0.7429) lr 4.6417e-04 eta 0:13:20
epoch [36/50] batch [100/403] time 0.086 (0.124) data 0.000 (0.040) loss 1.7787 (1.8978) ce_loss 0.6938 (0.8569) loss_zs_kd 2.3368 (2.4038) loss_oracle 0.6112 (0.5967) acc 75.0000 (68.7500) kd_loss 0.7793 (0.7426) lr 4.6417e-04 eta 0:12:19
epoch [36/50] batch [120/403] time 0.080 (0.118) data 0.000 (0.033) loss 1.4365 (1.9014) ce_loss 0.3223 (0.8611) loss_zs_kd 2.2404 (2.4267) loss_oracle 0.7120 (0.6012) acc 90.6250 (68.7760) kd_loss 0.7582 (0.7397) lr 4.6417e-04 eta 0:11:38
epoch [36/50] batch [140/403] time 0.068 (0.111) data 0.000 (0.029) loss 1.6360 (1.8962) ce_loss 0.6250 (0.8554) loss_zs_kd 2.8453 (2.4450) loss_oracle 0.5830 (0.6029) acc 81.2500 (68.9062) kd_loss 0.7195 (0.7393) lr 4.6417e-04 eta 0:10:57
epoch [36/50] batch [160/403] time 0.077 (0.106) data 0.000 (0.025) loss 1.7893 (1.8950) ce_loss 0.7583 (0.8565) loss_zs_kd 2.2730 (2.4385) loss_oracle 0.6880 (0.6029) acc 68.7500 (69.0430) kd_loss 0.6870 (0.7371) lr 4.6417e-04 eta 0:10:26
epoch [36/50] batch [180/403] time 0.080 (0.102) data 0.000 (0.022) loss 1.8057 (1.8951) ce_loss 0.8301 (0.8575) loss_zs_kd 2.0034 (2.4433) loss_oracle 0.5989 (0.6054) acc 81.2500 (69.0451) kd_loss 0.6762 (0.7349) lr 4.6417e-04 eta 0:09:59
epoch [36/50] batch [200/403] time 0.075 (0.099) data 0.000 (0.020) loss 1.9078 (1.8919) ce_loss 0.8486 (0.8538) loss_zs_kd 1.9737 (2.4468) loss_oracle 0.6812 (0.6059) acc 65.6250 (69.1094) kd_loss 0.7186 (0.7352) lr 4.6417e-04 eta 0:09:38
epoch [36/50] batch [220/403] time 0.092 (0.098) data 0.000 (0.018) loss 1.6564 (1.8840) ce_loss 0.5576 (0.8449) loss_zs_kd 2.2599 (2.4508) loss_oracle 0.6238 (0.6054) acc 81.2500 (69.6875) kd_loss 0.7869 (0.7364) lr 4.6417e-04 eta 0:09:31
epoch [36/50] batch [240/403] time 0.090 (0.097) data 0.000 (0.017) loss 1.8798 (1.8835) ce_loss 0.8535 (0.8445) loss_zs_kd 2.5151 (2.4555) loss_oracle 0.6172 (0.6055) acc 75.0000 (69.7266) kd_loss 0.7177 (0.7363) lr 4.6417e-04 eta 0:09:21
epoch [36/50] batch [260/403] time 0.086 (0.096) data 0.000 (0.015) loss 1.7570 (1.8796) ce_loss 0.6450 (0.8424) loss_zs_kd 2.1177 (2.4425) loss_oracle 0.6412 (0.6045) acc 75.0000 (69.6875) kd_loss 0.7914 (0.7350) lr 4.6417e-04 eta 0:09:14
epoch [36/50] batch [280/403] time 0.082 (0.095) data 0.000 (0.014) loss 2.0116 (1.8821) ce_loss 0.9766 (0.8444) loss_zs_kd 2.7518 (2.4374) loss_oracle 0.6562 (0.6058) acc 68.7500 (69.6987) kd_loss 0.7069 (0.7349) lr 4.6417e-04 eta 0:09:08
epoch [36/50] batch [300/403] time 0.080 (0.094) data 0.000 (0.013) loss 1.8035 (1.8822) ce_loss 0.7524 (0.8451) loss_zs_kd 2.3035 (2.4313) loss_oracle 0.5361 (0.6061) acc 81.2500 (69.6354) kd_loss 0.7830 (0.7341) lr 4.6417e-04 eta 0:09:00
epoch [36/50] batch [320/403] time 0.088 (0.094) data 0.000 (0.013) loss 1.7834 (1.8842) ce_loss 0.7891 (0.8474) loss_zs_kd 2.1395 (2.4316) loss_oracle 0.6329 (0.6053) acc 68.7500 (69.5605) kd_loss 0.6779 (0.7341) lr 4.6417e-04 eta 0:08:55
epoch [36/50] batch [340/403] time 0.085 (0.093) data 0.000 (0.012) loss 1.9671 (1.8839) ce_loss 0.9673 (0.8483) loss_zs_kd 1.8213 (2.4260) loss_oracle 0.5923 (0.6050) acc 68.7500 (69.6599) kd_loss 0.7037 (0.7331) lr 4.6417e-04 eta 0:08:50
epoch [36/50] batch [360/403] time 0.089 (0.093) data 0.000 (0.011) loss 1.6766 (1.8814) ce_loss 0.6641 (0.8453) loss_zs_kd 2.7379 (2.4235) loss_oracle 0.5618 (0.6054) acc 71.8750 (69.8003) kd_loss 0.7317 (0.7334) lr 4.6417e-04 eta 0:08:46
epoch [36/50] batch [380/403] time 0.072 (0.092) data 0.000 (0.011) loss 1.7361 (1.8775) ce_loss 0.6289 (0.8410) loss_zs_kd 2.7083 (2.4225) loss_oracle 0.6337 (0.6062) acc 78.1250 (69.9424) kd_loss 0.7903 (0.7333) lr 4.6417e-04 eta 0:08:41
epoch [36/50] batch [400/403] time 0.077 (0.091) data 0.000 (0.010) loss 1.6021 (1.8763) ce_loss 0.5107 (0.8398) loss_zs_kd 2.4171 (2.4216) loss_oracle 0.6283 (0.6065) acc 81.2500 (70.0234) kd_loss 0.7772 (0.7332) lr 4.6417e-04 eta 0:08:35
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,069
* accuracy: 73.5%
* error: 26.5%
* macro_f1: 62.8%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,629
* accuracy: 44.7%
* error: 55.3%
* macro_f1: 32.6%
******* Domain 4 best val acc:      73.6%, epoch: 34 *******
******* Domain 4 best val test acc: 41.2%, epoch: 34 *******
******* Domain 4 best test acc:     45.4%, epoch: 30 *******
epoch [37/50] batch [20/403] time 0.092 (0.223) data 0.000 (0.126) loss 1.7802 (1.8942) ce_loss 0.8096 (0.8609) loss_zs_kd 2.5195 (2.4398) loss_oracle 0.6084 (0.6177) acc 68.7500 (68.9062) kd_loss 0.6664 (0.7245) lr 4.1221e-04 eta 0:20:54
epoch [37/50] batch [40/403] time 0.087 (0.155) data 0.000 (0.063) loss 2.0869 (1.8941) ce_loss 1.0537 (0.8496) loss_zs_kd 2.2123 (2.4545) loss_oracle 0.5994 (0.6259) acc 59.3750 (68.5156) kd_loss 0.7335 (0.7316) lr 4.1221e-04 eta 0:14:27
epoch [37/50] batch [60/403] time 0.089 (0.132) data 0.000 (0.042) loss 1.7893 (1.8924) ce_loss 0.6636 (0.8463) loss_zs_kd 2.8393 (2.4792) loss_oracle 0.7079 (0.6231) acc 75.0000 (69.2188) kd_loss 0.7717 (0.7345) lr 4.1221e-04 eta 0:12:18
epoch [37/50] batch [80/403] time 0.086 (0.122) data 0.000 (0.032) loss 2.1313 (1.9016) ce_loss 1.1240 (0.8548) loss_zs_kd 2.3176 (2.4958) loss_oracle 0.6366 (0.6276) acc 46.8750 (68.8672) kd_loss 0.6890 (0.7330) lr 4.1221e-04 eta 0:11:16
epoch [37/50] batch [100/403] time 0.095 (0.115) data 0.000 (0.025) loss 1.9501 (1.9040) ce_loss 0.9419 (0.8609) loss_zs_kd 2.8160 (2.4710) loss_oracle 0.6214 (0.6263) acc 62.5000 (68.7188) kd_loss 0.6975 (0.7299) lr 4.1221e-04 eta 0:10:36
epoch [37/50] batch [120/403] time 0.093 (0.110) data 0.000 (0.021) loss 1.7626 (1.8940) ce_loss 0.7197 (0.8498) loss_zs_kd 2.2032 (2.4587) loss_oracle 0.6090 (0.6275) acc 71.8750 (69.4271) kd_loss 0.7384 (0.7305) lr 4.1221e-04 eta 0:10:09
epoch [37/50] batch [140/403] time 0.089 (0.108) data 0.000 (0.018) loss 2.5545 (1.8950) ce_loss 1.5645 (0.8474) loss_zs_kd 2.0988 (2.4614) loss_oracle 0.6496 (0.6280) acc 46.8750 (69.5759) kd_loss 0.6653 (0.7336) lr 4.1221e-04 eta 0:09:51
epoch [37/50] batch [160/403] time 0.096 (0.105) data 0.000 (0.016) loss 1.9702 (1.8945) ce_loss 0.9111 (0.8501) loss_zs_kd 2.1111 (2.4452) loss_oracle 0.6548 (0.6239) acc 71.8750 (69.6289) kd_loss 0.7317 (0.7325) lr 4.1221e-04 eta 0:09:34
epoch [37/50] batch [180/403] time 0.099 (0.103) data 0.000 (0.014) loss 1.7142 (1.8955) ce_loss 0.8105 (0.8540) loss_zs_kd 2.2642 (2.4383) loss_oracle 0.5112 (0.6204) acc 78.1250 (69.7569) kd_loss 0.6481 (0.7313) lr 4.1221e-04 eta 0:09:21
epoch [37/50] batch [200/403] time 0.078 (0.101) data 0.000 (0.013) loss 1.8146 (1.8946) ce_loss 0.7832 (0.8532) loss_zs_kd 2.4536 (2.4296) loss_oracle 0.6335 (0.6203) acc 71.8750 (69.8906) kd_loss 0.7147 (0.7312) lr 4.1221e-04 eta 0:09:11
epoch [37/50] batch [220/403] time 0.081 (0.100) data 0.000 (0.012) loss 2.0015 (1.8919) ce_loss 0.8594 (0.8519) loss_zs_kd 2.4937 (2.4243) loss_oracle 0.6708 (0.6195) acc 65.6250 (69.8864) kd_loss 0.8067 (0.7302) lr 4.1221e-04 eta 0:09:00
epoch [37/50] batch [240/403] time 0.084 (0.098) data 0.000 (0.011) loss 1.7279 (1.8853) ce_loss 0.6436 (0.8457) loss_zs_kd 2.2531 (2.4225) loss_oracle 0.6696 (0.6183) acc 75.0000 (70.2083) kd_loss 0.7496 (0.7304) lr 4.1221e-04 eta 0:08:51
epoch [37/50] batch [260/403] time 0.087 (0.097) data 0.000 (0.010) loss 1.8914 (1.8859) ce_loss 0.8447 (0.8461) loss_zs_kd 2.1185 (2.4184) loss_oracle 0.6571 (0.6187) acc 71.8750 (70.1803) kd_loss 0.7181 (0.7305) lr 4.1221e-04 eta 0:08:41
epoch [37/50] batch [280/403] time 0.089 (0.096) data 0.000 (0.009) loss 2.3355 (1.8823) ce_loss 1.3672 (0.8428) loss_zs_kd 2.3196 (2.4168) loss_oracle 0.6470 (0.6187) acc 53.1250 (70.3348) kd_loss 0.6448 (0.7301) lr 4.1221e-04 eta 0:08:34
epoch [37/50] batch [300/403] time 0.087 (0.095) data 0.000 (0.009) loss 2.0369 (1.8814) ce_loss 1.0254 (0.8429) loss_zs_kd 2.2515 (2.4069) loss_oracle 0.7028 (0.6170) acc 68.7500 (70.3542) kd_loss 0.6602 (0.7300) lr 4.1221e-04 eta 0:08:28
epoch [37/50] batch [320/403] time 0.081 (0.095) data 0.000 (0.008) loss 1.9618 (1.8837) ce_loss 0.9268 (0.8454) loss_zs_kd 2.6884 (2.3954) loss_oracle 0.6470 (0.6167) acc 62.5000 (70.1855) kd_loss 0.7115 (0.7299) lr 4.1221e-04 eta 0:08:23
epoch [37/50] batch [340/403] time 0.085 (0.094) data 0.000 (0.008) loss 1.7126 (1.8824) ce_loss 0.5952 (0.8441) loss_zs_kd 1.9734 (2.3904) loss_oracle 0.6297 (0.6168) acc 81.2500 (70.2022) kd_loss 0.8026 (0.7300) lr 4.1221e-04 eta 0:08:17
epoch [37/50] batch [360/403] time 0.083 (0.093) data 0.000 (0.007) loss 2.1210 (1.8826) ce_loss 1.0791 (0.8435) loss_zs_kd 2.3861 (2.3897) loss_oracle 0.6129 (0.6174) acc 65.6250 (70.0955) kd_loss 0.7355 (0.7304) lr 4.1221e-04 eta 0:08:13
epoch [37/50] batch [380/403] time 0.090 (0.093) data 0.000 (0.007) loss 1.7332 (1.8819) ce_loss 0.6562 (0.8437) loss_zs_kd 2.7532 (2.3931) loss_oracle 0.6215 (0.6170) acc 87.5000 (70.0740) kd_loss 0.7662 (0.7297) lr 4.1221e-04 eta 0:08:09
epoch [37/50] batch [400/403] time 0.067 (0.092) data 0.000 (0.007) loss 1.9172 (1.8832) ce_loss 0.8403 (0.8446) loss_zs_kd 2.4208 (2.3950) loss_oracle 0.6023 (0.6173) acc 71.8750 (70.0391) kd_loss 0.7757 (0.7299) lr 4.1221e-04 eta 0:08:03
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,067
* accuracy: 73.5%
* error: 26.5%
* macro_f1: 61.9%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,540
* accuracy: 43.2%
* error: 56.8%
* macro_f1: 31.2%
******* Domain 4 best val acc:      73.6%, epoch: 34 *******
******* Domain 4 best val test acc: 41.2%, epoch: 34 *******
******* Domain 4 best test acc:     45.4%, epoch: 30 *******
epoch [38/50] batch [20/403] time 0.078 (0.290) data 0.000 (0.203) loss 1.9309 (1.9260) ce_loss 0.9507 (0.8950) loss_zs_kd 2.3492 (2.3785) loss_oracle 0.5878 (0.6230) acc 68.7500 (69.2188) kd_loss 0.6863 (0.7195) lr 3.6258e-04 eta 0:25:11
epoch [38/50] batch [40/403] time 0.083 (0.187) data 0.000 (0.101) loss 2.1386 (1.9218) ce_loss 1.0430 (0.8759) loss_zs_kd 2.6247 (2.4190) loss_oracle 0.6186 (0.6259) acc 53.1250 (69.0625) kd_loss 0.7863 (0.7329) lr 3.6258e-04 eta 0:16:12
epoch [38/50] batch [60/403] time 0.094 (0.153) data 0.000 (0.068) loss 1.6782 (1.9128) ce_loss 0.5488 (0.8619) loss_zs_kd 2.2590 (2.4267) loss_oracle 0.6759 (0.6293) acc 81.2500 (69.1667) kd_loss 0.7915 (0.7362) lr 3.6258e-04 eta 0:13:14
epoch [38/50] batch [80/403] time 0.079 (0.136) data 0.000 (0.051) loss 1.9382 (1.9047) ce_loss 0.8047 (0.8532) loss_zs_kd 1.9085 (2.4570) loss_oracle 0.6904 (0.6292) acc 78.1250 (69.4141) kd_loss 0.7883 (0.7369) lr 3.6258e-04 eta 0:11:43
epoch [38/50] batch [100/403] time 0.085 (0.126) data 0.000 (0.041) loss 1.8405 (1.8984) ce_loss 0.7427 (0.8492) loss_zs_kd 2.3718 (2.4132) loss_oracle 0.7252 (0.6296) acc 71.8750 (69.5938) kd_loss 0.7352 (0.7345) lr 3.6258e-04 eta 0:10:47
epoch [38/50] batch [120/403] time 0.090 (0.119) data 0.000 (0.034) loss 1.9348 (1.8950) ce_loss 0.9302 (0.8492) loss_zs_kd 2.1554 (2.4133) loss_oracle 0.5794 (0.6245) acc 65.6250 (69.2448) kd_loss 0.7149 (0.7335) lr 3.6258e-04 eta 0:10:09
epoch [38/50] batch [140/403] time 0.088 (0.114) data 0.000 (0.029) loss 1.8388 (1.8859) ce_loss 0.8560 (0.8398) loss_zs_kd 2.4661 (2.4073) loss_oracle 0.6769 (0.6231) acc 62.5000 (69.7321) kd_loss 0.6444 (0.7345) lr 3.6258e-04 eta 0:09:43
epoch [38/50] batch [160/403] time 0.081 (0.111) data 0.000 (0.026) loss 1.5855 (1.8836) ce_loss 0.4734 (0.8384) loss_zs_kd 2.5833 (2.4050) loss_oracle 0.6665 (0.6204) acc 81.2500 (69.8242) kd_loss 0.7789 (0.7350) lr 3.6258e-04 eta 0:09:24
epoch [38/50] batch [180/403] time 0.089 (0.108) data 0.000 (0.023) loss 1.6841 (1.8803) ce_loss 0.6821 (0.8348) loss_zs_kd 2.3221 (2.4045) loss_oracle 0.5351 (0.6175) acc 75.0000 (69.9653) kd_loss 0.7344 (0.7368) lr 3.6258e-04 eta 0:09:07
epoch [38/50] batch [200/403] time 0.085 (0.106) data 0.000 (0.021) loss 1.9018 (1.8794) ce_loss 0.9165 (0.8358) loss_zs_kd 2.1472 (2.4066) loss_oracle 0.5642 (0.6142) acc 65.6250 (69.9531) kd_loss 0.7032 (0.7365) lr 3.6258e-04 eta 0:08:52
epoch [38/50] batch [220/403] time 0.088 (0.104) data 0.000 (0.019) loss 2.0831 (1.8773) ce_loss 1.0527 (0.8343) loss_zs_kd 2.1661 (2.4121) loss_oracle 0.6032 (0.6141) acc 59.3750 (70.1278) kd_loss 0.7288 (0.7359) lr 3.6258e-04 eta 0:08:41
epoch [38/50] batch [240/403] time 0.088 (0.102) data 0.000 (0.017) loss 1.8820 (1.8786) ce_loss 0.8955 (0.8374) loss_zs_kd 2.6114 (2.4170) loss_oracle 0.5715 (0.6136) acc 65.6250 (70.1172) kd_loss 0.7008 (0.7344) lr 3.6258e-04 eta 0:08:30
epoch [38/50] batch [260/403] time 0.081 (0.101) data 0.000 (0.016) loss 1.9122 (1.8794) ce_loss 0.8696 (0.8379) loss_zs_kd 2.8952 (2.4261) loss_oracle 0.5982 (0.6149) acc 75.0000 (70.2163) kd_loss 0.7435 (0.7340) lr 3.6258e-04 eta 0:08:22
epoch [38/50] batch [280/403] time 0.082 (0.100) data 0.000 (0.015) loss 1.6442 (1.8779) ce_loss 0.5996 (0.8367) loss_zs_kd 2.4362 (2.4248) loss_oracle 0.5981 (0.6150) acc 71.8750 (70.2567) kd_loss 0.7456 (0.7337) lr 3.6258e-04 eta 0:08:14
epoch [38/50] batch [300/403] time 0.081 (0.099) data 0.000 (0.014) loss 1.7570 (1.8776) ce_loss 0.7305 (0.8358) loss_zs_kd 2.2678 (2.4353) loss_oracle 0.5563 (0.6146) acc 68.7500 (70.2917) kd_loss 0.7483 (0.7345) lr 3.6258e-04 eta 0:08:07
epoch [38/50] batch [320/403] time 0.089 (0.098) data 0.000 (0.013) loss 1.8110 (1.8820) ce_loss 0.7773 (0.8404) loss_zs_kd 2.3601 (2.4269) loss_oracle 0.6452 (0.6145) acc 68.7500 (69.9609) kd_loss 0.7111 (0.7344) lr 3.6258e-04 eta 0:08:01
epoch [38/50] batch [340/403] time 0.083 (0.097) data 0.000 (0.012) loss 2.0280 (1.8879) ce_loss 1.0713 (0.8477) loss_zs_kd 1.7237 (2.4231) loss_oracle 0.5828 (0.6132) acc 65.6250 (69.6140) kd_loss 0.6653 (0.7336) lr 3.6258e-04 eta 0:07:56
epoch [38/50] batch [360/403] time 0.081 (0.097) data 0.000 (0.012) loss 1.8021 (1.8912) ce_loss 0.7554 (0.8518) loss_zs_kd 2.9189 (2.4224) loss_oracle 0.5837 (0.6119) acc 75.0000 (69.4358) kd_loss 0.7548 (0.7334) lr 3.6258e-04 eta 0:07:51
epoch [38/50] batch [380/403] time 0.088 (0.096) data 0.000 (0.011) loss 2.1235 (1.8872) ce_loss 1.0654 (0.8479) loss_zs_kd 2.7653 (2.4256) loss_oracle 0.5963 (0.6114) acc 62.5000 (69.7039) kd_loss 0.7599 (0.7336) lr 3.6258e-04 eta 0:07:45
epoch [38/50] batch [400/403] time 0.074 (0.095) data 0.000 (0.010) loss 1.9470 (1.8877) ce_loss 0.9053 (0.8486) loss_zs_kd 2.5503 (2.4242) loss_oracle 0.5893 (0.6117) acc 71.8750 (69.5859) kd_loss 0.7471 (0.7333) lr 3.6258e-04 eta 0:07:39
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,070
* accuracy: 73.5%
* error: 26.5%
* macro_f1: 61.8%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,543
* accuracy: 43.2%
* error: 56.8%
* macro_f1: 31.9%
******* Domain 4 best val acc:      73.6%, epoch: 34 *******
******* Domain 4 best val test acc: 41.2%, epoch: 34 *******
******* Domain 4 best test acc:     45.4%, epoch: 30 *******
epoch [39/50] batch [20/403] time 0.097 (0.260) data 0.000 (0.169) loss 2.0269 (1.8664) ce_loss 1.0283 (0.8359) loss_zs_kd 2.4008 (2.4008) loss_oracle 0.5793 (0.5920) acc 65.6250 (71.2500) kd_loss 0.7089 (0.7345) lr 3.1545e-04 eta 0:20:53
epoch [39/50] batch [40/403] time 0.074 (0.172) data 0.000 (0.085) loss 1.7154 (1.9064) ce_loss 0.7642 (0.8778) loss_zs_kd 2.2382 (2.3938) loss_oracle 0.5836 (0.5999) acc 71.8750 (69.6875) kd_loss 0.6594 (0.7286) lr 3.1545e-04 eta 0:13:46
epoch [39/50] batch [60/403] time 0.097 (0.143) data 0.000 (0.057) loss 1.8097 (1.8940) ce_loss 0.7515 (0.8639) loss_zs_kd 2.5151 (2.3880) loss_oracle 0.6438 (0.6050) acc 71.8750 (70.3125) kd_loss 0.7364 (0.7275) lr 3.1545e-04 eta 0:11:24
epoch [39/50] batch [80/403] time 0.069 (0.126) data 0.000 (0.042) loss 1.6681 (1.8955) ce_loss 0.6582 (0.8681) loss_zs_kd 2.6659 (2.4109) loss_oracle 0.5615 (0.6018) acc 75.0000 (69.9219) kd_loss 0.7291 (0.7265) lr 3.1545e-04 eta 0:09:58
epoch [39/50] batch [100/403] time 0.086 (0.117) data 0.000 (0.034) loss 2.0254 (1.8936) ce_loss 0.9746 (0.8646) loss_zs_kd 2.4860 (2.4101) loss_oracle 0.6166 (0.6043) acc 75.0000 (69.7812) kd_loss 0.7425 (0.7269) lr 3.1545e-04 eta 0:09:11
epoch [39/50] batch [120/403] time 0.082 (0.111) data 0.000 (0.028) loss 2.2712 (1.8824) ce_loss 1.2207 (0.8520) loss_zs_kd 2.6756 (2.4263) loss_oracle 0.6178 (0.6025) acc 53.1250 (70.0260) kd_loss 0.7416 (0.7291) lr 3.1545e-04 eta 0:08:45
epoch [39/50] batch [140/403] time 0.091 (0.107) data 0.000 (0.024) loss 1.7547 (1.8854) ce_loss 0.7876 (0.8543) loss_zs_kd 2.4182 (2.4141) loss_oracle 0.5422 (0.6061) acc 68.7500 (69.9107) kd_loss 0.6961 (0.7280) lr 3.1545e-04 eta 0:08:24
epoch [39/50] batch [160/403] time 0.095 (0.104) data 0.000 (0.021) loss 1.5566 (1.8844) ce_loss 0.5034 (0.8503) loss_zs_kd 2.2620 (2.3968) loss_oracle 0.6568 (0.6105) acc 87.5000 (70.0195) kd_loss 0.7248 (0.7288) lr 3.1545e-04 eta 0:08:04
epoch [39/50] batch [180/403] time 0.084 (0.101) data 0.000 (0.019) loss 1.9247 (1.8885) ce_loss 0.8379 (0.8525) loss_zs_kd 2.2745 (2.3949) loss_oracle 0.5725 (0.6106) acc 78.1250 (69.6181) kd_loss 0.8006 (0.7307) lr 3.1545e-04 eta 0:07:52
epoch [39/50] batch [200/403] time 0.076 (0.099) data 0.000 (0.017) loss 1.9936 (1.8848) ce_loss 1.0020 (0.8491) loss_zs_kd 2.3795 (2.3934) loss_oracle 0.5966 (0.6106) acc 62.5000 (69.8125) kd_loss 0.6933 (0.7304) lr 3.1545e-04 eta 0:07:39
epoch [39/50] batch [220/403] time 0.068 (0.097) data 0.000 (0.016) loss 1.6843 (1.8836) ce_loss 0.7173 (0.8476) loss_zs_kd 2.3710 (2.4000) loss_oracle 0.5376 (0.6103) acc 71.8750 (69.9432) kd_loss 0.6982 (0.7308) lr 3.1545e-04 eta 0:07:28
epoch [39/50] batch [240/403] time 0.087 (0.096) data 0.000 (0.014) loss 2.1044 (1.8821) ce_loss 1.1289 (0.8473) loss_zs_kd 2.4393 (2.3944) loss_oracle 0.6313 (0.6087) acc 53.1250 (70.0781) kd_loss 0.6598 (0.7305) lr 3.1545e-04 eta 0:07:22
epoch [39/50] batch [260/403] time 0.082 (0.095) data 0.000 (0.013) loss 2.0997 (1.8826) ce_loss 0.9995 (0.8466) loss_zs_kd 2.3581 (2.3951) loss_oracle 0.6938 (0.6088) acc 65.6250 (70.0481) kd_loss 0.7533 (0.7316) lr 3.1545e-04 eta 0:07:15
epoch [39/50] batch [280/403] time 0.082 (0.094) data 0.000 (0.012) loss 1.9207 (1.8832) ce_loss 0.8198 (0.8459) loss_zs_kd 2.3501 (2.4021) loss_oracle 0.6752 (0.6102) acc 68.7500 (69.8996) kd_loss 0.7633 (0.7322) lr 3.1545e-04 eta 0:07:09
epoch [39/50] batch [300/403] time 0.089 (0.094) data 0.000 (0.012) loss 1.8792 (1.8809) ce_loss 0.8550 (0.8437) loss_zs_kd 2.4130 (2.4051) loss_oracle 0.5983 (0.6091) acc 75.0000 (69.9896) kd_loss 0.7251 (0.7327) lr 3.1545e-04 eta 0:07:05
epoch [39/50] batch [320/403] time 0.086 (0.093) data 0.000 (0.011) loss 1.8282 (1.8848) ce_loss 0.7886 (0.8478) loss_zs_kd 2.2638 (2.4049) loss_oracle 0.6837 (0.6087) acc 75.0000 (70.0000) kd_loss 0.6978 (0.7327) lr 3.1545e-04 eta 0:07:01
epoch [39/50] batch [340/403] time 0.082 (0.093) data 0.000 (0.010) loss 1.8786 (1.8840) ce_loss 0.9268 (0.8475) loss_zs_kd 2.1854 (2.4024) loss_oracle 0.5880 (0.6079) acc 62.5000 (70.0368) kd_loss 0.6579 (0.7325) lr 3.1545e-04 eta 0:06:56
epoch [39/50] batch [360/403] time 0.081 (0.092) data 0.000 (0.010) loss 1.8243 (1.8797) ce_loss 0.7842 (0.8432) loss_zs_kd 2.3104 (2.3999) loss_oracle 0.6835 (0.6090) acc 68.7500 (70.0955) kd_loss 0.6984 (0.7320) lr 3.1545e-04 eta 0:06:51
epoch [39/50] batch [380/403] time 0.085 (0.091) data 0.000 (0.009) loss 1.7797 (1.8771) ce_loss 0.7358 (0.8396) loss_zs_kd 2.5191 (2.4022) loss_oracle 0.6035 (0.6093) acc 71.8750 (70.2138) kd_loss 0.7421 (0.7328) lr 3.1545e-04 eta 0:06:47
epoch [39/50] batch [400/403] time 0.075 (0.091) data 0.000 (0.009) loss 1.7698 (1.8795) ce_loss 0.7085 (0.8414) loss_zs_kd 2.5507 (2.4057) loss_oracle 0.6152 (0.6099) acc 81.2500 (70.1875) kd_loss 0.7537 (0.7332) lr 3.1545e-04 eta 0:06:43
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,071
* accuracy: 73.6%
* error: 26.4%
* macro_f1: 62.5%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,497
* accuracy: 42.4%
* error: 57.6%
* macro_f1: 31.0%
******* Domain 4 best val acc:      73.6%, epoch: 34 *******
******* Domain 4 best val test acc: 41.2%, epoch: 34 *******
******* Domain 4 best test acc:     45.4%, epoch: 30 *******
epoch [40/50] batch [20/403] time 0.079 (0.252) data 0.000 (0.167) loss 1.8811 (1.8748) ce_loss 0.8750 (0.8489) loss_zs_kd 2.8120 (2.4870) loss_oracle 0.6192 (0.6123) acc 68.7500 (69.3750) kd_loss 0.6965 (0.7197) lr 2.7103e-04 eta 0:18:31
epoch [40/50] batch [40/403] time 0.082 (0.168) data 0.000 (0.084) loss 1.9451 (1.8814) ce_loss 0.9458 (0.8622) loss_zs_kd 2.8707 (2.4991) loss_oracle 0.5246 (0.6027) acc 62.5000 (68.5156) kd_loss 0.7370 (0.7179) lr 2.7103e-04 eta 0:12:16
epoch [40/50] batch [60/403] time 0.090 (0.140) data 0.000 (0.056) loss 1.7368 (1.8771) ce_loss 0.6021 (0.8528) loss_zs_kd 2.6611 (2.4944) loss_oracle 0.6615 (0.6031) acc 71.8750 (68.6458) kd_loss 0.8040 (0.7228) lr 2.7103e-04 eta 0:10:13
epoch [40/50] batch [80/403] time 0.092 (0.127) data 0.000 (0.042) loss 1.9101 (1.8721) ce_loss 0.8481 (0.8478) loss_zs_kd 2.3585 (2.4761) loss_oracle 0.5925 (0.6056) acc 65.6250 (69.0625) kd_loss 0.7657 (0.7216) lr 2.7103e-04 eta 0:09:11
epoch [40/50] batch [100/403] time 0.095 (0.118) data 0.000 (0.034) loss 1.6730 (1.8685) ce_loss 0.6167 (0.8406) loss_zs_kd 2.9055 (2.4867) loss_oracle 0.6402 (0.6075) acc 78.1250 (69.6875) kd_loss 0.7362 (0.7241) lr 2.7103e-04 eta 0:08:31
epoch [40/50] batch [120/403] time 0.085 (0.112) data 0.000 (0.028) loss 1.8898 (1.8730) ce_loss 0.8472 (0.8442) loss_zs_kd 2.1923 (2.4815) loss_oracle 0.6223 (0.6062) acc 65.6250 (69.7396) kd_loss 0.7315 (0.7257) lr 2.7103e-04 eta 0:08:05
epoch [40/50] batch [140/403] time 0.079 (0.109) data 0.000 (0.024) loss 2.2806 (1.8915) ce_loss 1.2246 (0.8603) loss_zs_kd 2.8111 (2.4760) loss_oracle 0.6105 (0.6065) acc 56.2500 (69.4866) kd_loss 0.7507 (0.7280) lr 2.7103e-04 eta 0:07:47
epoch [40/50] batch [160/403] time 0.091 (0.106) data 0.000 (0.021) loss 1.9013 (1.8845) ce_loss 0.8408 (0.8525) loss_zs_kd 2.5114 (2.4553) loss_oracle 0.5924 (0.6066) acc 68.7500 (69.8633) kd_loss 0.7643 (0.7287) lr 2.7103e-04 eta 0:07:32
epoch [40/50] batch [180/403] time 0.083 (0.104) data 0.000 (0.019) loss 1.5566 (1.8827) ce_loss 0.4817 (0.8489) loss_zs_kd 1.9789 (2.4400) loss_oracle 0.6778 (0.6082) acc 87.5000 (70.0000) kd_loss 0.7361 (0.7298) lr 2.7103e-04 eta 0:07:20
epoch [40/50] batch [200/403] time 0.083 (0.102) data 0.000 (0.017) loss 1.7502 (1.8847) ce_loss 0.8052 (0.8503) loss_zs_kd 2.0964 (2.4466) loss_oracle 0.5318 (0.6072) acc 62.5000 (69.8750) kd_loss 0.6791 (0.7308) lr 2.7103e-04 eta 0:07:10
epoch [40/50] batch [220/403] time 0.080 (0.100) data 0.000 (0.015) loss 1.7950 (1.8872) ce_loss 0.7397 (0.8523) loss_zs_kd 2.5867 (2.4404) loss_oracle 0.6098 (0.6070) acc 68.7500 (69.8153) kd_loss 0.7503 (0.7314) lr 2.7103e-04 eta 0:07:01
epoch [40/50] batch [240/403] time 0.089 (0.099) data 0.000 (0.014) loss 2.0736 (1.8876) ce_loss 1.0146 (0.8516) loss_zs_kd 2.3492 (2.4237) loss_oracle 0.5854 (0.6069) acc 65.6250 (69.7135) kd_loss 0.7663 (0.7326) lr 2.7103e-04 eta 0:06:53
epoch [40/50] batch [260/403] time 0.080 (0.097) data 0.000 (0.013) loss 1.8137 (1.8859) ce_loss 0.7051 (0.8488) loss_zs_kd 2.0406 (2.4318) loss_oracle 0.7000 (0.6076) acc 75.0000 (69.6875) kd_loss 0.7586 (0.7333) lr 2.7103e-04 eta 0:06:46
epoch [40/50] batch [280/403] time 0.088 (0.096) data 0.000 (0.012) loss 1.9624 (1.8884) ce_loss 0.9111 (0.8511) loss_zs_kd 2.9561 (2.4285) loss_oracle 0.5849 (0.6082) acc 71.8750 (69.5871) kd_loss 0.7588 (0.7333) lr 2.7103e-04 eta 0:06:38
epoch [40/50] batch [300/403] time 0.064 (0.096) data 0.000 (0.011) loss 1.7629 (1.8900) ce_loss 0.6426 (0.8516) loss_zs_kd 2.3214 (2.4291) loss_oracle 0.6557 (0.6088) acc 81.2500 (69.6667) kd_loss 0.7925 (0.7340) lr 2.7103e-04 eta 0:06:36
epoch [40/50] batch [320/403] time 0.085 (0.095) data 0.000 (0.011) loss 1.7550 (1.8856) ce_loss 0.7319 (0.8475) loss_zs_kd 2.7302 (2.4325) loss_oracle 0.6533 (0.6088) acc 68.7500 (69.7363) kd_loss 0.6965 (0.7337) lr 2.7103e-04 eta 0:06:28
epoch [40/50] batch [340/403] time 0.080 (0.094) data 0.000 (0.010) loss 1.7190 (1.8840) ce_loss 0.6753 (0.8462) loss_zs_kd 1.9018 (2.4357) loss_oracle 0.6554 (0.6095) acc 78.1250 (69.9724) kd_loss 0.7160 (0.7331) lr 2.7103e-04 eta 0:06:24
epoch [40/50] batch [360/403] time 0.085 (0.093) data 0.000 (0.010) loss 1.8488 (1.8790) ce_loss 0.9004 (0.8419) loss_zs_kd 2.5926 (2.4328) loss_oracle 0.5647 (0.6090) acc 65.6250 (70.2083) kd_loss 0.6660 (0.7327) lr 2.7103e-04 eta 0:06:20
epoch [40/50] batch [380/403] time 0.089 (0.093) data 0.000 (0.009) loss 1.8338 (1.8783) ce_loss 0.7261 (0.8412) loss_zs_kd 2.8963 (2.4313) loss_oracle 0.6135 (0.6092) acc 75.0000 (70.1891) kd_loss 0.8010 (0.7324) lr 2.7103e-04 eta 0:06:17
epoch [40/50] batch [400/403] time 0.076 (0.093) data 0.000 (0.009) loss 1.9601 (1.8785) ce_loss 0.9087 (0.8414) loss_zs_kd 2.5794 (2.4315) loss_oracle 0.6225 (0.6098) acc 75.0000 (70.2500) kd_loss 0.7401 (0.7322) lr 2.7103e-04 eta 0:06:13
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,080
* accuracy: 73.7%
* error: 26.3%
* macro_f1: 62.2%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,604
* accuracy: 44.3%
* error: 55.7%
* macro_f1: 32.1%
******* Domain 4 best val acc:      73.7%, epoch: 40 *******
******* Domain 4 best val test acc: 44.3%, epoch: 40 *******
******* Domain 4 best test acc:     45.4%, epoch: 30 *******
epoch [41/50] batch [20/403] time 0.084 (0.301) data 0.000 (0.212) loss 1.9012 (1.9103) ce_loss 0.8228 (0.8653) loss_zs_kd 2.7349 (2.4430) loss_oracle 0.6343 (0.6335) acc 68.7500 (68.2812) kd_loss 0.7613 (0.7283) lr 2.2949e-04 eta 0:20:06
epoch [41/50] batch [40/403] time 0.091 (0.193) data 0.000 (0.106) loss 1.6091 (1.8870) ce_loss 0.5972 (0.8508) loss_zs_kd 2.2567 (2.4536) loss_oracle 0.5574 (0.6192) acc 81.2500 (69.6094) kd_loss 0.7332 (0.7267) lr 2.2949e-04 eta 0:12:49
epoch [41/50] batch [60/403] time 0.076 (0.156) data 0.000 (0.071) loss 1.7806 (1.8881) ce_loss 0.7964 (0.8543) loss_zs_kd 2.4708 (2.4638) loss_oracle 0.5966 (0.6170) acc 65.6250 (68.9062) kd_loss 0.6859 (0.7253) lr 2.2949e-04 eta 0:10:20
epoch [41/50] batch [80/403] time 0.083 (0.137) data 0.000 (0.053) loss 1.9764 (1.8815) ce_loss 0.9399 (0.8471) loss_zs_kd 2.3910 (2.4634) loss_oracle 0.6243 (0.6153) acc 65.6250 (69.0625) kd_loss 0.7243 (0.7267) lr 2.2949e-04 eta 0:09:02
epoch [41/50] batch [100/403] time 0.091 (0.127) data 0.000 (0.043) loss 2.0891 (1.8848) ce_loss 0.9990 (0.8468) loss_zs_kd 3.0477 (2.4582) loss_oracle 0.6433 (0.6172) acc 65.6250 (69.3438) kd_loss 0.7684 (0.7294) lr 2.2949e-04 eta 0:08:20
epoch [41/50] batch [120/403] time 0.081 (0.119) data 0.000 (0.035) loss 1.6422 (1.8796) ce_loss 0.6470 (0.8431) loss_zs_kd 2.3767 (2.4448) loss_oracle 0.5492 (0.6159) acc 68.7500 (69.7917) kd_loss 0.7206 (0.7285) lr 2.2949e-04 eta 0:07:46
epoch [41/50] batch [140/403] time 0.080 (0.114) data 0.000 (0.030) loss 1.9382 (1.8693) ce_loss 0.9722 (0.8356) loss_zs_kd 2.3110 (2.4279) loss_oracle 0.6007 (0.6126) acc 65.6250 (69.9554) kd_loss 0.6657 (0.7274) lr 2.2949e-04 eta 0:07:24
epoch [41/50] batch [160/403] time 0.071 (0.111) data 0.000 (0.027) loss 1.5768 (1.8718) ce_loss 0.5254 (0.8371) loss_zs_kd 2.2293 (2.4187) loss_oracle 0.5610 (0.6126) acc 84.3750 (70.0391) kd_loss 0.7709 (0.7284) lr 2.2949e-04 eta 0:07:08
epoch [41/50] batch [180/403] time 0.080 (0.107) data 0.000 (0.024) loss 1.6123 (1.8650) ce_loss 0.6997 (0.8312) loss_zs_kd 2.9036 (2.4286) loss_oracle 0.5204 (0.6130) acc 71.8750 (70.2431) kd_loss 0.6524 (0.7273) lr 2.2949e-04 eta 0:06:53
epoch [41/50] batch [200/403] time 0.088 (0.105) data 0.001 (0.021) loss 1.8880 (1.8639) ce_loss 0.9072 (0.8292) loss_zs_kd 2.1523 (2.4410) loss_oracle 0.5396 (0.6152) acc 65.6250 (70.3438) kd_loss 0.7109 (0.7271) lr 2.2949e-04 eta 0:06:43
epoch [41/50] batch [220/403] time 0.079 (0.104) data 0.000 (0.019) loss 1.9571 (1.8648) ce_loss 0.9097 (0.8297) loss_zs_kd 2.8037 (2.4331) loss_oracle 0.6769 (0.6152) acc 62.5000 (70.2415) kd_loss 0.7090 (0.7275) lr 2.2949e-04 eta 0:06:35
epoch [41/50] batch [240/403] time 0.085 (0.102) data 0.000 (0.018) loss 1.7251 (1.8637) ce_loss 0.7217 (0.8269) loss_zs_kd 2.4331 (2.4316) loss_oracle 0.5730 (0.6158) acc 78.1250 (70.4036) kd_loss 0.7169 (0.7290) lr 2.2949e-04 eta 0:06:27
epoch [41/50] batch [260/403] time 0.075 (0.100) data 0.000 (0.017) loss 1.9205 (1.8635) ce_loss 0.9438 (0.8259) loss_zs_kd 2.5694 (2.4353) loss_oracle 0.5847 (0.6164) acc 68.7500 (70.4087) kd_loss 0.6843 (0.7293) lr 2.2949e-04 eta 0:06:18
epoch [41/50] batch [280/403] time 0.078 (0.099) data 0.000 (0.015) loss 1.6332 (1.8662) ce_loss 0.6157 (0.8277) loss_zs_kd 2.2324 (2.4445) loss_oracle 0.6281 (0.6167) acc 81.2500 (70.1451) kd_loss 0.7034 (0.7301) lr 2.2949e-04 eta 0:06:12
epoch [41/50] batch [300/403] time 0.096 (0.098) data 0.000 (0.014) loss 1.9008 (1.8667) ce_loss 0.8774 (0.8283) loss_zs_kd 2.1796 (2.4387) loss_oracle 0.5809 (0.6154) acc 65.6250 (70.1979) kd_loss 0.7329 (0.7307) lr 2.2949e-04 eta 0:06:05
epoch [41/50] batch [320/403] time 0.084 (0.097) data 0.000 (0.013) loss 1.7727 (1.8667) ce_loss 0.7070 (0.8283) loss_zs_kd 2.7825 (2.4384) loss_oracle 0.6600 (0.6159) acc 71.8750 (70.2441) kd_loss 0.7357 (0.7305) lr 2.2949e-04 eta 0:06:00
epoch [41/50] batch [340/403] time 0.078 (0.096) data 0.000 (0.013) loss 1.6553 (1.8659) ce_loss 0.6318 (0.8273) loss_zs_kd 2.1361 (2.4444) loss_oracle 0.6470 (0.6162) acc 71.8750 (70.2390) kd_loss 0.7000 (0.7304) lr 2.2949e-04 eta 0:05:56
epoch [41/50] batch [360/403] time 0.090 (0.096) data 0.000 (0.012) loss 1.5875 (1.8657) ce_loss 0.6255 (0.8273) loss_zs_kd 1.7844 (2.4435) loss_oracle 0.5602 (0.6151) acc 78.1250 (70.2344) kd_loss 0.6819 (0.7309) lr 2.2949e-04 eta 0:05:51
epoch [41/50] batch [380/403] time 0.083 (0.095) data 0.000 (0.011) loss 1.8011 (1.8670) ce_loss 0.8711 (0.8290) loss_zs_kd 2.7706 (2.4442) loss_oracle 0.5386 (0.6155) acc 71.8750 (70.2056) kd_loss 0.6607 (0.7302) lr 2.2949e-04 eta 0:05:46
epoch [41/50] batch [400/403] time 0.073 (0.094) data 0.000 (0.011) loss 1.8068 (1.8691) ce_loss 0.7881 (0.8315) loss_zs_kd 2.6743 (2.4441) loss_oracle 0.6586 (0.6158) acc 75.0000 (70.0859) kd_loss 0.6894 (0.7297) lr 2.2949e-04 eta 0:05:42
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,086
* accuracy: 73.8%
* error: 26.2%
* macro_f1: 62.5%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,643
* accuracy: 44.9%
* error: 55.1%
* macro_f1: 32.0%
******* Domain 4 best val acc:      73.8%, epoch: 41 *******
******* Domain 4 best val test acc: 44.9%, epoch: 41 *******
******* Domain 4 best test acc:     45.4%, epoch: 30 *******
epoch [42/50] batch [20/403] time 0.088 (0.262) data 0.000 (0.176) loss 1.9915 (1.8572) ce_loss 0.9277 (0.8138) loss_zs_kd 2.3477 (2.4127) loss_oracle 0.7232 (0.6158) acc 68.7500 (71.4062) kd_loss 0.7022 (0.7355) lr 1.9098e-04 eta 0:15:45
epoch [42/50] batch [40/403] time 0.087 (0.174) data 0.000 (0.088) loss 1.7483 (1.8511) ce_loss 0.7793 (0.8279) loss_zs_kd 2.4376 (2.4319) loss_oracle 0.5969 (0.6034) acc 75.0000 (70.9375) kd_loss 0.6706 (0.7215) lr 1.9098e-04 eta 0:10:25
epoch [42/50] batch [60/403] time 0.081 (0.144) data 0.000 (0.059) loss 1.8901 (1.8710) ce_loss 0.9287 (0.8409) loss_zs_kd 2.4842 (2.4736) loss_oracle 0.6486 (0.6093) acc 59.3750 (71.0938) kd_loss 0.6371 (0.7255) lr 1.9098e-04 eta 0:08:34
epoch [42/50] batch [80/403] time 0.092 (0.130) data 0.000 (0.044) loss 2.4928 (1.8970) ce_loss 1.4873 (0.8688) loss_zs_kd 2.6230 (2.4541) loss_oracle 0.6020 (0.6068) acc 46.8750 (70.1953) kd_loss 0.7044 (0.7248) lr 1.9098e-04 eta 0:07:40
epoch [42/50] batch [100/403] time 0.082 (0.121) data 0.000 (0.035) loss 1.7627 (1.8882) ce_loss 0.7642 (0.8608) loss_zs_kd 2.4225 (2.4698) loss_oracle 0.6293 (0.6072) acc 75.0000 (70.0625) kd_loss 0.6839 (0.7239) lr 1.9098e-04 eta 0:07:07
epoch [42/50] batch [120/403] time 0.091 (0.115) data 0.000 (0.030) loss 2.0867 (1.8813) ce_loss 1.0020 (0.8543) loss_zs_kd 2.1844 (2.4492) loss_oracle 0.6039 (0.6111) acc 75.0000 (70.3906) kd_loss 0.7828 (0.7215) lr 1.9098e-04 eta 0:06:44
epoch [42/50] batch [140/403] time 0.085 (0.111) data 0.000 (0.025) loss 1.8958 (1.8775) ce_loss 0.8936 (0.8527) loss_zs_kd 2.4663 (2.4479) loss_oracle 0.5594 (0.6081) acc 75.0000 (70.1339) kd_loss 0.7225 (0.7207) lr 1.9098e-04 eta 0:06:27
epoch [42/50] batch [160/403] time 0.090 (0.108) data 0.001 (0.022) loss 2.0517 (1.8780) ce_loss 1.0605 (0.8540) loss_zs_kd 2.1988 (2.4537) loss_oracle 0.6516 (0.6079) acc 65.6250 (69.8633) kd_loss 0.6653 (0.7201) lr 1.9098e-04 eta 0:06:13
epoch [42/50] batch [180/403] time 0.082 (0.105) data 0.000 (0.020) loss 1.9675 (1.8844) ce_loss 0.8911 (0.8608) loss_zs_kd 1.9833 (2.4561) loss_oracle 0.6357 (0.6067) acc 75.0000 (69.7222) kd_loss 0.7586 (0.7203) lr 1.9098e-04 eta 0:06:01
epoch [42/50] batch [200/403] time 0.087 (0.103) data 0.000 (0.018) loss 1.8307 (1.8795) ce_loss 0.8354 (0.8562) loss_zs_kd 2.6481 (2.4516) loss_oracle 0.6250 (0.6055) acc 68.7500 (70.0312) kd_loss 0.6828 (0.7205) lr 1.9098e-04 eta 0:05:52
epoch [42/50] batch [220/403] time 0.085 (0.101) data 0.000 (0.016) loss 1.7180 (1.8706) ce_loss 0.7393 (0.8487) loss_zs_kd 2.9263 (2.4311) loss_oracle 0.5498 (0.6042) acc 75.0000 (70.5114) kd_loss 0.7038 (0.7198) lr 1.9098e-04 eta 0:05:45
epoch [42/50] batch [240/403] time 0.091 (0.100) data 0.000 (0.015) loss 1.9975 (1.8662) ce_loss 1.0166 (0.8430) loss_zs_kd 2.6088 (2.4315) loss_oracle 0.6143 (0.6050) acc 71.8750 (70.5078) kd_loss 0.6738 (0.7208) lr 1.9098e-04 eta 0:05:39
epoch [42/50] batch [260/403] time 0.082 (0.099) data 0.000 (0.014) loss 1.7596 (1.8624) ce_loss 0.6958 (0.8386) loss_zs_kd 2.4034 (2.4285) loss_oracle 0.7097 (0.6054) acc 78.1250 (70.7812) kd_loss 0.7089 (0.7211) lr 1.9098e-04 eta 0:05:32
epoch [42/50] batch [280/403] time 0.085 (0.098) data 0.000 (0.013) loss 1.8616 (1.8567) ce_loss 0.7998 (0.8360) loss_zs_kd 2.7620 (2.4314) loss_oracle 0.6010 (0.6029) acc 68.7500 (70.6585) kd_loss 0.7613 (0.7192) lr 1.9098e-04 eta 0:05:27
epoch [42/50] batch [300/403] time 0.093 (0.097) data 0.000 (0.012) loss 1.6334 (1.8504) ce_loss 0.5723 (0.8294) loss_zs_kd 2.2443 (2.4290) loss_oracle 0.5674 (0.6023) acc 75.0000 (70.8750) kd_loss 0.7774 (0.7199) lr 1.9098e-04 eta 0:05:23
epoch [42/50] batch [320/403] time 0.089 (0.097) data 0.000 (0.011) loss 2.1977 (1.8536) ce_loss 1.2197 (0.8331) loss_zs_kd 3.0051 (2.4292) loss_oracle 0.5404 (0.6017) acc 62.5000 (70.9082) kd_loss 0.7078 (0.7196) lr 1.9098e-04 eta 0:05:19
epoch [42/50] batch [340/403] time 0.071 (0.096) data 0.000 (0.011) loss 1.9370 (1.8530) ce_loss 0.9258 (0.8329) loss_zs_kd 2.9355 (2.4302) loss_oracle 0.6265 (0.6009) acc 75.0000 (70.8824) kd_loss 0.6980 (0.7197) lr 1.9098e-04 eta 0:05:15
epoch [42/50] batch [360/403] time 0.084 (0.095) data 0.000 (0.010) loss 1.6505 (1.8560) ce_loss 0.6162 (0.8356) loss_zs_kd 1.8197 (2.4291) loss_oracle 0.6168 (0.6003) acc 78.1250 (70.7378) kd_loss 0.7259 (0.7202) lr 1.9098e-04 eta 0:05:10
epoch [42/50] batch [380/403] time 0.086 (0.095) data 0.000 (0.010) loss 1.7033 (1.8558) ce_loss 0.7583 (0.8352) loss_zs_kd 2.1172 (2.4267) loss_oracle 0.5785 (0.6005) acc 65.6250 (70.7484) kd_loss 0.6558 (0.7204) lr 1.9098e-04 eta 0:05:07
epoch [42/50] batch [400/403] time 0.075 (0.094) data 0.000 (0.009) loss 1.7730 (1.8603) ce_loss 0.7012 (0.8381) loss_zs_kd 1.9731 (2.4279) loss_oracle 0.6706 (0.6015) acc 75.0000 (70.5156) kd_loss 0.7366 (0.7215) lr 1.9098e-04 eta 0:05:03
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,090
* accuracy: 73.9%
* error: 26.1%
* macro_f1: 63.0%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,691
* accuracy: 45.7%
* error: 54.3%
* macro_f1: 33.9%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      73.9%, epoch: 42 *******
******* Domain 4 best val test acc: 45.7%, epoch: 42 *******
******* Domain 4 best test acc:     45.7%, epoch: 42 *******
epoch [43/50] batch [20/403] time 0.086 (0.311) data 0.000 (0.218) loss 2.5056 (1.9157) ce_loss 1.4502 (0.8655) loss_zs_kd 2.8677 (2.4639) loss_oracle 0.5920 (0.6154) acc 53.1250 (70.0000) kd_loss 0.7594 (0.7425) lr 1.5567e-04 eta 0:16:35
epoch [43/50] batch [40/403] time 0.087 (0.198) data 0.000 (0.109) loss 1.9830 (1.8940) ce_loss 0.9751 (0.8529) loss_zs_kd 2.0364 (2.4458) loss_oracle 0.5441 (0.6051) acc 65.6250 (69.8438) kd_loss 0.7359 (0.7386) lr 1.5567e-04 eta 0:10:30
epoch [43/50] batch [60/403] time 0.093 (0.161) data 0.000 (0.073) loss 1.8030 (1.8649) ce_loss 0.7856 (0.8243) loss_zs_kd 2.3190 (2.4599) loss_oracle 0.5860 (0.6048) acc 71.8750 (71.3542) kd_loss 0.7244 (0.7382) lr 1.5567e-04 eta 0:08:27
epoch [43/50] batch [80/403] time 0.083 (0.142) data 0.000 (0.055) loss 1.7858 (1.8647) ce_loss 0.8232 (0.8250) loss_zs_kd 2.1317 (2.4375) loss_oracle 0.6093 (0.6111) acc 62.5000 (70.5859) kd_loss 0.6579 (0.7341) lr 1.5567e-04 eta 0:07:27
epoch [43/50] batch [100/403] time 0.081 (0.130) data 0.000 (0.044) loss 1.7326 (1.8702) ce_loss 0.7861 (0.8331) loss_zs_kd 2.3925 (2.4496) loss_oracle 0.5754 (0.6139) acc 71.8750 (70.0938) kd_loss 0.6588 (0.7301) lr 1.5567e-04 eta 0:06:46
epoch [43/50] batch [120/403] time 0.083 (0.122) data 0.001 (0.037) loss 1.9943 (1.8746) ce_loss 1.1025 (0.8384) loss_zs_kd 2.2236 (2.4500) loss_oracle 0.5356 (0.6148) acc 59.3750 (69.6094) kd_loss 0.6240 (0.7288) lr 1.5567e-04 eta 0:06:19
epoch [43/50] batch [140/403] time 0.094 (0.117) data 0.000 (0.031) loss 1.8971 (1.8740) ce_loss 0.8364 (0.8374) loss_zs_kd 2.6763 (2.4457) loss_oracle 0.6306 (0.6149) acc 75.0000 (69.5536) kd_loss 0.7454 (0.7291) lr 1.5567e-04 eta 0:06:01
epoch [43/50] batch [160/403] time 0.090 (0.113) data 0.000 (0.028) loss 1.9186 (1.8710) ce_loss 0.8486 (0.8375) loss_zs_kd 2.7172 (2.4504) loss_oracle 0.6315 (0.6144) acc 68.7500 (69.5898) kd_loss 0.7542 (0.7263) lr 1.5567e-04 eta 0:05:46
epoch [43/50] batch [180/403] time 0.086 (0.110) data 0.000 (0.024) loss 1.9485 (1.8713) ce_loss 0.9302 (0.8395) loss_zs_kd 2.7830 (2.4518) loss_oracle 0.5938 (0.6140) acc 59.3750 (69.3403) kd_loss 0.7214 (0.7248) lr 1.5567e-04 eta 0:05:34
epoch [43/50] batch [200/403] time 0.087 (0.106) data 0.000 (0.022) loss 1.6541 (1.8685) ce_loss 0.7314 (0.8392) loss_zs_kd 2.3091 (2.4422) loss_oracle 0.5098 (0.6110) acc 71.8750 (69.2500) kd_loss 0.6678 (0.7238) lr 1.5567e-04 eta 0:05:21
epoch [43/50] batch [220/403] time 0.084 (0.104) data 0.000 (0.020) loss 1.4962 (1.8690) ce_loss 0.4973 (0.8395) loss_zs_kd 2.6578 (2.4497) loss_oracle 0.5900 (0.6110) acc 87.5000 (69.3040) kd_loss 0.7039 (0.7240) lr 1.5567e-04 eta 0:05:12
epoch [43/50] batch [240/403] time 0.087 (0.102) data 0.000 (0.018) loss 2.0383 (1.8691) ce_loss 0.9502 (0.8408) loss_zs_kd 2.5960 (2.4576) loss_oracle 0.6713 (0.6122) acc 62.5000 (69.2448) kd_loss 0.7524 (0.7221) lr 1.5567e-04 eta 0:05:05
epoch [43/50] batch [260/403] time 0.078 (0.101) data 0.000 (0.017) loss 1.9838 (1.8685) ce_loss 0.9844 (0.8395) loss_zs_kd 2.6747 (2.4605) loss_oracle 0.6089 (0.6124) acc 62.5000 (69.2788) kd_loss 0.6950 (0.7228) lr 1.5567e-04 eta 0:04:59
epoch [43/50] batch [280/403] time 0.080 (0.099) data 0.000 (0.016) loss 2.1273 (1.8632) ce_loss 1.1035 (0.8348) loss_zs_kd 2.7011 (2.4652) loss_oracle 0.5721 (0.6110) acc 56.2500 (69.4531) kd_loss 0.7377 (0.7229) lr 1.5567e-04 eta 0:04:52
epoch [43/50] batch [300/403] time 0.088 (0.098) data 0.000 (0.015) loss 1.6418 (1.8638) ce_loss 0.7021 (0.8343) loss_zs_kd 2.5731 (2.4627) loss_oracle 0.5600 (0.6112) acc 68.7500 (69.5521) kd_loss 0.6597 (0.7239) lr 1.5567e-04 eta 0:04:47
epoch [43/50] batch [320/403] time 0.082 (0.097) data 0.000 (0.014) loss 1.7712 (1.8668) ce_loss 0.7310 (0.8369) loss_zs_kd 2.9005 (2.4706) loss_oracle 0.6816 (0.6112) acc 71.8750 (69.4727) kd_loss 0.6995 (0.7243) lr 1.5567e-04 eta 0:04:42
epoch [43/50] batch [340/403] time 0.083 (0.096) data 0.000 (0.013) loss 1.8728 (1.8694) ce_loss 0.8140 (0.8383) loss_zs_kd 2.6110 (2.4671) loss_oracle 0.6547 (0.6119) acc 68.7500 (69.5037) kd_loss 0.7315 (0.7251) lr 1.5567e-04 eta 0:04:37
epoch [43/50] batch [360/403] time 0.080 (0.095) data 0.000 (0.012) loss 1.9628 (1.8687) ce_loss 0.8828 (0.8369) loss_zs_kd 3.2012 (2.4721) loss_oracle 0.6068 (0.6113) acc 62.5000 (69.6354) kd_loss 0.7765 (0.7261) lr 1.5567e-04 eta 0:04:33
epoch [43/50] batch [380/403] time 0.081 (0.095) data 0.000 (0.012) loss 1.9359 (1.8708) ce_loss 0.8755 (0.8396) loss_zs_kd 2.9347 (2.4740) loss_oracle 0.6622 (0.6115) acc 71.8750 (69.5888) kd_loss 0.7293 (0.7255) lr 1.5567e-04 eta 0:04:29
epoch [43/50] batch [400/403] time 0.081 (0.094) data 0.000 (0.011) loss 1.8107 (1.8716) ce_loss 0.8428 (0.8410) loss_zs_kd 2.4610 (2.4694) loss_oracle 0.5855 (0.6105) acc 68.7500 (69.5312) kd_loss 0.6752 (0.7253) lr 1.5567e-04 eta 0:04:25
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,090
* accuracy: 73.9%
* error: 26.1%
* macro_f1: 62.2%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,625
* accuracy: 44.6%
* error: 55.4%
* macro_f1: 32.6%
******* Domain 4 best val acc:      73.9%, epoch: 42 *******
******* Domain 4 best val test acc: 45.7%, epoch: 42 *******
******* Domain 4 best test acc:     45.7%, epoch: 42 *******
epoch [44/50] batch [20/403] time 0.083 (0.285) data 0.000 (0.202) loss 1.7821 (1.9111) ce_loss 0.6431 (0.8527) loss_zs_kd 2.2706 (2.3723) loss_oracle 0.6822 (0.6172) acc 81.2500 (70.1562) kd_loss 0.7979 (0.7498) lr 1.2369e-04 eta 0:13:16
epoch [44/50] batch [40/403] time 0.079 (0.181) data 0.000 (0.101) loss 1.6147 (1.8894) ce_loss 0.6416 (0.8473) loss_zs_kd 2.1320 (2.3926) loss_oracle 0.5688 (0.6091) acc 78.1250 (69.6875) kd_loss 0.6887 (0.7375) lr 1.2369e-04 eta 0:08:22
epoch [44/50] batch [60/403] time 0.094 (0.148) data 0.000 (0.067) loss 1.8459 (1.8786) ce_loss 0.8423 (0.8401) loss_zs_kd 2.3894 (2.3552) loss_oracle 0.6085 (0.6093) acc 78.1250 (70.0000) kd_loss 0.6994 (0.7338) lr 1.2369e-04 eta 0:06:47
epoch [44/50] batch [80/403] time 0.078 (0.132) data 0.000 (0.051) loss 2.0436 (1.8826) ce_loss 0.9863 (0.8454) loss_zs_kd 2.1028 (2.3873) loss_oracle 0.5961 (0.6085) acc 65.6250 (70.8594) kd_loss 0.7592 (0.7330) lr 1.2369e-04 eta 0:06:02
epoch [44/50] batch [100/403] time 0.084 (0.122) data 0.000 (0.041) loss 1.8114 (1.8734) ce_loss 0.8311 (0.8389) loss_zs_kd 2.7785 (2.4088) loss_oracle 0.5689 (0.6096) acc 71.8750 (70.9375) kd_loss 0.6959 (0.7297) lr 1.2369e-04 eta 0:05:32
epoch [44/50] batch [120/403] time 0.084 (0.116) data 0.000 (0.034) loss 1.8384 (1.8688) ce_loss 0.8540 (0.8357) loss_zs_kd 3.0095 (2.4382) loss_oracle 0.5772 (0.6100) acc 65.6250 (70.7031) kd_loss 0.6958 (0.7281) lr 1.2369e-04 eta 0:05:13
epoch [44/50] batch [140/403] time 0.077 (0.111) data 0.000 (0.029) loss 1.6375 (1.8706) ce_loss 0.6167 (0.8362) loss_zs_kd 2.3077 (2.4428) loss_oracle 0.5286 (0.6107) acc 84.3750 (70.6250) kd_loss 0.7565 (0.7291) lr 1.2369e-04 eta 0:04:56
epoch [44/50] batch [160/403] time 0.085 (0.108) data 0.000 (0.025) loss 1.7247 (1.8629) ce_loss 0.6826 (0.8295) loss_zs_kd 2.0840 (2.4561) loss_oracle 0.5950 (0.6087) acc 75.0000 (70.7422) kd_loss 0.7446 (0.7290) lr 1.2369e-04 eta 0:04:46
epoch [44/50] batch [180/403] time 0.088 (0.105) data 0.000 (0.023) loss 1.6220 (1.8585) ce_loss 0.5835 (0.8285) loss_zs_kd 2.3758 (2.4554) loss_oracle 0.6121 (0.6058) acc 84.3750 (70.7118) kd_loss 0.7324 (0.7271) lr 1.2369e-04 eta 0:04:37
epoch [44/50] batch [200/403] time 0.085 (0.103) data 0.000 (0.020) loss 2.1359 (1.8558) ce_loss 1.1357 (0.8273) loss_zs_kd 2.4603 (2.4509) loss_oracle 0.6694 (0.6063) acc 56.2500 (70.7188) kd_loss 0.6655 (0.7254) lr 1.2369e-04 eta 0:04:29
epoch [44/50] batch [220/403] time 0.096 (0.102) data 0.001 (0.019) loss 1.6453 (1.8590) ce_loss 0.6191 (0.8286) loss_zs_kd 2.7219 (2.4516) loss_oracle 0.6082 (0.6069) acc 71.8750 (70.5114) kd_loss 0.7220 (0.7269) lr 1.2369e-04 eta 0:04:24
epoch [44/50] batch [240/403] time 0.082 (0.100) data 0.000 (0.017) loss 1.9235 (1.8653) ce_loss 0.8564 (0.8351) loss_zs_kd 2.2985 (2.4513) loss_oracle 0.6818 (0.6090) acc 71.8750 (70.3255) kd_loss 0.7262 (0.7257) lr 1.2369e-04 eta 0:04:18
epoch [44/50] batch [260/403] time 0.081 (0.099) data 0.000 (0.016) loss 1.6728 (1.8646) ce_loss 0.7090 (0.8356) loss_zs_kd 2.7212 (2.4644) loss_oracle 0.5949 (0.6096) acc 78.1250 (70.4447) kd_loss 0.6664 (0.7241) lr 1.2369e-04 eta 0:04:12
epoch [44/50] batch [280/403] time 0.080 (0.097) data 0.000 (0.015) loss 1.8100 (1.8633) ce_loss 0.7827 (0.8366) loss_zs_kd 2.3919 (2.4632) loss_oracle 0.6005 (0.6092) acc 71.8750 (70.3237) kd_loss 0.7270 (0.7221) lr 1.2369e-04 eta 0:04:07
epoch [44/50] batch [300/403] time 0.087 (0.097) data 0.000 (0.014) loss 1.8107 (1.8608) ce_loss 0.8184 (0.8330) loss_zs_kd 2.6993 (2.4589) loss_oracle 0.5861 (0.6091) acc 68.7500 (70.4479) kd_loss 0.6993 (0.7232) lr 1.2369e-04 eta 0:04:03
epoch [44/50] batch [320/403] time 0.090 (0.096) data 0.000 (0.013) loss 1.8261 (1.8603) ce_loss 0.8628 (0.8336) loss_zs_kd 2.2874 (2.4640) loss_oracle 0.5492 (0.6097) acc 71.8750 (70.3613) kd_loss 0.6888 (0.7218) lr 1.2369e-04 eta 0:04:00
epoch [44/50] batch [340/403] time 0.080 (0.095) data 0.000 (0.012) loss 1.6190 (1.8614) ce_loss 0.5947 (0.8355) loss_zs_kd 2.3539 (2.4656) loss_oracle 0.5958 (0.6085) acc 71.8750 (70.3217) kd_loss 0.7264 (0.7216) lr 1.2369e-04 eta 0:03:56
epoch [44/50] batch [360/403] time 0.097 (0.095) data 0.000 (0.011) loss 1.8222 (1.8621) ce_loss 0.7939 (0.8363) loss_zs_kd 2.7458 (2.4684) loss_oracle 0.5621 (0.6075) acc 65.6250 (70.2170) kd_loss 0.7472 (0.7221) lr 1.2369e-04 eta 0:03:53
epoch [44/50] batch [380/403] time 0.085 (0.094) data 0.000 (0.011) loss 1.6629 (1.8622) ce_loss 0.6387 (0.8356) loss_zs_kd 2.2052 (2.4632) loss_oracle 0.5048 (0.6078) acc 75.0000 (70.2467) kd_loss 0.7718 (0.7227) lr 1.2369e-04 eta 0:03:50
epoch [44/50] batch [400/403] time 0.078 (0.094) data 0.000 (0.010) loss 1.7343 (1.8634) ce_loss 0.7207 (0.8365) loss_zs_kd 2.3231 (2.4586) loss_oracle 0.5878 (0.6082) acc 71.8750 (70.0703) kd_loss 0.7197 (0.7229) lr 1.2369e-04 eta 0:03:46
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,077
* accuracy: 73.7%
* error: 26.3%
* macro_f1: 61.7%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,562
* accuracy: 43.5%
* error: 56.5%
* macro_f1: 32.0%
******* Domain 4 best val acc:      73.9%, epoch: 42 *******
******* Domain 4 best val test acc: 45.7%, epoch: 42 *******
******* Domain 4 best test acc:     45.7%, epoch: 42 *******
epoch [45/50] batch [20/403] time 0.083 (0.286) data 0.000 (0.197) loss 1.8613 (1.8614) ce_loss 0.7720 (0.8246) loss_zs_kd 2.7606 (2.4984) loss_oracle 0.6020 (0.6042) acc 71.8750 (70.4688) kd_loss 0.7883 (0.7347) lr 9.5173e-05 eta 0:11:27
epoch [45/50] batch [40/403] time 0.082 (0.186) data 0.000 (0.098) loss 1.7320 (1.8524) ce_loss 0.7314 (0.8242) loss_zs_kd 2.4337 (2.4401) loss_oracle 0.5809 (0.6118) acc 75.0000 (70.5469) kd_loss 0.7101 (0.7223) lr 9.5173e-05 eta 0:07:21
epoch [45/50] batch [60/403] time 0.089 (0.152) data 0.000 (0.066) loss 2.0584 (1.8644) ce_loss 0.9590 (0.8413) loss_zs_kd 2.6782 (2.4445) loss_oracle 0.6789 (0.6048) acc 75.0000 (70.5729) kd_loss 0.7600 (0.7206) lr 9.5173e-05 eta 0:05:58
epoch [45/50] batch [80/403] time 0.088 (0.135) data 0.001 (0.049) loss 1.9760 (1.8662) ce_loss 0.9551 (0.8424) loss_zs_kd 2.3162 (2.4448) loss_oracle 0.5460 (0.5993) acc 62.5000 (69.9219) kd_loss 0.7479 (0.7241) lr 9.5173e-05 eta 0:05:16
epoch [45/50] batch [100/403] time 0.083 (0.125) data 0.000 (0.040) loss 1.9664 (1.8601) ce_loss 0.9253 (0.8324) loss_zs_kd 2.2804 (2.4362) loss_oracle 0.5927 (0.6037) acc 71.8750 (70.1875) kd_loss 0.7448 (0.7259) lr 9.5173e-05 eta 0:04:50
epoch [45/50] batch [120/403] time 0.076 (0.118) data 0.000 (0.033) loss 1.8080 (1.8580) ce_loss 0.7920 (0.8305) loss_zs_kd 2.6947 (2.4375) loss_oracle 0.6053 (0.6015) acc 71.8750 (70.6771) kd_loss 0.7134 (0.7267) lr 9.5173e-05 eta 0:04:31
epoch [45/50] batch [140/403] time 0.080 (0.113) data 0.000 (0.028) loss 1.7831 (1.8595) ce_loss 0.6875 (0.8317) loss_zs_kd 2.5491 (2.4285) loss_oracle 0.6174 (0.6002) acc 65.6250 (70.6696) kd_loss 0.7869 (0.7277) lr 9.5173e-05 eta 0:04:18
epoch [45/50] batch [160/403] time 0.079 (0.109) data 0.000 (0.025) loss 1.8842 (1.8703) ce_loss 0.8813 (0.8422) loss_zs_kd 2.6414 (2.4379) loss_oracle 0.6001 (0.5999) acc 62.5000 (70.1562) kd_loss 0.7028 (0.7281) lr 9.5173e-05 eta 0:04:06
epoch [45/50] batch [180/403] time 0.095 (0.107) data 0.000 (0.022) loss 1.6701 (1.8689) ce_loss 0.7153 (0.8423) loss_zs_kd 2.2141 (2.4437) loss_oracle 0.5705 (0.6000) acc 75.0000 (70.2431) kd_loss 0.6695 (0.7265) lr 9.5173e-05 eta 0:03:58
epoch [45/50] batch [200/403] time 0.083 (0.104) data 0.000 (0.020) loss 2.1435 (1.8672) ce_loss 1.1240 (0.8387) loss_zs_kd 1.8349 (2.4535) loss_oracle 0.6750 (0.6021) acc 53.1250 (70.3125) kd_loss 0.6820 (0.7274) lr 9.5173e-05 eta 0:03:51
epoch [45/50] batch [220/403] time 0.094 (0.103) data 0.001 (0.018) loss 1.6067 (1.8693) ce_loss 0.5762 (0.8419) loss_zs_kd 2.6322 (2.4564) loss_oracle 0.6152 (0.6030) acc 87.5000 (70.3409) kd_loss 0.7229 (0.7259) lr 9.5173e-05 eta 0:03:46
epoch [45/50] batch [240/403] time 0.084 (0.101) data 0.000 (0.017) loss 1.8065 (1.8709) ce_loss 0.8213 (0.8434) loss_zs_kd 2.6274 (2.4586) loss_oracle 0.5655 (0.6039) acc 65.6250 (70.3255) kd_loss 0.7024 (0.7255) lr 9.5173e-05 eta 0:03:40
epoch [45/50] batch [260/403] time 0.081 (0.100) data 0.000 (0.015) loss 2.0698 (1.8711) ce_loss 1.0273 (0.8436) loss_zs_kd 2.5401 (2.4657) loss_oracle 0.6178 (0.6040) acc 62.5000 (70.2284) kd_loss 0.7335 (0.7256) lr 9.5173e-05 eta 0:03:36
epoch [45/50] batch [280/403] time 0.083 (0.099) data 0.000 (0.014) loss 1.9932 (1.8727) ce_loss 0.9346 (0.8454) loss_zs_kd 2.7255 (2.4653) loss_oracle 0.6807 (0.6047) acc 62.5000 (70.2121) kd_loss 0.7183 (0.7250) lr 9.5173e-05 eta 0:03:31
epoch [45/50] batch [300/403] time 0.080 (0.098) data 0.000 (0.013) loss 1.9245 (1.8735) ce_loss 0.8306 (0.8442) loss_zs_kd 2.6426 (2.4691) loss_oracle 0.6934 (0.6064) acc 68.7500 (70.3646) kd_loss 0.7472 (0.7261) lr 9.5173e-05 eta 0:03:27
epoch [45/50] batch [320/403] time 0.090 (0.097) data 0.000 (0.013) loss 1.8001 (1.8728) ce_loss 0.8481 (0.8448) loss_zs_kd 2.6685 (2.4609) loss_oracle 0.5184 (0.6066) acc 62.5000 (70.2539) kd_loss 0.6927 (0.7247) lr 9.5173e-05 eta 0:03:23
epoch [45/50] batch [340/403] time 0.085 (0.096) data 0.000 (0.012) loss 1.8937 (1.8693) ce_loss 0.8682 (0.8417) loss_zs_kd 2.9938 (2.4654) loss_oracle 0.6162 (0.6060) acc 68.7500 (70.4412) kd_loss 0.7175 (0.7246) lr 9.5173e-05 eta 0:03:20
epoch [45/50] batch [360/403] time 0.078 (0.095) data 0.000 (0.011) loss 1.6828 (1.8690) ce_loss 0.6582 (0.8404) loss_zs_kd 1.9570 (2.4690) loss_oracle 0.5738 (0.6066) acc 68.7500 (70.4167) kd_loss 0.7377 (0.7253) lr 9.5173e-05 eta 0:03:16
epoch [45/50] batch [380/403] time 0.072 (0.095) data 0.000 (0.011) loss 1.7955 (1.8683) ce_loss 0.7480 (0.8401) loss_zs_kd 2.4710 (2.4672) loss_oracle 0.6733 (0.6074) acc 65.6250 (70.3536) kd_loss 0.7108 (0.7245) lr 9.5173e-05 eta 0:03:12
epoch [45/50] batch [400/403] time 0.077 (0.094) data 0.000 (0.010) loss 2.0351 (1.8686) ce_loss 1.0225 (0.8393) loss_zs_kd 2.6068 (2.4589) loss_oracle 0.5927 (0.6076) acc 62.5000 (70.4062) kd_loss 0.7163 (0.7255) lr 9.5173e-05 eta 0:03:09
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,091
* accuracy: 73.9%
* error: 26.1%
* macro_f1: 62.4%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,580
* accuracy: 43.9%
* error: 56.1%
* macro_f1: 32.0%
******* Domain 4 best val acc:      73.9%, epoch: 45 *******
******* Domain 4 best val test acc: 43.9%, epoch: 45 *******
******* Domain 4 best test acc:     45.7%, epoch: 42 *******
epoch [46/50] batch [20/403] time 0.083 (0.250) data 0.000 (0.156) loss 1.6246 (1.8808) ce_loss 0.6045 (0.8554) loss_zs_kd 2.2851 (2.3633) loss_oracle 0.6029 (0.6029) acc 78.1250 (70.7812) kd_loss 0.7186 (0.7240) lr 7.0224e-05 eta 0:08:19
epoch [46/50] batch [40/403] time 0.086 (0.168) data 0.000 (0.078) loss 1.6341 (1.8491) ce_loss 0.5820 (0.8274) loss_zs_kd 2.5000 (2.4605) loss_oracle 0.6023 (0.6064) acc 78.1250 (72.3438) kd_loss 0.7509 (0.7185) lr 7.0224e-05 eta 0:05:31
epoch [46/50] batch [60/403] time 0.078 (0.139) data 0.000 (0.052) loss 1.7603 (1.8377) ce_loss 0.7036 (0.8183) loss_zs_kd 2.4017 (2.4275) loss_oracle 0.6039 (0.6064) acc 81.2500 (72.5000) kd_loss 0.7548 (0.7162) lr 7.0224e-05 eta 0:04:32
epoch [46/50] batch [80/403] time 0.082 (0.125) data 0.000 (0.039) loss 1.9100 (1.8448) ce_loss 0.8516 (0.8233) loss_zs_kd 2.4400 (2.4583) loss_oracle 0.6621 (0.6016) acc 71.8750 (72.0312) kd_loss 0.7274 (0.7207) lr 7.0224e-05 eta 0:04:01
epoch [46/50] batch [100/403] time 0.078 (0.115) data 0.000 (0.031) loss 1.6720 (1.8461) ce_loss 0.6753 (0.8242) loss_zs_kd 2.9018 (2.4636) loss_oracle 0.5997 (0.6015) acc 78.1250 (72.0000) kd_loss 0.6969 (0.7212) lr 7.0224e-05 eta 0:03:40
epoch [46/50] batch [120/403] time 0.087 (0.110) data 0.000 (0.026) loss 1.9213 (1.8536) ce_loss 0.8599 (0.8270) loss_zs_kd 2.4300 (2.4550) loss_oracle 0.5835 (0.6065) acc 75.0000 (71.7188) kd_loss 0.7697 (0.7233) lr 7.0224e-05 eta 0:03:27
epoch [46/50] batch [140/403] time 0.079 (0.106) data 0.000 (0.022) loss 1.7501 (1.8563) ce_loss 0.6943 (0.8283) loss_zs_kd 2.6612 (2.4531) loss_oracle 0.5480 (0.6066) acc 78.1250 (71.4062) kd_loss 0.7817 (0.7246) lr 7.0224e-05 eta 0:03:18
epoch [46/50] batch [160/403] time 0.079 (0.103) data 0.000 (0.020) loss 1.7216 (1.8596) ce_loss 0.7461 (0.8308) loss_zs_kd 2.1302 (2.4538) loss_oracle 0.5782 (0.6070) acc 71.8750 (71.3477) kd_loss 0.6864 (0.7253) lr 7.0224e-05 eta 0:03:10
epoch [46/50] batch [180/403] time 0.085 (0.100) data 0.000 (0.018) loss 1.6909 (1.8593) ce_loss 0.6479 (0.8293) loss_zs_kd 2.0175 (2.4561) loss_oracle 0.5696 (0.6077) acc 78.1250 (71.4236) kd_loss 0.7582 (0.7261) lr 7.0224e-05 eta 0:03:03
epoch [46/50] batch [200/403] time 0.077 (0.098) data 0.000 (0.016) loss 2.0019 (1.8510) ce_loss 0.9180 (0.8223) loss_zs_kd 2.5994 (2.4502) loss_oracle 0.6360 (0.6077) acc 62.5000 (71.5938) kd_loss 0.7659 (0.7248) lr 7.0224e-05 eta 0:02:57
epoch [46/50] batch [220/403] time 0.084 (0.097) data 0.000 (0.014) loss 1.8714 (1.8548) ce_loss 0.8311 (0.8269) loss_zs_kd 2.9858 (2.4502) loss_oracle 0.5693 (0.6066) acc 68.7500 (71.4205) kd_loss 0.7557 (0.7246) lr 7.0224e-05 eta 0:02:53
epoch [46/50] batch [240/403] time 0.085 (0.096) data 0.000 (0.013) loss 1.8213 (1.8542) ce_loss 0.7812 (0.8257) loss_zs_kd 3.0376 (2.4560) loss_oracle 0.5968 (0.6074) acc 71.8750 (71.4062) kd_loss 0.7416 (0.7247) lr 7.0224e-05 eta 0:02:49
epoch [46/50] batch [260/403] time 0.083 (0.095) data 0.000 (0.012) loss 1.9982 (1.8623) ce_loss 0.9800 (0.8342) loss_zs_kd 2.6774 (2.4545) loss_oracle 0.5487 (0.6066) acc 62.5000 (71.0216) kd_loss 0.7438 (0.7247) lr 7.0224e-05 eta 0:02:46
epoch [46/50] batch [280/403] time 0.085 (0.094) data 0.000 (0.011) loss 2.1730 (1.8630) ce_loss 1.1270 (0.8356) loss_zs_kd 2.2984 (2.4471) loss_oracle 0.5524 (0.6063) acc 62.5000 (71.0268) kd_loss 0.7699 (0.7243) lr 7.0224e-05 eta 0:02:43
epoch [46/50] batch [300/403] time 0.083 (0.094) data 0.000 (0.011) loss 1.8248 (1.8622) ce_loss 0.8364 (0.8337) loss_zs_kd 2.4649 (2.4523) loss_oracle 0.5715 (0.6070) acc 81.2500 (71.1146) kd_loss 0.7026 (0.7250) lr 7.0224e-05 eta 0:02:40
epoch [46/50] batch [320/403] time 0.082 (0.093) data 0.000 (0.010) loss 2.5908 (1.8658) ce_loss 1.5420 (0.8375) loss_zs_kd 2.2856 (2.4496) loss_oracle 0.6634 (0.6062) acc 40.6250 (70.8984) kd_loss 0.7171 (0.7252) lr 7.0224e-05 eta 0:02:37
epoch [46/50] batch [340/403] time 0.089 (0.093) data 0.000 (0.009) loss 1.7979 (1.8617) ce_loss 0.7266 (0.8334) loss_zs_kd 2.8604 (2.4504) loss_oracle 0.5921 (0.6060) acc 78.1250 (71.0846) kd_loss 0.7753 (0.7253) lr 7.0224e-05 eta 0:02:35
epoch [46/50] batch [360/403] time 0.086 (0.092) data 0.000 (0.009) loss 2.0064 (1.8629) ce_loss 0.9741 (0.8345) loss_zs_kd 2.3877 (2.4499) loss_oracle 0.6593 (0.6058) acc 62.5000 (71.0590) kd_loss 0.7026 (0.7255) lr 7.0224e-05 eta 0:02:32
epoch [46/50] batch [380/403] time 0.076 (0.092) data 0.000 (0.008) loss 1.5295 (1.8634) ce_loss 0.5820 (0.8364) loss_zs_kd 2.4882 (2.4518) loss_oracle 0.5784 (0.6054) acc 84.3750 (70.9539) kd_loss 0.6583 (0.7243) lr 7.0224e-05 eta 0:02:29
epoch [46/50] batch [400/403] time 0.075 (0.091) data 0.000 (0.008) loss 1.8236 (1.8635) ce_loss 0.8374 (0.8367) loss_zs_kd 2.6025 (2.4507) loss_oracle 0.5909 (0.6048) acc 71.8750 (70.8672) kd_loss 0.6907 (0.7243) lr 7.0224e-05 eta 0:02:26
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,093
* accuracy: 73.9%
* error: 26.1%
* macro_f1: 62.5%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,603
* accuracy: 44.2%
* error: 55.8%
* macro_f1: 32.3%
******* Domain 4 best val acc:      73.9%, epoch: 46 *******
******* Domain 4 best val test acc: 44.2%, epoch: 46 *******
******* Domain 4 best test acc:     45.7%, epoch: 42 *******
epoch [47/50] batch [20/403] time 0.087 (0.294) data 0.000 (0.204) loss 2.1086 (1.8200) ce_loss 1.0498 (0.8042) loss_zs_kd 2.8235 (2.6536) loss_oracle 0.6769 (0.5912) acc 56.2500 (70.0000) kd_loss 0.7204 (0.7202) lr 4.8943e-05 eta 0:07:48
epoch [47/50] batch [40/403] time 0.079 (0.189) data 0.000 (0.102) loss 1.6629 (1.8456) ce_loss 0.5957 (0.8168) loss_zs_kd 2.1584 (2.5447) loss_oracle 0.6631 (0.6074) acc 81.2500 (69.7656) kd_loss 0.7356 (0.7251) lr 4.8943e-05 eta 0:04:57
epoch [47/50] batch [60/403] time 0.083 (0.154) data 0.000 (0.068) loss 1.6148 (1.8528) ce_loss 0.7007 (0.8294) loss_zs_kd 2.3364 (2.5091) loss_oracle 0.5338 (0.6081) acc 65.6250 (69.5833) kd_loss 0.6472 (0.7193) lr 4.8943e-05 eta 0:03:58
epoch [47/50] batch [80/403] time 0.088 (0.137) data 0.000 (0.051) loss 1.9206 (1.8493) ce_loss 0.9126 (0.8277) loss_zs_kd 2.0009 (2.4838) loss_oracle 0.5847 (0.6056) acc 68.7500 (69.9609) kd_loss 0.7157 (0.7187) lr 4.8943e-05 eta 0:03:29
epoch [47/50] batch [100/403] time 0.088 (0.126) data 0.000 (0.041) loss 1.9219 (1.8550) ce_loss 0.9624 (0.8332) loss_zs_kd 2.2001 (2.4724) loss_oracle 0.4899 (0.6051) acc 68.7500 (70.1250) kd_loss 0.7146 (0.7194) lr 4.8943e-05 eta 0:03:10
epoch [47/50] batch [120/403] time 0.085 (0.119) data 0.000 (0.034) loss 1.8918 (1.8407) ce_loss 0.8789 (0.8208) loss_zs_kd 3.2274 (2.4881) loss_oracle 0.5759 (0.6034) acc 65.6250 (70.7812) kd_loss 0.7250 (0.7182) lr 4.8943e-05 eta 0:02:57
epoch [47/50] batch [140/403] time 0.093 (0.114) data 0.000 (0.029) loss 1.9479 (1.8501) ce_loss 0.9580 (0.8290) loss_zs_kd 2.8489 (2.4902) loss_oracle 0.6319 (0.6064) acc 68.7500 (70.3571) kd_loss 0.6739 (0.7179) lr 4.8943e-05 eta 0:02:47
epoch [47/50] batch [160/403] time 0.089 (0.110) data 0.000 (0.026) loss 1.6084 (1.8614) ce_loss 0.6084 (0.8395) loss_zs_kd 2.5739 (2.4975) loss_oracle 0.5861 (0.6071) acc 78.1250 (70.1367) kd_loss 0.7070 (0.7183) lr 4.8943e-05 eta 0:02:40
epoch [47/50] batch [180/403] time 0.082 (0.107) data 0.000 (0.023) loss 1.5201 (1.8666) ce_loss 0.5767 (0.8450) loss_zs_kd 2.7640 (2.4933) loss_oracle 0.5768 (0.6059) acc 71.8750 (69.7222) kd_loss 0.6550 (0.7187) lr 4.8943e-05 eta 0:02:33
epoch [47/50] batch [200/403] time 0.083 (0.105) data 0.000 (0.021) loss 1.8606 (1.8661) ce_loss 0.8599 (0.8439) loss_zs_kd 2.5687 (2.4860) loss_oracle 0.5827 (0.6067) acc 71.8750 (69.8906) kd_loss 0.7094 (0.7188) lr 4.8943e-05 eta 0:02:27
epoch [47/50] batch [220/403] time 0.080 (0.103) data 0.000 (0.019) loss 1.8895 (1.8609) ce_loss 0.8477 (0.8383) loss_zs_kd 2.7445 (2.4786) loss_oracle 0.6359 (0.6071) acc 75.0000 (70.0994) kd_loss 0.7239 (0.7191) lr 4.8943e-05 eta 0:02:22
epoch [47/50] batch [240/403] time 0.087 (0.101) data 0.000 (0.017) loss 1.6698 (1.8639) ce_loss 0.5928 (0.8385) loss_zs_kd 2.6004 (2.4860) loss_oracle 0.5811 (0.6078) acc 71.8750 (70.1432) kd_loss 0.7865 (0.7214) lr 4.8943e-05 eta 0:02:18
epoch [47/50] batch [260/403] time 0.081 (0.099) data 0.000 (0.016) loss 1.9065 (1.8641) ce_loss 0.8486 (0.8399) loss_zs_kd 2.7738 (2.4843) loss_oracle 0.6319 (0.6073) acc 68.7500 (70.0000) kd_loss 0.7419 (0.7206) lr 4.8943e-05 eta 0:02:14
epoch [47/50] batch [280/403] time 0.090 (0.098) data 0.000 (0.015) loss 2.0267 (1.8626) ce_loss 0.9966 (0.8391) loss_zs_kd 2.5774 (2.4898) loss_oracle 0.6556 (0.6075) acc 71.8750 (70.1674) kd_loss 0.7023 (0.7197) lr 4.8943e-05 eta 0:02:11
epoch [47/50] batch [300/403] time 0.086 (0.097) data 0.000 (0.014) loss 2.0881 (1.8643) ce_loss 0.9707 (0.8401) loss_zs_kd 2.7470 (2.4921) loss_oracle 0.6451 (0.6082) acc 65.6250 (70.0417) kd_loss 0.7949 (0.7201) lr 4.8943e-05 eta 0:02:07
epoch [47/50] batch [320/403] time 0.076 (0.097) data 0.000 (0.013) loss 2.0059 (1.8668) ce_loss 0.8828 (0.8429) loss_zs_kd 3.1891 (2.4900) loss_oracle 0.6317 (0.6083) acc 62.5000 (70.0098) kd_loss 0.8073 (0.7197) lr 4.8943e-05 eta 0:02:05
epoch [47/50] batch [340/403] time 0.080 (0.096) data 0.000 (0.012) loss 1.4269 (1.8610) ce_loss 0.4709 (0.8365) loss_zs_kd 2.3098 (2.4813) loss_oracle 0.6326 (0.6079) acc 87.5000 (70.2390) kd_loss 0.6397 (0.7207) lr 4.8943e-05 eta 0:02:01
epoch [47/50] batch [360/403] time 0.088 (0.095) data 0.000 (0.012) loss 2.4083 (1.8595) ce_loss 1.2207 (0.8347) loss_zs_kd 2.8066 (2.4731) loss_oracle 0.6740 (0.6084) acc 50.0000 (70.2951) kd_loss 0.8506 (0.7206) lr 4.8943e-05 eta 0:01:58
epoch [47/50] batch [380/403] time 0.083 (0.094) data 0.000 (0.011) loss 1.6859 (1.8582) ce_loss 0.6709 (0.8344) loss_zs_kd 2.2251 (2.4731) loss_oracle 0.6135 (0.6077) acc 75.0000 (70.3043) kd_loss 0.7083 (0.7200) lr 4.8943e-05 eta 0:01:56
epoch [47/50] batch [400/403] time 0.077 (0.094) data 0.000 (0.010) loss 1.7140 (1.8547) ce_loss 0.7192 (0.8317) loss_zs_kd 2.7303 (2.4721) loss_oracle 0.6007 (0.6073) acc 78.1250 (70.3984) kd_loss 0.6944 (0.7193) lr 4.8943e-05 eta 0:01:53
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,090
* accuracy: 73.9%
* error: 26.1%
* macro_f1: 62.2%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,607
* accuracy: 44.3%
* error: 55.7%
* macro_f1: 32.4%
******* Domain 4 best val acc:      73.9%, epoch: 46 *******
******* Domain 4 best val test acc: 44.2%, epoch: 46 *******
******* Domain 4 best test acc:     45.7%, epoch: 42 *******
epoch [48/50] batch [20/403] time 0.096 (0.296) data 0.000 (0.206) loss 1.6455 (1.8358) ce_loss 0.6411 (0.8469) loss_zs_kd 2.2968 (2.4729) loss_oracle 0.5316 (0.5793) acc 78.1250 (69.3750) kd_loss 0.7386 (0.6992) lr 3.1417e-05 eta 0:05:51
epoch [48/50] batch [40/403] time 0.076 (0.189) data 0.000 (0.103) loss 1.8846 (1.8590) ce_loss 0.8491 (0.8570) loss_zs_kd 2.5329 (2.4702) loss_oracle 0.6279 (0.5878) acc 75.0000 (69.5312) kd_loss 0.7215 (0.7081) lr 3.1417e-05 eta 0:03:40
epoch [48/50] batch [60/403] time 0.086 (0.152) data 0.000 (0.069) loss 1.5814 (1.8478) ce_loss 0.5518 (0.8402) loss_zs_kd 2.2707 (2.4415) loss_oracle 0.6488 (0.5972) acc 75.0000 (69.9479) kd_loss 0.7053 (0.7089) lr 3.1417e-05 eta 0:02:54
epoch [48/50] batch [80/403] time 0.073 (0.134) data 0.000 (0.052) loss 1.5993 (1.8539) ce_loss 0.5684 (0.8463) loss_zs_kd 3.0037 (2.4620) loss_oracle 0.5898 (0.5966) acc 81.2500 (70.1562) kd_loss 0.7360 (0.7092) lr 3.1417e-05 eta 0:02:31
epoch [48/50] batch [100/403] time 0.083 (0.123) data 0.000 (0.041) loss 1.9376 (1.8470) ce_loss 0.8457 (0.8381) loss_zs_kd 2.7356 (2.4687) loss_oracle 0.6789 (0.5939) acc 65.6250 (70.5625) kd_loss 0.7525 (0.7120) lr 3.1417e-05 eta 0:02:16
epoch [48/50] batch [120/403] time 0.088 (0.116) data 0.000 (0.035) loss 2.0514 (1.8454) ce_loss 1.0205 (0.8323) loss_zs_kd 2.4144 (2.4651) loss_oracle 0.5844 (0.5980) acc 75.0000 (70.7031) kd_loss 0.7387 (0.7140) lr 3.1417e-05 eta 0:02:06
epoch [48/50] batch [140/403] time 0.086 (0.112) data 0.000 (0.030) loss 1.6394 (1.8425) ce_loss 0.6411 (0.8270) loss_zs_kd 2.5402 (2.4566) loss_oracle 0.5075 (0.5973) acc 68.7500 (70.8259) kd_loss 0.7445 (0.7169) lr 3.1417e-05 eta 0:01:59
epoch [48/50] batch [160/403] time 0.079 (0.108) data 0.000 (0.026) loss 1.6514 (1.8448) ce_loss 0.7075 (0.8297) loss_zs_kd 2.5640 (2.4700) loss_oracle 0.4775 (0.5960) acc 81.2500 (70.8203) kd_loss 0.7052 (0.7171) lr 3.1417e-05 eta 0:01:53
epoch [48/50] batch [180/403] time 0.084 (0.106) data 0.000 (0.023) loss 2.0157 (1.8461) ce_loss 0.8833 (0.8297) loss_zs_kd 2.8421 (2.4734) loss_oracle 0.6497 (0.5973) acc 65.6250 (70.8507) kd_loss 0.8075 (0.7178) lr 3.1417e-05 eta 0:01:48
epoch [48/50] batch [200/403] time 0.076 (0.103) data 0.000 (0.021) loss 1.9618 (1.8509) ce_loss 0.9321 (0.8342) loss_zs_kd 2.4292 (2.4652) loss_oracle 0.6987 (0.5981) acc 68.7500 (70.7812) kd_loss 0.6803 (0.7177) lr 3.1417e-05 eta 0:01:44
epoch [48/50] batch [220/403] time 0.081 (0.102) data 0.000 (0.019) loss 2.0754 (1.8549) ce_loss 0.9688 (0.8362) loss_zs_kd 2.2640 (2.4599) loss_oracle 0.6959 (0.6000) acc 65.6250 (70.6250) kd_loss 0.7587 (0.7187) lr 3.1417e-05 eta 0:01:40
epoch [48/50] batch [240/403] time 0.079 (0.100) data 0.000 (0.017) loss 1.7798 (1.8560) ce_loss 0.7446 (0.8381) loss_zs_kd 2.8257 (2.4565) loss_oracle 0.6955 (0.6007) acc 75.0000 (70.6250) kd_loss 0.6874 (0.7175) lr 3.1417e-05 eta 0:01:36
epoch [48/50] batch [260/403] time 0.087 (0.099) data 0.000 (0.016) loss 2.0833 (1.8579) ce_loss 1.0361 (0.8382) loss_zs_kd 2.5907 (2.4537) loss_oracle 0.6103 (0.6025) acc 65.6250 (70.6250) kd_loss 0.7421 (0.7185) lr 3.1417e-05 eta 0:01:33
epoch [48/50] batch [280/403] time 0.087 (0.098) data 0.001 (0.015) loss 2.2248 (1.8590) ce_loss 1.1992 (0.8380) loss_zs_kd 2.4700 (2.4650) loss_oracle 0.6415 (0.6028) acc 59.3750 (70.5469) kd_loss 0.7048 (0.7196) lr 3.1417e-05 eta 0:01:31
epoch [48/50] batch [300/403] time 0.084 (0.097) data 0.000 (0.014) loss 1.8987 (1.8589) ce_loss 0.8457 (0.8358) loss_zs_kd 2.8405 (2.4709) loss_oracle 0.6079 (0.6035) acc 62.5000 (70.6354) kd_loss 0.7490 (0.7214) lr 3.1417e-05 eta 0:01:28
epoch [48/50] batch [320/403] time 0.089 (0.097) data 0.000 (0.013) loss 2.2451 (1.8609) ce_loss 1.1572 (0.8372) loss_zs_kd 2.6652 (2.4698) loss_oracle 0.6993 (0.6046) acc 56.2500 (70.5957) kd_loss 0.7382 (0.7214) lr 3.1417e-05 eta 0:01:26
epoch [48/50] batch [340/403] time 0.085 (0.096) data 0.000 (0.012) loss 1.5784 (1.8611) ce_loss 0.5410 (0.8378) loss_zs_kd 2.3332 (2.4643) loss_oracle 0.6273 (0.6051) acc 78.1250 (70.5790) kd_loss 0.7237 (0.7207) lr 3.1417e-05 eta 0:01:23
epoch [48/50] batch [360/403] time 0.087 (0.096) data 0.000 (0.012) loss 1.6788 (1.8593) ce_loss 0.6362 (0.8368) loss_zs_kd 2.5632 (2.4678) loss_oracle 0.6408 (0.6055) acc 78.1250 (70.4774) kd_loss 0.7222 (0.7198) lr 3.1417e-05 eta 0:01:21
epoch [48/50] batch [380/403] time 0.085 (0.095) data 0.000 (0.011) loss 1.8997 (1.8639) ce_loss 0.8418 (0.8408) loss_zs_kd 2.0183 (2.4685) loss_oracle 0.5812 (0.6060) acc 68.7500 (70.2632) kd_loss 0.7674 (0.7201) lr 3.1417e-05 eta 0:01:18
epoch [48/50] batch [400/403] time 0.079 (0.094) data 0.000 (0.011) loss 1.8320 (1.8627) ce_loss 0.7808 (0.8400) loss_zs_kd 2.6406 (2.4720) loss_oracle 0.6397 (0.6056) acc 71.8750 (70.3594) kd_loss 0.7314 (0.7199) lr 3.1417e-05 eta 0:01:16
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,088
* accuracy: 73.9%
* error: 26.1%
* macro_f1: 62.1%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,618
* accuracy: 44.5%
* error: 55.5%
* macro_f1: 32.6%
******* Domain 4 best val acc:      73.9%, epoch: 46 *******
******* Domain 4 best val test acc: 44.2%, epoch: 46 *******
******* Domain 4 best test acc:     45.7%, epoch: 42 *******
epoch [49/50] batch [20/403] time 0.080 (0.272) data 0.000 (0.180) loss 2.0071 (1.8017) ce_loss 0.9971 (0.7808) loss_zs_kd 2.6705 (2.4910) loss_oracle 0.5624 (0.5938) acc 65.6250 (73.4375) kd_loss 0.7288 (0.7240) lr 1.7713e-05 eta 0:03:33
epoch [49/50] batch [40/403] time 0.082 (0.178) data 0.000 (0.090) loss 1.8187 (1.8300) ce_loss 0.8179 (0.8068) loss_zs_kd 3.0512 (2.5096) loss_oracle 0.6148 (0.5974) acc 78.1250 (72.5000) kd_loss 0.6934 (0.7246) lr 1.7713e-05 eta 0:02:16
epoch [49/50] batch [60/403] time 0.083 (0.147) data 0.000 (0.060) loss 1.5470 (1.8314) ce_loss 0.5820 (0.8035) loss_zs_kd 2.2346 (2.4932) loss_oracle 0.5791 (0.5991) acc 75.0000 (71.8229) kd_loss 0.6755 (0.7284) lr 1.7713e-05 eta 0:01:49
epoch [49/50] batch [80/403] time 0.089 (0.132) data 0.000 (0.045) loss 1.4817 (1.8364) ce_loss 0.5024 (0.8051) loss_zs_kd 2.5566 (2.4989) loss_oracle 0.5640 (0.5969) acc 84.3750 (71.6406) kd_loss 0.6972 (0.7329) lr 1.7713e-05 eta 0:01:35
epoch [49/50] batch [100/403] time 0.084 (0.123) data 0.000 (0.036) loss 1.9596 (1.8422) ce_loss 0.9038 (0.8115) loss_zs_kd 2.5855 (2.4868) loss_oracle 0.6070 (0.5985) acc 68.7500 (71.5000) kd_loss 0.7523 (0.7314) lr 1.7713e-05 eta 0:01:27
epoch [49/50] batch [120/403] time 0.083 (0.116) data 0.000 (0.030) loss 2.1006 (1.8410) ce_loss 1.1484 (0.8120) loss_zs_kd 2.3648 (2.4710) loss_oracle 0.5499 (0.6005) acc 56.2500 (71.3802) kd_loss 0.6772 (0.7287) lr 1.7713e-05 eta 0:01:19
epoch [49/50] batch [140/403] time 0.076 (0.111) data 0.000 (0.026) loss 1.9723 (1.8517) ce_loss 0.9062 (0.8208) loss_zs_kd 2.2751 (2.4566) loss_oracle 0.6570 (0.6021) acc 68.7500 (70.9375) kd_loss 0.7376 (0.7299) lr 1.7713e-05 eta 0:01:14
epoch [49/50] batch [160/403] time 0.087 (0.108) data 0.000 (0.023) loss 1.6812 (1.8523) ce_loss 0.6348 (0.8244) loss_zs_kd 2.2928 (2.4539) loss_oracle 0.6582 (0.6012) acc 81.2500 (70.9766) kd_loss 0.7173 (0.7273) lr 1.7713e-05 eta 0:01:09
epoch [49/50] batch [180/403] time 0.088 (0.106) data 0.000 (0.020) loss 2.1296 (1.8583) ce_loss 1.0527 (0.8301) loss_zs_kd 2.5103 (2.4609) loss_oracle 0.6225 (0.5999) acc 59.3750 (70.6250) kd_loss 0.7656 (0.7283) lr 1.7713e-05 eta 0:01:06
epoch [49/50] batch [200/403] time 0.084 (0.104) data 0.000 (0.018) loss 1.8717 (1.8528) ce_loss 0.7798 (0.8241) loss_zs_kd 2.5618 (2.4612) loss_oracle 0.6284 (0.6011) acc 68.7500 (70.9531) kd_loss 0.7777 (0.7282) lr 1.7713e-05 eta 0:01:02
epoch [49/50] batch [220/403] time 0.084 (0.102) data 0.000 (0.017) loss 2.0290 (1.8543) ce_loss 1.0273 (0.8253) loss_zs_kd 1.8535 (2.4524) loss_oracle 0.5472 (0.6007) acc 59.3750 (70.8097) kd_loss 0.7280 (0.7286) lr 1.7713e-05 eta 0:00:59
epoch [49/50] batch [240/403] time 0.085 (0.101) data 0.000 (0.015) loss 1.9568 (1.8555) ce_loss 0.8906 (0.8268) loss_zs_kd 2.4090 (2.4486) loss_oracle 0.6112 (0.6006) acc 65.6250 (70.6380) kd_loss 0.7606 (0.7284) lr 1.7713e-05 eta 0:00:56
epoch [49/50] batch [260/403] time 0.083 (0.100) data 0.000 (0.014) loss 2.0310 (1.8571) ce_loss 1.0752 (0.8280) loss_zs_kd 2.5331 (2.4558) loss_oracle 0.5698 (0.6010) acc 59.3750 (70.6010) kd_loss 0.6709 (0.7285) lr 1.7713e-05 eta 0:00:54
epoch [49/50] batch [280/403] time 0.085 (0.099) data 0.000 (0.013) loss 1.9178 (1.8548) ce_loss 0.8662 (0.8253) loss_zs_kd 2.9337 (2.4616) loss_oracle 0.6645 (0.6026) acc 65.6250 (70.6585) kd_loss 0.7193 (0.7283) lr 1.7713e-05 eta 0:00:52
epoch [49/50] batch [300/403] time 0.085 (0.098) data 0.001 (0.012) loss 1.9891 (1.8569) ce_loss 0.9146 (0.8272) loss_zs_kd 2.3875 (2.4631) loss_oracle 0.6448 (0.6037) acc 65.6250 (70.6042) kd_loss 0.7522 (0.7278) lr 1.7713e-05 eta 0:00:49
epoch [49/50] batch [320/403] time 0.078 (0.097) data 0.000 (0.011) loss 1.6220 (1.8558) ce_loss 0.6538 (0.8266) loss_zs_kd 2.6145 (2.4566) loss_oracle 0.5645 (0.6049) acc 78.1250 (70.7715) kd_loss 0.6859 (0.7268) lr 1.7713e-05 eta 0:00:47
epoch [49/50] batch [340/403] time 0.087 (0.097) data 0.000 (0.011) loss 1.7145 (1.8544) ce_loss 0.6626 (0.8253) loss_zs_kd 3.0024 (2.4556) loss_oracle 0.6334 (0.6060) acc 71.8750 (70.8824) kd_loss 0.7352 (0.7261) lr 1.7713e-05 eta 0:00:45
epoch [49/50] batch [360/403] time 0.084 (0.096) data 0.001 (0.010) loss 1.7657 (1.8529) ce_loss 0.9209 (0.8239) loss_zs_kd 2.1333 (2.4576) loss_oracle 0.5208 (0.6058) acc 68.7500 (70.9028) kd_loss 0.5844 (0.7261) lr 1.7713e-05 eta 0:00:42
epoch [49/50] batch [380/403] time 0.088 (0.095) data 0.000 (0.010) loss 2.1518 (1.8561) ce_loss 1.0889 (0.8267) loss_zs_kd 1.9735 (2.4575) loss_oracle 0.6751 (0.6058) acc 56.2500 (70.7730) kd_loss 0.7254 (0.7266) lr 1.7713e-05 eta 0:00:40
epoch [49/50] batch [400/403] time 0.081 (0.095) data 0.000 (0.009) loss 2.0956 (1.8600) ce_loss 1.0078 (0.8310) loss_zs_kd 2.2389 (2.4560) loss_oracle 0.5768 (0.6055) acc 62.5000 (70.7188) kd_loss 0.7994 (0.7263) lr 1.7713e-05 eta 0:00:38
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 4,092
* accuracy: 73.9%
* error: 26.1%
* macro_f1: 62.2%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,615
* accuracy: 44.5%
* error: 55.5%
* macro_f1: 32.5%
******* Domain 4 best val acc:      73.9%, epoch: 46 *******
******* Domain 4 best val test acc: 44.2%, epoch: 46 *******
******* Domain 4 best test acc:     45.7%, epoch: 42 *******
epoch [50/50] batch [20/403] time 0.088 (0.256) data 0.000 (0.168) loss 1.7067 (1.7827) ce_loss 0.6450 (0.7709) loss_zs_kd 2.1966 (2.4112) loss_oracle 0.5856 (0.6028) acc 75.0000 (72.3438) kd_loss 0.7689 (0.7104) lr 7.8853e-06 eta 0:01:38
epoch [50/50] batch [40/403] time 0.089 (0.171) data 0.000 (0.084) loss 1.6316 (1.8279) ce_loss 0.6621 (0.8192) loss_zs_kd 2.2051 (2.4125) loss_oracle 0.5301 (0.5897) acc 78.1250 (69.7656) kd_loss 0.7045 (0.7139) lr 7.8853e-06 eta 0:01:02
epoch [50/50] batch [60/403] time 0.089 (0.143) data 0.000 (0.056) loss 1.7477 (1.8452) ce_loss 0.8208 (0.8368) loss_zs_kd 2.3978 (2.4239) loss_oracle 0.5611 (0.5890) acc 75.0000 (69.6875) kd_loss 0.6464 (0.7139) lr 7.8853e-06 eta 0:00:49
epoch [50/50] batch [80/403] time 0.084 (0.129) data 0.000 (0.042) loss 1.6422 (1.8350) ce_loss 0.6514 (0.8199) loss_zs_kd 2.2651 (2.4090) loss_oracle 0.5262 (0.5959) acc 78.1250 (70.0391) kd_loss 0.7278 (0.7171) lr 7.8853e-06 eta 0:00:41
epoch [50/50] batch [100/403] time 0.091 (0.120) data 0.000 (0.034) loss 1.9328 (1.8310) ce_loss 0.9424 (0.8121) loss_zs_kd 2.5017 (2.4012) loss_oracle 0.5665 (0.5986) acc 71.8750 (70.4688) kd_loss 0.7071 (0.7196) lr 7.8853e-06 eta 0:00:36
epoch [50/50] batch [120/403] time 0.093 (0.114) data 0.000 (0.028) loss 1.5168 (1.8282) ce_loss 0.5391 (0.8093) loss_zs_kd 2.2640 (2.4175) loss_oracle 0.6166 (0.5991) acc 75.0000 (70.7292) kd_loss 0.6694 (0.7193) lr 7.8853e-06 eta 0:00:32
epoch [50/50] batch [140/403] time 0.088 (0.110) data 0.000 (0.024) loss 1.7498 (1.8266) ce_loss 0.7803 (0.8102) loss_zs_kd 2.1710 (2.4089) loss_oracle 0.5893 (0.6009) acc 71.8750 (71.1161) kd_loss 0.6749 (0.7160) lr 7.8853e-06 eta 0:00:29
epoch [50/50] batch [160/403] time 0.087 (0.107) data 0.000 (0.021) loss 1.9962 (1.8402) ce_loss 0.9868 (0.8196) loss_zs_kd 2.0546 (2.4190) loss_oracle 0.5855 (0.6045) acc 56.2500 (70.5469) kd_loss 0.7166 (0.7184) lr 7.8853e-06 eta 0:00:26
epoch [50/50] batch [180/403] time 0.082 (0.105) data 0.000 (0.019) loss 2.0583 (1.8465) ce_loss 0.9648 (0.8257) loss_zs_kd 2.4364 (2.4184) loss_oracle 0.6992 (0.6040) acc 59.3750 (70.2951) kd_loss 0.7438 (0.7189) lr 7.8853e-06 eta 0:00:23
epoch [50/50] batch [200/403] time 0.077 (0.102) data 0.000 (0.017) loss 1.8713 (1.8423) ce_loss 0.8789 (0.8208) loss_zs_kd 2.9738 (2.4217) loss_oracle 0.5375 (0.6024) acc 68.7500 (70.6406) kd_loss 0.7237 (0.7203) lr 7.8853e-06 eta 0:00:20
epoch [50/50] batch [220/403] time 0.088 (0.101) data 0.000 (0.016) loss 1.7719 (1.8431) ce_loss 0.6709 (0.8218) loss_zs_kd 2.6933 (2.4297) loss_oracle 0.6232 (0.6022) acc 81.2500 (70.5966) kd_loss 0.7894 (0.7202) lr 7.8853e-06 eta 0:00:18
epoch [50/50] batch [240/403] time 0.093 (0.100) data 0.000 (0.014) loss 1.7206 (1.8474) ce_loss 0.7158 (0.8262) loss_zs_kd 2.2087 (2.4337) loss_oracle 0.6609 (0.6034) acc 71.8750 (70.5339) kd_loss 0.6743 (0.7195) lr 7.8853e-06 eta 0:00:16
epoch [50/50] batch [260/403] time 0.083 (0.099) data 0.000 (0.013) loss 1.9340 (1.8522) ce_loss 0.9180 (0.8309) loss_zs_kd 2.9418 (2.4457) loss_oracle 0.6143 (0.6035) acc 68.7500 (70.3606) kd_loss 0.7089 (0.7195) lr 7.8853e-06 eta 0:00:14
epoch [50/50] batch [280/403] time 0.081 (0.098) data 0.000 (0.012) loss 1.6597 (1.8528) ce_loss 0.6025 (0.8314) loss_zs_kd 2.2936 (2.4439) loss_oracle 0.6642 (0.6034) acc 75.0000 (70.2121) kd_loss 0.7251 (0.7197) lr 7.8853e-06 eta 0:00:12
epoch [50/50] batch [300/403] time 0.083 (0.097) data 0.000 (0.011) loss 1.6732 (1.8517) ce_loss 0.6519 (0.8305) loss_zs_kd 2.5537 (2.4497) loss_oracle 0.5817 (0.6033) acc 78.1250 (70.2500) kd_loss 0.7306 (0.7195) lr 7.8853e-06 eta 0:00:09
epoch [50/50] batch [320/403] time 0.085 (0.096) data 0.000 (0.011) loss 2.3452 (1.8544) ce_loss 1.3242 (0.8330) loss_zs_kd 2.8566 (2.4513) loss_oracle 0.5277 (0.6039) acc 65.6250 (70.1562) kd_loss 0.7571 (0.7195) lr 7.8853e-06 eta 0:00:07
epoch [50/50] batch [340/403] time 0.084 (0.096) data 0.001 (0.010) loss 1.9185 (1.8534) ce_loss 0.8218 (0.8328) loss_zs_kd 3.0415 (2.4547) loss_oracle 0.6086 (0.6041) acc 68.7500 (70.1562) kd_loss 0.7925 (0.7186) lr 7.8853e-06 eta 0:00:06
epoch [50/50] batch [360/403] time 0.082 (0.095) data 0.000 (0.010) loss 1.7744 (1.8516) ce_loss 0.8076 (0.8304) loss_zs_kd 2.3364 (2.4585) loss_oracle 0.5345 (0.6041) acc 81.2500 (70.2604) kd_loss 0.6995 (0.7192) lr 7.8853e-06 eta 0:00:04
