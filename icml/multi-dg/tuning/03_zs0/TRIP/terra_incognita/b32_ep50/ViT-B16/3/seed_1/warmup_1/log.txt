Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_100', 'location_38', 'location_46']
Target     ['location_43']
# classes  10
# train_x  14,252
# val      6,108
# test     3,970
---------  ----------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/445] time 0.070 (0.123) data 0.000 (0.037) loss 2.4145 (2.3219) ce_loss 2.4141 (2.3195) loss_zs_kd 0.0002 (0.0001) loss_oracle -0.0001 (-0.0001) acc 25.0000 (30.3125) kd_loss 0.0005 (0.0025) lr 1.0000e-05 eta 0:45:40
epoch [1/50] batch [40/445] time 0.062 (0.099) data 0.000 (0.019) loss 2.6860 (2.2805) ce_loss 2.6855 (2.2790) loss_zs_kd 0.0021 (0.0006) loss_oracle -0.0001 (-0.0001) acc 21.8750 (31.4844) kd_loss 0.0005 (0.0016) lr 1.0000e-05 eta 0:36:49
epoch [1/50] batch [60/445] time 0.073 (0.092) data 0.000 (0.012) loss 2.0707 (2.2825) ce_loss 2.0703 (2.2812) loss_zs_kd 0.0059 (0.0020) loss_oracle -0.0001 (-0.0001) acc 37.5000 (31.1458) kd_loss 0.0004 (0.0013) lr 1.0000e-05 eta 0:34:04
epoch [1/50] batch [80/445] time 0.070 (0.089) data 0.000 (0.009) loss 2.2212 (2.2522) ce_loss 2.2207 (2.2511) loss_zs_kd 0.0149 (0.0040) loss_oracle -0.0001 (-0.0001) acc 21.8750 (31.6406) kd_loss 0.0005 (0.0011) lr 1.0000e-05 eta 0:32:47
epoch [1/50] batch [100/445] time 0.091 (0.087) data 0.000 (0.008) loss 2.0302 (2.2210) ce_loss 2.0293 (2.2200) loss_zs_kd 0.0232 (0.0072) loss_oracle -0.0001 (-0.0001) acc 34.3750 (32.0000) kd_loss 0.0009 (0.0011) lr 1.0000e-05 eta 0:32:15
epoch [1/50] batch [120/445] time 0.089 (0.086) data 0.000 (0.006) loss 2.2021 (2.2048) ce_loss 2.2012 (2.2038) loss_zs_kd 0.0545 (0.0127) loss_oracle 0.0003 (-0.0001) acc 34.3750 (32.5521) kd_loss 0.0008 (0.0010) lr 1.0000e-05 eta 0:31:48
epoch [1/50] batch [140/445] time 0.075 (0.085) data 0.000 (0.005) loss 1.9167 (2.1709) ce_loss 1.8936 (2.1694) loss_zs_kd 0.2571 (0.0317) loss_oracle 0.0367 (0.0008) acc 43.7500 (33.1473) kd_loss 0.0048 (0.0011) lr 1.0000e-05 eta 0:31:22
epoch [1/50] batch [160/445] time 0.082 (0.084) data 0.000 (0.005) loss 1.6146 (2.1279) ce_loss 1.5938 (2.1237) loss_zs_kd 0.2194 (0.0649) loss_oracle 0.0016 (0.0027) acc 50.0000 (34.2383) kd_loss 0.0200 (0.0029) lr 1.0000e-05 eta 0:31:05
epoch [1/50] batch [180/445] time 0.078 (0.084) data 0.000 (0.004) loss 1.9137 (2.0891) ce_loss 1.8438 (2.0812) loss_zs_kd 0.4035 (0.0928) loss_oracle 0.0173 (0.0033) acc 43.7500 (34.9479) kd_loss 0.0614 (0.0063) lr 1.0000e-05 eta 0:30:48
epoch [1/50] batch [200/445] time 0.073 (0.083) data 0.000 (0.004) loss 1.9317 (2.0615) ce_loss 1.8184 (2.0464) loss_zs_kd 0.4934 (0.1210) loss_oracle 0.0084 (0.0036) acc 40.6250 (35.4688) kd_loss 0.1091 (0.0133) lr 1.0000e-05 eta 0:30:39
epoch [1/50] batch [220/445] time 0.090 (0.083) data 0.000 (0.004) loss 1.7702 (2.0430) ce_loss 1.6270 (2.0183) loss_zs_kd 0.3768 (0.1495) loss_oracle 0.0044 (0.0037) acc 40.6250 (36.0085) kd_loss 0.1410 (0.0229) lr 1.0000e-05 eta 0:30:38
epoch [1/50] batch [240/445] time 0.098 (0.085) data 0.000 (0.003) loss 2.0418 (2.0291) ce_loss 1.8359 (1.9945) loss_zs_kd 0.5085 (0.1794) loss_oracle 0.0163 (0.0042) acc 28.1250 (36.3672) kd_loss 0.1977 (0.0326) lr 1.0000e-05 eta 0:31:03
epoch [1/50] batch [260/445] time 0.080 (0.085) data 0.000 (0.003) loss 2.1517 (2.0198) ce_loss 1.9043 (1.9720) loss_zs_kd 0.4642 (0.1991) loss_oracle 0.0203 (0.0048) acc 34.3750 (36.8870) kd_loss 0.2372 (0.0454) lr 1.0000e-05 eta 0:31:05
epoch [1/50] batch [280/445] time 0.080 (0.085) data 0.000 (0.003) loss 2.0776 (2.0279) ce_loss 1.6133 (1.9599) loss_zs_kd 0.3725 (0.2213) loss_oracle 0.0326 (0.0072) acc 37.5000 (37.1540) kd_loss 0.4481 (0.0644) lr 1.0000e-05 eta 0:31:02
epoch [1/50] batch [300/445] time 0.080 (0.085) data 0.000 (0.003) loss 2.0187 (2.0298) ce_loss 1.6484 (1.9357) loss_zs_kd 0.3791 (0.2383) loss_oracle 0.0091 (0.0078) acc 43.7500 (37.6875) kd_loss 0.3657 (0.0902) lr 1.0000e-05 eta 0:30:57
epoch [1/50] batch [320/445] time 0.082 (0.084) data 0.000 (0.003) loss 2.0654 (2.0361) ce_loss 1.4766 (1.9181) loss_zs_kd 0.7048 (0.2599) loss_oracle 0.0859 (0.0100) acc 40.6250 (38.1348) kd_loss 0.5459 (0.1131) lr 1.0000e-05 eta 0:30:46
epoch [1/50] batch [340/445] time 0.080 (0.084) data 0.000 (0.002) loss 2.4626 (2.0516) ce_loss 1.7236 (1.9036) loss_zs_kd 0.5429 (0.2759) loss_oracle 0.0569 (0.0132) acc 31.2500 (38.4099) kd_loss 0.7105 (0.1414) lr 1.0000e-05 eta 0:30:40
epoch [1/50] batch [360/445] time 0.082 (0.084) data 0.000 (0.002) loss 2.2017 (2.0638) ce_loss 1.4834 (1.8860) loss_zs_kd 0.4670 (0.2897) loss_oracle 0.0462 (0.0157) acc 43.7500 (38.7066) kd_loss 0.6951 (0.1700) lr 1.0000e-05 eta 0:30:38
epoch [1/50] batch [380/445] time 0.079 (0.084) data 0.000 (0.002) loss 2.3279 (2.0754) ce_loss 1.5283 (1.8684) loss_zs_kd 0.4379 (0.3018) loss_oracle 0.0609 (0.0179) acc 50.0000 (39.1118) kd_loss 0.7691 (0.1980) lr 1.0000e-05 eta 0:30:38
epoch [1/50] batch [400/445] time 0.090 (0.084) data 0.000 (0.002) loss 2.4209 (2.0956) ce_loss 1.8008 (1.8627) loss_zs_kd 0.5212 (0.3123) loss_oracle 0.0659 (0.0205) acc 37.5000 (39.1406) kd_loss 0.5872 (0.2227) lr 1.0000e-05 eta 0:30:37
epoch [1/50] batch [420/445] time 0.085 (0.084) data 0.000 (0.002) loss 2.4393 (2.1107) ce_loss 1.5586 (1.8506) loss_zs_kd 0.4649 (0.3221) loss_oracle 0.2013 (0.0266) acc 40.6250 (39.3229) kd_loss 0.7801 (0.2468) lr 1.0000e-05 eta 0:30:36
epoch [1/50] batch [440/445] time 0.079 (0.084) data 0.000 (0.002) loss 2.7730 (2.1269) ce_loss 1.9912 (1.8397) loss_zs_kd 0.7072 (0.3324) loss_oracle 0.1905 (0.0346) acc 25.0000 (39.5099) kd_loss 0.6865 (0.2699) lr 1.0000e-05 eta 0:30:31
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 2,943
* accuracy: 48.2%
* error: 51.8%
* macro_f1: 35.2%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,399
* accuracy: 35.2%
* error: 64.8%
* macro_f1: 27.8%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      48.2%, epoch: 1 *******
******* Domain 3 best val test acc: 35.2%, epoch: 1 *******
******* Domain 3 best test acc:     35.2%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/ana
epoch [2/50] batch [20/445] time 0.087 (0.128) data 0.000 (0.040) loss 2.5774 (2.6264) ce_loss 1.5859 (1.6667) loss_zs_kd 0.4824 (0.5577) loss_oracle 0.3579 (0.3950) acc 50.0000 (43.9062) kd_loss 0.8125 (0.7621) lr 2.0000e-03 eta 0:46:28
epoch [2/50] batch [40/445] time 0.078 (0.103) data 0.000 (0.020) loss 2.3711 (2.5210) ce_loss 1.3867 (1.5418) loss_zs_kd 0.7034 (0.6722) loss_oracle 0.4451 (0.4029) acc 46.8750 (47.1875) kd_loss 0.7618 (0.7777) lr 2.0000e-03 eta 0:37:11
epoch [2/50] batch [60/445] time 0.089 (0.096) data 0.000 (0.013) loss 2.4098 (2.4865) ce_loss 1.3721 (1.5029) loss_zs_kd 0.8777 (0.7459) loss_oracle 0.5535 (0.4520) acc 46.8750 (47.9167) kd_loss 0.7610 (0.7576) lr 2.0000e-03 eta 0:34:57
epoch [2/50] batch [80/445] time 0.089 (0.094) data 0.001 (0.010) loss 2.4620 (2.4748) ce_loss 1.5547 (1.4876) loss_zs_kd 0.9198 (0.7437) loss_oracle 0.4157 (0.4646) acc 43.7500 (48.2812) kd_loss 0.6995 (0.7549) lr 2.0000e-03 eta 0:34:00
epoch [2/50] batch [100/445] time 0.079 (0.090) data 0.000 (0.008) loss 2.4149 (2.4494) ce_loss 1.3359 (1.4618) loss_zs_kd 0.9856 (0.7733) loss_oracle 0.5625 (0.4730) acc 50.0000 (49.1875) kd_loss 0.7977 (0.7511) lr 2.0000e-03 eta 0:32:30
epoch [2/50] batch [120/445] time 0.070 (0.087) data 0.000 (0.007) loss 2.4369 (2.4255) ce_loss 1.3564 (1.4263) loss_zs_kd 0.7005 (0.8042) loss_oracle 0.5480 (0.4829) acc 46.8750 (50.1042) kd_loss 0.8065 (0.7577) lr 2.0000e-03 eta 0:31:20
epoch [2/50] batch [140/445] time 0.087 (0.085) data 0.000 (0.006) loss 2.3175 (2.4183) ce_loss 1.1992 (1.4066) loss_zs_kd 0.8896 (0.8278) loss_oracle 0.5969 (0.4935) acc 59.3750 (50.8482) kd_loss 0.8199 (0.7649) lr 2.0000e-03 eta 0:30:44
epoch [2/50] batch [160/445] time 0.084 (0.085) data 0.000 (0.005) loss 2.4208 (2.4154) ce_loss 1.2148 (1.3867) loss_zs_kd 0.9571 (0.8550) loss_oracle 0.6023 (0.5048) acc 56.2500 (51.5820) kd_loss 0.9048 (0.7763) lr 2.0000e-03 eta 0:30:39
epoch [2/50] batch [180/445] time 0.083 (0.085) data 0.000 (0.005) loss 2.2623 (2.4121) ce_loss 1.1416 (1.3704) loss_zs_kd 1.0710 (0.8844) loss_oracle 0.5228 (0.5142) acc 65.6250 (52.0833) kd_loss 0.8593 (0.7846) lr 2.0000e-03 eta 0:30:34
epoch [2/50] batch [200/445] time 0.074 (0.084) data 0.000 (0.004) loss 2.2483 (2.4026) ce_loss 1.1279 (1.3488) loss_zs_kd 0.8849 (0.8971) loss_oracle 0.5335 (0.5233) acc 53.1250 (52.8906) kd_loss 0.8536 (0.7922) lr 2.0000e-03 eta 0:30:10
epoch [2/50] batch [220/445] time 0.081 (0.083) data 0.000 (0.004) loss 2.1714 (2.3891) ce_loss 1.0586 (1.3305) loss_zs_kd 1.3219 (0.9143) loss_oracle 0.5013 (0.5246) acc 65.6250 (53.6648) kd_loss 0.8622 (0.7963) lr 2.0000e-03 eta 0:29:59
epoch [2/50] batch [240/445] time 0.090 (0.083) data 0.000 (0.004) loss 2.4822 (2.3798) ce_loss 1.3711 (1.3182) loss_zs_kd 1.2115 (0.9356) loss_oracle 0.6235 (0.5258) acc 56.2500 (53.9714) kd_loss 0.7993 (0.7987) lr 2.0000e-03 eta 0:29:54
epoch [2/50] batch [260/445] time 0.082 (0.084) data 0.000 (0.003) loss 2.2196 (2.3772) ce_loss 1.0615 (1.3117) loss_zs_kd 1.0195 (0.9447) loss_oracle 0.4377 (0.5251) acc 62.5000 (54.2188) kd_loss 0.9392 (0.8029) lr 2.0000e-03 eta 0:30:07
epoch [2/50] batch [280/445] time 0.082 (0.084) data 0.000 (0.003) loss 2.1130 (2.3639) ce_loss 1.0547 (1.2958) loss_zs_kd 0.8818 (0.9603) loss_oracle 0.4732 (0.5242) acc 65.6250 (54.6652) kd_loss 0.8217 (0.8060) lr 2.0000e-03 eta 0:30:02
epoch [2/50] batch [300/445] time 0.085 (0.083) data 0.000 (0.003) loss 2.4783 (2.3609) ce_loss 1.3262 (1.2868) loss_zs_kd 1.2874 (0.9766) loss_oracle 0.6522 (0.5288) acc 56.2500 (55.0104) kd_loss 0.8260 (0.8098) lr 2.0000e-03 eta 0:29:48
epoch [2/50] batch [320/445] time 0.081 (0.083) data 0.000 (0.003) loss 2.2294 (2.3623) ce_loss 1.1094 (1.2824) loss_zs_kd 1.3716 (0.9899) loss_oracle 0.5813 (0.5336) acc 62.5000 (55.1855) kd_loss 0.8294 (0.8132) lr 2.0000e-03 eta 0:29:49
epoch [2/50] batch [340/445] time 0.087 (0.083) data 0.000 (0.003) loss 2.4146 (2.3582) ce_loss 1.2402 (1.2731) loss_zs_kd 1.3628 (1.0011) loss_oracle 0.5232 (0.5359) acc 50.0000 (55.4596) kd_loss 0.9128 (0.8172) lr 2.0000e-03 eta 0:29:45
epoch [2/50] batch [360/445] time 0.081 (0.083) data 0.000 (0.002) loss 2.1251 (2.3544) ce_loss 0.9834 (1.2639) loss_zs_kd 1.3140 (1.0120) loss_oracle 0.6200 (0.5395) acc 68.7500 (55.7986) kd_loss 0.8317 (0.8207) lr 2.0000e-03 eta 0:29:42
epoch [2/50] batch [380/445] time 0.079 (0.083) data 0.000 (0.002) loss 2.2623 (2.3435) ce_loss 1.1191 (1.2502) loss_zs_kd 1.3239 (1.0199) loss_oracle 0.5196 (0.5406) acc 59.3750 (56.2829) kd_loss 0.8834 (0.8231) lr 2.0000e-03 eta 0:29:40
epoch [2/50] batch [400/445] time 0.086 (0.083) data 0.000 (0.002) loss 1.7991 (2.3352) ce_loss 0.7896 (1.2418) loss_zs_kd 1.0345 (1.0319) loss_oracle 0.5996 (0.5410) acc 75.0000 (56.5703) kd_loss 0.7098 (0.8230) lr 2.0000e-03 eta 0:29:40
epoch [2/50] batch [420/445] time 0.082 (0.083) data 0.000 (0.002) loss 2.2318 (2.3302) ce_loss 1.1143 (1.2375) loss_zs_kd 1.5156 (1.0441) loss_oracle 0.5803 (0.5411) acc 59.3750 (56.6741) kd_loss 0.8274 (0.8222) lr 2.0000e-03 eta 0:29:39
epoch [2/50] batch [440/445] time 0.082 (0.083) data 0.000 (0.002) loss 2.3974 (2.3256) ce_loss 1.3076 (1.2338) loss_zs_kd 1.4095 (1.0536) loss_oracle 0.6386 (0.5406) acc 50.0000 (56.7614) kd_loss 0.7704 (0.8216) lr 2.0000e-03 eta 0:29:35
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 3,944
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 49.9%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,848
* accuracy: 46.5%
* error: 53.5%
* macro_f1: 27.8%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      64.6%, epoch: 2 *******
******* Domain 3 best val test acc: 46.5%, epoch: 2 *******
******* Domain 3 best test acc:     46.5%, epoch: 2 *******
epoch [3/50] batch [20/445] time 0.057 (0.105) data 0.000 (0.035) loss 2.0360 (2.1526) ce_loss 0.9761 (1.1220) loss_zs_kd 1.2372 (1.2263) loss_oracle 0.5098 (0.4813) acc 65.6250 (59.3750) kd_loss 0.8050 (0.7900) lr 1.9980e-03 eta 0:37:20
epoch [3/50] batch [40/445] time 0.091 (0.093) data 0.000 (0.018) loss 2.2056 (2.1604) ce_loss 1.1631 (1.1270) loss_zs_kd 1.5919 (1.2335) loss_oracle 0.5073 (0.4853) acc 59.3750 (59.9219) kd_loss 0.7888 (0.7907) lr 1.9980e-03 eta 0:33:01
epoch [3/50] batch [60/445] time 0.083 (0.090) data 0.000 (0.012) loss 2.1297 (2.1289) ce_loss 1.1523 (1.1006) loss_zs_kd 1.6445 (1.2766) loss_oracle 0.4623 (0.4804) acc 59.3750 (60.1562) kd_loss 0.7462 (0.7881) lr 1.9980e-03 eta 0:31:55
epoch [3/50] batch [80/445] time 0.079 (0.088) data 0.000 (0.009) loss 2.3097 (2.1261) ce_loss 1.1738 (1.0886) loss_zs_kd 1.6922 (1.3048) loss_oracle 0.5266 (0.4855) acc 53.1250 (60.4297) kd_loss 0.8726 (0.7948) lr 1.9980e-03 eta 0:31:16
epoch [3/50] batch [100/445] time 0.082 (0.088) data 0.000 (0.007) loss 2.1424 (2.1319) ce_loss 1.2256 (1.0894) loss_zs_kd 1.5931 (1.3168) loss_oracle 0.4714 (0.4915) acc 43.7500 (60.3438) kd_loss 0.6811 (0.7968) lr 1.9980e-03 eta 0:31:02
epoch [3/50] batch [120/445] time 0.089 (0.087) data 0.000 (0.006) loss 2.1981 (2.1238) ce_loss 1.0928 (1.0768) loss_zs_kd 1.6249 (1.3088) loss_oracle 0.5743 (0.4938) acc 59.3750 (61.1458) kd_loss 0.8182 (0.8001) lr 1.9980e-03 eta 0:30:52
epoch [3/50] batch [140/445] time 0.090 (0.087) data 0.000 (0.005) loss 2.4882 (2.1337) ce_loss 1.3057 (1.0788) loss_zs_kd 1.4836 (1.3344) loss_oracle 0.6563 (0.5026) acc 56.2500 (61.2277) kd_loss 0.8544 (0.8036) lr 1.9980e-03 eta 0:30:45
epoch [3/50] batch [160/445] time 0.086 (0.087) data 0.000 (0.005) loss 2.3231 (2.1410) ce_loss 1.1631 (1.0827) loss_zs_kd 1.2508 (1.3185) loss_oracle 0.6386 (0.5070) acc 56.2500 (61.0547) kd_loss 0.8407 (0.8047) lr 1.9980e-03 eta 0:30:36
epoch [3/50] batch [180/445] time 0.086 (0.087) data 0.000 (0.004) loss 2.2947 (2.1513) ce_loss 1.1973 (1.0907) loss_zs_kd 1.4344 (1.3362) loss_oracle 0.5043 (0.5084) acc 62.5000 (60.8333) kd_loss 0.8453 (0.8064) lr 1.9980e-03 eta 0:30:35
epoch [3/50] batch [200/445] time 0.082 (0.086) data 0.000 (0.004) loss 2.0182 (2.1519) ce_loss 0.8315 (1.0867) loss_zs_kd 1.6281 (1.3513) loss_oracle 0.5389 (0.5090) acc 71.8750 (60.7031) kd_loss 0.9172 (0.8107) lr 1.9980e-03 eta 0:30:29
epoch [3/50] batch [220/445] time 0.084 (0.086) data 0.000 (0.003) loss 2.2048 (2.1511) ce_loss 0.9575 (1.0814) loss_zs_kd 1.4838 (1.3647) loss_oracle 0.5333 (0.5102) acc 65.6250 (60.9659) kd_loss 0.9806 (0.8146) lr 1.9980e-03 eta 0:30:21
epoch [3/50] batch [240/445] time 0.084 (0.086) data 0.000 (0.003) loss 1.7503 (2.1410) ce_loss 0.6372 (1.0691) loss_zs_kd 1.3864 (1.3702) loss_oracle 0.4964 (0.5124) acc 84.3750 (61.4974) kd_loss 0.8649 (0.8157) lr 1.9980e-03 eta 0:30:16
epoch [3/50] batch [260/445] time 0.082 (0.086) data 0.000 (0.003) loss 1.6373 (2.1384) ce_loss 0.5581 (1.0652) loss_zs_kd 1.4656 (1.3681) loss_oracle 0.4941 (0.5147) acc 84.3750 (61.5625) kd_loss 0.8321 (0.8158) lr 1.9980e-03 eta 0:30:07
epoch [3/50] batch [280/445] time 0.096 (0.086) data 0.000 (0.003) loss 2.0602 (2.1321) ce_loss 1.0146 (1.0602) loss_zs_kd 1.5771 (1.3732) loss_oracle 0.5406 (0.5151) acc 68.7500 (61.7411) kd_loss 0.7752 (0.8143) lr 1.9980e-03 eta 0:30:05
epoch [3/50] batch [300/445] time 0.084 (0.086) data 0.000 (0.003) loss 2.4304 (2.1306) ce_loss 1.3877 (1.0601) loss_zs_kd 1.6430 (1.3824) loss_oracle 0.5259 (0.5165) acc 56.2500 (61.7396) kd_loss 0.7797 (0.8122) lr 1.9980e-03 eta 0:30:04
epoch [3/50] batch [320/445] time 0.090 (0.086) data 0.000 (0.002) loss 1.9755 (2.1296) ce_loss 0.9263 (1.0610) loss_zs_kd 1.2279 (1.3868) loss_oracle 0.5369 (0.5174) acc 62.5000 (61.6406) kd_loss 0.7808 (0.8098) lr 1.9980e-03 eta 0:30:01
epoch [3/50] batch [340/445] time 0.084 (0.086) data 0.000 (0.002) loss 2.3221 (2.1278) ce_loss 1.2832 (1.0618) loss_zs_kd 1.2322 (1.3961) loss_oracle 0.5116 (0.5175) acc 43.7500 (61.6085) kd_loss 0.7831 (0.8072) lr 1.9980e-03 eta 0:29:58
epoch [3/50] batch [360/445] time 0.090 (0.086) data 0.000 (0.002) loss 2.1378 (2.1245) ce_loss 1.2324 (1.0605) loss_zs_kd 1.4505 (1.3898) loss_oracle 0.4665 (0.5171) acc 62.5000 (61.7448) kd_loss 0.6721 (0.8054) lr 1.9980e-03 eta 0:29:55
epoch [3/50] batch [380/445] time 0.085 (0.086) data 0.000 (0.002) loss 1.9129 (2.1170) ce_loss 0.9419 (1.0565) loss_zs_kd 1.4703 (1.3894) loss_oracle 0.5019 (0.5178) acc 56.2500 (61.9326) kd_loss 0.7201 (0.8016) lr 1.9980e-03 eta 0:29:53
epoch [3/50] batch [400/445] time 0.082 (0.085) data 0.000 (0.002) loss 2.1636 (2.1111) ce_loss 1.0068 (1.0543) loss_zs_kd 1.2236 (1.3880) loss_oracle 0.5181 (0.5167) acc 65.6250 (61.9609) kd_loss 0.8977 (0.7985) lr 1.9980e-03 eta 0:29:51
epoch [3/50] batch [420/445] time 0.079 (0.085) data 0.000 (0.002) loss 1.9642 (2.1072) ce_loss 1.0322 (1.0528) loss_zs_kd 1.7031 (1.3938) loss_oracle 0.4377 (0.5175) acc 71.8750 (62.0759) kd_loss 0.7131 (0.7957) lr 1.9980e-03 eta 0:29:50
epoch [3/50] batch [440/445] time 0.081 (0.085) data 0.000 (0.002) loss 2.2998 (2.1054) ce_loss 1.3398 (1.0523) loss_zs_kd 1.3278 (1.3908) loss_oracle 0.4970 (0.5187) acc 50.0000 (62.1094) kd_loss 0.7114 (0.7937) lr 1.9980e-03 eta 0:29:46
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,048
* accuracy: 66.3%
* error: 33.7%
* macro_f1: 50.5%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,815
* accuracy: 45.7%
* error: 54.3%
* macro_f1: 27.8%
******* Domain 3 best val acc:      66.3%, epoch: 3 *******
******* Domain 3 best val test acc: 45.7%, epoch: 3 *******
******* Domain 3 best test acc:     46.5%, epoch: 2 *******
epoch [4/50] batch [20/445] time 0.078 (0.138) data 0.000 (0.048) loss 2.1741 (2.0698) ce_loss 1.1904 (1.0841) loss_zs_kd 1.4557 (1.4690) loss_oracle 0.5896 (0.5047) acc 56.2500 (58.9062) kd_loss 0.6888 (0.7334) lr 1.9921e-03 eta 0:48:12
epoch [4/50] batch [40/445] time 0.076 (0.109) data 0.000 (0.024) loss 2.0853 (2.0771) ce_loss 1.0820 (1.0775) loss_zs_kd 1.4280 (1.4220) loss_oracle 0.6782 (0.5139) acc 56.2500 (59.8438) kd_loss 0.6641 (0.7427) lr 1.9921e-03 eta 0:37:57
epoch [4/50] batch [60/445] time 0.078 (0.099) data 0.001 (0.016) loss 1.6684 (2.0574) ce_loss 0.6611 (1.0592) loss_zs_kd 1.4717 (1.4074) loss_oracle 0.5157 (0.5140) acc 78.1250 (61.1979) kd_loss 0.7494 (0.7412) lr 1.9921e-03 eta 0:34:17
epoch [4/50] batch [80/445] time 0.078 (0.095) data 0.000 (0.012) loss 1.7938 (2.0295) ce_loss 0.8164 (1.0305) loss_zs_kd 1.4266 (1.4037) loss_oracle 0.5677 (0.5147) acc 75.0000 (62.7344) kd_loss 0.6936 (0.7416) lr 1.9921e-03 eta 0:32:50
epoch [4/50] batch [100/445] time 0.084 (0.092) data 0.000 (0.010) loss 1.9868 (2.0245) ce_loss 1.0674 (1.0266) loss_zs_kd 1.3518 (1.4181) loss_oracle 0.4532 (0.5145) acc 62.5000 (62.9375) kd_loss 0.6928 (0.7407) lr 1.9921e-03 eta 0:31:55
epoch [4/50] batch [120/445] time 0.080 (0.091) data 0.000 (0.008) loss 1.9109 (2.0158) ce_loss 0.8696 (1.0183) loss_zs_kd 1.6141 (1.4489) loss_oracle 0.5423 (0.5132) acc 75.0000 (63.4896) kd_loss 0.7701 (0.7409) lr 1.9921e-03 eta 0:31:27
epoch [4/50] batch [140/445] time 0.074 (0.089) data 0.000 (0.007) loss 1.6191 (2.0166) ce_loss 0.7422 (1.0203) loss_zs_kd 1.5681 (1.4477) loss_oracle 0.4553 (0.5111) acc 75.0000 (63.3482) kd_loss 0.6492 (0.7407) lr 1.9921e-03 eta 0:30:55
epoch [4/50] batch [160/445] time 0.082 (0.089) data 0.000 (0.006) loss 2.0106 (2.0116) ce_loss 0.9849 (1.0149) loss_zs_kd 1.2438 (1.4696) loss_oracle 0.5255 (0.5107) acc 59.3750 (63.3398) kd_loss 0.7630 (0.7414) lr 1.9921e-03 eta 0:30:40
epoch [4/50] batch [180/445] time 0.082 (0.088) data 0.000 (0.006) loss 2.1536 (2.0110) ce_loss 1.1211 (1.0150) loss_zs_kd 1.3638 (1.4584) loss_oracle 0.4938 (0.5122) acc 53.1250 (63.3854) kd_loss 0.7856 (0.7399) lr 1.9921e-03 eta 0:30:28
epoch [4/50] batch [200/445] time 0.082 (0.088) data 0.000 (0.005) loss 1.9648 (2.0122) ce_loss 1.1338 (1.0175) loss_zs_kd 1.4296 (1.4545) loss_oracle 0.3962 (0.5134) acc 53.1250 (63.2969) kd_loss 0.6330 (0.7380) lr 1.9921e-03 eta 0:30:21
epoch [4/50] batch [220/445] time 0.093 (0.088) data 0.000 (0.005) loss 1.8135 (2.0030) ce_loss 0.8745 (1.0093) loss_zs_kd 1.2572 (1.4472) loss_oracle 0.4432 (0.5123) acc 62.5000 (63.6790) kd_loss 0.7174 (0.7376) lr 1.9921e-03 eta 0:30:16
epoch [4/50] batch [240/445] time 0.085 (0.088) data 0.000 (0.004) loss 2.1498 (1.9940) ce_loss 1.1738 (1.0036) loss_zs_kd 1.5061 (1.4620) loss_oracle 0.5303 (0.5094) acc 53.1250 (63.9193) kd_loss 0.7108 (0.7356) lr 1.9921e-03 eta 0:30:12
epoch [4/50] batch [260/445] time 0.089 (0.088) data 0.000 (0.004) loss 1.8504 (1.9947) ce_loss 0.8389 (1.0063) loss_zs_kd 1.2938 (1.4678) loss_oracle 0.5116 (0.5090) acc 68.7500 (63.8221) kd_loss 0.7557 (0.7339) lr 1.9921e-03 eta 0:30:07
epoch [4/50] batch [280/445] time 0.084 (0.087) data 0.000 (0.004) loss 2.1788 (1.9908) ce_loss 1.2520 (1.0057) loss_zs_kd 1.5238 (1.4614) loss_oracle 0.5019 (0.5071) acc 68.7500 (64.1295) kd_loss 0.6759 (0.7315) lr 1.9921e-03 eta 0:30:01
epoch [4/50] batch [300/445] time 0.078 (0.087) data 0.000 (0.003) loss 1.9159 (1.9876) ce_loss 1.0605 (1.0059) loss_zs_kd 1.6969 (1.4631) loss_oracle 0.4483 (0.5058) acc 59.3750 (64.1458) kd_loss 0.6312 (0.7287) lr 1.9921e-03 eta 0:29:52
epoch [4/50] batch [320/445] time 0.090 (0.087) data 0.000 (0.003) loss 1.9330 (1.9875) ce_loss 1.0518 (1.0082) loss_zs_kd 1.1488 (1.4564) loss_oracle 0.5336 (0.5060) acc 65.6250 (64.1113) kd_loss 0.6144 (0.7263) lr 1.9921e-03 eta 0:29:50
epoch [4/50] batch [340/445] time 0.085 (0.087) data 0.000 (0.003) loss 2.1416 (1.9845) ce_loss 1.2607 (1.0073) loss_zs_kd 1.8230 (1.4581) loss_oracle 0.4743 (0.5059) acc 56.2500 (64.1544) kd_loss 0.6438 (0.7242) lr 1.9921e-03 eta 0:29:45
epoch [4/50] batch [360/445] time 0.082 (0.087) data 0.000 (0.003) loss 2.0932 (1.9817) ce_loss 1.1514 (1.0078) loss_zs_kd 1.4625 (1.4626) loss_oracle 0.4430 (0.5041) acc 56.2500 (64.1927) kd_loss 0.7203 (0.7218) lr 1.9921e-03 eta 0:29:39
epoch [4/50] batch [380/445] time 0.080 (0.086) data 0.000 (0.003) loss 1.7530 (1.9737) ce_loss 0.8247 (1.0038) loss_zs_kd 1.2961 (1.4651) loss_oracle 0.4681 (0.5022) acc 81.2500 (64.4161) kd_loss 0.6942 (0.7187) lr 1.9921e-03 eta 0:29:31
epoch [4/50] batch [400/445] time 0.078 (0.086) data 0.000 (0.003) loss 2.0335 (1.9736) ce_loss 1.1396 (1.0074) loss_zs_kd 2.0267 (1.4693) loss_oracle 0.4543 (0.5027) acc 62.5000 (64.2734) kd_loss 0.6667 (0.7149) lr 1.9921e-03 eta 0:29:21
epoch [4/50] batch [420/445] time 0.082 (0.086) data 0.000 (0.003) loss 1.7497 (1.9656) ce_loss 0.9072 (1.0036) loss_zs_kd 1.4726 (1.4678) loss_oracle 0.4704 (0.5025) acc 68.7500 (64.4122) kd_loss 0.6073 (0.7108) lr 1.9921e-03 eta 0:29:19
epoch [4/50] batch [440/445] time 0.079 (0.086) data 0.000 (0.002) loss 1.7406 (1.9624) ce_loss 0.8716 (1.0043) loss_zs_kd 1.6798 (1.4754) loss_oracle 0.4729 (0.5007) acc 75.0000 (64.3253) kd_loss 0.6326 (0.7077) lr 1.9921e-03 eta 0:29:13
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,230
* accuracy: 69.3%
* error: 30.7%
* macro_f1: 56.7%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,913
* accuracy: 48.2%
* error: 51.8%
* macro_f1: 32.4%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      69.3%, epoch: 4 *******
******* Domain 3 best val test acc: 48.2%, epoch: 4 *******
******* Domain 3 best test acc:     48.2%, epoch: 4 *******
epoch [5/50] batch [20/445] time 0.082 (0.138) data 0.000 (0.056) loss 1.7122 (1.9612) ce_loss 0.8638 (1.0851) loss_zs_kd 1.8123 (1.4815) loss_oracle 0.5409 (0.4877) acc 65.6250 (62.6562) kd_loss 0.5780 (0.6322) lr 1.9823e-03 eta 0:47:02
epoch [5/50] batch [40/445] time 0.084 (0.112) data 0.000 (0.028) loss 1.6932 (1.8744) ce_loss 0.8657 (1.0191) loss_zs_kd 1.5115 (1.4712) loss_oracle 0.4733 (0.4844) acc 65.6250 (63.1250) kd_loss 0.5908 (0.6131) lr 1.9823e-03 eta 0:38:03
epoch [5/50] batch [60/445] time 0.079 (0.103) data 0.000 (0.019) loss 2.1461 (1.8443) ce_loss 1.3281 (0.9867) loss_zs_kd 1.5333 (1.4806) loss_oracle 0.4627 (0.4840) acc 62.5000 (64.0104) kd_loss 0.5866 (0.6156) lr 1.9823e-03 eta 0:34:55
epoch [5/50] batch [80/445] time 0.078 (0.098) data 0.000 (0.014) loss 1.9424 (1.8434) ce_loss 1.0996 (0.9891) loss_zs_kd 1.5912 (1.4765) loss_oracle 0.4534 (0.4752) acc 50.0000 (64.5703) kd_loss 0.6161 (0.6167) lr 1.9823e-03 eta 0:33:20
epoch [5/50] batch [100/445] time 0.083 (0.095) data 0.000 (0.012) loss 1.7724 (1.8394) ce_loss 0.8838 (0.9829) loss_zs_kd 1.6457 (1.4674) loss_oracle 0.5363 (0.4816) acc 71.8750 (64.5312) kd_loss 0.6205 (0.6157) lr 1.9823e-03 eta 0:32:19
epoch [5/50] batch [120/445] time 0.088 (0.095) data 0.000 (0.010) loss 1.9378 (1.8329) ce_loss 1.0098 (0.9770) loss_zs_kd 1.5331 (1.5056) loss_oracle 0.5737 (0.4798) acc 75.0000 (64.9219) kd_loss 0.6412 (0.6161) lr 1.9823e-03 eta 0:32:19
epoch [5/50] batch [140/445] time 0.077 (0.094) data 0.000 (0.008) loss 2.0328 (1.8466) ce_loss 1.1504 (0.9891) loss_zs_kd 1.3345 (1.5080) loss_oracle 0.5718 (0.4817) acc 56.2500 (64.4643) kd_loss 0.5965 (0.6167) lr 1.9823e-03 eta 0:31:42
epoch [5/50] batch [160/445] time 0.079 (0.092) data 0.001 (0.007) loss 1.6224 (1.8475) ce_loss 0.8022 (0.9900) loss_zs_kd 1.7522 (1.5290) loss_oracle 0.4570 (0.4816) acc 78.1250 (64.1602) kd_loss 0.5916 (0.6167) lr 1.9823e-03 eta 0:31:07
epoch [5/50] batch [180/445] time 0.073 (0.090) data 0.000 (0.007) loss 1.5248 (1.8357) ce_loss 0.7144 (0.9822) loss_zs_kd 1.5232 (1.5348) loss_oracle 0.4975 (0.4824) acc 68.7500 (64.4097) kd_loss 0.5616 (0.6123) lr 1.9823e-03 eta 0:30:26
epoch [5/50] batch [200/445] time 0.076 (0.089) data 0.000 (0.006) loss 1.8844 (1.8314) ce_loss 1.0869 (0.9798) loss_zs_kd 1.3422 (1.5435) loss_oracle 0.4388 (0.4826) acc 62.5000 (64.5938) kd_loss 0.5781 (0.6103) lr 1.9823e-03 eta 0:30:03
epoch [5/50] batch [220/445] time 0.069 (0.088) data 0.000 (0.005) loss 1.7222 (1.8327) ce_loss 0.9019 (0.9827) loss_zs_kd 1.1093 (1.5464) loss_oracle 0.4794 (0.4849) acc 65.6250 (64.4034) kd_loss 0.5806 (0.6076) lr 1.9823e-03 eta 0:29:31
epoch [5/50] batch [240/445] time 0.086 (0.086) data 0.000 (0.005) loss 1.8876 (1.8318) ce_loss 1.0254 (0.9829) loss_zs_kd 1.2837 (1.5455) loss_oracle 0.5180 (0.4850) acc 62.5000 (64.4661) kd_loss 0.6032 (0.6064) lr 1.9823e-03 eta 0:29:08
epoch [5/50] batch [260/445] time 0.084 (0.086) data 0.000 (0.005) loss 2.0090 (1.8325) ce_loss 1.1562 (0.9849) loss_zs_kd 1.5081 (1.5468) loss_oracle 0.4461 (0.4843) acc 68.7500 (64.4712) kd_loss 0.6298 (0.6055) lr 1.9823e-03 eta 0:29:04
epoch [5/50] batch [280/445] time 0.091 (0.086) data 0.000 (0.004) loss 1.7585 (1.8314) ce_loss 0.9136 (0.9850) loss_zs_kd 1.6886 (1.5529) loss_oracle 0.5751 (0.4847) acc 68.7500 (64.3862) kd_loss 0.5574 (0.6040) lr 1.9823e-03 eta 0:29:02
epoch [5/50] batch [300/445] time 0.070 (0.086) data 0.000 (0.004) loss 1.7077 (1.8370) ce_loss 0.8413 (0.9923) loss_zs_kd 1.3714 (1.5508) loss_oracle 0.4610 (0.4835) acc 65.6250 (64.1354) kd_loss 0.6359 (0.6029) lr 1.9823e-03 eta 0:28:48
epoch [5/50] batch [320/445] time 0.078 (0.085) data 0.000 (0.004) loss 1.6588 (1.8380) ce_loss 0.7910 (0.9948) loss_zs_kd 1.4185 (1.5549) loss_oracle 0.5184 (0.4837) acc 78.1250 (64.0137) kd_loss 0.6086 (0.6013) lr 1.9823e-03 eta 0:28:40
epoch [5/50] batch [340/445] time 0.088 (0.085) data 0.000 (0.004) loss 2.0511 (1.8388) ce_loss 1.2266 (0.9968) loss_zs_kd 1.4183 (1.5502) loss_oracle 0.4586 (0.4834) acc 59.3750 (63.8787) kd_loss 0.5952 (0.6002) lr 1.9823e-03 eta 0:28:34
epoch [5/50] batch [360/445] time 0.075 (0.085) data 0.000 (0.003) loss 1.9851 (1.8391) ce_loss 1.0938 (0.9971) loss_zs_kd 1.6867 (1.5430) loss_oracle 0.5342 (0.4843) acc 75.0000 (63.9583) kd_loss 0.6242 (0.5998) lr 1.9823e-03 eta 0:28:32
epoch [5/50] batch [380/445] time 0.081 (0.085) data 0.000 (0.003) loss 1.4589 (1.8317) ce_loss 0.6494 (0.9912) loss_zs_kd 1.7799 (1.5470) loss_oracle 0.4288 (0.4835) acc 81.2500 (64.2270) kd_loss 0.5951 (0.5988) lr 1.9823e-03 eta 0:28:29
epoch [5/50] batch [400/445] time 0.083 (0.085) data 0.000 (0.003) loss 1.6099 (1.8322) ce_loss 0.8237 (0.9919) loss_zs_kd 1.3448 (1.5496) loss_oracle 0.4675 (0.4840) acc 68.7500 (64.2031) kd_loss 0.5524 (0.5983) lr 1.9823e-03 eta 0:28:28
epoch [5/50] batch [420/445] time 0.088 (0.085) data 0.000 (0.003) loss 1.7096 (1.8306) ce_loss 0.9131 (0.9912) loss_zs_kd 1.7411 (1.5548) loss_oracle 0.4984 (0.4848) acc 81.2500 (64.2783) kd_loss 0.5473 (0.5971) lr 1.9823e-03 eta 0:28:28
epoch [5/50] batch [440/445] time 0.082 (0.085) data 0.000 (0.003) loss 2.0628 (1.8267) ce_loss 1.2998 (0.9883) loss_zs_kd 1.6262 (1.5538) loss_oracle 0.4474 (0.4846) acc 62.5000 (64.4034) kd_loss 0.5393 (0.5961) lr 1.9823e-03 eta 0:28:24
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,116
* accuracy: 67.4%
* error: 32.6%
* macro_f1: 55.3%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,008
* accuracy: 50.6%
* error: 49.4%
* macro_f1: 30.9%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      69.3%, epoch: 4 *******
******* Domain 3 best val test acc: 48.2%, epoch: 4 *******
******* Domain 3 best test acc:     50.6%, epoch: 5 *******
epoch [6/50] batch [20/445] time 0.083 (0.136) data 0.000 (0.049) loss 1.8558 (1.9376) ce_loss 1.0361 (1.1068) loss_zs_kd 1.4013 (1.5317) loss_oracle 0.5655 (0.5146) acc 59.3750 (59.6875) kd_loss 0.5369 (0.5735) lr 1.9686e-03 eta 0:45:15
epoch [6/50] batch [40/445] time 0.081 (0.111) data 0.000 (0.025) loss 1.8210 (1.9043) ce_loss 0.8970 (1.0751) loss_zs_kd 1.1621 (1.5380) loss_oracle 0.4857 (0.4964) acc 71.8750 (61.0938) kd_loss 0.6812 (0.5810) lr 1.9686e-03 eta 0:37:05
epoch [6/50] batch [60/445] time 0.089 (0.102) data 0.000 (0.016) loss 1.8672 (1.8504) ce_loss 1.0645 (1.0242) loss_zs_kd 1.6074 (1.5853) loss_oracle 0.4709 (0.4912) acc 53.1250 (62.8646) kd_loss 0.5673 (0.5806) lr 1.9686e-03 eta 0:33:59
epoch [6/50] batch [80/445] time 0.079 (0.098) data 0.000 (0.012) loss 1.6496 (1.8395) ce_loss 0.8379 (1.0181) loss_zs_kd 1.7997 (1.5990) loss_oracle 0.5498 (0.4889) acc 71.8750 (63.3984) kd_loss 0.5368 (0.5770) lr 1.9686e-03 eta 0:32:28
epoch [6/50] batch [100/445] time 0.081 (0.095) data 0.000 (0.010) loss 1.9050 (1.8492) ce_loss 1.1035 (1.0275) loss_zs_kd 1.6512 (1.6005) loss_oracle 0.3576 (0.4876) acc 56.2500 (63.1562) kd_loss 0.6227 (0.5780) lr 1.9686e-03 eta 0:31:41
epoch [6/50] batch [120/445] time 0.073 (0.094) data 0.000 (0.008) loss 1.9022 (1.8477) ce_loss 1.0547 (1.0265) loss_zs_kd 1.5280 (1.5718) loss_oracle 0.4761 (0.4876) acc 59.3750 (63.4115) kd_loss 0.6094 (0.5774) lr 1.9686e-03 eta 0:31:07
epoch [6/50] batch [140/445] time 0.096 (0.093) data 0.000 (0.007) loss 1.7285 (1.8335) ce_loss 0.8765 (1.0115) loss_zs_kd 1.7453 (1.5741) loss_oracle 0.4842 (0.4870) acc 71.8750 (63.9062) kd_loss 0.6100 (0.5785) lr 1.9686e-03 eta 0:30:45
epoch [6/50] batch [160/445] time 0.087 (0.092) data 0.000 (0.006) loss 1.7045 (1.8268) ce_loss 0.9058 (1.0015) loss_zs_kd 1.4573 (1.5811) loss_oracle 0.4120 (0.4845) acc 65.6250 (64.2188) kd_loss 0.5927 (0.5830) lr 1.9686e-03 eta 0:30:23
epoch [6/50] batch [180/445] time 0.085 (0.091) data 0.000 (0.006) loss 1.9275 (1.8275) ce_loss 1.1250 (1.0007) loss_zs_kd 1.6589 (1.5840) loss_oracle 0.4192 (0.4821) acc 56.2500 (64.4097) kd_loss 0.5929 (0.5857) lr 1.9686e-03 eta 0:30:06
epoch [6/50] batch [200/445] time 0.084 (0.090) data 0.000 (0.005) loss 1.4218 (1.8234) ce_loss 0.6812 (0.9975) loss_zs_kd 1.7882 (1.5896) loss_oracle 0.4068 (0.4810) acc 78.1250 (64.4219) kd_loss 0.5373 (0.5855) lr 1.9686e-03 eta 0:29:52
epoch [6/50] batch [220/445] time 0.080 (0.090) data 0.000 (0.005) loss 1.8728 (1.8208) ce_loss 1.0137 (0.9973) loss_zs_kd 1.6649 (1.5882) loss_oracle 0.5404 (0.4805) acc 59.3750 (64.2330) kd_loss 0.5890 (0.5832) lr 1.9686e-03 eta 0:29:41
epoch [6/50] batch [240/445] time 0.084 (0.089) data 0.000 (0.004) loss 1.6982 (1.8235) ce_loss 0.8057 (0.9991) loss_zs_kd 1.6943 (1.5970) loss_oracle 0.5485 (0.4809) acc 71.8750 (64.0625) kd_loss 0.6183 (0.5839) lr 1.9686e-03 eta 0:29:30
epoch [6/50] batch [260/445] time 0.094 (0.089) data 0.000 (0.004) loss 1.8856 (1.8179) ce_loss 1.1133 (0.9953) loss_zs_kd 1.4832 (1.5878) loss_oracle 0.4327 (0.4789) acc 56.2500 (64.1346) kd_loss 0.5559 (0.5832) lr 1.9686e-03 eta 0:29:21
epoch [6/50] batch [280/445] time 0.085 (0.089) data 0.000 (0.004) loss 1.7195 (1.8140) ce_loss 0.9106 (0.9907) loss_zs_kd 1.8838 (1.5921) loss_oracle 0.4200 (0.4778) acc 65.6250 (64.2076) kd_loss 0.5988 (0.5844) lr 1.9686e-03 eta 0:29:12
epoch [6/50] batch [300/445] time 0.085 (0.088) data 0.000 (0.004) loss 2.0162 (1.8159) ce_loss 1.1777 (0.9929) loss_zs_kd 1.4815 (1.5861) loss_oracle 0.5452 (0.4767) acc 50.0000 (64.0104) kd_loss 0.5659 (0.5846) lr 1.9686e-03 eta 0:29:05
epoch [6/50] batch [320/445] time 0.085 (0.088) data 0.000 (0.003) loss 1.7084 (1.8143) ce_loss 0.8989 (0.9909) loss_zs_kd 1.6010 (1.5877) loss_oracle 0.4251 (0.4764) acc 71.8750 (64.0527) kd_loss 0.5969 (0.5851) lr 1.9686e-03 eta 0:28:58
epoch [6/50] batch [340/445] time 0.086 (0.088) data 0.001 (0.003) loss 1.8713 (1.8107) ce_loss 0.8730 (0.9877) loss_zs_kd 1.6180 (1.5861) loss_oracle 0.5009 (0.4756) acc 71.8750 (64.2279) kd_loss 0.7478 (0.5852) lr 1.9686e-03 eta 0:28:51
epoch [6/50] batch [360/445] time 0.083 (0.088) data 0.000 (0.003) loss 1.7379 (1.8115) ce_loss 0.8677 (0.9864) loss_zs_kd 1.5379 (1.5932) loss_oracle 0.5187 (0.4777) acc 68.7500 (64.3056) kd_loss 0.6108 (0.5863) lr 1.9686e-03 eta 0:28:47
epoch [6/50] batch [380/445] time 0.084 (0.088) data 0.000 (0.003) loss 1.9044 (1.8108) ce_loss 1.0693 (0.9834) loss_zs_kd 1.5126 (1.5928) loss_oracle 0.3967 (0.4782) acc 62.5000 (64.4984) kd_loss 0.6367 (0.5883) lr 1.9686e-03 eta 0:28:42
epoch [6/50] batch [400/445] time 0.090 (0.088) data 0.000 (0.003) loss 1.9403 (1.8124) ce_loss 1.0850 (0.9829) loss_zs_kd 1.8959 (1.5995) loss_oracle 0.5289 (0.4801) acc 59.3750 (64.5391) kd_loss 0.5909 (0.5895) lr 1.9686e-03 eta 0:28:37
epoch [6/50] batch [420/445] time 0.086 (0.087) data 0.000 (0.003) loss 1.9172 (1.8148) ce_loss 0.9946 (0.9817) loss_zs_kd 1.5477 (1.6055) loss_oracle 0.5084 (0.4813) acc 71.8750 (64.6949) kd_loss 0.6683 (0.5924) lr 1.9686e-03 eta 0:28:33
epoch [6/50] batch [440/445] time 0.078 (0.087) data 0.000 (0.003) loss 1.8378 (1.8164) ce_loss 0.9482 (0.9804) loss_zs_kd 1.8676 (1.6027) loss_oracle 0.4822 (0.4826) acc 71.8750 (64.8011) kd_loss 0.6485 (0.5946) lr 1.9686e-03 eta 0:28:26
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,102
* accuracy: 67.2%
* error: 32.8%
* macro_f1: 55.8%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,774
* accuracy: 44.7%
* error: 55.3%
* macro_f1: 29.8%
******* Domain 3 best val acc:      69.3%, epoch: 4 *******
******* Domain 3 best val test acc: 48.2%, epoch: 4 *******
******* Domain 3 best test acc:     50.6%, epoch: 5 *******
epoch [7/50] batch [20/445] time 0.095 (0.147) data 0.000 (0.060) loss 1.9720 (1.8872) ce_loss 0.9907 (0.9640) loss_zs_kd 1.6678 (1.6295) loss_oracle 0.5632 (0.5105) acc 71.8750 (65.4688) kd_loss 0.6996 (0.6679) lr 1.9511e-03 eta 0:47:49
epoch [7/50] batch [40/445] time 0.081 (0.120) data 0.000 (0.030) loss 1.9651 (1.9021) ce_loss 1.0859 (0.9842) loss_zs_kd 1.5767 (1.5579) loss_oracle 0.4726 (0.4927) acc 59.3750 (65.0000) kd_loss 0.6429 (0.6715) lr 1.9511e-03 eta 0:39:05
epoch [7/50] batch [60/445] time 0.091 (0.108) data 0.000 (0.020) loss 1.7649 (1.8824) ce_loss 0.9858 (0.9579) loss_zs_kd 1.6181 (1.5725) loss_oracle 0.4536 (0.4939) acc 71.8750 (66.5625) kd_loss 0.5523 (0.6776) lr 1.9511e-03 eta 0:35:14
epoch [7/50] batch [80/445] time 0.080 (0.103) data 0.000 (0.015) loss 1.7227 (1.8792) ce_loss 0.7891 (0.9606) loss_zs_kd 1.7827 (1.5874) loss_oracle 0.5358 (0.4970) acc 71.8750 (66.2891) kd_loss 0.6658 (0.6701) lr 1.9511e-03 eta 0:33:22
epoch [7/50] batch [100/445] time 0.085 (0.099) data 0.000 (0.012) loss 2.2813 (1.8737) ce_loss 1.4111 (0.9653) loss_zs_kd 1.6873 (1.6099) loss_oracle 0.4932 (0.4945) acc 46.8750 (65.8438) kd_loss 0.6236 (0.6611) lr 1.9511e-03 eta 0:32:15
epoch [7/50] batch [120/445] time 0.089 (0.097) data 0.000 (0.010) loss 1.9732 (1.8777) ce_loss 1.1064 (0.9719) loss_zs_kd 1.5506 (1.6297) loss_oracle 0.4482 (0.4960) acc 65.6250 (65.5990) kd_loss 0.6427 (0.6578) lr 1.9511e-03 eta 0:31:25
epoch [7/50] batch [140/445] time 0.081 (0.095) data 0.000 (0.009) loss 1.4613 (1.8727) ce_loss 0.5361 (0.9687) loss_zs_kd 1.7143 (1.6304) loss_oracle 0.5116 (0.4974) acc 81.2500 (65.7143) kd_loss 0.6694 (0.6552) lr 1.9511e-03 eta 0:30:47
epoch [7/50] batch [160/445] time 0.083 (0.094) data 0.000 (0.008) loss 1.7358 (1.8623) ce_loss 0.8813 (0.9631) loss_zs_kd 2.0574 (1.6435) loss_oracle 0.5112 (0.4951) acc 65.6250 (65.6055) kd_loss 0.5988 (0.6517) lr 1.9511e-03 eta 0:30:24
epoch [7/50] batch [180/445] time 0.083 (0.093) data 0.000 (0.007) loss 2.1119 (1.8549) ce_loss 1.2598 (0.9587) loss_zs_kd 1.3830 (1.6428) loss_oracle 0.4261 (0.4930) acc 59.3750 (65.6771) kd_loss 0.6391 (0.6497) lr 1.9511e-03 eta 0:30:01
epoch [7/50] batch [200/445] time 0.097 (0.092) data 0.000 (0.006) loss 2.0478 (1.8593) ce_loss 1.2100 (0.9626) loss_zs_kd 1.8545 (1.6410) loss_oracle 0.4634 (0.4946) acc 50.0000 (65.4844) kd_loss 0.6062 (0.6494) lr 1.9511e-03 eta 0:29:50
epoch [7/50] batch [220/445] time 0.088 (0.092) data 0.000 (0.006) loss 1.9175 (1.8653) ce_loss 1.0732 (0.9669) loss_zs_kd 1.4541 (1.6283) loss_oracle 0.5507 (0.4956) acc 65.6250 (65.3409) kd_loss 0.5689 (0.6506) lr 1.9511e-03 eta 0:29:35
epoch [7/50] batch [240/445] time 0.086 (0.091) data 0.000 (0.005) loss 2.1916 (1.8659) ce_loss 1.3359 (0.9692) loss_zs_kd 1.3237 (1.6240) loss_oracle 0.4389 (0.4950) acc 59.3750 (65.1172) kd_loss 0.6362 (0.6491) lr 1.9511e-03 eta 0:29:26
epoch [7/50] batch [260/445] time 0.081 (0.091) data 0.000 (0.005) loss 1.8159 (1.8652) ce_loss 0.9849 (0.9722) loss_zs_kd 1.5522 (1.6182) loss_oracle 0.4761 (0.4955) acc 62.5000 (65.0361) kd_loss 0.5930 (0.6453) lr 1.9511e-03 eta 0:29:12
epoch [7/50] batch [280/445] time 0.086 (0.090) data 0.001 (0.005) loss 2.1398 (1.8640) ce_loss 1.2529 (0.9738) loss_zs_kd 1.2692 (1.6146) loss_oracle 0.4555 (0.4935) acc 56.2500 (64.9665) kd_loss 0.6591 (0.6434) lr 1.9511e-03 eta 0:29:00
epoch [7/50] batch [300/445] time 0.099 (0.090) data 0.000 (0.004) loss 1.9706 (1.8625) ce_loss 1.0820 (0.9753) loss_zs_kd 1.8992 (1.6152) loss_oracle 0.5660 (0.4929) acc 59.3750 (64.9792) kd_loss 0.6056 (0.6407) lr 1.9511e-03 eta 0:28:52
epoch [7/50] batch [320/445] time 0.084 (0.090) data 0.000 (0.004) loss 1.2952 (1.8583) ce_loss 0.5259 (0.9761) loss_zs_kd 1.3626 (1.6093) loss_oracle 0.4951 (0.4918) acc 81.2500 (65.0098) kd_loss 0.5218 (0.6362) lr 1.9511e-03 eta 0:28:45
epoch [7/50] batch [340/445] time 0.086 (0.089) data 0.000 (0.004) loss 1.5914 (1.8546) ce_loss 0.7271 (0.9756) loss_zs_kd 1.3516 (1.6069) loss_oracle 0.5681 (0.4917) acc 75.0000 (65.0000) kd_loss 0.5803 (0.6332) lr 1.9511e-03 eta 0:28:38
epoch [7/50] batch [360/445] time 0.089 (0.089) data 0.000 (0.004) loss 1.9537 (1.8571) ce_loss 1.1689 (0.9804) loss_zs_kd 1.6832 (1.6044) loss_oracle 0.4913 (0.4935) acc 50.0000 (64.8438) kd_loss 0.5391 (0.6299) lr 1.9511e-03 eta 0:28:31
epoch [7/50] batch [380/445] time 0.090 (0.089) data 0.000 (0.003) loss 1.7203 (1.8511) ce_loss 0.9023 (0.9776) loss_zs_kd 1.5194 (1.6077) loss_oracle 0.4855 (0.4922) acc 68.7500 (64.9671) kd_loss 0.5752 (0.6274) lr 1.9511e-03 eta 0:28:26
epoch [7/50] batch [400/445] time 0.084 (0.089) data 0.000 (0.003) loss 1.9944 (1.8499) ce_loss 1.1631 (0.9785) loss_zs_kd 1.7405 (1.6070) loss_oracle 0.5794 (0.4915) acc 50.0000 (64.9609) kd_loss 0.5416 (0.6257) lr 1.9511e-03 eta 0:28:20
epoch [7/50] batch [420/445] time 0.079 (0.088) data 0.000 (0.003) loss 1.5160 (1.8494) ce_loss 0.8154 (0.9794) loss_zs_kd 1.6755 (1.6125) loss_oracle 0.3238 (0.4914) acc 71.8750 (64.9256) kd_loss 0.5386 (0.6243) lr 1.9511e-03 eta 0:28:12
epoch [7/50] batch [440/445] time 0.078 (0.088) data 0.000 (0.003) loss 1.9365 (1.8475) ce_loss 1.1426 (0.9798) loss_zs_kd 1.2197 (1.6168) loss_oracle 0.5190 (0.4919) acc 53.1250 (64.8153) kd_loss 0.5344 (0.6217) lr 1.9511e-03 eta 0:28:02
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,205
* accuracy: 68.8%
* error: 31.2%
* macro_f1: 55.3%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,017
* accuracy: 50.8%
* error: 49.2%
* macro_f1: 33.1%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      69.3%, epoch: 4 *******
******* Domain 3 best val test acc: 48.2%, epoch: 4 *******
******* Domain 3 best test acc:     50.8%, epoch: 7 *******
epoch [8/50] batch [20/445] time 0.081 (0.149) data 0.000 (0.070) loss 1.6614 (1.8010) ce_loss 0.8755 (0.9909) loss_zs_kd 1.7140 (1.6682) loss_oracle 0.4968 (0.4685) acc 68.7500 (63.5938) kd_loss 0.5375 (0.5759) lr 1.9298e-03 eta 0:47:32
epoch [8/50] batch [40/445] time 0.076 (0.114) data 0.000 (0.035) loss 1.4482 (1.7905) ce_loss 0.5474 (0.9569) loss_zs_kd 1.5443 (1.6265) loss_oracle 0.4928 (0.4846) acc 84.3750 (65.1562) kd_loss 0.6545 (0.5913) lr 1.9298e-03 eta 0:36:12
epoch [8/50] batch [60/445] time 0.088 (0.104) data 0.000 (0.024) loss 1.6986 (1.7824) ce_loss 0.9375 (0.9533) loss_zs_kd 1.4737 (1.6063) loss_oracle 0.4808 (0.4828) acc 65.6250 (65.6250) kd_loss 0.5207 (0.5877) lr 1.9298e-03 eta 0:33:01
epoch [8/50] batch [80/445] time 0.075 (0.098) data 0.000 (0.018) loss 1.9980 (1.7880) ce_loss 1.1631 (0.9605) loss_zs_kd 1.4914 (1.6091) loss_oracle 0.4697 (0.4825) acc 56.2500 (65.6250) kd_loss 0.6000 (0.5863) lr 1.9298e-03 eta 0:31:12
epoch [8/50] batch [100/445] time 0.082 (0.095) data 0.000 (0.014) loss 2.1230 (1.7844) ce_loss 1.2471 (0.9606) loss_zs_kd 1.3814 (1.5989) loss_oracle 0.5484 (0.4794) acc 59.3750 (65.5938) kd_loss 0.6017 (0.5841) lr 1.9298e-03 eta 0:30:10
epoch [8/50] batch [120/445] time 0.081 (0.094) data 0.000 (0.012) loss 1.8924 (1.7882) ce_loss 1.0762 (0.9640) loss_zs_kd 1.9040 (1.5976) loss_oracle 0.4706 (0.4798) acc 62.5000 (65.4948) kd_loss 0.5809 (0.5843) lr 1.9298e-03 eta 0:29:41
epoch [8/50] batch [140/445] time 0.080 (0.093) data 0.000 (0.010) loss 1.6744 (1.7884) ce_loss 0.9175 (0.9705) loss_zs_kd 1.7792 (1.6016) loss_oracle 0.3574 (0.4741) acc 68.7500 (65.3571) kd_loss 0.5782 (0.5809) lr 1.9298e-03 eta 0:29:19
epoch [8/50] batch [160/445] time 0.082 (0.091) data 0.001 (0.009) loss 1.6363 (1.7804) ce_loss 0.7896 (0.9633) loss_zs_kd 1.2336 (1.6099) loss_oracle 0.4164 (0.4727) acc 68.7500 (65.4883) kd_loss 0.6385 (0.5807) lr 1.9298e-03 eta 0:28:47
epoch [8/50] batch [180/445] time 0.080 (0.090) data 0.000 (0.008) loss 1.6817 (1.7769) ce_loss 0.9268 (0.9601) loss_zs_kd 1.4656 (1.6173) loss_oracle 0.5042 (0.4729) acc 65.6250 (65.5729) kd_loss 0.5029 (0.5803) lr 1.9298e-03 eta 0:28:19
epoch [8/50] batch [200/445] time 0.082 (0.088) data 0.000 (0.007) loss 1.8539 (1.7808) ce_loss 1.0381 (0.9648) loss_zs_kd 1.3822 (1.6337) loss_oracle 0.4252 (0.4737) acc 50.0000 (65.2656) kd_loss 0.6032 (0.5792) lr 1.9298e-03 eta 0:27:52
epoch [8/50] batch [220/445] time 0.080 (0.087) data 0.000 (0.007) loss 1.7306 (1.7842) ce_loss 0.8320 (0.9670) loss_zs_kd 1.5910 (1.6358) loss_oracle 0.5432 (0.4769) acc 65.6250 (65.1847) kd_loss 0.6270 (0.5788) lr 1.9298e-03 eta 0:27:33
epoch [8/50] batch [240/445] time 0.076 (0.087) data 0.000 (0.006) loss 1.8445 (1.7860) ce_loss 1.0713 (0.9690) loss_zs_kd 1.3169 (1.6416) loss_oracle 0.4781 (0.4786) acc 62.5000 (65.2865) kd_loss 0.5341 (0.5776) lr 1.9298e-03 eta 0:27:22
epoch [8/50] batch [260/445] time 0.086 (0.087) data 0.000 (0.006) loss 1.8675 (1.7856) ce_loss 0.9785 (0.9663) loss_zs_kd 1.5618 (1.6397) loss_oracle 0.5928 (0.4828) acc 59.3750 (65.3846) kd_loss 0.5926 (0.5779) lr 1.9298e-03 eta 0:27:18
epoch [8/50] batch [280/445] time 0.080 (0.087) data 0.000 (0.005) loss 1.3731 (1.7840) ce_loss 0.5269 (0.9641) loss_zs_kd 1.6688 (1.6439) loss_oracle 0.4532 (0.4833) acc 81.2500 (65.3348) kd_loss 0.6197 (0.5783) lr 1.9298e-03 eta 0:27:19
epoch [8/50] batch [300/445] time 0.079 (0.087) data 0.000 (0.005) loss 1.5190 (1.7843) ce_loss 0.7437 (0.9630) loss_zs_kd 2.0155 (1.6419) loss_oracle 0.3841 (0.4832) acc 81.2500 (65.2812) kd_loss 0.5833 (0.5797) lr 1.9298e-03 eta 0:27:11
epoch [8/50] batch [320/445] time 0.075 (0.086) data 0.000 (0.005) loss 1.7466 (1.7836) ce_loss 1.0020 (0.9618) loss_zs_kd 1.6392 (1.6476) loss_oracle 0.4276 (0.4819) acc 71.8750 (65.4492) kd_loss 0.5309 (0.5809) lr 1.9298e-03 eta 0:27:03
epoch [8/50] batch [340/445] time 0.096 (0.086) data 0.000 (0.004) loss 1.6969 (1.7839) ce_loss 0.8203 (0.9611) loss_zs_kd 1.4757 (1.6482) loss_oracle 0.4514 (0.4810) acc 68.7500 (65.4596) kd_loss 0.6509 (0.5823) lr 1.9298e-03 eta 0:26:49
epoch [8/50] batch [360/445] time 0.077 (0.086) data 0.000 (0.004) loss 1.6532 (1.7853) ce_loss 0.9370 (0.9610) loss_zs_kd 1.7760 (1.6502) loss_oracle 0.3413 (0.4810) acc 68.7500 (65.4861) kd_loss 0.5455 (0.5838) lr 1.9298e-03 eta 0:26:47
epoch [8/50] batch [380/445] time 0.088 (0.086) data 0.000 (0.004) loss 1.7450 (1.7841) ce_loss 0.9263 (0.9597) loss_zs_kd 1.5782 (1.6508) loss_oracle 0.4935 (0.4807) acc 65.6250 (65.6003) kd_loss 0.5720 (0.5841) lr 1.9298e-03 eta 0:26:46
epoch [8/50] batch [400/445] time 0.079 (0.086) data 0.000 (0.004) loss 1.4330 (1.7805) ce_loss 0.5986 (0.9567) loss_zs_kd 1.9466 (1.6526) loss_oracle 0.4930 (0.4794) acc 78.1250 (65.5781) kd_loss 0.5879 (0.5841) lr 1.9298e-03 eta 0:26:42
epoch [8/50] batch [420/445] time 0.075 (0.085) data 0.000 (0.004) loss 1.8174 (1.7797) ce_loss 0.9766 (0.9564) loss_zs_kd 1.9959 (1.6605) loss_oracle 0.4860 (0.4775) acc 56.2500 (65.5952) kd_loss 0.5978 (0.5846) lr 1.9298e-03 eta 0:26:33
epoch [8/50] batch [440/445] time 0.067 (0.085) data 0.000 (0.003) loss 1.8614 (1.7833) ce_loss 0.8062 (0.9586) loss_zs_kd 1.6667 (1.6607) loss_oracle 0.5938 (0.4781) acc 71.8750 (65.4616) kd_loss 0.7583 (0.5856) lr 1.9298e-03 eta 0:26:20
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,134
* accuracy: 67.7%
* error: 32.3%
* macro_f1: 56.6%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,752
* accuracy: 44.1%
* error: 55.9%
* macro_f1: 29.6%
******* Domain 3 best val acc:      69.3%, epoch: 4 *******
******* Domain 3 best val test acc: 48.2%, epoch: 4 *******
******* Domain 3 best test acc:     50.8%, epoch: 7 *******
epoch [9/50] batch [20/445] time 0.084 (0.169) data 0.000 (0.081) loss 1.9741 (1.8690) ce_loss 1.0049 (0.9977) loss_zs_kd 1.5803 (1.6833) loss_oracle 0.4430 (0.5069) acc 56.2500 (65.3125) kd_loss 0.7478 (0.6179) lr 1.9048e-03 eta 0:52:43
epoch [9/50] batch [40/445] time 0.091 (0.126) data 0.000 (0.041) loss 1.8040 (1.8270) ce_loss 0.9951 (0.9636) loss_zs_kd 1.4107 (1.6061) loss_oracle 0.4477 (0.4944) acc 71.8750 (66.5625) kd_loss 0.5850 (0.6163) lr 1.9048e-03 eta 0:39:06
epoch [9/50] batch [60/445] time 0.081 (0.113) data 0.000 (0.027) loss 1.7686 (1.8245) ce_loss 0.8789 (0.9686) loss_zs_kd 1.8265 (1.6091) loss_oracle 0.6371 (0.4965) acc 65.6250 (66.0417) kd_loss 0.5711 (0.6077) lr 1.9048e-03 eta 0:35:12
epoch [9/50] batch [80/445] time 0.081 (0.106) data 0.000 (0.020) loss 2.0565 (1.8536) ce_loss 1.1514 (0.9917) loss_zs_kd 1.9520 (1.6138) loss_oracle 0.5983 (0.4985) acc 59.3750 (64.8047) kd_loss 0.6060 (0.6126) lr 1.9048e-03 eta 0:32:52
epoch [9/50] batch [100/445] time 0.084 (0.102) data 0.000 (0.016) loss 1.8213 (1.8520) ce_loss 0.8882 (0.9872) loss_zs_kd 1.4385 (1.6022) loss_oracle 0.5249 (0.4983) acc 68.7500 (64.9688) kd_loss 0.6706 (0.6156) lr 1.9048e-03 eta 0:31:31
epoch [9/50] batch [120/445] time 0.083 (0.099) data 0.000 (0.014) loss 1.8908 (1.8423) ce_loss 1.0371 (0.9744) loss_zs_kd 1.7206 (1.6214) loss_oracle 0.5091 (0.4988) acc 50.0000 (65.3646) kd_loss 0.5992 (0.6184) lr 1.9048e-03 eta 0:30:36
epoch [9/50] batch [140/445] time 0.084 (0.097) data 0.000 (0.012) loss 1.8067 (1.8367) ce_loss 0.9424 (0.9667) loss_zs_kd 1.7727 (1.6272) loss_oracle 0.4740 (0.5017) acc 68.7500 (65.6473) kd_loss 0.6273 (0.6192) lr 1.9048e-03 eta 0:29:59
epoch [9/50] batch [160/445] time 0.093 (0.096) data 0.000 (0.010) loss 1.8364 (1.8351) ce_loss 1.0801 (0.9641) loss_zs_kd 1.6179 (1.6278) loss_oracle 0.4925 (0.5001) acc 59.3750 (65.6445) kd_loss 0.5101 (0.6210) lr 1.9048e-03 eta 0:29:35
epoch [9/50] batch [180/445] time 0.080 (0.094) data 0.000 (0.009) loss 1.6886 (1.8336) ce_loss 0.8037 (0.9614) loss_zs_kd 2.1230 (1.6282) loss_oracle 0.5857 (0.5002) acc 65.6250 (65.7118) kd_loss 0.5920 (0.6220) lr 1.9048e-03 eta 0:29:08
epoch [9/50] batch [200/445] time 0.077 (0.093) data 0.000 (0.008) loss 1.5414 (1.8299) ce_loss 0.7231 (0.9588) loss_zs_kd 1.7032 (1.6338) loss_oracle 0.4599 (0.4986) acc 84.3750 (65.7500) kd_loss 0.5883 (0.6218) lr 1.9048e-03 eta 0:28:42
epoch [9/50] batch [220/445] time 0.082 (0.092) data 0.000 (0.008) loss 1.6467 (1.8273) ce_loss 0.8765 (0.9580) loss_zs_kd 1.6543 (1.6370) loss_oracle 0.4605 (0.4989) acc 68.7500 (65.8097) kd_loss 0.5399 (0.6198) lr 1.9048e-03 eta 0:28:19
epoch [9/50] batch [240/445] time 0.083 (0.091) data 0.000 (0.007) loss 1.9510 (1.8309) ce_loss 1.1416 (0.9653) loss_zs_kd 1.8734 (1.6447) loss_oracle 0.5034 (0.4987) acc 62.5000 (65.5599) kd_loss 0.5577 (0.6162) lr 1.9048e-03 eta 0:28:04
epoch [9/50] batch [260/445] time 0.082 (0.091) data 0.000 (0.006) loss 1.9625 (1.8275) ce_loss 1.0576 (0.9653) loss_zs_kd 1.7188 (1.6513) loss_oracle 0.5676 (0.5003) acc 78.1250 (65.8173) kd_loss 0.6211 (0.6121) lr 1.9048e-03 eta 0:27:53
epoch [9/50] batch [280/445] time 0.079 (0.090) data 0.000 (0.006) loss 1.6136 (1.8193) ce_loss 0.7954 (0.9608) loss_zs_kd 1.3024 (1.6577) loss_oracle 0.4864 (0.4996) acc 65.6250 (65.9933) kd_loss 0.5749 (0.6088) lr 1.9048e-03 eta 0:27:41
epoch [9/50] batch [300/445] time 0.085 (0.090) data 0.000 (0.006) loss 1.9311 (1.8141) ce_loss 1.1133 (0.9595) loss_zs_kd 1.7611 (1.6614) loss_oracle 0.4815 (0.4981) acc 56.2500 (65.9062) kd_loss 0.5770 (0.6055) lr 1.9048e-03 eta 0:27:30
epoch [9/50] batch [320/445] time 0.079 (0.089) data 0.000 (0.005) loss 1.8068 (1.8123) ce_loss 0.9409 (0.9590) loss_zs_kd 1.4692 (1.6725) loss_oracle 0.5941 (0.4982) acc 65.6250 (65.9961) kd_loss 0.5688 (0.6042) lr 1.9048e-03 eta 0:27:19
epoch [9/50] batch [340/445] time 0.085 (0.089) data 0.000 (0.005) loss 1.6222 (1.8081) ce_loss 0.7681 (0.9560) loss_zs_kd 2.0259 (1.6818) loss_oracle 0.4992 (0.4985) acc 68.7500 (66.1029) kd_loss 0.6045 (0.6028) lr 1.9048e-03 eta 0:27:12
epoch [9/50] batch [360/445] time 0.086 (0.089) data 0.000 (0.005) loss 1.8910 (1.8058) ce_loss 1.1406 (0.9550) loss_zs_kd 1.7177 (1.6884) loss_oracle 0.4076 (0.4978) acc 71.8750 (66.1545) kd_loss 0.5466 (0.6018) lr 1.9048e-03 eta 0:27:05
epoch [9/50] batch [380/445] time 0.078 (0.088) data 0.000 (0.005) loss 1.7107 (1.8032) ce_loss 0.9214 (0.9541) loss_zs_kd 2.4240 (1.6923) loss_oracle 0.4538 (0.4978) acc 68.7500 (66.1595) kd_loss 0.5624 (0.6002) lr 1.9048e-03 eta 0:26:55
epoch [9/50] batch [400/445] time 0.086 (0.088) data 0.000 (0.004) loss 2.0141 (1.8022) ce_loss 1.1006 (0.9535) loss_zs_kd 1.6046 (1.6919) loss_oracle 0.5142 (0.4978) acc 62.5000 (66.1406) kd_loss 0.6564 (0.5998) lr 1.9048e-03 eta 0:26:49
epoch [9/50] batch [420/445] time 0.081 (0.088) data 0.000 (0.004) loss 1.8224 (1.8029) ce_loss 0.9653 (0.9554) loss_zs_kd 1.7138 (1.6900) loss_oracle 0.5026 (0.4977) acc 65.6250 (66.1086) kd_loss 0.6058 (0.5986) lr 1.9048e-03 eta 0:26:43
epoch [9/50] batch [440/445] time 0.076 (0.088) data 0.000 (0.004) loss 1.5927 (1.8008) ce_loss 0.7920 (0.9539) loss_zs_kd 2.0721 (1.6969) loss_oracle 0.4607 (0.4984) acc 75.0000 (66.1577) kd_loss 0.5704 (0.5977) lr 1.9048e-03 eta 0:26:37
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,190
* accuracy: 68.6%
* error: 31.4%
* macro_f1: 56.7%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,069
* accuracy: 52.1%
* error: 47.9%
* macro_f1: 31.6%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      69.3%, epoch: 4 *******
******* Domain 3 best val test acc: 48.2%, epoch: 4 *******
******* Domain 3 best test acc:     52.1%, epoch: 9 *******
epoch [10/50] batch [20/445] time 0.086 (0.165) data 0.000 (0.076) loss 1.6251 (1.7125) ce_loss 0.7588 (0.8756) loss_zs_kd 1.5442 (1.7777) loss_oracle 0.4773 (0.4768) acc 68.7500 (68.9062) kd_loss 0.6276 (0.5985) lr 1.8763e-03 eta 0:50:02
epoch [10/50] batch [40/445] time 0.084 (0.124) data 0.000 (0.038) loss 1.7733 (1.7525) ce_loss 0.9448 (0.9121) loss_zs_kd 1.8605 (1.7845) loss_oracle 0.4537 (0.4813) acc 68.7500 (68.7500) kd_loss 0.6016 (0.5998) lr 1.8763e-03 eta 0:37:42
epoch [10/50] batch [60/445] time 0.091 (0.111) data 0.000 (0.025) loss 1.5583 (1.7893) ce_loss 0.7568 (0.9440) loss_zs_kd 1.2133 (1.7371) loss_oracle 0.4632 (0.4915) acc 78.1250 (67.6042) kd_loss 0.5699 (0.5995) lr 1.8763e-03 eta 0:33:36
epoch [10/50] batch [80/445] time 0.083 (0.104) data 0.000 (0.019) loss 2.1790 (1.7955) ce_loss 1.3438 (0.9566) loss_zs_kd 1.7462 (1.7472) loss_oracle 0.5974 (0.4917) acc 50.0000 (66.6406) kd_loss 0.5365 (0.5930) lr 1.8763e-03 eta 0:31:30
epoch [10/50] batch [100/445] time 0.075 (0.100) data 0.000 (0.015) loss 1.4508 (1.7867) ce_loss 0.6196 (0.9452) loss_zs_kd 1.7399 (1.7721) loss_oracle 0.5409 (0.5005) acc 84.3750 (66.9062) kd_loss 0.5608 (0.5912) lr 1.8763e-03 eta 0:30:21
epoch [10/50] batch [120/445] time 0.079 (0.098) data 0.000 (0.013) loss 1.7587 (1.7995) ce_loss 0.8955 (0.9541) loss_zs_kd 1.7329 (1.7732) loss_oracle 0.5373 (0.5068) acc 68.7500 (66.1719) kd_loss 0.5945 (0.5920) lr 1.8763e-03 eta 0:29:41
epoch [10/50] batch [140/445] time 0.081 (0.096) data 0.000 (0.011) loss 1.7642 (1.7973) ce_loss 0.8354 (0.9543) loss_zs_kd 2.0872 (1.7720) loss_oracle 0.5800 (0.5024) acc 65.6250 (65.9821) kd_loss 0.6387 (0.5918) lr 1.8763e-03 eta 0:29:00
epoch [10/50] batch [160/445] time 0.085 (0.095) data 0.000 (0.010) loss 1.7571 (1.7944) ce_loss 0.8706 (0.9530) loss_zs_kd 2.0279 (1.7582) loss_oracle 0.5648 (0.5025) acc 75.0000 (66.3672) kd_loss 0.6040 (0.5901) lr 1.8763e-03 eta 0:28:33
epoch [10/50] batch [180/445] time 0.076 (0.093) data 0.000 (0.009) loss 2.4636 (1.8024) ce_loss 1.6650 (0.9613) loss_zs_kd 1.2986 (1.7469) loss_oracle 0.4561 (0.5030) acc 56.2500 (66.0764) kd_loss 0.5705 (0.5897) lr 1.8763e-03 eta 0:28:00
epoch [10/50] batch [200/445] time 0.070 (0.092) data 0.000 (0.008) loss 1.7360 (1.7966) ce_loss 0.8872 (0.9552) loss_zs_kd 1.7867 (1.7427) loss_oracle 0.5384 (0.5037) acc 59.3750 (66.3281) kd_loss 0.5795 (0.5896) lr 1.8763e-03 eta 0:27:33
epoch [10/50] batch [220/445] time 0.085 (0.091) data 0.000 (0.007) loss 1.5249 (1.7998) ce_loss 0.7583 (0.9583) loss_zs_kd 1.9180 (1.7394) loss_oracle 0.4729 (0.5061) acc 56.2500 (65.8807) kd_loss 0.5301 (0.5885) lr 1.8763e-03 eta 0:27:18
epoch [10/50] batch [240/445] time 0.082 (0.090) data 0.000 (0.007) loss 1.8353 (1.8012) ce_loss 0.9473 (0.9586) loss_zs_kd 1.7568 (1.7321) loss_oracle 0.5932 (0.5097) acc 71.8750 (65.8724) kd_loss 0.5914 (0.5878) lr 1.8763e-03 eta 0:27:04
epoch [10/50] batch [260/445] time 0.090 (0.090) data 0.000 (0.006) loss 1.7182 (1.7950) ce_loss 0.8574 (0.9542) loss_zs_kd 1.5406 (1.7369) loss_oracle 0.5027 (0.5110) acc 68.7500 (66.0096) kd_loss 0.6095 (0.5853) lr 1.8763e-03 eta 0:26:53
epoch [10/50] batch [280/445] time 0.082 (0.089) data 0.000 (0.006) loss 2.0552 (1.7903) ce_loss 1.2070 (0.9534) loss_zs_kd 1.8859 (1.7360) loss_oracle 0.4999 (0.5074) acc 56.2500 (66.0714) kd_loss 0.5982 (0.5832) lr 1.8763e-03 eta 0:26:44
epoch [10/50] batch [300/445] time 0.081 (0.089) data 0.000 (0.005) loss 1.6621 (1.7830) ce_loss 0.8604 (0.9468) loss_zs_kd 1.8207 (1.7363) loss_oracle 0.4799 (0.5072) acc 65.6250 (66.1875) kd_loss 0.5618 (0.5826) lr 1.8763e-03 eta 0:26:36
epoch [10/50] batch [320/445] time 0.083 (0.089) data 0.000 (0.005) loss 1.6059 (1.7799) ce_loss 0.6675 (0.9455) loss_zs_kd 1.8112 (1.7378) loss_oracle 0.6214 (0.5061) acc 78.1250 (66.2402) kd_loss 0.6278 (0.5813) lr 1.8763e-03 eta 0:26:28
epoch [10/50] batch [340/445] time 0.084 (0.088) data 0.000 (0.005) loss 1.5070 (1.7855) ce_loss 0.6738 (0.9503) loss_zs_kd 1.8994 (1.7450) loss_oracle 0.4776 (0.5060) acc 75.0000 (66.1305) kd_loss 0.5943 (0.5823) lr 1.8763e-03 eta 0:26:21
epoch [10/50] batch [360/445] time 0.085 (0.088) data 0.000 (0.004) loss 1.6550 (1.7856) ce_loss 0.7949 (0.9510) loss_zs_kd 1.3830 (1.7451) loss_oracle 0.5028 (0.5055) acc 65.6250 (66.0938) kd_loss 0.6087 (0.5819) lr 1.8763e-03 eta 0:26:13
epoch [10/50] batch [380/445] time 0.077 (0.088) data 0.000 (0.004) loss 1.6293 (1.7845) ce_loss 0.7969 (0.9504) loss_zs_kd 1.9740 (1.7429) loss_oracle 0.5065 (0.5037) acc 68.7500 (66.0526) kd_loss 0.5792 (0.5822) lr 1.8763e-03 eta 0:26:05
epoch [10/50] batch [400/445] time 0.075 (0.087) data 0.000 (0.004) loss 1.7921 (1.7828) ce_loss 0.9287 (0.9494) loss_zs_kd 1.5740 (1.7408) loss_oracle 0.4619 (0.5034) acc 59.3750 (66.0469) kd_loss 0.6324 (0.5817) lr 1.8763e-03 eta 0:25:59
epoch [10/50] batch [420/445] time 0.083 (0.087) data 0.000 (0.004) loss 1.7682 (1.7814) ce_loss 0.9551 (0.9481) loss_zs_kd 2.1634 (1.7435) loss_oracle 0.5615 (0.5032) acc 59.3750 (66.0565) kd_loss 0.5323 (0.5817) lr 1.8763e-03 eta 0:25:48
epoch [10/50] batch [440/445] time 0.084 (0.087) data 0.000 (0.004) loss 1.8005 (1.7846) ce_loss 0.9653 (0.9504) loss_zs_kd 1.8424 (1.7436) loss_oracle 0.5068 (0.5036) acc 68.7500 (65.9872) kd_loss 0.5817 (0.5824) lr 1.8763e-03 eta 0:25:44
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,244
* accuracy: 69.5%
* error: 30.5%
* macro_f1: 57.1%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,022
* accuracy: 50.9%
* error: 49.1%
* macro_f1: 33.3%
******* Domain 3 best val acc:      69.5%, epoch: 10 *******
******* Domain 3 best val test acc: 50.9%, epoch: 10 *******
******* Domain 3 best test acc:     52.1%, epoch: 9 *******
epoch [11/50] batch [20/445] time 0.076 (0.150) data 0.000 (0.070) loss 1.7861 (1.7926) ce_loss 0.9482 (0.9675) loss_zs_kd 1.8283 (1.7016) loss_oracle 0.4405 (0.4847) acc 65.6250 (63.9062) kd_loss 0.6176 (0.5828) lr 1.8443e-03 eta 0:44:26
epoch [11/50] batch [40/445] time 0.085 (0.116) data 0.000 (0.035) loss 2.2482 (1.7822) ce_loss 1.3936 (0.9528) loss_zs_kd 1.7118 (1.7651) loss_oracle 0.4804 (0.4914) acc 56.2500 (66.4062) kd_loss 0.6144 (0.5837) lr 1.8443e-03 eta 0:34:15
epoch [11/50] batch [60/445] time 0.087 (0.105) data 0.001 (0.023) loss 1.7456 (1.7878) ce_loss 0.8555 (0.9569) loss_zs_kd 1.9474 (1.7651) loss_oracle 0.5132 (0.4932) acc 62.5000 (65.9896) kd_loss 0.6335 (0.5843) lr 1.8443e-03 eta 0:30:58
epoch [11/50] batch [80/445] time 0.080 (0.100) data 0.000 (0.018) loss 1.8139 (1.7875) ce_loss 0.8901 (0.9467) loss_zs_kd 1.8006 (1.7447) loss_oracle 0.5119 (0.4976) acc 68.7500 (66.2109) kd_loss 0.6678 (0.5920) lr 1.8443e-03 eta 0:29:25
epoch [11/50] batch [100/445] time 0.083 (0.097) data 0.000 (0.014) loss 1.4803 (1.7850) ce_loss 0.6636 (0.9392) loss_zs_kd 1.5366 (1.7494) loss_oracle 0.4475 (0.4968) acc 71.8750 (66.7500) kd_loss 0.5929 (0.5975) lr 1.8443e-03 eta 0:28:38
epoch [11/50] batch [120/445] time 0.084 (0.095) data 0.000 (0.012) loss 1.9431 (1.7929) ce_loss 1.1230 (0.9402) loss_zs_kd 1.8655 (1.7722) loss_oracle 0.5013 (0.4976) acc 50.0000 (66.6146) kd_loss 0.5694 (0.6039) lr 1.8443e-03 eta 0:27:57
epoch [11/50] batch [140/445] time 0.084 (0.093) data 0.000 (0.010) loss 1.7210 (1.7937) ce_loss 0.8843 (0.9377) loss_zs_kd 1.6124 (1.7699) loss_oracle 0.4519 (0.4957) acc 65.6250 (66.7411) kd_loss 0.6108 (0.6082) lr 1.8443e-03 eta 0:27:25
epoch [11/50] batch [160/445] time 0.077 (0.092) data 0.000 (0.009) loss 1.7983 (1.7999) ce_loss 0.8472 (0.9418) loss_zs_kd 1.8670 (1.7751) loss_oracle 0.5956 (0.4988) acc 71.8750 (66.3672) kd_loss 0.6533 (0.6087) lr 1.8443e-03 eta 0:26:55
epoch [11/50] batch [180/445] time 0.084 (0.090) data 0.000 (0.008) loss 1.8331 (1.8005) ce_loss 0.9307 (0.9432) loss_zs_kd 1.9291 (1.7887) loss_oracle 0.5225 (0.4952) acc 56.2500 (66.1111) kd_loss 0.6412 (0.6097) lr 1.8443e-03 eta 0:26:34
epoch [11/50] batch [200/445] time 0.075 (0.090) data 0.000 (0.007) loss 1.8493 (1.7994) ce_loss 1.0049 (0.9430) loss_zs_kd 2.0396 (1.7976) loss_oracle 0.4336 (0.4913) acc 62.5000 (66.1875) kd_loss 0.6276 (0.6108) lr 1.8443e-03 eta 0:26:21
epoch [11/50] batch [220/445] time 0.083 (0.089) data 0.000 (0.007) loss 1.6990 (1.7928) ce_loss 0.6641 (0.9382) loss_zs_kd 1.8922 (1.8040) loss_oracle 0.6010 (0.4888) acc 81.2500 (66.3352) kd_loss 0.7344 (0.6102) lr 1.8443e-03 eta 0:26:05
epoch [11/50] batch [240/445] time 0.080 (0.088) data 0.000 (0.006) loss 1.4633 (1.7962) ce_loss 0.6553 (0.9432) loss_zs_kd 1.4682 (1.7946) loss_oracle 0.4128 (0.4865) acc 75.0000 (66.2500) kd_loss 0.6016 (0.6097) lr 1.8443e-03 eta 0:25:52
epoch [11/50] batch [260/445] time 0.082 (0.088) data 0.001 (0.006) loss 1.5625 (1.7998) ce_loss 0.7573 (0.9472) loss_zs_kd 1.8881 (1.7907) loss_oracle 0.4578 (0.4862) acc 62.5000 (66.2620) kd_loss 0.5763 (0.6096) lr 1.8443e-03 eta 0:25:40
epoch [11/50] batch [280/445] time 0.081 (0.087) data 0.000 (0.005) loss 1.8608 (1.7986) ce_loss 1.1318 (0.9497) loss_zs_kd 1.7709 (1.7747) loss_oracle 0.4027 (0.4829) acc 50.0000 (66.1161) kd_loss 0.5276 (0.6074) lr 1.8443e-03 eta 0:25:31
epoch [11/50] batch [300/445] time 0.076 (0.087) data 0.000 (0.005) loss 1.8002 (1.7959) ce_loss 0.9170 (0.9480) loss_zs_kd 1.8066 (1.7644) loss_oracle 0.5679 (0.4826) acc 71.8750 (66.3125) kd_loss 0.5993 (0.6067) lr 1.8443e-03 eta 0:25:24
epoch [11/50] batch [320/445] time 0.084 (0.087) data 0.000 (0.005) loss 1.6831 (1.7945) ce_loss 0.9258 (0.9478) loss_zs_kd 1.7809 (1.7609) loss_oracle 0.4754 (0.4822) acc 68.7500 (66.2891) kd_loss 0.5196 (0.6056) lr 1.8443e-03 eta 0:25:16
epoch [11/50] batch [340/445] time 0.077 (0.086) data 0.000 (0.004) loss 1.8612 (1.7951) ce_loss 1.0713 (0.9496) loss_zs_kd 1.5444 (1.7685) loss_oracle 0.4149 (0.4825) acc 56.2500 (66.0846) kd_loss 0.5824 (0.6043) lr 1.8443e-03 eta 0:25:09
epoch [11/50] batch [360/445] time 0.081 (0.086) data 0.000 (0.004) loss 1.7759 (1.7925) ce_loss 0.9585 (0.9476) loss_zs_kd 2.1714 (1.7700) loss_oracle 0.4480 (0.4835) acc 62.5000 (66.1458) kd_loss 0.5934 (0.6031) lr 1.8443e-03 eta 0:25:03
epoch [11/50] batch [380/445] time 0.077 (0.086) data 0.000 (0.004) loss 1.8172 (1.7906) ce_loss 0.9404 (0.9478) loss_zs_kd 1.4929 (1.7686) loss_oracle 0.4913 (0.4824) acc 71.8750 (66.0691) kd_loss 0.6312 (0.6016) lr 1.8443e-03 eta 0:25:01
epoch [11/50] batch [400/445] time 0.077 (0.086) data 0.000 (0.004) loss 2.1432 (1.7872) ce_loss 1.3662 (0.9462) loss_zs_kd 1.6205 (1.7658) loss_oracle 0.3989 (0.4820) acc 68.7500 (66.2188) kd_loss 0.5776 (0.6000) lr 1.8443e-03 eta 0:24:58
epoch [11/50] batch [420/445] time 0.083 (0.086) data 0.000 (0.004) loss 1.6792 (1.7848) ce_loss 0.9229 (0.9455) loss_zs_kd 1.6296 (1.7707) loss_oracle 0.4471 (0.4809) acc 78.1250 (66.2946) kd_loss 0.5329 (0.5988) lr 1.8443e-03 eta 0:24:56
epoch [11/50] batch [440/445] time 0.079 (0.086) data 0.000 (0.003) loss 1.5339 (1.7805) ce_loss 0.7578 (0.9431) loss_zs_kd 1.7567 (1.7748) loss_oracle 0.4769 (0.4806) acc 65.6250 (66.4062) kd_loss 0.5377 (0.5971) lr 1.8443e-03 eta 0:24:52
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,198
* accuracy: 68.7%
* error: 31.3%
* macro_f1: 57.9%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,000
* accuracy: 50.4%
* error: 49.6%
* macro_f1: 34.8%
******* Domain 3 best val acc:      69.5%, epoch: 10 *******
******* Domain 3 best val test acc: 50.9%, epoch: 10 *******
******* Domain 3 best test acc:     52.1%, epoch: 9 *******
epoch [12/50] batch [20/445] time 0.078 (0.161) data 0.000 (0.084) loss 2.0953 (1.8289) ce_loss 1.1475 (1.0051) loss_zs_kd 1.8127 (1.8369) loss_oracle 0.5575 (0.5029) acc 53.1250 (63.5938) kd_loss 0.6690 (0.5724) lr 1.8090e-03 eta 0:46:23
epoch [12/50] batch [40/445] time 0.076 (0.118) data 0.000 (0.042) loss 1.6815 (1.8203) ce_loss 0.9077 (0.9968) loss_zs_kd 1.5868 (1.8426) loss_oracle 0.4358 (0.5045) acc 75.0000 (64.6875) kd_loss 0.5559 (0.5713) lr 1.8090e-03 eta 0:34:10
epoch [12/50] batch [60/445] time 0.083 (0.106) data 0.000 (0.028) loss 1.6163 (1.7996) ce_loss 0.8062 (0.9761) loss_zs_kd 1.7197 (1.8187) loss_oracle 0.4529 (0.5016) acc 65.6250 (65.5729) kd_loss 0.5837 (0.5727) lr 1.8090e-03 eta 0:30:34
epoch [12/50] batch [80/445] time 0.088 (0.101) data 0.000 (0.021) loss 1.5916 (1.7861) ce_loss 0.7827 (0.9678) loss_zs_kd 1.4147 (1.8082) loss_oracle 0.4888 (0.5016) acc 68.7500 (65.3906) kd_loss 0.5645 (0.5674) lr 1.8090e-03 eta 0:29:04
epoch [12/50] batch [100/445] time 0.086 (0.098) data 0.000 (0.017) loss 1.9213 (1.7787) ce_loss 1.1904 (0.9646) loss_zs_kd 1.9371 (1.8217) loss_oracle 0.4749 (0.4975) acc 59.3750 (65.7812) kd_loss 0.4934 (0.5653) lr 1.8090e-03 eta 0:28:09
epoch [12/50] batch [120/445] time 0.081 (0.096) data 0.000 (0.014) loss 1.8443 (1.7739) ce_loss 1.1221 (0.9626) loss_zs_kd 1.8813 (1.8178) loss_oracle 0.4225 (0.4949) acc 56.2500 (65.5729) kd_loss 0.5110 (0.5639) lr 1.8090e-03 eta 0:27:30
epoch [12/50] batch [140/445] time 0.084 (0.094) data 0.000 (0.012) loss 1.6650 (1.7735) ce_loss 0.8545 (0.9625) loss_zs_kd 2.0500 (1.8208) loss_oracle 0.4566 (0.4960) acc 68.7500 (65.3125) kd_loss 0.5822 (0.5630) lr 1.8090e-03 eta 0:27:00
epoch [12/50] batch [160/445] time 0.084 (0.093) data 0.000 (0.011) loss 1.7668 (1.7649) ce_loss 0.9346 (0.9530) loss_zs_kd 2.2457 (1.8207) loss_oracle 0.4981 (0.4999) acc 62.5000 (65.6641) kd_loss 0.5832 (0.5620) lr 1.8090e-03 eta 0:26:38
epoch [12/50] batch [180/445] time 0.079 (0.092) data 0.000 (0.010) loss 1.7322 (1.7636) ce_loss 0.9224 (0.9515) loss_zs_kd 1.8569 (1.8203) loss_oracle 0.4761 (0.4991) acc 68.7500 (65.7292) kd_loss 0.5718 (0.5626) lr 1.8090e-03 eta 0:26:22
epoch [12/50] batch [200/445] time 0.082 (0.093) data 0.000 (0.009) loss 1.3952 (1.7625) ce_loss 0.5811 (0.9488) loss_zs_kd 1.6572 (1.8062) loss_oracle 0.4729 (0.5000) acc 75.0000 (65.8438) kd_loss 0.5777 (0.5637) lr 1.8090e-03 eta 0:26:27
epoch [12/50] batch [220/445] time 0.081 (0.092) data 0.000 (0.008) loss 1.6732 (1.7590) ce_loss 0.9229 (0.9463) loss_zs_kd 1.3996 (1.8066) loss_oracle 0.4702 (0.4987) acc 78.1250 (66.0085) kd_loss 0.5152 (0.5634) lr 1.8090e-03 eta 0:26:12
epoch [12/50] batch [240/445] time 0.081 (0.091) data 0.000 (0.007) loss 1.8201 (1.7581) ce_loss 1.0371 (0.9467) loss_zs_kd 1.9821 (1.8090) loss_oracle 0.4331 (0.4969) acc 62.5000 (65.9115) kd_loss 0.5664 (0.5630) lr 1.8090e-03 eta 0:26:00
epoch [12/50] batch [260/445] time 0.088 (0.091) data 0.000 (0.007) loss 1.8656 (1.7592) ce_loss 1.0430 (0.9457) loss_zs_kd 1.4549 (1.8023) loss_oracle 0.5400 (0.4968) acc 68.7500 (65.8654) kd_loss 0.5526 (0.5651) lr 1.8090e-03 eta 0:25:53
epoch [12/50] batch [280/445] time 0.088 (0.090) data 0.000 (0.006) loss 1.8206 (1.7554) ce_loss 0.9463 (0.9412) loss_zs_kd 1.5977 (1.7915) loss_oracle 0.5224 (0.4949) acc 71.8750 (66.1272) kd_loss 0.6131 (0.5667) lr 1.8090e-03 eta 0:25:43
epoch [12/50] batch [300/445] time 0.083 (0.090) data 0.000 (0.006) loss 1.9682 (1.7551) ce_loss 1.0166 (0.9400) loss_zs_kd 1.6068 (1.7937) loss_oracle 0.5195 (0.4960) acc 56.2500 (66.2188) kd_loss 0.6919 (0.5672) lr 1.8090e-03 eta 0:25:34
epoch [12/50] batch [320/445] time 0.083 (0.090) data 0.000 (0.006) loss 1.5712 (1.7544) ce_loss 0.7588 (0.9403) loss_zs_kd 2.1924 (1.7935) loss_oracle 0.4496 (0.4937) acc 75.0000 (66.1230) kd_loss 0.5876 (0.5672) lr 1.8090e-03 eta 0:25:26
epoch [12/50] batch [340/445] time 0.086 (0.089) data 0.000 (0.005) loss 1.9736 (1.7517) ce_loss 1.1377 (0.9373) loss_zs_kd 1.4418 (1.7958) loss_oracle 0.4747 (0.4935) acc 62.5000 (66.3143) kd_loss 0.5985 (0.5676) lr 1.8090e-03 eta 0:25:16
epoch [12/50] batch [360/445] time 0.078 (0.089) data 0.000 (0.005) loss 1.7980 (1.7570) ce_loss 0.9565 (0.9405) loss_zs_kd 1.6314 (1.7892) loss_oracle 0.4630 (0.4943) acc 62.5000 (66.2934) kd_loss 0.6100 (0.5693) lr 1.8090e-03 eta 0:25:08
epoch [12/50] batch [380/445] time 0.084 (0.088) data 0.000 (0.005) loss 1.5835 (1.7608) ce_loss 0.7817 (0.9425) loss_zs_kd 1.7134 (1.7889) loss_oracle 0.5136 (0.4951) acc 65.6250 (66.1266) kd_loss 0.5450 (0.5708) lr 1.8090e-03 eta 0:25:02
epoch [12/50] batch [400/445] time 0.082 (0.088) data 0.000 (0.004) loss 1.9531 (1.7648) ce_loss 1.1074 (0.9454) loss_zs_kd 1.9886 (1.7872) loss_oracle 0.5128 (0.4949) acc 62.5000 (66.1797) kd_loss 0.5893 (0.5719) lr 1.8090e-03 eta 0:24:57
epoch [12/50] batch [420/445] time 0.081 (0.088) data 0.001 (0.004) loss 1.6999 (1.7621) ce_loss 0.7949 (0.9425) loss_zs_kd 2.0110 (1.7879) loss_oracle 0.5917 (0.4953) acc 71.8750 (66.2946) kd_loss 0.6092 (0.5720) lr 1.8090e-03 eta 0:24:52
epoch [12/50] batch [440/445] time 0.081 (0.088) data 0.000 (0.004) loss 1.8998 (1.7606) ce_loss 1.1143 (0.9403) loss_zs_kd 1.7282 (1.7899) loss_oracle 0.4627 (0.4953) acc 56.2500 (66.4276) kd_loss 0.5542 (0.5727) lr 1.8090e-03 eta 0:24:43
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,306
* accuracy: 70.5%
* error: 29.5%
* macro_f1: 57.8%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,092
* accuracy: 52.7%
* error: 47.3%
* macro_f1: 31.9%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      70.5%, epoch: 12 *******
******* Domain 3 best val test acc: 52.7%, epoch: 12 *******
******* Domain 3 best test acc:     52.7%, epoch: 12 *******
epoch [13/50] batch [20/445] time 0.079 (0.201) data 0.000 (0.116) loss 1.8303 (1.6555) ce_loss 0.9160 (0.8374) loss_zs_kd 2.0843 (1.8512) loss_oracle 0.5604 (0.4979) acc 59.3750 (70.6250) kd_loss 0.6341 (0.5692) lr 1.7705e-03 eta 0:56:42
epoch [13/50] batch [40/445] time 0.073 (0.140) data 0.000 (0.058) loss 1.8232 (1.7001) ce_loss 0.9727 (0.8867) loss_zs_kd 1.8041 (1.8250) loss_oracle 0.4644 (0.4843) acc 71.8750 (69.1406) kd_loss 0.6183 (0.5712) lr 1.7705e-03 eta 0:39:24
epoch [13/50] batch [60/445] time 0.091 (0.121) data 0.000 (0.039) loss 1.7854 (1.7296) ce_loss 0.9731 (0.9094) loss_zs_kd 1.9098 (1.8913) loss_oracle 0.4713 (0.4904) acc 62.5000 (68.3854) kd_loss 0.5766 (0.5750) lr 1.7705e-03 eta 0:34:02
epoch [13/50] batch [80/445] time 0.083 (0.112) data 0.000 (0.029) loss 1.9321 (1.7386) ce_loss 1.1025 (0.9161) loss_zs_kd 2.0836 (1.8700) loss_oracle 0.5470 (0.4931) acc 56.2500 (68.1250) kd_loss 0.5561 (0.5760) lr 1.7705e-03 eta 0:31:18
epoch [13/50] batch [100/445] time 0.084 (0.106) data 0.000 (0.023) loss 1.6890 (1.7603) ce_loss 0.8911 (0.9347) loss_zs_kd 2.3033 (1.8877) loss_oracle 0.4583 (0.4943) acc 65.6250 (67.7812) kd_loss 0.5688 (0.5785) lr 1.7705e-03 eta 0:29:38
epoch [13/50] batch [120/445] time 0.086 (0.102) data 0.000 (0.020) loss 1.7517 (1.7640) ce_loss 0.8672 (0.9358) loss_zs_kd 1.7206 (1.8791) loss_oracle 0.4916 (0.4997) acc 71.8750 (67.5000) kd_loss 0.6387 (0.5783) lr 1.7705e-03 eta 0:28:37
epoch [13/50] batch [140/445] time 0.075 (0.099) data 0.000 (0.017) loss 1.8125 (1.7621) ce_loss 0.8560 (0.9297) loss_zs_kd 1.6634 (1.8688) loss_oracle 0.5828 (0.5016) acc 65.6250 (67.2545) kd_loss 0.6652 (0.5816) lr 1.7705e-03 eta 0:27:39
epoch [13/50] batch [160/445] time 0.085 (0.097) data 0.000 (0.015) loss 1.9764 (1.7632) ce_loss 1.1982 (0.9250) loss_zs_kd 1.3596 (1.8564) loss_oracle 0.4591 (0.5048) acc 59.3750 (67.2656) kd_loss 0.5486 (0.5858) lr 1.7705e-03 eta 0:27:04
epoch [13/50] batch [180/445] time 0.088 (0.096) data 0.000 (0.013) loss 1.9513 (1.7652) ce_loss 1.0195 (0.9246) loss_zs_kd 2.4327 (1.8654) loss_oracle 0.5662 (0.5029) acc 65.6250 (67.2222) kd_loss 0.6486 (0.5891) lr 1.7705e-03 eta 0:26:43
epoch [13/50] batch [200/445] time 0.080 (0.094) data 0.000 (0.012) loss 1.7315 (1.7751) ce_loss 0.8491 (0.9314) loss_zs_kd 1.8030 (1.8553) loss_oracle 0.4905 (0.5029) acc 68.7500 (67.0156) kd_loss 0.6372 (0.5922) lr 1.7705e-03 eta 0:26:15
epoch [13/50] batch [220/445] time 0.080 (0.093) data 0.000 (0.011) loss 2.0143 (1.7793) ce_loss 1.1055 (0.9329) loss_zs_kd 1.7771 (1.8578) loss_oracle 0.5771 (0.5044) acc 62.5000 (67.1591) kd_loss 0.6202 (0.5943) lr 1.7705e-03 eta 0:25:53
epoch [13/50] batch [240/445] time 0.080 (0.092) data 0.000 (0.010) loss 1.7338 (1.7758) ce_loss 0.9121 (0.9290) loss_zs_kd 2.2116 (1.8671) loss_oracle 0.4942 (0.5034) acc 65.6250 (67.2526) kd_loss 0.5746 (0.5951) lr 1.7705e-03 eta 0:25:36
epoch [13/50] batch [260/445] time 0.085 (0.091) data 0.000 (0.009) loss 1.7475 (1.7790) ce_loss 0.7705 (0.9305) loss_zs_kd 2.0712 (1.8593) loss_oracle 0.6322 (0.5030) acc 78.1250 (67.0673) kd_loss 0.6609 (0.5970) lr 1.7705e-03 eta 0:25:19
epoch [13/50] batch [280/445] time 0.100 (0.091) data 0.000 (0.009) loss 1.6711 (1.7854) ce_loss 0.8906 (0.9344) loss_zs_kd 1.6102 (1.8489) loss_oracle 0.4092 (0.5022) acc 68.7500 (67.0201) kd_loss 0.5758 (0.5999) lr 1.7705e-03 eta 0:25:12
epoch [13/50] batch [300/445] time 0.094 (0.091) data 0.000 (0.008) loss 1.4825 (1.7863) ce_loss 0.7310 (0.9352) loss_zs_kd 1.7302 (1.8439) loss_oracle 0.3931 (0.5014) acc 75.0000 (67.0625) kd_loss 0.5550 (0.6004) lr 1.7705e-03 eta 0:25:07
epoch [13/50] batch [320/445] time 0.081 (0.090) data 0.001 (0.008) loss 1.8869 (1.7809) ce_loss 1.0557 (0.9299) loss_zs_kd 1.7885 (1.8464) loss_oracle 0.5228 (0.5004) acc 53.1250 (67.1582) kd_loss 0.5699 (0.6008) lr 1.7705e-03 eta 0:25:00
epoch [13/50] batch [340/445] time 0.083 (0.090) data 0.000 (0.007) loss 1.6556 (1.7811) ce_loss 0.8101 (0.9300) loss_zs_kd 1.7161 (1.8399) loss_oracle 0.4996 (0.4985) acc 75.0000 (67.1599) kd_loss 0.5958 (0.6019) lr 1.7705e-03 eta 0:24:52
epoch [13/50] batch [360/445] time 0.082 (0.090) data 0.000 (0.007) loss 2.0435 (1.7813) ce_loss 1.0020 (0.9294) loss_zs_kd 1.7517 (1.8325) loss_oracle 0.5566 (0.4992) acc 62.5000 (67.2396) kd_loss 0.7632 (0.6023) lr 1.7705e-03 eta 0:24:41
epoch [13/50] batch [380/445] time 0.079 (0.089) data 0.000 (0.006) loss 1.8919 (1.7822) ce_loss 0.8613 (0.9307) loss_zs_kd 1.9626 (1.8331) loss_oracle 0.5711 (0.4983) acc 71.8750 (67.2368) kd_loss 0.7451 (0.6024) lr 1.7705e-03 eta 0:24:35
epoch [13/50] batch [400/445] time 0.082 (0.089) data 0.000 (0.006) loss 1.8911 (1.7868) ce_loss 1.0098 (0.9342) loss_zs_kd 1.4235 (1.8250) loss_oracle 0.4903 (0.4977) acc 62.5000 (67.0781) kd_loss 0.6362 (0.6038) lr 1.7705e-03 eta 0:24:25
epoch [13/50] batch [420/445] time 0.078 (0.088) data 0.000 (0.006) loss 2.1797 (1.7894) ce_loss 1.4141 (0.9359) loss_zs_kd 1.7741 (1.8233) loss_oracle 0.4486 (0.4969) acc 56.2500 (67.0089) kd_loss 0.5413 (0.6051) lr 1.7705e-03 eta 0:24:15
epoch [13/50] batch [440/445] time 0.080 (0.088) data 0.000 (0.006) loss 2.1772 (1.7891) ce_loss 1.2363 (0.9346) loss_zs_kd 1.6932 (1.8226) loss_oracle 0.4698 (0.4968) acc 53.1250 (67.0099) kd_loss 0.7060 (0.6061) lr 1.7705e-03 eta 0:24:07
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,331
* accuracy: 70.9%
* error: 29.1%
* macro_f1: 57.3%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,979
* accuracy: 49.8%
* error: 50.2%
* macro_f1: 32.4%
******* Domain 3 best val acc:      70.9%, epoch: 13 *******
******* Domain 3 best val test acc: 49.8%, epoch: 13 *******
******* Domain 3 best test acc:     52.7%, epoch: 12 *******
epoch [14/50] batch [20/445] time 0.081 (0.157) data 0.000 (0.076) loss 1.8059 (1.7988) ce_loss 0.9741 (0.9465) loss_zs_kd 1.6161 (1.7536) loss_oracle 0.4723 (0.4739) acc 68.7500 (64.6875) kd_loss 0.5957 (0.6154) lr 1.7290e-03 eta 0:43:05
epoch [14/50] batch [40/445] time 0.079 (0.117) data 0.000 (0.038) loss 1.9417 (1.8032) ce_loss 0.8906 (0.9371) loss_zs_kd 1.6394 (1.7634) loss_oracle 0.6558 (0.4971) acc 71.8750 (66.3281) kd_loss 0.7232 (0.6176) lr 1.7290e-03 eta 0:32:08
epoch [14/50] batch [60/445] time 0.082 (0.105) data 0.000 (0.026) loss 1.7218 (1.8184) ce_loss 0.7773 (0.9498) loss_zs_kd 1.9301 (1.7965) loss_oracle 0.5623 (0.4958) acc 71.8750 (66.2500) kd_loss 0.6633 (0.6207) lr 1.7290e-03 eta 0:28:50
epoch [14/50] batch [80/445] time 0.083 (0.101) data 0.000 (0.019) loss 1.6879 (1.8123) ce_loss 0.7720 (0.9418) loss_zs_kd 1.9620 (1.8357) loss_oracle 0.5064 (0.4934) acc 75.0000 (66.2891) kd_loss 0.6627 (0.6239) lr 1.7290e-03 eta 0:27:30
epoch [14/50] batch [100/445] time 0.073 (0.097) data 0.000 (0.015) loss 1.8578 (1.8109) ce_loss 0.8818 (0.9352) loss_zs_kd 1.8737 (1.8222) loss_oracle 0.4628 (0.4884) acc 71.8750 (66.3750) kd_loss 0.7445 (0.6316) lr 1.7290e-03 eta 0:26:32
epoch [14/50] batch [120/445] time 0.082 (0.094) data 0.000 (0.013) loss 2.2210 (1.8092) ce_loss 1.3076 (0.9341) loss_zs_kd 1.5735 (1.8020) loss_oracle 0.5234 (0.4860) acc 53.1250 (66.2760) kd_loss 0.6517 (0.6320) lr 1.7290e-03 eta 0:25:42
epoch [14/50] batch [140/445] time 0.080 (0.093) data 0.000 (0.011) loss 1.5086 (1.8095) ce_loss 0.6602 (0.9354) loss_zs_kd 1.6845 (1.8099) loss_oracle 0.3696 (0.4830) acc 84.3750 (66.4286) kd_loss 0.6636 (0.6326) lr 1.7290e-03 eta 0:25:20
epoch [14/50] batch [160/445] time 0.092 (0.092) data 0.000 (0.010) loss 1.7335 (1.8050) ce_loss 0.8442 (0.9295) loss_zs_kd 1.4845 (1.8083) loss_oracle 0.4346 (0.4828) acc 78.1250 (66.8945) kd_loss 0.6720 (0.6342) lr 1.7290e-03 eta 0:25:02
epoch [14/50] batch [180/445] time 0.084 (0.091) data 0.000 (0.009) loss 1.7545 (1.8084) ce_loss 1.0029 (0.9366) loss_zs_kd 1.9116 (1.8223) loss_oracle 0.3799 (0.4839) acc 56.2500 (66.5104) kd_loss 0.5616 (0.6299) lr 1.7290e-03 eta 0:24:40
epoch [14/50] batch [200/445] time 0.086 (0.090) data 0.000 (0.008) loss 1.8960 (1.8001) ce_loss 1.0664 (0.9300) loss_zs_kd 1.7004 (1.8300) loss_oracle 0.4717 (0.4830) acc 65.6250 (66.9219) kd_loss 0.5938 (0.6286) lr 1.7290e-03 eta 0:24:31
epoch [14/50] batch [220/445] time 0.075 (0.090) data 0.000 (0.007) loss 1.7654 (1.7944) ce_loss 0.8955 (0.9283) loss_zs_kd 1.6494 (1.8290) loss_oracle 0.5209 (0.4797) acc 65.6250 (67.1449) kd_loss 0.6095 (0.6262) lr 1.7290e-03 eta 0:24:17
epoch [14/50] batch [240/445] time 0.089 (0.089) data 0.000 (0.007) loss 1.8855 (1.7938) ce_loss 0.9839 (0.9295) loss_zs_kd 1.6875 (1.8312) loss_oracle 0.4384 (0.4787) acc 62.5000 (67.1615) kd_loss 0.6824 (0.6250) lr 1.7290e-03 eta 0:24:02
epoch [14/50] batch [260/445] time 0.078 (0.088) data 0.000 (0.006) loss 1.8461 (1.7991) ce_loss 1.0010 (0.9356) loss_zs_kd 1.9141 (1.8316) loss_oracle 0.5276 (0.4798) acc 62.5000 (66.9111) kd_loss 0.5813 (0.6236) lr 1.7290e-03 eta 0:23:48
epoch [14/50] batch [280/445] time 0.077 (0.087) data 0.000 (0.006) loss 1.6439 (1.7970) ce_loss 0.7876 (0.9333) loss_zs_kd 1.4939 (1.8297) loss_oracle 0.5417 (0.4813) acc 68.7500 (66.9420) kd_loss 0.5855 (0.6231) lr 1.7290e-03 eta 0:23:35
epoch [14/50] batch [300/445] time 0.075 (0.087) data 0.000 (0.005) loss 1.7432 (1.7956) ce_loss 0.9072 (0.9327) loss_zs_kd 2.1665 (1.8355) loss_oracle 0.5327 (0.4829) acc 62.5000 (66.9583) kd_loss 0.5696 (0.6214) lr 1.7290e-03 eta 0:23:21
epoch [14/50] batch [320/445] time 0.075 (0.086) data 0.000 (0.005) loss 1.6399 (1.7929) ce_loss 0.8418 (0.9327) loss_zs_kd 2.0777 (1.8441) loss_oracle 0.4676 (0.4822) acc 65.6250 (66.9238) kd_loss 0.5643 (0.6191) lr 1.7290e-03 eta 0:23:09
epoch [14/50] batch [340/445] time 0.079 (0.086) data 0.000 (0.005) loss 1.7633 (1.7906) ce_loss 0.9126 (0.9328) loss_zs_kd 1.8843 (1.8443) loss_oracle 0.4716 (0.4814) acc 71.8750 (67.0129) kd_loss 0.6149 (0.6171) lr 1.7290e-03 eta 0:23:00
epoch [14/50] batch [360/445] time 0.091 (0.086) data 0.000 (0.004) loss 1.8494 (1.7888) ce_loss 1.0879 (0.9327) loss_zs_kd 1.3388 (1.8468) loss_oracle 0.3887 (0.4811) acc 68.7500 (67.1094) kd_loss 0.5672 (0.6156) lr 1.7290e-03 eta 0:22:58
epoch [14/50] batch [380/445] time 0.080 (0.086) data 0.000 (0.004) loss 1.4882 (1.7864) ce_loss 0.6938 (0.9312) loss_zs_kd 1.5352 (1.8434) loss_oracle 0.4712 (0.4811) acc 81.2500 (67.1053) kd_loss 0.5588 (0.6147) lr 1.7290e-03 eta 0:22:57
epoch [14/50] batch [400/445] time 0.084 (0.086) data 0.000 (0.004) loss 1.7949 (1.7862) ce_loss 0.9600 (0.9323) loss_zs_kd 1.6370 (1.8382) loss_oracle 0.4514 (0.4818) acc 65.6250 (67.0469) kd_loss 0.6093 (0.6131) lr 1.7290e-03 eta 0:22:54
epoch [14/50] batch [420/445] time 0.088 (0.086) data 0.000 (0.004) loss 1.6556 (1.7862) ce_loss 0.9111 (0.9339) loss_zs_kd 1.6722 (1.8338) loss_oracle 0.4717 (0.4818) acc 59.3750 (66.9568) kd_loss 0.5086 (0.6114) lr 1.7290e-03 eta 0:22:52
epoch [14/50] batch [440/445] time 0.081 (0.085) data 0.000 (0.004) loss 1.7325 (1.7863) ce_loss 0.8730 (0.9355) loss_zs_kd 1.6607 (1.8334) loss_oracle 0.4760 (0.4822) acc 62.5000 (66.8182) kd_loss 0.6214 (0.6097) lr 1.7290e-03 eta 0:22:49
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,324
* accuracy: 70.8%
* error: 29.2%
* macro_f1: 58.7%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,106
* accuracy: 53.0%
* error: 47.0%
* macro_f1: 35.8%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      70.9%, epoch: 13 *******
******* Domain 3 best val test acc: 49.8%, epoch: 13 *******
******* Domain 3 best test acc:     53.0%, epoch: 14 *******
epoch [15/50] batch [20/445] time 0.077 (0.177) data 0.000 (0.095) loss 1.8596 (1.8328) ce_loss 0.9990 (0.9874) loss_zs_kd 1.7936 (1.7719) loss_oracle 0.4025 (0.4762) acc 62.5000 (63.9062) kd_loss 0.6593 (0.6073) lr 1.6845e-03 eta 0:47:16
epoch [15/50] batch [40/445] time 0.082 (0.131) data 0.000 (0.048) loss 1.6997 (1.7981) ce_loss 0.8647 (0.9516) loss_zs_kd 1.4588 (1.7542) loss_oracle 0.4607 (0.4731) acc 71.8750 (65.0781) kd_loss 0.6046 (0.6100) lr 1.6845e-03 eta 0:34:58
epoch [15/50] batch [60/445] time 0.084 (0.116) data 0.000 (0.032) loss 1.6146 (1.7924) ce_loss 0.8999 (0.9490) loss_zs_kd 1.4833 (1.7875) loss_oracle 0.3650 (0.4766) acc 65.6250 (65.3646) kd_loss 0.5322 (0.6051) lr 1.6845e-03 eta 0:30:54
epoch [15/50] batch [80/445] time 0.088 (0.108) data 0.000 (0.024) loss 2.2163 (1.7828) ce_loss 1.3330 (0.9364) loss_zs_kd 2.1549 (1.8083) loss_oracle 0.5295 (0.4754) acc 50.0000 (65.6250) kd_loss 0.6185 (0.6087) lr 1.6845e-03 eta 0:28:47
epoch [15/50] batch [100/445] time 0.082 (0.104) data 0.000 (0.019) loss 1.6490 (1.7848) ce_loss 0.8740 (0.9311) loss_zs_kd 1.8621 (1.8576) loss_oracle 0.4462 (0.4851) acc 68.7500 (65.9688) kd_loss 0.5519 (0.6112) lr 1.6845e-03 eta 0:27:30
epoch [15/50] batch [120/445] time 0.086 (0.100) data 0.000 (0.016) loss 1.6093 (1.7830) ce_loss 0.8833 (0.9303) loss_zs_kd 1.7508 (1.8784) loss_oracle 0.4509 (0.4872) acc 59.3750 (66.0677) kd_loss 0.5005 (0.6091) lr 1.6845e-03 eta 0:26:37
epoch [15/50] batch [140/445] time 0.089 (0.098) data 0.000 (0.014) loss 1.6032 (1.7792) ce_loss 0.8032 (0.9292) loss_zs_kd 1.9471 (1.8545) loss_oracle 0.4515 (0.4893) acc 65.6250 (66.1384) kd_loss 0.5742 (0.6053) lr 1.6845e-03 eta 0:25:58
epoch [15/50] batch [160/445] time 0.079 (0.097) data 0.000 (0.012) loss 1.5085 (1.7694) ce_loss 0.7383 (0.9239) loss_zs_kd 2.2705 (1.8614) loss_oracle 0.4926 (0.4881) acc 75.0000 (66.4453) kd_loss 0.5239 (0.6015) lr 1.6845e-03 eta 0:25:30
epoch [15/50] batch [180/445] time 0.089 (0.095) data 0.000 (0.011) loss 1.7799 (1.7684) ce_loss 0.9082 (0.9228) loss_zs_kd 2.1578 (1.8666) loss_oracle 0.5075 (0.4887) acc 78.1250 (66.6319) kd_loss 0.6180 (0.6014) lr 1.6845e-03 eta 0:25:09
epoch [15/50] batch [200/445] time 0.075 (0.094) data 0.000 (0.010) loss 1.5864 (1.7722) ce_loss 0.7349 (0.9263) loss_zs_kd 1.7178 (1.8711) loss_oracle 0.5174 (0.4887) acc 81.2500 (66.6406) kd_loss 0.5928 (0.6015) lr 1.6845e-03 eta 0:24:45
epoch [15/50] batch [220/445] time 0.098 (0.093) data 0.000 (0.009) loss 1.8757 (1.7727) ce_loss 1.0078 (0.9271) loss_zs_kd 2.0687 (1.8587) loss_oracle 0.4981 (0.4876) acc 62.5000 (66.6761) kd_loss 0.6188 (0.6018) lr 1.6845e-03 eta 0:24:27
epoch [15/50] batch [240/445] time 0.092 (0.092) data 0.000 (0.008) loss 2.1296 (1.7700) ce_loss 1.1699 (0.9256) loss_zs_kd 1.7416 (1.8457) loss_oracle 0.5699 (0.4867) acc 50.0000 (66.5755) kd_loss 0.6747 (0.6010) lr 1.6845e-03 eta 0:24:15
epoch [15/50] batch [260/445] time 0.088 (0.092) data 0.000 (0.008) loss 1.8251 (1.7660) ce_loss 1.1084 (0.9232) loss_zs_kd 1.9149 (1.8423) loss_oracle 0.4298 (0.4841) acc 59.3750 (66.6587) kd_loss 0.5018 (0.6007) lr 1.6845e-03 eta 0:24:02
epoch [15/50] batch [280/445] time 0.090 (0.091) data 0.000 (0.007) loss 1.7833 (1.7694) ce_loss 1.0000 (0.9281) loss_zs_kd 1.6375 (1.8340) loss_oracle 0.4219 (0.4832) acc 56.2500 (66.4621) kd_loss 0.5723 (0.5997) lr 1.6845e-03 eta 0:23:52
epoch [15/50] batch [300/445] time 0.087 (0.091) data 0.000 (0.007) loss 1.7171 (1.7679) ce_loss 0.9780 (0.9265) loss_zs_kd 1.8278 (1.8289) loss_oracle 0.4477 (0.4835) acc 68.7500 (66.5208) kd_loss 0.5153 (0.5997) lr 1.6845e-03 eta 0:23:43
epoch [15/50] batch [320/445] time 0.084 (0.090) data 0.000 (0.006) loss 1.8709 (1.7658) ce_loss 0.9512 (0.9252) loss_zs_kd 1.7545 (1.8302) loss_oracle 0.5072 (0.4838) acc 62.5000 (66.6211) kd_loss 0.6661 (0.5987) lr 1.6845e-03 eta 0:23:34
epoch [15/50] batch [340/445] time 0.083 (0.089) data 0.000 (0.006) loss 1.9132 (1.7661) ce_loss 0.9966 (0.9276) loss_zs_kd 1.6585 (1.8279) loss_oracle 0.5279 (0.4836) acc 71.8750 (66.6085) kd_loss 0.6526 (0.5967) lr 1.6845e-03 eta 0:23:22
epoch [15/50] batch [360/445] time 0.080 (0.089) data 0.000 (0.006) loss 1.5523 (1.7654) ce_loss 0.6729 (0.9266) loss_zs_kd 1.6284 (1.8358) loss_oracle 0.5290 (0.4847) acc 87.5000 (66.6580) kd_loss 0.6149 (0.5964) lr 1.6845e-03 eta 0:23:14
epoch [15/50] batch [380/445] time 0.083 (0.089) data 0.000 (0.005) loss 1.7953 (1.7645) ce_loss 0.8506 (0.9265) loss_zs_kd 2.0283 (1.8394) loss_oracle 0.5390 (0.4846) acc 65.6250 (66.7352) kd_loss 0.6753 (0.5957) lr 1.6845e-03 eta 0:23:05
epoch [15/50] batch [400/445] time 0.079 (0.088) data 0.000 (0.005) loss 1.6455 (1.7604) ce_loss 0.8613 (0.9233) loss_zs_kd 1.9419 (1.8413) loss_oracle 0.4664 (0.4846) acc 68.7500 (66.7891) kd_loss 0.5509 (0.5948) lr 1.6845e-03 eta 0:22:58
epoch [15/50] batch [420/445] time 0.071 (0.088) data 0.000 (0.005) loss 1.3945 (1.7616) ce_loss 0.6265 (0.9244) loss_zs_kd 1.7808 (1.8418) loss_oracle 0.4579 (0.4855) acc 81.2500 (66.8155) kd_loss 0.5391 (0.5945) lr 1.6845e-03 eta 0:22:49
epoch [15/50] batch [440/445] time 0.073 (0.087) data 0.000 (0.005) loss 1.4383 (1.7639) ce_loss 0.6509 (0.9260) loss_zs_kd 1.8903 (1.8484) loss_oracle 0.4343 (0.4869) acc 75.0000 (66.7543) kd_loss 0.5703 (0.5945) lr 1.6845e-03 eta 0:22:41
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,307
* accuracy: 70.5%
* error: 29.5%
* macro_f1: 57.0%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,815
* accuracy: 45.7%
* error: 54.3%
* macro_f1: 30.0%
******* Domain 3 best val acc:      70.9%, epoch: 13 *******
******* Domain 3 best val test acc: 49.8%, epoch: 13 *******
******* Domain 3 best test acc:     53.0%, epoch: 14 *******
epoch [16/50] batch [20/445] time 0.064 (0.169) data 0.000 (0.097) loss 1.7000 (1.7643) ce_loss 0.8584 (0.9300) loss_zs_kd 2.3424 (2.1304) loss_oracle 0.4800 (0.4899) acc 62.5000 (68.1250) kd_loss 0.6016 (0.5894) lr 1.6374e-03 eta 0:43:52
epoch [16/50] batch [40/445] time 0.079 (0.122) data 0.000 (0.048) loss 1.4629 (1.7757) ce_loss 0.6270 (0.9360) loss_zs_kd 1.9106 (2.0533) loss_oracle 0.4930 (0.4920) acc 78.1250 (66.7969) kd_loss 0.5895 (0.5936) lr 1.6374e-03 eta 0:31:35
epoch [16/50] batch [60/445] time 0.088 (0.109) data 0.000 (0.032) loss 1.9235 (1.7734) ce_loss 0.9956 (0.9289) loss_zs_kd 2.2901 (2.0345) loss_oracle 0.5497 (0.4939) acc 65.6250 (66.8229) kd_loss 0.6530 (0.5975) lr 1.6374e-03 eta 0:28:04
epoch [16/50] batch [80/445] time 0.084 (0.103) data 0.000 (0.024) loss 1.5595 (1.7743) ce_loss 0.7700 (0.9320) loss_zs_kd 1.8147 (2.0015) loss_oracle 0.4358 (0.4935) acc 78.1250 (66.4844) kd_loss 0.5716 (0.5955) lr 1.6374e-03 eta 0:26:29
epoch [16/50] batch [100/445] time 0.082 (0.099) data 0.000 (0.019) loss 1.9854 (1.7814) ce_loss 1.2031 (0.9436) loss_zs_kd 1.8269 (1.9734) loss_oracle 0.4427 (0.4941) acc 68.7500 (66.0938) kd_loss 0.5610 (0.5907) lr 1.6374e-03 eta 0:25:34
epoch [16/50] batch [120/445] time 0.083 (0.096) data 0.000 (0.016) loss 1.9014 (1.7772) ce_loss 0.9912 (0.9454) loss_zs_kd 1.6459 (1.9333) loss_oracle 0.5101 (0.4882) acc 75.0000 (66.1198) kd_loss 0.6552 (0.5877) lr 1.6374e-03 eta 0:24:48
epoch [16/50] batch [140/445] time 0.074 (0.094) data 0.000 (0.014) loss 1.5272 (1.7768) ce_loss 0.7021 (0.9438) loss_zs_kd 2.1896 (1.9364) loss_oracle 0.5281 (0.4895) acc 78.1250 (66.2723) kd_loss 0.5610 (0.5883) lr 1.6374e-03 eta 0:24:07
epoch [16/50] batch [160/445] time 0.072 (0.092) data 0.000 (0.012) loss 1.6705 (1.7744) ce_loss 0.8354 (0.9393) loss_zs_kd 1.9464 (1.9222) loss_oracle 0.4698 (0.4921) acc 68.7500 (66.2891) kd_loss 0.6002 (0.5891) lr 1.6374e-03 eta 0:23:39
epoch [16/50] batch [180/445] time 0.094 (0.091) data 0.000 (0.011) loss 1.7659 (1.7721) ce_loss 0.9434 (0.9365) loss_zs_kd 2.3514 (1.9177) loss_oracle 0.4411 (0.4902) acc 71.8750 (66.3368) kd_loss 0.6020 (0.5905) lr 1.6374e-03 eta 0:23:22
epoch [16/50] batch [200/445] time 0.078 (0.090) data 0.000 (0.010) loss 1.8332 (1.7674) ce_loss 1.0479 (0.9340) loss_zs_kd 1.8354 (1.9046) loss_oracle 0.4051 (0.4865) acc 62.5000 (66.4688) kd_loss 0.5828 (0.5901) lr 1.6374e-03 eta 0:23:09
epoch [16/50] batch [220/445] time 0.084 (0.090) data 0.000 (0.009) loss 1.8840 (1.7694) ce_loss 0.9722 (0.9313) loss_zs_kd 2.1095 (1.8981) loss_oracle 0.5152 (0.4872) acc 62.5000 (66.6619) kd_loss 0.6542 (0.5946) lr 1.6374e-03 eta 0:22:59
epoch [16/50] batch [240/445] time 0.071 (0.089) data 0.000 (0.008) loss 1.8281 (1.7726) ce_loss 0.9849 (0.9308) loss_zs_kd 1.6590 (1.8862) loss_oracle 0.5081 (0.4874) acc 62.5000 (66.6146) kd_loss 0.5892 (0.5981) lr 1.6374e-03 eta 0:22:47
epoch [16/50] batch [260/445] time 0.085 (0.089) data 0.000 (0.008) loss 1.3037 (1.7686) ce_loss 0.4741 (0.9253) loss_zs_kd 2.3245 (1.8932) loss_oracle 0.4695 (0.4877) acc 87.5000 (66.9111) kd_loss 0.5949 (0.5995) lr 1.6374e-03 eta 0:22:39
epoch [16/50] batch [280/445] time 0.079 (0.089) data 0.000 (0.007) loss 1.7394 (1.7672) ce_loss 0.7793 (0.9215) loss_zs_kd 1.8513 (1.9044) loss_oracle 0.4846 (0.4876) acc 68.7500 (67.0536) kd_loss 0.7178 (0.6018) lr 1.6374e-03 eta 0:22:34
epoch [16/50] batch [300/445] time 0.080 (0.088) data 0.000 (0.007) loss 1.3984 (1.7629) ce_loss 0.6230 (0.9166) loss_zs_kd 1.8778 (1.9147) loss_oracle 0.4246 (0.4866) acc 78.1250 (67.1875) kd_loss 0.5630 (0.6030) lr 1.6374e-03 eta 0:22:29
epoch [16/50] batch [320/445] time 0.082 (0.088) data 0.000 (0.006) loss 1.9173 (1.7618) ce_loss 1.0918 (0.9163) loss_zs_kd 1.5958 (1.9150) loss_oracle 0.5162 (0.4857) acc 65.6250 (67.2852) kd_loss 0.5674 (0.6027) lr 1.6374e-03 eta 0:22:24
epoch [16/50] batch [340/445] time 0.076 (0.088) data 0.000 (0.006) loss 1.8899 (1.7665) ce_loss 1.0117 (0.9190) loss_zs_kd 2.2003 (1.9219) loss_oracle 0.5564 (0.4879) acc 59.3750 (67.1415) kd_loss 0.6000 (0.6036) lr 1.6374e-03 eta 0:22:19
epoch [16/50] batch [360/445] time 0.077 (0.087) data 0.000 (0.006) loss 1.7796 (1.7719) ce_loss 1.0010 (0.9230) loss_zs_kd 1.6854 (1.9147) loss_oracle 0.4840 (0.4897) acc 62.5000 (67.0312) kd_loss 0.5366 (0.6040) lr 1.6374e-03 eta 0:22:09
epoch [16/50] batch [380/445] time 0.090 (0.087) data 0.000 (0.005) loss 1.6962 (1.7766) ce_loss 0.8218 (0.9263) loss_zs_kd 2.0021 (1.9100) loss_oracle 0.5369 (0.4896) acc 71.8750 (66.8750) kd_loss 0.6060 (0.6055) lr 1.6374e-03 eta 0:22:04
epoch [16/50] batch [400/445] time 0.099 (0.087) data 0.000 (0.005) loss 1.8013 (1.7813) ce_loss 0.9292 (0.9301) loss_zs_kd 1.9066 (1.9101) loss_oracle 0.4913 (0.4903) acc 65.6250 (66.8203) kd_loss 0.6264 (0.6060) lr 1.6374e-03 eta 0:22:01
epoch [16/50] batch [420/445] time 0.079 (0.087) data 0.000 (0.005) loss 1.9525 (1.7815) ce_loss 1.1016 (0.9290) loss_zs_kd 1.8334 (1.9080) loss_oracle 0.5073 (0.4903) acc 59.3750 (66.8750) kd_loss 0.5973 (0.6073) lr 1.6374e-03 eta 0:21:58
epoch [16/50] batch [440/445] time 0.082 (0.087) data 0.000 (0.005) loss 1.3660 (1.7818) ce_loss 0.4707 (0.9287) loss_zs_kd 1.6788 (1.9110) loss_oracle 0.5334 (0.4913) acc 87.5000 (66.9105) kd_loss 0.6286 (0.6074) lr 1.6374e-03 eta 0:21:53
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,357
* accuracy: 71.3%
* error: 28.7%
* macro_f1: 57.6%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,023
* accuracy: 51.0%
* error: 49.0%
* macro_f1: 32.6%
******* Domain 3 best val acc:      71.3%, epoch: 16 *******
******* Domain 3 best val test acc: 51.0%, epoch: 16 *******
******* Domain 3 best test acc:     53.0%, epoch: 14 *******
epoch [17/50] batch [20/445] time 0.085 (0.190) data 0.000 (0.102) loss 1.7752 (1.8966) ce_loss 0.9082 (1.0133) loss_zs_kd 2.0275 (1.8429) loss_oracle 0.5044 (0.5344) acc 65.6250 (62.9688) kd_loss 0.6148 (0.6161) lr 1.5878e-03 eta 0:47:53
epoch [17/50] batch [40/445] time 0.079 (0.135) data 0.000 (0.051) loss 2.1474 (1.8364) ce_loss 1.3408 (0.9786) loss_zs_kd 2.0844 (1.9664) loss_oracle 0.4901 (0.5188) acc 53.1250 (63.5938) kd_loss 0.5615 (0.5984) lr 1.5878e-03 eta 0:33:50
epoch [17/50] batch [60/445] time 0.328 (0.120) data 0.000 (0.034) loss 1.8604 (1.8180) ce_loss 0.8979 (0.9608) loss_zs_kd 2.0006 (1.9269) loss_oracle 0.6035 (0.5233) acc 68.7500 (64.2708) kd_loss 0.6607 (0.5955) lr 1.5878e-03 eta 0:30:05
epoch [17/50] batch [80/445] time 0.077 (0.110) data 0.000 (0.026) loss 1.7839 (1.7805) ce_loss 0.8960 (0.9256) loss_zs_kd 1.8532 (1.8821) loss_oracle 0.4994 (0.5204) acc 68.7500 (66.4453) kd_loss 0.6382 (0.5948) lr 1.5878e-03 eta 0:27:30
epoch [17/50] batch [100/445] time 0.084 (0.105) data 0.000 (0.021) loss 2.1396 (1.7838) ce_loss 1.1357 (0.9227) loss_zs_kd 1.6548 (1.9075) loss_oracle 0.6211 (0.5223) acc 59.3750 (66.7188) kd_loss 0.6932 (0.5999) lr 1.5878e-03 eta 0:26:16
epoch [17/50] batch [120/445] time 0.079 (0.101) data 0.000 (0.017) loss 1.9751 (1.7862) ce_loss 1.1152 (0.9276) loss_zs_kd 1.5564 (1.9302) loss_oracle 0.5036 (0.5185) acc 62.5000 (66.7448) kd_loss 0.6081 (0.5993) lr 1.5878e-03 eta 0:25:20
epoch [17/50] batch [140/445] time 0.087 (0.098) data 0.000 (0.015) loss 1.9960 (1.7938) ce_loss 1.1562 (0.9329) loss_zs_kd 2.1054 (1.9153) loss_oracle 0.5266 (0.5199) acc 65.6250 (66.6741) kd_loss 0.5764 (0.6009) lr 1.5878e-03 eta 0:24:29
epoch [17/50] batch [160/445] time 0.086 (0.096) data 0.000 (0.013) loss 1.9861 (1.7883) ce_loss 1.1445 (0.9310) loss_zs_kd 1.6054 (1.9226) loss_oracle 0.5827 (0.5185) acc 62.5000 (66.5820) kd_loss 0.5502 (0.5981) lr 1.5878e-03 eta 0:23:55
epoch [17/50] batch [180/445] time 0.085 (0.095) data 0.000 (0.012) loss 1.5675 (1.7821) ce_loss 0.7422 (0.9258) loss_zs_kd 1.5123 (1.9119) loss_oracle 0.4839 (0.5180) acc 75.0000 (66.5278) kd_loss 0.5834 (0.5972) lr 1.5878e-03 eta 0:23:36
epoch [17/50] batch [200/445] time 0.083 (0.094) data 0.000 (0.010) loss 1.4145 (1.7779) ce_loss 0.6772 (0.9234) loss_zs_kd 1.9653 (1.9157) loss_oracle 0.4356 (0.5167) acc 75.0000 (66.8281) kd_loss 0.5194 (0.5961) lr 1.5878e-03 eta 0:23:17
epoch [17/50] batch [220/445] time 0.077 (0.093) data 0.000 (0.010) loss 1.8505 (1.7770) ce_loss 1.0039 (0.9223) loss_zs_kd 2.2108 (1.9096) loss_oracle 0.5554 (0.5163) acc 65.6250 (66.8324) kd_loss 0.5689 (0.5966) lr 1.5878e-03 eta 0:23:02
epoch [17/50] batch [240/445] time 0.080 (0.092) data 0.000 (0.009) loss 1.8363 (1.7783) ce_loss 0.8984 (0.9236) loss_zs_kd 2.0344 (1.9163) loss_oracle 0.5366 (0.5171) acc 56.2500 (66.7318) kd_loss 0.6695 (0.5962) lr 1.5878e-03 eta 0:22:50
epoch [17/50] batch [260/445] time 0.085 (0.091) data 0.000 (0.008) loss 1.8961 (1.7758) ce_loss 1.0156 (0.9227) loss_zs_kd 2.2043 (1.9301) loss_oracle 0.5672 (0.5159) acc 59.3750 (66.7788) kd_loss 0.5969 (0.5952) lr 1.5878e-03 eta 0:22:38
epoch [17/50] batch [280/445] time 0.083 (0.091) data 0.000 (0.008) loss 1.6427 (1.7734) ce_loss 0.8975 (0.9198) loss_zs_kd 2.0690 (1.9253) loss_oracle 0.4129 (0.5147) acc 65.6250 (66.9308) kd_loss 0.5388 (0.5962) lr 1.5878e-03 eta 0:22:30
epoch [17/50] batch [300/445] time 0.079 (0.091) data 0.000 (0.007) loss 1.4501 (1.7764) ce_loss 0.6558 (0.9239) loss_zs_kd 1.3625 (1.9242) loss_oracle 0.4748 (0.5147) acc 81.2500 (66.8125) kd_loss 0.5570 (0.5952) lr 1.5878e-03 eta 0:22:24
epoch [17/50] batch [320/445] time 0.085 (0.090) data 0.000 (0.007) loss 1.6439 (1.7781) ce_loss 0.6699 (0.9245) loss_zs_kd 2.0265 (1.9224) loss_oracle 0.6468 (0.5149) acc 84.3750 (66.7871) kd_loss 0.6506 (0.5962) lr 1.5878e-03 eta 0:22:11
epoch [17/50] batch [340/445] time 0.081 (0.090) data 0.000 (0.006) loss 1.7096 (1.7804) ce_loss 0.8696 (0.9259) loss_zs_kd 1.8865 (1.9263) loss_oracle 0.4986 (0.5158) acc 65.6250 (66.7004) kd_loss 0.5906 (0.5965) lr 1.5878e-03 eta 0:22:04
epoch [17/50] batch [360/445] time 0.089 (0.089) data 0.000 (0.006) loss 1.8296 (1.7819) ce_loss 1.0254 (0.9274) loss_zs_kd 2.0624 (1.9278) loss_oracle 0.4128 (0.5155) acc 59.3750 (66.6406) kd_loss 0.5978 (0.5968) lr 1.5878e-03 eta 0:21:55
epoch [17/50] batch [380/445] time 0.084 (0.089) data 0.000 (0.006) loss 1.8353 (1.7811) ce_loss 0.9199 (0.9256) loss_zs_kd 1.8115 (1.9221) loss_oracle 0.6028 (0.5155) acc 62.5000 (66.6530) kd_loss 0.6140 (0.5978) lr 1.5878e-03 eta 0:21:48
epoch [17/50] batch [400/445] time 0.083 (0.088) data 0.000 (0.005) loss 1.6635 (1.7852) ce_loss 0.8516 (0.9286) loss_zs_kd 2.0311 (1.9219) loss_oracle 0.5431 (0.5164) acc 75.0000 (66.4844) kd_loss 0.5404 (0.5983) lr 1.5878e-03 eta 0:21:41
epoch [17/50] batch [420/445] time 0.089 (0.088) data 0.000 (0.005) loss 1.9229 (1.7880) ce_loss 0.9443 (0.9300) loss_zs_kd 1.5992 (1.9221) loss_oracle 0.5880 (0.5171) acc 65.6250 (66.3988) kd_loss 0.6846 (0.5995) lr 1.5878e-03 eta 0:21:38
epoch [17/50] batch [440/445] time 0.076 (0.088) data 0.000 (0.005) loss 1.5633 (1.7860) ce_loss 0.7471 (0.9271) loss_zs_kd 1.6774 (1.9227) loss_oracle 0.4715 (0.5166) acc 78.1250 (66.5341) kd_loss 0.5805 (0.6006) lr 1.5878e-03 eta 0:21:32
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,321
* accuracy: 70.7%
* error: 29.3%
* macro_f1: 58.3%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,041
* accuracy: 51.4%
* error: 48.6%
* macro_f1: 31.7%
******* Domain 3 best val acc:      71.3%, epoch: 16 *******
******* Domain 3 best val test acc: 51.0%, epoch: 16 *******
******* Domain 3 best test acc:     53.0%, epoch: 14 *******
epoch [18/50] batch [20/445] time 0.073 (0.186) data 0.000 (0.119) loss 2.3397 (1.8663) ce_loss 1.3154 (0.9686) loss_zs_kd 1.7556 (1.8159) loss_oracle 0.5792 (0.5175) acc 46.8750 (65.0000) kd_loss 0.7346 (0.6390) lr 1.5358e-03 eta 0:45:28
epoch [18/50] batch [40/445] time 0.081 (0.132) data 0.000 (0.060) loss 1.5596 (1.8332) ce_loss 0.8828 (0.9497) loss_zs_kd 1.6079 (1.8893) loss_oracle 0.3726 (0.5253) acc 68.7500 (66.3281) kd_loss 0.4905 (0.6209) lr 1.5358e-03 eta 0:32:15
epoch [18/50] batch [60/445] time 0.077 (0.116) data 0.001 (0.040) loss 1.7302 (1.8200) ce_loss 0.9707 (0.9459) loss_zs_kd 1.9413 (1.9105) loss_oracle 0.4706 (0.5204) acc 59.3750 (65.9896) kd_loss 0.5242 (0.6139) lr 1.5358e-03 eta 0:28:14
epoch [18/50] batch [80/445] time 0.089 (0.109) data 0.000 (0.030) loss 1.8063 (1.8202) ce_loss 1.0459 (0.9549) loss_zs_kd 1.8123 (1.9272) loss_oracle 0.4962 (0.5196) acc 59.3750 (65.6641) kd_loss 0.5123 (0.6055) lr 1.5358e-03 eta 0:26:26
epoch [18/50] batch [100/445] time 0.084 (0.104) data 0.000 (0.024) loss 2.0120 (1.8287) ce_loss 1.0850 (0.9613) loss_zs_kd 2.0162 (1.9412) loss_oracle 0.5152 (0.5172) acc 46.8750 (64.9375) kd_loss 0.6695 (0.6088) lr 1.5358e-03 eta 0:25:15
epoch [18/50] batch [120/445] time 0.081 (0.100) data 0.000 (0.020) loss 1.7751 (1.8232) ce_loss 1.0625 (0.9577) loss_zs_kd 2.5292 (1.9277) loss_oracle 0.4115 (0.5162) acc 56.2500 (65.4688) kd_loss 0.5069 (0.6074) lr 1.5358e-03 eta 0:24:19
epoch [18/50] batch [140/445] time 0.069 (0.097) data 0.000 (0.017) loss 1.4700 (1.8057) ce_loss 0.5479 (0.9436) loss_zs_kd 2.2302 (1.9413) loss_oracle 0.5615 (0.5110) acc 84.3750 (65.9598) kd_loss 0.6414 (0.6065) lr 1.5358e-03 eta 0:23:30
epoch [18/50] batch [160/445] time 0.072 (0.095) data 0.000 (0.015) loss 1.4243 (1.7975) ce_loss 0.6191 (0.9371) loss_zs_kd 2.1842 (1.9369) loss_oracle 0.4461 (0.5103) acc 75.0000 (66.3477) kd_loss 0.5821 (0.6052) lr 1.5358e-03 eta 0:22:57
epoch [18/50] batch [180/445] time 0.088 (0.093) data 0.000 (0.013) loss 1.7273 (1.7968) ce_loss 0.7461 (0.9335) loss_zs_kd 1.9373 (1.9406) loss_oracle 0.6077 (0.5149) acc 71.8750 (66.4062) kd_loss 0.6773 (0.6058) lr 1.5358e-03 eta 0:22:32
epoch [18/50] batch [200/445] time 0.090 (0.093) data 0.000 (0.012) loss 1.5794 (1.7948) ce_loss 0.7705 (0.9328) loss_zs_kd 2.2349 (1.9324) loss_oracle 0.5360 (0.5128) acc 68.7500 (66.5156) kd_loss 0.5409 (0.6056) lr 1.5358e-03 eta 0:22:20
epoch [18/50] batch [220/445] time 0.085 (0.091) data 0.000 (0.011) loss 1.3661 (1.7963) ce_loss 0.5708 (0.9331) loss_zs_kd 2.0326 (1.9514) loss_oracle 0.4982 (0.5149) acc 84.3750 (66.5483) kd_loss 0.5462 (0.6058) lr 1.5358e-03 eta 0:22:01
epoch [18/50] batch [240/445] time 0.084 (0.091) data 0.000 (0.010) loss 1.5635 (1.7975) ce_loss 0.7686 (0.9325) loss_zs_kd 1.7888 (1.9495) loss_oracle 0.4559 (0.5153) acc 62.5000 (66.6276) kd_loss 0.5670 (0.6074) lr 1.5358e-03 eta 0:21:51
epoch [18/50] batch [260/445] time 0.078 (0.090) data 0.000 (0.009) loss 1.8634 (1.7951) ce_loss 1.0303 (0.9257) loss_zs_kd 1.8595 (1.9474) loss_oracle 0.3314 (0.5155) acc 68.7500 (66.7909) kd_loss 0.6675 (0.6117) lr 1.5358e-03 eta 0:21:43
epoch [18/50] batch [280/445] time 0.086 (0.090) data 0.000 (0.009) loss 2.0140 (1.7944) ce_loss 1.0420 (0.9222) loss_zs_kd 1.8378 (1.9456) loss_oracle 0.5410 (0.5148) acc 62.5000 (66.8304) kd_loss 0.7015 (0.6148) lr 1.5358e-03 eta 0:21:36
epoch [18/50] batch [300/445] time 0.087 (0.090) data 0.000 (0.008) loss 1.6802 (1.7946) ce_loss 0.7041 (0.9201) loss_zs_kd 1.6909 (1.9429) loss_oracle 0.5174 (0.5142) acc 71.8750 (66.8646) kd_loss 0.7174 (0.6174) lr 1.5358e-03 eta 0:21:28
epoch [18/50] batch [320/445] time 0.076 (0.089) data 0.000 (0.008) loss 1.7284 (1.7995) ce_loss 0.8154 (0.9206) loss_zs_kd 2.0201 (1.9463) loss_oracle 0.4594 (0.5148) acc 68.7500 (66.9238) kd_loss 0.6833 (0.6214) lr 1.5358e-03 eta 0:21:16
epoch [18/50] batch [340/445] time 0.080 (0.088) data 0.000 (0.007) loss 1.9419 (1.8034) ce_loss 1.1377 (0.9206) loss_zs_kd 2.5549 (1.9478) loss_oracle 0.4790 (0.5133) acc 56.2500 (67.0129) kd_loss 0.5648 (0.6261) lr 1.5358e-03 eta 0:21:09
epoch [18/50] batch [360/445] time 0.079 (0.088) data 0.000 (0.007) loss 1.8586 (1.8085) ce_loss 0.8589 (0.9224) loss_zs_kd 1.8910 (1.9482) loss_oracle 0.5151 (0.5129) acc 65.6250 (66.9531) kd_loss 0.7421 (0.6297) lr 1.5358e-03 eta 0:21:00
epoch [18/50] batch [380/445] time 0.085 (0.088) data 0.000 (0.007) loss 1.8705 (1.8157) ce_loss 0.8926 (0.9255) loss_zs_kd 2.2882 (1.9509) loss_oracle 0.5482 (0.5138) acc 68.7500 (66.8092) kd_loss 0.7039 (0.6333) lr 1.5358e-03 eta 0:20:52
epoch [18/50] batch [400/445] time 0.086 (0.087) data 0.000 (0.006) loss 1.6709 (1.8150) ce_loss 0.8945 (0.9232) loss_zs_kd 1.5996 (1.9478) loss_oracle 0.4352 (0.5125) acc 62.5000 (66.8594) kd_loss 0.5588 (0.6355) lr 1.5358e-03 eta 0:20:48
epoch [18/50] batch [420/445] time 0.082 (0.087) data 0.000 (0.006) loss 1.8659 (1.8163) ce_loss 0.8584 (0.9211) loss_zs_kd 1.7191 (1.9468) loss_oracle 0.5301 (0.5129) acc 71.8750 (66.9122) kd_loss 0.7424 (0.6387) lr 1.5358e-03 eta 0:20:45
epoch [18/50] batch [440/445] time 0.079 (0.087) data 0.000 (0.006) loss 1.8768 (1.8177) ce_loss 0.8604 (0.9185) loss_zs_kd 2.0167 (1.9498) loss_oracle 0.5568 (0.5128) acc 62.5000 (67.0739) kd_loss 0.7380 (0.6428) lr 1.5358e-03 eta 0:20:41
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,318
* accuracy: 70.7%
* error: 29.3%
* macro_f1: 57.9%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,984
* accuracy: 50.0%
* error: 50.0%
* macro_f1: 32.5%
******* Domain 3 best val acc:      71.3%, epoch: 16 *******
******* Domain 3 best val test acc: 51.0%, epoch: 16 *******
******* Domain 3 best test acc:     53.0%, epoch: 14 *******
epoch [19/50] batch [20/445] time 0.075 (0.215) data 0.000 (0.125) loss 1.4716 (1.8274) ce_loss 0.5864 (0.8849) loss_zs_kd 2.1474 (1.8861) loss_oracle 0.4171 (0.4990) acc 87.5000 (69.6875) kd_loss 0.6766 (0.6931) lr 1.4818e-03 eta 0:51:02
epoch [19/50] batch [40/445] time 0.105 (0.150) data 0.000 (0.063) loss 1.9490 (1.8667) ce_loss 1.1387 (0.9263) loss_zs_kd 2.3428 (1.9382) loss_oracle 0.4669 (0.5076) acc 65.6250 (67.9688) kd_loss 0.5769 (0.6865) lr 1.4818e-03 eta 0:35:33
epoch [19/50] batch [60/445] time 0.086 (0.127) data 0.000 (0.042) loss 1.3061 (1.8544) ce_loss 0.5098 (0.9186) loss_zs_kd 2.1905 (1.9664) loss_oracle 0.4085 (0.5086) acc 90.6250 (68.1250) kd_loss 0.5921 (0.6815) lr 1.4818e-03 eta 0:30:03
epoch [19/50] batch [80/445] time 0.084 (0.115) data 0.001 (0.032) loss 1.7243 (1.8573) ce_loss 0.8159 (0.9179) loss_zs_kd 1.6896 (1.9223) loss_oracle 0.4363 (0.5030) acc 68.7500 (68.0078) kd_loss 0.6903 (0.6880) lr 1.4818e-03 eta 0:27:12
epoch [19/50] batch [100/445] time 0.086 (0.109) data 0.000 (0.025) loss 1.6088 (1.8618) ce_loss 0.6587 (0.9199) loss_zs_kd 2.0678 (1.9111) loss_oracle 0.5375 (0.5018) acc 78.1250 (67.8125) kd_loss 0.6814 (0.6910) lr 1.4818e-03 eta 0:25:41
epoch [19/50] batch [120/445] time 0.084 (0.105) data 0.000 (0.021) loss 2.1605 (1.8710) ce_loss 1.1045 (0.9270) loss_zs_kd 1.9002 (1.9041) loss_oracle 0.5545 (0.5004) acc 68.7500 (67.4219) kd_loss 0.7788 (0.6938) lr 1.4818e-03 eta 0:24:36
epoch [19/50] batch [140/445] time 0.077 (0.101) data 0.000 (0.018) loss 1.9143 (1.8630) ce_loss 0.9775 (0.9202) loss_zs_kd 1.8086 (1.9040) loss_oracle 0.4397 (0.5003) acc 71.8750 (67.6562) kd_loss 0.7170 (0.6926) lr 1.4818e-03 eta 0:23:43
epoch [19/50] batch [160/445] time 0.074 (0.098) data 0.000 (0.016) loss 1.8697 (1.8673) ce_loss 0.8149 (0.9207) loss_zs_kd 2.0401 (1.9184) loss_oracle 0.4737 (0.4982) acc 68.7500 (67.4609) kd_loss 0.8179 (0.6975) lr 1.4818e-03 eta 0:23:04
epoch [19/50] batch [180/445] time 0.082 (0.096) data 0.000 (0.014) loss 2.0666 (1.8680) ce_loss 1.0879 (0.9199) loss_zs_kd 2.0120 (1.9213) loss_oracle 0.5460 (0.5004) acc 56.2500 (67.5694) kd_loss 0.7057 (0.6979) lr 1.4818e-03 eta 0:22:35
epoch [19/50] batch [200/445] time 0.085 (0.095) data 0.000 (0.013) loss 1.9107 (1.8643) ce_loss 0.9980 (0.9168) loss_zs_kd 2.3170 (1.9219) loss_oracle 0.4987 (0.5008) acc 65.6250 (67.6406) kd_loss 0.6634 (0.6971) lr 1.4818e-03 eta 0:22:13
epoch [19/50] batch [220/445] time 0.084 (0.094) data 0.000 (0.012) loss 1.6815 (1.8601) ce_loss 0.7246 (0.9144) loss_zs_kd 1.9940 (1.9207) loss_oracle 0.4127 (0.4992) acc 78.1250 (67.5852) kd_loss 0.7506 (0.6962) lr 1.4818e-03 eta 0:21:57
epoch [19/50] batch [240/445] time 0.087 (0.093) data 0.000 (0.011) loss 2.2434 (1.8592) ce_loss 1.2461 (0.9181) loss_zs_kd 2.0772 (1.9226) loss_oracle 0.5253 (0.4966) acc 59.3750 (67.5000) kd_loss 0.7347 (0.6928) lr 1.4818e-03 eta 0:21:45
epoch [19/50] batch [260/445] time 0.083 (0.093) data 0.000 (0.010) loss 1.6162 (1.8588) ce_loss 0.8223 (0.9188) loss_zs_kd 2.1459 (1.9133) loss_oracle 0.4494 (0.4956) acc 68.7500 (67.5000) kd_loss 0.5693 (0.6922) lr 1.4818e-03 eta 0:21:33
epoch [19/50] batch [280/445] time 0.082 (0.092) data 0.000 (0.009) loss 1.7348 (1.8572) ce_loss 0.8687 (0.9173) loss_zs_kd 1.7217 (1.9196) loss_oracle 0.4502 (0.4958) acc 65.6250 (67.5000) kd_loss 0.6410 (0.6920) lr 1.4818e-03 eta 0:21:23
epoch [19/50] batch [300/445] time 0.091 (0.091) data 0.000 (0.009) loss 1.7345 (1.8545) ce_loss 0.8545 (0.9167) loss_zs_kd 1.8636 (1.9241) loss_oracle 0.4286 (0.4945) acc 65.6250 (67.5521) kd_loss 0.6657 (0.6905) lr 1.4818e-03 eta 0:21:13
epoch [19/50] batch [320/445] time 0.093 (0.091) data 0.000 (0.008) loss 1.7978 (1.8523) ce_loss 0.8257 (0.9155) loss_zs_kd 1.6791 (1.9171) loss_oracle 0.3872 (0.4933) acc 75.0000 (67.5781) kd_loss 0.7786 (0.6902) lr 1.4818e-03 eta 0:21:02
epoch [19/50] batch [340/445] time 0.081 (0.090) data 0.000 (0.008) loss 1.6460 (1.8548) ce_loss 0.7944 (0.9192) loss_zs_kd 2.2863 (1.9219) loss_oracle 0.4399 (0.4940) acc 71.8750 (67.3162) kd_loss 0.6316 (0.6886) lr 1.4818e-03 eta 0:20:52
epoch [19/50] batch [360/445] time 0.091 (0.090) data 0.000 (0.007) loss 1.8086 (1.8539) ce_loss 0.9116 (0.9193) loss_zs_kd 2.3130 (1.9292) loss_oracle 0.4935 (0.4928) acc 62.5000 (67.3351) kd_loss 0.6503 (0.6882) lr 1.4818e-03 eta 0:20:45
epoch [19/50] batch [380/445] time 0.076 (0.089) data 0.000 (0.007) loss 1.7474 (1.8542) ce_loss 0.8818 (0.9198) loss_zs_kd 1.8514 (1.9226) loss_oracle 0.5133 (0.4922) acc 65.6250 (67.3026) kd_loss 0.6089 (0.6883) lr 1.4818e-03 eta 0:20:35
epoch [19/50] batch [400/445] time 0.061 (0.088) data 0.000 (0.007) loss 2.0098 (1.8564) ce_loss 1.0312 (0.9223) loss_zs_kd 2.0102 (1.9192) loss_oracle 0.5436 (0.4916) acc 68.7500 (67.2031) kd_loss 0.7068 (0.6883) lr 1.4818e-03 eta 0:20:15
epoch [19/50] batch [420/445] time 0.070 (0.087) data 0.000 (0.006) loss 1.6084 (1.8558) ce_loss 0.5425 (0.9216) loss_zs_kd 1.8569 (1.9217) loss_oracle 0.4890 (0.4916) acc 87.5000 (67.2842) kd_loss 0.8214 (0.6884) lr 1.4818e-03 eta 0:19:56
epoch [19/50] batch [440/445] time 0.078 (0.086) data 0.000 (0.006) loss 2.1183 (1.8577) ce_loss 1.2705 (0.9240) loss_zs_kd 2.6019 (1.9260) loss_oracle 0.4803 (0.4914) acc 50.0000 (67.2159) kd_loss 0.6077 (0.6880) lr 1.4818e-03 eta 0:19:41
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,345
* accuracy: 71.1%
* error: 28.9%
* macro_f1: 59.6%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,987
* accuracy: 50.1%
* error: 49.9%
* macro_f1: 33.0%
******* Domain 3 best val acc:      71.3%, epoch: 16 *******
******* Domain 3 best val test acc: 51.0%, epoch: 16 *******
******* Domain 3 best test acc:     53.0%, epoch: 14 *******
epoch [20/50] batch [20/445] time 0.076 (0.220) data 0.000 (0.137) loss 1.6064 (1.7776) ce_loss 0.7246 (0.8709) loss_zs_kd 2.2140 (1.9473) loss_oracle 0.4827 (0.4702) acc 71.8750 (69.8438) kd_loss 0.6405 (0.6716) lr 1.4258e-03 eta 0:50:30
epoch [20/50] batch [40/445] time 0.084 (0.151) data 0.000 (0.068) loss 1.7885 (1.8055) ce_loss 0.8833 (0.9092) loss_zs_kd 2.2908 (1.9752) loss_oracle 0.4732 (0.4642) acc 68.7500 (67.0312) kd_loss 0.6686 (0.6642) lr 1.4258e-03 eta 0:34:32
epoch [20/50] batch [60/445] time 0.084 (0.128) data 0.000 (0.046) loss 1.7043 (1.8009) ce_loss 0.8984 (0.9017) loss_zs_kd 1.9437 (1.9461) loss_oracle 0.3572 (0.4686) acc 71.8750 (67.8646) kd_loss 0.6272 (0.6649) lr 1.4258e-03 eta 0:29:21
epoch [20/50] batch [80/445] time 0.080 (0.116) data 0.000 (0.034) loss 1.7933 (1.7841) ce_loss 0.8696 (0.8908) loss_zs_kd 1.6013 (1.9392) loss_oracle 0.5204 (0.4700) acc 65.6250 (68.1250) kd_loss 0.6635 (0.6582) lr 1.4258e-03 eta 0:26:34
epoch [20/50] batch [100/445] time 0.090 (0.110) data 0.000 (0.028) loss 1.5918 (1.7814) ce_loss 0.6187 (0.8894) loss_zs_kd 2.1256 (1.9403) loss_oracle 0.5061 (0.4714) acc 78.1250 (67.9375) kd_loss 0.7201 (0.6563) lr 1.4258e-03 eta 0:25:05
epoch [20/50] batch [120/445] time 0.078 (0.105) data 0.000 (0.023) loss 1.8401 (1.7883) ce_loss 0.9653 (0.9048) loss_zs_kd 1.9595 (1.9280) loss_oracle 0.6134 (0.4714) acc 75.0000 (67.7344) kd_loss 0.5681 (0.6478) lr 1.4258e-03 eta 0:23:54
epoch [20/50] batch [140/445] time 0.076 (0.102) data 0.000 (0.020) loss 1.8284 (1.7852) ce_loss 1.0996 (0.9071) loss_zs_kd 2.0930 (1.9346) loss_oracle 0.3672 (0.4682) acc 65.6250 (67.7455) kd_loss 0.5452 (0.6440) lr 1.4258e-03 eta 0:23:07
epoch [20/50] batch [160/445] time 0.065 (0.099) data 0.000 (0.017) loss 2.3030 (1.7840) ce_loss 1.3740 (0.9107) loss_zs_kd 1.9060 (1.9414) loss_oracle 0.4929 (0.4685) acc 46.8750 (67.4023) kd_loss 0.6825 (0.6391) lr 1.4258e-03 eta 0:22:29
epoch [20/50] batch [180/445] time 0.088 (0.097) data 0.000 (0.015) loss 1.6870 (1.7795) ce_loss 0.8110 (0.9101) loss_zs_kd 2.0456 (1.9284) loss_oracle 0.4775 (0.4682) acc 68.7500 (67.6215) kd_loss 0.6373 (0.6352) lr 1.4258e-03 eta 0:22:02
epoch [20/50] batch [200/445] time 0.089 (0.096) data 0.000 (0.014) loss 1.7176 (1.7783) ce_loss 0.8560 (0.9110) loss_zs_kd 2.1997 (1.9396) loss_oracle 0.5337 (0.4695) acc 75.0000 (67.7344) kd_loss 0.5948 (0.6326) lr 1.4258e-03 eta 0:21:45
epoch [20/50] batch [220/445] time 0.083 (0.095) data 0.000 (0.013) loss 1.8092 (1.7757) ce_loss 1.0010 (0.9116) loss_zs_kd 2.1110 (1.9497) loss_oracle 0.4369 (0.4696) acc 62.5000 (67.6989) kd_loss 0.5898 (0.6292) lr 1.4258e-03 eta 0:21:26
epoch [20/50] batch [240/445] time 0.074 (0.094) data 0.000 (0.012) loss 1.8807 (1.7808) ce_loss 0.9727 (0.9175) loss_zs_kd 1.9265 (1.9548) loss_oracle 0.4586 (0.4707) acc 68.7500 (67.3438) kd_loss 0.6787 (0.6280) lr 1.4258e-03 eta 0:21:13
epoch [20/50] batch [260/445] time 0.085 (0.093) data 0.000 (0.011) loss 1.6498 (1.7790) ce_loss 0.7778 (0.9153) loss_zs_kd 1.9085 (1.9492) loss_oracle 0.4743 (0.4682) acc 68.7500 (67.3317) kd_loss 0.6348 (0.6296) lr 1.4258e-03 eta 0:20:55
epoch [20/50] batch [280/445] time 0.080 (0.092) data 0.000 (0.010) loss 1.9400 (1.7863) ce_loss 1.0176 (0.9216) loss_zs_kd 1.8573 (1.9457) loss_oracle 0.4933 (0.4676) acc 53.1250 (67.1317) kd_loss 0.6757 (0.6309) lr 1.4258e-03 eta 0:20:44
epoch [20/50] batch [300/445] time 0.087 (0.091) data 0.000 (0.009) loss 1.4684 (1.7864) ce_loss 0.5742 (0.9201) loss_zs_kd 2.0931 (1.9485) loss_oracle 0.4971 (0.4687) acc 81.2500 (67.2396) kd_loss 0.6456 (0.6320) lr 1.4258e-03 eta 0:20:31
epoch [20/50] batch [320/445] time 0.083 (0.091) data 0.000 (0.009) loss 1.5066 (1.7837) ce_loss 0.6040 (0.9158) loss_zs_kd 1.7999 (1.9563) loss_oracle 0.4779 (0.4684) acc 71.8750 (67.3438) kd_loss 0.6636 (0.6337) lr 1.4258e-03 eta 0:20:21
epoch [20/50] batch [340/445] time 0.081 (0.090) data 0.000 (0.008) loss 1.7355 (1.7818) ce_loss 0.8413 (0.9128) loss_zs_kd 1.9757 (1.9513) loss_oracle 0.3987 (0.4689) acc 65.6250 (67.4265) kd_loss 0.6948 (0.6346) lr 1.4258e-03 eta 0:20:15
epoch [20/50] batch [360/445] time 0.090 (0.090) data 0.000 (0.008) loss 2.0500 (1.7838) ce_loss 1.0918 (0.9133) loss_zs_kd 1.6945 (1.9506) loss_oracle 0.4345 (0.4679) acc 65.6250 (67.4653) kd_loss 0.7409 (0.6366) lr 1.4258e-03 eta 0:20:09
epoch [20/50] batch [380/445] time 0.083 (0.090) data 0.000 (0.007) loss 1.8240 (1.7879) ce_loss 0.9248 (0.9160) loss_zs_kd 1.5968 (1.9499) loss_oracle 0.4366 (0.4671) acc 53.1250 (67.3602) kd_loss 0.6809 (0.6384) lr 1.4258e-03 eta 0:20:03
epoch [20/50] batch [400/445] time 0.093 (0.089) data 0.000 (0.007) loss 1.8018 (1.7854) ce_loss 0.9673 (0.9140) loss_zs_kd 2.0135 (1.9490) loss_oracle 0.4586 (0.4666) acc 68.7500 (67.3672) kd_loss 0.6052 (0.6381) lr 1.4258e-03 eta 0:19:58
epoch [20/50] batch [420/445] time 0.085 (0.089) data 0.000 (0.007) loss 1.7168 (1.7859) ce_loss 0.9336 (0.9137) loss_zs_kd 2.0209 (1.9508) loss_oracle 0.4037 (0.4670) acc 62.5000 (67.3958) kd_loss 0.5814 (0.6387) lr 1.4258e-03 eta 0:19:51
epoch [20/50] batch [440/445] time 0.078 (0.089) data 0.000 (0.006) loss 1.6191 (1.7854) ce_loss 0.8623 (0.9131) loss_zs_kd 1.5323 (1.9539) loss_oracle 0.4400 (0.4675) acc 75.0000 (67.4574) kd_loss 0.5368 (0.6385) lr 1.4258e-03 eta 0:19:44
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,350
* accuracy: 71.2%
* error: 28.8%
* macro_f1: 58.1%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,910
* accuracy: 48.1%
* error: 51.9%
* macro_f1: 31.0%
******* Domain 3 best val acc:      71.3%, epoch: 16 *******
******* Domain 3 best val test acc: 51.0%, epoch: 16 *******
******* Domain 3 best test acc:     53.0%, epoch: 14 *******
epoch [21/50] batch [20/445] time 0.081 (0.217) data 0.000 (0.126) loss 1.7856 (1.8335) ce_loss 0.8853 (0.9338) loss_zs_kd 2.3175 (2.0622) loss_oracle 0.4747 (0.4936) acc 68.7500 (66.7188) kd_loss 0.6630 (0.6529) lr 1.3681e-03 eta 0:48:12
epoch [21/50] batch [40/445] time 0.085 (0.151) data 0.000 (0.063) loss 1.7192 (1.8157) ce_loss 0.8135 (0.9184) loss_zs_kd 1.7494 (2.0481) loss_oracle 0.4840 (0.5066) acc 75.0000 (67.5781) kd_loss 0.6638 (0.6440) lr 1.3681e-03 eta 0:33:28
epoch [21/50] batch [60/445] time 0.085 (0.129) data 0.001 (0.042) loss 2.0431 (1.8279) ce_loss 1.1650 (0.9262) loss_zs_kd 1.7739 (1.9908) loss_oracle 0.5119 (0.5089) acc 56.2500 (67.0833) kd_loss 0.6221 (0.6472) lr 1.3681e-03 eta 0:28:34
epoch [21/50] batch [80/445] time 0.086 (0.117) data 0.000 (0.032) loss 1.7999 (1.8101) ce_loss 0.8999 (0.9116) loss_zs_kd 1.6897 (1.9760) loss_oracle 0.4610 (0.5030) acc 71.8750 (68.1250) kd_loss 0.6695 (0.6470) lr 1.3681e-03 eta 0:25:54
epoch [21/50] batch [100/445] time 0.081 (0.110) data 0.000 (0.025) loss 1.9211 (1.8017) ce_loss 0.9692 (0.9079) loss_zs_kd 2.0172 (2.0006) loss_oracle 0.5394 (0.5029) acc 71.8750 (68.0938) kd_loss 0.6822 (0.6423) lr 1.3681e-03 eta 0:24:23
epoch [21/50] batch [120/445] time 0.085 (0.106) data 0.000 (0.021) loss 2.1392 (1.8102) ce_loss 1.1514 (0.9141) loss_zs_kd 1.8786 (1.9935) loss_oracle 0.5731 (0.5053) acc 65.6250 (68.0729) kd_loss 0.7013 (0.6435) lr 1.3681e-03 eta 0:23:19
epoch [21/50] batch [140/445] time 0.082 (0.103) data 0.000 (0.018) loss 1.6949 (1.8093) ce_loss 0.8652 (0.9124) loss_zs_kd 1.8566 (1.9889) loss_oracle 0.5686 (0.5089) acc 75.0000 (68.1250) kd_loss 0.5453 (0.6425) lr 1.3681e-03 eta 0:22:36
epoch [21/50] batch [160/445] time 0.084 (0.100) data 0.000 (0.016) loss 1.6740 (1.8112) ce_loss 0.7900 (0.9157) loss_zs_kd 2.0266 (1.9839) loss_oracle 0.5684 (0.5081) acc 71.8750 (68.0273) kd_loss 0.5998 (0.6415) lr 1.3681e-03 eta 0:22:01
epoch [21/50] batch [180/445] time 0.080 (0.098) data 0.000 (0.014) loss 1.5049 (1.8095) ce_loss 0.7051 (0.9182) loss_zs_kd 1.7797 (1.9762) loss_oracle 0.4582 (0.5048) acc 71.8750 (67.8819) kd_loss 0.5707 (0.6390) lr 1.3681e-03 eta 0:21:34
epoch [21/50] batch [200/445] time 0.083 (0.097) data 0.000 (0.013) loss 1.6319 (1.8123) ce_loss 0.9214 (0.9271) loss_zs_kd 1.3212 (1.9555) loss_oracle 0.4362 (0.5010) acc 65.6250 (67.2969) kd_loss 0.4924 (0.6347) lr 1.3681e-03 eta 0:21:13
epoch [21/50] batch [220/445] time 0.072 (0.095) data 0.000 (0.012) loss 1.5528 (1.8056) ce_loss 0.7349 (0.9226) loss_zs_kd 2.7593 (1.9549) loss_oracle 0.5320 (0.5003) acc 78.1250 (67.5994) kd_loss 0.5520 (0.6329) lr 1.3681e-03 eta 0:20:53
epoch [21/50] batch [240/445] time 0.088 (0.094) data 0.000 (0.011) loss 1.6617 (1.8036) ce_loss 0.7690 (0.9223) loss_zs_kd 2.2699 (1.9593) loss_oracle 0.4843 (0.4996) acc 75.0000 (67.5651) kd_loss 0.6505 (0.6316) lr 1.3681e-03 eta 0:20:35
epoch [21/50] batch [260/445] time 0.085 (0.094) data 0.000 (0.010) loss 1.7233 (1.7947) ce_loss 0.7832 (0.9178) loss_zs_kd 1.9794 (1.9680) loss_oracle 0.5690 (0.4984) acc 71.8750 (67.7043) kd_loss 0.6556 (0.6277) lr 1.3681e-03 eta 0:20:27
epoch [21/50] batch [280/445] time 0.093 (0.093) data 0.000 (0.009) loss 1.9303 (1.7942) ce_loss 1.0225 (0.9156) loss_zs_kd 1.4261 (1.9696) loss_oracle 0.5366 (0.4996) acc 68.7500 (67.7679) kd_loss 0.6396 (0.6288) lr 1.3681e-03 eta 0:20:13
epoch [21/50] batch [300/445] time 0.085 (0.092) data 0.000 (0.009) loss 2.1079 (1.7934) ce_loss 1.0996 (0.9151) loss_zs_kd 1.9141 (1.9662) loss_oracle 0.5331 (0.4991) acc 62.5000 (67.7083) kd_loss 0.7418 (0.6288) lr 1.3681e-03 eta 0:20:04
epoch [21/50] batch [320/445] time 0.078 (0.092) data 0.000 (0.008) loss 1.7659 (1.7922) ce_loss 0.9390 (0.9152) loss_zs_kd 2.4886 (1.9685) loss_oracle 0.5042 (0.4994) acc 59.3750 (67.6465) kd_loss 0.5749 (0.6273) lr 1.3681e-03 eta 0:19:52
epoch [21/50] batch [340/445] time 0.093 (0.091) data 0.000 (0.008) loss 1.9665 (1.7905) ce_loss 1.0928 (0.9143) loss_zs_kd 2.5865 (1.9738) loss_oracle 0.5043 (0.4995) acc 65.6250 (67.7022) kd_loss 0.6216 (0.6265) lr 1.3681e-03 eta 0:19:45
epoch [21/50] batch [360/445] time 0.064 (0.091) data 0.000 (0.007) loss 1.9898 (1.7911) ce_loss 1.0957 (0.9144) loss_zs_kd 1.8915 (1.9703) loss_oracle 0.5053 (0.4991) acc 53.1250 (67.7170) kd_loss 0.6414 (0.6271) lr 1.3681e-03 eta 0:19:37
epoch [21/50] batch [380/445] time 0.082 (0.090) data 0.000 (0.007) loss 1.7667 (1.7881) ce_loss 0.9214 (0.9130) loss_zs_kd 2.9325 (1.9770) loss_oracle 0.5605 (0.4990) acc 78.1250 (67.7220) kd_loss 0.5650 (0.6256) lr 1.3681e-03 eta 0:19:28
epoch [21/50] batch [400/445] time 0.080 (0.090) data 0.000 (0.007) loss 1.4327 (1.7836) ce_loss 0.5796 (0.9099) loss_zs_kd 1.7225 (1.9783) loss_oracle 0.4016 (0.4984) acc 75.0000 (67.7578) kd_loss 0.6523 (0.6245) lr 1.3681e-03 eta 0:19:22
epoch [21/50] batch [420/445] time 0.087 (0.089) data 0.000 (0.006) loss 2.0918 (1.7850) ce_loss 1.3008 (0.9132) loss_zs_kd 2.2024 (1.9783) loss_oracle 0.4429 (0.4976) acc 53.1250 (67.6414) kd_loss 0.5696 (0.6230) lr 1.3681e-03 eta 0:19:15
epoch [21/50] batch [440/445] time 0.077 (0.089) data 0.000 (0.006) loss 1.8345 (1.7815) ce_loss 0.8623 (0.9112) loss_zs_kd 2.0523 (1.9768) loss_oracle 0.6694 (0.4971) acc 53.1250 (67.6491) kd_loss 0.6375 (0.6217) lr 1.3681e-03 eta 0:19:09
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,281
* accuracy: 70.1%
* error: 29.9%
* macro_f1: 58.3%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,113
* accuracy: 53.2%
* error: 46.8%
* macro_f1: 34.3%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      71.3%, epoch: 16 *******
******* Domain 3 best val test acc: 51.0%, epoch: 16 *******
******* Domain 3 best test acc:     53.2%, epoch: 21 *******
epoch [22/50] batch [20/445] time 0.058 (0.228) data 0.000 (0.167) loss 1.6636 (1.7194) ce_loss 0.8428 (0.8561) loss_zs_kd 1.9583 (1.9562) loss_oracle 0.4880 (0.4924) acc 68.7500 (69.0625) kd_loss 0.5768 (0.6171) lr 1.3090e-03 eta 0:48:59
epoch [22/50] batch [40/445] time 0.059 (0.144) data 0.000 (0.084) loss 1.5281 (1.7678) ce_loss 0.7998 (0.9091) loss_zs_kd 2.0099 (1.9341) loss_oracle 0.4354 (0.4927) acc 65.6250 (67.6562) kd_loss 0.5105 (0.6124) lr 1.3090e-03 eta 0:30:57
epoch [22/50] batch [60/445] time 0.084 (0.122) data 0.000 (0.056) loss 1.7276 (1.7836) ce_loss 0.8857 (0.9265) loss_zs_kd 1.7444 (1.9136) loss_oracle 0.4439 (0.5004) acc 75.0000 (67.5000) kd_loss 0.6199 (0.6069) lr 1.3090e-03 eta 0:26:13
epoch [22/50] batch [80/445] time 0.081 (0.112) data 0.000 (0.042) loss 1.6759 (1.7895) ce_loss 0.7979 (0.9287) loss_zs_kd 1.6408 (1.9072) loss_oracle 0.5794 (0.4974) acc 68.7500 (67.3828) kd_loss 0.5883 (0.6121) lr 1.3090e-03 eta 0:24:02
epoch [22/50] batch [100/445] time 0.091 (0.107) data 0.000 (0.034) loss 1.6243 (1.7944) ce_loss 0.8389 (0.9295) loss_zs_kd 1.4966 (1.9165) loss_oracle 0.3907 (0.5001) acc 71.8750 (66.9375) kd_loss 0.5901 (0.6149) lr 1.3090e-03 eta 0:22:49
epoch [22/50] batch [120/445] time 0.086 (0.103) data 0.000 (0.028) loss 1.7595 (1.7955) ce_loss 1.0049 (0.9290) loss_zs_kd 1.7319 (1.9236) loss_oracle 0.4619 (0.4988) acc 62.5000 (67.0312) kd_loss 0.5237 (0.6171) lr 1.3090e-03 eta 0:22:03
epoch [22/50] batch [140/445] time 0.087 (0.101) data 0.000 (0.024) loss 1.8656 (1.8055) ce_loss 1.0674 (0.9366) loss_zs_kd 2.0474 (1.9293) loss_oracle 0.5393 (0.4991) acc 50.0000 (66.7411) kd_loss 0.5285 (0.6193) lr 1.3090e-03 eta 0:21:28
epoch [22/50] batch [160/445] time 0.086 (0.099) data 0.000 (0.021) loss 1.8877 (1.8054) ce_loss 0.9272 (0.9353) loss_zs_kd 2.0148 (1.9258) loss_oracle 0.5704 (0.4993) acc 56.2500 (66.8164) kd_loss 0.6753 (0.6205) lr 1.3090e-03 eta 0:21:02
epoch [22/50] batch [180/445] time 0.088 (0.098) data 0.000 (0.019) loss 1.6916 (1.8037) ce_loss 0.8037 (0.9345) loss_zs_kd 1.9316 (1.9304) loss_oracle 0.5152 (0.4985) acc 75.0000 (66.8576) kd_loss 0.6303 (0.6200) lr 1.3090e-03 eta 0:20:45
epoch [22/50] batch [200/445] time 0.077 (0.096) data 0.000 (0.017) loss 1.6901 (1.8029) ce_loss 0.8423 (0.9314) loss_zs_kd 2.1024 (1.9365) loss_oracle 0.4344 (0.4985) acc 68.7500 (66.9375) kd_loss 0.6306 (0.6223) lr 1.3090e-03 eta 0:20:21
epoch [22/50] batch [220/445] time 0.087 (0.095) data 0.000 (0.015) loss 1.5897 (1.8038) ce_loss 0.8359 (0.9303) loss_zs_kd 1.8132 (1.9641) loss_oracle 0.4000 (0.5015) acc 62.5000 (66.8324) kd_loss 0.5538 (0.6227) lr 1.3090e-03 eta 0:20:01
epoch [22/50] batch [240/445] time 0.077 (0.094) data 0.000 (0.014) loss 1.7514 (1.7996) ce_loss 0.8784 (0.9274) loss_zs_kd 1.6201 (1.9580) loss_oracle 0.5478 (0.5000) acc 75.0000 (66.9401) kd_loss 0.5991 (0.6222) lr 1.3090e-03 eta 0:19:51
epoch [22/50] batch [260/445] time 0.082 (0.093) data 0.000 (0.013) loss 1.8051 (1.7968) ce_loss 1.0117 (0.9236) loss_zs_kd 2.3034 (1.9579) loss_oracle 0.4266 (0.4995) acc 62.5000 (67.1875) kd_loss 0.5801 (0.6234) lr 1.3090e-03 eta 0:19:39
epoch [22/50] batch [280/445] time 0.087 (0.093) data 0.000 (0.012) loss 1.8133 (1.7953) ce_loss 0.9370 (0.9223) loss_zs_kd 2.0287 (1.9679) loss_oracle 0.4469 (0.4983) acc 62.5000 (67.2656) kd_loss 0.6528 (0.6239) lr 1.3090e-03 eta 0:19:28
epoch [22/50] batch [300/445] time 0.082 (0.092) data 0.000 (0.011) loss 2.1717 (1.7944) ce_loss 1.2549 (0.9191) loss_zs_kd 1.9553 (1.9713) loss_oracle 0.4735 (0.4978) acc 50.0000 (67.2917) kd_loss 0.6800 (0.6264) lr 1.3090e-03 eta 0:19:17
epoch [22/50] batch [320/445] time 0.088 (0.091) data 0.000 (0.011) loss 1.6372 (1.7961) ce_loss 0.8218 (0.9189) loss_zs_kd 2.0531 (1.9753) loss_oracle 0.4381 (0.4991) acc 75.0000 (67.3535) kd_loss 0.5964 (0.6277) lr 1.3090e-03 eta 0:19:08
epoch [22/50] batch [340/445] time 0.089 (0.091) data 0.000 (0.010) loss 1.8930 (1.7950) ce_loss 0.9204 (0.9172) loss_zs_kd 2.0298 (1.9842) loss_oracle 0.4980 (0.4982) acc 68.7500 (67.4357) kd_loss 0.7236 (0.6288) lr 1.3090e-03 eta 0:19:03
epoch [22/50] batch [360/445] time 0.083 (0.091) data 0.000 (0.010) loss 1.6613 (1.7924) ce_loss 0.7627 (0.9149) loss_zs_kd 2.3365 (1.9866) loss_oracle 0.4615 (0.4977) acc 71.8750 (67.3785) kd_loss 0.6678 (0.6286) lr 1.3090e-03 eta 0:18:57
epoch [22/50] batch [380/445] time 0.085 (0.090) data 0.000 (0.009) loss 1.6529 (1.7885) ce_loss 0.7876 (0.9123) loss_zs_kd 1.9011 (1.9915) loss_oracle 0.4949 (0.4974) acc 68.7500 (67.4836) kd_loss 0.6179 (0.6275) lr 1.3090e-03 eta 0:18:51
epoch [22/50] batch [400/445] time 0.094 (0.090) data 0.000 (0.009) loss 1.9646 (1.7889) ce_loss 1.0107 (0.9134) loss_zs_kd 1.9549 (1.9916) loss_oracle 0.6197 (0.4971) acc 62.5000 (67.5625) kd_loss 0.6440 (0.6269) lr 1.3090e-03 eta 0:18:46
epoch [22/50] batch [420/445] time 0.082 (0.091) data 0.000 (0.008) loss 1.3516 (1.7885) ce_loss 0.5869 (0.9132) loss_zs_kd 1.8315 (1.9936) loss_oracle 0.4695 (0.4971) acc 81.2500 (67.6339) kd_loss 0.5299 (0.6267) lr 1.3090e-03 eta 0:18:50
epoch [22/50] batch [440/445] time 0.079 (0.090) data 0.000 (0.008) loss 1.9093 (1.7880) ce_loss 0.9546 (0.9137) loss_zs_kd 1.7898 (1.9928) loss_oracle 0.5310 (0.4977) acc 68.7500 (67.6207) kd_loss 0.6892 (0.6255) lr 1.3090e-03 eta 0:18:44
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,379
* accuracy: 71.7%
* error: 28.3%
* macro_f1: 59.8%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,049
* accuracy: 51.6%
* error: 48.4%
* macro_f1: 32.5%
******* Domain 3 best val acc:      71.7%, epoch: 22 *******
******* Domain 3 best val test acc: 51.6%, epoch: 22 *******
******* Domain 3 best test acc:     53.2%, epoch: 21 *******
epoch [23/50] batch [20/445] time 0.068 (0.230) data 0.000 (0.162) loss 1.5679 (1.7374) ce_loss 0.7559 (0.8894) loss_zs_kd 2.3079 (1.9015) loss_oracle 0.4780 (0.4914) acc 78.1250 (67.3438) kd_loss 0.5730 (0.6023) lr 1.2487e-03 eta 0:47:36
epoch [23/50] batch [40/445] time 0.059 (0.147) data 0.000 (0.081) loss 1.7248 (1.7592) ce_loss 0.9292 (0.9110) loss_zs_kd 1.9375 (1.9171) loss_oracle 0.3604 (0.4827) acc 62.5000 (67.4219) kd_loss 0.6154 (0.6069) lr 1.2487e-03 eta 0:30:26
epoch [23/50] batch [60/445] time 0.085 (0.124) data 0.000 (0.054) loss 1.9199 (1.7677) ce_loss 1.0479 (0.9213) loss_zs_kd 1.9978 (1.9466) loss_oracle 0.4868 (0.4836) acc 56.2500 (67.3958) kd_loss 0.6286 (0.6046) lr 1.2487e-03 eta 0:25:36
epoch [23/50] batch [80/445] time 0.083 (0.114) data 0.000 (0.041) loss 1.9006 (1.7639) ce_loss 1.0586 (0.9115) loss_zs_kd 1.8584 (1.9732) loss_oracle 0.4434 (0.4866) acc 59.3750 (67.0703) kd_loss 0.6203 (0.6091) lr 1.2487e-03 eta 0:23:30
epoch [23/50] batch [100/445] time 0.083 (0.108) data 0.000 (0.033) loss 1.4797 (1.7622) ce_loss 0.6143 (0.9067) loss_zs_kd 2.1466 (1.9728) loss_oracle 0.4544 (0.4889) acc 78.1250 (67.4062) kd_loss 0.6382 (0.6110) lr 1.2487e-03 eta 0:22:12
epoch [23/50] batch [120/445] time 0.080 (0.104) data 0.000 (0.027) loss 1.8015 (1.7519) ce_loss 0.8892 (0.8993) loss_zs_kd 1.9557 (1.9925) loss_oracle 0.5284 (0.4858) acc 62.5000 (67.7083) kd_loss 0.6481 (0.6096) lr 1.2487e-03 eta 0:21:20
epoch [23/50] batch [140/445] time 0.082 (0.101) data 0.000 (0.023) loss 1.9431 (1.7529) ce_loss 1.0625 (0.8988) loss_zs_kd 1.8914 (1.9965) loss_oracle 0.4804 (0.4879) acc 65.6250 (67.8571) kd_loss 0.6404 (0.6101) lr 1.2487e-03 eta 0:20:42
epoch [23/50] batch [160/445] time 0.083 (0.098) data 0.000 (0.021) loss 2.1625 (1.7487) ce_loss 1.2910 (0.8977) loss_zs_kd 1.6172 (1.9913) loss_oracle 0.5952 (0.4879) acc 46.8750 (67.8125) kd_loss 0.5739 (0.6071) lr 1.2487e-03 eta 0:20:04
epoch [23/50] batch [180/445] time 0.086 (0.097) data 0.000 (0.018) loss 1.6987 (1.7529) ce_loss 0.9663 (0.9047) loss_zs_kd 1.8741 (1.9966) loss_oracle 0.4041 (0.4843) acc 68.7500 (67.5521) kd_loss 0.5304 (0.6060) lr 1.2487e-03 eta 0:19:47
epoch [23/50] batch [200/445] time 0.089 (0.096) data 0.000 (0.016) loss 1.8584 (1.7561) ce_loss 0.9111 (0.9085) loss_zs_kd 1.8518 (2.0046) loss_oracle 0.5020 (0.4854) acc 71.8750 (67.4531) kd_loss 0.6963 (0.6049) lr 1.2487e-03 eta 0:19:33
epoch [23/50] batch [220/445] time 0.076 (0.094) data 0.000 (0.015) loss 1.7736 (1.7612) ce_loss 0.9863 (0.9126) loss_zs_kd 1.7925 (2.0033) loss_oracle 0.4524 (0.4846) acc 68.7500 (67.2727) kd_loss 0.5611 (0.6063) lr 1.2487e-03 eta 0:19:06
epoch [23/50] batch [240/445] time 0.091 (0.093) data 0.000 (0.014) loss 2.2563 (1.7693) ce_loss 1.4307 (0.9179) loss_zs_kd 2.0122 (2.0036) loss_oracle 0.4683 (0.4855) acc 59.3750 (66.9792) kd_loss 0.5915 (0.6086) lr 1.2487e-03 eta 0:18:55
epoch [23/50] batch [260/445] time 0.079 (0.092) data 0.000 (0.013) loss 2.4118 (1.7672) ce_loss 1.3281 (0.9145) loss_zs_kd 1.9799 (2.0017) loss_oracle 0.5663 (0.4855) acc 59.3750 (67.2115) kd_loss 0.8005 (0.6100) lr 1.2487e-03 eta 0:18:44
epoch [23/50] batch [280/445] time 0.083 (0.092) data 0.000 (0.012) loss 2.0360 (1.7663) ce_loss 1.0752 (0.9089) loss_zs_kd 2.3235 (1.9953) loss_oracle 0.4966 (0.4854) acc 62.5000 (67.4442) kd_loss 0.7125 (0.6147) lr 1.2487e-03 eta 0:18:34
epoch [23/50] batch [300/445] time 0.089 (0.091) data 0.000 (0.011) loss 1.8932 (1.7697) ce_loss 0.8247 (0.9079) loss_zs_kd 1.9950 (1.9968) loss_oracle 0.6109 (0.4850) acc 71.8750 (67.4479) kd_loss 0.7631 (0.6194) lr 1.2487e-03 eta 0:18:26
epoch [23/50] batch [320/445] time 0.088 (0.091) data 0.000 (0.010) loss 1.8617 (1.7745) ce_loss 0.8589 (0.9087) loss_zs_kd 2.2217 (1.9956) loss_oracle 0.5446 (0.4855) acc 68.7500 (67.3828) kd_loss 0.7305 (0.6229) lr 1.2487e-03 eta 0:18:20
epoch [23/50] batch [340/445] time 0.086 (0.090) data 0.000 (0.010) loss 1.8860 (1.7766) ce_loss 0.8984 (0.9074) loss_zs_kd 1.9561 (1.9930) loss_oracle 0.5050 (0.4855) acc 68.7500 (67.4173) kd_loss 0.7350 (0.6265) lr 1.2487e-03 eta 0:18:15
epoch [23/50] batch [360/445] time 0.089 (0.090) data 0.000 (0.009) loss 2.0779 (1.7799) ce_loss 1.1768 (0.9085) loss_zs_kd 1.3681 (1.9830) loss_oracle 0.5029 (0.4852) acc 65.6250 (67.4045) kd_loss 0.6496 (0.6289) lr 1.2487e-03 eta 0:18:09
epoch [23/50] batch [380/445] time 0.075 (0.090) data 0.000 (0.009) loss 1.9425 (1.7838) ce_loss 0.9707 (0.9098) loss_zs_kd 1.9212 (1.9756) loss_oracle 0.5028 (0.4848) acc 71.8750 (67.3520) kd_loss 0.7204 (0.6316) lr 1.2487e-03 eta 0:18:04
epoch [23/50] batch [400/445] time 0.089 (0.089) data 0.000 (0.008) loss 1.6237 (1.7897) ce_loss 0.7295 (0.9132) loss_zs_kd 2.1076 (1.9806) loss_oracle 0.4834 (0.4857) acc 75.0000 (67.3281) kd_loss 0.6525 (0.6336) lr 1.2487e-03 eta 0:17:57
epoch [23/50] batch [420/445] time 0.075 (0.089) data 0.000 (0.008) loss 1.8336 (1.7895) ce_loss 0.9902 (0.9130) loss_zs_kd 2.1133 (1.9839) loss_oracle 0.4383 (0.4857) acc 65.6250 (67.3140) kd_loss 0.6242 (0.6337) lr 1.2487e-03 eta 0:17:53
epoch [23/50] batch [440/445] time 0.080 (0.089) data 0.000 (0.008) loss 1.8222 (1.7878) ce_loss 0.8857 (0.9111) loss_zs_kd 2.5264 (1.9898) loss_oracle 0.5281 (0.4861) acc 59.3750 (67.3509) kd_loss 0.6724 (0.6336) lr 1.2487e-03 eta 0:17:46
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,380
* accuracy: 71.7%
* error: 28.3%
* macro_f1: 58.6%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,952
* accuracy: 49.2%
* error: 50.8%
* macro_f1: 28.0%
******* Domain 3 best val acc:      71.7%, epoch: 23 *******
******* Domain 3 best val test acc: 49.2%, epoch: 23 *******
******* Domain 3 best test acc:     53.2%, epoch: 21 *******
epoch [24/50] batch [20/445] time 0.084 (0.241) data 0.000 (0.153) loss 1.3828 (1.7854) ce_loss 0.5415 (0.9161) loss_zs_kd 1.8369 (2.0167) loss_oracle 0.4967 (0.4963) acc 78.1250 (66.5625) kd_loss 0.5930 (0.6212) lr 1.1874e-03 eta 0:48:09
epoch [24/50] batch [40/445] time 0.081 (0.162) data 0.000 (0.077) loss 1.7796 (1.7364) ce_loss 0.9897 (0.8764) loss_zs_kd 1.9648 (2.0234) loss_oracle 0.4931 (0.4861) acc 65.6250 (67.2656) kd_loss 0.5433 (0.6170) lr 1.1874e-03 eta 0:32:23
epoch [24/50] batch [60/445] time 0.081 (0.136) data 0.000 (0.051) loss 1.5864 (1.7559) ce_loss 0.7520 (0.8995) loss_zs_kd 1.8070 (2.0172) loss_oracle 0.4767 (0.4824) acc 68.7500 (67.1875) kd_loss 0.5961 (0.6153) lr 1.1874e-03 eta 0:27:11
epoch [24/50] batch [80/445] time 0.080 (0.123) data 0.000 (0.039) loss 1.6809 (1.7736) ce_loss 0.7539 (0.9148) loss_zs_kd 2.0369 (2.0180) loss_oracle 0.5366 (0.4875) acc 75.0000 (67.1875) kd_loss 0.6588 (0.6151) lr 1.1874e-03 eta 0:24:32
epoch [24/50] batch [100/445] time 0.074 (0.115) data 0.000 (0.031) loss 1.5959 (1.7823) ce_loss 0.7842 (0.9277) loss_zs_kd 1.9337 (2.0450) loss_oracle 0.4813 (0.4894) acc 78.1250 (66.4062) kd_loss 0.5710 (0.6099) lr 1.1874e-03 eta 0:22:48
epoch [24/50] batch [120/445] time 0.079 (0.110) data 0.000 (0.026) loss 1.8768 (1.7785) ce_loss 1.0029 (0.9263) loss_zs_kd 1.6669 (2.0312) loss_oracle 0.5653 (0.4918) acc 65.6250 (66.4583) kd_loss 0.5912 (0.6063) lr 1.1874e-03 eta 0:21:45
epoch [24/50] batch [140/445] time 0.085 (0.105) data 0.000 (0.022) loss 2.0162 (1.7736) ce_loss 1.1338 (0.9211) loss_zs_kd 2.3576 (2.0434) loss_oracle 0.6137 (0.4946) acc 53.1250 (66.7634) kd_loss 0.5756 (0.6052) lr 1.1874e-03 eta 0:20:49
epoch [24/50] batch [160/445] time 0.076 (0.102) data 0.000 (0.019) loss 1.5979 (1.7591) ce_loss 0.7700 (0.9082) loss_zs_kd 2.3944 (2.0295) loss_oracle 0.5794 (0.4958) acc 71.8750 (67.2852) kd_loss 0.5382 (0.6031) lr 1.1874e-03 eta 0:20:13
epoch [24/50] batch [180/445] time 0.081 (0.100) data 0.000 (0.017) loss 1.5660 (1.7550) ce_loss 0.7686 (0.9054) loss_zs_kd 1.9537 (2.0275) loss_oracle 0.4642 (0.4963) acc 71.8750 (67.2743) kd_loss 0.5654 (0.6014) lr 1.1874e-03 eta 0:19:46
epoch [24/50] batch [200/445] time 0.091 (0.099) data 0.000 (0.016) loss 1.5736 (1.7589) ce_loss 0.7734 (0.9091) loss_zs_kd 2.0750 (2.0369) loss_oracle 0.5270 (0.4980) acc 71.8750 (67.2969) kd_loss 0.5366 (0.6008) lr 1.1874e-03 eta 0:19:24
epoch [24/50] batch [220/445] time 0.078 (0.097) data 0.000 (0.014) loss 1.8682 (1.7631) ce_loss 0.9272 (0.9090) loss_zs_kd 1.6899 (2.0375) loss_oracle 0.5296 (0.5003) acc 71.8750 (67.3438) kd_loss 0.6761 (0.6039) lr 1.1874e-03 eta 0:19:08
epoch [24/50] batch [240/445] time 0.072 (0.096) data 0.000 (0.013) loss 2.0213 (1.7599) ce_loss 1.0488 (0.9065) loss_zs_kd 1.6441 (2.0247) loss_oracle 0.5574 (0.4982) acc 65.6250 (67.3828) kd_loss 0.6938 (0.6043) lr 1.1874e-03 eta 0:18:52
epoch [24/50] batch [260/445] time 0.087 (0.095) data 0.000 (0.012) loss 1.6076 (1.7565) ce_loss 0.7891 (0.9042) loss_zs_kd 2.3804 (2.0219) loss_oracle 0.4304 (0.4963) acc 75.0000 (67.5601) kd_loss 0.6034 (0.6041) lr 1.1874e-03 eta 0:18:38
epoch [24/50] batch [280/445] time 0.093 (0.094) data 0.000 (0.011) loss 2.5483 (1.7597) ce_loss 1.6533 (0.9060) loss_zs_kd 1.8339 (2.0188) loss_oracle 0.5502 (0.4953) acc 40.6250 (67.5223) kd_loss 0.6199 (0.6061) lr 1.1874e-03 eta 0:18:28
epoch [24/50] batch [300/445] time 0.079 (0.094) data 0.000 (0.010) loss 1.7960 (1.7637) ce_loss 1.0117 (0.9085) loss_zs_kd 1.8296 (2.0157) loss_oracle 0.3988 (0.4955) acc 71.8750 (67.4896) kd_loss 0.5849 (0.6074) lr 1.1874e-03 eta 0:18:17
epoch [24/50] batch [320/445] time 0.089 (0.093) data 0.000 (0.010) loss 1.7997 (1.7638) ce_loss 0.9224 (0.9086) loss_zs_kd 2.0902 (2.0165) loss_oracle 0.4976 (0.4952) acc 75.0000 (67.4805) kd_loss 0.6286 (0.6075) lr 1.1874e-03 eta 0:18:03
epoch [24/50] batch [340/445] time 0.087 (0.092) data 0.000 (0.009) loss 1.9882 (1.7684) ce_loss 1.1514 (0.9117) loss_zs_kd 1.7101 (2.0137) loss_oracle 0.4769 (0.4952) acc 62.5000 (67.4173) kd_loss 0.5984 (0.6091) lr 1.1874e-03 eta 0:17:57
epoch [24/50] batch [360/445] time 0.081 (0.092) data 0.000 (0.009) loss 1.6983 (1.7662) ce_loss 0.7764 (0.9078) loss_zs_kd 2.1815 (2.0095) loss_oracle 0.4904 (0.4943) acc 71.8750 (67.6389) kd_loss 0.6767 (0.6113) lr 1.1874e-03 eta 0:17:50
epoch [24/50] batch [380/445] time 0.084 (0.091) data 0.000 (0.008) loss 1.5189 (1.7691) ce_loss 0.6309 (0.9086) loss_zs_kd 2.0081 (2.0097) loss_oracle 0.5419 (0.4943) acc 81.2500 (67.5000) kd_loss 0.6171 (0.6134) lr 1.1874e-03 eta 0:17:42
epoch [24/50] batch [400/445] time 0.080 (0.091) data 0.000 (0.008) loss 1.6576 (1.7698) ce_loss 0.7378 (0.9091) loss_zs_kd 2.0424 (2.0068) loss_oracle 0.5549 (0.4938) acc 65.6250 (67.4844) kd_loss 0.6424 (0.6139) lr 1.1874e-03 eta 0:17:37
epoch [24/50] batch [420/445] time 0.093 (0.091) data 0.000 (0.008) loss 1.9066 (1.7709) ce_loss 0.9360 (0.9087) loss_zs_kd 1.7737 (2.0035) loss_oracle 0.6031 (0.4935) acc 56.2500 (67.5595) kd_loss 0.6690 (0.6154) lr 1.1874e-03 eta 0:17:32
epoch [24/50] batch [440/445] time 0.079 (0.090) data 0.000 (0.007) loss 1.7217 (1.7691) ce_loss 0.8281 (0.9079) loss_zs_kd 2.3818 (2.0047) loss_oracle 0.5473 (0.4924) acc 62.5000 (67.5710) kd_loss 0.6199 (0.6150) lr 1.1874e-03 eta 0:17:26
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,377
* accuracy: 71.7%
* error: 28.3%
* macro_f1: 59.5%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,058
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 34.6%
******* Domain 3 best val acc:      71.7%, epoch: 23 *******
******* Domain 3 best val test acc: 49.2%, epoch: 23 *******
******* Domain 3 best test acc:     53.2%, epoch: 21 *******
epoch [25/50] batch [20/445] time 0.088 (0.258) data 0.000 (0.170) loss 1.5717 (1.7312) ce_loss 0.7456 (0.8694) loss_zs_kd 1.8980 (1.9541) loss_oracle 0.4170 (0.4868) acc 68.7500 (67.9688) kd_loss 0.6176 (0.6184) lr 1.1253e-03 eta 0:49:34
epoch [25/50] batch [40/445] time 0.088 (0.172) data 0.000 (0.085) loss 1.4909 (1.7497) ce_loss 0.6855 (0.8853) loss_zs_kd 2.1079 (1.9543) loss_oracle 0.5218 (0.4872) acc 78.1250 (68.4375) kd_loss 0.5445 (0.6208) lr 1.1253e-03 eta 0:33:06
epoch [25/50] batch [60/445] time 0.091 (0.144) data 0.000 (0.057) loss 2.0524 (1.7517) ce_loss 1.0332 (0.8744) loss_zs_kd 1.9233 (1.9698) loss_oracle 0.6023 (0.5021) acc 62.5000 (68.8542) kd_loss 0.7180 (0.6263) lr 1.1253e-03 eta 0:27:33
epoch [25/50] batch [80/445] time 0.078 (0.129) data 0.000 (0.043) loss 1.8652 (1.7614) ce_loss 0.9966 (0.8873) loss_zs_kd 1.8133 (1.9864) loss_oracle 0.5232 (0.4992) acc 65.6250 (68.5938) kd_loss 0.6070 (0.6245) lr 1.1253e-03 eta 0:24:39
epoch [25/50] batch [100/445] time 0.088 (0.120) data 0.000 (0.034) loss 1.5482 (1.7789) ce_loss 0.7456 (0.9076) loss_zs_kd 2.1586 (1.9955) loss_oracle 0.4285 (0.4956) acc 75.0000 (68.2812) kd_loss 0.5883 (0.6235) lr 1.1253e-03 eta 0:22:50
epoch [25/50] batch [120/445] time 0.084 (0.114) data 0.000 (0.029) loss 1.9938 (1.7909) ce_loss 1.1289 (0.9171) loss_zs_kd 2.0697 (2.0176) loss_oracle 0.5257 (0.4973) acc 62.5000 (68.0208) kd_loss 0.6020 (0.6251) lr 1.1253e-03 eta 0:21:42
epoch [25/50] batch [140/445] time 0.085 (0.110) data 0.000 (0.025) loss 2.0852 (1.7990) ce_loss 1.2891 (0.9245) loss_zs_kd 1.9358 (2.0152) loss_oracle 0.4951 (0.4967) acc 56.2500 (67.5446) kd_loss 0.5486 (0.6262) lr 1.1253e-03 eta 0:20:54
epoch [25/50] batch [160/445] time 0.077 (0.107) data 0.000 (0.021) loss 1.5558 (1.7973) ce_loss 0.5962 (0.9206) loss_zs_kd 2.3802 (2.0260) loss_oracle 0.6056 (0.4990) acc 78.1250 (67.7344) kd_loss 0.6568 (0.6273) lr 1.1253e-03 eta 0:20:16
epoch [25/50] batch [180/445] time 0.086 (0.104) data 0.000 (0.019) loss 1.6717 (1.7962) ce_loss 0.8960 (0.9210) loss_zs_kd 2.4824 (2.0356) loss_oracle 0.4356 (0.4956) acc 65.6250 (67.6389) kd_loss 0.5579 (0.6274) lr 1.1253e-03 eta 0:19:45
epoch [25/50] batch [200/445] time 0.083 (0.102) data 0.000 (0.017) loss 1.9746 (1.7939) ce_loss 1.1396 (0.9217) loss_zs_kd 1.6562 (2.0443) loss_oracle 0.5035 (0.4929) acc 62.5000 (67.7656) kd_loss 0.5832 (0.6258) lr 1.1253e-03 eta 0:19:20
epoch [25/50] batch [220/445] time 0.086 (0.100) data 0.000 (0.016) loss 1.7123 (1.7922) ce_loss 0.7979 (0.9189) loss_zs_kd 1.9579 (2.0457) loss_oracle 0.4452 (0.4926) acc 65.6250 (67.9119) kd_loss 0.6918 (0.6270) lr 1.1253e-03 eta 0:19:00
epoch [25/50] batch [240/445] time 0.076 (0.099) data 0.000 (0.014) loss 1.9301 (1.7931) ce_loss 1.0488 (0.9186) loss_zs_kd 1.6616 (2.0381) loss_oracle 0.4268 (0.4913) acc 71.8750 (67.8776) kd_loss 0.6679 (0.6288) lr 1.1253e-03 eta 0:18:43
epoch [25/50] batch [260/445] time 0.072 (0.098) data 0.000 (0.013) loss 1.7182 (1.7865) ce_loss 0.8467 (0.9118) loss_zs_kd 2.1537 (2.0478) loss_oracle 0.5454 (0.4917) acc 65.6250 (67.9808) kd_loss 0.5988 (0.6288) lr 1.1253e-03 eta 0:18:29
epoch [25/50] batch [280/445] time 0.092 (0.097) data 0.000 (0.012) loss 1.5837 (1.7878) ce_loss 0.7612 (0.9150) loss_zs_kd 2.0858 (2.0455) loss_oracle 0.3409 (0.4905) acc 78.1250 (67.8125) kd_loss 0.6520 (0.6276) lr 1.1253e-03 eta 0:18:17
epoch [25/50] batch [300/445] time 0.088 (0.096) data 0.001 (0.012) loss 1.7862 (1.7858) ce_loss 0.8970 (0.9142) loss_zs_kd 2.1101 (2.0452) loss_oracle 0.4170 (0.4884) acc 75.0000 (67.7812) kd_loss 0.6807 (0.6274) lr 1.1253e-03 eta 0:18:05
epoch [25/50] batch [320/445] time 0.084 (0.095) data 0.000 (0.011) loss 1.4501 (1.7850) ce_loss 0.6914 (0.9141) loss_zs_kd 1.8534 (2.0423) loss_oracle 0.3973 (0.4882) acc 71.8750 (67.6562) kd_loss 0.5600 (0.6269) lr 1.1253e-03 eta 0:17:53
epoch [25/50] batch [340/445] time 0.079 (0.095) data 0.000 (0.010) loss 1.7853 (1.7892) ce_loss 0.9644 (0.9171) loss_zs_kd 1.6023 (2.0401) loss_oracle 0.3870 (0.4885) acc 71.8750 (67.5276) kd_loss 0.6274 (0.6279) lr 1.1253e-03 eta 0:17:43
epoch [25/50] batch [360/445] time 0.079 (0.094) data 0.000 (0.010) loss 1.5797 (1.7875) ce_loss 0.7729 (0.9148) loss_zs_kd 2.1318 (2.0369) loss_oracle 0.5335 (0.4885) acc 71.8750 (67.6476) kd_loss 0.5400 (0.6285) lr 1.1253e-03 eta 0:17:32
epoch [25/50] batch [380/445] time 0.084 (0.093) data 0.000 (0.009) loss 1.9685 (1.7877) ce_loss 1.1240 (0.9156) loss_zs_kd 1.7565 (2.0381) loss_oracle 0.4584 (0.4875) acc 62.5000 (67.6069) kd_loss 0.6153 (0.6284) lr 1.1253e-03 eta 0:17:25
epoch [25/50] batch [400/445] time 0.085 (0.093) data 0.001 (0.009) loss 1.4943 (1.7855) ce_loss 0.6807 (0.9132) loss_zs_kd 2.5766 (2.0373) loss_oracle 0.4926 (0.4885) acc 78.1250 (67.6953) kd_loss 0.5673 (0.6281) lr 1.1253e-03 eta 0:17:16
epoch [25/50] batch [420/445] time 0.087 (0.092) data 0.000 (0.008) loss 1.5854 (1.7850) ce_loss 0.7363 (0.9133) loss_zs_kd 2.2833 (2.0404) loss_oracle 0.4496 (0.4879) acc 71.8750 (67.6637) kd_loss 0.6243 (0.6278) lr 1.1253e-03 eta 0:17:10
epoch [25/50] batch [440/445] time 0.071 (0.092) data 0.000 (0.008) loss 1.8837 (1.7828) ce_loss 1.1016 (0.9121) loss_zs_kd 1.9999 (2.0363) loss_oracle 0.4219 (0.4868) acc 65.6250 (67.7699) kd_loss 0.5712 (0.6273) lr 1.1253e-03 eta 0:17:03
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,360
* accuracy: 71.4%
* error: 28.6%
* macro_f1: 59.0%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,991
* accuracy: 50.2%
* error: 49.8%
* macro_f1: 30.5%
******* Domain 3 best val acc:      71.7%, epoch: 23 *******
******* Domain 3 best val test acc: 49.2%, epoch: 23 *******
******* Domain 3 best test acc:     53.2%, epoch: 21 *******
epoch [26/50] batch [20/445] time 0.093 (0.253) data 0.000 (0.167) loss 1.5875 (1.8005) ce_loss 0.7422 (0.9290) loss_zs_kd 2.1517 (2.0000) loss_oracle 0.4877 (0.4763) acc 71.8750 (66.4062) kd_loss 0.6014 (0.6334) lr 1.0628e-03 eta 0:46:52
epoch [26/50] batch [40/445] time 0.092 (0.170) data 0.000 (0.084) loss 1.3707 (1.7655) ce_loss 0.5444 (0.8975) loss_zs_kd 2.3241 (1.9885) loss_oracle 0.4581 (0.4806) acc 81.2500 (66.7969) kd_loss 0.5972 (0.6277) lr 1.0628e-03 eta 0:31:20
epoch [26/50] batch [60/445] time 0.084 (0.141) data 0.000 (0.056) loss 1.6490 (1.7676) ce_loss 0.8560 (0.8939) loss_zs_kd 1.7913 (1.9468) loss_oracle 0.4327 (0.4842) acc 71.8750 (67.3438) kd_loss 0.5768 (0.6316) lr 1.0628e-03 eta 0:26:03
epoch [26/50] batch [80/445] time 0.087 (0.127) data 0.000 (0.042) loss 2.1412 (1.7681) ce_loss 1.1729 (0.8888) loss_zs_kd 2.0019 (1.9919) loss_oracle 0.5467 (0.4905) acc 46.8750 (67.8516) kd_loss 0.6950 (0.6340) lr 1.0628e-03 eta 0:23:25
epoch [26/50] batch [100/445] time 0.085 (0.119) data 0.000 (0.034) loss 1.4268 (1.7703) ce_loss 0.6138 (0.8919) loss_zs_kd 1.9505 (1.9845) loss_oracle 0.4655 (0.4909) acc 81.2500 (67.9062) kd_loss 0.5803 (0.6330) lr 1.0628e-03 eta 0:21:52
epoch [26/50] batch [120/445] time 0.089 (0.114) data 0.001 (0.028) loss 1.7900 (1.7644) ce_loss 0.9717 (0.8908) loss_zs_kd 1.8774 (1.9867) loss_oracle 0.4906 (0.4872) acc 65.6250 (68.2292) kd_loss 0.5730 (0.6300) lr 1.0628e-03 eta 0:20:50
epoch [26/50] batch [140/445] time 0.076 (0.109) data 0.000 (0.024) loss 2.0148 (1.7700) ce_loss 1.1045 (0.8992) loss_zs_kd 1.9785 (1.9907) loss_oracle 0.4467 (0.4894) acc 65.6250 (67.7009) kd_loss 0.6869 (0.6261) lr 1.0628e-03 eta 0:19:55
epoch [26/50] batch [160/445] time 0.078 (0.105) data 0.000 (0.021) loss 1.5869 (1.7681) ce_loss 0.7549 (0.8979) loss_zs_kd 2.2010 (1.9995) loss_oracle 0.4683 (0.4882) acc 75.0000 (67.6758) kd_loss 0.5979 (0.6260) lr 1.0628e-03 eta 0:19:12
epoch [26/50] batch [180/445] time 0.080 (0.103) data 0.000 (0.019) loss 1.5976 (1.7686) ce_loss 0.7993 (0.8995) loss_zs_kd 1.8275 (2.0124) loss_oracle 0.4266 (0.4878) acc 68.7500 (67.7257) kd_loss 0.5850 (0.6252) lr 1.0628e-03 eta 0:18:44
epoch [26/50] batch [200/445] time 0.082 (0.101) data 0.000 (0.017) loss 1.6875 (1.7683) ce_loss 0.8691 (0.9003) loss_zs_kd 2.7956 (2.0205) loss_oracle 0.5165 (0.4872) acc 65.6250 (67.6250) kd_loss 0.5602 (0.6244) lr 1.0628e-03 eta 0:18:23
epoch [26/50] batch [220/445] time 0.085 (0.100) data 0.000 (0.015) loss 1.6918 (1.7756) ce_loss 0.8809 (0.9092) loss_zs_kd 1.9944 (2.0316) loss_oracle 0.4831 (0.4876) acc 62.5000 (67.1591) kd_loss 0.5694 (0.6226) lr 1.0628e-03 eta 0:18:05
epoch [26/50] batch [240/445] time 0.081 (0.098) data 0.000 (0.014) loss 1.7900 (1.7765) ce_loss 0.9502 (0.9106) loss_zs_kd 1.6254 (2.0360) loss_oracle 0.4192 (0.4888) acc 59.3750 (67.0573) kd_loss 0.6302 (0.6215) lr 1.0628e-03 eta 0:17:48
epoch [26/50] batch [260/445] time 0.082 (0.097) data 0.000 (0.013) loss 1.7405 (1.7785) ce_loss 0.9033 (0.9127) loss_zs_kd 2.3886 (2.0387) loss_oracle 0.4540 (0.4893) acc 59.3750 (66.9471) kd_loss 0.6102 (0.6211) lr 1.0628e-03 eta 0:17:35
epoch [26/50] batch [280/445] time 0.084 (0.096) data 0.000 (0.012) loss 1.6120 (1.7755) ce_loss 0.8350 (0.9094) loss_zs_kd 2.0540 (2.0492) loss_oracle 0.4899 (0.4907) acc 68.7500 (67.0312) kd_loss 0.5321 (0.6207) lr 1.0628e-03 eta 0:17:23
epoch [26/50] batch [300/445] time 0.084 (0.095) data 0.000 (0.011) loss 1.9333 (1.7763) ce_loss 1.0869 (0.9107) loss_zs_kd 1.9440 (2.0439) loss_oracle 0.4968 (0.4909) acc 59.3750 (66.9792) kd_loss 0.5980 (0.6202) lr 1.0628e-03 eta 0:17:13
epoch [26/50] batch [320/445] time 0.083 (0.095) data 0.000 (0.011) loss 1.8218 (1.7715) ce_loss 0.9238 (0.9053) loss_zs_kd 1.6560 (2.0447) loss_oracle 0.4541 (0.4906) acc 62.5000 (67.2070) kd_loss 0.6710 (0.6210) lr 1.0628e-03 eta 0:17:03
epoch [26/50] batch [340/445] time 0.086 (0.094) data 0.000 (0.010) loss 1.5325 (1.7722) ce_loss 0.5947 (0.9044) loss_zs_kd 2.1201 (2.0431) loss_oracle 0.4834 (0.4907) acc 78.1250 (67.2886) kd_loss 0.6961 (0.6224) lr 1.0628e-03 eta 0:16:55
epoch [26/50] batch [360/445] time 0.081 (0.094) data 0.000 (0.010) loss 1.5053 (1.7726) ce_loss 0.6646 (0.9024) loss_zs_kd 2.5864 (2.0398) loss_oracle 0.4833 (0.4914) acc 75.0000 (67.4306) kd_loss 0.5991 (0.6244) lr 1.0628e-03 eta 0:16:47
epoch [26/50] batch [380/445] time 0.082 (0.093) data 0.000 (0.009) loss 1.5471 (1.7736) ce_loss 0.6006 (0.9025) loss_zs_kd 2.3240 (2.0438) loss_oracle 0.4669 (0.4928) acc 84.3750 (67.5658) kd_loss 0.7130 (0.6246) lr 1.0628e-03 eta 0:16:38
epoch [26/50] batch [400/445] time 0.087 (0.092) data 0.000 (0.009) loss 1.5088 (1.7747) ce_loss 0.6958 (0.9014) loss_zs_kd 2.4825 (2.0427) loss_oracle 0.5072 (0.4943) acc 68.7500 (67.6328) kd_loss 0.5593 (0.6261) lr 1.0628e-03 eta 0:16:31
epoch [26/50] batch [420/445] time 0.084 (0.092) data 0.000 (0.008) loss 1.5769 (1.7725) ce_loss 0.7275 (0.8971) loss_zs_kd 1.8410 (2.0455) loss_oracle 0.4709 (0.4951) acc 68.7500 (67.7902) kd_loss 0.6139 (0.6278) lr 1.0628e-03 eta 0:16:26
epoch [26/50] batch [440/445] time 0.080 (0.092) data 0.000 (0.008) loss 1.8058 (1.7734) ce_loss 0.8916 (0.8970) loss_zs_kd 1.9458 (2.0432) loss_oracle 0.5782 (0.4957) acc 78.1250 (67.7486) kd_loss 0.6251 (0.6285) lr 1.0628e-03 eta 0:16:18
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,364
* accuracy: 71.4%
* error: 28.6%
* macro_f1: 59.5%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,123
* accuracy: 53.5%
* error: 46.5%
* macro_f1: 33.8%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      71.7%, epoch: 23 *******
******* Domain 3 best val test acc: 49.2%, epoch: 23 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [27/50] batch [20/445] time 0.071 (0.214) data 0.000 (0.134) loss 1.5372 (1.8148) ce_loss 0.6865 (0.9131) loss_zs_kd 2.2120 (2.0750) loss_oracle 0.4993 (0.5110) acc 75.0000 (67.5000) kd_loss 0.6011 (0.6462) lr 1.0000e-03 eta 0:37:56
epoch [27/50] batch [40/445] time 0.077 (0.146) data 0.001 (0.067) loss 1.7636 (1.7669) ce_loss 0.8423 (0.8595) loss_zs_kd 2.3624 (2.0496) loss_oracle 0.5729 (0.5151) acc 71.8750 (68.9062) kd_loss 0.6348 (0.6498) lr 1.0000e-03 eta 0:25:50
epoch [27/50] batch [60/445] time 0.093 (0.125) data 0.000 (0.045) loss 1.6000 (1.7624) ce_loss 0.7383 (0.8640) loss_zs_kd 2.4439 (2.0750) loss_oracle 0.5007 (0.5096) acc 84.3750 (69.0625) kd_loss 0.6114 (0.6436) lr 1.0000e-03 eta 0:22:10
epoch [27/50] batch [80/445] time 0.084 (0.115) data 0.000 (0.034) loss 1.7480 (1.7888) ce_loss 0.7773 (0.8872) loss_zs_kd 1.9954 (2.0519) loss_oracle 0.4931 (0.5120) acc 78.1250 (67.9688) kd_loss 0.7241 (0.6456) lr 1.0000e-03 eta 0:20:17
epoch [27/50] batch [100/445] time 0.085 (0.108) data 0.000 (0.027) loss 1.3629 (1.7928) ce_loss 0.5049 (0.8922) loss_zs_kd 2.0705 (2.0359) loss_oracle 0.4919 (0.5141) acc 84.3750 (68.5312) kd_loss 0.6121 (0.6435) lr 1.0000e-03 eta 0:19:02
epoch [27/50] batch [120/445] time 0.081 (0.104) data 0.000 (0.022) loss 2.0854 (1.8091) ce_loss 1.0967 (0.9142) loss_zs_kd 1.8602 (2.0392) loss_oracle 0.5984 (0.5135) acc 59.3750 (68.2812) kd_loss 0.6895 (0.6382) lr 1.0000e-03 eta 0:18:13
epoch [27/50] batch [140/445] time 0.078 (0.100) data 0.000 (0.019) loss 2.0418 (1.7988) ce_loss 1.1943 (0.9068) loss_zs_kd 2.1185 (2.0328) loss_oracle 0.4656 (0.5147) acc 62.5000 (68.1696) kd_loss 0.6147 (0.6347) lr 1.0000e-03 eta 0:17:35
epoch [27/50] batch [160/445] time 0.076 (0.098) data 0.000 (0.017) loss 1.8420 (1.8016) ce_loss 0.9028 (0.9071) loss_zs_kd 2.0499 (2.0545) loss_oracle 0.4808 (0.5146) acc 65.6250 (68.2812) kd_loss 0.6988 (0.6373) lr 1.0000e-03 eta 0:17:09
epoch [27/50] batch [180/445] time 0.080 (0.096) data 0.000 (0.015) loss 1.8915 (1.7883) ce_loss 0.9995 (0.9011) loss_zs_kd 2.1421 (2.0503) loss_oracle 0.5215 (0.5102) acc 59.3750 (68.1424) kd_loss 0.6313 (0.6321) lr 1.0000e-03 eta 0:16:44
epoch [27/50] batch [200/445] time 0.081 (0.095) data 0.000 (0.014) loss 2.0736 (1.7923) ce_loss 1.1758 (0.9061) loss_zs_kd 1.8628 (2.0380) loss_oracle 0.5379 (0.5100) acc 62.5000 (67.8438) kd_loss 0.6289 (0.6311) lr 1.0000e-03 eta 0:16:31
epoch [27/50] batch [220/445] time 0.084 (0.094) data 0.000 (0.012) loss 1.5988 (1.7932) ce_loss 0.6206 (0.9069) loss_zs_kd 2.0137 (2.0307) loss_oracle 0.5337 (0.5089) acc 75.0000 (67.7699) kd_loss 0.7113 (0.6319) lr 1.0000e-03 eta 0:16:21
epoch [27/50] batch [240/445] time 0.078 (0.093) data 0.000 (0.011) loss 2.1127 (1.7867) ce_loss 1.1729 (0.9040) loss_zs_kd 2.6022 (2.0454) loss_oracle 0.5328 (0.5086) acc 53.1250 (67.8516) kd_loss 0.6734 (0.6284) lr 1.0000e-03 eta 0:16:11
epoch [27/50] batch [260/445] time 0.079 (0.092) data 0.000 (0.011) loss 1.5748 (1.7924) ce_loss 0.7036 (0.9097) loss_zs_kd 1.9888 (2.0436) loss_oracle 0.4541 (0.5077) acc 75.0000 (67.5481) kd_loss 0.6442 (0.6288) lr 1.0000e-03 eta 0:16:02
epoch [27/50] batch [280/445] time 0.086 (0.092) data 0.000 (0.010) loss 1.7831 (1.7885) ce_loss 1.0439 (0.9085) loss_zs_kd 2.0414 (2.0443) loss_oracle 0.3845 (0.5072) acc 62.5000 (67.5112) kd_loss 0.5469 (0.6265) lr 1.0000e-03 eta 0:15:55
epoch [27/50] batch [300/445] time 0.087 (0.091) data 0.000 (0.009) loss 1.9210 (1.7905) ce_loss 1.0391 (0.9097) loss_zs_kd 1.8348 (2.0395) loss_oracle 0.4920 (0.5070) acc 68.7500 (67.5521) kd_loss 0.6359 (0.6273) lr 1.0000e-03 eta 0:15:49
epoch [27/50] batch [320/445] time 0.086 (0.091) data 0.000 (0.009) loss 1.6139 (1.7878) ce_loss 0.7168 (0.9070) loss_zs_kd 1.6995 (2.0415) loss_oracle 0.5959 (0.5069) acc 81.2500 (67.5684) kd_loss 0.5992 (0.6274) lr 1.0000e-03 eta 0:15:42
epoch [27/50] batch [340/445] time 0.083 (0.090) data 0.000 (0.008) loss 1.5890 (1.7878) ce_loss 0.6055 (0.9067) loss_zs_kd 1.8660 (2.0358) loss_oracle 0.5751 (0.5073) acc 75.0000 (67.6379) kd_loss 0.6960 (0.6275) lr 1.0000e-03 eta 0:15:35
epoch [27/50] batch [360/445] time 0.082 (0.090) data 0.000 (0.008) loss 2.1414 (1.7880) ce_loss 1.1963 (0.9079) loss_zs_kd 2.2027 (2.0381) loss_oracle 0.5649 (0.5058) acc 46.8750 (67.5608) kd_loss 0.6626 (0.6272) lr 1.0000e-03 eta 0:15:31
epoch [27/50] batch [380/445] time 0.078 (0.090) data 0.000 (0.007) loss 1.7165 (1.7888) ce_loss 0.8467 (0.9069) loss_zs_kd 1.9436 (2.0324) loss_oracle 0.5024 (0.5058) acc 68.7500 (67.6069) kd_loss 0.6186 (0.6290) lr 1.0000e-03 eta 0:15:26
epoch [27/50] batch [400/445] time 0.087 (0.090) data 0.000 (0.007) loss 1.8310 (1.7908) ce_loss 0.9082 (0.9082) loss_zs_kd 2.5125 (2.0312) loss_oracle 0.5241 (0.5046) acc 62.5000 (67.6406) kd_loss 0.6607 (0.6303) lr 1.0000e-03 eta 0:15:22
epoch [27/50] batch [420/445] time 0.084 (0.089) data 0.000 (0.007) loss 1.6038 (1.7888) ce_loss 0.7354 (0.9051) loss_zs_kd 1.9181 (2.0355) loss_oracle 0.4162 (0.5034) acc 75.0000 (67.7455) kd_loss 0.6603 (0.6321) lr 1.0000e-03 eta 0:15:17
epoch [27/50] batch [440/445] time 0.080 (0.089) data 0.000 (0.006) loss 1.6278 (1.7895) ce_loss 0.7798 (0.9051) loss_zs_kd 2.3785 (2.0375) loss_oracle 0.4521 (0.5025) acc 68.7500 (67.8622) kd_loss 0.6220 (0.6331) lr 1.0000e-03 eta 0:15:12
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,318
* accuracy: 70.7%
* error: 29.3%
* macro_f1: 58.4%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,108
* accuracy: 53.1%
* error: 46.9%
* macro_f1: 30.8%
******* Domain 3 best val acc:      71.7%, epoch: 23 *******
******* Domain 3 best val test acc: 49.2%, epoch: 23 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [28/50] batch [20/445] time 0.082 (0.212) data 0.000 (0.130) loss 1.6389 (1.9448) ce_loss 0.7441 (1.0343) loss_zs_kd 1.9279 (2.0398) loss_oracle 0.4751 (0.4855) acc 78.1250 (65.3125) kd_loss 0.6572 (0.6678) lr 9.3721e-04 eta 0:36:02
epoch [28/50] batch [40/445] time 0.087 (0.147) data 0.000 (0.065) loss 1.7716 (1.9143) ce_loss 0.9741 (0.9978) loss_zs_kd 1.9919 (2.0905) loss_oracle 0.4535 (0.4880) acc 59.3750 (66.1719) kd_loss 0.5708 (0.6726) lr 9.3721e-04 eta 0:24:58
epoch [28/50] batch [60/445] time 0.077 (0.125) data 0.000 (0.044) loss 1.6551 (1.8899) ce_loss 0.7534 (0.9544) loss_zs_kd 2.0536 (2.0687) loss_oracle 0.5340 (0.4874) acc 71.8750 (66.8750) kd_loss 0.6347 (0.6918) lr 9.3721e-04 eta 0:21:14
epoch [28/50] batch [80/445] time 0.083 (0.114) data 0.000 (0.033) loss 1.5542 (1.8822) ce_loss 0.5415 (0.9462) loss_zs_kd 1.8230 (2.0912) loss_oracle 0.4489 (0.4870) acc 84.3750 (67.3438) kd_loss 0.7882 (0.6925) lr 9.3721e-04 eta 0:19:17
epoch [28/50] batch [100/445] time 0.083 (0.108) data 0.000 (0.026) loss 1.9737 (1.8720) ce_loss 1.0205 (0.9300) loss_zs_kd 2.1278 (2.0879) loss_oracle 0.4572 (0.4896) acc 62.5000 (67.3438) kd_loss 0.7246 (0.6972) lr 9.3721e-04 eta 0:18:14
epoch [28/50] batch [120/445] time 0.082 (0.103) data 0.000 (0.022) loss 1.7245 (1.8518) ce_loss 0.6973 (0.9072) loss_zs_kd 2.3813 (2.0990) loss_oracle 0.4993 (0.4888) acc 75.0000 (67.8646) kd_loss 0.7776 (0.7001) lr 9.3721e-04 eta 0:17:23
epoch [28/50] batch [140/445] time 0.077 (0.100) data 0.000 (0.019) loss 1.6140 (1.8451) ce_loss 0.7363 (0.8981) loss_zs_kd 2.2919 (2.1035) loss_oracle 0.4343 (0.4891) acc 71.8750 (67.9911) kd_loss 0.6605 (0.7024) lr 9.3721e-04 eta 0:16:48
epoch [28/50] batch [160/445] time 0.074 (0.098) data 0.000 (0.017) loss 1.7359 (1.8411) ce_loss 0.8853 (0.8963) loss_zs_kd 2.4821 (2.1162) loss_oracle 0.4591 (0.4896) acc 68.7500 (68.0469) kd_loss 0.6211 (0.7000) lr 9.3721e-04 eta 0:16:23
epoch [28/50] batch [180/445] time 0.078 (0.096) data 0.000 (0.015) loss 2.2008 (1.8383) ce_loss 1.1826 (0.8964) loss_zs_kd 2.0124 (2.1075) loss_oracle 0.4868 (0.4888) acc 65.6250 (68.0903) kd_loss 0.7748 (0.6975) lr 9.3721e-04 eta 0:16:04
epoch [28/50] batch [200/445] time 0.084 (0.094) data 0.000 (0.013) loss 1.6843 (1.8413) ce_loss 0.8491 (0.9034) loss_zs_kd 2.1359 (2.1005) loss_oracle 0.4853 (0.4896) acc 65.6250 (67.7812) kd_loss 0.5926 (0.6931) lr 9.3721e-04 eta 0:15:46
epoch [28/50] batch [220/445] time 0.078 (0.094) data 0.000 (0.012) loss 1.5854 (1.8331) ce_loss 0.7305 (0.8997) loss_zs_kd 2.1086 (2.0920) loss_oracle 0.4470 (0.4882) acc 75.0000 (67.9261) kd_loss 0.6314 (0.6892) lr 9.3721e-04 eta 0:15:38
epoch [28/50] batch [240/445] time 0.090 (0.093) data 0.000 (0.011) loss 2.0945 (1.8334) ce_loss 0.9941 (0.9024) loss_zs_kd 1.9357 (2.0860) loss_oracle 0.6066 (0.4890) acc 62.5000 (67.8906) kd_loss 0.7971 (0.6864) lr 9.3721e-04 eta 0:15:28
epoch [28/50] batch [260/445] time 0.086 (0.092) data 0.000 (0.010) loss 1.7501 (1.8373) ce_loss 0.9219 (0.9049) loss_zs_kd 1.6616 (2.0731) loss_oracle 0.5444 (0.4907) acc 62.5000 (67.6082) kd_loss 0.5560 (0.6871) lr 9.3721e-04 eta 0:15:21
epoch [28/50] batch [280/445] time 0.083 (0.092) data 0.000 (0.010) loss 1.9889 (1.8391) ce_loss 1.1650 (0.9096) loss_zs_kd 2.1760 (2.0635) loss_oracle 0.4468 (0.4896) acc 50.0000 (67.5112) kd_loss 0.6005 (0.6847) lr 9.3721e-04 eta 0:15:14
epoch [28/50] batch [300/445] time 0.079 (0.091) data 0.000 (0.009) loss 1.5095 (1.8365) ce_loss 0.7017 (0.9093) loss_zs_kd 1.8004 (2.0618) loss_oracle 0.5094 (0.4901) acc 68.7500 (67.5417) kd_loss 0.5531 (0.6821) lr 9.3721e-04 eta 0:15:04
epoch [28/50] batch [320/445] time 0.085 (0.090) data 0.000 (0.008) loss 2.2843 (1.8367) ce_loss 1.2686 (0.9086) loss_zs_kd 1.7910 (2.0534) loss_oracle 0.5945 (0.4919) acc 62.5000 (67.5488) kd_loss 0.7185 (0.6822) lr 9.3721e-04 eta 0:14:56
epoch [28/50] batch [340/445] time 0.081 (0.090) data 0.000 (0.008) loss 2.0060 (1.8356) ce_loss 1.1338 (0.9080) loss_zs_kd 1.8591 (2.0510) loss_oracle 0.4766 (0.4916) acc 62.5000 (67.6287) kd_loss 0.6339 (0.6818) lr 9.3721e-04 eta 0:14:48
epoch [28/50] batch [360/445] time 0.074 (0.089) data 0.000 (0.008) loss 2.0490 (1.8405) ce_loss 0.9053 (0.9124) loss_zs_kd 2.3775 (2.0498) loss_oracle 0.4854 (0.4923) acc 62.5000 (67.3785) kd_loss 0.9010 (0.6819) lr 9.3721e-04 eta 0:14:39
epoch [28/50] batch [380/445] time 0.082 (0.088) data 0.000 (0.007) loss 1.9081 (1.8389) ce_loss 0.9126 (0.9094) loss_zs_kd 2.0981 (2.0519) loss_oracle 0.4814 (0.4932) acc 68.7500 (67.5411) kd_loss 0.7548 (0.6830) lr 9.3721e-04 eta 0:14:30
epoch [28/50] batch [400/445] time 0.067 (0.088) data 0.000 (0.007) loss 1.7601 (1.8394) ce_loss 0.7900 (0.9094) loss_zs_kd 1.9717 (2.0512) loss_oracle 0.4652 (0.4924) acc 65.6250 (67.4375) kd_loss 0.7375 (0.6838) lr 9.3721e-04 eta 0:14:22
epoch [28/50] batch [420/445] time 0.083 (0.087) data 0.000 (0.006) loss 1.9098 (1.8390) ce_loss 0.8882 (0.9090) loss_zs_kd 1.6653 (2.0506) loss_oracle 0.4994 (0.4911) acc 68.7500 (67.4702) kd_loss 0.7719 (0.6844) lr 9.3721e-04 eta 0:14:17
epoch [28/50] batch [440/445] time 0.083 (0.087) data 0.000 (0.006) loss 1.5070 (1.8401) ce_loss 0.6538 (0.9096) loss_zs_kd 1.9000 (2.0495) loss_oracle 0.4604 (0.4905) acc 81.2500 (67.4645) kd_loss 0.6230 (0.6852) lr 9.3721e-04 eta 0:14:12
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,333
* accuracy: 70.9%
* error: 29.1%
* macro_f1: 58.9%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,064
* accuracy: 52.0%
* error: 48.0%
* macro_f1: 32.8%
******* Domain 3 best val acc:      71.7%, epoch: 23 *******
******* Domain 3 best val test acc: 49.2%, epoch: 23 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [29/50] batch [20/445] time 0.081 (0.264) data 0.001 (0.188) loss 1.8004 (1.7701) ce_loss 0.8521 (0.8289) loss_zs_kd 2.1615 (2.1207) loss_oracle 0.4578 (0.4786) acc 62.5000 (68.9062) kd_loss 0.7194 (0.7019) lr 8.7467e-04 eta 0:42:59
epoch [29/50] batch [40/445] time 0.085 (0.174) data 0.000 (0.094) loss 1.6936 (1.7964) ce_loss 0.8477 (0.8660) loss_zs_kd 2.2413 (2.1351) loss_oracle 0.4705 (0.4802) acc 68.7500 (68.9062) kd_loss 0.6107 (0.6902) lr 8.7467e-04 eta 0:28:18
epoch [29/50] batch [60/445] time 0.089 (0.145) data 0.001 (0.063) loss 1.5876 (1.8207) ce_loss 0.6235 (0.8852) loss_zs_kd 2.2203 (2.1302) loss_oracle 0.5090 (0.4890) acc 78.1250 (69.0625) kd_loss 0.7095 (0.6911) lr 8.7467e-04 eta 0:23:26
epoch [29/50] batch [80/445] time 0.088 (0.129) data 0.000 (0.047) loss 1.7394 (1.7988) ce_loss 0.8091 (0.8634) loss_zs_kd 2.0287 (2.1118) loss_oracle 0.5145 (0.4870) acc 71.8750 (69.9219) kd_loss 0.6731 (0.6919) lr 8.7467e-04 eta 0:20:48
epoch [29/50] batch [100/445] time 0.075 (0.118) data 0.000 (0.038) loss 1.8055 (1.8129) ce_loss 0.8989 (0.8722) loss_zs_kd 2.2797 (2.1154) loss_oracle 0.4482 (0.4882) acc 71.8750 (69.8750) kd_loss 0.6824 (0.6966) lr 8.7467e-04 eta 0:19:07
epoch [29/50] batch [120/445] time 0.075 (0.113) data 0.000 (0.032) loss 1.8389 (1.8148) ce_loss 1.0312 (0.8782) loss_zs_kd 2.1746 (2.1068) loss_oracle 0.4528 (0.4871) acc 62.5000 (69.4271) kd_loss 0.5812 (0.6930) lr 8.7467e-04 eta 0:18:08
epoch [29/50] batch [140/445] time 0.080 (0.108) data 0.000 (0.027) loss 1.6371 (1.8243) ce_loss 0.6587 (0.8855) loss_zs_kd 2.0109 (2.0894) loss_oracle 0.5023 (0.4893) acc 71.8750 (68.9062) kd_loss 0.7272 (0.6942) lr 8.7467e-04 eta 0:17:22
epoch [29/50] batch [160/445] time 0.088 (0.105) data 0.000 (0.024) loss 1.7535 (1.8280) ce_loss 0.7646 (0.8868) loss_zs_kd 1.9624 (2.0879) loss_oracle 0.4322 (0.4899) acc 75.0000 (68.8477) kd_loss 0.7727 (0.6962) lr 8.7467e-04 eta 0:16:48
epoch [29/50] batch [180/445] time 0.079 (0.102) data 0.000 (0.021) loss 1.8784 (1.8188) ce_loss 0.9209 (0.8816) loss_zs_kd 2.1483 (2.0895) loss_oracle 0.4497 (0.4867) acc 62.5000 (69.0625) kd_loss 0.7327 (0.6939) lr 8.7467e-04 eta 0:16:23
epoch [29/50] batch [200/445] time 0.082 (0.100) data 0.000 (0.019) loss 2.0750 (1.8319) ce_loss 1.1777 (0.8942) loss_zs_kd 1.9905 (2.0766) loss_oracle 0.4542 (0.4872) acc 62.5000 (68.5312) kd_loss 0.6702 (0.6941) lr 8.7467e-04 eta 0:15:58
epoch [29/50] batch [220/445] time 0.076 (0.098) data 0.000 (0.017) loss 1.8833 (1.8331) ce_loss 1.0527 (0.8950) loss_zs_kd 2.6972 (2.0719) loss_oracle 0.4187 (0.4858) acc 62.5000 (68.5653) kd_loss 0.6212 (0.6953) lr 8.7467e-04 eta 0:15:36
epoch [29/50] batch [240/445] time 0.084 (0.096) data 0.000 (0.016) loss 1.9338 (1.8407) ce_loss 0.9316 (0.9004) loss_zs_kd 2.0033 (2.0733) loss_oracle 0.4911 (0.4880) acc 65.6250 (68.0469) kd_loss 0.7566 (0.6963) lr 8.7467e-04 eta 0:15:19
epoch [29/50] batch [260/445] time 0.088 (0.095) data 0.000 (0.015) loss 1.9321 (1.8433) ce_loss 1.0889 (0.9036) loss_zs_kd 1.9819 (2.0771) loss_oracle 0.4907 (0.4876) acc 65.6250 (67.8005) kd_loss 0.5979 (0.6958) lr 8.7467e-04 eta 0:15:08
epoch [29/50] batch [280/445] time 0.080 (0.094) data 0.000 (0.014) loss 1.6772 (1.8390) ce_loss 0.7100 (0.9004) loss_zs_kd 1.8660 (2.0697) loss_oracle 0.4322 (0.4866) acc 78.1250 (67.8125) kd_loss 0.7512 (0.6952) lr 8.7467e-04 eta 0:14:57
epoch [29/50] batch [300/445] time 0.084 (0.093) data 0.000 (0.013) loss 1.6411 (1.8401) ce_loss 0.8320 (0.9035) loss_zs_kd 1.9460 (2.0730) loss_oracle 0.4333 (0.4860) acc 62.5000 (67.6146) kd_loss 0.5924 (0.6936) lr 8.7467e-04 eta 0:14:46
epoch [29/50] batch [320/445] time 0.089 (0.093) data 0.000 (0.012) loss 1.8526 (1.8377) ce_loss 0.9434 (0.9029) loss_zs_kd 2.2533 (2.0716) loss_oracle 0.5116 (0.4850) acc 65.6250 (67.6367) kd_loss 0.6534 (0.6922) lr 8.7467e-04 eta 0:14:40
epoch [29/50] batch [340/445] time 0.080 (0.092) data 0.000 (0.011) loss 1.8964 (1.8365) ce_loss 0.8784 (0.9033) loss_zs_kd 1.9116 (2.0637) loss_oracle 0.4942 (0.4845) acc 75.0000 (67.7114) kd_loss 0.7709 (0.6909) lr 8.7467e-04 eta 0:14:33
epoch [29/50] batch [360/445] time 0.084 (0.092) data 0.000 (0.011) loss 1.9714 (1.8361) ce_loss 1.0664 (0.9036) loss_zs_kd 2.2035 (2.0632) loss_oracle 0.5014 (0.4843) acc 59.3750 (67.7083) kd_loss 0.6544 (0.6903) lr 8.7467e-04 eta 0:14:28
epoch [29/50] batch [380/445] time 0.082 (0.092) data 0.000 (0.010) loss 1.7632 (1.8350) ce_loss 0.7642 (0.9029) loss_zs_kd 2.3815 (2.0628) loss_oracle 0.5595 (0.4856) acc 81.2500 (67.8207) kd_loss 0.7193 (0.6892) lr 8.7467e-04 eta 0:14:23
epoch [29/50] batch [400/445] time 0.073 (0.091) data 0.000 (0.010) loss 1.9913 (1.8347) ce_loss 1.0449 (0.9035) loss_zs_kd 2.2333 (2.0584) loss_oracle 0.5195 (0.4855) acc 62.5000 (67.8281) kd_loss 0.6867 (0.6884) lr 8.7467e-04 eta 0:14:17
epoch [29/50] batch [420/445] time 0.084 (0.092) data 0.000 (0.009) loss 1.8284 (1.8374) ce_loss 0.7363 (0.9063) loss_zs_kd 2.3576 (2.0554) loss_oracle 0.5306 (0.4858) acc 71.8750 (67.8571) kd_loss 0.8268 (0.6882) lr 8.7467e-04 eta 0:14:19
epoch [29/50] batch [440/445] time 0.070 (0.091) data 0.000 (0.009) loss 1.7733 (1.8372) ce_loss 0.7856 (0.9059) loss_zs_kd 1.7326 (2.0539) loss_oracle 0.4599 (0.4863) acc 68.7500 (67.9261) kd_loss 0.7577 (0.6881) lr 8.7467e-04 eta 0:14:10
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,401
* accuracy: 72.1%
* error: 27.9%
* macro_f1: 59.8%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,006
* accuracy: 50.5%
* error: 49.5%
* macro_f1: 31.3%
******* Domain 3 best val acc:      72.1%, epoch: 29 *******
******* Domain 3 best val test acc: 50.5%, epoch: 29 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [30/50] batch [20/445] time 0.063 (0.202) data 0.000 (0.134) loss 1.6950 (1.8431) ce_loss 0.7388 (0.9181) loss_zs_kd 1.9621 (2.0762) loss_oracle 0.4351 (0.4948) acc 71.8750 (66.8750) kd_loss 0.7387 (0.6776) lr 8.1262e-04 eta 0:31:20
epoch [30/50] batch [40/445] time 0.065 (0.133) data 0.000 (0.067) loss 1.7627 (1.8466) ce_loss 0.8623 (0.9207) loss_zs_kd 2.1747 (2.0439) loss_oracle 0.4199 (0.4928) acc 68.7500 (67.2656) kd_loss 0.6904 (0.6795) lr 8.1262e-04 eta 0:20:39
epoch [30/50] batch [60/445] time 0.057 (0.110) data 0.000 (0.045) loss 1.9896 (1.8340) ce_loss 1.0244 (0.9198) loss_zs_kd 2.1740 (2.0609) loss_oracle 0.4655 (0.4873) acc 53.1250 (67.2396) kd_loss 0.7324 (0.6705) lr 8.1262e-04 eta 0:17:00
epoch [30/50] batch [80/445] time 0.087 (0.100) data 0.000 (0.034) loss 1.5322 (1.8063) ce_loss 0.5796 (0.9004) loss_zs_kd 2.3129 (2.0652) loss_oracle 0.5856 (0.4846) acc 87.5000 (67.8516) kd_loss 0.6598 (0.6636) lr 8.1262e-04 eta 0:15:25
epoch [30/50] batch [100/445] time 0.080 (0.097) data 0.001 (0.027) loss 1.8299 (1.8001) ce_loss 1.0225 (0.9008) loss_zs_kd 1.6983 (2.0596) loss_oracle 0.4085 (0.4799) acc 71.8750 (68.2500) kd_loss 0.6032 (0.6593) lr 8.1262e-04 eta 0:14:53
epoch [30/50] batch [120/445] time 0.079 (0.094) data 0.000 (0.023) loss 1.6457 (1.8019) ce_loss 0.7451 (0.9060) loss_zs_kd 2.1736 (2.0522) loss_oracle 0.5729 (0.4795) acc 71.8750 (68.2552) kd_loss 0.6141 (0.6561) lr 8.1262e-04 eta 0:14:23
epoch [30/50] batch [140/445] time 0.077 (0.092) data 0.000 (0.019) loss 2.1777 (1.8000) ce_loss 1.1240 (0.9072) loss_zs_kd 2.1210 (2.0415) loss_oracle 0.5135 (0.4787) acc 62.5000 (68.1027) kd_loss 0.7969 (0.6534) lr 8.1262e-04 eta 0:14:04
epoch [30/50] batch [160/445] time 0.089 (0.091) data 0.000 (0.017) loss 1.6107 (1.7948) ce_loss 0.8647 (0.9038) loss_zs_kd 1.8448 (2.0432) loss_oracle 0.4297 (0.4772) acc 78.1250 (68.3008) kd_loss 0.5311 (0.6525) lr 8.1262e-04 eta 0:13:52
epoch [30/50] batch [180/445] time 0.078 (0.090) data 0.000 (0.015) loss 1.5460 (1.7974) ce_loss 0.7534 (0.9075) loss_zs_kd 2.2066 (2.0454) loss_oracle 0.4561 (0.4756) acc 78.1250 (68.1771) kd_loss 0.5645 (0.6521) lr 8.1262e-04 eta 0:13:43
epoch [30/50] batch [200/445] time 0.079 (0.089) data 0.000 (0.014) loss 1.7109 (1.7945) ce_loss 0.7925 (0.9012) loss_zs_kd 1.8119 (2.0462) loss_oracle 0.5167 (0.4787) acc 71.8750 (68.2500) kd_loss 0.6601 (0.6539) lr 8.1262e-04 eta 0:13:35
epoch [30/50] batch [220/445] time 0.076 (0.089) data 0.000 (0.012) loss 1.7364 (1.7914) ce_loss 0.8242 (0.8982) loss_zs_kd 2.8070 (2.0574) loss_oracle 0.5012 (0.4801) acc 71.8750 (68.1392) kd_loss 0.6616 (0.6531) lr 8.1262e-04 eta 0:13:27
epoch [30/50] batch [240/445] time 0.075 (0.088) data 0.000 (0.011) loss 1.5969 (1.7902) ce_loss 0.6484 (0.8968) loss_zs_kd 1.7110 (2.0499) loss_oracle 0.4652 (0.4801) acc 81.2500 (68.2812) kd_loss 0.7159 (0.6533) lr 8.1262e-04 eta 0:13:18
epoch [30/50] batch [260/445] time 0.086 (0.087) data 0.000 (0.011) loss 1.7707 (1.7900) ce_loss 0.8237 (0.8977) loss_zs_kd 1.8740 (2.0471) loss_oracle 0.5228 (0.4807) acc 68.7500 (68.3053) kd_loss 0.6855 (0.6520) lr 8.1262e-04 eta 0:13:12
epoch [30/50] batch [280/445] time 0.083 (0.087) data 0.000 (0.010) loss 1.8383 (1.7873) ce_loss 0.7637 (0.8941) loss_zs_kd 2.0004 (2.0509) loss_oracle 0.5030 (0.4818) acc 78.1250 (68.4375) kd_loss 0.8232 (0.6524) lr 8.1262e-04 eta 0:13:09
epoch [30/50] batch [300/445] time 0.079 (0.087) data 0.000 (0.009) loss 1.8560 (1.7909) ce_loss 0.9746 (0.8977) loss_zs_kd 1.3802 (2.0487) loss_oracle 0.5418 (0.4816) acc 65.6250 (68.2604) kd_loss 0.6105 (0.6524) lr 8.1262e-04 eta 0:13:05
epoch [30/50] batch [320/445] time 0.095 (0.087) data 0.000 (0.009) loss 2.1713 (1.7963) ce_loss 1.1494 (0.9013) loss_zs_kd 2.7170 (2.0485) loss_oracle 0.5323 (0.4820) acc 50.0000 (68.1641) kd_loss 0.7557 (0.6540) lr 8.1262e-04 eta 0:13:02
epoch [30/50] batch [340/445] time 0.088 (0.087) data 0.000 (0.008) loss 1.6930 (1.7937) ce_loss 0.8379 (0.8974) loss_zs_kd 1.8050 (2.0448) loss_oracle 0.4568 (0.4829) acc 75.0000 (68.3548) kd_loss 0.6266 (0.6548) lr 8.1262e-04 eta 0:12:59
epoch [30/50] batch [360/445] time 0.075 (0.086) data 0.000 (0.008) loss 1.6858 (1.7913) ce_loss 0.8789 (0.8956) loss_zs_kd 1.8584 (2.0384) loss_oracle 0.5226 (0.4824) acc 71.8750 (68.4115) kd_loss 0.5456 (0.6545) lr 8.1262e-04 eta 0:12:55
epoch [30/50] batch [380/445] time 0.091 (0.086) data 0.001 (0.007) loss 1.7273 (1.7906) ce_loss 0.7729 (0.8933) loss_zs_kd 2.3512 (2.0445) loss_oracle 0.5475 (0.4834) acc 75.0000 (68.6184) kd_loss 0.6806 (0.6556) lr 8.1262e-04 eta 0:12:52
epoch [30/50] batch [400/445] time 0.078 (0.086) data 0.000 (0.007) loss 1.5591 (1.7908) ce_loss 0.6133 (0.8929) loss_zs_kd 1.7366 (2.0479) loss_oracle 0.4731 (0.4838) acc 78.1250 (68.6641) kd_loss 0.7092 (0.6559) lr 8.1262e-04 eta 0:12:50
epoch [30/50] batch [420/445] time 0.083 (0.086) data 0.000 (0.007) loss 2.0807 (1.7935) ce_loss 1.1104 (0.8948) loss_zs_kd 2.3204 (2.0478) loss_oracle 0.5478 (0.4844) acc 59.3750 (68.4896) kd_loss 0.6965 (0.6565) lr 8.1262e-04 eta 0:12:47
epoch [30/50] batch [440/445] time 0.078 (0.086) data 0.000 (0.006) loss 2.0102 (1.7949) ce_loss 0.9858 (0.8954) loss_zs_kd 1.9651 (2.0471) loss_oracle 0.6198 (0.4847) acc 68.7500 (68.4872) kd_loss 0.7145 (0.6571) lr 8.1262e-04 eta 0:12:43
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,420
* accuracy: 72.4%
* error: 27.6%
* macro_f1: 60.7%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,004
* accuracy: 50.5%
* error: 49.5%
* macro_f1: 31.8%
******* Domain 3 best val acc:      72.4%, epoch: 30 *******
******* Domain 3 best val test acc: 50.5%, epoch: 30 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [31/50] batch [20/445] time 0.080 (0.214) data 0.000 (0.126) loss 1.4694 (1.7829) ce_loss 0.6479 (0.8971) loss_zs_kd 2.0106 (2.1190) loss_oracle 0.4224 (0.4650) acc 75.0000 (70.1562) kd_loss 0.6103 (0.6533) lr 7.5131e-04 eta 0:31:43
epoch [31/50] batch [40/445] time 0.089 (0.150) data 0.000 (0.063) loss 1.8206 (1.7514) ce_loss 0.8789 (0.8621) loss_zs_kd 2.1165 (2.1408) loss_oracle 0.4507 (0.4722) acc 68.7500 (71.1719) kd_loss 0.7164 (0.6532) lr 7.5131e-04 eta 0:22:06
epoch [31/50] batch [60/445] time 0.079 (0.128) data 0.000 (0.042) loss 1.8051 (1.7638) ce_loss 0.9360 (0.8729) loss_zs_kd 2.3923 (2.1022) loss_oracle 0.4399 (0.4769) acc 68.7500 (69.9479) kd_loss 0.6491 (0.6525) lr 7.5131e-04 eta 0:18:54
epoch [31/50] batch [80/445] time 0.082 (0.117) data 0.000 (0.032) loss 1.7935 (1.7737) ce_loss 0.9346 (0.8852) loss_zs_kd 2.0662 (2.0977) loss_oracle 0.4840 (0.4822) acc 65.6250 (69.2969) kd_loss 0.6170 (0.6474) lr 7.5131e-04 eta 0:17:15
epoch [31/50] batch [100/445] time 0.088 (0.111) data 0.000 (0.025) loss 2.0938 (1.7850) ce_loss 1.3164 (0.8939) loss_zs_kd 1.9873 (2.0986) loss_oracle 0.4319 (0.4854) acc 62.5000 (68.9375) kd_loss 0.5614 (0.6484) lr 7.5131e-04 eta 0:16:19
epoch [31/50] batch [120/445] time 0.087 (0.107) data 0.000 (0.021) loss 2.2668 (1.7881) ce_loss 1.4141 (0.8943) loss_zs_kd 2.4282 (2.0990) loss_oracle 0.5217 (0.4882) acc 59.3750 (69.1406) kd_loss 0.5919 (0.6498) lr 7.5131e-04 eta 0:15:38
epoch [31/50] batch [140/445] time 0.085 (0.104) data 0.000 (0.018) loss 1.6733 (1.7950) ce_loss 0.8726 (0.8987) loss_zs_kd 1.8569 (2.1044) loss_oracle 0.4101 (0.4908) acc 68.7500 (68.9732) kd_loss 0.5957 (0.6509) lr 7.5131e-04 eta 0:15:10
epoch [31/50] batch [160/445] time 0.088 (0.102) data 0.000 (0.016) loss 1.9111 (1.7925) ce_loss 1.0547 (0.8941) loss_zs_kd 1.9387 (2.1078) loss_oracle 0.4801 (0.4910) acc 59.3750 (69.0039) kd_loss 0.6164 (0.6530) lr 7.5131e-04 eta 0:14:49
epoch [31/50] batch [180/445] time 0.078 (0.100) data 0.000 (0.014) loss 2.1160 (1.7917) ce_loss 1.1426 (0.8922) loss_zs_kd 2.0120 (2.1055) loss_oracle 0.4945 (0.4915) acc 62.5000 (68.9236) kd_loss 0.7261 (0.6538) lr 7.5131e-04 eta 0:14:32
epoch [31/50] batch [200/445] time 0.086 (0.099) data 0.000 (0.013) loss 1.6903 (1.7908) ce_loss 0.7852 (0.8900) loss_zs_kd 1.6992 (2.0937) loss_oracle 0.4675 (0.4898) acc 71.8750 (68.8438) kd_loss 0.6714 (0.6559) lr 7.5131e-04 eta 0:14:17
epoch [31/50] batch [220/445] time 0.085 (0.097) data 0.000 (0.012) loss 1.7806 (1.7934) ce_loss 0.7563 (0.8917) loss_zs_kd 2.2940 (2.0938) loss_oracle 0.5848 (0.4872) acc 71.8750 (68.7642) kd_loss 0.7318 (0.6581) lr 7.5131e-04 eta 0:14:04
epoch [31/50] batch [240/445] time 0.087 (0.096) data 0.000 (0.011) loss 1.6191 (1.7960) ce_loss 0.7451 (0.8931) loss_zs_kd 2.4435 (2.0916) loss_oracle 0.4263 (0.4853) acc 78.1250 (68.6068) kd_loss 0.6608 (0.6602) lr 7.5131e-04 eta 0:13:52
epoch [31/50] batch [260/445] time 0.079 (0.095) data 0.000 (0.010) loss 1.8294 (1.7964) ce_loss 0.8560 (0.8930) loss_zs_kd 2.0703 (2.0864) loss_oracle 0.5648 (0.4852) acc 62.5000 (68.3293) kd_loss 0.6911 (0.6608) lr 7.5131e-04 eta 0:13:41
epoch [31/50] batch [280/445] time 0.083 (0.094) data 0.000 (0.009) loss 1.5351 (1.8012) ce_loss 0.7446 (0.8962) loss_zs_kd 2.0783 (2.0861) loss_oracle 0.4508 (0.4864) acc 78.1250 (68.3036) kd_loss 0.5651 (0.6619) lr 7.5131e-04 eta 0:13:34
epoch [31/50] batch [300/445] time 0.075 (0.094) data 0.000 (0.009) loss 1.4795 (1.7988) ce_loss 0.6655 (0.8940) loss_zs_kd 2.0589 (2.0808) loss_oracle 0.4102 (0.4857) acc 78.1250 (68.4583) kd_loss 0.6088 (0.6620) lr 7.5131e-04 eta 0:13:26
epoch [31/50] batch [320/445] time 0.083 (0.093) data 0.000 (0.008) loss 1.9400 (1.7966) ce_loss 0.9263 (0.8939) loss_zs_kd 2.2340 (2.0731) loss_oracle 0.5565 (0.4842) acc 65.6250 (68.5059) kd_loss 0.7355 (0.6606) lr 7.5131e-04 eta 0:13:17
epoch [31/50] batch [340/445] time 0.081 (0.092) data 0.000 (0.008) loss 1.9115 (1.8008) ce_loss 1.0527 (0.8974) loss_zs_kd 2.5326 (2.0751) loss_oracle 0.4691 (0.4849) acc 56.2500 (68.3364) kd_loss 0.6242 (0.6610) lr 7.5131e-04 eta 0:13:08
epoch [31/50] batch [360/445] time 0.085 (0.092) data 0.000 (0.007) loss 1.6400 (1.7990) ce_loss 0.7671 (0.8976) loss_zs_kd 1.6285 (2.0688) loss_oracle 0.4798 (0.4839) acc 65.6250 (68.2639) kd_loss 0.6331 (0.6594) lr 7.5131e-04 eta 0:13:03
epoch [31/50] batch [380/445] time 0.083 (0.091) data 0.000 (0.007) loss 1.6607 (1.7976) ce_loss 0.8076 (0.8978) loss_zs_kd 1.4212 (2.0649) loss_oracle 0.3711 (0.4822) acc 65.6250 (68.1908) kd_loss 0.6675 (0.6587) lr 7.5131e-04 eta 0:12:55
epoch [31/50] batch [400/445] time 0.077 (0.090) data 0.000 (0.007) loss 1.5955 (1.7961) ce_loss 0.8315 (0.8965) loss_zs_kd 1.7237 (2.0591) loss_oracle 0.4210 (0.4823) acc 68.7500 (68.1875) kd_loss 0.5535 (0.6584) lr 7.5131e-04 eta 0:12:49
epoch [31/50] batch [420/445] time 0.077 (0.090) data 0.000 (0.006) loss 1.5050 (1.7943) ce_loss 0.5786 (0.8966) loss_zs_kd 1.9357 (2.0671) loss_oracle 0.4969 (0.4822) acc 68.7500 (68.0878) kd_loss 0.6780 (0.6566) lr 7.5131e-04 eta 0:12:43
epoch [31/50] batch [440/445] time 0.075 (0.089) data 0.000 (0.006) loss 1.8265 (1.7974) ce_loss 0.9419 (0.8990) loss_zs_kd 2.4026 (2.0691) loss_oracle 0.4850 (0.4827) acc 68.7500 (68.0043) kd_loss 0.6421 (0.6571) lr 7.5131e-04 eta 0:12:37
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,423
* accuracy: 72.4%
* error: 27.6%
* macro_f1: 60.8%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,085
* accuracy: 52.5%
* error: 47.5%
* macro_f1: 34.1%
******* Domain 3 best val acc:      72.4%, epoch: 31 *******
******* Domain 3 best val test acc: 52.5%, epoch: 31 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [32/50] batch [20/445] time 0.073 (0.244) data 0.000 (0.155) loss 1.7571 (1.7376) ce_loss 0.8843 (0.8610) loss_zs_kd 2.0871 (2.0336) loss_oracle 0.5172 (0.4800) acc 68.7500 (69.5312) kd_loss 0.6143 (0.6367) lr 6.9098e-04 eta 0:34:17
epoch [32/50] batch [40/445] time 0.076 (0.163) data 0.000 (0.078) loss 1.7285 (1.7558) ce_loss 0.9048 (0.8799) loss_zs_kd 1.8015 (2.0136) loss_oracle 0.5567 (0.4883) acc 68.7500 (68.0469) kd_loss 0.5453 (0.6318) lr 6.9098e-04 eta 0:22:53
epoch [32/50] batch [60/445] time 0.089 (0.135) data 0.000 (0.052) loss 1.6061 (1.7292) ce_loss 0.6826 (0.8551) loss_zs_kd 1.4730 (2.0205) loss_oracle 0.4524 (0.4808) acc 78.1250 (69.1146) kd_loss 0.6973 (0.6337) lr 6.9098e-04 eta 0:18:56
epoch [32/50] batch [80/445] time 0.083 (0.122) data 0.000 (0.039) loss 1.7207 (1.7364) ce_loss 0.8135 (0.8552) loss_zs_kd 2.1550 (2.0469) loss_oracle 0.5384 (0.4800) acc 78.1250 (69.3750) kd_loss 0.6380 (0.6412) lr 6.9098e-04 eta 0:17:02
epoch [32/50] batch [100/445] time 0.085 (0.114) data 0.000 (0.031) loss 1.9149 (1.7374) ce_loss 1.0977 (0.8578) loss_zs_kd 1.8954 (2.0262) loss_oracle 0.4320 (0.4801) acc 65.6250 (69.2188) kd_loss 0.6013 (0.6395) lr 6.9098e-04 eta 0:15:54
epoch [32/50] batch [120/445] time 0.093 (0.110) data 0.000 (0.026) loss 1.5438 (1.7337) ce_loss 0.6499 (0.8571) loss_zs_kd 2.0455 (2.0131) loss_oracle 0.5066 (0.4796) acc 75.0000 (69.3490) kd_loss 0.6406 (0.6368) lr 6.9098e-04 eta 0:15:13
epoch [32/50] batch [140/445] time 0.084 (0.106) data 0.000 (0.022) loss 1.8872 (1.7441) ce_loss 1.0000 (0.8703) loss_zs_kd 2.4139 (2.0257) loss_oracle 0.4535 (0.4785) acc 59.3750 (69.0848) kd_loss 0.6605 (0.6345) lr 6.9098e-04 eta 0:14:42
epoch [32/50] batch [160/445] time 0.085 (0.104) data 0.000 (0.020) loss 1.9145 (1.7470) ce_loss 1.0156 (0.8725) loss_zs_kd 1.9134 (2.0307) loss_oracle 0.5217 (0.4783) acc 65.6250 (68.7695) kd_loss 0.6380 (0.6353) lr 6.9098e-04 eta 0:14:21
epoch [32/50] batch [180/445] time 0.088 (0.101) data 0.000 (0.018) loss 1.8349 (1.7478) ce_loss 1.0762 (0.8730) loss_zs_kd 2.3873 (2.0440) loss_oracle 0.4061 (0.4780) acc 50.0000 (68.6979) kd_loss 0.5556 (0.6358) lr 6.9098e-04 eta 0:13:55
epoch [32/50] batch [200/445] time 0.083 (0.099) data 0.000 (0.016) loss 1.6982 (1.7468) ce_loss 0.7119 (0.8707) loss_zs_kd 2.5401 (2.0526) loss_oracle 0.5810 (0.4785) acc 71.8750 (68.7031) kd_loss 0.6958 (0.6368) lr 6.9098e-04 eta 0:13:39
epoch [32/50] batch [220/445] time 0.091 (0.098) data 0.000 (0.014) loss 1.9608 (1.7436) ce_loss 1.0410 (0.8660) loss_zs_kd 2.2613 (2.0655) loss_oracle 0.4601 (0.4785) acc 62.5000 (69.0057) kd_loss 0.6897 (0.6383) lr 6.9098e-04 eta 0:13:23
epoch [32/50] batch [240/445] time 0.070 (0.096) data 0.000 (0.013) loss 1.6305 (1.7453) ce_loss 0.5986 (0.8634) loss_zs_kd 2.5206 (2.0845) loss_oracle 0.5596 (0.4803) acc 75.0000 (69.1927) kd_loss 0.7520 (0.6418) lr 6.9098e-04 eta 0:13:10
epoch [32/50] batch [260/445] time 0.082 (0.095) data 0.000 (0.012) loss 2.0871 (1.7490) ce_loss 1.1104 (0.8669) loss_zs_kd 2.4251 (2.0942) loss_oracle 0.4947 (0.4786) acc 68.7500 (68.9784) kd_loss 0.7294 (0.6428) lr 6.9098e-04 eta 0:12:59
epoch [32/50] batch [280/445] time 0.083 (0.094) data 0.000 (0.011) loss 1.8666 (1.7546) ce_loss 0.9258 (0.8721) loss_zs_kd 2.0702 (2.0999) loss_oracle 0.4706 (0.4787) acc 68.7500 (68.7500) kd_loss 0.7056 (0.6432) lr 6.9098e-04 eta 0:12:51
epoch [32/50] batch [300/445] time 0.084 (0.093) data 0.000 (0.011) loss 2.0948 (1.7584) ce_loss 1.2354 (0.8753) loss_zs_kd 2.2566 (2.0949) loss_oracle 0.5270 (0.4794) acc 56.2500 (68.5312) kd_loss 0.5960 (0.6433) lr 6.9098e-04 eta 0:12:40
epoch [32/50] batch [320/445] time 0.081 (0.092) data 0.000 (0.010) loss 1.7944 (1.7643) ce_loss 0.7842 (0.8781) loss_zs_kd 2.2729 (2.0882) loss_oracle 0.6135 (0.4804) acc 75.0000 (68.4961) kd_loss 0.7035 (0.6460) lr 6.9098e-04 eta 0:12:32
epoch [32/50] batch [340/445] time 0.079 (0.092) data 0.000 (0.009) loss 1.7947 (1.7660) ce_loss 0.8564 (0.8779) loss_zs_kd 1.7311 (2.0956) loss_oracle 0.5703 (0.4808) acc 71.8750 (68.5110) kd_loss 0.6531 (0.6476) lr 6.9098e-04 eta 0:12:26
epoch [32/50] batch [360/445] time 0.085 (0.092) data 0.000 (0.009) loss 2.0244 (1.7712) ce_loss 1.1152 (0.8801) loss_zs_kd 1.9517 (2.0988) loss_oracle 0.5366 (0.4819) acc 62.5000 (68.3594) kd_loss 0.6409 (0.6501) lr 6.9098e-04 eta 0:12:21
epoch [32/50] batch [380/445] time 0.089 (0.091) data 0.000 (0.008) loss 1.7266 (1.7742) ce_loss 0.7461 (0.8819) loss_zs_kd 2.3768 (2.1045) loss_oracle 0.5196 (0.4823) acc 78.1250 (68.3799) kd_loss 0.7207 (0.6512) lr 6.9098e-04 eta 0:12:15
epoch [32/50] batch [400/445] time 0.086 (0.091) data 0.000 (0.008) loss 1.8498 (1.7811) ce_loss 0.9502 (0.8861) loss_zs_kd 1.8453 (2.1053) loss_oracle 0.4302 (0.4827) acc 62.5000 (68.1953) kd_loss 0.6845 (0.6537) lr 6.9098e-04 eta 0:12:11
epoch [32/50] batch [420/445] time 0.082 (0.090) data 0.000 (0.008) loss 1.8495 (1.7835) ce_loss 0.7920 (0.8869) loss_zs_kd 2.2700 (2.0985) loss_oracle 0.4842 (0.4829) acc 75.0000 (68.1101) kd_loss 0.8154 (0.6551) lr 6.9098e-04 eta 0:12:06
epoch [32/50] batch [440/445] time 0.077 (0.090) data 0.000 (0.007) loss 1.5704 (1.7858) ce_loss 0.6694 (0.8880) loss_zs_kd 1.7915 (2.0949) loss_oracle 0.4194 (0.4817) acc 84.3750 (68.1250) kd_loss 0.6912 (0.6569) lr 6.9098e-04 eta 0:12:01
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,384
* accuracy: 71.8%
* error: 28.2%
* macro_f1: 59.4%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,044
* accuracy: 51.5%
* error: 48.5%
* macro_f1: 32.1%
******* Domain 3 best val acc:      72.4%, epoch: 31 *******
******* Domain 3 best val test acc: 52.5%, epoch: 31 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [33/50] batch [20/445] time 0.083 (0.295) data 0.000 (0.202) loss 1.9722 (1.7927) ce_loss 0.8623 (0.8639) loss_zs_kd 1.7136 (1.9854) loss_oracle 0.6285 (0.4844) acc 75.0000 (73.2812) kd_loss 0.7957 (0.6866) lr 6.3188e-04 eta 0:39:15
epoch [33/50] batch [40/445] time 0.083 (0.189) data 0.000 (0.101) loss 1.4939 (1.8111) ce_loss 0.6265 (0.8793) loss_zs_kd 2.0159 (2.0527) loss_oracle 0.4033 (0.4823) acc 71.8750 (70.7812) kd_loss 0.6658 (0.6906) lr 6.3188e-04 eta 0:25:09
epoch [33/50] batch [60/445] time 0.084 (0.155) data 0.000 (0.067) loss 2.0998 (1.8396) ce_loss 1.0850 (0.9124) loss_zs_kd 2.3668 (2.0873) loss_oracle 0.4915 (0.4873) acc 65.6250 (68.5938) kd_loss 0.7691 (0.6835) lr 6.3188e-04 eta 0:20:28
epoch [33/50] batch [80/445] time 0.088 (0.137) data 0.000 (0.051) loss 1.8162 (1.8404) ce_loss 0.8804 (0.9104) loss_zs_kd 2.3548 (2.0732) loss_oracle 0.4492 (0.4877) acc 65.6250 (68.7109) kd_loss 0.7113 (0.6862) lr 6.3188e-04 eta 0:18:05
epoch [33/50] batch [100/445] time 0.087 (0.126) data 0.000 (0.041) loss 2.2260 (1.8415) ce_loss 1.3916 (0.9116) loss_zs_kd 1.9445 (2.0740) loss_oracle 0.4515 (0.4879) acc 37.5000 (68.3750) kd_loss 0.6087 (0.6859) lr 6.3188e-04 eta 0:16:40
epoch [33/50] batch [120/445] time 0.092 (0.119) data 0.000 (0.034) loss 1.7584 (1.8461) ce_loss 0.7275 (0.9121) loss_zs_kd 2.1056 (2.0572) loss_oracle 0.5604 (0.4917) acc 78.1250 (68.1250) kd_loss 0.7507 (0.6881) lr 6.3188e-04 eta 0:15:42
epoch [33/50] batch [140/445] time 0.079 (0.115) data 0.000 (0.029) loss 1.5901 (1.8372) ce_loss 0.6870 (0.9046) loss_zs_kd 2.0889 (2.0669) loss_oracle 0.4513 (0.4898) acc 78.1250 (68.0580) kd_loss 0.6774 (0.6877) lr 6.3188e-04 eta 0:15:01
epoch [33/50] batch [160/445] time 0.076 (0.110) data 0.000 (0.025) loss 1.5849 (1.8403) ce_loss 0.7354 (0.9040) loss_zs_kd 2.7282 (2.0766) loss_oracle 0.5417 (0.4916) acc 68.7500 (68.1445) kd_loss 0.5787 (0.6905) lr 6.3188e-04 eta 0:14:25
epoch [33/50] batch [180/445] time 0.081 (0.107) data 0.000 (0.023) loss 1.6472 (1.8314) ce_loss 0.5259 (0.8935) loss_zs_kd 1.7854 (2.0814) loss_oracle 0.5061 (0.4895) acc 78.1250 (68.4722) kd_loss 0.8683 (0.6932) lr 6.3188e-04 eta 0:13:58
epoch [33/50] batch [200/445] time 0.086 (0.105) data 0.000 (0.020) loss 1.5548 (1.8329) ce_loss 0.6470 (0.8967) loss_zs_kd 2.1028 (2.0807) loss_oracle 0.3945 (0.4890) acc 78.1250 (68.2500) kd_loss 0.7105 (0.6916) lr 6.3188e-04 eta 0:13:38
epoch [33/50] batch [220/445] time 0.088 (0.103) data 0.000 (0.019) loss 1.6438 (1.8367) ce_loss 0.7456 (0.8994) loss_zs_kd 2.0501 (2.0905) loss_oracle 0.5698 (0.4899) acc 71.8750 (68.2244) kd_loss 0.6133 (0.6923) lr 6.3188e-04 eta 0:13:21
epoch [33/50] batch [240/445] time 0.083 (0.101) data 0.000 (0.017) loss 1.8784 (1.8401) ce_loss 0.8955 (0.9035) loss_zs_kd 1.7243 (2.0904) loss_oracle 0.4723 (0.4885) acc 68.7500 (67.9948) kd_loss 0.7468 (0.6923) lr 6.3188e-04 eta 0:13:06
epoch [33/50] batch [260/445] time 0.084 (0.100) data 0.000 (0.016) loss 1.4923 (1.8398) ce_loss 0.5264 (0.9017) loss_zs_kd 2.2490 (2.0892) loss_oracle 0.5395 (0.4902) acc 84.3750 (68.1010) kd_loss 0.6962 (0.6930) lr 6.3188e-04 eta 0:12:54
epoch [33/50] batch [280/445] time 0.088 (0.099) data 0.000 (0.015) loss 1.7285 (1.8373) ce_loss 0.7583 (0.8988) loss_zs_kd 1.8848 (2.0830) loss_oracle 0.4782 (0.4900) acc 71.8750 (68.3371) kd_loss 0.7311 (0.6935) lr 6.3188e-04 eta 0:12:45
epoch [33/50] batch [300/445] time 0.082 (0.098) data 0.000 (0.014) loss 1.6166 (1.8389) ce_loss 0.6934 (0.8990) loss_zs_kd 2.1831 (2.0822) loss_oracle 0.5524 (0.4909) acc 68.7500 (68.3125) kd_loss 0.6471 (0.6945) lr 6.3188e-04 eta 0:12:36
epoch [33/50] batch [320/445] time 0.087 (0.097) data 0.000 (0.013) loss 1.6552 (1.8361) ce_loss 0.7739 (0.8963) loss_zs_kd 2.0884 (2.0790) loss_oracle 0.3964 (0.4888) acc 65.6250 (68.3398) kd_loss 0.6830 (0.6954) lr 6.3188e-04 eta 0:12:28
epoch [33/50] batch [340/445] time 0.088 (0.097) data 0.000 (0.012) loss 1.9134 (1.8374) ce_loss 0.9995 (0.8973) loss_zs_kd 1.8096 (2.0768) loss_oracle 0.3885 (0.4871) acc 59.3750 (68.2812) kd_loss 0.7196 (0.6965) lr 6.3188e-04 eta 0:12:20
epoch [33/50] batch [360/445] time 0.087 (0.096) data 0.000 (0.011) loss 1.9914 (1.8362) ce_loss 1.1670 (0.8964) loss_zs_kd 2.1423 (2.0710) loss_oracle 0.4333 (0.4859) acc 53.1250 (68.2378) kd_loss 0.6078 (0.6969) lr 6.3188e-04 eta 0:12:15
epoch [33/50] batch [380/445] time 0.079 (0.095) data 0.000 (0.011) loss 1.7272 (1.8356) ce_loss 0.7866 (0.8949) loss_zs_kd 2.1412 (2.0685) loss_oracle 0.4869 (0.4858) acc 75.0000 (68.3388) kd_loss 0.6971 (0.6978) lr 6.3188e-04 eta 0:12:07
epoch [33/50] batch [400/445] time 0.078 (0.095) data 0.000 (0.010) loss 2.0673 (1.8354) ce_loss 1.0498 (0.8965) loss_zs_kd 2.2148 (2.0707) loss_oracle 0.4464 (0.4849) acc 65.6250 (68.1719) kd_loss 0.7943 (0.6965) lr 6.3188e-04 eta 0:11:59
epoch [33/50] batch [420/445] time 0.089 (0.094) data 0.000 (0.010) loss 2.0727 (1.8341) ce_loss 1.1572 (0.8956) loss_zs_kd 2.3490 (2.0788) loss_oracle 0.4886 (0.4849) acc 62.5000 (68.3110) kd_loss 0.6711 (0.6961) lr 6.3188e-04 eta 0:11:53
epoch [33/50] batch [440/445] time 0.080 (0.094) data 0.000 (0.009) loss 1.7552 (1.8315) ce_loss 0.9326 (0.8935) loss_zs_kd 2.3350 (2.0793) loss_oracle 0.4684 (0.4850) acc 65.6250 (68.3168) kd_loss 0.5884 (0.6955) lr 6.3188e-04 eta 0:11:48
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,410
* accuracy: 72.2%
* error: 27.8%
* macro_f1: 60.7%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,075
* accuracy: 52.3%
* error: 47.7%
* macro_f1: 33.6%
******* Domain 3 best val acc:      72.4%, epoch: 31 *******
******* Domain 3 best val test acc: 52.5%, epoch: 31 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [34/50] batch [20/445] time 0.068 (0.246) data 0.000 (0.177) loss 1.5506 (1.8054) ce_loss 0.6196 (0.8868) loss_zs_kd 2.1130 (2.0306) loss_oracle 0.5559 (0.4866) acc 87.5000 (68.5938) kd_loss 0.6530 (0.6753) lr 5.7422e-04 eta 0:30:57
epoch [34/50] batch [40/445] time 0.082 (0.163) data 0.001 (0.089) loss 1.9704 (1.7949) ce_loss 0.9136 (0.8661) loss_zs_kd 2.3150 (2.0743) loss_oracle 0.5757 (0.4874) acc 68.7500 (69.4531) kd_loss 0.7690 (0.6851) lr 5.7422e-04 eta 0:20:24
epoch [34/50] batch [60/445] time 0.088 (0.136) data 0.000 (0.059) loss 1.5836 (1.8065) ce_loss 0.6753 (0.8749) loss_zs_kd 2.0067 (2.0498) loss_oracle 0.4464 (0.4960) acc 81.2500 (68.6979) kd_loss 0.6851 (0.6837) lr 5.7422e-04 eta 0:17:03
epoch [34/50] batch [80/445] time 0.080 (0.124) data 0.000 (0.044) loss 1.7936 (1.8189) ce_loss 0.8008 (0.8762) loss_zs_kd 2.0608 (2.0872) loss_oracle 0.4353 (0.4998) acc 65.6250 (68.5547) kd_loss 0.7752 (0.6928) lr 5.7422e-04 eta 0:15:24
epoch [34/50] batch [100/445] time 0.088 (0.116) data 0.000 (0.036) loss 1.6579 (1.8256) ce_loss 0.7295 (0.8886) loss_zs_kd 2.0501 (2.0884) loss_oracle 0.3974 (0.4957) acc 78.1250 (67.9375) kd_loss 0.7297 (0.6891) lr 5.7422e-04 eta 0:14:25
epoch [34/50] batch [120/445] time 0.084 (0.110) data 0.000 (0.030) loss 1.9319 (1.8308) ce_loss 1.0830 (0.9009) loss_zs_kd 2.1460 (2.0878) loss_oracle 0.4940 (0.4933) acc 62.5000 (67.3698) kd_loss 0.6019 (0.6832) lr 5.7422e-04 eta 0:13:42
epoch [34/50] batch [140/445] time 0.084 (0.107) data 0.001 (0.026) loss 1.5870 (1.8308) ce_loss 0.5645 (0.9027) loss_zs_kd 1.7458 (2.0762) loss_oracle 0.4867 (0.4919) acc 87.5000 (67.1875) kd_loss 0.7792 (0.6821) lr 5.7422e-04 eta 0:13:12
epoch [34/50] batch [160/445] time 0.081 (0.104) data 0.000 (0.022) loss 1.7468 (1.8200) ce_loss 0.7446 (0.8931) loss_zs_kd 1.7805 (2.0751) loss_oracle 0.4926 (0.4921) acc 78.1250 (67.7734) kd_loss 0.7559 (0.6809) lr 5.7422e-04 eta 0:12:50
epoch [34/50] batch [180/445] time 0.095 (0.102) data 0.000 (0.020) loss 2.0634 (1.8123) ce_loss 1.0020 (0.8860) loss_zs_kd 2.2554 (2.0733) loss_oracle 0.4960 (0.4919) acc 59.3750 (67.9688) kd_loss 0.8134 (0.6803) lr 5.7422e-04 eta 0:12:35
epoch [34/50] batch [200/445] time 0.088 (0.100) data 0.000 (0.018) loss 1.8795 (1.8121) ce_loss 0.8848 (0.8843) loss_zs_kd 2.1407 (2.0809) loss_oracle 0.5973 (0.4923) acc 65.6250 (67.9688) kd_loss 0.6961 (0.6817) lr 5.7422e-04 eta 0:12:18
epoch [34/50] batch [220/445] time 0.087 (0.099) data 0.000 (0.016) loss 1.6024 (1.8073) ce_loss 0.8560 (0.8786) loss_zs_kd 1.8580 (2.0727) loss_oracle 0.4426 (0.4906) acc 68.7500 (68.2812) kd_loss 0.5251 (0.6834) lr 5.7422e-04 eta 0:12:05
epoch [34/50] batch [240/445] time 0.078 (0.098) data 0.000 (0.015) loss 1.6112 (1.8088) ce_loss 0.7710 (0.8817) loss_zs_kd 1.8973 (2.0719) loss_oracle 0.4507 (0.4912) acc 62.5000 (68.1771) kd_loss 0.6149 (0.6815) lr 5.7422e-04 eta 0:11:54
epoch [34/50] batch [260/445] time 0.085 (0.096) data 0.000 (0.014) loss 1.8864 (1.8050) ce_loss 1.0312 (0.8779) loss_zs_kd 1.9263 (2.0647) loss_oracle 0.4670 (0.4899) acc 62.5000 (68.4375) kd_loss 0.6216 (0.6822) lr 5.7422e-04 eta 0:11:41
epoch [34/50] batch [280/445] time 0.086 (0.095) data 0.000 (0.013) loss 1.9728 (1.8035) ce_loss 0.9736 (0.8770) loss_zs_kd 2.3565 (2.0669) loss_oracle 0.5201 (0.4892) acc 59.3750 (68.6272) kd_loss 0.7391 (0.6820) lr 5.7422e-04 eta 0:11:35
epoch [34/50] batch [300/445] time 0.081 (0.094) data 0.000 (0.012) loss 2.3786 (1.8023) ce_loss 1.3545 (0.8788) loss_zs_kd 2.0396 (2.0624) loss_oracle 0.6249 (0.4889) acc 56.2500 (68.5208) kd_loss 0.7117 (0.6790) lr 5.7422e-04 eta 0:11:24
epoch [34/50] batch [320/445] time 0.081 (0.094) data 0.000 (0.011) loss 1.8551 (1.8061) ce_loss 0.9595 (0.8860) loss_zs_kd 2.3770 (2.0695) loss_oracle 0.4537 (0.4871) acc 75.0000 (68.2812) kd_loss 0.6687 (0.6765) lr 5.7422e-04 eta 0:11:18
epoch [34/50] batch [340/445] time 0.094 (0.093) data 0.000 (0.011) loss 1.7706 (1.8054) ce_loss 0.9136 (0.8877) loss_zs_kd 2.4895 (2.0712) loss_oracle 0.4389 (0.4875) acc 68.7500 (68.2445) kd_loss 0.6375 (0.6740) lr 5.7422e-04 eta 0:11:13
epoch [34/50] batch [360/445] time 0.082 (0.093) data 0.000 (0.010) loss 1.6469 (1.8056) ce_loss 0.7656 (0.8908) loss_zs_kd 1.8769 (2.0599) loss_oracle 0.4729 (0.4879) acc 81.2500 (68.1250) kd_loss 0.6449 (0.6708) lr 5.7422e-04 eta 0:11:07
epoch [34/50] batch [380/445] time 0.089 (0.092) data 0.000 (0.010) loss 1.7442 (1.8012) ce_loss 0.9443 (0.8887) loss_zs_kd 2.3850 (2.0593) loss_oracle 0.4290 (0.4868) acc 59.3750 (68.2401) kd_loss 0.5854 (0.6691) lr 5.7422e-04 eta 0:11:03
epoch [34/50] batch [400/445] time 0.083 (0.092) data 0.001 (0.009) loss 1.7143 (1.8046) ce_loss 0.9663 (0.8911) loss_zs_kd 2.4144 (2.0612) loss_oracle 0.4351 (0.4877) acc 68.7500 (68.2109) kd_loss 0.5305 (0.6697) lr 5.7422e-04 eta 0:10:59
epoch [34/50] batch [420/445] time 0.080 (0.092) data 0.000 (0.009) loss 1.8233 (1.8062) ce_loss 1.0596 (0.8929) loss_zs_kd 1.9061 (2.0632) loss_oracle 0.4252 (0.4879) acc 62.5000 (67.9985) kd_loss 0.5511 (0.6693) lr 5.7422e-04 eta 0:10:55
epoch [34/50] batch [440/445] time 0.077 (0.091) data 0.000 (0.008) loss 1.9258 (1.8073) ce_loss 1.0225 (0.8940) loss_zs_kd 1.9836 (2.0672) loss_oracle 0.5441 (0.4880) acc 65.6250 (67.9901) kd_loss 0.6312 (0.6692) lr 5.7422e-04 eta 0:10:50
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,414
* accuracy: 72.3%
* error: 27.7%
* macro_f1: 59.8%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,030
* accuracy: 51.1%
* error: 48.9%
* macro_f1: 30.7%
******* Domain 3 best val acc:      72.4%, epoch: 31 *******
******* Domain 3 best val test acc: 52.5%, epoch: 31 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [35/50] batch [20/445] time 0.083 (0.277) data 0.000 (0.192) loss 1.4685 (1.7361) ce_loss 0.6782 (0.8440) loss_zs_kd 2.1558 (2.1194) loss_oracle 0.3821 (0.4631) acc 84.3750 (69.6875) kd_loss 0.5992 (0.6605) lr 5.1825e-04 eta 0:32:49
epoch [35/50] batch [40/445] time 0.088 (0.179) data 0.000 (0.096) loss 1.7729 (1.7579) ce_loss 0.9766 (0.8630) loss_zs_kd 1.5284 (2.0329) loss_oracle 0.4469 (0.4670) acc 62.5000 (69.7656) kd_loss 0.5729 (0.6615) lr 5.1825e-04 eta 0:21:10
epoch [35/50] batch [60/445] time 0.085 (0.149) data 0.000 (0.064) loss 1.6780 (1.7669) ce_loss 0.7305 (0.8610) loss_zs_kd 2.2957 (2.0313) loss_oracle 0.5443 (0.4714) acc 68.7500 (69.7396) kd_loss 0.6754 (0.6702) lr 5.1825e-04 eta 0:17:32
epoch [35/50] batch [80/445] time 0.086 (0.133) data 0.000 (0.048) loss 1.8988 (1.7719) ce_loss 1.0049 (0.8681) loss_zs_kd 2.1682 (2.0616) loss_oracle 0.4313 (0.4681) acc 65.6250 (69.1406) kd_loss 0.6783 (0.6698) lr 5.1825e-04 eta 0:15:33
epoch [35/50] batch [100/445] time 0.088 (0.124) data 0.000 (0.039) loss 1.8357 (1.7770) ce_loss 0.8721 (0.8733) loss_zs_kd 1.7725 (2.0678) loss_oracle 0.3999 (0.4691) acc 65.6250 (69.1250) kd_loss 0.7636 (0.6692) lr 5.1825e-04 eta 0:14:27
epoch [35/50] batch [120/445] time 0.083 (0.117) data 0.000 (0.032) loss 1.6906 (1.7806) ce_loss 0.8105 (0.8794) loss_zs_kd 2.1390 (2.1054) loss_oracle 0.4475 (0.4707) acc 71.8750 (68.7760) kd_loss 0.6563 (0.6658) lr 5.1825e-04 eta 0:13:40
epoch [35/50] batch [140/445] time 0.082 (0.112) data 0.000 (0.028) loss 1.5807 (1.7819) ce_loss 0.8071 (0.8805) loss_zs_kd 1.8964 (2.1000) loss_oracle 0.4272 (0.4720) acc 71.8750 (68.5268) kd_loss 0.5600 (0.6654) lr 5.1825e-04 eta 0:13:01
epoch [35/50] batch [160/445] time 0.090 (0.109) data 0.000 (0.024) loss 2.2748 (1.7887) ce_loss 1.2754 (0.8852) loss_zs_kd 2.1833 (2.1067) loss_oracle 0.4350 (0.4742) acc 53.1250 (68.3984) kd_loss 0.7819 (0.6664) lr 5.1825e-04 eta 0:12:36
epoch [35/50] batch [180/445] time 0.081 (0.106) data 0.000 (0.022) loss 1.8657 (1.7832) ce_loss 0.9409 (0.8825) loss_zs_kd 1.7422 (2.0973) loss_oracle 0.5364 (0.4726) acc 59.3750 (68.5764) kd_loss 0.6566 (0.6644) lr 5.1825e-04 eta 0:12:14
epoch [35/50] batch [200/445] time 0.079 (0.104) data 0.000 (0.019) loss 1.9674 (1.7852) ce_loss 1.0127 (0.8839) loss_zs_kd 1.8409 (2.0815) loss_oracle 0.4679 (0.4728) acc 65.6250 (68.4688) kd_loss 0.7207 (0.6649) lr 5.1825e-04 eta 0:11:57
epoch [35/50] batch [220/445] time 0.082 (0.101) data 0.000 (0.018) loss 1.7671 (1.7799) ce_loss 0.8765 (0.8819) loss_zs_kd 1.9349 (2.0831) loss_oracle 0.4046 (0.4707) acc 68.7500 (68.7074) kd_loss 0.6883 (0.6626) lr 5.1825e-04 eta 0:11:40
epoch [35/50] batch [240/445] time 0.084 (0.100) data 0.000 (0.016) loss 1.7020 (1.7807) ce_loss 0.8008 (0.8820) loss_zs_kd 1.7733 (2.0794) loss_oracle 0.5266 (0.4707) acc 68.7500 (68.6719) kd_loss 0.6379 (0.6633) lr 5.1825e-04 eta 0:11:29
epoch [35/50] batch [260/445] time 0.086 (0.099) data 0.000 (0.015) loss 1.4841 (1.7773) ce_loss 0.7183 (0.8775) loss_zs_kd 1.8522 (2.0880) loss_oracle 0.3626 (0.4703) acc 87.5000 (68.8462) kd_loss 0.5845 (0.6647) lr 5.1825e-04 eta 0:11:19
epoch [35/50] batch [280/445] time 0.084 (0.098) data 0.000 (0.014) loss 1.4041 (1.7779) ce_loss 0.5542 (0.8777) loss_zs_kd 2.0084 (2.0847) loss_oracle 0.4686 (0.4698) acc 81.2500 (68.8951) kd_loss 0.6157 (0.6652) lr 5.1825e-04 eta 0:11:10
epoch [35/50] batch [300/445] time 0.079 (0.097) data 0.000 (0.013) loss 1.8219 (1.7794) ce_loss 0.8594 (0.8780) loss_zs_kd 1.8228 (2.0778) loss_oracle 0.4568 (0.4694) acc 62.5000 (68.8646) kd_loss 0.7341 (0.6667) lr 5.1825e-04 eta 0:11:02
epoch [35/50] batch [320/445] time 0.085 (0.096) data 0.000 (0.012) loss 2.0253 (1.7800) ce_loss 1.1670 (0.8786) loss_zs_kd 2.2664 (2.0794) loss_oracle 0.4139 (0.4687) acc 59.3750 (68.8379) kd_loss 0.6513 (0.6670) lr 5.1825e-04 eta 0:10:55
epoch [35/50] batch [340/445] time 0.084 (0.096) data 0.000 (0.012) loss 1.9564 (1.7808) ce_loss 1.0225 (0.8776) loss_zs_kd 1.9723 (2.0662) loss_oracle 0.5266 (0.4692) acc 65.6250 (68.8695) kd_loss 0.6706 (0.6686) lr 5.1825e-04 eta 0:10:48
epoch [35/50] batch [360/445] time 0.091 (0.095) data 0.000 (0.011) loss 1.6686 (1.7815) ce_loss 0.8115 (0.8774) loss_zs_kd 2.2161 (2.0679) loss_oracle 0.4790 (0.4689) acc 62.5000 (68.8194) kd_loss 0.6176 (0.6697) lr 5.1825e-04 eta 0:10:42
epoch [35/50] batch [380/445] time 0.096 (0.094) data 0.000 (0.010) loss 1.7833 (1.7809) ce_loss 0.9331 (0.8771) loss_zs_kd 2.4057 (2.0690) loss_oracle 0.5045 (0.4681) acc 62.5000 (68.8569) kd_loss 0.5979 (0.6698) lr 5.1825e-04 eta 0:10:36
epoch [35/50] batch [400/445] time 0.064 (0.094) data 0.000 (0.010) loss 1.9419 (1.7835) ce_loss 0.9683 (0.8795) loss_zs_kd 2.1086 (2.0651) loss_oracle 0.4832 (0.4679) acc 62.5000 (68.7109) kd_loss 0.7320 (0.6700) lr 5.1825e-04 eta 0:10:30
epoch [35/50] batch [420/445] time 0.078 (0.093) data 0.000 (0.009) loss 1.9554 (1.7847) ce_loss 1.1025 (0.8822) loss_zs_kd 1.9792 (2.0668) loss_oracle 0.4577 (0.4670) acc 56.2500 (68.5417) kd_loss 0.6240 (0.6690) lr 5.1825e-04 eta 0:10:23
epoch [35/50] batch [440/445] time 0.079 (0.092) data 0.000 (0.009) loss 2.0554 (1.7858) ce_loss 1.0586 (0.8823) loss_zs_kd 2.0600 (2.0739) loss_oracle 0.4267 (0.4679) acc 53.1250 (68.5085) kd_loss 0.7835 (0.6696) lr 5.1825e-04 eta 0:10:17
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,425
* accuracy: 72.4%
* error: 27.6%
* macro_f1: 60.5%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,092
* accuracy: 52.7%
* error: 47.3%
* macro_f1: 33.4%
******* Domain 3 best val acc:      72.4%, epoch: 35 *******
******* Domain 3 best val test acc: 52.7%, epoch: 35 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [36/50] batch [20/445] time 0.076 (0.240) data 0.000 (0.151) loss 1.8630 (1.8270) ce_loss 0.8789 (0.8909) loss_zs_kd 1.6225 (1.9994) loss_oracle 0.4683 (0.4684) acc 68.7500 (69.8438) kd_loss 0.7499 (0.7018) lr 4.6417e-04 eta 0:26:39
epoch [36/50] batch [40/445] time 0.085 (0.163) data 0.000 (0.076) loss 1.8730 (1.7864) ce_loss 1.0342 (0.8737) loss_zs_kd 2.1331 (2.0332) loss_oracle 0.4288 (0.4563) acc 59.3750 (69.3750) kd_loss 0.6244 (0.6845) lr 4.6417e-04 eta 0:18:03
epoch [36/50] batch [60/445] time 0.084 (0.137) data 0.000 (0.051) loss 1.8316 (1.8031) ce_loss 0.9561 (0.8835) loss_zs_kd 2.5423 (2.0516) loss_oracle 0.4463 (0.4632) acc 68.7500 (69.1146) kd_loss 0.6524 (0.6880) lr 4.6417e-04 eta 0:15:05
epoch [36/50] batch [80/445] time 0.085 (0.124) data 0.000 (0.038) loss 1.8734 (1.7992) ce_loss 0.9956 (0.8818) loss_zs_kd 2.4249 (2.0720) loss_oracle 0.4476 (0.4695) acc 62.5000 (69.1406) kd_loss 0.6540 (0.6827) lr 4.6417e-04 eta 0:13:36
epoch [36/50] batch [100/445] time 0.085 (0.116) data 0.000 (0.030) loss 1.8803 (1.7878) ce_loss 0.8506 (0.8759) loss_zs_kd 2.4613 (2.0898) loss_oracle 0.6053 (0.4683) acc 71.8750 (69.3750) kd_loss 0.7270 (0.6777) lr 4.6417e-04 eta 0:12:42
epoch [36/50] batch [120/445] time 0.077 (0.111) data 0.000 (0.025) loss 1.6329 (1.7912) ce_loss 0.6992 (0.8814) loss_zs_kd 2.0735 (2.1118) loss_oracle 0.5264 (0.4680) acc 75.0000 (69.0104) kd_loss 0.6705 (0.6758) lr 4.6417e-04 eta 0:12:04
epoch [36/50] batch [140/445] time 0.085 (0.107) data 0.000 (0.022) loss 1.6714 (1.7956) ce_loss 0.8369 (0.8859) loss_zs_kd 2.0867 (2.1102) loss_oracle 0.4601 (0.4666) acc 75.0000 (68.6161) kd_loss 0.6044 (0.6763) lr 4.6417e-04 eta 0:11:36
epoch [36/50] batch [160/445] time 0.083 (0.104) data 0.000 (0.019) loss 1.9821 (1.8010) ce_loss 1.1689 (0.8896) loss_zs_kd 1.6078 (2.1047) loss_oracle 0.3893 (0.4664) acc 59.3750 (68.3398) kd_loss 0.6185 (0.6782) lr 4.6417e-04 eta 0:11:15
epoch [36/50] batch [180/445] time 0.085 (0.102) data 0.000 (0.017) loss 1.7219 (1.8008) ce_loss 0.8394 (0.8868) loss_zs_kd 2.1344 (2.1004) loss_oracle 0.3980 (0.4660) acc 65.6250 (68.4201) kd_loss 0.6836 (0.6810) lr 4.6417e-04 eta 0:10:59
epoch [36/50] batch [200/445] time 0.081 (0.100) data 0.000 (0.015) loss 1.8677 (1.8047) ce_loss 1.0898 (0.8891) loss_zs_kd 2.1388 (2.0841) loss_oracle 0.3273 (0.4633) acc 62.5000 (68.3906) kd_loss 0.6142 (0.6839) lr 4.6417e-04 eta 0:10:45
epoch [36/50] batch [220/445] time 0.090 (0.098) data 0.000 (0.014) loss 1.8865 (1.8065) ce_loss 0.7427 (0.8862) loss_zs_kd 1.8112 (2.0897) loss_oracle 0.4375 (0.4647) acc 68.7500 (68.5795) kd_loss 0.9251 (0.6879) lr 4.6417e-04 eta 0:10:33
epoch [36/50] batch [240/445] time 0.082 (0.097) data 0.000 (0.013) loss 2.0823 (1.8099) ce_loss 0.9487 (0.8838) loss_zs_kd 1.4516 (2.0971) loss_oracle 0.4338 (0.4645) acc 62.5000 (68.7500) kd_loss 0.9166 (0.6939) lr 4.6417e-04 eta 0:10:24
epoch [36/50] batch [260/445] time 0.090 (0.096) data 0.000 (0.012) loss 2.1166 (1.8206) ce_loss 0.9980 (0.8901) loss_zs_kd 1.7199 (2.0849) loss_oracle 0.5376 (0.4654) acc 68.7500 (68.5337) kd_loss 0.8498 (0.6978) lr 4.6417e-04 eta 0:10:15
epoch [36/50] batch [280/445] time 0.083 (0.095) data 0.000 (0.011) loss 1.8143 (1.8291) ce_loss 0.8755 (0.8943) loss_zs_kd 2.3388 (2.0922) loss_oracle 0.4072 (0.4659) acc 65.6250 (68.2812) kd_loss 0.7352 (0.7019) lr 4.6417e-04 eta 0:10:08
epoch [36/50] batch [300/445] time 0.080 (0.094) data 0.000 (0.010) loss 1.9640 (1.8268) ce_loss 0.8975 (0.8900) loss_zs_kd 1.5754 (2.0915) loss_oracle 0.5001 (0.4661) acc 59.3750 (68.5208) kd_loss 0.8164 (0.7038) lr 4.6417e-04 eta 0:10:01
epoch [36/50] batch [320/445] time 0.079 (0.094) data 0.000 (0.010) loss 1.5648 (1.8230) ce_loss 0.5747 (0.8835) loss_zs_kd 2.1176 (2.0980) loss_oracle 0.5765 (0.4663) acc 81.2500 (68.7012) kd_loss 0.7019 (0.7064) lr 4.6417e-04 eta 0:09:55
epoch [36/50] batch [340/445] time 0.095 (0.093) data 0.001 (0.009) loss 2.0583 (1.8270) ce_loss 1.0361 (0.8850) loss_zs_kd 2.0664 (2.1003) loss_oracle 0.4982 (0.4671) acc 59.3750 (68.6673) kd_loss 0.7731 (0.7084) lr 4.6417e-04 eta 0:09:50
epoch [36/50] batch [360/445] time 0.079 (0.093) data 0.000 (0.009) loss 1.9600 (1.8304) ce_loss 0.9556 (0.8861) loss_zs_kd 2.2753 (2.1028) loss_oracle 0.4418 (0.4682) acc 56.2500 (68.6024) kd_loss 0.7835 (0.7103) lr 4.6417e-04 eta 0:09:44
epoch [36/50] batch [380/445] time 0.079 (0.092) data 0.000 (0.008) loss 1.7603 (1.8320) ce_loss 0.8828 (0.8873) loss_zs_kd 2.0883 (2.0984) loss_oracle 0.4314 (0.4680) acc 65.6250 (68.6184) kd_loss 0.6618 (0.7107) lr 4.6417e-04 eta 0:09:39
epoch [36/50] batch [400/445] time 0.077 (0.091) data 0.000 (0.008) loss 1.7916 (1.8358) ce_loss 0.7432 (0.8896) loss_zs_kd 1.8631 (2.1025) loss_oracle 0.4915 (0.4692) acc 78.1250 (68.5938) kd_loss 0.8027 (0.7116) lr 4.6417e-04 eta 0:09:33
epoch [36/50] batch [420/445] time 0.092 (0.091) data 0.000 (0.007) loss 2.1423 (1.8356) ce_loss 0.9644 (0.8843) loss_zs_kd 2.0916 (2.0982) loss_oracle 0.5849 (0.4702) acc 62.5000 (68.8021) kd_loss 0.8855 (0.7162) lr 4.6417e-04 eta 0:09:29
epoch [36/50] batch [440/445] time 0.082 (0.091) data 0.000 (0.007) loss 1.8540 (1.8355) ce_loss 0.8145 (0.8845) loss_zs_kd 1.7498 (2.1002) loss_oracle 0.5156 (0.4701) acc 68.7500 (68.7642) kd_loss 0.7817 (0.7159) lr 4.6417e-04 eta 0:09:24
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,440
* accuracy: 72.7%
* error: 27.3%
* macro_f1: 60.4%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,041
* accuracy: 51.4%
* error: 48.6%
* macro_f1: 31.3%
******* Domain 3 best val acc:      72.7%, epoch: 36 *******
******* Domain 3 best val test acc: 51.4%, epoch: 36 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [37/50] batch [20/445] time 0.084 (0.285) data 0.000 (0.197) loss 1.9276 (1.8718) ce_loss 0.9409 (0.9186) loss_zs_kd 2.0379 (2.0390) loss_oracle 0.5674 (0.4718) acc 68.7500 (65.3125) kd_loss 0.7029 (0.7173) lr 4.1221e-04 eta 0:29:27
epoch [37/50] batch [40/445] time 0.087 (0.185) data 0.000 (0.099) loss 1.7335 (1.8869) ce_loss 0.7095 (0.9347) loss_zs_kd 1.9732 (2.0812) loss_oracle 0.5634 (0.4739) acc 78.1250 (65.9375) kd_loss 0.7423 (0.7153) lr 4.1221e-04 eta 0:19:06
epoch [37/50] batch [60/445] time 0.090 (0.151) data 0.000 (0.066) loss 1.7775 (1.8886) ce_loss 0.8213 (0.9376) loss_zs_kd 2.0193 (2.1167) loss_oracle 0.4771 (0.4734) acc 71.8750 (65.6771) kd_loss 0.7177 (0.7143) lr 4.1221e-04 eta 0:15:34
epoch [37/50] batch [80/445] time 0.089 (0.135) data 0.000 (0.049) loss 1.9972 (1.8777) ce_loss 1.0547 (0.9287) loss_zs_kd 2.2210 (2.1418) loss_oracle 0.5470 (0.4777) acc 62.5000 (66.5625) kd_loss 0.6690 (0.7102) lr 4.1221e-04 eta 0:13:50
epoch [37/50] batch [100/445] time 0.087 (0.124) data 0.000 (0.040) loss 1.9931 (1.8555) ce_loss 1.0400 (0.9048) loss_zs_kd 2.3405 (2.1552) loss_oracle 0.5053 (0.4762) acc 62.5000 (67.5625) kd_loss 0.7004 (0.7125) lr 4.1221e-04 eta 0:12:39
epoch [37/50] batch [120/445] time 0.090 (0.118) data 0.000 (0.033) loss 1.8417 (1.8617) ce_loss 0.8882 (0.9053) loss_zs_kd 2.3818 (2.1380) loss_oracle 0.4284 (0.4786) acc 71.8750 (67.8125) kd_loss 0.7393 (0.7171) lr 4.1221e-04 eta 0:11:57
epoch [37/50] batch [140/445] time 0.086 (0.113) data 0.000 (0.028) loss 1.7059 (1.8544) ce_loss 0.8491 (0.9020) loss_zs_kd 2.2352 (2.1282) loss_oracle 0.4592 (0.4779) acc 65.6250 (67.8571) kd_loss 0.6272 (0.7134) lr 4.1221e-04 eta 0:11:28
epoch [37/50] batch [160/445] time 0.079 (0.110) data 0.000 (0.025) loss 2.0169 (1.8580) ce_loss 0.8428 (0.9058) loss_zs_kd 2.2873 (2.1259) loss_oracle 0.5569 (0.4769) acc 75.0000 (67.9492) kd_loss 0.8957 (0.7137) lr 4.1221e-04 eta 0:11:05
epoch [37/50] batch [180/445] time 0.085 (0.107) data 0.000 (0.022) loss 1.7747 (1.8571) ce_loss 0.8320 (0.9068) loss_zs_kd 2.2232 (2.1301) loss_oracle 0.4837 (0.4746) acc 62.5000 (67.8472) kd_loss 0.7008 (0.7130) lr 4.1221e-04 eta 0:10:45
epoch [37/50] batch [200/445] time 0.085 (0.105) data 0.000 (0.020) loss 1.6978 (1.8519) ce_loss 0.7393 (0.9018) loss_zs_kd 1.9848 (2.1337) loss_oracle 0.4853 (0.4751) acc 81.2500 (67.9844) kd_loss 0.7159 (0.7125) lr 4.1221e-04 eta 0:10:30
epoch [37/50] batch [220/445] time 0.099 (0.103) data 0.000 (0.018) loss 1.7733 (1.8364) ce_loss 0.9775 (0.8885) loss_zs_kd 2.2454 (2.1280) loss_oracle 0.4199 (0.4722) acc 50.0000 (68.2102) kd_loss 0.5859 (0.7119) lr 4.1221e-04 eta 0:10:18
epoch [37/50] batch [240/445] time 0.087 (0.101) data 0.000 (0.017) loss 1.6481 (1.8290) ce_loss 0.7402 (0.8825) loss_zs_kd 2.0974 (2.1215) loss_oracle 0.4355 (0.4707) acc 71.8750 (68.5286) kd_loss 0.6901 (0.7112) lr 4.1221e-04 eta 0:10:06
epoch [37/50] batch [260/445] time 0.086 (0.100) data 0.000 (0.015) loss 2.0372 (1.8301) ce_loss 1.1377 (0.8858) loss_zs_kd 1.9949 (2.1198) loss_oracle 0.4298 (0.4713) acc 62.5000 (68.5337) kd_loss 0.6846 (0.7087) lr 4.1221e-04 eta 0:09:57
epoch [37/50] batch [280/445] time 0.097 (0.099) data 0.001 (0.014) loss 1.7304 (1.8346) ce_loss 0.8330 (0.8918) loss_zs_kd 2.8617 (2.1347) loss_oracle 0.5071 (0.4722) acc 71.8750 (68.3929) kd_loss 0.6438 (0.7068) lr 4.1221e-04 eta 0:09:48
epoch [37/50] batch [300/445] time 0.086 (0.098) data 0.000 (0.013) loss 1.8954 (1.8324) ce_loss 1.0215 (0.8901) loss_zs_kd 2.2974 (2.1275) loss_oracle 0.5117 (0.4720) acc 62.5000 (68.4688) kd_loss 0.6180 (0.7063) lr 4.1221e-04 eta 0:09:39
epoch [37/50] batch [320/445] time 0.088 (0.097) data 0.001 (0.013) loss 1.9236 (1.8330) ce_loss 0.8862 (0.8920) loss_zs_kd 2.2662 (2.1313) loss_oracle 0.4421 (0.4718) acc 68.7500 (68.4082) kd_loss 0.8164 (0.7051) lr 4.1221e-04 eta 0:09:32
epoch [37/50] batch [340/445] time 0.085 (0.096) data 0.000 (0.012) loss 1.8548 (1.8305) ce_loss 0.8970 (0.8900) loss_zs_kd 2.0698 (2.1312) loss_oracle 0.5110 (0.4721) acc 68.7500 (68.4283) kd_loss 0.7023 (0.7044) lr 4.1221e-04 eta 0:09:26
epoch [37/50] batch [360/445] time 0.078 (0.096) data 0.000 (0.011) loss 1.8501 (1.8295) ce_loss 1.0342 (0.8898) loss_zs_kd 2.2506 (2.1320) loss_oracle 0.4556 (0.4729) acc 65.6250 (68.3073) kd_loss 0.5881 (0.7032) lr 4.1221e-04 eta 0:09:21
epoch [37/50] batch [380/445] time 0.089 (0.095) data 0.000 (0.011) loss 1.7149 (1.8255) ce_loss 0.7681 (0.8860) loss_zs_kd 2.1101 (2.1338) loss_oracle 0.5603 (0.4738) acc 65.6250 (68.4868) kd_loss 0.6667 (0.7026) lr 4.1221e-04 eta 0:09:16
epoch [37/50] batch [400/445] time 0.085 (0.095) data 0.000 (0.010) loss 1.6356 (1.8237) ce_loss 0.8071 (0.8874) loss_zs_kd 2.0183 (2.1366) loss_oracle 0.4203 (0.4729) acc 71.8750 (68.3906) kd_loss 0.6184 (0.6998) lr 4.1221e-04 eta 0:09:12
epoch [37/50] batch [420/445] time 0.086 (0.094) data 0.000 (0.010) loss 1.8738 (1.8204) ce_loss 0.9961 (0.8855) loss_zs_kd 2.5446 (2.1407) loss_oracle 0.4842 (0.4734) acc 56.2500 (68.4821) kd_loss 0.6356 (0.6981) lr 4.1221e-04 eta 0:09:07
epoch [37/50] batch [440/445] time 0.078 (0.094) data 0.000 (0.009) loss 1.8093 (1.8210) ce_loss 0.8501 (0.8869) loss_zs_kd 1.8468 (2.1299) loss_oracle 0.4728 (0.4735) acc 75.0000 (68.4517) kd_loss 0.7227 (0.6974) lr 4.1221e-04 eta 0:09:02
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,420
* accuracy: 72.4%
* error: 27.6%
* macro_f1: 60.2%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,043
* accuracy: 51.5%
* error: 48.5%
* macro_f1: 32.7%
******* Domain 3 best val acc:      72.7%, epoch: 36 *******
******* Domain 3 best val test acc: 51.4%, epoch: 36 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [38/50] batch [20/445] time 0.085 (0.240) data 0.000 (0.147) loss 1.9739 (1.8286) ce_loss 1.1289 (0.9325) loss_zs_kd 1.9217 (2.0128) loss_oracle 0.3857 (0.4561) acc 65.6250 (66.5625) kd_loss 0.6522 (0.6681) lr 3.6258e-04 eta 0:23:06
epoch [38/50] batch [40/445] time 0.086 (0.163) data 0.000 (0.073) loss 1.5627 (1.8048) ce_loss 0.6401 (0.8971) loss_zs_kd 1.8684 (2.0693) loss_oracle 0.4076 (0.4642) acc 81.2500 (67.4219) kd_loss 0.7188 (0.6756) lr 3.6258e-04 eta 0:15:37
epoch [38/50] batch [60/445] time 0.071 (0.133) data 0.000 (0.049) loss 1.6304 (1.8165) ce_loss 0.8311 (0.9051) loss_zs_kd 2.4369 (2.0702) loss_oracle 0.3604 (0.4644) acc 56.2500 (66.8750) kd_loss 0.6191 (0.6792) lr 3.6258e-04 eta 0:12:43
epoch [38/50] batch [80/445] time 0.088 (0.119) data 0.000 (0.037) loss 1.5824 (1.7962) ce_loss 0.7520 (0.8852) loss_zs_kd 2.4796 (2.0982) loss_oracle 0.4280 (0.4649) acc 71.8750 (67.5391) kd_loss 0.6165 (0.6786) lr 3.6258e-04 eta 0:11:19
epoch [38/50] batch [100/445] time 0.090 (0.111) data 0.000 (0.030) loss 1.6551 (1.7870) ce_loss 0.8428 (0.8724) loss_zs_kd 1.8180 (2.1050) loss_oracle 0.3932 (0.4643) acc 71.8750 (68.4375) kd_loss 0.6157 (0.6824) lr 3.6258e-04 eta 0:10:33
epoch [38/50] batch [120/445] time 0.081 (0.110) data 0.000 (0.025) loss 2.1208 (1.7939) ce_loss 1.1426 (0.8717) loss_zs_kd 2.3320 (2.0957) loss_oracle 0.5451 (0.4670) acc 59.3750 (68.4635) kd_loss 0.7057 (0.6887) lr 3.6258e-04 eta 0:10:22
epoch [38/50] batch [140/445] time 0.082 (0.106) data 0.000 (0.021) loss 1.6182 (1.7965) ce_loss 0.6943 (0.8746) loss_zs_kd 2.2062 (2.0911) loss_oracle 0.4775 (0.4663) acc 84.3750 (68.4152) kd_loss 0.6851 (0.6887) lr 3.6258e-04 eta 0:09:57
epoch [38/50] batch [160/445] time 0.084 (0.103) data 0.000 (0.019) loss 1.8169 (1.7951) ce_loss 0.7227 (0.8693) loss_zs_kd 2.1038 (2.1017) loss_oracle 0.5086 (0.4697) acc 75.0000 (68.5156) kd_loss 0.8400 (0.6909) lr 3.6258e-04 eta 0:09:38
epoch [38/50] batch [180/445] time 0.083 (0.101) data 0.000 (0.017) loss 1.8176 (1.7982) ce_loss 0.8682 (0.8691) loss_zs_kd 1.6730 (2.0938) loss_oracle 0.4368 (0.4708) acc 68.7500 (68.4375) kd_loss 0.7310 (0.6937) lr 3.6258e-04 eta 0:09:25
epoch [38/50] batch [200/445] time 0.080 (0.099) data 0.000 (0.015) loss 2.0208 (1.8112) ce_loss 1.2002 (0.8781) loss_zs_kd 2.3346 (2.0988) loss_oracle 0.4387 (0.4715) acc 50.0000 (68.2031) kd_loss 0.6013 (0.6973) lr 3.6258e-04 eta 0:09:12
epoch [38/50] batch [220/445] time 0.089 (0.098) data 0.000 (0.014) loss 1.8095 (1.8155) ce_loss 0.9463 (0.8816) loss_zs_kd 2.2552 (2.1079) loss_oracle 0.3640 (0.4720) acc 68.7500 (68.1960) kd_loss 0.6812 (0.6979) lr 3.6258e-04 eta 0:09:02
epoch [38/50] batch [240/445] time 0.084 (0.096) data 0.000 (0.012) loss 2.2647 (1.8221) ce_loss 1.0508 (0.8854) loss_zs_kd 2.3112 (2.1104) loss_oracle 0.6031 (0.4725) acc 59.3750 (68.1771) kd_loss 0.9123 (0.7005) lr 3.6258e-04 eta 0:08:54
epoch [38/50] batch [260/445] time 0.083 (0.095) data 0.000 (0.012) loss 1.7288 (1.8196) ce_loss 0.7695 (0.8822) loss_zs_kd 2.0477 (2.1124) loss_oracle 0.5244 (0.4709) acc 78.1250 (68.3413) kd_loss 0.6970 (0.7019) lr 3.6258e-04 eta 0:08:47
epoch [38/50] batch [280/445] time 0.079 (0.095) data 0.000 (0.011) loss 1.8729 (1.8219) ce_loss 0.8110 (0.8825) loss_zs_kd 2.0558 (2.1127) loss_oracle 0.5000 (0.4717) acc 68.7500 (68.3482) kd_loss 0.8118 (0.7035) lr 3.6258e-04 eta 0:08:41
epoch [38/50] batch [300/445] time 0.083 (0.094) data 0.000 (0.010) loss 1.7241 (1.8227) ce_loss 0.8140 (0.8843) loss_zs_kd 2.6385 (2.1129) loss_oracle 0.4573 (0.4706) acc 75.0000 (68.4792) kd_loss 0.6815 (0.7030) lr 3.6258e-04 eta 0:08:34
epoch [38/50] batch [320/445] time 0.087 (0.094) data 0.000 (0.009) loss 1.8830 (1.8235) ce_loss 1.0000 (0.8861) loss_zs_kd 1.8579 (2.1124) loss_oracle 0.4873 (0.4701) acc 62.5000 (68.5156) kd_loss 0.6393 (0.7023) lr 3.6258e-04 eta 0:08:31
epoch [38/50] batch [340/445] time 0.085 (0.093) data 0.000 (0.009) loss 2.0977 (1.8219) ce_loss 0.9370 (0.8843) loss_zs_kd 2.0379 (2.1106) loss_oracle 0.5278 (0.4701) acc 65.6250 (68.5846) kd_loss 0.8969 (0.7026) lr 3.6258e-04 eta 0:08:27
epoch [38/50] batch [360/445] time 0.084 (0.093) data 0.000 (0.008) loss 1.5079 (1.8275) ce_loss 0.7227 (0.8890) loss_zs_kd 2.0625 (2.1115) loss_oracle 0.3555 (0.4700) acc 75.0000 (68.3594) kd_loss 0.6075 (0.7035) lr 3.6258e-04 eta 0:08:23
epoch [38/50] batch [380/445] time 0.080 (0.092) data 0.000 (0.008) loss 1.7322 (1.8300) ce_loss 0.7520 (0.8877) loss_zs_kd 2.0195 (2.1165) loss_oracle 0.4278 (0.4700) acc 71.8750 (68.4211) kd_loss 0.7663 (0.7072) lr 3.6258e-04 eta 0:08:19
epoch [38/50] batch [400/445] time 0.090 (0.092) data 0.000 (0.008) loss 2.0392 (1.8328) ce_loss 1.0215 (0.8899) loss_zs_kd 2.5116 (2.1143) loss_oracle 0.4712 (0.4698) acc 65.6250 (68.3906) kd_loss 0.7822 (0.7080) lr 3.6258e-04 eta 0:08:15
epoch [38/50] batch [420/445] time 0.081 (0.092) data 0.000 (0.007) loss 1.7606 (1.8314) ce_loss 0.9204 (0.8883) loss_zs_kd 2.0973 (2.1154) loss_oracle 0.4461 (0.4692) acc 68.7500 (68.3929) kd_loss 0.6171 (0.7085) lr 3.6258e-04 eta 0:08:11
epoch [38/50] batch [440/445] time 0.076 (0.091) data 0.000 (0.007) loss 1.5780 (1.8297) ce_loss 0.5684 (0.8872) loss_zs_kd 2.1578 (2.1165) loss_oracle 0.4850 (0.4691) acc 81.2500 (68.3523) kd_loss 0.7672 (0.7080) lr 3.6258e-04 eta 0:08:07
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,417
* accuracy: 72.3%
* error: 27.7%
* macro_f1: 61.0%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,056
* accuracy: 51.8%
* error: 48.2%
* macro_f1: 32.7%
******* Domain 3 best val acc:      72.7%, epoch: 36 *******
******* Domain 3 best val test acc: 51.4%, epoch: 36 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [39/50] batch [20/445] time 0.076 (0.293) data 0.000 (0.212) loss 1.5957 (1.8914) ce_loss 0.6514 (0.9168) loss_zs_kd 1.6112 (2.2071) loss_oracle 0.4106 (0.4860) acc 78.1250 (65.6250) kd_loss 0.7390 (0.7317) lr 3.1545e-04 eta 0:25:58
epoch [39/50] batch [40/445] time 0.080 (0.188) data 0.000 (0.106) loss 1.9175 (1.8710) ce_loss 0.9238 (0.9098) loss_zs_kd 2.2403 (2.1394) loss_oracle 0.4100 (0.4697) acc 75.0000 (67.5000) kd_loss 0.7887 (0.7263) lr 3.1545e-04 eta 0:16:36
epoch [39/50] batch [60/445] time 0.079 (0.153) data 0.000 (0.071) loss 1.7059 (1.8592) ce_loss 0.7432 (0.8972) loss_zs_kd 2.2446 (2.1240) loss_oracle 0.4956 (0.4715) acc 68.7500 (67.9688) kd_loss 0.7149 (0.7262) lr 3.1545e-04 eta 0:13:28
epoch [39/50] batch [80/445] time 0.076 (0.135) data 0.000 (0.053) loss 1.6590 (1.8575) ce_loss 0.8003 (0.8913) loss_zs_kd 2.3497 (2.1321) loss_oracle 0.3991 (0.4770) acc 75.0000 (68.2031) kd_loss 0.6591 (0.7277) lr 3.1545e-04 eta 0:11:50
epoch [39/50] batch [100/445] time 0.084 (0.125) data 0.000 (0.043) loss 1.6574 (1.8374) ce_loss 0.6987 (0.8792) loss_zs_kd 1.8675 (2.1273) loss_oracle 0.4454 (0.4727) acc 75.0000 (68.6875) kd_loss 0.7360 (0.7218) lr 3.1545e-04 eta 0:10:52
epoch [39/50] batch [120/445] time 0.076 (0.117) data 0.000 (0.036) loss 2.0592 (1.8291) ce_loss 0.8955 (0.8733) loss_zs_kd 1.8986 (2.1272) loss_oracle 0.5930 (0.4693) acc 71.8750 (68.7500) kd_loss 0.8672 (0.7211) lr 3.1545e-04 eta 0:10:11
epoch [39/50] batch [140/445] time 0.084 (0.112) data 0.000 (0.030) loss 1.9150 (1.8217) ce_loss 0.9116 (0.8680) loss_zs_kd 2.0257 (2.1141) loss_oracle 0.4760 (0.4676) acc 62.5000 (69.1071) kd_loss 0.7654 (0.7200) lr 3.1545e-04 eta 0:09:41
epoch [39/50] batch [160/445] time 0.083 (0.108) data 0.000 (0.027) loss 1.7371 (1.8120) ce_loss 0.8481 (0.8661) loss_zs_kd 1.9400 (2.1325) loss_oracle 0.3969 (0.4667) acc 65.6250 (69.1992) kd_loss 0.6905 (0.7125) lr 3.1545e-04 eta 0:09:21
epoch [39/50] batch [180/445] time 0.090 (0.106) data 0.000 (0.024) loss 1.9215 (1.8222) ce_loss 0.8906 (0.8744) loss_zs_kd 2.1143 (2.1342) loss_oracle 0.4951 (0.4688) acc 68.7500 (68.6632) kd_loss 0.7833 (0.7135) lr 3.1545e-04 eta 0:09:06
epoch [39/50] batch [200/445] time 0.076 (0.103) data 0.000 (0.021) loss 1.9125 (1.8196) ce_loss 0.9766 (0.8736) loss_zs_kd 1.7875 (2.1274) loss_oracle 0.4920 (0.4678) acc 65.6250 (68.8438) kd_loss 0.6900 (0.7120) lr 3.1545e-04 eta 0:08:50
epoch [39/50] batch [220/445] time 0.083 (0.101) data 0.000 (0.020) loss 2.1493 (1.8201) ce_loss 1.1533 (0.8731) loss_zs_kd 2.0489 (2.1210) loss_oracle 0.4498 (0.4663) acc 62.5000 (69.0057) kd_loss 0.7711 (0.7139) lr 3.1545e-04 eta 0:08:38
epoch [39/50] batch [240/445] time 0.064 (0.098) data 0.000 (0.018) loss 1.9114 (1.8231) ce_loss 1.0244 (0.8764) loss_zs_kd 2.1887 (2.1194) loss_oracle 0.4406 (0.4662) acc 65.6250 (68.8802) kd_loss 0.6666 (0.7136) lr 3.1545e-04 eta 0:08:21
epoch [39/50] batch [260/445] time 0.067 (0.096) data 0.000 (0.017) loss 1.6851 (1.8198) ce_loss 0.8975 (0.8731) loss_zs_kd 2.0075 (2.1145) loss_oracle 0.3840 (0.4671) acc 68.7500 (68.9904) kd_loss 0.5956 (0.7131) lr 3.1545e-04 eta 0:08:06
epoch [39/50] batch [280/445] time 0.062 (0.094) data 0.000 (0.015) loss 1.6668 (1.8236) ce_loss 0.6865 (0.8738) loss_zs_kd 2.3607 (2.1188) loss_oracle 0.4369 (0.4693) acc 81.2500 (68.9509) kd_loss 0.7618 (0.7151) lr 3.1545e-04 eta 0:07:54
epoch [39/50] batch [300/445] time 0.067 (0.092) data 0.000 (0.014) loss 1.6976 (1.8295) ce_loss 0.7256 (0.8780) loss_zs_kd 2.3454 (2.1193) loss_oracle 0.4318 (0.4703) acc 75.0000 (68.8854) kd_loss 0.7561 (0.7164) lr 3.1545e-04 eta 0:07:43
epoch [39/50] batch [320/445] time 0.062 (0.090) data 0.000 (0.013) loss 1.6416 (1.8298) ce_loss 0.5640 (0.8766) loss_zs_kd 2.3407 (2.1145) loss_oracle 0.4810 (0.4715) acc 75.0000 (68.9941) kd_loss 0.8372 (0.7175) lr 3.1545e-04 eta 0:07:32
epoch [39/50] batch [340/445] time 0.065 (0.089) data 0.000 (0.013) loss 1.7160 (1.8311) ce_loss 0.8887 (0.8776) loss_zs_kd 2.2393 (2.1113) loss_oracle 0.4629 (0.4726) acc 68.7500 (68.9338) kd_loss 0.5959 (0.7172) lr 3.1545e-04 eta 0:07:23
epoch [39/50] batch [360/445] time 0.070 (0.087) data 0.000 (0.012) loss 1.6928 (1.8335) ce_loss 0.8926 (0.8803) loss_zs_kd 2.4004 (2.1129) loss_oracle 0.4677 (0.4724) acc 62.5000 (68.8281) kd_loss 0.5663 (0.7170) lr 3.1545e-04 eta 0:07:15
epoch [39/50] batch [380/445] time 0.060 (0.086) data 0.000 (0.011) loss 1.4177 (1.8367) ce_loss 0.6528 (0.8840) loss_zs_kd 2.1908 (2.1149) loss_oracle 0.4012 (0.4730) acc 84.3750 (68.7253) kd_loss 0.5643 (0.7162) lr 3.1545e-04 eta 0:07:07
epoch [39/50] batch [400/445] time 0.070 (0.085) data 0.000 (0.011) loss 1.8563 (1.8344) ce_loss 1.0137 (0.8818) loss_zs_kd 2.0610 (2.1187) loss_oracle 0.4948 (0.4729) acc 59.3750 (68.6797) kd_loss 0.5952 (0.7162) lr 3.1545e-04 eta 0:07:00
epoch [39/50] batch [420/445] time 0.062 (0.084) data 0.000 (0.010) loss 2.1212 (1.8334) ce_loss 1.0469 (0.8800) loss_zs_kd 1.7301 (2.1156) loss_oracle 0.4926 (0.4722) acc 71.8750 (68.6756) kd_loss 0.8281 (0.7173) lr 3.1545e-04 eta 0:06:54
epoch [39/50] batch [440/445] time 0.077 (0.083) data 0.000 (0.010) loss 1.5838 (1.8334) ce_loss 0.6807 (0.8799) loss_zs_kd 1.9219 (2.1158) loss_oracle 0.4315 (0.4715) acc 68.7500 (68.7855) kd_loss 0.6874 (0.7178) lr 3.1545e-04 eta 0:06:48
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,447
* accuracy: 72.8%
* error: 27.2%
* macro_f1: 60.2%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,063
* accuracy: 52.0%
* error: 48.0%
* macro_f1: 33.0%
******* Domain 3 best val acc:      72.8%, epoch: 39 *******
******* Domain 3 best val test acc: 52.0%, epoch: 39 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [40/50] batch [20/445] time 0.070 (0.256) data 0.000 (0.179) loss 1.9648 (1.8349) ce_loss 0.8984 (0.8680) loss_zs_kd 2.2686 (2.0680) loss_oracle 0.4790 (0.4732) acc 62.5000 (69.5312) kd_loss 0.8269 (0.7303) lr 2.7103e-04 eta 0:20:48
epoch [40/50] batch [40/445] time 0.077 (0.169) data 0.001 (0.090) loss 1.8250 (1.8603) ce_loss 0.8687 (0.8922) loss_zs_kd 1.7478 (2.1031) loss_oracle 0.4294 (0.4622) acc 68.7500 (68.7500) kd_loss 0.7417 (0.7371) lr 2.7103e-04 eta 0:13:40
epoch [40/50] batch [60/445] time 0.081 (0.139) data 0.000 (0.060) loss 2.2087 (1.8281) ce_loss 1.1914 (0.8726) loss_zs_kd 1.9842 (2.0806) loss_oracle 0.4872 (0.4623) acc 56.2500 (69.4792) kd_loss 0.7737 (0.7244) lr 2.7103e-04 eta 0:11:13
epoch [40/50] batch [80/445] time 0.077 (0.124) data 0.000 (0.045) loss 2.0213 (1.8269) ce_loss 0.9946 (0.8656) loss_zs_kd 1.8917 (2.0865) loss_oracle 0.5914 (0.4632) acc 62.5000 (69.6484) kd_loss 0.7310 (0.7296) lr 2.7103e-04 eta 0:09:56
epoch [40/50] batch [100/445] time 0.083 (0.115) data 0.000 (0.036) loss 2.1140 (1.8471) ce_loss 1.1426 (0.8812) loss_zs_kd 1.8022 (2.0985) loss_oracle 0.4159 (0.4653) acc 62.5000 (69.2500) kd_loss 0.7635 (0.7332) lr 2.7103e-04 eta 0:09:12
epoch [40/50] batch [120/445] time 0.078 (0.108) data 0.000 (0.030) loss 1.7072 (1.8442) ce_loss 0.7368 (0.8766) loss_zs_kd 2.1346 (2.0957) loss_oracle 0.5250 (0.4673) acc 71.8750 (69.2969) kd_loss 0.7079 (0.7339) lr 2.7103e-04 eta 0:08:35
epoch [40/50] batch [140/445] time 0.085 (0.103) data 0.000 (0.026) loss 1.7551 (1.8378) ce_loss 0.9775 (0.8729) loss_zs_kd 2.5107 (2.1050) loss_oracle 0.3829 (0.4661) acc 65.6250 (69.1295) kd_loss 0.5861 (0.7318) lr 2.7103e-04 eta 0:08:08
epoch [40/50] batch [160/445] time 0.071 (0.098) data 0.000 (0.023) loss 1.6878 (1.8440) ce_loss 0.8823 (0.8788) loss_zs_kd 2.3849 (2.1052) loss_oracle 0.3418 (0.4652) acc 71.8750 (69.0820) kd_loss 0.6345 (0.7326) lr 2.7103e-04 eta 0:07:46
epoch [40/50] batch [180/445] time 0.088 (0.096) data 0.000 (0.020) loss 1.6838 (1.8450) ce_loss 0.7500 (0.8752) loss_zs_kd 2.0690 (2.1164) loss_oracle 0.4521 (0.4662) acc 78.1250 (69.4618) kd_loss 0.7078 (0.7366) lr 2.7103e-04 eta 0:07:33
epoch [40/50] batch [200/445] time 0.065 (0.093) data 0.000 (0.018) loss 2.0051 (1.8528) ce_loss 1.0801 (0.8810) loss_zs_kd 2.0275 (2.1185) loss_oracle 0.3794 (0.4667) acc 59.3750 (69.2188) kd_loss 0.7353 (0.7386) lr 2.7103e-04 eta 0:07:18
epoch [40/50] batch [220/445] time 0.067 (0.091) data 0.000 (0.017) loss 1.7760 (1.8598) ce_loss 0.8628 (0.8850) loss_zs_kd 1.9938 (2.1186) loss_oracle 0.3591 (0.4671) acc 71.8750 (69.4318) kd_loss 0.7337 (0.7413) lr 2.7103e-04 eta 0:07:04
epoch [40/50] batch [240/445] time 0.061 (0.089) data 0.000 (0.015) loss 1.9895 (1.8641) ce_loss 0.9829 (0.8868) loss_zs_kd 1.5727 (2.1107) loss_oracle 0.4997 (0.4673) acc 62.5000 (69.3359) kd_loss 0.7568 (0.7436) lr 2.7103e-04 eta 0:06:53
epoch [40/50] batch [260/445] time 0.062 (0.087) data 0.000 (0.014) loss 2.0900 (1.8656) ce_loss 0.9756 (0.8863) loss_zs_kd 1.7265 (2.1102) loss_oracle 0.4988 (0.4675) acc 71.8750 (69.2188) kd_loss 0.8650 (0.7455) lr 2.7103e-04 eta 0:06:41
epoch [40/50] batch [280/445] time 0.075 (0.085) data 0.000 (0.013) loss 2.0241 (1.8642) ce_loss 0.9487 (0.8829) loss_zs_kd 1.9658 (2.1115) loss_oracle 0.4148 (0.4670) acc 71.8750 (69.1518) kd_loss 0.8679 (0.7478) lr 2.7103e-04 eta 0:06:33
epoch [40/50] batch [300/445] time 0.082 (0.085) data 0.000 (0.012) loss 2.4179 (1.8680) ce_loss 1.2529 (0.8841) loss_zs_kd 1.8797 (2.1096) loss_oracle 0.5048 (0.4663) acc 62.5000 (69.0938) kd_loss 0.9126 (0.7507) lr 2.7103e-04 eta 0:06:30
epoch [40/50] batch [320/445] time 0.083 (0.085) data 0.000 (0.011) loss 2.1135 (1.8738) ce_loss 1.0703 (0.8871) loss_zs_kd 2.2043 (2.1078) loss_oracle 0.5387 (0.4677) acc 65.6250 (68.9941) kd_loss 0.7739 (0.7529) lr 2.7103e-04 eta 0:06:29
epoch [40/50] batch [340/445] time 0.092 (0.085) data 0.000 (0.011) loss 2.3367 (1.8747) ce_loss 1.3164 (0.8872) loss_zs_kd 2.0336 (2.1053) loss_oracle 0.4824 (0.4673) acc 50.0000 (69.0257) kd_loss 0.7791 (0.7538) lr 2.7103e-04 eta 0:06:28
epoch [40/50] batch [360/445] time 0.085 (0.085) data 0.000 (0.010) loss 1.6105 (1.8730) ce_loss 0.7217 (0.8858) loss_zs_kd 2.0477 (2.1119) loss_oracle 0.4005 (0.4680) acc 75.0000 (69.0538) kd_loss 0.6886 (0.7532) lr 2.7103e-04 eta 0:06:27
epoch [40/50] batch [380/445] time 0.081 (0.085) data 0.000 (0.010) loss 1.8273 (1.8739) ce_loss 0.8872 (0.8860) loss_zs_kd 1.9924 (2.1131) loss_oracle 0.5086 (0.4691) acc 68.7500 (68.9885) kd_loss 0.6858 (0.7533) lr 2.7103e-04 eta 0:06:24
epoch [40/50] batch [400/445] time 0.076 (0.085) data 0.000 (0.009) loss 2.0968 (1.8774) ce_loss 0.9614 (0.8882) loss_zs_kd 2.5405 (2.1186) loss_oracle 0.6095 (0.4703) acc 62.5000 (68.6953) kd_loss 0.8306 (0.7540) lr 2.7103e-04 eta 0:06:22
epoch [40/50] batch [420/445] time 0.091 (0.085) data 0.000 (0.009) loss 2.2838 (1.8795) ce_loss 1.2959 (0.8900) loss_zs_kd 2.2669 (2.1241) loss_oracle 0.5335 (0.4711) acc 50.0000 (68.5119) kd_loss 0.7212 (0.7540) lr 2.7103e-04 eta 0:06:20
epoch [40/50] batch [440/445] time 0.080 (0.085) data 0.000 (0.008) loss 2.2175 (1.8784) ce_loss 1.1348 (0.8880) loss_zs_kd 2.0255 (2.1223) loss_oracle 0.4848 (0.4709) acc 50.0000 (68.5014) kd_loss 0.8403 (0.7549) lr 2.7103e-04 eta 0:06:18
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,430
* accuracy: 72.5%
* error: 27.5%
* macro_f1: 60.4%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,063
* accuracy: 52.0%
* error: 48.0%
* macro_f1: 33.2%
******* Domain 3 best val acc:      72.8%, epoch: 39 *******
******* Domain 3 best val test acc: 52.0%, epoch: 39 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [41/50] batch [20/445] time 0.066 (0.283) data 0.000 (0.201) loss 1.7443 (1.9250) ce_loss 0.7012 (0.9284) loss_zs_kd 2.0593 (2.1565) loss_oracle 0.4703 (0.4900) acc 71.8750 (66.5625) kd_loss 0.8080 (0.7517) lr 2.2949e-04 eta 0:20:52
epoch [41/50] batch [40/445] time 0.066 (0.177) data 0.000 (0.101) loss 2.0501 (1.8883) ce_loss 0.9409 (0.8804) loss_zs_kd 2.2300 (2.1375) loss_oracle 0.5927 (0.4837) acc 68.7500 (67.6562) kd_loss 0.8128 (0.7660) lr 2.2949e-04 eta 0:13:02
epoch [41/50] batch [60/445] time 0.073 (0.141) data 0.000 (0.067) loss 1.9855 (1.8935) ce_loss 1.0303 (0.8869) loss_zs_kd 1.8346 (2.1172) loss_oracle 0.4232 (0.4829) acc 68.7500 (67.5000) kd_loss 0.7437 (0.7651) lr 2.2949e-04 eta 0:10:19
epoch [41/50] batch [80/445] time 0.076 (0.124) data 0.000 (0.050) loss 1.7282 (1.9047) ce_loss 0.8037 (0.9035) loss_zs_kd 2.0300 (2.1327) loss_oracle 0.4490 (0.4822) acc 68.7500 (66.8750) kd_loss 0.7000 (0.7600) lr 2.2949e-04 eta 0:09:01
epoch [41/50] batch [100/445] time 0.105 (0.116) data 0.001 (0.040) loss 1.8555 (1.9013) ce_loss 0.8555 (0.9019) loss_zs_kd 2.4481 (2.1180) loss_oracle 0.5142 (0.4784) acc 71.8750 (67.5000) kd_loss 0.7430 (0.7601) lr 2.2949e-04 eta 0:08:26
epoch [41/50] batch [120/445] time 0.083 (0.111) data 0.000 (0.034) loss 1.9554 (1.8850) ce_loss 1.0674 (0.8932) loss_zs_kd 1.7406 (2.1085) loss_oracle 0.4421 (0.4714) acc 59.3750 (67.7344) kd_loss 0.6670 (0.7561) lr 2.2949e-04 eta 0:08:02
epoch [41/50] batch [140/445] time 0.086 (0.108) data 0.000 (0.029) loss 2.0673 (1.8790) ce_loss 1.0859 (0.8926) loss_zs_kd 1.9278 (2.0968) loss_oracle 0.4642 (0.4677) acc 59.3750 (67.9018) kd_loss 0.7492 (0.7525) lr 2.2949e-04 eta 0:07:43
epoch [41/50] batch [160/445] time 0.080 (0.104) data 0.000 (0.025) loss 1.4887 (1.8764) ce_loss 0.5620 (0.8917) loss_zs_kd 2.0870 (2.0937) loss_oracle 0.3932 (0.4650) acc 84.3750 (67.9688) kd_loss 0.7301 (0.7522) lr 2.2949e-04 eta 0:07:28
epoch [41/50] batch [180/445] time 0.082 (0.102) data 0.000 (0.023) loss 2.0684 (1.8751) ce_loss 1.0947 (0.8914) loss_zs_kd 1.8190 (2.0884) loss_oracle 0.4752 (0.4657) acc 62.5000 (67.9688) kd_loss 0.7361 (0.7509) lr 2.2949e-04 eta 0:07:14
epoch [41/50] batch [200/445] time 0.088 (0.100) data 0.000 (0.020) loss 1.7591 (1.8679) ce_loss 0.7891 (0.8841) loss_zs_kd 2.2465 (2.0868) loss_oracle 0.4772 (0.4638) acc 75.0000 (68.3594) kd_loss 0.7315 (0.7519) lr 2.2949e-04 eta 0:07:04
epoch [41/50] batch [220/445] time 0.077 (0.098) data 0.000 (0.019) loss 1.9791 (1.8584) ce_loss 1.0234 (0.8751) loss_zs_kd 2.2019 (2.0760) loss_oracle 0.4130 (0.4621) acc 53.1250 (68.6506) kd_loss 0.7491 (0.7522) lr 2.2949e-04 eta 0:06:55
epoch [41/50] batch [240/445] time 0.082 (0.097) data 0.000 (0.017) loss 2.0112 (1.8639) ce_loss 1.0508 (0.8783) loss_zs_kd 2.1661 (2.0733) loss_oracle 0.4456 (0.4632) acc 68.7500 (68.4115) kd_loss 0.7377 (0.7540) lr 2.2949e-04 eta 0:06:49
epoch [41/50] batch [260/445] time 0.079 (0.096) data 0.000 (0.016) loss 2.1450 (1.8669) ce_loss 1.0596 (0.8809) loss_zs_kd 1.9756 (2.0701) loss_oracle 0.4574 (0.4638) acc 65.6250 (68.3894) kd_loss 0.8567 (0.7541) lr 2.2949e-04 eta 0:06:43
epoch [41/50] batch [280/445] time 0.084 (0.095) data 0.000 (0.015) loss 2.0858 (1.8648) ce_loss 1.0166 (0.8797) loss_zs_kd 1.7171 (2.0789) loss_oracle 0.4963 (0.4642) acc 59.3750 (68.5379) kd_loss 0.8211 (0.7530) lr 2.2949e-04 eta 0:06:38
epoch [41/50] batch [300/445] time 0.081 (0.095) data 0.000 (0.014) loss 1.9509 (1.8650) ce_loss 0.8501 (0.8797) loss_zs_kd 2.5684 (2.0838) loss_oracle 0.5157 (0.4644) acc 56.2500 (68.4271) kd_loss 0.8429 (0.7532) lr 2.2949e-04 eta 0:06:33
epoch [41/50] batch [320/445] time 0.081 (0.094) data 0.000 (0.013) loss 1.9170 (1.8622) ce_loss 0.9688 (0.8785) loss_zs_kd 2.2789 (2.0885) loss_oracle 0.4932 (0.4633) acc 59.3750 (68.4473) kd_loss 0.7017 (0.7521) lr 2.2949e-04 eta 0:06:28
epoch [41/50] batch [340/445] time 0.080 (0.093) data 0.000 (0.012) loss 1.6015 (1.8603) ce_loss 0.6113 (0.8779) loss_zs_kd 2.2610 (2.0949) loss_oracle 0.4395 (0.4641) acc 75.0000 (68.5386) kd_loss 0.7704 (0.7504) lr 2.2949e-04 eta 0:06:23
epoch [41/50] batch [360/445] time 0.079 (0.093) data 0.000 (0.011) loss 2.0154 (1.8642) ce_loss 1.0098 (0.8805) loss_zs_kd 1.8456 (2.0979) loss_oracle 0.4302 (0.4653) acc 65.6250 (68.5069) kd_loss 0.7905 (0.7511) lr 2.2949e-04 eta 0:06:19
epoch [41/50] batch [380/445] time 0.091 (0.092) data 0.000 (0.011) loss 1.7953 (1.8645) ce_loss 0.7856 (0.8814) loss_zs_kd 2.0340 (2.0998) loss_oracle 0.4677 (0.4659) acc 78.1250 (68.6020) kd_loss 0.7759 (0.7502) lr 2.2949e-04 eta 0:06:15
epoch [41/50] batch [400/445] time 0.085 (0.092) data 0.000 (0.010) loss 1.8554 (1.8626) ce_loss 1.0449 (0.8804) loss_zs_kd 1.6897 (2.1010) loss_oracle 0.3983 (0.4669) acc 62.5000 (68.6797) kd_loss 0.6114 (0.7487) lr 2.2949e-04 eta 0:06:12
epoch [41/50] batch [420/445] time 0.083 (0.091) data 0.000 (0.010) loss 1.9001 (1.8628) ce_loss 0.9316 (0.8802) loss_zs_kd 2.3040 (2.1081) loss_oracle 0.4568 (0.4676) acc 53.1250 (68.7202) kd_loss 0.7401 (0.7488) lr 2.2949e-04 eta 0:06:08
epoch [41/50] batch [440/445] time 0.075 (0.091) data 0.000 (0.009) loss 2.1360 (1.8626) ce_loss 1.2451 (0.8814) loss_zs_kd 2.0059 (2.1101) loss_oracle 0.3997 (0.4669) acc 59.3750 (68.5582) kd_loss 0.6910 (0.7478) lr 2.2949e-04 eta 0:06:04
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,466
* accuracy: 73.1%
* error: 26.9%
* macro_f1: 61.2%
Checkpoint saved to icml/multi-dg/tuning/03_zs0/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,064
* accuracy: 52.0%
* error: 48.0%
* macro_f1: 33.1%
******* Domain 3 best val acc:      73.1%, epoch: 41 *******
******* Domain 3 best val test acc: 52.0%, epoch: 41 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [42/50] batch [20/445] time 0.077 (0.272) data 0.000 (0.190) loss 2.2310 (1.8258) ce_loss 1.1650 (0.8890) loss_zs_kd 2.2245 (2.1687) loss_oracle 0.5373 (0.4668) acc 53.1250 (68.1250) kd_loss 0.7973 (0.7034) lr 1.9098e-04 eta 0:18:02
epoch [42/50] batch [40/445] time 0.079 (0.177) data 0.000 (0.095) loss 2.0442 (1.8446) ce_loss 1.1592 (0.8979) loss_zs_kd 1.7524 (2.1881) loss_oracle 0.4519 (0.4629) acc 62.5000 (66.8750) kd_loss 0.6591 (0.7153) lr 1.9098e-04 eta 0:11:43
epoch [42/50] batch [60/445] time 0.083 (0.147) data 0.000 (0.063) loss 2.3721 (1.8675) ce_loss 1.4014 (0.9167) loss_zs_kd 2.1158 (2.1264) loss_oracle 0.5169 (0.4652) acc 53.1250 (65.9375) kd_loss 0.7123 (0.7182) lr 1.9098e-04 eta 0:09:38
epoch [42/50] batch [80/445] time 0.085 (0.131) data 0.000 (0.048) loss 2.0105 (1.8366) ce_loss 0.9829 (0.8803) loss_zs_kd 1.8069 (2.1074) loss_oracle 0.4869 (0.4612) acc 59.3750 (67.5781) kd_loss 0.7841 (0.7257) lr 1.9098e-04 eta 0:08:34
epoch [42/50] batch [100/445] time 0.085 (0.121) data 0.000 (0.038) loss 1.5173 (1.8248) ce_loss 0.7603 (0.8745) loss_zs_kd 2.2026 (2.0907) loss_oracle 0.4169 (0.4577) acc 65.6250 (67.9375) kd_loss 0.5486 (0.7214) lr 1.9098e-04 eta 0:07:54
epoch [42/50] batch [120/445] time 0.085 (0.116) data 0.000 (0.032) loss 1.6699 (1.8218) ce_loss 0.6553 (0.8663) loss_zs_kd 2.2548 (2.1035) loss_oracle 0.5049 (0.4608) acc 75.0000 (68.2812) kd_loss 0.7622 (0.7251) lr 1.9098e-04 eta 0:07:29
epoch [42/50] batch [140/445] time 0.084 (0.112) data 0.000 (0.027) loss 1.8758 (1.8229) ce_loss 0.9502 (0.8643) loss_zs_kd 2.3086 (2.1032) loss_oracle 0.4337 (0.4627) acc 62.5000 (68.4821) kd_loss 0.7088 (0.7272) lr 1.9098e-04 eta 0:07:11
epoch [42/50] batch [160/445] time 0.083 (0.108) data 0.000 (0.024) loss 1.8565 (1.8266) ce_loss 0.8330 (0.8659) loss_zs_kd 1.7685 (2.1014) loss_oracle 0.3920 (0.4631) acc 78.1250 (68.3398) kd_loss 0.8275 (0.7291) lr 1.9098e-04 eta 0:06:55
epoch [42/50] batch [180/445] time 0.077 (0.105) data 0.000 (0.021) loss 2.0550 (1.8206) ce_loss 1.0391 (0.8611) loss_zs_kd 2.0874 (2.0991) loss_oracle 0.5281 (0.4627) acc 71.8750 (68.6111) kd_loss 0.7519 (0.7282) lr 1.9098e-04 eta 0:06:42
epoch [42/50] batch [200/445] time 0.086 (0.103) data 0.000 (0.019) loss 1.8469 (1.8239) ce_loss 0.8276 (0.8632) loss_zs_kd 2.0624 (2.0972) loss_oracle 0.4739 (0.4635) acc 62.5000 (68.5625) kd_loss 0.7823 (0.7290) lr 1.9098e-04 eta 0:06:31
epoch [42/50] batch [220/445] time 0.094 (0.101) data 0.000 (0.017) loss 2.1417 (1.8287) ce_loss 1.0654 (0.8661) loss_zs_kd 2.5090 (2.0992) loss_oracle 0.4887 (0.4645) acc 59.3750 (68.5369) kd_loss 0.8319 (0.7303) lr 1.9098e-04 eta 0:06:23
epoch [42/50] batch [240/445] time 0.086 (0.100) data 0.000 (0.016) loss 1.9095 (1.8322) ce_loss 0.9375 (0.8701) loss_zs_kd 1.3953 (2.0909) loss_oracle 0.4934 (0.4640) acc 65.6250 (68.5547) kd_loss 0.7254 (0.7301) lr 1.9098e-04 eta 0:06:16
epoch [42/50] batch [260/445] time 0.091 (0.099) data 0.000 (0.015) loss 1.8206 (1.8319) ce_loss 0.7603 (0.8711) loss_zs_kd 1.7206 (2.0944) loss_oracle 0.4770 (0.4630) acc 68.7500 (68.6178) kd_loss 0.8218 (0.7293) lr 1.9098e-04 eta 0:06:09
epoch [42/50] batch [280/445] time 0.058 (0.097) data 0.000 (0.014) loss 1.6627 (1.8334) ce_loss 0.8037 (0.8732) loss_zs_kd 1.7550 (2.0939) loss_oracle 0.4586 (0.4634) acc 75.0000 (68.6272) kd_loss 0.6296 (0.7285) lr 1.9098e-04 eta 0:06:02
epoch [42/50] batch [300/445] time 0.083 (0.096) data 0.000 (0.013) loss 1.3955 (1.8305) ce_loss 0.4778 (0.8712) loss_zs_kd 1.9381 (2.0923) loss_oracle 0.4384 (0.4645) acc 93.7500 (68.6771) kd_loss 0.6985 (0.7271) lr 1.9098e-04 eta 0:05:55
epoch [42/50] batch [320/445] time 0.086 (0.095) data 0.000 (0.012) loss 1.9129 (1.8314) ce_loss 0.9375 (0.8733) loss_zs_kd 2.1380 (2.0918) loss_oracle 0.4433 (0.4638) acc 68.7500 (68.6914) kd_loss 0.7538 (0.7262) lr 1.9098e-04 eta 0:05:50
epoch [42/50] batch [340/445] time 0.095 (0.094) data 0.000 (0.011) loss 1.7205 (1.8295) ce_loss 0.7021 (0.8724) loss_zs_kd 2.2682 (2.0969) loss_oracle 0.4099 (0.4634) acc 68.7500 (68.7316) kd_loss 0.8135 (0.7253) lr 1.9098e-04 eta 0:05:45
epoch [42/50] batch [360/445] time 0.080 (0.094) data 0.000 (0.011) loss 1.8007 (1.8287) ce_loss 0.8706 (0.8713) loss_zs_kd 1.9455 (2.1009) loss_oracle 0.4389 (0.4638) acc 68.7500 (68.7413) kd_loss 0.7107 (0.7256) lr 1.9098e-04 eta 0:05:41
epoch [42/50] batch [380/445] time 0.086 (0.093) data 0.000 (0.010) loss 1.6684 (1.8294) ce_loss 0.8545 (0.8720) loss_zs_kd 1.9461 (2.1013) loss_oracle 0.4098 (0.4632) acc 75.0000 (68.8076) kd_loss 0.6090 (0.7258) lr 1.9098e-04 eta 0:05:38
epoch [42/50] batch [400/445] time 0.083 (0.093) data 0.000 (0.010) loss 1.9126 (1.8282) ce_loss 0.8550 (0.8720) loss_zs_kd 1.6378 (2.1024) loss_oracle 0.4562 (0.4626) acc 78.1250 (68.8750) kd_loss 0.8295 (0.7249) lr 1.9098e-04 eta 0:05:34
epoch [42/50] batch [420/445] time 0.086 (0.092) data 0.000 (0.009) loss 2.2816 (1.8272) ce_loss 1.3984 (0.8717) loss_zs_kd 1.8916 (2.1031) loss_oracle 0.4125 (0.4624) acc 53.1250 (68.9137) kd_loss 0.6769 (0.7243) lr 1.9098e-04 eta 0:05:31
epoch [42/50] batch [440/445] time 0.082 (0.092) data 0.000 (0.009) loss 1.7014 (1.8298) ce_loss 0.7881 (0.8746) loss_zs_kd 2.0555 (2.1092) loss_oracle 0.4811 (0.4629) acc 78.1250 (68.7500) kd_loss 0.6727 (0.7237) lr 1.9098e-04 eta 0:05:28
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,450
* accuracy: 72.9%
* error: 27.1%
* macro_f1: 60.8%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,019
* accuracy: 50.9%
* error: 49.1%
* macro_f1: 31.6%
******* Domain 3 best val acc:      73.1%, epoch: 41 *******
******* Domain 3 best val test acc: 52.0%, epoch: 41 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [43/50] batch [20/445] time 0.088 (0.267) data 0.000 (0.186) loss 2.2786 (1.8213) ce_loss 1.3154 (0.8674) loss_zs_kd 2.6766 (2.1176) loss_oracle 0.5211 (0.4766) acc 56.2500 (70.3125) kd_loss 0.7026 (0.7156) lr 1.5567e-04 eta 0:15:46
epoch [43/50] batch [40/445] time 0.082 (0.176) data 0.000 (0.093) loss 1.8531 (1.8377) ce_loss 0.9546 (0.8840) loss_zs_kd 2.0599 (2.1077) loss_oracle 0.4549 (0.4755) acc 71.8750 (69.4531) kd_loss 0.6710 (0.7159) lr 1.5567e-04 eta 0:10:19
epoch [43/50] batch [60/445] time 0.084 (0.146) data 0.000 (0.062) loss 1.6923 (1.8445) ce_loss 0.7808 (0.8908) loss_zs_kd 1.9373 (2.1381) loss_oracle 0.4294 (0.4754) acc 75.0000 (69.6354) kd_loss 0.6969 (0.7160) lr 1.5567e-04 eta 0:08:29
epoch [43/50] batch [80/445] time 0.083 (0.131) data 0.000 (0.047) loss 2.0347 (1.8427) ce_loss 0.9370 (0.8894) loss_zs_kd 2.2920 (2.1518) loss_oracle 0.6079 (0.4742) acc 75.0000 (69.8828) kd_loss 0.7937 (0.7161) lr 1.5567e-04 eta 0:07:34
epoch [43/50] batch [100/445] time 0.087 (0.122) data 0.001 (0.037) loss 2.2004 (1.8377) ce_loss 1.2637 (0.8835) loss_zs_kd 2.2064 (2.1518) loss_oracle 0.5246 (0.4722) acc 46.8750 (69.7188) kd_loss 0.6745 (0.7182) lr 1.5567e-04 eta 0:07:00
epoch [43/50] batch [120/445] time 0.084 (0.116) data 0.000 (0.031) loss 1.7761 (1.8438) ce_loss 0.8667 (0.8829) loss_zs_kd 2.4099 (2.1513) loss_oracle 0.4292 (0.4720) acc 68.7500 (69.5833) kd_loss 0.6948 (0.7249) lr 1.5567e-04 eta 0:06:38
epoch [43/50] batch [140/445] time 0.088 (0.112) data 0.000 (0.027) loss 1.7991 (1.8382) ce_loss 0.7959 (0.8736) loss_zs_kd 1.6254 (2.1497) loss_oracle 0.4620 (0.4755) acc 68.7500 (69.5759) kd_loss 0.7721 (0.7268) lr 1.5567e-04 eta 0:06:21
epoch [43/50] batch [160/445] time 0.092 (0.109) data 0.000 (0.024) loss 1.7529 (1.8268) ce_loss 0.7671 (0.8639) loss_zs_kd 2.2506 (2.1632) loss_oracle 0.5613 (0.4741) acc 68.7500 (69.7852) kd_loss 0.7051 (0.7259) lr 1.5567e-04 eta 0:06:09
epoch [43/50] batch [180/445] time 0.087 (0.106) data 0.000 (0.021) loss 1.6845 (1.8293) ce_loss 0.7373 (0.8681) loss_zs_kd 2.1542 (2.1499) loss_oracle 0.5014 (0.4723) acc 75.0000 (69.4271) kd_loss 0.6965 (0.7251) lr 1.5567e-04 eta 0:05:58
epoch [43/50] batch [200/445] time 0.091 (0.104) data 0.000 (0.019) loss 1.8219 (1.8299) ce_loss 0.9243 (0.8706) loss_zs_kd 2.3073 (2.1491) loss_oracle 0.5240 (0.4714) acc 68.7500 (69.1719) kd_loss 0.6356 (0.7237) lr 1.5567e-04 eta 0:05:50
epoch [43/50] batch [220/445] time 0.083 (0.103) data 0.000 (0.017) loss 2.0378 (1.8338) ce_loss 1.1055 (0.8749) loss_zs_kd 2.1560 (2.1495) loss_oracle 0.4661 (0.4700) acc 50.0000 (69.0199) kd_loss 0.6993 (0.7239) lr 1.5567e-04 eta 0:05:43
epoch [43/50] batch [240/445] time 0.080 (0.102) data 0.000 (0.016) loss 1.8826 (1.8319) ce_loss 0.8940 (0.8742) loss_zs_kd 1.7679 (2.1558) loss_oracle 0.5301 (0.4685) acc 62.5000 (68.9453) kd_loss 0.7235 (0.7235) lr 1.5567e-04 eta 0:05:37
epoch [43/50] batch [260/445] time 0.081 (0.100) data 0.000 (0.015) loss 1.7708 (1.8319) ce_loss 0.8286 (0.8744) loss_zs_kd 1.9558 (2.1489) loss_oracle 0.4216 (0.4676) acc 68.7500 (68.9784) kd_loss 0.7314 (0.7237) lr 1.5567e-04 eta 0:05:29
epoch [43/50] batch [280/445] time 0.083 (0.099) data 0.000 (0.014) loss 1.8209 (1.8317) ce_loss 0.8960 (0.8747) loss_zs_kd 1.7882 (2.1468) loss_oracle 0.5095 (0.4665) acc 75.0000 (68.9732) kd_loss 0.6701 (0.7238) lr 1.5567e-04 eta 0:05:24
epoch [43/50] batch [300/445] time 0.088 (0.098) data 0.000 (0.013) loss 2.2590 (1.8282) ce_loss 1.3262 (0.8722) loss_zs_kd 2.3170 (2.1443) loss_oracle 0.4809 (0.4650) acc 62.5000 (69.0312) kd_loss 0.6924 (0.7235) lr 1.5567e-04 eta 0:05:19
epoch [43/50] batch [320/445] time 0.086 (0.097) data 0.000 (0.012) loss 2.1512 (1.8311) ce_loss 1.1670 (0.8745) loss_zs_kd 2.4497 (2.1371) loss_oracle 0.5852 (0.4654) acc 59.3750 (68.9453) kd_loss 0.6916 (0.7239) lr 1.5567e-04 eta 0:05:15
epoch [43/50] batch [340/445] time 0.088 (0.096) data 0.001 (0.011) loss 1.8699 (1.8343) ce_loss 0.9341 (0.8784) loss_zs_kd 2.2577 (2.1339) loss_oracle 0.4417 (0.4645) acc 68.7500 (68.8143) kd_loss 0.7149 (0.7237) lr 1.5567e-04 eta 0:05:10
epoch [43/50] batch [360/445] time 0.089 (0.096) data 0.000 (0.011) loss 1.6505 (1.8320) ce_loss 0.7451 (0.8779) loss_zs_kd 2.2549 (2.1352) loss_oracle 0.3794 (0.4632) acc 75.0000 (68.7587) kd_loss 0.7157 (0.7225) lr 1.5567e-04 eta 0:05:06
epoch [43/50] batch [380/445] time 0.077 (0.095) data 0.000 (0.010) loss 1.7152 (1.8305) ce_loss 0.7739 (0.8778) loss_zs_kd 2.4807 (2.1272) loss_oracle 0.5096 (0.4631) acc 81.2500 (68.6678) kd_loss 0.6865 (0.7212) lr 1.5567e-04 eta 0:05:02
epoch [43/50] batch [400/445] time 0.084 (0.095) data 0.000 (0.010) loss 1.9185 (1.8272) ce_loss 0.9658 (0.8769) loss_zs_kd 2.0636 (2.1300) loss_oracle 0.4375 (0.4619) acc 68.7500 (68.7188) kd_loss 0.7339 (0.7194) lr 1.5567e-04 eta 0:04:58
epoch [43/50] batch [420/445] time 0.079 (0.094) data 0.000 (0.009) loss 1.8398 (1.8250) ce_loss 0.9810 (0.8759) loss_zs_kd 2.4276 (2.1331) loss_oracle 0.4297 (0.4611) acc 62.5000 (68.8318) kd_loss 0.6440 (0.7185) lr 1.5567e-04 eta 0:04:55
epoch [43/50] batch [440/445] time 0.080 (0.093) data 0.000 (0.009) loss 1.9686 (1.8226) ce_loss 0.9502 (0.8746) loss_zs_kd 1.7995 (2.1333) loss_oracle 0.4526 (0.4607) acc 59.3750 (68.8991) kd_loss 0.7921 (0.7177) lr 1.5567e-04 eta 0:04:51
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,448
* accuracy: 72.8%
* error: 27.2%
* macro_f1: 60.4%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,050
* accuracy: 51.6%
* error: 48.4%
* macro_f1: 32.6%
******* Domain 3 best val acc:      73.1%, epoch: 41 *******
******* Domain 3 best val test acc: 52.0%, epoch: 41 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [44/50] batch [20/445] time 0.087 (0.236) data 0.000 (0.150) loss 1.9701 (1.7620) ce_loss 0.9268 (0.8458) loss_zs_kd 1.9379 (2.0045) loss_oracle 0.5752 (0.4475) acc 68.7500 (69.2188) kd_loss 0.7558 (0.6925) lr 1.2369e-04 eta 0:12:11
epoch [44/50] batch [40/445] time 0.080 (0.161) data 0.000 (0.075) loss 1.8511 (1.7852) ce_loss 0.9248 (0.8692) loss_zs_kd 2.2977 (2.0397) loss_oracle 0.3865 (0.4456) acc 53.1250 (69.3750) kd_loss 0.7330 (0.6933) lr 1.2369e-04 eta 0:08:15
epoch [44/50] batch [60/445] time 0.078 (0.135) data 0.000 (0.050) loss 1.7752 (1.7899) ce_loss 0.7783 (0.8690) loss_zs_kd 2.4989 (2.0840) loss_oracle 0.5077 (0.4497) acc 68.7500 (69.6875) kd_loss 0.7431 (0.6961) lr 1.2369e-04 eta 0:06:53
epoch [44/50] batch [80/445] time 0.082 (0.122) data 0.000 (0.038) loss 1.7775 (1.7965) ce_loss 0.8340 (0.8703) loss_zs_kd 1.6423 (2.0990) loss_oracle 0.3886 (0.4485) acc 68.7500 (69.9219) kd_loss 0.7492 (0.7020) lr 1.2369e-04 eta 0:06:10
epoch [44/50] batch [100/445] time 0.081 (0.114) data 0.000 (0.030) loss 1.7781 (1.7957) ce_loss 1.0703 (0.8699) loss_zs_kd 2.2740 (2.0921) loss_oracle 0.3945 (0.4487) acc 59.3750 (69.2188) kd_loss 0.5106 (0.7014) lr 1.2369e-04 eta 0:05:42
epoch [44/50] batch [120/445] time 0.237 (0.110) data 0.000 (0.025) loss 1.9847 (1.8031) ce_loss 0.9492 (0.8734) loss_zs_kd 2.3092 (2.0790) loss_oracle 0.4696 (0.4515) acc 65.6250 (69.1146) kd_loss 0.8007 (0.7040) lr 1.2369e-04 eta 0:05:29
epoch [44/50] batch [140/445] time 0.087 (0.106) data 0.001 (0.022) loss 1.8928 (1.7986) ce_loss 0.9863 (0.8681) loss_zs_kd 1.9757 (2.0812) loss_oracle 0.4547 (0.4526) acc 65.6250 (69.1741) kd_loss 0.6791 (0.7043) lr 1.2369e-04 eta 0:05:15
epoch [44/50] batch [160/445] time 0.087 (0.103) data 0.000 (0.019) loss 1.8404 (1.8038) ce_loss 0.8877 (0.8683) loss_zs_kd 1.8710 (2.0791) loss_oracle 0.4721 (0.4552) acc 65.6250 (69.1797) kd_loss 0.7167 (0.7079) lr 1.2369e-04 eta 0:05:05
epoch [44/50] batch [180/445] time 0.086 (0.101) data 0.000 (0.017) loss 1.7774 (1.8085) ce_loss 0.8477 (0.8740) loss_zs_kd 2.2607 (2.0840) loss_oracle 0.4583 (0.4563) acc 68.7500 (68.8542) kd_loss 0.7005 (0.7064) lr 1.2369e-04 eta 0:04:57
epoch [44/50] batch [200/445] time 0.088 (0.099) data 0.000 (0.015) loss 2.0407 (1.8105) ce_loss 1.1533 (0.8761) loss_zs_kd 2.7062 (2.0970) loss_oracle 0.4422 (0.4563) acc 59.3750 (68.6719) kd_loss 0.6663 (0.7062) lr 1.2369e-04 eta 0:04:49
epoch [44/50] batch [220/445] time 0.078 (0.098) data 0.000 (0.014) loss 1.7944 (1.8085) ce_loss 0.8965 (0.8744) loss_zs_kd 1.5621 (2.1043) loss_oracle 0.4660 (0.4562) acc 59.3750 (68.6932) kd_loss 0.6650 (0.7059) lr 1.2369e-04 eta 0:04:42
epoch [44/50] batch [240/445] time 0.088 (0.097) data 0.000 (0.013) loss 1.5656 (1.8069) ce_loss 0.6782 (0.8730) loss_zs_kd 1.9787 (2.1011) loss_oracle 0.3932 (0.4566) acc 68.7500 (68.8672) kd_loss 0.6908 (0.7057) lr 1.2369e-04 eta 0:04:37
epoch [44/50] batch [260/445] time 0.079 (0.095) data 0.000 (0.012) loss 1.8533 (1.8125) ce_loss 0.9941 (0.8780) loss_zs_kd 1.6979 (2.0994) loss_oracle 0.4246 (0.4567) acc 68.7500 (68.6779) kd_loss 0.6469 (0.7061) lr 1.2369e-04 eta 0:04:32
epoch [44/50] batch [280/445] time 0.086 (0.095) data 0.000 (0.011) loss 1.8257 (1.8151) ce_loss 0.9473 (0.8815) loss_zs_kd 2.2392 (2.1007) loss_oracle 0.4084 (0.4560) acc 59.3750 (68.6607) kd_loss 0.6743 (0.7056) lr 1.2369e-04 eta 0:04:28
epoch [44/50] batch [300/445] time 0.083 (0.094) data 0.001 (0.010) loss 1.6676 (1.8131) ce_loss 0.7759 (0.8802) loss_zs_kd 1.7173 (2.0976) loss_oracle 0.4475 (0.4557) acc 71.8750 (68.7188) kd_loss 0.6680 (0.7050) lr 1.2369e-04 eta 0:04:24
epoch [44/50] batch [320/445] time 0.082 (0.093) data 0.000 (0.010) loss 1.7248 (1.8132) ce_loss 0.7773 (0.8798) loss_zs_kd 2.1641 (2.0976) loss_oracle 0.4788 (0.4571) acc 75.0000 (68.7305) kd_loss 0.7080 (0.7049) lr 1.2369e-04 eta 0:04:20
epoch [44/50] batch [340/445] time 0.078 (0.092) data 0.000 (0.009) loss 1.7890 (1.8174) ce_loss 0.8223 (0.8844) loss_zs_kd 2.0306 (2.0975) loss_oracle 0.4404 (0.4579) acc 71.8750 (68.6305) kd_loss 0.7465 (0.7040) lr 1.2369e-04 eta 0:04:16
epoch [44/50] batch [360/445] time 0.084 (0.092) data 0.000 (0.009) loss 1.8419 (1.8167) ce_loss 0.9385 (0.8835) loss_zs_kd 2.1138 (2.0983) loss_oracle 0.3807 (0.4576) acc 59.3750 (68.5938) kd_loss 0.7130 (0.7045) lr 1.2369e-04 eta 0:04:13
epoch [44/50] batch [380/445] time 0.073 (0.091) data 0.000 (0.008) loss 1.7588 (1.8153) ce_loss 0.9038 (0.8828) loss_zs_kd 2.6214 (2.0977) loss_oracle 0.3917 (0.4569) acc 65.6250 (68.4786) kd_loss 0.6591 (0.7040) lr 1.2369e-04 eta 0:04:08
epoch [44/50] batch [400/445] time 0.069 (0.090) data 0.000 (0.008) loss 1.9712 (1.8129) ce_loss 1.0557 (0.8795) loss_zs_kd 2.0871 (2.1006) loss_oracle 0.4492 (0.4572) acc 50.0000 (68.6250) kd_loss 0.6909 (0.7048) lr 1.2369e-04 eta 0:04:03
epoch [44/50] batch [420/445] time 0.085 (0.089) data 0.000 (0.007) loss 1.4839 (1.8098) ce_loss 0.6528 (0.8767) loss_zs_kd 1.7473 (2.0984) loss_oracle 0.3836 (0.4571) acc 71.8750 (68.7351) kd_loss 0.6392 (0.7046) lr 1.2369e-04 eta 0:03:59
epoch [44/50] batch [440/445] time 0.079 (0.089) data 0.000 (0.007) loss 1.7769 (1.8082) ce_loss 0.8906 (0.8764) loss_zs_kd 2.4052 (2.1024) loss_oracle 0.4876 (0.4572) acc 71.8750 (68.8849) kd_loss 0.6424 (0.7032) lr 1.2369e-04 eta 0:03:56
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,460
* accuracy: 73.0%
* error: 27.0%
* macro_f1: 60.8%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,068
* accuracy: 52.1%
* error: 47.9%
* macro_f1: 32.8%
******* Domain 3 best val acc:      73.1%, epoch: 41 *******
******* Domain 3 best val test acc: 52.0%, epoch: 41 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [45/50] batch [20/445] time 0.079 (0.290) data 0.000 (0.201) loss 1.7871 (1.8473) ce_loss 0.8389 (0.9184) loss_zs_kd 1.7739 (2.1752) loss_oracle 0.4877 (0.4524) acc 68.7500 (66.7188) kd_loss 0.7044 (0.7027) lr 9.5173e-05 eta 0:12:47
epoch [45/50] batch [40/445] time 0.085 (0.188) data 0.000 (0.101) loss 1.9136 (1.8351) ce_loss 1.0488 (0.9089) loss_zs_kd 2.2660 (2.1731) loss_oracle 0.4318 (0.4587) acc 68.7500 (67.8125) kd_loss 0.6488 (0.6968) lr 9.5173e-05 eta 0:08:14
epoch [45/50] batch [60/445] time 0.084 (0.152) data 0.000 (0.067) loss 1.6831 (1.8308) ce_loss 0.7578 (0.8975) loss_zs_kd 2.4103 (2.1654) loss_oracle 0.4388 (0.4584) acc 81.2500 (68.3333) kd_loss 0.7059 (0.7041) lr 9.5173e-05 eta 0:06:37
epoch [45/50] batch [80/445] time 0.092 (0.135) data 0.000 (0.051) loss 1.7245 (1.8227) ce_loss 0.7544 (0.8878) loss_zs_kd 1.9951 (2.1333) loss_oracle 0.4779 (0.4627) acc 68.7500 (68.5156) kd_loss 0.7312 (0.7035) lr 9.5173e-05 eta 0:05:50
epoch [45/50] batch [100/445] time 0.081 (0.125) data 0.000 (0.040) loss 2.0965 (1.8253) ce_loss 1.2373 (0.8865) loss_zs_kd 1.8885 (2.1170) loss_oracle 0.4699 (0.4638) acc 65.6250 (68.6875) kd_loss 0.6242 (0.7069) lr 9.5173e-05 eta 0:05:22
epoch [45/50] batch [120/445] time 0.081 (0.119) data 0.000 (0.034) loss 1.7282 (1.8221) ce_loss 0.7153 (0.8873) loss_zs_kd 2.0299 (2.1059) loss_oracle 0.5159 (0.4637) acc 81.2500 (68.7500) kd_loss 0.7549 (0.7029) lr 9.5173e-05 eta 0:05:02
epoch [45/50] batch [140/445] time 0.082 (0.113) data 0.000 (0.029) loss 1.5724 (1.8179) ce_loss 0.6689 (0.8819) loss_zs_kd 2.1639 (2.1125) loss_oracle 0.3954 (0.4628) acc 78.1250 (69.1741) kd_loss 0.7058 (0.7047) lr 9.5173e-05 eta 0:04:47
epoch [45/50] batch [160/445] time 0.080 (0.109) data 0.000 (0.025) loss 1.6614 (1.8157) ce_loss 0.8066 (0.8799) loss_zs_kd 2.1227 (2.1149) loss_oracle 0.4311 (0.4617) acc 78.1250 (69.1211) kd_loss 0.6392 (0.7049) lr 9.5173e-05 eta 0:04:34
epoch [45/50] batch [180/445] time 0.090 (0.107) data 0.000 (0.023) loss 1.6719 (1.8139) ce_loss 0.8174 (0.8800) loss_zs_kd 2.3611 (2.1165) loss_oracle 0.4203 (0.4609) acc 78.1250 (68.8194) kd_loss 0.6443 (0.7034) lr 9.5173e-05 eta 0:04:25
epoch [45/50] batch [200/445] time 0.068 (0.104) data 0.000 (0.020) loss 1.6849 (1.8060) ce_loss 0.7798 (0.8724) loss_zs_kd 2.4581 (2.1085) loss_oracle 0.4672 (0.4603) acc 81.2500 (69.1250) kd_loss 0.6715 (0.7035) lr 9.5173e-05 eta 0:04:16
epoch [45/50] batch [220/445] time 0.083 (0.101) data 0.001 (0.019) loss 2.0010 (1.8087) ce_loss 1.0908 (0.8750) loss_zs_kd 1.7916 (2.1099) loss_oracle 0.4128 (0.4601) acc 65.6250 (68.9773) kd_loss 0.7037 (0.7037) lr 9.5173e-05 eta 0:04:08
epoch [45/50] batch [240/445] time 0.062 (0.099) data 0.000 (0.017) loss 1.8143 (1.8131) ce_loss 0.8838 (0.8782) loss_zs_kd 2.0740 (2.1198) loss_oracle 0.4484 (0.4608) acc 68.7500 (68.7760) kd_loss 0.7063 (0.7045) lr 9.5173e-05 eta 0:04:01
epoch [45/50] batch [260/445] time 0.092 (0.098) data 0.000 (0.016) loss 1.9396 (1.8166) ce_loss 0.9077 (0.8801) loss_zs_kd 2.2326 (2.1214) loss_oracle 0.4534 (0.4608) acc 71.8750 (68.5817) kd_loss 0.8051 (0.7061) lr 9.5173e-05 eta 0:03:56
epoch [45/50] batch [280/445] time 0.084 (0.097) data 0.000 (0.015) loss 2.0603 (1.8138) ce_loss 1.1729 (0.8792) loss_zs_kd 2.1092 (2.1237) loss_oracle 0.4633 (0.4604) acc 53.1250 (68.6496) kd_loss 0.6558 (0.7045) lr 9.5173e-05 eta 0:03:52
epoch [45/50] batch [300/445] time 0.079 (0.096) data 0.000 (0.014) loss 1.8439 (1.8139) ce_loss 0.9253 (0.8785) loss_zs_kd 2.0133 (2.1191) loss_oracle 0.5348 (0.4605) acc 68.7500 (68.6250) kd_loss 0.6512 (0.7051) lr 9.5173e-05 eta 0:03:48
epoch [45/50] batch [320/445] time 0.084 (0.096) data 0.000 (0.013) loss 1.9612 (1.8216) ce_loss 0.9839 (0.8851) loss_zs_kd 2.0375 (2.1238) loss_oracle 0.4950 (0.4613) acc 65.6250 (68.3496) kd_loss 0.7298 (0.7058) lr 9.5173e-05 eta 0:03:44
epoch [45/50] batch [340/445] time 0.073 (0.095) data 0.000 (0.012) loss 1.7394 (1.8190) ce_loss 0.7646 (0.8818) loss_zs_kd 2.4894 (2.1240) loss_oracle 0.4313 (0.4615) acc 68.7500 (68.5662) kd_loss 0.7591 (0.7064) lr 9.5173e-05 eta 0:03:41
epoch [45/50] batch [360/445] time 0.089 (0.094) data 0.000 (0.011) loss 1.6208 (1.8136) ce_loss 0.7881 (0.8779) loss_zs_kd 2.5777 (2.1216) loss_oracle 0.5220 (0.4606) acc 71.8750 (68.7240) kd_loss 0.5717 (0.7054) lr 9.5173e-05 eta 0:03:38
epoch [45/50] batch [380/445] time 0.094 (0.094) data 0.000 (0.011) loss 1.9305 (1.8146) ce_loss 0.9521 (0.8782) loss_zs_kd 1.9821 (2.1216) loss_oracle 0.5398 (0.4609) acc 62.5000 (68.6349) kd_loss 0.7084 (0.7059) lr 9.5173e-05 eta 0:03:34
epoch [45/50] batch [400/445] time 0.143 (0.093) data 0.001 (0.010) loss 1.7573 (1.8149) ce_loss 0.6748 (0.8774) loss_zs_kd 2.2194 (2.1222) loss_oracle 0.4895 (0.4613) acc 81.2500 (68.6172) kd_loss 0.8377 (0.7068) lr 9.5173e-05 eta 0:03:32
epoch [45/50] batch [420/445] time 0.087 (0.093) data 0.000 (0.010) loss 1.8519 (1.8149) ce_loss 1.0430 (0.8783) loss_zs_kd 2.3764 (2.1231) loss_oracle 0.3996 (0.4613) acc 62.5000 (68.5491) kd_loss 0.6091 (0.7059) lr 9.5173e-05 eta 0:03:29
epoch [45/50] batch [440/445] time 0.079 (0.093) data 0.000 (0.009) loss 1.9862 (1.8141) ce_loss 1.0381 (0.8777) loss_zs_kd 2.4089 (2.1283) loss_oracle 0.4442 (0.4610) acc 62.5000 (68.5866) kd_loss 0.7260 (0.7058) lr 9.5173e-05 eta 0:03:26
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,462
* accuracy: 73.1%
* error: 26.9%
* macro_f1: 61.0%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,062
* accuracy: 51.9%
* error: 48.1%
* macro_f1: 32.8%
******* Domain 3 best val acc:      73.1%, epoch: 41 *******
******* Domain 3 best val test acc: 52.0%, epoch: 41 *******
******* Domain 3 best test acc:     53.5%, epoch: 26 *******
epoch [46/50] batch [20/445] time 0.091 (0.311) data 0.000 (0.226) loss 1.9003 (1.7915) ce_loss 0.8950 (0.8620) loss_zs_kd 2.6877 (2.1806) loss_oracle 0.5417 (0.4714) acc 65.6250 (69.3750) kd_loss 0.7344 (0.6938) lr 7.0224e-05 eta 0:11:25
epoch [46/50] batch [40/445] time 0.084 (0.198) data 0.000 (0.113) loss 1.6632 (1.7942) ce_loss 0.7695 (0.8622) loss_zs_kd 1.8434 (2.1266) loss_oracle 0.4503 (0.4689) acc 78.1250 (70.4688) kd_loss 0.6685 (0.6975) lr 7.0224e-05 eta 0:07:12
epoch [46/50] batch [60/445] time 0.089 (0.160) data 0.000 (0.076) loss 1.7508 (1.7826) ce_loss 0.8281 (0.8582) loss_zs_kd 2.1440 (2.1508) loss_oracle 0.4768 (0.4597) acc 68.7500 (69.6875) kd_loss 0.6843 (0.6946) lr 7.0224e-05 eta 0:05:47
epoch [46/50] batch [80/445] time 0.075 (0.141) data 0.000 (0.057) loss 1.7965 (1.7796) ce_loss 0.8687 (0.8474) loss_zs_kd 2.3130 (2.1269) loss_oracle 0.4443 (0.4612) acc 62.5000 (70.3125) kd_loss 0.7058 (0.7016) lr 7.0224e-05 eta 0:05:02
epoch [46/50] batch [100/445] time 0.082 (0.130) data 0.000 (0.045) loss 1.6959 (1.7823) ce_loss 0.8398 (0.8518) loss_zs_kd 2.2579 (2.1206) loss_oracle 0.4525 (0.4621) acc 71.8750 (70.3438) kd_loss 0.6298 (0.6994) lr 7.0224e-05 eta 0:04:35
epoch [46/50] batch [120/445] time 0.084 (0.122) data 0.000 (0.038) loss 1.9276 (1.7827) ce_loss 1.0596 (0.8536) loss_zs_kd 2.1262 (2.1192) loss_oracle 0.4415 (0.4581) acc 59.3750 (70.0521) kd_loss 0.6473 (0.7001) lr 7.0224e-05 eta 0:04:16
epoch [46/50] batch [140/445] time 0.078 (0.116) data 0.000 (0.033) loss 2.1828 (1.7882) ce_loss 1.1797 (0.8579) loss_zs_kd 2.4036 (2.1018) loss_oracle 0.5345 (0.4614) acc 53.1250 (69.7321) kd_loss 0.7359 (0.6996) lr 7.0224e-05 eta 0:04:01
epoch [46/50] batch [160/445] time 0.097 (0.112) data 0.000 (0.029) loss 1.9144 (1.8001) ce_loss 1.0449 (0.8688) loss_zs_kd 2.0066 (2.0984) loss_oracle 0.5057 (0.4606) acc 59.3750 (69.1797) kd_loss 0.6166 (0.7010) lr 7.0224e-05 eta 0:03:50
epoch [46/50] batch [180/445] time 0.087 (0.109) data 0.000 (0.025) loss 2.0340 (1.8070) ce_loss 1.0381 (0.8743) loss_zs_kd 1.8878 (2.0979) loss_oracle 0.4826 (0.4616) acc 56.2500 (69.0972) kd_loss 0.7546 (0.7019) lr 7.0224e-05 eta 0:03:42
epoch [46/50] batch [200/445] time 0.081 (0.106) data 0.000 (0.023) loss 1.6850 (1.8074) ce_loss 0.7070 (0.8735) loss_zs_kd 2.0507 (2.0926) loss_oracle 0.3972 (0.4605) acc 81.2500 (69.0938) kd_loss 0.7794 (0.7037) lr 7.0224e-05 eta 0:03:35
epoch [46/50] batch [220/445] time 0.082 (0.105) data 0.000 (0.021) loss 2.0697 (1.8122) ce_loss 1.1689 (0.8794) loss_zs_kd 2.2082 (2.1044) loss_oracle 0.4784 (0.4604) acc 53.1250 (69.0483) kd_loss 0.6615 (0.7026) lr 7.0224e-05 eta 0:03:29
epoch [46/50] batch [240/445] time 0.086 (0.103) data 0.000 (0.019) loss 1.9645 (1.8133) ce_loss 0.9634 (0.8778) loss_zs_kd 2.1467 (2.1046) loss_oracle 0.4670 (0.4614) acc 65.6250 (68.9844) kd_loss 0.7677 (0.7048) lr 7.0224e-05 eta 0:03:23
