Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_100', 'location_43', 'location_46']
Target     ['location_38']
# classes  10
# train_x  10,216
# val      4,378
# test     9,736
---------  ----------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/319] time 0.086 (0.142) data 0.000 (0.040) loss 1.2546 (2.0194) ce_loss 1.2539 (2.0161) loss_zs_kd 0.0002 (0.0001) loss_oracle -0.0001 (-0.0001) acc 59.3750 (37.0312) kd_loss 0.0007 (0.0033) lr 1.0000e-05 eta 0:37:49
epoch [1/50] batch [40/319] time 0.078 (0.112) data 0.000 (0.020) loss 1.5752 (1.9150) ce_loss 1.5732 (1.9125) loss_zs_kd 0.0016 (0.0003) loss_oracle -0.0001 (-0.0001) acc 56.2500 (39.7656) kd_loss 0.0020 (0.0026) lr 1.0000e-05 eta 0:29:38
epoch [1/50] batch [60/319] time 0.071 (0.100) data 0.000 (0.014) loss 2.1728 (1.9427) ce_loss 2.1719 (1.9406) loss_zs_kd 0.0025 (0.0007) loss_oracle 0.0000 (-0.0000) acc 31.2500 (39.1667) kd_loss 0.0009 (0.0022) lr 1.0000e-05 eta 0:26:36
epoch [1/50] batch [80/319] time 0.070 (0.095) data 0.000 (0.010) loss 1.9730 (1.9239) ce_loss 1.9717 (1.9220) loss_zs_kd 0.0040 (0.0014) loss_oracle 0.0001 (-0.0000) acc 43.7500 (38.8281) kd_loss 0.0012 (0.0019) lr 1.0000e-05 eta 0:25:02
epoch [1/50] batch [100/319] time 0.077 (0.091) data 0.000 (0.008) loss 2.1712 (1.8850) ce_loss 2.1699 (1.8832) loss_zs_kd 0.0073 (0.0024) loss_oracle -0.0000 (-0.0000) acc 25.0000 (39.4062) kd_loss 0.0013 (0.0018) lr 1.0000e-05 eta 0:24:09
epoch [1/50] batch [120/319] time 0.091 (0.090) data 0.000 (0.007) loss 1.8666 (1.8828) ce_loss 1.8643 (1.8810) loss_zs_kd 0.0062 (0.0033) loss_oracle 0.0001 (-0.0000) acc 40.6250 (39.6094) kd_loss 0.0023 (0.0018) lr 1.0000e-05 eta 0:23:40
epoch [1/50] batch [140/319] time 0.093 (0.089) data 0.000 (0.006) loss 2.0542 (1.8828) ce_loss 2.0508 (1.8809) loss_zs_kd 0.0105 (0.0043) loss_oracle 0.0001 (0.0000) acc 37.5000 (39.5312) kd_loss 0.0034 (0.0019) lr 1.0000e-05 eta 0:23:26
epoch [1/50] batch [160/319] time 0.080 (0.088) data 0.000 (0.005) loss 1.8295 (1.8790) ce_loss 1.8271 (1.8769) loss_zs_kd 0.0138 (0.0056) loss_oracle 0.0001 (0.0000) acc 34.3750 (39.6680) kd_loss 0.0023 (0.0020) lr 1.0000e-05 eta 0:23:12
epoch [1/50] batch [180/319] time 0.078 (0.088) data 0.000 (0.005) loss 2.1831 (1.8757) ce_loss 2.1797 (1.8736) loss_zs_kd 0.0231 (0.0071) loss_oracle 0.0000 (0.0000) acc 28.1250 (39.6181) kd_loss 0.0034 (0.0021) lr 1.0000e-05 eta 0:23:03
epoch [1/50] batch [200/319] time 0.087 (0.088) data 0.000 (0.004) loss 1.9983 (1.8713) ce_loss 1.9932 (1.8690) loss_zs_kd 0.0239 (0.0086) loss_oracle 0.0002 (0.0000) acc 31.2500 (39.5781) kd_loss 0.0051 (0.0023) lr 1.0000e-05 eta 0:22:58
epoch [1/50] batch [220/319] time 0.090 (0.087) data 0.000 (0.004) loss 1.7243 (1.8775) ce_loss 1.7178 (1.8748) loss_zs_kd 0.0308 (0.0104) loss_oracle 0.0002 (0.0001) acc 50.0000 (39.2045) kd_loss 0.0064 (0.0026) lr 1.0000e-05 eta 0:22:54
epoch [1/50] batch [240/319] time 0.085 (0.087) data 0.000 (0.004) loss 1.9403 (1.8843) ce_loss 1.9326 (1.8813) loss_zs_kd 0.0438 (0.0123) loss_oracle 0.0004 (0.0001) acc 28.1250 (38.8932) kd_loss 0.0075 (0.0030) lr 1.0000e-05 eta 0:22:49
epoch [1/50] batch [260/319] time 0.085 (0.086) data 0.000 (0.003) loss 1.9805 (1.8822) ce_loss 1.9746 (1.8787) loss_zs_kd 0.0393 (0.0142) loss_oracle 0.0006 (0.0001) acc 40.6250 (38.8101) kd_loss 0.0056 (0.0034) lr 1.0000e-05 eta 0:22:34
epoch [1/50] batch [280/319] time 0.079 (0.086) data 0.000 (0.003) loss 2.0837 (1.8788) ce_loss 2.0723 (1.8749) loss_zs_kd 0.0567 (0.0164) loss_oracle 0.0006 (0.0001) acc 31.2500 (38.8170) kd_loss 0.0111 (0.0039) lr 1.0000e-05 eta 0:22:27
epoch [1/50] batch [300/319] time 0.085 (0.086) data 0.000 (0.003) loss 2.2879 (1.8753) ce_loss 2.2793 (1.8707) loss_zs_kd 0.0568 (0.0188) loss_oracle 0.0011 (0.0002) acc 31.2500 (38.8125) kd_loss 0.0081 (0.0045) lr 1.0000e-05 eta 0:22:18
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 1,772
* accuracy: 40.5%
* error: 59.5%
* macro_f1: 26.1%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 3,186
* accuracy: 32.7%
* error: 67.3%
* macro_f1: 14.2%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      40.5%, epoch: 1 *******
******* Domain 2 best val test acc: 32.7%, epoch: 1 *******
******* Domain 2 best test acc:     32.7%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/ana
epoch [2/50] batch [20/319] time 0.074 (0.120) data 0.000 (0.034) loss 2.9139 (2.1340) ce_loss 1.7432 (1.6397) loss_zs_kd 0.6986 (0.3174) loss_oracle 0.6608 (0.3763) acc 40.6250 (39.8438) kd_loss 0.8403 (0.3060) lr 2.0000e-03 eta 0:31:08
epoch [2/50] batch [40/319] time 0.087 (0.102) data 0.000 (0.017) loss 3.0551 (2.4271) ce_loss 1.9502 (1.5994) loss_zs_kd 0.5716 (0.4904) loss_oracle 0.5391 (0.4560) acc 25.0000 (41.0938) kd_loss 0.8354 (0.5997) lr 2.0000e-03 eta 0:26:23
epoch [2/50] batch [60/319] time 0.082 (0.094) data 0.001 (0.012) loss 2.7850 (2.5301) ce_loss 1.4268 (1.5601) loss_zs_kd 0.5964 (0.5426) loss_oracle 0.6178 (0.5126) acc 34.3750 (42.3958) kd_loss 1.0493 (0.7138) lr 2.0000e-03 eta 0:24:23
epoch [2/50] batch [80/319] time 0.090 (0.091) data 0.000 (0.009) loss 2.8557 (2.5786) ce_loss 1.4170 (1.5196) loss_zs_kd 0.6869 (0.5655) loss_oracle 0.8431 (0.5631) acc 46.8750 (43.9844) kd_loss 1.0172 (0.7775) lr 2.0000e-03 eta 0:23:29
epoch [2/50] batch [100/319] time 0.083 (0.089) data 0.000 (0.007) loss 2.7663 (2.6023) ce_loss 1.4512 (1.4930) loss_zs_kd 0.6992 (0.5935) loss_oracle 0.7496 (0.5922) acc 40.6250 (44.3750) kd_loss 0.9403 (0.8132) lr 2.0000e-03 eta 0:23:04
epoch [2/50] batch [120/319] time 0.074 (0.087) data 0.000 (0.006) loss 2.2963 (2.6053) ce_loss 1.0098 (1.4618) loss_zs_kd 0.8912 (0.6380) loss_oracle 0.7219 (0.6191) acc 65.6250 (45.2344) kd_loss 0.9257 (0.8339) lr 2.0000e-03 eta 0:22:36
epoch [2/50] batch [140/319] time 0.077 (0.086) data 0.000 (0.005) loss 2.8394 (2.6172) ce_loss 1.6143 (1.4486) loss_zs_kd 0.7455 (0.6711) loss_oracle 0.7073 (0.6399) acc 34.3750 (45.7589) kd_loss 0.8715 (0.8486) lr 2.0000e-03 eta 0:22:17
epoch [2/50] batch [160/319] time 0.086 (0.085) data 0.000 (0.005) loss 2.6525 (2.6211) ce_loss 1.3066 (1.4306) loss_zs_kd 0.7594 (0.6894) loss_oracle 0.8014 (0.6622) acc 53.1250 (46.4648) kd_loss 0.9451 (0.8594) lr 2.0000e-03 eta 0:21:59
epoch [2/50] batch [180/319] time 0.091 (0.085) data 0.000 (0.004) loss 2.9155 (2.6270) ce_loss 1.5273 (1.4212) loss_zs_kd 0.9777 (0.7074) loss_oracle 0.8627 (0.6815) acc 40.6250 (46.9618) kd_loss 0.9568 (0.8650) lr 2.0000e-03 eta 0:22:00
epoch [2/50] batch [200/319] time 0.087 (0.085) data 0.000 (0.004) loss 2.5842 (2.6261) ce_loss 1.2744 (1.4121) loss_zs_kd 0.8935 (0.7236) loss_oracle 0.8900 (0.6945) acc 62.5000 (47.2500) kd_loss 0.8648 (0.8667) lr 2.0000e-03 eta 0:21:57
epoch [2/50] batch [220/319] time 0.084 (0.086) data 0.000 (0.003) loss 2.8591 (2.6270) ce_loss 1.4922 (1.4023) loss_zs_kd 0.9886 (0.7484) loss_oracle 0.9281 (0.7107) acc 40.6250 (47.5426) kd_loss 0.9028 (0.8694) lr 2.0000e-03 eta 0:21:58
epoch [2/50] batch [240/319] time 0.087 (0.086) data 0.000 (0.003) loss 2.3439 (2.6251) ce_loss 1.0195 (1.3906) loss_zs_kd 1.0486 (0.7752) loss_oracle 0.8661 (0.7252) acc 56.2500 (47.8255) kd_loss 0.8913 (0.8718) lr 2.0000e-03 eta 0:21:57
epoch [2/50] batch [260/319] time 0.077 (0.086) data 0.000 (0.003) loss 2.4809 (2.6159) ce_loss 1.1377 (1.3726) loss_zs_kd 1.0168 (0.7948) loss_oracle 0.8320 (0.7380) acc 53.1250 (48.4135) kd_loss 0.9272 (0.8743) lr 2.0000e-03 eta 0:21:54
epoch [2/50] batch [280/319] time 0.085 (0.086) data 0.000 (0.003) loss 2.5433 (2.6171) ce_loss 1.1982 (1.3679) loss_zs_kd 0.9418 (0.8084) loss_oracle 0.9201 (0.7519) acc 46.8750 (48.5714) kd_loss 0.8850 (0.8732) lr 2.0000e-03 eta 0:21:54
epoch [2/50] batch [300/319] time 0.082 (0.086) data 0.000 (0.003) loss 2.3931 (2.6180) ce_loss 1.1445 (1.3652) loss_zs_kd 0.9513 (0.8242) loss_oracle 0.9006 (0.7627) acc 65.6250 (48.8750) kd_loss 0.7983 (0.8714) lr 2.0000e-03 eta 0:21:54
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,427
* accuracy: 55.4%
* error: 44.6%
* macro_f1: 45.7%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,314
* accuracy: 44.3%
* error: 55.7%
* macro_f1: 18.2%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      55.4%, epoch: 2 *******
******* Domain 2 best val test acc: 44.3%, epoch: 2 *******
******* Domain 2 best test acc:     44.3%, epoch: 2 *******
epoch [3/50] batch [20/319] time 0.096 (0.133) data 0.001 (0.048) loss 2.3172 (2.4699) ce_loss 1.0146 (1.1862) loss_zs_kd 0.9493 (1.0887) loss_oracle 0.8892 (0.9035) acc 53.1250 (55.3125) kd_loss 0.8579 (0.8320) lr 1.9980e-03 eta 0:34:00
epoch [3/50] batch [40/319] time 0.078 (0.108) data 0.000 (0.024) loss 2.5445 (2.4899) ce_loss 1.1846 (1.2027) loss_zs_kd 1.1192 (1.0825) loss_oracle 0.9945 (0.9083) acc 59.3750 (54.8438) kd_loss 0.8626 (0.8331) lr 1.9980e-03 eta 0:27:35
epoch [3/50] batch [60/319] time 0.074 (0.100) data 0.000 (0.016) loss 2.2394 (2.5033) ce_loss 0.9331 (1.2120) loss_zs_kd 1.0654 (1.0837) loss_oracle 0.9144 (0.9219) acc 65.6250 (54.7396) kd_loss 0.8491 (0.8303) lr 1.9980e-03 eta 0:25:19
epoch [3/50] batch [80/319] time 0.081 (0.095) data 0.000 (0.012) loss 2.3724 (2.5139) ce_loss 1.0596 (1.2245) loss_zs_kd 1.0304 (1.0850) loss_oracle 0.9500 (0.9287) acc 46.8750 (53.5156) kd_loss 0.8378 (0.8251) lr 1.9980e-03 eta 0:24:00
epoch [3/50] batch [100/319] time 0.079 (0.091) data 0.000 (0.010) loss 2.5195 (2.5142) ce_loss 1.2109 (1.2271) loss_zs_kd 1.2628 (1.0770) loss_oracle 0.9824 (0.9322) acc 46.8750 (53.8750) kd_loss 0.8173 (0.8210) lr 1.9980e-03 eta 0:23:11
epoch [3/50] batch [120/319] time 0.079 (0.090) data 0.000 (0.008) loss 2.6662 (2.5149) ce_loss 1.4141 (1.2283) loss_zs_kd 1.0117 (1.0719) loss_oracle 0.9026 (0.9375) acc 37.5000 (53.5938) kd_loss 0.8008 (0.8178) lr 1.9980e-03 eta 0:22:41
epoch [3/50] batch [140/319] time 0.079 (0.090) data 0.000 (0.007) loss 2.2739 (2.5109) ce_loss 0.9829 (1.2245) loss_zs_kd 0.9978 (1.0733) loss_oracle 0.9485 (0.9453) acc 68.7500 (53.6161) kd_loss 0.8168 (0.8138) lr 1.9980e-03 eta 0:22:45
epoch [3/50] batch [160/319] time 0.091 (0.089) data 0.000 (0.006) loss 2.3634 (2.5071) ce_loss 1.0850 (1.2228) loss_zs_kd 1.2223 (1.0884) loss_oracle 0.9652 (0.9477) acc 56.2500 (53.6133) kd_loss 0.7958 (0.8104) lr 1.9980e-03 eta 0:22:32
epoch [3/50] batch [180/319] time 0.083 (0.089) data 0.000 (0.006) loss 2.6412 (2.5107) ce_loss 1.3857 (1.2260) loss_zs_kd 1.1548 (1.1010) loss_oracle 0.9695 (0.9526) acc 43.7500 (53.5417) kd_loss 0.7707 (0.8084) lr 1.9980e-03 eta 0:22:23
epoch [3/50] batch [200/319] time 0.081 (0.088) data 0.000 (0.005) loss 2.5410 (2.5081) ce_loss 1.2773 (1.2238) loss_zs_kd 1.3291 (1.1157) loss_oracle 1.0123 (0.9605) acc 43.7500 (53.5625) kd_loss 0.7575 (0.8041) lr 1.9980e-03 eta 0:22:14
epoch [3/50] batch [220/319] time 0.077 (0.088) data 0.000 (0.005) loss 2.4518 (2.5085) ce_loss 1.1367 (1.2237) loss_zs_kd 1.2536 (1.1271) loss_oracle 1.0480 (0.9662) acc 53.1250 (53.6648) kd_loss 0.7911 (0.8017) lr 1.9980e-03 eta 0:22:06
epoch [3/50] batch [240/319] time 0.085 (0.087) data 0.000 (0.004) loss 2.7866 (2.5029) ce_loss 1.5830 (1.2219) loss_zs_kd 1.4385 (1.1433) loss_oracle 0.9918 (0.9658) acc 46.8750 (54.0234) kd_loss 0.7077 (0.7981) lr 1.9980e-03 eta 0:21:58
epoch [3/50] batch [260/319] time 0.084 (0.087) data 0.000 (0.004) loss 2.4883 (2.5019) ce_loss 1.2041 (1.2236) loss_zs_kd 1.1833 (1.1513) loss_oracle 1.0200 (0.9697) acc 56.2500 (54.0144) kd_loss 0.7742 (0.7936) lr 1.9980e-03 eta 0:21:51
epoch [3/50] batch [280/319] time 0.081 (0.087) data 0.000 (0.004) loss 2.4595 (2.4983) ce_loss 1.1758 (1.2209) loss_zs_kd 1.1657 (1.1602) loss_oracle 1.0433 (0.9747) acc 59.3750 (54.0960) kd_loss 0.7621 (0.7901) lr 1.9980e-03 eta 0:21:44
epoch [3/50] batch [300/319] time 0.081 (0.087) data 0.000 (0.003) loss 2.1417 (2.4960) ce_loss 0.8770 (1.2201) loss_zs_kd 1.1593 (1.1706) loss_oracle 1.0449 (0.9789) acc 68.7500 (54.2292) kd_loss 0.7423 (0.7865) lr 1.9980e-03 eta 0:21:42
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,622
* accuracy: 59.9%
* error: 40.1%
* macro_f1: 48.7%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,092
* accuracy: 52.3%
* error: 47.7%
* macro_f1: 21.0%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      59.9%, epoch: 3 *******
******* Domain 2 best val test acc: 52.3%, epoch: 3 *******
******* Domain 2 best test acc:     52.3%, epoch: 3 *******
epoch [4/50] batch [20/319] time 0.075 (0.149) data 0.000 (0.063) loss 2.4749 (2.4273) ce_loss 1.2471 (1.2022) loss_zs_kd 1.2067 (1.2199) loss_oracle 1.0275 (1.0093) acc 43.7500 (52.3438) kd_loss 0.7141 (0.7205) lr 1.9921e-03 eta 0:37:09
epoch [4/50] batch [40/319] time 0.077 (0.114) data 0.001 (0.031) loss 2.3994 (2.4216) ce_loss 1.1152 (1.1941) loss_zs_kd 1.1213 (1.1919) loss_oracle 1.0864 (1.0128) acc 40.6250 (52.1875) kd_loss 0.7409 (0.7211) lr 1.9921e-03 eta 0:28:22
epoch [4/50] batch [60/319] time 0.093 (0.104) data 0.001 (0.021) loss 2.7384 (2.4038) ce_loss 1.5244 (1.1763) loss_zs_kd 1.4400 (1.2190) loss_oracle 1.0073 (1.0201) acc 50.0000 (53.0729) kd_loss 0.7104 (0.7174) lr 1.9921e-03 eta 0:25:52
epoch [4/50] batch [80/319] time 0.081 (0.099) data 0.000 (0.016) loss 2.5259 (2.4115) ce_loss 1.2900 (1.1797) loss_zs_kd 1.2635 (1.2709) loss_oracle 1.0705 (1.0330) acc 56.2500 (53.5156) kd_loss 0.7006 (0.7153) lr 1.9921e-03 eta 0:24:41
epoch [4/50] batch [100/319] time 0.079 (0.096) data 0.000 (0.013) loss 2.6361 (2.4135) ce_loss 1.3418 (1.1816) loss_zs_kd 1.2810 (1.2942) loss_oracle 1.1508 (1.0393) acc 59.3750 (53.9688) kd_loss 0.7189 (0.7123) lr 1.9921e-03 eta 0:23:46
epoch [4/50] batch [120/319] time 0.082 (0.094) data 0.000 (0.011) loss 2.4197 (2.4102) ce_loss 1.1914 (1.1775) loss_zs_kd 1.3349 (1.3053) loss_oracle 1.0637 (1.0455) acc 56.2500 (54.1146) kd_loss 0.6964 (0.7099) lr 1.9921e-03 eta 0:23:14
epoch [4/50] batch [140/319] time 0.088 (0.093) data 0.000 (0.009) loss 2.5957 (2.4131) ce_loss 1.3701 (1.1808) loss_zs_kd 1.5916 (1.3187) loss_oracle 1.0965 (1.0509) acc 56.2500 (54.3527) kd_loss 0.6774 (0.7069) lr 1.9921e-03 eta 0:22:54
epoch [4/50] batch [160/319] time 0.076 (0.091) data 0.000 (0.008) loss 2.8269 (2.4130) ce_loss 1.5527 (1.1814) loss_zs_kd 1.4946 (1.3232) loss_oracle 1.1661 (1.0547) acc 40.6250 (54.3945) kd_loss 0.6911 (0.7042) lr 1.9921e-03 eta 0:22:35
epoch [4/50] batch [180/319] time 0.070 (0.090) data 0.000 (0.007) loss 2.4164 (2.4121) ce_loss 1.1934 (1.1806) loss_zs_kd 1.1949 (1.3315) loss_oracle 1.0713 (1.0577) acc 59.3750 (54.3576) kd_loss 0.6874 (0.7026) lr 1.9921e-03 eta 0:22:18
epoch [4/50] batch [200/319] time 0.081 (0.089) data 0.000 (0.007) loss 2.3849 (2.4097) ce_loss 1.1680 (1.1789) loss_zs_kd 1.1902 (1.3333) loss_oracle 1.0588 (1.0625) acc 46.8750 (54.6250) kd_loss 0.6875 (0.6996) lr 1.9921e-03 eta 0:22:01
epoch [4/50] batch [220/319] time 0.084 (0.089) data 0.000 (0.006) loss 2.4121 (2.4016) ce_loss 1.2139 (1.1733) loss_zs_kd 1.4359 (1.3365) loss_oracle 1.1044 (1.0648) acc 46.8750 (55.1562) kd_loss 0.6460 (0.6959) lr 1.9921e-03 eta 0:21:53
epoch [4/50] batch [240/319] time 0.080 (0.088) data 0.000 (0.005) loss 2.4221 (2.4033) ce_loss 1.2197 (1.1752) loss_zs_kd 1.3082 (1.3374) loss_oracle 1.1290 (1.0691) acc 71.8750 (55.0911) kd_loss 0.6379 (0.6935) lr 1.9921e-03 eta 0:21:45
epoch [4/50] batch [260/319] time 0.085 (0.088) data 0.000 (0.005) loss 2.4765 (2.4034) ce_loss 1.2529 (1.1752) loss_zs_kd 1.6708 (1.3496) loss_oracle 1.1312 (1.0738) acc 46.8750 (55.1923) kd_loss 0.6580 (0.6913) lr 1.9921e-03 eta 0:21:37
epoch [4/50] batch [280/319] time 0.089 (0.088) data 0.000 (0.005) loss 2.2965 (2.3993) ce_loss 1.1084 (1.1716) loss_zs_kd 1.4304 (1.3591) loss_oracle 1.0367 (1.0773) acc 68.7500 (55.5134) kd_loss 0.6698 (0.6891) lr 1.9921e-03 eta 0:21:34
epoch [4/50] batch [300/319] time 0.083 (0.088) data 0.000 (0.004) loss 2.1102 (2.3948) ce_loss 0.9277 (1.1685) loss_zs_kd 1.6728 (1.3644) loss_oracle 1.0601 (1.0786) acc 59.3750 (55.5729) kd_loss 0.6524 (0.6870) lr 1.9921e-03 eta 0:21:28
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,698
* accuracy: 61.6%
* error: 38.4%
* macro_f1: 53.2%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,145
* accuracy: 52.8%
* error: 47.2%
* macro_f1: 21.4%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      61.6%, epoch: 4 *******
******* Domain 2 best val test acc: 52.8%, epoch: 4 *******
******* Domain 2 best test acc:     52.8%, epoch: 4 *******
epoch [5/50] batch [20/319] time 0.086 (0.146) data 0.000 (0.058) loss 2.3168 (2.3513) ce_loss 1.1006 (1.1477) loss_zs_kd 1.3596 (1.4042) loss_oracle 1.0893 (1.1088) acc 59.3750 (54.6875) kd_loss 0.6716 (0.6492) lr 1.9823e-03 eta 0:35:36
epoch [5/50] batch [40/319] time 0.088 (0.115) data 0.000 (0.029) loss 2.2043 (2.3635) ce_loss 0.9888 (1.1499) loss_zs_kd 1.4909 (1.4449) loss_oracle 1.2117 (1.1246) acc 62.5000 (55.3125) kd_loss 0.6097 (0.6513) lr 1.9823e-03 eta 0:28:06
epoch [5/50] batch [60/319] time 0.085 (0.105) data 0.000 (0.020) loss 2.2694 (2.3745) ce_loss 1.0449 (1.1585) loss_zs_kd 1.6471 (1.4544) loss_oracle 1.1670 (1.1320) acc 68.7500 (55.9896) kd_loss 0.6409 (0.6500) lr 1.9823e-03 eta 0:25:39
epoch [5/50] batch [80/319] time 0.083 (0.099) data 0.000 (0.015) loss 2.1349 (2.3530) ce_loss 0.9595 (1.1431) loss_zs_kd 1.2821 (1.4276) loss_oracle 1.0516 (1.1254) acc 62.5000 (56.4844) kd_loss 0.6496 (0.6473) lr 1.9823e-03 eta 0:24:10
epoch [5/50] batch [100/319] time 0.093 (0.096) data 0.000 (0.012) loss 2.4921 (2.3463) ce_loss 1.2715 (1.1382) loss_zs_kd 1.2572 (1.4156) loss_oracle 1.1076 (1.1240) acc 46.8750 (56.4688) kd_loss 0.6668 (0.6460) lr 1.9823e-03 eta 0:23:21
epoch [5/50] batch [120/319] time 0.087 (0.094) data 0.000 (0.010) loss 2.3563 (2.3468) ce_loss 1.1426 (1.1411) loss_zs_kd 1.3813 (1.4129) loss_oracle 1.1516 (1.1202) acc 59.3750 (56.5625) kd_loss 0.6379 (0.6456) lr 1.9823e-03 eta 0:22:43
epoch [5/50] batch [140/319] time 0.085 (0.093) data 0.000 (0.009) loss 2.6918 (2.3428) ce_loss 1.4756 (1.1373) loss_zs_kd 1.2384 (1.4275) loss_oracle 1.1431 (1.1211) acc 34.3750 (56.6518) kd_loss 0.6447 (0.6450) lr 1.9823e-03 eta 0:22:25
epoch [5/50] batch [160/319] time 0.097 (0.092) data 0.001 (0.007) loss 2.3957 (2.3365) ce_loss 1.1660 (1.1328) loss_zs_kd 1.4997 (1.4267) loss_oracle 1.1394 (1.1180) acc 56.2500 (56.9336) kd_loss 0.6600 (0.6448) lr 1.9823e-03 eta 0:22:15
epoch [5/50] batch [180/319] time 0.083 (0.091) data 0.000 (0.007) loss 2.1601 (2.3300) ce_loss 0.8994 (1.1281) loss_zs_kd 1.4993 (1.4256) loss_oracle 1.2084 (1.1156) acc 59.3750 (57.0139) kd_loss 0.6565 (0.6441) lr 1.9823e-03 eta 0:21:59
epoch [5/50] batch [200/319] time 0.094 (0.090) data 0.000 (0.006) loss 2.1775 (2.3285) ce_loss 1.0166 (1.1287) loss_zs_kd 1.7471 (1.4191) loss_oracle 1.1162 (1.1153) acc 68.7500 (57.1406) kd_loss 0.6028 (0.6422) lr 1.9823e-03 eta 0:21:47
epoch [5/50] batch [220/319] time 0.086 (0.090) data 0.000 (0.006) loss 2.0738 (2.3294) ce_loss 0.9248 (1.1301) loss_zs_kd 1.1401 (1.4167) loss_oracle 1.0442 (1.1145) acc 56.2500 (57.1875) kd_loss 0.6269 (0.6420) lr 1.9823e-03 eta 0:21:33
epoch [5/50] batch [240/319] time 0.088 (0.089) data 0.000 (0.005) loss 2.2131 (2.3341) ce_loss 1.0225 (1.1348) loss_zs_kd 1.1715 (1.4106) loss_oracle 1.1330 (1.1143) acc 59.3750 (56.9792) kd_loss 0.6242 (0.6421) lr 1.9823e-03 eta 0:21:19
epoch [5/50] batch [260/319] time 0.073 (0.088) data 0.000 (0.005) loss 2.4532 (2.3352) ce_loss 1.2510 (1.1356) loss_zs_kd 1.4242 (1.4107) loss_oracle 1.1757 (1.1160) acc 46.8750 (56.9351) kd_loss 0.6143 (0.6416) lr 1.9823e-03 eta 0:21:08
epoch [5/50] batch [280/319] time 0.093 (0.088) data 0.000 (0.004) loss 1.8833 (2.3336) ce_loss 0.6743 (1.1344) loss_zs_kd 1.0833 (1.4062) loss_oracle 1.1359 (1.1170) acc 81.2500 (56.9866) kd_loss 0.6411 (0.6407) lr 1.9823e-03 eta 0:21:01
epoch [5/50] batch [300/319] time 0.079 (0.087) data 0.000 (0.004) loss 2.3947 (2.3335) ce_loss 1.2236 (1.1355) loss_zs_kd 1.4998 (1.4121) loss_oracle 1.1634 (1.1166) acc 53.1250 (57.0104) kd_loss 0.5894 (0.6397) lr 1.9823e-03 eta 0:20:56
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,812
* accuracy: 64.2%
* error: 35.8%
* macro_f1: 54.4%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 4,816
* accuracy: 49.5%
* error: 50.5%
* macro_f1: 22.3%
******* Domain 2 best val acc:      64.2%, epoch: 5 *******
******* Domain 2 best val test acc: 49.5%, epoch: 5 *******
******* Domain 2 best test acc:     52.8%, epoch: 4 *******
epoch [6/50] batch [20/319] time 0.082 (0.148) data 0.000 (0.059) loss 2.5131 (2.2763) ce_loss 1.3125 (1.0917) loss_zs_kd 1.5114 (1.4735) loss_oracle 1.1793 (1.1363) acc 46.8750 (62.1875) kd_loss 0.6109 (0.6165) lr 1.9686e-03 eta 0:35:21
epoch [6/50] batch [40/319] time 0.078 (0.115) data 0.000 (0.029) loss 2.3024 (2.2580) ce_loss 1.1094 (1.0674) loss_zs_kd 1.3830 (1.4645) loss_oracle 1.1614 (1.1439) acc 62.5000 (61.2500) kd_loss 0.6123 (0.6186) lr 1.9686e-03 eta 0:27:29
epoch [6/50] batch [60/319] time 0.084 (0.104) data 0.001 (0.020) loss 2.3990 (2.2917) ce_loss 1.2197 (1.1017) loss_zs_kd 1.6082 (1.4672) loss_oracle 1.1132 (1.1424) acc 46.8750 (58.6979) kd_loss 0.6226 (0.6188) lr 1.9686e-03 eta 0:24:53
epoch [6/50] batch [80/319] time 0.078 (0.098) data 0.000 (0.015) loss 2.3982 (2.2982) ce_loss 1.2012 (1.1081) loss_zs_kd 1.5258 (1.4700) loss_oracle 1.1627 (1.1371) acc 65.6250 (58.4766) kd_loss 0.6157 (0.6215) lr 1.9686e-03 eta 0:23:20
epoch [6/50] batch [100/319] time 0.093 (0.096) data 0.000 (0.012) loss 2.2109 (2.3097) ce_loss 1.0820 (1.1203) loss_zs_kd 1.5499 (1.4584) loss_oracle 1.1256 (1.1354) acc 59.3750 (57.8750) kd_loss 0.5661 (0.6217) lr 1.9686e-03 eta 0:22:43
epoch [6/50] batch [120/319] time 0.092 (0.094) data 0.000 (0.010) loss 2.3574 (2.3090) ce_loss 1.1709 (1.1185) loss_zs_kd 1.5266 (1.4635) loss_oracle 1.1379 (1.1364) acc 56.2500 (58.2292) kd_loss 0.6175 (0.6223) lr 1.9686e-03 eta 0:22:17
epoch [6/50] batch [140/319] time 0.091 (0.092) data 0.000 (0.009) loss 2.4979 (2.3050) ce_loss 1.3232 (1.1157) loss_zs_kd 1.3493 (1.4596) loss_oracle 1.1617 (1.1339) acc 53.1250 (58.5491) kd_loss 0.5938 (0.6223) lr 1.9686e-03 eta 0:21:43
epoch [6/50] batch [160/319] time 0.092 (0.090) data 0.000 (0.008) loss 2.2394 (2.3088) ce_loss 1.0068 (1.1171) loss_zs_kd 1.1811 (1.4566) loss_oracle 1.2164 (1.1373) acc 56.2500 (58.5156) kd_loss 0.6243 (0.6230) lr 1.9686e-03 eta 0:21:23
epoch [6/50] batch [180/319] time 0.084 (0.090) data 0.000 (0.007) loss 2.4232 (2.3197) ce_loss 1.2705 (1.1260) loss_zs_kd 1.4693 (1.4487) loss_oracle 1.1428 (1.1407) acc 59.3750 (58.1250) kd_loss 0.5813 (0.6234) lr 1.9686e-03 eta 0:21:14
epoch [6/50] batch [200/319] time 0.082 (0.089) data 0.000 (0.006) loss 2.2959 (2.3192) ce_loss 1.1074 (1.1229) loss_zs_kd 1.3480 (1.4372) loss_oracle 1.1396 (1.1426) acc 59.3750 (58.2500) kd_loss 0.6186 (0.6249) lr 1.9686e-03 eta 0:21:06
epoch [6/50] batch [220/319] time 0.084 (0.089) data 0.000 (0.006) loss 2.3111 (2.3191) ce_loss 1.0703 (1.1213) loss_zs_kd 1.4883 (1.4448) loss_oracle 1.1937 (1.1430) acc 59.3750 (58.1676) kd_loss 0.6440 (0.6263) lr 1.9686e-03 eta 0:21:00
epoch [6/50] batch [240/319] time 0.088 (0.089) data 0.000 (0.005) loss 2.5123 (2.3220) ce_loss 1.3047 (1.1233) loss_zs_kd 1.5086 (1.4431) loss_oracle 1.1634 (1.1442) acc 40.6250 (58.0469) kd_loss 0.6259 (0.6266) lr 1.9686e-03 eta 0:20:54
epoch [6/50] batch [260/319] time 0.085 (0.088) data 0.000 (0.005) loss 2.1160 (2.3193) ce_loss 0.8979 (1.1219) loss_zs_kd 1.7070 (1.4478) loss_oracle 1.1562 (1.1426) acc 62.5000 (58.1370) kd_loss 0.6400 (0.6261) lr 1.9686e-03 eta 0:20:45
epoch [6/50] batch [280/319] time 0.081 (0.088) data 0.000 (0.004) loss 2.2849 (2.3207) ce_loss 1.1113 (1.1228) loss_zs_kd 1.3390 (1.4530) loss_oracle 1.1885 (1.1429) acc 59.3750 (58.1138) kd_loss 0.5794 (0.6265) lr 1.9686e-03 eta 0:20:33
epoch [6/50] batch [300/319] time 0.087 (0.087) data 0.000 (0.004) loss 2.3167 (2.3247) ce_loss 1.1094 (1.1263) loss_zs_kd 1.5102 (1.4515) loss_oracle 1.0682 (1.1421) acc 68.7500 (58.0625) kd_loss 0.6733 (0.6274) lr 1.9686e-03 eta 0:20:28
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,785
* accuracy: 63.6%
* error: 36.4%
* macro_f1: 56.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,329
* accuracy: 54.7%
* error: 45.3%
* macro_f1: 25.0%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      64.2%, epoch: 5 *******
******* Domain 2 best val test acc: 49.5%, epoch: 5 *******
******* Domain 2 best test acc:     54.7%, epoch: 6 *******
epoch [7/50] batch [20/319] time 0.079 (0.156) data 0.000 (0.071) loss 1.9045 (2.3027) ce_loss 0.6895 (1.0896) loss_zs_kd 1.5323 (1.4258) loss_oracle 1.0549 (1.1080) acc 75.0000 (59.8438) kd_loss 0.6876 (0.6591) lr 1.9511e-03 eta 0:36:24
epoch [7/50] batch [40/319] time 0.083 (0.117) data 0.000 (0.036) loss 2.6803 (2.3495) ce_loss 1.3965 (1.1277) loss_zs_kd 1.5927 (1.4284) loss_oracle 1.0833 (1.1008) acc 50.0000 (57.9688) kd_loss 0.7421 (0.6714) lr 1.9511e-03 eta 0:27:24
epoch [7/50] batch [60/319] time 0.086 (0.109) data 0.001 (0.024) loss 2.4045 (2.3520) ce_loss 1.0459 (1.1219) loss_zs_kd 1.6660 (1.4459) loss_oracle 1.0742 (1.1041) acc 62.5000 (57.9688) kd_loss 0.8215 (0.6780) lr 1.9511e-03 eta 0:25:29
epoch [7/50] batch [80/319] time 0.082 (0.104) data 0.000 (0.018) loss 2.2459 (2.3626) ce_loss 1.0342 (1.1310) loss_zs_kd 1.4111 (1.4433) loss_oracle 1.0537 (1.0995) acc 62.5000 (57.5781) kd_loss 0.6849 (0.6819) lr 1.9511e-03 eta 0:24:10
epoch [7/50] batch [100/319] time 0.081 (0.100) data 0.000 (0.014) loss 2.4286 (2.3689) ce_loss 1.1475 (1.1385) loss_zs_kd 1.4188 (1.4495) loss_oracle 1.1662 (1.0985) acc 59.3750 (57.6562) kd_loss 0.6980 (0.6812) lr 1.9511e-03 eta 0:23:16
epoch [7/50] batch [120/319] time 0.084 (0.097) data 0.000 (0.012) loss 2.5187 (2.3600) ce_loss 1.3408 (1.1316) loss_zs_kd 1.5833 (1.4640) loss_oracle 1.1297 (1.0958) acc 56.2500 (57.6042) kd_loss 0.6130 (0.6805) lr 1.9511e-03 eta 0:22:33
epoch [7/50] batch [140/319] time 0.078 (0.095) data 0.000 (0.010) loss 2.1598 (2.3539) ce_loss 0.9595 (1.1258) loss_zs_kd 1.6436 (1.4665) loss_oracle 1.1113 (1.0946) acc 62.5000 (58.1250) kd_loss 0.6446 (0.6808) lr 1.9511e-03 eta 0:22:05
epoch [7/50] batch [160/319] time 0.082 (0.094) data 0.000 (0.009) loss 2.2566 (2.3589) ce_loss 1.0156 (1.1272) loss_zs_kd 1.2751 (1.4689) loss_oracle 1.0942 (1.0958) acc 65.6250 (57.7930) kd_loss 0.6938 (0.6838) lr 1.9511e-03 eta 0:21:43
epoch [7/50] batch [180/319] time 0.084 (0.093) data 0.000 (0.008) loss 2.4302 (2.3691) ce_loss 1.1992 (1.1315) loss_zs_kd 1.4256 (1.4779) loss_oracle 1.1389 (1.0982) acc 62.5000 (57.5868) kd_loss 0.6616 (0.6885) lr 1.9511e-03 eta 0:21:31
epoch [7/50] batch [200/319] time 0.084 (0.093) data 0.000 (0.007) loss 2.6114 (2.3631) ce_loss 1.4326 (1.1249) loss_zs_kd 1.7786 (1.4866) loss_oracle 1.0656 (1.0986) acc 53.1250 (57.7812) kd_loss 0.6459 (0.6889) lr 1.9511e-03 eta 0:21:19
epoch [7/50] batch [220/319] time 0.086 (0.092) data 0.000 (0.007) loss 2.3537 (2.3565) ce_loss 1.0840 (1.1144) loss_zs_kd 1.6851 (1.4884) loss_oracle 1.1243 (1.0998) acc 50.0000 (58.2812) kd_loss 0.7076 (0.6922) lr 1.9511e-03 eta 0:21:07
epoch [7/50] batch [240/319] time 0.081 (0.091) data 0.000 (0.006) loss 2.4481 (2.3566) ce_loss 1.1846 (1.1125) loss_zs_kd 1.5477 (1.4937) loss_oracle 1.0508 (1.0989) acc 53.1250 (58.3854) kd_loss 0.7382 (0.6947) lr 1.9511e-03 eta 0:20:57
epoch [7/50] batch [260/319] time 0.084 (0.091) data 0.000 (0.006) loss 2.1857 (2.3588) ce_loss 0.9800 (1.1126) loss_zs_kd 1.3883 (1.4960) loss_oracle 1.0529 (1.0992) acc 59.3750 (58.3654) kd_loss 0.6793 (0.6966) lr 1.9511e-03 eta 0:20:49
epoch [7/50] batch [280/319] time 0.087 (0.090) data 0.000 (0.005) loss 2.3381 (2.3626) ce_loss 0.9961 (1.1137) loss_zs_kd 1.6932 (1.4942) loss_oracle 1.1376 (1.0992) acc 62.5000 (58.3817) kd_loss 0.7732 (0.6993) lr 1.9511e-03 eta 0:20:40
epoch [7/50] batch [300/319] time 0.083 (0.090) data 0.000 (0.005) loss 2.3929 (2.3621) ce_loss 1.0879 (1.1110) loss_zs_kd 1.6443 (1.4942) loss_oracle 1.1177 (1.0993) acc 59.3750 (58.5104) kd_loss 0.7462 (0.7015) lr 1.9511e-03 eta 0:20:33
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,898
* accuracy: 66.2%
* error: 33.8%
* macro_f1: 58.3%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,269
* accuracy: 54.1%
* error: 45.9%
* macro_f1: 23.8%
******* Domain 2 best val acc:      66.2%, epoch: 7 *******
******* Domain 2 best val test acc: 54.1%, epoch: 7 *******
******* Domain 2 best test acc:     54.7%, epoch: 6 *******
epoch [8/50] batch [20/319] time 0.080 (0.154) data 0.000 (0.066) loss 2.6597 (2.4475) ce_loss 1.3672 (1.1424) loss_zs_kd 1.4746 (1.4294) loss_oracle 1.1494 (1.1102) acc 50.0000 (57.6562) kd_loss 0.7178 (0.7500) lr 1.9298e-03 eta 0:35:10
epoch [8/50] batch [40/319] time 0.074 (0.117) data 0.000 (0.033) loss 2.3393 (2.4183) ce_loss 0.9976 (1.1176) loss_zs_kd 1.5997 (1.5203) loss_oracle 1.0549 (1.0966) acc 56.2500 (56.7969) kd_loss 0.8143 (0.7524) lr 1.9298e-03 eta 0:26:40
epoch [8/50] batch [60/319] time 0.081 (0.104) data 0.000 (0.022) loss 2.3978 (2.4010) ce_loss 1.1289 (1.1077) loss_zs_kd 1.5916 (1.5401) loss_oracle 1.0045 (1.0839) acc 65.6250 (57.6562) kd_loss 0.7666 (0.7513) lr 1.9298e-03 eta 0:23:44
epoch [8/50] batch [80/319] time 0.086 (0.098) data 0.000 (0.017) loss 2.2571 (2.3779) ce_loss 0.9878 (1.0885) loss_zs_kd 1.2685 (1.5347) loss_oracle 1.0561 (1.0789) acc 65.6250 (58.3984) kd_loss 0.7412 (0.7499) lr 1.9298e-03 eta 0:22:20
epoch [8/50] batch [100/319] time 0.078 (0.095) data 0.000 (0.013) loss 2.2021 (2.3759) ce_loss 0.9326 (1.0923) loss_zs_kd 1.7685 (1.5504) loss_oracle 1.1069 (1.0784) acc 65.6250 (58.1250) kd_loss 0.7160 (0.7445) lr 1.9298e-03 eta 0:21:39
epoch [8/50] batch [120/319] time 0.080 (0.093) data 0.000 (0.011) loss 2.5613 (2.3646) ce_loss 1.2764 (1.0853) loss_zs_kd 1.7796 (1.5543) loss_oracle 1.0483 (1.0723) acc 62.5000 (58.9583) kd_loss 0.7608 (0.7431) lr 1.9298e-03 eta 0:20:57
epoch [8/50] batch [140/319] time 0.085 (0.091) data 0.000 (0.010) loss 2.2649 (2.3680) ce_loss 1.0439 (1.0928) loss_zs_kd 1.7298 (1.5378) loss_oracle 0.9772 (1.0680) acc 65.6250 (58.4821) kd_loss 0.7324 (0.7411) lr 1.9298e-03 eta 0:20:33
epoch [8/50] batch [160/319] time 0.075 (0.090) data 0.000 (0.008) loss 2.5014 (2.3704) ce_loss 1.1982 (1.0948) loss_zs_kd 1.2739 (1.5260) loss_oracle 1.1193 (1.0599) acc 62.5000 (58.6719) kd_loss 0.7435 (0.7456) lr 1.9298e-03 eta 0:20:15
epoch [8/50] batch [180/319] time 0.080 (0.088) data 0.000 (0.008) loss 2.6435 (2.3769) ce_loss 1.2949 (1.0990) loss_zs_kd 1.4719 (1.5288) loss_oracle 1.0764 (1.0557) acc 50.0000 (58.6632) kd_loss 0.8103 (0.7500) lr 1.9298e-03 eta 0:19:55
epoch [8/50] batch [200/319] time 0.080 (0.088) data 0.000 (0.007) loss 2.2734 (2.3771) ce_loss 0.9736 (1.0946) loss_zs_kd 1.7797 (1.5268) loss_oracle 1.0390 (1.0508) acc 71.8750 (58.7344) kd_loss 0.7803 (0.7571) lr 1.9298e-03 eta 0:19:48
epoch [8/50] batch [220/319] time 0.079 (0.088) data 0.000 (0.006) loss 2.1248 (2.3786) ce_loss 0.7563 (1.0942) loss_zs_kd 1.6729 (1.5249) loss_oracle 1.0328 (1.0491) acc 75.0000 (58.7074) kd_loss 0.8521 (0.7599) lr 1.9298e-03 eta 0:19:43
epoch [8/50] batch [240/319] time 0.085 (0.087) data 0.000 (0.006) loss 2.6240 (2.3798) ce_loss 1.2842 (1.0918) loss_zs_kd 1.4955 (1.5243) loss_oracle 1.0156 (1.0456) acc 53.1250 (58.9453) kd_loss 0.8320 (0.7652) lr 1.9298e-03 eta 0:19:38
epoch [8/50] batch [260/319] time 0.085 (0.087) data 0.000 (0.005) loss 2.7441 (2.3828) ce_loss 1.2891 (1.0924) loss_zs_kd 1.6831 (1.5238) loss_oracle 1.0329 (1.0406) acc 56.2500 (58.8942) kd_loss 0.9386 (0.7701) lr 1.9298e-03 eta 0:19:34
epoch [8/50] batch [280/319] time 0.087 (0.087) data 0.000 (0.005) loss 2.6045 (2.3808) ce_loss 1.2246 (1.0879) loss_zs_kd 1.4014 (1.5233) loss_oracle 1.0019 (1.0373) acc 43.7500 (59.0625) kd_loss 0.8790 (0.7743) lr 1.9298e-03 eta 0:19:29
epoch [8/50] batch [300/319] time 0.075 (0.087) data 0.000 (0.005) loss 2.5996 (2.3866) ce_loss 1.3242 (1.0924) loss_zs_kd 1.2865 (1.5273) loss_oracle 0.9645 (1.0338) acc 43.7500 (58.8750) kd_loss 0.7931 (0.7773) lr 1.9298e-03 eta 0:19:24
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,790
* accuracy: 63.7%
* error: 36.3%
* macro_f1: 53.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,574
* accuracy: 57.3%
* error: 42.7%
* macro_f1: 25.6%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      66.2%, epoch: 7 *******
******* Domain 2 best val test acc: 54.1%, epoch: 7 *******
******* Domain 2 best test acc:     57.3%, epoch: 8 *******
epoch [9/50] batch [20/319] time 0.086 (0.149) data 0.000 (0.061) loss 2.3102 (2.3633) ce_loss 0.9746 (1.0114) loss_zs_kd 1.4871 (1.5222) loss_oracle 0.9973 (0.9683) acc 65.6250 (61.4062) kd_loss 0.8369 (0.8678) lr 1.9048e-03 eta 0:33:15
epoch [9/50] batch [40/319] time 0.076 (0.117) data 0.000 (0.031) loss 2.1878 (2.3654) ce_loss 0.9214 (1.0188) loss_zs_kd 1.7098 (1.5453) loss_oracle 0.9018 (0.9608) acc 68.7500 (61.0156) kd_loss 0.8155 (0.8662) lr 1.9048e-03 eta 0:26:04
epoch [9/50] batch [60/319] time 0.087 (0.106) data 0.000 (0.021) loss 2.4718 (2.3855) ce_loss 1.2227 (1.0552) loss_zs_kd 1.4951 (1.5261) loss_oracle 0.9563 (0.9518) acc 50.0000 (59.7917) kd_loss 0.7710 (0.8544) lr 1.9048e-03 eta 0:23:28
epoch [9/50] batch [80/319] time 0.078 (0.101) data 0.000 (0.016) loss 2.4828 (2.4016) ce_loss 1.1045 (1.0703) loss_zs_kd 1.6009 (1.5257) loss_oracle 1.0428 (0.9556) acc 62.5000 (59.8438) kd_loss 0.8569 (0.8535) lr 1.9048e-03 eta 0:22:19
epoch [9/50] batch [100/319] time 0.076 (0.096) data 0.000 (0.012) loss 2.6016 (2.3997) ce_loss 1.2822 (1.0717) loss_zs_kd 1.2784 (1.5196) loss_oracle 0.8951 (0.9586) acc 53.1250 (60.0000) kd_loss 0.8719 (0.8488) lr 1.9048e-03 eta 0:21:15
epoch [9/50] batch [120/319] time 0.082 (0.094) data 0.000 (0.010) loss 2.4711 (2.4172) ce_loss 1.0977 (1.0883) loss_zs_kd 1.2790 (1.5113) loss_oracle 0.9996 (0.9616) acc 68.7500 (59.7396) kd_loss 0.8736 (0.8481) lr 1.9048e-03 eta 0:20:48
epoch [9/50] batch [140/319] time 0.081 (0.092) data 0.000 (0.009) loss 2.7172 (2.4190) ce_loss 1.4355 (1.0943) loss_zs_kd 1.4598 (1.5133) loss_oracle 0.9241 (0.9601) acc 37.5000 (59.3527) kd_loss 0.8196 (0.8447) lr 1.9048e-03 eta 0:20:16
epoch [9/50] batch [160/319] time 0.086 (0.091) data 0.000 (0.008) loss 2.3367 (2.4136) ce_loss 1.0635 (1.0875) loss_zs_kd 1.5279 (1.5300) loss_oracle 0.9174 (0.9572) acc 71.8750 (59.7461) kd_loss 0.8146 (0.8476) lr 1.9048e-03 eta 0:20:05
epoch [9/50] batch [180/319] time 0.080 (0.090) data 0.000 (0.007) loss 2.3235 (2.4089) ce_loss 0.9785 (1.0840) loss_zs_kd 1.5441 (1.5305) loss_oracle 0.9495 (0.9569) acc 65.6250 (59.6875) kd_loss 0.8702 (0.8465) lr 1.9048e-03 eta 0:19:48
epoch [9/50] batch [200/319] time 0.085 (0.089) data 0.000 (0.006) loss 2.4231 (2.4078) ce_loss 1.1465 (1.0860) loss_zs_kd 1.3588 (1.5279) loss_oracle 0.8855 (0.9550) acc 46.8750 (59.4688) kd_loss 0.8339 (0.8443) lr 1.9048e-03 eta 0:19:37
epoch [9/50] batch [220/319] time 0.079 (0.089) data 0.000 (0.006) loss 2.3186 (2.4008) ce_loss 1.0361 (1.0842) loss_zs_kd 1.1900 (1.5174) loss_oracle 0.9948 (0.9534) acc 56.2500 (59.3324) kd_loss 0.7851 (0.8399) lr 1.9048e-03 eta 0:19:27
epoch [9/50] batch [240/319] time 0.089 (0.088) data 0.000 (0.005) loss 2.4187 (2.3972) ce_loss 1.1523 (1.0870) loss_zs_kd 1.6839 (1.5115) loss_oracle 0.8813 (0.9507) acc 62.5000 (59.3099) kd_loss 0.8257 (0.8348) lr 1.9048e-03 eta 0:19:16
epoch [9/50] batch [260/319] time 0.082 (0.087) data 0.000 (0.005) loss 2.3321 (2.3893) ce_loss 1.1182 (1.0835) loss_zs_kd 1.5038 (1.5114) loss_oracle 0.8237 (0.9468) acc 56.2500 (59.4231) kd_loss 0.8021 (0.8324) lr 1.9048e-03 eta 0:19:07
epoch [9/50] batch [280/319] time 0.080 (0.087) data 0.000 (0.005) loss 2.2033 (2.3937) ce_loss 0.9189 (1.0890) loss_zs_kd 1.8075 (1.5125) loss_oracle 0.8739 (0.9433) acc 65.6250 (59.2522) kd_loss 0.8474 (0.8331) lr 1.9048e-03 eta 0:18:58
epoch [9/50] batch [300/319] time 0.080 (0.087) data 0.000 (0.004) loss 2.5917 (2.3911) ce_loss 1.2510 (1.0876) loss_zs_kd 1.6805 (1.5144) loss_oracle 0.9400 (0.9416) acc 53.1250 (59.2708) kd_loss 0.8707 (0.8327) lr 1.9048e-03 eta 0:18:54
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,834
* accuracy: 64.7%
* error: 35.3%
* macro_f1: 55.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,551
* accuracy: 57.0%
* error: 43.0%
* macro_f1: 24.4%
******* Domain 2 best val acc:      66.2%, epoch: 7 *******
******* Domain 2 best val test acc: 54.1%, epoch: 7 *******
******* Domain 2 best test acc:     57.3%, epoch: 8 *******
epoch [10/50] batch [20/319] time 0.095 (0.150) data 0.000 (0.058) loss 2.6625 (2.4343) ce_loss 1.3574 (1.1272) loss_zs_kd 1.6236 (1.5556) loss_oracle 0.8537 (0.9166) acc 46.8750 (56.7188) kd_loss 0.8783 (0.8488) lr 1.8763e-03 eta 0:32:39
epoch [10/50] batch [40/319] time 0.085 (0.118) data 0.000 (0.029) loss 2.4732 (2.4208) ce_loss 1.1973 (1.1136) loss_zs_kd 1.5069 (1.5548) loss_oracle 0.9383 (0.9254) acc 59.3750 (56.9531) kd_loss 0.8068 (0.8445) lr 1.8763e-03 eta 0:25:40
epoch [10/50] batch [60/319] time 0.084 (0.108) data 0.001 (0.020) loss 2.6243 (2.4101) ce_loss 1.3027 (1.1045) loss_zs_kd 1.6091 (1.5573) loss_oracle 0.9212 (0.9283) acc 56.2500 (57.1875) kd_loss 0.8610 (0.8414) lr 1.8763e-03 eta 0:23:20
epoch [10/50] batch [80/319] time 0.092 (0.101) data 0.000 (0.015) loss 2.1760 (2.4109) ce_loss 0.9106 (1.1121) loss_zs_kd 1.3883 (1.5369) loss_oracle 0.9331 (0.9182) acc 71.8750 (57.5391) kd_loss 0.7988 (0.8397) lr 1.8763e-03 eta 0:21:59
epoch [10/50] batch [100/319] time 0.086 (0.098) data 0.000 (0.012) loss 2.1282 (2.4101) ce_loss 0.8887 (1.1173) loss_zs_kd 1.3464 (1.5381) loss_oracle 0.8887 (0.9162) acc 68.7500 (57.5938) kd_loss 0.7952 (0.8347) lr 1.8763e-03 eta 0:21:10
epoch [10/50] batch [120/319] time 0.086 (0.096) data 0.000 (0.010) loss 2.3731 (2.4004) ce_loss 1.1162 (1.1078) loss_zs_kd 1.5367 (1.5480) loss_oracle 0.8735 (0.9154) acc 59.3750 (58.2292) kd_loss 0.8201 (0.8349) lr 1.8763e-03 eta 0:20:47
epoch [10/50] batch [140/319] time 0.079 (0.094) data 0.000 (0.009) loss 2.2199 (2.3863) ce_loss 0.9170 (1.0940) loss_zs_kd 1.6188 (1.5543) loss_oracle 0.8708 (0.9121) acc 65.6250 (58.8170) kd_loss 0.8675 (0.8363) lr 1.8763e-03 eta 0:20:18
epoch [10/50] batch [160/319] time 0.084 (0.093) data 0.000 (0.008) loss 2.3407 (2.3794) ce_loss 1.1260 (1.0903) loss_zs_kd 1.5456 (1.5527) loss_oracle 0.8609 (0.9062) acc 53.1250 (58.9844) kd_loss 0.7843 (0.8360) lr 1.8763e-03 eta 0:20:03
epoch [10/50] batch [180/319] time 0.075 (0.092) data 0.000 (0.007) loss 2.4073 (2.3914) ce_loss 1.1074 (1.0982) loss_zs_kd 1.4680 (1.5589) loss_oracle 0.8418 (0.9058) acc 65.6250 (58.6979) kd_loss 0.8790 (0.8403) lr 1.8763e-03 eta 0:19:41
epoch [10/50] batch [200/319] time 0.086 (0.091) data 0.000 (0.006) loss 2.3240 (2.3925) ce_loss 0.7666 (1.0950) loss_zs_kd 1.4999 (1.5644) loss_oracle 0.9437 (0.9060) acc 78.1250 (58.6875) kd_loss 1.0855 (0.8446) lr 1.8763e-03 eta 0:19:28
epoch [10/50] batch [220/319] time 0.087 (0.090) data 0.000 (0.006) loss 2.4113 (2.3976) ce_loss 1.0166 (1.0947) loss_zs_kd 1.6539 (1.5754) loss_oracle 0.9869 (0.9068) acc 59.3750 (58.7500) kd_loss 0.9013 (0.8496) lr 1.8763e-03 eta 0:19:20
epoch [10/50] batch [240/319] time 0.084 (0.090) data 0.000 (0.005) loss 2.0762 (2.4015) ce_loss 0.9912 (1.0977) loss_zs_kd 1.7812 (1.5840) loss_oracle 0.7854 (0.9074) acc 62.5000 (58.7891) kd_loss 0.6923 (0.8501) lr 1.8763e-03 eta 0:19:13
epoch [10/50] batch [260/319] time 0.085 (0.089) data 0.000 (0.005) loss 2.5173 (2.4003) ce_loss 1.1357 (1.0975) loss_zs_kd 1.7505 (1.5870) loss_oracle 0.9434 (0.9065) acc 53.1250 (58.7500) kd_loss 0.9098 (0.8496) lr 1.8763e-03 eta 0:19:05
epoch [10/50] batch [280/319] time 0.080 (0.089) data 0.000 (0.004) loss 2.3555 (2.3926) ce_loss 1.0547 (1.0920) loss_zs_kd 1.7998 (1.5916) loss_oracle 0.9237 (0.9047) acc 59.3750 (58.8504) kd_loss 0.8390 (0.8482) lr 1.8763e-03 eta 0:18:59
epoch [10/50] batch [300/319] time 0.083 (0.089) data 0.000 (0.004) loss 2.5001 (2.3901) ce_loss 1.1982 (1.0911) loss_zs_kd 1.6212 (1.5947) loss_oracle 0.9472 (0.9035) acc 59.3750 (58.8958) kd_loss 0.8282 (0.8472) lr 1.8763e-03 eta 0:18:54
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,816
* accuracy: 64.3%
* error: 35.7%
* macro_f1: 58.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,709
* accuracy: 58.6%
* error: 41.4%
* macro_f1: 27.0%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      66.2%, epoch: 7 *******
******* Domain 2 best val test acc: 54.1%, epoch: 7 *******
******* Domain 2 best test acc:     58.6%, epoch: 10 *******
epoch [11/50] batch [20/319] time 0.080 (0.171) data 0.000 (0.086) loss 2.2156 (2.2977) ce_loss 1.0205 (1.0701) loss_zs_kd 1.4853 (1.5530) loss_oracle 0.7576 (0.8649) acc 62.5000 (59.5312) kd_loss 0.8163 (0.7951) lr 1.8443e-03 eta 0:36:23
epoch [11/50] batch [40/319] time 0.080 (0.127) data 0.000 (0.043) loss 2.2842 (2.3073) ce_loss 0.8916 (1.0606) loss_zs_kd 1.5390 (1.6065) loss_oracle 0.9036 (0.8712) acc 68.7500 (59.5312) kd_loss 0.9408 (0.8112) lr 1.8443e-03 eta 0:26:52
epoch [11/50] batch [60/319] time 0.084 (0.112) data 0.000 (0.029) loss 2.4575 (2.3101) ce_loss 1.1436 (1.0620) loss_zs_kd 2.0677 (1.6298) loss_oracle 0.8613 (0.8653) acc 56.2500 (59.3229) kd_loss 0.8834 (0.8155) lr 1.8443e-03 eta 0:23:37
epoch [11/50] batch [80/319] time 0.085 (0.104) data 0.000 (0.022) loss 2.5830 (2.3193) ce_loss 1.3340 (1.0716) loss_zs_kd 1.8244 (1.6422) loss_oracle 0.8795 (0.8621) acc 50.0000 (58.9453) kd_loss 0.8092 (0.8166) lr 1.8443e-03 eta 0:22:04
epoch [11/50] batch [100/319] time 0.079 (0.101) data 0.000 (0.017) loss 2.2492 (2.3240) ce_loss 1.0078 (1.0787) loss_zs_kd 1.5639 (1.6282) loss_oracle 0.8464 (0.8591) acc 65.6250 (59.1562) kd_loss 0.8181 (0.8158) lr 1.8443e-03 eta 0:21:14
epoch [11/50] batch [120/319] time 0.089 (0.098) data 0.000 (0.015) loss 2.3338 (2.3265) ce_loss 1.0869 (1.0805) loss_zs_kd 1.5985 (1.6437) loss_oracle 0.8326 (0.8579) acc 62.5000 (59.0104) kd_loss 0.8306 (0.8171) lr 1.8443e-03 eta 0:20:43
epoch [11/50] batch [140/319] time 0.084 (0.097) data 0.000 (0.013) loss 2.5940 (2.3247) ce_loss 1.4580 (1.0809) loss_zs_kd 1.7063 (1.6409) loss_oracle 0.7962 (0.8540) acc 43.7500 (59.3973) kd_loss 0.7379 (0.8168) lr 1.8443e-03 eta 0:20:19
epoch [11/50] batch [160/319] time 0.078 (0.095) data 0.000 (0.011) loss 1.9650 (2.3300) ce_loss 0.7280 (1.0856) loss_zs_kd 1.6628 (1.6486) loss_oracle 0.8749 (0.8535) acc 71.8750 (59.0820) kd_loss 0.7996 (0.8177) lr 1.8443e-03 eta 0:19:59
epoch [11/50] batch [180/319] time 0.082 (0.094) data 0.000 (0.010) loss 2.3819 (2.3301) ce_loss 1.1641 (1.0846) loss_zs_kd 1.5341 (1.6425) loss_oracle 0.8144 (0.8558) acc 62.5000 (59.0451) kd_loss 0.8106 (0.8176) lr 1.8443e-03 eta 0:19:42
epoch [11/50] batch [200/319] time 0.084 (0.093) data 0.000 (0.009) loss 2.2918 (2.3251) ce_loss 1.0752 (1.0799) loss_zs_kd 1.8039 (1.6428) loss_oracle 0.8026 (0.8536) acc 62.5000 (59.4062) kd_loss 0.8153 (0.8185) lr 1.8443e-03 eta 0:19:30
epoch [11/50] batch [220/319] time 0.083 (0.092) data 0.000 (0.008) loss 2.3830 (2.3176) ce_loss 1.1582 (1.0742) loss_zs_kd 1.8126 (1.6341) loss_oracle 0.8001 (0.8508) acc 53.1250 (59.5739) kd_loss 0.8248 (0.8180) lr 1.8443e-03 eta 0:19:19
epoch [11/50] batch [240/319] time 0.091 (0.092) data 0.000 (0.007) loss 2.1606 (2.3072) ce_loss 0.9575 (1.0657) loss_zs_kd 1.5124 (1.6317) loss_oracle 0.7681 (0.8464) acc 68.7500 (59.8307) kd_loss 0.8190 (0.8182) lr 1.8443e-03 eta 0:19:10
epoch [11/50] batch [260/319] time 0.086 (0.091) data 0.000 (0.007) loss 2.1586 (2.3014) ce_loss 0.8838 (1.0621) loss_zs_kd 2.0231 (1.6372) loss_oracle 0.7855 (0.8418) acc 59.3750 (59.7957) kd_loss 0.8820 (0.8184) lr 1.8443e-03 eta 0:19:01
epoch [11/50] batch [280/319] time 0.087 (0.091) data 0.000 (0.006) loss 2.1937 (2.2976) ce_loss 1.1162 (1.0603) loss_zs_kd 1.3891 (1.6330) loss_oracle 0.7744 (0.8381) acc 59.3750 (59.9554) kd_loss 0.6903 (0.8182) lr 1.8443e-03 eta 0:19:01
epoch [11/50] batch [300/319] time 0.090 (0.091) data 0.000 (0.006) loss 2.7693 (2.3001) ce_loss 1.6045 (1.0652) loss_zs_kd 1.4958 (1.6238) loss_oracle 0.7612 (0.8352) acc 40.6250 (59.7292) kd_loss 0.7842 (0.8174) lr 1.8443e-03 eta 0:18:54
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,886
* accuracy: 65.9%
* error: 34.1%
* macro_f1: 57.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,183
* accuracy: 53.2%
* error: 46.8%
* macro_f1: 23.9%
******* Domain 2 best val acc:      66.2%, epoch: 7 *******
******* Domain 2 best val test acc: 54.1%, epoch: 7 *******
******* Domain 2 best test acc:     58.6%, epoch: 10 *******
epoch [12/50] batch [20/319] time 0.073 (0.174) data 0.000 (0.084) loss 2.1943 (2.3133) ce_loss 1.0371 (1.0900) loss_zs_kd 1.5535 (1.6083) loss_oracle 0.7453 (0.7636) acc 59.3750 (59.0625) kd_loss 0.7845 (0.8415) lr 1.8090e-03 eta 0:35:59
epoch [12/50] batch [40/319] time 0.069 (0.126) data 0.000 (0.042) loss 2.0811 (2.3059) ce_loss 0.9224 (1.0917) loss_zs_kd 1.7252 (1.6114) loss_oracle 0.6975 (0.7541) acc 62.5000 (58.4375) kd_loss 0.8100 (0.8371) lr 1.8090e-03 eta 0:25:57
epoch [12/50] batch [60/319] time 0.108 (0.113) data 0.001 (0.028) loss 2.2489 (2.2921) ce_loss 1.1172 (1.0953) loss_zs_kd 1.5676 (1.6443) loss_oracle 0.7298 (0.7551) acc 56.2500 (58.3854) kd_loss 0.7668 (0.8192) lr 1.8090e-03 eta 0:23:18
epoch [12/50] batch [80/319] time 0.079 (0.106) data 0.000 (0.021) loss 2.0241 (2.2716) ce_loss 0.8940 (1.0864) loss_zs_kd 1.5469 (1.6665) loss_oracle 0.7337 (0.7522) acc 62.5000 (58.5547) kd_loss 0.7633 (0.8090) lr 1.8090e-03 eta 0:21:48
epoch [12/50] batch [100/319] time 0.083 (0.102) data 0.000 (0.017) loss 2.3747 (2.2751) ce_loss 1.1162 (1.0977) loss_zs_kd 1.7658 (1.6389) loss_oracle 0.7290 (0.7513) acc 59.3750 (58.3750) kd_loss 0.8940 (0.8018) lr 1.8090e-03 eta 0:20:52
epoch [12/50] batch [120/319] time 0.080 (0.099) data 0.000 (0.014) loss 2.3055 (2.2745) ce_loss 1.1309 (1.1042) loss_zs_kd 1.4118 (1.6322) loss_oracle 0.7239 (0.7450) acc 53.1250 (58.2031) kd_loss 0.8127 (0.7977) lr 1.8090e-03 eta 0:20:16
epoch [12/50] batch [140/319] time 0.086 (0.097) data 0.000 (0.012) loss 2.3200 (2.2572) ce_loss 1.0596 (1.0898) loss_zs_kd 1.6328 (1.6305) loss_oracle 0.6905 (0.7372) acc 71.8750 (58.9509) kd_loss 0.9152 (0.7988) lr 1.8090e-03 eta 0:19:48
epoch [12/50] batch [160/319] time 0.086 (0.095) data 0.000 (0.011) loss 2.1897 (2.2430) ce_loss 1.1123 (1.0814) loss_zs_kd 1.8846 (1.6361) loss_oracle 0.6365 (0.7297) acc 46.8750 (59.4727) kd_loss 0.7591 (0.7968) lr 1.8090e-03 eta 0:19:28
epoch [12/50] batch [180/319] time 0.080 (0.094) data 0.001 (0.010) loss 2.1070 (2.2369) ce_loss 0.9209 (1.0805) loss_zs_kd 1.5939 (1.6532) loss_oracle 0.6733 (0.7221) acc 71.8750 (59.6181) kd_loss 0.8495 (0.7953) lr 1.8090e-03 eta 0:19:14
epoch [12/50] batch [200/319] time 0.084 (0.093) data 0.000 (0.009) loss 2.5113 (2.2308) ce_loss 1.1328 (1.0765) loss_zs_kd 1.8306 (1.6584) loss_oracle 0.8630 (0.7205) acc 46.8750 (59.7031) kd_loss 0.9470 (0.7940) lr 1.8090e-03 eta 0:19:02
epoch [12/50] batch [220/319] time 0.080 (0.093) data 0.000 (0.008) loss 1.9819 (2.2186) ce_loss 0.9106 (1.0711) loss_zs_kd 1.6326 (1.6773) loss_oracle 0.7144 (0.7165) acc 53.1250 (59.7727) kd_loss 0.7140 (0.7892) lr 1.8090e-03 eta 0:18:51
epoch [12/50] batch [240/319] time 0.085 (0.092) data 0.000 (0.007) loss 2.2510 (2.2134) ce_loss 1.0459 (1.0714) loss_zs_kd 1.9462 (1.6781) loss_oracle 0.7269 (0.7138) acc 56.2500 (59.7917) kd_loss 0.8416 (0.7851) lr 1.8090e-03 eta 0:18:38
epoch [12/50] batch [260/319] time 0.081 (0.091) data 0.000 (0.007) loss 2.0289 (2.1979) ce_loss 1.0137 (1.0644) loss_zs_kd 1.5491 (1.6737) loss_oracle 0.6510 (0.7082) acc 65.6250 (60.0120) kd_loss 0.6898 (0.7794) lr 1.8090e-03 eta 0:18:30
epoch [12/50] batch [280/319] time 0.079 (0.091) data 0.000 (0.006) loss 1.9020 (2.1924) ce_loss 0.7148 (1.0659) loss_zs_kd 1.6881 (1.6706) loss_oracle 0.7041 (0.7026) acc 75.0000 (59.8772) kd_loss 0.8351 (0.7752) lr 1.8090e-03 eta 0:18:23
epoch [12/50] batch [300/319] time 0.089 (0.090) data 0.000 (0.006) loss 2.2382 (2.1806) ce_loss 1.2061 (1.0624) loss_zs_kd 1.6533 (1.6687) loss_oracle 0.5557 (0.6967) acc 40.6250 (59.8229) kd_loss 0.7543 (0.7698) lr 1.8090e-03 eta 0:18:17
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,867
* accuracy: 65.5%
* error: 34.5%
* macro_f1: 58.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,333
* accuracy: 54.8%
* error: 45.2%
* macro_f1: 24.3%
******* Domain 2 best val acc:      66.2%, epoch: 7 *******
******* Domain 2 best val test acc: 54.1%, epoch: 7 *******
******* Domain 2 best test acc:     58.6%, epoch: 10 *******
epoch [13/50] batch [20/319] time 0.077 (0.164) data 0.000 (0.074) loss 2.0598 (2.1529) ce_loss 1.0195 (1.1330) loss_zs_kd 1.7785 (1.6979) loss_oracle 0.5569 (0.6169) acc 56.2500 (60.0000) kd_loss 0.7618 (0.7115) lr 1.7705e-03 eta 0:33:00
epoch [13/50] batch [40/319] time 0.086 (0.124) data 0.000 (0.037) loss 2.4287 (2.0882) ce_loss 1.5049 (1.0720) loss_zs_kd 1.5948 (1.6687) loss_oracle 0.5565 (0.6107) acc 53.1250 (60.6250) kd_loss 0.6455 (0.7109) lr 1.7705e-03 eta 0:25:01
epoch [13/50] batch [60/319] time 0.086 (0.111) data 0.001 (0.025) loss 2.4340 (2.0894) ce_loss 1.4658 (1.0799) loss_zs_kd 1.7050 (1.6624) loss_oracle 0.5964 (0.6093) acc 50.0000 (59.7917) kd_loss 0.6700 (0.7047) lr 1.7705e-03 eta 0:22:18
epoch [13/50] batch [80/319] time 0.083 (0.104) data 0.000 (0.019) loss 1.7827 (2.0926) ce_loss 0.7417 (1.0852) loss_zs_kd 1.5034 (1.6605) loss_oracle 0.6251 (0.6131) acc 75.0000 (59.3750) kd_loss 0.7284 (0.7009) lr 1.7705e-03 eta 0:20:56
epoch [13/50] batch [100/319] time 0.077 (0.100) data 0.000 (0.015) loss 2.1671 (2.0817) ce_loss 1.1680 (1.0813) loss_zs_kd 1.6607 (1.6613) loss_oracle 0.5876 (0.6110) acc 50.0000 (59.5938) kd_loss 0.7053 (0.6949) lr 1.7705e-03 eta 0:20:05
epoch [13/50] batch [120/319] time 0.073 (0.097) data 0.000 (0.013) loss 1.9633 (2.0698) ce_loss 1.0479 (1.0717) loss_zs_kd 1.6390 (1.6752) loss_oracle 0.5866 (0.6110) acc 62.5000 (60.0260) kd_loss 0.6222 (0.6926) lr 1.7705e-03 eta 0:19:28
epoch [13/50] batch [140/319] time 0.086 (0.095) data 0.000 (0.011) loss 2.2468 (2.0667) ce_loss 1.3428 (1.0728) loss_zs_kd 1.8213 (1.6682) loss_oracle 0.5950 (0.6099) acc 46.8750 (60.0893) kd_loss 0.6065 (0.6889) lr 1.7705e-03 eta 0:19:00
epoch [13/50] batch [160/319] time 0.087 (0.094) data 0.000 (0.010) loss 2.0022 (2.0614) ce_loss 1.1465 (1.0701) loss_zs_kd 1.6824 (1.6700) loss_oracle 0.5716 (0.6095) acc 62.5000 (60.1562) kd_loss 0.5699 (0.6866) lr 1.7705e-03 eta 0:18:46
epoch [13/50] batch [180/319] time 0.075 (0.093) data 0.000 (0.008) loss 1.9882 (2.0632) ce_loss 0.9106 (1.0763) loss_zs_kd 1.7062 (1.6773) loss_oracle 0.7205 (0.6086) acc 71.8750 (60.1562) kd_loss 0.7173 (0.6827) lr 1.7705e-03 eta 0:18:30
epoch [13/50] batch [200/319] time 0.089 (0.092) data 0.000 (0.008) loss 2.1328 (2.0650) ce_loss 1.2285 (1.0800) loss_zs_kd 1.5472 (1.6770) loss_oracle 0.6653 (0.6084) acc 53.1250 (60.0938) kd_loss 0.5716 (0.6808) lr 1.7705e-03 eta 0:18:13
epoch [13/50] batch [220/319] time 0.083 (0.091) data 0.000 (0.007) loss 2.1311 (2.0587) ce_loss 1.1768 (1.0762) loss_zs_kd 1.9192 (1.6845) loss_oracle 0.5587 (0.6072) acc 59.3750 (60.1562) kd_loss 0.6750 (0.6789) lr 1.7705e-03 eta 0:18:04
epoch [13/50] batch [240/319] time 0.082 (0.091) data 0.000 (0.006) loss 1.7793 (2.0552) ce_loss 0.8096 (1.0760) loss_zs_kd 1.5549 (1.6850) loss_oracle 0.6411 (0.6066) acc 71.8750 (59.9609) kd_loss 0.6492 (0.6759) lr 1.7705e-03 eta 0:17:56
epoch [13/50] batch [260/319] time 0.083 (0.090) data 0.000 (0.006) loss 2.1720 (2.0564) ce_loss 1.1221 (1.0772) loss_zs_kd 1.6443 (1.6815) loss_oracle 0.5979 (0.6052) acc 50.0000 (59.8077) kd_loss 0.7510 (0.6766) lr 1.7705e-03 eta 0:17:49
epoch [13/50] batch [280/319] time 0.087 (0.090) data 0.000 (0.006) loss 2.0282 (2.0575) ce_loss 1.0059 (1.0770) loss_zs_kd 1.6795 (1.6760) loss_oracle 0.4713 (0.6035) acc 65.6250 (59.7768) kd_loss 0.7867 (0.6788) lr 1.7705e-03 eta 0:17:44
epoch [13/50] batch [300/319] time 0.089 (0.090) data 0.000 (0.005) loss 1.9861 (2.0520) ce_loss 1.0146 (1.0739) loss_zs_kd 1.7152 (1.6734) loss_oracle 0.5850 (0.6018) acc 62.5000 (59.8021) kd_loss 0.6790 (0.6772) lr 1.7705e-03 eta 0:17:40
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,880
* accuracy: 65.8%
* error: 34.2%
* macro_f1: 57.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,770
* accuracy: 59.3%
* error: 40.7%
* macro_f1: 25.9%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      66.2%, epoch: 7 *******
******* Domain 2 best val test acc: 54.1%, epoch: 7 *******
******* Domain 2 best test acc:     59.3%, epoch: 13 *******
epoch [14/50] batch [20/319] time 0.078 (0.193) data 0.000 (0.109) loss 1.9382 (2.0489) ce_loss 0.8960 (1.0799) loss_zs_kd 1.9084 (1.6784) loss_oracle 0.5887 (0.5882) acc 75.0000 (57.5000) kd_loss 0.7479 (0.6748) lr 1.7290e-03 eta 0:37:56
epoch [14/50] batch [40/319] time 0.077 (0.139) data 0.000 (0.055) loss 2.0295 (2.0356) ce_loss 1.0469 (1.0626) loss_zs_kd 1.5020 (1.6889) loss_oracle 0.4841 (0.5876) acc 59.3750 (58.9844) kd_loss 0.7406 (0.6792) lr 1.7290e-03 eta 0:27:11
epoch [14/50] batch [60/319] time 0.086 (0.119) data 0.000 (0.037) loss 1.9324 (2.0260) ce_loss 1.0166 (1.0625) loss_zs_kd 2.0191 (1.7181) loss_oracle 0.4679 (0.5867) acc 62.5000 (59.4792) kd_loss 0.6819 (0.6701) lr 1.7290e-03 eta 0:23:22
epoch [14/50] batch [80/319] time 0.088 (0.110) data 0.000 (0.028) loss 2.3171 (2.0327) ce_loss 1.2725 (1.0639) loss_zs_kd 1.7413 (1.7088) loss_oracle 0.5941 (0.5869) acc 53.1250 (59.4922) kd_loss 0.7476 (0.6753) lr 1.7290e-03 eta 0:21:25
epoch [14/50] batch [100/319] time 0.082 (0.104) data 0.000 (0.022) loss 1.5093 (2.0275) ce_loss 0.7407 (1.0656) loss_zs_kd 1.6958 (1.7269) loss_oracle 0.5449 (0.5930) acc 78.1250 (59.3750) kd_loss 0.4961 (0.6654) lr 1.7290e-03 eta 0:20:19
epoch [14/50] batch [120/319] time 0.087 (0.101) data 0.000 (0.018) loss 2.0011 (2.0284) ce_loss 0.9321 (1.0642) loss_zs_kd 1.7330 (1.7223) loss_oracle 0.6218 (0.5970) acc 65.6250 (59.5833) kd_loss 0.7581 (0.6657) lr 1.7290e-03 eta 0:19:37
epoch [14/50] batch [140/319] time 0.088 (0.098) data 0.000 (0.016) loss 2.4174 (2.0302) ce_loss 1.4199 (1.0665) loss_zs_kd 1.7884 (1.7142) loss_oracle 0.6168 (0.5994) acc 46.8750 (59.5089) kd_loss 0.6891 (0.6640) lr 1.7290e-03 eta 0:19:04
epoch [14/50] batch [160/319] time 0.082 (0.097) data 0.000 (0.014) loss 2.2419 (2.0392) ce_loss 1.2432 (1.0728) loss_zs_kd 1.6667 (1.7170) loss_oracle 0.7085 (0.6019) acc 59.3750 (59.2383) kd_loss 0.6445 (0.6655) lr 1.7290e-03 eta 0:18:50
epoch [14/50] batch [180/319] time 0.082 (0.096) data 0.000 (0.012) loss 1.9367 (2.0402) ce_loss 0.9775 (1.0696) loss_zs_kd 1.6362 (1.7194) loss_oracle 0.5590 (0.6001) acc 68.7500 (59.5833) kd_loss 0.6797 (0.6707) lr 1.7290e-03 eta 0:18:34
epoch [14/50] batch [200/319] time 0.086 (0.095) data 0.000 (0.011) loss 1.9481 (2.0375) ce_loss 0.9829 (1.0652) loss_zs_kd 1.8276 (1.7186) loss_oracle 0.5984 (0.5995) acc 68.7500 (59.7812) kd_loss 0.6660 (0.6725) lr 1.7290e-03 eta 0:18:20
epoch [14/50] batch [220/319] time 0.075 (0.093) data 0.000 (0.010) loss 1.8551 (2.0395) ce_loss 0.9365 (1.0668) loss_zs_kd 1.7046 (1.7107) loss_oracle 0.6165 (0.6005) acc 53.1250 (59.6449) kd_loss 0.6103 (0.6725) lr 1.7290e-03 eta 0:18:02
epoch [14/50] batch [240/319] time 0.087 (0.093) data 0.000 (0.009) loss 2.0266 (2.0364) ce_loss 1.0410 (1.0642) loss_zs_kd 1.5947 (1.7029) loss_oracle 0.6626 (0.6010) acc 65.6250 (59.6875) kd_loss 0.6543 (0.6717) lr 1.7290e-03 eta 0:17:52
epoch [14/50] batch [260/319] time 0.090 (0.092) data 0.000 (0.009) loss 1.9736 (2.0344) ce_loss 0.9126 (1.0619) loss_zs_kd 1.6161 (1.6960) loss_oracle 0.6026 (0.5998) acc 68.7500 (59.8438) kd_loss 0.7597 (0.6726) lr 1.7290e-03 eta 0:17:41
epoch [14/50] batch [280/319] time 0.089 (0.091) data 0.000 (0.008) loss 2.0405 (2.0343) ce_loss 1.0332 (1.0591) loss_zs_kd 1.7600 (1.6953) loss_oracle 0.6888 (0.6011) acc 53.1250 (60.0558) kd_loss 0.6629 (0.6747) lr 1.7290e-03 eta 0:17:33
epoch [14/50] batch [300/319] time 0.091 (0.091) data 0.000 (0.008) loss 2.2005 (2.0361) ce_loss 1.1943 (1.0593) loss_zs_kd 1.7096 (1.6917) loss_oracle 0.6226 (0.6008) acc 50.0000 (60.0625) kd_loss 0.6949 (0.6764) lr 1.7290e-03 eta 0:17:27
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,850
* accuracy: 65.1%
* error: 34.9%
* macro_f1: 57.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,493
* accuracy: 56.4%
* error: 43.6%
* macro_f1: 25.1%
******* Domain 2 best val acc:      66.2%, epoch: 7 *******
******* Domain 2 best val test acc: 54.1%, epoch: 7 *******
******* Domain 2 best test acc:     59.3%, epoch: 13 *******
epoch [15/50] batch [20/319] time 0.076 (0.187) data 0.000 (0.101) loss 2.4628 (2.0665) ce_loss 1.5107 (1.0936) loss_zs_kd 1.5713 (1.6011) loss_oracle 0.5596 (0.6005) acc 40.6250 (58.9062) kd_loss 0.6723 (0.6727) lr 1.6845e-03 eta 0:35:45
epoch [15/50] batch [40/319] time 0.085 (0.135) data 0.000 (0.050) loss 1.8651 (2.0375) ce_loss 0.9116 (1.0635) loss_zs_kd 1.6744 (1.6624) loss_oracle 0.5673 (0.5935) acc 62.5000 (59.9219) kd_loss 0.6698 (0.6772) lr 1.6845e-03 eta 0:25:48
epoch [15/50] batch [60/319] time 0.079 (0.117) data 0.000 (0.034) loss 2.0324 (2.0324) ce_loss 1.1416 (1.0648) loss_zs_kd 1.8422 (1.6799) loss_oracle 0.4994 (0.5853) acc 50.0000 (59.7917) kd_loss 0.6410 (0.6749) lr 1.6845e-03 eta 0:22:17
epoch [15/50] batch [80/319] time 0.081 (0.108) data 0.000 (0.025) loss 1.8216 (2.0262) ce_loss 0.8345 (1.0610) loss_zs_kd 1.5927 (1.6734) loss_oracle 0.5779 (0.5865) acc 65.6250 (59.7266) kd_loss 0.6981 (0.6720) lr 1.6845e-03 eta 0:20:32
epoch [15/50] batch [100/319] time 0.085 (0.103) data 0.000 (0.020) loss 1.9582 (2.0142) ce_loss 0.9321 (1.0528) loss_zs_kd 1.5163 (1.6699) loss_oracle 0.5806 (0.5853) acc 68.7500 (60.5000) kd_loss 0.7358 (0.6687) lr 1.6845e-03 eta 0:19:31
epoch [15/50] batch [120/319] time 0.083 (0.100) data 0.000 (0.017) loss 1.9573 (2.0227) ce_loss 0.9448 (1.0612) loss_zs_kd 1.7168 (1.6577) loss_oracle 0.5598 (0.5856) acc 75.0000 (60.2083) kd_loss 0.7326 (0.6686) lr 1.6845e-03 eta 0:18:55
epoch [15/50] batch [140/319] time 0.078 (0.098) data 0.000 (0.015) loss 2.1343 (2.0182) ce_loss 1.1641 (1.0596) loss_zs_kd 2.0984 (1.6691) loss_oracle 0.5017 (0.5833) acc 50.0000 (60.2679) kd_loss 0.7194 (0.6670) lr 1.6845e-03 eta 0:18:34
epoch [15/50] batch [160/319] time 0.087 (0.096) data 0.000 (0.013) loss 1.8782 (2.0092) ce_loss 0.8765 (1.0490) loss_zs_kd 1.6145 (1.6712) loss_oracle 0.5888 (0.5848) acc 81.2500 (60.7227) kd_loss 0.7074 (0.6677) lr 1.6845e-03 eta 0:18:12
epoch [15/50] batch [180/319] time 0.078 (0.095) data 0.000 (0.011) loss 2.0397 (1.9956) ce_loss 1.0850 (1.0383) loss_zs_kd 1.4056 (1.6690) loss_oracle 0.6714 (0.5851) acc 59.3750 (61.1806) kd_loss 0.6190 (0.6647) lr 1.6845e-03 eta 0:17:48
epoch [15/50] batch [200/319] time 0.094 (0.093) data 0.000 (0.010) loss 2.2367 (2.0088) ce_loss 1.2451 (1.0503) loss_zs_kd 1.6962 (1.6796) loss_oracle 0.7209 (0.5897) acc 56.2500 (60.6562) kd_loss 0.6311 (0.6636) lr 1.6845e-03 eta 0:17:32
epoch [15/50] batch [220/319] time 0.078 (0.092) data 0.000 (0.009) loss 2.3488 (2.0146) ce_loss 1.2754 (1.0547) loss_zs_kd 1.6466 (1.6762) loss_oracle 0.7322 (0.5955) acc 56.2500 (60.3409) kd_loss 0.7073 (0.6621) lr 1.6845e-03 eta 0:17:21
epoch [15/50] batch [240/319] time 0.081 (0.092) data 0.000 (0.009) loss 1.9228 (2.0162) ce_loss 0.9258 (1.0524) loss_zs_kd 1.6931 (1.6740) loss_oracle 0.6187 (0.5980) acc 65.6250 (60.5729) kd_loss 0.6877 (0.6647) lr 1.6845e-03 eta 0:17:11
epoch [15/50] batch [260/319] time 0.084 (0.091) data 0.000 (0.008) loss 2.1153 (2.0213) ce_loss 1.0938 (1.0578) loss_zs_kd 1.5222 (1.6778) loss_oracle 0.6164 (0.5994) acc 40.6250 (60.2284) kd_loss 0.7133 (0.6638) lr 1.6845e-03 eta 0:17:04
epoch [15/50] batch [280/319] time 0.075 (0.091) data 0.000 (0.007) loss 1.7775 (2.0229) ce_loss 0.9580 (1.0623) loss_zs_kd 1.6963 (1.6782) loss_oracle 0.5180 (0.5977) acc 62.5000 (60.1451) kd_loss 0.5605 (0.6617) lr 1.6845e-03 eta 0:16:58
epoch [15/50] batch [300/319] time 0.090 (0.090) data 0.000 (0.007) loss 2.2809 (2.0197) ce_loss 1.1982 (1.0591) loss_zs_kd 1.7524 (1.6752) loss_oracle 0.6772 (0.5963) acc 53.1250 (60.4062) kd_loss 0.7440 (0.6624) lr 1.6845e-03 eta 0:16:51
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,882
* accuracy: 65.8%
* error: 34.2%
* macro_f1: 57.5%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,806
* accuracy: 59.6%
* error: 40.4%
* macro_f1: 26.1%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      66.2%, epoch: 7 *******
******* Domain 2 best val test acc: 54.1%, epoch: 7 *******
******* Domain 2 best test acc:     59.6%, epoch: 15 *******
epoch [16/50] batch [20/319] time 0.078 (0.165) data 0.000 (0.077) loss 1.7777 (2.0519) ce_loss 0.8208 (1.0715) loss_zs_kd 1.6354 (1.6658) loss_oracle 0.5594 (0.6137) acc 68.7500 (60.3125) kd_loss 0.6772 (0.6736) lr 1.6374e-03 eta 0:30:37
epoch [16/50] batch [40/319] time 0.083 (0.125) data 0.000 (0.039) loss 2.1362 (2.0206) ce_loss 1.1670 (1.0497) loss_zs_kd 1.5083 (1.6284) loss_oracle 0.6971 (0.6122) acc 59.3750 (60.7031) kd_loss 0.6206 (0.6648) lr 1.6374e-03 eta 0:23:07
epoch [16/50] batch [60/319] time 0.084 (0.112) data 0.000 (0.026) loss 1.6681 (2.0149) ce_loss 0.7378 (1.0461) loss_zs_kd 1.8115 (1.6692) loss_oracle 0.5109 (0.6096) acc 68.7500 (60.1562) kd_loss 0.6748 (0.6640) lr 1.6374e-03 eta 0:20:38
epoch [16/50] batch [80/319] time 0.086 (0.105) data 0.000 (0.020) loss 2.0251 (2.0159) ce_loss 0.9507 (1.0443) loss_zs_kd 1.7859 (1.6507) loss_oracle 0.8316 (0.6237) acc 62.5000 (60.8203) kd_loss 0.6587 (0.6598) lr 1.6374e-03 eta 0:19:24
epoch [16/50] batch [100/319] time 0.078 (0.101) data 0.000 (0.016) loss 2.0032 (2.0198) ce_loss 1.0898 (1.0479) loss_zs_kd 1.5272 (1.6700) loss_oracle 0.6314 (0.6274) acc 59.3750 (60.6250) kd_loss 0.5977 (0.6582) lr 1.6374e-03 eta 0:18:38
epoch [16/50] batch [120/319] time 0.086 (0.098) data 0.000 (0.013) loss 1.9373 (2.0093) ce_loss 0.8994 (1.0396) loss_zs_kd 1.6030 (1.6541) loss_oracle 0.6665 (0.6212) acc 56.2500 (61.2240) kd_loss 0.7047 (0.6590) lr 1.6374e-03 eta 0:18:01
epoch [16/50] batch [140/319] time 0.088 (0.096) data 0.000 (0.011) loss 1.6761 (2.0153) ce_loss 0.7725 (1.0529) loss_zs_kd 1.8734 (1.6471) loss_oracle 0.4665 (0.6117) acc 71.8750 (60.6027) kd_loss 0.6704 (0.6565) lr 1.6374e-03 eta 0:17:39
epoch [16/50] batch [160/319] time 0.077 (0.094) data 0.000 (0.010) loss 1.6572 (2.0163) ce_loss 0.7949 (1.0603) loss_zs_kd 1.7024 (1.6549) loss_oracle 0.6595 (0.6039) acc 75.0000 (60.2539) kd_loss 0.5325 (0.6541) lr 1.6374e-03 eta 0:17:15
epoch [16/50] batch [180/319] time 0.079 (0.093) data 0.000 (0.009) loss 1.9143 (2.0139) ce_loss 0.9512 (1.0538) loss_zs_kd 1.6326 (1.6572) loss_oracle 0.5886 (0.5996) acc 71.8750 (60.7292) kd_loss 0.6689 (0.6603) lr 1.6374e-03 eta 0:16:58
epoch [16/50] batch [200/319] time 0.075 (0.092) data 0.000 (0.008) loss 1.8707 (2.0132) ce_loss 0.9971 (1.0539) loss_zs_kd 1.4224 (1.6517) loss_oracle 0.5122 (0.5941) acc 68.7500 (60.6406) kd_loss 0.6175 (0.6622) lr 1.6374e-03 eta 0:16:44
epoch [16/50] batch [220/319] time 0.087 (0.091) data 0.000 (0.007) loss 1.7330 (2.0135) ce_loss 0.8584 (1.0533) loss_zs_kd 1.4606 (1.6457) loss_oracle 0.5355 (0.5926) acc 68.7500 (60.7244) kd_loss 0.6068 (0.6639) lr 1.6374e-03 eta 0:16:32
epoch [16/50] batch [240/319] time 0.085 (0.090) data 0.000 (0.007) loss 1.8378 (2.0159) ce_loss 0.9766 (1.0554) loss_zs_kd 1.9466 (1.6502) loss_oracle 0.5970 (0.5915) acc 62.5000 (60.6901) kd_loss 0.5628 (0.6648) lr 1.6374e-03 eta 0:16:24
epoch [16/50] batch [260/319] time 0.087 (0.090) data 0.000 (0.006) loss 1.7359 (2.0202) ce_loss 0.7905 (1.0578) loss_zs_kd 1.6645 (1.6528) loss_oracle 0.5489 (0.5898) acc 78.1250 (60.7332) kd_loss 0.6709 (0.6676) lr 1.6374e-03 eta 0:16:19
epoch [16/50] batch [280/319] time 0.080 (0.089) data 0.000 (0.006) loss 2.3203 (2.0235) ce_loss 1.3047 (1.0607) loss_zs_kd 1.4919 (1.6517) loss_oracle 0.5784 (0.5873) acc 40.6250 (60.5357) kd_loss 0.7265 (0.6691) lr 1.6374e-03 eta 0:16:13
epoch [16/50] batch [300/319] time 0.085 (0.089) data 0.000 (0.005) loss 2.0295 (2.0228) ce_loss 0.9951 (1.0582) loss_zs_kd 1.8393 (1.6542) loss_oracle 0.6388 (0.5882) acc 62.5000 (60.5833) kd_loss 0.7149 (0.6705) lr 1.6374e-03 eta 0:16:06
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,798
* accuracy: 63.9%
* error: 36.1%
* macro_f1: 55.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,469
* accuracy: 56.2%
* error: 43.8%
* macro_f1: 25.7%
******* Domain 2 best val acc:      66.2%, epoch: 7 *******
******* Domain 2 best val test acc: 54.1%, epoch: 7 *******
******* Domain 2 best test acc:     59.6%, epoch: 15 *******
epoch [17/50] batch [20/319] time 0.093 (0.189) data 0.000 (0.103) loss 1.8138 (1.9491) ce_loss 0.8301 (0.9837) loss_zs_kd 2.1172 (1.6603) loss_oracle 0.6295 (0.6040) acc 71.8750 (62.5000) kd_loss 0.6689 (0.6634) lr 1.5878e-03 eta 0:34:08
epoch [17/50] batch [40/319] time 0.084 (0.136) data 0.000 (0.052) loss 1.8940 (1.9816) ce_loss 0.9985 (1.0156) loss_zs_kd 1.7253 (1.7483) loss_oracle 0.5791 (0.5957) acc 56.2500 (61.8750) kd_loss 0.6059 (0.6682) lr 1.5878e-03 eta 0:24:25
epoch [17/50] batch [60/319] time 0.093 (0.119) data 0.000 (0.034) loss 2.3413 (2.0089) ce_loss 1.2646 (1.0249) loss_zs_kd 1.4558 (1.6973) loss_oracle 0.6531 (0.6055) acc 62.5000 (61.8229) kd_loss 0.7502 (0.6813) lr 1.5878e-03 eta 0:21:21
epoch [17/50] batch [80/319] time 0.075 (0.109) data 0.000 (0.026) loss 1.9041 (2.0056) ce_loss 0.8672 (1.0211) loss_zs_kd 1.7639 (1.6798) loss_oracle 0.5734 (0.6029) acc 62.5000 (62.0703) kd_loss 0.7503 (0.6830) lr 1.5878e-03 eta 0:19:29
epoch [17/50] batch [100/319] time 0.074 (0.103) data 0.000 (0.021) loss 2.2325 (2.0250) ce_loss 1.1201 (1.0410) loss_zs_kd 1.8466 (1.6600) loss_oracle 0.6021 (0.5936) acc 68.7500 (61.5312) kd_loss 0.8113 (0.6871) lr 1.5878e-03 eta 0:18:31
epoch [17/50] batch [120/319] time 0.074 (0.100) data 0.000 (0.017) loss 1.9128 (2.0367) ce_loss 0.9531 (1.0515) loss_zs_kd 1.8440 (1.6602) loss_oracle 0.5549 (0.5917) acc 46.8750 (61.1198) kd_loss 0.6823 (0.6894) lr 1.5878e-03 eta 0:17:47
epoch [17/50] batch [140/319] time 0.085 (0.097) data 0.000 (0.015) loss 1.9811 (2.0308) ce_loss 1.1348 (1.0498) loss_zs_kd 1.5993 (1.6715) loss_oracle 0.5296 (0.5891) acc 43.7500 (60.8482) kd_loss 0.5815 (0.6865) lr 1.5878e-03 eta 0:17:22
epoch [17/50] batch [160/319] time 0.072 (0.095) data 0.000 (0.013) loss 1.8034 (2.0288) ce_loss 0.7417 (1.0468) loss_zs_kd 1.7590 (1.6724) loss_oracle 0.5506 (0.5881) acc 68.7500 (61.1328) kd_loss 0.7864 (0.6880) lr 1.5878e-03 eta 0:16:59
epoch [17/50] batch [180/319] time 0.076 (0.094) data 0.000 (0.012) loss 1.8481 (2.0310) ce_loss 0.8765 (1.0490) loss_zs_kd 1.8459 (1.6750) loss_oracle 0.5379 (0.5865) acc 62.5000 (61.0243) kd_loss 0.7027 (0.6888) lr 1.5878e-03 eta 0:16:43
epoch [17/50] batch [200/319] time 0.076 (0.092) data 0.000 (0.011) loss 1.8023 (2.0300) ce_loss 0.7778 (1.0511) loss_zs_kd 1.7053 (1.6767) loss_oracle 0.6052 (0.5832) acc 71.8750 (60.8906) kd_loss 0.7218 (0.6872) lr 1.5878e-03 eta 0:16:23
epoch [17/50] batch [220/319] time 0.088 (0.091) data 0.001 (0.010) loss 1.8417 (2.0336) ce_loss 0.8896 (1.0575) loss_zs_kd 1.9953 (1.6808) loss_oracle 0.6287 (0.5819) acc 65.6250 (60.5256) kd_loss 0.6377 (0.6851) lr 1.5878e-03 eta 0:16:10
epoch [17/50] batch [240/319] time 0.078 (0.091) data 0.000 (0.009) loss 2.3176 (2.0321) ce_loss 1.1270 (1.0570) loss_zs_kd 2.0426 (1.6871) loss_oracle 0.6558 (0.5808) acc 59.3750 (60.5208) kd_loss 0.8628 (0.6847) lr 1.5878e-03 eta 0:16:02
epoch [17/50] batch [260/319] time 0.079 (0.090) data 0.000 (0.008) loss 1.9768 (2.0298) ce_loss 1.0635 (1.0566) loss_zs_kd 1.8006 (1.6928) loss_oracle 0.5596 (0.5815) acc 53.1250 (60.2284) kd_loss 0.6335 (0.6824) lr 1.5878e-03 eta 0:15:56
epoch [17/50] batch [280/319] time 0.082 (0.090) data 0.000 (0.008) loss 1.7564 (2.0288) ce_loss 0.8110 (1.0557) loss_zs_kd 1.8059 (1.6816) loss_oracle 0.5873 (0.5816) acc 62.5000 (60.0670) kd_loss 0.6517 (0.6823) lr 1.5878e-03 eta 0:15:50
epoch [17/50] batch [300/319] time 0.091 (0.090) data 0.001 (0.007) loss 2.1246 (2.0262) ce_loss 1.1846 (1.0552) loss_zs_kd 1.8922 (1.6854) loss_oracle 0.5837 (0.5829) acc 59.3750 (60.0938) kd_loss 0.6481 (0.6795) lr 1.5878e-03 eta 0:15:44
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,878
* accuracy: 65.7%
* error: 34.3%
* macro_f1: 56.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,275
* accuracy: 54.2%
* error: 45.8%
* macro_f1: 25.1%
******* Domain 2 best val acc:      66.2%, epoch: 7 *******
******* Domain 2 best val test acc: 54.1%, epoch: 7 *******
******* Domain 2 best test acc:     59.6%, epoch: 15 *******
epoch [18/50] batch [20/319] time 0.073 (0.169) data 0.000 (0.082) loss 1.8799 (1.9746) ce_loss 0.9263 (1.0377) loss_zs_kd 1.6611 (1.7085) loss_oracle 0.5951 (0.5765) acc 59.3750 (60.0000) kd_loss 0.6561 (0.6487) lr 1.5358e-03 eta 0:29:33
epoch [18/50] batch [40/319] time 0.083 (0.127) data 0.000 (0.041) loss 1.7790 (1.9980) ce_loss 0.8472 (1.0383) loss_zs_kd 1.7525 (1.6941) loss_oracle 0.5740 (0.5931) acc 59.3750 (60.9375) kd_loss 0.6448 (0.6632) lr 1.5358e-03 eta 0:22:13
epoch [18/50] batch [60/319] time 0.088 (0.113) data 0.001 (0.027) loss 2.1003 (1.9822) ce_loss 1.0928 (1.0256) loss_zs_kd 1.6633 (1.6883) loss_oracle 0.6798 (0.5987) acc 53.1250 (61.6667) kd_loss 0.6676 (0.6573) lr 1.5358e-03 eta 0:19:47
epoch [18/50] batch [80/319] time 0.082 (0.106) data 0.000 (0.021) loss 1.6456 (1.9946) ce_loss 0.7974 (1.0316) loss_zs_kd 1.7658 (1.6846) loss_oracle 0.5487 (0.5975) acc 71.8750 (61.0547) kd_loss 0.5739 (0.6642) lr 1.5358e-03 eta 0:18:29
epoch [18/50] batch [100/319] time 0.081 (0.102) data 0.000 (0.017) loss 1.6313 (1.9953) ce_loss 0.7363 (1.0313) loss_zs_kd 1.5970 (1.6809) loss_oracle 0.5090 (0.5948) acc 68.7500 (61.1250) kd_loss 0.6405 (0.6666) lr 1.5358e-03 eta 0:17:41
epoch [18/50] batch [120/319] time 0.084 (0.099) data 0.000 (0.014) loss 2.0734 (2.0030) ce_loss 1.0762 (1.0379) loss_zs_kd 2.1912 (1.6985) loss_oracle 0.5495 (0.5969) acc 62.5000 (61.3542) kd_loss 0.7225 (0.6667) lr 1.5358e-03 eta 0:17:10
epoch [18/50] batch [140/319] time 0.085 (0.097) data 0.000 (0.012) loss 1.9543 (2.0059) ce_loss 0.9238 (1.0388) loss_zs_kd 1.5728 (1.7026) loss_oracle 0.5825 (0.5946) acc 59.3750 (61.2500) kd_loss 0.7392 (0.6698) lr 1.5358e-03 eta 0:16:46
epoch [18/50] batch [160/319] time 0.085 (0.096) data 0.000 (0.010) loss 2.1420 (2.0135) ce_loss 1.1709 (1.0463) loss_zs_kd 1.8755 (1.6941) loss_oracle 0.6103 (0.5932) acc 56.2500 (60.7031) kd_loss 0.6660 (0.6707) lr 1.5358e-03 eta 0:16:30
epoch [18/50] batch [180/319] time 0.090 (0.094) data 0.000 (0.009) loss 1.9591 (2.0067) ce_loss 1.1514 (1.0454) loss_zs_kd 1.7434 (1.7037) loss_oracle 0.5291 (0.5928) acc 56.2500 (60.9722) kd_loss 0.5432 (0.6649) lr 1.5358e-03 eta 0:16:15
epoch [18/50] batch [200/319] time 0.079 (0.093) data 0.000 (0.008) loss 2.0227 (2.0125) ce_loss 1.0654 (1.0490) loss_zs_kd 1.7581 (1.7065) loss_oracle 0.6548 (0.5942) acc 62.5000 (60.7656) kd_loss 0.6299 (0.6665) lr 1.5358e-03 eta 0:16:02
epoch [18/50] batch [220/319] time 0.086 (0.092) data 0.000 (0.008) loss 2.2990 (2.0187) ce_loss 1.2256 (1.0518) loss_zs_kd 1.7370 (1.7093) loss_oracle 0.6341 (0.5973) acc 50.0000 (60.6250) kd_loss 0.7563 (0.6682) lr 1.5358e-03 eta 0:15:52
epoch [18/50] batch [240/319] time 0.090 (0.092) data 0.000 (0.007) loss 1.8369 (2.0162) ce_loss 1.0244 (1.0505) loss_zs_kd 1.6895 (1.7097) loss_oracle 0.5175 (0.5997) acc 53.1250 (60.5469) kd_loss 0.5538 (0.6658) lr 1.5358e-03 eta 0:15:44
epoch [18/50] batch [260/319] time 0.081 (0.091) data 0.000 (0.007) loss 2.1868 (2.0184) ce_loss 1.1514 (1.0490) loss_zs_kd 1.9393 (1.7256) loss_oracle 0.5659 (0.6042) acc 46.8750 (60.4688) kd_loss 0.7525 (0.6673) lr 1.5358e-03 eta 0:15:34
epoch [18/50] batch [280/319] time 0.085 (0.090) data 0.000 (0.006) loss 2.0735 (2.0229) ce_loss 1.1367 (1.0516) loss_zs_kd 1.5578 (1.7276) loss_oracle 0.5469 (0.6053) acc 56.2500 (60.3683) kd_loss 0.6633 (0.6687) lr 1.5358e-03 eta 0:15:26
epoch [18/50] batch [300/319] time 0.081 (0.090) data 0.000 (0.006) loss 1.8320 (2.0274) ce_loss 0.8579 (1.0549) loss_zs_kd 2.0084 (1.7300) loss_oracle 0.5662 (0.6049) acc 71.8750 (60.0625) kd_loss 0.6910 (0.6701) lr 1.5358e-03 eta 0:15:22
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,933
* accuracy: 67.0%
* error: 33.0%
* macro_f1: 58.1%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,412
* accuracy: 55.6%
* error: 44.4%
* macro_f1: 23.9%
******* Domain 2 best val acc:      67.0%, epoch: 18 *******
******* Domain 2 best val test acc: 55.6%, epoch: 18 *******
******* Domain 2 best test acc:     59.6%, epoch: 15 *******
epoch [19/50] batch [20/319] time 0.085 (0.176) data 0.000 (0.092) loss 1.8846 (1.9944) ce_loss 0.8926 (1.0092) loss_zs_kd 1.6457 (1.7698) loss_oracle 0.5073 (0.5897) acc 65.6250 (60.9375) kd_loss 0.7384 (0.6905) lr 1.4818e-03 eta 0:29:48
epoch [19/50] batch [40/319] time 0.083 (0.128) data 0.000 (0.046) loss 1.9313 (1.9899) ce_loss 0.9746 (1.0214) loss_zs_kd 1.6713 (1.7488) loss_oracle 0.5770 (0.5758) acc 62.5000 (60.7031) kd_loss 0.6683 (0.6805) lr 1.4818e-03 eta 0:21:37
epoch [19/50] batch [60/319] time 0.082 (0.112) data 0.000 (0.031) loss 1.9433 (1.9988) ce_loss 1.0068 (1.0291) loss_zs_kd 1.4151 (1.7539) loss_oracle 0.5873 (0.5785) acc 65.6250 (60.7812) kd_loss 0.6428 (0.6805) lr 1.4818e-03 eta 0:18:56
epoch [19/50] batch [80/319] time 0.088 (0.105) data 0.000 (0.023) loss 2.3022 (2.0020) ce_loss 1.2383 (1.0380) loss_zs_kd 1.8897 (1.7281) loss_oracle 0.5617 (0.5768) acc 46.8750 (60.8203) kd_loss 0.7831 (0.6756) lr 1.4818e-03 eta 0:17:38
epoch [19/50] batch [100/319] time 0.085 (0.100) data 0.000 (0.019) loss 2.1401 (2.0055) ce_loss 1.0762 (1.0431) loss_zs_kd 1.8014 (1.7414) loss_oracle 0.6549 (0.5791) acc 62.5000 (60.7812) kd_loss 0.7365 (0.6729) lr 1.4818e-03 eta 0:16:50
epoch [19/50] batch [120/319] time 0.073 (0.097) data 0.000 (0.016) loss 2.0816 (2.0100) ce_loss 1.1963 (1.0412) loss_zs_kd 1.6303 (1.7645) loss_oracle 0.6855 (0.5847) acc 50.0000 (60.8854) kd_loss 0.5426 (0.6764) lr 1.4818e-03 eta 0:16:19
epoch [19/50] batch [140/319] time 0.072 (0.094) data 0.000 (0.013) loss 1.9655 (2.0150) ce_loss 0.9331 (1.0442) loss_zs_kd 1.7688 (1.7746) loss_oracle 0.6619 (0.5864) acc 65.6250 (60.8705) kd_loss 0.7014 (0.6775) lr 1.4818e-03 eta 0:15:51
epoch [19/50] batch [160/319] time 0.095 (0.093) data 0.000 (0.012) loss 1.9322 (2.0086) ce_loss 1.0420 (1.0385) loss_zs_kd 1.5462 (1.7755) loss_oracle 0.4812 (0.5815) acc 50.0000 (60.9570) kd_loss 0.6496 (0.6794) lr 1.4818e-03 eta 0:15:35
epoch [19/50] batch [180/319] time 0.077 (0.092) data 0.000 (0.010) loss 1.8892 (2.0071) ce_loss 0.9111 (1.0342) loss_zs_kd 1.6031 (1.7661) loss_oracle 0.5873 (0.5806) acc 65.6250 (61.3021) kd_loss 0.6843 (0.6826) lr 1.4818e-03 eta 0:15:24
epoch [19/50] batch [200/319] time 0.080 (0.091) data 0.000 (0.009) loss 1.8798 (2.0032) ce_loss 0.9487 (1.0322) loss_zs_kd 1.6612 (1.7666) loss_oracle 0.6190 (0.5823) acc 62.5000 (61.5625) kd_loss 0.6215 (0.6798) lr 1.4818e-03 eta 0:15:12
epoch [19/50] batch [220/319] time 0.081 (0.090) data 0.000 (0.009) loss 2.0099 (1.9944) ce_loss 1.0908 (1.0275) loss_zs_kd 1.5901 (1.7676) loss_oracle 0.6123 (0.5796) acc 65.6250 (61.7898) kd_loss 0.6130 (0.6771) lr 1.4818e-03 eta 0:14:59
epoch [19/50] batch [240/319] time 0.083 (0.089) data 0.000 (0.008) loss 2.1987 (1.9950) ce_loss 1.1514 (1.0292) loss_zs_kd 1.8452 (1.7658) loss_oracle 0.6415 (0.5798) acc 56.2500 (61.7708) kd_loss 0.7266 (0.6759) lr 1.4818e-03 eta 0:14:51
epoch [19/50] batch [260/319] time 0.081 (0.089) data 0.000 (0.007) loss 2.2546 (1.9948) ce_loss 1.2529 (1.0311) loss_zs_kd 1.6855 (1.7691) loss_oracle 0.5526 (0.5788) acc 62.5000 (61.6106) kd_loss 0.7254 (0.6742) lr 1.4818e-03 eta 0:14:46
epoch [19/50] batch [280/319] time 0.085 (0.089) data 0.000 (0.007) loss 1.9721 (1.9956) ce_loss 0.9009 (1.0322) loss_zs_kd 1.6083 (1.7667) loss_oracle 0.6521 (0.5788) acc 59.3750 (61.5067) kd_loss 0.7452 (0.6740) lr 1.4818e-03 eta 0:14:40
epoch [19/50] batch [300/319] time 0.086 (0.088) data 0.000 (0.006) loss 2.1622 (1.9976) ce_loss 1.1709 (1.0330) loss_zs_kd 1.6564 (1.7696) loss_oracle 0.5153 (0.5801) acc 53.1250 (61.4479) kd_loss 0.7337 (0.6745) lr 1.4818e-03 eta 0:14:35
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,913
* accuracy: 66.5%
* error: 33.5%
* macro_f1: 60.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,619
* accuracy: 57.7%
* error: 42.3%
* macro_f1: 25.8%
******* Domain 2 best val acc:      67.0%, epoch: 18 *******
******* Domain 2 best val test acc: 55.6%, epoch: 18 *******
******* Domain 2 best test acc:     59.6%, epoch: 15 *******
epoch [20/50] batch [20/319] time 0.075 (0.220) data 0.000 (0.131) loss 2.0261 (2.0248) ce_loss 0.9966 (1.0441) loss_zs_kd 1.6055 (1.7082) loss_oracle 0.4878 (0.5742) acc 65.6250 (60.7812) kd_loss 0.7857 (0.6936) lr 1.4258e-03 eta 0:36:08
epoch [20/50] batch [40/319] time 0.079 (0.148) data 0.000 (0.066) loss 2.0399 (2.0057) ce_loss 1.0303 (1.0283) loss_zs_kd 1.4938 (1.6805) loss_oracle 0.5859 (0.5709) acc 56.2500 (61.4844) kd_loss 0.7166 (0.6919) lr 1.4258e-03 eta 0:24:20
epoch [20/50] batch [60/319] time 0.079 (0.126) data 0.000 (0.044) loss 1.7333 (2.0104) ce_loss 0.8081 (1.0486) loss_zs_kd 1.4495 (1.6766) loss_oracle 0.6029 (0.5716) acc 65.6250 (60.2604) kd_loss 0.6238 (0.6760) lr 1.4258e-03 eta 0:20:41
epoch [20/50] batch [80/319] time 0.081 (0.115) data 0.000 (0.033) loss 1.9011 (2.0039) ce_loss 0.8682 (1.0350) loss_zs_kd 2.0422 (1.7135) loss_oracle 0.6071 (0.5722) acc 81.2500 (61.2891) kd_loss 0.7294 (0.6828) lr 1.4258e-03 eta 0:18:45
epoch [20/50] batch [100/319] time 0.073 (0.108) data 0.000 (0.026) loss 2.0142 (2.0032) ce_loss 0.9917 (1.0314) loss_zs_kd 1.7143 (1.7306) loss_oracle 0.6220 (0.5760) acc 65.6250 (61.7188) kd_loss 0.7116 (0.6838) lr 1.4258e-03 eta 0:17:37
epoch [20/50] batch [120/319] time 0.078 (0.103) data 0.000 (0.022) loss 1.9130 (1.9986) ce_loss 1.0361 (1.0241) loss_zs_kd 1.7251 (1.7339) loss_oracle 0.5521 (0.5786) acc 46.8750 (61.5625) kd_loss 0.6008 (0.6852) lr 1.4258e-03 eta 0:16:50
epoch [20/50] batch [140/319] time 0.078 (0.100) data 0.000 (0.019) loss 1.9013 (1.9956) ce_loss 0.9507 (1.0235) loss_zs_kd 1.7906 (1.7684) loss_oracle 0.5080 (0.5787) acc 65.6250 (61.6071) kd_loss 0.6966 (0.6827) lr 1.4258e-03 eta 0:16:15
epoch [20/50] batch [160/319] time 0.077 (0.098) data 0.000 (0.017) loss 1.9719 (1.9931) ce_loss 0.9531 (1.0224) loss_zs_kd 1.9647 (1.7772) loss_oracle 0.5365 (0.5822) acc 65.6250 (61.6406) kd_loss 0.7505 (0.6796) lr 1.4258e-03 eta 0:15:49
epoch [20/50] batch [180/319] time 0.086 (0.096) data 0.000 (0.015) loss 2.2413 (1.9995) ce_loss 1.2432 (1.0298) loss_zs_kd 1.8442 (1.7807) loss_oracle 0.6377 (0.5858) acc 46.8750 (61.2674) kd_loss 0.6792 (0.6768) lr 1.4258e-03 eta 0:15:30
epoch [20/50] batch [200/319] time 0.088 (0.095) data 0.000 (0.013) loss 2.0941 (1.9991) ce_loss 1.0371 (1.0291) loss_zs_kd 2.0285 (1.7792) loss_oracle 0.6705 (0.5865) acc 68.7500 (61.1562) kd_loss 0.7218 (0.6767) lr 1.4258e-03 eta 0:15:21
epoch [20/50] batch [220/319] time 0.086 (0.094) data 0.000 (0.012) loss 2.0926 (2.0005) ce_loss 1.0400 (1.0289) loss_zs_kd 1.7957 (1.7828) loss_oracle 0.5854 (0.5860) acc 68.7500 (61.2216) kd_loss 0.7598 (0.6786) lr 1.4258e-03 eta 0:15:07
epoch [20/50] batch [240/319] time 0.081 (0.093) data 0.000 (0.011) loss 1.9981 (2.0021) ce_loss 1.1250 (1.0324) loss_zs_kd 1.5972 (1.7781) loss_oracle 0.5437 (0.5851) acc 56.2500 (61.1328) kd_loss 0.6012 (0.6771) lr 1.4258e-03 eta 0:14:58
epoch [20/50] batch [260/319] time 0.080 (0.092) data 0.000 (0.010) loss 1.9624 (1.9988) ce_loss 0.9922 (1.0271) loss_zs_kd 1.5441 (1.7711) loss_oracle 0.6124 (0.5872) acc 65.6250 (61.5024) kd_loss 0.6640 (0.6781) lr 1.4258e-03 eta 0:14:50
epoch [20/50] batch [280/319] time 0.080 (0.092) data 0.000 (0.010) loss 2.0448 (2.0020) ce_loss 1.0879 (1.0294) loss_zs_kd 1.8239 (1.7656) loss_oracle 0.6454 (0.5888) acc 65.6250 (61.4621) kd_loss 0.6342 (0.6782) lr 1.4258e-03 eta 0:14:40
epoch [20/50] batch [300/319] time 0.083 (0.091) data 0.000 (0.009) loss 1.9425 (2.0054) ce_loss 0.9976 (1.0309) loss_zs_kd 2.0853 (1.7639) loss_oracle 0.5749 (0.5896) acc 62.5000 (61.4896) kd_loss 0.6574 (0.6797) lr 1.4258e-03 eta 0:14:35
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,902
* accuracy: 66.3%
* error: 33.7%
* macro_f1: 59.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,686
* accuracy: 58.4%
* error: 41.6%
* macro_f1: 25.2%
******* Domain 2 best val acc:      67.0%, epoch: 18 *******
******* Domain 2 best val test acc: 55.6%, epoch: 18 *******
******* Domain 2 best test acc:     59.6%, epoch: 15 *******
epoch [21/50] batch [20/319] time 0.077 (0.175) data 0.000 (0.091) loss 1.9809 (1.9535) ce_loss 1.0654 (0.9858) loss_zs_kd 2.0606 (1.9172) loss_oracle 0.5942 (0.6099) acc 53.1250 (61.5625) kd_loss 0.6183 (0.6627) lr 1.3681e-03 eta 0:27:49
epoch [21/50] batch [40/319] time 0.081 (0.129) data 0.000 (0.046) loss 2.1139 (1.9829) ce_loss 1.1270 (1.0179) loss_zs_kd 1.5688 (1.8425) loss_oracle 0.6103 (0.6159) acc 62.5000 (61.3281) kd_loss 0.6818 (0.6570) lr 1.3681e-03 eta 0:20:28
epoch [21/50] batch [60/319] time 0.085 (0.114) data 0.000 (0.031) loss 1.8380 (1.9789) ce_loss 0.9258 (1.0195) loss_zs_kd 2.0503 (1.8392) loss_oracle 0.5936 (0.6094) acc 75.0000 (61.7708) kd_loss 0.6154 (0.6547) lr 1.3681e-03 eta 0:18:08
epoch [21/50] batch [80/319] time 0.087 (0.108) data 0.000 (0.023) loss 1.6417 (1.9812) ce_loss 0.7134 (1.0247) loss_zs_kd 1.4999 (1.8008) loss_oracle 0.6768 (0.6082) acc 81.2500 (61.2500) kd_loss 0.5899 (0.6525) lr 1.3681e-03 eta 0:17:00
epoch [21/50] batch [100/319] time 0.087 (0.103) data 0.000 (0.018) loss 1.8279 (1.9767) ce_loss 0.9077 (1.0287) loss_zs_kd 1.8616 (1.7753) loss_oracle 0.6413 (0.6053) acc 59.3750 (60.7812) kd_loss 0.5996 (0.6453) lr 1.3681e-03 eta 0:16:15
epoch [21/50] batch [120/319] time 0.075 (0.100) data 0.000 (0.015) loss 1.8068 (1.9725) ce_loss 0.8462 (1.0216) loss_zs_kd 1.8144 (1.7825) loss_oracle 0.5609 (0.6030) acc 62.5000 (61.3281) kd_loss 0.6801 (0.6494) lr 1.3681e-03 eta 0:15:41
epoch [21/50] batch [140/319] time 0.080 (0.097) data 0.000 (0.013) loss 2.1156 (1.9667) ce_loss 1.1396 (1.0167) loss_zs_kd 1.7838 (1.7772) loss_oracle 0.5935 (0.5983) acc 59.3750 (61.7857) kd_loss 0.6792 (0.6509) lr 1.3681e-03 eta 0:15:17
epoch [21/50] batch [160/319] time 0.085 (0.095) data 0.000 (0.012) loss 1.9253 (1.9723) ce_loss 0.9600 (1.0231) loss_zs_kd 1.8009 (1.7712) loss_oracle 0.5908 (0.5948) acc 71.8750 (61.7578) kd_loss 0.6699 (0.6519) lr 1.3681e-03 eta 0:14:56
epoch [21/50] batch [180/319] time 0.080 (0.094) data 0.000 (0.010) loss 2.0278 (1.9706) ce_loss 1.0742 (1.0222) loss_zs_kd 1.6784 (1.7694) loss_oracle 0.5366 (0.5916) acc 62.5000 (61.6667) kd_loss 0.6853 (0.6527) lr 1.3681e-03 eta 0:14:40
epoch [21/50] batch [200/319] time 0.075 (0.092) data 0.000 (0.009) loss 2.3609 (1.9722) ce_loss 1.4482 (1.0252) loss_zs_kd 1.9274 (1.7676) loss_oracle 0.5523 (0.5897) acc 56.2500 (61.4844) kd_loss 0.6364 (0.6521) lr 1.3681e-03 eta 0:14:25
epoch [21/50] batch [220/319] time 0.080 (0.091) data 0.000 (0.009) loss 1.9014 (1.9693) ce_loss 0.9795 (1.0237) loss_zs_kd 1.7501 (1.7795) loss_oracle 0.6641 (0.5901) acc 59.3750 (61.7472) kd_loss 0.5899 (0.6506) lr 1.3681e-03 eta 0:14:13
epoch [21/50] batch [240/319] time 0.081 (0.090) data 0.000 (0.008) loss 1.7666 (1.9676) ce_loss 0.8530 (1.0226) loss_zs_kd 1.7626 (1.7773) loss_oracle 0.6129 (0.5902) acc 62.5000 (61.7578) kd_loss 0.6071 (0.6499) lr 1.3681e-03 eta 0:14:03
epoch [21/50] batch [260/319] time 0.087 (0.090) data 0.000 (0.007) loss 1.8554 (1.9740) ce_loss 1.0234 (1.0308) loss_zs_kd 1.9644 (1.7706) loss_oracle 0.5071 (0.5882) acc 62.5000 (61.3822) kd_loss 0.5784 (0.6491) lr 1.3681e-03 eta 0:13:58
epoch [21/50] batch [280/319] time 0.083 (0.090) data 0.000 (0.007) loss 1.9156 (1.9759) ce_loss 0.8809 (1.0335) loss_zs_kd 1.7292 (1.7690) loss_oracle 0.6157 (0.5866) acc 68.7500 (61.3393) kd_loss 0.7268 (0.6491) lr 1.3681e-03 eta 0:13:55
epoch [21/50] batch [300/319] time 0.078 (0.090) data 0.000 (0.006) loss 1.7431 (1.9738) ce_loss 0.8701 (1.0311) loss_zs_kd 1.6829 (1.7633) loss_oracle 0.5585 (0.5856) acc 62.5000 (61.3438) kd_loss 0.5937 (0.6499) lr 1.3681e-03 eta 0:13:50
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,843
* accuracy: 64.9%
* error: 35.1%
* macro_f1: 58.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,499
* accuracy: 56.5%
* error: 43.5%
* macro_f1: 25.0%
******* Domain 2 best val acc:      67.0%, epoch: 18 *******
******* Domain 2 best val test acc: 55.6%, epoch: 18 *******
******* Domain 2 best test acc:     59.6%, epoch: 15 *******
epoch [22/50] batch [20/319] time 0.087 (0.188) data 0.000 (0.096) loss 1.8308 (1.9717) ce_loss 0.8809 (0.9940) loss_zs_kd 2.1227 (1.8010) loss_oracle 0.6162 (0.5832) acc 62.5000 (61.8750) kd_loss 0.6418 (0.6861) lr 1.3090e-03 eta 0:28:58
epoch [22/50] batch [40/319] time 0.083 (0.137) data 0.000 (0.048) loss 1.9189 (1.9628) ce_loss 1.0205 (0.9936) loss_zs_kd 1.9047 (1.8033) loss_oracle 0.5483 (0.5895) acc 59.3750 (61.8750) kd_loss 0.6242 (0.6744) lr 1.3090e-03 eta 0:20:57
epoch [22/50] batch [60/319] time 0.085 (0.119) data 0.000 (0.032) loss 1.7918 (1.9867) ce_loss 0.8818 (1.0107) loss_zs_kd 1.6732 (1.7858) loss_oracle 0.5680 (0.5970) acc 65.6250 (61.2500) kd_loss 0.6260 (0.6775) lr 1.3090e-03 eta 0:18:15
epoch [22/50] batch [80/319] time 0.078 (0.110) data 0.000 (0.024) loss 2.1783 (1.9754) ce_loss 1.3066 (1.0085) loss_zs_kd 1.7610 (1.7896) loss_oracle 0.5849 (0.5952) acc 56.2500 (61.7578) kd_loss 0.5792 (0.6693) lr 1.3090e-03 eta 0:16:49
epoch [22/50] batch [100/319] time 0.076 (0.104) data 0.000 (0.019) loss 1.9276 (1.9780) ce_loss 0.8740 (1.0105) loss_zs_kd 1.6014 (1.7631) loss_oracle 0.6632 (0.5997) acc 56.2500 (61.6562) kd_loss 0.7220 (0.6677) lr 1.3090e-03 eta 0:15:54
epoch [22/50] batch [120/319] time 0.081 (0.101) data 0.000 (0.016) loss 2.4340 (1.9747) ce_loss 1.3877 (1.0087) loss_zs_kd 1.7501 (1.7683) loss_oracle 0.5781 (0.5973) acc 43.7500 (61.8229) kd_loss 0.7572 (0.6674) lr 1.3090e-03 eta 0:15:20
epoch [22/50] batch [140/319] time 0.080 (0.098) data 0.000 (0.014) loss 1.9032 (1.9800) ce_loss 1.0498 (1.0124) loss_zs_kd 1.6210 (1.7840) loss_oracle 0.5383 (0.5953) acc 62.5000 (61.8527) kd_loss 0.5843 (0.6699) lr 1.3090e-03 eta 0:14:49
epoch [22/50] batch [160/319] time 0.081 (0.095) data 0.000 (0.012) loss 2.0206 (1.9907) ce_loss 1.1162 (1.0166) loss_zs_kd 1.7668 (1.7729) loss_oracle 0.5863 (0.5980) acc 65.6250 (61.8555) kd_loss 0.6113 (0.6751) lr 1.3090e-03 eta 0:14:25
epoch [22/50] batch [180/319] time 0.088 (0.094) data 0.000 (0.011) loss 2.4787 (1.9867) ce_loss 1.3730 (1.0106) loss_zs_kd 1.8546 (1.7800) loss_oracle 0.5533 (0.5960) acc 43.7500 (61.9792) kd_loss 0.8290 (0.6781) lr 1.3090e-03 eta 0:14:12
epoch [22/50] batch [200/319] time 0.078 (0.093) data 0.000 (0.010) loss 2.0137 (1.9937) ce_loss 1.0869 (1.0152) loss_zs_kd 1.6486 (1.7763) loss_oracle 0.5064 (0.5946) acc 68.7500 (62.0938) kd_loss 0.6736 (0.6812) lr 1.3090e-03 eta 0:14:02
epoch [22/50] batch [220/319] time 0.087 (0.092) data 0.000 (0.009) loss 1.7260 (1.9956) ce_loss 0.7998 (1.0165) loss_zs_kd 1.7877 (1.7685) loss_oracle 0.5272 (0.5943) acc 68.7500 (62.0028) kd_loss 0.6626 (0.6819) lr 1.3090e-03 eta 0:13:53
epoch [22/50] batch [240/319] time 0.082 (0.092) data 0.000 (0.008) loss 2.2268 (1.9986) ce_loss 1.2178 (1.0144) loss_zs_kd 1.8888 (1.7716) loss_oracle 0.5613 (0.5947) acc 56.2500 (62.0312) kd_loss 0.7283 (0.6868) lr 1.3090e-03 eta 0:13:45
epoch [22/50] batch [260/319] time 0.082 (0.091) data 0.000 (0.008) loss 2.1495 (2.0056) ce_loss 1.0664 (1.0205) loss_zs_kd 1.8490 (1.7771) loss_oracle 0.6851 (0.5950) acc 62.5000 (61.8990) kd_loss 0.7405 (0.6876) lr 1.3090e-03 eta 0:13:39
epoch [22/50] batch [280/319] time 0.084 (0.091) data 0.000 (0.007) loss 1.7816 (2.0037) ce_loss 0.6699 (1.0189) loss_zs_kd 1.9227 (1.7772) loss_oracle 0.6781 (0.5947) acc 84.3750 (61.8192) kd_loss 0.7727 (0.6874) lr 1.3090e-03 eta 0:13:32
epoch [22/50] batch [300/319] time 0.083 (0.090) data 0.000 (0.007) loss 1.9640 (2.0087) ce_loss 0.9609 (1.0230) loss_zs_kd 1.9316 (1.7841) loss_oracle 0.6045 (0.5940) acc 71.8750 (61.7604) kd_loss 0.7008 (0.6887) lr 1.3090e-03 eta 0:13:26
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,950
* accuracy: 67.4%
* error: 32.6%
* macro_f1: 59.7%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,642
* accuracy: 57.9%
* error: 42.1%
* macro_f1: 25.6%
******* Domain 2 best val acc:      67.4%, epoch: 22 *******
******* Domain 2 best val test acc: 57.9%, epoch: 22 *******
******* Domain 2 best test acc:     59.6%, epoch: 15 *******
epoch [23/50] batch [20/319] time 0.080 (0.206) data 0.000 (0.123) loss 2.2385 (2.0301) ce_loss 1.1553 (1.0379) loss_zs_kd 1.5670 (1.7880) loss_oracle 0.5945 (0.5819) acc 59.3750 (62.0312) kd_loss 0.7860 (0.7013) lr 1.2487e-03 eta 0:30:37
epoch [23/50] batch [40/319] time 0.077 (0.145) data 0.000 (0.062) loss 2.0646 (2.0325) ce_loss 0.9409 (1.0408) loss_zs_kd 1.9131 (1.7416) loss_oracle 0.6016 (0.5803) acc 50.0000 (59.8438) kd_loss 0.8229 (0.7016) lr 1.2487e-03 eta 0:21:24
epoch [23/50] batch [60/319] time 0.090 (0.123) data 0.000 (0.041) loss 2.0924 (2.0084) ce_loss 1.0908 (1.0114) loss_zs_kd 1.8332 (1.7521) loss_oracle 0.6268 (0.5845) acc 56.2500 (61.3021) kd_loss 0.6882 (0.7047) lr 1.2487e-03 eta 0:18:15
epoch [23/50] batch [80/319] time 0.084 (0.114) data 0.000 (0.031) loss 1.8379 (2.0130) ce_loss 0.9243 (1.0142) loss_zs_kd 1.8997 (1.7777) loss_oracle 0.5865 (0.5905) acc 68.7500 (61.2891) kd_loss 0.6203 (0.7036) lr 1.2487e-03 eta 0:16:46
epoch [23/50] batch [100/319] time 0.085 (0.108) data 0.000 (0.025) loss 1.7927 (2.0106) ce_loss 0.9146 (1.0150) loss_zs_kd 2.0613 (1.7954) loss_oracle 0.5501 (0.5900) acc 71.8750 (61.3750) kd_loss 0.6031 (0.7006) lr 1.2487e-03 eta 0:15:55
epoch [23/50] batch [120/319] time 0.085 (0.104) data 0.000 (0.021) loss 1.9693 (1.9998) ce_loss 0.9561 (1.0093) loss_zs_kd 1.7750 (1.8016) loss_oracle 0.6456 (0.5869) acc 65.6250 (61.7708) kd_loss 0.6905 (0.6971) lr 1.2487e-03 eta 0:15:12
epoch [23/50] batch [140/319] time 0.085 (0.100) data 0.000 (0.018) loss 1.6508 (2.0032) ce_loss 0.7837 (1.0103) loss_zs_kd 1.6665 (1.8093) loss_oracle 0.5083 (0.5903) acc 78.1250 (62.1205) kd_loss 0.6129 (0.6978) lr 1.2487e-03 eta 0:14:40
epoch [23/50] batch [160/319] time 0.090 (0.098) data 0.000 (0.016) loss 1.9649 (2.0069) ce_loss 0.9463 (1.0139) loss_zs_kd 1.9829 (1.8100) loss_oracle 0.6461 (0.5910) acc 62.5000 (61.9922) kd_loss 0.6956 (0.6974) lr 1.2487e-03 eta 0:14:16
epoch [23/50] batch [180/319] time 0.092 (0.097) data 0.000 (0.014) loss 2.1180 (2.0057) ce_loss 1.0742 (1.0150) loss_zs_kd 1.7302 (1.8117) loss_oracle 0.6628 (0.5907) acc 40.6250 (61.6319) kd_loss 0.7124 (0.6954) lr 1.2487e-03 eta 0:14:05
epoch [23/50] batch [200/319] time 0.085 (0.095) data 0.000 (0.013) loss 1.6610 (2.0051) ce_loss 0.6440 (1.0158) loss_zs_kd 1.7092 (1.8088) loss_oracle 0.6300 (0.5944) acc 78.1250 (61.8281) kd_loss 0.7019 (0.6921) lr 1.2487e-03 eta 0:13:53
epoch [23/50] batch [220/319] time 0.089 (0.094) data 0.000 (0.011) loss 2.3574 (2.0056) ce_loss 1.3447 (1.0170) loss_zs_kd 1.9813 (1.8141) loss_oracle 0.6037 (0.5947) acc 50.0000 (61.7756) kd_loss 0.7108 (0.6912) lr 1.2487e-03 eta 0:13:42
epoch [23/50] batch [240/319] time 0.078 (0.094) data 0.000 (0.011) loss 2.0587 (2.0108) ce_loss 1.0605 (1.0247) loss_zs_kd 1.9751 (1.8093) loss_oracle 0.6570 (0.5942) acc 62.5000 (61.5625) kd_loss 0.6696 (0.6890) lr 1.2487e-03 eta 0:13:34
epoch [23/50] batch [260/319] time 0.083 (0.093) data 0.000 (0.010) loss 2.0184 (2.0135) ce_loss 1.0146 (1.0272) loss_zs_kd 1.7723 (1.8095) loss_oracle 0.6053 (0.5941) acc 65.6250 (61.2981) kd_loss 0.7011 (0.6893) lr 1.2487e-03 eta 0:13:28
epoch [23/50] batch [280/319] time 0.085 (0.092) data 0.000 (0.009) loss 1.9126 (2.0126) ce_loss 0.8301 (1.0263) loss_zs_kd 1.8907 (1.8111) loss_oracle 0.6527 (0.5924) acc 75.0000 (61.3951) kd_loss 0.7562 (0.6902) lr 1.2487e-03 eta 0:13:20
epoch [23/50] batch [300/319] time 0.080 (0.092) data 0.000 (0.008) loss 1.9414 (2.0105) ce_loss 1.0098 (1.0257) loss_zs_kd 1.9608 (1.8088) loss_oracle 0.5854 (0.5922) acc 62.5000 (61.3542) kd_loss 0.6389 (0.6887) lr 1.2487e-03 eta 0:13:13
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,879
* accuracy: 65.8%
* error: 34.2%
* macro_f1: 59.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,483
* accuracy: 56.3%
* error: 43.7%
* macro_f1: 25.9%
******* Domain 2 best val acc:      67.4%, epoch: 22 *******
******* Domain 2 best val test acc: 57.9%, epoch: 22 *******
******* Domain 2 best test acc:     59.6%, epoch: 15 *******
epoch [24/50] batch [20/319] time 0.094 (0.189) data 0.000 (0.102) loss 1.8662 (2.0235) ce_loss 0.9204 (1.0611) loss_zs_kd 1.8674 (1.8367) loss_oracle 0.6869 (0.6143) acc 62.5000 (60.7812) kd_loss 0.6023 (0.6552) lr 1.1874e-03 eta 0:27:00
epoch [24/50] batch [40/319] time 0.078 (0.135) data 0.000 (0.051) loss 2.3786 (2.0022) ce_loss 1.3291 (1.0348) loss_zs_kd 1.7250 (1.8224) loss_oracle 0.6428 (0.6110) acc 53.1250 (61.0938) kd_loss 0.7280 (0.6619) lr 1.1874e-03 eta 0:19:15
epoch [24/50] batch [60/319] time 0.088 (0.117) data 0.000 (0.034) loss 2.2397 (2.0365) ce_loss 1.0742 (1.0550) loss_zs_kd 2.0411 (1.8367) loss_oracle 0.6892 (0.6128) acc 59.3750 (60.7812) kd_loss 0.8209 (0.6752) lr 1.1874e-03 eta 0:16:44
epoch [24/50] batch [80/319] time 0.076 (0.108) data 0.000 (0.026) loss 1.9244 (2.0241) ce_loss 1.0977 (1.0462) loss_zs_kd 2.0768 (1.8399) loss_oracle 0.5813 (0.6058) acc 53.1250 (60.8594) kd_loss 0.5361 (0.6750) lr 1.1874e-03 eta 0:15:22
epoch [24/50] batch [100/319] time 0.091 (0.104) data 0.000 (0.021) loss 2.4565 (2.0232) ce_loss 1.4111 (1.0457) loss_zs_kd 2.0634 (1.8442) loss_oracle 0.6935 (0.6050) acc 46.8750 (60.7500) kd_loss 0.6986 (0.6749) lr 1.1874e-03 eta 0:14:41
epoch [24/50] batch [120/319] time 0.089 (0.100) data 0.000 (0.017) loss 2.0199 (2.0273) ce_loss 1.0732 (1.0517) loss_zs_kd 2.0354 (1.8592) loss_oracle 0.6185 (0.6032) acc 59.3750 (60.6771) kd_loss 0.6374 (0.6741) lr 1.1874e-03 eta 0:14:11
epoch [24/50] batch [140/319] time 0.093 (0.098) data 0.000 (0.015) loss 2.0614 (2.0217) ce_loss 0.9839 (1.0449) loss_zs_kd 2.0105 (1.8518) loss_oracle 0.6891 (0.5996) acc 71.8750 (60.9598) kd_loss 0.7330 (0.6770) lr 1.1874e-03 eta 0:13:50
epoch [24/50] batch [160/319] time 0.086 (0.097) data 0.000 (0.013) loss 2.2596 (2.0170) ce_loss 1.2412 (1.0394) loss_zs_kd 1.6371 (1.8534) loss_oracle 0.7412 (0.6018) acc 56.2500 (61.0547) kd_loss 0.6477 (0.6767) lr 1.1874e-03 eta 0:13:43
epoch [24/50] batch [180/319] time 0.077 (0.096) data 0.000 (0.012) loss 2.1192 (2.0210) ce_loss 1.1982 (1.0431) loss_zs_kd 1.9224 (1.8678) loss_oracle 0.5713 (0.6007) acc 59.3750 (60.6424) kd_loss 0.6353 (0.6775) lr 1.1874e-03 eta 0:13:32
epoch [24/50] batch [200/319] time 0.080 (0.095) data 0.000 (0.010) loss 2.0614 (2.0196) ce_loss 1.0186 (1.0396) loss_zs_kd 1.8865 (1.8660) loss_oracle 0.5650 (0.6006) acc 62.5000 (60.9531) kd_loss 0.7604 (0.6797) lr 1.1874e-03 eta 0:13:17
epoch [24/50] batch [220/319] time 0.088 (0.094) data 0.000 (0.010) loss 2.1612 (2.0188) ce_loss 1.1611 (1.0393) loss_zs_kd 1.9494 (1.8571) loss_oracle 0.5818 (0.6001) acc 62.5000 (61.0227) kd_loss 0.7092 (0.6795) lr 1.1874e-03 eta 0:13:08
epoch [24/50] batch [240/319] time 0.082 (0.093) data 0.000 (0.009) loss 2.2380 (2.0135) ce_loss 1.3496 (1.0361) loss_zs_kd 1.9748 (1.8597) loss_oracle 0.6027 (0.5980) acc 43.7500 (61.1068) kd_loss 0.5870 (0.6785) lr 1.1874e-03 eta 0:13:00
epoch [24/50] batch [260/319] time 0.084 (0.092) data 0.001 (0.008) loss 2.0987 (2.0129) ce_loss 1.1924 (1.0364) loss_zs_kd 1.5797 (1.8541) loss_oracle 0.5466 (0.5963) acc 53.1250 (61.0938) kd_loss 0.6331 (0.6784) lr 1.1874e-03 eta 0:12:52
epoch [24/50] batch [280/319] time 0.085 (0.092) data 0.000 (0.008) loss 2.1881 (2.0128) ce_loss 1.2041 (1.0373) loss_zs_kd 1.7748 (1.8556) loss_oracle 0.6553 (0.5962) acc 43.7500 (61.1719) kd_loss 0.6563 (0.6775) lr 1.1874e-03 eta 0:12:45
epoch [24/50] batch [300/319] time 0.078 (0.091) data 0.000 (0.007) loss 1.8327 (2.0094) ce_loss 0.9629 (1.0346) loss_zs_kd 1.9757 (1.8529) loss_oracle 0.5167 (0.5971) acc 68.7500 (61.3958) kd_loss 0.6115 (0.6762) lr 1.1874e-03 eta 0:12:38
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,921
* accuracy: 66.7%
* error: 33.3%
* macro_f1: 58.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,197
* accuracy: 53.4%
* error: 46.6%
* macro_f1: 24.1%
******* Domain 2 best val acc:      67.4%, epoch: 22 *******
******* Domain 2 best val test acc: 57.9%, epoch: 22 *******
******* Domain 2 best test acc:     59.6%, epoch: 15 *******
epoch [25/50] batch [20/319] time 0.081 (0.187) data 0.000 (0.099) loss 1.9650 (1.9767) ce_loss 0.9985 (1.0330) loss_zs_kd 1.7510 (1.7418) loss_oracle 0.6243 (0.5920) acc 56.2500 (60.7812) kd_loss 0.6543 (0.6478) lr 1.1253e-03 eta 0:25:44
epoch [25/50] batch [40/319] time 0.087 (0.136) data 0.000 (0.049) loss 2.1530 (2.0050) ce_loss 1.2178 (1.0481) loss_zs_kd 1.6393 (1.8218) loss_oracle 0.5614 (0.5995) acc 53.1250 (61.0156) kd_loss 0.6545 (0.6572) lr 1.1253e-03 eta 0:18:44
epoch [25/50] batch [60/319] time 0.082 (0.120) data 0.000 (0.033) loss 2.2060 (2.0017) ce_loss 1.1113 (1.0397) loss_zs_kd 1.9977 (1.8126) loss_oracle 0.7846 (0.6026) acc 59.3750 (60.5208) kd_loss 0.7024 (0.6607) lr 1.1253e-03 eta 0:16:24
epoch [25/50] batch [80/319] time 0.081 (0.111) data 0.000 (0.025) loss 1.9940 (2.0029) ce_loss 0.9307 (1.0362) loss_zs_kd 1.8585 (1.8184) loss_oracle 0.5958 (0.6022) acc 68.7500 (61.2500) kd_loss 0.7655 (0.6656) lr 1.1253e-03 eta 0:15:12
epoch [25/50] batch [100/319] time 0.083 (0.106) data 0.000 (0.020) loss 2.2563 (1.9905) ce_loss 1.2393 (1.0293) loss_zs_kd 1.7943 (1.8143) loss_oracle 0.5852 (0.5979) acc 56.2500 (61.7812) kd_loss 0.7244 (0.6622) lr 1.1253e-03 eta 0:14:28
epoch [25/50] batch [120/319] time 0.087 (0.102) data 0.000 (0.017) loss 1.9018 (1.9971) ce_loss 0.9487 (1.0342) loss_zs_kd 2.1736 (1.8192) loss_oracle 0.5635 (0.5984) acc 59.3750 (61.9531) kd_loss 0.6713 (0.6637) lr 1.1253e-03 eta 0:13:56
epoch [25/50] batch [140/319] time 0.084 (0.100) data 0.000 (0.014) loss 1.9309 (1.9935) ce_loss 1.0156 (1.0298) loss_zs_kd 1.9470 (1.8280) loss_oracle 0.6085 (0.6017) acc 59.3750 (62.0089) kd_loss 0.6110 (0.6628) lr 1.1253e-03 eta 0:13:32
epoch [25/50] batch [160/319] time 0.078 (0.098) data 0.000 (0.013) loss 2.1007 (1.9945) ce_loss 1.0420 (1.0315) loss_zs_kd 2.0564 (1.8363) loss_oracle 0.5827 (0.6032) acc 75.0000 (62.1094) kd_loss 0.7674 (0.6614) lr 1.1253e-03 eta 0:13:13
epoch [25/50] batch [180/319] time 0.086 (0.096) data 0.000 (0.011) loss 1.8168 (1.9906) ce_loss 0.9883 (1.0262) loss_zs_kd 1.6385 (1.8441) loss_oracle 0.5783 (0.6048) acc 59.3750 (62.2743) kd_loss 0.5393 (0.6620) lr 1.1253e-03 eta 0:12:58
epoch [25/50] batch [200/319] time 0.083 (0.095) data 0.000 (0.010) loss 1.8762 (1.9868) ce_loss 1.1152 (1.0231) loss_zs_kd 1.9015 (1.8533) loss_oracle 0.4851 (0.6061) acc 56.2500 (62.3750) kd_loss 0.5185 (0.6607) lr 1.1253e-03 eta 0:12:47
epoch [25/50] batch [220/319] time 0.088 (0.094) data 0.000 (0.009) loss 1.8612 (1.9861) ce_loss 0.9492 (1.0255) loss_zs_kd 1.6912 (1.8507) loss_oracle 0.5138 (0.6028) acc 53.1250 (62.3295) kd_loss 0.6551 (0.6592) lr 1.1253e-03 eta 0:12:38
epoch [25/50] batch [240/319] time 0.076 (0.093) data 0.000 (0.008) loss 2.0974 (1.9789) ce_loss 1.1768 (1.0197) loss_zs_kd 1.9443 (1.8539) loss_oracle 0.5582 (0.6011) acc 50.0000 (62.5651) kd_loss 0.6416 (0.6587) lr 1.1253e-03 eta 0:12:27
epoch [25/50] batch [260/319] time 0.081 (0.092) data 0.000 (0.008) loss 1.9996 (1.9768) ce_loss 1.1318 (1.0210) loss_zs_kd 1.8747 (1.8553) loss_oracle 0.5273 (0.5986) acc 53.1250 (62.3077) kd_loss 0.6041 (0.6565) lr 1.1253e-03 eta 0:12:19
epoch [25/50] batch [280/319] time 0.082 (0.092) data 0.000 (0.007) loss 2.1868 (1.9776) ce_loss 1.2285 (1.0220) loss_zs_kd 1.7250 (1.8556) loss_oracle 0.6041 (0.5971) acc 43.7500 (62.1763) kd_loss 0.6562 (0.6572) lr 1.1253e-03 eta 0:12:15
epoch [25/50] batch [300/319] time 0.084 (0.091) data 0.000 (0.007) loss 1.8951 (1.9769) ce_loss 1.0283 (1.0240) loss_zs_kd 1.8479 (1.8492) loss_oracle 0.5736 (0.5939) acc 68.7500 (62.1042) kd_loss 0.5800 (0.6560) lr 1.1253e-03 eta 0:12:08
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,971
* accuracy: 67.9%
* error: 32.1%
* macro_f1: 60.1%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,499
* accuracy: 56.5%
* error: 43.5%
* macro_f1: 24.8%
******* Domain 2 best val acc:      67.9%, epoch: 25 *******
******* Domain 2 best val test acc: 56.5%, epoch: 25 *******
******* Domain 2 best test acc:     59.6%, epoch: 15 *******
epoch [26/50] batch [20/319] time 0.081 (0.207) data 0.000 (0.119) loss 2.0130 (2.0248) ce_loss 1.1631 (1.0996) loss_zs_kd 1.6446 (1.8455) loss_oracle 0.5462 (0.5524) acc 50.0000 (56.8750) kd_loss 0.5768 (0.6490) lr 1.0628e-03 eta 0:27:24
epoch [26/50] batch [40/319] time 0.084 (0.145) data 0.000 (0.060) loss 1.8260 (1.9970) ce_loss 0.9209 (1.0612) loss_zs_kd 1.8216 (1.8423) loss_oracle 0.5308 (0.5603) acc 62.5000 (58.2812) kd_loss 0.6397 (0.6556) lr 1.0628e-03 eta 0:19:12
epoch [26/50] batch [60/319] time 0.080 (0.125) data 0.000 (0.040) loss 1.9485 (1.9793) ce_loss 0.9839 (1.0376) loss_zs_kd 1.6473 (1.8153) loss_oracle 0.6387 (0.5748) acc 62.5000 (59.5312) kd_loss 0.6453 (0.6543) lr 1.0628e-03 eta 0:16:29
epoch [26/50] batch [80/319] time 0.077 (0.115) data 0.000 (0.030) loss 1.9097 (1.9785) ce_loss 1.0605 (1.0426) loss_zs_kd 2.0501 (1.8195) loss_oracle 0.5425 (0.5693) acc 62.5000 (59.8047) kd_loss 0.5779 (0.6513) lr 1.0628e-03 eta 0:15:05
epoch [26/50] batch [100/319] time 0.092 (0.109) data 0.001 (0.024) loss 1.8553 (1.9763) ce_loss 0.9712 (1.0411) loss_zs_kd 1.8239 (1.8233) loss_oracle 0.5785 (0.5689) acc 65.6250 (60.5625) kd_loss 0.5948 (0.6508) lr 1.0628e-03 eta 0:14:16
epoch [26/50] batch [120/319] time 0.085 (0.105) data 0.000 (0.020) loss 1.8986 (1.9723) ce_loss 1.1143 (1.0337) loss_zs_kd 1.8344 (1.8289) loss_oracle 0.5666 (0.5728) acc 53.1250 (60.9115) kd_loss 0.5010 (0.6521) lr 1.0628e-03 eta 0:13:41
epoch [26/50] batch [140/319] time 0.087 (0.102) data 0.000 (0.017) loss 2.0587 (1.9709) ce_loss 1.0371 (1.0301) loss_zs_kd 1.9111 (1.8332) loss_oracle 0.6123 (0.5732) acc 62.5000 (60.9598) kd_loss 0.7154 (0.6542) lr 1.0628e-03 eta 0:13:17
epoch [26/50] batch [160/319] time 0.081 (0.099) data 0.000 (0.015) loss 1.7407 (1.9655) ce_loss 0.8657 (1.0242) loss_zs_kd 1.7907 (1.8282) loss_oracle 0.5048 (0.5714) acc 81.2500 (61.2305) kd_loss 0.6225 (0.6556) lr 1.0628e-03 eta 0:12:56
epoch [26/50] batch [180/319] time 0.080 (0.097) data 0.000 (0.014) loss 1.8145 (1.9659) ce_loss 0.8765 (1.0255) loss_zs_kd 1.9303 (1.8365) loss_oracle 0.6854 (0.5738) acc 65.6250 (61.4062) kd_loss 0.5954 (0.6535) lr 1.0628e-03 eta 0:12:37
epoch [26/50] batch [200/319] time 0.086 (0.096) data 0.000 (0.012) loss 2.3012 (1.9644) ce_loss 1.2842 (1.0242) loss_zs_kd 1.6528 (1.8406) loss_oracle 0.5973 (0.5749) acc 53.1250 (61.3281) kd_loss 0.7184 (0.6527) lr 1.0628e-03 eta 0:12:22
epoch [26/50] batch [220/319] time 0.090 (0.095) data 0.000 (0.011) loss 1.7866 (1.9667) ce_loss 0.7383 (1.0264) loss_zs_kd 1.7699 (1.8539) loss_oracle 0.6070 (0.5777) acc 65.6250 (61.3068) kd_loss 0.7448 (0.6514) lr 1.0628e-03 eta 0:12:13
epoch [26/50] batch [240/319] time 0.089 (0.094) data 0.000 (0.010) loss 1.9349 (1.9659) ce_loss 1.0205 (1.0277) loss_zs_kd 2.0220 (1.8535) loss_oracle 0.5034 (0.5787) acc 59.3750 (61.1198) kd_loss 0.6626 (0.6488) lr 1.0628e-03 eta 0:12:03
epoch [26/50] batch [260/319] time 0.072 (0.093) data 0.000 (0.009) loss 1.9096 (1.9621) ce_loss 0.8657 (1.0239) loss_zs_kd 1.8129 (1.8621) loss_oracle 0.7255 (0.5802) acc 65.6250 (61.3582) kd_loss 0.6811 (0.6481) lr 1.0628e-03 eta 0:11:53
epoch [26/50] batch [280/319] time 0.083 (0.092) data 0.000 (0.009) loss 1.9369 (1.9650) ce_loss 0.9434 (1.0270) loss_zs_kd 1.7771 (1.8677) loss_oracle 0.6456 (0.5814) acc 62.5000 (61.3504) kd_loss 0.6708 (0.6473) lr 1.0628e-03 eta 0:11:45
epoch [26/50] batch [300/319] time 0.081 (0.091) data 0.000 (0.008) loss 2.5802 (1.9699) ce_loss 1.6309 (1.0318) loss_zs_kd 2.0475 (1.8698) loss_oracle 0.6260 (0.5827) acc 37.5000 (61.0833) kd_loss 0.6363 (0.6468) lr 1.0628e-03 eta 0:11:39
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,975
* accuracy: 68.0%
* error: 32.0%
* macro_f1: 60.5%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,468
* accuracy: 56.2%
* error: 43.8%
* macro_f1: 25.3%
******* Domain 2 best val acc:      68.0%, epoch: 26 *******
******* Domain 2 best val test acc: 56.2%, epoch: 26 *******
******* Domain 2 best test acc:     59.6%, epoch: 15 *******
epoch [27/50] batch [20/319] time 0.074 (0.217) data 0.000 (0.142) loss 1.7941 (1.9584) ce_loss 0.8716 (1.0258) loss_zs_kd 1.5007 (1.8390) loss_oracle 0.5709 (0.5910) acc 71.8750 (62.1875) kd_loss 0.6371 (0.6371) lr 1.0000e-03 eta 0:27:39
epoch [27/50] batch [40/319] time 0.075 (0.147) data 0.000 (0.071) loss 1.6744 (1.9572) ce_loss 0.7378 (1.0212) loss_zs_kd 2.0575 (1.8204) loss_oracle 0.5751 (0.5802) acc 71.8750 (61.4844) kd_loss 0.6491 (0.6459) lr 1.0000e-03 eta 0:18:38
epoch [27/50] batch [60/319] time 0.082 (0.125) data 0.000 (0.047) loss 1.8805 (1.9266) ce_loss 0.9341 (0.9944) loss_zs_kd 1.9362 (1.8338) loss_oracle 0.5106 (0.5867) acc 71.8750 (62.3438) kd_loss 0.6911 (0.6388) lr 1.0000e-03 eta 0:15:50
epoch [27/50] batch [80/319] time 0.079 (0.115) data 0.000 (0.036) loss 2.1011 (1.9210) ce_loss 1.2988 (0.9946) loss_zs_kd 1.9468 (1.8226) loss_oracle 0.5280 (0.5842) acc 53.1250 (62.5000) kd_loss 0.5383 (0.6343) lr 1.0000e-03 eta 0:14:30
epoch [27/50] batch [100/319] time 0.094 (0.109) data 0.000 (0.029) loss 1.7555 (1.9234) ce_loss 0.8418 (0.9907) loss_zs_kd 1.9814 (1.8588) loss_oracle 0.6546 (0.5911) acc 68.7500 (62.4375) kd_loss 0.5864 (0.6372) lr 1.0000e-03 eta 0:13:44
epoch [27/50] batch [120/319] time 0.082 (0.104) data 0.000 (0.024) loss 1.8612 (1.9322) ce_loss 0.9609 (0.9952) loss_zs_kd 1.8741 (1.8784) loss_oracle 0.5557 (0.5922) acc 62.5000 (62.2656) kd_loss 0.6224 (0.6409) lr 1.0000e-03 eta 0:13:07
epoch [27/50] batch [140/319] time 0.087 (0.101) data 0.000 (0.021) loss 1.9149 (1.9418) ce_loss 0.9834 (0.9987) loss_zs_kd 1.9137 (1.8866) loss_oracle 0.6740 (0.5936) acc 59.3750 (62.1205) kd_loss 0.5945 (0.6462) lr 1.0000e-03 eta 0:12:41
epoch [27/50] batch [160/319] time 0.088 (0.098) data 0.000 (0.018) loss 1.9052 (1.9469) ce_loss 0.7744 (0.9952) loss_zs_kd 1.6457 (1.8888) loss_oracle 0.6674 (0.5948) acc 71.8750 (62.3242) kd_loss 0.7971 (0.6544) lr 1.0000e-03 eta 0:12:17
epoch [27/50] batch [180/319] time 0.081 (0.097) data 0.000 (0.016) loss 1.9289 (1.9557) ce_loss 0.8716 (0.9975) loss_zs_kd 1.7907 (1.8834) loss_oracle 0.5878 (0.5972) acc 68.7500 (62.2569) kd_loss 0.7634 (0.6596) lr 1.0000e-03 eta 0:12:02
epoch [27/50] batch [200/319] time 0.083 (0.096) data 0.000 (0.014) loss 1.7946 (1.9609) ce_loss 0.7363 (0.9995) loss_zs_kd 2.0464 (1.8931) loss_oracle 0.6103 (0.5966) acc 75.0000 (62.4062) kd_loss 0.7531 (0.6631) lr 1.0000e-03 eta 0:11:53
epoch [27/50] batch [220/319] time 0.080 (0.094) data 0.000 (0.013) loss 1.9919 (1.9661) ce_loss 1.0908 (1.0017) loss_zs_kd 1.8251 (1.8921) loss_oracle 0.5292 (0.5956) acc 53.1250 (62.3295) kd_loss 0.6365 (0.6666) lr 1.0000e-03 eta 0:11:40
epoch [27/50] batch [240/319] time 0.082 (0.093) data 0.000 (0.012) loss 2.1527 (1.9712) ce_loss 1.1660 (1.0066) loss_zs_kd 1.9666 (1.8965) loss_oracle 0.7082 (0.5945) acc 56.2500 (62.3438) kd_loss 0.6326 (0.6673) lr 1.0000e-03 eta 0:11:29
epoch [27/50] batch [260/319] time 0.071 (0.092) data 0.000 (0.011) loss 1.9278 (1.9725) ce_loss 0.9434 (1.0072) loss_zs_kd 1.9822 (1.8961) loss_oracle 0.5866 (0.5926) acc 68.7500 (62.5000) kd_loss 0.6911 (0.6690) lr 1.0000e-03 eta 0:11:18
epoch [27/50] batch [280/319] time 0.075 (0.091) data 0.000 (0.010) loss 2.3746 (1.9759) ce_loss 1.4395 (1.0113) loss_zs_kd 2.0731 (1.8974) loss_oracle 0.5717 (0.5918) acc 37.5000 (62.3549) kd_loss 0.6494 (0.6686) lr 1.0000e-03 eta 0:11:09
epoch [27/50] batch [300/319] time 0.082 (0.090) data 0.000 (0.010) loss 2.2058 (1.9740) ce_loss 1.3096 (1.0105) loss_zs_kd 2.1379 (1.8950) loss_oracle 0.6315 (0.5922) acc 56.2500 (62.3958) kd_loss 0.5805 (0.6674) lr 1.0000e-03 eta 0:11:04
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,958
* accuracy: 67.6%
* error: 32.4%
* macro_f1: 60.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,839
* accuracy: 60.0%
* error: 40.0%
* macro_f1: 28.4%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 2 best val acc:      68.0%, epoch: 26 *******
******* Domain 2 best val test acc: 56.2%, epoch: 26 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [28/50] batch [20/319] time 0.096 (0.174) data 0.001 (0.088) loss 1.9356 (1.9507) ce_loss 0.9629 (0.9921) loss_zs_kd 2.0185 (1.9340) loss_oracle 0.6180 (0.5731) acc 75.0000 (61.5625) kd_loss 0.6637 (0.6721) lr 9.3721e-04 eta 0:21:16
epoch [28/50] batch [40/319] time 0.079 (0.131) data 0.000 (0.044) loss 2.0857 (1.9575) ce_loss 1.1670 (0.9878) loss_zs_kd 2.1368 (1.8946) loss_oracle 0.4694 (0.5733) acc 56.2500 (61.8750) kd_loss 0.6841 (0.6831) lr 9.3721e-04 eta 0:15:53
epoch [28/50] batch [60/319] time 0.087 (0.116) data 0.000 (0.030) loss 1.9735 (1.9959) ce_loss 0.9756 (1.0183) loss_zs_kd 1.9574 (1.9341) loss_oracle 0.5860 (0.5873) acc 62.5000 (60.8854) kd_loss 0.7049 (0.6839) lr 9.3721e-04 eta 0:14:04
epoch [28/50] batch [80/319] time 0.091 (0.108) data 0.000 (0.022) loss 2.0873 (1.9818) ce_loss 1.0752 (1.0030) loss_zs_kd 1.7130 (1.9074) loss_oracle 0.5686 (0.5903) acc 50.0000 (61.6797) kd_loss 0.7278 (0.6836) lr 9.3721e-04 eta 0:13:06
epoch [28/50] batch [100/319] time 0.086 (0.104) data 0.000 (0.018) loss 2.0645 (1.9921) ce_loss 1.0332 (1.0104) loss_zs_kd 1.9178 (1.9176) loss_oracle 0.6192 (0.5887) acc 53.1250 (61.8125) kd_loss 0.7216 (0.6874) lr 9.3721e-04 eta 0:12:30
epoch [28/50] batch [120/319] time 0.083 (0.101) data 0.000 (0.015) loss 1.9552 (1.9891) ce_loss 0.9810 (1.0076) loss_zs_kd 1.9157 (1.9087) loss_oracle 0.5446 (0.5840) acc 65.6250 (61.9271) kd_loss 0.7020 (0.6895) lr 9.3721e-04 eta 0:12:05
epoch [28/50] batch [140/319] time 0.079 (0.098) data 0.000 (0.013) loss 1.9396 (1.9915) ce_loss 0.9443 (1.0113) loss_zs_kd 1.9729 (1.8876) loss_oracle 0.5848 (0.5805) acc 65.6250 (61.8750) kd_loss 0.7028 (0.6899) lr 9.3721e-04 eta 0:11:43
epoch [28/50] batch [160/319] time 0.074 (0.096) data 0.000 (0.011) loss 1.6942 (1.9852) ce_loss 0.7695 (1.0080) loss_zs_kd 2.0205 (1.8723) loss_oracle 0.5569 (0.5808) acc 65.6250 (62.1875) kd_loss 0.6463 (0.6868) lr 9.3721e-04 eta 0:11:25
epoch [28/50] batch [180/319] time 0.076 (0.094) data 0.000 (0.010) loss 1.8164 (1.9739) ce_loss 0.9004 (1.0016) loss_zs_kd 1.9803 (1.8738) loss_oracle 0.6089 (0.5789) acc 68.7500 (62.5174) kd_loss 0.6115 (0.6828) lr 9.3721e-04 eta 0:11:09
epoch [28/50] batch [200/319] time 0.080 (0.092) data 0.000 (0.009) loss 2.1658 (1.9733) ce_loss 1.1377 (1.0054) loss_zs_kd 1.9973 (1.8811) loss_oracle 0.5694 (0.5786) acc 40.6250 (62.5625) kd_loss 0.7435 (0.6786) lr 9.3721e-04 eta 0:10:57
epoch [28/50] batch [220/319] time 0.077 (0.091) data 0.000 (0.008) loss 2.0389 (1.9738) ce_loss 1.1504 (1.0077) loss_zs_kd 1.8000 (1.8911) loss_oracle 0.5681 (0.5777) acc 50.0000 (62.3580) kd_loss 0.6044 (0.6773) lr 9.3721e-04 eta 0:10:48
epoch [28/50] batch [240/319] time 0.076 (0.090) data 0.001 (0.008) loss 2.1760 (1.9733) ce_loss 1.1279 (1.0079) loss_zs_kd 1.8949 (1.8987) loss_oracle 0.5218 (0.5762) acc 59.3750 (62.1484) kd_loss 0.7872 (0.6773) lr 9.3721e-04 eta 0:10:38
epoch [28/50] batch [260/319] time 0.070 (0.089) data 0.000 (0.007) loss 1.7900 (1.9714) ce_loss 0.8804 (1.0060) loss_zs_kd 1.9162 (1.8998) loss_oracle 0.5600 (0.5774) acc 75.0000 (62.4038) kd_loss 0.6296 (0.6767) lr 9.3721e-04 eta 0:10:28
epoch [28/50] batch [280/319] time 0.084 (0.088) data 0.000 (0.007) loss 1.7996 (1.9711) ce_loss 0.8389 (1.0057) loss_zs_kd 1.9861 (1.8961) loss_oracle 0.5791 (0.5772) acc 81.2500 (62.4665) kd_loss 0.6712 (0.6768) lr 9.3721e-04 eta 0:10:22
epoch [28/50] batch [300/319] time 0.081 (0.087) data 0.000 (0.006) loss 2.2436 (1.9724) ce_loss 1.1504 (1.0071) loss_zs_kd 1.8127 (1.8986) loss_oracle 0.7093 (0.5770) acc 56.2500 (62.3958) kd_loss 0.7385 (0.6769) lr 9.3721e-04 eta 0:10:15
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,975
* accuracy: 68.0%
* error: 32.0%
* macro_f1: 60.9%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,755
* accuracy: 59.1%
* error: 40.9%
* macro_f1: 27.5%
******* Domain 2 best val acc:      68.0%, epoch: 26 *******
******* Domain 2 best val test acc: 56.2%, epoch: 26 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [29/50] batch [20/319] time 0.087 (0.198) data 0.000 (0.114) loss 2.2110 (1.9398) ce_loss 1.1797 (0.9854) loss_zs_kd 1.9923 (1.9360) loss_oracle 0.5930 (0.5784) acc 56.2500 (64.2188) kd_loss 0.7348 (0.6652) lr 8.7467e-04 eta 0:23:07
epoch [29/50] batch [40/319] time 0.086 (0.141) data 0.000 (0.057) loss 1.9159 (1.9225) ce_loss 1.0537 (0.9974) loss_zs_kd 1.8229 (1.9228) loss_oracle 0.5747 (0.5641) acc 75.0000 (63.9062) kd_loss 0.5749 (0.6430) lr 8.7467e-04 eta 0:16:26
epoch [29/50] batch [60/319] time 0.080 (0.122) data 0.000 (0.038) loss 1.8738 (1.9357) ce_loss 0.8975 (1.0107) loss_zs_kd 2.0859 (1.9343) loss_oracle 0.6367 (0.5599) acc 68.7500 (63.3333) kd_loss 0.6580 (0.6451) lr 8.7467e-04 eta 0:14:06
epoch [29/50] batch [80/319] time 0.092 (0.112) data 0.000 (0.029) loss 1.9328 (1.9371) ce_loss 0.9175 (1.0096) loss_zs_kd 2.0762 (1.9257) loss_oracle 0.5668 (0.5600) acc 62.5000 (63.7891) kd_loss 0.7319 (0.6476) lr 8.7467e-04 eta 0:12:57
epoch [29/50] batch [100/319] time 0.070 (0.105) data 0.000 (0.023) loss 2.0301 (1.9311) ce_loss 1.1074 (1.0074) loss_zs_kd 1.8804 (1.9088) loss_oracle 0.4771 (0.5621) acc 59.3750 (63.6875) kd_loss 0.6841 (0.6426) lr 8.7467e-04 eta 0:12:07
epoch [29/50] batch [120/319] time 0.097 (0.101) data 0.000 (0.019) loss 1.9227 (1.9310) ce_loss 1.0713 (1.0066) loss_zs_kd 1.7141 (1.9121) loss_oracle 0.5332 (0.5661) acc 59.3750 (63.3594) kd_loss 0.5848 (0.6414) lr 8.7467e-04 eta 0:11:35
epoch [29/50] batch [140/319] time 0.084 (0.098) data 0.000 (0.017) loss 2.2229 (1.9256) ce_loss 1.2686 (1.0023) loss_zs_kd 1.8666 (1.9111) loss_oracle 0.6318 (0.5700) acc 37.5000 (63.1920) kd_loss 0.6384 (0.6383) lr 8.7467e-04 eta 0:11:14
epoch [29/50] batch [160/319] time 0.087 (0.096) data 0.000 (0.015) loss 2.1606 (1.9372) ce_loss 1.1631 (1.0104) loss_zs_kd 1.7881 (1.9137) loss_oracle 0.5063 (0.5752) acc 50.0000 (62.5977) kd_loss 0.7444 (0.6392) lr 8.7467e-04 eta 0:11:00
epoch [29/50] batch [180/319] time 0.083 (0.095) data 0.000 (0.013) loss 2.0466 (1.9407) ce_loss 1.0820 (1.0098) loss_zs_kd 1.7109 (1.9141) loss_oracle 0.5896 (0.5795) acc 53.1250 (62.6562) kd_loss 0.6698 (0.6412) lr 8.7467e-04 eta 0:10:49
epoch [29/50] batch [200/319] time 0.084 (0.094) data 0.000 (0.012) loss 2.0818 (1.9496) ce_loss 1.0605 (1.0141) loss_zs_kd 2.0210 (1.9162) loss_oracle 0.7053 (0.5855) acc 56.2500 (62.7031) kd_loss 0.6685 (0.6427) lr 8.7467e-04 eta 0:10:38
epoch [29/50] batch [220/319] time 0.088 (0.093) data 0.000 (0.011) loss 2.2570 (1.9448) ce_loss 1.3164 (1.0131) loss_zs_kd 1.9238 (1.9080) loss_oracle 0.6779 (0.5858) acc 43.7500 (62.5568) kd_loss 0.6016 (0.6388) lr 8.7467e-04 eta 0:10:30
epoch [29/50] batch [240/319] time 0.086 (0.092) data 0.000 (0.010) loss 2.0603 (1.9423) ce_loss 1.1367 (1.0125) loss_zs_kd 1.9176 (1.9218) loss_oracle 0.5252 (0.5860) acc 56.2500 (62.6302) kd_loss 0.6610 (0.6369) lr 8.7467e-04 eta 0:10:23
epoch [29/50] batch [260/319] time 0.096 (0.091) data 0.000 (0.009) loss 1.7912 (1.9441) ce_loss 0.9829 (1.0167) loss_zs_kd 2.0718 (1.9191) loss_oracle 0.5270 (0.5843) acc 62.5000 (62.3558) kd_loss 0.5448 (0.6352) lr 8.7467e-04 eta 0:10:15
epoch [29/50] batch [280/319] time 0.075 (0.090) data 0.000 (0.008) loss 1.9235 (1.9461) ce_loss 0.9653 (1.0163) loss_zs_kd 1.8981 (1.9244) loss_oracle 0.5647 (0.5855) acc 71.8750 (62.4219) kd_loss 0.6758 (0.6371) lr 8.7467e-04 eta 0:10:09
epoch [29/50] batch [300/319] time 0.081 (0.090) data 0.000 (0.008) loss 2.0639 (1.9488) ce_loss 1.1045 (1.0178) loss_zs_kd 1.9681 (1.9177) loss_oracle 0.5700 (0.5858) acc 59.3750 (62.4375) kd_loss 0.6744 (0.6381) lr 8.7467e-04 eta 0:10:04
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,974
* accuracy: 67.9%
* error: 32.1%
* macro_f1: 60.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,526
* accuracy: 56.8%
* error: 43.2%
* macro_f1: 23.8%
******* Domain 2 best val acc:      68.0%, epoch: 26 *******
******* Domain 2 best val test acc: 56.2%, epoch: 26 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [30/50] batch [20/319] time 0.080 (0.223) data 0.000 (0.149) loss 1.7777 (2.0155) ce_loss 0.8486 (1.0659) loss_zs_kd 1.9842 (1.8802) loss_oracle 0.5472 (0.5714) acc 62.5000 (61.8750) kd_loss 0.6555 (0.6639) lr 8.1262e-04 eta 0:24:47
epoch [30/50] batch [40/319] time 0.087 (0.153) data 0.000 (0.075) loss 1.7739 (2.0069) ce_loss 0.8882 (1.0489) loss_zs_kd 1.9509 (1.8952) loss_oracle 0.6029 (0.6003) acc 65.6250 (62.0312) kd_loss 0.5843 (0.6578) lr 8.1262e-04 eta 0:16:57
epoch [30/50] batch [60/319] time 0.090 (0.131) data 0.000 (0.050) loss 1.8126 (2.0105) ce_loss 0.8579 (1.0432) loss_zs_kd 2.0192 (1.9060) loss_oracle 0.6495 (0.6083) acc 75.0000 (62.1354) kd_loss 0.6299 (0.6632) lr 8.1262e-04 eta 0:14:29
epoch [30/50] batch [80/319] time 0.076 (0.120) data 0.000 (0.038) loss 2.0409 (2.0119) ce_loss 1.0215 (1.0404) loss_zs_kd 1.7285 (1.8981) loss_oracle 0.7422 (0.6087) acc 53.1250 (61.4844) kd_loss 0.6483 (0.6672) lr 8.1262e-04 eta 0:13:12
epoch [30/50] batch [100/319] time 0.088 (0.113) data 0.000 (0.030) loss 1.9244 (2.0116) ce_loss 0.9854 (1.0411) loss_zs_kd 1.9904 (1.8967) loss_oracle 0.6233 (0.6069) acc 65.6250 (61.5312) kd_loss 0.6274 (0.6671) lr 8.1262e-04 eta 0:12:26
epoch [30/50] batch [120/319] time 0.087 (0.109) data 0.000 (0.025) loss 2.0977 (2.0160) ce_loss 1.0879 (1.0433) loss_zs_kd 1.8599 (1.8938) loss_oracle 0.6545 (0.6077) acc 62.5000 (61.2760) kd_loss 0.6826 (0.6689) lr 8.1262e-04 eta 0:11:54
epoch [30/50] batch [140/319] time 0.079 (0.105) data 0.000 (0.022) loss 1.8398 (2.0103) ce_loss 0.7993 (1.0314) loss_zs_kd 1.8295 (1.8951) loss_oracle 0.6075 (0.6108) acc 65.6250 (61.9196) kd_loss 0.7367 (0.6735) lr 8.1262e-04 eta 0:11:26
epoch [30/50] batch [160/319] time 0.080 (0.102) data 0.000 (0.019) loss 2.0249 (2.0100) ce_loss 1.0684 (1.0279) loss_zs_kd 1.5595 (1.8792) loss_oracle 0.5887 (0.6067) acc 56.2500 (61.9531) kd_loss 0.6622 (0.6788) lr 8.1262e-04 eta 0:11:07
epoch [30/50] batch [180/319] time 0.083 (0.100) data 0.000 (0.017) loss 1.9616 (2.0077) ce_loss 0.9468 (1.0242) loss_zs_kd 2.0683 (1.8709) loss_oracle 0.5625 (0.6055) acc 59.3750 (61.7535) kd_loss 0.7336 (0.6807) lr 8.1262e-04 eta 0:10:52
epoch [30/50] batch [200/319] time 0.059 (0.098) data 0.000 (0.015) loss 2.0187 (2.0022) ce_loss 1.0244 (1.0180) loss_zs_kd 1.8014 (1.8603) loss_oracle 0.5828 (0.6028) acc 62.5000 (62.0312) kd_loss 0.7029 (0.6828) lr 8.1262e-04 eta 0:10:37
epoch [30/50] batch [220/319] time 0.074 (0.095) data 0.000 (0.014) loss 1.9447 (2.0000) ce_loss 0.8926 (1.0175) loss_zs_kd 1.7486 (1.8616) loss_oracle 0.5030 (0.5988) acc 71.8750 (62.1875) kd_loss 0.8006 (0.6831) lr 8.1262e-04 eta 0:10:16
epoch [30/50] batch [240/319] time 0.063 (0.093) data 0.000 (0.013) loss 1.7800 (2.0013) ce_loss 0.9141 (1.0221) loss_zs_kd 1.8829 (1.8627) loss_oracle 0.5828 (0.5958) acc 68.7500 (62.0703) kd_loss 0.5745 (0.6813) lr 8.1262e-04 eta 0:09:58
epoch [30/50] batch [260/319] time 0.063 (0.091) data 0.000 (0.012) loss 2.0303 (1.9979) ce_loss 1.0410 (1.0202) loss_zs_kd 1.7351 (1.8610) loss_oracle 0.5801 (0.5940) acc 62.5000 (62.2476) kd_loss 0.6992 (0.6807) lr 8.1262e-04 eta 0:09:43
epoch [30/50] batch [280/319] time 0.081 (0.090) data 0.000 (0.011) loss 1.8696 (1.9931) ce_loss 0.9839 (1.0164) loss_zs_kd 1.8398 (1.8586) loss_oracle 0.5502 (0.5911) acc 65.6250 (62.4554) kd_loss 0.6106 (0.6812) lr 8.1262e-04 eta 0:09:34
epoch [30/50] batch [300/319] time 0.087 (0.089) data 0.000 (0.010) loss 2.3766 (1.9901) ce_loss 1.3916 (1.0134) loss_zs_kd 1.8364 (1.8587) loss_oracle 0.5562 (0.5894) acc 53.1250 (62.6146) kd_loss 0.7069 (0.6820) lr 8.1262e-04 eta 0:09:30
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,991
* accuracy: 68.3%
* error: 31.7%
* macro_f1: 61.1%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,254
* accuracy: 54.0%
* error: 46.0%
* macro_f1: 24.9%
******* Domain 2 best val acc:      68.3%, epoch: 30 *******
******* Domain 2 best val test acc: 54.0%, epoch: 30 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [31/50] batch [20/319] time 0.079 (0.227) data 0.000 (0.141) loss 1.6665 (1.8892) ce_loss 0.7646 (0.9352) loss_zs_kd 2.1434 (1.8283) loss_oracle 0.5620 (0.5648) acc 81.2500 (65.3125) kd_loss 0.6208 (0.6716) lr 7.5131e-04 eta 0:24:03
epoch [31/50] batch [40/319] time 0.074 (0.154) data 0.000 (0.071) loss 2.1135 (1.9339) ce_loss 1.0244 (0.9660) loss_zs_kd 1.5691 (1.8355) loss_oracle 0.5496 (0.5750) acc 62.5000 (63.3594) kd_loss 0.8143 (0.6804) lr 7.5131e-04 eta 0:16:14
epoch [31/50] batch [60/319] time 0.087 (0.131) data 0.000 (0.047) loss 2.1813 (1.9618) ce_loss 1.1670 (0.9935) loss_zs_kd 1.9693 (1.8293) loss_oracle 0.5374 (0.5729) acc 43.7500 (62.2917) kd_loss 0.7456 (0.6818) lr 7.5131e-04 eta 0:13:46
epoch [31/50] batch [80/319] time 0.089 (0.119) data 0.000 (0.035) loss 2.1392 (1.9711) ce_loss 1.1484 (1.0010) loss_zs_kd 1.8845 (1.8337) loss_oracle 0.5397 (0.5743) acc 43.7500 (61.7969) kd_loss 0.7209 (0.6829) lr 7.5131e-04 eta 0:12:29
epoch [31/50] batch [100/319] time 0.082 (0.112) data 0.000 (0.028) loss 2.1675 (1.9698) ce_loss 1.1777 (0.9986) loss_zs_kd 1.9226 (1.8308) loss_oracle 0.6137 (0.5757) acc 50.0000 (62.0000) kd_loss 0.6829 (0.6833) lr 7.5131e-04 eta 0:11:44
epoch [31/50] batch [120/319] time 0.092 (0.107) data 0.000 (0.024) loss 1.7374 (1.9708) ce_loss 0.8091 (1.0052) loss_zs_kd 1.4942 (1.8143) loss_oracle 0.5968 (0.5776) acc 62.5000 (61.7188) kd_loss 0.6299 (0.6768) lr 7.5131e-04 eta 0:11:12
epoch [31/50] batch [140/319] time 0.082 (0.104) data 0.000 (0.020) loss 1.8994 (1.9736) ce_loss 1.0479 (1.0109) loss_zs_kd 1.8117 (1.8248) loss_oracle 0.5565 (0.5796) acc 65.6250 (61.7411) kd_loss 0.5733 (0.6729) lr 7.5131e-04 eta 0:10:50
epoch [31/50] batch [160/319] time 0.083 (0.101) data 0.000 (0.018) loss 2.1767 (1.9714) ce_loss 1.1475 (1.0085) loss_zs_kd 1.8272 (1.8416) loss_oracle 0.6288 (0.5822) acc 50.0000 (61.8750) kd_loss 0.7148 (0.6719) lr 7.5131e-04 eta 0:10:30
epoch [31/50] batch [180/319] time 0.083 (0.099) data 0.000 (0.016) loss 2.1281 (1.9706) ce_loss 1.2744 (1.0122) loss_zs_kd 1.7604 (1.8352) loss_oracle 0.5044 (0.5817) acc 65.6250 (61.7708) kd_loss 0.6015 (0.6675) lr 7.5131e-04 eta 0:10:16
epoch [31/50] batch [200/319] time 0.084 (0.097) data 0.000 (0.014) loss 1.9100 (1.9692) ce_loss 1.0195 (1.0135) loss_zs_kd 2.0563 (1.8478) loss_oracle 0.5823 (0.5808) acc 62.5000 (61.8125) kd_loss 0.5993 (0.6653) lr 7.5131e-04 eta 0:10:00
epoch [31/50] batch [220/319] time 0.082 (0.096) data 0.000 (0.013) loss 1.7417 (1.9649) ce_loss 0.7983 (1.0115) loss_zs_kd 2.1637 (1.8575) loss_oracle 0.5491 (0.5797) acc 71.8750 (62.0170) kd_loss 0.6688 (0.6636) lr 7.5131e-04 eta 0:09:52
epoch [31/50] batch [240/319] time 0.084 (0.095) data 0.000 (0.012) loss 1.9001 (1.9647) ce_loss 1.0791 (1.0123) loss_zs_kd 1.6198 (1.8573) loss_oracle 0.5345 (0.5788) acc 68.7500 (62.0964) kd_loss 0.5537 (0.6630) lr 7.5131e-04 eta 0:09:44
epoch [31/50] batch [260/319] time 0.096 (0.094) data 0.000 (0.011) loss 1.8593 (1.9584) ce_loss 1.0225 (1.0088) loss_zs_kd 1.7167 (1.8524) loss_oracle 0.5472 (0.5789) acc 65.6250 (62.3317) kd_loss 0.5632 (0.6602) lr 7.5131e-04 eta 0:09:37
epoch [31/50] batch [280/319] time 0.076 (0.093) data 0.000 (0.010) loss 2.0569 (1.9644) ce_loss 1.0273 (1.0159) loss_zs_kd 1.8835 (1.8513) loss_oracle 0.5818 (0.5798) acc 53.1250 (61.9085) kd_loss 0.7387 (0.6585) lr 7.5131e-04 eta 0:09:30
epoch [31/50] batch [300/319] time 0.083 (0.093) data 0.000 (0.010) loss 1.6452 (1.9630) ce_loss 0.7520 (1.0184) loss_zs_kd 1.8246 (1.8513) loss_oracle 0.6046 (0.5787) acc 65.6250 (61.8958) kd_loss 0.5910 (0.6553) lr 7.5131e-04 eta 0:09:24
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,974
* accuracy: 67.9%
* error: 32.1%
* macro_f1: 60.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,273
* accuracy: 54.2%
* error: 45.8%
* macro_f1: 25.5%
******* Domain 2 best val acc:      68.3%, epoch: 30 *******
******* Domain 2 best val test acc: 54.0%, epoch: 30 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [32/50] batch [20/319] time 0.082 (0.237) data 0.000 (0.145) loss 1.8943 (1.9618) ce_loss 1.0117 (1.0329) loss_zs_kd 2.1520 (1.8833) loss_oracle 0.5228 (0.5796) acc 68.7500 (61.0938) kd_loss 0.6212 (0.6392) lr 6.9098e-04 eta 0:23:52
epoch [32/50] batch [40/319] time 0.083 (0.161) data 0.000 (0.073) loss 2.0195 (1.9577) ce_loss 1.0811 (1.0304) loss_zs_kd 1.9714 (1.8982) loss_oracle 0.5454 (0.5887) acc 53.1250 (60.7812) kd_loss 0.6657 (0.6330) lr 6.9098e-04 eta 0:16:09
epoch [32/50] batch [60/319] time 0.085 (0.136) data 0.000 (0.049) loss 1.8438 (1.9553) ce_loss 0.8579 (1.0201) loss_zs_kd 1.7271 (1.9001) loss_oracle 0.5302 (0.5857) acc 68.7500 (61.5625) kd_loss 0.7208 (0.6424) lr 6.9098e-04 eta 0:13:34
epoch [32/50] batch [80/319] time 0.073 (0.122) data 0.000 (0.037) loss 1.8634 (1.9488) ce_loss 0.9404 (1.0144) loss_zs_kd 1.7145 (1.8991) loss_oracle 0.5299 (0.5857) acc 59.3750 (61.3281) kd_loss 0.6581 (0.6416) lr 6.9098e-04 eta 0:12:07
epoch [32/50] batch [100/319] time 0.070 (0.113) data 0.000 (0.029) loss 1.7153 (1.9552) ce_loss 0.7705 (1.0207) loss_zs_kd 1.9168 (1.8900) loss_oracle 0.5718 (0.5838) acc 81.2500 (61.3438) kd_loss 0.6589 (0.6426) lr 6.9098e-04 eta 0:11:13
epoch [32/50] batch [120/319] time 0.076 (0.107) data 0.000 (0.024) loss 2.0088 (1.9533) ce_loss 1.0957 (1.0169) loss_zs_kd 1.7725 (1.8759) loss_oracle 0.5379 (0.5820) acc 50.0000 (61.4844) kd_loss 0.6442 (0.6454) lr 6.9098e-04 eta 0:10:35
epoch [32/50] batch [140/319] time 0.070 (0.102) data 0.000 (0.021) loss 1.9015 (1.9534) ce_loss 1.0068 (1.0153) loss_zs_kd 2.0775 (1.8757) loss_oracle 0.5151 (0.5808) acc 53.1250 (61.4509) kd_loss 0.6371 (0.6477) lr 6.9098e-04 eta 0:10:04
epoch [32/50] batch [160/319] time 0.073 (0.099) data 0.000 (0.018) loss 2.0719 (1.9572) ce_loss 1.0156 (1.0185) loss_zs_kd 1.6713 (1.8617) loss_oracle 0.5844 (0.5830) acc 62.5000 (61.4844) kd_loss 0.7641 (0.6472) lr 6.9098e-04 eta 0:09:43
epoch [32/50] batch [180/319] time 0.081 (0.097) data 0.000 (0.016) loss 2.0443 (1.9560) ce_loss 1.1523 (1.0162) loss_zs_kd 1.7912 (1.8632) loss_oracle 0.5565 (0.5817) acc 50.0000 (61.7188) kd_loss 0.6138 (0.6490) lr 6.9098e-04 eta 0:09:30
epoch [32/50] batch [200/319] time 0.076 (0.097) data 0.000 (0.015) loss 1.9240 (1.9542) ce_loss 0.9575 (1.0145) loss_zs_kd 1.8509 (1.8582) loss_oracle 0.5934 (0.5804) acc 59.3750 (61.8594) kd_loss 0.6698 (0.6495) lr 6.9098e-04 eta 0:09:26
epoch [32/50] batch [220/319] time 0.092 (0.095) data 0.000 (0.013) loss 1.9919 (1.9508) ce_loss 0.9458 (1.0089) loss_zs_kd 1.5406 (1.8548) loss_oracle 0.5474 (0.5776) acc 62.5000 (62.1023) kd_loss 0.7724 (0.6531) lr 6.9098e-04 eta 0:09:16
epoch [32/50] batch [240/319] time 0.081 (0.094) data 0.000 (0.012) loss 1.7603 (1.9529) ce_loss 0.7905 (1.0113) loss_zs_kd 1.6100 (1.8467) loss_oracle 0.5503 (0.5763) acc 68.7500 (62.2396) kd_loss 0.6946 (0.6534) lr 6.9098e-04 eta 0:09:09
epoch [32/50] batch [260/319] time 0.090 (0.094) data 0.000 (0.011) loss 1.8675 (1.9550) ce_loss 1.0098 (1.0152) loss_zs_kd 1.6480 (1.8483) loss_oracle 0.5494 (0.5750) acc 68.7500 (62.1875) kd_loss 0.5830 (0.6524) lr 6.9098e-04 eta 0:09:04
epoch [32/50] batch [280/319] time 0.100 (0.093) data 0.000 (0.011) loss 2.0896 (1.9543) ce_loss 1.1221 (1.0167) loss_zs_kd 1.9354 (1.8464) loss_oracle 0.5783 (0.5747) acc 68.7500 (62.1652) kd_loss 0.6784 (0.6502) lr 6.9098e-04 eta 0:08:59
epoch [32/50] batch [300/319] time 0.085 (0.092) data 0.000 (0.010) loss 1.9575 (1.9497) ce_loss 1.0342 (1.0136) loss_zs_kd 1.6942 (1.8578) loss_oracle 0.5717 (0.5735) acc 62.5000 (62.1354) kd_loss 0.6374 (0.6494) lr 6.9098e-04 eta 0:08:52
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,000
* accuracy: 68.5%
* error: 31.5%
* macro_f1: 60.9%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,439
* accuracy: 55.9%
* error: 44.1%
* macro_f1: 24.4%
******* Domain 2 best val acc:      68.5%, epoch: 32 *******
******* Domain 2 best val test acc: 55.9%, epoch: 32 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [33/50] batch [20/319] time 0.068 (0.203) data 0.000 (0.123) loss 2.1953 (1.9319) ce_loss 1.3086 (0.9978) loss_zs_kd 1.9010 (1.9224) loss_oracle 0.6149 (0.5939) acc 50.0000 (63.4375) kd_loss 0.5793 (0.6371) lr 6.3188e-04 eta 0:19:24
epoch [33/50] batch [40/319] time 0.070 (0.135) data 0.000 (0.062) loss 1.8520 (1.9353) ce_loss 0.9990 (1.0084) loss_zs_kd 1.8635 (1.8740) loss_oracle 0.5596 (0.5782) acc 65.6250 (63.2031) kd_loss 0.5732 (0.6378) lr 6.3188e-04 eta 0:12:47
epoch [33/50] batch [60/319] time 0.061 (0.111) data 0.000 (0.041) loss 1.7554 (1.9320) ce_loss 0.6943 (1.0023) loss_zs_kd 1.7744 (1.8534) loss_oracle 0.7695 (0.5857) acc 78.1250 (64.3750) kd_loss 0.6763 (0.6369) lr 6.3188e-04 eta 0:10:33
epoch [33/50] batch [80/319] time 0.073 (0.100) data 0.000 (0.031) loss 1.8607 (1.9285) ce_loss 0.9331 (0.9956) loss_zs_kd 2.0078 (1.8750) loss_oracle 0.5814 (0.5862) acc 68.7500 (64.7656) kd_loss 0.6369 (0.6398) lr 6.3188e-04 eta 0:09:25
epoch [33/50] batch [100/319] time 0.065 (0.093) data 0.000 (0.025) loss 2.0400 (1.9296) ce_loss 1.1074 (0.9954) loss_zs_kd 1.6336 (1.8669) loss_oracle 0.5306 (0.5863) acc 59.3750 (64.3438) kd_loss 0.6673 (0.6410) lr 6.3188e-04 eta 0:08:44
epoch [33/50] batch [120/319] time 0.092 (0.091) data 0.000 (0.021) loss 2.1827 (1.9246) ce_loss 1.2090 (0.9960) loss_zs_kd 1.9210 (1.8699) loss_oracle 0.5987 (0.5870) acc 50.0000 (63.9062) kd_loss 0.6744 (0.6351) lr 6.3188e-04 eta 0:08:31
epoch [33/50] batch [140/319] time 0.087 (0.090) data 0.000 (0.018) loss 1.8987 (1.9273) ce_loss 0.9834 (0.9935) loss_zs_kd 1.9275 (1.8576) loss_oracle 0.5582 (0.5881) acc 56.2500 (63.8839) kd_loss 0.6362 (0.6397) lr 6.3188e-04 eta 0:08:23
epoch [33/50] batch [160/319] time 0.080 (0.089) data 0.000 (0.016) loss 1.6922 (1.9273) ce_loss 0.7075 (0.9948) loss_zs_kd 1.8876 (1.8682) loss_oracle 0.6338 (0.5886) acc 71.8750 (63.7695) kd_loss 0.6678 (0.6381) lr 6.3188e-04 eta 0:08:17
epoch [33/50] batch [180/319] time 0.079 (0.088) data 0.000 (0.014) loss 1.9265 (1.9345) ce_loss 1.0186 (1.0076) loss_zs_kd 2.2431 (1.8756) loss_oracle 0.5166 (0.5870) acc 59.3750 (63.1944) kd_loss 0.6496 (0.6334) lr 6.3188e-04 eta 0:08:11
epoch [33/50] batch [200/319] time 0.090 (0.088) data 0.000 (0.013) loss 1.7188 (1.9331) ce_loss 0.8135 (1.0064) loss_zs_kd 2.3221 (1.8839) loss_oracle 0.5815 (0.5865) acc 71.8750 (63.2188) kd_loss 0.6146 (0.6334) lr 6.3188e-04 eta 0:08:05
epoch [33/50] batch [220/319] time 0.079 (0.087) data 0.000 (0.011) loss 1.6612 (1.9293) ce_loss 0.7207 (1.0010) loss_zs_kd 1.6719 (1.8811) loss_oracle 0.4950 (0.5851) acc 65.6250 (63.1676) kd_loss 0.6930 (0.6358) lr 6.3188e-04 eta 0:08:00
epoch [33/50] batch [240/319] time 0.082 (0.087) data 0.000 (0.011) loss 1.8227 (1.9296) ce_loss 0.9067 (1.0010) loss_zs_kd 2.2011 (1.8843) loss_oracle 0.5413 (0.5834) acc 68.7500 (63.0208) kd_loss 0.6453 (0.6369) lr 6.3188e-04 eta 0:07:58
epoch [33/50] batch [260/319] time 0.080 (0.086) data 0.000 (0.010) loss 2.0194 (1.9370) ce_loss 1.1113 (1.0065) loss_zs_kd 1.7953 (1.8798) loss_oracle 0.5687 (0.5827) acc 59.3750 (62.5962) kd_loss 0.6237 (0.6392) lr 6.3188e-04 eta 0:07:53
epoch [33/50] batch [280/319] time 0.080 (0.086) data 0.000 (0.009) loss 1.7309 (1.9357) ce_loss 0.7783 (1.0052) loss_zs_kd 1.6805 (1.8786) loss_oracle 0.6268 (0.5835) acc 71.8750 (62.6339) kd_loss 0.6392 (0.6387) lr 6.3188e-04 eta 0:07:51
epoch [33/50] batch [300/319] time 0.084 (0.086) data 0.000 (0.008) loss 1.6546 (1.9379) ce_loss 0.8047 (1.0073) loss_zs_kd 1.6900 (1.8764) loss_oracle 0.5789 (0.5826) acc 65.6250 (62.4479) kd_loss 0.5604 (0.6393) lr 6.3188e-04 eta 0:07:47
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,985
* accuracy: 68.2%
* error: 31.8%
* macro_f1: 61.6%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,350
* accuracy: 55.0%
* error: 45.0%
* macro_f1: 24.7%
******* Domain 2 best val acc:      68.5%, epoch: 32 *******
******* Domain 2 best val test acc: 55.9%, epoch: 32 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [34/50] batch [20/319] time 0.092 (0.239) data 0.001 (0.151) loss 2.1032 (1.9052) ce_loss 1.3008 (1.0158) loss_zs_kd 1.8344 (1.8210) loss_oracle 0.5242 (0.5474) acc 53.1250 (60.3125) kd_loss 0.5403 (0.6156) lr 5.7422e-04 eta 0:21:28
epoch [34/50] batch [40/319] time 0.082 (0.160) data 0.000 (0.076) loss 1.8488 (1.9126) ce_loss 0.9487 (0.9988) loss_zs_kd 1.6908 (1.8440) loss_oracle 0.5609 (0.5552) acc 65.6250 (62.1875) kd_loss 0.6196 (0.6362) lr 5.7422e-04 eta 0:14:21
epoch [34/50] batch [60/319] time 0.082 (0.135) data 0.000 (0.051) loss 1.9845 (1.8987) ce_loss 1.1436 (0.9835) loss_zs_kd 1.7604 (1.8645) loss_oracle 0.5209 (0.5508) acc 53.1250 (62.5000) kd_loss 0.5805 (0.6399) lr 5.7422e-04 eta 0:12:02
epoch [34/50] batch [80/319] time 0.084 (0.122) data 0.000 (0.038) loss 2.1058 (1.8969) ce_loss 1.1553 (0.9832) loss_zs_kd 1.8411 (1.8384) loss_oracle 0.5736 (0.5537) acc 62.5000 (62.3828) kd_loss 0.6637 (0.6368) lr 5.7422e-04 eta 0:10:53
epoch [34/50] batch [100/319] time 0.086 (0.115) data 0.000 (0.030) loss 1.8341 (1.9060) ce_loss 0.9404 (0.9931) loss_zs_kd 1.8206 (1.8544) loss_oracle 0.5238 (0.5575) acc 78.1250 (62.6250) kd_loss 0.6318 (0.6342) lr 5.7422e-04 eta 0:10:12
epoch [34/50] batch [120/319] time 0.088 (0.110) data 0.000 (0.025) loss 1.9648 (1.8881) ce_loss 1.0127 (0.9793) loss_zs_kd 1.8709 (1.8474) loss_oracle 0.5742 (0.5575) acc 62.5000 (63.0729) kd_loss 0.6649 (0.6301) lr 5.7422e-04 eta 0:09:44
epoch [34/50] batch [140/319] time 0.078 (0.107) data 0.000 (0.022) loss 2.0570 (1.8918) ce_loss 1.2168 (0.9842) loss_zs_kd 1.6764 (1.8426) loss_oracle 0.4946 (0.5585) acc 53.1250 (62.4554) kd_loss 0.5930 (0.6283) lr 5.7422e-04 eta 0:09:23
epoch [34/50] batch [160/319] time 0.083 (0.104) data 0.000 (0.019) loss 2.1780 (1.9023) ce_loss 1.1201 (0.9917) loss_zs_kd 1.8392 (1.8457) loss_oracle 0.6161 (0.5624) acc 53.1250 (62.4805) kd_loss 0.7499 (0.6294) lr 5.7422e-04 eta 0:09:07
epoch [34/50] batch [180/319] time 0.087 (0.102) data 0.000 (0.017) loss 1.9956 (1.9105) ce_loss 1.1123 (0.9984) loss_zs_kd 2.0772 (1.8457) loss_oracle 0.5565 (0.5626) acc 62.5000 (62.2917) kd_loss 0.6050 (0.6307) lr 5.7422e-04 eta 0:08:54
epoch [34/50] batch [200/319] time 0.080 (0.100) data 0.000 (0.015) loss 1.7847 (1.9206) ce_loss 0.9082 (1.0058) loss_zs_kd 1.5381 (1.8383) loss_oracle 0.5826 (0.5647) acc 71.8750 (61.9688) kd_loss 0.5852 (0.6325) lr 5.7422e-04 eta 0:08:42
epoch [34/50] batch [220/319] time 0.077 (0.099) data 0.000 (0.014) loss 1.5628 (1.9223) ce_loss 0.6587 (1.0053) loss_zs_kd 1.9566 (1.8378) loss_oracle 0.5026 (0.5663) acc 81.2500 (62.1023) kd_loss 0.6528 (0.6339) lr 5.7422e-04 eta 0:08:32
epoch [34/50] batch [240/319] time 0.084 (0.097) data 0.000 (0.013) loss 2.2402 (1.9213) ce_loss 1.2119 (1.0031) loss_zs_kd 1.8644 (1.8401) loss_oracle 0.5595 (0.5669) acc 53.1250 (62.3828) kd_loss 0.7486 (0.6348) lr 5.7422e-04 eta 0:08:24
epoch [34/50] batch [260/319] time 0.084 (0.096) data 0.000 (0.012) loss 1.6070 (1.9165) ce_loss 0.7119 (0.9981) loss_zs_kd 1.7571 (1.8367) loss_oracle 0.5857 (0.5686) acc 71.8750 (62.7043) kd_loss 0.6022 (0.6340) lr 5.7422e-04 eta 0:08:17
epoch [34/50] batch [280/319] time 0.084 (0.096) data 0.000 (0.011) loss 1.5960 (1.9154) ce_loss 0.7026 (0.9957) loss_zs_kd 1.9602 (1.8403) loss_oracle 0.6385 (0.5701) acc 81.2500 (62.7455) kd_loss 0.5741 (0.6347) lr 5.7422e-04 eta 0:08:11
epoch [34/50] batch [300/319] time 0.084 (0.095) data 0.000 (0.010) loss 1.9537 (1.9201) ce_loss 1.0234 (0.9966) loss_zs_kd 1.9546 (1.8435) loss_oracle 0.6057 (0.5707) acc 65.6250 (62.7500) kd_loss 0.6274 (0.6382) lr 5.7422e-04 eta 0:08:06
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,997
* accuracy: 68.5%
* error: 31.5%
* macro_f1: 61.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,266
* accuracy: 54.1%
* error: 45.9%
* macro_f1: 24.8%
******* Domain 2 best val acc:      68.5%, epoch: 32 *******
******* Domain 2 best val test acc: 55.9%, epoch: 32 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [35/50] batch [20/319] time 0.081 (0.247) data 0.000 (0.158) loss 1.8938 (1.9255) ce_loss 1.0527 (0.9834) loss_zs_kd 1.7163 (1.8237) loss_oracle 0.6241 (0.5869) acc 50.0000 (64.5312) kd_loss 0.5290 (0.6487) lr 5.1825e-04 eta 0:20:54
epoch [35/50] batch [40/319] time 0.077 (0.165) data 0.000 (0.079) loss 1.9848 (1.9266) ce_loss 0.8950 (0.9772) loss_zs_kd 1.9413 (1.8219) loss_oracle 0.6633 (0.5943) acc 68.7500 (64.7656) kd_loss 0.7581 (0.6523) lr 5.1825e-04 eta 0:13:56
epoch [35/50] batch [60/319] time 0.088 (0.138) data 0.000 (0.053) loss 2.1363 (1.9607) ce_loss 1.0469 (1.0008) loss_zs_kd 1.8006 (1.8218) loss_oracle 0.6634 (0.6000) acc 68.7500 (63.8542) kd_loss 0.7577 (0.6599) lr 5.1825e-04 eta 0:11:37
epoch [35/50] batch [80/319] time 0.079 (0.125) data 0.000 (0.040) loss 2.0058 (1.9495) ce_loss 1.0508 (0.9905) loss_zs_kd 2.0252 (1.8418) loss_oracle 0.6010 (0.5966) acc 65.6250 (64.4922) kd_loss 0.6545 (0.6607) lr 5.1825e-04 eta 0:10:27
epoch [35/50] batch [100/319] time 0.086 (0.117) data 0.000 (0.032) loss 2.0136 (1.9414) ce_loss 1.0918 (0.9823) loss_zs_kd 2.0837 (1.8578) loss_oracle 0.6584 (0.5935) acc 62.5000 (64.6562) kd_loss 0.5925 (0.6624) lr 5.1825e-04 eta 0:09:44
epoch [35/50] batch [120/319] time 0.090 (0.112) data 0.000 (0.027) loss 2.0369 (1.9511) ce_loss 0.9849 (0.9878) loss_zs_kd 1.9928 (1.8646) loss_oracle 0.6122 (0.5925) acc 65.6250 (64.0365) kd_loss 0.7459 (0.6670) lr 5.1825e-04 eta 0:09:17
epoch [35/50] batch [140/319] time 0.087 (0.108) data 0.000 (0.023) loss 2.0549 (1.9476) ce_loss 1.0273 (0.9820) loss_zs_kd 1.8237 (1.8823) loss_oracle 0.5994 (0.5929) acc 65.6250 (64.2634) kd_loss 0.7278 (0.6692) lr 5.1825e-04 eta 0:08:56
epoch [35/50] batch [160/319] time 0.073 (0.104) data 0.000 (0.020) loss 2.0038 (1.9462) ce_loss 1.1738 (0.9842) loss_zs_kd 1.9105 (1.8919) loss_oracle 0.5461 (0.5901) acc 56.2500 (64.1406) kd_loss 0.5569 (0.6669) lr 5.1825e-04 eta 0:08:34
epoch [35/50] batch [180/319] time 0.061 (0.100) data 0.000 (0.018) loss 2.0723 (1.9500) ce_loss 1.1445 (0.9933) loss_zs_kd 1.5819 (1.8903) loss_oracle 0.5311 (0.5882) acc 62.5000 (63.6979) kd_loss 0.6622 (0.6627) lr 5.1825e-04 eta 0:08:10
epoch [35/50] batch [200/319] time 0.080 (0.098) data 0.000 (0.016) loss 2.0927 (1.9580) ce_loss 1.0605 (1.0006) loss_zs_kd 1.6182 (1.8898) loss_oracle 0.6240 (0.5886) acc 56.2500 (63.2812) kd_loss 0.7201 (0.6631) lr 5.1825e-04 eta 0:07:59
epoch [35/50] batch [220/319] time 0.088 (0.097) data 0.000 (0.015) loss 2.1712 (1.9496) ce_loss 1.1924 (0.9927) loss_zs_kd 1.6110 (1.8873) loss_oracle 0.5323 (0.5884) acc 59.3750 (63.5653) kd_loss 0.7127 (0.6626) lr 5.1825e-04 eta 0:07:51
epoch [35/50] batch [240/319] time 0.081 (0.095) data 0.000 (0.013) loss 1.9927 (1.9529) ce_loss 0.9946 (0.9949) loss_zs_kd 2.0434 (1.8843) loss_oracle 0.6316 (0.5890) acc 53.1250 (63.5677) kd_loss 0.6822 (0.6635) lr 5.1825e-04 eta 0:07:43
epoch [35/50] batch [260/319] time 0.084 (0.094) data 0.000 (0.012) loss 1.5934 (1.9499) ce_loss 0.7422 (0.9914) loss_zs_kd 1.7418 (1.8820) loss_oracle 0.4792 (0.5878) acc 78.1250 (63.6058) kd_loss 0.6116 (0.6646) lr 5.1825e-04 eta 0:07:37
epoch [35/50] batch [280/319] time 0.077 (0.094) data 0.000 (0.012) loss 2.0063 (1.9537) ce_loss 1.0332 (0.9943) loss_zs_kd 2.0632 (1.8874) loss_oracle 0.5348 (0.5876) acc 62.5000 (63.5045) kd_loss 0.7057 (0.6656) lr 5.1825e-04 eta 0:07:32
epoch [35/50] batch [300/319] time 0.070 (0.093) data 0.000 (0.011) loss 1.8208 (1.9531) ce_loss 0.8076 (0.9928) loss_zs_kd 2.0555 (1.8905) loss_oracle 0.6339 (0.5869) acc 65.6250 (63.6875) kd_loss 0.6962 (0.6669) lr 5.1825e-04 eta 0:07:27
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,911
* accuracy: 66.5%
* error: 33.5%
* macro_f1: 60.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,818
* accuracy: 59.8%
* error: 40.2%
* macro_f1: 26.7%
******* Domain 2 best val acc:      68.5%, epoch: 32 *******
******* Domain 2 best val test acc: 55.9%, epoch: 32 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [36/50] batch [20/319] time 0.079 (0.265) data 0.000 (0.175) loss 1.9407 (1.9800) ce_loss 0.9956 (1.0458) loss_zs_kd 1.4204 (1.9229) loss_oracle 0.5340 (0.5819) acc 68.7500 (59.6875) kd_loss 0.6781 (0.6432) lr 4.6417e-04 eta 0:21:04
epoch [36/50] batch [40/319] time 0.084 (0.172) data 0.000 (0.087) loss 1.8719 (1.9904) ce_loss 1.0176 (1.0486) loss_zs_kd 1.8054 (1.9224) loss_oracle 0.5667 (0.5761) acc 65.6250 (60.3906) kd_loss 0.5709 (0.6537) lr 4.6417e-04 eta 0:13:38
epoch [36/50] batch [60/319] time 0.079 (0.142) data 0.000 (0.058) loss 1.8973 (1.9582) ce_loss 0.9692 (1.0229) loss_zs_kd 2.0828 (1.9200) loss_oracle 0.5846 (0.5751) acc 65.6250 (61.5625) kd_loss 0.6357 (0.6477) lr 4.6417e-04 eta 0:11:10
epoch [36/50] batch [80/319] time 0.087 (0.127) data 0.000 (0.044) loss 1.9135 (1.9614) ce_loss 0.9409 (1.0266) loss_zs_kd 1.9085 (1.8955) loss_oracle 0.5321 (0.5700) acc 68.7500 (61.0156) kd_loss 0.7065 (0.6498) lr 4.6417e-04 eta 0:09:57
epoch [36/50] batch [100/319] time 0.093 (0.119) data 0.000 (0.035) loss 1.8416 (1.9526) ce_loss 0.9131 (1.0185) loss_zs_kd 2.0465 (1.8861) loss_oracle 0.6083 (0.5722) acc 75.0000 (61.4688) kd_loss 0.6243 (0.6480) lr 4.6417e-04 eta 0:09:15
epoch [36/50] batch [120/319] time 0.085 (0.112) data 0.000 (0.029) loss 1.9357 (1.9535) ce_loss 0.9121 (1.0170) loss_zs_kd 1.9013 (1.8734) loss_oracle 0.5813 (0.5735) acc 65.6250 (61.8490) kd_loss 0.7329 (0.6498) lr 4.6417e-04 eta 0:08:41
epoch [36/50] batch [140/319] time 0.080 (0.107) data 0.000 (0.025) loss 1.8070 (1.9471) ce_loss 0.8647 (1.0119) loss_zs_kd 1.8318 (1.8649) loss_oracle 0.5226 (0.5725) acc 78.1250 (62.0982) kd_loss 0.6809 (0.6490) lr 4.6417e-04 eta 0:08:16
epoch [36/50] batch [160/319] time 0.076 (0.104) data 0.000 (0.022) loss 2.0070 (1.9460) ce_loss 0.9912 (1.0079) loss_zs_kd 1.5971 (1.8625) loss_oracle 0.6394 (0.5749) acc 68.7500 (62.2656) kd_loss 0.6961 (0.6507) lr 4.6417e-04 eta 0:07:58
epoch [36/50] batch [180/319] time 0.075 (0.101) data 0.000 (0.020) loss 2.0740 (1.9400) ce_loss 1.1318 (1.0024) loss_zs_kd 1.7860 (1.8566) loss_oracle 0.4975 (0.5735) acc 53.1250 (62.5694) kd_loss 0.6934 (0.6508) lr 4.6417e-04 eta 0:07:46
epoch [36/50] batch [200/319] time 0.084 (0.099) data 0.000 (0.018) loss 1.7965 (1.9413) ce_loss 0.8838 (1.0031) loss_zs_kd 1.6210 (1.8552) loss_oracle 0.5829 (0.5717) acc 62.5000 (62.3906) kd_loss 0.6213 (0.6524) lr 4.6417e-04 eta 0:07:35
epoch [36/50] batch [220/319] time 0.082 (0.098) data 0.000 (0.016) loss 1.9934 (1.9442) ce_loss 0.9961 (1.0023) loss_zs_kd 1.9493 (1.8573) loss_oracle 0.5286 (0.5728) acc 59.3750 (62.2159) kd_loss 0.7331 (0.6555) lr 4.6417e-04 eta 0:07:26
epoch [36/50] batch [240/319] time 0.085 (0.096) data 0.000 (0.015) loss 1.7877 (1.9437) ce_loss 0.8564 (1.0037) loss_zs_kd 1.9461 (1.8602) loss_oracle 0.5538 (0.5724) acc 65.6250 (62.2526) kd_loss 0.6543 (0.6538) lr 4.6417e-04 eta 0:07:18
epoch [36/50] batch [260/319] time 0.082 (0.096) data 0.000 (0.014) loss 1.9805 (1.9430) ce_loss 1.0723 (1.0042) loss_zs_kd 1.5143 (1.8609) loss_oracle 0.5554 (0.5720) acc 59.3750 (62.0433) kd_loss 0.6306 (0.6528) lr 4.6417e-04 eta 0:07:12
epoch [36/50] batch [280/319] time 0.084 (0.094) data 0.000 (0.013) loss 2.0503 (1.9427) ce_loss 1.1514 (1.0031) loss_zs_kd 1.6948 (1.8580) loss_oracle 0.5904 (0.5719) acc 62.5000 (62.0424) kd_loss 0.6038 (0.6536) lr 4.6417e-04 eta 0:07:05
epoch [36/50] batch [300/319] time 0.084 (0.094) data 0.000 (0.012) loss 2.0799 (1.9401) ce_loss 1.2080 (1.0015) loss_zs_kd 1.9607 (1.8608) loss_oracle 0.5655 (0.5716) acc 53.1250 (62.2083) kd_loss 0.5892 (0.6527) lr 4.6417e-04 eta 0:07:00
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,996
* accuracy: 68.4%
* error: 31.6%
* macro_f1: 61.7%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,678
* accuracy: 58.3%
* error: 41.7%
* macro_f1: 25.1%
******* Domain 2 best val acc:      68.5%, epoch: 32 *******
******* Domain 2 best val test acc: 55.9%, epoch: 32 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [37/50] batch [20/319] time 0.074 (0.203) data 0.000 (0.129) loss 1.9222 (1.8866) ce_loss 0.8994 (0.9749) loss_zs_kd 2.3816 (1.9294) loss_oracle 0.6599 (0.5591) acc 62.5000 (63.9062) kd_loss 0.6928 (0.6322) lr 4.1221e-04 eta 0:15:04
epoch [37/50] batch [40/319] time 0.080 (0.142) data 0.000 (0.064) loss 1.9822 (1.8705) ce_loss 1.1602 (0.9565) loss_zs_kd 1.6127 (1.9064) loss_oracle 0.5136 (0.5735) acc 56.2500 (65.3125) kd_loss 0.5652 (0.6272) lr 4.1221e-04 eta 0:10:29
epoch [37/50] batch [60/319] time 0.087 (0.123) data 0.000 (0.043) loss 1.7054 (1.8911) ce_loss 0.8115 (0.9720) loss_zs_kd 2.0456 (1.9017) loss_oracle 0.6013 (0.5789) acc 78.1250 (65.1042) kd_loss 0.5932 (0.6296) lr 4.1221e-04 eta 0:09:03
epoch [37/50] batch [80/319] time 0.086 (0.113) data 0.000 (0.032) loss 2.1868 (1.9206) ce_loss 1.1465 (0.9953) loss_zs_kd 1.7268 (1.9186) loss_oracle 0.6002 (0.5793) acc 46.8750 (63.4375) kd_loss 0.7403 (0.6356) lr 4.1221e-04 eta 0:08:14
epoch [37/50] batch [100/319] time 0.088 (0.108) data 0.000 (0.026) loss 2.1772 (1.9146) ce_loss 1.1895 (0.9887) loss_zs_kd 2.0009 (1.9075) loss_oracle 0.6064 (0.5789) acc 50.0000 (63.4375) kd_loss 0.6846 (0.6365) lr 4.1221e-04 eta 0:07:50
epoch [37/50] batch [120/319] time 0.090 (0.104) data 0.000 (0.022) loss 2.1581 (1.9192) ce_loss 1.1924 (0.9941) loss_zs_kd 1.9001 (1.9156) loss_oracle 0.4947 (0.5774) acc 65.6250 (63.5156) kd_loss 0.7184 (0.6365) lr 4.1221e-04 eta 0:07:31
epoch [37/50] batch [140/319] time 0.082 (0.101) data 0.000 (0.019) loss 1.7171 (1.9198) ce_loss 0.7476 (0.9934) loss_zs_kd 2.0528 (1.9346) loss_oracle 0.6400 (0.5779) acc 71.8750 (63.4375) kd_loss 0.6496 (0.6375) lr 4.1221e-04 eta 0:07:16
epoch [37/50] batch [160/319] time 0.085 (0.099) data 0.000 (0.016) loss 2.0102 (1.9211) ce_loss 1.1523 (0.9976) loss_zs_kd 1.7815 (1.9323) loss_oracle 0.5395 (0.5791) acc 56.2500 (63.1641) kd_loss 0.5881 (0.6340) lr 4.1221e-04 eta 0:07:05
epoch [37/50] batch [180/319] time 0.088 (0.097) data 0.000 (0.015) loss 2.0908 (1.9263) ce_loss 1.1074 (1.0022) loss_zs_kd 1.9482 (1.9337) loss_oracle 0.5637 (0.5792) acc 71.8750 (63.0035) kd_loss 0.7015 (0.6345) lr 4.1221e-04 eta 0:06:56
epoch [37/50] batch [200/319] time 0.080 (0.096) data 0.000 (0.013) loss 1.9157 (1.9241) ce_loss 0.9487 (0.9992) loss_zs_kd 1.9110 (1.9320) loss_oracle 0.5745 (0.5812) acc 71.8750 (63.1406) kd_loss 0.6798 (0.6343) lr 4.1221e-04 eta 0:06:49
epoch [37/50] batch [220/319] time 0.090 (0.095) data 0.000 (0.012) loss 2.1558 (1.9190) ce_loss 1.1738 (0.9937) loss_zs_kd 1.8299 (1.9254) loss_oracle 0.5678 (0.5801) acc 59.3750 (63.2812) kd_loss 0.6981 (0.6353) lr 4.1221e-04 eta 0:06:43
epoch [37/50] batch [240/319] time 0.091 (0.094) data 0.000 (0.011) loss 1.9037 (1.9126) ce_loss 0.9722 (0.9883) loss_zs_kd 1.8927 (1.9194) loss_oracle 0.5715 (0.5791) acc 68.7500 (63.2031) kd_loss 0.6458 (0.6348) lr 4.1221e-04 eta 0:06:37
epoch [37/50] batch [260/319] time 0.086 (0.094) data 0.000 (0.010) loss 2.2277 (1.9233) ce_loss 1.2471 (0.9964) loss_zs_kd 2.0734 (1.9211) loss_oracle 0.6513 (0.5806) acc 59.3750 (62.7764) kd_loss 0.6550 (0.6366) lr 4.1221e-04 eta 0:06:33
epoch [37/50] batch [280/319] time 0.087 (0.093) data 0.000 (0.009) loss 1.8432 (1.9251) ce_loss 0.9736 (0.9980) loss_zs_kd 1.7793 (1.9201) loss_oracle 0.5517 (0.5801) acc 56.2500 (62.7009) kd_loss 0.5937 (0.6370) lr 4.1221e-04 eta 0:06:29
epoch [37/50] batch [300/319] time 0.073 (0.092) data 0.000 (0.009) loss 1.9576 (1.9214) ce_loss 0.9648 (0.9952) loss_zs_kd 1.8606 (1.9189) loss_oracle 0.5801 (0.5803) acc 62.5000 (62.8854) kd_loss 0.7027 (0.6361) lr 4.1221e-04 eta 0:06:24
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,012
* accuracy: 68.8%
* error: 31.2%
* macro_f1: 61.8%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,373
* accuracy: 55.2%
* error: 44.8%
* macro_f1: 26.6%
******* Domain 2 best val acc:      68.8%, epoch: 37 *******
******* Domain 2 best val test acc: 55.2%, epoch: 37 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [38/50] batch [20/319] time 0.084 (0.253) data 0.000 (0.163) loss 1.7371 (1.9330) ce_loss 0.8813 (1.0378) loss_zs_kd 1.9093 (1.8391) loss_oracle 0.4845 (0.5796) acc 68.7500 (61.7188) kd_loss 0.6135 (0.6053) lr 3.6258e-04 eta 0:17:24
epoch [38/50] batch [40/319] time 0.083 (0.169) data 0.000 (0.081) loss 1.7634 (1.9152) ce_loss 1.0254 (1.0077) loss_zs_kd 1.6917 (1.8442) loss_oracle 0.5196 (0.5748) acc 65.6250 (62.6562) kd_loss 0.4782 (0.6201) lr 3.6258e-04 eta 0:11:33
epoch [38/50] batch [60/319] time 0.090 (0.141) data 0.000 (0.054) loss 2.0596 (1.9528) ce_loss 1.1572 (1.0395) loss_zs_kd 1.9617 (1.8412) loss_oracle 0.5806 (0.5693) acc 65.6250 (61.8750) kd_loss 0.6121 (0.6287) lr 3.6258e-04 eta 0:09:36
epoch [38/50] batch [80/319] time 0.085 (0.127) data 0.000 (0.041) loss 2.1177 (1.9305) ce_loss 1.1631 (1.0156) loss_zs_kd 2.2417 (1.8500) loss_oracle 0.7012 (0.5683) acc 50.0000 (62.8125) kd_loss 0.6041 (0.6308) lr 3.6258e-04 eta 0:08:36
epoch [38/50] batch [100/319] time 0.084 (0.118) data 0.000 (0.033) loss 1.9162 (1.9258) ce_loss 0.8994 (1.0073) loss_zs_kd 1.8110 (1.8623) loss_oracle 0.5561 (0.5687) acc 65.6250 (62.7812) kd_loss 0.7387 (0.6341) lr 3.6258e-04 eta 0:07:59
epoch [38/50] batch [120/319] time 0.082 (0.113) data 0.000 (0.027) loss 1.8517 (1.9240) ce_loss 0.9404 (1.0074) loss_zs_kd 1.8495 (1.8575) loss_oracle 0.5768 (0.5700) acc 62.5000 (62.5260) kd_loss 0.6228 (0.6316) lr 3.6258e-04 eta 0:07:35
epoch [38/50] batch [140/319] time 0.083 (0.109) data 0.000 (0.023) loss 2.0665 (1.9278) ce_loss 1.1025 (1.0091) loss_zs_kd 1.8584 (1.8631) loss_oracle 0.6193 (0.5718) acc 53.1250 (62.2991) kd_loss 0.6543 (0.6328) lr 3.6258e-04 eta 0:07:16
epoch [38/50] batch [160/319] time 0.083 (0.106) data 0.000 (0.021) loss 2.0374 (1.9278) ce_loss 0.9888 (1.0078) loss_zs_kd 1.8287 (1.8650) loss_oracle 0.5878 (0.5740) acc 59.3750 (62.3438) kd_loss 0.7548 (0.6330) lr 3.6258e-04 eta 0:07:02
epoch [38/50] batch [180/319] time 0.071 (0.103) data 0.000 (0.018) loss 1.9597 (1.9319) ce_loss 0.9624 (1.0100) loss_zs_kd 1.8067 (1.8653) loss_oracle 0.5989 (0.5725) acc 68.7500 (62.3958) kd_loss 0.6979 (0.6357) lr 3.6258e-04 eta 0:06:49
epoch [38/50] batch [200/319] time 0.080 (0.101) data 0.000 (0.017) loss 1.9470 (1.9356) ce_loss 1.0215 (1.0127) loss_zs_kd 1.9824 (1.8733) loss_oracle 0.5536 (0.5720) acc 56.2500 (62.0938) kd_loss 0.6487 (0.6369) lr 3.6258e-04 eta 0:06:38
epoch [38/50] batch [220/319] time 0.079 (0.099) data 0.000 (0.015) loss 2.0677 (1.9338) ce_loss 1.0000 (1.0087) loss_zs_kd 1.8979 (1.8703) loss_oracle 0.6106 (0.5732) acc 65.6250 (62.1023) kd_loss 0.7624 (0.6385) lr 3.6258e-04 eta 0:06:28
epoch [38/50] batch [240/319] time 0.082 (0.098) data 0.000 (0.014) loss 1.6715 (1.9280) ce_loss 0.7998 (1.0041) loss_zs_kd 1.7284 (1.8742) loss_oracle 0.6027 (0.5721) acc 62.5000 (62.2396) kd_loss 0.5703 (0.6379) lr 3.6258e-04 eta 0:06:21
epoch [38/50] batch [260/319] time 0.093 (0.096) data 0.000 (0.013) loss 2.3855 (1.9298) ce_loss 1.4023 (1.0043) loss_zs_kd 2.0365 (1.8712) loss_oracle 0.5908 (0.5718) acc 50.0000 (62.2957) kd_loss 0.6878 (0.6396) lr 3.6258e-04 eta 0:06:14
epoch [38/50] batch [280/319] time 0.080 (0.095) data 0.000 (0.012) loss 1.8116 (1.9299) ce_loss 0.7983 (1.0031) loss_zs_kd 1.8545 (1.8738) loss_oracle 0.5742 (0.5712) acc 68.7500 (62.1652) kd_loss 0.7261 (0.6412) lr 3.6258e-04 eta 0:06:07
epoch [38/50] batch [300/319] time 0.076 (0.094) data 0.000 (0.011) loss 2.1526 (1.9310) ce_loss 1.1963 (1.0034) loss_zs_kd 1.9767 (1.8781) loss_oracle 0.6254 (0.5720) acc 62.5000 (62.2604) kd_loss 0.6436 (0.6416) lr 3.6258e-04 eta 0:06:02
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,001
* accuracy: 68.5%
* error: 31.5%
* macro_f1: 61.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,649
* accuracy: 58.0%
* error: 42.0%
* macro_f1: 26.2%
******* Domain 2 best val acc:      68.8%, epoch: 37 *******
******* Domain 2 best val test acc: 55.2%, epoch: 37 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [39/50] batch [20/319] time 0.088 (0.272) data 0.000 (0.185) loss 1.7677 (1.9046) ce_loss 0.8989 (0.9730) loss_zs_kd 2.1017 (1.9244) loss_oracle 0.5417 (0.5768) acc 65.6250 (67.0312) kd_loss 0.5979 (0.6432) lr 3.1545e-04 eta 0:17:14
epoch [39/50] batch [40/319] time 0.074 (0.175) data 0.000 (0.093) loss 2.1683 (1.9046) ce_loss 1.2100 (0.9786) loss_zs_kd 1.7420 (1.9279) loss_oracle 0.5283 (0.5688) acc 53.1250 (66.1719) kd_loss 0.6942 (0.6415) lr 3.1545e-04 eta 0:11:02
epoch [39/50] batch [60/319] time 0.086 (0.144) data 0.000 (0.062) loss 1.6715 (1.8994) ce_loss 0.7646 (0.9848) loss_zs_kd 1.9758 (1.9186) loss_oracle 0.5555 (0.5677) acc 75.0000 (65.1042) kd_loss 0.6290 (0.6307) lr 3.1545e-04 eta 0:09:00
epoch [39/50] batch [80/319] time 0.095 (0.129) data 0.000 (0.046) loss 1.9040 (1.9065) ce_loss 1.0078 (0.9833) loss_zs_kd 2.2151 (1.9242) loss_oracle 0.5963 (0.5690) acc 65.6250 (64.7656) kd_loss 0.5981 (0.6388) lr 3.1545e-04 eta 0:08:02
epoch [39/50] batch [100/319] time 0.080 (0.120) data 0.000 (0.037) loss 2.3695 (1.9180) ce_loss 1.3184 (0.9913) loss_zs_kd 2.0009 (1.9139) loss_oracle 0.5672 (0.5697) acc 53.1250 (64.1562) kd_loss 0.7675 (0.6419) lr 3.1545e-04 eta 0:07:26
epoch [39/50] batch [120/319] time 0.086 (0.113) data 0.000 (0.031) loss 2.1095 (1.9193) ce_loss 1.1299 (0.9886) loss_zs_kd 1.7658 (1.9184) loss_oracle 0.6687 (0.5731) acc 59.3750 (64.1927) kd_loss 0.6452 (0.6441) lr 3.1545e-04 eta 0:07:00
epoch [39/50] batch [140/319] time 0.096 (0.109) data 0.000 (0.027) loss 1.7604 (1.9190) ce_loss 0.7744 (0.9870) loss_zs_kd 2.2561 (1.9166) loss_oracle 0.5722 (0.5756) acc 71.8750 (64.3750) kd_loss 0.6999 (0.6441) lr 3.1545e-04 eta 0:06:41
epoch [39/50] batch [160/319] time 0.083 (0.106) data 0.000 (0.023) loss 1.9335 (1.9119) ce_loss 0.8667 (0.9836) loss_zs_kd 2.0580 (1.9162) loss_oracle 0.6076 (0.5734) acc 56.2500 (64.2188) kd_loss 0.7630 (0.6416) lr 3.1545e-04 eta 0:06:27
epoch [39/50] batch [180/319] time 0.080 (0.103) data 0.000 (0.021) loss 1.8428 (1.9165) ce_loss 0.8115 (0.9858) loss_zs_kd 1.9681 (1.9076) loss_oracle 0.6377 (0.5741) acc 75.0000 (64.0625) kd_loss 0.7124 (0.6437) lr 3.1545e-04 eta 0:06:17
epoch [39/50] batch [200/319] time 0.090 (0.101) data 0.000 (0.019) loss 1.8821 (1.9106) ce_loss 1.0029 (0.9835) loss_zs_kd 1.7306 (1.9004) loss_oracle 0.5411 (0.5726) acc 62.5000 (63.9531) kd_loss 0.6086 (0.6407) lr 3.1545e-04 eta 0:06:08
epoch [39/50] batch [220/319] time 0.083 (0.100) data 0.000 (0.017) loss 1.8785 (1.9063) ce_loss 0.9214 (0.9823) loss_zs_kd 1.9526 (1.9008) loss_oracle 0.5740 (0.5712) acc 68.7500 (63.9915) kd_loss 0.6701 (0.6384) lr 3.1545e-04 eta 0:05:59
epoch [39/50] batch [240/319] time 0.088 (0.098) data 0.000 (0.016) loss 2.2106 (1.9063) ce_loss 1.2656 (0.9852) loss_zs_kd 1.8667 (1.8992) loss_oracle 0.6076 (0.5716) acc 50.0000 (63.8411) kd_loss 0.6412 (0.6354) lr 3.1545e-04 eta 0:05:52
epoch [39/50] batch [260/319] time 0.090 (0.097) data 0.000 (0.014) loss 1.6684 (1.9067) ce_loss 0.8643 (0.9866) loss_zs_kd 1.6962 (1.9001) loss_oracle 0.5581 (0.5721) acc 68.7500 (63.6418) kd_loss 0.5251 (0.6340) lr 3.1545e-04 eta 0:05:45
epoch [39/50] batch [280/319] time 0.079 (0.096) data 0.000 (0.013) loss 2.2321 (1.9096) ce_loss 1.3701 (0.9907) loss_zs_kd 1.8385 (1.8988) loss_oracle 0.5360 (0.5717) acc 46.8750 (63.4263) kd_loss 0.5940 (0.6331) lr 3.1545e-04 eta 0:05:39
epoch [39/50] batch [300/319] time 0.078 (0.095) data 0.000 (0.013) loss 1.7765 (1.9127) ce_loss 0.9277 (0.9933) loss_zs_kd 2.1294 (1.9035) loss_oracle 0.5689 (0.5721) acc 62.5000 (63.3646) kd_loss 0.5643 (0.6333) lr 3.1545e-04 eta 0:05:34
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,998
* accuracy: 68.5%
* error: 31.5%
* macro_f1: 61.0%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,285
* accuracy: 54.3%
* error: 45.7%
* macro_f1: 24.2%
******* Domain 2 best val acc:      68.8%, epoch: 37 *******
******* Domain 2 best val test acc: 55.2%, epoch: 37 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [40/50] batch [20/319] time 0.081 (0.241) data 0.000 (0.157) loss 1.8695 (1.8448) ce_loss 1.0361 (0.9317) loss_zs_kd 1.6430 (1.8366) loss_oracle 0.5060 (0.5626) acc 56.2500 (67.3438) kd_loss 0.5804 (0.6317) lr 2.7103e-04 eta 0:14:01
epoch [40/50] batch [40/319] time 0.084 (0.163) data 0.000 (0.079) loss 1.8571 (1.9289) ce_loss 0.9585 (0.9972) loss_zs_kd 1.8282 (1.8930) loss_oracle 0.5425 (0.5652) acc 71.8750 (63.4375) kd_loss 0.6273 (0.6491) lr 2.7103e-04 eta 0:09:23
epoch [40/50] batch [60/319] time 0.084 (0.137) data 0.000 (0.053) loss 1.9274 (1.9188) ce_loss 0.9194 (0.9903) loss_zs_kd 2.1970 (1.9179) loss_oracle 0.5806 (0.5639) acc 56.2500 (63.8542) kd_loss 0.7177 (0.6465) lr 2.7103e-04 eta 0:07:51
epoch [40/50] batch [80/319] time 0.082 (0.124) data 0.000 (0.039) loss 1.9222 (1.9039) ce_loss 0.9688 (0.9717) loss_zs_kd 1.7082 (1.9288) loss_oracle 0.6096 (0.5694) acc 62.5000 (64.1797) kd_loss 0.6486 (0.6475) lr 2.7103e-04 eta 0:07:04
epoch [40/50] batch [100/319] time 0.086 (0.116) data 0.000 (0.032) loss 1.7556 (1.9033) ce_loss 0.8726 (0.9735) loss_zs_kd 1.5458 (1.9062) loss_oracle 0.5556 (0.5682) acc 71.8750 (63.9375) kd_loss 0.6052 (0.6457) lr 2.7103e-04 eta 0:06:35
epoch [40/50] batch [120/319] time 0.085 (0.111) data 0.000 (0.026) loss 1.7122 (1.8969) ce_loss 0.7798 (0.9682) loss_zs_kd 2.1364 (1.9088) loss_oracle 0.5848 (0.5690) acc 75.0000 (64.2188) kd_loss 0.6400 (0.6442) lr 2.7103e-04 eta 0:06:15
epoch [40/50] batch [140/319] time 0.068 (0.107) data 0.000 (0.023) loss 2.1668 (1.9091) ce_loss 1.0781 (0.9812) loss_zs_kd 1.8733 (1.9009) loss_oracle 0.6653 (0.5695) acc 56.2500 (63.8839) kd_loss 0.7560 (0.6431) lr 2.7103e-04 eta 0:06:00
epoch [40/50] batch [160/319] time 0.072 (0.103) data 0.000 (0.020) loss 1.8385 (1.8988) ce_loss 0.9375 (0.9757) loss_zs_kd 1.9452 (1.9086) loss_oracle 0.5794 (0.5668) acc 62.5000 (64.0234) kd_loss 0.6113 (0.6396) lr 2.7103e-04 eta 0:05:44
epoch [40/50] batch [180/319] time 0.091 (0.100) data 0.001 (0.018) loss 2.2503 (1.8974) ce_loss 1.3633 (0.9756) loss_zs_kd 1.7492 (1.9146) loss_oracle 0.5811 (0.5689) acc 50.0000 (63.8889) kd_loss 0.5965 (0.6373) lr 2.7103e-04 eta 0:05:34
epoch [40/50] batch [200/319] time 0.092 (0.098) data 0.000 (0.016) loss 2.0332 (1.9091) ce_loss 1.0869 (0.9888) loss_zs_kd 1.9046 (1.9126) loss_oracle 0.6429 (0.5688) acc 56.2500 (63.4219) kd_loss 0.6248 (0.6359) lr 2.7103e-04 eta 0:05:25
epoch [40/50] batch [220/319] time 0.083 (0.097) data 0.000 (0.015) loss 2.0878 (1.9141) ce_loss 1.1904 (0.9947) loss_zs_kd 1.9864 (1.9156) loss_oracle 0.5716 (0.5687) acc 50.0000 (62.9688) kd_loss 0.6115 (0.6351) lr 2.7103e-04 eta 0:05:19
epoch [40/50] batch [240/319] time 0.074 (0.096) data 0.000 (0.013) loss 2.0367 (1.9132) ce_loss 1.1611 (0.9926) loss_zs_kd 1.7761 (1.9209) loss_oracle 0.5128 (0.5692) acc 62.5000 (63.1901) kd_loss 0.6192 (0.6360) lr 2.7103e-04 eta 0:05:12
epoch [40/50] batch [260/319] time 0.077 (0.094) data 0.000 (0.012) loss 1.8459 (1.9126) ce_loss 1.0166 (0.9944) loss_zs_kd 1.9566 (1.9235) loss_oracle 0.4669 (0.5686) acc 65.6250 (63.1250) kd_loss 0.5959 (0.6339) lr 2.7103e-04 eta 0:05:06
epoch [40/50] batch [280/319] time 0.080 (0.094) data 0.000 (0.011) loss 2.1045 (1.9146) ce_loss 1.2100 (0.9968) loss_zs_kd 1.9281 (1.9236) loss_oracle 0.6290 (0.5680) acc 56.2500 (63.0246) kd_loss 0.5800 (0.6338) lr 2.7103e-04 eta 0:05:01
epoch [40/50] batch [300/319] time 0.074 (0.093) data 0.000 (0.011) loss 2.2104 (1.9191) ce_loss 1.1660 (0.9997) loss_zs_kd 1.6661 (1.9233) loss_oracle 0.5949 (0.5690) acc 59.3750 (63.0000) kd_loss 0.7469 (0.6349) lr 2.7103e-04 eta 0:04:57
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,002
* accuracy: 68.6%
* error: 31.4%
* macro_f1: 61.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,366
* accuracy: 55.1%
* error: 44.9%
* macro_f1: 25.6%
******* Domain 2 best val acc:      68.8%, epoch: 37 *******
******* Domain 2 best val test acc: 55.2%, epoch: 37 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [41/50] batch [20/319] time 0.087 (0.233) data 0.000 (0.142) loss 1.8606 (1.8969) ce_loss 0.9448 (0.9763) loss_zs_kd 2.1359 (1.9552) loss_oracle 0.5754 (0.5696) acc 62.5000 (63.9062) kd_loss 0.6281 (0.6358) lr 2.2949e-04 eta 0:12:19
epoch [41/50] batch [40/319] time 0.090 (0.160) data 0.000 (0.071) loss 2.0573 (1.9323) ce_loss 1.0674 (0.9937) loss_zs_kd 2.4335 (1.9722) loss_oracle 0.5788 (0.5687) acc 65.6250 (63.3594) kd_loss 0.7005 (0.6543) lr 2.2949e-04 eta 0:08:23
epoch [41/50] batch [60/319] time 0.078 (0.133) data 0.000 (0.048) loss 1.9586 (1.9451) ce_loss 1.0781 (1.0103) loss_zs_kd 1.7755 (1.9579) loss_oracle 0.5186 (0.5667) acc 62.5000 (62.8125) kd_loss 0.6212 (0.6515) lr 2.2949e-04 eta 0:06:57
epoch [41/50] batch [80/319] time 0.075 (0.120) data 0.000 (0.036) loss 1.9325 (1.9517) ce_loss 0.9946 (1.0111) loss_zs_kd 2.0676 (1.9665) loss_oracle 0.5176 (0.5656) acc 50.0000 (62.7344) kd_loss 0.6791 (0.6579) lr 2.2949e-04 eta 0:06:12
epoch [41/50] batch [100/319] time 0.083 (0.113) data 0.000 (0.029) loss 1.8415 (1.9447) ce_loss 0.9165 (1.0084) loss_zs_kd 1.7775 (1.9531) loss_oracle 0.6075 (0.5655) acc 68.7500 (63.1250) kd_loss 0.6213 (0.6535) lr 2.2949e-04 eta 0:05:48
epoch [41/50] batch [120/319] time 0.074 (0.108) data 0.000 (0.024) loss 1.6771 (1.9469) ce_loss 0.8237 (1.0111) loss_zs_kd 1.8946 (1.9503) loss_oracle 0.4628 (0.5642) acc 78.1250 (62.9948) kd_loss 0.6220 (0.6538) lr 2.2949e-04 eta 0:05:30
epoch [41/50] batch [140/319] time 0.076 (0.103) data 0.000 (0.021) loss 1.8669 (1.9415) ce_loss 0.8452 (1.0041) loss_zs_kd 1.9915 (1.9451) loss_oracle 0.6735 (0.5675) acc 68.7500 (63.3482) kd_loss 0.6849 (0.6536) lr 2.2949e-04 eta 0:05:14
epoch [41/50] batch [160/319] time 0.073 (0.100) data 0.000 (0.018) loss 1.8249 (1.9367) ce_loss 1.0059 (1.0050) loss_zs_kd 1.7575 (1.9334) loss_oracle 0.5981 (0.5681) acc 62.5000 (63.1445) kd_loss 0.5201 (0.6476) lr 2.2949e-04 eta 0:05:02
epoch [41/50] batch [180/319] time 0.079 (0.097) data 0.000 (0.016) loss 1.8763 (1.9384) ce_loss 0.9810 (1.0070) loss_zs_kd 1.9353 (1.9320) loss_oracle 0.6101 (0.5691) acc 71.8750 (62.9688) kd_loss 0.5903 (0.6469) lr 2.2949e-04 eta 0:04:53
epoch [41/50] batch [200/319] time 0.085 (0.096) data 0.000 (0.014) loss 1.8953 (1.9324) ce_loss 0.9453 (1.0025) loss_zs_kd 1.8700 (1.9260) loss_oracle 0.6323 (0.5692) acc 68.7500 (63.0938) kd_loss 0.6338 (0.6453) lr 2.2949e-04 eta 0:04:46
epoch [41/50] batch [220/319] time 0.077 (0.094) data 0.000 (0.013) loss 2.0087 (1.9304) ce_loss 1.0820 (0.9986) loss_zs_kd 1.9200 (1.9229) loss_oracle 0.5549 (0.5705) acc 62.5000 (63.1534) kd_loss 0.6492 (0.6466) lr 2.2949e-04 eta 0:04:40
epoch [41/50] batch [240/319] time 0.081 (0.093) data 0.000 (0.012) loss 1.8323 (1.9279) ce_loss 1.0293 (0.9983) loss_zs_kd 1.8932 (1.9230) loss_oracle 0.5157 (0.5707) acc 56.2500 (63.0469) kd_loss 0.5452 (0.6443) lr 2.2949e-04 eta 0:04:34
epoch [41/50] batch [260/319] time 0.078 (0.092) data 0.000 (0.011) loss 2.0294 (1.9290) ce_loss 1.0479 (0.9999) loss_zs_kd 1.9372 (1.9244) loss_oracle 0.6002 (0.5709) acc 59.3750 (62.7885) kd_loss 0.6815 (0.6436) lr 2.2949e-04 eta 0:04:29
epoch [41/50] batch [280/319] time 0.085 (0.091) data 0.000 (0.010) loss 1.8730 (1.9303) ce_loss 0.8584 (1.0017) loss_zs_kd 1.8694 (1.9237) loss_oracle 0.5706 (0.5707) acc 71.8750 (62.6004) kd_loss 0.7292 (0.6432) lr 2.2949e-04 eta 0:04:25
epoch [41/50] batch [300/319] time 0.078 (0.091) data 0.000 (0.010) loss 1.9020 (1.9280) ce_loss 1.0293 (1.0000) loss_zs_kd 1.7371 (1.9217) loss_oracle 0.5460 (0.5707) acc 68.7500 (62.5833) kd_loss 0.5997 (0.6426) lr 2.2949e-04 eta 0:04:21
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 2,981
* accuracy: 68.1%
* error: 31.9%
* macro_f1: 60.4%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,397
* accuracy: 55.4%
* error: 44.6%
* macro_f1: 25.2%
******* Domain 2 best val acc:      68.8%, epoch: 37 *******
******* Domain 2 best val test acc: 55.2%, epoch: 37 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [42/50] batch [20/319] time 0.087 (0.205) data 0.000 (0.120) loss 2.0401 (1.9515) ce_loss 1.1133 (1.0283) loss_zs_kd 1.9255 (1.8122) loss_oracle 0.5638 (0.5661) acc 59.3750 (62.3438) kd_loss 0.6449 (0.6402) lr 1.9098e-04 eta 0:09:43
epoch [42/50] batch [40/319] time 0.076 (0.144) data 0.000 (0.060) loss 1.6501 (1.9476) ce_loss 0.6948 (1.0178) loss_zs_kd 1.8044 (1.8483) loss_oracle 0.5455 (0.5696) acc 78.1250 (62.7344) kd_loss 0.6825 (0.6450) lr 1.9098e-04 eta 0:06:48
epoch [42/50] batch [60/319] time 0.085 (0.125) data 0.000 (0.040) loss 2.1504 (1.9553) ce_loss 1.1074 (1.0227) loss_zs_kd 1.5817 (1.8540) loss_oracle 0.5417 (0.5671) acc 53.1250 (62.3958) kd_loss 0.7722 (0.6490) lr 1.9098e-04 eta 0:05:50
epoch [42/50] batch [80/319] time 0.084 (0.115) data 0.000 (0.030) loss 2.0302 (1.9514) ce_loss 1.0293 (1.0179) loss_zs_kd 1.8125 (1.8607) loss_oracle 0.5341 (0.5708) acc 40.6250 (62.3047) kd_loss 0.7339 (0.6481) lr 1.9098e-04 eta 0:05:20
epoch [42/50] batch [100/319] time 0.081 (0.108) data 0.000 (0.024) loss 2.4890 (1.9616) ce_loss 1.5107 (1.0280) loss_zs_kd 2.0808 (1.8838) loss_oracle 0.5889 (0.5709) acc 40.6250 (61.8750) kd_loss 0.6838 (0.6481) lr 1.9098e-04 eta 0:05:00
epoch [42/50] batch [120/319] time 0.086 (0.104) data 0.000 (0.020) loss 1.8776 (1.9439) ce_loss 1.0420 (1.0163) loss_zs_kd 2.0182 (1.9021) loss_oracle 0.6015 (0.5709) acc 62.5000 (62.2396) kd_loss 0.5349 (0.6422) lr 1.9098e-04 eta 0:04:46
epoch [42/50] batch [140/319] time 0.085 (0.104) data 0.000 (0.017) loss 1.6037 (1.9433) ce_loss 0.6157 (1.0154) loss_zs_kd 2.1134 (1.9091) loss_oracle 0.5262 (0.5724) acc 78.1250 (62.1429) kd_loss 0.7248 (0.6418) lr 1.9098e-04 eta 0:04:43
epoch [42/50] batch [160/319] time 0.088 (0.101) data 0.000 (0.015) loss 2.1827 (1.9448) ce_loss 1.2510 (1.0183) loss_zs_kd 1.9417 (1.9143) loss_oracle 0.5576 (0.5728) acc 53.1250 (62.2070) kd_loss 0.6529 (0.6401) lr 1.9098e-04 eta 0:04:32
epoch [42/50] batch [180/319] time 0.087 (0.099) data 0.000 (0.014) loss 1.8871 (1.9428) ce_loss 1.0156 (1.0163) loss_zs_kd 1.9220 (1.9198) loss_oracle 0.5411 (0.5727) acc 65.6250 (62.5347) kd_loss 0.6010 (0.6401) lr 1.9098e-04 eta 0:04:25
epoch [42/50] batch [200/319] time 0.081 (0.097) data 0.000 (0.012) loss 1.8365 (1.9374) ce_loss 0.9380 (1.0102) loss_zs_kd 1.6745 (1.9192) loss_oracle 0.5954 (0.5734) acc 65.6250 (62.6094) kd_loss 0.6007 (0.6405) lr 1.9098e-04 eta 0:04:19
epoch [42/50] batch [220/319] time 0.092 (0.096) data 0.000 (0.011) loss 1.9843 (1.9311) ce_loss 1.1006 (1.0057) loss_zs_kd 1.5404 (1.9166) loss_oracle 0.5645 (0.5710) acc 59.3750 (62.7131) kd_loss 0.6015 (0.6399) lr 1.9098e-04 eta 0:04:14
epoch [42/50] batch [240/319] time 0.080 (0.095) data 0.000 (0.010) loss 1.9903 (1.9268) ce_loss 1.1504 (1.0025) loss_zs_kd 1.9684 (1.9177) loss_oracle 0.5479 (0.5710) acc 59.3750 (62.7995) kd_loss 0.5660 (0.6389) lr 1.9098e-04 eta 0:04:09
epoch [42/50] batch [260/319] time 0.094 (0.094) data 0.000 (0.009) loss 1.9405 (1.9217) ce_loss 1.0967 (0.9992) loss_zs_kd 1.9619 (1.9177) loss_oracle 0.4820 (0.5693) acc 53.1250 (62.9447) kd_loss 0.6029 (0.6379) lr 1.9098e-04 eta 0:04:06
epoch [42/50] batch [280/319] time 0.082 (0.094) data 0.001 (0.009) loss 2.1146 (1.9202) ce_loss 1.0850 (0.9983) loss_zs_kd 1.7217 (1.9204) loss_oracle 0.6548 (0.5700) acc 68.7500 (63.1138) kd_loss 0.7023 (0.6369) lr 1.9098e-04 eta 0:04:02
epoch [42/50] batch [300/319] time 0.070 (0.093) data 0.000 (0.008) loss 1.8093 (1.9199) ce_loss 0.9541 (1.0003) loss_zs_kd 2.1203 (1.9230) loss_oracle 0.5077 (0.5690) acc 65.6250 (63.0208) kd_loss 0.6014 (0.6350) lr 1.9098e-04 eta 0:03:58
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,017
* accuracy: 68.9%
* error: 31.1%
* macro_f1: 61.7%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,473
* accuracy: 56.2%
* error: 43.8%
* macro_f1: 25.6%
******* Domain 2 best val acc:      68.9%, epoch: 42 *******
******* Domain 2 best val test acc: 56.2%, epoch: 42 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [43/50] batch [20/319] time 0.087 (0.233) data 0.000 (0.140) loss 1.9103 (1.8557) ce_loss 0.8994 (0.9658) loss_zs_kd 2.4239 (1.9601) loss_oracle 0.5478 (0.5637) acc 59.3750 (65.1562) kd_loss 0.7370 (0.6081) lr 1.5567e-04 eta 0:09:49
epoch [43/50] batch [40/319] time 0.081 (0.158) data 0.000 (0.070) loss 2.2182 (1.8846) ce_loss 1.3271 (0.9897) loss_zs_kd 1.9111 (1.9330) loss_oracle 0.5304 (0.5644) acc 59.3750 (63.0469) kd_loss 0.6259 (0.6127) lr 1.5567e-04 eta 0:06:36
epoch [43/50] batch [60/319] time 0.083 (0.134) data 0.000 (0.047) loss 2.1044 (1.8578) ce_loss 1.2754 (0.9781) loss_zs_kd 1.8645 (1.9334) loss_oracle 0.5327 (0.5581) acc 53.1250 (63.2292) kd_loss 0.5627 (0.6007) lr 1.5567e-04 eta 0:05:34
epoch [43/50] batch [80/319] time 0.084 (0.122) data 0.000 (0.035) loss 1.7795 (1.8688) ce_loss 0.8208 (0.9833) loss_zs_kd 2.0263 (1.9313) loss_oracle 0.5743 (0.5617) acc 84.3750 (63.3984) kd_loss 0.6715 (0.6046) lr 1.5567e-04 eta 0:05:02
epoch [43/50] batch [100/319] time 0.100 (0.115) data 0.000 (0.028) loss 1.6901 (1.8689) ce_loss 0.8486 (0.9782) loss_zs_kd 2.0251 (1.9261) loss_oracle 0.5650 (0.5636) acc 65.6250 (63.2500) kd_loss 0.5590 (0.6089) lr 1.5567e-04 eta 0:04:41
epoch [43/50] batch [120/319] time 0.077 (0.110) data 0.000 (0.024) loss 1.8121 (1.8803) ce_loss 0.9644 (0.9818) loss_zs_kd 1.8123 (1.9117) loss_oracle 0.4927 (0.5650) acc 65.6250 (63.4375) kd_loss 0.6014 (0.6159) lr 1.5567e-04 eta 0:04:28
epoch [43/50] batch [140/319] time 0.082 (0.107) data 0.000 (0.020) loss 2.2007 (1.8876) ce_loss 1.2764 (0.9870) loss_zs_kd 1.6081 (1.9188) loss_oracle 0.5689 (0.5687) acc 50.0000 (63.1920) kd_loss 0.6399 (0.6162) lr 1.5567e-04 eta 0:04:16
epoch [43/50] batch [160/319] time 0.075 (0.104) data 0.000 (0.018) loss 1.7756 (1.8857) ce_loss 0.8491 (0.9825) loss_zs_kd 2.2387 (1.9254) loss_oracle 0.5924 (0.5693) acc 62.5000 (63.2617) kd_loss 0.6303 (0.6185) lr 1.5567e-04 eta 0:04:07
epoch [43/50] batch [180/319] time 0.079 (0.101) data 0.000 (0.016) loss 1.8526 (1.8944) ce_loss 0.9673 (0.9909) loss_zs_kd 1.7686 (1.9278) loss_oracle 0.5426 (0.5698) acc 68.7500 (63.1597) kd_loss 0.6140 (0.6186) lr 1.5567e-04 eta 0:04:00
epoch [43/50] batch [200/319] time 0.088 (0.100) data 0.000 (0.014) loss 2.0349 (1.8980) ce_loss 1.0879 (0.9932) loss_zs_kd 1.8544 (1.9264) loss_oracle 0.6025 (0.5682) acc 56.2500 (62.9375) kd_loss 0.6457 (0.6208) lr 1.5567e-04 eta 0:03:54
epoch [43/50] batch [220/319] time 0.086 (0.098) data 0.000 (0.013) loss 1.9582 (1.9047) ce_loss 1.0947 (0.9966) loss_zs_kd 2.0741 (1.9132) loss_oracle 0.6238 (0.5694) acc 62.5000 (62.7983) kd_loss 0.5515 (0.6234) lr 1.5567e-04 eta 0:03:49
epoch [43/50] batch [240/319] time 0.079 (0.097) data 0.000 (0.012) loss 1.7735 (1.9044) ce_loss 0.9409 (0.9951) loss_zs_kd 2.0828 (1.9106) loss_oracle 0.4781 (0.5698) acc 62.5000 (62.8776) kd_loss 0.5935 (0.6244) lr 1.5567e-04 eta 0:03:44
epoch [43/50] batch [260/319] time 0.076 (0.096) data 0.000 (0.011) loss 1.7959 (1.9045) ce_loss 0.9214 (0.9945) loss_zs_kd 2.0832 (1.9089) loss_oracle 0.5118 (0.5692) acc 65.6250 (62.9688) kd_loss 0.6186 (0.6254) lr 1.5567e-04 eta 0:03:40
epoch [43/50] batch [280/319] time 0.078 (0.095) data 0.000 (0.010) loss 1.7136 (1.9015) ce_loss 0.8652 (0.9902) loss_zs_kd 1.8739 (1.9084) loss_oracle 0.5323 (0.5696) acc 62.5000 (63.1027) kd_loss 0.5823 (0.6264) lr 1.5567e-04 eta 0:03:35
epoch [43/50] batch [300/319] time 0.087 (0.094) data 0.000 (0.010) loss 1.9916 (1.9012) ce_loss 1.0732 (0.9882) loss_zs_kd 1.7489 (1.9097) loss_oracle 0.5349 (0.5698) acc 62.5000 (63.1250) kd_loss 0.6509 (0.6281) lr 1.5567e-04 eta 0:03:32
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,013
* accuracy: 68.8%
* error: 31.2%
* macro_f1: 61.3%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,480
* accuracy: 56.3%
* error: 43.7%
* macro_f1: 24.7%
******* Domain 2 best val acc:      68.9%, epoch: 42 *******
******* Domain 2 best val test acc: 56.2%, epoch: 42 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [44/50] batch [20/319] time 0.078 (0.268) data 0.000 (0.174) loss 2.1815 (1.9184) ce_loss 1.2383 (0.9683) loss_zs_kd 1.8897 (1.9458) loss_oracle 0.6073 (0.5894) acc 65.6250 (65.3125) kd_loss 0.6396 (0.6554) lr 1.2369e-04 eta 0:09:54
epoch [44/50] batch [40/319] time 0.086 (0.174) data 0.000 (0.087) loss 2.0927 (1.9340) ce_loss 1.2070 (0.9981) loss_zs_kd 1.6889 (1.9352) loss_oracle 0.6096 (0.5837) acc 59.3750 (63.6719) kd_loss 0.5808 (0.6441) lr 1.2369e-04 eta 0:06:21
epoch [44/50] batch [60/319] time 0.079 (0.144) data 0.000 (0.058) loss 1.5590 (1.9187) ce_loss 0.6353 (0.9908) loss_zs_kd 1.7417 (1.9171) loss_oracle 0.5409 (0.5774) acc 81.2500 (63.5938) kd_loss 0.6533 (0.6391) lr 1.2369e-04 eta 0:05:13
epoch [44/50] batch [80/319] time 0.075 (0.128) data 0.000 (0.044) loss 1.9071 (1.9032) ce_loss 1.0449 (0.9832) loss_zs_kd 1.8266 (1.9059) loss_oracle 0.5649 (0.5697) acc 65.6250 (63.8672) kd_loss 0.5797 (0.6352) lr 1.2369e-04 eta 0:04:34
epoch [44/50] batch [100/319] time 0.087 (0.118) data 0.000 (0.035) loss 2.0930 (1.9127) ce_loss 0.9873 (0.9871) loss_zs_kd 1.7094 (1.9104) loss_oracle 0.5719 (0.5698) acc 62.5000 (63.5938) kd_loss 0.8198 (0.6407) lr 1.2369e-04 eta 0:04:12
epoch [44/50] batch [120/319] time 0.083 (0.113) data 0.000 (0.029) loss 2.0070 (1.9204) ce_loss 1.0898 (0.9999) loss_zs_kd 1.9767 (1.9013) loss_oracle 0.6234 (0.5684) acc 59.3750 (62.9427) kd_loss 0.6055 (0.6362) lr 1.2369e-04 eta 0:03:58
epoch [44/50] batch [140/319] time 0.085 (0.109) data 0.000 (0.025) loss 2.0173 (1.9260) ce_loss 1.0723 (1.0045) loss_zs_kd 1.9824 (1.8997) loss_oracle 0.5679 (0.5696) acc 62.5000 (62.6339) kd_loss 0.6611 (0.6367) lr 1.2369e-04 eta 0:03:47
epoch [44/50] batch [160/319] time 0.092 (0.106) data 0.000 (0.022) loss 1.8970 (1.9255) ce_loss 0.9512 (1.0045) loss_zs_kd 1.7945 (1.9082) loss_oracle 0.5728 (0.5680) acc 59.3750 (62.6367) kd_loss 0.6594 (0.6370) lr 1.2369e-04 eta 0:03:38
epoch [44/50] batch [180/319] time 0.080 (0.104) data 0.000 (0.020) loss 2.0215 (1.9280) ce_loss 1.1260 (1.0071) loss_zs_kd 1.6696 (1.9046) loss_oracle 0.6256 (0.5682) acc 59.3750 (62.5000) kd_loss 0.5827 (0.6368) lr 1.2369e-04 eta 0:03:32
epoch [44/50] batch [200/319] time 0.080 (0.102) data 0.000 (0.018) loss 1.6044 (1.9234) ce_loss 0.6064 (1.0032) loss_zs_kd 1.7548 (1.9078) loss_oracle 0.6367 (0.5686) acc 78.1250 (62.6094) kd_loss 0.6796 (0.6359) lr 1.2369e-04 eta 0:03:26
epoch [44/50] batch [220/319] time 0.078 (0.100) data 0.000 (0.016) loss 1.7871 (1.9235) ce_loss 0.8838 (1.0007) loss_zs_kd 1.9389 (1.9117) loss_oracle 0.6076 (0.5703) acc 68.7500 (62.5284) kd_loss 0.5995 (0.6376) lr 1.2369e-04 eta 0:03:21
epoch [44/50] batch [240/319] time 0.082 (0.098) data 0.000 (0.015) loss 1.9846 (1.9178) ce_loss 1.1064 (0.9957) loss_zs_kd 2.3418 (1.9155) loss_oracle 0.5368 (0.5702) acc 71.8750 (62.7734) kd_loss 0.6098 (0.6371) lr 1.2369e-04 eta 0:03:16
epoch [44/50] batch [260/319] time 0.081 (0.097) data 0.000 (0.014) loss 1.9745 (1.9171) ce_loss 1.1064 (0.9960) loss_zs_kd 1.7623 (1.9123) loss_oracle 0.4825 (0.5694) acc 62.5000 (62.7404) kd_loss 0.6268 (0.6364) lr 1.2369e-04 eta 0:03:11
epoch [44/50] batch [280/319] time 0.082 (0.096) data 0.000 (0.013) loss 2.0834 (1.9161) ce_loss 1.1172 (0.9949) loss_zs_kd 1.9231 (1.9111) loss_oracle 0.5224 (0.5689) acc 59.3750 (62.9464) kd_loss 0.7050 (0.6367) lr 1.2369e-04 eta 0:03:07
epoch [44/50] batch [300/319] time 0.077 (0.095) data 0.000 (0.012) loss 1.9637 (1.9184) ce_loss 1.0146 (0.9956) loss_zs_kd 2.0244 (1.9060) loss_oracle 0.6362 (0.5694) acc 59.3750 (62.9583) kd_loss 0.6310 (0.6381) lr 1.2369e-04 eta 0:03:03
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,031
* accuracy: 69.2%
* error: 30.8%
* macro_f1: 62.0%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,356
* accuracy: 55.0%
* error: 45.0%
* macro_f1: 25.1%
******* Domain 2 best val acc:      69.2%, epoch: 44 *******
******* Domain 2 best val test acc: 55.0%, epoch: 44 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [45/50] batch [20/319] time 0.079 (0.237) data 0.000 (0.150) loss 1.7610 (1.8823) ce_loss 0.8647 (0.9635) loss_zs_kd 1.8331 (1.8830) loss_oracle 0.6331 (0.5496) acc 71.8750 (63.2812) kd_loss 0.5797 (0.6440) lr 9.5173e-05 eta 0:07:28
epoch [45/50] batch [40/319] time 0.078 (0.161) data 0.000 (0.075) loss 2.0296 (1.9073) ce_loss 1.1299 (0.9978) loss_zs_kd 1.6939 (1.8841) loss_oracle 0.4861 (0.5580) acc 56.2500 (62.3438) kd_loss 0.6567 (0.6305) lr 9.5173e-05 eta 0:05:02
epoch [45/50] batch [60/319] time 0.084 (0.136) data 0.001 (0.050) loss 1.9408 (1.9169) ce_loss 1.0039 (1.0070) loss_zs_kd 2.2096 (1.8970) loss_oracle 0.6238 (0.5613) acc 68.7500 (62.2917) kd_loss 0.6250 (0.6293) lr 9.5173e-05 eta 0:04:11
epoch [45/50] batch [80/319] time 0.089 (0.124) data 0.000 (0.038) loss 1.8750 (1.9031) ce_loss 1.0654 (0.9994) loss_zs_kd 2.0466 (1.8870) loss_oracle 0.4880 (0.5607) acc 53.1250 (62.6953) kd_loss 0.5656 (0.6233) lr 9.5173e-05 eta 0:03:47
epoch [45/50] batch [100/319] time 0.094 (0.116) data 0.000 (0.030) loss 1.8081 (1.8886) ce_loss 0.9014 (0.9909) loss_zs_kd 1.8540 (1.8918) loss_oracle 0.5247 (0.5578) acc 62.5000 (62.5938) kd_loss 0.6444 (0.6188) lr 9.5173e-05 eta 0:03:31
epoch [45/50] batch [120/319] time 0.084 (0.110) data 0.000 (0.025) loss 1.9209 (1.8858) ce_loss 1.0215 (0.9914) loss_zs_kd 1.4999 (1.8847) loss_oracle 0.6448 (0.5588) acc 56.2500 (62.3177) kd_loss 0.5770 (0.6150) lr 9.5173e-05 eta 0:03:17
epoch [45/50] batch [140/319] time 0.080 (0.107) data 0.000 (0.022) loss 2.0287 (1.8738) ce_loss 0.9590 (0.9792) loss_zs_kd 1.7998 (1.8923) loss_oracle 0.5492 (0.5599) acc 65.6250 (63.1027) kd_loss 0.7951 (0.6146) lr 9.5173e-05 eta 0:03:09
epoch [45/50] batch [160/319] time 0.086 (0.104) data 0.000 (0.019) loss 1.7750 (1.8677) ce_loss 0.9551 (0.9728) loss_zs_kd 1.9017 (1.8858) loss_oracle 0.5256 (0.5592) acc 65.6250 (63.2812) kd_loss 0.5571 (0.6153) lr 9.5173e-05 eta 0:03:02
epoch [45/50] batch [180/319] time 0.077 (0.102) data 0.000 (0.017) loss 1.7800 (1.8670) ce_loss 0.8999 (0.9699) loss_zs_kd 2.1498 (1.8906) loss_oracle 0.5716 (0.5589) acc 62.5000 (63.6632) kd_loss 0.5943 (0.6175) lr 9.5173e-05 eta 0:02:56
epoch [45/50] batch [200/319] time 0.091 (0.100) data 0.000 (0.015) loss 1.9172 (1.8723) ce_loss 1.0322 (0.9747) loss_zs_kd 1.6213 (1.8842) loss_oracle 0.4998 (0.5594) acc 50.0000 (63.5312) kd_loss 0.6350 (0.6179) lr 9.5173e-05 eta 0:02:51
epoch [45/50] batch [220/319] time 0.086 (0.098) data 0.000 (0.014) loss 1.7254 (1.8739) ce_loss 0.7422 (0.9782) loss_zs_kd 1.9302 (1.8777) loss_oracle 0.5544 (0.5589) acc 68.7500 (63.3381) kd_loss 0.7060 (0.6162) lr 9.5173e-05 eta 0:02:46
epoch [45/50] batch [240/319] time 0.085 (0.097) data 0.000 (0.013) loss 2.2193 (1.8731) ce_loss 1.2314 (0.9760) loss_zs_kd 2.0741 (1.8801) loss_oracle 0.6115 (0.5584) acc 46.8750 (63.3203) kd_loss 0.6821 (0.6179) lr 9.5173e-05 eta 0:02:42
epoch [45/50] batch [260/319] time 0.080 (0.096) data 0.000 (0.012) loss 2.2060 (1.8843) ce_loss 1.1338 (0.9864) loss_zs_kd 2.0604 (1.8792) loss_oracle 0.6786 (0.5592) acc 62.5000 (62.9688) kd_loss 0.7329 (0.6183) lr 9.5173e-05 eta 0:02:38
epoch [45/50] batch [280/319] time 0.084 (0.095) data 0.000 (0.011) loss 1.6740 (1.8881) ce_loss 0.7788 (0.9891) loss_zs_kd 1.7906 (1.8795) loss_oracle 0.5330 (0.5586) acc 68.7500 (62.9129) kd_loss 0.6286 (0.6198) lr 9.5173e-05 eta 0:02:35
epoch [45/50] batch [300/319] time 0.083 (0.095) data 0.000 (0.010) loss 1.6303 (1.8858) ce_loss 0.8394 (0.9874) loss_zs_kd 1.6472 (1.8801) loss_oracle 0.5119 (0.5586) acc 71.8750 (63.0521) kd_loss 0.5350 (0.6191) lr 9.5173e-05 eta 0:02:32
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,012
* accuracy: 68.8%
* error: 31.2%
* macro_f1: 61.8%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,481
* accuracy: 56.3%
* error: 43.7%
* macro_f1: 25.6%
******* Domain 2 best val acc:      69.2%, epoch: 44 *******
******* Domain 2 best val test acc: 55.0%, epoch: 44 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [46/50] batch [20/319] time 0.088 (0.237) data 0.000 (0.152) loss 1.8935 (1.7994) ce_loss 1.0615 (0.9275) loss_zs_kd 1.9026 (1.9259) loss_oracle 0.4867 (0.5656) acc 50.0000 (65.3125) kd_loss 0.5886 (0.5891) lr 7.0224e-05 eta 0:06:13
epoch [46/50] batch [40/319] time 0.091 (0.162) data 0.000 (0.076) loss 1.9219 (1.8373) ce_loss 1.0791 (0.9583) loss_zs_kd 1.8970 (1.9150) loss_oracle 0.5785 (0.5562) acc 62.5000 (64.6094) kd_loss 0.5535 (0.6009) lr 7.0224e-05 eta 0:04:11
epoch [46/50] batch [60/319] time 0.075 (0.136) data 0.000 (0.051) loss 2.1148 (1.8542) ce_loss 1.0645 (0.9589) loss_zs_kd 1.9923 (1.9271) loss_oracle 0.6961 (0.5696) acc 59.3750 (64.6875) kd_loss 0.7023 (0.6105) lr 7.0224e-05 eta 0:03:29
epoch [46/50] batch [80/319] time 0.085 (0.122) data 0.000 (0.038) loss 1.7467 (1.8580) ce_loss 0.8945 (0.9620) loss_zs_kd 1.6750 (1.9274) loss_oracle 0.5143 (0.5682) acc 68.7500 (65.3516) kd_loss 0.5950 (0.6119) lr 7.0224e-05 eta 0:03:04
epoch [46/50] batch [100/319] time 0.078 (0.115) data 0.000 (0.031) loss 1.6376 (1.8557) ce_loss 0.7266 (0.9604) loss_zs_kd 1.8103 (1.9224) loss_oracle 0.5567 (0.5694) acc 78.1250 (65.0938) kd_loss 0.6327 (0.6106) lr 7.0224e-05 eta 0:02:51
epoch [46/50] batch [120/319] time 0.062 (0.110) data 0.000 (0.025) loss 1.7183 (1.8440) ce_loss 0.8789 (0.9561) loss_zs_kd 1.8960 (1.9138) loss_oracle 0.6363 (0.5661) acc 68.7500 (65.1562) kd_loss 0.5213 (0.6049) lr 7.0224e-05 eta 0:02:41
epoch [46/50] batch [140/319] time 0.094 (0.105) data 0.000 (0.022) loss 1.6748 (1.8536) ce_loss 0.8242 (0.9664) loss_zs_kd 1.6628 (1.9035) loss_oracle 0.5105 (0.5624) acc 75.0000 (64.7321) kd_loss 0.5953 (0.6060) lr 7.0224e-05 eta 0:02:32
epoch [46/50] batch [160/319] time 0.083 (0.102) data 0.000 (0.019) loss 1.7471 (1.8487) ce_loss 0.8428 (0.9623) loss_zs_kd 1.8152 (1.9123) loss_oracle 0.6550 (0.5632) acc 68.7500 (64.9805) kd_loss 0.5768 (0.6048) lr 7.0224e-05 eta 0:02:26
epoch [46/50] batch [180/319] time 0.071 (0.099) data 0.000 (0.017) loss 1.7805 (1.8507) ce_loss 0.8950 (0.9657) loss_zs_kd 1.6230 (1.9106) loss_oracle 0.5472 (0.5637) acc 62.5000 (64.7049) kd_loss 0.6119 (0.6032) lr 7.0224e-05 eta 0:02:20
epoch [46/50] batch [200/319] time 0.090 (0.098) data 0.000 (0.015) loss 1.9736 (1.8516) ce_loss 1.0518 (0.9645) loss_zs_kd 1.6532 (1.9087) loss_oracle 0.6653 (0.5642) acc 50.0000 (64.7031) kd_loss 0.5892 (0.6050) lr 7.0224e-05 eta 0:02:16
epoch [46/50] batch [220/319] time 0.092 (0.097) data 0.000 (0.014) loss 2.1964 (1.8627) ce_loss 1.2588 (0.9747) loss_zs_kd 1.9709 (1.9027) loss_oracle 0.6318 (0.5651) acc 46.8750 (64.2472) kd_loss 0.6217 (0.6055) lr 7.0224e-05 eta 0:02:13
epoch [46/50] batch [240/319] time 0.069 (0.096) data 0.000 (0.013) loss 1.8218 (1.8651) ce_loss 0.8374 (0.9759) loss_zs_kd 1.8465 (1.9057) loss_oracle 0.5323 (0.5660) acc 68.7500 (64.0495) kd_loss 0.7182 (0.6062) lr 7.0224e-05 eta 0:02:09
epoch [46/50] batch [260/319] time 0.092 (0.094) data 0.000 (0.012) loss 1.6534 (1.8663) ce_loss 0.8184 (0.9768) loss_zs_kd 1.8219 (1.9083) loss_oracle 0.5520 (0.5664) acc 75.0000 (63.9543) kd_loss 0.5590 (0.6063) lr 7.0224e-05 eta 0:02:05
epoch [46/50] batch [280/319] time 0.085 (0.093) data 0.000 (0.011) loss 2.1788 (1.8695) ce_loss 1.1680 (0.9805) loss_zs_kd 1.7306 (1.9068) loss_oracle 0.5593 (0.5661) acc 56.2500 (63.6830) kd_loss 0.7312 (0.6060) lr 7.0224e-05 eta 0:02:02
epoch [46/50] batch [300/319] time 0.078 (0.092) data 0.000 (0.010) loss 1.9823 (1.8680) ce_loss 1.0518 (0.9791) loss_zs_kd 1.9459 (1.9032) loss_oracle 0.6059 (0.5661) acc 53.1250 (63.6354) kd_loss 0.6275 (0.6059) lr 7.0224e-05 eta 0:01:59
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,035
* accuracy: 69.3%
* error: 30.7%
* macro_f1: 62.2%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,379
* accuracy: 55.2%
* error: 44.8%
* macro_f1: 25.4%
******* Domain 2 best val acc:      69.3%, epoch: 46 *******
******* Domain 2 best val test acc: 55.2%, epoch: 46 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [47/50] batch [20/319] time 0.061 (0.272) data 0.000 (0.203) loss 1.6444 (1.9211) ce_loss 0.7891 (1.0168) loss_zs_kd 1.7127 (1.8609) loss_oracle 0.5907 (0.5714) acc 75.0000 (61.5625) kd_loss 0.5600 (0.6186) lr 4.8943e-05 eta 0:05:42
epoch [47/50] batch [40/319] time 0.073 (0.175) data 0.000 (0.102) loss 2.0858 (1.9204) ce_loss 0.9814 (1.0149) loss_zs_kd 2.1953 (1.8759) loss_oracle 0.6499 (0.5672) acc 56.2500 (61.2500) kd_loss 0.7794 (0.6218) lr 4.8943e-05 eta 0:03:36
epoch [47/50] batch [60/319] time 0.080 (0.144) data 0.000 (0.068) loss 1.8991 (1.9238) ce_loss 0.9512 (1.0078) loss_zs_kd 2.0268 (1.9052) loss_oracle 0.5435 (0.5719) acc 71.8750 (61.8229) kd_loss 0.6762 (0.6300) lr 4.8943e-05 eta 0:02:54
epoch [47/50] batch [80/319] time 0.082 (0.127) data 0.000 (0.051) loss 1.8327 (1.9194) ce_loss 1.0146 (1.0056) loss_zs_kd 1.7084 (1.8863) loss_oracle 0.5386 (0.5709) acc 53.1250 (62.3438) kd_loss 0.5488 (0.6284) lr 4.8943e-05 eta 0:02:32
epoch [47/50] batch [100/319] time 0.075 (0.118) data 0.000 (0.041) loss 1.6647 (1.9140) ce_loss 0.7861 (0.9999) loss_zs_kd 1.8902 (1.8923) loss_oracle 0.5866 (0.5696) acc 62.5000 (62.7500) kd_loss 0.5853 (0.6293) lr 4.8943e-05 eta 0:02:18
epoch [47/50] batch [120/319] time 0.081 (0.112) data 0.000 (0.034) loss 1.7430 (1.9019) ce_loss 0.8960 (0.9872) loss_zs_kd 1.8201 (1.8992) loss_oracle 0.4981 (0.5677) acc 53.1250 (63.0990) kd_loss 0.5980 (0.6308) lr 4.8943e-05 eta 0:02:09
epoch [47/50] batch [140/319] time 0.082 (0.108) data 0.000 (0.029) loss 2.2730 (1.8941) ce_loss 1.2217 (0.9822) loss_zs_kd 2.0576 (1.9048) loss_oracle 0.6235 (0.5656) acc 46.8750 (63.1027) kd_loss 0.7396 (0.6291) lr 4.8943e-05 eta 0:02:02
epoch [47/50] batch [160/319] time 0.081 (0.105) data 0.000 (0.026) loss 1.7616 (1.8903) ce_loss 0.9380 (0.9802) loss_zs_kd 1.6015 (1.9058) loss_oracle 0.5718 (0.5646) acc 65.6250 (63.2422) kd_loss 0.5377 (0.6279) lr 4.8943e-05 eta 0:01:56
epoch [47/50] batch [180/319] time 0.084 (0.102) data 0.000 (0.023) loss 1.8433 (1.8916) ce_loss 0.8823 (0.9817) loss_zs_kd 2.0698 (1.9110) loss_oracle 0.5984 (0.5658) acc 56.2500 (63.3333) kd_loss 0.6618 (0.6271) lr 4.8943e-05 eta 0:01:52
epoch [47/50] batch [200/319] time 0.089 (0.101) data 0.000 (0.021) loss 2.1205 (1.8885) ce_loss 1.1689 (0.9772) loss_zs_kd 2.0106 (1.9046) loss_oracle 0.6830 (0.5659) acc 56.2500 (63.4062) kd_loss 0.6101 (0.6283) lr 4.8943e-05 eta 0:01:48
epoch [47/50] batch [220/319] time 0.079 (0.099) data 0.000 (0.019) loss 1.7930 (1.8874) ce_loss 0.8818 (0.9772) loss_zs_kd 1.7739 (1.9069) loss_oracle 0.5478 (0.5653) acc 62.5000 (63.3381) kd_loss 0.6372 (0.6276) lr 4.8943e-05 eta 0:01:44
epoch [47/50] batch [240/319] time 0.087 (0.098) data 0.000 (0.017) loss 1.6476 (1.8944) ce_loss 0.7324 (0.9830) loss_zs_kd 1.9631 (1.9037) loss_oracle 0.5657 (0.5656) acc 75.0000 (63.2812) kd_loss 0.6323 (0.6286) lr 4.8943e-05 eta 0:01:41
epoch [47/50] batch [260/319] time 0.081 (0.097) data 0.000 (0.016) loss 2.1162 (1.8968) ce_loss 1.1924 (0.9860) loss_zs_kd 1.7627 (1.9092) loss_oracle 0.5678 (0.5657) acc 50.0000 (63.2091) kd_loss 0.6399 (0.6280) lr 4.8943e-05 eta 0:01:38
epoch [47/50] batch [280/319] time 0.078 (0.096) data 0.000 (0.015) loss 1.8258 (1.8979) ce_loss 0.9517 (0.9858) loss_zs_kd 1.7358 (1.9108) loss_oracle 0.5633 (0.5663) acc 65.6250 (63.0692) kd_loss 0.5925 (0.6290) lr 4.8943e-05 eta 0:01:35
epoch [47/50] batch [300/319] time 0.088 (0.095) data 0.000 (0.014) loss 1.7352 (1.8955) ce_loss 0.7720 (0.9849) loss_zs_kd 1.9240 (1.9094) loss_oracle 0.5693 (0.5653) acc 68.7500 (63.0833) kd_loss 0.6786 (0.6279) lr 4.8943e-05 eta 0:01:32
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,036
* accuracy: 69.3%
* error: 30.7%
* macro_f1: 62.2%
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,414
* accuracy: 55.6%
* error: 44.4%
* macro_f1: 25.1%
******* Domain 2 best val acc:      69.3%, epoch: 47 *******
******* Domain 2 best val test acc: 55.6%, epoch: 47 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [48/50] batch [20/319] time 0.082 (0.233) data 0.000 (0.155) loss 1.8099 (1.9931) ce_loss 0.9629 (1.0695) loss_zs_kd 1.7681 (1.8398) loss_oracle 0.6061 (0.5685) acc 56.2500 (59.8438) kd_loss 0.5439 (0.6393) lr 3.1417e-05 eta 0:03:38
epoch [48/50] batch [40/319] time 0.084 (0.159) data 0.000 (0.078) loss 1.8823 (1.9621) ce_loss 0.9536 (1.0535) loss_zs_kd 1.9937 (1.8733) loss_oracle 0.5722 (0.5589) acc 59.3750 (61.0156) kd_loss 0.6426 (0.6292) lr 3.1417e-05 eta 0:02:25
epoch [48/50] batch [60/319] time 0.085 (0.134) data 0.000 (0.052) loss 1.8686 (1.9401) ce_loss 0.9575 (1.0329) loss_zs_kd 1.7875 (1.8811) loss_oracle 0.6146 (0.5556) acc 68.7500 (62.3958) kd_loss 0.6038 (0.6293) lr 3.1417e-05 eta 0:01:59
epoch [48/50] batch [80/319] time 0.087 (0.120) data 0.000 (0.039) loss 1.8976 (1.9191) ce_loss 0.9390 (1.0065) loss_zs_kd 1.9258 (1.9019) loss_oracle 0.5811 (0.5595) acc 71.8750 (63.6328) kd_loss 0.6681 (0.6328) lr 3.1417e-05 eta 0:01:45
epoch [48/50] batch [100/319] time 0.083 (0.113) data 0.000 (0.031) loss 1.6928 (1.9041) ce_loss 0.8843 (0.9914) loss_zs_kd 1.8488 (1.9031) loss_oracle 0.4775 (0.5594) acc 62.5000 (63.8750) kd_loss 0.5698 (0.6330) lr 3.1417e-05 eta 0:01:36
epoch [48/50] batch [120/319] time 0.082 (0.108) data 0.000 (0.026) loss 1.7640 (1.8949) ce_loss 0.9766 (0.9827) loss_zs_kd 1.6847 (1.9013) loss_oracle 0.5514 (0.5603) acc 62.5000 (64.0885) kd_loss 0.5117 (0.6320) lr 3.1417e-05 eta 0:01:30
epoch [48/50] batch [140/319] time 0.078 (0.104) data 0.000 (0.022) loss 2.0286 (1.8942) ce_loss 1.1738 (0.9820) loss_zs_kd 1.8914 (1.9015) loss_oracle 0.5650 (0.5618) acc 62.5000 (64.3527) kd_loss 0.5723 (0.6312) lr 3.1417e-05 eta 0:01:25
epoch [48/50] batch [160/319] time 0.085 (0.102) data 0.000 (0.020) loss 1.7398 (1.8878) ce_loss 0.8359 (0.9763) loss_zs_kd 1.9455 (1.9013) loss_oracle 0.5246 (0.5648) acc 62.5000 (64.5703) kd_loss 0.6416 (0.6292) lr 3.1417e-05 eta 0:01:21
epoch [48/50] batch [180/319] time 0.076 (0.100) data 0.000 (0.018) loss 1.7584 (1.8894) ce_loss 0.8872 (0.9810) loss_zs_kd 1.9107 (1.8922) loss_oracle 0.4963 (0.5636) acc 68.7500 (64.2708) kd_loss 0.6231 (0.6266) lr 3.1417e-05 eta 0:01:17
epoch [48/50] batch [200/319] time 0.080 (0.098) data 0.000 (0.016) loss 2.3905 (1.8921) ce_loss 1.4268 (0.9854) loss_zs_kd 1.8202 (1.8987) loss_oracle 0.6094 (0.5635) acc 43.7500 (64.1250) kd_loss 0.6591 (0.6249) lr 3.1417e-05 eta 0:01:14
epoch [48/50] batch [220/319] time 0.088 (0.097) data 0.000 (0.014) loss 1.6894 (1.8930) ce_loss 0.8306 (0.9877) loss_zs_kd 1.7727 (1.8979) loss_oracle 0.5929 (0.5624) acc 75.0000 (63.8920) kd_loss 0.5624 (0.6242) lr 3.1417e-05 eta 0:01:11
epoch [48/50] batch [240/319] time 0.075 (0.096) data 0.000 (0.013) loss 2.0265 (1.8943) ce_loss 1.1230 (0.9890) loss_zs_kd 1.8317 (1.8983) loss_oracle 0.5837 (0.5628) acc 65.6250 (63.8411) kd_loss 0.6116 (0.6239) lr 3.1417e-05 eta 0:01:08
epoch [48/50] batch [260/319] time 0.079 (0.095) data 0.000 (0.012) loss 2.0575 (1.8915) ce_loss 1.0859 (0.9863) loss_zs_kd 2.0626 (1.9013) loss_oracle 0.6232 (0.5648) acc 56.2500 (63.8582) kd_loss 0.6600 (0.6228) lr 3.1417e-05 eta 0:01:06
epoch [48/50] batch [280/319] time 0.081 (0.094) data 0.000 (0.011) loss 2.2831 (1.8884) ce_loss 1.4268 (0.9843) loss_zs_kd 1.7077 (1.8969) loss_oracle 0.5973 (0.5644) acc 50.0000 (63.9621) kd_loss 0.5577 (0.6219) lr 3.1417e-05 eta 0:01:03
epoch [48/50] batch [300/319] time 0.084 (0.093) data 0.000 (0.011) loss 1.8054 (1.8882) ce_loss 0.9214 (0.9834) loss_zs_kd 1.8682 (1.8947) loss_oracle 0.5735 (0.5652) acc 62.5000 (64.0521) kd_loss 0.5973 (0.6222) lr 3.1417e-05 eta 0:01:01
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,030
* accuracy: 69.2%
* error: 30.8%
* macro_f1: 62.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,426
* accuracy: 55.7%
* error: 44.3%
* macro_f1: 25.2%
******* Domain 2 best val acc:      69.3%, epoch: 47 *******
******* Domain 2 best val test acc: 55.6%, epoch: 47 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [49/50] batch [20/319] time 0.077 (0.304) data 0.000 (0.219) loss 1.8787 (1.8613) ce_loss 0.9282 (0.9606) loss_zs_kd 1.8801 (1.9177) loss_oracle 0.5910 (0.5587) acc 68.7500 (62.6562) kd_loss 0.6550 (0.6214) lr 1.7713e-05 eta 0:03:07
epoch [49/50] batch [40/319] time 0.084 (0.192) data 0.000 (0.110) loss 1.8276 (1.8876) ce_loss 1.0195 (0.9776) loss_zs_kd 1.8201 (1.9080) loss_oracle 0.5509 (0.5555) acc 56.2500 (62.4219) kd_loss 0.5327 (0.6322) lr 1.7713e-05 eta 0:01:55
epoch [49/50] batch [60/319] time 0.084 (0.156) data 0.000 (0.073) loss 1.5285 (1.8871) ce_loss 0.6665 (0.9810) loss_zs_kd 1.8553 (1.8999) loss_oracle 0.5480 (0.5556) acc 75.0000 (63.3333) kd_loss 0.5880 (0.6283) lr 1.7713e-05 eta 0:01:30
epoch [49/50] batch [80/319] time 0.080 (0.138) data 0.000 (0.055) loss 1.9492 (1.8953) ce_loss 1.1172 (0.9855) loss_zs_kd 2.0159 (1.8936) loss_oracle 0.5196 (0.5614) acc 59.3750 (63.7500) kd_loss 0.5722 (0.6291) lr 1.7713e-05 eta 0:01:17
epoch [49/50] batch [100/319] time 0.089 (0.128) data 0.000 (0.044) loss 1.7835 (1.8791) ce_loss 0.8975 (0.9740) loss_zs_kd 2.1643 (1.8920) loss_oracle 0.5367 (0.5592) acc 65.6250 (64.0000) kd_loss 0.6177 (0.6255) lr 1.7713e-05 eta 0:01:08
epoch [49/50] batch [120/319] time 0.087 (0.121) data 0.000 (0.037) loss 1.7429 (1.8892) ce_loss 0.9106 (0.9853) loss_zs_kd 2.1534 (1.8907) loss_oracle 0.5985 (0.5608) acc 50.0000 (63.2552) kd_loss 0.5330 (0.6235) lr 1.7713e-05 eta 0:01:02
epoch [49/50] batch [140/319] time 0.080 (0.116) data 0.000 (0.032) loss 1.6880 (1.8900) ce_loss 0.8447 (0.9850) loss_zs_kd 1.7966 (1.8902) loss_oracle 0.5886 (0.5624) acc 71.8750 (63.2589) kd_loss 0.5489 (0.6238) lr 1.7713e-05 eta 0:00:57
epoch [49/50] batch [160/319] time 0.071 (0.111) data 0.000 (0.028) loss 1.5924 (1.8853) ce_loss 0.7749 (0.9831) loss_zs_kd 1.7375 (1.8938) loss_oracle 0.4945 (0.5617) acc 78.1250 (63.2617) kd_loss 0.5703 (0.6213) lr 1.7713e-05 eta 0:00:53
epoch [49/50] batch [180/319] time 0.090 (0.108) data 0.000 (0.025) loss 1.9676 (1.8931) ce_loss 1.0029 (0.9907) loss_zs_kd 1.8851 (1.8973) loss_oracle 0.5696 (0.5634) acc 62.5000 (63.0035) kd_loss 0.6799 (0.6207) lr 1.7713e-05 eta 0:00:49
epoch [49/50] batch [200/319] time 0.067 (0.106) data 0.000 (0.022) loss 1.9654 (1.8929) ce_loss 0.9287 (0.9902) loss_zs_kd 2.2928 (1.9039) loss_oracle 0.6501 (0.5624) acc 56.2500 (63.0156) kd_loss 0.7117 (0.6215) lr 1.7713e-05 eta 0:00:46
epoch [49/50] batch [220/319] time 0.077 (0.103) data 0.000 (0.020) loss 2.1229 (1.8943) ce_loss 1.1426 (0.9907) loss_zs_kd 2.0386 (1.9036) loss_oracle 0.6130 (0.5631) acc 59.3750 (62.9119) kd_loss 0.6738 (0.6220) lr 1.7713e-05 eta 0:00:43
epoch [49/50] batch [240/319] time 0.079 (0.101) data 0.000 (0.019) loss 1.8582 (1.8963) ce_loss 0.8979 (0.9931) loss_zs_kd 2.2434 (1.9083) loss_oracle 0.6245 (0.5641) acc 59.3750 (62.9557) kd_loss 0.6480 (0.6212) lr 1.7713e-05 eta 0:00:40
epoch [49/50] batch [260/319] time 0.087 (0.100) data 0.000 (0.017) loss 1.8890 (1.8940) ce_loss 1.0381 (0.9916) loss_zs_kd 1.7785 (1.9062) loss_oracle 0.5567 (0.5639) acc 59.3750 (62.8726) kd_loss 0.5726 (0.6205) lr 1.7713e-05 eta 0:00:37
epoch [49/50] batch [280/319] time 0.076 (0.099) data 0.000 (0.016) loss 1.7023 (1.8949) ce_loss 0.7368 (0.9913) loss_zs_kd 1.8732 (1.9049) loss_oracle 0.5658 (0.5637) acc 71.8750 (62.8906) kd_loss 0.6826 (0.6217) lr 1.7713e-05 eta 0:00:35
epoch [49/50] batch [300/319] time 0.086 (0.098) data 0.000 (0.015) loss 1.7408 (1.8870) ce_loss 0.8628 (0.9842) loss_zs_kd 2.0795 (1.9076) loss_oracle 0.5709 (0.5629) acc 68.7500 (63.3125) kd_loss 0.5926 (0.6214) lr 1.7713e-05 eta 0:00:33
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,029
* accuracy: 69.2%
* error: 30.8%
* macro_f1: 62.1%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,423
* accuracy: 55.7%
* error: 44.3%
* macro_f1: 25.2%
******* Domain 2 best val acc:      69.3%, epoch: 47 *******
******* Domain 2 best val test acc: 55.6%, epoch: 47 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
epoch [50/50] batch [20/319] time 0.083 (0.283) data 0.000 (0.193) loss 1.7873 (1.9545) ce_loss 0.8765 (1.0461) loss_zs_kd 1.9115 (1.9071) loss_oracle 0.5268 (0.5720) acc 59.3750 (61.8750) kd_loss 0.6474 (0.6224) lr 7.8853e-06 eta 0:01:24
epoch [50/50] batch [40/319] time 0.083 (0.184) data 0.000 (0.096) loss 1.7754 (1.9208) ce_loss 0.8901 (1.0201) loss_zs_kd 2.5337 (1.9054) loss_oracle 0.5844 (0.5765) acc 65.6250 (62.2656) kd_loss 0.5931 (0.6124) lr 7.8853e-06 eta 0:00:51
epoch [50/50] batch [60/319] time 0.089 (0.151) data 0.000 (0.064) loss 1.9527 (1.9012) ce_loss 0.9395 (1.0030) loss_zs_kd 1.9085 (1.9069) loss_oracle 0.5872 (0.5736) acc 56.2500 (62.9167) kd_loss 0.7196 (0.6114) lr 7.8853e-06 eta 0:00:39
epoch [50/50] batch [80/319] time 0.072 (0.133) data 0.000 (0.048) loss 1.8743 (1.8891) ce_loss 0.9648 (0.9905) loss_zs_kd 1.7133 (1.9058) loss_oracle 0.6013 (0.5736) acc 59.3750 (63.2031) kd_loss 0.6088 (0.6118) lr 7.8853e-06 eta 0:00:31
epoch [50/50] batch [100/319] time 0.082 (0.123) data 0.000 (0.039) loss 2.0339 (1.8985) ce_loss 1.1963 (1.0029) loss_zs_kd 1.8623 (1.9058) loss_oracle 0.5066 (0.5720) acc 56.2500 (62.8125) kd_loss 0.5843 (0.6096) lr 7.8853e-06 eta 0:00:26
epoch [50/50] batch [120/319] time 0.075 (0.116) data 0.000 (0.032) loss 2.0055 (1.8974) ce_loss 1.0859 (0.9997) loss_zs_kd 1.7783 (1.8992) loss_oracle 0.5718 (0.5690) acc 62.5000 (63.2031) kd_loss 0.6337 (0.6132) lr 7.8853e-06 eta 0:00:23
epoch [50/50] batch [140/319] time 0.081 (0.112) data 0.000 (0.028) loss 1.6269 (1.8925) ce_loss 0.7222 (0.9956) loss_zs_kd 1.9790 (1.9021) loss_oracle 0.5465 (0.5676) acc 75.0000 (63.2366) kd_loss 0.6315 (0.6131) lr 7.8853e-06 eta 0:00:20
epoch [50/50] batch [160/319] time 0.084 (0.108) data 0.000 (0.024) loss 1.8497 (1.8968) ce_loss 0.9507 (1.0004) loss_zs_kd 1.7792 (1.9081) loss_oracle 0.5590 (0.5650) acc 62.5000 (62.8125) kd_loss 0.6195 (0.6139) lr 7.8853e-06 eta 0:00:17
epoch [50/50] batch [180/319] time 0.083 (0.105) data 0.000 (0.022) loss 1.7302 (1.8958) ce_loss 0.8198 (1.0001) loss_zs_kd 2.0228 (1.9071) loss_oracle 0.4652 (0.5654) acc 71.8750 (62.9167) kd_loss 0.6778 (0.6130) lr 7.8853e-06 eta 0:00:14
epoch [50/50] batch [200/319] time 0.072 (0.103) data 0.000 (0.020) loss 1.9293 (1.9000) ce_loss 1.0273 (1.0032) loss_zs_kd 2.1278 (1.9087) loss_oracle 0.6426 (0.5668) acc 68.7500 (63.2344) kd_loss 0.5807 (0.6133) lr 7.8853e-06 eta 0:00:12
epoch [50/50] batch [220/319] time 0.085 (0.101) data 0.000 (0.018) loss 1.8428 (1.8962) ce_loss 0.8340 (0.9977) loss_zs_kd 1.8385 (1.9108) loss_oracle 0.6232 (0.5674) acc 65.6250 (63.4801) kd_loss 0.6972 (0.6148) lr 7.8853e-06 eta 0:00:10
epoch [50/50] batch [240/319] time 0.090 (0.100) data 0.000 (0.016) loss 2.2660 (1.8912) ce_loss 1.2607 (0.9919) loss_zs_kd 1.8502 (1.9075) loss_oracle 0.6456 (0.5672) acc 56.2500 (63.6979) kd_loss 0.6824 (0.6156) lr 7.8853e-06 eta 0:00:07
epoch [50/50] batch [260/319] time 0.081 (0.098) data 0.000 (0.015) loss 1.6464 (1.8928) ce_loss 0.7998 (0.9937) loss_zs_kd 1.9629 (1.9068) loss_oracle 0.6090 (0.5680) acc 68.7500 (63.6058) kd_loss 0.5421 (0.6152) lr 7.8853e-06 eta 0:00:05
epoch [50/50] batch [280/319] time 0.080 (0.097) data 0.000 (0.014) loss 2.2078 (1.8916) ce_loss 1.4346 (0.9911) loss_zs_kd 1.6953 (1.9000) loss_oracle 0.4715 (0.5679) acc 59.3750 (63.7165) kd_loss 0.5375 (0.6166) lr 7.8853e-06 eta 0:00:03
epoch [50/50] batch [300/319] time 0.078 (0.096) data 0.000 (0.013) loss 1.9967 (1.8896) ce_loss 1.0869 (0.9878) loss_zs_kd 2.2009 (1.9019) loss_oracle 0.5873 (0.5668) acc 53.1250 (63.7396) kd_loss 0.6161 (0.6184) lr 7.8853e-06 eta 0:00:01
Evaluate on the *val* set
=> result
* total: 4,378
* correct: 3,028
* accuracy: 69.2%
* error: 30.8%
* macro_f1: 62.2%
Evaluate on the *test* set
=> result
* total: 9,736
* correct: 5,421
* accuracy: 55.7%
* error: 44.3%
* macro_f1: 25.2%
******* Domain 2 best val acc:      69.3%, epoch: 47 *******
******* Domain 2 best val test acc: 55.6%, epoch: 47 *******
******* Domain 2 best test acc:     60.0%, epoch: 27 *******
Checkpoint saved to icml/multi-dg/tuning/04_zs0_oracle0.5tau/TRIP/terra_incognita/b32_ep50/ViT-B16/2/seed_1/warmup_1/prompt_learner/model.pth.tar-50
Finish the whole training
Elapsed: 0:47:32
