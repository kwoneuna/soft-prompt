Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_100', 'location_38', 'location_46']
Target     ['location_43']
# classes  10
# train_x  14,252
# val      6,108
# test     3,970
---------  ----------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/445] time 0.101 (0.160) data 0.000 (0.038) loss 2.4145 (2.3219) ce_loss 2.4141 (2.3195) loss_zs_kd 0.0002 (0.0001) loss_oracle -0.0001 (-0.0001) acc 25.0000 (30.3125) kd_loss 0.0005 (0.0025) lr 1.0000e-05 eta 0:59:08
epoch [1/50] batch [40/445] time 0.109 (0.132) data 0.000 (0.019) loss 2.6860 (2.2805) ce_loss 2.6855 (2.2790) loss_zs_kd 0.0021 (0.0006) loss_oracle -0.0001 (-0.0001) acc 21.8750 (31.4844) kd_loss 0.0005 (0.0016) lr 1.0000e-05 eta 0:48:57
epoch [1/50] batch [60/445] time 0.115 (0.123) data 0.001 (0.013) loss 2.0707 (2.2825) ce_loss 2.0703 (2.2812) loss_zs_kd 0.0059 (0.0020) loss_oracle -0.0001 (-0.0001) acc 37.5000 (31.1458) kd_loss 0.0004 (0.0013) lr 1.0000e-05 eta 0:45:40
epoch [1/50] batch [80/445] time 0.097 (0.118) data 0.000 (0.010) loss 2.2212 (2.2522) ce_loss 2.2207 (2.2511) loss_zs_kd 0.0149 (0.0040) loss_oracle -0.0001 (-0.0001) acc 21.8750 (31.6406) kd_loss 0.0005 (0.0011) lr 1.0000e-05 eta 0:43:30
epoch [1/50] batch [100/445] time 0.090 (0.114) data 0.000 (0.008) loss 2.0302 (2.2210) ce_loss 2.0293 (2.2200) loss_zs_kd 0.0232 (0.0072) loss_oracle -0.0001 (-0.0001) acc 34.3750 (32.0000) kd_loss 0.0009 (0.0011) lr 1.0000e-05 eta 0:41:58
epoch [1/50] batch [120/445] time 0.108 (0.111) data 0.000 (0.007) loss 2.2021 (2.2048) ce_loss 2.2012 (2.2038) loss_zs_kd 0.0545 (0.0127) loss_oracle 0.0003 (-0.0001) acc 34.3750 (32.5521) kd_loss 0.0008 (0.0010) lr 1.0000e-05 eta 0:40:58
epoch [1/50] batch [140/445] time 0.094 (0.108) data 0.000 (0.006) loss 1.9167 (2.1709) ce_loss 1.8936 (2.1694) loss_zs_kd 0.2571 (0.0317) loss_oracle 0.0367 (0.0008) acc 43.7500 (33.1473) kd_loss 0.0048 (0.0011) lr 1.0000e-05 eta 0:39:41
epoch [1/50] batch [160/445] time 0.090 (0.107) data 0.000 (0.005) loss 1.6146 (2.1279) ce_loss 1.5938 (2.1237) loss_zs_kd 0.2194 (0.0649) loss_oracle 0.0016 (0.0027) acc 50.0000 (34.2383) kd_loss 0.0200 (0.0029) lr 1.0000e-05 eta 0:39:21
epoch [1/50] batch [180/445] time 0.074 (0.104) data 0.000 (0.004) loss 1.9137 (2.0891) ce_loss 1.8438 (2.0812) loss_zs_kd 0.4035 (0.0928) loss_oracle 0.0173 (0.0033) acc 43.7500 (34.9479) kd_loss 0.0614 (0.0063) lr 1.0000e-05 eta 0:38:24
epoch [1/50] batch [200/445] time 0.066 (0.102) data 0.000 (0.004) loss 1.9317 (2.0615) ce_loss 1.8184 (2.0464) loss_zs_kd 0.4934 (0.1210) loss_oracle 0.0084 (0.0036) acc 40.6250 (35.4688) kd_loss 0.1091 (0.0133) lr 1.0000e-05 eta 0:37:26
epoch [1/50] batch [220/445] time 0.152 (0.102) data 0.000 (0.004) loss 1.7702 (2.0430) ce_loss 1.6270 (2.0183) loss_zs_kd 0.3768 (0.1495) loss_oracle 0.0044 (0.0037) acc 40.6250 (36.0085) kd_loss 0.1410 (0.0229) lr 1.0000e-05 eta 0:37:28
epoch [1/50] batch [240/445] time 0.182 (0.103) data 0.000 (0.003) loss 2.0418 (2.0291) ce_loss 1.8359 (1.9945) loss_zs_kd 0.5085 (0.1794) loss_oracle 0.0163 (0.0042) acc 28.1250 (36.3672) kd_loss 0.1977 (0.0326) lr 1.0000e-05 eta 0:37:45
epoch [1/50] batch [260/445] time 0.081 (0.103) data 0.000 (0.003) loss 2.1517 (2.0198) ce_loss 1.9043 (1.9720) loss_zs_kd 0.4642 (0.1991) loss_oracle 0.0203 (0.0048) acc 34.3750 (36.8870) kd_loss 0.2372 (0.0454) lr 1.0000e-05 eta 0:37:51
epoch [1/50] batch [280/445] time 0.083 (0.103) data 0.000 (0.003) loss 2.0776 (2.0279) ce_loss 1.6133 (1.9599) loss_zs_kd 0.3725 (0.2213) loss_oracle 0.0326 (0.0072) acc 37.5000 (37.1540) kd_loss 0.4481 (0.0644) lr 1.0000e-05 eta 0:37:38
epoch [1/50] batch [300/445] time 0.084 (0.101) data 0.000 (0.003) loss 2.0187 (2.0298) ce_loss 1.6484 (1.9357) loss_zs_kd 0.3791 (0.2383) loss_oracle 0.0091 (0.0078) acc 43.7500 (37.6875) kd_loss 0.3657 (0.0902) lr 1.0000e-05 eta 0:37:05
epoch [1/50] batch [320/445] time 0.081 (0.102) data 0.000 (0.003) loss 2.0654 (2.0361) ce_loss 1.4766 (1.9181) loss_zs_kd 0.7048 (0.2599) loss_oracle 0.0859 (0.0100) acc 40.6250 (38.1348) kd_loss 0.5459 (0.1131) lr 1.0000e-05 eta 0:37:19
epoch [1/50] batch [340/445] time 0.078 (0.104) data 0.000 (0.002) loss 2.4626 (2.0516) ce_loss 1.7236 (1.9036) loss_zs_kd 0.5429 (0.2759) loss_oracle 0.0569 (0.0132) acc 31.2500 (38.4099) kd_loss 0.7105 (0.1414) lr 1.0000e-05 eta 0:37:50
epoch [1/50] batch [360/445] time 0.073 (0.104) data 0.000 (0.002) loss 2.2017 (2.0638) ce_loss 1.4834 (1.8860) loss_zs_kd 0.4670 (0.2897) loss_oracle 0.0462 (0.0157) acc 43.7500 (38.7066) kd_loss 0.6951 (0.1700) lr 1.0000e-05 eta 0:38:02
epoch [1/50] batch [380/445] time 0.087 (0.105) data 0.000 (0.002) loss 2.3279 (2.0754) ce_loss 1.5283 (1.8684) loss_zs_kd 0.4379 (0.3018) loss_oracle 0.0609 (0.0179) acc 50.0000 (39.1118) kd_loss 0.7691 (0.1980) lr 1.0000e-05 eta 0:38:12
epoch [1/50] batch [400/445] time 0.077 (0.105) data 0.000 (0.002) loss 2.4209 (2.0956) ce_loss 1.8008 (1.8627) loss_zs_kd 0.5212 (0.3123) loss_oracle 0.0659 (0.0205) acc 37.5000 (39.1406) kd_loss 0.5872 (0.2227) lr 1.0000e-05 eta 0:38:18
epoch [1/50] batch [420/445] time 0.073 (0.106) data 0.000 (0.002) loss 2.4393 (2.1107) ce_loss 1.5586 (1.8506) loss_zs_kd 0.4649 (0.3221) loss_oracle 0.2013 (0.0266) acc 40.6250 (39.3229) kd_loss 0.7801 (0.2468) lr 1.0000e-05 eta 0:38:23
epoch [1/50] batch [440/445] time 0.071 (0.104) data 0.000 (0.002) loss 2.7730 (2.1269) ce_loss 1.9912 (1.8397) loss_zs_kd 0.7072 (0.3324) loss_oracle 0.1905 (0.0346) acc 25.0000 (39.5099) kd_loss 0.6865 (0.2699) lr 1.0000e-05 eta 0:37:55
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 2,943
* accuracy: 48.2%
* error: 51.8%
* macro_f1: 35.2%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,399
* accuracy: 35.2%
* error: 64.8%
* macro_f1: 27.8%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      48.2%, epoch: 1 *******
******* Domain 3 best val test acc: 35.2%, epoch: 1 *******
******* Domain 3 best test acc:     35.2%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/ana
epoch [2/50] batch [20/445] time 0.088 (0.131) data 0.000 (0.036) loss 2.5774 (2.6264) ce_loss 1.5859 (1.6667) loss_zs_kd 0.4824 (0.5577) loss_oracle 0.3579 (0.3950) acc 50.0000 (43.9062) kd_loss 0.8125 (0.7621) lr 2.0000e-03 eta 0:47:31
epoch [2/50] batch [40/445] time 0.099 (0.119) data 0.000 (0.018) loss 2.3711 (2.5210) ce_loss 1.3867 (1.5418) loss_zs_kd 0.7034 (0.6722) loss_oracle 0.4451 (0.4029) acc 46.8750 (47.1875) kd_loss 0.7618 (0.7777) lr 2.0000e-03 eta 0:43:16
epoch [2/50] batch [60/445] time 0.104 (0.114) data 0.000 (0.012) loss 2.4098 (2.4865) ce_loss 1.3721 (1.5029) loss_zs_kd 0.8777 (0.7459) loss_oracle 0.5535 (0.4520) acc 46.8750 (47.9167) kd_loss 0.7610 (0.7576) lr 2.0000e-03 eta 0:41:20
epoch [2/50] batch [80/445] time 0.108 (0.112) data 0.000 (0.009) loss 2.4620 (2.4748) ce_loss 1.5547 (1.4876) loss_zs_kd 0.9198 (0.7437) loss_oracle 0.4157 (0.4646) acc 43.7500 (48.2812) kd_loss 0.6995 (0.7549) lr 2.0000e-03 eta 0:40:22
epoch [2/50] batch [100/445] time 0.110 (0.108) data 0.000 (0.007) loss 2.4149 (2.4494) ce_loss 1.3359 (1.4618) loss_zs_kd 0.9856 (0.7733) loss_oracle 0.5625 (0.4730) acc 50.0000 (49.1875) kd_loss 0.7977 (0.7511) lr 2.0000e-03 eta 0:39:06
epoch [2/50] batch [120/445] time 0.110 (0.108) data 0.000 (0.006) loss 2.4369 (2.4255) ce_loss 1.3564 (1.4263) loss_zs_kd 0.7005 (0.8042) loss_oracle 0.5480 (0.4829) acc 46.8750 (50.1042) kd_loss 0.8065 (0.7577) lr 2.0000e-03 eta 0:38:55
epoch [2/50] batch [140/445] time 0.101 (0.106) data 0.000 (0.005) loss 2.3175 (2.4183) ce_loss 1.1992 (1.4066) loss_zs_kd 0.8896 (0.8278) loss_oracle 0.5969 (0.4935) acc 59.3750 (50.8482) kd_loss 0.8199 (0.7649) lr 2.0000e-03 eta 0:38:23
epoch [2/50] batch [160/445] time 0.086 (0.104) data 0.000 (0.005) loss 2.4208 (2.4154) ce_loss 1.2148 (1.3867) loss_zs_kd 0.9571 (0.8550) loss_oracle 0.6023 (0.5048) acc 56.2500 (51.5820) kd_loss 0.9048 (0.7763) lr 2.0000e-03 eta 0:37:22
epoch [2/50] batch [180/445] time 0.093 (0.101) data 0.000 (0.004) loss 2.2623 (2.4121) ce_loss 1.1416 (1.3704) loss_zs_kd 1.0710 (0.8844) loss_oracle 0.5228 (0.5142) acc 65.6250 (52.0833) kd_loss 0.8593 (0.7846) lr 2.0000e-03 eta 0:36:27
epoch [2/50] batch [200/445] time 0.081 (0.103) data 0.000 (0.004) loss 2.2483 (2.4026) ce_loss 1.1279 (1.3488) loss_zs_kd 0.8849 (0.8971) loss_oracle 0.5335 (0.5233) acc 53.1250 (52.8906) kd_loss 0.8536 (0.7922) lr 2.0000e-03 eta 0:36:59
epoch [2/50] batch [220/445] time 0.181 (0.104) data 0.000 (0.004) loss 2.1714 (2.3891) ce_loss 1.0586 (1.3305) loss_zs_kd 1.3219 (0.9143) loss_oracle 0.5013 (0.5246) acc 65.6250 (53.6648) kd_loss 0.8622 (0.7963) lr 2.0000e-03 eta 0:37:14
epoch [2/50] batch [240/445] time 0.084 (0.103) data 0.000 (0.003) loss 2.4822 (2.3798) ce_loss 1.3711 (1.3182) loss_zs_kd 1.2115 (0.9356) loss_oracle 0.6235 (0.5258) acc 56.2500 (53.9714) kd_loss 0.7993 (0.7987) lr 2.0000e-03 eta 0:37:02
epoch [2/50] batch [260/445] time 0.076 (0.102) data 0.000 (0.003) loss 2.2196 (2.3772) ce_loss 1.0615 (1.3117) loss_zs_kd 1.0195 (0.9447) loss_oracle 0.4377 (0.5251) acc 62.5000 (54.2188) kd_loss 0.9392 (0.8029) lr 2.0000e-03 eta 0:36:47
epoch [2/50] batch [280/445] time 0.167 (0.102) data 0.000 (0.003) loss 2.1130 (2.3639) ce_loss 1.0547 (1.2958) loss_zs_kd 0.8818 (0.9603) loss_oracle 0.4732 (0.5242) acc 65.6250 (54.6652) kd_loss 0.8217 (0.8060) lr 2.0000e-03 eta 0:36:35
epoch [2/50] batch [300/445] time 0.081 (0.102) data 0.000 (0.003) loss 2.4783 (2.3609) ce_loss 1.3262 (1.2868) loss_zs_kd 1.2874 (0.9766) loss_oracle 0.6522 (0.5288) acc 56.2500 (55.0104) kd_loss 0.8260 (0.8098) lr 2.0000e-03 eta 0:36:35
epoch [2/50] batch [320/445] time 0.172 (0.104) data 0.000 (0.003) loss 2.2294 (2.3623) ce_loss 1.1094 (1.2824) loss_zs_kd 1.3716 (0.9899) loss_oracle 0.5813 (0.5336) acc 62.5000 (55.1855) kd_loss 0.8294 (0.8132) lr 2.0000e-03 eta 0:37:03
epoch [2/50] batch [340/445] time 0.158 (0.105) data 0.000 (0.002) loss 2.4146 (2.3582) ce_loss 1.2402 (1.2731) loss_zs_kd 1.3628 (1.0011) loss_oracle 0.5232 (0.5359) acc 50.0000 (55.4596) kd_loss 0.9128 (0.8172) lr 2.0000e-03 eta 0:37:27
epoch [2/50] batch [360/445] time 0.089 (0.105) data 0.000 (0.002) loss 2.1251 (2.3544) ce_loss 0.9834 (1.2639) loss_zs_kd 1.3140 (1.0120) loss_oracle 0.6200 (0.5395) acc 68.7500 (55.7986) kd_loss 0.8317 (0.8207) lr 2.0000e-03 eta 0:37:26
epoch [2/50] batch [380/445] time 0.079 (0.105) data 0.000 (0.002) loss 2.2623 (2.3435) ce_loss 1.1191 (1.2502) loss_zs_kd 1.3239 (1.0199) loss_oracle 0.5196 (0.5406) acc 59.3750 (56.2829) kd_loss 0.8834 (0.8231) lr 2.0000e-03 eta 0:37:34
epoch [2/50] batch [400/445] time 0.071 (0.105) data 0.000 (0.002) loss 1.7991 (2.3352) ce_loss 0.7896 (1.2418) loss_zs_kd 1.0345 (1.0319) loss_oracle 0.5996 (0.5410) acc 75.0000 (56.5703) kd_loss 0.7098 (0.8230) lr 2.0000e-03 eta 0:37:35
epoch [2/50] batch [420/445] time 0.085 (0.104) data 0.000 (0.002) loss 2.2318 (2.3302) ce_loss 1.1143 (1.2375) loss_zs_kd 1.5156 (1.0441) loss_oracle 0.5803 (0.5411) acc 59.3750 (56.6741) kd_loss 0.8274 (0.8222) lr 2.0000e-03 eta 0:37:10
epoch [2/50] batch [440/445] time 0.100 (0.104) data 0.000 (0.002) loss 2.3974 (2.3256) ce_loss 1.3076 (1.2338) loss_zs_kd 1.4095 (1.0536) loss_oracle 0.6386 (0.5406) acc 50.0000 (56.7614) kd_loss 0.7704 (0.8216) lr 2.0000e-03 eta 0:37:06
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 3,944
* accuracy: 64.6%
* error: 35.4%
* macro_f1: 49.9%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,848
* accuracy: 46.5%
* error: 53.5%
* macro_f1: 27.8%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      64.6%, epoch: 2 *******
******* Domain 3 best val test acc: 46.5%, epoch: 2 *******
******* Domain 3 best test acc:     46.5%, epoch: 2 *******
epoch [3/50] batch [20/445] time 0.108 (0.152) data 0.000 (0.045) loss 2.0360 (2.1526) ce_loss 0.9761 (1.1220) loss_zs_kd 1.2372 (1.2263) loss_oracle 0.5098 (0.4813) acc 65.6250 (59.3750) kd_loss 0.8050 (0.7900) lr 1.9980e-03 eta 0:53:59
epoch [3/50] batch [40/445] time 0.087 (0.128) data 0.000 (0.022) loss 2.2056 (2.1604) ce_loss 1.1631 (1.1270) loss_zs_kd 1.5919 (1.2335) loss_oracle 0.5073 (0.4853) acc 59.3750 (59.9219) kd_loss 0.7888 (0.7907) lr 1.9980e-03 eta 0:45:28
epoch [3/50] batch [60/445] time 0.100 (0.116) data 0.000 (0.015) loss 2.1297 (2.1289) ce_loss 1.1523 (1.1006) loss_zs_kd 1.6445 (1.2766) loss_oracle 0.4623 (0.4804) acc 59.3750 (60.1562) kd_loss 0.7462 (0.7881) lr 1.9980e-03 eta 0:41:17
epoch [3/50] batch [80/445] time 0.104 (0.113) data 0.000 (0.011) loss 2.3097 (2.1261) ce_loss 1.1738 (1.0886) loss_zs_kd 1.6922 (1.3048) loss_oracle 0.5266 (0.4855) acc 53.1250 (60.4297) kd_loss 0.8726 (0.7948) lr 1.9980e-03 eta 0:40:10
epoch [3/50] batch [100/445] time 0.098 (0.111) data 0.000 (0.009) loss 2.1424 (2.1319) ce_loss 1.2256 (1.0894) loss_zs_kd 1.5931 (1.3168) loss_oracle 0.4714 (0.4915) acc 43.7500 (60.3438) kd_loss 0.6811 (0.7968) lr 1.9980e-03 eta 0:39:25
epoch [3/50] batch [120/445] time 0.084 (0.106) data 0.000 (0.008) loss 2.1981 (2.1238) ce_loss 1.0928 (1.0768) loss_zs_kd 1.6249 (1.3088) loss_oracle 0.5743 (0.4938) acc 59.3750 (61.1458) kd_loss 0.8182 (0.8001) lr 1.9980e-03 eta 0:37:37
epoch [3/50] batch [140/445] time 0.089 (0.103) data 0.000 (0.007) loss 2.4882 (2.1337) ce_loss 1.3057 (1.0788) loss_zs_kd 1.4836 (1.3344) loss_oracle 0.6563 (0.5026) acc 56.2500 (61.2277) kd_loss 0.8544 (0.8036) lr 1.9980e-03 eta 0:36:19
epoch [3/50] batch [160/445] time 0.095 (0.102) data 0.000 (0.006) loss 2.3231 (2.1410) ce_loss 1.1631 (1.0827) loss_zs_kd 1.2508 (1.3185) loss_oracle 0.6386 (0.5070) acc 56.2500 (61.0547) kd_loss 0.8407 (0.8047) lr 1.9980e-03 eta 0:36:09
epoch [3/50] batch [180/445] time 0.078 (0.104) data 0.000 (0.005) loss 2.2947 (2.1513) ce_loss 1.1973 (1.0907) loss_zs_kd 1.4344 (1.3362) loss_oracle 0.5043 (0.5084) acc 62.5000 (60.8333) kd_loss 0.8453 (0.8064) lr 1.9980e-03 eta 0:36:34
epoch [3/50] batch [200/445] time 0.071 (0.104) data 0.000 (0.005) loss 2.0182 (2.1519) ce_loss 0.8315 (1.0867) loss_zs_kd 1.6281 (1.3513) loss_oracle 0.5389 (0.5090) acc 71.8750 (60.7031) kd_loss 0.9172 (0.8107) lr 1.9980e-03 eta 0:36:49
epoch [3/50] batch [220/445] time 0.086 (0.103) data 0.000 (0.004) loss 2.2048 (2.1511) ce_loss 0.9575 (1.0814) loss_zs_kd 1.4838 (1.3647) loss_oracle 0.5333 (0.5102) acc 65.6250 (60.9659) kd_loss 0.9806 (0.8146) lr 1.9980e-03 eta 0:36:13
epoch [3/50] batch [240/445] time 0.126 (0.101) data 0.000 (0.004) loss 1.7503 (2.1410) ce_loss 0.6372 (1.0691) loss_zs_kd 1.3864 (1.3702) loss_oracle 0.4964 (0.5124) acc 84.3750 (61.4974) kd_loss 0.8649 (0.8157) lr 1.9980e-03 eta 0:35:42
epoch [3/50] batch [260/445] time 0.165 (0.103) data 0.000 (0.004) loss 1.6373 (2.1384) ce_loss 0.5581 (1.0652) loss_zs_kd 1.4656 (1.3681) loss_oracle 0.4941 (0.5147) acc 84.3750 (61.5625) kd_loss 0.8321 (0.8158) lr 1.9980e-03 eta 0:36:07
epoch [3/50] batch [280/445] time 0.164 (0.104) data 0.000 (0.003) loss 2.0602 (2.1321) ce_loss 1.0146 (1.0602) loss_zs_kd 1.5771 (1.3732) loss_oracle 0.5406 (0.5151) acc 68.7500 (61.7411) kd_loss 0.7752 (0.8143) lr 1.9980e-03 eta 0:36:31
epoch [3/50] batch [300/445] time 0.153 (0.104) data 0.000 (0.003) loss 2.4304 (2.1306) ce_loss 1.3877 (1.0601) loss_zs_kd 1.6430 (1.3824) loss_oracle 0.5259 (0.5165) acc 56.2500 (61.7396) kd_loss 0.7797 (0.8122) lr 1.9980e-03 eta 0:36:27
epoch [3/50] batch [320/445] time 0.074 (0.104) data 0.001 (0.003) loss 1.9755 (2.1296) ce_loss 0.9263 (1.0610) loss_zs_kd 1.2279 (1.3868) loss_oracle 0.5369 (0.5174) acc 62.5000 (61.6406) kd_loss 0.7808 (0.8098) lr 1.9980e-03 eta 0:36:18
epoch [3/50] batch [340/445] time 0.078 (0.104) data 0.000 (0.003) loss 2.3221 (2.1278) ce_loss 1.2832 (1.0618) loss_zs_kd 1.2322 (1.3961) loss_oracle 0.5116 (0.5175) acc 43.7500 (61.6085) kd_loss 0.7831 (0.8072) lr 1.9980e-03 eta 0:36:28
epoch [3/50] batch [360/445] time 0.075 (0.105) data 0.000 (0.003) loss 2.1378 (2.1245) ce_loss 1.2324 (1.0605) loss_zs_kd 1.4505 (1.3898) loss_oracle 0.4665 (0.5171) acc 62.5000 (61.7448) kd_loss 0.6721 (0.8054) lr 1.9980e-03 eta 0:36:37
epoch [3/50] batch [380/445] time 0.078 (0.104) data 0.000 (0.003) loss 1.9129 (2.1170) ce_loss 0.9419 (1.0565) loss_zs_kd 1.4703 (1.3894) loss_oracle 0.5019 (0.5178) acc 56.2500 (61.9326) kd_loss 0.7201 (0.8016) lr 1.9980e-03 eta 0:36:13
epoch [3/50] batch [400/445] time 0.088 (0.103) data 0.000 (0.003) loss 2.1636 (2.1111) ce_loss 1.0068 (1.0543) loss_zs_kd 1.2236 (1.3880) loss_oracle 0.5181 (0.5167) acc 65.6250 (61.9609) kd_loss 0.8977 (0.7985) lr 1.9980e-03 eta 0:36:03
epoch [3/50] batch [420/445] time 0.087 (0.103) data 0.000 (0.002) loss 1.9642 (2.1072) ce_loss 1.0322 (1.0528) loss_zs_kd 1.7031 (1.3938) loss_oracle 0.4377 (0.5175) acc 71.8750 (62.0759) kd_loss 0.7131 (0.7957) lr 1.9980e-03 eta 0:36:00
epoch [3/50] batch [440/445] time 0.101 (0.103) data 0.000 (0.002) loss 2.2998 (2.1054) ce_loss 1.3398 (1.0523) loss_zs_kd 1.3278 (1.3908) loss_oracle 0.4970 (0.5187) acc 50.0000 (62.1094) kd_loss 0.7114 (0.7937) lr 1.9980e-03 eta 0:35:56
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,048
* accuracy: 66.3%
* error: 33.7%
* macro_f1: 50.5%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,815
* accuracy: 45.7%
* error: 54.3%
* macro_f1: 27.8%
******* Domain 3 best val acc:      66.3%, epoch: 3 *******
******* Domain 3 best val test acc: 45.7%, epoch: 3 *******
******* Domain 3 best test acc:     46.5%, epoch: 2 *******
epoch [4/50] batch [20/445] time 0.109 (0.147) data 0.000 (0.041) loss 2.1741 (2.0698) ce_loss 1.1904 (1.0841) loss_zs_kd 1.4557 (1.4690) loss_oracle 0.5896 (0.5047) acc 56.2500 (58.9062) kd_loss 0.6888 (0.7334) lr 1.9921e-03 eta 0:51:18
epoch [4/50] batch [40/445] time 0.105 (0.125) data 0.000 (0.021) loss 2.0853 (2.0771) ce_loss 1.0820 (1.0775) loss_zs_kd 1.4280 (1.4220) loss_oracle 0.6782 (0.5139) acc 56.2500 (59.8438) kd_loss 0.6641 (0.7427) lr 1.9921e-03 eta 0:43:30
epoch [4/50] batch [60/445] time 0.077 (0.113) data 0.000 (0.014) loss 1.6684 (2.0574) ce_loss 0.6611 (1.0592) loss_zs_kd 1.4717 (1.4074) loss_oracle 0.5157 (0.5140) acc 78.1250 (61.1979) kd_loss 0.7494 (0.7412) lr 1.9921e-03 eta 0:39:18
epoch [4/50] batch [80/445] time 0.083 (0.104) data 0.000 (0.010) loss 1.7938 (2.0295) ce_loss 0.8164 (1.0305) loss_zs_kd 1.4266 (1.4037) loss_oracle 0.5677 (0.5147) acc 75.0000 (62.7344) kd_loss 0.6936 (0.7416) lr 1.9921e-03 eta 0:36:13
epoch [4/50] batch [100/445] time 0.159 (0.103) data 0.000 (0.008) loss 1.9868 (2.0245) ce_loss 1.0674 (1.0266) loss_zs_kd 1.3518 (1.4181) loss_oracle 0.4532 (0.5145) acc 62.5000 (62.9375) kd_loss 0.6928 (0.7407) lr 1.9921e-03 eta 0:35:41
epoch [4/50] batch [120/445] time 0.075 (0.105) data 0.000 (0.007) loss 1.9109 (2.0158) ce_loss 0.8696 (1.0183) loss_zs_kd 1.6141 (1.4489) loss_oracle 0.5423 (0.5132) acc 75.0000 (63.4896) kd_loss 0.7701 (0.7409) lr 1.9921e-03 eta 0:36:26
epoch [4/50] batch [140/445] time 0.147 (0.107) data 0.000 (0.006) loss 1.6191 (2.0166) ce_loss 0.7422 (1.0203) loss_zs_kd 1.5681 (1.4477) loss_oracle 0.4553 (0.5111) acc 75.0000 (63.3482) kd_loss 0.6492 (0.7407) lr 1.9921e-03 eta 0:37:03
epoch [4/50] batch [160/445] time 0.088 (0.105) data 0.000 (0.005) loss 2.0106 (2.0116) ce_loss 0.9849 (1.0149) loss_zs_kd 1.2438 (1.4696) loss_oracle 0.5255 (0.5107) acc 59.3750 (63.3398) kd_loss 0.7630 (0.7414) lr 1.9921e-03 eta 0:36:20
epoch [4/50] batch [180/445] time 0.090 (0.103) data 0.000 (0.005) loss 2.1536 (2.0110) ce_loss 1.1211 (1.0150) loss_zs_kd 1.3638 (1.4584) loss_oracle 0.4938 (0.5122) acc 53.1250 (63.3854) kd_loss 0.7856 (0.7399) lr 1.9921e-03 eta 0:35:25
epoch [4/50] batch [200/445] time 0.079 (0.102) data 0.000 (0.004) loss 1.9648 (2.0122) ce_loss 1.1338 (1.0175) loss_zs_kd 1.4296 (1.4545) loss_oracle 0.3962 (0.5134) acc 53.1250 (63.2969) kd_loss 0.6330 (0.7380) lr 1.9921e-03 eta 0:35:17
epoch [4/50] batch [220/445] time 0.081 (0.103) data 0.000 (0.004) loss 1.8135 (2.0030) ce_loss 0.8745 (1.0093) loss_zs_kd 1.2572 (1.4472) loss_oracle 0.4432 (0.5123) acc 62.5000 (63.6790) kd_loss 0.7174 (0.7376) lr 1.9921e-03 eta 0:35:41
epoch [4/50] batch [240/445] time 0.157 (0.105) data 0.000 (0.004) loss 2.1498 (1.9940) ce_loss 1.1738 (1.0036) loss_zs_kd 1.5061 (1.4620) loss_oracle 0.5303 (0.5094) acc 53.1250 (63.9193) kd_loss 0.7108 (0.7356) lr 1.9921e-03 eta 0:36:03
epoch [4/50] batch [260/445] time 0.121 (0.105) data 0.001 (0.003) loss 1.8504 (1.9947) ce_loss 0.8389 (1.0063) loss_zs_kd 1.2938 (1.4678) loss_oracle 0.5116 (0.5090) acc 68.7500 (63.8221) kd_loss 0.7557 (0.7339) lr 1.9921e-03 eta 0:36:12
epoch [4/50] batch [280/445] time 0.078 (0.106) data 0.000 (0.003) loss 2.1788 (1.9908) ce_loss 1.2520 (1.0057) loss_zs_kd 1.5238 (1.4614) loss_oracle 0.5019 (0.5071) acc 68.7500 (64.1295) kd_loss 0.6759 (0.7315) lr 1.9921e-03 eta 0:36:20
epoch [4/50] batch [300/445] time 0.096 (0.107) data 0.000 (0.003) loss 1.9159 (1.9876) ce_loss 1.0605 (1.0059) loss_zs_kd 1.6969 (1.4631) loss_oracle 0.4483 (0.5058) acc 59.3750 (64.1458) kd_loss 0.6312 (0.7287) lr 1.9921e-03 eta 0:36:38
epoch [4/50] batch [320/445] time 0.093 (0.106) data 0.000 (0.003) loss 1.9330 (1.9875) ce_loss 1.0518 (1.0082) loss_zs_kd 1.1488 (1.4564) loss_oracle 0.5336 (0.5060) acc 65.6250 (64.1113) kd_loss 0.6144 (0.7263) lr 1.9921e-03 eta 0:36:19
epoch [4/50] batch [340/445] time 0.077 (0.104) data 0.000 (0.003) loss 2.1416 (1.9845) ce_loss 1.2607 (1.0073) loss_zs_kd 1.8230 (1.4581) loss_oracle 0.4743 (0.5059) acc 56.2500 (64.1544) kd_loss 0.6438 (0.7242) lr 1.9921e-03 eta 0:35:45
epoch [4/50] batch [360/445] time 0.078 (0.104) data 0.000 (0.003) loss 2.0932 (1.9817) ce_loss 1.1514 (1.0078) loss_zs_kd 1.4625 (1.4626) loss_oracle 0.4430 (0.5041) acc 56.2500 (64.1927) kd_loss 0.7203 (0.7218) lr 1.9921e-03 eta 0:35:32
epoch [4/50] batch [380/445] time 0.094 (0.103) data 0.000 (0.002) loss 1.7530 (1.9737) ce_loss 0.8247 (1.0038) loss_zs_kd 1.2961 (1.4651) loss_oracle 0.4681 (0.5022) acc 81.2500 (64.4161) kd_loss 0.6942 (0.7187) lr 1.9921e-03 eta 0:35:20
epoch [4/50] batch [400/445] time 0.097 (0.103) data 0.000 (0.002) loss 2.0335 (1.9736) ce_loss 1.1396 (1.0074) loss_zs_kd 2.0267 (1.4693) loss_oracle 0.4543 (0.5027) acc 62.5000 (64.2734) kd_loss 0.6667 (0.7149) lr 1.9921e-03 eta 0:35:10
epoch [4/50] batch [420/445] time 0.102 (0.103) data 0.000 (0.002) loss 1.7497 (1.9656) ce_loss 0.9072 (1.0036) loss_zs_kd 1.4726 (1.4678) loss_oracle 0.4704 (0.5025) acc 68.7500 (64.4122) kd_loss 0.6073 (0.7108) lr 1.9921e-03 eta 0:35:01
epoch [4/50] batch [440/445] time 0.094 (0.102) data 0.000 (0.002) loss 1.7406 (1.9624) ce_loss 0.8716 (1.0043) loss_zs_kd 1.6798 (1.4754) loss_oracle 0.4729 (0.5007) acc 75.0000 (64.3253) kd_loss 0.6326 (0.7077) lr 1.9921e-03 eta 0:34:54
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,230
* accuracy: 69.3%
* error: 30.7%
* macro_f1: 56.7%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,913
* accuracy: 48.2%
* error: 51.8%
* macro_f1: 32.4%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      69.3%, epoch: 4 *******
******* Domain 3 best val test acc: 48.2%, epoch: 4 *******
******* Domain 3 best test acc:     48.2%, epoch: 4 *******
epoch [5/50] batch [20/445] time 0.085 (0.118) data 0.000 (0.045) loss 1.7122 (1.9612) ce_loss 0.8638 (1.0851) loss_zs_kd 1.8123 (1.4815) loss_oracle 0.5409 (0.4877) acc 65.6250 (62.6562) kd_loss 0.5780 (0.6322) lr 1.9823e-03 eta 0:40:21
epoch [5/50] batch [40/445] time 0.145 (0.105) data 0.000 (0.023) loss 1.6932 (1.8744) ce_loss 0.8657 (1.0191) loss_zs_kd 1.5115 (1.4712) loss_oracle 0.4733 (0.4844) acc 65.6250 (63.1250) kd_loss 0.5908 (0.6131) lr 1.9823e-03 eta 0:35:35
epoch [5/50] batch [60/445] time 0.203 (0.106) data 0.001 (0.015) loss 2.1461 (1.8443) ce_loss 1.3281 (0.9867) loss_zs_kd 1.5333 (1.4806) loss_oracle 0.4627 (0.4840) acc 62.5000 (64.0104) kd_loss 0.5866 (0.6156) lr 1.9823e-03 eta 0:36:04
epoch [5/50] batch [80/445] time 0.142 (0.107) data 0.000 (0.012) loss 1.9424 (1.8434) ce_loss 1.0996 (0.9891) loss_zs_kd 1.5912 (1.4765) loss_oracle 0.4534 (0.4752) acc 50.0000 (64.5703) kd_loss 0.6161 (0.6167) lr 1.9823e-03 eta 0:36:18
epoch [5/50] batch [100/445] time 0.079 (0.104) data 0.000 (0.009) loss 1.7724 (1.8394) ce_loss 0.8838 (0.9829) loss_zs_kd 1.6457 (1.4674) loss_oracle 0.5363 (0.4816) acc 71.8750 (64.5312) kd_loss 0.6205 (0.6157) lr 1.9823e-03 eta 0:35:25
epoch [5/50] batch [120/445] time 0.083 (0.102) data 0.000 (0.008) loss 1.9378 (1.8329) ce_loss 1.0098 (0.9770) loss_zs_kd 1.5331 (1.5056) loss_oracle 0.5737 (0.4798) acc 75.0000 (64.9219) kd_loss 0.6412 (0.6161) lr 1.9823e-03 eta 0:34:30
epoch [5/50] batch [140/445] time 0.076 (0.102) data 0.000 (0.007) loss 2.0328 (1.8466) ce_loss 1.1504 (0.9891) loss_zs_kd 1.3345 (1.5080) loss_oracle 0.5718 (0.4817) acc 56.2500 (64.4643) kd_loss 0.5965 (0.6167) lr 1.9823e-03 eta 0:34:25
epoch [5/50] batch [160/445] time 0.075 (0.103) data 0.000 (0.006) loss 1.6224 (1.8475) ce_loss 0.8022 (0.9900) loss_zs_kd 1.7522 (1.5290) loss_oracle 0.4570 (0.4816) acc 78.1250 (64.1602) kd_loss 0.5916 (0.6167) lr 1.9823e-03 eta 0:34:42
epoch [5/50] batch [180/445] time 0.074 (0.103) data 0.000 (0.005) loss 1.5248 (1.8357) ce_loss 0.7144 (0.9822) loss_zs_kd 1.5232 (1.5348) loss_oracle 0.4975 (0.4824) acc 68.7500 (64.4097) kd_loss 0.5616 (0.6123) lr 1.9823e-03 eta 0:34:58
epoch [5/50] batch [200/445] time 0.073 (0.103) data 0.000 (0.005) loss 1.8844 (1.8314) ce_loss 1.0869 (0.9798) loss_zs_kd 1.3422 (1.5435) loss_oracle 0.4388 (0.4826) acc 62.5000 (64.5938) kd_loss 0.5781 (0.6103) lr 1.9823e-03 eta 0:34:54
epoch [5/50] batch [220/445] time 0.168 (0.103) data 0.000 (0.004) loss 1.7222 (1.8327) ce_loss 0.9019 (0.9827) loss_zs_kd 1.1093 (1.5464) loss_oracle 0.4794 (0.4849) acc 65.6250 (64.4034) kd_loss 0.5806 (0.6076) lr 1.9823e-03 eta 0:34:48
epoch [5/50] batch [240/445] time 0.077 (0.103) data 0.000 (0.004) loss 1.8876 (1.8318) ce_loss 1.0254 (0.9829) loss_zs_kd 1.2837 (1.5455) loss_oracle 0.5180 (0.4850) acc 62.5000 (64.4661) kd_loss 0.6032 (0.6064) lr 1.9823e-03 eta 0:34:41
epoch [5/50] batch [260/445] time 0.162 (0.102) data 0.000 (0.004) loss 2.0090 (1.8325) ce_loss 1.1562 (0.9849) loss_zs_kd 1.5081 (1.5468) loss_oracle 0.4461 (0.4843) acc 68.7500 (64.4712) kd_loss 0.6298 (0.6055) lr 1.9823e-03 eta 0:34:31
epoch [5/50] batch [280/445] time 0.083 (0.102) data 0.000 (0.004) loss 1.7585 (1.8314) ce_loss 0.9136 (0.9850) loss_zs_kd 1.6886 (1.5529) loss_oracle 0.5751 (0.4847) acc 68.7500 (64.3862) kd_loss 0.5574 (0.6040) lr 1.9823e-03 eta 0:34:10
epoch [5/50] batch [300/445] time 0.109 (0.101) data 0.000 (0.003) loss 1.7077 (1.8370) ce_loss 0.8413 (0.9923) loss_zs_kd 1.3714 (1.5508) loss_oracle 0.4610 (0.4835) acc 65.6250 (64.1354) kd_loss 0.6359 (0.6029) lr 1.9823e-03 eta 0:33:47
epoch [5/50] batch [320/445] time 0.091 (0.100) data 0.001 (0.003) loss 1.6588 (1.8380) ce_loss 0.7910 (0.9948) loss_zs_kd 1.4185 (1.5549) loss_oracle 0.5184 (0.4837) acc 78.1250 (64.0137) kd_loss 0.6086 (0.6013) lr 1.9823e-03 eta 0:33:43
epoch [5/50] batch [340/445] time 0.101 (0.100) data 0.000 (0.003) loss 2.0511 (1.8388) ce_loss 1.2266 (0.9968) loss_zs_kd 1.4183 (1.5502) loss_oracle 0.4586 (0.4834) acc 59.3750 (63.8787) kd_loss 0.5952 (0.6002) lr 1.9823e-03 eta 0:33:40
epoch [5/50] batch [360/445] time 0.094 (0.100) data 0.000 (0.003) loss 1.9851 (1.8391) ce_loss 1.0938 (0.9971) loss_zs_kd 1.6867 (1.5430) loss_oracle 0.5342 (0.4843) acc 75.0000 (63.9583) kd_loss 0.6242 (0.5998) lr 1.9823e-03 eta 0:33:40
epoch [5/50] batch [380/445] time 0.096 (0.101) data 0.000 (0.003) loss 1.4589 (1.8317) ce_loss 0.6494 (0.9912) loss_zs_kd 1.7799 (1.5470) loss_oracle 0.4288 (0.4835) acc 81.2500 (64.2270) kd_loss 0.5951 (0.5988) lr 1.9823e-03 eta 0:33:41
epoch [5/50] batch [400/445] time 0.104 (0.101) data 0.000 (0.003) loss 1.6099 (1.8322) ce_loss 0.8237 (0.9919) loss_zs_kd 1.3448 (1.5496) loss_oracle 0.4675 (0.4840) acc 68.7500 (64.2031) kd_loss 0.5524 (0.5983) lr 1.9823e-03 eta 0:33:42
epoch [5/50] batch [420/445] time 0.102 (0.101) data 0.000 (0.002) loss 1.7096 (1.8306) ce_loss 0.9131 (0.9912) loss_zs_kd 1.7411 (1.5548) loss_oracle 0.4984 (0.4848) acc 81.2500 (64.2783) kd_loss 0.5473 (0.5971) lr 1.9823e-03 eta 0:33:44
epoch [5/50] batch [440/445] time 0.097 (0.101) data 0.000 (0.002) loss 2.0628 (1.8267) ce_loss 1.2998 (0.9883) loss_zs_kd 1.6262 (1.5538) loss_oracle 0.4474 (0.4846) acc 62.5000 (64.4034) kd_loss 0.5393 (0.5961) lr 1.9823e-03 eta 0:33:41
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,116
* accuracy: 67.4%
* error: 32.6%
* macro_f1: 55.3%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,008
* accuracy: 50.6%
* error: 49.4%
* macro_f1: 30.9%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      69.3%, epoch: 4 *******
******* Domain 3 best val test acc: 48.2%, epoch: 4 *******
******* Domain 3 best test acc:     50.6%, epoch: 5 *******
epoch [6/50] batch [20/445] time 0.084 (0.159) data 0.000 (0.056) loss 1.8558 (1.9376) ce_loss 1.0361 (1.1068) loss_zs_kd 1.4013 (1.5317) loss_oracle 0.5655 (0.5146) acc 59.3750 (59.6875) kd_loss 0.5369 (0.5735) lr 1.9686e-03 eta 0:52:56
epoch [6/50] batch [40/445] time 0.074 (0.137) data 0.000 (0.028) loss 1.8210 (1.9043) ce_loss 0.8970 (1.0751) loss_zs_kd 1.1621 (1.5380) loss_oracle 0.4857 (0.4964) acc 71.8750 (61.0938) kd_loss 0.6812 (0.5810) lr 1.9686e-03 eta 0:45:42
epoch [6/50] batch [60/445] time 0.082 (0.127) data 0.000 (0.019) loss 1.8672 (1.8504) ce_loss 1.0645 (1.0242) loss_zs_kd 1.6074 (1.5853) loss_oracle 0.4709 (0.4912) acc 53.1250 (62.8646) kd_loss 0.5673 (0.5806) lr 1.9686e-03 eta 0:42:18
epoch [6/50] batch [80/445] time 0.083 (0.116) data 0.000 (0.014) loss 1.6496 (1.8395) ce_loss 0.8379 (1.0181) loss_zs_kd 1.7997 (1.5990) loss_oracle 0.5498 (0.4889) acc 71.8750 (63.3984) kd_loss 0.5368 (0.5770) lr 1.9686e-03 eta 0:38:28
epoch [6/50] batch [100/445] time 0.172 (0.112) data 0.000 (0.011) loss 1.9050 (1.8492) ce_loss 1.1035 (1.0275) loss_zs_kd 1.6512 (1.6005) loss_oracle 0.3576 (0.4876) acc 56.2500 (63.1562) kd_loss 0.6227 (0.5780) lr 1.9686e-03 eta 0:37:09
epoch [6/50] batch [120/445] time 0.076 (0.111) data 0.000 (0.010) loss 1.9022 (1.8477) ce_loss 1.0547 (1.0265) loss_zs_kd 1.5280 (1.5718) loss_oracle 0.4761 (0.4876) acc 59.3750 (63.4115) kd_loss 0.6094 (0.5774) lr 1.9686e-03 eta 0:36:40
epoch [6/50] batch [140/445] time 0.075 (0.111) data 0.000 (0.008) loss 1.7285 (1.8335) ce_loss 0.8765 (1.0115) loss_zs_kd 1.7453 (1.5741) loss_oracle 0.4842 (0.4870) acc 71.8750 (63.9062) kd_loss 0.6100 (0.5785) lr 1.9686e-03 eta 0:36:42
epoch [6/50] batch [160/445] time 0.070 (0.111) data 0.000 (0.007) loss 1.7045 (1.8268) ce_loss 0.9058 (1.0015) loss_zs_kd 1.4573 (1.5811) loss_oracle 0.4120 (0.4845) acc 65.6250 (64.2188) kd_loss 0.5927 (0.5830) lr 1.9686e-03 eta 0:36:35
epoch [6/50] batch [180/445] time 0.075 (0.109) data 0.000 (0.006) loss 1.9275 (1.8275) ce_loss 1.1250 (1.0007) loss_zs_kd 1.6589 (1.5840) loss_oracle 0.4192 (0.4821) acc 56.2500 (64.4097) kd_loss 0.5929 (0.5857) lr 1.9686e-03 eta 0:36:09
epoch [6/50] batch [200/445] time 0.177 (0.109) data 0.000 (0.006) loss 1.4218 (1.8234) ce_loss 0.6812 (0.9975) loss_zs_kd 1.7882 (1.5896) loss_oracle 0.4068 (0.4810) acc 78.1250 (64.4219) kd_loss 0.5373 (0.5855) lr 1.9686e-03 eta 0:36:04
epoch [6/50] batch [220/445] time 0.074 (0.109) data 0.001 (0.005) loss 1.8728 (1.8208) ce_loss 1.0137 (0.9973) loss_zs_kd 1.6649 (1.5882) loss_oracle 0.5404 (0.4805) acc 59.3750 (64.2330) kd_loss 0.5890 (0.5832) lr 1.9686e-03 eta 0:35:57
epoch [6/50] batch [240/445] time 0.082 (0.107) data 0.000 (0.005) loss 1.6982 (1.8235) ce_loss 0.8057 (0.9991) loss_zs_kd 1.6943 (1.5970) loss_oracle 0.5485 (0.4809) acc 71.8750 (64.0625) kd_loss 0.6183 (0.5839) lr 1.9686e-03 eta 0:35:24
epoch [6/50] batch [260/445] time 0.108 (0.106) data 0.000 (0.005) loss 1.8856 (1.8179) ce_loss 1.1133 (0.9953) loss_zs_kd 1.4832 (1.5878) loss_oracle 0.4327 (0.4789) acc 56.2500 (64.1346) kd_loss 0.5559 (0.5832) lr 1.9686e-03 eta 0:34:45
epoch [6/50] batch [280/445] time 0.099 (0.106) data 0.000 (0.004) loss 1.7195 (1.8140) ce_loss 0.9106 (0.9907) loss_zs_kd 1.8838 (1.5921) loss_oracle 0.4200 (0.4778) acc 65.6250 (64.2076) kd_loss 0.5988 (0.5844) lr 1.9686e-03 eta 0:34:43
epoch [6/50] batch [300/445] time 0.106 (0.105) data 0.000 (0.004) loss 2.0162 (1.8159) ce_loss 1.1777 (0.9929) loss_zs_kd 1.4815 (1.5861) loss_oracle 0.5452 (0.4767) acc 50.0000 (64.0104) kd_loss 0.5659 (0.5846) lr 1.9686e-03 eta 0:34:40
epoch [6/50] batch [320/445] time 0.102 (0.105) data 0.000 (0.004) loss 1.7084 (1.8143) ce_loss 0.8989 (0.9909) loss_zs_kd 1.6010 (1.5877) loss_oracle 0.4251 (0.4764) acc 71.8750 (64.0527) kd_loss 0.5969 (0.5851) lr 1.9686e-03 eta 0:34:37
epoch [6/50] batch [340/445] time 0.108 (0.105) data 0.000 (0.004) loss 1.8713 (1.8107) ce_loss 0.8730 (0.9877) loss_zs_kd 1.6180 (1.5861) loss_oracle 0.5009 (0.4756) acc 71.8750 (64.2279) kd_loss 0.7478 (0.5852) lr 1.9686e-03 eta 0:34:34
epoch [6/50] batch [360/445] time 0.079 (0.105) data 0.000 (0.003) loss 1.7379 (1.8115) ce_loss 0.8677 (0.9864) loss_zs_kd 1.5379 (1.5932) loss_oracle 0.5187 (0.4777) acc 68.7500 (64.3056) kd_loss 0.6108 (0.5863) lr 1.9686e-03 eta 0:34:21
epoch [6/50] batch [380/445] time 0.111 (0.105) data 0.000 (0.003) loss 1.9044 (1.8108) ce_loss 1.0693 (0.9834) loss_zs_kd 1.5126 (1.5928) loss_oracle 0.3967 (0.4782) acc 62.5000 (64.4984) kd_loss 0.6367 (0.5883) lr 1.9686e-03 eta 0:34:17
epoch [6/50] batch [400/445] time 0.107 (0.105) data 0.000 (0.003) loss 1.9403 (1.8124) ce_loss 1.0850 (0.9829) loss_zs_kd 1.8959 (1.5995) loss_oracle 0.5289 (0.4801) acc 59.3750 (64.5391) kd_loss 0.5909 (0.5895) lr 1.9686e-03 eta 0:34:15
epoch [6/50] batch [420/445] time 0.108 (0.105) data 0.000 (0.003) loss 1.9172 (1.8148) ce_loss 0.9946 (0.9817) loss_zs_kd 1.5477 (1.6055) loss_oracle 0.5084 (0.4813) acc 71.8750 (64.6949) kd_loss 0.6683 (0.5924) lr 1.9686e-03 eta 0:34:13
epoch [6/50] batch [440/445] time 0.097 (0.105) data 0.000 (0.003) loss 1.8378 (1.8164) ce_loss 0.9482 (0.9804) loss_zs_kd 1.8676 (1.6027) loss_oracle 0.4822 (0.4826) acc 71.8750 (64.8011) kd_loss 0.6485 (0.5946) lr 1.9686e-03 eta 0:34:08
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,102
* accuracy: 67.2%
* error: 32.8%
* macro_f1: 55.8%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,774
* accuracy: 44.7%
* error: 55.3%
* macro_f1: 29.8%
******* Domain 3 best val acc:      69.3%, epoch: 4 *******
******* Domain 3 best val test acc: 48.2%, epoch: 4 *******
******* Domain 3 best test acc:     50.6%, epoch: 5 *******
epoch [7/50] batch [20/445] time 0.090 (0.164) data 0.000 (0.066) loss 1.9720 (1.8872) ce_loss 0.9907 (0.9640) loss_zs_kd 1.6678 (1.6295) loss_oracle 0.5632 (0.5105) acc 71.8750 (65.4688) kd_loss 0.6996 (0.6679) lr 1.9511e-03 eta 0:53:27
epoch [7/50] batch [40/445] time 0.090 (0.125) data 0.000 (0.033) loss 1.9651 (1.9021) ce_loss 1.0859 (0.9842) loss_zs_kd 1.5767 (1.5579) loss_oracle 0.4726 (0.4927) acc 59.3750 (65.0000) kd_loss 0.6429 (0.6715) lr 1.9511e-03 eta 0:40:41
epoch [7/50] batch [60/445] time 0.181 (0.113) data 0.000 (0.022) loss 1.7649 (1.8824) ce_loss 0.9858 (0.9579) loss_zs_kd 1.6181 (1.5725) loss_oracle 0.4536 (0.4939) acc 71.8750 (66.5625) kd_loss 0.5523 (0.6776) lr 1.9511e-03 eta 0:36:51
epoch [7/50] batch [80/445] time 0.079 (0.111) data 0.000 (0.017) loss 1.7227 (1.8792) ce_loss 0.7891 (0.9606) loss_zs_kd 1.7827 (1.5874) loss_oracle 0.5358 (0.4970) acc 71.8750 (66.2891) kd_loss 0.6658 (0.6701) lr 1.9511e-03 eta 0:36:10
epoch [7/50] batch [100/445] time 0.077 (0.112) data 0.000 (0.013) loss 2.2813 (1.8737) ce_loss 1.4111 (0.9653) loss_zs_kd 1.6873 (1.6099) loss_oracle 0.4932 (0.4945) acc 46.8750 (65.8438) kd_loss 0.6236 (0.6611) lr 1.9511e-03 eta 0:36:26
epoch [7/50] batch [120/445] time 0.083 (0.113) data 0.000 (0.011) loss 1.9732 (1.8777) ce_loss 1.1064 (0.9719) loss_zs_kd 1.5506 (1.6297) loss_oracle 0.4482 (0.4960) acc 65.6250 (65.5990) kd_loss 0.6427 (0.6578) lr 1.9511e-03 eta 0:36:37
epoch [7/50] batch [140/445] time 0.081 (0.113) data 0.000 (0.010) loss 1.4613 (1.8727) ce_loss 0.5361 (0.9687) loss_zs_kd 1.7143 (1.6304) loss_oracle 0.5116 (0.4974) acc 81.2500 (65.7143) kd_loss 0.6694 (0.6552) lr 1.9511e-03 eta 0:36:46
epoch [7/50] batch [160/445] time 0.078 (0.113) data 0.000 (0.008) loss 1.7358 (1.8623) ce_loss 0.8813 (0.9631) loss_zs_kd 2.0574 (1.6435) loss_oracle 0.5112 (0.4951) acc 65.6250 (65.6055) kd_loss 0.5988 (0.6517) lr 1.9511e-03 eta 0:36:43
epoch [7/50] batch [180/445] time 0.081 (0.114) data 0.000 (0.008) loss 2.1119 (1.8549) ce_loss 1.2598 (0.9587) loss_zs_kd 1.3830 (1.6428) loss_oracle 0.4261 (0.4930) acc 59.3750 (65.6771) kd_loss 0.6391 (0.6497) lr 1.9511e-03 eta 0:36:44
epoch [7/50] batch [200/445] time 0.077 (0.111) data 0.000 (0.007) loss 2.0478 (1.8593) ce_loss 1.2100 (0.9626) loss_zs_kd 1.8545 (1.6410) loss_oracle 0.4634 (0.4946) acc 50.0000 (65.4844) kd_loss 0.6062 (0.6494) lr 1.9511e-03 eta 0:35:41
epoch [7/50] batch [220/445] time 0.107 (0.109) data 0.000 (0.006) loss 1.9175 (1.8653) ce_loss 1.0732 (0.9669) loss_zs_kd 1.4541 (1.6283) loss_oracle 0.5507 (0.4956) acc 65.6250 (65.3409) kd_loss 0.5689 (0.6506) lr 1.9511e-03 eta 0:35:10
epoch [7/50] batch [240/445] time 0.100 (0.109) data 0.000 (0.006) loss 2.1916 (1.8659) ce_loss 1.3359 (0.9692) loss_zs_kd 1.3237 (1.6240) loss_oracle 0.4389 (0.4950) acc 59.3750 (65.1172) kd_loss 0.6362 (0.6491) lr 1.9511e-03 eta 0:34:59
epoch [7/50] batch [260/445] time 0.094 (0.108) data 0.000 (0.005) loss 1.8159 (1.8652) ce_loss 0.9849 (0.9722) loss_zs_kd 1.5522 (1.6182) loss_oracle 0.4761 (0.4955) acc 62.5000 (65.0361) kd_loss 0.5930 (0.6453) lr 1.9511e-03 eta 0:34:52
epoch [7/50] batch [280/445] time 0.100 (0.108) data 0.000 (0.005) loss 2.1398 (1.8640) ce_loss 1.2529 (0.9738) loss_zs_kd 1.2692 (1.6146) loss_oracle 0.4555 (0.4935) acc 56.2500 (64.9665) kd_loss 0.6591 (0.6434) lr 1.9511e-03 eta 0:34:44
epoch [7/50] batch [300/445] time 0.112 (0.108) data 0.000 (0.005) loss 1.9706 (1.8625) ce_loss 1.0820 (0.9753) loss_zs_kd 1.8992 (1.6152) loss_oracle 0.5660 (0.4929) acc 59.3750 (64.9792) kd_loss 0.6056 (0.6407) lr 1.9511e-03 eta 0:34:38
epoch [7/50] batch [320/445] time 0.104 (0.108) data 0.000 (0.004) loss 1.2952 (1.8583) ce_loss 0.5259 (0.9761) loss_zs_kd 1.3626 (1.6093) loss_oracle 0.4951 (0.4918) acc 81.2500 (65.0098) kd_loss 0.5218 (0.6362) lr 1.9511e-03 eta 0:34:32
epoch [7/50] batch [340/445] time 0.107 (0.107) data 0.000 (0.004) loss 1.5914 (1.8546) ce_loss 0.7271 (0.9756) loss_zs_kd 1.3516 (1.6069) loss_oracle 0.5681 (0.4917) acc 75.0000 (65.0000) kd_loss 0.5803 (0.6332) lr 1.9511e-03 eta 0:34:27
epoch [7/50] batch [360/445] time 0.116 (0.107) data 0.000 (0.004) loss 1.9537 (1.8571) ce_loss 1.1689 (0.9804) loss_zs_kd 1.6832 (1.6044) loss_oracle 0.4913 (0.4935) acc 50.0000 (64.8438) kd_loss 0.5391 (0.6299) lr 1.9511e-03 eta 0:34:22
epoch [7/50] batch [380/445] time 0.107 (0.107) data 0.000 (0.004) loss 1.7203 (1.8511) ce_loss 0.9023 (0.9776) loss_zs_kd 1.5194 (1.6077) loss_oracle 0.4855 (0.4922) acc 68.7500 (64.9671) kd_loss 0.5752 (0.6274) lr 1.9511e-03 eta 0:34:16
epoch [7/50] batch [400/445] time 0.094 (0.107) data 0.000 (0.004) loss 1.9944 (1.8499) ce_loss 1.1631 (0.9785) loss_zs_kd 1.7405 (1.6070) loss_oracle 0.5794 (0.4915) acc 50.0000 (64.9609) kd_loss 0.5416 (0.6257) lr 1.9511e-03 eta 0:34:11
epoch [7/50] batch [420/445] time 0.114 (0.107) data 0.000 (0.003) loss 1.5160 (1.8494) ce_loss 0.8154 (0.9794) loss_zs_kd 1.6755 (1.6125) loss_oracle 0.3238 (0.4914) acc 71.8750 (64.9256) kd_loss 0.5386 (0.6243) lr 1.9511e-03 eta 0:34:06
epoch [7/50] batch [440/445] time 0.100 (0.107) data 0.001 (0.003) loss 1.9365 (1.8475) ce_loss 1.1426 (0.9798) loss_zs_kd 1.2197 (1.6168) loss_oracle 0.5190 (0.4919) acc 53.1250 (64.8153) kd_loss 0.5344 (0.6217) lr 1.9511e-03 eta 0:33:59
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,205
* accuracy: 68.8%
* error: 31.2%
* macro_f1: 55.3%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,017
* accuracy: 50.8%
* error: 49.2%
* macro_f1: 33.1%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      69.3%, epoch: 4 *******
******* Domain 3 best val test acc: 48.2%, epoch: 4 *******
******* Domain 3 best test acc:     50.8%, epoch: 7 *******
epoch [8/50] batch [20/445] time 0.166 (0.168) data 0.000 (0.059) loss 1.6614 (1.8010) ce_loss 0.8755 (0.9909) loss_zs_kd 1.7140 (1.6682) loss_oracle 0.4968 (0.4685) acc 68.7500 (63.5938) kd_loss 0.5375 (0.5759) lr 1.9298e-03 eta 0:53:27
epoch [8/50] batch [40/445] time 0.135 (0.140) data 0.000 (0.030) loss 1.4482 (1.7905) ce_loss 0.5474 (0.9569) loss_zs_kd 1.5443 (1.6265) loss_oracle 0.4928 (0.4846) acc 84.3750 (65.1562) kd_loss 0.6545 (0.5913) lr 1.9298e-03 eta 0:44:32
epoch [8/50] batch [60/445] time 0.175 (0.131) data 0.000 (0.020) loss 1.6986 (1.7824) ce_loss 0.9375 (0.9533) loss_zs_kd 1.4737 (1.6063) loss_oracle 0.4808 (0.4828) acc 65.6250 (65.6250) kd_loss 0.5207 (0.5877) lr 1.9298e-03 eta 0:41:44
epoch [8/50] batch [80/445] time 0.078 (0.123) data 0.000 (0.015) loss 1.9980 (1.7880) ce_loss 1.1631 (0.9605) loss_zs_kd 1.4914 (1.6091) loss_oracle 0.4697 (0.4825) acc 56.2500 (65.6250) kd_loss 0.6000 (0.5863) lr 1.9298e-03 eta 0:39:10
epoch [8/50] batch [100/445] time 0.072 (0.121) data 0.000 (0.012) loss 2.1230 (1.7844) ce_loss 1.2471 (0.9606) loss_zs_kd 1.3814 (1.5989) loss_oracle 0.5484 (0.4794) acc 59.3750 (65.5938) kd_loss 0.6017 (0.5841) lr 1.9298e-03 eta 0:38:23
epoch [8/50] batch [120/445] time 0.074 (0.120) data 0.000 (0.010) loss 1.8924 (1.7882) ce_loss 1.0762 (0.9640) loss_zs_kd 1.9040 (1.5976) loss_oracle 0.4706 (0.4798) acc 62.5000 (65.4948) kd_loss 0.5809 (0.5843) lr 1.9298e-03 eta 0:37:54
epoch [8/50] batch [140/445] time 0.076 (0.117) data 0.000 (0.009) loss 1.6744 (1.7884) ce_loss 0.9175 (0.9705) loss_zs_kd 1.7792 (1.6016) loss_oracle 0.3574 (0.4741) acc 68.7500 (65.3571) kd_loss 0.5782 (0.5809) lr 1.9298e-03 eta 0:36:58
epoch [8/50] batch [160/445] time 0.093 (0.112) data 0.000 (0.008) loss 1.6363 (1.7804) ce_loss 0.7896 (0.9633) loss_zs_kd 1.2336 (1.6099) loss_oracle 0.4164 (0.4727) acc 68.7500 (65.4883) kd_loss 0.6385 (0.5807) lr 1.9298e-03 eta 0:35:33
epoch [8/50] batch [180/445] time 0.102 (0.111) data 0.000 (0.007) loss 1.6817 (1.7769) ce_loss 0.9268 (0.9601) loss_zs_kd 1.4656 (1.6173) loss_oracle 0.5042 (0.4729) acc 65.6250 (65.5729) kd_loss 0.5029 (0.5803) lr 1.9298e-03 eta 0:35:07
epoch [8/50] batch [200/445] time 0.108 (0.111) data 0.000 (0.006) loss 1.8539 (1.7808) ce_loss 1.0381 (0.9648) loss_zs_kd 1.3822 (1.6337) loss_oracle 0.4252 (0.4737) acc 50.0000 (65.2656) kd_loss 0.6032 (0.5792) lr 1.9298e-03 eta 0:35:08
epoch [8/50] batch [220/445] time 0.099 (0.111) data 0.000 (0.006) loss 1.7306 (1.7842) ce_loss 0.8320 (0.9670) loss_zs_kd 1.5910 (1.6358) loss_oracle 0.5432 (0.4769) acc 65.6250 (65.1847) kd_loss 0.6270 (0.5788) lr 1.9298e-03 eta 0:34:54
epoch [8/50] batch [240/445] time 0.106 (0.110) data 0.000 (0.005) loss 1.8445 (1.7860) ce_loss 1.0713 (0.9690) loss_zs_kd 1.3169 (1.6416) loss_oracle 0.4781 (0.4786) acc 62.5000 (65.2865) kd_loss 0.5341 (0.5776) lr 1.9298e-03 eta 0:34:42
epoch [8/50] batch [260/445] time 0.105 (0.110) data 0.000 (0.005) loss 1.8675 (1.7856) ce_loss 0.9785 (0.9663) loss_zs_kd 1.5618 (1.6397) loss_oracle 0.5928 (0.4828) acc 59.3750 (65.3846) kd_loss 0.5926 (0.5779) lr 1.9298e-03 eta 0:34:32
epoch [8/50] batch [280/445] time 0.094 (0.109) data 0.000 (0.005) loss 1.3731 (1.7840) ce_loss 0.5269 (0.9641) loss_zs_kd 1.6688 (1.6439) loss_oracle 0.4532 (0.4833) acc 81.2500 (65.3348) kd_loss 0.6197 (0.5783) lr 1.9298e-03 eta 0:34:22
epoch [8/50] batch [300/445] time 0.099 (0.109) data 0.000 (0.004) loss 1.5190 (1.7843) ce_loss 0.7437 (0.9630) loss_zs_kd 2.0155 (1.6419) loss_oracle 0.3841 (0.4832) acc 81.2500 (65.2812) kd_loss 0.5833 (0.5797) lr 1.9298e-03 eta 0:34:14
epoch [8/50] batch [320/445] time 0.110 (0.109) data 0.000 (0.004) loss 1.7466 (1.7836) ce_loss 1.0020 (0.9618) loss_zs_kd 1.6392 (1.6476) loss_oracle 0.4276 (0.4819) acc 71.8750 (65.4492) kd_loss 0.5309 (0.5809) lr 1.9298e-03 eta 0:34:05
epoch [8/50] batch [340/445] time 0.113 (0.108) data 0.000 (0.004) loss 1.6969 (1.7839) ce_loss 0.8203 (0.9611) loss_zs_kd 1.4757 (1.6482) loss_oracle 0.4514 (0.4810) acc 68.7500 (65.4596) kd_loss 0.6509 (0.5823) lr 1.9298e-03 eta 0:33:58
epoch [8/50] batch [360/445] time 0.104 (0.108) data 0.000 (0.004) loss 1.6532 (1.7853) ce_loss 0.9370 (0.9610) loss_zs_kd 1.7760 (1.6502) loss_oracle 0.3413 (0.4810) acc 68.7500 (65.4861) kd_loss 0.5455 (0.5838) lr 1.9298e-03 eta 0:33:52
epoch [8/50] batch [380/445] time 0.107 (0.108) data 0.000 (0.003) loss 1.7450 (1.7841) ce_loss 0.9263 (0.9597) loss_zs_kd 1.5782 (1.6508) loss_oracle 0.4935 (0.4807) acc 65.6250 (65.6003) kd_loss 0.5720 (0.5841) lr 1.9298e-03 eta 0:33:46
epoch [8/50] batch [400/445] time 0.107 (0.108) data 0.000 (0.003) loss 1.4330 (1.7805) ce_loss 0.5986 (0.9567) loss_zs_kd 1.9466 (1.6526) loss_oracle 0.4930 (0.4794) acc 78.1250 (65.5781) kd_loss 0.5879 (0.5841) lr 1.9298e-03 eta 0:33:41
epoch [8/50] batch [420/445] time 0.106 (0.108) data 0.000 (0.003) loss 1.8174 (1.7797) ce_loss 0.9766 (0.9564) loss_zs_kd 1.9959 (1.6605) loss_oracle 0.4860 (0.4775) acc 56.2500 (65.5952) kd_loss 0.5978 (0.5846) lr 1.9298e-03 eta 0:33:33
epoch [8/50] batch [440/445] time 0.097 (0.107) data 0.000 (0.003) loss 1.8614 (1.7833) ce_loss 0.8062 (0.9586) loss_zs_kd 1.6667 (1.6607) loss_oracle 0.5938 (0.4781) acc 71.8750 (65.4616) kd_loss 0.7583 (0.5856) lr 1.9298e-03 eta 0:33:28
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,134
* accuracy: 67.7%
* error: 32.3%
* macro_f1: 56.6%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,752
* accuracy: 44.1%
* error: 55.9%
* macro_f1: 29.6%
******* Domain 3 best val acc:      69.3%, epoch: 4 *******
******* Domain 3 best val test acc: 48.2%, epoch: 4 *******
******* Domain 3 best test acc:     50.8%, epoch: 7 *******
epoch [9/50] batch [20/445] time 0.078 (0.175) data 0.000 (0.059) loss 1.9741 (1.8690) ce_loss 1.0049 (0.9977) loss_zs_kd 1.5803 (1.6833) loss_oracle 0.4430 (0.5069) acc 56.2500 (65.3125) kd_loss 0.7478 (0.6179) lr 1.9048e-03 eta 0:54:29
epoch [9/50] batch [40/445] time 0.098 (0.147) data 0.000 (0.029) loss 1.8040 (1.8270) ce_loss 0.9951 (0.9636) loss_zs_kd 1.4107 (1.6061) loss_oracle 0.4477 (0.4944) acc 71.8750 (66.5625) kd_loss 0.5850 (0.6163) lr 1.9048e-03 eta 0:45:45
epoch [9/50] batch [60/445] time 0.159 (0.140) data 0.001 (0.020) loss 1.7686 (1.8245) ce_loss 0.8789 (0.9686) loss_zs_kd 1.8265 (1.6091) loss_oracle 0.6371 (0.4965) acc 65.6250 (66.0417) kd_loss 0.5711 (0.6077) lr 1.9048e-03 eta 0:43:30
epoch [9/50] batch [80/445] time 0.159 (0.134) data 0.000 (0.015) loss 2.0565 (1.8536) ce_loss 1.1514 (0.9917) loss_zs_kd 1.9520 (1.6138) loss_oracle 0.5983 (0.4985) acc 59.3750 (64.8047) kd_loss 0.6060 (0.6126) lr 1.9048e-03 eta 0:41:37
epoch [9/50] batch [100/445] time 0.080 (0.124) data 0.000 (0.012) loss 1.8213 (1.8520) ce_loss 0.8882 (0.9872) loss_zs_kd 1.4385 (1.6022) loss_oracle 0.5249 (0.4983) acc 68.7500 (64.9688) kd_loss 0.6706 (0.6156) lr 1.9048e-03 eta 0:38:31
epoch [9/50] batch [120/445] time 0.102 (0.118) data 0.000 (0.010) loss 1.8908 (1.8423) ce_loss 1.0371 (0.9744) loss_zs_kd 1.7206 (1.6214) loss_oracle 0.5091 (0.4988) acc 50.0000 (65.3646) kd_loss 0.5992 (0.6184) lr 1.9048e-03 eta 0:36:24
epoch [9/50] batch [140/445] time 0.106 (0.116) data 0.000 (0.009) loss 1.8067 (1.8367) ce_loss 0.9424 (0.9667) loss_zs_kd 1.7727 (1.6272) loss_oracle 0.4740 (0.5017) acc 68.7500 (65.6473) kd_loss 0.6273 (0.6192) lr 1.9048e-03 eta 0:35:49
epoch [9/50] batch [160/445] time 0.098 (0.115) data 0.000 (0.008) loss 1.8364 (1.8351) ce_loss 1.0801 (0.9641) loss_zs_kd 1.6179 (1.6278) loss_oracle 0.4925 (0.5001) acc 59.3750 (65.6445) kd_loss 0.5101 (0.6210) lr 1.9048e-03 eta 0:35:21
epoch [9/50] batch [180/445] time 0.111 (0.113) data 0.000 (0.007) loss 1.6886 (1.8336) ce_loss 0.8037 (0.9614) loss_zs_kd 2.1230 (1.6282) loss_oracle 0.5857 (0.5002) acc 65.6250 (65.7118) kd_loss 0.5920 (0.6220) lr 1.9048e-03 eta 0:34:59
epoch [9/50] batch [200/445] time 0.101 (0.112) data 0.000 (0.006) loss 1.5414 (1.8299) ce_loss 0.7231 (0.9588) loss_zs_kd 1.7032 (1.6338) loss_oracle 0.4599 (0.4986) acc 84.3750 (65.7500) kd_loss 0.5883 (0.6218) lr 1.9048e-03 eta 0:34:39
epoch [9/50] batch [220/445] time 0.104 (0.112) data 0.000 (0.006) loss 1.6467 (1.8273) ce_loss 0.8765 (0.9580) loss_zs_kd 1.6543 (1.6370) loss_oracle 0.4605 (0.4989) acc 68.7500 (65.8097) kd_loss 0.5399 (0.6198) lr 1.9048e-03 eta 0:34:28
epoch [9/50] batch [240/445] time 0.100 (0.112) data 0.000 (0.005) loss 1.9510 (1.8309) ce_loss 1.1416 (0.9653) loss_zs_kd 1.8734 (1.6447) loss_oracle 0.5034 (0.4987) acc 62.5000 (65.5599) kd_loss 0.5577 (0.6162) lr 1.9048e-03 eta 0:34:18
epoch [9/50] batch [260/445] time 0.114 (0.111) data 0.000 (0.005) loss 1.9625 (1.8275) ce_loss 1.0576 (0.9653) loss_zs_kd 1.7188 (1.6513) loss_oracle 0.5676 (0.5003) acc 78.1250 (65.8173) kd_loss 0.6211 (0.6121) lr 1.9048e-03 eta 0:34:11
epoch [9/50] batch [280/445] time 0.094 (0.111) data 0.000 (0.004) loss 1.6136 (1.8193) ce_loss 0.7954 (0.9608) loss_zs_kd 1.3024 (1.6577) loss_oracle 0.4864 (0.4996) acc 65.6250 (65.9933) kd_loss 0.5749 (0.6088) lr 1.9048e-03 eta 0:33:58
epoch [9/50] batch [300/445] time 0.092 (0.110) data 0.000 (0.004) loss 1.9311 (1.8141) ce_loss 1.1133 (0.9595) loss_zs_kd 1.7611 (1.6614) loss_oracle 0.4815 (0.4981) acc 56.2500 (65.9062) kd_loss 0.5770 (0.6055) lr 1.9048e-03 eta 0:33:43
epoch [9/50] batch [320/445] time 0.100 (0.110) data 0.000 (0.004) loss 1.8068 (1.8123) ce_loss 0.9409 (0.9590) loss_zs_kd 1.4692 (1.6725) loss_oracle 0.5941 (0.4982) acc 65.6250 (65.9961) kd_loss 0.5688 (0.6042) lr 1.9048e-03 eta 0:33:34
epoch [9/50] batch [340/445] time 0.101 (0.109) data 0.000 (0.004) loss 1.6222 (1.8081) ce_loss 0.7681 (0.9560) loss_zs_kd 2.0259 (1.6818) loss_oracle 0.4992 (0.4985) acc 68.7500 (66.1029) kd_loss 0.6045 (0.6028) lr 1.9048e-03 eta 0:33:26
epoch [9/50] batch [360/445] time 0.101 (0.109) data 0.000 (0.004) loss 1.8910 (1.8058) ce_loss 1.1406 (0.9550) loss_zs_kd 1.7177 (1.6884) loss_oracle 0.4076 (0.4978) acc 71.8750 (66.1545) kd_loss 0.5466 (0.6018) lr 1.9048e-03 eta 0:33:19
epoch [9/50] batch [380/445] time 0.105 (0.109) data 0.000 (0.003) loss 1.7107 (1.8032) ce_loss 0.9214 (0.9541) loss_zs_kd 2.4240 (1.6923) loss_oracle 0.4538 (0.4978) acc 68.7500 (66.1595) kd_loss 0.5624 (0.6002) lr 1.9048e-03 eta 0:33:10
epoch [9/50] batch [400/445] time 0.100 (0.109) data 0.000 (0.003) loss 2.0141 (1.8022) ce_loss 1.1006 (0.9535) loss_zs_kd 1.6046 (1.6919) loss_oracle 0.5142 (0.4978) acc 62.5000 (66.1406) kd_loss 0.6564 (0.5998) lr 1.9048e-03 eta 0:33:04
epoch [9/50] batch [420/445] time 0.106 (0.108) data 0.000 (0.003) loss 1.8224 (1.8029) ce_loss 0.9653 (0.9554) loss_zs_kd 1.7138 (1.6900) loss_oracle 0.5026 (0.4977) acc 65.6250 (66.1086) kd_loss 0.6058 (0.5986) lr 1.9048e-03 eta 0:32:58
epoch [9/50] batch [440/445] time 0.072 (0.108) data 0.000 (0.003) loss 1.5927 (1.8008) ce_loss 0.7920 (0.9539) loss_zs_kd 2.0721 (1.6969) loss_oracle 0.4607 (0.4984) acc 75.0000 (66.1577) kd_loss 0.5704 (0.5977) lr 1.9048e-03 eta 0:32:47
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,190
* accuracy: 68.6%
* error: 31.4%
* macro_f1: 56.7%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,069
* accuracy: 52.1%
* error: 47.9%
* macro_f1: 31.6%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      69.3%, epoch: 4 *******
******* Domain 3 best val test acc: 48.2%, epoch: 4 *******
******* Domain 3 best test acc:     52.1%, epoch: 9 *******
epoch [10/50] batch [20/445] time 0.153 (0.194) data 0.000 (0.071) loss 1.6251 (1.7125) ce_loss 0.7588 (0.8756) loss_zs_kd 1.5442 (1.7777) loss_oracle 0.4773 (0.4768) acc 68.7500 (68.9062) kd_loss 0.6276 (0.5985) lr 1.8763e-03 eta 0:58:52
epoch [10/50] batch [40/445] time 0.076 (0.157) data 0.000 (0.036) loss 1.7733 (1.7525) ce_loss 0.9448 (0.9121) loss_zs_kd 1.8605 (1.7845) loss_oracle 0.4537 (0.4813) acc 68.7500 (68.7500) kd_loss 0.6016 (0.5998) lr 1.8763e-03 eta 0:47:37
epoch [10/50] batch [60/445] time 0.074 (0.138) data 0.000 (0.024) loss 1.5583 (1.7893) ce_loss 0.7568 (0.9440) loss_zs_kd 1.2133 (1.7371) loss_oracle 0.4632 (0.4915) acc 78.1250 (67.6042) kd_loss 0.5699 (0.5995) lr 1.8763e-03 eta 0:41:55
epoch [10/50] batch [80/445] time 0.094 (0.125) data 0.000 (0.018) loss 2.1790 (1.7955) ce_loss 1.3438 (0.9566) loss_zs_kd 1.7462 (1.7472) loss_oracle 0.5974 (0.4917) acc 50.0000 (66.6406) kd_loss 0.5365 (0.5930) lr 1.8763e-03 eta 0:37:48
epoch [10/50] batch [100/445] time 0.100 (0.119) data 0.000 (0.014) loss 1.4508 (1.7867) ce_loss 0.6196 (0.9452) loss_zs_kd 1.7399 (1.7721) loss_oracle 0.5409 (0.5005) acc 84.3750 (66.9062) kd_loss 0.5608 (0.5912) lr 1.8763e-03 eta 0:36:03
epoch [10/50] batch [120/445] time 0.103 (0.117) data 0.001 (0.012) loss 1.7587 (1.7995) ce_loss 0.8955 (0.9541) loss_zs_kd 1.7329 (1.7732) loss_oracle 0.5373 (0.5068) acc 68.7500 (66.1719) kd_loss 0.5945 (0.5920) lr 1.8763e-03 eta 0:35:16
epoch [10/50] batch [140/445] time 0.099 (0.115) data 0.000 (0.010) loss 1.7642 (1.7973) ce_loss 0.8354 (0.9543) loss_zs_kd 2.0872 (1.7720) loss_oracle 0.5800 (0.5024) acc 65.6250 (65.9821) kd_loss 0.6387 (0.5918) lr 1.8763e-03 eta 0:34:44
epoch [10/50] batch [160/445] time 0.111 (0.114) data 0.000 (0.009) loss 1.7571 (1.7944) ce_loss 0.8706 (0.9530) loss_zs_kd 2.0279 (1.7582) loss_oracle 0.5648 (0.5025) acc 75.0000 (66.3672) kd_loss 0.6040 (0.5901) lr 1.8763e-03 eta 0:34:28
epoch [10/50] batch [180/445] time 0.108 (0.113) data 0.000 (0.008) loss 2.4636 (1.8024) ce_loss 1.6650 (0.9613) loss_zs_kd 1.2986 (1.7469) loss_oracle 0.4561 (0.5030) acc 56.2500 (66.0764) kd_loss 0.5705 (0.5897) lr 1.8763e-03 eta 0:34:05
epoch [10/50] batch [200/445] time 0.104 (0.112) data 0.000 (0.007) loss 1.7360 (1.7966) ce_loss 0.8872 (0.9552) loss_zs_kd 1.7867 (1.7427) loss_oracle 0.5384 (0.5037) acc 59.3750 (66.3281) kd_loss 0.5795 (0.5896) lr 1.8763e-03 eta 0:33:49
epoch [10/50] batch [220/445] time 0.104 (0.112) data 0.000 (0.007) loss 1.5249 (1.7998) ce_loss 0.7583 (0.9583) loss_zs_kd 1.9180 (1.7394) loss_oracle 0.4729 (0.5061) acc 56.2500 (65.8807) kd_loss 0.5301 (0.5885) lr 1.8763e-03 eta 0:33:33
epoch [10/50] batch [240/445] time 0.097 (0.111) data 0.000 (0.006) loss 1.8353 (1.8012) ce_loss 0.9473 (0.9586) loss_zs_kd 1.7568 (1.7321) loss_oracle 0.5932 (0.5097) acc 71.8750 (65.8724) kd_loss 0.5914 (0.5878) lr 1.8763e-03 eta 0:33:21
epoch [10/50] batch [260/445] time 0.098 (0.111) data 0.000 (0.006) loss 1.7182 (1.7950) ce_loss 0.8574 (0.9542) loss_zs_kd 1.5406 (1.7369) loss_oracle 0.5027 (0.5110) acc 68.7500 (66.0096) kd_loss 0.6095 (0.5853) lr 1.8763e-03 eta 0:33:07
epoch [10/50] batch [280/445] time 0.102 (0.110) data 0.000 (0.005) loss 2.0552 (1.7903) ce_loss 1.2070 (0.9534) loss_zs_kd 1.8859 (1.7360) loss_oracle 0.4999 (0.5074) acc 56.2500 (66.0714) kd_loss 0.5982 (0.5832) lr 1.8763e-03 eta 0:32:58
epoch [10/50] batch [300/445] time 0.102 (0.110) data 0.000 (0.005) loss 1.6621 (1.7830) ce_loss 0.8604 (0.9468) loss_zs_kd 1.8207 (1.7363) loss_oracle 0.4799 (0.5072) acc 65.6250 (66.1875) kd_loss 0.5618 (0.5826) lr 1.8763e-03 eta 0:32:50
epoch [10/50] batch [320/445] time 0.115 (0.110) data 0.000 (0.005) loss 1.6059 (1.7799) ce_loss 0.6675 (0.9455) loss_zs_kd 1.8112 (1.7378) loss_oracle 0.6214 (0.5061) acc 78.1250 (66.2402) kd_loss 0.6278 (0.5813) lr 1.8763e-03 eta 0:32:43
epoch [10/50] batch [340/445] time 0.104 (0.109) data 0.000 (0.004) loss 1.5070 (1.7855) ce_loss 0.6738 (0.9503) loss_zs_kd 1.8994 (1.7450) loss_oracle 0.4776 (0.5060) acc 75.0000 (66.1305) kd_loss 0.5943 (0.5823) lr 1.8763e-03 eta 0:32:34
epoch [10/50] batch [360/445] time 0.104 (0.109) data 0.000 (0.004) loss 1.6550 (1.7856) ce_loss 0.7949 (0.9510) loss_zs_kd 1.3830 (1.7451) loss_oracle 0.5028 (0.5055) acc 65.6250 (66.0938) kd_loss 0.6087 (0.5819) lr 1.8763e-03 eta 0:32:24
epoch [10/50] batch [380/445] time 0.096 (0.108) data 0.000 (0.004) loss 1.6293 (1.7845) ce_loss 0.7969 (0.9504) loss_zs_kd 1.9740 (1.7429) loss_oracle 0.5065 (0.5037) acc 68.7500 (66.0526) kd_loss 0.5792 (0.5822) lr 1.8763e-03 eta 0:32:18
epoch [10/50] batch [400/445] time 0.095 (0.108) data 0.000 (0.004) loss 1.7921 (1.7828) ce_loss 0.9287 (0.9494) loss_zs_kd 1.5740 (1.7408) loss_oracle 0.4619 (0.5034) acc 59.3750 (66.0469) kd_loss 0.6324 (0.5817) lr 1.8763e-03 eta 0:32:11
epoch [10/50] batch [420/445] time 0.093 (0.107) data 0.000 (0.004) loss 1.7682 (1.7814) ce_loss 0.9551 (0.9481) loss_zs_kd 2.1634 (1.7435) loss_oracle 0.5615 (0.5032) acc 59.3750 (66.0565) kd_loss 0.5323 (0.5817) lr 1.8763e-03 eta 0:31:51
epoch [10/50] batch [440/445] time 0.070 (0.106) data 0.000 (0.004) loss 1.8005 (1.7846) ce_loss 0.9653 (0.9504) loss_zs_kd 1.8424 (1.7436) loss_oracle 0.5068 (0.5036) acc 68.7500 (65.9872) kd_loss 0.5817 (0.5824) lr 1.8763e-03 eta 0:31:23
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,244
* accuracy: 69.5%
* error: 30.5%
* macro_f1: 57.1%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,022
* accuracy: 50.9%
* error: 49.1%
* macro_f1: 33.3%
******* Domain 3 best val acc:      69.5%, epoch: 10 *******
******* Domain 3 best val test acc: 50.9%, epoch: 10 *******
******* Domain 3 best test acc:     52.1%, epoch: 9 *******
epoch [11/50] batch [20/445] time 0.138 (0.210) data 0.000 (0.093) loss 1.7861 (1.7926) ce_loss 0.9482 (0.9675) loss_zs_kd 1.8283 (1.7016) loss_oracle 0.4405 (0.4847) acc 65.6250 (63.9062) kd_loss 0.6176 (0.5828) lr 1.8443e-03 eta 1:02:18
epoch [11/50] batch [40/445] time 0.085 (0.147) data 0.000 (0.047) loss 2.2482 (1.7822) ce_loss 1.3936 (0.9528) loss_zs_kd 1.7118 (1.7651) loss_oracle 0.4804 (0.4914) acc 56.2500 (66.4062) kd_loss 0.6144 (0.5837) lr 1.8443e-03 eta 0:43:22
epoch [11/50] batch [60/445] time 0.098 (0.126) data 0.001 (0.031) loss 1.7456 (1.7878) ce_loss 0.8555 (0.9569) loss_zs_kd 1.9474 (1.7651) loss_oracle 0.5132 (0.4932) acc 62.5000 (65.9896) kd_loss 0.6335 (0.5843) lr 1.8443e-03 eta 0:37:13
epoch [11/50] batch [80/445] time 0.108 (0.120) data 0.000 (0.024) loss 1.8139 (1.7875) ce_loss 0.8901 (0.9467) loss_zs_kd 1.8006 (1.7447) loss_oracle 0.5119 (0.4976) acc 68.7500 (66.2109) kd_loss 0.6678 (0.5920) lr 1.8443e-03 eta 0:35:31
epoch [11/50] batch [100/445] time 0.106 (0.117) data 0.000 (0.019) loss 1.4803 (1.7850) ce_loss 0.6636 (0.9392) loss_zs_kd 1.5366 (1.7494) loss_oracle 0.4475 (0.4968) acc 71.8750 (66.7500) kd_loss 0.5929 (0.5975) lr 1.8443e-03 eta 0:34:30
epoch [11/50] batch [120/445] time 0.105 (0.114) data 0.000 (0.016) loss 1.9431 (1.7929) ce_loss 1.1230 (0.9402) loss_zs_kd 1.8655 (1.7722) loss_oracle 0.5013 (0.4976) acc 50.0000 (66.6146) kd_loss 0.5694 (0.6039) lr 1.8443e-03 eta 0:33:37
epoch [11/50] batch [140/445] time 0.103 (0.113) data 0.000 (0.014) loss 1.7210 (1.7937) ce_loss 0.8843 (0.9377) loss_zs_kd 1.6124 (1.7699) loss_oracle 0.4519 (0.4957) acc 65.6250 (66.7411) kd_loss 0.6108 (0.6082) lr 1.8443e-03 eta 0:33:15
epoch [11/50] batch [160/445] time 0.099 (0.112) data 0.000 (0.012) loss 1.7983 (1.7999) ce_loss 0.8472 (0.9418) loss_zs_kd 1.8670 (1.7751) loss_oracle 0.5956 (0.4988) acc 71.8750 (66.3672) kd_loss 0.6533 (0.6087) lr 1.8443e-03 eta 0:32:54
epoch [11/50] batch [180/445] time 0.094 (0.111) data 0.000 (0.011) loss 1.8331 (1.8005) ce_loss 0.9307 (0.9432) loss_zs_kd 1.9291 (1.7887) loss_oracle 0.5225 (0.4952) acc 56.2500 (66.1111) kd_loss 0.6412 (0.6097) lr 1.8443e-03 eta 0:32:33
epoch [11/50] batch [200/445] time 0.104 (0.110) data 0.000 (0.010) loss 1.8493 (1.7994) ce_loss 1.0049 (0.9430) loss_zs_kd 2.0396 (1.7976) loss_oracle 0.4336 (0.4913) acc 62.5000 (66.1875) kd_loss 0.6276 (0.6108) lr 1.8443e-03 eta 0:32:21
epoch [11/50] batch [220/445] time 0.102 (0.110) data 0.000 (0.009) loss 1.6990 (1.7928) ce_loss 0.6641 (0.9382) loss_zs_kd 1.8922 (1.8040) loss_oracle 0.6010 (0.4888) acc 81.2500 (66.3352) kd_loss 0.7344 (0.6102) lr 1.8443e-03 eta 0:32:07
epoch [11/50] batch [240/445] time 0.114 (0.109) data 0.000 (0.008) loss 1.4633 (1.7962) ce_loss 0.6553 (0.9432) loss_zs_kd 1.4682 (1.7946) loss_oracle 0.4128 (0.4865) acc 75.0000 (66.2500) kd_loss 0.6016 (0.6097) lr 1.8443e-03 eta 0:31:56
epoch [11/50] batch [260/445] time 0.097 (0.109) data 0.000 (0.007) loss 1.5625 (1.7998) ce_loss 0.7573 (0.9472) loss_zs_kd 1.8881 (1.7907) loss_oracle 0.4578 (0.4862) acc 62.5000 (66.2620) kd_loss 0.5763 (0.6096) lr 1.8443e-03 eta 0:31:45
epoch [11/50] batch [280/445] time 0.099 (0.108) data 0.000 (0.007) loss 1.8608 (1.7986) ce_loss 1.1318 (0.9497) loss_zs_kd 1.7709 (1.7747) loss_oracle 0.4027 (0.4829) acc 50.0000 (66.1161) kd_loss 0.5276 (0.6074) lr 1.8443e-03 eta 0:31:38
epoch [11/50] batch [300/445] time 0.091 (0.108) data 0.000 (0.006) loss 1.8002 (1.7959) ce_loss 0.9170 (0.9480) loss_zs_kd 1.8066 (1.7644) loss_oracle 0.5679 (0.4826) acc 71.8750 (66.3125) kd_loss 0.5993 (0.6067) lr 1.8443e-03 eta 0:31:28
epoch [11/50] batch [320/445] time 0.096 (0.107) data 0.000 (0.006) loss 1.6831 (1.7945) ce_loss 0.9258 (0.9478) loss_zs_kd 1.7809 (1.7609) loss_oracle 0.4754 (0.4822) acc 68.7500 (66.2891) kd_loss 0.5196 (0.6056) lr 1.8443e-03 eta 0:31:17
epoch [11/50] batch [340/445] time 0.098 (0.107) data 0.000 (0.006) loss 1.8612 (1.7951) ce_loss 1.0713 (0.9496) loss_zs_kd 1.5444 (1.7685) loss_oracle 0.4149 (0.4825) acc 56.2500 (66.0846) kd_loss 0.5824 (0.6043) lr 1.8443e-03 eta 0:31:08
epoch [11/50] batch [360/445] time 0.111 (0.107) data 0.000 (0.005) loss 1.7759 (1.7925) ce_loss 0.9585 (0.9476) loss_zs_kd 2.1714 (1.7700) loss_oracle 0.4480 (0.4835) acc 62.5000 (66.1458) kd_loss 0.5934 (0.6031) lr 1.8443e-03 eta 0:31:04
epoch [11/50] batch [380/445] time 0.071 (0.106) data 0.000 (0.005) loss 1.8172 (1.7906) ce_loss 0.9404 (0.9478) loss_zs_kd 1.4929 (1.7686) loss_oracle 0.4913 (0.4824) acc 71.8750 (66.0691) kd_loss 0.6312 (0.6016) lr 1.8443e-03 eta 0:30:51
epoch [11/50] batch [400/445] time 0.082 (0.105) data 0.000 (0.005) loss 2.1432 (1.7872) ce_loss 1.3662 (0.9462) loss_zs_kd 1.6205 (1.7658) loss_oracle 0.3989 (0.4820) acc 68.7500 (66.2188) kd_loss 0.5776 (0.6000) lr 1.8443e-03 eta 0:30:30
epoch [11/50] batch [420/445] time 0.089 (0.104) data 0.000 (0.005) loss 1.6792 (1.7848) ce_loss 0.9229 (0.9455) loss_zs_kd 1.6296 (1.7707) loss_oracle 0.4471 (0.4809) acc 78.1250 (66.2946) kd_loss 0.5329 (0.5988) lr 1.8443e-03 eta 0:30:13
epoch [11/50] batch [440/445] time 0.143 (0.105) data 0.000 (0.004) loss 1.5339 (1.7805) ce_loss 0.7578 (0.9431) loss_zs_kd 1.7567 (1.7748) loss_oracle 0.4769 (0.4806) acc 65.6250 (66.4062) kd_loss 0.5377 (0.5971) lr 1.8443e-03 eta 0:30:21
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,198
* accuracy: 68.7%
* error: 31.3%
* macro_f1: 57.9%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,000
* accuracy: 50.4%
* error: 49.6%
* macro_f1: 34.8%
******* Domain 3 best val acc:      69.5%, epoch: 10 *******
******* Domain 3 best val test acc: 50.9%, epoch: 10 *******
******* Domain 3 best test acc:     52.1%, epoch: 9 *******
epoch [12/50] batch [20/445] time 0.091 (0.179) data 0.000 (0.086) loss 2.0953 (1.8289) ce_loss 1.1475 (1.0051) loss_zs_kd 1.8127 (1.8369) loss_oracle 0.5575 (0.5029) acc 53.1250 (63.5938) kd_loss 0.6690 (0.5724) lr 1.8090e-03 eta 0:51:36
epoch [12/50] batch [40/445] time 0.089 (0.134) data 0.000 (0.043) loss 1.6815 (1.8203) ce_loss 0.9077 (0.9968) loss_zs_kd 1.5868 (1.8426) loss_oracle 0.4358 (0.5045) acc 75.0000 (64.6875) kd_loss 0.5559 (0.5713) lr 1.8090e-03 eta 0:38:36
epoch [12/50] batch [60/445] time 0.118 (0.121) data 0.001 (0.029) loss 1.6163 (1.7996) ce_loss 0.8062 (0.9761) loss_zs_kd 1.7197 (1.8187) loss_oracle 0.4529 (0.5016) acc 65.6250 (65.5729) kd_loss 0.5837 (0.5727) lr 1.8090e-03 eta 0:35:00
epoch [12/50] batch [80/445] time 0.113 (0.117) data 0.000 (0.022) loss 1.5916 (1.7861) ce_loss 0.7827 (0.9678) loss_zs_kd 1.4147 (1.8082) loss_oracle 0.4888 (0.5016) acc 68.7500 (65.3906) kd_loss 0.5645 (0.5674) lr 1.8090e-03 eta 0:33:39
epoch [12/50] batch [100/445] time 0.102 (0.114) data 0.000 (0.017) loss 1.9213 (1.7787) ce_loss 1.1904 (0.9646) loss_zs_kd 1.9371 (1.8217) loss_oracle 0.4749 (0.4975) acc 59.3750 (65.7812) kd_loss 0.4934 (0.5653) lr 1.8090e-03 eta 0:32:52
epoch [12/50] batch [120/445] time 0.106 (0.113) data 0.000 (0.015) loss 1.8443 (1.7739) ce_loss 1.1221 (0.9626) loss_zs_kd 1.8813 (1.8178) loss_oracle 0.4225 (0.4949) acc 56.2500 (65.5729) kd_loss 0.5110 (0.5639) lr 1.8090e-03 eta 0:32:21
epoch [12/50] batch [140/445] time 0.114 (0.113) data 0.000 (0.013) loss 1.6650 (1.7735) ce_loss 0.8545 (0.9625) loss_zs_kd 2.0500 (1.8208) loss_oracle 0.4566 (0.4960) acc 68.7500 (65.3125) kd_loss 0.5822 (0.5630) lr 1.8090e-03 eta 0:32:26
epoch [12/50] batch [160/445] time 0.107 (0.112) data 0.000 (0.011) loss 1.7668 (1.7649) ce_loss 0.9346 (0.9530) loss_zs_kd 2.2457 (1.8207) loss_oracle 0.4981 (0.4999) acc 62.5000 (65.6641) kd_loss 0.5832 (0.5620) lr 1.8090e-03 eta 0:32:03
epoch [12/50] batch [180/445] time 0.090 (0.111) data 0.000 (0.010) loss 1.7322 (1.7636) ce_loss 0.9224 (0.9515) loss_zs_kd 1.8569 (1.8203) loss_oracle 0.4761 (0.4991) acc 68.7500 (65.7292) kd_loss 0.5718 (0.5626) lr 1.8090e-03 eta 0:31:43
epoch [12/50] batch [200/445] time 0.093 (0.110) data 0.000 (0.009) loss 1.3952 (1.7625) ce_loss 0.5811 (0.9488) loss_zs_kd 1.6572 (1.8062) loss_oracle 0.4729 (0.5000) acc 75.0000 (65.8438) kd_loss 0.5777 (0.5637) lr 1.8090e-03 eta 0:31:29
epoch [12/50] batch [220/445] time 0.106 (0.110) data 0.000 (0.008) loss 1.6732 (1.7590) ce_loss 0.9229 (0.9463) loss_zs_kd 1.3996 (1.8066) loss_oracle 0.4702 (0.4987) acc 78.1250 (66.0085) kd_loss 0.5152 (0.5634) lr 1.8090e-03 eta 0:31:18
epoch [12/50] batch [240/445] time 0.097 (0.109) data 0.000 (0.007) loss 1.8201 (1.7581) ce_loss 1.0371 (0.9467) loss_zs_kd 1.9821 (1.8090) loss_oracle 0.4331 (0.4969) acc 62.5000 (65.9115) kd_loss 0.5664 (0.5630) lr 1.8090e-03 eta 0:31:07
epoch [12/50] batch [260/445] time 0.097 (0.109) data 0.000 (0.007) loss 1.8656 (1.7592) ce_loss 1.0430 (0.9457) loss_zs_kd 1.4549 (1.8023) loss_oracle 0.5400 (0.4968) acc 68.7500 (65.8654) kd_loss 0.5526 (0.5651) lr 1.8090e-03 eta 0:31:00
epoch [12/50] batch [280/445] time 0.107 (0.109) data 0.000 (0.006) loss 1.8206 (1.7554) ce_loss 0.9463 (0.9412) loss_zs_kd 1.5977 (1.7915) loss_oracle 0.5224 (0.4949) acc 71.8750 (66.1272) kd_loss 0.6131 (0.5667) lr 1.8090e-03 eta 0:30:54
epoch [12/50] batch [300/445] time 0.090 (0.108) data 0.000 (0.006) loss 1.9682 (1.7551) ce_loss 1.0166 (0.9400) loss_zs_kd 1.6068 (1.7937) loss_oracle 0.5195 (0.4960) acc 56.2500 (66.2188) kd_loss 0.6919 (0.5672) lr 1.8090e-03 eta 0:30:46
epoch [12/50] batch [320/445] time 0.083 (0.107) data 0.000 (0.006) loss 1.5712 (1.7544) ce_loss 0.7588 (0.9403) loss_zs_kd 2.1924 (1.7935) loss_oracle 0.4496 (0.4937) acc 75.0000 (66.1230) kd_loss 0.5876 (0.5672) lr 1.8090e-03 eta 0:30:26
epoch [12/50] batch [340/445] time 0.084 (0.106) data 0.000 (0.005) loss 1.9736 (1.7517) ce_loss 1.1377 (0.9373) loss_zs_kd 1.4418 (1.7958) loss_oracle 0.4747 (0.4935) acc 62.5000 (66.3143) kd_loss 0.5985 (0.5676) lr 1.8090e-03 eta 0:29:59
epoch [12/50] batch [360/445] time 0.078 (0.104) data 0.000 (0.005) loss 1.7980 (1.7570) ce_loss 0.9565 (0.9405) loss_zs_kd 1.6314 (1.7892) loss_oracle 0.4630 (0.4943) acc 62.5000 (66.2934) kd_loss 0.6100 (0.5693) lr 1.8090e-03 eta 0:29:35
epoch [12/50] batch [380/445] time 0.167 (0.105) data 0.000 (0.005) loss 1.5835 (1.7608) ce_loss 0.7817 (0.9425) loss_zs_kd 1.7134 (1.7889) loss_oracle 0.5136 (0.4951) acc 65.6250 (66.1266) kd_loss 0.5450 (0.5708) lr 1.8090e-03 eta 0:29:42
epoch [12/50] batch [400/445] time 0.153 (0.105) data 0.000 (0.005) loss 1.9531 (1.7648) ce_loss 1.1074 (0.9454) loss_zs_kd 1.9886 (1.7872) loss_oracle 0.5128 (0.4949) acc 62.5000 (66.1797) kd_loss 0.5893 (0.5719) lr 1.8090e-03 eta 0:29:41
epoch [12/50] batch [420/445] time 0.077 (0.105) data 0.000 (0.004) loss 1.6999 (1.7621) ce_loss 0.7949 (0.9425) loss_zs_kd 2.0110 (1.7879) loss_oracle 0.5917 (0.4953) acc 71.8750 (66.2946) kd_loss 0.6092 (0.5720) lr 1.8090e-03 eta 0:29:44
epoch [12/50] batch [440/445] time 0.072 (0.104) data 0.000 (0.004) loss 1.8998 (1.7606) ce_loss 1.1143 (0.9403) loss_zs_kd 1.7282 (1.7899) loss_oracle 0.4627 (0.4953) acc 56.2500 (66.4276) kd_loss 0.5542 (0.5727) lr 1.8090e-03 eta 0:29:21
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,306
* accuracy: 70.5%
* error: 29.5%
* macro_f1: 57.8%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,092
* accuracy: 52.7%
* error: 47.3%
* macro_f1: 31.9%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      70.5%, epoch: 12 *******
******* Domain 3 best val test acc: 52.7%, epoch: 12 *******
******* Domain 3 best test acc:     52.7%, epoch: 12 *******
epoch [13/50] batch [20/445] time 0.109 (0.190) data 0.000 (0.082) loss 1.8303 (1.6555) ce_loss 0.9160 (0.8374) loss_zs_kd 2.0843 (1.8512) loss_oracle 0.5604 (0.4979) acc 59.3750 (70.6250) kd_loss 0.6341 (0.5692) lr 1.7705e-03 eta 0:53:21
epoch [13/50] batch [40/445] time 0.106 (0.147) data 0.000 (0.041) loss 1.8232 (1.7001) ce_loss 0.9727 (0.8867) loss_zs_kd 1.8041 (1.8250) loss_oracle 0.4644 (0.4843) acc 71.8750 (69.1406) kd_loss 0.6183 (0.5712) lr 1.7705e-03 eta 0:41:26
epoch [13/50] batch [60/445] time 0.093 (0.133) data 0.000 (0.027) loss 1.7854 (1.7296) ce_loss 0.9731 (0.9094) loss_zs_kd 1.9098 (1.8913) loss_oracle 0.4713 (0.4904) acc 62.5000 (68.3854) kd_loss 0.5766 (0.5750) lr 1.7705e-03 eta 0:37:22
epoch [13/50] batch [80/445] time 0.104 (0.126) data 0.000 (0.021) loss 1.9321 (1.7386) ce_loss 1.1025 (0.9161) loss_zs_kd 2.0836 (1.8700) loss_oracle 0.5470 (0.4931) acc 56.2500 (68.1250) kd_loss 0.5561 (0.5760) lr 1.7705e-03 eta 0:35:20
epoch [13/50] batch [100/445] time 0.103 (0.122) data 0.000 (0.017) loss 1.6890 (1.7603) ce_loss 0.8911 (0.9347) loss_zs_kd 2.3033 (1.8877) loss_oracle 0.4583 (0.4943) acc 65.6250 (67.7812) kd_loss 0.5688 (0.5785) lr 1.7705e-03 eta 0:34:11
epoch [13/50] batch [120/445] time 0.093 (0.119) data 0.000 (0.014) loss 1.7517 (1.7640) ce_loss 0.8672 (0.9358) loss_zs_kd 1.7206 (1.8791) loss_oracle 0.4916 (0.4997) acc 71.8750 (67.5000) kd_loss 0.6387 (0.5783) lr 1.7705e-03 eta 0:33:18
epoch [13/50] batch [140/445] time 0.114 (0.117) data 0.000 (0.012) loss 1.8125 (1.7621) ce_loss 0.8560 (0.9297) loss_zs_kd 1.6634 (1.8688) loss_oracle 0.5828 (0.5016) acc 65.6250 (67.2545) kd_loss 0.6652 (0.5816) lr 1.7705e-03 eta 0:32:44
epoch [13/50] batch [160/445] time 0.108 (0.116) data 0.000 (0.010) loss 1.9764 (1.7632) ce_loss 1.1982 (0.9250) loss_zs_kd 1.3596 (1.8564) loss_oracle 0.4591 (0.5048) acc 59.3750 (67.2656) kd_loss 0.5486 (0.5858) lr 1.7705e-03 eta 0:32:16
epoch [13/50] batch [180/445] time 0.106 (0.114) data 0.000 (0.009) loss 1.9513 (1.7652) ce_loss 1.0195 (0.9246) loss_zs_kd 2.4327 (1.8654) loss_oracle 0.5662 (0.5029) acc 65.6250 (67.2222) kd_loss 0.6486 (0.5891) lr 1.7705e-03 eta 0:31:51
epoch [13/50] batch [200/445] time 0.105 (0.113) data 0.000 (0.008) loss 1.7315 (1.7751) ce_loss 0.8491 (0.9314) loss_zs_kd 1.8030 (1.8553) loss_oracle 0.4905 (0.5029) acc 68.7500 (67.0156) kd_loss 0.6372 (0.5922) lr 1.7705e-03 eta 0:31:30
epoch [13/50] batch [220/445] time 0.106 (0.112) data 0.000 (0.008) loss 2.0143 (1.7793) ce_loss 1.1055 (0.9329) loss_zs_kd 1.7771 (1.8578) loss_oracle 0.5771 (0.5044) acc 62.5000 (67.1591) kd_loss 0.6202 (0.5943) lr 1.7705e-03 eta 0:31:12
epoch [13/50] batch [240/445] time 0.097 (0.112) data 0.000 (0.007) loss 1.7338 (1.7758) ce_loss 0.9121 (0.9290) loss_zs_kd 2.2116 (1.8671) loss_oracle 0.4942 (0.5034) acc 65.6250 (67.2526) kd_loss 0.5746 (0.5951) lr 1.7705e-03 eta 0:30:59
epoch [13/50] batch [260/445] time 0.102 (0.111) data 0.000 (0.007) loss 1.7475 (1.7790) ce_loss 0.7705 (0.9305) loss_zs_kd 2.0712 (1.8593) loss_oracle 0.6322 (0.5030) acc 78.1250 (67.0673) kd_loss 0.6609 (0.5970) lr 1.7705e-03 eta 0:30:47
epoch [13/50] batch [280/445] time 0.096 (0.110) data 0.000 (0.006) loss 1.6711 (1.7854) ce_loss 0.8906 (0.9344) loss_zs_kd 1.6102 (1.8489) loss_oracle 0.4092 (0.5022) acc 68.7500 (67.0201) kd_loss 0.5758 (0.5999) lr 1.7705e-03 eta 0:30:33
epoch [13/50] batch [300/445] time 0.074 (0.110) data 0.000 (0.006) loss 1.4825 (1.7863) ce_loss 0.7310 (0.9352) loss_zs_kd 1.7302 (1.8439) loss_oracle 0.3931 (0.5014) acc 75.0000 (67.0625) kd_loss 0.5550 (0.6004) lr 1.7705e-03 eta 0:30:18
epoch [13/50] batch [320/445] time 0.077 (0.107) data 0.000 (0.005) loss 1.8869 (1.7809) ce_loss 1.0557 (0.9299) loss_zs_kd 1.7885 (1.8464) loss_oracle 0.5228 (0.5004) acc 53.1250 (67.1582) kd_loss 0.5699 (0.6008) lr 1.7705e-03 eta 0:29:40
epoch [13/50] batch [340/445] time 0.082 (0.106) data 0.000 (0.005) loss 1.6556 (1.7811) ce_loss 0.8101 (0.9300) loss_zs_kd 1.7161 (1.8399) loss_oracle 0.4996 (0.4985) acc 75.0000 (67.1599) kd_loss 0.5958 (0.6019) lr 1.7705e-03 eta 0:29:18
epoch [13/50] batch [360/445] time 0.183 (0.106) data 0.000 (0.005) loss 2.0435 (1.7813) ce_loss 1.0020 (0.9294) loss_zs_kd 1.7517 (1.8325) loss_oracle 0.5566 (0.4992) acc 62.5000 (67.2396) kd_loss 0.7632 (0.6023) lr 1.7705e-03 eta 0:29:15
epoch [13/50] batch [380/445] time 0.177 (0.107) data 0.000 (0.005) loss 1.8919 (1.7822) ce_loss 0.8613 (0.9307) loss_zs_kd 1.9626 (1.8331) loss_oracle 0.5711 (0.4983) acc 71.8750 (67.2368) kd_loss 0.7451 (0.6024) lr 1.7705e-03 eta 0:29:25
epoch [13/50] batch [400/445] time 0.080 (0.107) data 0.000 (0.004) loss 1.8911 (1.7868) ce_loss 1.0098 (0.9342) loss_zs_kd 1.4235 (1.8250) loss_oracle 0.4903 (0.4977) acc 62.5000 (67.0781) kd_loss 0.6362 (0.6038) lr 1.7705e-03 eta 0:29:29
epoch [13/50] batch [420/445] time 0.088 (0.106) data 0.000 (0.004) loss 2.1797 (1.7894) ce_loss 1.4141 (0.9359) loss_zs_kd 1.7741 (1.8233) loss_oracle 0.4486 (0.4969) acc 56.2500 (67.0089) kd_loss 0.5413 (0.6051) lr 1.7705e-03 eta 0:29:08
epoch [13/50] batch [440/445] time 0.076 (0.105) data 0.000 (0.004) loss 2.1772 (1.7891) ce_loss 1.2363 (0.9346) loss_zs_kd 1.6932 (1.8226) loss_oracle 0.4698 (0.4968) acc 53.1250 (67.0099) kd_loss 0.7060 (0.6061) lr 1.7705e-03 eta 0:28:45
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,331
* accuracy: 70.9%
* error: 29.1%
* macro_f1: 57.3%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,979
* accuracy: 49.8%
* error: 50.2%
* macro_f1: 32.4%
******* Domain 3 best val acc:      70.9%, epoch: 13 *******
******* Domain 3 best val test acc: 49.8%, epoch: 13 *******
******* Domain 3 best test acc:     52.7%, epoch: 12 *******
epoch [14/50] batch [20/445] time 0.100 (0.192) data 0.000 (0.091) loss 1.8059 (1.7988) ce_loss 0.9741 (0.9465) loss_zs_kd 1.6161 (1.7536) loss_oracle 0.4723 (0.4739) acc 68.7500 (64.6875) kd_loss 0.5957 (0.6154) lr 1.7290e-03 eta 0:52:38
epoch [14/50] batch [40/445] time 0.112 (0.148) data 0.000 (0.046) loss 1.9417 (1.8032) ce_loss 0.8906 (0.9371) loss_zs_kd 1.6394 (1.7634) loss_oracle 0.6558 (0.4971) acc 71.8750 (66.3281) kd_loss 0.7232 (0.6176) lr 1.7290e-03 eta 0:40:33
epoch [14/50] batch [60/445] time 0.110 (0.133) data 0.000 (0.031) loss 1.7218 (1.8184) ce_loss 0.7773 (0.9498) loss_zs_kd 1.9301 (1.7965) loss_oracle 0.5623 (0.4958) acc 71.8750 (66.2500) kd_loss 0.6633 (0.6207) lr 1.7290e-03 eta 0:36:22
epoch [14/50] batch [80/445] time 0.091 (0.126) data 0.000 (0.023) loss 1.6879 (1.8123) ce_loss 0.7720 (0.9418) loss_zs_kd 1.9620 (1.8357) loss_oracle 0.5064 (0.4934) acc 75.0000 (66.2891) kd_loss 0.6627 (0.6239) lr 1.7290e-03 eta 0:34:23
epoch [14/50] batch [100/445] time 0.113 (0.122) data 0.000 (0.018) loss 1.8578 (1.8109) ce_loss 0.8818 (0.9352) loss_zs_kd 1.8737 (1.8222) loss_oracle 0.4628 (0.4884) acc 71.8750 (66.3750) kd_loss 0.7445 (0.6316) lr 1.7290e-03 eta 0:33:14
epoch [14/50] batch [120/445] time 0.117 (0.119) data 0.000 (0.015) loss 2.2210 (1.8092) ce_loss 1.3076 (0.9341) loss_zs_kd 1.5735 (1.8020) loss_oracle 0.5234 (0.4860) acc 53.1250 (66.2760) kd_loss 0.6517 (0.6320) lr 1.7290e-03 eta 0:32:24
epoch [14/50] batch [140/445] time 0.097 (0.117) data 0.000 (0.013) loss 1.5086 (1.8095) ce_loss 0.6602 (0.9354) loss_zs_kd 1.6845 (1.8099) loss_oracle 0.3696 (0.4830) acc 84.3750 (66.4286) kd_loss 0.6636 (0.6326) lr 1.7290e-03 eta 0:31:43
epoch [14/50] batch [160/445] time 0.091 (0.114) data 0.000 (0.012) loss 1.7335 (1.8050) ce_loss 0.8442 (0.9295) loss_zs_kd 1.4845 (1.8083) loss_oracle 0.4346 (0.4828) acc 78.1250 (66.8945) kd_loss 0.6720 (0.6342) lr 1.7290e-03 eta 0:31:00
epoch [14/50] batch [180/445] time 0.095 (0.113) data 0.000 (0.010) loss 1.7545 (1.8084) ce_loss 1.0029 (0.9366) loss_zs_kd 1.9116 (1.8223) loss_oracle 0.3799 (0.4839) acc 56.2500 (66.5104) kd_loss 0.5616 (0.6299) lr 1.7290e-03 eta 0:30:33
epoch [14/50] batch [200/445] time 0.090 (0.111) data 0.000 (0.009) loss 1.8960 (1.8001) ce_loss 1.0664 (0.9300) loss_zs_kd 1.7004 (1.8300) loss_oracle 0.4717 (0.4830) acc 65.6250 (66.9219) kd_loss 0.5938 (0.6286) lr 1.7290e-03 eta 0:30:09
epoch [14/50] batch [220/445] time 0.102 (0.110) data 0.000 (0.009) loss 1.7654 (1.7944) ce_loss 0.8955 (0.9283) loss_zs_kd 1.6494 (1.8290) loss_oracle 0.5209 (0.4797) acc 65.6250 (67.1449) kd_loss 0.6095 (0.6262) lr 1.7290e-03 eta 0:29:54
epoch [14/50] batch [240/445] time 0.096 (0.110) data 0.000 (0.008) loss 1.8855 (1.7938) ce_loss 0.9839 (0.9295) loss_zs_kd 1.6875 (1.8312) loss_oracle 0.4384 (0.4787) acc 62.5000 (67.1615) kd_loss 0.6824 (0.6250) lr 1.7290e-03 eta 0:29:44
epoch [14/50] batch [260/445] time 0.104 (0.110) data 0.000 (0.007) loss 1.8461 (1.7991) ce_loss 1.0010 (0.9356) loss_zs_kd 1.9141 (1.8316) loss_oracle 0.5276 (0.4798) acc 62.5000 (66.9111) kd_loss 0.5813 (0.6236) lr 1.7290e-03 eta 0:29:36
epoch [14/50] batch [280/445] time 0.094 (0.108) data 0.000 (0.007) loss 1.6439 (1.7970) ce_loss 0.7876 (0.9333) loss_zs_kd 1.4939 (1.8297) loss_oracle 0.5417 (0.4813) acc 68.7500 (66.9420) kd_loss 0.5855 (0.6231) lr 1.7290e-03 eta 0:29:05
epoch [14/50] batch [300/445] time 0.088 (0.106) data 0.000 (0.006) loss 1.7432 (1.7956) ce_loss 0.9072 (0.9327) loss_zs_kd 2.1665 (1.8355) loss_oracle 0.5327 (0.4829) acc 62.5000 (66.9583) kd_loss 0.5696 (0.6214) lr 1.7290e-03 eta 0:28:35
epoch [14/50] batch [320/445] time 0.123 (0.105) data 0.000 (0.006) loss 1.6399 (1.7929) ce_loss 0.8418 (0.9327) loss_zs_kd 2.0777 (1.8441) loss_oracle 0.4676 (0.4822) acc 65.6250 (66.9238) kd_loss 0.5643 (0.6191) lr 1.7290e-03 eta 0:28:12
epoch [14/50] batch [340/445] time 0.152 (0.105) data 0.000 (0.006) loss 1.7633 (1.7906) ce_loss 0.9126 (0.9328) loss_zs_kd 1.8843 (1.8443) loss_oracle 0.4716 (0.4814) acc 71.8750 (67.0129) kd_loss 0.6149 (0.6171) lr 1.7290e-03 eta 0:28:11
epoch [14/50] batch [360/445] time 0.076 (0.105) data 0.000 (0.005) loss 1.8494 (1.7888) ce_loss 1.0879 (0.9327) loss_zs_kd 1.3388 (1.8468) loss_oracle 0.3887 (0.4811) acc 68.7500 (67.1094) kd_loss 0.5672 (0.6156) lr 1.7290e-03 eta 0:28:11
epoch [14/50] batch [380/445] time 0.081 (0.105) data 0.000 (0.005) loss 1.4882 (1.7864) ce_loss 0.6938 (0.9312) loss_zs_kd 1.5352 (1.8434) loss_oracle 0.4712 (0.4811) acc 81.2500 (67.1053) kd_loss 0.5588 (0.6147) lr 1.7290e-03 eta 0:28:12
epoch [14/50] batch [400/445] time 0.081 (0.104) data 0.000 (0.005) loss 1.7949 (1.7862) ce_loss 0.9600 (0.9323) loss_zs_kd 1.6370 (1.8382) loss_oracle 0.4514 (0.4818) acc 65.6250 (67.0469) kd_loss 0.6093 (0.6131) lr 1.7290e-03 eta 0:27:54
epoch [14/50] batch [420/445] time 0.085 (0.103) data 0.000 (0.005) loss 1.6556 (1.7862) ce_loss 0.9111 (0.9339) loss_zs_kd 1.6722 (1.8338) loss_oracle 0.4717 (0.4818) acc 59.3750 (66.9568) kd_loss 0.5086 (0.6114) lr 1.7290e-03 eta 0:27:38
epoch [14/50] batch [440/445] time 0.171 (0.103) data 0.000 (0.004) loss 1.7325 (1.7863) ce_loss 0.8730 (0.9355) loss_zs_kd 1.6607 (1.8334) loss_oracle 0.4760 (0.4822) acc 62.5000 (66.8182) kd_loss 0.6214 (0.6097) lr 1.7290e-03 eta 0:27:30
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,324
* accuracy: 70.8%
* error: 29.2%
* macro_f1: 58.7%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 2,106
* accuracy: 53.0%
* error: 47.0%
* macro_f1: 35.8%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/3/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 3 best val acc:      70.9%, epoch: 13 *******
******* Domain 3 best val test acc: 49.8%, epoch: 13 *******
******* Domain 3 best test acc:     53.0%, epoch: 14 *******
epoch [15/50] batch [20/445] time 0.110 (0.192) data 0.000 (0.094) loss 1.8596 (1.8328) ce_loss 0.9990 (0.9874) loss_zs_kd 1.7936 (1.7719) loss_oracle 0.4025 (0.4762) acc 62.5000 (63.9062) kd_loss 0.6593 (0.6073) lr 1.6845e-03 eta 0:51:07
epoch [15/50] batch [40/445] time 0.102 (0.148) data 0.000 (0.047) loss 1.6997 (1.7981) ce_loss 0.8647 (0.9516) loss_zs_kd 1.4588 (1.7542) loss_oracle 0.4607 (0.4731) acc 71.8750 (65.0781) kd_loss 0.6046 (0.6100) lr 1.6845e-03 eta 0:39:26
epoch [15/50] batch [60/445] time 0.102 (0.133) data 0.000 (0.032) loss 1.6146 (1.7924) ce_loss 0.8999 (0.9490) loss_zs_kd 1.4833 (1.7875) loss_oracle 0.3650 (0.4766) acc 65.6250 (65.3646) kd_loss 0.5322 (0.6051) lr 1.6845e-03 eta 0:35:23
epoch [15/50] batch [80/445] time 0.097 (0.124) data 0.000 (0.024) loss 2.2163 (1.7828) ce_loss 1.3330 (0.9364) loss_zs_kd 2.1549 (1.8083) loss_oracle 0.5295 (0.4754) acc 50.0000 (65.6250) kd_loss 0.6185 (0.6087) lr 1.6845e-03 eta 0:32:51
epoch [15/50] batch [100/445] time 0.101 (0.120) data 0.000 (0.019) loss 1.6490 (1.7848) ce_loss 0.8740 (0.9311) loss_zs_kd 1.8621 (1.8576) loss_oracle 0.4462 (0.4851) acc 68.7500 (65.9688) kd_loss 0.5519 (0.6112) lr 1.6845e-03 eta 0:31:45
epoch [15/50] batch [120/445] time 0.091 (0.116) data 0.000 (0.016) loss 1.6093 (1.7830) ce_loss 0.8833 (0.9303) loss_zs_kd 1.7508 (1.8784) loss_oracle 0.4509 (0.4872) acc 59.3750 (66.0677) kd_loss 0.5005 (0.6091) lr 1.6845e-03 eta 0:30:39
epoch [15/50] batch [140/445] time 0.100 (0.113) data 0.000 (0.014) loss 1.6032 (1.7792) ce_loss 0.8032 (0.9292) loss_zs_kd 1.9471 (1.8545) loss_oracle 0.4515 (0.4893) acc 65.6250 (66.1384) kd_loss 0.5742 (0.6053) lr 1.6845e-03 eta 0:30:00
epoch [15/50] batch [160/445] time 0.105 (0.112) data 0.000 (0.012) loss 1.5085 (1.7694) ce_loss 0.7383 (0.9239) loss_zs_kd 2.2705 (1.8614) loss_oracle 0.4926 (0.4881) acc 75.0000 (66.4453) kd_loss 0.5239 (0.6015) lr 1.6845e-03 eta 0:29:36
epoch [15/50] batch [180/445] time 0.113 (0.111) data 0.000 (0.011) loss 1.7799 (1.7684) ce_loss 0.9082 (0.9228) loss_zs_kd 2.1578 (1.8666) loss_oracle 0.5075 (0.4887) acc 78.1250 (66.6319) kd_loss 0.6180 (0.6014) lr 1.6845e-03 eta 0:29:21
epoch [15/50] batch [200/445] time 0.104 (0.110) data 0.000 (0.010) loss 1.5864 (1.7722) ce_loss 0.7349 (0.9263) loss_zs_kd 1.7178 (1.8711) loss_oracle 0.5174 (0.4887) acc 81.2500 (66.6406) kd_loss 0.5928 (0.6015) lr 1.6845e-03 eta 0:29:08
epoch [15/50] batch [220/445] time 0.108 (0.110) data 0.000 (0.009) loss 1.8757 (1.7727) ce_loss 1.0078 (0.9271) loss_zs_kd 2.0687 (1.8587) loss_oracle 0.4981 (0.4876) acc 62.5000 (66.6761) kd_loss 0.6188 (0.6018) lr 1.6845e-03 eta 0:28:55
epoch [15/50] batch [240/445] time 0.102 (0.109) data 0.000 (0.008) loss 2.1296 (1.7700) ce_loss 1.1699 (0.9256) loss_zs_kd 1.7416 (1.8457) loss_oracle 0.5699 (0.4867) acc 50.0000 (66.5755) kd_loss 0.6747 (0.6010) lr 1.6845e-03 eta 0:28:47
epoch [15/50] batch [260/445] time 0.085 (0.108) data 0.000 (0.007) loss 1.8251 (1.7660) ce_loss 1.1084 (0.9232) loss_zs_kd 1.9149 (1.8423) loss_oracle 0.4298 (0.4841) acc 59.3750 (66.6587) kd_loss 0.5018 (0.6007) lr 1.6845e-03 eta 0:28:24
epoch [15/50] batch [280/445] time 0.077 (0.106) data 0.000 (0.007) loss 1.7833 (1.7694) ce_loss 1.0000 (0.9281) loss_zs_kd 1.6375 (1.8340) loss_oracle 0.4219 (0.4832) acc 56.2500 (66.4621) kd_loss 0.5723 (0.5997) lr 1.6845e-03 eta 0:27:56
epoch [15/50] batch [300/445] time 0.089 (0.105) data 0.000 (0.007) loss 1.7171 (1.7679) ce_loss 0.9780 (0.9265) loss_zs_kd 1.8278 (1.8289) loss_oracle 0.4477 (0.4835) acc 68.7500 (66.5208) kd_loss 0.5153 (0.5997) lr 1.6845e-03 eta 0:27:29
epoch [15/50] batch [320/445] time 0.086 (0.105) data 0.000 (0.006) loss 1.8709 (1.7658) ce_loss 0.9512 (0.9252) loss_zs_kd 1.7545 (1.8302) loss_oracle 0.5072 (0.4838) acc 62.5000 (66.6211) kd_loss 0.6661 (0.5987) lr 1.6845e-03 eta 0:27:24
epoch [15/50] batch [340/445] time 0.079 (0.106) data 0.000 (0.006) loss 1.9132 (1.7661) ce_loss 0.9966 (0.9276) loss_zs_kd 1.6585 (1.8279) loss_oracle 0.5279 (0.4836) acc 71.8750 (66.6085) kd_loss 0.6526 (0.5967) lr 1.6845e-03 eta 0:27:35
epoch [15/50] batch [360/445] time 0.079 (0.106) data 0.000 (0.005) loss 1.5523 (1.7654) ce_loss 0.6729 (0.9266) loss_zs_kd 1.6284 (1.8358) loss_oracle 0.5290 (0.4847) acc 87.5000 (66.6580) kd_loss 0.6149 (0.5964) lr 1.6845e-03 eta 0:27:36
epoch [15/50] batch [380/445] time 0.080 (0.105) data 0.000 (0.005) loss 1.7953 (1.7645) ce_loss 0.8506 (0.9265) loss_zs_kd 2.0283 (1.8394) loss_oracle 0.5390 (0.4846) acc 65.6250 (66.7352) kd_loss 0.6753 (0.5957) lr 1.6845e-03 eta 0:27:25
epoch [15/50] batch [400/445] time 0.079 (0.104) data 0.000 (0.005) loss 1.6455 (1.7604) ce_loss 0.8613 (0.9233) loss_zs_kd 1.9419 (1.8413) loss_oracle 0.4664 (0.4846) acc 68.7500 (66.7891) kd_loss 0.5509 (0.5948) lr 1.6845e-03 eta 0:27:09
epoch [15/50] batch [420/445] time 0.079 (0.103) data 0.000 (0.005) loss 1.3945 (1.7616) ce_loss 0.6265 (0.9244) loss_zs_kd 1.7808 (1.8418) loss_oracle 0.4579 (0.4855) acc 81.2500 (66.8155) kd_loss 0.5391 (0.5945) lr 1.6845e-03 eta 0:26:50
epoch [15/50] batch [440/445] time 0.075 (0.104) data 0.000 (0.005) loss 1.4383 (1.7639) ce_loss 0.6509 (0.9260) loss_zs_kd 1.8903 (1.8484) loss_oracle 0.4343 (0.4869) acc 75.0000 (66.7543) kd_loss 0.5703 (0.5945) lr 1.6845e-03 eta 0:26:57
Evaluate on the *val* set
=> result
* total: 6,108
* correct: 4,307
* accuracy: 70.5%
* error: 29.5%
* macro_f1: 57.0%
Evaluate on the *test* set
=> result
* total: 3,970
* correct: 1,815
* accuracy: 45.7%
* error: 54.3%
* macro_f1: 30.0%
******* Domain 3 best val acc:      70.9%, epoch: 13 *******
******* Domain 3 best val test acc: 49.8%, epoch: 13 *******
******* Domain 3 best test acc:     53.0%, epoch: 14 *******
epoch [16/50] batch [20/445] time 0.106 (0.198) data 0.000 (0.094) loss 1.7000 (1.7643) ce_loss 0.8584 (0.9300) loss_zs_kd 2.3424 (2.1304) loss_oracle 0.4800 (0.4899) acc 62.5000 (68.1250) kd_loss 0.6016 (0.5894) lr 1.6374e-03 eta 0:51:18
epoch [16/50] batch [40/445] time 0.097 (0.151) data 0.000 (0.047) loss 1.4629 (1.7757) ce_loss 0.6270 (0.9360) loss_zs_kd 1.9106 (2.0533) loss_oracle 0.4930 (0.4920) acc 78.1250 (66.7969) kd_loss 0.5895 (0.5936) lr 1.6374e-03 eta 0:39:08
epoch [16/50] batch [60/445] time 0.102 (0.136) data 0.000 (0.031) loss 1.9235 (1.7734) ce_loss 0.9956 (0.9289) loss_zs_kd 2.2901 (2.0345) loss_oracle 0.5497 (0.4939) acc 65.6250 (66.8229) kd_loss 0.6530 (0.5975) lr 1.6374e-03 eta 0:35:07
epoch [16/50] batch [80/445] time 0.104 (0.129) data 0.000 (0.024) loss 1.5595 (1.7743) ce_loss 0.7700 (0.9320) loss_zs_kd 1.8147 (2.0015) loss_oracle 0.4358 (0.4935) acc 78.1250 (66.4844) kd_loss 0.5716 (0.5955) lr 1.6374e-03 eta 0:33:12
epoch [16/50] batch [100/445] time 0.109 (0.124) data 0.000 (0.019) loss 1.9854 (1.7814) ce_loss 1.2031 (0.9436) loss_zs_kd 1.8269 (1.9734) loss_oracle 0.4427 (0.4941) acc 68.7500 (66.0938) kd_loss 0.5610 (0.5907) lr 1.6374e-03 eta 0:32:01
epoch [16/50] batch [120/445] time 0.106 (0.121) data 0.000 (0.016) loss 1.9014 (1.7772) ce_loss 0.9912 (0.9454) loss_zs_kd 1.6459 (1.9333) loss_oracle 0.5101 (0.4882) acc 75.0000 (66.1198) kd_loss 0.6552 (0.5877) lr 1.6374e-03 eta 0:31:10
epoch [16/50] batch [140/445] time 0.106 (0.119) data 0.000 (0.014) loss 1.5272 (1.7768) ce_loss 0.7021 (0.9438) loss_zs_kd 2.1896 (1.9364) loss_oracle 0.5281 (0.4895) acc 78.1250 (66.2723) kd_loss 0.5610 (0.5883) lr 1.6374e-03 eta 0:30:34
epoch [16/50] batch [160/445] time 0.104 (0.117) data 0.000 (0.012) loss 1.6705 (1.7744) ce_loss 0.8354 (0.9393) loss_zs_kd 1.9464 (1.9222) loss_oracle 0.4698 (0.4921) acc 68.7500 (66.2891) kd_loss 0.6002 (0.5891) lr 1.6374e-03 eta 0:30:08
epoch [16/50] batch [180/445] time 0.100 (0.116) data 0.000 (0.011) loss 1.7659 (1.7721) ce_loss 0.9434 (0.9365) loss_zs_kd 2.3514 (1.9177) loss_oracle 0.4411 (0.4902) acc 71.8750 (66.3368) kd_loss 0.6020 (0.5905) lr 1.6374e-03 eta 0:29:44
epoch [16/50] batch [200/445] time 0.102 (0.115) data 0.000 (0.010) loss 1.8332 (1.7674) ce_loss 1.0479 (0.9340) loss_zs_kd 1.8354 (1.9046) loss_oracle 0.4051 (0.4865) acc 62.5000 (66.4688) kd_loss 0.5828 (0.5901) lr 1.6374e-03 eta 0:29:26
epoch [16/50] batch [220/445] time 0.091 (0.114) data 0.000 (0.009) loss 1.8840 (1.7694) ce_loss 0.9722 (0.9313) loss_zs_kd 2.1095 (1.8981) loss_oracle 0.5152 (0.4872) acc 62.5000 (66.6619) kd_loss 0.6542 (0.5946) lr 1.6374e-03 eta 0:29:06
epoch [16/50] batch [240/445] time 0.087 (0.111) data 0.000 (0.008) loss 1.8281 (1.7726) ce_loss 0.9849 (0.9308) loss_zs_kd 1.6590 (1.8862) loss_oracle 0.5081 (0.4874) acc 62.5000 (66.6146) kd_loss 0.5892 (0.5981) lr 1.6374e-03 eta 0:28:22
epoch [16/50] batch [260/445] time 0.078 (0.109) data 0.000 (0.007) loss 1.3037 (1.7686) ce_loss 0.4741 (0.9253) loss_zs_kd 2.3245 (1.8932) loss_oracle 0.4695 (0.4877) acc 87.5000 (66.9111) kd_loss 0.5949 (0.5995) lr 1.6374e-03 eta 0:27:43
epoch [16/50] batch [280/445] time 0.124 (0.107) data 0.000 (0.007) loss 1.7394 (1.7672) ce_loss 0.7793 (0.9215) loss_zs_kd 1.8513 (1.9044) loss_oracle 0.4846 (0.4876) acc 68.7500 (67.0536) kd_loss 0.7178 (0.6018) lr 1.6374e-03 eta 0:27:17
epoch [16/50] batch [300/445] time 0.063 (0.106) data 0.000 (0.007) loss 1.3984 (1.7629) ce_loss 0.6230 (0.9166) loss_zs_kd 1.8778 (1.9147) loss_oracle 0.4246 (0.4866) acc 78.1250 (67.1875) kd_loss 0.5630 (0.6030) lr 1.6374e-03 eta 0:27:01
epoch [16/50] batch [320/445] time 0.193 (0.105) data 0.000 (0.006) loss 1.9173 (1.7618) ce_loss 1.0918 (0.9163) loss_zs_kd 1.5958 (1.9150) loss_oracle 0.5162 (0.4857) acc 65.6250 (67.2852) kd_loss 0.5674 (0.6027) lr 1.6374e-03 eta 0:26:49
epoch [16/50] batch [340/445] time 0.076 (0.105) data 0.000 (0.006) loss 1.8899 (1.7665) ce_loss 1.0117 (0.9190) loss_zs_kd 2.2003 (1.9219) loss_oracle 0.5564 (0.4879) acc 59.3750 (67.1415) kd_loss 0.6000 (0.6036) lr 1.6374e-03 eta 0:26:34
epoch [16/50] batch [360/445] time 0.085 (0.104) data 0.000 (0.005) loss 1.7796 (1.7719) ce_loss 1.0010 (0.9230) loss_zs_kd 1.6854 (1.9147) loss_oracle 0.4840 (0.4897) acc 62.5000 (67.0312) kd_loss 0.5366 (0.6040) lr 1.6374e-03 eta 0:26:23
epoch [16/50] batch [380/445] time 0.077 (0.103) data 0.000 (0.005) loss 1.6962 (1.7766) ce_loss 0.8218 (0.9263) loss_zs_kd 2.0021 (1.9100) loss_oracle 0.5369 (0.4896) acc 71.8750 (66.8750) kd_loss 0.6060 (0.6055) lr 1.6374e-03 eta 0:26:05
epoch [16/50] batch [400/445] time 0.083 (0.102) data 0.000 (0.005) loss 1.8013 (1.7813) ce_loss 0.9292 (0.9301) loss_zs_kd 1.9066 (1.9101) loss_oracle 0.4913 (0.4903) acc 65.6250 (66.8203) kd_loss 0.6264 (0.6060) lr 1.6374e-03 eta 0:25:48
