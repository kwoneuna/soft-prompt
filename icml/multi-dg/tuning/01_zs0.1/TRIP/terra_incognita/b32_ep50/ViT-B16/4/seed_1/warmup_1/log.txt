Loading trainer: TRIP
Loading dataset: SPG_TerraIncognita
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ----------------------------------------------
Dataset    SPG_TerraIncognita
Source     ['location_100', 'location_38', 'location_43']
Target     ['location_46']
# classes  10
# train_x  12,912
# val      5,535
# test     5,883
---------  ----------------------------------------------
Loading CLIP (backbone: ViT-B/16)
Building custom CLIP
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Initial context: "a photo of a"
Number of context words (tokens): 4
Turning off gradients in both the image and the text encoder
=== Trainable Parameters by Module ===
prompt_learner.0.ctx                               2,048
prompt_learner.1.ctx                               2,048
prompt_learner.2.ctx                               2,048
gate.mlp.0.weight                                  65,536
gate.mlp.0.bias                                    128
gate.mlp.2.weight                                  384
gate.mlp.2.bias                                    3
Total trainable params: 72,195
Loading evaluator: Classification
No checkpoint found, train from scratch
Initialize tensorboard (log_dir=icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/tensorboard)
epoch [1/50] batch [20/403] time 0.114 (0.167) data 0.000 (0.040) loss 2.2085 (2.1847) ce_loss 2.2070 (2.1817) loss_zs_kd 0.0003 (0.0001) loss_oracle -0.0000 (-0.0001) acc 34.3750 (32.1875) kd_loss 0.0014 (0.0031) lr 1.0000e-05 eta 0:56:09
epoch [1/50] batch [40/403] time 0.094 (0.134) data 0.000 (0.020) loss 2.4304 (2.2317) ce_loss 2.4297 (2.2298) loss_zs_kd 0.0026 (0.0007) loss_oracle -0.0002 (-0.0001) acc 31.2500 (31.8750) kd_loss 0.0008 (0.0019) lr 1.0000e-05 eta 0:44:45
epoch [1/50] batch [60/403] time 0.104 (0.121) data 0.000 (0.013) loss 2.3229 (2.2084) ce_loss 2.3223 (2.2069) loss_zs_kd 0.0083 (0.0020) loss_oracle -0.0001 (-0.0001) acc 18.7500 (32.7083) kd_loss 0.0007 (0.0016) lr 1.0000e-05 eta 0:40:22
epoch [1/50] batch [80/403] time 0.093 (0.114) data 0.000 (0.010) loss 2.4711 (2.1775) ce_loss 2.4707 (2.1761) loss_zs_kd 0.0176 (0.0043) loss_oracle -0.0000 (-0.0001) acc 31.2500 (33.1641) kd_loss 0.0004 (0.0014) lr 1.0000e-05 eta 0:38:06
epoch [1/50] batch [100/403] time 0.100 (0.112) data 0.000 (0.008) loss 2.4969 (2.1711) ce_loss 2.4961 (2.1700) loss_zs_kd 0.0310 (0.0080) loss_oracle 0.0001 (-0.0001) acc 25.0000 (33.1875) kd_loss 0.0007 (0.0012) lr 1.0000e-05 eta 0:37:24
epoch [1/50] batch [120/403] time 0.115 (0.111) data 0.000 (0.007) loss 2.3316 (2.1530) ce_loss 2.3301 (2.1519) loss_zs_kd 0.0568 (0.0139) loss_oracle 0.0002 (-0.0001) acc 28.1250 (33.5156) kd_loss 0.0014 (0.0012) lr 1.0000e-05 eta 0:37:07
epoch [1/50] batch [140/403] time 0.108 (0.111) data 0.000 (0.006) loss 1.5722 (2.1113) ce_loss 1.5684 (2.1100) loss_zs_kd 0.1076 (0.0253) loss_oracle 0.0035 (0.0001) acc 56.2500 (34.3973) kd_loss 0.0021 (0.0012) lr 1.0000e-05 eta 0:36:54
epoch [1/50] batch [160/403] time 0.106 (0.111) data 0.000 (0.005) loss 2.1518 (2.0704) ce_loss 2.1016 (2.0670) loss_zs_kd 0.4165 (0.0537) loss_oracle 0.0646 (0.0029) acc 34.3750 (35.4492) kd_loss 0.0180 (0.0020) lr 1.0000e-05 eta 0:36:50
epoch [1/50] batch [180/403] time 0.108 (0.110) data 0.000 (0.005) loss 1.6851 (2.0376) ce_loss 1.5967 (2.0292) loss_zs_kd 0.6343 (0.0940) loss_oracle 0.0474 (0.0048) acc 43.7500 (36.3194) kd_loss 0.0647 (0.0060) lr 1.0000e-05 eta 0:36:34
epoch [1/50] batch [200/403] time 0.107 (0.109) data 0.000 (0.004) loss 1.8917 (2.0167) ce_loss 1.7217 (1.9962) loss_zs_kd 0.4368 (0.1291) loss_oracle 0.0149 (0.0075) acc 40.6250 (36.8594) kd_loss 0.1626 (0.0168) lr 1.0000e-05 eta 0:36:22
epoch [1/50] batch [220/403] time 0.098 (0.109) data 0.000 (0.004) loss 1.8465 (1.9990) ce_loss 1.5674 (1.9601) loss_zs_kd 0.5266 (0.1604) loss_oracle 0.0186 (0.0080) acc 43.7500 (37.5142) kd_loss 0.2698 (0.0349) lr 1.0000e-05 eta 0:36:12
epoch [1/50] batch [240/403] time 0.102 (0.109) data 0.000 (0.004) loss 1.8611 (1.9954) ce_loss 1.5039 (1.9339) loss_zs_kd 0.6854 (0.1910) loss_oracle 0.0210 (0.0097) acc 40.6250 (37.9818) kd_loss 0.3467 (0.0567) lr 1.0000e-05 eta 0:36:03
epoch [1/50] batch [260/403] time 0.073 (0.108) data 0.000 (0.003) loss 2.5797 (2.0008) ce_loss 2.0371 (1.9109) loss_zs_kd 0.6785 (0.2160) loss_oracle 0.1175 (0.0123) acc 25.0000 (38.2212) kd_loss 0.4838 (0.0837) lr 1.0000e-05 eta 0:35:41
epoch [1/50] batch [280/403] time 0.078 (0.106) data 0.000 (0.003) loss 2.2242 (2.0197) ce_loss 1.6514 (1.8947) loss_zs_kd 0.6971 (0.2398) loss_oracle 0.1355 (0.0184) acc 50.0000 (38.6384) kd_loss 0.5050 (0.1158) lr 1.0000e-05 eta 0:35:03
epoch [1/50] batch [300/403] time 0.103 (0.105) data 0.000 (0.003) loss 2.7955 (2.0451) ce_loss 1.9648 (1.8771) loss_zs_kd 0.6337 (0.2625) loss_oracle 0.2758 (0.0282) acc 37.5000 (39.1042) kd_loss 0.6928 (0.1539) lr 1.0000e-05 eta 0:34:44
epoch [1/50] batch [320/403] time 0.177 (0.106) data 0.000 (0.003) loss 2.7890 (2.0855) ce_loss 1.7754 (1.8715) loss_zs_kd 0.6436 (0.2797) loss_oracle 0.3845 (0.0397) acc 37.5000 (39.1992) kd_loss 0.8213 (0.1942) lr 1.0000e-05 eta 0:34:56
epoch [1/50] batch [340/403] time 0.091 (0.106) data 0.000 (0.003) loss 2.4144 (2.1176) ce_loss 1.3682 (1.8568) loss_zs_kd 0.5737 (0.2937) loss_oracle 0.1470 (0.0529) acc 50.0000 (39.4669) kd_loss 0.9727 (0.2343) lr 1.0000e-05 eta 0:34:54
epoch [1/50] batch [360/403] time 0.164 (0.106) data 0.000 (0.002) loss 2.4915 (2.1474) ce_loss 1.4385 (1.8496) loss_zs_kd 0.5565 (0.3082) loss_oracle 0.1502 (0.0562) acc 46.8750 (39.6267) kd_loss 0.9779 (0.2697) lr 1.0000e-05 eta 0:35:00
epoch [1/50] batch [380/403] time 0.076 (0.105) data 0.000 (0.002) loss 2.5150 (2.1744) ce_loss 1.5098 (1.8405) loss_zs_kd 0.5649 (0.3218) loss_oracle 0.1773 (0.0618) acc 40.6250 (39.7368) kd_loss 0.9166 (0.3029) lr 1.0000e-05 eta 0:34:40
epoch [1/50] batch [400/403] time 0.085 (0.104) data 0.000 (0.002) loss 3.1861 (2.2000) ce_loss 2.0332 (1.8318) loss_zs_kd 0.6984 (0.3342) loss_oracle 0.3271 (0.0676) acc 28.1250 (39.8672) kd_loss 0.9893 (0.3344) lr 1.0000e-05 eta 0:34:16
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 2,713
* accuracy: 49.0%
* error: 51.0%
* macro_f1: 35.5%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 1,964
* accuracy: 33.4%
* error: 66.6%
* macro_f1: 24.0%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      49.0%, epoch: 1 *******
******* Domain 4 best val test acc: 33.4%, epoch: 1 *******
******* Domain 4 best test acc:     33.4%, epoch: 1 *******
[TensorBoard] Initialized writer in: icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/ana
epoch [2/50] batch [20/403] time 0.103 (0.122) data 0.000 (0.035) loss 2.6006 (2.7438) ce_loss 1.4766 (1.6997) loss_zs_kd 0.8090 (0.5322) loss_oracle 0.5431 (0.2773) acc 53.1250 (43.5938) kd_loss 0.8525 (0.9054) lr 2.0000e-03 eta 0:40:01
epoch [2/50] batch [40/403] time 0.122 (0.120) data 0.000 (0.018) loss 2.0307 (2.5089) ce_loss 1.2979 (1.5276) loss_zs_kd 0.8656 (0.6545) loss_oracle 0.2770 (0.2964) acc 46.8750 (48.2812) kd_loss 0.5944 (0.8331) lr 2.0000e-03 eta 0:39:15
epoch [2/50] batch [60/403] time 0.123 (0.115) data 0.000 (0.012) loss 2.3333 (2.4007) ce_loss 1.2949 (1.4552) loss_zs_kd 0.5875 (0.7066) loss_oracle 0.3977 (0.3367) acc 56.2500 (49.6354) kd_loss 0.8396 (0.7771) lr 2.0000e-03 eta 0:37:48
epoch [2/50] batch [80/403] time 0.129 (0.113) data 0.000 (0.009) loss 2.5840 (2.4206) ce_loss 1.2910 (1.4291) loss_zs_kd 0.7497 (0.7777) loss_oracle 0.5821 (0.3788) acc 43.7500 (50.6641) kd_loss 1.0020 (0.8021) lr 2.0000e-03 eta 0:37:04
epoch [2/50] batch [100/403] time 0.111 (0.112) data 0.000 (0.007) loss 3.2706 (2.4439) ce_loss 1.9814 (1.3935) loss_zs_kd 1.0786 (0.8260) loss_oracle 0.5542 (0.4240) acc 25.0000 (51.5625) kd_loss 1.0120 (0.8384) lr 2.0000e-03 eta 0:36:31
epoch [2/50] batch [120/403] time 0.098 (0.110) data 0.000 (0.006) loss 2.6413 (2.4440) ce_loss 1.3467 (1.3542) loss_zs_kd 1.0087 (0.8605) loss_oracle 0.5287 (0.4432) acc 56.2500 (52.8646) kd_loss 1.0302 (0.8682) lr 2.0000e-03 eta 0:36:04
epoch [2/50] batch [140/403] time 0.111 (0.110) data 0.000 (0.005) loss 2.3821 (2.4455) ce_loss 1.1660 (1.3285) loss_zs_kd 1.0950 (0.9081) loss_oracle 0.5052 (0.4621) acc 56.2500 (53.5045) kd_loss 0.9635 (0.8859) lr 2.0000e-03 eta 0:35:48
epoch [2/50] batch [160/403] time 0.129 (0.109) data 0.000 (0.005) loss 2.1030 (2.4395) ce_loss 0.9141 (1.3064) loss_zs_kd 1.2743 (0.9341) loss_oracle 0.5227 (0.4748) acc 65.6250 (54.2188) kd_loss 0.9276 (0.8957) lr 2.0000e-03 eta 0:35:37
epoch [2/50] batch [180/403] time 0.103 (0.109) data 0.000 (0.004) loss 2.2484 (2.4209) ce_loss 1.0449 (1.2827) loss_zs_kd 1.3187 (0.9779) loss_oracle 0.5293 (0.4744) acc 62.5000 (55.1562) kd_loss 0.9388 (0.9010) lr 2.0000e-03 eta 0:35:24
epoch [2/50] batch [200/403] time 0.104 (0.108) data 0.000 (0.004) loss 2.3878 (2.4113) ce_loss 1.2061 (1.2691) loss_zs_kd 1.7872 (1.0196) loss_oracle 0.4827 (0.4780) acc 59.3750 (55.7031) kd_loss 0.9404 (0.9032) lr 2.0000e-03 eta 0:35:15
epoch [2/50] batch [220/403] time 0.101 (0.108) data 0.000 (0.003) loss 2.2662 (2.3953) ce_loss 1.1328 (1.2539) loss_zs_kd 1.4910 (1.0380) loss_oracle 0.4980 (0.4772) acc 59.3750 (56.1932) kd_loss 0.8843 (0.9029) lr 2.0000e-03 eta 0:35:05
epoch [2/50] batch [240/403] time 0.100 (0.108) data 0.000 (0.003) loss 2.2071 (2.3819) ce_loss 1.0801 (1.2423) loss_zs_kd 1.0710 (1.0513) loss_oracle 0.4515 (0.4761) acc 53.1250 (56.4062) kd_loss 0.9012 (0.9016) lr 2.0000e-03 eta 0:35:00
epoch [2/50] batch [260/403] time 0.101 (0.107) data 0.000 (0.003) loss 2.1765 (2.3714) ce_loss 1.1055 (1.2349) loss_zs_kd 1.2658 (1.0687) loss_oracle 0.4948 (0.4777) acc 62.5000 (56.5865) kd_loss 0.8236 (0.8977) lr 2.0000e-03 eta 0:34:54
epoch [2/50] batch [280/403] time 0.092 (0.107) data 0.000 (0.003) loss 2.0440 (2.3573) ce_loss 0.9380 (1.2267) loss_zs_kd 1.2761 (1.0886) loss_oracle 0.5170 (0.4762) acc 65.6250 (56.7969) kd_loss 0.8475 (0.8925) lr 2.0000e-03 eta 0:34:47
epoch [2/50] batch [300/403] time 0.109 (0.107) data 0.000 (0.003) loss 2.0844 (2.3427) ce_loss 1.0293 (1.2138) loss_zs_kd 1.5920 (1.1216) loss_oracle 0.4857 (0.4842) acc 62.5000 (57.1042) kd_loss 0.8122 (0.8869) lr 2.0000e-03 eta 0:34:45
epoch [2/50] batch [320/403] time 0.094 (0.107) data 0.000 (0.002) loss 2.6024 (2.3311) ce_loss 1.5703 (1.2055) loss_zs_kd 1.6576 (1.1357) loss_oracle 0.6008 (0.4897) acc 43.7500 (57.4316) kd_loss 0.7317 (0.8807) lr 2.0000e-03 eta 0:34:42
epoch [2/50] batch [340/403] time 0.082 (0.106) data 0.000 (0.002) loss 2.2986 (2.3206) ce_loss 1.2754 (1.1980) loss_zs_kd 1.2453 (1.1589) loss_oracle 0.5138 (0.4948) acc 53.1250 (57.6562) kd_loss 0.7663 (0.8752) lr 2.0000e-03 eta 0:34:22
epoch [2/50] batch [360/403] time 0.091 (0.106) data 0.000 (0.002) loss 2.0298 (2.3147) ce_loss 0.9990 (1.1958) loss_zs_kd 1.1069 (1.1790) loss_oracle 0.4241 (0.4969) acc 68.7500 (57.6128) kd_loss 0.8188 (0.8705) lr 2.0000e-03 eta 0:34:06
epoch [2/50] batch [380/403] time 0.078 (0.105) data 0.000 (0.002) loss 1.9938 (2.3022) ce_loss 0.9199 (1.1881) loss_zs_kd 1.6044 (1.1968) loss_oracle 0.6008 (0.4980) acc 65.6250 (57.8865) kd_loss 0.7734 (0.8651) lr 2.0000e-03 eta 0:33:54
epoch [2/50] batch [400/403] time 0.175 (0.106) data 0.000 (0.002) loss 2.2589 (2.2911) ce_loss 1.2246 (1.1813) loss_zs_kd 1.3763 (1.2127) loss_oracle 0.5734 (0.5002) acc 62.5000 (58.1953) kd_loss 0.7476 (0.8597) lr 2.0000e-03 eta 0:34:07
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,532
* accuracy: 63.8%
* error: 36.2%
* macro_f1: 48.5%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,112
* accuracy: 35.9%
* error: 64.1%
* macro_f1: 25.6%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      63.8%, epoch: 2 *******
******* Domain 4 best val test acc: 35.9%, epoch: 2 *******
******* Domain 4 best test acc:     35.9%, epoch: 2 *******
epoch [3/50] batch [20/403] time 0.089 (0.138) data 0.000 (0.036) loss 2.2112 (2.0729) ce_loss 1.1270 (1.0217) loss_zs_kd 1.7984 (1.6567) loss_oracle 0.6824 (0.6046) acc 59.3750 (63.2812) kd_loss 0.7431 (0.7489) lr 1.9980e-03 eta 0:44:27
epoch [3/50] batch [40/403] time 0.089 (0.111) data 0.000 (0.018) loss 2.1920 (2.0824) ce_loss 1.1553 (1.0437) loss_zs_kd 1.7128 (1.5951) loss_oracle 0.6403 (0.6008) acc 62.5000 (62.0312) kd_loss 0.7166 (0.7382) lr 1.9980e-03 eta 0:35:36
epoch [3/50] batch [60/403] time 0.088 (0.101) data 0.001 (0.012) loss 1.7500 (2.0521) ce_loss 0.7397 (1.0182) loss_zs_kd 1.1472 (1.6189) loss_oracle 0.5740 (0.6010) acc 68.7500 (62.5000) kd_loss 0.7233 (0.7334) lr 1.9980e-03 eta 0:32:26
epoch [3/50] batch [80/403] time 0.096 (0.100) data 0.000 (0.009) loss 2.2966 (2.0524) ce_loss 1.2188 (1.0095) loss_zs_kd 1.2681 (1.6078) loss_oracle 0.7861 (0.6339) acc 59.3750 (62.8906) kd_loss 0.6847 (0.7259) lr 1.9980e-03 eta 0:32:14
epoch [3/50] batch [100/403] time 0.104 (0.100) data 0.000 (0.007) loss 1.8238 (2.0572) ce_loss 0.8149 (1.0175) loss_zs_kd 1.2510 (1.6264) loss_oracle 0.6777 (0.6452) acc 78.1250 (63.1562) kd_loss 0.6700 (0.7171) lr 1.9980e-03 eta 0:32:11
epoch [3/50] batch [120/403] time 0.121 (0.101) data 0.000 (0.006) loss 1.9216 (2.0626) ce_loss 0.8535 (1.0242) loss_zs_kd 1.7350 (1.6406) loss_oracle 0.7357 (0.6556) acc 65.6250 (63.1250) kd_loss 0.7003 (0.7106) lr 1.9980e-03 eta 0:32:26
epoch [3/50] batch [140/403] time 0.097 (0.102) data 0.000 (0.005) loss 1.7531 (2.0564) ce_loss 0.6665 (1.0203) loss_zs_kd 1.7592 (1.6625) loss_oracle 0.7913 (0.6619) acc 71.8750 (63.2143) kd_loss 0.6909 (0.7051) lr 1.9980e-03 eta 0:32:31
epoch [3/50] batch [160/403] time 0.096 (0.102) data 0.000 (0.005) loss 2.0845 (2.0541) ce_loss 1.1250 (1.0241) loss_zs_kd 1.6944 (1.6557) loss_oracle 0.5511 (0.6569) acc 62.5000 (63.2031) kd_loss 0.6839 (0.7016) lr 1.9980e-03 eta 0:32:35
epoch [3/50] batch [180/403] time 0.103 (0.102) data 0.000 (0.004) loss 2.1259 (2.0423) ce_loss 1.1172 (1.0182) loss_zs_kd 1.9379 (1.6710) loss_oracle 0.7151 (0.6530) acc 62.5000 (63.2986) kd_loss 0.6511 (0.6976) lr 1.9980e-03 eta 0:32:36
epoch [3/50] batch [200/403] time 0.112 (0.102) data 0.000 (0.004) loss 2.2632 (2.0482) ce_loss 1.2900 (1.0265) loss_zs_kd 1.7789 (1.6790) loss_oracle 0.6088 (0.6558) acc 65.6250 (63.2812) kd_loss 0.6688 (0.6938) lr 1.9980e-03 eta 0:32:38
epoch [3/50] batch [220/403] time 0.108 (0.102) data 0.000 (0.004) loss 1.9062 (2.0558) ce_loss 0.8516 (1.0337) loss_zs_kd 1.7055 (1.6780) loss_oracle 0.7698 (0.6639) acc 65.6250 (62.8551) kd_loss 0.6697 (0.6901) lr 1.9980e-03 eta 0:32:39
epoch [3/50] batch [240/403] time 0.106 (0.103) data 0.000 (0.003) loss 2.1370 (2.0586) ce_loss 1.1191 (1.0363) loss_zs_kd 1.8841 (1.6835) loss_oracle 0.7716 (0.6709) acc 59.3750 (62.8516) kd_loss 0.6320 (0.6869) lr 1.9980e-03 eta 0:32:42
epoch [3/50] batch [260/403] time 0.109 (0.103) data 0.000 (0.003) loss 2.2657 (2.0546) ce_loss 1.2705 (1.0350) loss_zs_kd 1.5385 (1.6775) loss_oracle 0.6945 (0.6708) acc 53.1250 (62.7404) kd_loss 0.6480 (0.6843) lr 1.9980e-03 eta 0:32:43
epoch [3/50] batch [280/403] time 0.114 (0.103) data 0.000 (0.003) loss 1.6446 (2.0425) ce_loss 0.5898 (1.0255) loss_zs_kd 1.8122 (1.6818) loss_oracle 0.7966 (0.6706) acc 81.2500 (63.0134) kd_loss 0.6565 (0.6817) lr 1.9980e-03 eta 0:32:44
epoch [3/50] batch [300/403] time 0.117 (0.103) data 0.000 (0.003) loss 2.1801 (2.0431) ce_loss 1.0859 (1.0229) loss_zs_kd 1.8296 (1.6922) loss_oracle 0.8792 (0.6824) acc 68.7500 (63.0104) kd_loss 0.6545 (0.6790) lr 1.9980e-03 eta 0:32:44
epoch [3/50] batch [320/403] time 0.100 (0.103) data 0.000 (0.003) loss 1.7797 (2.0473) ce_loss 0.8140 (1.0262) loss_zs_kd 1.2519 (1.6945) loss_oracle 0.6434 (0.6894) acc 71.8750 (62.9102) kd_loss 0.6440 (0.6764) lr 1.9980e-03 eta 0:32:43
epoch [3/50] batch [340/403] time 0.103 (0.103) data 0.000 (0.002) loss 2.0846 (2.0449) ce_loss 1.0166 (1.0246) loss_zs_kd 2.0403 (1.7079) loss_oracle 0.8653 (0.6925) acc 65.6250 (62.9688) kd_loss 0.6353 (0.6740) lr 1.9980e-03 eta 0:32:42
epoch [3/50] batch [360/403] time 0.113 (0.103) data 0.001 (0.002) loss 2.0021 (2.0414) ce_loss 0.9932 (1.0211) loss_zs_kd 2.0577 (1.7150) loss_oracle 0.7687 (0.6974) acc 65.6250 (63.2378) kd_loss 0.6246 (0.6716) lr 1.9980e-03 eta 0:32:42
epoch [3/50] batch [380/403] time 0.087 (0.103) data 0.000 (0.002) loss 1.9494 (2.0354) ce_loss 1.0186 (1.0176) loss_zs_kd 1.8706 (1.7211) loss_oracle 0.5762 (0.6960) acc 59.3750 (63.4211) kd_loss 0.6427 (0.6698) lr 1.9980e-03 eta 0:32:35
epoch [3/50] batch [400/403] time 0.073 (0.102) data 0.000 (0.002) loss 2.2862 (2.0325) ce_loss 1.2256 (1.0160) loss_zs_kd 2.1639 (1.7291) loss_oracle 0.9102 (0.6976) acc 56.2500 (63.5781) kd_loss 0.6055 (0.6677) lr 1.9980e-03 eta 0:32:06
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,751
* accuracy: 67.8%
* error: 32.2%
* macro_f1: 52.6%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,084
* accuracy: 35.4%
* error: 64.6%
* macro_f1: 25.8%
******* Domain 4 best val acc:      67.8%, epoch: 3 *******
******* Domain 4 best val test acc: 35.4%, epoch: 3 *******
******* Domain 4 best test acc:     35.9%, epoch: 2 *******
epoch [4/50] batch [20/403] time 0.099 (0.172) data 0.000 (0.049) loss 1.9610 (1.9918) ce_loss 0.9287 (0.9657) loss_zs_kd 1.4490 (1.8512) loss_oracle 0.7857 (0.8050) acc 68.7500 (64.5312) kd_loss 0.6394 (0.6235) lr 1.9921e-03 eta 0:54:19
epoch [4/50] batch [40/403] time 0.180 (0.143) data 0.000 (0.025) loss 2.0302 (1.9973) ce_loss 1.0439 (0.9758) loss_zs_kd 1.8876 (1.8481) loss_oracle 0.7345 (0.7961) acc 62.5000 (65.0781) kd_loss 0.6190 (0.6234) lr 1.9921e-03 eta 0:45:02
epoch [4/50] batch [60/403] time 0.193 (0.129) data 0.000 (0.017) loss 2.1069 (2.0179) ce_loss 1.0283 (0.9922) loss_zs_kd 1.8700 (1.8685) loss_oracle 0.9549 (0.8049) acc 65.6250 (64.8958) kd_loss 0.6012 (0.6233) lr 1.9921e-03 eta 0:40:27
epoch [4/50] batch [80/403] time 0.089 (0.119) data 0.000 (0.013) loss 1.7721 (2.0149) ce_loss 0.7651 (0.9866) loss_zs_kd 2.1830 (1.8662) loss_oracle 0.7525 (0.8139) acc 78.1250 (65.0391) kd_loss 0.6307 (0.6214) lr 1.9921e-03 eta 0:37:24
epoch [4/50] batch [100/403] time 0.091 (0.113) data 0.000 (0.010) loss 2.2855 (2.0292) ce_loss 1.3359 (1.0069) loss_zs_kd 1.7968 (1.8393) loss_oracle 0.7486 (0.8033) acc 43.7500 (64.0625) kd_loss 0.5753 (0.6207) lr 1.9921e-03 eta 0:35:23
epoch [4/50] batch [120/403] time 0.104 (0.109) data 0.000 (0.008) loss 2.2199 (2.0171) ce_loss 1.1494 (0.9975) loss_zs_kd 1.9634 (1.8468) loss_oracle 0.8953 (0.8042) acc 68.7500 (64.4792) kd_loss 0.6229 (0.6175) lr 1.9921e-03 eta 0:34:04
epoch [4/50] batch [140/403] time 0.108 (0.107) data 0.000 (0.007) loss 1.9697 (2.0158) ce_loss 0.9463 (0.9946) loss_zs_kd 1.8260 (1.8719) loss_oracle 0.8709 (0.8128) acc 71.8750 (64.7545) kd_loss 0.5879 (0.6148) lr 1.9921e-03 eta 0:33:36
epoch [4/50] batch [160/403] time 0.106 (0.107) data 0.000 (0.006) loss 2.1190 (2.0163) ce_loss 1.1963 (0.9969) loss_zs_kd 1.4380 (1.8559) loss_oracle 0.6522 (0.8104) acc 59.3750 (64.7070) kd_loss 0.5966 (0.6142) lr 1.9921e-03 eta 0:33:25
epoch [4/50] batch [180/403] time 0.102 (0.106) data 0.000 (0.006) loss 1.8102 (2.0136) ce_loss 0.8276 (1.0003) loss_zs_kd 2.0273 (1.8703) loss_oracle 0.7442 (0.8008) acc 71.8750 (64.4444) kd_loss 0.6105 (0.6129) lr 1.9921e-03 eta 0:33:13
epoch [4/50] batch [200/403] time 0.097 (0.105) data 0.000 (0.005) loss 2.0074 (2.0120) ce_loss 1.0234 (1.0003) loss_zs_kd 1.6102 (1.8665) loss_oracle 0.7435 (0.7981) acc 56.2500 (64.4688) kd_loss 0.6123 (0.6126) lr 1.9921e-03 eta 0:32:53
epoch [4/50] batch [220/403] time 0.089 (0.105) data 0.000 (0.005) loss 1.7543 (2.0019) ce_loss 0.7300 (0.9915) loss_zs_kd 2.1336 (1.8716) loss_oracle 0.8284 (0.7952) acc 75.0000 (64.6733) kd_loss 0.6102 (0.6128) lr 1.9921e-03 eta 0:32:39
epoch [4/50] batch [240/403] time 0.094 (0.104) data 0.000 (0.004) loss 2.0204 (2.0030) ce_loss 1.0098 (0.9937) loss_zs_kd 1.9322 (1.8635) loss_oracle 0.8103 (0.7933) acc 62.5000 (64.4792) kd_loss 0.6055 (0.6127) lr 1.9921e-03 eta 0:32:28
epoch [4/50] batch [260/403] time 0.085 (0.103) data 0.000 (0.004) loss 1.8702 (2.0022) ce_loss 0.7690 (0.9882) loss_zs_kd 2.4099 (1.8743) loss_oracle 0.9557 (0.8022) acc 71.8750 (64.7115) kd_loss 0.6233 (0.6129) lr 1.9921e-03 eta 0:32:05
epoch [4/50] batch [280/403] time 0.093 (0.102) data 0.000 (0.004) loss 2.2225 (1.9974) ce_loss 1.2646 (0.9815) loss_zs_kd 2.2394 (1.8797) loss_oracle 0.7051 (0.8052) acc 56.2500 (65.0335) kd_loss 0.6053 (0.6133) lr 1.9921e-03 eta 0:31:43
epoch [4/50] batch [300/403] time 0.107 (0.102) data 0.000 (0.004) loss 2.1676 (1.9958) ce_loss 1.2354 (0.9806) loss_zs_kd 1.7023 (1.8836) loss_oracle 0.6665 (0.8036) acc 50.0000 (65.0208) kd_loss 0.5990 (0.6133) lr 1.9921e-03 eta 0:31:36
epoch [4/50] batch [320/403] time 0.089 (0.101) data 0.000 (0.003) loss 1.8668 (1.9962) ce_loss 0.8433 (0.9828) loss_zs_kd 1.6159 (1.8841) loss_oracle 0.7668 (0.8005) acc 75.0000 (65.0293) kd_loss 0.6401 (0.6131) lr 1.9921e-03 eta 0:31:28
epoch [4/50] batch [340/403] time 0.086 (0.101) data 0.000 (0.003) loss 2.2155 (1.9970) ce_loss 1.2061 (0.9834) loss_zs_kd 2.0519 (1.8890) loss_oracle 0.8254 (0.8017) acc 62.5000 (64.9449) kd_loss 0.5967 (0.6128) lr 1.9921e-03 eta 0:31:21
epoch [4/50] batch [360/403] time 0.091 (0.100) data 0.000 (0.003) loss 2.1420 (1.9898) ce_loss 1.1602 (0.9782) loss_zs_kd 2.1330 (1.8927) loss_oracle 0.7205 (0.7986) acc 65.6250 (65.1128) kd_loss 0.6216 (0.6122) lr 1.9921e-03 eta 0:31:07
epoch [4/50] batch [380/403] time 0.085 (0.100) data 0.000 (0.003) loss 2.1338 (1.9927) ce_loss 1.1055 (0.9812) loss_zs_kd 2.4346 (1.9000) loss_oracle 0.8746 (0.7991) acc 56.2500 (65.0000) kd_loss 0.5911 (0.6119) lr 1.9921e-03 eta 0:30:56
epoch [4/50] batch [400/403] time 0.094 (0.100) data 0.000 (0.003) loss 2.5895 (1.9934) ce_loss 1.5342 (0.9801) loss_zs_kd 1.5764 (1.8966) loss_oracle 0.8878 (0.8044) acc 50.0000 (65.0859) kd_loss 0.6115 (0.6111) lr 1.9921e-03 eta 0:30:50
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,816
* accuracy: 68.9%
* error: 31.1%
* macro_f1: 53.7%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,364
* accuracy: 40.2%
* error: 59.8%
* macro_f1: 31.0%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best-test.pth.tar
******* Domain 4 best val acc:      68.9%, epoch: 4 *******
******* Domain 4 best val test acc: 40.2%, epoch: 4 *******
******* Domain 4 best test acc:     40.2%, epoch: 4 *******
epoch [5/50] batch [20/403] time 0.141 (0.154) data 0.000 (0.050) loss 2.1380 (2.0689) ce_loss 1.1084 (1.0002) loss_zs_kd 2.2256 (1.9119) loss_oracle 0.8465 (0.9298) acc 59.3750 (64.3750) kd_loss 0.6064 (0.6039) lr 1.9823e-03 eta 0:47:34
epoch [5/50] batch [40/403] time 0.146 (0.129) data 0.000 (0.025) loss 2.2582 (2.0578) ce_loss 1.1709 (0.9753) loss_zs_kd 2.2265 (1.9987) loss_oracle 0.9943 (0.9520) acc 62.5000 (65.1562) kd_loss 0.5901 (0.6065) lr 1.9823e-03 eta 0:39:48
epoch [5/50] batch [60/403] time 0.073 (0.121) data 0.000 (0.017) loss 1.9376 (2.0287) ce_loss 0.9702 (0.9547) loss_zs_kd 1.9021 (2.0056) loss_oracle 0.7470 (0.9294) acc 62.5000 (65.6250) kd_loss 0.5939 (0.6093) lr 1.9823e-03 eta 0:37:09
epoch [5/50] batch [80/403] time 0.068 (0.118) data 0.000 (0.013) loss 1.9963 (2.0137) ce_loss 0.9536 (0.9534) loss_zs_kd 2.4346 (2.0001) loss_oracle 0.8750 (0.9005) acc 75.0000 (66.2109) kd_loss 0.6052 (0.6101) lr 1.9823e-03 eta 0:36:11
epoch [5/50] batch [100/403] time 0.097 (0.111) data 0.000 (0.010) loss 1.7393 (2.0016) ce_loss 0.7505 (0.9522) loss_zs_kd 2.2199 (2.0321) loss_oracle 0.8125 (0.8780) acc 68.7500 (65.4375) kd_loss 0.5825 (0.6104) lr 1.9823e-03 eta 0:34:12
epoch [5/50] batch [120/403] time 0.088 (0.107) data 0.000 (0.009) loss 2.1256 (2.0008) ce_loss 1.1689 (0.9533) loss_zs_kd 1.7304 (2.0355) loss_oracle 0.7387 (0.8749) acc 59.3750 (65.6250) kd_loss 0.5873 (0.6100) lr 1.9823e-03 eta 0:32:41
epoch [5/50] batch [140/403] time 0.099 (0.104) data 0.000 (0.007) loss 2.0979 (2.0035) ce_loss 1.0752 (0.9582) loss_zs_kd 2.1771 (2.0187) loss_oracle 0.8939 (0.8708) acc 59.3750 (65.5357) kd_loss 0.5757 (0.6099) lr 1.9823e-03 eta 0:31:56
epoch [5/50] batch [160/403] time 0.096 (0.104) data 0.000 (0.007) loss 2.3877 (2.0088) ce_loss 1.3438 (0.9637) loss_zs_kd 2.0375 (2.0250) loss_oracle 0.8069 (0.8638) acc 50.0000 (65.3711) kd_loss 0.6404 (0.6133) lr 1.9823e-03 eta 0:31:56
epoch [5/50] batch [180/403] time 0.102 (0.104) data 0.000 (0.006) loss 1.6399 (2.0027) ce_loss 0.5962 (0.9577) loss_zs_kd 1.7670 (2.0165) loss_oracle 0.7556 (0.8531) acc 81.2500 (65.5556) kd_loss 0.6659 (0.6185) lr 1.9823e-03 eta 0:31:54
epoch [5/50] batch [200/403] time 0.101 (0.104) data 0.000 (0.005) loss 1.9405 (2.0030) ce_loss 0.9419 (0.9580) loss_zs_kd 1.6961 (2.0074) loss_oracle 0.7557 (0.8451) acc 75.0000 (65.2656) kd_loss 0.6208 (0.6224) lr 1.9823e-03 eta 0:31:53
epoch [5/50] batch [220/403] time 0.100 (0.104) data 0.000 (0.005) loss 1.9799 (2.0010) ce_loss 0.9243 (0.9554) loss_zs_kd 1.9840 (2.0246) loss_oracle 0.7671 (0.8398) acc 62.5000 (65.5398) kd_loss 0.6720 (0.6257) lr 1.9823e-03 eta 0:31:52
epoch [5/50] batch [240/403] time 0.114 (0.105) data 0.000 (0.004) loss 1.8583 (2.0014) ce_loss 0.8018 (0.9579) loss_zs_kd 1.9794 (2.0252) loss_oracle 0.7493 (0.8326) acc 71.8750 (65.3385) kd_loss 0.6819 (0.6271) lr 1.9823e-03 eta 0:31:59
epoch [5/50] batch [260/403] time 0.099 (0.105) data 0.000 (0.004) loss 1.8947 (1.9985) ce_loss 0.8647 (0.9575) loss_zs_kd 1.8888 (2.0145) loss_oracle 0.7712 (0.8283) acc 65.6250 (65.5048) kd_loss 0.6443 (0.6268) lr 1.9823e-03 eta 0:31:58
epoch [5/50] batch [280/403] time 0.100 (0.104) data 0.000 (0.004) loss 1.7889 (2.0012) ce_loss 0.7500 (0.9590) loss_zs_kd 2.2880 (2.0184) loss_oracle 0.9029 (0.8312) acc 78.1250 (65.5357) kd_loss 0.5874 (0.6266) lr 1.9823e-03 eta 0:31:43
epoch [5/50] batch [300/403] time 0.108 (0.104) data 0.000 (0.004) loss 1.8910 (1.9989) ce_loss 0.8857 (0.9582) loss_zs_kd 2.2097 (2.0096) loss_oracle 0.7397 (0.8282) acc 65.6250 (65.5625) kd_loss 0.6354 (0.6266) lr 1.9823e-03 eta 0:31:31
epoch [5/50] batch [320/403] time 0.103 (0.104) data 0.000 (0.003) loss 2.0882 (1.9967) ce_loss 1.1650 (0.9569) loss_zs_kd 2.2155 (2.0193) loss_oracle 0.6595 (0.8264) acc 56.2500 (65.7422) kd_loss 0.5934 (0.6266) lr 1.9823e-03 eta 0:31:30
epoch [5/50] batch [340/403] time 0.111 (0.104) data 0.000 (0.003) loss 1.6728 (1.9951) ce_loss 0.7002 (0.9577) loss_zs_kd 1.8268 (2.0267) loss_oracle 0.7181 (0.8223) acc 84.3750 (65.7996) kd_loss 0.6136 (0.6262) lr 1.9823e-03 eta 0:31:29
epoch [5/50] batch [360/403] time 0.091 (0.104) data 0.000 (0.003) loss 2.2580 (1.9906) ce_loss 1.1895 (0.9537) loss_zs_kd 1.7040 (2.0206) loss_oracle 0.8512 (0.8219) acc 59.3750 (65.9375) kd_loss 0.6429 (0.6259) lr 1.9823e-03 eta 0:31:26
epoch [5/50] batch [380/403] time 0.098 (0.104) data 0.000 (0.003) loss 1.8899 (1.9889) ce_loss 0.8867 (0.9538) loss_zs_kd 2.2219 (2.0232) loss_oracle 0.7919 (0.8190) acc 71.8750 (65.8553) kd_loss 0.6072 (0.6255) lr 1.9823e-03 eta 0:31:24
epoch [5/50] batch [400/403] time 0.097 (0.104) data 0.000 (0.003) loss 2.2522 (1.9914) ce_loss 1.1289 (0.9564) loss_zs_kd 2.0821 (2.0243) loss_oracle 0.9490 (0.8198) acc 53.1250 (65.7031) kd_loss 0.6487 (0.6251) lr 1.9823e-03 eta 0:31:19
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,841
* accuracy: 69.4%
* error: 30.6%
* macro_f1: 53.3%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,308
* accuracy: 39.2%
* error: 60.8%
* macro_f1: 28.5%
******* Domain 4 best val acc:      69.4%, epoch: 5 *******
******* Domain 4 best val test acc: 39.2%, epoch: 5 *******
******* Domain 4 best test acc:     40.2%, epoch: 4 *******
epoch [6/50] batch [20/403] time 0.077 (0.180) data 0.000 (0.063) loss 1.8885 (1.9868) ce_loss 0.7842 (0.9407) loss_zs_kd 2.1164 (2.0626) loss_oracle 0.9517 (0.8550) acc 71.8750 (64.2188) kd_loss 0.6285 (0.6186) lr 1.9686e-03 eta 0:54:23
epoch [6/50] batch [40/403] time 0.185 (0.152) data 0.000 (0.032) loss 2.0577 (2.0035) ce_loss 0.9653 (0.9489) loss_zs_kd 2.1124 (2.0270) loss_oracle 0.9189 (0.8722) acc 65.6250 (64.4531) kd_loss 0.6329 (0.6185) lr 1.9686e-03 eta 0:45:43
epoch [6/50] batch [60/403] time 0.151 (0.140) data 0.001 (0.021) loss 2.2197 (1.9900) ce_loss 1.1943 (0.9447) loss_zs_kd 1.7334 (2.0540) loss_oracle 0.7179 (0.8483) acc 65.6250 (65.2604) kd_loss 0.6664 (0.6211) lr 1.9686e-03 eta 0:42:18
epoch [6/50] batch [80/403] time 0.183 (0.136) data 0.000 (0.016) loss 2.0214 (1.9809) ce_loss 1.0098 (0.9336) loss_zs_kd 1.7684 (2.1020) loss_oracle 0.7625 (0.8414) acc 75.0000 (66.2109) kd_loss 0.6303 (0.6266) lr 1.9686e-03 eta 0:41:00
epoch [6/50] batch [100/403] time 0.075 (0.131) data 0.000 (0.013) loss 1.8966 (1.9916) ce_loss 0.8975 (0.9469) loss_zs_kd 2.2123 (2.1073) loss_oracle 0.7685 (0.8295) acc 68.7500 (65.6562) kd_loss 0.6149 (0.6299) lr 1.9686e-03 eta 0:39:30
epoch [6/50] batch [120/403] time 0.080 (0.123) data 0.000 (0.011) loss 1.8057 (1.9971) ce_loss 0.8232 (0.9528) loss_zs_kd 2.1159 (2.1390) loss_oracle 0.6967 (0.8238) acc 68.7500 (65.4688) kd_loss 0.6341 (0.6324) lr 1.9686e-03 eta 0:36:57
epoch [6/50] batch [140/403] time 0.080 (0.117) data 0.000 (0.009) loss 1.9163 (1.9832) ce_loss 0.8491 (0.9397) loss_zs_kd 1.9943 (2.1278) loss_oracle 0.8513 (0.8178) acc 59.3750 (65.8259) kd_loss 0.6415 (0.6347) lr 1.9686e-03 eta 0:35:09
epoch [6/50] batch [160/403] time 0.108 (0.115) data 0.000 (0.008) loss 2.2057 (1.9802) ce_loss 1.1377 (0.9386) loss_zs_kd 2.3791 (2.1217) loss_oracle 0.7826 (0.8127) acc 50.0000 (65.8008) kd_loss 0.6767 (0.6353) lr 1.9686e-03 eta 0:34:27
epoch [6/50] batch [180/403] time 0.103 (0.114) data 0.000 (0.007) loss 2.2663 (1.9779) ce_loss 1.2402 (0.9378) loss_zs_kd 2.3836 (2.1300) loss_oracle 0.7448 (0.8060) acc 59.3750 (65.9896) kd_loss 0.6537 (0.6371) lr 1.9686e-03 eta 0:34:05
epoch [6/50] batch [200/403] time 0.114 (0.113) data 0.000 (0.007) loss 2.0608 (1.9715) ce_loss 0.9692 (0.9340) loss_zs_kd 2.5338 (2.1199) loss_oracle 0.9484 (0.7998) acc 65.6250 (66.1875) kd_loss 0.6174 (0.6377) lr 1.9686e-03 eta 0:33:47
epoch [6/50] batch [220/403] time 0.102 (0.112) data 0.000 (0.006) loss 1.9184 (1.9756) ce_loss 0.9160 (0.9378) loss_zs_kd 2.0168 (2.1272) loss_oracle 0.6941 (0.8011) acc 65.6250 (66.0795) kd_loss 0.6553 (0.6373) lr 1.9686e-03 eta 0:33:32
epoch [6/50] batch [240/403] time 0.095 (0.112) data 0.000 (0.006) loss 2.0653 (1.9782) ce_loss 1.0615 (0.9408) loss_zs_kd 1.9787 (2.1352) loss_oracle 0.7322 (0.8001) acc 53.1250 (65.9375) kd_loss 0.6377 (0.6373) lr 1.9686e-03 eta 0:33:15
epoch [6/50] batch [260/403] time 0.108 (0.111) data 0.000 (0.005) loss 2.0564 (1.9826) ce_loss 1.0352 (0.9465) loss_zs_kd 2.1535 (2.1266) loss_oracle 0.8680 (0.7980) acc 59.3750 (65.7212) kd_loss 0.5873 (0.6370) lr 1.9686e-03 eta 0:33:08
epoch [6/50] batch [280/403] time 0.096 (0.111) data 0.000 (0.005) loss 2.0122 (1.9812) ce_loss 1.0039 (0.9468) loss_zs_kd 2.1393 (2.1236) loss_oracle 0.7450 (0.7951) acc 53.1250 (65.5580) kd_loss 0.6358 (0.6368) lr 1.9686e-03 eta 0:32:57
epoch [6/50] batch [300/403] time 0.104 (0.110) data 0.000 (0.005) loss 1.9500 (1.9826) ce_loss 0.9229 (0.9477) loss_zs_kd 2.1270 (2.1172) loss_oracle 0.8500 (0.7951) acc 65.6250 (65.6354) kd_loss 0.6022 (0.6373) lr 1.9686e-03 eta 0:32:43
epoch [6/50] batch [320/403] time 0.099 (0.110) data 0.000 (0.004) loss 1.9431 (1.9874) ce_loss 0.8813 (0.9493) loss_zs_kd 1.9311 (2.1088) loss_oracle 0.8022 (0.7999) acc 65.6250 (65.6055) kd_loss 0.6607 (0.6381) lr 1.9686e-03 eta 0:32:31
epoch [6/50] batch [340/403] time 0.094 (0.109) data 0.000 (0.004) loss 1.5726 (1.9895) ce_loss 0.5044 (0.9487) loss_zs_kd 1.4787 (2.0969) loss_oracle 0.7994 (0.8010) acc 87.5000 (65.6250) kd_loss 0.6685 (0.6403) lr 1.9686e-03 eta 0:32:22
epoch [6/50] batch [360/403] time 0.097 (0.109) data 0.000 (0.004) loss 2.3131 (1.9917) ce_loss 1.2451 (0.9515) loss_zs_kd 2.8241 (2.0938) loss_oracle 0.7558 (0.7961) acc 59.3750 (65.5035) kd_loss 0.6901 (0.6421) lr 1.9686e-03 eta 0:32:12
epoch [6/50] batch [380/403] time 0.100 (0.109) data 0.000 (0.004) loss 2.0610 (1.9892) ce_loss 1.0713 (0.9505) loss_zs_kd 1.8508 (2.0861) loss_oracle 0.6797 (0.7901) acc 65.6250 (65.5345) kd_loss 0.6498 (0.6436) lr 1.9686e-03 eta 0:32:07
epoch [6/50] batch [400/403] time 0.089 (0.108) data 0.000 (0.003) loss 1.9378 (1.9912) ce_loss 0.8267 (0.9523) loss_zs_kd 2.1861 (2.0809) loss_oracle 0.7592 (0.7877) acc 75.0000 (65.4844) kd_loss 0.7315 (0.6451) lr 1.9686e-03 eta 0:31:53
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,906
* accuracy: 70.6%
* error: 29.4%
* macro_f1: 57.6%
Checkpoint saved to icml/multi-dg/tuning/01_zs0.1/TRIP/terra_incognita/b32_ep50/ViT-B16/4/seed_1/warmup_1/prompt_learner/model-best.pth.tar
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,344
* accuracy: 39.8%
* error: 60.2%
* macro_f1: 33.1%
******* Domain 4 best val acc:      70.6%, epoch: 6 *******
******* Domain 4 best val test acc: 39.8%, epoch: 6 *******
******* Domain 4 best test acc:     40.2%, epoch: 4 *******
epoch [7/50] batch [20/403] time 0.162 (0.165) data 0.000 (0.054) loss 1.8395 (2.0023) ce_loss 0.7925 (0.9255) loss_zs_kd 2.3549 (1.9949) loss_oracle 0.6984 (0.7776) acc 71.8750 (66.0938) kd_loss 0.6978 (0.6880) lr 1.9511e-03 eta 0:48:46
epoch [7/50] batch [40/403] time 0.165 (0.138) data 0.000 (0.027) loss 1.9834 (2.0019) ce_loss 0.8369 (0.9230) loss_zs_kd 2.0583 (2.0184) loss_oracle 0.8869 (0.7848) acc 65.6250 (66.6406) kd_loss 0.7030 (0.6865) lr 1.9511e-03 eta 0:40:45
epoch [7/50] batch [60/403] time 0.084 (0.123) data 0.001 (0.018) loss 2.0971 (2.0004) ce_loss 1.0400 (0.9241) loss_zs_kd 1.6876 (2.0539) loss_oracle 0.8140 (0.7865) acc 68.7500 (67.1875) kd_loss 0.6501 (0.6831) lr 1.9511e-03 eta 0:36:10
epoch [7/50] batch [80/403] time 0.074 (0.120) data 0.000 (0.014) loss 1.9570 (2.0109) ce_loss 0.8584 (0.9316) loss_zs_kd 2.0729 (2.0371) loss_oracle 0.7927 (0.7874) acc 62.5000 (66.8359) kd_loss 0.7022 (0.6855) lr 1.9511e-03 eta 0:35:18
epoch [7/50] batch [100/403] time 0.077 (0.117) data 0.000 (0.011) loss 2.2468 (1.9991) ce_loss 1.1045 (0.9225) loss_zs_kd 2.6400 (2.0141) loss_oracle 0.8421 (0.7841) acc 62.5000 (67.1562) kd_loss 0.7212 (0.6845) lr 1.9511e-03 eta 0:34:31
epoch [7/50] batch [120/403] time 0.087 (0.112) data 0.000 (0.009) loss 2.1400 (2.0108) ce_loss 1.0938 (0.9309) loss_zs_kd 2.0685 (2.0414) loss_oracle 0.7796 (0.7884) acc 56.2500 (66.7188) kd_loss 0.6565 (0.6857) lr 1.9511e-03 eta 0:32:46
epoch [7/50] batch [140/403] time 0.081 (0.107) data 0.000 (0.008) loss 2.0531 (2.0120) ce_loss 0.9229 (0.9333) loss_zs_kd 2.2908 (2.0533) loss_oracle 0.7349 (0.7797) acc 65.6250 (66.7188) kd_loss 0.7628 (0.6889) lr 1.9511e-03 eta 0:31:30
epoch [7/50] batch [160/403] time 0.110 (0.105) data 0.000 (0.007) loss 1.5619 (1.9968) ce_loss 0.5161 (0.9214) loss_zs_kd 2.3933 (2.0462) loss_oracle 0.7369 (0.7707) acc 81.2500 (67.3242) kd_loss 0.6773 (0.6900) lr 1.9511e-03 eta 0:30:44
epoch [7/50] batch [180/403] time 0.101 (0.105) data 0.000 (0.006) loss 2.0283 (1.9983) ce_loss 0.8940 (0.9219) loss_zs_kd 2.1996 (2.0446) loss_oracle 0.8837 (0.7695) acc 75.0000 (67.1528) kd_loss 0.6924 (0.6917) lr 1.9511e-03 eta 0:30:36
epoch [7/50] batch [200/403] time 0.115 (0.105) data 0.000 (0.006) loss 1.6276 (2.0017) ce_loss 0.5352 (0.9251) loss_zs_kd 1.6687 (2.0338) loss_oracle 0.7083 (0.7638) acc 78.1250 (67.0000) kd_loss 0.7383 (0.6947) lr 1.9511e-03 eta 0:30:32
epoch [7/50] batch [220/403] time 0.107 (0.105) data 0.000 (0.005) loss 1.9427 (2.0006) ce_loss 0.9346 (0.9248) loss_zs_kd 2.3846 (2.0499) loss_oracle 0.6246 (0.7587) acc 68.7500 (66.9176) kd_loss 0.6958 (0.6964) lr 1.9511e-03 eta 0:30:31
epoch [7/50] batch [240/403] time 0.101 (0.105) data 0.000 (0.005) loss 1.9361 (1.9984) ce_loss 0.8677 (0.9266) loss_zs_kd 2.6855 (2.0501) loss_oracle 0.6852 (0.7489) acc 65.6250 (66.9661) kd_loss 0.7258 (0.6974) lr 1.9511e-03 eta 0:30:28
epoch [7/50] batch [260/403] time 0.099 (0.105) data 0.000 (0.004) loss 2.1510 (1.9994) ce_loss 1.1045 (0.9289) loss_zs_kd 2.1868 (2.0555) loss_oracle 0.6174 (0.7444) acc 53.1250 (66.7428) kd_loss 0.7378 (0.6984) lr 1.9511e-03 eta 0:30:26
epoch [7/50] batch [280/403] time 0.105 (0.104) data 0.000 (0.004) loss 2.0504 (1.9977) ce_loss 0.9219 (0.9269) loss_zs_kd 2.0577 (2.0625) loss_oracle 0.7702 (0.7412) acc 71.8750 (66.7746) kd_loss 0.7434 (0.7001) lr 1.9511e-03 eta 0:30:22
epoch [7/50] batch [300/403] time 0.100 (0.105) data 0.000 (0.004) loss 1.8020 (1.9989) ce_loss 0.7627 (0.9290) loss_zs_kd 2.0686 (2.0738) loss_oracle 0.6356 (0.7396) acc 71.8750 (66.6979) kd_loss 0.7215 (0.7001) lr 1.9511e-03 eta 0:30:22
epoch [7/50] batch [320/403] time 0.103 (0.105) data 0.000 (0.004) loss 1.9403 (1.9986) ce_loss 0.9209 (0.9278) loss_zs_kd 2.2737 (2.0935) loss_oracle 0.7131 (0.7395) acc 62.5000 (66.6895) kd_loss 0.6629 (0.7011) lr 1.9511e-03 eta 0:30:21
epoch [7/50] batch [340/403] time 0.111 (0.105) data 0.000 (0.003) loss 1.9477 (1.9960) ce_loss 0.8369 (0.9248) loss_zs_kd 2.3033 (2.0855) loss_oracle 0.7639 (0.7392) acc 62.5000 (66.8750) kd_loss 0.7288 (0.7016) lr 1.9511e-03 eta 0:30:19
epoch [7/50] batch [360/403] time 0.107 (0.105) data 0.000 (0.003) loss 2.4276 (1.9992) ce_loss 1.2842 (0.9282) loss_zs_kd 2.0221 (2.0948) loss_oracle 0.7697 (0.7371) acc 62.5000 (66.7882) kd_loss 0.7585 (0.7024) lr 1.9511e-03 eta 0:30:18
epoch [7/50] batch [380/403] time 0.106 (0.105) data 0.000 (0.003) loss 2.2511 (2.0006) ce_loss 1.1514 (0.9302) loss_zs_kd 1.8354 (2.0993) loss_oracle 0.8147 (0.7356) acc 65.6250 (66.7023) kd_loss 0.6924 (0.7025) lr 1.9511e-03 eta 0:30:17
epoch [7/50] batch [400/403] time 0.097 (0.105) data 0.000 (0.003) loss 2.0720 (2.0026) ce_loss 1.0234 (0.9330) loss_zs_kd 1.9412 (2.0947) loss_oracle 0.6822 (0.7343) acc 65.6250 (66.5469) kd_loss 0.7075 (0.7025) lr 1.9511e-03 eta 0:30:12
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,884
* accuracy: 70.2%
* error: 29.8%
* macro_f1: 55.0%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,353
* accuracy: 40.0%
* error: 60.0%
* macro_f1: 29.5%
******* Domain 4 best val acc:      70.6%, epoch: 6 *******
******* Domain 4 best val test acc: 39.8%, epoch: 6 *******
******* Domain 4 best test acc:     40.2%, epoch: 4 *******
epoch [8/50] batch [20/403] time 0.161 (0.173) data 0.000 (0.060) loss 1.9654 (2.0142) ce_loss 0.9399 (0.9595) loss_zs_kd 2.3243 (2.0132) loss_oracle 0.6643 (0.7054) acc 68.7500 (67.1875) kd_loss 0.6933 (0.7020) lr 1.9298e-03 eta 0:49:59
epoch [8/50] batch [40/403] time 0.151 (0.146) data 0.000 (0.030) loss 1.8735 (2.0278) ce_loss 0.8838 (0.9775) loss_zs_kd 2.2611 (2.0837) loss_oracle 0.6537 (0.7055) acc 59.3750 (65.4688) kd_loss 0.6629 (0.6975) lr 1.9298e-03 eta 0:41:59
epoch [8/50] batch [60/403] time 0.212 (0.140) data 0.001 (0.020) loss 2.3642 (2.0160) ce_loss 1.3613 (0.9636) loss_zs_kd 1.9038 (2.0371) loss_oracle 0.6908 (0.7035) acc 56.2500 (66.1979) kd_loss 0.6575 (0.7006) lr 1.9298e-03 eta 0:40:18
epoch [8/50] batch [80/403] time 0.172 (0.134) data 0.000 (0.015) loss 2.2118 (2.0195) ce_loss 1.1172 (0.9656) loss_zs_kd 2.4543 (2.0557) loss_oracle 0.7052 (0.6996) acc 56.2500 (65.9766) kd_loss 0.7420 (0.7041) lr 1.9298e-03 eta 0:38:36
epoch [8/50] batch [100/403] time 0.075 (0.131) data 0.000 (0.012) loss 2.0263 (2.0160) ce_loss 0.9790 (0.9587) loss_zs_kd 2.2882 (2.0808) loss_oracle 0.7684 (0.7023) acc 71.8750 (66.2812) kd_loss 0.6631 (0.7062) lr 1.9298e-03 eta 0:37:35
epoch [8/50] batch [120/403] time 0.078 (0.127) data 0.000 (0.010) loss 1.9438 (2.0085) ce_loss 0.8896 (0.9519) loss_zs_kd 1.8289 (2.0823) loss_oracle 0.6110 (0.6987) acc 68.7500 (66.1458) kd_loss 0.7487 (0.7073) lr 1.9298e-03 eta 0:36:22
epoch [8/50] batch [140/403] time 0.066 (0.121) data 0.000 (0.009) loss 1.7332 (1.9967) ce_loss 0.6680 (0.9398) loss_zs_kd 2.1921 (2.0693) loss_oracle 0.6648 (0.6941) acc 78.1250 (66.5848) kd_loss 0.7328 (0.7098) lr 1.9298e-03 eta 0:34:34
epoch [8/50] batch [160/403] time 0.120 (0.117) data 0.000 (0.008) loss 1.8506 (1.9931) ce_loss 0.7354 (0.9347) loss_zs_kd 2.1369 (2.0747) loss_oracle 0.8090 (0.6930) acc 78.1250 (66.6406) kd_loss 0.7107 (0.7119) lr 1.9298e-03 eta 0:33:28
epoch [8/50] batch [180/403] time 0.112 (0.116) data 0.000 (0.007) loss 1.6960 (1.9905) ce_loss 0.6768 (0.9311) loss_zs_kd 1.9535 (2.0810) loss_oracle 0.6781 (0.6927) acc 81.2500 (66.7708) kd_loss 0.6802 (0.7130) lr 1.9298e-03 eta 0:33:03
epoch [8/50] batch [200/403] time 0.097 (0.115) data 0.000 (0.006) loss 1.9727 (1.9871) ce_loss 0.9194 (0.9273) loss_zs_kd 1.6905 (2.0931) loss_oracle 0.6396 (0.6936) acc 62.5000 (67.1250) kd_loss 0.7334 (0.7131) lr 1.9298e-03 eta 0:32:43
epoch [8/50] batch [220/403] time 0.097 (0.114) data 0.000 (0.006) loss 2.3343 (1.9919) ce_loss 1.2314 (0.9296) loss_zs_kd 2.1819 (2.0923) loss_oracle 0.6997 (0.6970) acc 56.2500 (67.1307) kd_loss 0.7529 (0.7138) lr 1.9298e-03 eta 0:32:24
epoch [8/50] batch [240/403] time 0.086 (0.113) data 0.000 (0.005) loss 1.8530 (1.9925) ce_loss 0.8687 (0.9288) loss_zs_kd 1.9210 (2.0955) loss_oracle 0.6169 (0.6960) acc 75.0000 (67.2786) kd_loss 0.6759 (0.7157) lr 1.9298e-03 eta 0:32:11
epoch [8/50] batch [260/403] time 0.097 (0.112) data 0.000 (0.005) loss 2.1922 (1.9955) ce_loss 1.1484 (0.9319) loss_zs_kd 2.4543 (2.0843) loss_oracle 0.7027 (0.6956) acc 62.5000 (67.1755) kd_loss 0.6924 (0.7157) lr 1.9298e-03 eta 0:31:53
epoch [8/50] batch [280/403] time 0.114 (0.111) data 0.000 (0.005) loss 1.8419 (1.9935) ce_loss 0.7422 (0.9285) loss_zs_kd 2.3738 (2.0862) loss_oracle 0.7869 (0.6972) acc 78.1250 (67.2991) kd_loss 0.7063 (0.7164) lr 1.9298e-03 eta 0:31:38
epoch [8/50] batch [300/403] time 0.097 (0.111) data 0.000 (0.004) loss 2.0438 (1.9954) ce_loss 0.9824 (0.9280) loss_zs_kd 1.9424 (2.1001) loss_oracle 0.7146 (0.6989) acc 68.7500 (67.1667) kd_loss 0.7041 (0.7179) lr 1.9298e-03 eta 0:31:28
epoch [8/50] batch [320/403] time 0.092 (0.110) data 0.000 (0.004) loss 2.1383 (1.9923) ce_loss 1.0234 (0.9246) loss_zs_kd 2.0063 (2.0866) loss_oracle 0.7358 (0.6961) acc 68.7500 (67.2168) kd_loss 0.7470 (0.7196) lr 1.9298e-03 eta 0:31:18
epoch [8/50] batch [340/403] time 0.096 (0.110) data 0.000 (0.004) loss 1.7091 (1.9918) ce_loss 0.6191 (0.9228) loss_zs_kd 2.2034 (2.0887) loss_oracle 0.6453 (0.6934) acc 78.1250 (67.2610) kd_loss 0.7674 (0.7223) lr 1.9298e-03 eta 0:31:08
epoch [8/50] batch [360/403] time 0.107 (0.110) data 0.000 (0.004) loss 1.8981 (1.9923) ce_loss 0.8408 (0.9235) loss_zs_kd 2.3256 (2.0901) loss_oracle 0.6269 (0.6895) acc 68.7500 (67.0747) kd_loss 0.7438 (0.7240) lr 1.9298e-03 eta 0:30:59
epoch [8/50] batch [380/403] time 0.111 (0.109) data 0.000 (0.003) loss 1.9537 (1.9907) ce_loss 0.8809 (0.9219) loss_zs_kd 2.1809 (2.0882) loss_oracle 0.5998 (0.6863) acc 68.7500 (67.0230) kd_loss 0.7730 (0.7257) lr 1.9298e-03 eta 0:30:53
epoch [8/50] batch [400/403] time 0.096 (0.109) data 0.000 (0.003) loss 2.0627 (1.9891) ce_loss 0.9336 (0.9204) loss_zs_kd 1.7743 (2.0915) loss_oracle 0.6687 (0.6830) acc 71.8750 (67.1016) kd_loss 0.7948 (0.7272) lr 1.9298e-03 eta 0:30:42
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,874
* accuracy: 70.0%
* error: 30.0%
* macro_f1: 56.5%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,281
* accuracy: 38.8%
* error: 61.2%
* macro_f1: 28.8%
******* Domain 4 best val acc:      70.6%, epoch: 6 *******
******* Domain 4 best val test acc: 39.8%, epoch: 6 *******
******* Domain 4 best test acc:     40.2%, epoch: 4 *******
epoch [9/50] batch [20/403] time 0.162 (0.184) data 0.000 (0.070) loss 1.7523 (1.9184) ce_loss 0.6582 (0.8369) loss_zs_kd 1.6413 (2.1874) loss_oracle 0.6382 (0.6588) acc 81.2500 (69.2188) kd_loss 0.7750 (0.7521) lr 1.9048e-03 eta 0:51:52
epoch [9/50] batch [40/403] time 0.071 (0.142) data 0.000 (0.035) loss 2.1963 (1.9448) ce_loss 1.1885 (0.8826) loss_zs_kd 2.1329 (2.0679) loss_oracle 0.5416 (0.6224) acc 65.6250 (68.9844) kd_loss 0.7371 (0.7510) lr 1.9048e-03 eta 0:40:02
epoch [9/50] batch [60/403] time 0.169 (0.137) data 0.000 (0.023) loss 1.8316 (1.9423) ce_loss 0.7744 (0.8834) loss_zs_kd 2.2066 (2.0608) loss_oracle 0.5775 (0.6125) acc 71.8750 (68.5938) kd_loss 0.7684 (0.7526) lr 1.9048e-03 eta 0:38:33
epoch [9/50] batch [80/403] time 0.142 (0.130) data 0.000 (0.018) loss 1.7722 (1.9368) ce_loss 0.7256 (0.8818) loss_zs_kd 2.2276 (2.0488) loss_oracle 0.5569 (0.6063) acc 75.0000 (68.4766) kd_loss 0.7682 (0.7519) lr 1.9048e-03 eta 0:36:33
epoch [9/50] batch [100/403] time 0.130 (0.127) data 0.001 (0.014) loss 1.9150 (1.9433) ce_loss 0.7783 (0.8889) loss_zs_kd 2.5711 (2.0639) loss_oracle 0.6844 (0.6052) acc 75.0000 (67.8750) kd_loss 0.7945 (0.7518) lr 1.9048e-03 eta 0:35:30
epoch [9/50] batch [120/403] time 0.076 (0.124) data 0.000 (0.012) loss 1.7957 (1.9571) ce_loss 0.7524 (0.9027) loss_zs_kd 1.9274 (2.0520) loss_oracle 0.5635 (0.6088) acc 75.0000 (67.5000) kd_loss 0.7615 (0.7500) lr 1.9048e-03 eta 0:34:44
epoch [9/50] batch [140/403] time 0.079 (0.118) data 0.000 (0.010) loss 1.8682 (1.9603) ce_loss 0.8574 (0.9037) loss_zs_kd 1.8984 (2.0621) loss_oracle 0.5898 (0.6146) acc 75.0000 (67.7232) kd_loss 0.7158 (0.7493) lr 1.9048e-03 eta 0:32:55
epoch [9/50] batch [160/403] time 0.079 (0.114) data 0.000 (0.009) loss 1.9197 (1.9673) ce_loss 0.9292 (0.9111) loss_zs_kd 2.2964 (2.0592) loss_oracle 0.6505 (0.6168) acc 65.6250 (67.5000) kd_loss 0.6653 (0.7478) lr 1.9048e-03 eta 0:31:43
epoch [9/50] batch [180/403] time 0.102 (0.112) data 0.000 (0.008) loss 1.8894 (1.9678) ce_loss 0.7944 (0.9090) loss_zs_kd 1.9027 (2.0872) loss_oracle 0.7494 (0.6229) acc 62.5000 (67.6562) kd_loss 0.7203 (0.7473) lr 1.9048e-03 eta 0:31:19
epoch [9/50] batch [200/403] time 0.108 (0.112) data 0.000 (0.007) loss 2.0529 (1.9750) ce_loss 0.9995 (0.9169) loss_zs_kd 1.8437 (2.0817) loss_oracle 0.6569 (0.6248) acc 53.1250 (67.1875) kd_loss 0.7249 (0.7458) lr 1.9048e-03 eta 0:31:05
epoch [9/50] batch [220/403] time 0.094 (0.111) data 0.000 (0.007) loss 1.8702 (1.9768) ce_loss 0.8330 (0.9184) loss_zs_kd 2.0387 (2.0825) loss_oracle 0.6763 (0.6278) acc 71.8750 (67.1875) kd_loss 0.6991 (0.7445) lr 1.9048e-03 eta 0:30:51
epoch [9/50] batch [240/403] time 0.106 (0.110) data 0.001 (0.006) loss 1.6796 (1.9794) ce_loss 0.6685 (0.9203) loss_zs_kd 1.6488 (2.0842) loss_oracle 0.5560 (0.6282) acc 75.0000 (67.1484) kd_loss 0.7331 (0.7450) lr 1.9048e-03 eta 0:30:40
epoch [9/50] batch [260/403] time 0.104 (0.110) data 0.000 (0.006) loss 2.3888 (1.9793) ce_loss 1.2266 (0.9186) loss_zs_kd 2.2304 (2.0891) loss_oracle 0.7223 (0.6298) acc 62.5000 (67.3317) kd_loss 0.8010 (0.7458) lr 1.9048e-03 eta 0:30:30
epoch [9/50] batch [280/403] time 0.109 (0.109) data 0.000 (0.005) loss 1.7447 (1.9830) ce_loss 0.6929 (0.9229) loss_zs_kd 2.1044 (2.0887) loss_oracle 0.7128 (0.6292) acc 71.8750 (67.2433) kd_loss 0.6954 (0.7455) lr 1.9048e-03 eta 0:30:17
epoch [9/50] batch [300/403] time 0.104 (0.109) data 0.000 (0.005) loss 2.0438 (1.9845) ce_loss 0.9136 (0.9242) loss_zs_kd 2.0221 (2.0925) loss_oracle 0.6921 (0.6293) acc 59.3750 (67.0000) kd_loss 0.7842 (0.7457) lr 1.9048e-03 eta 0:30:07
epoch [9/50] batch [320/403] time 0.108 (0.108) data 0.000 (0.005) loss 1.8882 (1.9835) ce_loss 0.8364 (0.9232) loss_zs_kd 1.8919 (2.0848) loss_oracle 0.5977 (0.6291) acc 71.8750 (66.9434) kd_loss 0.7529 (0.7457) lr 1.9048e-03 eta 0:29:58
epoch [9/50] batch [340/403] time 0.102 (0.108) data 0.000 (0.004) loss 1.8549 (1.9802) ce_loss 0.8159 (0.9202) loss_zs_kd 2.2243 (2.0807) loss_oracle 0.5896 (0.6280) acc 71.8750 (67.1048) kd_loss 0.7442 (0.7460) lr 1.9048e-03 eta 0:29:51
epoch [9/50] batch [360/403] time 0.096 (0.108) data 0.000 (0.004) loss 1.7895 (1.9784) ce_loss 0.7207 (0.9188) loss_zs_kd 1.6698 (2.0849) loss_oracle 0.5813 (0.6260) acc 75.0000 (67.1701) kd_loss 0.7781 (0.7466) lr 1.9048e-03 eta 0:29:44
epoch [9/50] batch [380/403] time 0.091 (0.108) data 0.000 (0.004) loss 1.8969 (1.9813) ce_loss 0.8140 (0.9218) loss_zs_kd 1.9304 (2.0883) loss_oracle 0.5923 (0.6243) acc 78.1250 (67.0230) kd_loss 0.7868 (0.7474) lr 1.9048e-03 eta 0:29:39
epoch [9/50] batch [400/403] time 0.094 (0.107) data 0.000 (0.004) loss 1.8724 (1.9808) ce_loss 0.8857 (0.9215) loss_zs_kd 2.1887 (2.0812) loss_oracle 0.5747 (0.6233) acc 71.8750 (67.0391) kd_loss 0.6993 (0.7476) lr 1.9048e-03 eta 0:29:30
Evaluate on the *val* set
=> result
* total: 5,535
* correct: 3,856
* accuracy: 69.7%
* error: 30.3%
* macro_f1: 53.9%
Evaluate on the *test* set
=> result
* total: 5,883
* correct: 2,221
* accuracy: 37.8%
* error: 62.2%
* macro_f1: 26.8%
******* Domain 4 best val acc:      70.6%, epoch: 6 *******
******* Domain 4 best val test acc: 39.8%, epoch: 6 *******
******* Domain 4 best test acc:     40.2%, epoch: 4 *******
epoch [10/50] batch [20/403] time 0.163 (0.193) data 0.000 (0.081) loss 1.9867 (1.9855) ce_loss 0.9390 (0.9441) loss_zs_kd 2.2493 (2.1880) loss_oracle 0.5849 (0.5999) acc 68.7500 (66.8750) kd_loss 0.7553 (0.7415) lr 1.8763e-03 eta 0:53:07
epoch [10/50] batch [40/403] time 0.161 (0.150) data 0.000 (0.041) loss 2.0192 (1.9622) ce_loss 0.9077 (0.9155) loss_zs_kd 2.2112 (2.1097) loss_oracle 0.6527 (0.5980) acc 59.3750 (67.1875) kd_loss 0.7852 (0.7478) lr 1.8763e-03 eta 0:41:04
epoch [10/50] batch [60/403] time 0.078 (0.133) data 0.000 (0.027) loss 1.7439 (1.9512) ce_loss 0.6260 (0.8997) loss_zs_kd 2.4876 (2.0963) loss_oracle 0.6973 (0.5987) acc 75.0000 (67.6562) kd_loss 0.7693 (0.7522) lr 1.8763e-03 eta 0:36:27
epoch [10/50] batch [80/403] time 0.177 (0.128) data 0.000 (0.020) loss 2.2499 (1.9752) ce_loss 1.1797 (0.9196) loss_zs_kd 1.9366 (2.1008) loss_oracle 0.6061 (0.5991) acc 59.3750 (66.7969) kd_loss 0.7672 (0.7561) lr 1.8763e-03 eta 0:35:08
epoch [10/50] batch [100/403] time 0.175 (0.124) data 0.000 (0.016) loss 1.8732 (1.9617) ce_loss 0.8203 (0.9106) loss_zs_kd 2.2012 (2.1058) loss_oracle 0.6574 (0.5940) acc 68.7500 (67.1875) kd_loss 0.7242 (0.7541) lr 1.8763e-03 eta 0:33:49
epoch [10/50] batch [120/403] time 0.150 (0.123) data 0.000 (0.014) loss 1.8946 (1.9760) ce_loss 0.8198 (0.9248) loss_zs_kd 2.4838 (2.1114) loss_oracle 0.6453 (0.5919) acc 65.6250 (66.7708) kd_loss 0.7521 (0.7553) lr 1.8763e-03 eta 0:33:43
epoch [10/50] batch [140/403] time 0.086 (0.118) data 0.000 (0.012) loss 1.8835 (1.9856) ce_loss 0.8828 (0.9314) loss_zs_kd 2.0170 (2.1169) loss_oracle 0.5485 (0.5918) acc 59.3750 (66.3839) kd_loss 0.7265 (0.7583) lr 1.8763e-03 eta 0:32:15
epoch [10/50] batch [160/403] time 0.091 (0.114) data 0.000 (0.010) loss 2.0459 (1.9849) ce_loss 1.0303 (0.9313) loss_zs_kd 2.7645 (2.1261) loss_oracle 0.5605 (0.5910) acc 62.5000 (66.5820) kd_loss 0.7354 (0.7580) lr 1.8763e-03 eta 0:31:08
epoch [10/50] batch [180/403] time 0.100 (0.112) data 0.000 (0.009) loss 2.4149 (1.9877) ce_loss 1.2959 (0.9347) loss_zs_kd 2.6160 (2.1275) loss_oracle 0.6343 (0.5901) acc 46.8750 (66.4757) kd_loss 0.8019 (0.7580) lr 1.8763e-03 eta 0:30:23
epoch [10/50] batch [200/403] time 0.102 (0.111) data 0.000 (0.008) loss 1.7882 (1.9819) ce_loss 0.7012 (0.9280) loss_zs_kd 1.7220 (2.1215) loss_oracle 0.6410 (0.5907) acc 71.8750 (66.6094) kd_loss 0.7666 (0.7585) lr 1.8763e-03 eta 0:30:11
epoch [10/50] batch [220/403] time 0.115 (0.110) data 0.000 (0.008) loss 2.0176 (1.9826) ce_loss 0.9814 (0.9278) loss_zs_kd 1.5705 (2.1153) loss_oracle 0.6220 (0.5906) acc 65.6250 (66.6335) kd_loss 0.7252 (0.7595) lr 1.8763e-03 eta 0:30:00
epoch [10/50] batch [240/403] time 0.110 (0.110) data 0.001 (0.007) loss 2.2504 (1.9821) ce_loss 1.2002 (0.9271) loss_zs_kd 2.3962 (2.1018) loss_oracle 0.6505 (0.5916) acc 65.6250 (66.6276) kd_loss 0.7250 (0.7592) lr 1.8763e-03 eta 0:29:50
epoch [10/50] batch [260/403] time 0.101 (0.110) data 0.000 (0.007) loss 1.8660 (1.9790) ce_loss 0.7900 (0.9221) loss_zs_kd 2.1022 (2.0991) loss_oracle 0.6026 (0.5928) acc 75.0000 (66.8750) kd_loss 0.7747 (0.7604) lr 1.8763e-03 eta 0:29:40
epoch [10/50] batch [280/403] time 0.095 (0.109) data 0.000 (0.006) loss 2.1441 (1.9795) ce_loss 1.0498 (0.9217) loss_zs_kd 2.6775 (2.1035) loss_oracle 0.6355 (0.5933) acc 65.6250 (66.8973) kd_loss 0.7765 (0.7611) lr 1.8763e-03 eta 0:29:32
epoch [10/50] batch [300/403] time 0.088 (0.109) data 0.000 (0.006) loss 1.9489 (1.9816) ce_loss 0.9292 (0.9241) loss_zs_kd 1.9605 (2.1010) loss_oracle 0.5905 (0.5938) acc 62.5000 (66.8854) kd_loss 0.7245 (0.7607) lr 1.8763e-03 eta 0:29:25
epoch [10/50] batch [320/403] time 0.100 (0.109) data 0.000 (0.005) loss 1.6975 (1.9839) ce_loss 0.6509 (0.9262) loss_zs_kd 2.0690 (2.1021) loss_oracle 0.5552 (0.5942) acc 75.0000 (66.9238) kd_loss 0.7690 (0.7605) lr 1.8763e-03 eta 0:29:21
